{
    "hands_on_practices": [
        {
            "introduction": "The heart of the Phase-Field Crystal (PFC) model is the free energy kernel, which dictates the preferred length scales and stability of crystalline structures. This exercise  delves into this core concept by demonstrating how to engineer the kernel to model complex interactions, such as those in colloidal systems. By analyzing the linear stability of the system, you will computationally predict the fascinating phenomenon of re-entrant melting, where a system melts, crystallizes, and then melts again upon tuning a single parameter.",
            "id": "3475620",
            "problem": "Consider a one-dimensional Phase-Field Crystal (PFC) model for a conserved scalar field $\\,\\psi(x,t)\\,$ representing the deviation of a number density from its mean. The PFC free-energy functional is\n$$\n\\mathcal{F}[\\psi] \\;=\\; \\int \\mathrm{d}x \\left[ \\tfrac{1}{2}\\,\\psi\\,\\mathcal{C}(-\\nabla^2)\\,\\psi \\;+\\; \\tfrac{a_4}{4}\\,\\psi^4 \\right],\n$$\nwith conserved dynamics\n$$\n\\frac{\\partial \\psi}{\\partial t} \\;=\\; \\nabla^2 \\mu, \n\\qquad\n\\mu \\;=\\; \\frac{\\delta \\mathcal{F}}{\\delta \\psi} \\;=\\; \\mathcal{C}(-\\nabla^2)\\,\\psi \\;+\\; a_4\\,\\psi^3,\n$$\nwhere $\\,a_4>0\\,$ is a stabilizing coefficient and $\\,\\mathcal{C}(-\\nabla^2)\\,$ is a translationally invariant kernel operator defined via its Fourier symbol $\\,\\widehat{\\mathcal{C}}(k)\\,$. The quadratic operator $\\,\\mathcal{C}\\,$ encodes two-body interactions, and its modification in Fourier space enables tuning of an effective interaction range. Assume a base kernel with a characteristic length scale set by a nondimensional choice such that the reference wave number is $\\,k_0 = 1\\,$. To model tunable soft interactions of range controlled by a parameter $\\,\\alpha>0\\,$, consider the following Fourier-space kernel\n$$\n\\widehat{\\mathcal{C}}(k;\\alpha) \\;=\\; r \\;+\\; \\bigl(1 - k^2\\bigr)^2 \\;-\\; \\frac{v}{\\alpha}\\,\\exp\\!\\left(-\\frac{k^2}{2\\,(\\alpha\\,\\sigma)^2}\\right),\n$$\nwhere $\\,r\\,$ is a control parameter that plays a role analogous to undercooling or reduced temperature, $\\,v>0\\,$ sets the interaction strength of a soft repulsive contribution, and $\\,\\sigma>0\\,$ is a spectral width parameter. The factor $\\,1/\\alpha\\,$ in front of the Gaussian ensures that when $\\,\\alpha\\,$ increases (broader interaction in Fourier space corresponding to longer-range real-space softness), the overall integrated strength of the soft contribution remains controlled, mimicking a fixed integrated real-space interaction while the range varies.\n\nUsing the linearized dynamics about a homogeneous state $\\,\\psi(x,t)=0\\,$ (which is valid to determine the onset of instability), the growth rate of a Fourier mode with wave number $\\,k\\,$ is\n$$\n\\lambda(k;\\alpha) \\;=\\; -\\,k^2\\,\\widehat{\\mathcal{C}}(k;\\alpha).\n$$\nA crystalline (periodic) state is predicted to emerge when there exists some $\\,k\\,$ such that $\\,\\lambda(k;\\alpha) > 0\\,$, i.e., the maximum linear growth rate is positive:\n$$\n\\lambda_{\\max}(\\alpha) \\;=\\; \\max_{k\\ge 0}\\,\\lambda(k;\\alpha) \\;>\\; 0.\n$$\nOtherwise, the system remains in a homogeneous (liquid-like) state at the linear level. Re-entrant melting under soft interactions is said to occur in this setting if, as $\\,\\alpha\\,$ increases monotonically, the sequence of states transitions liquid $\\to$ crystal $\\to$ liquid (or equivalently, the boolean indicator of $\\,\\lambda_{\\max}(\\alpha) > 0\\,$ follows $\\,\\text{False} \\to \\text{True} \\to \\text{False}\\,$).\n\nYour task is to implement a program that, for a specified set of parameters, evaluates $\\,\\lambda_{\\max}(\\alpha)\\,$ from first principles of the PFC model defined above by numerically maximizing $\\,\\lambda(k;\\alpha)\\,$ over a prescribed wave-number interval. You must then classify each case as crystal if $\\,\\lambda_{\\max}(\\alpha) > 0\\,$, or liquid if $\\,\\lambda_{\\max}(\\alpha) \\le 0\\,$, and report only this boolean classification.\n\nUse the following parameter values (all variables are nondimensional, so no physical units are required):\n- Control parameter: $\\,r = 0.16\\,$.\n- Soft-interaction strength: $\\,v = 0.50\\,$.\n- Spectral width: $\\,\\sigma = 0.80\\,$.\n- Wave-number search domain: $\\,k \\in [0, k_{\\max}]\\,$ with $\\,k_{\\max} = 4.00\\,$ sampled on a uniform grid of $\\,N_k = 100001\\,$ points (inclusive of endpoints). Use this grid to approximate the maximum over $\\,k\\,$.\n\nTest suite (interaction-range values):\n- Case $\\,1$: $\\,\\alpha = 0.20\\,$.\n- Case $\\,2$: $\\,\\alpha = 1.00\\,$.\n- Case $\\,3$: $\\,\\alpha = 2.70\\,$.\n- Case $\\,4$: $\\,\\alpha = 2.90\\,$.\n- Case $\\,5$: $\\,\\alpha = 3.50\\,$.\n\nYour program must:\n- For each test case, compute $\\,\\lambda_{\\max}(\\alpha)\\,$ by evaluating $\\,\\lambda(k;\\alpha)\\,$ on the specified grid and taking the maximum over all sampled $\\,k\\,$ values.\n- For each test case, output the boolean $\\,\\text{True}\\,$ if $\\,\\lambda_{\\max}(\\alpha) > 0\\,$ and $\\,\\text{False}\\,$ otherwise.\n\nFinal output format:\n- Your program should produce a single line of output containing a list of the five boolean results, in the order of the cases above, as a comma-separated list enclosed in square brackets, for example $\\,\\bigl[\\text{False},\\text{True},\\ldots\\bigr]\\,$.",
            "solution": "We start from the Phase-Field Crystal (PFC) model free energy\n$$\n\\mathcal{F}[\\psi] \\;=\\; \\int \\mathrm{d}x \\left[ \\tfrac{1}{2}\\,\\psi\\,\\mathcal{C}(-\\nabla^2)\\,\\psi \\;+\\; \\tfrac{a_4}{4}\\,\\psi^4 \\right],\n$$\nwith conserved dynamics\n$$\n\\frac{\\partial \\psi}{\\partial t} \\;=\\; \\nabla^2 \\mu, \n\\qquad\n\\mu \\;=\\; \\mathcal{C}(-\\nabla^2)\\,\\psi \\;+\\; a_4\\,\\psi^3.\n$$\nThis is a standard form where the linear operator $\\,\\mathcal{C}\\,$ encodes the two-point interaction in Fourier space and $\\,a_4>0\\,$ provides nonlinear saturation of amplitudes. To analyze the onset of crystalline ordering, it suffices to linearize the dynamics around the homogeneous state $\\,\\psi=0\\,$, yielding\n$$\n\\frac{\\partial \\hat{\\psi}(k,t)}{\\partial t} \\;=\\; -\\,k^2\\,\\widehat{\\mathcal{C}}(k;\\alpha)\\,\\hat{\\psi}(k,t),\n$$\nwhere hats denote Fourier transforms and $\\,\\widehat{\\mathcal{C}}(k;\\alpha)\\,$ is the Fourier symbol of the kernel. Thus each Fourier mode grows or decays exponentially with growth rate\n$$\n\\lambda(k;\\alpha) \\;=\\; -\\,k^2\\,\\widehat{\\mathcal{C}}(k;\\alpha).\n$$\nCrystalline order emerges at the linear level if and only if there exists some $\\,k\\ge 0\\,$ such that $\\,\\lambda(k;\\alpha) > 0\\,$, equivalently, if the maximum growth rate\n$$\n\\lambda_{\\max}(\\alpha) \\;=\\; \\max_{k\\ge 0}\\,\\lambda(k;\\alpha)\n$$\nis positive. Otherwise all modes decay and the homogeneous state remains linearly stable (liquid-like).\n\nWe now specify the tunable-kernel construction. For a base PFC with characteristic wave number $\\,k_0=1\\,$ we use the canonical spectral form $\\,\\bigl(1-k^2\\bigr)^2\\,$ that favors periodicity near $\\,k=1\\,$. We add a soft-interaction term that is Gaussian in Fourier space with width proportional to the range parameter $\\,\\alpha\\,$, and with amplitude scaled as $\\,1/\\alpha\\,$:\n$$\n\\widehat{\\mathcal{C}}(k;\\alpha) \\;=\\; r \\;+\\; \\bigl(1 - k^2\\bigr)^2 \\;-\\; \\frac{v}{\\alpha}\\,\\exp\\!\\left(-\\frac{k^2}{2\\,(\\alpha\\,\\sigma)^2}\\right).\n$$\nThe $\\,1/\\alpha\\,$ prefactor is chosen to keep the effective integrated strength controlled as $\\,\\alpha\\,$ changes. In real space, broadening the range of a fixed-strength soft repulsion should reduce its spectral amplitude at any fixed nonzero $\\,k\\,$; the $\\,1/\\alpha\\,$ scaling captures this by making the magnitude at a given $\\,k\\,$ a nonmonotonic function of $\\,\\alpha\\,$: for very small $\\,\\alpha\\,$, the Gaussian in $\\,k\\,$ is so narrow around $\\,k=0\\,$ that at $\\,k\\sim 1\\,$ the contribution is exponentially small; for very large $\\,\\alpha\\,$, the exponential is close to unity but the prefactor $\\,1/\\alpha\\,$ reduces the overall magnitude. This produces a peak influence at intermediate $\\,\\alpha\\,$.\n\nThe conserved dynamics introduces a factor $\\,k^2\\,$ in the growth rate $\\,\\lambda(k;\\alpha)=-k^2\\,\\widehat{\\mathcal{C}}(k;\\alpha)\\,$. Hence the competition between the base peak near $\\,k\\approx 1\\,$ and the soft term (centered at $\\,k=0\\,$) can yield a nonmonotonic variation of the maximal growth rate with $\\,\\alpha\\,$. This mechanism can reproduce re-entrant melting: stable liquid at small $\\,\\alpha\\,$ (soft term too narrow in $\\,k\\,$-space to affect $\\,k\\approx 1\\,$), crystalline at intermediate $\\,\\alpha\\,$ (soft term sufficiently reduces $\\,\\widehat{\\mathcal{C}}$ near $\\,k\\approx 1\\,$), and liquid again at large $\\,\\alpha\\,$ (the $\\,1/\\alpha\\,$ scaling weakens the soft term, restoring stability).\n\nAlgorithmic procedure:\n- Fix parameters $\\,r=0.16\\,$, $\\,v=0.50\\,$, $\\,\\sigma=0.80\\,$.\n- For each test case value of $\\,\\alpha\\,$, compute $\\,\\lambda(k;\\alpha)\\,$ on a uniform grid $\\,k\\in[0,k_{\\max}]\\,$ with $\\,k_{\\max}=4.00\\,$ and $\\,N_k=100001\\,$ points.\n- Evaluate $\\,\\lambda_{\\max}(\\alpha)\\,$ by taking the maximum over the grid.\n- Classify as crystal if $\\,\\lambda_{\\max}(\\alpha) > 0\\,$ and liquid otherwise.\n\nExpected qualitative behavior with the provided parameters:\n- For $\\,\\alpha=0.20\\,$, the Gaussian soft term is too narrow in $\\,k\\,$-space; near $\\,k\\approx 1\\,$, the exponential factor is exponentially small, leaving $\\,\\widehat{\\mathcal{C}}(k;\\alpha)\\,$ positive and $\\,\\lambda(k;\\alpha)\\le 0\\,$. Classification: liquid.\n- For $\\,\\alpha=1.00\\,$, the soft term has appreciable magnitude at $\\,k\\approx 1\\,$, lowering $\\,\\widehat{\\mathcal{C}}(k;\\alpha)\\,$ and yielding a positive maximum $\\,\\lambda_{\\max}(\\alpha)\\,$ near $\\,k\\approx 1\\,$. Classification: crystal.\n- For $\\,\\alpha=2.70\\,$, the influence remains sufficiently strong to keep $\\,\\lambda_{\\max}(\\alpha)>0\\,$. Classification: crystal.\n- For $\\,\\alpha=2.90\\,$ and $\\,\\alpha=3.50\\,$, the $\\,1/\\alpha\\,$ scaling weakens the soft term to the extent that $\\,\\widehat{\\mathcal{C}}(k;\\alpha)\\,$ becomes positive across $\\,k\\ge 0\\,$ and $\\,\\lambda_{\\max}(\\alpha)\\le 0\\,$. Classification: liquid.\n\nThe program implements this computation directly, producing a single-line list of five boolean values in the order of the specified test suite. All quantities are nondimensional, so no physical units apply. The choice of $\\,k_{\\max}\\,$ and $\\,N_k\\,$ ensures that the dominant band around $\\,k\\approx 1\\,$ is well resolved and that possible shifts in the maximizer are captured, including edge cases near the stability boundary.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    # Fixed model parameters (dimensionless)\n    r = 0.16    # control parameter\n    v = 0.50    # soft interaction strength\n    sigma = 0.80  # spectral width\n\n    # Wave-number grid specification\n    k_max = 4.00\n    N_k = 100001  # inclusive of endpoints\n    k = np.linspace(0.0, k_max, N_k)\n\n    # Test suite: interaction-range values alpha\n    test_cases = [0.20, 1.00, 2.70, 2.90, 3.50]\n\n    def kernel_C(kvals, alpha):\n        # Fourier-space kernel C(k; alpha) = r + (1 - k^2)^2 - (v/alpha) * exp(-k^2 / (2*(alpha*sigma)^2))\n        denom = 2.0 * (alpha * sigma) ** 2\n        # To avoid division by zero in exponent when alpha is extremely small, denom remains > 0 for given test cases\n        gaussian = np.exp(-(kvals ** 2) / denom)\n        return r + (1.0 - kvals ** 2) ** 2 - (v / alpha) * gaussian\n\n    def growth_rate(kvals, alpha):\n        C = kernel_C(kvals, alpha)\n        return - (kvals ** 2) * C\n\n    results = []\n    for alpha in test_cases:\n        lam = growth_rate(k, alpha)\n        lam_max = np.max(lam)\n        is_crystal = bool(lam_max > 0.0)\n        results.append(is_crystal)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "Perfect crystals are a theoretical ideal; the mechanical properties of real materials are dominated by the behavior of defects, particularly dislocations. This practice  provides a concrete method for using the PFC model to quantify a crucial property governing dislocation motion: the Peierls barrier, which is the intrinsic energy barrier for a dislocation to move through the crystal lattice. By constructing a model of a sheared crystal and evaluating its energy, you will gain hands-on experience in calculating fundamental defect properties from the first principles of the PFC functional.",
            "id": "3475629",
            "problem": "Consider the Phase-Field Crystal (PFC) model in two dimensions with periodic boundary conditions. The free energy functional for a dimensionless number density field $n(\\mathbf{r})$ is given by\n$$\nF[n] = \\int_{\\Omega} \\left[ \\frac{1}{2} n(\\mathbf{r}) \\left( -\\varepsilon + \\left( \\nabla^2 + q_0^2 \\right)^2 \\right) n(\\mathbf{r}) + \\frac{1}{4} n(\\mathbf{r})^4 \\right] \\, d\\mathbf{r},\n$$\nwhere $\\varepsilon > 0$ is the undercooling parameter controlling proximity to instability, $q_0$ is the characteristic wave number, and $\\Omega$ is the domain. In this problem, set $q_0 = 1$, so that $\\left( \\nabla^2 + 1 \\right)^2$ determines the elastic penalty. All quantities are dimensionless in the standard PFC scaling.\n\nA triangular lattice in this model can be represented by the one-mode approximation\n$$\nn_{\\text{tri}}(x,y) = n_0 + 2 A \\left[ \\cos\\left( k_{1x} x + k_{1y} y \\right) + \\cos\\left( k_{2x} x + k_{2y} y \\right) + \\cos\\left( k_{3x} x + k_{3y} y \\right) \\right],\n$$\nwith the three wave vectors\n$$\n\\mathbf{k}_1 = (1, 0), \\quad \\mathbf{k}_2 = \\left( -\\frac{1}{2}, \\frac{\\sqrt{3}}{2} \\right), \\quad \\mathbf{k}_3 = \\left( -\\frac{1}{2}, -\\frac{\\sqrt{3}}{2} \\right),\n$$\nand parameters $A$ (lattice amplitude) and $n_0$ (average density). Use a rectangular periodic domain with lengths $L_x = 4\\pi$ and $L_y = \\frac{4\\pi}{\\sqrt{3}}$, which makes the above three wave vectors commensurate with the discrete Fourier modes of the domain.\n\nTo approximate the Peierls barrier for dislocation glide along the $x$-direction, construct a family of configurations where the half-plane $y > L_y/2$ is rigidly shifted by a displacement $\\Delta$ in the $x$-direction, smoothly blended across a narrow slip region centered at $y_0 = L_y/2$:\n$$\nS(y) = \\frac{1}{2}\\left[1 + \\tanh\\left( \\frac{y - y_0}{w} \\right)\\right],\n$$\n$$\nn_{\\Delta}(x,y) = S(y)\\, n_{\\text{tri}}(x - \\Delta, y) + \\left[1 - S(y)\\right]\\, n_{\\text{tri}}(x, y),\n$$\nwhere $w > 0$ is a smoothing width controlling the slip plane thickness. The energy $F(\\Delta)$ is the free energy of $n_{\\Delta}(x,y)$ evaluated with the PFC functional above. The Peierls barrier per unit length along the dislocation line (aligned with the $x$-direction in this two-dimensional setting) is defined as\n$$\nB = \\frac{\\max_{\\Delta \\in [0, L_x)} F(\\Delta) - \\min_{\\Delta \\in [0, L_x)} F(\\Delta)}{L_x}.\n$$\n\nStarting from the free energy functional $F[n]$, and using a spectral method with periodic boundary conditions to evaluate the operator $\\left( \\nabla^2 + 1 \\right)^2$, write a program that:\n- Constructs $n_{\\text{tri}}(x,y)$ on a uniform grid of $N_x \\times N_y$ points over $\\Omega = [0,L_x) \\times [0,L_y)$.\n- Builds $n_{\\Delta}(x,y)$ for a set of evenly spaced displacements $\\Delta \\in [0, L_x)$.\n- Computes $F(\\Delta)$ for each displacement by integrating the energy density over the domain.\n- Returns the barrier $B$ as defined above.\n\nAll quantities are to be expressed in dimensionless units. The numerical integration should be performed as a Riemann sum over the grid (i.e., multiply the energy density by $dx\\,dy$ and sum over all grid points). The spectral method must use the discrete Fourier transform and its corresponding wave numbers consistent with periodic boundary conditions.\n\nYour program must evaluate the barrier $B$ for each of the following test cases, which together form the test suite:\n1. $N_x = 128$, $N_y = 128$, $\\varepsilon = 0.05$, $n_0 = -0.10$, $A = 0.27$, $w = 0.08$, and use $64$ evenly spaced values of $\\Delta$ in $[0,L_x)$.\n2. $N_x = 128$, $N_y = 128$, $\\varepsilon = 0.02$, $n_0 = -0.05$, $A = 0.12$, $w = 0.08$, and use $64$ evenly spaced values of $\\Delta$ in $[0,L_x)$.\n3. $N_x = 128$, $N_y = 128$, $\\varepsilon = 0.20$, $n_0 = -0.15$, $A = 0.35$, $w = 0.04$, and use $64$ evenly spaced values of $\\Delta$ in $[0,L_x)$.\n4. $N_x = 128$, $N_y = 128$, $\\varepsilon = 0.05$, $n_0 = 0.00$, $A = 0.00$, $w = 0.08$, and use $64$ evenly spaced values of $\\Delta$ in $[0,L_x)$.\n\nYour program should produce a single line of output containing the barrier values for the four test cases as a comma-separated list enclosed in square brackets (e.g., \"[result1,result2,result3,result4]\"), where each result is a floating-point number representing the dimensionless energy per unit length $B$ for the corresponding test case. No other text should be printed.",
            "solution": "The solution is implemented by numerically evaluating the PFC free energy functional for a series of atomic configurations representing a crystal being sheared. The core of the method involves discretizing the system on a grid and using a spectral method for efficiently computing the energy contributions.\n\nThe free energy functional is given by:\n$$\nF[n] = \\int_{\\Omega} \\left[ \\frac{1}{2} n(\\mathbf{r}) \\left( -\\varepsilon + \\left( \\nabla^2 + q_0^2 \\right)^2 \\right) n(\\mathbf{r}) + \\frac{1}{4} n(\\mathbf{r})^4 \\right] \\, d\\mathbf{r}\n$$\nWith $q_0=1$, the problem is defined on a periodic rectangular domain $\\Omega = [0, L_x) \\times [0, L_y)$ with $L_x = 4\\pi$ and $L_y = 4\\pi/\\sqrt{3}$.\n\nThe methodological steps are as follows:\n\n1.  **Numerical Discretization**: The continuous domain $\\Omega$ is discretized into a uniform grid of $N_x \\times N_y$ points. The real-space coordinates are $(x_i, y_j)$ where $x_i = i \\cdot \\Delta x$ and $y_j = j \\cdot \\Delta y$, with grid spacings $\\Delta x = L_x/N_x$ and $\\Delta y = L_y/N_y$. For computations involving spatial derivatives, we transition to Fourier space. The corresponding discrete wave vectors are $k_x = 2\\pi m / L_x$ and $k_y = 2\\pi n / L_y$, which are efficiently generated using the `numpy.fft.fftfreq` function.\n\n2.  **Energy Calculation**: The total free energy $F[n]$ is a sum of a quadratic (linear) term and a quartic (nonlinear) term. A hybrid real-space/Fourier-space approach is optimal for its evaluation.\n    *   **Nonlinear Term**: The quartic term, $\\frac{1}{4} \\int n^4 \\, d\\mathbf{r}$, is local in real space. It is calculated by evaluating $n(x_i, y_j)$ on the grid, taking its fourth power at each point, and then performing a Riemann sum over all grid points: $\\sum_{i,j} \\frac{1}{4} n(x_i, y_j)^4 \\Delta x \\Delta y$.\n    *   **Linear Term**: The quadratic term, $\\frac{1}{2} \\int n \\left( -\\varepsilon + (\\nabla^2 + 1)^2 \\right) n \\, d\\mathbf{r}$, involves a differential operator. Such operators are diagonal in Fourier space, which makes their application computationally efficient. The operator $(\\nabla^2 + 1)^2$ becomes a multiplicative factor $(-(k_x^2+k_y^2)+1)^2 = (1-|\\mathbf{k}|^2)^2$ in the Fourier domain. The calculation proceeds as:\n        a. Compute the Discrete Fourier Transform (DFT) of the density field, $n(\\mathbf{r}) \\xrightarrow{\\text{FFT}} \\hat{n}(\\mathbf{k})$.\n        b. Apply the linear operator in Fourier space by element-wise multiplication: $\\hat{g}(\\mathbf{k}) = [-\\varepsilon + (1-|\\mathbf{k}|^2)^2] \\hat{n}(\\mathbf{k})$.\n        c. Transform the result back to real space: $g(\\mathbf{r}) = \\mathcal{F}^{-1}\\{\\hat{g}(\\mathbf{k})\\}$.\n        d. The integral is then computed as a Riemann sum in real space: $\\frac{1}{2}\\sum_{i,j} n(x_i, y_j) g(x_i, y_j) \\Delta x \\Delta y$.\n\n3.  **Construction of the Slipped State**: The problem defines a configuration $n_\\Delta(x,y)$ that models a crystal with its upper half ($y > y_0$) shifted relative to its lower half ($y < y_0$) by a displacement $\\Delta$ along the $x$-axis. This is achieved by smoothly blending an unshifted triangular crystal field, $n_{\\text{tri}}(x,y)$, with a shifted one, $n_{\\text{tri}}(x-\\Delta, y)$, using a hyperbolic tangent function $S(y)$:\n    $$\n    n_{\\Delta}(x,y) = S(y)\\, n_{\\text{tri}}(x - \\Delta, y) + \\left[1 - S(y)\\right]\\, n_{\\text{tri}}(x, y)\n    $$\n    The one-mode approximation for the triangular lattice, $n_{\\text{tri}}$, is constructed using the given wave vectors $\\mathbf{k}_1$, $\\mathbf{k}_2$, and $\\mathbf{k}_3$, which are commensurate with the chosen simulation domain.\n\n4.  **Peierls Barrier Calculation**: The Peierls barrier, $B$, quantifies the energy cost of sliding one atomic plane over another. It is defined as the difference between the maximum and minimum energy configurations during the slip process, normalized by the length of the slip plane, $L_x$. The algorithm calculates $B$ as follows:\n    a. A set of $64$ evenly spaced displacement values, $\\Delta$, is generated over the range $[0, L_x)$.\n    b. For each $\\Delta$, the density field $n_\\Delta(x,y)$ is constructed.\n    c. The total free energy $F(\\Delta) = F[n_\\Delta]$ is computed using the hybrid-space method described above.\n    d. After iterating through all $\\Delta$ values, the maximum and minimum energies, $\\max F(\\Delta)$ and $\\min F(\\Delta)$, are found.\n    e. The barrier is calculated as $B = (\\max_{\\Delta} F(\\Delta) - \\min_{\\Delta} F(\\Delta)) / L_x$.\n\n5.  **Special Case**: For test case 4, the amplitude $A$ is $0$. This implies that $n_{\\text{tri}}(x,y) = n_0$. Since $n_0$ is also $0$, the density field $n(x,y)$ is identically zero for all configurations. Consequently, the free energy $F(\\Delta)$ is always zero, leading to a Peierls barrier $B=0$. The program handles this case efficiently by returning $0$ if $A=0$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef calculate_barrier(Nx, Ny, epsilon, n0, A, w, num_displacements):\n    \"\"\"\n    Calculates the Peierls barrier B for a given set of PFC parameters.\n    \"\"\"\n    # If the amplitude A is zero, the density field is constant (n0).\n    # The energy is independent of the shift delta, so the barrier is zero.\n    if A == 0.0:\n        return 0.0\n\n    # 1. Define constants, domain, and grid spacings\n    Lx = 4.0 * np.pi\n    Ly = 4.0 * np.pi / np.sqrt(3.0)\n    dx = Lx / Nx\n    dy = Ly / Ny\n    y0 = Ly / 2.0\n\n    # 2. Set up real and Fourier space grids\n    # Real space grid\n    x_vec = np.linspace(0, Lx, Nx, endpoint=False)\n    y_vec = np.linspace(0, Ly, Ny, endpoint=False)\n    xx, yy = np.meshgrid(x_vec, y_vec)\n\n    # Fourier space grid of wave numbers\n    kx_vec = 2 * np.pi * np.fft.fftfreq(Nx, d=dx)\n    ky_vec = 2 * np.pi * np.fft.fftfreq(Ny, d=dy)\n    kx, ky = np.meshgrid(kx_vec, ky_vec)\n    k_squared = kx**2 + ky**2\n\n    # 3. Pre-calculate terms that are constant over the delta loop\n    # Linear operator in Fourier space\n    linear_op_k = -epsilon + (1 - k_squared)**2\n    \n    # Blending function S(y)\n    S_y = 0.5 * (1 + np.tanh((yy - y0) / w))\n\n    # Wave vectors for the one-mode triangular lattice approximation\n    k1 = np.array([1.0, 0.0])\n    k2 = np.array([-0.5, np.sqrt(3.0) / 2.0])\n    k3 = np.array([-0.5, -np.sqrt(3.0) / 2.0])\n    \n    # Terms for constructing the unshifted triangular field\n    n_tri_term1_base = k1[0] * xx + k1[1] * yy\n    n_tri_term2_base = k2[0] * xx + k2[1] * yy\n    n_tri_term3_base = k3[0] * xx + k3[1] * yy\n    \n    n_tri_0 = n0 + 2 * A * (np.cos(n_tri_term1_base) + np.cos(n_tri_term2_base) + np.cos(n_tri_term3_base))\n\n    # 4. Loop over displacements delta to calculate F(delta)\n    delta_vals = np.linspace(0, Lx, num_displacements, endpoint=False)\n    F_delta_list = []\n\n    for delta in delta_vals:\n        # Construct the shifted triangular field n_tri(x-delta, y)\n        n_tri_term1_shifted = n_tri_term1_base - k1[0] * delta\n        n_tri_term2_shifted = n_tri_term2_base - k2[0] * delta\n        n_tri_term3_shifted = n_tri_term3_base - k3[0] * delta\n\n        n_tri_shifted = n0 + 2 * A * (np.cos(n_tri_term1_shifted) + np.cos(n_tri_term2_shifted) + np.cos(n_tri_term3_shifted))\n        \n        # Construct the full blended field n_delta(x, y)\n        n_delta = S_y * n_tri_shifted + (1 - S_y) * n_tri_0\n        \n        # Calculate the free energy F(delta)\n        \n        # Linear part (calculated in Fourier space)\n        n_delta_hat = np.fft.fft2(n_delta)\n        op_n_hat = linear_op_k * n_delta_hat\n        op_n = np.fft.ifft2(op_n_hat)\n        # Integrand is 0.5 * n * op(n). Summing over grid and multiplying by area element completes integration.\n        E_lin = 0.5 * np.sum(n_delta * np.real(op_n)) * dx * dy\n        \n        # Nonlinear part (calculated in real space)\n        E_nonlin = 0.25 * np.sum(n_delta**4) * dx * dy\n        \n        F_delta = E_lin + E_nonlin\n        F_delta_list.append(F_delta)\n\n    # 5. Compute the Peierls barrier B\n    F_max = np.max(F_delta_list)\n    F_min = np.min(F_delta_list)\n    \n    B = (F_max - F_min) / Lx\n    return B\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (Nx, Ny, epsilon, n0, A, w, num_displacements)\n        (128, 128, 0.05, -0.10, 0.27, 0.08, 64),\n        (128, 128, 0.02, -0.05, 0.12, 0.08, 64),\n        (128, 128, 0.20, -0.15, 0.35, 0.04, 64),\n        (128, 128, 0.05,  0.00, 0.00, 0.08, 64),\n    ]\n\n    results = []\n    for case in test_cases:\n        # Unpack parameters and calculate the barrier for the current case.\n        Nx, Ny, epsilon, n0, A, w, num_displacements = case\n        result = calculate_barrier(Nx, Ny, epsilon, n0, A, w, num_displacements)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "A key challenge in materials modeling is bridging the gap between microscopic dynamics and macroscopic, experimentally observable properties. This exercise  tackles this challenge by showing how the PFC model, which operates on atomic length and diffusive time scales, can be used to derive the viscoelastic response of a material. You will connect the microscopic PFC parameters to a macroscopic constitutive model to compute the steady-state shear stress, providing a direct link between the model and continuum mechanics.",
            "id": "3475589",
            "problem": "Consider the Phase-Field Crystal (PFC) model, defined by the free-energy functional and conserved dynamics for a scalar order parameter field. The Phase-Field Crystal (PFC) model represents atomic-scale density modulations and their diffusive relaxation on long time scales. Let the free-energy functional be\n$$\nF[\\psi] = \\int_{\\Omega} \\mathrm{d}\\mathbf{r} \\left( \\frac{1}{2}\\,\\psi \\left[ r + \\left(1 + \\nabla^2\\right)^2 \\right] \\psi + \\frac{1}{4}\\,\\psi^4 \\right),\n$$\nwhere $\\,\\psi(\\mathbf{r},t)\\,$ is the dimensionless atomic density field, $\\,r\\,$ is a control parameter, $\\,\\Omega\\,$ is a periodic domain, and $\\,\\nabla^2\\,$ is the Laplacian. The diffusive, conserved dynamics is\n$$\n\\frac{\\partial \\psi}{\\partial t} + \\mathbf{v}\\cdot\\nabla \\psi = M \\nabla^2 \\mu, \\quad \\mu = \\frac{\\delta F}{\\delta \\psi} = \\left[ r + \\left(1 + \\nabla^2\\right)^2 \\right]\\psi + \\psi^3,\n$$\nwhere $\\,M\\,$ is a mobility and $\\,\\mu\\,$ is the chemical potential. An imposed macroscopic simple shear flow with constant shear rate $\\,\\dot{\\gamma}\\,$ along the $\\,x\\,$-direction and gradient in the $\\,y\\,$-direction is given by $\\,\\mathbf{v}(\\mathbf{r},t) = \\left(\\dot{\\gamma}\\,y,\\,0\\right)\\,$. In the PFC context, this macroscopic shear can be incorporated either by Leesâ€“Edwards sliding periodic boundary conditions or equivalently by transforming to a moving (sheared) frame $\\,x' = x - \\gamma(t)\\,y\\,$ with $\\,\\gamma(t) = \\dot{\\gamma}\\,t\\,$, which introduces an advective term $\\,\\mathbf{v}\\cdot\\nabla \\psi\\,$ in the laboratory frame.\n\nYou will show how applied shear enters through boundary conditions or a moving frame in the dynamics, and then compute the steady-state shear stress under a constant shear rate $\\,\\dot{\\gamma}\\,$ using a coarse-grained reduction appropriate to long-wavelength, small-strain response. In particular, consider a uniform shear deformation where the microscopic displacement field $\\,\\mathbf{u}(\\mathbf{r},t)\\,$ is such that the infinitesimal shear strain is $\\,\\epsilon_{xy}(t) = \\partial u_x / \\partial y\\,$ and the corresponding macroscopic shear stress is $\\,\\sigma_{xy}(t)\\,$. Assume\n\n- $\\,\\epsilon_{xy}(t)\\,$ is spatially uniform over $\\,\\Omega\\,$ and sufficiently small that quadratic elastic contributions dominate.\n- Overdamped diffusive relaxation consistent with conserved PFC dynamics, with no inertia.\n- The coarse-grained elastic free energy density for small homogeneous shear is $\\,\\frac{1}{2} G\\,\\epsilon_{xy}^2\\,$, where $\\,G\\,$ is an effective shear modulus obtained from the second derivative of $\\,F\\,$ with respect to $\\,\\epsilon_{xy}\\,$.\n- The diffusive relaxation of shear strain is characterized by a single relaxation time $\\,\\tau\\,$ arising from the mobility $\\,M\\,$ and the curvature of the free energy landscape associated with shear modes.\n\nStarting from these foundations, derive a constitutive evolution equation for $\\,\\sigma_{xy}(t)\\,$ under a constant shear rate $\\,\\dot{\\gamma}\\,$ and obtain the steady-state shear stress $\\,\\sigma_{xy}^{\\text{ss}}\\,$ reached as $\\,t \\to \\infty\\,$. Your derivation must begin from the given free-energy functional and dynamics, explicitly justify how shear enters via boundary conditions or the moving frame transformation, and proceed to a coarse-grained, long-time description consistent with the assumptions above. Do not use pre-stated constitutive formulas; instead, derive any needed relations from the model and assumptions.\n\nImplementation requirement:\n\n- Express the final steady-state shear stress $\\,\\sigma_{xy}^{\\text{ss}}\\,$ in dimensionless units.\n- Your program must take as input (internally, without user interaction) a fixed test suite of parameter sets $\\,\\{(G,\\tau,\\dot{\\gamma})\\}\\,$, compute $\\,\\sigma_{xy}^{\\text{ss}}\\,$ for each, and output all results in the specified format.\n\nTest suite:\n\n- Case $\\,1\\,$: $\\,G = 30.0\\,$, $\\,\\tau = 2.5\\,$, $\\,\\dot{\\gamma} = 0.02\\,$.\n- Case $\\,2\\,$: $\\,G = 15.0\\,$, $\\,\\tau = 0.1\\,$, $\\,\\dot{\\gamma} = 0.0\\,$.\n- Case $\\,3\\,$: $\\,G = 50.0\\,$, $\\,\\tau = 10.0\\,$, $\\,\\dot{\\gamma} = 0.005\\,$.\n- Case $\\,4\\,$: $\\,G = 5.0\\,$, $\\,\\tau = 0.001\\,$, $\\,\\dot{\\gamma} = 1000.0\\,$.\n- Case $\\,5\\,$: $\\,G = 80.0\\,$, $\\,\\tau = 0.5\\,$, $\\,\\dot{\\gamma} = 0.1\\,$.\n\nFinal output format:\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, i.e., $\\,\\left[\\text{result}_1,\\text{result}_2,\\text{result}_3,\\text{result}_4,\\text{result}_5\\right]\\,$, where each $\\,\\text{result}_i\\,$ is the computed $\\,\\sigma_{xy}^{\\text{ss}}\\,$ for the corresponding test case, expressed as a floating-point number in dimensionless units.",
            "solution": "The objective is to derive a constitutive evolution equation for the macroscopic shear stress $\\sigma_{xy}(t)$ and subsequently find its steady-state value $\\sigma_{xy}^{\\text{ss}}$ for a system governed by the Phase-Field Crystal model under a constant applied shear rate $\\dot{\\gamma}$. The analysis begins by establishing the connection between the microscopic PFC model and a macroscopic, coarse-grained description of viscoelasticity, as guided by the problem's assumptions.\n\nThe PFC free-energy functional is given by\n$$F[\\psi] = \\int_{\\Omega} \\mathrm{d}\\mathbf{r} \\left( \\frac{1}{2}\\,\\psi \\left[ r + \\left(1 + \\nabla^2\\right)^2 \\right] \\psi + \\frac{1}{4}\\,\\psi^4 \\right)$$\nThe elastic properties of the crystal phase are encoded in this functional. The coarse-grained shear modulus, $G$, represents the energetic penalty for a spatially uniform shear deformation of the periodic density field $\\psi$. It is formally defined as the second derivative of the free-energy density with respect to the shear strain $\\epsilon_{xy}$ at zero strain. The problem provides $G$ as a given parameter, bypassing its explicit calculation from $F[\\psi]$. The elastic component of the free energy density is thus given as $f_{el} = \\frac{1}{2} G\\,\\epsilon_{xy}^2$.\n\nThe relationship between the elastic shear stress, $\\sigma_{xy}^{el}$, and the elastic shear strain, $\\epsilon_{xy}^{el}$, is obtained by differentiating the elastic free energy density with respect to the strain:\n$$\\sigma_{xy} = \\frac{\\partial f_{el}}{\\partial \\epsilon_{xy}^{el}} = G\\,\\epsilon_{xy}^{el}$$\nThis is Hooke's law for shear. Note that the total stress $\\sigma_{xy}$ in the system is carried by the elastic deformation of the crystal lattice.\n\nThe system is subjected to a constant, externally imposed shear rate, $\\dot{\\gamma}$. The total shear strain rate, $\\dot{\\epsilon}_{xy} = \\frac{d\\epsilon_{xy}}{dt}$, is therefore equal to $\\dot{\\gamma}$. In a viscoelastic material, this total strain rate is the sum of the rate of change of the elastic strain, $\\dot{\\epsilon}_{xy}^{el}$, and the rate of plastic (or viscous) strain, $\\dot{\\epsilon}_{xy}^{pl}$:\n$$\\dot{\\epsilon}_{xy} = \\dot{\\epsilon}_{xy}^{el} + \\dot{\\epsilon}_{xy}^{pl} = \\dot{\\gamma}$$\n\nThe rate of elastic strain can be expressed in terms of the rate of change of stress by taking the time derivative of Hooke's law:\n$$\\dot{\\epsilon}_{xy}^{el} = \\frac{d}{dt}\\left(\\frac{\\sigma_{xy}}{G}\\right) = \\frac{1}{G} \\frac{d\\sigma_{xy}}{dt}$$\n\nThe plastic strain rate, $\\dot{\\epsilon}_{xy}^{pl}$, represents irreversible flow. This process is governed by the diffusive dynamics of the PFC model, $\\frac{\\partial \\psi}{\\partial t} + \\mathbf{v}\\cdot\\nabla \\psi = M \\nabla^2 \\mu$. The mobility $M$ sets the timescale for the system to relax towards a free energy minimum by rearranging the density field, for instance, through dislocation glide. Stress is relaxed through this plastic deformation. The problem assumes this complex microscopic process can be described by a single macroscopic relaxation time, $\\tau$. In the framework of linear viscoelasticity, for an overdamped system, the rate of plastic flow is driven by the applied stress. The simplest model consistent with the problem's assumption is one where the plastic strain rate is proportional to the stress, which defines a Maxwell fluid. The relationship is\n$$\\dot{\\epsilon}_{xy}^{pl} = \\frac{\\sigma_{xy}}{\\eta}$$\nwhere $\\eta$ is the shear viscosity. The relaxation time $\\tau$ is the time it would take for stress to decay in the absence of external driving ($\\dot{\\gamma}=0$) if the strain were held constant. In that scenario, $\\dot{\\epsilon}_{xy}^{el} = -\\dot{\\epsilon}_{xy}^{pl}$, leading to $\\frac{1}{G} \\frac{d\\sigma_{xy}}{dt} = -\\frac{\\sigma_{xy}}{\\eta}$. The solution to this is $\\sigma_{xy}(t) = \\sigma_0 \\exp(-t/(\\eta/G))$. Thus, the relaxation time $\\tau$ is identified as $\\tau = \\eta/G$. We can therefore write the viscosity as $\\eta = G\\tau$. The plastic strain rate becomes:\n$$\\dot{\\epsilon}_{xy}^{pl} = \\frac{\\sigma_{xy}}{G\\tau}$$\n\nNow, we assemble the full constitutive equation by substituting the expressions for the elastic and plastic strain rates into the total strain rate equation:\n$$\\dot{\\gamma} = \\frac{1}{G} \\frac{d\\sigma_{xy}}{dt} + \\frac{\\sigma_{xy}}{G\\tau}$$\nMultiplying by $G\\tau$ gives the evolution equation for the shear stress:\n$$\\tau \\frac{d\\sigma_{xy}}{dt} + \\sigma_{xy} = G\\tau\\dot{\\gamma}$$\nThis is the constitutive equation for the Maxwell model of linear viscoelasticity, which has been derived from the physical principles and coarse-graining assumptions laid out in the problem statement.\n\nThe final step is to determine the steady-state shear stress, $\\sigma_{xy}^{\\text{ss}}$, which is the value of $\\sigma_{xy}$ as $t \\to \\infty$. In steady state, the system variables are constant in time, so their time derivatives are zero. Setting $\\frac{d\\sigma_{xy}}{dt} = 0$ in the constitutive equation yields:\n$$\\tau \\cdot (0) + \\sigma_{xy}^{\\text{ss}} = G\\tau\\dot{\\gamma}$$\nThis gives the steady-state shear stress:\n$$\\sigma_{xy}^{\\text{ss}} = G \\tau \\dot{\\gamma}$$\n\nThis result indicates that under continuous shear, the viscoelastic solid flows like a simple viscous fluid with an effective shear viscosity $\\eta = G\\tau$. The steady-state stress is directly proportional to the shear modulus, the relaxation time, and the applied shear rate. This formula will be used to compute the results for the given test cases.\n\nThe calculation for each test case $(G, \\tau, \\dot{\\gamma})$ is performed using this derived formula.\nFor Case $1$: $\\sigma_{xy}^{\\text{ss}} = (30.0)(2.5)(0.02) = 1.5$.\nFor Case $2$: $\\sigma_{xy}^{\\text{ss}} = (15.0)(0.1)(0.0) = 0.0$.\nFor Case $3$: $\\sigma_{xy}^{\\text{ss}} = (50.0)(10.0)(0.005) = 2.5$.\nFor Case $4$: $\\sigma_{xy}^{\\text{ss}} = (5.0)(0.001)(1000.0) = 5.0$.\nFor Case $5$: $\\sigma_{xy}^{\\text{ss}} = (80.0)(0.5)(0.1) = 4.0$.\n\nThese numerical results are implemented in the provided Python code.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the steady-state shear stress for a viscoelastic material\n    described by a Maxwell model, based on parameters derived from a\n    coarse-grained Phase-Field Crystal (PFC) model.\n\n    The derivation shows that for a system with shear modulus G,\n    relaxation time tau, under a constant shear rate gamma_dot,\n    the constitutive equation is:\n    sigma + tau * d(sigma)/dt = G * tau * gamma_dot\n\n    In steady state, d(sigma)/dt = 0, which simplifies to:\n    sigma_ss = G * tau * gamma_dot\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (G, tau, gamma_dot)\n    # G: effective shear modulus (dimensionless)\n    # tau: shear strain relaxation time (dimensionless)\n    # gamma_dot: constant shear rate (dimensionless)\n    test_cases = [\n        (30.0, 2.5, 0.02),    # Case 1\n        (15.0, 0.1, 0.0),     # Case 2\n        (50.0, 10.0, 0.005),  # Case 3\n        (5.0, 0.001, 1000.0), # Case 4\n        (80.0, 0.5, 0.1),     # Case 5\n    ]\n\n    results = []\n    for case in test_cases:\n        # Unpack parameters for the current case.\n        G, tau, gamma_dot = case\n        \n        # Calculate the steady-state shear stress using the derived formula.\n        # sigma_ss = G * tau * gamma_dot\n        sigma_ss = G * tau * gamma_dot\n        \n        results.append(sigma_ss)\n\n    # Format the results into a single string as specified.\n    # The output should be a comma-separated list of floating-point numbers\n    # enclosed in square brackets.\n    # Using str() on floats is sufficient to get the required representation.\n    output_string = f\"[{','.join(map(str, results))}]\"\n\n    # Final print statement in the exact required format.\n    print(output_string)\n\nsolve()\n```"
        }
    ]
}