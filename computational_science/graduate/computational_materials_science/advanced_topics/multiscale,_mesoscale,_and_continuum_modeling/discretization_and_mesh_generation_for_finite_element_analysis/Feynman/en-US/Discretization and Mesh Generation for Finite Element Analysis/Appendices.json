{
    "hands_on_practices": [
        {
            "introduction": "The accuracy of a finite element simulation depends critically on the choice of shape functions used to approximate the solution within each element. While linear elements are the simplest, higher-order elements like the quadratic ($P_2$) triangle can capture complex field variations with fewer elements, improving efficiency and accuracy. This exercise  provides fundamental practice in constructing these powerful higher-order functions from first principles using barycentric coordinates, an elegant and essential coordinate system for working with triangular elements.",
            "id": "3445730",
            "problem": "Consider a single nondegenerate triangle $\\mathcal{T}$ in the plane with vertices $\\boldsymbol{v}_{1}=(x_{1},y_{1})$, $\\boldsymbol{v}_{2}=(x_{2},y_{2})$, and $\\boldsymbol{v}_{3}=(x_{3},y_{3})$, where the signed area $A$ satisfies $A \\neq 0$. Define the barycentric (area) coordinates $\\lambda_{1}$, $\\lambda_{2}$, $\\lambda_{3}$ on $\\mathcal{T}$ by the affine relations $\\lambda_{1}+\\lambda_{2}+\\lambda_{3}=1$ and $\\boldsymbol{x}=\\lambda_{1}\\boldsymbol{v}_{1}+\\lambda_{2}\\boldsymbol{v}_{2}+\\lambda_{3}\\boldsymbol{v}_{3}$ for any point $\\boldsymbol{x}=(x,y)\\in\\mathcal{T}$. Consider the quadratic Lagrange ($P_{2}$) finite element on $\\mathcal{T}$ with the following nodal set: the $3$ vertices and the $3$ edge midpoints $\\boldsymbol{m}_{12}=\\frac{1}{2}(\\boldsymbol{v}_{1}+\\boldsymbol{v}_{2})$, $\\boldsymbol{m}_{23}=\\frac{1}{2}(\\boldsymbol{v}_{2}+\\boldsymbol{v}_{3})$, and $\\boldsymbol{m}_{31}=\\frac{1}{2}(\\boldsymbol{v}_{3}+\\boldsymbol{v}_{1})$. Let the nodal ordering be $(\\boldsymbol{v}_{1},\\boldsymbol{v}_{2},\\boldsymbol{v}_{3},\\boldsymbol{m}_{12},\\boldsymbol{m}_{23},\\boldsymbol{m}_{31})$.\n\nUsing only the core definitions of barycentric coordinates, polynomial spaces, and the Lagrange interpolation property for nodal finite elements, do the following:\n\n1) Construct the $6$ quadratic shape functions $N_{1},\\dots,N_{6}$ in terms of the barycentric coordinates $(\\lambda_{1},\\lambda_{2},\\lambda_{3})$ such that each $N_{i}$ is a polynomial of total degree $2$, $N_{i}$ equals $1$ at node $i$ and $0$ at all other nodes, and $\\sum_{i=1}^{6}N_{i}=1$ on $\\mathcal{T}$.\n\n2) Derive the gradients $\\nabla N_{i}$ in global Cartesian coordinates $(x,y)$ in terms of $\\nabla \\lambda_{1}$, $\\nabla \\lambda_{2}$, and $\\nabla \\lambda_{3}$, and then express $\\nabla \\lambda_{i}$ for $i\\in\\{1,2,3\\}$ in terms of the vertex coordinates $(x_{j},y_{j})$ and the area $A$.\n\n3) Prove that for any polynomial $p(x,y)$ of total degree at most $2$, the nodal interpolant $I_{\\mathcal{T}}p=\\sum_{i=1}^{6}p(\\boldsymbol{x}_{i})\\,N_{i}$ reproduces $p$ exactly on $\\mathcal{T}$.\n\nAs your final answer, report the $6$ shape functions as a single row vector in barycentric coordinates, in the nodal order $(\\boldsymbol{v}_{1},\\boldsymbol{v}_{2},\\boldsymbol{v}_{3},\\boldsymbol{m}_{12},\\boldsymbol{m}_{23},\\boldsymbol{m}_{31})$. No numerical approximation or rounding is required. Do not include units.",
            "solution": "The problem is well-posed, scientifically grounded, and contains all necessary information for a unique solution. It is a standard problem in the theory of finite element methods. We may proceed with the solution.\n\nThe problem asks for three tasks related to the quadratic ($P_2$) Lagrange finite element on a triangular domain $\\mathcal{T}$. Let the vertices be $\\boldsymbol{v}_{1}$, $\\boldsymbol{v}_{2}$, $\\boldsymbol{v}_{3}$, and the edge midpoints be $\\boldsymbol{m}_{12}$, $\\boldsymbol{m}_{23}$, $\\boldsymbol{m}_{31}$. The six nodes for the element are ordered as $\\boldsymbol{x}_1=\\boldsymbol{v}_1$, $\\boldsymbol{x}_2=\\boldsymbol{v}_2$, $\\boldsymbol{x}_3=\\boldsymbol{v}_3$, $\\boldsymbol{x}_4=\\boldsymbol{m}_{12}$, $\\boldsymbol{x}_5=\\boldsymbol{m}_{23}$, $\\boldsymbol{x}_6=\\boldsymbol{m}_{31}$.\n\nAny point $\\boldsymbol{x} \\in \\mathcal{T}$ can be uniquely represented by barycentric coordinates $(\\lambda_1, \\lambda_2, \\lambda_3)$ such that $\\boldsymbol{x} = \\lambda_1 \\boldsymbol{v}_1 + \\lambda_2 \\boldsymbol{v}_2 + \\lambda_3 \\boldsymbol{v}_3$ and $\\lambda_1 + \\lambda_2 + \\lambda_3 = 1$. The barycentric coordinates of the six nodes are:\n- $\\boldsymbol{v}_1$: $(\\lambda_1, \\lambda_2, \\lambda_3) = (1, 0, 0)$\n- $\\boldsymbol{v}_2$: $(\\lambda_1, \\lambda_2, \\lambda_3) = (0, 1, 0)$\n- $\\boldsymbol{v}_3$: $(\\lambda_1, \\lambda_2, \\lambda_3) = (0, 0, 1)$\n- $\\boldsymbol{m}_{12} = \\frac{1}{2}\\boldsymbol{v}_1 + \\frac{1}{2}\\boldsymbol{v}_2$: $(\\lambda_1, \\lambda_2, \\lambda_3) = (\\frac{1}{2}, \\frac{1}{2}, 0)$\n- $\\boldsymbol{m}_{23} = \\frac{1}{2}\\boldsymbol{v}_2 + \\frac{1}{2}\\boldsymbol{v}_3$: $(\\lambda_1, \\lambda_2, \\lambda_3) = (0, \\frac{1}{2}, \\frac{1}{2})$\n- $\\boldsymbol{m}_{31} = \\frac{1}{2}\\boldsymbol{v}_3 + \\frac{1}{2}\\boldsymbol{v}_1$: $(\\lambda_1, \\lambda_2, \\lambda_3) = (\\frac{1}{2}, 0, \\frac{1}{2})$\n\nThe shape functions $N_i$ must be quadratic polynomials (total degree $2$ in $\\lambda_j$) and satisfy the Lagrange property $N_i(\\boldsymbol{x}_j) = \\delta_{ij}$, where $\\delta_{ij}$ is the Kronecker delta.\n\n**1) Construction of Shape Functions $N_i$**\n\nWe construct each shape function by identifying lines on which it must be zero. For a polynomial to be zero on a line, the linear equation of that line must be a factor of the polynomial.\n\n- **Shape function $N_1$ for vertex $\\boldsymbol{v}_1$**:\n$N_1$ must be zero at nodes $\\boldsymbol{x}_2, \\boldsymbol{x}_3, \\boldsymbol{x}_4, \\boldsymbol{x}_5, \\boldsymbol{x}_6$.\nThe nodes $\\boldsymbol{v}_2$, $\\boldsymbol{v}_3$, and $\\boldsymbol{m}_{23}$ lie on the edge opposite to $\\boldsymbol{v}_1$. The equation of this line is $\\lambda_1 = 0$. Therefore, $\\lambda_1$ must be a factor of $N_1$.\nThe nodes $\\boldsymbol{m}_{12}$ and $\\boldsymbol{m}_{31}$ lie on the line connecting the midpoints of the two edges adjacent to $\\boldsymbol{v}_1$. The barycentric coordinates on this line satisfy $\\lambda_1 = \\frac{1}{2}$. Thus, $(\\lambda_1 - \\frac{1}{2})$ must be a factor of $N_1$.\nCombining these, $N_1$ must be of the form $N_1 = c_1 \\lambda_1 (\\lambda_1 - \\frac{1}{2})$ for some constant $c_1$. This is a quadratic polynomial.\nTo find $c_1$, we enforce the condition $N_1(\\boldsymbol{v}_1) = 1$. At $\\boldsymbol{v}_1$, $\\lambda_1 = 1$.\n$N_1(\\boldsymbol{v}_1) = c_1 (1) (1 - \\frac{1}{2}) = \\frac{c_1}{2} = 1 \\implies c_1 = 2$.\nSo, $N_1 = 2\\lambda_1(\\lambda_1 - \\frac{1}{2}) = \\lambda_1(2\\lambda_1 - 1)$.\nBy cyclic permutation of indices, the shape functions for the other two vertices are:\n$N_2 = \\lambda_2(2\\lambda_2 - 1)$\n$N_3 = \\lambda_3(2\\lambda_3 - 1)$\n\n- **Shape function $N_4$ for midpoint $\\boldsymbol{m}_{12}$**:\n$N_4$ must be zero at nodes $\\boldsymbol{v}_1, \\boldsymbol{v}_2, \\boldsymbol{v}_3, \\boldsymbol{m}_{23}, \\boldsymbol{m}_{31}$.\nThe nodes $\\boldsymbol{v}_2, \\boldsymbol{v}_3, \\boldsymbol{m}_{23}$ lie on the line $\\lambda_1 = 0$. So $\\lambda_1$ is a factor.\nThe nodes $\\boldsymbol{v}_1, \\boldsymbol{v}_3, \\boldsymbol{m}_{31}$ lie on the line $\\lambda_2 = 0$. So $\\lambda_2$ is a factor.\nThus, $N_4$ has the form $N_4 = c_4 \\lambda_1 \\lambda_2$. This is a quadratic polynomial.\nTo find $c_4$, we enforce $N_4(\\boldsymbol{m}_{12}) = 1$. At $\\boldsymbol{m}_{12}$, $\\lambda_1=\\frac{1}{2}$ and $\\lambda_2=\\frac{1}{2}$.\n$N_4(\\boldsymbol{m}_{12}) = c_4 (\\frac{1}{2})(\\frac{1}{2}) = \\frac{c_4}{4} = 1 \\implies c_4 = 4$.\nSo, $N_4 = 4\\lambda_1\\lambda_2$.\nBy cyclic permutation, the shape functions for the other two midpoints are:\n$N_5 = 4\\lambda_2\\lambda_3$\n$N_6 = 4\\lambda_3\\lambda_1$\n\nFinally, we verify the partition of unity property, $\\sum_{i=1}^6 N_i = 1$:\n$\\sum_{i=1}^6 N_i = \\lambda_1(2\\lambda_1-1) + \\lambda_2(2\\lambda_2-1) + \\lambda_3(2\\lambda_3-1) + 4\\lambda_1\\lambda_2 + 4\\lambda_2\\lambda_3 + 4\\lambda_3\\lambda_1$\n$= (2\\lambda_1^2 + 2\\lambda_2^2 + 2\\lambda_3^2 + 4\\lambda_1\\lambda_2 + 4\\lambda_2\\lambda_3 + 4\\lambda_3\\lambda_1) - (\\lambda_1 + \\lambda_2 + \\lambda_3)$\n$= 2(\\lambda_1^2 + \\lambda_2^2 + \\lambda_3^2 + 2\\lambda_1\\lambda_2 + 2\\lambda_2\\lambda_3 + 2\\lambda_3\\lambda_1) - (\\lambda_1 + \\lambda_2 + \\lambda_3)$\nUsing the identities $(\\lambda_1+\\lambda_2+\\lambda_3)^2 = \\lambda_1^2+\\dots+2\\lambda_1\\lambda_2+\\dots$ and $\\lambda_1+\\lambda_2+\\lambda_3=1$:\n$= 2(\\lambda_1+\\lambda_2+\\lambda_3)^2 - (\\lambda_1+\\lambda_2+\\lambda_3) = 2(1)^2 - 1 = 1$.\nThe property holds.\n\n**2) Gradients of Shape Functions**\n\nThe gradient operator in Cartesian coordinates is $\\nabla = (\\frac{\\partial}{\\partial x}, \\frac{\\partial}{\\partial y})^T$. Since each $N_i$ is a function of the barycentric coordinates, which are themselves functions of $(x,y)$, we use the chain rule:\n$\\nabla N_i = \\frac{\\partial N_i}{\\partial \\lambda_1}\\nabla\\lambda_1 + \\frac{\\partial N_i}{\\partial \\lambda_2}\\nabla\\lambda_2 + \\frac{\\partial N_i}{\\partial \\lambda_3}\\nabla\\lambda_3$.\n\n- For vertex nodes ($i=1,2,3$):\n$\\nabla N_1 = \\nabla(2\\lambda_1^2 - \\lambda_1) = (4\\lambda_1-1)\\nabla\\lambda_1$\n$\\nabla N_2 = (4\\lambda_2-1)\\nabla\\lambda_2$\n$\\nabla N_3 = (4\\lambda_3-1)\\nabla\\lambda_3$\n\n- For midpoint nodes ($i=4,5,6$):\n$\\nabla N_4 = \\nabla(4\\lambda_1\\lambda_2) = 4\\lambda_2\\nabla\\lambda_1 + 4\\lambda_1\\nabla\\lambda_2$\n$\\nabla N_5 = \\nabla(4\\lambda_2\\lambda_3) = 4\\lambda_3\\nabla\\lambda_2 + 4\\lambda_2\\nabla\\lambda_3$\n$\\nabla N_6 = \\nabla(4\\lambda_3\\lambda_1) = 4\\lambda_1\\nabla\\lambda_3 + 4\\lambda_3\\nabla\\lambda_1$\n\nNext, we express $\\nabla\\lambda_i$ in terms of vertex coordinates. The barycentric coordinates are defined by the system:\n$$\n\\begin{pmatrix} x \\\\ y \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} x_1 & x_2 & x_3 \\\\ y_1 & y_2 & y_3 \\\\ 1 & 1 & 1 \\end{pmatrix} \\begin{pmatrix} \\lambda_1 \\\\ \\lambda_2 \\\\ \\lambda_3 \\end{pmatrix}\n$$\nThe determinant of the matrix is $D = x_1(y_2-y_3) + x_2(y_3-y_1) + x_3(y_1-y_2) = 2A$, where $A$ is the signed area of the triangle. Solving for $\\lambda_1$ using Cramer's rule:\n$$ \\lambda_1 = \\frac{1}{2A} \\det \\begin{pmatrix} x & x_2 & x_3 \\\\ y & y_2 & y_3 \\\\ 1 & 1 & 1 \\end{pmatrix} = \\frac{1}{2A} \\left( x(y_2-y_3) - y(x_2-x_3) + x_2y_3-x_3y_2 \\right) $$\nAs $\\lambda_1$ is a linear function of $x$ and $y$, its gradient is a constant vector:\n$$ \\nabla \\lambda_1 = \\begin{pmatrix} \\partial \\lambda_1 / \\partial x \\\\ \\partial \\lambda_1 / \\partial y \\end{pmatrix} = \\frac{1}{2A} \\begin{pmatrix} y_2-y_3 \\\\ x_3-x_2 \\end{pmatrix} $$\nBy cyclic permutation of indices $(1 \\to 2, 2 \\to 3, 3 \\to 1)$, we find the other gradients:\n$$ \\nabla \\lambda_2 = \\frac{1}{2A} \\begin{pmatrix} y_3-y_1 \\\\ x_1-x_3 \\end{pmatrix} $$\n$$ \\nabla \\lambda_3 = \\frac{1}{2A} \\begin{pmatrix} y_1-y_2 \\\\ x_2-x_1 \\end{pmatrix} $$\n\n**3) Reproduction of Quadratic Polynomials**\n\nLet $P_2(\\mathcal{T})$ denote the space of polynomials of total degree at most $2$ on $\\mathcal{T}$. The dimension of this vector space is $\\dim(P_2) = \\frac{(2+1)(2+2)}{2} = 6$. The six shape functions $\\{N_1, \\dots, N_6\\}$ are elements of $P_2(\\mathcal{T})$. To prove they form a basis for $P_2(\\mathcal{T})$, we must show they are linearly independent.\n\nAssume a linear combination of the shape functions is zero everywhere on $\\mathcal{T}$:\n$$ \\sum_{j=1}^6 c_j N_j(\\boldsymbol{x}) = 0 \\quad \\forall \\boldsymbol{x} \\in \\mathcal{T} $$\nWe can evaluate this expression at each of the six nodes $\\boldsymbol{x}_i$ for $i=1, \\dots, 6$:\n$$ \\sum_{j=1}^6 c_j N_j(\\boldsymbol{x}_i) = 0 $$\nBy the Lagrange property, $N_j(\\boldsymbol{x}_i) = \\delta_{ij}$. The sum simplifies to:\n$$ \\sum_{j=1}^6 c_j \\delta_{ij} = c_i $$\nThis implies $c_i = 0$ for all $i \\in \\{1, \\dots, 6\\}$. Therefore, the set of shape functions $\\{N_1, \\dots, N_6\\}$ is linearly independent. Since there are $6$ linearly independent functions in a $6$-dimensional space, they form a basis for $P_2(\\mathcal{T})$.\n\nNow, let $p(x,y)$ be any polynomial of total degree at most $2$, so $p \\in P_2(\\mathcal{T})$. Since $\\{N_i\\}$ is a basis, $p$ can be uniquely written as a linear combination:\n$$ p(\\boldsymbol{x}) = \\sum_{i=1}^6 \\alpha_i N_i(\\boldsymbol{x}) $$\nTo find the coefficients $\\alpha_i$, we evaluate this equality at the nodes $\\boldsymbol{x}_j$:\n$$ p(\\boldsymbol{x}_j) = \\sum_{i=1}^6 \\alpha_i N_i(\\boldsymbolx_j) = \\sum_{i=1}^6 \\alpha_i \\delta_{ij} = \\alpha_j $$\nThe coefficients are the nodal values of the polynomial itself: $\\alpha_j = p(\\boldsymbol{x}_j)$. Substituting back gives:\n$$ p(\\boldsymbol{x}) = \\sum_{i=1}^6 p(\\boldsymbol{x}_i) N_i(\\boldsymbol{x}) $$\nThe right-hand side is precisely the definition of the nodal interpolant $I_{\\mathcal{T}}p$. Thus, for any $p \\in P_2(\\mathcal{T})$, we have $p(\\boldsymbol{x}) = I_{\\mathcal{T}}p(\\boldsymbol{x})$ for all $\\boldsymbol{x} \\in \\mathcal{T}$. This proves that the quadratic Lagrange interpolant reproduces quadratic polynomials exactly.\n\nThe final answer required is the set of 6 shape functions.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\lambda_{1}(2\\lambda_{1}-1) & \\lambda_{2}(2\\lambda_{2}-1) & \\lambda_{3}(2\\lambda_{3}-1) & 4\\lambda_{1}\\lambda_{2} & 4\\lambda_{2}\\lambda_{3} & 4\\lambda_{3}\\lambda_{1}\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "A crucial step in any finite element analysis is mapping the idealized reference element onto its actual shape and position in the physical mesh. For quadrilateral elements, this isoparametric mapping can result in distorted shapes that may compromise the simulation's validity. This problem  focuses on the Jacobian determinant, the key mathematical tool for evaluating the quality of this mapping and ensuring it remains invertible, which is a non-negotiable condition for a numerically stable and physically meaningful solution.",
            "id": "3445743",
            "problem": "Consider a single isoparametric bilinear quadrilateral finite element used to discretize a two-dimensional microstructure domain in Computational Materials Science. The element employs natural coordinates $\\xi,\\eta \\in [-1,1]$ and the standard bilinear shape functions $N_{i}(\\xi,\\eta)$ for $i=1,2,3,4$. The physical nodal coordinates $\\left(x_{i}, y_{i}\\right)$ (expressed in millimeters) are given in counterclockwise order starting from the bottom-left corner as:\n- Node $1$: $(x_{1},y_{1}) = (0,0)$,\n- Node $2$: $(x_{2},y_{2}) = (40,5)$,\n- Node $3$: $(x_{3},y_{3}) = (45,41)$,\n- Node $4$: $(x_{4},y_{4}) = (-3,38)$.\n\nThe isoparametric mapping from the reference square to the physical element is\n$$\nx(\\xi,\\eta) = \\sum_{i=1}^{4} N_{i}(\\xi,\\eta)\\, x_{i}, \\qquad\ny(\\xi,\\eta) = \\sum_{i=1}^{4} N_{i}(\\xi,\\eta)\\, y_{i},\n$$\nwith the Jacobian matrix\n$$\nJ(\\xi,\\eta) = \n\\begin{pmatrix}\n\\dfrac{\\partial x}{\\partial \\xi} & \\dfrac{\\partial x}{\\partial \\eta} \\\\\n\\dfrac{\\partial y}{\\partial \\xi} & \\dfrac{\\partial y}{\\partial \\eta}\n\\end{pmatrix}, \\quad \\text{and} \\quad \\det J(\\xi,\\eta) = \\dfrac{\\partial x}{\\partial \\xi}\\dfrac{\\partial y}{\\partial \\eta} - \\dfrac{\\partial x}{\\partial \\eta}\\dfrac{\\partial y}{\\partial \\xi}.\n$$\n\nUsing the standard Gaussâ€“Legendre $2\\times 2$ integration rule, the Gauss points are located at $(\\xi,\\eta) = \\left(\\pm \\dfrac{1}{\\sqrt{3}}, \\pm \\dfrac{1}{\\sqrt{3}}\\right)$. Starting only from the definitions of the bilinear shape functions and the isoparametric mapping, perform the following:\n- Compute $\\det J$ at all four Gauss integration points.\n- Derive the functional form of $\\det J(\\xi,\\eta)$ and use appropriate mathematical reasoning to determine whether the mapping is invertible throughout the entire element (i.e., whether $\\det J(\\xi,\\eta) > 0$ for all $(\\xi,\\eta) \\in [-1,1]^2$).\n- Determine the minimum value of $\\det J$ over the closed parameter domain $[-1,1]^2$.\n\nRound your final minimum determinant value to four significant figures and express it in square millimeters (mm$^2$). The final reported answer must be a single real number.",
            "solution": "The problem requires a detailed analysis of the isoparametric mapping for a single bilinear quadrilateral element. The primary objectives are to compute the Jacobian determinant, $\\det J$, at specific points, analyze the invertibility of the mapping by finding the sign of $\\det J$ across the element's domain, and determine the minimum value of $\\det J$.\n\nFirst, we define the standard bilinear shape functions $N_i(\\xi, \\eta)$ for a quadrilateral element in the natural coordinate system $(\\xi, \\eta)$, where $\\xi \\in [-1, 1]$ and $\\eta \\in [-1, 1]$:\n$$\n\\begin{aligned}\nN_1(\\xi, \\eta) &= \\frac{1}{4}(1-\\xi)(1-\\eta) \\\\\nN_2(\\xi, \\eta) &= \\frac{1}{4}(1+\\xi)(1-\\eta) \\\\\nN_3(\\xi, \\eta) &= \\frac{1}{4}(1+\\xi)(1+\\eta) \\\\\nN_4(\\xi, \\eta) &= \\frac{1}{4}(1-\\xi)(1+\\eta)\n\\end{aligned}\n$$\n\nThe isoparametric mapping relates the natural coordinates $(\\xi, \\eta)$ to the physical coordinates $(x, y)$ using these shape functions and the nodal coordinates $(x_i, y_i)$:\n$$\nx(\\xi,\\eta) = \\sum_{i=1}^{4} N_{i}(\\xi,\\eta)\\, x_{i}, \\qquad y(\\xi,\\eta) = \\sum_{i=1}^{4} N_{i}(\\xi,\\eta)\\, y_{i}\n$$\nThe Jacobian matrix $J$ of this transformation requires the partial derivatives of $x$ and $y$ with respect to $\\xi$ and $\\eta$. We first compute the derivatives of the shape functions.\nDerivatives with respect to $\\xi$:\n$$\n\\frac{\\partial N_1}{\\partial \\xi} = -\\frac{1}{4}(1-\\eta), \\quad \\frac{\\partial N_2}{\\partial \\xi} = \\frac{1}{4}(1-\\eta), \\quad \\frac{\\partial N_3}{\\partial \\xi} = \\frac{1}{4}(1+\\eta), \\quad \\frac{\\partial N_4}{\\partial \\xi} = -\\frac{1}{4}(1+\\eta)\n$$\nDerivatives with respect to $\\eta$:\n$$\n\\frac{\\partial N_1}{\\partial \\eta} = -\\frac{1}{4}(1-\\xi), \\quad \\frac{\\partial N_2}{\\partial \\eta} = -\\frac{1}{4}(1+\\xi), \\quad \\frac{\\partial N_3}{\\partial \\eta} = \\frac{1}{4}(1+\\xi), \\quad \\frac{\\partial N_4}{\\partial \\eta} = \\frac{1}{4}(1-\\xi)\n$$\nUsing the given nodal coordinates in millimeters: $(x_1, y_1) = (0,0)$, $(x_2, y_2) = (40,5)$, $(x_3, y_3) = (45,41)$, and $(x_4, y_4) = (-3,38)$, we compute the components of the Jacobian matrix.\n\n$$\n\\frac{\\partial x}{\\partial \\xi} = \\sum_{i=1}^{4} \\frac{\\partial N_i}{\\partial \\xi} x_i = \\frac{1}{4} [-(1-\\eta)x_1 + (1-\\eta)x_2 + (1+\\eta)x_3 - (1+\\eta)x_4]\n$$\n$$\n\\frac{\\partial x}{\\partial \\xi} = \\frac{1}{4} [-(1-\\eta)(0) + (1-\\eta)(40) + (1+\\eta)(45) - (1+\\eta)(-3)] = \\frac{1}{4} [40(1-\\eta) + 48(1+\\eta)] = \\frac{1}{4}[88 + 8\\eta] = 22 + 2\\eta\n$$\n\n$$\n\\frac{\\partial y}{\\partial \\xi} = \\sum_{i=1}^{4} \\frac{\\partial N_i}{\\partial \\xi} y_i = \\frac{1}{4} [-(1-\\eta)y_1 + (1-\\eta)y_2 + (1+\\eta)y_3 - (1+\\eta)y_4]\n$$\n$$\n\\frac{\\partial y}{\\partial \\xi} = \\frac{1}{4} [-(1-\\eta)(0) + (1-\\eta)(5) + (1+\\eta)(41) - (1+\\eta)(38)] = \\frac{1}{4} [5(1-\\eta) + 3(1+\\eta)] = \\frac{1}{4}[8 - 2\\eta] = 2 - 0.5\\eta\n$$\n\n$$\n\\frac{\\partial x}{\\partial \\eta} = \\sum_{i=1}^{4} \\frac{\\partial N_i}{\\partial \\eta} x_i = \\frac{1}{4} [-(1-\\xi)x_1 - (1+\\xi)x_2 + (1+\\xi)x_3 + (1-\\xi)x_4]\n$$\n$$\n\\frac{\\partial x}{\\partial \\eta} = \\frac{1}{4} [-(1-\\xi)(0) - (1+\\xi)(40) + (1+\\xi)(45) + (1-\\xi)(-3)] = \\frac{1}{4} [5(1+\\xi) - 3(1-\\xi)] = \\frac{1}{4}[2 + 8\\xi] = 0.5 + 2\\xi\n$$\n\n$$\n\\frac{\\partial y}{\\partial \\eta} = \\sum_{i=1}^{4} \\frac{\\partial N_i}{\\partial \\eta} y_i = \\frac{1}{4} [-(1-\\xi)y_1 - (1+\\xi)y_2 + (1+\\xi)y_3 + (1-\\xi)y_4]\n$$\n$$\n\\frac{\\partial y}{\\partial \\eta} = \\frac{1}{4} [-(1-\\xi)(0) - (1+\\xi)(5) + (1+\\xi)(41) + (1-\\xi)(38)] = \\frac{1}{4} [36(1+\\xi) + 38(1-\\xi)] = \\frac{1}{4}[74 - 2\\xi] = 18.5 - 0.5\\xi\n$$\n\nThe Jacobian matrix is therefore:\n$$\nJ(\\xi,\\eta) = \n\\begin{pmatrix}\n22 + 2\\eta & 0.5 + 2\\xi \\\\\n2 - 0.5\\eta & 18.5 - 0.5\\xi\n\\end{pmatrix}\n$$\nNow, we derive the functional form of the Jacobian determinant, $\\det J(\\xi,\\eta)$:\n$$\n\\det J(\\xi,\\eta) = \\left(\\frac{\\partial x}{\\partial \\xi}\\right)\\left(\\frac{\\partial y}{\\partial \\eta}\\right) - \\left(\\frac{\\partial x}{\\partial \\eta}\\right)\\left(\\frac{\\partial y}{\\partial \\xi}\\right)\n$$\n$$\n\\det J(\\xi,\\eta) = (22 + 2\\eta)(18.5 - 0.5\\xi) - (0.5 + 2\\xi)(2 - 0.5\\eta)\n$$\n$$\n\\det J(\\xi,\\eta) = (407 - 11\\xi + 37\\eta - \\xi\\eta) - (1 - 0.25\\eta + 4\\xi - \\xi\\eta)\n$$\n$$\n\\det J(\\xi,\\eta) = 407 - 11\\xi + 37\\eta - \\xi\\eta - 1 + 0.25\\eta - 4\\xi + \\xi\\eta\n$$\n$$\n\\det J(\\xi,\\eta) = 406 - 15\\xi + 37.25\\eta\n$$\nThis is the functional form of the determinant. It is a linear function of $\\xi$ and $\\eta$. The units are $\\text{mm}^2$.\n\nNext, we compute $\\det J$ at the four $2\\times 2$ Gauss integration points, $(\\xi_g, \\eta_g) = (\\pm \\frac{1}{\\sqrt{3}}, \\pm \\frac{1}{\\sqrt{3}})$. Let $a = 1/\\sqrt{3}$.\n$$\n\\det J\\left(\\frac{1}{\\sqrt{3}}, \\frac{1}{\\sqrt{3}}\\right) = 406 - \\frac{15}{\\sqrt{3}} + \\frac{37.25}{\\sqrt{3}} = 406 + \\frac{22.25}{\\sqrt{3}} \\approx 418.8\n$$\n$$\n\\det J\\left(-\\frac{1}{\\sqrt{3}}, \\frac{1}{\\sqrt{3}}\\right) = 406 + \\frac{15}{\\sqrt{3}} + \\frac{37.25}{\\sqrt{3}} = 406 + \\frac{52.25}{\\sqrt{3}} \\approx 436.2\n$$\n$$\n\\det J\\left(-\\frac{1}{\\sqrt{3}}, -\\frac{1}{\\sqrt{3}}\\right) = 406 + \\frac{15}{\\sqrt{3}} - \\frac{37.25}{\\sqrt{3}} = 406 - \\frac{22.25}{\\sqrt{3}} \\approx 393.2\n$$\n$$\n\\det J\\left(\\frac{1}{\\sqrt{3}}, -\\frac{1}{\\sqrt{3}}\\right) = 406 - \\frac{15}{\\sqrt{3}} - \\frac{37.25}{\\sqrt{3}} = 406 - \\frac{52.25}{\\sqrt{3}} \\approx 375.8\n$$\n\nTo determine if the mapping is invertible, we must check if $\\det J(\\xi, \\eta) > 0$ for all $(\\xi, \\eta) \\in [-1,1]^2$. Since $\\det J(\\xi, \\eta) = 406 - 15\\xi + 37.25\\eta$ is a linear function of $\\xi$ and $\\eta$, its graph is a plane. The extrema of such a function over the closed, bounded, convex set $[-1,1]^2$ must occur at the vertices (corners) of the square domain. These corners are $(\\xi,\\eta) \\in \\{(-1,-1), (1,-1), (1,1), (-1,1)\\}$.\n\nWe evaluate $\\det J$ at these four corners:\n$$\n\\det J(-1, -1) = 406 - 15(-1) + 37.25(-1) = 406 + 15 - 37.25 = 383.75\n$$\n$$\n\\det J(1, -1) = 406 - 15(1) + 37.25(-1) = 406 - 15 - 37.25 = 353.75\n$$\n$$\n\\det J(1, 1) = 406 - 15(1) + 37.25(1) = 406 - 15 + 37.25 = 428.25\n$$\n$$\n\\det J(-1, 1) = 406 - 15(-1) + 37.25(1) = 406 + 15 + 37.25 = 458.25\n$$\nThe minimum value among these is $353.75$. Since the minimum value of $\\det J$ on the boundary of the domain $[-1,1]^2$ is positive, and the function is planar, the value of $\\det J(\\xi, \\eta)$ is positive for all interior points as well.\n$$\n\\min_{(\\xi,\\eta) \\in [-1,1]^2} \\det J(\\xi, \\eta) = 353.75 > 0\n$$\nSince $\\det J(\\xi,\\eta) > 0$ throughout the entire element, the mapping from natural to physical coordinates is invertible.\n\nThe final task is to determine the minimum value of $\\det J$ over the domain. As established, this is the minimum of the corner values.\n$$\n\\min \\det J = 353.75 \\, \\text{mm}^2\n$$\nThe problem requires this value to be rounded to four significant figures. The first four significant figures are $3$, $5$, $3$, $7$. The fifth digit is $5$, so we round the fourth digit up.\n$$\n353.75 \\approx 353.8\n$$",
            "answer": "$$\n\\boxed{353.8}\n$$"
        },
        {
            "introduction": "How can we be confident that our chosen finite element formulation will converge to the correct solution? The \"patch test\" is a fundamental and universal benchmark that any valid element must pass. It verifies that an arbitrary patch of elements can exactly reproduce a basic physical state, such as constant strain, which is a necessary condition for convergence. This exercise  walks through the application of the patch test, illustrating a foundational verification principle that underpins the reliability of all finite element simulations.",
            "id": "3445677",
            "problem": "Consider small-strain, plane stress, linear elasticity on a two-dimensional patch. The governing strong form consists of the Cauchy momentum balance and the constitutive relation: the balance of linear momentum without body forces is $\\nabla \\cdot \\boldsymbol{\\sigma} = \\boldsymbol{0}$, and the constitutive relation is $\\boldsymbol{\\sigma} = \\mathbf{D} \\, \\boldsymbol{\\varepsilon}$, where the small-strain tensor is $\\boldsymbol{\\varepsilon} = \\frac{1}{2} \\left( \\nabla \\boldsymbol{u} + \\nabla \\boldsymbol{u}^{\\top} \\right)$ and $\\boldsymbol{u}(x,y)$ is the displacement field. In the absence of body forces, the weak form is: find $\\boldsymbol{u}$ in the appropriate function space satisfying $\\int_{\\Omega} \\boldsymbol{\\varepsilon}(\\boldsymbol{v})^{\\top} \\, \\mathbf{D} \\, \\boldsymbol{\\varepsilon}(\\boldsymbol{u}) \\, \\mathrm{d}\\Omega = \\int_{\\Gamma_t} \\boldsymbol{v}^{\\top} \\boldsymbol{t} \\, \\mathrm{d}\\Gamma$ for all virtual displacements $\\boldsymbol{v}$ vanishing on the Dirichlet boundary, with $\\boldsymbol{t}$ the prescribed traction.\n\nDefine precisely what is meant by the \"patch test\" for linear elasticity in the context of the finite element method: specifically articulate the requirement on the finite element space and the mesh that ensures exact reproduction of linear displacement and constant strain fields when appropriate boundary data or tractions corresponding to such fields are applied.\n\nThen, construct the following star-shaped mesh patch using linear, three-node triangular (T3) elements with isoparametric interpolation over a square of side length $2$:\n- Nodes and coordinates: node $1$ at $(0,0)$, node $2$ at $(2,0)$, node $3$ at $(2,2)$, node $4$ at $(0,2)$, and node $5$ at the center $(1,1)$.\n- Elements: $E_1 = (1,2,5)$, $E_2 = (2,3,5)$, $E_3 = (3,4,5)$, $E_4 = (4,1,5)$.\n- Thickness is $t = 1$. Material is homogeneous, isotropic, linear elastic in plane stress with elasticity matrix $\\mathbf{D}$ defined by Young's modulus $E$ and Poisson's ratio $\\nu$.\n\nLet the exact displacement field be prescribed by\n$$\nu_x(x,y) = 2 + 3 x - 1.5 y, \\qquad u_y(x,y) = -1 + 0.5 x + 4 y.\n$$\nThese correspond to a linear displacement field with a constant small-strain tensor.\n\nImpose essential (Dirichlet) boundary conditions by prescribing the displacement $\\boldsymbol{u}$ equal to the above exact field at the boundary nodes $1$, $2$, $3$, and $4$. Assemble the discrete finite element system using the standard Galerkin method and the above T3 elements, and solve for the unknown displacement at node $5$.\n\nFinally, compute the constant engineering strain vector in each element,\n$$\n\\boldsymbol{\\varepsilon} = \\begin{pmatrix} \\varepsilon_{x} \\\\ \\varepsilon_{y} \\\\ \\gamma_{xy} \\end{pmatrix} = \\begin{pmatrix} \\frac{\\partial u_x}{\\partial x} \\\\ \\frac{\\partial u_y}{\\partial y} \\\\ \\frac{\\partial u_x}{\\partial y} + \\frac{\\partial u_y}{\\partial x} \\end{pmatrix},\n$$\nas produced by the discrete solution, and verify that all elements reproduce the exact constant strain. Report the final reproduced constant strain vector $\\boldsymbol{\\varepsilon}$ as a single row matrix. Express the final answer with no units. No rounding is required.",
            "solution": "The problem statement is evaluated to be valid. It is a well-posed problem in computational solid mechanics, grounded in the established principles of linear elasticity and the finite element method. The problem is objective, self-contained, and all data provided are consistent and sufficient for a unique solution.\n\nThe problem requires a precise definition of the patch test, followed by an application of this test to a specific star-shaped mesh composed of T3 (linear, 3-node triangular) elements. The goal is to verify that these elements can exactly reproduce a constant strain state.\n\nFirst, the definition of the patch test in the context of linear elasticity and the finite element method is as follows:\nThe patch test is a necessary and sufficient condition for the convergence of a conforming finite element formulation. It stipulates that for an arbitrary patch of elements, which may have irregular shapes, the finite element model must exactly reproduce a state of constant strain when subjected to boundary conditions (either essential Dirichlet conditions or natural Neumann conditions) derived from a displacement field that corresponds to that constant strain state. In the case of linear elasticity, a constant strain field $\\boldsymbol{\\varepsilon}$ is generated by a linear displacement field of the form $\\boldsymbol{u}(x,y) = \\boldsymbol{a} + \\mathbf{B} \\begin{pmatrix} x \\\\ y \\end{pmatrix}$, where $\\boldsymbol{a}$ is a constant vector representing rigid body translation and $\\mathbf{B}$ is a constant matrix representing strain and rigid body rotation. For an element formulation to pass the patch test, its shape functions must be able to exactly represent any arbitrary linear polynomial. This property is known as $C^0$ completeness of order $1$.\n\nThe problem provides a linear displacement field:\n$$\nu_x(x,y) = 2 + 3 x - 1.5 y\n$$\n$$\nu_y(x,y) = -1 + 0.5 x + 4 y\n$$\nThe elements used are T$3$ elements, which employ linear shape functions $N_i$ for interpolation of the displacement field within an element, $\\boldsymbol{u}_h(x,y) = \\sum_{i=1}^{3} N_i(x,y) \\boldsymbol{u}_i$. Since the shape functions are linear polynomials, their linear combination can exactly represent any arbitrary linear displacement field. Therefore, the T$3$ element is complete to order $1$ and is guaranteed to pass the patch test.\n\nThe boundary conditions are prescribed at the boundary nodes ($1, 2, 3, 4$) using the values from the exact linear displacement field. Because the T$3$ element formulation passes the patch test, the finite element solution for the displacement field, $\\boldsymbol{u}_h(x,y)$, must be identical to the exact linear field, $\\boldsymbol{u}(x,y)$, everywhere within the patch.\n\nThis allows for the direct calculation of the unknown displacement at the internal node $5$, located at coordinates $(1,1)$, without assembling and solving the global finite element system of equations. We simply evaluate the exact displacement field at this point:\n$$\nu_{x,5} = u_x(1,1) = 2 + 3(1) - 1.5(1) = 2 + 3 - 1.5 = 3.5\n$$\n$$\nu_{y,5} = u_y(1,1) = -1 + 0.5(1) + 4(1) = -1 + 0.5 + 4 = 3.5\n$$\nThe displacement at node $5$ is therefore $(3.5, 3.5)$.\n\nThe next step is to compute the engineering strain vector in each of the four elements. Since the interpolated displacement field $\\boldsymbol{u}_h$ is identical to the exact linear field $\\boldsymbol{u}$, the strain field derived from $\\boldsymbol{u}_h$ must also be identical to the exact strain field. The strain field is constant because it is derived from the first derivatives of a linear displacement field.\nThe components of the engineering strain vector $\\boldsymbol{\\varepsilon} = (\\varepsilon_{x}, \\varepsilon_{y}, \\gamma_{xy})^{\\top}$ are calculated as follows:\n$$\n\\varepsilon_{x} = \\frac{\\partial u_x}{\\partial x} = \\frac{\\partial}{\\partial x} (2 + 3 x - 1.5 y) = 3\n$$\n$$\n\\varepsilon_{y} = \\frac{\\partial u_y}{\\partial y} = \\frac{\\partial}{\\partial y} (-1 + 0.5 x + 4 y) = 4\n$$\n$$\n\\gamma_{xy} = \\frac{\\partial u_x}{\\partial y} + \\frac{\\partial u_y}{\\partial x} = \\frac{\\partial}{\\partial y} (2 + 3 x - 1.5 y) + \\frac{\\partial}{\\partial x} (-1 + 0.5 x + 4 y) = -1.5 + 0.5 = -1\n$$\nThis resulting strain state is constant across the entire patch. For a T$3$ element, the strain is inherently constant within the element. The calculation confirms that the strain computed in any element (e.g., $E_1, E_2, E_3, E_4$) will be this exact, constant value. This verifies that the finite element formulation on this patch reproduces the exact constant strain, thereby passing the patch test.\n\nThe reproduced constant engineering strain vector is:\n$$\n\\boldsymbol{\\varepsilon} = \\begin{pmatrix} 3 \\\\ 4 \\\\ -1 \\end{pmatrix}\n$$\nThe problem requests this result as a single row matrix.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n3 & 4 & -1\n\\end{pmatrix}\n}\n$$"
        }
    ]
}