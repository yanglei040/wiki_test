{
    "hands_on_practices": [
        {
            "introduction": "理论学习需要通过实践来巩固。本节的第一个练习将混合自由能理论应用于一个具体且重要的物理系统：高分子共混物。通过分析 Flory-Huggins 混合吉布斯自由能模型，我们将学习如何从自由能曲线的曲率推导出相稳定性的判据，并计算决定相分离行为的关键物理量——上临界共溶温度（UCST）。这项实践将帮助你深刻理解混合吉布斯自由能 $G_{\\text{mix}}$ 的数学形式与材料宏观相行为之间的直接联系 。",
            "id": "3454941",
            "problem": "一个二元聚合物共混物在晶格上进行建模，使用每个晶格位置的 Flory–Huggins 混合 Gibbs 自由能，\n$$\n\\frac{\\Delta G_{\\mathrm{mix}}}{k_{B} T} = \\frac{\\phi}{N_{1}} \\ln \\phi + \\frac{1 - \\phi}{N_{2}} \\ln(1 - \\phi) + \\chi(T)\\,\\phi(1 - \\phi),\n$$\n其中 $k_{B}$ 是 Boltzmann 常数，$T$ 是绝对温度，$\\phi$ 是组分 1 的体积分数，$N_{1}$ 和 $N_{2}$ 分别是组分 1 和 2 的聚合度，$\\chi(T)$ 是 Flory–Huggins 相互作用参数。该相互作用参数的温度依赖关系由下式给出：\n$$\n\\chi(T) = \\frac{A}{T} + B,\n$$\n其中 $A$ 和 $B$ 是与温度无关的常数。考虑一个共混物，其参数为 $N_{1} = 20$，$N_{2} = 5$，$A = 59.4\\,\\mathrm{K}$，$B = 0.06$。\n\n从上述混合 Gibbs 自由能和均相的基本稳定性判据（即 $\\Delta G_{\\mathrm{mix}}$ 相对于组分的曲率符号）出发，确定上临界溶解温度 (UCST)，其定义为系统表现出相分离临界点的最高温度。然后，在“由于熵相互作用的贡献，$\\chi(T)$ 随 $T$ 升高而减小”这一给定假设下，评估是否存在下临界溶解温度 (LCST)。\n\n以开尔文表示 UCST。将最终温度四舍五入到四位有效数字。对于 LCST 的评估，在您的计算过程中提供简要论证，但不要将其包含在最终数值答案中。",
            "solution": "首先将通过提取给定条件并评估其科学和形式上的完整性来验证该问题。\n\n### 步骤 1：提取给定条件\n- 每个晶格位置的混合 Gibbs 自由能由下式给出：\n$$\n\\frac{\\Delta G_{\\mathrm{mix}}}{k_{B} T} = \\frac{\\phi}{N_{1}} \\ln \\phi + \\frac{1 - \\phi}{N_{2}} \\ln(1 - \\phi) + \\chi(T)\\,\\phi(1 - \\phi)\n$$\n- Flory–Huggins 相互作用参数的温度依赖关系为：\n$$\n\\chi(T) = \\frac{A}{T} + B\n$$\n- 问题提供了以下常数：\n  - 组分 1 的聚合度：$N_{1} = 20$\n  - 组分 2 的聚合度：$N_{2} = 5$\n  - 对 $\\chi$ 的焓贡献常数：$A = 59.4\\,\\mathrm{K}$\n  - 对 $\\chi$ 的熵贡献常数：$B = 0.06$\n- 目标是确定上临界溶解温度 (UCST) 并评估存在下临界溶解温度 (LCST) 的可能性。\n\n### 步骤 2：使用提取的给定条件进行验证\n- **科学依据：** 该问题基于 Flory–Huggins 理论，这是高分子物理学中描述聚合物溶液和共混物热力学的基石模型。混合 Gibbs 自由能的表达式和相互作用参数 $\\chi(T)$ 的形式在该领域是标准的。从稳定性判据（Gibbs 自由能的二阶和三阶导数）确定临界点的方法是化学热力学的基本原理。该问题在科学上是合理的。\n- **定义明确：** 该问题提供了唯一确定临界点所需的所有方程和常数值。任务定义清晰。\n- **客观性：** 该问题以精确、客观的语言陈述，没有任何主观或基于观点的主张。\n\n### 步骤 3：结论与行动\n该问题有效。将提供完整的解答。\n\n### 解答\n均相混合物的稳定性由混合 Gibbs 自由能 $\\Delta G_{\\mathrm{mix}}$ 相对于组分 $\\phi$ 的二阶导数的符号决定。如果自由能曲线是凸的，即 $\\frac{\\partial^2 \\Delta G_{\\mathrm{mix}}}{\\partial \\phi^2}  0$，则该混合物对无穷小的组分涨落是稳定的。这种稳定性的极限，称为旋节线曲线，由以下条件定义：\n$$\n\\frac{\\partial^2 \\Delta G_{\\mathrm{mix}}}{\\partial \\phi^2} = 0\n$$\n为简化符号，令 $g(\\phi) = \\frac{\\Delta G_{\\mathrm{mix}}}{k_{B} T}$。则旋节线条件等价于 $\\frac{\\partial^2 g}{\\partial \\phi^2} = 0$。\n\n首先，我们计算 $g(\\phi)$ 相对于 $\\phi$ 的一阶导数：\n$$\n\\frac{\\partial g}{\\partial \\phi} = \\frac{\\partial}{\\partial \\phi} \\left( \\frac{\\phi}{N_{1}} \\ln \\phi + \\frac{1 - \\phi}{N_{2}} \\ln(1 - \\phi) + \\chi(T)\\,\\phi(1 - \\phi) \\right)\n$$\n$$\n\\frac{\\partial g}{\\partial \\phi} = \\left( \\frac{1}{N_{1}}\\ln\\phi + \\frac{\\phi}{N_{1}\\phi} \\right) + \\left( \\frac{-1}{N_{2}}\\ln(1-\\phi) + \\frac{1-\\phi}{N_{2}}\\frac{-1}{1-\\phi} \\right) + \\chi(T)(1 - 2\\phi)\n$$\n$$\n\\frac{\\partial g}{\\partial \\phi} = \\frac{1}{N_{1}}(\\ln\\phi + 1) - \\frac{1}{N_{2}}(\\ln(1-\\phi) + 1) + \\chi(T)(1 - 2\\phi)\n$$\n接下来，我们计算二阶导数：\n$$\n\\frac{\\partial^2 g}{\\partial \\phi^2} = \\frac{\\partial}{\\partial \\phi} \\left( \\frac{\\partial g}{\\partial \\phi} \\right) = \\frac{1}{N_{1}\\phi} - \\frac{1}{N_{2}}\\frac{-1}{1-\\phi} - 2\\chi(T)\n$$\n$$\n\\frac{\\partial^2 g}{\\partial \\phi^2} = \\frac{1}{N_{1}\\phi} + \\frac{1}{N_{2}(1-\\phi)} - 2\\chi(T)\n$$\n将二阶导数设为零，得到旋节线条件，该条件将相互作用参数 $\\chi$ 与旋节线曲线上组分 $\\phi$ 联系起来：\n$$\n2\\chi_s(\\phi) = \\frac{1}{N_{1}\\phi} + \\frac{1}{N_{2}(1-\\phi)}\n$$\n临界点是旋节线曲线 $(\\phi, T)$ 的一个极值点。在数学上，它是旋节线和双节线曲线相切的点，通过将 $\\Delta G_{\\mathrm{mix}}$ 的三阶导数设为零来找到，这等价于找到 $\\chi_s(\\phi)$ 的极值：\n$$\n\\frac{\\partial}{\\partial \\phi} \\left( \\frac{\\partial^2 g}{\\partial \\phi^2} \\right) = 0 \\implies \\frac{d\\chi_s}{d\\phi} = 0\n$$\n$$\n\\frac{d(2\\chi_s)}{d\\phi} = \\frac{-1}{N_{1}\\phi^2} + \\frac{1}{N_{2}(1-\\phi)^2} = 0\n$$\n求解临界组分 $\\phi_c$：\n$$\n\\frac{1}{N_{1}\\phi_c^2} = \\frac{1}{N_{2}(1-\\phi_c)^2} \\implies N_{2}(1-\\phi_c)^2 = N_{1}\\phi_c^2\n$$\n对两边取平方根（因为 $\\phi_c \\in (0,1)$）：\n$$\n\\sqrt{N_{2}}(1-\\phi_c) = \\sqrt{N_{1}}\\phi_c\n$$\n$$\n\\sqrt{N_{2}} = (\\sqrt{N_{1}} + \\sqrt{N_{2}})\\phi_c \\implies \\phi_c = \\frac{\\sqrt{N_{2}}}{\\sqrt{N_{1}} + \\sqrt{N_{2}}}\n$$\n使用给定值 $N_{1} = 20$ 和 $N_{2} = 5$：\n$$\n\\phi_c = \\frac{\\sqrt{5}}{\\sqrt{20} + \\sqrt{5}} = \\frac{\\sqrt{5}}{2\\sqrt{5} + \\sqrt{5}} = \\frac{\\sqrt{5}}{3\\sqrt{5}} = \\frac{1}{3}\n$$\n现在我们将 $\\phi_c = 1/3$ 代入旋节线方程，求出临界相互作用参数 $\\chi_c$：\n$$\n2\\chi_c = \\frac{1}{N_{1}\\phi_c} + \\frac{1}{N_{2}(1-\\phi_c)} = \\frac{1}{20(1/3)} + \\frac{1}{5(1 - 1/3)}\n$$\n$$\n2\\chi_c = \\frac{3}{20} + \\frac{1}{5(2/3)} = \\frac{3}{20} + \\frac{3}{10} = \\frac{3}{20} + \\frac{6}{20} = \\frac{9}{20}\n$$\n$$\n\\chi_c = \\frac{9}{40} = 0.225\n$$\n临界温度 $T_c$ 是相互作用参数等于此临界值时的温度，即 $\\chi(T_c) = \\chi_c$。使用给定的温度依赖关系 $\\chi(T) = A/T + B$：\n$$\n\\frac{A}{T_c} + B = \\chi_c \\implies T_c = \\frac{A}{\\chi_c - B}\n$$\n代入给定值 $A = 59.4\\,\\mathrm{K}$，$B = 0.06$，以及我们计算出的 $\\chi_c = 0.225$：\n$$\nT_c = \\frac{59.4}{0.225 - 0.06} = \\frac{59.4}{0.165} = 360\\,\\mathrm{K}\n$$\n为了确定这是 UCST 还是 LCST，我们考察 $\\chi(T)$ 的行为。当 $\\chi(T)$ 足够大以满足不稳定条件 $2\\chi(T)  \\frac{1}{N_{1}\\phi} + \\frac{1}{N_{2}(1-\\phi)}$ 时，会发生相分离。对于给定的形式 $\\chi(T) = A/T + B$ 且 $A = 59.4\\,\\mathrm{K}  0$，其导数为 $\\frac{d\\chi}{dT} = -A/T^2  0$。这意味着 $\\chi(T)$ 随温度降低而增大。因此，相分离在降温时发生，临界温度 $T_c = 360\\,\\mathrm{K}$ 是混合物能够发生相分离的最高温度。这定义了一个上临界溶解温度 (UCST)。\n\n关于 LCST 的评估：下临界溶解温度 (LCST) 对应于加热时发生相分离。这种现象要求分相的驱动力 $\\chi$ 随温度升高而增大，即 $\\frac{d\\chi}{dT}  0$。问题中指定了 $\\chi(T)$ 的形式，并明确假设“$\\chi(T)$ 随 $T$ 升高而减小”。这个条件 $\\frac{d\\chi}{dT}  0$ 与 LCST 的存在从根本上是不相容的。因此，对于给定的模型和参数，LCST 是不可能存在的。\n\nUCST 是 $360\\,\\mathrm{K}$。问题要求四舍五入到四位有效数字，所以答案是 $360.0\\,\\mathrm{K}$。",
            "answer": "$$\\boxed{360.0}$$"
        },
        {
            "introduction": "在上一个练习的基础上，我们将从一个特定的解析模型推广到一个更通用、更强大的数值方法。本练习将指导你亲手实现计算热力学中的核心算法——切平面法（tangent plane criterion），用以判断任意给定的二元混合物处于稳定、亚稳还是非稳态。这项编码实践对于开发能够从任意吉布斯自由能模型预测相图的计算工具至关重要，是计算材料科学家的一项基本技能 。",
            "id": "3454937",
            "problem": "在恒定温度下，由组分 $1$ 和 $2$ 组成的二元溶液通过混合吉布斯自由能进行建模。对于组成为 $x \\equiv x_1 \\in (0,1)$ 且 $x_2 = 1 - x$ 的情况，将总摩尔混合吉布斯自由能 $G^{\\text{mix}}(x)$ 定义为理想混合贡献与指定的超额吉布斯自由能模型之和。理想混合贡献由经过充分验证的公式 $G^{\\text{id}}(x) = R T \\left[ x \\ln x + (1 - x) \\ln(1 - x) \\right]$ 给出，其中 $R$ 是普适气体常数，$T$ 是绝对温度。超额吉布斯自由能由 Redlich–Kister 型多项式 $G^{E}(x) = x(1-x)\\left[A_0 + A_1(2x - 1) + A_2(2x - 1)^2\\right]$ 指定，其中 $A_0$、$A_1$ 和 $A_2$ 是相互作用参数，其单位与焦耳/摩尔一致。\n\n切平面（在此二元情况下为切线）稳定性检验使用切平面距离函数来评估均相混合物在参考组成 $x_0$ 处的局部和全局稳定性。对于一个通用的多组分系统，切平面距离函数定义为 $T(\\boldsymbol{x}) = G(\\boldsymbol{x}) - G(\\boldsymbol{x^0}) - \\sum_i \\mu_i(\\boldsymbol{x^0})(x_i - x_i^0)$，其中 $\\mu_i$ 是化学势，$\\boldsymbol{x}$ 是组成向量。在满足约束条件 $x_2 = 1 - x_1$ 的二元系统中，引入标量组成变量 $x \\equiv x_1$ 和单变量表示 $G(x) \\equiv G^{\\text{mix}}(x)$。切平面距离函数简化为 $T(x) = G(x) - G(x_0) - \\left.\\dfrac{dG}{dx}\\right|_{x_0}(x - x_0)$，其中 $\\dfrac{dG}{dx}$ 是 $G$ 沿着组成约束对 $x$ 的导数。\n\n从上述基本定义出发，从第一性原理实现以下用于混合物在 $x_0$ 处分类的算法：\n- 计算二阶导数 $\\left.\\dfrac{d^2 G}{dx^2}\\right|_{x_0}$。如果 $\\left.\\dfrac{d^2 G}{dx^2}\\right|_{x_0}  0$ （在指定的数值容差内），则将混合物分类为不稳定（旋节线）。\n- 否则，在 $x \\in (0,1)$ 上对 $T(x)$ 进行数值最小化，排除 $x_0$ 的一个无穷小邻域以避免在 $x_0$ 处的平凡最小值。如果最小值 $\\min_{x \\in (0,1),\\, x \\neq x_0} T(x)  0$ （在容差内），则将混合物分类为亚稳（局部稳定但全局不稳定）。如果最小值为非负，则将混合物分类为稳定（局部和全局稳定）。\n\n所有能量必须以焦耳/摩尔计算，$R$ 的单位为焦耳/摩尔/开尔文，$T$ 的单位为开尔文。角度单位不适用。使用以下常数和参数：\n- 普适气体常数 $R = 8.31446261815324\\,\\text{J}\\,\\text{mol}^{-1}\\,\\text{K}^{-1}$。\n- 所有情况下的温度 $T = 298\\,\\text{K}$。\n- Redlich–Kister 参数 $(A_0, A_1, A_2)$ 和参考组成 $x_0$ 按每个测试用例提供。\n\n在 $x \\in [\\varepsilon, 1 - \\varepsilon]$ 上实现 $T(x)$ 的数值最小化，其中 $\\varepsilon$ 是一个很小的数，以避免 $\\ln x$ 和 $\\ln(1 - x)$ 在端点处发散。从搜索域中排除一个围绕 $x_0$ 宽度为 $\\delta$ 的小区间，以避免平凡最小值 $T(x_0) = 0$。分别对曲率和切平面决策使用容差 $\\tau_{\\text{curv}}$ 和 $\\tau_{\\text{tpdf}}$。\n\n测试套件：\n- 情况 $1$（预期为稳定）：$(A_0, A_1, A_2) = (2000, 0, 0)$，$x_0 = 0.3$，$T = 298$。\n- 情况 $2$（预期为亚稳）：$(A_0, A_1, A_2) = (8000, 0, 0)$，$x_0 = 0.1$，$T = 298$。\n- 情况 $3$（预期为不稳定/旋节线）：$(A_0, A_1, A_2) = (8000, 0, 0)$，$x_0 = 0.5$，$T = 298$。\n\n您的程序必须：\n- 根据给定的 $G^{\\text{id}}(x)$ 和 $G^{E}(x)$ 定义，推导 $\\dfrac{dG}{dx}$ 和 $\\dfrac{d^2 G}{dx^2}$，实现 $T(x)$，对每种情况执行上述分类，并汇总结果。\n\n数值参数选择：\n- 使用 $\\varepsilon = 10^{-9}$ 和 $\\delta = 10^{-6}$。\n- 使用容差 $\\tau_{\\text{curv}} = 10^{-6}\\,\\text{J}\\,\\text{mol}^{-1}$ 和 $\\tau_{\\text{tpdf}} = 10^{-6}\\,\\text{J}\\,\\text{mol}^{-1}$。\n\n最终输出格式：\n- 将分类映射为整数：稳定 $\\rightarrow 1$，亚稳 $\\rightarrow 0$，不稳定 $\\rightarrow -1$。\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表的结果（例如，$\\left[\\text{result}_1,\\text{result}_2,\\text{result}_3\\right]$），其中每个条目是与上述定义的分类映射相对应的整数。",
            "solution": "该问题要求基于二元混合物的混合吉布斯自由能 $G^{\\text{mix}}(x)$ 实现其稳定性分析。均相混合物在参考组成 $x_0$ 处的稳定性被分为稳定、亚稳或不稳定。此分类通过一个两步算法执行，该算法涉及吉布斯自由能曲线的曲率（二阶导数）和切平面距离函数。\n\n首先，我们建立总摩尔混合吉布斯自由能 $G(x)$ 及其关于组成 $x \\equiv x_1$ 的一阶和二阶导数的解析表达式。\n\n总混合吉布斯自由能由理想项和超额项之和给出：\n$$G(x) = G^{\\text{id}}(x) + G^{E}(x)$$\n理想混合项为：\n$$G^{\\text{id}}(x) = RT \\left[ x \\ln x + (1 - x) \\ln(1 - x) \\right]$$\n超额项由 Redlich-Kister 多项式给出：\n$$G^{E}(x) = x(1-x)\\left[A_0 + A_1(2x - 1) + A_2(2x - 1)^2\\right]$$\n其中 $R$ 是普适气体常数，$T$ 是绝对温度，$A_0, A_1, A_2$ 是相互作用参数。\n\n为了应用稳定性判据，我们必须推导 $G(x)$ 关于 $x$ 的一阶和二阶导数。\n\n**步骤 1：一阶导数, $\\dfrac{dG}{dx}$**\n\n理想项的导数为：\n$$\\dfrac{dG^{\\text{id}}}{dx} = RT \\left( \\dfrac{d}{dx}(x \\ln x) + \\dfrac{d}{dx}((1-x)\\ln(1-x)) \\right)$$\n$$\\dfrac{dG^{\\text{id}}}{dx} = RT \\left( (\\ln x + 1) + (-1 \\cdot \\ln(1-x) + (1-x) \\cdot \\frac{-1}{1-x}) \\right)$$\n$$\\dfrac{dG^{\\text{id}}}{dx} = RT (\\ln x + 1 - \\ln(1-x) - 1) = RT \\ln\\left(\\frac{x}{1-x}\\right)$$\n\n超额项的导数，使用乘法法则，为：\n$$\\dfrac{dG^{E}}{dx} = \\dfrac{d}{dx}\\left(x(1-x)\\right) \\cdot \\left[A_0 + A_1(2x - 1) + A_2(2x - 1)^2\\right] + x(1-x) \\cdot \\dfrac{d}{dx}\\left[A_0 + A_1(2x - 1) + A_2(2x - 1)^2\\right]$$\n$$\\dfrac{dG^{E}}{dx} = (1-2x)\\left[A_0 + A_1(2x - 1) + A_2(2x - 1)^2\\right] + x(1-x)\\left[2A_1 + 4A_2(2x-1)\\right]$$\n\n将这些组合起来，总的一阶导数为：\n$$\\dfrac{dG}{dx} = RT \\ln\\left(\\frac{x}{1-x}\\right) + (1-2x)\\left[A_0 + A_1(2x - 1) + A_2(2x - 1)^2\\right] + x(1-x)\\left[2A_1 + 4A_2(2x-1)\\right]$$\n该表达式代表化学势之差 $\\mu_1 - \\mu_2$。\n\n**步骤 2：二阶导数, $\\dfrac{d^2G}{dx^2}$**\n\n理想项的二阶导数为：\n$$\\dfrac{d^2G^{\\text{id}}}{dx^2} = RT \\left( \\frac{1}{x} - \\frac{-1}{1-x} \\right) = RT \\left( \\frac{1}{x} + \\frac{1}{1-x} \\right) = \\frac{RT}{x(1-x)}$$\n\n通过对 $\\dfrac{dG^{E}}{dx}$ 求导来找到超额项的二阶导数。尽管代数计算量很大，但可以通过将 $G^E(x)$ 展开为 $x$ 的幂并对每个参数 $A_i$ 逐项求导来简化计算。\n对于 $A_0$ 项：$\\dfrac{d^2}{dx^2} [A_0 x(1-x)] = \\dfrac{d^2}{dx^2} [A_0(x-x^2)] = -2A_0$。\n对于 $A_1$ 项：$\\dfrac{d^2}{dx^2} [A_1 x(1-x)(2x-1)] = \\dfrac{d^2}{dx^2} [A_1(-2x^3+3x^2-x)] = A_1(-12x+6) = 6A_1(1-2x)$。\n对于 $A_2$ 项：$\\dfrac{d^2}{dx^2} [A_2 x(1-x)(2x-1)^2] = \\dfrac{d^2}{dx^2} [A_2(-4x^4+8x^3-5x^2+x)] = A_2(-48x^2+48x-10)$。\n\n将这些贡献相加，我们得到超额项的二阶导数：\n$$\\dfrac{d^2G^{E}}{dx^2} = -2A_0 + 6A_1(1-2x) + A_2(-48x^2+48x-10)$$\n\n总的二阶导数为：\n$$\\dfrac{d^2G}{dx^2} = \\frac{RT}{x(1-x)} - 2A_0 + 6A_1(1-2x) + A_2(-48x^2+48x-10)$$\n\n**步骤 3：稳定性分类算法**\n\n对于参考组成 $x_0$，稳定性分类按以下步骤进行：\n\n1.  **局部稳定性（旋节线分析）：** 二阶导数的符号 $\\left.\\dfrac{d^2G}{dx^2}\\right|_{x_0}$ 决定了局部稳定性。如果 $\\left.\\dfrac{d^2G}{dx^2}\\right|_{x_0}  0$，吉布斯自由能曲线是局部凹的，这意味着均相相对于无穷小的组分涨落是不稳定的。此条件定义了旋节线区域。混合物被分类为**不稳定**。数值检验为 $\\left.\\dfrac{d^2G}{dx^2}\\right|_{x_0}  -\\tau_{\\text{curv}}$。\n\n2.  **全局稳定性（切平面判据）：** 如果 $\\left.\\dfrac{d^2G}{dx^2}\\right|_{x_0} \\ge 0$，则混合物是局部稳定或临界稳定的。我们接着必须评估其抵抗相分离成两个不同相的全局稳定性。这是通过使用切平面距离函数 $T(x)$ 来完成的，该函数测量吉布斯能量曲线 $G(x)$ 与曲线在 $x_0$ 处的切线之间的垂直距离。\n    $$T(x) = G(x) - \\left( G(x_0) + \\left.\\dfrac{dG}{dx}\\right|_{x_0}(x - x_0) \\right)$$\n    根据定义，$T(x_0)=0$。如果对于所有其他组成 $x \\in (0,1)$ 都有 $T(x) \\ge 0$，这意味着没有其他相或相的组合比在 $x_0$ 处的均相具有更低的吉布斯能量。该混合物是全局**稳定**的。\n    然而，如果存在某个组成 $x$ 使得 $T(x)  0$，则意味着存在一个具有更低吉布斯能量的状态（例如，两相混合物）。因此，在 $x_0$ 处的均相是**亚稳**的：对小涨落稳定，但对可能形成更稳定相的大涨落不稳定。\n\n    为了检验这一点，我们在定义域 $x \\in (0,1)$ 上数值求解 $T(x)$ 的最小值，并排除 $x_0$ 的一个无穷小邻域以避免平凡的最小值。\n    $$T_{\\text{min}} = \\min_{x \\in (0,1),\\, x \\neq x_0} T(x)$$\n    如果 $T_{\\text{min}}  -\\tau_{\\text{tpdf}}$，混合物被分类为**亚稳**。否则，它被分类为**稳定**。\n\n**步骤 4：数值实现**\n\n该算法在 Python 中实现。函数 $G(x)$, $\\dfrac{dG}{dx}$, 和 $\\dfrac{d^2G}{dx^2}$ 是根据推导出的解析表达式定义的。对于 $T(x)$ 的最小化，我们使用 `scipy.optimize.minimize_scalar`。搜索域 $x \\in (0,1)$ 在实践中作为 $x \\in [\\varepsilon, 1-\\varepsilon]$ 处理，以避免边界处的对数数值问题。围绕 $x_0$ 的排除区间被指定为宽度为 $\\delta$，我们将其解释为 $[x_0-\\delta/2, x_0+\\delta/2]$。最小化在两个不相交的区间 $[\\varepsilon, x_0-\\delta/2]$ 和 $[x_0+\\delta/2, 1-\\varepsilon]$ 上执行，两个结果中的较小者作为 $T_{\\text{min}}$。最终的分类按要求映射为整数（稳定为 $1$，亚稳为 $0$，不稳定为 $-1$）。",
            "answer": "```python\nimport numpy as np\nfrom scipy.optimize import minimize_scalar\n\ndef solve():\n    \"\"\"\n    Performs stability analysis for a binary mixture based on its Gibbs free energy of mixing.\n    \"\"\"\n\n    # Define constants and numerical parameters\n    R = 8.31446261815324  # J mol^-1 K^-1\n    T = 298.0  # K\n    epsilon = 1e-9\n    delta = 1e-6\n    tau_curv = 1e-6  # J mol^-1\n    tau_tpdf = 1e-6  # J mol^-1\n\n    def g_mix(x, A0, A1, A2):\n        \"\"\"Computes the total molar Gibbs free energy of mixing G(x).\"\"\"\n        # Handle boundary cases for logarithm\n        if np.any(x == 0) or np.any(x >= 1):\n             # For evaluation within bounds [epsilon, 1-epsilon], this should not be reached often\n             # But as a safeguard for edge cases of optimizer\n             x_safe = np.clip(x, epsilon, 1 - epsilon)\n        else:\n             x_safe = x\n\n        g_ideal = R * T * (x_safe * np.log(x_safe) + (1 - x_safe) * np.log(1 - x_safe))\n        \n        y = 2 * x - 1\n        g_excess = x * (1 - x) * (A0 + A1 * y + A2 * y**2)\n        \n        return g_ideal + g_excess\n\n    def dg_dx(x, A0, A1, A2):\n        \"\"\"Computes the first derivative of G(x) with respect to x.\"\"\"\n        x_safe = np.clip(x, epsilon, 1 - epsilon)\n        dg_ideal_dx = R * T * np.log(x_safe / (1 - x_safe))\n        \n        y = 2 * x - 1\n        term1 = (1 - 2 * x) * (A0 + A1 * y + A2 * y**2)\n        term2 = x * (1 - x) * (2 * A1 + 4 * A2 * y)\n        dg_excess_dx = term1 + term2\n        \n        return dg_ideal_dx + dg_excess_dx\n\n    def d2g_dx2(x, A0, A1, A2):\n        \"\"\"Computes the second derivative of G(x) with respect to x.\"\"\"\n        x_safe = np.clip(x, epsilon, 1 - epsilon)\n        d2g_ideal_dx2 = R * T / (x_safe * (1 - x_safe))\n        \n        # Pre-calculated coefficients from analytical derivation\n        d2g_excess_dx2 = -2*A0 + 6*A1*(1-2*x) + A2*(-48*x**2 + 48*x - 10)\n        \n        return d2g_ideal_dx2 + d2g_excess_dx2\n\n    def tpdf(x, x0, A0, A1, A2, g_x0, dg_dx_x0):\n        \"\"\"Computes the tangent plane distance function T(x).\"\"\"\n        return g_mix(x, A0, A1, A2) - g_x0 - dg_dx_x0 * (x - x0)\n\n    # Test cases from the problem statement\n    test_cases = [\n        # (A0, A1, A2, x0)\n        (2000.0, 0.0, 0.0, 0.3),  # Expected: stable -> 1\n        (8000.0, 0.0, 0.0, 0.1),  # Expected: metastable -> 0\n        (8000.0, 0.0, 0.0, 0.5),  # Expected: unstable -> -1\n    ]\n\n    results = []\n    for case in test_cases:\n        A0, A1, A2, x0 = case\n        \n        # 1. Unstable (spinodal) check\n        curvature = d2g_dx2(x0, A0, A1, A2)\n        if curvature  -tau_curv:\n            results.append(-1)\n            continue\n            \n        # 2. Metastable vs. Stable check\n        g_at_x0 = g_mix(x0, A0, A1, A2)\n        dg_dx_at_x0 = dg_dx(x0, A0, A1, A2)\n        \n        # Minimize T(x) over two intervals to exclude x0\n        interval1 = (epsilon, x0 - delta / 2.0)\n        interval2 = (x0 + delta / 2.0, 1.0 - epsilon)\n        \n        args_tpdf = (x0, A0, A1, A2, g_at_x0, dg_dx_at_x0)\n        \n        # Check if intervals are valid before optimization\n        min_tpdf_val = float('inf')\n\n        if interval1[0]  interval1[1]:\n            res1 = minimize_scalar(tpdf, bounds=interval1, args=args_tpdf, method='bounded')\n            min_tpdf_val = min(min_tpdf_val, res1.fun)\n\n        if interval2[0]  interval2[1]:\n            res2 = minimize_scalar(tpdf, bounds=interval2, args=args_tpdf, method='bounded')\n            min_tpdf_val = min(min_tpdf_val, res2.fun)\n\n        if min_tpdf_val  -tau_tpdf:\n            results.append(0)  # Metastable\n        else:\n            results.append(1)  # Stable\n\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "最后一个实践练习旨在连接唯象的热力学模型与前沿的第一性原理计算。由于第一性原理计算通常在有限尺寸的超胞中进行，其结果会不可避免地受到尺寸效应的影响，这与热力学极限下的理论模型存在偏差。本练习将引导你分析并修正这种有限尺寸效应，通过对一个与稳定性密切相关的关键物理量——吉布斯自由能曲率——进行数据外推，从而获得其在热力学极限下的精确值 。",
            "id": "3454924",
            "problem": "考虑一种 A-B 二元合金，其 B 组分的成分为 $x \\in (0,1)$。每个原子的吉布斯混合自由能 $G_{\\mathrm{mix}}(x;N,T)$ 由基本关系式 $G_{\\mathrm{mix}} = H_{\\mathrm{mix}} - T S_{\\mathrm{conf}}$ 定义，其中 $H_{\\mathrm{mix}}$ 是每个原子的混合焓，$S_{\\mathrm{conf}}$ 是每个原子的构型熵。对于一个通过特殊准随机结构（SQS）近似的无序合金，有限尺寸效应会产生随超胞尺寸 $N$ 增大而衰减的修正。在本问题中，您将分析有限尺寸效应对 $G_{\\mathrm{mix}}$ 相对于 $x$ 的曲率的影响，并通过有限尺寸标度将曲率 $f''(x) \\equiv \\frac{d^2 G_{\\mathrm{mix}}}{dx^2}$ 外推至热力学极限 $N \\to \\infty$。\n\n使用以下具有物理基础且计算上易于处理的模型：\n- 无限尺寸下每个原子的混合焓由正则溶液模型给出：$H_{\\mathrm{mix}}^{\\infty}(x) = \\Omega\\, x(1-x)$，其中 $\\Omega$ 是一个以电子伏特（eV）为单位的常数。\n- 每个原子的理想构型熵为 $S_{\\mathrm{conf}}(x) = -k_{\\mathrm{B}}\\left[x \\ln x + (1-x)\\ln(1-x)\\right]$，其中 $k_{\\mathrm{B}}$ 是以电子伏特每开尔文（eV/K）表示的玻尔兹曼常数。\n- 对焓的有限尺寸 SQS 修正模型为 $\\Delta H_{\\mathrm{FS}}(x;N) = \\alpha\\,(1-2x)^2/N$，其中 $\\alpha$ 是一个以 eV 为单位的常数，$N$ 是 SQS 超胞中的原子数。\n\n因此，每个原子的吉布斯混合自由能为\n$$\nG_{\\mathrm{mix}}(x;N,T) = \\Omega\\,x(1-x) + \\frac{\\alpha}{N}(1-2x)^2 - T\\,\\left[-k_{\\mathrm{B}}\\left(x\\ln x + (1-x)\\ln(1-x)\\right)\\right].\n$$\n\n您的任务是，对于几个 SQS 超胞尺寸 $N$，在选定的成分 $x$ 处，计算 $G_{\\mathrm{mix}}(x;N,T)$ 的数值曲率 $f''(x;N)$，然后进行有限尺寸标度分析，以估计热力学极限下的曲率 $f''_{\\infty}(x) \\equiv \\lim_{N\\to\\infty} f''(x;N)$。\n\n实现以下算法步骤：\n1. 对于每个选定的成分 $x$ 和每个超胞尺寸 $N$，在步长为 $h$ 的局部三点模板 $\\{x-h,x,x+h\\}$ 上计算 $G_{\\mathrm{mix}}(x;N,T)$。使用这些值通过中心有限差分公式估计关于 $x$ 的二阶导数：\n$$\nf''(x;N) \\approx \\frac{G_{\\mathrm{mix}}(x+h;N,T) - 2\\,G_{\\mathrm{mix}}(x;N,T) + G_{\\mathrm{mix}}(x-h;N,T)}{h^2}.\n$$\n确保模板点保持在开区间 $(0,1)$ 内。\n2. 对于每个成分 $x$，对 $f''(x;N)$ 与 $1/N$ 进行线性回归，\n$$\nf''(x;N) \\approx A(x) + \\frac{B(x)}{N},\n$$\n并提取截距 $A(x)$ 作为热力学极限曲率 $f''_{\\infty}(x)$ 的估计值。\n3. 将所有测试用例成分的外推曲率 $f''_{\\infty}(x)$ 汇总到一个以“每个原子的电子伏特”为单位的浮点数列表中。\n\n使用以下参数值（所有数值必须以指定单位进行解释）：\n- 玻尔兹曼常数 $k_{\\mathrm{B}} = 8.617333262145\\times 10^{-5}\\ \\mathrm{eV/K}$，\n- 温度 $T = 1000\\ \\mathrm{K}$，\n- 正则溶液参数 $\\Omega = 0.02\\ \\mathrm{eV}$，\n- 有限尺寸修正振幅 $\\alpha = 0.1\\ \\mathrm{eV}$，\n- 有限差分步长 $h = 0.05$（无量纲，因为 $x$ 是无量纲的）。\n\n测试套件：\n- SQS 超胞尺寸 $N \\in \\{16, 32, 64, 128\\}$，\n- 待分析的成分 $x \\in \\{0.25, 0.50, 0.75\\}$。\n\n数值与输出要求：\n- 将曲率 $f''(x;N)$ 和外推曲率 $f''_{\\infty}(x)$ 计算为以每个原子的电子伏特为单位的浮点数。\n- 您的程序必须生成单行输出，其中包含 $x = 0.25$，$x = 0.50$ 和 $x = 0.75$ 的外推曲率（按此顺序），格式为方括号括起来的逗号分隔列表，例如 `[a,b,c]`，其中 $a$、$b$ 和 $c$ 均为以每个原子 $\\mathrm{eV}$ 为单位的浮点数。\n\n不允许外部输入。代码必须是自包含的，并且必须严格按照上述描述实现指定的数值过程。最终输出必须以每个原子的电子伏特表示，并且应为单行打印的列表。",
            "solution": "所提出的问题是计算材料科学领域的一个有效练习。它在科学上基于合金热力学，提供了一组适定的方程和参数，并指定了一个清晰、计算上可行的算法。所有常数、变量和边界条件都得到了明确定义，没有内部矛盾或歧义。该问题要求使用有限尺寸标度分析，将吉布斯混合自由能的曲率外推到热力学极限（$N \\to \\infty$），这是该领域中一种标准且重要的技术。\n\n目标是确定二元合金在特定成分 $x$ 下吉布斯混合自由能的热力学极限曲率 $f''_{\\infty}(x) \\equiv \\lim_{N\\to\\infty} \\frac{d^2 G_{\\mathrm{mix}}}{dx^2}$。该分析从一个定义的每个原子吉布斯自由能模型 $G_{\\mathrm{mix}}(x;N,T)$ 开始，该模型包含了依赖于超胞尺寸 $N$ 的有限尺寸效应。\n\n提供的每个原子吉布斯混合自由能模型为\n$$\nG_{\\mathrm{mix}}(x;N,T) = \\Omega\\,x(1-x) + \\frac{\\alpha}{N}(1-2x)^2 + k_{\\mathrm{B}}T\\left(x\\ln x + (1-x)\\ln(1-x)\\right).\n$$\n该表达式源自基本关系式 $G_{\\mathrm{mix}} = H_{\\mathrm{mix}} - T S_{\\mathrm{conf}}$。混合焓 $H_{\\mathrm{mix}}$ 由正则溶液项 $H_{\\mathrm{mix}}^{\\infty}(x) = \\Omega\\,x(1-x)$ 和一个有限尺寸修正项 $\\Delta H_{\\mathrm{FS}}(x;N) = \\frac{\\alpha}{N}(1-2x)^2$ 组成。构型熵 $S_{\\mathrm{conf}}$ 由理想混合熵 $S_{\\mathrm{conf}}(x) = -k_{\\mathrm{B}}\\left(x\\ln x + (1-x)\\ln(1-x)\\right)$ 给出。问题陈述中表达式 $-T(-k_{\\mathrm{B}}[\\dots])$ 中的双重否定导致了上面显示的正项。\n\n数值过程包括两个主要步骤：\n1.  **数值微分**：曲率，即关于成分的二阶导数 $f''(x;N) = \\frac{d^2 G_{\\mathrm{mix}}}{dx^2}$，使用二阶中心有限差分公式为每个超胞尺寸 $N$ 进行估计。给定步长 $h$，其近似值为\n    $$\n    f''(x;N) \\approx \\frac{G_{\\mathrm{mix}}(x+h;N,T) - 2\\,G_{\\mathrm{mix}}(x;N,T) + G_{\\mathrm{mix}}(x-h;N,T)}{h^2}.\n    $$\n    指定的步长 $h=0.05$ 和成分 $x \\in \\{0.25, 0.50, 0.75\\}$ 确保所有模板点 $\\{x-h, x, x+h\\}$ 都位于物理上有意义的区间 $(0,1)$ 内。\n\n2.  **有限尺寸标度**：有限尺寸修正模型表明，总能量及其导数应表现出对系统尺寸倒数 $1/N$ 的依赖性。因此，将计算出的曲率 $f''(x;N)$ 拟合到形式为\n    $$\n    f''(x;N) = A(x) + \\frac{B(x)}{N}.\n    $$\n    的线性模型。这是通过对计算的 $f''(x;N)$ 值与相应的 $1/N$ 值进行线性回归来实现的。此回归的截距 $A(x)$ 代表了热力学极限 $N \\to \\infty$ 下的曲率值，并且是我们的目标量 $f''_{\\infty}(x)$。\n\n计算将针对指定的成分 $x \\in \\{0.25, 0.50, 0.75\\}$ 进行，使用来自超胞尺寸 $N \\in \\{16, 32, 64, 128\\}$ 的数据。物理参数固定为 $k_{\\mathrm{B}} = 8.617333262145\\times 10^{-5}\\ \\mathrm{eV/K}$，$T = 1000\\ \\mathrm{K}$，$\\Omega = 0.02\\ \\mathrm{eV}$，以及 $\\alpha = 0.1\\ \\mathrm{eV}$。\n\n求解算法实现如下：首先，根据提供的公式定义一个计算 $G_{\\mathrm{mix}}(x;N,T)$ 的函数。其次，另一个函数使用这个 $G_{\\mathrm{mix}}$ 函数和中心差分公式计算数值曲率 $f''(x;N)$。然后，对于每个指定的成分 $x$，我们遍历超胞尺寸 $N$ 的列表，为每个尺寸计算数值曲率。得到的数据点集 $\\{1/N, f''(x;N)\\}$ 用于执行线性拟合。拟合的截距即为外推值 $f''_{\\infty}(x)$。将每个成分的这些外推值收集起来，并以要求的输出格式呈现。线性回归可以方便地使用 `numpy.polyfit` 函数处理，该函数将数据拟合到指定次数的多项式；对于线性拟合，次数为 1。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the thermodynamic-limit curvature of the Gibbs free energy of mixing\n    for a binary alloy model via finite-size scaling.\n    \"\"\"\n    # Define physical and numerical constants from the problem statement.\n    K_B = 8.617333262145e-5  # Boltzmann constant in eV/K\n    T = 1000.0                # Temperature in K\n    OMEGA = 0.02              # Regular solution parameter in eV\n    ALPHA = 0.1               # Finite-size correction amplitude in eV\n    H = 0.05                  # Finite-difference step size (dimensionless)\n\n    # Define the test cases from the problem statement.\n    N_values = [16, 32, 64, 128]\n    x_compositions = [0.25, 0.50, 0.75]\n\n    def g_mix(x, N):\n        \"\"\"\n        Calculates the Gibbs free energy of mixing per atom for a given\n        composition x and supercell size N.\n        \n        Args:\n            x (float): Composition of species B.\n            N (int): Number of atoms in the SQS supercell.\n\n        Returns:\n            float: The Gibbs free energy of mixing in eV/atom.\n        \"\"\"\n        if x == 0 or x >= 1:\n            # log(0) is undefined, compositions must be in (0,1)\n            return float('inf')\n        \n        h_mix_inf = OMEGA * x * (1 - x)\n        delta_h_fs = (ALPHA / N) * (1 - 2 * x)**2\n        \n        # The term in the problem is -T*S_conf where S_conf = -k_B*[...],\n        # so it becomes +k_B*T*[...].\n        s_conf_term = K_B * T * (x * np.log(x) + (1 - x) * np.log(1 - x))\n        \n        return h_mix_inf + delta_h_fs + s_conf_term\n\n    def f_double_prime_numerical(x, N):\n        \"\"\"\n        Computes the numerical second derivative of G_mix with respect to x\n        using the central finite-difference formula.\n        \n        Args:\n            x (float): Composition of species B.\n            N (int): Number of atoms in the SQS supercell.\n            \n        Returns:\n            float: The numerical curvature of G_mix in eV/atom.\n        \"\"\"\n        g_plus = g_mix(x + H, N)\n        g_mid = g_mix(x, N)\n        g_minus = g_mix(x - H, N)\n        \n        return (g_plus - 2 * g_mid + g_minus) / (H**2)\n\n    results = []\n    \n    # Prepare the independent variable for linear regression (1/N)\n    inv_N_values = np.array([1.0 / n for n in N_values])\n\n    # Loop over each composition to analyze\n    for x in x_compositions:\n        # Calculate the numerical curvature for each supercell size N\n        curvatures = np.array([f_double_prime_numerical(x, n) for n in N_values])\n        \n        # Perform linear regression of curvatures vs. 1/N.\n        # np.polyfit with deg=1 returns [slope, intercept].\n        # The intercept is the extrapolated value for N -> infinity (1/N -> 0).\n        coeffs = np.polyfit(inv_N_values, curvatures, 1)\n        intercept = coeffs[1]\n        \n        results.append(intercept)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}