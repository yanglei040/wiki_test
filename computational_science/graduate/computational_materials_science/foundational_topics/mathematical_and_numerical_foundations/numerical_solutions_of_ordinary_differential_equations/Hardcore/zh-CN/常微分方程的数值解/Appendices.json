{
    "hands_on_practices": [
        {
            "introduction": "为什么我们不能对所有问题都使用简单的显式方法？本练习通过分析最基本的显式方法——前向欧拉法的稳定性，来深入探讨这个问题的核心。通过将其应用于代表热扩散单个模式（材料科学中的常见情景）的模型问题，你将推导出时间步长的严格限制，从而揭示刚性问题的根本挑战。",
            "id": "3472108",
            "problem": "在一个具有各向同性热扩散率 $D$ 的均匀晶体薄膜的瞬态热传导中，其控制偏微分方程 (PDE) 为 $\\frac{\\partial u}{\\partial t} = D \\nabla^{2} u$。使用带质量集中的伽辽金有限元法进行标准的空间离散化，可以得到一个形式为 $\\dot{\\mathbf{u}} = \\mathbf{L}\\mathbf{u}$ 的自治线性常微分方程 (ODE) 组，其中 $\\mathbf{L}$ 是一个实对称负定矩阵。考虑与 $\\mathbf{L}$ 的一个特征对 $(\\lambda, \\mathbf{v})$ 相关联的单个模态分量 $y(t)$，即 $\\mathbf{L}\\mathbf{v} = \\lambda \\mathbf{v}$ 且 $y(t) = \\mathbf{v}^{\\top}\\mathbf{u}(t)$，该分量遵循标量线性常微分方程 $y'(t) = \\lambda y(t)$，其中 $\\lambda \\in \\mathbb{R}$ 且 $\\lambda  0$。\n\n从时间导数的前向有限差分定义和显式欧拉时间推进更新出发，推导标量单步放大因子 $R(z)$，将其表示为 $z = \\lambda h$ 的函数，其中 $h > 0$ 是时间步长。使用绝对稳定域 $\\mathcal{S}$ 的定义，即满足 $|R(z)|  1$ 的复数 $z$ 的集合，确定最大时间步长 $h$ 作为给定的实数负值 $\\lambda$ 的函数，以使 $z = \\lambda h$ 保持在 $\\mathcal{S}$ 内。\n\n将您的最终答案表示为 $R(z)$ 和 $h_{\\max}(\\lambda)$ 的闭式解析表达式。不需要数值舍入。最终表达式中不需要物理单位。",
            "solution": "用户希望我验证以下问题：\n在一个具有各向同性热扩散率 $D$ 的均匀晶体薄膜的瞬态热传导中，其控制偏微分方程 (PDE) 为 $\\frac{\\partial u}{\\partial t} = D \\nabla^{2} u$。使用带质量集中的伽辽金有限元法进行标准的空间离散化，可以得到一个形式为 $\\dot{\\mathbf{u}} = \\mathbf{L}\\mathbf{u}$ 的自治线性常微分方程 (ODE) 组，其中 $\\mathbf{L}$ 是一个实对称负定矩阵。考虑与 $\\mathbf{L}$ 的一个特征对 $(\\lambda, \\mathbf{v})$ 相关联的单个模态分量 $y(t)$，即 $\\mathbf{L}\\mathbf{v} = \\lambda \\mathbf{v}$ 且 $y(t) = \\mathbf{v}^{\\top}\\mathbf{u}(t)$，该分量遵循标量线性常微分方程 $y'(t) = \\lambda y(t)$，其中 $\\lambda \\in \\mathbb{R}$ 且 $\\lambda  0$。\n\n从时间导数的前向有限差分定义和显式欧拉时间推进更新出发，推导标量单步放大因子 $R(z)$，将其表示为 $z = \\lambda h$ 的函数，其中 $h > 0$ 是时间步长。使用绝对稳定域 $\\mathcal{S}$ 的定义，即满足 $|R(z)|  1$ 的复数 $z$ 的集合，确定最大时间步长 $h$ 作为给定的实数负值 $\\lambda$ 的函数，以使 $z = \\lambda h$ 保持在 $\\mathcal{S}$ 内。\n\n将您的最终答案表示为 $R(z)$ 和 $h_{\\max}(\\lambda)$ 的闭式解析表达式。不需要数值舍入。最终表达式中不需要物理单位。\n\n### 步骤 1：提取已知条件\n- 控制偏微分方程：$\\frac{\\partial u}{\\partial t} = D \\nabla^{2} u$\n- 离散化常微分方程组：$\\dot{\\mathbf{u}} = \\mathbf{L}\\mathbf{u}$\n- 矩阵 $\\mathbf{L}$ 的性质：实数、对称、负定\n- $\\mathbf{L}$ 的特征对：$(\\lambda, \\mathbf{v})$ 使得 $\\mathbf{L}\\mathbf{v} = \\lambda \\mathbf{v}$\n- 标量模态常微分方程：$y'(t) = \\lambda y(t)$\n- 特征值 $\\lambda$ 的性质：$\\lambda \\in \\mathbb{R}$ 且 $\\lambda  0$\n- 时间步长：$h > 0$\n- 变量定义：$z = \\lambda h$\n- 数值方法：显式欧拉法，由时间导数的前向有限差分推导而来。\n- 绝对稳定域 $\\mathcal{S}$ 的定义：$\\{z \\in \\mathbb{C} : |R(z)|  1\\}$\n- 任务 1：推导标量单步放大因子 $R(z)$。\n- 任务 2：确定最大步长 $h_{\\max}$ 作为 $\\lambda$ 的函数。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题具有科学依据。其背景是热方程的数值解，这是物理学和工程学中的一个基本问题。矩量法，即通过空间离散化（此处指定为伽辽金有限元法）来获得常微分方程组，是一种标准且严谨的技术。所得矩阵 $\\mathbf{L}$ 具有实数、对称和负定的性质，这是拉普拉斯算子在常见边界条件下的特征，确保了热量从较热区域流向较冷区域以及系统向稳定平衡态演化的物理原理。模态分析是将系统动力学分解为形如 $y'(t) = \\lambda y(t)$ 的标量常微分方程，这是线性系统的标准处理程序。负定矩阵 $\\mathbf{L}$ 的特征值 $\\lambda$ 确实是实数且为负。使用放大因子分析显式欧拉法的稳定性是常微分方程数值分析中的一个经典课题。\n\n该问题是适定的。它要求基于一组清晰的定义和出发点，推导两个特定量 $R(z)$ 和 $h_{\\max}(\\lambda)$。求解路径是唯一且无歧义的。\n\n该问题是客观的。所有术语都经过了数学上的精确定义，没有主观或基于观点的陈述。\n\n该问题不存在任何无效性缺陷。它在科学上是合理的、可形式化的、完整的且结构良好。\n\n### 步骤 3：结论与行动\n该问题是**有效的**。将提供解答。\n\n该问题要求推导显式欧拉法的放大因子，并随后确定受稳定性限制的时间步长。\n\n出发点是标量线性常微分方程，通常称为测试方程，它控制着系统单个模态分量的演化：\n$$\ny'(t) = \\lambda y(t)\n$$\n这里，$y(t)$ 是在时间 $t$ 的模态振幅，$\\lambda$ 是相应的实数负特征值。\n\n显式欧拉法是通过将时间离散化为大小为 $h > 0$ 的步长来推导的。设 $y_n$ 是在时间 $t_n = n h$ 时 $y(t_n)$ 的数值近似。在 $t_n$ 处的时间导数 $y'(t)$ 使用前向有限差分进行近似：\n$$\ny'(t_n) \\approx \\frac{y_{n+1} - y_n}{h}\n$$\n将此近似代入常微分方程，得到时间推进格式：\n$$\n\\frac{y_{n+1} - y_n}{h} = \\lambda y_n\n$$\n这个更新规则定义了显式欧拉法。为了找到单步放大因子，我们求解 $y_{n+1}$ 关于 $y_n$ 的表达式：\n$$\ny_{n+1} - y_n = \\lambda h y_n\n$$\n$$\ny_{n+1} = y_n + \\lambda h y_n = (1 + \\lambda h) y_n\n$$\n标量单步放大因子，我们记作 $R$，是解在每个时间步长上乘以的因子。它被定义为比率 $y_{n+1} / y_n$：\n$$\nR = \\frac{y_{n+1}}{y_n} = 1 + \\lambda h\n$$\n问题指明该因子应表示为 $z = \\lambda h$ 的函数。将 $z$ 代入 $R$ 的表达式，得到第一个要求的表达式：\n$$\nR(z) = 1 + z\n$$\n任务的第二部分是确定使该方法稳定的最大步长 $h_{\\max}$。问题将绝对稳定域 $\\mathcal{S}$ 定义为放大因子的模严格小于 $1$ 的复数 $z$ 的集合：\n$$\n\\mathcal{S} = \\{z \\in \\mathbb{C} : |R(z)|  1\\}\n$$\n为了使数值解保持有界且不会人为增长，$z = \\lambda h$ 必须位于此区域内。代入我们得到的 $R(z)$ 表达式，稳定性条件变为：\n$$\n|1 + z|  1\n$$\n问题陈述了 $\\lambda$ 是一个实数负数 ($\\lambda  0$) 且时间步长 $h$ 是正数 ($h > 0$)。因此，它们的乘积 $z = \\lambda h$ 是一个实数负数。设 $z = x$，其中 $x \\in \\mathbb{R}$ 且 $x  0$。稳定性条件简化为：\n$$\n|1 + x|  1\n$$\n对于实数参数，此不等式等价于：\n$$\n-1  1 + x  1\n$$\n我们通过从所有部分减去 $1$ 来解这个复合不等式关于 $x$ 的解：\n$$\n-1 - 1  x  1 - 1\n$$\n$$\n-2  x  0\n$$\n因此，为使方法稳定，$z = \\lambda h$ 必须位于开区间 $(-2, 0)$ 内。我们将 $z = \\lambda h$ 代回这个不等式：\n$$\n-2  \\lambda h  0\n$$\n这个复合不等式包含两个条件：\n1. $\\lambda h  0$：因为给定 $\\lambda  0$ 且 $h > 0$，它们的乘积总是负的。因此这个条件总是满足的。\n2. $-2  \\lambda h$：这个条件对时间步长 $h$ 施加了约束。为了解出 $h$，我们用 $\\lambda$ 去除。因为 $\\lambda$ 是一个负数，所以除以它会反转不等号的方向：\n$$\n\\frac{-2}{\\lambda} > h\n$$\n这可以重写为：\n$$\nh  \\frac{-2}{\\lambda}\n$$\n这个不等式定义了对于给定的负特征值 $\\lambda$，显式欧拉法稳定的时间步长 $h$ 的范围。最大允许步长 $h_{\\max}$ 是这个稳定步长集合的上确界，即区间的上界。\n$$\nh_{\\max}(\\lambda) = \\frac{-2}{\\lambda}\n$$\n在这个边界值上，$h = -2/\\lambda$，我们有 $z = \\lambda h = -2$，这得到 $|R(z)| = |1 - 2| = |-1| = 1$。这一点位于稳定域的边界上，但不在其内部，这与严格不等式 $|R(z)|  1$ 一致。\n\n两个要求的表达式是 $R(z) = 1+z$ 和 $h_{\\max}(\\lambda) = \\frac{-2}{\\lambda}$。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 1 + z  \\frac{-2}{\\lambda} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "认识到显式方法的局限性后，我们转向其解决方案：隐式方法。本练习从理论走向应用，处理由隐式步（使用后向欧拉法）产生的非线性代数方程。你将为一个代表性的缺陷动力学模型推导并应用牛顿法——求解这些方程的标准迭代求解器，从而获得关于刚性常微分方程求解器核心机制的实践经验。",
            "id": "3472164",
            "problem": "考虑一个与计算材料科学相关的刚性、无量纲化的微观结构动力学模型，其中无量纲点缺陷浓度 $c$ 和无量纲位错密度 $\\rho$ 的演化由一个常微分方程（ODE）自治系统描述\n$$\n\\frac{d}{dt}\n\\begin{pmatrix}\nc \\\\\n\\rho\n\\end{pmatrix}\n=\n\\Phi\\!\\left(\n\\begin{pmatrix}\nc \\\\\n\\rho\n\\end{pmatrix}\n\\right), \\quad\n\\Phi\\!\\left(\n\\begin{pmatrix}\nc \\\\\n\\rho\n\\end{pmatrix}\n\\right)\n=\n\\begin{pmatrix}\n-k\\,c + a\\,\\rho\\,c \\\\\nb\\,c - d\\,\\rho\n\\end{pmatrix},\n$$\n其中 $k$、$a$、$b$ 和 $d$ 为正常数。一个隐式单步法，例如后向欧拉法，通过求解非线性步长方程将解从 $t_n$ 推进到 $t_{n+1}=t_n + h$\n$$\nG(y_{n+1}) \\equiv y_{n+1} - y_n - h\\,\\Phi(y_{n+1}) = 0,\n$$\n其中 $y = (c,\\rho)^{\\top}$ 且 $h>0$ 为步长。从非线性映射求根和一阶泰勒线性化的基本定义出发，推导在每个时间步求解 $G(y_{n+1})=0$ 的牛顿迭代法。利用 $G$ 的雅可比矩阵显式推导迭代映射，并说明 $G$ 的雅可比矩阵如何依赖于 $\\Phi$ 的雅可比矩阵。然后，陈述基于残差范数和步长范数的停止准则，并明确所使用的范数。\n\n接下来，将您推导的迭代和准则应用于以下具体实例。设 $k=5$，$a=3$，$b=2$，$d=4$，步长 $h=0.05$，上一步的值为 $y_n=\\big(0.8,\\,0.6\\big)^{\\top}$。使用初始牛顿猜测值 $y_{n+1}^{(0)}=y_n$。通过求解相应的线性系统，执行一次牛顿更新以计算第一个牛顿步长 $s^{(0)}=y_{n+1}^{(1)}-y_{n+1}^{(0)}$。计算欧几里得范数 $\\|s^{(0)}\\|_2$。假设残差和步长的停止容差分别为 $\\tau_{\\mathrm{res}}=1.0\\times 10^{-4}$ 和 $\\tau_{\\mathrm{step}}=1.0\\times 10^{-4}$，并评论在第一次更新后是否有任一准则会触发终止。将 $\\|s^{(0)}\\|_2$ 的值作为一个无量纲实数报告。将您的答案四舍五入到四位有效数字。",
            "solution": "该问题要求推导用于求解常微分方程组隐式时间步长格式产生的非线性系统的牛顿迭代法，然后将其应用于一个具体案例。\n\n### 第1部分：牛顿迭代的推导\n\n将后向欧拉法应用于 ODE 系统 $\\frac{dy}{dt} = \\Phi(y)$，在每个时间步得到关于 $y_{n+1}$ 的非线性代数方程：\n$$\ny_{n+1} = y_n + h\\,\\Phi(y_{n+1})\n$$\n这可以写成一个求根问题 $G(y_{n+1}) = 0$，其中函数 $G$ 定义为：\n$$\nG(y_{n+1}) \\equiv y_{n+1} - y_n - h\\,\\Phi(y_{n+1}) = 0\n$$\n牛顿法是一种迭代求根算法。设 $y_{n+1}^{(k)}$ 是解 $y_{n+1}$ 的第 $k$ 次近似。我们寻求一个修正量或步长 $s^{(k)}$，使得 $y_{n+1}^{(k+1)} = y_{n+1}^{(k)} + s^{(k)}$ 是一个更好的近似。我们通过在 $y_{n+1}^{(k)}$ 附近使用一阶泰勒展开来线性化 $G$ 来找到 $s^{(k)}$：\n$$\nG(y_{n+1}^{(k+1)}) = G(y_{n+1}^{(k)} + s^{(k)}) \\approx G(y_{n+1}^{(k)}) + J_G(y_{n+1}^{(k)}) s^{(k)}\n$$\n其中 $J_G(y_{n+1}^{(k)})$ 是 $G$ 在 $y_{n+1}^{(k)}$ 处的雅可比矩阵。为了找到根，我们将 $G(y_{n+1}^{(k+1)})$ 的近似值设为零：\n$$\nG(y_{n+1}^{(k)}) + J_G(y_{n+1}^{(k)}) s^{(k)} = 0\n$$\n这给出了牛顿步长 $s^{(k)}$ 的线性系统：\n$$\nJ_G(y_{n+1}^{(k)}) s^{(k)} = -G(y_{n+1}^{(k)})\n$$\n牛顿迭代法通过求解这个关于 $s^{(k)}$ 的线性系统并更新解来定义：\n$$\ny_{n+1}^{(k+1)} = y_{n+1}^{(k)} + s^{(k)}\n$$\n为了使其明确，我们必须推导 $G$ 的雅可比矩阵。向量 $y_n$ 相对于变量 $y_{n+1}$ 是一个常数。为了求导方便，我们简单地将 $y_{n+1}$ 表示为 $y$。\n$$\nJ_G(y) = \\frac{\\partial G(y)}{\\partial y} = \\frac{\\partial}{\\partial y} \\left( y - y_n - h\\,\\Phi(y) \\right)\n$$\n使用向量微积分的法则：\n$$\nJ_G(y) = \\frac{\\partial y}{\\partial y} - \\frac{\\partial y_n}{\\partial y} - h \\frac{\\partial \\Phi(y)}{\\partial y} = I - 0 - h\\,J_{\\Phi}(y)\n$$\n其中 $I$ 是单位矩阵，$J_{\\Phi}(y)$ 是函数 $\\Phi(y)$ 的雅可比矩阵。因此，$G$ 的雅可比矩阵与 $\\Phi$ 的雅可比矩阵的关系如下：\n$$\nJ_G(y) = I - h\\,J_{\\Phi}(y)\n$$\n将此代入牛顿系统，迭代映射由以下序列定义（对于 $k=0, 1, 2, ...$）：\n1. 求解关于 $s^{(k)}$ 的线性系统：\n   $$\n   \\left(I - h\\,J_{\\Phi}(y_{n+1}^{(k)})\\right) s^{(k)} = -(y_{n+1}^{(k)} - y_n - h\\,\\Phi(y_{n+1}^{(k)})) = y_n - y_{n+1}^{(k)} + h\\,\\Phi(y_{n+1}^{(k)})\n   $$\n2. 更新解：\n   $$\n   y_{n+1}^{(k+1)} = y_{n+1}^{(k)} + s^{(k)}\n   $$\n\n对于具体系统 $y = (c, \\rho)^{\\top}$ 和 $\\Phi(y) = \\begin{pmatrix} -k\\,c + a\\,\\rho\\,c \\\\ b\\,c - d\\,\\rho \\end{pmatrix}$，$\\Phi$ 的雅可比矩阵为：\n$$\nJ_{\\Phi}(y) = \\begin{pmatrix} \\frac{\\partial}{\\partial c}(-k\\,c + a\\,\\rho\\,c)  \\frac{\\partial}{\\partial \\rho}(-k\\,c + a\\,\\rho\\,c) \\\\ \\frac{\\partial}{\\partial c}(b\\,c - d\\,\\rho)  \\frac{\\partial}{\\partial \\rho}(b\\,c - d\\,\\rho) \\end{pmatrix} = \\begin{pmatrix} a\\,\\rho - k  a\\,c \\\\ b  -d \\end{pmatrix}\n$$\n\n### 第2部分：停止准则\n\n牛顿迭代会一直持续，直到达到所需的精度水平。这是通过停止准则来监控的。两个常见的准则是：\n1.  **残差范数准则**：如果残差向量 $G(y_{n+1}^{(k)})$ 的范数低于指定的容差 $\\tau_{\\mathrm{res}}$，则迭代停止。残差衡量当前迭代值满足目标方程的程度。该准则为：\n    $$\n    \\|G(y_{n+1}^{(k)})\\| \\le \\tau_{\\mathrm{res}}\n    $$\n2.  **步长范数准则**：如果更新步长 $s^{(k)}$ 的范数低于指定的容差 $\\tau_{\\mathrm{step}}$，则迭代停止。一个小的步长表明解不再发生显著变化。该准则为：\n    $$\n    \\|s^{(k)}\\| \\le \\tau_{\\mathrm{step}}\n    $$\n在这两种情况下，都必须指定一个向量范数，例如欧几里得范数 $(\\|\\cdot\\|_2)$ 或最大范数 $(\\|\\cdot\\|_{\\infty})$。问题指定在定量部分使用欧几里得范数。\n\n### 第3部分：具体实例应用\n\n我们给定以下参数值：\n$k=5$，$a=3$，$b=2$，$d=4$，$h=0.05$。\n上一步的值为 $y_n = \\begin{pmatrix} c_n \\\\ \\rho_n \\end{pmatrix} = \\begin{pmatrix} 0.8 \\\\ 0.6 \\end{pmatrix}^{\\top}$。\n牛顿迭代的初始猜测值为 $y_{n+1}^{(0)} = y_n = \\begin{pmatrix} 0.8 \\\\ 0.6 \\end{pmatrix}^{\\top}$。\n\n令 $y^{(0)} = y_{n+1}^{(0)}$。我们需要通过求解 $(I - h\\,J_{\\Phi}(y^{(0)})) s^{(0)} = h\\,\\Phi(y^{(0)})$ 来计算第一个牛顿步长 $s^{(0)}$，由于 $y^{(0)} = y_n$，右侧已被简化。\n\n首先，我们在 $y^{(0)} = (0.8, 0.6)^{\\top}$ 处计算 $\\Phi$ 和 $J_{\\Phi}$：\n$$\n\\Phi(y^{(0)}) = \\begin{pmatrix} -5(0.8) + 3(0.6)(0.8) \\\\ 2(0.8) - 4(0.6) \\end{pmatrix} = \\begin{pmatrix} -4 + 1.44 \\\\ 1.6 - 2.4 \\end{pmatrix} = \\begin{pmatrix} -2.56 \\\\ -0.8 \\end{pmatrix}\n$$\n$$\nJ_{\\Phi}(y^{(0)}) = \\begin{pmatrix} 3(0.6) - 5  3(0.8) \\\\ 2  -4 \\end{pmatrix} = \\begin{pmatrix} 1.8 - 5  2.4 \\\\ 2  -4 \\end{pmatrix} = \\begin{pmatrix} -3.2  2.4 \\\\ 2  -4 \\end{pmatrix}\n$$\n接下来，我们构建线性系统的矩阵 $I - h\\,J_{\\Phi}(y^{(0)})$：\n$$\nI - h\\,J_{\\Phi}(y^{(0)}) = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} - 0.05 \\begin{pmatrix} -3.2  2.4 \\\\ 2  -4 \\end{pmatrix} = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} - \\begin{pmatrix} -0.16  0.12 \\\\ 0.1  -0.2 \\end{pmatrix} = \\begin{pmatrix} 1.16  -0.12 \\\\ -0.1  1.2 \\end{pmatrix}\n$$\n线性系统的右侧是 $h\\,\\Phi(y^{(0)})$：\n$$\nh\\,\\Phi(y^{(0)}) = 0.05 \\begin{pmatrix} -2.56 \\\\ -0.8 \\end{pmatrix} = \\begin{pmatrix} -0.128 \\\\ -0.04 \\end{pmatrix}\n$$\n我们求解关于 $s^{(0)} = (s_c^{(0)}, s_{\\rho}^{(0)})^{\\top}$ 的线性系统：\n$$\n\\begin{pmatrix} 1.16  -0.12 \\\\ -0.1  1.2 \\end{pmatrix} s^{(0)} = \\begin{pmatrix} -0.128 \\\\ -0.04 \\end{pmatrix}\n$$\n为了求解这个系统，我们可以对 $2 \\times 2$ 矩阵求逆。行列式为 $\\det = (1.16)(1.2) - (-0.12)(-0.1) = 1.392 - 0.012 = 1.38$。\n$$\ns^{(0)} = \\frac{1}{1.38} \\begin{pmatrix} 1.2  0.12 \\\\ 0.1  1.16 \\end{pmatrix} \\begin{pmatrix} -0.128 \\\\ -0.04 \\end{pmatrix} = \\frac{1}{1.38} \\begin{pmatrix} 1.2(-0.128) + 0.12(-0.04) \\\\ 0.1(-0.128) + 1.16(-0.04) \\end{pmatrix}\n$$\n$$\ns^{(0)} = \\frac{1}{1.38} \\begin{pmatrix} -0.1536 - 0.0048 \\\\ -0.0128 - 0.0464 \\end{pmatrix} = \\frac{1}{1.38} \\begin{pmatrix} -0.1584 \\\\ -0.0592 \\end{pmatrix} \\approx \\begin{pmatrix} -0.1147826... \\\\ -0.0428985... \\end{pmatrix}\n$$\n现在我们计算步长的欧几里得范数 $\\|s^{(0)}\\|_2$：\n$$\n\\|s^{(0)}\\|_2 = \\sqrt{(-0.1147826...)^2 + (-0.0428985...)^2} \\approx \\sqrt{0.0131750... + 0.001839...} = \\sqrt{0.0150150...} \\approx 0.122537...\n$$\n四舍五入到四位有效数字，$\\|s^{(0)}\\|_2 \\approx 0.1225$。\n\n最后，我们用容差 $\\tau_{\\mathrm{res}}=1.0\\times 10^{-4}$ 和 $\\tau_{\\mathrm{step}}=1.0\\times 10^{-4}$ 检查停止准则。\n- **步长范数**：$\\|s^{(0)}\\|_2 \\approx 0.1225$。由于 $0.1225 > 1.0\\times 10^{-4}$，步长范数准则未满足。\n- **残差范数**：初始猜测值处的残差为 $G(y^{(0)}) = y^{(0)} - y_n - h\\,\\Phi(y^{(0)}) = -h\\,\\Phi(y^{(0)})$。\n  $$\n  \\|G(y^{(0)})\\|_2 = \\|-h\\,\\Phi(y^{(0)})\\|_2 = \\|-1\\|_2 \\left\\| \\begin{pmatrix} -0.128 \\\\ -0.04 \\end{pmatrix} \\right\\|_2 = \\sqrt{(-0.128)^2 + (-0.04)^2}\n  $$\n  $$\n  \\|G(y^{(0)})\\|_2 = \\sqrt{0.016384 + 0.0016} = \\sqrt{0.017984} \\approx 0.1341\n  $$\n  由于 $0.1341 > 1.0\\times 10^{-4}$，残差范数准则未满足。\n\n在第一次更新后，两个准则都不会触发终止。问题要求 $\\|s^{(0)}\\|_2$ 的值。",
            "answer": "$$\n\\boxed{0.1225}\n$$"
        },
        {
            "introduction": "稳健的隐式方法从何而来？这个高级练习将带你进入数值方法设计的世界。你将从第一性原理出发，通过强制施加精度（阶条件）和极端稳定性（L-稳定性）的条件，构建一种专门的隐式龙格-库塔（SDIRK）方法。本练习揭示了方法构造的奥秘，并展示了如何将刚性问题所需的理想特性通过数学方式“设计”到求解器的系数中。",
            "id": "3472175",
            "problem": "在计算材料科学中，一个用于点缺陷群体热激活弛豫的常见简化模型是标量刚性常微分方程 $\\dot{y}(t) = f(t,y)$，其形式近似为 $f(t,y) \\approx -\\kappa \\left(y(t) - y_{\\infty}\\right)$，其中 $\\kappa \\gg 1$ 反映了快速的微观平衡。为了稳健地积分这种刚性动力学，考虑构造一个形式为单对角隐式龙格-库塔（SDIRK）的 2 阶、二级龙格-库塔方法。令其 Butcher 系数表具有\n- 对角线元素 $a_{11} = a_{22} = \\gamma$，其中 $\\gamma \\in \\mathbb{R}$，\n- 严格下三角元素 $a_{21}$（待定），\n- 权重 $b_{1}, b_{2}$（待定），以及\n- 横坐标 $c = A \\mathbf{1}$，其中 $\\mathbf{1}$ 是全为 1 的 2 维向量。\n\n仅从龙格-库塔方法的定义以及其局部截断误差与精确流的泰勒展开匹配到 $h^{2}$ 阶项的要求出发，按以下步骤进行：\n\n1. 对于一般的 $\\dot{y}(t) = f(t,y)$，通过将方法的更新与精确解展开式匹配到 $h^{2}$ 阶，推导出系数必须满足的二阶条件。使用这些条件以及 $c = A \\mathbf{1}$，将 $b_{1}$ 和 $b_{2}$ 表示为 $\\gamma$ 和 $a_{21}$ 的函数。\n\n2. 为了改善材料体系中典型的刚性弛豫各阶段的时间布局，施加 $c_{2} = 1$ 的条件，使得第二个阶段在 $t_{n} + h$ 处求值。使用 $c = A \\mathbf{1}$ 消去 $a_{21}$，用 $\\gamma$ 表示。\n\n3. 当将得到的 2 级 SDIRK 族应用于线性测试方程 $\\dot{y} = \\lambda y$（其中 $z = h \\lambda$ 且 $\\Re(\\lambda)  0$）时，计算其线性稳定性函数 $R(z)$。使用定义 $R(z) = 1 + z\\, b^{\\top} (I - z A)^{-1} \\mathbf{1}$，将 $R(z)$ 推导为 $z$ 和 $\\gamma$ 的符号有理函数。\n\n4. 施加 L-稳定性要求，即 $\\lim_{z \\to -\\infty} R(z) = 0$，这对于刚性材料动力学中的强阻尼快速模态是理想的。利用此要求推导出系数之间的一个附加代数关系。\n\n5. 结合二阶条件和 L-稳定性条件，确定唯一的 $\\gamma \\in (0,1)$ 值，该值可得到一个二阶、L-稳定的 2 级 SDIRK 方法。\n\n用一两句话简要评论，在施加 L-稳定性之前，如何针对计算材料科学中的刚性问题调整剩余的自由参数以获得稳定性。将计算出的最优 $\\gamma$ 值以精确解析表达式的形式报告。不需要四舍五入，且 $\\gamma$ 不带单位。",
            "solution": "该问题要求为一个特定的 2 级、二阶、L-稳定的单对角隐式龙格-库塔（SDIRK）方法推导系数 $\\gamma$。我们将系统地遵循问题陈述中提供的步骤。\n\n一个 $s$ 级龙格-库塔方法由其 Butcher 表定义：\n$$\n\\begin{array}{c|c}\nc  A \\\\\n\\hline\n b^{\\top}\n\\end{array}\n$$\n其中 $c \\in \\mathbb{R}^s$ 是横坐标向量，$A \\in \\mathbb{R}^{s \\times s}$ 是系数矩阵，$b \\in \\mathbb{R}^s$ 是权重向量。对于本问题，我们有 $s=2$。SDIRK 结构要求矩阵 $A$ 是下三角矩阵，且所有对角线元素相等。给定的结构是：\n$$\nA = \\begin{pmatrix} a_{11}  a_{12} \\\\ a_{21}  a_{22} \\end{pmatrix} = \\begin{pmatrix} \\gamma  0 \\\\ a_{21}  \\gamma \\end{pmatrix}\n$$\n条件 $c = A \\mathbf{1}$（其中 $\\mathbf{1}$ 是全 1 向量）意味着：\n$$\nc_1 = a_{11} + a_{12} = \\gamma + 0 = \\gamma\n$$\n$$\nc_2 = a_{21} + a_{22} = a_{21} + \\gamma\n$$\n\n**1. 二阶条件的推导**\n\n为确保方法的局部截断误差为 $O(h^3)$ 阶，其数值更新必须与精确解的泰勒展开匹配到 $h^2$ 阶项。精确解 $y(t_{n+1})$ 在 $t_n$ 附近的泰勒级数是：\n$$\ny(t_{n+1}) = y(t_n) + h y'(t_n) + \\frac{h^2}{2} y''(t_n) + O(h^3)\n$$\n使用 $\\dot{y} = f(t,y)$，上式变为：\n$$\ny(t_{n+1}) = y_n + h f_n + \\frac{h^2}{2} \\left( \\frac{\\partial f}{\\partial t} + \\frac{\\partial f}{\\partial y} f \\right)_{n} + O(h^3)\n$$\n数值解为 $y_{n+1} = y_n + h \\sum_{i=1}^{s} b_i k_i$。将各阶段值 $k_i$ 和数值解 $y_{n+1}$ 按 $h$ 的幂次展开，并与精确解的项进行匹配，即可得到阶条件。对于一个一般的龙格-库塔方法要达到二阶精度，其系数必须满足以下条件：\n\\begin{enumerate}\n    \\item $\\sum_{i=1}^{s} b_i = 1$\n    \\item $\\sum_{i=1}^{s} b_i c_i = \\frac{1}{2}$\n    \\item $\\sum_{i=1}^{s} b_i \\sum_{j=1}^{s} a_{ij} = \\frac{1}{2}$\n\\end{enumerate}\n问题指定了简化条件 $c = A \\mathbf{1}$，即对每个阶段 $i$ 都有 $\\sum_{j=1}^{s} a_{ij} = c_i$。将此代入第三个条件得到 $\\sum_{i=1}^{s} b_i c_i = \\frac{1}{2}$，这与第二个条件相同。因此，对于我们 $s=2$ 的问题，二阶条件简化为：\n$$\nb_1 + b_2 = 1\n$$\n$$\nb_1 c_1 + b_2 c_2 = \\frac{1}{2}\n$$\n使用 $c_1 = \\gamma$ 和 $c_2 = a_{21} + \\gamma$，该方程组变为：\n$$\nb_1 + b_2 = 1\n$$\n$$\nb_1 \\gamma + b_2 (a_{21} + \\gamma) = \\frac{1}{2}\n$$\n由第一个方程，我们得到 $b_1 = 1 - b_2$。将其代入第二个方程：\n$$\n(1 - b_2)\\gamma + b_2(a_{21} + \\gamma) = \\frac{1}{2}\n$$\n$$\n\\gamma - b_2 \\gamma + b_2 a_{21} + b_2 \\gamma = \\frac{1}{2}\n$$\n$$\n\\gamma + b_2 a_{21} = \\frac{1}{2}\n$$\n假设 $a_{21} \\neq 0$（我们稍后会验证这一点），我们可以解出 $b_2$：\n$$\nb_2 = \\frac{\\frac{1}{2} - \\gamma}{a_{21}} = \\frac{1 - 2\\gamma}{2a_{21}}\n$$\n然后，我们求出 $b_1$：\n$$\nb_1 = 1 - b_2 = 1 - \\frac{1 - 2\\gamma}{2a_{21}} = \\frac{2a_{21} - (1 - 2\\gamma)}{2a_{21}} = \\frac{2a_{21} - 1 + 2\\gamma}{2a_{21}}\n$$\n这些表达式将权重 $b_1$ 和 $b_2$ 与系数 $\\gamma$ 和 $a_{21}$ 联系起来。\n\n**2. 施加 $c_2 = 1$**\n\n问题施加了约束条件 $c_2 = 1$。使用关系式 $c_2 = a_{21} + \\gamma$，我们得到：\n$$\n1 = a_{21} + \\gamma \\implies a_{21} = 1 - \\gamma\n$$\n这意味着 $\\gamma \\neq 1$，否则 $a_{21}=0$，除非 $\\gamma = 1/2$，否则这会导致 $b_2$ 的表达式出现矛盾。如果 $\\gamma=1$，分子为 $-1/2$，所以我们必须有 $a_{21} \\neq 0$。\n将 $a_{21} = 1 - \\gamma$ 代入 $b_1$ 和 $b_2$ 的表达式中：\n$$\nb_2 = \\frac{1 - 2\\gamma}{2(1 - \\gamma)}\n$$\n$$\nb_1 = 1 - b_2 = 1 - \\frac{1 - 2\\gamma}{2(1 - \\gamma)} = \\frac{2(1 - \\gamma) - (1 - 2\\gamma)}{2(1 - \\gamma)} = \\frac{2 - 2\\gamma - 1 + 2\\gamma}{2(1 - \\gamma)} = \\frac{1}{2(1 - \\gamma)}\n$$\n现在，该方法的所有系数都用单一参数 $\\gamma$ 表示。\n\n**3. 稳定性函数 $R(z)$ 的推导**\n\n将龙格-库塔方法应用于测试方程 $\\dot{y} = \\lambda y$ 时，其稳定性函数定义为 $R(z) = y_{n+1}/y_n$，其中 $z = h\\lambda$。对于隐式方法，它由公式 $R(z) = 1 + z b^{\\top} (I - z A)^{-1} \\mathbf{1}$ 给出。\n矩阵 $A$ 为 $A = \\begin{pmatrix} \\gamma  0 \\\\ 1 - \\gamma  \\gamma \\end{pmatrix}$。\n我们首先计算 $(I - zA)^{-1}$：\n$$\nI - zA = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} - z \\begin{pmatrix} \\gamma  0 \\\\ 1 - \\gamma  \\gamma \\end{pmatrix} = \\begin{pmatrix} 1 - z\\gamma  0 \\\\ -z(1 - \\gamma)  1 - z\\gamma \\end{pmatrix}\n$$\n其逆矩阵为：\n$$\n(I - zA)^{-1} = \\frac{1}{(1-z\\gamma)^2} \\begin{pmatrix} 1 - z\\gamma  0 \\\\ z(1 - \\gamma)  1 - z\\gamma \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{1-z\\gamma}  0 \\\\ \\frac{z(1 - \\gamma)}{(1-z\\gamma)^2}  \\frac{1}{1-z\\gamma} \\end{pmatrix}\n$$\n接下来，我们计算 $(I - zA)^{-1} \\mathbf{1}$：\n$$\n(I - zA)^{-1} \\mathbf{1} = \\begin{pmatrix} \\frac{1}{1-z\\gamma} \\\\ \\frac{z(1 - \\gamma)}{(1-z\\gamma)^2} + \\frac{1-z\\gamma}{(1-z\\gamma)^2} \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{1-z\\gamma} \\\\ \\frac{1+z-2z\\gamma}{(1-z\\gamma)^2} \\end{pmatrix}\n$$\n现在，我们左乘 $z b^{\\top}$：\n$$\nz b^{\\top} (I - zA)^{-1} \\mathbf{1} = z \\left( b_1 \\frac{1}{1-z\\gamma} + b_2 \\frac{1+z-2z\\gamma}{(1-z\\gamma)^2} \\right)\n$$\n代入 $b_1 = \\frac{1}{2(1-\\gamma)}$ 和 $b_2 = \\frac{1-2\\gamma}{2(1-\\gamma)}$：\n$$\n= \\frac{z}{2(1-\\gamma)} \\left( \\frac{1}{1-z\\gamma} + \\frac{(1-2\\gamma)(1+z-2z\\gamma)}{(1-z\\gamma)^2} \\right)\n$$\n$$\n= \\frac{z}{2(1-\\gamma)(1-z\\gamma)^2} \\left( (1-z\\gamma) + (1-2\\gamma)(1+z-2z\\gamma) \\right)\n$$\n展开括号中的项：\n$$\n(1-z\\gamma) + (1+z-2z\\gamma - 2\\gamma -2z\\gamma + 4z\\gamma^2) = 2 - 2\\gamma + z(1 - \\gamma - 2\\gamma -2\\gamma + 4\\gamma^2) = 2(1-\\gamma) + z(1-5\\gamma+4\\gamma^2)\n$$\n所以，我们有：\n$$\nz b^{\\top} (I - zA)^{-1} \\mathbf{1} = \\frac{z(2(1-\\gamma)) + z^2(1-5\\gamma+4\\gamma^2)}{2(1-\\gamma)(1-z\\gamma)^2}\n$$\n最后， $R(z) = 1 + z b^{\\top} (I - zA)^{-1} \\mathbf{1}$：\n$$\nR(z) = 1 + \\frac{z(2(1-\\gamma)) + z^2(1-5\\gamma+4\\gamma^2)}{2(1-\\gamma)(1-z\\gamma)^2} = \\frac{2(1-\\gamma)(1-z\\gamma)^2 + z(2(1-\\gamma)) + z^2(1-5\\gamma+4\\gamma^2)}{2(1-\\gamma)(1-z\\gamma)^2}\n$$\n分子是：\n$2(1-\\gamma)(1 - 2z\\gamma + z^2\\gamma^2) + 2z(1-\\gamma) + z^2(1-5\\gamma+4\\gamma^2)$\n$= [2(1-\\gamma)] + z[-4\\gamma(1-\\gamma) + 2(1-\\gamma)] + z^2[2\\gamma^2(1-\\gamma) + 1-5\\gamma+4\\gamma^2]$\n$= [2(1-\\gamma)] + z[2(1-\\gamma)(1-2\\gamma)] + z^2[2\\gamma^2-2\\gamma^3+1-5\\gamma+4\\gamma^2]$\n$= [2(1-\\gamma)] + z[2(1-\\gamma)(1-2\\gamma)] + z^2[1-5\\gamma+6\\gamma^2-2\\gamma^3]$\n$z^2$ 项中的多项式可以分解为：$1-5\\gamma+6\\gamma^2-2\\gamma^3 = (1-\\gamma)(1-4\\gamma+2\\gamma^2)$。\n所以分子是 $2(1-\\gamma) \\left[1 + z(1-2\\gamma) + z^2(\\frac{1-4\\gamma+2\\gamma^2}{2}) \\right]$。\n将此代回 $R(z)$：\n$$\nR(z) = \\frac{1 + z(1-2\\gamma) + z^2(\\frac{1}{2}-2\\gamma+\\gamma^2)}{ (1-z\\gamma)^2 }\n$$\n这就是作为 $z$ 和 $\\gamma$ 的有理函数的稳定性函数。\n\n**4. 施加 L-稳定性**\n\nL-稳定性是用于求解刚性方程的方法的一个理想特性，它能确保非常刚性的分量（对应于 $z=h\\lambda \\to -\\infty$）被强阻尼。它要求稳定性函数满足：\n$$\n\\lim_{z \\to -\\infty} R(z) = 0\n$$\n对于有理函数，此极限是分子和分母中 $z$ 最高次幂系数的比值。\n$$\nR(z) = \\frac{ z^2(\\frac{1}{2}-2\\gamma+\\gamma^2) + z(1-2\\gamma) + 1 }{ z^2(\\gamma^2) - 2z\\gamma + 1 }\n$$\n$$\n\\lim_{z \\to -\\infty} R(z) = \\frac{\\frac{1}{2}-2\\gamma+\\gamma^2}{\\gamma^2}\n$$\n为使此极限为零，分子必须为零：\n$$\n\\frac{1}{2}-2\\gamma+\\gamma^2 = 0\n$$\n乘以 2 得到所需的代数关系：\n$$\n2\\gamma^2 - 4\\gamma + 1 = 0\n$$\n\n在求解 $\\gamma$ 之前，我们简要评论一下自由参数。在施加 L-稳定性之前，$\\gamma$ 是一个自由参数。无穷远处的稳定性 $R_\\infty = \\lim_{z \\to -\\infty} R(z) = 1 - \\frac{2}{\\gamma} + \\frac{1}{2\\gamma^2}$ 控制着刚性系统中极快模态的阻尼。在计算材料科学中，可以调整 $\\gamma$ 来最小化 $|R_\\infty|$，以提供强（但不一定完全）阻尼，从而在稳定性与非刚性分量的精度等其他属性之间取得平衡。\n\n**5. 最优 $\\gamma$ 的确定**\n\n我们现在求解从 L-稳定性条件导出的二次方程，以找到区间 $(0,1)$ 内 $\\gamma$ 的唯一值。\n$$\n2\\gamma^2 - 4\\gamma + 1 = 0\n$$\n使用二次公式 $\\gamma = \\frac{-b \\pm \\sqrt{b^2-4ac}}{2a}$：\n$$\n\\gamma = \\frac{-(-4) \\pm \\sqrt{(-4)^2 - 4(2)(1)}}{2(2)} = \\frac{4 \\pm \\sqrt{16 - 8}}{4} = \\frac{4 \\pm 2\\sqrt{2}}{4}\n$$\n这给出了两个可能的解：\n$$\n\\gamma_1 = \\frac{4 + 2\\sqrt{2}}{4} = 1 + \\frac{\\sqrt{2}}{2} \\quad \\text{和} \\quad \\gamma_2 = \\frac{4 - 2\\sqrt{2}}{4} = 1 - \\frac{\\sqrt{2}}{2}\n$$\n我们对它们进行求值，以确定哪个位于指定的区间 $(0,1)$ 内。使用近似值 $\\sqrt{2} \\approx 1.414$：\n$$\n\\gamma_1 \\approx 1 + 0.707 = 1.707\n$$\n$$\n\\gamma_2 \\approx 1 - 0.707 = 0.293\n$$\n显然，$\\gamma_1 > 1$，因此它在区间之外。值 $\\gamma_2$ 在 $(0,1)$ 内。因此，满足所有要求的唯一 $\\gamma$ 值为 $1 - \\frac{\\sqrt{2}}{2}$。",
            "answer": "$$\n\\boxed{1 - \\frac{\\sqrt{2}}{2}}\n$$"
        }
    ]
}