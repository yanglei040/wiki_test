{
    "hands_on_practices": [
        {
            "introduction": "在进行分子动力学模拟时，正确设置模拟盒子是确保物理真实性的第一步。为了在有限的体系中模拟体相材料的行为，我们通常采用周期性边界条件（PBC）。此练习将指导您推导出一个基本但至关重要的几何约束——模拟盒子尺寸 $L$ 与相互作用截断半径 $r_c$ 之间的关系——以保证在使用最小镜像约定时，每个粒子不会与其自身的周期性镜像发生相互作用，从而避免非物理的赝象 。",
            "id": "3449022",
            "problem": "一个简单流体的三维分子动力学（MD）模拟在边长为 $L$ 的立方盒子中使用周期性边界条件（PBC）。原子间作用力是成对相加的、各向同性的，并通过一个明确的实空间截断半径 $r_{c}$ 进行截断，因此对势 $u(r)$ 在 $r \\ge r_{c}$ 时满足 $u(r)=0$。该模拟使用最小镜像约定：对于位于位置 $\\mathbf{r}_{i}$ 和 $\\mathbf{r}_{j}$ 的任意一对粒子，用于计算其相互作用的位移是晶格约化矢量 $\\Delta \\mathbf{r}_{ij}=\\mathbf{r}_{i}-\\mathbf{r}_{j}-L\\mathbf{n}$，其中 $\\mathbf{n}\\in\\mathbb{Z}^{3}$ 的选择应使得 $\\Delta \\mathbf{r}_{ij}$ 的每个笛卡尔分量都位于区间 $\\left(-\\frac{L}{2},\\frac{L}{2}\\right]$ 内。该模拟在构造上排除了自身对（没有 $i=j$ 项），但为了确保具有物理意义的生产采样，要求任何粒子不能与任何其他粒子的多个周期性镜像相互作用，特别是，任何粒子周围半径为 $r_{c}$ 的相互作用球不能包含该粒子自身的任何周期性镜像。\n\n仅从 PBC、最小镜像约定以及立方布拉菲晶格的几何定义出发，推导出一个关于 $r_{c}$ 的 $L$ 的严格阈值，该阈值保证了各向同性系统中上述的唯一性和无自相互作用。计算满足此要求的最小 $L$，并用 $r_{c}$ 解析地表示。以 $r_{c}$ 表示最小 $L$ 的单个精确表达式的形式提供最终答案。不要使用任何数值近似或四舍五入。",
            "solution": "该问题是有效的。它具有科学依据，问题明确且客观，提出了计算材料科学领域中一个标准的、基本的几何约束问题，特别是关于分子动力学模拟的设置。它没有任何说明中列出的导致问题无效的缺陷。因此，我们可以进行推导。\n\n该问题要求推导模拟盒子边长 $L$ 作为相互作用截断半径 $r_c$ 的函数的严格阈值，以满足在立方盒子中使用周期性边界条件（PBC）和最小镜像约定（MIC）的模拟的两个条件。我们来分析这两个条件。\n\n设模拟盒子是一个顶点位于 $(\\pm \\frac{L}{2}, \\pm \\frac{L}{2}, \\pm \\frac{L}{2})$ 的立方体。在 PBC 下，模拟空间是一个三维环面。位于位置 $\\mathbf{r}$ 的粒子在所有 $\\mathbf{r} + L\\mathbf{n}$ 位置都有周期性镜像，其中 $\\mathbf{n}$ 是一个整数分量矢量，$\\mathbf{n} \\in \\mathbb{Z}^3$。任意两个粒子 $i$ 和 $j$ 之间的相互作用仅在它们的间距 $r$ 小于 $r_c$ 时才非零。MIC 规定，这个距离是在粒子 $i$ 和粒子 $j$ 的单个、唯一的最近周期性镜像之间计算的。\n\n需要满足的两个条件是：\n1.  任何粒子不能与任何其他粒子的多个周期性镜像相互作用。\n2.  任何粒子周围半径为 $r_c$ 的相互作用球不包含该粒子自身的任何周期性镜像。\n\n让我们分析每个条件，以找出它对 $L$ 和 $r_c$ 施加的约束。\n\n**条件1的分析：相互作用伙伴的唯一性**\n\n对于短程力，MIC 是近似 Ewald 求和的一种计算捷径。为了使这种近似在一个具有简单球形截断的系统中物理上一致，一个粒子的相互作用球内不能包含任何其他粒子的多个周期性镜像。如果包含了多个，MIC 将任意选择较近的镜像，而忽略来自另一个镜像的能量贡献，从而导致不正确的力计算。\n\n让我们考虑一个位于位置 $\\mathbf{r}_i$ 的粒子 $i$ 和另一个位于位置 $\\mathbf{r}_j$ 的粒子 $j$。粒子 $j$ 的所有周期性镜像的集合位于位置 $\\{ \\mathbf{r}_j + L\\mathbf{n} \\mid \\mathbf{n} \\in \\mathbb{Z}^3 \\}$。\n我们考虑粒子 $j$ 的两个不同镜像，对应于两个不同的整数矢量 $\\mathbf{n}_1$ 和 $\\mathbf{n}_2$，其中 $\\mathbf{n}_1 \\neq \\mathbf{n}_2$。这两个镜像的位置是 $\\mathbf{p}_1 = \\mathbf{r}_j + L\\mathbf{n}_1$ 和 $\\mathbf{p}_2 = \\mathbf{r}_j + L\\mathbf{n}_2$。\n\n分隔这两个镜像的矢量是 $\\mathbf{p}_1 - \\mathbf{p}_2 = L(\\mathbf{n}_1 - \\mathbf{n}_2)$。令 $\\mathbf{m} = \\mathbf{n}_1 - \\mathbf{n}_2$。由于 $\\mathbf{n}_1$ 和 $\\mathbf{n}_2$ 是不同的整数矢量，$\\mathbf{m}$ 是一个非零整数矢量，即 $\\mathbf{m} \\in \\mathbb{Z}^3 \\setminus \\{\\mathbf{0}\\}$。\n\n这两个镜像之间的距离是 $\\|\\mathbf{p}_1 - \\mathbf{p}_2\\| = \\|L\\mathbf{m}\\| = L\\|\\mathbf{m}\\|$。为了找到一个粒子的任意两个不同镜像之间的最小距离，我们需要找到一个非零整数矢量 $\\mathbf{m}=(m_x, m_y, m_z)$ 的最小模长。模长的平方是 $\\|\\mathbf{m}\\|^2 = m_x^2 + m_y^2 + m_z^2$。由于 $m_x, m_y, m_z$ 是整数且不全为零，这个和的最小可能值是 $1$（例如，对于 $\\mathbf{m}=(1,0,0)$）。\n因此，最小模长是 $\\|\\mathbf{m}\\|_{min} = 1$。\n\n因此，粒子 $j$ 的任意两个不同周期性镜像之间的最小距离是 $L \\times \\|\\mathbf{m}\\|_{min} = L$。\n\n要使粒子 $i$ 可能与这两个镜像 $\\mathbf{p}_1$ 和 $\\mathbf{p}_2$ 都发生相互作用，它们必须都位于其半径为 $r_c$ 的相互作用球内。一个半径为 $r_c$ 的球体只有当两点之间的距离小于或等于其直径 $2r_c$ 时，才能同时包含这两点。\n为了保证粒子 $i$ 的相互作用球内永远不会有多于一个粒子 $j$ 的镜像，我们必须确保 $j$ 的任意两个镜像之间的最小距离大于相互作用球的直径。当距离相等时，达到严格阈值。\n因此，我们必须施加条件：\n$$L \\ge 2r_c$$\n\n**条件2的分析：无自相互作用**\n\n该条件规定，一个粒子不能与其自身的任何周期性镜像相互作用。\n设粒子 $i$ 位于位置 $\\mathbf{r}_i$。其自身的周期性镜像位于所有 $\\mathbf{r}_i + L\\mathbf{n}$ 位置，其中 $\\mathbf{n}$ 是所有非零整数矢量，即 $\\mathbf{n} \\in \\mathbb{Z}^3 \\setminus \\{\\mathbf{0}\\}$。\n粒子 $i$ 与其自身的一个镜像之间的距离是 $\\|\\mathbf{r}_i - (\\mathbf{r}_i + L\\mathbf{n})\\| = \\|-L\\mathbf{n}\\| = L\\|\\mathbf{n}\\|$。\n\n粒子 $i$ 的最近周期性镜像对应于 $\\|\\mathbf{n}\\|$ 的最小值，条件是 $\\mathbf{n} \\neq \\mathbf{0}$。如前所述，最小模长是 $\\|\\mathbf{n}\\|_{min} = 1$。\n因此，一个粒子到其最近的自身镜像的距离恰好是 $L$。\n\n粒子 $i$ 周围的相互作用球半径为 $r_c$。为使该球不包含任何粒子自身的镜像，其半径必须小于或等于到最近镜像的距离。\n这给出了条件：\n$$r_c \\le L$$\n或者等价地，\n$$L \\ge r_c$$\n\n**条件整合**\n\n我们推导出了两个必要条件：\n1. 从相互作用伙伴的唯一性得出：$L \\ge 2r_c$\n2. 从无自身镜像相互作用得出：$L \\ge r_c$\n\n对于任何具有物理意义的相互作用，截断半径 $r_c$ 必须为正。因此，第一个条件 $L \\ge 2r_c$ 比第二个条件 $L \\ge r_c$ 更为严格。如果第一个条件满足，第二个条件也自动满足。因此，确保两个条件都满足的主导约束是 $L \\ge 2r_c$。\n\n问题要求满足此要求的最小 $L$。$L$ 的最小值在等号成立时获得，这代表了严格阈值。\n$$L_{min} = 2r_c$$\n这是立方体系中众所周知的半盒子判据，它确保了在使用球形截断时最小镜像约定的完整性。",
            "answer": "$$ \\boxed{L_{min} = 2r_c} $$"
        },
        {
            "introduction": "在昂贵的“生产”取样阶段开始之前，验证系统是否已达到平衡并且数值积分方案是否稳定至关重要。此练习探讨了一种强大的诊断技术，即通过在微正则系综（NVE）中监测总能量漂移来评估平衡的充分性 。您将推导能量漂移率如何随积分时间步长 $\\Delta t$ 变化，并学习如何利用这种关系来区分数值积分误差和未完全平衡导致的物理弛豫，最终为生产运行确定一个合适的 $\\Delta t$。",
            "id": "3449055",
            "problem": "考虑一个用经典分子动力学 (MD) 模拟的大型晶体固体，该模拟在微正则系综（也称为粒子数、体积和能量恒定 (NVE) 系综）下进行。哈密顿量为 $H(q,p) = T(p) + U(q)$，其中 $q$ 和 $p$ 分别是位置和动量，$T(p) = \\sum_{i} \\frac{p_{i}^{2}}{2 m_{i}}$ 是动能，$U(q)$ 是势能。数值积分使用速度 Verlet 算法，时间步长为 $\\Delta t$。在进行生产取样之前，系统在恒温器下进行了平衡，然后移除恒温器以进行 NVE 运行。为了评估先前的平衡是否充分，并选择一个能在 NVE 生产运行中实现可接受的能量守恒的时间步长，您在不同的 $\\Delta t$ 值下进行了两次简短的引导性 NVE 运行，并测量了瞬时总能量 $E(t)$ 随时间 $t$ 的变化。在每次引导性运行中，对 $E(t)$ 进行线性拟合，得到能量漂移率 $s = dE/dt$，假定其在短时间内为常数。测量结果如下：\n- $\\Delta t_{1} = 1.0$ 飞秒， $s_{1} = 0.005$ 千焦耳/摩尔/皮秒，\n- $\\Delta t_{2} = 2.0$ 飞秒， $s_{2} = 0.020$ 千焦耳/摩尔/皮秒。\n\n从 $H(q,p)$ 的哈密顿方程和速度 Verlet 更新的定义出发，推导对于时间可逆的辛积分器，能量漂移率 $s$ 相对于时间步长 $\\Delta t$ 的主导阶标度关系，并解释如何利用该标度关系来诊断能量漂移是源于数值积分误差还是由于先前平衡不充分导致的残余物理弛豫。然后，假设测量结果与推导出的主导阶标度关系一致，确定关联 $s$ 和 $\\Delta t$ 的比例系数。最后，生产标准是在持续时间为 $T_{\\mathrm{prod}} = 1.0$ 纳秒的生产轨迹上，相对能量漂移必须小于 $r_{\\mathrm{thr}} = 1.0 \\times 10^{-3}$。生产运行开始时系统的初始总能量大小为 $E_{0} = 5.0 \\times 10^{3}$ 千焦耳/摩尔。使用推导的关系，计算满足生产标准的最大允许时间步长 $\\Delta t_{\\max}$。将最终的 $\\Delta t_{\\max}$ 以飞秒为单位表示，并将您的数值答案四舍五入到三位有效数字。",
            "solution": "问题陈述经评估有效。它在科学上基于计算材料科学的原理，特别是经典分子动力学 (MD) 模拟。问题设定良好、客观且内部一致，为进行唯一且有意义的求解提供了所有必要数据。给出的物理量和模拟参数值是符合实际的。\n\n该问题需要进行四部分分析：(1) 推导能量漂移与积分时间步长的标度关系，(2) 解释该标度关系如何区分数值误差和物理弛豫，(3) 根据所提供的数据确定比例常数，以及 (4) 基于给定的稳定性标准计算生产运行的最大允许时间步长。\n\n首先，我们分析 NVE 模拟中能量漂移的来源。在一个完美的解析世界中，Hamilton 的运动方程精确地守恒总能量 $H(q,p)$。哈密顿量的时间导数为：\n$$\n\\frac{dH}{dt} = \\sum_i \\left( \\frac{\\partial H}{\\partial q_i} \\dot{q}_i + \\frac{\\partial H}{\\partial p_i} \\dot{p}_i \\right)\n$$\n使用 Hamilton 方程 $\\dot{q}_i = \\frac{\\partial H}{\\partial p_i}$ 和 $\\dot{p}_i = -\\frac{\\partial H}{\\partial q_i}$，上式变为：\n$$\n\\frac{dH}{dt} = \\sum_i \\left( (-\\dot{p}_i) \\dot{q}_i + (\\dot{q}_i) \\dot{p}_i \\right) = 0\n$$\n像速度 Verlet 算法这样的数值积分器会引入离散化误差。辛积分器（如速度 Verlet）的一个关键特征是，它们并不精确守恒真实的哈密顿量 $H$。相反，它们精确守恒一个与 $H$ 相近的修正哈密顿量或称“影子”哈密顿量 $\\tilde{H}$。对于一个对称的二阶积分器，影子哈密顿量可以表示为时间步长 $\\Delta t$ 的偶次幂级数：\n$$\n\\tilde{H}(q,p) = H(q,p) + H_2(q,p)(\\Delta t)^2 + H_4(q,p)(\\Delta t)^4 + \\mathcal{O}((\\Delta t)^6)\n$$\n系统的能量 $E(t)=H(q(t),p(t))$ 是沿着由积分器生成的轨迹计算的，因此会发生涨落。守恒值 $\\tilde{H}$ 与轨迹上 $H$ 的平均值之差的标度关系为 $(\\Delta t)^2$。尽管理想情况下能量应该只在一个恒定值附近有界振荡，但在实践中，诸如有限浮点精度以及更重要的局部截断误差的累积等因素，可能导致长期的系统性漂移。对于二阶积分器，能量的局部误差（每步）为 $\\mathcal{O}((\\Delta t)^3)$ 阶。在总模拟时间 $T_{\\text{sim}} = N \\Delta t$ 内，全局误差会累积，从而导致漂移。这种数值能量漂移的速率 $s_{\\text{num}} = dE/dt$ 预计与积分器的主导误差项成标度关系。对于像速度 Verlet 这样的二阶方案，该漂移率与时间步长呈二次方标度关系：\n$$\ns_{\\text{num}} \\propto (\\Delta t)^2\n$$\n这可以写成 $s_{\\text{num}} = k (\\Delta t)^2$，其中 $k$ 是一个比例常数，取决于系统的性质（例如，原子振动频率、势能面）。\n\n这种标度行为是一个强大的诊断工具。观测到的能量漂移 $s$ 可能有两个主要组成部分：数值漂移 $s_{\\text{num}}$ 和由不完全平衡引起的物理漂移 $s_{\\text{phys}}$。如果系统在 NVE 生产运行开始时尚未处于热平衡状态，它将继续向平衡态弛豫。这种物理弛豫（例如，结构重排、子系统间的温度重新分布）是一个不可逆过程，其速率 $s_{\\text{phys}}$ 是系统当前状态的內禀属性，应独立于数值时间步长 $\\Delta t$。因此，总的观测漂移为：\n$$\ns(\\Delta t) = s_{\\text{phys}} + s_{\\text{num}} = s_{\\text{phys}} + k (\\Delta t)^2\n$$\n通过在两个或更多不同的时间步长 $\\Delta t$ 下测量漂移率 $s$，可以区分这两种贡献。如果 $s$ 对 $(\\Delta t)^2$ 的图是一条具有非零 y 轴截距的直线，则截距的值对应于 $s_{\\text{phys}}$，表明平衡不充分。如果截距为零（在统计误差范围内），则 $s_{\\text{phys}} \\approx 0$，这表明系统已充分平衡，观测到的漂移纯粹是数值误差造成的。\n\n问题提供了两组测量数据：\n1. $\\Delta t_{1} = 1.0 \\text{ fs}$，$s_{1} = 0.005 \\text{ kJ mol}^{-1} \\text{ps}^{-1}$\n2. $\\Delta t_{2} = 2.0 \\text{ fs}$，$s_{2} = 0.020 \\text{ kJ mol}^{-1} \\text{ps}^{-1}$\n\n我们检查漂移率之比与时间步长平方之比：\n$$\n\\frac{s_2}{s_1} = \\frac{0.020}{0.005} = 4\n$$\n$$\n\\left(\\frac{\\Delta t_2}{\\Delta t_1}\\right)^2 = \\left(\\frac{2.0}{1.0}\\right)^2 = 4\n$$\n由于 $\\frac{s_2}{s_1} = \\left(\\frac{\\Delta t_2}{\\Delta t_1}\\right)^2$，这证实了观测到的漂移与主导阶数值误差标度关系 $s = k (\\Delta t)^2$ 一致，因此我们可以得出结论，物理弛豫分量可以忽略不计，$s_{\\text{phys}} \\approx 0$。先前的平衡是充分的。\n\n现在我们确定比例系数 $k$。使用第一组数据点：\n$$\nk = \\frac{s_1}{(\\Delta t_1)^2} = \\frac{0.005 \\text{ kJ mol}^{-1} \\text{ps}^{-1}}{(1.0 \\text{ fs})^2} = 0.005 \\text{ kJ mol}^{-1} \\text{ps}^{-1} \\text{fs}^{-2}\n$$\n$k$ 的单位正确地反映了这种关系。\n\n最后，我们计算满足生产标准的最大允许时间步长 $\\Delta t_{\\max}$。该标准规定，在持续时间为 $T_{\\mathrm{prod}}$ 的生产运行中，相对能量漂移必须小于阈值 $r_{\\mathrm{thr}}$。总能量变化为 $\\Delta E_{\\mathrm{prod}} = s \\cdot T_{\\mathrm{prod}}$。该标准为：\n$$\n\\frac{|\\Delta E_{\\mathrm{prod}}|}{|E_0|} \\le r_{\\mathrm{thr}}\n$$\n代入 $\\Delta E_{\\mathrm{prod}} = k (\\Delta t)^2 T_{\\mathrm{prod}}$ 并在条件的边界处求解最大时间步长 $\\Delta t_{\\max}$：\n$$\n\\frac{k (\\Delta t_{\\max})^2 T_{\\mathrm{prod}}}{E_0} = r_{\\mathrm{thr}}\n$$\n$$\n\\Delta t_{\\max} = \\sqrt{\\frac{r_{\\mathrm{thr}} E_0}{k T_{\\mathrm{prod}}}}\n$$\n给定的值为：\n- $r_{\\mathrm{thr}} = 1.0 \\times 10^{-3}$\n- $E_{0} = 5.0 \\times 10^{3} \\text{ kJ mol}^{-1}$\n- $T_{\\mathrm{prod}} = 1.0 \\text{ ns} = 1.0 \\times 10^3 \\text{ ps}$\n- $k = 0.005 \\text{ kJ mol}^{-1} \\text{ps}^{-1} \\text{fs}^{-2}$\n\n我们将这些值代入 $\\Delta t_{\\max}$ 的方程中：\n$$\n\\Delta t_{\\max} = \\sqrt{\\frac{(1.0 \\times 10^{-3}) \\cdot (5.0 \\times 10^{3} \\text{ kJ mol}^{-1})}{(0.005 \\text{ kJ mol}^{-1} \\text{ps}^{-1} \\text{fs}^{-2}) \\cdot (1.0 \\times 10^3 \\text{ ps})}}\n$$\n$$\n\\Delta t_{\\max} = \\sqrt{\\frac{5.0 \\text{ kJ mol}^{-1}}{5.0 \\text{ kJ mol}^{-1} \\text{fs}^{-2}}} = \\sqrt{1.0 \\text{ fs}^2} = 1.0 \\text{ fs}\n$$\n问题要求答案四舍五入到三位有效数字。因此，最大允许时间步长为 $1.00 \\text{ fs}$。",
            "answer": "$$\n\\boxed{1.00}\n$$"
        },
        {
            "introduction": "为了计算效率，分子模拟几乎总是使用截断的相互作用势，但这会给热力学性质（如压力）的计算带来系统误差。此练习将引导您从统计力学的基本原理出发，推导用于校正这种截断效应的压力的长程校正（LRC）项 。掌握这一推导，对于从使用截断势的模拟中获得与全势（未截断）系统相当的精确物理量至关重要。",
            "id": "3449061",
            "problem": "采用分子动力学（MD）方法，使用在有限截断半径处截断并移位的 Lennard-Jones (LJ) 对势，模拟了一个均匀的单组分流体。Lennard-Jones 势由 $u_{\\mathrm{LJ}}(r) = 4 \\varepsilon \\left[\\left(\\frac{\\sigma}{r}\\right)^{12} - \\left(\\frac{\\sigma}{r}\\right)^{6}\\right]$ 给出，而在模拟中应用的截断移位势为\n$$\nu_{\\mathrm{TS}}(r) = \n\\begin{cases}\nu_{\\mathrm{LJ}}(r) - u_{\\mathrm{LJ}}(r_{c}),  r  r_{c} \\\\\n0,  r \\ge r_{c}\n\\end{cases}\n$$\n经过充分的平衡后，进行生产采样，利用来自 $u_{\\mathrm{TS}}(r)$ 的力计算平均压力。为了估计对应于完整（未截断）LJ 流体的热力学压力，在标准假设下（即对分布函数在截断半径之外是均匀的，即对于 $r \\ge r_{c}$ 有 $g(r) = 1$）添加了长程校正。\n\n从具有对相互作用的均匀、各向同性系统的压力的力学定义出发，并仅以基本统计力学关系为基础，推导必须加到用 $u_{\\mathrm{TS}}(r)$ 测量的压力上的长程校正项 $\\Delta P_{\\mathrm{LRC}}$ 的解析表达式，该表达式用数密度 $\\rho$、Lennard-Jones 参数 $\\varepsilon$ 和 $\\sigma$、截断半径 $r_{c}$ 以及普适常数来表示。假设系统足够大，以至于表面效应可以忽略不计，并且在 $r_{c}$ 之外均匀性假设 $g(r)=1$ 成立。\n\n将您的最终答案表示为仅包含 $\\rho$、$\\varepsilon$、$\\sigma$ 和 $r_{c}$ 的单个封闭形式表达式。压力的单位是 $\\varepsilon/\\sigma^{3}$（即与 $\\varepsilon$ 和 $\\sigma$ 一致的能量/体积单位）。不要在最终的方框表达式中代入数字或附加单位。",
            "solution": "问题陈述被评估为有效。它在科学上基于统计力学和计算物理学的原理，问题提出得很好，提供了所有必要的信息，并且表达客观。任务是推导一个标准公式，这是一个不平凡但定义明确的练习。\n\n一个包含 $N$ 个粒子、体积为 $V$、通过对势 $u(r)$ 相互作用的均匀、各向同性系统的压力 $P$ 由维里状态方程给出：\n$$ P = \\rho k_{B} T + P_{\\mathrm{conf}} $$\n其中 $\\rho = N/V$ 是数密度，$k_B$ 是玻尔兹曼常数，$T$ 是绝对温度，$P_{\\mathrm{conf}}$ 是对压力的构型贡献。构型压力通过维里与分子间力相关。对于具有对相互作用的系统，它由下式给出：\n$$ P_{\\mathrm{conf}} = -\\frac{2\\pi\\rho^2}{3} \\int_{0}^{\\infty} r^3 \\frac{du(r)}{dr} g(r) dr $$\n这里，$g(r)$ 是径向分布函数，它描述了流体的局部结构。\n\n由完整 Lennard-Jones 势 $u_{\\mathrm{LJ}}(r)$ 描述的“真实”流体的总压力为：\n$$ P_{\\mathrm{full}} = \\rho k_{B} T -\\frac{2\\pi\\rho^2}{3} \\int_{0}^{\\infty} r^3 \\frac{du_{\\mathrm{LJ}}(r)}{dr} g_{\\mathrm{full}}(r) dr $$\n其中 $g_{\\mathrm{full}}(r)$ 是对应于完整 $u_{\\mathrm{LJ}}(r)$ 势的径向分布函数。\n\n在分子动力学模拟中，使用截断移位势 $u_{\\mathrm{TS}}(r)$。压力由该势导出的力计算。对于 $r  r_c$，$u_{\\mathrm{TS}}(r) = u_{\\mathrm{LJ}}(r) - u_{\\mathrm{LJ}}(r_c)$。力是势的负梯度，$f_{\\mathrm{TS}}(r) = -du_{\\mathrm{TS}}(r)/dr$。由于 $u_{\\mathrm{LJ}}(r_c)$ 是一个常数，其导数为零。因此，对于 $r  r_c$，力为 $f_{\\mathrm{TS}}(r) = -du_{\\mathrm{LJ}}(r)/dr$。对于 $r \\ge r_c$，势为零，因此力也为零。因此，在模拟中测得的压力 $P_{\\mathrm{TS}}$ 为：\n$$ P_{\\mathrm{TS}} = \\rho k_{B} T -\\frac{2\\pi\\rho^2}{3} \\int_{0}^{r_c} r^3 \\frac{du_{\\mathrm{LJ}}(r)}{dr} g_{\\mathrm{TS}}(r) dr $$\n其中 $g_{\\mathrm{TS}}(r)$ 是使用 $u_{\\mathrm{TS}}(r)$ 势的模拟所生成的径向分布函数。\n\n长程校正 $\\Delta P_{\\mathrm{LRC}}$ 是必须加到模拟压力 $P_{\\mathrm{TS}}$ 上以估计真实压力 $P_{\\mathrm{full}}$ 的量。\n$$ \\Delta P_{\\mathrm{LRC}} = P_{\\mathrm{full}} - P_{\\mathrm{TS}} $$\n动能项 $\\rho k_B T$ 被抵消，只剩下构型压力的差值：\n$$ \\Delta P_{\\mathrm{LRC}} = -\\frac{2\\pi\\rho^2}{3} \\left[ \\int_{0}^{\\infty} r^3 \\frac{du_{\\mathrm{LJ}}}{dr} g_{\\mathrm{full}}(r) dr - \\int_{0}^{r_c} r^3 \\frac{du_{\\mathrm{LJ}}}{dr} g_{\\mathrm{TS}}(r) dr \\right] $$\n为继续推导，我们做两个标准近似。首先，假设在短程范围内，流体的结构不受势截断的影响，因此对于 $r  r_c$，$g_{\\mathrm{TS}}(r) \\approx g_{\\mathrm{full}}(r)$。其次，对于超出截断半径的距离，假设流体是无结构的，即径向分布函数为1：对于 $r \\ge r_c$，$g_{\\mathrm{full}}(r) = 1$。\n\n应用这些近似，我们可以将第一个积分拆分为：\n$$ \\int_{0}^{\\infty} r^3 \\frac{du_{\\mathrm{LJ}}}{dr} g_{\\mathrm{full}}(r) dr = \\int_{0}^{r_c} r^3 \\frac{du_{\\mathrm{LJ}}}{dr} g_{\\mathrm{full}}(r) dr + \\int_{r_c}^{\\infty} r^3 \\frac{du_{\\mathrm{LJ}}}{dr} g_{\\mathrm{full}}(r) dr $$\n$$ \\approx \\int_{0}^{r_c} r^3 \\frac{du_{\\mathrm{LJ}}}{dr} g_{\\mathrm{TS}}(r) dr + \\int_{r_c}^{\\infty} r^3 \\frac{du_{\\mathrm{LJ}}}{dr} (1) dr $$\n将此代回 $\\Delta P_{\\mathrm{LRC}}$ 的表达式中：\n$$ \\Delta P_{\\mathrm{LRC}} \\approx -\\frac{2\\pi\\rho^2}{3} \\left[ \\left( \\int_{0}^{r_c} \\dots g_{\\mathrm{TS}}(r) dr + \\int_{r_c}^{\\infty} \\dots (1) dr \\right) - \\int_{0}^{r_c} \\dots g_{\\mathrm{TS}}(r) dr \\right] $$\n从 $0$ 到 $r_c$ 的积分相互抵消，只留下势的尾部贡献：\n$$ \\Delta P_{\\mathrm{LRC}} = -\\frac{2\\pi\\rho^2}{3} \\int_{r_c}^{\\infty} r^3 \\frac{du_{\\mathrm{LJ}}(r)}{dr} dr $$\n现在，我们必须计算这个积分。Lennard-Jones 势为：\n$$ u_{\\mathrm{LJ}}(r) = 4 \\varepsilon \\left[ \\left(\\frac{\\sigma}{r}\\right)^{12} - \\left(\\frac{\\sigma}{r}\\right)^{6} \\right] = 4\\varepsilon(\\sigma^{12}r^{-12} - \\sigma^{6}r^{-6}) $$\n它对 $r$ 的导数是：\n$$ \\frac{du_{\\mathrm{LJ}}(r)}{dr} = 4\\varepsilon(-12\\sigma^{12}r^{-13} + 6\\sigma^{6}r^{-7}) $$\n乘以 $r^3$：\n$$ r^3 \\frac{du_{\\mathrm{LJ}}(r)}{dr} = 4\\varepsilon(-12\\sigma^{12}r^{-10} + 6\\sigma^{6}r^{-4}) $$\n现在我们进行定积分：\n$$ \\int_{r_c}^{\\infty} r^3 \\frac{du_{\\mathrm{LJ}}(r)}{dr} dr = 4\\varepsilon \\int_{r_c}^{\\infty} (-12\\sigma^{12}r^{-10} + 6\\sigma^{6}r^{-4}) dr $$\n$$ = 4\\varepsilon \\left[ -12\\sigma^{12}\\frac{r^{-9}}{-9} + 6\\sigma^{6}\\frac{r^{-3}}{-3} \\right]_{r_c}^{\\infty} $$\n$$ = 4\\varepsilon \\left[ \\frac{4}{3}\\sigma^{12}r^{-9} - 2\\sigma^{6}r^{-3} \\right]_{r_c}^{\\infty} $$\n计算在积分上下限处的值：\n$$ = 4\\varepsilon \\left[ \\lim_{r\\to\\infty} \\left(\\frac{4}{3}\\frac{\\sigma^{12}}{r^9} - 2\\frac{\\sigma^6}{r^3}\\right) - \\left(\\frac{4}{3}\\frac{\\sigma^{12}}{r_c^9} - 2\\frac{\\sigma^6}{r_c^3}\\right) \\right] $$\n$$ = 4\\varepsilon \\left[ (0 - 0) - \\left(\\frac{4}{3}\\frac{\\sigma^{12}}{r_c^9} - 2\\frac{\\sigma^6}{r_c^3}\\right) \\right] = -4\\varepsilon \\left(\\frac{4}{3}\\frac{\\sigma^{12}}{r_c^9} - 2\\frac{\\sigma^6}{r_c^3}\\right) $$\n将此结果代回 $\\Delta P_{\\mathrm{LRC}}$ 的表达式中：\n$$ \\Delta P_{\\mathrm{LRC}} = -\\frac{2\\pi\\rho^2}{3} \\left[ -4\\varepsilon \\left(\\frac{4}{3}\\frac{\\sigma^{12}}{r_c^9} - 2\\frac{\\sigma^6}{r_c^3}\\right) \\right] $$\n$$ \\Delta P_{\\mathrm{LRC}} = \\frac{8\\pi\\rho^2\\varepsilon}{3} \\left(\\frac{4}{3}\\frac{\\sigma^{12}}{r_c^9} - 2\\frac{\\sigma^6}{r_c^3}\\right) $$\n从括号中提出因子 2，得到一个更紧凑的形式：\n$$ \\Delta P_{\\mathrm{LRC}} = \\frac{16\\pi\\rho^2\\varepsilon}{3} \\left(\\frac{2}{3}\\frac{\\sigma^{12}}{r_c^9} - \\frac{\\sigma^6}{r_c^3}\\right) $$\n这就是压力长程校正的最终解析表达式。",
            "answer": "$$\n\\boxed{\\frac{16\\pi\\rho^2\\varepsilon}{3} \\left( \\frac{2}{3}\\frac{\\sigma^{12}}{r_c^9} - \\frac{\\sigma^6}{r_c^3} \\right)}\n$$"
        }
    ]
}