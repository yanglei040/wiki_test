{
    "hands_on_practices": [
        {
            "introduction": "每次模拟都依赖于随机数生成器。但这些生成器是如何工作的？又是什么限制了它们的精度？第一个练习将带我们深入了解一个经典伪随机数生成器——线性同余生成器 (LCG) 的内部机制。通过为一个特定的比特宽度设计一个LCG，你将探索生成器的数学构造（特别是其模数$m$）与其产生的随机数最终分辨率之间的根本联系。这个练习对于理解科学计算中使用的随机变量的内在离散性和局限性至关重要。",
            "id": "3484313",
            "problem": "一个用于面心立方金属中空位介导扩散的计算材料学代码使用线性同余生成器 (LCG) 为动力学蒙特卡洛 (KMC) 事件选择器和分子动力学 (MD) 恒温器提供独立的均匀伪随机变量。为了在不同编译器和架构之间实现可移植性和按位可复现性，该生成器被限制为 $48$ 位模数。返回给模拟的均匀变量由 $U_n = x_n / m$ 定义，其中 $x_n$ 是 LCG 的内部整数状态，$m$ 是模数。\n\n请设计一个模数 $m$ 对应于 $48$ 位状态空间的 LCG，通过适当选择与此位宽和完整周期要求一致的整数 $a$、$c$ 和 $m$，使其对所有种子 $x_0 \\in \\{0,1,\\dots,m-1\\}$ 都达到完整周期。然后，从第一性原理推导出此生成器产生的双精度均匀变量 $U_n$ 的内在分辨率（不同值之间的最小非零间距）。\n\n请提供分辨率的精确解析表达式作为最终答案（无单位，不四舍五入）。",
            "solution": "该问题要求设计一个具有完整周期的线性同余生成器 (LCG)，并随后确定其输出的分辨率。LCG 由以下递推关系定义：\n$$x_{n+1} = (a x_n + c) \\pmod m$$\n其中 $a$ 是乘数，$c$ 是增量，$m$ 是模数。均匀伪随机变量 $U_n$ 是通过对整数状态 $x_n$ 进行归一化生成的：\n$$U_n = \\frac{x_n}{m}$$\n\n首先，我们必须确定 LCG 的参数，特别是模数 $m$。问题指出，为了可移植性和可复现性，生成器被限制在 $48$ 位的状态空间内。这意味着唯一整数状态的数量是 $2^{48}$。因此，模数 $m$ 选择为 $m = 2^{48}$。\n\n接下来，我们必须确保 LCG 达到完整周期。LCG 的完整周期意味着对于任何初始种子 $x_0 \\in \\{0, 1, \\dots, m-1\\}$，状态序列 $x_n$ 将在该集合中的每个整数上恰好访问一次后才会重复。因此，这个周期的长度等于模数 $m$。LCG 具有完整周期的条件由 Hull-Dobell 定理给出。对于一般的 LCG，这些条件是：\n1. 增量 $c$ 和模数 $m$ 必须互质，即 $\\gcd(c, m) = 1$。\n2. $a-1$ 必须能被 $m$ 的每个素因子整除。\n3. 如果 $m$ 是 $4$ 的倍数，那么 $a-1$ 也必须是 $4$ 的倍数。\n\n我们将这些条件应用于我们的特定情况，其中模数 $m = 2^{48}$。\n$m = 2^{48}$ 的唯一素因子是 $2$。\n我们来分析每个条件：\n1. $\\gcd(c, 2^{48}) = 1$。此条件当且仅当 $c$ 不能被 $2$ 整除时才满足，这意味着 $c$ 必须是一个奇数。\n2. $a-1$ 必须能被素因子 $2$ 整除。这意味着 $a-1$ 必须是一个偶数，这又意味着乘数 $a$ 必须是一个奇数。\n3. 模数 $m = 2^{48}$ 是 $4$ 的倍数，因为 $48 \\ge 2$。因此，$a-1$ 必须能被 $4$ 整除。这可以表示为 $a-1 \\equiv 0 \\pmod 4$，或者更简单地，$a \\equiv 1 \\pmod 4$。\n\n第三个条件 $a \\equiv 1 \\pmod 4$ 意味着 $a-1$ 是 $4$ 的倍数，这保证了它也是 $2$ 的倍数。因此，如果第三个条件满足，则第二个条件自动满足。设计一个具有 $m=2^{48}$ 的完整周期 LCG 的全部要求是：\n- $m = 2^{48}$\n- $a \\equiv 1 \\pmod 4$\n- $c$ 是一个奇数。\n\n满足这些条件的选项有很多，例如，标准 `drand48` 库函数中使用的参数：$m=2^{48}$，$a = 25214903917$ 和 $c = 11$。这里，$a \\pmod 4 = 1$ 且 $c$ 是奇数。存在这样的参数证实了该设计的有效性。\n\n具有完整周期的关键推论是，在一个完整周期内生成的整数状态集 $\\{x_n\\}$ 是从 $0$ 到 $m-1$ 的所有可能整数集合的一个排列。也就是说，$x_n$ 可以取的所有不同值的集合恰好是：\n$$ \\{0, 1, 2, \\dots, m-1\\} $$\n\n均匀变量 $U_n$ 是通过将这些整数状态除以模数 $m$ 得到的。因此，$U_n$ 的所有可能不同值的集合是：\n$$ \\left\\{ \\frac{0}{m}, \\frac{1}{m}, \\frac{2}{m}, \\dots, \\frac{m-1}{m} \\right\\} $$\n这些值是离散且均匀分布的。变量的“双精度”特性指的是它们在内存中的浮点表示，对于 IEEE $754$ 标准，这提供了一个 $52$ 位的有效数位。这足以精确表示 $2^{48}$ 个不同的值 $k/2^{48}$ 中的每一个，因此在此步骤中没有精度损失。\n\n生成器的分辨率定义为 $U_n$ 不同值之间的最小非零间距。通过检查可能值的集合，我们可以通过计算任意两个相邻值（例如 $\\frac{k+1}{m}$ 和 $\\frac{k}{m}$）之间的差来找到这个间距：\n$$ \\Delta U = \\frac{k+1}{m} - \\frac{k}{m} = \\frac{1}{m} $$\n对于所有相邻对，这个间距是相同的，并代表了生成器产生的任意两个不同值之间的最小可能非零差值。\n\n代入模数 $m = 2^{48}$ 的值，我们得到分辨率：\n$$ \\text{分辨率} = \\frac{1}{2^{48}} = 2^{-48} $$\n这个值仅由完整周期 LCG 的模数决定。",
            "answer": "$$ \\boxed{2^{-48}} $$"
        },
        {
            "introduction": "模拟中的随机数不仅仅是抽象的数值，它们常常代表着像热噪声这样的物理现象。我们如何确保我们的实现能够正确地捕捉物理规律？这个练习将随机数生成的抽象世界与分子动力学的具体物理过程联系起来。你将从第一性原理出发，推导朗之万动力学中的核心要素——连续时间随机力，是如何转化为数值积分器中的离散随机变量的。这个练习揭示了为何恒温器中使用的随机数的方差不是任意的，而是由物理温度$T$、摩擦系数$\\gamma$和模拟时间步长$\\Delta t$精确决定的。",
            "id": "3484301",
            "problem": "在朗之万分子动力学中，对于一个质量为 $m$ 的原子的单个笛卡尔自由度，在温度 $T$ 和线性摩擦系数 $\\gamma$ 下的恒温控制是通过涨落-耗散定理来建模的。设随机力 $\\eta(t)$ 是一个平稳的零均值高斯白噪声，满足\n$$\n\\langle \\eta(t) \\rangle = 0, \\qquad \\langle \\eta(t)\\,\\eta(t') \\rangle = 2\\,\\gamma\\,k_{B}\\,T\\,\\delta(t-t'),\n$$\n其中 $k_{B}$ 是玻尔兹曼常数，$\\delta(\\cdot)$ 是狄拉克δ分布。考虑一个时间离散积分器，它在每个宽度为 $\\Delta t0$ 的时间步长（从 $t_{n}$ 到 $t_{n+1}=t_{n}+\\Delta t$）内，通过一个等于 $\\eta(t)$ 在该区间上的时间平均值的常数来近似随机力，\n$$\n\\eta_{n} \\equiv \\frac{1}{\\Delta t}\\int_{t_{n}}^{t_{n+1}} \\eta(t)\\,dt.\n$$\n根据以上定义以及高斯过程和狄拉克δ分布的标准性质，完成以下任务：\n\n- 在此平均法则下，推导离散时间序列 $\\{\\eta_{n}\\}$ 的均值和协方差，并论证 $\\eta_{n}$ 是否为高斯分布。\n-证明每个 $\\eta_{n}$ 在实践中都可以通过抽取一个标准正态变量，并用一个依赖于 $\\gamma$、$k_{B}$、$T$ 和 $\\Delta t$ 的确定性标准差 $\\sigma$ 进行缩放来采样。\n- 提供该标准差 $\\sigma$ 的闭式符号表达式。\n\n假设伪随机数是理想的，除了模型所蕴含的相关性之外没有其他相关性。将你的最终答案表示为 $\\sigma$ 关于 $\\gamma$、$k_{B}$、$T$ 和 $\\Delta t$ 的单一闭式解析表达式。最终答案中不要包含单位。如果在推导中做了任何近似，请加以说明和证明；最终答案在上述白噪声模型中必须是精确的。",
            "solution": "该问题是适定的，其科学基础在于统计力学原理，特别是布朗运动和朗之万动力学理论。所有给定的定义和条件都是标准且自洽的。我们可以开始进行推导。\n\n目标是确定离散时间随机力 $\\eta_n$ 的统计特性，该力被定义为连续时间随机力 $\\eta(t)$ 在宽度为 $\\Delta t$ 的时间区间上的时间平均值。连续时间力 $\\eta(t)$ 是一个平稳高斯白噪声过程，具有以下性质：\n$$\n\\langle \\eta(t) \\rangle = 0\n$$\n$$\n\\langle \\eta(t)\\,\\eta(t') \\rangle = 2\\,\\gamma\\,k_{B}\\,T\\,\\delta(t-t')\n$$\n对于区间 $[t_n, t_{n+1}]$（其中 $t_{n+1} = t_n + \\Delta t$），离散时间力 $\\eta_n$ 定义为：\n$$\n\\eta_{n} \\equiv \\frac{1}{\\Delta t}\\int_{t_{n}}^{t_{n+1}} \\eta(t)\\,dt\n$$\n\n首先，我们推导随机变量 $\\eta_n$ 的均值。根据期望算子和积分的线性性质，我们可以写出：\n$$\n\\langle \\eta_n \\rangle = \\left\\langle \\frac{1}{\\Delta t}\\int_{t_{n}}^{t_{n+1}} \\eta(t)\\,dt \\right\\rangle = \\frac{1}{\\Delta t}\\int_{t_{n}}^{t_{n+1}} \\langle \\eta(t) \\rangle\\,dt\n$$\n使用给定的性质 $\\langle \\eta(t) \\rangle = 0$ 对所有 $t$ 成立，该积分为零：\n$$\n\\langle \\eta_n \\rangle = \\frac{1}{\\Delta t}\\int_{t_{n}}^{t_{n+1}} 0\\,dt = 0\n$$\n因此，离散时间力序列 $\\{\\eta_n\\}$ 是一个零均值过程。\n\n接下来，我们证明 $\\eta_n$ 是一个高斯随机变量。连续时间过程 $\\eta(t)$ 被规定为一个高斯过程。离散时间变量 $\\eta_n$ 是通过对 $\\eta(t)$ 进行线性运算（积分）得到的。高斯过程的一个基本性质是，过程的任何线性泛函都会产生一个高斯分布的随机变量。因此，序列中的每个 $\\eta_n$ 都是一个高斯随机变量。\n\n现在，我们推导序列的协方差 $\\langle \\eta_n \\eta_m \\rangle$。使用 $\\eta_n$ 的定义：\n$$\n\\langle \\eta_n \\eta_m \\rangle = \\left\\langle \\left( \\frac{1}{\\Delta t}\\int_{t_{n}}^{t_{n+1}} \\eta(t)\\,dt \\right) \\left( \\frac{1}{\\Delta t}\\int_{t_{m}}^{t_{m+1}} \\eta(t')\\,dt' \\right) \\right\\rangle\n$$\n我们可以重新排列各项，并交换期望和积分算子：\n$$\n\\langle \\eta_n \\eta_m \\rangle = \\frac{1}{(\\Delta t)^2} \\int_{t_{n}}^{t_{n+1}} dt \\int_{t_{m}}^{t_{m+1}} dt' \\langle \\eta(t)\\,\\eta(t') \\rangle\n$$\n代入给定的 $\\eta(t)$ 的自相关函数：\n$$\n\\langle \\eta_n \\eta_m \\rangle = \\frac{1}{(\\Delta t)^2} \\int_{t_{n}}^{t_{n+1}} dt \\int_{t_{m}}^{t_{m+1}} dt' \\, (2\\,\\gamma\\,k_{B}\\,T\\,\\delta(t-t'))\n$$\n常数前置因子可以移到积分符号之外：\n$$\n\\langle \\eta_n \\eta_m \\rangle = \\frac{2\\,\\gamma\\,k_{B}\\,T}{(\\Delta t)^2} \\int_{t_{n}}^{t_{n+1}} dt \\int_{t_{m}}^{t_{m+1}} dt' \\,\\delta(t-t')\n$$\n我们首先计算关于 $t'$ 的内层积分。狄拉克δ分布的筛选性质表明 $\\int f(x)\\delta(x-a)dx = f(a)$。在这里，$\\delta(t-t')$ 在区间 $[t_m, t_{m+1}]$ 上的积分，如果 $t$ 在此区间内，则结果为 $1$，否则为 $0$。所以，\n$$\n\\int_{t_{m}}^{t_{m+1}} \\delta(t-t')\\,dt' = \n\\begin{cases}\n1   \\text{if } t \\in [t_m, t_{m+1}] \\\\\n0   \\text{otherwise}\n\\end{cases}\n$$\n协方差的表达式变为：\n$$\n\\langle \\eta_n \\eta_m \\rangle = \\frac{2\\,\\gamma\\,k_{B}\\,T}{(\\Delta t)^2} \\int_{t_{n}}^{t_{n+1}} dt \\, \\left( \\int_{t_{m}}^{t_{m+1}} \\delta(t-t')\\,dt' \\right)\n$$\n我们现在必须对余下的关于 $t$ 的积分考虑两种情况。\n情况1：$n \\neq m$。积分区间 $[t_n, t_{n+1}]$ 和 $[t_m, t_{m+1}]$ 是不相交的（它们仅在边界点接触，而该点的测度为零）。因此，对于 $[t_n, t_{n+1}]$ 中的任何 $t$，$t$ 都不在 $[t_m, t_{m+1}]$ 中。对于外层积分定义域中的所有 $t$，内层积分均为零。因此：\n$$\n\\langle \\eta_n \\eta_m \\rangle = 0 \\quad \\text{for } n \\neq m\n$$\n情况2：$n = m$。积分区间相同，即 $[t_n, t_{n+1}]$。对于此区间中的任何 $t$，内层积分的结果为 $1$。表达式变为：\n$$\n\\langle \\eta_n^2 \\rangle = \\frac{2\\,\\gamma\\,k_{B}\\,T}{(\\Delta t)^2} \\int_{t_{n}}^{t_{n+1}} 1\\,dt = \\frac{2\\,\\gamma\\,k_{B}\\,T}{(\\Delta t)^2} (t_{n+1} - t_n)\n$$\n由于 $t_{n+1} - t_n = \\Delta t$，我们有：\n$$\n\\langle \\eta_n^2 \\rangle = \\frac{2\\,\\gamma\\,k_{B}\\,T}{(\\Delta t)^2} \\Delta t = \\frac{2\\,\\gamma\\,k_{B}\\,T}{\\Delta t}\n$$\n使用克罗内克δ $\\delta_{nm}$ 结合这两种情况，序列的协方差为：\n$$\n\\langle \\eta_n \\eta_m \\rangle = \\frac{2\\,\\gamma\\,k_{B}\\,T}{\\Delta t} \\delta_{nm}\n$$\n这表明离散时间力在不同时间步长之间是不相关的。由于它们也是高斯分布的，它们构成了一个独立同分布 (i.i.d.) 的随机变量序列。\n\n$\\eta_n$ 的方差由 $\\text{Var}(\\eta_n) = \\langle \\eta_n^2 \\rangle - \\langle \\eta_n \\rangle^2$ 给出。因为 $\\langle \\eta_n \\rangle = 0$，方差就是：\n$$\n\\text{Var}(\\eta_n) = \\langle \\eta_n^2 \\rangle = \\frac{2\\,\\gamma\\,k_{B}\\,T}{\\Delta t}\n$$\n一个均值为 $\\mu$、方差为 $\\sigma^2$ 的高斯随机变量 $X \\sim \\mathcal{N}(\\mu, \\sigma^2)$，可以由一个标准正态变量 $Z \\sim \\mathcal{N}(0, 1)$ 通过变换 $X = \\mu + \\sigma Z$ 生成。\n在我们的例子中，$\\eta_n$ 是一个均值为 $\\mu = 0$、方差如上所述的高斯随机变量。因此，可以通过抽取一个标准正态变量 $Z_n$ 并将其通过标准差 $\\sigma = \\sqrt{\\text{Var}(\\eta_n)}$ 进行缩放来对 $\\eta_n$ 进行采样。\n$$\n\\eta_n = \\sigma Z_n, \\quad \\text{where } Z_n \\sim \\mathcal{N}(0, 1)\n$$\n因此，所要求的确定性标准差 $\\sigma$ 是：\n$$\n\\sigma = \\sqrt{\\frac{2\\,\\gamma\\,k_{B}\\,T}{\\Delta t}}\n$$\n该表达式仅依赖于物理参数 $\\gamma$、$k_B$、$T$ 和积分器时间步长 $\\Delta t$，符合题目要求。除了初始的白噪声模型外，没有做任何近似。",
            "answer": "$$\n\\boxed{\\sqrt{\\frac{2 \\gamma k_{B} T}{\\Delta t}}}\n$$"
        },
        {
            "introduction": "我们已经生成并使用了随机数，但它们足够“随机”吗？一个有缺陷的生成器可能会悄无声息地让多年的研究付诸东流。最后一个练习介绍了统计质量控制的基本技能，指导你构建卡方拟合优度检验（$\\chi^2$ test）来检查均匀性。更重要的是，它解决了一个大规模计算中的现代挑战：如何在并行进程中执行多个检验，同时通过控制族群错误率（FWER）来避免陷入大量假阳性的困境。",
            "id": "3484316",
            "problem": "在计算材料科学中，针对合金热力学的大规模蒙特卡洛（MC）模拟中，一个常见的质量控制步骤是测试用于选择试验移动的伪随机数生成器的均匀性。考虑一个生成器，它返回 $\\{0,\\ldots,2^{b}-1\\}$ 范围内的独立 $b$ 位无符号整数，这些整数之后根据需要映射为连续变量。您收集 $N$ 个输出，并将它们分箱到 $k=2^{b}$ 个可能的值中。您计划使用均匀性皮尔逊卡方检验，并将在 $M$ 个统计独立的子流（例如，每个处理单元一个）上应用此检验，旨在控制至少有一次错误拒绝的全局概率。\n\n仅从均匀零假设下 $k$ 个类别的多项式模型的核心定义以及证明卡方近似合理性的大样本行为出发，完成以下任务：\n\n1) 当检验 $b$ 位输出的精确均匀性的零假设时，为 $k=2^{b}$ 个分箱构建皮尔逊卡方检验统计量。您的构建必须基于多项式模型的第一性原理。\n\n2) 在零假设下，对于大样本 $N$ 且每个分箱的期望计数足够大的情况，推导卡方统计量的期望值。\n\n3) 您将在 $M$ 个子流上独立执行检验。请解释如何使用一种有原则的多重检验方法，在族系误差率（FWER）水平 $\\alpha$ 下，控制这 $M$ 个检验中至少出现一次假阳性的几率。您的解释应阐明此控制的逻辑，并根据适当参考分布的分位数来确定单次检验的决策阈值。简要地将其与使用 Benjamini–Hochberg 程序控制错误发现率（FDR）进行对比，并阐明为什么在为高风险模拟验证伪随机性时，FWER 控制是合适的。\n\n4) 对于以下参数进行数值评估：$b=10$，$N=2.048\\times 10^{7}$，$M=64$ 以及 $\\alpha=0.01$。计算零假设下的期望卡方统计量和单次检验的临界阈值。使用一种渐近精确的方法将单次检验的显著性水平映射到卡方临界值。将临界阈值四舍五入到四位有效数字。在您最终报告的数值答案中，提供一个单行矩阵，按顺序包含零假设下的期望卡方统计量和经 Bonferroni 校正的临界值。无需单位。",
            "solution": "在尝试任何解答之前，需要对问题陈述进行验证。\n\n### 步骤 1：提取已知信息\n-   一个伪随机数生成器（PRNG）在集合 $\\{0, 1, \\ldots, 2^{b}-1\\}$ 中生成独立的 $b$ 位无符号整数。\n-   收集一个大小为 $N$ 的样本。\n-   样本被划分到 $k=2^{b}$ 个分箱中，对应于可能的整数输出。\n-   将使用的检验是均匀性皮尔逊卡方检验。\n-   检验在 $M$ 个统计独立的子流上执行。\n-   目标是在水平 $\\alpha$ 下控制族系误差率（FWER）。\n-   任务 1：从均匀零假设下的多项式模型的第一性原理出发，构建皮尔逊卡方统计量。\n-   任务 2：在零假设下，对于大样本 $N$，推导此统计量的期望值。\n-   任务 3：解释在 $M$ 个检验中，于水平 $\\alpha$ 控制 FWER 的方法，确定单次检验的阈值，并与错误发现率（FDR）控制进行对比，论证选择 FWER 的合理性。\n-   任务 4：为参数 $b=10$，$N=2.048\\times 10^{7}$，$M=64$ 和 $\\alpha=0.01$ 提供数值评估。临界阈值应四舍五入至四位有效数字。最终答案应为一个行矩阵，包含期望卡方统计量和经 Bonferroni 校正的临界值。\n\n### 步骤 2：使用提取的已知信息进行验证\n根据所需标准对问题进行评估。\n-   **科学性**：该问题在标准统计理论中有充分的依据。对计数数据使用多项式模型、使用皮尔逊卡方拟合优度检验进行均匀性检验，以及使用如 Bonferroni 校正等多重检验校正方法来控制 FWER，这些都是统计学中的基本概念。其应用背景，即计算材料科学中 PRNG 的质量控制，既现实又恰当。\n-   **适定性**：该问题是适定的。它被分解为四个独立且逻辑上连续的任务。每个任务都有明确的定义，并要求基于所提供的信息进行推导、解释或计算。为数值部分给出的参数（$b=10$, $N=2.048\\times 10^{7}$）导致每个分箱的期望计数为 $E_i = N/k = (2.048\\times 10^{7})/2^{10} = 20000$，这个值非常大，验证了使用卡方近似的合理性。\n-   **客观性**：语言精确、技术性强，没有歧义或主观论断。\n-   **无其他缺陷**：该问题是自洽、一致的，并且不包含说明中列出的任何使其无效的缺陷，如科学上不成立、不完整或不可行。\n\n### 步骤 3：结论与行动\n该问题被判定为 **有效**。将提供完整解答。\n\n***\n\n### 1) 皮尔逊卡方统计量的构建\n设来自生成器的 $N$ 个输出为一个独立试验序列。每次试验可能产生 $k = 2^b$ 个可能结果之一（从 $0$ 到 $2^b-1$ 的整数）。令 $O_i$ 为随机变量，表示在 $N$ 次试验中观察到结果 $i$ 的次数，其中 $i \\in \\{1, 2, \\ldots, k\\}$。观测计数的向量 $(O_1, O_2, \\ldots, O_k)$ 服从参数为 $N$ 和 $(p_1, p_2, \\ldots, p_k)$ 的多项式分布，其中 $p_i$ 是观察到结果 $i$ 的概率，且 $\\sum_{i=1}^{k} p_i = 1$。观测总数受约束 $\\sum_{i=1}^{k} O_i = N$。\n\n零假设 $H_0$ 是生成器完全均匀。在 $H_0$ 下，观察到任何特定结果的概率对所有结果都是相同的。\n$$H_0: p_i = \\frac{1}{k} \\quad \\forall i \\in \\{1, 2, \\ldots, k\\}$$\n在零假设下，每个分箱 $i$ 的期望计数（记为 $E_i$）由下式给出：\n$$E_i = N \\cdot p_i = \\frac{N}{k}$$\n皮尔逊卡方统计量 $\\chi^2$ 衡量观测计数 $O_i$ 与期望计数 $E_i$ 之间的差异。它被构建为观测计数与期望计数之差的平方和，其中每个差值都通过期望计数的平方根进行标准化。\n$$\\chi^2 = \\sum_{i=1}^{k} \\frac{(O_i - E_i)^2}{E_i}$$\n在均匀零假设下代入 $E_i$ 的表达式，该统计量为：\n$$\\chi^2 = \\sum_{i=1}^{k} \\frac{(O_i - N/k)^2}{N/k}$$\n对于足够大的 $N$ 以至于所有 $E_i$ 都足够大（一个常见的经验法则是 $E_i \\ge 5$），该统计量近似服从自由度为 $k-1$ 的卡方分布。由于线性约束 $\\sum O_i = N$，损失了一个自由度。\n\n### 2) 卡方统计量的期望值\n为了求出零假设下 $\\chi^2$ 统计量的期望值，我们使用期望的线性性质。\n$$E[\\chi^2] = E\\left[ \\sum_{i=1}^{k} \\frac{(O_i - E_i)^2}{E_i} \\right] = \\sum_{i=1}^{k} \\frac{E[(O_i - E_i)^2]}{E_i}$$\n项 $E[(O_i - E_i)^2]$ 根据定义是随机变量 $O_i$ 的方差，记为 $\\text{Var}(O_i)$。虽然向量 $(O_1, \\ldots, O_k)$ 服从多项式分布，但每个边际计数 $O_i$ 服从二项分布，$O_i \\sim \\text{Binomial}(N, p_i)$。二项分布随机变量的方差由 $\\text{Var}(O_i) = N p_i (1-p_i)$ 给出。\n\n在零假设下，$p_i = 1/k$。因此，每个分箱中计数的方差为：\n$$\\text{Var}(O_i) = N \\left(\\frac{1}{k}\\right) \\left(1 - \\frac{1}{k}\\right)$$\n将此方差和期望计数 $E_i = N/k$ 代入 $E[\\chi^2]$ 的表达式中：\n$$E[\\chi^2] = \\sum_{i=1}^{k} \\frac{N \\frac{1}{k} \\left(1 - \\frac{1}{k}\\right)}{N/k}$$\n分子和分母中的项 $N/k$ 相互抵消：\n$$E[\\chi^2] = \\sum_{i=1}^{k} \\left(1 - \\frac{1}{k}\\right)$$\n由于被加数相对于索引 $i$ 是常数，这可以简化为：\n$$E[\\chi^2] = k \\left(1 - \\frac{1}{k}\\right) = k - 1$$\n这个结果是精确的，并且对任何样本大小 $N$ 都成立。值得注意的是，该统计量的期望值恰好等于其自由度，而自由度也正是自由度为 $k-1$ 的卡方随机变量的期望值。\n\n### 3) FWER 控制及与 FDR 的对比\n当执行 $M$ 个独立的假设检验时，在整个检验族中犯下至少一次第一类错误（错误地拒绝一个为真的零假设）的概率会增加。**族系误差率（FWER）** 就是这一事件的概率：$\\text{FWER} = P(\\text{至少一次错误拒绝})$。目标是控制这个比率，使其满足 $\\text{FWER} \\le \\alpha$。\n\n控制 FWER 的一个简单而有效的方法是 **Bonferroni 校正**。该方法依赖于布尔不等式（Boole's inequality），该不等式指出对于任何事件集合 $A_j$，$P(\\cup_j A_j) \\le \\sum_j P(A_j)$。设 $H_{0j}$ 为第 $j$ 个检验的零假设，并假设所有 $M$ 个零假设都为真。设第 $j$ 个检验的第一类错误是拒绝 $H_{0j}$ 的事件。如果我们将每个独立检验的显著性水平设置为一个更严格的值 $\\alpha' = \\alpha/M$，那么至少有一次错误拒绝的概率是有界的：\n$$\\text{FWER} = P(\\cup_{j=1}^M \\{\\text{reject } H_{0j}\\}) \\le \\sum_{j=1}^M P(\\text{reject } H_{0j}) = \\sum_{j=1}^M \\alpha' = M\\left(\\frac{\\alpha}{M}\\right) = \\alpha$$\n因此，为了在水平 $\\alpha$ 控制 FWER，如果第 $j$ 个检验的 p 值 $p_j$ 满足 $p_j \\le \\alpha/M$，则拒绝该检验的零假设。等价地，如果观测到的检验统计量 $\\chi_j^2$ 超过了对应于显著性水平 $\\alpha' = \\alpha/M$ 的临界值，则拒绝 $H_{0j}$。对于自由度为 $k-1$ 的卡方检验，**单次检验的决策阈值** 是由下式定义的临界值 $C$：\n$$C = \\chi^2_{k-1, 1 - \\alpha/M}$$\n其中 $\\chi^2_{df, q}$ 是自由度为 $df$ 的卡方分布的 $q$-分位数。\n\n相比之下，**错误发现率（FDR）**，由像 Benjamini-Hochberg（BH）程序这样的方法控制，是指在所有做出的拒绝中，错误拒绝的期望比例。BH 程序没有 Bonferroni 校正那么严格，它允许更多的拒绝（即具有更大的统计功效），代价是容忍一些假阳性，只要它们在所有发现中所占的比例很小。\n\n对于为高风险模拟验证 PRNG 的应用，**FWER 控制是合适的选择**。一个有缺陷的 PRNG 可能会系统性地使结果产生偏差，可能导致整个昂贵的计算研究失效。假阴性——未能检测出有缺陷的生成器——的后果是灾难性的。而假阳性——错误地标记一个好的生成器——的后果则相对较小（例如，重新运行测试或选择另一个成熟的生成器）。因此，需要一种高度保守的检验理念，以最大限度地减少接受哪怕一个坏生成器的机会。FWER 控制提供了这种强有力的保证，使其适用于质量控制，而 FDR 控制更适合于探索性分析，其目标是从大量候选项中识别出一组有希望的候选者。\n\n### 4) 数值评估\n给定参数为 $b=10$，$N=2.048\\times 10^{7}$，$M=64$ 和 $\\alpha=0.01$。\n\n首先，我们确定分箱数 $k$ 和自由度 $df$：\n$$k = 2^b = 2^{10} = 1024$$\n$$df = k - 1 = 1023$$\n\n在零假设下，卡方统计量的期望值为：\n$$E[\\chi^2] = k - 1 = 1023$$\n\n接下来，我们使用 Bonferroni 校正计算单次检验的临界阈值。$M$ 个检验中每个检验的调整后显著性水平为：\n$$\\alpha' = \\frac{\\alpha}{M} = \\frac{0.01}{64} = 0.00015625$$\n我们需要找到临界值 $C = \\chi^2_{df, 1-\\alpha'}$，即自由度为 $df=1023$ 的卡方分布的 $1 - 0.00015625 = 0.99984375$ 分位数。\n\n由于自由度很大（$df > 100$），我们可以使用一个精确的渐近近似。Wilson-Hilferty 近似指出，如果 $X \\sim \\chi^2_{df}$，那么变换后的变量 $Y = (X/df)^{1/3}$ 近似服从均值为 $\\mu_Y = 1 - \\frac{2}{9df}$、标准差为 $\\sigma_Y = \\sqrt{\\frac{2}{9df}}$ 的正态分布。\n设 $z_{1-\\alpha'}$ 为标准正态分布 $Z \\sim N(0,1)$ 的 $(1-\\alpha')$-分位数。我们可以写出：\n$$\\frac{(C/df)^{1/3} - \\mu_Y}{\\sigma_Y} \\approx z_{1-\\alpha'}$$\n$$C \\approx df \\left( \\mu_Y + z_{1-\\alpha'} \\sigma_Y \\right)^3 = df \\left( 1 - \\frac{2}{9df} + z_{1-\\alpha'} \\sqrt{\\frac{2}{9df}} \\right)^3$$\n首先，我们找到 $z_{1-\\alpha'}$。对于 $\\alpha' = 0.00015625$，我们需要累积概率为 $0.99984375$ 的分位数。标准统计表或软件给出 $z_{0.99984375} \\approx 3.5983$。\n现在我们计算涉及 $df=1023$ 的项：\n$$9df = 9 \\times 1023 = 9207$$\n$$\\frac{2}{9df} = \\frac{2}{9207} \\approx 0.000217226$$\n$$1 - \\frac{2}{9df} \\approx 1 - 0.000217226 = 0.999782774$$\n$$\\sqrt{\\frac{2}{9df}} \\approx \\sqrt{0.000217226} \\approx 0.01473858$$\n现在，我们将这些值代入 $C$ 的近似公式中：\n$$C \\approx 1023 \\left( 0.999782774 + 3.5983 \\times 0.01473858 \\right)^3$$\n$$C \\approx 1023 \\left( 0.999782774 + 0.0530335 \\right)^3$$\n$$C \\approx 1023 \\left( 1.05281627 \\right)^3$$\n$$C \\approx 1023 \\times 1.166956$$\n$$C \\approx 1193.80$$\n将此值四舍五入到四位有效数字得到 $1194$。\n\n所要求的两个数值是期望卡方统计量（$1023$）和经 Bonferroni 校正的临界值（$1194$）。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1023  1194\n\\end{pmatrix}\n}\n$$"
        }
    ]
}