{
    "hands_on_practices": [
        {
            "introduction": "实验上探测费米面最有效的方法之一是测量量子振荡效应，例如德哈斯-范阿尔芬（de Haas-van Alphen, dHvA）效应。本练习将一个模型费米面的几何特性——特别是其极值截面积——与实验上可直接测量的振荡频率联系起来。掌握这种计算是解读实验数据和理解金属电子结构的基础。",
            "id": "3451505",
            "problem": "考虑一个具有色散关系的准二维电子能带\n$$\nE(\\mathbf{k}) \\equiv E(k_{x},k_{y},k_{z}) = \\frac{\\hbar^{2}}{2 m} \\left(k_{x}^{2} + k_{y}^{2}\\right) + 2 t_{z} \\left[1 - \\cos\\left(k_{z} c\\right)\\right],\n$$\n其中 $m$ 是面内能带质量，$t_{z}  0$ 是层间跃迁振幅，$c$ 是层间晶格常数，$\\hbar$ 是约化普朗克常数。假设费米能量 $E_{F}$ 是一个常数，且满足 $E_{F}  4 t_{z}$，因此费米面是一个沿 $\\hat{z}$ 方向的弱褶皱圆柱体。一个均匀磁场沿 $\\hat{z}$ 方向施加，因此回旋运动发生在固定的 $k_{z}$ 平面内。\n\n从磁场中电子轨道的半经典量子化基本原理和费米面作为满足 $E(\\mathbf{k}) = E_{F}$ 的 $\\mathbf{k}$ 的集合的核心定义出发，完成以下任务：\n\n1. 对于固定的 $k_{z}$，推导 $k_{x}$-$k_{y}$ 平面中的费米波矢 $k_{F}(k_{z})$ 以及该 $k_{z}$ 处费米等高线所包围的相应横截面积 $A(k_{z})$。\n2. 确定 $A(k_{z})$ 相对于 $k_{z}$ 的极值，指明是哪些 $k_{z}$ 产生最大和最小面积，并给出这些面积的符号表达式。\n3. 使用半经典量子化框架，预测与这些极值横截面相关的基本量子振荡（de Haas–van Alphen (dHvA)）频率，以及这些轨道在费米能级上的相应回旋有效质量。\n\n将最终结果以单行矩阵的形式给出，依次包含两个极值 dHvA 频率（先是最大面积，然后是最小面积）和两个相应的回旋有效质量（先是最大面积轨道，然后是最小面积轨道）。振荡频率以特斯拉（Tesla）为单位，有效质量以千克（kilograms）为单位表示。没有提供数值；请用 $m$，$E_{F}$，$t_{z}$，$e$ 和 $\\hbar$ 给出封闭形式的解析表达式。在最终的方框答案中不要包含任何单位。",
            "solution": "在进行求解之前，对问题陈述进行严格验证。\n\n### 步骤 1：提取已知条件\n- **色散关系**：$E(\\mathbf{k}) \\equiv E(k_{x},k_{y},k_{z}) = \\frac{\\hbar^{2}}{2 m} \\left(k_{x}^{2} + k_{y}^{2}\\right) + 2 t_{z} \\left[1 - \\cos\\left(k_{z} c\\right)\\right]$。\n- **参数**：$m$ 是面内能带质量，$t_{z}  0$ 是层间跃迁振幅，$c$ 是层间晶格常数，$\\hbar$ 是约化普朗克常数。基本电荷用 $e$ 表示。\n- **条件**：费米能量 $E_{F}$ 是一个常数，满足 $E_{F}  4 t_{z}$。\n- **设置**：一个均匀磁场沿 $\\hat{z}$ 方向施加。回旋运动发生在恒定的 $k_{z}$ 平面内。\n- **任务**：\n  1. 对于固定的 $k_{z}$，推导费米波矢 $k_{F}(k_{z})$ 和横截面积 $A(k_{z})$。\n  2. 确定 $A(k_{z})$ 相对于 $k_{z}$ 的极值，它们出现的 $k_{z}$ 值，以及这些极值面积的符号表达式。\n  3. 预测这些极值轨道的 de Haas–van Alphen (dHvA) 频率和相应的回旋有效质量。\n\n### 步骤 2：使用提取的已知条件进行验证\n- **科学基础（关键）**：该问题基于固体中电子动力学的半经典模型和紧束缚近似，这些是凝聚态物理学中标准且成熟的框架。该色散关系是准二维层状材料的常见模型。对量子振荡（dHvA 效应）的分析是一种基本的实验和理论工具。该问题在科学上是合理的。\n- **适定性**：问题陈述清晰。条件 $E_{F}  4 t_{z}$ 至关重要，它确保费米面是一个单一、连续、类似褶皱圆柱体的曲面，在任何 $k_{z}$ 处都不会“收缩”或出现能隙。这保证了明确定义的、非零的最小和最大横截面积的存在，从而导出一个唯一的解。\n- **客观性（关键）**：问题使用精确的数学语言和客观的物理概念进行表述，没有任何主观或有偏见的陈述。\n\n### 步骤 3：结论与行动\n该问题是有效的。它在科学上是合理的，适定的，客观的，并包含足够的信息以获得唯一的解。开始求解。\n\n---\n\n### 第 1 部分：费米波矢和横截面积\n\n费米面定义为所有能量 $E(\\mathbf{k})$ 等于费米能量 $E_{F}$ 的波矢 $\\mathbf{k}$ 的集合。\n$$\nE_{F} = \\frac{\\hbar^{2}}{2 m} \\left(k_{x}^{2} + k_{y}^{2}\\right) + 2 t_{z} \\left[1 - \\cos\\left(k_{z} c\\right)\\right]\n$$\n问题陈述磁场沿 $\\hat{z}$ 方向，导致电子在恒定 $k_{z}$ 的平面内执行回旋运动。对于一个固定的 $k_{z}$，费米面等高线是 $k_{x}$-$k_{y}$ 平面中的一个圆。令 $k_{\\perp}^{2} = k_{x}^{2} + k_{y}^{2}$。在固定 $k_{z}$ 处费米面的方程变为：\n$$\n\\frac{\\hbar^{2}}{2 m} k_{\\perp}^{2} = E_{F} - 2 t_{z} \\left[1 - \\cos\\left(k_{z} c\\right)\\right]\n$$\n平面内的费米波矢 $k_{F}(k_{z})$ 是这个圆形横截面的半径，即在费米能量处求得的 $k_{\\perp}$。\n$$\nk_{F}(k_{z})^{2} = \\frac{2 m}{\\hbar^{2}} \\left(E_{F} - 2 t_{z} \\left[1 - \\cos\\left(k_{z} c\\right)\\right]\\right)\n$$\n因此，费米波矢为：\n$$\nk_{F}(k_{z}) = \\sqrt{\\frac{2 m}{\\hbar^{2}} \\left(E_{F} - 2 t_{z} \\left[1 - \\cos\\left(k_{z} c\\right)\\right]\\right)}\n$$\n在恒定 $k_{z}$ 平面内，费米面的横截面积 $A(k_{z})$ 是半径为 $k_{F}(k_{z})$ 的圆的面积：\n$$\nA(k_{z}) = \\pi k_{F}(k_{z})^{2}\n$$\n代入 $k_{F}(k_{z})^{2}$ 的表达式：\n$$\nA(k_{z}) = \\frac{2 \\pi m}{\\hbar^{2}} \\left(E_{F} - 2 t_{z} \\left[1 - \\cos\\left(k_{z} c\\right)\\right]\\right)\n$$\n\n### 第 2 部分：极值横截面积\n\n为了找到 $A(k_{z})$ 的极值，我们必须找到项 $\\cos(k_{z} c)$ 的极值，因为所有其他项都是常数。函数 $\\cos(x)$ 的最大值为 $1$，最小值为 $-1$。\n\n当从 $E_{F}$ 中减去的项最小时，面积 $A(k_{z})$ 最大化。这发生在 $1 - \\cos(k_{z} c)$ 处于其最小值时。$1 - \\cos(k_{z} c)$ 的最小值是 $1 - 1 = 0$，这发生在 $\\cos(k_{z} c) = 1$ 时。对于任意整数 $n$，当 $k_{z} c = 2 n \\pi$ 或 $k_{z} = \\frac{2 n \\pi}{c}$ 时，此条件成立。一个主值是 $k_{z}=0$。这个轨道通常被称为“腹”轨道。最大面积 $A_{max}$ 是：\n$$\nA_{max} = A(k_{z}=0) = \\frac{2 \\pi m}{\\hbar^{2}} \\left(E_{F} - 2 t_{z} \\left[1 - 1\\right]\\right) = \\frac{2 \\pi m E_{F}}{\\hbar^{2}}\n$$\n\n当从 $E_{F}$ 中减去的项最大时，面积 $A(k_{z})$ 最小化。这发生在 $1 - \\cos(k_{z} c)$ 处于其最大值时。$1 - \\cos(k_{z} c)$ 的最大值是 $1 - (-1) = 2$，这发生在 $\\cos(k_{z} c) = -1$ 时。对于任意整数 $n$，当 $k_z c = (2 n + 1) \\pi$ 或 $k_{z} = \\frac{(2 n + 1) \\pi}{c}$ 时，此条件成立。一个主值是 $k_z = \\pi/c$，在许多简单情况下对应于布里渊区边界。这个轨道通常被称为“颈”轨道。最小面积 $A_{min}$ 是：\n$$\nA_{min} = A(k_{z}=\\pi/c) = \\frac{2 \\pi m}{\\hbar^{2}} \\left(E_{F} - 2 t_{z} \\left[1 - (-1)\\right]\\right) = \\frac{2 \\pi m}{\\hbar^{2}} \\left(E_{F} - 4 t_{z}\\right)\n$$\n条件 $E_{F}  4 t_{z}$ 确保 $A_{min}$ 是正的，并且费米面没有被收缩。\n\n### 第 3 部分：dHvA 频率和回旋质量\n\nde Haas–van Alphen (dHvA) 振荡频率 $F$（以磁场单位特斯拉（Tesla）测量）通过 Onsager 关系与费米面的极值横截面积 $A_{ext}$ 相关：\n$$\nF = \\frac{\\hbar}{2 \\pi e} A_{ext}\n$$\n我们有两个极值面积，$A_{max}$ 和 $A_{min}$，它们产生两个基本频率，$F_{max}$ 和 $F_{min}$。\n\n对于最大面积轨道：\n$$\nF_{max} = \\frac{\\hbar}{2 \\pi e} A_{max} = \\frac{\\hbar}{2 \\pi e} \\left(\\frac{2 \\pi m E_{F}}{\\hbar^{2}}\\right) = \\frac{m E_{F}}{e \\hbar}\n$$\n\n对于最小面积轨道：\n$$\nF_{min} = \\frac{\\hbar}{2 \\pi e} A_{min} = \\frac{\\hbar}{2 \\pi e} \\left(\\frac{2 \\pi m (E_{F} - 4 t_{z})}{\\hbar^{2}}\\right) = \\frac{m (E_{F} - 4 t_{z})}{e \\hbar}\n$$\n\n接下来，我们确定这些轨道的回旋有效质量 $m_{c}$。回旋质量在费米能量处定义为：\n$$\nm_{c}(k_{z}) = \\frac{\\hbar^{2}}{2 \\pi} \\left. \\frac{\\partial A(E, k_{z})}{\\partial E} \\right|_{E=E_{F}}\n$$\n为了计算这个，我们首先将面积 $A$ 表示为一般能量 $E$ 和 $k_z$ 的函数：\n$$\nA(E, k_z) = \\frac{2 \\pi m}{\\hbar^{2}} \\left(E - 2 t_{z} \\left[1 - \\cos\\left(k_{z} c\\right)\\right]\\right)\n$$\n现在，我们对 $E$ 求偏导数：\n$$\n\\frac{\\partial A(E, k_{z})}{\\partial E} = \\frac{\\partial}{\\partial E} \\left[ \\frac{2 \\pi m}{\\hbar^{2}} \\left(E - 2 t_{z} \\left[1 - \\cos\\left(k_{z} c\\right)\\right]\\right) \\right] = \\frac{2 \\pi m}{\\hbar^{2}}\n$$\n这个导数是一个常数，与 $E$ 和 $k_{z}$ 都无关。因此，费米面上所有轨道的回旋质量都是相同的。\n$$\nm_{c} = \\frac{\\hbar^{2}}{2 \\pi} \\left(\\frac{2 \\pi m}{\\hbar^{2}}\\right) = m\n$$\n这个结果证实了最大面积轨道（$m_{c,max}$）和最小面积轨道（$m_{c,min}$）的回旋质量都等于面内能带质量 $m$。\n$$\nm_{c,max} = m_{c,min} = m\n$$\n对于在回旋轨道平面内呈纯抛物线型的色散关系，这是预期的结果。\n\n最终答案要求一个包含按顺序排列的四个计算量的行矩阵：$F_{max}$、$F_{min}$、$m_{c,max}$、$m_{c,min}$。",
            "answer": "$$\n\\boxed{\\pmatrix{ \\frac{m E_{F}}{e \\hbar}  \\frac{m(E_{F} - 4t_{z})}{e \\hbar}  m  m }}\n$$"
        },
        {
            "introduction": "除了静态的几何形状，费米面的连通性（或拓扑结构）在化学势等参数变化时也可能发生剧烈改变。本练习将引导您识别能带结构中的临界点，即范霍夫奇点（van Hove singularities），这些奇点驱动了费米面拓扑结构的改变。理解这些被称为“Lifshitz 跃迁”的拓扑相变，对于解释掺杂或高压下材料的物理性质至关重要。",
            "id": "3451548",
            "problem": "考虑一个简单立方晶格上的三维最近邻紧束缚能带，其晶格常数为 $a$，跃迁振幅为 $t0$，色散关系为\n$$\nE(\\mathbf{k})=-2t\\left(\\cos(k_x a)+\\cos(k_y a)+\\cos(k_z a)\\right),\n$$\n其中 $\\mathbf{k}$ 位于第一布里渊区，$k_i\\in[-\\pi/a,\\pi/a]$，$i\\in\\{x,y,z\\}$。费米面 (FS) 定义为满足 $E(\\mathbf{k})=\\mu$ 的 $\\mathbf{k}$ 的轨迹，其中 $\\mu$ 是化学势。范霍夫奇异点出现在布里渊区中 $E(\\mathbf{k})$ 的驻点处，在这些点上能量色散具有不定的海森矩阵（鞍点）。当 $\\mu$ 穿过相应的驻点能量时，费米面的拓扑结构会发生连续变化（利夫希茨相变）。\n\n从驻点的定义以及通过海森矩阵对临界点进行分类出发，确定第一布里渊区中 $E(\\mathbf{k})$ 的所有鞍点能量。利用这些结果，分析当 $\\mu$ 从能带底调至能带顶时，费米面的拓扑结构如何演变，并找出所有由范霍夫奇异点穿越驱动的利夫希茨相变发生时对应的不同化学势值。用 $t$ 表示临界化学势值的最终答案（使用 $t$ 作为能量单位）。最终答案必须以符号表达式的形式给出。最终答案中不要包含任何单位。",
            "solution": "该问题要求找出在一个给定的简单立方晶格上的紧束缚模型中，由范霍夫奇异点驱动的利夫希茨相变发生时的化学势 $\\mu$ 值。色散关系由下式给出\n$$\nE(\\mathbf{k}) = -2t\\left(\\cos(k_x a) + \\cos(k_y a) + \\cos(k_z a)\\right)\n$$\n其中 $t0$ 是跃迁振幅，$a$ 是晶格常数，$\\mathbf{k}=(k_x, k_y, k_z)$ 是第一布里渊区 (BZ) 中的波矢，定义为 $k_i \\in [-\\pi/a, \\pi/a]$，$i \\in \\{x,y,z\\}$。\n\n当化学势 $\\mu$ 穿过色散关系 $E(\\mathbf{k})$ 的驻点能量时，就会发生利夫希茨相变。范霍夫奇异点就对应于这样一个驻点。我们首先通过求解 $\\nabla_{\\mathbf{k}} E(\\mathbf{k}) = \\mathbf{0}$ 来找到布里渊区中的所有驻点 $\\mathbf{k}^*$。\n\n梯度的分量为：\n$$\n\\frac{\\partial E}{\\partial k_x} = 2ta \\sin(k_x a)\n$$\n$$\n\\frac{\\partial E}{\\partial k_y} = 2ta \\sin(k_y a)\n$$\n$$\n\\frac{\\partial E}{\\partial k_z} = 2ta \\sin(k_z a)\n$$\n将梯度设为零，得到对每个分量 $i \\in \\{x,y,z\\}$ 都有 $\\sin(k_i a) = 0$。在第一布里渊区内，当 $k_i a \\in \\{0, \\pi\\}$ 时，此条件成立。我们注意到，布里渊区边界上的点，如 $k_i a = -\\pi$，与 $k_i a = \\pi$ 相差一个倒格矢，因而是等效的。这在布里渊区中给出了 $2^3 = 8$ 个不同的高对称点。\n\n为了对这些驻点进行分类，我们计算海森矩阵 $H_{ij} = \\frac{\\partial^2 E}{\\partial k_i \\partial k_j}$。二阶偏导数为：\n$$\n\\frac{\\partial^2 E}{\\partial k_x^2} = 2ta^2 \\cos(k_x a)\n$$\n$$\n\\frac{\\partial^2 E}{\\partial k_y^2} = 2ta^2 \\cos(k_y a)\n$$\n$$\n\\frac{\\partial^2 E}{\\partial k_z^2} = 2ta^2 \\cos(k_z a)\n$$\n所有非对角项 $\\frac{\\partial^2 E}{\\partial k_i \\partial k_j}$ ($i \\neq j$) 均为零。因此，海森矩阵是对角的：\n$$\nH(\\mathbf{k}) = 2ta^2 \\begin{pmatrix} \\cos(k_x a)  0  0 \\\\ 0  \\cos(k_y a)  0 \\\\ 0  0  \\cos(k_z a) \\end{pmatrix}\n$$\n$H$ 的本征值是其对角元。驻点的性质由这些本征值的符号决定。由于 $t0$ 且 $a0$，符号由 $\\cos(k_i a)$ 的值决定，其值为 $\\cos(0)=1$ 或 $\\cos(\\pi)=-1$。\n\n我们现在对驻点进行分类并求出它们的能量：\n1.  **$\\Gamma$ 点**：$\\mathbf{k}a = (0,0,0)$。\n    在此点，对所有 $i$ 都有 $\\cos(k_i a)=1$。$H$ 的本征值均为正值 ($2ta^2, 2ta^2, 2ta^2$)。该点是一个局域极小值点。\n    能量为 $E_{\\min} = E(0,0,0) = -2t(1+1+1) = -6t$。这是能带底。\n\n2.  **$X$ 点**：$\\mathbf{k}a = (\\pi,0,0)$ 及其两个置换 $(0,\\pi,0)$ 和 $(0,0,\\pi)$。\n    对于 $\\mathbf{k}a=(\\pi,0,0)$，余弦值为 $(-1,1,1)$。$H$ 的本征值符号为 $(-,+,+)$。这些是指数为 1 的鞍点。\n    这些点的能量是 $E_1 = E(\\pi/a,0,0) = -2t(-1+1+1) = -2t$。\n\n3.  **$M$ 点**：$\\mathbf{k}a = (\\pi,\\pi,0)$ 及其两个置换 $(\\pi,0,\\pi)$ 和 $(0,\\pi,\\pi)$。\n    对于 $\\mathbf{k}a=(\\pi,\\pi,0)$，余弦值为 $(-1,-1,1)$。$H$ 的本征值符号为 $(-,-,+)$。这些是指数为 2 的鞍点。\n    这些点的能量是 $E_2 = E(\\pi/a,\\pi/a,0) = -2t(-1-1+1) = 2t$。\n\n4.  **$R$ 点**：$\\mathbf{k}a = (\\pi,\\pi,\\pi)$。\n    在此点，对所有 $i$ 都有 $\\cos(k_i a)=-1$。$H$ 的本征值均为负值 ($-2ta^2, -2ta^2, -2ta^2$)。该点是一个局域极大值点。\n    能量为 $E_{\\max}=E(\\pi/a,\\pi/a,\\pi/a) = -2t(-1-1-1) = 6t$。这是能带顶。\n\n该问题要求找出由范霍夫奇异点穿越驱动的利夫希茨相变发生时的化学势 $\\mu$ 值。这些值对应于鞍点的能量，在这些点上海森矩阵是不定的。根据我们的分析，这些能量是 $E_1 = -2t$ 和 $E_2 = 2t$。\n\n当 $\\mu$ 从 $-6t$ 增加到 $6t$ 时，费米面 (FS) 拓扑结构的演化证实了这些相变：\n-   对于略高于 $-6t$ 的 $\\mu$，费米面由以 $\\Gamma$ 点为中心的、小的、闭合的球形电子口袋组成。\n-   在 $\\mu = -2t$ 时，从 $\\Gamma$ 点生长出来的费米面在 $X$ 点处与布里渊区边界接触。这对应于费米面与其周期性映像相接触，导致拓扑结构从一个闭合曲面变为一个单一、连通、开放的“立体网格”结构。这是第一次利夫希茨相变。\n-   在 $\\mu = 2t$ 时，开放的费米面经历另一次拓扑变化。从靠近能带顶的空穴态的角度看，这一点最为清晰。之前连通的未占据态结构分裂开来。费米面从一个单一的开放曲面转变为一组以 $R$ 点为中心的不相交的、闭合的空穴口袋。这是第二次利夫希茨相变。\n-   对于接近 $6t$ 的 $\\mu$，费米面由围绕 $R$ 点的、小的、收缩的空穴口袋组成，这些口袋在 $\\mu=6t$ 时消失。\n\n因此，这些由鞍点驱动的利夫希茨相变发生时对应的不同化学势值，就是 $X$ 点和 $M$ 点的能量。\n$$\n\\mu_1 = -2t\n$$\n$$\n\\mu_2 = 2t\n$$\n这些是能带结构中与鞍点相关的范霍夫奇异点的能量。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} -2t  2t \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "解析模型为我们提供了深刻的物理洞察，但真实的材料科学研究高度依赖于数值计算。本练习旨在解决一个关键的计算问题：如何在计算依赖于费米面的物理量（如态密度）时确保数值精度。您将通过实现一个关于 $k$ 点网格密度的收敛性测试，亲身体会为何高曲率或慢电子（这些概念与前两个练习紧密相关）的区域需要更精细的采样才能获得可靠结果。",
            "id": "3451530",
            "problem": "给定一个用约化晶格单位表示的、具有高曲率费米面的金属的参数化单带模型。布里渊区（BZ）是倒易空间中以 $(-\\pi,-\\pi,-\\pi)$ 和 $(\\pi,\\pi,\\pi)$ 为顶点的立方体。电子色散由紧束缚函数定义\n$$\nE(\\mathbf{k}) = -2t\\left(\\cos k_x + \\cos k_y + \\alpha \\cos k_z\\right) - 4t_2\\left(\\cos k_x \\cos k_y + \\cos k_y \\cos k_z + \\cos k_z \\cos k_x\\right),\n$$\n参数为 $t = 1$，$t_2 = 0.3$ 和 $\\alpha = 0.5$。所有量均采用约化晶格单位，其中晶格常数设为 $a=1$，约化普朗克常数设为 $\\hbar = 1$。角度以弧度为单位。\n\n你的任务是设计并实现一个程序，在给定费米能级态密度 $N(E_F)$ 的目标绝对容差和平均费米速度大小变化量的绝对容差后，估算所需的最小均匀 $k$ 点网格密度 $n$（每轴点数），以满足指定金属的这两个收敛标准。程序必须具有通用性，并从第一性原理和经过充分检验的定义出发，不得假定任何预先计算的常数。\n\n基本原理和定义：\n- 态密度（DOS）定义为\n$$\nN(E) = \\frac{1}{(2\\pi)^3} \\int_{\\mathrm{BZ}} \\delta\\!\\left(E - E(\\mathbf{k})\\right)\\, d^3k,\n$$\n其中 $\\delta(\\cdot)$ 是狄拉克δ分布。等价地，通过余面积变换，\n$$\nN(E) = \\frac{1}{(2\\pi)^3} \\oint_{E(\\mathbf{k})=E} \\frac{dS}{\\left\\lvert \\nabla_{\\mathbf{k}} E(\\mathbf{k}) \\right\\rvert}.\n$$\n- 费米速度定义为\n$$\n\\mathbf{v}_F(\\mathbf{k}) = \\nabla_{\\mathbf{k}} E(\\mathbf{k}),\n$$\n采用上述约化单位。\n\n数值计算约束：\n- 使用均匀的Monkhorst-Pack风格网格，在布里渊区（BZ）的每个轴向上有 $n$ 个点，这些点位于等距子区间的中点。也就是说，对于每个轴，使用点 $k_i = -\\pi + \\left(i + \\frac{1}{2}\\right)\\Delta$，其中 $\\Delta = \\frac{2\\pi}{n}$ 且 $i \\in \\{0,1,\\dots,n-1\\}$。\n- 用宽度为 $\\sigma$ 的归一化高斯函数来近似狄拉克δ函数：\n$$\ng_{\\sigma}(x) = \\frac{1}{\\sigma \\sqrt{2\\pi}} \\exp\\!\\left(-\\frac{x^2}{2\\sigma^2}\\right).\n$$\n- 因为在此单位下布里渊区的体积等于 $(2\\pi)^3$，所以黎曼和近似对于态密度估计量简化为网格上的算术平均值，\n$$\n\\widehat{N}_{n,\\sigma}(E_F) = \\frac{1}{n^3} \\sum_{\\mathbf{k}} g_{\\sigma}\\!\\left(E(\\mathbf{k}) - E_F\\right).\n$$\n- 为了以与态密度采样一致的方式量化费米速度的变化，将费米能级处的高斯加权平均费米速度大小定义为\n$$\n\\widehat{V}_{n,\\sigma}(E_F) = \\frac{\\sum_{\\mathbf{k}} \\left\\lvert \\nabla_{\\mathbf{k}} E(\\mathbf{k}) \\right\\rvert g_{\\sigma}\\!\\left(E(\\mathbf{k}) - E_F\\right)}{\\sum_{\\mathbf{k}} g_{\\sigma}\\!\\left(E(\\mathbf{k}) - E_F\\right)}.\n$$\n\n收敛协议和目标：\n- 从初始网格 $n_0$ 开始，以固定的步长 $\\Delta n$ 增加，确定最小的 $n$，使得\n$$\n\\left\\lvert \\widehat{N}_{n,\\sigma}(E_F) - \\widehat{N}_{n-\\Delta n,\\sigma}(E_F) \\right\\rvert \\le \\varepsilon_N\n\\quad \\text{和} \\quad\n\\left\\lvert \\widehat{V}_{n,\\sigma}(E_F) - \\widehat{V}_{n-\\Delta n,\\sigma}(E_F) \\right\\rvert \\le \\varepsilon_V\n$$\n同时成立，其中 $\\varepsilon_N$ 是 $N(E_F)$ 的目标绝对容差，$\\varepsilon_V$ 是平均费米速度大小变化的绝对容差。如果在指定的最大值 $n_{\\max}$ 内没有 $n$ 能同时满足这两个条件，则该测试用例返回 $n_{\\max}$。\n- 基于速度的判据的理由必须基于费米面积分如何通过 $\\left\\lvert \\nabla_{\\mathbf{k}} E(\\mathbf{k}) \\right\\rvert^{-1}$ 对贡献进行加权。这使得对具有大曲率和小 $\\left\\lvert \\nabla_{\\mathbf{k}} E(\\mathbf{k}) \\right\\rvert$ 的区域进行精确采样，对于 $N(E_F)$ 估计的稳定性至关重要。高曲率的费米面加剧了这种敏感性，因此高斯加权平均 $\\left\\lvert \\mathbf{v}_F \\right\\rvert$ 的变化可以作为费米面几何形状采样稳定性的一个代理指标。\n\n测试套件：\n对于以下每一组参数，计算并报告满足两个标准的最小 $n$ 值。所有能量单位与色散关系中的能量单位相同，$\\sigma$ 是相同能量单位下的高斯宽度，容差为绝对容差。\n- 情况 1：$E_F = 0.0$，$\\sigma = 0.05$，$\\varepsilon_N = 0.003$，$\\varepsilon_V = 0.002$，$n_0 = 8$，$\\Delta n = 4$，$n_{\\max} = 48$。\n- 情况 2：$E_F = 0.5$，$\\sigma = 0.05$，$\\varepsilon_N = 0.001$，$\\varepsilon_V = 0.0015$，$n_0 = 8$，$\\Delta n = 4$，$n_{\\max} = 48$。\n- 情况 3：$E_F = -2.5$，$\\sigma = 0.05$，$\\varepsilon_N = 0.005$，$\\varepsilon_V = 0.003$，$n_0 = 8$，$\\Delta n = 4$，$n_{\\max} = 48$。\n- 情况 4：$E_F = 1.5$，$\\sigma = 0.03$，$\\varepsilon_N = 0.002$，$\\varepsilon_V = 0.002$，$n_0 = 8$，$\\Delta n = 4$，$n_{\\max} = 48$。\n\n要求的最终输出格式：\n你的程序应生成单行输出，其中包含四个情况的最小网格大小，格式为方括号括起来的逗号分隔列表，例如 $[n_1,n_2,n_3,n_4]$。条目 $n_1$、$n_2$、$n_3$ 和 $n_4$ 必须是整数。不应打印其他任何文本。",
            "solution": "问题陈述已经过严格审查，并被确定为有效。它在科学上是合理的、定义明确的，并且基于计算凝聚态物理的既定原则。它提出了一个清晰、可形式化的任务，并提供了所有必要的参数和定义。因此，我们可以着手解决。\n\n目标是确定最小的均匀 $k$ 点网格密度，用每个倒格矢轴上的点数 $n$ 表示，该密度要求能同时实现费米能级态密度 $N(E_F)$ 和平均费米速度大小 $\\widehat{V}(E_F)$ 的收敛。收敛由特定的绝对容差定义。\n\n该解决方案基于以下第一性原理和数值方法构建。\n\n**1. 电子结构模型**\n\n电子能带结构由第一布里渊区（BZ）内的单带紧束缚色散关系 $E(\\mathbf{k})$ 描述，该布里渊区是由 $k_x, k_y, k_z \\in [-\\pi, \\pi]$ 定义的立方体。能量由下式给出：\n$$\nE(\\mathbf{k}) = -2t\\left(\\cos k_x + \\cos k_y + \\alpha \\cos k_z\\right) - 4t_2\\left(\\cos k_x \\cos k_y + \\cos k_y \\cos k_z + \\cos k_z \\cos k_x\\right)\n$$\n参数指定为 $t = 1$，$t_2 = 0.3$ 和 $\\alpha = 0.5$。所有量均采用约化晶格单位，其中晶格常数 $a=1$，约化普朗克常数 $\\hbar=1$。\n\n费米速度 $\\mathbf{v}_F(\\mathbf{k})$ 是色散关系相对于波矢量 $\\mathbf{k}$ 的梯度：\n$$\n\\mathbf{v}_F(\\mathbf{k}) = \\nabla_{\\mathbf{k}} E(\\mathbf{k}) = \\left(\\frac{\\partial E}{\\partial k_x}, \\frac{\\partial E}{\\partial k_y}, \\frac{\\partial E}{\\partial k_z}\\right)\n$$\n偏导数通过解析计算得出：\n$$\n\\frac{\\partial E}{\\partial k_x} = 2t \\sin k_x + 4t_2 \\sin k_x \\left(\\cos k_y + \\cos k_z\\right)\n$$\n$$\n\\frac{\\partial E}{\\partial k_y} = 2t \\sin k_y + 4t_2 \\sin k_y \\left(\\cos k_x + \\cos k_z\\right)\n$$\n$$\n\\frac{\\partial E}{\\partial k_z} = 2t\\alpha \\sin k_z + 4t_2 \\sin k_z \\left(\\cos k_x + \\cos k_y\\right)\n$$\n我们关心的是这个矢量的大小，$\\left\\lvert \\mathbf{v}_F(\\mathbf{k}) \\right\\rvert = \\sqrt{(\\frac{\\partial E}{\\partial k_x})^2 + (\\frac{\\partial E}{\\partial k_y})^2 + (\\frac{\\partial E}{\\partial k_z})^2}$。\n\n**2. 物理量的数值估计**\n\n对布里渊区的连续积分通过在均匀 $k$ 点网格上的离散求和来近似。问题指定了一个Monkhorst-Pack风格的网格，其点位于子区间的中点。对于密度为 $n$ 的网格，沿每个轴 $j \\in \\{x,y,z\\}$ 的坐标为：\n$$\nk_{j,i} = -\\pi + \\left(i + \\frac{1}{2}\\right)\\frac{2\\pi}{n}, \\quad \\text{for } i \\in \\{0, 1, \\dots, n-1\\}\n$$\n这在布里渊区内总共生成 $n^3$ 个点 $\\mathbf{k}$。\n\n能量为 $E$ 处的态密度（DOS）$N(E)$ 由一个包含狄拉克δ分布 $\\delta(x)$ 的积分定义。为了进行数值计算，$\\delta(x)$ 被一个窄的归一化高斯函数 $g_{\\sigma}(x)$ 近似：\n$$\n\\delta(x) \\approx g_{\\sigma}(x) = \\frac{1}{\\sigma \\sqrt{2\\pi}} \\exp\\!\\left(-\\frac{x^2}{2\\sigma^2}\\right)\n$$\n其中 $\\sigma$ 是展宽参数。然后，对态密度的布里渊区积分通过在 $n^3$ 个离散 $k$ 点上的黎曼和来近似。由于布里渊区的体积为 $(2\\pi)^3$，每个 $k$ 点的体积元为 $(2\\pi/n)^3$，因此费米能 $E_F$ 处的态密度估计量变成一个简单的算术平均值：\n$$\n\\widehat{N}_{n,\\sigma}(E_F) = \\frac{1}{(2\\pi)^3} \\sum_{\\mathbf{k}} g_{\\sigma}\\!\\left(E(\\mathbf{k}) - E_F\\right) \\left(\\frac{2\\pi}{n}\\right)^3 = \\frac{1}{n^3} \\sum_{\\mathbf{k}} g_{\\sigma}\\!\\left(E(\\mathbf{k}) - E_F\\right)\n$$\n此公式与问题陈述中提供的公式相符。\n\n在 $E_F$ 处的平均费米速度大小是作为加权平均计算的。每个 $k$ 点的贡献由其与费米面的接近程度加权，这由相同的高斯函数 $g_{\\sigma}(E(\\mathbf{k}) - E_F)$ 捕捉。该估计量为：\n$$\n\\widehat{V}_{n,\\sigma}(E_F) = \\frac{\\sum_{\\mathbf{k}} \\left\\lvert \\nabla_{\\mathbf{k}} E(\\mathbf{k}) \\right\\rvert g_{\\sigma}\\!\\left(E(\\mathbf{k}) - E_F\\right)}{\\sum_{\\mathbf{k}} g_{\\sigma}\\!\\left(E(\\mathbf{k}) - E_F\\right)}\n$$\n分母与态密度估计量成正比，确保了适当归一化的加权平均。\n\n**3. 收敛算法**\n\n任务的核心是找到使计算属性收敛的最小网格密度 $n$。对于每个测试用例，算法按以下步骤进行：\n1.  初始化网格密度扫描，从 $n=n_0$ 开始，以 $\\Delta n$ 的步长增加，直至最大值 $n_{\\max}$。密度序列为 $n_0, n_0+\\Delta n, n_0+2\\Delta n, \\dots$。\n2.  对于初始密度 $n_0$，计算基准值 $\\widehat{N}_{n_0,\\sigma}(E_F)$ 和 $\\widehat{V}_{n_0,\\sigma}(E_F)$。这些值将作为第一次收敛检查的参考。\n3.  遍历序列中后续的网格密度 $n  n_0$。在对应于密度 $n$ 的每一步中，计算当前值 $\\widehat{N}_{n,\\sigma}(E_F)$ 和 $\\widehat{V}_{n,\\sigma}(E_F)$。\n4.  将当前值与前一个网格密度 $n-\\Delta n$ 的值进行比较。如果以下两个条件同时满足，则达到收敛：\n    $$\n    \\left\\lvert \\widehat{N}_{n,\\sigma}(E_F) - \\widehat{N}_{n-\\Delta n,\\sigma}(E_F) \\right\\rvert \\le \\varepsilon_N\n    $$\n    $$\n    \\left\\lvert \\widehat{V}_{n,\\sigma}(E_F) - \\widehat{V}_{n-\\Delta n,\\sigma}(E_F) \\right\\rvert \\le \\varepsilon_V\n    $$\n    其中 $\\varepsilon_N$ 和 $\\varepsilon_V$ 是指定的绝对容差。\n5.  第一个满足两个条件的 $n$ 值是所需的最小密度。然后该测试用例的搜索终止，并报告此 $n$ 值。\n6.  如果循环完成且没有 $n \\le n_{\\max}$ 满足收敛标准，则该测试用例的结果为 $n_{\\max}$。\n\n此迭代过程将针对问题中定义的四个测试用例中的每一个实施，从而得出要报告的四个整数结果。该实现将利用矢量化数值计算来提高效率。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to solve the Fermi surface analysis problem for all test cases.\n    \"\"\"\n\n    # Model parameters from the problem statement\n    t = 1.0\n    t2 = 0.3\n    alpha = 0.5\n\n    def energy(kx, ky, kz):\n        \"\"\"\n        Calculates the electronic dispersion E(k).\n        Args:\n            kx, ky, kz: NumPy arrays of k-vector components.\n        Returns:\n            NumPy array of energy values.\n        \"\"\"\n        cos_kx = np.cos(kx)\n        cos_ky = np.cos(ky)\n        cos_kz = np.cos(kz)\n        \n        term1 = -2.0 * t * (cos_kx + cos_ky + alpha * cos_kz)\n        term2 = -4.0 * t2 * (cos_kx * cos_ky + cos_ky * cos_kz + cos_kz * cos_kx)\n        \n        return term1 + term2\n\n    def grad_energy_mag(kx, ky, kz):\n        \"\"\"\n        Calculates the magnitude of the Fermi velocity |nabla_k E(k)|.\n        Args:\n            kx, ky, kz: NumPy arrays of k-vector components.\n        Returns:\n            NumPy array of Fermi velocity magnitudes.\n        \"\"\"\n        sin_kx = np.sin(kx)\n        sin_ky = np.sin(ky)\n        sin_kz = np.sin(kz)\n        cos_kx = np.cos(kx)\n        cos_ky = np.cos(ky)\n        cos_kz = np.cos(kz)\n\n        grad_x = 2.0 * t * sin_kx + 4.0 * t2 * sin_kx * (cos_ky + cos_kz)\n        grad_y = 2.0 * t * sin_ky + 4.0 * t2 * sin_ky * (cos_kx + cos_kz)\n        grad_z = 2.0 * t * alpha * sin_kz + 4.0 * t2 * sin_kz * (cos_kx + cos_ky)\n        \n        return np.sqrt(grad_x**2 + grad_y**2 + grad_z**2)\n\n    def calculate_properties(n, E_F, sigma):\n        \"\"\"\n        Calculates the DOS and mean Fermi velocity magnitude for a given mesh density.\n        Args:\n            n: Integer, number of k-points per axis.\n            E_F: Float, Fermi energy.\n            sigma: Float, Gaussian broadening width.\n        Returns:\n            A tuple (dos, avg_v_f) containing the calculated properties.\n        \"\"\"\n        # Generate the k-point mesh\n        delta_k = 2.0 * np.pi / n\n        k_1d = -np.pi + (np.arange(n) + 0.5) * delta_k\n        kx, ky, kz = np.meshgrid(k_1d, k_1d, k_1d, indexing='ij')\n\n        # Calculate energies and velocity magnitudes on the mesh\n        E_k = energy(kx, ky, kz)\n        v_f_mag_k = grad_energy_mag(kx, ky, kz)\n        \n        # Calculate Gaussian weights\n        x = E_k - E_F\n        gaussian_weights = (1.0 / (sigma * np.sqrt(2.0 * np.pi))) * np.exp(-x**2 / (2.0 * sigma**2))\n        \n        # Calculate DOS estimator\n        dos_estimator = np.mean(gaussian_weights)\n        \n        # Calculate average Fermi velocity magnitude\n        numerator = np.sum(v_f_mag_k * gaussian_weights)\n        denominator = np.sum(gaussian_weights)\n        \n        # Handle case where denominator is zero to avoid division by zero error\n        if denominator == 0:\n            avg_v_f_estimator = 0.0\n        else:\n            avg_v_f_estimator = numerator / denominator\n            \n        return dos_estimator, avg_v_f_estimator\n\n    def find_converged_n(case_params):\n        \"\"\"\n        Finds the minimal mesh density n that satisfies the convergence criteria.\n        Args:\n            case_params: A tuple containing (E_F, sigma, eps_N, eps_V, n0, dn, n_max).\n        Returns:\n            Integer, the minimal converged n.\n        \"\"\"\n        E_F, sigma, eps_N, eps_V, n0, dn, n_max = case_params\n        \n        n_values = range(n0, n_max + 1, dn)\n        \n        # Calculate for the initial mesh n0\n        N_prev, V_prev = calculate_properties(n0, E_F, sigma)\n        \n        if len(n_values) == 1:\n            return n0\n\n        # Iterate from the second mesh size\n        for n in n_values[1:]:\n            N_curr, V_curr = calculate_properties(n, E_F, sigma)\n            \n            # Check for convergence\n            delta_N = abs(N_curr - N_prev)\n            delta_V = abs(V_curr - V_prev)\n            \n            if delta_N = eps_N and delta_V = eps_V:\n                return n\n            \n            # Update previous values for the next iteration\n            N_prev = N_curr\n            V_prev = V_curr\n            \n        # If loop finishes without convergence, return n_max\n        return n_max\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (E_F, sigma, eps_N, eps_V, n0, dn, n_max)\n        (0.0, 0.05, 0.003, 0.002, 8, 4, 48),    # Case 1\n        (0.5, 0.05, 0.001, 0.0015, 8, 4, 48),  # Case 2\n        (-2.5, 0.05, 0.005, 0.003, 8, 4, 48),  # Case 3\n        (1.5, 0.03, 0.002, 0.002, 8, 4, 48),    # Case 4\n    ]\n\n    results = []\n    for case in test_cases:\n        result = find_converged_n(case)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}