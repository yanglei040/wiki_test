{
    "hands_on_practices": [
        {
            "introduction": "展宽方法通过平滑费米能级处的不连续占据来稳定金属体系的计算，但同时也会引入系统误差。本练习将深入探究此能量偏差的数学根源。通过运用卷积和泰勒展开等基本数学工具，您将推导出能量偏差的主导项，从而深刻理解展宽宽度 $\\sigma$ 和电子结构（态密度）是如何共同决定计算精度的。",
            "id": "3488005",
            "problem": "考虑一个在独立电子理论框架下描述的金属体系。在零温下，每个晶胞的总能带能量由能量、态密度 (DOS) 和占据函数的乘积对能量的积分给出。令 $\\epsilon$ 表示单粒子能量，$\\epsilon_{F}$ 表示费米能。零温下的占据函数是赫维赛德阶跃函数 $\\Theta(\\epsilon_{F}-\\epsilon)$，总能带能量为\n$$\nE_{0} = \\int_{-\\infty}^{+\\infty} \\epsilon\\, g(\\epsilon)\\, \\Theta(\\epsilon_{F}-\\epsilon)\\, d\\epsilon,\n$$\n其中 $g(\\epsilon)$ 是态密度 (DOS)。\n\n在金属的实际电子结构计算中，展宽方法通过将赫维赛德函数与一个归一化的展宽核进行卷积，构造出一个展宽占据函数来替代不连续的占据函数。具体而言，定义一个展宽核 $s_{\\sigma}(u)$，其宽度参数为 $\\sigma$，满足 $\\int_{-\\infty}^{+\\infty} s_{\\sigma}(u)\\, du = 1$、$s_{\\sigma}(u) = s_{\\sigma}(-u)$ 并且具有有限的偶数阶矩。展宽占据函数为\n$$\nn_{\\sigma}(\\epsilon) = \\int_{-\\infty}^{+\\infty} \\Theta(\\epsilon_{F} - \\epsilon - u)\\, s_{\\sigma}(u)\\, du,\n$$\n相应的展宽总能带能量为\n$$\nE_{\\sigma} = \\int_{-\\infty}^{+\\infty} \\epsilon\\, g(\\epsilon)\\, n_{\\sigma}(\\epsilon)\\, d\\epsilon.\n$$\n\n仅使用卷积的基本性质和费米能附近的可微性假设，推导如何将 $E_{\\sigma}$ 写成展宽核与 $E_{0}$ 中出现的被积函数的一个原函数之间的卷积形式。然后，假设态密度在费米能的邻域内是线性的，\n$$\ng(\\epsilon) = g_{0} + g_{1}\\, (\\epsilon - \\epsilon_{F}),\n$$\n其中 $g_{0}$ 和 $g_{1}$ 为常数，计算能量的领头偏差，\n$$\n\\Delta E \\equiv E_{\\sigma} - E_{0},\n$$\n取到 $\\sigma$ 的最低非零阶。\n\n为明确起见，取展宽核为归一化的高斯函数\n$$\ns_{\\sigma}(u) = \\frac{1}{\\sigma \\sqrt{\\pi}}\\, \\exp\\!\\big( -(\\tfrac{u}{\\sigma})^{2} \\big),\n$$\n并假设 $\\sigma$ 与 $g(\\epsilon)$ 变化的特征能量标度相比很小。请将您的最终答案表示为 $\\Delta E$ 关于 $g_{0}$、$g_{1}$、$\\epsilon_{F}$ 和 $\\sigma$ 的单个解析闭式表达式。无需进行数值计算或四舍五入，最终答案中不应包含单位。",
            "solution": "将通过首先提取给定条件，然后严格评估问题的科学基础、一致性和结构来验证问题陈述。\n\n### 步骤 1：提取给定条件\n- 零温下的总能带能量为：\n$E_{0} = \\int_{-\\infty}^{+\\infty} \\epsilon\\, g(\\epsilon)\\, \\Theta(\\epsilon_{F}-\\epsilon)\\, d\\epsilon$，其中 $\\epsilon$ 是能量，$g(\\epsilon)$ 是态密度 (DOS)，$\\epsilon_{F}$ 是费米能，$\\Theta(x)$ 是赫维赛德阶跃函数。\n- 展宽核 $s_{\\sigma}(u)$ 具有以下性质：\n  - 宽度参数 $\\sigma$。\n  - 归一化：$\\int_{-\\infty}^{+\\infty} s_{\\sigma}(u)\\, du = 1$。\n  - 对称性：$s_{\\sigma}(u) = s_{\\sigma}(-u)$ (偶函数)。\n  - 有限的偶数阶矩。\n- 展宽占据函数为：\n$n_{\\sigma}(\\epsilon) = \\int_{-\\infty}^{+\\infty} \\Theta(\\epsilon_{F} - \\epsilon - u)\\, s_{\\sigma}(u)\\, du$。\n- 展宽总能带能量为：\n$E_{\\sigma} = \\int_{-\\infty}^{+\\infty} \\epsilon\\, g(\\epsilon)\\, n_{\\sigma}(\\epsilon)\\, d\\epsilon$。\n- 假设态密度在费米能的邻域内是线性的：\n$g(\\epsilon) = g_{0} + g_{1}\\, (\\epsilon - \\epsilon_{F})$，其中 $g_{0}$ 和 $g_{1}$ 是常数。\n- 要使用的具体展宽核是归一化的高斯函数：\n$s_{\\sigma}(u) = \\frac{1}{\\sigma \\sqrt{\\pi}}\\, \\exp\\!\\big( -(\\tfrac{u}{\\sigma})^{2} \\big)$。\n- 目标是计算领头偏差 $\\Delta E \\equiv E_{\\sigma} - E_{0}$，取到 $\\sigma$ 的最低非零阶。\n\n### 步骤 2：使用提取的给定条件进行验证\n1.  **科学基础**：该问题设置在独立电子理论的背景下，这是固态物理学的基石。态密度、费米能和能带能量等概念都是基础性的。使用展宽方法来处理零温下费米-狄拉克分布的不连续性是计算材料科学中的一种标准且必要的技术，尤其是在金属的密度泛函理论计算中。该问题牢固地建立在公认的科学原理之上。\n2.  **良态问题**：该问题提供了所有必要的定义和方程。假设（线性 DOS，高斯展宽）陈述清晰，是此类解析推导的典型做法。目标是在这些条件下找到一个特定的量（$\\Delta E$），这会导出一个唯一且有意义的解。\n3.  **客观性**：语言精确且专业，没有主观或模糊的术语。所有量都有正式定义。\n4.  **未发现缺陷**：该问题没有违反任何无效性标准。它在科学上是合理的，陈述是形式化的，内容是完整的，并且是良态的。\n\n### 步骤 3：结论与行动\n该问题被判定为**有效**。将提供一个完整的、有理有据的解答。\n\n### 解答推导\n按照问题的要求，解答过程分为两个主要部分。首先，我们将展宽能量 $E_{\\sigma}$ 表示为卷积形式。其次，我们通过对小展宽宽度 $\\sigma$ 的表达式进行展开，来计算能量偏差 $\\Delta E$。\n\n零温能量可以写成：\n$$E_{0} = \\int_{-\\infty}^{\\epsilon_{F}} \\epsilon\\, g(\\epsilon)\\, d\\epsilon$$\n我们定义被积函数的光滑部分 $\\epsilon g(\\epsilon)$ 的一个原函数 $F(\\mu)$ 为：\n$$F(\\mu) = \\int_{-\\infty}^{\\mu} \\epsilon'\\, g(\\epsilon')\\, d\\epsilon'$$\n根据这个定义，零温能量就是 $E_{0} = F(\\epsilon_{F})$。这里假设积分在 $-\\infty$ 处收敛，这在物理上是合理的，因为能带具有有限的底部。\n\n现在，我们分析展宽能量 $E_{\\sigma}$。代入展宽占据 $n_{\\sigma}(\\epsilon)$ 的定义：\n$$E_{\\sigma} = \\int_{-\\infty}^{+\\infty} \\epsilon\\, g(\\epsilon)\\, \\left( \\int_{-\\infty}^{+\\infty} \\Theta(\\epsilon_{F} - \\epsilon - u)\\, s_{\\sigma}(u)\\, du \\right) d\\epsilon$$\n由于函数是良态的，我们可以应用 Fubini 定理来交换积分顺序：\n$$E_{\\sigma} = \\int_{-\\infty}^{+\\infty} s_{\\sigma}(u)\\, \\left( \\int_{-\\infty}^{+\\infty} \\epsilon\\, g(\\epsilon)\\, \\Theta(\\epsilon_{F} - u - \\epsilon)\\, d\\epsilon \\right) du$$\n利用赫维赛德函数的定义，可以简化内部积分：\n$$\\int_{-\\infty}^{+\\infty} \\epsilon\\, g(\\epsilon)\\, \\Theta(\\epsilon_{F} - u - \\epsilon)\\, d\\epsilon = \\int_{-\\infty}^{\\epsilon_{F}-u} \\epsilon\\, g(\\epsilon)\\, d\\epsilon$$\n这恰好是我们的原函数 $F$ 在 $\\epsilon_{F}-u$ 处的值。因此，内部积分是 $F(\\epsilon_{F}-u)$。\n将其代回，我们得到：\n$$E_{\\sigma} = \\int_{-\\infty}^{+\\infty} F(\\epsilon_{F}-u)\\, s_{\\sigma}(u)\\, du$$\n这个表达式是函数 $F$ 和展宽核 $s_{\\sigma}$ 的卷积，在费米能 $\\epsilon_{F}$ 处求值。具体来说，如果我们定义卷积为 $(F * s_{\\sigma})(x) \\equiv \\int_{-\\infty}^{+\\infty} F(x-u)\\, s_{\\sigma}(u)\\, du$，那么我们已经证明了 $E_{\\sigma} = (F * s_{\\sigma})(\\epsilon_{F})$。这完成了问题的第一部分。\n\n接下来，为了计算偏差 $\\Delta E = E_{\\sigma} - E_{0}$，我们在 $u=0$ 附近对函数 $F(\\epsilon_{F}-u)$ 进行泰勒展开。我们假设 $F$ 足够可微，如果 $g(\\epsilon)$ 是光滑的，这一点可以保证。\n$$F(\\epsilon_{F}-u) = \\sum_{k=0}^{\\infty} \\frac{(-u)^{k}}{k!} F^{(k)}(\\epsilon_{F}) = F(\\epsilon_{F}) - u F'(\\epsilon_{F}) + \\frac{u^{2}}{2} F''(\\epsilon_{F}) - \\frac{u^{3}}{6} F'''(\\epsilon_{F}) + \\dots$$\n其中 $F^{(k)}(\\epsilon_{F})$ 表示 $F$ 对其自变量的 $k$ 阶导数，在 $\\epsilon_{F}$ 处求值。\n将这个级数代入 $E_{\\sigma}$ 的表达式中：\n$$E_{\\sigma} = \\int_{-\\infty}^{+\\infty} \\left( \\sum_{k=0}^{\\infty} \\frac{(-u)^{k}}{k!} F^{(k)}(\\epsilon_{F}) \\right) s_{\\sigma}(u)\\, du = \\sum_{k=0}^{\\infty} \\frac{(-1)^k F^{(k)}(\\epsilon_{F})}{k!} \\int_{-\\infty}^{+\\infty} u^{k} s_{\\sigma}(u)\\, du$$\n令 $M_{k} = \\int_{-\\infty}^{+\\infty} u^{k} s_{\\sigma}(u)\\, du$ 为展宽核的 $k$ 阶矩。$E_{\\sigma}$ 的表达式变为：\n$$E_{\\sigma} = F(\\epsilon_{F}) M_{0} - F'(\\epsilon_{F}) M_{1} + \\frac{F''(\\epsilon_{F})}{2} M_{2} - \\dots$$\n根据 $s_{\\sigma}(u)$ 的给定性质：\n1.  它是归一化的，所以 $M_{0} = \\int s_{\\sigma}(u) du = 1$。\n2.  它是一个偶函数，$s_{\\sigma}(u) = s_{\\sigma}(-u)$，这意味着所有奇数阶矩都为零：$M_{2k+1} = 0$ 对于 $k=0, 1, 2, \\dots$。\n因此，$E_{\\sigma}$ 的级数简化为：\n$$E_{\\sigma} = F(\\epsilon_{F}) + \\frac{F''(\\epsilon_{F})}{2} M_{2} + \\frac{F^{(4)}(\\epsilon_{F})}{24} M_{4} + \\dots$$\n回想一下 $E_{0} = F(\\epsilon_{F})$，能量偏差为：\n$$\\Delta E = E_{\\sigma} - E_{0} = \\frac{M_{2}}{2} F''(\\epsilon_{F}) + \\frac{M_{4}}{24} F^{(4)}(\\epsilon_{F}) + \\dots$$\n在 $\\sigma$ 的最低非零阶上的领头偏差由第一项给出，假设 $M_2 \\neq 0$ 且 $F''(\\epsilon_F) \\neq 0$。我们需要计算 $F''(\\epsilon_{F})$ 和 $M_{2}$。\n\n首先，我们计算 $F(\\mu)$ 的导数。\n根据定义 $F(\\mu) = \\int_{-\\infty}^{\\mu} \\epsilon' g(\\epsilon') d\\epsilon'$，由微积分基本定理可得：\n$$F'(\\mu) = \\mu\\, g(\\mu)$$\n再次对 $\\mu$ 求导：\n$$F''(\\mu) = \\frac{d}{d\\mu}(\\mu\\, g(\\mu)) = 1 \\cdot g(\\mu) + \\mu \\cdot g'(\\mu)$$\n我们在费米能 $\\mu = \\epsilon_{F}$ 处计算该式的值：\n$$F''(\\epsilon_{F}) = g(\\epsilon_{F}) + \\epsilon_{F}\\, g'(\\epsilon_{F})$$\n使用给定的态密度线性近似 $g(\\epsilon) = g_{0} + g_{1}(\\epsilon - \\epsilon_{F})$，我们发现：\n$$g(\\epsilon_{F}) = g_{0} + g_{1}(\\epsilon_{F} - \\epsilon_{F}) = g_{0}$$\n$$g'(\\epsilon) = g_{1} \\implies g'(\\epsilon_{F}) = g_{1}$$\n将这些代入 $F''(\\epsilon_{F})$ 的表达式中：\n$$F''(\\epsilon_{F}) = g_{0} + \\epsilon_{F}\\, g_{1}$$\n\n其次，我们计算高斯核 $s_{\\sigma}(u) = \\frac{1}{\\sigma \\sqrt{\\pi}}\\, \\exp\\left( -(\\frac{u}{\\sigma})^{2} \\right)$ 的二阶矩 $M_{2}$。\n$$M_{2} = \\int_{-\\infty}^{+\\infty} u^{2} s_{\\sigma}(u) \\, du = \\frac{1}{\\sigma \\sqrt{\\pi}} \\int_{-\\infty}^{+\\infty} u^{2} \\exp\\left( -\\left(\\frac{u}{\\sigma}\\right)^{2} \\right) du$$\n我们进行变量替换 $x = u/\\sigma$，因此 $u = x\\sigma$ 且 $du = \\sigma dx$。\n$$M_{2} = \\frac{1}{\\sigma \\sqrt{\\pi}} \\int_{-\\infty}^{+\\infty} (x\\sigma)^{2} \\exp(-x^{2}) (\\sigma dx) = \\frac{\\sigma^{2}}{\\sqrt{\\pi}} \\int_{-\\infty}^{+\\infty} x^{2} \\exp(-x^{2}) dx$$\n积分 $\\int_{-\\infty}^{+\\infty} x^{2} \\exp(-x^{2}) dx$ 是一个标准的高斯积分，与伽马函数有关，或可通过分部积分法推导。我们注意到 $\\int_{-\\infty}^{+\\infty} \\exp(-ax^{2}) dx = \\sqrt{\\pi/a}$。对 $a$ 求导得到 $-\\int_{-\\infty}^{+\\infty} x^2 \\exp(-ax^2) dx = -\\frac{1}{2} \\sqrt{\\pi} a^{-3/2}$。对于 $a=1$，我们得到 $\\int_{-\\infty}^{+\\infty} x^{2} \\exp(-x^{2}) dx = \\frac{\\sqrt{\\pi}}{2}$。\n将此结果代回 $M_{2}$ 的表达式中：\n$$M_{2} = \\frac{\\sigma^{2}}{\\sqrt{\\pi}} \\left( \\frac{\\sqrt{\\pi}}{2} \\right) = \\frac{\\sigma^{2}}{2}$$\n矩 $M_k$ 与 $\\sigma^k$ 成正比，所以 $M_2 \\propto \\sigma^2$，$M_4 \\propto \\sigma^4$，等等。因此，含有 $M_2$ 的项是 $\\sigma$ 的领头阶项。\n\n最后，将各部分组合起来得到领头阶偏差 $\\Delta E$：\n$$\\Delta E \\approx \\frac{M_{2}}{2} F''(\\epsilon_{F}) = \\frac{1}{2} \\left(\\frac{\\sigma^{2}}{2}\\right) (g_{0} + \\epsilon_{F} g_{1})$$\n这就给出了能量领头偏差的最终结果：\n$$\\Delta E = \\frac{\\sigma^{2}}{4} (g_{0} + \\epsilon_{F} g_{1})$$",
            "answer": "$$\n\\boxed{\\frac{\\sigma^{2}}{4}(g_{0} + \\epsilon_{F} g_{1})}\n$$"
        },
        {
            "introduction": "展宽参数 $\\sigma$ 不仅是一个数值工具，它还可以具有深刻的物理意义。本练习将展宽宽度 $\\sigma$ 与系统的电子熵联系起来，将其视为一个等效的电子温度。通过推导 $\\sigma$ 与熵之间的关系，您将学习如何设定并执行特定电子温度下的模拟，并理解其对自由能等热力学可观测量的重要影响。",
            "id": "3487962",
            "problem": "一个金属体系在密度泛函理论（DFT）的框架内通过布里渊区采样进行处理，其中电子占据数通过能量展宽参数 $\\sigma$ 进行展宽，以在存在费米面的情况下稳定收敛。考虑费米-狄拉克展宽，它被解释为有限的电子温度，因此能量为 $E$ 的单粒子态的占据数为 $f(E) = \\left[1 + \\exp\\left((E - \\mu)/(k_{B} T)\\right)\\right]^{-1}$，其中化学势 $\\mu$ 由粒子数守恒确定。总电子熵由标准的统计力学表达式 $S = -k_{B} \\sum_{i} \\left[ f_{i} \\ln f_{i} + (1 - f_{i}) \\ln(1 - f_{i}) \\right]$ 定义，在连续极限下，它表示为对态密度 $D(E)$ 的积分。假设该体系是金属性的，其态密度在费米能级 $E_{F}$ 附近变化缓慢，因此在 $E_{F}$ 附近的一个窄窗口内，$D(E)$ 可以被视为近似恒定且等于 $D(E_{F})$。总电子数为 $N_{e}$。\n\n从这些定义和物理假设出发：\n\n- 推导出在小 $T$ 的领头阶下，总熵 $S$ 关于 $D(E_{F})$、$k_{B}$ 和 $T$ 的解析表达式。然后写出单个电子的熵 $s = S/N_{e}$，并符号求解一个能量展宽参数 $\\sigma$，该参数在费米-狄拉克展宽下（通过等同关系 $\\sigma = k_{B} T$）能够达到一个预设的目标 $s$。\n\n- 在相同的推导框架下，解释当 DFT 代码报告电子自由能 $F = E - T S$ 及其导数时，通过目标 $s$ 来选择 $\\sigma$ 如何影响计算出的总能量和力，并阐明有限温解释与纯数值展宽的区别。\n\n现在将您的符号表达式 $\\sigma$ 应用于以下具体案例。总电子数为 $N_{e} = 20$，整个模拟晶胞（包括自旋）在费米能级处的态密度为 $D(E_{F}) = 10$ 个态/电子伏特，目标单个电子的熵为 $s = \\alpha k_{B}$，其中 $\\alpha = 0.05$。在低温近似下，计算实现此 $s$ 的 $\\sigma$。用电子伏特表示您最终的 $\\sigma$，并将答案四舍五入到四位有效数字。",
            "solution": "在尝试任何解答之前，需对问题进行验证。\n\n### 第1步：提取已知条件\n-   **体系**：通过密度泛函理论（DFT）和布里渊区采样描述的金属体系。\n-   **占据函数**：费米-狄拉克展宽，$f(E) = \\left[1 + \\exp\\left((E - \\mu)/(k_{B} T)\\right)\\right]^{-1}$。\n-   **展宽参数**：$\\sigma$ 等同于热能，$\\sigma = k_{B} T$。\n-   **总熵**：$S = -k_{B} \\sum_{i} \\left[ f_{i} \\ln f_{i} + (1 - f_{i}) \\ln(1 - f_{i}) \\right]$。\n-   **连续极限**：求和被替换为对态密度（DOS）$D(E)$ 的积分。\n-   **近似**：态密度在费米能级附近为常数，$D(E) \\approx D(E_{F})$。\n-   **总电子数**：$N_{e}$。\n-   **报告的能量**：电子自由能为 $F = E - T S$。\n-   **具体案例数据**：\n    -   总电子数：$N_{e} = 20$。\n    -   费米能级处的态密度：$D(E_{F}) = 10$ 个态/电子伏特。\n    -   目标单个电子的熵：$s = \\alpha k_{B}$，其中 $\\alpha = 0.05$。\n\n### 第2步：使用提取的已知条件进行验证\n-   **科学依据**：该问题在科学上是合理的。它描述了费米-狄拉克展宽，这是DFT计算金属体系时一种标准且广泛使用的技术。占据函数和熵的表达式是统计力学的基本结果。低温近似和电子熵的推导基于固态物理学中公认的索末菲展开。\n-   **适定性**：该问题是适定的。它清楚地定义了任务：推导一个符号表达式，提供物理解释，并根据推导出的公式进行数值计算。所提供的信息对于完成这些任务是充分且自洽的。\n-   **客观性**：该问题使用精确、客观和标准的科学术语进行表述，没有歧义或主观陈述。\n\n### 第3步：结论与行动\n该问题是有效的，因为它具有科学依据、适定性和客观性。将提供解答。\n\n### 总熵 $S$ 的推导\n在连续极限下，总熵 $S$ 由单态熵在所有态上的积分给出，并由态密度 $D(E)$ 加权：\n$$S = -k_{B} \\int_{-\\infty}^{\\infty} D(E) \\left[ f(E) \\ln f(E) + (1 - f(E)) \\ln(1 - f(E)) \\right] dE$$\n其中 $f(E)$ 是费米-狄拉克分布。对于低温 $T$ 下的金属体系，熵主要来自于费米能级 $E_F$ 附近宽度约为 $\\sim k_B T$ 的窄能量窗口内电子的热激发。问题假设在此区域内，态密度 $D(E)$ 可被视为常数 $D(E_F)$。推导电子熵领头阶项的标准方法是通过电子热容 $C_{V}$。\n\n定容电子热容定义为 $C_{V} = \\left(\\frac{\\partial U}{\\partial T}\\right)_{V}$，其中 $U$ 是总电子内能，$U = \\int_{-\\infty}^{\\infty} E D(E) f(E) dE$。在低温极限下，相对于基态能量 $U(0)$ 的内能变化由索末菲展开的著名结果给出：\n$$\\Delta U = U(T) - U(0) = \\frac{\\pi^2}{6} D(E_F) (k_B T)^2$$\n电子热容则为：\n$$C_{V} = \\frac{d}{dT} \\left( U(0) + \\frac{\\pi^2}{6} D(E_F) (k_B T)^2 \\right) = \\frac{\\pi^2}{3} D(E_F) k_B^2 T$$\n这种对温度的线性依赖关系是金属中电子气的一个标志。熵 $S$ 是通过将 $C_V/T$ 从绝对零度积分到温度 $T$ 得到的：\n$$S(T) = \\int_{0}^{T} \\frac{C_V(T')}{T'} dT' = \\int_{0}^{T} \\left( \\frac{\\pi^2}{3} D(E_F) k_B^2 \\right) dT'$$\n执行积分可得到总熵在 $T$ 的领头阶下的表达式：\n$$S = \\frac{\\pi^2}{3} D(E_F) k_B^2 T$$\n\n### 展宽参数 $\\sigma$ 的表达式\n单个电子的熵 $s$ 定义为 $s = S/N_{e}$。代入推导出的 $S$ 的表达式：\n$$s = \\frac{\\pi^2 D(E_F) k_B^2 T}{3 N_{e}}$$\n问题指明展宽参数 $\\sigma$ 与热能等同，即 $\\sigma = k_{B} T$。将此代入 $s$ 的表达式中：\n$$s = \\frac{\\pi^2 D(E_F) k_B \\sigma}{3 N_{e}}$$\n我们现在可以解这个方程，求出为达到目标单个电子熵 $s$ 所需的展宽参数 $\\sigma$：\n$$\\sigma = \\frac{3 N_{e} s}{\\pi^2 D(E_F) k_B}$$\n\n### 物理解释及其对DFT计算的影响\n在金属的DFT框架中，展宽参数 $\\sigma$ 有两种常见的解释：\n1.  **数值展宽**：展宽被用作一种数值技术，通过平滑费米能级处占据数的急剧不连续性来加速和稳定自洽场（SCF）的收敛。在这种情况下，$\\sigma$ 是一个没有物理意义的参数。目标是恢复零温基态的性质。DFT代码通常计算自由能 $F(\\sigma) = U(\\sigma) - TS(\\sigma)$，其中 $U(\\sigma)$ 是用展宽后的占据数计算的内能。然后通过将 $F(\\sigma)$ 外推到 $\\sigma \\to 0$ 的极限来估计零温总能量 $U(0)$。使用我们推导的表达式并设 $\\sigma = k_B T$：\n    $$F(\\sigma) = U(T) - TS = \\left(U(0) + \\frac{\\pi^2}{6} D(E_F) \\sigma^2 \\right) - T\\left(\\frac{\\pi^2}{3} D(E_F) k_B \\sigma\\right)$$\n    $$F(\\sigma) = U(0) + \\frac{\\pi^2}{6} D(E_F) \\sigma^2 - \\frac{\\sigma}{k_B}\\left(\\frac{\\pi^2}{3} D(E_F) k_B \\sigma\\right) = U(0) - \\frac{\\pi^2}{6} D(E_F) \\sigma^2$$\n    这表明自由能对 $\\sigma$ 具有二次依赖关系，这为外推 $F(\\sigma \\to 0) = U(0)$ 提供了基础。\n\n2.  **有限电子温度**：费米-狄拉克展宽可以从字面上解释为描述体系处于一个有限的电子温度 $T = \\sigma/k_B$。在SCF循环中最小化的量对应于巨势，而报告的能量是亥姆霍兹自由能 $F = U - TS$。原子上的力是作为该自由能的导数计算的，$F_{atom} = -\\nabla_R F$，因此包含了与温度相关的效应。\n\n选择 $\\sigma$ 以达到目标单个电子熵 $s$ 明确地将计算置于第二种解释之下。这意味着我们正在一个特定的、具有物理意义的电子温度 $T = \\sigma/k_B$ 下模拟该体系。在比较不同的原子构型或体系时，人们将比较它们在恒定单个电子熵 $s$ 下的自由能 $F$，这是一个非标准的统计系综（相对于更常见的恒定 $T$ 的正则系综）。这种选择固定了热力学状态，所得到的总能量（即 $F$）和力都对应于该有限温度。\n\n### 具体案例的应用\n我们已知以下数值：\n-   总电子数：$N_{e} = 20$。\n-   费米能级处的态密度：$D(E_{F}) = 10 \\text{ eV}^{-1}$。\n-   目标单个电子的熵：$s = \\alpha k_{B}$，其中 $\\alpha = 0.05$。所以，$s/k_B = 0.05$。\n\n我们使用 $\\sigma$ 的符号表达式：\n$$\\sigma = \\frac{3 N_{e} s}{\\pi^2 D(E_F) k_B} = \\frac{3 N_{e}}{\\pi^2 D(E_F)} \\left(\\frac{s}{k_B}\\right)$$\n代入给定的数值：\n$$\\sigma = \\frac{3 \\times 20}{\\pi^2 \\times 10 \\text{ eV}^{-1}} \\times 0.05$$\n玻尔兹曼常数 $k_B$ 被消掉，$\\sigma$ 的单位将是电子伏特 ($eV$)。\n$$\\sigma = \\frac{60 \\times 0.05}{\\pi^2 \\times 10} \\text{ eV} = \\frac{3}{\\pi^2 \\times 10} \\text{ eV}$$\n计算数值：\n$$\\sigma = \\frac{3}{10 \\pi^2} \\text{ eV} \\approx \\frac{3}{10 \\times 9.8696044} \\text{ eV} \\approx 0.030396355 \\text{ eV}$$\n将结果四舍五入到四位有效数字，我们得到：\n$$\\sigma \\approx 0.03040 \\text{ eV}$$",
            "answer": "$$\\boxed{0.03040}$$"
        },
        {
            "introduction": "理论家们已经发展出多种展宽方法以减小计算中的能量偏差。本练习提供了一个通过编程实践来检验这些理论的机会。您将为一个简单的紧束缚模型实现两种先进的展宽方法——Methfessel-Paxton (MP) 和 Marzari-Vanderbilt (MV) 冷展宽，并进行比较。通过将这些方法应用于一个在态密度上具有尖锐特征（范霍夫奇点）的体系，您将亲手验证高阶展宽方案在理论上的优越性，并深刻体会MP方法中的矩消去技术是如何在具有复杂电子结构的体系中显著提高总能量计算精度的。",
            "id": "3488000",
            "problem": "考虑一个金属体系，其零温下的占据数函数是一个不连续的阶跃。在金属的数值布里渊区积分中，为了减少采样噪声，通常用一个光滑的近似函数来替代这个不连续的阶跃。设精确的零温占据数由亥维赛德阶跃函数 $f_{0}(E) = \\Theta(E_{F} - E)$ 给出，其中 $E$ 表示能量，$E_{F}$ 表示费米能。一个通用的展宽方案是将 $f_{0}(E)$ 替换为一个光滑函数 $f_{\\sigma}(E)$，该函数由一个积分为1且特征宽度为 $\\sigma$ 的核函数 $g(u)$ 构建。定义标度化变量 $x = (E - E_{F})/\\sigma$ 和占据数为 $f_{\\sigma}(E) = \\int_{x}^{\\infty} g(u)\\,du$，因此有 $\\frac{d}{dE}f_{\\sigma}(E) = -\\frac{1}{\\sigma}g((E - E_{F})/\\sigma)$。\n\n设态密度 (DOS) 是 $E_{F}$ 邻域内的光滑函数 $D(E)$，并考虑能量泛函 $F = \\int_{-\\infty}^{\\infty} E\\,D(E)\\,f(E)\\,dE$，其中 $f(E)$ 表示占据数函数。由展宽引起的能量偏差 $\\Delta F(\\sigma) = F_{\\sigma} - F_{0}$ 通过其矩依赖于核函数。通过将 $D(E)$ 在 $E_{F}$ 附近作泰勒展开，$D(E_{F} + \\sigma x) = \\sum_{m=0}^{\\infty} \\frac{\\sigma^{m}}{m!} D^{(m)}(E_{F})\\,x^{m}$，并逐项积分，可以发现 $\\Delta F(\\sigma)$ 的主要依赖关系由 $g$ 的矩 $\\mu_{m} = \\int_{-\\infty}^{\\infty} x^{m} g(x)\\,dx$ 决定，并且当特定的矩为零时会发生抵消。Methfessel-Paxton (MP) 的N阶核函数族旨在抵消高达2N阶的偶数矩，从而减少与DOS曲率耦合的偏差。相比之下，Marzari-Vanderbilt (MV) 冷展宽采用严格正定的核函数，该核函数不抵消相同的矩集，但提高了数值稳定性。\n\n你的任务是通过计算构建并验证一个案例，在该案例中，由于 $E_{F}$ 附近结构化的DOS曲率，MP二阶 ($N=2$) 方法在总能量偏差方面优于 MV 冷展宽方法。使用一个二维正方晶格上的紧束缚模型，其最近邻跃迁为 $t$，次近邻跃迁为 $t'$：\n$$\n\\varepsilon(\\mathbf{k}) = -2t\\left[\\cos(k_{x}) + \\cos(k_{y})\\right] - 4t'\\,\\cos(k_{x})\\cos(k_{y}),\n$$\n其中 $\\mathbf{k}$ 在布里渊区 $[-\\pi,\\pi]\\times[-\\pi,\\pi]$ 上均匀采样。设零温能量 $F_{0}$ 为采样网格上的离散求和\n$$\nF_{0} = \\frac{1}{N_{k}} \\sum_{\\mathbf{k}} \\varepsilon(\\mathbf{k})\\,\\Theta(E_{F} - \\varepsilon(\\mathbf{k})),\n$$\n而展宽能量为\n$$\nF_{\\sigma}[g] = \\frac{1}{N_{k}} \\sum_{\\mathbf{k}} \\varepsilon(\\mathbf{k})\\,f_{\\sigma}(\\varepsilon(\\mathbf{k})),\n$$\n其中 $f_{\\sigma}(\\varepsilon) = \\int_{(\\varepsilon - E_{F})/\\sigma}^{\\infty} g(u)\\,du$。\n\n实现以下核函数：\n\n1. MP二阶 ($N=2$) 核函数，构建为高斯函数偶次导数的线性组合，\n$$\ng_{\\mathrm{MP2}}(x) = \\sum_{n=0}^{2} c_{n}\\,\\frac{d^{2n}}{dx^{2n}}\\left(\\frac{1}{\\sqrt{\\pi}}e^{-x^{2}}\\right),\n$$\n其中系数 $c_{n}$ 通过强制执行矩条件来确定\n$$\n\\int_{-\\infty}^{\\infty} g_{\\mathrm{MP2}}(x)\\,dx = 1,\\quad \\int_{-\\infty}^{\\infty} x^{2} g_{\\mathrm{MP2}}(x)\\,dx = 0,\\quad \\int_{-\\infty}^{\\infty} x^{4} g_{\\mathrm{MP2}}(x)\\,dx = 0.\n$$\n通过 $\\frac{d^{m}}{dx^{m}}e^{-x^{2}} = (-1)^{m}H_{m}(x)e^{-x^{2}}$，用物理学家定义的埃尔米特多项式 $H_{m}(x)$ 表示导数，从而得到\n$$\ng_{\\mathrm{MP2}}(x) = \\frac{1}{\\sqrt{\\pi}}e^{-x^{2}}\\left[c_{0}H_{0}(x) + c_{1}H_{2}(x) + c_{2}H_{4}(x)\\right].\n$$\n\n2. MV 冷展宽核函数，对应于占据数\n$$\nf_{\\mathrm{cold}}(x) = \\frac{1}{2}\\left[1 - \\operatorname{erf}(x)\\right] + \\frac{x}{\\sqrt{\\pi}}e^{-x^{2}},\n$$\n因此\n$$\ng_{\\mathrm{cold}}(x) = -\\frac{d}{dx}f_{\\mathrm{cold}}(x) = \\frac{2}{\\sqrt{\\pi}}x^{2}e^{-x^{2}}.\n$$\n\n设计数值算法以计算两种核函数的 $F_{0}$ 和 $F_{\\sigma}[g]$，并以电子伏特 (eV) 为单位评估能量偏差 $\\Delta F(\\sigma) = F_{\\sigma}[g] - F_{0}$。使用以下测试套件来验证当 DOS 在 $E_{F}$ 附近具有强曲率时，MP二阶方法优于冷展宽方法的论断：\n\n- 情况1（$E_{F}$ 附近的结构化DOS，理想情况）：$t = 1\\,\\mathrm{eV}$，$t' = 0\\,\\mathrm{eV}$，$E_{F} = 0\\,\\mathrm{eV}$，$\\sigma = 0.15\\,\\mathrm{eV}$。\n- 情况2（远离范霍夫奇异点）：$t = 1\\,\\mathrm{eV}$，$t' = 0\\,\\mathrm{eV}$，$E_{F} = 1.0\\,\\mathrm{eV}$，$\\sigma = 0.15\\,\\mathrm{eV}$。\n- 情况3（通过次近邻跃迁增强曲率）：$t = 1\\,\\mathrm{eV}$，$t' = 0.30\\,\\mathrm{eV}$，$E_{F} = 0\\,\\mathrm{eV}$，$\\sigma = 0.15\\,\\mathrm{eV}$。\n- 情况4（边界情况：小展宽宽度）：$t = 1\\,\\mathrm{eV}$，$t' = 0\\,\\mathrm{eV}$，$E_{F} = 0\\,\\mathrm{eV}$，$\\sigma = 0.05\\,\\mathrm{eV}$。\n\n对于每种情况，计算布尔值结果\n$$\n\\mathrm{better} = \\left|\\Delta F_{\\mathrm{MP2}}(\\sigma)\\right|  \\left|\\Delta F_{\\mathrm{cold}}(\\sigma)\\right|.\n$$\n\n物理单位：以电子伏特 (eV) 报告能量偏差。最终程序输出应为单行，包含四种情况的布尔值结果列表，格式为方括号括起来的逗号分隔列表，例如 `[True,False,True,True]`。构建 $\\varepsilon(\\mathbf{k})$ 时，角度以弧度采样。\n\n你的程序必须是完整且可运行的。它不能要求用户输入，并且必须产生指定的单行输出。数值采样网格必须是均匀且足够精细以分辨范霍夫奇异点；使用总共有 $N_{k}$ 个点的正方形网格，并在解决方案中解释如何选择 $N_{k}$。通过证明所有算法近似的合理性来确保科学真实性。每个测试用例的答案必须是布尔值。",
            "solution": "用户提供的问题是有效的。它基于计算凝聚态物理的原理，特别是关于金属体系中电子占据数的数值积分。该问题是适定的，提供了构建唯一数值解所需的所有必要定义、方程和参数。其语言客观且无歧義。任务是在旨在凸显其理论差异的特定条件下，实现并比较两种已有的展宽技术：Methfessel-Paxton (MP) 和 Marzari-Vanderbilt (MV，或称冷展宽)。\n\n此比较的核心原理在于展宽方案引入的误差（或偏差）$\\Delta F(\\sigma) = F_{\\sigma} - F_{0}$ 如何依赖于费米能 $E_{F}$ 附近态密度 $D(E)$ 的性质。通过对能量泛函进行泰勒展开，可以证明能量偏差中的主要项与展宽核函数 $g(x)$ 的偶数矩 $\\mu_{2n} = \\int_{-\\infty}^{\\infty} x^{2n} g(x)\\,dx$ 以及 DOS 在费米能级的导数 $D^{(m)}(E_{F})$ 成正比。\n\nMethfessel-Paxton 方案的构建正是为了消除这些主要的误差项。一个N阶MP方案的设计使得偶数矩 $\\mu_{2}, \\mu_{4}, \\dots, \\mu_{2N}$ 皆为零。这系统地抵消了与DOS曲率 $D''(E_F)$ 及其更高阶偶次导数耦合的偏差项。相比之下，其他方法如高斯展宽或指定的冷展宽则没有抵消这些矩。对于巨势而言，这类方法的主要误差通常与 $\\mu_{2}\\sigma^{2}D'(E_{F})$ 成正比，而对于总能量，其误差与 $\\sigma^2 D''(E_F)$ 相关，当 DOS 在 $E_F$ 处具有显著结构时，误差会变大。本问题设置了一个场景（范霍夫奇异点），其中 $D(E)$ 具有非常高的曲率，这是展示 MP 方法优越性的理想情况。\n\n我们的数值计算过程将包括以下步骤：\n1.  推导 Methfessel-Paxton 二阶 ($N=2$) 情况的占据数函数 $f_{\\mathrm{MP2}}(x)$ 的显式函数形式。\n2.  定义数值k点网格，并为每个测试用例计算此网格上的能量色散 $\\varepsilon(\\mathbf{k})$。\n3.  通过对能量低于或等于费米能级的所有能量求和来计算精确的零温能量 $F_{0}$。\n4.  通过对由各自占据数函数加权的能量求和，计算 MP2 和冷展宽方案的展宽能量 $F_{\\sigma}$。\n5.  计算每种方法的能量偏差 $\\Delta F = F_{\\sigma} - F_{0}$，并比较它们的绝对大小以确定哪种“更好”。\n\n**步骤1：Methfessel-Paxton (N=2) 占据数函数的推导**\n\nN阶 MP 核函数由高斯函数 $G(x) = \\frac{1}{\\sqrt{\\pi}}e^{-x^{2}}$ 的导数基底导出，形式为 $g_{\\mathrm{MPN}}(x) = \\sum_{n=0}^{N} c_{n} G^{(2n)}(x)$。占据数函数为 $f(x) = \\int_{x}^{\\infty} g(u)\\,du$。对于 $n0$，$\\int_{x}^{\\infty} G^{(2n)}(u)\\,du = -G^{(2n-1)}(x)$。对于 $n=0$，$\\int_{x}^{\\infty} G(u)\\,du = \\frac{1}{2}\\mathrm{erfc}(x)$。\n因此，占据数函数为：\n$$\nf_{\\mathrm{MPN}}(x) = c_{0} \\frac{1}{2}\\mathrm{erfc}(x) - \\sum_{n=1}^{N} c_{n} G^{(2n-1)}(x)\n$$\n使用关系 $G^{(m)}(x) = \\frac{(-1)^m}{\\sqrt{\\pi}} H_m(x) e^{-x^2}$，其中 $H_m(x)$ 是物理学家定义的埃尔米特多项式，上式变为：\n$$\nf_{\\mathrm{MPN}}(x) = c_{0} \\frac{1}{2}\\mathrm{erfc}(x) + \\frac{e^{-x^2}}{\\sqrt{\\pi}} \\sum_{n=1}^{N} c_{n} H_{2n-1}(x)\n$$\nN阶的系数 $c_n$ 由 $c_n = \\frac{(-1)^n}{2^{2n} n!}$ 给出。对于 $N=2$，我们有：\n$c_{0} = \\frac{(-1)^0}{2^0 0!} = 1$\n$c_{1} = \\frac{(-1)^1}{2^2 1!} = -\\frac{1}{4}$\n$c_{2} = \\frac{(-1)^2}{2^4 2!} = \\frac{1}{32}$\n\n所需的埃尔米特多项式为 $H_1(x) = 2x$ 和 $H_3(x) = 8x^3 - 12x$。将它们代入 $f_{\\mathrm{MP2}}(x)$ 的公式中：\n$$\nf_{\\mathrm{MP2}}(x) = \\frac{1}{2}\\mathrm{erfc}(x) + \\frac{e^{-x^2}}{\\sqrt{\\pi}} \\left[ \\left(-\\frac{1}{4}\\right) H_1(x) + \\left(\\frac{1}{32}\\right) H_3(x) \\right]\n$$\n$$\nf_{\\mathrm{MP2}}(x) = \\frac{1}{2}\\left(1 - \\mathrm{erf}(x)\\right) + \\frac{e^{-x^2}}{\\sqrt{\\pi}} \\left[ -\\frac{1}{4}(2x) + \\frac{1}{32}(8x^3 - 12x) \\right]\n$$\n$$\nf_{\\mathrm{MP2}}(x) = \\frac{1}{2}\\left(1 - \\mathrm{erf}(x)\\right) + \\frac{e^{-x^2}}{\\sqrt{\\pi}} \\left[ -\\frac{x}{2} + \\frac{x^3}{4} - \\frac{3x}{8} \\right]\n$$\n$$\nf_{\\mathrm{MP2}}(x) = \\frac{1}{2}\\left(1 - \\mathrm{erf}(x)\\right) + \\frac{e^{-x^2}}{\\sqrt{\\pi}} \\left( \\frac{x^3}{4} - \\frac{7x}{8} \\right)\n$$\n冷展宽占据数函数已在问题陈述中直接给出：\n$$\nf_{\\mathrm{cold}}(x) = \\frac{1}{2}\\left[1 - \\operatorname{erf}(x)\\right] + \\frac{x}{\\sqrt{\\pi}}e^{-x^{2}}\n$$\n\n**步骤2：数值设置与计算**\n\n为了准确地表示电子结构，特别是范霍夫奇异点，需要对布里渊区进行精细采样。我们选择了一个 $1000 \\times 1000 = 10^6$ 个k点的正方形网格。这个密集的网格确保了k点上的离散求和能为连续的布里渊区积分提供一个良好收敛的近似，从而足以分辨态密度中的尖锐特征。\n\n对于每个测试用例，算法按以下步骤进行：\n1.  为 $(k_x, k_y)$ 在 $[-\\pi, \\pi] \\times [-\\pi, \\pi]$ 范围内定义一个包含 $N_k = 1000 \\times 1000$ 个点的均匀网格。\n2.  使用紧束缚公式计算网格上每个点的能量 $\\varepsilon(\\mathbf{k})$。\n3.  通过对所有满足 $\\varepsilon(\\mathbf{k}) \\le E_F$ 的能量 $\\varepsilon(\\mathbf{k})$ 求和，然后除以k点总数 $N_k$，来计算零温能量 $F_0$。\n4.  对于 MP2 和冷展宽两种方法：\n    a. 计算标度化能量变量 $x_k = (\\varepsilon(\\mathbf{k}) - E_F) / \\sigma$。\n    b. 对所有k点评估占据数函数 $f(x_k)$。\n    c. 计算展宽能量 $F_\\sigma = \\frac{1}{N_k} \\sum_{\\mathbf{k}} \\varepsilon(\\mathbf{k}) f(x_k)$。\n5.  计算偏差 $\\Delta F_{\\mathrm{MP2}} = F_{\\mathrm{MP2}} - F_0$ 和 $\\Delta F_{\\mathrm{cold}} = F_{\\mathrm{cold}} - F_0$。\n6.  通过比较偏差的绝对值来确定布尔值结果：$|\\Delta F_{\\mathrm{MP2}}|  |\\Delta F_{\\mathrm{cold}}|$。\n\n此过程将对四个指定的测试用例执行，以验证当态密度在费米能级处有强曲率时MP2更优的理论预期。",
            "answer": "```python\nimport numpy as np\nfrom scipy.special import erf\n\ndef solve():\n    \"\"\"\n    Computes and compares the energy bias of MP2 and cold smearing methods\n    for a 2D tight-binding model.\n    \"\"\"\n\n    # Test cases defined in the problem statement.\n    # (t, t', E_F, sigma)\n    test_cases = [\n        (1.0, 0.0, 0.0, 0.15),   # Case 1: Structured DOS near EF\n        (1.0, 0.0, 1.0, 0.15),   # Case 2: Away from van Hove singularity\n        (1.0, 0.30, 0.0, 0.15),  # Case 3: Enhanced curvature via t'\n        (1.0, 0.0, 0.0, 0.05),   # Case 4: Small smearing width\n    ]\n\n    results = []\n\n    # A sufficiently fine grid to resolve the van Hove singularity.\n    num_k_points_1d = 1000\n    total_k_points = num_k_points_1d ** 2\n\n    # Create the k-space grid\n    k_vals = np.linspace(-np.pi, np.pi, num_k_points_1d, endpoint=False)\n    kx, ky = np.meshgrid(k_vals, k_vals)\n\n    for case in test_cases:\n        t, t_prime, E_F, sigma = case\n\n        # Calculate the energy dispersion relation over the k-grid\n        energies = -2 * t * (np.cos(kx) + np.cos(ky)) - 4 * t_prime * np.cos(kx) * np.cos(ky)\n\n        # 1. Calculate the exact zero-temperature energy F_0\n        # The sum of energies for all states with energy = E_F\n        F0 = np.sum(energies[energies = E_F]) / total_k_points\n\n        # Calculate the scaled energy variable x = (E - E_F) / sigma\n        x = (energies - E_F) / sigma\n\n        # 2. Calculate smeared energy for Marzari-Vanderbilt (cold smearing)\n        # f_cold(x) = 1/2 * [1 - erf(x)] + (x / sqrt(pi)) * exp(-x^2)\n        f_cold_vals = 0.5 * (1 - erf(x)) + (x / np.sqrt(np.pi)) * np.exp(-x**2)\n        F_cold = np.sum(energies * f_cold_vals) / total_k_points\n        delta_F_cold = F_cold - F0\n\n        # 3. Calculate smeared energy for Methfessel-Paxton (N=2)\n        # f_mp2(x) = 1/2 * [1 - erf(x)] + (exp(-x^2) / sqrt(pi)) * (x^3/4 - 7x/8)\n        f_mp2_vals = 0.5 * (1 - erf(x)) + (np.exp(-x**2) / np.sqrt(np.pi)) * (x**3 / 4.0 - 7.0 * x / 8.0)\n        F_mp2 = np.sum(energies * f_mp2_vals) / total_k_points\n        delta_F_mp2 = F_mp2 - F0\n\n        # 4. Compare the absolute biases\n        is_mp2_better = np.abs(delta_F_mp2)  np.abs(delta_F_cold)\n        results.append(is_mp2_better)\n\n    # Format the final output as a string representation of a list of Booleans\n    # Capitalize True/False to match standard Python repr\n    output_str = f\"[{','.join(str(r) for r in results)}]\"\n    print(output_str)\n\nsolve()\n```"
        }
    ]
}