{
    "hands_on_practices": [
        {
            "introduction": "任何几何优化算法的核心都在于两个基本决策：选择一个搜索方向，以及确定沿该方向移动的步长。本练习  聚焦于后者，即如何智能地选择步长。通过实现带有 Armijo 条件的回溯线搜索算法，你将亲身体验一种稳健的技术，它能确保每一步都带来“足够”的能量下降，从而避免振荡或发散，保证优化的稳定性。这个编码练习将为你揭示几乎所有现代优化程序内部最关键的逻辑之一。",
            "id": "3454266",
            "problem": "在计算材料科学中，考虑一个一维势能函数，它表示沿单个结构自由度的能量。假设能量函数 $E(x)$ 连续可微，其导数为 $E'(x)$，并且结构弛豫通过 $x_{k+1} = x_k + t_k d_k$ 的形式进行迭代更新，其中 $d_k$ 是下降方向，$t_k$ 是步长。实现带有 Armijo 充分下降条件的回溯线搜索 (BLS)，以选择每个 $t_k$，从初始步长 $t_{\\mathrm{init}}$ 开始。下降方向必须选择为 $d_k = -E'(x_k)$，并且必须使用参数 $c \\in (0,1)$ 和用于回溯的收缩因子 $\\tau \\in (0,1)$ 来强制执行 Armijo 充分下降条件。每次迭代从 $t = t_{\\mathrm{init}}$ 开始，并以 $t \\leftarrow \\tau t$ 的方式缩减步长，直到满足充分下降条件或达到最小允许步长 $t_{\\min}$。如果对于指定的容差 $\\varepsilon$，有 $|E'(x_k)| \\le \\varepsilon$，则终止该次迭代，不执行步进。如果在满足充分下降条件之前，$t$ 的值降至 $t_{\\min}$ 以下，则终止更新。最多执行 $N_{\\max}$ 次几何迭代。对于每个测试用例，返回所接受的步长序列 $\\{t_k\\}$。\n\n您的程序必须实现上述过程，并为以下四个用纯数学术语编写的、科学上合理的测试用例，生成每个用例所接受的步长序列：\n\n- 测试用例 1 (强凸二次型): \n  - 能量 $E_1(x) = \\tfrac{1}{2}(x - a)^2$，其中 $a = 2$。\n  - 导数 $E_1'(x) = x - a$。\n  - 初始点 $x_0 = -3$。\n  - 参数 $t_{\\mathrm{init}} = 1$, $\\tau = \\tfrac{1}{2}$, $c = 10^{-4}$, $\\varepsilon = 10^{-10}$, $t_{\\min} = 10^{-14}$, $N_{\\max} = 5$。\n\n- 测试用例 2 (带倾斜的非凸双势阱):\n  - 能量 $E_2(x) = (x^2 - 1)^2 + \\gamma x$，其中 $\\gamma = 0.05$。\n  - 导数 $E_2'(x) = 4x(x^2 - 1) + \\gamma$。\n  - 初始点 $x_0 = 0$。\n  - 参数 $t_{\\mathrm{init}} = 1$, $\\tau = 0.7$, $c = 10^{-3}$, $\\varepsilon = 10^{-10}$, $t_{\\min} = 10^{-14}$, $N_{\\max} = 8$。\n\n- 测试用例 3 (对数型，原点附近平坦):\n  - 能量 $E_3(x) = \\ln(1 + x^2)$。\n  - 导数 $E_3'(x) = \\dfrac{2x}{1 + x^2}$。\n  - 初始点 $x_0 = 0.1$。\n  - 参数 $t_{\\mathrm{init}} = 10$, $\\tau = \\tfrac{1}{2}$, $c = 10^{-4}$, $\\varepsilon = 10^{-12}$, $t_{\\min} = 10^{-14}$, $N_{\\max} = 6$。\n\n- 测试用例 4 (起始点为平坦极小值):\n  - 能量 $E_4(x) = (x - 1)^4$。\n  - 导数 $E_4'(x) = 4(x - 1)^3$。\n  - 初始点 $x_0 = 1$。\n  - 参数 $t_{\\mathrm{init}} = 1$, $\\tau = \\tfrac{1}{2}$, $c = 10^{-4}$, $\\varepsilon = 10^{-12}$, $t_{\\min} = 10^{-14}$, $N_{\\max} = 5$。\n\n使用无量纲量；不需要物理单位。不涉及角度。对于每个测试用例，计算由带有 Armijo 条件的回溯线搜索生成的已接受步长序列 $\\{t_k\\}$，直到因梯度容差、最小步长阈值或最大迭代次数而终止。您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果，每个元素是对应一个测试用例的浮点数列表（例如，$[ [t_{1,0}, t_{1,1}, \\dots], [t_{2,0}, \\dots], [\\dots], [\\dots] ]$）。每个测试用例的答案必须是一个浮点数列表。设计您的实现时，请确保其数值稳定，并严格遵循所述过程。",
            "solution": "所提出的问题是数值优化领域中一个明确定义的任务，特别是在计算材料科学的背景下，它被称为结构弛豫或几何优化。目标是确定一个最速下降算法所产生的接受步长序列 $\\{t_k\\}$，该算法配备了强制执行 Armijo 充分下降条件的回溯线搜索。该过程将应用于四个不同的一维势能函数 $E(x)$，每个函数代表一种不同的物理情景。\n\n对问题陈述的验证证实了其科学上的合理性、自洽性以及算法上的明确性。它坚实地植根于无约束数值优化的基本原理。所有函数、参数和终止标准都已明确定义，确保每个测试用例都存在唯一且可验证的解。因此，可以构建一个合理的解。\n\n结构弛豫的核心在于寻找势能面 $E(\\mathbf{r})$ 的一个局部最小值，其中 $\\mathbf{r}$ 代表组成原子的坐标。对于一维情况，这简化为寻找一个使 $E(x)$ 最小化的 $x$。这被表述为一个无约束优化问题。基于梯度的方法通过将当前位置 $x_k$ 迭代更新到一个能量更低的新位置 $x_{k+1}$ 来解决此问题。这种更新的一般形式是：\n$$x_{k+1} = x_k + t_k d_k$$\n其中 $k$ 是迭代指数，$d_k$ 是搜索方向，$t_k > 0$ 是步长或步幅。\n\n收敛的一个关键要求是 $d_k$ 必须是下降方向，这意味着它必须与负梯度方向成锐角，以确保沿该方向的小步长会降低能量。这可以正式表述为 $E'(x_k) d_k  0$。问题指定使用最速下降法，其中搜索方向被选择为与能量函数的梯度方向相反：\n$$d_k = -E'(x_k)$$\n这个选择保证了下降方向，因为 $E'(x_k) d_k = E'(x_k) (-E'(x_k)) = -(E'(x_k))^2 \\le 0$。除非梯度为零，即 $E'(x_k)=0$（这是驻点（最小值、最大值或鞍点）的条件），否则下降是严格的。\n\n一旦确定了下降方向 $d_k$，就必须找到一个合适的步长 $t_k$。步长太小会导致收敛缓慢，而步长太大则可能“越过”最小值点并导致能量增加。线搜索是用于寻找合适 $t_k$ 的一种算法。问题要求使用强制执行 Armijo 充分下降条件的回溯线搜索 (BLS) 算法。\n\nArmijo 条件确保步长 $t$ 能带来能量的充分下降，而不仅仅是无穷小的下降。它表述为：\n$$E(x_k + t d_k) \\le E(x_k) + c t E'(x_k) d_k$$\n其中 $c$ 是区间 $(0, 1)$ 内的一个小常数，通常在 $10^{-4}$ 的数量级。右侧项定义了一条斜率比初始方向导数 $E'(x_k) d_k$ 更平缓的直线，为所需的能量下降提供了一个“缓冲”。代入最速下降方向 $d_k = -E'(x_k)$，我们问题的条件变为：\n$$E(x_k - t E'(x_k)) \\le E(x_k) - c t (E'(x_k))^2$$\n\nBLS 算法在每次迭代 $k$ 中的操作如下：\n1. 将试探步长 $t$ 初始化为预定义的初始值，$t \\leftarrow t_{\\mathrm{init}}$。\n2. 检查当前 $t$ 是否满足 Armijo 条件。\n3. 如果满足条件，则接受此 $t$ 作为当前迭代的步长 $t_k$，并终止线搜索。\n4. 如果不满足，则通过收缩因子 $\\tau \\in (0, 1)$ 减小步长，即 $t \\leftarrow \\tau t$，然后返回第 2 步。\n5. 重复此过程，直到找到合适的 $t$ 或 $t$ 小于最小阈值 $t_{\\min}$，此时认为优化未能取得进展并终止。\n\n整个几何优化过程将最速下降方向与 BLS 结合起来。指定的完整算法如下：对于 $k = 0, 1, 2, \\dots, N_{\\max}-1$：\n1. 计算梯度（力）$g_k = E'(x_k)$。\n2. 检查收敛性：如果 $|g_k| \\le \\varepsilon$，其中 $\\varepsilon$ 是一个很小的容差，则认为系统处于局部最小值。优化终止。这将产生一个包含 $k$ 个已接受步长的序列 $\\{t_0, t_1, \\dots, t_{k-1}\\}$。\n3. 如果未收敛，则执行回溯线搜索以找到满足 Armijo 条件的步长 $t_k$。搜索从 $t=t_{\\mathrm{init}}$ 开始，并以因子 $\\tau$ 进行收缩。\n4. 如果线搜索循环导致 $t$ 降至 $t_{\\min}$ 以下，则立即终止优化，不更新位置。已接受的步长序列为 $\\{t_0, t_1, \\dots, t_{k-1}\\}$。\n5. 如果找到一个有效的步长 $t_k \\ge t_{\\min}$，则更新位置：$x_{k+1} = x_k - t_k g_k$。\n6. 记录已接受的步长 $t_k$。\n7. 如果循环完成 $N_{\\max}$ 次迭代，过程终止。\n\n这个结构化过程将为四个指定的测试用例中的每一个实现。每个用例的函数和参数如下：\n- 用例 1：一个简单的强凸二次势，$E_1(x) = \\tfrac{1}{2}(x - a)^2$，其中 $a = 2$。对于此函数，采用精确线搜索的最速下降法将在一步内收敛。使用 $t_{\\mathrm{init}}=1$ 的回溯线搜索也恰好在第一次尝试时就找到了最优步长。\n- 用例 2：一个非凸双势阱，$E_2(x) = (x^2 - 1)^2 + \\gamma x$，其中 $\\gamma = 0.05$。这测试了算法在更复杂的能量形貌中导航的能力。\n- 用例 3：一个对数势，$E_3(x) = \\ln(1 + x^2)$，它在其最小值 $x=0$ 附近有一个非常平坦的区域，用于测试梯度很小时的收敛行为。\n- 用例 4：一个四次势，$E_4(x) = (x - 1)^4$。这个用例很特殊，因为初始位置 $x_0=1$ 已经处于最小值点，其导数恰好为零。算法应该能够识别这一点并立即终止，不执行任何步进。\n\n实现将包括一个主优化函数，该函数协调此迭代过程，以及一组能量函数及其导数的定义。最终输出将是为四个用例中的每一个收集到的已接受步长序列，并按指定格式进行格式化。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef run_optimization(E, E_prime, x0, t_init, tau, c, epsilon, t_min, N_max):\n    \"\"\"\n    Performs geometry optimization using steepest descent with backtracking line search.\n\n    Args:\n        E (callable): The energy function E(x).\n        E_prime (callable): The derivative of the energy function E'(x).\n        x0 (float): The initial position.\n        t_init (float): The initial step size for backtracking.\n        tau (float): The contraction factor for backtracking.\n        c (float): The Armijo condition parameter.\n        epsilon (float): The gradient tolerance for convergence.\n        t_min (float): The minimum allowable step size.\n        N_max (int): The maximum number of iterations.\n\n    Returns:\n        list[float]: The sequence of accepted step sizes.\n    \"\"\"\n    x = x0\n    accepted_steps = []\n\n    for k in range(N_max):\n        # 1. Calculate gradient (force)\n        grad = E_prime(x)\n\n        # 2. Check for convergence based on gradient magnitude\n        if abs(grad) = epsilon:\n            break\n\n        # 3. Perform Backtracking Line Search (BLS)\n        t = t_init\n        current_energy = E(x)\n        grad_sq = grad**2\n        \n        found_step = False\n        while True:\n            # Check if step size has fallen below the minimum threshold\n            if t  t_min:\n                # If t is too small, terminate the entire optimization process as per problem spec\n                return accepted_steps\n\n            # Proposed new position\n            x_new = x - t * grad\n            new_energy = E(x_new)\n            \n            # Armijo sufficient decrease condition\n            # E(x_k - t * E'(x_k)) = E(x_k) - c * t * (E'(x_k))^2\n            if new_energy = current_energy - c * t * grad_sq:\n                accepted_t = t\n                found_step = True\n                break\n            else:\n                # Backtrack: contract the step size\n                t *= tau\n        \n        # This part of the code should only be reached if a valid step was found.\n        # The return in the while loop handles the t  t_min termination.\n\n        # 4. Update position and record the accepted step size\n        x = x - accepted_t * grad\n        accepted_steps.append(accepted_t)\n\n    return accepted_steps\n\ndef solve():\n    \"\"\"\n    Defines and runs the four test cases for the optimization problem.\n    \"\"\"\n    test_cases = [\n        # Test case 1 (strongly convex quadratic)\n        {\n            \"E\": lambda x: 0.5 * (x - 2.0)**2,\n            \"E_prime\": lambda x: x - 2.0,\n            \"x0\": -3.0,\n            \"params\": {\n                \"t_init\": 1.0, \"tau\": 0.5, \"c\": 1e-4, \n                \"epsilon\": 1e-10, \"t_min\": 1e-14, \"N_max\": 5\n            }\n        },\n        # Test case 2 (nonconvex double-well with tilt)\n        {\n            \"E\": lambda x: (x**2 - 1.0)**2 + 0.05 * x,\n            \"E_prime\": lambda x: 4.0 * x * (x**2 - 1.0) + 0.05,\n            \"x0\": 0.0,\n            \"params\": {\n                \"t_init\": 1.0, \"tau\": 0.7, \"c\": 1e-3, \n                \"epsilon\": 1e-10, \"t_min\": 1e-14, \"N_max\": 8\n            }\n        },\n        # Test case 3 (logarithmic, flat near origin)\n        {\n            \"E\": lambda x: np.log(1.0 + x**2),\n            \"E_prime\": lambda x: (2.0 * x) / (1.0 + x**2),\n            \"x0\": 0.1,\n            \"params\": {\n                \"t_init\": 10.0, \"tau\": 0.5, \"c\": 1e-4, \n                \"epsilon\": 1e-12, \"t_min\": 1e-14, \"N_max\": 6\n            }\n        },\n        # Test case 4 (flat minimum at start point)\n        {\n            \"E\": lambda x: (x - 1.0)**4,\n            \"E_prime\": lambda x: 4.0 * (x - 1.0)**3,\n            \"x0\": 1.0,\n            \"params\": {\n                \"t_init\": 1.0, \"tau\": 0.5, \"c\": 1e-4, \n                \"epsilon\": 1e-12, \"t_min\": 1e-14, \"N_max\": 5\n            }\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        steps = run_optimization(case[\"E\"], case[\"E_prime\"], case[\"x0\"], **case[\"params\"])\n        # Format the list of floats to be compatible with str() representation\n        results.append(steps)\n    \n    # Final print statement in the exact required format.\n    # The str() of a list automatically produces the required format '[item1, item2, ...]'\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "在掌握了如何确定步长后，一个更高级的问题是如何选择比最速下降法更优的搜索方向。本练习  引导你探索拟牛顿法，这是一类强大的算法，通过迭代来近似能量形貌的曲率（即Hessian矩阵）。通过为一个简单的二维二次函数手动执行BFGS（Broyden–Fletcher–Goldfarb–Shanno）算法的更新步骤，你将直观地理解该算法是如何“学习”并构建一个精确的逆Hessian矩阵近似，从而实现更高效的收敛。",
            "id": "3454267",
            "problem": "考虑计算材料科学中的一个结构弛豫步骤，该步骤通过最小化总能量的谐波近似来建模。设二维能量由二次函数 $E(\\mathbf{x}) = \\tfrac{1}{2}\\,\\mathbf{x}^{\\mathsf{T}}\\mathbf{A}\\,\\mathbf{x} + \\mathbf{b}^{\\mathsf{T}}\\mathbf{x}$ 给出，其中 $\\mathbf{x} \\in \\mathbb{R}^{2}$ 包含了两个耦合的几何自由度。假设对称正定 Hessian 矩阵 $\\mathbf{A}$ 和线性项 $\\mathbf{b}$ 已知，并由 $\\mathbf{A} = \\begin{pmatrix} 4  1 \\\\ 1  3 \\end{pmatrix}$ 和 $\\mathbf{b} = \\begin{pmatrix} -2 \\\\ 5 \\end{pmatrix}$ 给出。从初始构型 $\\mathbf{x}_{0} = \\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix}$ 和初始逆 Hessian 近似 $\\mathbf{H}_{0} = \\mathbf{I}_{2}$ 开始，其中 $\\mathbf{I}_{2}$ 是 $2 \\times 2$ 单位矩阵。\n\n使用逆形式更新和精确线搜索，沿着每次迭代 $k$ 的搜索方向 $\\mathbf{p}_{k} = -\\mathbf{H}_{k}\\,\\nabla E(\\mathbf{x}_{k})$，执行两轮 Broyden–Fletcher–Goldfarb–Shanno (BFGS) 方法。在每次迭代中，计算步长 $\\mathbf{s}_{k} = \\alpha_{k}\\,\\mathbf{p}_{k}$，其中精确线搜索参数 $\\alpha_{k}$ 的选择是为了最小化关于实数 $\\alpha$ 的 $E(\\mathbf{x}_{k} + \\alpha\\,\\mathbf{p}_{k})$，然后计算梯度差 $\\mathbf{y}_{k} = \\nabla E(\\mathbf{x}_{k+1}) - \\nabla E(\\mathbf{x}_{k})$，接着更新逆 Hessian 近似以获得 $\\mathbf{H}_{1}$ 和 $\\mathbf{H}_{2}$。展示这两次迭代得到的显式矩阵 $\\mathbf{H}_{1}$ 和 $\\mathbf{H}_{2}$。\n\n最后，计算 $\\mathbf{H}_{2}$ 的迹 $\\operatorname{tr}(\\mathbf{H}_{2})$ 并将其作为最终答案。将最终答案表示为单个精确的有理数，不进行四舍五入，不带单位。",
            "solution": "该问题是有效的，因为它提出了一个基于计算材料科学和数值分析的既定原则的适定数值优化任务。所有必要的数据都已提供，并且该问题没有科学缺陷、矛盾或歧义。\n\n总能量由二次函数 $E(\\mathbf{x}) = \\frac{1}{2}\\,\\mathbf{x}^{\\mathsf{T}}\\mathbf{A}\\,\\mathbf{x} + \\mathbf{b}^{\\mathsf{T}}\\mathbf{x}$ 给出。BFGS 算法需要能量函数 $\\nabla E(\\mathbf{x})$ 的梯度。它由下式给出：\n$$\n\\nabla E(\\mathbf{x}) = \\mathbf{A}\\,\\mathbf{x} + \\mathbf{b}\n$$\nBFGS 算法迭代地优化位置 $\\mathbf{x}_{k}$ 和逆 Hessian 近似 $\\mathbf{H}_{k}$。更新规则如下：\n1.  计算梯度：$\\mathbf{g}_{k} = \\nabla E(\\mathbf{x}_{k})$。\n2.  计算搜索方向：$\\mathbf{p}_{k} = -\\mathbf{H}_{k}\\,\\mathbf{g}_{k}$。\n3.  通过精确线搜索找到步长大小 $\\alpha_{k}$，以最小化 $E(\\mathbf{x}_{k} + \\alpha\\,\\mathbf{p}_{k})$。对于二次能量函数，这由下式给出：\n    $$\n    \\alpha_{k} = -\\frac{\\mathbf{g}_{k}^{\\mathsf{T}}\\mathbf{p}_{k}}{\\mathbf{p}_{k}^{\\mathsf{T}}\\mathbf{A}\\,\\mathbf{p}_{k}}\n    $$\n4.  更新位置：$\\mathbf{x}_{k+1} = \\mathbf{x}_{k} + \\mathbf{s}_{k}$，其中 $\\mathbf{s}_{k} = \\alpha_{k}\\mathbf{p}_{k}$。\n5.  计算新梯度和梯度差：$\\mathbf{g}_{k+1} = \\nabla E(\\mathbf{x}_{k+1})$ 和 $\\mathbf{y}_{k} = \\mathbf{g}_{k+1} - \\mathbf{g}_{k}$。\n6.  使用逆 BFGS 公式更新逆 Hessian 近似：\n    $$\n    \\mathbf{H}_{k+1} = \\mathbf{H}_{k} + \\frac{(\\mathbf{s}_{k}^{\\mathsf{T}}\\mathbf{y}_{k} + \\mathbf{y}_{k}^{\\mathsf{T}}\\mathbf{H}_{k}\\mathbf{y}_{k})}{(\\mathbf{s}_{k}^{\\mathsf{T}}\\mathbf{y}_{k})^2} (\\mathbf{s}_{k} \\mathbf{s}_{k}^{\\mathsf{T}}) - \\frac{\\mathbf{H}_{k}\\mathbf{y}_{k}\\mathbf{s}_{k}^{\\mathsf{T}} + \\mathbf{s}_{k}\\mathbf{y}_{k}^{\\mathsf{T}}\\mathbf{H}_{k}}{\\mathbf{s}_{k}^{\\mathsf{T}}\\mathbf{y}_{k}}\n    $$\n\n我们已知：\n$\\mathbf{A} = \\begin{pmatrix} 4  1 \\\\ 1  3 \\end{pmatrix}$，$\\mathbf{b} = \\begin{pmatrix} -2 \\\\ 5 \\end{pmatrix}$，$\\mathbf{x}_{0} = \\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix}$，以及 $\\mathbf{H}_{0} = \\mathbf{I}_{2} = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix}$。\n\n**迭代 $0$ (求 $\\mathbf{H}_{1}$)**\n\n1.  在 $\\mathbf{x}_{0}$ 处的梯度：\n    $\\mathbf{g}_{0} = \\mathbf{A}\\,\\mathbf{x}_{0} + \\mathbf{b} = \\begin{pmatrix} 4  1 \\\\ 1  3 \\end{pmatrix}\\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix} + \\begin{pmatrix} -2 \\\\ 5 \\end{pmatrix} = \\begin{pmatrix} 3 \\\\ -2 \\end{pmatrix} + \\begin{pmatrix} -2 \\\\ 5 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 3 \\end{pmatrix}$。\n2.  搜索方向 $\\mathbf{p}_{0}$：\n    $\\mathbf{p}_{0} = -\\mathbf{H}_{0}\\,\\mathbf{g}_{0} = -\\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix}\\begin{pmatrix} 1 \\\\ 3 \\end{pmatrix} = \\begin{pmatrix} -1 \\\\ -3 \\end{pmatrix}$。\n3.  步长大小 $\\alpha_{0}$：\n    分子：$-\\mathbf{g}_{0}^{\\mathsf{T}}\\mathbf{p}_{0} = -\\begin{pmatrix} 1  3 \\end{pmatrix}\\begin{pmatrix} -1 \\\\ -3 \\end{pmatrix} = -(-1-9) = 10$。\n    分母：$\\mathbf{A}\\mathbf{p}_{0} = \\begin{pmatrix} 4  1 \\\\ 1  3 \\end{pmatrix}\\begin{pmatrix} -1 \\\\ -3 \\end{pmatrix} = \\begin{pmatrix} -7 \\\\ -10 \\end{pmatrix}$。\n    $\\mathbf{p}_{0}^{\\mathsf{T}}\\mathbf{A}\\mathbf{p}_{0} = \\begin{pmatrix} -1  -3 \\end{pmatrix}\\begin{pmatrix} -7 \\\\ -10 \\end{pmatrix} = 7+30 = 37$。\n    $\\alpha_{0} = \\frac{10}{37}$。\n4.  位置更新：\n    $\\mathbf{s}_{0} = \\alpha_{0}\\mathbf{p}_{0} = \\frac{10}{37}\\begin{pmatrix} -1 \\\\ -3 \\end{pmatrix} = \\begin{pmatrix} -10/37 \\\\ -30/37 \\end{pmatrix}$。\n    $\\mathbf{x}_{1} = \\mathbf{x}_{0} + \\mathbf{s}_{0} = \\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix} + \\begin{pmatrix} -10/37 \\\\ -30/37 \\end{pmatrix} = \\begin{pmatrix} 27/37 \\\\ -67/37 \\end{pmatrix}$。\n5.  梯度差：\n    $\\mathbf{g}_{1} = \\mathbf{A}\\,\\mathbf{x}_{1} + \\mathbf{b} = \\frac{1}{37}\\begin{pmatrix} 4  1 \\\\ 1  3 \\end{pmatrix}\\begin{pmatrix} 27 \\\\ -67 \\end{pmatrix} + \\begin{pmatrix} -2 \\\\ 5 \\end{pmatrix} = \\frac{1}{37}\\begin{pmatrix} 41 \\\\ -174 \\end{pmatrix} + \\frac{1}{37}\\begin{pmatrix} -74 \\\\ 185 \\end{pmatrix} = \\frac{1}{37}\\begin{pmatrix} -33 \\\\ 11 \\end{pmatrix}$。\n    $\\mathbf{y}_{0} = \\mathbf{g}_{1} - \\mathbf{g}_{0} = \\frac{1}{37}\\begin{pmatrix} -33 \\\\ 11 \\end{pmatrix} - \\begin{pmatrix} 1 \\\\ 3 \\end{pmatrix} = \\frac{1}{37}\\begin{pmatrix} -70 \\\\ -100 \\end{pmatrix}$。\n6.  $\\mathbf{H}_{1}$ 的逆 Hessian 更新：\n    我们需要 $\\mathbf{s}_{0}^{\\mathsf{T}}\\mathbf{y}_{0}$ 和 $\\mathbf{y}_{0}^{\\mathsf{T}}\\mathbf{H}_{0}\\mathbf{y}_{0} = \\mathbf{y}_{0}^{\\mathsf{T}}\\mathbf{y}_{0}$ (因为 $\\mathbf{H}_{0}=\\mathbf{I}$)。\n    $\\mathbf{s}_{0}^{\\mathsf{T}}\\mathbf{y}_{0} = \\frac{10}{37}\\begin{pmatrix} -1  -3 \\end{pmatrix} \\frac{1}{37}\\begin{pmatrix} -70 \\\\ -100 \\end{pmatrix} = \\frac{10}{37^2}(70+300) = \\frac{3700}{1369} = \\frac{100}{37}$。\n    $\\mathbf{y}_{0}^{\\mathsf{T}}\\mathbf{y}_{0} = \\frac{1}{37^2}\\begin{pmatrix} -70  -100 \\end{pmatrix}\\begin{pmatrix} -70 \\\\ -100 \\end{pmatrix} = \\frac{1}{1369}(4900+10000) = \\frac{14900}{1369}$。\n    使用 $\\mathbf{H}_{0}=\\mathbf{I}$ 的更新公式：\n    $\\mathbf{H}_{1} = \\mathbf{I} + \\frac{\\frac{100}{37} + \\frac{14900}{1369}}{(\\frac{100}{37})^2} (\\mathbf{s}_{0} \\mathbf{s}_{0}^{\\mathsf{T}}) - \\frac{\\mathbf{y}_{0}\\mathbf{s}_{0}^{\\mathsf{T}} + \\mathbf{s}_{0}\\mathbf{y}_{0}^{\\mathsf{T}}}{\\frac{100}{37}}$。\n    $\\mathbf{s}_{0}\\mathbf{s}_{0}^{\\mathsf{T}}$ 的系数是 $\\frac{\\frac{100 \\cdot 37 + 14900}{1369}}{\\frac{10000}{1369}} = \\frac{3700+14900}{10000} = \\frac{18600}{10000} = \\frac{186}{100} = \\frac{93}{50}$。\n    $\\mathbf{s}_{0} \\mathbf{s}_{0}^{\\mathsf{T}} = (\\frac{10}{37})^2 \\begin{pmatrix} 1  3 \\\\ 3  9 \\end{pmatrix} = \\frac{100}{1369}\\begin{pmatrix} 1  3 \\\\ 3  9 \\end{pmatrix}$。\n    第一项：$\\frac{93}{50} \\frac{100}{1369}\\begin{pmatrix} 1  3 \\\\ 3  9 \\end{pmatrix} = \\frac{186}{1369}\\begin{pmatrix} 1  3 \\\\ 3  9 \\end{pmatrix}$。\n    $\\mathbf{s}_{0}\\mathbf{y}_{0}^{\\mathsf{T}} = \\frac{10}{37^2}\\begin{pmatrix} -1 \\\\ -3 \\end{pmatrix} \\begin{pmatrix} -70  -100 \\end{pmatrix} = \\frac{10}{1369}\\begin{pmatrix} 70  100 \\\\ 210  300 \\end{pmatrix}$。\n    交叉项：$-\\frac{37}{100} \\frac{10}{1369} \\left( \\begin{pmatrix} 70  100 \\\\ 210  300 \\end{pmatrix} + \\begin{pmatrix} 70  210 \\\\ 100  300 \\end{pmatrix} \\right) = -\\frac{370}{136900} \\begin{pmatrix} 140  310 \\\\ 310  600 \\end{pmatrix} = -\\frac{1}{370} \\begin{pmatrix} 140  310 \\\\ 310  600 \\end{pmatrix} = -\\frac{1}{37}\\begin{pmatrix} 14  31 \\\\ 31  60 \\end{pmatrix}$。\n    $\\mathbf{H}_{1} = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} + \\frac{1}{1369} \\begin{pmatrix} 186  558 \\\\ 558  1674 \\end{pmatrix} - \\frac{37}{1369}\\begin{pmatrix} 14  31 \\\\ 31  60 \\end{pmatrix}$。\n    $\\mathbf{H}_{1} = \\frac{1}{1369} \\left( \\begin{pmatrix} 1369  0 \\\\ 0  1369 \\end{pmatrix} + \\begin{pmatrix} 186  558 \\\\ 558  1674 \\end{pmatrix} - \\begin{pmatrix} 518  1147 \\\\ 1147  2220 \\end{pmatrix} \\right)$。\n    $\\mathbf{H}_{1} = \\frac{1}{1369}\\begin{pmatrix} 1037  -589 \\\\ -589  823 \\end{pmatrix}$。\n\n**迭代 $1$ (求 $\\mathbf{H}_{2}$)**\n\n对于一个 $N$ 维二次函数，使用精确线搜索的 BFGS 方法至多在 $N$ 次迭代内找到最小值。对于这个二维问题，$\\mathbf{x}_{2}$ 将是精确的最小值，而 $\\mathbf{H}_{2}$ 将是精确的逆 Hessian 矩阵 $\\mathbf{A}^{-1}$。我们通过计算来验证这一点。\n\n1.  搜索方向 $\\mathbf{p}_{1}$：\n    $\\mathbf{p}_{1} = -\\mathbf{H}_{1}\\,\\mathbf{g}_{1} = -\\frac{1}{1369}\\begin{pmatrix} 1037  -589 \\\\ -589  823 \\end{pmatrix} \\frac{1}{37}\\begin{pmatrix} -33 \\\\ 11 \\end{pmatrix} = -\\frac{11}{1369 \\cdot 37}\\begin{pmatrix} 1037  -589 \\\\ -589  823 \\end{pmatrix}\\begin{pmatrix} -3 \\\\ 1 \\end{pmatrix}$。\n    矩阵向量积是 $\\begin{pmatrix} -3111 - 589 \\\\ 1767 + 823 \\end{pmatrix} = \\begin{pmatrix} -3700 \\\\ 2590 \\end{pmatrix} = 37\\begin{pmatrix} -100 \\\\ 70 \\end{pmatrix}$。\n    $\\mathbf{p}_{1} = -\\frac{11 \\cdot 37}{1369 \\cdot 37}\\begin{pmatrix} -100 \\\\ 70 \\end{pmatrix} = \\frac{11}{1369}\\begin{pmatrix} 100 \\\\ -70 \\end{pmatrix} = \\frac{110}{1369}\\begin{pmatrix} 10 \\\\ -7 \\end{pmatrix}$。\n2.  步长大小 $\\alpha_{1}$：\n    分子：$-\\mathbf{g}_{1}^{\\mathsf{T}}\\mathbf{p}_{1} = -\\frac{1}{37}\\begin{pmatrix} -33  11 \\end{pmatrix} \\frac{110}{1369}\\begin{pmatrix} 10 \\\\ -7 \\end{pmatrix} = -\\frac{11 \\cdot 110}{37 \\cdot 1369}\\begin{pmatrix} -3  1 \\end{pmatrix}\\begin{pmatrix} 10 \\\\ -7 \\end{pmatrix} = -\\frac{1210}{50653}(-30-7) = \\frac{1210 \\cdot 37}{50653} = \\frac{1210}{1369}$。\n    分母：$\\mathbf{A}\\mathbf{p}_{1} = \\frac{110}{1369}\\begin{pmatrix} 4  1 \\\\ 1  3 \\end{pmatrix}\\begin{pmatrix} 10 \\\\ -7 \\end{pmatrix} = \\frac{110}{1369}\\begin{pmatrix} 33 \\\\ -11 \\end{pmatrix}$。\n    $\\mathbf{p}_{1}^{\\mathsf{T}}\\mathbf{A}\\mathbf{p}_{1} = \\frac{110^2}{1369^2}\\begin{pmatrix} 10  -7 \\end{pmatrix} \\begin{pmatrix} 33 \\\\ -11 \\end{pmatrix} = \\frac{12100}{1369^2}(330+77) = \\frac{12100 \\cdot 407}{1369^2} = \\frac{12100 \\cdot 11 \\cdot 37}{(37^2)^2} = \\frac{133100}{37^3}$。\n    $\\alpha_{1} = \\frac{1210/37^2}{133100/37^3} = \\frac{1210 \\cdot 37}{133100} = \\frac{121 \\cdot 37}{13310} = \\frac{37}{110}$。\n3.  位置更新：\n    $\\mathbf{s}_{1} = \\alpha_{1}\\mathbf{p}_{1} = \\frac{37}{110}\\frac{110}{1369}\\begin{pmatrix} 10 \\\\ -7 \\end{pmatrix} = \\frac{37}{1369}\\begin{pmatrix} 10 \\\\ -7 \\end{pmatrix} = \\frac{1}{37}\\begin{pmatrix} 10 \\\\ -7 \\end{pmatrix}$。\n    $\\mathbf{x}_{2} = \\mathbf{x}_{1} + \\mathbf{s}_{1} = \\begin{pmatrix} 27/37 \\\\ -67/37 \\end{pmatrix} + \\begin{pmatrix} 10/37 \\\\ -7/37 \\end{pmatrix} = \\begin{pmatrix} 37/37 \\\\ -74/37 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ -2 \\end{pmatrix}$。\n    这是精确的最小值，因为 $\\nabla E(\\mathbf{x}_{2}) = \\mathbf{A}\\mathbf{x}_{2}+\\mathbf{b} = \\begin{pmatrix} 4  1 \\\\ 1  3 \\end{pmatrix}\\begin{pmatrix} 1 \\\\ -2 \\end{pmatrix} + \\begin{pmatrix} -2 \\\\ 5 \\end{pmatrix} = \\begin{pmatrix} 2 \\\\ -5 \\end{pmatrix}+\\begin{pmatrix} -2 \\\\ 5 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}$。\n4.  $\\mathbf{H}_{2}$ 的逆 Hessian 更新：\n    关于二次函数的定理指出 $\\mathbf{H}_{2} = \\mathbf{A}^{-1}$。\n    $\\mathbf{A}^{-1} = \\frac{1}{4(3) - 1(1)}\\begin{pmatrix} 3  -1 \\\\ -1  4 \\end{pmatrix} = \\frac{1}{11}\\begin{pmatrix} 3  -1 \\\\ -1  4 \\end{pmatrix}$。\n    所以，矩阵是 $\\mathbf{H}_{2} = \\begin{pmatrix} 3/11  -1/11 \\\\ -1/11  4/11 \\end{pmatrix}$。\n\n最后一步是计算 $\\mathbf{H}_{2}$ 的迹。\n$$\n\\operatorname{tr}(\\mathbf{H}_{2}) = \\operatorname{tr}\\left(\\frac{1}{11}\\begin{pmatrix} 3  -1 \\\\ -1  4 \\end{pmatrix}\\right) = \\frac{3}{11} + \\frac{4}{11} = \\frac{7}{11}\n$$\n这是一个符合要求的精确有理数。",
            "answer": "$$\\boxed{\\frac{7}{11}}$$"
        },
        {
            "introduction": "现在，我们将这些抽象的优化原理应用于一个完整且真实的材料科学问题：弛豫周期性固体的模拟晶胞。在固态模拟中，我们不仅需要优化原子位置，还必须优化定义晶格的晶胞矢量。本练习  展示了计算出的应力张量如何充当驱动晶胞形状和体积变化的“广义力”，使结构能够在给定的外部压力下达到平衡。这个计算是一个可变晶胞弛豫步骤的直接示例，它将算法与宏观热力学量紧密联系起来。",
            "id": "3454268",
            "problem": "考虑一个三维周期性固体，其由晶胞矩阵 $\\mathbf{h}^{(0)}$ 表示，该矩阵的列是笛卡尔坐标系中的晶格矢量。设柯西应力张量 $\\boldsymbol{\\sigma}$ 是通过在固定分数原子坐标下进行量子力学总能计算得到的，并且系统受到静水外压 $p$ 的作用。焓为 $H = E + p V$，其中 $E$ 是内能，$V=\\det(\\mathbf{h})$ 是晶胞体积。通过沿焓 $H$ 相对于无穷小应变张量 $\\boldsymbol{\\varepsilon}$ 的负梯度方向走一步来执行晶胞的最速下降法更新，同时保持分数原子坐标固定。假设晶胞更新采用小应变线性化，并使用应力与应变之间的标准虚功关系。\n\n给定：\n$$\n\\mathbf{h}^{(0)} = \\begin{pmatrix}\n3.000  0.200  0.100\\\\\n0.000  4.000  0.300\\\\\n0.000  0.000  5.000\n\\end{pmatrix}\\ \\text{Å},\n\\quad\n\\boldsymbol{\\sigma} = \\begin{pmatrix}\n1.5  0.2  -0.1\\\\\n0.2  -0.5  0.0\\\\\n-0.1  0.0  2.0\n\\end{pmatrix}\\ \\text{GPa},\n\\quad\np = 1.0\\ \\text{GPa}.\n$$\n设最速下降步长由一个单位为 $\\text{GPa}^{-1}$ 的标量 $\\kappa$ 来表征，其定义为 $\\delta \\boldsymbol{\\varepsilon} = \\kappa \\left( \\boldsymbol{\\sigma} - p \\mathbf{I} \\right)$，其中 $\\kappa = 2.0 \\times 10^{-2}\\ \\text{GPa}^{-1}$。在形变梯度 $\\mathbf{F} \\approx \\mathbf{I} + \\delta \\boldsymbol{\\varepsilon}$ 下，采用晶胞矩阵的线性化更新，即 $\\mathbf{h}^{(1)} = \\left( \\mathbf{I} + \\delta \\boldsymbol{\\varepsilon} \\right) \\mathbf{h}^{(0)}$，其中 $\\mathbf{I}$ 是单位矩阵。使用双点积约定 $A : B = \\sum_{i,j} A_{ij} B_{ij}$。\n\n计算更新后的晶胞矩阵 $\\mathbf{h}^{(1)}$。将你的最终答案表示为一个行矩阵，按列主序（即逐列，从上到下，从左到右）列出 $\\mathbf{h}^{(1)}$ 的九个分量，单位为 Å。将答案的每个分量四舍五入到四位有效数字。",
            "solution": "用户要求我计算经过单步最速下降法更新后的晶胞矩阵 $\\mathbf{h}^{(1)}$。\n\n### 步骤 1：提取已知条件\n- 初始晶胞矩阵：\n$$\n\\mathbf{h}^{(0)} = \\begin{pmatrix}\n3.000  0.200  0.100\\\\\n0.000  4.000  0.300\\\\\n0.000  0.000  5.000\n\\end{pmatrix}\\ \\text{Å}\n$$\n- 柯西应力张量：\n$$\n\\boldsymbol{\\sigma} = \\begin{pmatrix}\n1.5  0.2  -0.1\\\\\n0.2  -0.5  0.0\\\\\n-0.1  0.0  2.0\n\\end{pmatrix}\\ \\text{GPa}\n$$\n- 静水外压： $p = 1.0\\ \\text{GPa}$。\n- 最速下降步长参数： $\\kappa = 2.0 \\times 10^{-2}\\ \\text{GPa}^{-1}$。\n- 应变更新法则： $\\delta \\boldsymbol{\\varepsilon} = \\kappa \\left( \\boldsymbol{\\sigma} - p \\mathbf{I} \\right)$。\n- 线性化晶胞更新法则： $\\mathbf{h}^{(1)} = \\left( \\mathbf{I} + \\delta \\boldsymbol{\\varepsilon} \\right) \\mathbf{h}^{(0)}$。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题具有科学依据，提法恰当且客观。它描述了材料科学中结构弛豫的一个标准的、尽管是简化的计算过程。所提供的更新法则 $\\delta \\boldsymbol{\\varepsilon} = \\kappa \\left( \\boldsymbol{\\sigma} - p \\mathbf{I} \\right)$ 代表了一种具有物理动机的算法，用于将内应力 $\\boldsymbol{\\sigma}$ 弛豫到目标外压张量 $p \\mathbf{I}$。所有必要数据均已提供，各物理量在量纲上是一致的，并且所需的运算是明确定义的数学过程。因此，可以确定一个唯一的解。该问题是有效的。\n\n### 步骤 3：结论与行动\n问题有效。我将继续进行完整求解。\n\n求解过程首先根据给定的应力、压力和步长计算无穷小应变张量 $\\delta \\boldsymbol{\\varepsilon}$。然后，使用此应变构建线性化形变梯度 $\\mathbf{F} \\approx \\mathbf{I} + \\delta \\boldsymbol{\\varepsilon}$。最后，通过将此形变应用于初始晶胞矩阵 $\\mathbf{h}^{(0)}$ 来计算更新后的晶胞矩阵 $\\mathbf{h}^{(1)}$。\n\n首先，我们计算内应力张量 $\\boldsymbol{\\sigma}$ 与对应于外压的目标应力张量 $p \\mathbf{I}$ 之间的差值。\n$$\np \\mathbf{I} = (1.0) \\begin{pmatrix} 1  0  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{pmatrix} \\text{GPa} = \\begin{pmatrix} 1.0  0.0  0.0 \\\\ 0.0  1.0  0.0 \\\\ 0.0  0.0  1.0 \\end{pmatrix} \\text{GPa}\n$$\n$$\n\\boldsymbol{\\sigma} - p \\mathbf{I} = \\begin{pmatrix}\n1.5  0.2  -0.1\\\\\n0.2  -0.5  0.0\\\\\n-0.1  0.0  2.0\n\\end{pmatrix} - \\begin{pmatrix}\n1.0  0.0  0.0 \\\\\n0.0  1.0  0.0 \\\\\n0.0  0.0  1.0\n\\end{pmatrix} = \\begin{pmatrix}\n0.5  0.2  -0.1\\\\\n0.2  -1.5  0.0\\\\\n-0.1  0.0  1.0\n\\end{pmatrix} \\text{GPa}\n$$\n接下来，我们使用提供的更新法则 $\\delta \\boldsymbol{\\varepsilon} = \\kappa ( \\boldsymbol{\\sigma} - p \\mathbf{I} )$ 计算无穷小应变张量 $\\delta \\boldsymbol{\\varepsilon}$。\n$$\n\\delta \\boldsymbol{\\varepsilon} = (2.0 \\times 10^{-2}\\ \\text{GPa}^{-1}) \\begin{pmatrix}\n0.5  0.2  -0.1\\\\\n0.2  -1.5  0.0\\\\\n-0.1  0.0  1.0\n\\end{pmatrix} \\text{GPa}\n$$\n$$\n\\delta \\boldsymbol{\\varepsilon} = \\begin{pmatrix}\n0.02 \\times 0.5  0.02 \\times 0.2  0.02 \\times (-0.1)\\\\\n0.02 \\times 0.2  0.02 \\times (-1.5)  0.02 \\times 0.0\\\\\n0.02 \\times (-0.1)  0.02 \\times 0.0  0.02 \\times 1.0\n\\end{pmatrix} = \\begin{pmatrix}\n0.010  0.004  -0.002\\\\\n0.004  -0.030  0.000\\\\\n-0.002  0.000  0.020\n\\end{pmatrix}\n$$\n正如预期的那样，该应变张量是无量纲的。现在我们构造矩阵 $\\mathbf{I} + \\delta \\boldsymbol{\\varepsilon}$，它代表了线性化的形变梯度。\n$$\n\\mathbf{I} + \\delta \\boldsymbol{\\varepsilon} = \\begin{pmatrix}\n1  0  0\\\\\n0  1  0\\\\\n0  0  1\n\\end{pmatrix} + \\begin{pmatrix}\n0.010  0.004  -0.002\\\\\n0.004  -0.030  0.000\\\\\n-0.002  0.000  0.020\n\\end{pmatrix} = \\begin{pmatrix}\n1.010  0.004  -0.002\\\\\n0.004  0.970  0.000\\\\\n-0.002  0.000  1.020\n\\end{pmatrix}\n$$\n最后，我们通过将此形变应用于初始晶胞矩阵 $\\mathbf{h}^{(0)}$ 来计算更新后的晶胞矩阵 $\\mathbf{h}^{(1)}$。\n$$\n\\mathbf{h}^{(1)} = (\\mathbf{I} + \\delta \\boldsymbol{\\varepsilon}) \\mathbf{h}^{(0)} = \\begin{pmatrix}\n1.010  0.004  -0.002\\\\\n0.004  0.970  0.000\\\\\n-0.002  0.000  1.020\n\\end{pmatrix} \\begin{pmatrix}\n3.000  0.200  0.100\\\\\n0.000  4.000  0.300\\\\\n0.000  0.000  5.000\n\\end{pmatrix}\n$$\n执行矩阵乘法：\n$h^{(1)}_{11} = (1.010)(3.000) + (0.004)(0.000) + (-0.002)(0.000) = 3.030$\n$h^{(1)}_{21} = (0.004)(3.000) + (0.970)(0.000) + (0.000)(0.000) = 0.012$\n$h^{(1)}_{31} = (-0.002)(3.000) + (0.000)(0.000) + (1.020)(0.000) = -0.006$\n\n$h^{(1)}_{12} = (1.010)(0.200) + (0.004)(4.000) + (-0.002)(0.000) = 0.202 + 0.016 = 0.218$\n$h^{(1)}_{22} = (0.004)(0.200) + (0.970)(4.000) + (0.000)(0.000) = 0.0008 + 3.88 = 3.8808$\n$h^{(1)}_{32} = (-0.002)(0.200) + (0.000)(4.000) + (1.020)(0.000) = -0.0004$\n\n$h^{(1)}_{13} = (1.010)(0.100) + (0.004)(0.300) + (-0.002)(5.000) = 0.101 + 0.0012 - 0.01 = 0.0922$\n$h^{(1)}_{23} = (0.004)(0.100) + (0.970)(0.300) + (0.000)(5.000) = 0.0004 + 0.291 = 0.2914$\n$h^{(1)}_{33} = (-0.002)(0.100) + (0.000)(0.300) + (1.020)(5.000) = -0.0002 + 5.1 = 5.0998$\n\n所以，更新后的晶胞矩阵为：\n$$\n\\mathbf{h}^{(1)} = \\begin{pmatrix}\n3.030  0.218  0.0922 \\\\\n0.012  3.8808  0.2914 \\\\\n-0.006  -0.0004  5.0998\n\\end{pmatrix}\\ \\text{Å}\n$$\n题目要求将每个分量四舍五入到四位有效数字。\n$h^{(1)}_{11} = 3.030 \\rightarrow 3.030$\n$h^{(1)}_{21} = 0.012 \\rightarrow 0.01200$\n$h^{(1)}_{31} = -0.006 \\rightarrow -0.006000$\n\n$h^{(1)}_{12} = 0.218 \\rightarrow 0.2180$\n$h^{(1)}_{22} = 3.8808 \\rightarrow 3.881$\n$h^{(1)}_{32} = -0.0004 \\rightarrow -0.0004000$\n\n$h^{(1)}_{13} = 0.0922 \\rightarrow 0.09220$\n$h^{(1)}_{23} = 0.2914 \\rightarrow 0.2914$\n$h^{(1)}_{33} = 5.0998 \\rightarrow 5.100$\n\n最终的分量，按要求的列主序排列如下：\n第 1 列： $3.030$, $0.01200$, $-0.006000$\n第 2 列： $0.2180$, $3.881$, $-0.0004000$\n第 3 列： $0.09220$, $0.2914$, $5.100$",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 3.030  0.01200  -0.006000  0.2180  3.881  -0.0004000  0.09220  0.2914  5.100 \\end{pmatrix}}\n$$"
        }
    ]
}