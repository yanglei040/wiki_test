{"hands_on_practices": [{"introduction": "Before analyzing complex physical phenomena, it is crucial to ensure our basic measurement tools are statistically sound. This exercise [@problem_id:3408216] delves into the \"multiple time origin\" method, a standard technique to improve the precision of the Mean Squared Displacement (MSD) by leveraging all available data from a finite-length trajectory. By deriving the variance of the MSD estimator for an idealized random walk, you will gain a deep understanding of the inherent trade-offs between statistical precision and the choice of lag time.", "problem": "Consider a single particle undergoing overdamped Langevin dynamics in $d$ spatial dimensions, sampled at discrete times $t_{n} = n \\Delta t$ for $n = 0, 1, \\dots, N$. The position $\\mathbf{r}_{n}$ evolves according to $\\mathbf{r}_{n} = \\mathbf{r}_{n-1} + \\boldsymbol{\\xi}_{n}$, where the increments $\\boldsymbol{\\xi}_{n}$ are independent and identically distributed Gaussian random vectors with zero mean and covariance $\\langle \\boldsymbol{\\xi}_{n} \\boldsymbol{\\xi}_{n}^{\\top} \\rangle = 2 D \\Delta t \\, \\mathbf{I}_{d}$, with $D$ the diffusion coefficient and $\\mathbf{I}_{d}$ the $d \\times d$ identity matrix. For a fixed lag time $\\tau = k \\Delta t$ with a positive integer $k$, define the displacement over $k$ steps started at frame $i$ as $\\Delta \\mathbf{r}_{i,k} = \\mathbf{r}_{i+k} - \\mathbf{r}_{i}$ and its squared magnitude $S_{i} = \\| \\Delta \\mathbf{r}_{i,k} \\|^{2}$. The Mean Squared Displacement (MSD) at lag $\\tau$ is estimated in two ways:\n\n- Single-origin estimator: $\\widehat{\\mathrm{MSD}}_{1}(\\tau) = S_{0}$.\n- Multiple time origin estimator: $\\widehat{\\mathrm{MSD}}_{M}(\\tau) = \\frac{1}{M} \\sum_{i=0}^{M-1} S_{i}$, where $M = N - k + 1$ and the sum runs over all valid time origins.\n\nStarting only from the definitions above and standard properties of Gaussian random variables, do the following:\n\n1. Explain the rationale behind the multiple time origin averaging in terms of variance reduction for the MSD at fixed lag time $\\tau$.\n2. Derive, in closed form, the ratio of variances $\\mathrm{Var}[\\widehat{\\mathrm{MSD}}_{M}(\\tau)] / \\mathrm{Var}[\\widehat{\\mathrm{MSD}}_{1}(\\tau)]$ under the stated model assumptions, carefully accounting for the correlation between overlapping time windows. Assume $M \\geq k$ so that all lags considered overlap with the initial window.\n3. Discuss, based on your derivation, the trade-off between increasing the lag time (larger $k$) and the number of available time origins $M$ for the precision of MSD estimation, and the implications for estimating the diffusion coefficient via the Einstein relation $\\widehat{D}(\\tau) = \\widehat{\\mathrm{MSD}}(\\tau)/(2 d \\tau)$.\n\nYour final answer must be the single analytic expression you obtain for the variance ratio in item 2. No numerical evaluation is required. Do not include any units in the final expression.", "solution": "This problem requires a multi-part analysis of Mean Squared Displacement (MSD) estimators for a particle undergoing discrete-time Brownian motion. We will first validate the problem statement, then proceed with the three required tasks: explaining the rationale for multiple time origin averaging, deriving the variance ratio of two MSD estimators, and discussing the trade-offs involved in choosing the lag time.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n- **System**: A single particle in $d$ spatial dimensions.\n- **Dynamics**: Overdamped Langevin dynamics sampled at discrete times $t_{n} = n \\Delta t$ for $n = 0, 1, \\dots, N$.\n- **Position Update**: $\\mathbf{r}_{n} = \\mathbf{r}_{n-1} + \\boldsymbol{\\xi}_{n}$.\n- **Stochastic Increments**: $\\boldsymbol{\\xi}_{n}$ are independent and identically distributed (i.i.d.) Gaussian random vectors.\n- **Mean of Increments**: $\\langle \\boldsymbol{\\xi}_{n} \\rangle = \\mathbf{0}$.\n- **Covariance of Increments**: $\\langle \\boldsymbol{\\xi}_{n} \\boldsymbol{\\xi}_{n}^{\\top} \\rangle = 2 D \\Delta t \\, \\mathbf{I}_{d}$, where $D$ is the diffusion coefficient and $\\mathbf{I}_{d}$ is the $d \\times d$ identity matrix.\n- **Lag Time**: $\\tau = k \\Delta t$ for a positive integer $k$.\n- **Displacement Vector**: $\\Delta \\mathbf{r}_{i,k} = \\mathbf{r}_{i+k} - \\mathbf{r}_{i}$.\n- **Squared Displacement**: $S_{i} = \\| \\Delta \\mathbf{r}_{i,k} \\|^{2}$.\n- **Estimator 1 (Single-origin)**: $\\widehat{\\mathrm{MSD}}_{1}(\\tau) = S_{0}$.\n- **Estimator 2 (Multiple time origin)**: $\\widehat{\\mathrm{MSD}}_{M}(\\tau) = \\frac{1}{M} \\sum_{i=0}^{M-1} S_{i}$, with $M = N - k + 1$.\n- **Constraint for Derivation**: Assume $M \\geq k$.\n- **Tasks**: (1) Explain variance reduction, (2) Derive $\\mathrm{Var}[\\widehat{\\mathrm{MSD}}_{M}(\\tau)] / \\mathrm{Var}[\\widehat{\\mathrm{MSD}}_{1}(\\tau)]$, (3) Discuss trade-offs.\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientifically Grounded**: The problem describes a discrete Wiener process, a fundamental model for Brownian motion. This is a standard and well-established model in statistical physics and the analysis of molecular dynamics trajectories.\n- **Well-Posed**: All terms are mathematically defined, and the objectives are clear. The model is simple enough to allow for an exact, closed-form solution for the variance ratio.\n- **Objective**: The problem is stated using precise mathematical language, free from subjectivity or ambiguity.\n- **Flaw Checklist**: The problem does not violate any of the invalidity criteria. It is scientifically sound, formalizable, complete, realistic within its modeling context, and well-posed. The derivation required is non-trivial and constitutes a standard, important calculation in the field.\n\n**Step 3: Verdict and Action**\nThe problem is valid. We proceed with the solution.\n\n### Part 1: Rationale for Multiple Time Origin Averaging\n\nThe Mean Squared Displacement (MSD) at a lag time $\\tau$ is formally the expectation of the squared displacement, $\\mathrm{MSD}(\\tau) = \\mathbb{E}[S_i]$. Both estimators, $\\widehat{\\mathrm{MSD}}_{1}$ and $\\widehat{\\mathrm{MSD}}_{M}$, are designed to estimate this quantity from a finite-time trajectory.\n\nThe displacement vector $\\Delta \\mathbf{r}_{i,k}$ is a sum of i.i.d. zero-mean Gaussian variables, and thus is itself a zero-mean Gaussian variable. Its covariance is $\\mathbb{E}[\\Delta \\mathbf{r}_{i,k} \\Delta \\mathbf{r}_{i,k}^\\top] = 2D\\tau \\mathbf{I}_d$. The expectation of the squared displacement $S_i$ is identical for all starting times $i$: $\\mathbb{E}[S_i] = \\mathbb{E}[\\|\\Delta \\mathbf{r}_{i,k}\\|^2] = \\mathrm{Tr}(2D\\tau \\mathbf{I}_d) = 2dD\\tau = \\mathrm{MSD}(\\tau)$.\nConsequently, both estimators are unbiased:\n$$ \\mathbb{E}[\\widehat{\\mathrm{MSD}}_{1}(\\tau)] = \\mathbb{E}[S_0] = \\mathrm{MSD}(\\tau) $$\n$$ \\mathbb{E}[\\widehat{\\mathrm{MSD}}_{M}(\\tau)] = \\mathbb{E}\\left[\\frac{1}{M} \\sum_{i=0}^{M-1} S_i\\right] = \\frac{1}{M} \\sum_{i=0}^{M-1} \\mathbb{E}[S_i] = \\frac{1}{M} (M \\cdot \\mathrm{MSD}(\\tau)) = \\mathrm{MSD}(\\tau) $$\nSince both estimators are unbiased, their quality is compared based on their variance, which measures the spread of the estimates around the true mean. A smaller variance indicates higher precision.\n\nThe single-origin estimator $\\widehat{\\mathrm{MSD}}_{1} = S_0$ uses only one realization of the random variable $S_i$. The multiple time origin estimator $\\widehat{\\mathrm{MSD}}_{M}$ is a sample mean of $M$ such random variables, $S_0, S_1, \\dots, S_{M-1}$. According to the principles of statistical estimation (related to the Law of Large Numbers), averaging over multiple samples of a random process provides a better estimate of its mean. Even though the samples $S_i$ are not independent (due to overlapping time windows for $\\Delta \\mathbf{r}_{i,k}$ and $\\Delta \\mathbf{r}_{j,k}$ when $|i-j|k$), the averaging process still reduces the variance of the estimator as long as the samples are not perfectly correlated. By using all possible time origins in the trajectory, one leverages the available data maximally to reduce the statistical uncertainty (variance) of the estimate.\n\n### Part 2: Derivation of the Variance Ratio\n\nWe aim to compute the ratio $R = \\mathrm{Var}[\\widehat{\\mathrm{MSD}}_{M}(\\tau)] / \\mathrm{Var}[\\widehat{\\mathrm{MSD}}_{1}(\\tau)]$.\n\n**Denominator: $\\mathrm{Var}[\\widehat{\\mathrm{MSD}}_{1}(\\tau)] = \\mathrm{Var}[S_0]$**\nThe displacement $\\Delta \\mathbf{r}_{0,k}$ is a $d$-dimensional Gaussian vector with mean $\\mathbf{0}$ and covariance matrix $2D\\tau \\mathbf{I}_d$. Let its components be $X_p \\sim \\mathcal{N}(0, 2D\\tau)$ for $p=1, \\dots, d$.\n$S_0 = \\|\\Delta \\mathbf{r}_{0,k}\\|^2 = \\sum_{p=1}^d X_p^2$.\nSince the components $X_p$ are independent, the variance of the sum is the sum of the variances:\n$\\mathrm{Var}[S_0] = \\sum_{p=1}^d \\mathrm{Var}[X_p^2]$.\nFor a centered Gaussian variable $X$ with variance $\\sigma^2$, $\\mathrm{Var}[X^2] = \\mathbb{E}[X^4] - (\\mathbb{E}[X^2])^2 = 3(\\sigma^2)^2 - (\\sigma^2)^2 = 2(\\sigma^2)^2$.\nHere, $\\sigma^2 = 2D\\tau$. Thus, $\\mathrm{Var}[X_p^2] = 2(2D\\tau)^2$.\nTherefore, the variance of the single-origin estimator is:\n$$ \\mathrm{Var}[\\widehat{\\mathrm{MSD}}_{1}(\\tau)] = \\mathrm{Var}[S_0] = \\sum_{p=1}^d 2(2D\\tau)^2 = 2d(2D\\tau)^2 $$\n\n**Numerator: $\\mathrm{Var}[\\widehat{\\mathrm{MSD}}_{M}(\\tau)]$**\nThe variance of the multiple time origin estimator is:\n$$ \\mathrm{Var}[\\widehat{\\mathrm{MSD}}_{M}(\\tau)] = \\mathrm{Var}\\left[\\frac{1}{M} \\sum_{i=0}^{M-1} S_i\\right] = \\frac{1}{M^2} \\sum_{i=0}^{M-1} \\sum_{j=0}^{M-1} \\mathrm{Cov}(S_i, S_j) $$\nThe covariance can be expressed using the property for quadratic forms of zero-mean Gaussian vectors: $\\mathrm{Cov}(\\|\\mathbf{X}\\|^2, \\|\\mathbf{Y}\\|^2) = 2 \\mathrm{Tr}(\\mathrm{Cov}(\\mathbf{X}, \\mathbf{Y})^2)$.\nLet $\\mathbf{C}_{ij} = \\mathbb{E}[\\Delta \\mathbf{r}_{i,k} \\Delta \\mathbf{r}_{j,k}^\\top]$. Then $\\mathrm{Cov}(S_i, S_j) = 2 \\mathrm{Tr}(\\mathbf{C}_{ij}^2)$.\nLet's compute $\\mathbf{C}_{ij}$:\n$\\Delta \\mathbf{r}_{i,k} = \\sum_{p=i+1}^{i+k} \\boldsymbol{\\xi}_p$.\n$\\mathbf{C}_{ij} = \\mathbb{E}\\left[ \\left(\\sum_{p=i+1}^{i+k} \\boldsymbol{\\xi}_p\\right) \\left(\\sum_{q=j+1}^{j+k} \\boldsymbol{\\xi}_q^\\top\\right) \\right] = \\sum_{p=i+1}^{i+k} \\sum_{q=j+1}^{j+k} \\mathbb{E}[\\boldsymbol{\\xi}_p \\boldsymbol{\\xi}_q^\\top]$.\nUsing $\\mathbb{E}[\\boldsymbol{\\xi}_p \\boldsymbol{\\xi}_q^\\top] = \\delta_{pq} (2D\\Delta t \\mathbf{I}_d)$, the sum is non-zero only for common indices $p=q$. The number of overlapping steps for windows starting at $i$ and $j$ (let $m=|i-j|  k$) is $k-m$.\n$$ \\mathbf{C}_{ij} = (k - |i-j|) (2D\\Delta t) \\mathbf{I}_d = \\frac{k - |i-j|}{k} (2Dk\\Delta t) \\mathbf{I}_d = \\left(1-\\frac{|i-j|}{k}\\right) (2D\\tau) \\mathbf{I}_d $$\nfor $|i-j|  k$, and $\\mathbf{C}_{ij}=0$ otherwise.\nNow we compute $\\mathrm{Cov}(S_i, S_j)$:\n$$ \\mathrm{Cov}(S_i, S_j) = 2 \\mathrm{Tr}\\left( \\left(1-\\frac{|i-j|}{k}\\right)^2 (2D\\tau)^2 \\mathbf{I}_d \\right) = 2d(2D\\tau)^2 \\left(1-\\frac{|i-j|}{k}\\right)^2 $$\nThis is the covariance for a lag $m=|i-j|k$. Note that for $m=0$, this gives $\\mathrm{Var}(S_i) = 2d(2D\\tau)^2$, matching our earlier result.\n\nThe double summation for the variance can be converted to a single sum over the lag $m=j-i$:\n$$ \\mathrm{Var}[\\widehat{\\mathrm{MSD}}_{M}] = \\frac{1}{M^2} \\sum_{m=-(M-1)}^{M-1} (M-|m|) \\mathrm{Cov}(S_0, S_m) $$\nSince the covariance is zero for $|m|\\geq k$, and we assumed $M \\geq k$, the sum runs from $m=-(k-1)$ to $k-1$:\n$$ \\mathrm{Var}[\\widehat{\\mathrm{MSD}}_{M}] = \\frac{1}{M^2} \\left( M \\cdot \\mathrm{Var}(S_0) + 2 \\sum_{m=1}^{k-1} (M-m) \\mathrm{Cov}(S_0, S_m) \\right) $$\nThe ratio $R$ is:\n$$ R = \\frac{\\mathrm{Var}[\\widehat{\\mathrm{MSD}}_{M}]}{\\mathrm{Var}[S_0]} = \\frac{1}{M} + \\frac{2}{M^2} \\sum_{m=1}^{k-1} (M-m) \\frac{\\mathrm{Cov}(S_0, S_m)}{\\mathrm{Var}(S_0)} $$\nThe correlation coefficient is $\\rho(m) = \\frac{\\mathrm{Cov}(S_0, S_m)}{\\mathrm{Var}(S_0)} = \\left(1-\\frac{m}{k}\\right)^2$.\n$$ R = \\frac{1}{M} \\left( 1 + \\frac{2}{M} \\sum_{m=1}^{k-1} (M-m) \\left(1-\\frac{m}{k}\\right)^2 \\right) = \\frac{1}{M} \\left( 1 + 2 \\sum_{m=1}^{k-1} \\left(1-\\frac{m}{M}\\right) \\left(1-\\frac{m}{k}\\right)^2 \\right) $$\nLet's evaluate the sum $S' = \\sum_{m=1}^{k-1} (1-\\frac{m}{M})(1-\\frac{m}{k})^2$:\n$$ S' = \\sum_{m=1}^{k-1} \\left( 1 - \\left(\\frac{2}{k} + \\frac{1}{M}\\right)m + \\left(\\frac{1}{k^2} + \\frac{2}{Mk}\\right)m^2 - \\frac{1}{Mk^2}m^3 \\right) $$\nUsing the Faulhaber's formulas for sums of powers up to $n=k-1$: $\\sum 1 = k-1$, $\\sum m = \\frac{(k-1)k}{2}$, $\\sum m^2 = \\frac{(k-1)k(2k-1)}{6}$, $\\sum m^3 = \\frac{(k-1)^2k^2}{4}$.\nSubstituting and simplifying leads to:\n$$ S' = (k-1) - \\left(\\frac{2}{k} + \\frac{1}{M}\\right)\\frac{(k-1)k}{2} + \\left(\\frac{1}{k^2} + \\frac{2}{Mk}\\right)\\frac{(k-1)k(2k-1)}{6} - \\frac{1}{Mk^2}\\frac{(k-1)^2k^2}{4} $$\nAfter careful algebraic simplification, this becomes:\n$$ S' = \\frac{(k-1)(2k-1)}{6k} - \\frac{k^2-1}{12M} $$\nNow we substitute $S'$ back into the expression for the ratio $R$:\n$$ R = \\frac{1}{M} \\left( 1 + 2S' \\right) = \\frac{1}{M} \\left( 1 + 2\\left[ \\frac{(k-1)(2k-1)}{6k} - \\frac{k^2-1}{12M} \\right] \\right) $$\n$$ R = \\frac{1}{M} \\left( 1 + \\frac{(k-1)(2k-1)}{3k} - \\frac{k^2-1}{6M} \\right) $$\nCombining the first two terms in the parenthesis:\n$ 1 + \\frac{2k^2-3k+1}{3k} = \\frac{3k + 2k^2-3k+1}{3k} = \\frac{2k^2+1}{3k} $.\nSo the ratio becomes:\n$$ R = \\frac{1}{M} \\left( \\frac{2k^2+1}{3k} - \\frac{k^2-1}{6M} \\right) = \\frac{2k^2+1}{3kM} - \\frac{k^2-1}{6M^2} $$\nThis is the final closed-form expression for the variance ratio.\n\n### Part 3: Discussion of Trade-offs\n\nThe precision of the diffusion coefficient estimate, $\\widehat{D}(\\tau) = \\widehat{\\mathrm{MSD}}(\\tau)/(2d\\tau)$, is inversely related to its variance, $\\mathrm{Var}[\\widehat{D}(\\tau)]$.\n$$ \\mathrm{Var}[\\widehat{D}(\\tau)] = \\frac{\\mathrm{Var}[\\widehat{\\mathrm{MSD}}(\\tau)]}{(2d\\tau)^2} = \\frac{\\mathrm{Var}[\\widehat{\\mathrm{MSD}}_1(\\tau)]}{(2d k \\Delta t)^2} \\times R = \\frac{2d(2Dk\\Delta t)^2}{(2dk\\Delta t)^2} \\times R = \\frac{2D^2}{d} R $$\nThus, minimizing the variance of the $\\widehat{D}$ estimate is equivalent to minimizing the ratio $R(k, M)$, where $M = N-k+1$.\n$$ R(k) = \\frac{2k^2+1}{3k(N-k+1)} - \\frac{k^2-1}{6(N-k+1)^2} $$\nThe choice of the lag time parameter $k$ involves a critical trade-off:\n\n1.  **Effect of Increasing $k$ (Longer Lag Times)**:\n    -   It reduces the number of available time origins, $M=N-k+1$, which tends to increase statistical error.\n    -   It increases the correlation between subsequent squared displacements $S_i$ and $S_{i+1}$, as the fractional overlap of their time windows, $(k-1)/k$, approaches $1$. This makes the multiple-origin averaging less effective at reducing variance.\n    -   For $k \\ll N$, $M \\approx N$, and the ratio $R \\approx \\frac{2k^2+1}{3kN} \\approx \\frac{2k}{3N}$. In this limit, the variance of $\\widehat{D}$ is proportional to $k$. This suggests that for purely statistical reasons within this idealized model, one should choose the smallest possible $k$ to achieve the highest precision.\n\n2.  **Effect of Decreasing $k$ (Shorter Lag Times)**:\n    -   It maximizes the number of statistical samples, $M$, enhancing the variance reduction from averaging. For $k=1$, the displacements are i.i.d., and $R = 1/M$, yielding the standard variance for the mean of independent samples.\n    -   This leads to the most statistically precise estimate of the diffusion coefficient *for the given model*.\n\n**The Trade-off and Practical Implications**:\nThe derived result, showing that the variance of $\\widehat{D}$ is minimized at small $k$, is specific to the idealized model of pure Brownian motion where the Einstein relation holds for all $\\tau  0$. In real physical systems studied via molecular dynamics, this is often not the case.\n\n-   **Short-time non-diffusive behavior**: At very short times, particle motion can be \"ballistic\" (MSD $\\propto t^2$) due to inertia, or \"caged\" by surrounding particles. The linear, diffusive regime (MSD $\\propto t$) only emerges at longer lag times. Therefore, $k$ must be chosen large enough so that $\\tau = k\\Delta t$ falls within this scientifically relevant diffusive regime. Using a very small $k$ would lead to a systematic error, calculating a \"diffusion coefficient\" from a non-diffusive part of the trajectory.\n-   **Statistical Precision vs. Systematic Accuracy**: There is a conflict between statistical precision (which favors small $k$) and systematic accuracy (which requires $k$ to be large enough to probe the correct physical regime). A common practice is to calculate $\\widehat{D}(\\tau)$ for a range of $\\tau$ values and identify a \"plateau\" where $\\widehat{D}(\\tau)$ is reasonably constant. The optimal estimate for $D$ is then taken from this plateau region. The optimal choice of $k$ would be the smallest value that is clearly in this diffusive plateau, as this provides the best compromise between minimizing systematic and statistical errors.\n\nIn summary, while the pure mathematical model suggests using the smallest possible $k$, physical reality dictates that $k$ must be large enough to avoid modeling artifacts from short-time dynamics. The optimal strategy balances these competing requirements.", "answer": "$$ \\boxed{\\frac{2k^2+1}{3kM} - \\frac{k^2-1}{6M^2}} $$", "id": "3408216"}, {"introduction": "Particles in simulations or experiments are often not in an infinite bulk medium but are confined by boundaries, such as in nanopores or thin films. This confinement introduces a systematic error, causing the Mean Squared Displacement to deviate from the linear behavior of free diffusion and saturate at long times. This practice [@problem_id:3464978] guides you through a powerful technique to overcome this issue by using the method of images to derive a theoretical correction for the early-time MSD, allowing you to recover the true bulk diffusion coefficient $D$ from data affected by confinement.", "problem": "A molecular dynamics simulation tracks the one-dimensional coordinate $x$ of a tracer molecule across a slit nanopore of width $L$, with reflecting walls at $x=0$ and $x=L$. Along the confined direction, the long-time Mean Squared Displacement (MSD) saturates to $\\langle \\Delta x^{2} \\rangle \\to L^{2}/6$ due to confinement. You are asked to recover the bulk diffusion coefficient $D$ (that would be measured in the absence of confinement) from early-time data, when $t \\ll L^{2}/D$.\n\nStarting from the diffusion equation $\\partial_{t} P(x,t|x_{0}) = D \\partial_{x}^{2} P(x,t|x_{0})$ with reflecting (Neumann) boundary conditions at $x=0$ and $x=L$, use the method of images to derive the early-time asymptotic expansion of the ensemble-averaged MSD across the slit, defined as $\\langle \\Delta x^{2} \\rangle(t) = \\langle \\left(x(t)-x(0)\\right)^{2} \\rangle$ with the average taken over a uniform initial distribution of $x(0)$ in $[0,L]$. Retain terms through the first nontrivial correction beyond free diffusion and explicitly identify the scaling with $D$, $t$, and $L$.\n\nThen, using your asymptotic form, construct a two-time combination of MSD values that eliminates the leading-order boundary correction and yields an estimator for $D$ in terms of two measured early-time MSDs, $\\langle \\Delta x^{2} \\rangle(t_{1})$ and $\\langle \\Delta x^{2} \\rangle(t_{2})$, at times $t_{1}$ and $t_{2}$.\n\nFinally, evaluate $D$ numerically from the following early-time data obtained along the confined direction in a slit of width $L=20\\,\\mathrm{nm}$:\n- $t_{1} = 1.0\\,\\mathrm{ns}$ with $\\langle \\Delta x^{2} \\rangle(t_{1}) = 0.44340468\\,\\mathrm{nm}^{2}$,\n- $t_{2} = 4.0\\,\\mathrm{ns}$ with $\\langle \\Delta x^{2} \\rangle(t_{2}) = 1.70723656\\,\\mathrm{nm}^{2}$.\n\nRound your final numerical value of $D$ to four significant figures. Express the final answer in $\\mathrm{nm}^{2}\\,\\mathrm{ns}^{-1}$.", "solution": "## Problem Validation ##\n### Step 1: Extract Givens ###\n- **System**: A tracer molecule in a one-dimensional slit nanopore of width $L$.\n- **Boundary Conditions**: Reflecting walls at $x=0$ and $x=L$.\n- **Governing Equation**: The diffusion equation, $\\partial_{t} P(x,t|x_{0}) = D \\partial_{x}^{2} P(x,t|x_{0})$.\n- **Boundary Conditions (mathematical form)**: Neumann conditions, $\\partial_{x} P(x,t|x_{0})|_{x=0} = 0$ and $\\partial_{x} P(x,t|x_{0})|_{x=L} = 0$.\n- **Long-time MSD**: $\\langle \\Delta x^{2} \\rangle \\to L^{2}/6$ as $t \\to \\infty$.\n- **Early-time Regime**: $t \\ll L^{2}/D$.\n- **Definition of MSD**: $\\langle \\Delta x^{2} \\rangle(t) = \\langle \\left(x(t)-x(0)\\right)^{2} \\rangle$.\n- **Initial Condition**: $x(0)$ is drawn from a uniform probability distribution over $[0,L]$.\n- **Task 1**: Derive the early-time asymptotic expansion for $\\langle \\Delta x^{2} \\rangle(t)$ using the method of images, retaining the first correction to free diffusion.\n- **Task 2**: Construct an estimator for the bulk diffusion coefficient $D$ using two MSD measurements at times $t_1$ and $t_2$.\n- **Task 3**: Numerically evaluate $D$ using the provided data.\n- **Data**:\n    - $L=20\\,\\mathrm{nm}$\n    - $t_{1} = 1.0\\,\\mathrm{ns}$, $\\langle \\Delta x^{2} \\rangle(t_{1}) = 0.44340468\\,\\mathrm{nm}^{2}$\n    - $t_{2} = 4.0\\,\\mathrm{ns}$, $\\langle \\Delta x^{2} \\rangle(t_{2}) = 1.70723656\\,\\mathrm{nm}^{2}$\n- **Output Requirement**: Round the final value of $D$ to four significant figures and express it in $\\mathrm{nm}^{2}\\,\\mathrm{ns}^{-1}$.\n\n### Step 2: Validate Using Extracted Givens ###\nThe problem is scientifically grounded, well-posed, and objective.\n- **Scientific Grounding**: The problem describes Brownian motion in a confined geometry, a classic topic in statistical physics and computational materials science. The diffusion equation, Neumann boundary conditions for reflecting walls, and the definition of Mean Squared Displacement are all standard and correct. The long-time limit of the MSD is also a known correct result for this system. The requested method of images is a standard mathematical technique for solving this type of partial differential equation.\n- **Well-Posedness**: The problem is well-posed. The governing equation, boundary conditions, and initial distribution are specified, guaranteeing a unique solution for the probability distribution $P(x,t|x_0)$ and consequently for the MSD. The provided data is sufficient to determine the single unknown parameter $D$. The early-time condition $t \\ll L^2/D$ ensures the validity of the requested asymptotic expansion.\n- **Objectivity**: The problem is stated using precise, objective, and unambiguous scientific language.\n\n### Step 3: Verdict and Action ###\nThe problem is valid. A complete solution will be provided.\n\n## Solution ##\nThe problem asks for the bulk diffusion coefficient $D$ from early-time Mean Squared Displacement (MSD) data in a confined system. The solution proceeds in three parts: first, we derive the early-time asymptotic form of the MSD; second, we use this form to construct an estimator for $D$; third, we apply this estimator to the given data.\n\n### Part 1: Early-Time Asymptotic Expansion of the MSD ###\nThe MSD, averaged over a uniform initial distribution of starting positions $x_0 = x(0)$ in the interval $[0,L]$, is given by\n$$ \\langle \\Delta x^{2} \\rangle(t) = \\int_0^L \\frac{1}{L} \\langle(x(t)-x_0)^2\\rangle_{x_0} dx_0 $$\nwhere $\\langle(\\cdot)\\rangle_{x_0}$ denotes the average over all trajectories starting from $x_0$.\n\nFor a particle undergoing diffusion in one dimension bounded by a single reflecting wall at $x=0$, the MSD for a trajectory starting at $x_0$ is known to be:\n$$ \\langle(x(t)-x_0)^2\\rangle_{x_0, \\text{wall at 0}} = 2Dt - 2\\sqrt{4Dt} \\cdot x_0 \\cdot \\text{ierfc}\\left(\\frac{x_0}{\\sqrt{4Dt}}\\right) $$\nwhere $\\text{ierfc}(z) = \\int_z^\\infty \\text{erfc}(y)dy = \\frac{1}{\\sqrt{\\pi}}\\exp(-z^2) - z \\cdot \\text{erfc}(z)$ is the integrated complementary error function.\n\nIn the early-time regime ($t \\ll L^2/D$), the diffusion length $\\sqrt{Dt}$ is much smaller than the slit width $L$. In this limit, the effects of the two walls at $x=0$ and $x=L$ on a particle starting at $x_0$ can be treated as additive. The effect of the wall at $x=L$ is equivalent to that of a wall at $x=0$ for a particle starting at a distance $L-x_0$. Therefore, the conditional MSD in the slit is approximated by:\n$$ \\langle(x(t)-x_0)^2\\rangle_{x_0} \\approx 2Dt - 2\\sqrt{4Dt} \\left[ x_0 \\cdot \\text{ierfc}\\left(\\frac{x_0}{\\sqrt{4Dt}}\\right) + (L-x_0) \\cdot \\text{ierfc}\\left(\\frac{L-x_0}{\\sqrt{4Dt}}\\right) \\right] $$\nTo find the ensemble-averaged MSD, we integrate this expression over $x_0$ from $0$ to $L$:\n$$ \\langle \\Delta x^{2} \\rangle(t) \\approx 2Dt - \\frac{2\\sqrt{4Dt}}{L} \\int_0^L \\left[ x_0 \\cdot \\text{ierfc}\\left(\\frac{x_0}{\\sqrt{4Dt}}\\right) + (L-x_0) \\cdot \\text{ierfc}\\left(\\frac{L-x_0}{\\sqrt{4Dt}}\\right) \\right] dx_0 $$\nBy a change of variables $y_0 = L-x_0$, the second part of the integral is shown to be identical to the first:\n$$ \\int_0^L (L-x_0) \\cdot \\text{ierfc}\\left(\\frac{L-x_0}{\\sqrt{4Dt}}\\right) dx_0 = \\int_0^L y_0 \\cdot \\text{ierfc}\\left(\\frac{y_0}{\\sqrt{4Dt}}\\right) dy_0 $$\nThus, the expression simplifies to:\n$$ \\langle \\Delta x^{2} \\rangle(t) \\approx 2Dt - \\frac{4\\sqrt{4Dt}}{L} \\int_0^L x_0 \\cdot \\text{ierfc}\\left(\\frac{x_0}{\\sqrt{4Dt}}\\right) dx_0 $$\nWe evaluate the integral in the early-time limit. Let $z = x_0/\\sqrt{4Dt}$, so $x_0 = z\\sqrt{4Dt}$ and $dx_0 = \\sqrt{4Dt} dz$. The upper integration limit becomes $L/\\sqrt{4Dt}$, which goes to $\\infty$ as $t \\to 0$.\n$$ \\int_0^L x_0 \\cdot \\text{ierfc}\\left(\\frac{x_0}{\\sqrt{4Dt}}\\right) dx_0 \\approx \\int_0^\\infty (z\\sqrt{4Dt}) \\cdot \\text{ierfc}(z) \\cdot (\\sqrt{4Dt} dz) = 4Dt \\int_0^\\infty z \\cdot \\text{ierfc}(z) dz $$\nThe definite integral $\\int_0^\\infty z \\cdot \\text{ierfc}(z) dz$ can be solved using integration by parts, noting that $\\frac{d}{dz}\\text{ierfc}(z) = -\\text{erfc}(z)$:\n$$ \\int_0^\\infty z \\cdot \\text{ierfc}(z) dz = \\int_0^\\infty z \\left(\\int_z^\\infty \\text{erfc}(y) dy\\right) dz $$\nChanging the order of integration:\n$$ \\int_0^\\infty \\text{erfc}(y) \\left(\\int_0^y z dz\\right) dy = \\frac{1}{2} \\int_0^\\infty y^2 \\text{erfc}(y) dy $$\nThis integral is a known result, $\\int_0^\\infty y^2 \\text{erfc}(y) dy = 1/(3\\sqrt{\\pi})$.\nTherefore, $\\int_0^\\infty z \\cdot \\text{ierfc}(z) dz = \\frac{1}{6\\sqrt{\\pi}}$.\nSubstituting this back, we get:\n$$ \\int_0^L x_0 \\cdot \\text{ierfc}\\left(\\frac{x_0}{\\sqrt{4Dt}}\\right) dx_0 \\approx 4Dt \\cdot \\frac{1}{6\\sqrt{\\pi}} = \\frac{2Dt}{3\\sqrt{\\pi}} $$\nThe correction term in the MSD is:\n$$ - \\frac{4\\sqrt{4Dt}}{L} \\left(\\frac{2Dt}{3\\sqrt{\\pi}}\\right) = -\\frac{4 \\cdot 2\\sqrt{Dt}}{L} \\frac{2Dt}{3\\sqrt{\\pi}} = - \\frac{16 (Dt)^{3/2}}{3L\\sqrt{\\pi}} $$\nThe early-time asymptotic expansion for the MSD is thus:\n$$ \\langle \\Delta x^{2} \\rangle(t) = 2Dt - \\frac{16 D^{3/2}}{3L\\sqrt{\\pi}} t^{3/2} + \\dots $$\nThis expression has the form $\\langle \\Delta x^{2} \\rangle(t) = At - Bt^{3/2}$, where the leading term $At = 2Dt$ corresponds to free diffusion and the term $-Bt^{3/2}$ is the first nontrivial correction due to boundary reflections. The scaling is explicitly $D^{3/2}$, $t^{3/2}$, and $L^{-1}$.\n\n### Part 2: Construction of the Estimator for D ###\nWe have two measurements, $f(t_1) = \\langle \\Delta x^{2} \\rangle(t_{1})$ and $f(t_2) = \\langle \\Delta x^{2} \\rangle(t_{2})$, at two different early times $t_1$ and $t_2$. Using the derived asymptotic form:\n$$ f(t_1) = 2Dt_1 - B t_1^{3/2} \\quad (1) $$\n$$ f(t_2) = 2Dt_2 - B t_2^{3/2} \\quad (2) $$\nwhere $B = \\frac{16 D^{3/2}}{3L\\sqrt{\\pi}}$. Our goal is to eliminate $B$ and solve for $D$.\nFrom equation (1), we can express $B$ as:\n$$ B = \\frac{2Dt_1 - f(t_1)}{t_1^{3/2}} $$\nSubstitute this into equation (2):\n$$ f(t_2) = 2Dt_2 - \\left(\\frac{2Dt_1 - f(t_1)}{t_1^{3/2}}\\right) t_2^{3/2} $$\n$$ f(t_2) = 2Dt_2 - (2Dt_1 - f(t_1)) \\left(\\frac{t_2}{t_1}\\right)^{3/2} $$\nNow, we group terms with $D$:\n$$ f(t_2) - f(t_1) \\left(\\frac{t_2}{t_1}\\right)^{3/2} = 2Dt_2 - 2Dt_1 \\left(\\frac{t_2}{t_1}\\right)^{3/2} $$\n$$ f(t_2) - f(t_1) \\left(\\frac{t_2}{t_1}\\right)^{3/2} = 2D \\left[t_2 - t_1 \\left(\\frac{t_2}{t_1}\\right)^{3/2}\\right] $$\nSolving for $D$ gives the estimator:\n$$ D = \\frac{f(t_2) - f(t_1) \\left(\\frac{t_2}{t_1}\\right)^{3/2}}{2 \\left[t_2 - t_1 \\left(\\frac{t_2}{t_1}\\right)^{3/2}\\right]} $$\n\n### Part 3: Numerical Evaluation of D ###\nWe now apply this formula to the given data:\n- $t_{1} = 1.0\\,\\mathrm{ns}$\n- $f(t_{1}) = 0.44340468\\,\\mathrm{nm}^{2}$\n- $t_{2} = 4.0\\,\\mathrm{ns}$\n- $f(t_{2}) = 1.70723656\\,\\mathrm{nm}^{2}$\n\nFirst, we compute the time ratio-dependent term:\n$$ \\left(\\frac{t_2}{t_1}\\right)^{3/2} = \\left(\\frac{4.0}{1.0}\\right)^{3/2} = 4^{3/2} = (4^{1/2})^3 = 2^3 = 8 $$\nNow, substitute the values into the estimator for $D$:\n$$ D = \\frac{1.70723656 - (0.44340468) \\cdot 8}{2 [4.0 - (1.0) \\cdot 8]} $$\n$$ D = \\frac{1.70723656 - 3.54723744}{2 [4.0 - 8.0]} $$\n$$ D = \\frac{-1.84000088}{2(-4.0)} $$\n$$ D = \\frac{-1.84000088}{-8.0} $$\n$$ D = 0.23000011\\,\\mathrm{nm}^{2}\\,\\mathrm{ns}^{-1} $$\nRounding the result to four significant figures, we get:\n$$ D \\approx 0.2300\\,\\mathrm{nm}^{2}\\,\\mathrm{ns}^{-1} $$\nAll units are consistent, so no conversion is needed.", "answer": "$$\n\\boxed{0.2300}\n$$", "id": "3464978"}, {"introduction": "Real-world data from experiments or complex simulations are rarely perfect and often come with complications like measurement noise and incomplete observations. This advanced exercise [@problem_id:3465000] challenges you to estimate a diffusion coefficient from trajectories that are subject to both localization noise and \"censoring\" due to a particle annihilation process. You will construct a rigorous likelihood function and derive a Maximum Likelihood Estimator (MLE) for the diffusion coefficient $D$, introducing a powerful statistical framework for extracting accurate physical parameters from imperfect data.", "problem": "Consider mobile point defects diffusing on a crystalline surface in two spatial dimensions. Defects undergo stochastic annihilation upon encountering reactive sinks. Assume annihilation events occur according to a Poisson process with constant hazard $\\lambda$ that is independent of the defectâ€™s trajectory. Trajectories are observed at uniform sampling interval $\\Delta t$, and each trajectory is truncated at its annihilation time. You are given tracked positions until annihilation for three defects, sampled at $\\Delta t = 0.02 \\ \\mathrm{s}$. The instrument introduces independent, zero-mean, isotropic localization noise with variance $\\sigma^{2}$ per coordinate, where $\\sigma = 0.01 \\ \\mathrm{nm}$. Let $\\mathbf{R}(t)$ denote the observed position and $\\mathbf{r}(t)$ the true position. For each frame transition, the observed frame-to-frame increment is $\\Delta \\mathbf{R}_{m} = \\mathbf{R}(t_{m}) - \\mathbf{R}(t_{m-1})$.\n\nThe tracked data (in nanometers) for the frame-to-frame increments $\\Delta \\mathbf{R}_{m}$ are as follows, with each trajectory terminating when annihilation occurs:\n\nTrajectory $1$ ($3$ steps, total observed time $0.06 \\ \\mathrm{s}$):\n$\\Delta \\mathbf{R}_{1} = (0.12, -0.08)$, $\\Delta \\mathbf{R}_{2} = (0.05, 0.18)$, $\\Delta \\mathbf{R}_{3} = (-0.09, 0.02)$.\n\nTrajectory $2$ ($4$ steps, total observed time $0.08 \\ \\mathrm{s}$):\n$\\Delta \\mathbf{R}_{1} = (0.22, -0.05)$, $\\Delta \\mathbf{R}_{2} = (-0.10, 0.12)$, $\\Delta \\mathbf{R}_{3} = (0.15, -0.09)$, $\\Delta \\mathbf{R}_{4} = (-0.04, 0.03)$.\n\nTrajectory $3$ ($2$ steps, total observed time $0.04 \\ \\mathrm{s}$):\n$\\Delta \\mathbf{R}_{1} = (0.06, 0.14)$, $\\Delta \\mathbf{R}_{2} = (-0.11, -0.07)$.\n\nStarting from fundamental transport principles that govern diffusive motion, construct a statistically rigorous likelihood for the diffusion coefficient $D$ given the truncated segments. Explicitly handle the independent annihilation censoring mechanism through its hazard structure and argue its effect on the likelihood for $D$. Incorporate the stated localization noise model. Derive a closed-form maximum likelihood estimator for $D$ under the assumption of constant $\\Delta t$ across all steps, and then evaluate $D$ numerically using the provided data.\n\nExpress the final diffusion coefficient in $\\mathrm{nm}^{2} \\ \\mathrm{s}^{-1}$ and round your answer to four significant figures. The final answer must be a single real-valued number. Define any acronyms upon first use, such as Mean Squared Displacement (MSD) and Maximum Likelihood Estimation (MLE).", "solution": "The problem is first validated to ensure it is scientifically grounded, well-posed, and objective.\n\n### Step 1: Extract Givens\n-   **System**: Mobile point defects diffusing on a 2D crystalline surface.\n-   **Process**: Stochastic diffusion and annihilation.\n-   **Annihilation**: A Poisson process with a constant hazard rate $\\lambda$, independent of the defect's trajectory. Trajectories are truncated at the time of annihilation.\n-   **Observation Sampling**: Uniform time interval $\\Delta t = 0.02 \\ \\mathrm{s}$.\n-   **Localization Noise**: Independent, zero-mean, isotropic Gaussian noise with variance $\\sigma^2$ per coordinate, where $\\sigma = 0.01 \\ \\mathrm{nm}$. Thus, $\\sigma^2 = (0.01)^2 = 0.0001 \\ \\mathrm{nm}^2$.\n-   **Position Variables**: True position is $\\mathbf{r}(t)$, observed position is $\\mathbf{R}(t)$.\n-   **Observed Increment**: $\\Delta \\mathbf{R}_{m} = \\mathbf{R}(t_{m}) - \\mathbf{R}(t_{m-1})$.\n-   **Data**: Frame-to-frame increments $\\Delta \\mathbf{R}_m$ in units of nanometers.\n    -   Trajectory $1$ ($N_1=3$ steps): $\\Delta \\mathbf{R}_{1} = (0.12, -0.08)$, $\\Delta \\mathbf{R}_{2} = (0.05, 0.18)$, $\\Delta \\mathbf{R}_{3} = (-0.09, 0.02)$.\n    -   Trajectory $2$ ($N_2=4$ steps): $\\Delta \\mathbf{R}_{1} = (0.22, -0.05)$, $\\Delta \\mathbf{R}_{2} = (-0.10, 0.12)$, $\\Delta \\mathbf{R}_{3} = (0.15, -0.09)$, $\\Delta \\mathbf{R}_{4} = (-0.04, 0.03)$.\n    -   Trajectory $3$ ($N_3=2$ steps): $\\Delta \\mathbf{R}_{1} = (0.06, 0.14)$, $\\Delta \\mathbf{R}_{2} = (-0.11, -0.07)$.\n-   **Task**: (1) Construct the likelihood for the diffusion coefficient $D$. (2) Address the annihilation censoring. (3) Incorporate localization noise. (4) Derive the Maximum Likelihood Estimation (MLE) for $D$. (5) Calculate $D$ numerically, rounded to four significant figures.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically grounded, describing a standard model of 2D Brownian motion subject to measurement noise and right-censoring, a common scenario in single-particle tracking experiments in physics and biology. The model is well-posed, with a clear objective to estimate a physical parameter ($D$) from experimental data using a rigorous statistical framework (MLE). The language is objective and the data are internally consistent. There are no scientific or logical flaws. The problem asks to define acronyms, so Mean Squared Displacement (MSD) and Maximum Likelihood Estimation (MLE) will be defined.\n\n### Step 3: Verdict and Action\nThe problem is deemed **valid**. The solution process will now proceed.\n\n### Solution Derivation\nThe solution begins by modeling the observed physical process. The true position of a defect, $\\mathbf{r}(t)$, undergoes Brownian motion, characterized by a diffusion coefficient $D$. The displacement over a time interval $\\Delta t$, $\\Delta \\mathbf{r}(t) = \\mathbf{r}(t+\\Delta t) - \\mathbf{r}(t)$, is a random variable drawn from a 2D Gaussian distribution with mean zero. In two dimensions, the Mean Squared Displacement (MSD) is $\\langle |\\Delta \\mathbf{r}|^2 \\rangle = 4D\\Delta t$. The displacements in orthogonal directions, $\\Delta x$ and $\\Delta y$, are independent, each with variance $2D\\Delta t$.\n\nThe observed position $\\mathbf{R}(t)$ is the sum of the true position $\\mathbf{r}(t)$ and a random localization error $\\boldsymbol{\\epsilon}(t)$, such that $\\mathbf{R}(t) = \\mathbf{r}(t) + \\boldsymbol{\\epsilon}(t)$. The error components $\\epsilon_x$ and $\\epsilon_y$ are independent and identically distributed according to a zero-mean Gaussian with variance $\\sigma^2$, i.e., $\\epsilon_x, \\epsilon_y \\sim \\mathcal{N}(0, \\sigma^2)$.\n\nThe observed frame-to-frame increment is $\\Delta \\mathbf{R}_m = \\mathbf{R}(t_m) - \\mathbf{R}(t_{m-1})$. We can express this as:\n$$ \\Delta \\mathbf{R}_m = (\\mathbf{r}(t_m) - \\mathbf{r}(t_{m-1})) + (\\boldsymbol{\\epsilon}(t_m) - \\boldsymbol{\\epsilon}(t_{m-1})) = \\Delta \\mathbf{r}_m + \\Delta \\boldsymbol{\\epsilon}_m $$\nSince $\\Delta \\mathbf{r}_m$ and $\\Delta \\boldsymbol{\\epsilon}_m$ are independent random variables, the observed increment $\\Delta \\mathbf{R}_m$ is also a Gaussian random variable. Its mean is $\\langle \\Delta \\mathbf{R}_m \\rangle = \\langle \\Delta \\mathbf{r}_m \\rangle + \\langle \\boldsymbol{\\epsilon}(t_m) \\rangle - \\langle \\boldsymbol{\\epsilon}(t_{m-1}) \\rangle = \\mathbf{0} + \\mathbf{0} - \\mathbf{0} = \\mathbf{0}$.\n\nThe variance of each component of $\\Delta \\mathbf{R}_m$ is the sum of the variances of the corresponding components of $\\Delta \\mathbf{r}_m$ and $\\Delta \\boldsymbol{\\epsilon}_m$. For the $x$-component, $\\Delta R_x = \\Delta r_x + \\epsilon_x(t_m) - \\epsilon_x(t_{m-1})$. The variance is:\n$$ \\text{Var}(\\Delta R_x) = \\text{Var}(\\Delta r_x) + \\text{Var}(\\epsilon_x(t_m)) + \\text{Var}(\\epsilon_x(t_{m-1})) $$\nSince the noise terms at different times are independent, we have:\n$$ \\text{Var}(\\Delta R_x) = 2D\\Delta t + \\sigma^2 + \\sigma^2 = 2D\\Delta t + 2\\sigma^2 $$\nBy isotropy, $\\text{Var}(\\Delta R_y) = 2D\\Delta t + 2\\sigma^2$. Let's denote this total variance per component as $V = 2D\\Delta t + 2\\sigma^2$.\n\nThe probability density function (PDF) for observing a single increment $\\Delta \\mathbf{R}_m$ is a 2D Gaussian:\n$$ P(\\Delta \\mathbf{R}_m | D, \\sigma^2) = \\frac{1}{2\\pi V} \\exp\\left(-\\frac{|\\Delta \\mathbf{R}_m|^2}{2V}\\right) = \\frac{1}{2\\pi (2D\\Delta t + 2\\sigma^2)} \\exp\\left(-\\frac{|\\Delta \\mathbf{R}_m|^2}{2(2D\\Delta t + 2\\sigma^2)}\\right) $$\n\nNext, we construct the likelihood function for $D$. The problem states that annihilation is a Poisson process with a hazard rate $\\lambda$ that is independent of the trajectory. This means the probability of a trajectory terminating at a certain time is independent of the spatial steps taken. The full likelihood of the observed data (both steps and trajectory lengths) can be factored as $L(D, \\lambda | \\text{data}) = L_D(D | \\{\\Delta \\mathbf{R}_m\\}) \\cdot L_\\lambda(\\lambda | \\{T_i\\})$, where $\\{T_i\\}$ are the trajectory durations. Since we are only interested in estimating $D$, we can focus exclusively on the part of the likelihood that depends on $D$. The censoring mechanism, due to its independence, does not alter the functional form of the likelihood for $D$. Thus, the annihilation data (trajectory lengths) can be disregarded when finding the Maximum Likelihood Estimation (MLE) for $D$.\n\nThe displacements $\\Delta \\mathbf{R}_m$ are independent events. The total likelihood function for $D$ is the product of the PDFs for all $N = N_1+N_2+N_3 = 9$ observed steps:\n$$ L(D) = \\prod_{k=1}^{N} P(\\Delta \\mathbf{R}_k | D, \\sigma^2) = \\left(\\frac{1}{4\\pi(D\\Delta t + \\sigma^2)}\\right)^N \\exp\\left(-\\frac{\\sum_{k=1}^{N} |\\Delta \\mathbf{R}_k|^2}{4(D\\Delta t + \\sigma^2)}\\right) $$\nTo find the MLE for $D$, we maximize the log-likelihood function, $\\mathcal{L}(D) = \\ln L(D)$:\n$$ \\mathcal{L}(D) = -N\\ln(4\\pi) - N\\ln(D\\Delta t + \\sigma^2) - \\frac{\\sum_{k=1}^{N} |\\Delta \\mathbf{R}_k|^2}{4(D\\Delta t + \\sigma^2)} $$\nWe take the derivative with respect to $D$ and set it to zero:\n$$ \\frac{d\\mathcal{L}}{dD} = -N \\frac{\\Delta t}{D\\Delta t + \\sigma^2} - \\left( \\sum_{k=1}^{N} |\\Delta \\mathbf{R}_k|^2 \\right) \\left(-\\frac{1}{4}\\right) \\frac{\\Delta t}{(D\\Delta t + \\sigma^2)^2} = 0 $$\n$$ \\frac{N \\Delta t}{D\\Delta t + \\sigma^2} = \\frac{\\Delta t \\sum_{k=1}^{N} |\\Delta \\mathbf{R}_k|^2}{4(D\\Delta t + \\sigma^2)^2} $$\nSolving for $(D\\Delta t + \\sigma^2)$:\n$$ 4(D\\Delta t + \\sigma^2) = \\frac{1}{N} \\sum_{k=1}^{N} |\\Delta \\mathbf{R}_k|^2 $$\nThe term $\\frac{1}{N}\\sum |\\Delta \\mathbf{R}_k|^2$ is the sample Mean Squared Displacement, $\\text{MSD}_{obs}$. The expression relates the theoretical expectation of the squared displacement to its sample average. The expected MSD for observed 2D diffusion with noise is $E[\\text{MSD}_{obs}] = 4D\\Delta t + 4\\sigma^2$. The MLE sets this equal to the observed value.\n$$ 4D\\Delta t + 4\\sigma^2 = \\frac{1}{N} \\sum_{k=1}^{N} |\\Delta \\mathbf{R}_k|^2 $$\nSolving for the MLE of $D$, denoted $\\hat{D}_{MLE}$:\n$$ \\hat{D}_{MLE} = \\frac{1}{4\\Delta t} \\left( \\frac{1}{N} \\sum_{k=1}^{N} |\\Delta \\mathbf{R}_k|^2 - 4\\sigma^2 \\right) $$\n\nNow, we evaluate this estimator numerically.\nGiven: $\\Delta t = 0.02 \\ \\mathrm{s}$, $\\sigma = 0.01 \\ \\mathrm{nm}$, so $\\sigma^2 = 0.0001 \\ \\mathrm{nm}^2$. The total number of steps is $N = 3+4+2=9$.\n\nWe calculate the sum of squared displacements, $\\sum_{k=1}^{N} |\\Delta \\mathbf{R}_k|^2$:\nFor Trajectory 1:\n$|\\Delta \\mathbf{R}_1|^2 = (0.12)^2 + (-0.08)^2 = 0.0144 + 0.0064 = 0.0208 \\ \\mathrm{nm}^2$\n$|\\Delta \\mathbf{R}_2|^2 = (0.05)^2 + (0.18)^2 = 0.0025 + 0.0324 = 0.0349 \\ \\mathrm{nm}^2$\n$|\\Delta \\mathbf{R}_3|^2 = (-0.09)^2 + (0.02)^2 = 0.0081 + 0.0004 = 0.0085 \\ \\mathrm{nm}^2$\nSum for Trajectory 1: $0.0208 + 0.0349 + 0.0085 = 0.0642 \\ \\mathrm{nm}^2$\n\nFor Trajectory 2:\n$|\\Delta \\mathbf{R}_1|^2 = (0.22)^2 + (-0.05)^2 = 0.0484 + 0.0025 = 0.0509 \\ \\mathrm{nm}^2$\n$|\\Delta \\mathbf{R}_2|^2 = (-0.10)^2 + (0.12)^2 = 0.0100 + 0.0144 = 0.0244 \\ \\mathrm{nm}^2$\n$|\\Delta \\mathbf{R}_3|^2 = (0.15)^2 + (-0.09)^2 = 0.0225 + 0.0081 = 0.0306 \\ \\mathrm{nm}^2$\n$|\\Delta \\mathbf{R}_4|^2 = (-0.04)^2 + (0.03)^2 = 0.0016 + 0.0009 = 0.0025 \\ \\mathrm{nm}^2$\nSum for Trajectory 2: $0.0509 + 0.0244 + 0.0306 + 0.0025 = 0.1084 \\ \\mathrm{nm}^2$\n\nFor Trajectory 3:\n$|\\Delta \\mathbf{R}_1|^2 = (0.06)^2 + (0.14)^2 = 0.0036 + 0.0196 = 0.0232 \\ \\mathrm{nm}^2$\n$|\\Delta \\mathbf{R}_2|^2 = (-0.11)^2 + (-0.07)^2 = 0.0121 + 0.0049 = 0.0170 \\ \\mathrm{nm}^2$\nSum for Trajectory 3: $0.0232 + 0.0170 = 0.0402 \\ \\mathrm{nm}^2$\n\nThe total sum of squared displacements is:\n$$ \\sum_{k=1}^{9} |\\Delta \\mathbf{R}_k|^2 = 0.0642 + 0.1084 + 0.0402 = 0.2128 \\ \\mathrm{nm}^2 $$\nThe sample MSD is $\\frac{1}{9}(0.2128) \\ \\mathrm{nm}^2 \\approx 0.023644 \\ \\mathrm{nm}^2$.\n\nNow, substitute the values into the estimator for $D$:\n$$ \\hat{D}_{MLE} = \\frac{1}{4(0.02)} \\left( \\frac{0.2128}{9} - 4(0.0001) \\right) $$\n$$ \\hat{D}_{MLE} = \\frac{1}{0.08} \\left( \\frac{0.2128}{9} - 0.0004 \\right) $$\n$$ \\hat{D}_{MLE} = 12.5 \\times (0.0236444... - 0.0004) $$\n$$ \\hat{D}_{MLE} = 12.5 \\times (0.0232444...) $$\n$$ \\hat{D}_{MLE} = 0.290555... \\ \\mathrm{nm}^2 \\ \\mathrm{s}^{-1} $$\nRounding to four significant figures, we get $0.2906$.\n\nThe units are $\\mathrm{nm}^2/\\mathrm{s}$, which is consistent with the definition of a diffusion coefficient.\nFinal calculation check:\n$\\frac{1}{N} \\sum |\\Delta \\mathbf{R}_k|^2 = \\frac{0.2128}{9}$\n$4\\sigma^2 = 4 \\times 0.0001 = 0.0004$\n$4\\Delta t = 4 \\times 0.02 = 0.08$\n$D = \\frac{1}{0.08} \\left( \\frac{0.2128}{9} - 0.0004 \\right) = \\frac{1}{0.08} \\left( \\frac{0.2128 - 9 \\times 0.0004}{9} \\right)$\n$D = \\frac{1}{0.72} (0.2128 - 0.0036) = \\frac{0.2092}{0.72} = 0.290555...$\nThe calculation is correct.\nThe final value for the diffusion coefficient $D$, rounded to four significant figures, is $0.2906 \\ \\mathrm{nm}^2\\mathrm{s}^{-1}$.", "answer": "$$\n\\boxed{0.2906}\n$$", "id": "3465000"}]}