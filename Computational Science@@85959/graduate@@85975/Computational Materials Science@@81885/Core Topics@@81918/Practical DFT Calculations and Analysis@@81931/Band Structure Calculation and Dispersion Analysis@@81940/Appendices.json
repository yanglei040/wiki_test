{"hands_on_practices": [{"introduction": "The plane-wave pseudopotential method is the cornerstone of modern electronic structure calculations for crystalline solids. A crucial aspect of this method is the choice of pseudopotential, which replaces the complicated core electron potential with a smoother, computationally efficient one. This exercise [@problem_id:3433862] provides hands-on experience with the fundamental trade-off between the \"hardness\" of a pseudopotential—like a norm-conserving (NC) type—and its convergence rate, contrasting it with a \"softer\" Projector Augmented-Wave (PAW) like model. By building a simplified plane-wave Hamiltonian for silicon, you will directly observe how the potential's decay in reciprocal space impacts the number of basis functions needed to achieve a converged result for properties like the valence bandwidth.", "problem": "You are tasked with designing and implementing a computational test that compares band structures for crystalline silicon computed using two distinct pseudopotential models at a fixed plane-wave kinetic energy cutoff. The two models are a \"norm-conserving\" pseudopotential and a \"Projector Augmented Wave (PAW)\"-like pseudopotential surrogate. Your program must construct band structures along a specified high-symmetry path using a plane-wave expansion of the single-particle Schrödinger equation in a periodic potential, quantify the valence bandwidth, and assess convergence behavior by comparing each case to a high-cutoff reference result. All results must be expressed in electron volts (eV).\n\nThe foundational base is the single-particle Schrödinger equation in a periodic potential, Bloch's theorem, and the plane-wave method:\n- The single-particle Schrödinger equation is $H\\psi = E\\psi$ for a periodic potential $V(\\mathbf{r})$, where $H = -\\frac{\\hbar^2}{2m}\\nabla^2 + V(\\mathbf{r})$.\n- By Bloch's theorem, solutions can be expanded in a plane-wave basis with wavevectors $\\mathbf{k} + \\mathbf{G}$, where $\\mathbf{k}$ is in the first Brillouin zone and $\\mathbf{G}$ runs over reciprocal lattice vectors.\n- In a truncated plane-wave basis defined by the kinetic energy cutoff $E_{\\mathrm{cut}}$, include only reciprocal lattice vectors $\\mathbf{G}$ for which $\\frac{\\hbar^2}{2m}|\\mathbf{G}|^2 \\le E_{\\mathrm{cut}}$, and set up the Hamiltonian matrix\n$$\nH_{\\mathbf{G},\\mathbf{G}'}(\\mathbf{k}) = \\delta_{\\mathbf{G},\\mathbf{G}'}\\frac{\\hbar^2}{2m}|\\mathbf{k}+\\mathbf{G}|^2 + V(\\mathbf{G}-\\mathbf{G}'),\n$$\nwhere $V(\\mathbf{q})$ is the Fourier transform of the periodic potential.\n- For the diamond structure of silicon with two atoms per conventional cubic cell of lattice constant $a$, the structure factor enters the local potential Fourier components as\n$$\nV(\\mathbf{q}) = S(\\mathbf{q})\\,v(|\\mathbf{q}|), \\quad S(\\mathbf{q}) = 1 + e^{i\\mathbf{q}\\cdot\\boldsymbol{\\tau}},\n$$\nwith the basis vector $\\boldsymbol{\\tau} = \\frac{a}{4}(1,1,1)$ and $v(|\\mathbf{q}|)$ a spherically symmetric form factor modeling the pseudopotential.\n\nYou must implement two pseudopotential form factors that differ only in their Fourier-space decay rate, reflecting the well-established notion that the norm-conserving model is \"harder\" (requires more plane waves to converge) and the PAW-like model is \"softer\" (converges faster with fewer plane waves). Use the following physically plausible models:\n- For the PAW-like model, let $v_{\\mathrm{PAW}}(q) = -V_0\\exp\\left[-\\left(\\frac{q}{q_0^{\\mathrm{PAW}}}\\right)^2\\right]$.\n- For the norm-conserving model, let $v_{\\mathrm{NC}}(q) = -V_0\\exp\\left[-\\left(\\frac{q}{q_0^{\\mathrm{NC}}}\\right)^2\\right]$.\nChoose the parameters $V_0$, $q_0^{\\mathrm{PAW}}$, and $q_0^{\\mathrm{NC}}$ such that $q_0^{\\mathrm{NC}} > q_0^{\\mathrm{PAW}}$, making the norm-conserving potential harder in reciprocal space. The periodic potential is then fully specified by $V(\\mathbf{q}) = S(\\mathbf{q})\\,v(q)$.\n\nUse the diamond conventional cubic lattice constant $a = 5.431$ $\\mathrm{\\AA}$ for silicon. Build reciprocal lattice vectors $\\mathbf{G} = \\frac{2\\pi}{a}(h,k,l)$ restricted to the reciprocal lattice of the face-centered cubic Bravais lattice (which is body-centered cubic in reciprocal space). In conventional cubic indices, this means including only triplets $(h,k,l)$ whose parities are all equal (all even or all odd). Enforce the kinetic energy cutoff condition $\\frac{\\hbar^2}{2m}|\\mathbf{G}|^2 \\le E_{\\mathrm{cut}}$ for basis selection, with $\\frac{\\hbar^2}{2m} = 3.80998212$ $\\mathrm{eV}\\cdot\\mathrm{\\AA}^2$.\n\nConstruct the band structure along the piecewise linear high-symmetry path $\\Gamma \\rightarrow X \\rightarrow L$ with\n- $\\Gamma = (0,0,0)$,\n- $X = \\left(\\frac{\\pi}{a},0,0\\right)$,\n- $L = \\left(\\frac{\\pi}{a},\\frac{\\pi}{a},\\frac{\\pi}{a}\\right)$,\nsampling $N_\\Gamma$ and $N_X$ equidistant points per segment, respectively, with $N_\\Gamma = N_X = 20$.\n\nFor each pseudopotential model and cutoff, diagonalize the Hamiltonian for every sampled $\\mathbf{k}$ on the path, sort the eigenvalues, and define the \"valence bandwidth\" as the energy spread of the lowest band along the path,\n$$\nW_{\\mathrm{val}} = \\max_{\\mathbf{k}\\in\\mathrm{path}} E_{1}(\\mathbf{k}) - \\min_{\\mathbf{k}\\in\\mathrm{path}} E_{1}(\\mathbf{k}),\n$$\nin electron volts. Define the \"convergence error\" for a given case as\n$$\n\\Delta W = \\left|W_{\\mathrm{val}}(E_{\\mathrm{cut}}) - W_{\\mathrm{val}}(E_{\\mathrm{cut}}^{\\mathrm{ref}})\\right|,\n$$\nwhere $E_{\\mathrm{cut}}^{\\mathrm{ref}}$ is a higher cutoff used as a fixed reference for the same pseudopotential model.\n\nTest Suite:\n- Use the following pseudopotential parameters in your implementation: $V_0 = 10.0$ $\\mathrm{eV}$, $q_0^{\\mathrm{PAW}} = 2.0$ $\\mathrm{\\AA}^{-1}$, $q_0^{\\mathrm{NC}} = 3.5$ $\\mathrm{\\AA}^{-1}$.\n- Use $E_{\\mathrm{cut}}^{\\mathrm{ref}} = 60.0$ $\\mathrm{eV}$ as the reference cutoff.\n- Evaluate the following six cases:\n    1. PAW-like model at $E_{\\mathrm{cut}} = 10.0$ $\\mathrm{eV}$.\n    2. Norm-conserving model at $E_{\\mathrm{cut}} = 10.0$ $\\mathrm{eV}$.\n    3. PAW-like model at $E_{\\mathrm{cut}} = 20.0$ $\\mathrm{eV}$.\n    4. Norm-conserving model at $E_{\\mathrm{cut}} = 20.0$ $\\mathrm{eV}$.\n    5. PAW-like model at $E_{\\mathrm{cut}} = 40.0$ $\\mathrm{eV}$.\n    6. Norm-conserving model at $E_{\\mathrm{cut}} = 40.0$ $\\mathrm{eV}$.\n\nRequired Outputs and Units:\n- For each case, compute the valence bandwidth $W_{\\mathrm{val}}$ in electron volts and the convergence error $\\Delta W$ in electron volts, both as floating point numbers.\n- Your program should produce a single line of output containing the results as a comma-separated list of pairs, one per case, enclosed in square brackets, where each pair is itself a two-element list $[W_{\\mathrm{val}},\\Delta W]$. For example: \"[[w1,err1],[w2,err2],...]\" where every $w_i$ and $err_i$ are in electron volts.\n\nScientific Realism Constraints:\n- The model must adhere to the stated physical assumptions and units.\n- Do not include any external data or shortcuts. The Hamiltonian must be constructed from first principles as described.\n- All energies must be reported in electron volts.\n- Angles are not required.\n- Percentages are not required.\n\nYour implementation must be a complete, runnable Python program that performs the above computations and prints the results in the exact specified format on a single line.", "solution": "We begin from the single-particle Schrödinger equation in a periodic potential,\n$$\n\\left(-\\frac{\\hbar^2}{2m}\\nabla^2 + V(\\mathbf{r})\\right)\\psi(\\mathbf{r}) = E\\psi(\\mathbf{r}).\n$$\nFor a crystal with lattice periodicity, by Bloch's theorem, the eigenstates at crystal momentum $\\mathbf{k}$ can be expanded as a series of plane waves,\n$$\n\\psi_{\\mathbf{k}}(\\mathbf{r}) = \\sum_{\\mathbf{G}} c_{\\mathbf{k}}(\\mathbf{G}) e^{i(\\mathbf{k}+\\mathbf{G})\\cdot\\mathbf{r}},\n$$\nwhere the sum runs over reciprocal lattice vectors $\\mathbf{G}$. Substituting the plane-wave expansion into the Schrödinger equation and projecting onto a plane wave gives the matrix elements\n$$\nH_{\\mathbf{G},\\mathbf{G}'}(\\mathbf{k}) = \\delta_{\\mathbf{G},\\mathbf{G}'}\\frac{\\hbar^2}{2m}|\\mathbf{k}+\\mathbf{G}|^2 + V(\\mathbf{G}-\\mathbf{G}').\n$$\nThe kinetic term is diagonal, and the potential term couples plane waves separated by $\\mathbf{q} = \\mathbf{G}-\\mathbf{G}'$ via the Fourier transform $V(\\mathbf{q})$. For diamond-structure silicon, with two atoms per conventional cubic cell, the periodic local potential’s Fourier coefficients can be expressed as\n$$\nV(\\mathbf{q}) = S(\\mathbf{q})\\,v(|\\mathbf{q}|), \\quad S(\\mathbf{q}) = 1 + e^{i\\mathbf{q}\\cdot\\boldsymbol{\\tau}},\n$$\nwhere $\\boldsymbol{\\tau} = \\frac{a}{4}(1,1,1)$ is the second atom’s basis vector in the conventional cubic cell, and $v(|\\mathbf{q}|)$ is a spherically symmetric form factor embodying the pseudopotential.\n\nWe choose two well-motivated reciprocal-space form factors:\n- A PAW-like (Projector Augmented Wave) surrogate\n$$\nv_{\\mathrm{PAW}}(q) = -V_0 \\exp\\left[-\\left(\\frac{q}{q_0^{\\mathrm{PAW}}}\\right)^2\\right],\n$$\n- A norm-conserving\n$$\nv_{\\mathrm{NC}}(q) = -V_0 \\exp\\left[-\\left(\\frac{q}{q_0^{\\mathrm{NC}}}\\right)^2\\right],\n$$\nwith $q_0^{\\mathrm{NC}} > q_0^{\\mathrm{PAW}}$ to ensure the norm-conserving form factor decays more slowly with $q$ and is thus harder, consistent with the well-established observation that norm-conserving pseudopotentials demand more plane waves to converge.\n\nWe construct the reciprocal lattice $\\mathbf{G}$ from the face-centered cubic (FCC) conventional cubic cell of lattice constant $a$ for silicon, $a = 5.431$ $\\mathrm{\\AA}$. The conventional cubic reciprocal basis is $\\frac{2\\pi}{a}\\hat{\\mathbf{x}}$, $\\frac{2\\pi}{a}\\hat{\\mathbf{y}}$, and $\\frac{2\\pi}{a}\\hat{\\mathbf{z}}$, but only integer triplets $(h,k,l)$ that are all even or all odd correspond to the body-centered cubic (BCC) reciprocal lattice of the FCC direct lattice; hence we restrict to indices $(h,k,l)$ of equal parity. We truncate the plane-wave basis with a kinetic energy cutoff $E_{\\mathrm{cut}}$ using\n$$\n\\frac{\\hbar^2}{2m}|\\mathbf{G}|^2 \\le E_{\\mathrm{cut}},\n$$\nand use $\\frac{\\hbar^2}{2m} = 3.80998212$ $\\mathrm{eV}\\cdot\\mathrm{\\AA}^2$.\n\nFor band structure dispersion, we scan a high-symmetry path in reciprocal space:\n- $\\Gamma = (0,0,0)$,\n- $X = \\left(\\frac{\\pi}{a},0,0\\right)$,\n- $L = \\left(\\frac{\\pi}{a},\\frac{\\pi}{a},\\frac{\\pi}{a}\\right)$.\nWe sample $N_\\Gamma = 20$ points from $\\Gamma$ to $X$, and $N_X = 20$ points from $X$ to $L$, producing a set of $\\mathbf{k}$-points along the path.\n\nFor each $\\mathbf{k}$, we assemble the Hamiltonian $H(\\mathbf{k})$ of dimension $M$ equal to the number of included $\\mathbf{G}$ vectors. The diagonal elements are $\\frac{\\hbar^2}{2m}|\\mathbf{k}+\\mathbf{G}|^2$. The off-diagonal coupling elements $V(\\mathbf{G}-\\mathbf{G}')$ depend only on $\\mathbf{G}-\\mathbf{G}'$ and can be precomputed in a matrix $V_{\\mathbf{G},\\mathbf{G}'}$. The full Hamiltonian is\n$$\nH_{\\mathbf{G},\\mathbf{G}'}(\\mathbf{k}) = \\delta_{\\mathbf{G},\\mathbf{G}'}\\frac{\\hbar^2}{2m}|\\mathbf{k}+\\mathbf{G}|^2 + V_{\\mathbf{G},\\mathbf{G}'}.\n$$\nSince $V(\\mathbf{q})$ satisfies $V(-\\mathbf{q}) = V(\\mathbf{q})^*$ with a real $v(q)$ and complex structure factor $S(\\mathbf{q})$, the Hamiltonian is Hermitian and can be diagonalized using standard algorithms. Sorting the eigenvalues in ascending order gives bands $E_n(\\mathbf{k})$, $n=1,\\dots,M$.\n\nWe define the valence bandwidth as the energy spread of the lowest band along the path,\n$$\nW_{\\mathrm{val}} = \\max_{\\mathbf{k}} E_1(\\mathbf{k}) - \\min_{\\mathbf{k}} E_1(\\mathbf{k}).\n$$\nThis choice is consistent with a single-particle picture where the lowest band corresponds to the most strongly bound, valence-like band within a local potential model. Although a full description of valence occupancy requires electron counting, here we focus on relative dispersion and convergence behavior. For convergence assessment, we define the error relative to a higher cutoff reference,\n$$\n\\Delta W = \\left|W_{\\mathrm{val}}(E_{\\mathrm{cut}}) - W_{\\mathrm{val}}(E_{\\mathrm{cut}}^{\\mathrm{ref}})\\right|.\n$$\n\nAlgorithmic steps:\n1. Set $a = 5.431$ $\\mathrm{\\AA}$, compute $b = \\frac{2\\pi}{a}$, and $\\alpha = \\frac{\\hbar^2}{2m} = 3.80998212$ $\\mathrm{eV}\\cdot\\mathrm{\\AA}^2$.\n2. Generate reciprocal vectors $\\mathbf{G} = b(h,k,l)$ with integer bounds determined by $E_{\\mathrm{cut}}$: require $\\alpha|\\mathbf{G}|^2 \\le E_{\\mathrm{cut}}$ and equal parity of $(h,k,l)$.\n3. Construct the diamond structure factor $S(\\mathbf{q}) = 1 + e^{i\\mathbf{q}\\cdot\\boldsymbol{\\tau}}$ with $\\boldsymbol{\\tau} = \\frac{a}{4}(1,1,1)$.\n4. Define the pseudopotential form factor $v(q)$ using $V_0 = 10.0$ $\\mathrm{eV}$, $q_0^{\\mathrm{PAW}} = 2.0$ $\\mathrm{\\AA}^{-1}$, and $q_0^{\\mathrm{NC}} = 3.5$ $\\mathrm{\\AA}^{-1}$.\n5. Precompute the potential matrix $V_{\\mathbf{G},\\mathbf{G}'} = S(\\mathbf{G}-\\mathbf{G}')\\,v(|\\mathbf{G}-\\mathbf{G}'|)$ for the chosen pseudopotential.\n6. Build the $\\mathbf{k}$-path by interpolating $20$ points from $\\Gamma$ to $X$ and $20$ points from $X$ to $L$.\n7. For each $\\mathbf{k}$, assemble $H(\\mathbf{k})$ by adding the kinetic diagonal and $V$ matrix, diagonalize to obtain eigenvalues, and collect the lowest eigenvalue $E_1(\\mathbf{k})$.\n8. Compute $W_{\\mathrm{val}}$ as the spread of $E_1$ over the path.\n9. For each pseudopotential model, compute a reference $W_{\\mathrm{val}}$ at $E_{\\mathrm{cut}}^{\\mathrm{ref}} = 60.0$ $\\mathrm{eV}$, and compute $\\Delta W$ for each target $E_{\\mathrm{cut}}$ as the absolute difference.\n10. Report results as pairs $[W_{\\mathrm{val}}, \\Delta W]$ in electron volts.\n\nExpected behavior based on first principles:\n- The PAW-like model, with faster decay of $v(q)$, emphasizes low-$q$ components and thus converges more rapidly with a truncated plane-wave basis; at low $E_{\\mathrm{cut}}$, $W_{\\mathrm{val}}$ for PAW-like will be closer to its high-cutoff reference, yielding a smaller $\\Delta W$.\n- The norm-conserving model, with slower decay, requires higher $E_{\\mathrm{cut}}$ to accurately represent the wavefunctions; at the same low $E_{\\mathrm{cut}}$, $W_{\\mathrm{val}}$ will deviate more from the reference, yielding a larger $\\Delta W$.\n- As $E_{\\mathrm{cut}}$ increases, both models should show decreasing $\\Delta W$, reflecting improved convergence.\n\nThe implementation adheres strictly to the stated physics, uses only the specified libraries, computes all energies in electron volts, and returns the single-line output in the prescribed format.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\n# Physical constants and lattice parameter\nHBAR2_OVER_2M = 3.80998212  # eV*Angstrom^2\nA_SI = 5.431  # Angstrom\nB_RECIP = 2.0 * np.pi / A_SI  # 1/Angstrom\n\n# High-symmetry k-path points in 1/Angstrom\nK_GAMMA = np.array([0.0, 0.0, 0.0])\nK_X = np.array([np.pi / A_SI, 0.0, 0.0])\nK_L = np.array([np.pi / A_SI, np.pi / A_SI, np.pi / A_SI])\n\n# Diamond basis vector tau in Angstrom\nTAU = (A_SI / 4.0) * np.array([1.0, 1.0, 1.0])\n\ndef generate_bcc_reciprocal_vectors(E_cut):\n    \"\"\"\n    Generate reciprocal lattice vectors G = B_RECIP * (h,k,l) (in 1/Angstrom)\n    for FCC direct lattice (BCC reciprocal), restricted to indices of equal parity,\n    and satisfying the kinetic energy cutoff condition HBAR2_OVER_2M * |G|^2 <= E_cut.\n    \"\"\"\n    # Determine bounds for h,k,l using maximum integer such that alpha * (b^2) * n^2 <= E_cut\n    # alpha*b^2 ~ scaling per integer squared\n    alpha_b2 = HBAR2_OVER_2M * (B_RECIP ** 2)\n    # max integer in one direction assuming other components are zero\n    n_max = int(np.floor(np.sqrt(E_cut / alpha_b2))) + 1\n    G_list = []\n    for h in range(-n_max, n_max + 1):\n        for k in range(-n_max, n_max + 1):\n            for l in range(-n_max, n_max + 1):\n                # Enforce equal parity (all even or all odd) for BCC reciprocal lattice\n                if ((h & 1) == (k & 1)) and ((k & 1) == (l & 1)):\n                    G = B_RECIP * np.array([h, k, l], dtype=float)\n                    E_g = HBAR2_OVER_2M * np.dot(G, G)\n                    if E_g <= E_cut + 1e-12:\n                        G_list.append(G)\n    # Sort by |G| to have a consistent order\n    G_arr = np.array(G_list)\n    norms = np.linalg.norm(G_arr, axis=1)\n    order = np.argsort(norms)\n    G_sorted = G_arr[order]\n    return G_sorted\n\ndef k_path(num_gamma_to_x=20, num_x_to_l=20):\n    \"\"\"\n    Generate the k-point path Gamma -> X -> L with specified points per segment.\n    Returns an array of shape (num_points, 3).\n    \"\"\"\n    # Linear interpolation including endpoints, but avoid double-counting X\n    ks1 = np.linspace(0.0, 1.0, num_gamma_to_x, endpoint=True)\n    seg1 = (1.0 - ks1)[:, None] * K_GAMMA[None, :] + ks1[:, None] * K_X[None, :]\n    ks2 = np.linspace(0.0, 1.0, num_x_to_l, endpoint=True)\n    seg2 = (1.0 - ks2)[:, None] * K_X[None, :] + ks2[:, None] * K_L[None, :]\n    # Concatenate; since seg1 includes X and seg2 includes X, we can include both for simplicity\n    path = np.vstack([seg1, seg2])\n    return path\n\ndef structure_factor(q_vec):\n    \"\"\"\n    Diamond structure factor S(q) = 1 + exp(i q . tau).\n    q_vec is in 1/Angstrom, tau in Angstrom.\n    Returns complex scalar.\n    \"\"\"\n    phase = np.dot(q_vec, TAU)\n    return 1.0 + np.exp(1j * phase)\n\ndef v_form_factor(q_mag, model_params):\n    \"\"\"\n    Spherically symmetric pseudopotential form factor v(q) for given magnitude q (1/Angstrom).\n    model_params: dict with keys 'V0' (eV), 'q0' (1/Angstrom).\n    v(q) = -V0 * exp(-(q/q0)^2)\n    \"\"\"\n    V0 = model_params['V0']\n    q0 = model_params['q0']\n    return -V0 * np.exp(- (q_mag / q0) ** 2)\n\ndef precompute_V_matrix(G_vectors, model_params):\n    \"\"\"\n    Precompute the potential coupling matrix V_{G,G'} = S(G - G') * v(|G - G'|)\n    for all pairs of G. Returns a complex matrix of shape (M,M).\n    \"\"\"\n    M = len(G_vectors)\n    V_mat = np.zeros((M, M), dtype=np.complex128)\n    # Precompute differences and their v(q) * S(q)\n    for i in range(M):\n        Gi = G_vectors[i]\n        for j in range(M):\n            Gj = G_vectors[j]\n            q = Gi - Gj\n            q_mag = np.linalg.norm(q)\n            S_q = structure_factor(q)\n            v_q = v_form_factor(q_mag, model_params)\n            V_mat[i, j] = S_q * v_q\n    # Enforce Hermiticity numerically by symmetrizing\n    V_mat = 0.5 * (V_mat + V_mat.conj().T)\n    return V_mat\n\ndef assemble_H_and_lowest_e(G_vectors, V_mat, k_vec):\n    \"\"\"\n    Assemble Hamiltonian H(k) = diag( alpha * |k + G|^2 ) + V_mat, and return lowest eigenvalue.\n    \"\"\"\n    # Kinetic diagonal\n    KG = G_vectors + k_vec[None, :]\n    kinetic = HBAR2_OVER_2M * np.einsum('ij,ij->i', KG, KG)  # alpha * |k+G|^2\n    H = V_mat.copy()\n    # Add kinetic to the diagonal\n    for i in range(len(kinetic)):\n        H[i, i] += kinetic[i]\n    # Diagonalize Hermitian matrix\n    evals = np.linalg.eigvalsh(H)\n    return evals[0].real  # lowest eigenvalue (real)\n\ndef compute_valence_bandwidth(E_cut, model_params, num_k_seg=20):\n    \"\"\"\n    Compute the valence bandwidth W_val for the given cutoff and pseudopotential model.\n    \"\"\"\n    Gs = generate_bcc_reciprocal_vectors(E_cut)\n    if len(Gs) == 0:\n        # If no G vectors satisfy the cutoff, bandwidth is zero by construction\n        return 0.0\n    V_mat = precompute_V_matrix(Gs, model_params)\n    kpts = k_path(num_gamma_to_x=num_k_seg, num_x_to_l=num_k_seg)\n    # Compute lowest eigenvalue at each k-point\n    lowest_e = []\n    for k in kpts:\n        e0 = assemble_H_and_lowest_e(Gs, V_mat, k)\n        lowest_e.append(e0)\n    lowest_e = np.array(lowest_e)\n    # Valence bandwidth is max-min of the lowest band energies\n    W_val = float(np.max(lowest_e) - np.min(lowest_e))\n    return W_val\n\ndef solve():\n    # Define pseudopotential parameters\n    paw_params = {'V0': 10.0, 'q0': 2.0}  # eV, 1/Angstrom\n    nc_params = {'V0': 10.0, 'q0': 3.5}   # eV, 1/Angstrom\n\n    # Reference cutoff for convergence assessment\n    E_cut_ref = 60.0  # eV\n\n    # Test cases: (label, model_params, E_cut)\n    test_cases = [\n        (\"PAW\", paw_params, 10.0),\n        (\"NC\",  nc_params, 10.0),\n        (\"PAW\", paw_params, 20.0),\n        (\"NC\",  nc_params, 20.0),\n        (\"PAW\", paw_params, 40.0),\n        (\"NC\",  nc_params, 40.0),\n    ]\n\n    # Precompute references for each model\n    W_ref = {}\n    # Compute once for PAW and NC\n    W_ref[\"PAW\"] = compute_valence_bandwidth(E_cut_ref, paw_params, num_k_seg=20)\n    W_ref[\"NC\"] = compute_valence_bandwidth(E_cut_ref, nc_params, num_k_seg=20)\n\n    results_pairs = []\n    for label, params, E_cut in test_cases:\n        W_val = compute_valence_bandwidth(E_cut, params, num_k_seg=20)\n        dW = abs(W_val - W_ref[label])\n        results_pairs.append([W_val, dW])\n\n    # Format output as a single line: list of [W_val, dW] pairs\n    # Ensure pure Python-list string formatting with numeric entries\n    def pair_to_str(pair):\n        return f\"[{pair[0]},{pair[1]}]\"\n    out = \"[\" + \",\".join(pair_to_str(p) for p in results_pairs) + \"]\"\n    print(out)\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "3433862"}, {"introduction": "While standard band structure models capture many essential features, relativistic effects can be dominant in materials containing heavy elements. This practice [@problem_id:3433817] focuses on spin-orbit coupling (SOC), an interaction that arises from the coupling of an electron's spin with its orbital motion in a strong atomic potential. You will implement a $k \\cdot p$ model to explore how SOC lifts the degeneracy of the $p$-like valence bands at the $\\Gamma$ point, creating the distinct heavy-hole, light-hole, and split-off bands that are critical for understanding the optical and transport properties of many technologically important semiconductors.", "problem": "You are asked to implement and analyze a minimal, principled band-structure model near the center of the Brillouin zone (BZ), the high-symmetry point called Gamma ($\\Gamma$), for a heavy-element semiconductor. The goal is to compare band structures with and without Spin-Orbit Coupling (SOC), quantify the energy splitting at $\\Gamma$ for $p$-like valence states, and analyze changes in effective mass and band ordering. Your solution must be a complete, runnable program that performs the specified calculations for a defined test suite and outputs the results in a single line, in the format described below.\n\nBegin from the following fundamental base and well-tested formulas:\n\n- The non-relativistic single-particle band energy near a band extremum in the effective mass approximation is parabolic, with dispersion $E(\\mathbf{k}) = E_0 \\pm \\frac{\\hbar^2 |\\mathbf{k}|^2}{2 m_{\\mathrm{eff}}}$, where $\\hbar$ is the reduced Planck constant, $m_{\\mathrm{eff}}$ is the band effective mass, $+$ applies to conduction bands and $-$ to valence bands, and $E_0$ is the band-edge energy at $\\mathbf{k}=\\mathbf{0}$.\n- The atomic Spin-Orbit Coupling (SOC) interaction for orbital angular momentum $\\mathbf{L}$ and spin $\\mathbf{S}$ is $H_{\\mathrm{SO}} = \\lambda \\, \\mathbf{L} \\cdot \\mathbf{S}$, where $\\lambda$ is the SOC strength parameter.\n- For a $p$-like manifold ($l=1$, $s=\\tfrac{1}{2}$), SOC splits the $p$-like states into a quartet with total angular momentum $j=\\tfrac{3}{2}$ and a doublet with $j=\\tfrac{1}{2}$. The energy levels are\n$$ E_j = \\frac{\\lambda}{2} \\left[ j(j+1) - l(l+1) - s(s+1) \\right] $$ ,\nwith $l=1$ and $s=\\tfrac{1}{2}$. The energy separation between the $j=\\tfrac{3}{2}$ manifold and the $j=\\tfrac{1}{2}$ manifold, referred to as the split-off energy, is\n$$ \\Delta_{\\mathrm{so}} = E_{3/2} - E_{1/2} = \\frac{3}{2}\\lambda $$ .\n- In the spherical approximation of $k \\cdot p$ theory for the $j=\\tfrac{3}{2}$ valence manifold (Luttinger-Kohn model), the heavy-hole and light-hole effective masses are\n$$\nm_{\\mathrm{hh}} = \\frac{m_0}{\\gamma_1 - 2\\gamma} , \\quad\nm_{\\mathrm{lh}} = \\frac{m_0}{\\gamma_1 + 2\\gamma}\n$$ ,\nwhere $m_0$ is the electron rest mass, and $\\gamma_1$, $\\gamma$ are Luttinger parameters with $\\gamma \\equiv \\gamma_2 \\approx \\gamma_3$ in the spherical approximation. The split-off band ($j=\\tfrac{1}{2}$) has an energy offset $-\\Delta_{\\mathrm{so}}$ at $\\Gamma$ and a parabolic curvature characterized here by an effective mass $m_{\\mathrm{so}}$ treated as a given parameter.\n\nDefine two models to be compared:\n1. A model without Spin-Orbit Coupling where the $p$-like valence manifold is threefold degenerate at $\\Gamma$ with a single isotropic effective mass $m_p$ and dispersion $E_v(\\mathbf{k}) = E_v(0) - \\frac{\\hbar^2 |\\mathbf{k}|^2}{2 m_p}$.\n2. A model with Spin-Orbit Coupling where the $p$-like valence manifold consists of the heavy-hole ($j=\\tfrac{3}{2}$, $m_{\\mathrm{hh}}$), light-hole ($j=\\tfrac{3}{2}$, $m_{\\mathrm{lh}}$), and split-off ($j=\\tfrac{1}{2}$, $m_{\\mathrm{so}}$) parabolic bands. The corresponding dispersions near $\\Gamma$ are\n$$\nE_{\\mathrm{hh}}(\\mathbf{k}) = E_v(0) - \\frac{\\hbar^2 |\\mathbf{k}|^2}{2 m_{\\mathrm{hh}}},\\quad\nE_{\\mathrm{lh}}(\\mathbf{k}) = E_v(0) - \\frac{\\hbar^2 |\\mathbf{k}|^2}{2 m_{\\mathrm{lh}}},\\quad\nE_{\\mathrm{so}}(\\mathbf{k}) = E_v(0) - \\Delta_{\\mathrm{so}} - \\frac{\\hbar^2 |\\mathbf{k}|^2}{2 m_{\\mathrm{so}}}.\n$$\n\nAssume the conduction band minimum is parabolic and located at $E_c(0) = E_g$ with effective mass $m_c$, with dispersion $E_c(\\mathbf{k}) = E_g + \\frac{\\hbar^2 |\\mathbf{k}|^2}{2 m_c}$.\n\nYour program must:\n- Sample the wave vector magnitude $k = |\\mathbf{k}|$ along the $\\Gamma \\rightarrow X$ direction by evaluating a one-dimensional grid $k \\in [0, k_{\\max}]$ with uniformly spaced points. Use the unit $\\mathrm{\\AA}^{-1}$ for $k$.\n- For each test case, compute the band energies for both models over the $k$ grid.\n- Quantify the $\\Gamma$ splitting for the $p$-like valence states as $\\Delta_{\\mathrm{so}}$ in the SOC model, expressed in $\\mathrm{eV}$.\n- Numerically estimate the effective masses for each relevant valence band by fitting the small-$k$ dispersion to a parabolic form $E(k) \\approx E_0 + s k^2$, and using the relationship\n$$\nm_{\\mathrm{eff}} = \\frac{\\hbar^2 (10^{10})^2}{2 \\, |s| \\, (1.602176634 \\times 10^{-19})}\n$$ ,\nwhich converts the fitted slope $s$ from $\\mathrm{eV}\\,\\mathrm{\\AA}^2$ to a mass in $\\mathrm{kg}$; then report $m_{\\mathrm{eff}}/m_0$ as a dimensionless ratio. Here, $\\hbar$ is in $\\mathrm{J}\\cdot\\mathrm{s}$, $1\\,\\mathrm{\\AA} = 10^{-10}\\,\\mathrm{m}$, and $1\\,\\mathrm{eV} = 1.602176634 \\times 10^{-19}\\,\\mathrm{J}$. Use the absolute value of $s$ for valence bands, which are downward-curving near $\\Gamma$.\n- Determine the band ordering at $\\Gamma$ by comparing the band-edge energies of the valence subbands and conduction band. Encode the ordering as an integer code:\n  - $0$ if the SOC model shows normal ordering at $\\Gamma$: heavy-hole and light-hole degenerate at $E_v(0)$, split-off band at $E_v(0) - \\Delta_{\\mathrm{so}}$, and conduction band at $E_c(0) = E_g > E_v(0)$.\n  - $3$ if the no-SOC model shows the $p$-like triply degenerate valence top at $E_v(0)$ and conduction at $E_g > E_v(0)$.\n  - $1$ for any other ordering detected by your code.\n- Express energies in $\\mathrm{eV}$, effective masses as ratios relative to $m_0$, and wave vector in $\\mathrm{\\AA}^{-1}$. Angles do not appear. Do not use percentages.\n\nUse the following test suite of parameter sets, each a tuple containing $(a, E_g, m_c, m_p, \\gamma_1, \\gamma, \\Delta_{\\mathrm{so}}, m_{\\mathrm{so}}, k_{\\max}, N)$, where $a$ is the lattice parameter in $\\mathrm{\\AA}$ (used only to contextualize the $\\Gamma \\rightarrow X$ direction), $E_g$ is the band gap in $\\mathrm{eV}$, $m_c$ is the conduction effective mass ratio $m_c/m_0$, $m_p$ is the valence $p$-manifold effective mass ratio without SOC, $\\gamma_1$ and $\\gamma$ are Luttinger parameters, $\\Delta_{\\mathrm{so}}$ is the split-off energy in $\\mathrm{eV}$, $m_{\\mathrm{so}}$ is the split-off effective mass ratio $m_{\\mathrm{so}}/m_0$, $k_{\\max}$ is the maximum wave vector in $\\mathrm{\\AA}^{-1}$ for sampling, and $N$ is the number of points:\n- Test Case 1 (heavy SOC, InSb-like): $(6.48, 0.23, 0.013, 0.35, 5.0, 1.4, 0.80, 0.25, 0.05, 51)$.\n- Test Case 2 (boundary, no SOC): $(6.48, 0.23, 0.013, 0.35, 5.0, 1.4, 0.00, 0.25, 0.05, 51)$.\n- Test Case 3 (stronger SOC, altered valence parameters): $(6.48, 0.20, 0.015, 0.40, 4.5, 1.8, 1.20, 0.20, 0.05, 51)$.\n\nFor each test case, your program must produce a list with the following entries:\n- $[\\Delta_{\\mathrm{so}}, m_{\\mathrm{hh}}/m_0, m_{\\mathrm{lh}}/m_0, m_{\\mathrm{so}}/m_0, m_p/m_0, \\text{order\\_code}]$,\nwhere $\\Delta_{\\mathrm{so}}$ is in $\\mathrm{eV}$, all masses are dimensionless ratios, and $\\text{order\\_code}$ is the integer defined above. The effective masses must be obtained numerically from the dispersion fit as described rather than directly plugging the parameter formulas.\n\nYour program should produce a single line of output containing the results for the three test cases as a comma-separated list enclosed in square brackets, for example:\n$[[\\Delta_1,m_{\\mathrm{hh},1},m_{\\mathrm{lh},1},m_{\\mathrm{so},1},m_{p,1},\\text{ord}_1],[\\Delta_2,\\dots],[\\Delta_3,\\dots]]$,\nwith all floating-point numbers rounded to six decimal places. No other output is permitted. The code must not require any user input, external files, or network access.", "solution": "The problem statement is assessed to be valid. It is scientifically grounded in established principles of solid-state physics, namely the effective mass approximation and $k \\cdot p$ theory for semiconductor band structures. The problem is well-posed, providing a complete and consistent set of parameters, definitions, and computational tasks that lead to a unique, verifiable solution. The terminology is objective and precise. Therefore, a solution will be provided.\n\nThe core of this problem is to model and compare the electronic band structure of a semiconductor near the Brillouin zone center ($\\Gamma$ point) under two formalisms: one without spin-orbit coupling (SOC) and one with it. The solution involves calculating the energy dispersion $E(k)$ for several bands, and from these dispersions, extracting key physical parameters like effective masses and characterizing the band ordering.\n\nFirst, we establish the necessary physical constants and a crucial pre-factor that simplifies the energy dispersion equations. The parabolic dispersion relation is given by $E(\\mathbf{k}) = E_0 \\pm \\frac{\\hbar^2 |\\mathbf{k}|^2}{2 m_{\\mathrm{eff}}}$. To work with the specified units—energy in electron-volts ($eV$), wave vector $k = |\\mathbf{k}|$ in inverse Angstroms ($\\mathrm{\\AA}^{-1}$), and effective mass $m_{\\mathrm{eff}}$ as a dimensionless ratio relative to the electron rest mass $m_0$—we must derive a convenient numerical factor.\n\nLet $m_{\\mathrm{eff,ratio}} = m_{\\mathrm{eff}}/m_0$. The dispersion in SI units is $E_{\\mathrm{J}} = E_{0,\\mathrm{J}} \\pm \\frac{\\hbar^2}{2 m_0 m_{\\mathrm{eff,ratio}}} k_{\\mathrm{SI}}^2$, where $k_{\\mathrm{SI}}$ is in $m^{-1}$. Given that $1 \\mathrm{\\AA} = 10^{-10} m$, a wave vector $k$ in $\\mathrm{\\AA}^{-1}$ corresponds to $k_{\\mathrm{SI}} = k \\times 10^{10} m^{-1}$. Substituting this, we get $E_{\\mathrm{J}} = E_{0,\\mathrm{J}} \\pm \\frac{\\hbar^2 (10^{20})}{2 m_0 m_{\\mathrm{eff,ratio}}} k^2$. To convert energy to $eV$, we divide by the elementary charge $e$.\n$$\nE_{\\mathrm{eV}} = E_{0,\\mathrm{eV}} \\pm \\left( \\frac{\\hbar^2 10^{20}}{2 m_0 e} \\right) \\frac{1}{m_{\\mathrm{eff,ratio}}} k^2.\n$$\nThe term in parentheses is a constant with units of $eV \\cdot \\mathrm{\\AA}^2$. Using the standard values for the reduced Planck constant $\\hbar$, the electron rest mass $m_0$, and the elementary charge $e$, this factor is calculated:\n$$\nC = \\frac{\\hbar^2 (10^{10})^2}{2 m_0 e} \\approx 3.80998 \\, \\mathrm{eV \\cdot \\AA^2}.\n$$\nWith this constant, the dispersion relations for the various bands defined in the problem can be written in a computationally friendly form. We set the top of the valence band manifold at $\\Gamma$, $E_v(0)$, to be the energy reference, i.e., $E_v(0) = 0 \\, eV$.\n\nThe problem requires analyzing two models for each given set of parameters.\n\nModel 1: Without Spin-Orbit Coupling (No-SOC)\n- A single triply-degenerate $p$-like valence band with dispersion $E_p(k) = -\\frac{C}{m_p/m_0} k^2$.\n- The conduction band with dispersion $E_c(k) = E_g + \\frac{C}{m_c/m_0} k^2$.\n\nModel 2: With Spin-Orbit Coupling (SOC)\nHere, the $p$-like valence band degeneracy at $\\Gamma$ is lifted. The six states (3 orbital $\\times$ 2 spin) split into a $j=3/2$ quartet and a $j=1/2$ doublet. Near $\\Gamma$, the $j=3/2$ states further split into heavy-hole (hh) and light-hole (lh) bands due to crystal potential effects, captured by the Luttinger parameters $\\gamma_1$ and $\\gamma$.\n- Heavy-hole band: $E_{\\mathrm{hh}}(k) = -\\frac{C}{m_{\\mathrm{hh}}/m_0} k^2$.\n- Light-hole band: $E_{\\mathrm{lh}}(k) = -\\frac{C}{m_{\\mathrm{lh}}/m_0} k^2$.\n- Split-off band ($j=1/2$): $E_{\\mathrm{so}}(k) = -\\Delta_{\\mathrm{so}} - \\frac{C}{m_{\\mathrm{so}}/m_0} k^2$.\n- The conduction band is the same as in the no-SOC model: $E_c(k) = E_g + \\frac{C}{m_c/m_0} k^2$.\nThe heavy-hole and light-hole effective mass ratios are determined by the Luttinger parameters:\n$$\n\\frac{m_{\\mathrm{hh}}}{m_0} = \\frac{1}{\\gamma_1 - 2\\gamma}, \\quad \\frac{m_{\\mathrm{lh}}}{m_0} = \\frac{1}{\\gamma_1 + 2\\gamma}.\n$$\nThe split-off energy $\\Delta_{\\mathrm{so}}$ and the split-off mass ratio $m_{\\mathrm{so}}/m_0$ are given directly.\n\nThe algorithm proceeds as follows for each test case:\n1.  Define the wave vector grid $k$ as a linearly spaced array of $N$ points from $0$ to $k_{\\max}$.\n2.  Calculate the theoretical effective mass ratios $m_{\\mathrm{hh}}/m_0$ and $m_{\\mathrm{lh}}/m_0$ using the provided Luttinger parameters.\n3.  Compute the energy dispersion $E(k)$ for all relevant bands ($p$ for the no-SOC model; hh, lh, so for the SOC model) over the $k$-grid using the formulas derived above.\n4.  Numerically estimate the effective mass for each band. According to the problem, this is done by fitting the calculated dispersion near $k=0$ to a parabola, $E(k) \\approx E_0 + s k^2$. This is equivalent to a linear fit of $E$ versus $k^2$, where the slope is $s$. The fit is performed using a small number of points near $k=0$ (e.g., the first 5 non-zero $k$ points) to accurately capture the curvature at the band extremum. A standard linear regression algorithm is used for this purpose.\n5.  The effective mass ratio is then recovered from the fitted slope $s$ (in $eV \\cdot \\mathrm{\\AA}^2$) using the inverse of the relationship derived earlier:\n$$\n\\frac{m_{\\mathrm{eff}}}{m_0} = \\frac{C}{|s|}\n$$\nThis numerical estimation serves as a verification of the model implementation, as the recovered masses should match the input parameters or the values calculated from the Luttinger parameters.\n6.  The band ordering code is determined based on the physical parameters. A key observation is that the output list contains parameters from both the SOC and no-SOC models, implying a comparative analysis. The most logical interpretation is to assign the code based on the physical situation described by the parameters.\n    - If $\\Delta_{\\mathrm{so}} > 0$, the system has spin-orbit coupling. If the band gap $E_g$ is positive, the bands exhibit a normal ordering, so the code is $0$.\n    - If $\\Delta_{\\mathrm{so}} = 0$, the system has no spin-orbit coupling. If $E_g > 0$, the no-SOC model is the relevant description, characterized by a triply degenerate valence band top at $\\Gamma$, corresponding to code $3$.\n    - Code $1$ is reserved for other, unphysical orderings (e.g., negative band gap or negative split-off energy), which are not encountered in the provided test cases.\n7.  Finally, for each test case, the required list of outputs—$[\\Delta_{\\mathrm{so}}, m_{\\mathrm{hh}}/m_0, m_{\\mathrm{lh}}/m_0, m_{\\mathrm{so}}/m_0, m_p/m_0, \\text{order\\_code}]$—is assembled, with masses being the numerically estimated values, and all floating-point numbers formatted to six decimal places. The collected results from all test cases are then formatted into the final, single-line output string.\n\nThis systematic procedure ensures that all requirements of the problem are met, providing a rigorous and reproducible analysis of the specified band structure models.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.stats import linregress\nfrom scipy.constants import hbar, m_e, e\n\ndef solve():\n    \"\"\"\n    Implements and analyzes a k.p band-structure model with and without SOC.\n    \"\"\"\n    # Define physical constants and the conversion factor.\n    # The factor C converts 1/(mass_ratio) into a dispersion coefficient in eV*A^2.\n    # C = hbar^2 / (2 * m_0) in J*m^2, converted to eV*A^2.\n    # 1 A = 1e-10 m, so 1 A^-2 = 1e20 m^-2.\n    # Energy is converted from J to eV by dividing by e.\n    C_FACTOR = (hbar**2 * (1e10)**2) / (2 * m_e * e) # eV * Angstrom^2\n\n    # Define the test cases from the problem statement.\n    # (a, E_g, m_c/m_0, m_p/m_0, gamma_1, gamma, Delta_so, m_so/m_0, k_max, N)\n    test_cases = [\n        (6.48, 0.23, 0.013, 0.35, 5.0, 1.4, 0.80, 0.25, 0.05, 51),\n        (6.48, 0.23, 0.013, 0.35, 5.0, 1.4, 0.00, 0.25, 0.05, 51),\n        (6.48, 0.20, 0.015, 0.40, 4.5, 1.8, 1.20, 0.20, 0.05, 51),\n    ]\n\n    all_results = []\n    for case in test_cases:\n        a, E_g, mc_r, mp_r, g1, g, D_so, mso_r, k_max, N = case\n\n        # 1. Theoretical mass ratios for the SOC model\n        # Check for positivity of denominators, though test cases are valid.\n        if g1 - 2 * g <= 0 or g1 + 2 * g <= 0:\n            raise ValueError(\"Luttinger parameters result in non-positive mass.\")\n        mhh_r_theory = 1.0 / (g1 - 2 * g)\n        mlh_r_theory = 1.0 / (g1 + 2 * g)\n\n        # 2. k-vector grid\n        k_grid = np.linspace(0, k_max, N)\n        k2_grid = k_grid**2\n\n        # 3. Calculate band dispersions\n        # E_v(0) is the reference energy 0 eV.\n        # Conduction band (analytic, not needed for fitting valence bands)\n        # E_c = E_g + C_FACTOR / mc_r * k2_grid\n\n        # No-SOC model valence band\n        E_p = -C_FACTOR / mp_r * k2_grid\n\n        # SOC model valence bands\n        E_hh = -C_FACTOR / mhh_r_theory * k2_grid\n        E_lh = -C_FACTOR / mlh_r_theory * k2_grid\n        E_so = -D_so - C_FACTOR / mso_r * k2_grid\n        \n        # 4. Numerically estimate effective masses via linear regression\n        # Use first 5 non-zero k-points for fitting small-k dispersion.\n        # This captures curvature at Gamma.\n        fit_slice = slice(1, 6)\n        k2_fit = k2_grid[fit_slice]\n\n        def get_mass_ratio_from_fit(energy_band, k2_points_to_fit):\n            # Fit E vs k^2 to a line E = s*k^2 + E_0. The slope is s.\n            # For bands originating at E=0, we fit E vs k^2.\n            # For the split-off band, we fit E vs k^2 to find the slope\n            # and the intercept will be -Delta_so.\n            slope = linregress(k2_points_to_fit, energy_band[fit_slice]).slope\n            \n            # The problem defines mass from |s|. Valence bands have s<0.\n            if abs(slope) < 1e-9: # Avoid division by zero for flat bands\n                return np.inf\n            \n            mass_ratio = C_FACTOR / abs(slope)\n            return mass_ratio\n\n        mhh_r_num = get_mass_ratio_from_fit(E_hh, k2_fit)\n        mlh_r_num = get_mass_ratio_from_fit(E_lh, k2_fit)\n        mso_r_num = get_mass_ratio_from_fit(E_so, k2_fit)\n        mp_r_num = get_mass_ratio_from_fit(E_p, k2_fit)\n\n        # 5. Determine the band ordering code\n        order_code = 1 # Default to 'other'\n        # The primary physical model is chosen based on Delta_so.\n        if D_so > 0:\n            # System has SOC. Check for normal ordering in SOC model.\n            if E_g > 0:\n                order_code = 0\n        elif D_so == 0:\n            # System has no SOC. Check for normal ordering in no-SOC model.\n            if E_g > 0:\n                order_code = 3\n        # If D_so < 0 or E_g <= 0, code remains 1 (unphysical/inverted).\n        \n        # 6. Assemble the results for this test case\n        case_result = [D_so, mhh_r_num, mlh_r_num, mso_r_num, mp_r_num, order_code]\n        all_results.append(case_result)\n\n    # 7. Final print statement in the exact required format.\n    def format_case(res):\n        # Format floats to 6 decimal places, integers as is.\n        formatted_parts = [f\"{x:.6f}\" if isinstance(x, float) else str(x) for x in res]\n        return f\"[{','.join(formatted_parts)}]\"\n\n    output_str = f\"[{','.join([format_case(res) for res in all_results])}]\"\n    print(output_str)\n\nsolve()\n```", "id": "3433817"}, {"introduction": "A well-known limitation of standard Density Functional Theory (DFT) is the systematic underestimation of semiconductor band gaps. To address this, various correction schemes have been developed, with the \"scissor correction\" being one of the simplest and most common. This exercise [@problem_id:3433858] challenges you to implement this correction, calibrating a DFT band structure to a more accurate $G_0W_0$ calculation, but more importantly, to critically assess its limitations. By quantifying the residual errors in effective masses and higher conduction bands, you will gain a deeper understanding that a simple rigid shift, while fixing the fundamental gap, does not necessarily correct the entire dispersion relation.", "problem": "You are given a model for band dispersions along the path between the Brillouin zone (BZ) center and a zone boundary direction in a cubic crystal. The path is the line from $\\Gamma$ to $X$, parameterized by a scalar wavevector $k \\in [0,\\pi/a]$ with $a$ the lattice constant in ångströms ($\\text{\\AA}$) and $k$ in inverse ångströms ($\\text{\\AA}^{-1}$). The energy reference is the valence band maximum at $\\Gamma$, set to $0$ electronvolts (eV). Your task is to propose, implement, and test a scissor correction calibrated to the Many-Body Perturbation Theory within the $G_0W_0$ approximation (G0W0) fundamental gap at $\\Gamma$, and then analyze the residual errors it leaves in the effective mass and in higher conduction bands along $\\Gamma$–$X$.\n\nStart from the following well-tested base. For the $n$-th conduction band (where $n \\in \\{1,2,3\\}$), the dispersion is modeled by a nonparabolic Kane-type relation for the dispersive part $E_{d,n}(k)$,\n$E_{d,n}(k)\\bigl(1+\\alpha_n E_{d,n}(k)\\bigr) = A_n k^2$,\nwith\n$$\nA_n = \\frac{\\hbar^2}{2 m_n} \\times 10^{20},\n$$\nso that $A_n$ is in $\\text{eV}\\cdot\\text{\\AA}^2$ when $k$ is in $\\text{\\AA}^{-1}$. Here $\\hbar$ is Planck's reduced constant in $\\text{eV}\\cdot \\text{s}$, and $m_n$ is the band effective mass in kilograms. The total band energy is\n$$\nE_n(k) = E_{0,n} + E_{d,n}(k),\n$$\nwhere $E_{0,1} = E_g$ is the fundamental gap and $E_{0,n} = E_g + \\Delta_n$ for $n \\ge 2$. The nonparabolicity parameter $\\alpha_n$ is in $\\text{eV}^{-1}$. The effective mass at the band edge is related to the curvature by the effective mass theorem, which for small $k$ yields the second derivative\n$$\n\\left.\\frac{d^2 E_n}{dk^2}\\right|_{k=0} = \\frac{\\hbar^2}{m_n} \\times 10^{20}.\n$$\n\nCalibrate a scissor correction using Density Functional Theory (DFT) and $G_0W_0$ band edge gaps at $\\Gamma$. Define\n$$\n\\Delta^{\\text{sc}} = E_g^{G_0W_0} - E_g^{\\text{DFT}}.\n$$\nApply the scissor correction to all DFT conduction bands uniformly as\n$$\nE^{\\text{sc}}_n(k) = E^{\\text{DFT}}_n(k) + \\Delta^{\\text{sc}},\n$$\nwhich preserves curvature and thus leaves the DFT effective masses unchanged. Quantify the residual discrepancy induced by this approximation by comparing scissor-corrected quantities to the target $G_0W_0$ quantities.\n\nYour program must:\n- Implement the above dispersion model for both DFT and $G_0W_0$ parameter sets.\n- Use a uniform mesh of $N_k$ points for $k$ from $0$ to $\\pi/a$ inclusive, with $N_k \\ge 3$.\n- Compute the effective mass at $\\Gamma$ for the scissor-corrected first conduction band (CB1) and for the $G_0W_0$ CB1 by estimating the curvature with the forward three-point second finite difference formula at $k=0$:\n$$\n\\left.\\frac{d^2E}{dk^2}\\right|_{k=0} \\approx \\frac{E(2h) - 2E(h) + E(0)}{h^2}, \\quad h = \\frac{\\pi/a}{N_k-1}.\n$$\nThen convert curvature to mass using\n$$\nm^* = \\frac{\\hbar^2 \\times 10^{20}}{\\left.\\frac{d^2E}{dk^2}\\right|_{k=0}},\n$$\nand report the fractional effective mass error\n$$\n\\varepsilon_m = \\frac{m^*_{\\text{sc}} - m^*_{G_0W_0}}{m^*_{G_0W_0}},\n$$\nas a dimensionless decimal.\n- Compute the root-mean-square (RMS) energy error along $\\Gamma$–$X$ for the second and third conduction bands (CB2 and CB3),\n$$\n\\mathrm{RMS}_n = \\sqrt{\\frac{1}{M}\\sum_{i=0}^{M-1}\\left(E^{\\text{sc}}_n(k_i)-E^{G_0W_0}_n(k_i)\\right)^2},\n$$\nwith $M=N_k$, reporting each RMS in electronvolts (eV).\n\nUse the following physical constants in your calculations:\n- $\\hbar = 6.582119569\\times 10^{-16}\\,\\text{eV}\\cdot \\text{s}$,\n- $m_e = 9.10938356\\times 10^{-31}\\,\\text{kg}$.\nReport the effective mass values internally in kilograms but express the error as a dimensionless decimal.\n\nTest Suite. Run your implementation on the following three parameter sets, each being a tuple of DFT and $G_0W_0$ parameters for a hypothetical cubic material:\n- Case 1 (typical):\n  - $a = 5.65\\,\\text{\\AA}$, $N_k=101$, $E_g^{\\text{DFT}}=0.90\\,\\text{eV}$, $E_g^{G_0W_0}=1.20\\,\\text{eV}$.\n  - CB1: $m^{\\text{DFT}}/m_e = 0.25$, $\\alpha^{\\text{DFT}}=0.8\\,\\text{eV}^{-1}$, $\\Delta_1^{\\text{DFT}}=0.0\\,\\text{eV}$; $m^{G_0W_0}/m_e = 0.20$, $\\alpha^{G_0W_0}=1.0\\,\\text{eV}^{-1}$, $\\Delta_1^{G_0W_0}=0.0\\,\\text{eV}$.\n  - CB2: $\\Delta_2^{\\text{DFT}}=1.00\\,\\text{eV}$, $m^{\\text{DFT}}/m_e=0.60$, $\\alpha^{\\text{DFT}}=0.3\\,\\text{eV}^{-1}$; $\\Delta_2^{G_0W_0}=0.90\\,\\text{eV}$, $m^{G_0W_0}/m_e=0.50$, $\\alpha^{G_0W_0}=0.4\\,\\text{eV}^{-1}$.\n  - CB3: $\\Delta_3^{\\text{DFT}}=2.00\\,\\text{eV}$, $m^{\\text{DFT}}/m_e=1.20$, $\\alpha^{\\text{DFT}}=0.2\\,\\text{eV}^{-1}$; $\\Delta_3^{G_0W_0}=1.80\\,\\text{eV}$, $m^{G_0W_0}/m_e=1.00$, $\\alpha^{G_0W_0}=0.25\\,\\text{eV}^{-1}$.\n- Case 2 (boundary, zero scissor):\n  - $a = 3.57\\,\\text{\\AA}$, $N_k=101$, $E_g^{\\text{DFT}}=1.50\\,\\text{eV}$, $E_g^{G_0W_0}=1.50\\,\\text{eV}$.\n  - CB1: $m^{\\text{DFT}}/m_e = 0.35$, $\\alpha^{\\text{DFT}}=0.9\\,\\text{eV}^{-1}$, $\\Delta_1^{\\text{DFT}}=0.0\\,\\text{eV}$; $m^{G_0W_0}/m_e = 0.30$, $\\alpha^{G_0W_0}=1.1\\,\\text{eV}^{-1}$, $\\Delta_1^{G_0W_0}=0.0\\,\\text{eV}$.\n  - CB2: $\\Delta_2^{\\text{DFT}}=0.80\\,\\text{eV}$, $m^{\\text{DFT}}/m_e=0.55$, $\\alpha^{\\text{DFT}}=0.4\\,\\text{eV}^{-1}$; $\\Delta_2^{G_0W_0}=0.75\\,\\text{eV}$, $m^{G_0W_0}/m_e=0.45$, $\\alpha^{G_0W_0}=0.5\\,\\text{eV}^{-1}$.\n  - CB3: $\\Delta_3^{\\text{DFT}}=1.50\\,\\text{eV}$, $m^{\\text{DFT}}/m_e=0.90$, $\\alpha^{\\text{DFT}}=0.3\\,\\text{eV}^{-1}$; $\\Delta_3^{G_0W_0}=1.40\\,\\text{eV}$, $m^{G_0W_0}/m_e=0.80$, $\\alpha^{G_0W_0}=0.35\\,\\text{eV}^{-1}$.\n- Case 3 (negative scissor):\n  - $a = 4.00\\,\\text{\\AA}$, $N_k=101$, $E_g^{\\text{DFT}}=1.80\\,\\text{eV}$, $E_g^{G_0W_0}=1.50\\,\\text{eV}$.\n  - CB1: $m^{\\text{DFT}}/m_e = 0.18$, $\\alpha^{\\text{DFT}}=1.1\\,\\text{eV}^{-1}$, $\\Delta_1^{\\text{DFT}}=0.0\\,\\text{eV}$; $m^{G_0W_0}/m_e = 0.22$, $\\alpha^{G_0W_0}=0.9\\,\\text{eV}^{-1}$, $\\Delta_1^{G_0W_0}=0.0\\,\\text{eV}$.\n  - CB2: $\\Delta_2^{\\text{DFT}}=1.20\\,\\text{eV}$, $m^{\\text{DFT}}/m_e=0.40$, $\\alpha^{\\text{DFT}}=0.5\\,\\text{eV}^{-1}$; $\\Delta_2^{G_0W_0}=1.10\\,\\text{eV}$, $m^{G_0W_0}/m_e=0.45$, $\\alpha^{G_0W_0}=0.45\\,\\text{eV}^{-1}$.\n  - CB3: $\\Delta_3^{\\text{DFT}}=2.50\\,\\text{eV}$, $m^{\\text{DFT}}/m_e=0.85$, $\\alpha^{\\text{DFT}}=0.3\\,\\text{eV}^{-1}$; $\\Delta_3^{G_0W_0}=2.30\\,\\text{eV}$, $m^{G_0W_0}/m_e=0.75$, $\\alpha^{G_0W_0}=0.35\\,\\text{eV}^{-1}$.\n\nFinal Output Format. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, with one triple per test case in order: $[\\varepsilon_m,\\mathrm{RMS}_2,\\mathrm{RMS}_3]$. For all three cases, aggregate these triples as a single list of lists, for example\n$$\n[[\\varepsilon_{m,1},\\mathrm{RMS}_{2,1},\\mathrm{RMS}_{3,1}],[\\varepsilon_{m,2},\\mathrm{RMS}_{2,2},\\mathrm{RMS}_{3,2}],[\\varepsilon_{m,3},\\mathrm{RMS}_{2,3},\\mathrm{RMS}_{3,3}]].\n$$\nEach $\\varepsilon_m$ must be a dimensionless decimal, and each $\\mathrm{RMS}_n$ must be in electronvolts (eV).", "solution": "The user has provided a valid computational materials science problem. The task is to implement a scissor correction for a model band structure, and then to quantify the residual errors introduced by this correction when compared to a higher-level theory ($G_0W_0$) benchmark. The problem is scientifically grounded, well-posed, and contains all necessary information for a unique solution.\n\nThe solution proceeds in the following steps:\n1.  **Model Implementation**: First, we implement the provided Kane-type nonparabolic dispersion model.\n2.  **Band Structure Calculation**: For each test case, we compute the band structures for three conduction bands ($n \\in \\{1, 2, 3\\}$) using both the Density Functional Theory (DFT) and $G_0W_0$ parameter sets.\n3.  **Scissor Correction**: We calculate the scissor opening, $\\Delta^{\\text{sc}}$, and apply it rigidly to the DFT conduction bands.\n4.  **Error Quantification**: We compute the requested error metrics: the fractional effective mass error ($\\varepsilon_m$) for the first conduction band, and the root-mean-square (RMS) energy error for the second and third conduction bands.\n\n### Step 1: Dispersion Model\nThe total energy for the $n$-th band is given by $E_n(k) = E_{0,n} + E_{d,n}(k)$, where $k$ is the wavevector magnitude, $E_{0,n}$ is the band edge energy at the $\\Gamma$ point ($k=0$), and $E_{d,n}(k)$ is the dispersive part of the energy. The band edge is $E_{0,n} = E_g + \\Delta_n$, where $E_g$ is the fundamental gap and $\\Delta_n$ is the splitting energy (with $\\Delta_1$ implicitly being $0$).\n\nThe dispersive part, $E_{d,n}(k)$, is defined by the Kane-type relation:\n$$\nE_{d,n}(k)\\bigl(1+\\alpha_n E_{d,n}(k)\\bigr) = A_n k^2\n$$\nThis is a quadratic equation in $E_{d,n}(k)$:\n$$\n\\alpha_n E_{d,n}(k)^2 + E_{d,n}(k) - A_n k^2 = 0\n$$\nAssuming $\\alpha_n > 0$, the physically meaningful solution (where energy increases from $E_{d,n}(0)=0$) is obtained by taking the positive root of the quadratic formula:\n$$\nE_{d,n}(k) = \\frac{-1 + \\sqrt{1 + 4\\alpha_n A_n k^2}}{2\\alpha_n}\n$$\nThe parameter $A_n$ is related to the band effective mass $m_n$ by:\n$$\nA_n = \\frac{\\hbar^2}{2 m_n} \\times 10^{20}\n$$\nwhere the factor of $10^{20}$ ensures that $A_n$ is in units of $\\text{eV}\\cdot\\text{\\AA}^2$ when $\\hbar$ is in $\\text{eV}\\cdot \\text{s}$, $m_n$ is in $\\text{kg}$, and $k$ is in $\\text{\\AA}^{-1}$. While this formulation is non-standard from a fundamental physics perspective regarding the units of $\\hbar$, it is internally consistent within the problem's definitions, as the formula to extract the effective mass from curvature uses the same constant. A function will be implemented to compute $E_n(k)$ for a given set of parameters ($E_g$, $\\Delta_n$, $m_n$, $\\alpha_n$) over a mesh of $k$-points.\n\n### Step 2: K-point Mesh and Parameter Setup\nFor each test case, a uniform mesh of $N_k$ points is generated for the wavevector $k$ along the $\\Gamma-X$ path, ranging from $k=0$ to $k=\\pi/a$. The step size is $h = \\frac{\\pi/a}{N_k-1}$. We will use the provided physical constants $\\hbar = 6.582119569\\times 10^{-16}\\,\\text{eV}\\cdot \\text{s}$ and $m_e = 9.10938356\\times 10^{-31}\\,\\text{kg}$. The effective mass parameters, given as a ratio $m_n/m_e$, will be converted to kilograms.\n\n### Step 3: Scissor Correction\nThe scissor correction is a rigid upward shift of all conduction bands calculated at the DFT level. The shift amount, $\\Delta^{\\text{sc}}$, is the difference between the $G_0W_0$ and DFT fundamental band gaps at $\\Gamma$:\n$$\n\\Delta^{\\text{sc}} = E_g^{G_0W_0} - E_g^{\\text{DFT}}\n$$\nThe scissor-corrected energies are then:\n$$\nE^{\\text{sc}}_n(k) = E^{\\text{DFT}}_n(k) + \\Delta^{\\text{sc}}\n$$\nfor each conduction band $n$.\n\n### Step 4: Error Analysis\nThe core of the task is to quantify two types of errors originating from the scissor correction's approximation.\n\n**a) Effective Mass Error:**\nThe scissor correction, being a constant energy shift, preserves the shape (and thus the curvature) of the bands. The effective mass of the scissor-corrected band, $m^*_{\\text{sc}}$, will therefore be identical to the DFT effective mass, $m^{\\text{DFT}}_1$. The analysis compares this to the target $G_0W_0$ effective mass, $m^*_{G_0W_0}$. We will numerically verify this by calculating the curvature at $k=0$ using the three-point forward finite difference formula:\n$$\n\\left.\\frac{d^2E}{dk^2}\\right|_{k=0} \\approx \\frac{E(2h) - 2E(h) + E(0)}{h^2}\n$$\nThe effective mass $m^*$ is then recovered using the provided relation:\n$$\nm^* = \\frac{\\hbar^2 \\times 10^{20}}{\\left.\\frac{d^2E}{dk^2}\\right|_{k=0}}\n$$\nWe compute $m^*_{\\text{sc}}$ from the $E^{\\text{sc}}_1(k)$ band and $m^*_{G_0W_0}$ from the $E^{G_0W_0}_1(k)$ band. The fractional error is then:\n$$\n\\varepsilon_m = \\frac{m^*_{\\text{sc}} - m^*_{G_0W_0}}{m^*_{G_0W_0}}\n$$\n\n**b) Higher-Band RMS Energy Error:**\nFor the higher conduction bands ($n=2, 3$), the scissor correction is generally less accurate because it does not account for changes in band splittings ($\\Delta_n$) or band shapes (determined by $m_n$ and $\\alpha_n$) between the DFT and $G_0W_0$ levels of theory. We quantify this discrepancy by calculating the root-mean-square (RMS) error over the entire $\\Gamma-X$ path:\n$$\n\\mathrm{RMS}_n = \\sqrt{\\frac{1}{N_k}\\sum_{i=0}^{N_k-1}\\left(E^{\\text{sc}}_n(k_i)-E^{G_0W_0}_n(k_i)\\right)^2}\n$$\nThis calculation will be performed for bands $n=2$ and $n=3$ for each test case.\n\nThe entire procedure is encapsulated in a Python script which iterates through the three provided test cases and computes the triplet of results $(\\varepsilon_m, \\mathrm{RMS}_2, \\mathrm{RMS}_3)$ for each.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the band structure problem for all test cases.\n    \"\"\"\n\n    # Physical constants\n    HBAR = 6.582119569e-16  # eV*s\n    M_E = 9.10938356e-31    # kg\n    HBAR_SQ_FACTOR = HBAR**2 * 1e20\n\n    # Test suite: a list of tuples, each containing parameters for one case.\n    # Format: (a, Nk, dft_params, gw_params)\n    # _params are dicts: {'Eg': ..., 'bands': {1: {'m_ratio':.., 'alpha':.., 'Delta':..}, ...}}\n    test_cases = [\n        # Case 1 (typical)\n        (\n            5.65, 101,  # a, Nk\n            {\n                \"Eg\": 0.90,\n                \"bands\": {\n                    1: {\"m_ratio\": 0.25, \"alpha\": 0.8, \"Delta\": 0.0},\n                    2: {\"m_ratio\": 0.60, \"alpha\": 0.3, \"Delta\": 1.00},\n                    3: {\"m_ratio\": 1.20, \"alpha\": 0.2, \"Delta\": 2.00},\n                }\n            },\n            {\n                \"Eg\": 1.20,\n                \"bands\": {\n                    1: {\"m_ratio\": 0.20, \"alpha\": 1.0, \"Delta\": 0.0},\n                    2: {\"m_ratio\": 0.50, \"alpha\": 0.4, \"Delta\": 0.90},\n                    3: {\"m_ratio\": 1.00, \"alpha\": 0.25, \"Delta\": 1.80},\n                }\n            }\n        ),\n        # Case 2 (boundary, zero scissor)\n        (\n            3.57, 101,  # a, Nk\n            {\n                \"Eg\": 1.50,\n                \"bands\": {\n                    1: {\"m_ratio\": 0.35, \"alpha\": 0.9, \"Delta\": 0.0},\n                    2: {\"m_ratio\": 0.55, \"alpha\": 0.4, \"Delta\": 0.80},\n                    3: {\"m_ratio\": 0.90, \"alpha\": 0.3, \"Delta\": 1.50},\n                }\n            },\n            {\n                \"Eg\": 1.50,\n                \"bands\": {\n                    1: {\"m_ratio\": 0.30, \"alpha\": 1.1, \"Delta\": 0.0},\n                    2: {\"m_ratio\": 0.45, \"alpha\": 0.5, \"Delta\": 0.75},\n                    3: {\"m_ratio\": 0.80, \"alpha\": 0.35, \"Delta\": 1.40},\n                }\n            }\n        ),\n        # Case 3 (negative scissor)\n        (\n            4.00, 101,  # a, Nk\n            {\n                \"Eg\": 1.80,\n                \"bands\": {\n                    1: {\"m_ratio\": 0.18, \"alpha\": 1.1, \"Delta\": 0.0},\n                    2: {\"m_ratio\": 0.40, \"alpha\": 0.5, \"Delta\": 1.20},\n                    3: {\"m_ratio\": 0.85, \"alpha\": 0.3, \"Delta\": 2.50},\n                }\n            },\n            {\n                \"Eg\": 1.50,\n                \"bands\": {\n                    1: {\"m_ratio\": 0.22, \"alpha\": 0.9, \"Delta\": 0.0},\n                    2: {\"m_ratio\": 0.45, \"alpha\": 0.45, \"Delta\": 1.10},\n                    3: {\"m_ratio\": 0.75, \"alpha\": 0.35, \"Delta\": 2.30},\n                }\n            }\n        ),\n    ]\n\n    all_results = []\n    for case_data in test_cases:\n        all_results.append(process_case(case_data, HBAR_SQ_FACTOR, M_E))\n\n    # Format the final output string as a list of lists.\n    list_of_lists_str = [f\"[{','.join(map(str, res))}]\" for res in all_results]\n    final_output = f\"[{','.join(list_of_lists_str)}]\"\n    print(final_output)\n\ndef compute_bands(k_mesh, params, hbar_sq_factor, m_e):\n    \"\"\"\n    Computes band energies for all bands in a parameter set.\n    \"\"\"\n    bands = {}\n    k2 = k_mesh**2\n    for n in [1, 2, 3]:\n        p = params['bands'][n]\n        m_kg = p['m_ratio'] * m_e\n        alpha = p['alpha']\n        E0 = params['Eg'] + p['Delta']\n        A = hbar_sq_factor / (2 * m_kg)\n\n        # Solve for the dispersive part of the energy\n        if alpha == 0:\n            E_d = A * k2\n        else:\n            # Quadratic formula: alpha*E_d^2 + E_d - A*k^2 = 0\n            # We take the positive root for energy increasing from k=0\n            sqrt_term = np.sqrt(1 + 4 * alpha * A * k2)\n            E_d = (-1 + sqrt_term) / (2 * alpha)\n\n        bands[n] = E0 + E_d\n    return bands\n\ndef process_case(case_data, hbar_sq_factor, m_e):\n    \"\"\"\n    Processes a single test case to compute the required error metrics.\n    \"\"\"\n    a, Nk, dft_params, gw_params = case_data\n\n    # 1. Setup k-mesh\n    k_max = np.pi / a\n    k_mesh = np.linspace(0, k_max, Nk, dtype=np.float64)\n    h = k_mesh[1] - k_mesh[0]\n\n    # 2. Compute DFT and G0W0 bands\n    dft_bands = compute_bands(k_mesh, dft_params, hbar_sq_factor, m_e)\n    gw_bands = compute_bands(k_mesh, gw_params, hbar_sq_factor, m_e)\n\n    # 3. Apply scissor correction\n    delta_sc = gw_params['Eg'] - dft_params['Eg']\n    sc_bands = {n: dft_bands[n] + delta_sc for n in dft_bands}\n\n    # 4. Compute fractional effective mass error for CB1\n    # Curvature of scissor-corrected band from 3-point finite difference formula\n    curv_sc = (sc_bands[1][2] - 2 * sc_bands[1][1] + sc_bands[1][0]) / h**2\n    m_star_sc = hbar_sq_factor / curv_sc\n\n    # Curvature of G0W0 band\n    curv_gw = (gw_bands[1][2] - 2 * gw_bands[1][1] + gw_bands[1][0]) / h**2\n    m_star_gw = hbar_sq_factor / curv_gw\n    \n    eps_m = (m_star_sc - m_star_gw) / m_star_gw\n\n    # 5. Compute RMS energy error for CB2 and CB3\n    rms_2 = np.sqrt(np.mean((sc_bands[2] - gw_bands[2])**2))\n    rms_3 = np.sqrt(np.mean((sc_bands[3] - gw_bands[3])**2))\n\n    return [eps_m, rms_2, rms_3]\n\nsolve()\n```", "id": "3433858"}]}