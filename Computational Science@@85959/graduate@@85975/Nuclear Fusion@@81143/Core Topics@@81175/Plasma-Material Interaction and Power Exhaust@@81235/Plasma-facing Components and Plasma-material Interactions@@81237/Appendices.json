{"hands_on_practices": [{"introduction": "Understanding the plasma-material interface begins with accurately measuring the properties of the plasma itself, especially in the crucial sheath region that forms just in front of any solid surface. Langmuir probes are a fundamental diagnostic tool for this purpose, and by analyzing their current-voltage ($I$-$V$) characteristics, we can deduce key parameters like the electron temperature ($T_e$) and the sheath potential drop. This practice [@problem_id:3714932] provides hands-on experience in deriving these parameters from probe data, incorporating the important real-world complication of a magnetic field intersecting the surface at an oblique angle.", "problem": "A flush-mounted planar Langmuir probe (LP) is embedded in a tungsten Plasma-Facing Component (PFC) in the far scrape-off layer of a deuterium tokamak plasma. The local magnetic field intersects the PFC at an angle $\\alpha$ relative to the surface normal. The plasma is single-ion-species deuterium, quasineutral, with a Maxwellian electron velocity distribution, isothermal ions, and satisfies the generalized Bohm criterion at the sheath entrance for a magnetized, obliquely incident field. Collisional mean free paths exceed sheath scales, and the probe is sufficiently small that the sheath is planar over the collection area. The LP is slowly voltage-scanned to obtain its current–voltage characteristic.\n\nYou are given the following measured and known quantities:\n- Magnetic field inclination: $\\alpha = 80^{\\circ}$ (angle between $\\mathbf{B}$ and the surface normal).\n- Ion species: deuterium with ion mass $m_{i} = 3.345 \\times 10^{-27}\\ \\text{kg}$.\n- Electron mass: $m_{e} = 9.109 \\times 10^{-31}\\ \\text{kg}$.\n- Elementary charge: $e = 1.602 \\times 10^{-19}\\ \\text{C}$.\n- Ion temperature (isothermal ions): $T_{i} = 5.00\\ \\text{eV}$.\n- In the ion-saturation region (sufficiently negative bias), the magnitude of the ion-saturation current is measured to be $|I_{i,\\text{sat}}| = 2.40\\ \\text{mA}$.\n- The local slope of the total current at the floating potential is measured to be $\\left.\\frac{dI}{dV}\\right|_{V_{f}} = 0.120\\ \\text{mA}\\,\\text{V}^{-1}$.\n\nAssume:\n- The ion-normal flux density at the sheath edge is set by the Bohm criterion with the ion sound speed $c_{s}$ appropriate for isothermal ions at oblique incidence.\n- The electron current in the electron-retarding region is governed by Maxwellian statistics and depends exponentially on the potential difference to the plasma potential, with a pre-exponential factor set by the thermal electron flux that reaches the surface along the magnetic field, projected onto the surface normal by the factor $\\cos\\alpha$.\n- The ion current is approximately constant in the electron-retarding region of the $I$–$V$ characteristic.\n- The PFC is electrically floating so that the sheath potential drop equals $V_{\\text{sheath}} = V_{p} - V_{f}$, where $V_{p}$ is the plasma potential and $V_{f}$ is the floating potential.\n\nStarting only from fundamental kinetic expressions for Maxwellian fluxes to a surface, charge conservation at floating, and the Bohm criterion, derive expressions to infer:\n1. The electron temperature $T_{e}$ from the measured $I$–$V$ data near $V_{f}$.\n2. The sheath potential drop $V_{\\text{sheath}}$ accounting for the magnetic field inclination $\\alpha$.\n\nThen evaluate both numerically for the given data. Express $T_{e}$ in electron-volts and $V_{\\text{sheath}}$ in volts, and round both to three significant figures. Report your final result as the ordered pair $\\left(T_{e}, V_{\\text{sheath}}\\right)$.\n\nNote: Treat $T_{e}$ and $T_{i}$ as energies (so that $T_{e}$ in electron-volts converts to joules by multiplication with $e$). Use degrees for the angle $\\alpha$ as specified above.", "solution": "The problem requires the derivation of expressions for the electron temperature $T_e$ and the sheath potential drop $V_{\\text{sheath}}$ from Langmuir probe data in a magnetized plasma, followed by numerical evaluation.\n\nThe total current $I$ collected by the probe at a bias voltage $V$ is the sum of the electron current $I_e(V)$ and the ion current $I_i(V)$:\n$$I(V) = I_e(V) + I_i(V)$$\n\nAccording to the problem statement, in the electron-retarding region of the current-voltage ($I$-$V$) characteristic (where $V < V_p$, with $V_p$ being the plasma potential), the ion current is approximately constant and equal to the negative of the ion saturation current magnitude, $|I_{i,\\text{sat}}|$.\n$$I_i(V) \\approx -|I_{i,\\text{sat}}|$$\n\nThe electron current for a Maxwellian distribution in the retarding region is given by:\n$$I_e(V) = I_{e,\\text{sat}} \\exp\\left(\\frac{e(V - V_p)}{T_e}\\right)$$\nwhere $I_{e,\\text{sat}}$ is the electron saturation current, $e$ is the elementary charge, and $T_e$ is the electron temperature in units of energy (Joules). The expression for $T_e$ in electron-volts will be denoted $T_{e,\\text{eV}}$, such that $T_e = e T_{e,\\text{eV}}$.\n\nThe total current is therefore:\n$$I(V) = I_{e,\\text{sat}} \\exp\\left(\\frac{e(V - V_p)}{T_e}\\right) - |I_{i,\\text{sat}}|$$\n\n**1. Derivation and Calculation of Electron Temperature ($T_e$)**\n\nTo find $T_e$, we use the measured slope of the $I$-$V$ characteristic at the floating potential, $V_f$. The floating potential is defined as the potential at which the net current to the probe is zero, $I(V_f) = 0$.\nAt $V = V_f$:\n$$0 = I_e(V_f) + I_i(V_f) = I_e(V_f) - |I_{i,\\text{sat}}|$$\nThis implies that the electron current at the floating potential exactly balances the ion saturation current:\n$$I_e(V_f) = |I_{i,\\text{sat}}|$$\n\nNext, we calculate the derivative of the total current $I(V)$ with respect to the voltage $V$:\n$$\\frac{dI}{dV} = \\frac{d}{dV} \\left[ I_{e,\\text{sat}} \\exp\\left(\\frac{e(V - V_p)}{T_e}\\right) - |I_{i,\\text{sat}}| \\right]$$\nSince $|I_{i,\\text{sat}}|$ is assumed constant, its derivative is zero.\n$$\\frac{dI}{dV} = I_{e,\\text{sat}} \\cdot \\frac{e}{T_e} \\exp\\left(\\frac{e(V - V_p)}{T_e}\\right) = \\frac{e}{T_e} I_e(V)$$\n\nEvaluating this slope at the floating potential $V = V_f$:\n$$\\left.\\frac{dI}{dV}\\right|_{V_f} = \\frac{e}{T_e} I_e(V_f)$$\nSubstituting $I_e(V_f) = |I_{i,\\text{sat}}|$, we get:\n$$\\left.\\frac{dI}{dV}\\right|_{V_f} = \\frac{e}{T_e} |I_{i,\\text{sat}}|$$\n\nWe can now solve for the electron temperature $T_e$:\n$$T_e = e \\frac{|I_{i,\\text{sat}}|}{\\left.\\frac{dI}{dV}\\right|_{V_f}}$$\nTo express the temperature in electron-volts ($T_{e,\\text{eV}}$), we use the relation $T_e = e T_{e,\\text{eV}}$:\n$$e T_{e,\\text{eV}} = e \\frac{|I_{i,\\text{sat}}|}{\\left.\\frac{dI}{dV}\\right|_{V_f}} \\implies T_{e,\\text{eV}} = \\frac{|I_{i,\\text{sat}}|}{\\left.\\frac{dI}{dV}\\right|_{V_f}}$$\nThe units of the right-hand side are $(\\text{mA}) / (\\text{mA} \\cdot \\text{V}^{-1}) = \\text{V}$. Thus, the numerical value of this ratio gives the electron temperature in electron-volts.\n\nUsing the given data:\n$|I_{i,\\text{sat}}| = 2.40\\ \\text{mA}$\n$\\left.\\frac{dI}{dV}\\right|_{V_f} = 0.120\\ \\text{mA}\\,\\text{V}^{-1}$\n\n$$T_{e,\\text{eV}} = \\frac{2.40}{0.120} = 20.0$$\nSo, the electron temperature is $T_e = 20.0\\ \\text{eV}$.\n\n**2. Derivation and Calculation of Sheath Potential Drop ($V_{\\text{sheath}}$)**\n\nThe sheath potential drop is defined as $V_{\\text{sheath}} = V_p - V_f$. We can relate this to the currents at the floating potential. From the electron current expression at $V=V_f$:\n$$I_e(V_f) = I_{e,\\text{sat}} \\exp\\left(\\frac{e(V_f - V_p)}{T_e}\\right) = I_{e,\\text{sat}} \\exp\\left(-\\frac{e V_{\\text{sheath}}}{T_e}\\right)$$\nUsing the floating condition $I_e(V_f) = |I_{i,\\text{sat}}|$, we have:\n$$|I_{i,\\text{sat}}| = I_{e,\\text{sat}} \\exp\\left(-\\frac{e V_{\\text{sheath}}}{T_e}\\right)$$\nSolving for $V_{\\text{sheath}}$:\n$$\\exp\\left(\\frac{e V_{\\text{sheath}}}{T_e}\\right) = \\frac{I_{e,\\text{sat}}}{|I_{i, \\text{sat}}|} \\implies V_{\\text{sheath}} = \\frac{T_e}{e} \\ln\\left(\\frac{I_{e,\\text{sat}}}{|I_{i, \\text{sat}}|}\\right)$$\nSince $T_e/e = T_{e,\\text{eV}}$, this becomes:\n$$V_{\\text{sheath}} = T_{e,\\text{eV}} \\ln\\left(\\frac{I_{e,\\text{sat}}}{|I_{i, \\text{sat}}|}\\right)$$\n\nTo evaluate this, we need the ratio of the saturation currents, which is equal to the ratio of the particle flux densities. Let $A$ be the probe area.\nThe ion saturation current density $j_{i,\\text{sat}}$ is given by the ion flux at the sheath edge. According to the problem, this is set by the Bohm criterion for isothermal ions: the ion velocity normal to the surface, $v_{i,n}$, must be the ion sound speed, $c_s = \\sqrt{(T_e + T_i)/m_i}$ (using $\\gamma_i=1$ for isothermal ions).\n$$|I_{i,\\text{sat}}|/A = j_{i,\\text{sat}} = e n_{se} v_{i,n} = e n_{se} \\sqrt{\\frac{T_e + T_i}{m_i}}$$\nwhere $n_{se}$ is the plasma density at the sheath edge.\n\nThe electron saturation current density $j_{e,\\text{sat}}$ is given by the thermal electron flux along the magnetic field, projected onto the surface normal. The thermal flux of a Maxwellian distribution is $\\frac{1}{4}n\\bar{v}_e$, where $\\bar{v}_e = \\sqrt{8T_e/(\\pi m_e)}$ is the mean thermal speed.\n$$I_{e,\\text{sat}}/A = j_{e,\\text{sat}} = e \\left(\\frac{1}{4} n_{se} \\bar{v}_e\\right) \\cos\\alpha = e \\frac{1}{4} n_{se} \\sqrt{\\frac{8T_e}{\\pi m_e}} \\cos\\alpha$$\nwhere $\\alpha$ is the angle between the magnetic field and the surface normal.\n\nThe ratio of the saturation currents is:\n$$\\frac{I_{e,\\text{sat}}}{|I_{i,\\text{sat}}|} = \\frac{e \\frac{1}{4} n_{se} \\sqrt{\\frac{8T_e}{\\pi m_e}} \\cos\\alpha}{e n_{se} \\sqrt{\\frac{T_e + T_i}{m_i}}} = \\frac{\\frac{1}{4} \\sqrt{\\frac{8}{\\pi}} \\sqrt{\\frac{T_e}{m_e}} \\cos\\alpha}{\\sqrt{\\frac{T_e + T_i}{m_i}}}$$\nSimplifying the expression:\n$$\\frac{I_{e,\\text{sat}}}{|I_{i,\\text{sat}}|} = \\sqrt{\\frac{8}{16\\pi}} \\sqrt{\\frac{m_i}{m_e}} \\sqrt{\\frac{T_e}{T_e+T_i}} \\cos\\alpha = \\cos\\alpha \\sqrt{\\frac{m_i}{2\\pi m_e}} \\sqrt{\\frac{1}{1+T_i/T_e}}$$\n\nSubstituting this ratio into the expression for $V_{\\text{sheath}}$:\n$$V_{\\text{sheath}} = T_{e,\\text{eV}} \\ln\\left( \\cos\\alpha \\sqrt{\\frac{m_i}{2\\pi m_e (1+T_i/T_e)}} \\right)$$\n\nNow, we evaluate this expression numerically.\nGiven values:\n$T_e = 20.0\\ \\text{eV}$ (from Part 1)\n$T_i = 5.00\\ \\text{eV}$\n$m_i = 3.345 \\times 10^{-27}\\ \\text{kg}$\n$m_e = 9.109 \\times 10^{-31}\\ \\text{kg}$\n$\\alpha = 80^{\\circ}$\n\nFirst, calculate the dimensionless ratios:\n$T_i/T_e = 5.00\\ \\text{eV} / 20.0\\ \\text{eV} = 0.25$\n$m_i/m_e = (3.345 \\times 10^{-27}) / (9.109 \\times 10^{-31}) \\approx 3672.2$\n\nAnd the trigonometric factor:\n$\\cos(80^{\\circ}) \\approx 0.17365$\n\nNow, compute the argument of the logarithm:\n$$X = \\cos(80^{\\circ}) \\sqrt{\\frac{3672.2}{2\\pi (1+0.25)}}$$\n$$X = 0.17365 \\sqrt{\\frac{3672.2}{2.5\\pi}} \\approx 0.17365 \\sqrt{467.56} \\approx 0.17365 \\cdot 21.623 \\approx 3.754$$\n\nFinally, calculate $V_{\\text{sheath}}$:\n$$V_{\\text{sheath}} = 20.0 \\cdot \\ln(3.754) \\approx 20.0 \\cdot 1.3228 \\approx 26.456\\ \\text{V}$$\nRounding to three significant figures, $V_{\\text{sheath}} = 26.5\\ \\text{V}$.\n\nThe inferred values are $T_e = 20.0\\ \\text{eV}$ and $V_{\\text{sheath}} = 26.5\\ \\text{V}$. The ordered pair is $(20.0, 26.5)$.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n20.0 & 26.5\n\\end{pmatrix}\n}\n$$", "id": "3714932"}, {"introduction": "The lifetime of plasma-facing components is often limited by the intense heat loads they must endure, which are typically incident at very shallow, or grazing, angles. While designs often assume idealized smooth surfaces, real PFCs develop complex surface morphologies due to erosion and deposition. This exercise [@problem_id:3714874] demonstrates how such microscopic surface roughness can dramatically amplify the local heat flux, leading to localized overheating. By applying principles of vector projection, you will quantify this geometric concentration effect, gaining critical insight into a key failure mechanism for PFCs.", "problem": "A planar plasma-facing surface in a magnetic-confinement nuclear fusion device exhibits a one-dimensional periodic sawtooth morphology whose cross-section is a symmetric triangular wave. The period is $L = 50\\,\\mu\\text{m}$ and the peak-to-valley height is $H = 10\\,\\mu\\text{m}$. The ridges are aligned along the $y$-direction, and the triangular cross-section lies in the $x$-$z$ plane, where the global macroscopic normal is $\\hat{z}$. The incoming plasma heat flux can be idealized as a unidirectional energy-flux vector $\\vec{q}_{\\infty}$ with magnitude $q_{\\infty}$, lying in the $x$-$z$ plane and making a grazing-incidence angle $\\psi = 3^\\circ$ with respect to the average surface plane. Angles specified in this problem are in degrees.\n\nAssume the surface is perfectly absorbing, there is no multiple scattering or reradiation, and the only geometric effect is the local orientation of microfacets and self-shadowing. Let the local geometric concentration factor $A$ be defined as the ratio of the local absorbed heat flux per unit area on the illuminated facet to the absorbed heat flux per unit area on an ideal flat surface with the same global normal $\\hat{z}$ under the same $\\vec{q}_{\\infty}$.\n\nUsing first principles of energy-flux projection onto a surface element and consistent geometric relations for the sawtooth facets, compute the numerical value of $A$ for the illuminated facet under the stated grazing incidence. Round your answer to four significant figures. The final answer is dimensionless.", "solution": "The problem asks for the geometric concentration factor $A$ on an illuminated facet of a sawtooth-structured surface under grazing-incidence plasma heat flux. The solution requires a careful geometric analysis of the surface and the incident flux vector.\n\nFirst, we establish a coordinate system and define the geometry. Let the average surface plane be the $x$-$y$ plane, so the global macroscopic normal is $\\hat{n}_{global} = \\hat{z} = (0, 0, 1)$. The sawtooth cross-section lies in the $x$-$z$ plane. The triangular wave has a period of $L = 50\\,\\mu\\text{m}$ and a peak-to-valley height of $H = 10\\,\\mu\\text{m}$.\nA single period of the symmetric triangular wave can be described by a peak and two adjacent valleys. The horizontal distance between a valley and the next peak is $L/2$. The vertical distance is the peak-to-valley height $H$.\nThe slope of the facets is therefore given by the ratio of the vertical rise ($H$) to the horizontal run ($L/2$). Let $\\alpha$ be the angle that the facets make with the horizontal ($x$-axis).\n$$\n\\tan(\\alpha) = \\frac{H}{L/2} = \\frac{2H}{L}\n$$\nSubstituting the given values, $H = 10\\,\\mu\\text{m}$ and $L = 50\\,\\mu\\text{m}$:\n$$\n\\tan(\\alpha) = \\frac{2 \\times 10\\,\\mu\\text{m}}{50\\,\\mu\\text{m}} = \\frac{20}{50} = 0.4\n$$\nThe angle $\\alpha$ is thus $\\alpha = \\arctan(0.4)$.\n\nThe sawtooth structure has two types of facets. We can define their outward-pointing unit normal vectors. These vectors lie in the $x$-$z$ plane.\nOne facet slopes \"up\" from left to right, and its normal vector will have a negative $x$-component. We can denote this as $\\hat{n}_1$.\n$$\n\\hat{n}_1 = (-\\sin\\alpha, 0, \\cos\\alpha)\n$$\nThe other facet slopes \"down\" from left to right, and its normal vector will have a positive $x$-component. We denote this as $\\hat{n}_2$.\n$$\n\\hat{n}_2 = (\\sin\\alpha, 0, \\cos\\alpha)\n$$\n\nNext, we define the incident plasma heat flux vector, $\\vec{q}_{\\infty}$. It has magnitude $q_{\\infty}$, lies in the $x$-$z$ plane, and makes a grazing-incidence angle $\\psi = 3^\\circ$ with the average surface plane ($x$-$y$ plane). The angle between $\\vec{q}_{\\infty}$ and the $x$-$y$ plane is $\\psi$. The vector points towards the surface, so its $z$-component must be negative. The problem does not specify the direction of incidence in the $x$-direction, but for a periodic surface, we can assume it comes from the positive $x$-direction without loss of generality.\nThe unit vector in the direction of energy propagation is therefore:\n$$\n\\hat{k} = (-\\cos\\psi, 0, -\\sin\\psi)\n$$\nThe heat flux vector is $\\vec{q}_{\\infty} = q_{\\infty}\\hat{k} = q_{\\infty}(-\\cos\\psi, 0, -\\sin\\psi)$.\n\nFor a facet to be illuminated, the incident flux must strike it. If the incident flux vector is shallower than the facet slope, shadowing will occur. The condition for the upslope facet (with normal $\\hat{n}_1$) to be shadowed by the preceding ridge is that the grazing angle $\\psi$ is less than the facet angle $\\alpha$.\nWe have $\\psi = 3^\\circ$ and $\\alpha = \\arctan(0.4) \\approx 21.8^\\circ$. Since $\\psi < \\alpha$, the flux is shallower than the upslope facet's tilt. Therefore, the upslope facet is in shadow, and only the downslope facet (with normal $\\hat{n}_2$) is illuminated.\n\nThe local absorbed heat flux per unit area, $q_{local}$, on a surface is the projection of the flux vector onto the surface normal. The flux is a positive quantity, so we take the magnitude of the dot product, noting that the normal $\\hat{n}$ points out of the surface while $\\vec{q}_{\\infty}$ points in.\n$$\nq_{local} = |\\vec{q}_{\\infty} \\cdot \\hat{n}_2| = |q_{\\infty}(-\\cos\\psi, 0, -\\sin\\psi) \\cdot (\\sin\\alpha, 0, \\cos\\alpha)|\n$$\n$$\nq_{local} = |q_{\\infty}(-\\cos\\psi\\sin\\alpha - \\sin\\psi\\cos\\alpha)| = q_{\\infty}|-(\\sin\\alpha\\cos\\psi + \\cos\\alpha\\sin\\psi)|\n$$\nUsing the trigonometric sum identity $\\sin(A+B) = \\sin A \\cos B + \\cos A \\sin B$:\n$$\nq_{local} = q_{\\infty}|\\sin(\\alpha+\\psi)|\n$$\nSince $\\alpha \\approx 21.8^\\circ$ and $\\psi = 3^\\circ$, both are acute angles and their sum is less than $180^\\circ$, so $\\sin(\\alpha+\\psi)$ is positive.\n$$\nq_{local} = q_{\\infty}\\sin(\\alpha+\\psi)\n$$\n\nThe absorbed heat flux per unit area on the reference ideal flat surface, $q_{flat}$, is calculated using the global normal $\\hat{n}_{global} = \\hat{z} = (0, 0, 1)$.\n$$\nq_{flat} = |\\vec{q}_{\\infty} \\cdot \\hat{z}| = |q_{\\infty}(-\\cos\\psi, 0, -\\sin\\psi) \\cdot (0, 0, 1)|\n$$\n$$\nq_{flat} = |q_{\\infty}(-\\sin\\psi)| = q_{\\infty}\\sin\\psi\n$$\nThis result is expected, as the flux component normal to the surface is proportional to the sine of the grazing angle.\n\nThe local geometric concentration factor $A$ is defined as the ratio of $q_{local}$ to $q_{flat}$.\n$$\nA = \\frac{q_{local}}{q_{flat}} = \\frac{q_{\\infty}\\sin(\\alpha+\\psi)}{q_{\\infty}\\sin\\psi} = \\frac{\\sin(\\alpha+\\psi)}{\\sin\\psi}\n$$\n\nNow we substitute the values to find the numerical result. We have $\\psi = 3^\\circ$ and $\\alpha = \\arctan(0.4)$.\n$$\nA = \\frac{\\sin(\\arctan(0.4) + 3^\\circ)}{\\sin(3^\\circ)}\n$$\nUsing a calculator (in degrees mode):\n$\\alpha = \\arctan(0.4) \\approx 21.8014^\\circ$\n$\\alpha + \\psi \\approx 21.8014^\\circ + 3^\\circ = 24.8014^\\circ$\n$$\nA \\approx \\frac{\\sin(24.8014^\\circ)}{\\sin(3^\\circ)} \\approx \\frac{0.4194726}{0.0523360} \\approx 8.015248\n$$\nThe problem requires the answer to be rounded to four significant figures.\n$$\nA \\approx 8.015\n$$\nThis factor indicates that the tilted facet receives approximately $8$ times more heat flux per unit area than a flat surface under the same grazing-incidence conditions, a direct consequence of its more favorable orientation relative to the incoming flux.", "answer": "$$\n\\boxed{8.015}\n$$", "id": "3714874"}, {"introduction": "To design robust PFCs, we must predict their thermal response to extreme transient events like Edge Localized Modes (ELMs), which deposit immense energy in milliseconds. This requires moving beyond simple analytical models to full numerical simulation of heat transport within the material. This practice [@problem_id:3714929] is a capstone exercise in which you will implement a finite-difference code to solve the heat diffusion equation, incorporating realistic physics such as temperature-dependent properties and the latent heat of fusion. Developing this simulation builds essential computational skills for assessing material integrity and performance limits under reactor-relevant conditions.", "problem": "Consider a one-dimensional semi-infinite tungsten slab representing a plasma-facing component subjected to an Edge Localized Mode (ELM) transient. The slab occupies $x \\ge 0$ and initially has a uniform temperature $T(x,0) = T_0$. At the surface $x=0$, a square heat flux pulse of constant magnitude $q_0$ is applied for a duration $\\Delta t$, after which the heat flux is zero. Assume that thermophysical properties are isotropic and, unless explicitly stated otherwise, independent of space and time. The goal is to compute the melt depth at the end of the pulse, defined as the maximum depth $x_{\\mathrm{melt}}$ such that $T(x,\\Delta t) \\ge T_m$, where $T_m$ is the melting temperature of tungsten.\n\nStarting from the conservation of energy and Fourier's law of heat conduction, the one-dimensional heat equation for temperature $T(x,t)$ in a material with mass density $\\rho$ and mass-specific heat capacity $c_p(T)$ under heat conduction with thermal conductivity $k$ is\n$$\n\\rho\\,c_p(T)\\,\\frac{\\partial T}{\\partial t} = k\\,\\frac{\\partial^2 T}{\\partial x^2}.\n$$\nThe boundary condition at the surface during the pulse is the Neumann condition expressing the applied heat flux,\n$$\n-k\\,\\left.\\frac{\\partial T}{\\partial x}\\right|_{x=0,t} = q(t),\n$$\nwith $q(t) = q_0$ for $0 \\le t \\le \\Delta t$ and $q(t) = 0$ otherwise. At large depth, impose zero-gradient (insulating) boundary condition consistent with a semi-infinite domain.\n\nInclude the latent heat of fusion $L_m$ and temperature-dependent heat capacity $c_p(T)$ using the enthalpy formulation implemented as an apparent heat capacity method. Define an effective mass-specific heat capacity $c_p^{\\mathrm{eff}}(T)$ as\n$$\nc_p^{\\mathrm{eff}}(T) = c_p(T) + \\Delta c_{\\mathrm{lat}}(T),\n$$\nwhere\n$$\nc_p(T) = c_0 + c_1\\,(T - T_{\\mathrm{ref}})\n$$\nand\n$$\n\\Delta c_{\\mathrm{lat}}(T) =\n\\begin{cases}\n\\displaystyle \\frac{L_m}{\\Delta T_{\\mathrm{smooth}}}, & \\text{if } \\left|T - T_m\\right| \\le \\frac{\\Delta T_{\\mathrm{smooth}}}{2},\\\n$$6pt]\n0, & \\text{otherwise}.\n\\end{cases}\n$$\nThis smears the latent heat over a narrow interval of width $\\Delta T_{\\mathrm{smooth}}$ around the melting temperature $T_m$, ensuring numerical stability while conserving energy. The thermal diffusivity is $\\alpha(T) = \\dfrac{k}{\\rho\\,c_p^{\\mathrm{eff}}(T)}$.\n\nUse an explicit finite-difference scheme on a uniform spatial grid with spacing $\\Delta x$ to approximate the heat equation over a finite computational domain $0 \\le x \\le X_{\\max}$, chosen sufficiently large to approximate a semi-infinite medium during the pulse. The stability criterion for the explicit scheme requires a time step $\\Delta t_{\\mathrm{step}}$ satisfying\n$$\n\\Delta t_{\\mathrm{step}} \\le \\frac{\\Delta x^2}{2\\,\\alpha_{\\max}},\n$$\nwhere $\\alpha_{\\max} = \\dfrac{k}{\\rho\\,c_{p,\\min}}$ and $c_{p,\\min}$ is the minimum possible $c_p^{\\mathrm{eff}}(T)$ over the temperature range of interest. Implement the surface flux boundary using a ghost point consistent with the Neumann condition. Use a zero-gradient boundary at $x=X_{\\max}$.\n\nMaterial properties for tungsten to be used in the calculation:\n- Mass density $\\rho = 19260$ kg/m$^3$,\n- Thermal conductivity $k = 120$ W/mK,\n- Melting temperature $T_m = 3695$ K,\n- Latent heat of fusion $L_m = 1.92 \\times 10^5$ J/kg,\n- Heat capacity model parameters $c_0 = 134$ J/kgK, $c_1 = 0.02$ J/kgK per K, $T_{\\mathrm{ref}} = 300$ K,\n- Latent heat smoothing width $\\Delta T_{\\mathrm{smooth}} = 50$ K.\n\nDiscretization parameters:\n- Spatial step $\\Delta x = 5 \\times 10^{-6}$ m,\n- Computational depth $X_{\\max} = 2 \\times 10^{-3}$ m,\n- Time step selected to satisfy the explicit stability criterion above with a safety factor of $0.4$ applied to the right-hand side.\n\nDefine the melt depth at the end of the pulse as\n$$\nx_{\\mathrm{melt}} = \\max\\{x_i \\,:\\, T(x_i,\\Delta t) \\ge T_m\\},\n$$\nwhere $x_i$ are the grid point positions. If no grid point satisfies $T(x_i,\\Delta t) \\ge T_m$, then $x_{\\mathrm{melt}} = 0$.\n\nImplement a program that, for each test case, integrates the heat equation with the specified boundary conditions and properties up to time $\\Delta t$ and returns the melt depth in millimeters. Express all melt depths in millimeters (mm) as decimal floats rounded to six decimal places.\n\nTest suite:\n- Case $1$: $q_0 = 3.0 \\times 10^8$ W/m$^2$, $\\Delta t = 1.0 \\times 10^{-3}$ s, $T_0 = 300$ K.\n- Case $2$: $q_0 = 5.0 \\times 10^7$ W/m$^2$, $\\Delta t = 5.0 \\times 10^{-4}$ s, $T_0 = 300$ K.\n- Case $3$: $q_0 = 2.0 \\times 10^8$ W/m$^2$, $\\Delta t = 5.0 \\times 10^{-4}$ s, $T_0 = 1200$ K.\n- Case $4$: $q_0 = 1.5 \\times 10^8$ W/m$^2$, $\\Delta t = 2.0 \\times 10^{-4}$ s, $T_0 = 2000$ K.\n- Case $5$: $q_0 = 8.0 \\times 10^8$ W/m$^2$, $\\Delta t = 5.0 \\times 10^{-4}$ s, $T_0 = 300$ K.\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[d_1,d_2,d_3,d_4,d_5]$), where each $d_i$ is the melt depth for case $i$ in millimeters rounded to six decimal places.", "solution": "The problem requires the calculation of the melt depth in a semi-infinite tungsten slab subjected to a transient surface heat flux. This is a one-dimensional, time-dependent heat conduction problem with a phase change, governed by a nonlinear partial differential equation. The solution will be obtained by numerically integrating the heat equation using an explicit finite-difference method.\n\nThe governing partial differential equation for one-dimensional heat conduction is an expression of the conservation of energy:\n$$\n\\rho\\,c_p^{\\mathrm{eff}}(T)\\,\\frac{\\partial T}{\\partial t} = \\frac{\\partial}{\\partial x}\\left(k \\frac{\\partial T}{\\partial x}\\right)\n$$\nwhere $T(x,t)$ is the temperature at depth $x$ and time $t$, $\\rho$ is the mass density, $k$ is the thermal conductivity, and $c_p^{\\mathrm{eff}}(T)$ is the effective mass-specific heat capacity, which accounts for temperature dependence and the latent heat of fusion. The problem specifies that $k$ and $\\rho$ are constant, simplifying the equation to:\n$$\n\\rho\\,c_p^{\\mathrm{eff}}(T)\\,\\frac{\\partial T}{\\partial t} = k\\,\\frac{\\partial^2 T}{\\partial x^2}\n$$\nThis can be rewritten in terms of the thermal diffusivity, $\\alpha(T) = k / (\\rho c_p^{\\mathrm{eff}}(T))$, as:\n$$\n\\frac{\\partial T}{\\partial t} = \\alpha(T)\\,\\frac{\\partial^2 T}{\\partial x^2}\n$$\nThe nonlinearity arises from the dependence of $\\alpha$ on temperature $T$.\n\nThe initial condition is a uniform temperature profile: $T(x,0) = T_0$. The computational domain is a finite slab of thickness $X_{\\max}$, chosen to be sufficiently large such that the temperature at $x=X_{\\max}$ remains unchanged, approximating a semi-infinite medium.\n\nThe boundary conditions are:\n$1$. At the surface $x=0$, a Neumann condition representing the applied heat flux $q_0$ for a duration $\\Delta t$:\n$$\n-k\\,\\left.\\frac{\\partial T}{\\partial x}\\right|_{x=0} = q_0 \\quad \\text{for } 0 \\le t \\le \\Delta t\n$$\n$2$. At the back of the computational domain, $x=X_{\\max}$, a zero-gradient (insulating) boundary condition is imposed:\n$$\n\\left.\\frac{\\partial T}{\\partial x}\\right|_{x=X_{\\max}} = 0\n$$\n\nThe latent heat of fusion is incorporated using the apparent heat capacity method. This method avoids tracking the melt front explicitly by smearing the latent heat $L_m$ over a small temperature interval $\\Delta T_{\\mathrm{smooth}}$ around the melting temperature $T_m$. The effective heat capacity $c_p^{\\mathrm{eff}}(T)$ is defined as:\n$$\nc_p^{\\mathrm{eff}}(T) = c_p(T) + \\Delta c_{\\mathrm{lat}}(T)\n$$\nwhere $c_p(T) = c_0 + c_1(T - T_{\\mathrm{ref}})$ is the temperature-dependent specific heat of the solid/liquid phase, and $\\Delta c_{\\mathrm{lat}}(T)$ is a function that is non-zero only within the smoothing interval:\n$$\n\\Delta c_{\\mathrm{lat}}(T) = \\frac{L_m}{\\Delta T_{\\mathrm{smooth}}} \\quad \\text{for } \\left|T - T_m\\right| \\le \\frac{\\Delta T_{\\mathrm{smooth}}}{2}, \\text{ and } 0 \\text{ otherwise.}\n$$\n\nTo solve the system, we discretize the spatial domain into a uniform grid with spacing $\\Delta x$, such that $x_i = i\\,\\Delta x$ for $i=0, 1, \\dots, N_x$, where $N_x = X_{\\max} / \\Delta x$. Time is discretized with a step $\\Delta t_{\\mathrm{step}}$, such that $t_n = n\\,\\Delta t_{\\mathrm{step}}$. The temperature at grid point $x_i$ and time $t_n$ is denoted by $T_i^n$.\n\nAn explicit Forward-Time Centered-Space (FTCS) scheme is used. The time derivative is approximated by a forward difference and the spatial second derivative by a central difference:\n$$\n\\frac{T_i^{n+1} - T_i^n}{\\Delta t_{\\mathrm{step}}} = \\alpha(T_i^n) \\frac{T_{i+1}^n - 2T_i^n + T_{i-1}^n}{\\Delta x^2}\n$$\nThis yields the update rule for the temperature at interior grid points ($i=1, \\dots, N_x-1$):\n$$\nT_i^{n+1} = T_i^n + \\frac{\\alpha(T_i^n)\\,\\Delta t_{\\mathrm{step}}}{\\Delta x^2} \\left( T_{i+1}^n - 2T_i^n + T_{i-1}^n \\right)\n$$\n\nThe boundary conditions are implemented using ghost points.\nAt the surface $x_0=0$, the Neumann condition is discretized as $-k(T_1^n - T_{-1}^n)/(2\\Delta x) = q_0$, where $T_{-1}^n$ is the temperature at a ghost point at $x = -\\Delta x$. This gives $T_{-1}^n = T_1^n + 2\\Delta x\\,q_0/k$. Substituting this into the general update rule for $i=0$ gives:\n$$\nT_0^{n+1} = T_0^n + 2\\frac{\\alpha(T_0^n)\\,\\Delta t_{\\mathrm{step}}}{\\Delta x^2} (T_1^n - T_0^n) + \\frac{2\\,\\Delta t_{\\mathrm{step}}\\,q_0}{\\rho\\,c_p^{\\mathrm{eff}}(T_0^n)\\,\\Delta x}\n$$\nAt the back boundary $x_{N_x}=X_{\\max}$, the zero-gradient condition is discretized as $(T_{N_x+1}^n - T_{N_x-1}^n)/(2\\Delta x) = 0$, giving the ghost point temperature $T_{N_x+1}^n = T_{N_x-1}^n$. Substituting this into the update rule for $i=N_x$ results in:\n$$\nT_{N_x}^{n+1} = T_{N_x}^n + 2\\frac{\\alpha(T_{N_x}^n)\\,\\Delta t_{\\mathrm{step}}}{\\Delta x^2} (T_{N_x-1}^n - T_{N_x}^n)\n$$\n\nThe explicit scheme is conditionally stable. The time step $\\Delta t_{\\mathrm{step}}$ must satisfy the Courant-Friedrichs-Lewy (CFL) condition:\n$$\n\\Delta t_{\\mathrm{step}} \\le \\frac{\\Delta x^2}{2\\,\\alpha_{\\max}}\n$$\nwhere $\\alpha_{\\max} = k / (\\rho\\,c_{p,\\min}^{\\mathrm{eff}})$ is the maximum thermal diffusivity. Since $c_p^{\\mathrm{eff}}(T)$ has its minimum value at the lowest temperature encountered ($T_0=300\\,\\text{K}$ for the given cases, outside the phase-change region), $c_{p,\\min}^{\\mathrm{eff}} = c_p(300\\,\\text{K}) = c_0$. The problem specifies a safety factor of $0.4$, so the time step is set to:\n$$\n\\Delta t_{\\mathrm{step}} = 0.4 \\times \\frac{\\Delta x^2}{2\\,\\alpha_{\\max}} = 0.2 \\frac{\\Delta x^2\\,\\rho\\,c_0}{k}\n$$\n\nThe overall algorithm proceeds as follows for each test case:\n$1$. Initialize the constants and material properties ($\\rho, k, T_m, c_0$, etc.) and discretization parameters ($\\Delta x, X_{\\max}$).\n$2$. Construct the spatial grid $x_i$ and initialize the temperature array $T_i^0 = T_0$.\n$3$. Calculate the stable time step $\\Delta t_{\\mathrm{step}}$.\n$4$. Determine the total number of full time steps, $N_{\\mathrm{steps}} = \\lfloor \\Delta t / \\Delta t_{\\mathrm{step}} \\rfloor$, and the remaining time for the last partial step, $\\Delta t_{\\mathrm{rem}} = \\Delta t - N_{\\mathrm{steps}}\\,\\Delta t_{\\mathrm{step}}$.\n$5$. Iterate $N_{\\mathrm{steps}}$ times, updating the entire temperature array at each step using the discretized equations with $\\Delta t_{\\mathrm{step}}$.\n$6$. Perform one final update using the remaining time step $\\Delta t_{\\mathrm{rem}}$.\n$7$. After the simulation up to time $\\Delta t$, identify all grid indices $i$ for which $T_i^{\\mathrm{final}} \\ge T_m$.\n$8$. If any such points exist, the melt depth $x_{\\mathrm{melt}}$ is the maximum corresponding depth, $x_{\\mathrm{melt}} = \\max \\{x_i | T_i^{\\mathrm{final}} \\ge T_m\\}$. Otherwise, $x_{\\mathrm{melt}} = 0$.\n$9$. Convert the result to millimeters, round to six decimal places, and store it.\nThis procedure is repeated for all provided test cases.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the 1D heat conduction problem for tungsten under ELM-like heat loads.\n    \"\"\"\n    # Material properties for tungsten (SI units)\n    rho = 19260.0  # Mass density [kg/m^3]\n    k = 120.0  # Thermal conductivity [W/mK]\n    Tm = 3695.0  # Melting temperature [K]\n    Lm = 1.92e5  # Latent heat of fusion [J/kg]\n    c0 = 134.0  # Heat capacity model parameter [J/kgK]\n    c1 = 0.02  # Heat capacity model parameter [J/kgK^2]\n    T_ref = 300.0  # Reference temperature for heat capacity [K]\n    dT_smooth = 50.0  # Latent heat smoothing width [K]\n\n    # Discretization parameters\n    dx = 5.0e-6  # Spatial step [m]\n    X_max = 2.0e-3  # Computational depth [m]\n    safety_factor = 0.4 # Safety factor for time step\n\n    # Setup spatial grid\n    x_grid = np.arange(0, X_max + dx, dx)\n    Nx = len(x_grid) - 1\n\n    # Calculate stable time step\n    # c_p_min is at the lowest temperature, T=300K, where c_p = c0.\n    c_p_min = c0\n    alpha_max = k / (rho * c_p_min)\n    dt_step = safety_factor * (dx**2 / (2 * alpha_max))\n\n    # Test suite\n    test_cases = [\n        # (q0 [W/m^2], dt_pulse [s], T0 [K])\n        (3.0e8, 1.0e-3, 300.0),\n        (5.0e7, 5.0e-4, 300.0),\n        (2.0e8, 5.0e-4, 1200.0),\n        (1.5e8, 2.0e-4, 2000.0),\n        (8.0e8, 5.0e-4, 300.0),\n    ]\n\n    results_mm = []\n\n    def c_p_eff(T_arr):\n        \"\"\"Calculates the effective specific heat capacity as a numpy array.\"\"\"\n        cp = c0 + c1 * (T_arr - T_ref)\n        \n        # Contribution from latent heat\n        dcp_lat = np.zeros_like(T_arr)\n        Tm_minus = Tm - dT_smooth / 2.0\n        Tm_plus = Tm + dT_smooth / 2.0\n        mask = (T_arr >= Tm_minus) & (T_arr <= Tm_plus)\n        dcp_lat[mask] = Lm / dT_smooth\n        \n        return cp + dcp_lat\n\n    def perform_time_step(T, dt, q0_val):\n        \"\"\"Performs a single time step update on the temperature array T.\"\"\"\n        T_n = T.copy()\n\n        c_eff = c_p_eff(T_n)\n        alpha = k / (rho * c_eff)\n        fourier_num = alpha * dt / dx**2\n\n        # Update interior points\n        T[1:-1] = T_n[1:-1] + fourier_num[1:-1] * (T_n[2:] - 2 * T_n[1:-1] + T_n[:-2])\n\n        # Update boundary at x=0 (Neumann condition)\n        T[0] = T_n[0] + 2 * fourier_num[0] * (T_n[1] - T_n[0]) + (2 * dt * q0_val) / (rho * c_eff[0] * dx)\n\n        # Update boundary at x=X_max (zero-gradient)\n        T[-1] = T_n[-1] + 2 * fourier_num[-1] * (T_n[-2] - T_n[-1])\n        \n        return T\n\n    for q0, dt_pulse, T0 in test_cases:\n        # Initialize temperature profile\n        T = np.full_like(x_grid, T0, dtype=float)\n\n        # Time-stepping loop\n        num_steps = int(dt_pulse / dt_step)\n        dt_rem = dt_pulse - num_steps * dt_step\n\n        for _ in range(num_steps):\n            T = perform_time_step(T, dt_step, q0)\n        \n        # Final smaller time step to land exactly on dt_pulse\n        if dt_rem > 0:\n            T = perform_time_step(T, dt_rem, q0)\n\n        # Calculate melt depth\n        melt_indices = np.where(T >= Tm)[0]\n        \n        if melt_indices.size > 0:\n            max_melt_index = np.max(melt_indices)\n            x_melt_m = x_grid[max_melt_index]\n        else:\n            x_melt_m = 0.0\n\n        # Convert to mm and store\n        results_mm.append(x_melt_m * 1000)\n\n    # Format the final output\n    print(f\"[{','.join(f'{d:.6f}' for d in results_mm)}]\")\n\nsolve()\n```", "id": "3714929"}]}