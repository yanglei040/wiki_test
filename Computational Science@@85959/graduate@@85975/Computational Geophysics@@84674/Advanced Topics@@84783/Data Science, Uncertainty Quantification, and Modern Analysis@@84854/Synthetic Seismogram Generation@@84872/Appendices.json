{"hands_on_practices": [{"introduction": "The fidelity of any numerical wave simulation hinges on the proper discretization of the physical domain. This first practice addresses the fundamental challenge of spatial aliasing, a critical numerical artifact that can render synthetic data physically meaningless [@problem_id:3615906]. By deriving the maximum allowable receiver spacing from first principles, you will translate sampling theory into a practical constraint for computational geophysics, ensuring the integrity of your synthetic seismograms.", "problem": "You are designing a two-dimensional synthetic shot gather for an isotropic acoustic medium using Finite Difference (FD) modeling. Receivers are to be placed along a horizontal line at uniform spacing $\\Delta x$. The modeled source is a band-limited wavelet whose temporal spectrum is negligible above a specified maximum frequency $f_{\\max}$. To ensure that the shot gather exhibits no spatial aliasing for any event whose apparent emergence angle at the receiver line (measured from the vertical) does not exceed a prescribed maximum $\\theta_{\\max}$, you must choose $\\Delta x$ small enough to satisfy the spatial sampling requirements for all plane-wave components present in the data. \n\nStarting from the following fundamental bases:\n- The constant-coefficient acoustic wave equation in two dimensions, whose monochromatic plane-wave solutions $p(x,z,t)=A \\exp\\{ \\mathrm{i}(\\omega t - k_x x - k_z z)\\}$ satisfy the dispersion relation $\\omega^{2} = v^{2}(k_x^{2} + k_z^{2})$, where $v$ is the phase velocity, $\\omega=2\\pi f$ is the angular frequency, and $(k_x,k_z)$ is the wavevector.\n- The Nyquist sampling theorem in space, which states that a band-limited field in wavenumber $k_x$ can be sampled on a spatial grid of spacing $\\Delta x$ without aliasing if its wavenumber support satisfies $|k_x| \\leq \\pi/\\Delta x$,\n\nderive a conservative expression for the maximum allowable receiver spacing $\\Delta x$ that prevents spatial aliasing for all temporal frequencies up to $f_{\\max}$ and all emergence angles up to $\\theta_{\\max}$, when the minimum phase velocity in the model is $v_{\\min}$. Then evaluate this spacing numerically for the design parameters\n$$v_{\\min} = 2.000 \\times 10^{3} \\text{ m/s}, \\quad f_{\\max} = 1.00 \\times 10^{2} \\text{ Hz}, \\quad \\theta_{\\max} = 60.0^\\circ.$$\n\nExpress the final spacing in meters, and round your answer to four significant figures. Use degrees for angles.", "solution": "The derivation proceeds by first establishing a relationship between the horizontal wavenumber $k_x$, frequency $f$, velocity $v$, and emergence angle $\\theta$. We then determine the maximum possible value of $k_x$ under the specified constraints and apply the Nyquist sampling criterion to find the corresponding maximum allowable receiver spacing $\\Delta x$.\n\nFor a monochromatic plane wave, the magnitude of the wavevector $\\vec{k}$ is given by $k = |\\vec{k}| = \\sqrt{k_x^2 + k_z^2}$. From the dispersion relation, $\\omega^2 = v^2 k^2$, which implies $k = \\omega/v$. Since $\\omega = 2\\pi f$, we have:\n$$k = \\frac{2\\pi f}{v}$$\nThe emergence angle $\\theta$ is measured from the vertical ($z$) axis. The components of the wavevector are thus related to the angle $\\theta$ by $k_x = k \\sin\\theta$ and $k_z = k \\cos\\theta$. Substituting the expression for $k$, we find the horizontal wavenumber $k_x$:\n$$k_x = \\frac{2\\pi f}{v} \\sin\\theta$$\nThe spatial Nyquist sampling theorem requires that the sampling interval $\\Delta x$ must be small enough to capture the highest horizontal wavenumber present in the signal without aliasing. The condition is $|k_x| \\le k_{x, \\text{Nyquist}} = \\frac{\\pi}{\\Delta x}$. To ensure this condition holds for all possible waves in the simulation, we must consider the worst-case scenario that maximizes $|k_x|$. This yields a conservative (i.e., sufficiently small) sampling interval.\n\nThe magnitude of $k_x$ is maximized when:\n1. The frequency $f$ is at its maximum value, $f_{\\max}$.\n2. The phase velocity $v$ is at its minimum value, $v_{\\min}$. A lower velocity medium results in a shorter wavelength for a given frequency, hence a larger wavenumber.\n3. The term $|\\sin\\theta|$ is maximized. Given that the angle $\\theta$ can range from $0$ up to $\\theta_{\\max}$, and $\\sin\\theta$ is a monotonically increasing function on the interval $[0^\\circ, 90^\\circ]$, its maximum value occurs at $\\theta = \\theta_{\\max}$.\n\nCombining these factors gives the absolute maximum horizontal wavenumber, $k_{x, \\text{abs_max}}$:\n$$k_{x, \\text{abs_max}} = \\frac{2\\pi f_{\\max}}{v_{\\min}} \\sin\\theta_{\\max}$$\nThe no-aliasing condition for the receiver spacing $\\Delta x$ must hold for this maximum wavenumber:\n$$k_{x, \\text{abs_max}} \\le \\frac{\\pi}{\\Delta x}$$\nSubstituting the expression for $k_{x, \\text{abs_max}}$:\n$$\\frac{2\\pi f_{\\max}}{v_{\\min}} \\sin\\theta_{\\max} \\le \\frac{\\pi}{\\Delta x}$$\nSolving for $\\Delta x$, we find the constraint on the receiver spacing:\n$$\\Delta x \\le \\frac{\\pi v_{\\min}}{2\\pi f_{\\max} \\sin\\theta_{\\max}}$$\nSimplifying this expression yields the formula for the maximum allowable receiver spacing, $\\Delta x_{\\max}$, that guarantees no spatial aliasing:\n$$\\Delta x_{\\max} = \\frac{v_{\\min}}{2 f_{\\max} \\sin\\theta_{\\max}}$$\nThis is the derived conservative expression for the receiver spacing.\n\nNext, we evaluate this expression using the given numerical values:\n- $v_{\\min} = 2.000 \\times 10^{3} \\text{ m/s}$\n- $f_{\\max} = 1.00 \\times 10^{2} \\text{ Hz}$\n- $\\theta_{\\max} = 60.0^\\circ$\n\nWe note that $\\sin(60.0^\\circ) = \\frac{\\sqrt{3}}{2}$.\n\nSubstituting these values into the formula for $\\Delta x_{\\max}$:\n$$\\Delta x_{\\max} = \\frac{2.000 \\times 10^{3}}{2 \\times (1.00 \\times 10^{2}) \\times \\sin(60.0^\\circ)}$$\n$$\\Delta x_{\\max} = \\frac{2000}{2 \\times 100 \\times \\frac{\\sqrt{3}}{2}} = \\frac{2000}{100\\sqrt{3}} = \\frac{20}{\\sqrt{3}}$$\nCalculating the numerical value:\n$$\\Delta x_{\\max} \\approx 11.54700538... \\text{ m}$$\nAs per the problem's requirement, the result must be rounded to four significant figures.\n$$\\Delta x_{\\max} \\approx 11.55 \\text{ m}$$", "answer": "$$\\boxed{11.55}$$", "id": "3615906"}, {"introduction": "With a properly designed numerical grid, our focus shifts to accurately representing the seismic source. This exercise delves into the physics of the elastodynamic Green's tensor to distinguish the far-field component, which propagates to great distances, from the near-field component, which decays rapidly away from the source [@problem_id:3615929]. Quantifying the ratio of these terms is essential for accurately modeling amplitudes at short source-receiver offsets, a scenario common in various seismic survey designs.", "problem": "Consider a three-dimensional, homogeneous, isotropic, elastic full space with density $\\rho$, Lamé parameters $\\lambda$ and $\\mu$, compressional-wave speed $c_{p} = \\sqrt{\\frac{\\lambda + 2\\mu}{\\rho}}$, and shear-wave speed $c_{s} = \\sqrt{\\frac{\\mu}{\\rho}}$. A point source at the origin produces an isotropic, time-harmonic volumetric expansion that excites only compressional (Primary, P) waves and no shear (Secondary, S) waves. Assume the source has angular frequency $\\omega$ with time dependence $\\exp(-\\mathrm{i}\\omega t)$. Synthetic seismogram generation at short offsets is often sensitive to near-field terms in the elastodynamic Green’s tensor. \n\nStarting from the Navier elastodynamic equations and using the Helmholtz decomposition of the displacement field, derive from first principles the leading-order asymptotic form of the radial displacement $u_{r}(r,\\omega)$ at a receiver located a distance $r$ from the source along the radial direction. Identify and justify which terms constitute the far-field and near-field contributions in the frequency domain for this isotropic source, and express the magnitude ratio of the near-field to far-field contributions in terms of the dimensionless parameter $k_{p} r$, where $k_{p} = \\omega / c_{p}$ is the compressional wavenumber.\n\nThen, for a synthetic seismogram scenario representative of short-offset marine acquisition, evaluate this near-field to far-field magnitude ratio for the parameters $f = 5\\,\\text{Hz}$ (so that $\\omega = 2\\pi f$), $c_{p} = 4.0 \\times 10^{3}\\,\\text{m/s}$, and $r = 1.0 \\times 10^{2}\\,\\text{m}$. \n\nRound your final numerical answer to four significant figures. Express the final answer as a dimensionless number.", "solution": "We begin with the Navier elastodynamic equation for a homogeneous, isotropic, elastic medium, which relates the displacement vector $\\mathbf{u}(\\mathbf{x}, t)$ to the body force density $\\mathbf{f}(\\mathbf{x}, t)$:\n$$ (\\lambda + 2\\mu) \\nabla(\\nabla \\cdot \\mathbf{u}) - \\mu \\nabla \\times (\\nabla \\times \\mathbf{u}) + \\mathbf{f} = \\rho \\frac{\\partial^2 \\mathbf{u}}{\\partial t^2} $$\nwhere $\\rho$ is the density, and $\\lambda$ and $\\mu$ are the Lamé parameters.\n\nGiven the time-harmonic dependence $\\exp(-\\mathrm{i}\\omega t)$, we can write the fields in the frequency domain as $\\mathbf{u}(\\mathbf{x}, t) = \\mathbf{u}(\\mathbf{x}, \\omega) \\exp(-\\mathrm{i}\\omega t)$ and $\\mathbf{f}(\\mathbf{x}, t) = \\mathbf{f}(\\mathbf{x}, \\omega) \\exp(-\\mathrm{i}\\omega t)$. The time derivative term becomes $\\frac{\\partial^2 \\mathbf{u}}{\\partial t^2} = (-\\mathrm{i}\\omega)^2 \\mathbf{u} = -\\omega^2 \\mathbf{u}$. Substituting this into the equation of motion yields the time-independent Navier equation, or Helmholtz equation for the displacement vector:\n$$ (\\lambda + 2\\mu) \\nabla(\\nabla \\cdot \\mathbf{u}) - \\mu \\nabla \\times (\\nabla \\times \\mathbf{u}) + \\mathbf{f} + \\rho \\omega^2 \\mathbf{u} = \\mathbf{0} $$\n\nWe employ the Helmholtz decomposition, expressing the displacement field $\\mathbf{u}$ in terms of a scalar potential $\\phi$ (compressional component) and a vector potential $\\boldsymbol{\\psi}$ (shear component):\n$$ \\mathbf{u} = \\nabla\\phi + \\nabla \\times \\boldsymbol{\\psi} $$\nSubstituting this decomposition into the frequency-domain Navier equation, and using the vector identity $\\nabla \\times (\\nabla \\times \\mathbf{A}) = \\nabla(\\nabla \\cdot \\mathbf{A}) - \\nabla^2 \\mathbf{A}$, we can separate the equation into two parts. After some vector calculus manipulations, we arrive at:\n$$ \\nabla \\left[ (\\lambda + 2\\mu)(\\nabla^2 \\phi) + \\rho \\omega^2 \\phi \\right] + \\nabla \\times \\left[ \\mu(\\nabla^2 \\boldsymbol{\\psi}) + \\rho \\omega^2 \\boldsymbol{\\psi} \\right] + \\mathbf{f} = \\mathbf{0} $$\nIntroducing the compressional-wave speed $c_p = \\sqrt{(\\lambda + 2\\mu)/\\rho}$ and shear-wave speed $c_s = \\sqrt{\\mu/\\rho}$, and their respective wavenumbers $k_p = \\omega/c_p$ and $k_s = \\omega/c_s$, we get:\n$$ \\rho c_p^2 \\nabla(\\nabla^2 \\phi + k_p^2 \\phi) + \\rho c_s^2 \\nabla \\times (\\nabla^2 \\boldsymbol{\\psi} + k_s^2 \\boldsymbol{\\psi}) + \\mathbf{f} = \\mathbf{0} $$\nThe source is an isotropic volumetric expansion at the origin. Such a source acts as a center of compression and can be represented by a body force that is the gradient of a Dirac delta function:\n$$ \\mathbf{f}(\\mathbf{x}, \\omega) = -S(\\omega) \\nabla \\delta(\\mathbf{x}) $$\nwhere $S(\\omega)$ is the source strength spectrum. The negative sign is conventional for an explosive (expansive) source. Substituting this force into the equation gives:\n$$ \\nabla \\left[ \\rho c_p^2 (\\nabla^2 \\phi + k_p^2 \\phi) - S(\\omega)\\delta(\\mathbf{x}) \\right] + \\nabla \\times \\left[ \\rho c_s^2 (\\nabla^2 \\boldsymbol{\\psi} + k_s^2 \\boldsymbol{\\psi}) \\right] = \\mathbf{0} $$\nThis equation is satisfied if the two bracketed terms vanish independently. This yields a pair of uncoupled Helmholtz equations:\n$$ \\nabla^2 \\phi + k_p^2 \\phi = \\frac{S(\\omega)}{\\rho c_p^2} \\delta(\\mathbf{x}) $$\n$$ \\nabla^2 \\boldsymbol{\\psi} + k_s^2 \\boldsymbol{\\psi} = \\mathbf{0} $$\nSince the source term for the vector potential $\\boldsymbol{\\psi}$ is zero, and the problem states no S-waves are excited, we have $\\boldsymbol{\\psi} = \\mathbf{0}$. The displacement is purely compressional.\n\nWe solve the inhomogeneous Helmholtz equation for $\\phi$. The solution for an outgoing wave in three dimensions is given by the scaled Green's function of the Helmholtz operator:\n$$ \\phi(r, \\omega) = - \\frac{S(\\omega)}{4\\pi \\rho c_p^2} \\frac{\\exp(\\mathrm{i} k_p r)}{r} $$\nwhere $r = |\\mathbf{x}|$ is the distance from the origin. For notational simplicity, we define a new source constant $C(\\omega) = -S(\\omega)/(4\\pi\\rho c_p^2)$, so that:\n$$ \\phi(r, \\omega) = C(\\omega) \\frac{\\exp(\\mathrm{i} k_p r)}{r} $$\nThe displacement field is found by taking the gradient of the scalar potential: $\\mathbf{u} = \\nabla\\phi$. Due to the spherical symmetry of $\\phi(r)$, the displacement vector is purely radial, $\\mathbf{u} = u_r(r, \\omega) \\hat{\\mathbf{r}}$, where $\\hat{\\mathbf{r}}$ is the radial unit vector. The radial displacement component $u_r$ is:\n$$ u_r(r, \\omega) = \\frac{\\partial \\phi}{\\partial r} = \\frac{\\partial}{\\partial r} \\left( C(\\omega) \\frac{\\exp(\\mathrm{i} k_p r)}{r} \\right) $$\nUsing the product rule for differentiation:\n$$ u_r(r, \\omega) = C(\\omega) \\left[ \\frac{1}{r} \\frac{d}{dr}(\\exp(\\mathrm{i} k_p r)) + \\exp(\\mathrm{i} k_p r) \\frac{d}{dr}\\left(\\frac{1}{r}\\right) \\right] $$\n$$ u_r(r, \\omega) = C(\\omega) \\left[ \\frac{\\mathrm{i} k_p \\exp(\\mathrm{i} k_p r)}{r} - \\frac{\\exp(\\mathrm{i} k_p r)}{r^2} \\right] $$\nFactoring out the common term gives the full expression for the radial displacement:\n$$ u_r(r, \\omega) = C(\\omega) \\frac{\\exp(\\mathrm{i} k_p r)}{r^2} (\\mathrm{i} k_p r - 1) $$\nThis expression contains two terms with different radial decay rates. We can identify the far-field and near-field contributions based on their asymptotic behavior as $r \\to \\infty$.\nThe term proportional to $1/r$ is the far-field term, as it dominates at large distances:\n$$ u_r^{\\text{far}}(r, \\omega) = C(\\omega) \\frac{\\mathrm{i} k_p}{r} \\exp(\\mathrm{i} k_p r) $$\nThe term proportional to $1/r^2$ is the near-field term, as it decays more rapidly and is only significant close to the source:\n$$ u_r^{\\text{near}}(r, \\omega) = -C(\\omega) \\frac{1}{r^2} \\exp(\\mathrm{i} k_p r) $$\nThe relative importance is governed by the dimensionless parameter $k_p r$. The far-field approximation is valid when $k_p r \\gg 1$.\n\nThe problem asks for the magnitude ratio of the near-field to far-field contributions. The magnitudes are:\n$$ |u_r^{\\text{near}}(r, \\omega)| = \\left|-C(\\omega) \\frac{1}{r^2} \\exp(\\mathrm{i} k_p r)\\right| = |C(\\omega)| \\frac{1}{r^2} $$\n$$ |u_r^{\\text{far}}(r, \\omega)| = \\left|C(\\omega) \\frac{\\mathrm{i} k_p}{r} \\exp(\\mathrm{i} k_p r)\\right| = |C(\\omega)| \\frac{k_p}{r} $$\nThe ratio of these magnitudes is:\n$$ R = \\frac{|u_r^{\\text{near}}(r, \\omega)|}{|u_r^{\\text{far}}(r, \\omega)|} = \\frac{|C(\\omega)|/r^2}{|C(\\omega)|k_p/r} = \\frac{1}{k_p r} $$\nThis elegantly demonstrates that the ratio is inversely proportional to the dimensionless quantity $k_p r$.\n\nWe now evaluate this ratio for the given parameters:\n- Frequency $f = 5\\,\\text{Hz}$\n- P-wave speed $c_p = 4.0 \\times 10^3\\,\\text{m/s}$\n- Distance $r = 1.0 \\times 10^2\\,\\text{m}$\n\nFirst, we calculate the angular frequency $\\omega$:\n$$ \\omega = 2\\pi f = 2\\pi(5\\,\\text{s}^{-1}) = 10\\pi\\,\\text{rad s}^{-1} $$\nNext, we calculate the compressional wavenumber $k_p$:\n$$ k_p = \\frac{\\omega}{c_p} = \\frac{10\\pi\\,\\text{rad s}^{-1}}{4.0 \\times 10^3\\,\\text{m s}^{-1}} = \\frac{\\pi}{400}\\,\\text{m}^{-1} $$\nThen, we compute the dimensionless parameter $k_p r$:\n$$ k_p r = \\left(\\frac{\\pi}{400}\\,\\text{m}^{-1}\\right) (1.0 \\times 10^2\\,\\text{m}) = \\frac{100\\pi}{400} = \\frac{\\pi}{4} $$\nFinally, the magnitude ratio is:\n$$ R = \\frac{1}{k_p r} = \\frac{1}{\\pi/4} = \\frac{4}{\\pi} $$\nNumerically, this value is:\n$$ R = \\frac{4}{\\pi} \\approx 1.2732395... $$\nRounding to four significant figures, we get $1.273$. This result indicates that for the specified scenario, the near-field term's magnitude is actually larger than the far-field term's magnitude, underscoring the importance of including near-field terms for synthetic seismograms at short offsets and low frequencies.", "answer": "$$\\boxed{1.273}$$", "id": "3615929"}, {"introduction": "The final component of a realistic simulation is the Earth model, defined by properties such as velocity and density. Since density logs are not always available, it is common practice to estimate density from P-wave velocity using empirical formulas; this practice explores the consequences of that shortcut [@problem_id:3615963]. By calculating the amplitude bias in reflection coefficients introduced by Gardner's relation, you will gain a critical perspective on how choices in rock physics modeling directly influence the amplitudes in a synthetic seismogram and its subsequent interpretation.", "problem": "You are given a set of layer pairs representing planar, horizontal interfaces in a one-dimensional acoustic Earth. Each layer is homogeneous, isotropic, and lossless. A plane compressional wave of normal incidence propagates downward and interacts with each interface. You are to assess, for each interface, how the use of an empirical density-velocity power-law to estimate density from compressional-wave speed introduces a bias in the normal-incidence reflection coefficient relative to using the measured density.\n\nStart from the following fundamental base:\n- Continuity of acoustic pressure and particle velocity across a planar interface for a plane wave at normal incidence in a one-dimensional, linear, lossless acoustic medium.\n- Definition of acoustic impedance as $Z$ equal to the product of bulk density and compressional-wave speed.\n- The existence of a widely used empirical power-law linking bulk density to compressional-wave speed, originally established from laboratory and well-log data, parameterized by two positive constants.\n\nTasks to perform and quantities to compute:\n1. Derive the normal-incidence reflection coefficient at an interface between two acoustic half-spaces in terms of the acoustic impedances of the upper and lower media, using only the fundamental base described above.\n2. Using the empirical power-law relating bulk density and compressional-wave speed with constants $a_g$ and $b_g$, convert it to be consistent with the specified units in this problem. The canonical constants to use are $a_g=0.31$ and $b_g=0.25$, which map compressional-wave speed in meters per second to bulk density in grams per cubic centimeter. Convert this relation to output density in kilograms per cubic meter. Your program must consistently use compressional-wave speed in meters per second and density in kilograms per cubic meter.\n3. For each test interface below, compute:\n   - The true reflection coefficient $R_{\\text{true}}$ using the measured densities in the two layers.\n   - The Gardner-estimated reflection coefficient $R_{\\text{est}}$ by replacing the measured densities with the densities estimated from the compressional-wave speeds using the unit-consistent empirical power-law you established in step $2$.\n   - The signed amplitude bias $\\Delta R = R_{\\text{est}} - R_{\\text{true}}$. This quantity is dimensionless and must be reported as a decimal number.\n\nNumerical and unit requirements:\n- Use compressional-wave speed $V_P$ in meters per second.\n- Use density $\\rho$ in kilograms per cubic meter.\n- The reflection coefficient and the amplitude bias are dimensionless.\n- Round each reported amplitude bias to six decimal places.\n\nTest suite:\nCompute the signed amplitude bias $\\Delta R$ for the following five interfaces, each specified by the quadruple $(V_{P1},\\rho_1,V_{P2},\\rho_2)$, where the subscript $1$ denotes the upper layer and the subscript $2$ denotes the lower layer. The units are meters per second for $V_P$ and kilograms per cubic meter for $\\rho$.\n\n- Case $1$: $(V_{P1},\\rho_1,V_{P2},\\rho_2) = (2200, 2150, 2600, 2350)$\n- Case $2$: $(V_{P1},\\rho_1,V_{P2},\\rho_2) = (2500, 2200, 6000, 2700)$\n- Case $3$: $(V_{P1},\\rho_1,V_{P2},\\rho_2) = (1500, 1800, 1700, 1850)$\n- Case $4$ (constructed so that the true impedance contrast is zero): $(V_{P1},\\rho_1,V_{P2},\\rho_2) = (2000, 2000, 1600, 2500)$\n- Case $5$ (gas-charged sand example): $(V_{P1},\\rho_1,V_{P2},\\rho_2) = (2750, 2400, 2000, 1700)$\n\nFinal output format:\nYour program should produce a single line of output containing the signed amplitude biases for the five test cases as a comma-separated list enclosed in square brackets and rounded to six decimal places, for example, $[\\Delta R_1,\\Delta R_2,\\Delta R_3,\\Delta R_4,\\Delta R_5]$. There must be no spaces in the output string. Because each $\\Delta R$ is dimensionless, no unit should be printed.", "solution": "### Step 1: Derivation of the Normal-Incidence Reflection Coefficient\n\nThe normal-incidence reflection coefficient $R$ at a planar interface between two acoustic media can be derived from the boundary conditions of continuity for acoustic pressure and particle velocity.\n\nLet the interface be located at the plane $z=0$. The upper medium ($z<0$) is layer $1$ with properties ($\\rho_1$, $V_{P1}$), and the lower medium ($z>0$) is layer $2$ with properties ($\\rho_2$, $V_{P2}$). A harmonic plane compressional wave propagates downwards in the positive $z$ direction.\n\nThe acoustic pressure $P(z,t)$ and the normal component of particle velocity $u(z,t)$ for a plane wave can be expressed in terms of a displacement potential $\\phi(z,t)$:\n$$P(z,t) = -\\rho \\frac{\\partial \\phi}{\\partial t}$$\n$$u(z,t) = \\frac{\\partial \\phi}{\\partial z}$$\n\nFor a harmonic wave with angular frequency $\\omega$, the displacement potentials are:\n- In layer $1$: $\\phi_1(z,t) = \\left( A_I e^{-ik_1 z} + A_R e^{ik_1 z} \\right) e^{i\\omega t}$\n- In layer $2$: $\\phi_2(z,t) = A_T e^{-ik_2 z} e^{i\\omega t}$\n\nHere, $A_I$, $A_R$, and $A_T$ are the complex amplitudes of the incident, reflected, and transmitted waves, respectively. The wavenumber in each layer is $k_j = \\omega/V_{Pj}$ for $j=1,2$.\n\nThe pressure and particle velocity in each layer are:\n- Layer $1$:\n  - $P_1(z,t) = -i\\omega\\rho_1 \\left( A_I e^{-ik_1 z} + A_R e^{ik_1 z} \\right) e^{i\\omega t}$\n  - $u_1(z,t) = -ik_1 \\left( A_I e^{-ik_1 z} - A_R e^{ik_1 z} \\right) e^{i\\omega t}$\n- Layer $2$:\n  - $P_2(z,t) = -i\\omega\\rho_2 A_T e^{-ik_2 z} e^{i\\omega t}$\n  - $u_2(z,t) = -ik_2 A_T e^{-ik_2 z} e^{i\\omega t}$\n\nApplying the boundary conditions at $z=0$:\n1.  Continuity of pressure: $P_1(0,t) = P_2(0,t)$\n    $$\\rho_1 (A_I + A_R) = \\rho_2 A_T$$\n2.  Continuity of particle velocity: $u_1(0,t) = u_2(0,t)$\n    $$k_1 (A_I - A_R) = k_2 A_T$$\n\nWe can express $A_T$ from the first equation as $A_T = \\frac{\\rho_1}{\\rho_2} (A_I + A_R)$ and substitute it into the second equation:\n$$k_1 (A_I - A_R) = k_2 \\frac{\\rho_1}{\\rho_2} (A_I + A_R)$$\n\nSubstituting $k_j = \\omega/V_{Pj}$ and simplifying by canceling $\\omega$:\n$$\\frac{1}{V_{P1}} (A_I - A_R) = \\frac{\\rho_1}{V_{P2}\\rho_2} (A_I + A_R)$$\n\nRearranging terms to solve for the reflection coefficient $R = A_R/A_I$:\n$$V_{P2}\\rho_2 (A_I - A_R) = V_{P1}\\rho_1 (A_I + A_R)$$\n\nDefining the acoustic impedance as $Z_j = \\rho_j V_{Pj}$:\n$$Z_2 (A_I - A_R) = Z_1 (A_I + A_R)$$\n$$Z_2 A_I - Z_1 A_I = Z_1 A_R + Z_2 A_R$$\n$$A_I (Z_2 - Z_1) = A_R (Z_1 + Z_2)$$\n\nThis yields the expression for the normal-incidence reflection coefficient:\n$$R = \\frac{A_R}{A_I} = \\frac{Z_2 - Z_1}{Z_2 + Z_1}$$\n\n### Step 2: Unit Conversion of the Empirical Power-Law\n\nThe problem provides an empirical power-law (Gardner's relation) linking bulk density $\\rho$ to compressional-wave speed $V_P$:\n$$\\rho' = a_g (V_P)^{b_g}$$\nwhere $\\rho'$ is in grams per cubic centimeter ($\\text{g/cm}^3$), $V_P$ is in meters per second ($\\text{m/s}$), and the constants are $a_g=0.31$ and $b_g=0.25$.\n\nThe problem requires density $\\rho$ to be in kilograms per cubic meter ($\\text{kg/m}^3$). The conversion between these units is:\n$$1 \\, \\text{g/cm}^3 = \\frac{10^{-3} \\, \\text{kg}}{(10^{-2} \\, \\text{m})^3} = \\frac{10^{-3}}{10^{-6}} \\, \\text{kg/m}^3 = 1000 \\, \\text{kg/m}^3$$\nTherefore, to convert $\\rho'$ from $\\text{g/cm}^3$ to $\\rho$ in $\\text{kg/m}^3$, we multiply by $1000$:\n$$\\rho \\, (\\text{in kg/m}^3) = 1000 \\times \\rho' \\, (\\text{in g/cm}^3)$$\nApplying this to the empirical relation:\n$$\\rho_{\\text{est}} = 1000 \\times 0.31 \\times (V_P)^{0.25} = 310 (V_P)^{0.25}$$\nThis is the unit-consistent equation used for estimating density, $\\rho_{\\text{est}}$, in $\\text{kg/m}^3$ from $V_P$ in $\\text{m/s}$. We can define new constants for these units: $a=310$ and $b=0.25$.\n\n### Step 3: Calculation of Reflection Coefficient Bias\n\nFor each interface, specified by $(V_{P1}, \\rho_1, V_{P2}, \\rho_2)$, we compute two reflection coefficients.\n\n1.  **True Reflection Coefficient ($R_{\\text{true}}$)**:\n    This is calculated using the measured densities and velocities.\n    -   True acoustic impedances: $Z_1 = \\rho_1 V_{P1}$ and $Z_2 = \\rho_2 V_{P2}$.\n    -   True reflection coefficient: $R_{\\text{true}} = \\frac{Z_2 - Z_1}{Z_2 + Z_1}$.\n\n2.  **Gardner-estimated Reflection Coefficient ($R_{\\text{est}}$)**:\n    This is calculated by replacing the measured densities with densities estimated from the velocities using the converted power-law.\n    -   Estimated densities: $\\rho_{1,\\text{est}} = a (V_{P1})^b$ and $\\rho_{2,\\text{est}} = a (V_{P2})^b$, with $a=310$ and $b=0.25$.\n    -   Estimated acoustic impedances: $Z_{1,\\text{est}} = \\rho_{1,\\text{est}} V_{P1} = a (V_{P1})^{b} V_{P1} = a (V_{P1})^{1+b}$ and $Z_{2,\\text{est}} = a (V_{P2})^{1+b}$.\n    -   Estimated reflection coefficient:\n        $$R_{\\text{est}} = \\frac{Z_{2,\\text{est}} - Z_{1,\\text{est}}}{Z_{2,\\text{est}} + Z_{1,\\text{est}}} = \\frac{a (V_{P2})^{1+b} - a (V_{P1})^{1+b}}{a (V_{P2})^{1+b} + a (V_{P1})^{1+b}}$$\n        The constant $a$ cancels, simplifying the expression to:\n        $$R_{\\text{est}} = \\frac{(V_{P2})^{1.25} - (V_{P1})^{1.25}}{(V_{P2})^{1.25} + (V_{P1})^{1.25}}$$\n\n3.  **Signed Amplitude Bias ($\\Delta R$)**:\n    The bias is the difference between the estimated and true reflection coefficients.\n    $$\\Delta R = R_{\\text{est}} - R_{\\text{true}}$$\n    This dimensionless quantity is computed for each case and rounded to six decimal places.\n\nThis procedure is applied to the five test cases provided.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the signed amplitude bias in reflection coefficients\n    for five geological interfaces.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (V_P1, rho_1, V_P2, rho_2)\n    # Units: V_P in m/s, rho in kg/m^3\n    test_cases = [\n        # Case 1\n        (2200.0, 2150.0, 2600.0, 2350.0),\n        # Case 2\n        (2500.0, 2200.0, 6000.0, 2700.0),\n        # Case 3\n        (1500.0, 1800.0, 1700.0, 1850.0),\n        # Case 4 (zero true impedance contrast)\n        (2000.0, 2000.0, 1600.0, 2500.0),\n        # Case 5 (gas-charged sand example)\n        (2750.0, 2400.0, 2000.0, 1700.0),\n    ]\n\n    results = []\n    \n    # Power for Gardner's relation, b = 0.25\n    b = 0.25\n    power = 1.0 + b # This is 1.25\n\n    def calculate_bias(vp1, rho1, vp2, rho2):\n        \"\"\"\n        Calculates the signed amplitude bias for a single interface.\n\n        Args:\n            vp1 (float): P-wave velocity of the upper layer (m/s).\n            rho1 (float): Density of the upper layer (kg/m^3).\n            vp2 (float): P-wave velocity of the lower layer (m/s).\n            rho2 (float): Density of the lower layer (kg/m^3).\n\n        Returns:\n            float: The signed amplitude bias.\n        \"\"\"\n        # 1. Calculate the true reflection coefficient (R_true)\n        z1_true = rho1 * vp1\n        z2_true = rho2 * vp2\n        \n        # Handle the case where Z1 + Z2 is zero to avoid division by zero,\n        # although physically unlikely for positive Vp and rho.\n        if (z1_true + z2_true) == 0:\n            # If Z1 = -Z2, R is undefined. If Z1=Z2=0, also undefined.\n            # Assuming Z1=Z2=0 results in R_true=0 as there is no impedance.\n            # Physically, Z > 0.\n            r_true = 0.0\n        else:\n            r_true = (z2_true - z1_true) / (z2_true + z1_true)\n\n        # 2. Calculate the Gardner-estimated reflection coefficient (R_est)\n        # As derived, R_est = (V_P2^(1+b) - V_P1^(1+b)) / (V_P2^(1+b) + V_P1^(1+b))\n        vp1_pow = vp1 ** power\n        vp2_pow = vp2 ** power\n\n        if (vp1_pow + vp2_pow) == 0:\n            # Should not happen for positive Vp\n            r_est = 0.0\n        else:\n            r_est = (vp2_pow - vp1_pow) / (vp1_pow + vp2_pow)\n\n        # 3. Calculate the signed amplitude bias (Delta R)\n        delta_r = r_est - r_true\n        return delta_r\n\n    for case in test_cases:\n        vp1, rho1, vp2, rho2 = case\n        bias = calculate_bias(vp1, rho1, vp2, rho2)\n        # Format the result to exactly six decimal places for the output string.\n        results.append(f\"{bias:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "3615963"}]}