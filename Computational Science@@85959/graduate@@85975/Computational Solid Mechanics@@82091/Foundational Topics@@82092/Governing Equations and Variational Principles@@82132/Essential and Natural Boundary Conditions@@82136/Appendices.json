{"hands_on_practices": [{"introduction": "The first step in mastering boundary conditions is moving from abstract theory to tangible implementation. This exercise provides a direct, hands-on opportunity to contrast the two most common approaches for enforcing essential (Dirichlet) conditions in the Finite Element Method: the exact \"strong\" method and the approximate \"penalty\" method. By coding a solution for a simple one-dimensional bar [@problem_id:3563196], you will gain a concrete understanding of how each technique modifies the global system of equations and be able to quantify the convergence of the penalty method's solution towards the exact one.", "problem": "Consider a one-dimensional, linearly elastic bar of length $L$ with constant cross-sectional area $A$ and Young's modulus $E$. Let $x \\in [0,L]$ denote the axial coordinate. The unknown displacement field is $u(x)$ (in meters). The bar is subjected to a uniform body force density $b$ (in newtons per meter) and an end force $F$ (in newtons) applied at $x=L$. The axial strain is $\\varepsilon(x) = u'(x)$ and the axial stress is $\\sigma(x) = E \\varepsilon(x)$. The product $EA$ (in newtons) is the axial stiffness of the bar.\n\nWe study two ways to enforce an essential (Dirichlet) boundary condition at $x=0$ of the form $u(0) = \\bar{u}$, where $\\bar{u}$ is a prescribed displacement in meters:\n- Strong enforcement: the Dirichlet condition is imposed exactly on the discrete displacement at the first node.\n- Weak (penalty) enforcement: the Dirichlet condition is enforced by augmenting the discrete system with a penalty term of magnitude $\\gamma$ (in newtons per meter), which penalizes deviations of $u(0)$ from $\\bar{u}$.\n\nThe natural (Neumann) boundary condition at $x=L$ is the applied end force $F$ (in newtons). The body force density $b$ contributes to the distributed loading along the bar. The governing weak form is built upon the Principle of Virtual Work: the internal virtual work equals the external virtual work for all kinematically admissible virtual displacements.\n\nYour tasks:\n1. Using the Finite Element Method (FEM), discretize the bar into $n$ equal linear elements with nodes $x_i = i h$ for $i=0,\\dots,n$, where $h = L/n$ is the element length. Assemble the global stiffness matrix $K \\in \\mathbb{R}^{(n+1) \\times (n+1)}$ and load vector $f \\in \\mathbb{R}^{n+1}$ using the standard linear-element formulas:\n   - Element stiffness matrix for each element:\n   $$ k_e = \\dfrac{EA}{h} \\begin{bmatrix} 1 & -1 \\\\ -1 & 1 \\end{bmatrix} $$\n   - Consistent element load vector due to the uniform body force for each element:\n   $$ f_e = \\dfrac{b h}{2} \\begin{bmatrix} 1 \\\\ 1 \\end{bmatrix} $$\n   - End force $F$ is added to the last node: $f_{n} \\leftarrow f_{n} + F$.\n2. Strong enforcement of $u(0) = \\bar{u}$: eliminate the first degree of freedom in the linear system to solve for the remaining unknowns, then build the full displacement vector $u^{\\star}$ with $u^{\\star}_0 = \\bar{u}$. Define the reaction force at $x=0$ as the internal nodal force that equilibrates the external loads at the first node:\n   $$ r_{\\infty} := \\left( K u^{\\star} - f \\right)_0 \\quad \\text{in newtons.} $$\n3. Penalty enforcement of $u(0) = \\bar{u}$: form the penalized system\n   $$ (K + \\gamma e_0 e_0^{\\top}) u_{\\gamma} = f + \\gamma \\bar{u} \\, e_0, $$\n   where $e_0 \\in \\mathbb{R}^{n+1}$ is the unit vector with a $1$ in the first entry and zeros elsewhere, and $\\gamma > 0$ is the penalty parameter. Solve for $u_{\\gamma}$, and define the penalty reaction as\n   $$ r_{\\gamma} := \\gamma \\left( \\bar{u} - u_{\\gamma,0} \\right) \\quad \\text{in newtons,} $$\n   where $u_{\\gamma,0}$ is the first component of $u_{\\gamma}$. Also define the Dirichlet violation magnitude\n   $$ v_{\\gamma} := \\left| u_{\\gamma,0} - \\bar{u} \\right| \\quad \\text{in meters.} $$\n4. Demonstrate the consistency of the reaction computation by comparing $r_{\\gamma}$ with $r_{\\infty}$. Specifically, for each test case, compute the absolute reaction error\n   $$ e_{\\gamma} := \\left| r_{\\gamma} - r_{\\infty} \\right| \\quad \\text{in newtons} $$\n   and the Dirichlet violation $v_{\\gamma}$ (in meters).\n\nThe program must implement the above for the following test suite of parameter sets. Each test case is a tuple $(L, E, A, n, F, b, \\bar{u}, \\gamma)$, with units as specified:\n- Test 1 (happy path, small penalty): $(1.0 \\text{ m}, 210\\times 10^{9} \\text{ Pa}, 1.0\\times 10^{-4} \\text{ m}^2, 20, 1000 \\text{ N}, 0 \\text{ N/m}, 0 \\text{ m}, 1.0\\times 10^{3} \\text{ N/m})$.\n- Test 2 (happy path, moderate penalty): $(1.0 \\text{ m}, 210\\times 10^{9} \\text{ Pa}, 1.0\\times 10^{-4} \\text{ m}^2, 20, 1000 \\text{ N}, 0 \\text{ N/m}, 0 \\text{ m}, 1.0\\times 10^{6} \\text{ N/m})$.\n- Test 3 (limit behavior, very large penalty): $(1.0 \\text{ m}, 210\\times 10^{9} \\text{ Pa}, 1.0\\times 10^{-4} \\text{ m}^2, 20, 1000 \\text{ N}, 0 \\text{ N/m}, 0 \\text{ m}, 1.0\\times 10^{12} \\text{ N/m})$.\n- Test 4 (with body force): $(1.0 \\text{ m}, 70\\times 10^{9} \\text{ Pa}, 5.0\\times 10^{-5} \\text{ m}^2, 30, 500 \\text{ N}, 200 \\text{ N/m}, 0 \\text{ m}, 1.0\\times 10^{6} \\text{ N/m})$.\n- Test 5 (soft bar): $(1.0 \\text{ m}, 1.0\\times 10^{6} \\text{ Pa}, 1.0\\times 10^{-6} \\text{ m}^2, 10, 1.0 \\text{ N}, 1.0 \\text{ N/m}, 0 \\text{ m}, 1.0\\times 10^{6} \\text{ N/m})$.\n\nExpress all reaction forces in newtons and all displacements in meters. Angles are not involved. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. For each test case, append four numbers in order: $r_{\\infty}$, $r_{\\gamma}$, $e_{\\gamma}$, $v_{\\gamma}$. Thus, the final output is a flat list of $20$ numbers corresponding to the $5$ test cases.", "solution": "The problem statement is evaluated as scientifically grounded, well-posed, and objective. It presents a standard application of the Finite Element Method (FEM) to a one-dimensional linear elasticity problem, a fundamental topic in computational solid mechanics. The provided physical parameters, governing equations, element formulations, and definitions for boundary condition enforcement (strong and penalty methods) are all consistent with established theory. The problem is self-contained, with all necessary data provided for each test case. Therefore, a complete and reasoned solution can be constructed.\n\nThe solution proceeds in four stages:\n1.  Discretization of the continuous problem and assembly of the global system of linear equations.\n2.  Imposition of the essential boundary condition using the strong (elimination) method and computation of the reaction force.\n3.  Imposition of the essential boundary condition using the weak (penalty) method and computation of the approximate reaction force and boundary displacement violation.\n4.  Comparison of the reaction forces obtained from both methods.\n\n**1. Finite Element Discretization and Assembly**\n\nThe one-dimensional domain of length $L$, $x \\in [0, L]$, is discretized into $n$ linear finite elements of equal length $h = L/n$. This creates $n+1$ nodes, located at positions $x_i = i h$ for $i=0, 1, \\dots, n$. The displacement field $u(x)$ is approximated as a piecewise linear function over these elements. The unknown nodal displacements are collected in a vector $u \\in \\mathbb{R}^{n+1}$.\n\nThe principle of virtual work leads to a system of linear equations, $K u = f$, where $K$ is the global stiffness matrix and $f$ is the global load vector. These are assembled from element-level contributions.\n\nFor each element $e$ (connecting local nodes $0$ and $1$, corresponding to global nodes $i$ and $i+1$), the element stiffness matrix $k_e$ is given by:\n$$\nk_e = \\frac{EA}{h} \\begin{bmatrix} 1 & -1 \\\\ -1 & 1 \\end{bmatrix}\n$$\nwhere $E$ is Young's modulus, $A$ is the cross-sectional area, and $h$ is the element length.\n\nThe consistent element load vector $f_e$ due to a uniform body force $b$ is:\n$$\nf_e = \\frac{b h}{2} \\begin{bmatrix} 1 \\\\ 1 \\end{bmatrix}\n$$\n\nThe global stiffness matrix $K \\in \\mathbb{R}^{(n+1) \\times (n+1)}$ and load vector $f \\in \\mathbb{R}^{n+1}$ are initialized as zero matrices. Then, for each element $e$ spanning global nodes $i$ and $i+1$ (for $i=0, \\dots, n-1$), the entries of $k_e$ and $f_e$ are added to the corresponding locations in $K$ and $f$. This is the standard \"assembly\" process. For instance, $K_{i,i}$ receives contributions from elements $i-1$ and $i$.\n\nFinally, the external point load $F$ at $x=L$ (node $n$) is added to the last component of the global load vector: $f_n \\leftarrow f_n + F$.\n\n**2. Strong Enforcement of the Essential Boundary Condition**\n\nThe essential (Dirichlet) boundary condition is $u(0) = \\bar{u}$. In the discrete system, this corresponds to setting the displacement of the first node to the prescribed value: $u_0 = \\bar{u}$. This is \"strong\" enforcement because the condition is satisfied exactly.\n\nThe global system $K u = f$ can be partitioned based on known and unknown degrees of freedom (DOFs). Here, $u_0$ is known, and the remaining displacements $u_R = [u_1, u_2, \\dots, u_n]^\\top$ are unknown.\n$$\n\\begin{bmatrix}\nK_{00} & K_{0R} \\\\\nK_{R0} & K_{RR}\n\\end{bmatrix}\n\\begin{Bmatrix}\nu_0 \\\\\nu_R\n\\end{Bmatrix}\n=\n\\begin{Bmatrix}\nf_0 \\\\\nf_R\n\\end{Bmatrix}\n$$\nFrom the second row of this block system, we can solve for the unknown displacements $u_R$:\n$$\nK_{R0} u_0 + K_{RR} u_R = f_R \\implies K_{RR} u_R = f_R - K_{R0} u_0\n$$\nSince $u_0 = \\bar{u}$ is known, we solve the reduced system of size $n \\times n$ for $u_R$. Let this solution be $u_R^{\\star}$. The full displacement vector, denoted $u^{\\star}$, is then constructed by combining the prescribed and computed values: $u^{\\star} = [\\bar{u}, (u_R^{\\star})^\\top]^\\top$.\n\nThe reaction force at the constrained node ($x=0$) is the force required to maintain the prescribed displacement. It is computed from the first row of the original system *after* solving for all displacements:\n$$\nr_{\\infty} := (K u^{\\star} - f)_0 = K_{00} u^{\\star}_0 + K_{0R} u^{\\star}_R - f_0\n$$\nThe subscript $\\infty$ conceptually denotes that this is the exact reaction, corresponding to an infinite penalty parameter.\n\n**3. Penalty Enforcement of the Essential Boundary Condition**\n\nThe penalty method enforces the boundary condition $u_0 = \\bar{u}$ in an approximate, \"weak\" sense. The idea is to add a large \"spring\" with stiffness $\\gamma$ to the system at node $0$, which pulls the node towards the position $\\bar{u}$. This is mathematically achieved by augmenting the potential energy functional with a penalty term $\\frac{1}{2}\\gamma(u_0 - \\bar{u})^2$.\n\nThis modification leads to a modified linear system:\n$$\nK_{\\gamma} u_{\\gamma} = f_{\\gamma}\n$$\nwhere $K_{\\gamma}$ and $f_{\\gamma}$ are the penalized stiffness matrix and load vector, respectively. They are formed by modifying the original system at the DOF corresponding to the boundary condition (index $0$):\n$$\nK_{\\gamma} = K + \\gamma e_0 e_0^{\\top} \\quad \\text{(i.e., } K_{\\gamma,00} = K_{00} + \\gamma \\text{)}\n$$\n$$\nf_{\\gamma} = f + \\gamma \\bar{u} \\, e_0 \\quad \\text{(i.e., } f_{\\gamma,0} = f_0 + \\gamma \\bar{u} \\text{)}\n$$\nHere, $e_0$ is the standard basis vector with a $1$ at index $0$ and zeros elsewhere. This modified $(n+1) \\times (n+1)$ system is non-singular (if the original reduced system was) and can be solved directly for the full displacement vector $u_{\\gamma}$.\n\nThe first equation of the penalized system is $(K_{00} + \\gamma) u_{\\gamma,0} + \\sum_{j=1}^{n} K_{0j} u_{\\gamma,j} = f_0 + \\gamma \\bar{u}$. Rearranging gives $\\gamma (\\bar{u} - u_{\\gamma,0}) = \\sum_{j=0}^{n} K_{0j} u_{\\gamma,j} - f_0$, where the right-hand side represents the internal nodal force. This motivates the definition of the penalty reaction force:\n$$\nr_{\\gamma} := \\gamma \\left( \\bar{u} - u_{\\gamma,0} \\right)\n$$\nUnlike strong enforcement, the computed displacement $u_{\\gamma,0}$ will not be exactly equal to $\\bar{u}$. The magnitude of this discrepancy is the Dirichlet violation:\n$$\nv_{\\gamma} := \\left| u_{\\gamma,0} - \\bar{u} \\right|\n$$\nAs the penalty parameter $\\gamma \\to \\infty$, it can be shown that $u_{\\gamma} \\to u^{\\star}$ and $r_{\\gamma} \\to r_{\\infty}$.\n\n**4. Error Analysis**\n\nTo demonstrate the convergence of the penalty method to the strong solution, we compute the absolute error between the reaction forces:\n$$\ne_{\\gamma} := \\left| r_{\\gamma} - r_{\\infty} \\right|\n$$\nThe provided test cases explore how the choice of the penalty parameter $\\gamma$ affects the accuracy of the computed reaction force (measured by $e_{\\gamma}$) and the satisfaction of the essential boundary condition (measured by $v_{\\gamma}$). A larger $\\gamma$ generally leads to smaller values for both $v_{\\gamma}$ and $e_{\\gamma}$, but can lead to numerical ill-conditioning if it is excessively large compared to the diagonal entries of $K$.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves a 1D linear elastic bar problem using FEM with both strong and penalty\n    enforcement of Dirichlet boundary conditions and compares the results.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (L, E, A, n, F, b, u_bar, gamma)\n    test_cases = [\n        # (L, E, A, n, F, b, u_bar, gamma)\n        (1.0, 210e9, 1.0e-4, 20, 1000.0, 0.0, 0.0, 1.0e3),\n        (1.0, 210e9, 1.0e-4, 20, 1000.0, 0.0, 0.0, 1.0e6),\n        (1.0, 210e9, 1.0e-4, 20, 1000.0, 0.0, 0.0, 1.0e12),\n        (1.0, 70e9, 5.0e-5, 30, 500.0, 200.0, 0.0, 1.0e6),\n        (1.0, 1.0e6, 1.0e-6, 10, 1.0, 1.0, 0.0, 1.0e6),\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        L, E, A, n, F, b, u_bar, gamma = case\n\n        # 1. Discretization and Assembly\n        h = L / n\n        n_nodes = n + 1\n        \n        # Initialize global stiffness matrix and load vector\n        K_global = np.zeros((n_nodes, n_nodes))\n        f_global = np.zeros(n_nodes)\n        \n        # Element properties\n        axial_stiffness = E * A\n        k_elem_val = axial_stiffness / h\n        k_elem = k_elem_val * np.array([[1, -1], [-1, 1]])\n        \n        f_elem_val = b * h / 2\n        f_elem = f_elem_val * np.array([1, 1])\n\n        # Assembly loop\n        for i in range(n):\n            # Global node indices for element i\n            nodes = [i, i + 1]\n            # Add element contributions to global system\n            K_global[np.ix_(nodes, nodes)] += k_elem\n            f_global[nodes] += f_elem\n            \n        # Apply natural boundary condition (point force F at x=L)\n        f_global[n] += F\n\n        # 2. Strong Enforcement\n        # Partition the system: K u = f\n        K_RR = K_global[1:, 1:]\n        f_R = f_global[1:]\n        K_R0 = K_global[1:, 0]\n\n        # Solve for unknown displacements: K_RR * u_R = f_R - K_R0 * u_bar\n        rhs_strong = f_R - K_R0 * u_bar\n        u_R_star = np.linalg.solve(K_RR, rhs_strong)\n        \n        # Reconstruct the full displacement vector\n        u_star = np.concatenate(([u_bar], u_R_star))\n\n        # Calculate reaction force r_inf = (K*u_star - f)[0]\n        r_inf = (K_global @ u_star - f_global)[0]\n\n        # 3. Penalty Enforcement\n        # Form the penalized system\n        K_penalty = K_global.copy()\n        K_penalty[0, 0] += gamma\n        \n        f_penalty = f_global.copy()\n        f_penalty[0] += gamma * u_bar\n        \n        # Solve for displacements u_gamma\n        u_gamma = np.linalg.solve(K_penalty, f_penalty)\n        u_gamma_0 = u_gamma[0]\n\n        # Calculate penalty reaction r_gamma\n        r_gamma = gamma * (u_bar - u_gamma_0)\n        \n        # Calculate Dirichlet violation v_gamma\n        v_gamma = np.abs(u_gamma_0 - u_bar)\n\n        # 4. Comparison\n        # Calculate absolute reaction error e_gamma\n        e_gamma = np.abs(r_gamma - r_inf)\n        \n        # Append results for this test case\n        results.extend([r_inf, r_gamma, e_gamma, v_gamma])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{x:.8e}' for x in results)}]\")\n\nsolve()\n```", "id": "3563196"}, {"introduction": "While the previous practice demonstrates that the penalty method's accuracy improves with a larger penalty parameter $\\gamma$, this benefit is not without cost. This analytical exercise [@problem_id:3563169] delves into the numerical consequences, guiding you to derive how the stiffness matrix's condition number scales with $\\gamma$. Understanding this relationship is critical, as it reveals the fundamental trade-off between accurately enforcing a constraint and maintaining a well-conditioned numerical system that can be solved reliably.", "problem": "Consider a one-dimensional, prismatic, linearly elastic bar of length $h$, Young’s modulus $E$, and unit cross-sectional area, occupying the interval $x \\in [0,h]$. The displacement $u(x)$ is governed by equilibrium derived from the Principle of Virtual Work, with the symmetric bilinear form\n$$\na(u,v) \\;=\\; \\int_{0}^{h} E \\, u'(x)\\, v'(x)\\, dx \\;+\\; \\alpha\\, u(0)\\, v(0),\n$$\nand the linear functional of external work set to zero. The term with $\\alpha > 0$ penalizes violation of the essential boundary condition $u(0)=0$ by modeling a very stiff spring attached at $x=0$, while the right end $x=h$ is stress-free, which is a natural boundary condition.\n\nDiscretize the bar using the standard two-node linear finite element with nodal displacements $u_1 \\approx u(0)$ and $u_2 \\approx u(h)$. Using the definition of the bilinear form, assemble the discrete $2 \\times 2$ stiffness matrix corresponding to the quadratic form $a(\\cdot,\\cdot)$, and observe how the penalty stiffness $\\alpha$ enters the algebraic system. Denote the resulting matrix by $K(\\alpha,E,h)$, and define its condition number in the Euclidean norm (the spectral condition number) as\n$$\n\\kappa_2\\big(K(\\alpha,E,h)\\big) \\;=\\; \\frac{\\lambda_{\\max}\\big(K(\\alpha,E,h)\\big)}{\\lambda_{\\min}\\big(K(\\alpha,E,h)\\big)},\n$$\nwhere $\\lambda_{\\max}$ and $\\lambda_{\\min}$ are the largest and smallest eigenvalues, respectively. Starting from first principles and without assuming any pre-existing formulas for eigenvalues or condition numbers, derive an exact analytic expression for the two eigenvalues of $K(\\alpha,E,h)$, and then obtain the leading-order asymptotic expression as $\\alpha \\to \\infty$ with $E$ and $h$ held fixed.\n\nYour final answer must be the leading-order asymptotic expression for the condition number growth as a closed-form function of $\\alpha$, $E$, and $h$. Do not include any units in your final answer. The condition number is dimensionless.", "solution": "The problem statement has been validated and is determined to be valid. It is scientifically grounded, well-posed, objective, and contains no contradictions or ambiguities. We may proceed with the solution.\n\nThe problem asks for the derivation of the leading-order asymptotic expression for the condition number of a stiffness matrix for a one-dimensional bar element, where an essential boundary condition is enforced using a penalty method.\n\nFirst, we discretize the displacement field $u(x)$ over the domain $x \\in [0, h]$ using a two-node linear finite element. The nodes are located at $x=0$ and $x=h$. The nodal displacements are denoted by $u_1$ and $u_2$, respectively. The interpolated displacement field is given by\n$$u(x) = N_1(x) u_1 + N_2(x) u_2,$$\nwhere $N_1(x)$ and $N_2(x)$ are the linear shape functions. For an element of length $h$ defined on $[0, h]$, these are:\n$$N_1(x) = 1 - \\frac{x}{h}$$\n$$N_2(x) = \\frac{x}{h}$$\nThe derivatives of the shape functions with respect to $x$ are constants:\n$$N_1'(x) = -\\frac{1}{h}$$\n$$N_2'(x) = \\frac{1}{h}$$\n\nThe stiffness matrix $K$ is a $2 \\times 2$ matrix whose components $K_{ij}$ are defined by the given symmetric bilinear form $a(\\cdot,\\cdot)$ applied to the basis functions: $K_{ij} = a(N_j, N_i)$.\nThe bilinear form is\n$$a(u,v) = \\int_{0}^{h} E \\, u'(x)\\, v'(x)\\, dx \\;+\\; \\alpha\\, u(0)\\, v(0).$$\nWe compute the four components of the stiffness matrix $K(\\alpha, E, h)$.\n\nFor $K_{11}$:\n$$K_{11} = a(N_1, N_1) = \\int_{0}^{h} E \\, (N_1'(x))^2 \\, dx + \\alpha \\, N_1(0) \\, N_1(0).$$\nAt $x=0$, we have $N_1(0)=1$ and $N_2(0)=0$.\n$$K_{11} = \\int_{0}^{h} E \\left(-\\frac{1}{h}\\right)^2 dx + \\alpha (1)(1) = \\frac{E}{h^2} \\int_{0}^{h} dx + \\alpha = \\frac{E}{h^2} [x]_0^h + \\alpha = \\frac{E}{h} + \\alpha.$$\n\nFor $K_{12}$:\n$$K_{12} = a(N_2, N_1) = \\int_{0}^{h} E \\, N_2'(x) \\, N_1'(x) \\, dx + \\alpha \\, N_2(0) \\, N_1(0).$$\n$$K_{12} = \\int_{0}^{h} E \\left(\\frac{1}{h}\\right) \\left(-\\frac{1}{h}\\right) dx + \\alpha (0)(1) = -\\frac{E}{h^2} \\int_{0}^{h} dx = -\\frac{E}{h}.$$\n\nFor $K_{21}$:\nSince the bilinear form is symmetric, $K_{21} = a(N_1, N_2) = K_{12} = -E/h$.\n\nFor $K_{22}$:\n$$K_{22} = a(N_2, N_2) = \\int_{0}^{h} E \\, (N_2'(x))^2 \\, dx + \\alpha \\, N_2(0) \\, N_2(0).$$\n$$K_{22} = \\int_{0}^{h} E \\left(\\frac{1}{h}\\right)^2 dx + \\alpha (0)(0) = \\frac{E}{h^2} \\int_{0}^{h} dx = \\frac{E}{h}.$$\n\nAssembling these components, the stiffness matrix is:\n$$K(\\alpha, E, h) = \\begin{pmatrix} \\frac{E}{h} + \\alpha & -\\frac{E}{h} \\\\ -\\frac{E}{h} & \\frac{E}{h} \\end{pmatrix}.$$\nThe natural boundary condition of a stress-free end at $x=h$ is satisfied implicitly by setting the corresponding component of the force vector to zero, which is consistent with the problem statement that the linear functional of external work is zero.\n\nNext, we find the eigenvalues $\\lambda$ of $K$. The eigenvalues are the roots of the characteristic equation $\\det(K - \\lambda I) = 0$, where $I$ is the identity matrix.\n$$\\det \\begin{pmatrix} \\frac{E}{h} + \\alpha - \\lambda & -\\frac{E}{h} \\\\ -\\frac{E}{h} & \\frac{E}{h} - \\lambda \\end{pmatrix} = 0.$$\nExpanding the determinant gives the characteristic polynomial:\n$$\\left(\\frac{E}{h} + \\alpha - \\lambda\\right)\\left(\\frac{E}{h} - \\lambda\\right) - \\left(-\\frac{E}{h}\\right)^2 = 0$$\n$$\\left(\\frac{E}{h}\\right)^2 - \\frac{E}{h}\\lambda + \\alpha\\frac{E}{h} - \\alpha\\lambda - \\frac{E}{h}\\lambda + \\lambda^2 - \\left(\\frac{E}{h}\\right)^2 = 0$$\n$$\\lambda^2 - \\left(2\\frac{E}{h} + \\alpha\\right)\\lambda + \\alpha\\frac{E}{h} = 0.$$\nThis is a quadratic equation for $\\lambda$. We solve for $\\lambda$ using the quadratic formula:\n$$\\lambda = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a},$$\nwith $a=1$, $b = -(2E/h + \\alpha)$, and $c = \\alpha E/h$.\n$$\\lambda = \\frac{ (2\\frac{E}{h} + \\alpha) \\pm \\sqrt{\\left(2\\frac{E}{h} + \\alpha\\right)^2 - 4(1)\\left(\\alpha\\frac{E}{h}\\right)} }{2}.$$\nLet's simplify the term under the square root (the discriminant):\n$$\\left(2\\frac{E}{h} + \\alpha\\right)^2 - 4\\alpha\\frac{E}{h} = \\left(4\\left(\\frac{E}{h}\\right)^2 + 4\\alpha\\frac{E}{h} + \\alpha^2\\right) - 4\\alpha\\frac{E}{h} = 4\\left(\\frac{E}{h}\\right)^2 + \\alpha^2.$$\nSo, the exact eigenvalues are:\n$$\\lambda = \\frac{1}{2} \\left[ \\left(2\\frac{E}{h} + \\alpha\\right) \\pm \\sqrt{4\\left(\\frac{E}{h}\\right)^2 + \\alpha^2} \\right].$$\nThe largest and smallest eigenvalues are:\n$$\\lambda_{\\max} = \\frac{1}{2} \\left[ \\left(2\\frac{E}{h} + \\alpha\\right) + \\sqrt{4\\left(\\frac{E}{h}\\right)^2 + \\alpha^2} \\right]$$\n$$\\lambda_{\\min} = \\frac{1}{2} \\left[ \\left(2\\frac{E}{h} + \\alpha\\right) - \\sqrt{4\\left(\\frac{E}{h}\\right)^2 + \\alpha^2} \\right].$$\n\nNow, we find the leading-order asymptotic expressions for these eigenvalues as $\\alpha \\to \\infty$. We analyze the square root term by factoring out $\\alpha$:\n$$\\sqrt{4\\left(\\frac{E}{h}\\right)^2 + \\alpha^2} = \\alpha \\sqrt{1 + 4\\left(\\frac{E}{h\\alpha}\\right)^2}.$$\nUsing the Taylor expansion $\\sqrt{1+x} = 1 + \\frac{1}{2}x + O(x^2)$ for small $x$, where $x = 4(E/(h\\alpha))^2 \\to 0$ as $\\alpha \\to \\infty$:\n$$\\sqrt{4\\left(\\frac{E}{h}\\right)^2 + \\alpha^2} = \\alpha \\left[ 1 + \\frac{1}{2} \\left(4\\left(\\frac{E}{h\\alpha}\\right)^2\\right) + O(\\alpha^{-4}) \\right] = \\alpha \\left[ 1 + 2\\frac{E^2}{h^2\\alpha^2} + O(\\alpha^{-4}) \\right] = \\alpha + \\frac{2E^2}{h^2\\alpha} + O(\\alpha^{-3}).$$\n\nSubstitute this expansion back into the expressions for the eigenvalues.\nFor $\\lambda_{\\max}$:\n$$\\lambda_{\\max} = \\frac{1}{2} \\left[ 2\\frac{E}{h} + \\alpha + \\left(\\alpha + \\frac{2E^2}{h^2\\alpha} + O(\\alpha^{-3})\\right) \\right] = \\frac{1}{2} \\left[ 2\\alpha + 2\\frac{E}{h} + O(\\alpha^{-1}) \\right] = \\alpha + \\frac{E}{h} + O(\\alpha^{-1}).$$\nThe leading-order term for $\\lambda_{\\max}$ is $\\alpha$.\n\nFor $\\lambda_{\\min}$:\n$$\\lambda_{\\min} = \\frac{1}{2} \\left[ 2\\frac{E}{h} + \\alpha - \\left(\\alpha + \\frac{2E^2}{h^2\\alpha} + O(\\alpha^{-3})\\right) \\right] = \\frac{1}{2} \\left[ 2\\frac{E}{h} - \\frac{2E^2}{h^2\\alpha} + O(\\alpha^{-3}) \\right] = \\frac{E}{h} - \\frac{E^2}{h^2\\alpha} + O(\\alpha^{-3}).$$\nThe leading-order term for $\\lambda_{\\min}$ is a constant, $E/h$.\n\nThe condition number $\\kappa_2$ is the ratio of the largest to the smallest eigenvalue:\n$$\\kappa_2(K(\\alpha,E,h)) = \\frac{\\lambda_{\\max}}{\\lambda_{\\min}} = \\frac{\\alpha + \\frac{E}{h} + O(\\alpha^{-1})}{\\frac{E}{h} - \\frac{E^2}{h^2\\alpha} + O(\\alpha^{-3})}.$$\nTo find the leading-order asymptotic expression for the growth of $\\kappa_2$ as $\\alpha \\to \\infty$, we take the ratio of the leading-order terms of the numerator and the denominator:\n$$\\kappa_2 \\sim \\frac{\\alpha}{E/h} \\quad \\text{as } \\alpha \\to \\infty.$$\nThus, the leading-order asymptotic expression is:\n$$\\kappa_2 \\sim \\frac{\\alpha h}{E}.$$\nThis result shows that the condition number grows linearly with the penalty parameter $\\alpha$, which is a characteristic feature of ill-conditioning in penalty-based finite element methods.", "answer": "$$\\boxed{\\frac{\\alpha h}{E}}$$", "id": "3563169"}, {"introduction": "Having explored methods for applying boundary conditions, we now investigate their profound impact on the solution's local behavior. This problem examines a common scenario in engineering analysis: a geometric corner where an essential boundary (prescribed displacement) meets a natural boundary (prescribed traction) [@problem_id:3563155]. Through a local asymptotic analysis, you will uncover how this \"mixed\" boundary configuration can generate a stress singularity—a theoretical point of infinite stress—which has critical implications for mesh design, result interpretation, and fracture prediction.", "problem": "Consider anti-plane shear of a homogeneous, isotropic, linear elastic solid occupying a wedge domain $\\Omega = \\{(r,\\theta) \\,|\\, 0 < r < R, \\, 0 < \\theta < \\omega\\}$ in plane polar coordinates, where $R > 0$ and the wedge opening angle satisfies $0 < \\omega < 2\\pi$. The out-of-plane displacement $w(r,\\theta)$ governs the deformation and, under quasi-static, small-strain, linear elasticity, satisfies the scalar Laplace equation $\\Delta w = 0$ in $\\Omega$. Suppose that at the edge $\\theta=0$ the displacement is prescribed $w(r,0)=0$ (an essential boundary condition), and at the edge $\\theta=\\omega$ the shear traction is zero $\\mu \\, \\partial w/\\partial n = 0$ (a natural boundary condition), where $\\mu$ is the shear modulus and $\\partial/\\partial n$ denotes the outward normal derivative on the boundary.\n\nStarting from the strong form $\\Delta w = 0$, derive the weak form and explain how essential and natural boundary conditions enter the variational statement. Then, using separation of variables and local asymptotic analysis near the corner at $r=0$, determine the leading-order singular exponent $\\lambda$ such that a nontrivial solution behaves as $w(r,\\theta) \\sim r^{\\lambda} \\, g(\\theta)$ as $r \\to 0^{+}$, with $g$ a nonconstant angular function satisfying the given mixed boundary conditions. Finally, infer the leading-order stress singularity exponent $s$ for the anti-plane shear stress components $\\tau_{rz}$ and $\\tau_{\\theta z}$ as $r \\to 0^{+}$, defined by $\\tau \\sim r^{s}$ in magnitude.\n\nProvide your final answer as a single closed-form analytic expression for the pair $(\\lambda, s)$ in terms of $\\omega$. No numerical approximation or rounding is required. State the final answer using the row matrix convention.", "solution": "The problem is evaluated to be valid as it is scientifically grounded in linear elasticity theory, well-posed with sufficient and consistent information, and objectively stated.\n\nThe problem asks for three items:\n1.  The derivation of the weak form from the strong form, explaining the role of essential and natural boundary conditions.\n2.  The determination of the leading-order singular exponent $\\lambda$ for the displacement field $w(r, \\theta)$.\n3.  The deduction of the leading-order stress singularity exponent $s$.\n\n### Part 1: Weak Formulation and Boundary Conditions\n\nThe strong form of the problem is given by the governing partial differential equation (PDE) and the boundary conditions.\nGoverning PDE in the domain $\\Omega$:\n$$ \\Delta w = 0 $$\nBoundary conditions on the boundary $\\partial\\Omega$:\n1.  Essential (Dirichlet) boundary condition on the edge $\\theta=0$: $w(r, 0) = 0$.\n2.  Natural (Neumann) boundary condition on the edge $\\theta=\\omega$: $\\mu \\frac{\\partial w}{\\partial n} = 0$.\n\nTo derive the weak form, we multiply the PDE by a suitable test function $v$ and integrate over the domain $\\Omega$. The test function $v$ must belong to a function space where the integrals are well-defined. A common choice is a Sobolev space, but for this derivation, we consider $v$ to be a sufficiently smooth function.\n$$ \\int_{\\Omega} v (\\Delta w) \\, dA = 0 $$\nWe apply integration by parts, which in multiple dimensions is achieved using the divergence theorem. We use the vector identity $\\nabla \\cdot (v \\nabla w) = (\\nabla v) \\cdot (\\nabla w) + v (\\Delta w)$, which can be rearranged to $v (\\Delta w) = \\nabla \\cdot (v \\nabla w) - (\\nabla v) \\cdot (\\nabla w)$. Substituting this into the integral gives:\n$$ \\int_{\\Omega} \\left( \\nabla \\cdot (v \\nabla w) - (\\nabla v) \\cdot (\\nabla w) \\right) \\, dA = 0 $$\nApplying the divergence theorem to the first term, we get Green's first identity:\n$$ \\int_{\\Omega} \\nabla \\cdot (v \\nabla w) \\, dA = \\oint_{\\partial\\Omega} v (\\nabla w) \\cdot \\mathbf{n} \\, dS = \\oint_{\\partial\\Omega} v \\frac{\\partial w}{\\partial n} \\, dS $$\nwhere $\\mathbf{n}$ is the outward unit normal vector to the boundary $\\partial\\Omega$, and $dS$ is the differential arc length along the boundary.\nThe equation now becomes:\n$$ \\oint_{\\partial\\Omega} v \\frac{\\partial w}{\\partial n} \\, dS - \\int_{\\Omega} (\\nabla v) \\cdot (\\nabla w) \\, dA = 0 $$\nRearranging, we get the standard starting point for the weak form:\n$$ \\int_{\\Omega} \\nabla v \\cdot \\nabla w \\, dA = \\oint_{\\partial\\Omega} v \\frac{\\partial w}{\\partial n} \\, dS $$\nThe boundary $\\partial\\Omega$ is composed of the edges $\\theta=0$, $\\theta=\\omega$, and the arc $r=R$. The boundary integral can be split accordingly. Let's analyze the contribution from each part.\n\n-   **Essential Boundary Condition**: On the edge $\\theta=0$, the displacement is prescribed: $w(r,0) = 0$. This is an essential condition that must be satisfied by the solution $w$. In the context of the principle of virtual work or variational methods, the test function $v$ (representing a virtual displacement) must be admissible, which means it must satisfy the homogeneous form of all essential boundary conditions. Therefore, we require $v(r,0)=0$. This\n    enforcement on the test function space causes the boundary integral over this part of the boundary to vanish, irrespective of the value of $\\frac{\\partial w}{\\partial n}$ there:\n    $$ \\int_{\\theta=0} v \\frac{\\partial w}{\\partial n} \\, dS = 0 \\quad \\text{because } v=0 \\text{ on this edge.} $$\n    This is how essential boundary conditions are incorporated: they are imposed directly on the space of trial functions (for $w$) and test functions (for $v$).\n\n-   **Natural Boundary Condition**: On the edge $\\theta=\\omega$, the shear traction is prescribed to be zero. The traction vector on a surface with normal $\\mathbf{n}$ is $\\mathbf{t} = \\boldsymbol{\\sigma} \\cdot \\mathbf{n}$. For anti-plane shear, this gives the scalar shear traction $\\mu \\frac{\\partial w}{\\partial n}$. The condition is $\\mu \\frac{\\partial w}{\\partial n} = 0$. Since the shear modulus $\\mu$ is a non-zero positive constant, this implies $\\frac{\\partial w}{\\partial n}=0$ on this edge. This condition is termed \"natural\" because it appears directly in the boundary integral term of the weak form. The contribution to the boundary integral from this edge is:\n    $$ \\int_{\\theta=\\omega} v \\frac{\\partial w}{\\partial n} \\, dS = \\int_{\\theta=\\omega} v (0) \\, dS = 0 $$\n    This part of the integral vanishes because the prescribed value of the normal derivative is zero. Unlike the essential condition, no constraint is placed on the test function $v$ on this boundary. The condition is satisfied \"naturally\" by the solution of the variational problem.\n\nIgnoring the far-field boundary at $r=R$ for the purpose of local analysis near $r=0$, the final weak form is: Find $w$ such that $w(r,0)=0$ and for all admissible test functions $v$ (with $v(r,0)=0$), the following holds:\n$$ \\int_{\\Omega} \\nabla w \\cdot \\nabla v \\, dA = 0 $$\n\n### Part 2: Leading-Order Singular Exponent $\\lambda$\n\nWe analyze the behavior of the solution near the corner $r=0$ using the method of separation of variables. The governing PDE, Laplace's equation, in plane polar coordinates $(r, \\theta)$ is:\n$$ \\Delta w = \\frac{1}{r}\\frac{\\partial}{\\partial r}\\left(r\\frac{\\partial w}{\\partial r}\\right) + \\frac{1}{r^2}\\frac{\\partial^2 w}{\\partial \\theta^2} = 0 $$\nWe seek a solution of the form $w(r,\\theta) = r^{\\lambda} g(\\theta)$, as suggested by the asymptotic analysis. Substituting this into the PDE:\n$$ \\frac{1}{r}\\frac{\\partial}{\\partial r}\\left(r \\frac{d}{dr}(r^{\\lambda}) g(\\theta)\\right) + \\frac{1}{r^2} r^{\\lambda} \\frac{d^2 g}{d \\theta^2} = 0 $$\n$$ \\frac{1}{r}\\frac{d}{dr}\\left(\\lambda r^{\\lambda}\\right) g(\\theta) + r^{\\lambda-2} g''(\\theta) = 0 $$\n$$ \\lambda^2 r^{\\lambda-2} g(\\theta) + r^{\\lambda-2} g''(\\theta) = 0 $$\nFor $r \\neq 0$, we can divide by $r^{\\lambda-2}$:\n$$ g''(\\theta) + \\lambda^2 g(\\theta) = 0 $$\nThe general solution to this ordinary differential equation is:\n$$ g(\\theta) = C_1 \\sin(\\lambda\\theta) + C_2 \\cos(\\lambda\\theta) $$\nSo, the general separated solution is $w(r,\\theta) = r^{\\lambda} (C_1 \\sin(\\lambda\\theta) + C_2 \\cos(\\lambda\\theta))$. We now apply the boundary conditions at $\\theta=0$ and $\\theta=\\omega$ to determine the constants $C_1, C_2$ and the eigenvalue $\\lambda$.\n\n1.  Boundary condition at $\\theta=0$: $w(r,0)=0$.\n    $$ r^{\\lambda} (C_1 \\sin(0) + C_2 \\cos(0)) = 0 \\implies r^{\\lambda} C_2 = 0 $$\n    For this to hold for any $r>0$, we must have $C_2=0$. The solution simplifies to $w(r,\\theta) = C_1 r^{\\lambda} \\sin(\\lambda\\theta)$.\n\n2.  Boundary condition at $\\theta=\\omega$: $\\mu \\frac{\\partial w}{\\partial n} = 0$. The outward normal vector on the face $\\theta=\\omega$ is $\\mathbf{n} = \\hat{\\mathbf{e}}_{\\theta}$. The normal derivative is $\\frac{\\partial w}{\\partial n} = \\nabla w \\cdot \\mathbf{n} = (\\frac{\\partial w}{\\partial r}\\hat{\\mathbf{e}}_r + \\frac{1}{r}\\frac{\\partial w}{\\partial \\theta}\\hat{\\mathbf{e}}_{\\theta}) \\cdot \\hat{\\mathbf{e}}_{\\theta} = \\frac{1}{r}\\frac{\\partial w}{\\partial \\theta}$. The boundary condition is thus $\\frac{1}{r}\\frac{\\partial w}{\\partial \\theta}|_{\\theta=\\omega} = 0$.\n    First, we compute the partial derivative with respect to $\\theta$:\n    $$ \\frac{\\partial w}{\\partial \\theta} = C_1 r^{\\lambda} \\lambda \\cos(\\lambda\\theta) $$\n    Applying the boundary condition:\n    $$ \\frac{1}{r} [C_1 r^{\\lambda} \\lambda \\cos(\\lambda\\omega)] = C_1 \\lambda r^{\\lambda-1} \\cos(\\lambda\\omega) = 0 $$\n    For a non-trivial solution ($C_1 \\neq 0$) and a power-law form ($\\lambda \\neq 0$), we must have:\n    $$ \\cos(\\lambda\\omega) = 0 $$\n    This implies that $\\lambda\\omega$ must be an odd integer multiple of $\\frac{\\pi}{2}$:\n    $$ \\lambda\\omega = \\frac{(2k-1)\\pi}{2} \\quad \\text{for } k = 1, 2, 3, \\dots $$\n    The possible values for $\\lambda$ are $\\lambda_k = \\frac{(2k-1)\\pi}{2\\omega}$. The leading-order behavior as $r \\to 0$ corresponds to the term that dominates for small $r$. This is the term with the smallest positive exponent $\\lambda$. This occurs for $k=1$.\n    $$ \\lambda = \\lambda_1 = \\frac{\\pi}{2\\omega} $$\n\n### Part 3: Stress Singularity Exponent $s$\n\nThe non-zero shear stress components in anti-plane shear, in polar coordinates, are given by:\n$$ \\tau_{rz} = \\mu \\frac{\\partial w}{\\partial r} \\quad \\text{and} \\quad \\tau_{\\theta z} = \\mu \\frac{1}{r} \\frac{\\partial w}{\\partial \\theta} $$\nUsing the leading-order displacement field $w(r,\\theta) \\approx C r^{\\lambda} \\sin(\\lambda\\theta)$ (where $C$ is a constant and $\\lambda = \\frac{\\pi}{2\\omega}$):\n$$ \\frac{\\partial w}{\\partial r} = C \\lambda r^{\\lambda-1} \\sin(\\lambda\\theta) $$\n$$ \\frac{1}{r}\\frac{\\partial w}{\\partial \\theta} = \\frac{1}{r} [C r^{\\lambda} \\lambda \\cos(\\lambda\\theta)] = C \\lambda r^{\\lambda-1} \\cos(\\lambda\\theta) $$\nSubstituting these into the stress component equations:\n$$ \\tau_{rz} = \\mu C \\lambda r^{\\lambda-1} \\sin\\left(\\frac{\\pi\\theta}{2\\omega}\\right) $$\n$$ \\tau_{\\theta z} = \\mu C \\lambda r^{\\lambda-1} \\cos\\left(\\frac{\\pi\\theta}{2\\omega}\\right) $$\nBoth stress components have a radial dependency of the form $r^{\\lambda-1}$. The problem defines the stress singularity exponent $s$ such that the magnitude of the stress, $\\tau = \\sqrt{\\tau_{rz}^2 + \\tau_{\\theta z}^2}$, behaves as $\\tau \\sim r^s$ as $r \\to 0^{+}$.\n$$ \\tau^2 = \\tau_{rz}^2 + \\tau_{\\theta z}^2 = (\\mu C \\lambda r^{\\lambda-1})^2 \\left[ \\sin^2(\\lambda\\theta) + \\cos^2(\\lambda\\theta) \\right] = (\\mu C \\lambda r^{\\lambda-1})^2 $$\n$$ \\tau = |\\mu C \\lambda| r^{\\lambda-1} $$\nBy comparing this with $\\tau \\sim r^s$, we identify the stress singularity exponent $s$ as:\n$$ s = \\lambda - 1 $$\nSubstituting the value of $\\lambda = \\frac{\\pi}{2\\omega}$:\n$$ s = \\frac{\\pi}{2\\omega} - 1 $$\nA stress singularity occurs when $s < 0$, which implies that the stresses become infinite at the corner tip. This happens if $\\frac{\\pi}{2\\omega} - 1 < 0$, which is equivalent to $\\omega > \\frac{\\pi}{2}$.\n\nThe pair $(\\lambda, s)$ is therefore given by $(\\frac{\\pi}{2\\omega}, \\frac{\\pi}{2\\omega}-1)$.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{\\pi}{2\\omega} & \\frac{\\pi}{2\\omega} - 1\n\\end{pmatrix}\n}\n$$", "id": "3563155"}]}