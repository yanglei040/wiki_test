{"hands_on_practices": [{"introduction": "任何精细的粒子输运模拟（如使用 Geant4进行的模拟）的核心，都是粒子穿过物质的随机过程。该过程通过确定粒子在下一次相互作用前行进的随机路径长度来建模。这个路径长度遵循一个指数分布，该分布由单位长度上恒定的相互作用概率导出。本练习提供了逆变换采样方法的第一手实践，这是蒙特卡洛模拟中生成随机变量的基石技术，它将平均自由程的物理概念与其计算实现联系起来。[@problem_id:3533651]", "problem": "一个带电粒子在穿过均匀量能器材料时会经历随机相互作用，这可以建模为关于路径长度的一维泊松过程。设该材料的微观截面为 $\\sigma$（单位 $\\mathrm{cm}^2$），数密度为 $n$（单位 $\\mathrm{cm}^{-3}$）。宏观相互作用系数为 $\\mu = n \\sigma$（单位 $\\mathrm{cm}^{-1}$），平均自由程为 $\\lambda = 1/\\mu$（单位 $\\mathrm{cm}$）。在量能器簇射的蒙特卡洛（MC）模拟中，到下一次相互作用的自由路径长度是一个随机变量，受泊松过程所蕴含的指数生存概率支配。\n\n从上述物理模型和基本定义出发，使用逆变换采样法推导自由路径长度的抽样方法，该方法适用于由平均自由程 $\\lambda$ 参数化的指数分布。然后，您必须实现一个程序，对下面指定的每个测试用例，计算平均自由程 $\\lambda$，并根据逆变换采样法，使用提供的均匀分布随机数 $u \\in (0,1)$ 生成两个自由路径长度。所有长度必须以厘米为单位表示。\n\n您的程序必须处理以下测试套件，其中每个测试用例以 $(n,\\sigma,u_1,u_2)$ 的形式给出，$n$ 的单位是 $\\mathrm{cm}^{-3}$，$\\sigma$ 的单位是 $\\mathrm{cm}^2$，$u_1, u_2$ 无量纲：\n- 测试用例1（一般情况）：$n = 5 \\times 10^{22}$，$\\sigma = 2 \\times 10^{-24}$，$u_1 = 0.2$，$u_2 = 0.8$。\n- 测试用例2（罕见长步长边界情况）：$n = 1 \\times 10^{23}$，$\\sigma = 1 \\times 10^{-23}$，$u_1 = 1 \\times 10^{-12}$，$u_2 = 0.5$。\n- 测试用例3（$u$ 接近1的精度边界情况）：$n = 1 \\times 10^{23}$，$\\sigma = 1 \\times 10^{-26}$，$u_1 = 0.999999$，$u_2 = 0.999$。\n- 测试用例4（短平均自由程情况）：$n = 8 \\times 10^{22}$，$\\sigma = 3 \\times 10^{-23}$，$u_1 = 0.1$，$u_2 = 0.5$。\n\n对于每个测试用例，计算：\n1. 平均自由程 $\\lambda$（单位：$\\mathrm{cm}$）。\n2. 分别使用 $u_1$ 和 $u_2$ 通过逆变换采样法抽样得到的两个自由路径长度 $\\ell_1$ 和 $\\ell_2$（单位：$\\mathrm{cm}$）。\n\n输出规格：\n- 将每个数值结果四舍五入到六位小数。\n- 您的程序应生成单行输出，其中包含所有测试用例按顺序串联的结果，格式为逗号分隔的列表，并用方括号括起来。每个测试用例的顺序是：$[\\lambda, \\ell_1, \\ell_2]$，然后将四个测试用例的结果串联起来。例如：$[\\lambda_1,\\ell_{1,1},\\ell_{1,2},\\lambda_2,\\ell_{2,1},\\ell_{2,2},\\ldots]$。", "solution": "用户希望解决一个物理问题。\n用户要求我执行以下操作：\n1.  **验证问题**：检查问题是否在科学上合理、提法恰当、客观且完整。\n2.  **推导解答**：如果问题有效，推导出用于抽样自由路径长度的数学公式。\n3.  **实现解答**：编写一个Python程序，为给定的测试用例计算结果。\n\n### 问题验证\n\n我将首先按照指示验证问题陈述。\n\n#### 步骤1：提取给定信息\n\n*   **物理模型**：粒子相互作用被建模为关于路径长度的一维泊松过程。\n*   **定义**：\n    *   微观截面：$\\sigma$（单位 $\\mathrm{cm}^2$）。\n    *   靶粒子数密度：$n$（单位 $\\mathrm{cm}^{-3}$）。\n    *   宏观相互作用系数（或线性衰减系数）：$\\mu = n \\sigma$（单位 $\\mathrm{cm}^{-1}$）。\n    *   平均自由程：$\\lambda = 1/\\mu$（单位 $\\mathrm{cm}$）。\n*   **任务**：使用逆变换采样法推导自由路径长度 $\\ell$ 的抽样方法。\n*   **随机数**：提供均匀分布随机数 $u \\in (0,1)$。\n*   **测试用例**（以 $(n, \\sigma, u_1, u_2)$ 形式给出）：\n    1.  测试用例1：$(5 \\times 10^{22} \\, \\mathrm{cm}^{-3}, 2 \\times 10^{-24} \\, \\mathrm{cm}^2, 0.2, 0.8)$\n    2.  测试用例2：$(1 \\times 10^{23} \\, \\mathrm{cm}^{-3}, 1 \\times 10^{-23} \\, \\mathrm{cm}^2, 1 \\times 10^{-12}, 0.5)$\n    3.  测试用例3：$(1 \\times 10^{23} \\, \\mathrm{cm}^{-3}, 1 \\times 10^{-26} \\, \\mathrm{cm}^2, 0.999999, 0.999)$\n    4.  测试用例4：$(8 \\times 10^{22} \\, \\mathrm{cm}^{-3}, 3 \\times 10^{-23} \\, \\mathrm{cm}^2, 0.1, 0.5)$\n*   **输出要求**：\n    *   对于每个测试用例，计算 $\\lambda$、$\\ell_1$ 和 $\\ell_2$。\n    *   将所有结果四舍五入到六位小数。\n    *   生成单行输出：$[\\lambda_1,\\ell_{1,1},\\ell_{1,2},\\lambda_2,\\ell_{2,1},\\ell_{2,2},\\ldots]$。\n\n#### 步骤2：使用提取的信息进行验证\n\n*   **科学基础（关键）**：该问题在根本上是合理的。使用恒定的宏观截面（$\\mu$）来描述粒子相互作用概率是一个标准的物理模型。这直接导出了给定路径长度上相互作用次数的泊松过程，并因此导出了相互作用之间自由路径长度的指数分布。关系式 $\\mu = n \\sigma$ 是材料科学和粒子物理学中的一个定义恒等式。逆变换采样法是蒙特卡洛方法中一种标准的、数学上严谨的技术。所有前提在物理学和计算科学中都已牢固确立。\n*   **提法恰当**：该问题是良构的（提法恰当）。它提供了所有必要的信息（物理模型、定义、输入数据），足以唯一确定所需的输出。抽样公式的推导及其在给定测试用例上的应用会得出一组唯一的、确定性的结果。\n*   **客观性（关键）**：问题以精确、客观和定量的术语陈述。没有主观因素或歧义。术语定义清晰，所需的计算也无偏见地指定。\n\n该问题没有表现出验证标准中列出的任何缺陷。数据值对于凝聚态物质和辐射相互作用是物理上合理的。为均匀分布随机数选择的边界情况（$u$ 接近0和 $u$ 接近1）很好地测试了抽样公式在其极限处的数值行为，这是一个设计良好的计算问题的标志。\n\n#### 步骤3：结论与行动\n\n该问题是**有效的**。我现在将继续进行解答。\n\n### 推导与解答\n\n该问题要求推导在均匀介质中粒子自由路径长度 $\\ell$ 的抽样方法。其基础物理模型是支配相互作用的泊松过程。\n\n$1$. **自由路径长度的概率分布**\n宏观相互作用系数 $\\mu$ 代表粒子在单位路径长度上发生相互作用的恒定概率。对于一个已经行进了距离 $x$ 的粒子，在下一个无穷小区间 $dx$ 内发生相互作用的概率是 $\\mu dx$。在此区间内*不*发生相互作用的概率是 $1 - \\mu dx$。\n\n粒子行进至少距离 $x$ 而不发生相互作用的概率 $P(x)$（生存概率）可以通过将路径视为一系列无穷小步长来找到。存活到 $x+dx$ 的概率是存活到 $x$ 的概率与在 $dx$ 内不发生相互作用的概率的乘积：\n$$ P(x+dx) = P(x) (1 - \\mu dx) $$\n整理可得：\n$$ \\frac{P(x+dx) - P(x)}{dx} = - \\mu P(x) $$\n当 $dx \\to 0$ 时取极限，我们得到微分方程：\n$$ \\frac{dP(x)}{dx} = - \\mu P(x) $$\n在边界条件为距离0处的生存概率为1（即 $P(0)=1$）的情况下，该方程的解是指数衰减函数：\n$$ P(x) = e^{-\\mu x} $$\n这个函数也称为生存函数 $S(x)$。\n\n我们关心的随机变量是到*第一次*相互作用的路径长度 $\\ell$。累积分布函数（CDF）$F(\\ell)$ 给出了相互作用发生在路径长度小于或等于 $\\ell$ 的概率。这等价于1减去存活超过长度 $\\ell$ 的概率：\n$$ F(\\ell) = 1 - S(\\ell) = 1 - e^{-\\mu \\ell} $$\n概率密度函数（PDF）$p(\\ell)$ 是累积分布函数的导数：\n$$ p(\\ell) = \\frac{dF(\\ell)}{d\\ell} = \\mu e^{-\\mu \\ell}, \\quad \\text{for } \\ell \\ge 0 $$\n这是率参数为 $\\mu$ 的指数分布。该分布的均值确实是 $1/\\mu$，这与平均自由程 $\\lambda$ 的定义一致。\n\n$2$. **逆变换采样法**\n逆变换采样法是一种从任何其累积分布函数的反函数已知的概率分布中生成随机样本的方法。该方法通过从区间 $(0, 1)$ 上的标准均匀分布中生成一个随机数 $u$，然后计算样本 $\\ell$：\n$$ \\ell = F^{-1}(u) $$\n其中 $F^{-1}$ 是累积分布函数的反函数。\n\n为了求 $F^{-1}$，我们令 $F(\\ell) = u$ 并解出 $\\ell$：\n$$ u = 1 - e^{-\\mu \\ell} $$\n$$ e^{-\\mu \\ell} = 1 - u $$\n对两边取自然对数：\n$$ \\ln(e^{-\\mu \\ell}) = \\ln(1 - u) $$\n$$ -\\mu \\ell = \\ln(1 - u) $$\n$$ \\ell = -\\frac{1}{\\mu} \\ln(1 - u) $$\n由于平均自由程定义为 $\\lambda = 1/\\mu$，抽样公式变为：\n$$ \\ell = -\\lambda \\ln(1 - u) $$\n一个常见且等价的简化是基于这样一个性质：如果 $u$ 是在 $(0, 1)$ 上均匀分布的随机变量，那么随机变量 $u' = 1 - u$ 也在 $(0, 1)$ 上均匀分布。因此，我们可以在公式中用 $u$ 替换 $1 - u$，从而得到更直接的表达式：\n$$ \\ell = -\\lambda \\ln(u) $$\n这种形式因其简洁性以及与生存函数（$S(\\ell) = u$）的直接联系而在蒙特卡洛模拟中被广泛使用。我们将使用这种形式进行计算。\n\n$3$. **计算算法**\n对于由元组 $(n, \\sigma, u_1, u_2)$ 给出的每个测试用例：\na. 计算宏观相互作用系数：$\\mu = n \\sigma$。\nb. 计算平均自由程：$\\lambda = 1/\\mu$。\nc. 使用 $u_1$ 抽样第一个自由路径长度：$\\ell_1 = -\\lambda \\ln(u_1)$。\nd. 使用 $u_2$ 抽样第二个自由路径长度：$\\ell_2 = -\\lambda \\ln(u_2)$。\ne. 将 $\\lambda$、$\\ell_1$ 和 $\\ell_2$ 四舍五入到六位小数并存储结果。\n\n此过程将应用于所有四个测试用例，以生成最终的输出字符串。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the mean free path and samples free path lengths for a set of\n    test cases based on the inverse transform sampling method for an\n    exponential distribution.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (n, sigma, u1, u2)\n    # n: number density in cm^-3\n    # sigma: microscopic cross section in cm^2\n    # u1, u2: uniform random variates in (0,1)\n    test_cases = [\n        (5e22, 2e-24, 0.2, 0.8),\n        (1e23, 1e-23, 1e-12, 0.5),\n        (1e23, 1e-26, 0.999999, 0.999),\n        (8e22, 3e-23, 0.1, 0.5),\n    ]\n\n    results = []\n    \n    # Process each test case\n    for case in test_cases:\n        n, sigma, u1, u2 = case\n        \n        # 1. Calculate the macroscopic interaction coefficient (mu)\n        mu = n * sigma\n        \n        # 2. Calculate the mean free path (lambda)\n        lambda_val = 1.0 / mu\n        \n        # 3. Sample two free path lengths (l1, l2) using inverse transform sampling\n        # The formula is l = -lambda * ln(u)\n        l1 = -lambda_val * np.log(u1)\n        l2 = -lambda_val * np.log(u2)\n        \n        # Append the rounded results to the list\n        # The output format requires 6 decimal places.\n        results.append(f\"{lambda_val:.6f}\")\n        results.append(f\"{l1:.6f}\")\n        results.append(f\"{l2:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "3533651"}, {"introduction": "当一个高能粒子穿过量能器时，它并非沿直线运动。它会因与材料中原子核的库仑散射而持续发生小角度偏转。这些大量小偏转的累积效应，即所谓的多重库仑散射，导致粒子轨迹扩散，从而引起电磁簇射的横向展宽。本练习探讨了角向扩散与由此产生的空间位移之间的联系。这项实践之所以有价值，是因为它将理论推导与广泛使用的经验公式应用相结合，展示了物理学家如何为复杂的随机过程建模以预测宏观簇射特性。[@problem_id:3533635]", "problem": "一个能量为 $E=5\\,\\mathrm{GeV}$ 的超相对论性电子进入一个均匀的铅电磁量能器。该材料的辐射长度为 $X_0=0.56\\,\\mathrm{cm}$。在量能器响应的计算模型中，由多次库仑散射引起的电子角偏转被近似为一个与 Molière 理论一致的高斯过程，其特征均方根 (RMS) 投影散射角在深度 $x$ 处由经过充分检验的 Highland 参数化及其标准对数修正项来描述。假设 $x=1\\,\\mathrm{cm}$，忽略此步长内的能量损失，取速度参数为 $\\beta \\approx 1$，并使用 $p \\approx E/c$ 计算动量。\n\n从“小角度多次散射可被视为角扩散”以及“横向位移源于瞬时角度的路径积分”这一建模前提出发，推导深度 $x$ 处的横向 RMS 位移 $y_{\\mathrm{rms}}$ 关于 $x$ 和 RMS 投影散射角 $\\theta_0(x)$ 的表达式，然后在 $x=1\\,\\mathrm{cm}$ 处计算其值。使用 Highland 参数化计算 $x=1\\,\\mathrm{cm}$ 处 $\\theta_0$ 的数值，并使用推导出的关系式计算您的 $y_{\\mathrm{rms}}$。将您的答案四舍五入到四位有效数字。将 $\\theta_0$ 以弧度表示，将 $y_{\\mathrm{rms}}$ 以厘米表示。", "solution": "问题陈述具有科学依据，提法恰当且客观。它基于粒子与物质相互作用的既定原理，特别是多次库仑散射。所有必要的数据和明确定义的物理近似都已给出，从而可以得到一个唯一且有意义的解。因此，我们开始求解。\n\n任务分为两部分：首先，推导均方根 (RMS) 横向位移 $y_{\\mathrm{rms}}$ 关于深度 $x$ 和 RMS 投影散射角 $\\theta_0(x)$ 的表达式；其次，在指定深度对 $\\theta_0(x)$ 和 $y_{\\mathrm{rms}}(x)$ 进行数值计算。\n\n第1部分：RMS 横向位移 $y_{\\mathrm{rms}}(x)$ 的推导\n\n我们考虑一个最初沿某一轴线运动的粒子，我们称该方向为纵向。问题使用 $x$ 作为深度的符号，因此我们将遵循此约定。在深度 $x$ 处，横向平面（例如 $y$ 平面）中的横向位移记为 $y(x)$。在适用于高能粒子多次库仑散射的小角度近似下，横向位移是相对于初始方向的投影角 $\\theta_y(x')$ 的路径积分：\n$$ y(x) = \\int_0^x \\theta_y(x') dx' $$\n其中 $x'$ 是代表深度的积分变量。\n\nRMS 位移 $y_{\\mathrm{rms}}$ 定义为位移平方 $y(x)^2$ 的期望值（或系综平均，用 $\\langle \\dots \\rangle$ 表示）的平方根：\n$$ y_{\\mathrm{rms}}^2(x) = \\langle y(x)^2 \\rangle = \\left\\langle \\left( \\int_0^x \\theta_y(x') dx' \\right)^2 \\right\\rangle $$\n通过将积分的平方写成二重积分并将期望算符移入积分内，我们得到：\n$$ \\langle y(x)^2 \\rangle = \\int_0^x dx' \\int_0^x dx'' \\langle \\theta_y(x') \\theta_y(x'') \\rangle $$\n项 $\\langle \\theta_y(x') \\theta_y(x'') \\rangle$ 表示在两个不同深度处投影角的相关性。问题的前提是散射被视为角扩散，这是一个马尔可夫过程。这意味着在不重叠的路径段上的角偏转在统计上是独立的。让我们假设 $x' \\le x''$。深度 $x''$ 处的角度是深度 $x'$ 处的角度与在 $x'$ 和 $x''$ 之间累积的后续角偏转之和，即 $\\theta_y(x'') = \\theta_y(x') + \\Delta\\theta_y(x', x'')$。那么相关函数变为：\n$$ \\langle \\theta_y(x') \\theta_y(x'') \\rangle = \\langle \\theta_y(x') (\\theta_y(x') + \\Delta\\theta_y(x', x'')) \\rangle = \\langle \\theta_y(x')^2 \\rangle + \\langle \\theta_y(x') \\Delta\\theta_y(x', x'') \\rangle $$\n因为散射过程是马尔可夫过程，角增量 $\\Delta\\theta_y(x', x'')$ 与角度 $\\theta_y(x')$ 无关。此外，平均角度为零，即 $\\langle \\theta_y(x') \\rangle = \\langle \\Delta\\theta_y(x', x'') \\rangle = 0$。因此，交叉项消失：$\\langle \\theta_y(x') \\Delta\\theta_y(x', x'') \\rangle = \\langle \\theta_y(x') \\rangle \\langle \\Delta\\theta_y(x', x'') \\rangle = 0$。\n对于 $x' \\le x''$，这将相关函数简化为较浅深度 $x'$ 处角度的方差：\n$$ \\langle \\theta_y(x') \\theta_y(x'') \\rangle = \\langle \\theta_y(x')^2 \\rangle $$\n更一般地，对于任意两个深度 $x'$ 和 $x''$，相关性由两个深度中较小深度处的方差给出：\n$$ \\langle \\theta_y(x') \\theta_y(x'') \\rangle = \\langle \\theta_y(\\min(x', x''))^2 \\rangle $$\n为了推导函数形式，我们使用多次散射的基本模型（按指示忽略能量损失），其中投影角的方差随深度线性增长，即 $\\langle \\theta_y(x')^2 \\rangle \\propto x'$。已知 $\\theta_0(x)$ 是深度 $x$ 处的 RMS 角，因此 $\\theta_0(x)^2 = \\langle \\theta_y(x)^2 \\rangle$。这使我们能够用最终深度 $x$ 处的方差来表示中间深度 $x'$ 处的方差：\n$$ \\langle \\theta_y(x')^2 \\rangle = \\theta_0(x')^2 \\approx \\frac{x'}{x} \\theta_0(x)^2 $$\n将此代入 $\\langle y(x)^2 \\rangle$ 的积分中：\n$$ \\langle y(x)^2 \\rangle = \\int_0^x dx' \\int_0^x dx'' \\frac{\\min(x', x'')}{x} \\theta_0(x)^2 $$\n方形定义域 $[0,x] \\times [0,x]$ 上的积分可以通过利用被积函数的对称性来简化。它等于在 $x' \\le x''$ 的三角形区域上积分的两倍：\n$$ \\langle y(x)^2 \\rangle = 2 \\int_0^x dx'' \\int_0^{x''} dx' \\frac{x'}{x} \\theta_0(x)^2 $$\n我们对 $x'$ 进行内层积分：\n$$ \\int_0^{x''} \\frac{x'}{x} \\theta_0(x)^2 dx' = \\frac{\\theta_0(x)^2}{x} \\left[ \\frac{x'^2}{2} \\right]_0^{x''} = \\frac{\\theta_0(x)^2}{2x} (x'')^2 $$\n接下来，我们对 $x''$ 进行外层积分：\n$$ \\langle y(x)^2 \\rangle = 2 \\int_0^x \\frac{\\theta_0(x)^2}{2x} (x'')^2 dx'' = \\frac{\\theta_0(x)^2}{x} \\int_0^x (x'')^2 dx'' = \\frac{\\theta_0(x)^2}{x} \\left[ \\frac{(x'')^3}{3} \\right]_0^x = \\frac{\\theta_0(x)^2}{x} \\frac{x^3}{3} = \\frac{1}{3} x^2 \\theta_0(x)^2 $$\n取平方根得到 RMS 横向位移的最终表达式：\n$$ y_{\\mathrm{rms}}(x) = \\sqrt{\\frac{1}{3} x^2 \\theta_0(x)^2} = \\frac{x \\theta_0(x)}{\\sqrt{3}} $$\n\n第2部分：数值计算\n\n我们现在计算在 $x = 1\\,\\mathrm{cm}$ 处 $\\theta_0(x)$ 和 $y_{\\mathrm{rms}}(x)$ 的数值。RMS 投影散射角的 Highland 参数化为：\n$$ \\theta_0 = \\frac{13.6\\,\\mathrm{MeV}}{\\beta c p} z \\sqrt{\\frac{x}{X_0}} \\left[ 1 + 0.038 \\ln\\left(\\frac{x}{X_0}\\right) \\right] $$\n给定的参数是：\n- 粒子：电子 ($z=1$)。\n- 能量：$E = 5\\,\\mathrm{GeV} = 5000\\,\\mathrm{MeV}$。\n- 近似：$\\beta \\approx 1$ 和 $pc \\approx E = 5000\\,\\mathrm{MeV}$。\n- 深度：$x = 1\\,\\mathrm{cm}$。\n- 辐射长度：$X_0 = 0.56\\,\\mathrm{cm}$。\n\n首先，我们计算比值 $x/X_0$：\n$$ \\frac{x}{X_0} = \\frac{1\\,\\mathrm{cm}}{0.56\\,\\mathrm{cm}} = \\frac{1}{0.56} \\approx 1.785714 $$\n将这些值代入 $\\theta_0$ 的公式中：\n$$ \\theta_0 \\approx \\frac{13.6\\,\\mathrm{MeV}}{5000\\,\\mathrm{MeV}} (1) \\sqrt{\\frac{1}{0.56}} \\left[ 1 + 0.038 \\ln\\left(\\frac{1}{0.56}\\right) \\right] $$\n$$ \\theta_0 \\approx 0.00272 \\times \\sqrt{1.785714...} \\times [1 + 0.038 \\ln(1.785714...)] $$\n$$ \\theta_0 \\approx 0.00272 \\times 1.336306... \\times [1 + 0.038 \\times (0.579818...)] $$\n$$ \\theta_0 \\approx 0.00363475... \\times [1 + 0.022033...] $$\n$$ \\theta_0 \\approx 0.00363475... \\times 1.022033... \\approx 0.00371483\\,\\mathrm{rad} $$\n四舍五入到四位有效数字，我们得到 RMS 投影角：\n$$ \\theta_0(x=1\\,\\mathrm{cm}) \\approx 0.003715\\,\\mathrm{rad} $$\n接下来，我们使用推导出的表达式计算在 $x = 1\\,\\mathrm{cm}$ 处的 RMS 横向位移 $y_{\\mathrm{rms}}$，为获得更高精度，使用未四舍五入的 $\\theta_0$ 值：\n$$ y_{\\mathrm{rms}}(1\\,\\mathrm{cm}) = \\frac{(1\\,\\mathrm{cm}) \\times \\theta_0(1\\,\\mathrm{cm})}{\\sqrt{3}} \\approx \\frac{1 \\times 0.00371483...}{\\sqrt{3}} $$\n$$ y_{\\mathrm{rms}}(1\\,\\mathrm{cm}) \\approx \\frac{0.00371483...}{1.7320508...}\\,\\mathrm{cm} \\approx 0.00214476\\,\\mathrm{cm} $$\n四舍五入到四位有效数字，我们得到 RMS 横向位移：\n$$ y_{\\mathrm{rms}}(x=1\\,\\mathrm{cm}) \\approx 0.002145\\,\\mathrm{cm} $$", "answer": "$$\\boxed{\\begin{pmatrix} 0.003715  0.002145 \\end{pmatrix}}$$", "id": "3533635"}, {"introduction": "量能器的最终目标是测量能量，但这种测量绝非完美。对于采样量能器而言，不确定性的一个关键来源是信号产生过程本身的统计涨落。本实践聚焦于光子统计——在活性闪烁体材料中产生的光电子数量的泊松涨落。从这个基本的统计过程出发，我们可以推导出量能器能量分辨率中占主导地位的“随机项”。通过解决这个问题，您将从第一性原理层面理解为何量能器的分辨率随能量升高而改善（按 $1/\\sqrt{E}$ 比例缩放），以及这一性能如何与探测器的设计选择（如采样分数和光产额）直接相关。[@problem_id:3533695]", "problem": "在高能物理（HEP）实验所用的采样量能器的快速模拟中，对入射的强子或电磁簇射的响应是通过光电子计数将闪烁光转换为能量估算值来建模的。考虑一个理想化的铅-闪烁体采样量能器，其中总簇射能量 $E$ 的一部分（比例为 $f_s$）沉积在闪烁体层中。测量链假设是线性的：闪爍體每沉積 1 $\\mathrm{GeV}$ 的能量，平均产生 $N_{pe}$ 个光电子，且能量估算器由所计数的总光电子数构建，以确保无偏。假设唯一的涨落来源是光电子计数统计，该过程遵循泊松过程。所有其他分辨率贡献项（例如，采样非均匀性、上游泄漏、来自校准和非均匀性的常数项以及电子学噪声）均可忽略不计。\n\n从泊松统计和线性响应的定义出发，推导仅由光电子统计涨落引起的分数能量分辨率。利用此结果，将随机项系数 $a$ 定义为量能器模拟中使用的标准参数化中控制分数分辨率 $E^{-1/2}$ 标度的无量纲前置因子，其中 $E$ 以 $\\mathrm{GeV}$ 为单位表示。然后，对于一个以 $f_s = 0.3$ 和 $N_{pe} = 2000/\\mathrm{GeV}$ 为特征的铅-闪烁体量能器，在上述假设下，计算 $a$ 并预测在 $E = 50\\,\\mathrm{GeV}$ 时的分数分辨率 $\\sigma_E/E$。\n\n将你的答案四舍五入至四位有效数字。将 $a$ 和 $\\sigma_E/E$ 均表示为无量纲小数。", "solution": "该问题要求在给定一组参数的情况下，为一个理想化的采样量能器推导随机项系数和分数能量分辨率。根据解题步骤，第一步是验证问题陈述。\n\n### 问题验证\n\n**第1步：提取已知条件**\n- 系统是一个理想化的铅-闪烁体采样量能器。\n- $f_s$：总簇射能量 $E$ 中沉积在闪烁体层中的比例。\n- $E$：总簇射能量。\n- 测量链是线性的。\n- $N_{pe}$：在闪烁体中每沉积 1 $\\mathrm{GeV}$ 能量所产生的平均光电子数。\n- 能量估算器是无偏的。\n- 涨落仅由光电子计数统计引起，该过程遵循泊松过程。\n- 所有其他分辨率贡献项均可忽略不计。\n- 随机项系数 $a$ 是分数分辨率 $E^{-1/2}$ 标度的无量纲前置因子，其中 $E$ 的单位为 $\\mathrm{GeV}$。\n- 特定情况：$f_s = 0.3$。\n- 特定情况：$N_{pe} = 2000/\\mathrm{GeV}$。\n- 需要计算在 $E = 50\\,\\mathrm{GeV}$ 时的分数分辨率 $\\sigma_E/E$。\n- 最终数值答案必须四舍五入到四位有效数字，并表示为无量纲小数。\n\n**第2步：使用提取的已知条件进行验证**\n- **科学上成立：** 该问题使用了一个标准的、简化的量能器分辨率模型。光电子产生遵循泊松统计的假设是闪爍探测器物理学的基石。能量分辨率以随机项 $E^{-1/2}$ 标度进行参数化是高能物理和核物理中的标准做法。该问题在根本上是合理的。\n- **问题定义明确：** 所有必要的变量（$f_s, N_{pe}$）和条件（泊松统计，线性和无偏估算器）都已提供，以推导所需量（$a$ 和 $\\sigma_E/E$）的唯一解。\n- **客观性：** 该问题使用粒子物理仪器领域常见的精确技术语言陈述，没有主观或模糊的术语。\n\n**第3步：结论与行动**\n该问题在科学上是成立的、定义明确、客观，并且没有可识别的缺陷。因此，它被判定为**有效**。现在开始推导解答。\n\n### 推导与解答\n\n设 $E$ 为粒子的总入射能量。沉积在活性闪爍體層中的能量 $E_{\\text{scint}}$ 是总能量的一部分，比例为 $f_s$：\n$$\nE_{\\text{scint}} = f_s E\n$$\n闪烁体在其内部每沉积单位能量产生的光电子产额为 $N_{pe}$。因此，对于给定的簇射，平均光电子数 $\\langle n \\rangle$ 为：\n$$\n\\langle n \\rangle = N_{pe} E_{\\text{scint}} = N_{pe} f_s E\n$$\n问题陈述光电子的产生遵循泊松过程。泊松分布的一个基本性质是其方差等于其均值。因此，光电子数的方差 $\\sigma_n^2$ 为：\n$$\n\\sigma_n^2 = \\langle n \\rangle = N_{pe} f_s E\n$$\n光电子计数的标准差是方差的平方根：\n$$\n\\sigma_n = \\sqrt{N_{pe} f_s E}\n$$\n能量估算器 $\\hat{E}$ 是根据测得的光电子数 $n$ 构建的。它被指定为线性和无偏的。设估算器的形式为 $\\hat{E} = C \\cdot n$，其中 $C$ 是一个校准常数。无偏条件要求估算器的期望值等于真实能量，即 $\\langle \\hat{E} \\rangle = E$。\n$$\n\\langle \\hat{E} \\rangle = \\langle C \\cdot n \\rangle = C \\langle n \\rangle\n$$\n代入 $\\langle n \\rangle$ 的表达式：\n$$\n\\langle \\hat{E} \\rangle = C (N_{pe} f_s E)\n$$\n为了使其无偏，我们必须有 $C (N_{pe} f_s E) = E$，这给出了校准常数为：\n$$\nC = \\frac{1}{N_{pe} f_s}\n$$\n因此，总能量的估算器为 $\\hat{E} = \\frac{n}{N_{pe} f_s}$。能量测量的 不确定度 $\\sigma_E$ 是此估算器的标准差。方差 $\\sigma_E^2$ 使用标准误差传播公式求得：\n$$\n\\sigma_E^2 = \\text{Var}(\\hat{E}) = \\text{Var}\\left(\\frac{n}{N_{pe} f_s}\\right) = \\left(\\frac{1}{N_{pe} f_s}\\right)^2 \\text{Var}(n) = \\frac{\\sigma_n^2}{(N_{pe} f_s)^2}\n$$\n代入 $\\sigma_n^2 = N_{pe} f_s E$：\n$$\n\\sigma_E^2 = \\frac{N_{pe} f_s E}{(N_{pe} f_s)^2} = \\frac{E}{N_{pe} f_s}\n$$\n能量分辨率为 $\\sigma_E = \\sqrt{\\frac{E}{N_{pe} f_s}}$。分数能量分辨率为 $\\frac{\\sigma_E}{E}$：\n$$\n\\frac{\\sigma_E}{E} = \\frac{1}{E} \\sqrt{\\frac{E}{N_{pe} f_s}} = \\sqrt{\\frac{E}{E^2 N_{pe} f_s}} = \\frac{1}{\\sqrt{E \\cdot N_{pe} f_s}}\n$$\n这个表达式展示了随机项特有的 $E^{-1/2}$ 标度特性。标准参数化形式为 $\\frac{\\sigma_E}{E} = \\frac{a}{\\sqrt{E}}$，其中 $E$ 以 $\\mathrm{GeV}$ 为单位， $a$ 是一个无量纲系数。为了使这个比较严谨，设 $E_{\\text{GeV}}$ 是能量以 $\\mathrm{GeV}$ 为单位的数值，$\\mathcal{N}_{pe}$ 是 $N_{pe}$ 以 $(\\mathrm{GeV})^{-1}$ 为单位的数值。我们推导出的方程是：\n$$\n\\frac{\\sigma_E}{E} = \\frac{1}{\\sqrt{E_{\\text{GeV}} \\cdot \\mathcal{N}_{pe} \\cdot f_s}} = \\frac{1}{\\sqrt{\\mathcal{N}_{pe} f_s}} \\frac{1}{\\sqrt{E_{\\text{GeV}}}}\n$$\n通过将其与 $\\frac{\\sigma_E}{E} = \\frac{a}{\\sqrt{E_{\\text{GeV}}}}$ 进行比较，我们可以确定随机项系数 $a$：\n$$\na = \\frac{1}{\\sqrt{\\mathcal{N}_{pe} f_s}}\n$$\n使用给定的数值，$\\mathcal{N}_{pe} = 2000$ 和 $f_s = 0.3$：\n$$\na = \\frac{1}{\\sqrt{2000 \\times 0.3}} = \\frac{1}{\\sqrt{600}} = \\frac{1}{10\\sqrt{6}} \\approx 0.0408248\n$$\n四舍五入到四位有效数字，随机项系数为 $a = 0.04082$。$a$ 的单位隐含为 $\\sqrt{\\mathrm{GeV}}$，但问题要求的是无量纲前置因子，也就是这个数值。\n\n接下来，我们计算能量为 $E = 50\\,\\mathrm{GeV}$ 时的分数分辨率 $\\frac{\\sigma_E}{E}$。我们使用推导出的公式，其中 $E_{\\text{GeV}} = 50$：\n$$\n\\frac{\\sigma_E}{E} = \\frac{a}{\\sqrt{E_{\\text{GeV}}}} = \\frac{0.0408248...}{\\sqrt{50}}\n$$\n或者，使用完整的表达式：\n$$\n\\frac{\\sigma_E}{E} = \\frac{1}{\\sqrt{E_{\\text{GeV}} \\cdot \\mathcal{N}_{pe} \\cdot f_s}} = \\frac{1}{\\sqrt{50 \\times 2000 \\times 0.3}} = \\frac{1}{\\sqrt{30000}} = \\frac{1}{100\\sqrt{3}} \\approx 0.0057735\n$$\n四舍五入到四位有效数字，在 $50\\,\\mathrm{GeV}$ 时的分数分辨率为 $\\frac{\\sigma_E}{E} = 0.005774$。\n\n所要求的两个值是随机项系数 $a$ 和在 $E=50\\,\\mathrm{GeV}$ 时的分数分辨率 $\\frac{\\sigma_E}{E}$。", "answer": "$$\n\\boxed{\\begin{pmatrix} 0.04082  0.005774 \\end{pmatrix}}\n$$", "id": "3533695"}]}