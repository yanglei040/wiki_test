{"hands_on_practices": [{"introduction": "这项练习为设置上限奠定了统计学基础。通过分析最简单的非平凡情况——一个没有观测到任何事件的无背景实验——你将从频率学和贝叶斯两种角度推导新物理信号的上限。这项实践将阐明两种方法的核心逻辑，并揭示一个它们的结果恰好吻合的特殊情况 ([@problem_id:3533332])。", "problem": "一项高能物理研究中的计数实验被建模为泊松过程。预期事件数是未知信号产额和已知本底产额之和。设未知信号产额为 $\\mu \\geq 0$，已知本底产额为 $b \\geq 0$。观测到的事件数 $n$ 服从泊松概率质量函数 $P(n \\mid \\mu, b) = \\exp\\!\\left(-(\\mu + b)\\right)\\,(\\mu + b)^{n}/n!$。考虑一个信号区域产生 $n = 0$ 个观测事件且预期本底为 $b = 0$ 的情况。使用此模型并从泊松过程和置信区间构建的基本定义出发，完成以下任务：\n\n1. 使用Neyman构造法，在置信水平为 $1-\\alpha$ 时，推导 $\\mu$ 的经典频率学派单边上限。该单边区间的下端点固定为 $0$。提供上限关于 $\\alpha$ 的最终闭合形式表达式。\n\n2. 独立地，使用贝叶斯定理和来自相同模型的泊松似然，在 $\\mu \\geq 0$ 上为平坦的无信息先验下，推导 $\\mu$ 的贝叶斯 $1-\\alpha$ 上可信界。提供上界关于 $\\alpha$ 的最终闭合形式表达式。\n\n3. 比较上述两个结果，确定在这种特殊情况下，经典频率学派上限和贝叶斯上可信界是否一致。如果一致，请提供共同的闭合形式表达式。\n\n你的最终答案必须是仅含 $\\alpha$ 的单个闭合形式解析表达式。量 $\\mu$ 是无量纲的（事件计数），因此不需要单位说明。最终结果不需要进行数值舍入。", "solution": "首先根据所需标准对问题进行验证。\n\n### 步骤1：提取已知条件\n-   **模型**：计数实验被建模为泊松过程。\n-   **信号产额**：$\\mu \\geq 0$（未知）。\n-   **本底产额**：$b \\geq 0$（已知）。\n-   **总预期事件数**：$\\mu + b$。\n-   **观测事件数**：$n$。\n-   **概率质量函数 (PMF)**：$P(n \\mid \\mu, b) = \\exp(-(\\mu + b))\\,(\\mu + b)^{n}/n!$。\n-   **特定条件**：观测事件数 $n = 0$，预期本底 $b = 0$。\n-   **置信水平 (CL)**：$1-\\alpha$。\n-   **任务1（频率学派）**：使用Neyman构造法，在置信水平 $1-\\alpha$ 下推导 $\\mu$ 的单边上限，区间为 $[0, \\mu_{up}]$。\n-   **任务2（贝叶斯）**：在 $\\mu \\geq 0$ 上使用无信息的平坦先验，推导 $\\mu$ 的 $1-\\alpha$ 上可信界。\n-   **任务3（比较）**：比较结果，如果相同则提供共同的表达式。\n\n### 步骤2：使用提取的已知条件进行验证\n评估问题陈述的有效性。\n-   **科学依据**：该问题使用泊松分布，这是粒子物理学和其他领域中计数实验的标准且正确的统计模型。频率学派上限（Neyman构造法）和贝叶斯可信界的概念是统计推断中基础且完善的方法。该场景虽然简化（$b=0$, $n=0$），但代表了一个有效且重要的极限情况（一个没有观测到事件的“无本底”实验）。\n-   **适定性**：该问题定义明确，提供了所有必要信息：统计模型、具体数据、所需的置信/可信水平以及要使用的统计框架。问题精确，并能推导出唯一的解。\n-   **客观性**：语言清晰、正式，不含任何主观或基于观点的内容。\n\n该问题未违反任何无效性标准。它在科学上是合理的，陈述是正式的，信息是完整的，并提出了一个统计数据分析中非平凡但可解的问题。\n\n### 步骤3：结论与行动\n问题被判定为**有效**。现在开始推导解答。\n\n***\n\n### 1. 频率学派上限推导\n\n在置信水平为 $1-\\alpha$ 的经典频率学派单边上限 $\\mu_{up}$ 是基于 Neyman 原理构建的。对于一个单边区间 $[0, \\mu_{up}]$，该上限定义为参数 $\\mu$ 的一个值，在该值下，观测到与实际观测值 $n_{obs}$ 一样或更严格的结果的概率等于 $\\alpha$。在计数实验中，观测到的事件数越少，对信号的上限约束就越严格。\n\n给定观测事件数 $n_{obs}$，上限 $\\mu_{up}$ 是解以下方程的 $\\mu$ 值：\n$$P(n \\leq n_{obs} \\mid \\mu_{up}) = \\alpha$$\n\n问题指定了泊松模型。在给定条件 $b=0$ 的情况下，总预期事件数就是 $\\mu$。其概率质量函数为：\n$$P(n \\mid \\mu) = \\frac{\\exp(-\\mu) \\mu^n}{n!}$$\n\n问题指出观测到的事件数是 $n_{obs} = 0$。将此代入上限的定义方程，我们得到：\n$$P(n \\leq 0 \\mid \\mu_{up}) = \\alpha$$\n对于泊松分布，$n \\leq 0$ 唯一可能发生的情况是 $n=0$。因此，方程简化为：\n$$P(n = 0 \\mid \\mu_{up}) = \\alpha$$\n\n使用 $n=0$ 的泊松概率质量函数：\n$$P(n=0 \\mid \\mu_{up}) = \\frac{\\exp(-\\mu_{up}) \\mu_{up}^0}{0!} = \\exp(-\\mu_{up})$$\n这里我们用到了 $\\mu_{up}^0 = 1$ 和 $0! = 1$。\n\n令其等于 $\\alpha$：\n$$\\exp(-\\mu_{up}) = \\alpha$$\n\n为了解出 $\\mu_{up}$，我们对两边取自然对数：\n$$-\\mu_{up} = \\ln(\\alpha)$$\n$$\\mu_{up} = -\\ln(\\alpha)$$\n这就是 $\\mu$ 的经典频率学派单边上限。\n\n### 2. 贝叶斯上可信界推导\n\n贝叶斯方法始于未知参数 $\\mu$ 的一个先验概率分布，记为 $\\pi(\\mu)$。通过贝叶斯定理，使用观测数据 $n_{obs}$ 将其更新为后验概率分布 $P(\\mu \\mid n_{obs})$。一个 $1-\\alpha$ 可信区间是参数空间中的一个区间，它包含了总后验概率的 $1-\\alpha$。对于一个单边上界 $\\mu_{up}$，区间为 $[0, \\mu_{up}]$，并且必须满足：\n$$\\int_0^{\\mu_{up}} P(\\mu \\mid n_{obs}) \\, d\\mu = 1-\\alpha$$\n\n贝叶斯定理表述为：\n$$P(\\mu \\mid n) = \\frac{P(n \\mid \\mu) \\pi(\\mu)}{\\int_0^{\\infty} P(n \\mid \\mu') \\pi(\\mu') \\, d\\mu'}$$\n\n问题提供了以下信息：\n-   **似然函数**，$P(n \\mid \\mu)$：$b=0$ 的泊松分布，所以 $P(n \\mid \\mu) = \\frac{\\exp(-\\mu) \\mu^n}{n!}$。\n-   **先验分布**，$\\pi(\\mu)$：对于 $\\mu \\geq 0$ 是平坦的无信息先验。我们可以将其写作 $\\pi(\\mu) = C$（对于 $\\mu \\geq 0$），其中 $C$ 是一个常数。由于这个常数会被消掉，我们可以设 $C=1$。\n-   **数据**，$n_{obs} = 0$。\n\n首先，我们构造贝叶斯定理的分子（未归一化的后验）：\n$$P(n=0 \\mid \\mu) \\pi(\\mu) = \\left( \\frac{\\exp(-\\mu) \\mu^0}{0!} \\right) \\cdot 1 = \\exp(-\\mu)$$\n\n接下来，我们计算分母，也就是归一化常数（也称为边缘似然或证据）：\n$$\\int_0^{\\infty} P(n=0 \\mid \\mu') \\pi(\\mu') \\, d\\mu' = \\int_0^{\\infty} \\exp(-\\mu') \\, d\\mu'$$\n该积分的计算结果为：\n$$\\int_0^{\\infty} \\exp(-\\mu') \\, d\\mu' = [-\\exp(-\\mu')]_0^{\\infty} = (-\\lim_{x \\to \\infty} \\exp(-x)) - (-\\exp(0)) = 0 - (-1) = 1$$\n\n因此，在给定 $n=0$ 的情况下，$\\mu$ 的归一化后验分布是：\n$$P(\\mu \\mid n=0) = \\frac{\\exp(-\\mu)}{1} = \\exp(-\\mu) \\quad \\text{对于 } \\mu \\geq 0$$\n这个后验分布是一个速率参数为1的指数分布。\n\n现在，我们通过将后验分布从 $0$ 积分到 $\\mu_{up}$ 并将结果设为 $1-\\alpha$ 来找到上界 $\\mu_{up}$：\n$$\\int_0^{\\mu_{up}} \\exp(-\\mu) \\, d\\mu = 1-\\alpha$$\n进行积分：\n$$[-\\exp(-\\mu)]_0^{\\mu_{up}} = 1-\\alpha$$\n$$(-\\exp(-\\mu_{up})) - (-\\exp(0)) = 1-\\alpha$$\n$$-\\exp(-\\mu_{up}) + 1 = 1-\\alpha$$\n\n求解 $\\exp(-\\mu_{up})$：\n$$-\\exp(-\\mu_{up}) = -\\alpha$$\n$$\\exp(-\\mu_{up}) = \\alpha$$\n\n最后，求解 $\\mu_{up}$：\n$$-\\mu_{up} = \\ln(\\alpha)$$\n$$\\mu_{up} = -\\ln(\\alpha)$$\n这就是 $\\mu$ 的贝叶斯 $1-\\alpha$ 上可信界。\n\n### 3. 结果比较\n\n在置信水平为 $1-\\alpha$ 时，为 $n=0$ 和 $b=0$ 推导出的经典频率学派单边上限为：\n$$\\mu_{up}^{\\text{freq}} = -\\ln(\\alpha)$$\n\n在 $1-\\alpha$ 可信度下，为 $n=0$、$b=0$ 且在 $\\mu \\geq 0$ 上采用平坦先验推导出的贝叶斯单边上可信界为：\n$$\\mu_{up}^{\\text{Bayes}} = -\\ln(\\alpha)$$\n\n两个结果是相同的。这是一个频率学派和贝叶斯方法结果恰好一致的特殊但值得注意的案例。因此，上限/界的共同闭合形式表达式是 $-\\ln(\\alpha)$。", "answer": "$$\\boxed{-\\ln(\\alpha)}$$", "id": "3533332"}, {"introduction": "真实的物理分析常常依赖强大的渐近近似来处理复杂模型。本练习将介绍在高能物理领域广泛使用的 $CL_s$ 方法和Asimov数据集的概念，以推导实验的预期灵敏度。你将使用轮廓似然比这一关键检验统计量，来求解预期的中位数上限 ([@problem_id:3533347])，这将为你提供一个设计和解读现代高能物理实验搜索所必需的工具。", "problem": "使用剖面似然比检验统计量 $ q_{\\mu} \\equiv -2 \\ln \\lambda(\\mu) $ 对单参数信号强度假设 $ \\mu \\ge 0 $ 进行检验，其中 $ \\lambda(\\mu) $ 是根据数据和讨厌参数 $ \\boldsymbol{\\theta} $ 的似然 $ L(\\mu,\\boldsymbol{\\theta}) $ 构建的剖面似然比。在大样本情形下，假设对于单边检验，Wald展开成立：\n- 当 $ \\hat{\\mu} \\le \\mu $ 时，$ q_{\\mu} \\approx \\frac{(\\mu - \\hat{\\mu})^{2}}{\\sigma^{2}} $，\n- 当 $ \\hat{\\mu}  \\mu $ 时，$ q_{\\mu} = 0 $，\n其中 $ \\hat{\\mu} $ 是 $ \\mu $ 的最大似然估计量，$ \\sigma $ 是在真实参数值处计算得到的 $ \\hat{\\mu} $ 的渐近标准差。\n\n进一步假设，在数据生成（真实）的信号强度为 $ \\mu' $ 的情况下，$ \\hat{\\mu} \\sim \\mathcal{N}(\\mu', \\sigma^{2}) $，并且在考虑上述单边截断的情况下，$ q_{\\mu} $ 的分布可由自由度为一、非中心参数为 $ \\Lambda = \\frac{(\\mu - \\mu')^{2}}{\\sigma^{2}} $ 的非中心卡方分布很好地近似。\n\n定义修正置信水平 (CLs) 为\n$$\nCL_{s}(\\mu) \\equiv \\frac{p_{\\mu}}{1 - p_{b}},\n$$\n其中 $ p_{\\mu} = \\Pr(q_{\\mu} \\ge q_{\\mu,\\text{obs}} \\mid \\mu \\text{ is true}) $ 和 $ p_{b} = \\Pr(q_{\\mu} \\ge q_{\\mu,\\text{obs}} \\mid \\mu'=0) $ 分别是同一检验统计量 $ q_{\\mu} $ 在信号假设和背景（$ \\mu'=0 $）假设下的尾部概率。\n\n为了构建预期上限中位数，将观测到的检验统计量设置为其在纯背景假设下的Asimov值（Asimov数据集定义为等于模型期望的理想化数据集，它确定性地产生 $ \\hat{\\mu}_{A} = \\mu' $ 和 $ q_{\\mu,A} = -2 \\ln \\lambda_{A}(\\mu) $）。用 $ \\sigma $ 表示在 $ \\mu'=0 $ 处计算得到的 $ \\hat{\\mu} $ 的Asimov标准差。\n\n仅使用上述假设，推导并以闭合形式求解方程 $ CL_{s}(\\mu) = \\alpha $，得到预期上限中位数 $ \\mu_{\\text{up}} $。请用 $ \\sigma $、$ \\alpha $、标准正态累积分布函数 $ \\Phi(\\cdot) $ 及其函数反函数 $ \\Phi^{-1}(\\cdot) $ 来表示你的最终答案。无需进行数值计算。将最终答案作为一个单一的解析表达式提供。由于 $ \\mu $ 是无量纲的，因此不需要物理单位。", "solution": "首先对问题陈述进行验证。\n\n### 步骤1：提取已知条件\n- 单参数信号强度假设 $ \\mu \\ge 0 $。\n- 剖面似然比检验统计量为 $ q_{\\mu} \\equiv -2 \\ln \\lambda(\\mu) $，来自似然 $ L(\\mu,\\boldsymbol{\\theta}) $。\n- 在大样本情形下，单边检验的Wald展开成立：\n  - 当 $ \\hat{\\mu} \\le \\mu $ 时，$ q_{\\mu} \\approx \\frac{(\\mu - \\hat{\\mu})^{2}}{\\sigma^{2}} $。\n  - 当 $ \\hat{\\mu}  \\mu $ 时，$ q_{\\mu} = 0 $。\n- $ \\hat{\\mu} $ 是 $ \\mu $ 的最大似然估计量。\n- 在真实信号强度为 $ \\mu' $ 的情况下，估计量的分布为 $ \\hat{\\mu} \\sim \\mathcal{N}(\\mu', \\sigma^{2}) $。\n- 修正置信水平 (CLs) 定义为 $CL_{s}(\\mu) \\equiv \\frac{p_{\\mu}}{1 - p_{b}}$。\n- $ p_{\\mu} = \\Pr(q_{\\mu} \\ge q_{\\mu,\\text{obs}} \\mid \\mu \\text{ is true}) $，这意味着真实信号强度为 $ \\mu' = \\mu $。\n- $ p_{b} = \\Pr(q_{\\mu} \\ge q_{\\mu,\\text{obs}} \\mid \\mu'=0) $。\n- 对于预期上限中位数，观测到的检验统计量 $ q_{\\mu,\\text{obs}} $ 被设置为纯背景假设（$ \\mu'=0 $）下的Asimov值。\n- Asimov数据集的定义使得估计量取其期望值，$ \\hat{\\mu}_{A} = \\mu' $。\n- $ \\sigma $ 是在 $ \\mu'=0 $ 处计算的 $ \\hat{\\mu} $ 的Asimov标准差。\n- 任务是以闭合形式求解方程 $ CL_{s}(\\mu) = \\alpha $，得到预期上限中位数 $ \\mu_{\\text{up}} $。\n\n### 步骤2：使用提取的已知条件进行验证\n- **科学依据充分：** 该问题使用了高能物理统计学中为新物理信号设置上限的标准、成熟的概念和方法。剖面似然比、检验统计量 $ q_{\\mu} $、其渐近行为、CLs方法以及Asimov数据集都是该领域的基础工具。该问题在科学上和数学上都是合理的。\n- **提法明确：** 该问题提供了一套完整的定义和假设。它明确指明了目标：为一个特定变量求解一个特定方程。在指定的框架内，不存在会妨碍得到唯一解的歧义。\n- **客观性：** 语言正式、精确，没有任何主观或推测性内容。\n- **无缺陷：** 该问题没有违反任何指定的无效标准。它在事实上是成立的，与主题直接相关，内部一致且完整，基于一个标准的理论近似（Asimov），结构良好，并且是一个非平凡的推导。\n\n### 步骤3：结论与行动\n该问题有效。将提供完整的解答。\n\n### 上限的推导\n\n目标是找到满足方程 $ CL_{s}(\\mu) = \\alpha $ 的 $ \\mu $ 值，记为 $ \\mu_{\\text{up}} $。这需要计算 $ p_{\\mu} $ 和 $ p_{b} $ 这两个量。\n\n首先，我们必须确定“观测到的”检验统计量 $ q_{\\mu, \\text{obs}} $ 的值。问题指明，对于预期上限中位数，观测值取为在纯背景假设（$ \\mu' = 0 $）下生成的Asimov数据集。根据Asimov数据集的定义，估计量取其期望值，所以“观测到的”最佳拟合信号强度为 $ \\hat{\\mu}_{\\text{obs}} = \\mu' = 0 $。\n\n检验统计量 $ q_{\\mu} $ 是针对一个假设的信号强度 $ \\mu  0 $ 进行评估的。我们在 $ q_{\\mu} $ 的公式中使用Asimov观测值 $ \\hat{\\mu}_{\\text{obs}} = 0 $。由于我们正在设置上限，我们关心的是 $\\mu  0$ 的情况，这确保了 $ \\hat{\\mu}_{\\text{obs}} = 0 \\le \\mu $。这属于 $ q_{\\mu} $ 定义的第一种情况，得到：\n$$\nq_{\\mu, \\text{obs}} = \\frac{(\\mu - \\hat{\\mu}_{\\text{obs}})^{2}}{\\sigma^{2}} = \\frac{(\\mu - 0)^{2}}{\\sigma^{2}} = \\frac{\\mu^{2}}{\\sigma^{2}}\n$$\n这个 $ q_{\\mu, \\text{obs}} $ 的值适用于计算 $ \\mu $ 上限的整个过程。\n\n接下来，我们计算在纯背景假设下的 p 值，$ p_{b} = \\Pr(q_{\\mu} \\ge q_{\\mu,\\text{obs}} \\mid \\mu'=0) $。\n在此假设下，估计量的分布为 $ \\hat{\\mu} \\sim \\mathcal{N}(0, \\sigma^{2}) $。\n$$\np_{b} = \\Pr\\left(q_{\\mu} \\ge \\frac{\\mu^{2}}{\\sigma^{2}} \\mid \\mu' = 0\\right)\n$$\n为了使不等式在右侧非零的情况下成立，$ q_{\\mu} $ 必须非零。这要求 $ \\hat{\\mu} \\le \\mu $ 并且 $ q_{\\mu} = \\frac{(\\mu - \\hat{\\mu})^{2}}{\\sigma^{2}} $。我们需要评估的条件是：\n$$\n\\frac{(\\mu - \\hat{\\mu})^{2}}{\\sigma^{2}} \\ge \\frac{\\mu^{2}}{\\sigma^{2}} \\quad \\text{和} \\quad \\hat{\\mu} \\le \\mu\n$$\n第一个不等式化简为 $ |\\mu - \\hat{\\mu}| \\ge |\\mu| $。由于我们在寻求一个上限，所以 $ \\mu  0 $，因此不等式为 $ |\\mu - \\hat{\\mu}| \\ge \\mu $。这给出了两种可能性：\n$ 1.  \\mu - \\hat{\\mu} \\ge \\mu \\implies -\\hat{\\mu} \\ge 0 \\implies \\hat{\\mu} \\le 0 $。\n$ 2.  \\mu - \\hat{\\mu} \\le -\\mu \\implies 2\\mu \\le \\hat{\\mu} $。\n所以，第一个不等式对应于事件 $ (\\hat{\\mu} \\le 0) \\cup (\\hat{\\mu} \\ge 2\\mu) $。我们必须将此事件与条件 $ \\hat{\\mu} \\le \\mu $ 取交集。\n- $ (\\hat{\\mu} \\le 0) $ 和 $ (\\hat{\\mu} \\le \\mu) $ 的交集是 $ (\\hat{\\mu} \\le 0) $，因为 $ \\mu  0 $。\n- 对于 $ \\mu  0 $，$ (\\hat{\\mu} \\ge 2\\mu) $ 和 $ (\\hat{\\mu} \\le \\mu) $ 的交集是空集。\n因此，组合条件化简为只有 $ \\hat{\\mu} \\le 0 $。因此概率 $ p_{b} $ 为：\n$$\np_{b} = \\Pr(\\hat{\\mu} \\le 0 \\mid \\mu'=0)\n$$\n由于 $ \\hat{\\mu} \\sim \\mathcal{N}(0, \\sigma^{2}) $，我们可以对该变量进行标准化。令 $ Z = \\hat{\\mu}/\\sigma \\sim \\mathcal{N}(0, 1) $。\n$$\np_{b} = \\Pr\\left(\\frac{\\hat{\\mu}}{\\sigma} \\le \\frac{0}{\\sigma}\\right) = \\Pr(Z \\le 0) = \\Phi(0) = \\frac{1}{2}\n$$\n其中 $ \\Phi(\\cdot) $ 是标准正态分布的累积分布函数 (CDF)。\n\n现在，我们计算在信号加背景假设下的 p 值，$ p_{\\mu} = \\Pr(q_{\\mu} \\ge q_{\\mu,\\text{obs}} \\mid \\mu'=\\mu) $。\n在此假设下，估计量的分布为 $ \\hat{\\mu} \\sim \\mathcal{N}(\\mu, \\sigma^{2}) $。条件 $ q_{\\mu} \\ge q_{\\mu, \\text{obs}} $ 与之前分析的条件相同，化简为事件 $ \\hat{\\mu} \\le 0 $。\n因此概率 $ p_{\\mu} $ 为：\n$$\np_{\\mu} = \\Pr(\\hat{\\mu} \\le 0 \\mid \\mu'=\\mu)\n$$\n对变量 $ \\hat{\\mu} $ 进行标准化，它现在服从 $ \\mathcal{N}(\\mu, \\sigma^{2}) $ 分布：\n$$\np_{\\mu} = \\Pr\\left(\\frac{\\hat{\\mu} - \\mu}{\\sigma} \\le \\frac{0 - \\mu}{\\sigma}\\right) = \\Pr\\left(Z \\le -\\frac{\\mu}{\\sigma}\\right) = \\Phi\\left(-\\frac{\\mu}{\\sigma}\\right)\n$$\n使用正态CDF的对称性 $ \\Phi(-x) = 1 - \\Phi(x) $，这也可以写作 $ p_{\\mu} = 1 - \\Phi(\\mu/\\sigma) $。\n\n最后，我们将 $ p_{b} $ 和 $ p_{\\mu} $ 代入 $ CL_{s} $ 方程，以求出上限 $ \\mu_{\\text{up}} $：\n$$\nCL_{s}(\\mu_{\\text{up}}) = \\frac{p_{\\mu}}{1 - p_{b}} = \\alpha\n$$\n$$\n\\frac{\\Phi\\left(-\\frac{\\mu_{\\text{up}}}{\\sigma}\\right)}{1 - \\frac{1}{2}} = \\alpha\n$$\n$$\n\\frac{\\Phi\\left(-\\frac{\\mu_{\\text{up}}}{\\sigma}\\right)}{\\frac{1}{2}} = \\alpha\n$$\n$$\n2 \\Phi\\left(-\\frac{\\mu_{\\text{up}}}{\\sigma}\\right) = \\alpha\n$$\n$$\n\\Phi\\left(-\\frac{\\mu_{\\text{up}}}{\\sigma}\\right) = \\frac{\\alpha}{2}\n$$\n为了解出 $ \\mu_{\\text{up}} $，我们对等式两边应用正态CDF的反函数 $ \\Phi^{-1}(\\cdot) $：\n$$\n-\\frac{\\mu_{\\text{up}}}{\\sigma} = \\Phi^{-1}\\left(\\frac{\\alpha}{2}\\right)\n$$\n$$\n\\mu_{\\text{up}} = -\\sigma \\Phi^{-1}\\left(\\frac{\\alpha}{2}\\right)\n$$\n这是一个有效的闭合形式解。一个常见的约定是使用正态分布的上尾来表示结果。使用恒等式 $ \\Phi^{-1}(x) = -\\Phi^{-1}(1-x) $：\n$$\n\\mu_{\\text{up}} = -\\sigma \\left[ - \\Phi^{-1}\\left(1 - \\frac{\\alpha}{2}\\right) \\right] = \\sigma \\Phi^{-1}\\left(1 - \\frac{\\alpha}{2}\\right)\n$$\n两个表达式是等价的。我们将提供后者作为最终答案。", "answer": "$$\n\\boxed{\\sigma \\Phi^{-1}\\left(1 - \\frac{\\alpha}{2}\\right)}\n$$", "id": "3533347"}, {"introduction": "通过合并来自多个测量通道的数据，通常可以增强寻找新物理的统计效力。这个动手编程问题要求你实现这样一个组合分析，使用协方差矩阵正确处理相关的系统不确定性。通过计算组合上限并研究相关性错误设定所带来的影响 ([@problem_id:3533325])，你将在构建实际统计模型以及理解系统不确定性对最终结果的影响方面获得宝贵的实践经验。", "problem": "在计算高能物理的背景下，给定一个多通道组合问题，用于为一个非负信号强度参数 $\\mu$ 设置上限。该组合涉及 $3$ 个统计独立的计数通道，其测量值被近似为联合高斯分布。每个通道 $i$ 提供一个标量可观测量 $y_i$，其模型为 $y_i = \\mu s_i + b_i + \\epsilon_i$，其中 $s_i$ 是单位信号强度的预期信号产额，$b_i$ 是标称本底期望，而涨落矢量 $\\boldsymbol{\\epsilon}$ 服从一个多元正态分布 $\\mathcal{N}(\\boldsymbol{0}, \\boldsymbol{\\Sigma})$。协方差 $\\boldsymbol{\\Sigma}$ 是一个统计分量和一个具有块结构的系统分量之和。使用以下基本要素作为您推导的起点：\n\n- 均值为 $\\boldsymbol{\\mu}_{y}(\\mu) = \\mu \\boldsymbol{s} + \\boldsymbol{b}$ 且协方差为 $\\boldsymbol{\\Sigma}$ 的多元正态模型的似然函数，以及相应的最大似然方法。\n- 协方差已知的线性模型的广义最小二乘推断。\n- 带有物理约束 $\\mu \\ge 0$ 的单个感兴趣参数 $\\mu$ 的剖面似然比的大样本渐近行为（瓦尔德近似）。\n- 置信度为 $1 - \\alpha$（其中 $\\alpha = 0.05$）的单边上限的置信水平（CL）反演。\n\n将 $3$ 通道输入明确定义如下：\n\n- 信号期望矢量 $\\boldsymbol{s} = (s_1, s_2, s_3) = (3.0, 2.0, 1.5)$。\n- 本底期望矢量 $\\boldsymbol{b} = (b_1, b_2, b_3) = (25.0, 18.0, 12.0)$。\n- 统计协方差（泊松近似）$\\boldsymbol{\\Sigma}_{\\text{stat}} = \\mathrm{diag}(b_1, b_2, b_3)$。\n- 由块结构定义的系统协方差 $\\boldsymbol{\\Sigma}_{\\text{sys}}$：\n  - 通道 $1$ 和 $2$ 共享一个部分相关的讨厌参数，其分数尺度为 $f_{12} = 0.08$，相关系数为 $\\rho_{12} = 0.7$。这对 $i \\in \\{1,2\\}$ 的对角线元素贡献 $f_{12}^2 b_i^2$，对非对角的 $\\{1,2\\}$ 块贡献 $\\rho_{12} f_{12}^2 b_1 b_2$。\n  - 通道 $3$ 有一个独立的讨厌参数，其分数尺度为 $f_3 = 0.10$，仅对 $\\{3,3\\}$ 元贡献 $f_3^2 b_3^2$。\n- 总协方差为 $\\boldsymbol{\\Sigma} = \\boldsymbol{\\Sigma}_{\\text{stat}} + \\boldsymbol{\\Sigma}_{\\text{sys}}$。\n\n相关性错误设定被建模为仅在通道 $1$ 和 $2$ 之间的系统协方差块的非对角元膨胀。对于一个标量膨胀因子 $\\kappa \\ge 0$，错误设定的协方差为\n$$\n\\boldsymbol{\\Sigma}(\\kappa) = \\boldsymbol{\\Sigma}_{\\text{stat}} + \\boldsymbol{\\Sigma}_{\\text{sys}}(\\kappa),\n\\quad\n\\boldsymbol{\\Sigma}_{\\text{sys}}(\\kappa)_{12} = \\boldsymbol{\\Sigma}_{\\text{sys}}(\\kappa)_{21} = \\kappa \\rho_{12} f_{12}^2 b_1 b_2,\n$$\n所有对角元相对于 $\\boldsymbol{\\Sigma}_{\\text{sys}}$ 保持不变，所有其他非对角元等于 $0$。\n\n假设观测数据矢量等于标称本底期望（阿西莫夫数据集），即 $\\boldsymbol{y} = \\boldsymbol{b}$。从上述基本要素出发，从第一性原理推导：\n\n- 通过最大化高斯似然函数得到的 $\\mu$ 的估计量（不要假设任何预先提供的公式）。\n- 在已知 $\\boldsymbol{\\Sigma}(\\kappa)$ 的模型下，估计量的抽样方差。\n- 通过对带有物理约束 $\\mu \\ge 0$ 的相应单边瓦尔德检验进行渐近反演，得到的 $\\mu$ 的单边 $95$ 置信水平（CL）上限。\n\n您必须在一个完整的程序中实现这些推导，该程序：\n\n- 为每个提供的 $\\kappa$ 测试值构建 $\\boldsymbol{\\Sigma}(\\kappa)$。\n- 使用推导出的表达式计算 $\\mu$ 在 $95$ 置信水平下的组合上限。\n- 使用 $\\alpha = 0.05$ 作为置信水平。\n- 将所有量视为无量纲；不需要物理单位。\n- 将结果输出为小数点后保留 $6$ 位的小数浮点数。\n\n测试套件：\n\n- 案例 $1$ (标准情况): $\\kappa = 1.0$。\n- 案例 $2$ (缩减): $\\kappa = 0.5$。\n- 案例 $3$ (无相关性): $\\kappa = 0.0$。\n- 案例 $4$ (在强相关边缘附近膨胀但仍保持正定): $\\kappa = 1.3$。\n\n最终输出格式：\n\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如，$\\texttt{[result1,result2,result3,result4]}$），结果的顺序与上面列出的测试案例相同。", "solution": "该问题要求从三个测量通道的组合中，推导并计算信号强度参数 $\\mu$ 的单边 $95\\%$ 置信水平（CL）上限。推导必须从第一性原理出发，即多元高斯似然、广义最小二乘法，以及似然估计量的渐近性质（瓦尔德近似）。\n\n设测量矢量为 $\\boldsymbol{y} = (y_1, y_2, y_3)^T$。统计模型由下式给出\n$$\n\\boldsymbol{y} = \\mu \\boldsymbol{s} + \\boldsymbol{b} + \\boldsymbol{\\epsilon},\n$$\n其中 $\\boldsymbol{s}$ 是信号期望矢量，$\\boldsymbol{b}$ 是本底期望矢量，$\\boldsymbol{\\epsilon}$ 是随机涨落矢量。涨落被建模为均值为零、协方差矩阵为 $\\boldsymbol{\\Sigma}$ 的多元正态分布，即 $\\boldsymbol{\\epsilon} \\sim \\mathcal{N}(\\boldsymbol{0}, \\boldsymbol{\\Sigma})$。因此，可观测量 $\\boldsymbol{y}$ 的分布为 $\\boldsymbol{y} \\sim \\mathcal{N}(\\mu \\boldsymbol{s} + \\boldsymbol{b}, \\boldsymbol{\\Sigma})$。\n\n### 第 1 部分：$\\mu$ 的最大似然估计量的推导\n\n似然函数 $L(\\mu)$ 是在观测数据 $\\boldsymbol{y}$ 处取值的多元正态分布的概率密度函数，并被视为参数 $\\mu$ 的函数：\n$$\nL(\\mu | \\boldsymbol{y}) = \\frac{1}{(2\\pi)^{3/2} |\\boldsymbol{\\Sigma}|^{1/2}} \\exp\\left(-\\frac{1}{2} (\\boldsymbol{y} - (\\mu \\boldsymbol{s} + \\boldsymbol{b}))^T \\boldsymbol{\\Sigma}^{-1} (\\boldsymbol{y} - (\\mu \\boldsymbol{s} + \\boldsymbol{b}))\\right).\n$$\n为求最大似然估计量（MLE）$\\hat{\\mu}$，我们最大化 $L(\\mu)$。这等价于最大化对数似然函数 $\\ln L(\\mu)$，且后者更为方便：\n$$\n\\ln L(\\mu) = C - \\frac{1}{2} (\\boldsymbol{y} - \\boldsymbol{b} - \\mu \\boldsymbol{s})^T \\boldsymbol{\\Sigma}^{-1} (\\boldsymbol{y} - \\boldsymbol{b} - \\mu \\boldsymbol{s}),\n$$\n其中 $C = -\\frac{3}{2}\\ln(2\\pi) - \\frac{1}{2}\\ln|\\boldsymbol{\\Sigma}|$ 是一个与 $\\mu$ 无关的常数。最大化 $\\ln L(\\mu)$ 等价于最小化二次项，即广义卡方函数 $\\chi^2(\\mu)$：\n$$\n\\chi^2(\\mu) = (\\boldsymbol{d} - \\mu\\boldsymbol{s})^T \\boldsymbol{\\Sigma}^{-1} (\\boldsymbol{d} - \\mu\\boldsymbol{s}),\n$$\n其中我们定义 $\\boldsymbol{d} = \\boldsymbol{y} - \\boldsymbol{b}$。将此二次型按 $\\mu$ 展开：\n$$\n\\chi^2(\\mu) = \\boldsymbol{d}^T \\boldsymbol{\\Sigma}^{-1} \\boldsymbol{d} - 2\\mu \\boldsymbol{s}^T \\boldsymbol{\\Sigma}^{-1} \\boldsymbol{d} + \\mu^2 \\boldsymbol{s}^T \\boldsymbol{\\Sigma}^{-1} \\boldsymbol{s}.\n$$\n为求得使 $\\chi^2(\\mu)$ 最小化的 $\\mu$ 值，我们计算其关于 $\\mu$ 的导数并令其为零：\n$$\n\\frac{d\\chi^2}{d\\mu} = -2\\boldsymbol{s}^T \\boldsymbol{\\Sigma}^{-1} \\boldsymbol{d} + 2\\mu \\boldsymbol{s}^T \\boldsymbol{\\Sigma}^{-1} \\boldsymbol{s} = 0.\n$$\n求解 $\\mu$ 可得无约束的最大似然估计量 $\\hat{\\mu}$：\n$$\n\\hat{\\mu} = \\frac{\\boldsymbol{s}^T \\boldsymbol{\\Sigma}^{-1} \\boldsymbol{d}}{\\boldsymbol{s}^T \\boldsymbol{\\Sigma}^{-1} \\boldsymbol{s}} = \\frac{\\boldsymbol{s}^T \\boldsymbol{\\Sigma}^{-1} (\\boldsymbol{y} - \\boldsymbol{b})}{\\boldsymbol{s}^T \\boldsymbol{\\Sigma}^{-1} \\boldsymbol{s}}.\n$$\n这就是线性模型 $\\boldsymbol{d} = \\mu \\boldsymbol{s} + \\boldsymbol{\\epsilon}$ 的著名广义最小二乘（GLS）估计量。\n\n### 第 2 部分：$\\hat{\\mu}$ 的抽样方差的推导\n\n估计量 $\\hat{\\mu}$ 是随机变量 $\\boldsymbol{y}$ 的线性函数。其抽样方差 $\\mathrm{Var}(\\hat{\\mu}) = \\sigma_{\\hat{\\mu}}^2$ 可以使用随机矢量线性变换的性质来计算。我们注意到 $\\boldsymbol{s}$、$\\boldsymbol{b}$ 和 $\\boldsymbol{\\Sigma}$ 是常数。\n$$\n\\hat{\\mu} = \\frac{\\boldsymbol{s}^T \\boldsymbol{\\Sigma}^{-1}}{\\boldsymbol{s}^T \\boldsymbol{\\Sigma}^{-1} \\boldsymbol{s}} \\boldsymbol{y} - \\frac{\\boldsymbol{s}^T \\boldsymbol{\\Sigma}^{-1} \\boldsymbol{b}}{\\boldsymbol{s}^T \\boldsymbol{\\Sigma}^{-1} \\boldsymbol{s}}.\n$$\n$\\hat{\\mu}$ 的方差仅取决于含 $\\boldsymbol{y}$ 的项：\n$$\n\\sigma_{\\hat{\\mu}}^2 = \\mathrm{Var}\\left(\\frac{\\boldsymbol{s}^T \\boldsymbol{\\Sigma}^{-1}}{\\boldsymbol{s}^T \\boldsymbol{\\Sigma}^{-1} \\boldsymbol{s}} \\boldsymbol{y}\\right).\n$$\n使用规则 $\\mathrm{Var}(\\boldsymbol{A}\\boldsymbol{y}) = \\boldsymbol{A} \\mathrm{Cov}(\\boldsymbol{y}) \\boldsymbol{A}^T$，其中 $\\boldsymbol{A} = \\frac{\\boldsymbol{s}^T \\boldsymbol{\\Sigma}^{-1}}{\\boldsymbol{s}^T \\boldsymbol{\\Sigma}^{-1} \\boldsymbol{s}}$ 且 $\\mathrm{Cov}(\\boldsymbol{y}) = \\boldsymbol{\\Sigma}$：\n$$\n\\sigma_{\\hat{\\mu}}^2 = \\left(\\frac{\\boldsymbol{s}^T \\boldsymbol{\\Sigma}^{-1}}{\\boldsymbol{s}^T \\boldsymbol{\\Sigma}^{-1} \\boldsymbol{s}}\\right) \\boldsymbol{\\Sigma} \\left(\\frac{\\boldsymbol{s}^T \\boldsymbol{\\Sigma}^{-1}}{\\boldsymbol{s}^T \\boldsymbol{\\Sigma}^{-1} \\boldsymbol{s}}\\right)^T = \\frac{1}{(\\boldsymbol{s}^T \\boldsymbol{\\Sigma}^{-1} \\boldsymbol{s})^2} (\\boldsymbol{s}^T \\boldsymbol{\\Sigma}^{-1}) \\boldsymbol{\\Sigma} (\\boldsymbol{\\Sigma}^{-1}\\boldsymbol{s}).\n$$\n由于 $\\boldsymbol{\\Sigma}$ 是对称的，因此 $(\\boldsymbol{s}^T \\boldsymbol{\\Sigma}^{-1})^T = \\boldsymbol{\\Sigma}^{-T}\\boldsymbol{s} = \\boldsymbol{\\Sigma}^{-1}\\boldsymbol{s}$。化简表达式：\n$$\n\\sigma_{\\hat{\\mu}}^2 = \\frac{\\boldsymbol{s}^T \\boldsymbol{\\Sigma}^{-1} \\boldsymbol{s}}{(\\boldsymbol{s}^T \\boldsymbol{\\Sigma}^{-1} \\boldsymbol{s})^2} = \\frac{1}{\\boldsymbol{s}^T \\boldsymbol{\\Sigma}^{-1} \\boldsymbol{s}}.\n$$\n因此，估计量的标准差为 $\\sigma_{\\hat{\\mu}} = (\\boldsymbol{s}^T \\boldsymbol{\\Sigma}^{-1} \\boldsymbol{s})^{-1/2}$。\n\n### 第 3 部分：单边上限的推导\n\n我们使用瓦尔德近似，该近似指出，对于大样本，最大似然估计量 $\\hat{\\mu}$ 近似服从以真实值 $\\mu_{\\text{true}}$ 为中心、方差为 $\\sigma_{\\hat{\\mu}}^2$ 的正态分布：$\\hat{\\mu} \\sim \\mathcal{N}(\\mu_{\\text{true}}, \\sigma_{\\hat{\\mu}}^2)$。\n\n为了在置信水平 $1-\\alpha$ 下求得单边上限 $\\mu_{\\text{up}}$，我们采用反演假设检验的标准方法。我们寻找 $\\mu_{\\text{up}}$ 的值，使得如果它是真实的信号强度，观测到与纯本底假设的相容性至少与已观测到的结果（$\\hat{\\mu}_{\\text{obs}}$）相当的概率等于 $\\alpha$。与纯本底相容意味着估计的信号强度值更小（或更负）。\n因此，对于一个假设的信号强度 $\\mu$，其 p 值为 $p_{\\mu} = P(\\hat{\\mu} \\le \\hat{\\mu}_{\\text{obs}} | \\mu_{\\text{true}}=\\mu)$。\n$$\np_{\\mu} = P\\left(\\frac{\\hat{\\mu} - \\mu}{\\sigma_{\\hat{\\mu}}} \\le \\frac{\\hat{\\mu}_{\\text{obs}} - \\mu}{\\sigma_{\\hat{\\mu}}}\\right) = \\Phi\\left(\\frac{\\hat{\\mu}_{\\text{obs}} - \\mu}{\\sigma_{\\hat{\\mu}}}\\right),\n$$\n其中 $\\Phi$ 是标准正态分布 $\\mathcal{N}(0, 1)$ 的累积分布函数（CDF）。上限 $\\mu_{\\text{up}}$ 是使 $p_{\\mu} = \\alpha$ 成立的 $\\mu$ 值：\n$$\n\\Phi\\left(\\frac{\\hat{\\mu}_{\\text{obs}} - \\mu_{\\text{up}}}{\\sigma_{\\hat{\\mu}}}\\right) = \\alpha.\n$$\n设 $Z_{\\alpha} = \\Phi^{-1}(\\alpha)$ 为标准正态分布的 $\\alpha$-分位数。则：\n$$\n\\frac{\\hat{\\mu}_{\\text{obs}} - \\mu_{\\text{up}}}{\\sigma_{\\hat{\\mu}}} = Z_{\\alpha}.\n$$\n求解 $\\mu_{\\text{up}}$：\n$$\n\\mu_{\\text{up}} = \\hat{\\mu}_{\\text{obs}} - Z_{\\alpha} \\sigma_{\\hat{\\mu}}.\n$$\n使用恒等式 $Z_{\\alpha} = -Z_{1-\\alpha}$，表达式变为：\n$$\n\\mu_{\\text{up}} = \\hat{\\mu}_{\\text{obs}} + Z_{1-\\alpha} \\sigma_{\\hat{\\mu}}.\n$$\n问题指定使用阿西莫夫数据集，其中观测数据等于标称本底期望，即 $\\boldsymbol{y} = \\boldsymbol{b}$。对于此数据集，$\\boldsymbol{d} = \\boldsymbol{y} - \\boldsymbol{b} = \\boldsymbol{0}$。观测到的估计量为：\n$$\n\\hat{\\mu}_{\\text{obs}} = \\frac{\\boldsymbol{s}^T \\boldsymbol{\\Sigma}^{-1} \\boldsymbol{0}}{\\boldsymbol{s}^T \\boldsymbol{\\Sigma}^{-1} \\boldsymbol{s}} = 0.\n$$\n该值满足物理约束 $\\mu \\ge 0$。上限的公式简化为：\n$$\n\\mu_{\\text{up}} = Z_{1-\\alpha} \\sigma_{\\hat{\\mu}} = Z_{1-\\alpha} (\\boldsymbol{s}^T \\boldsymbol{\\Sigma}^{-1} \\boldsymbol{s})^{-1/2}.\n$$\n对于 $95\\%$ 的置信水平，$\\alpha = 0.05$，且 $Z_{0.95} \\approx 1.64485$。\n\n### 第 4 部分：应用于具体问题\n\n最后一步是为每个测试案例构建协方差矩阵 $\\boldsymbol{\\Sigma}(\\kappa)$ 并应用推导出的公式。\n总协方差为 $\\boldsymbol{\\Sigma}(\\kappa) = \\boldsymbol{\\Sigma}_{\\text{stat}} + \\boldsymbol{\\Sigma}_{\\text{sys}}(\\kappa)$。\n- 信号矢量：$\\boldsymbol{s} = (3.0, 2.0, 1.5)^T$。\n- 本底矢量：$\\boldsymbol{b} = (25.0, 18.0, 12.0)^T$。\n- 统计协方差：$\\boldsymbol{\\Sigma}_{\\text{stat}} = \\mathrm{diag}(b_1, b_2, b_3) = \\mathrm{diag}(25, 18, 12)$。\n- 系统协方差 $\\boldsymbol{\\Sigma}_{\\text{sys}}(\\kappa)$：\n  - $(\\boldsymbol{\\Sigma}_{\\text{sys}}(\\kappa))_{11} = (f_{12} b_1)^2 = (0.08 \\times 25.0)^2 = 4.0$。\n  - $(\\boldsymbol{\\Sigma}_{\\text{sys}}(\\kappa))_{22} = (f_{12} b_2)^2 = (0.08 \\times 18.0)^2 = 2.0736$。\n  - $(\\boldsymbol{\\Sigma}_{\\text{sys}}(\\kappa))_{33} = (f_3 b_3)^2 = (0.10 \\times 12.0)^2 = 1.44$。\n  - 受 $\\kappa$ 影响的非对角项为：\n    $(\\boldsymbol{\\Sigma}_{\\text{sys}}(\\kappa))_{12} = (\\boldsymbol{\\Sigma}_{\\text{sys}}(\\kappa))_{21} = \\kappa \\rho_{12} f_{12}^2 b_1 b_2 = \\kappa \\times 0.7 \\times 0.08^2 \\times 25.0 \\times 18.0 = 2.016 \\kappa$。\n  - 所有其他非对角元均为 $0$。\n\n对于给定的 $\\kappa$，完整的协方差矩阵为：\n$$\n\\boldsymbol{\\Sigma}(\\kappa) = \\begin{pmatrix} 25  0  0 \\\\ 0  18  0 \\\\ 0  0  12 \\end{pmatrix} + \\begin{pmatrix} 4.0  2.016\\kappa  0 \\\\ 2.016\\kappa  2.0736  0 \\\\ 0  0  1.44 \\end{pmatrix} = \\begin{pmatrix} 29.0  2.016\\kappa  0 \\\\ 2.016\\kappa  20.0736  0 \\\\ 0  0  13.44 \\end{pmatrix}.\n$$\n对于测试套件 $\\{1.0, 0.5, 0.0, 1.3\\}$ 中的每个 $\\kappa$，我们将计算该矩阵，对其求逆，计算 $\\boldsymbol{s}^T \\boldsymbol{\\Sigma}(\\kappa)^{-1} \\boldsymbol{s}$，并最终计算 $\\mu_{\\text{up}}(\\kappa)$。", "answer": "```python\nimport numpy as np\nfrom scipy.stats import norm\n\ndef solve():\n    \"\"\"\n    Calculates the 95% CL upper limit on the signal strength parameter mu\n    for a 3-channel combination problem with varying correlation misspecification.\n    \"\"\"\n    \n    # Define problem inputs\n    s_vec = np.array([3.0, 2.0, 1.5])\n    b_vec = np.array([25.0, 18.0, 12.0])\n    \n    f12 = 0.08\n    rho12 = 0.7\n    f3 = 0.10\n    alpha = 0.05\n    \n    # Test cases for the correlation inflation factor kappa\n    test_cases = [1.0, 0.5, 0.0, 1.3]\n    \n    results = []\n    \n    # Calculate the quantile of the standard normal distribution\n    # for a one-sided 95% confidence interval\n    z_val = norm.ppf(1 - alpha)\n    \n    # Calculate the statistical covariance matrix (diagonal)\n    # This component is independent of kappa\n    sigma_stat = np.diag(b_vec)\n    \n    for kappa in test_cases:\n        # Step 1: Construct the covariance matrix Sigma(kappa)\n        \n        # Initialize the systematic covariance matrix\n        sigma_sys_k = np.zeros((3, 3))\n        \n        # Calculate diagonal elements of the systematic covariance matrix\n        sigma_sys_k[0, 0] = (f12 * b_vec[0])**2\n        sigma_sys_k[1, 1] = (f12 * b_vec[1])**2\n        sigma_sys_k[2, 2] = (f3 * b_vec[2])**2\n        \n        # Calculate the off-diagonal element for channels 1 and 2\n        off_diag = kappa * rho12 * (f12**2) * b_vec[0] * b_vec[1]\n        sigma_sys_k[0, 1] = off_diag\n        sigma_sys_k[1, 0] = off_diag\n        \n        # The full covariance is the sum of statistical and systematic components\n        sigma_k = sigma_stat + sigma_sys_k\n        \n        # Step 2: Calculate the standard deviation of the mu estimator\n        \n        # Invert the covariance matrix\n        sigma_inv_k = np.linalg.inv(sigma_k)\n        \n        # Calculate the Fisher information for mu (s^T * Sigma^-1 * s)\n        fisher_info_mu = s_vec.T @ sigma_inv_k @ s_vec\n        \n        # The standard deviation of the mu estimator is sqrt(1 / Fisher_info)\n        sigma_mu = np.sqrt(1 / fisher_info_mu)\n        \n        # Step 3: Calculate the 95% CL upper limit\n        \n        # For the Asimov dataset (y=b), the best-fit mu_hat is 0.\n        # The upper limit mu_up = mu_hat + Z * sigma_mu = 0 + Z * sigma_mu\n        mu_up = z_val * sigma_mu\n        \n        results.append(mu_up)\n        \n    # Format the final output as specified\n    formatted_results = [f\"{r:.6f}\" for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n\n```", "id": "3533325"}]}