{"hands_on_practices": [{"introduction": "在计算任何散射振幅之前，我们必须首先建立一种一致且高效的方法来描述过程的运动学。这个描述应独立于观察者的参考系，这通过使用洛伦兹不变的标量变量来实现。本练习 ([@problem_id:3505457]) 将指导您推导出一个 $n$ 粒子过程所需的最少此类变量数目，这是任何自动化矩阵元生成器的基本前提，此技能对于理解高能物理软件中如何存储和操作运动学信息至关重要。", "problem": "考虑一个在四维闵可夫斯基时空中，标准模型内的一般量子场论（QFT）树级散射过程。在自动化矩阵元生成中，代码必须使用由外部动量构建的洛伦兹不变标量来表示运动学。设一个 $2 \\to 2$ 无质量散射过程，其入射四维动量为 $p_{1}$ 和 $p_{2}$，出射四维动量为 $p_{3}$ 和 $p_{4}$，所有动量均满足 $p_{i}^{2} = 0$ 和总动量守恒 $\\sum_{i=1}^{4} p_{i} = 0$。从第一性原理出发，定义正则 Mandelstam 不变量，并推导在无质量情况下它们之间的依赖关系。\n\n然后，推广到四维空间中的一个 $n$ 点无质量振幅，其中有 $n \\geq 4$ 个外部类光动量 $\\{p_{1},\\dots,p_{n}\\}$，满足 $p_{i}^{2} = 0$ 和 $\\sum_{i=1}^{n} p_{i} = 0$。严格地从在壳条件、总动量守恒和全局洛伦兹不变性出发，推导在全局洛伦兹变换下完全参数化一般外部运动学所需的最小独立洛伦兹不变标量数目。构建一个仅由两粒子不变量 $s_{ij} \\equiv 2\\,p_{i}\\cdot p_{j}$ 组成的显式最小集，该集合适用于自动化代码，并证明其独立性。\n\n你的最终答案必须是作为 $n$ 的函数的最小独立不变量数目的单一闭合形式表达式。最终答案中不允许包含任何中间等式。如果引入任何数值，除非有明确指示，否则不要四舍五入，此处没有要求四舍五入。所有数学公式都用 LaTeX 表示，仅在需要时说明单位；此处不需要单位。如果出现角度，必须以弧度为单位；此处不需要角度。", "solution": "该问题要求推导参数化四维时空中 $n$ 点无质量散射振幅运动学所需的最小独立洛伦兹不变标量数目。首先，将分析 $2 \\to 2$ 散射（$n=4$）的特殊情况，然后推广到任意 $n \\geq 4$。\n\n给定的约束条件是，所有外部四维动量 $\\{p_1, \\dots, p_n\\}$ 都是类光的（在壳且无质量），满足 $p_i^2 = 0$，并且总动量守恒，$\\sum_{i=1}^n p_i = 0$。后一种约定，即所有动量被平等对待（例如，全部视为入射或全部视为出射），是自动化矩阵元生成系统中的标准做法。洛伦兹不变标量定义为 $s_{ij} \\equiv 2 p_i \\cdot p_j$。注意，在在壳条件 $p_i^2=0$ 下，另一个常见的定义 $s_{ij} \\equiv (p_i+p_j)^2$ 是等价的，因为 $(p_i+p_j)^2 = p_i^2 + p_j^2 + 2 p_i \\cdot p_j = 0 + 0 + 2 p_i \\cdot p_j = s_{ij}$。\n\n**第一部分：$2 \\to 2$ 散射（$n=4$）分析**\n\n对于一个无质量粒子的 $2 \\to 2$ 过程，我们有四个动量 $p_1, p_2, p_3, p_4$ 满足 $p_i^2 = 0$（对于 $i \\in \\{1,2,3,4\\}$）和 $p_1+p_2+p_3+p_4=0$。\n问题要求定义正则 Mandelstam 不变量。在物理散射过程 $p_1 + p_2 \\to p_3' + p_4'$ 中，动量守恒为 $p_1+p_2 = p_3'+p_4'$。为了与问题的约定 $\\sum p_i=0$ 匹配，我们将出射的物理动量定义为 $p_3 = -p_3'$ 和 $p_4 = -p_4'$。标准的 Mandelstam 变量是：\n$$s = (p_1+p_2)^2$$\n$$t = (p_1-p_3')^2 = (p_1+p_3)^2$$\n$$u = (p_1-p_4')^2 = (p_1+p_4)^2$$\n使用在壳条件 $p_i^2=0$，它们变为：\n$$s = 2 p_1 \\cdot p_2 = s_{12}$$\n$$t = 2 p_1 \\cdot p_3 = s_{13}$$\n$$u = 2 p_1 \\cdot p_4 = s_{14}$$\n为了找到它们之间的依赖关系，我们使用动量守恒定律。将 $p_1$ 与守恒方程 $\\sum_{j=1}^4 p_j=0$ 做点积，我们得到：\n$$p_1 \\cdot (p_1+p_2+p_3+p_4) = 0$$\n$$p_1^2 + p_1 \\cdot p_2 + p_1 \\cdot p_3 + p_1 \\cdot p_4 = 0$$\n由于 $p_1^2=0$，并使用 $s_{ij}$ 的定义，这得出：\n$$\\frac{1}{2}s_{12} + \\frac{1}{2}s_{13} + \\frac{1}{2}s_{14} = 0$$\n$$s+t+u = 0$$\n这是无质量 $2 \\to 2$ 散射中众所周知的关系。它表明三个 Mandelstam 变量中只有两个是独立的。例如，给定 $s$ 和 $t$，$u$ 就被确定了。因此，对于 $n=4$，最小独立不变量数目是 $2$。\n\n**第二部分：推广到 $n$ 点振幅**\n\n我们现在推导在 $D=4$ 维中指定一个一般 $n$ 点无质量散射过程的运动学所需的最小独立洛伦兹不变标量数目。这类标量的数目等于运动学构型模空间的维数。我们可以通过计算总自由度并减去由约束和对称性移除的自由度来计算这个维数。\n\n1.  **初始自由度**：我们从 $n$ 个四维矢量 $\\{p_1, \\dots, p_n\\}$ 开始。每个四维矢量 $p_i$ 有 $D=4$ 个分量。因此，初始变量的总数为 $n \\times D = 4n$。\n\n2.  **约束条件**：该系统受到两种物理约束：\n    *   **在壳条件**：每个粒子都是无质量且在壳的，意味着其四维动量的平方为零：$p_i^2 = 0$。这提供了 $n$ 个独立的标量方程。\n    *   **动量守恒**：总动量是守恒的：$\\sum_{i=1}^n p_i = 0$。这是一个矢量方程，提供了 $D=4$ 个独立的标量约束。\n\n    施加这些约束后剩余的变量数目是 $4n - n - 4 = 3n - 4$。\n\n3.  **对称性冗余**：物理散射振幅与观察者的惯性参考系无关。因此，运动学仅在全局洛伦兹变换下被定义。这类变换的集合构成了洛伦兹群 $SO(1, D-1)$。该群的参数（或生成元）数目是 $\\binom{D}{2}$。对于 $D=4$，参数数目是 $\\binom{4}{2} = 6$（三个空间旋转和三个洛伦兹助推）。这些变换不改变洛伦兹不变标量，因此我们上面计数的 $3n-4$ 个变量不是独立的不变量。我们必须减去洛伦兹群的参数数目来找到不变量空间的维数。\n\n4.  **最小不变量数目**：最小独立洛伦兹不变标量数目是运动学变量的数目减去洛伦兹群的参数数目：\n    $$N_{\\text{indep}} = (nD - n - D) - \\binom{D}{2}$$\n    代入 $D=4$：\n    $$N_{\\text{indep}} = (4n - n - 4) - \\binom{4}{2} = (3n - 4) - 6 = 3n - 10$$\n    这个公式对于 $n \\ge 4$ 成立。对于 $n=4$，它正确地得出 $3(4) - 10 = 2$。对于 $n=5$，它得出 $3(5) - 10 = 5$。\n\n**构建一个显式最小集**\n\n问题要求构建一个由 $3n-10$ 个形如 $s_{ij} = 2 p_i \\cdot p_j$ 的独立不变量组成的显式最小集。这类不变量的总数是 $\\binom{n}{2}$，对于 $n>4$，这个数大于 $3n-10$。这意味着在 $s_{ij}$ 之间存在非平凡的关系。这些关系源于两个方面：\n1.  **线性约束**：根据动量守恒，对于任何 $i \\in \\{1, \\dots, n\\}$，我们有 $\\sum_{j \\neq i} s_{ij} = 2 p_i \\cdot \\sum_{j \\neq i} p_j = 2 p_i \\cdot (-p_i) = -2 p_i^2 = 0$。这类关系中有 $n-1$ 个是独立的。\n2.  **非线性约束**：动量存在于 $D=4$ 维时空这一事实施加了进一步的非线性约束，称为 Gram 行列式条件。对于任何 $k>D$ 个矢量的集合，它们的 Gram 矩阵（点积矩阵）的行列式必须为零。由于动量守恒，所有 $n$ 个动量的 Gram 矩阵的秩最多为 $D-1=3$。这些条件导致了 $s_{ij}$ 之间复杂的多项式关系。\n\n构建一个基需要仔细选择 $s_{ij}$，以避免所有这些线性和非线性的依赖关系。对于一般运动学（即不限于低维子空间），一个有效的 $3n-10$ 个独立不变量的最小集的构造如下（适用于 $n \\ge 4$）：\n$$ \\mathcal{B} = \\{s_{1,j} \\mid j=2, \\dots, n-2\\} \\cup \\{s_{2,j} \\mid j=3, \\dots, n-1\\} \\cup \\{s_{3,j} \\mid j=4, \\dots, n-1\\} $$\n我们来验证这个集合的大小。元素数目为：\n$$ ( (n-2) - 2 + 1 ) + ( (n-1) - 3 + 1 ) + ( (n-1) - 4 + 1 ) = (n-3) + (n-3) + (n-4) = 3n-10 $$\n对于 $n \\ge 5$，计数是正确的。对于边界情况 $n=4$，集合为 $\\{s_{1,2}\\} \\cup \\{s_{2,3}\\} \\cup \\emptyset$，给出两个不变量 $\\{s_{12}, s_{23}\\}$。这是一个有效的基，因为 $s_{13}$ 可以通过线性关系确定（例如，$s_{13}=s_{24}$ 和 $s_{12}+s_{13}+s_{14}=0$）。\n\n对于一般运动学，该集合的独立性在形式上证明是非平凡的，但可以直观地理解。涉及 $p_1, p_2, p_3$ 的不变量用于建立一个“参考系”，其余的不变量则相对于此参考系定位其他动量 $p_4, \\dots, p_{n-1}$（$p_n$ 则由动量守恒确定）。选择特定的索引是为了避免最简单的依赖关系，同时张成整个 $3n-10$ 维空间。\n\n所要求的最终答案是作为 $n$ 的函数的最小独立不变量数目的单一闭合形式表达式。根据自由度的计算，这个数目是 $3n-10$。", "answer": "$$\\boxed{3n-10}$$", "id": "3505457"}, {"introduction": "定义了运动学之后，下一步是计算决定过程发生概率的量子力学振幅，自动化生成器通过系统地应用费曼规则来完成此任务。这包括对所有可能的费曼图贡献求和，并正确处理量子力学对称性，例如末态全同粒子的不可区分性。本练习 ([@problem_id:3505480]) 使用一个简化的玩具模型来演示如何构建完整振幅并处理末态对称化，这是计算大型强子对撞机上诸如 $gg \\to HH$ 等过程截面的核心步骤。", "problem": "考虑一个标量量子场论 (QFT) 的玩具模型，该模型旨在模拟部分子过程 $gg \\to \\phi \\phi$ 的自动化矩阵元生成，其中 $g$ 和 $\\phi$ 是实标量场。该模型包含两个额外的实标量媒介场 $\\sigma$ 和 $\\chi$。相关的相互作用项为\n$$\n\\mathcal{L}_{\\mathrm{int}} \\;=\\; -\\frac{1}{2}\\,\\kappa\\,\\sigma\\,g^{2} \\;-\\; \\frac{1}{2}\\,\\eta\\,\\sigma\\,\\phi^{2} \\;-\\; \\xi\\,\\chi\\,g\\,\\phi,\n$$\n其中 $\\kappa$、$\\eta$ 和 $\\xi$ 为实耦合常数，$\\sigma$ 和 $\\chi$ 的质量分别为 $m_{\\sigma}$ 和 $m_{\\chi}$。外部场 $g$ 和 $\\phi$ 被视为无质量的。在树图水平上进行计算。部分子 Mandelstam 不变量按惯例定义为 $s=(p_{1}+p_{2})^{2}$、$t=(p_{1}-k_{1})^{2}$ 和 $u=(p_{1}-k_{2})^{2}$，其中 $p_{1}$ 和 $p_{2}$ 是入射 $g$ 粒子的四维动量，$k_{1}$ 和 $k_{2}$ 是出射 $\\phi$ 粒子的四维动量。由于末态标量粒子是全同的，除了 s 道外，t 道和 u 道的图都有贡献。\n\n从相互作用拉格朗日量所蕴含的 Feynman 规则出发，推导 s 道、t 道和 u 道图在树图水平上的振幅贡献，然后以与自动化生成器一致的方式，演示如何在矩阵元平方的计算中处理末态全同粒子对称化问题。假设所有耦合都是实的并忽略衰变宽度，因此传播子是纯实的。将“对称化矩阵元平方”定义为一个将来自两体相空间的全同粒子因子 $1/2!$ 吸收到矩阵元归一化中的量，这是某些自动化矩阵元生成器中使用的一种约定，用以避免在全同末态相空间积分中重复计数。\n\n你的任务是，在所述假设下，为 $gg \\to \\phi \\phi$ 过程在树图水平上的对称化矩阵元平方 $\\left| \\mathcal{M} \\right|^{2}_{\\mathrm{sym}}$ 给出一个单一的闭式解析表达式，该表达式应使用 $s$、$t$、$u$、$\\kappa$、$\\eta$、$\\xi$、$m_{\\sigma}$ 和 $m_{\\chi}$ 表示。最终答案必须是单一表达式，且不得包含任何单位。如果在推导过程中引入任何其他符号，请明确定义它们。不需要进行数值近似或四舍五入。", "solution": "该问题在量子场论中有科学依据，提法恰当且客观，是有效的。它代表了计算高能物理学中一个标准（尽管简化了）的计算。我们开始求解。\n\n目标是计算过程 $g(p_1)g(p_2) \\to \\phi(k_1)\\phi(k_2)$ 在树图水平的对称化矩阵元平方 $|\\mathcal{M}|_{\\mathrm{sym}}^2$，其中 $g$ 和 $\\phi$ 是无质量的实标量场。该过程由标量场 $\\sigma$ 和 $\\chi$ 介导。\n\n首先，我们从给定的相互作用拉格朗日量推导 Feynman 规则：\n$$\n\\mathcal{L}_{\\mathrm{int}} \\;=\\; -\\frac{1}{2}\\,\\kappa\\,\\sigma\\,g^{2} \\;-\\; \\frac{1}{2}\\,\\eta\\,\\sigma\\,\\phi^{2} \\;-\\; \\xi\\,\\chi\\,g\\,\\phi\n$$\n相互作用的顶点因子从 $i\\mathcal{L}_{\\mathrm{int}}$ 项推导得出。对于涉及全同场的顶点，必须包含一个对称因子，该因子被拉格朗日量中明确的数值因子所抵消。\n\\begin{itemize}\n    \\item $\\sigma g g$ 顶点，来自 $-\\frac{1}{2}\\kappa\\sigma g^2$ 项，为 $-i\\kappa$。两个全同 $g$ 场的对称因子 $2!$ 被拉格朗日量中的 $\\frac{1}{2}$ 所抵消。\n    \\item $\\sigma \\phi \\phi$ 顶点，来自 $-\\frac{1}{2}\\eta\\sigma \\phi^2$ 项，为 $-i\\eta$。\n    \\item $\\chi g \\phi$ 顶点，来自 $-\\xi\\chi g \\phi$ 项，为 $-i\\xi$。由于场是不同的，因此没有对称因子。\n\\end{itemize}\n有质量标量媒介子 $\\sigma$ 和 $\\chi$（四维动量为 $q$）的传播子由下式给出：\n\\begin{itemize}\n    \\item $\\sigma$ 传播子：$\\frac{i}{q^2 - m_{\\sigma}^2}$\n    \\item $\\chi$ 传播子：$\\frac{i}{q^2 - m_{\\chi}^2}$\n\\end{itemize}\n问题要求忽略衰变宽度，因此省略了 $i\\epsilon$ 项。\n\n在树图水平，有三个 Feynman 图对过程 $gg \\to \\phi\\phi$ 有贡献：一个由 $\\sigma$ 介导的 s 道图，一个由 $\\chi$ 介导的 t 道图，以及一个同样由 $\\chi$ 介导的 u 道图。u 道图是必需的，因为两个末态 $\\phi$ 粒子是全同的。\n\nMandelstam 变量定义为 $s=(p_{1}+p_{2})^{2}$、$t=(p_{1}-k_{1})^{2}$ 和 $u=(p_{1}-k_{2})^{2}$。由于外部粒子是无质量的 ($p_1^2=p_2^2=k_1^2=k_2^2=0$)，我们有关系式 $s+t+u=0$。\n\n我们现在计算每个图的不变振幅，记作 $\\mathcal{M}$。一个图的总振幅按惯例记为 $i\\mathcal{M}_{\\text{diagram}}$。\n\n1.  **s 道振幅 ($\\mathcal{M}_s$):**\n    该过程为 $gg \\to \\sigma^* \\to \\phi\\phi$。中间粒子 $\\sigma$ 的四维动量为 $q_s = p_1 + p_2$，因此 $q_s^2 = s$。\n    $$\n    i\\mathcal{M}_s = (-i\\kappa) \\left( \\frac{i}{s - m_{\\sigma}^2} \\right) (-i\\eta) = -i \\frac{\\kappa\\eta}{s - m_{\\sigma}^2}\n    $$\n    因此，振幅为：\n    $$\n    \\mathcal{M}_s = -\\frac{\\kappa\\eta}{s - m_{\\sigma}^2}\n    $$\n\n2.  **t 道振幅 ($\\mathcal{M}_t$):**\n    此过程涉及交换一个 $\\chi$ 粒子。中间粒子 $\\chi$ 的四维动量为 $q_t = p_1 - k_1$，因此 $q_t^2 = t$。\n    $$\n    i\\mathcal{M}_t = (-i\\xi) \\left( \\frac{i}{t - m_{\\chi}^2} \\right) (-i\\xi) = -i \\frac{\\xi^2}{t - m_{\\chi}^2}\n    $$\n    因此，振幅为：\n    $$\n    \\mathcal{M}_t = -\\frac{\\xi^2}{t - m_{\\chi}^2}\n    $$\n\n3.  **u 道振幅 ($\\mathcal{M}_u$):**\n    这个图在拓扑上等价于 t 道图，只是交换了全同的末态粒子 ($k_1 \\leftrightarrow k_2$)。中间粒子 $\\chi$ 的四维动量为 $q_u = p_1 - k_2$，因此 $q_u^2 = u$。\n    $$\n    i\\mathcal{M}_u = (-i\\xi) \\left( \\frac{i}{u - m_{\\chi}^2} \\right) (-i\\xi) = -i \\frac{\\xi^2}{u - m_{\\chi}^2}\n    $$\n    因此，振幅为：\n    $$\n    \\mathcal{M}_u = -\\frac{\\xi^2}{u - m_{\\chi}^2}\n    $$\n\n总振幅 $\\mathcal{M}_{\\text{total}}$ 是所有有贡献的图的振幅之和：\n$$\n\\mathcal{M}_{\\text{total}} = \\mathcal{M}_s + \\mathcal{M}_t + \\mathcal{M}_u = -\\left( \\frac{\\kappa\\eta}{s - m_{\\sigma}^2} + \\frac{\\xi^2}{t - m_{\\chi}^2} + \\frac{\\xi^2}{u - m_{\\chi}^2} \\right)\n$$\n由于所有耦合常数都是实的且忽略了衰变宽度，振幅 $\\mathcal{M}_{\\text{total}}$ 是一个实数。因此矩阵元平方为 $|\\mathcal{M}_{\\text{total}}|^2 = (\\mathcal{M}_{\\text{total}})^2$:\n$$\n|\\mathcal{M}_{\\text{total}}|^2 = \\left( \\frac{\\kappa\\eta}{s - m_{\\sigma}^2} + \\frac{\\xi^2}{t - m_{\\chi}^2} + \\frac{\\xi^2}{u - m_{\\chi}^2} \\right)^2\n$$\n问题将“对称化矩阵元平方” $|\\mathcal{M}|_{\\mathrm{sym}}^2$ 定义为一个将来自相空间的全同末态粒子对称因子 $1/2!$ 吸收到矩阵元本身的量。\n$$\n|\\mathcal{M}|_{\\mathrm{sym}}^2 = \\frac{1}{2!} |\\mathcal{M}_{\\text{total}}|^2 = \\frac{1}{2} |\\mathcal{M}_{\\text{total}}|^2\n$$\n代入 $|\\mathcal{M}_{\\text{total}}|^2$ 的表达式，我们得到对称化矩阵元平方的最终表达式：\n$$\n|\\mathcal{M}|_{\\mathrm{sym}}^2 = \\frac{1}{2} \\left( \\frac{\\kappa\\eta}{s - m_{\\sigma}^2} + \\frac{\\xi^2}{t - m_{\\chi}^2} + \\frac{\\xi^2}{u - m_{\\chi}^2} \\right)^2\n$$\n这就是所要求的单一闭式解析表达式。它仅用给定的参数 $s$、$t$、$u$、$\\kappa$、$\\eta$、$\\xi$、$m_{\\sigma}$ 和 $m_{\\chi}$ 来表示。", "answer": "$$\n\\boxed{\\frac{1}{2} \\left( \\frac{\\kappa\\eta}{s - m_{\\sigma}^{2}} + \\frac{\\xi^{2}}{t - m_{\\chi}^{2}} + \\frac{\\xi^{2}}{u - m_{\\chi}^{2}} \\right)^{2}}\n$$", "id": "3505480"}, {"introduction": "自动化计算的真正威力在于其能够处理像标准模型这样复杂的现实理论，并提供可验证的预测。标准模型中最深刻的原理之一是戈德斯通玻色子等效定理，它将纵向极化的 $W$ 和 $Z$ 玻色子的高能行为与希格斯扇区联系起来。这项高级练习 ([@problem_id:3505533]) 要求您从第一性原理出发，实现一个完整的数值计算来检验该定理。通过比较 $W_L$ 玻色子与其对应的戈德斯通玻色子的产生过程，您将对电弱对称性破缺及其在对撞机上的唯象学后果获得深刻的定量理解。", "problem": "您的任务是设计并实现一个完整的、可运行的程序，通过比较高能下 $f\\bar f \\to W_L^+ W_L^-$ 和 $f\\bar f \\to \\phi^+ \\phi^-$ 过程的非极化、自旋平均的矩阵元平方，数值上检验戈德斯通玻色子等效定理在树图级别的成立情况，同时量化有限能量下的偏差。此问题背景为标准模型（SM）的电弱部分，在树图级别和费曼规范下进行计算，所有外部费mi子均视为无质量，并忽略粒子宽度。您必须基于量子场论和标准模型（SM）中经过充分检验的公式和定义，从第一性原理出发。\n\n请从以下基础出发：\n- 使用闵可夫斯基度规，其符号差为 $g_{\\mu\\nu} = \\mathrm{diag}(+1,-1,-1,-1)$。\n- 对于无质量费米子，非极化、自旋求和并初态平均的费米子流关联函数为\n$$\n\\frac{1}{4}\\sum_{\\text{spins}} J_\\mu^{(V)} J_\\nu^{(V')*} = \\frac{1}{2}\\left(g_L^{(V)} g_L^{(V')} + g_R^{(V)} g_R^{(V')}\\right) \\left(p_{2\\mu} p_{1\\nu} + p_{2\\nu} p_{1\\mu} - g_{\\mu\\nu}\\, p_1\\cdot p_2\\right),\n$$\n其中 $J_\\mu^{(V)} = \\bar v(p_2) \\gamma_\\mu (g_L^{(V)} P_L + g_R^{(V)} P_R) u(p_1)$ 且 $P_{L,R} = \\tfrac{1}{2}(1 \\mp \\gamma^5)$。\n- 对于通过s道中性规范玻色子交换 $V \\in \\{\\gamma, Z\\}$ 的过程 $f\\bar f \\to \\phi^+ \\phi^-$，标量流是导数耦合的：$V\\phi\\phi$ 顶点为 $i g_{V\\phi} (k_+ - k_-)^\\mu$。\n- 对于通过s道 $V \\in \\{\\gamma,Z\\}$ 的过程 $f\\bar f \\to W^+ W^-$，三线性规范顶点为\n$$\n\\Gamma_{\\mu\\alpha\\beta}(q,k_+,k_-) = (k_- - k_+)_\\mu g_{\\alpha\\beta} + (q - 2 k_-)_\\alpha g_{\\beta\\mu} + (2 k_+ - q)_\\beta g_{\\mu\\alpha},\n$$\n其中 $q = p_1 + p_2 = k_+ + k_-$，矢量玻色子传播子取为 $-i g_{\\mu\\nu}/(s - m_V^2)$。\n- 质量为 $m_W$、四维动量为 $k^\\mu = (E,\\vec{k})$ 的壳上W玻色子的纵向极化矢量为\n$$\n\\varepsilon_L^\\mu(k) = \\left(\\frac{|\\vec{k}|}{m_W}, \\frac{E}{m_W}\\,\\hat{k}\\right),\n$$\n其中 $\\hat{k} = \\vec{k}/|\\vec{k}|$，满足 $\\varepsilon_L\\cdot k = 0$ 和 $\\varepsilon_L^2 = -1$。\n- 树图级别的电弱耦合：\n    - 电荷 $e = \\sqrt{4\\pi \\alpha_{\\mathrm{em}}}$。\n    - 弱混合：$\\cos\\theta_W = m_W/m_Z$，$\\sin^2\\theta_W = 1 - \\cos^2\\theta_W$，以及 $g = e/\\sin\\theta_W$。\n    - 初态费米子取为上夸克型 $f = u$：电荷 $Q_f = +\\tfrac{2}{3}$，左手征分量的弱同位旋为 $T_3^f = +\\tfrac{1}{2}$，右手征分量的弱同位旋为 $T_3^f = 0$。中性流手征耦合为\n      $$\n      g_L^{(Z)} = \\frac{g}{\\cos\\theta_W}\\left(T_3^f - Q_f \\sin^2\\theta_W\\right),\\quad\n      g_R^{(Z)} = -\\frac{g}{\\cos\\theta_W}\\,Q_f \\sin^2\\theta_W,\n      $$\n      对于光子，$g_L^{(\\gamma)} = g_R^{(\\gamma)} = e Q_f$。\n    - 戈德斯通耦合：对于作为希格斯二重态带电分量的 $\\phi^\\pm$，其 $T_3^\\phi = +\\tfrac{1}{2}$ 和 $Q_\\phi=+1$，\n      $$\n      g_{Z\\phi} = \\frac{g}{\\cos\\theta_W}\\left(T_3^\\phi - \\sin^2\\theta_W Q_\\phi\\right) = \\frac{g}{\\cos\\theta_W}\\left(\\tfrac{1}{2} - \\sin^2\\theta_W\\right),\\quad g_{\\gamma\\phi} = e Q_\\phi = e.\n      $$\n    - 三线性规范耦合：$g_{\\gamma WW} = e$, $g_{ZWW} = e \\cot\\theta_W$。\n\n您必须：\n1. 在质心系中为 $f(p_1)\\bar f(p_2)\\to X(k_+) Y(k_-)$ 过程构建运动学，其中 $X,Y\\in\\{W^+_L,W^-_L\\}$ 或 $X,Y\\in\\{\\phi^+,\\phi^-\\}$。使用 $p_1^\\mu = (\\sqrt{s}/2,0,0,+\\sqrt{s}/2)$，$p_2^\\mu = (\\sqrt{s}/2,0,0,-\\sqrt{s}/2)$，$k_\\pm^\\mu = (E_W,\\pm |\\vec{k}|\\sin\\theta,0,\\pm |\\vec{k}|\\cos\\theta)$，其中 $E_W = \\sqrt{s}/2$ 且 $|\\vec{k}| = \\sqrt{E_W^2 - m_W^2}$。取戈德斯通玻色子的质量等于 $m_W$，这对应于费曼规范。\n2. 对于 $f\\bar f \\to \\phi^+ \\phi^-$，构建矢量\n$$\nS_V^\\mu = \\frac{g_{V\\phi}}{s - m_V^2} (k_+ - k_-)^\\mu,\\quad V\\in\\{\\gamma,Z\\},\\ m_\\gamma = 0.\n$$\n3. 对于 $f\\bar f \\to W_L^+ W_L^-$，构建矢量\n$$\nX_V^\\mu = \\frac{g_{VWW}}{s - m_V^2}\\left[(k_- - k_+ )^\\mu (\\varepsilon_+\\cdot \\varepsilon_-) + \\big((q - 2k_-)\\cdot \\varepsilon_+\\big)\\,\\varepsilon_-^\\mu + \\big((2k_+ - q)\\cdot \\varepsilon_- \\big)\\,\\varepsilon_+^\\mu \\right],\n$$\n其中 $\\varepsilon_\\pm^\\mu$ 是 $W^\\pm$ 的纵向极化矢量。\n4. 使用上述自旋平均的流关联函数，计算非极化、自旋平均的矩阵元平方\n$$\n\\overline{|{\\cal M}|^2} = \\frac{1}{2}\\sum_{V,V'\\in\\{\\gamma,Z\\}}\\left(g_L^{(V)} g_L^{(V')} + g_R^{(V)} g_R^{(V')}\\right)\\left[p_2\\cdot A_V\\,\\, p_1\\cdot A_{V'} + p_2\\cdot A_{V'}\\,\\, p_1\\cdot A_V - (p_1\\cdot p_2)\\, A_V\\cdot A_{V'}\\right],\n$$\n其中对于标量道，$A_V^\\mu$ 是 $S_V^\\mu$；对于纵向矢量道，$A_V^\\mu$ 是 $X_V^\\mu$。所有点积均为使用 $g_{\\mu\\nu}$ 的闵可夫斯基点积。\n5. 通过计算无量纲比率来量化有限能量下的偏差\n$$\n\\delta(s,\\cos\\theta) = \\frac{\\overline{|{\\cal M}(f\\bar f\\to W_L^+ W_L^-)|^2}}{\\overline{|{\\cal M}(f\\bar f\\to \\phi^+ \\phi^-)|^2}} - 1,\n$$\n根据戈德斯通玻色子等效定理，当 $\\sqrt{s}\\to \\infty$ 时，该比率应趋近于 $0$。\n\n使用以下物理常数和约定：\n- $m_W = 80.379$ GeV, $m_Z = 91.1876$ GeV, $\\alpha_{\\mathrm{em}} = 1/127.95$, $m_\\gamma = 0$ GeV。\n- 所有能量单位必须是GeV。角度必须通过无量纲的 $\\cos\\theta$ 指定。\n\n测试套件：\n- 为以下参数组 $(\\sqrt{s}\\,\\text{[GeV]}, \\cos\\theta)$ 提供结果：\n  - $(200.0, 0.0)$,\n  - $(500.0, 0.3)$,\n  - $(1000.0, -0.7)$,\n  - $(3000.0, 0.9)$,\n  - $(170.0, 0.0)$.\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，结果顺序与测试套件中的顺序相同，例如：$[\\delta_1,\\delta_2,\\delta_3,\\delta_4,\\delta_5]$。", "solution": "我们的目标是通过比较标准模型（SM）中树图级别下 $f\\bar f\\to W_L^+W_L^-$ 和 $f\\bar f\\to \\phi^+\\phi^-$ 过程的非极化、自旋平均的矩阵元平方，来检验戈德斯通玻色子等效定理。该定理预测，对于 $\\sqrt{s}\\gg m_W$ 的情况，纵向极化矢量玻色子对产生的振幅应与相应戈德斯通玻色子对产生的振幅一致，其间的差异由能量的反幂次项压低。\n\n基于原理的设置：\n1. 运动学和度规。我们在质心（CoM）系中工作，使用闵可夫斯基度规 $g_{\\mu\\nu} = \\mathrm{diag}(+1,-1,-1,-1)$。入射动量为 $p_1^\\mu=(\\sqrt{s}/2,0,0,+\\sqrt{s}/2)$ 和 $p_2^\\mu=(\\sqrt{s}/2,0,0,-\\sqrt{s}/2)$。出射动量 $k_\\pm^\\mu$ 的能量为 $E_W=\\sqrt{s}/2$，三维动量为 $\\vec{k}_\\pm = \\pm |\\vec{k}|(\\sin\\theta,0,\\cos\\theta)$，其中 $|\\vec{k}|=\\sqrt{E_W^2-m_W^2}$。我们在费曼规范中取戈德斯通玻色子的质量等于 $m_W$，这样 $W_L^+W_L^-$ 和 $\\phi^+\\phi^-$ 的运动学是相同的。总动量为 $q^\\mu=p_1^\\mu+p_2^\\mu=k_+^\\mu+k_-^\\mu$。\n\n2. 电弱耦合。在树图级别，电磁耦合为 $e=\\sqrt{4\\pi\\alpha_{\\mathrm{em}}}$，弱混合参数为 $\\cos\\theta_W = m_W/m_Z$，$\\sin\\theta_W = \\sqrt{1-\\cos^2\\theta_W}$，以及 $g=e/\\sin\\theta_W$。对于初态的上夸克型，中性流手征耦合为\n$$\ng_L^{(Z)}=\\frac{g}{\\cos\\theta_W}\\left(T_3^f - Q_f\\sin^2\\theta_W\\right),\\quad g_R^{(Z)}=-\\frac{g}{\\cos\\theta_W}Q_f\\sin^2\\theta_W,\n$$\n其中 $Q_f=+\\tfrac{2}{3}$，左手征分量的 $T_3^f=+\\tfrac{1}{2}$，右手征分量的 $T_3^f=0$。对于光子，$g_L^{(\\gamma)}=g_R^{(\\gamma)}=eQ_f$。对于戈德斯通玻色子，$g_{\\gamma\\phi}=e Q_\\phi=e$ 且 $g_{Z\\phi}=\\frac{g}{\\cos\\theta_W}\\left(\\tfrac{1}{2}-\\sin^2\\theta_W\\right)$。对于三线性规范耦合，$g_{\\gamma WW}=e$ 且 $g_{ZWW}=e\\cot\\theta_W$。\n\n3. 纵向极化。有质量矢量玻色子的精确纵向极化矢量选择为\n$$\n\\varepsilon_L^\\mu(k) = \\left(\\frac{|\\vec{k}|}{m_W}, \\frac{E_W}{m_W}\\,\\hat{k}\\right),\n$$\n其中 $\\hat{k}=\\vec{k}/|\\vec{k}|$。在我们的度规下，它满足 $\\varepsilon_L\\cdot k=0$ 和 $\\varepsilon_L^2=-1$。\n\n4. 通过费曼规则计算振幅。对于s道交换 $V\\in\\{\\gamma,Z\\}$，其传播子为 $-ig_{\\mu\\nu}/(s-m_V^2)$ 且耦合为实数，给定V的振幅可以分解为费米子流和末态结构的乘积。我们定义，对于标量道，\n$$\nS_V^\\mu = \\frac{g_{V\\phi}}{s-m_V^2}(k_+ - k_-)^\\mu,\n$$\n对于矢量道，\n$$\nX_V^\\mu = \\frac{g_{VWW}}{s-m_V^2}\\left[(k_- - k_+ )^\\mu (\\varepsilon_+\\cdot \\varepsilon_-) + \\big((q - 2k_-)\\cdot \\varepsilon_+\\big)\\,\\varepsilon_-^\\mu + \\big((2k_+ - q)\\cdot \\varepsilon_- \\big)\\,\\varepsilon_+^\\mu \\right],\n$$\n这是三线性顶点与纵向极化矢量收缩的结果。总振幅是费米子流 $J_\\mu^{(V)}=\\bar v \\gamma_\\mu (g_L^{(V)}P_L+g_R^{(V)}P_R) u$ 对 $V\\in\\{\\gamma,Z\\}$ 的求和。\n\n5. 使用迹方法进行自旋平均。对于无质量费米子，非极化、自旋求和并平均的流关联函数为\n$$\n\\frac{1}{4}\\sum_{\\text{spins}} J_\\mu^{(V)} J_\\nu^{(V')*} = \\frac{1}{2}\\left(g_L^{(V)} g_L^{(V')} + g_R^{(V)} g_R^{(V')}\\right) \\left(p_{2\\mu} p_{1\\nu} + p_{2\\nu} p_{1\\mu} - g_{\\mu\\nu}\\, p_1\\cdot p_2\\right).\n$$\n因此，非极化、自旋平均的振幅平方具有紧凑形式\n$$\n\\overline{|{\\cal M}|^2} = \\frac{1}{2}\\sum_{V,V'\\in\\{\\gamma,Z\\}}\\left(g_L^{(V)} g_L^{(V')} + g_R^{(V)} g_R^{(V')}\\right)\\left[p_2\\cdot A_V\\,\\, p_1\\cdot A_{V'} + p_2\\cdot A_{V'}\\,\\, p_1\\cdot A_V - (p_1\\cdot p_2)\\, A_V\\cdot A_{V'}\\right],\n$$\n其中对于 $\\phi^+\\phi^-$ 道，$A_V^\\mu = S_V^\\mu$；对于 $W_L^+W_L^-$ 道，$A_V^\\mu = X_V^\\mu$。\n\n6. 戈德斯通玻色子等效定理与偏差。等效定理指出\n$$\n{\\cal M}(f\\bar f \\to W_L^+ W_L^-)\\;=\\;{\\cal M}(f\\bar f \\to \\phi^+ \\phi^-)\\;+\\;{\\cal O}\\!\\left(\\frac{m_W}{\\sqrt{s}}\\right),\n$$\n因此，在大 $\\sqrt{s}$ 时，非极化矩阵元平方的比值\n$$\n\\delta(s,\\cos\\theta) = \\frac{\\overline{|{\\cal M}(f\\bar f\\to W_L^+ W_L^-)|^2}}{\\overline{|{\\cal M}(f\\bar f\\to \\phi^+ \\phi^-)|^2}} - 1,\n$$\n趋向于 $0$。有限能量修正来自于使用精确的纵向极化矢量和完整的三线性顶点，而不是直接用 $\\phi$ 替换 $W_L$。\n\n算法实现：\n- 根据 $(\\sqrt{s},\\cos\\theta)$ 构建四维矢量 $p_1, p_2, k_\\pm$，能量单位为GeV。\n- 为纵向 $W^\\pm$ 构建 $\\varepsilon_\\pm^\\mu$。\n- 使用耦合和传播子为每个 $V\\in\\{\\gamma,Z\\}$ 计算 $S_V^\\mu$ 和 $X_V^\\mu$。\n- 使用 $g_{\\mu\\nu}=\\mathrm{diag}(+1,-1,-1,-1)$ 计算所有闵可夫斯基点积。\n- 使用基于迹的张量收缩为两个道组装 $\\overline{|{\\cal M}|^2}$：\n$$\nT_{\\mu\\nu} = p_{2\\mu}p_{1\\nu} + p_{2\\nu}p_{1\\mu} - g_{\\mu\\nu}\\,p_1\\cdot p_2,\n$$\n以及收缩\n$$\n{\\cal C}(A,B) = p_2\\cdot A\\, p_1\\cdot B + p_2\\cdot B\\, p_1\\cdot A - (p_1\\cdot p_2)\\, A\\cdot B.\n$$\n- 形成 $\\delta(s,\\cos\\theta)$ 并报告测试套件的结果。\n\n参数选择：\n- $m_W = 80.379$ GeV, $m_Z = 91.1876$ GeV, $\\alpha_{\\mathrm{em}} = 1/127.95$, $m_\\gamma = 0$ GeV。\n- $\\cos\\theta_W = m_W/m_Z$, $\\sin^2\\theta_W = 1-\\cos^2\\theta_W$, $e=\\sqrt{4\\pi\\alpha_{\\mathrm{em}}}$, $g=e/\\sin\\theta_W$。\n- 上夸克初态：$Q_f=+\\tfrac{2}{3}$, $T_3^f=+\\tfrac{1}{2}$ (左手), $T_3^f=0$ (右手)。\n\n测试套件与输出：\n- 对有序列表中的 $(\\sqrt{s}\\,[\\mathrm{GeV}],\\cos\\theta)$ 求 $\\delta$：\n  - $(200.0, 0.0)$,\n  - $(500.0, 0.3)$,\n  - $(1000.0, -0.7)$,\n  - $(3000.0, 0.9)$,\n  - $(170.0, 0.0)$.\n- 打印单行：一个方括号内的逗号分隔列表，例如 $[\\delta_1,\\delta_2,\\delta_3,\\delta_4,\\delta_5]$。\n\n此构造严格遵循标准模型费曼规则、洛伦兹不变性以及通过迹技术的自旋平均方法，确保了对两个通道的第一性原理、规范不变的比较。有限能量下的偏差量化了渐近高能极限之外的次领头修正。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\n# Minkowski metric with signature (+,-,-,-)\nETA = np.diag([1.0, -1.0, -1.0, -1.0])\n\ndef minkowski_dot(a, b):\n    \"\"\"Minkowski dot product with metric diag(+,-,-,-).\"\"\"\n    return float(a[0]*b[0] - a[1]*b[1] - a[2]*b[2] - a[3]*b[3])\n\ndef vector_add(a, b):\n    return a + b\n\ndef vector_sub(a, b):\n    return a - b\n\ndef scalar_mul(c, a):\n    return c * a\n\ndef polarization_longitudinal(k, m):\n    \"\"\"\n    Exact longitudinal polarization vector for a massive vector boson with 4-momentum k=(E,kx,ky,kz),\n    epsilon_L = (|k|/m, (E/m) * k_hat), where k_hat = k_vec / |k|.\n    \"\"\"\n    E = k[0]\n    kv = k[1:]\n    p = np.linalg.norm(kv)\n    if p == 0.0:\n        # At exact threshold, choose an arbitrary direction; here default z.\n        khat = np.array([0.0, 0.0, 1.0])\n    else:\n        khat = kv / p\n    eps0 = p / m\n    eps_spatial = (E / m) * khat\n    return np.array([eps0, eps_spatial[0], eps_spatial[1], eps_spatial[2]], dtype=float)\n\ndef build_kinematics(sqrt_s, cos_theta, mW):\n    \"\"\"\n    Build 4-vectors in the COM frame:\n    p1=(E,0,0,+E), p2=(E,0,0,-E),\n    k+ and k- with scattering angle theta and equal energies E_W = sqrt_s/2.\n    \"\"\"\n    Ecm = sqrt_s\n    E = Ecm / 2.0\n    p1 = np.array([E, 0.0, 0.0, +E], dtype=float)\n    p2 = np.array([E, 0.0, 0.0, -E], dtype=float)\n\n    # Final-state W momenta\n    EW = E\n    p_abs_sq = EW*EW - mW*mW\n    if p_abs_sq = 0:\n        p_abs = 0.0\n    else:\n        p_abs = np.sqrt(p_abs_sq)\n\n    # Ensure cos_theta within [-1,1]\n    ct = float(np.clip(cos_theta, -1.0, 1.0))\n    st_sq = max(0.0, 1.0 - ct*ct)\n    st = np.sqrt(st_sq)\n\n    k_plus = np.array([EW, +p_abs*st, 0.0, +p_abs*ct], dtype=float)\n    k_minus = np.array([EW, -p_abs*st, 0.0, -p_abs*ct], dtype=float)\n\n    return p1, p2, k_plus, k_minus\n\ndef build_couplings():\n    \"\"\"\n    Electroweak parameters and couplings.\n    \"\"\"\n    # Physical constants (GeV)\n    mW = 80.379\n    mZ = 91.1876\n    alpha_em = 1.0 / 127.95\n    e = np.sqrt(4.0 * np.pi * alpha_em)\n    cW = mW / mZ\n    sW = np.sqrt(max(0.0, 1.0 - cW*cW))\n    g = e / sW\n\n    # Initial-state fermion: up-quark\n    Qf = +2.0/3.0\n    T3L = +0.5  # only for left-chiral; right has T3=0\n\n    # Chiral couplings to Z\n    gL_Z = (g / cW) * (T3L - Qf * sW*sW)\n    gR_Z = -(g / cW) * (Qf * sW*sW)\n\n    # Photon couplings (vector-like)\n    gL_A = e * Qf\n    gR_A = e * Qf\n\n    # Goldstone couplings\n    Qphi = +1.0\n    T3phi = +0.5\n    g_A_phi = e * Qphi\n    g_Z_phi = (g / cW) * (T3phi - (sW*sW) * Qphi)\n\n    # Trilinear gauge couplings\n    g_A_WW = e\n    g_Z_WW = e * cW / sW  # = g * cW\n\n    # Vector boson masses\n    mA = 0.0\n    mZ_val = mZ\n\n    couplings = {\n        \"e\": e,\n        \"g\": g,\n        \"sW\": sW,\n        \"cW\": cW,\n        \"mW\": mW,\n        \"mZ\": mZ_val,\n        \"mA\": mA,\n        # fermion chiral couplings\n        \"gL\": {\"A\": gL_A, \"Z\": gL_Z},\n        \"gR\": {\"A\": gR_A, \"Z\": gR_Z},\n        # scalar and trilinear couplings\n        \"gVphi\": {\"A\": g_A_phi, \"Z\": g_Z_phi},\n        \"gVWW\": {\"A\": g_A_WW, \"Z\": g_Z_WW},\n    }\n    return couplings\n\ndef A_vector_scalar_channel(p1, p2, k_plus, k_minus, V, couplings):\n    \"\"\"\n    Build A_V^\\mu for scalar channel: S_V^\\mu = g_{Vphi}/(s - m_V^2) * (k_plus - k_minus)^\\mu\n    \"\"\"\n    q = vector_add(k_plus, k_minus)\n    s = minkowski_dot(q, q)\n    if V == \"A\":\n        mV2 = 0.0\n    else:\n        mV2 = couplings[\"mZ\"]**2\n    denom = s - mV2\n    gVphi = couplings[\"gVphi\"][V]\n    vec = vector_sub(k_plus, k_minus)\n    return scalar_mul(gVphi / denom, vec)\n\ndef A_vector_vector_channel(p1, p2, k_plus, k_minus, V, couplings):\n    \"\"\"\n    Build A_V^\\mu for vector channel with longitudinal polarizations.\n    X_V^\\mu = g_{VWW}/(s - m_V^2) [ (k_- - k_+ )^\\mu (epsp·epsm) + ((q - 2k_- )·epsp) epsm^\\mu + ((2k_+ - q)·epsm) epsp^\\mu ]\n    \"\"\"\n    q = vector_add(k_plus, k_minus)\n    s = minkowski_dot(q, q)\n    if V == \"A\":\n        mV2 = 0.0\n    else:\n        mV2 = couplings[\"mZ\"]**2\n    denom = s - mV2\n    gVWW = couplings[\"gVWW\"][V]\n\n    # Longitudinal polarization vectors\n    eps_p = polarization_longitudinal(k_plus, couplings[\"mW\"])\n    eps_m = polarization_longitudinal(k_minus, couplings[\"mW\"])\n\n    # Compute needed components\n    km_minus_kp = vector_sub(k_minus, k_plus)\n    q_minus_2km = vector_sub(q, scalar_mul(2.0, k_minus))\n    two_kp_minus_q = vector_sub(scalar_mul(2.0, k_plus), q)\n\n    epsp_dot_epsm = minkowski_dot(eps_p, eps_m)\n    qmk_dot_epsp = minkowski_dot(q_minus_2km, eps_p)\n    tkmq_dot_epsm = minkowski_dot(two_kp_minus_q, eps_m)\n\n    term1 = scalar_mul(epsp_dot_epsm, km_minus_kp)\n    term2 = scalar_mul(qmk_dot_epsp, eps_m)\n    term3 = scalar_mul(tkmq_dot_epsm, eps_p)\n\n    X = vector_add(term1, vector_add(term2, term3))\n    return scalar_mul(gVWW / denom, X)\n\ndef contraction_T(p1, p2, A, B):\n    \"\"\"\n    Compute C(A,B) = p2·A p1·B + p2·B p1·A - (p1·p2) A·B\n    \"\"\"\n    p2dotA = minkowski_dot(p2, A)\n    p1dotB = minkowski_dot(p1, B)\n    p2dotB = minkowski_dot(p2, B)\n    p1dotA = minkowski_dot(p1, A)\n    p1dotp2 = minkowski_dot(p1, p2)\n    AdotB = minkowski_dot(A, B)\n    return p2dotA * p1dotB + p2dotB * p1dotA - p1dotp2 * AdotB\n\ndef M2_unpolarized_channel(p1, p2, k_plus, k_minus, channel, couplings):\n    \"\"\"\n    Compute the unpolarized, spin-averaged squared matrix element:\n    M2 = (1/2) sum_{V,V' in {A,Z}} (gL^V gL^V' + gR^V gR^V') * C(A_V, A_V')\n    where A_V is S_V for scalar channel or X_V for vector channel.\n    \"\"\"\n    # Build A_V for V in A,Z\n    if channel == \"scalar\":\n        AV = {\n            \"A\": A_vector_scalar_channel(p1, p2, k_plus, k_minus, \"A\", couplings),\n            \"Z\": A_vector_scalar_channel(p1, p2, k_plus, k_minus, \"Z\", couplings),\n        }\n    elif channel == \"vector\":\n        AV = {\n            \"A\": A_vector_vector_channel(p1, p2, k_plus, k_minus, \"A\", couplings),\n            \"Z\": A_vector_vector_channel(p1, p2, k_plus, k_minus, \"Z\", couplings),\n        }\n    else:\n        raise ValueError(\"Unknown channel\")\n\n    gL = couplings[\"gL\"]\n    gR = couplings[\"gR\"]\n\n    # Sum over V,V'\n    M2 = 0.0\n    for V in (\"A\", \"Z\"):\n        for Vp in (\"A\", \"Z\"):\n            coeff = 0.5 * (gL[V] * gL[Vp] + gR[V] * gR[Vp])\n            M2 += coeff * contraction_T(p1, p2, AV[V], AV[Vp])\n    return M2\n\ndef compute_delta(sqrt_s, cos_theta, couplings):\n    \"\"\"\n    Compute delta(s,cosθ) = M2_vector / M2_scalar - 1.\n    \"\"\"\n    mW = couplings[\"mW\"]\n    p1, p2, k_plus, k_minus = build_kinematics(sqrt_s, cos_theta, mW)\n    # Build matrix elements\n    M2_scalar = M2_unpolarized_channel(p1, p2, k_plus, k_minus, \"scalar\", couplings)\n    M2_vector = M2_unpolarized_channel(p1, p2, k_plus, k_minus, \"vector\", couplings)\n    # Avoid division by zero\n    if M2_scalar == 0.0:\n        return np.nan\n    return (M2_vector / M2_scalar) - 1.0\n\ndef solve():\n    # Define the test cases from the problem statement as (sqrt(s) in GeV, cos(theta))\n    test_cases = [\n        (200.0, 0.0),\n        (500.0, 0.3),\n        (1000.0, -0.7),\n        (3000.0, 0.9),\n        (170.0, 0.0),\n    ]\n\n    couplings = build_couplings()\n\n    results = []\n    for sqrt_s, cos_theta in test_cases:\n        delta = compute_delta(sqrt_s, cos_theta, couplings)\n        results.append(delta)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "3505533"}]}