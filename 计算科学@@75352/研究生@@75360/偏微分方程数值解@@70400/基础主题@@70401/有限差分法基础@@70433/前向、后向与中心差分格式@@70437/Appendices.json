{"hands_on_practices": [{"introduction": "我们不仅需要理解标准差分格式，还需要能够根据特定需求构建新的格式。例如，在处理域边界时，我们无法使用对称的中心差分模板。本练习将指导您使用待定系数法推导一个二阶精度的单边（前向）差分格式，这是一种通过强制公式对多项式基底精确成立来构建任意差分格式的通用技术。[@problem_id:3395616]", "problem": "在标量偏微分方程 (PDE) 的有限差分格式化中，对于间距为 $h>0$ 的均匀网格，边界处理通常需要对空间导数进行单边近似。设 $u:\\mathbb{R}\\to\\mathbb{R}$ 是一个足够光滑的函数，其节点为 $x_i$、$x_{i+1}=x_i+h$ 和 $x_{i+2}=x_i+2h$。请构造一个单边前向有限差分公式，仅使用函数值 $u(x_i)$、$u(x_{i+1})$ 和 $u(x_{i+2})$ 来近似一阶导数 $u'(x_i)$，并使得该近似对于 $h$ 具有二阶精度。\n\n请按以下步骤进行，从光滑函数在一点展开的 Taylor 定理出发：假设该近似具有如下形式\n$$\nu'(x_i)\\approx \\frac{a_0\\,u(x_i)+a_1\\,u(x_{i+1})+a_2\\,u(x_{i+2})}{h},\n$$\n其中系数 $a_0,a_1,a_2\\in\\mathbb{R}$ 待定。通过强制该公式对最高为 2 次的多项式精确成立来确定 $a_0$、$a_1$ 和 $a_2$。然后，通过在 $x_i$ 点进行显式 Taylor 展开来验证所得公式的精度阶数，并确定截断误差中的首个非零项，包括其符号以及对 $u^{(3)}(x_i)$ 的依赖关系。\n\n最后，将所得的前向差分近似表示为关于 $u(x_i)$、$u(x_{i+1})$、$u(x_{i+2})$ 和 $h$ 的单个闭式表达式。在您最终报告的表达式中，不要包含截断误差或任何大-$\\mathcal{O}$ 记号。无需四舍五入。", "solution": "首先，将对问题陈述的正确性、完整性和科学依据进行验证。\n\n### 步骤 1：提取已知条件\n- **任务**：构造一阶导数 $u'(x_i)$ 的单边前向有限差分公式。\n- **函数**：$u:\\mathbb{R}\\to\\mathbb{R}$ 足够光滑。\n- **网格**：间距为 $h > 0$ 的均匀网格。\n- **节点**：$x_i$、$x_{i+1} = x_i + h$、$x_{i+2} = x_i + 2h$。\n- **模板**：公式必须仅使用函数值 $u(x_i)$、$u(x_{i+1})$ 和 $u(x_{i+2})$。\n- **假设形式**：近似的形式为 $u'(x_i) \\approx \\frac{a_0 u(x_i) + a_1 u(x_{i+1}) + a_2 u(x_{i+2})}{h}$。\n- **约束**：通过强制公式对最高为 2 次的多项式精确成立来确定系数 $a_0, a_1, a_2$。\n- **验证**：必须使用 Taylor 展开验证所得公式的精度阶数，并确定其首项截断误差。\n- **要求输出**：一个关于 $u(x_i)$、$u(x_{i+1})$、$u(x_{i+2})$ 和 $h$ 的近似值的单个闭式表达式。\n\n### 步骤 2：使用提取的已知条件进行验证\n- **科学依据**：该问题是数值分析中的一个标准练习，特别是在有限差分格式的推导方面。它依赖于 Taylor 定理和待定系数法，这些都是基本的数学原理。该问题在科学上是合理的。\n- **适定性**：该问题是适定的。它提供了一个明确的目标和一套完整的约束条件（模板、近似形式以及求解系数的方法），这些条件可以导出一个关于系数 $a_0, a_1, a_2$ 的唯一解。\n- **客观性**：问题以精确、客观的数学语言陈述，没有歧义或主观看法。\n- **完整性与一致性**：问题是自洽且一致的。所有推导公式所需的信息都已提供。\n\n### 步骤 3：结论与行动\n问题有效。可以开始求解过程。\n\n任务是找到一组系数 $a_0, a_1, a_2$，使得公式\n$$\nD_h[u](x_i) = \\frac{a_0 u(x_i) + a_1 u(x_{i+1}) + a_2 u(x_{i+2})}{h}\n$$\n近似于 $u'(x_i)$，并且对 0 次、1 次和 2 次多项式精确成立。这意味着对于任何次数 $\\deg(p) \\le 2$ 的多项式 $p(x)$，我们必须有 $D_h[p](x_i) = p'(x_i)$。只需对最高 2 次多项式空间的一个基（例如 $\\{1, x-x_i, (x-x_i)^2\\}$）强制该条件成立即可。\n\n让我们对每个基多项式测试该公式：\n\n1.  对于 $u(x) = 1$ (0 次多项式):\n    $u'(x_i) = 0$。函数值为 $u(x_i)=1$, $u(x_{i+1})=1$, 以及 $u(x_{i+2})=1$。\n    为使公式精确成立，我们必须有：\n    $$\n    \\frac{a_0(1) + a_1(1) + a_2(1)}{h} = 0\n    $$\n    由于 $h \\neq 0$，这导出我们的第一个条件：\n    $$\n    a_0 + a_1 + a_2 = 0\n    $$\n\n2.  对于 $u(x) = x - x_i$ (1 次多项式):\n    $u'(x) = 1$，所以 $u'(x_i) = 1$。函数值为 $u(x_i)=0$，$u(x_{i+1})=x_{i+1}-x_i=h$，以及 $u(x_{i+2})=x_{i+2}-x_i=2h$。\n    为使公式精确成立，我们必须有：\n    $$\n    \\frac{a_0(0) + a_1(h) + a_2(2h)}{h} = 1\n    $$\n    化简后得到我们的第二个条件：\n    $$\n    a_1 + 2a_2 = 1\n    $$\n\n3.  对于 $u(x) = (x - x_i)^2$ (2 次多项式):\n    $u'(x) = 2(x - x_i)$，所以 $u'(x_i) = 0$。函数值为 $u(x_i)=0$，$u(x_{i+1})=(x_{i+1}-x_i)^2=h^2$，以及 $u(x_{i+2})=(x_{i+2}-x_i)^2=(2h)^2=4h^2$。\n    为使公式精确成立，我们必须有：\n    $$\n    \\frac{a_0(0) + a_1(h^2) + a_2(4h^2)}{h} = 0\n    $$\n    化简后得到 $a_1 h + 4a_2 h = 0$。由于 $h \\neq 0$，我们得到第三个条件：\n    $$\n    a_1 + 4a_2 = 0\n    $$\n\n我们现在得到一个关于 $a_0, a_1, a_2$ 的三元一次方程组：\n\\begin{align*}\n    a_0 + a_1 + a_2 = 0 \\quad (1) \\\\\n    a_1 + 2a_2 = 1 \\quad (2) \\\\\n    a_1 + 4a_2 = 0 \\quad (3)\n\\end{align*}\n从方程 (3) 中，我们得到 $a_1 = -4a_2$。将此代入方程 (2)：\n$$\n(-4a_2) + 2a_2 = 1 \\implies -2a_2 = 1 \\implies a_2 = -\\frac{1}{2}\n$$\n现在，我们求出 $a_1$：\n$$\na_1 = -4a_2 = -4\\left(-\\frac{1}{2}\\right) = 2\n$$\n最后，使用方程 (1) 求出 $a_0$：\n$$\na_0 + (2) + \\left(-\\frac{1}{2}\\right) = 0 \\implies a_0 + \\frac{3}{2} = 0 \\implies a_0 = -\\frac{3}{2}\n$$\n系数为 $a_0 = -\\frac{3}{2}$，$a_1 = 2$，以及 $a_2 = -\\frac{1}{2}$。\n\n所得的有限差分公式为：\n$$\nD_h[u](x_i) = \\frac{-\\frac{3}{2} u(x_i) + 2 u(x_{i+1}) - \\frac{1}{2} u(x_{i+2})}{h} = \\frac{-3 u(x_i) + 4 u(x_{i+1}) - u(x_{i+2})}{2h}\n$$\n\n接下来，我们使用 $u(x_{i+1})$ 和 $u(x_{i+2})$ 在点 $x_i$ 附近的 Taylor 级数展开来验证其精度阶数：\n$$\nu(x_{i+1}) = u(x_i+h) = u(x_i) + h u'(x_i) + \\frac{h^2}{2!} u''(x_i) + \\frac{h^3}{3!} u^{(3)}(x_i) + \\mathcal{O}(h^4)\n$$\n$$\nu(x_{i+2}) = u(x_i+2h) = u(x_i) + (2h) u'(x_i) + \\frac{(2h)^2}{2!} u''(x_i) + \\frac{(2h)^3}{3!} u^{(3)}(x_i) + \\mathcal{O}(h^4)\n$$\n将这些展开式代入公式的分子 $-3 u(x_i) + 4 u(x_{i+1}) - u(x_{i+2})$：\n$$\n-3 u(x_i) + 4\\left(u(x_i) + h u'(x_i) + \\frac{h^2}{2} u''(x_i) + \\frac{h^3}{6} u^{(3)}(x_i) + \\dots\\right) - \\left(u(x_i) + 2h u'(x_i) + \\frac{4h^2}{2} u''(x_i) + \\frac{8h^3}{6} u^{(3)}(x_i) + \\dots\\right)\n$$\n按 $u$ 在 $x_i$ 点的各阶导数分组：\n- $u(x_i)$ 的系数： $-3 + 4 - 1 = 0$\n- $u'(x_i)$ 的系数： $4h - 2h = 2h$\n- $u''(x_i)$ 的系数： $4\\frac{h^2}{2} - \\frac{4h^2}{2} = 2h^2 - 2h^2 = 0$\n- $u^{(3)}(x_i)$ 的系数： $4\\frac{h^3}{6} - \\frac{8h^3}{6} = \\frac{4h^3 - 8h^3}{6} = -\\frac{4h^3}{6} = -\\frac{2h^3}{3}$\n所以，分子展开为：\n$$\n2h u'(x_i) - \\frac{2h^3}{3} u^{(3)}(x_i) + \\mathcal{O}(h^4)\n$$\n现在，我们除以 $2h$ 得到近似的完整表达式：\n$$\n\\frac{-3 u(x_i) + 4 u(x_{i+1}) - u(x_{i+2})}{2h} = \\frac{2h u'(x_i) - \\frac{2h^3}{3} u^{(3)}(x_i) + \\mathcal{O}(h^4)}{2h} = u'(x_i) - \\frac{h^2}{3} u^{(3)}(x_i) + \\mathcal{O}(h^3)\n$$\n截断误差，定义为 $T.E. = (\\text{近似值}) - (\\text{真实值})$，为：\n$$\nT.E. = \\left(u'(x_i) - \\frac{h^2}{3} u^{(3)}(x_i) + \\mathcal{O}(h^3)\\right) - u'(x_i) = -\\frac{h^2}{3} u^{(3)}(x_i) + \\mathcal{O}(h^3)\n$$\n截断误差中的首个非零项是 $-\\frac{1}{3}h^2u^{(3)}(x_i)$。误差的阶数是 $\\mathcal{O}(h^2)$，这意味着该有限差分近似是二阶精确的，符合要求。\n\n最终的前向差分近似公式是：\n$$\nu'(x_i) \\approx \\frac{-3u(x_i) + 4u(x_{i+1}) - u(x_{i+2})}{2h}\n$$", "answer": "$$\n\\boxed{\\frac{-3u(x_i) + 4u(x_{i+1}) - u(x_{i+2})}{2h}}\n$$", "id": "3395616"}, {"introduction": "选择合适的差分格式对于获得物理上真实可靠的数值解至关重要。虽然中心差分因其高精度而备受青睐，但在某些情况下，它可能会导致灾难性的失败。本练习探讨了一个经典的对流-扩散问题，通过一个具体的反例，揭示了在对流占主导地位（即网格佩克莱数 $Pe_h$ 较大）时，中心差分格式如何产生非物理的振荡，从而强调了理解数值格式稳定性的重要性。[@problem_id:3395550]", "problem": "考虑稳态一维线性对流扩散边值问题\n$$\n- \\varepsilon\\, u_{xx} + \\beta\\, u_{x} = 0 \\quad \\text{on } (0,1),\n$$\n其狄利克雷边界条件为 $u(0)=0$ 和 $u(1)=1$，其中 $\\varepsilon>0$ 是扩散系数，$\\beta>0$ 是恒定对流速度。设区间 $[0,1]$ 被均匀划分为网格尺寸 $h=\\frac{1}{3}$，节点为 $x_i = i h$，$i=0,1,2,3$。在内部节点 $i=1,2$ 处，用标准二阶中心差分近似 $u_{xx}$，并用标准二阶中心差分近似 $u_x$。这将产生一个关于内部值 $u_1 \\approx u(x_1)$ 和 $u_2 \\approx u(x_2)$ 的线性系统。\n\n使用具体参数 $\\varepsilon=1$ 和 $\\beta=12$，构造并求解得到的二乘二线性系统，以获得第二个内部节点 $u_2$ 的中心差分近似值。你的构造过程应阐明为什么该选择对应于大网格 Péclet 数情况，并因此在用中心差分替代 $u_x$ 的后向（迎风）差分时，可作为单调性的一个反例。请提供 $u_2$ 的数值作为最终答案。无需四舍五入。", "solution": "该问题要求使用有限差分法和特定的参数值来求解一个一维稳态线性对流扩散方程。\n\n**步骤 1：问题构建与离散化**\n\n控制偏微分方程由下式给出：\n$$\n- \\varepsilon\\, u_{xx} + \\beta\\, u_{x} = 0 \\quad \\text{for } x \\in (0,1)\n$$\n边界条件为狄利克雷边界条件：\n$$\nu(0) = 0 \\quad \\text{and} \\quad u(1) = 1\n$$\n区域 $[0,1]$ 被离散化为尺寸为 $h=\\frac{1}{3}$ 的均匀网格。这产生了节点 $x_0=0$，$x_1=\\frac{1}{3}$，$x_2=\\frac{2}{3}$ 和 $x_3=1$。设 $u_i$ 为解 $u(x_i)$ 在这些节点上的数值近似。边界条件给出了端点处的已知值：\n$$\nu_0 = u(x_0) = u(0) = 0\n$$\n$$\nu_3 = u(x_3) = u(1) = 1\n$$\n未知值位于内部节点，$u_1$ 和 $u_2$。\n\n**步骤 2：有限差分近似**\n\n我们被要求对内部节点 $x_i$（$i=1,2$）的一阶和二阶导数均使用标准二阶中心差分近似。\n二阶导数 $u_{xx}$ 近似为：\n$$\nu_{xx}(x_i) \\approx \\frac{u_{i-1} - 2u_i + u_{i+1}}{h^2}\n$$\n一阶导数 $u_x$ 近似为：\n$$\nu_x(x_i) \\approx \\frac{u_{i+1} - u_{i-1}}{2h}\n$$\n将这些近似式代入控制方程，得到每个内部节点 $x_i$ 处的差分方程：\n$$\n- \\varepsilon \\left( \\frac{u_{i-1} - 2u_i + u_{i+1}}{h^2} \\right) + \\beta \\left( \\frac{u_{i+1} - u_{i-1}}{2h} \\right) = 0\n$$\n为简化起见，我们可以将整个方程乘以 $h^2$ 来去分母：\n$$\n- \\varepsilon (u_{i-1} - 2u_i + u_{i+1}) + \\frac{\\beta h}{2} (u_{i+1} - u_{i-1}) = 0\n$$\n重排各项，合并 $u_{i-1}$、$u_i$ 和 $u_{i+1}$ 的系数：\n$$\n\\left(-\\frac{\\varepsilon}{h^2} - \\frac{\\beta}{2h}\\right) u_{i-1} + \\left(\\frac{2\\varepsilon}{h^2}\\right) u_i + \\left(-\\frac{\\varepsilon}{h^2} + \\frac{\\beta}{2h}\\right) u_{i+1} = 0\n$$\n\n**步骤 3：构造线性系统**\n\n我们将此差分方程应用于两个内部节点 $x_1$（其中 $i=1$）和 $x_2$（其中 $i=2$）。\n\n对于节点 $i=1$：\n方程涉及 $u_0$、$u_1$ 和 $u_2$。我们代入已知的边界值 $u_0=0$：\n$$\n\\left(\\frac{2\\varepsilon}{h^2}\\right) u_1 + \\left(-\\frac{\\varepsilon}{h^2} + \\frac{\\beta}{2h}\\right) u_2 = 0\n$$\n\n对于节点 $i=2$：\n方程涉及 $u_1$、$u_2$ 和 $u_3$。我们代入已知的边界值 $u_3=1$：\n$$\n\\left(-\\frac{\\varepsilon}{h^2} - \\frac{\\beta}{2h}\\right) u_1 + \\left(\\frac{2\\varepsilon}{h^2}\\right) u_2 + \\left(-\\frac{\\varepsilon}{h^2} + \\frac{\\beta}{2h}\\right) (1) = 0\n$$\n将常数项移到等式右侧，得到：\n$$\n\\left(-\\frac{\\varepsilon}{h^2} - \\frac{\\beta}{2h}\\right) u_1 + \\left(\\frac{2\\varepsilon}{h^2}\\right) u_2 = \\frac{\\varepsilon}{h^2} - \\frac{\\beta}{2h}\n$$\n\n**步骤 4：代入参数并求解系统**\n\n给定参数 $\\varepsilon=1$、$\\beta=12$ 和 $h=\\frac{1}{3}$。我们首先计算系数的值：\n$$\n\\frac{2\\varepsilon}{h^2} = \\frac{2(1)}{(\\frac{1}{3})^2} = \\frac{2}{\\frac{1}{9}} = 18\n$$\n$$\n-\\frac{\\varepsilon}{h^2} = -\\frac{1}{(\\frac{1}{3})^2} = -9\n$$\n$$\n\\frac{\\beta}{2h} = \\frac{12}{2(\\frac{1}{3})} = \\frac{12}{\\frac{2}{3}} = 18\n$$\n现在，将这些值代入线性系统的两个方程中。\n\n$i=1$ 的方程：\n$$\n(18) u_1 + (-9 + 18) u_2 = 0 \\implies 18 u_1 + 9 u_2 = 0\n$$\n两边除以 $9$，我们得到：\n$$\n2 u_1 + u_2 = 0\n$$\n\n$i=2$ 的方程：\n$$\n(-9 - 18) u_1 + (18) u_2 = 9 - 18\n$$\n$$\n-27 u_1 + 18 u_2 = -9\n$$\n两边除以 $9$，我们得到：\n$$\n-3 u_1 + 2 u_2 = -1\n$$\n这个二乘二线性系统是：\n$$\n\\begin{cases}\n2 u_1 + u_2 = 0 \\\\\n-3 u_1 + 2 u_2 = -1\n\\end{cases}\n$$\n从第一个方程，我们可以用 $u_1$ 表示 $u_2$：\n$$\nu_2 = -2 u_1\n$$\n将此表达式代入第二个方程：\n$$\n-3 u_1 + 2 (-2 u_1) = -1\n$$\n$$\n-3 u_1 - 4 u_1 = -1\n$$\n$$\n-7 u_1 = -1 \\implies u_1 = \\frac{1}{7}\n$$\n现在我们可以求出 $u_2$ 的值：\n$$\nu_2 = -2 u_1 = -2 \\left(\\frac{1}{7}\\right) = -\\frac{2}{7}\n$$\n线性系统的解是 $u_1 = \\frac{1}{7}$ 和 $u_2 = -\\frac{2}{7}$。\n\n**步骤 5：在网格 Péclet 数背景下的解释**\n\n网格 Péclet 数定义为 $Pe_h = \\frac{\\beta h}{2\\varepsilon}$。对于给定的参数：\n$$\nPe_h = \\frac{(12) (\\frac{1}{3})}{2(1)} = \\frac{4}{2} = 2\n$$\n当对流项使用中心差分时，众所周知，为使解在定性上正确（即单调，无伪振荡），网格 Péclet 数必须满足条件 $Pe_h \\le 1$。在我们的例子中，$Pe_h=2 > 1$，这使我们处于大网格 Péclet 数情况，此时中心差分法是不稳定的，并且容易产生非物理振荡。\n\n该边值问题的解析解是 $u(x) = \\frac{\\exp(\\frac{\\beta}{\\varepsilon}x) - 1}{\\exp(\\frac{\\beta}{\\varepsilon}) - 1}$，该解是严格单调的，且界于 $0$ 和 $1$ 之间。我们在节点上的数值解是 $u_0=0$，$u_1=\\frac{1}{7}$，$u_2=-\\frac{2}{7}$ 和 $u_3=1$。负值 $u_2 = -\\frac{2}{7}$ 明显违反了物理界限，并展示了当对流项占主导且网格过粗时，中心差分格式所预测的非单调、振荡行为。这可作为问题陈述中提到的单调性的反例。若对流项使用后向（迎风）差分，则会产生一个单调解。\n\n问题特别要求给出 $u_2$ 的数值。\n$$\nu_2 = -\\frac{2}{7}\n$$", "answer": "$$\n\\boxed{-\\frac{2}{7}}\n$$", "id": "3395550"}, {"introduction": "在掌握了差分格式的推导和局限性之后，一个自然的问题是如何系统地提高其精度。理查森外推法 (Richardson Extrapolation) 提供了一种强大的通用策略，它通过巧妙地组合使用不同步长（例如 $h$ 和 $h/2$）计算出的两个近似值，来消除主导误差项。本练习将引导您应用理查森外推法，将两个二阶中心差分近似组合成一个四阶精度的格式，展示了如何用较低阶的公式构建出更高阶、更精确的近似。[@problem_id:3395551]", "problem": "考虑一个光滑函数 $u(x)$，它是在偏微分方程（PDE）离散化中出现的空间解场。设 $x$ 是一个固定位置，在该点的邻域内 $u$ 至少是 $C^{6}$ 光滑的，并假设有一个间距为 $h>0$ 的均匀网格以及一个间距为 $h/2$ 的加密网格可用。步长为 $h$ 的 $u'(x)$ 的标准二阶中心差分近似使用 $x\\pm h$ 处的对称模板，而步长为 $h/2$ 的类似近似使用 $x\\pm h/2$ 处的对称模板。\n\n从关于 $x$ 的泰勒定理和中心差商的定义出发，推导步长为 $h$ 和 $h/2$ 的两种中心差分近似的主阶截断误差展开式。然后，使用理查森外推（RE）构造这两种近似的线性组合，以抵消 $\\mathcal{O}(h^{2})$ 误差项，从而在 $h$ 上达到四阶精度。确定外推系数，并用 $u(x+h)$、$u(x-h)$、$u(x+h/2)$ 和 $u(x-h/2)$ 显式地写出得到的四阶近似。\n\n将你的最终答案表示为 $u'(x)$ 的外推近似的单个闭式解析表达式。无需四舍五入。", "solution": "该问题陈述是一个适定的、理论上合理的数值分析练习。它基于已建立的数学原理（泰勒定理、理查森外推），并提供了推导唯一、有意义解所需的所有必要条件（例如，$C^{6}$ 光滑性）。因此，该问题被认为是有效的。\n\n设 $u(x)$ 是在一个点 $x$ 的邻域内至少 $6$ 次连续可微（$C^{6}$）的函数。使用步长 $h>0$ 对一阶导数 $u'(x)$ 的标准二阶中心差分近似由以下公式给出：\n$$\nD_h[u](x) = \\frac{u(x+h) - u(x-h)}{2h}\n$$\n使用加密步长 $h/2$ 的类似近似为：\n$$\nD_{h/2}[u](x) = \\frac{u(x+h/2) - u(x-h/2)}{2(h/2)} = \\frac{u(x+h/2) - u(x-h/2)}{h}\n$$\n为分析这些近似的截断误差，我们使用泰勒定理。鉴于 $u$ 是 $C^{6}$ 光滑的，我们可以将 $u(x+z)$ 在 $z=0$ 附近展开到五阶项，其余项为 $\\mathcal{O}(z^6)$：\n$$\nu(x+z) = u(x) + u'(x)z + \\frac{u''(x)}{2!}z^2 + \\frac{u'''(x)}{3!}z^3 + \\frac{u^{(4)}(x)}{4!}z^4 + \\frac{u^{(5)}(x)}{5!}z^5 + \\mathcal{O}(z^6)\n$$\n分别代入 $z=h$ 和 $z=-h$，我们得到：\n$$\nu(x+h) = u(x) + u'(x)h + \\frac{u''(x)}{2}h^2 + \\frac{u'''(x)}{6}h^3 + \\frac{u^{(4)}(x)}{24}h^4 + \\frac{u^{(5)}(x)}{120}h^5 + \\mathcal{O}(h^6)\n$$\n$$\nu(x-h) = u(x) - u'(x)h + \\frac{u''(x)}{2}h^2 - \\frac{u'''(x)}{6}h^3 + \\frac{u^{(4)}(x)}{24}h^4 - \\frac{u^{(5)}(x)}{120}h^5 + \\mathcal{O}(h^6)\n$$\n用第一个展开式减去第二个展开式，可以消去 $h$ 的偶数次幂项（即 $u(x)$、$u''(x)$、$u^{(4)}(x)$）：\n$$\nu(x+h) - u(x-h) = 2u'(x)h + 2\\frac{u'''(x)}{6}h^3 + 2\\frac{u^{(5)}(x)}{120}h^5 + \\mathcal{O}(h^7)\n$$\n注意，余项变为 $\\mathcal{O}(h^7)$，因为原始展开式中的 $h^6$ 项符号相反，也相互抵消。除以 $2h$ 得到 $D_h[u](x)$ 的误差展开式：\n$$\nD_h[u](x) = u'(x) + \\frac{u'''(x)}{6}h^2 + \\frac{u^{(5)}(x)}{120}h^4 + \\mathcal{O}(h^6)\n$$\n主阶截断误差为 $\\frac{u'''(x)}{6}h^2$。这证实了该近似是二阶精度的。\n\n为求得 $D_{h/2}[u](x)$ 的误差展开式，我们在上述表达式中用 $h/2$ 替换 $h$：\n$$\nD_{h/2}[u](x) = u'(x) + \\frac{u'''(x)}{6}\\left(\\frac{h}{2}\\right)^2 + \\frac{u^{(5)}(x)}{120}\\left(\\frac{h}{2}\\right)^4 + \\mathcal{O}\\left(h^6\\right)\n$$\n$$\nD_{h/2}[u](x) = u'(x) + \\frac{u'''(x)}{24}h^2 + \\frac{u^{(5)}(x)}{1920}h^4 + \\mathcal{O}(h^6)\n$$\n这个更精细近似的主阶截断误差为 $\\frac{u'''(x)}{24}h^2$。\n\n我们现在使用理查森外推来寻找 $D_h[u](x)$ 和 $D_{h/2}[u](x)$ 的线性组合，以消除 $\\mathcal{O}(h^2)$ 误差项。设 $L=u'(x)$ 为精确值。我们有两个近似：\n$$\nA_h = D_h[u](x) = L + K_2 h^2 + K_4 h^4 + \\mathcal{O}(h^6)\n$$\n$$\nA_{h/2} = D_{h/2}[u](x) = L + K_2 \\frac{h^2}{4} + K_4 \\frac{h^4}{16} + \\mathcal{O}(h^6)\n$$\n其中 $K_2 = \\frac{u'''(x)}{6}$ 且 $K_4 = \\frac{u^{(5)}(x)}{120}$。我们寻求一个外推近似 $A_{RE} = c_1 A_{h/2} + c_2 A_h$。为了使 $A_{RE}$ 成为 $L$ 的相容近似，我们要求 $c_1 + c_2 = 1$。为抵消 $\\mathcal{O}(h^2)$ 项，我们要求：\n$$\nc_1 \\left(K_2 \\frac{h^2}{4}\\right) + c_2 (K_2 h^2) = 0 \\implies \\frac{c_1}{4} + c_2 = 0\n$$\n这给出了一个关于系数 $c_1$ 和 $c_2$ 的二元线性方程组：\n\\begin{cases} c_1 + c_2 = 1 \\\\ \\frac{c_1}{4} + c_2 = 0 \\end{cases}\n由第二个方程得 $c_2 = -c_1/4$。代入第一个方程得：\n$$\nc_1 - \\frac{c_1}{4} = 1 \\implies \\frac{3c_1}{4} = 1 \\implies c_1 = \\frac{4}{3}\n$$\n第二个系数是 $c_2 = 1 - c_1 = 1 - \\frac{4}{3} = -\\frac{1}{3}$。\n外推系数为 $c_1 = 4/3$ 和 $c_2 = -1/3$。\n\n因此，四阶精度近似为：\n$$\nA_{RE} = \\frac{4}{3}A_{h/2} - \\frac{1}{3}A_h = \\frac{4}{3}D_{h/2}[u](x) - \\frac{1}{3}D_h[u](x)\n$$\n这个新近似的误差为 $\\mathcal{O}(h^4)$：\n$$\nA_{RE} = L + \\left(\\frac{4}{3}\\frac{K_4}{16} - \\frac{1}{3}K_4\\right)h^4 + \\mathcal{O}(h^6) = L + \\left(\\frac{K_4}{12} - \\frac{K_4}{3}\\right)h^4 + \\mathcal{O}(h^6) = L - \\frac{K_4}{4}h^4 + \\mathcal{O}(h^6)\n$$\n主误差项为 $-\\frac{h^4}{4}K_4 = -\\frac{h^4}{4}\\frac{u^{(5)}(x)}{120} = -\\frac{u^{(5)}(x)}{480}h^4$。\n\n最后，我们用函数值显式地写出该近似：\n$$\nA_{RE} = \\frac{4}{3} \\left( \\frac{u(x+h/2) - u(x-h/2)}{h} \\right) - \\frac{1}{3} \\left( \\frac{u(x+h) - u(x-h)}{2h} \\right)\n$$\n将各项合并到一个公分母 $6h$ 上：\n$$\nA_{RE} = \\frac{1}{6h} \\left[ 8 \\left(u\\left(x+\\frac{h}{2}\\right) - u\\left(x-\\frac{h}{2}\\right)\\right) - \\left(u(x+h) - u(x-h)\\right) \\right]\n$$\n整理各项得到 $u'(x)$ 的四阶近似的最终表达式：\n$$\nA_{RE} = \\frac{-u(x+h) + 8u(x+h/2) - 8u(x-h/2) + u(x-h)}{6h}\n$$", "answer": "$$\n\\boxed{\\frac{-u(x+h) + 8u\\left(x+\\frac{h}{2}\\right) - 8u\\left(x-\\frac{h}{2}\\right) + u(x-h)}{6h}}\n$$", "id": "3395551"}]}