{"hands_on_practices": [{"introduction": "要真正掌握抽象的定义，将其应用于具体示例是至关重要的一步。本练习要求您直接根据积分定义，为一个简单的三角函数计算其 $H^1$ 索博列夫范数和半范数。这项实践将巩固您对范数如何量化函数大小及其导数大小的理解，这正是偏微分方程分析中的核心要素 [@problem_id:3397294]。", "problem": "考虑与区间 $(0,1)$ 相关的索博列夫空间 $H^{1}(0,1)$，该空间在线性椭圆偏微分方程 (PDE) 的弱形式中出现。令 $u(x)=\\sin(\\pi x)$，其中 $x\\in(0,1)$。仅使用勒贝格空间 $L^{2}(0,1)$ 范数、弱导数、$H^{1}(0,1)$ 半范数和 $H^{1}(0,1)$ 范数的基本定义，计算 $u$ 的 $H^{1}(0,1)$ 半范数和 $H^{1}(0,1)$ 范数。然后通过计算半范数与范数的比值来比较它们的大小。将结果表示为行向量 $\\big(|u|_{H^{1}(0,1)}, \\|u\\|_{H^{1}(0,1)}, |u|_{H^{1}(0,1)}/\\|u\\|_{H^{1}(0,1)}\\big)$。以精确的解析形式表示答案，不进行四舍五入。", "solution": "该问题是适定的，具有科学依据，并为得到唯一解提供了所有必要信息。所涉及的概念——索博列夫空间、范数和弱导数——是偏微分方程数学分析中的标准概念。因此，我们可以开始求解。\n\n问题要求计算定义在区域 $\\Omega = (0,1)$ 上的函数 $u(x) = \\sin(\\pi x)$ 的 $H^{1}(0,1)$ 半范数、$H^{1}(0,1)$ 范数以及它们的比值。我们将按照规定，使用基本定义进行计算。\n\n首先，我们回顾一下定义。索博列夫空间 $H^{1}(\\Omega)$ 是勒贝格空间 $L^{2}(\\Omega)$ 中一阶弱导数也在 $L^{2}(\\Omega)$ 中的函数 $v$ 构成的空间。对于我们的一维区域 $\\Omega=(0,1)$，这可以写成 $H^{1}(0,1) = \\{v \\in L^{2}(0,1) \\mid v' \\in L^{2}(0,1)\\}$。\n\n函数 $v$ 的 $L^{2}(0,1)$ 范数定义为：\n$$ \\|v\\|_{L^{2}(0,1)} = \\left( \\int_{0}^{1} |v(x)|^{2} \\,dx \\right)^{1/2} $$\n\n函数 $v \\in L^{2}(0,1)$ 的弱导数 $v'$ 是一个满足以下关系的函数：\n$$ \\int_{0}^{1} v'(x) \\phi(x) \\,dx = - \\int_{0}^{1} v(x) \\phi'(x) \\,dx $$\n对于所有测试函数 $\\phi \\in C_{c}^{\\infty}(0,1)$（在 $(0,1)$ 上具有紧支集的无穷次可微函数）成立。\n对于给定的函数 $u(x) = \\sin(\\pi x)$，它在整个实数轴上是连续可微的，因此其弱导数与其经典导数一致。经典导数为 $u'(x) = \\pi \\cos(\\pi x)$。由于 $u(x)$ 和 $u'(x)$ 都是闭区间 $[0,1]$ 上的连续有界函数，因此它们是平方可积的，即 $u \\in L^{2}(0,1)$ 且 $u' \\in L^{2}(0,1)$。因此，$u(x) = \\sin(\\pi x)$ 是索博列夫空间 $H^{1}(0,1)$ 中的一个元素。\n\n$H^{1}(0,1)$ 半范数，记为 $|v|_{H^{1}(0,1)}$，是弱导数的 $L^{2}$ 范数：\n$$ |v|_{H^{1}(0,1)} = \\|v'\\|_{L^{2}(0,1)} = \\left( \\int_{0}^{1} |v'(x)|^{2} \\,dx \\right)^{1/2} $$\n$H^{1}(0,1)$ 范数，记为 $\\|v\\|_{H^{1}(0,1)}$，定义为：\n$$ \\|v\\|_{H^{1}(0,1)} = \\left( \\|v\\|_{L^{2}(0,1)}^{2} + |v|_{H^{1}(0,1)}^{2} \\right)^{1/2} = \\left( \\int_{0}^{1} |v(x)|^{2} \\,dx + \\int_{0}^{1} |v'(x)|^{2} \\,dx \\right)^{1/2} $$\n\n现在，我们来计算函数 $u(x) = \\sin(\\pi x)$ 的这些量。\n\n首先，我们计算 $u(x)$ 的 $L^{2}$ 范数的平方：\n$$ \\|u\\|_{L^{2}(0,1)}^{2} = \\int_{0}^{1} (\\sin(\\pi x))^{2} \\,dx $$\n使用三角恒等式 $\\sin^{2}(\\theta) = \\frac{1 - \\cos(2\\theta)}{2}$，我们得到：\n$$ \\|u\\|_{L^{2}(0,1)}^{2} = \\int_{0}^{1} \\frac{1 - \\cos(2\\pi x)}{2} \\,dx = \\frac{1}{2} \\left[ x - \\frac{\\sin(2\\pi x)}{2\\pi} \\right]_{0}^{1} $$\n$$ = \\frac{1}{2} \\left( \\left(1 - \\frac{\\sin(2\\pi)}{2\\pi}\\right) - \\left(0 - \\frac{\\sin(0)}{2\\pi}\\right) \\right) = \\frac{1}{2} ( (1 - 0) - (0 - 0) ) = \\frac{1}{2} $$\n\n接下来，我们计算 $H^{1}$ 半范数的平方，也就是导数 $u'(x) = \\pi \\cos(\\pi x)$ 的 $L^{2}$ 范数的平方：\n$$ |u|_{H^{1}(0,1)}^{2} = \\|u'\\|_{L^{2}(0,1)}^{2} = \\int_{0}^{1} (\\pi \\cos(\\pi x))^{2} \\,dx = \\pi^{2} \\int_{0}^{1} \\cos^{2}(\\pi x) \\,dx $$\n使用三角恒等式 $\\cos^{2}(\\theta) = \\frac{1 + \\cos(2\\theta)}{2}$，我们得到：\n$$ |u|_{H^{1}(0,1)}^{2} = \\pi^{2} \\int_{0}^{1} \\frac{1 + \\cos(2\\pi x)}{2} \\,dx = \\frac{\\pi^{2}}{2} \\left[ x + \\frac{\\sin(2\\pi x)}{2\\pi} \\right]_{0}^{1} $$\n$$ = \\frac{\\pi^{2}}{2} \\left( \\left(1 + \\frac{\\sin(2\\pi)}{2\\pi}\\right) - \\left(0 + \\frac{\\sin(0)}{2\\pi}\\right) \\right) = \\frac{\\pi^{2}}{2} ( (1 + 0) - (0 + 0) ) = \\frac{\\pi^{2}}{2} $$\n由此，我们求得半范数：\n$$ |u|_{H^{1}(0,1)} = \\sqrt{\\frac{\\pi^{2}}{2}} = \\frac{\\pi}{\\sqrt{2}} $$\n\n现在，我们计算 $H^{1}$ 范数。我们使用已经计算出的范数的平方：\n$$ \\|u\\|_{H^{1}(0,1)}^{2} = \\|u\\|_{L^{2}(0,1)}^{2} + |u|_{H^{1}(0,1)}^{2} = \\frac{1}{2} + \\frac{\\pi^{2}}{2} = \\frac{1+\\pi^{2}}{2} $$\n取平方根得到范数：\n$$ \\|u\\|_{H^{1}(0,1)} = \\sqrt{\\frac{1+\\pi^{2}}{2}} = \\frac{\\sqrt{1+\\pi^{2}}}{\\sqrt{2}} $$\n\n最后，我们计算半范数与范数的比值：\n$$ \\frac{|u|_{H^{1}(0,1)}}{\\|u\\|_{H^{1}(0,1)}} = \\frac{\\left(\\frac{\\pi}{\\sqrt{2}}\\right)}{\\left(\\frac{\\sqrt{1+\\pi^{2}}}{\\sqrt{2}}\\right)} = \\frac{\\pi}{\\sqrt{1+\\pi^{2}}} $$\n\n问题要求将结果表示为行向量 $\\big(|u|_{H^{1}(0,1)}, \\|u\\|_{H^{1}(0,1)}, |u|_{H^{1}(0,1)}/\\|u\\|_{H^{1}(0,1)}\\big)$。代入我们计算出的值，得到：\n$$ \\left( \\frac{\\pi}{\\sqrt{2}}, \\frac{\\sqrt{1+\\pi^{2}}}{\\sqrt{2}}, \\frac{\\pi}{\\sqrt{1+\\pi^{2}}} \\right) $$", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{\\pi}{\\sqrt{2}}  \\frac{\\sqrt{1+\\pi^{2}}}{\\sqrt{2}}  \\frac{\\pi}{\\sqrt{1+\\pi^{2}}}\n\\end{pmatrix}\n}\n$$", "id": "3397294"}, {"introduction": "在有限元法（FEM）等数值方法中，我们通常在标准的“参考单元”上进行分析，然后将结果推广到实际的网格单元上。本练习将深入探讨这一关键过程，要求您推导 $H^1$ 半范数在此类仿射变换下的缩放规律 [@problem_id:3397300]。通过这一推导，您将得出一个基本的“反向不等式”，这是有限元分析的基石，对于证明数值算法的稳定性和收敛性至关重要。", "problem": "设 $\\hat K \\subset \\mathbb{R}^{d}$ 是一个具有非空内部和单位直径的固定参考单元，并设 $K \\subset \\mathbb{R}^{d}$ 是一个物理单元，它通过形式为 $x = F(\\hat x) = B \\hat x + b$ 的仿射映射 $F:\\hat K \\to K$ 从 $\\hat K$ 获得，其中 $B \\in \\mathbb{R}^{d \\times d}$ 是可逆的，$b \\in \\mathbb{R}^{d}$。将 $K$ 的直径记为 $h = \\operatorname{diam}(K) = \\sup_{x,y \\in K} |x - y|$。对于 $v \\in H^{1}(K)$，定义 $\\hat v \\in H^{1}(\\hat K)$ 为 $\\hat v(\\hat x) = v(F(\\hat x))$。回想一下，对于任何可测函数 $g$ 和任何可逆仿射映射 $F$，变量替换公式表明 $\\int_{K} g(x)\\,dx = \\int_{\\hat K} g(F(\\hat x))\\,|\\det B|\\,d\\hat x$，而梯度的链式法则给出 $\\nabla_{\\hat x} \\hat v(\\hat x) = B^{T} \\nabla_{x} v(F(\\hat x))$。\n\n假设一个形状正则的仿射映射族，其含义如下：存在正常数 $c_{\\min}$ 和 $c_{\\max}$，它们独立于 $K$ 和 $h$，使得 $c_{\\min}\\,h \\le \\|B\\| \\le c_{\\max}\\,h$ 和 $c_{\\min}\\,h^{d} \\le |\\det B| \\le c_{\\max}\\,h^{d}$，其中 $\\|\\cdot\\|$ 是由欧几里得范数诱导的算子范数。设 $|\\cdot|_{H^{1}(D)}$ 表示区域 $D$ 上的 $H^{1}$ 半范数，即 $|w|_{H^{1}(D)} := \\|\\nabla w\\|_{L^{2}(D)}$。\n\n任务 A. 仅从所述的变量替换和链式法则出发，推导在仿射映射下 $H^{1}$ 半范数缩放的显式 $h$ 依赖关系，即存在一个与 $h$ 无关的形状常数 $C_{\\mathrm{sr}} \\ge 1$，使得\n$$\nC_{\\mathrm{sr}}^{-1}\\,S(h,d)\\,|\\hat v|_{H^{1}(\\hat K)} \\le |v|_{H^{1}(K)} \\le C_{\\mathrm{sr}}\\,S(h,d)\\,|\\hat v|_{H^{1}(\\hat K)}.\n$$\n将 $S(h,d)$ 确定为仅含 $h$ 和 $d$ 的单个表达式。\n\n任务 B. 设 $V_{h}(K)$ 是在 $F$ 映射下一个固定的多项式空间 $V(\\hat K)$ 的像，该空间由 $\\hat K$ 上总次数至多为 $p$ 的所有多项式组成，其中 $p$ 的取值与 $h$ 无关。仅使用 $V(\\hat K)$ 上的有限维范数等价性和您从任务 A 得到的结果，推导出反不等式\n$$\n\\|\\nabla v_{h}\\|_{L^{2}(K)} \\le C\\,h^{-1}\\,\\|v_{h}\\|_{L^{2}(K)} \\quad \\text{for all } v_{h} \\in V_{h}(K),\n$$\n其中常数 $C$ 与 $h$ 无关。\n\n答案规格：您的最终答案必须是您在任务 A 中为 $S(h,d)$ 找到的单个闭式表达式。无需单位，也无需四舍五入。将您的答案表示为仅含 $h$ 和 $d$ 的函数。", "solution": "用户提供了一个问题，要求推导仿射映射下 $H^{1}$ 半范数的缩放定律，并随后推导一个有限元反不等式。\n\n### 问题验证\n\n**第 1 步：提取已知条件**\n\n*   参考单元：$\\hat K \\subset \\mathbb{R}^{d}$，非空内部，$\\operatorname{diam}(\\hat K) = 1$。\n*   物理单元：$K \\subset \\mathbb{R}^{d}$，$\\operatorname{diam}(K) = h$。\n*   仿射映射：$F:\\hat K \\to K$，$x = F(\\hat x) = B \\hat x + b$，其中 $B \\in \\mathbb{R}^{d \\times d}$ 可逆，$b \\in \\mathbb{R}^{d}$。\n*   函数映射：对于 $v \\in H^{1}(K)$，$\\hat v \\in H^{1}(\\hat K)$ 定义为 $\\hat v(\\hat x) = v(F(\\hat x))$。\n*   变量替换：$\\int_{K} g(x)\\,dx = \\int_{\\hat K} g(F(\\hat x))\\,|\\det B|\\,d\\hat x$。\n*   链式法则：$\\nabla_{\\hat x} \\hat v(\\hat x) = B^{T} \\nabla_{x} v(F(\\hat x))$。\n*   形状正则性假设：存在与 $K$ 和 $h$ 无关的正常数 $c_{\\min}$ 和 $c_{\\max}$，使得：\n    1.  $c_{\\min}\\,h \\le \\|B\\| \\le c_{\\max}\\,h$，其中 $\\|\\cdot\\|$ 是算子范数。\n    2.  $c_{\\min}\\,h^{d} \\le |\\det B| \\le c_{\\max}\\,h^{d}$。\n*   $H^1$ 半范数定义：$|w|_{H^{1}(D)} := \\|\\nabla w\\|_{L^{2}(D)} = \\left(\\int_{D} |\\nabla w(y)|^2 dy\\right)^{1/2}$。\n*   任务 A 目标：在关系式 $C_{\\mathrm{sr}}^{-1}\\,S(h,d)\\,|\\hat v|_{H^{1}(\\hat K)} \\le |v|_{H^{1}(K)} \\le C_{\\mathrm{sr}}\\,S(h,d)\\,|\\hat v|_{H^{1}(\\hat K)}$ 中找到 $S(h,d)$。\n*   任务 B 设置：$V(\\hat K)$ 是总次数至多为 $p$ 的多项式空间。$V_{h}(K)$ 是 $V(\\hat K)$ 在映射 $F$ 下的像。\n*   任务 B 目标：对所有 $v_{h} \\in V_{h}(K)$，推导反不等式 $\\|\\nabla v_{h}\\|_{L^{2}(K)} \\le C\\,h^{-1}\\,\\|v_{h}\\|_{L^{2}(K)}$。\n\n**第 2 步：使用提取的已知条件进行验证**\n\n该问题陈述是有限元方法数学理论中的一个标准练习。\n*   **科学依据**：该问题基于线性代数、多元微积分（变量替换、链式法则）和泛函分析（$L^2$ 和 Sobolev 空间）的基本原理。形状正则性的概念和缩放定律的推导是有限元方法收敛性分析的核心。该问题在数学和科学上是合理的。\n*   **适定性**：问题陈述清晰，包含了所有必要的定义和假设。如解答推导所示，所提供的假设足以得到唯一的缩放因子 $S(h,d)$ 并证明反不等式。问题没有欠定或过定。\n*   **客观性**：语言精确且数学化，没有任何主观性或歧义。\n\n该问题不违反任何无效性标准。所有术语都是标准的或有明确定义。假设是自洽的，并且足以完成任务。\n\n**第 3 步：结论与行动**\n\n问题有效。我将继续进行解答。\n\n### 解答\n\n根据问题陈述的要求，解答分为两部分。\n\n**任务 A：$H^{1}$ 半范数的缩放**\n\n目标是找到缩放因子 $S(h,d)$，它将物理单元 $K$ 上函数 $v$ 的 $H^{1}$ 半范数与参考单元 $\\hat{K}$ 上相应函数 $\\hat{v}$ 的半范数联系起来。\n\n$K$ 上 $v$ 的 $H^{1}$ 半范数的平方定义为：\n$$\n|v|_{H^{1}(K)}^{2} = \\int_{K} |\\nabla_{x} v(x)|^{2} dx\n$$\n我们应用给定的变量替换公式，令 $g(x) = |\\nabla_{x} v(x)|^{2}$。\n$$\n|v|_{H^{1}(K)}^{2} = \\int_{\\hat K} |\\nabla_{x} v(F(\\hat x))|^{2} |\\det B| \\,d\\hat x\n$$\n接下来，我们使用给定的链式法则 $\\nabla_{\\hat x} \\hat v(\\hat x) = B^{T} \\nabla_{x} v(F(\\hat x))$。因为 $B$ 是可逆的，所以 $B^T$ 也是可逆的。我们可以写出：\n$$\n\\nabla_{x} v(F(\\hat x)) = (B^{T})^{-1} \\nabla_{\\hat x} \\hat v(\\hat x)\n$$\n将此代入积分表达式得到：\n$$\n|v|_{H^{1}(K)}^{2} = \\int_{\\hat K} |(B^{T})^{-1} \\nabla_{\\hat x} \\hat v(\\hat x)|^{2} |\\det B| \\,d\\hat x\n$$\n令向量场 $\\hat w(\\hat x) = \\nabla_{\\hat x} \\hat v(\\hat x)$。平方范数是点积：\n$$\n|(B^{T})^{-1} \\hat w|^{2} = ((B^{T})^{-1} \\hat w) \\cdot ((B^{T})^{-1} \\hat w) = \\hat w^{T} (B^{T})^{-T} (B^{T})^{-1} \\hat w = \\hat w^{T} (B^{-1}) (B^{T})^{-1} \\hat w = \\hat w^{T} (B B^{T})^{-1} \\hat w\n$$\n矩阵 $(B B^{T})^{-1}$ 是对称正定的。表达式 $\\hat w^{T} (B B^{T})^{-1} \\hat w$ 可以由 $(B B^{T})^{-1}$ 的最小和最大特征值界定。$B B^{T}$ 的特征值是 $B$ 的奇异值（记为 $\\sigma_i(B)$）的平方。因此，$(B B^{T})^{-1}$ 的特征值为 $1/\\sigma_i(B)^{2}$。\n令 $\\sigma_{\\min}(B)$ 和 $\\sigma_{\\max}(B)$ 分别为 $B$ 的最小和最大奇异值。那么 $(B B^{T})^{-1}$ 的最小和最大特征值分别为 $1/\\sigma_{\\max}(B)^{2}$ 和 $1/\\sigma_{\\min}(B)^{2}$。\n我们知道算子范数为 $\\|B\\| = \\sigma_{\\max}(B)$ 且 $\\|B^{-1}\\| = 1/\\sigma_{\\min}(B)$。因此，瑞利商的界为：\n$$\n\\frac{1}{\\|B\\|^{2}} |\\hat w|^{2} \\le \\hat w^{T} (B B^{T})^{-1} \\hat w \\le \\|B^{-1}\\|^{2} |\\hat w|^{2}\n$$\n将这些界应用于我们的积分表达式，我们得到两个不等式。\n\n对于上界：\n$$\n|v|_{H^{1}(K)}^{2} \\le \\int_{\\hat K} \\|B^{-1}\\|^{2} |\\nabla_{\\hat x} \\hat v(\\hat x)|^{2} |\\det B| \\,d\\hat x = \\|B^{-1}\\|^{2} |\\det B| \\int_{\\hat K} |\\nabla_{\\hat x} \\hat v(\\hat x)|^{2} \\,d\\hat x = \\|B^{-1}\\|^{2} |\\det B| |\\hat v|_{H^{1}(\\hat K)}^{2}\n$$\n对于下界：\n$$\n|v|_{H^{1}(K)}^{2} \\ge \\int_{\\hat K} \\frac{1}{\\|B\\|^{2}} |\\nabla_{\\hat x} \\hat v(\\hat x)|^{2} |\\det B| \\,d\\hat x = \\frac{|\\det B|}{\\|B\\|^{2}} \\int_{\\hat K} |\\nabla_{\\hat x} \\hat v(\\hat x)|^{2} \\,d\\hat x = \\frac{|\\det B|}{\\|B\\|^{2}} |\\hat v|_{H^{1}(\\hat K)}^{2}\n$$\n现在，我们使用形状正则性假设。首先，我们必须界定 $\\|B^{-1}\\|$。根据奇异值的性质，$\\|B^{-1}\\| = 1/\\sigma_{\\min}(B)$。行列式是奇异值的乘积，$|\\det B| = \\prod_{i=1}^d \\sigma_i(B)$。因此，$|\\det B| \\le \\sigma_{\\min}(B) (\\sigma_{\\max}(B))^{d-1} = \\sigma_{\\min}(B) \\|B\\|^{d-1}$。这导出 $\\sigma_{\\min}(B) \\ge \\frac{|\\det B|}{\\|B\\|^{d-1}}$。因此：\n$$\n\\|B^{-1}\\| = \\frac{1}{\\sigma_{\\min}(B)} \\le \\frac{\\|B\\|^{d-1}}{|\\det B|}\n$$\n使用给定的假设 $c_{\\min}\\,h \\le \\|B\\| \\le c_{\\max}\\,h$ 和 $c_{\\min}\\,h^{d} \\le |\\det B| \\le c_{\\max}\\,h^{d}$：\n$$\n\\|B^{-1}\\| \\le \\frac{(c_{\\max}h)^{d-1}}{c_{\\min}h^{d}} = \\frac{c_{\\max}^{d-1}}{c_{\\min}} h^{-1}\n$$\n现在我们可以界定不等式中的各项。\n对于 $|v|_{H^{1}(K)}$ 的上界：\n$$\n|v|_{H^{1}(K)}^{2} \\le \\|B^{-1}\\|^{2} |\\det B| |\\hat v|_{H^{1}(\\hat K)}^{2} \\le \\left(\\frac{c_{\\max}^{d-1}}{c_{\\min}} h^{-1}\\right)^{2} (c_{\\max}h^{d}) |\\hat v|_{H^{1}(\\hat K)}^{2} = \\frac{c_{\\max}^{2d-2+1}}{c_{\\min}^{2}} h^{-2+d} |\\hat v|_{H^{1}(\\hat K)}^{2} = \\frac{c_{\\max}^{2d-1}}{c_{\\min}^{2}} h^{d-2} |\\hat v|_{H^{1}(\\hat K)}^{2}\n$$\n对于 $|v|_{H^{1}(K)}$ 的下界：\n$$\n|v|_{H^{1}(K)}^{2} \\ge \\frac{|\\det B|}{\\|B\\|^{2}} |\\hat v|_{H^{1}(\\hat K)}^{2} \\ge \\frac{c_{\\min}h^{d}}{(c_{\\max}h)^{2}} |\\hat v|_{H^{1}(\\hat K)}^{2} = \\frac{c_{\\min}}{c_{\\max}^{2}} h^{d-2} |\\hat v|_{H^{1}(\\hat K)}^{2}\n$$\n对两个不等式取平方根，我们得到：\n$$\n\\sqrt{\\frac{c_{\\min}}{c_{\\max}^{2}}} h^{\\frac{d-2}{2}} |\\hat v|_{H^{1}(\\hat K)} \\le |v|_{H^{1}(K)} \\le \\sqrt{\\frac{c_{\\max}^{2d-1}}{c_{\\min}^{2}}} h^{\\frac{d-2}{2}} |\\hat v|_{H^{1}(\\hat K)}\n$$\n这是 $C_{\\mathrm{sr}}^{-1}\\,S(h,d)\\,|\\hat v|_{H^{1}(\\hat K)} \\le |v|_{H^{1}(K)} \\le C_{\\mathrm{sr}}\\,S(h,d)\\,|\\hat v|_{H^{1}(\\hat K)}$ 的形式，其中形状常数 $C_{\\mathrm{sr}}$ 取决于 $c_{\\min}$、$c_{\\max}$ 和 $d$，但不取决于 $h$。缩放因子 $S(h,d)$ 被确定为：\n$$\nS(h,d) = h^{\\frac{d-2}{2}}\n$$\n\n**任务 B：反不等式**\n\n我们想要对 $v_h \\in V_h(K)$ 推导反不等式 $\\|\\nabla v_{h}\\|_{L^{2}(K)} \\le C\\,h^{-1}\\,\\|v_{h}\\|_{L^{2}(K)}$。这等价于 $|v_h|_{H^1(K)} \\le C h^{-1} \\|v_h\\|_{L^2(K)}$。\n令 $v_h \\in V_h(K)$。那么存在一个次数至多为 $p$ 的多项式 $\\hat{v}_h \\in V(\\hat{K})$，使得对于 $x = F(\\hat{x})$，有 $v_h(x) = \\hat{v}_h(\\hat{x})$。\n\n1.  **将 $|v_h|_{H^1(K)}$ 与 $|\\hat{v}_h|_{H^1(\\hat K)}$ 关联**：从任务 A，我们有上界：\n    $$\n    |v_h|_{H^1(K)} \\le C_1 h^{\\frac{d-2}{2}} |\\hat{v}_h|_{H^1(\\hat K)}\n    $$\n    其中 $C_1 = \\sqrt{c_{\\max}^{2d-1}/c_{\\min}^{2}}$ 是一个与 $h$ 无关的常数。\n\n2.  **将 $\\|\\hat{v}_h\\|_{H^1(\\hat K)}$ 与 $\\|\\hat{v}_h\\|_{L^2(\\hat K)}$ 关联**：空间 $V(\\hat{K})$ 是一个有限维向量空间。在有限维空间上，所有范数都是等价的。算子 $\\nabla: V(\\hat K) \\to [V(\\hat K)]^{d}$ 是一个有限维空间之间的线性映射，因此是有界的。这意味着存在一个常数 $C_{\\text{equiv}}$，它仅取决于空间 $V(\\hat K)$（即取决于 $p$ 和 $\\hat K$ 的几何形状），使得对于任何 $\\hat{v}_h \\in V(\\hat K)$：\n    $$\n    |\\hat{v}_h|_{H^1(\\hat K)} = \\|\\nabla \\hat{v}_h\\|_{L^2(\\hat K)} \\le C_{\\text{equiv}} \\|\\hat{v}_h\\|_{L^2(\\hat K)}\n    $$\n\n3.  **将 $\\|\\hat{v}_h\\|_{L^2(\\hat K)}$ 与 $\\|v_h\\|_{L^2(K)}$ 关联**：我们分析 $L^2$ 范数的缩放。\n    $$\n    \\|v_h\\|_{L^2(K)}^2 = \\int_K |v_h(x)|^2 dx = \\int_{\\hat K} |v_h(F(\\hat x))|^2 |\\det B| d\\hat x = \\int_{\\hat K} |\\hat{v}_h(\\hat x)|^2 |\\det B| d\\hat x\n    $$\n    使用行列式的下界，$|\\det B| \\ge c_{\\min}h^d$：\n    $$\n    \\|v_h\\|_{L^2(K)}^2 \\ge c_{\\min}h^d \\int_{\\hat K} |\\hat{v}_h(\\hat x)|^2 d\\hat x = c_{\\min}h^d \\|\\hat{v}_h\\|_{L^2(\\hat K)}^2\n    $$\n    取平方根并整理得到：\n    $$\n    \\|\\hat{v}_h\\|_{L^2(\\hat K)} \\le \\frac{1}{\\sqrt{c_{\\min}} h^{d/2}} \\|v_h\\|_{L^2(K)}\n    $$\n\n4.  **组合不等式**：\n    从第 1 步的结果开始：\n    $$\n    |v_h|_{H^1(K)} \\le C_1 h^{\\frac{d-2}{2}} |\\hat{v}_h|_{H^1(\\hat K)}\n    $$\n    使用第 2 步的范数等价性：\n    $$\n    |v_h|_{H^1(K)} \\le C_1 h^{\\frac{d-2}{2}} (C_{\\text{equiv}} \\|\\hat{v}_h\\|_{L^2(\\hat K)})\n    $$\n    最后，使用第 3 步的缩放关系：\n    $$\n    |v_h|_{H^1(K)} \\le C_1 C_{\\text{equiv}} h^{\\frac{d-2}{2}} \\left( \\frac{1}{\\sqrt{c_{\\min}} h^{d/2}} \\|v_h\\|_{L^2(K)} \\right)\n    $$\n    简化表达式：\n    $$\n    |v_h|_{H^1(K)} \\le \\left(\\frac{C_1 C_{\\text{equiv}}}{\\sqrt{c_{\\min}}}\\right) h^{\\frac{d-2}{2} - \\frac{d}{2}} \\|v_h\\|_{L^2(K)} = \\left(\\frac{C_1 C_{\\text{equiv}}}{\\sqrt{c_{\\min}}}\\right) h^{-1} \\|v_h\\|_{L^2(K)}\n    $$\n    令 $C = \\frac{C_1 C_{\\text{equiv}}}{\\sqrt{c_{\\min}}}$，我们得到一个与 $h$ 无关的常数，并获得所需的反不等式：\n    $$\n    \\|\\nabla v_{h}\\|_{L^{2}(K)} \\le C\\,h^{-1}\\,\\|v_{h}\\|_{L^{2}(K)}\n    $$\n最终要求的答案是任务 A 中 $S(h,d)$ 的表达式。", "answer": "$$\\boxed{h^{\\frac{d-2}{2}}}$$", "id": "3397300"}, {"introduction": "理论与实践相辅相成。在先前练习中理论推导了反向不等式的基础上，本练习要求您通过计算来验证这一基本结果 [@problem_id:3397263]。您将通过编写数值程序，计算在不同单元尺寸 $h$ 和多项式次数 $p$ 下不等式中的常数，从而为理论性质提供切实的验证，并对数值方法中的 $hp$-稳健性概念获得更深刻的直观认识。", "problem": "考虑一个长度为 $h_K  0$ 的一维单元 $K \\subset \\mathbb{R}$，其上有一个从参考区间 $[-1,1]$ 出发的仿射映射，由 $x = x_c + \\frac{h_K}{2}\\xi$ 给出，其中 $x_c \\in \\mathbb{R}$ 是单元中心，$\\xi \\in [-1,1]$ 是参考坐标。令 $\\mathbb{P}_p(K)$ 表示限制在 $K$ 上的次数至多为 $p \\in \\mathbb{N}$ 的多项式空间。对于 $v_h \\in \\mathbb{P}_p(K)$，定义其在 $K$ 上的平方可积范数（$L^2$ 范数）和梯度范数为\n$$\n\\|v_h\\|_{L^2(K)}^2 = \\int_K |v_h(x)|^2 \\, dx, \\qquad \\|\\nabla v_h\\|_{L^2(K)}^2 = \\int_K |v_h'(x)|^2 \\, dx.\n$$\n与有限元方法（FEM）和偏微分方程（PDE）数值分析相关的反不等式断言，存在一个与 $h_K$ 和 $p$ 无关的常数 $C$，使得\n$$\n\\|\\nabla v_h\\|_{L^2(K)} \\le C \\,\\frac{p^2}{h_K} \\, \\|v_h\\|_{L^2(K)} \\quad \\text{for all } v_h \\in \\mathbb{P}_p(K).\n$$\n您的任务是通过计算选定的 $(p,h_K)$ 对的最小常数 $C_{\\mathrm{inv}}(p,h_K)$ 来数值验证 $hp$-稳健性，使得该不等式对所有 $v_h \\in \\mathbb{P}_p(K)$ 均成立。该常数是以下比率在所有非零 $v_h \\in \\mathbb{P}_p(K)$ 上的上确界\n$$\n\\frac{\\|\\nabla v_h\\|_{L^2(K)}}{\\frac{p^2}{h_K}\\|v_h\\|_{L^2(K)}}.\n$$\n此外，定义 $p$-加权范数\n$$\n\\|v_h\\|_{p,h_K}^2 := \\|v_h\\|_{L^2(K)}^2 + \\left(\\frac{h_K^2}{p^4}\\right)\\|\\nabla v_h\\|_{L^2(K)}^2,\n$$\n并追踪放大因子\n$$\n\\mathcal{E}_{\\max}(p,h_K) := \\sup_{v_h \\in \\mathbb{P}_p(K)\\setminus\\{0\\}} \\frac{\\|v_h\\|_{p,h_K}}{\\|v_h\\|_{L^2(K)}}.\n$$\n从核心定义出发：$K$ 上的 $L^2$ 范数、多项式空间 $\\mathbb{P}_p(K)$ 以及从参考区间出发的仿射映射。利用以下事实：在仿射映射 $x = x_c + \\frac{h_K}{2}\\xi$ 下，导数变换为 $\\frac{d}{dx} = \\frac{2}{h_K}\\frac{d}{d\\xi}$，积分测度变换为 $dx = \\frac{h_K}{2}d\\xi$。使用参考区间上适当的多项式基和精确或足够精确的高斯求积，构建 $\\mathbb{P}_p(K)$ 上的双线性形式 $\\int_K v_h w_h \\, dx$ 和 $\\int_K v_h' w_h' \\, dx$ 的数值近似，并由此推导出所需的可计算的上确界。\n\n测试套件：\n为以下参数值计算序对 $\\left(C_{\\mathrm{inv}}(p,h_K),\\,\\mathcal{E}_{\\max}(p,h_K)\\right)$：\n- $(p,h_K) = (\\,1,\\,1.0\\,)$,\n- $(p,h_K) = (\\,3,\\,0.5\\,)$,\n- $(p,h_K) = (\\,5,\\,0.1\\,)$,\n- $(p,h_K) = (\\,8,\\,10^{-3}\\,)$,\n- $(p,h_K) = (\\,10,\\,2.0\\,)$.\n\n最终输出格式：\n您的程序应生成单行输出，其中包含一个用方括号括起来的、以逗号分隔的序对列表，例如 $[ [c_1,e_1], [c_2,e_2], \\ldots ]$，其中每个 $c_i$ 和 $e_i$ 是对应于第 $i$ 个测试用例的 $C_{\\mathrm{inv}}(p,h_K)$ 和 $\\mathcal{E}_{\\max}(p,h_K)$ 的浮点数。不涉及物理单位，如果出现任何角度，都将以弧度为单位，但此处不需要。答案必须严格按照指定的单行格式打印。", "solution": "我们从单个一维单元上的平方可积函数和多项式有限元空间的核心定义开始。对于一个长度为 $h_K  0$ 的单元 $K \\subset \\mathbb{R}$，从参考区间 $[-1,1]$ 出发的仿射映射 $x = x_c + \\frac{h_K}{2}\\xi$ 得到 $dx = \\frac{h_K}{2}d\\xi$，并且根据链式法则有 $\\frac{d}{dx} = \\frac{2}{h_K}\\frac{d}{d\\xi}$。因此，对于与参考多项式 $\\hat{v} \\in \\mathbb{P}_p([-1,1])$ 相关联的 $v_h \\in \\mathbb{P}_p(K)$，范数变换如下\n$$\n\\|v_h\\|_{L^2(K)}^2 = \\int_K |v_h(x)|^2 \\, dx = \\frac{h_K}{2}\\int_{-1}^{1} |\\hat{v}(\\xi)|^2 \\, d\\xi,\n$$\n$$\n\\|\\nabla v_h\\|_{L^2(K)}^2 = \\int_K |v_h'(x)|^2 \\, dx = \\int_{-1}^{1} \\left|\\frac{2}{h_K}\\hat{v}'(\\xi)\\right|^2 \\frac{h_K}{2}\\, d\\xi = \\frac{2}{h_K}\\int_{-1}^{1} |\\hat{v}'(\\xi)|^2 \\, d\\xi.\n$$\n在 $\\mathbb{P}_p([-1,1])$ 上定义参考双线性形式为\n$$\nm(\\phi,\\psi) = \\int_{-1}^{1} \\phi(\\xi)\\psi(\\xi)\\,d\\xi, \\qquad s(\\phi,\\psi) = \\int_{-1}^{1} \\phi'(\\xi)\\psi'(\\xi)\\,d\\xi.\n$$\n为 $\\mathbb{P}_p([-1,1])$ 选择一个多项式基 $\\{\\phi_i\\}_{i=0}^{p}$，例如 0 到 $p$ 次的勒让德多项式。使用足够高阶的高斯求积（例如，点数足以保证对次数高达 $2p$ 的多项式精确的高斯-勒让德求积），我们组装参考质量矩阵和刚度矩阵\n$$\nM_{ij}^{\\mathrm{ref}} = \\int_{-1}^{1} \\phi_i(\\xi)\\phi_j(\\xi)\\,d\\xi, \\qquad S_{ij}^{\\mathrm{ref}} = \\int_{-1}^{1} \\phi_i'(\\xi)\\phi_j'(\\xi)\\,d\\xi.\n$$\n在物理单元 $K$ 上，相应的矩阵通过仿射映射进行缩放：\n$$\nM^{K} = \\frac{h_K}{2} M^{\\mathrm{ref}}, \\qquad S^{K} = \\frac{2}{h_K} S^{\\mathrm{ref}}.\n$$\n对于代表 $v_h$ 的系数向量 $v \\in \\mathbb{R}^{p+1}$，范数满足\n$$\n\\|v_h\\|_{L^2(K)}^2 = v^\\top M^{K} v, \\qquad \\|\\nabla v_h\\|_{L^2(K)}^2 = v^\\top S^{K} v.\n$$\n所求的反不等式常数为\n$$\nC_{\\mathrm{inv}}(p,h_K) = \\sup_{v \\neq 0} \\frac{\\|\\nabla v_h\\|_{L^2(K)}}{\\frac{p^2}{h_K}\\|v_h\\|_{L^2(K)}} = \\sup_{v \\neq 0} \\sqrt{\\frac{v^\\top S^{K} v}{\\left(\\frac{p^4}{h_K^2}\\right) v^\\top M^{K} v}}.\n$$\n这是最大广义瑞利商的平方根。利用缩放关系，我们得到\n$$\n\\frac{v^\\top S^{K} v}{\\left(\\frac{p^4}{h_K^2}\\right) v^\\top M^{K} v}\n= \\frac{\\frac{2}{h_K} v^\\top S^{\\mathrm{ref}} v}{\\left(\\frac{p^4}{h_K^2}\\right) \\frac{h_K}{2} v^\\top M^{\\mathrm{ref}} v}\n= \\frac{4}{p^4} \\cdot \\frac{v^\\top S^{\\mathrm{ref}} v}{v^\\top M^{\\mathrm{ref}} v}.\n$$\n因此，\n$$\nC_{\\mathrm{inv}}(p,h_K) = \\frac{2}{p^2}\\sqrt{\\lambda_{\\max}},\n$$\n其中 $\\lambda_{\\max}$ 是参考问题的最大广义特征值\n$$\nS^{\\mathrm{ref}} v = \\lambda M^{\\mathrm{ref}} v.\n$$\n这表明 $C_{\\mathrm{inv}}(p,h_K)$ 与 $h_K$ 无关，从而证实了当右侧包含因子 $\\frac{p^2}{h_K}$ 时，关于网格尺寸的预期 $hp$-稳健性。\n\n接下来，考虑 $p$-加权范数\n$$\n\\|v_h\\|_{p,h_K}^2 = v^\\top \\left(M^{K} + \\frac{h_K^2}{p^4} S^{K}\\right) v.\n$$\n相对于 $L^2$ 范数的放大因子是\n$$\n\\mathcal{E}_{\\max}(p,h_K)^2 = \\sup_{v \\neq 0} \\frac{v^\\top \\left(M^{K} + \\frac{h_K^2}{p^4} S^{K}\\right) v}{v^\\top M^{K} v}\n= 1 + \\frac{h_K^2}{p^4} \\cdot \\lambda_{\\max}(S^{K}, M^{K}),\n$$\n其中 $\\lambda_{\\max}(S^{K}, M^{K})$ 表示 $(S^{K},M^{K})$ 的最大广义特征值。利用仿射缩放，广义特征值变换如下\n$$\nS^{K} v = \\lambda M^{K} v \\quad \\Longleftrightarrow \\quad S^{\\mathrm{ref}} v = \\left(\\frac{\\lambda h_K^2}{4}\\right) M^{\\mathrm{ref}} v,\n$$\n因此 $\\lambda_{\\max}(S^{K}, M^{K}) = \\frac{4}{h_K^2}\\lambda_{\\max}(S^{\\mathrm{ref}}, M^{\\mathrm{ref}})$。于是，\n$$\n\\mathcal{E}_{\\max}(p,h_K)^2 = 1 + \\frac{h_K^2}{p^4} \\cdot \\frac{4}{h_K^2} \\lambda_{\\max} = 1 + \\frac{4}{p^4}\\lambda_{\\max}.\n$$\n与 $C_{\\mathrm{inv}}(p,h_K)$ 的表达式相结合，得到\n$$\n\\mathcal{E}_{\\max}(p,h_K) = \\sqrt{1 + C_{\\mathrm{inv}}(p,h_K)^2},\n$$\n该式与 $h_K$ 无关，并且对于多项式次数为 $p$ 的空间，当反不等式采用因子 $\\frac{p^2}{h_K}$ 时，它在 $h_K$ 和 $p$ 上均一致有界。\n\n算法设计：\n- 在 $[-1,1]$ 上选择勒让德多项式基 $\\{\\phi_i\\}_{i=0}^p$。\n- 使用足够多的点（例如，$2p+3$ 个点）的高斯-勒让德求积，通过在求积节点上计算 $\\phi_i$ 和 $\\phi_i'$ 的值来组装 $M^{\\mathrm{ref}}$ 和 $S^{\\mathrm{ref}}$。\n- 这是合理的，因为 $n$ 阶高斯-勒让德求积对次数最高为 $2n-1$ 的多项式是精确的；质量矩阵的被积函数次数最高为 $2p$，刚度矩阵的被积函数次数最高为 $2p-2$。\n- 使用对称广义特征值求解器计算 $(S^{\\mathrm{ref}}, M^{\\mathrm{ref}})$ 的最大广义特征值 $\\lambda_{\\max}$。\n- 对每个测试对 $(p,h_K)$，计算 $C_{\\mathrm{inv}}(p,h_K) = \\frac{2}{p^2}\\sqrt{\\lambda_{\\max}}$ 和 $\\mathcal{E}_{\\max}(p,h_K) = \\sqrt{1 + \\frac{4}{p^4}\\lambda_{\\max}}$，并返回这些值。\n\n测试套件涵盖了低次情况 $p=1$、中等次数和网格尺寸、用于明确测试网格无关性的非常小的 $h_K$，以及一个具有较大单元的更高次数 $p=10$，以确认缩放稳健性。最终输出将计算出的序对 $[C_{\\mathrm{inv}}(p,h_K), \\mathcal{E}_{\\max}(p,h_K)]$ 汇总成指定的单行格式。", "answer": "```python\nimport numpy as np\nfrom numpy.polynomial.legendre import Legendre, leggauss\nfrom scipy.linalg import eigh\n\ndef assemble_reference_matrices(p: int) - tuple[np.ndarray, np.ndarray]:\n    \"\"\"\n    Assemble reference mass and stiffness matrices on [-1,1] for the\n    Legendre polynomial basis of degrees 0..p using Gauss-Legendre quadrature.\n    \"\"\"\n    # Number of quadrature points: ensure exactness for degree up to 2p\n    # Gauss-Legendre of order nq is exact up to degree 2nq-1.\n    nq = max(2 * p + 3, 32)\n    xi, w = leggauss(nq)\n\n    # Construct Legendre basis polynomials and their derivatives\n    basis = [Legendre.basis(k) for k in range(p + 1)]\n    dbasis = [b.deriv() for b in basis]\n\n    # Evaluate basis and derivatives at quadrature points\n    Phi = np.vstack([b(xi) for b in basis])  # shape (p+1, nq)\n    dPhi = np.vstack([db(xi) for db in dbasis])  # shape (p+1, nq)\n\n    # Assemble M_ref and S_ref\n    M_ref = np.zeros((p + 1, p + 1))\n    S_ref = np.zeros((p + 1, p + 1))\n\n    # Use vectorized accumulation\n    # M_ij = sum_k w_k * Phi_i(x_k) * Phi_j(x_k)\n    # S_ij = sum_k w_k * dPhi_i(x_k) * dPhi_j(x_k)\n    for i in range(p + 1):\n        for j in range(p + 1):\n            M_ref[i, j] = np.sum(w * Phi[i, :] * Phi[j, :])\n            S_ref[i, j] = np.sum(w * dPhi[i, :] * dPhi[j, :])\n\n    return M_ref, S_ref\n\ndef compute_lambda_max(M_ref: np.ndarray, S_ref: np.ndarray) - float:\n    \"\"\"\n    Compute the largest generalized eigenvalue of (S_ref, M_ref).\n    \"\"\"\n    # Solve S_ref v = lambda M_ref v for symmetric matrices\n    # eigh returns eigenvalues in ascending order\n    evals = eigh(S_ref, M_ref, eigvals_only=True)\n    # Numerical safety: filter out tiny negatives due to round-off\n    evals = np.real(evals)\n    # Keep only nonnegative (or very small positive) eigenvalues\n    pos_evals = evals[evals  1e-12]\n    if pos_evals.size == 0:\n        # If all eigenvalues are near zero, return zero\n        return 0.0\n    return float(pos_evals.max())\n\ndef compute_constants(p: int, h: float) - tuple[float, float]:\n    \"\"\"\n    Compute C_inv(p,h) and E_max(p,h) for given polynomial degree p and element size h.\n    \"\"\"\n    M_ref, S_ref = assemble_reference_matrices(p)\n    lam_max = compute_lambda_max(M_ref, S_ref)\n    # Inverse inequality constant: C_inv = (2/p^2) * sqrt(lam_max)\n    C_inv = (2.0 / (p**2)) * np.sqrt(lam_max)\n    # Weighted norm amplification: E_max = sqrt(1 + (4/p^4) * lam_max) = sqrt(1 + C_inv^2)\n    E_max = np.sqrt(1.0 + C_inv**2)\n    return C_inv, E_max\n\ndef solve():\n    # Define the test cases from the problem statement: (p, h_K)\n    test_cases = [\n        (1, 1.0),\n        (3, 0.5),\n        (5, 0.1),\n        (8, 1e-3),\n        (10, 2.0),\n    ]\n\n    results = []\n    for p, h in test_cases:\n        c_inv, e_max = compute_constants(p, h)\n        results.append([float(c_inv), float(e_max)])\n\n    # Final print statement in the exact required format.\n    # Print as a single list of pairs: [[c1,e1],[c2,e2],...]\n    print(\"[\" + \",\".join(f\"[{r[0]},{r[1]}]\" for r in results) + \"]\")\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "3397263"}]}