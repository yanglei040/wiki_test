{"hands_on_practices": [{"introduction": "要掌握算子分裂方法，首先必须能够从基本原理出发，构建并分析一个完整的时间步。这个练习将指导你完成这一核心过程：针对一个二维扩散问题，你将把 Strang 分裂与隐式欧拉子步骤结合起来，推导出完整的代数步骤 [@problem_id:3427488]。通过计算特定模式的放大因子，你将能练习稳定性分析中的一个基本技能。", "problem": "考虑单位正方形 $(0,1)\\times(0,1)$ 上的二维扩散偏微分方程 (PDE) $u_t=\\alpha\\,u_{xx}+\\beta\\,u_{yy}$，其边界条件为齐次狄利克雷边界条件，其中 $\\alpha>0$ 和 $\\beta>0$ 是常数。在具有 $3\\times 3$ 个内部点和网格间距 $h$ 的均匀笛卡尔网格上对空间域进行离散化，并使用 $x$ 索引变化最快的字典序。设 $T_3\\in\\mathbb{R}^{3\\times 3}$ 为具有齐次狄利克雷边界条件的标准二阶差分矩阵，即对角线元素为 $-2/h^2$、第一副对角线和第一超对角线元素为 $1/h^2$ 的三对角矩阵。定义分裂离散算子 $A_h=\\alpha\\,(I_3\\otimes T_3)$ 和 $B_h=\\beta\\,(T_3\\otimes I_3)$，其中 $I_3$ 是 $3\\times 3$ 单位矩阵，$\\otimes$ 表示克罗内克积。\n\n从上述定义以及线性自治系统 $v_t=Lv$ 的隐式欧拉时间离散化（即对于时间增量 $\\tau>0$，有 $(I-\\tau L)\\,v^{n+1}=v^n$）出发，从第一性原理推导实现 $u_t=(A_h+B_h)u$ 的一个大小为 $\\Delta t$ 的 Strang 分裂步的子问题的代数序列，其中每个子步使用隐式欧拉方法求解。您必须将 $u^n$ 映射到 $u^{n+1}$ 的整体单步线性传播算子 $S_{\\Delta t}$ 纯粹用 $A_h$、$B_h$、$I$ 和 $\\Delta t$ 来表示。\n\n然后，利用 $A_h$ 和 $B_h$ 可交换的事实，以及在齐次狄利克雷边界条件下离散正弦变换 (DST) 可以对角化 $T_3$ 的事实，计算与每个坐标方向上 $p=q=2$ 的离散正弦模态相关联的标量放大因子（$S_{\\Delta t}$ 的特征值）。请将您的最终答案表示为关于 $\\alpha$、$\\beta$、$h$ 和 $\\Delta t$ 的闭式解析表达式。不需要进行数值取整，也无需报告单位。最终答案必须是单个解析表达式。", "solution": "该问题被评估为有效的，因为它具有科学依据、良定性、客观且自洽。它描述了偏微分方程(PDE)数值分析中的一个标准问题，提供了所有必要的定义和约束，以得到一个唯一的、可验证的解。\n\n问题要求得到两个主要结果：首先，使用隐式欧拉子步推导给定半离散化扩散方程的 Strang 分裂算子；其次，计算特定空间模态的放大因子。\n\n待求解的半离散化系统是 $u_t = (A_h + B_h)u$，其中 $u$ 是内部网格点上未知值的向量。算子 $A_h$ 和 $B_h$ 分别表示 $x$ 和 $y$ 方向的空间导数。\n\n首先，我们推导 Strang 分裂格式。Strang 分裂是一种二阶算子分裂方法，它通过组合三个子步来逼近 $u_t = (A+B)u$ 在一个时间步长 $\\Delta t$ 上的解：算子 $A$ 的半步，算子 $B$ 的全步，以及算子 $A$ 的另一个半步。形式化的算子表达式为 $\\exp(\\frac{\\Delta t}{2} A) \\exp(\\Delta t B) \\exp(\\frac{\\Delta t}{2} A)$。\n\n问题规定每个子步都使用隐式欧拉方法求解。对于一个通用的线性自治系统 $v_t = Lv$，在时间增量 $\\tau$ 上的隐式欧拉离散化为 $v^{n+1} = v^n + \\tau L v^{n+1}$，整理后得到 $(I - \\tau L)v^{n+1} = v^n$。因此，单步传播算子是 $(I - \\tau L)^{-1}$。\n\n将此应用于 Strang 分裂的三个子步：\n1.  在 $\\Delta t/2$ 的时间步长上求解 $u_t = A_h u$，得到传播算子 $(I - \\frac{\\Delta t}{2} A_h)^{-1}$。\n2.  在 $\\Delta t$ 的时间步长上求解 $u_t = B_h u$，得到传播算子 $(I - \\Delta t B_h)^{-1}$。\n3.  在第二个 $\\Delta t/2$ 的时间步长上求解 $u_t = A_h u$，得到传播算子 $(I - \\frac{\\Delta t}{2} A_h)^{-1}$。\n\n将解从时间 $t_n$（状态 $u^n$）推进到 $t_{n+1} = t_n + \\Delta t$（状态 $u^{n+1}$）的子问题代数序列如下：\n1.  求解线性系统 $(I - \\frac{\\Delta t}{2} A_h) u^{(1)} = u^n$ 以获得中间状态 $u^{(1)}$。\n2.  求解线性系统 $(I - \\Delta t B_h) u^{(2)} = u^{(1)}$ 以获得中间状态 $u^{(2)}$。\n3.  求解线性系统 $(I - \\frac{\\Delta t}{2} A_h) u^{n+1} = u^{(2)}$ 以获得最终状态 $u^{n+1}$。\n\n组合这些步骤，得到将 $u^n$ 映射到 $u^{n+1}$ 的整体单步线性传播算子 $S_{\\Delta t}$：\n$u^{n+1} = S_{\\Delta t} u^n = (I - \\frac{\\Delta t}{2} A_h)^{-1} (I - \\Delta t B_h)^{-1} (I - \\frac{\\Delta t}{2} A_h)^{-1} u^n$。\n因此，该算子为 $S_{\\Delta t} = (I - \\frac{\\Delta t}{2} A_h)^{-1} (I - \\Delta t B_h)^{-1} (I - \\frac{\\Delta t}{2} A_h)^{-1}$。\n\n接下来，我们计算与特定离散正弦模态相关联的标量放大因子。放大因子是算子 $S_{\\Delta t}$ 对应于代表该模态的特征向量的特征值。\n\n问题陈述了算子 $A_h = \\alpha(I_3 \\otimes T_3)$ 和 $B_h = \\beta(T_3 \\otimes I_3)$ 可交换。这意味着它们共享一组共同的特征向量基。设 $v_{p,q}$ 是 $A_h$ 和 $B_h$ 的一个共同特征向量，其对应的特征值为 $\\lambda_A^{(p,q)}$ 和 $\\lambda_B^{(p,q)}$。\n$A_h v_{p,q} = \\lambda_A^{(p,q)} v_{p,q}$\n$B_h v_{p,q} = \\lambda_B^{(p,q)} v_{p,q}$\n\n将 $S_{\\Delta t}$ 应用于 $v_{p,q}$：\n$S_{\\Delta t} v_{p,q} = (I - \\frac{\\Delta t}{2} A_h)^{-1} (I - \\Delta t B_h)^{-1} (I - \\frac{\\Delta t}{2} A_h)^{-1} v_{p,q}$\n对于一个特征向量为 $v$ 且特征值为 $\\lambda_C$ 的算子 $C$，其逆算子 $(I-C)^{-1}$ 的特征值为 $(1-\\lambda_C)^{-1}$。依次应用此性质：\n$S_{\\Delta t} v_{p,q} = (I - \\frac{\\Delta t}{2} A_h)^{-1} (I - \\Delta t B_h)^{-1} \\left(1 - \\frac{\\Delta t}{2} \\lambda_A^{(p,q)}\\right)^{-1} v_{p,q}$\n$S_{\\Delta t} v_{p,q} = (I - \\frac{\\Delta t}{2} A_h)^{-1} \\left(1 - \\Delta t \\lambda_B^{(p,q)}\\right)^{-1} \\left(1 - \\frac{\\Delta t}{2} \\lambda_A^{(p,q)}\\right)^{-1} v_{p,q}$\n$S_{\\Delta t} v_{p,q} = \\left(1 - \\frac{\\Delta t}{2} \\lambda_A^{(p,q)}\\right)^{-1} \\left(1 - \\Delta t \\lambda_B^{(p,q)}\\right)^{-1} \\left(1 - \\frac{\\Delta t}{2} \\lambda_A^{(p,q)}\\right)^{-1} v_{p,q}$\n$S_{\\Delta t} v_{p,q} = \\left(1 - \\frac{\\Delta t}{2} \\lambda_A^{(p,q)}\\right)^{-2} \\left(1 - \\Delta t \\lambda_B^{(p,q)}\\right)^{-1} v_{p,q}$\n\n因此，模态 $(p,q)$ 的标量放大因子为 $\\lambda_{S}^{(p,q)} = \\left(1 - \\frac{\\Delta t}{2} \\lambda_A^{(p,q)}\\right)^{-2} \\left(1 - \\Delta t \\lambda_B^{(p,q)}\\right)^{-1}$。\n\n我们需要求出 $A_h$ 和 $B_h$ 的特征值。在具有齐次狄利克雷边界条件的笛卡尔网格上的二维离散拉普拉斯算子的特征向量是离散正弦模态。$N \\times N$ 的二阶差分矩阵 $T_N$（对角线元素为 $-2/h^2$，副对角线元素为 $1/h^2$）的特征值由 $\\mu_k = -\\frac{4}{h^2} \\sin^2\\left(\\frac{k\\pi}{2(N+1)}\\right)$ 给出，其中 $k=1, \\dots, N$。\n在我们的例子中，网格有 $3 \\times 3$ 个内部点，所以 $N=3$。$T_3$ 的特征值为 $\\mu_k = -\\frac{4}{h^2} \\sin^2\\left(\\frac{k\\pi}{8}\\right)$，其中 $k=1, 2, 3$。\n\n$A_h = \\alpha(I_3 \\otimes T_3)$ 的特征值对应于由 $p$ 索引的 $x$ 方向模态。它们是 $\\lambda_A^{(p,q)} = \\alpha \\mu_p$。\n$B_h = \\beta(T_3 \\otimes I_3)$ 的特征值对应于由 $q$ 索引的 $y$ 方向模态。它们是 $\\lambda_B^{(p,q)} = \\beta \\mu_q$。\n\n问题要求计算 $p=2$ 和 $q=2$ 模态的放大因子。我们计算 $T_3$ 所需的特征值：\n$\\mu_2 = -\\frac{4}{h^2} \\sin^2\\left(\\frac{2\\pi}{8}\\right) = -\\frac{4}{h^2} \\sin^2\\left(\\frac{\\pi}{4}\\right)$。\n因为 $\\sin(\\pi/4) = \\frac{\\sqrt{2}}{2}$，所以我们有 $\\sin^2(\\pi/4) = \\frac{1}{2}$。\n所以，$\\mu_2 = -\\frac{4}{h^2} \\left(\\frac{1}{2}\\right) = -\\frac{2}{h^2}$。\n\n对应于模态 $(p,q)=(2,2)$ 的 $A_h$ 和 $B_h$ 的特征值是：\n$\\lambda_A^{(2,2)} = \\alpha \\mu_2 = -\\frac{2\\alpha}{h^2}$\n$\\lambda_B^{(2,2)} = \\beta \\mu_2 = -\\frac{2\\beta}{h^2}$\n\n将这些代入放大因子 $\\lambda_{S}^{(p,q)}$ 的表达式中：\n$\\lambda_{S}^{(2,2)} = \\left(1 - \\frac{\\Delta t}{2} \\left(-\\frac{2\\alpha}{h^2}\\right)\\right)^{-2} \\left(1 - \\Delta t \\left(-\\frac{2\\beta}{h^2}\\right)\\right)^{-1}$\n$\\lambda_{S}^{(2,2)} = \\left(1 + \\frac{\\alpha \\Delta t}{h^2}\\right)^{-2} \\left(1 + \\frac{2\\beta \\Delta t}{h^2}\\right)^{-1}$\n\n这可以写成分数形式：\n$\\lambda_{S}^{(2,2)} = \\frac{1}{\\left(1 + \\frac{\\alpha \\Delta t}{h^2}\\right)^{2}\\left(1 + \\frac{2\\beta \\Delta t}{h^2}\\right)}$\n\n这就是所要求的放大因子的最终闭式解析表达式。", "answer": "$$\\boxed{\\frac{1}{\\left(1 + \\frac{\\alpha \\Delta t}{h^2}\\right)^{2}\\left(1 + \\frac{2\\beta \\Delta t}{h^2}\\right)}}$$", "id": "3427488"}, {"introduction": "一个数值格式的稳定性（即解在时间上保持有界）只是其众多定性性质之一。这个练习将探讨一个更微妙的性质——离散最大值原理，它要求非负的初始条件能演化出非负的解。你将分析著名且无条件稳定的 Peaceman-Rachford ADI 格式，并发现它在时间步长较大时会违反此原理 [@problem_id:3427476]，从而揭示数值分析中一个重要的警示故事。", "problem": "考虑在周期性方形区域上的二维热方程（扩散方程），在两个空间方向上的均匀网格间距均为 $h$，\n$$\nu_{t} = \\kappa \\left(u_{xx} + u_{yy}\\right),\n$$\n其中 $\\kappa > 0$ 是恒定的扩散系数。设空间离散化为在具有周期性边界条件的均匀笛卡尔网格上的标准二阶中心有限差分拉普拉斯算子，并应用基于 Crank–Nicolson (CN) 时间离散化的 Peaceman–Rachford (PR) 交替方向隐式 (ADI) 分裂法：\n$$\n\\left(I - \\frac{\\kappa \\Delta t}{2} D_{x}\\right)\\left(I - \\frac{\\kappa \\Delta t}{2} D_{y}\\right) u^{n+1}\n=\n\\left(I + \\frac{\\kappa \\Delta t}{2} D_{x}\\right)\\left(I + \\frac{\\kappa \\Delta t}{2} D_{y}\\right) u^{n},\n$$\n其中 $D_{x}$ 和 $D_{y}$ 分别表示 $x$ 和 $y$ 方向上的离散二阶差分算子，$I$ 表示单位算子。离散极值原理是指如果网格函数 $u^{n}$ 逐元素非负，那么 $u^{n+1}$ 也逐元素非负的性质。\n\n从离散算子的定义和周期性网格上卷积算子的傅里叶对角化出发，解析地推导上述 PR–CN 格式对于波数为 $(\\theta_{x},\\theta_{y})$ 的离散傅里叶模态的单步放大因子。仅使用这些基本事实，构建一个科学合理的场景，在该场景中离散极值原理在时间步长 $\\Delta t$ 足够大时失效：具体来说，以 $h$ 和扩散系数 $\\kappa$ 的闭式表达式的形式，确定一个阈值时间步长 $\\Delta t_{\\mathrm{th}}$，使得对于 $\\Delta t > \\Delta t_{\\mathrm{th}}$，存在非负的初始数据，使得 PR–CN 更新在某个网格点上产生负值。\n\n你的最终答案必须是 $\\Delta t_{\\mathrm{th}}$ 关于 $h$ 和 $\\kappa$ 的单一解析表达式。无需四舍五入。", "solution": "本题要求推导阈值时间步长 $\\Delta t_{\\mathrm{th}}$，当时间步长超过该值时，用于二维热方程的 Peaceman–Rachford (PR) 交替方向隐式 (ADI) 格式将违背离散极值原理。分析过程将首先通过离散傅里叶分析推导数值格式的单步放大因子，然后确定该因子变为负值的条件，这是违背极值原理的必要条件。\n\n二维热方程由下式给出：\n$$\n\\frac{\\partial u}{\\partial t} = \\kappa \\left( \\frac{\\partial^2 u}{\\partial x^2} + \\frac{\\partial^2 u}{\\partial y^2} \\right)\n$$\n其中 $\\kappa > 0$ 是扩散系数。我们考虑一个在两个方向上间距均为 $h$ 的均匀笛卡尔网格。二阶偏导数的标准二阶中心有限差分近似由算子 $D_x$ 和 $D_y$ 给出：\n$$\n(D_x u)_{j,k} = \\frac{u_{j+1,k} - 2u_{j,k} + u_{j-1,k}}{h^2}\n$$\n$$\n(D_y u)_{j,k} = \\frac{u_{j,k+1} - 2u_{j,k} + u_{j,k-1}}{h^2}\n$$\nPR–ADI-CN 格式如下：\n$$\n\\left(I - \\frac{\\kappa \\Delta t}{2} D_{x}\\right)\\left(I - \\frac{\\kappa \\Delta t}{2} D_{y}\\right) u^{n+1} = \\left(I + \\frac{\\kappa \\Delta t}{2} D_{x}\\right)\\left(I + \\frac{\\kappa \\Delta t}{2} D_{y}\\right) u^{n}\n$$\n\n为了求单步放大因子，我们进行 von Neumann 稳定性分析。由于存在周期性边界条件，离散算子 $D_x$ 和 $D_y$ 的特征函数是离散傅里叶模态。一个通用的傅里叶模态形式为 $u^n_{j,k} = (G(\\theta_x, \\theta_y))^n \\exp(i(j\\theta_x + k\\theta_y))$，其中 $(\\theta_x, \\theta_y)$ 是对应于空间频率的无量纲波数，$G$ 是放大因子。\n\n我们来求 $D_x$ 和 $D_y$ 对应于此模态的特征值。将 $D_x$ 应用于空间部分 $\\exp(i(j\\theta_x + k\\theta_y))$ 可得：\n$$\nD_x \\exp(i(j\\theta_x + k\\theta_y)) = \\frac{\\exp(i((j+1)\\theta_x+k\\theta_y)) - 2\\exp(i(j\\theta_x+k\\theta_y)) + \\exp(i((j-1)\\theta_x+k\\theta_y))}{h^2}\n$$\n$$\n= \\frac{\\exp(i(j\\theta_x+k\\theta_y)) (\\exp(i\\theta_x) - 2 + \\exp(-i\\theta_x))}{h^2} = \\frac{2(\\cos(\\theta_x) - 1)}{h^2} \\exp(i(j\\theta_x+k\\theta_y))\n$$\n使用半角恒等式 $1-\\cos(\\theta_x) = 2\\sin^2(\\theta_x/2)$，$D_x$ 的特征值，记为 $\\hat{D}_x$，是：\n$$\n\\hat{D}_x(\\theta_x) = -\\frac{4}{h^2}\\sin^2\\left(\\frac{\\theta_x}{2}\\right)\n$$\n类似地，$D_y$ 的特征值是：\n$$\n\\hat{D}_y(\\theta_y) = -\\frac{4}{h^2}\\sin^2\\left(\\frac{\\theta_y}{2}\\right)\n$$\n无量纲波数 $\\theta_x$ 和 $\\theta_y$ 的取值范围是 $[-\\pi, \\pi]$。因此，$\\sin^2(\\theta_x/2)$ 和 $\\sin^2(\\theta_y/2)$ 的取值范围是 $[0, 1]$。\n\n将模态 $u^{n+1} = G u^n$ 代入格式中，并将算子替换为其特征值，我们得到放大因子 $G$ 的方程：\n$$\n\\left(1 - \\frac{\\kappa \\Delta t}{2} \\hat{D}_x\\right)\\left(1 - \\frac{\\kappa \\Delta t}{2} \\hat{D}_y\\right) G = \\left(1 + \\frac{\\kappa \\Delta t}{2} \\hat{D}_x\\right)\\left(1 + \\frac{\\kappa \\Delta t}{2} \\hat{D}_y\\right)\n$$\n解出 $G(\\theta_x, \\theta_y)$:\n$$\nG(\\theta_x, \\theta_y) = \\frac{\\left(1 + \\frac{\\kappa \\Delta t}{2} \\hat{D}_x\\right)\\left(1 + \\frac{\\kappa \\Delta t}{2} \\hat{D}_y\\right)}{\\left(1 - \\frac{\\kappa \\Delta t}{2} \\hat{D}_x\\right)\\left(1 - \\frac{\\kappa \\Delta t}{2} \\hat{D}_y\\right)}\n$$\n代入特征值的表达式：\n$$\nG(\\theta_x, \\theta_y) = \\frac{\\left(1 - \\frac{2\\kappa \\Delta t}{h^2} \\sin^2\\left(\\frac{\\theta_x}{2}\\right)\\right) \\left(1 - \\frac{2\\kappa \\Delta t}{h^2} \\sin^2\\left(\\frac{\\theta_y}{2}\\right)\\right)}{\\left(1 + \\frac{2\\kappa \\Delta t}{h^2} \\sin^2\\left(\\frac{\\theta_x}{2}\\right)\\right) \\left(1 + \\frac{2\\kappa \\Delta t}{h^2} \\sin^2\\left(\\frac{\\theta_y}{2}\\right)\\right)}\n$$\n离散极值原理 (DMP) 指出，如果对于所有网格点 $(j,k)$ 都有 $u^n_{j,k} \\ge 0$，那么 $u^{n+1}_{j,k} \\ge 0$ 也成立。对于一个线性常系数格式，满足 DMP 的一个必要条件是其放大因子对所有波数都必须是非负的，即 $G(\\theta_x, \\theta_y) \\ge 0$。如果对于某个模态 $G  0$，则可以构造一个非负的初始条件（例如，通过加上一个足够大的常数），使其演化后出现负值，从而违背 DMP。\n\n我们分析 $G(\\theta_x, \\theta_y)$ 的符号。分母是两个形如 $(1 + C)$ 的项的乘积，其中 $C = \\frac{2\\kappa \\Delta t}{h^2} \\sin^2(\\cdot)$ 总是非负的。因此，分母总是正的（且大于等于 $1$）。$G$ 的符号完全由其分子的符号决定。\n令 $N(\\theta_x, \\theta_y)$ 为分子：\n$$\nN(\\theta_x, \\theta_y) = \\left(1 - \\frac{2\\kappa \\Delta t}{h^2} \\sin^2\\left(\\frac{\\theta_x}{2}\\right)\\right) \\left(1 - \\frac{2\\kappa \\Delta t}{h^2} \\sin^2\\left(\\frac{\\theta_y}{2}\\right)\\right)\n$$\n为了使 $G$ 为负，分子必须为负。这发生在 $N$ 中的两个因子一个为正、另一个为负时。\n\n我们定义无量纲参数 $r = \\frac{2\\kappa \\Delta t}{h^2}$。令 $S_x = \\sin^2(\\theta_x/2)$ 和 $S_y = \\sin^2(\\theta_y/2)$。这两个因子是 $(1 - rS_x)$ 和 $(1 - rS_y)$。通过选择合适的波数 $\\theta_x, \\theta_y \\in [-\\pi, \\pi]$，变量 $S_x$ 和 $S_y$ 可以取区间 $[0, 1]$ 内的任何值。\n\n如果我们可以找到 $(\\theta_x, \\theta_y)$ 使得，例如，$(1 - rS_x)  0$ 且 $(1 - rS_y) > 0$，那么 DMP 将失效。\n条件 $1 - rS_x  0$ 意味着 $rS_x > 1$。\n条件 $1 - rS_y > 0$ 意味着 $rS_y  1$。\n\n要使 DMP 可能失效，必须存在一个模态 $\\theta_x$ 使得 $rS_x > 1$。由于 $S_x$ 的最大值是 $1$（当 $\\theta_x = \\pi$ 时），这个不等式只有在 $r > 1$ 时才能被满足。\n如果 $r > 1$，我们可以在 $x$ 方向选择一个高频模态，比如 $\\theta_x = \\pi$，此时 $S_x = \\sin^2(\\pi/2) = 1$。对于这个模态，因子是 $(1 - r)  0$。\n同时，我们可以在 $y$ 方向选择一个低频模态，比如 $\\theta_y = 0$，此时 $S_y = \\sin^2(0) = 0$。对于这个模态，因子是 $(1 - 0) = 1 > 0$。\n通过选择这样的波数 $(\\theta_x, \\theta_y) = (\\pi, 0)$，分子为 $N = (1-r)(1)  0$，因此放大因子 $G$ 为负。这表明当 $r>1$ 时，DMP 被违背。\n\n如果 $r \\le 1$，那么对于任何模态 $\\theta_x$，我们有 $rS_x \\le 1 \\cdot S_x \\le 1$。因此，因子 $(1 - rS_x)$ 总是非负的。对于 $y$ 方向的因子也是如此。两个非负数的乘积是非负的，所以对于所有模态 $N(\\theta_x, \\theta_y) \\ge 0$。在这种情况下，DMP 的这个必要条件得到满足。\n\n离散极值原理失效的阈值恰好出现在条件 $r>1$ 的边界上。阈值为 $r=1$。\n代回 $r$ 的定义：\n$$\n\\frac{2\\kappa \\Delta t}{h^2} = 1\n$$\n解出阈值时间步长 $\\Delta t_{\\mathrm{th}}$：\n$$\n\\Delta t_{\\mathrm{th}} = \\frac{h^2}{2\\kappa}\n$$\n对于任何时间步长 $\\Delta t > \\Delta t_{\\mathrm{th}}$，都存在傅里叶模态，其放大因子为负，从而造成一个场景，使得非负的初始条件可以演化出负值，进而违背离散极值原理。", "answer": "$$\\boxed{\\frac{h^{2}}{2\\kappa}}$$", "id": "3427476"}, {"introduction": "在实现了复杂的数值算法后，我们如何验证代码的正确性？制造解方法 (Method of Manufactured Solutions, MMS) 是一种强大而通用的代码验证技术。在这个练习中，你将通过为一个给定的精确解反向推导所需的源项，来亲手实践 MMS [@problem_id:3427454]。这个过程不仅能加深你对偏微分方程本身的理解，也为你提供了验证自定义求解器正确性的关键工具。", "problem": "考虑在单位正方形 $\\Omega=(0,1)\\times(0,1)$ 上的二维线性各向异性扩散方程，其具有齐次狄利克雷边界条件和光滑源项：\n$$\nu_{t} = a\\,u_{xx} + b\\,u_{yy} + f(x,y,t), \\quad (x,y)\\in\\Omega,\\ t0,\n$$\n$$\nu(x,y,t)=0 \\text{ for } (x,y)\\in\\partial\\Omega,\\ t\\ge 0,\n$$\n和初始条件\n$$\nu(x,y,0) = \\sin(\\pi x)\\sin(2\\pi y).\n$$\n令各向异性系数为 $a=1$ 和 $b=4$。你将使用构造解法，通过指定精确解\n$$\nu(x,y,t) = \\exp(-t)\\,\\sin(\\pi x)\\,\\sin(2\\pi y),\n$$\n来确定强迫项 $f(x,y,t)$，使得 $u$ 精确满足该偏微分方程以及边界和初始条件。\n\n此外，考虑通过 Strang 交替方向隐式 (ADI) 算子分裂方法将解在时间上推进，该方法将 $a\\,u_{xx}$ 和 $b\\,u_{yy}$ 作为分裂算子处理。假设所有空间离散都具有足够高的阶数，以致于时间精度占主导地位，并假设精确解足够光滑以证明形式上的时间阶数是合理的。在此线性情况下，陈述 Strang-ADI 时间离散的预期理论时间精度阶数 $r$。\n\n将你的最终答案以一个两元行向量的形式报告，其第一个元素是 $f(x,y,t)$ 的闭式解析表达式，第二个元素是整数时间阶数 $r$。无需四舍五入，不涉及单位。", "solution": "该问题包括两个部分。第一部分是根据给定的偏微分方程 (PDE) 和一个指定的“构造”解 $u(x,y,t)$ 来确定强迫项 $f(x,y,t)$。第二部分是陈述应用于此 PDE 的 Strang 交替方向隐式 (ADI) 方法的理论时间精度阶数。\n\n首先，我将验证问题陈述。\n提取所有给定条件并检查其一致性。\n偏微分方程为 $u_{t} = a\\,u_{xx} + b\\,u_{yy} + f(x,y,t)$，其中 $a=1$，$b=4$。\n区域为 $\\Omega=(0,1)\\times(0,1)$，具有齐次狄利克雷边界条件 $u(x,y,t)=0$ 对于 $(x,y)\\in\\partial\\Omega$。\n初始条件为 $u(x,y,0) = \\sin(\\pi x)\\sin(2\\pi y)$。\n指定的解为 $u(x,y,t) = \\exp(-t)\\,\\sin(\\pi x)\\,\\sin(2\\pi y)$。\n让我们检查一致性。\n在 $t=0$ 时，指定的解为 $u(x,y,0) = \\exp(-0)\\,\\sin(\\pi x)\\,\\sin(2\\pi y) = \\sin(\\pi x)\\sin(2\\pi y)$，这与初始条件相符。\n在 $\\Omega$ 的边界上：\n在 $x=0$ 处：$u(0,y,t) = \\exp(-t)\\,\\sin(0)\\,\\sin(2\\pi y) = 0$。\n在 $x=1$ 处：$u(1,y,t) = \\exp(-t)\\,\\sin(\\pi)\\,\\sin(2\\pi y) = 0$。\n在 $y=0$ 处：$u(x,0,t) = \\exp(-t)\\,\\sin(\\pi x)\\,\\sin(0) = 0$。\n在 $y=1$ 处：$u(x,1,t) = \\exp(-t)\\,\\sin(\\pi x)\\,\\sin(2\\pi) = 0$。\n所有边界和初始条件都被指定的解满足。该问题在科学上是合理的、适定的，并且不包含矛盾或歧义。该问题是有效的。\n\n第一部分：确定强迫项 $f(x,y,t)$。\n强迫项 $f(x,y,t)$ 可以从偏微分方程中分离出来：\n$$\nf(x,y,t) = u_t - a\\,u_{xx} - b\\,u_{yy}\n$$\n我们需要计算指定解 $u(x,y,t) = \\exp(-t)\\,\\sin(\\pi x)\\,\\sin(2\\pi y)$ 的偏导数。\n\n关于时间 $t$ 的偏导数是：\n$$\nu_t = \\frac{\\partial}{\\partial t}\\left(\\exp(-t)\\,\\sin(\\pi x)\\,\\sin(2\\pi y)\\right) = -\\exp(-t)\\,\\sin(\\pi x)\\,\\sin(2\\pi y)\n$$\n关于 $x$ 的一阶和二阶偏导数是：\n$$\nu_x = \\frac{\\partial}{\\partial x}\\left(\\exp(-t)\\,\\sin(\\pi x)\\,\\sin(2\\pi y)\\right) = \\pi\\exp(-t)\\,\\cos(\\pi x)\\,\\sin(2\\pi y)\n$$\n$$\nu_{xx} = \\frac{\\partial}{\\partial x}\\left(\\pi\\exp(-t)\\,\\cos(\\pi x)\\,\\sin(2\\pi y)\\right) = -\\pi^2\\exp(-t)\\,\\sin(\\pi x)\\,\\sin(2\\pi y)\n$$\n关于 $y$ 的一阶和二阶偏导数是：\n$$\nu_y = \\frac{\\partial}{\\partial y}\\left(\\exp(-t)\\,\\sin(\\pi x)\\,\\sin(2\\pi y)\\right) = 2\\pi\\exp(-t)\\,\\sin(\\pi x)\\,\\cos(2\\pi y)\n$$\n$$\nu_{yy} = \\frac{\\partial}{\\partial y}\\left(2\\pi\\exp(-t)\\,\\sin(\\pi x)\\,\\cos(2\\pi y)\\right) = -4\\pi^2\\exp(-t)\\,\\sin(\\pi x)\\,\\sin(2\\pi y)\n$$\n现在，将这些导数以及系数 $a=1$ 和 $b=4$ 代入 $f(x,y,t)$ 的表达式中：\n$$\nf(x,y,t) = \\left(-\\exp(-t)\\,\\sin(\\pi x)\\,\\sin(2\\pi y)\\right) - (1)\\left(-\\pi^2\\exp(-t)\\,\\sin(\\pi x)\\,\\sin(2\\pi y)\\right) - (4)\\left(-4\\pi^2\\exp(-t)\\,\\sin(\\pi x)\\,\\sin(2\\pi y)\\right)\n$$\n我们可以提出公因式 $\\exp(-t)\\,\\sin(\\pi x)\\,\\sin(2\\pi y)$：\n$$\nf(x,y,t) = \\left(-1 - (-\\pi^2) - 4(-4\\pi^2)\\right)\\exp(-t)\\,\\sin(\\pi x)\\,\\sin(2\\pi y)\n$$\n$$\nf(x,y,t) = \\left(-1 + \\pi^2 + 16\\pi^2\\right)\\exp(-t)\\,\\sin(\\pi x)\\,\\sin(2\\pi y)\n$$\n$$\nf(x,y,t) = \\left(17\\pi^2 - 1\\right)\\exp(-t)\\,\\sin(\\pi x)\\,\\sin(2\\pi y)\n$$\n这就是强迫项的闭式解析表达式。\n\n第二部分：Strang-ADI 的时间精度阶数 $r$。\n给定的偏微分方程形式为 $u_t = \\mathcal{L}u + f$，其中线性算子 $\\mathcal{L}$ 被分裂为两个部分，$\\mathcal{L} = \\mathcal{L}_x + \\mathcal{L}_y$，其中 $\\mathcal{L}_x = a\\frac{\\partial^2}{\\partial x^2}$ 且 $\\mathcal{L}_y = b\\frac{\\partial^2}{\\partial y^2}$。\n\n算子分裂法通过求解一系列更简单的子问题来逼近完整方程的解。Strang 分裂是一种对称的步骤组合，对于大小为 $\\Delta t$ 的时间步长，可以写为：\n$$\nu^{n+1} \\approx \\mathcal{S}_x(\\Delta t/2) \\mathcal{S}_y(\\Delta t) \\mathcal{S}_x(\\Delta t/2) u^n\n$$\n其中 $\\mathcal{S}_x(\\tau)$ 和 $\\mathcal{S}_y(\\tau)$ 是子问题 $u_t = \\mathcal{L}_x u$ 和 $u_t = \\mathcal{L}_y u$ 在时间间隔 $\\tau$ 内的演化算子。\n\n这种对称组合确保了该方法在时间上是二阶精度的，前提是单个传播子 $\\mathcal{S}_x$ 和 $\\mathcal{S}_y$ 至少是一阶精度的。在 ADI 方法的背景下，每个子步骤通常使用 Crank-Nicolson 方法求解，该方法本身是二阶精度的。对于步长为 $\\tau$ 的 Crank-Nicolson 传播子，它是精确指数算子的一个近似，误差阶为 $O(\\tau^3)$。\n$$\n\\mathcal{S}_{\\text{CN}}(\\tau) = \\exp(\\tau \\mathcal{L}) + O(\\tau^3)\n$$\nStrang 分裂组合的局部截断误差可以通过算子指数的泰勒级数展开得到。组合 `exp(Δt/2 A) exp(Δt B) exp(Δt/2 A)` 与 `exp(Δt(A+B))` 的展开式在 $(\\Delta t)^2$ 阶项之前都相匹配。首个误差项的阶数为 $(\\Delta t)^3$，与算子 $A$ 和 $B$ 的对易子有关。因此，Strang 分裂法的局部截断误差为 $O((\\Delta t)^3)$。\n\n对于一个局部截断误差为 $p+1$ 阶的数值方法，其全局误差为 $p$ 阶。因此，对于局部截断误差为 $O((\\Delta t)^3)$ 的 Strang 分裂法，其全局时间精度阶数为 $2$。\n对于线性问题，这通常是成立的，无论算子 $\\mathcal{L}_x$ 和 $\\mathcal{L}_y$ 是否对易。在这个具体问题中，由于算子包含对不同自变量的偏导数（且系数为常数），它们确实是对易的：对于足够光滑的 $u$，有 $\\mathcal{L}_x\\mathcal{L}_y u = \\mathcal{L}_y\\mathcal{L}_x u$。这种对易性简化了分析并证实了二阶精度，但它并非 Strang 分裂法达到二阶精度的必要条件。\n\n因此，预期的理论时间精度阶数 $r$ 为 $2$。\n\n最终答案由两部分组成：$f(x,y,t)$ 的表达式和 $r$ 的整数值。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n(17\\pi^2 - 1)\\exp(-t)\\sin(\\pi x)\\sin(2\\pi y)  2\n\\end{pmatrix}\n}\n$$", "id": "3427454"}]}