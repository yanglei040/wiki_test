{"hands_on_practices": [{"introduction": "在科学与工程计算中，许多核心问题最终都归结为求解大型线性方程组，尤其是在使用有限差分或有限元方法对偏微分方程进行离散化时。本练习将通过一个经典的物理模型——一维热传导方程，来具体展示这一过程。我们将引导您运用隐式向后欧拉格式，亲手推导出离散化后所产生的线性系统，并揭示其系数矩阵为何呈现出高效求解所必需的三对角结构，从而为学习和应用托马斯算法提供坚实的背景和动机。[@problem_id:3456851]", "problem": "考虑一维热传导偏微分方程 (PDE) $u_{t}=\\kappa\\,u_{xx}$，该方程定义在一个带有 Dirichlet 边界条件的空间区间上，其中 $\\kappa>0$ 是一个常数热扩散系数。使用间距为 $h$ 的均匀网格对空间域进行离散化，内部节点索引为 $i=1,2,\\dots,N-1$，并使用均匀步长 $\\Delta t$ 对时间进行离散化，时间层为 $t^{n}$ 和 $t^{n+1}=t^{n}+\\Delta t$。在时间上使用隐式后向 Euler 方法，对空间二阶导数使用二阶中心有限差分。从这些基本离散化出发，推导在每个时间步为求解内部节点值 $u_{i}^{n+1}$ 所必须求解的线性代数方程组，证明其系数矩阵是三对角的，并纯粹用 $\\kappa$、$\\Delta t$ 和 $h$ 表示三个不同的对角带元素（次对角线、主对角线、超对角线）。清晰说明端点处的 Dirichlet 边界值如何进入方程组的右侧，但不改变这三个对角带系数。将您的最终答案表示为一个单行矩阵，其中按顺序包含三个对角带元素：次对角线、主对角线、超对角线。不需要数值；请提供精确的符号表达式。", "solution": "问题陈述经评估是具有科学依据、适定、客观且自洽的。它代表了数值偏微分方程领域中的一个标准和基础任务。因此，该问题是有效的，并将提供解答。\n\n控制偏微分方程 (PDE) 是一维热方程：\n$$\nu_{t} = \\kappa\\,u_{xx}\n$$\n其中 $u=u(x,t)$ 是温度，$\\kappa > 0$ 是热扩散系数，$t$ 是时间，$x$ 是空间坐标。区域是一个有限空间区间，并在端点处指定了 Dirichlet 边界条件。\n\n根据要求，我们需要对此方程进行离散化。设空间域通过间距为 $h$ 的均匀网格进行离散化，使得对于整数索引 $i$，有 $x_i = i h$。内部节点的索引从 $i=1$ 到 $N-1$。时间域通过均匀步长 $\\Delta t$ 进行离散化，使得 $t^n = n \\Delta t$。我们将 $u(x_i, t^n)$ 的数值近似表示为 $u_i^n$。\n\n问题指定对时间导数使用隐式后向 Euler 方法。此格式在时间层 $t^{n+1}$ 处近似时间导数：\n$$\nu_t \\bigg|_{i}^{n+1} \\approx \\frac{u_i^{n+1} - u_i^n}{\\Delta t}\n$$\n对于空间二阶导数，使用二阶中心有限差分近似。在隐式格式中，它也在未来的时间层 $t^{n+1}$ 处进行计算：\n$$\nu_{xx} \\bigg|_{i}^{n+1} \\approx \\frac{u_{i-1}^{n+1} - 2u_i^{n+1} + u_{i+1}^{n+1}}{h^2}\n$$\n将这些离散近似代入原始偏微分方程，我们得到每个内部节点 $i=1, 2, \\dots, N-1$ 的有限差分方程：\n$$\n\\frac{u_i^{n+1} - u_i^n}{\\Delta t} = \\kappa \\left( \\frac{u_{i-1}^{n+1} - 2u_i^{n+1} + u_{i+1}^{n+1}}{h^2} \\right)\n$$\n我们的目标是为新时间步的未知值 $u_i^{n+1}$ 推导线性代数方程组。为此，我们重排方程，将所有带上标 $n+1$ 的项（未知数）分组到左侧 (LHS)，并将所有带上标 $n$ 的项（来自前一时间步的已知量）分组到右侧 (RHS)。\n\n首先，两边同乘以 $\\Delta t$：\n$$\nu_i^{n+1} - u_i^n = \\frac{\\kappa \\Delta t}{h^2} \\left( u_{i-1}^{n+1} - 2u_i^{n+1} + u_{i+1}^{n+1} \\right)\n$$\n我们定义无量纲扩散数 $r$ 如下：\n$$\nr = \\frac{\\kappa \\Delta t}{h^2}\n$$\n将 $r$ 代入方程得到：\n$$\nu_i^{n+1} - u_i^n = r \\left( u_{i-1}^{n+1} - 2u_i^{n+1} + u_{i+1}^{n+1} \\right)\n$$\n现在，我们将所有涉及未知值 $u^{n+1}$ 的项收集到左侧：\n$$\nu_i^{n+1} - r u_{i-1}^{n+1} + 2r u_i^{n+1} - r u_{i+1}^{n+1} = u_i^n\n$$\n对每个未知节点值的系数进行分组，得到通用内部节点 $i$ 的方程：\n$$\n-r u_{i-1}^{n+1} + (1 + 2r) u_i^{n+1} - r u_{i+1}^{n+1} = u_i^n\n$$\n此方程对 $i=1, 2, \\dots, N-1$ 成立。这 $N-1$ 个线性方程的集合构成一个方程组 $A \\mathbf{u}^{n+1} = \\mathbf{b}$，其中 $\\mathbf{u}^{n+1}$ 是未知节点值向量 $[u_1^{n+1}, u_2^{n+1}, \\dots, u_{N-1}^{n+1}]^T$。\n\n$u_i^{n+1}$ 的方程结构只涉及其自身及其紧邻节点 $u_{i-1}^{n+1}$ 和 $u_{i+1}^{n+1}$。这种结构直接表明系数矩阵 $A$ 是三对角的。对角带上的元素由我们推导的系数给出：\n- $u_{i-1}^{n+1}$ 的系数是 $-r$。这构成了矩阵的次对角线。\n- $u_i^{n+1}$ 的系数是 $(1+2r)$。这构成了矩阵的主对角线。\n- $u_{i+1}^{n+1}$ 的系数是 $-r$。这构成了矩阵的超对角线。\n\nDirichlet 边界条件指定了区域端点处的值，比如说在 $x_0=0$ 和 $x_N=L$ 处。这些是给定的时间函数，因此在时间 $t^{n+1}$，值 $u_0^{n+1}$ 和 $u_N^{n+1}$ 是已知量。我们来研究它们如何影响该方程组。\n\n对于第一个内部节点 $i=1$：\n$$\n-r u_{0}^{n+1} + (1 + 2r) u_1^{n+1} - r u_2^{n+1} = u_1^n\n$$\n由于 $u_0^{n+1}$ 是来自边界条件的已知值，其项被移到右侧 (RHS)：\n$$\n(1 + 2r) u_1^{n+1} - r u_2^{n+1} = u_1^n + r u_0^{n+1}\n$$\n这表明，针对内部节点的 $(N-1) \\times (N-1)$ 系数矩阵的第一行中，主对角线上是 $(1+2r)$，超对角线上是 $-r$。次对角线元素实际上为零。边界值 $u_0^{n+1}$ 贡献给右侧向量 $\\mathbf{b}$ 的第一个分量。\n\n对于最后一个内部节点 $i=N-1$：\n$$\n-r u_{N-2}^{n+1} + (1 + 2r) u_{N-1}^{n+1} - r u_{N}^{n+1} = u_{N-1}^n\n$$\n类似地，$u_N^{n+1}$ 是一个已知的边界值，并被移到右侧：\n$$\n-r u_{N-2}^{n+1} + (1 + 2r) u_{N-1}^{n+1} = u_{N-1}^n + r u_N^{n+1}\n$$\n这表明，系数矩阵的最后一行中，次对角线上是 $-r$，主对角线上是 $(1+2r)$。超对角线元素实际上为零。边界值 $u_N^{n+1}$ 贡献给右侧向量 $\\mathbf{b}$ 的最后一个分量。\n\n因此，Dirichlet 边界条件不改变针对内部未知数的系数矩阵的三个主要对角带元素；它们只修改右侧向量的第一和最后一个分量。三对角矩阵的三个不同的非零对角带元素在矩阵内部是常数。通过代回 $r = \\frac{\\kappa \\Delta t}{h^2}$，用给定的参数 $\\kappa$、$\\Delta t$ 和 $h$ 来表示它们：\n- 次对角线元素： $-r = -\\frac{\\kappa \\Delta t}{h^2}$\n- 主对角线元素： $1+2r = 1 + \\frac{2\\kappa \\Delta t}{h^2}$\n- 超对角线元素： $-r = -\\frac{\\kappa \\Delta t}{h^2}$\n\n最终答案是一个行矩阵，按指定顺序包含这三个元素。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n-\\frac{\\kappa \\Delta t}{h^2} & 1 + \\frac{2\\kappa \\Delta t}{h^2} & -\\frac{\\kappa \\Delta t}{h^2}\n\\end{pmatrix}\n}\n$$", "id": "3456851"}, {"introduction": "在理解了三对角矩阵的来源之后，我们接下来将深入探究托马斯算法本身的代数核心。该算法本质上是为三对角系统量身定制的一种高效的高斯消元法，等价于一种稀疏$LU$分解。本练习旨在加深您对这一内在联系的理解，通过运用算法在正向消元过程中产生的“主元”（即$U$矩阵的对角元素），推导出一个计算三对角矩阵行列式的线性时间复杂度（$O(n)$）方法。[@problem_id:3456861]", "problem": "在均匀网格上，沿一条线施加狄利克雷边界条件的标量、二阶、线性偏微分方程(PDE)的有限差分-离散，会导出一个具有三对角系数矩阵的线性系统。设 $A \\in \\mathbb{R}^{n \\times n}$ 为三对角矩阵，其对角元素为 $\\{a_i\\}_{i=1}^{n}$，上对角元素为 $\\{b_i\\}_{i=1}^{n-1}$，下对角元素为 $\\{c_i\\}_{i=2}^{n}$，即\n$$\nA \\;=\\; \\begin{pmatrix}\na_1 & b_1 & 0 & \\cdots & 0 \\\\\nc_2 & a_2 & b_2 & \\ddots & \\vdots \\\\\n0 & \\ddots & \\ddots & \\ddots & 0 \\\\\n\\vdots & \\ddots & c_{n-1} & a_{n-1} & b_{n-1} \\\\\n0 & \\cdots & 0 & c_n & a_n\n\\end{pmatrix}.\n$$\n仅根据以下基本事实进行推导：(i) 行列式在矩阵乘法下是可乘的，(ii) 三角矩阵的行列式等于其对角元素的乘积，以及 (iii) 当所有主元非零时，高斯消元可实现下三角-上三角分解 (LU) $A = LU$，其中 $L$ 为单位下三角矩阵，$U$ 为上三角矩阵。在不引用任何预先给出的针对三对角矩阵的专门公式的情况下，按以下步骤进行。\n\n- 通过将高斯消元法专门应用于三对角稀疏模式（托马斯算法），符号化地消去下对角元素，从而构造一个单位下三角矩阵 $L$ 和一个上三角矩阵 $U$。其中 $U$ 的对角元素为 $\\{u_i\\}_{i=1}^{n}$，其上对角元素继承自 $\\{b_i\\}_{i=1}^{n-1}$。仅使用上面列出的性质，推导出一个计算 $\\det(A)$ 的 $O(n)$ 方法，并明确指出为得到该行列式值必须计算的精确标量。\n\n- 令 $D_k := \\det(A_k)$ 表示 $k$ 阶顺序主子式，其中 $A_k$ 是 $A$ 的 $k \\times k$ 阶顺序主子矩阵。从第一性原理出发，推导 $\\{D_k\\}_{k=0}^{n}$ 满足的一个三项递推关系，包括明确的初始条件。你的推导应仅依赖于行列式的基本性质和三对角结构。\n\n- 最后，将你的推导应用于 $n=6$ 的特定严格对角占优情况，其中对所有 $i$ 有 $a_i = 3$，对 $i = 1,\\dots,5$ 有 $b_i = -1$，对 $i = 2,\\dots,6$ 有 $c_i = -1$。使用你所证明的 $O(n)$ 方法精确计算 $\\det(A)$。将你的最终结果表示为一个无舍入的精确整数。", "solution": "用户提供了一个关于三对角矩阵行列式的三部分问题。该问题经验证是自洽的，具有线性代数的科学基础，并且陈述客观。\n\n**第一部分：通过LU分解推导计算 $\\det(A)$ 的 $O(n)$ 方法**\n\n我们的任务是利用其LU分解找到一个计算三对角矩阵 $A$ 行列式的有效方法。矩阵 $A$ 的形式如下：\n$$\nA = \\begin{pmatrix}\na_1 & b_1 & 0 & \\cdots & 0 \\\\\nc_2 & a_2 & b_2 & \\ddots & \\vdots \\\\\n0 & \\ddots & \\ddots & \\ddots & 0 \\\\\n\\vdots & \\ddots & c_{n-1} & a_{n-1} & b_{n-1} \\\\\n0 & \\cdots & 0 & c_n & a_n\n\\end{pmatrix}\n$$\n我们寻求一个分解 $A = LU$，其中 $L$ 是一个单位下三角矩阵，$U$ 是一个上三角矩阵。$A$ 的三对角结构意味着 $L$ 将是单位下双对角矩阵，$U$ 将是上双对角矩阵。\n\n令 $L$ 和 $U$ 表示为：\n$$\nL = \\begin{pmatrix}\n1 & 0 & \\cdots & 0 \\\\\n\\ell_2 & 1 & \\ddots & \\vdots \\\\\n\\vdots & \\ddots & \\ddots & 0 \\\\\n0 & \\cdots & \\ell_n & 1\n\\end{pmatrix}, \\quad\nU = \\begin{pmatrix}\nu_1 & b_1 & 0 & \\cdots & 0 \\\\\n0 & u_2 & b_2 & \\ddots & \\vdots \\\\\n\\vdots & \\ddots & \\ddots & \\ddots & 0 \\\\\n\\vdots &  \\ddots & u_{n-1} & b_{n-1} \\\\\n0 & \\cdots & \\cdots & 0 & u_n\n\\end{pmatrix}\n$$\n这里我们利用了给定的信息，即 $U$ 的上对角线由来自 $A$ 的元素 $\\{b_i\\}_{i=1}^{n-1}$ 组成。通过执行矩阵乘法 $LU$ 并使其结果等于 $A$，我们可以确定 $L$ 的未知元素 $\\{\\ell_i\\}_{i=2}^{n}$ 和 $U$ 的未知元素 $\\{u_i\\}_{i=1}^{n}$。\n\n乘积 $LU$ 为：\n$$\nLU = \\begin{pmatrix}\nu_1 & b_1 & 0 & \\cdots & 0 \\\\\n\\ell_2 u_1 & \\ell_2 b_1 + u_2 & b_2 & \\ddots & \\vdots \\\\\n0 & \\ell_3 u_2 & \\ell_3 b_2 + u_3 & \\ddots & 0 \\\\\n\\vdots & \\ddots & \\ddots & \\ddots & b_{n-1} \\\\\n0 & \\cdots & 0 & \\ell_n u_{n-1} & \\ell_n b_{n-1} + u_n\n\\end{pmatrix}\n$$\n通过逐行比较 $LU$ 的元素与 $A$ 的元素：\n1.  对于第一行 ($i=1$)：\n    -   对角元素为 $u_1 = a_1$。\n\n2.  对于随后的每一行 $i=2, 3, \\dots, n$：\n    -   下对角元素为 $\\ell_i u_{i-1} = c_i$。这表示 $\\ell_i = \\frac{c_i}{u_{i-1}}$，这要求 $u_{i-1} \\neq 0$。这对应于高斯消元中的主元非零。\n    -   对角元素为 $\\ell_i b_{i-1} + u_i = a_i$。这表示 $u_i = a_i - \\ell_i b_{i-1}$。\n\n将 $\\ell_i$ 的表达式代入 $u_i$ 的方程中，我们得到 $U$ 对角元素的递推关系：\n$$\nu_1 = a_1\n$$\n$$\nu_i = a_i - \\frac{c_i b_{i-1}}{u_{i-1}} \\quad \\text{for } i = 2, 3, \\dots, n\n$$\n这构成了一个求解 $\\{u_i\\}$ 的串行算法。该算法等效于托马斯算法的前向消元阶段。\n\n现在，我们使用提供的关于行列式的基本事实。\n(i) 行列式是可乘的：$\\det(A) = \\det(L) \\det(U)$。\n(ii) 三角矩阵的行列式是对角元素的乘积。\n对于矩阵 $L$，它是一个单位下三角矩阵，所有对角元素都是1。因此，$\\det(L) = 1$。\n对于矩阵 $U$，它是一个上三角矩阵，对角元素是 $\\{u_i\\}_{i=1}^{n}$。因此，$\\det(U) = \\prod_{i=1}^{n} u_i$。\n综合这些结果，我们得到 $A$ 的行列式：\n$$\n\\det(A) = 1 \\cdot \\prod_{i=1}^{n} u_i = \\prod_{i=1}^{n} u_i\n$$\n计算 $\\det(A)$ 的方法如下：\n1. 初始化 $u_1 = a_1$。\n2. 对于从 $i=2$到$n$的每个$i$，使用递推式 $u_i = a_i - (c_i b_{i-1}) / u_{i-1}$ 计算 $u_i$。\n3. 行列式是所有计算出的 $u_i$ 值的乘积：$\\det(A) = u_1 u_2 \\cdots u_n$。\n\n计算 $u_i$ 的递推关系的每一步都需要常数数量的算术运算（一次乘法、一次除法、一次减法）。由于这个过程重复 $n-1$ 次，计算所有 $\\{u_i\\}$ 需要 $O(n)$ 次运算。最后计算这 $n$ 个值的乘积也需要 $O(n)$ 次运算。因此，这是一个计算行列式的 $O(n)$ 方法。必须计算的精确标量是 $U$ 的对角元素 $\\{u_i\\}_{i=1}^{n}$。\n\n**第二部分：推导顺序主子式的三项递推关系**\n\n令 $D_k = \\det(A_k)$，其中 $A_k$ 是 $A$ 的 $k \\times k$ 阶顺序主子矩阵。我们将使用行列式的一个基本性质——余子式展开，来推导 $\\{D_k\\}$ 的递推关系。\n\n子矩阵 $A_k$ 为：\n$$\nA_k = \\begin{pmatrix}\na_1 & b_1 &   \\\\\nc_2 & a_2 & b_2 &  \\\\\n & \\ddots & \\ddots & \\ddots & \\\\\n & & c_{k-1} & a_{k-1} & b_{k-1} \\\\\n & & & c_k & a_k\n\\end{pmatrix}\n$$\n我们沿最后一行（第 $k$ 行）进行余子式展开来计算 $D_k = \\det(A_k)$。该行中唯一的非零元素是 $(A_k)_{k, k-1} = c_k$ 和 $(A_k)_{k, k} = a_k$。\n$$\nD_k = (-1)^{k+(k-1)} (A_k)_{k, k-1} M_{k, k-1} + (-1)^{k+k} (A_k)_{k, k} M_{k, k}\n$$\n$$\nD_k = -c_k M_{k, k-1} + a_k M_{k, k}\n$$\n其中 $M_{i,j}$ 是位于第 $i$ 行和第 $j$ 列元素的子式。\n\n子式 $M_{k, k}$ 是从 $A_k$ 中移除第 $k$ 行和第 $k$ 列后得到的矩阵的行列式。这个结果矩阵正是 $A_{k-1}$。因此，$M_{k, k} = \\det(A_{k-1}) = D_{k-1}$。\n\n子式 $M_{k, k-1}$ 是从 $A_k$ 中移除第 $k$ 行和第 $k-1$ 列后得到的矩阵的行列式。这个 $(k-1) \\times (k-1)$ 矩阵为：\n$$\n\\begin{pmatrix}\na_1 & b_1 & \\cdots & 0 & 0 \\\\\nc_2 & a_2 & \\cdots & 0 & 0 \\\\\n\\vdots & \\ddots & \\ddots &  & \\vdots \\\\\n0 & \\cdots & c_{k-2} & a_{k-2} & 0 \\\\\n0 & \\cdots & 0 & c_{k-1} & b_{k-1}\n\\end{pmatrix}\n$$\n该矩阵可被视为在第 $(k-2)$ 行和列之后分块的上三角块矩阵：\n$$\n\\begin{pmatrix} A_{k-2} & \\mathbf{v} \\\\ \\mathbf{0} & b_{k-1} \\end{pmatrix}\n$$\n其中 $\\mathbf{v}$ 是一个列向量，其唯一的非零项是顶部的 $(A_{k-1})_{k-2, k-1} = b_{k-2}$，但更简单地说，沿最后一列进行余子式展开可揭示，其行列式为 $b_{k-1}$ 乘以其代数余子式的行列式，而该代数余子式即为 $A_{k-2}$。因此，$M_{k, k-1} = b_{k-1} \\det(A_{k-2}) = b_{k-1} D_{k-2}$。\n\n将子式的表达式代回 $D_k$ 的展开式中：\n$$\nD_k = a_k D_{k-1} - c_k (b_{k-1} D_{k-2})\n$$\n这给出了三项递推关系：\n$$\nD_k = a_k D_{k-1} - b_{k-1} c_k D_{k-2} \\quad \\text{for } k \\ge 2\n$$\n为了完成定义，我们需要 $k=0$ 和 $k=1$ 的初始条件。\n$D_1 = \\det(A_1) = \\det((a_1)) = a_1$。\n对于 $k=2$，递推关系给出 $D_2 = a_2 D_1 - b_1 c_2 D_0$。\n直接计算得到 $D_2 = \\det \\begin{pmatrix} a_1 & b_1 \\\\ c_2 & a_2 \\end{pmatrix} = a_1 a_2 - b_1 c_2$。\n令两个 $D_2$ 的表达式相等：$a_1 a_2 - b_1 c_2 = a_2 a_1 - b_1 c_2 D_0$。假设 $b_1 c_2 \\neq 0$，则要求 $D_0 = 1$。这是一个 $0 \\times 0$ 矩阵行列式的标准约定。\n初始条件为 $D_0=1$ 和 $D_1=a_1$。\n\n**第三部分：应用于一个具体案例**\n\n我们给定一个具体的 $6 \\times 6$ 矩阵，其中 $n=6$，$a_i=3$，$b_i=-1$，以及 $c_i=-1$。该矩阵是严格对角占优的，这保证了所有主元 $u_i$ 都将非零。\n我们将使用第一部分中推导出的 $O(n)$ 方法来计算 $\\det(A)$。递推关系为：\n$u_1 = a_1 = 3$。\n$u_i = a_i - \\frac{c_i b_{i-1}}{u_{i-1}} = 3 - \\frac{(-1)(-1)}{u_{i-1}} = 3 - \\frac{1}{u_{i-1}}$ for $i=2, \\dots, 6$。\n\n我们来计算序列 $\\{u_i\\}_{i=1}^6$：\n- $u_1 = 3$\n- $u_2 = 3 - \\frac{1}{u_1} = 3 - \\frac{1}{3} = \\frac{9-1}{3} = \\frac{8}{3}$\n- $u_3 = 3 - \\frac{1}{u_2} = 3 - \\frac{1}{8/3} = 3 - \\frac{3}{8} = \\frac{24-3}{8} = \\frac{21}{8}$\n- $u_4 = 3 - \\frac{1}{u_3} = 3 - \\frac{1}{21/8} = 3 - \\frac{8}{21} = \\frac{63-8}{21} = \\frac{55}{21}$\n- $u_5 = 3 - \\frac{1}{u_4} = 3 - \\frac{1}{55/21} = 3 - \\frac{21}{55} = \\frac{165-21}{55} = \\frac{144}{55}$\n- $u_6 = 3 - \\frac{1}{u_5} = 3 - \\frac{1}{144/55} = 3 - \\frac{55}{144} = \\frac{432-55}{144} = \\frac{377}{144}$\n\n$A$ 的行列式是这些值的乘积：\n$$\n\\det(A) = \\prod_{i=1}^{6} u_i = u_1 \\cdot u_2 \\cdot u_3 \\cdot u_4 \\cdot u_5 \\cdot u_6\n$$\n$$\n\\det(A) = 3 \\times \\frac{8}{3} \\times \\frac{21}{8} \\times \\frac{55}{21} \\times \\frac{144}{55} \\times \\frac{377}{144}\n$$\n这是一个连乘消项积。大多数项都消去了：\n$$\n\\det(A) = \\cancel{3} \\times \\frac{\\cancel{8}}{\\cancel{3}} \\times \\frac{\\cancel{21}}{\\cancel{8}} \\times \\frac{\\cancel{55}}{\\cancel{21}} \\times \\frac{\\cancel{144}}{\\cancel{55}} \\times \\frac{377}{\\cancel{144}} = 377\n$$\n行列式精确值为 $377$。这个计算可以用第二部分的递推关系来验证。令 $D_k = \\det(A_k)$。递推关系为 $D_k = 3D_{k-1} - D_{k-2}$，其中 $D_0=1, D_1=3$。\n$D_2 = 3(3) - 1 = 8$。\n$D_3 = 3(8) - 3 = 21$。\n$D_4 = 3(21) - 8 = 55$。\n$D_5 = 3(55) - 21 = 144$。\n$D_6 = 3(144) - 55 = 432 - 55 = 377$。\n结果是一致的。", "answer": "$$\\boxed{377}$$", "id": "3456861"}, {"introduction": "理论的优雅必须在实践的考验中得到验证，数值算法的稳定性尤其如此。本练习将引入一个更具挑战性的对流-扩散方程模型，其中对流项占主导时，标准的数值方法可能会失效。您将通过对比中心差分和迎风差分两种离散格式，分析它们如何影响最终三对角矩阵的对角占优特性，并进一步探究这种影响对托马斯算法在极限情况（小扩散系数 $\\epsilon \\to 0$）下数值稳定性的深刻含义。[@problem_id:3456789]", "problem": "考虑区间 $x \\in [0,1]$ 上的一维稳态对流扩散模型方程 $-\\epsilon\\,u''(x) + u'(x) = f(x)$，其狄利克雷边界条件为 $u(0) = 0$ 和 $u(1) = 1$。其中 $\\epsilon > 0$ 是一个小的扩散系数， $f$ 是一个光滑函数。使用包含 $N+1$ 个节点的均匀网格，$x_j = jh$，$j = 0,1,\\dots,N$，步长 $h = 1/N$。未知数为内部节点的值 $u_j \\approx u(x_j)$，$j = 1,\\dots,N-1$。对 $u''$ 使用标准的二阶中心有限差分近似，并比较以下两种对 $u'$ 的离散化方法：\n- 中心差分：$u'(x_j) \\approx \\left(u_{j+1} - u_{j-1}\\right)/(2h)$。\n- 一阶迎风差分（与向右的平流一致）：$u'(x_j) \\approx \\left(u_j - u_{j-1}\\right)/h$。\n\n对于每种离散化方法，所得到的关于内部未知向量的线性系统是三对角的，并使用三对角矩阵算法（TDMA）（也称为 Thomas 算法）进行求解。令 $d_i$ 表示在对相应的三对角系统应用 Thomas 算法的前向消元过程中，在第 $i$ 步遇到的主元，其中 $i = 1,2,\\dots,N-1$。假设 $N \\geq 3$ 是固定的，并考虑奇异摄动状态 $\\epsilon \\to 0$（边界层主导的流动）。\n\n从有限差分近似的基本定义和 Thomas 算法中的前向消元过程出发，推导当 $\\epsilon \\to 0$ 时，每种离散化方法的主元序列 $\\{d_i\\}$ 的主阶渐近性。然后，通过计算以下两个极限来量化每种情况下的最小主元：\n$$\nL_{\\mathrm{c}} \\;=\\; \\lim_{\\epsilon \\to 0} \\frac{h^{2}}{\\epsilon} \\,\\min_{1 \\leq i \\leq N-1} d_i^{(\\mathrm{central})}\n\\qquad\\text{和}\\qquad\nL_{\\mathrm{u}} \\;=\\; \\lim_{\\epsilon \\to 0} h \\,\\min_{1 \\leq i \\leq N-1} d_i^{(\\mathrm{upwind})},\n$$\n其中 $d_i^{(\\mathrm{central})}$ 和 $d_i^{(\\mathrm{upwind})}$ 分别表示中心差分和迎风差分离散化的主元序列。将你的最终答案以包含 $\\left(L_{\\mathrm{c}},\\,L_{\\mathrm{u}}\\right)$ 的单行矩阵形式报告，不要进行任何四舍五入。作为推导的一部分，讨论在 $\\epsilon \\to 0$ 的极限情况下，两种离散化方法对于 Thomas 算法的对角占优性和稳定性的影响。", "solution": "该问题要求对一维对流扩散方程 $-\\epsilon\\,u''(x) + u'(x) = f(x)$ 在 $x \\in [0,1]$ 上（边界条件为 $u(0) = 0$ 和 $u(1) = 1$）的两种不同有限差分离散化方法，分析由 Thomas 算法生成的主元。该分析将在奇异摄动极限 $\\epsilon \\to 0$ 下，对于固定的网格间距 $h=1/N$ 进行。\n\n该方程在均匀网格 $x_j = jh$（$j=0, 1, \\dots, N$）上进行离散化。二阶导数由标准的二阶中心差分近似：\n$$\nu''(x_j) \\approx \\frac{u_{j+1} - 2u_j + u_{j-1}}{h^2}\n$$\n得到的关于内部未知数 $u_j$（$j=1, \\dots, N-1$）的线性系统形式为 $a_j u_{j-1} + b_j u_j + c_j u_{j+1} = \\tilde{f}_j$。Thomas 算法 (TDMA) 等价于对三对角矩阵 $A$ 进行 LU 分解，其中主元 $d_i$ 是上三角矩阵 $U$ 的对角元素。主元由以下递推关系生成：\n$$\nd_1 = b_1, \\qquad d_i = b_i - \\frac{a_i c_{i-1}}{d_{i-1}} \\quad \\text{for } i=2, \\dots, N-1.\n$$\n边界条件 $u_0=0$ 和 $u_N=1$ 被整合到系统的第一个和最后一个方程中，这会影响右端向量，但不会影响一般内部行的矩阵元素，这些元素在整个网格上是常数。\n\n**中心差分离散化**\n\n对于一阶导数的中心差分近似 $u'(x_j) \\approx (u_{j+1} - u_{j-1})/(2h)$，在内部节点 $x_j$ 处的离散方程为：\n$$\n-\\epsilon \\frac{u_{j+1} - 2u_j + u_{j-1}}{h^2} + \\frac{u_{j+1} - u_{j-1}}{2h} = f_j\n$$\n整理各项得到三对角系统的系数：\n$$\n\\left(-\\frac{\\epsilon}{h^2} - \\frac{1}{2h}\\right)u_{j-1} + \\left(\\frac{2\\epsilon}{h^2}\\right)u_j + \\left(-\\frac{\\epsilon}{h^2} + \\frac{1}{2h}\\right)u_{j+1} = f_j\n$$\n对于矩阵的内部行（从 $i=2$ 到 $N-2$），系数是均匀的。由于边界条件，第一行和最后一行是特殊的，但因为 $u_0=0$，矩阵第一行的结构与通用形式相匹配。系统矩阵 $A^{(\\mathrm{c})}$ 的系数为：\n$a_i^{(\\mathrm{c})} = a = -\\frac{\\epsilon}{h^2} - \\frac{1}{2h}$ for $i \\ge 2$.\n$b_i^{(\\mathrm{c})} = b = \\frac{2\\epsilon}{h^2}$ for all $i$.\n$c_i^{(\\mathrm{c})} = c = -\\frac{\\epsilon}{h^2} + \\frac{1}{2h}$ for $i \\le N-2$.\n\n严格对角占优的条件是 $|b_i| > |a_i| + |c_i|$。对于足够小的 $\\epsilon$ 使得 $h > 2\\epsilon$，我们有 $|c| = \\frac{1}{2h} - \\frac{\\epsilon}{h^2} > 0$。该条件变为：\n$$\n\\frac{2\\epsilon}{h^2} > \\left(\\frac{\\epsilon}{h^2} + \\frac{1}{2h}\\right) + \\left(\\frac{1}{2h} - \\frac{\\epsilon}{h^2}\\right) = \\frac{1}{h}\n$$\n这可以化简为 $2\\epsilon > h$，或者说网格佩克莱特数 $Pe_h = h/(2\\epsilon)$ 必须小于 1。在极限 $\\epsilon \\to 0$ 的情况下，这个条件被违反，所以该矩阵不是对角占优的。\n\n主元 $d_i^{(\\mathrm{c})}$ 由递推式给出：$d_1^{(\\mathrm{c})} = b$ 和 $d_i^{(\\mathrm{c})} = b - \\frac{ac}{d_{i-1}^{(\\mathrm{c})}}$。乘积 $ac$ 为：\n$$\nac = \\left(-\\frac{\\epsilon}{h^2} - \\frac{1}{2h}\\right)\\left(-\\frac{\\epsilon}{h^2} + \\frac{1}{2h}\\right) = \\left(\\frac{\\epsilon}{h^2}\\right)^2 - \\left(\\frac{1}{2h}\\right)^2 = \\frac{\\epsilon^2}{h^4} - \\frac{1}{4h^2}\n$$\n当 $\\epsilon \\to 0$ 时，$b \\to 0$ 且 $ac \\to -1/(4h^2)$。\n第一个主元是 $d_1^{(\\mathrm{c})} = b = \\frac{2\\epsilon}{h^2}$。\n第二个主元是 $d_2^{(\\mathrm{c})} = b - \\frac{ac}{d_1^{(\\mathrm{c})}} = \\frac{2\\epsilon}{h^2} - \\frac{\\epsilon^2/h^4 - 1/(4h^2)}{2\\epsilon/h^2} = \\frac{2\\epsilon}{h^2} - \\left(\\frac{\\epsilon}{2h^2} - \\frac{1}{8\\epsilon}\\right) = \\frac{3\\epsilon}{2h^2} + \\frac{1}{8\\epsilon}$。\n对于小的 $\\epsilon$，主阶行为是 $d_2^{(\\mathrm{c})} \\approx \\frac{1}{8\\epsilon}$。\n第三个主元是 $d_3^{(\\mathrm{c})} = b - \\frac{ac}{d_2^{(\\mathrm{c})}} \\approx \\frac{2\\epsilon}{h^2} - \\frac{-1/(4h^2)}{1/(8\\epsilon)} = \\frac{2\\epsilon}{h^2} + \\frac{2\\epsilon}{h^2} = \\frac{4\\epsilon}{h^2}$。\n这揭示了一种模式，即奇数下标的主元是 $O(\\epsilon)$ 阶，偶数下标的主元是 $O(1/\\epsilon)$ 阶。可以证明奇数索引的主元序列是单调递增的，而偶数索引的主元序列是单调递减的。因此，所有奇数索引主元中的最小值是第一个，即 $d_1^{(\\mathrm{c})}$。所有偶数索引主元中的最小值是最后一个，即 $d_{N-1}^{(\\mathrm{c})}$（如果 $N-1$ 是偶数）。在 $\\epsilon \\to 0$ 的极限下，奇数索引的主元都趋向于零，而偶数索引的主元都趋向于无穷大。因此，序列中的最小主元由奇数子序列决定，其最小值是 $d_1^{(\\mathrm{c})}$。\n$$\n\\min_{1 \\leq i \\leq N-1} d_i^{(\\mathrm{central})} \\approx d_1^{(\\mathrm{c})} = \\frac{2\\epsilon}{h^2} \\quad \\text{as } \\epsilon \\to 0.\n$$\n因此，第一个极限是：\n$$\nL_{\\mathrm{c}} = \\lim_{\\epsilon \\to 0} \\frac{h^2}{\\epsilon} \\left(\\frac{2\\epsilon}{h^2}\\right) = 2.\n$$\n由于主元可以任意小（$O(\\epsilon)$），这表明在 $\\epsilon \\to 0$ 时，没有主元选择的 Thomas 算法会变得数值不稳定。\n\n**迎风差分离散化**\n\n对于一阶导数的一阶迎风差分近似 $u'(x_j) \\approx (u_j - u_{j-1})/h$，离散方程为：\n$$\n-\\epsilon \\frac{u_{j+1} - 2u_j + u_{j-1}}{h^2} + \\frac{u_j - u_{j-1}}{h} = f_j\n$$\n整理各项得到三对角系统的系数：\n$$\n\\left(-\\frac{\\epsilon}{h^2} - \\frac{1}{h}\\right)u_{j-1} + \\left(\\frac{2\\epsilon}{h^2} + \\frac{1}{h}\\right)u_j + \\left(-\\frac{\\epsilon}{h^2}\\right)u_{j+1} = f_j\n$$\n系统矩阵 $A^{(\\mathrm{u})}$ 的系数为：\n$a_i^{(\\mathrm{u})} = a = -\\frac{\\epsilon}{h^2} - \\frac{1}{h}$\n$b_i^{(\\mathrm{u})} = b = \\frac{2\\epsilon}{h^2} + \\frac{1}{h}$\n$c_i^{(\\mathrm{u})} = c = -\\frac{\\epsilon}{h^2}$\n\n对角占优的条件是 $|b| > |a| + |c|$。\n$$\n\\frac{2\\epsilon}{h^2} + \\frac{1}{h} > \\left(\\frac{\\epsilon}{h^2} + \\frac{1}{h}\\right) + \\frac{\\epsilon}{h^2} = \\frac{2\\epsilon}{h^2} + \\frac{1}{h}\n$$\n这简化为 $\\frac{2\\epsilon}{h^2} + \\frac{1}{h} > \\frac{2\\epsilon}{h^2} + \\frac{1}{h}$，这是不成立的。但是，我们确实有 $|b| = |a| + |c|$，所以该矩阵是对角占优的（非严格）。这对于确保 Thomas 算法的数值稳定性是足够的，它保证了所有主元的大小都受到对角元素的限制。\n\n主元由 $d_1^{(\\mathrm{u})} = b$ 和 $d_i^{(\\mathrm{u})} = b - \\frac{ac}{d_{i-1}^{(\\mathrm{u})}}$ 给出。我们有 $a0, b>0, c0$，所以 $ac>0$。\n$d_1^{(\\mathrm{u})} = b = \\frac{2\\epsilon}{h^2} + \\frac{1}{h}$。\n由于 $d_1 > 0$ 并且 $ac>0$，那么 $d_2 = b - \\frac{ac}{d_1}  b$。可以证明，序列 $d_i^{(\\mathrm{u})}$ 是单调递减的，并收敛到一个正的极限，该极限是二次方程 $d^2 - bd + ac = 0$ 的较小根。\n$$\nd^2 - \\left(\\frac{2\\epsilon}{h^2} + \\frac{1}{h}\\right)d + \\left(\\frac{\\epsilon}{h^2}+\\frac{1}{h}\\right)\\frac{\\epsilon}{h^2} = 0\n$$\n在 $\\epsilon \\to 0$ 的极限下，该方程变为 $d^2 - \\frac{1}{h}d + O(\\epsilon) = 0$，其根近似为 $d \\approx 1/h$ 和 $d \\approx 0$。更精确地说，是 $d \\approx \\frac{1}{h}$ 和 $d \\approx \\frac{\\epsilon}{h}$。\n序列从 $d_1 \\approx 1/h$ 开始，递减并收敛到极限 $1/h$。更仔细的分析表明，极限是 $1/h$。因此，序列中的所有主元都以 $1/h$ 为界，最小值是最后一个主元 $d_{N-1}^{(\\mathrm{u})}$，它最接近极限值。\n$$\n\\min_{1 \\leq i \\leq N-1} d_i^{(\\mathrm{upwind})} \\approx \\lim_{i\\to\\infty} d_i^{(\\mathrm{upwind})} = \\frac{b - \\sqrt{b^2 - 4ac}}{2} \\approx \\frac{1}{h} \\quad \\text{as } \\epsilon \\to 0.\n$$\n因此，第二个极限是：\n$$\nL_{\\mathrm{u}} = \\lim_{\\epsilon \\to 0} h \\left(\\min_{1 \\leq i \\leq N-1} d_i^{(\\mathrm{upwind})}\\right) = \\lim_{\\epsilon \\to 0} h \\left(\\frac{1}{h}\\right) = 1.\n$$\n在这种情况下，最小主元的大小与 $\\epsilon$ 无关，表明了 Thomas 算法对于迎风格式的鲁棒性，即使在对流占主导的情况下也是如此。\n\n**结论**\n\n我们计算了两个极限：\n$L_{\\mathrm{c}} = 2$\n$L_{\\mathrm{u}} = 1$\n最终答案是这两个值的有序对。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n2  1\n\\end{pmatrix}\n}\n$$", "id": "3456789"}]}