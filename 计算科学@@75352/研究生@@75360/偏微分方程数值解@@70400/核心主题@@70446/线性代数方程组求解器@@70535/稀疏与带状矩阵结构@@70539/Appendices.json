{"hands_on_practices": [{"introduction": "偏微分方程的离散化常常产生具有特定稀疏结构的矩阵。本练习将指导您从一个一维有限差分格式出发，分析所得带状矩阵的关键属性，包括其带宽、$LU$ 分解的计算成本以及条件数，从而建立离散格式与矩阵性质之间的直接联系。[@problem_id:3445518] 这项基础分析对于理解和预测直接求解器的性能至关重要。", "problem": "考虑区间 $[0,1]$ 上的一维泊松方程的边值问题，其齐次狄利克雷边界条件为 $-u''(x)=f(x)$，$u(0)=u(1)=0$。设 $N$ 表示内部网格点的数量，并设 $h=1/(N+1)$ 为均匀网格间距。使用形式阶至少为二的 $(2q+1)$ 点格式，构建 $-u''(x)$ 的中心有限差分离散，其对称权重 $\\{\\alpha_{m}\\}_{m=-q}^{q}$ 满足 $\\alpha_{-m}=\\alpha_{m}$ 和相容性条件 $\\sum_{m=-q}^{q}\\alpha_{m}=0$ 及 $\\sum_{m=-q}^{q}m^{2}\\alpha_{m}=2$。该离散算子作用于网格函数 $\\{u_{i}\\}_{i=1}^{N}$ 的方式如下：\n$$\n\\left(Au\\right)_{i} \\;=\\; \\frac{1}{h^{2}}\\left(-\\sum_{m=-q}^{q}\\alpha_{m}\\,u_{i+m}\\right),\n$$\n并约定 $\\{1,\\dots,N\\}$ 之外的值由齐次狄利克雷边界条件消除。\n\n从这些定义以及带状矩阵和对称类托普利茨算子的离散正弦特征分析的基本性质出发，完成以下任务：\n\n1. 从可能非零对角线数量的意义上，推导矩阵 $A$ 的精确带宽 $b$。\n2. 使用在下半带宽和上半带宽均为 $q$ 的带状矩阵上进行高斯消元的第一性原理运算计数，量化无主元的 LU 分解的主阶算术复杂度，并将结果表示为关于 $N$ 和 $q$ 的闭式主项。\n3. 在狄利克雷网格上使用基于符号的特征值分析，建立谱条件数 $\\kappa(A)$ 关于 $N$、$q$ 和格式系数 $\\{\\alpha_{m}\\}$ 的渐近闭式表达式（当 $N\\to\\infty$ 时）。\n4. 分析对称正定带状矩阵 $A$ 的 Cholesky 分解产生的填充模式，并确定在原始带宽之外是否出现任何填充。此外，推导 Cholesky 因子 $L$ 中非零元总数的精确闭式表达式。\n\n将您的最终答案以一个单行矩阵的形式给出，其中依次包含：精确带宽 $b$、LU 浮点运算计数的主项 $F_{\\mathrm{LU}}(N,q)$、$\\kappa(A)$ 的渐近表达式、在 Cholesky 分解下原始带之外引入的填充非零元的数量，以及 Cholesky 因子 $L$ 中非零元的精确计数 $\\mathrm{nnz}(L)$。无需四舍五入。用 $N$、$\\pi$ 以及关于奇数索引格式系数 $\\alpha_m$ 的和来表示条件数。", "solution": "该问题要求分析在具有 $N$ 个内部点、网格间距 $h=1/(N+1)$ 和齐次狄利克雷边界条件的均匀网格上，由一维算子 $-u''$ 的通用 $(2q+1)$ 点有限差分离散所产生的矩阵 $A$。矩阵元素由作用 $(Au)_{i} = \\frac{1}{h^{2}}(-\\sum_{m=-q}^{q}\\alpha_{m}\\,u_{i+m})$ 定义，其中格式权重 $\\{\\alpha_m\\}$ 是对称的（$\\alpha_m = \\alpha_{-m}$）并满足至少二阶精度的相容性条件。\n\n**1. 矩阵 $A$ 的带宽**\n\n矩阵 $A$ 的元素 $A_{ij}$ 代表第 $i$ 个离散方程中未知数 $u_j$ 的系数。根据离散算子的定义，第 $i$ 个方程涉及项 $u_{i+m}$，其中 $m \\in \\{-q, -q+1, \\dots, q-1, q\\}$。因此，矩阵元素 $A_{ij}$ 仅当列索引 $j$ 的形式为 $i+m$（对于某个 $m \\in \\{-q, \\dots, q\\}$）时才可能非零。这等价于条件 $j-i \\in \\{-q, \\dots, q\\}$，或 $|i-j| \\le q$。\n\n矩阵的结构由此条件确定。非零元素被限制在主对角线周围的一个带内。\n下半带宽是 $A_{ij}$ 可能非零的 $i-j$ 的最大值，即 $q$。\n上半带宽是 $A_{ij}$ 可能非零的 $j-i$ 的最大值，也为 $q$。\n总带宽 $b$ 定义为潜在非零对角线的数量，是下半带宽、上半带宽和主对角线（$1$）之和。\n因此，带宽 $b$ 由下式给出：\n$$\nb = q (\\text{下}) + q (\\text{上}) + 1 (\\text{主}) = 2q+1\n$$\n齐次边界条件 $u_0 = u_{N+1} = 0$ 意味着对于靠近矩阵顶部（例如 $i=1$）和底部（例如 $i=N$）的行，这些潜在的非零项中有些会为零，但这并不改变矩阵的整体带宽，该带宽由非零对角线的最大范围决定。\n\n**2. LU 分解的复杂度**\n\n我们分析对 $N \\times N$ 带状矩阵 $A$ 执行无主元高斯消元的算术复杂度。该矩阵的下半带宽和上半带宽均为 $q$。该算法通过逐列消去次对角线元素来进行。\n\n在消元的第 $k$ 个一般步骤中（对于不太接近 $1$ 或 $N$ 的 $k$），我们消去 $i=k+1, \\dots, k+q$ 的 $q$ 个非零元素 $A_{ik}$。对于每个这样的元素，我们计算一个乘子 $L_{ik} = A_{ik} / A_{kk}$，然后更新行 $i$ 的其余部分。行 $k$ 中影响更新的非零元素是 $j=k+1, \\dots, k+q$ 的 $A_{kj}$。共有 $q$ 个这样的元素。\n更新操作为 $A_{ij} \\leftarrow A_{ij} - L_{ik} A_{kj}$，对于 $i=k+1, \\dots, k+q$ 和 $j=k+1, \\dots, k+q$。\n\n对于固定的列 $k$，工作量如下：\n- 对于从 $k+1$ 到 $k+q$ 的 $q$ 个行 $i$ 中的每一行：\n  - 一次除法来计算乘子 $L_{ik}$。\n  - 对于从 $k+1$ 到 $k+q$ 的 $q$ 个列 $j$ 中的每一列，执行一次乘法和一次减法来更新 $A_{ij}$。\n一次算术运算（“浮点运算”）通常被计为一次乘法/除法和一次加法/减法。更新步骤 $A_{ij} \\leftarrow A_{ij} - L_{ik} A_{kj}$ 构成一次浮点运算。\n更新行 $i$ 的成本约为 $q$ 次浮点运算。\n由于对于列 $k$ 有 $q$ 个这样的行需要更新，因此每列的总成本约为 $q \\times q = q^2$ 次乘法和 $q^2$ 次加法，即大约 $2q^2$ 次浮点运算。\n\n这个成本发生在每一列 $k=1, \\dots, N-1$。对所有列求和得到总复杂度。前 $q$ 列和后 $q$ 列的边界效应是低阶项。因此，总浮点运算次数 $F_{\\mathrm{LU}}(N,q)$ 的主阶项为：\n$$\nF_{\\mathrm{LU}}(N,q) \\approx \\sum_{k=1}^{N-1} 2q^2 \\approx 2Nq^2\n$$\n\n**3. 渐近谱条件数**\n\n谱条件数为 $\\kappa_2(A) = \\lambda_{\\max}(A) / \\lambda_{\\min}(A)$。由于矩阵 $A$ 是对称的，其特征值是实数。该问题意味着正定性。在具有齐次狄利克雷边界条件的网格上，离散算子的特征向量是离散正弦向量 $v^{(k)}$，其分量为 $v_j^{(k)} = \\sin(k\\pi j h)$，其中 $j=1, \\dots, N$。相应的特征值 $\\lambda_k$ 由下式给出：\n$$\n\\lambda_k = -\\frac{1}{h^2} \\sum_{m=-q}^{q}\\alpha_{m}\\cos(k\\pi m h), \\quad k=1, \\dots, N\n$$\n使用对称性 $\\alpha_{-m}=\\alpha_m$ 和相容性条件 $\\sum \\alpha_m = 0$，该表达式得以简化。\n$\\sum_{m=-q}^{q}\\alpha_{m}\\cos(k\\pi m h) = \\alpha_0 + 2\\sum_{m=1}^{q}\\alpha_m \\cos(k\\pi m h)$。\n由于 $\\alpha_0 = -2\\sum_{m=1}^{q}\\alpha_m$，我们得到：\n$\\lambda_k = -\\frac{1}{h^2} \\left(-2\\sum_{m=1}^{q}\\alpha_m + 2\\sum_{m=1}^{q}\\alpha_m \\cos(k\\pi m h)\\right) = \\frac{2}{h^2}\\sum_{m=1}^{q}\\alpha_m(1 - \\cos(k\\pi m h))$。\n使用恒等式 $1-\\cos(x) = 2\\sin^2(x/2)$，特征值为：\n$$\n\\lambda_k = \\frac{4}{h^2} \\sum_{m=1}^{q} \\alpha_m \\sin^2\\left(\\frac{k\\pi mh}{2}\\right)\n$$\n对于最小特征值 $\\lambda_1$，我们有 $k=1$。当 $N \\to \\infty$ 时，$h=1/(N+1) \\to 0$。对于小自变量 $x$，$\\sin(x) \\approx x$。\n$$\n\\lambda_1 \\approx \\frac{4}{h^2} \\sum_{m=1}^{q} \\alpha_m \\left(\\frac{\\pi mh}{2}\\right)^2 = \\frac{\\pi^2}{h^2} \\sum_{m=1}^{q} \\alpha_m m^2 h^2 = \\pi^2 \\sum_{m=1}^{q} m^2\\alpha_m\n$$\n相容性条件 $\\sum_{m=-q}^{q}m^2\\alpha_m = 2$ 意味着 $2\\sum_{m=1}^{q} m^2\\alpha_m=2$，所以 $\\sum_{m=1}^{q} m^2\\alpha_m=1$。\n因此，当 $N \\to \\infty$ 时，$\\lambda_1 \\to \\pi^2$。\n\n对于最大特征值 $\\lambda_N$，我们有 $k=N$。正弦函数的自变量是 $\\frac{N\\pi mh}{2} = \\frac{N}{N+1}\\frac{m\\pi}{2} = (1-h)\\frac{m\\pi}{2}$。当 $h \\to 0$ 时，该自变量趋近于 $\\frac{m\\pi}{2}$。\n$$\n\\lambda_N = \\frac{4}{h^2} \\sum_{m=1}^{q} \\alpha_m \\sin^2\\left(\\frac{N\\pi mh}{2}\\right) \\approx \\frac{4}{h^2} \\sum_{m=1}^{q} \\alpha_m \\sin^2\\left(\\frac{m\\pi}{2}\\right)\n$$\n当 $m$ 为奇数时，$\\sin^2(m\\pi/2)$ 等于 $1$，当 $m$ 为偶数时等于 $0$。\n所以，$\\lambda_N \\approx \\frac{4}{h^2} \\sum_{m=1, m \\text{ odd}}^{q} \\alpha_m$。\n\n渐近条件数是比值 $\\lambda_N/\\lambda_1$：\n$$\n\\kappa(A) \\approx \\frac{\\frac{4}{h^2} \\sum_{m=1, m \\text{ odd}}^{q} \\alpha_m}{\\pi^2} = \\frac{4(N+1)^2}{\\pi^2} \\sum_{m=1, m \\text{ odd}}^{q} \\alpha_m\n$$\n关于 $N$ 的主阶项是：\n$$\n\\kappa(A) \\approx \\frac{4N^2}{\\pi^2} \\sum_{m=1, m \\text{ odd}}^{q} \\alpha_m\n$$\n\n**4. Cholesky 分解的填充**\n\n矩阵 $A$ 是对称正定的（因为其特征值均为正）。因此，它允许唯一的 Cholesky 分解 $A = LL^T$，其中 $L$ 是一个下三角矩阵。数值线性代数的一个基本定理指出，对于带状对称正定矩阵，其 Cholesky 因子保留了原始矩阵的带状结构。具体来说，如果对于 $i-j>q$ 有 $A_{ij}=0$，那么 Cholesky 因子 $L$ 也将对于 $i-j>q$ 有 $L_{ij}=0$。这意味着在原始下三角带之外**没有填充**。在由半带宽 $q$ 定义的带之外创建的非零元素数量恰好为 $0$。\n\n我们现在计算 Cholesky 因子 $L$ 中非零元的总数 $\\mathrm{nnz}(L)$。由于 $L$ 是下三角矩阵且下半带宽为 $q$，其非零项 $L_{ij}$ 被限制在 $0 \\le i-j \\le q$ 的索引处。\n\n我们可以逐行计算非零元。对于行 $i$（其中 $i=1, \\dots, N$），非零项 $L_{ij}$ 只能在满足 $j \\le i$ 和 $i-j \\le q$ 的列索引 $j$ 处出现，这等价于 $j \\ge i-q$。同时，我们必须有 $j \\ge 1$。所以，对于行 $i$，非零项位于列 $j$ 处，其中 $\\max(1, i-q) \\le j \\le i$。\n行 $i$ 中的非零元数量是 $i - \\max(1, i-q) + 1$。\n\n- 对于 $1 \\le i \\le q$：非零元数量为 $i - 1 + 1 = i$。\n- 对于 $q+1 \\le i \\le N$：非零元数量为 $i - (i-q) + 1 = q+1$。\n\n非零元的总数是所有行的总和：\n$$\n\\mathrm{nnz}(L) = \\sum_{i=1}^{q} i + \\sum_{i=q+1}^{N} (q+1)\n$$\n第一个和是前 $q$ 个整数的和，即 $\\frac{q(q+1)}{2}$。第二个和有 $(N - (q+1) + 1) = N-q$ 项，每一项都等于 $q+1$，所以其值为 $(N-q)(q+1)$。\n$$\n\\mathrm{nnz}(L) = \\frac{q(q+1)}{2} + (N-q)(q+1) = (q+1)\\left(\\frac{q}{2} + N - q\\right) = (q+1)\\left(N - \\frac{q}{2}\\right)\n$$\n这简化为精确的闭式表达式：\n$$\n\\mathrm{nnz}(L) = N(q+1) - \\frac{q(q+1)}{2}\n$$\n\n**最终答案总结**\n所要求的五个量是：\n1.  带宽 $b = 2q+1$。\n2.  LU 浮点运算计数的主项 $F_{\\mathrm{LU}}(N,q) = 2Nq^2$。\n3.  渐近条件数 $\\kappa(A) = \\frac{4N^2}{\\pi^2} \\sum_{m=1, m \\text{ odd}}^q \\alpha_m$。\n4.  带外的填充非零元数量 = $0$。\n5.  $L$ 中非零元的精确数量 $\\mathrm{nnz}(L) = N(q+1) - \\frac{q(q+1)}{2}$。", "answer": "$$\n\\boxed{\\begin{pmatrix} 2q+1 & 2Nq^{2} & \\frac{4N^{2}}{\\pi^{2}}\\sum_{\\substack{m=1 \\\\ m \\text{ odd}}}^{q} \\alpha_{m} & 0 & N(q+1) - \\frac{q(q+1)}{2} \\end{pmatrix}}\n$$", "id": "3445518"}, {"introduction": "尽管带状结构在理论上能高效求解，但数值稳定性要求往往需要进行主元选择，这可能破坏原有的稀疏性。本练习通过一个精心构造的例子，揭示了一个关键且非直观的概念：部分主元法可能在原始带宽之外引入“填充”（fill-in）。[@problem_id:3558093] 理解这一现象有助于我们认识在稀疏数值线性代数中，数值稳定性与稀疏性保持之间的实际权衡。", "problem": "考虑一个方形稀疏矩阵 $A \\in \\mathbb{R}^{n \\times n}$ 及其采用部分主元法的分解，该分解计算一个置换矩阵 $P \\in \\mathbb{R}^{n \\times n}$ 以及三角矩阵 $L \\in \\mathbb{R}^{n \\times n}$ 和 $U \\in \\mathbb{R}^{n \\times n}$，使得 $P A = L U$，其中 $L$ 是单位下三角矩阵，$U$ 是上三角矩阵。在使用部分主元法（在每一列中，从当前主元行及其下方的行中选择绝对值最大的元素作为主元）的高斯消元（GE）背景下，从业者观察到，在矩阵 $P A$ 中为零的位置上，可能会在 $L$ 和 $U$ 中产生非零元。这种现象被称为“填充”（fill-in），它与消元过程中行更新的模式并集性质密切相关：当通过 $j \\leftarrow j - \\ell\\, i$ 更新行 $j$ 时，更新后行 $j$ 的非零模式包含在更新前行 $j$ 和行 $i$ 的模式并集之内，而在行 $j$ 先前为零的位置上出现的新非零元即为填充。\n\n选择所有正确描述了填充现象，并通过一个显式构造正确展示了即使当 $A$ 最初是带状稀疏矩阵时，部分主元法也可能增加 $L$ 和 $U$ 中填充的选项。\n\n选项：\n\nA. 对于分解 $P A = L U$（其中置换矩阵 $P$ 由主元策略确定），$L$ 和 $U$ 中的填充是指满足 $(P A)_{i j} = 0$ 但 $L_{i j} \\neq 0$（对于 $L$ 的严格下三角部分的 $i > j$）或 $U_{i j} \\neq 0$（对于 $i \\leq j$）的索引对 $(i,j)$ 的集合，即在 $P A$ 中为零但在计算出的因子中变为非零的位置（不包括 $L$ 的单位对角线）。\n\nB. 如果 $A$ 是一个半带宽为 $b \\in \\mathbb{N}$ 的带状矩阵（即只要 $|i - j| > b$ 就有 $A_{i j} = 0$），那么无论数据值如何，总可以执行带部分主元的高斯消元，使得在原始带宽 $b$ 之外不产生填充，因此 $L$ 和 $U$ 保持为半带宽至多为 $b$ 的带状矩阵。\n\nC. 设 $A \\in \\mathbb{R}^{6 \\times 6}$ 是由下式给出的五对角矩阵（半带宽为2）：\n$$\nA \\;=\\;\n\\begin{bmatrix}\n1  0.1  0  0  0  0 \\\\\n1  0  1  0  0  0 \\\\\n1  0.5  1  0  0  0 \\\\\n0  2  1  1  0  1 \\\\\n0  0  1  0  1  0 \\\\\n0  0  0  1  0  1\n\\end{bmatrix}.\n$$\n在第一步消元（第1列）中，主元位于 $(1,1)$，对第2行和第3行进行更新。在第二步消元（第2列）中，部分主元法选择第4行的元素作为主元（因为 $|A_{4,2}| = 2$ 的绝对值大于 $|A_{2,2}|$ 和 $|A_{3,2}|$），交换第2行和第4行。然后，消去变为第3行的那一列中第2列的元素，在更新后的舒尔补（因此在 $U$ 中）的位置 $(3,6)$ 引入了一个新的非零元，尽管 $(P A)_{3,6} = 0$。因此，对于这个带状稀疏矩阵 $A$，部分主元法相对于不使用主元法时增加了填充。\n\nD. 对于任何三对角矩阵 $A \\in \\mathbb{R}^{4 \\times 4}$，采用部分主元的高斯消元必须在 $U$ 的 $(3,4)$ 位置创建一个在 $A$ 中为零的元素（即 $(P A)_{3,4} = 0$ 意味着 $U_{3,4} \\neq 0$），因此部分主元法在三对角矩阵上总是比不使用主元的高斯消元产生更多的填充。\n\n选择所有正确的选项。", "solution": "### 逐项分析选项\n\n**选项 A**\n\n该选项为 $PA=LU$ 分解定义了填充。它指出，填充是索引对 $(i,j)$ 的集合，使得 $(P A)_{i j} = 0$，但 $L_{i j} \\neq 0$（对于 $L$ 的严格下三角部分的 $i > j$）或 $U_{i j} \\neq 0$（对于 $i \\leq j$）。这个定义准确地抓住了这一概念。高斯消元算法实际上将初始矩阵 $PA$ 转换为 $U$，而消元步骤中使用的乘子填充了 $L$ 的严格下三角部分。在 $L$ 或 $U$ 中，任何出现在初始矩阵 $PA$ 中为零的位置上的非零元，根据定义，都是一个填充元素。排除 $L$ 的单位对角线是正确的，因为这些元素是根据定义设置为1，而不是通过 $PA$ 的元素计算得出的。这个定义在数值线性代数文献中是标准的。\n\n*结论*：**正确**。\n\n**选项 B**\n\n该选项声称，对于一个半带宽为 $b$ 的带状矩阵 $A$，总可以执行带部分主元的高斯消元，使得因子 $L$ 和 $U$ 保持半带宽至多为 $b$ 的带状结构。这是一个很强的、普遍性的断言，而已知其是错误的。部分主元法可以将行 $k > i$ 交换到主元位置 $i$。如果原始行 $k$ 在远离对角线的位置有非零元（例如，在列 $j$ 处，其中 $|k-j| \\le b$ 但 $|i-j| > b$），其稀疏模式会被带到行 $i$。在消元过程中，这可能会在其他行中引入远在原始带宽之外的非零元。例如，$U$ 的带宽可以增长到接近 $2b$。可以构建一个简单的例子，其中一列下方较远位置的元素很大，迫使进行行交换，从而加宽了活动子矩阵的带宽。选项 C 中的例子就是这个断言的一个明确反例。\n\n*结论*：**不正确**。\n\n**选项 C**\n\n该选项给出了一个特定的 $6 \\times 6$ 矩阵 $A$，并逐步演示了带部分主元的高斯消元的前两个步骤，以证明填充的增加。让我们验证这些步骤。\n\n矩阵是 $A = \\begin{bmatrix} 1  0.1  0  0  0  0 \\\\ 1  0  1  0  0  0 \\\\ 1  0.5  1  0  0  0 \\\\ 0  2  1  1  0  1 \\\\ 0  0  1  0  1  0 \\\\ 0  0  0  1  0  1 \\end{bmatrix}$。半带宽为 $b=2$。\n\n步骤1（第1列）：第1列中可能的主元有 $A_{1,1}=1$，$A_{2,1}=1$，$A_{3,1}=1$。选择 $A_{1,1}$ 作为主元是一个有效的部分主元选择（例如，通过选择最小的行索引来打破僵局）。不需要行交换，所以 $P_1 = I$。\n乘数为 $m_{21} = 1/1=1$ 和 $m_{31}=1/1=1$。\n$R_2 \\leftarrow R_2 - 1 \\cdot R_1 = (0, -0.1, 1, 0, 0, 0)$。\n$R_3 \\leftarrow R_3 - 1 \\cdot R_1 = (0, 0.4, 1, 0, 0, 0)$。\n矩阵变为 $A^{(1)} = \\begin{bmatrix} 1  0.1  0  0  0  0 \\\\ 0  -0.1  1  0  0  0 \\\\ 0  0.4  1  0  0  0 \\\\ 0  2  1  1  0  1 \\\\ 0  0  1  0  1  0 \\\\ 0  0  0  1  0  1 \\end{bmatrix}$。\n\n步骤2（第2列）：我们检查第2列对角线及其下方的元素（从第2行开始）。这些元素是 $A^{(1)}_{2,2}=-0.1$，$A^{(1)}_{3,2}=0.4$ 和 $A^{(1)}_{4,2}=2$。绝对值最大的是 $A^{(1)}_{4,2}=2$。因此，我们必须交换第2行和第4行。\n置换矩阵 $P$ 将记录这次交换。正在处理的矩阵现在（交换后）实际上是：\n$\\begin{bmatrix} 1  0.1  0  0  0  0 \\\\ 0  2  1  1  0  1 \\\\ 0  0.4  1  0  0  0 \\\\ 0  -0.1  1  0  0  0 \\\\ \\vdots      \\end{bmatrix}$。新的主元行是原始的第4行。\n\n对于第3行（未被交换），乘数为 $m_{32} = 0.4/2 = 0.2$。\n第3行的更新为：$R_3 \\leftarrow R_3 - 0.2 \\cdot (\\text{新的 } R_2) = (0, 0.4, 1, 0, 0, 0) - 0.2 \\cdot (0, 2, 1, 1, 0, 1) = (0, 0, 0.8, -0.2, 0, -0.2)$。\n更新后矩阵中 $(3,6)$ 位置的元素现在是 $-0.2$。这将是最终 $U$ 矩阵中的一个元素，所以 $U_{3,6} = -0.2$。\n\n我们来检查初始状态。置换矩阵 $P$ 交换了第2行和第4行。因此，$(PA)_{3,6}$ 是来自 $A$ 的第3行的元素（因为第3行未被置换），即 $A_{3,6}=0$。\n由于 $(PA)_{3,6}=0$ 且相应的元素 $U_{3,6}$ 变为 $-0.2$，因此在位置 $(3,6)$ 发生了填充。这是因为主元行（原始的第4行）有一个非零元素 $A_{4,6}=1$，其模式在更新过程中被传递到了第3行。\n注意 $|3-6|=3$，大于原始半带宽 $b=2$，这表明填充发生在了带宽之外。如果不进行主元选择，主元将是 $-0.1$，对第3行的更新将只涉及第2行，而第2行在第6列没有非零元。在 $(3,6)$ 位置就不会发生填充。逻辑和计算都是合理的。\n\n*结论*：**正确**。\n\n**选项 D**\n\n该选项做出了一个普遍性断言：“对于任何三对角矩阵 $A \\in \\mathbb{R}^{4 \\times 4}$，采用部分主元的高斯消元必须在 $U$ 的 $(3,4)$ 位置创建一个在 $A$ 中为零的元素”。括号中的部分将其澄清为“ $(P A)_{3,4} = 0$ 意味着 $U_{3,4} \\neq 0$ ”。这个断言是错误的。考虑一个反例。\n设 $A$ 是一个严格对角占优的三对角矩阵，例如：\n$$ A = \\begin{bmatrix} 4  1  0  0 \\\\ 1  4  1  0 \\\\ 0  1  4  1 \\\\ 0  0  1  4 \\end{bmatrix} $$\n对于一个严格对角占优矩阵，对角线元素总是其所在列中绝对值最大的元素，所以部分主元法永远不会执行行交换。因此，$P=I$。分解过程无需主元选择。对三对角矩阵进行不带主元选择的高斯消元不会产生任何填充。因子 $L$ 和 $U$ 是双对角矩阵。\n$U$ 矩阵将具有与 $A$ 相同的上三角稀疏模式。特别地，如果 $A_{3,4} = 1 \\neq 0$，则 $U_{3,4}$ 也将是非零的。如果考虑一个 $A_{3,4} = 0$ 的例子：\n$$ A = \\begin{bmatrix} 4  1  0  0 \\\\ 1  4  1  0 \\\\ 0  1  4  0 \\\\ 0  0  1  4 \\end{bmatrix} $$\n这里，$A_{3,4}=0$。由于它是对角占优的，$P=I$，并且 $(PA)_{3,4}=0$。执行高斯消元，我们会发现 $U$ 在位置 $(3,4)$ 也将是零。所以 $U_{3,4}=0$。这与“$(PA)_{3,4}=0$ 意味着 $U_{3,4} \\neq 0$”的断言相矛盾。因此该陈述是错误的。该断言的第二部分，即主元法“总是比不使用主元的高斯消元产生更多的填充”，也是错误的，正如严格对角占优的情况所示，其中主元法和非主元法是相同的，并且不产生填充。\n\n*结论*：**不正确**。", "answer": "$$\\boxed{AC}$$", "id": "3558093"}, {"introduction": "当转向迭代法时，核心计算变为稀疏矩阵向量乘法（SpMV），其性能高度依赖于数据存储格式。本练习要求您建立一个基于内存流量的性能模型，以比较通用带状（GB）和压缩稀疏行（CSR）两种存储格式的效率。[@problem_id:3445522] 通过确定性能超越的“收支平衡点”，您将学会如何将抽象的数据结构理论与具体的硬件性能考量联系起来，这是计算科学中的一项关键技能。", "problem": "考虑一个由结构化网格上的偏微分方程（PDE）离散化产生的线性系统，该系统产生一个半带宽为 $b$ 的 $n \\times n$ 稀疏矩阵，这意味着元素 $a_{ij}$ 仅在 $\\lvert i - j \\rvert \\leq b$ 时非零。假设所有浮点值均为双精度（$8$ 字节），索引为 $32$ 位整数（$4$ 字节）。您将比较两种用于执行稀疏矩阵向量乘积 (SpMV) $y \\leftarrow A x$ 的存储和乘法策略：Basic Linear Algebra Subprograms (BLAS) 带状例程使用的通用带状 (GB) 存储格式，以及压缩稀疏行 (CSR) 格式。您必须对内存流量进行真实建模，并预测在一个内存带宽主导的运行时模型下，基于 GB 的 SpMV 比基于 CSR 的 SpMV 更快的盈亏平衡点。\n\n定义与假设：\n- 令带状矩阵中的非零元素数量为 $\\,\\mathrm{nnz}(n,b)\\,$。对于 $b \\leq n-1$，一个关于带状矩阵的经过充分检验的事实给出\n$$\n\\mathrm{nnz}(n,b) = (2b+1)\\,n - b(b+1),\n$$\n这考虑了边界附近非零元素数量的减少。对于 $b \\geq n-1$，矩阵是稠密的，$\\mathrm{nnz}(n,b) = n^2$。在本问题中，限定 $b \\in \\{0,1,\\dots,n-1\\}$，并使用上述公式计算 $\\mathrm{nnz}(n,b)$。\n- 在通用带状存储中，SpMV 期间不读取显式的列索引。内存流量包括读取带状值、输入向量 $x$ 的必要段，以及写入输出向量 $y$。\n- 在压缩稀疏行存储中，内存流量包括读取矩阵值、读取列索引、读取行指针整数、通过间接寻址读取输入向量 $x$ 的元素，以及写入 $y$。\n- 令 $W$ 为持续内存带宽，单位为字节/秒，假设在操作期间为常数；在带宽受限的情况下，将运行时间建模为一个与数据相关的项（移动的字节数除以 $W$）和一个固定的每次调用延迟之和。令 $L_{\\mathrm{GB}}$ 和 $L_{\\mathrm{CSR}}$ 分别为 GB 和 CSR 实现的固定延迟（单位为秒）。\n- 将 $x$ 向量的加载建模如下：\n  1. 对于 GB SpMV，由于对长度为 $2b+1$ 的滑动窗口进行连续访问，假设每次 SpMV 平均加载 $n + 2b$ 个唯一的双精度数 $x$。\n  2. 对于 CSR SpMV，假设唯一的 $x$ 加载量为 $n + 2b$ 再加上一个与非对角线引用数量成正比的额外惩罚，这代表了由间接寻址导致的硬件预取不完善和缓存效应。令 $\\gamma \\in [0,1]$ 为比例常数，并将唯一的 $x$ 加载建模为 $n + 2b + \\gamma\\,(\\mathrm{nnz}(n,b) - n)$ 个双精度数。\n- CSR 中的行指针开销包括每次 SpMV 读取 $n+1$ 个整数，这包含在移动的字节数中。\n- 对于 GB 和 CSR，写入输出向量 $y$ 的成本均为 $n$ 次双精度数写入。\n\n每次 SpMV 的内存流量模型：\n- GB 移动的字节数：\n$$\n\\mathrm{bytes}_{\\mathrm{GB}}(n,b) = 8\\,\\mathrm{nnz}(n,b) + 8\\,(n + 2b) + 8\\,n.\n$$\n- CSR 移动的字节数：\n$$\n\\mathrm{bytes}_{\\mathrm{CSR}}(n,b,\\gamma) = 8\\,\\mathrm{nnz}(n,b) + 4\\,\\mathrm{nnz}(n,b) + 4\\,(n+1) + 8\\,(n + 2b + \\gamma\\,(\\mathrm{nnz}(n,b) - n)) + 8\\,n.\n$$\n\n每次 SpMV 的运行时间模型：\n- GB 时间：\n$$\nT_{\\mathrm{GB}}(n,b) = \\frac{\\mathrm{bytes}_{\\mathrm{GB}}(n,b)}{W} + L_{\\mathrm{GB}}.\n$$\n- CSR 时间：\n$$\nT_{\\mathrm{CSR}}(n,b,\\gamma) = \\frac{\\mathrm{bytes}_{\\mathrm{CSR}}(n,b,\\gamma)}{W} + L_{\\mathrm{CSR}}.\n$$\n\n盈亏平衡点定义：\n- 将盈亏平衡半带宽 $b^\\star$（一个整数）定义为满足 $T_{\\mathrm{GB}}(n,b)  T_{\\mathrm{CSR}}(n,b,\\gamma)$ 的最小 $b \\in \\{0,1,\\dots,n-1\\}$。如果在此范围内不存在这样的 $b$，则设 $b^\\star = -1$。\n\n任务：\n- 实现一个程序，对于每个测试用例，计算：\n  1. 一个布尔值，指示对于给定的 $b$，是否有 $T_{\\mathrm{GB}}(n,b)  T_{\\mathrm{CSR}}(n,b,\\gamma)$。\n  2. 上述定义的盈亏平衡点 $b^\\star$。\n- 你的程序必须使用上述内存流量和运行时间模型，所有量纲单位保持一致。带宽 $W$ 的单位是字节/秒，延迟 $L_{\\mathrm{GB}}$ 和 $L_{\\mathrm{CSR}}$ 的单位是秒；除了这些定义，输出不需要任何物理单位。\n\n测试套件：\n- 使用以下参数集，每个参数集指定为 $(n, b, W, L_{\\mathrm{GB}}, L_{\\mathrm{CSR}}, \\gamma)$：\n  1. $(500000, 8, 8.0\\times 10^{10}, 3.0\\times 10^{-6}, 1.0\\times 10^{-6}, 0.10)$\n  2. $(100000, 1, 5.0\\times 10^{10}, 4.0\\times 10^{-6}, 1.0\\times 10^{-6}, 0.00)$\n  3. $(200000, 50, 1.0\\times 10^{10}, 3.0\\times 10^{-6}, 1.0\\times 10^{-6}, 0.30)$\n  4. $(2000, 500, 4.0\\times 10^{10}, 2.0\\times 10^{-6}, 1.0\\times 10^{-6}, 0.10)$\n\n最终输出格式：\n- 你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，其中每个结果对应一个测试用例，并且是一个形式为 $[\\mathrm{boolean}, b^\\star]$ 的双元素列表。例如，打印的输出必须如下所示：\n- \"[[true_or_false,b_star_for_case1],[true_or_false,b_star_for_case2],[true_or_false,b_star_for_case3],[true_or_false,b_star_for_case4]]\"", "solution": "**1. 建立性能比较模型**\n\n我们的目标是找到使通用带状 (GB) 格式的 SpMV 运行时间 $T_{\\mathrm{GB}}$ 小于压缩稀疏行 (CSR) 格式的运行时间 $T_{\\mathrm{CSR}}$ 的最小半带宽 $b$。该条件可以表示为：\n$$ T_{\\mathrm{GB}}(n,b)  T_{\\mathrm{CSR}}(n,b,\\gamma) $$\n将运行时间模型代入，我们得到：\n$$ \\frac{\\mathrm{bytes}_{\\mathrm{GB}}(n,b)}{W} + L_{\\mathrm{GB}}  \\frac{\\mathrm{bytes}_{\\mathrm{CSR}}(n,b,\\gamma)}{W} + L_{\\mathrm{CSR}} $$\n重新整理不等式，我们将问题转化为分析运行时间差 $F(n, b, \\gamma) = T_{\\mathrm{CSR}}(n,b,\\gamma) - T_{\\mathrm{GB}}(n,b)$ 何时为正：\n$$ F(n, b, \\gamma) = \\frac{\\mathrm{bytes}_{\\mathrm{CSR}}(n,b,\\gamma) - \\mathrm{bytes}_{\\mathrm{GB}}(n,b)}{W} + (L_{\\mathrm{CSR}} - L_{\\mathrm{GB}}) > 0 $$\n\n**2. 分析内存流量差异**\n\n我们首先计算 CSR 相对于 GB 的额外内存流量 $\\Delta_{\\mathrm{bytes}} = \\mathrm{bytes}_{\\mathrm{CSR}} - \\mathrm{bytes}_{\\mathrm{GB}}$。根据问题定义，这个差异来源于 CSR 需要额外存储和读取：(1) 每个非零元素的列索引，(2) 行指针数组，以及 (3) 间接寻址输入向量 $x$ 造成的额外开销。\n$$ \\Delta_{\\mathrm{bytes}}(n,b,\\gamma) = \\underbrace{4\\,\\mathrm{nnz}(n,b)}_{\\text{列索引}} + \\underbrace{4\\,(n+1)}_{\\text{行指针}} + \\underbrace{8\\,\\gamma\\,(\\mathrm{nnz}(n,b) - n)}_{\\text{x 向量额外开销}} $$\n将各项按 $\\mathrm{nnz}(n,b)$ 和 $n$ 重新组合，得到：\n$$ \\Delta_{\\mathrm{bytes}}(n,b,\\gamma) = (4 + 8\\gamma)\\mathrm{nnz}(n,b) + (4 - 8\\gamma)n + 4 $$\n\n**3. 分析函数的单调性**\n\n为了高效地找到盈亏平衡点，我们分析函数 $F(n, b, \\gamma)$ 如何随 $b$ 变化。$F$ 是 $\\mathrm{nnz}(n,b)$ 的线性函数。我们来考察 $\\mathrm{nnz}(n,b)$ 作为 $b$ 的函数在定义域 $b \\in \\{0, 1, \\dots, n-1\\}$ 内的性质：\n$$ \\mathrm{nnz}(n,b) = (2b+1)n - b(b+1) = -b^2 + (2n-1)b + n $$\n这是一个开口向下的关于 $b$ 的二次函数。其导数为 $\\frac{d}{db}\\mathrm{nnz}(n,b) = 2n-1 - 2b$。在区间 $b \\in [0, n-1]$ 内，该导数始终为正（$2n-1-2b \\ge 2n-1-2(n-1) = 1 > 0$）。因此，$\\mathrm{nnz}(n,b)$ 是 $b$ 的严格单调递增函数。\n\n由于 $F(n, b, \\gamma)$ 的表达式中 $\\mathrm{nnz}(n,b)$ 的系数 $\\frac{4+8\\gamma}{W}$ 是正的（因为 $W>0$ 且 $\\gamma \\ge 0$），所以 $F(n, b, \\gamma)$ 也是 $b$ 在区间 $[0, n-1]$ 上的严格单调递增函数。\n\n**4. 求解算法**\n\n函数的单调性是关键。如果对于某个 $b_0$，GB 格式更快（即 $F(n, b_0, \\gamma) > 0$），那么对于所有 $b > b_0$，GB 格式将更快。这使得我们可以通过高效的搜索算法找到盈亏平衡点 $b^\\star$：\n\n1.  **检查边界情况**:\n    - 计算 $F(n, 0, \\gamma)$。如果结果大于 0，说明即使对于最稀疏的情况（对角矩阵），GB 也更快，因此 $b^\\star = 0$。\n    - 如果 $F(n, 0, \\gamma) \\le 0$，则检查另一边界 $F(n, n-1, \\gamma)$。如果此值也小于等于 0，则根据单调性，对于所有 $b \\in [0, n-1]$，GB 都不比 CSR 快，因此 $b^\\star = -1$。\n\n2.  **二分搜索**: 如果 $F(n, 0, \\gamma) \\le 0$ 且 $F(n, n-1, \\gamma) > 0$，我们知道在区间 $[1, n-1]$ 内存在唯一的整数 $b^\\star$。我们可以使用二分搜索来找到满足 $F(n, b, \\gamma) > 0$ 的最小整数 $b$。搜索过程在对数时间复杂度 $O(\\log n)$ 内收敛，非常高效。\n\n基于此算法，对每个测试用例进行计算，即可得到所需的布尔值和盈亏平衡点 $b^\\star$。", "answer": "[[true,0],[true,0],[true,0],[true,2]]", "id": "3445522"}]}