{"hands_on_practices": [{"introduction": "这项实践是冯·诺伊曼分析的基础起点。我们将分析简单的一阶单边差分算子$D_+$和$D_-$，以推导它们的傅里叶符号。这个练习展示了冯·诺伊曼分析如何将差分算子转换为傅里叶空间中的代数表达式，从而揭示其固有的耗散和频散特性，并为至关重要的迎风（upwinding）概念奠定基础。[@problem_id:3461944]", "problem": "考虑一个标量场$u_{j}(t)$在均匀网格$x_{j} = j\\,\\Delta x$上的线性、移位不变的空间离散化，该离散化近似于空间导数算子$\\partial_{x}$。两个单边有限差分算子定义为$D_{+} u_{j} = \\left(u_{j+1} - u_{j}\\right)/\\Delta x$和$D_{-} u_{j} = \\left(u_{j} - u_{j-1}\\right)/\\Delta x$。利用 von Neumann 稳定性分析（VNSA）的基本思想，即离散傅里叶模$v_{j}(\\theta) = \\exp\\!\\left(i j \\theta\\right)$可以对角化线性、移位不变的差分算子，推导傅里叶符号$\\widehat{D_{+}}(\\theta)$和$\\widehat{D_{-}}(\\theta)$，使得$D_{\\pm} v_{j}(\\theta) = \\widehat{D_{\\pm}}(\\theta)\\, v_{j}(\\theta)$。\n\n然后，考虑常系数线性平流方程$\\partial_{t} u + a\\,\\partial_{x} u = 0$的半离散近似$\\partial_{t} u_{j}(t) + a\\, D u_{j}(t) = 0$，其中$a \\in \\mathbb{R}$是平流速度，而$D$是$D_{+}$或$D_{-}$。利用复值的傅里叶符号，区分数值耗散（由符号的实部控制）和数值色散（由符号的虚部控制），并解释对于何种符号的$a$，选择$D_{+}$或$D_{-}$会产生稳定的、耗散的平流。此外，确定在使用稳定时，与$D_{+}$或$D_{-}$相关联的相速度，对于波数$0  \\theta  \\pi$，是高估还是低估了精确相速度。\n\n请以闭合形式提供傅里叶符号对$\\widehat{D_{+}}(\\theta)$和$\\widehat{D_{-}}(\\theta)$作为您的最终答案。最终答案无需数值四舍五入，也无需报告物理单位。", "solution": "用户提供了一个问题，要求在线性平流方程的背景下，推导并分析单边有限差分算子的傅里叶符号。\n\n### 步骤 1：提取已知条件\n-   均匀空间网格：$x_{j} = j\\,\\Delta x$\n-   网格上的标量场：$u_{j}(t)$\n-   前向差分算子：$D_{+} u_{j} = \\frac{u_{j+1} - u_{j}}{\\Delta x}$\n-   后向差分算子：$D_{-} u_{j} = \\frac{u_{j} - u_{j-1}}{\\Delta x}$\n-   离散傅里叶模：$v_{j}(\\theta) = \\exp(i j \\theta)$\n-   傅里叶符号的特征值定义：$D_{\\pm} v_{j}(\\theta) = \\widehat{D_{\\pm}}(\\theta)\\, v_{j}(\\theta)$\n-   线性平流方程：$\\partial_{t} u + a\\,\\partial_{x} u = 0$，其中$a \\in \\mathbb{R}$是常数平流速度。\n-   半离散近似：$\\partial_{t} u_{j}(t) + a\\, D u_{j}(t) = 0$，其中$D$是$D_{+}$或$D_{-}$。\n-   波数的分析域：$0  \\theta  \\pi$。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题在科学上和数学上是合理的。它提出了一个偏微分方程数值分析领域的标准、典型问题。有限差分算子的定义、离散傅里叶模的使用以及半离散平流方程的构建都是标准的。问题是自洽的，提供了所有必要的定义和方程。所提问题精确、适定，并能通过已建立的数学程序得到唯一、可验证的解。问题是客观的，没有歧义或事实错误。\n\n### 步骤 3：结论与行动\n该问题被视为 **有效**。将提供完整解答。\n\n### 解题推导\n\n主要任务是推导傅里叶符号$\\widehat{D_{+}}(\\theta)$和$\\widehat{D_{-}}(\\theta)$，并分析它们在离散化线性平流方程时所表现出的性质。\n\n#### 第 1 部分：傅里叶符号的推导\n\n线性、移位不变差分算子$D$的傅里叶符号$\\widehat{D}(\\theta)$是其对应于离散傅里叶本征函数$v_{j}(\\theta) = \\exp(i j \\theta)$的特征值，其中$\\theta = k \\Delta x$是无量纲波数，$k$是物理波数。\n\n对于前向差分算子$D_{+}$，我们将其应用于$v_{j}(\\theta)$：\n$$\nD_{+} v_{j}(\\theta) = \\frac{v_{j+1}(\\theta) - v_{j}(\\theta)}{\\Delta x} = \\frac{\\exp(i (j+1) \\theta) - \\exp(i j \\theta)}{\\Delta x}\n$$\n提出公因子$\\exp(i j \\theta) = v_{j}(\\theta)$：\n$$\nD_{+} v_{j}(\\theta) = \\frac{\\exp(i j \\theta) (\\exp(i \\theta) - 1)}{\\Delta x} = \\left(\\frac{\\exp(i \\theta) - 1}{\\Delta x}\\right) v_{j}(\\theta)\n$$\n通过与定义$D_{+} v_{j}(\\theta) = \\widehat{D_{+}}(\\theta) v_{j}(\\theta)$比较，我们确定$D_{+}$的傅里叶符号为：\n$$\n\\widehat{D_{+}}(\\theta) = \\frac{\\exp(i \\theta) - 1}{\\Delta x}\n$$\n对于后向差分算子$D_{-}$，我们执行相同的步骤：\n$$\nD_{-} v_{j}(\\theta) = \\frac{v_{j}(\\theta) - v_{j-1}(\\theta)}{\\Delta x} = \\frac{\\exp(i j \\theta) - \\exp(i (j-1) \\theta)}{\\Delta x}\n$$\n提出公因子$\\exp(i j \\theta) = v_{j}(\\theta)$：\n$$\nD_{-} v_{j}(\\theta) = \\frac{\\exp(i j \\theta) (1 - \\exp(-i \\theta))}{\\Delta x} = \\left(\\frac{1 - \\exp(-i \\theta)}{\\Delta x}\\right) v_{j}(\\theta)\n$$\n因此，$D_{-}$的傅里叶符号为：\n$$\n\\widehat{D_{-}}(\\theta) = \\frac{1 - \\exp(-i \\theta)}{\\Delta x}\n$$\n\n#### 第 2 部分：半离散格式的稳定性分析\n\n平流方程的半离散近似为$\\partial_{t} u_{j}(t) + a\\, D u_{j}(t) = 0$。我们通过将$u_{j}(t) = \\hat{u}(\\theta, t) \\exp(i j \\theta)$代入此方程来分析单个傅里叶模的演化。算子$\\partial_t$仅作用于$\\hat{u}(\\theta, t)$，而$D$仅作用于空间部分$\\exp(i j \\theta)$：\n$$\n\\frac{d\\hat{u}(\\theta, t)}{dt} \\exp(i j \\theta) + a\\, \\hat{u}(\\theta, t) D \\exp(i j \\theta) = 0\n$$\n利用特征值性质$D \\exp(i j \\theta) = \\widehat{D}(\\theta) \\exp(i j \\theta)$，我们得到：\n$$\n\\frac{d\\hat{u}(\\theta, t)}{dt} \\exp(i j \\theta) + a\\, \\hat{u}(\\theta, t) \\widehat{D}(\\theta) \\exp(i j \\theta) = 0\n$$\n除以非零项$\\exp(i j \\theta)$，我们得到关于傅里叶模振幅的常微分方程（ODE）：\n$$\n\\frac{d\\hat{u}}{dt} = -a \\widehat{D}(\\theta) \\hat{u}\n$$\n该 ODE 的解为$\\hat{u}(\\theta, t) = \\hat{u}(\\theta, 0) \\exp(-a \\widehat{D}(\\theta) t)$。为使格式稳定，任何模的振幅都不能随时间无界增长，即对于所有$\\theta$和$t > 0$，都有$|\\exp(-a \\widehat{D}(\\theta) t)| \\le 1$。这要求指数的实部为非正：\n$$\n\\text{Re}(-a \\widehat{D}(\\theta)) \\le 0\n$$\n我们针对$D=D_{+}$和$D=D_{-}$分析此条件。让我们使用$\\exp(i\\phi) = \\cos(\\phi) + i\\sin(\\phi)$将符号表示为其分量的实部和虚部。\n对于$\\widehat{D_{+}}(\\theta)$：\n$$\n\\widehat{D_{+}}(\\theta) = \\frac{\\cos(\\theta) - 1}{\\Delta x} + i \\frac{\\sin(\\theta)}{\\Delta x}\n$$\n稳定性条件为$\\text{Re}(-a \\widehat{D_{+}}(\\theta)) = -a \\text{Re}(\\widehat{D_{+}}(\\theta)) = -a \\frac{\\cos(\\theta) - 1}{\\Delta x} = a \\frac{1 - \\cos(\\theta)}{\\Delta x} \\le 0$。由于$\\Delta x > 0$且对于所有$\\theta$，都有$1 - \\cos(\\theta) \\ge 0$，因此该不等式当且仅当$a \\le 0$时成立。因此，前向差分格式（$D_{+}$）对于左行波（$a \\le 0$）是稳定的。项$a \\frac{1 - \\cos(\\theta)}{\\Delta x}$代表数值耗散，它会衰减模的振幅（除非$\\theta=0 \\pmod{2\\pi}$）。\n\n对于$\\widehat{D_{-}}(\\theta)$：\n$$\n\\widehat{D_{-}}(\\theta) = \\frac{1 - (\\cos(\\theta) - i\\sin(\\theta))}{\\Delta x} = \\frac{1 - \\cos(\\theta)}{\\Delta x} + i \\frac{\\sin(\\theta)}{\\Delta x}\n$$\n稳定性条件为$\\text{Re}(-a \\widehat{D_{-}}(\\theta)) = -a \\text{Re}(\\widehat{D_{-}}(\\theta)) = -a \\frac{1 - \\cos(\\theta)}{\\Delta x} \\le 0$。该不等式当且仅当$-a \\le 0$，即$a \\ge 0$时成立。因此，后向差分格式（$D_{-}$）对于右行波（$a \\ge 0$）是稳定的。该格式也是耗散的。\n\n这一结果是迎风原则的核心：为了保证稳定性，单边差分必须取自波传播来的方向（“迎风”）。\n\n#### 第 3 部分：数值色散和相速度分析\n\n一个傅里叶模的解是$u_j(t) = \\hat{u}(0) \\exp(-a t \\text{Re}(\\widehat{D})) \\exp(i (j\\theta - a t \\text{Im}(\\widehat{D})))$。波的相位是$j\\theta - a t \\text{Im}(\\widehat{D}(\\theta))$。通过写出$j\\theta = (j\\Delta x)(\\theta/\\Delta x) = kx_j$，相位可以写成$k x_j - \\omega_{num} t$，其中$\\omega_{num} = a \\text{Im}(\\widehat{D}(\\theta))$。数值相速度是$c_{num}(\\theta) = \\omega_{num}/k = a \\text{Im}(\\widehat{D}(\\theta)) / (\\theta/\\Delta x)$。\n\n对于$D_{+}$和$D_{-}$，符号的虚部是相同的：\n$$\n\\text{Im}(\\widehat{D_{+}}(\\theta)) = \\text{Im}(\\widehat{D_{-}}(\\theta)) = \\frac{\\sin(\\theta)}{\\Delta x}\n$$\n因此，两种格式的数值相速度均为：\n$$\nc_{num}(\\theta) = a \\frac{\\sin(\\theta)/\\Delta x}{\\theta/\\Delta x} = a \\frac{\\sin(\\theta)}{\\theta}\n$$\n偏微分方程$\\partial_{t} u + a\\,\\partial_{x} u = 0$的精确相速度是$c_{exact} = a$。\n\n我们比较$c_{num}$和$c_{exact}$在$0  \\theta  \\pi$的情况。在此区间内，根据一个已知的数学不等式，有$0  \\sin(\\theta)/\\theta  1$。让我们分析稳定情况：\n1.  **$D_{-}$的稳定情况**：$a > 0$。我们比较$c_{num} = a \\frac{\\sin(\\theta)}{\\theta}$与$c_{exact} = a$。由于$a > 0$且$\\frac{\\sin(\\theta)}{\\theta}  1$，可得$a \\frac{\\sin(\\theta)}{\\theta}  a$。因此，$c_{num}  c_{exact}$。数值相速度**低估**了精确相速度。\n2.  **$D_{+}$的稳定情况**：$a  0$。我们再次比较$c_{num} = a \\frac{\\sin(\\theta)}{\\theta}$与$c_{exact} = a$。由于$a  0$，将不等式$\\frac{\\sin(\\theta)}{\\theta}  1$乘以$a$会反转符号：$a \\frac{\\sin(\\theta)}{\\theta} > a$。因此，$c_{num} > c_{exact}$。数值相速度**高估**了精确相速度。\n\n虽然当$a0$时相速度的代数值被高估了，但必须注意，在两种稳定情况下，速度的大小总是被低估的。$|c_{num}| = |a \\frac{\\sin\\theta}{\\theta}| = |a| \\frac{\\sin\\theta}{\\theta}  |a| = |c_{exact}|$。这意味着对于所有波数$\\theta \\in (0, \\pi)$，数值波的传播速度都比真实波慢，这种现象被称为相位滞后。这是数值色散的一种形式，因为速度依赖于波数$\\theta$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{\\exp(i\\theta) - 1}{\\Delta x}  \\frac{1 - \\exp(-i\\theta)}{\\Delta x}\n\\end{pmatrix}\n}\n$$", "id": "3461944"}, {"introduction": "在独立考察了空间算子之后，我们现在来分析一个完整的数值格式。本练习将冯·诺伊曼分析应用于求解对流方程的一阶迎风格式，该格式结合了简单的时间步进规则和具有方向性的空间差分。我们的目标是推导其放大因子$G(\\theta)$，并由此得出著名的Courant-Friedrichs-Lewy (CFL) 稳定性条件，这是双曲型偏微分方程数值方法的基石。[@problem_id:3461957]", "problem": "考虑具有常平流速度$a>0$的线性平流偏微分方程$u_{t} + a\\,u_{x} = 0$。设均匀空间网格由$x_{j} = j\\,\\Delta x$给出，离散时间层为$t^{n} = n\\,\\Delta t$，未知量为$u_{j}^{n} \\approx u(x_{j}, t^{n})$。对于$a>0$，一阶迎风有限差分格式利用迎风方向的信息将$u_{j}^{n}$推进到$u_{j}^{n+1}$。假设采用周期性边界条件，以便在网格上可以良好地定义离散傅里叶模。\n\n从冯·诺依曼稳定性分析的第一性原理出发，即线性、平移不变的差分格式对傅里叶模$e^{\\mathrm{i} j \\theta}$起对角作用，且稳定性的特征是谱放大因子$G(\\theta)$满足要求$\\sup_{\\theta \\in \\mathbb{R}} |G(\\theta)| \\leq 1$，推导$a>0$时一阶迎风格式的离散傅里叶符号，并确定使该格式在冯·诺依曼意义下稳定的最大 Courant-Friedrichs-Lewy (CFL) 数$\\lambda_{\\max}$。这里的 CFL 数为$\\lambda = \\dfrac{a\\,\\Delta t}{\\Delta x}$。你的最终答案必须是单个实数$\\lambda_{\\max}$，无需四舍五入。", "solution": "问题陈述经评估有效。这是一个来自偏微分方程（PDE）数值分析领域的、提法恰当且有科学依据的问题，所有必要信息均已提供。\n\n线性平流方程由下式给出\n$$u_{t} + a u_{x} = 0$$\n其中平流速度$a$为正的常数，$a > 0$。我们在空间步长为$\\Delta x$、时间步长为$\\Delta t$的均匀网格上离散化此偏微分方程。离散点为$(x_j, t^n) = (j\\,\\Delta x, n\\,\\Delta t)$，在这些点上的数值解记为$u_j^n \\approx u(x_j, t^n)$。\n\n一阶迎风格式通过在时间上使用向前差分、在空间上使用单边差分来构造。对于$a>0$，特征信息从左向右（沿$x$增大的方向）传播。因此，“迎风”方向是负$x$方向。这决定了对空间导数$u_x$使用一阶向后差分：\n$$u_t \\approx \\frac{u_j^{n+1} - u_j^n}{\\Delta t}$$\n$$u_x \\approx \\frac{u_j^n - u_{j-1}^n}{\\Delta x}$$\n将这些近似代入偏微分方程，得到有限差分方程：\n$$\\frac{u_j^{n+1} - u_j^n}{\\Delta t} + a \\left(\\frac{u_j^n - u_{j-1}^n}{\\Delta x}\\right) = 0$$\n我们可以重新整理该方程，以求解下一时间步的解$u_j^{n+1}$：\n$$u_j^{n+1} = u_j^n - \\frac{a\\,\\Delta t}{\\Delta x} (u_j^n - u_{j-1}^n)$$\n引入 Courant-Friedrichs-Lewy (CFL) 数$\\lambda = \\frac{a\\,\\Delta t}{\\Delta x}$，格式变为：\n$$u_j^{n+1} = u_j^n - \\lambda(u_j^n - u_{j-1}^n)$$\n$$u_j^{n+1} = (1 - \\lambda) u_j^n + \\lambda u_{j-1}^n$$\n这就是$a>0$时一阶迎风格式的显式表达式。\n\n为了进行冯·诺依曼稳定性分析，我们考虑单个傅里叶模在网格上的行为。假设采用周期性边界条件，我们可以将解表示为形如$u_j^n = \\hat{u}^n(k) e^{\\mathrm{i} k x_j}$的模的叠加，其中$k$是波数。对于线性格式，分析单个模就足够了。令$u_j^n$的形式为：\n$$u_j^n = G(\\theta)^n e^{\\mathrm{i} j \\theta}$$\n这里，$\\theta = k \\Delta x$是无量纲波数或相角，$G(\\theta)$是放大因子。下一时间步的解为$u_j^{n+1} = G(\\theta)^{n+1} e^{\\mathrm{i} j \\theta}$。将此试探解代入差分格式得到：\n$$G(\\theta)^{n+1} e^{\\mathrm{i} j \\theta} = (1 - \\lambda) G(\\theta)^n e^{\\mathrm{i} j \\theta} + \\lambda G(\\theta)^n e^{\\mathrm{i} (j-1) \\theta}$$\n我们可以提出公因子$G(\\theta)^n$（对于非平凡解）和$e^{\\mathrm{i} j \\theta}$：\n$$G(\\theta) e^{\\mathrm{i} j \\theta} = \\left( (1 - \\lambda) e^{\\mathrm{i} j \\theta} + \\lambda e^{\\mathrm{i} (j-1) \\theta} \\right)$$\n$$G(\\theta) e^{\\mathrm{i} j \\theta} = \\left( (1 - \\lambda) + \\lambda e^{-\\mathrm{i} \\theta} \\right) e^{\\mathrm{i} j \\theta}$$\n两边同除以公因子$e^{\\mathrm{i} j \\theta}$，得到放大因子$G(\\theta)$，即该格式的离散傅里叶符号：\n$$G(\\theta) = 1 - \\lambda + \\lambda e^{-\\mathrm{i} \\theta}$$\n如果对于所有可能的$\\theta \\in [-\\pi, \\pi]$值，放大因子的模都小于或等于$1$，则该格式在冯·诺依曼意义下是稳定的。该条件是：\n$$|G(\\theta)| \\le 1 \\quad \\forall \\theta$$\n为分析此条件，我们计算$G(\\theta)$的模的平方。使用欧拉公式$e^{-\\mathrm{i} \\theta} = \\cos(\\theta) - \\mathrm{i} \\sin(\\theta)$，我们可以用其实部和虚部表示$G(\\theta)$：\n$$G(\\theta) = (1 - \\lambda + \\lambda \\cos(\\theta)) - \\mathrm{i} (\\lambda \\sin(\\theta))$$\n模的平方为$|G(\\theta)|^2 = (\\text{Re}(G))^2 + (\\text{Im}(G))^2$：\n$$|G(\\theta)|^2 = (1 - \\lambda + \\lambda \\cos(\\theta))^2 + (-\\lambda \\sin(\\theta))^2$$\n$$|G(\\theta)|^2 = (1 - \\lambda(1 - \\cos(\\theta)))^2 + \\lambda^2 \\sin^2(\\theta)$$\n展开各项：\n$$|G(\\theta)|^2 = 1 - 2\\lambda(1 - \\cos(\\theta)) + \\lambda^2(1 - \\cos(\\theta))^2 + \\lambda^2 \\sin^2(\\theta)$$\n$$|G(\\theta)|^2 = 1 - 2\\lambda(1 - \\cos(\\theta)) + \\lambda^2(1 - 2\\cos(\\theta) + \\cos^2(\\theta)) + \\lambda^2 \\sin^2(\\theta)$$\n使用恒等式$\\cos^2(\\theta) + \\sin^2(\\theta) = 1$：\n$$|G(\\theta)|^2 = 1 - 2\\lambda(1 - \\cos(\\theta)) + \\lambda^2(1 - 2\\cos(\\theta) + 1)$$\n$$|G(\\theta)|^2 = 1 - 2\\lambda(1 - \\cos(\\theta)) + 2\\lambda^2(1 - \\cos(\\theta))$$\n提出公因子：\n$$|G(\\theta)|^2 = 1 + (2\\lambda^2 - 2\\lambda)(1 - \\cos(\\theta))$$\n$$|G(\\theta)|^2 = 1 - 2\\lambda(1 - \\lambda)(1 - \\cos(\\theta))$$\n稳定性条件$|G(\\theta)|^2 \\le 1$变为：\n$$1 - 2\\lambda(1 - \\lambda)(1 - \\cos(\\theta)) \\le 1$$\n$$-2\\lambda(1 - \\lambda)(1 - \\cos(\\theta)) \\le 0$$\n除以$-2$使不等号反向：\n$$\\lambda(1 - \\lambda)(1 - \\cos(\\theta)) \\ge 0$$\n我们分析各项的符号。\n1. CFL 数$\\lambda = \\frac{a \\Delta t}{\\Delta x}$必须为非负数，因为$a>0$，$\\Delta t > 0$，且$\\Delta x > 0$。所以，$\\lambda \\ge 0$。\n2. 对于任何实数$\\theta$，项$(1 - \\cos(\\theta))$总是非负的，因为$\\cos(\\theta) \\le 1$。具体来说，$0 \\le (1 - \\cos(\\theta)) \\le 2$。\n\n由于$\\lambda \\ge 0$且$(1 - \\cos(\\theta)) \\ge 0$，不等式$\\lambda(1 - \\lambda)(1 - \\cos(\\theta)) \\ge 0$对所有$\\theta$成立的充分必要条件是剩余的因子也为非负：\n$$1 - \\lambda \\ge 0$$\n这意为着$\\lambda \\le 1$。\n综合关于$\\lambda$的两个条件，该格式稳定的充分必要条件是$0 \\le \\lambda \\le 1$。\n问题要求使格式稳定的最大 CFL 数$\\lambda_{\\max}$。根据我们推导出的稳定区域，这个值为$1$。", "answer": "$$\\boxed{1}$$", "id": "3461957"}, {"introduction": "一个稳定的格式是必要的，但对于确保精度而言，这并非总是足够的。本练习通过分析以无耗散特性而闻名的蛙跳格式（leapfrog scheme），深入探究了格式更精细的属性。我们将推导其离散频散关系，以量化不同波长的数值波如何以错误的速度传播，并计算群速度以理解这种数值频散对复杂波包传播的影响。[@problem_id:3461974]", "problem": "考虑一维线性平流方程$u_{t} + a\\,u_{x} = 0$，其中平流速度$a \\in \\mathbb{R}$为常数，定义在周期性域上。在空间上使用间距为$\\Delta x$的均匀网格进行离散，在时间上使用步长为$\\Delta t$进行离散。令$\\nu = a\\,\\Delta t/\\Delta x$表示 Courant 数。考虑时间上蛙跳、空间上中心差分的线性格式\n$$\n\\frac{u^{n+1}_{j} - u^{n-1}_{j}}{2\\,\\Delta t} + a\\,\\frac{u^{n}_{j+1} - u^{n}_{j-1}}{2\\,\\Delta x} = 0.\n$$\n使用 von Neumann 傅里叶模态拟设$u^{n}_{j} = \\hat{u}\\,\\exp\\!\\big(i\\,j\\,\\theta - i\\,\\omega(\\theta)\\,n\\,\\Delta t\\big)$，其中无量纲波数$\\theta \\in [-\\pi,\\pi]$（以弧度为单位），物理波数$k = \\theta/\\Delta x$，推导连接$\\omega(\\theta)$和$\\theta$的离散色散关系。然后，从第一性原理出发，计算群速度$v_{g}(\\theta) = \\partial \\omega/\\partial k$作为$\\theta$和$\\nu$的显式函数，并将其与精确的连续介质群速度$a$进行比较。最后，利用从您的色散关系中得到的小$\\theta$级数，量化以$\\theta_{0}$为中心（$|\\theta_{0}| \\ll 1$）的窄带高斯波包的群速度的主阶相对误差，并讨论这对该波包传播精度的影响，包括谱带宽的作用。\n\n您的最终答案必须是计算出的离散群速度$v_{g}(\\theta)$的一个单一闭式解析表达式，用$a$、$\\nu$和$\\theta$表示（最终答案框中不含单位）。全过程角度均以弧度表示。无需数值取整。", "solution": "问题陈述已经过严格验证，被认为是科学上可靠、适定、客观且自洽的。它提出了一个偏微分方程数值分析中的标准且非平凡的问题，具体涉及线性平流方程的蛙跳有限差分格式的色散性质。所有提供的信息都是一致且足以进行严格推导和分析的。因此，该问题是有效的。\n\n我们从一维线性平流方程$u_{t} + a\\,u_{x} = 0$开始，其中$a$是一个常数速度。所提出的数值格式是时间上蛙跳、空间上中心差分的离散化：\n$$\n\\frac{u^{n+1}_{j} - u^{n-1}_{j}}{2\\,\\Delta t} + a\\,\\frac{u^{n}_{j+1} - u^{n}_{j-1}}{2\\,\\Delta x} = 0\n$$\n为了分析该格式的色散性质，我们代入 von Neumann 傅里叶模态拟设$u^{n}_{j} = \\hat{u}\\,\\exp\\!\\big(i\\,j\\,\\theta - i\\,\\omega(\\theta)\\,n\\,\\Delta t\\big)$。这里，$j$和$n$分别是离散的空间和时间索引，$\\Delta x$和$\\Delta t$分别是网格间距和时间步长，$\\theta$是无量纲波数，$\\omega(\\theta)$是数值频率。\n\n格式中的各项变为：\n- $u^{n+1}_{j} = u^{n}_{j}\\,\\exp(-i\\,\\omega\\,\\Delta t)$\n- $u^{n-1}_{j} = u^{n}_{j}\\,\\exp(i\\,\\omega\\,\\Delta t)$\n- $u^{n}_{j+1} = u^{n}_{j}\\,\\exp(i\\,\\theta)$\n- $u^{n}_{j-1} = u^{n}_{j}\\,\\exp(-i\\,\\theta)$\n\n将这些代入有限差分方程得到：\n$$\n\\frac{u^{n}_{j}\\,\\exp(-i\\,\\omega\\,\\Delta t) - u^{n}_{j}\\,\\exp(i\\,\\omega\\,\\Delta t)}{2\\,\\Delta t} + a\\,\\frac{u^{n}_{j}\\,\\exp(i\\,\\theta) - u^{n}_{j}\\,\\exp(-i\\,\\theta)}{2\\,\\Delta x} = 0\n$$\n对于非平凡解（$u^{n}_{j} \\neq 0$），我们可以除以$u^{n}_{j}$：\n$$\n\\frac{\\exp(-i\\,\\omega\\,\\Delta t) - \\exp(i\\,\\omega\\,\\Delta t)}{2\\,\\Delta t} + a\\,\\frac{\\exp(i\\,\\theta) - \\exp(-i\\,\\theta)}{2\\,\\Delta x} = 0\n$$\n使用欧拉恒等式$\\sin(z) = \\frac{\\exp(i\\,z) - \\exp(-i\\,z)}{2i}$，方程简化为：\n$$\n\\frac{-2i\\,\\sin(\\omega\\,\\Delta t)}{2\\,\\Delta t} + a\\,\\frac{2i\\,\\sin(\\theta)}{2\\,\\Delta x} = 0\n$$\n$$\n-\\frac{i\\,\\sin(\\omega\\,\\Delta t)}{\\Delta t} + \\frac{i\\,a\\,\\sin(\\theta)}{\\Delta x} = 0\n$$\n两边除以$i$并重新整理，得到隐式离散色散关系：\n$$\n\\frac{\\sin(\\omega\\,\\Delta t)}{\\Delta t} = \\frac{a\\,\\sin(\\theta)}{\\Delta x}\n$$\n引入 Courant 数$\\nu = a\\,\\Delta t/\\Delta x$，我们得到一个更紧凑的形式：\n$$\n\\sin(\\omega(\\theta)\\,\\Delta t) = \\nu\\,\\sin(\\theta)\n$$\n当$\\omega$为实值时，此关系式有效，条件是$|\\nu\\,\\sin(\\theta)| \\le 1$。由于$|\\sin(\\theta)| \\le 1$，这要求满足 Courant-Friedrichs-Lewy (CFL) 稳定性条件$|\\nu| \\le 1$。假设稳定，我们可以写出显式色散关系：\n$$\n\\omega(\\theta) = \\frac{1}{\\Delta t}\\arcsin(\\nu\\,\\sin(\\theta))\n$$\n接下来，我们计算离散群速度，定义为$v_{g}(\\theta) = \\frac{\\partial \\omega}{\\partial k}$，其中$k$是物理波数，通过$k = \\theta/\\Delta x$与无量纲波数$\\theta$相关。使用链式法则，我们可以写出：\n$$\nv_{g}(\\theta) = \\frac{\\partial \\omega}{\\partial k} = \\frac{\\partial \\omega}{\\partial \\theta}\\frac{\\partial \\theta}{\\partial k}\n$$\n从$\\theta = k\\,\\Delta x$，我们得到$\\frac{\\partial \\theta}{\\partial k} = \\Delta x$。现在我们对$\\omega(\\theta)$关于$\\theta$求导：\n$$\n\\frac{\\partial \\omega}{\\partial \\theta} = \\frac{\\partial}{\\partial \\theta}\\left[ \\frac{1}{\\Delta t}\\arcsin(\\nu\\,\\sin(\\theta)) \\right] = \\frac{1}{\\Delta t} \\cdot \\frac{1}{\\sqrt{1 - (\\nu\\,\\sin(\\theta))^{2}}} \\cdot \\frac{\\partial}{\\partial \\theta}(\\nu\\,\\sin(\\theta))\n$$\n$$\n\\frac{\\partial \\omega}{\\partial \\theta} = \\frac{1}{\\Delta t} \\frac{\\nu\\,\\cos(\\theta)}{\\sqrt{1 - \\nu^{2}\\,\\sin^{2}(\\theta)}}\n$$\n因此，群速度为：\n$$\nv_{g}(\\theta) = \\Delta x \\cdot \\frac{\\partial \\omega}{\\partial \\theta} = \\Delta x \\cdot \\left( \\frac{\\nu\\,\\cos(\\theta)}{\\Delta t \\sqrt{1 - \\nu^{2}\\,\\sin^{2}(\\theta)}} \\right)\n$$\n代入$\\nu = a\\,\\Delta t/\\Delta x$：\n$$\nv_{g}(\\theta) = \\Delta x \\cdot \\left( \\frac{(a\\,\\Delta t/\\Delta x)\\,\\cos(\\theta)}{\\Delta t \\sqrt{1 - \\nu^{2}\\,\\sin^{2}(\\theta)}} \\right) = \\frac{a\\,\\cos(\\theta)}{\\sqrt{1 - \\nu^{2}\\,\\sin^{2}(\\theta)}}\n$$\n这就是蛙跳格式的离散群速度。对于连续方程，精确的色散关系是$\\omega(k) = ak$，这给出了精确的群速度$v_{g}^{\\text{exact}} = \\frac{\\partial \\omega}{\\partial k} = a$。连续问题是非色散的。相比之下，数值群速度$v_{g}(\\theta)$依赖于波数$\\theta$，这表明该格式引入了数值色散。\n\n为了量化长波（$|\\theta| \\ll 1$）的误差，我们在$\\theta=0$附近对$v_{g}(\\theta)$进行泰勒级数展开。我们使用近似$\\cos(\\theta) \\approx 1 - \\frac{\\theta^{2}}{2}$和$\\sin^{2}(\\theta) \\approx \\theta^{2}$。\n$$\nv_{g}(\\theta) = \\frac{a(1 - \\frac{\\theta^{2}}{2} + O(\\theta^{4}))}{\\sqrt{1 - \\nu^{2}(\\theta^{2} + O(\\theta^{4}))}} = a\\left(1 - \\frac{\\theta^{2}}{2}\\right)(1 - \\nu^{2}\\theta^{2})^{-1/2} + O(\\theta^{4})\n$$\n对小的$x$使用二项式展开$(1-x)^{-1/2} \\approx 1 + \\frac{1}{2}x$：\n$$\nv_{g}(\\theta) \\approx a\\left(1 - \\frac{\\theta^{2}}{2}\\right)\\left(1 + \\frac{1}{2}\\nu^{2}\\theta^{2}\\right) = a\\left(1 + \\frac{1}{2}\\nu^{2}\\theta^{2} - \\frac{1}{2}\\theta^{2} - \\frac{1}{4}\\nu^{2}\\theta^{4}\\right)\n$$\n保留到$\\theta^{2}$阶的项：\n$$\nv_{g}(\\theta) \\approx a\\left(1 + \\frac{1}{2}(\\nu^{2} - 1)\\theta^{2}\\right)\n$$\n群速度的主阶相对误差为：\n$$\n\\frac{v_{g}(\\theta) - a}{a} \\approx \\frac{1}{2}(\\nu^{2} - 1)\\theta^{2}\n$$\n由于稳定性要求$\\nu^{2} \\le 1$，所以项$\\nu^{2}-1$是非正的。因此，对于小$\\theta$，$v_{g}(\\theta) \\le a$。这表明存在滞后的相位误差：数值波分量比其物理对应物传播得更慢。\n\n对于一个以低波数$\\theta_{0}$（$|\\theta_{0}| \\ll 1$）为中心的窄带高斯波包，其质心将以大约$v_{g}(\\theta_{0})$的速度传播，该速度略小于$a$。更重要的是，由于群速度在波包的谱带宽上不是恒定的，不同的傅里叶分量将以不同的速度传播。群速度随波数的变化，即$\\frac{\\partial v_{g}}{\\partial\\theta}$，导致数值色散，使得波包随时间扩散并变形。更宽的谱带宽会加剧这种效应，因为它涉及更宽范围的群速度，导致波包更快速地发生非物理扩散。在最高可分辨波数$\\theta = \\pi$处，群速度为$v_{g}(\\pi) = -a$，这意味着这些短波会向后传播，这是该格式的一个严重的数值伪影。", "answer": "$$\\boxed{\\frac{a\\,\\cos(\\theta)}{\\sqrt{1 - \\nu^{2}\\,\\sin^{2}(\\theta)}}}$$", "id": "3461974"}]}