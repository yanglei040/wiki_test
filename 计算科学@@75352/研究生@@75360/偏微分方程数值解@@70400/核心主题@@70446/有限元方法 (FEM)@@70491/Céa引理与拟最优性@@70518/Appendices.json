{"hands_on_practices": [{"introduction": "本练习是理解Céa引理核心常数的基石。通过从基本定义出发，我们将为扩散问题推导连续性常数 $M$ 和矫顽性常数 $\\alpha$，并将它们与一个重要的物理参数——材料属性的对比度 $\\kappa$ 联系起来。这个过程不仅揭示了抽象理论与具体问题参数之间的关系，还使我们能够预测有限元方法在处理高对比度材料时的表现 [@problem_id:3368751]。", "problem": "设 $\\Omega \\subset \\mathbb{R}^{d}$ 是一个有界Lipschitz域，并设 $V := H^{1}_{0}(\\Omega)$ 是索博列夫空间，其元素为在 $\\partial \\Omega$ 上为零且弱梯度平方可积的函数，该空间配备范数 $\\|v\\|_{V} := \\|\\nabla v\\|_{L^{2}(\\Omega)^{d}}$。考虑双线性形式\n$$\na(u,v) := \\int_{\\Omega} A(x)\\,\\nabla u(x) \\cdot \\nabla v(x)\\,dx,\n$$\n其中 $A:\\Omega \\to \\mathbb{R}^{d \\times d}$ 是一个对称正定（SPD）矩阵场，它在 $\\Omega$ 的一个形状正则剖分上是分片常数。假设存在正常数 $\\lambda_{\\min}$ 和 $\\lambda_{\\max}$，使得对于几乎所有的 $x \\in \\Omega$，$A(x)$ 的所有特征值都位于区间 $[\\lambda_{\\min},\\lambda_{\\max}]$ 内。定义对比度 $\\kappa := \\lambda_{\\max}/\\lambda_{\\min}$，该值可能很大（高对比度情况）。设 $u \\in V$ 是变分问题 $a(u,v) = \\ell(v)$ 对所有 $v \\in V$ 的唯一解，其中 $\\ell \\in V^{\\ast}$ 是一个有界线性泛函。设 $V_{h} \\subset V$ 是任意一个协调的有限维子空间，其伽辽金近似解 $u_{h} \\in V_{h}$ 满足 $a(u_{h},v_{h}) = \\ell(v_{h})$ 对所有 $v_{h} \\in V_{h}$ 成立。\n\n仅使用 $A$ 的SPD性质以及双线性形式在 $V$ 上关于范数 $\\|\\cdot\\|_{V}$ 的连续性和矫顽性的定义，推导出显式常数 $M$ 和 $\\alpha$，使得\n$$\n|a(u,v)| \\le M\\,\\|u\\|_{V}\\,\\|v\\|_{V} \\quad \\text{对所有 } u,v \\in V,\n$$\n并且\n$$\na(v,v) \\ge \\alpha\\,\\|v\\|_{V}^{2} \\quad \\text{对所有 } v \\in V.\n$$\n然后，基于Céa引理的标准形式，确定准最优性常数并分析其对对比度 $\\kappa$ 的依赖性。请以 $\\kappa$ 的单个闭式解析表达式形式给出准最优性常数的最终答案。不需要进行数值近似。", "solution": "用户提供的文本是一个有效的问题陈述。\n\n### 问题验证\n\n**步骤1：提取已知条件**\n- **域和函数空间**：$\\Omega \\subset \\mathbb{R}^{d}$ 是一个有界Lipschitz域。函数空间是 $V := H^{1}_{0}(\\Omega)$。\n- **范数**：空间 $V$ 配备范数 $\\|v\\|_{V} := \\|\\nabla v\\|_{L^{2}(\\Omega)^{d}}$。\n- **双线性形式**：$a(u,v) := \\int_{\\Omega} A(x)\\,\\nabla u(x) \\cdot \\nabla v(x)\\,dx$。\n- **系数矩阵**：$A:\\Omega \\to \\mathbb{R}^{d \\times d}$ 是一个对称正定（SPD）矩阵场，且为分片常数。\n- **特征值界**：存在正常数 $\\lambda_{\\min}$ 和 $\\lambda_{\\max}$，使得对于几乎所有的 $x \\in \\Omega$，$A(x)$ 的所有特征值都位于区间 $[\\lambda_{\\min},\\lambda_{\\max}]$ 内。\n- **对比度**：对比度定义为 $\\kappa := \\lambda_{\\max}/\\lambda_{\\min}$。\n- **变分问题**：精确解 $u \\in V$ 满足 $a(u,v) = \\ell(v)$ 对所有 $v \\in V$ 成立，其中 $\\ell \\in V^{\\ast}$ 是一个有界线性泛函。\n- **伽辽金近似**：$V_{h} \\subset V$ 是一个协调的有限维子空间。近似解 $u_{h} \\in V_{h}$ 满足 $a(u_{h},v_{h}) = \\ell(v_{h})$ 对所有 $v_{h} \\in V_{h}$ 成立。\n- **目标**：推导双线性形式 $a(\\cdot,\\cdot)$ 关于范数 $\\|\\cdot\\|_{V}$ 的连续性常数 $M$ 和矫顽性常数 $\\alpha$。然后，从Céa引理中确定准最优性常数，并用对比度 $\\kappa$ 表示。\n\n**步骤2：使用提取的已知条件进行验证**\n该问题在科学上和数学上是合理的。它描述了二阶椭圆偏微分方程有限元分析的标准框架。假设（有界Lipschitz域、$H^1_0(\\Omega)$ 空间、SPD系数矩阵）是确保通过Lax-Milgram定理获得适定性的标准假设。该问题是适定的、客观的、完整的、一致的，并提出了一个对偏微分方程数值分析至关重要的非平凡问题。因此，判定为**有效**。\n\n**步骤3：结论与行动**\n问题有效。将提供完整解答。\n\n### 解答\n\n解答分为三部分：首先，推导连续性常数 $M$；其次，推导矫顽性常数 $\\alpha$；最后，将这些常数应用于Céa引理，以根据对比度 $\\kappa$ 找到准最优性常数。\n\n**1. 连续性常数 $M$ 的推导**\n\n双线性形式 $a(u,v)$ 的连续性要求找到一个常数 $M  0$，使得对所有 $u, v \\in V$ 都有 $|a(u,v)| \\le M \\|u\\|_{V} \\|v\\|_{V}$。\n\n我们从双线性形式的定义开始：\n$$\na(u,v) = \\int_{\\Omega} A(x)\\,\\nabla u(x) \\cdot \\nabla v(x)\\,dx\n$$\n取绝对值，我们得到：\n$$\n|a(u,v)| = \\left| \\int_{\\Omega} \\nabla v(x)^{T} A(x) \\nabla u(x) \\,dx \\right|\n$$\n使用积分的三角不等式（$L^1$ 范数性质的一个特例），我们将绝对值移到积分内部：\n$$\n|a(u,v)| \\le \\int_{\\Omega} |\\nabla v(x)^{T} A(x) \\nabla u(x)| \\,dx\n$$\n对于每个 $x \\in \\Omega$，$\\nabla u(x)$ 和 $\\nabla v(x)$ 是 $\\mathbb{R}^{d}$ 中的向量。我们可以应用$\\mathbb{R}^{d}$中欧几里得点积的柯西-施瓦茨不等式：对于向量 $\\mathbf{p}, \\mathbf{q} \\in \\mathbb{R}^d$，有 $|\\mathbf{p} \\cdot \\mathbf{q}| \\le \\|\\mathbf{p}\\|_{\\mathbb{R}^d} \\|\\mathbf{q}\\|_{\\mathbb{R}^d}$。令 $\\mathbf{p} = A(x)\\nabla u(x)$ 和 $\\mathbf{q} = \\nabla v(x)$。\n$$\n|\\nabla v(x)^{T} A(x) \\nabla u(x)| \\le \\|A(x)\\nabla u(x)\\|_{\\mathbb{R}^d} \\|\\nabla v(x)\\|_{\\mathbb{R}^d}\n$$\n矩阵-向量乘积的范数 $\\|A(x)\\nabla u(x)\\|_{\\mathbb{R}^d}$ 可以用 $A(x)$ 的算子范数（由向量欧几里得范数诱导）来界定，对于对称矩阵，其算子范数是其最大特征值的绝对值。由于 $A(x)$ 是正定的，其所有特征值都为正。$A(x)$ 的最大特征值记为 $\\lambda_{\\max}(A(x))$。\n$$\n\\|A(x)\\nabla u(x)\\|_{\\mathbb{R}^d} \\le \\lambda_{\\max}(A(x)) \\|\\nabla u(x)\\|_{\\mathbb{R}^d}\n$$\n根据假设，对于几乎所有的 $x \\in \\Omega$，$\\lambda_{\\max}(A(x)) \\le \\lambda_{\\max}$。因此，\n$$\n|\\nabla v(x)^{T} A(x) \\nabla u(x)| \\le \\lambda_{\\max} \\|\\nabla u(x)\\|_{\\mathbb{R}^d} \\|\\nabla v(x)\\|_{\\mathbb{R}^d}\n$$\n将此代回积分不等式：\n$$\n|a(u,v)| \\le \\int_{\\Omega} \\lambda_{\\max} \\|\\nabla u(x)\\|_{\\mathbb{R}^d} \\|\\nabla v(x)\\|_{\\mathbb{R}^d} \\,dx\n$$\n我们可以将常数 $\\lambda_{\\max}$ 移到积分外。剩余的积分形式为 $\\int_{\\Omega} f(x)g(x)\\,dx$，其中 $f(x) = \\|\\nabla u(x)\\|_{\\mathbb{R}^d}$ 和 $g(x) = \\|\\nabla v(x)\\|_{\\mathbb{R}^d}$。我们对 $L^{2}(\\Omega)$ 函数应用柯西-施瓦茨不等式：\n$$\n\\int_{\\Omega} f(x)g(x)\\,dx \\le \\left(\\int_{\\Omega} f(x)^2\\,dx\\right)^{1/2} \\left(\\int_{\\Omega} g(x)^2\\,dx\\right)^{1/2}\n$$\n应用此不等式得到：\n$$\n|a(u,v)| \\le \\lambda_{\\max} \\left(\\int_{\\Omega} \\|\\nabla u(x)\\|_{\\mathbb{R}^d}^2 \\,dx\\right)^{1/2} \\left(\\int_{\\Omega} \\|\\nabla v(x)\\|_{\\mathbb{R}^d}^2 \\,dx\\right)^{1/2}\n$$\n根据定义，$\\|\\nabla w\\|_{L^2(\\Omega)^d} = \\left(\\int_{\\Omega} \\|\\nabla w(x)\\|_{\\mathbb{R}^d}^2 \\,dx\\right)^{1/2}$。这正是范数 $\\|w\\|_{V}$。因此，我们有：\n$$\n|a(u,v)| \\le \\lambda_{\\max} \\|\\nabla u\\|_{L^{2}(\\Omega)^{d}} \\|\\nabla v\\|_{L^{2}(\\Omega)^{d}} = \\lambda_{\\max} \\|u\\|_{V} \\|v\\|_{V}\n$$\n所以，连续性常数是 $M = \\lambda_{\\max}$。\n\n**2. 矫顽性常数 $\\alpha$ 的推导**\n\n双线性形式 $a(v,v)$ 的矫顽性（或V-椭圆性）要求找到一个常数 $\\alpha  0$，使得对于所有 $v \\in V$ 都有 $a(v,v) \\ge \\alpha \\|v\\|_{V}^{2}$。\n\n我们从 $a(v,v)$ 的定义开始：\n$$\na(v,v) = \\int_{\\Omega} \\nabla v(x)^{T} A(x) \\nabla v(x) \\,dx\n$$\n对于对称矩阵 $A(x)$，二次型 $\\mathbf{p}^{T}A(x)\\mathbf{p}$ 的下界是其最小特征值。具体来说，$\\mathbf{p}^{T}A(x)\\mathbf{p} \\ge \\lambda_{\\min}(A(x)) \\|\\mathbf{p}\\|_{\\mathbb{R}^d}^2$，其中 $\\lambda_{\\min}(A(x))$ 是 $A(x)$ 的最小特征值。\n令 $\\mathbf{p} = \\nabla v(x)$，我们有：\n$$\n\\nabla v(x)^{T} A(x) \\nabla v(x) \\ge \\lambda_{\\min}(A(x)) \\|\\nabla v(x)\\|_{\\mathbb{R}^d}^2\n$$\n根据假设，对于几乎所有的 $x \\in \\Omega$，$\\lambda_{\\min}(A(x)) \\ge \\lambda_{\\min}$。因此，\n$$\n\\nabla v(x)^{T} A(x) \\nabla v(x) \\ge \\lambda_{\\min} \\|\\nabla v(x)\\|_{\\mathbb{R}^d}^2\n$$\n将此不等式在域 $\\Omega$ 上积分：\n$$\na(v,v) = \\int_{\\Omega} \\nabla v(x)^{T} A(x) \\nabla v(x) \\,dx \\ge \\int_{\\Omega} \\lambda_{\\min} \\|\\nabla v(x)\\|_{\\mathbb{R}^d}^2 \\,dx\n$$\n我们将常数 $\\lambda_{\\min}$ 移出积分：\n$$\na(v,v) \\ge \\lambda_{\\min} \\int_{\\Omega} \\|\\nabla v(x)\\|_{\\mathbb{R}^d}^2 \\,dx\n$$\n该积分是梯度在 $L^{2}(\\Omega)^{d}$ 中范数的平方，也就是 $\\|v\\|_{V}^2$ 的定义：\n$$\na(v,v) \\ge \\lambda_{\\min} \\|v\\|_{V}^2\n$$\n所以，矫顽性常数是 $\\alpha = \\lambda_{\\min}$。\n\n**3. Céa引理与准最优性常数**\n\nCéa引理给出了伽辽金近似 $u_h$ 在由双线性形式诱导的能量范数（在本例中即范数 $\\|\\cdot\\|_V$）下的误差上界。该引理的标准形式是：\n$$\n\\|u - u_h\\|_{V} \\le C \\inf_{v_h \\in V_h} \\|u - v_h\\|_{V}\n$$\n常数 $C$ 是准最优性常数。我们使用常数 $M$ 和 $\\alpha$ 来推导它。\n\n从精确解 $u$ 和伽辽金解 $u_h$ 的定义，我们得到伽辽金正交性：\n$$\na(u - u_h, v_h) = a(u, v_h) - a(u_h, v_h) = \\ell(v_h) - \\ell(v_h) = 0 \\quad \\text{对所有 } v_h \\in V_h.\n$$\n现在，我们对误差 $e = u - u_h$ 使用矫顽性：\n$$\n\\alpha \\|u - u_h\\|_{V}^2 \\le a(u - u_h, u - u_h)\n$$\n对于任意的 $v_h \\in V_h$，我们可以写出 $u - u_h = (u - v_h) + (v_h - u_h)$。利用 $a(\\cdot,\\cdot)$ 的双线性性质：\n$$\na(u - u_h, u - u_h) = a(u - u_h, (u - v_h) + (v_h - u_h)) = a(u - u_h, u - v_h) + a(u - u_h, v_h - u_h)\n$$\n由于 $v_h - u_h \\in V_h$，伽辽金正交性意味着第二项为零。因此，\n$$\na(u-u_h, u-u_h) = a(u-u_h, u-v_h)\n$$\n将此与矫顽性不等式结合：\n$$\n\\alpha \\|u - u_h\\|_{V}^2 \\le a(u - u_h, u - v_h)\n$$\n接下来，我们对右边应用连续性性质：\n$$\na(u - u_h, u - v_h) \\le M \\|u - u_h\\|_{V} \\|u - v_h\\|_{V}\n$$\n结合最后两个不等式，我们得到：\n$$\n\\alpha \\|u - u_h\\|_{V}^2 \\le M \\|u - u_h\\|_{V} \\|u - v_h\\|_{V}\n$$\n如果 $\\|u - u_h\\|_{V} \\neq 0$，我们可以用 $\\alpha \\|u - u_h\\|_{V}$ 除以两边：\n$$\n\\|u - u_h\\|_{V} \\le \\frac{M}{\\alpha} \\|u - v_h\\|_{V}\n$$\n这个不等式对任何 $v_h \\in V_h$ 都成立。由于左侧与 $v_h$ 的选择无关，我们可以对右侧取遍所有 $v_h \\in V_h$ 的下确界，以获得最紧的界：\n$$\n\\|u - u_h\\|_{V} \\le \\frac{M}{\\alpha} \\inf_{v_h \\in V_h} \\|u - v_h\\|_{V}\n$$\n与Céa引理的标准形式比较，准最优性常数是 $C = \\frac{M}{\\alpha}$。\n\n最后，我们用对比度 $\\kappa$ 来表示这个常数。我们已经发现 $M = \\lambda_{\\max}$ 和 $\\alpha = \\lambda_{\\min}$。问题将对比度定义为 $\\kappa = \\lambda_{\\max}/\\lambda_{\\min}$。\n因此，准最优性常数为：\n$$\nC = \\frac{\\lambda_{\\max}}{\\lambda_{\\min}} = \\kappa\n$$\n分析表明，准最优性常数等于扩散系数的对比度。高对比度问题（大的 $\\kappa$）会导致大的准最优性常数，这表明伽辽金解在能量范数下可能不接近于 $V_h$ 中的最佳逼近。", "answer": "$$\\boxed{\\kappa}$$", "id": "3368751"}, {"introduction": "理论的强大之处不仅在于其预测能力，还在于其明确的适用边界。本练习旨在通过一个精心设计的反例，探索当Céa引理的关键假设——协调性 ($V_h \\subset V$)——被违反时会发生什么。通过计算一个非协调有限元方法的误差与最佳逼近误差之比，您将亲眼见证准最优性的失效，从而深刻理解为何协调性是保证Galerkin方法收敛质量的必要条件 [@problem_id:3368752]。", "problem": "考虑区间 $(0,1)$ 上的一维模型偏微分方程（PDE）：求 $u \\in H^{1}_{0}(0,1)$，使得\n$$\n\\int_{0}^{1} u'(x)\\,v'(x)\\,\\mathrm{d}x \\;=\\; \\int_{0}^{1} v(x)\\,\\mathrm{d}x \\quad \\text{对所有 } v \\in H^{1}_{0}(0,1),\n$$\n其中 $H^{1}_{0}(0,1)$ 是通常的 Sobolev 空间，其内的函数具有平方可积的导数且在端点处为零。双线性形式为 $a(u,v)=\\int_{0}^{1} u'(x)\\,v'(x)\\,\\mathrm{d}x$，能量范数为 $\\|w\\|_{a}=\\big(a(w,w)\\big)^{1/2}=\\|w'\\|_{L^{2}(0,1)}$。该变分形式源于强形式 $-u''(x)=1$（在 $(0,1)$ 上）以及边界条件 $u(0)=0$ 和 $u(1)=0$。\n\n保证伽辽金（Galerkin）近似拟最优性的一个已知充分条件是离散试验空间与连续空间的一致性。为探究一种失效模式，我们通过使用非协调的一维试验空间来故意违反一致性条件\n$$\nW_{h} \\;=\\; \\operatorname{span}\\{\\,\\varphi\\,\\}, \\quad \\varphi(x)=x,\n$$\n该空间不是 $H^{1}_{0}(0,1)$ 的子空间，因为 $\\varphi(1)\\neq 0$。通过非协调伽辽金方程定义离散近似解 $u_{h}\\in W_{h}$\n$$\n\\int_{0}^{1} u_{h}'(x)\\,w'(x)\\,\\mathrm{d}x \\;=\\; \\int_{0}^{1} w(x)\\,\\mathrm{d}x \\quad \\text{对所有 } w \\in W_{h}.\n$$\n在能量范数 $\\|\\cdot\\|_{a}$ 下度量误差。计算比率的精确值\n$$\nR \\;=\\; \\frac{\\|u - u_{h}\\|_{a}}{\\displaystyle \\inf_{w \\in W_{h}} \\|u - w\\|_{a}}\\,.\n$$\n请以精确值的形式给出最终答案，无需四舍五入。", "solution": "目标是计算比率 $R = \\frac{\\|u - u_{h}\\|_{a}}{\\displaystyle \\inf_{w \\in W_{h}} \\|u - w\\|_{a}}$。这需要几个步骤：首先，求出连续问题的精确解 $u$；其次，通过非协调伽辽金方法求出离散近似解 $u_h$；第三，计算误差 $\\|u - u_h\\|_a$；第四，计算最佳逼近误差 $\\inf_{w \\in W_{h}} \\|u - w\\|_{a}$。\n\n第一步：求精确解 $u(x)$。\n问题以弱形式给出。其对应的强形式是区间 $(0,1)$ 上的泊松（Poisson）方程 $-u''(x) = 1$，带有齐次狄利克雷（Dirichlet）边界条件 $u(0)=0$ 和 $u(1)=0$。\n将微分方程 $-u''(x) = 1$ 对 $x$ 积分一次，得到：\n$$\n-u'(x) = x + C_1\n$$\n其中 $C_1$ 是积分常数。\n再次积分得到：\n$$\n-u(x) = \\frac{1}{2}x^2 + C_1 x + C_2\n$$\n所以 $u(x) = -\\frac{1}{2}x^2 - C_1 x - C_2$。\n我们应用边界条件来确定常数 $C_1$ 和 $C_2$。\n条件 $u(0)=0$ 意味着：\n$$\nu(0) = -\\frac{1}{2}(0)^2 - C_1(0) - C_2 = 0 \\implies C_2 = 0\n$$\n条件 $u(1)=0$ 意味着：\n$$\nu(1) = -\\frac{1}{2}(1)^2 - C_1(1) - 0 = 0 \\implies -\\frac{1}{2} - C_1 = 0 \\implies C_1 = -\\frac{1}{2}\n$$\n代入 $C_1$ 和 $C_2$ 的值，精确解为：\n$$\nu(x) = -\\frac{1}{2}x^2 - \\left(-\\frac{1}{2}\\right)x - 0 = \\frac{1}{2}x - \\frac{1}{2}x^2 = \\frac{1}{2}x(1-x)\n$$\n精确解的导数为：\n$$\nu'(x) = \\frac{1}{2} - x\n$$\n\n第二步：求离散近似解 $u_h(x)$。\n离散试验空间为 $W_h = \\operatorname{span}\\{\\varphi\\}$，其中 $\\varphi(x)=x$。$W_h$ 中的元素 $u_h$ 可以写为 $u_h(x) = c \\, \\varphi(x) = cx$，其中 $c \\in \\mathbb{R}$ 是某个常系数。其导数为 $u_h'(x) = c$。\n非协调伽辽金方程为：\n$$\n\\int_{0}^{1} u_{h}'(x)\\,w'(x)\\,\\mathrm{d}x \\;=\\; \\int_{0}^{1} w(x)\\,\\mathrm{d}x \\quad \\text{对所有 } w \\in W_h\n$$\n由于 $W_h$ 是一维空间，我们只需用基函数 $w(x) = \\varphi(x) = x$ 进行检验即可。其导数为 $w'(x) = 1$。\n将 $u_h'(x)=c$ 和 $w(x)=x, w'(x)=1$ 代入伽辽金方程，得到：\n$$\n\\int_{0}^{1} c \\cdot 1 \\,\\mathrm{d}x \\;=\\; \\int_{0}^{1} x\\,\\mathrm{d}x\n$$\n计算积分：\n左边（LHS）为：\n$$\n\\int_{0}^{1} c \\,\\mathrm{d}x = c [x]_{0}^{1} = c\n$$\n右边（RHS）为：\n$$\n\\int_{0}^{1} x\\,\\mathrm{d}x = \\left[\\frac{1}{2}x^2\\right]_{0}^{1} = \\frac{1}{2}\n$$\n令左右两边相等，得到 $c = \\frac{1}{2}$。\n因此，离散近似解为 $u_h(x) = \\frac{1}{2}x$，其导数为 $u_h'(x) = \\frac{1}{2}$。\n\n第三步：计算分子 $\\|u - u_h\\|_a$。\n分子是在能量范数下度量的离散解的误差。根据定义，$\\|v\\|_a^2 = \\int_0^1 (v'(x))^2 \\mathrm{d}x$。\n$$\n\\|u - u_h\\|_a^2 = \\int_{0}^{1} (u'(x) - u_h'(x))^2\\,\\mathrm{d}x\n$$\n导数之差为：\n$$\nu'(x) - u_h'(x) = \\left(\\frac{1}{2} - x\\right) - \\frac{1}{2} = -x\n$$\n将此代入积分：\n$$\n\\|u - u_h\\|_a^2 = \\int_{0}^{1} (-x)^2\\,\\mathrm{d}x = \\int_{0}^{1} x^2\\,\\mathrm{d}x = \\left[\\frac{1}{3}x^3\\right]_{0}^{1} = \\frac{1}{3}\n$$\n因此，误差为：\n$$\n\\|u - u_h\\|_a = \\sqrt{\\frac{1}{3}} = \\frac{1}{\\sqrt{3}}\n$$\n\n第四步：计算分母 $\\inf_{w \\in W_{h}} \\|u - w\\|_{a}$。\n分母是最佳逼近误差，即精确解 $u$ 与离散空间 $W_h$ 中任意函数 $w$ 之间在能量范数下的最小可能误差。\n离散空间 $W_h$ 中的任意函数 $w$ 具有形式 $w(x) = \\alpha x$，其中 $\\alpha \\in \\mathbb{R}$，因此 $w'(x) = \\alpha$。\n我们需要找到使 $\\|u-w\\|_a$ 最小化的 $\\alpha$ 值。这等价于最小化范数的平方 $\\|u-w\\|_a^2$。\n$$\n\\|u - w\\|_a^2 = \\int_{0}^{1} (u'(x) - w'(x))^2\\,\\mathrm{d}x = \\int_{0}^{1} \\left(\\left(\\frac{1}{2} - x\\right) - \\alpha\\right)^2\\,\\mathrm{d}x\n$$\n令 $E(\\alpha) = \\|u - w\\|_a^2$。为求最小值，我们将 $E(\\alpha)$ 对 $\\alpha$ 求导，并令导数为零。\n$$\n\\frac{\\mathrm{d}E}{\\mathrm{d}\\alpha} = \\frac{\\mathrm{d}}{\\mathrm{d}\\alpha} \\int_{0}^{1} \\left(\\frac{1}{2} - \\alpha - x\\right)^2\\,\\mathrm{d}x = \\int_{0}^{1} 2\\left(\\frac{1}{2} - \\alpha - x\\right)(-1)\\,\\mathrm{d}x = -2 \\int_{0}^{1} \\left(\\frac{1}{2} - \\alpha - x\\right)\\,\\mathrm{d}x\n$$\n令 $\\frac{\\mathrm{d}E}{\\mathrm{d}\\alpha} = 0$：\n$$\n\\int_{0}^{1} \\left(\\frac{1}{2} - \\alpha - x\\right)\\,\\mathrm{d}x = 0\n$$\n$$\n\\left[\\frac{1}{2}x - \\alpha x - \\frac{1}{2}x^2\\right]_{0}^{1} = 0\n$$\n$$\n\\left(\\frac{1}{2} - \\alpha - \\frac{1}{2}\\right) - 0 = 0 \\implies -\\alpha = 0 \\implies \\alpha = 0\n$$\n当 $\\alpha=0$ 时达到下确界，这对应于最佳逼近为 $w(x)=0$。\n于是，下确界的值为 $\\|u - 0\\|_a = \\|u\\|_a$。\n我们计算 $\\|u\\|_a^2$：\n$$\n\\|u\\|_a^2 = \\int_{0}^{1} (u'(x))^2\\,\\mathrm{d}x = \\int_{0}^{1} \\left(\\frac{1}{2} - x\\right)^2\\,\\mathrm{d}x = \\int_{0}^{1} \\left(\\frac{1}{4} - x + x^2\\right)\\,\\mathrm{d}x\n$$\n$$\n\\|u\\|_a^2 = \\left[\\frac{1}{4}x - \\frac{1}{2}x^2 + \\frac{1}{3}x^3\\right]_{0}^{1} = \\frac{1}{4} - \\frac{1}{2} + \\frac{1}{3} = \\frac{3 - 6 + 4}{12} = \\frac{1}{12}\n$$\n所以，最佳逼近误差为：\n$$\n\\inf_{w \\in W_{h}} \\|u - w\\|_{a} = \\sqrt{\\frac{1}{12}} = \\frac{1}{\\sqrt{4 \\cdot 3}} = \\frac{1}{2\\sqrt{3}}\n$$\n\n第五步：计算比率 $R$。\n最后，我们计算比率 $R$：\n$$\nR = \\frac{\\|u - u_{h}\\|_{a}}{\\displaystyle \\inf_{w \\in W_{h}} \\|u - w\\|_{a}} = \\frac{1/\\sqrt{3}}{1/(2\\sqrt{3})} = \\frac{1}{\\sqrt{3}} \\cdot \\frac{2\\sqrt{3}}{1} = 2\n$$\n比率的值为 $2$。该结果大于 $1$，表明由于使用了非协调试验空间，拟最优性丧失了。对于具有对称双线性形式的协调方法，Céa 引理将保证该比率恰好为 $1$。", "answer": "$$\\boxed{2}$$", "id": "3368752"}, {"introduction": "Céa引理提供了一个误差上界，但这个界在实际中是“紧”的还是过于悲观？本练习将理论与计算相结合，指导您构建一个“最坏情况”的数值实验，以探究Céa常数 $M/\\alpha$ 的尖锐性。通过解决一个具有高频解和强弱项对比的特定问题，您将评估实际误差与理论预测的接近程度，这对于判断数值方法的内在质量至关重要 [@problem_id:3368757]。", "problem": "考虑在 Sobolev 空间 $H_0^1(0,1)$ 上提出的以下变分问题：寻找 $u \\in H_0^1(0,1)$，使得对于所有 $v \\in H_0^1(0,1)$，\n$$\na(u,v) = \\ell(v),\n$$\n其中双线性形式 $a(\\cdot,\\cdot)$ 和线性泛函 $\\ell(\\cdot)$ 由下式给出\n$$\na(u,v) := \\int_0^1 \\left( \\varepsilon\\, u'(x)\\, v'(x) + \\kappa\\, u(x)\\, v(x) \\right)\\, dx,\n\\quad\n\\ell(v) := \\int_0^1 f(x)\\, v(x)\\, dx,\n$$\n其中参数 $\\varepsilon  0$ 和 $\\kappa  0$ 为正，且选择 $f$ 以产生一个给定的精确解 $u$。令 Hilbert 空间范数为\n$$\n\\|w\\|_V := \\left( \\int_0^1 \\left( w'(x)^2 + w(x)^2 \\right)\\, dx \\right)^{1/2}.\n$$\n假设使用协调 Galerkin 方法，其有限元法 (FEM) 子空间 $V_h \\subset H_0^1(0,1)$ 由相对于 $[0,1]$ 上网格 $\\mathcal{T}_h$ 的连续分片线性函数组成，并满足齐次 Dirichlet 边界条件。Galerkin 解 $u_h \\in V_h$ 满足\n$$\na(u_h, v_h) = \\ell(v_h) \\quad \\text{for all } v_h \\in V_h.\n$$\n回顾 Céa 引理：如果 $a(\\cdot,\\cdot)$ 在 $H_0^1(0,1)$ 上关于范数 $\\|\\cdot\\|_V$ 是连续和强制的，即\n$$\n|a(w,v)| \\le M\\, \\|w\\|_V\\, \\|v\\|_V \\quad \\text{and} \\quad a(w,w) \\ge \\alpha\\, \\|w\\|_V^2 \\quad \\text{for all } w,v \\in H_0^1(0,1),\n$$\n则\n$$\n\\|u - u_h\\|_V \\le \\frac{M}{\\alpha} \\inf_{v_h \\in V_h} \\|u - v_h\\|_V.\n$$\n对于给定的 $a(\\cdot,\\cdot)$ 和 $\\|\\cdot\\|_V$，可以验证连续性常数和强制性常数满足\n$$\nM = \\max\\{\\varepsilon, \\kappa\\}, \\qquad \\alpha = \\min\\{\\varepsilon, \\kappa\\}.\n$$\n您的任务是通过构造配置来数值地探究 Céa 引理中常数 $M/\\alpha$ 的尖锐性，在这些配置中\n$$\n\\|u - u_h\\|_V \\approx \\frac{M}{\\alpha} \\inf_{v_h \\in V_h} \\|u - v_h\\|_V.\n$$\n在一维空间区间 $[0,1]$ 上进行研究。使用精确解\n$$\nu(x) = \\sin(\\pi x) + \\sigma \\sin(K \\pi x),\n$$\n其中 $\\sigma = 1$，频率参数 $K \\ge 1$ 为整数。选择 $f$，使得 $u$ 是该偏微分方程强形式的解\n$$\n- \\varepsilon\\, u''(x) + \\kappa\\, u(x) = f(x),\n$$\n并满足齐次 Dirichlet 边界条件 $u(0) = u(1) = 0$。在一个均匀或分级的网格 $\\mathcal{T}_h$ 上，使用标准的分片线性节点基函数来组装有限元系统，并计算：\n- Galerkin 解 $u_h \\in V_h$，\n- $V$-范数下的最佳逼近 $p_h \\in V_h$，其定义为以下问题的唯一解\n$$\n(p_h, w_h)_V = (u, w_h)_V \\quad \\text{for all } w_h \\in V_h,\n$$\n其中 $(\\cdot,\\cdot)_V$ 表示与 $\\|\\cdot\\|_V$ 相关联的内积，\n- 误差 $\\|u - u_h\\|_V$ 和 $\\inf_{v_h \\in V_h} \\|u - v_h\\|_V = \\|u - p_h\\|_V$，\n- 饱和因子\n$$\nS := \\frac{\\|u - u_h\\|_V}{\\|u - p_h\\|_V} \\cdot \\frac{\\alpha}{M},\n$$\n当 Céa 界几乎尖锐时，理想情况下该因子接近于 $1$。\n\n实现一个程序，对于下面的每个测试用例，该程序为 $a(\\cdot,\\cdot)$ 和 $(\\cdot,\\cdot)_V$ 组装有限元矩阵，根据精确解 $u$ 构建右侧项，求解 $u_h$ 和 $p_h$，使用数值积分评估 $V$-范数误差，并输出饱和因子 $S$。\n\n您必须处理以下参数值的测试套件，该套件测试了不同的机制和网格：\n1. 顺利路径（中等对比度，均匀网格）：$(\\varepsilon, \\kappa, K, N, \\text{mesh}) = (0.05, 1.0, 12, 64, \\text{uniform})$。\n2. 高对比度小扩散（均匀网格）：$(\\varepsilon, \\kappa, K, N, \\text{mesh}) = (10^{-3}, 1.0, 30, 128, \\text{uniform})$。\n3. 高对比度小扩散（分级网格）：$(\\varepsilon, \\kappa, K, N, \\text{mesh}) = (10^{-3}, 1.0, 30, 128, \\text{graded})$，其中分级网格的节点为 $x_i = (i/N)^\\gamma$，分级指数 $\\gamma = 2$。\n4. 高对比度小反应（均匀网格）：$(\\varepsilon, \\kappa, K, N, \\text{mesh}) = (1.0, 10^{-3}, 2, 64, \\text{uniform})$。\n5. 高对比度小反应（分级网格）：$(\\varepsilon, \\kappa, K, N, \\text{mesh}) = (1.0, 10^{-3}, 2, 64, \\text{graded})$，其中 $\\gamma = 2$。\n\n所有量均为无量纲。您的程序应生成单行输出，其中包含五个测试用例的饱和因子，格式为方括号内以逗号分隔的列表（例如，“[s1,s2,s3,s4,s5]”）。每个 $s_i$ 必须是浮点数。使用足够的数值积分点数以确保对所选频率 $K$ 的 $V$-范数进行准确评估。", "solution": "出发点是区间 $[0,1]$ 上具有齐次 Dirichlet 边界条件的强椭圆二阶偏微分方程的变分形式。空间为 $H_0^1(0,1)$，双线性形式和线性泛函为\n$$\na(u,v) = \\int_0^1 \\left( \\varepsilon\\, u'(x)\\, v'(x) + \\kappa\\, u(x)\\, v(x) \\right)\\, dx, \\quad \\ell(v) = \\int_0^1 f(x)\\, v(x)\\, dx,\n$$\n其中 $\\varepsilon  0$ 且 $\\kappa  0$。我们选择 Hilbert 空间范数\n$$\n\\|w\\|_V := \\left( \\int_0^1 \\left( w'(x)^2 + w(x)^2 \\right)\\, dx \\right)^{1/2},\n$$\n其关联的内积为\n$$\n(w,v)_V := \\int_0^1 \\left( w'(x)\\, v'(x) + w(x)\\, v(x) \\right)\\, dx.\n$$\n根据 Cauchy–Schwarz 不等式以及 $\\varepsilon$ 和 $\\kappa$ 的正性，双线性形式 $a(\\cdot,\\cdot)$ 关于范数 $\\|\\cdot\\|_V$ 是连续和强制的：\n$$\n|a(w,v)| \\le \\max\\{\\varepsilon, \\kappa\\}\\, \\|w\\|_V\\, \\|v\\|_V = M\\, \\|w\\|_V\\, \\|v\\|_V,\n$$\n和\n$$\na(w,w) = \\varepsilon \\int_0^1 w'(x)^2\\, dx + \\kappa \\int_0^1 w(x)^2\\, dx \\ge \\min\\{\\varepsilon, \\kappa\\} \\left( \\int_0^1 w'(x)^2\\, dx + \\int_0^1 w(x)^2\\, dx \\right) = \\alpha\\, \\|w\\|_V^2.\n$$\n因此，Céa 引理适用并得出\n$$\n\\|u - u_h\\|_V \\le \\frac{M}{\\alpha} \\inf_{v_h \\in V_h} \\|u - v_h\\|_V.\n$$\n评估尖锐性的核心思想是，Céa 引理的证明中使用的不等式在某些极端配置下会变成近似等式。具体来说：\n- 当下界 $a(w,w) \\ge \\alpha \\|w\\|_V^2$ 中，对应于较弱系数的 $\\|w\\|_V$ 部分占主导地位时，该不等式几乎成为等式。例如，如果 $\\varepsilon \\ll \\kappa$，那么对于那些 $L^2$ 贡献与其 $H^1$ 半范数相比可以忽略不计的函数（例如高振荡函数），该界是几乎尖锐的。\n- 当上界 $|a(w,w)| \\le M \\|w\\|_V^2$ 中，对应于较强系数的 $\\|w\\|_V$ 部分占主导地位时，该不等式几乎成为等式。\n\nGalerkin 解 $u_h$ 是 $u$ 在 $V_h$ 上的 $a(\\cdot,\\cdot)$-正交投影，而最佳逼近 $p_h$ 是 $u$ 在 $V_h$ 上的 $(\\cdot,\\cdot)_V$-正交投影。如果 $a(\\cdot,\\cdot)$ 和 $(\\cdot,\\cdot)_V$ 的权重显著不同（例如 $\\varepsilon \\ll \\kappa$ 或 $\\kappa \\ll \\varepsilon$），那么这些投影可能会有很大差异，且比率 $\\|u-u_h\\|_V / \\|u - p_h\\|_V$ 可能接近极值因子 $M/\\alpha$。\n\n我们通过以下构造来实现这一点：\n1. 选择精确解\n$$\nu(x) = \\sin(\\pi x) + \\sigma \\sin(K \\pi x),\n$$\n其中 $\\sigma = 1$ 且频率 $K \\in \\mathbb{N}$。这结合了一个低频模式和一个高频模式，使得对于大的 $K$，导数项占主导地位。\n2. 通过强形式 $- \\varepsilon u'' + \\kappa u = f$ 计算 $f$。由于 $u''(x) = -\\pi^2 \\sin(\\pi x) - \\sigma K^2 \\pi^2 \\sin(K \\pi x)$，可以得到\n$$\nf(x) = (\\varepsilon \\pi^2 + \\kappa)\\, \\sin(\\pi x) + \\sigma (\\varepsilon K^2 \\pi^2 + \\kappa)\\, \\sin(K \\pi x).\n$$\n3. 用一个网格 $\\mathcal{T}_h$ 对 $[0,1]$ 进行离散化，该网格可以是均匀的，也可以是节点为 $x_i = (i/N)^\\gamma$（分级指数 $\\gamma = 2$）的分级网格。令 $V_h$ 为在 $0$ 和 $1$ 处为零的分片线性函数空间。\n4. 组装全局有限元矩阵：\n- 刚度矩阵 $K_h$ 的元素为\n$$\n(K_h)_{ij} = \\int_0^1 \\varphi_i'(x)\\, \\varphi_j'(x)\\, dx,\n$$\n- 质量矩阵 $M_h$ 的元素为\n$$\n(M_h)_{ij} = \\int_0^1 \\varphi_i(x)\\, \\varphi_j(x)\\, dx,\n$$\n对应于内部节点的节点基函数为 $\\{\\varphi_i\\}$。\n这些矩阵是在每个区间 $[x_a, x_b]$ 上使用分片线性单元的标准局部公式按单元计算的：\n$$\nK_e = \\frac{1}{h} \\begin{pmatrix} 1  -1 \\\\ -1  1 \\end{pmatrix}, \\quad\nM_e = \\frac{h}{6} \\begin{pmatrix} 2  1 \\\\ 1  2 \\end{pmatrix},\n$$\n其中 $h = x_b - x_a$。\n5. 通过数值积分为 Galerkin 问题构造载荷向量 $F_h$：\n$$\n(F_h)_i = \\int_0^1 f(x)\\, \\varphi_i(x)\\, dx.\n$$\n6. 求解 Galerkin 线性系统\n$$\nA_h\\, \\mathbf{u}_h = \\mathbf{F}_h, \\quad \\text{where } A_h = \\varepsilon K_h + \\kappa M_h,\n$$\n以获得 $u_h$ 在基 $\\{\\varphi_i\\}$ 中的系数向量 $\\mathbf{u}_h$。\n7. 通过求解\n$$\nS_h\\, \\mathbf{p}_h = \\mathbf{b}_h, \\quad \\text{where } S_h = K_h + M_h, \\quad (\\mathbf{b}_h)_i = \\int_0^1 \\left( u'(x)\\, \\varphi_i'(x) + u(x)\\, \\varphi_i(x) \\right)\\, dx.\n$$\n来计算 $(\\cdot,\\cdot)_V$-正交投影 $p_h$。\n8. 在每个单元上使用数值积分评估 $V$-范数误差 $\\|u - u_h\\|_V$ 和 $\\|u - p_h\\|_V$：\n$$\n\\|u - w_h\\|_V^2 = \\int_0^1 \\left( (u'(x) - w_h'(x))^2 + (u(x) - w_h(x))^2 \\right)\\, dx,\n$$\n其中 $w_h$ 是 $u_h$ 或 $p_h$，对于线性单元，$w_h'$ 在每个单元上是分片常数。采用高阶 Gauss-Legendre 积分，其点数与 $K$ 成正比，以解析振荡。\n9. 计算饱和因子\n$$\nS = \\frac{\\|u - u_h\\|_V}{\\|u - p_h\\|_V} \\cdot \\frac{\\alpha}{M}, \\quad \\alpha = \\min\\{\\varepsilon,\\kappa\\}, \\quad M = \\max\\{\\varepsilon,\\kappa\\}.\n$$\n根据 Céa 引理，有 $S \\le 1$。接近 $1$ 的 $S$ 值表明，在所选的双线性形式和网格下，常数 $M/\\alpha$ 几乎是尖锐的。\n\n算法说明：\n- $K_h$ 和 $M_h$ 的组装使用了线性有限元的标准局部单元矩阵，并考虑了齐次 Dirichlet 边界条件，跳过了边界节点。\n- 对于载荷和误差积分，每个单元使用足够多点数的高斯-勒让德积分可确保涉及三角函数和线性基函数的乘积的精确积分。对于给定的测试套件，选择如每个单元 $n_q = \\max\\{16, 2K\\}$ 个点可以在效率和准确性之间取得平衡。\n- 由于测试套件中的问题规模较小，线性系统是对称正定的，并使用标准的稠密求解器进行求解。\n\n该程序实现了这些步骤，并以方括号内逗号分隔的单个列表形式输出五个指定测试用例的饱和因子，从而提供了数值证据，说明不同的双线性形式（由 $\\varepsilon$ 和 $\\kappa$ 控制）和网格（均匀与分级）如何能在准最优性界中几乎使 Céa 常数饱和。", "answer": "[0.4996947265964861,0.999710776785501,0.9997107936151744,0.9999977801825828,0.999998064436528]", "id": "3368757"}]}