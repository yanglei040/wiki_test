{"hands_on_practices": [{"introduction": "这个首个练习提供了一个具体的起点。通过在一个小网格上构建最简单的分部求和（SBP）算子，你将直接接触微分矩阵（$D$）、范数矩阵（$H$）和边界矩阵（$B$）。通过计算验证SBP恒等式 $H D + D^T H = B$，可以巩固对这一核心代数性质的理解，该性质在离散层面模仿了分部积分。", "problem": "考虑在均匀网格上带对角范数的一阶导数分部求和（SBP）有限差分算子。设计算域为区间 $[0,1]$，有 $N=5$ 个网格点，均匀间距为 $h=\\frac{1}{4}$，节点为 $x_i=(i-1)h$，$i=1,2,3,4,5$。一个带对角范数的一阶导数 SBP 算子由一个对称正定对角矩阵 $H \\in \\mathbb{R}^{N \\times N}$ 和一个差分算子 $D \\in \\mathbb{R}^{N \\times N}$ 组成，它们满足离散分部积分恒等式 $H D + D^{T} H = B$，其中 $B$ 捕捉了来自端点的贡献。内部二阶精度（带一阶边界封口）的对角范数 SBP 算子是满足以下条件的最小宽度选择：(i) 一阶精度的单边边界近似，(ii) 二阶精度的中心内部差分，以及 (iii) 分部求和恒等式，其中 $B$ 是提取端点贡献的对角矩阵。\n\n针对 $N=5$ 个节点，构造一个满足这些条件的二阶对角范数 SBP 算子的显式对角矩阵 $H$ 和矩阵 $D$，然后通过构造残差矩阵 $R := H D + D^{T} H - B$ 来验证 SBP 恒等式，其中 $B=\\operatorname{diag}(-1,0,0,0,1)$。\n\n残差矩阵 $R$ 的弗罗贝尼乌斯范数，即 $\\|R\\|_{F}$ 的值是多少？请将最终答案表示为没有四舍五入的精确数。", "solution": "用户需要为一阶导数构造一个特定的分部求和（SBP）算子，然后通过计算一个残差矩阵的弗罗贝尼乌斯范数来验证其定义属性。\n\n### 步骤 1：问题陈述的验证\n首先根据所需标准对问题进行验证。\n\n**1. 提取已知条件：**\n*   **主题：** 一阶导数分部求和（SBP）有限差分算子。\n*   **范数类型：** 对角范数。\n*   **定义域：** $[0, 1]$。\n*   **网格点数：** $N=5$。\n*   **网格间距：** $h = \\frac{1}{4}$。\n*   **节点位置：** $x_i = (i-1)h$，$i=1, 2, 3, 4, 5$。\n*   **SBP 恒等式：** $H D + D^{T} H = B$。\n*   **算子 $H$：** 对称正定对角矩阵，$H \\in \\mathbb{R}^{N \\times N}$。\n*   **算子 $D$：** 差分算子，$D \\in \\mathbb{R}^{N \\times N}$。\n*   **边界矩阵 $B$：** $B = \\operatorname{diag}(-1, 0, 0, 0, 1)$。\n*   **精度要求：**\n    *   内部精度：二阶 ($O(h^2)$)，使用中心差分。\n    *   边界精度：一阶 ($O(h)$)，使用单边差分。\n*   **任务：** 构造 $H$ 和 $D$，然后计算残差矩阵 $R := H D + D^{T} H - B$ 的弗罗贝尼乌斯范数 $\\|R\\|_F$。\n\n**2. 使用提取的已知条件进行验证：**\n*   **科学依据：** 该问题牢固地植根于已建立的偏微分方程（PDE）数值方法理论。SBP 算子是科学计算领域一个标准且经过深入研究的课题。\n*   **适定性：** 该问题是适定的。所提供的约束条件（点数、网格间距、精度阶数、对角范数）足以唯一确定所讨论的最小宽度 SBP 算子。任务是一个直接计算。\n*   **客观性：** 该问题以精确、客观的数学语言陈述。\n*   **完整性与一致性：** 该问题是自洽的，其所有部分都是一致的。SBP 算子的定义、其期望属性以及边界项矩阵 $B$ 都是标准的且相互兼容。\n\n**3. 结论：**\n该问题是有效的。这是一个关于构造和验证标准数值算子的定义明确的练习。\n\n### 步骤 2：求解\n求解过程首先根据指定的属性构造微分矩阵 $D$ 和范数矩阵 $H$，然后验证 SBP 恒等式。\n\n**微分矩阵 $D$ 的构造**\n矩阵 $D$ 近似一阶导数。其行由指定的有限差分格式确定。网格间距为 $h = \\frac{1}{4}$。\n\n*   **内部点 ($i=2, 3, 4$):** 函数 $u$ 在点 $x_i$ 处导数的二阶精度中心差分格式由 $\\frac{u_{i+1} - u_{i-1}}{2h}$ 给出。当 $h=\\frac{1}{4}$ 时，前置因子为 $\\frac{1}{2h} = 2$。\n    *   在 $i=2$ 处，格式使用点 $1$ 和 $3$，得到行向量 $[ -2, 0, 2, 0, 0 ]$。\n    *   在 $i=3$ 处，格式使用点 $2$ 和 $4$，得到行向量 $[ 0, -2, 0, 2, 0 ]$。\n    *   在 $i=4$ 处，格式使用点 $3$ 和 $5$，得到行向量 $[ 0, 0, -2, 0, 2 ]$。\n\n*   **边界点 ($i=1, 5$):** 使用一阶精度的单边差分格式。\n    *   在左边界 $i=1$ 处，使用向前差分：$\\frac{u_2 - u_1}{h}$。当 $h=\\frac{1}{4}$ 时，前置因子为 $\\frac{1}{h} = 4$。这给出行向量 $[ -4, 4, 0, 0, 0 ]$。\n    *   在右边界 $i=5$ 处，使用向后差分：$\\frac{u_5 - u_4}{h}$。这给出行向量 $[ 0, 0, 0, -4, 4 ]$。\n\n组合这些行，矩阵 $D$ 为：\n$$\nD = \\begin{pmatrix}\n-4  & 4  & 0  & 0 & 0 \\\\\n-2  & 0  & 2  & 0 & 0 \\\\\n0  & -2  & 0  & 2 & 0 \\\\\n0  & 0  & -2  & 0 & 2 \\\\\n0  & 0  & 0  & -4 & 4\n\\end{pmatrix}\n$$\n\n**范数矩阵 $H$ 的构造**\n矩阵 $H$ 定义了离散内积（范数）。对于一个内部二阶精度的对角范数 SBP 算子，其对角线上的权重源自梯形求积法则，以确保离散范数是连续 $L^2$ 范数 $\\int_0^1 u(x)^2 dx$ 的一个高阶近似。内部点的权重为 $h$，边界点的权重为 $h/2$。\n\n当 $h = \\frac{1}{4}$ 时，$H$ 的对角元素为：\n$H_{11} = H_{55} = \\frac{h}{2} = \\frac{1}{8}$\n$H_{22} = H_{33} = H_{44} = h = \\frac{1}{4}$\n\n所以，矩阵 $H$ 为：\n$$\nH = \\operatorname{diag}\\left(\\frac{1}{8}, \\frac{1}{4}, \\frac{1}{4}, \\frac{1}{4}, \\frac{1}{8}\\right)\n$$\n\n**SBP 恒等式的验证**\n问题的核心是验证 SBP 恒等式 $H D + D^T H = B$。我们计算左侧，$Q = H D + D^T H$。\n\n首先，我们计算 $HD$：\n$$\nHD = \\begin{pmatrix}\n1/8 & 0 & 0 & 0 & 0 \\\\\n0 & 1/4 & 0 & 0 & 0 \\\\\n0 & 0 & 1/4 & 0 & 0 \\\\\n0 & 0 & 0 & 1/4 & 0 \\\\\n0 & 0 & 0 & 0 & 1/8\n\\end{pmatrix}\n\\begin{pmatrix}\n-4 & 4 & 0 & 0 & 0 \\\\\n-2 & 0 & 2 & 0 & 0 \\\\\n0 & -2 & 0 & 2 & 0 \\\\\n0 & 0 & -2 & 0 & 2 \\\\\n0 & 0 & 0 & -4 & 4\n\\end{pmatrix}\n= \\begin{pmatrix}\n-1/2 & 1/2 & 0 & 0 & 0 \\\\\n-1/2 & 0 & 1/2 & 0 & 0 \\\\\n0 & -1/2 & 0 & 1/2 & 0 \\\\\n0 & 0 & -1/2 & 0 & 1/2 \\\\\n0 & 0 & 0 & -1/2 & 1/2\n\\end{pmatrix}\n$$\n\n接下来，我们计算 $D^T H$。$D$ 的转置是：\n$$\nD^T = \\begin{pmatrix}\n-4 & -2 & 0 & 0 & 0 \\\\\n4 & 0 & -2 & 0 & 0 \\\\\n0 & 2 & 0 & -2 & 0 \\\\\n0 & 0 & 2 & 0 & -4 \\\\\n0 & 0 & 0 & 2 & 4\n\\end{pmatrix}\n$$\n$$\nD^T H = \\begin{pmatrix}\n-4 & -2 & 0 & 0 & 0 \\\\\n4 & 0 & -2 & 0 & 0 \\\\\n0 & 2 & 0 & -2 & 0 \\\\\n0 & 0 & 2 & 0 & -4 \\\\\n0 & 0 & 0 & 2 & 4\n\\end{pmatrix}\n\\begin{pmatrix}\n1/8 & 0 & 0 & 0 & 0 \\\\\n0 & 1/4 & 0 & 0 & 0 \\\\\n0 & 0 & 1/4 & 0 & 0 \\\\\n0 & 0 & 0 & 1/4 & 0 \\\\\n0 & 0 & 0 & 0 & 1/8\n\\end{pmatrix}\n= \\begin{pmatrix}\n-1/2 & -1/2 & 0 & 0 & 0 \\\\\n1/2 & 0 & -1/2 & 0 & 0 \\\\\n0 & 1/2 & 0 & -1/2 & 0 \\\\\n0 & 0 & 1/2 & 0 & -1/2 \\\\\n0 & 0 & 0 & 1/2 & 1/2\n\\end{pmatrix}\n$$\n\n现在，我们将两个矩阵相加：\n$$\nQ = HD + D^T H = \\begin{pmatrix}\n-1/2 & 1/2 & 0 & 0 & 0 \\\\\n-1/2 & 0 & 1/2 & 0 & 0 \\\\\n0 & -1/2 & 0 & 1/2 & 0 \\\\\n0 & 0 & -1/2 & 0 & 1/2 \\\\\n0 & 0 & 0 & -1/2 & 1/2\n\\end{pmatrix} + \\begin{pmatrix}\n-1/2 & -1/2 & 0 & 0 & 0 \\\\\n1/2 & 0 & -1/2 \n; 0  0 \\\\\n0  1/2  0  -1/2  0 \\\\\n0  0  1/2  0  -1/2 \\\\\n0  0  0  1/2  1/2\n\\end{pmatrix}\n$$\n$$\nQ = \\begin{pmatrix}\n-1  0  0  0  0 \\\\\n0  0  0  0  0 \\\\\n0  0  0  0  0 \\\\\n0  0  0  0  0 \\\\\n0  0  0  0  1\n\\end{pmatrix}\n$$\n这个结果矩阵恰好是给定的边界矩阵 $B = \\operatorname{diag}(-1, 0, 0, 0, 1)$。\n\n**残差及其范数的计算**\n残差矩阵定义为 $R = H D + D^{T} H - B$。\n从上一步中，我们已经证明了 $H D + D^{T} H = B$。因此，\n$$\nR = B - B = \\mathbf{0}\n$$\n其中 $\\mathbf{0}$ 是 $5 \\times 5$ 的零矩阵。\n\n矩阵 $R$ 的弗罗贝尼乌斯范数定义为 $\\|R\\|_F = \\sqrt{\\sum_{i=1}^N \\sum_{j=1}^N |R_{ij}|^2}$。\n对于零矩阵，每个元素 $R_{ij}=0$。因此，弗罗贝尼乌斯范数为：\n$$\n\\|R\\|_F = \\sqrt{\\sum_{i=1}^5 \\sum_{j=1}^5 0^2} = 0\n$$\n\n结果是精确的，因为 SBP 算子是为满足此代数恒等式而专门构造的。", "answer": "$$\n\\boxed{0}\n$$", "id": "3451180"}, {"introduction": "在简单案例的基础上，本练习将挑战你设计一个更高阶的SBP算子。你将学习如何将精度要求转化为一个“矩条件”系统，并将其与SBP性质所带来的代数约束相结合 [@problem_id:3451184]。这个练习展示了在研究和软件开发中创建定制化、高性能数值算子时所使用的系统化过程。", "problem": "考虑一个一维守恒律，定义在包含 $N+1$ 个节点 $x_i = i h$（$i = 0,1,\\dots,N$，$h = 1/N$）的均匀网格上。构建一个适用于同步近似项（SAT）边界处理的、具有对角范数的一阶导数分部求和（SBP）算子。设 SBP 算子定义为 $\\mathbf{D} = \\mathbf{H}^{-1} \\mathbf{Q}$，其中 $\\mathbf{H} = h \\, \\mathrm{diag}(w_0,w_1,\\dots,w_N)$ 是一个由求积权重组成的对角正定矩阵，而 $\\mathbf{Q}$ 满足 SBP 恒等式 $\\mathbf{Q} + \\mathbf{Q}^{\\top} = \\mathbf{B}$，其中 $\\mathbf{B} = \\mathrm{diag}(-1,0,\\dots,0,1)$。目标内部精度为 $2p = 4$ 阶，边界精度为 $p = 2$ 阶。\n\n假设 $\\mathbf{D}$ 在行 $i = 2,3,\\dots,N-2$ 上的内部格式为标准的四阶精度中心有限差分，\n$$\n(\\mathbf{D} \\mathbf{u})_i \\;=\\; \\frac{1}{12 h} \\left(-\\mathbf{u}_{i+2} + 8 \\mathbf{u}_{i+1} - 8 \\mathbf{u}_{i-1} + \\mathbf{u}_{i-2}\\right).\n$$\n对于 $i = 0$ 处的左边界封闭格式，设 $(\\mathbf{D}\\mathbf{u})_0 = \\frac{1}{h}\\sum_{j=0}^{4} a_j \\mathbf{u}_j$，其中未知的边界封闭系数 $a_j$ 必须满足确保边界精度为 $p = 2$ 阶的矩条件。具体来说，对于单项式 $\\mathbf{u}(x) = x^m$（$m = 0,1,2$），\n$$\n\\sum_{j=0}^{4} a_j \\, j^m \\;=\\; m \\cdot 0^{m-1}\n$$\n其中，当 $m \\geq 2$ 时，$0^{m-1}$ 解释为 $0$；当 $m=1$ 时，解释为 $1$。此外，施加 $\\mathbf{Q}$ 与边界封闭格式之间的 SBP 关系，即对于 $j=0,1,2,3,4$，有 $Q_{0j} = w_0 a_j$，同时有 $Q_{00} = -\\tfrac{1}{2}$ 和对于 $j \\geq 1$ 的斜对称性 $Q_{0j} + Q_{j0} = 0$。假设最小半带宽为 3，因此 $a_4 = 0$，并且内部格式从第 $i = 2$ 行开始。使用第 $i=2$ 行的内部格式和 SBP 恒等式来解出边界封闭格式中任何剩余的自由度。\n\n从这些条件和 SBP 结构出发，建立并求解所得到的线性代数矩系统和 SBP 约束，以确定四阶（$2p=4$）对角范数 SBP 算子在左边界处的对角范数权重 $w_0$。将 $w_0$ 的最终结果表示为一个精确的简分数。不需要四舍五入，也不应报告任何单位。", "solution": "目标是确定一个四阶精度分部求和（SBP）算子在左边界处的对角范数权重 $w_0$。推导过程是通过根据给定的精度和 SBP 条件，为未知的边界封闭系数和权重 $w_0$ 建立一个线性代数方程组。\n\n问题指定了一个一阶导数 SBP 算子 $\\mathbf{D} = \\mathbf{H}^{-1}\\mathbf{Q}$，其中 $\\mathbf{H} = h \\, \\mathrm{diag}(w_0, w_1, \\dots, w_N)$ 是对角范数矩阵，而 $\\mathbf{Q}$ 是满足 SBP 属性 $\\mathbf{Q} + \\mathbf{Q}^\\top = \\mathbf{B} = \\mathrm{diag}(-1, 0, \\dots, 0, 1)$ 的矩阵。在左边界（$i=0$）处的边界封闭格式由下式给出\n$$ (\\mathbf{D}\\mathbf{u})_0 = \\frac{1}{h}\\sum_{j=0}^{4} a_j \\mathbf{u}_j $$\n未知系数 $a_j$ 和权重 $w_0$ 必须满足几个条件。\n\n首先，边界精度为 $p=2$ 阶。这意味着边界上的有限差分公式对于所有次数直到 $m=2$ 的单项式 $\\mathbf{u}(x) = x^m$ 都必须是精确的。条件是数值导数必须与在 $x=0$ 处的解析导数相匹配。\n对于 $u(x) = x^m$ 在 $x_0=0$ 处的数值导数是：\n$$ (\\mathbf{D}u)_0 = \\frac{1}{h} \\sum_{j=0}^{4} a_j (x_j)^m = \\frac{1}{h} \\sum_{j=0}^{4} a_j (jh)^m = h^{m-1} \\sum_{j=0}^{4} a_j j^m $$\n在 $x=0$ 处的解析导数是 $u'(0) = [mx^{m-1}]_{x=0}$。\n为了使算子精确到 $m=2$ 次，我们必须有 $h^{m-1} \\sum_{j=0}^{4} a_j j^m = [mx^{m-1}]_{x=0}$，对于 $m=0, 1, 2$。\n这就产生了以下矩条件：\n\\begin{itemize}\n    \\item 对于 $m=0$：$u(x)=x^0=1$，$u'(0)=0$。条件是 $\\frac{1}{h}\\sum a_j = 0 \\implies \\sum_{j=0}^{4} a_j = 0$。\n    \\item 对于 $m=1$：$u(x)=x^1=x$，$u'(0)=1$。条件是 $\\sum a_j j = 1$。\n    \\item 对于 $m=2$：$u(x)=x^2$，$u'(0)=0$。条件是 $h \\sum a_j j^2 = 0 \\implies \\sum a_j j^2 = 0$。\n\\end{itemize}\n问题说明 $a_4=0$，因此求和实际上是从 $j=0$到$j=3$。矩条件为：\n\\begin{align}\n    a_0 + a_1 + a_2 + a_3 = 0 \\quad (1) \\\\\n    a_1 + 2a_2 + 3a_3 = 1 \\quad (2) \\\\\n    a_1 + 4a_2 + 9a_3 = 0 \\quad (3)\n\\end{align}\n\n其次，我们引入由 SBP 结构施加的约束。关系 $\\mathbf{D} = \\mathbf{H}^{-1}\\mathbf{Q}$ 意味着 $\\mathbf{Q} = \\mathbf{H}\\mathbf{D}$。$\\mathbf{Q}$ 的元素是 $Q_{ij} = H_{ii}D_{ij} = (h w_i)D_{ij}$。\n根据边界封闭格式的定义，$\\mathbf{D}$ 第一行的元素是 $D_{0j} = a_j/h$。因此，对于 $\\mathbf{Q}$ 的第一行，我们有 $Q_{0j} = H_{00} D_{0j} = (h w_0) (a_j/h) = w_0 a_j$。\nSBP 属性 $\\mathbf{Q} + \\mathbf{Q}^\\top = \\mathbf{B}$ 提供了两个关键约束：\n\\begin{enumerate}\n    \\item 对于对角元素 $(0,0)$：$Q_{00} + Q_{00} = B_{00} = -1 \\implies 2Q_{00} = -1 \\implies Q_{00} = -1/2$。结合 $Q_{00} = w_0 a_0$，我们得到：\n    $$ w_0 a_0 = -\\frac{1}{2} \\quad (4) $$\n    \\item 对于非对角元素，例如 $(0,2)$：$Q_{02} + Q_{20} = B_{02} = 0$。第一项是 $Q_{02} = w_0 a_2$。第二项是 $Q_{20} = H_{22}D_{20} = (h w_2) D_{20}$。问题指定对第 $i=2$ 行使用四阶内部格式：\n    $$ (\\mathbf{D} \\mathbf{u})_2 = \\frac{1}{12 h} ( \\mathbf{u}_{0} - 8 \\mathbf{u}_{1} + 8 \\mathbf{u}_{3} - \\mathbf{u}_{4} ) $$\n    从 $(\\mathbf{D} \\mathbf{u})_2$ 的格式可知，$\\mathbf{u}_0$ 的系数是 $D_{20} = \\frac{1}{12h}$。对于一个基于中心差分的标准 $2p=4$ SBP 算子，内部求积权重对于 $i \\ge p=2$ 是 $w_i=1$。因此，我们设定 $w_2=1$。\n    $$ Q_{20} = (h \\cdot 1) \\left(\\frac{1}{12h}\\right) = \\frac{1}{12} $$\n    约束 $Q_{02} + Q_{20} = 0$ 变为 $w_0 a_2 + 1/12 = 0$：\n    $$ w_0 a_2 = -\\frac{1}{12} \\quad (5) $$\n\\end{enumerate}\n\n现在我们得到了一个关于五个未知数 $a_0, a_1, a_2, a_3, w_0$ 的五个方程的方程组。让我们来解这个方程组。\n首先，我们从方程 $(1), (2), (3)$ 求解 $a_1, a_2, a_3$ 的线性系统。\n从 $(2)$ 和 $(3)$：\n(3) 减去 (2)：$(a_1 + 4a_2 + 9a_3) - (a_1 + 2a_2 + 3a_3) = 0 - 1 \\implies 2a_2 + 6a_3 = -1$。\n这给出 $a_2 = -3a_3 - \\frac{1}{2}$。\n将 $a_2$ 代入 $(2)$：$a_1 + 2(-3a_3 - \\frac{1}{2}) + 3a_3 = 1 \\implies a_1 - 6a_3 - 1 + 3a_3 = 1 \\implies a_1 - 3a_3 = 2$，所以 $a_1 = 3a_3 + 2$。\n将 $a_1$ 和 $a_2$ 代入 $(1)$：$a_0 + (3a_3 + 2) + (-3a_3 - \\frac{1}{2}) + a_3 = 0 \\implies a_0 + a_3 + \\frac{3}{2} = 0$。\n这给出了用 $a_0$ 表示的 $a_3$：$a_3 = -a_0 - \\frac{3}{2}$。\n现在我们可以用 $a_0$ 来表示 $a_2$：\n$a_2 = -3a_3 - \\frac{1}{2} = -3(-a_0 - \\frac{3}{2}) - \\frac{1}{2} = 3a_0 + \\frac{9}{2} - \\frac{1}{2} = 3a_0 + \\frac{8}{2} = 3a_0 + 4$。\n\n我们找到了 $a_2$ 和 $a_0$ 之间的线性关系：\n$$ a_2 = 3a_0 + 4 $$\n从方程 $(4)$ 和 $(5)$，我们可以用 $w_0$ 来表示 $a_0$ 和 $a_2$：\n$a_0 = -\\frac{1}{2w_0}$\n$a_2 = -\\frac{1}{12w_0}$\n\n将这些代入关系式 $a_2 = 3a_0 + 4$ 中：\n$$ -\\frac{1}{12w_0} = 3\\left(-\\frac{1}{2w_0}\\right) + 4 $$\n$$ -\\frac{1}{12w_0} = -\\frac{3}{2w_0} + 4 $$\n为了求解 $w_0$，我们可以将整个方程乘以 $12w_0$（由于 $\\mathbf{H}$ 是正定的，该值非零）：\n$$ -1 = -3 \\cdot \\frac{12}{2} + 4 \\cdot (12w_0) $$\n$$ -1 = -18 + 48w_0 $$\n$$ 17 = 48w_0 $$\n$$ w_0 = \\frac{17}{48} $$\n所得到的权重 $w_0$ 是一个正有理数，这对于对角范数 SBP 算子是符合预期的。分数 $17/48$ 是其最简形式，因为 $17$ 是一个素数，而 $48$ 不是 $17$ 的倍数。", "answer": "$$\\boxed{\\frac{17}{48}}$$", "id": "3451184"}, {"introduction": "SBP算子的真正威力在于其与同步近似项（SAT）方法结合以施加边界条件。这最后一个练习将指导你对平流方程进行能量分析，展示SBP-SAT框架如何导出一个可证明稳定的数值格式 [@problem_id:3451160]。你将看到如何选择SAT罚项来耗散边界能量，这是稳健求解双曲型偏微分方程的一项关键技术。", "problem": "考虑空间域 $[0,1]$ 上的一维线性平流方程 $u_t + c\\,u_x = 0$，其中平流速度 $c0$ 为常数，且所有单位均为无量纲。您将使用分部求和（SBP）一阶导数算子和同步近似项（SAT）边界处理方法构建一个半离散近似，并将其与一个通过拉伸坐标诱导的阻尼剖面 $\\alpha(x)\\ge 0$ 建模的完美匹配层（PML）耦合。\n\n基本和核心定义：\n- 分部求和（SBP）算子：一个对角范数的SBP一阶导数矩阵 $D\\in\\mathbb{R}^{N\\times N}$（网格间距为 $h$）和一个对称正定的范数矩阵 $H\\in\\mathbb{R}^{N\\times N}$ 满足离散分部积分恒等式 $H D + D^\\top H = B$，其中 $B = \\mathrm{diag}(-1, 0, \\dots, 0, 1)$。\n- 同步近似项（SAT）：一种通过添加由 $H^{-1}$ 和边界点选择器缩放的项来弱施加边界数据的惩罚项。\n- 完美匹配层（PML）：在此通过一个拉伸坐标阻尼剖面进行建模，该剖面为偏微分方程增加了一个对角衰减项 $-\\alpha(x) u$。\n\n离散化设置：\n- 在 $[0,1]$ 上使用 $N$ 个等距网格点 $x_i = i h$，$i\\in\\{0,\\dots,N-1\\}$，其中 $h = 1/(N-1)$。\n- 令 $H = \\mathrm{diag}(h/2, h, \\dots, h, h/2)$ 为对角SBP范数。\n- 令 $D$ 为二阶精度的对角范数SBP一阶导数：\n  - 在内部点 $i \\in \\{1,\\dots,N-2\\}$ 处，$(D u)_i = (u_{i+1} - u_{i-1})/(2h)$。\n  - 在左边界 $i=0$ 处，$(D u)_0 = (u_1 - u_0)/h$。\n  - 在右边界 $i=N-1$ 处，$(D u)_{N-1} = (u_{N-1} - u_{N-2})/h$。\n- 定义PML阻尼剖面，其基线为 $\\alpha_00$，并在宽度为 $w\\in(0,1)$ 的右边界附近有一个斜坡：\n  - 对于 $x \\le 1-w$，设置 $\\alpha(x) = \\alpha_0$。\n  - 对于 $x  1-w$，设置 $\\alpha(x) = \\alpha_0 + \\alpha_{\\max}\\,\\left(\\frac{x-(1-w)}{w}\\right)^p$，其中指数 $p\\in\\mathbb{N}$。\n- 在 $x=0$ 处通过SAT方法实现齐次狄利克雷流入，惩罚系数为 $\\tau_L0$。对于 $c0$，在流出边界 $x=1$ 处没有SAT项。\n\n半离散系统：\n- 令 $e_0 \\in \\mathbb{R}^N$ 为一个向量，其分量 $(e_0)_0=1$，其余分量为零。定义半离散算子\n  $$ L = -c\\,D - \\mathrm{diag}(\\alpha) - \\tau_L\\,H^{-1}\\,e_0 e_0^\\top, $$\n  以及常微分方程 $u'(t) = L\\,u(t)$。\n- 定义离散能量 $E(t) = u(t)^\\top H u(t)$。\n\n推导目标：\n- 从SBP恒等式、半离散能量法以及上述定义出发，推导离散能量等式\n  $$ \\frac{d}{dt} E(t) = u(t)^\\top \\left(HL + L^\\top H\\right) u(t) $$\n  并证明对于选择 $\\tau_L \\ge c$ 以及处处存在的基线阻尼 $\\alpha_00$，离散能量满足\n  $$ \\frac{d}{dt}\\|u(t)\\|_H^2 \\le -\\beta\\,\\|u(t)\\|_H^2, \\quad \\text{其中} \\quad \\beta = 2\\min_{x\\in[0,1]}\\alpha(x). $$\n  解释为什么 $x=1$ 附近的PML斜坡不会降低此界限，以及SAT流入惩罚项如何消除可能存在的非耗散左边界贡献。\n\n算法任务：\n- 按照规定实现矩阵 $H$、$D$ 和 $L$。\n- 构建对称矩阵 $S = HL + L^\\top H$。\n- 计算矩阵束 $(-S, H)$ 的最小广义特征值，记为 $\\beta_{\\mathrm{num}} = \\lambda_{\\min}(-S, H)$，它在不等式 $\\frac{d}{dt}E(t)\\le -\\beta_{\\mathrm{num}} E(t)$ 中提供了最优的一致衰减常数。\n- 对于下面测试套件中的每个测试用例，将计算出的 $\\beta_{\\mathrm{num}}$ 作为浮点数输出。\n\n测试套件：\n- 用例1：$c=1.0$, $N=50$, $w=0.2$, $\\alpha_0=0.01$, $\\alpha_{\\max}=10.0$, $p=2$, $\\tau_L=c$。\n- 用例2：$c=1.0$, $N=80$, $w=0.3$, $\\alpha_0=0.05$, $\\alpha_{\\max}=20.0$, $p=3$, $\\tau_L=c$。\n- 用例3：$c=0.5$, $N=60$, $w=0.1$, $\\alpha_0=0.02$, $\\alpha_{\\max}=5.0$, $p=2$, $\\tau_L=c$。\n- 用例4：$c=3.0$, $N=100$, $w=0.25$, $\\alpha_0=0.01$, $\\alpha_{\\max}=40.0, $p=4$, $\\tau_L=c$。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，按测试用例的顺序列出结果，例如 $\\left[\\beta_{\\mathrm{num},1},\\beta_{\\mathrm{num},2},\\beta_{\\mathrm{num},3},\\beta_{\\mathrm{num},4}\\right]$。\n\n所有量均为无量纲。不使用角度。无需物理单位。最终结果必须是浮点数。", "solution": "问题陈述已经过验证，被认为是合理的。它在偏微分方程数值方法的理论中有坚实的科学基础，是自洽的，并且是适定的。我们可以开始求解。\n\n目标有两方面：首先，对给定的半离散系统进行离散能量分析，以推导指定的能量衰减不等式；其次，对系统进行数值实现，为一系列测试用例计算最优衰减常数。\n\n让我们从推导开始。离散能量定义为 $E(t) = u(t)^\\top H u(t)$，其中 $u(t)$ 是解的节点值向量，$H$ 是对称正定的SBP范数矩阵。对能量求时间导数，我们得到：\n$$\n\\frac{dE}{dt} = \\frac{d}{dt}\\left(u^\\top H u\\right) = u'^\\top H u + u^\\top H u'\n$$\n半离散系统由常微分方程 $u' = Lu$ 给出。将其代入能量导数中，可得：\n$$\n\\frac{dE}{dt} = (Lu)^\\top H u + u^\\top H (Lu) = u^\\top L^\\top H u + u^\\top H L u = u^\\top (L^\\top H + HL) u\n$$\n这证实了第一个要求的恒等式，其中对称矩阵 $S = L^\\top H + HL$ 控制能量的变化率。\n\n下一步是分析 $S$ 的结构。算子 $L$ 定义为：\n$$\nL = -c\\,D - \\mathrm{diag}(\\alpha) - \\tau_L\\,H^{-1}\\,e_0 e_0^\\top\n$$\n其中 $c0$ 是平流速度，$D$ 是SBP一阶导数算子，$\\mathrm{diag}(\\alpha)$ 是表示PML阻尼的对角矩阵，最后一项是针对 $x=0$ 处流入边界的SAT惩罚项。\n\n我们计算 $HL$ 和 $L^\\top H$：\n$$\nHL = H(-c\\,D - \\mathrm{diag}(\\alpha) - \\tau_L\\,H^{-1}\\,e_0 e_0^\\top) = -c\\,HD - H\\,\\mathrm{diag}(\\alpha) - \\tau_L\\,e_0 e_0^\\top\n$$\n请注意，由于 $H$ 和 $\\mathrm{diag}(\\alpha)$ 都是对角矩阵，它们是可交换的：$H\\,\\mathrm{diag}(\\alpha) = \\mathrm{diag}(\\alpha)\\,H$。\n对于转置项，由于 $H$、$\\mathrm{diag}(\\alpha)$ 和 $e_0 e_0^\\top$ 都是对称矩阵：\n$$\nL^\\top = (-c\\,D - \\mathrm{diag}(\\alpha) - \\tau_L\\,H^{-1}\\,e_0 e_0^\\top)^\\top = -c\\,D^\\top - \\mathrm{diag}(\\alpha) - \\tau_L\\,e_0 e_0^\\top H^{-1}\n$$\n于是，\n$$\nL^\\top H = (-c\\,D^\\top - \\mathrm{diag}(\\alpha) - \\tau_L\\,e_0 e_0^\\top H^{-1})H = -c\\,D^\\top H - \\mathrm{diag}(\\alpha)\\,H - \\tau_L\\,e_0 e_0^\\top\n$$\n将这些组合起来，我们得到能量变化率矩阵 $S$：\n$$\nS = HL + L^\\top H = -c(HD + D^\\top H) - 2\\,\\mathrm{diag}(\\alpha)\\,H - 2\\tau_L\\,e_0 e_0^\\top\n$$\n现在我们使用SBP算子的定义属性，$HD + D^\\top H = B = \\mathrm{diag}(-1, 0, \\dots, 0, 1)$。将此恒等式代入 $S$ 的表达式中：\n$$\nS = -c\\,\\mathrm{diag}(-1, 0, \\dots, 0, 1) - 2\\,\\mathrm{diag}(\\alpha)\\,H - 2\\tau_L\\,e_0 e_0^\\top\n$$\n这个和中的所有矩阵都是对角矩阵。矩阵 $e_0e_0^\\top$ 是一个对角矩阵，其 $(0,0)$ 位置为1，其余位置为零。因此，$S$ 是一个对角矩阵。让我们找出它的对角元素 $S_{ii}$。\n对于内部点 $i \\in \\{1, \\dots, N-2\\}$：\n$$\nS_{ii} = -c(0) - 2\\,\\alpha_i H_{ii} - 2\\tau_L(0) = -2\\alpha_i h\n$$\n对于左边界 $i=0$：\n$$\nS_{00} = -c(-1) - 2\\,\\alpha_0 H_{00} - 2\\tau_L(1) = c - 2\\alpha_0(h/2) - 2\\tau_L = c - \\alpha_0 h - 2\\tau_L\n$$\n对于右边界 $i=N-1$：\n$$\nS_{N-1,N-1} = -c(1) - 2\\,\\alpha_{N-1} H_{N-1,N-1} - 2\\tau_L(0) = -c - 2\\alpha_{N-1}(h/2) = -c - \\alpha_{N-1} h\n$$\n现在，我们可以用向量 $u$ 的分量 $u_i$ 来表示能量导数：\n$$\n\\frac{dE}{dt} = u^\\top S u = \\sum_{i=0}^{N-1} S_{ii} u_i^2 = S_{00}u_0^2 + S_{N-1,N-1}u_{N-1}^2 + \\sum_{i=1}^{N-2} S_{ii}u_i^2\n$$\n$$\n\\frac{dE}{dt} = (c - \\alpha_0 h - 2\\tau_L)u_0^2 - (c + \\alpha_{N-1} h)u_{N-1}^2 - \\sum_{i=1}^{N-2} 2\\alpha_i h u_i^2\n$$\n问题指定了选择 $\\tau_L \\ge c$。对于此选择，$u_0^2$ 的系数是 $c - \\alpha_0 h - 2\\tau_L \\le c - \\alpha_0 h - 2c = -c - \\alpha_0 h$。由于 $c0, \\alpha_00, h0$，该系数为负。这说明了SAT惩罚项如何消除非耗散的边界贡献：与能量流入相关的SBP算子项 $+cu_0^2$ 被耗散的SAT项 $-2\\tau_L u_0^2$ 所压制，从而保证了流入边界的稳定性。\n\n流出边界的项 $-(c + \\alpha_{N-1}h)u_{N-1}^2$ 是负的，正确地表示能量离开区域。求和项也是负的，因为 $\\alpha_i \\ge \\alpha_0  0$。\n因此，舍去所有非正的边界项，我们可以建立一个不等式：\n$$\n\\frac{dE}{dt} \\le - \\sum_{i=0}^{N-1} 2\\alpha_i H_{ii} u_i^2\n$$\n（为了更紧凑的表达，将边界项与求和项重新组合）。\n令 $\\beta = 2 \\min_{x\\in[0,1]} \\alpha(x)$。根据 $\\alpha(x)$ 的定义，其最小值为 $\\alpha_0$。因此，$\\beta = 2\\alpha_0$。由于对所有 $i$ 都有 $\\alpha_i \\ge \\alpha_0$：\n$$\n\\frac{dE}{dt} \\le - \\sum_{i=0}^{N-1} (2\\alpha_0) H_{ii} u_i^2 = -2\\alpha_0 \\sum_{i=0}^{N-1} H_{ii} u_i^2 = -2\\alpha_0 (u^\\top H u) = -\\beta E(t)\n$$\n这证明了所求的不等式：$\\frac{d}{dt}\\|u(t)\\|_H^2 \\le -\\beta\\,\\|u(t)\\|_H^2$，其中 $\\beta = 2\\alpha_0$。对于 $x  1-w$ 的PML斜坡不会降低此界限，因为界限是由 $\\alpha(x)$ 的最小值决定的，在区域 $x \\le 1-w$ 中该最小值为 $\\alpha_0$。斜坡区域中较大的 $\\alpha(x)$ 值只会增加耗散，它们不影响衰减率的这个下界。\n\n对于算法任务，我们必须计算 $\\beta_{\\mathrm{num}} = \\lambda_{\\min}(-S, H)$，即矩阵束 $(-S, H)$ 的最小广义特征值。根据定义，这是可能的最优衰减率：\n$$\n\\beta_{\\mathrm{num}} = \\min_{u \\ne 0} \\frac{u^\\top(-S)u}{u^\\top H u}\n$$\n由于 $-S$ 和 $H$ 都是对角矩阵，广义特征向量是规范基向量 $e_i$。相应的广义特征值 $\\lambda_i$ 由对角元素之比给出：\n$$\n\\lambda_i = \\frac{-S_{ii}}{H_{ii}}\n$$\n让我们计算 $\\tau_L = c$ 情况下的这些特征值：\n对于 $i=0$： $\\lambda_0 = \\frac{-(c - \\alpha_0 h - 2c)}{h/2} = \\frac{c + \\alpha_0 h}{h/2} = \\frac{2c}{h} + 2\\alpha_0$。\n对于 $i \\in \\{1, \\dots, N-2\\}$： $\\lambda_i = \\frac{-(-2\\alpha_i h)}{h} = 2\\alpha_i$。\n对于 $i=N-1$： $\\lambda_{N-1} = \\frac{-(-c - \\alpha_{N-1}h)}{h/2} = \\frac{c+\\alpha_{N-1}h}{h/2} = \\frac{2c}{h} + 2\\alpha_{N-1}$。\n\n这些特征值中的最小值为 $\\beta_{\\mathrm{num}} = \\min_i \\lambda_i$。与边界相关的特征值 $\\lambda_0$ 和 $\\lambda_{N-1}$ 因为 $2c/h$ 项而很大（因为 $h$ 很小）。因此，最小值必须来自内部特征值 $\\{2\\alpha_i\\}_{i=1}^{N-2}$。如前所述，$\\alpha_i$ 的最小值为 $\\alpha_0$。\n因此，我们从解析上得出结论：\n$$\n\\beta_{\\mathrm{num}} = \\min\\left( \\frac{2c}{h} + 2\\alpha_0, \\min_{i=1,\\dots,N-2}(2\\alpha_i), \\frac{2c}{h} + 2\\alpha_{N-1} \\right) = 2\\alpha_0\n$$\n数值计算应证实这一解析结果。任何偏差都将归因于浮点精度。因此，每个测试用例的计算应得出一个非常接近 $2\\alpha_0$ 的值。", "answer": "```\n[0.02000000,0.10000000,0.04000000,0.02000000]\n```", "id": "3451160"}]}