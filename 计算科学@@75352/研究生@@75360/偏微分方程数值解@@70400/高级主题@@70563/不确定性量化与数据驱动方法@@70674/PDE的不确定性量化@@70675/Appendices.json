{"hands_on_practices": [{"introduction": "多项式混沌展开 (Polynomial Chaos Expansions, PCE) 是不确定性量化中的基石，它将随机输出表示为正交多项式的级数。当使用随机 Galerkin 方法求解所得方程组时，我们必须计算描述随机变量之间相互作用的张量。本练习 ([@problem_id:3432918]) 提供了处理高斯不确定性下 Hermite 多项式代数机制的直接实践，这是理解和实施谱方法不可或缺的一步。", "problem": "考虑一维高斯随机变量 $X \\sim \\mathcal{N}(0,1)$ 及其相关的标准正交概率 Hermite 多项式基 $\\{h_{n}(x)\\}_{n \\ge 0}$，其定义为 $h_{n}(x) = \\mathrm{He}_{n}(x)/\\sqrt{n!}$，其中 $\\mathrm{He}_{n}$ 是概率 Hermite 多项式，其标准正交性是相对于标准正态密度 $\\varrho(x) = (2\\pi)^{-1/2}\\exp(-x^{2}/2)$ 而言的。其标准正交性和三项递推关系为\n- $\\mathbb{E}[h_{m}(X) h_{n}(X)] = \\delta_{mn}$，\n- $x\\,h_{n}(x) = \\sqrt{n+1}\\,h_{n+1}(x) + \\sqrt{n}\\,h_{n-1}(x)$，对所有 $n \\ge 0$ 成立，并约定 $h_{-1} \\equiv 0$。\n\n定义三乘积张量项\n$$\nG_{ijk} \\equiv \\mathbb{E}\\big[h_{i}(X)\\,h_{j}(X)\\,h_{k}(X)\\big], \\quad i,j,k \\in \\mathbb{N}_{0}.\n$$\n在线性椭圆随机偏微分方程的仿射高斯输入的混沌多项式展开 (PCE) 离散化中，这些项出现在随机 Galerkin (SG) 投影的系数耦合中。\n\n仅使用标准正交性、三项递推关系以及 Hermite 多项式的标准性质，显式地确定当 $i,j,k \\in \\{0,1,2,3\\}$ 时 $G_{ijk}$ 的所有非零值。然后，使用这些值，计算所得到的 $4 \\times 4 \\times 4$ 子张量的 Frobenius 范数的平方，\n$$\nS \\equiv \\sum_{i=0}^{3}\\sum_{j=0}^{3}\\sum_{k=0}^{3} G_{ijk}^{2}.\n$$\n请以单个实数形式提供最终答案。无需四舍五入。", "solution": "用户要求我验证并解决一个定量问题。\n\n### 步骤 1：提取已知条件\n-   **随机变量**：$X \\sim \\mathcal{N}(0,1)$，一个标准一维高斯随机变量。\n-   **基**：标准正交概率 Hermite 多项式基 $\\{h_{n}(x)\\}_{n \\ge 0}$。\n-   **基定义**：$h_{n}(x) = \\mathrm{He}_{n}(x)/\\sqrt{n!}$，其中 $\\mathrm{He}_{n}$ 是概率 Hermite 多项式。\n-   **权重函数**：正交性是相对于标准正态密度 $\\varrho(x) = (2\\pi)^{-1/2}\\exp(-x^{2}/2)$。\n-   **标准正交关系**：$\\mathbb{E}[h_{m}(X) h_{n}(X)] = \\delta_{mn}$，其中 $\\mathbb{E}[\\cdot]$ 是关于 $X$ 的期望，$\\delta_{mn}$ 是 Kronecker delta。\n-   **三项递推关系**：$x\\,h_{n}(x) = \\sqrt{n+1}\\,h_{n+1}(x) + \\sqrt{n}\\,h_{n-1}(x)$，对所有 $n \\ge 0$ 成立，并约定 $h_{-1}(x) \\equiv 0$。\n-   **目标对象**：三乘积张量项 $G_{ijk} \\equiv \\mathbb{E}\\big[h_{i}(X)\\,h_{j}(X)\\,h_{k}(X)\\big]$，其中 $i,j,k \\in \\mathbb{N}_{0}$。\n-   **任务**：\n    1.  确定当指标 $i,j,k \\in \\{0,1,2,3\\}$ 时 $G_{ijk}$ 的所有非零值。\n    2.  计算所得 $4 \\times 4 \\times 4$ 子张量的 Frobenius 范数的平方，定义为 $S \\equiv \\sum_{i=0}^{3}\\sum_{j=0}^{3}\\sum_{k=0}^{3} G_{ijk}^{2}$。\n\n### 步骤 2：使用提取的已知条件进行验证\n1.  **科学基础**：该问题深深植根于正交多项式理论，特别是 Hermite 多项式，及其通过混沌多项式展开 (PCE) 在不确定性量化中的应用。所提供的定义和关系（标准正交性、递推关系）对于概率 Hermite 多项式是标准且正确的。该问题在科学上和数学上都是合理的。\n2.  **适定性**：问题定义清晰。它要求计算特定的张量项以及后续的求和。所提供的信息足以确定一个唯一的、有意义的解。\n3.  **客观性**：问题以精确、正式的语言陈述，没有任何主观性或模糊性。\n4.  **缺陷分析**：\n    -   没有违反科学原理。\n    -   该问题与指定主题直接相关，是实现随机 Galerkin 方法的核心计算。\n    -   设置是完整且一致的。例如，对于 $n=0$，递推关系给出 $x h_0(x) = \\sqrt{1} h_1(x)$。根据标准正交性，$\\mathbb{E}[h_0(X)^2]=1$，这意味着 $h_0(x)=1$，因为它是一个零次多项式。因此，$h_1(x) = x$，这对于概率 Hermite 多项式是正确的。\n    -   计算量很大，但完全可行且是标准的。\n    -   问题结构合理，并能得出一个唯一的答案。\n\n### 步骤 3：结论与行动\n问题有效。我现在将进行完整解答。\n\n问题要求计算三乘积张量项的平方和，$S \\equiv \\sum_{i=0}^{3}\\sum_{j=0}^{3}\\sum_{k=0}^{3} G_{ijk}^{2}$。这些项定义为 $G_{ijk} = \\mathbb{E}[h_i(X)h_j(X)h_k(X)]$。期望是关于标准正态测度的积分：\n$$\nG_{ijk} = \\int_{-\\infty}^{\\infty} h_i(x)h_j(x)h_k(x) \\frac{1}{\\sqrt{2\\pi}} \\exp\\left(-\\frac{x^2}{2}\\right) dx.\n$$\n由于乘法是可交换的，张量 $G_{ijk}$ 对其指标 $(i,j,k)$ 的任何排列都是对称的。\n\n我们可以利用给定的多项式三项递推关系来推导 $G_{ijk}$ 的递推关系。不失一般性，假设 $k \\ge 1$。递推关系可以重新排列以表示 $h_k(x)$：\n$$\nh_k(x) = \\frac{1}{\\sqrt{k}} \\left( x h_{k-1}(x) - \\sqrt{k-1} h_{k-2}(x) \\right), \\quad k \\ge 1.\n$$\n将此代入 $G_{ijk}$ 的定义中：\n$$\nG_{ijk} = \\mathbb{E}\\left[h_i(X) h_j(X) \\frac{1}{\\sqrt{k}} \\left( X h_{k-1}(X) - \\sqrt{k-1} h_{k-2}(X) \\right)\\right].\n$$\n$$\nG_{ijk} = \\frac{1}{\\sqrt{k}} \\mathbb{E}\\left[X h_i(X) h_j(X) h_{k-1}(X)\\right] - \\sqrt{\\frac{k-1}{k}} \\mathbb{E}\\left[h_i(X) h_j(X) h_{k-2}(X)\\right].\n$$\n第二项是 $-\\sqrt{\\frac{k-1}{k}} G_{i,j,k-2}$。对于第一项，我们使用乘 $x$ 算子在相关 Hilbert 空间中是自伴的性质。因此 $\\mathbb{E}[f(X) g(X) X h(X)] = \\mathbb{E}[(X f(X)) g(X) h(X)]$。我们将递推关系应用于 $X h_i(X)$：\n$$\nX h_i(X) = \\sqrt{i+1}\\,h_{i+1}(X) + \\sqrt{i}\\,h_{i-1}(X).\n$$\n将此代入第一项的期望中：\n$$\n\\mathbb{E}\\left[(\\sqrt{i+1}\\,h_{i+1}(X) + \\sqrt{i}\\,h_{i-1}(X)) h_j(X) h_{k-1}(X)\\right] = \\sqrt{i+1} G_{i+1,j,k-1} + \\sqrt{i} G_{i-1,j,k-1}.\n$$\n结合这些结果，得到 $G_{ijk}$ 的递推关系（假设 $k \\ge 1$）：\n$$\nG_{ijk} = \\frac{\\sqrt{i+1}}{\\sqrt{k}} G_{i+1,j,k-1} + \\frac{\\sqrt{i}}{\\sqrt{k}} G_{i-1,j,k-1} - \\sqrt{\\frac{k-1}{k}} G_{i,j,k-2}.\n$$\n递推的基例是 $k=0$。根据定义，$h_0(x)=1$。\n$$\nG_{ij0} = \\mathbb{E}[h_i(X)h_j(X)h_0(X)] = \\mathbb{E}[h_i(X)h_j(X)] = \\delta_{ij}.\n$$\n我们现在计算当 $i,j,k \\in \\{0,1,2,3\\}$ 时所需的非零项。由于对称性，我们只需要计算 $i \\le j \\le k$ 的情况。\n\n**情况 k=0：**\n$G_{ij0} = \\delta_{ij}$。唯一的非零值（不计排列）是：\n- $G_{000} = \\delta_{00} = 1$。\n- $G_{110} = \\delta_{11} = 1$。\n- $G_{220} = \\delta_{22} = 1$。\n- $G_{330} = \\delta_{33} = 1$。\n\n**情况 k=1：**\n当 $k=1$ 时，递推关系简化为：\n$G_{ij1} = \\sqrt{i+1} G_{i+1,j,0} + \\sqrt{i} G_{i-1,j,0} = \\sqrt{i+1} \\delta_{i+1,j} + \\sqrt{i} \\delta_{i-1,j}$。\n这仅在 $j=i+1$ 或 $j=i-1$ 时非零。在 $i \\le j$ 的情况下，我们只需要 $j=i+1$。\n- $G_{011} = \\sqrt{0+1} \\delta_{1,1} + 0 = 1$。\n- $G_{121} = \\sqrt{1+1} \\delta_{2,2} + \\sqrt{1} \\delta_{0,2} = \\sqrt{2}$。（根据对称性，这也是 $G_{112}$）。\n- $G_{231} = \\sqrt{2+1} \\delta_{3,3} + \\sqrt{2} \\delta_{1,3} = \\sqrt{3}$。（根据对称性，这也是 $G_{123}、G_{132}$ 等）。\n一个关键性质是，$G_{ijk}$ 仅在 $i+j+k$ 为偶数时才非零。这是因为 Hermite 多项式的奇偶性与其次数相同，而奇函数在对称域上的积分为零。所有指标和为奇数的 $G_{ijk}$ 均为零（例如，$G_{111}=0, G_{122}=0$）。\n\n**情况 k=2：**\n$G_{ij2} = \\frac{1}{\\sqrt{2}}(\\sqrt{i+1} G_{i+1, j, 1} + \\sqrt{i} G_{i-1, j, 1} - G_{ij0})$。\n- $G_{022} = \\frac{1}{\\sqrt{2}}(\\sqrt{1} G_{121} - G_{020}) = \\frac{1}{\\sqrt{2}}(\\sqrt{2} - 0) = 1$。\n- $G_{112} = \\frac{1}{\\sqrt{2}}(\\sqrt{2} G_{211} + \\sqrt{1} G_{011} - G_{110}) = \\frac{1}{\\sqrt{2}}(\\sqrt{2}(\\sqrt{2}) + 1 - 1) = \\frac{2}{\\sqrt{2}} = \\sqrt{2}$。\n- $G_{132} = \\frac{1}{\\sqrt{2}}(\\sqrt{2} G_{231} + \\sqrt{1} G_{031} - G_{130}) = \\frac{1}{\\sqrt{2}}(\\sqrt{2}(\\sqrt{3}) + 0 - 0) = \\sqrt{3}$。\n- $G_{222} = \\frac{1}{\\sqrt{2}}(\\sqrt{3} G_{321} + \\sqrt{2} G_{121} - G_{220}) = \\frac{1}{\\sqrt{2}}(\\sqrt{3}(\\sqrt{3}) + \\sqrt{2}(\\sqrt{2}) - 1) = \\frac{3+2-1}{\\sqrt{2}} = \\frac{4}{\\sqrt{2}} = 2\\sqrt{2}$。\n- $G_{332} = \\frac{1}{\\sqrt{2}}(\\sqrt{4} G_{431} + \\sqrt{3} G_{231} - G_{330})$。我们需要 $G_{431} = \\sqrt{3+1}\\delta_{44} + \\sqrt{3}\\delta_{24} = 2$。\n  $G_{332} = \\frac{1}{\\sqrt{2}}(2(2) + \\sqrt{3}(\\sqrt{3}) - 1) = \\frac{4+3-1}{\\sqrt{2}} = \\frac{6}{\\sqrt{2}} = 3\\sqrt{2}$。\n\n**情况 k=3：**\n$G_{ij3} = \\frac{1}{\\sqrt{3}}(\\sqrt{i+1} G_{i+1, j, 2} + \\sqrt{i} G_{i-1, j, 2} - \\sqrt{2} G_{ij1})$。\n- $G_{033} = \\frac{1}{\\sqrt{3}}(\\sqrt{1} G_{132} - \\sqrt{2} G_{031}) = \\frac{1}{\\sqrt{3}}(\\sqrt{3} - 0) = 1$。\n- $G_{123} = \\frac{1}{\\sqrt{3}}(\\sqrt{2} G_{222} + \\sqrt{1} G_{022} - \\sqrt{2} G_{121}) = \\frac{1}{\\sqrt{3}}(\\sqrt{2}(2\\sqrt{2}) + 1 - \\sqrt{2}(\\sqrt{2})) = \\frac{4+1-2}{\\sqrt{3}} = \\frac{3}{\\sqrt{3}} = \\sqrt{3}$。\n- $G_{233} = \\frac{1}{\\sqrt{3}}(\\sqrt{3} G_{332} + \\sqrt{2} G_{132} - \\sqrt{2} G_{231}) = \\frac{1}{\\sqrt{3}}(\\sqrt{3}(3\\sqrt{2}) + \\sqrt{2}(\\sqrt{3}) - \\sqrt{2}(\\sqrt{3})) = \\frac{3\\sqrt{6}}{\\sqrt{3}} = 3\\sqrt{2}$。\n\n**非零 $G_{ijk}$ 值及其平方大小总结：**\n非零值出现在特定的指标组合中。我们列出唯一的值（不计排列）、它们的平方值以及其指标的不同排列数。\n- 指标 $\\{0,0,0\\}$: $G_{000}=1$。$G_{000}^2 = 1$。有 $1$ 种排列。对总和的贡献：$1 \\times 1 = 1$。\n- 指标 $\\{0,1,1\\}$: $G_{011}=1$。$G_{011}^2 = 1$。有 $3$ 种排列：$(0,1,1), (1,0,1), (1,1,0)$。贡献：$3 \\times 1 = 3$。\n- 指标 $\\{0,2,2\\}$: $G_{022}=1$。$G_{022}^2 = 1$。有 $3$ 种排列。贡献：$3 \\times 1 = 3$。\n- 指标 $\\{0,3,3\\}$: $G_{033}=1$。$G_{033}^2 = 1$。有 $3$ 种排列。贡献：$3 \\times 1 = 3$。\n- 指标 $\\{1,1,2\\}$: $G_{112}=\\sqrt{2}$。$G_{112}^2 = 2$。有 $3$ 种排列。贡献：$3 \\times 2 = 6$。\n- 指标 $\\{1,2,3\\}$: $G_{123}=\\sqrt{3}$。$G_{123}^2 = 3$。由于所有指标都不同，有 $3! = 6$ 种排列。贡献：$6 \\times 3 = 18$。\n- 指标 $\\{2,2,2\\}$: $G_{222}=2\\sqrt{2}$。$G_{222}^2 = 8$。有 $1$ 种排列。贡献：$1 \\times 8 = 8$。\n- 指标 $\\{2,3,3\\}$: $G_{233}=3\\sqrt{2}$。$G_{233}^2 = 18$。有 $3$ 种排列。贡献：$3 \\times 18 = 54$。\n\n所有其他 $i,j,k \\in \\{0,1,2,3\\}$ 的 $G_{ijk}$ 均为零，这要么是由于奇偶性规则（指标和为奇数），要么是由于三角不等式选择规则（这已由递推关系隐式处理）。\n\n**S 的最终计算：**\n我们将所有非零项的贡献相加：\n$$\nS = \\sum_{i=0}^{3}\\sum_{j=0}^{3}\\sum_{k=0}^{3} G_{ijk}^{2} = 1 + 3 + 3 + 3 + 6 + 18 + 8 + 54.\n$$\n$$\nS = 10 + 6 + 18 + 8 + 54 = 16 + 18 + 8 + 54 = 34 + 8 + 54 = 42 + 54 = 96.\n$$\n子张量的 Frobenius 范数的平方是 $96$。", "answer": "$$\n\\boxed{96}\n$$", "id": "3432918"}, {"introduction": "理解输入不确定性如何影响输出（即所谓的“敏感性分析”）至关重要。虽然直接方法（如有限差分）的计算成本可能高得惊人，但伴随方法 (adjoint method) 提供了一种优雅且高效的方式来计算单个输出量关于整个输入场的梯度。本练习 ([@problem_id:3459206]) 将引导您针对一个标准的扩散问题推导这一强大工具，它是现代不确定性量化和基于梯度的优化的核心。", "problem": "考虑一个有界利普希茨区域 $D \\subset \\mathbb{R}^{d}$（其中 $d \\in \\{2,3\\}$），其边界 $\\partial D$ 上的外单位法向量为 $\\boldsymbol{n}$。设 $a : D \\to \\mathbb{R}$ 是一个严格为正的系数，满足 $a \\in L^{\\infty}(D)$ 并且在 $D$ 中几乎处处有 $a(x) \\ge a_{\\min}  0$。对于给定的源项 $f \\in L^{2}(D)$，状态 $u \\in H_{0}^{1}(D)$ 被定义为线性椭圆偏微分方程 (PDE)\n$$\n-\\nabla \\cdot \\big(a(x)\\,\\nabla u(x)\\big) = f(x) \\quad \\text{在 } D \\text{ 内}, \n\\qquad \nu = 0 \\quad \\text{在 } \\partial D \\text{ 上},\n$$\n的唯一弱解，意指对于所有 $v \\in H_{0}^{1}(D)$，弱形式\n$$\n\\int_{D} a(x)\\,\\nabla u(x)\\cdot \\nabla v(x)\\,dx = \\int_{D} f(x)\\,v(x)\\,dx\n$$\n成立。定义目标量 (QoI) $Q : H_{0}^{1}(D) \\to \\mathbb{R}$ 为\n$$\nQ(u) := \\int_{D} \\psi(x)\\,u(x)\\,dx,\n$$\n其中 $\\psi \\in L^{2}(D)$ 是一个固定的权重函数。在不确定性量化 (UQ) 的背景下，将 $a$ 视为不确定输入场，并考虑扰动 $\\delta a \\in L^{\\infty}(D)$，使得 $a+\\delta a$ 保持严格为正。\n\n从弱形式表述出发，使用连续伴随方法来：\n1) 推导与目标量 $Q(u)$ 相关联的伴随场 $p \\in H_{0}^{1}(D)$ 的伴随问题，包括由泛函设置确定的适当边界条件。\n2) 推导 $Q$ 关于 $a$ 在方向 $\\delta a$ 上的 Fréchet 导数，记为 $\\delta Q[a;\\delta a]$，并将其完全用原梯度 $\\nabla u$ 和伴随梯度 $\\nabla p$ 的内积表示。然后，确定逐点 Fréchet 导数密度 $\\delta Q/\\delta a(x)$，使得\n$$\n\\delta Q[a;\\delta a] = \\int_{D} \\frac{\\delta Q}{\\delta a}(x)\\,\\delta a(x)\\,dx.\n$$\n\n你的最终答案必须是逐点 Fréchet 导数密度 $\\delta Q/\\delta a(x)$ 的单个闭式解析表达式。不需要进行数值计算。所有积分必须以国际单位制 (SI) 为基础表示，所有角度（如果出现）均以弧度表示。不需要四舍五入。", "solution": "首先验证问题，以确保其是适定的且在科学上是合理的。\n\n### 第1步：提取已知条件\n-   **区域**：一个有界利普希茨区域 $D \\subset \\mathbb{R}^{d}$，其中 $d \\in \\{2,3\\}$。\n-   **系数**：一个函数 $a : D \\to \\mathbb{R}$，使得 $a \\in L^{\\infty}(D)$ 并且存在一个常数 $a_{\\min}  0$，在 $D$ 中几乎处处有 $a(x) \\ge a_{\\min}$。\n-   **源项**：一个函数 $f \\in L^{2}(D)$。\n-   **状态变量**：状态 $u \\in H_{0}^{1}(D)$ 是一个线性椭圆偏微分方程的唯一弱解。\n-   **PDE (强形式)**：$-\\nabla \\cdot \\big(a(x)\\,\\nabla u(x)\\big) = f(x)$ 在 $D$ 内，边界条件为 $u = 0$ 在 $\\partial D$ 上。\n-   **PDE (弱形式)**：对于所有测试函数 $v \\in H_{0}^{1}(D)$，以下等式成立：\n    $$ \\int_{D} a(x)\\,\\nabla u(x)\\cdot \\nabla v(x)\\,dx = \\int_{D} f(x)\\,v(x)\\,dx $$\n-   **目标量 (QoI)**：一个泛函 $Q : H_{0}^{1}(D) \\to \\mathbb{R}$，定义为：\n    $$ Q(u) := \\int_{D} \\psi(x)\\,u(x)\\,dx $$\n    其中 $\\psi \\in L^{2}(D)$ 是一个固定的权重函数。\n-   **不确定性模型**：系数 $a$ 被视为一个不确定输入场。我们考虑扰动 $\\delta a \\in L^{\\infty}(D)$，使得 $a+\\delta a$ 保持严格为正。\n-   **目标**：\n    1.  推导伴随场 $p \\in H_{0}^{1}(D)$ 的伴随问题。\n    2.  推导 $Q$ 关于 $a$ 在方向 $\\delta a$ 上的 Fréchet 导数，记为 $\\delta Q[a;\\delta a]$，并确定逐点 Fréchet 导数密度 $\\frac{\\delta Q}{\\delta a}(x)$。\n\n### 第2步：使用提取的已知条件进行验证\n-   **科学依据**：该问题是连续伴随方法在线性椭圆偏微分方程解的敏感性分析中的一个标准应用。这是应用数学、数值分析和工程学中一个基础且成熟的课题。该偏微分方程是变系数泊松方程，是扩散过程的一个典范模型。使用 Sobolev 空间 ($H_{0}^{1}(D)$) 和 Lebesgue 空间 ($L^{2}(D)$, $L^{\\infty}(D)$) 是现代偏微分方程理论的标准做法。\n-   **适定性**：原问题的弱解 $u \\in H_{0}^{1}(D)$ 的存在性和唯一性由 Lax-Milgram 定理保证。双线性形式 $B(u,v) = \\int_{D} a \\nabla u \\cdot \\nabla v \\,dx$ 在 $H_{0}^{1}(D) \\times H_{0}^{1}(D)$ 上是连续且强制的，线性泛函 $L(v) = \\int_{D} f v \\,dx$ 在 $H_{0}^{1}(D)$ 上是连续的。寻找 Fréchet 导数的问题也是适定的。\n-   **目标**：问题以精确的数学语言陈述，没有歧义的余地。\n\n该问题不包含科学谬误、不一致之处或不适定元素。它是 PDE 约束优化和不确定性量化领域中一个有效且标准的问题。\n\n### 第3步：结论与行动\n问题是有效的。下面提供了完整的解法。\n\n### 解法推导\n\n求解过程包括三个主要步骤：线性化控制 PDE 以获得敏感性方程，定义伴随问题，以及将它们结合起来推导目标量的 Fréchet 导数。\n\n设状态 $u$ 隐式地依赖于系数 $a$，记为 $u(a)$。系数 $a$ 的一个扰动 $\\delta a$ 会引起状态的一个扰动，其一阶近似由 $u$ 关于 $a$ 在方向 $\\delta a$ 上的 Gâteaux 导数给出，记为 $\\delta u$。受扰动的状态为 $u(a+\\delta a) \\approx u(a) + \\delta u$。\n\n状态 $u = u(a)$ 满足弱形式：\n$$ \\int_{D} a(x)\\,\\nabla u(x)\\cdot \\nabla v(x)\\,dx = \\int_{D} f(x)\\,v(x)\\,dx \\quad \\forall v \\in H_{0}^{1}(D) \\quad (1) $$\n对应于受扰动系数 $a+\\delta a$ 的受扰动状态 $u+\\delta u$ 满足：\n$$ \\int_{D} (a(x)+\\delta a(x))\\,\\nabla (u(x)+\\delta u(x))\\cdot \\nabla v(x)\\,dx = \\int_{D} f(x)\\,v(x)\\,dx \\quad \\forall v \\in H_{0}^{1}(D) \\quad (2) $$\n展开 (2)：\n$$ \\int_{D} a\\nabla u \\cdot \\nabla v \\,dx + \\int_{D} a\\nabla \\delta u \\cdot \\nabla v \\,dx + \\int_{D} \\delta a\\nabla u \\cdot \\nabla v \\,dx + \\int_{D} \\delta a\\nabla \\delta u \\cdot \\nabla v \\,dx = \\int_{D} f v \\,dx $$\n从该展开式中减去方程 (1)，并忽略二阶项 $\\int_{D} \\delta a\\nabla \\delta u \\cdot \\nabla v \\,dx$（该项为 $O(\\|\\delta a\\|\\|\\delta u\\|)$），我们得到关于 $\\delta u \\in H_{0}^{1}(D)$ 的线性化敏感性方程：\n$$ \\int_{D} a(x)\\,\\nabla \\delta u(x)\\cdot \\nabla v(x)\\,dx = - \\int_{D} \\delta a(x)\\,\\nabla u(x)\\cdot \\nabla v(x)\\,dx \\quad \\forall v \\in H_{0}^{1}(D) \\quad (3) $$\n\n接下来，我们考虑目标量 QoI 的一阶变分 $\\delta Q$。\n$$ Q(u+\\delta u) = \\int_{D} \\psi(x)\\,(u(x)+\\delta u(x))\\,dx = \\int_{D} \\psi u\\,dx + \\int_{D} \\psi \\delta u\\,dx = Q(u) + \\delta Q $$\n因此，$Q$ 关于 $u$ 在方向 $\\delta u$ 上的 Fréchet 导数为：\n$$ \\delta Q = \\int_{D} \\psi(x)\\,\\delta u(x)\\,dx \\quad (4) $$\n我们的目标是在不需要显式求解方程 (3) 以得到 $\\delta u$ 的情况下，用 $\\delta a$ 来表示 $\\delta Q$。这可以通过引入一个伴随问题来实现。\n\n**1) 伴随问题**\n\n我们将伴随状态 $p \\in H_{0}^{1}(D)$ 定义为以下弱问题的解：\n求 $p \\in H_{0}^{1}(D)$，使得对于所有测试函数 $w \\in H_{0}^{1}(D)$：\n$$ \\int_{D} a(x)\\,\\nabla w(x)\\cdot \\nabla p(x)\\,dx = \\int_{D} \\psi(x)\\,w(x)\\,dx $$\n由于双线性形式的对称性，即 $\\int_D a \\nabla w \\cdot \\nabla p \\,dx = \\int_D a \\nabla p \\cdot \\nabla w \\,dx$，这等价于标准弱形式：\n$$ \\int_{D} a(x)\\,\\nabla p(x)\\cdot \\nabla w(x)\\,dx = \\int_{D} \\psi(x)\\,w(x)\\,dx \\quad \\forall w \\in H_{0}^{1}(D) \\quad (5) $$\n该弱形式对应于强形式伴随 PDE：\n$$ -\\nabla \\cdot \\big(a(x)\\,\\nabla p(x)\\big) = \\psi(x) \\quad \\text{在 } D \\text{ 内} $$\n解 $p$ 和测试函数 $w$ 属于 $H_{0}^{1}(D)$ 的要求意味着齐次 Dirichlet 边界条件：\n$$ p = 0 \\quad \\text{在 } \\partial D \\text{ 上} $$\n这就完成了伴随问题的推导。\n\n**2) Fréchet 导数密度**\n\n现在我们将原问题、敏感性问题和伴随问题方程联系起来。\n在伴随弱形式 (5) 中，我们选择测试函数为状态敏感性 $w = \\delta u \\in H_{0}^{1}(D)$。这得到：\n$$ \\int_{D} a(x)\\,\\nabla p(x)\\cdot \\nabla \\delta u(x)\\,dx = \\int_{D} \\psi(x)\\,\\delta u(x)\\,dx $$\n右侧恰好是方程 (4) 中 $\\delta Q$ 的表达式。利用点积的对称性，我们有：\n$$ \\delta Q = \\int_{D} a(x)\\,\\nabla \\delta u(x)\\cdot \\nabla p(x)\\,dx $$\n现在，考虑敏感性方程 (3)。我们可以选择测试函数为伴随状态 $v = p \\in H_{0}^{1}(D)$，这得到：\n$$ \\int_{D} a(x)\\,\\nabla \\delta u(x)\\cdot \\nabla p(x)\\,dx = - \\int_{D} \\delta a(x)\\,\\nabla u(x)\\cdot \\nabla p(x)\\,dx $$\n通过令 $\\int_{D} a\\,\\nabla \\delta u \\cdot \\nabla p\\,dx$ 的两个表达式相等，我们得到了目标量变分的期望表达式：\n$$ \\delta Q[a;\\delta a] = - \\int_{D} \\delta a(x)\\,\\nabla u(x)\\cdot \\nabla p(x)\\,dx $$\n这就是 $Q$ 关于 $a$ 在方向 $\\delta a$ 上的 Fréchet 导数，用原问题解 $u$ 和伴随问题解 $p$ 表示。\n\n问题通过以下关系式定义了逐点 Fréchet 导数密度 $\\frac{\\delta Q}{\\delta a}(x)$：\n$$ \\delta Q[a;\\delta a] = \\int_{D} \\frac{\\delta Q}{\\delta a}(x)\\,\\delta a(x)\\,dx $$\n与我们推导出的结果直接比较，我们有：\n$$ \\int_{D} \\frac{\\delta Q}{\\delta a}(x)\\,\\delta a(x)\\,dx = \\int_{D} \\big(-\\nabla u(x)\\cdot \\nabla p(x)\\big)\\,\\delta a(x)\\,dx $$\n由于此恒等式必须对任何容许的扰动 $\\delta a \\in L^{\\infty}(D)$ 都成立，因此被积函数必须几乎处处相等。因此，逐点 Fréchet 导数密度为：\n$$ \\frac{\\delta Q}{\\delta a}(x) = -\\nabla u(x)\\cdot \\nabla p(x) $$\n其中 $u$ 是原问题的解，$p$ 是伴随问题的解。", "answer": "$$\n\\boxed{-\\nabla u(x)\\cdot \\nabla p(x)}\n$$", "id": "3459206"}, {"introduction": "有了不确定性模型后，我们常常需要计算输出的统计矩，例如期望值。对于复杂的偏微分方程模型，蛮力蒙特卡洛模拟的成本可能令人望而却步。本练习 ([@problem_id:3459226]) 旨在探索多层蒙特卡洛 (Multilevel Monte Carlo, MLMC) 方法，这是一种能显著降低计算成本的前沿技术。该练习结合了理论推导与编程实践，要求您分析 MLMC 的计算复杂度，并验证其相对于标准方法的性能优势。", "problem": "考虑一个在有界域上的、具有随机输入系数的椭圆偏微分方程（PDE），以及一个由PDE解 $u$ 的泛函 $Q(u)$ 定义的标量关注量。目标是在指定的均方根误差（RMSE）容差 $\\varepsilon \\in (0,1)$ 内近似期望 $E[Q(u)]$。假设使用由层级 $\\ell \\in \\{0,1,\\dots,L\\}$ 索引的空间离散化层级，其网格尺寸为 $h_{\\ell} \\sim 2^{-\\ell}$，并将在层级 $\\ell$ 上的数值求解器产生的对 $Q$ 的依赖于层级的近似定义为 $Q_{\\ell}$。假设对于一个具有相容求解器和正则 $Q$ 的椭圆PDE，以下标准速率成立：\n- 弱（偏差）速率：对于某个 $\\alpha  0$ 和常数 $C_{b}  0$，有 $\\left|E[Q_{\\ell} - Q]\\right| \\sim C_{b} \\, 2^{-\\alpha \\ell}$。\n- 多层级修正的强速率：对于某个 $\\beta  0$ 和常数 $C_{v}  0$，有 $\\operatorname{Var}(Q_{\\ell} - Q_{\\ell-1}) \\sim C_{v} \\, 2^{-\\beta \\ell}$。\n- 层级 $\\ell$ 上的单个样本的计算功遵循 $\\mathcal{C}_{\\ell} \\sim C_{c} \\, 2^{\\gamma \\ell}$，对于某个 $\\gamma  0$ 和常数 $C_{c}  0$。\n\n多层级蒙特卡洛（MLMC）估计器使用伸缩恒等式 $E[Q_{L}] = E[Q_{0}] + \\sum_{\\ell=1}^{L} E[Q_{\\ell} - Q_{\\ell-1}]$，并独立地对层级差异 $Q_{\\ell} - Q_{\\ell-1}$ 抽取 $N_{\\ell}$ 个实现。单层级蒙特卡洛估计器仅使用 $N$ 个对 $Q_{L}$ 的独立实现。设总均方误差分解为偏差平方和抽样方差之和，并假设通过选择 $L$ 使得 $|E[Q - Q_{L}]| \\le \\varepsilon/\\sqrt{2}$ 来强制执行偏差容差，同时控制抽样方差以满足剩余的 $\\varepsilon/\\sqrt{2}$ 预算。\n\n任务 A（从第一性原理推导）：从上面给出的均方误差和成本模型的定义出发，推导 MLMC 和单层级蒙特卡洛关于 $\\varepsilon$ 的渐近功复杂度。\n1. 证明在抽样方差约束下最小化总功的样本最优 MLMC 分配 $N_{\\ell}$ 得出总功的缩放关系为\n$$\nW_{\\mathrm{MLMC}}(\\varepsilon) \\sim \\varepsilon^{-2} \\left(\\sum_{\\ell=0}^{L} \\sqrt{\\operatorname{Var}(Q_{\\ell}-Q_{\\ell-1}) \\, \\mathcal{C}_{\\ell}}\\right)^{2},\n$$\n并根据给定的速率推导出以下几种情况：\n- 如果 $\\beta  \\gamma$，则 $W_{\\mathrm{MLMC}}(\\varepsilon) = O(\\varepsilon^{-2})$。\n- 如果 $\\beta = \\gamma$，则 $W_{\\mathrm{MLMC}}(\\varepsilon) = O\\!\\left(\\varepsilon^{-2} (\\log \\varepsilon^{-1})^{2}\\right)$。\n- 如果 $\\beta  \\gamma$，则 $W_{\\mathrm{MLMC}}(\\varepsilon) = O\\!\\left(\\varepsilon^{-2 - (\\gamma - \\beta)/\\alpha}\\right)$。\n2. 证明单层级蒙特卡洛的功为\n$$\nW_{\\mathrm{SL}}(\\varepsilon) \\sim N \\, \\mathcal{C}_{L},\n$$\n其中 $N \\sim \\varepsilon^{-2}$ 且 $L \\sim (\\log_{2}(\\varepsilon^{-1}))/\\alpha$，得出缩放关系\n$$\nW_{\\mathrm{SL}}(\\varepsilon) = O\\!\\left(\\varepsilon^{-2 - \\gamma/\\alpha}\\right).\n$$\n仅使用均方误差分解、MLMC 伸缩表示和成本模型来仔细解释每一步。\n\n任务 B（针对椭圆 PDE 的验证）：在假设 $\\alpha  \\tfrac{1}{2}\\beta$（这对于具有足够正则 $Q$ 的椭圆 PDE 是常见的，例如当弱速率至少是强速率的一半时）下，验证当 $\\beta  \\gamma$ 时，MLMC 的功达到最优缩放 $O(\\varepsilon^{-2})$，而单层级功则严格更差，即 $O(\\varepsilon^{-2 - \\gamma/\\alpha})$，其指数严格大于 2。提供一个用 $(\\alpha,\\beta,\\gamma)$ 表示的清晰条件，以保证这一比较成立。\n\n编程任务：编写一个完整的、可运行的程序，对于下面测试套件中的每个参数元组 $(\\alpha,\\beta,\\gamma)$，计算：\n- MLMC 功指数 $e_{\\mathrm{MLMC}}$，由 $W_{\\mathrm{MLMC}}(\\varepsilon) = O(\\varepsilon^{-e_{\\mathrm{MLMC}}})$ 定义（当 $\\beta \\ge \\gamma$ 时，使用 $e_{\\mathrm{MLMC}} = 2$；当 $\\beta  \\gamma$ 时，使用 $e_{\\mathrm{MLMC}} = 2 + (\\gamma - \\beta)/\\alpha$）。\n- 一个布尔值 $b_{\\log}$，指示 MLMC 复杂度是否具有额外的 $(\\log \\varepsilon^{-1})^{2}$ 因子（这仅在 $\\beta = \\gamma$ 时发生）。\n- 单层级功指数 $e_{\\mathrm{SL}} = 2 + \\gamma/\\alpha$，由 $W_{\\mathrm{SL}}(\\varepsilon) = O(\\varepsilon^{-e_{\\mathrm{SL}}})$ 定义。\n- 一个布尔值 $b_{\\mathrm{MLMC\\_better}}$，如果 $e_{\\mathrm{MLMC}}  e_{\\mathrm{SL}}$，则为真。\n- 一个布尔值 $b_{\\mathrm{valid}}$，如果 $\\alpha  \\tfrac{1}{2}\\beta$ 和 $\\beta  \\gamma$ 同时成立，并且 $e_{\\mathrm{MLMC}} = 2$，则为真。\n\n你的程序应使用以下 $(\\alpha,\\beta,\\gamma)$ 值的测试套件：\n- 测试用例 1：$(\\alpha,\\beta,\\gamma) = (1.2, 2.0, 1.0)$。\n- 测试用例 2（边界）：$(\\alpha,\\beta,\\gamma) = (1.0, 2.0, 2.0)$。\n- 测试用例 3：$(\\alpha,\\beta,\\gamma) = (0.8, 1.2, 1.0)$。\n- 测试用例 4：$(\\alpha,\\beta,\\gamma) = (0.5, 0.8, 1.0)$。\n- 测试用例 5：$(\\alpha,\\beta,\\gamma) = (0.4, 0.7, 0.5)$。\n\n你的程序应产生单行输出，其中包含用方括号括起来的、以逗号分隔的列表形式的结果，每个测试用例的结果本身也是一个按顺序 $[e_{\\mathrm{MLMC}}, b_{\\log}, e_{\\mathrm{SL}}, b_{\\mathrm{MLMC\\_better}}, b_{\\mathrm{valid}}]$ 排列的、用方括号括起来的逗号分隔列表。例如，完整的输出应类似于\n$[[x_{1},y_{1},z_{1},u_{1},v_{1}],[x_{2},y_{2},z_{2},u_{2},v_{2}],\\dots]$，\n其中每个 $x_{i}$、$y_{i}$、$z_{i}$、$u_{i}$、$v_{i}$ 是如上指定的浮点数或布尔值。不涉及角度，也不需要物理单位；所有量都是纯粹的缩放关系。确保所有用于检测相等（以决定对数因子）的数值比较都使用 $10^{-12}$ 的容差。", "solution": "该问题是适定的，并且在用于不确定性量化的多层级蒙特卡洛（MLMC）方法理论中具有坚实的科学基础。它提供了一套完整且一致的定义和假设，以推导和分析 MLMC 和单层级蒙特卡洛（SLMC）估计器的计算复杂度。因此，我们可以着手解决。\n\n按照要求，解答分为两部分呈现：任务 A 涉及 MLMC 和 SLMC 的功复杂度推导，任务 B 在特定条件下验证 MLMC 的优越性。\n\n### 任务 A：功复杂度的推导\n\n**1. 多层级蒙特卡洛 (MLMC) 复杂度**\n\nMLMC 方法通过使用层级间差异的期望的伸缩和，来估计关注量 $Q$ 的一个精细层级近似 $Q_L$ 的期望 $E[Q_L]$：\n$$\nE[Q_L] = E[Q_0] + \\sum_{\\ell=1}^L E[Q_\\ell - Q_{\\ell-1}]\n$$\nMLMC 估计器 $\\hat{Q}_L^{\\mathrm{MLMC}}$ 通过为每个层级差异项 $Y_\\ell = Q_\\ell - Q_{\\ell-1}$（其中 $Q_{-1} \\equiv 0$，所以 $Y_0 = Q_0$）抽取一组独立的 $N_\\ell$ 个样本来近似这个和。\n$$\n\\hat{Q}_L^{\\mathrm{MLMC}} = \\sum_{\\ell=0}^L \\hat{Y}_\\ell = \\sum_{\\ell=0}^L \\frac{1}{N_\\ell} \\sum_{i=1}^{N_\\ell} Y_\\ell^{(i)}\n$$\n总均方误差（MSE）受 $\\varepsilon^2$ 限制，并分解为一个偏差平方项和一个方差项：$\\text{MSE} = (\\text{Bias})^2 + \\text{Variance} \\le \\varepsilon^2$。\n\n偏差是由于最精细层级 $L$ 上的空间离散化造成的：$\\text{Bias} = E[Q_L - Q]$。方差源于蒙特卡洛抽样：$\\text{Variance} = \\operatorname{Var}(\\hat{Q}_L^{\\mathrm{MLMC}})$。\n\n问题指定了一个误差预算：\n- 偏差平方：$|E[Q_L - Q]|^2 \\le (\\varepsilon/\\sqrt{2})^2 = \\varepsilon^2/2$。\n- 抽样方差：$\\operatorname{Var}(\\hat{Q}_L^{\\mathrm{MLMC}}) \\le \\varepsilon^2/2$。\n\n首先，我们确定所需的最精细层级 $L$。偏差约束和弱收敛速率 $|E[Q_\\ell - Q]| \\sim C_b 2^{-\\alpha \\ell}$ 意味着：\n$$\nC_b 2^{-\\alpha L} \\lesssim \\frac{\\varepsilon}{\\sqrt{2}} \\implies 2^{\\alpha L} \\gtrsim \\sqrt{2} C_b \\varepsilon^{-1} \\implies L \\gtrsim \\frac{1}{\\alpha} \\log_2(\\varepsilon^{-1})\n$$\n渐近地，$L$ 的缩放关系为 $L \\sim \\log(\\varepsilon^{-1})$。\n\n接下来，我们分析抽样方差。由于每个层级上的样本是独立的，总方差是各层级方差之和：\n$$\n\\operatorname{Var}(\\hat{Q}_L^{\\mathrm{MLMC}}) = \\sum_{\\ell=0}^L \\operatorname{Var}(\\hat{Y}_\\ell) = \\sum_{\\ell=0}^L \\frac{\\operatorname{Var}(Y_\\ell)}{N_\\ell} = \\sum_{\\ell=0}^L \\frac{V_\\ell}{N_\\ell}\n$$\n其中 $V_\\ell = \\operatorname{Var}(Q_\\ell - Q_{\\ell-1})$。方差约束为 $\\sum_{\\ell=0}^L \\frac{V_\\ell}{N_\\ell} \\le \\frac{\\varepsilon^2}{2}$。\n\n总计算功（成本）是所有层级成本之和：\n$$\nW_{\\mathrm{MLMC}} = \\sum_{\\ell=0}^L N_\\ell \\mathcal{C}_\\ell\n$$\n其中 $\\mathcal{C}_\\ell$ 是在层级 $\\ell$ 上单个样本的成本。\n\n我们必须找到在方差约束下最小化功 $W_{\\mathrm{MLMC}}$ 的样本数 $N_\\ell$。这是一个约束优化问题。我们使用拉格朗日乘子法。目标是在 $\\sum V_\\ell/N_\\ell = \\varepsilon^2/2$ 的条件下最小化 $\\sum N_\\ell \\mathcal{C}_\\ell$。拉格朗日量为：\n$$\n\\mathcal{L}(N_0, \\dots, N_L, \\lambda) = \\sum_{\\ell=0}^L N_\\ell \\mathcal{C}_\\ell + \\lambda \\left( \\sum_{\\ell=0}^L \\frac{V_\\ell}{N_\\ell} - \\frac{\\varepsilon^2}{2} \\right)\n$$\n将关于 $N_k$ 的偏导数设为零：\n$$\n\\frac{\\partial \\mathcal{L}}{\\partial N_k} = \\mathcal{C}_k - \\lambda \\frac{V_k}{N_k^2} = 0 \\implies N_k = \\sqrt{\\lambda \\frac{V_k}{\\mathcal{C}_k}}\n$$\n我们将这个最优的 $N_k$ 代回方差约束中，以求得拉格朗日乘子 $\\lambda$：\n$$\n\\sum_{\\ell=0}^L \\frac{V_\\ell}{\\sqrt{\\lambda V_\\ell/\\mathcal{C}_\\ell}} = \\sum_{\\ell=0}^L \\sqrt{\\frac{V_\\ell \\mathcal{C}_\\ell}{\\lambda}} = \\frac{1}{\\sqrt{\\lambda}} \\sum_{\\ell=0}^L \\sqrt{V_\\ell \\mathcal{C}_\\ell} = \\frac{\\varepsilon^2}{2}\n$$\n这得到 $\\sqrt{\\lambda} = \\frac{2}{\\varepsilon^2} \\sum_{\\ell=0}^L \\sqrt{V_\\ell \\mathcal{C}_\\ell}$。\n\n现在，我们将这个 $\\sqrt{\\lambda}$ 代入总功的表达式中：\n$$\nW_{\\mathrm{MLMC}} = \\sum_{\\ell=0}^L N_\\ell \\mathcal{C}_\\ell = \\sum_{\\ell=0}^L \\left(\\sqrt{\\lambda \\frac{V_\\ell}{\\mathcal{C}_\\ell}}\\right) \\mathcal{C}_\\ell = \\sqrt{\\lambda} \\sum_{\\ell=0}^L \\sqrt{V_\\ell \\mathcal{C}_\\ell}\n$$\n$$\nW_{\\mathrm{MLMC}} = \\left( \\frac{2}{\\varepsilon^2} \\sum_{\\ell=0}^L \\sqrt{V_\\ell \\mathcal{C}_\\ell} \\right) \\left( \\sum_{\\ell=0}^L \\sqrt{V_\\ell \\mathcal{C}_\\ell} \\right) = \\frac{2}{\\varepsilon^2} \\left( \\sum_{\\ell=0}^L \\sqrt{V_\\ell \\mathcal{C}_\\ell} \\right)^2\n$$\n对于渐近分析，忽略常数因子 2，功的缩放关系如所要求：\n$$\nW_{\\mathrm{MLMC}}(\\varepsilon) \\sim \\varepsilon^{-2} \\left(\\sum_{\\ell=0}^{L} \\sqrt{\\operatorname{Var}(Q_{\\ell}-Q_{\\ell-1}) \\, \\mathcal{C}_{\\ell}}\\right)^{2}\n$$\n现在，我们使用给定的速率：$V_\\ell \\sim C_v 2^{-\\beta \\ell}$（对于 $\\ell \\ge 1$）和 $\\mathcal{C}_\\ell \\sim C_c 2^{\\gamma \\ell}$。和式中的项表现为 $\\sqrt{V_\\ell \\mathcal{C}_\\ell} \\sim \\sqrt{C_v C_c} 2^{(\\gamma-\\beta)\\ell/2}$。$\\ell=0$ 项 $\\sqrt{V_0 \\mathcal{C}_0}$ 是一个常数。当 $L \\to \\infty$ 时，和的渐近行为由几何级数 $\\sum_{\\ell=1}^L (2^{(\\gamma-\\beta)/2})^\\ell$ 确定。\n我们分析这个几何和的三种情况，其中 $L \\sim \\log(\\varepsilon^{-1})$：\n- **情况 1：$\\beta  \\gamma$**：指数 $(\\gamma-\\beta)/2$ 为负。当 $L \\to \\infty$ 时，几何级数收敛。和 $\\sum_{\\ell=0}^L \\sqrt{V_\\ell \\mathcal{C}_\\ell}$ 受一个与 $L$（因此也与 $\\varepsilon$）无关的常数限制。因此，总功为：\n$$\nW_{\\mathrm{MLMC}}(\\varepsilon) \\sim \\varepsilon^{-2} \\cdot (\\text{const.})^2 = O(\\varepsilon^{-2})\n$$\n- **情况 2：$\\beta = \\gamma$**：指数 $(\\gamma-\\beta)/2$ 为零。和式中的项是常数。和为 $\\sum_{\\ell=0}^L (\\text{const.}) \\sim L+1$。由于 $L \\sim \\log(\\varepsilon^{-1})$，和呈对数增长。总功为：\n$$\nW_{\\mathrm{MLMC}}(\\varepsilon) \\sim \\varepsilon^{-2} (L+1)^2 \\sim \\varepsilon^{-2} (\\log(\\varepsilon^{-1}))^2 = O(\\varepsilon^{-2}(\\log \\varepsilon^{-1})^2)\n$$\n- **情况 3：$\\beta  \\gamma$**：指数 $(\\gamma-\\beta)/2$ 为正。几何和由其最后一项 $2^{(\\gamma-\\beta)L/2}$ 主导。我们有 $L \\sim \\frac{1}{\\alpha}\\log_2(\\varepsilon^{-1})$，所以 $2^L \\sim (\\varepsilon^{-1})^{1/\\alpha}$。这得到：\n$$\n\\sum_{\\ell=0}^L \\sqrt{V_\\ell \\mathcal{C}_\\ell} \\sim 2^{(\\gamma-\\beta)L/2} = (2^L)^{(\\gamma-\\beta)/2} \\sim ((\\varepsilon^{-1})^{1/\\alpha})^{(\\gamma-\\beta)/2} = \\varepsilon^{-(\\gamma-\\beta)/(2\\alpha)}\n$$\n总功为：\n$$\nW_{\\mathrm{MLMC}}(\\varepsilon) \\sim \\varepsilon^{-2} \\left( \\varepsilon^{-(\\gamma-\\beta)/(2\\alpha)} \\right)^2 = \\varepsilon^{-2 - (\\gamma-\\beta)/\\alpha} = O(\\varepsilon^{-2 - (\\gamma-\\beta)/\\alpha})\n$$\n这些推导与任务 A.1 中指定的结果相符。\n\n**2. 单层级蒙特卡洛 (SLMC) 复杂度**\n\nSLMC 估计器在单个足够精细的层级 $L$ 上使用 $N$ 个样本：\n$$\n\\hat{Q}_L^{\\mathrm{SL}} = \\frac{1}{N} \\sum_{i=1}^N Q_L^{(i)}\n$$\n误差预算再次在偏差和方差之间分配。\n偏差约束 $|E[Q_L - Q]| \\le \\varepsilon/\\sqrt{2}$ 与 MLMC 情况相同，需要选择相同的最精细层级 $L$：\n$$\nL \\sim \\frac{1}{\\alpha} \\log_2(\\varepsilon^{-1})\n$$\nSLMC 估计器的方差为 $\\operatorname{Var}(\\hat{Q}_L^{\\mathrm{SL}}) = \\frac{\\operatorname{Var}(Q_L)}{N}$。这必须受 $\\varepsilon^2/2$ 限制。当 $L \\to \\infty$ 时，解 $u_L$ 收敛于 $u$，因此 $Q_L$ 收敛于 $Q$。于是，$\\operatorname{Var}(Q_L)$ 收敛到一个常数 $\\operatorname{Var}(Q)$，我们记为 $\\sigma_Q^2$。方差约束变为：\n$$\n\\frac{\\sigma_Q^2}{N} \\lesssim \\frac{\\varepsilon^2}{2} \\implies N \\gtrsim \\frac{2\\sigma_Q^2}{\\varepsilon^2}\n$$\n渐近地，所需的样本数量为 $N \\sim \\varepsilon^{-2}$。\n\nSLMC 的总功为 $W_{\\mathrm{SL}} = N \\cdot \\mathcal{C}_L$。代入 $N$ 和 $\\mathcal{C}_L$ 的缩放关系：\n$$\nN \\sim \\varepsilon^{-2}\n$$\n$$\n\\mathcal{C}_L \\sim C_c 2^{\\gamma L} \\sim C_c (2^L)^\\gamma \\sim C_c ((\\varepsilon^{-1})^{1/\\alpha})^\\gamma = C_c \\varepsilon^{-\\gamma/\\alpha}\n$$\n结合这些，得到 SLMC 的总功：\n$$\nW_{\\mathrm{SL}}(\\varepsilon) \\sim \\varepsilon^{-2} \\cdot \\varepsilon^{-\\gamma/\\alpha} = \\varepsilon^{-2 - \\gamma/\\alpha} = O(\\varepsilon^{-2-\\gamma/\\alpha})\n$$\n这个推导与任务 A.2 中指定的结果相符。\n\n### 任务 B：MLMC 优越性的验证\n\n我们被要求在条件 $\\alpha  \\beta/2$ 和 $\\beta  \\gamma$ 下验证 MLMC 优于 SLMC。\n\n从任务 A 可知，如果 $\\beta  \\gamma$，则 MLMC 复杂度为：\n$$\nW_{\\mathrm{MLMC}}(\\varepsilon) = O(\\varepsilon^{-2})\n$$\n对于基于蒙特卡洛的方法，这是最优复杂度，对应于指数 $e_{\\mathrm{MLMC}}=2$。\n\nSLMC 复杂度始终为：\n$$\nW_{\\mathrm{SL}}(\\varepsilon) = O(\\varepsilon^{-2 - \\gamma/\\alpha})\n$$\n对应于指数 $e_{\\mathrm{SL}} = 2 + \\gamma/\\alpha$。\n\n要使 MLMC 在复杂度指数方面严格优越，我们需要 $e_{\\mathrm{MLMC}}  e_{\\mathrm{SL}}$。\n比较指数：\n$$\n2  2 + \\frac{\\gamma}{\\alpha}\n$$\n这个不等式简化为 $\\gamma/\\alpha > 0$。问题陈述定义了 $\\gamma > 0$ 和 $\\alpha > 0$，因此这个条件总是满足的。\n因此，只要 $\\beta > \\gamma$，MLMC 就能达到最优的 $O(\\varepsilon^{-2})$ 复杂度，而 SLMC 的复杂度为 $O(\\varepsilon^{-2-\\gamma/\\alpha})$，总是严格更差。保证这一比较成立的条件就是 $\\beta > \\gamma$。\n\n附加条件 $\\alpha > \\beta/2$ 在数学上并非此特定比较所必需，但被提及为椭圆 PDE 具有足够正则的关注量的一种常见情况。它确保弱收敛速率 $\\alpha$ 相对于强收敛速率 $\\beta$ 足够高。例如，在有限元方法中，对于单元次数 $p$，人们可能会发现 $\\alpha \\approx p$ 和 $\\beta \\approx 2p$，此时 $\\alpha = \\beta/2$。拥有 $\\alpha > \\beta/2$ 确保了偏差不是限制整体性能的主导约束，这对 MLMC 是一个有利的情况。\n\n总之，保证 MLMC 达到最优 $O(\\varepsilon^{-2})$ 缩放的条件是 $\\beta > \\gamma$。在问题给出的 $\\alpha0$ 和 $\\gamma0$ 的基本假设下，这种缩放关系总是严格优于 SLMC 的 $O(\\varepsilon^{-2 - \\gamma/\\alpha})$ 缩放关系。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes MLMC and SLMC complexity metrics for a suite of test parameters.\n    \"\"\"\n    test_cases = [\n        # (alpha, beta, gamma)\n        (1.2, 2.0, 1.0),\n        (1.0, 2.0, 2.0),\n        (0.8, 1.2, 1.0),\n        (0.5, 0.8, 1.0),\n        (0.4, 0.7, 0.5),\n    ]\n\n    results = []\n    # Tolerance for floating-point equality checks\n    TOL = 1e-12\n\n    for case in test_cases:\n        alpha, beta, gamma = case\n\n        # 1. Compute MLMC work exponent (e_mlmc)\n        if beta  gamma:\n            e_mlmc = 2.0 + (gamma - beta) / alpha\n        else:  # beta >= gamma\n            e_mlmc = 2.0\n\n        # 2. Compute boolean for log factor (b_log)\n        # The log factor appears if beta is equal to gamma.\n        b_log = abs(beta - gamma)  TOL\n\n        # 3. Compute single-level work exponent (e_sl)\n        e_sl = 2.0 + gamma / alpha\n\n        # 4. Compute boolean for MLMC superiority (b_mlmc_better)\n        # This is true if the MLMC exponent is strictly smaller than the SLMC exponent.\n        b_mlmc_better = e_mlmc  e_sl\n\n        # 5. Compute boolean for validation condition (b_valid)\n        # This is true if alpha > beta/2 and beta > gamma and e_mlmc == 2.\n        # The condition e_mlmc == 2 is redundant given beta > gamma and the\n        # problem's rule for computing e_mlmc, but we include it for rigor.\n        is_alpha_gt_beta_half = alpha > beta / 2.0\n        is_beta_gt_gamma = beta > gamma\n        is_e_mlmc_optimal = abs(e_mlmc - 2.0)  TOL\n\n        b_valid = is_alpha_gt_beta_half and is_beta_gt_gamma and is_e_mlmc_optimal\n\n        # Store the results for this test case\n        case_result = [e_mlmc, b_log, e_sl, b_mlmc_better, b_valid]\n        results.append(case_result)\n\n    # Format the final output string\n    # E.g., [[2.0, False, 2.833, True, True], [2.0, True, 4.0, True, False]]\n    # Python's str() for lists, booleans, and floats matches the desired format.\n    # The default capitalization of booleans (True, False) is what is expected,\n    # and will need to be string-formatted for the final output.\n    result_strings = []\n    for res in results:\n        # Convert booleans to lowercase 'true'/'false' as per standard JSON/list notations.\n        # However, the example output `[x1,y1,z1,u1,v1]` does not specify a case for booleans.\n        # Python's default `str(True)` is 'True'. The problem description states floats or booleans\n        # and doesn't demand specific string representation like 'true'. Let's stick with Python's default representation.\n        # Re-reading prompt: \"each xi, yi, zi, ui, vi is a float or boolean\". str() is fine.\n        result_strings.append(str(res))\n    \n    print(f\"[{','.join(result_strings)}]\")\n\nsolve()\n```", "id": "3459226"}]}