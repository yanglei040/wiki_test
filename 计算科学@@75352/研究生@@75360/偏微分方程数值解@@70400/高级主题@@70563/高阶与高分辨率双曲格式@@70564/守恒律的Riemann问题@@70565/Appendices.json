{"hands_on_practices": [{"introduction": "本次练习将带您亲手实践守恒律中最基本的概念之一：激波。通过处理经典的伯格斯方程（Burgers' equation），您将从积分形式出发推导计算激波速度的朗金-雨贡纽条件（Rankine-Hugoniot condition），并应用拉克斯熵条件（Lax entropy condition）来验证其物理上的合理性。这项练习对于建立分析间断解的坚实基础至关重要[@problem_id:3441118]。", "problem": "考虑 Burgers 方程的标量守恒律，\n$$u_{t} + f(u)_{x} = 0,$$\n其通量为\n$$f(u) = \\frac{u^{2}}{2}.$$\n设初始数据为一个黎曼问题 (Riemann problem)，\n$$u(x,0) = \\begin{cases}\nu_{L},  x  0, \\\\\nu_{R},  x  0,\n\\end{cases}$$\n左状态为 $u_{L} = 2$，右状态为 $u_{R} = -1$。从应用于 $x = s t$ 处移动间断的守恒律积分形式出发，推导激波速度 $s$ 与守恒量和通量的跳跃之间的关系。使用此关系计算给定数据的激波速度 $s$。然后，使用由 $f'(u)$ 给出的特征速度，验证特征线从两侧汇入激波，即满足激波的 Lax 可取条件。将激波速度 $s$ 的最终值表示为一个精确数。答案无需四舍五入，也无需物理单位。", "solution": "该问题陈述是有效的。这是一个双曲守恒律理论中的适定问题，基于既定的数学原理，并包含获得唯一解所需的所有必要信息。\n\n我们给定标量守恒律，具体为 Burgers 方程：\n$$u_{t} + \\left(\\frac{u^{2}}{2}\\right)_{x} = 0$$\n问题考虑了一个黎曼初始条件，这是一个在 $x=0$ 处有单一间断的分段常数函数：\n$$u(x,0) = \\begin{cases}\nu_{L},  x  0 \\\\\nu_{R},  x  0\n\\end{cases}$$\n其中左状态为 $u_{L} = 2$，右状态为 $u_{R} = -1$。\n由于 $u_{L}  u_{R}$，特征线将会碰撞，形成一个称为激波的间断解。该激波沿直线 $x = s t$ 传播，其中 $s$ 是恒定的激波速度。\n\n首先，我们推导激波速度 $s$ 的关系式，即 Rankine-Hugoniot 条件。我们从守恒律在任意空间区间 $[x_{1}, x_{2}]$ 上的积分形式开始：\n$$\\frac{d}{dt} \\int_{x_{1}}^{x_{2}} u(x,t) \\, dx = f(u(x_{1},t)) - f(u(x_{2},t))$$\n选择区间 $[x_{1}, x_{2}]$，使其在时间 $t$ 包含激波位置 $x = st$。我们假设解是分段常数，在激波左侧取值为 $u_{L}$，在右侧取值为 $u_{R}$。积分可以在间断点处分开：\n$$\\int_{x_{1}}^{x_{2}} u(x,t) \\, dx = \\int_{x_{1}}^{st} u_{L} \\, dx + \\int_{st}^{x_{2}} u_{R} \\, dx = u_{L}(st-x_{1}) + u_{R}(x_{2}-st)$$\n现在，我们使用 Leibniz 积分法则对该表达式关于时间 $t$ 求导，注意 $x_1$ 和 $x_2$ 是固定的：\n$$\\frac{d}{dt} \\left[ u_{L}(st-x_{1}) + u_{R}(x_{2}-st) \\right] = u_{L}s - u_{R}s = s(u_{L} - u_{R})$$\n积分守恒律的右边计算为 $f(u(x_{1},t)) - f(u(x_{2},t))$。由于 $x_{1}  st  x_{2}$，我们有 $u(x_{1},t) = u_{L}$ 和 $u(x_{2},t) = u_{R}$。因此，右边为 $f(u_{L}) - f(u_{R})$。\n将两个表达式相等，得到 Rankine-Hugoniot 跳跃条件：\n$$s(u_{L} - u_{R}) = f(u_{L}) - f(u_{R})$$\n求解激波速度 $s$，我们得到：\n$$s = \\frac{f(u_{L}) - f(u_{R})}{u_{L} - u_{R}}$$\n这个关系将激波速度 $s$ 与守恒量的跳跃 $u_{L} - u_{R}$ 和通量的跳跃 $f(u_{L}) - f(u_{R})$ 联系起来。\n\n接下来，我们使用这个关系来计算给定数据的激波速度。\n通量函数是 $f(u) = \\frac{u^{2}}{2}$。\n给定的状态是 $u_{L} = 2$ 和 $u_{R} = -1$。\n我们计算相应的通量值：\n$$f(u_{L}) = f(2) = \\frac{2^{2}}{2} = \\frac{4}{2} = 2$$\n$$f(u_{R}) = f(-1) = \\frac{(-1)^{2}}{2} = \\frac{1}{2}$$\n现在我们将这些值代入 $s$ 的公式中：\n$$s = \\frac{f(u_{L}) - f(u_{R})}{u_{L} - u_{R}} = \\frac{2 - \\frac{1}{2}}{2 - (-1)} = \\frac{\\frac{3}{2}}{3} = \\frac{1}{2}$$\n激波速度是 $s = \\frac{1}{2}$。\n\n最后，我们必须通过检查 Lax 可取条件来验证此激波解在物理上是可取的。该条件表明，要使激波稳定，特征线必须从两侧进入激波。这等价于不等式：\n$$f'(u_{L})  s  f'(u_{R})$$\n此守恒律的特征速度由 $\\lambda(u) = f'(u)$ 给出。对于 Burgers 通量 $f(u) = \\frac{u^{2}}{2}$，其导数为：\n$$f'(u) = \\frac{d}{du}\\left(\\frac{u^{2}}{2}\\right) = u$$\n所以，特征速度就是 $\\lambda(u) = u$。Lax 条件变为：\n$$u_{L}  s  u_{R}$$\n我们代入给定的值和我们计算出的激波速度：\n$$u_{L} = 2$$\n$$u_{R} = -1$$\n$$s = \\frac{1}{2}$$\n我们检查不等式：\n$$2  \\frac{1}{2}  -1$$\n这个不等式是成立的。左侧的特征速度 $f'(u_L)=2$ 大于激波速度 $s=1/2$，意味着左侧的特征线会追上激波。右侧的特征速度 $f'(u_R)=-1$ 小于激波速度 $s=1/2$，意味着激波的移动速度快于右侧的特征线，从而超过它们。因此，特征线从两侧汇入激波，该解是一个可取的 Lax 激波。计算出的激波速度 $s = \\frac{1}{2}$ 是正确的。", "answer": "$$\\boxed{\\frac{1}{2}}$$", "id": "3441118"}, {"introduction": "在掌握了简单激波的基础上，下一个练习将深入到更复杂的非凸通量函数世界。现实世界中的物理模型常常表现出非凸性，这会导致比简单激波或稀疏波更丰富的波现象。在这个问题中，您将分析一个产生复合波的案例，并比较不同的物理正则化方法（消失粘性与色散）如何筛选出不同的解，从而突显数学模型与物理结果之间微妙的相互作用[@problem_id:3441181]。", "problem": "考虑标量守恒律 $u_{t} + f(u)_{x} = 0$，其非凸通量为 $f(u) = u^{3} - u$，黎曼初值数据为：当 $x  0$ 时，$u(x,0) = u_{L}$；当 $x  0$ 时，$u(x,0) = u_{R}$。其中 $u_{L}  0  u_{R}$ 且 $u_{L}  -\\frac{1}{2} u_{R}$。这些假设确保在消失黏性极限下存在一个复合波结构。\n\n在消失黏性正则化 $u_{t} + f(u)_{x} = \\varepsilon u_{xx}$（其中 $\\varepsilon \\to 0^{+}$）下，允许的黎曼解由一个从 $u_{L}$ 到中间状态 $u_{*}$ 的稀疏波，随后一个从 $u_{*}$ 到 $u_{R}$ 的单个激波组成。仅从 Rankine–Hugoniot 跳跃条件以及激波自相似地附着于稀疏波（即激波速度等于 $u_{*}$ 处的特征速度）的要求出发，推导出 $u_{*}$ 和由此产生的激波速度 $s_{\\mathrm{vv}}$。\n\n在 Korteweg–de Vries (KdV) 型色散正则化 $u_{t} + f(u)_{x} = \\mu u_{xxx}$（其中 $\\mu  0$ 且 $\\mu \\to 0^{+}$）下，黎曼解在右态 $u_{R}$ 附近呈现一个色散激波。利用围绕常数状态 $u = u_{R}$ 的线性化和群速度的定义，确定在零色散极限下的前缘速度 $s_{+}$。\n\n最后，计算带符号差 $\\Delta s = s_{\\mathrm{vv}} - s_{+}$，并将结果表示为关于 $u_{R}$ 的单个闭式解析表达式。无需四舍五入。将你的最终答案以单个表达式的形式报告。", "solution": "经核查，该问题在科学上基于双曲守恒律理论，是适定、内部一致且客观的。我们开始求解。\n\n标量守恒律由 $u_{t} + f(u)_{x} = 0$ 给出，非凸通量函数为 $f(u) = u^{3} - u$。特征速度为 $c(u) = f'(u) = 3u^{2} - 1$。黎曼问题由初值数据定义：当 $x  0$ 时，$u(x,0) = u_{L}$；当 $x  0$ 时，$u(x,0) = u_{R}$。\n\n### 第一部分：消失黏性解\n\n我们考虑消失黏性正则化 $u_{t} + f(u)_{x} = \\varepsilon u_{xx}$，其中 $\\varepsilon \\to 0^{+}$。问题指出，允许的解由一个从 $u_{L}$ 到中间状态 $u_{*}$ 的稀疏波，随后一个从 $u_{*}$ 到 $u_{R}$ 的激波组成。\n\n连接状态 $u_{*}$ 和 $u_{R}$ 的激波速度 $s$ 由 Rankine-Hugoniot 跳跃条件确定：\n$$s = \\frac{f(u_{R}) - f(u_{*})}{u_{R} - u_{*}}$$\n代入通量函数 $f(u) = u^{3} - u$：\n$$s = \\frac{(u_{R}^{3} - u_{R}) - (u_{*}^{3} - u_{*})}{u_{R} - u_{*}} = \\frac{u_{R}^{3} - u_{*}^{3} - (u_{R} - u_{*})}{u_{R} - u_{*}}$$\n使用恒等式 $a^{3}-b^{3} = (a-b)(a^{2}+ab+b^{2})$，我们将其化简为：\n$$s = u_{R}^{2} + u_{R}u_{*} + u_{*}^{2} - 1$$\n问题指明了一个复合波，其中激波附着于稀疏波。这意味着激波速度必须等于中间状态 $u_{*}$ 处的特征速度。该条件由下式给出：\n$$s = c(u_{*}) = f'(u_{*}) = 3u_{*}^{2} - 1$$\n令激波速度 $s$ 的两个表达式相等：\n$$u_{R}^{2} + u_{R}u_{*} + u_{*}^{2} - 1 = 3u_{*}^{2} - 1$$\n$$u_{R}^{2} + u_{R}u_{*} = 2u_{*}^{2}$$\n整理各项得到一个关于 $u_{*}$ 的二次方程：\n$$2u_{*}^{2} - u_{R}u_{*} - u_{R}^{2} = 0$$\n我们使用二次公式 $u_{*} = \\frac{-b \\pm \\sqrt{b^{2}-4ac}}{2a}$ 求解 $u_{*}$，其中 $a=2$, $b=-u_{R}$, $c=-u_{R}^{2}$：\n$$u_{*} = \\frac{-(-u_{R}) \\pm \\sqrt{(-u_{R})^{2} - 4(2)(-u_{R}^{2})}}{2(2)} = \\frac{u_{R} \\pm \\sqrt{u_{R}^{2} + 8u_{R}^{2}}}{4} = \\frac{u_{R} \\pm \\sqrt{9u_{R}^{2}}}{4}$$\n由于问题陈述 $u_{R}0$，我们有 $|u_{R}|=u_{R}$。\n$$u_{*} = \\frac{u_{R} \\pm 3u_{R}}{4}$$\n这得出了 $u_{*}$ 的两个可能的解：\n$$u_{*}^{(1)} = \\frac{u_{R} + 3u_{R}}{4} = u_{R}$$\n$$u_{*}^{(2)} = \\frac{u_{R} - 3u_{R}}{4} = -\\frac{1}{2}u_{R}$$\n解 $u_{*} = u_{R}$ 对应于没有激波的平凡情况。对于复合波而言，物理上有意义的中间状态是 $u_{*} = -\\frac{1}{2}u_{R}$。问题的条件 $u_L  -\\frac{1}{2}u_R$ 确保了可以形成这样一个从 $u_L$ 到 $u_*$ 的稀疏波（$u_L  u_*$）。\n\n那么，消失黏性解的激波速度 $s_{\\mathrm{vv}}$ 由 $f'(u_{*})$ 给出：\n$$s_{\\mathrm{vv}} = f'(-\\frac{1}{2}u_{R}) = 3(-\\frac{1}{2}u_{R})^{2} - 1 = 3(\\frac{1}{4}u_{R}^{2}) - 1$$\n$$s_{\\mathrm{vv}} = \\frac{3}{4}u_{R}^{2} - 1$$\n\n### 第二部分：色散解\n\n接下来，我们考虑 Korteweg-de Vries (KdV) 型正则化 $u_{t} + f(u)_{x} = \\mu u_{xxx}$，其中 $\\mu  0$。色散激波的前缘传播到未扰动的状态 $u_{R}$ 中。为求其速度，我们在 $u = u_{R}$ 附近对该方程进行线性化。设 $u(x,t) = u_{R} + \\tilde{u}(x,t)$，其中 $\\tilde{u}$ 是一个小扰动。\n将此代入方程并只保留 $\\tilde{u}$ 的线性项：\n$$(\\tilde{u})_{t} + (f(u_{R}) + f'(u_{R})\\tilde{u})_{x} = \\mu (\\tilde{u})_{xxx}$$\n$$\\tilde{u}_{t} + f'(u_{R})\\tilde{u}_{x} = \\mu \\tilde{u}_{xxx}$$\n我们寻求形式为 $\\tilde{u}(x,t) = A\\exp(i(kx - \\omega t))$ 的平面波解。将其代入线性化方程，得到色散关系：\n$$-i\\omega + ikf'(u_{R}) = \\mu(ik)^{3} = -i\\mu k^{3}$$\n$$\\omega(k) = kf'(u_{R}) + \\mu k^{3}$$\n波包传播的速度由群速度 $c_{g}(k) = \\frac{d\\omega}{dk}$ 给出：\n$$c_{g}(k) = \\frac{d}{dk}(kf'(u_{R}) + \\mu k^{3}) = f'(u_{R}) + 3\\mu k^{2}$$\n色散激波的前缘由无穷小振荡组成，对应于长波极限（$k \\to 0$）。因此，此前缘的速度 $s_{+}$ 是在 $k=0$ 处计算的群速度：\n$$s_{+} = \\lim_{k \\to 0} c_{g}(k) = f'(u_{R}) + 3\\mu(0)^{2} = f'(u_{R})$$\n使用特征速度的表达式 $f'(u) = 3u^{2} - 1$：\n$$s_{+} = 3u_{R}^{2} - 1$$\n\n### 第三部分：最终计算\n\n最后，我们计算带符号差 $\\Delta s = s_{\\mathrm{vv}} - s_{+}$。\n$$\\Delta s = \\left(\\frac{3}{4}u_{R}^{2} - 1\\right) - \\left(3u_{R}^{2} - 1\\right)$$\n$$\\Delta s = \\frac{3}{4}u_{R}^{2} - 3u_{R}^{2} = \\left(\\frac{3}{4} - \\frac{12}{4}\\right)u_{R}^{2}$$\n$$\\Delta s = -\\frac{9}{4}u_{R}^{2}$$\n结果是按要求得出的，一个关于 $u_{R}$ 的闭式解析表达式。", "answer": "$$\\boxed{-\\frac{9}{4}u_{R}^{2}}$$", "id": "3441181"}, {"introduction": "解析解虽然强大，但仅限于简单情况。最后的这项练习将通过关注近似黎曼求解器，搭建起从理论到计算流体力学实践世界的桥梁。您将实现并比较几个基础的数值通量，包括精确的Godunov通量、高效但有缺陷的Roe通量，以及满足熵条件的HLL格式等替代方案。这个计算练习将让您对熵违背（entropy violation）等关键数值问题以及现代求解器中熵修正（entropy fix）的必要性有具体的理解[@problem_id:3441167]。", "problem": "考虑一维标量守恒律 $u_t + f(u)_x = 0$，其通量 $f(u) = \\tfrac{1}{2} u^2$ 为严格凸函数（无粘性 Burgers 方程）。经典的 Riemann 问题由分段常数的初值数据构成，其左、右状态分别为 $x  0$ 时的 $u(x,0) = u_L$ 和 $x  0$ 时的 $u(x,0) = u_R$。Roe 型近似 Riemann 解法器将通量线性化，并用一个在界面上以恒定特征速度传播的单个间断来替代非线性波。众所周知，对于跨音速稀疏波数据（$u_L  0  u_R$），这种 Roe 线性化会产生违反熵条件的膨胀激波。熵修正通过修改声速点附近的耗散来消除这些非物理伪影。\n\n从守恒律、特征线和弱解的基本定义出发，并利用 $f(u)$ 的严格凸性，以基于原理的方式推导以下各项：\n\n- 对于具有数据 $(u_L,u_R)$ 的 Riemann 问题，在 $x = 0$ 处的精确界面状态和相应的 Godunov 通量。推导中需区分激波（$u_L  u_R$）和稀疏波（$u_L \\le u_R$），并使用 Lax 熵条件来确定正确的物理有理解。您的推导必须说明，为何对于 $u_L \\le u_R$ 的稀疏波，在自相似坐标 $\\xi = x/t = 0$ 处的界面状态在 $0  u_L$ 时等于 $u_L$，在 $0  u_R$ 时等于 $u_R$，而在其他情况下等于满足 $f'(u^\\star) = 0$ 的唯一解 $u^\\star$（此处 $u^\\star = 0$）。同时必须推导出精确的 Godunov 通量 $F_\\text{G}(u_L,u_R) = f(u^\\star)$。\n\n- 通过使用从 Rankine–Hugoniot 条件和 $f(u)$ 的严格凸性推导出的恒定 Roe 特征速度，对非线性守恒律进行线性化，从而得到的界面处 Roe 型近似数值通量。解释这种线性化如何将跨音速稀疏波（$u_L  0  u_R$）压缩为具有单一速度的单个间断，以及为何这会通过产生膨胀激波而违反熵条件。根据您的推导结果，给出显式的 Roe 通量表达式。\n\n- 一种 Harten–Hyman 熵修正方法，该方法通过将 Roe 速度的绝对值替换为一个在由左、右特征速度决定的区间内的二次截断函数，从而对单个特征场的声速点附近的 Roe 耗散进行正则化。对于特征速度为 $f'(u) = u$ 的 $f(u) = \\tfrac{1}{2}u^2$，指定一个基于 $u_L$ 和 $u_R$ 的阈值，并说明修正后的耗散如何消除 $u_L  0  u_R$ 情况下的违反熵条件的膨胀激波。\n\n- 一种用于单场凸通量的双波 Harten–Lax–van Leer (HLL) 通量，其中使用 Einfeldt 波速界，并将左、右特征速度作为信号速度。解释所得到的双波近似如何满足熵条件，并量化其相对于精确 Godunov 通量的扩散性。\n\n然后，在一个程序中实现这些通量，该程序需要：\n\n1. 计算 Burgers 通量 $f(u)=\\tfrac{1}{2}u^2$ 在界面 $x=0$ 处的精确 Godunov 通量 $F_\\text{G}(u_L,u_R)$。\n2. 对于相同的界面和相同的数据 $(u_L,u_R)$，计算无熵修正的 Roe 通量、带 Harten–Hyman 二次截断熵修正的 Roe 通量，以及使用 Einfeldt 速度的 Harten–Lax–van Leer 通量。\n3. 通过为每个测试用例返回数值通量与精确 Godunov 通量之间的绝对偏差来量化每种熵修正的影响，即三个值：$\\lvert F_\\text{Roe} - F_\\text{G} \\rvert$、$\\lvert F_\\text{Roe+HH} - F_\\text{G} \\rvert$ 和 $\\lvert F_\\text{HLL(E)} - F_\\text{G} \\rvert$。\n\n使用以下 Riemann 数据 $(u_L,u_R)$ 测试套件，这些数据旨在测试跨音速稀疏波、非跨音速稀疏波、激波和边界情况：\n\n- 用例 1：$u_L = -1.0$, $u_R = 2.0$ (跨音速稀疏波)。\n- 用例 2：$u_L = -2.0$, $u_R = 0.5$ (跨音速稀疏波)。\n- 用例 3：$u_L = -0.5$, $u_R = 0.5$ (弱跨音速稀疏波)。\n- 用例 4：$u_L = 0.0$, $u_R = 3.0$ (左侧接触声速点的稀疏波)。\n- 用例 5：$u_L = -3.0$, $u_R = 0.0$ (右侧接触声速点的稀疏波)。\n- 用例 6：$u_L = 1.0$, $u_R = 3.0$ (非跨音速稀疏波)。\n- 用例 7：$u_L = 2.0$, $u_R = -1.0$ (激波)。\n\n对于每个用例，计算绝对偏差三元组 $(\\lvert F_\\text{Roe} - F_\\text{G} \\rvert,\\lvert F_\\text{Roe+HH} - F_\\text{G} \\rvert,\\lvert F_\\text{HLL(E)} - F_\\text{G} \\rvert)$ 作为实数。\n\n最终输出格式：您的程序应生成单行输出，其中包含结果，格式为由方括号括起来的三元组组成的逗号分隔列表，每个测试用例一个三元组，格式完全如下：\n$[[e_{1,\\text{Roe}},e_{1,\\text{HH}},e_{1,\\text{HLL(E)}}],[e_{2,\\text{Roe}},e_{2,\\text{HH}},e_{2,\\text{HLL(E)}}],\\dots,[e_{7,\\text{Roe}},e_{7,\\text{HH}},e_{7,\\text{HLL(E)}}]]$，\n其中每个 $e_{i,\\cdot}$ 都是一个浮点数。不应打印任何额外的文本。", "solution": "一维标量守恒律由 $u_t + f(u)_x = 0$ 给出，对于无粘性 Burgers 方程，其严格凸通量函数为 $f(u) = \\frac{1}{2} u^2$。特征速度为 $\\lambda(u) = f'(u) = u$。我们考虑的是一个初值数据为 $x  0$ 时 $u(x,0) = u_L$ 和 $x  0$ 时 $u(x,0) = u_R$ 的 Riemann 问题。该问题的解是自相似的，仅依赖于变量 $\\xi = x/t$。界面 $\\xi=0$ 处的状态 $u^\\star$ 及其对应的通量 $f(u^\\star)$ 决定了 Godunov 通量。\n\n**1. 精确 Godunov 通量，$F_\\text{G}(u_L, u_R)$**\n\nGodunov 通量定义为 $F_\\text{G}(u_L, u_R) = f(u(\\xi=0))$，其中 $u(\\xi)$ 是 Riemann 问题的精确、满足熵条件的解。\n\n**激波 ($u_L  u_R$)**：\n当特征线相交时，会形成一个间断解（激波）。其速度 $s$ 由 Rankine-Hugoniot 条件确定，该条件保证了跨间断的守恒性：\n$$s(u_R - u_L) = f(u_R) - f(u_L)$$\n$$s = \\frac{f(u_R) - f(u_L)}{u_R - u_L} = \\frac{\\frac{1}{2}u_R^2 - \\frac{1}{2}u_L^2}{u_R - u_L} = \\frac{1}{2}(u_L + u_R)$$\n对于严格凸通量，此激波的物理可容许性由 Lax 熵条件决定，该条件要求特征线从两侧进入激波：$\\lambda(u_L)  s  \\lambda(u_R)$。对于 Burgers 方程，即为 $u_L  s  u_R$。该条件当且仅当 $u_L  u_R$ 时满足。\n解是一个以速度 $s$ 传播的单个跳跃间断：\n$$u(\\xi) = \\begin{cases} u_L,  \\xi  s \\\\ u_R,  \\xi  s \\end{cases}$$\n界面处的状态 $u(\\xi=0)$ 取决于 $s$ 的符号。\n- 如果 $s  0$，射线 $\\xi=0$ 位于激波左侧，因此 $u(\\xi=0) = u_L$。通量为 $F_\\text{G} = f(u_L)$。\n- 如果 $s  0$，射线 $\\xi=0$ 位于激波右侧，因此 $u(\\xi=0) = u_R$。通量为 $F_\\text{G} = f(u_R)$。\n- 如果 $s = 0$，激波在界面处是静止的。这种情况发生在 $u_L = -u_R$ 时。通量在激波两侧是恒定的，$f(u_L)=f(u_R)$，因此 $F_\\text{G} = f(u_L) = f(u_R)$。\n总结对于 $u_L  u_R$ 的情况：\n$$F_\\text{G}(u_L, u_R) = \\begin{cases} f(u_L)  \\text{若 } s = \\frac{1}{2}(u_L + u_R) \\ge 0 \\\\ f(u_R)  \\text{若 } s  0 \\end{cases}$$\n\n**稀疏波 ($u_L \\le u_R$)**：\n当特征线散开时，会形成一个称为稀疏波的连续自相似解。该解通过所有满足 $\\lambda(u) = u$ 位于 $\\lambda(u_L) = u_L$ 和 $\\lambda(u_R) = u_R$ 之间的中间状态 $u$，平滑地连接 $u_L$ 和 $u_R$。解由下式给出：\n$$u(\\xi) = \\begin{cases} u_L,  \\xi  u_L \\\\ \\xi,  u_L \\le \\xi \\le u_R \\\\ u_R,  \\xi  u_R \\end{cases}$$\n界面处的状态 $u^\\star = u(\\xi=0)$ 由 $\\xi=0$相对于扇形区 $[u_L, u_R]$ 的位置决定。\n- 如果 $u_L  0$（意味着 $u_R  u_L  0$），则 $\\xi=0$ 位于扇形区左侧（$0  u_L$）。状态为 $u^\\star = u_L$。\n- 如果 $u_R  0$（意味着 $u_L  u_R  0$），则 $\\xi=0$ 位于扇形区右侧（$u_R  0$）。状态为 $u^\\star = u_R$。\n- 如果 $u_L \\le 0 \\le u_R$，界面 $\\xi=0$ 位于稀疏波扇形区内部。状态为 $u^\\star=\\xi=0$。这就是声速点，即满足 $f'(u^\\star)=u^\\star=0$ 的状态 $u^\\star$。\nGodunov 通量为 $F_\\text{G} = f(u^\\star)$。对于 $u_L \\le 0 \\le u_R$ 的情况，这给出 $F_\\text{G} = f(0) = 0$。\n总结对于 $u_L \\le u_R$ 的情况：\n$$F_\\text{G}(u_L, u_R) = \\begin{cases} f(u_L)  \\text{若 } 0  u_L \\\\ 0  \\text{若 } u_L \\le 0 \\le u_R \\\\ f(u_R)  \\text{若 } u_R  0 \\end{cases}$$\n\n**2. Roe 近似 Riemann 解法器**\n\nRoe 解法器在界面处将非线性守恒律 $u_t + f(u)_x = 0$ 线性化为 $u_t + \\tilde{a} u_x=0$。常数系数 $\\tilde{a} = \\tilde{a}(u_L, u_R)$，即所谓的 Roe 平均速度，必须满足性质 $f(u_R) - f(u_L) = \\tilde{a} (u_R - u_L)$。对于任何状态对 $(u_L, u_R)$，这给出：\n$$\\tilde{a} = \\frac{f(u_R) - f(u_L)}{u_R - u_L} = \\frac{1}{2}(u_L + u_R)$$\n由此产生的线性平流方程的数值通量是标准的迎风通量，可以表示为特征分解（或粘性）形式：\n$$F_\\text{Roe}(u_L, u_R) = \\frac{1}{2} \\left[ f(u_L) + f(u_R) \\right] - \\frac{1}{2} |\\tilde{a}| (u_R - u_L)$$\n该格式用一个以速度 $\\tilde{a}$ 传播的单个间断取代了 Riemann 问题的复杂波结构。对于激波（$u_L  u_R$），$\\tilde{a}$ 等于精确的激波速度 $s$，此时 Roe 解法器是精确的。\n\n**熵违背**：考虑跨音速稀疏波，其中 $u_L  0  u_R$。精确解是一个跨越负速度到正速度的特征扇。Roe 解法器将此扇形区压缩为一个以速度 $\\tilde{a} = (u_L+u_R)/2$ 移动的单个间断。例如，如果我们选择 $u_L = -1$ 和 $u_R = 2$，则 $\\tilde{a} = 0.5$。左、右两侧的特征速度分别为 $\\lambda(u_L) = -1$ 和 $\\lambda(u_R) = 2$。由 Roe 产生的单个间断满足 $\\lambda(u_L)  \\tilde{a}  \\lambda(u_R)$，这是膨胀激波的条件。这样的解违反了热力学第二定律（熵条件），是非物理的。这种失效的产生是因为耗散项 $\\frac{1}{2}|\\tilde{a}|(u_R-u_L)$ 变得过小，如果 $u_L = -u_R$ 甚至为零，而反向移动的特征线的存在需要显著的数值耗散。\n\n**3. Harten-Hyman 熵修正**\n\n为了纠正熵违背，当穿过声速点时必须增加数值耗散。Harten-Hyman 熵修正修改了 Roe 通量中的耗散系数 $|\\tilde{a}|$。当界面左、右两侧的特征速度跨越声速点时，即对于稀疏波有 $\\lambda(u_L)  0  \\lambda(u_R)$ 时，应用此修正。对于 Burgers 方程，这正是跨音速稀疏波的情况 $u_L  0  u_R$。\n\n该修正用一个在零点附近的小区间内严格为正的正则化版本替换 $|\\tilde{a}|$。指定一个二次截断：\n$$|\\tilde{a}|_{HH} = \\begin{cases} |\\tilde{a}|  \\text{若 } |\\tilde{a}| \\ge \\delta \\\\ \\frac{\\tilde{a}^2 + \\delta^2}{2\\delta}  \\text{若 } |\\tilde{a}|  \\delta \\end{cases}$$\n阈值 $\\delta$ 基于特征速度的跨度。对于 Burgers 方程，其中 $\\lambda_L=u_L$ 和 $\\lambda_R=u_R$，一个常见的选择是 $\\delta = \\frac{1}{2}(\\lambda_R - \\lambda_L) = \\frac{1}{2}(u_R-u_L)$，假设 $u_L \\le u_R$。对于稀疏波，激活条件 $|\\tilde{a}|  \\delta$ 展开为 $|\\frac{u_L+u_R}{2}|  \\frac{u_R-u_L}{2}$，这等价于 $u_L  0$ 和 $u_R  0$。因此，此修正对所有跨音速稀疏波都会自动触发。\n\n熵修正后的 Roe 通量, $F_\\text{Roe+HH}$, 为：\n$$F_\\text{Roe+HH} = \\frac{1}{2} \\left[ f(u_L) + f(u_R) \\right] - \\frac{1}{2} |\\tilde{a}|_{mod} (u_R - u_L)$$\n其中 $|\\tilde{a}|_{mod}$ 是在跨音速稀疏波情况之外的 $|\\tilde{a}|$，而在跨音速稀疏波情况下为 $|\\tilde{a}|_{HH}$。对于 Burgers 方程，这种对 $\\delta$ 的特定选择和二次修正对于跨音速稀疏波会得到精确的 Godunov 通量，因为修正后的耗散项恰好抵消了其他项，从而得到 $F_\\text{Roe+HH}=0$，即 $F_\\text{G}$。\n\n**4. Harten-Lax-van Leer (HLL) 通量**\n\nHLL 解法器使用 Riemann 解的双波模型，其中信号速度 $S_L$ 和 $S_R$ 界定了物理波速。解被假设为：当 $x/t  S_L$ 时 $u(x/t) = u_L$，当 $x/t  S_R$ 时 $u(x/t)=u_R$，以及当 $S_L  x/t  S_R$ 时为常数中间状态 $u_{HLL}^\\star$。在区域 $[S_L, S_R]$ 上应用守恒律的积分形式，可以得到中间状态的通量，当 $S_L  0  S_R$ 时，该通量即为 HLL 通量：\n$$F_\\text{HLL}(u_L, u_R) = \\frac{S_R f(u_L) - S_L f(u_R) + S_L S_R (u_R - u_L)}{S_R - S_L}$$\n如果 $S_L \\ge 0$，界面只看到左状态，因此 $F_\\text{HLL} = f(u_L)$。如果 $S_R \\le 0$，它只看到右状态，$F_\\text{HLL} = f(u_R)$。\n\n对于标量凸问题，Einfeldt 波速估计使用特征速度的最小值和最大值作为信号速度。对于 Burgers 方程，$\\lambda(u)=u$，所以：\n$$S_L = \\min(\\lambda(u_L), \\lambda(u_R)) = \\min(u_L, u_R)$$\n$$S_R = \\max(\\lambda(u_L), \\lambda(u_R)) = \\max(u_L, u_R)$$\n在跨音速稀疏波（$u_L  0  u_R$）中，这种选择确保了 $S_L \\le 0 \\le S_R$，从而应用了正确的公式并防止了熵违背。使用这些波速，HLL 格式是内在地满足熵条件的。然而，通过将整个 Riemann 扇形区压缩为单个常数状态，它比 Godunov 或熵修正的 Roe 格式引入了更多的数值扩散，从而抹平了接触间断和稀疏波。这种扩散性通过偏差 $|F_\\text{HLL} - F_G|$ 来衡量。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes and compares numerical fluxes for the inviscid Burgers' equation.\n    \"\"\"\n    \n    # Test cases (u_L, u_R)\n    test_cases = [\n        (-1.0, 2.0),  # Case 1: Transonic rarefaction\n        (-2.0, 0.5),  # Case 2: Transonic rarefaction\n        (-0.5, 0.5),  # Case 3: Weak transonic rarefaction\n        (0.0, 3.0),   # Case 4: Rarefaction touching sonic point (left)\n        (-3.0, 0.0),  # Case 5: Rarefaction touching sonic point (right)\n        (1.0, 3.0),   # Case 6: Non-transonic rarefaction\n        (2.0, -1.0),  # Case 7: Shock\n    ]\n\n    results = []\n    \n    # Flux function for Burgers' equation\n    def f(u):\n        return 0.5 * u**2\n\n    def compute_godunov_flux(u_L, u_R):\n        \"\"\"Computes the exact Godunov flux for Burgers' equation.\"\"\"\n        if u_L  u_R:  # Shock wave\n            s = 0.5 * (u_L + u_R)\n            if s = 0.0:\n                return f(u_L)\n            else:\n                return f(u_R)\n        else:  # Rarefaction wave (or constant state)\n            if u_L  0.0:\n                return f(u_L)\n            elif u_R  0.0:\n                return f(u_R)\n            else:  # u_L = 0 = u_R (transonic rarefaction)\n                return 0.0 # f(0.0)\n\n    def compute_roe_flux(u_L, u_R):\n        \"\"\"Computes the Roe flux without entropy fix.\"\"\"\n        a_roe = 0.5 * (u_L + u_R)\n        return 0.5 * (f(u_L) + f(u_R)) - 0.5 * abs(a_roe) * (u_R - u_L)\n\n    def compute_roehh_flux(u_L, u_R):\n        \"\"\"Computes the Roe flux with the Harten-Hyman entropy fix.\"\"\"\n        a_roe = 0.5 * (u_L + u_R)\n        diss_coeff = abs(a_roe)\n        \n        # Check for transonic rarefaction: u_L  0  u_R\n        if u_L  0.0 and u_R  0.0:\n            lambda_L, lambda_R = u_L, u_R\n            delta = 0.5 * (lambda_R - lambda_L)\n            if abs(a_roe)  delta:\n                diss_coeff = (a_roe**2 + delta**2) / (2.0 * delta)\n        \n        return 0.5 * (f(u_L) + f(u_R)) - 0.5 * diss_coeff * (u_R - u_L)\n\n    def compute_hll_flux(u_L, u_R):\n        \"\"\"Computes the HLL flux with Einfeldt-type wave speeds.\"\"\"\n        lambda_L, lambda_R = u_L, u_R\n        \n        # Einfeldt wave speed estimates for scalar convex flux\n        S_L = min(lambda_L, lambda_R)\n        S_R = max(lambda_L, lambda_R)\n\n        if S_L = 0.0:\n            return f(u_L)\n        elif S_R = 0.0:\n            return f(u_R)\n        else: # S_L  0  S_R\n            f_L, f_R = f(u_L), f(u_R)\n            numerator = S_R * f_L - S_L * f_R + S_L * S_R * (u_R - u_L)\n            denominator = S_R - S_L\n            return numerator / denominator\n\n    for u_L, u_R in test_cases:\n        F_G = compute_godunov_flux(u_L, u_R)\n        F_Roe = compute_roe_flux(u_L, u_R)\n        F_Roe_HH = compute_roehh_flux(u_L, u_R)\n        F_HLL = compute_hll_flux(u_L, u_R)\n\n        e_roe = abs(F_Roe - F_G)\n        e_hh = abs(F_Roe_HH - F_G)\n        e_hll = abs(F_HLL - F_G)\n\n        results.append([e_roe, e_hh, e_hll])\n    \n    # Format the final output string\n    result_str = \"[[\" + \"],[\".join(\",\".join(map(str, triple)) for triple in results) + \"]]\"\n    print(result_str)\n\nsolve()\n```", "id": "3441167"}]}