{"hands_on_practices": [{"introduction": "稳定性是数值格式的基本要求，但仅有稳定性并不足以保证解的质量。一个稳定的格式仍然可能引入显著的误差，扭曲物理现象。本练习旨在通过对最基本的一阶迎风格式进行傅里叶分析，来量化这些误差。通过推导单色波模式下的振幅和相位误差，您将亲自揭示数值耗散（振幅误差）和数值频散（相位误差）的来源，这是理解和评估任何对流问题数值方法行为的基础。[@problem_id:3380633]", "problem": "考虑一维周期性区域上的线性双曲系统 $q_{t} + A q_{x} = 0$，其中 $A \\in \\mathbb{R}^{m \\times m}$ 是一个具有实谱的可对角化的常数矩阵。设 $A = R \\Lambda R^{-1}$，其中 $\\Lambda = \\operatorname{diag}(a_{1},\\dots,a_{m})$。我们关注与特征值 $a  0$ 和特征向量 $r \\in \\mathbb{R}^{m}$ 相关联的单个右行特征场，使得相应的标量特征变量 $u = \\ell^{\\top} q$（对于所选场，有 $\\ell^{\\top} R = e_{j}^{\\top}$）满足标量平流方程 $u_{t} + a u_{x} = 0$。\n\n在均匀网格 $x_{i} = i\\,\\Delta x$ 和时间层 $t^{n} = n\\,\\Delta t$上，考虑应用于所选特征场的显式一阶迎风有限差分格式，\n$$\nu_{i}^{n+1} = u_{i}^{n} - \\lambda \\left(u_{i}^{n} - u_{i-1}^{n}\\right),\n$$\n其中 $\\lambda = \\frac{a\\,\\Delta t}{\\Delta x}$ 是库朗数。假设一个与所选特征向量对齐的单色离散模态，\n$$\nu_{i}^{n} = \\exp\\!\\left(i\\,\\kappa\\, i - i\\,\\omega\\, n\\right), \\quad \\kappa = k\\,\\Delta x,\n$$\n其中 $k$ 是连续波数，$\\kappa$ 是无量纲离散波数。通过 $u_{i}^{n+1} = G(\\kappa)\\,u_{i}^{n}$ 定义单步数值放大因子 $G(\\kappa)$，并定义：\n- 单步振幅误差为 $\\delta A(\\kappa) = |G(\\kappa)| - 1$，\n- 单步相位误差为 $\\delta \\phi(\\kappa) = \\phi(\\kappa) + \\lambda\\,\\kappa$，其中 $\\phi(\\kappa) = \\arg\\!\\left(G(\\kappa)\\right)$ 且每步的精确相移为 $-\\lambda\\,\\kappa$。\n\n从上述基本定义出发，并结合使用傅里叶（冯·诺依曼）分析以及对有限差分格式的基于泰勒展开的修正方程分析，推导 $\\delta A(\\kappa)$ 和 $\\delta \\phi(\\kappa)$ 作为 $\\lambda$ 和 $\\kappa$ 的函数的关于 $\\kappa$ 的主阶表达式。明确写出主阶项的最终表达式。将相位误差以每时间步的弧度为单位表示。最终答案必须是由 $\\left(\\delta A(\\kappa),\\,\\delta \\phi(\\kappa)\\right)$ 组成的闭式解析表达式。", "solution": "该问题要求推导线性平流方程的一阶迎风格式的振幅和相位误差的主阶表达式。我们将使用傅里叶（冯·诺依曼）分析来推导这些表达式。\n\n标量平流方程由下式给出\n$$u_{t} + a u_{x} = 0$$\n其中 $a  0$ 是恒定的波速。\n一阶迎风有限差分格式为\n$$u_{i}^{n+1} = u_{i}^{n} - \\lambda \\left(u_{i}^{n} - u_{i-1}^{n}\\right)$$\n其中 $\\lambda = \\frac{a\\,\\Delta t}{\\Delta x}$ 是库朗数。\n\n为进行傅里叶分析，我们将形如 $u_{j}^{m} = G(\\kappa)^m \\exp(i\\kappa j)$ 的单色模态代入该格式。这里，$\\kappa = k\\,\\Delta x$ 是无量纲波数，$G(\\kappa)$ 是复放大因子。\n$$\nG(\\kappa)^{n+1} e^{i\\kappa i} = G(\\kappa)^{n} e^{i\\kappa i} - \\lambda \\left(G(\\kappa)^{n} e^{i\\kappa i} - G(\\kappa)^{n} e^{i\\kappa (i-1)}\\right)\n$$\n用 $G(\\kappa)^{n} e^{i\\kappa i}$ 除，我们得到放大因子的表达式：\n$$\nG(\\kappa) = 1 - \\lambda \\left(1 - e^{-i\\kappa}\\right)\n$$\n使用欧拉公式 $e^{-i\\kappa} = \\cos(\\kappa) - i\\sin(\\kappa)$，我们可以用其实部和虚部来表示 $G(\\kappa)$：\n$$\nG(\\kappa) = 1 - \\lambda(1 - \\cos(\\kappa) + i\\sin(\\kappa)) = (1 - \\lambda + \\lambda\\cos(\\kappa)) - i\\lambda\\sin(\\kappa)\n$$\n\n单步振幅误差定义为 $\\delta A(\\kappa) = |G(\\kappa)| - 1$。我们首先计算 $G(\\kappa)$ 模的平方：\n$$\n|G(\\kappa)|^2 = (1 - \\lambda + \\lambda\\cos(\\kappa))^2 + (-\\lambda\\sin(\\kappa))^2\n$$\n$$\n|G(\\kappa)|^2 = (1-\\lambda)^2 + 2\\lambda(1-\\lambda)\\cos(\\kappa) + \\lambda^2\\cos^2(\\kappa) + \\lambda^2\\sin^2(\\kappa)\n$$\n$$\n|G(\\kappa)|^2 = (1-\\lambda)^2 + 2\\lambda(1-\\lambda)\\cos(\\kappa) + \\lambda^2(\\cos^2(\\kappa) + \\sin^2(\\kappa))\n$$\n$$\n|G(\\kappa)|^2 = 1 - 2\\lambda + \\lambda^2 + 2\\lambda\\cos(\\kappa) - 2\\lambda^2\\cos(\\kappa) + \\lambda^2\n$$\n$$\n|G(\\kappa)|^2 = 1 - 2\\lambda + 2\\lambda^2 + (2\\lambda - 2\\lambda^2)\\cos(\\kappa)\n$$\n$$\n|G(\\kappa)|^2 = 1 + 2\\lambda(\\lambda-1) - 2\\lambda(\\lambda-1)\\cos(\\kappa) = 1 + 2\\lambda(\\lambda-1)(1 - \\cos(\\kappa))\n$$\n对于小的 $\\kappa$，我们使用 $\\cos(\\kappa)$ 的泰勒级数展开 $\\cos(\\kappa) = 1 - \\frac{\\kappa^2}{2!} + \\frac{\\kappa^4}{4!} - \\dots$。\n$$\n1 - \\cos(\\kappa) = \\frac{\\kappa^2}{2} - \\frac{\\kappa^4}{24} + O(\\kappa^6)\n$$\n将此代入 $|G(\\kappa)|^2$ 的表达式：\n$$\n|G(\\kappa)|^2 = 1 + 2\\lambda(\\lambda-1)\\left(\\frac{\\kappa^2}{2} + O(\\kappa^4)\\right) = 1 + \\lambda(\\lambda-1)\\kappa^2 + O(\\kappa^4)\n$$\n为求 $|G(\\kappa)|$，我们取平方根，并使用泰勒展开 $\\sqrt{1+x} = 1 + \\frac{x}{2} + O(x^2)$：\n$$\n|G(\\kappa)| = \\sqrt{1 + \\lambda(\\lambda-1)\\kappa^2 + O(\\kappa^4)} = 1 + \\frac{1}{2}\\lambda(\\lambda-1)\\kappa^2 + O(\\kappa^4)\n$$\n因此，振幅误差为：\n$$\n\\delta A(\\kappa) = |G(\\kappa)| - 1 = \\frac{\\lambda(\\lambda-1)}{2}\\kappa^2 + O(\\kappa^4)\n$$\n振幅误差的主阶项是 $\\frac{\\lambda(\\lambda-1)}{2}\\kappa^2$。此项对应于数值耗散。为使格式稳定（$|G(\\kappa)|\\le 1$），我们要求 $0 \\le \\lambda \\le 1$。在此范围内，振幅误差是非正的，表明该格式是耗散的。\n\n接下来，我们分析单步相位误差，定义为 $\\delta \\phi(\\kappa) = \\phi(\\kappa) + \\lambda\\,\\kappa$，其中 $\\phi(\\kappa) = \\arg(G(\\kappa))$。$G(\\kappa)$ 的相位由下式给出：\n$$\n\\phi(\\kappa) = \\arctan\\left(\\frac{\\operatorname{Im}(G(\\kappa))}{\\operatorname{Re}(G(\\kappa))}\\right) = \\arctan\\left(\\frac{-\\lambda\\sin(\\kappa)}{1 - \\lambda + \\lambda\\cos(\\kappa)}\\right)\n$$\n我们对小的 $\\kappa$ 展开反正切函数的自变量。\n分子：$-\\lambda\\sin(\\kappa) = -\\lambda\\left(\\kappa - \\frac{\\kappa^3}{6} + O(\\kappa^5)\\right)$。\n分母：$1 - \\lambda + \\lambda\\cos(\\kappa) = 1 - \\lambda + \\lambda\\left(1 - \\frac{\\kappa^2}{2} + O(\\kappa^4)\\right) = 1 - \\frac{\\lambda\\kappa^2}{2} + O(\\kappa^4)$。\n反正切函数的自变量是：\n$$\n\\frac{-\\lambda\\left(\\kappa - \\frac{\\kappa^3}{6} + \\dots\\right)}{1 - \\frac{\\lambda\\kappa^2}{2} + \\dots} = -\\lambda\\kappa\\left(1 - \\frac{\\kappa^2}{6} + \\dots\\right)\\left(1 + \\frac{\\lambda\\kappa^2}{2} + \\dots\\right)\n$$\n$$\n= -\\lambda\\kappa\\left(1 + \\frac{\\lambda\\kappa^2}{2} - \\frac{\\kappa^2}{6} + \\dots\\right) = -\\lambda\\kappa - \\lambda\\left(\\frac{\\lambda}{2} - \\frac{1}{6}\\right)\\kappa^3 + O(\\kappa^5)\n$$\n$$\n= -\\lambda\\kappa - \\frac{\\lambda(3\\lambda-1)}{6}\\kappa^3 + O(\\kappa^5)\n$$\n现在使用 $\\arctan(y)$ 的泰勒展开 $\\arctan(y) = y - \\frac{y^3}{3} + O(y^5)$：\n$$\n\\phi(\\kappa) = \\left(-\\lambda\\kappa - \\frac{\\lambda(3\\lambda-1)}{6}\\kappa^3\\right) - \\frac{1}{3}(-\\lambda\\kappa)^3 + O(\\kappa^5)\n$$\n$$\n\\phi(\\kappa) = -\\lambda\\kappa - \\frac{\\lambda(3\\lambda-1)}{6}\\kappa^3 + \\frac{\\lambda^3}{3}\\kappa^3 + O(\\kappa^5)\n$$\n$$\n\\phi(\\kappa) = -\\lambda\\kappa - \\left(\\frac{3\\lambda^2-\\lambda}{6} - \\frac{2\\lambda^3}{6}\\right)\\kappa^3 + O(\\kappa^5)\n$$\n$$\n\\phi(\\kappa) = -\\lambda\\kappa + \\frac{-2\\lambda^3 + 3\\lambda^2 - \\lambda}{6}\\kappa^3 + O(\\kappa^5)\n$$\n对关于 $\\lambda$ 的三次多项式进行因式分解：$-2\\lambda^3 + 3\\lambda^2 - \\lambda = -\\lambda(2\\lambda^2 - 3\\lambda + 1) = -\\lambda(2\\lambda-1)(\\lambda-1) = \\lambda(1-\\lambda)(1-2\\lambda)$。\n$$\n\\phi(\\kappa) = -\\lambda\\kappa + \\frac{\\lambda(1-\\lambda)(1-2\\lambda)}{6}\\kappa^3 + O(\\kappa^5)\n$$\n相位误差于是为：\n$$\n\\delta \\phi(\\kappa) = \\phi(\\kappa) + \\lambda\\kappa = \\frac{\\lambda(1-\\lambda)(1-2\\lambda)}{6}\\kappa^3 + O(\\kappa^5)\n$$\n相位误差的主阶项是 $\\frac{\\lambda(1-\\lambda)(1-2\\lambda)}{6}\\kappa^3$。此项对应于数值色散，它导致不同波数的波以不同的速度传播。误差的符号取决于 $\\lambda$ 是大于还是小于 $1/2$。\n\n因此，振幅和相位误差的主阶表达式为：\n$\\delta A(\\kappa) \\approx \\frac{\\lambda(\\lambda-1)}{2}\\kappa^2$\n$\\delta \\phi(\\kappa) \\approx \\frac{\\lambda(1-\\lambda)(1-2\\lambda)}{6}\\kappa^3$", "answer": "$$\n\\boxed{\n\\left( \\frac{\\lambda(\\lambda-1)}{2}\\kappa^2, \\frac{\\lambda(1-\\lambda)(1-2\\lambda)}{6}\\kappa^3 \\right)\n}\n$$", "id": "3380633"}, {"introduction": "在分析了一阶格式的误差特性后，一个自然的问题是：更高阶的格式是否总是更好？本练习通过研究经典的二阶MacCormack格式来探讨这一问题。您将对该格式进行冯·诺依曼稳定性分析，并进一步考察其单调性，从而通过实践体验戈杜诺夫定理（Godunov's theorem）背后的深刻原理。通过亲手推导稳定性和单调性的条件，您将直接观察到为何高阶线性格式在处理不连续或剧烈梯度时会引入非物理的振荡，这是计算流体力学实践中的一个关键洞见。[@problem_id:3380635]", "problem": "考虑线性平流方程 $u_{t} + a\\,u_{x} = 0$，其中波速 $a0$ 为常数，空间网格均匀，间距为 $\\Delta x$，时间步长为 $\\Delta t$。定义 Courant–Friedrichs–Lewy (CFL) 数为 $\\nu := a\\,\\Delta t/\\Delta x$。使用适用于 $a0$ 的标准前向-后向形式的 MacCormack 预测-校正有限差分法对该方程进行离散化，其预测步为\n$$\nu_{j}^{*} = u_{j}^{n} - \\nu\\left(u_{j+1}^{n} - u_{j}^{n}\\right),\n$$\n校正步为\n$$\nu_{j}^{n+1} = \\frac{1}{2}\\left(u_{j}^{n} + u_{j}^{*} - \\nu\\left(u_{j}^{*} - u_{j-1}^{*}\\right)\\right).\n$$\n利用 von Neumann 傅里叶稳定性分析的基本原理以及单调守恒三点格式的定义，执行以下操作：\n\n1) 对于单个傅里叶模态 $u_{j}^{n} = \\hat{u}^{n}\\,\\exp\\!\\left(i\\,\\theta\\,j\\right)$（其中 $\\theta \\in [0,\\pi]$ 是无量纲波数），推导该格式对应的离散放大因子 $G(\\theta;\\nu)$。根据谱稳定性的要求，即对于所有 $\\theta \\in [0,\\pi]$，施加 $|G(\\theta;\\nu)| \\leq 1$ 的条件，并确定由此产生的对 $\\nu$ 的约束。\n\n2) 将一个完整的时间步 $u_{j}^{n+1}$ 重写为守恒三点形式 $u_{j}^{n+1} = \\alpha(\\nu)\\,u_{j-1}^{n} + \\beta(\\nu)\\,u_{j}^{n} + \\gamma(\\nu)\\,u_{j+1}^{n}$。对于 $a0$ 的标量线性平流，施加无振荡单调性条件，即 $\\alpha(\\nu) \\geq 0$，$\\beta(\\nu) \\geq 0$ 和 $\\gamma(\\nu) \\geq 0$，以排除离散解中的非物理振荡。将此条件与第 (1) 部分得到的谱稳定性约束相结合，确定同时满足这两个条件的 CFL 数 $\\nu$ 的最大值。\n\n请以单个实数给出最终答案。无需四舍五入。", "solution": "所述问题在科学上是合理的、适定的、客观且自洽的。它提出了偏微分方程数值分析中的一个标准任务：分析给定有限差分格式的稳定性和单调性。所有定义和条件均已提供，并与该领域的既定原理一致。因此，该问题是有效的，可以构建解答。\n\n问题要求对用于线性平流方程 $u_{t} + a\\,u_{x} = 0$（其中 $a0$）的 MacCormack 预测-校正格式进行分析。该格式由以下公式给出：\n预测步：\n$$\nu_{j}^{*} = u_{j}^{n} - \\nu\\left(u_{j+1}^{n} - u_{j}^{n}\\right) \\quad \\text{其中 } \\nu = \\frac{a\\Delta t}{\\Delta x}\n$$\n校正步：\n$$\nu_{j}^{n+1} = \\frac{1}{2}\\left(u_{j}^{n} + u_{j}^{*} - \\nu\\left(u_{j}^{*} - u_{j-1}^{*}\\right)\\right)\n$$\n\n为了简化问题两个部分的分析，我们首先将预测步和校正步合并为一个关于 $n$ 时间层值的 $u_{j}^{n+1}$ 的单一显式表达式。\n将 $u_{j}^{*}$ 和 $u_{j-1}^{*}$ 的预测步表达式代入校正步方程。\n对于 $u_{j-1}^{*}$，我们有：\n$$\nu_{j-1}^{*} = u_{j-1}^{n} - \\nu\\left(u_{j}^{n} - u_{j-1}^{n}\\right)\n$$\n将这些代入校正步，得到：\n$$\nu_{j}^{n+1} = \\frac{1}{2}\\left(u_{j}^{n} + \\left[u_{j}^{n} - \\nu\\left(u_{j+1}^{n} - u_{j}^{n}\\right)\\right] - \\nu\\left(\\left[u_{j}^{n} - \\nu\\left(u_{j+1}^{n} - u_{j}^{n}\\right)\\right] - \\left[u_{j-1}^{n} - \\nu\\left(u_{j}^{n} - u_{j-1}^{n}\\right)\\right]\\right)\\right)\n$$\n我们来简化大括号内的项：\n$$\n2u_{j}^{n} - \\nu(u_{j+1}^{n} - u_{j}^{n}) - \\nu\\left(u_{j}^{n} - u_{j-1}^{n} - \\nu u_{j+1}^{n} + \\nu u_{j}^{n} + \\nu u_{j}^{n} - \\nu u_{j-1}^{n}\\right)\n$$\n$$\n= 2u_{j}^{n} - \\nu u_{j+1}^{n} + \\nu u_{j}^{n} - \\nu(u_{j}^{n} - u_{j-1}^{n}) + \\nu^{2}(u_{j+1}^{n} - 2u_{j}^{n} + u_{j-1}^{n})\n$$\n$$\n= 2u_{j}^{n} - \\nu u_{j+1}^{n} + \\nu u_{j}^{n} - \\nu u_{j}^{n} + \\nu u_{j-1}^{n} + \\nu^{2}(u_{j+1}^{n} - 2u_{j}^{n} + u_{j-1}^{n})\n$$\n$$\n= 2u_{j}^{n} - \\nu (u_{j+1}^{n} - u_{j-1}^{n}) + \\nu^{2}(u_{j+1}^{n} - 2u_{j}^{n} + u_{j-1}^{n})\n$$\n两边除以 $2$，我们得到该格式的单步形式：\n$$\nu_{j}^{n+1} = u_{j}^{n} - \\frac{\\nu}{2}\\left(u_{j+1}^{n} - u_{j-1}^{n}\\right) + \\frac{\\nu^{2}}{2}\\left(u_{j+1}^{n} - 2u_{j}^{n} + u_{j-1}^{n}\\right)\n$$\n这就是著名的 Lax-Wendroff 格式，对于线性问题，所指定的 MacCormack 格式与之等价。\n\n**1) Von Neumann 稳定性分析**\n\n我们通过将单个傅里叶模态 $u_{j}^{n} = \\hat{u}^{n}\\,e^{i\\theta j}$ 代入单步格式来进行 von Neumann 稳定性分析。放大因子定义为 $G(\\theta;\\nu) = \\hat{u}^{n+1}/\\hat{u}^{n}$。\n代入该模态可得：\n$$\nG e^{i\\theta j} = e^{i\\theta j} - \\frac{\\nu}{2}\\left(e^{i\\theta (j+1)} - e^{i\\theta (j-1)}\\right) + \\frac{\\nu^{2}}{2}\\left(e^{i\\theta (j+1)} - 2e^{i\\theta j} + e^{i\\theta (j-1)}\\right)\n$$\n两边除以 $e^{i\\theta j}$：\n$$\nG = 1 - \\frac{\\nu}{2}\\left(e^{i\\theta} - e^{-i\\theta}\\right) + \\frac{\\nu^{2}}{2}\\left(e^{i\\theta} - 2 + e^{-i\\theta}\\right)\n$$\n使用欧拉恒等式 $e^{i\\theta} - e^{-i\\theta} = 2i\\sin(\\theta)$ 和 $e^{i\\theta} + e^{-i\\theta} = 2\\cos(\\theta)$，我们得到：\n$$\nG(\\theta;\\nu) = 1 - \\frac{\\nu}{2}\\left(2i\\sin\\theta\\right) + \\frac{\\nu^{2}}{2}\\left(2\\cos\\theta - 2\\right)\n$$\n$$\nG(\\theta;\\nu) = 1 - i\\nu\\sin\\theta + \\nu^{2}(\\cos\\theta - 1)\n$$\n使用半角恒等式 $\\cos\\theta - 1 = -2\\sin^{2}(\\frac{\\theta}{2})$，放大因子变为：\n$$\nG(\\theta;\\nu) = 1 - 2\\nu^{2}\\sin^{2}\\left(\\frac{\\theta}{2}\\right) - i\\nu\\sin\\theta\n$$\n为了满足谱稳定性，我们要求 $|G(\\theta;\\nu)| \\leq 1$，这等价于 $|G(\\theta;\\nu)|^{2} \\leq 1$。\n$$\n|G|^{2} = \\left(\\text{Re}(G)\\right)^{2} + \\left(\\text{Im}(G)\\right)^{2} = \\left(1 - 2\\nu^{2}\\sin^{2}\\left(\\frac{\\theta}{2}\\right)\\right)^{2} + (-\\nu\\sin\\theta)^{2}\n$$\n使用 $\\sin\\theta = 2\\sin(\\frac{\\theta}{2})\\cos(\\frac{\\theta}{2})$：\n$$\n|G|^{2} = 1 - 4\\nu^{2}\\sin^{2}\\left(\\frac{\\theta}{2}\\right) + 4\\nu^{4}\\sin^{4}\\left(\\frac{\\theta}{2}\\right) + \\nu^{2}\\left(2\\sin\\left(\\frac{\\theta}{2}\\right)\\cos\\left(\\frac{\\theta}{2}\\right)\\right)^{2}\n$$\n$$\n|G|^{2} = 1 - 4\\nu^{2}\\sin^{2}\\left(\\frac{\\theta}{2}\\right) + 4\\nu^{4}\\sin^{4}\\left(\\frac{\\theta}{2}\\right) + 4\\nu^{2}\\sin^{2}\\left(\\frac{\\theta}{2}\\right)\\cos^{2}\\left(\\frac{\\theta}{2}\\right)\n$$\n提出公因式 $4\\nu^{2}\\sin^{2}(\\frac{\\theta}{2})$ 并使用 $\\cos^{2}(\\frac{\\theta}{2}) = 1-\\sin^{2}(\\frac{\\theta}{2})$：\n$$\n|G|^{2} = 1 - 4\\nu^{2}\\sin^{2}\\left(\\frac{\\theta}{2}\\right) \\left(1 - \\cos^{2}\\left(\\frac{\\theta}{2}\\right)\\right) + 4\\nu^{4}\\sin^{4}\\left(\\frac{\\theta}{2}\\right)\n$$\n$$\n|G|^{2} = 1 - 4\\nu^{2}\\sin^{4}\\left(\\frac{\\theta}{2}\\right) + 4\\nu^{4}\\sin^{4}\\left(\\frac{\\theta}{2}\\right)\n$$\n$$\n|G|^{2} = 1 - 4\\nu^{2}(1-\\nu^{2})\\sin^{4}\\left(\\frac{\\theta}{2}\\right)\n$$\n稳定性要求 $|G|^{2} \\leq 1$ 变为：\n$$\n1 - 4\\nu^{2}(1-\\nu^{2})\\sin^{4}\\left(\\frac{\\theta}{2}\\right) \\leq 1\n$$\n$$\n-4\\nu^{2}(1-\\nu^{2})\\sin^{4}\\left(\\frac{\\theta}{2}\\right) \\leq 0\n$$\n由于 $\\nu = a\\Delta t/\\Delta x  0$ 且 $\\theta \\in [0,\\pi]$，$\\nu^{2}$ 和 $\\sin^{4}(\\frac{\\theta}{2})$ 均为非负。该不等式成立当且仅当：\n$$\n-(1-\\nu^{2}) \\leq 0 \\implies \\nu^{2} - 1 \\leq 0 \\implies \\nu^{2} \\leq 1\n$$\n由于 $\\nu  0$，谱稳定性约束为 $0  \\nu \\leq 1$。\n\n**2) 单调性条件与最终结果**\n\n我们通过收集 Lax-Wendroff 形式中的各项，将单步格式重写为守恒三点形式 $u_{j}^{n+1} = \\alpha(\\nu)\\,u_{j-1}^{n} + \\beta(\\nu)\\,u_{j}^{n} + \\gamma(\\nu)\\,u_{j+1}^{n}$：\n$$\nu_{j}^{n+1} = u_{j}^{n} - \\frac{\\nu}{2}u_{j+1}^{n} + \\frac{\\nu}{2}u_{j-1}^{n} + \\frac{\\nu^{2}}{2}u_{j+1}^{n} - \\nu^{2}u_{j}^{n} + \\frac{\\nu^{2}}{2}u_{j-1}^{n}\n$$\n对 $u_{j-1}^{n}$、$u_{j}^{n}$ 和 $u_{j+1}^{n}$ 的系数进行分组：\n$$\nu_{j}^{n+1} = \\left(\\frac{\\nu}{2} + \\frac{\\nu^{2}}{2}\\right) u_{j-1}^{n} + \\left(1 - \\nu^{2}\\right) u_{j}^{n} + \\left(-\\frac{\\nu}{2} + \\frac{\\nu^{2}}{2}\\right) u_{j+1}^{n}\n$$\n由此，我们确定系数为：\n$$\n\\alpha(\\nu) = \\frac{\\nu^{2}+\\nu}{2} = \\frac{\\nu(\\nu+1)}{2}\n$$\n$$\n\\beta(\\nu) = 1 - \\nu^{2}\n$$\n$$\n\\gamma(\\nu) = \\frac{\\nu^{2}-\\nu}{2} = \\frac{\\nu(\\nu-1)}{2}\n$$\n无振荡单调性条件要求所有系数都为非负：$\\alpha(\\nu) \\geq 0$、$\\beta(\\nu) \\geq 0$ 和 $\\gamma(\\nu) \\geq 0$。我们针对 $\\nu  0$ 分析这些条件。\n\n1.  $\\alpha(\\nu) = \\frac{\\nu(\\nu+1)}{2} \\geq 0$：由于 $\\nu  0$，$\\nu+1$ 也为正。因此对于 $\\nu  0$，此条件恒成立。\n\n2.  $\\beta(\\nu) = 1 - \\nu^{2} \\geq 0$：这意味着 $\\nu^{2} \\leq 1$。由于 $\\nu  0$，可得 $0  \\nu \\leq 1$。这与稳定性约束相同。\n\n3.  $\\gamma(\\nu) = \\frac{\\nu(\\nu-1)}{2} \\geq 0$：由于 $\\nu  0$，此不等式要求 $\\nu-1 \\geq 0$，即 $\\nu \\geq 1$。\n\n为同时满足所有条件，我们必须满足第 (1) 部分的稳定性条件以及所有三个单调性条件。\n-   谱稳定性：$0  \\nu \\leq 1$。\n-   来自 $\\beta$ 的单调性：$0  \\nu \\leq 1$。\n-   来自 $\\gamma$ 的单调性：$\\nu \\geq 1$。\n\n集合 $(0, 1]$ 和 $[1, \\infty)$ 的交集是单点集 $\\{\\nu = 1\\}$。因此，唯一同时满足谱稳定性和无振荡单调性条件的 CFL 数 $\\nu$ 的值为 $\\nu = 1$。问题要求的是满足条件的最大值，该值被唯一确定为 $1$。\n\n在 $\\nu=1$ 时，该格式简化为 $u_j^{n+1} = u_{j-1}^n$，这是平流方程在网格上的精确解，每个时间步长输运一个网格单元的距离，它是一个一阶迎风格式，已知是单调的。对于任何 $\\nu \\in (0, 1)$，$\\gamma(\\nu)  0$，这使得 MacCormack (Lax-Wendroff) 格式成为非单调的，这一性质与针对二阶精度格式的 Godunov 定理一致。", "answer": "$$\\boxed{1}$$", "id": "3380635"}, {"introduction": "前面的练习关注于特定的全离散格式，现在我们将转向“线方法”（method of lines）的视角，即先对空间进行离散化，然后分析得到的常微分方程组（ODEs）系统。本练习将稳定性分析推广到一般的线性双曲系统和高阶中心差分算子。您的任务是建立时间步长限制（CFL条件）与半离散空间算子谱特性之间的关系。这项实践对于理解空间离散格式的选择（例如二阶与四阶）如何直接影响显式时间积分器的最大允许时间步长至关重要，并揭示了高阶格式因其更宽的模板通常需要更小时间步长来维持稳定性的直觉之外的结果。[@problem_id:3380586]", "problem": "考虑周期性区域上的一维线性常系数对称双曲系统 $q_{t} + A\\,q_{x} = 0$，其中 $A \\in \\mathbb{R}^{m \\times m}$ 是一个可对角化且具有实特征值的矩阵，其所有特征速度满足界 $|\\lambda_{k}(A)| \\le \\Lambda$，$\\Lambda  0$ 为已知常数。该区域使用间距为 $h$ 的均匀网格进行离散化，空间导数 $q_{x}$ 由 $p$ 阶中心有限差分算子近似，其中 $p \\in \\{2,4\\}$：\n- 对于 $p=2$：$(D_{2} q)_{j} = \\dfrac{q_{j+1} - q_{j-1}}{2 h}$。\n- 对于 $p=4$：$(D_{4} q)_{j} = \\dfrac{-q_{j+2} + 8 q_{j+1} - 8 q_{j-1} + q_{j-2}}{12 h}$。\n您打算使用一个显式时间积分器，其约束条件是强制执行一个根据半离散算子计算出的预设 Courant–Friedrichs–Lewy (CFL) 数 $\\nu^{\\star}$。取 $h = 2.5 \\times 10^{-3}$，$\\Lambda = 4.7$，目标 $\\nu^{\\star} = 0.6$。使用傅里叶 (von Neumann) 分析方法，对由 $A$ 和所选 $D_{p}$ 组成的半离散算子进行分析，确定对于 $p=2$ 和 $p=4$ 两种情况，使得最终 CFL 数不超过 $\\nu^{\\star}$ 的最大允许时间步长 $\\Delta t_{\\max}$。然后，简要解释 $\\Delta t_{\\max}$ 如何通过半离散符号依赖于空间阶数 $p$。将 $\\Delta t_{\\max}$ 的两个数值以秒为单位表示，并将您的答案四舍五入到四位有效数字。", "solution": "该问题要求根据一个预设的半离散 Courant–Friedrichs–Lewy (CFL) 数，求出双曲系统半离散化的最大允许时间步长 $\\Delta t_{\\max}$。分析将使用傅里叶 (von Neumann) 方法进行。\n\n给定的偏微分方程 (PDE) 是一维线性常系数对称双曲系统：\n$$q_{t} + A\\,q_{x} = 0$$\n其中 $q \\in \\mathbb{R}^{m}$，$A \\in \\mathbb{R}^{m \\times m}$ 是一个常数、对称且可对角化的矩阵，其具有实特征值 $\\lambda_k(A)$ 且满足界 $|\\lambda_k(A)| \\le \\Lambda$。\n\n空间区域是周期性的，并用间距为 $h$ 的均匀网格进行离散化。空间导数 $q_x$ 由有限差分算子 $D_p$ 近似，从而得到半离散常微分方程组 (ODEs)：\n$$\\frac{d}{dt} q_j(t) = - A (D_p q)_j(t)$$\n其中 $q_j(t)$ 是网格点 $j$ 处的解。\n\n为了分析该系统的稳定性，我们应用傅里叶分析。我们考虑单个傅里叶模式 $q_j(t) = \\hat{q}(k, t) e^{i k x_j}$，其中 $x_j = jh$，$k$ 是波数，$i = \\sqrt{-1}$。将差分算子 $D_p$ 应用于此模式，得到：\n$$(D_p e^{ikjh})_j = \\hat{D}_p(k) e^{ikjh}$$\n其中 $\\hat{D}_p(k)$ 是算子 $D_p$ 的符号。傅里叶空间中的半离散系统变为：\n$$\\frac{d}{dt} \\hat{q}(k, t) = -A \\hat{D}_p(k) \\hat{q}(k, t)$$\n控制傅里叶系数演化的矩阵是 $-A \\hat{D}_p(k)$。由于 $A$ 是可对角化的，例如 $A = S \\Sigma S^{-1}$，其中 $\\Sigma = \\operatorname{diag}(\\lambda_1, \\dots, \\lambda_m)$，因此 $-A \\hat{D}_p(k)$ 的特征值为 $-\\lambda_j(A) \\hat{D}_p(k)$，其中 $j=1, \\dots, m$。\n\n对于应用于双曲问题的中心有限差分格式，其符号 $\\hat{D}_p(k)$ 是纯虚数。令 $\\theta = kh$。\n对于 $p=2$:\n$$(D_2 q)_j = \\frac{q_{j+1} - q_{j-1}}{2h}$$\n将其应用于 $e^{ikjh}$:\n$$\\hat{D}_2(k) = \\frac{e^{i\\theta} - e^{-i\\theta}}{2h} = \\frac{2i\\sin(\\theta)}{2h} = \\frac{i\\sin(\\theta)}{h}$$\n\n对于 $p=4$:\n$$(D_4 q)_j = \\frac{-q_{j+2} + 8q_{j+1} - 8q_{j-1} + q_{j-2}}{12h}$$\n将其应用于 $e^{ikjh}$:\n$$\\hat{D}_4(k) = \\frac{-e^{i2\\theta} + 8e^{i\\theta} - 8e^{-i\\theta} + e^{-i2\\theta}}{12h} = \\frac{-2i\\sin(2\\theta) + 16i\\sin(\\theta)}{12h} = \\frac{i(8\\sin(\\theta) - \\sin(2\\theta))}{6h}$$\n使用恒等式 $\\sin(2\\theta) = 2\\sin(\\theta)\\cos(\\theta)$，我们可以写出：\n$$\\hat{D}_4(k) = \\frac{i(8\\sin(\\theta) - 2\\sin(\\theta)\\cos(\\theta))}{6h} = \\frac{i\\sin(\\theta)(4-\\cos(\\theta))}{3h}$$\n半离散算子 $-A D_p$ 的特征值是纯虚数，位于虚轴上。显式时间积分格式的稳定性要求 $\\Delta t$ 与算子谱半径的乘积位于该方法的稳定区域内。对于纯虚谱，此条件的形式为 $\\Delta t \\max|\\text{eigenvalue}| \\le S$，其中 $S$ 是特定于该时间积分器的常数。\n\n问题定义了一个半离散 CFL 数 $\\nu^\\star$，使得稳定性约束得到满足。这意味着：\n$$\\nu^\\star = \\Delta t \\max_{k, j} |-\\lambda_j(A) \\hat{D}_p(k)|$$\n最大值取遍所有波数 $k$（或等价地，所有 $\\theta \\in [-\\pi, \\pi]$）以及 $A$ 的所有特征值。\n$$\\nu^\\star = \\Delta t \\left( \\max_j |\\lambda_j(A)| \\right) \\left( \\max_k |\\hat{D}_p(k)| \\right) = \\Delta t \\cdot \\Lambda \\cdot \\max_{\\theta} |\\hat{D}_p(\\theta)|$$\n由此，我们可以解出最大允许时间步长：\n$$\\Delta t_{\\max} = \\frac{\\nu^\\star}{\\Lambda \\max_{\\theta} |\\hat{D}_p(\\theta)|}$$\n\n我们现在必须为每种情况找到符号幅值的最大值。\n\n情况 1：$p=2$\n$$|\\hat{D}_2(\\theta)| = \\left|\\frac{i\\sin(\\theta)}{h}\\right| = \\frac{|\\sin(\\theta)|}{h}$$\n对于 $\\theta \\in [-\\pi, \\pi]$，$|\\sin(\\theta)|$ 的最大值为 $1$。\n$$\\max_{\\theta} |\\hat{D}_2(\\theta)| = \\frac{1}{h}$$\n最大时间步长为：\n$$\\Delta t_{\\max, 2} = \\frac{\\nu^\\star}{\\Lambda (1/h)} = \\frac{\\nu^\\star h}{\\Lambda}$$\n使用给定的值 $h = 2.5 \\times 10^{-3}$，$\\Lambda = 4.7$ 和 $\\nu^\\star = 0.6$：\n$$\\Delta t_{\\max, 2} = \\frac{0.6 \\times (2.5 \\times 10^{-3})}{4.7} = \\frac{1.5 \\times 10^{-3}}{4.7} \\approx 3.191489 \\times 10^{-4} \\, \\text{s}$$\n四舍五入到四位有效数字，$\\Delta t_{\\max, 2} \\approx 3.191 \\times 10^{-4} \\, \\text{s}$。\n\n情况 2：$p=4$\n$$|\\hat{D}_4(\\theta)| = \\left|\\frac{i\\sin(\\theta)(4-\\cos(\\theta))}{3h}\\right| = \\frac{|\\sin(\\theta)(4-\\cos(\\theta))|}{3h}$$\n令 $f(\\theta) = \\sin(\\theta)(4-\\cos(\\theta))$。我们需要求 $|f(\\theta)|$ 的最大值。由于 $4-\\cos(\\theta)$ 始终为正，我们可以在 $[0, \\pi]$ 上分析 $f(\\theta)$。\n$f'(\\theta) = \\cos(\\theta)(4-\\cos(\\theta)) + \\sin(\\theta)(\\sin(\\theta)) = 4\\cos(\\theta) - \\cos^2(\\theta) + \\sin^2(\\theta) = -2\\cos^2(\\theta) + 4\\cos(\\theta) + 1$。\n令 $f'(\\theta)=0$ 并对 $u=\\cos(\\theta)$ 求解，得到二次方程 $2u^2 - 4u - 1 = 0$。其根为 $u = 1 \\pm \\frac{\\sqrt{6}}{2}$。只有 $u = 1 - \\frac{\\sqrt{6}}{2}$ 在范围 $[-1, 1]$ 内。\n在此临界点，我们发现 $|f(\\theta)|$ 的最大值为 $\\frac{1}{2}\\sqrt{9+24\\sqrt{6}}$。\n因此，\n$$\\max_{\\theta} |\\hat{D}_4(\\theta)| = \\frac{1}{3h} \\left( \\frac{1}{2}\\sqrt{9+24\\sqrt{6}} \\right) = \\frac{\\sqrt{9+24\\sqrt{6}}}{6h}$$\n令 $C_4 = \\frac{\\sqrt{9+24\\sqrt{6}}}{6}$。数值上，$C_4 \\approx 1.37222$。\n最大时间步长为：\n$$\\Delta t_{\\max, 4} = \\frac{\\nu^\\star}{\\Lambda \\max_{\\theta} |\\hat{D}_4(\\theta)|} = \\frac{\\nu^\\star h}{\\Lambda C_4}$$\n$$\\Delta t_{\\max, 4} = \\frac{0.6 \\times (2.5 \\times 10^{-3})}{4.7 \\times \\frac{\\sqrt{9+24\\sqrt{6}}}{6}} \\approx \\frac{1.5 \\times 10^{-3}}{4.7 \\times 1.37222} \\approx \\frac{1.5 \\times 10^{-3}}{6.449434} \\approx 2.32578 \\times 10^{-4} \\, \\text{s}$$\n四舍五入到四位有效数字，$\\Delta t_{\\max, 4} \\approx 2.326 \\times 10^{-4} \\, \\text{s}$。\n\n关于对 $p$ 的依赖性的解释：\n最大时间步长由 $\\Delta t_{\\max, p} = \\frac{\\nu^\\star}{\\Lambda \\rho(D_p)}$ 给出，其中 $\\rho(D_p) = \\max_{\\theta} |\\hat{D}_p(\\theta)|$ 是空间差分算子的谱半径。它可以写成 $\\rho(D_p) = C_p/h$ 的形式，其中 $C_p$ 是缩放后符号 $|h \\hat{D}_p(\\theta)/i|$ 的最大值。\n对于 $p=2$，$C_2 = \\max_{\\theta}|\\sin(\\theta)| = 1$。\n对于 $p=4$，$C_4 = \\max_{\\theta}|\\frac{\\sin(\\theta)(4-\\cos(\\theta))}{3}| = \\frac{\\sqrt{9+24\\sqrt{6}}}{6} \\approx 1.372$。\n由于 $C_4 > C_2$，对于 $p=4$ 的情况，$\\Delta t_{\\max}$ 表达式中的分母比 $p=2$ 的情况要大。因此，$\\Delta t_{\\max, 4}  \\Delta t_{\\max, 2}$。高阶格式的空间算子具有更大的谱半径，这是由其更宽的模板所致。对于给定的网格间距 $h$，这会对时间步长施加更严格的稳定性限制，尽管对于良好解析的模式它具有更高的精度阶数。\n\n四舍五入到四位有效数字的数值是：\n对于 $p=2$：$\\Delta t_{\\max} = 3.191 \\times 10^{-4}$\n对于 $p=4$：$\\Delta t_{\\max} = 2.326 \\times 10^{-4}$", "answer": "$$\n\\boxed{\n(3.191 \\times 10^{-4}, 2.326 \\times 10^{-4})\n}\n$$", "id": "3380586"}]}