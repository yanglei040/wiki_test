{"hands_on_practices": [{"introduction": "我们将从一个基本问题入手：当仅知道一个对称正定矩阵的谱边界 $[a, b]$ 时，我们如何构建一个给定阶数的“最优”多项式预处理器？这项练习将引导你通过仿射变换和切比雪夫多项式的极小极大性质，推导出经典的解决方案，这是该领域的理论基石 ([@problem_id:3565775])。通过这项实践，你将掌握从第一性原理出发设计最优预处理器的核心技能。", "problem": "设 $A \\in \\mathbb{R}^{n \\times n}$ 为对称正定 (SPD) 矩阵，并假设仅有谱界可用，即 $0  a \\le \\lambda_{\\min}(A) \\le \\lambda_{\\max}(A) \\le b$。考虑多项式预处理，其目标是寻找一个多项式 $p$，使得线性算子 $I - A p(A)$ 的算子 2-范数很小。利用对称矩阵的谱定理、多项式函数的谱映射性质以及第一类切比雪夫多项式在 $[-1,1]$ 上的极小极大极值性质，构建一个仅基于谱界 $a$ 和 $b$ 的、次数为 $m$ 的多项式预处理器 $p_m$ 的稳健方案，该方案保证在算子 2-范数上有预定的缩减因子 $\\delta \\in (0,1)$，即：\n$$\n\\|I - A p_{m}(A)\\|_{2} \\le \\delta.\n$$\n您的推导必须从所述的基本事实出发，通过仿射变换将区间 $[a,b]$ 映射到 $[-1,1]$，并缩放一个切比雪夫多项式，以对辅助多项式 $q(\\lambda) = \\lambda p_{m}(\\lambda)$ 施加约束 $q(0)=0$。明确地给出：\n- 对所有 $\\lambda \\in [a,b]$ 均有效的预处理器 $p_{m}(\\lambda)$ 的闭式表达式，用第一类切比雪夫多项式 $T_{k}$ 表示，以及\n- 保证 $\\|I - A p_{m}(A)\\|_{2} \\le \\delta$ 的最小次数 $m$（作为 $a$、$b$ 和 $\\delta$ 的函数）的闭式表达式。\n\n最终答案必须是单个闭式解析表达式。如果报告了多个量，请使用 $\\mathrm{pmatrix}$ 环境将它们表示为单个行矩阵。无需进行数值计算。", "solution": "用户希望我解决一个数值分析问题。\n用户希望我解决一个数值线性代数问题。\n用户希望我解决一个关于多项式预处理的问题。\n\n**问题验证**\n\n**第1步：提取已知条件**\n- $A \\in \\mathbb{R}^{n \\times n}$ 是一个对称正定 (SPD) 矩阵。\n- $A$ 的谱 $\\sigma(A)$ 包含在区间 $[a, b]$ 内，其中 $0  a \\le \\lambda_{\\min}(A) \\le \\lambda_{\\max}(A) \\le b$。\n- 寻求一个次数为 $m$ 的多项式预处理器 $p_m$。\n- 目标是构建 $p_m$，使得预处理后矩阵的算子 2-范数满足 $\\|I - A p_{m}(A)\\|_{2} \\le \\delta$，其中 $\\delta \\in (0,1)$ 是给定的缩减因子。\n- 推导必须使用：谱定理、谱映射性质、以及第一类切比雪夫多项式 $T_k(x)$ 在 $[-1,1]$ 上的极小极大性质。\n- 推导过程必须涉及从 $[a,b]$ 到 $[-1,1]$ 的仿射映射，并通过对辅助多项式 $q(\\lambda) = \\lambda p_m(\\lambda)$ 施加约束 $q(0)=0$ 来进行。\n- 要求的输出是预处理器多项式 $p_m(\\lambda)$ 和保证范数缩减的最小次数 $m$ 的闭式表达式。\n\n**第2步：使用提取的已知条件进行验证**\n- **科学依据**：该问题是数值线性代数中的一个标准基础课题，特别是在线性系统迭代求解器的构建方面。所有概念——SPD矩阵、特征值、多项式预处理、切比雪夫多项式和谱界——都是完善且严格定义的。所提出的方法论反映了经典的切比雪夫迭代和预处理理论。该问题在科学和数学上是合理的。\n- **适定性**：该问题是适定的。它旨在在明确的约束下最小化一个最大值（一个极小极大问题）。切比雪夫多项式的极小极大性质确保了对于这种问题结构，存在唯一的最优多项式解。\n- **客观性**：该问题以精确的数学语言陈述，没有任何主观性、模糊性或非技术性术语。\n- 该问题是完整的、一致的、且可形式化的。未检测到任何缺陷。\n\n**第3步：结论与行动**\n该问题有效。将提供一个完整的、有理有据的解答。\n\n**解答**\n\n目标是找到一个次数为 $m$ 的多项式 $p_m$，它能使残差算子 $R(A) = I - A p_m(A)$ 的算子 2-范数最小化。由于 $A$ 是对称的，它可以酉对角化，因此 $A$ 的任何多项式函数的算子 2-范数由该多项式在 $A$ 的谱 $\\sigma(A)$ 上的最大绝对值决定。\n$$\n\\|I - A p_m(A)\\|_{2} = \\max_{\\lambda \\in \\sigma(A)} |1 - \\lambda p_m(\\lambda)|\n$$\n我们定义残差多项式 $R_{m+1}(\\lambda) = 1 - \\lambda p_m(\\lambda)$。由于 $p_m(\\lambda)$ 是一个次数为 $m$ 的多项式，所以 $R_{m+1}(\\lambda)$ 是一个次数至多为 $m+1$ 的多项式。此外，根据其定义，$R_{m+1}(0) = 1 - 0 \\cdot p_m(0) = 1$。问题要求 $q(\\lambda) = \\lambda p_m(\\lambda)$ 满足 $q(0)=0$，这意味着 $R_{m+1}(0) = 1 - q(0) = 1$。因此 $R_{m+1}(\\lambda)$ 的次数恰好是 $m+1$。\n\n由于除了 $\\sigma(A) \\subseteq [a,b]$ 之外，谱 $\\sigma(A)$ 是未知的，我们必须通过在整个区间 $[a,b]$ 上最小化 $|R_{m+1}(\\lambda)|$ 的最大值来解决一个更保守的问题：\n$$\n\\min_{p_m \\in \\mathcal{P}_m} \\max_{\\lambda \\in [a,b]} |1 - \\lambda p_m(\\lambda)| = \\min_{R_{m+1} \\in \\mathcal{P}_{m+1}, R_{m+1}(0)=1} \\max_{\\lambda \\in [a,b]} |R_{m+1}(\\lambda)|\n$$\n其中 $\\mathcal{P}_k$ 是次数至多为 $k$ 的多项式空间。\n\n这是一个经典的极小极大问题。其解法是通过将其与第一类切比雪夫多项式 $T_k(x)$ 联系起来，后者在区间 $[-1,1]$ 上具有类似的最优性。我们首先执行一个仿射变换，将区间 $\\lambda \\in [a,b]$ 映射到 $x \\in [-1,1]$。令 $x = c_1 \\lambda + c_2$。\n对于 $\\lambda=a$，我们设 $x=-1$：$-1 = c_1 a + c_2$。\n对于 $\\lambda=b$，我们设 $x=1$：$1 = c_1 b + c_2$。\n求解这个关于 $c_1$ 和 $c_2$ 的线性方程组，可得：\n$c_1 = \\frac{2}{b-a}$ 和 $c_2 = -\\frac{a+b}{b-a}$。\n所以，变换是 $x(\\lambda) = \\frac{2\\lambda - (a+b)}{b-a}$。逆变换是 $\\lambda(x) = \\frac{b-a}{2}x + \\frac{a+b}{2}$。\n\n约束 $R_{m+1}(0)=1$ 是在点 $\\lambda=0$ 上的，由于 $A$ 是对称正定的（$a>0$），该点位于区间 $[a,b]$ 之外。我们必须在变换后的坐标系中找到对应的点 $x_0$：\n$$\nx_0 = x(0) = \\frac{-(a+b)}{b-a}\n$$\n由于 $b>a>0$，我们有 $a+b > 0$ 和 $b-a > 0$，所以 $x_0  -1$。\n\n现在问题转化为寻找一个次数为 $m+1$ 的多项式 $P_{m+1}(x)$，使得 $P_{m+1}(x_0)=1$ 且其在 $[-1,1]$ 上的最大绝对值最小化。切比雪夫多项式的极小极大性质表明，这个问题的解由一个缩放后的切比雪夫多项式给出：\n$$\nP_{m+1}(x) = \\frac{T_{m+1}(x)}{T_{m+1}(x_0)}\n$$\n这个多项式在 $[-1,1]$ 上的最大值为 $\\frac{\\max_{x \\in [-1,1]}|T_{m+1}(x)|}{|T_{m+1}(x_0)|} = \\frac{1}{|T_{m+1}(x_0)|}$。\n\n变换回变量 $\\lambda$，最优残差多项式为：\n$$\nR_{m+1}(\\lambda) = P_{m+1}(x(\\lambda)) = \\frac{T_{m+1}\\left(\\frac{2\\lambda - (a+b)}{b-a}\\right)}{T_{m+1}\\left(\\frac{-(a+b)}{b-a}\\right)}\n$$\n根据定义 $R_{m+1}(\\lambda) = 1 - \\lambda p_m(\\lambda)$，我们可以解出预处理器多项式 $p_m(\\lambda)$。由于 $R_{m+1}(0)=1$，多项式 $1-R_{m+1}(\\lambda)$ 在 $\\lambda=0$ 处有一个根，这保证了 $p_m(\\lambda)$ 是一个次数为 $m$ 的多项式。\n$$\np_m(\\lambda) = \\frac{1 - R_{m+1}(\\lambda)}{\\lambda} = \\frac{1}{\\lambda} \\left( 1 - \\frac{T_{m+1}\\left(\\frac{2\\lambda - (a+b)}{b-a}\\right)}{T_{m+1}\\left(-\\frac{a+b}{b-a}\\right)} \\right)\n$$\n这是次数为 $m$ 的预处理器多项式的闭式表达式。\n\n接下来，我们求保证范数缩减 $\\|I - A p_m(A)\\|_2 \\le \\delta$ 的最小次数 $m$。\n保证的缩减量由最优残差多项式在 $[a,b]$ 上的最大值给出：\n$$\n\\|I - A p_m(A)\\|_2 \\le \\max_{\\lambda \\in [a,b]} |R_{m+1}(\\lambda)| = \\frac{1}{|T_{m+1}(x_0)|} = \\frac{1}{\\left|T_{m+1}\\left(-\\frac{a+b}{b-a}\\right)\\right|}\n$$\n我们要求这个界小于或等于 $\\delta$：\n$$\n\\frac{1}{\\left|T_{m+1}\\left(-\\frac{a+b}{b-a}\\right)\\right|} \\le \\delta \\quad \\implies \\quad \\left|T_{m+1}\\left(-\\frac{a+b}{b-a}\\right)\\right| \\ge \\frac{1}{\\delta}\n$$\n对于 $|x| \\ge 1$，切比雪夫多项式有表达式 $T_k(x) = \\cosh(k \\cdot \\mathrm{arccosh}(x))$。由于 $x_0 = -\\frac{a+b}{b-a}  -1$，我们对 $x \\le -1$ 使用恒等式 $T_k(x) = (-1)^k \\cosh(k \\cdot \\mathrm{arccosh}(-x))$。因此， $|T_{m+1}(x_0)| = \\cosh((m+1) \\cdot \\mathrm{arccosh}(-x_0))$。\n不等式变为：\n$$\n\\cosh\\left((m+1) \\cdot \\mathrm{arccosh}\\left(\\frac{a+b}{b-a}\\right)\\right) \\ge \\frac{1}{\\delta}\n$$\n由于 $\\cosh$ 对于非负参数是增函数，且对于 $y \\ge 1$ 有 $\\mathrm{arccosh}(y) \\ge 0$，我们可以对不等式两边取 $\\mathrm{arccosh}$：\n$$\n(m+1) \\cdot \\mathrm{arccosh}\\left(\\frac{a+b}{b-a}\\right) \\ge \\mathrm{arccosh}\\left(\\frac{1}{\\delta}\\right)\n$$\n解出 $m+1$：\n$$\nm+1 \\ge \\frac{\\mathrm{arccosh}(1/\\delta)}{\\mathrm{arccosh}\\left(\\frac{a+b}{b-a}\\right)}\n$$\n由于次数 $m$ 必须是整数，所以 $m+1$ 必须是满足此条件的最小整数。因此，$m+1$ 的最小整数值是右侧表达式的向上取整。\n$$\nm+1 = \\left\\lceil \\frac{\\mathrm{arccosh}(1/\\delta)}{\\mathrm{arccosh}\\left(\\frac{a+b}{b-a}\\right)} \\right\\rceil\n$$\n那么最小次数 $m$ 为：\n$$\nm = \\left\\lceil \\frac{\\mathrm{arccosh}(1/\\delta)}{\\mathrm{arccosh}\\left(\\frac{a+b}{b-a}\\right)} \\right\\rceil - 1\n$$\n这给出了实现所需缩减因子 $\\delta$ 所需的最小非负整数次数。\n\n所要求的两个表达式是 $p_m(\\lambda)$ 的公式和最小次数 $m$。", "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{1}{\\lambda} \\left( 1 - \\frac{T_{m+1}\\left(\\frac{2\\lambda - a - b}{b-a}\\right)}{T_{m+1}\\left(-\\frac{a+b}{b-a}\\right)} \\right)  \\left\\lceil \\frac{\\mathrm{arccosh}(1/\\delta)}{\\mathrm{arccosh}\\left(\\frac{a+b}{b-a}\\right)} \\right\\rceil - 1 \\end{pmatrix}}\n$$", "id": "3565775"}, {"introduction": "在掌握了如何构建最优预处理器之后，一个自然的问题是：我们需要多大阶数的多项式才能达到预期的性能提升？这项练习将理论与实践紧密联系起来，要求你计算出将共轭梯度法（CG）的迭代次数减半所需的最优切比雪夫预处理器的阶数 ([@problem_id:3565795])。这项实践旨在培养对预处理器进行性能建模和成本效益分析的能力，让你能够为特定的性能目标选择合适的工具。", "problem": "考虑一个实对称正定 (SPD) 矩阵 $A \\in \\mathbb{R}^{n \\times n}$，其谱包含在区间 $[\\lambda_{\\min}, \\lambda_{\\max}] \\subset (0,\\infty)$ 内，并将其条件数记为 $\\kappa = \\lambda_{\\max}/\\lambda_{\\min}$。设共轭梯度 (CG) 法应用于线性系统 $Ax=b$，并假设您可以使用一个左多项式预处理器 $M_m = p_m(A)$，其中 $p_m$ 是一个 $m$ 次多项式，其选择是通过极小化极大 (Chebyshev) 构造，在一致范数意义下于区间 $[\\lambda_{\\min},\\lambda_{\\max}]$ 上逼近 $A^{-1}$。\n\n从 SPD 矩阵上 CG 方法关于第一类 Chebyshev 多项式的标准最坏情况误差界出发，并利用 Chebyshev 多项式在区间上一致逼近的极值性质，推导：\n\n1. 预处理后谱在 1 附近聚集的一致相对误差 $E_m$，定义为 $E_m = \\max_{\\lambda \\in [\\lambda_{\\min},\\lambda_{\\max}]} |1 - \\lambda p_m(\\lambda)|$，用 $\\kappa$ 和 $m$ 的闭式形式表示。\n2. 预处理算子 $M_m A$ 的有效条件数 $\\kappa_{\\mathrm{eff}}$，作为 $E_m$（并因此作为 $\\kappa$ 和 $m$）的函数。\n3. 与 $M_m A$ 相关联的 CG 收缩因子参数 $\\alpha_{\\mathrm{eff}}$，类似于未经预处理的参数 $\\alpha = (\\sqrt{\\kappa}-1)/(\\sqrt{\\kappa}+1)$。\n\n利用这些推导，确定所需的最小多项式次数 $m$，使得对于一个固定的容差，在同样的最坏情况下，使用预处理器所需的 CG 迭代次数是未使用预处理器运行 CG 的一半。请给出明确的次数 $m$ 作为最终答案，并另外给出将 $E_m$、$\\kappa_{\\mathrm{eff}}$ 和 $\\alpha_{\\mathrm{eff}}$ 与 $\\kappa$ 和 $m$ 相关联的明确标度律。无需四舍五入；在最终答案中给出次数 $m$ 的精确整数值。如果出现任何角度，均应以弧度表示。本问题不涉及物理单位。", "solution": "该问题陈述已经过验证，被认为是合理的。这是一个数值线性代数中适定的问题，具体涉及共轭梯度 (CG) 法的多项式预处理分析。所有术语都是标准的，前提具有科学依据。\n\n该问题要求对一个对称正定 (SPD) 矩阵 $A$ 的多项式预处理器 $M_m = p_m(A)$ 进行分析。选择 $m$ 次多项式 $p_m(\\lambda)$ 以最小化谱区间 $[\\lambda_{\\min}, \\lambda_{\\max}]$ 上残差多项式的一致范数。我们将推导关键性能指标，然后确定为达到指定的收敛速度提升所需的最小次数 $m$。\n\n设 $A$ 的特征值为 $\\lambda$，它们都包含在区间 $[\\lambda_{\\min}, \\lambda_{\\max}] \\subset (0,\\infty)$ 内。条件数为 $\\kappa = \\lambda_{\\max}/\\lambda_{\\min}$。预处理后的矩阵是 $M_m A = p_m(A)A$。其特征值为 $\\lambda' = \\lambda p_m(\\lambda)$。应用于预处理系统 $M_m A x = M_m b$ 的 CG 方法的收敛速率取决于 $M_m A$ 的谱。一个有效的预处理器会使 $M_m A$ 的特征值聚集在 1 附近。这是通过使 $\\lambda p_m(\\lambda)$ 对于所有 $\\lambda \\in [\\lambda_{\\min}, \\lambda_{\\max}]$ 都接近 1 来实现的。\n\n选择多项式 $p_m(\\lambda)$ 以解决以下极小化极大问题：\n$$ \\min_{p_m \\in \\mathcal{P}_m} \\max_{\\lambda \\in [\\lambda_{\\min}, \\lambda_{\\max}]} |1 - \\lambda p_m(\\lambda)| $$\n其中 $\\mathcal{P}_m$ 是次数至多为 $m$ 的多项式空间。令 $q_{m+1}(\\lambda) = 1 - \\lambda p_m(\\lambda)$。由于 $p_m(\\lambda)$ 是一个 $m$ 次多项式，所以 $q_{m+1}(\\lambda)$ 是一个次数至多为 $m+1$ 的多项式。此外，在 $\\lambda=0$ 处求值，我们发现 $q_{m+1}(0) = 1 - 0 \\cdot p_m(0) = 1$。因此，该问题等价于寻找一个次数至多为 $m+1$ 的多项式 $q_{m+1}(\\lambda)$，它满足 $q_{m+1}(0)=1$ 并且在区间 $[\\lambda_{\\min}, \\lambda_{\\max}]$ 上具有可能的最小最大绝对值。\n\n这是逼近理论中的一个经典问题，其解由一个经过缩放和平移的第一类 Chebyshev 多项式 $T_k(x)$ 给出。最优多项式为：\n$$ q_{m+1}(\\lambda) = \\frac{T_{m+1}\\left( \\frac{2\\lambda - (\\lambda_{\\max}+\\lambda_{\\min})}{\\lambda_{\\max}-\\lambda_{\\min}} \\right)}{T_{m+1}\\left( \\frac{-( \\lambda_{\\max}+\\lambda_{\\min})}{\\lambda_{\\max}-\\lambda_{\\min}} \\right)} $$\n线性变换 $x(\\lambda) = \\frac{2\\lambda - (\\lambda_{\\max}+\\lambda_{\\min})}{\\lambda_{\\max}-\\lambda_{\\min}}$ 将区间 $[\\lambda_{\\min}, \\lambda_{\\max}]$ 映射到 $[-1, 1]$。点 $\\lambda=0$ 被映射到 $x_0 = \\frac{-(\\lambda_{\\max}+\\lambda_{\\min})}{\\lambda_{\\max}-\\lambda_{\\min}} = -\\frac{\\kappa+1}{\\kappa-1}$。\n\n**1. 一致相对误差 $E_m$ 的推导**\n\n一致相对误差为 $E_m = \\max_{\\lambda \\in [\\lambda_{\\min}, \\lambda_{\\max}]} |q_{m+1}(\\lambda)|$。由于 $\\max_{x \\in [-1,1]} |T_{m+1}(x)| = 1$，我们有：\n$$ E_m = \\frac{1}{\\left|T_{m+1}(x_0)\\right|} = \\frac{1}{\\left|T_{m+1}\\left(-\\frac{\\kappa+1}{\\kappa-1}\\right)\\right|} $$\n利用性质 $T_k(-x) = (-1)^k T_k(x)$，并注意到对于 $z>1$，$T_k(z)>0$，我们得到 $|T_{m+1}(-\\frac{\\kappa+1}{\\kappa-1})| = T_{m+1}(\\frac{\\kappa+1}{\\kappa-1})$。\n对于自变量 $|z| \\ge 1$，$T_k(z) = \\cosh(k \\cdot \\text{arccosh}(z))$。我们需要计算 $\\text{arccosh}(\\frac{\\kappa+1}{\\kappa-1})$。\n令 $\\alpha = \\frac{\\sqrt{\\kappa}-1}{\\sqrt{\\kappa}+1}$。则 $\\frac{1}{\\alpha} = \\frac{\\sqrt{\\kappa}+1}{\\sqrt{\\kappa}-1}$。我们可以写出 $\\frac{\\kappa+1}{\\kappa-1} = \\frac{(\\sqrt{\\kappa}+1)^2+(\\sqrt{\\kappa}-1)^2}{(\\sqrt{\\kappa}+1)^2-(\\sqrt{\\kappa}-1)^2} = \\frac{\\alpha^{-2}+1}{\\alpha^{-2}-1}$，但这不是我想要的恒等式。\n一个更直接的计算：\n$$ \\frac{\\kappa+1}{\\kappa-1} = \\frac{\\frac{\\lambda_{\\max}}{\\lambda_{\\min}}+1}{\\frac{\\lambda_{\\max}}{\\lambda_{\\min}}-1} = \\frac{\\lambda_{\\max}+\\lambda_{\\min}}{\\lambda_{\\max}-\\lambda_{\\min}} $$\n一个标准恒等式将 $\\text{arccosh}(\\frac{a+b}{a-b})$ 与 $\\text{arctanh}(\\sqrt{b/a})$ 联系起来。另一个有用的恒等式是 $\\text{arccosh}(z) = \\ln(z+\\sqrt{z^2-1})$。\n令 $z = \\frac{\\kappa+1}{\\kappa-1}$。则 $z^2-1 = \\left(\\frac{\\kappa+1}{\\kappa-1}\\right)^2 - 1 = \\frac{(\\kappa+1)^2 - (\\kappa-1)^2}{(\\kappa-1)^2} = \\frac{4\\kappa}{(\\kappa-1)^2}$。所以 $\\sqrt{z^2-1} = \\frac{2\\sqrt{\\kappa}}{\\kappa-1}$。\n$$ \\text{arccosh}\\left(\\frac{\\kappa+1}{\\kappa-1}\\right) = \\ln\\left(\\frac{\\kappa+1}{\\kappa-1} + \\frac{2\\sqrt{\\kappa}}{\\kappa-1}\\right) = \\ln\\left(\\frac{\\kappa+2\\sqrt{\\kappa}+1}{\\kappa-1}\\right) = \\ln\\left(\\frac{(\\sqrt{\\kappa}+1)^2}{(\\sqrt{\\kappa}-1)(\\sqrt{\\kappa}+1)}\\right) = \\ln\\left(\\frac{\\sqrt{\\kappa}+1}{\\sqrt{\\kappa}-1}\\right) $$\n这个量是 $-\\ln(\\alpha)$。由于我们需要 arccosh 的值为正，我们使用 $\\ln(1/\\alpha)$。\n所以，$T_{m+1}(\\frac{\\kappa+1}{\\kappa-1}) = \\cosh((m+1)\\ln(1/\\alpha))$。使用 $\\cosh(x) = (\\exp(x)+\\exp(-x))/2$：\n$$ T_{m+1}\\left(\\frac{\\kappa+1}{\\kappa-1}\\right) = \\frac{\\exp((m+1)\\ln(1/\\alpha)) + \\exp(-(m+1)\\ln(1/\\alpha))}{2} = \\frac{(1/\\alpha)^{m+1} + \\alpha^{m+1}}{2} = \\frac{\\alpha^{-(m+1)} + \\alpha^{m+1}}{2} $$\n因此，一致相对误差为：\n$$ E_m = \\frac{1}{T_{m+1}\\left(\\frac{\\kappa+1}{\\kappa-1}\\right)} = \\frac{2}{\\alpha^{-(m+1)} + \\alpha^{m+1}} = \\frac{2\\alpha^{m+1}}{1+\\alpha^{2(m+1)}} $$\n\n**2. 有效条件数 $\\kappa_{\\mathrm{eff}}$ 的推导**\n\n预处理矩阵 $M_m A$ 的特征值 $\\lambda'$ 由 $\\lambda'_i = \\lambda_i p_m(\\lambda_i) = 1-q_{m+1}(\\lambda_i)$ 给出。由于 $\\lambda_i \\in [\\lambda_{\\min}, \\lambda_{\\max}]$，我们有 $q_{m+1}(\\lambda_i) \\in [-E_m, E_m]$。\n因此，特征值 $\\lambda'$ 包含在区间 $[1-E_m, 1+E_m]$ 内。\n预处理矩阵 $M_m A$ 是对称的。要使其为正定，其特征值必须为正。这要求 $1-E_m > 0$。由于 $\\frac{\\kappa+1}{\\kappa-1}>1$，则 $T_{m+1}(\\frac{\\kappa+1}{\\kappa-1}) > 1$，这意味着 $E_m  1$，从而保证了正定性。\n有效条件数是这个界定区间内最大特征值与最小特征值的比值：\n$$ \\kappa_{\\mathrm{eff}} = \\frac{\\max(\\lambda')}{\\min(\\lambda')} = \\frac{1+E_m}{1-E_m} $$\n\n**3. 关联的 CG 收缩因子参数 $\\alpha_{\\mathrm{eff}}$ 的推导**\n\n对于条件数为 $\\kappa$ 的 SPD 矩阵，CG 的标准最坏情况收敛因子由 $\\alpha = (\\sqrt{\\kappa}-1)/(\\sqrt{\\kappa}+1)$ 给出。对于预处理系统，有效条件数为 $\\kappa_{\\mathrm{eff}}$。新的收缩因子参数为：\n$$ \\alpha_{\\mathrm{eff}} = \\frac{\\sqrt{\\kappa_{\\mathrm{eff}}}-1}{\\sqrt{\\kappa_{\\mathrm{eff}}}+1} = \\frac{\\sqrt{\\frac{1+E_m}{1-E_m}}-1}{\\sqrt{\\frac{1+E_m}{1-E_m}}+1} $$\n该表达式可以通过分子分母同乘以 $\\sqrt{1-E_m}$ 来简化：\n$$ \\alpha_{\\mathrm{eff}} = \\frac{\\sqrt{1+E_m}-\\sqrt{1-E_m}}{\\sqrt{1+E_m}+\\sqrt{1-E_m}} $$\n\n**4. 最小多项式次数 $m$ 的确定**\n\n将初始误差减小一个因子 $\\tau$ 所需的 CG 迭代次数 $k$ 大致与 $1/(-\\ln(\\alpha))$ 成正比。问题要求找到最小次数 $m$，使得迭代次数减半。这意味着：\n$$ k_{\\mathrm{prec}} = \\frac{1}{2} k_{\\mathrm{unprec}} \\implies \\frac{1}{-\\ln(\\alpha_{\\mathrm{eff}})} \\approx \\frac{1}{2} \\frac{1}{-\\ln(\\alpha)} $$\n这导出条件 $\\ln(\\alpha_{\\mathrm{eff}}) = 2\\ln(\\alpha) = \\ln(\\alpha^2)$，因此 $\\alpha_{\\mathrm{eff}} = \\alpha^2$。\n我们现在求解 $m$。首先用 $\\alpha_{\\mathrm{eff}}$ 来表示 $E_m$。从 $\\alpha_{\\mathrm{eff}}$ 的表达式中，我们可以解出 $E_m$。对表达式进行有理化可得：\n$$ \\alpha_{\\mathrm{eff}} = \\frac{(\\sqrt{1+E_m}-\\sqrt{1-E_m})^2}{(1+E_m)-(1-E_m)} = \\frac{1+E_m - 2\\sqrt{1-E_m^2} + 1-E_m}{2E_m} = \\frac{1-\\sqrt{1-E_m^2}}{E_m} $$\n设 $\\alpha_{\\mathrm{eff}} = \\alpha^2$，我们有 $\\alpha^2 = \\frac{1-\\sqrt{1-E_m^2}}{E_m}$。\n$E_m \\alpha^2 = 1 - \\sqrt{1-E_m^2} \\implies 1-E_m \\alpha^2 = \\sqrt{1-E_m^2}$。\n两边平方：$(1-E_m \\alpha^2)^2 = 1-E_m^2 \\implies 1 - 2E_m \\alpha^2 + E_m^2 \\alpha^4 = 1-E_m^2$。\n假设 $E_m \\neq 0$，我们可以除以 $E_m$：$-2\\alpha^2 + E_m \\alpha^4 = -E_m \\implies E_m(1+\\alpha^4) = 2\\alpha^2$。\n$$ E_m = \\frac{2\\alpha^2}{1+\\alpha^4} $$\n现在我们将这个所需的 $E_m$ 值与我们推导出的用 $m$ 表示的 $E_m$ 表达式相等：\n$$ \\frac{2\\alpha^{m+1}}{1+\\alpha^{2(m+1)}} = \\frac{2\\alpha^2}{1+\\alpha^4} $$\n令 $f(x) = \\frac{x}{1+x^2}$。方程为 $f(\\alpha^{m+1}) = f(\\alpha^2)$。对于 $x \\in (0,1)$，函数 $f(x)$ 是严格递增的，因为 $f'(x) = \\frac{1-x^2}{(1+x^2)^2} > 0$。因此，$f$ 在此定义域上是单射的。由于 $\\alpha \\in(0,1)$，$\\alpha^{m+1}$ 和 $\\alpha^2$ 都在 $(0,1)$ 内。\n因此，当且仅当自变量相等时，等式成立：\n$$ \\alpha^{m+1} = \\alpha^2 $$\n由于 $\\alpha \\in (0,1)$，我们可以得出结论，指数必须相等：\n$$ m+1 = 2 \\implies m = 1 $$\n所需的最小多项式次数为 $m=1$。\n\n所要求的明确标度律是上面推导出的精确关系：\n1. $E_m = \\frac{2\\alpha^{m+1}}{1+\\alpha^{2(m+1)}}$，其中 $\\alpha = \\frac{\\sqrt{\\kappa}-1}{\\sqrt{\\kappa}+1}$。\n2. $\\kappa_{\\mathrm{eff}} = \\frac{1+E_m}{1-E_m}$。\n3. $\\alpha_{\\mathrm{eff}} = \\frac{\\sqrt{\\kappa_{\\mathrm{eff}}}-1}{\\sqrt{\\kappa_{\\mathrm{eff}}}+1}$。\n这三个方程共同将 $E_m$、$\\kappa_{\\mathrm{eff}}$ 和 $\\alpha_{\\mathrm{eff}}$ 与原始问题参数 $\\kappa$ 和 $m$ 联系起来。", "answer": "$$\n\\boxed{1}\n$$", "id": "3565795"}, {"introduction": "切比雪夫方法在仅知谱边界时是最优的，但如果我们拥有更多信息，例如通过初步计算（如Lanczos过程）得到的离群特征值的近似值，情况又会如何？这项练习探索了一种替代的、由数据驱动的设计方法：通过最小二乘法构建一个多项式，以精确“狙击”并抑制这些已知的、导致收敛缓慢的模式 ([@problem_id:3565786])。这项实践将向你介绍一种在实际应用中非常灵活且强大的技术，它展示了如何利用关于谱的局部信息来定制更高效的预处理器。", "problem": "考虑一个大型稀疏实对称正定矩阵 $A \\in \\mathbb{R}^{n \\times n}$。根据应用背景，已知其谱主要包含在区间 $[0.8, 1.2]$ 内，但有少数离群特征值位于该主体之外。一次短程的Lanczos过程产生了两个近似的Ritz值 $\\theta_{1} = 0.2$ 和 $\\theta_{2} = 1.8$，这些值指出了若不加处理则会导致收敛缓慢的方向。你打算在启动如共轭梯度(CG)方法或广义最小残差(GMRES)方法等Krylov方法之前，应用一次多项式预处理，其形式为残差变换 $r_{\\text{new}} = s(A) r_{\\text{old}}$，其中 $s$ 是一个实多项式。\n\n从以下基本依据出发：\n- 在由多项式 $s$ 导出的定常残差变换中，新残差为 $r_{\\text{new}} = s(A) r_{\\text{old}}$，因此其对每个特征分量的作用是乘以标量 $s(\\lambda)$，其中 $\\lambda$ 是 $A$ 的一个特征值。\n- 由Lanczos过程计算出的Ritz值近似于极端特征值，并指出了在哪些方向上进行定向阻尼（通过在这些近似特征值处设置 $s$ 的根）是有效的。\n- 选择 $s(0) = 1$ 与类Richardson阻尼因子的乘积形式 $s(\\lambda) = \\prod_{j} (1 - \\alpha_{j} \\lambda)$ 相一致，并避免了会导致非多项式逆的平凡解 $s \\equiv 0$。\n\n构建一个3次残差多项式 $s(\\lambda)$，使其满足 $s(0) = 1$ 并在给定的两个Ritz值 $\\theta_{1}$ 和 $\\theta_{2}$ 处具有单根，以阻尼相关方向。利用剩余的自由度，通过在两个具有等权重的代表性主体点 $\\lambda_{3} = 0.9$ 和 $\\lambda_{4} = 1.1$ 上最小化一个离散最小二乘目标来确定 $s$。也就是说，在形如\n$$\ns(\\lambda) = \\bigl(1 - \\tfrac{\\lambda}{\\theta_{1}}\\bigr)\\bigl(1 - \\tfrac{\\lambda}{\\theta_{2}}\\bigr)\\bigl(1 + \\mu \\lambda\\bigr),\n$$\n的多项式中，选择标量 $\\mu \\in \\mathbb{R}$ 以最小化\n$$\nJ(\\mu) = \\bigl(s(0.9)\\bigr)^{2} + \\bigl(s(1.1)\\bigr)^{2}.\n$$\n\n解释并证明你为 $\\theta_{1}$ 和 $\\theta_{2}$ 处的根选择重数的合理性，需基于次数预算和对Ritz值不准确性的鲁棒性。然后，计算并报告最优多项式 $s(\\lambda)$ 的最终闭式表达式作为你的答案。无需四舍五入；请提供精确的解析表达式。", "solution": "经评估，问题陈述是有效的。它在科学上植根于数值线性代数中迭代方法的多项式预处理的成熟理论。该问题是适定的，提供了足以唯一确定多项式的约束条件，并以客观、明确的语言表达。所有必要的数据均已提供。\n\n问题要求为涉及对称正定矩阵 $A$ 的线性系统构建一个3次多项式预处理器 $s(\\lambda)$。该多项式将用作残差变换，$r_{\\text{new}} = s(A) r_{\\text{old}}$。构建过程受以下几个约束条件的指导：\n$1$。多项式 $s(\\lambda)$ 的次数必须为3。\n$2$。它必须满足归一化条件 $s(0) = 1$。\n$3$。它必须在两个近似的离群特征值（Ritz值） $\\theta_{1} = 0.2$ 和 $\\theta_{2} = 1.8$ 的位置有根，以阻尼相应的慢收敛特征模式。\n$4$。剩余的自由度必须用于在由两个点 $\\lambda_{3} = 0.9$ 和 $\\lambda_{4} = 1.1$ 近似的谱主体上最小化多项式的幅值。\n\n首先，我们讨论根的重数的选择。多项式的总次数为3。我们被告知要在两个特定位置 $\\theta_{1}$ 和 $\\theta_{2}$ 设置根，以抑制误差分量。为每个位置分配一个单根，即包含因子 $(\\lambda - \\theta_{1})$ 和 $(\\lambda - \\theta_{2})$，会用掉总共三个次数中的两个。这是最平衡的方法，因为它同等对待两个已识别的离群模式。这留下了一个自由度，可用于进一步塑造多项式，在此情况下，用于最小化其在大部分特征值所处区间上的幅值。使用更高的重数，例如在 $\\theta_{1}$ 处设置二重根而在 $\\theta_{2}$ 处无根，将是一种不平衡的策略，忽略了其中一个已知的有问题模式。此外，从鲁棒性的角度来看，通常首选单根。Ritz值是真实特征值的近似值。高阶根会在Ritz值处产生一个非常尖锐且深的 $|s(\\lambda)|$ 最小值，如果Ritz值不是真实特征值的高度精确近似，这种做法效果可能较差。由单根提供的更宽的零点对Ritz值的不准确性有更好的容错性。\n\n问题提出的 $s(\\lambda)$ 形式已经包含了根的条件和归一化条件 $s(0)=1$：\n$$\ns(\\lambda) = \\left(1 - \\frac{\\lambda}{\\theta_{1}}\\right)\\left(1 - \\frac{\\lambda}{\\theta_{2}}\\right)\\left(1 + \\mu \\lambda\\right)\n$$\n这是一个3次多项式。在 $\\lambda=0$ 处求值得到 $s(0)=(1-0)(1-0)(1+0) = 1$，满足归一化条件。前两个因子确保了 $s(\\theta_{1}) = 0$ 和 $s(\\theta_{2}) = 0$。参数 $\\mu$ 对应于剩余的自由度。\n\n给定值为 $\\theta_{1} = 0.2$ 和 $\\theta_{2} = 1.8$。将它们代入 $s(\\lambda)$ 的表达式中：\n$$\ns(\\lambda) = \\left(1 - \\frac{\\lambda}{0.2}\\right)\\left(1 - \\frac{\\lambda}{1.8}\\right)\\left(1 + \\mu \\lambda\\right) = (1 - 5\\lambda)\\left(1 - \\frac{10\\lambda}{18}\\right)(1 + \\mu\\lambda) = (1 - 5\\lambda)\\left(1 - \\frac{5}{9}\\lambda\\right)(1 + \\mu\\lambda)\n$$\n参数 $\\mu$ 的选择应使目标函数 $J(\\mu) = (s(0.9))^{2} + (s(1.1))^{2}$ 最小化。我们在点 $\\lambda = 0.9$ 和 $\\lambda = 1.1$ 处计算 $s(\\lambda)$ 的值。\n\n对于 $\\lambda = 0.9$：\n$$\ns(0.9) = \\left(1 - 5(0.9)\\right)\\left(1 - \\frac{5}{9}(0.9)\\right)\\left(1 + \\mu(0.9)\\right) = (1 - 4.5)(1 - 0.5)(1 + 0.9\\mu) = (-3.5)(0.5)(1 + 0.9\\mu) = -1.75(1 + 0.9\\mu)\n$$\n将系数写成分数形式，$-1.75 = -\\frac{7}{4}$ 且 $0.9 = \\frac{9}{10}$。因此，$s(0.9) = -\\frac{7}{4}(1 + \\frac{9}{10}\\mu)$。\n\n对于 $\\lambda = 1.1$：\n$$\ns(1.1) = \\left(1 - 5(1.1)\\right)\\left(1 - \\frac{5}{9}(1.1)\\right)\\left(1 + \\mu(1.1)\\right) = (1 - 5.5)\\left(1 - \\frac{5.5}{9}\\right)(1 + 1.1\\mu)\n$$\n$$\ns(1.1) = (-4.5)\\left(\\frac{9 - 5.5}{9}\\right)(1 + 1.1\\mu) = (-0.5)(3.5)(1 + 1.1\\mu) = -1.75(1 + 1.1\\mu)\n$$\n使用分数，$-1.75 = -\\frac{7}{4}$ 且 $1.1 = \\frac{11}{10}$。因此，$s(1.1) = -\\frac{7}{4}(1 + \\frac{11}{10}\\mu)$。\n\n目标函数为：\n$$\nJ(\\mu) = \\left(-\\frac{7}{4}\\left(1 + \\frac{9}{10}\\mu\\right)\\right)^{2} + \\left(-\\frac{7}{4}\\left(1 + \\frac{11}{10}\\mu\\right)\\right)^{2} = \\left(\\frac{7}{4}\\right)^{2} \\left[ \\left(1 + \\frac{9}{10}\\mu\\right)^{2} + \\left(1 + \\frac{11}{10}\\mu\\right)^{2} \\right]\n$$\n为求最小值，我们可以忽略正常数因子 $(\\frac{7}{4})^{2}$，转而最小化函数 $\\tilde{J}(\\mu) = (1 + \\frac{9}{10}\\mu)^{2} + (1 + \\frac{11}{10}\\mu)^{2}$。我们通过将其关于 $\\mu$ 的导数设为零来找到临界点：\n$$\n\\frac{d\\tilde{J}}{d\\mu} = 2\\left(1 + \\frac{9}{10}\\mu\\right)\\left(\\frac{9}{10}\\right) + 2\\left(1 + \\frac{11}{10}\\mu\\right)\\left(\\frac{11}{10}\\right) = 0\n$$\n除以 $2$：\n$$\n\\frac{9}{10}\\left(1 + \\frac{9}{10}\\mu\\right) + \\frac{11}{10}\\left(1 + \\frac{11}{10}\\mu\\right) = 0\n$$\n$$\n\\frac{9}{10} + \\frac{81}{100}\\mu + \\frac{11}{10} + \\frac{121}{100}\\mu = 0\n$$\n合并项：\n$$\n\\left(\\frac{9}{10} + \\frac{11}{10}\\right) + \\left(\\frac{81}{100} + \\frac{121}{100}\\right)\\mu = 0\n$$\n$$\n\\frac{20}{10} + \\frac{202}{100}\\mu = 0\n$$\n$$\n2 + \\frac{202}{100}\\mu = 0\n$$\n$$\n\\frac{202}{100}\\mu = -2 \\implies \\mu = -2 \\cdot \\frac{100}{202} = -\\frac{200}{202} = -\\frac{100}{101}\n$$\n二阶导数为 $\\frac{d^{2}\\tilde{J}}{d\\mu^{2}} = 2(\\frac{9}{10})^2 + 2(\\frac{11}{10})^2 > 0$，这证实了该 $\\mu$ 值对应于一个最小值。\n\n现在我们将这个最优值 $\\mu = -\\frac{100}{101}$ 代回到 $s(\\lambda)$ 的表达式中：\n$$\ns(\\lambda) = (1 - 5\\lambda)\\left(1 - \\frac{5}{9}\\lambda\\right)\\left(1 - \\frac{100}{101}\\lambda\\right)\n$$\n这就是满足所有给定条件的最优3次残差多项式的最终闭式表达式。", "answer": "$$\\boxed{s(\\lambda) = (1 - 5\\lambda)\\left(1 - \\frac{5}{9}\\lambda\\right)\\left(1 - \\frac{100}{101}\\lambda\\right)}$$", "id": "3565786"}]}