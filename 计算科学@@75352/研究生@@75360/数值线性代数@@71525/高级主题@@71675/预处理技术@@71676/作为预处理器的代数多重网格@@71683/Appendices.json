{"hands_on_practices": [{"introduction": "代数多重网格（AMG）的一个核心思想是，它能仅从线性系统矩阵 $\\mathbf{A}$ 本身“发现”问题的几何结构。这一过程的第一步是确定变量之间的耦合强度，并据此将变量划分为粗网格点（C-points）和细网格点（F-points）。这个练习将引导你亲手执行这一过程，通过应用经典的强度阈值准则来识别强连接，并使用贪心算法构建一个粗/细网格划分，从而具体地理解 AMG 如何为各向异性问题自动构建合适的粗网格。[@problem_id:3532927]", "problem": "考虑一个线性系统 $\\mathbf{A}\\mathbf{u}=\\mathbf{f}$，该系统由二维各向异性拉普拉斯算子在均匀 $5\\times 5$ 网格上进行标准五点有限差分格化得到，且在两个方向上均采用周期性边界条件。离散算子使用以下常数模板\n$$\n\\begin{bmatrix}\n0  & -\\epsilon & 0\\\\\n-1 & 2(1+\\epsilon) & -1\\\\\n0 & -\\epsilon & 0\n\\end{bmatrix},\n$$\n其中 $\\epsilon=0.1$。因此，对于每个网格点 $(i,j)$，矩阵 $\\mathbf{A}$ 的对角线元素为 $a_{ii}=2(1+\\epsilon)$，与其水平相邻点对应的非对角线元素为 $-1$，与其垂直相邻点对应的非对角线元素为 $-\\epsilon$（在边界处进行环绕处理）。假设未知数按行主字典序索引，即 $(1,1),(1,2),\\ldots,(1,5),(2,1),\\ldots,(5,5)$。\n\n你将使用代数多重网格 (AMG) 作为矩阵 $\\mathbf{A}$ 的右预条件子。在经典 AMG 方法中，如果 $a_{ij}  0$ 且满足以下条件，则称点 $j$ 是点 $i$ 的一个强负连接：\n$$\n- a_{ij} \\geq \\theta \\max_{k\\neq i} \\left(-a_{ik}\\right),\n$$\n其中强度阈值 $\\theta=0.25$。如果 $i$ 强依赖于 $j$ 或 $j$ 强依赖于 $i$，则在 $i$ 和 $j$ 之间放置一条边，从而构建无向强连接图。然后，通过选择该无向强连接图的一个最大独立集 (MIS) 来构造粗/细 (C/F) 点划分。选择方法采用以下确定性贪心规则：按给定的字典序遍历节点，如果一个节点在强连接图中的已访问邻居均不为粗点，则将其标记为粗点；否则将其标记为细点。这将产生一个明确定义的 C/F 点划分。\n\n从上述定义出发，除了给定的强连接判据和 MIS 规则外，不假设任何未经证明的 AMG 启发式方法，确定此过程在 $5\\times 5$ 网格上产生的粗点总数。请以单个整数形式给出你的最终答案。无需四舍五入。", "solution": "用户希望我解决这个问题。我已阅读说明，现在开始解决问题。\n问题要求我们确定在一个由有限差分格化产生的线性系统上，应用特定的代数多重网格 (AMG) 粗化过程后所产生的粗点总数。该过程是完全确定性的。\n\n首先，我们必须验证问题陈述。\n**步骤1：提取已知条件**\n- 线性系统：$\\mathbf{A}\\mathbf{u}=\\mathbf{f}$。\n- 格化：二维各向异性拉普拉斯算子的标准五点有限差分。\n- 网格：均匀 $5\\times 5$ 网格，两个方向均有周期性边界条件。\n- 模板：$\\begin{bmatrix} 0  -\\epsilon  0\\\\ -1  2(1+\\epsilon)  -1\\\\ 0  -\\epsilon  0 \\end{bmatrix}$。\n- 各向异性参数：$\\epsilon=0.1$。\n- 矩阵元素：对于网格点 $i$，对角线元素为 $a_{ii}=2(1+\\epsilon)$。与水平邻居对应的非对角线元素为 $-1$，与垂直邻居对应的非对角线元素为 $-\\epsilon$。网格共有 $N=25$ 个点。\n- 未知数索引：行主字典序，即 $(1,1), (1,2), \\dots, (1,5), (2,1), \\dots, (5,5)$。\n- AMG 粗化：\n    - 强连接条件：如果 $a_{ij}  0$ 且 $- a_{ij} \\geq \\theta \\max_{k\\neq i} \\left(-a_{ik}\\right)$，则点 $j$ 是点 $i$ 的一个强负连接。\n    - 强度阈值：$\\theta=0.25$。\n    - 强连接图：一个无向图，如果 $i$ 强依赖于 $j$ 或 $j$ 强依赖于 $i$，则在 $i$ 和 $j$ 之间存在一条边。\n    - 粗/细 (C/F) 点划分：强连接图的一个最大独立集 (MIS) 决定了粗点。\n    - MIS 构建规则：按字典序遍历节点。如果一个节点在强连接图中的已访问邻居均不为粗点，则将其标记为粗点；否则标记为细点。\n\n**步骤2：使用提取的已知条件进行验证**\n这个问题在数值线性代数和代数多重网格方法领域有坚实的科学基础。所有概念，如有限差分模板、周期性边界条件、强连接和最大独立集算法，都是标准且明确定义的。问题是适定的：所有参数（$\\epsilon$、$\\theta$）、网格大小、节点顺序和贪心算法都已明确说明，确保了唯一的可计算解。语言客观而精确。问题没有违反任何无效性标准。\n\n**步骤3：结论和行动**\n问题是有效的。我现在将进行求解。\n\n求解过程包括三个主要部分：\n1.  确定强连接图的结构。\n2.  应用指定的 最大独立集 (MIS) 算法，为单行找到粗点。\n3.  将结果外推到整个网格。\n\n**1. 确定强连接图**\n\n对于任意网格点 $i$，矩阵 $\\mathbf{A}$ 有四个非零的非对角线元素，对应其邻居。由于 $5\\times 5$ 网格上的周期性边界条件，每个点都恰好有四个邻居：两个水平方向和两个垂直方向。\n- 水平连接的非对角线元素为 $a_{ij} = -1$。\n- 垂直连接的非对角线元素为 $a_{ij} = -\\epsilon = -0.1$。\n\n为了应用强连接判据，我们首先需要计算任意行 $i$ 的非对角线元素的最大绝对值：\n$$\n\\max_{k\\neq i} \\left(-a_{ik}\\right) = \\max\\left(1, 1, \\epsilon, \\epsilon\\right) = \\max\\left(1, 1, 0.1, 0.1\\right) = 1\n$$\n强度阈值给定为 $\\theta=0.25$。如果 $-a_{ij} \\geq \\theta \\times 1$，即 $-a_{ij} \\geq 0.25$，则从 $i$ 到 $j$ 的连接是强的。\n\n让我们对两种类型的连接评估此条件：\n- 对于水平邻居 $j$，$-a_{ij} = -(-1) = 1$。由于 $1 \\geq 0.25$，水平连接是**强**的。\n- 对于垂直邻居 $j$，$-a_{ij} = -(-\\epsilon) = -(-0.1) = 0.1$。由于 $0.1  0.25$，垂直连接是**弱**的。\n\n问题陈述，如果 $i$ 强依赖于 $j$ 或反之，$i$ 和 $j$ 之间就存在一条边，构成无向强连接图。矩阵 $\\mathbf{A}$ 是对称的 ($a_{ij} = a_{ji}$)，因此该条件也是对称的：$i$ 强依赖于 $j$ 当且仅当 $j$ 强依赖于 $i$。\n因此，强连接图仅由连接水平邻居的边组成。\n\n对于一个网格点 $(r,c)$，其中 $r$ 是行索引，$c$ 是列索引 ($r,c \\in \\{1, 2, 3, 4, 5\\}$)，它与 $(r, c-1)$ 和 $(r, c+1)$ 强连接。由于周期性边界条件，第 $1$ 列与第 $5$ 列相邻。这意味着对于每一行 $r$，网格点 $(r,1), (r,2), (r,3), (r,4), (r,5)$ 构成一个长度为 $5$ 的循环图：$(r,1) \\leftrightarrow (r,2) \\leftrightarrow (r,3) \\leftrightarrow (r,4) \\leftrightarrow (r,5) \\leftrightarrow (r,1)$。\n由于没有强的垂直连接，整个强连接图是 $5$ 个这样的循环图的不交并，网格的每一行对应一个。\n\n**2. 对单行应用 MIS 算法**\n\nC/F 点划分是通过使用基于字典序节点排序的贪心算法找到强连接图的 MIS 来确定的。节点按 $(1,1), \\dots, (1,5), (2,1), \\dots, (2,5), \\dots$ 的顺序排列。这意味着我们先处理第 1 行的所有节点，然后是第 2 行的所有节点，依此类推。\n由于强连接图是逐行断开的，因此每一行的 C/F 划分都与其他行无关。我们可以分析单行（例如第 $r$ 行）的过程，其结果将与所有其他行完全相同。\n\n让我们分析第 $r$ 行中 5 个节点的处理过程。为简单起见，我们将该行中的节点标记为 $v_1, v_2, v_3, v_4, v_5$，分别对应第 1 到第 5 列。强连接为 $(v_1, v_2), (v_2, v_3), (v_3, v_4), (v_4, v_5), (v_5, v_1)$。算法按以下方式进行，其中 $C_{set}$ 是粗点集合：\n- **节点 $v_1$（例如点 $(r,1)$）：**这是该行中访问的第一个节点。它没有已被访问过的邻居是粗点（这样的邻居集合为空）。因此，$v_1$ 被标记为**粗点 (C)**。$C_{set} = \\{v_1\\}$。\n- **节点 $v_2$（点 $(r,2)$）：**它在强连接图中的邻居是 $v_1$ 和 $v_3$。唯一已访问的邻居是 $v_1$。由于 $v_1$ 在 $C_{set}$ 中，$v_2$ 有一个粗点邻居。因此，$v_2$ 被标记为**细点 (F)**。\n- **节点 $v_3$（点 $(r,3)$）：**它的邻居是 $v_2$ 和 $v_4$。唯一已访问的邻居是 $v_2$。由于 $v_2$ 不是粗点，$v_3$ 在已访问节点中没有粗点邻居。因此，$v_3$ 被标记为**粗点 (C)**。$C_{set} = \\{v_1, v_3\\}$。\n- **节点 $v_4$（点 $(r,4)$）：**它的邻居是 $v_3$ 和 $v_5$。其已访问的邻居是 $v_2$ 和 $v_3$。由于 $v_3$ 在 $C_{set}$ 中，$v_4$ 有一个粗点邻居。因此，$v_4$ 被标记为**细点 (F)**。\n- **节点 $v_5$（点 $(r,5)$）：**它的邻居是 $v_4$ 和 $v_1$。其已访问的邻居是 $v_1, v_2, v_3, v_4$。由于 $v_1$ 在 $C_{set}$ 中，$v_5$ 有一个粗点邻居。因此，$v_5$ 被标记为**细点 (F)**。\n\n对于单行，C/F 划分模式为 C-F-C-F-F。一行中的粗点数量为 $2$。\n\n**3. 计算粗点总数**\n\n上述过程对于网格的 5 行中的每一行都是相同的，因为行内图的结构和排序对所有行都一样。\n- 每行粗点数 = $2$。\n- 行数 = $5$。\n\n粗点总数 = (每行粗点数) $\\times$ (行数)\n$$\n\\text{粗点总数} = 2 \\times 5 = 10\n$$\n\n该过程在 $5\\times 5$ 网格上总共产生 $10$ 个粗点。", "answer": "$$\n\\boxed{10}\n$$", "id": "3532927"}, {"introduction": "一个有效的多重网格方法，其粗网格必须能够准确地“近似”那些使标准迭代法（如 Jacobi 或 Gauss-Seidel）收敛缓慢的代数光滑误差分量。这一要求被称为“近似性质”，是 AMG 成功的基石。本练习通过一个精心设计的反例，揭示了当粗/细网格划分和插值算子选择不当时，近似性质是如何被破坏的。通过计算一个关键的代数判据，你将能从根本上诊断出为何某些粗网格选择是失败的。[@problem_id:3532911]", "problem": "考虑为具有对称正定（SPD）矩阵的线性系统设计代数多重网格（AMG）预条件子的问题。设系统矩阵为在四个网格点上具有狄利克雷边界条件的标准一维离散拉普拉斯算子，\n$$\nA \\;=\\;\n\\begin{pmatrix}\n2  -1  0  0 \\\\\n-1  2  -1  0 \\\\\n0  -1  2  -1 \\\\\n0  0  -1  2\n\\end{pmatrix},\n$$\n并假设选择的粗/细（C/F）分裂中，粗变量位于索引 $\\{1,4\\}$ 处，细变量位于索引 $\\{2,3\\}$ 处。通过在粗点处直接注入且不对细点进行插值来定义延拓算子 $P$，因此 $P$ 的列是索引 1 和 4 处的坐标向量，即\n$$\nP \\;=\\;\n\\begin{pmatrix}\n1  0 \\\\\n0  0 \\\\\n0  0 \\\\\n0  1\n\\end{pmatrix}.\n$$\n仅从代数多重网格（AMG）作为预条件子的核心定义、粗空间 $\\operatorname{Range}(P)$ 的作用以及伽辽金构造 $A_{\\mathrm{c}} = P^{\\top} A P$ 出发，通过识别一个粗空间无法近似的非零代数光滑误差，解释为什么这种 C/F 分裂和插值的选择违反了近似性质。然后，通过计算 $\\operatorname{Null}(P^{\\top} A)$ 的维数，使用涉及 $P^{\\top} A$ 的零空间的代数准则来诊断这一失败。\n\n你的最终答案必须是 $\\operatorname{Null}(P^{\\top} A)$ 的维数，表示为单个整数。不需要四舍五入。", "solution": "该问题陈述是数值线性代数中的一个有效练习，具体涉及代数多重网格（AMG）方法的原理。所有给定的定义和矩阵都是标准的，构成了一个自洽且适定的问题。我们可以开始求解。\n\n两网格方法（并延伸至多重网格）的核心思想是，使用松弛方法（如雅可比或高斯-赛德尔）来衰减误差的高频（振荡）分量，并使用粗网格校正步骤来消除松弛方法难以处理的误差的低频（代数光滑）分量。\n\n为了使粗网格校正有效，必须满足两个主要条件：\n$1$. **近似性质**：由延拓算子 $P$ 的值域表示的粗网格向量空间，记作 $\\operatorname{Range}(P)$，必须能够精确地近似代数光滑误差分量。\n$2$. 粗网格算子 $A_{\\mathrm{c}} = P^{\\top} A P$ 必须是细网格算子 $A$ 在粗空间上的良好、稳定的表示。\n\n问题要求我们证明第一个性质被违反，并用代数方法诊断这一失败。\n\n### 第一部分：违反近似性质\n\n如果一个误差向量 $e$ 是与 $A$ 的小特征值对应的特征向量的线性组合，则该向量被认为是代数光滑的。通常，如果瑞利商 $R(e) = \\frac{e^{\\top}Ae}{e^{\\top}e}$ 很小，则向量 $e$ 是光滑的。对于离散拉普拉斯矩阵 $A$，光滑向量是指那些在相邻网格点之间振荡不大的向量。一个典型的光滑向量例子是其分量几乎恒定的向量。让我们考虑向量 $e_{\\mathrm{smooth}} = \\begin{pmatrix} 1  1  1  1 \\end{pmatrix}^{\\top}$。这个向量代表一个常数模式，是网格上可能的最光滑函数。这个向量相对于 $A$ 确实是代数光滑的，因为它的瑞利商是 $R(e_{\\mathrm{smooth}}) = \\frac{\\begin{pmatrix} 1  1  1  1 \\end{pmatrix} A \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\\\ 1 \\end{pmatrix}}{\\begin{pmatrix} 1  1  1  1 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\\\ 1 \\end{pmatrix}} = \\frac{\\begin{pmatrix} 1  1  1  1 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\\\ 1 \\end{pmatrix}}{4} = \\frac{2}{4} = \\frac{1}{2}$。$A$ 的最小特征值是 $\\lambda_1 = 2 - 2\\cos(\\frac{\\pi}{5}) \\approx 0.382$，因此 $0.5$ 的瑞利商表明这是一个非常光滑的向量。\n\n近似性质要求这个光滑向量 $e_{\\mathrm{smooth}}$ 能够被粗空间 $\\operatorname{Range}(P)$ 中的一个向量很好地近似。给定的延拓算子是\n$$\nP \\;=\\;\n\\begin{pmatrix}\n1  0 \\\\\n0  0 \\\\\n0  0 \\\\\n0  1\n\\end{pmatrix}.\n$$\n$P$ 的列是标准基向量 $e_1$ 和 $e_4$。粗空间 $\\operatorname{Range}(P)$ 是所有形如 $v_c = \\alpha e_1 + \\beta e_4$ 的向量的集合，可以写成\n$$\nv_c = \\begin{pmatrix} \\alpha \\\\ 0 \\\\ 0 \\\\ \\beta \\end{pmatrix}\n$$\n其中 $\\alpha, \\beta \\in \\mathbb{R}$ 是标量。\n\n为了用 $\\operatorname{Range}(P)$ 中的向量来近似 $e_{\\mathrm{smooth}} = \\begin{pmatrix} 1  1  1  1 \\end{pmatrix}^{\\top}$，我们会选择 $\\alpha=1$ 和 $\\beta=1$ 以匹配粗点（索引 $\\{1,4\\}$）处的值。因此，$e_{\\mathrm{smooth}}$ 在 $\\operatorname{Range}(P)$ 中的最佳近似是\n$$\ne_{\\mathrm{approx}} = \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\\\ 1 \\end{pmatrix}.\n$$\n这个近似的误差是\n$$\ne_{\\mathrm{err}} = e_{\\mathrm{smooth}} - e_{\\mathrm{approx}} = \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\\\ 1 \\end{pmatrix} - \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 1 \\\\ 1 \\\\ 0 \\end{pmatrix}.\n$$\n这个误差的大小是 $\\|e_{\\mathrm{err}}\\|_2 = \\sqrt{0^2 + 1^2 + 1^2 + 0^2} = \\sqrt{2}$，与原始光滑向量的大小 $\\|e_{\\mathrm{smooth}}\\|_2 = \\sqrt{4} = 2$ 相比是显著的。这个近似完全没有捕捉到光滑误差在细点（索引 $\\{2,3\\}$）处的行为。这是所选 $P$ 的直接后果，它没有执行插值；它只是注入粗点的值，并将细点的值设置为零。因此，这种对 $P$ 的选择违反了近似性质。向量 $e_{\\mathrm{smooth}} = \\begin{pmatrix} 1  1  1  1 \\end{pmatrix}^{\\top}$ 是一个粗空间无法很好近似的非零代数光滑误差。\n\n### 第二部分：通过 $\\operatorname{Null}(P^{\\top} A)$ 进行诊断\n\n对于失败的粗网格校正，一个更形式化的代数准则是算子 $P^{\\top} A$ 存在一个非平凡的零空间。如果存在一个非零向量 $e$ 使得 $P^{\\top} A e = 0$，这意味着一个光滑误差分量 $e$ 可以产生一个对粗网格完全“不可见”的残差 $r=Ae$。残差的限制 $P^{\\top}r$ 将为零。因此，粗网格问题 $A_{\\mathrm{c}} e_{\\mathrm{c}} = P^{\\top} r$ 的右侧将为零，导致校正量 $e_{\\mathrm{c}}=0$。误差 $e$ 将不会被粗网格步骤校正。这个零空间的维数，量化了粗网格校正无法处理的独立“坏”模式的数量。\n\n我们计算矩阵乘积 $P^{\\top} A$：\n$$\nP^{\\top} = \\begin{pmatrix} 1  0  0  0 \\\\ 0  0  0  1 \\end{pmatrix}.\n$$\n$$\nP^{\\top} A = \\begin{pmatrix} 1  0  0  0 \\\\ 0  0  0  1 \\end{pmatrix}\n\\begin{pmatrix}\n2  -1  0  0 \\\\\n-1  2  -1  0 \\\\\n0  -1  2  -1 \\\\\n0  0  -1  2\n\\end{pmatrix}\n= \\begin{pmatrix}\n2  -1  0  0 \\\\\n0  0  -1  2\n\\end{pmatrix}.\n$$\n现在，我们必须找到这个 $2 \\times 4$ 矩阵的零空间。我们寻找所有向量 $x = \\begin{pmatrix} x_1  x_2  x_3  x_4 \\end{pmatrix}^{\\top}$ 使得 $(P^{\\top} A) x = 0$：\n$$\n\\begin{pmatrix}\n2  -1  0  0 \\\\\n0  0  -1  2\n\\end{pmatrix}\n\\begin{pmatrix} x_1 \\\\ x_2 \\\\ x_3 \\\\ x_4 \\end{pmatrix}\n= \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}.\n$$\n这个矩阵方程对应于以下具有四个未知数的两个线性方程组：\n\\begin{align*}\n2x_1 - x_2 = 0 \\\\\n-x_3 + 2x_4 = 0\n\\end{align*}\n从第一个方程，我们得到 $x_2 = 2x_1$。从第二个方程，我们得到 $x_3 = 2x_4$。变量 $x_1$ 和 $x_4$ 是自由变量。让我们设 $x_1 = s$ 和 $x_4 = t$，其中 $s, t \\in \\mathbb{R}$ 是任意参数。通解是：\n$$\nx = \\begin{pmatrix} x_1 \\\\ x_2 \\\\ x_3 \\\\ x_4 \\end{pmatrix} = \\begin{pmatrix} s \\\\ 2s \\\\ 2t \\\\ t \\end{pmatrix} = s \\begin{pmatrix} 1 \\\\ 2 \\\\ 0 \\\\ 0 \\end{pmatrix} + t \\begin{pmatrix} 0 \\\\ 0 \\\\ 2 \\\\ 1 \\end{pmatrix}.\n$$\n零空间 $\\operatorname{Null}(P^{\\top} A)$ 由两个线性无关的向量张成\n$$\nv_1 = \\begin{pmatrix} 1 \\\\ 2 \\\\ 0 \\\\ 0 \\end{pmatrix} \\quad \\text{和} \\quad v_2 = \\begin{pmatrix} 0 \\\\ 0 \\\\ 2 \\\\ 1 \\end{pmatrix}.\n$$\n由于零空间由两个线性无关的向量张成，其维数为 2。这证实了所选 AMG 设置的失败。存在一个二维的误差向量子空间，该子空间被此 $P$ 定义的粗网格校正过程完全忽略。\n\n最终答案是这个零空间的维数。", "answer": "$$\n\\boxed{2}\n$$", "id": "3532911"}, {"introduction": "理想的代数多重网格预条件子应具备最优的计算复杂度，即求解问题的总工作量与未知数数量成线性关系。为了在实际运行前评估一个 AMG 层次结构的效率，研究者们定义了一系列复杂度指标。这个练习将带你计算两个关键的复杂度——网格复杂度和算子复杂度——以及每次 V-循环的标准化工作量。通过这些计算，你可以量化评估一个 AMG 设置的成本，并理解为什么保持这些指标值较小对于实现高效求解至关重要。[@problem_id:3532884]", "problem": "考虑使用代数多重网格 (AMG) 预处理的共轭梯度法求解一个对称正定线性系统。一个 AMG 层次包含三个层级 $l \\in \\{0,1,2\\}$，其自由度分别为 $(n_0,n_1,n_2)=(4096,1024,256)$。细层矩阵 $A_0$ 每行约有 $5$ 个非零元，中间层矩阵 $A_1$ 每行约有 $9$ 个非零元，粗层矩阵 $A_2$ 每行约有 $15$ 个非零元。为计算工作量，作如下假设：\n- 一个 V-循环在每个非最粗层上使用一次前平滑扫描和一次后平滑扫描，采用加权雅可比松弛法；每次平滑扫描的成本计为与矩阵 $A_l$ 进行一次稀疏矩阵向量乘法 (SpMV) 的成本。\n- 在每个非最粗层上，计算残差的成本计为与矩阵 $A_l$ 进行一次 SpMV 的成本。\n- 在最粗层上，本次估算忽略粗网格求解的成本，并且在所有层级上都忽略限制和延拓的成本。\n使用标准的 AMG 复杂度定义来定义网格复杂度 $C_g$ 和算子复杂度 $C_o$。使用上述工作量模型，以细层 SpMV 等效单位估算每个 V-循环的归一化工作量 $W$，即 V-循环总工作量除以一次与 $A_0$ 进行 SpMV 的成本。计算 $C_g$、$C_o$ 和 $W$。将最终答案表示为包含这三个量 $(C_g,C_o,W)$ 的单行矩阵，不要四舍五入。", "solution": "该问题被评估为有效。它在数值线性代数领域，特别是在代数多重网格 (AMG) 方法方面，具有科学依据。问题陈述是自洽的、适定的、客观的，并提供了计算所需量所需的所有必要数据和定义。解题过程通过应用所要求指标的标准定义来进行。\n\nAMG 层次包含 $3$ 个层级，索引为 $l \\in \\{0, 1, 2\\}$，其中最细层为 $l=0$，最粗层为 $l=2$。每个层级的自由度 (DoF) 数量为 $n_0 = 4096$，$n_1 = 1024$ 和 $n_2 = 256$。每个层级 $l$ 的矩阵 $A_l$ 每行的非零元条目数近似为 $nnz_r(A_0) \\approx 5$，$nnz_r(A_1) \\approx 9$ 和 $nnz_r(A_2) \\approx 15$。为了计算方便，这些近似值将被视为精确值。\n\n首先，我们计算网格复杂度 $C_g$。它定义为所有层级的总自由度数与最细层自由度数之比。\n$$C_g = \\frac{\\sum_{l=0}^{2} n_l}{n_0} = \\frac{n_0 + n_1 + n_2}{n_0}$$\n代入给定值：\n$$C_g = \\frac{4096 + 1024 + 256}{4096} = \\frac{5376}{4096}$$\n为简化此分数，我们可以用公因子表示分子和分母。注意到 $1024 = 4096/4$ 且 $256 = 4096/16$：\n$$C_g = 1 + \\frac{1024}{4096} + \\frac{256}{4096} = 1 + \\frac{1}{4} + \\frac{1}{16} = \\frac{16}{16} + \\frac{4}{16} + \\frac{1}{16} = \\frac{21}{16}$$\n\n接下来，我们计算算子复杂度 $C_o$。它定义为所有系统矩阵中非零元总数与细层矩阵中非零元数之比。矩阵 $A_l$ 中的非零元总数 $N_l$ 是行数（自由度数）$n_l$ 与每行非零元数 $nnz_r(A_l)$ 的乘积。\n$$N_l = n_l \\times nnz_r(A_l)$$\n我们计算每个层级的 $N_l$：\n$$N_0 = n_0 \\times nnz_r(A_0) = 4096 \\times 5 = 20480$$\n$$N_1 = n_1 \\times nnz_r(A_1) = 1024 \\times 9 = 9216$$\n$$N_2 = n_2 \\times nnz_r(A_2) = 256 \\times 15 = 3840$$\n那么算子复杂度 $C_o$ 是：\n$$C_o = \\frac{\\sum_{l=0}^{2} N_l}{N_0} = \\frac{N_0 + N_1 + N_2}{N_0} = \\frac{20480 + 9216 + 3840}{20480} = \\frac{33536}{20480}$$\n简化该分数：\n$$C_o = 1 + \\frac{9216}{20480} + \\frac{3840}{20480} = 1 + \\frac{1024 \\times 9}{4096 \\times 5} + \\frac{256 \\times 15}{4096 \\times 5} = 1 + \\frac{9}{4 \\times 5} + \\frac{15}{16 \\times 5} = 1 + \\frac{9}{20} + \\frac{3}{16}$$\n使用公分母 $80$：\n$$C_o = \\frac{80}{80} + \\frac{9 \\times 4}{80} + \\frac{3 \\times 5}{80} = \\frac{80 + 36 + 15}{80} = \\frac{131}{80}$$\n\n最后，我们计算每个 V-循环的归一化工作量 $W$。工作量模型指定了在每个非最粗层级（$l=0, 1$）上的操作。在每个这样的层级 $l$ 上，工作量包括 $1$ 次前平滑扫描、$1$ 次后平滑扫描和 $1$ 次残差计算。这 $3$ 个操作中的每一个都计为与矩阵 $A_l$ 进行一次稀疏矩阵向量乘法 (SpMV) 的成本。与 $A_l$ 进行一次 SpMV 的成本可以视为与非零元数量 $N_l$ 成正比。设与 $A_l$ 进行一次 SpMV 的成本表示为 $\\text{Work}(\\text{SpMV}_l) = N_l$。\n在一个非最粗层级 $l$ 上的总工作量是：\n$$\\text{Work}_l = (1_{\\text{pre}} + 1_{\\text{post}} + 1_{\\text{res}}) \\times \\text{Work}(\\text{SpMV}_l) = 3 \\times N_l$$\n限制、延拓和粗网格求解（$l=2$）的成本被忽略。因此，一个 V-循环的总工作量是层级 $l=0$ 和 $l=1$ 上工作量的总和：\n$$\\text{Work}_{V-cycle} = \\text{Work}_0 + \\text{Work}_1 = 3 N_0 + 3 N_1$$\n归一化工作量 $W$ 是这个总工作量除以一次细层 SpMV 的成本，即 $N_0$：\n$$W = \\frac{3 N_0 + 3 N_1}{N_0} = 3 + 3 \\frac{N_1}{N_0}$$\n代入先前计算出的 $N_0$ 和 $N_1$ 的值：\n$$W = 3 + 3 \\left(\\frac{9216}{20480}\\right)$$\n我们简化分数 $\\frac{N_1}{N_0}$：\n$$\\frac{N_1}{N_0} = \\frac{1024 \\times 9}{4096 \\times 5} = \\frac{1}{4} \\times \\frac{9}{5} = \\frac{9}{20}$$\n现在我们计算 $W$：\n$$W = 3 + 3 \\left(\\frac{9}{20}\\right) = 3 + \\frac{27}{20} = \\frac{60}{20} + \\frac{27}{20} = \\frac{87}{20}$$\n\n计算出的三个量是 $C_g = \\frac{21}{16}$，$C_o = \\frac{131}{80}$ 和 $W = \\frac{87}{20}$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{21}{16}  \\frac{131}{80}  \\frac{87}{20}\n\\end{pmatrix}\n}\n$$", "id": "3532884"}]}