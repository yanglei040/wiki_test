{"hands_on_practices": [{"introduction": "掌握CP分解的第一步是理解其最基本的属性：张量秩。这个练习将引导你直接应用该定义于一个简单但非平凡的张量，从而提供实践经验。通过构建一个分解并继而证明其最小性，你将巩固对张量秩真实含义的理解。[@problem_id:3586498]", "problem": "考虑一个实数域上尺寸为 $2 \\times 2 \\times 2$ 的三阶张量，记作 $\\mathcal{X} \\in \\mathbb{R}^{2 \\times 2 \\times 2}$，并令 $e_1, e_2 \\in \\mathbb{R}^2$ 表示标准基向量。假设 $\\mathcal{X}$ 定义为\n$$\n\\mathcal{X} \\;=\\; e_1 \\otimes e_1 \\otimes e_1 \\;+\\; e_2 \\otimes e_2 \\otimes e_2,\n$$\n其中 $\\otimes$ 表示外积。从秩-1张量和CANonical DECOMPosition/PARAFAC (CP)分解的基本定义出发，通过指定一个数 $R \\in \\mathbb{N}$、标量 $\\lambda_1,\\dots,\\lambda_R \\in \\mathbb{R}$ 以及因子向量 $a_r, b_r, c_r \\in \\mathbb{R}^2$（对于 $r = 1,\\dots,R$），构建 $\\mathcal{X}$ 的一个显式CP表示，使得\n$$\n\\mathcal{X} \\;=\\; \\sum_{r=1}^{R} \\lambda_r \\, a_r \\otimes b_r \\otimes c_r.\n$$\n仅使用秩-1张量和张量秩的核心定义，通过证明你的表示中 $R$ 的最小性来确定 $\\mathcal{X}$ 的CP秩（也称为张量秩）。将CP秩作为最终答案。无需四舍五入，也不涉及单位。", "solution": "问题要求对给定的三阶张量 $\\mathcal{X} \\in \\mathbb{R}^{2 \\times 2 \\times 2}$ 给出一个显式的CANonical DECOMPosition/PARAFAC (CP)表示，并通过证明该表示的最小性来确定其CP秩。\n\n首先，我们陈述基本定义。\n如果一个三阶张量 $\\mathcal{T} \\in \\mathbb{R}^{I \\times J \\times K}$ 可以写成三个向量 $a \\in \\mathbb{R}^I$、$b \\in \\mathbb{R}^J$ 和 $c \\in \\mathbb{R}^K$ 的外积，则称其为秩-1张量。也就是说，$\\mathcal{T} = a \\otimes b \\otimes c$，其元素为 $\\mathcal{T}_{ijk} = a_i b_j c_k$。\n\n张量 $\\mathcal{X}$ 的CP分解将其表示为秩-1张量的和。问题陈述给出的形式为：\n$$\n\\mathcal{X} = \\sum_{r=1}^{R} \\lambda_r \\, a_r \\otimes b_r \\otimes c_r\n$$\n其中 $R \\in \\mathbb{N}$ 是秩-1分量的数量，$\\lambda_r \\in \\mathbb{R}$ 是标量，且 $a_r, b_r, c_r$ 是适当维度的向量。\n\n张量 $\\mathcal{X}$ 的CP秩，或简称为秩，记作 $\\text{rank}(\\mathcal{X})$，是存在这种分解的最小整数 $R$。\n\n所讨论的张量是 $\\mathcal{X} \\in \\mathbb{R}^{2 \\times 2 \\times 2}$，定义为：\n$$\n\\mathcal{X} = e_1 \\otimes e_1 \\otimes e_1 + e_2 \\otimes e_2 \\otimes e_2\n$$\n其中 $e_1, e_2 \\in \\mathbb{R}^2$ 是标准基向量，$e_1 = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$ 且 $e_2 = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}$。\n\n我们首先为 $\\mathcal{X}$ 构建一个CP表示。$\\mathcal{X}$ 的给定定义已经是两个张量的和。让我们检查每一项：\n第一项是 $\\mathcal{T}_1 = e_1 \\otimes e_1 \\otimes e_1$。根据定义，这是一个秩-1张量。\n第二项是 $\\mathcal{T}_2 = e_2 \\otimes e_2 \\otimes e_2$。根据定义，这也是一个秩-1张量。\n\n因此，$\\mathcal{X}$ 的表达式是两个秩-1张量的和。这自然地提供了一个CP表示。我们可以通过设置以下参数，将其与通用形式 $\\sum_{r=1}^{R} \\lambda_r \\, a_r \\otimes b_r \\otimes c_r$ 相匹配：\n- $R = 2$\n- 对于 $r=1$：$\\lambda_1 = 1$，$a_1 = e_1$，$b_1 = e_1$，$c_1 = e_1$\n- 对于 $r=2$：$\\lambda_2 = 1$，$a_2 = e_2$，$b_2 = e_2$，$c_2 = e_2$\n\n这给出了分解 $\\mathcal{X} = 1 \\cdot (e_1 \\otimes e_1 \\otimes e_1) + 1 \\cdot (e_2 \\otimes e_2 \\otimes e_2)$，这恰好是 $\\mathcal{X}$ 的定义。因为我们找到了一个包含 $R=2$ 个分量的表示，我们已经确定了秩的一个上界：$\\text{rank}(\\mathcal{X}) \\leq 2$。\n\n接下来，为了确定确切的CP秩，我们必须证明这个表示是最小的。也就是说，我们必须证明 $\\mathcal{X}$ 不能用更少数量的秩-1分量来表示。唯一更小的非平凡分量数量是1。我们将用反证法证明 $\\text{rank}(\\mathcal{X}) \\neq 1$。\n\n为了进行反证，假设 $\\text{rank}(\\mathcal{X}) = 1$。如果这是真的，$\\mathcal{X}$ 就可以写成一个单一的秩-1张量。使用所要求的公式，这意味着存在一个标量 $\\lambda \\in \\mathbb{R}$ 和向量 $a, b, c \\in \\mathbb{R}^2$ 使得 $\\mathcal{X} = \\lambda \\, a \\otimes b \\otimes c$。我们可以不失一般性地将标量 $\\lambda$ 吸收到其中一个向量中（例如，令 $a' = \\lambda a$）。所以，这个假设等价于对于某些 $a, b, c \\in \\mathbb{R}^2$，有 $\\mathcal{X} = a \\otimes b \\otimes c$。\n\n让我们写出 $\\mathcal{X}$ 的分量。令 $\\mathcal{X}$ 的元素用 $\\mathcal{X}_{ijk}$ 表示，其中 $i,j,k \\in \\{1, 2\\}$。\n第一项 $e_1 \\otimes e_1 \\otimes e_1$ 的分量仅在 $(e_1 \\otimes e_1 \\otimes e_1)_{111} = (e_1)_1 (e_1)_1 (e_1)_1 = 1 \\cdot 1 \\cdot 1 = 1$ 时非零。\n第二项 $e_2 \\otimes e_2 \\otimes e_2$ 的分量仅在 $(e_2 \\otimes e_2 \\otimes e_2)_{222} = (e_2)_2 (e_2)_2 (e_2)_2 = 1 \\cdot 1 \\cdot 1 = 1$ 时非零。\n因此，张量 $\\mathcal{X}$ 恰好有两个非零元素：\n$$\n\\mathcal{X}_{111} = 1 \\quad \\text{和} \\quad \\mathcal{X}_{222} = 1\n$$\n所有其他元素 $\\mathcal{X}_{ijk}$ 均为 $0$。\n\n现在，让我们将这些分量与我们的秩-1假设等同起来。令 $a = \\begin{pmatrix} a_1 \\\\ a_2 \\end{pmatrix}$，$b = \\begin{pmatrix} b_1 \\\\ b_2 \\end{pmatrix}$，以及 $c = \\begin{pmatrix} c_1 \\\\ c_2 \\end{pmatrix}$。假设的秩-1张量的元素是 $\\mathcal{X}_{ijk} = a_i b_j c_k$。\n从非零元素，我们得到：\n1. $\\mathcal{X}_{111} = a_1 b_1 c_1 = 1$。这意味着 $a_1 \\neq 0$，$b_1 \\neq 0$ 且 $c_1 \\neq 0$。\n2. $\\mathcal{X}_{222} = a_2 b_2 c_2 = 1$。这意味着 $a_2 \\neq 0$，$b_2 \\neq 0$ 且 $c_2 \\neq 0$。\n\n现在，让我们考虑一个零元素，例如 $\\mathcal{X}_{112} = 0$。\n根据我们的秩-1假设，$\\mathcal{X}_{112} = a_1 b_1 c_2$。\n所以，我们必须有 $a_1 b_1 c_2 = 0$。\n从上面的推论(1)，我们知道 $a_1 \\neq 0$ 且 $b_1 \\neq 0$。要使乘积 $a_1 b_1 c_2$ 为零，必须有 $c_2 = 0$。\n\n然而，上面的推论(2)指出 $c_2 \\neq 0$。这是一个直接的矛盾。$c_2 = 0$ 和 $c_2 \\neq 0$ 这两个陈述不能同时为真。\n因此，$\\text{rank}(\\mathcal{X}) = 1$ 的初始假设必定是错误的。\n\n我们已经确定了两个事实：\n- $\\text{rank}(\\mathcal{X}) \\leq 2$（来自显式构造）\n- $\\text{rank}(\\mathcal{X}) > 1$（来自反证法证明）\n\n由于秩必须是整数，$\\mathcal{X}$ 的秩唯一可能的值是 $2$。\n\n$\\mathcal{X}$ 的CP秩是使得 $\\mathcal{X} = \\sum_{r=1}^{R} \\lambda_r \\, a_r \\otimes b_r \\otimes c_r$ 成立的最小 $R$。我们已经证明了 $R=2$ 是一个可能的值，而 $R=1$ 不是。因此，$R$ 的最小可能值是 $2$。", "answer": "$$\n\\boxed{2}\n$$", "id": "3586498"}, {"introduction": "在找到一个分解之后，一个关键的问题是它是否是*唯一*的。这个练习探讨了唯一性的概念，这是张量分解区别于像奇异值分解(SVD)这样的矩阵分解的一个核心特性。通过检验一个不满足Kruskal唯一性条件的情形，我们将亲手构建一个替代分解的族，从而使非唯一性这个抽象概念变得具体可感。[@problem_id:3586512]", "problem": "设 $\\mathcal{T} \\in \\mathbb{R}^{2 \\times 2 \\times 2}$ 是一个三阶张量，其典范分解/平行因子 (CANDECOMP/PARAFAC (CP)) 秩为 $R = 2$，由以下因子矩阵指定：\n$$\nA = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix}, \\quad\nB = \\begin{pmatrix} 1  1 \\\\ 1  -1 \\end{pmatrix}, \\quad\nC = \\begin{pmatrix} 1  1 \\\\ 1  1 \\end{pmatrix}.\n$$\nCP 模型为 $\\mathcal{T} = \\sum_{r=1}^{2} a_r \\circ b_r \\circ c_r$，其中 $a_r$、$b_r$ 和 $c_r$ 分别表示矩阵 $A$、$B$ 和 $C$ 的第 $r$ 列，$\\circ$ 表示外积。矩阵 $X$ 的 $k$-秩（也称为 Kruskal 秩）是最大整数 $k_X$，使得 $X$ 的任意 $k_X$ 列组成的子集都是线性无关的。\n\n任务：\n- 仅使用 CP 分解、$k$-秩的定义以及对于列维度匹配的矩阵 $U$ 和 $V$ 有 $U V^{\\top} = \\sum_{r}$ column$_r(U)$ column$_r(V)^{\\top}$ 这一事实，从第一性原理出发，论证 Kruskal 唯一性充分条件是否对这个特定的 $\\mathcal{T}$ 成立。\n- 然后，推导一个关于 $\\mathcal{T}$ 的单参数备选 CP 分解族，其形式为 $(A',B',C')$，定义如下：\n$$\nA' = A R(t), \\quad B' = B \\big(R(t)^{-T}\\big), \\quad C' = C,\n$$\n其中 $R(t) \\in \\mathbb{R}^{2 \\times 2}$ 是上三角矩阵\n$$\nR(t) = \\begin{pmatrix} 1  t \\\\ 0  1 \\end{pmatrix},\n$$\n且 $t \\in \\mathbb{R}$ 是一个标量参数。根据 CP 定义，证明为何对于所有使得 $R(t)$ 可逆的 $t$，$\\mathcal{T} = \\sum_{r=1}^{2} a'_r \\circ b'_r \\circ c'_r$ 仍然成立。\n- 施加归一化约束，即 $B' = B \\big(R(t)^{-T}\\big)$ 的第一列的第一个元素等于 $0$，并确定满足此约束的 $t$ 的精确值。\n\n你的最终答案应为 $t$ 的精确值（无单位）。最终答案中不要提供中间步骤。", "solution": "问题分为三个部分。首先，我们使用 Kruskal 充分条件评估给定 CP 分解的唯一性。其次，我们证明一个备选分解族的存在性。第三，我们找到满足给定归一化约束的特定参数值。\n\n第一部分：Kruskal 唯一性充分条件\n\nKruskal 定理为由因子矩阵 $A$、$B$ 和 $C$ 定义的秩为 $R$ 的 CP 分解的本质唯一性提供了一个充分条件。该条件由以下不等式给出：\n$$k_A + k_B + k_C \\ge 2R + 2$$\n其中 $k_X$ 是矩阵 $X$ 的 $k$-秩（或 Kruskal 秩）。$k$-秩是使得 $X$ 的任何 $k$ 列的集合都线性无关的最大整数 $k$。张量的秩给定为 $R=2$。我们必须计算给定因子矩阵 $A、B、C$ 的 $k$-秩。\n\n因子矩阵为：\n$$\nA = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix}, \\quad\nB = \\begin{pmatrix} 1  1 \\\\ 1  -1 \\end{pmatrix}, \\quad\nC = \\begin{pmatrix} 1  1 \\\\ 1  1 \\end{pmatrix}.\n$$\n\n-   对于矩阵 $A \\in \\mathbb{R}^{2 \\times 2}$：其列向量为 $a_1 = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$ 和 $a_2 = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}$。任何单列都是非零的，因此构成一个线性无关集。两列组成的集合是线性无关的，因为 $\\det(A) = 1(1) - 0(0) = 1 \\ne 0$。因此，可以选择构成线性无关集的最大列数为 $2$。$k$-秩为 $k_A = 2$。\n\n-   对于矩阵 $B \\in \\mathbb{R}^{2 \\times 2}$：其列向量为 $b_1 = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$ 和 $b_2 = \\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix}$。任何单列都是非零的。两列组成的集合是线性无关的，因为 $\\det(B) = 1(-1) - 1(1) = -2 \\ne 0$。因此，$k$-秩为 $k_B = 2$。\n\n-   对于矩阵 $C \\in \\mathbb{R}^{2 \\times 2}$：其列向量为 $c_1 = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$ 和 $c_2 = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$。任何单列都是非零的，所以任何大小为 $1$ 的子集都是线性无关的。然而，由于 $c_1 = c_2$，这两列组成的集合是线性相关的。因此，可以选择构成线性无关集的最大列数为 $1$。$k$-秩为 $k_C = 1$。\n\n现在我们用 $R=2$, $k_A=2$, $k_B=2$, 和 $k_C=1$ 来检验 Kruskal 条件：\n$$k_A + k_B + k_C \\ge 2R + 2$$\n$$2 + 2 + 1 \\ge 2(2) + 2$$\n$$5 \\ge 6$$\n此不等式不成立。因此，Kruskal 唯一性充分条件对此分解不满足。这意味着该分解不保证唯一，可能存在其他备选分解。\n\n第二部分：备选分解的证明\n\n题目要求我们证明张量 $\\mathcal{T}$ 也可以由一组新的因子矩阵 $(A', B', C')$ 表示，其定义为：\n$$\nA' = A R(t), \\quad B' = B \\big(R(t)^{-T}\\big), \\quad C' = C\n$$\n其中 $R(t) = \\begin{pmatrix} 1  t \\\\ 0  1 \\end{pmatrix}$。\nCP 分解按元素定义为 $\\mathcal{T}_{ijk} = \\sum_{r=1}^{R} A_{ir} B_{jr} C_{kr}$。设 $\\mathcal{T'}$ 是由新因子生成的张量。其元素由下式给出：\n$$\n\\mathcal{T}'_{ijk} = \\sum_{r=1}^{R} A'_{ir} B'_{jr} C'_{kr}\n$$\n新因子矩阵的列是旧因子矩阵列的线性组合。我们将 $A'$、$B'$ 和 $C'$ 的定义代入 $\\mathcal{T}'_{ijk}$ 的公式中。令 $R$ 表示 $R(t)$。\n$$A'_{ir} = (AR)_{ir} = \\sum_{s=1}^{R} A_{is} R_{sr}$$\n$$B'_{jr} = (BR^{-T})_{jr} = \\sum_{p=1}^{R} B_{jp} (R^{-T})_{pr} = \\sum_{p=1}^{R} B_{jp} (R^{-1})_{rp}$$\n$$C'_{kr} = C_{kr} \\quad (\\text{因为 } C' = C)$$\n将这些代入 $\\mathcal{T}'_{ijk}$ 的表达式中：\n$$\n\\mathcal{T}'_{ijk} = \\sum_{r=1}^{R} \\left(\\sum_{s=1}^{R} A_{is} R_{sr}\\right) \\left(\\sum_{p=1}^{R} B_{jp} (R^{-1})_{rp}\\right) C_{kr}\n$$\n我们可以重新排列求和顺序：\n$$\n\\mathcal{T}'_{ijk} = \\sum_{s=1}^{R} \\sum_{p=1}^{R} A_{is} B_{jp} \\left( \\sum_{r=1}^{R} R_{sr} (R^{-1})_{rp} C_{kr} \\right)\n$$\n我们来分析括号中的项。由于矩阵 $C$ 的一个特殊性质，这个恒等式成立。矩阵 $C$ 的行是 $(1,1)$ 和 $(1,1)$。这意味着对于一个固定的行索引 $k$，$C_{kr}$ 的值对于所有列索引 $r$ 都是恒定的。我们用 $c_k^*$ 表示这个常数值。在这个问题中，$C_{11}=C_{12}=1$ 所以 $c_1^*=1$，并且 $C_{21}=C_{22}=1$ 所以 $c_2^*=1$。\n我们可以将 $C_{kr} = c_k^*$ 从最内层的关于 $r$ 的求和中提出来：\n$$\n\\sum_{r=1}^{R} R_{sr} (R^{-1})_{rp} C_{kr} = c_k^* \\sum_{r=1}^{R} R_{sr} (R^{-1})_{rp}\n$$\n求和项 $\\sum_{r=1}^{R} R_{sr} (R^{-1})_{rp}$ 是矩阵乘积 $RR^{-1}$ 的第 $(s,p)$ 个元素，而 $RR^{-1}$ 是单位矩阵 $I$。因此，$\\sum_{r=1}^{R} R_{sr} (R^{-1})_{rp} = \\delta_{sp}$，其中 $\\delta_{sp}$ 是克罗内克（Kronecker）δ函数。\n括号内的表达式简化为 $c_k^* \\delta_{sp}$。将其代回：\n$$\n\\mathcal{T}'_{ijk} = \\sum_{s=1}^{R} \\sum_{p=1}^{R} A_{is} B_{jp} (c_k^* \\delta_{sp})\n$$\n克罗内克 δ 函数 $\\delta_{sp}$ 在 $s \\neq p$ 时为零，因此关于 $p$ 的求和会消去：\n$$\n\\mathcal{T}'_{ijk} = \\sum_{s=1}^{R} A_{is} B_{js} c_k^*\n$$\n由于 $c_k^*$ 是 $C$ 的第 $k$ 行的常数值，我们有 $c_k^* = C_{ks}$ 对任意 $s$ 成立。所以，我们可以写成：\n$$\n\\mathcal{T}'_{ijk} = \\sum_{s=1}^{R} A_{is} B_{js} C_{ks} = \\mathcal{T}_{ijk}\n$$\n这对所有的 $i,j,k$ 都成立，证明了 $\\mathcal{T}' = \\mathcal{T}$。这对任何使得 $R(t)$ 可逆的 $t$ 都有效。由于对所有 $t \\in \\mathbb{R}$，都有 $\\det(R(t)) = 1 \\ne 0$，所以这一族备选分解总是有效的。\n\n第三部分：参数 $t$ 的确定\n\n我们需要找到满足归一化约束（即 $B'$ 的第一列的第一个元素等于 $0$）的 $t$ 值。首先，我们计算矩阵 $B' = B(R(t)^{-T})$。\n\n矩阵 $R(t)$ 及其逆矩阵为：\n$$\nR(t) = \\begin{pmatrix} 1  t \\\\ 0  1 \\end{pmatrix}, \\quad R(t)^{-1} = \\begin{pmatrix} 1  -t \\\\ 0  1 \\end{pmatrix}\n$$\n所需的矩阵 $R(t)^{-T}$ 是逆矩阵的转置：\n$$\nR(t)^{-T} = (R(t)^{-1})^T = \\begin{pmatrix} 1  0 \\\\ -t  1 \\end{pmatrix}\n$$\n现在，我们通过将 $B$ 右乘 $R(t)^{-T}$ 来计算 $B'$：\n$$\nB' = B R(t)^{-T} = \\begin{pmatrix} 1  1 \\\\ 1  -1 \\end{pmatrix} \\begin{pmatrix} 1  0 \\\\ -t  1 \\end{pmatrix}\n$$\n执行矩阵乘法：\n$$\nB' = \\begin{pmatrix} 1(1) + 1(-t)  1(0) + 1(1) \\\\ 1(1) + (-1)(-t)  1(0) + (-1)(1) \\end{pmatrix} = \\begin{pmatrix} 1-t  1 \\\\ 1+t  -1 \\end{pmatrix}\n$$\n$B'$ 的第一列是 $\\begin{pmatrix} 1-t \\\\ 1+t \\end{pmatrix}$。该列的第一个元素是 $1-t$。归一化约束要求此元素为 $0$：\n$$\n1-t = 0\n$$\n解出 $t$，我们得到：\n$$\nt = 1\n$$\n因此，满足归一化约束的特定参数值为 $t=1$。", "answer": "$$\\boxed{1}$$", "id": "3586512"}, {"introduction": "张量分解揭示了一些在矩阵代数中没有对应物的迷人现象，其中最重要的之一是边界秩的概念。这个练习将展示，给定秩的张量集合在拓扑上不是闭合的，这意味着一个张量可以是低秩张量的极限，但其本身并不具有那个较低的秩。这项实践对于理解低秩张量近似所面临的挑战和精妙之处至关重要。[@problem_id:3586501]", "problem": "设 $\\mathcal{X} \\in \\mathbb{R}^{I \\times J \\times K}$ 是一个三阶张量。秩为 $R$ 的张量 $\\mathcal{X}$ 的 CANonical DECOMPosition/PARAllel FACtors (CP) 分解是一种表示形式 $\\mathcal{X} = \\sum_{r=1}^{R} \\lambda_{r} \\, a_{r} \\otimes b_{r} \\otimes c_{r}$，其中 $a_{r} \\in \\mathbb{R}^{I}$，$b_{r} \\in \\mathbb{R}^{J}$，$c_{r} \\in \\mathbb{R}^{K}$ 且 $\\lambda_{r} \\in \\mathbb{R}$。$\\mathcal{X}$ 的 CP 秩是存在这种表示的最小 $R$ 值。$\\mathcal{X}$ 的边界秩是满足以下条件的最小 $R$ 值：$\\mathcal{X}$ 是一系列 CP 秩至多为 $R$ 的张量的极限（在弗罗贝尼乌斯范数下）。弗罗贝尼乌斯范数 $\\|\\mathcal{X}\\|_{F}$ 是 $\\mathcal{X}$ 的所有元素平方和的平方根。\n\n在 $\\mathbb{R}$ 上进行运算，并考虑标准基向量 $e_{1}, e_{2} \\in \\mathbb{R}^{2}$。通过其非零元素 $\\mathcal{X}_{2,1,1} = 1$，$\\mathcal{X}_{1,2,1} = 1$ 和 $\\mathcal{X}_{1,1,2} = 1$ 隐式定义目标张量 $\\mathcal{X}_{0} \\in \\mathbb{R}^{2 \\times 2 \\times 2}$，即 $\\mathcal{X}_{0} = e_{2} \\otimes e_{1} \\otimes e_{1} + e_{1} \\otimes e_{2} \\otimes e_{1} + e_{1} \\otimes e_{1} \\otimes e_{2}$。\n\n仅使用上述基本定义和外积的基本性质，完成以下任务：\n\n- 显式构造一个单参数族 $\\{\\mathcal{X}_{\\epsilon}\\}_{\\epsilon > 0} \\subset \\mathbb{R}^{2 \\times 2 \\times 2}$，使得对于每个 $\\epsilon > 0$，$\\mathcal{X}_{\\epsilon}$ 的 CP 秩至多为 $2$，并且当 $\\epsilon \\to 0$ 时，每个 $\\mathcal{X}_{\\epsilon}$ 的 CP 表示中的因子在范数上必然发散，但 $\\mathcal{X}_{\\epsilon}$ 在弗罗贝尼乌斯范数下收敛于 $\\mathcal{X}_{0}$。您的构造必须通过选择归一化方式明确指出发散发生在哪里（例如，在标量权重中或在因子向量中），并且您必须验证收敛性 $\\mathcal{X}_{\\epsilon} \\to \\mathcal{X}_{0}$。\n- 证明 $\\mathcal{X}_{0}$ 的 CP 秩严格大于 $2$，因此 $\\mathcal{X}_{0}$ 在弗罗贝尼乌斯范数下的最佳秩-2 近似问题无解，尽管下确界误差为 $0$。\n\n最后，计算弗罗贝尼乌斯范数 $\\|\\mathcal{X}_{0}\\|_{F}$。以单一精确表达式的形式提供您的最终答案。不需要四舍五入。", "solution": "我们根据要求分为三个部分来解决此问题。\n\n首先，我们构造一个 CP 秩至多为 2 且收敛于 $\\mathcal{X}_0$ 的单参数张量族 $\\{\\mathcal{X}_{\\epsilon}\\}_{\\epsilon > 0}$。\n让我们为 $\\epsilon > 0$ 定义张量族 $\\{\\mathcal{X}_{\\epsilon}\\}$，作为两个秩-1 张量的和。一个合适的构造灵感来自于导数的有限差分近似。考虑两个秩-1 张量 $T_1(\\epsilon) = (e_1 + \\epsilon e_2) \\otimes (e_1 + \\epsilon e_2) \\otimes (e_1 + \\epsilon e_2)$ 和 $T_2 = e_1 \\otimes e_1 \\otimes e_1$。\n我们将 $\\mathcal{X}_{\\epsilon}$ 定义为：\n$$\n\\mathcal{X}_{\\epsilon} = \\frac{1}{\\epsilon} \\left( T_1(\\epsilon) - T_2 \\right) = \\frac{1}{\\epsilon} \\left( (e_1 + \\epsilon e_2) \\otimes (e_1 + \\epsilon e_2) \\otimes (e_1 + \\epsilon e_2) - e_1 \\otimes e_1 \\otimes e_1 \\right)\n$$\n根据构造，对于任何 $\\epsilon > 0$，$X_{\\epsilon}$ 是两个秩-1 张量的和（系数为 $\\frac{1}{\\epsilon}$ 和 $-\\frac{1}{\\epsilon}$）。因此，$\\mathcal{X}_{\\epsilon}$ 的 CP 秩至多为 2。我们注意到，对于 $\\epsilon > 0$，这两个秩-1 张量是线性无关的，所以秩恰好为 2。\n这可以写成 $\\mathcal{X}_\\epsilon = \\lambda_1 a_1 \\otimes b_1 \\otimes c_1 + \\lambda_2 a_2 \\otimes b_2 \\otimes c_2$ 的形式，其中：\n$\\lambda_1 = \\frac{1}{\\epsilon}$，$a_1 = b_1 = c_1 = e_1 + \\epsilon e_2$\n$\\lambda_2 = -\\frac{1}{\\epsilon}$，$a_2 = b_2 = c_2 = e_1$\n显然，当 $\\epsilon \\to 0$ 时，标量权重 $\\lambda_1$ 和 $\\lambda_2$ 发散。\n\n现在，我们验证当 $\\epsilon \\to 0$ 时，$\\mathcal{X}_{\\epsilon} \\to \\mathcal{X}_{0}$。我们使用分配律展开 $T_1(\\epsilon)$ 中的外积：\n\\begin{align*} T_1(\\epsilon) = e_1\\otimes e_1\\otimes e_1 \\\\ + \\epsilon (e_2\\otimes e_1\\otimes e_1 + e_1\\otimes e_2\\otimes e_1 + e_1\\otimes e_1\\otimes e_2) \\\\ + \\epsilon^2 (e_2\\otimes e_2\\otimes e_1 + e_2\\otimes e_1\\otimes e_2 + e_1\\otimes e_2\\otimes e_2) \\\\ + \\epsilon^3 (e_2\\otimes e_2\\otimes e_2) \\end{align*}\n将此代入 $\\mathcal{X}_{\\epsilon}$ 的表达式中，并回顾 $\\mathcal{X}_0$ 的定义：\n\\begin{align*} \\mathcal{X}_{\\epsilon} = \\frac{1}{\\epsilon} \\left( T_1(\\epsilon) - e_1\\otimes e_1\\otimes e_1 \\right) \\\\ = (e_2\\otimes e_1\\otimes e_1 + e_1\\otimes e_2\\otimes e_1 + e_1\\otimes e_1\\otimes e_2) \\\\ + \\epsilon (e_2\\otimes e_2\\otimes e_1 + e_2\\otimes e_1\\otimes e_2 + e_1\\otimes e_2\\otimes e_2) \\\\ + \\epsilon^2 (e_2\\otimes e_2\\otimes e_2) \\\\ = \\mathcal{X}_0 + \\epsilon (e_2\\otimes e_2\\otimes e_1 + e_2\\otimes e_1\\otimes e_2 + e_1\\otimes e_2\\otimes e_2) + \\epsilon^2 (e_2\\otimes e_2\\otimes e_2)\\end{align*}\n差值为 $E_{\\epsilon} = \\mathcal{X}_{\\epsilon} - \\mathcal{X}_0 = \\epsilon (e_2\\otimes e_2\\otimes e_1 + e_2\\otimes e_1\\otimes e_2 + e_1\\otimes e_2\\otimes e_2) + \\epsilon^2 (e_2\\otimes e_2\\otimes e_2)$。\n基本张量 $e_i \\otimes e_j \\otimes e_k$ 构成了张量空间关于弗罗贝尼乌斯内积的一组标准正交基。因此，弗罗贝尼乌斯范数的平方是这些基张量系数的平方和。\n$$\n\\| E_{\\epsilon} \\|_F^2 = \\epsilon^2 (1^2 + 1^2 + 1^2) + (\\epsilon^2)^2 (1^2) = 3\\epsilon^2 + \\epsilon^4\n$$\n当 $\\epsilon \\to 0$ 时，$\\| E_{\\epsilon} \\|_F^2 \\to 0$，这意味着 $\\|\\mathcal{X}_{\\epsilon} - \\mathcal{X}_0\\|_F \\to 0$。这证实了收敛性。因此我们证明了 $\\mathcal{X}_0$ 的边界秩至多为 2。\n\n其次，我们证明 $\\mathcal{X}_0$ 的 CP 秩严格大于 2。\n我们用反证法。假设 $\\mathcal{X}_0$ 的 CP 秩为 2。那么，存在向量 $u_1, u_2, v_1, v_2, w_1, w_2 \\in \\mathbb{R}^2$ 使得\n$$\n\\mathcal{X}_0 = u_1 \\otimes v_1 \\otimes w_1 + u_2 \\otimes v_2 \\otimes w_2\n$$\n$\\mathcal{X}_0$ 的元素由 $(\\mathcal{X}_0)_{ijk} = (u_1)_i(v_1)_j(w_1)_k + (u_2)_i(v_2)_j(w_2)_k$ 给出。\n一个三阶张量可以看作是矩阵“切片”的集合。设 $M_k = \\mathcal{X}_0(:,:,k)$ 是第 $k$ 个正面切片。\n对于 $k=1$，我们有 $M_1 = \\begin{pmatrix} (\\mathcal{X}_0)_{111}  (\\mathcal{X}_0)_{121} \\\\ (\\mathcal{X}_0)_{211}  (\\mathcal{X}_0)_{221} \\end{pmatrix} = \\begin{pmatrix} 0  1 \\\\ 1  0 \\end{pmatrix}$。\n对于 $k=2$，我们有 $M_2 = \\begin{pmatrix} (\\mathcal{X}_0)_{112}  (\\mathcal{X}_0)_{122} \\\\ (\\mathcal{X}_0)_{212}  (\\mathcal{X}_0)_{222} \\end{pmatrix} = \\begin{pmatrix} 1  0 \\\\ 0  0 \\end{pmatrix}$。\n根据秩-2 分解，切片由下式给出\n$$\nM_k = (w_1)_k (u_1 v_1^T) + (w_2)_k (u_2 v_2^T)\n$$\n设 $A_1 = u_1 v_1^T$ 和 $A_2 = u_2 v_2^T$。$A_1$ 和 $A_2$ 都是秩-1 矩阵（或者是零矩阵，这是一个我们可以排除的平凡情况）。\n这意味着 $M_1$ 和 $M_2$ 都在由 $A_1$ 和 $A_2$ 张成的二维矩阵向量空间中。设这个空间为 $\\mathcal{S} = \\text{span}\\{A_1, A_2\\}$。\n矩阵 $M_1$ 和 $M_2$ 是线性无关的，因为如果 $c_1 M_1 + c_2 M_2 = 0$，则 $\\begin{pmatrix} c_2  c_1 \\\\ c_1  0 \\end{pmatrix} = \\begin{pmatrix} 0  0 \\\\ 0  0 \\end{pmatrix}$，这意味着 $c_1=c_2=0$。因此，$\\{M_1, M_2\\}$ 构成 $\\mathcal{S}$ 的一个基。\n这意味着 $A_1$ 和 $A_2$ 本身也必须在 $\\mathcal{S}$ 中，并且可以表示为 $M_1$ 和 $M_2$ 的线性组合。由于 $A_1$ 和 $A_2$ 是秩-1 矩阵，所以空间 $\\mathcal{S}$ 必须包含秩-1 矩阵。\n让我们找出 $\\mathcal{S}$ 中所有秩至多为 1 的矩阵。$\\mathcal{S}$ 中的一个一般矩阵形式为 $M = c_1 M_1 + c_2 M_2 = \\begin{pmatrix} c_2  c_1 \\\\ c_1  0 \\end{pmatrix}$，其中标量 $c_1, c_2 \\in \\mathbb{R}$。\n$M$ 的秩至多为 1 当且仅当其行列式为零。\n$$\n\\det(M) = (c_2)(0) - (c_1)(c_1) = -c_1^2\n$$\n要使 $\\det(M) = 0$，必须有 $c_1=0$。这意味着 $\\mathcal{S}$ 中秩至多为 1 的矩阵只能是 $c_2 M_2 = \\begin{pmatrix} c_2  0 \\\\ 0  0 \\end{pmatrix}$ 的形式。这是 $\\mathcal{S}$ 的一个一维子空间。\n由于 $A_1$ 和 $A_2$ 必须是 $\\mathcal{S}$ 中的秩-1 矩阵，它们都必须属于这个子空间。因此，$A_1 = k_1 M_2$ 和 $A_2 = k_2 M_2$，其中 $k_1, k_2$ 是某个标量。\n这意味着 $A_1$ 和 $A_2$ 是线性相关的。\n如果 $A_1$ 和 $A_2$ 线性相关，它们张成的空间 $\\mathcal{S}$ 最多是一维的。\n但我们已经确定 $\\mathcal{S}$ 是二维的，因为它是由线性无关的矩阵 $M_1$ 和 $M_2$ 张成的。\n这是一个矛盾。因此，最初关于 $\\mathcal{X}_0$ 的 CP 秩为 2 的假设必定是错误的。因此，$\\text{rank}(\\mathcal{X}_0) > 2$。\n根据其定义，$\\mathcal{X}_0$ 是三个秩-1 张量的和，所以其秩至多为 3。因此，$\\text{rank}(\\mathcal{X}_0) = 3$。\n\n其结果是，$\\mathcal{X}_0$ 的最佳秩-2 近似问题无解。该问题是求解 $\\min_{\\text{rank}(Y) \\le 2} \\|\\mathcal{X}_0 - Y\\|_F$。\n我们已经证明 $\\mathcal{X}_0 = \\lim_{\\epsilon \\to 0} \\mathcal{X}_{\\epsilon}$，其中 $\\text{rank}(\\mathcal{X}_{\\epsilon}) = 2$。这意味着误差的下确界为零：\n$$\n\\inf_{\\text{rank}(Y) \\le 2} \\|\\mathcal{X}_0 - Y\\|_F \\le \\lim_{\\epsilon \\to 0} \\|\\mathcal{X}_0 - \\mathcal{X}_{\\epsilon}\\|_F = 0\n$$\n由于范数是非负的，下确界必须恰好为 0。如果这个最小值可以达到，那么将存在一个秩 $\\text{rank}(Y_0) \\le 2$ 的张量 $Y_0$ 使得 $\\|\\mathcal{X}_0 - Y_0\\|_F = 0$。这意味着 $\\mathcal{X}_0 = Y_0$，因此 $\\text{rank}(\\mathcal{X}_0) \\le 2$。这与我们发现的 $\\text{rank}(\\mathcal{X}_0) = 3$ 相矛盾。因此，该最小值无法达到。\n\n最后，我们计算 $\\mathcal{X}_0$ 的弗罗贝尼乌斯范数。\n张量 $\\mathcal{X}_0$ 有三个非零元素，都等于 1：$(\\mathcal{X}_0)_{2,1,1}=1$，$(\\mathcal{X}_0)_{1,2,1}=1$ 和 $(\\mathcal{X}_0)_{1,1,2}=1$。所有其他 $2^3 - 3 = 5$ 个元素均为零。\n根据定义，弗罗贝尼乌斯范数的平方是所有元素的平方和。\n$$\n\\|\\mathcal{X}_0\\|_F^2 = \\sum_{i=1}^2 \\sum_{j=1}^2 \\sum_{k=1}^2 (\\mathcal{X}_0)_{ijk}^2 = (\\mathcal{X}_{2,1,1})^2 + (\\mathcal{X}_{1,2,1})^2 + (\\mathcal{X}_{1,1,2})^2 = 1^2 + 1^2 + 1^2 = 1+1+1 = 3\n$$\n弗罗贝尼乌斯范数是该值的平方根。\n$$\n\\|\\mathcal{X}_0\\|_F = \\sqrt{3}\n$$\n这是所要求的最终数值。", "answer": "$$\\boxed{\\sqrt{3}}$$", "id": "3586501"}]}