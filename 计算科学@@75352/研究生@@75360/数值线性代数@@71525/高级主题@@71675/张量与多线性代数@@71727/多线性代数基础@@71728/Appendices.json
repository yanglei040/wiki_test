{"hands_on_practices": [{"introduction": "任何张量操作的第一步都是理解运算如何影响其维度。这个练习 [@problem_id:3561343] 旨在实践张量-矩阵（TTM）乘积和张量展开的基本法则。准确预测结果张量和矩阵的形状，是设计和调试更复杂算法的关键前提。", "problem": "设 $X \\in \\mathbb{R}^{3 \\times 4 \\times 2}$ 是一个三阶张量，设 $U \\in \\mathbb{R}^{5 \\times 3}$ 是一个矩阵。定义模1的张量-矩阵乘积（TTM）为 $Y = X \\times_{1} U$，其中乘法沿着 $X$ 的第一个模式进行，通过将每个模1纤维与 $U$ 左乘来实现。采用 Kolda–Bader 约定进行模n展开（其中列是模n纤维），并用 $Y_{(3)}$ 表示 $Y$ 的模3展开。仅使用张量、纤维、切片、模n乘积和模n展开的基本定义，确定 $Y$ 的维度和 $Y_{(3)}$ 的维度。将您的最终答案表示为一个单行矩阵，按顺序列出 $Y$ 的三个维度，后跟 $Y_{(3)}$ 的两个维度。无需四舍五入。", "solution": "该问题要求我们确定由张量-矩阵乘积（TTM）产生的张量 $Y$ 的维度，然后找出 $Y$ 的模3展开的维度。\n\n设张量 $X$ 的维度为 $I_1 \\times I_2 \\times I_3$。根据问题陈述，我们有 $X \\in \\mathbb{R}^{3 \\times 4 \\times 2}$，所以 $I_1 = 3$， $I_2 = 4$， $I_3 = 2$。\n设矩阵 $U$ 的维度为 $J \\times K$。根据问题陈述，我们有 $U \\in \\mathbb{R}^{5 \\times 3}$，所以 $J = 5$，$K = 3$。\n\n**第1部分：确定 $Y$ 的维度**\n\n张量 $Y$ 由与矩阵 $U$ 的模1 TTM乘积定义：\n$$Y = X \\times_{1} U$$\n一个张量 $\\mathcal{X} \\in \\mathbb{R}^{I_1 \\times \\dots \\times I_n \\times \\dots \\times I_N}$ 与一个矩阵 $U \\in \\mathbb{R}^{J \\times I_n}$ 的模n乘积产生一个张量 $\\mathcal{Y} \\in \\mathbb{R}^{I_1 \\times \\dots \\times I_{n-1} \\times J \\times I_{n+1} \\times \\dots \\times I_N}$。该操作将第n个模式的维度 $I_n$ 替换为矩阵 $U$ 的行数 $J$。\n\n在我们的例子中，$n=1$。张量 $X$ 的维度是 $I_1 \\times I_2 \\times I_3$，矩阵 $U$ 的维度是 $J \\times I_1$。要使乘积有明确定义，条件是 $U$ 的列数必须等于 $X$ 的第一个模式的大小。这里，$U$ 的列数是 $K=3$，而 $X$ 的第一个模式的大小是 $I_1=3$。由于 $K=I_1$，该操作是明确定义的。\n\n得到的张量 $Y$ 的维度将是 $J \\times I_2 \\times I_3$。\n代入给定值：\n- $Y$ 的第一个维度是 $J = 5$。\n- $Y$ 的第二个维度是 $I_2 = 4$。\n- $Y$ 的第三个维度是 $I_3 = 2$。\n\n因此，张量 $Y$ 属于 $\\mathbb{R}^{5 \\times 4 \\times 2}$，其维度是 $(5, 4, 2)$。\n\n**第2部分：确定 $Y_{(3)}$ 的维度**\n\n符号 $Y_{(3)}$ 表示张量 $Y$ 的模3展开。张量 $Y \\in \\mathbb{R}^{5 \\times 4 \\times 2}$ 的维度我们可以表示为 $J_1 \\times J_2 \\times J_3$，其中 $J_1 = 5$，$J_2 = 4$，$J_3 = 2$。\n\n张量 $\\mathcal{Y} \\in \\mathbb{R}^{J_1 \\times J_2 \\times \\dots \\times J_N}$ 的模n展开是一个矩阵，记作 $\\mathcal{Y}_{(n)}$，它重塑了张量的元素。根据 Kolda–Bader 约定，矩阵 $\\mathcal{Y}_{(n)}$ 的列是张量 $\\mathcal{Y}$ 的模n纤维。\n\n模n纤维是通过固定除第n个索引外的所有索引而获得的向量。对于一个三阶张量 $Y \\in \\mathbb{R}^{J_1 \\times J_2 \\times J_3}$，一个模3纤维是一个长度为 $J_3$ 的列向量，通过固定前两个索引获得，即对于某个固定的 $j_1$ 和 $j_2$ 的 $Y_{j_1, j_2, :}$。\n\n模3展开 $Y_{(3)}$ 将这些模3纤维排列为其列。\n- $Y_{(3)}$ 的行数是每个模3纤维的长度，也就是 $Y$ 的第3个模式的大小。这个值是 $J_3 = 2$。\n- $Y_{(3)}$ 的列数是模3纤维的总数。这由其他索引的可能组合数量决定，也就是其他模式大小的乘积。在这种情况下，它是 $J_1 \\times J_2$。\n\n所以，矩阵 $Y_{(3)}$ 的维度是 $J_3 \\times (J_1 \\times J_2)$。\n代入 $Y$ 的维度：\n- 行数是 $J_3 = 2$。\n- 列数是 $J_1 \\times J_2 = 5 \\times 4 = 20$。\n\n因此，矩阵 $Y_{(3)}$ 属于 $\\mathbb{R}^{2 \\times 20}$，其维度是 $(2, 20)$。\n\n**结论**\n\n张量 $Y$ 的三个维度是 $5, 4, 2$。\n矩阵 $Y_{(3)}$ 的两个维度是 $2, 20$。\n问题要求最终答案以单行矩阵的形式，按顺序列出这五个数字。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n5  4  2  2  20\n\\end{pmatrix}\n}\n$$", "id": "3561343"}, {"introduction": "张量展开不仅仅是改变其形状，更是对其元素的一次特定且有序的重排。这个练习 [@problem_id:3561312] 要求你通过将一个特定的多维张量坐标映射到其在展开矩阵中的对应列，来追踪这一重排过程。掌握这种索引映射是实现张量算法或正确解释其输出的基础。", "problem": "考虑一个三阶张量 $X \\in \\mathbb{R}^{2 \\times 3 \\times 4}$，其索引集为 $i_1 \\in \\{1,2\\}$、$i_2 \\in \\{1,2,3\\}$ 和 $i_3 \\in \\{1,2,3,4\\}$。张量的模-$n$ 展开 (mode-$n$ unfolding) 是一个矩阵，其各列是根据剩余索引按字典序排列的模-$n$ 纤维。假设全文使用基于 1 的索引，并且模-2 展开 $X_{(2)}$ 的列是按照索引对 $(i_1, i_3)$ 的标准字典序（即 $i_1$ 变化最慢）排列的。确定模-2 展开 $X_{(2)}$ 的形状（行数和列数），以及 $X_{(2)}$ 中与索引对 $(i_1,i_3)=(2,3)$ 对应的列的索引。将您的最终答案表示为一个单行矩阵，按顺序列出 $X_{(2)}$ 的两个维度，后跟所求的列索引。无需四舍五入。", "solution": "该问题围绕张量展开的概念，这是多重线性代数中的一个基本操作。我们给定一个三阶张量 $X \\in \\mathbb{R}^{2 \\times 3 \\times 4}$。该张量沿每个模的维度分别为 $I_1=2$、$I_2=3$ 和 $I_3=4$。每个模的索引为 $i_1 \\in \\{1,2\\}$、$i_2 \\in \\{1,2,3\\}$ 和 $i_3 \\in \\{1,2,3,4\\}$。我们需要确定模-2 展开（表示为 $X_{(2)}$）的形状，并在此展开中找到一个特定的列索引。\n\n首先，我们确定模-2 展开 $X_{(2)}$ 的形状。根据 $N$ 阶张量 $X \\in \\mathbb{R}^{I_1 \\times I_2 \\times \\dots \\times I_N}$ 的模-$n$ 展开的定义，得到的矩阵 $X_{(n)}$ 的维度为 $I_n \\times (I_{n+1} \\times \\dots \\times I_N \\times I_1 \\times \\dots \\times I_{n-1})$。更一般地，$X_{(n)}$ 的行数是第 $n$ 模的维度 $I_n$。列数是所有其他模的维度的乘积，即 $\\prod_{k \\neq n} I_k$。\n\n在我们的例子中，张量 $X$ 是 3 阶的，我们关心的是模-2 展开，所以 $n=2$。\n$X_{(2)}$ 的行数等于第二模的维度，即 $I_2=3$。\n$X_{(2)}$ 的列数是其他模（即模 1 和模 3）的维度的乘积。因此，列数为 $I_1 \\times I_3 = 2 \\times 4 = 8$。\n所以，矩阵 $X_{(2)}$ 的形状是 $3 \\times 8$。\n\n接下来，我们必须确定 $X_{(2)}$ 中与索引对 $(i_1, i_3)=(2,3)$ 对应的列索引。模-2 展开 $X_{(2)}$ 的列是张量 $X$ 的模-2 纤维。一个模-2 纤维是通过固定索引 $i_1$ 和 $i_3$ 并让索引 $i_2$ 变化得到的。每个纤维是一个长度为 $I_2=3$ 的向量，具体为 $X(i_1, :, i_3)$。共有 $I_1 \\times I_3 = 8$ 个这样的纤维。\n\n问题指出，这些纤维作为 $X_{(2)}$ 的列，是根据索引对 $(i_1, i_3)$ 的标准字典序排列的，其中 $i_1 \\in \\{1,2\\}$ 且 $i_3 \\in \\{1,2,3,4\\}$。标准字典序意味着第一个索引 ($i_1$) 变化最慢，第二个索引 ($i_3$) 变化最快。\n\n我们列出所有索引对 $(i_1, i_3)$ 的字典序：\n1. (1, 1)\n2. (1, 2)\n3. (1, 3)\n4. (1, 4)\n5. (2, 1)\n6. (2, 2)\n7. (2, 3)\n8. (2, 4)\n\n我们寻找的纤维对应于索引对 $(i_1, i_3)=(2,3)$。根据上面的列表，这对应于第 7 列。\n\n因此，模-2 展开 $X_{(2)}$ 的形状是 $3 \\times 8$，而与索引对 $(i_1, i_3)=(2,3)$ 相关的纤维是该矩阵的第 7 列。问题要求以单行矩阵的形式提供 $X_{(2)}$ 的两个维度和列索引。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n3  8  7\n\\end{pmatrix}\n}\n$$", "id": "3561312"}, {"introduction": "一个张量是否完全由其所有切片的集合所定义？这个发人深省的练习 [@problem_id:3561306] 表明答案是否定的。通过分析两个拥有相同切片集合但顺序不同的张量，你将看到模-1展开过程如何产生截然不同的矩阵，并揭示一个原本隐藏的排列。这突出了张量的顺序结构和其构成部分同等重要。", "problem": "设 $X \\in \\mathbb{R}^{I \\times J \\times K}$ 是一个三阶张量。一个 mode-$n$ 纤维是通过固定除第 $n$ 个索引外的所有索引得到的；例如，$X$ 的一个 mode-1 纤维是在固定 $j$ 和 $k$ 的情况下得到的 $X(:,j,k) \\in \\mathbb{R}^{I}$。一个 mode-3 切片（也称为额面切片）是通过固定第三个索引 $k$ 得到的矩阵 $X(:,:,k) \\in \\mathbb{R}^{I \\times J}$。mode-1 展开（也称为矩阵化）$X_{(1)} \\in \\mathbb{R}^{I \\times JK}$ 的定义是：将所有 mode-1 纤维 $X(:,j,k)$ 作为 $X_{(1)}$ 的列，按照索引对 $(j,k)$ 的字典序排列，其中 $j$ 变化最快：也就是说，列的顺序是 $(j,k) = (1,1),(2,1),\\dots,(J,1),(1,2),(2,2),\\dots,(J,K)$。\n\n考虑张量 $X \\in \\mathbb{R}^{2 \\times 3 \\times 2}$，其额面切片为\n$$\nX(:,:,1) \\;=\\; \\begin{pmatrix} 1  4  7 \\\\ 2  5  8 \\end{pmatrix}, \n\\qquad\nX(:,:,2) \\;=\\; \\begin{pmatrix} 3  6  9 \\\\ 0  1  2 \\end{pmatrix}.\n$$\n通过重排 $X$ 的 mode-3 切片来定义 $Y \\in \\mathbb{R}^{2 \\times 3 \\times 2}$：\n$$\nY(:,:,1) \\;=\\; X(:,:,2), \\qquad Y(:,:,2) \\;=\\; X(:,:,1).\n$$\n因此，$X$ 和 $Y$ 拥有相同的 mode-3 切片集合，但它们沿着第三个索引的顺序不同。\n\n1. 使用上面指定的字典序纤维排序规则，明确写出 mode-1 展开 $X_{(1)}$ 和 $Y_{(1)}$。\n2. 证明存在唯一的列置换矩阵 $\\Pi \\in \\mathbb{R}^{JK \\times JK}$ 使得 $Y_{(1)} = X_{(1)} \\Pi$，并明确指出 $\\Pi$。\n3. 计算 $\\det(\\Pi)$。\n\n在你的推导过程中，解释 mode-1 展开中的纤维排序如何编码了一个隐式置换，而这个置换在仅比较 mode-3 切片集合时是无法直接看出的。将你的最终答案表示为一个无单位的实数。无需四舍五入。", "solution": "该问题要求我们分析对一个三阶张量的切片进行置换对其 mode-1 展开的影响。给定一个张量 $X \\in \\mathbb{R}^{I \\times J \\times K}$，其维度为 $I=2$，$J=3$，和 $K=2$。其 mode-3 切片（额面切片）指定如下：\n$$\nX(:,:,1) = \\begin{pmatrix} 1  4  7 \\\\ 2  5  8 \\end{pmatrix}, \\qquad X(:,:,2) = \\begin{pmatrix} 3  6  9 \\\\ 0  1  2 \\end{pmatrix}.\n$$\n通过重排 $X$ 的 mode-3 切片来定义第二个张量 $Y \\in \\mathbb{R}^{2 \\times 3 \\times 2}$：\n$$\nY(:,:,1) = X(:,:,2) = \\begin{pmatrix} 3  6  9 \\\\ 0  1  2 \\end{pmatrix}, \\qquad Y(:,:,2) = X(:,:,1) = \\begin{pmatrix} 1  4  7 \\\\ 2  5  8 \\end{pmatrix}.\n$$\n这意味着这两个张量的元素通过 $Y_{ijk} = X_{ij\\tau(k)}$ 相关联，其中 $\\tau$ 是对第三个索引 $\\{1, 2\\}$ 的一个置换，定义为 $\\tau(1)=2$ 和 $\\tau(2)=1$。虽然 mode-3 切片的*集合* $\\{X(:,:,1), X(:,:,2)\\}$ 与集合 $\\{Y(:,:,1), Y(:,:,2)\\}$ 相同，但张量 $X$ 和 $Y$ 是不同的，因为这些切片以不同的顺序出现。\n\n我们的第一个任务是计算 mode-1 展开 $X_{(1)}$ 和 $Y_{(1)}$。mode-1 展开 $X_{(1)}$ 是一个大小为 $I \\times (JK)$ 的矩阵，即 $2 \\times (3 \\times 2) = 2 \\times 6$。它的列是 mode-1 纤维 $X(:,j,k)$，根据索引对 $(j,k)$ 的字典序排列，其中第一个索引 $j$ 变化最快。列的顺序由索引对 $(1,1), (2,1), (3,1), (1,2), (2,2), (3,2)$ 决定。\n\n我们来提取 $X$ 的 mode-1 纤维：\n前 $J=3$ 个纤维来自切片 $k=1$：\n- 对于 $(j,k)=(1,1)$ 的纤维：$X(:,1,1) = \\begin{pmatrix} 1 \\\\ 2 \\end{pmatrix}$\n- 对于 $(j,k)=(2,1)$ 的纤维：$X(:,2,1) = \\begin{pmatrix} 4 \\\\ 5 \\end{pmatrix}$\n- 对于 $(j,k)=(3,1)$ 的纤维：$X(:,3,1) = \\begin{pmatrix} 7 \\\\ 8 \\end{pmatrix}$\n接下来的 $J=3$ 个纤维来自切片 $k=2$：\n- 对于 $(j,k)=(1,2)$ 的纤维：$X(:,1,2) = \\begin{pmatrix} 3 \\\\ 0 \\end{pmatrix}$\n- 对于 $(j,k)=(2,2)$ 的纤维：$X(:,2,2) = \\begin{pmatrix} 6 \\\\ 1 \\end{pmatrix}$\n- 对于 $(j,k)=(3,2)$ 的纤维：$X(:,3,2) = \\begin{pmatrix} 9 \\\\ 2 \\end{pmatrix}$\n\n按照指定的顺序组合这些列向量，得到 $X$ 的 mode-1 展开：\n$$\nX_{(1)} = \\begin{pmatrix} 1  4  7  3  6  9 \\\\ 2  5  8  0  1  2 \\end{pmatrix}\n$$\n\n接下来，我们用相同的过程构造 $Y_{(1)}$。$Y$ 的 mode-1 纤维是 $Y(:,j,k)$。根据 $Y$ 的定义，我们有 $Y(:,j,1) = X(:,j,2)$ 和 $Y(:,j,2) = X(:,j,1)$。\n$Y_{(1)}$ 的前 $J=3$ 个纤维来自其切片 $k=1$：\n- 对于 $(j,k)=(1,1)$ 的纤维：$Y(:,1,1) = X(:,1,2) = \\begin{pmatrix} 3 \\\\ 0 \\end{pmatrix}$\n- 对于 $(j,k)=(2,1)$ 的纤维：$Y(:,2,1) = X(:,2,2) = \\begin{pmatrix} 6 \\\\ 1 \\end{pmatrix}$\n- 对于 $(j,k)=(3,1)$ 的纤维：$Y(:,3,1) = X(:,3,2) = \\begin{pmatrix} 9 \\\\ 2 \\end{pmatrix}$\n$Y_{(1)}$ 的后 $J=3$ 个纤维来自其切片 $k=2$：\n- 对于 $(j,k)=(1,2)$ 的纤维：$Y(:,1,2) = X(:,1,1) = \\begin{pmatrix} 1 \\\\ 2 \\end{pmatrix}$\n- 对于 $(j,k)=(2,2)$ 的纤维：$Y(:,2,2) = X(:,2,1) = \\begin{pmatrix} 4 \\\\ 5 \\end{pmatrix}$\n- 对于 $(j,k)=(3,2)$ 的纤维：$Y(:,3,2) = X(:,3,1) = \\begin{pmatrix} 7 \\\\ 8 \\end{pmatrix}$\n\n组合这些纤维得到 $Y$ 的 mode-1 展开：\n$$\nY_{(1)} = \\begin{pmatrix} 3  6  9  1  4  7 \\\\ 0  1  2  2  5  8 \\end{pmatrix}\n$$\n\n第二个任务是找到一个唯一的列置换矩阵 $\\Pi \\in \\mathbb{R}^{JK \\times JK} = \\mathbb{R}^{6 \\times 6}$，使得 $Y_{(1)} = X_{(1)} \\Pi$。\n通过比较 $Y_{(1)}$ 的列和 $X_{(1)}$ 的列，我们可以确定这个置换。设 $x_p$ 和 $y_q$ 分别是 $X_{(1)}$ 和 $Y_{(1)}$ 的第 $p$ 列和第 $q$ 列。\n- $y_1 = \\begin{pmatrix} 3 \\\\ 0 \\end{pmatrix} = x_4$\n- $y_2 = \\begin{pmatrix} 6 \\\\ 1 \\end{pmatrix} = x_5$\n- $y_3 = \\begin{pmatrix} 9 \\\\ 2 \\end{pmatrix} = x_6$\n- $y_4 = \\begin{pmatrix} 1 \\\\ 2 \\end{pmatrix} = x_1$\n- $y_5 = \\begin{pmatrix} 4 \\\\ 5 \\end{pmatrix} = x_2$\n- $y_6 = \\begin{pmatrix} 7 \\\\ 8 \\end{pmatrix} = x_3$\n\n这表明 $Y_{(1)}$ 的列是 $X_{(1)}$ 的列的一个置换。$X_{(1)}$ 的前 $J=3$ 列组成的块（对应于切片 $X(:,:,1)$）移动到了 $Y_{(1)}$ 中成为第二个列块，而 $X_{(1)}$ 的第二个 $J=3$ 列组成的块（来自切片 $X(:,:,2)$）成为了 $Y_{(1)}$ 中的第一个列块。这种列的混洗就是“隐式置换”，它在只考虑切片集合时并不明显。展开过程中的严格纤维排序规则使得该操作对未展开的模上的切片顺序敏感。\n\n列索引的置换 $\\sigma: \\{1, ..., 6\\} \\to \\{1, ..., 6\\}$ 由从新位置到旧位置的映射给出：$y_q = x_{\\sigma(q)}$。\n$\\sigma(1) = 4, \\sigma(2) = 5, \\sigma(3) = 6, \\sigma(4) = 1, \\sigma(5) = 2, \\sigma(6) = 3$。\n置换矩阵 $\\Pi$ 的构造方式是，用 $\\Pi$ 右乘一个矩阵会根据 $\\sigma$ 置换该矩阵的列。这意味着 $\\Pi$ 的第 $q$ 列是标准基向量 $e_{\\sigma(q)}$。\n$$\n\\Pi = \\begin{pmatrix} e_{\\sigma(1)}  e_{\\sigma(2)}  e_{\\sigma(3)}  e_{\\sigma(4)}  e_{\\sigma(5)}  e_{\\sigma(6)} \\end{pmatrix} = \\begin{pmatrix} e_4  e_5  e_6  e_1  e_2  e_3 \\end{pmatrix}\n$$\n具体来说，这给出了 $6 \\times 6$ 矩阵：\n$$\n\\Pi = \\begin{pmatrix}\n0  0  0  1  0  0 \\\\\n0  0  0  0  1  0 \\\\\n0  0  0  0  0  1 \\\\\n1  0  0  0  0  0 \\\\\n0  1  0  0  0  0 \\\\\n0  0  1  0  0  0\n\\end{pmatrix}\n$$\n该矩阵具有块结构 $\\Pi = \\begin{pmatrix} 0_{3 \\times 3}  I_{3 \\times 3} \\\\ I_{3 \\times 3}  0_{3 \\times 3} \\end{pmatrix}$，其中 $I_{3 \\times 3}$ 是 $3 \\times 3$ 单位矩阵，$0_{3 \\times 3}$ 是 $3 \\times 3$ 零矩阵。这种结构直接反映了两个由 $J=3$ 列组成的块的交换。由于 $X_{(1)}$ 的所有列都不同，这个置换矩阵是唯一的。\n\n第三个任务是计算 $\\Pi$ 的行列式。一个置换矩阵的行列式等于相应置换的符号，即 $\\text{sgn}(\\sigma)$。置换 $\\sigma$ 可以分解为不相交的循环：$\\sigma = (1 \\ 4)(2 \\ 5)(3 \\ 6)$。这是一个 3 个对换（交换）的乘积。置换的符号是 $(-1)^k$，其中 $k$ 是对换的数量。\n因此，$\\text{sgn}(\\sigma) = (-1)^3 = -1$。\n因此，置换矩阵的行列式为：\n$$\n\\det(\\Pi) = -1\n$$\n或者，对于形式为 $M = \\begin{pmatrix} 0  B \\\\ C  0 \\end{pmatrix}$ 的分块矩阵，其中 $B$ 和 $C$ 分别是大小为 $n \\times n$ 和 $m \\times m$ 的方阵，其行列式为 $\\det(M) = (-1)^{nm} \\det(B) \\det(C)$。在我们的例子中，$B=I_{3 \\times 3}$ 且 $C=I_{3 \\times 3}$，所以 $n=m=3$。\n$$\n\\det(\\Pi) = (-1)^{3 \\times 3} \\det(I_{3 \\times 3}) \\det(I_{3 \\times 3}) = (-1)^9 \\cdot 1 \\cdot 1 = -1\n$$\n两种方法都得到相同的结果。最终答案是行列式的值。", "answer": "$$\\boxed{-1}$$", "id": "3561306"}]}