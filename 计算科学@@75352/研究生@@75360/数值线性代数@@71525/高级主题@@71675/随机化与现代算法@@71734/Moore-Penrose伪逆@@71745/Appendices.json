{"hands_on_practices": [{"introduction": "掌握穆尔-彭罗斯伪逆 ($A^+$) 的最直接方法是通过奇异值分解 (SVD)。这个练习提供了一个具体的数值例子，让你亲手实践这一基本计算，从而加深对核心关系式 $A^+ = V \\Sigma^+ U^T$ 的理解。通过这个计算，你将明确如何从矩阵 $\\Sigma$ 构建 $\\Sigma^+$，并完成整个伪逆矩阵的求解。", "problem": "设 $A \\in \\mathbb{R}^{3 \\times 2}$ 的奇异值分解 (SVD) 为 $A = U \\Sigma V^{\\top}$，其中\n$$\nU \\;=\\;\n\\begin{bmatrix}\n\\frac{1}{\\sqrt{2}}  \\frac{1}{\\sqrt{2}}  0 \\\\\n0  0  1 \\\\\n-\\frac{1}{\\sqrt{2}}  \\frac{1}{\\sqrt{2}}  0\n\\end{bmatrix},\n\\qquad\n\\Sigma \\;=\\;\n\\begin{bmatrix}\n6  0 \\\\\n0  2 \\\\\n0  0\n\\end{bmatrix},\n\\qquad\nV \\;=\\;\n\\begin{bmatrix}\n\\frac{3}{5}  \\frac{4}{5} \\\\\n-\\frac{4}{5}  \\frac{3}{5}\n\\end{bmatrix}.\n$$\n仅使用穆尔-彭罗斯伪逆的定义性质和奇异值分解 (SVD) 的定义，从所提供的因子中显式地推导出穆尔-彭罗斯伪逆 $A^{+}$。然后，以单个闭式表达式的形式给出 $A^{+}$ 的 $(2,3)$ 项的精确值。不要使用任何非由这些定义直接导出的结果。无需四舍五入。", "solution": "这个问题是有效的，因为它是自洽的，在数值线性代数中有科学依据，并且是数学上适定的。存在唯一解，并且可以从所提供的信息中推导出来。\n\n任务是根据矩阵 $A$ 的奇异值分解 (SVD) $A = U \\Sigma V^{\\top}$，求出其穆尔-彭罗斯伪逆 $A^{+}$ 的 $(2,3)$ 项。推导过程必须严格遵守伪逆的定义性质。\n\n矩阵 $A$ 的穆尔-彭罗斯伪逆，记为 $A^{+}$，是满足以下四个 Penrose 条件的唯一矩阵：\n1.  $A A^{+} A = A$\n2.  $A^{+} A A^{+} = A^{+}$\n3.  $(A A^{+})^{\\top} = A A^{+}$\n4.  $(A^{+} A)^{\\top} = A^{+} A$\n\n我们已知 $A \\in \\mathbb{R}^{3 \\times 2}$ 的 SVD 各个组成部分：\n$$\nU \\;=\\;\n\\begin{bmatrix}\n\\frac{1}{\\sqrt{2}}  \\frac{1}{\\sqrt{2}}  0 \\\\\n0  0  1 \\\\\n-\\frac{1}{\\sqrt{2}}  \\frac{1}{\\sqrt{2}}  0\n\\end{bmatrix},\n\\qquad\n\\Sigma \\;=\\;\n\\begin{bmatrix}\n6  0 \\\\\n0  2 \\\\\n0  0\n\\end{bmatrix},\n\\qquad\nV \\;=\\;\n\\begin{bmatrix}\n\\frac{3}{5}  \\frac{4}{5} \\\\\n-\\frac{4}{5}  \\frac{3}{5}\n\\end{bmatrix}.\n$$\n其中，$U \\in \\mathbb{R}^{3 \\times 3}$ 和 $V \\in \\mathbb{R}^{2 \\times 2}$ 是正交矩阵（$U^{\\top}U=I$ 且 $V^{\\top}V=I$），而 $\\Sigma$ 是一个矩形对角矩阵。\n\n我们提出伪逆的候选形式为 $A^{+} = V \\Sigma^{+} U^{\\top}$。矩阵 $\\Sigma^{+} \\in \\mathbb{R}^{2 \\times 3}$ 是 $\\Sigma$ 的伪逆。它的构造方法是：取每个非零奇异值的倒数，然后将所得矩阵转置。$\\Sigma$ 中的非零奇异值为 $\\sigma_1 = 6$ 和 $\\sigma_2 = 2$。\n$$\n\\Sigma^{+} \\;=\\;\n\\begin{bmatrix}\n\\frac{1}{6}  0  0 \\\\\n0  \\frac{1}{2}  0\n\\end{bmatrix}.\n$$\n为了严格证明使用 $A^{+} = V \\Sigma^{+} U^{\\top}$ 的合理性，我们必须证明它满足四个 Penrose 条件。\n\n1.  $A A^{+} A = (U \\Sigma V^{\\top})(V \\Sigma^{+} U^{\\top})(U \\Sigma V^{\\top}) = U \\Sigma (V^{\\top}V) \\Sigma^{+} (U^{\\top}U) \\Sigma V^{\\top} = U (\\Sigma \\Sigma^{+} \\Sigma) V^{\\top}$。\n    乘积 $\\Sigma\\Sigma^{+}\\Sigma$ 为：\n    $$\n    \\Sigma \\Sigma^{+} \\Sigma = \\left( \\begin{bmatrix} 6  0 \\\\ 0  2 \\\\ 0  0 \\end{bmatrix} \\begin{bmatrix} \\frac{1}{6}  0  0 \\\\ 0  \\frac{1}{2}  0 \\end{bmatrix} \\right) \\Sigma = \\begin{bmatrix} 1  0  0 \\\\ 0  1  0 \\\\ 0  0  0 \\end{bmatrix} \\begin{bmatrix} 6  0 \\\\ 0  2 \\\\ 0  0 \\end{bmatrix} = \\begin{bmatrix} 6  0 \\\\ 0  2 \\\\ 0  0 \\end{bmatrix} = \\Sigma.\n    $$\n    因此，$A A^{+} A = U \\Sigma V^{\\top} = A$。第一个条件满足。\n\n2.  $A^{+} A A^{+} = (V \\Sigma^{+} U^{\\top})(U \\Sigma V^{\\top})(V \\Sigma^{+} U^{\\top}) = V \\Sigma^{+} (U^{\\top}U) \\Sigma (V^{\\top}V) \\Sigma^{+} U^{\\top} = V (\\Sigma^{+} \\Sigma \\Sigma^{+}) U^{\\top}$。\n    乘积 $\\Sigma^{+}\\Sigma\\Sigma^{+}$ 为：\n    $$\n    \\Sigma^{+} \\Sigma \\Sigma^{+} = \\left( \\begin{bmatrix} \\frac{1}{6}  0  0 \\\\ 0  \\frac{1}{2}  0 \\end{bmatrix} \\begin{bmatrix} 6  0 \\\\ 0  2 \\\\ 0  0 \\end{bmatrix} \\right) \\Sigma^{+} = \\begin{bmatrix} 1  0 \\\\ 0  1 \\end{bmatrix} \\begin{bmatrix} \\frac{1}{6}  0  0 \\\\ 0  \\frac{1}{2}  0 \\end{bmatrix} = \\Sigma^{+}.\n    $$\n    因此，$A^{+} A A^{+} = V \\Sigma^{+} U^{\\top} = A^{+}$。第二个条件满足。\n\n3.  $(A A^{+})^{\\top} = A A^{+}$。乘积为 $A A^{+} = U \\Sigma V^{\\top}V \\Sigma^{+} U^{\\top} = U (\\Sigma \\Sigma^{+}) U^{\\top}$。矩阵 $\\Sigma \\Sigma^{+} = \\begin{bmatrix} 1  0  0 \\\\ 0  1  0 \\\\ 0  0  0 \\end{bmatrix}$ 是对角矩阵，因而是对称的，$(\\Sigma \\Sigma^{+})^{\\top} = \\Sigma \\Sigma^{+}$。所以，$(A A^{+})^{\\top} = (U (\\Sigma \\Sigma^{+}) U^{\\top})^{\\top} = U (\\Sigma \\Sigma^{+})^{\\top} U^{\\top} = U (\\Sigma \\Sigma^{+}) U^{\\top} = A A^{+}$。第三个条件满足。\n\n4.  $(A^{+} A)^{\\top} = A^{+} A$。乘积为 $A^{+} A = V \\Sigma^{+} U^{\\top}U \\Sigma V^{\\top} = V (\\Sigma^{+} \\Sigma) V^{\\top}$。矩阵 $\\Sigma^{+} \\Sigma = \\begin{bmatrix} 1  0 \\\\ 0  1 \\end{bmatrix}$ 是单位矩阵，它是对称的。所以，$(A^{+} A)^{\\top} = (V (\\Sigma^{+} \\Sigma) V^{\\top})^{\\top} = V (\\Sigma^{+} \\Sigma)^{\\top} V^{\\top} = V (\\Sigma^{+} \\Sigma) V^{\\top} = A^{+} A$。第四个条件满足。\n\n推导证实了 $A^{+} = V \\Sigma^{+} U^{\\top}$ 确实是穆尔-彭罗斯伪逆。我们现在计算其 $(2,3)$ 项，记为 $A^{+}_{23}$。\n$A^{+} = V \\Sigma^{+} U^{\\top}$。项 $A^{+}_{23}$ 是乘积 $V\\Sigma^{+}$ 的第二行与 $U^{\\top}$ 的第三列的点积。\n\n首先，我们求 $V\\Sigma^{+}$ 的第二行：\n$$\n\\left( V\\Sigma^{+} \\right)_{2,:} = \\begin{pmatrix} -\\frac{4}{5} & \\frac{3}{5} \\end{pmatrix} \\begin{pmatrix} \\frac{1}{6} & 0 & 0 \\\\ 0 & \\frac{1}{2} & 0 \\end{pmatrix} = \\begin{pmatrix} \\left(-\\frac{4}{5}\\right)\\left(\\frac{1}{6}\\right) & \\left(-\\frac{4}{5}\\right)(0) + \\left(\\frac{3}{5}\\right)\\left(\\frac{1}{2}\\right) & 0 \\end{pmatrix}\n$$\n$$\n= \\begin{pmatrix} -\\frac{4}{30} & \\frac{3}{10} & 0 \\end{pmatrix} = \\begin{pmatrix} -\\frac{2}{15} & \\frac{3}{10} & 0 \\end{pmatrix}.\n$$\n接下来，我们确定 $U^{\\top}$ 的第三列。将 $U$ 转置得到：\n$$\nU^{\\top} \\;=\\;\n\\begin{bmatrix}\n\\frac{1}{\\sqrt{2}} & 0 & -\\frac{1}{\\sqrt{2}} \\\\\n\\frac{1}{\\sqrt{2}} & 0 & \\frac{1}{\\sqrt{2}} \\\\\n0 & 1 & 0\n\\end{bmatrix}.\n$$\n$U^{\\top}$ 的第三列是 $\\begin{pmatrix} -\\frac{1}{\\sqrt{2}} & \\frac{1}{\\sqrt{2}} & 0 \\end{pmatrix}^{\\top}$。\n\n最后，我们计算点积以求得 $A^{+}_{23}$：\n$$\nA^{+}_{23} = \\left(-\\frac{2}{15}\\right) \\left(-\\frac{1}{\\sqrt{2}}\\right) + \\left(\\frac{3}{10}\\right) \\left(\\frac{1}{\\sqrt{2}}\\right) + (0)(0)\n$$\n$$\nA^{+}_{23} = \\frac{2}{15\\sqrt{2}} + \\frac{3}{10\\sqrt{2}}.\n$$\n为了合并这些项，我们使用公分母 $30\\sqrt{2}$：\n$$\nA^{+}_{23} = \\frac{4}{30\\sqrt{2}} + \\frac{9}{30\\sqrt{2}} = \\frac{13}{30\\sqrt{2}}.\n$$\n将分母有理化，得到最终的闭式表达式：\n$$\nA^{+}_{23} = \\frac{13\\sqrt{2}}{30 \\times 2} = \\frac{13\\sqrt{2}}{60}.\n$$", "answer": "$$\\boxed{\\frac{13\\sqrt{2}}{60}}$$", "id": "3592295"}, {"introduction": "除了计算之外，理解伪逆的几何作用也至关重要。本练习将深入探讨 $AA^+$ 和 $A^+A$ 这两个矩阵，揭示它们并非单位矩阵，而是分别到 $A$ 的列空间和行空间的正交投影算子。通过一个具体的反例，你将看到这两个投影通常是不同的，并将它们的性质与矩阵的基本子空间联系起来。", "problem": "设 $A \\in \\mathbb{R}^{2 \\times 2}$ 为奇异矩阵\n$$\nA \\;=\\; \\begin{pmatrix} 1 & 1 \\\\ 0 & 0 \\end{pmatrix}.\n$$\n仅利用任意实矩阵的奇异值分解（SVD）的存在性以及通过SVD定义的穆尔-彭罗斯（MP）伪逆，从第一性原理出发，完成以下步骤：\n\n1. 计算 $A$ 的一个SVD分解 $A = U \\Sigma V^{\\top}$，确定非零奇异值和相应的奇异向量。利用此结果构造MP伪逆 $A^{+} = V \\Sigma^{+} U^{\\top}$。\n\n2. 显式计算两个矩阵 $A A^{+}$ 和 $A^{+} A$。直接（通过计算）验证 $A A^{+} \\neq A^{+} A$。\n\n3. 通过直接的线性代数分析（求解列空间和相关齐次方程组的解），确定 $A A^{+}$ 和 $A^{+} A$ 的值域和零空间。将每个空间表示为 $\\mathbb{R}^{2}$ 中向量的张成空间。\n\n4. 设 $\\|\\cdot\\|_{F}$ 表示弗罗贝尼乌斯范数，对于任意实矩阵 $M$，其定义为 $\\|M\\|_{F}^{2} = \\sum_{i,j} M_{ij}^{2}$。计算标量 $\\|A A^{+} - A^{+} A\\|_{F}^{2}$。\n\n你的最终答案必须是步骤 4 中得到的单个实数。无需四舍五入。", "solution": "我们从奇异值分解（SVD）的存在性及其在定义穆尔-彭罗斯（MP）伪逆中的应用出发。对于任意实矩阵 $A$，存在正交矩阵 $U$ 和 $V$ 以及一个对角线元素为非负数（奇异值）的对角矩阵 $\\Sigma$，使得 $A = U \\Sigma V^{\\top}$。如果 $\\Sigma$ 的对角线元素为 $\\sigma_{1} \\ge \\sigma_{2} \\ge \\cdots \\ge 0$，那么MP伪逆定义为 $A^{+} = V \\Sigma^{+} U^{\\top}$，其中 $\\Sigma^{+}$ 将每个非零的 $\\sigma_{i}$ 替换为 $\\sigma_{i}^{-1}$，并保持零不变。\n\n步骤 1：计算 $A$ 的SVD分解，然后计算 $A^{+}$。\n\n我们有\n$$\nA = \\begin{pmatrix} 1 & 1 \\\\ 0 & 0 \\end{pmatrix}.\n$$\n计算 $A A^{\\top}$ 和 $A^{\\top} A$：\n$$\nA A^{\\top} = \\begin{pmatrix} 2 & 0 \\\\ 0 & 0 \\end{pmatrix}, \n\\qquad\nA^{\\top} A = \\begin{pmatrix} 1 & 1 \\\\ 1 & 1 \\end{pmatrix}.\n$$\n$A A^{\\top}$ 的特征值为 $2$ 和 $0$，因此奇异值为 $\\sigma_{1} = \\sqrt{2}$ 和 $\\sigma_{2} = 0$。$A A^{\\top}$ 对应于特征值 $2$ 的一个单位特征向量是 $u_{1} = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$，对应于特征值 $0$ 的一个单位特征向量是 $u_{2} = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}$。因此我们可以取\n$$\nU = \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix}, \n\\qquad\n\\Sigma = \\begin{pmatrix} \\sqrt{2} & 0 \\\\ 0 & 0 \\end{pmatrix}.\n$$\n相应的右奇异向量 $v_{1}$ 由 $v_{1} = \\frac{1}{\\sigma_{1}} A^{\\top} u_{1}$ 得到：\n$$\nA^{\\top} u_{1} = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}, \n\\quad\nv_{1} = \\frac{1}{\\sqrt{2}} \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}.\n$$\n选择一个与 $v_{1}$ 正交的单位向量作为 $v_{2}$，例如\n$$\nv_{2} = \\frac{1}{\\sqrt{2}} \\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix}.\n$$\n因此\n$$\nV = \\begin{pmatrix} \\frac{1}{\\sqrt{2}} & \\frac{1}{\\sqrt{2}} \\\\ \\frac{1}{\\sqrt{2}} & -\\frac{1}{\\sqrt{2}} \\end{pmatrix}.\n$$\n那么伪逆是\n$$\n\\Sigma^{+} = \\begin{pmatrix} \\frac{1}{\\sqrt{2}} & 0 \\\\ 0 & 0 \\end{pmatrix},\n\\qquad\nA^{+} = V \\Sigma^{+} U^{\\top} = V \\Sigma^{+}.\n$$\n显式计算 $A^{+}$：\n$$\nA^{+} = \\begin{pmatrix} \\frac{1}{\\sqrt{2}} & \\frac{1}{\\sqrt{2}} \\\\ \\frac{1}{\\sqrt{2}} & -\\frac{1}{\\sqrt{2}} \\end{pmatrix}\n\\begin{pmatrix} \\frac{1}{\\sqrt{2}} & 0 \\\\ 0 & 0 \\end{pmatrix}\n=\n\\begin{pmatrix} \\frac{1}{2} & 0 \\\\ \\frac{1}{2} & 0 \\end{pmatrix}.\n$$\n\n步骤 2：计算 $A A^{+}$ 和 $A^{+} A$ 并验证它们不相等。\n\n首先，\n$$\nA A^{+} = \\begin{pmatrix} 1 & 1 \\\\ 0 & 0 \\end{pmatrix}\n\\begin{pmatrix} \\frac{1}{2} & 0 \\\\ \\frac{1}{2} & 0 \\end{pmatrix}\n=\n\\begin{pmatrix} 1 & 0 \\\\ 0 & 0 \\end{pmatrix}.\n$$\n其次，\n$$\nA^{+} A = \\begin{pmatrix} \\frac{1}{2} & 0 \\\\ \\frac{1}{2} & 0 \\end{pmatrix}\n\\begin{pmatrix} 1 & 1 \\\\ 0 & 0 \\end{pmatrix}\n=\n\\begin{pmatrix} \\frac{1}{2} & \\frac{1}{2} \\\\ \\frac{1}{2} & \\frac{1}{2} \\end{pmatrix}.\n$$\n这两个矩阵显然不相等，所以 $A A^{+} \\neq A^{+} A$。\n\n步骤 3：确定 $A A^{+}$ 和 $A^{+} A$ 的值域和零空间。\n\n对于 $A A^{+}$：\n$$\nA A^{+} = \\begin{pmatrix} 1 & 0 \\\\ 0 & 0 \\end{pmatrix}.\n$$\n值域是 $A A^{+}$ 的列空间，即\n$$\n\\operatorname{range}(A A^{+}) = \\operatorname{span}\\!\\left\\{ \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} \\right\\}.\n$$\n零空间是满足 $(A A^{+}) x = 0$ 的向量 $x = \\begin{pmatrix} x_{1} \\\\ x_{2} \\end{pmatrix}$ 的集合，即\n$$\n\\begin{pmatrix} 1 & 0 \\\\ 0 & 0 \\end{pmatrix} \\begin{pmatrix} x_{1} \\\\ x_{2} \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix} \\;\\;\\Longrightarrow\\;\\; x_{1} = 0,\n$$\n所以\n$$\n\\operatorname{null}(A A^{+}) = \\operatorname{span}\\!\\left\\{ \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} \\right\\}.\n$$\n\n对于 $A^{+} A$：\n$$\nA^{+} A = \\begin{pmatrix} \\frac{1}{2} & \\frac{1}{2} \\\\ \\frac{1}{2} & \\frac{1}{2} \\end{pmatrix}.\n$$\n它的值域是其列向量的张成空间；两列都等于 $\\frac{1}{2} \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$，因此\n$$\n\\operatorname{range}(A^{+} A) = \\operatorname{span}\\!\\left\\{ \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} \\right\\}.\n$$\n它的零空间由满足 $(A^{+} A) x = 0$ 的向量 $x$ 组成，即\n$$\n\\begin{pmatrix} \\frac{1}{2} & \\frac{1}{2} \\\\ \\frac{1}{2} & \\frac{1}{2} \\end{pmatrix} \\begin{pmatrix} x_{1} \\\\ x_{2} \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix} \\;\\;\\Longrightarrow\\;\\; x_{1} + x_{2} = 0,\n$$\n所以\n$$\n\\operatorname{null}(A^{+} A) = \\operatorname{span}\\!\\left\\{ \\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix} \\right\\}.\n$$\n\n步骤 4：计算 $\\|A A^{+} - A^{+} A\\|_{F}^{2}$。\n\n构造差值\n$$\nD \\;=\\; A A^{+} - A^{+} A \\;=\\; \\begin{pmatrix} 1 & 0 \\\\ 0 & 0 \\end{pmatrix} - \\begin{pmatrix} \\frac{1}{2} & \\frac{1}{2} \\\\ \\frac{1}{2} & \\frac{1}{2} \\end{pmatrix}\n\\;=\\; \\begin{pmatrix} \\frac{1}{2} & -\\frac{1}{2} \\\\ -\\frac{1}{2} & -\\frac{1}{2} \\end{pmatrix}.\n$$\n弗罗贝尼乌斯范数的平方是所有元素平方的和：\n$$\n\\|D\\|_{F}^{2} \\;=\\; \\left(\\frac{1}{2}\\right)^{2} + \\left(-\\frac{1}{2}\\right)^{2} + \\left(-\\frac{1}{2}\\right)^{2} + \\left(-\\frac{1}{2}\\right)^{2}\n\\;=\\; \\frac{1}{4} + \\frac{1}{4} + \\frac{1}{4} + \\frac{1}{4}\n\\;=\\; 1.\n$$\n因此，所求的标量是 $1$。", "answer": "$$\\boxed{1}$$", "id": "3592297"}, {"introduction": "穆尔-彭罗斯伪逆是独一无二的。它只是更广泛的“广义逆”家族中的一个成员，但其特殊性在于它唯一地满足所有四个彭罗斯条件。本练习旨在阐明这种唯一性：你将首先为一个简单矩阵描绘出所有广义逆的特征，然后构造一个非穆尔-彭罗斯的广义逆，从而亲眼见证它缺少了哪些关键属性（例如生成正交投影）。", "problem": "设 $A \\in \\mathbb{R}^{3 \\times 3}$ 为对角矩阵 $A = \\operatorname{diag}(2,0,1)$。如果一个矩阵 $X \\in \\mathbb{R}^{3 \\times 3}$ 满足方程 $A X A = A$，则称其为 $A$ 的一个广义逆。穆尔-彭罗斯 (MP) 伪逆 $A^{+}$ 是满足以下四个 Penrose 方程的唯一矩阵：$A A^{+} A = A$，$A^{+} A A^{+} = A^{+}$，$(A A^{+})^{\\top} = A A^{+}$ 以及 $(A^{+} A)^{\\top} = A^{+} A$。\n\n从这些定义出发，并且不使用任何针对此矩阵的现成公式，按以下步骤进行：\n- 对于对角矩阵，从第一性原理出发推导并确定 $A^{+}$。\n- 通过逐项求解约束条件 $A A^{-} A = A$ 来刻画 $A$ 的所有广义逆 $A^{-}$。\n- 构造一个特定的非 Moore–Penrose 广义逆，方法如下：选择一个自由参数为非零，同时保持其他参数为零：将第 $(1,2)$ 项设为 $1$，所有其他自由参数设为 $0$。将此选择的矩阵记为 $A^{-}$。\n- 计算标量\n$$\nS \\;=\\; \\|A A^{-} - A A^{+}\\|_{F}^{2} \\;+\\; \\|A^{-} A - A^{+} A\\|_{F}^{2},\n$$\n其中 $\\|\\cdot\\|_{F}$ 表示 Frobenius 范数。\n\n将 $S$ 的最终结果表示为一个精确的实数。无需四舍五入。", "solution": "我们从定义性质开始。广义逆 $A^{-}$ 是满足 $A A^{-} A = A$ 的任意矩阵。穆尔-彭罗斯伪逆 $A^{+}$ 是满足四个 Penrose 方程的唯一矩阵。对于对角矩阵，这些条件可以逐项分析。\n\n首先，我们确定 $A^{+}$。因为 $A = \\operatorname{diag}(2,0,1)$ 的奇异值为 $2$、$0$ 和 $1$，且标准基向量同时作为其左、右奇异向量，所以穆尔-彭罗斯伪逆的作用是对非零奇异值取倒数，并将与零奇异值对应的子空间映射为零。因此\n$$\nA^{+} \\;=\\; \\operatorname{diag}\\!\\big(\\tfrac{1}{2},\\,0,\\,1\\big).\n$$\n确实，这个 $A^{+}$ 满足 $A A^{+} = \\operatorname{diag}(1,0,1) = A^{+} A$（它是对称的），并且满足 $A A^{+} A = A$ 和 $A^{+} A A^{+} = A^{+}$。\n\n接下来，我们通过逐项求解 $A A^{-} A = A$ 来刻画所有的广义逆 $A^{-}$。记 $A=D$，其中 $D = \\operatorname{diag}(2,0,1)$。设 $X = (x_{ij}) \\in \\mathbb{R}^{3 \\times 3}$ 为任意矩阵。那么\n$$\n(D X D)_{ij} \\;=\\; d_{i}\\, x_{ij}\\, d_{j},\n$$\n其中 $d_{1} = 2$，$d_{2} = 0$ 且 $d_{3} = 1$。约束条件 $D X D = D$ 产生以下方程：\n- 对于 $(i,j) = (1,1)$：$2 \\cdot x_{11} \\cdot 2 = 2$，因此 $x_{11} = \\tfrac{1}{2}$。\n- 对于 $(i,j) = (3,3)$：$1 \\cdot x_{33} \\cdot 1 = 1$，因此 $x_{33} = 1$。\n- 对于 $(i,j) = (1,3)$：$2 \\cdot x_{13} \\cdot 1 = 0$，因此 $x_{13} = 0$。\n- 对于 $(i,j) = (3,1)$：$1 \\cdot x_{31} \\cdot 2 = 0$，因此 $x_{31} = 0$。\n- 对于任何 $i=2$ 或 $j=2$ 的索引，我们有 $d_{i} = 0$ 或 $d_{j} = 0$，所以 $(D X D)_{ij} = 0$，这与 $D$ 中对应的零项相匹配，并且没有施加任何约束。\n\n因此，广义逆的通解集合为\n$$\nA^{-} \\;=\\; X \\;=\\;\n\\begin{pmatrix}\n\\tfrac{1}{2} & a & 0 \\\\\nb & c & d \\\\\n0 & e & 1\n\\end{pmatrix},\n$$\n其中 $a, b, c, d, e \\in \\mathbb{R}$ 是任意的。穆尔-彭罗斯伪逆对应于选择 $a = b = c = d = e = 0$。\n\n我们现在通过将第 $(1,2)$ 项设为 $1$ 并将所有其他自由参数设为 $0$ 来构造一个特定的非穆尔-彭罗斯广义逆。即，\n$$\nA^{-} \\;=\\;\n\\begin{pmatrix}\n\\tfrac{1}{2} & 1 & 0 \\\\\n0 & 0 & 0 \\\\\n0 & 0 & 1\n\\end{pmatrix}.\n$$\n根据上述的刻画，这个 $A^{-}$ 满足 $A A^{-} A = A$，并且由于 $a = 1 \\neq 0$，它不是穆尔-彭罗斯伪逆。实际上，如下文所示，它不满足其中一个斜投影矩阵的对称性要求。\n\n我们计算相关的投影矩阵。首先，\n$$\nA A^{+} \\;=\\; \\operatorname{diag}(1,0,1), \\qquad A^{+} A \\;=\\; \\operatorname{diag}(1,0,1).\n$$\n其次，\n$$\nA A^{-} \\;=\\; D X \\;=\\;\n\\begin{pmatrix}\n2 & 0 & 0 \\\\\n0 & 0 & 0 \\\\\n0 & 0 & 1\n\\end{pmatrix}\n\\begin{pmatrix}\n\\tfrac{1}{2} & 1 & 0 \\\\\n0 & 0 & 0 \\\\\n0 & 0 & 1\n\\end{pmatrix}\n\\;=\\;\n\\begin{pmatrix}\n1 & 2 & 0 \\\\\n0 & 0 & 0 \\\\\n0 & 0 & 1\n\\end{pmatrix},\n$$\n以及\n$$\nA^{-} A \\;=\\; X D \\;=\\;\n\\begin{pmatrix}\n\\tfrac{1}{2} & 1 & 0 \\\\\n0 & 0 & 0 \\\\\n0 & 0 & 1\n\\end{pmatrix}\n\\begin{pmatrix}\n2 & 0 & 0 \\\\\n0 & 0 & 0 \\\\\n0 & 0 & 1\n\\end{pmatrix}\n\\;=\\;\n\\begin{pmatrix}\n1 & 0 & 0 \\\\\n0 & 0 & 0 \\\\\n0 & 0 & 1\n\\end{pmatrix}.\n$$\n因此，\n$$\nA A^{-} - A A^{+} \\;=\\;\n\\begin{pmatrix}\n0 & 2 & 0 \\\\\n0 & 0 & 0 \\\\\n0 & 0 & 0\n\\end{pmatrix},\n\\qquad\nA^{-} A - A^{+} A \\;=\\;\n\\begin{pmatrix}\n0 & 0 & 0 \\\\\n0 & 0 & 0 \\\\\n0 & 0 & 0\n\\end{pmatrix}.\n$$\nFrobenius 范数的平方是所有元素平方的和。因此，\n$$\n\\|A A^{-} - A A^{+}\\|_{F}^{2} \\;=\\; 2^{2} \\;=\\; 4,\n\\qquad\n\\|A^{-} A - A^{+} A\\|_{F}^{2} \\;=\\; 0.\n$$\n因此，\n$$\nS \\;=\\; 4 \\;+\\; 0 \\;=\\; 4.\n$$\n这样就完成了从第一性原理出发的构造和比较，得出了所要求的标量。", "answer": "$$\\boxed{4}$$", "id": "3592273"}]}