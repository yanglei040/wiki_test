{"hands_on_practices": [{"introduction": "我们从一个基本但至关重要的问题开始：如何通过可计算的量（如残差）来估计我们关心的真实误差（前向误差）？这个问题是数值算法稳定性分析的核心。通过这个练习[@problem_id:3581515]，你将亲自推导并应用连接残差、条件数和前向误差的关键不等式，从而对一个线性系统的解的质量做出定量评估。", "problem": "考虑线性系统 $A x = b$，其中\n$$A = \\mathrm{diag}(1, 10, 100), \\quad b = \\begin{pmatrix} 6 \\\\ 8 \\\\ 0 \\end{pmatrix}.$$\n一个数值算法产生一个近似解 $\\hat{x}$，其残差 $r$ 测量为\n$$r = b - A \\hat{x} = \\begin{pmatrix} 1 \\times 10^{-6} \\\\ -2 \\times 10^{-6} \\\\ 2 \\times 10^{-6} \\end{pmatrix}.$$\n使用欧几里得向量范数 $\\|\\cdot\\|_{2}$ 和相关的诱导矩阵范数，并将谱范数下的矩阵条件数 $\\kappa_{2}(A)$ 对此 $A$ 视为已知，从第一性原理推导一个关于相对前向误差 $\\dfrac{\\|x - \\hat{x}\\|_{2}}{\\|x\\|_{2}}$ 的先验上界（仅依赖于 $\\kappa_{2}(A)$、$\\|r\\|_{2}$ 和 $\\|b\\|_{2}$），其中 $x$ 是 $A x = b$ 的精确解。然后，根据给定的数据，数值计算这个上界。将你最终的数值上界四舍五入到四位有效数字。", "solution": "用户希望找到线性系统近似解的相对前向误差的一个先验上界，然后数值计算这个上界。\n\n### 第一步：问题验证\n\n**1.1. 提取已知条件：**\n- 线性系统：$A x = b$\n- 矩阵 $A$：$A = \\mathrm{diag}(1, 10, 100)$\n- 向量 $b$：$b = \\begin{pmatrix} 6 \\\\ 8 \\\\ 0 \\end{pmatrix}$\n- 精确解：$x$\n- 近似解：$\\hat{x}$\n- 残差向量 $r$：$r = b - A \\hat{x} = \\begin{pmatrix} 1 \\times 10^{-6} \\\\ -2 \\times 10^{-6} \\\\ 2 \\times 10^{-6} \\end{pmatrix}$\n- 范数：欧几里得向量范数 $\\|\\cdot\\|_{2}$ 和相关的诱导矩阵范数（谱范数）。\n- 已知常数：条件数 $\\kappa_{2}(A)$。\n- 目标：根据 $\\kappa_{2}(A)$、$\\|r\\|_{2}$ 和 $\\|b\\|_{2}$ 推导相对前向误差 $\\dfrac{\\|x - \\hat{x}\\|_{2}}{\\|x\\|_{2}}$ 的上界，然后计算其数值。\n\n**1.2. 使用提取的已知条件进行验证：**\n- **科学依据：**该问题是数值线性代数中的一个标准练习，涉及残差与前向误差之间的关系。这是分析求解线性系统数值算法的一个基本概念。所涉及的原理是公认的。\n- **适定性：**矩阵 $A$ 是对角矩阵，且对角元素非零，因此是可逆的，保证了唯一解 $x$ 的存在。问题要求一个标准的上界，这是一个定义明确的推导。所有必要的数据都已提供。\n- **客观性：**该问题使用精确的数学语言和定义陈述，没有歧义或主观论断。\n- **其他标准：**该问题是自洽的、一致的、科学上可行的。它不违反任何指定的无效标准。\n\n**1.3. 结论与行动：**\n该问题有效。将提供完整的解答。\n\n### 第二步：上界的推导\n\n相对前向误差定义为 $\\dfrac{\\|x - \\hat{x}\\|_{2}}{\\|x\\|_{2}}$。我们需要找到这个量的上界。\n\n令 $e = x - \\hat{x}$ 为前向误差向量。\n残差由 $r = b - A \\hat{x}$ 给出。\n精确解 $x$ 满足方程 $A x = b$。\n将 $b = A x$ 代入残差的表达式，我们得到：\n$$r = A x - A \\hat{x} = A(x - \\hat{x}) = A e$$\n由于矩阵 $A$ 是可逆的，我们可以用残差 $r$ 来表示误差 $e$：\n$$e = A^{-1} r$$\n对两边取欧几里得范数，并应用诱导矩阵范数的性质 $\\|Mv\\|_{2} \\le \\|M\\|_{2}\\|v\\|_{2}$，我们得到绝对前向误差的一个界：\n$$\\|e\\|_{2} = \\|x - \\hat{x}\\|_{2} = \\|A^{-1} r\\|_{2} \\le \\|A^{-1}\\|_{2} \\|r\\|_{2}$$\n这给出了误差向量范数的一个上界。为了找到相对误差的界，我们需要找到 $\\|x\\|_{2}$ 的一个下界。\n从原方程 $A x = b$ 出发，对两边取范数：\n$$\\|b\\|_{2} = \\|A x\\|_{2}$$\n使用相同的诱导矩阵范数性质，我们有：\n$$\\|b\\|_{2} \\le \\|A\\|_{2} \\|x\\|_{2}$$\n由于 $A$ 是可逆的且 $b \\neq 0$，解 $x$ 是非零的，所以 $\\|x\\|_{2} > 0$。我们可以重新整理不等式以获得 $\\|x\\|_{2}$ 的一个下界：\n$$\\|x\\|_{2} \\ge \\frac{\\|b\\|_{2}}{\\|A\\|_{2}}$$\n取倒数，我们得到 $\\dfrac{1}{\\|x\\|_{2}}$ 的一个上界：\n$$\\frac{1}{\\|x\\|_{2}} \\le \\frac{\\|A\\|_{2}}{\\|b\\|_{2}}$$\n现在，我们可以结合 $\\|x - \\hat{x}\\|_{2}$ 和 $\\dfrac{1}{\\|x\\|_{2}}$ 的界来界定相对前向误差：\n$$\\frac{\\|x - \\hat{x}\\|_{2}}{\\|x\\|_{2}} \\le (\\|A^{-1}\\|_{2} \\|r\\|_{2}) \\left( \\frac{\\|A\\|_{2}}{\\|b\\|_{2}} \\right)$$\n重新整理各项，我们得到：\n$$\\frac{\\|x - \\hat{x}\\|_{2}}{\\|x\\|_{2}} \\le \\|A\\|_{2} \\|A^{-1}\\|_{2} \\frac{\\|r\\|_{2}}{\\|b\\|_{2}}$$\n根据定义，$A$ 在谱范数下的条件数是 $\\kappa_{2}(A) = \\|A\\|_{2} \\|A^{-1}\\|_{2}$。将此代入不等式，得到所需的先验上界：\n$$\\frac{\\|x - \\hat{x}\\|_{2}}{\\|x\\|_{2}} \\le \\kappa_{2}(A) \\frac{\\|r\\|_{2}}{\\|b\\|_{2}}$$\n\n### 第三步：上界的数值计算\n\n为了计算这个上界，我们必须计算 $\\kappa_{2}(A)$、$\\|b\\|_{2}$ 和 $\\|r\\|_{2}$ 的值。\n\n**1. $\\kappa_{2}(A)$ 的计算：**\n矩阵 $A$ 是一个对角矩阵：$A = \\mathrm{diag}(1, 10, 100)$。对于对称矩阵（包括对角矩阵），谱范数 $\\|A\\|_{2}$ 等于其谱半径，即其特征值的最大绝对值。对角矩阵的特征值是其对角线上的元素。\n$A$ 的特征值是 $\\lambda_1 = 1$, $\\lambda_2 = 10$, $\\lambda_3 = 100$。\n因此，$A$ 的谱范数是：\n$$\\|A\\|_{2} = \\max\\{|1|, |10|, |100|\\} = 100$$\n$A$ 的逆矩阵是 $A^{-1} = \\mathrm{diag}(1^{-1}, 10^{-1}, 100^{-1}) = \\mathrm{diag}(1, 0.1, 0.01)$。\n$A^{-1}$ 的特征值是 $1$, $0.1$ 和 $0.01$。\n$A^{-1}$ 的谱范数是：\n$$\\|A^{-1}\\|_{2} = \\max\\{|1|, |0.1|, |0.01|\\} = 1$$\n条件数 $\\kappa_{2}(A)$ 是这些范数的乘积：\n$$\\kappa_{2}(A) = \\|A\\|_{2} \\|A^{-1}\\|_{2} = 100 \\times 1 = 100$$\n或者，对于对称正定矩阵，$\\kappa_{2}(A) = \\frac{\\lambda_{\\max}}{\\lambda_{\\min}} = \\frac{100}{1} = 100$。\n\n**2. $\\|b\\|_{2}$ 的计算：**\n向量 $b$ 给出为 $b = \\begin{pmatrix} 6 \\\\ 8 \\\\ 0 \\end{pmatrix}$。其欧几里得范数是：\n$$\\|b\\|_{2} = \\sqrt{6^2 + 8^2 + 0^2} = \\sqrt{36 + 64} = \\sqrt{100} = 10$$\n\n**3. $\\|r\\|_{2}$ 的计算：**\n残差向量 $r$ 给出为 $r = \\begin{pmatrix} 1 \\times 10^{-6} \\\\ -2 \\times 10^{-6} \\\\ 2 \\times 10^{-6} \\end{pmatrix}$。其欧几里得范数是：\n$$\\|r\\|_{2} = \\sqrt{(1 \\times 10^{-6})^2 + (-2 \\times 10^{-6})^2 + (2 \\times 10^{-6})^2}$$\n$$\\|r\\|_{2} = \\sqrt{1 \\times 10^{-12} + 4 \\times 10^{-12} + 4 \\times 10^{-12}} = \\sqrt{9 \\times 10^{-12}} = 3 \\times 10^{-6}$$\n\n**4. 上界的最终计算：**\n将计算出的值代入推导出的不等式：\n$$\\frac{\\|x - \\hat{x}\\|_{2}}{\\|x\\|_{2}} \\le \\kappa_{2}(A) \\frac{\\|r\\|_{2}}{\\|b\\|_{2}} = 100 \\times \\frac{3 \\times 10^{-6}}{10}$$\n$$\\frac{\\|x - \\hat{x}\\|_{2}}{\\|x\\|_{2}} \\le 10 \\times (3 \\times 10^{-6}) = 3 \\times 10^{-5}$$\n问题要求将数值上界四舍五入到四位有效数字。\n$$3 \\times 10^{-5} = 3.000 \\times 10^{-5}$$\n因此，相对前向误差的上界是 $3.000 \\times 10^{-5}$。", "answer": "$$\n\\boxed{3.000 \\times 10^{-5}}\n$$", "id": "3581515"}, {"introduction": "在理想情况下，一个小的残差意味着我们接近了真实解。然而，当处理非正规矩阵时，这种直觉可能会失效，导致迭代改进等修正方法失败。这个练习[@problem_id:3581533]将引导你通过一个经典的非正规矩阵例子，精确推导误差传播算子，并确定迭代改进收敛的临界条件。这将揭示非正规性如何放大舍入误差的影响，使得残差成为一个具有误导性的指标。", "problem": "考虑由下式定义的上三角非正规矩阵族 $A_{M} \\in \\mathbb{R}^{2 \\times 2}$：\n$$\nA_{M} = \\begin{pmatrix} 1 & M \\\\ 0 & 1 \\end{pmatrix},\n$$\n其中右端向量固定为 $b = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$，且 $A_{M} x = b$ 的精确解为 $x$。通过在工作精度下求解扰动系统 $(A_{M} + E)\\hat{x} = b$ 得到计算近似解 $\\hat{x}$，其中后向误差矩阵 $E$ 为\n$$\nE = \\begin{pmatrix} 0 & 0 \\\\ \\varepsilon & 0 \\end{pmatrix},\n$$\n其中 $0 < \\varepsilon \\ll 1$ 代表工作精度浮点（FP）算术的单位舍入。执行一次迭代精化步骤如下：以足够高的精度计算残差 $r = b - A_{M}\\hat{x}$，使得对于给定的 $\\hat{x}$ 和 $A_{M}$，$r$ 是精确的；然后使用产生 $\\hat{x}$ 的相同工作精度因子求解 $(A_{M} + E)d = r$ 得到修正量 $d$。新的近似解为 $\\hat{x}^{(1)} = \\hat{x} + d$。\n\n从后向误差、前向误差和迭代精化更新的核心定义出发，并仅使用线性代数恒等式，推导在 $2$-范数意义下将当前前向误差 $e = x - \\hat{x}$ 映射到下一个前向误差 $e^{(1)} = x - \\hat{x}^{(1)}$ 的精确线性误差传播算子 $T(M,\\varepsilon)$。使用该算子，明确确定 $M \\geq 0$ 的最大值（作为 $\\varepsilon$ 的函数），使得对于所有非零 $e$，第一次迭代精化步骤严格减小 $2$-范数意义下的前向误差。\n\n您的推导必须解释为什么尽管残差 $r$ 是在更高精度下计算的（因此对于 $A_{M}$ 和 $\\hat{x}$ 是精确的），$A_{M}$ 的非正规性会使残差具有误导性，以及这如何通过预解式 $(A_{M} + E)^{-1}$ 与 $A_{M}^{-1}$ 对舍入的敏感性相关联。将最终答案 $M_{\\text{crit}}(\\varepsilon)$ 表示为闭式解析表达式。本问题无需舍入，也没有物理单位。最终答案必须是单一的解析表达式。", "solution": "首先验证问题，以确保其科学上合理、适定、客观且自洽。\n\n### 第1步：提取已知条件\n-   矩阵族为 $A_{M} = \\begin{pmatrix} 1 & M \\\\ 0 & 1 \\end{pmatrix} \\in \\mathbb{R}^{2 \\times 2}$。\n-   右端向量为 $b = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$。\n-   精确解 $x$ 满足 $A_{M} x = b$。\n-   计算近似解 $\\hat{x}$ 满足 $(A_{M} + E)\\hat{x} = b$。\n-   后向误差矩阵为 $E = \\begin{pmatrix} 0 & 0 \\\\ \\varepsilon & 0 \\end{pmatrix}$，其中 $0 < \\varepsilon \\ll 1$。\n-   迭代精化更新定义如下：\n    1.  残差计算：$r = b - A_{M}\\hat{x}$ (精确)。\n    2.  修正量计算：$(A_{M} + E)d = r$。\n    3.  新的近似解：$\\hat{x}^{(1)} = \\hat{x} + d$。\n-   前向误差为 $e = x - \\hat{x}$ 和 $e^{(1)} = x - \\hat{x}^{(1)}$。\n-   任务是找到线性算子 $T(M, \\varepsilon)$ 使得 $e^{(1)} = T(M, \\varepsilon)e$，并找到 $M \\geq 0$ 的最大值，使得对所有非零 $e$ 都有 $\\|\\boldsymbol{e}^{(1)}\\|_2 < \\|e\\|_2$。\n\n### 第2步：使用提取的已知条件进行验证\n该问题在数值线性代数领域是良定义的。它使用了后向误差、前向误差、迭代精化、矩阵范数和非正规性等标准概念。矩阵 $A_M$ 是非正规矩阵（一个与 Jordan 块相关的剪切矩阵）的经典例子，常用于研究谱信息可能具有误导性的现象。迭代精化的设置，即使用相同的扰动求解器来寻找修正量，是标准的。该问题在数学和科学上是合理的、自洽的和客观的。它并非微不足道，并探讨了数值算法稳定性分析中的一个核心概念。\n\n### 第3步：结论与行动\n问题有效。将提供完整解答。\n\n### 解答推导\n推导过程如下：\n1.  确定精确解 $x$。\n2.  推导将初始前向误差 $e$ 映射到新前向误差 $e^{(1)}$ 的误差传播算子 $T(M, \\varepsilon)$。\n3.  分析误差严格减小的条件，即算子 $T$ 的谱范数（2-范数）必须小于 $1$。\n4.  求解得到的不等式以得到 $M$ 的临界值 $M_{\\text{crit}}$。\n\n首先，我们从 $A_{M}x = b$ 求出精确解 $x$：\n$$\n\\begin{pmatrix} 1 & M \\\\ 0 & 1 \\end{pmatrix} \\begin{pmatrix} x_1 \\\\ x_2 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}\n$$\n通过回代求解该系统，得到 $x_2 = 0$ 和 $x_1 + M(0) = 1$，因此 $x_1 = 1$。所以，精确解为 $x = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$。\n\n接下来，我们推导误差传播算子。新的近似解是 $\\hat{x}^{(1)} = \\hat{x} + d$。新的前向误差是：\n$$\ne^{(1)} = x - \\hat{x}^{(1)} = x - (\\hat{x} + d) = (x - \\hat{x}) - d = e - d\n$$\n修正量 $d$ 是 $(A_{M} + E)d = r$ 的解。残差 $r$ 精确计算为 $r = b - A_{M}\\hat{x}$。由于 $b=A_Mx$，我们可以写出：\n$$\nr = A_{M}x - A_{M}\\hat{x} = A_{M}(x - \\hat{x}) = A_{M}e\n$$\n这个关系是精确的。现在我们将 $d$ 用 $e$ 表示：\n$$\nd = (A_{M} + E)^{-1}r = (A_{M} + E)^{-1}A_{M}e\n$$\n将此代入 $e^{(1)}$ 的表达式中：\n$$\ne^{(1)} = e - (A_{M} + E)^{-1}A_{M}e = \\left(I - (A_{M} + E)^{-1}A_{M}\\right)e\n$$\n由此，我们确定误差传播算子 $T(M, \\varepsilon)$：\n$$\nT(M, \\varepsilon) = I - (A_{M} + E)^{-1}A_{M}\n$$\n为了显式计算 $T$，我们首先求 $A_{M} + E$ 的逆：\n$$\nA_{M} + E = \\begin{pmatrix} 1 & M \\\\ \\varepsilon & 1 \\end{pmatrix}\n$$\n行列式为 $\\det(A_{M} + E) = 1 \\cdot 1 - M \\cdot \\varepsilon = 1 - M\\varepsilon$。为了使逆存在，必须有 $M\\varepsilon \\neq 1$。考虑到 $0 < \\varepsilon \\ll 1$，这是一个合理的假设。\n$$\n(A_{M} + E)^{-1} = \\frac{1}{1 - M\\varepsilon} \\begin{pmatrix} 1 & -M \\\\ -\\varepsilon & 1 \\end{pmatrix}\n$$\n现在，我们计算乘积 $(A_{M} + E)^{-1}A_{M}$：\n$$\n(A_{M} + E)^{-1}A_{M} = \\frac{1}{1 - M\\varepsilon} \\begin{pmatrix} 1 & -M \\\\ -\\varepsilon & 1 \\end{pmatrix} \\begin{pmatrix} 1 & M \\\\ 0 & 1 \\end{pmatrix} = \\frac{1}{1 - M\\varepsilon} \\begin{pmatrix} 1 & 0 \\\\ -\\varepsilon & 1-M\\varepsilon \\end{pmatrix}\n$$\n最后，我们计算 $T(M, \\varepsilon)$：\n$$\nT(M, \\varepsilon) = \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix} - \\frac{1}{1 - M\\varepsilon} \\begin{pmatrix} 1 & 0 \\\\ -\\varepsilon & 1-M\\varepsilon \\end{pmatrix}\n$$\n$$\nT(M, \\varepsilon) = \\begin{pmatrix} 1 - \\frac{1}{1-M\\varepsilon} & 0 \\\\ 0 - \\frac{-\\varepsilon}{1-M\\varepsilon} & 1 - \\frac{1-M\\varepsilon}{1-M\\varepsilon} \\end{pmatrix} = \\begin{pmatrix} \\frac{1-M\\varepsilon-1}{1-M\\varepsilon} & 0 \\\\ \\frac{\\varepsilon}{1-M\\varepsilon} & 0 \\end{pmatrix} = \\frac{1}{1-M\\varepsilon} \\begin{pmatrix} -M\\varepsilon & 0 \\\\ \\varepsilon & 0 \\end{pmatrix}\n$$\n当 $M \\neq 0$ 时，$A_M$ 的非正规性导致了一种情况，即残差范数 $\\|r\\|_2$ 可能很小，而前向误差范数 $\\|e\\|_2$ 却很大。这里，$r = A_M e$，所以 $e=A_M^{-1}r$。逆矩阵的范数 $\\|A_M^{-1}\\|_2 = \\|\\begin{pmatrix} 1 & -M \\\\ 0 & 1 \\end{pmatrix}\\|_2 = \\frac{1}{2}(\\sqrt{M^2+4}+M)$ 随 $M$ 增大而增大。这种从残差到误差的放大是非正规系统的一个标志。迭代精化过程试图使用基于扰动矩阵 $A_M+E$ 的求解器来修正解。算子 $T$ 量化了这种修正的失败程度，其失败的根本原因在于当 $M$ 很大时，扰动逆矩阵 $(A_M+E)^{-1}$ 是 $A_M^{-1}$ 的一个糟糕近似。\n\n第一次迭代精化步骤对任何非零误差向量 $e$ 都严格减小前向误差的条件是，算子 $T$ 的诱导2-范数（谱范数）必须严格小于1：\n$$\n\\|T(M, \\varepsilon)\\|_2 < 1\n$$\n谱范数 $\\|T\\|_2$ 是 $T^T T$ 最大特征值的平方根。\n$$\nT^T = \\frac{1}{1-M\\varepsilon} \\begin{pmatrix} -M\\varepsilon & \\varepsilon \\\\ 0 & 0 \\end{pmatrix}\n$$\n$$\nT^T T = \\frac{1}{(1-M\\varepsilon)^2} \\begin{pmatrix} -M\\varepsilon & \\varepsilon \\\\ 0 & 0 \\end{pmatrix} \\begin{pmatrix} -M\\varepsilon & 0 \\\\ \\varepsilon & 0 \\end{pmatrix} = \\frac{1}{(1-M\\varepsilon)^2} \\begin{pmatrix} (-M\\varepsilon)^2 + \\varepsilon^2 & 0 \\\\ 0 & 0 \\end{pmatrix}\n$$\n$$\nT^T T = \\frac{\\varepsilon^2(M^2+1)}{(1-M\\varepsilon)^2} \\begin{pmatrix} 1 & 0 \\\\ 0 & 0 \\end{pmatrix}\n$$\n$T^T T$ 的特征值为 $\\lambda_1 = \\frac{\\varepsilon^2(M^2+1)}{(1-M\\varepsilon)^2}$ 和 $\\lambda_2 = 0$。最大特征值是 $\\lambda_1$。\n因此，谱范数为：\n$$\n\\|T\\|_2 = \\sqrt{\\lambda_1} = \\sqrt{\\frac{\\varepsilon^2(M^2+1)}{(1-M\\varepsilon)^2}} = \\frac{|\\varepsilon|\\sqrt{M^2+1}}{|1-M\\varepsilon|}\n$$\n考虑到 $M \\ge 0$ 和 $0 < \\varepsilon \\ll 1$，我们可以假设 $1 - M\\varepsilon > 0$。不等式变为：\n$$\n\\frac{\\varepsilon\\sqrt{M^2+1}}{1-M\\varepsilon} < 1\n$$\n由于两边都是正数，我们可以对不等式两边平方而不改变其方向：\n$$\n\\frac{\\varepsilon^2(M^2+1)}{(1-M\\varepsilon)^2} < 1 \\implies \\varepsilon^2(M^2+1) < (1-M\\varepsilon)^2\n$$\n$$\n\\varepsilon^2 M^2 + \\varepsilon^2 < 1 - 2M\\varepsilon + M^2\\varepsilon^2\n$$\n消去两边的 $\\varepsilon^2 M^2$ 项，得到：\n$$\n\\varepsilon^2 < 1 - 2M\\varepsilon\n$$\n现在，我们求解 $M$：\n$$\n2M\\varepsilon < 1 - \\varepsilon^2\n$$\n$$\nM < \\frac{1 - \\varepsilon^2}{2\\varepsilon}\n$$\n这个不等式定义了 $M \\ge 0$ 的范围，在此范围内，迭代精化步骤保证是 2-范数下的一个收缩。问题要求的是使这个严格不等式成立的 $M$ 的最大值。这对应于区间 $[0, \\frac{1 - \\varepsilon^2}{2\\varepsilon})$ 的上确界，即边界值。\n$$\nM_{\\text{crit}}(\\varepsilon) = \\frac{1 - \\varepsilon^2}{2\\varepsilon}\n$$\n对于任何 $M < M_{\\text{crit}}$，精化收敛；对于 $M > M_{\\text{crit}}$，它可能发散。在 $M=M_{\\text{crit}}$ 时，$\\|T\\|_2 = 1$，并且至少存在一个误差方向（$T$ 的第一个左奇异向量），其误差范数不会严格减小。", "answer": "$$\\boxed{\\frac{1 - \\varepsilon^{2}}{2\\varepsilon}}$$", "id": "3581533"}, {"introduction": "高斯消元法是求解线性系统的基石算法，其稳定性在很大程度上取决于所谓的“增长因子”。这个综合性练习[@problem_id:3581484]要求你不仅要从理论上推导高斯消元法的误差界，还要通过编程实现来具体构造一个特定的矩阵，并实证分析其增长因子对后向和前向误差的影响。通过结合理论推导、代码实现和数值实验，你将全面理解增长因子在保证算法稳定性中的核心作用，以及理论最坏情况界限与实际表现之间的差异。", "problem": "考虑对一个大小为 $n \\times n$ 的非奇异方阵应用带部分主元的高斯消元法 (GEPP)。令 $\\rho$ 表示生长因子，其定义为消元过程中产生的最大绝对值元素与原始矩阵中最大绝对值元素之比。以下任务重点在于建立后向稳定性、前向误差、条件数和生长因子之间的基本关系，并构造能在双精度算术中产生大生长因子但仍表现出后向稳定性的显式矩阵。\n\n任务 1（原理推导）。从后向误差和前向误差的定义以及标准浮点模型 $fl(a \\,\\circ\\, b) = (a \\,\\circ\\, b)(1 + \\delta)$（其中对于任何基本算术运算 $\\circ$ 和单位舍入 $u$，都有 $|\\delta| \\le u$）出发，推导带部分主元的高斯消元法 (GEPP) 的范数意义下的后向误差界。具体来说，证明计算出的解 $\\widehat{x}$ 满足 $(A + \\Delta A)\\widehat{x} = b$，其中扰动 $\\Delta A$ 服从以下形式的界：\n$$\n\\frac{\\|\\Delta A\\|}{\\|A\\|} \\le c\\, n\\, \\rho\\, u + \\mathcal{O}(u^2),\n$$\n其中 $c$ 是一个与 $A$ 无关的适中常数，$n$ 是维度，$\\rho$ 是消元过程产生的生长因子。然后，利用对于可逆矩阵 $A$，其前向误差可以通过条件数 $\\kappa$ 在子乘矩阵范数下与后向误差相关联这一事实，得到以下形式的界：\n$$\n\\frac{\\|\\widehat{x} - x\\|}{\\|x\\|} \\le \\frac{\\kappa(A) \\cdot \\frac{\\|\\Delta A\\|}{\\|A\\|}}{1 - \\kappa(A) \\cdot \\frac{\\|\\Delta A\\|}{\\|A\\|}},\n$$\n其中 $x$ 是 $A x = b$ 的精确解，且 $\\kappa(A) = \\|A\\| \\cdot \\|A^{-1}\\|$。\n\n任务 2（最坏情况构造）。对于给定的 $n$，构造一个矩阵 $W_n$，其元素为：\n$$\n(W_n)_{ij} = \n\\begin{cases}\n1, & j \\ge i, \\\\\n-1, & j < i,\n\\end{cases}\n$$\n以及右端项 $b = \\mathbf{1}$（全为 1 的向量）。已知该矩阵在 GEPP 下会引起接近最坏情况的生长因子。实现 GEPP 以在双精度下计算近似解 $\\widehat{x}$，并跟踪生长因子 $\\rho$（定义为消元过程中观察到的最大绝对值元素除以原始矩阵中的最大绝对值元素）。同时计算残差 $r = b - A\\widehat{x}$、范数意义下的相对后向误差\n$$\n\\beta = \\frac{\\|r\\|}{\\|A\\| \\cdot \\|\\widehat{x}\\| + \\|b\\|},\n$$\n并通过将界 $\\|\\Delta A\\| / \\|A\\| \\le c\\, n\\, \\rho\\, u$ 代入任务 1 中的不等式来估计前向误差界。所有范数均使用无穷范数。\n\n任务 3（影响量化）。基于任务 1 和任务 2，量化生长因子 $\\rho$ 如何通过项 $c\\, n\\, \\rho\\, u$ 和条件数 $\\kappa(A)$ 影响前向误差界。对于每个测试用例，报告观察到的生长因子 $\\rho$、理论上界 $2^{n-1}$、比值 $\\rho / 2^{n-1}$、实际相对后向误差 $\\beta$、界的代理值 $c\\, n\\, \\rho\\, u$ 以及从任务 1 得到的最终前向误差界。取 $c = 3$，而 $u$ 等于双精度单位舍入。\n\n实现要求。您的程序必须显式实现 GEPP 以完成以下操作：\n- 根据部分主元法执行行交换。\n- 累积并报告观察到的生长因子 $\\rho$。\n- 通过计算出的 LU 因子求解线性系统。\n- 计算残差 $r$、无穷范数 $\\|A\\|_{\\infty}$、$\\|A^{-1}\\|_{\\infty}$ 以及条件数 $\\kappa_{\\infty}(A)$。\n- 计算上述要求的量。\n\n测试套件。在以下矩阵大小上运行程序：\n- $n = 2$（边界情况），\n- $n = 5$（小规模情况），\n- $n = 10$（中等规模情况），\n- $n = 15$（较大规模情况），\n- $n = 20$（压力测试情况）。\n\n对于每个 $n$，使用 $W_n$ 构造和 $b = \\mathbf{1}$。所有报告的值都应在双精度浮点算术中计算。不涉及物理单位或角度。\n\n最终输出格式。您的程序应生成单行输出，其中包含一个用方括号括起来的、由逗号分隔的测试套件结果列表。每个测试用例的结果必须是按以下顺序排列的六个浮点数列表：\n$$\n[\\rho,\\;2^{n-1},\\;\\rho/2^{n-1},\\;\\beta,\\;c\\,n\\,\\rho\\,u,\\;\\text{forward\\_bound}],\n$$\n因此，总体输出是一个列表的列表，例如\n$$\n\\big[ [\\cdots], [\\cdots], [\\cdots], [\\cdots], [\\cdots] \\big].\n$$", "solution": "此问题要求对带部分主元的高斯消元法 (GEPP) 进行误差界的理论推导，并通过数值实现来研究一类特定矩阵的行为。该问题提法明确，并在数值线性代数原理上有坚实的科学基础。需要稍作说明的是，将矩阵 $W_n$ 描述为导致“接近最坏情况的生长因子”是不准确的；对于指定的结构，生长因子 $\\rho$ 保持很小（具体来说，当 $n>1$ 时 $\\rho=2$）。然而，这并不影响计算任务的有效性，该任务旨在构造此矩阵，观察其实际生长因子，并分析由此产生的误差，从而在特定案例与理论最坏情况界之间提供有价值的比较。\n\n### 任务 1：原理推导\n\n我们首先推导通过 GEPP 获得的线性系统 $Ax=b$ 的解的范数意义下的后向和前向误差界。\n\n**范数意义下的后向误差界**\n\n在浮点算术中使用 GEPP 求解 $Ax=b$ 的过程可以看作是一系列步骤，每一步都会引入舍入误差。主要步骤是置换矩阵 $PA$ 的 LU 分解以及求解两个三角系统。\n\n1.  **LU 分解：** GEPP 算法计算三角因子 $\\widehat{L}$ 和 $\\widehat{U}$ 以及一个置换矩阵 $P$，使得它们是一个扰动矩阵的精确因子：\n    $$ \\widehat{L}\\widehat{U} = PA + E $$\n    其中 $E$ 是由消元步骤中的舍入产生的误差矩阵。由 Wilkinson 建立的高斯消元法后向误差分析中的一个基石性结果，为 $E$ 的元素大小提供了一个界。在标准浮点算术模型中，其中 $fl(a \\circ b) = (a \\circ b)(1+\\delta)$ 且 $|\\delta| \\le u$（单位舍入），误差矩阵 $E$ 是有界的。这个界的一种常见形式是 $|E| \\le \\gamma_n |\\widehat{L}||\\widehat{U}|$，其中 $|M|$ 表示 $M$ 的元素绝对值构成的矩阵，且 $\\gamma_n = \\frac{nu}{1-nu}$。\n\n2.  **三角求解：** 解 $\\widehat{x}$ 是通过求解 $\\widehat{L}y=Pb$（前向替换）和 $\\widehat{U}\\widehat{x}=y$（后向回代）得到的。这些步骤也会引入舍入误差。可以证明，计算出的解 $\\widehat{x}$ 是一个扰动三角系统 $(\\widehat{U}+\\Delta\\widehat{U})\\widehat{x} = y$ 的精确解。\n\n3.  **综合效应：** 当所有误差源结合在一起时，可以证明计算出的解 $\\widehat{x}$ 是一个扰动原始系统的精确解：\n    $$ (A+\\Delta A)\\widehat{x} = b $$\n    扰动矩阵 $\\Delta A$ 的范数是有界的。这个界取决于计算出的因子的性质。部分主元法确保计算出的下三角因子 $\\widehat{L}$ 的所有元素都满足 $|\\widehat{l}_{ij}| \\le 1$。上三角因子 $\\widehat{U}$ 的元素大小与**生长因子** $\\rho$ 相关，其定义为：\n    $$ \\rho = \\frac{\\max_{i,j,k} |a_{ij}^{(k)}|}{\\max_{i,j} |a_{ij}^{(1)}|} $$\n    其中 $a_{ij}^{(k)}$ 是经过 $k-1$ 步消元后矩阵的元素。具体来说，$\\max_{i,j}|\\widehat{u}_{ij}| \\le \\rho \\max_{i,j}|a_{ij}|$。\n\n4.  **误差界：** 一个完整的推导会整合来自因子分解和替换的误差，以界定 $\\|\\Delta A\\|$。一个经典结果给出了一个类似 $\\|\\Delta A\\|_{\\infty} \\le f(n) \\rho \\|A\\|_{\\infty} u + \\mathcal{O}(u^2)$ 的界，其中 $f(n)$ 是一个关于 $n$ 的低次多项式（例如，$f(n) \\approx 3n^2$）。问题陈述中给出了一个简化的界：\n    $$ \\frac{\\|\\Delta A\\|}{\\|A\\|} \\le c\\, n\\, \\rho\\, u + \\mathcal{O}(u^2) $$\n    这种形式捕捉了对生长因子 $\\rho$ 和单位舍入 $u$ 的线性依赖关系，以及对维度 $n$ 的简化的线性依赖关系。我们接受这个问题给出的这种形式。这个不等式表明，只要生长因子 $\\rho$ 不是过大，GEPP就是范数意义下后向稳定的。\n\n**范数意义下的前向误差界**\n\n给定后向误差关系，我们可以推导出前向误差 $\\frac{\\|\\widehat{x}-x\\|}{\\|x\\|}$ 的一个界。\n\n1.  令 $x$ 为 $Ax=b$ 的精确解，$\\widehat{x}$ 为满足 $(A+\\Delta A)\\widehat{x}=b$ 的计算解。我们假设 $A$ 是可逆的。\n2.  从 $(A+\\Delta A)\\widehat{x}=b$ 出发，我们有 $A\\widehat{x} + \\Delta A \\widehat{x} = b$。代入 $b=Ax$，得到 $A\\widehat{x} + \\Delta A \\widehat{x} = Ax$。\n3.  重新整理得到 $A(\\widehat{x}-x) = -\\Delta A \\widehat{x}$。在等式两边左乘 $A^{-1}$ 得到误差方程：\n    $$ \\widehat{x}-x = -A^{-1} \\Delta A \\widehat{x} $$\n4.  为了将误差表示为相对于 $\\|x\\|$ 的形式，我们在右侧代入 $\\widehat{x} = x + (\\widehat{x}-x)$：\n    $$ \\widehat{x}-x = -A^{-1} \\Delta A (x + (\\widehat{x}-x)) $$\n5.  然后我们求解误差向量 $\\widehat{x}-x$：\n    $$ (\\widehat{x}-x) + A^{-1} \\Delta A (\\widehat{x}-x) = -A^{-1} \\Delta A x $$\n    $$ (I + A^{-1} \\Delta A)(\\widehat{x}-x) = -A^{-1} \\Delta A x $$\n6.  如果扰动足够小，使得 $\\|A^{-1}\\Delta A\\| < 1$，那么矩阵 $(I + A^{-1}\\Delta A)$ 是可逆的。我们可以写成：\n    $$ \\widehat{x}-x = -(I + A^{-1} \\Delta A)^{-1} A^{-1} \\Delta A x $$\n7.  对两边取子乘矩阵范数：\n    $$ \\|\\widehat{x}-x\\| \\le \\|(I + A^{-1} \\Delta A)^{-1}\\| \\|A^{-1}\\| \\|\\Delta A\\| \\|x\\| $$\n8.  使用性质 $\\|(I+B)^{-1}\\| \\le \\frac{1}{1-\\|B\\|}$（对于 $\\|B\\|<1$），该性质可由诺伊曼级数（Neumann series）推得，我们得到：\n    $$ \\|\\widehat{x}-x\\| \\le \\frac{1}{1 - \\|A^{-1}\\Delta A\\|} \\|A^{-1}\\| \\|\\Delta A\\| \\|x\\| $$\n9.  除以 $\\|x\\|$（假设 $x\\neq 0$）：\n    $$ \\frac{\\|\\widehat{x}-x\\|}{\\|x\\|} \\le \\frac{\\|A^{-1}\\| \\|\\Delta A\\|}{1 - \\|A^{-1}\\| \\|\\Delta A\\|} $$\n10. 项 $\\|A^{-1}\\| \\|\\Delta A\\|$ 可以用条件数 $\\kappa(A) = \\|A\\| \\|A^{-1}\\|$ 和相对后向误差 $\\frac{\\|\\Delta A\\|}{\\|A\\|}$ 来表示：\n    $$ \\|A^{-1}\\| \\|\\Delta A\\| = (\\|A\\|\\|A^{-1}\\|) \\left(\\frac{\\|\\Delta A\\|}{\\|A\\|}\\right) = \\kappa(A) \\frac{\\|\\Delta A\\|}{\\|A\\|} $$\n11. 将此式代入不等式，得到最终的前向误差界：\n    $$ \\frac{\\|\\widehat{x} - x\\|}{\\|x\\|} \\le \\frac{\\kappa(A) \\frac{\\|\\Delta A\\|}{\\|A\\|}}{1 - \\kappa(A) \\frac{\\|\\Delta A\\|}{\\|A\\|}} $$\n这个关键结果表明，相对前向误差由条件数与相对后向误差的乘积所控制。如果矩阵是病态的（即 $\\kappa(A)$ 很大），那么一个小的后向误差（在 $\\rho$ 很小的情况下由 GEPP 保证）并不能保证一个小的前向误差。\n\n### 任务 2 和 3：实现与量化\n\n以下 Python 代码实现了 GEPP，用于求解指定矩阵 $W_n$ 的系统 $W_n x = \\mathbf{1}$。它计算了给定测试用例的生长因子 $\\rho$、后向误差 $\\beta$ 和理论前向误差界。", "answer": "```python\nimport numpy as np\n\ndef gepp(A, b):\n    \"\"\"\n    Solves the linear system Ax=b using Gaussian elimination with partial pivoting.\n    \n    Args:\n        A (np.ndarray): The n x n coefficient matrix.\n        b (np.ndarray): The n x 1 right-hand side vector.\n        \n    Returns:\n        tuple: A tuple containing:\n            - np.ndarray: The solution vector x.\n            - float: The observed growth factor rho.\n    \"\"\"\n    n = A.shape[0]\n    # Work on copies to preserve original matrices\n    A_copy = A.astype(np.float64)\n    b_copy = b.astype(np.float64)\n\n    max_abs_A = np.max(np.abs(A_copy))\n    if max_abs_A == 0:\n        # A is a zero matrix, handle as a special case\n        rho = 1.0 # Or undefined. In this problem, A is nonsingular.\n    else:\n        # Keep track of the maximum absolute value seen during elimination\n        max_abs_val_during_elimination = max_abs_A\n\n    # Elimination phase\n    for k in range(n - 1):\n        # Find pivot row (the one with the largest element in the current column)\n        pivot_row_idx = k + np.argmax(np.abs(A_copy[k:, k]))\n        \n        # Swap rows in A and b if necessary\n        if pivot_row_idx != k:\n            A_copy[[k, pivot_row_idx]] = A_copy[[pivot_row_idx, k]]\n            b_copy[[k, pivot_row_idx]] = b_copy[[pivot_row_idx, k]]\n            \n        # Check for singularity\n        if A_copy[k, k] == 0:\n            raise np.linalg.LinAlgError(\"Matrix is singular or near-singular.\")\n\n        # Update rows below the pivot\n        for i in range(k + 1, n):\n            multiplier = A_copy[i, k] / A_copy[k, k]\n            # Store multiplier in the lower-triangular part of A\n            A_copy[i, k] = multiplier\n            # Update the rest of the row\n            A_copy[i, k + 1:] -= multiplier * A_copy[k, k + 1:]\n        \n        # Update the maximum absolute value for growth factor calculation.\n        # This is a key step for tracking rho.\n        current_max = np.max(np.abs(A_copy))\n        if current_max > max_abs_val_during_elimination:\n            max_abs_val_during_elimination = current_max\n\n    if max_abs_A > 0:\n        rho = max_abs_val_during_elimination / max_abs_A\n    \n    # At this point, A_copy contains U in its upper triangle and L (excluding\n    # the main diagonal of 1s) in its strict lower triangle.\n\n    # Forward substitution to solve Ly = b\n    y = np.zeros(n, dtype=np.float64)\n    for i in range(n):\n        y[i] = b_copy[i] - np.dot(A_copy[i, :i], y[:i])\n        \n    # Backward substitution to solve Ux = y\n    x = np.zeros(n, dtype=np.float64)\n    for i in range(n - 1, -1, -1):\n        x[i] = (y[i] - np.dot(A_copy[i, i + 1:], x[i + 1:])) / A_copy[i, i]\n        \n    return x, rho\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and compute the required quantities.\n    \"\"\"\n    test_cases = [2, 5, 10, 15, 20]\n    all_results_str = []\n    \n    # Unit roundoff for double precision (IEEE 754)\n    u = np.finfo(np.float64).eps / 2.0\n    c = 3.0\n    \n    for n in test_cases:\n        # Task 2: Construct the matrix W_n and vector b\n        W_n = np.ones((n, n), dtype=np.float64)\n        # Set j  i entries to -1\n        rows, cols = np.tril_indices(n, k=-1)\n        W_n[rows, cols] = -1.0\n        \n        b = np.ones(n, dtype=np.float64)\n        \n        # Perform GEPP and get solution and growth factor\n        x_hat, rho = gepp(W_n, b)\n        \n        # Task 3: Quantify influence\n        \n        # 1. Observed growth factor rho (already computed)\n        \n        # 2. Theoretical upper bound for rho\n        rho_bound = 2.0**(n - 1)\n        \n        # 3. Ratio rho / 2^(n-1)\n        rho_ratio = rho / rho_bound\n        \n        # 4. Actual relative backward error beta\n        r = b - W_n @ x_hat\n        norm_A_inf = np.linalg.norm(W_n, ord=np.inf)\n        norm_x_hat_inf = np.linalg.norm(x_hat, ord=np.inf)\n        norm_b_inf = np.linalg.norm(b, ord=np.inf)\n        norm_r_inf = np.linalg.norm(r, ord=np.inf)\n        \n        denominator_beta = norm_A_inf * norm_x_hat_inf + norm_b_inf\n        beta = norm_r_inf / denominator_beta if denominator_beta  0 else 0.0\n\n        # 5. Bound proxy c*n*rho*u\n        bound_proxy = c * n * rho * u\n        \n        # 6. Resulting forward error bound\n        # First, compute condition number kappa_inf(A)\n        # Note: In a real application, one would use a condition number estimator\n        # instead of computing the inverse explicitly. For this problem, it's fine.\n        norm_A_inv_inf = np.linalg.norm(np.linalg.inv(W_n), ord=np.inf)\n        kappa_inf = norm_A_inf * norm_A_inv_inf\n        \n        # Use the bound from Task 1\n        rel_back_err_term = kappa_inf * bound_proxy\n        \n        if rel_back_err_term = 1.0:\n            forward_bound = np.inf\n        else:\n            forward_bound = rel_back_err_term / (1.0 - rel_back_err_term)\n            \n        case_results = [\n            rho, \n            rho_bound, \n            rho_ratio, \n            beta, \n            bound_proxy, \n            forward_bound\n        ]\n        all_results_str.append(str(case_results))\n\n    # Print the final output in the specified format\n    print(f\"[{','.join(all_results_str)}]\")\n\nsolve()\n```", "id": "3581484"}]}