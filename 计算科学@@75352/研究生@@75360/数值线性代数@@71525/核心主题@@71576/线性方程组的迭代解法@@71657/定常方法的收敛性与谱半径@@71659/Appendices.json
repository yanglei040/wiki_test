{"hands_on_practices": [{"introduction": "掌握平稳迭代法收敛性分析的第一步是能够为一个给定的线性系统计算其迭代矩阵的谱半径。本练习 [@problem_id:3542428] 将通过一个具体的、对角占优的三对角矩阵，引导你完成构建雅可比（Jacobi）迭代矩阵并精确计算其谱半径的全过程。这个基础计算是理解更复杂收敛理论的基石。", "problem": "考虑线性系统 $A x = b$，其中\n$$\nA = \\begin{pmatrix}\n5  -1  0 \\\\\n-1  5  -1 \\\\\n0  -1  5\n\\end{pmatrix}.\n$$\n矩阵 $A$ 是严格对角占优的。使用将矩阵分解为其对角部分 $D$ 和余项 $R$ 的基本分裂方法，为此系统构建 Jacobi 稳态迭代矩阵，精确计算其特征值，并确定谱半径。仅使用以下基本事实：Jacobi 稳态法是通过分离 $A$ 的对角线并使用固定的线性算子进行迭代得到的；稳态法的收敛性由迭代矩阵的特征值的模（称为谱半径）决定。请将最终答案表示为谱半径的单个闭式解析表达式。无需四舍五入。", "solution": "所述问题是数值线性代数中一个有效且适定的练习。它提供了一个特定的矩阵 $A$，指定了使用 Jacobi 稳态法，并要求计算相应迭代矩阵的谱半径。求解所需的所有数据和定义都已给出且自洽。该问题遵循既定的科学原理，并且可以得到唯一的精确解。\n\n问题是使用稳态迭代法求解线性系统 $A x = b$，其中矩阵 $A$ 由下式给出：\n$$\nA = \\begin{pmatrix}\n5  -1  0 \\\\\n-1  5  -1 \\\\\n0  -1  5\n\\end{pmatrix}\n$$\nJacobi 方法的定义是将矩阵 $A$ 分裂为其对角部分 $D$、严格下三角部分 $-L$ 和严格上三角部分 $-U$。因此，$A = D - L - U$。迭代格式由 $A x = b$ 推导而来，将其重写为 $(D - L - U)x = b$，再整理为 $D x = (L+U)x + b$。\n\n对于一般的迭代步 $k$，这给出了 Jacobi 迭代更新规则：\n$$\nD x^{(k+1)} = (L+U)x^{(k)} + b\n$$\n乘以对角矩阵的逆 $D^{-1}$，我们得到迭代的显式形式：\n$$\nx^{(k+1)} = D^{-1}(L+U)x^{(k)} + D^{-1}b\n$$\n这是一个形式为 $x^{(k+1)} = T x^{(k)} + c$ 的稳态方法，其中迭代矩阵为 $T_J = D^{-1}(L+U)$，常数向量为 $c = D^{-1}b$。该方法的收敛性取决于迭代矩阵 $T_J$ 的谱半径，记为 $\\rho(T_J)$，其定义为其特征值的最大绝对值。当且仅当 $\\rho(T_J)  1$ 时，该方法收敛。\n\n首先，我们将给定矩阵 $A$ 分解为其分量 $D$、$L$ 和 $U$。\n$$\nD = \\begin{pmatrix}\n5  0  0 \\\\\n0  5  0 \\\\\n0  0  5\n\\end{pmatrix}\n$$\n$$\n-L = \\begin{pmatrix}\n0  0  0 \\\\\n-1  0  0 \\\\\n0  -1  0\n\\end{pmatrix} \\implies L = \\begin{pmatrix}\n0  0  0 \\\\\n1  0  0 \\\\\n0  1  0\n\\end{pmatrix}\n$$\n$$\n-U = \\begin{pmatrix}\n0  -1  0 \\\\\n0  0  -1 \\\\\n0  0  0\n\\end{pmatrix} \\implies U = \\begin{pmatrix}\n0  1  0 \\\\\n0  0  1 \\\\\n0  0  0\n\\end{pmatrix}\n$$\n对角矩阵 $D$ 的逆是：\n$$\nD^{-1} = \\begin{pmatrix}\n\\frac{1}{5}  0  0 \\\\\n0  \\frac{1}{5}  0 \\\\\n0  0  \\frac{1}{5}\n\\end{pmatrix} = \\frac{1}{5}I\n$$\n其中 $I$ 是 $3 \\times 3$ 单位矩阵。\n和 $L+U$ 是：\n$$\nL+U = \\begin{pmatrix}\n0  1  0 \\\\\n1  0  1 \\\\\n0  1  0\n\\end{pmatrix}\n$$\n现在，我们构建 Jacobi 迭代矩阵 $T_J = D^{-1}(L+U)$：\n$$\nT_J = \\frac{1}{5} \\begin{pmatrix}\n1  0  0 \\\\\n0  1  0 \\\\\n0  0  1\n\\end{pmatrix}\n\\begin{pmatrix}\n0  1  0 \\\\\n1  0  1 \\\\\n0  1  0\n\\end{pmatrix}\n= \\frac{1}{5} \\begin{pmatrix}\n0  1  0 \\\\\n1  0  1 \\\\\n0  1  0\n\\end{pmatrix}\n= \\begin{pmatrix}\n0  \\frac{1}{5}  0 \\\\\n\\frac{1}{5}  0  \\frac{1}{5} \\\\\n0  \\frac{1}{5}  0\n\\end{pmatrix}\n$$\n为了求 $T_J$ 的谱半径，我们必须计算它的特征值。特征值 $\\lambda$ 是特征方程 $\\det(T_J - \\lambda I) = 0$ 的根。\n$$\n\\det(T_J - \\lambda I) = \\det \\begin{pmatrix}\n-\\lambda  \\frac{1}{5}  0 \\\\\n\\frac{1}{5}  -\\lambda  \\frac{1}{5} \\\\\n0  \\frac{1}{5}  -\\lambda\n\\end{pmatrix} = 0\n$$\n我们沿第一行进行代数余子式展开来计算行列式：\n$$\n-\\lambda \\left| \\begin{matrix} -\\lambda  \\frac{1}{5} \\\\ \\frac{1}{5}  -\\lambda \\end{matrix} \\right| - \\frac{1}{5} \\left| \\begin{matrix} \\frac{1}{5}  \\frac{1}{5} \\\\ 0  -\\lambda \\end{matrix} \\right| + 0 = 0\n$$\n$$\n-\\lambda \\left( (-\\lambda)(-\\lambda) - (\\frac{1}{5})(\\frac{1}{5}) \\right) - \\frac{1}{5} \\left( (\\frac{1}{5})(-\\lambda) - (0)(\\frac{1}{5}) \\right) = 0\n$$\n$$\n-\\lambda \\left( \\lambda^2 - \\frac{1}{25} \\right) - \\frac{1}{5} \\left( -\\frac{\\lambda}{5} \\right) = 0\n$$\n$$\n-\\lambda^3 + \\frac{\\lambda}{25} + \\frac{\\lambda}{25} = 0\n$$\n$$\n-\\lambda^3 + \\frac{2\\lambda}{25} = 0\n$$\n$$\n-\\lambda \\left( \\lambda^2 - \\frac{2}{25} \\right) = 0\n$$\n该方程得出矩阵 $T_J$ 的三个特征值：\n$$\n\\lambda_1 = 0\n$$\n$$\n\\lambda^2 = \\frac{2}{25} \\implies \\lambda_{2,3} = \\pm \\sqrt{\\frac{2}{25}} = \\pm \\frac{\\sqrt{2}}{5}\n$$\n特征值为 $\\lambda_1 = 0$, $\\lambda_2 = \\frac{\\sqrt{2}}{5}$ 和 $\\lambda_3 = -\\frac{\\sqrt{2}}{5}$。\n\n谱半径 $\\rho(T_J)$ 是这些特征值的绝对值（模）的最大值：\n$$\n\\rho(T_J) = \\max \\left\\{ |\\lambda_1|, |\\lambda_2|, |\\lambda_3| \\right\\}\n$$\n$$\n\\rho(T_J) = \\max \\left\\{ |0|, \\left|\\frac{\\sqrt{2}}{5}\\right|, \\left|-\\frac{\\sqrt{2}}{5}\\right| \\right\\}\n$$\n$$\n\\rho(T_J) = \\max \\left\\{ 0, \\frac{\\sqrt{2}}{5}, \\frac{\\sqrt{2}}{5} \\right\\}\n$$\n因此，Jacobi 迭代矩阵的谱半径是 $\\frac{\\sqrt{2}}{5}$。由于 $\\rho(T_J) = \\frac{\\sqrt{2}}{5} \\approx \\frac{1.414}{5} \\approx 0.2828  1$，Jacobi 方法对此系统收敛，这是预料之中的，因为矩阵 $A$ 是严格对角占优的。", "answer": "$$\\boxed{\\frac{\\sqrt{2}}{5}}$$", "id": "3542428"}, {"introduction": "虽然迭代矩阵的范数小于1是收敛的充分条件，但真正的充要条件是谱半径小于1。本练习 [@problem_id:3542458] 通过一系列精心设计的矩阵范例，探讨谱半径 $\\rho(M)$ 与矩阵范数 $\\|M\\|$ 之间的微妙关系，特别是对于非正规矩阵，其范数可能大于1但迭代过程依然收敛。理解这种差异对于在实践中正确评估和解释收敛行为至关重要。", "problem": "考虑用于求解线性方程组的定常迭代法 (SIM)，该方法由递推关系 $x_{k+1} = M x_k + c$ 定义，其中 $M \\in \\mathbb{C}^{n \\times n}$ 是一个固定的迭代矩阵，$c \\in \\mathbb{C}^{n}$ 是一个向量。设误差为 $e_k = x_k - x^\\star$，其中 $x^\\star$ 是满足 $x^\\star = M x^\\star + c$ 的一个不动点。那么有 $e_{k+1} = M e_k$ 和 $e_k = M^k e_0$。根据定义，谱半径 $\\rho(M)$ 为 $\\rho(M) = \\max\\{|\\lambda| : \\lambda \\text{ 是 } M \\text{ 的一个特征值}\\}$，诱导 2-范数 为 $\\|M\\|_2 = \\sup_{\\|x\\|_2 = 1} \\|M x\\|_2$，它等于 $M$ 的最大奇异值。一个基本事实是，对于任何诱导矩阵范数，都有 $\\rho(M) \\le \\|M\\|$，并且对于所有的 $e_0$，有 $e_k \\to 0$ 当且仅当 $\\rho(M)  1$。在实践中，一些停止准则使用 $\\|x_{k+1}-x_k\\|_2$ 或从 $\\|M\\|_2$ 导出的界来推断或估计收敛性。\n\n评估以下关于特定矩阵及相关收敛性评估的选项。选择所有正确的选项。\n\n- 选项 A: 设 $M_A = \\mathrm{diag}\\!\\left(\\tfrac{3}{5}, \\tfrac{4}{5}, -\\tfrac{2}{5}\\right)$。则 $\\|M_A\\|_2  1$ 且 $\\rho(M_A)  1$，并且对于所有初始猜测 $x_0$，SIM 收敛。在这种情况下，使用 $\\|M_A\\|_2$ 的基于范数的压缩论证正确地证明了收敛性。\n\n- 选项 B: 设 $M_B = \\begin{pmatrix} \\tfrac{1}{2}  1 \\\\ 0  \\tfrac{1}{2} \\end{pmatrix}$。则 $\\rho(M_B)  1$ 但 $\\|M_B\\|_2 > 1$，并且对于所有初始猜测 $x_0$，SIM 收敛。形式为“如果 $\\|M\\|_2 > 1$ 则判断为发散”的规则会错误地分类这种情况。此外，对于某些初始误差 $e_0$，序列 $\\|e_k\\|_2$ 和差值 $\\|x_{k+1}-x_k\\|_2$ 可能会先暂时增加然后最终减少，因此基于单调递减的停止准则可能会错误地解释收敛性。\n\n- 选项 C: 设 $M_C = \\begin{pmatrix} 1  1 \\\\ 0  1 \\end{pmatrix}$。SIM 收敛，因为 $\\rho(M_C) = 1$ 而 $\\|M_C\\|_2 = \\sqrt{2} > 1$，在这种情况下，要求 $\\|M\\|_2  1$ 的基于范数的停止准则会错误地拒绝一个收敛的迭代。\n\n- 选项 D: 对于任何诱导矩阵范数 $\\|\\cdot\\|$，条件 $\\|M\\|  1$ 与 $\\rho(M)  1$ 对于所有矩阵 $M \\in \\mathbb{C}^{n \\times n}$ 是等价的。\n\n- 选项 E: 如果 $\\rho(M)  1$，那么对于每个初始误差 $e_0$，误差范数必须是单调非增的，具体来说是 $\\|e_{k+1}\\|_2 \\le \\|e_k\\|_2$ 对于所有 $k \\ge 0$。因此，任何基于 $\\|x_{k+1}-x_k\\|_2$ 单调递减的停止准则都能正确地检测收敛，而没有被误解的风险。\n\n从 A–E 中选择所有正确的选项。", "solution": "在进行解答之前，对问题陈述进行了严格验证。\n\n### 第 1 步：提取已知条件\n- 定常迭代法 (SIM)：$x_{k+1} = M x_k + c$，其中 $M \\in \\mathbb{C}^{n \\times n}$ 是一个固定的迭代矩阵，$c \\in \\mathbb{C}^{n}$ 是一个向量。\n- 误差向量：$e_k = x_k - x^\\star$，其中 $x^\\star$ 是满足 $x^\\star = M x^\\star + c$ 的一个不动点。\n- 误差递推关系：$e_{k+1} = M e_k$ 和 $e_k = M^k e_0$。\n- 谱半径定义：$\\rho(M) = \\max\\{|\\lambda| : \\lambda \\text{ 是 } M \\text{ 的一个特征值}\\}$。\n- 诱导 2-范数定义：$\\|M\\|_2 = \\sup_{\\|x\\|_2 = 1} \\|M x\\|_2$，等于 $M$ 的最大奇异值。\n- 基本事实 1：对于任何诱导矩阵范数，$\\rho(M) \\le \\|M\\|$。\n- 基本事实 2 (收敛准则)：对于所有初始误差 $e_0$，$e_k \\to 0$ 当且仅当 $\\rho(M)  1$。\n\n### 第 2 步：使用提取的已知条件进行验证\n问题陈述是关于数值线性代数中定常迭代法收敛性的标准阐述。所有的定义，如谱半径和诱导 2-范数，都是正确的。所提供的“基本事实”是该领域的基石定理。选项中提出的问题旨在测试对谱半径、矩阵范数以及迭代过程的瞬态和渐近行为之间关系的理解。该问题具有科学依据、是适定的且客观的。它不包含任何矛盾、歧义或不可靠的前提。\n\n### 第 3 步：结论和行动\n问题陈述是有效的。有必要对每个选项进行全面分析。\n\n### 选项分析\n\n**选项 A:**\n设 $M_A = \\mathrm{diag}\\!\\left(\\tfrac{3}{5}, \\tfrac{4}{5}, -\\tfrac{2}{5}\\right)$。\n这是一个对角矩阵，它是正规矩阵（满足 $M M^* = M^* M$ 的矩阵 $M$，其中 $M^*$ 是 $M$ 的共轭转置）的一个特例。\n对角矩阵的特征值是其对角线上的元素：$\\lambda_1 = \\frac{3}{5}$，$\\lambda_2 = \\frac{4}{5}$ 和 $\\lambda_3 = -\\frac{2}{5}$。\n谱半径是特征值模长的最大值：\n$$ \\rho(M_A) = \\max\\left\\{\\left|\\frac{3}{5}\\right|, \\left|\\frac{4}{5}\\right|, \\left|-\\frac{2}{5}\\right|\\right\\} = \\max\\left\\{\\frac{3}{5}, \\frac{4}{5}, \\frac{2}{5}\\right\\} = \\frac{4}{5} $$\n由于 $\\rho(M_A) = \\frac{4}{5}  1$，基本收敛准则保证了对于所有初始猜测 $x_0$，SIM 都是收敛的。\n对于任何正规矩阵，其诱导 2-范数等于其谱半径。因此，\n$$ \\|M_A\\|_2 = \\rho(M_A) = \\frac{4}{5} $$\n因此，我们有 $\\|M_A\\|_2  1$ 且 $\\rho(M_A)  1$，收敛性得到保证。\n基于范数的压缩论证是基于证明迭代是关于某个范数的压缩映射。误差递推关系为 $e_{k+1} = M e_k$。取 2-范数，我们得到：\n$$ \\|e_{k+1}\\|_2 = \\|M_A e_k\\|_2 \\le \\|M_A\\|_2 \\|e_k\\|_2 $$\n由于 $\\|M_A\\|_2 = \\frac{4}{5}  1$，误差范数在每一步都会减小，即 $\\|e_{k+1}\\|_2 \\le \\frac{4}{5} \\|e_k\\|_2$。这直接证明了收敛性并如陈述中所言对其进行了验证。该陈述的所有部分都是一致且正确的。\n\n**选项 A 的结论：正确**\n\n**选项 B:**\n设 $M_B = \\begin{pmatrix} \\tfrac{1}{2}  1 \\\\ 0  \\tfrac{1}{2} \\end{pmatrix}$。\n这是一个上三角矩阵。其特征值是其对角线上的元素：$\\lambda_1 = \\lambda_2 = \\frac{1}{2}$。\n谱半径为 $\\rho(M_B) = \\left|\\frac{1}{2}\\right| = \\frac{1}{2}$。\n由于 $\\rho(M_B)  1$，对于所有初始猜测 $x_0$，SIM 都是收敛的。\n为了求诱导 2-范数，我们计算 $M_B$ 的最大奇异值。奇异值是 $M_B^* M_B$ 特征值的平方根。由于 $M_B$ 是实矩阵，所以 $M_B^* = M_B^T$。\n$$ M_B^T M_B = \\begin{pmatrix} \\tfrac{1}{2}  0 \\\\ 1  \\tfrac{1}{2} \\end{pmatrix} \\begin{pmatrix} \\tfrac{1}{2}  1 \\\\ 0  \\tfrac{1}{2} \\end{pmatrix} = \\begin{pmatrix} \\tfrac{1}{4}  \\tfrac{1}{2} \\\\ \\tfrac{1}{2}  \\tfrac{5}{4} \\end{pmatrix} $$\n$M_B^T M_B$ 的特征值 $\\mu$ 的特征方程是 $\\det(M_B^T M_B - \\mu I) = 0$：\n$$ \\left(\\frac{1}{4} - \\mu\\right)\\left(\\frac{5}{4} - \\mu\\right) - \\frac{1}{4} = 0 \\\\ \\mu^2 - \\frac{6}{4}\\mu + \\frac{5}{16} - \\frac{4}{16} = 0 \\\\ \\mu^2 - \\frac{3}{2}\\mu + \\frac{1}{16} = 0 $$\n最大特征值是 $\\mu_{\\max} = \\frac{\\frac{3}{2} + \\sqrt{\\frac{9}{4} - \\frac{4}{16}}}{2} = \\frac{\\frac{3}{2} + \\sqrt{\\frac{36}{16} - \\frac{4}{16}}}{2} = \\frac{\\frac{3}{2} + \\sqrt{\\frac{32}{16}}}{2} = \\frac{\\frac{3}{2} + \\sqrt{2}}{2} = \\frac{3 + 2\\sqrt{2}}{4}$。\n诱导 2-范数是 $\\|M_B\\|_2 = \\sigma_{\\max} = \\sqrt{\\mu_{\\max}} = \\sqrt{\\frac{3+2\\sqrt{2}}{4}} = \\frac{\\sqrt{(1+\\sqrt{2})^2}}{2} = \\frac{1+\\sqrt{2}}{2}$。\n由于 $\\sqrt{2} \\approx 1.414$，我们有 $\\|M_B\\|_2 \\approx \\frac{1+1.414}{2} = 1.207 > 1$。\n所以，$\\rho(M_B)  1$（收敛）但 $\\|M_B\\|_2 > 1$。如果一个规则在 $\\|M\\|_2 > 1$ 时就判断为发散，那么它确实会错误地分类这种情况。\n因为 $\\|M_B\\|_2 > 1$，存在一个初始误差向量 $e_0$ 使得 $\\|e_1\\|_2 = \\|M_B e_0\\|_2 > \\|e_0\\|_2$。这表明误差范数 $\\|e_k\\|_2$ 可能会暂时增加。这种现象是非正规矩阵的典型特征。\n类似地，考虑差分向量 $\\Delta x_k = x_{k+1}-x_k = (M_B-I)e_k$。那么 $\\Delta x_{k+1} = M_B \\Delta x_k$。这个差分的范数行为与误差范数类似：$\\|\\Delta x_{k+1}\\|_2 = \\|M_B \\Delta x_k\\|_2$。可以选择一个初始猜测，使得 $\\Delta x_0$ 是一个被 $M_B$ 拉伸到最大的向量，从而导致 $\\|\\Delta x_1\\|_2 > \\|\\Delta x_0\\|_2$。因此，基于 $\\|\\Delta x_k\\|_2$ 单调递减的停止准则可能会过早且不正确地终止。\n\n**选项 B 的结论：正确**\n\n**选项 C:**\n设 $M_C = \\begin{pmatrix} 1  1 \\\\ 0  1 \\end{pmatrix}$。\n这是一个特征值为 $\\lambda=1$ 的若尔当块。特征值为 $\\lambda_1 = \\lambda_2 = 1$。\n谱半径为 $\\rho(M_C) = 1$。\n对于*所有*初始条件都收敛的基本准则是 $\\rho(M)  1$。在这里，这个条件被违反了。陈述“SIM 收敛，因为 $\\rho(M_C) = 1$”是错误的。为了证明它发散，我们计算 $M_C$ 的幂。设 $M_C = I+N$，其中 $N=\\begin{pmatrix} 0  1 \\\\ 0  0 \\end{pmatrix}$ 且 $N^2=0$。\n$$ M_C^k = (I+N)^k = I + kN = \\begin{pmatrix} 1  k \\\\ 0  1 \\end{pmatrix} $$\n第 $k$ 步的误差是 $e_k = M_C^k e_0$。\n$$ e_k = \\begin{pmatrix} 1  k \\\\ 0  1 \\end{pmatrix} \\begin{pmatrix} e_{0,1} \\\\ e_{0,2} \\end{pmatrix} = \\begin{pmatrix} e_{0,1} + k e_{0,2} \\\\ e_{0,2} \\end{pmatrix} $$\n为了使 $e_k$ 收敛到零向量，我们需要两个分量都趋于零。第一个分量 $e_{0,1} + k e_{0,2}$，如果 $e_{0,2} \\neq 0$，则会发散到无穷大。因此，该方法对于任意的 $e_0$ 都不收敛。陈述的第一部分是不正确的。\n此外，该陈述声称 $\\|M_C\\|_2 = \\sqrt{2}$。我们来验证一下。\n$$ M_C^T M_C = \\begin{pmatrix} 1  0 \\\\ 1  1 \\end{pmatrix} \\begin{pmatrix} 1  1 \\\\ 0  1 \\end{pmatrix} = \\begin{pmatrix} 1  1 \\\\ 1  2 \\end{pmatrix} $$\n$M_C^T M_C$ 的特征值 $\\mu$ 满足 $(1-\\mu)(2-\\mu)-1 = 0$，即 $\\mu^2-3\\mu+1=0$。\n最大特征值是 $\\mu_{\\max} = \\frac{3+\\sqrt{9-4}}{2} = \\frac{3+\\sqrt{5}}{2}$。\n范数是 $\\|M_C\\|_2 = \\sqrt{\\mu_{\\max}} = \\sqrt{\\frac{3+\\sqrt{5}}{2}} \\approx 1.618$。这不等于 $\\sqrt{2} \\approx 1.414$。\n该陈述提出了两个不正确的断言：一个关于收敛性，另一个关于范数的值。\n\n**选项 C 的结论：不正确**\n\n**选项 D:**\n陈述是：“对于任何诱导矩阵范数 $\\|\\cdot\\|$，条件 $\\|M\\|  1$ 与 $\\rho(M)  1$ 对于所有矩阵 $M \\in \\mathbb{C}^{n \\times n}$ 是等价的。”\n这可以分解为两个蕴含关系：\n1. $\\|M\\|  1 \\implies \\rho(M)  1$。这是正确的，因为对于任何诱导范数，都有基本事实 $\\rho(M) \\le \\|M\\|$。如果 $\\|M\\|  1$，那么 $\\rho(M)$ 也必须小于 $1$。\n2. $\\rho(M)  1 \\implies \\|M\\|  1$。这是错误的。一个“对于任何诱导矩阵范数”的陈述要求它对所有范数都成立。我们从选项 B 中有一个直接的反例。\n对于 $M_B = \\begin{pmatrix} \\tfrac{1}{2}  1 \\\\ 0  \\tfrac{1}{2} \\end{pmatrix}$ 和诱导 2-范数，我们发现 $\\rho(M_B) = \\frac{1}{2}  1$，但 $\\|M_B\\|_2 = \\frac{1+\\sqrt{2}}{2} > 1$。\n由于反向蕴含是错误的，所以等价关系是错误的。\n\n**选项 D 的结论：不正确**\n\n**选项 E:**\n陈述是：“如果 $\\rho(M)  1$，那么对于每个初始误差 $e_0$，误差范数必须是单调非增的，具体来说是 $\\|e_{k+1}\\|_2 \\le \\|e_k\\|_2$ 对于所有 $k \\ge 0$。”\n条件 $\\|e_{k+1}\\|_2 \\le \\|e_k\\|_2$ 等价于 $\\|M e_k\\|_2 \\le \\|e_k\\|_2$。为了使这个条件对*每个* $e_k$（也就是对 $\\mathbb{C}^n$ 中的任何向量）都成立，就需要对所有 $v$ 都有 $\\|M v\\|_2 \\le \\|v\\|_2$。根据定义，这等价于 $\\sup_{\\|v\\|_2=1} \\|M v\\|_2 \\le 1$，即 $\\|M\\|_2 \\le 1$。\n因此，该陈述实际上是在声称 $\\rho(M)  1 \\implies \\|M\\|_2 \\le 1$。\n如选项 B 和 D 的分析所示，这个蕴含关系是错误的。矩阵 $M_B$ 是一个反例，其中 $\\rho(M_B)  1$ 但 $\\|M_B\\|_2 > 1$。对于这个矩阵，存在一个初始误差 $e_0$ 使得 $\\|e_1\\|_2 > \\|e_0\\|_2$，这与单调非增的论断相矛盾。\n第二句话，“因此，任何基于 $\\|x_{k+1}-x_k\\|_2$ 单调递减的停止准则都能正确地检测收敛，而没有被误解的风险”，是从这个错误前提得出的结论。同样如选项 B 的分析所示，即使迭代收敛，量 $\\|x_{k+1}-x_k\\|_2$ 也可能表现出暂时的增长。因此，这个结论也是错误的。\n\n**选项 E 的结论：不正确**", "answer": "$$\\boxed{AB}$$", "id": "3542458"}, {"introduction": "理论告诉我们，即使迭代最终会收敛（即谱半径小于1），非正规矩阵也可能在迭代初期表现出误差的瞬时增长。本计算练习 [@problem_id:3542439] 旨在将这一理论概念转化为可见的数值实验，你将构建具有相同谱但不同正规性的矩阵对，并量化比较它们的收敛动态。通过编程实践，你将直观地感受到非正规性如何影响迭代过程的暂态行为和收敛速度的实际度量。", "problem": "考虑一个应用于线性系统的线性定常迭代方法，其误差传播由递推关系 $e_{k+1} = M e_k$ 描述，其中 $M \\in \\mathbb{C}^{n \\times n}$ 是迭代矩阵。$M$ 的谱半径定义为 $\\rho(M) = \\max \\{ |\\lambda| : \\lambda \\in \\sigma(M) \\}$，其中 $\\sigma(M)$ 表示 $M$ 的谱。如果一个矩阵 $M$ 满足 $M^* M = M M^*$，则称其为正规矩阵，其中 $M^*$ 是共轭转置。矩阵 $A$ 的谱范数 $\\|A\\|_2$ 是 $A$ 的最大奇异值。假设测试时域 $K \\in \\mathbb{N}$，并定义有限时间诱导范数序列为 $a_k(M) = \\|M^k\\|_2$，其中 $k \\in \\{1,2,\\dots,K\\}$。定义有限时间几何速率估计为 $r_k(M) = a_k(M)^{1/k}$，其中 $k \\in \\{1,2,\\dots,K\\}$，以及有限时间超出渐近速率的量为 $\\Delta(M;K) = \\max_{1 \\le k \\le K} \\max\\{0, r_k(M) - \\rho(M) \\}$。定义瞬态增长因子为 $G(M;K) = \\max_{1 \\le k \\le K} a_k(M)$。\n\n您的任务是为下面指定的每个测试用例构建两个迭代矩阵 $M_1$ 和 $M_2$，使得：\n- $M_1$ 是正规矩阵，$M_2$ 是非正规矩阵，并且 $\\sigma(M_1) = \\sigma(M_2)$，\n- 对于 $i \\in \\{1,2\\}$，$\\rho(M_i)  1$。\n\n对于每对 $(M_1, M_2)$，计算并比较：\n- 共同的谱半径 $\\rho = \\rho(M_i)$，\n- 超额速率 $\\Delta(M_1;K)$ 和 $\\Delta(M_2;K)$，\n- 瞬态增长因子 $G(M_1;K)$ 和 $G(M_2;K)$，\n- 以及 $M_1$ 和 $M_2$ 的布尔正规性指示符，该指示符通过条件 $\\|M^*M - MM^*\\|_F \\le \\tau$ 进行数值确定，其中 $\\|\\cdot\\|_F$ 是 Frobenius 范数，$\\tau$ 是一个相对于 $\\|M\\|_F$ 选择的较小数值容差。\n\n每个测试用例的构建要求：\n- 对于具有重复特征值 $\\alpha \\in (-1,1)$ 和大小 $n \\in \\mathbb{N}$ 的测试用例，使用 $M_1 = \\alpha I_n$ 和 $M_2 = J_n(\\alpha)$，其中 $I_n$ 是 $n \\times n$ 单位矩阵，$J_n(\\alpha)$ 是特征值为 $\\alpha$ 的 $n \\times n$ Jordan 块（即，$(J_n(\\alpha))_{ii} = \\alpha$ 且对于 $i \\in \\{1,\\dots,n-1\\}$，$(J_n(\\alpha))_{i,i+1} = 1$，所有其他元素为零）。\n- 对于具有满足 $\\max_i |\\lambda_i|  1$ 的不同特征值 $\\Lambda = (\\lambda_1,\\dots,\\lambda_n)$ 的测试用例，使用 $M_1 = \\mathrm{diag}(\\Lambda)$ 和 $M_2 = V \\, \\mathrm{diag}(\\Lambda) \\, V^{-1}$，其中 $V = I_n + s N$，$N$ 是一个严格上三角矩阵，其主对角线上方的所有元素均为1，其他元素为零，并且 $s  0$ 是给定的标量。\n\n使用以下参数测试套件：\n- 测试用例 1：$(n,\\alpha,K) = (5, 0.9, 50)$。\n- 测试用例 2：$\\Lambda = (0.2, 0.5, 0.8, 0.8)$，$s = 5$，$K = 50$。\n- 测试用例 3：$(n,\\alpha,K) = (6, 0.99, 120)$。\n\n对于每个测试用例，您的程序必须：\n- 按规定构建 $M_1$ 和 $M_2$。\n- 对每个 $M_i$ 进行数值正规性验证并报告结果。\n- 计算 $\\rho$、$\\Delta(M_1;K)$、$\\Delta(M_2;K)$、$G(M_1;K)$ 和 $G(M_2;K)$。\n- 将每个测试用例的结果汇总成一个列表，形式为 $[\\rho, \\Delta(M_1;K), \\Delta(M_2;K), G(M_1;K), G(M_2;K), \\mathrm{is\\_normal}(M_1), \\mathrm{is\\_normal}(M_2)]$。\n\n您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果，其中每个元素对应一个测试用例，格式如上所述，例如 $[[\\cdot],[\\cdot],[\\cdot]]$。不涉及物理单位。所有角度（如果出现）必须以弧度为单位，尽管此任务不涉及角度。所有比率必须以十进制浮点数报告。确保对于给定的尺寸和参数，所有数学计算都是数值稳定的。", "solution": "我们从定常迭代方法的基础开始。一个线性定常方法会产生一个误差递推关系 $e_{k+1} = M e_k$，其中 $M \\in \\mathbb{C}^{n \\times n}$ 是一个固定的迭代矩阵。当且仅当 $\\rho(M)  1$ 时，误差序列才保证收敛到零向量，其中谱半径 $\\rho(M)$ 是 $M$ 的特征值的最大模。误差的渐近衰减率由 $\\rho(M)$ 通过 Gelfand 公式控制，该公式指出，对于任何相容的矩阵范数 $\\|\\cdot\\|$，$\\lim_{k \\to \\infty} \\|M^k\\|^{1/k} = \\rho(M)$。\n\n然而，在进入渐近状态之前，非正规性可能导致显著的瞬态行为。如果一个矩阵 $M$ 满足 $M^* M = M M^*$，则称其为正规矩阵。对于正规矩阵，谱定理意味着 $M$ 是酉可对角化的：$M = U \\Lambda U^*$，其中 $U$ 是酉矩阵，$\\Lambda$ 是对角矩阵。因此，对于任何 $k \\in \\mathbb{N}$，$M^k = U \\Lambda^k U^*$，并且谱范数满足 $\\|M^k\\|_2 = \\|\\Lambda^k\\|_2 = \\max_i |\\lambda_i|^k = \\rho(M)^k$。因此，对于正规矩阵 $M$，有限时间几何速率估计等于渐近速率，即对于所有 $k \\in \\mathbb{N}$，$r_k(M) = \\|M^k\\|_2^{1/k} = \\rho(M)$，并且超额量 $\\Delta(M;K)$ 为零。\n\n相比之下，对于非正规矩阵，即使当 $\\rho(M)  1$ 时，其幂的谱范数也可能在初始阶段增长。这种现象可以通过两个指标来量化：\n- 瞬态增长因子 $G(M;K) = \\max_{1 \\le k \\le K} \\|M^k\\|_2$，它捕捉了在 $K$ 步内谱范数的最大可能放大。\n- 有限时间超额量 $\\Delta(M;K) = \\max_{1 \\le k \\le K} \\max\\{0, \\|M^k\\|_2^{1/k} - \\rho(M)\\}$，它衡量了有限时间内观测到的每步收缩率与渐近速率 $\\rho(M)$ 之间的最大差距。\n\n为了突显非正规性独立于特征值的作用，我们构建具有相同谱但不同正规性属性的矩阵对 $(M_1, M_2)$：\n- 对于具有重复特征值 $\\alpha \\in (-1,1)$ 和大小 $n \\in \\mathbb{N}$ 的情况，选择 $M_1 = \\alpha I_n$（正规）和 $M_2 = J_n(\\alpha)$（单个 Jordan 块，非正规且亏损）。此处，$M_2^k = \\sum_{j=0}^{n-1} \\binom{k}{j} \\alpha^{k-j} N^j$，其中 $N$ 是幂零的超对角位移矩阵，这揭示了可以产生瞬态放大的 $k$ 的多项式因子。\n- 对于具有满足 $\\max_i |\\lambda_i|  1$ 的不同特征值 $\\Lambda = (\\lambda_1,\\dots,\\lambda_n)$ 的情况，选择 $M_1 = \\mathrm{diag}(\\Lambda)$（正规）和 $M_2 = V \\, \\mathrm{diag}(\\Lambda) \\, V^{-1}$，其中 $V = I_n + s N$，$N$ 是严格上三角矩阵，$s > 0$ 是标量（非正规但可对角化）。尽管 $M_2$ 是可对角化的，但 $V$ 的条件数控制着 $\\|M_2^k\\|_2$ 的可能大小，因为 $\\|M_2^k\\|_2 \\le \\kappa_2(V) \\rho(M)^k$，其中 $\\kappa_2(V)$ 是 $V$ 的 2-范数条件数，而大的 $\\kappa_2(V)$ 允许更大的瞬态行为。\n\n每个测试用例的算法设计：\n1. 根据指定规则构建 $M_1$ 和 $M_2$，以确保 $\\sigma(M_1) = \\sigma(M_2)$ 且 $\\rho(M_i)  1$。\n2. 通过 $\\rho = \\max |\\lambda|$（其中 $\\lambda \\in \\sigma(M_1)$）从 $M_1$ 的特征值（根据构造，等效于 $M_2$）计算谱半径 $\\rho$。\n3. 对于从 1 到 $K$ 的 $k$，使用重复乘法迭代计算 $M^k$ 以避免冗余的幂运算。对于每个 $k$，计算 $a_k(M) = \\|M^k\\|_2$ 作为 $M^k$ 的最大奇异值，以及 $r_k(M) = a_k(M)^{1/k}$。\n4. 记录 $G(M;K) = \\max_{1 \\le k \\le K} a_k(M)$ 和 $\\Delta(M;K) = \\max_{1 \\le k \\le K} \\max\\{0, r_k(M) - \\rho\\}$。\n5. 通过评估对易子 $C = M^* M - M M^*$ 的 Frobenius 范数并检查是否 $\\|C\\|_F \\le \\tau$ 来确定数值正规性，其中 $\\tau$ 选择为 $\\tau = 10^{-12} \\cdot (1 + \\|M\\|_F^2)$ 以便根据矩阵大小和元素量级进行缩放。\n\n测试套件及其覆盖范围的基本原理：\n- 测试用例 1，参数为 $(n,\\alpha,K) = (5, 0.9, 50)$，对比了 $M_1 = 0.9 I_5$ 和一个在 0.9 处的 $5 \\times 5$ Jordan 块，展示了相对于正规基线的由亏损性引起的瞬态增长。\n- 测试用例 2，参数为 $\\Lambda = (0.2, 0.5, 0.8, 0.8)$，$s = 5$，$K = 50$，使用了一个由病态相似变换产生的可对角化但非正规的 $M_2$，说明了没有亏损性但有重复可对角化特征值时的瞬态行为。\n- 测试用例 3，参数为 $(n,\\alpha,K) = (6, 0.99, 120)$，探索了稳定阈值附近的边界条件，突出了在保持 $\\rho(M)  1$ 的同时，对于一个更大的 Jordan 块，瞬态现象更为显著且持续时间更长。\n\n预期的定性结果：\n- 对于每个正规矩阵 $M_1$，$G(M_1;K)$ 在 $k=1$ 时应等于 $\\rho^1$，然后单调递减，并且 $\\Delta(M_1;K)$ 在浮点容差范围内应数值上接近于零。\n- 对于非正规矩阵 $M_2$，即使 $\\rho  1$，在适当的参数选择下，$G(M_2;K)$ 也可能超过 1，并且 $\\Delta(M_2;K)$ 应为严格正数，量化了有限时间内观测到的收缩率与渐近速率 $\\rho$ 之间的差距。\n\n该程序实现了这些构建并计算了所要求的指标。最终输出将每个测试用例的列表 $[\\rho, \\Delta(M_1;K), \\Delta(M_2;K), G(M_1;K), G(M_2;K), \\mathrm{is\\_normal}(M_1), \\mathrm{is\\_normal}(M_2)]$ 连接起来，生成一个单行的列表之列表。", "answer": "```python\nimport numpy as np\n\ndef jordan_block(alpha: float, n: int) - np.ndarray:\n    \"\"\"Construct an n x n Jordan block with eigenvalue alpha.\"\"\"\n    J = np.zeros((n, n), dtype=float)\n    for i in range(n):\n        J[i, i] = alpha\n        if i + 1  n:\n            J[i, i + 1] = 1.0\n    return J\n\ndef strictly_upper_ones(n: int) - np.ndarray:\n    \"\"\"Construct an n x n strictly upper triangular matrix with ones above the diagonal.\"\"\"\n    N = np.zeros((n, n), dtype=float)\n    for i in range(n):\n        for j in range(i + 1, n):\n            N[i, j] = 1.0\n    return N\n\ndef is_normal_matrix(M: np.ndarray, tol_scale: float = 1e-12) - bool:\n    \"\"\"Numerically determine if M is normal via Frobenius norm of commutator.\"\"\"\n    MtM = M.conj().T @ M\n    MMt = M @ M.conj().T\n    comm = MtM - MMt\n    norm_comm = np.linalg.norm(comm, ord='fro')\n    norm_M = np.linalg.norm(M, ord='fro')\n    tol = tol_scale * (1.0 + norm_M * norm_M)\n    return norm_comm = tol\n\ndef spectral_radius(M: np.ndarray) - float:\n    \"\"\"Compute spectral radius as max modulus of eigenvalues.\"\"\"\n    eigs = np.linalg.eigvals(M)\n    return float(np.max(np.abs(eigs)))\n\ndef max_singular_value(A: np.ndarray) - float:\n    \"\"\"Compute largest singular value via SVD.\"\"\"\n    s = np.linalg.svd(A, compute_uv=False)\n    return float(s[0]) if s.size  0 else 0.0\n\ndef finite_time_metrics(M: np.ndarray, K: int, rho: float) - tuple[float, float]:\n    \"\"\"\n    Compute:\n    - Delta(M;K) = max_{1..K} max(0, ||M^k||_2^{1/k} - rho)\n    - G(M;K) = max_{1..K} ||M^k||_2\n    \"\"\"\n    P = M.copy()\n    max_delta = 0.0\n    max_growth = 0.0\n    for k in range(1, K + 1):\n        # Norm of M^k\n        ak = max_singular_value(P)\n        if ak  max_growth:\n            max_growth = ak\n        # Geometric rate estimate\n        if ak  0.0:\n            rk = ak ** (1.0 / k)\n            delta = rk - rho\n            if delta  max_delta:\n                max_delta = delta\n        # Update P = M^(k+1)\n        P = P @ M\n    # Ensure nonnegative delta\n    if max_delta  0.0:\n        max_delta = 0.0\n    return max_delta, max_growth\n\ndef build_case_repeated_alpha(n: int, alpha: float, K: int):\n    M1 = alpha * np.eye(n, dtype=float)\n    M2 = jordan_block(alpha, n)\n    return M1, M2, K\n\ndef build_case_distinct_lambdas(lambdas: list[float], s: float, K: int):\n    lambdas = np.array(lambdas, dtype=float)\n    n = lambdas.size\n    M1 = np.diag(lambdas)\n    N = strictly_upper_ones(n)\n    V = np.eye(n, dtype=float) + s * N\n    Vinv = np.linalg.inv(V)\n    M2 = V @ M1 @ Vinv\n    return M1, M2, K\n\ndef solve():\n    # Define the test cases as per the problem statement.\n    test_cases = [\n        (\"repeated_alpha\", {\"n\": 5, \"alpha\": 0.9, \"K\": 50}),\n        (\"distinct_lambdas\", {\"lambdas\": [0.2, 0.5, 0.8, 0.8], \"s\": 5.0, \"K\": 50}),\n        (\"repeated_alpha\", {\"n\": 6, \"alpha\": 0.99, \"K\": 120}),\n    ]\n\n    results = []\n    for case_type, params in test_cases:\n        if case_type == \"repeated_alpha\":\n            n = params[\"n\"]\n            alpha = params[\"alpha\"]\n            K = params[\"K\"]\n            M1, M2, K = build_case_repeated_alpha(n, alpha, K)\n        elif case_type == \"distinct_lambdas\":\n            lambdas = params[\"lambdas\"]\n            s = params[\"s\"]\n            K = params[\"K\"]\n            M1, M2, K = build_case_distinct_lambdas(lambdas, s, K)\n        else:\n            raise ValueError(\"Unknown case type\")\n\n        # Shared spectral radius\n        rho = spectral_radius(M1)\n        # Should match for M2 by construction; we proceed with rho from M1.\n\n        # Metrics for M1 and M2\n        delta1, G1 = finite_time_metrics(M1, K, rho)\n        delta2, G2 = finite_time_metrics(M2, K, rho)\n\n        # Normality checks\n        norm1 = is_normal_matrix(M1)\n        norm2 = is_normal_matrix(M2)\n\n        # Aggregate: [rho, Delta(M1;K), Delta(M2;K), G(M1;K), G(M2;K), is_normal(M1), is_normal(M2)]\n        results.append([\n            rho, float(delta1), float(delta2), float(G1), float(G2), bool(norm1), bool(norm2)\n        ])\n\n    # Final print statement in the exact required format.\n    # Ensure a single line with Python-like list representation.\n    def format_element(x):\n        if isinstance(x, bool):\n            return \"True\" if x else \"False\"\n        elif isinstance(x, float):\n            # Use repr-like formatting to retain precision without excessive digits\n            return str(x)\n        elif isinstance(x, int):\n            return str(x)\n        elif isinstance(x, list):\n            return \"[\" + \",\".join(format_element(y) for y in x) + \"]\"\n        else:\n            return str(x)\n\n    print(\"[\" + \",\".join(format_element(res) for res in results) + \"]\")\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "3542439"}]}