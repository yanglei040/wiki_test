{"hands_on_practices": [{"introduction": "要真正掌握一个算法，最好的方法莫过于亲手实践。这个练习将引导你在一个简单的三维空间中应用经典的Gram-Schmidt过程。通过处理一组线性相关的向量，你不仅将练习该算法的代数步骤，还将加深对其背后几何概念的理解，例如子空间、正交性以及投影[@problem_id:3537535]。", "problem": "考虑实向量空间 $\\mathbb{R}^{3}$，其配备了标准内积 $x \\cdot y = x_{1} y_{1} + x_{2} y_{2} + x_{3} y_{3}$。令 $a_{1} = (1,\\,1,\\,0)$，$a_{2} = (0,\\,1,\\,1)$ 以及 $a_{3} = (1,\\,2,\\,1)$。仅使用内积、向量投影以及经典格拉姆-施密特正交化过程的定义，构造一个生成子空间 $S = \\operatorname{span}\\{a_{1}, a_{2}, a_{3}\\} \\subset \\mathbb{R}^{3}$ 的正交集 $\\{q_{1}, q_{2}\\}$，并证明 $S$ 是 $\\mathbb{R}^{3}$ 的一个真子空间。然后，通过与 $q_{1}$ 和 $q_{2}$ 的内积所表示的条件，刻画所有与 $S$ 正交的向量 $v \\in \\mathbb{R}^{3}$。最后，确定向量 $b = (3,\\,0,\\,1)$ 在正交补 $S^{\\perp}$ 上的正交投影的欧几里得范数的平方。请以一个实数给出最终答案，无需四舍五入。", "solution": "我们从 $\\mathbb{R}^{3}$ 上的标准内积开始，其定义为 $x \\cdot y = \\sum_{i=1}^{3} x_{i} y_{i}$。经典格拉姆-施密特正交化通过从每个向量中迭代地减去其在先前已构造的正交方向上的投影来构造正交向量。\n\n首先，观察到 $a_{3} = a_{1} + a_{2}$。因此，\n$$\nS = \\operatorname{span}\\{a_{1}, a_{2}, a_{3}\\} = \\operatorname{span}\\{a_{1}, a_{2}\\}.\n$$\n由于 $a_{1} = (1,\\,1,\\,0)$ 和 $a_{2} = (0,\\,1,\\,1)$ 是线性无关的（不存在标量 $\\alpha$ 满足 $(1,\\,1,\\,0) = \\alpha(0,\\,1,\\,1)$），子空间 $S$ 的维数为 $2$。因此 $S$ 是 $\\mathbb{R}^{3}$ 的一个真子空间。\n\n我们现在对 $\\{a_{1}, a_{2}\\}$ 应用经典格拉姆-施密特正交化，以生成一个生成 $S$ 的正交集 $\\{q_{1}, q_{2}\\}$。\n\n步骤1：令 $q_{1} = a_{1} = (1,\\,1,\\,0)$。\n\n步骤2：通过从 $a_{2}$ 中减去其在 $q_{1}$ 上的投影来计算 $q_{2}$。$a_{2}$ 在 $q_{1}$ 上的投影是\n$$\n\\operatorname{proj}_{q_{1}}(a_{2}) = \\frac{a_{2} \\cdot q_{1}}{q_{1} \\cdot q_{1}}\\, q_{1}.\n$$\n计算内积：\n$$\na_{2} \\cdot q_{1} = (0)(1) + (1)(1) + (1)(0) = 1, \\quad q_{1} \\cdot q_{1} = (1)^{2} + (1)^{2} + (0)^{2} = 2.\n$$\n因此，\n$$\n\\operatorname{proj}_{q_{1}}(a_{2}) = \\frac{1}{2} q_{1} = \\left(\\frac{1}{2},\\, \\frac{1}{2},\\, 0\\right),\n$$\n并且\n$$\nq_{2} = a_{2} - \\operatorname{proj}_{q_{1}}(a_{2}) = \\left(0,\\,1,\\,1\\right) - \\left(\\frac{1}{2},\\, \\frac{1}{2},\\, 0\\right) = \\left(-\\frac{1}{2},\\, \\frac{1}{2},\\, 1\\right).\n$$\n我们验证其正交性：\n$$\nq_{1} \\cdot q_{2} = (1)\\left(-\\frac{1}{2}\\right) + (1)\\left(\\frac{1}{2}\\right) + (0)(1) = -\\frac{1}{2} + \\frac{1}{2} + 0 = 0.\n$$\n因此，$\\{q_{1}, q_{2}\\}$ 是一个生成 $S$ 的正交集。\n\n接下来，我们刻画 $S^{\\perp}$，即 $S$ 的正交补。根据定义，一个向量 $v \\in \\mathbb{R}^{3}$ 属于 $S^{\\perp}$ 当且仅当 $v$ 与 $S$ 中的每个向量都正交。由于 $\\{q_{1}, q_{2}\\}$ 生成 $S$，这等价于\n$$\nv \\cdot q_{1} = 0 \\quad \\text{和} \\quad v \\cdot q_{2} = 0.\n$$\n设 $v = (x,\\,y,\\,z)$，则条件变为线性方程组\n$$\nx + y + 0 z = 0, \\quad -\\frac{1}{2} x + \\frac{1}{2} y + 1 z = 0.\n$$\n从 $x + y = 0$ 我们得到 $y = -x$。代入第二个方程：\n$$\n-\\frac{1}{2} x + \\frac{1}{2}(-x) + z = 0 \\quad \\Rightarrow \\quad -x + z = 0 \\quad \\Rightarrow \\quad z = x.\n$$\n因此 $v = (x,\\,-x,\\,x) = x(1,\\,-1,\\,1)$。所以，\n$$\nS^{\\perp} = \\operatorname{span}\\{(1,\\,-1,\\,1)\\}.\n$$\n\n最后，我们计算向量 $b = (3,\\,0,\\,1)$ 在 $S^{\\perp}$ 上的正交投影的欧几里得范数的平方。向量 $b$ 在由 $n = (1,\\,-1,\\,1)$ 生成的一维子空间上的正交投影具有形式 $\\alpha n$，其中 $\\alpha$ 的选择使得 $b - \\alpha n$ 与 $n$ 正交。条件 $(b - \\alpha n) \\cdot n = 0$ 得出\n$$\nb \\cdot n - \\alpha (n \\cdot n) = 0 \\quad \\Rightarrow \\quad \\alpha = \\frac{b \\cdot n}{n \\cdot n}.\n$$\n计算\n$$\nb \\cdot n = (3)(1) + (0)(-1) + (1)(1) = 4, \\quad n \\cdot n = (1)^{2} + (-1)^{2} + (1)^{2} = 3.\n$$\n因此投影是 $\\alpha n$，其中 $\\alpha = \\frac{4}{3}$，其欧几里得范数的平方是\n$$\n\\|\\alpha n\\|^{2} = \\alpha^{2} \\|n\\|^{2} = \\left(\\frac{4}{3}\\right)^{2} \\cdot 3 = \\frac{16}{9} \\cdot 3 = \\frac{16}{3}.\n$$\n因此，向量 $b$ 在 $S^{\\perp}$ 上的正交投影的范数的平方是 $\\frac{16}{3}$。", "answer": "$$\\boxed{\\frac{16}{3}}$$", "id": "3537535"}, {"introduction": "在掌握了基本流程后，我们来探讨经典Gram-Schmidt过程一个更微妙的特性。这个练习将通过一个具体的二维例子，展示仅仅交换输入矩阵的两列就会改变最终的 $Q$ 和 $R$ 矩阵。这揭示了该算法的“路径依赖性”，帮助你理解为何对同一组向量进行正交化，其结果并非唯一，这对于理解更高级的算法（如带列主元的QR分解）至关重要[@problem_id:3537517]。", "problem": "设矩阵 $A \\in \\mathbb{R}^{2 \\times 2}$ 的列向量为 $a_{1}$ 和 $a_{2}$，由下式给出\n$$\nA \\;=\\; \\begin{pmatrix}\n1  1 \\\\\n1  0\n\\end{pmatrix}\n\\;=\\; \\bigl[\\, a_{1} \\;\\; a_{2} \\,\\bigr], \\quad a_{1} \\;=\\; \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}, \\quad a_{2} \\;=\\; \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}.\n$$\n设 $P \\in \\mathbb{R}^{2 \\times 2}$ 是交换两列的置换矩阵，即\n$$\nP \\;=\\; \\begin{pmatrix}\n0  1 \\\\\n1  0\n\\end{pmatrix},\n\\quad \\text{使得} \\quad AP \\;=\\; \\bigl[\\, a_{2} \\;\\; a_{1} \\,\\bigr] \\;=\\; \\begin{pmatrix}\n1  1 \\\\\n0  1\n\\end{pmatrix}.\n$$\n使用经典的格拉姆-施密特 (CGS) 过程和欧几里得内积作为基本方法，计算正交-三角 (QR) 分解\n$$\nA \\;=\\; Q_{A} R_{A}, \\qquad AP \\;=\\; Q_{AP} R_{AP},\n$$\n其中 $Q_{A}, Q_{AP} \\in \\mathbb{R}^{2 \\times 2}$ 具有标准正交列，而 $R_{A}, R_{AP} \\in \\mathbb{R}^{2 \\times 2}$ 是具有正对角线元的上三角矩阵。通过从第一性原理出发执行 CGS，明确证明置换列会改变 $R$ 因子，即 $R_{A} \\neq R_{AP}$。然后，给出一个几何解释（在由列向量张成的平面内），说明为什么标准正交因子 $Q$ 在列置换下也会发生变化。\n\n最后，为了量化三角因子的变化，计算它们差的弗罗贝尼乌斯范数，\n$$\n\\bigl\\| R_{A} \\;-\\; R_{AP} \\bigr\\|_{F},\n$$\n并将此值以精确的封闭形式（无四舍五入）报告为您的最终答案。", "solution": "**$A = Q_A R_A$ 的 QR 分解**\n我们对矩阵 $A$ 的列向量 $a_1 = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$ 和 $a_2 = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$ 应用经典的格拉姆-施密特过程。设 $Q_A$ 的标准正交列为 $q_1$ 和 $q_2$。\n\n1.  **处理第一列 $a_1$：**\n    第一个正交向量是 $v_1 = a_1 = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$。\n    $R_A$ 的第一个对角线元是 $r_{11} = \\|v_1\\| = \\sqrt{1^2 + 1^2} = \\sqrt{2}$。因为 $r_{11}$ 必须为正，所以这是正确的。\n    第一个标准正交向量是 $q_1 = \\frac{v_1}{r_{11}} = \\frac{1}{\\sqrt{2}}\\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$。\n\n2.  **处理第二列 $a_2$：**\n    $R_A$ 的非对角线元通过将 $a_2$ 投影到 $q_1$ 上得到：$r_{12} = q_1^T a_2 = \\frac{1}{\\sqrt{2}}\\begin{pmatrix} 1  1 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} = \\frac{1}{\\sqrt{2}}$。\n    第二个正交向量是 $a_2$ 中与 $q_1$ 正交的分量：$v_2 = a_2 - r_{12} q_1 = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} - \\frac{1}{\\sqrt{2}} \\left( \\frac{1}{\\sqrt{2}}\\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} \\right) = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} - \\begin{pmatrix} 1/2 \\\\ 1/2 \\end{pmatrix} = \\begin{pmatrix} 1/2 \\\\ -1/2 \\end{pmatrix}$。\n    $R_A$ 的第二个对角线元是 $r_{22} = \\|v_2\\| = \\sqrt{(1/2)^2 + (-1/2)^2} = \\sqrt{1/4 + 1/4} = \\sqrt{1/2} = \\frac{1}{\\sqrt{2}}$。根据要求，这个值是正的。\n    第二个标准正交向量是 $q_2 = \\frac{v_2}{r_{22}} = \\frac{1}{1/\\sqrt{2}}\\begin{pmatrix} 1/2 \\\\ -1/2 \\end{pmatrix} = \\sqrt{2}\\begin{pmatrix} 1/2 \\\\ -1/2 \\end{pmatrix} = \\frac{1}{\\sqrt{2}}\\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix}$。\n\n得到的因子是：\n$Q_A = [q_1 \\;\\; q_2] = \\frac{1}{\\sqrt{2}}\\begin{pmatrix} 1  1 \\\\ 1  -1 \\end{pmatrix}$ 和 $R_A = \\begin{pmatrix} r_{11}  r_{12} \\\\ 0  r_{22} \\end{pmatrix} = \\begin{pmatrix} \\sqrt{2}  \\frac{1}{\\sqrt{2}} \\\\ 0  \\frac{1}{\\sqrt{2}} \\end{pmatrix}$。\n\n**$AP = Q_{AP} R_{AP}$ 的 QR 分解**\n我们对矩阵 $AP$ 的列向量 $a'_1 = a_2 = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$ 和 $a'_2 = a_1 = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$ 应用 CGS 过程。设 $Q_{AP}$ 的标准正交列为 $q'_1$ 和 $q'_2$。\n\n1.  **处理第一列 $a'_1$：**\n    第一个正交向量是 $v'_1 = a'_1 = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$。\n    $R_{AP}$ 的第一个对角线元是 $r'_{11} = \\|v'_1\\| = \\sqrt{1^2 + 0^2} = 1$。这个值是正的。\n    第一个标准正交向量是 $q'_1 = \\frac{v'_1}{r'_{11}} = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$。\n\n2.  **处理第二列 $a'_2$：**\n    $R_{AP}$ 的非对角线元是 $r'_{12} = q'_1{}^T a'_2 = \\begin{pmatrix} 1  0 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} = 1$。\n    第二个正交向量是 $v'_2 = a'_2 - r'_{12} q'_1 = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} - 1 \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}$。\n    $R_{AP}$ 的第二个对角线元是 $r'_{22} = \\|v'_2\\| = \\sqrt{0^2 + 1^2} = 1$。这个值是正的。\n    第二个标准正交向量是 $q'_2 = \\frac{v'_2}{r'_{22}} = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}$。\n\n得到的因子是：\n$Q_{AP} = [q'_1 \\;\\; q'_2] = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} = I$ 和 $R_{AP} = \\begin{pmatrix} r'_{11}  r'_{12} \\\\ 0  r'_{22} \\end{pmatrix} = \\begin{pmatrix} 1  1 \\\\ 0  1 \\end{pmatrix}$。\n\n**比较与解释**\n通过直接比较，$R_A = \\begin{pmatrix} \\sqrt{2}  \\frac{1}{\\sqrt{2}} \\\\ 0  \\frac{1}{\\sqrt{2}} \\end{pmatrix} \\neq \\begin{pmatrix} 1  1 \\\\ 0  1 \\end{pmatrix} = R_{AP}$。CGS 过程明确地表明，置换列会改变 $R$ 因子。\n\n关于 $Q$ 因子为何也会改变的几何解释根植于格拉姆-施密特算法的顺序性。$Q$ 矩阵的第一列 $q_1$ 被构造成与输入矩阵第一列方向相同的单位向量。\n- 对于矩阵 $A$，第一列是 $a_1 = (1, 1)^T$。因此，$q_{A,1}$ 是 $(1, 1)^T$ 方向上的单位向量，即 $q_{A,1} = (1/\\sqrt{2}, 1/\\sqrt{2})^T$。\n- 对于矩阵 $AP$，第一列是 $a_2 = (1, 0)^T$。因此，$q_{AP,1}$ 是 $(1, 0)^T$ 方向上的单位向量，即 $q_{AP,1} = (1, 0)^T$。\n由于初始向量 $a_1$ 和 $a_2$ 不共线，所以第一个标准正交向量 $q_{A,1}$ 和 $q_{AP,1}$ 指向不同的方向。由于 $Q_A$ 和 $Q_{AP}$ 的第一列不同，这两个矩阵本身也必定不同，即 $Q_A \\neq Q_{AP}$。在 CGS 中，第一个向量的选择决定了整个最终生成的标准正交基的方向。每个后续的基向量 $q_k$ 都是在前序向量 $q_1, \\ldots, q_{k-1}$ 所确定的空间内构建的。不同的起始点会导致不同的最终基，尽管两个基都张成相同的列空间。\n\n**弗罗贝尼乌斯范数计算**\n为了量化三角因子的变化，我们计算差值 $D = R_A - R_{AP}$ 的弗罗贝尼乌斯范数。\n$$\nD = R_A - R_{AP} = \\begin{pmatrix} \\sqrt{2}  \\frac{1}{\\sqrt{2}} \\\\ 0  \\frac{1}{\\sqrt{2}} \\end{pmatrix} - \\begin{pmatrix} 1  1 \\\\ 0  1 \\end{pmatrix} = \\begin{pmatrix} \\sqrt{2} - 1  \\frac{1}{\\sqrt{2}} - 1 \\\\ 0  \\frac{1}{\\sqrt{2}} - 1 \\end{pmatrix}.\n$$\n弗罗贝尼乌斯范数的定义为 $\\|D\\|_F = \\sqrt{\\sum_{i,j} |d_{ij}|^2}$。\n$$\n\\|D\\|_F^2 = (\\sqrt{2} - 1)^2 + \\left(\\frac{1}{\\sqrt{2}} - 1\\right)^2 + 0^2 + \\left(\\frac{1}{\\sqrt{2}} - 1\\right)^2\n$$\n我们计算平方项：\n$$\n(\\sqrt{2} - 1)^2 = 2 - 2\\sqrt{2} + 1 = 3 - 2\\sqrt{2}\n$$\n$$\n\\left(\\frac{1}{\\sqrt{2}} - 1\\right)^2 = \\left(\\frac{1- \\sqrt{2}}{\\sqrt{2}}\\right)^2 = \\frac{1 - 2\\sqrt{2} + 2}{2} = \\frac{3 - 2\\sqrt{2}}{2} = \\frac{3}{2} - \\sqrt{2}\n$$\n将各元素的平方求和：\n$$\n\\|D\\|_F^2 = (3 - 2\\sqrt{2}) + 2\\left(\\frac{3}{2} - \\sqrt{2}\\right) = 3 - 2\\sqrt{2} + 3 - 2\\sqrt{2} = 6 - 4\\sqrt{2}\n$$\n弗罗贝尼乌斯范数是此值的平方根：\n$$\n\\| R_{A} - R_{AP} \\|_{F} = \\sqrt{6 - 4\\sqrt{2}}\n$$\n这个嵌套根式可以化简。我们寻找 $x, y$ 使得 $(x-y)^2 = 6 - 4\\sqrt{2}$。由于 $4\\sqrt{2} = \\sqrt{32}$，我们有 $\\sqrt{6-\\sqrt{32}}$。使用去嵌套公式 $\\sqrt{X \\pm \\sqrt{Y}} = \\sqrt{\\frac{X+\\sqrt{X^2-Y}}{2}} \\pm \\sqrt{\\frac{X-\\sqrt{X^2-Y}}{2}}$，其中 $X=6$ 且 $Y=32$，我们得到 $X^2-Y = 36-32=4$。\n$$\n\\sqrt{6 - \\sqrt{32}} = \\sqrt{\\frac{6+\\sqrt{4}}{2}} - \\sqrt{\\frac{6-\\sqrt{4}}{2}} = \\sqrt{\\frac{6+2}{2}} - \\sqrt{\\frac{6-2}{2}} = \\sqrt{4} - \\sqrt{2} = 2 - \\sqrt{2}.\n$$\n作为检验，$(2-\\sqrt{2})^2 = 4 - 4\\sqrt{2} + 2 = 6 - 4\\sqrt{2}$。化简是正确的。\n\n最终答案是 $2 - \\sqrt{2}$。", "answer": "$$\n\\boxed{2 - \\sqrt{2}}\n$$", "id": "3537517"}, {"introduction": "这个高级练习将深入探讨经典Gram-Schmidt算法在实际计算中的核心弱点：数值不稳定性。请注意，这是一个基于假设性场景的思维实验，旨在阐明一个关键概念。通过在一个简化的3位有效数字浮点模型下执行计算，你将亲身体验舍入误差如何累积并导致正交性的严重损失[@problem_id:3537544]。这个过程不仅揭示了为何在实际应用中通常会选择改进版的Gram-Schmidt算法，也挑战了一个看似合理但并不可靠的列排序启发式策略。", "problem": "设 $A \\in \\mathbb{R}^{m \\times n}$ 是列满秩矩阵。在精确算术中，对 $A$ 的各列应用经典格拉姆-施密特 (CGS) 过程，会产生一个具有标准正交列的矩阵 $Q \\in \\mathbb{R}^{m \\times n}$ 和一个上三角矩阵 $R \\in \\mathbb{R}^{n \\times n}$，使得 $A = Q R$，因此 $Q^{\\top} Q = I$。然而，在浮点算术中，内积和投影中的舍入会引起正交性的损失，这种损失可以用弗罗贝尼乌斯范数 $\\|Q^{\\top} Q - I\\|_{F}$ 来量化。一种自然的列排序启发式方法是按其欧几里得范数的非递增顺序（即最大的2-范数优先）来处理各列。考虑以下有限精度模型和矩阵：\n- 算术模型：基数为10的浮点算术，每次基本运算（乘法、加法、除法和平方根）都四舍五入到3位有效数字，平局时采用“舍入到偶数”规则。内积通过按给定顺序对乘积进行朴素求和来计算，每次乘法和每次加法后都应用相同的舍入规则。归一化通过计算范数 $\\|v\\|$（通过舍入的内积和平方根）来设置 $q = v / \\|v\\|$，然后逐分量相除并进行舍入。\n- 矩阵 $A \\in \\mathbb{R}^{2 \\times 2}$，其列 $a_{1}$ 和 $a_{2}$ 如下：\n$$\na_{1} = \\begin{pmatrix} 1.00 \\\\ 1.00 \\end{pmatrix}, \\qquad a_{2} = \\begin{pmatrix} 1.00 \\\\ 1.01 \\end{pmatrix}.\n$$\n任务：\n1. 仅使用CGS的基本定义和所述的浮点模型，从第一性原理出发，解释列的顺序如何影响投影步骤中舍入误差的累积，并从而影响 $\\|Q^{\\top} Q - I\\|_{F}$。\n2. 在所述算术模型下执行两次CGS：\n   - 首先使用最大范数优先 (LNF) 排序 $(a_{2}, a_{1})$。\n   - 然后使用最小范数优先 (SNF) 排序 $(a_{1}, a_{2})$。\n   在每次运行中，计算CGS产生的舍入后的 $Q$，然后使用计算出的 $Q$ 在实数算术中评估 $Q^{\\top} Q - I$ 的精确弗罗贝尼乌斯范数。\n3. 设 $E_{\\mathrm{LNF}} = \\|Q_{\\mathrm{LNF}}^{\\top} Q_{\\mathrm{LNF}} - I\\|_{F}$ 和 $E_{\\mathrm{SNF}} = \\|Q_{\\mathrm{SNF}}^{\\top} Q_{\\mathrm{SNF}} - I\\|_{F}$。报告比率\n$$\nR \\;=\\; \\frac{E_{\\mathrm{LNF}}}{E_{\\mathrm{SNF}}}.\n$$\n将最终的 $R$ 值四舍五入到四位有效数字。最终答案必须是 $R$ 的单个舍入值。", "solution": "设 $\\mathrm{fl}(\\cdot)$ 表示使用指定模型舍入到3位有效数字的操作。\n\n**1. 列排序对舍入误差的影响**\n\n经典格拉姆-施密特 (CGS) 过程为由一组线性无关向量 $\\{a_1, a_2, \\dots, a_n\\}$ 张成的空间构造一个标准正交基 $\\{q_1, q_2, \\dots, q_n\\}$。该算法的核心是一系列投影。对于每个向量 $a_k$，我们减去它在先前计算出的标准正交向量 $\\{q_1, \\dots, q_{k-1}\\}$ 所张成的子空间上的投影：\n$$\nv_k = a_k - \\sum_{j=1}^{k-1} \\mathrm{proj}_{q_j}(a_k) = a_k - \\sum_{j=1}^{k-1} \\langle q_j, a_k \\rangle q_j\n$$\n然后将得到的向量 $v_k$ 归一化：$q_k = v_k / \\|v_k\\|_2$。\n\n在浮点算术中，误差在每一步都会累积。一个主要的误差来源是相减抵消。当向量 $a_k$ 与前面的向量 $\\{a_1, \\dots, a_{k-1}\\}$ 近似线性相关时，在计算 $v_k$ 期间就会发生这种情况。在这种情况下，投影 $\\sum \\langle q_j, a_k \\rangle q_j$ 是 $a_k$ 的一个非常接近的近似值。减法 $a_k - (\\text{投影})$ 产生一个其大小远小于 $a_k$ 的向量 $v_k$。这种首位有效数字的抵消导致计算出的 $v_k$ 分量发生灾难性的相对精度损失。\n\n由此计算出的向量 $\\hat{q}_k$ 将会失去与先前向量 $\\hat{q}_j$ ($j  k$) 的正交性。误差分析的一个标准结果表明，正交性的损失近似地由以下公式界定：\n$$\n|\\hat{q}_k^{\\top} \\hat{q}_j| \\approx \\epsilon \\frac{\\|a_k\\|_2}{\\|v_k\\|_2}\n$$\n其中 $\\epsilon$ 是机器精度。项 $\\|v_k\\|_2$ 是 $a_k$ 正交于由 $\\{q_1, \\dots, q_{k-1}\\}$ 张成的子空间的那个分量的大小。如果 $a_k$ 几乎在该子空间内，则 $\\|v_k\\|_2$ 很小，比率 $\\|a_k\\|_2 / \\|v_k\\|_2$ 很大，导致正交性的显著损失。\n\n列排序决定了过程中使用的向量序列 $\\{a_k\\}$。不同的排序会导致每一步产生不同的中间子空间和不同的向量 $v_k$。因此，$\\|v_k\\|_2$ 的大小和相减抵消的严重程度直接取决于排序。一个好的排序启发式方法，如带列主元的QR分解，会选择下一个 $a_k$ 为与当前子空间“最”正交的向量，从而最大化 $\\|v_k\\|_2$ 并最小化正交性损失。最大范数优先 (LNF) 启发式方法是这个思想的一个更简单、鲁棒性较差的代理，但正如本问题所示，它不保证是最优的，而且舍入中的细微差异可能导致违反直觉的结果。\n\n**2. 浮点算术中的CGS计算**\n\n我们现在使用给定的3位有效数字浮点模型，对两种指定的列排序执行CGS过程。\n\n**最大范数优先 (LNF) 排序： $(a_{2}, a_{1})$**\n\n设待处理的列为 $a'_1 = a_2 = \\begin{pmatrix} 1.00 \\\\ 1.01 \\end{pmatrix}$ 和 $a'_2 = a_1 = \\begin{pmatrix} 1.00 \\\\ 1.00 \\end{pmatrix}$。\n\n*   **第1步：处理 $a'_1$**\n    第一个向量是 $v_1 = a'_1$。我们计算它的范数。\n    内积是 $\\langle v_1, v_1 \\rangle = (1.00)^2 + (1.01)^2$。\n    $\\mathrm{fl}(\\langle v_1, v_1 \\rangle) = \\mathrm{fl}(\\mathrm{fl}(1.00 \\times 1.00) + \\mathrm{fl}(1.01 \\times 1.01)) = \\mathrm{fl}(1.00 + \\mathrm{fl}(1.0201)) = \\mathrm{fl}(1.00 + 1.02) = 2.02$。\n    范数为 $\\|v_1\\|_2 = \\mathrm{fl}(\\sqrt{2.02}) = \\mathrm{fl}(1.421267...) = 1.42$。\n    归一化得到 $q_1$：\n    $q_{1,1} = \\mathrm{fl}(1.00 / 1.42) = \\mathrm{fl}(0.704225...) = 0.704$。\n    $q_{1,2} = \\mathrm{fl}(1.01 / 1.42) = \\mathrm{fl}(0.711267...) = 0.711$。\n    所以，$q_1 = \\begin{pmatrix} 0.704 \\\\ 0.711 \\end{pmatrix}$。\n\n*   **第2步：处理 $a'_2$**\n    计算 $r_{12} = \\langle q_1, a'_2 \\rangle$。\n    $r_{12} = \\mathrm{fl}(\\mathrm{fl}(0.704 \\times 1.00) + \\mathrm{fl}(0.711 \\times 1.00)) = \\mathrm{fl}(0.704 + 0.711) = \\mathrm{fl}(1.415)$。这是一个平局情况（恰好在 $1.41$ 和 $1.42$ 的中间）。我们舍入到最近的偶数末位，即 $1.42$。所以，$r_{12} = 1.42$。\n    计算投影项 $\\mathrm{fl}(r_{12} q_1)$：\n    分量1：$\\mathrm{fl}(1.42 \\times 0.704) = \\mathrm{fl}(0.99968) = 1.00$。\n    分量2：$\\mathrm{fl}(1.42 \\times 0.711) = \\mathrm{fl}(1.00962) = 1.01$。\n    计算 $v_2 = \\mathrm{fl}(a'_2 - \\mathrm{fl}(r_{12} q_1))$：\n    $v_2 = \\mathrm{fl}\\left(\\begin{pmatrix} 1.00 \\\\ 1.00 \\end{pmatrix} - \\begin{pmatrix} 1.00 \\\\ 1.01 \\end{pmatrix}\\right) = \\mathrm{fl}\\left(\\begin{pmatrix} 0.00 \\\\ -0.01 \\end{pmatrix}\\right) = \\begin{pmatrix} 0.00 \\\\ -0.0100 \\end{pmatrix}$。\n    计算范数 $\\|v_2\\|_2$：\n    $\\mathrm{fl}(\\langle v_2, v_2 \\rangle) = \\mathrm{fl}(\\mathrm{fl}(0^2) + \\mathrm{fl}((-0.0100)^2)) = \\mathrm{fl}(0 + \\mathrm{fl}(0.0001)) = \\mathrm{fl}(1.00 \\times 10^{-4}) = 1.00 \\times 10^{-4}$。\n    $\\|v_2\\|_2 = \\mathrm{fl}(\\sqrt{1.00 \\times 10^{-4}}) = \\mathrm{fl}(1.00 \\times 10^{-2}) = 0.0100$。\n    归一化得到 $q_2$：\n    $q_{2,1} = \\mathrm{fl}(0.00 / 0.0100) = 0.00$。\n    $q_{2,2} = \\mathrm{fl}(-0.0100 / 0.0100) = \\mathrm{fl}(-1.00) = -1.00$。\n    所以，$q_2 = \\begin{pmatrix} 0.00 \\\\ -1.00 \\end{pmatrix}$。\n\n因此，LNF排序得到的矩阵是 $Q_{\\mathrm{LNF}} = \\begin{pmatrix} 0.704  0.00 \\\\ 0.711  -1.00 \\end{pmatrix}$。\n\n**最小范数优先 (SNF) 排序： $(a_{1}, a_{2})$**\n\n设待处理的列为 $a'_1 = a_1 = \\begin{pmatrix} 1.00 \\\\ 1.00 \\end{pmatrix}$ 和 $a'_2 = a_2 = \\begin{pmatrix} 1.00 \\\\ 1.01 \\end{pmatrix}$。\n\n*   **第1步：处理 $a'_1$**\n    $v_1 = a'_1$。我们计算它的范数。\n    $\\mathrm{fl}(\\langle v_1, v_1 \\rangle) = \\mathrm{fl}(\\mathrm{fl}(1.00 \\times 1.00) + \\mathrm{fl}(1.00 \\times 1.00)) = \\mathrm{fl}(1.00 + 1.00) = 2.00$。\n    $\\|v_1\\|_2 = \\mathrm{fl}(\\sqrt{2.00}) = \\mathrm{fl}(1.41421...) = 1.41$。\n    归一化得到 $q_1$：\n    $q_{1,1} = \\mathrm{fl}(1.00 / 1.41) = \\mathrm{fl}(0.709219...) = 0.709$。\n    $q_{1,2} = \\mathrm{fl}(1.00 / 1.41) = \\mathrm{fl}(0.709219...) = 0.709$。\n    所以，$q_1 = \\begin{pmatrix} 0.709 \\\\ 0.709 \\end{pmatrix}$。\n\n*   **第2步：处理 $a'_2$**\n    计算 $r_{12} = \\langle q_1, a'_2 \\rangle$。\n    $r_{12} = \\mathrm{fl}(\\mathrm{fl}(0.709 \\times 1.00) + \\mathrm{fl}(0.709 \\times 1.01)) = \\mathrm{fl}(0.709 + \\mathrm{fl}(0.71609)) = \\mathrm{fl}(0.709 + 0.716) = \\mathrm{fl}(1.425)$。这是一个平局情况。我们舍入到最近的偶数末位，即 $1.42$。所以，$r_{12} = 1.42$。\n    计算投影项 $\\mathrm{fl}(r_{12} q_1)$：\n    分量1：$\\mathrm{fl}(1.42 \\times 0.709) = \\mathrm{fl}(1.00678) = 1.01$。\n    分量2：$\\mathrm{fl}(1.42 \\times 0.709) = \\mathrm{fl}(1.00678) = 1.01$。\n    计算 $v_2 = \\mathrm{fl}(a'_2 - \\mathrm{fl}(r_{12} q_1))$：\n    $v_2 = \\mathrm{fl}\\left(\\begin{pmatrix} 1.00 \\\\ 1.01 \\end{pmatrix} - \\begin{pmatrix} 1.01 \\\\ 1.01 \\end{pmatrix}\\right) = \\mathrm{fl}\\left(\\begin{pmatrix} -0.01 \\\\ 0.00 \\end{pmatrix}\\right) = \\begin{pmatrix} -0.0100 \\\\ 0.00 \\end{pmatrix}$。\n    计算范数 $\\|v_2\\|_2$：\n    $\\mathrm{fl}(\\langle v_2, v_2 \\rangle) = \\mathrm{fl}(\\mathrm{fl}((-0.0100)^2) + \\mathrm{fl}(0^2)) = 1.00 \\times 10^{-4}$。\n    $\\|v_2\\|_2 = \\mathrm{fl}(\\sqrt{1.00 \\times 10^{-4}}) = 0.0100$。\n    归一化得到 $q_2$：\n    $q_{2,1} = \\mathrm{fl}(-0.0100 / 0.0100) = -1.00$。\n    $q_{2,2} = \\mathrm{fl}(0.00 / 0.0100) = 0.00$。\n    所以，$q_2 = \\begin{pmatrix} -1.00 \\\\ 0.00 \\end{pmatrix}$。\n\n因此，SNF排序得到的矩阵是 $Q_{\\mathrm{SNF}} = \\begin{pmatrix} 0.709  -1.00 \\\\ 0.709  0.00 \\end{pmatrix}$。\n\n**3. 误差计算与比率**\n\n我们在精确算术中计算误差矩阵 $E = Q^{\\top} Q - I$ 及其弗罗贝尼乌斯范数 $\\|E\\|_F = \\sqrt{\\sum_{i,j} E_{ij}^2}$。\n\n*   **LNF的误差：**\n    $Q_{\\mathrm{LNF}} = \\begin{pmatrix} 0.704  0.00 \\\\ 0.711  -1.00 \\end{pmatrix}$。\n    $Q_{\\mathrm{LNF}}^{\\top} Q_{\\mathrm{LNF}} = \\begin{pmatrix} 0.704  0.711 \\\\ 0.00  -1.00 \\end{pmatrix} \\begin{pmatrix} 0.704  0.00 \\\\ 0.711  -1.00 \\end{pmatrix} = \\begin{pmatrix} 0.704^2 + 0.711^2  -0.711 \\\\ -0.711  (-1.00)^2 \\end{pmatrix}$\n    $= \\begin{pmatrix} 0.495616 + 0.505521  -0.711 \\\\ -0.711  1.00 \\end{pmatrix} = \\begin{pmatrix} 1.001137  -0.711 \\\\ -0.711  1.00 \\end{pmatrix}$。\n    $Q_{\\mathrm{LNF}}^{\\top} Q_{\\mathrm{LNF}} - I = \\begin{pmatrix} 0.001137  -0.711 \\\\ -0.711  0.00 \\end{pmatrix}$。\n    $E_{\\mathrm{LNF}}^2 = \\|Q_{\\mathrm{LNF}}^{\\top} Q_{\\mathrm{LNF}} - I\\|_{F}^2 = (0.001137)^2 + (-0.711)^2 + (-0.711)^2 + 0^2$\n    $= 0.000001292769 + 0.505521 + 0.505521 = 1.011043292769$。\n    $E_{\\mathrm{LNF}} = \\sqrt{1.011043292769} \\approx 1.005506489$。\n\n*   **SNF的误差：**\n    $Q_{\\mathrm{SNF}} = \\begin{pmatrix} 0.709  -1.00 \\\\ 0.709  0.00 \\end{pmatrix}$。\n    $Q_{\\mathrm{SNF}}^{\\top} Q_{\\mathrm{SNF}} = \\begin{pmatrix} 0.709  0.709 \\\\ -1.00  0.00 \\end{pmatrix} \\begin{pmatrix} 0.709  -1.00 \\\\ 0.709  0.00 \\end{pmatrix} = \\begin{pmatrix} 0.709^2 + 0.709^2  -0.709 \\\\ -0.709  (-1.00)^2 \\end{pmatrix}$\n    $= \\begin{pmatrix} 2 \\times 0.502681  -0.709 \\\\ -0.709  1.00 \\end{pmatrix} = \\begin{pmatrix} 1.005362  -0.709 \\\\ -0.709  1.00 \\end{pmatrix}$。\n    $Q_{\\mathrm{SNF}}^{\\top} Q_{\\mathrm{SNF}} - I = \\begin{pmatrix} 0.005362  -0.709 \\\\ -0.709  0.00 \\end{pmatrix}$。\n    $E_{\\mathrm{SNF}}^2 = \\|Q_{\\mathrm{SNF}}^{\\top} Q_{\\mathrm{SNF}} - I\\|_{F}^2 = (0.005362)^2 + (-0.709)^2 + (-0.709)^2 + 0^2$\n    $= 0.000028751044 + 0.502681 + 0.502681 = 1.005390751044$。\n    $E_{\\mathrm{SNF}} = \\sqrt{1.005390751044} \\approx 1.002691749$。\n\n*   **比率：**\n    $R = \\frac{E_{\\mathrm{LNF}}}{E_{\\mathrm{SNF}}} = \\frac{1.005506489...}{1.002691749...} \\approx 1.00280718...$。\n    四舍五入到四位有效数字，我们得到 $1.003$。", "answer": "$$\n\\boxed{1.003}\n$$", "id": "3537544"}]}