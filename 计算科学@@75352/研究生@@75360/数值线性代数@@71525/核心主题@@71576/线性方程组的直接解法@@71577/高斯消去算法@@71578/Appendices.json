{"hands_on_practices": [{"introduction": "高斯消元法成功的关键在于选择合适的枢轴。部分选主元（或称列主元法）因其在稳定性和计算成本间的良好平衡而成为最常用的策略。然而，它并非万无一失。这个练习 [@problem_id:3587391] 构建了一个巧妙的例子，旨在揭示部分选主元的局限性，并展示了更为彻底的完全选主元策略如何能够成功处理部分选主元失败的情形。", "problem": "考虑对一个方阵进行带主元选择的高斯消元法。在部分主元选择中，在第 $k$ 步，仅在第 $k$ 列的第 $k$ 行到第 $n$ 行中搜索绝对值最大的元素作为主元，并（在必要时）交换行，将其移动到 $(k,k)$ 位置。在完全主元选择中，在第 $k$ 步，在由第 $k$ 行到第 $n$ 行和第 $k$ 列到第 $n$ 列组成的整个后继子矩阵中搜索绝对值最大的元素，并同时交换行和列，将其移动到 $(k,k)$ 位置。然后，两种策略都通过左乘一个单位下三角消元矩阵来将主元下方的元素置零，并在后继子矩阵上递归地继续该过程。所有的行和列交换都可以表示为与置换矩阵的乘法。\n\n令\n$$\nA =\n\\begin{pmatrix}\n1  2  3 \\\\\n1  2  4 \\\\\n-1  -2  0\n\\end{pmatrix}.\n$$\n\n在实数上进行精确算术运算。\n\n(a) 在 $k=1$ 时，应用一步带部分主元选择的高斯消元法，使用如下的决胜规则：在搜索集合中具有相等最大绝对值的元素中，选择行索引最小的作为主元（因此在 $k=1$ 时，主元从第 1 列中选出，无需交换行）。推导出这第一步之后的后继子矩阵，并仅使用上面陈述的核心定义，解释为什么在 $k=2$ 时，部分主元选择无法在第 2 列中找到一个非零主元（也就是说，在第 2 列内进行行交换无法暴露一个非零主元）。\n\n(b) 现在从原始矩阵 $A$ 开始，使用完全主元选择重复该过程。在 $k=1$ 时，选择整个矩阵中绝对值最大的元素作为主元，执行所需的行和列交换以将其移动到 $(1,1)$ 位置，并执行第一步消元以形成后继子矩阵。然后，在 $k=2$ 时，确定通过完全主元选择选出的主元（后继子矩阵中绝对值最大的元素），并说明其数值。\n\n您必须提供在完全主元选择下，在第 $k=2$ 步选出的主元的标量值作为最终答案。结果需精确表示，无需四舍五入。", "solution": "该问题要求分析对给定矩阵 $A$ 应用两种不同主元选择策略（部分主元选择和完全主元选择）的高斯消元法。运算是精确的。\n\n**第 (a) 部分：带部分主元选择的高斯消元法**\n\n给定矩阵\n$$\nA = A^{(1)} =\n\\begin{pmatrix}\n1  2  3 \\\\\n1  2  4 \\\\\n-1  -2  0\n\\end{pmatrix}.\n$$\n算法的第一步对应于 $k=1$。对于部分主元选择，我们必须通过在第一列中搜索第 1 行到第 3 行绝对值最大的元素来确定主元。此搜索集中的元素为 $A_{11}^{(1)} = 1$、$A_{21}^{(1)} = 1$ 和 $A_{31}^{(1)} = -1$。它们的绝对值分别为 $|1| = 1$、$|1| = 1$ 和 $|-1| = 1$。因此，最大绝对值为 $1$。\n\n问题陈述了一个决胜规则：“在搜索集合中具有相等最大绝对值的元素中，选择行索引最小的作为主元”。第 1 行中的元素 $A_{11}^{(1)} = 1$ 满足此条件。因此，主元是 $1$，不执行行交换。\n\n我们现在进行消元步骤，以在主元 $A_{11}^{(1)}$ 下方引入零。行变换的乘数是：\n$$\nm_{21} = \\frac{A_{21}^{(1)}}{A_{11}^{(1)}} = \\frac{1}{1} = 1\n$$\n$$\nm_{31} = \\frac{A_{31}^{(1)}}{A_{11}^{(1)}} = \\frac{-1}{1} = -1\n$$\n行操作为 $R_2 \\to R_2 - m_{21} R_1$ 和 $R_3 \\to R_3 - m_{31} R_1$。将这些操作应用于 $A^{(1)}$，得到下一阶段的矩阵 $A^{(2)}$：\n$$\nA^{(2)} =\n\\begin{pmatrix}\n1  2  3 \\\\\n1 - 1(1)  2 - 1(2)  4 - 1(3) \\\\\n-1 - (-1)(1)  -2 - (-1)(2)  0 - (-1)(3)\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n1  2  3 \\\\\n0  0  1 \\\\\n0  0  3\n\\end{pmatrix}.\n$$\n后继子矩阵是 $A^{(2)}$ 的右下角 $2 \\times 2$ 块，是下一步消元（$k=2$）的对象：\n$$\n\\begin{pmatrix}\n0  1 \\\\\n0  3\n\\end{pmatrix}.\n$$\n在第 $k=2$ 步，根据问题中的定义，部分主元选择策略要求我们“仅在第 $k$ 列的第 $k$ 行到第 $n$ 行中搜索绝对值最大的元素作为主元”。对于 $k=2$ 和 $n=3$，这意味着在 $A^{(2)}$ 的第 2 列中搜索第 2 行到第 3 行。候选元素为 $A_{22}^{(2)} = 0$ 和 $A_{32}^{(2)} = 0$。\n\n候选主元的集合是 $\\{0, 0\\}$。其中最大的绝对值是 $0$。高斯消元法从根本上要求一个非零主元来计算消元步骤的乘数。由于搜索列中的所有可用候选元素都为零，因此没有行交换可以将非零元素置于主元位置 $(2,2)$。因此，算法无法继续进行，被称为失败。\n\n**第 (b) 部分：带完全主元选择的高斯消元法**\n\n我们再次从原始矩阵开始：\n$$\nA = A^{(1)} =\n\\begin{pmatrix}\n1  2  3 \\\\\n1  2  4 \\\\\n-1  -2  0\n\\end{pmatrix}.\n$$\n在第 $k=1$ 步，完全主元选择要求在整个 $3 \\times 3$ 矩阵中搜索具有最大绝对值的元素。$A$ 中各元素绝对值组成的矩阵是：\n$$\n\\begin{pmatrix}\n|1|  |2|  |3| \\\\\n|1|  |2|  |4| \\\\\n|-1|  |-2|  |0|\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n1  2  3 \\\\\n1  2  4 \\\\\n1  2  0\n\\end{pmatrix}.\n$$\n最大值为 $4$，对应于元素 $A_{23} = 4$。为了使其成为主元，我们必须通过行和列交换将其移动到 $(1,1)$ 位置。我们交换第 1 行和第 2 行（$R_1 \\leftrightarrow R_2$），然后交换第 1 列和第 3 列（$C_1 \\leftrightarrow C_3$）。\n$$\nA \\xrightarrow{R_1 \\leftrightarrow R_2}\n\\begin{pmatrix}\n1  2  4 \\\\\n1  2  3 \\\\\n-1  -2  0\n\\end{pmatrix}\n\\xrightarrow{C_1 \\leftrightarrow C_3}\n\\begin{pmatrix}\n4  2  1 \\\\\n3  2  1 \\\\\n0  -2  -1\n\\end{pmatrix}.\n$$\n令这个变换后的矩阵为 $A'$。主元是 $A'_{11} = 4$。我们执行消元。乘数是：\n$$\nm_{21} = \\frac{A'_{21}}{A'_{11}} = \\frac{3}{4}\n$$\n$$\nm_{31} = \\frac{A'_{31}}{A'_{11}} = \\frac{0}{4} = 0\n$$\n将行操作 $R_2 \\to R_2 - \\frac{3}{4}R_1$ 和 $R_3 \\to R_3 - 0 R_1$ 应用于 $A'$ 得到：\n$$\nA^{(2)} =\n\\begin{pmatrix}\n4  2  1 \\\\\n3-\\frac{3}{4}(4)  2-\\frac{3}{4}(2)  1-\\frac{3}{4}(1) \\\\\n0  -2  -1\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n4  2  1 \\\\\n0  \\frac{1}{2}  \\frac{1}{4} \\\\\n0  -2  -1\n\\end{pmatrix}.\n$$\n对于第 $k=2$ 步，完全主元选择策略要求我们在后继的 $2 \\times 2$ 子矩阵中找到具有最大绝对值的元素：\n$$\n\\begin{pmatrix}\n\\frac{1}{2}  \\frac{1}{4} \\\\\n-2  -1\n\\end{pmatrix}.\n$$\n这些元素的绝对值是 $|\\frac{1}{2}| = \\frac{1}{2}$、$|\\frac{1}{4}| = \\frac{1}{4}$、$|-2| = 2$ 和 $|-1| = 1$。最大绝对值是 $2$，对应于元素 $-2$。\n\n因此，在完全主元选择下，在第 $k=2$ 步选出的主元是 $-2$。", "answer": "$$\\boxed{-2}$$", "id": "3587391"}, {"introduction": "选主元策略的核心目的不仅是避免零主元，更重要的是抑制计算过程中数值误差的累积与放大。这个练习 [@problem_id:3587432] 引入了“增长因子”这一关键概念，它是衡量高斯消元法数值稳定性的一个重要指标。通过对一个特殊构造的矩阵分别执行不选主元和部分选主元的高斯消元，你将亲手计算并直观地感受到选主元在控制元素大小增长方面的巨大威力。", "problem": "考虑 $5 \\times 5$ 矩阵 $A \\in \\mathbb{R}^{5 \\times 5}$，其元素定义为\n$$\na_{ij} \\;=\\; \\begin{cases}\n\\varepsilon,  i=j,\\\\\n1,  i \\neq j,\n\\end{cases}\n$$\n其中 $0  \\varepsilon  1$ 是一个固定参数。从高斯消去（GE）算法和行变换规则的基本定义出发，完成以下任务：\n\n1. 对 $A$ 执行不使用主元选择的高斯消去法。在每个消去步骤 $k=1,2,3,4$，明确指出位置 $(k,k)$ 处的主元，并写出该步骤后的上三角矩阵 $U^{(k)}$。你的 $U^{(k)}$ 在步骤 $k=1$ 时必须显示完整的 $5 \\times 5$ 结构，在步骤 $k=2,3,4$ 时必须显示嵌入的 $(5-k) \\times (5-k)$ 尾随子矩阵结构，并以关于 $\\varepsilon$ 的闭式形式表示。给出主元序列 $\\{p_{1}^{\\mathrm{np}},p_{2}^{\\mathrm{np}},p_{3}^{\\mathrm{np}},p_{4}^{\\mathrm{np}},p_{5}^{\\mathrm{np}}\\}$，其中上标 $\\mathrm{np}$ 表示“不使用主元选择”。\n\n2. 对 $A$ 执行带部分主元选择的高斯消去法。在每个消去步骤 $k=1,2,3,4$，根据部分主元选择规则在第 $k$ 列选择主元（将当前主元行与第 $k,k+1,\\dots,5$ 行中在第 $k$ 列具有最大绝对值的元素所在的行进行交换），然后执行消去。明确指出位置 $(k,k)$ 处的主元，并写出该步骤后的上三角矩阵 $U_{\\mathrm{pp}}^{(k)}$，以关于 $\\varepsilon$ 的闭式形式表示，并遵循与第1部分相同的结构要求。给出主元序列 $\\{p_{1}^{\\mathrm{pp}},p_{2}^{\\mathrm{pp}},p_{3}^{\\mathrm{pp}},p_{4}^{\\mathrm{pp}},p_{5}^{\\mathrm{pp}}\\}$，其中上标 $\\mathrm{pp}$ 表示“部分主元选择”。\n\n3. 设算法的元素增长因子定义为\n$$\n\\rho \\;=\\; \\frac{\\max_{i,j} |u_{ij}|}{\\max_{i,j} |a_{ij}|},\n$$\n其中 $U$ 是算法生成的最终上三角矩阵，而 $A$ 是原始输入矩阵。计算比率\n$$\nR \\;=\\; \\frac{\\rho_{\\mathrm{np}}}{\\rho_{\\mathrm{pp}}}\n$$\n对于特定值 $\\varepsilon=10^{-6}$。将你的最终数值答案 $R$ 四舍五入到四位有效数字。最终答案不带单位。", "solution": "初始矩阵 $A$ 为：\n$$\nA = A^{(0)} =\n\\begin{pmatrix}\n\\varepsilon  1  1  1  1 \\\\\n1  \\varepsilon  1  1  1 \\\\\n1  1  \\varepsilon  1  1 \\\\\n1  1  1  \\varepsilon  1 \\\\\n1  1  1  1  \\varepsilon\n\\end{pmatrix}\n$$\n\n**第 1 部分：不使用主元选择的高斯消去法**\n\n设步骤 $k-1$ 后的尾随子矩阵的对角元素为 $\\varepsilon_{k-1}$，非对角元素为 $d_{k-1}$。\n$\\varepsilon_0 = \\varepsilon$, $d_0 = 1$。\n主元 $p_k^{\\mathrm{np}} = \\varepsilon_{k-1}$。乘数 $m_k = d_{k-1}/\\varepsilon_{k-1}$。\n下一个尾随子矩阵的新元素为 $\\varepsilon_k = \\varepsilon_{k-1} - m_k d_{k-1}$ 和 $d_k = d_{k-1} - m_k d_{k-1}$。\n通过归纳法可以推导出一般形式：\n$\\varepsilon_k = \\frac{(\\varepsilon-1)(\\varepsilon+k)}{\\varepsilon+k-1}$ 和 $d_k = \\frac{\\varepsilon-1}{\\varepsilon+k-1}$。\n\n- **$k=1$**: 主元 $p_1^{\\mathrm{np}} = \\varepsilon_0 = \\varepsilon$。\n  $\\varepsilon_1 = \\frac{\\varepsilon^2-1}{\\varepsilon}$, $d_1 = \\frac{\\varepsilon-1}{\\varepsilon}$。\n$$\nU^{(1)} = A^{(1)} =\n\\begin{pmatrix}\n\\varepsilon  1  1  1  1 \\\\\n0  \\frac{\\varepsilon^2-1}{\\varepsilon}  \\frac{\\varepsilon-1}{\\varepsilon}  \\frac{\\varepsilon-1}{\\varepsilon}  \\frac{\\varepsilon-1}{\\varepsilon} \\\\\n0  \\frac{\\varepsilon-1}{\\varepsilon}  \\frac{\\varepsilon^2-1}{\\varepsilon}  \\frac{\\varepsilon-1}{\\varepsilon}  \\frac{\\varepsilon-1}{\\varepsilon} \\\\\n0  \\frac{\\varepsilon-1}{\\varepsilon}  \\frac{\\varepsilon-1}{\\varepsilon}  \\frac{\\varepsilon^2-1}{\\varepsilon}  \\frac{\\varepsilon-1}{\\varepsilon} \\\\\n0  \\frac{\\varepsilon-1}{\\varepsilon}  \\frac{\\varepsilon-1}{\\varepsilon}  \\frac{\\varepsilon-1}{\\varepsilon}  \\frac{\\varepsilon^2-1}{\\varepsilon}\n\\end{pmatrix}\n$$\n- **$k=2$**: 主元 $p_2^{\\mathrm{np}} = \\varepsilon_1 = \\frac{\\varepsilon^2-1}{\\varepsilon}$。\n  $\\varepsilon_2 = \\frac{(\\varepsilon-1)(\\varepsilon+2)}{\\varepsilon+1}$, $d_2 = \\frac{\\varepsilon-1}{\\varepsilon+1}$。\n  嵌入的 $3 \\times 3$ 尾随子矩阵为：\n$$\n\\begin{pmatrix}\n\\varepsilon_2  d_2  d_2 \\\\\nd_2  \\varepsilon_2  d_2 \\\\\nd_2  d_2  \\varepsilon_2\n\\end{pmatrix}\n$$\n- **$k=3$**: 主元 $p_3^{\\mathrm{np}} = \\varepsilon_2 = \\frac{(\\varepsilon-1)(\\varepsilon+2)}{\\varepsilon+1}$。\n  $\\varepsilon_3 = \\frac{(\\varepsilon-1)(\\varepsilon+3)}{\\varepsilon+2}$, $d_3 = \\frac{\\varepsilon-1}{\\varepsilon+2}$。\n  嵌入的 $2 \\times 2$ 尾随子矩阵为：\n$$\n\\begin{pmatrix}\n\\varepsilon_3  d_3 \\\\\nd_3  \\varepsilon_3\n\\end{pmatrix}\n$$\n- **$k=4$**: 主元 $p_4^{\\mathrm{np}} = \\varepsilon_3 = \\frac{(\\varepsilon-1)(\\varepsilon+3)}{\\varepsilon+2}$。\n  $\\varepsilon_4 = \\frac{(\\varepsilon-1)(\\varepsilon+4)}{\\varepsilon+3}$。\n  嵌入的 $1 \\times 1$ 尾随子矩阵为 $(\\varepsilon_4)$。\n\n主元序列为：\n$p_1^{\\mathrm{np}} = \\varepsilon$, $p_2^{\\mathrm{np}} = \\frac{\\varepsilon^2-1}{\\varepsilon}$, $p_3^{\\mathrm{np}} = \\frac{(\\varepsilon-1)(\\varepsilon+2)}{\\varepsilon+1}$, $p_4^{\\mathrm{np}} = \\frac{(\\varepsilon-1)(\\varepsilon+3)}{\\varepsilon+2}$, $p_5^{\\mathrm{np}} = \\frac{(\\varepsilon-1)(\\varepsilon+4)}{\\varepsilon+3}$。\n\n**第 2 部分：带部分主元选择的高斯消去法**\n\n- **$k=1$**: 在第 1 列，元素为 $(\\varepsilon, 1, 1, 1, 1)^T$。因为 $0  \\varepsilon  1$，最大绝对值为 $1$。交换 $R_1 \\leftrightarrow R_2$。主元 $p_1^{\\mathrm{pp}}=1$。消去后：\n$$\nU_{\\mathrm{pp}}^{(1)} = A_{\\mathrm{pp}}^{(1)} =\n\\begin{pmatrix}\n1  \\varepsilon  1  1  1 \\\\\n0  1-\\varepsilon^2  1-\\varepsilon  1-\\varepsilon  1-\\varepsilon \\\\\n0  1-\\varepsilon  \\varepsilon-1  0  0 \\\\\n0  1-\\varepsilon  0  \\varepsilon-1  0 \\\\\n0  1-\\varepsilon  0  0  \\varepsilon-1\n\\end{pmatrix}\n$$\n- **$k=2$**: 在第 2 列（从第 2 行开始），元素为 $(1-\\varepsilon^2, 1-\\varepsilon, 1-\\varepsilon, 1-\\varepsilon)^T$。$|1-\\varepsilon^2|  |1-\\varepsilon|$，因此主元 $p_2^{\\mathrm{pp}} = 1-\\varepsilon^2$。无需交换。消去后，尾随 $3 \\times 3$ 子矩阵的元素有一般形式：对角元 $\\varepsilon_k' = -(1-\\varepsilon)\\frac{k+\\varepsilon}{k-1+\\varepsilon}$，非对角元 $d_k' = -\\frac{1-\\varepsilon}{k-1+\\varepsilon}$。\n  对角元 $\\varepsilon_2' = -(1-\\varepsilon)\\frac{2+\\varepsilon}{1+\\varepsilon}$，非对角元 $d_2' = -\\frac{1-\\varepsilon}{1+\\varepsilon}$。\n  嵌入的 $3 \\times 3$ 子矩阵为：\n$$\n\\begin{pmatrix}\n\\varepsilon_2'  d_2'  d_2' \\\\\nd_2'  \\varepsilon_2'  d_2' \\\\\nd_2'  d_2'  \\varepsilon_2'\n\\end{pmatrix}\n$$\n- **$k=3$**: 主元 $p_3^{\\mathrm{pp}} = \\varepsilon_2'$。无需交换。\n  $\\varepsilon_3' = -(1-\\varepsilon)\\frac{3+\\varepsilon}{2+\\varepsilon}$, $d_3' = -\\frac{1-\\varepsilon}{2+\\varepsilon}$。\n  嵌入的 $2 \\times 2$ 子矩阵为：\n$$\n\\begin{pmatrix}\n\\varepsilon_3'  d_3' \\\\\nd_3'  \\varepsilon_3'\n\\end{pmatrix}\n$$\n- **$k=4$**: 主元 $p_4^{\\mathrm{pp}} = \\varepsilon_3'$。无需交换。\n  $\\varepsilon_4' = -(1-\\varepsilon)\\frac{4+\\varepsilon}{3+\\varepsilon}$。\n  嵌入的 $1 \\times 1$ 子矩阵为 $(\\varepsilon_4')$。\n\n主元序列为：\n$p_1^{\\mathrm{pp}} = 1$, $p_2^{\\mathrm{pp}} = 1-\\varepsilon^2$, $p_3^{\\mathrm{pp}} = -(1-\\varepsilon)\\frac{2+\\varepsilon}{1+\\varepsilon}$, $p_4^{\\mathrm{pp}} = -(1-\\varepsilon)\\frac{3+\\varepsilon}{2+\\varepsilon}$, $p_5^{\\mathrm{pp}} = -(1-\\varepsilon)\\frac{4+\\varepsilon}{3+\\varepsilon}$。\n\n**第 3 部分：增长因子比率**\n\n增长因子 $\\rho = \\frac{\\max_{i,j} |u_{ij}|}{\\max_{i,j} |a_{ij}|}$。对于矩阵 $A$，$\\max_{i,j} |a_{ij}| = 1$。因此 $\\rho = \\max_{i,j} |u_{ij}|$。\n\n- **不使用主元选择 ($\\rho_{\\mathrm{np}}$)**：对于小的 $\\varepsilon$，$|\\varepsilon_1| = |\\frac{\\varepsilon^2-1}{\\varepsilon}| = \\frac{1-\\varepsilon^2}{\\varepsilon} \\approx \\frac{1}{\\varepsilon}$ 是最大的元素。因此，$\\rho_{\\mathrm{np}} = \\frac{1-\\varepsilon^2}{\\varepsilon}$。\n\n- **带部分主元选择 ($\\rho_{\\mathrm{pp}}$)**：对于小的 $\\varepsilon$，所有主元和非对角元素的绝对值都小于或约等于 $2$。最大元素为 $|\\varepsilon_2'| = (1-\\varepsilon)\\frac{2+\\varepsilon}{1+\\varepsilon} \\approx 2$。因此，$\\rho_{\\mathrm{pp}} = (1-\\varepsilon)\\frac{2+\\varepsilon}{1+\\varepsilon}$。\n\n- **比率 $R$**:\n$$\nR = \\frac{\\rho_{\\mathrm{np}}}{\\rho_{\\mathrm{pp}}} = \\frac{\\frac{1-\\varepsilon^2}{\\varepsilon}}{(1-\\varepsilon)\\frac{2+\\varepsilon}{1+\\varepsilon}} = \\frac{\\frac{(1-\\varepsilon)(1+\\varepsilon)}{\\varepsilon}}{(1-\\varepsilon)\\frac{2+\\varepsilon}{1+\\varepsilon}} = \\frac{\\frac{1+\\varepsilon}{\\varepsilon}}{\\frac{2+\\varepsilon}{1+\\varepsilon}} = \\frac{(1+\\varepsilon)^2}{\\varepsilon(2+\\varepsilon)}\n$$\n代入 $\\varepsilon = 10^{-6}$：\n$$\nR = \\frac{(1+10^{-6})^2}{10^{-6}(2+10^{-6})} = \\frac{1.000002000001}{2.000001 \\times 10^{-6}} \\approx 500000.75\n$$\n四舍五入到四位有效数字，结果为 $5.000 \\times 10^5$。", "answer": "$$\\boxed{5.000 \\times 10^{5}}$$", "id": "3587432"}, {"introduction": "一个优秀的数值算法不仅应能求出解，还应能揭示矩阵的内在结构特性。本练习 [@problem_id:3587374] 探讨了“数值秩”这一深刻概念，它比理论上的秩更能反映矩阵在有限精度计算中的真实“维度”。你将发现，即使是稳定的部分选主元LU分解，也可能无法识别出一个接近奇异的矩阵，而这正是设计秩揭示（rank-revealing）分解算法（如采用列交换策略）的初衷。", "problem": "考虑由下式定义的方阵 $A \\in \\mathbb{R}^{2 \\times 2}$\n$$\nA = \\begin{pmatrix}\n1  M \\\\\n0  1\n\\end{pmatrix},\n$$\n其中 $M$ 是一个正实数参数。设数值容差为 $\\tau = 5 \\times 10^{-9}$。对于此问题，在规定的容差范围内使用以下三种秩的定义：\n- 金标准数值秩 $r_{\\mathrm{true}}$ 是 $A$ 的奇异值中绝对值超过 $\\tau$ 的数量。\n- 通过带部分主元（仅行主元）的标准 LU 分解（Lower-Upper factorization）估计的秩，记为 $r_{\\mathrm{PP}}$，是上三角因子 $U$ 的对角线元素中绝对值超过 $\\tau$ 的数量。\n- 通过带列主元的秩揭示 LU 分解（即，同时选择行和列置换以暴露近似线性相关的 LU 分解）估计的秩，记为 $r_{\\mathrm{RR}}$，是在执行了最大程度暴露尾部小主元的列置换后，相应上三角因子 $U$ 的对角线元素中绝对值超过 $\\tau$ 的数量。\n\n从数值线性代数的基本定义和公认事实（奇异值是 $A^{\\top}A$ 特征值平方根的模型、高斯消元法的定义和机理，以及主元法的作用）出发，完成以下任务：\n1. 对于 $M = 10^{10}$ 的特定选择，通过分析 $A$ 的奇异值来确定 $r_{\\mathrm{true}}$。\n2. 通过分析对 $A$ 应用标准部分主元 LU 分解得到的上三角因子 $U$ 的对角结构来确定 $r_{\\mathrm{PP}}$。\n3. 通过证明单个列置换如何使 $A$ 在 LU 分解下具有秩揭示性，然后分析得到的 $U$ 来确定 $r_{\\mathrm{RR}}$。\n4. 计算标量 $\\Delta = r_{\\mathrm{PP}} - r_{\\mathrm{RR}}$。\n\n你的最终答案必须是单个实数 $\\Delta$。最终答案无需四舍五入。解释步骤 2 中失败的原因以及步骤 3 中的补救措施为什么成功，并严格地从基本原理（定义和算法机理）出发推导每个结论，不使用快捷公式。矩阵 $A$ 和容差 $\\tau$ 在科学上是切合实际的，可用于研究高斯消元法中主元策略的秩揭示属性。", "solution": "本问题要求在使用容差 $\\tau = 5 \\times 10^{-9}$ 的情况下，分析矩阵 $A = \\begin{pmatrix} 1  M \\\\ 0  1 \\end{pmatrix}$（其中 $M=10^{10}$）的数值秩。我们必须使用三种不同的定义来确定数值秩，并解释其间的差异。\n\n**1. 确定真实数值秩 $r_{\\mathrm{true}}$**\n\n金标准数值秩 $r_{\\mathrm{true}}$ 定义为矩阵 $A$ 的奇异值中绝对值超过容差 $\\tau$ 的数量。$A$ 的奇异值是矩阵 $A^{\\top}A$ 特征值的平方根。\n\n首先，我们计算 $A^{\\top}A$：\n$$\nA^{\\top} = \\begin{pmatrix} 1  0 \\\\ M  1 \\end{pmatrix}\n$$\n$$\nA^{\\top}A = \\begin{pmatrix} 1  0 \\\\ M  1 \\end{pmatrix} \\begin{pmatrix} 1  M \\\\ 0  1 \\end{pmatrix} = \\begin{pmatrix} 1  M \\\\ M  M^2+1 \\end{pmatrix}\n$$\n接下来，我们通过求解特征方程 $\\det(A^{\\top}A - \\lambda I) = 0$ 来求 $A^{\\top}A$ 的特征值 $\\lambda$：\n$$\n\\det \\begin{pmatrix} 1-\\lambda  M \\\\ M  M^2+1-\\lambda \\end{pmatrix} = 0\n$$\n$$\n(1-\\lambda)(M^2+1-\\lambda) - M^2 = 0\n$$\n$$\n\\lambda^2 - (M^2+2)\\lambda + 1 = 0\n$$\n使用二次方程求根公式，特征值为：\n$$\n\\lambda = \\frac{M^2+2 \\pm \\sqrt{(M^2+2)^2 - 4}}{2} = \\frac{M^2+2 \\pm \\sqrt{M^4+4M^2}}{2} = \\frac{M^2+2 \\pm M\\sqrt{M^2+4}}{2}\n$$\n两个特征值是 $\\lambda_1 = \\frac{M^2+2 + M\\sqrt{M^2+4}}{2}$ 和 $\\lambda_2 = \\frac{M^2+2 - M\\sqrt{M^2+4}}{2}$。\n奇异值为 $\\sigma_1 = \\sqrt{\\lambda_1}$ 和 $\\sigma_2 = \\sqrt{\\lambda_2}$。\n\n对于给定的较大值 $M = 10^{10}$，我们可以对奇异值进行近似。对于 $\\lambda_1$，$M^2$ 项占主导地位：\n$$\n\\lambda_1 \\approx \\frac{M^2 + M\\sqrt{M^2}}{2} = M^2 \\quad \\implies \\quad \\sigma_1 \\approx M = 10^{10}\n$$\n对于 $\\lambda_2$，我们有理化分子以避免灾难性抵消：\n$$\n\\lambda_2 = \\frac{2}{M^2+2+M\\sqrt{M^2+4}} \\approx \\frac{2}{M^2+M(M)} = \\frac{1}{M^2} \\quad \\implies \\quad \\sigma_2 \\approx \\frac{1}{M} = 10^{-10}\n$$\n现在我们将奇异值的绝对值与容差 $\\tau = 5 \\times 10^{-9}$ 进行比较：\n- $\\sigma_1 \\approx 10^{10}  5 \\times 10^{-9}$。\n- $\\sigma_2 \\approx 10^{-10}  5 \\times 10^{-9}$。\n\n只有一个奇异值超过了容差。因此，真实的数值秩为 $r_{\\mathrm{true}} = 1$。\n\n**2. 通过带部分主元的 LU 分解确定秩 $r_{\\mathrm{PP}}$**\n\n我们对 $A = \\begin{pmatrix} 1  M \\\\ 0  1 \\end{pmatrix}$ 应用带部分主元（行交换）的高斯消元法。\n在第一列中，我们通过寻找绝对值最大的元素来选择主元。这些元素是 $a_{11}=1$ 和 $a_{21}=0$。最大绝对值为 $|1|=1$。因此，不需要进行行交换。主元是 $a_{11}=1$。\n消元步骤旨在将 $a_{21}$ 位置的元素变为零。然而，该元素已经是 $0$。因此，不需要进行消元操作。\n算法立即终止，生成的上三角矩阵 $U$ 与原始矩阵 $A$ 相同：\n$$\nU = \\begin{pmatrix} 1  M \\\\ 0  1 \\end{pmatrix}\n$$\n秩 $r_{\\mathrm{PP}}$ 是 $U$ 的对角线元素中绝对值超过 $\\tau = 5 \\times 10^{-9}$ 的数量。对角线元素为 $u_{11}=1$ 和 $u_{22}=1$。\n- $|u_{11}| = 1  5 \\times 10^{-9}$。\n- $|u_{22}| = 1  5 \\times 10^{-9}$。\n两个对角线元素都大于容差。因此，通过此方法估计的秩为 $r_{\\mathrm{PP}} = 2$。\n\n此方法的失败源于部分主元法仅考虑当前列内的元素来选择主元。这个选择没有考虑到同一行中非常大的元素 $M=10^{10}$。由于矩阵 $A$ 的结构向部分主元策略隐藏了列之间的近似线性相关性，算法未能“看到”它。$U$ 中产生的主元没有反映出由奇异值给出的问题的真实尺度。\n\n**3. 通过秩揭示 LU 分解确定秩 $r_{\\mathrm{RR}}$**\n\n秩揭示 LU 分解涉及列置换，以将可能的最大元素移到主元位置。我们交换 $A$ 的两列：\n$$\n\\Pi = \\begin{pmatrix} 0  1 \\\\ 1  0 \\end{pmatrix}\n$$\n置换后的矩阵是 $A_c = A\\Pi$：\n$$\nA_c = \\begin{pmatrix} 1  M \\\\ 0  1 \\end{pmatrix} \\begin{pmatrix} 0  1 \\\\ 1  0 \\end{pmatrix} = \\begin{pmatrix} M  1 \\\\ 1  0 \\end{pmatrix}\n$$\n现在我们对 $A_c$ 执行 LU 分解（带部分主元）。\n在第一列中，元素是 $M=10^{10}$ 和 $1$。主元是 $M$，因为它是较大的元素。不需要进行行交换。\n用于消去 $(2,1)$ 位置元素的乘数是 $l_{21} = \\frac{1}{M}$。\n我们执行行操作 $R_2 \\leftarrow R_2 - l_{21} R_1$：\n新的第二行是 $(1 - \\frac{1}{M}M, 0 - \\frac{1}{M}1) = (0, -\\frac{1}{M})$。\n得到的上三角矩阵 $U$ 是：\n$$\nU = \\begin{pmatrix} M  1 \\\\ 0  -1/M \\end{pmatrix}\n$$\n秩 $r_{\\mathrm{RR}}$ 是这个 $U$ 的对角线元素中绝对值超过 $\\tau = 5 \\times 10^{-9}$ 的数量。对角线元素是 $u_{11}=M=10^{10}$ 和 $u_{22}=-1/M = -10^{-10}$。\n- $|u_{11}| = 10^{10}  5 \\times 10^{-9}$。\n- $|u_{22}| = |-10^{-10}| = 10^{-10}  5 \\times 10^{-9}$。\n只有一个对角线元素超过了容差。因此，通过此方法估计的秩为 $r_{\\mathrm{RR}} = 1$。\n\n此方法成功的原因是列置换将矩阵的最大元素 $M$ 带到了初始主元位置。随后的消元步骤产生第二个主元 $-1/M$，其绝对值正确地反映了小奇异值 $\\sigma_2$ 的量级。因此，这种分解“揭示”了矩阵的数值秩。\n\n**4. 计算 $\\Delta$**\n\n最后一步是计算标量 $\\Delta = r_{\\mathrm{PP}} - r_{\\mathrm{RR}}$。\n使用上面导出的值：\n- $r_{\\mathrm{PP}} = 2$\n- $r_{\\mathrm{RR}} = 1$\n$$\n\\Delta = 2 - 1 = 1\n$$\n差异 $\\Delta=1$ 突显了标准部分主元法在可靠确定数值秩方面的失败，以及秩揭示策略在同一任务上的成功。", "answer": "$$\n\\boxed{1}\n$$", "id": "3587374"}]}