{"hands_on_practices": [{"introduction": "哈代-温伯格平衡（Hardy-Weinberg Equilibrium, HWE）是群体遗传学的基石，它描述了一个理想群体在没有演化力量作用下的遗传构成。在实践中，检验观察数据是否偏离HWE是发现自然选择、非随机交配或基因分型错误等因素的重要第一步。本练习将指导您完成从观察到的基因型计数计算等位基因频率，并使用经典的卡方检验来评估群体是否处于HWE的完整过程，这是基因组数据质量控制中的一项基本技能[@problem_id:3338784]。", "problem": "在计算系统生物学中，一个高通量变异检测流程正在对一个随机交配的二倍体群体中的常染色体双等位基因单核苷酸多态性进行质量控制。在过滤掉低质量的基因型鉴定结果后，剩下总共 $N = 500$ 个具有可信基因型的个体，其观察到的基因型计数为：$n_{AA} = 210$，$n_{Aa} = 230$，以及 $n_{aa} = 60$。假设群体满足随机交配、大群体、无选择、无突变、无迁移的条件，因此哈迪-温伯格平衡（HWE）是合适的零假设模型。\n\n仅使用群体遗传学的基础定义，根据这些计数计算等位基因 $A$ 和等位基因 $a$ 的频率，然后计算在 HWE 零假设模型下的预期基因型计数，最后使用观察到的和预期的基因型计数计算用于检验与 HWE 偏差的经典 Pearson 卡方检验统计量，不使用任何连续性校正或小样本调整。\n\n请以一个实数值的形式报告卡方统计量，四舍五入到四位有效数字。不要报告任何其他量。不需要单位。", "solution": "该问题陈述已被评估并被认为是有效的。其科学基础是群体遗传学原理，特别是哈迪-温伯格平衡（HWE）模型和卡方拟合优度检验。该问题提法得当，所有必要数据均已提供且内部一致，能够计算出唯一解。语言客观且精确。\n\n任务是在给定一个二倍体群体中某个双等位基因座的观察基因型计数的情况下，计算用于检验与 HWE 偏差的 Pearson 卡方检验统计量。解题过程分三个阶段：首先，从观察数据计算等位基因频率；其次，在 HWE 零假设模型下计算预期基因型计数；第三，基于观察计数和预期计数计算卡方统计量。\n\n提供的数据是样本总数为 $N=500$ 个个体的观察基因型计数：\n-   基因型为 $AA$ 的个体数：$n_{AA} = 210$\n-   基因型为 $Aa$ 的个体数：$n_{Aa} = 230$\n-   基因型为 $aa$ 的个体数：$n_{aa} = 60$\n\n个体总数可通过计数总和确认：$n_{AA} + n_{Aa} + n_{aa} = 210 + 230 + 60 = 500 = N$。\n\n**1. 等位基因频率的计算**\n\n等位基因 $A$ 和 $a$ 的频率（分别表示为 $p$ 和 $q$）由观察到的基因型计数计算得出。由于群体是二倍体，样本中的等位基因总数为 $2N = 2 \\times 500 = 1000$。\n\n$A$ 等位基因的数量来自纯合子 ($AA$) 和杂合子 ($Aa$)。每个 $AA$ 个体携带两个 $A$ 等位基因，每个 $Aa$ 个体携带一个 $A$ 等位基因。\n等位基因 $A$ 的总计数为：\n$$ \\text{Count}(A) = 2 \\times n_{AA} + 1 \\times n_{Aa} = 2 \\times 210 + 230 = 420 + 230 = 650 $$\n等位基因 $A$ 的频率 $p$ 是 $A$ 等位基因的计数与等位基因总数的比值：\n$$ p = \\frac{2 n_{AA} + n_{Aa}}{2N} = \\frac{650}{1000} = 0.65 $$\n\n类似地，计算等位基因 $a$ 的频率 $q$。每个 $aa$ 个体携带两个 $a$ 等位基因，每个 $Aa$ 个体携带一个 $a$ 等位基因。\n等位基因 $a$ 的总计数为：\n$$ \\text{Count}(a) = 2 \\times n_{aa} + 1 \\times n_{Aa} = 2 \\times 60 + 230 = 120 + 230 = 350 $$\n等位基因 $a$ 的频率 $q$ 为：\n$$ q = \\frac{2 n_{aa} + n_{Aa}}{2N} = \\frac{350}{1000} = 0.35 $$\n作为检验，等位基因频率之和必须为 $1$：$p + q = 0.65 + 0.35 = 1.00$。\n\n**2. HWE 下预期基因型计数的计算**\n\nHWE 原理指出，对于满足特定假设的群体，预期的基因型频率由二项式展开 $(p+q)^2 = p^2 + 2pq + q^2$ 的各项给出。\n-   基因型 $AA$ 的预期频率：$f_E(AA) = p^2 = (0.65)^2 = 0.4225$\n-   基因型 $Aa$ 的预期频率：$f_E(Aa) = 2pq = 2 \\times 0.65 \\times 0.35 = 0.4550$\n-   基因型 $aa$ 的预期频率：$f_E(aa) = q^2 = (0.35)^2 = 0.1225$\n\n为求得预期基因型计数 ($E_i$)，我们将这些预期频率乘以总样本量 $N=500$。\n-   $AA$ 的预期计数：$E_{AA} = N \\times p^2 = 500 \\times 0.4225 = 211.25$\n-   $Aa$ 的预期计数：$E_{Aa} = N \\times 2pq = 500 \\times 0.4550 = 227.5$\n-   $aa$ 的预期计数：$E_{aa} = N \\times q^2 = 500 \\times 0.1225 = 61.25$\n\n预期计数之和必须等于总样本量：$211.25 + 227.5 + 61.25 = 500$。\n\n**3. Pearson 卡方统计量的计算**\n\nPearson 卡方 ($\\chi^2$) 统计量用于衡量观察计数 ($O_i$) 与预期计数 ($E_i$) 之间的差异。公式为：\n$$ \\chi^2 = \\sum_{i} \\frac{(O_i - E_i)^2}{E_i} $$\n三个类别是基因型 $AA$、$Aa$ 和 $aa$。令 $O_{AA}=n_{AA}$、$O_{Aa}=n_{Aa}$ 和 $O_{aa}=n_{aa}$。\n\n计算过程如下：\n$$ \\chi^2 = \\frac{(O_{AA} - E_{AA})^2}{E_{AA}} + \\frac{(O_{Aa} - E_{Aa})^2}{E_{Aa}} + \\frac{(O_{aa} - E_{aa})^2}{E_{aa}} $$\n代入观察值和预期值：\n$$ \\chi^2 = \\frac{(210 - 211.25)^2}{211.25} + \\frac{(230 - 227.5)^2}{227.5} + \\frac{(60 - 61.25)^2}{61.25} $$\n计算各项：\n$$ \\chi^2 = \\frac{(-1.25)^2}{211.25} + \\frac{(2.5)^2}{227.5} + \\frac{(-1.25)^2}{61.25} $$\n$$ \\chi^2 = \\frac{1.5625}{211.25} + \\frac{6.25}{227.5} + \\frac{1.5625}{61.25} $$\n$$ \\chi^2 \\approx 0.007396213 + 0.027472527 + 0.025510204 $$\n$$ \\chi^2 \\approx 0.060378944 $$\n\n题目要求结果四舍五入到四位有效数字。第一位有效数字是百分位的 $6$。四位有效数字是 $0.06037$。第五位有效数字是 $8$，因此我们将第四位数字向上取整。\n$$ \\chi^2 \\approx 0.06038 $$\n这就是卡方统计量的最终值。", "answer": "$$\\boxed{0.06038}$$", "id": "3338784"}, {"introduction": "现实世界中的种群很少是单一的、完全随机交配的单元，而常常被划分为多个亚群或半独立单元（Deme）。为了理解这种结构如何影响遗传变异，我们需要量化亚群之间的遗传分化。本练习介绍了一个核心统计量——固定指数（$F_{ST}$），它通过比较亚群内部的预期杂合度（$H_S$）和整个种群的预期杂合度（$H_T$）来衡量群体分化。通过这个练习，您将学会如何从等位基因计数数据中计算这些量，并利用$F_{ST}$来推断如基因流等演化过程的强度[@problem_id:3338795]。", "problem": "在一个处于迁移-漂变平衡的结构化种群中，对 $K=5$ 个亚群中的一个双等位基因座（等位基因为 $A$ 和 $a$）进行了抽样。给定每个亚群 $i$ 的等位基因计数（基因拷贝数）为 $(c_{i}^{A}, c_{i}^{a})$，总数为 $C_{i} = c_{i}^{A} + c_{i}^{a}$：\n- 亚群 $1$：$(83, 117)$，总数 $C_{1} = 200$\n- 亚群 $2$：$(30, 70)$，总数 $C_{2} = 100$\n- 亚群 $3$：$(160, 40)$，总数 $C_{3} = 200$\n- 亚群 $4$：$(55, 45)$，总数 $C_{4} = 100$\n- 亚群 $5$：$(24, 76)$，总数 $C_{5} = 100$\n\n从群体遗传学的基本定义出发，假定每个亚群都遵循哈迪-温伯格平衡（HWE），使用样本量权重 $w_{i} = C_{i} \\big/ \\sum_{j=1}^{K} C_{j}$，并计算：\n1. 等位基因 $A$ 在各亚群间的加权平均频率 $\\bar{p}$。\n2. 每个亚群 $i$ 的亚群内期望杂合度 $H_{i} = 2 p_{i} (1 - p_{i})$，其中 $p_{i} = c_{i}^{A} / C_{i}$，以及样本量加权平均的亚群内杂合度 $H_{S} = \\sum_{i=1}^{K} w_{i} H_{i}$。\n3. 总期望杂合度 $H_{T} = 2 \\bar{p} (1 - \\bar{p})$。\n4. 固定指数 $F_{ST}$，定义为 $F_{ST} = \\frac{H_{T} - H_{S}}{H_{T}}$。\n\n然后，在经典的 Wright 岛屿模型假设（中性、亚群大小相等、对称迁移和迁移-漂变平衡）下，使用经过充分检验的关系式 $F_{ST} \\approx \\frac{1}{4Nm + 1}$，根据推断的基因流水平解释每代迁移个体数 $Nm$。\n\n将所有报告的量（$\\bar{p}$、$H_{S}$、$H_{T}$、$F_{ST}$ 和 $Nm$）四舍五入至五位有效数字。最终答案以 $\\bar{p}$、$H_{S}$、$H_{T}$、$F_{ST}$、$Nm$ 的顺序序列表示。", "solution": "该问题是有效的，因为它科学地基于标准群体遗传学理论，问题阐述清晰，提供了足够的数据和明确的定义，并且陈述客观。满足有效问题的所有条件。\n\n解题过程按照问题陈述中定义的量进行系统性计算。\n\n首先，我们确定在所有亚群中抽样的基因拷贝总数，记为 $C_{\\text{total}}$。\n$$ C_{\\text{total}} = \\sum_{j=1}^{K} C_{j} = C_{1} + C_{2} + C_{3} + C_{4} + C_{5} $$\n$$ C_{\\text{total}} = 200 + 100 + 200 + 100 + 100 = 700 $$\n样本量权重 $w_{i} = C_{i} / C_{\\text{total}}$ 为：\n$$ w_{1} = \\frac{200}{700} = \\frac{2}{7} $$\n$$ w_{2} = \\frac{100}{700} = \\frac{1}{7} $$\n$$ w_{3} = \\frac{200}{700} = \\frac{2}{7} $$\n$$ w_{4} = \\frac{100}{700} = \\frac{1}{7} $$\n$$ w_{5} = \\frac{100}{700} = \\frac{1}{7} $$\n接下来，我们使用公式 $p_{i} = c_{i}^{A} / C_{i}$ 计算每个亚群 $i$ 中等位基因 $A$ 的频率 $p_{i}$。\n$$ p_{1} = \\frac{83}{200} = 0.415 $$\n$$ p_{2} = \\frac{30}{100} = 0.3 $$\n$$ p_{3} = \\frac{160}{200} = 0.8 $$\n$$ p_{4} = \\frac{55}{100} = 0.55 $$\n$$ p_{5} = \\frac{24}{100} = 0.24 $$\n\n1.  **计算加权平均等位基因频率 $\\bar{p}$**。\n    这可以计算为亚群频率的加权平均值，$\\bar{p} = \\sum_{i=1}^{K} w_{i} p_{i}$，或者更直接地计算为 $A$ 等位基因的总数除以所有等位基因的总数。\n    $$ \\bar{p} = \\frac{\\sum_{i=1}^{K} c_{i}^{A}}{\\sum_{i=1}^{K} C_{i}} = \\frac{83 + 30 + 160 + 55 + 24}{700} = \\frac{352}{700} \\approx 0.50285714 $$\n    四舍五入至五位有效数字，$\\bar{p} \\approx 0.50286$。\n\n2.  **计算亚群内杂合度 $H_{i}$ 和平均值 $H_{S}$**。\n    每个亚群的期望杂合度为 $H_{i} = 2 p_{i} (1 - p_{i})$。\n    $$ H_{1} = 2 \\times 0.415 \\times (1 - 0.415) = 2 \\times 0.415 \\times 0.585 = 0.48555 $$\n    $$ H_{2} = 2 \\times 0.3 \\times (1 - 0.3) = 2 \\times 0.3 \\times 0.7 = 0.42 $$\n    $$ H_{3} = 2 \\times 0.8 \\times (1 - 0.8) = 2 \\times 0.8 \\times 0.2 = 0.32 $$\n    $$ H_{4} = 2 \\times 0.55 \\times (1 - 0.55) = 2 \\times 0.55 \\times 0.45 = 0.495 $$\n    $$ H_{5} = 2 \\times 0.24 \\times (1 - 0.24) = 2 \\times 0.24 \\times 0.76 = 0.3648 $$\n    平均亚群内杂合度 $H_{S}$ 是 $H_{i}$ 值的加权平均值。\n    $$ H_{S} = \\sum_{i=1}^{K} w_{i} H_{i} = \\frac{2}{7}(0.48555) + \\frac{1}{7}(0.42) + \\frac{2}{7}(0.32) + \\frac{1}{7}(0.495) + \\frac{1}{7}(0.3648) $$\n    $$ H_{S} = \\frac{2 \\times 0.48555 + 0.42 + 2 \\times 0.32 + 0.495 + 0.3648}{7} = \\frac{0.9711 + 0.42 + 0.64 + 0.495 + 0.3648}{7} $$\n    $$ H_{S} = \\frac{2.8909}{7} \\approx 0.41298571 $$\n    四舍五入至五位有效数字，$H_{S} \\approx 0.41299$。\n\n3.  **计算总期望杂合度 $H_{T}$**。\n    这是如果所有亚群的集合是一个单一的泛交群体时的期望杂合度，$H_{T} = 2 \\bar{p} (1 - \\bar{p})$。\n    使用未四舍五入的值 $\\bar{p} = 352/700$：\n    $$ H_{T} = 2 \\times \\frac{352}{700} \\times \\left(1 - \\frac{352}{700}\\right) = 2 \\times \\frac{352}{700} \\times \\frac{348}{700} = \\frac{245088}{490000} \\approx 0.49997551 $$\n    四舍五入至五位有效数字，$H_{T} \\approx 0.49998$。\n\n4.  **计算固定指数 $F_{ST}$**。\n    固定指数衡量由于亚结构导致的总群体中杂合子的缺失。其定义为 $F_{ST} = (H_{T} - H_{S}) / H_{T}$。\n    使用 $H_{T}$ 和 $H_{S}$ 的未四舍五入值：\n    $$ F_{ST} = \\frac{0.49997551 - 0.41298571}{0.49997551} = \\frac{0.0869898}{0.49997551} \\approx 0.17400190 $$\n    四舍五入至五位有效数字，$F_{ST} \\approx 0.17400$。\n\n5.  **推断每代迁移个体数 $Nm$**。\n    在平衡状态下的 Wright 岛屿模型中，$F_{ST}$ 与 $Nm$ 的关系近似为 $F_{ST} \\approx \\frac{1}{4Nm + 1}$。我们可以解出 $Nm$：\n    $$ 4Nm + 1 = \\frac{1}{F_{ST}} $$\n    $$ 4Nm = \\frac{1}{F_{ST}} - 1 $$\n    $$ Nm = \\frac{1}{4} \\left( \\frac{1}{F_{ST}} - 1 \\right) $$\n    使用未四舍五入的值 $F_{ST} \\approx 0.17400190$：\n    $$ Nm = \\frac{1}{4} \\left( \\frac{1}{0.17400190} - 1 \\right) = \\frac{1}{4} (5.7470588 - 1) = \\frac{4.7470588}{4} \\approx 1.1867647 $$\n    四舍五入至五位有效数字，$Nm \\approx 1.1868$。\n\n最终结果序列，四舍五入至五位有效数字，为：\n$\\bar{p} \\approx 0.50286$\n$H_{S} \\approx 0.41299$\n$H_{T} \\approx 0.49998$\n$F_{ST} \\approx 0.17400$\n$Nm \\approx 1.1868$", "answer": "$$ \\boxed{\\begin{pmatrix} 0.50286 & 0.41299 & 0.49998 & 0.17400 & 1.1868 \\end{pmatrix}} $$", "id": "3338795"}, {"introduction": "除了单个基因座的变异，等位基因在不同基因座之间的关联——即连锁不平衡（Linkage Disequilibrium, LD）——也是群体遗传学分析的核心。连锁不平衡是遗传关联研究、选择信号扫描和群体历史推断的基础。本练习将理论与计算实践相结合，要求您探索重组是如何随时间削弱LD的。您将推导并实施一个模型，以验证观察到的单倍型频率变化是否符合重组驱动下LD衰减的理论预测，从而深入理解基因组的动态演化过程[@problem_id:3338808]。", "problem": "考虑两个双等位基因座，其等位基因分别表示为 $A/a$ 和 $B/b$。在一个无选择、无迁移、无突变的随机交配群体中，假设这两个基因座之间的重组率为 $r$。在第 $0$ 代和第 $t$ 代各进行一次抽样，你观察到了单倍型 $AB$、$Ab$、$aB$ 和 $ab$ 的计数。从单倍型频率和等位基因频率的核心定义出发，定义连锁不平衡度量 $D$ 和基因座间的平方相关系数 $r^2$，并仅在重组作用下推导 $D$ 的世代递推关系。然后，实现这些推导，以计算第 $0$ 代和第 $t$ 代的 $D$ 和 $r^2$，并检验从第 $0$ 代到第 $t$ 代观察到的 $D$ 的衰减是否与随机交配下的因子 $(1 - r)^t$ 一致。\n\n你的程序必须：\n- 将第 $0$ 代和第 $t$ 代观察到的单倍型计数转换为单倍型频率，并由此使用基于单倍型和等位基因频率的连锁不平衡定义计算 $D_0$ 和 $D_t$。\n- 使用基于 $D$ 和边际等位基因频率的定义，计算第 $0$ 代和第 $t$ 代的 $r^2$。\n- 使用给定的重组率 $r$ 和世代数 $t$，通过你推导出的递推关系，计算仅在重组作用下预测的 $D_t$。\n- 通过计算绝对差 $\\delta = |D_t - D_0 (1 - r)^t|$ 来比较观察到的 $D_t$ 和预测的 $D_t$。如果 $\\delta \\le \\epsilon$，则声明匹配，其中 $\\epsilon$ 是一个固定的容差，等于 $10^{-3}$。\n- 如果任一基因座是单态的，导致 $r^2$ 分母中的方差项为零，则为了计算目的，将该世代的 $r^2$ 定义为 $0$。\n\n使用以下测试套件。每个测试用例是一个元组，包含第 $0$ 代的单倍型计数 $(n_{AB}^{(0)}, n_{Ab}^{(0)}, n_{aB}^{(0)}, n_{ab}^{(0)})$、第 $t$ 代的单倍型计数 $(n_{AB}^{(t)}, n_{Ab}^{(t)}, n_{aB}^{(t)}, n_{ab}^{(t)})$、世代数 $t$ 和重组率 $r$：\n- 测试用例 1（中等重组率和非零 $D$ 的一般情况）：$((3000, 3000, 1000, 3000), (2754, 3246, 1246, 2754), 5, 0.1)$。\n- 测试用例 2（$r = 0$ 的边界情况，因此 $D$ 不衰减）：$((700, 300, 300, 700), (700, 300, 300, 700), 7, 0.0)$。\n- 测试用例 3（接近最大重组率 $r \\approx 0.5$，快速衰减）：$((2080, 3520, 320, 2080), (1705, 3895, 695, 1705), 4, 0.5)$。\n- 测试用例 4（连锁平衡时初始 $D \\approx 0$）：$((1200, 800, 1800, 1200), (1200, 800, 1800, 1200), 10, 0.2)$。\n\n你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，列表中的每个条目对应一个测试用例，并且是一个布尔值，指示观察到的 $D$ 的衰减是否在容差 $\\epsilon = 10^{-3}$ 内与预测的 $(1 - r)^t$ 匹配。确切的输出格式必须是 $[b_1,b_2,b_3,b_4]$，其中每个 $b_i$ 都是纯文本的 $True$ 或 $False$，不含任何额外字符或空格。", "solution": "该问题要求推导并应用群体遗传学简化模型中重组对连锁不平衡（$D$）影响的基本方程。我们需要验证在两个时间点（第 $0$ 代和第 $t$ 代）之间观察到的单倍型频率变化是否与 $D$ 的理论衰减一致。\n\n首先，我们建立必要的定义。设两个双等位基因座（$A/a$ 和 $B/b$）的四种可能单倍型的频率表示为 $p_{AB}$、$p_{Ab}$、$p_{aB}$ 和 $p_{ab}$。这些频率通过样本计数（$n_{AB}$、$n_{Ab}$、$n_{aB}$、$n_{ab}$）除以总样本量 $N = n_{AB} + n_{Ab} + n_{aB} + n_{ab}$ 来估计。这些频率之和为1：$p_{AB} + p_{Ab} + p_{aB} + p_{ab} = 1$。\n\n根据这些单倍型频率，我们可以定义等位基因 $A$（$p_A$）、等位基因 $a$（$p_a$）、等位基因 $B$（$p_B$）和等位基因 $b$（$p_b$）的边际等位基因频率：\n$$ p_A = p_{AB} + p_{Ab} $$\n$$ p_a = p_{aB} + p_{ab} = 1 - p_A $$\n$$ p_B = p_{AB} + p_{aB} $$\n$$ p_b = p_{Ab} + p_{ab} = 1 - p_B $$\n在指定的模型下（随机交配、无选择、突变或迁移），这些等位基因频率在一个无限大的群体中跨代保持不变。\n\n连锁不平衡 $D$ 量化了两个基因座上等位基因的非随机关联。它被定义为给定单倍型（例如 $AB$）的频率与在随机关联（连锁平衡）下期望频率的偏差，期望频率是相应等位基因频率的乘积。\n$$ D = p_{AB} - p_A p_B $$\n利用单倍型频率和等位基因频率之间的关系，我们可以证明这个定义可以导出其他单倍型的等价表达式：\n$p_{Ab} = p_A(1-p_B) - D = p_A p_b - D$\n$p_{aB} = (1-p_A)p_B - D = p_a p_B - D$\n$p_{ab} = (1-p_A)(1-p_B) + D = p_a p_b + D$\n一个对称且常用的计算 $D$ 的公式是 $D = p_{AB}p_{ab} - p_{Ab}p_{aB}$。这可以从主定义推导出来：\n$p_{AB}p_{ab} - p_{Ab}p_{aB} = (p_A p_B + D)(p_a p_b + D) - (p_A p_b - D)(p_a p_B - D)$\n$= (p_A p_B p_a p_b + D(p_A p_B + p_a p_b) + D^2) - (p_A p_b p_a p_B - D(p_A p_b + p_a p_B) + D^2)$\n$= D(p_A p_B + p_a p_b + p_A p_b + p_a p_B) = D(p_A(p_B+p_b) + p_a(p_b+p_B)) = D(p_A + p_a) = D$。\n\n平方相关系数 $r^2$ 是 $D$ 的一个标准化度量，它较少依赖于等位基因频率：\n$$ r^2 = \\frac{D^2}{p_A p_a p_B p_b} $$\n分母 $p_A p_a p_B p_b$ 是两个基因座方差的乘积，假设对等位基因进行二进制编码（例如，$A=1, a=0$）。如果任一基因座是单态的（例如，$p_A=1$ 或 $p_A=0$），该分母为零，此时 $r^2$ 定义为 $0$。\n\n接下来，我们推导 $D$ 的跨代递推关系。在一个随机交配的群体中，下一代配子池中的单倍型频率由当前代的频率和重组率 $r$ 决定。比例为 $(1-r)$ 的单倍型是非重组的，而比例为 $r$ 的单倍型是重组的。在第 $t+1$ 代，$AB$ 单倍型的频率，记为 $p_{AB, t+1}$，由以下公式给出：\n$$ p_{AB, t+1} = (1-r) p_{AB, t} + r p_{A,t} p_{B,t} $$\n第一项代表了从第 $t$ 代遗传下来且未发生重组的 $AB$ 单倍型。第二项代表了通过重组事件形成的新 $AB$ 单倍型，这些事件将来自同源染色体的 $A$ 等位基因和 $B$ 等位基因组合在一起。在一个随机交配的群体中，这种重组配对的频率与等位基因频率的乘积成正比。由于等位基因频率 $p_A$ 和 $p_B$ 随时间保持不变，我们可以省略下标 $t$。\n\n现在我们可以写出 $D_{t+1}$ 的递推关系：\n$$ D_{t+1} = p_{AB, t+1} - p_A p_B $$\n代入 $p_{AB, t+1}$ 的表达式：\n$$ D_{t+1} = \\left( (1-r) p_{AB, t} + r p_A p_B \\right) - p_A p_B $$\n$$ D_{t+1} = (1-r) p_{AB, t} - p_A p_B (1-r) $$\n$$ D_{t+1} = (1-r) (p_{AB, t} - p_A p_B) $$\n$$ D_{t+1} = (1-r) D_t $$\n这个简单的递推关系表明，连锁不平衡每代都以 $(1-r)$ 的因子呈几何级数衰减。通过展开递推，我们得到第 $t$ 代的 $D$ 值，作为其初始值 $D_0$ 的函数：\n$$ D_t = (1-r)^t D_0 $$\n\n解决每个测试用例的计算步骤如下：\n1.  对于第 $0$ 代的数据 $(n_{AB}^{(0)}, n_{Ab}^{(0)}, n_{aB}^{(0)}, n_{ab}^{(0)})$，计算总计数 $N_0$ 以及相应的单倍型频率 $p_{AB,0}, p_{Ab,0}, p_{aB,0}, p_{ab,0}$。\n2.  根据这些频率，计算等位基因频率 $p_{A,0}$ 和 $p_{B,0}$。\n3.  计算初始连锁不平衡 $D_0 = p_{AB,0} - p_{A,0} p_{B,0}$。\n4.  对第 $t$ 代的数据重复步骤 1 和 2，以找到观察到的单倍型和等位基因频率，然后计算观察到的连锁不平衡 $D_t^{obs} = p_{AB,t} - p_{A,t} p_{B,t}$。问题设定保证了样本间的等位基因频率是恒定的。\n5.  使用推导出的公式计算第 $t$ 代的预测连锁不平衡：$D_t^{pred} = D_0 (1-r)^t$。\n6.  计算绝对差 $\\delta = |D_t^{obs} - D_t^{pred}|$。\n7.  将 $\\delta$ 与容差 $\\epsilon = 10^{-3}$ 进行比较。如果 $\\delta \\le \\epsilon$，则观察到的衰减与模型一致，结果为 `True`；否则为 `False`。\n根据定义，还需计算两代的 $r^2$，并处理基因座单态的情况。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the population genetics problem for a suite of test cases.\n    \"\"\"\n\n    # Test suite as defined in the problem description.\n    test_cases = [\n        # ((n_AB0, n_Ab0, n_aB0, n_ab0), (n_ABt, n_Abt, n_aBt, n_abt), t, r)\n        ((3000, 3000, 1000, 3000), (2754, 3246, 1246, 2754), 5, 0.1),\n        ((700, 300, 300, 700), (700, 300, 300, 700), 7, 0.0),\n        ((2080, 3520, 320, 2080), (1705, 3895, 695, 1705), 4, 0.5),\n        ((1200, 800, 1800, 1200), (1200, 800, 1800, 1200), 10, 0.2),\n    ]\n\n    tolerance = 1e-3\n    results = []\n\n    for case in test_cases:\n        counts_0, counts_t, t, r = case\n        \n        # --- Analyze Generation 0 ---\n        # Convert counts to numpy array for vectorized operations\n        counts_0_arr = np.array(counts_0, dtype=float)\n        N_0 = counts_0_arr.sum()\n        \n        if N_0 == 0:\n            # If there's no sample, the state is undefined.\n            # For this problem, we can assume N > 0 based on test cases.\n            results.append(False) # Or some other error indicator\n            continue\n            \n        # Haplotype frequencies: p_AB, p_Ab, p_aB, p_ab\n        freqs_0 = counts_0_arr / N_0\n        p_AB_0, p_Ab_0, p_aB_0, p_ab_0 = freqs_0\n\n        # Allele frequencies\n        p_A_0 = p_AB_0 + p_Ab_0\n        p_a_0 = 1.0 - p_A_0\n        p_B_0 = p_AB_0 + p_aB_0\n        p_b_0 = 1.0 - p_B_0\n\n        # Linkage Disequilibrium D_0\n        D_0 = p_AB_0 - p_A_0 * p_B_0\n        \n        # Squared correlation r^2_0\n        r2_denom_0 = p_A_0 * p_a_0 * p_B_0 * p_b_0\n        r_sq_0 = (D_0**2 / r2_denom_0) if r2_denom_0 > 0 else 0.0\n\n        # --- Analyze Generation t ---\n        counts_t_arr = np.array(counts_t, dtype=float)\n        N_t = counts_t_arr.sum()\n\n        if N_t == 0:\n            results.append(False)\n            continue\n        \n        # Haplotype frequencies: p_AB, p_Ab, p_aB, p_ab\n        freqs_t = counts_t_arr / N_t\n        p_AB_t, p_Ab_t, p_aB_t, p_ab_t = freqs_t\n\n        # Allele frequencies\n        p_A_t = p_AB_t + p_Ab_t\n        p_a_t = 1.0 - p_A_t\n        p_B_t = p_AB_t + p_aB_t\n        p_b_t = 1.0 - p_B_t\n\n        # Observed Linkage Disequilibrium D_t_obs\n        D_t_obs = p_AB_t - p_A_t * p_B_t\n\n        # Squared correlation r^2_t\n        r2_denom_t = p_A_t * p_a_t * p_B_t * p_b_t\n        r_sq_t = (D_t_obs**2 / r2_denom_t) if r2_denom_t > 0 else 0.0\n\n        # --- Prediction and Comparison ---\n        # Predicted D at generation t based on theory\n        D_t_pred = D_0 * (1.0 - r)**t\n\n        # Absolute difference between observed and predicted D_t\n        delta = abs(D_t_obs - D_t_pred)\n\n        # Check if the difference is within the specified tolerance\n        match = delta = tolerance\n        results.append(match)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3338808"}]}