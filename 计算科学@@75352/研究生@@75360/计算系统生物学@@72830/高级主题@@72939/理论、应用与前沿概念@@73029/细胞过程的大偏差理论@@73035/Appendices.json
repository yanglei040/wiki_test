{"hands_on_practices": [{"introduction": "大偏差理论为量化稀有事件的概率提供了一个数学框架。本节的第一个练习将通过一个基本但极其重要的例子，带领我们从第一性原理出发，推导经验频率分布的率函数 $I(f)$。通过分析从一个多项分布中独立抽样得到的经验直方图 [@problem_id:3322434]，我们将看到描述经验分布偏离真实分布的概率“代价”的，正是在信息论中至关重要的库尔贝克-莱布勒（Kullback-Leibler）散度。", "problem": "在一个克隆细菌种群的快照分析中，观测到在测量瞬间，每个细胞的启动子精确处于 $K$ 个不同构象状态中的一个。假设从 $n$ 个独立采样的细胞中，每个细胞的启动子状态是从一个未知但固定的稳态分布 $p = (p_{1},\\dots,p_{K})$ 中进行的独立同分布抽样，其中 $p_{k} \\in (0,1)$ 且 $\\sum_{k=1}^{K} p_{k} = 1$。令 $N_{k}$ 表示在状态 $k$ 中观测到的细胞数量，并定义经验直方图 $f = (f_{1},\\dots,f_{K})$，其中 $f_{k} = N_{k}/n$，因此 $f_{k} \\ge 0$ 且 $\\sum_{k=1}^{K} f_{k} = 1$。\n\n请仅使用独立分类抽样的第一性原理、多项式计数公式以及基于Stirling阶乘公式的渐近近似，推导大偏差率函数 $I(f)$。该函数支配经验直方图 $f$ 偏离真实分布 $p$ 的概率随 $n$ 的指数衰减。特别地，证明存在一个函数 $I(f)$，使得经验直方图位于 $f$ 的一个小邻域内的概率遵循 $\\exp(-n\\,I(f) + o(n))$ 形式的指数标度（当 $n \\to \\infty$ 时），并在约束条件 $\\sum_{k=1}^{K} f_{k} = 1$、$f_{k} \\ge 0$ 和 $p_{k} \\in (0,1)$ 下，确定 $I(f)$ 的显式闭式表达式。\n\n您的推导必须从多项式模型下观测到计数 $(N_{1},\\dots,N_{K})$ 的概率开始，然后通过使用Stirling近似对其对数进行渐近评估至 $n$ 的主导阶，仔细论证单纯形约束的出现，并识别出在指数尺度上保留的项。请以闭式形式提供 $I(f)$ 的最终表达式。不需要进行数值计算，也不需要单位。最终答案必须是单个闭式解析表达式。", "solution": "该问题要求为独立同分布（i.i.d.）分类样本的经验直方图推导大偏差率函数。我将首先验证问题陈述。\n\n### 步骤1：提取已知条件\n- 一个由从克隆细菌种群中独立抽样的 $n$ 个细胞组成的系统。\n- 每个细胞的启动子处于 $K$ 个不同构象状态之一。\n- 每个细胞的状态是从一个稳态分布 $p = (p_{1},\\dots,p_{K})$ 中进行的独立同分布抽样。\n- 对于真实分布，$p_{k} \\in (0,1)$ 对所有 $k \\in \\{1, \\dots, K\\}$ 成立，并且 $\\sum_{k=1}^{K} p_{k} = 1$。\n- $N_{k}$ 是在状态 $k$ 中观测到的细胞数，因此 $\\sum_{k=1}^{K} N_{k} = n$。\n- 经验直方图为 $f = (f_{1},\\dots,f_{K})$，其中 $f_{k} = N_{k}/n$。\n- 对于经验直方图，对所有 $k$ 都有 $f_{k} \\ge 0$，并且 $\\sum_{k=1}^{K} f_{k} = 1$。\n- 任务是推导大偏差率函数 $I(f)$，它决定了渐近概率 $P(f) \\sim \\exp(-n\\,I(f))$。\n- 推导必须从多项式计数公式开始，并使用Stirling阶乘近似。\n\n### 步骤2：使用提取的已知条件进行验证\n该问题具有科学依据。独立同分布分类试验模型是概率论和统计力学的基石，其在生物学中对启动子状态的应用是计算系统生物学中的一个标准例子。该问题要求推导与有限字母表的Sanov定理相关的率函数，这是大偏差理论中的一个经典和基本结果。所有术语在数学和物理学中都有明确的定义。该问题是适定的，具有明确的目标和足够的信息来达成一个唯一的、有意义的解。语言客观而精确。因此，该问题是有效的。\n\n### 步骤3：结论与行动\n问题有效。将提供完整的推导过程。\n\n### 率函数 $I(f)$ 的推导\n\n我们从第一性原理开始。该系统由 $n$ 次独立试验组成，每次试验（观测一个细胞的启动子状态）产生 $K$ 个结果中的一个。结果 $k$ 的概率由 $p_k$ 给出。\n\n观测到特定结果序列（例如，细胞1处于状态 $k_1$，细胞2处于状态 $k_2$，...，细胞 $n$ 处于状态 $k_n$）的概率由各个概率的乘积给出，这是由于独立性：\n$$P(\\text{sequence}) = \\prod_{i=1}^{n} p_{k_i}$$\n如果该序列产生一组计数 $(N_1, N_2, \\dots, N_K)$，其中 $N_k$ 是状态 $k$ 在序列中出现的次数，则该概率可以写为：\n$$P(\\text{sequence}) = \\prod_{k=1}^{K} p_k^{N_k}$$\n然而，我们感兴趣的是观测到计数集合 $(N_1, \\dots, N_K)$ 的概率，而不是一个特定的序列。许多不同的序列可以导致相同的计数集合。这种不同序列的数量由多项式系数给出：\n$$\\binom{n}{N_1, N_2, \\dots, N_K} = \\frac{n!}{N_1! N_2! \\dots N_K!}$$\n观测到计数 $(N_1, \\dots, N_K)$ 的总概率是实现这些计数的方式数量与实现这些计数的任何一个特定序列的概率的乘积。这定义了多项式分布：\n$$P(N_1, \\dots, N_K) = \\frac{n!}{N_1! N_2! \\dots N_K!} \\prod_{k=1}^{K} p_k^{N_k}$$\n问题要求的是与经验直方图 $f = (f_1, \\dots, f_K)$ 相关的率函数 $I(f)$，其中 $f_k = N_k/n$。我们分析此概率在 $n$ 很大时的渐近行为。处理概率的对数更为方便。让我们将特定经验直方图 $f$ 的概率表示为 $P_n(f)$，它等价于 $P(N_1=nf_1, \\dots, N_K=nf_K)$，假设每个 $nf_k$ 都是整数。\n$$\\ln(P_n(f)) = \\ln(n!) - \\sum_{k=1}^{K} \\ln(N_k!) + \\sum_{k=1}^{K} N_k \\ln(p_k)$$\n为了在大 $n$ 的情况下评估此表达式，我们使用Stirling近似来处理阶乘的对数，即对于大的 $m$，$\\ln(m!) \\approx m \\ln m - m$。这是主导阶近似。将此应用于 $\\ln(n!)$ 和每个 $\\ln(N_k!)$，得到：\n$$\\ln(P_n(f)) \\approx (n \\ln n - n) - \\sum_{k=1}^{K} (N_k \\ln N_k - N_k) + \\sum_{k=1}^{K} N_k \\ln(p_k)$$\n我们可以简化涉及 $n$ 和 $N_k$ 减法的项。由于 $\\sum_{k=1}^{K} N_k = n$，我们有：\n$$-n - \\sum_{k=1}^{K} (-N_k) = -n + \\sum_{k=1}^{K} N_k = -n + n = 0$$\n因此，这些项相互抵消，剩下：\n$$\\ln(P_n(f)) \\approx n \\ln n - \\sum_{k=1}^{K} N_k \\ln N_k + \\sum_{k=1}^{K} N_k \\ln(p_k)$$\n现在，我们代入 $N_k = n f_k$。表达式完全用 $n$ 和经验频率 $f_k$ 表示：\n$$\\ln(P_n(f)) \\approx n \\ln n - \\sum_{k=1}^{K} (n f_k) \\ln(n f_k) + \\sum_{k=1}^{K} (n f_k) \\ln(p_k)$$\n使用对数性质 $\\ln(ab) = \\ln a + \\ln b$，我们展开 $\\ln(n f_k)$ 项：\n$$\\ln(P_n(f)) \\approx n \\ln n - \\sum_{k=1}^{K} n f_k (\\ln n + \\ln f_k) + \\sum_{k=1}^{K} n f_k \\ln(p_k)$$\n让我们分配并重排各项求和：\n$$\\ln(P_n(f)) \\approx n \\ln n - \\left(\\sum_{k=1}^{K} n f_k \\ln n\\right) - \\left(\\sum_{k=1}^{K} n f_k \\ln f_k\\right) + \\left(\\sum_{k=1}^{K} n f_k \\ln(p_k)\\right)$$\n提出公因式 $n$ 和 $n \\ln n$：\n$$\\ln(P_n(f)) \\approx n \\ln n - n \\ln n \\left(\\sum_{k=1}^{K} f_k\\right) - n \\left(\\sum_{k=1}^{K} f_k \\ln f_k\\right) + n \\left(\\sum_{k=1}^{K} f_k \\ln(p_k)\\right)$$\n根据经验直方图的定义，频率总和必须为1：$\\sum_{k=1}^{K} f_k = 1$。这就是单纯形约束。应用此约束，前两项抵消：\n$$n \\ln n - n \\ln n (1) = 0$$\n$\\ln(P_n(f))$ 的表达式简化为：\n$$\\ln(P_n(f)) \\approx - n \\sum_{k=1}^{K} f_k \\ln f_k + n \\sum_{k=1}^{K} f_k \\ln(p_k)$$\n合并这两个和：\n$$\\ln(P_n(f)) \\approx -n \\sum_{k=1}^{K} \\left( f_k \\ln f_k - f_k \\ln(p_k) \\right)$$\n使用性质 $\\ln a - \\ln b = \\ln(a/b)$：\n$$\\ln(P_n(f)) \\approx -n \\sum_{k=1}^{K} f_k \\ln\\left(\\frac{f_k}{p_k}\\right)$$\n问题陈述假设概率具有渐近形式 $P_n(f) \\approx \\exp(-n I(f) + o(n))$。我们的推导表明 $\\ln(P_n(f)) = -n \\sum_{k=1}^{K} f_k \\ln\\left(\\frac{f_k}{p_k}\\right) + \\text{次导项}$。更仔细地应用Stirling公式，$\\ln(m!) = m\\ln m - m + \\frac{1}{2}\\ln(2\\pi m) + O(1/m)$，会发现次导项的阶数为 $\\mathcal{O}(\\ln n)$。由于 $\\lim_{n\\to\\infty} \\frac{\\ln n}{n} = 0$，这些项对应于指数中的 $o(n)$ 项。\n具体来说，我们有：\n$$\\frac{1}{n} \\ln(P_n(f)) \\approx -\\sum_{k=1}^{K} f_k \\ln\\left(\\frac{f_k}{p_k}\\right)$$\n因此，在 $n \\to \\infty$ 的极限下，我们可以将率函数 $I(f)$ 确定为指数中与 $n$ 线性伸缩的项：\n$$I(f) = \\lim_{n\\to\\infty} -\\frac{1}{n}\\ln(P_n(f)) = \\sum_{k=1}^{K} f_k \\ln\\left(\\frac{f_k}{p_k}\\right)$$\n这个表达式是经验分布 $f$ 和真实分布 $p$ 之间的Kullback-Leibler (KL) 散度，或称相对熵，通常记为 $D_{KL}(f || p)$。它是一个非负函数，$I(f) \\ge 0$，且 $I(f)=0$ 当且仅当对所有 $k$ 都有 $f_k = p_k$。这与大数定律一致，大数定律指出，观测到不同于真实分布的经验直方图的概率随着样本数量的增加而呈指数级减小。函数 $I(f)$ 量化了这种偏差的“代价”。\n因此，率函数的最终闭式表达式就确定了。", "answer": "$$\\boxed{\\sum_{k=1}^{K} f_{k} \\ln\\left(\\frac{f_{k}}{p_{k}}\\right)}$$", "id": "3322434"}, {"introduction": "细胞过程本质上是动态的，而非静态的快照。在掌握了静态采样的基础后，我们转向一个更真实的场景：一个描述基因活性随机切换的连续时间马尔可夫模型。这个练习旨在计算一个核心量——标度累积量生成函数 (SCGF) $\\lambda(\\theta)$，它描述了转录产物数量的时间累积涨落。通过构建一个“倾斜”生成元并求解其主特征值 [@problem_id:3322460]，我们将把抽象的理论应用于一个具体的生物物理模型，从而深入理解动态过程中的稀有事件。", "problem": "考虑一个在充分混合细胞中单个基因的双态启动子模型。启动子的状态是一个连续时间马尔可夫链 $X_{t}\\in\\{0,1\\}$，其中 $0$ 表示非激活态 (OFF)，$1$ 表示激活态 (ON)。启动子以速率 $k_{\\mathrm{on}}$ 从 OFF 态切换到 ON 态，以速率 $k_{\\mathrm{off}}$ 从 ON 态切换到 OFF 态，因此 $X_{t}$ 的无穷小生成元为\n$$\nQ \\;=\\; \\begin{pmatrix}\n-\\,k_{\\mathrm{on}} & k_{\\mathrm{on}} \\\\\nk_{\\mathrm{off}} & -\\,k_{\\mathrm{off}}\n\\end{pmatrix}.\n$$\n当启动子处于 ON 态时，转录起始以脉冲形式发生：脉冲起始事件形成一个速率为 $\\beta$ 的泊松过程，该过程仅在 $X_{t}=1$ 时激活。每个脉冲产生随机数量 $B\\in\\{1,2,\\dots\\}$ 的信使核糖核酸 (mRNA) 分子，各脉冲之间相互独立，其数量服从参数为 $p\\in(0,1]$ 的零截断几何分布，即对于 $n\\in\\{1,2,\\dots\\}$，有 $\\mathbb{P}(B=n) = p\\,(1-p)^{n-1}$。当启动子处于 OFF 态时，不产生 mRNA。令 $N_{t}$ 表示到时间 $t$ 为止产生的 mRNA 分子总数（计算所有脉冲中的所有分子）。\n\n定义时间累加的可观测计数 $N_{t}$ 的标度累积量生成函数 (SCGF) $\\lambda(\\theta)$ 如下：\n$$\n\\lambda(\\theta) \\;=\\; \\lim_{t\\to\\infty} \\frac{1}{t}\\,\\ln \\mathbb{E}\\!\\left[\\exp\\!\\left(\\theta\\,N_{t}\\right)\\right],\n$$\n其中 $\\theta$ 为实数，且矩生成函数在该 $\\theta$ 处是有限的。使用连续时间马尔可夫链的 Feynman–Kac 表示，结合复合泊松过程的矩生成函数，构建控制与 $\\exp(\\theta N_{t})$ 相关的矩生成半群的倾斜生成元 $L_{\\theta}$，然后显式计算其主特征值。您的答案必须是关于 $k_{\\mathrm{on}}$、$k_{\\mathrm{off}}$、$\\beta$、$p$ 和 $\\theta$ 的单一闭合形式解析表达式 $\\lambda(\\theta)$。最终答案中不得包含任何中间结果。您可以假设 $\\theta$ 满足使几何脉冲矩生成函数存在的条件。\n\n最终答案必须是单一的解析表达式。不需要进行数值计算。", "solution": "问题要求计算由具有随机切换启动子的基因产生的 mRNA 分子总数 $N_t$ 的标度累积量生成函数 (SCGF) $\\lambda(\\theta)$。SCGF 定义为 $\\lambda(\\theta) = \\lim_{t\\to\\infty} \\frac{1}{t}\\,\\ln \\mathbb{E}[\\exp(\\theta N_t)]$。根据连续时间马尔可夫链的大偏差理论，此 SCGF 是倾斜生成矩阵 $L_{\\theta}$ 的主特征值。\n\n系统的状态可以用启动子状态 $X_t \\in \\{0, 1\\}$ 来描述。以启动子状态为条件的期望演化由一个倾斜生成元控制。令 $u_i(t, \\theta) = \\mathbb{E}[\\exp(\\theta N_t) | X_0 = i]$，其中 $i \\in \\{0, 1\\}$。这些期望的向量 $\\mathbf{u}(t, \\theta) = (u_0(t, \\theta), u_1(t, \\theta))^T$ 遵循微分方程 $\\frac{d}{dt}\\mathbf{u}(t,\\theta) = L_{\\theta} \\mathbf{u}(t,\\theta)$。对于大的 $t$，解由 $L_{\\theta}$ 的最大特征值主导，即 $\\lambda(\\theta)$。\n\n倾斜生成元 $L_{\\theta}$ 是通过将对角矩阵 $V(\\theta)$ 加到启动子切换过程的无穷小生成元 $Q$ 上来构建的，即 $L_{\\theta} = Q + V(\\theta)$。矩阵 $Q$ 如下所示：\n$$\nQ = \\begin{pmatrix} -k_{\\mathrm{on}} & k_{\\mathrm{on}} \\\\ k_{\\mathrm{off}} & -k_{\\mathrm{off}} \\end{pmatrix}\n$$\n对角矩阵 $V(\\theta) = \\mathrm{diag}(V_{00}(\\theta), V_{11}(\\theta))$ 描述了在每种状态下 mRNA 的产生。项 $V_{ii}(\\theta)$ 是当启动子处于状态 $i$ 时，生成过程的累积量生成函数。\n\n1.  **状态 0 (OFF):** 不产生 mRNA。这意味着当 $X_t=0$ 时，分子数 $N_t$ 不增加。生成速率为 0，因此对 SCGF 的相应贡献为零。\n    $$\n    V_{00}(\\theta) = 0\n    $$\n\n2.  **状态 1 (ON):** 转录以复合泊松过程的形式发生。脉冲以速率 $\\beta$ 起始，每个脉冲产生随机数量 $B$ 的 mRNA 分子。$B$ 的分布是零截断几何分布，$\\mathbb{P}(B=n) = p(1-p)^{n-1}$，其中 $n \\in \\{1, 2, \\dots\\}$。复合泊松过程的累积量生成函数由 $\\beta (\\mathbb{E}[\\exp(\\theta B)] - 1)$ 给出。这就得到了倾斜项 $V_{11}(\\theta)$。\n    首先，我们计算脉冲大小 $B$ 的矩生成函数 (MGF)，$M_B(\\theta) = \\mathbb{E}[\\exp(\\theta B)]$。\n    $$\n    M_B(\\theta) = \\sum_{n=1}^{\\infty} \\exp(\\theta n) \\mathbb{P}(B=n) = \\sum_{n=1}^{\\infty} \\exp(\\theta n) p(1-p)^{n-1}\n    $$\n    我们可以将其重写为几何级数：\n    $$\n    M_B(\\theta) = p \\exp(\\theta) \\sum_{n=1}^{\\infty} [\\exp(\\theta)(1-p)]^{n-1} = p \\exp(\\theta) \\sum_{k=0}^{\\infty} [\\exp(\\theta)(1-p)]^k\n    $$\n    当 $|\\exp(\\theta)(1-p)|  1$ 时，该几何级数收敛，这是题目陈述中假设的条件。级数的和为 $\\frac{1}{1-\\exp(\\theta)(1-p)}$。\n    $$\n    M_B(\\theta) = \\frac{p \\exp(\\theta)}{1 - (1-p)\\exp(\\theta)}\n    $$\n    现在，我们求 $V_{11}(\\theta)$：\n    $$\n    V_{11}(\\theta) = \\beta (M_B(\\theta) - 1) = \\beta \\left( \\frac{p \\exp(\\theta)}{1 - (1-p)\\exp(\\theta)} - 1 \\right)\n    $$\n    化简括号中的表达式：\n    $$\n    V_{11}(\\theta) = \\beta \\left( \\frac{p \\exp(\\theta) - [1 - (1-p)\\exp(\\theta)]}{1 - (1-p)\\exp(\\theta)} \\right) = \\beta \\left( \\frac{p \\exp(\\theta) - 1 + \\exp(\\theta) - p\\exp(\\theta)}{1 - (1-p)\\exp(\\theta)} \\right)\n    $$\n    $$\n    V_{11}(\\theta) = \\beta \\frac{\\exp(\\theta) - 1}{1 - (1-p)\\exp(\\theta)}\n    $$\n\n现在我们可以写出完整的倾斜生成元 $L_{\\theta}$：\n$$\nL_{\\theta} = Q + V(\\theta) = \\begin{pmatrix} -k_{\\mathrm{on}}  k_{\\mathrm{on}} \\\\ k_{\\mathrm{off}}  -k_{\\mathrm{off}} + V_{11}(\\theta) \\end{pmatrix}\n$$\nSCGF $\\lambda(\\theta)$ 是 $L_{\\theta}$ 的主（最大）特征值。特征值是特征方程 $\\det(L_{\\theta} - \\lambda I) = 0$ 的根。\n$$\n\\det\\begin{pmatrix} -k_{\\mathrm{on}} - \\lambda  k_{\\mathrm{on}} \\\\ k_{\\mathrm{off}}  -k_{\\mathrm{off}} + V_{11}(\\theta) - \\lambda \\end{pmatrix} = 0\n$$\n$$\n(-k_{\\mathrm{on}} - \\lambda)(-k_{\\mathrm{off}} + V_{11}(\\theta) - \\lambda) - k_{\\mathrm{on}}k_{\\mathrm{off}} = 0\n$$\n展开此式得到关于 $\\lambda$ 的二次方程：\n$$\n\\lambda^2 - (-k_{\\mathrm{on}} - k_{\\mathrm{off}} + V_{11}(\\theta))\\lambda + (-k_{\\mathrm{on}})(-k_{\\mathrm{off}} + V_{11}(\\theta)) - k_{\\mathrm{on}}k_{\\mathrm{off}} = 0\n$$\n$$\n\\lambda^2 + (k_{\\mathrm{on}} + k_{\\mathrm{off}} - V_{11}(\\theta))\\lambda + k_{\\mathrm{on}}k_{\\mathrm{off}} - k_{\\mathrm{on}}V_{11}(\\theta) - k_{\\mathrm{on}}k_{\\mathrm{off}} = 0\n$$\n$$\n\\lambda^2 + (k_{\\mathrm{on}} + k_{\\mathrm{off}} - V_{11}(\\theta))\\lambda - k_{\\mathrm{on}}V_{11}(\\theta) = 0\n$$\n使用二次方程求根公式 $\\lambda = \\frac{-b \\pm \\sqrt{b^2-4ac}}{2a}$，其中 $a=1$，$b=k_{\\mathrm{on}} + k_{\\mathrm{off}} - V_{11}(\\theta)$，$c=-k_{\\mathrm{on}}V_{11}(\\theta)$：\n$$\n\\lambda = \\frac{-(k_{\\mathrm{on}} + k_{\\mathrm{off}} - V_{11}(\\theta)) \\pm \\sqrt{(k_{\\mathrm{on}} + k_{\\mathrm{off}} - V_{11}(\\theta))^2 - 4(1)(-k_{\\mathrm{on}}V_{11}(\\theta))}}{2}\n$$\n$$\n\\lambda = \\frac{1}{2} \\left[ V_{11}(\\theta) - k_{\\mathrm{on}} - k_{\\mathrm{off}} \\pm \\sqrt{(k_{\\mathrm{on}} + k_{\\mathrm{off}} - V_{11}(\\theta))^2 + 4k_{\\mathrm{on}}V_{11}(\\theta)} \\right]\n$$\n主特征值 $\\lambda(\\theta)$ 是两个根中较大的一个，对应于“+”号。\n$$\n\\lambda(\\theta) = \\frac{1}{2} \\left[ V_{11}(\\theta) - k_{\\mathrm{on}} - k_{\\mathrm{off}} + \\sqrt{(k_{\\mathrm{on}} + k_{\\mathrm{off}} - V_{11}(\\theta))^2 + 4k_{\\mathrm{on}}V_{11}(\\theta)} \\right]\n$$\n代入 $V_{11}(\\theta) = \\beta \\frac{\\exp(\\theta) - 1}{1 - (1-p)\\exp(\\theta)}$ 的表达式即可得到最终的闭合形式答案。为了使最终表达式简洁，我们定义 $v(\\theta) = V_{11}(\\theta)$。\n最终表达式为：\n$$\n\\lambda(\\theta) = \\frac{1}{2} \\left[ \\beta \\frac{\\exp(\\theta) - 1}{1 - (1-p)\\exp(\\theta)} - k_{\\mathrm{on}} - k_{\\mathrm{off}} + \\sqrt{\\left(k_{\\mathrm{on}} + k_{\\mathrm{off}} - \\beta \\frac{\\exp(\\theta) - 1}{1 - (1-p)\\exp(\\theta)}\\right)^2 + 4k_{\\mathrm{on}}\\beta \\frac{\\exp(\\theta) - 1}{1 - (1-p)\\exp(\\theta)}} \\right]\n$$", "answer": "$$\n\\boxed{\\frac{1}{2} \\left( \\beta \\frac{\\exp(\\theta) - 1}{1 - (1-p)\\exp(\\theta)} - k_{\\mathrm{on}} - k_{\\mathrm{off}} + \\sqrt{\\left(k_{\\mathrm{on}} + k_{\\mathrm{off}} - \\beta \\frac{\\exp(\\theta) - 1}{1 - (1-p)\\exp(\\theta)}\\right)^{2} + 4k_{\\mathrm{on}}\\beta \\frac{\\exp(\\theta) - 1}{1 - (1-p)\\exp(\\theta)}} \\right)}\n$$", "id": "3322460"}]}