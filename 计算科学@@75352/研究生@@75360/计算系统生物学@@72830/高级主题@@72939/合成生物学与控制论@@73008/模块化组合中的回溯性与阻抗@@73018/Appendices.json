{"hands_on_practices": [{"introduction": "理解任何物理效应的第一步是量化它。这个练习 [@problem_id:3346028] 将指导您从基本原理出发，为一个下游模块通过隔离上游转录因子而产生的负载效应推导出溯感性的基本表达式。这个练习旨在通过一个简化的模型，帮助您建立对模块间负载效应的核心理解。", "problem": "由上游模块产生的浓度为 $X$ 的转录因子，调控总浓度为 $P_T$ 的下游启动子。下游启动子通过快速可逆结合反应 $X + P \\rightleftharpoons C$ 来隔离 $X$，其中 $P$ 表示游离启动子， $C$ 表示结合复合物。结合动力学遵循质量作用定律，其结合速率常数为 $k_{\\mathrm{on}}$，解离速率常数为 $k_{\\mathrm{off}}$，平衡解离常数为 $K_d = k_{\\mathrm{off}}/k_{\\mathrm{on}}$。假设结合与解离动力学远快于上游动力学，因此在 $X$ 变化的时间尺度上，结合反应处于准平衡状态。根据守恒定律，有 $P + C = P_T$。\n\n在模块化组合中，对输出的回溯性在此定义为无量纲归一化负载\n$$\nr_y \\equiv \\frac{C}{X},\n$$\n它量化了下游模块隔离的输出部分相对于游离输出的比例。\n\n仅从质量作用平衡和启动子位点守恒出发，推导出 $r_y$ 作为 $X$、$P_T$ 和 $K_d$ 的函数。然后，在弱负载条件 $P_T \\ll K_d + X$ 下，以闭合形式求出 $r_y$ 的一阶近似，并陈述使此线性化有效所必需的明确建模假设。你的最终答案必须是关于 $r_y$ 的一阶近似的单一闭合形式解析表达式，用 $P_T$、$K_d$ 和 $X$ 表示。", "solution": "在尝试解答之前，将对问题进行验证。\n\n### 第1步：提取已知条件\n-   上游模块产生浓度为 $X$ 的转录因子。\n-   下游模块的启动子总浓度为 $P_T$。\n-   发生快速可逆结合反应：$X + P \\rightleftharpoons C$，其中 $P$ 是游离启动子的浓度，$C$ 是结合复合物的浓度。\n-   反应动力学遵循质量作用定律，结合速率为 $k_{\\mathrm{on}}$，解离速率为 $k_{\\mathrm{off}}$。\n-   平衡解离常数为 $K_d = k_{\\mathrm{off}}/k_{\\mathrm{on}}$。\n-   对结合反应作了准平衡假设。\n-   启动子的守恒定律成立：$P + C = P_T$。\n-   对输出的回溯性定义为无量纲归一化负载 $r_y \\equiv \\frac{C}{X}$。\n-   弱负载条件定义为 $P_T \\ll K_d + X$。\n-   任务是推导 $r_y$ 作为 $X$、$P_T$ 和 $K_d$ 的函数，然后在弱负载条件下找到其一阶近似。\n-   最终答案必须是该近似的一个闭合形式表达式，用 $P_T$、$K_d$ 和 $X$ 表示。\n\n### 第2步：使用提取的已知条件进行验证\n该问题具有科学依据，描述了系统生物学和合成生物学中使用的转录因子-DNA结合的标准模型。回溯性（或阻抗/负载）的概念是该领域一个成熟的课题。该问题提法明确、客观且自成体系，提供了推导所求量所需的所有必要定义（$K_d, r_y$）、假设（准平衡）和约束（守恒定律）。问题设定内部一致，不违反任何科学原理。该问题并非无足轻重，因为它需要仔细的代数推导，并精确理解在此背景下“近似”和“线性化”的含义。\n\n### 第3步：结论与行动\n问题有效。将提供完整解答。\n\n### 解答推导\n推导从问题陈述的基本原理开始：质量作用平衡和启动子位点守恒。\n\n1.  **质量作用平衡：** 可逆反应为 $X + P \\rightleftharpoons C$。在准平衡状态下，正向和反向反应的速率相等。根据质量作用定律，这表示为：\n    $$\n    k_{\\mathrm{on}} X P = k_{\\mathrm{off}} C\n    $$\n    使用平衡解离常数的定义 $K_d = k_{\\mathrm{off}}/k_{\\mathrm{on}}$，可以重新整理该方程：\n    $$\n    \\frac{P X}{C} = K_d\n    $$\n\n2.  **启动子位点守恒：** 启动子的总浓度 $P_T$ 是游离启动子 $P$ 和结合在复合物中的启动子 $C$ 的总和。\n    $$\n    P_T = P + C\n    $$\n    我们可以将游离启动子的浓度表示为 $P = P_T - C$。\n\n3.  **结合复合物浓度（$C$）的推导：** 我们将守恒定律中的 $P$ 的表达式代入平衡方程中：\n    $$\n    K_d = \\frac{(P_T - C) X}{C}\n    $$\n    现在，我们用代数方法求解此方程，得到 $C$ 作为 $X$、$P_T$ 和 $K_d$ 的函数。\n    $$\n    K_d C = (P_T - C) X\n    $$\n    $$\n    K_d C = P_T X - C X\n    $$\n    $$\n    K_d C + C X = P_T X\n    $$\n    $$\n    C (K_d + X) = P_T X\n    $$\n    $$\n    C = \\frac{P_T X}{K_d + X}\n    $$\n    此表达式给出了平衡时结合复合物的浓度。\n\n4.  **回溯性（$r_y$）的推导：** 问题将对输出的回溯性定义为 $r_y \\equiv \\frac{C}{X}$。我们代入推导出的 $C$ 的表达式：\n    $$\n    r_y = \\frac{1}{X} \\left( \\frac{P_T X}{K_d + X} \\right)\n    $$\n    $$\n    r_y = \\frac{P_T}{K_d + X}\n    $$\n    这是在准平衡假设下推导出的回溯性 $r_y$ 作为 $X$、$P_T$ 和 $K_d$ 函数的精确表达式。\n\n5.  **一阶近似和建模假设：** 问题要求在弱负载条件 $P_T \\ll K_d + X$ 下求 $r_y$ 的一阶近似。让我们分析推导出的 $r_y$ 作为负载大小 $P_T$ 的函数。该函数为：\n    $$\n    r_y(P_T) = \\left( \\frac{1}{K_d + X} \\right) P_T\n    $$\n    这个关系对于 $P_T$ 已经是线性的。一个线性函数在 $P_T=0$ 处的泰勒级数展开就是它本身。一阶近似与精确表达式相同。因此，$r_y$ 的一阶近似就是 $\\frac{P_T}{K_d + X}$。\n\n    问题的关键部分是“陈述使此线性化有效所必需的明确建模假设”。“线性化”指的是响应（$C$ 或 $r_y$）对负载刺激（$P_T$）的线性依赖性。上述推导表明，这种线性关系精确成立的充要条件是，变量 $X$ 被视为一个与负载 $P_T$ 无关的参数。\n\n    因此，所需的假设是：\n    a) 结合反应 $X + P \\rightleftharpoons C$ 处于准平衡状态。\n    b) 启动子位点总数守恒（$P+C=P_T$）。\n    c) **关键地，游离转录因子的浓度 $X$ 是恒定的，不受负载 $P_T$ 大小的影响。** 这意味着上游模块充当一个“理想源”，能够完美地缓冲其输出浓度，以抵抗下游的隔离作用。\n\n    如果没有假设 (c)，$X$ 会随着 $P_T$ 的增加而减少（由于隔离作用），即 $X = X(P_T)$。那么 $r_y$ 的完整表达式将变为关于 $P_T$ 的非线性表达式，此时就需要进行一阶近似，通常会得到一个用无负载浓度 $X_0 = X(P_T=0)$ 表示的结果。然而，问题明确要求最终答案用有负载浓度 $X$ 来表示，这只有在假设 $X$ 是常数的情况下才可能。条件 $P_T \\ll K_d + X$ 于是就简单地指定了整体回溯性效应 $r_y$ 很小（$r_y \\ll 1$）的范围，这正是通常将负载作为微扰来研究的背景。\n\n    因此，所要求的一阶近似是在假设 $X$ 是一个固定参数的情况下推导出的精确表达式。\n\n$r_y$ 关于 $P_T$、$K_d$ 和 $X$ 的一阶近似的最终表达式就是上面推导出的那个。", "answer": "$$\n\\boxed{\\frac{P_T}{K_d + X}}\n$$", "id": "3346028"}, {"introduction": "模块化系统的鲁棒性不仅取决于组件间的亲和力，还关键地取决于它们相互作用的动态过程。这个练习 [@problem_id:3346062] 探讨了结合与解离的相对时间尺度如何决定一个模块对抗负载的“绝缘”程度，并正式引入输出阻抗的概念。理解这些动态特性对于设计可预测和可组合的合成生物回路至关重要。", "problem": "考虑一个上游基因表达模块，它产生一种转录因子（TF），其游离浓度用 $x(t)$ 表示。该转录因子与一个总浓度为 $P_T$ 的下游启动子池相互作用。上游模块以恒定的合成速率 $\\alpha$ 产生TF，并以作用于总TF的一阶降解速率 $\\delta$ 去除TF（包括游离和结合形式）。下游启动子根据可逆质量作用动力学与游离TF结合，形成复合物 $c(t)$，其结合速率为 $k_{\\text{on}}$，解离速率为 $k_{\\text{off}}$。设 $p(t)$ 表示未结合启动子的浓度，并定义解离常数 $K_d = \\frac{k_{\\text{off}}}{k_{\\text{on}}}$。\n\n该系统遵循以下基本关系：\n- TF总保守：$x_T(t) = x(t) + c(t)$。\n- 上游TF的产生与去除：$\\frac{d x_T}{dt} = \\alpha - \\delta x_T$。\n- 下游结合动力学：$\\frac{d c}{dt} = k_{\\text{on}} x p - k_{\\text{off}} c$，其中 $p = P_T - c$。\n\n假设系统达到稳态，并且时间尺度分离由 $k_{\\text{off}}$ 控制。在极限 $k_{\\text{off}} \\to \\infty$ 下，结合-解离过程任意快；而在极限 $k_{\\text{off}} \\to 0$ 下，解离过程任意慢（高亲和力）。假设 $k_{\\text{on}}$ 是固定的正数，且稳态总TF $x_T^{*} = \\frac{\\alpha}{\\delta}$ 满足 $x_T^{*} > P_T$，这确保了即使在强结合下也有 $x^{*} > 0$。\n\n将在有负载情况下的稳态游离TF定义为 $x^{*}$，无负载（即 $P_T = 0$ 的情况）的游离TF定义为 $x_0^{*}$。对状态的稳态回溯性定义为由于下游负载导致的游离TF的分数减少量，\n$$\nr \\equiv \\frac{x_0^{*} - x^{*}}{x_0^{*}},\n$$\n而输出阻抗大小定义为稳态顺应性相对于下游负载的倒数，\n$$\nZ_{\\text{out}} \\equiv \\left|\\frac{\\partial x^{*}}{\\partial P_T}\\right|^{-1}.\n$$\n\n从上述基本定义和方程出发，推导 $x^{*}$、$r$ 和 $Z_{\\text{out}}$ 作为 $(\\alpha,\\delta,k_{\\text{on}},k_{\\text{off}},P_T)$ 的显式表达式，然后评估在 $k_{\\text{off}} \\to \\infty$ 和 $k_{\\text{off}} \\to 0$ 的情况下，$r$ 和 $Z_{\\text{out}}$ 的极限值。按以下顺序，以四个条目的形式提供最终结果：\n$$\n\\big(r|_{k_{\\text{off}}\\to\\infty},\\; Z_{\\text{out}}|_{k_{\\text{off}}\\to\\infty},\\; r|_{k_{\\text{off}}\\to 0},\\; Z_{\\text{out}}|_{k_{\\text{off}}\\to 0}\\big).\n$$\n不需要进行数值评估。以精确的符号形式表示最终答案。如果任何极限值发散，请以精确的符号极限形式写出。最终答案必须是使用指定顺序的单行矩阵。最终答案中不需要单位，但推导过程中的所有数学实体都必须用LaTeX书写。假设所有参数均为严格正数且不随时间变化，并仅使用质量作用动力学、守恒和稳态分析来证明每一步。除这些基本原理外，不要引用任何特定于回溯性或阻抗的快捷公式。", "solution": "### 第一步：提取已知条件\n\n-   **变量与函数**：\n    -   游离TF浓度：$x(t)$\n    -   TF-启动子复合物浓度：$c(t)$\n    -   总TF浓度：$x_T(t)$\n    -   未结合启动子浓度：$p(t)$\n    -   总启动子浓度：$P_T$\n-   **参数**：\n    -   TF合成速率：$\\alpha$\n    -   TF降解速率：$\\delta$\n    -   结合速率：$k_{\\text{on}}$\n    -   解离速率：$k_{\\text{off}}$\n    -   解离常数：$K_d = \\frac{k_{\\text{off}}}{k_{\\text{on}}}$\n-   **基本关系**：\n    1.  TF总保守：$x_T(t) = x(t) + c(t)$\n    2.  上游动力学：$\\frac{d x_T}{dt} = \\alpha - \\delta x_T$\n    3.  下游动力学：$\\frac{d c}{dt} = k_{\\text{on}} x p - k_{\\text{off}} c$，其中 $p = P_T - c$\n-   **假设与条件**：\n    -   系统处于稳态。\n    -   $k_{\\text{on}}$ 是固定的正数。\n    -   稳态总TF：$x_T^{*} = \\frac{\\alpha}{\\delta}$\n    -   条件：$x_T^{*} > P_T$\n    -   所有参数均为严格正数且恒定。\n-   **定义**：\n    -   负载下的稳态游离TF：$x^{*}$\n    -   无负载的稳态游离TF（$P_T = 0$）：$x_0^{*}$\n    -   回溯性：$r \\equiv \\frac{x_0^{*} - x^{*}}{x_0^{*}}$\n    -   输出阻抗大小：$Z_{\\text{out}} \\equiv \\left|\\frac{\\partial x^{*}}{\\partial P_T}\\right|^{-1}$\n-   **任务**：\n    -   推导 $x^{*}$、$r$ 和 $Z_{\\text{out}}$ 的显式表达式。\n    -   评估极限值：$r|_{k_{\\text{off}}\\to\\infty}$、$Z_{\\text{out}}|_{k_{\\text{off}}\\to\\infty}$、$r|_{k_{\\text{off}}\\to 0}$ 和 $Z_{\\text{out}}|_{k_{\\text{off}}\\to 0}$。\n\n### 第二步：使用提取的已知条件进行验证\n\n-   **科学依据**：该问题基于质量作用动力学和守恒定律的基本原理，这些是化学反应网络理论和系统生物学中的标准原理。带有下游负载的基因表达模型是该领域的典型问题。没有违反科学原理的地方。\n-   **适定性**：该问题在数学上是适定的。具有恒定正参数的常微分方程组将具有唯一、稳定的稳态。回溯性和阻抗的定义是标准的。条件 $x_T^* > P_T$ 确保了系统状态的物理可行性。\n-   **客观性**：问题以精确、定量和无偏见的语言陈述。所有术语都经过数学定义。没有主观论断。\n-   **完整性与一致性**：提供了所有必要的方程、参数和定义。设置中没有矛盾之处。\n-   **可形式化性与相关性**：该问题已经数学形式化，并且与模块化生物系统中的回溯性和阻抗主题直接相关。\n-   **其他缺陷**：在其建模框架内，该问题并非无足轻重、同义反复或不切实际。它需要基于第一性原理进行实质性推导。\n\n### 第三步：结论与行动\n\n问题有效。现在开始解题过程。\n\n### 求解推导\n\n首先，我们确定稳态浓度。在稳态下，所有时间导数均为零。\n根据上游动力学，$\\frac{d x_T}{dt} = 0$：\n$$\n\\alpha - \\delta x_T^{*} = 0 \\implies x_T^{*} = \\frac{\\alpha}{\\delta}\n$$\n在没有下游负载（$P_T = 0$）的情况下，没有结合发生，因此 $c(t) = 0$。总TF全部是游离的，$x_T(t) = x(t)$。因此，无负载的稳态游离TF浓度为：\n$$\nx_0^{*} = x_T^{*} = \\frac{\\alpha}{\\delta}\n$$\n接下来，根据稳态下的下游结合动力学，$\\frac{d c}{dt} = 0$：\n$$\nk_{\\text{on}} x^{*} p^{*} - k_{\\text{off}} c^{*} = 0\n$$\n使用关系式 $p^{*} = P_T - c^{*}$：\n$$\nk_{\\text{on}} x^{*} (P_T - c^{*}) - k_{\\text{off}} c^{*} = 0\n$$\n求解稳态复合物浓度 $c^{*}$：\n$$\nk_{\\text{on}} x^{*} P_T = c^{*} (k_{\\text{on}} x^{*} + k_{\\text{off}}) \\implies c^{*} = \\frac{k_{\\text{on}} x^{*} P_T}{k_{\\text{on}} x^{*} + k_{\\text{off}}}\n$$\n使用定义 $K_d = \\frac{k_{\\text{off}}}{k_{\\text{on}}}$，我们可以将其写为：\n$$\nc^{*} = \\frac{x^{*} P_T}{x^{*} + K_d}\n$$\n现在，我们使用稳态下的TF总保守关系，$x_T^{*} = x^{*} + c^{*}$：\n$$\nx_0^{*} = x^{*} + \\frac{x^{*} P_T}{x^{*} + K_d}\n$$\n为了找到 $x^{*}$ 的表达式，我们解这个方程。\n$$\nx_0^{*} (x^{*} + K_d) = x^{*}(x^{*} + K_d) + x^{*} P_T\n$$\n$$\nx_0^{*} x^{*} + x_0^{*} K_d = (x^{*})^2 + K_d x^{*} + P_T x^{*}\n$$\n整理各项得到关于 $x^{*}$ 的二次方程：\n$$\n(x^{*})^2 + (K_d + P_T - x_0^{*})x^{*} - x_0^{*} K_d = 0\n$$\n使用二次公式求解 $x^{*}$，并选择正根（因为浓度必须为正）：\n$$\nx^{*} = \\frac{-(K_d + P_T - x_0^{*}) + \\sqrt{(K_d + P_T - x_0^{*})^2 - 4(1)(-x_0^{*} K_d)}}{2}\n$$\n$$\nx^{*} = \\frac{1}{2} \\left( x_0^{*} - K_d - P_T + \\sqrt{(x_0^{*} - K_d - P_T)^2 + 4 x_0^{*} K_d} \\right)\n$$\n这是 $x^{*}$ 关于 $x_0^{*}$、$K_d$ 和 $P_T$ 的显式表达式。\n\n接下来，我们推导回溯性 $r = \\frac{x_0^{*} - x^{*}}{x_0^{*}}$ 的表达式。将 $x^{*} = x_0^{*}(1-r)$ 代入 $x^{*}$ 的二次方程中：\n$$\n(x_0^{*}(1-r))^2 + (K_d + P_T - x_0^{*})x_0^{*}(1-r) - x_0^{*} K_d = 0\n$$\n两边除以 $x_0^{*}$（为正数）：\n$$\nx_0^{*}(1-r)^2 + (K_d + P_T - x_0^{*})(1-r) - K_d = 0\n$$\n$$\nx_0^{*}(1 - 2r + r^2) + (K_d + P_T - x_0^{*}) - r(K_d + P_T - x_0^{*}) - K_d = 0\n$$\n$$\nx_0^{*}r^2 + (-2x_0^{*} - (K_d+P_T-x_0^{*}))r + (x_0^{*} + K_d + P_T - x_0^{*} - K_d) = 0\n$$\n$$\nx_0^{*}r^2 - (x_0^{*} + K_d + P_T)r + P_T = 0\n$$\n使用二次公式求解 $r$：\n$$\nr = \\frac{(x_0^{*} + K_d + P_T) \\pm \\sqrt{(x_0^{*} + K_d + P_T)^2 - 4 x_0^{*} P_T}}{2 x_0^{*}}\n$$\n因为当 $P_T=0$ 时，$r$ 必须为 $0$，所以我们选择负号。\n$$\nr = \\frac{x_0^{*} + K_d + P_T - \\sqrt{(x_0^{*} + K_d + P_T)^2 - 4 x_0^{*} P_T}}{2 x_0^{*}}\n$$\n\n最后，我们推导输出阻抗 $Z_{\\text{out}} = \\left|\\frac{\\partial x^{*}}{\\partial P_T}\\right|^{-1}$。我们对 $x^{*}$ 的二次方程使用隐式微分：\n$$\n(x^{*})^2 + (K_d + P_T - x_0^{*})x^{*} - x_0^{*} K_d = 0\n$$\n对 $P_T$ 求导：\n$$\n2x^{*} \\frac{\\partial x^{*}}{\\partial P_T} + (1)x^{*} + (K_d + P_T - x_0^{*})\\frac{\\partial x^{*}}{\\partial P_T} = 0\n$$\n$$\n\\frac{\\partial x^{*}}{\\partial P_T} \\left( 2x^{*} + K_d + P_T - x_0^{*} \\right) = -x^{*}\n$$\n$$\n\\frac{\\partial x^{*}}{\\partial P_T} = -\\frac{x^{*}}{2x^{*} + K_d + P_T - x_0^{*}}\n$$\n从 $x^{*}$ 的解可知，$2x^{*} = x_0^{*} - K_d - P_T + \\sqrt{\\dots}$。分母是 $2x^{*} + K_d + P_T - x_0^{*} = \\sqrt{(x_0^{*} - K_d - P_T)^2 + 4 x_0^{*} K_d}$，它总是正的。因此导数是负的，符合预期。\n$$\nZ_{\\text{out}} = \\left| -\\frac{x^{*}}{2x^{*} + K_d + P_T - x_0^{*}} \\right|^{-1} = \\frac{2x^{*} + K_d + P_T - x_0^{*}}{x^{*}}\n$$\n$$\nZ_{\\text{out}} = 2 + \\frac{K_d + P_T - x_0^{*}}{x^{*}}\n$$\n\n现在我们评估所需的极限。\n\n**极限 1：$k_{\\text{off}} \\to \\infty$** （意味着 $K_d \\to \\infty$）\n对于回溯性 $r$：\n$$\nr = \\frac{x_0^{*} + K_d + P_T - (x_0^{*} + K_d + P_T)\\sqrt{1 - \\frac{4 x_0^{*} P_T}{(x_0^{*} + K_d + P_T)^2}}}{2 x_0^{*}}\n$$\n对小的 $u$ 使用泰勒展开 $\\sqrt{1-u} \\approx 1 - u/2$：\n$$\nr \\approx \\frac{x_0^{*} + K_d + P_T - (x_0^{*} + K_d + P_T)(1 - \\frac{1}{2}\\frac{4 x_0^{*} P_T}{(x_0^{*} + K_d + P_T)^2})}{2 x_0^{*}}\n$$\n$$\nr \\approx \\frac{x_0^{*} + K_d + P_T - (x_0^{*} + K_d + P_T) + \\frac{2 x_0^{*} P_T}{x_0^{*} + K_d + P_T}}{2 x_0^{*}} = \\frac{P_T}{x_0^{*} + K_d + P_T}\n$$\n取 $K_d \\to \\infty$ 的极限：\n$$\nr|_{k_{\\text{off}}\\to\\infty} = \\lim_{K_d \\to \\infty} \\frac{P_T}{x_0^{*} + K_d + P_T} = 0\n$$\n对于输出阻抗 $Z_{\\text{out}}$：\n首先，我们求 $x^{*}$ 的极限。从二次方程 $(x^{*})^2/K_d + (1 + (P_T - x_0^{*})/K_d)x^{*} - x_0^{*} = 0$ 可知，当 $K_d \\to \\infty$ 时，我们得到 $x^{*} \\to x_0^{*}$。\n然后，对于 $Z_{\\text{out}} = 2 + \\frac{K_d + P_T - x_0^{*}}{x^{*}}$，当 $K_d \\to \\infty$ 时，分子发散而分母趋近于常数 $x_0^{*}$。\n$$\nZ_{\\text{out}}|_{k_{\\text{off}}\\to\\infty} = \\lim_{K_d \\to \\infty} \\left( 2 + \\frac{K_d + P_T - x_0^{*}}{x_0^{*}} \\right) = \\infty\n$$\n\n**极限 2：$k_{\\text{off}} \\to 0$** （意味着 $K_d \\to 0$）\n对于回溯性 $r$：\n$$\nr|_{k_{\\text{off}}\\to 0} = \\frac{x_0^{*} + P_T - \\sqrt{(x_0^{*} + P_T)^2 - 4 x_0^{*} P_T}}{2 x_0^{*}}\n$$\n平方根下的项可以简化：$(x_0^{*} + P_T)^2 - 4 x_0^{*} P_T = (x_0^{*})^2 - 2x_0^{*}P_T + P_T^2 = (x_0^{*} - P_T)^2$。\n所以，$\\sqrt{(x_0^{*} - P_T)^2} = |x_0^{*} - P_T|$。因为问题陈述 $x_T^{*} > P_T$，我们有 $x_0^{*} > P_T$，因此 $|x_0^{*} - P_T| = x_0^{*} - P_T$。\n$$\nr|_{k_{\\text{off}}\\to 0} = \\frac{x_0^{*} + P_T - (x_0^{*} - P_T)}{2 x_0^{*}} = \\frac{2P_T}{2x_0^{*}} = \\frac{P_T}{x_0^{*}}\n$$\n代入 $x_0^{*} = \\alpha/\\delta$：\n$$\nr|_{k_{\\text{off}}\\to 0} = \\frac{P_T}{\\alpha/\\delta} = \\frac{\\delta P_T}{\\alpha}\n$$\n对于输出阻抗 $Z_{\\text{out}}$：\n当 $K_d \\to 0$ 时，$x^*$ 的二次方程变为 $x^{*}(x^{*} + P_T - x_0^{*}) = 0$。非平凡解（因为 $x_0^*>P_T>0$）是 $x^{*} = x_0^{*} - P_T$。\n使用表达式 $Z_{\\text{out}} = 2 + \\frac{K_d + P_T - x_0^{*}}{x^{*}}$，我们取 $K_d \\to 0$ 的极限：\n$$\nZ_{\\text{out}}|_{k_{\\text{off}}\\to 0} = 2 + \\frac{P_T - x_0^{*}}{x_0^{*} - P_T} = 2 - 1 = 1\n$$\n或者，从 $x^{*} = x_0^{*} - P_T$ 可得 $\\frac{\\partial x^{*}}{\\partial P_T} = -1$。\n因此，$Z_{\\text{out}} = |-1|^{-1} = 1$。\n\n按指定顺序的四个结果是：$\\left(0, \\infty, \\frac{\\delta P_T}{\\alpha}, 1\\right)$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0  & \\infty  & \\frac{\\delta P_T}{\\alpha}  & 1\n\\end{pmatrix}\n}\n$$", "id": "3346062"}, {"introduction": "在真实的生物系统中，信号通常通过非线性模块组成的级联进行传递，溯感性会扭曲信号的形状，改变系统的信号处理特性。这个计算练习 [@problem_id:3346015] 要求您通过模拟一个转录级联来量化负载如何改变系统的有效灵敏度（$EC_{50}$）和开关行为（表观Hill系数）。这项实践将理论概念与电路的实际性能预测联系起来。", "problem": "考虑一个双模块转录级联，其中每个模块在稳态下由一个 Hill 型非线性描述，模块间的反作用性源于下游模块的输入启动子位点对上游模块输出的可逆螯合（结合）。所有量均为无量纲。设上游模块的输入为 $u$，产生总输出 $x_{\\text{tot}}$，而下游模块消耗游离（未结合）的上游输出 $x_{\\text{free}}$ 以产生其自身的输出 $z$。以下经过充分检验的定律和定义构成了基本依据：\n\n1. 稳态下物种生成的 Hill 型输入-输出关系：\n$$\ny = V \\frac{x^{n}}{K^{n} + x^{n}},\n$$\n其中 $y$ 是所生成物种的稳态水平，$V$ 是饱和水平，$K$ 是半激活常数，$n$ 是 Hill 系数。\n\n2. 物种 $x$ 与总浓度为 $T_{\\text{tot}}$、解离常数为 $K_{d}$ 的下游靶点结合时的准平衡状态下的可逆结合与质量守恒。游离（未结合）浓度 $x_{\\text{free}}$ 满足：\n$$\nx_{\\text{tot}} = x_{\\text{free}} + \\frac{T_{\\text{tot}} x_{\\text{free}}}{K_{d} + x_{\\text{free}}}.\n$$\n\n3. 对于任何具有饱和值 $y_{\\max} = \\lim_{u \\to \\infty} y(u)$ 的稳态输入-输出曲线 $y(u)$，半数有效浓度 (EC50) 和表观 Hill 系数的定义如下：\n- 半数有效浓度 $EC_{50}$ 是使 $y(u) = y_{\\max}/2$ 成立的 $u$ 值。\n- 表观 Hill 系数 $n_{\\text{app}}$ 是 Hill 图在半最大响应处的斜率：\n$$\nn_{\\text{app}} = \\left.\\frac{d \\log\\left(\\frac{y}{y_{\\max} - y}\\right)}{d \\log u}\\right|_{u = EC_{50}}.\n$$\n\n在本问题中，上游模块的输入为 $u$，在稳态下根据 Hill 关系和线性降解产生 $x_{\\text{tot}}(u)$，\n$$\nx_{\\text{tot}}(u) = \\frac{V_{1}}{\\gamma_{1}} \\frac{u^{n_{1}}}{K_{1}^{n_{1}} + u^{n_{1}}},\n$$\n下游模块读取 $x_{\\text{free}}$ 并产生输出 $z(u)$，\n$$\nz(u) = V_{2} \\frac{x_{\\text{free}}(u)^{n_{2}}}{K_{2}^{n_{2}} + x_{\\text{free}}(u)^{n_{2}}}.\n$$\n反作用性负载通过以下方式耦合 $x_{\\text{tot}}$ 和 $x_{\\text{free}}$：\n$$\nx_{\\text{tot}} = x_{\\text{free}} + \\frac{T_{\\text{tot}} x_{\\text{free}}}{K_{d} + x_{\\text{free}}}.\n$$\n\n任务：\n- 对每个指定的参数集，计算负载引起的表观 Hill 系数和 $EC_{50}$ 的变化如何沿级联向下传播，方法是确定在有负载情况下：\n  1. 映射 $u \\mapsto x_{\\text{free}}(u)$ 的表观 $EC_{50}$ 和表观 Hill 系数。\n  2. 整个级联映射 $u \\mapsto z(u)$ 的表观 $EC_{50}$ 和表观 Hill 系数。\n- 同时，通过将 $T_{\\text{tot}}$ 设为 $0$（所有其他参数不变）来计算无负载基线值，并报告两种映射和两种度量的比率（有负载值除以无负载值）。\n\n实现所需的数学说明：\n- 由可逆结合和质量守恒所隐含的二次方程允许在给定 $x_{\\text{tot}}$、$T_{\\text{tot}}$ 和 $K_{d}$ 的情况下，以闭式解求出 $x_{\\text{free}}$。利用这一点来避免在求解 $x_{\\text{free}}$ 时出现数值不稳定性。\n- 对于任何映射 $y(u)$，在 $u = EC_{50}$ 时，表观 Hill 系数可以从导数 $dy/du$ 计算得出：\n$$\nn_{\\text{app}} = \\left.\\frac{4\\,u}{y_{\\max}} \\frac{dy}{du}\\right|_{u = EC_{50}}.\n$$\n该恒等式直接源于 Hill 图在半最大响应处斜率的定义。\n\n所有量均为无量纲。不涉及角度。最终计算值必须是数值实数。\n\n测试套件：\n为以下四个参数集提供结果。每个集合是一个元组 $(n_{1}, K_{1}, V_{1}, \\gamma_{1}, n_{2}, K_{2}, V_{2}, T_{\\text{tot}}, K_{d})$。\n\n- 情况 A（正常路径，中等负载）：\n  - $n_{1} = 2.0$, $K_{1} = 1.0$, $V_{1} = 10.0$, $\\gamma_{1} = 1.0$\n  - $n_{2} = 2.0$, $K_{2} = 1.0$, $V_{2} = 5.0$\n  - $T_{\\text{tot}} = 5.0$, $K_{d} = 1.0$\n\n- 情况 B（无负载基线，合理性检查）：\n  - $n_{1} = 2.0$, $K_{1} = 1.0$, $V_{1} = 10.0$, $\\gamma_{1} = 1.0$\n  - $n_{2} = 2.0$, $K_{2} = 1.0$, $V_{2} = 5.0$\n  - $T_{\\text{tot}} = 0.0$, $K_{d} = 1.0$\n\n- 情况 C（强负载和紧密结合）：\n  - $n_{1} = 2.0$, $K_{1} = 1.0$, $V_{1} = 10.0$, $\\gamma_{1} = 1.0$\n  - $n_{2} = 3.0$, $K_{2} = 2.0$, $V_{2} = 5.0$\n  - $T_{\\text{tot}} = 50.0$, $K_{d} = 0.1$\n\n- 情况 D（下游不敏感除非上游饱和，显著负载）：\n  - $n_{1} = 1.5$, $K_{1} = 0.5$, $V_{1} = 8.0$, $\\gamma_{1} = 1.0$\n  - $n_{2} = 2.0$, $K_{2} = 100.0$, $V_{2} = 3.0$\n  - $T_{\\text{tot}} = 20.0$, $K_{d} = 10.0$\n\n每个情况所需的输出：\n- 设 $(EC_{50}^{(u \\to x)}, n_{\\text{app}}^{(u \\to x)})$ 为有负载情况下映射 $u \\mapsto x_{\\text{free}}(u)$ 的表观半数有效浓度和表观 Hill 系数，$(EC_{50}^{(u \\to z)}, n_{\\text{app}}^{(u \\to z)})$ 为有负载情况下映射 $u \\mapsto z(u)$ 的相应量。\n- 设无负载（基线）值通过将 $T_{\\text{tot}}$ 设为 $0$ 并重新计算相同的度量得到，记为 $EC_{50,0}^{(u \\to x)}$、$n_{\\text{app},0}^{(u \\to x)}$、$EC_{50,0}^{(u \\to z)}$、$n_{\\text{app},0}^{(u \\to z)}$。\n- 计算比率 $r_{EC50}^{(u \\to x)} = EC_{50}^{(u \\to x)} / EC_{50,0}^{(u \\to x)}$、$r_{n}^{(u \\to x)} = n_{\\text{app}}^{(u \\to x)} / n_{\\text{app},0}^{(u \\to x)}$、$r_{EC50}^{(u \\to z)} = EC_{50}^{(u \\to z)} / EC_{50,0}^{(u \\to z)}$、$r_{n}^{(u \\to z)} = n_{\\text{app}}^{(u \\to z)} / n_{\\text{app},0}^{(u \\to z)}$。\n\n最终输出格式：\n- 对每个情况，生成一个列表\n$$\n[EC_{50}^{(u \\to x)},\\ n_{\\text{app}}^{(u \\to x)},\\ EC_{50}^{(u \\to z)},\\ n_{\\text{app}}^{(u \\to z)},\\ r_{EC50}^{(u \\to x)},\\ r_{n}^{(u \\to x)},\\ r_{EC50}^{(u \\to z)},\\ r_{n}^{(u \\to z)}],\n$$\n其中每个数字四舍五入到六位小数。\n- 将四个情况的列表聚合成一个单一列表，并打印一行包含此聚合列表的内容，格式为用方括号括起来的逗号分隔列表，例如\n$$\n[[a_{1},a_{2},\\ldots,a_{8}],[b_{1},b_{2},\\ldots,b_{8}],[c_{1},\\ldots],[d_{1},\\ldots]].\n$$", "solution": "我们从基本依据开始。上游模块在稳态下通过一个饱和值为 $V_{1}$、半激活常数为 $K_{1}$、线性降解率为 $\\gamma_{1}$ 的 Hill 函数，将输入 $u$ 映射到其总输出 $x_{\\text{tot}}(u)$：\n$$\nx_{\\text{tot}}(u) = \\frac{V_{1}}{\\gamma_{1}} \\frac{u^{n_{1}}}{K_{1}^{n_{1}} + u^{n_{1}}}.\n$$\n下游模块读取游离浓度 $x_{\\text{free}}$（上游输出的未结合部分），并通过一个参数为 $V_{2}$、$K_{2}$ 和 $n_{2}$ 的 Hill 函数，在稳态下产生输出 $z(u)$：\n$$\nz(u) = V_{2} \\frac{x_{\\text{free}}(u)^{n_{2}}}{K_{2}^{n_{2}} + x_{\\text{free}}(u)^{n_{2}}}.\n$$\n\n由负载引起的反作用性通过 $x_{\\text{free}}$ 与总浓度为 $T_{\\text{tot}}$、解离常数为 $K_{d}$ 的下游位点的可逆结合来建模。质量守恒和结合的准平衡状态得出：\n$$\nx_{\\text{tot}} = x_{\\text{free}} + \\frac{T_{\\text{tot}} x_{\\text{free}}}{K_{d} + x_{\\text{free}}}.\n$$\n这可以被整理成一个关于 $x_{\\text{free}}$ 的二次方程。注意到\n$$\n\\frac{T_{\\text{tot}} x_{\\text{free}}}{K_{d} + x_{\\text{free}}} = T_{\\text{tot}} - \\frac{T_{\\text{tot}} K_{d}}{K_{d} + x_{\\text{free}}},\n$$\n所以\n$$\nx_{\\text{tot}} = x_{\\text{free}} + T_{\\text{tot}} - \\frac{T_{\\text{tot}} K_{d}}{K_{d} + x_{\\text{free}}}\n\\quad \\Rightarrow \\quad\nx_{\\text{tot}} - T_{\\text{tot}} = x_{\\text{free}} - \\frac{T_{\\text{tot}} K_{d}}{K_{d} + x_{\\text{free}}}.\n$$\n两边同乘以 $K_{d} + x_{\\text{free}}$ 得\n$$\n(x_{\\text{tot}} - T_{\\text{tot}})(K_{d} + x_{\\text{free}}) = x_{\\text{free}}(K_{d} + x_{\\text{free}}) - T_{\\text{tot}} K_{d}.\n$$\n展开并合并同类项得到\n$$\nx_{\\text{free}}^{2} + x_{\\text{free}}(K_{d} - x_{\\text{tot}} + T_{\\text{tot}}) - K_{d} x_{\\text{tot}} = 0.\n$$\n因此，$x_{\\text{free}}$ 由该二次方程的正根给出：\n$$\nx_{\\text{free}} = \\frac{-(K_{d} - x_{\\text{tot}} + T_{\\text{tot}}) + \\sqrt{(K_{d} - x_{\\text{tot}} + T_{\\text{tot}})^{2} + 4 K_{d} x_{\\text{tot}}}}{2}.\n$$\n当 $T_{\\text{tot}} = 0$ 时，该表达式简化为 $x_{\\text{free}} = x_{\\text{tot}}$，这与预期相符。\n\n为了计算定义半数有效浓度时使用的饱和值，注意到当 $u \\to \\infty$ 时，上游模块饱和至\n$$\nx_{\\text{tot},\\max} = \\lim_{u \\to \\infty} x_{\\text{tot}}(u) = \\frac{V_{1}}{\\gamma_{1}}.\n$$\n然后，$x_{\\text{free},\\max}$ 可由在 $x_{\\text{tot}} = x_{\\text{tot},\\max}$ 处求值的相同二次公式得出。下游输出的饱和值为\n$$\nz_{\\max} = V_{2} \\frac{x_{\\text{free},\\max}^{n_{2}}}{K_{2}^{n_{2}} + x_{\\text{free},\\max}^{n_{2}}}.\n$$\n\n度量的定义如下。对于任何具有饱和值 $y_{\\max}$ 的稳态输入-输出函数 $y(u)$，半数有效浓度 $EC_{50}$ 由 $y(EC_{50}) = y_{\\max}/2$ 定义。表观 Hill 系数由 Hill 图在 $u = EC_{50}$ 处的斜率定义：\n$$\nn_{\\text{app}} = \\left.\\frac{d \\log\\left(\\frac{y}{y_{\\max} - y}\\right)}{d \\log u}\\right|_{u = EC_{50}}.\n$$\n令 $L(u) = \\log\\left(\\frac{y}{y_{\\max} - y}\\right)$。那么\n$$\n\\frac{dL}{d\\log u} = u \\frac{dL}{du} = u \\left( \\frac{1}{y} + \\frac{1}{y_{\\max} - y} \\right) \\frac{dy}{du}\n= u \\left( \\frac{y_{\\max}}{y(y_{\\max} - y)} \\right) \\frac{dy}{du}.\n$$\n在 $u = EC_{50}$ 时，我们有 $y = y_{\\max}/2$，因此\n$$\nn_{\\text{app}} = \\left.\\frac{4 u}{y_{\\max}} \\frac{dy}{du}\\right|_{u = EC_{50}}.\n$$\n对于一个理想的 Hill 函数，这恰好简化为 Hill 系数：如果 $y(u) = V \\frac{u^{n}}{K^{n} + u^{n}}$，那么 $y_{\\max} = V$，$EC_{50} = K$，并且\n$$\n\\left.\\frac{dy}{du}\\right|_{u=K} = \\frac{V n}{4 K} \\quad \\Rightarrow \\quad n_{\\text{app}} = \\frac{4 K}{V} \\cdot \\frac{V n}{4 K} = n.\n$$\n\n为给定参数集计算所需量的算法方案：\n1. 根据上游 Hill 关系计算 $x_{\\text{tot}}(u)$。\n2. 对每个 $u$，通过二次方程的闭式解计算 $x_{\\text{free}}(u)$。\n3. 定义 $y_{1}(u) = x_{\\text{free}}(u)$ 并使用 $x_{\\text{tot},\\max} = V_{1}/\\gamma_{1}$ 计算其饱和值 $y_{1,\\max} = x_{\\text{free},\\max}$。\n4. 定义 $y_{2}(u) = z(u) = V_{2} \\frac{x_{\\text{free}}(u)^{n_{2}}}{K_{2}^{n_{2}} + x_{\\text{free}}(u)^{n_{2}}}$ 并使用 $x_{\\text{free},\\max}$ 计算其饱和值 $y_{2,\\max} = z_{\\max}$。\n5. 对于 $y_{1}$ 和 $y_{2}$，通过在一个能确保上游模块接近饱和的小 $u$ 到大 $u$ 的区间上，使用稳健的区间求根方法求解 $y(u) - y_{\\max}/2 = 0$ 来找到 $EC_{50}$。\n6. 使用恒等式 $n_{\\text{app}} = \\left.\\frac{4 u}{y_{\\max}} \\frac{dy}{du}\\right|_{u = EC_{50}}$ 计算 $n_{\\text{app}}$，其中 $\\frac{dy}{du}$ 通过带有小相对 $u$ 扰动的对称有限差分进行数值估算。\n7. 通过将 $T_{\\text{tot}}$ 设为 $0$（所有其他参数保持不变）重复步骤 1-6，计算无负载基线。\n8. 为两种映射和两种度量计算有负载值与无负载值的比率。\n9. 将所有报告的数字四舍五入到六位小数。\n\n提供的测试套件中的边界情况和覆盖范围：\n- 情况 B，$T_{\\text{tot}} = 0$，验证了对于映射 $u \\mapsto x_{\\text{free}}(u)$，其表观参数与原始 Hill 参数匹配，并为级联 $u \\mapsto z(u)$ 提供了基线。\n- 情况 C，大 $T_{\\text{tot}}$ 和小 $K_{d}$，测试了强反作用性效应及其如何传播到下游输出。\n- 情况 D，非常大的 $K_{2}$，测试了下游模块在非上游模块饱和时不敏感的情况，探测了表观 $EC_{50}$ 和斜率的边界行为。\n- 情况 A 是一个代表性的中等负载场景。\n\n最终程序实现了此算法，计算了四种情况所需的量，并以要求的格式打印出一行，其中包含一个由四个按情况划分的列表组成的列表，每个数字都四舍五入到六位小数。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import brentq\n\ndef hill(u, V, n, K):\n    # Hill production at steady state (dimensionless)\n    return V * (u**n) / (K**n + u**n)\n\ndef x_free_from_total(x_tot, T_tot, Kd):\n    # Solve x_tot = x_free + (T_tot * x_free) / (Kd + x_free)\n    # Quadratic: x_free^2 + x_free*(Kd - x_tot + T_tot) - Kd*x_tot = 0\n    a = 1.0\n    b = (Kd - x_tot + T_tot)\n    c = -Kd * x_tot\n    disc = b*b - 4.0*a*c\n    # Positive root\n    return (-b + np.sqrt(disc)) / (2.0*a)\n\ndef upstream_x_tot(u, V1, n1, K1, gamma1):\n    return (1.0/gamma1) * hill(u, V1, n1, K1)\n\ndef x_free_of_u(u, params):\n    V1 = params[\"V1\"]; n1 = params[\"n1\"]; K1 = params[\"K1\"]; gamma1 = params[\"gamma1\"]\n    T = params[\"T\"]; Kd = params[\"Kd\"]\n    xt = upstream_x_tot(u, V1, n1, K1, gamma1)\n    return x_free_from_total(xt, T, Kd)\n\ndef z_of_u(u, params):\n    xfree = x_free_of_u(u, params)\n    V2 = params[\"V2\"]; n2 = params[\"n2\"]; K2 = params[\"K2\"]\n    return hill(xfree, V2, n2, K2)\n\ndef saturation_values(params):\n    # Compute x_free_max from x_tot_max = V1/gamma1 and mass conservation\n    V1 = params[\"V1\"]; gamma1 = params[\"gamma1\"]\n    T = params[\"T\"]; Kd = params[\"Kd\"]\n    x_tot_max = V1 / gamma1\n    x_free_max = x_free_from_total(x_tot_max, T, Kd)\n    # z_max from x_free_max\n    V2 = params[\"V2\"]; n2 = params[\"n2\"]; K2 = params[\"K2\"]\n    z_max = hill(x_free_max, V2, n2, K2)\n    return x_free_max, z_max\n\ndef ec50_and_napp(y_func, ymax, params, bracket_scale=1e3):\n    # Solve y(u) = ymax/2 for u using brentq\n    K1 = params[\"K1\"]\n    # Lower and upper bounds for u\n    u_low = 1e-12\n    u_high = max(bracket_scale * K1, 1.0 * bracket_scale)\n    target = 0.5 * ymax\n\n    def g(u):\n        return y_func(u, params) - target\n\n    # Ensure bracket is valid; expand if necessary\n    f_low = g(u_low)\n    f_high = g(u_high)\n    # y_func is monotonic increasing; at u_low it should be below target, at u_high above\n    # If not, expand u_high until it is.\n    expand_count = 0\n    while f_high = 0.0 and expand_count  20:\n        u_high *= 10.0\n        f_high = g(u_high)\n        expand_count += 1\n    if f_low >= 0.0:\n        # If even at extremely small u we are above half-max (degenerate), fallback to tiny EC50\n        u_ec50 = u_low\n    else:\n        u_ec50 = brentq(lambda uu: y_func(uu, params) - target, u_low, u_high, maxiter=200, xtol=1e-12, rtol=1e-12)\n\n    # Numerical derivative dy/du at u_ec50 via symmetric relative step\n    eps = 1e-6\n    u_plus = u_ec50 * (1.0 + eps)\n    u_minus = u_ec50 * (1.0 - eps)\n    # Protect against too small u_minus\n    if u_minus = 0.0:\n        u_minus = max(u_ec50 - eps, 1e-15)\n    y_plus = y_func(u_plus, params)\n    y_minus = y_func(u_minus, params)\n    dy_du = (y_plus - y_minus) / (u_plus - u_minus)\n\n    # Apparent Hill coefficient at half-max\n    n_app = (4.0 * u_ec50 / ymax) * dy_du\n    return u_ec50, n_app\n\ndef y1_func(u, params):\n    return x_free_of_u(u, params)\n\ndef y2_func(u, params):\n    return z_of_u(u, params)\n\ndef compute_case(case_params):\n    # Loaded case\n    xfree_max_loaded, z_max_loaded = saturation_values(case_params)\n    ec50_x_loaded, n_x_loaded = ec50_and_napp(y1_func, xfree_max_loaded, case_params)\n    ec50_z_loaded, n_z_loaded = ec50_and_napp(y2_func, z_max_loaded, case_params)\n\n    # No-load baseline\n    base_params = dict(case_params)\n    base_params[\"T\"] = 0.0\n    xfree_max_base, z_max_base = saturation_values(base_params)\n    ec50_x_base, n_x_base = ec50_and_napp(y1_func, xfree_max_base, base_params)\n    ec50_z_base, n_z_base = ec50_and_napp(y2_func, z_max_base, base_params)\n\n    # Ratios\n    r_ec50_x = ec50_x_loaded / ec50_x_base if ec50_x_base != 0 else np.nan\n    r_n_x = n_x_loaded / n_x_base if n_x_base != 0 else np.nan\n    r_ec50_z = ec50_z_loaded / ec50_z_base if ec50_z_base != 0 else np.nan\n    r_n_z = n_z_loaded / n_z_base if n_z_base != 0 else np.nan\n\n    return [ec50_x_loaded, n_x_loaded, ec50_z_loaded, n_z_loaded, r_ec50_x, r_n_x, r_ec50_z, r_n_z]\n\ndef format_results(results):\n    # Round to six decimals and format as a single-line nested list\n    def fmt(x):\n        if np.isnan(x) or np.isinf(x):\n            return \"nan\"\n        return f\"{x:.6f}\"\n    outer = []\n    for res in results:\n        inner = \",\".join(fmt(v) for v in res)\n        outer.append(f\"[{inner}]\")\n    return f\"[{','.join(outer)}]\"\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case A\n        {\"n1\": 2.0, \"K1\": 1.0, \"V1\": 10.0, \"gamma1\": 1.0,\n         \"n2\": 2.0, \"K2\": 1.0, \"V2\": 5.0, \"T\": 5.0, \"Kd\": 1.0},\n        # Case B\n        {\"n1\": 2.0, \"K1\": 1.0, \"V1\": 10.0, \"gamma1\": 1.0,\n         \"n2\": 2.0, \"K2\": 1.0, \"V2\": 5.0, \"T\": 0.0, \"Kd\": 1.0},\n        # Case C\n        {\"n1\": 2.0, \"K1\": 1.0, \"V1\": 10.0, \"gamma1\": 1.0,\n         \"n2\": 3.0, \"K2\": 2.0, \"V2\": 5.0, \"T\": 50.0, \"Kd\": 0.1},\n        # Case D\n        {\"n1\": 1.5, \"K1\": 0.5, \"V1\": 8.0, \"gamma1\": 1.0,\n         \"n2\": 2.0, \"K2\": 100.0, \"V2\": 3.0, \"T\": 20.0, \"Kd\": 10.0},\n    ]\n\n    results = []\n    for case in test_cases:\n        result = compute_case(case)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    print(format_results(results))\n\nsolve()\n```", "id": "3346015"}]}