{"hands_on_practices": [{"introduction": "在任何 CRISPR-Cas 系统发挥功能之前，其向导 RNA (gRNA) 必须首先被转录和加工成熟。这个过程是该系统生命周期的基础。本练习将引导您使用基于质量作用动力学的常微分方程 (ODEs) 来描述前体 crRNA 和成熟 crRNA 浓度随时间变化的动态过程。通过将一个核心的生物学过程转化为数学模型并求解其稳态行为，您将实践系统生物学中的一项基本技能 [@problem_id:3298925]。", "problem": "在一个原核生物的成簇规律间隔短回文重复序列 (CRISPR)-CRISPR相关 (Cas) 基因座中，前体CRISPR RNA (pre-CRISPR RNA, pre-crRNA) 由RNA聚合酶转录，随后被一种Cas内切核酸酶加工成成熟的CRISPR RNA (crRNA)。考虑一个位于充分混合、恒定体积细胞中的单个转录单元，其加工过程在线性、非饱和区间内进行。假设如下：\n\n- pre-CRISPR RNA的转录以一个恒定的零级速率 $k_{t}$ 进行（例如，由于一个组成型启动子）。\n- pre-CRISPR RNA加工成crRNA的过程是相对于pre-CRISPR RNA的伪一级反应，有效速率常数为 $k_{p}$，这反映了过量且恒定的Cas加工活性。\n- pre-CRISPR RNA和crRNA均通过一级过程被移除，具有相同的速率常数 $k_{d}$（例如，核糖核酸酶降解和因生长引起的稀释）。\n- 每个加工事件由一个pre-CRISPR RNA分子精确产生一个crRNA分子，无分支反应或逆反应。\n- crRNA对转录或加工过程没有反馈作用，并且没有其他的源或汇。\n\n使用质量作用动力学和上述假设作为唯一的建模基础，推导控制pre-CRISPR RNA浓度 $P(t)$ 和crRNA浓度 $C(t)$ 时间动态的常微分方程。然后，以 $k_{t}$、$k_{p}$ 和 $k_{d}$ 的函数形式，计算出唯一的稳态浓度 $(P^{*}, C^{*})$ 的闭合解。请以 $k_{t}$、$k_{p}$ 和 $k_{d}$ 的符号形式表示您的最终答案，不要代入数值。如果需要指定单位，可设 $k_{t}$ 的单位为 $\\text{concentration}\\cdot\\text{time}^{-1}$，$k_{p}$ 和 $k_{d}$ 的单位为 $\\text{time}^{-1}$，这样 $P^{*}$ 和 $C^{*}$ 的单位即为浓度。请将稳态浓度对以单个行向量的形式提供。", "solution": "在尝试解答之前，对问题进行验证。\n\n### 步骤1：提取已知条件\n- **系统**：原核生物CRISPR-Cas基因座中的单个转录单元。\n- **组分**：前体CRISPR RNA (pre-crRNA)，记为 $P(t)$，和成熟CRISPR RNA (crRNA)，记为 $C(t)$。\n- **过程1（转录）**：pre-CRISPR RNA $P$ 的生成以恒定的零级速率 $k_t$ 进行。\n- **过程2（加工）**：pre-CRISPR RNA $P$ 转化为crRNA $C$ 是一个相对于 $P$ 的伪一级反应，有效速率常数为 $k_p$。\n- **过程3（移除）**：$P$ 和 $C$ 都通过一级过程（降解和稀释）被移除，具有相同的速率常数 $k_d$。\n- **化学计量**：每个加工事件将一个 $P$ 分子转化为一个 $C$ 分子（$P \\to C$）。\n- **假设**：系统充分混合，体积恒定，加工过程在线性/非饱和区间运行，无反馈，无逆反应，且 $P$ 和 $C$ 没有其他源或汇。\n- **目标**：\n    1.  推导浓度 $P(t)$ 和 $C(t)$ 的常微分方程（ODEs）。\n    2.  计算唯一的稳态浓度 $(P^*, C^*)$，作为参数 $k_t, k_p$ 和 $k_d$ 的函数。\n- **要求格式**：最终答案为符号化的行向量。\n\n### 步骤2：使用提取的已知条件进行验证\n1.  **科学依据**：该问题描述了一个简化的RNA生物合成动力学模型，这是分子与系统生物学中的一个核心过程。使用零级生产（用于组成型基因表达）、一级降解和伪一级加工（假设酶过量且未饱和）是该领域构建数学模型的标准且有效的简化假设。其生物学背景，即CRISPR RNA加工，是真实的，并在这个简化框架中得到了准确的描述。\n2.  **问题适定性**：该问题是适定的。它提供了一套完整的反应和相应的速率定律，定义了所有参数（$k_t, k_p, k_d$），并指定了一个清晰、可实现的目标（推导ODE并求解稳态解）。只要物理速率常数为正，所得到的线性ODE系统保证有唯一且稳定的稳态解。\n3.  **客观性**：问题以精确、客观的语言陈述。“零级”、“一级”和“质量作用动力学”等术语在化学动力学和系统生物学中具有无歧义的含义。\n\n该问题没有表现出科学谬误、不完整性、矛盾或模糊性等任何缺陷。这是生化网络数学建模中的一个标准练习题。\n\n### 步骤3：结论与行动\n问题有效。将推导解答。\n\n### 解答推导\n前体CRISPR RNA浓度 $P(t)$ 和成熟crRNA浓度 $C(t)$ 的时间动态由一个常微分方程组描述。这些方程基于质量作用动力学原理建立，即一个物种浓度的变化速率等于所有生成它的反应速率之和减去所有消耗它的反应速率之和。\n\n**1. pre-CRISPR RNA, $P(t)$ 的ODE推导**\npre-CRISPR RNA的浓度 $P$ 因三个过程而变化：\n- **生成**：$P$ 以恒定的零级速率 $k_t$ 转录生成。此过程的速率就是 $k_t$。这对 $P$ 的变化速率贡献一个正项。\n- **加工**：$P$ 被加工成crRNA, $C$。这是一个相对于 $P$ 的伪一级反应，因此其速率为 $k_p P(t)$。这是 $P$ 的一个消耗途径，贡献一个负项。\n- **移除**：$P$ 通过一级过程被移除（降解/稀释）。该反应的速率为 $k_d P(t)$。这是 $P$ 的另一个消耗途径，贡献一个负项。\n\n综合这些项，得到 $P(t)$ 的ODE：\n$$\n\\frac{dP}{dt} = (\\text{rate of production}) - (\\text{rate of processing}) - (\\text{rate of removal})\n$$\n$$\n\\frac{dP}{dt} = k_t - k_p P(t) - k_d P(t)\n$$\n这可以简化为：\n$$\n\\frac{dP}{dt} = k_t - (k_p + k_d)P(t)\n$$\n\n**2. crRNA, $C(t)$ 的ODE推导**\n成熟crRNA的浓度 $C$ 因两个过程而变化：\n- **生成**：$C$ 是由 $P$ 的加工产生的。由于化学计量比为 $1:1$， $C$ 的生成速率等于 $P$ 的加工速率，即 $k_p P(t)$。这对 $C$ 的变化速率贡献一个正项。\n- **移除**：$C$ 通过一级过程被移除，速率常数为 $k_d$。该反应的速率为 $k_d C(t)$。这是 $C$ 的一个消耗途径，贡献一个负项。\n\n综合这些项，得到 $C(t)$ 的ODE：\n$$\n\\frac{dC}{dt} = (\\text{rate of production}) - (\\text{rate of removal})\n$$\n$$\n\\frac{dC}{dt} = k_p P(t) - k_d C(t)\n$$\n\n**3. 稳态浓度的计算**\n系统的稳态定义为所有物种的浓度不再随时间变化的条件。在数学上，这对应于将所有时间导数设置为零：\n$$\n\\frac{dP}{dt} = 0 \\quad \\text{and} \\quad \\frac{dC}{dt} = 0\n$$\n令 $P^*$ 和 $C^*$ 表示稳态浓度。这些ODE变为一个代数方程组：\n1. $0 = k_t - (k_p + k_d)P^*$\n2. $0 = k_p P^* - k_d C^*$\n\n我们可以依次求解这个方程组。首先，我们从方程1解出 $P^*$：\n$$\n(k_p + k_d)P^* = k_t\n$$\n$$\nP^* = \\frac{k_t}{k_p + k_d}\n$$\n接下来，我们使用刚刚得到的 $P^*$ 表达式，从方程2解出 $C^*$：\n$$\nk_d C^* = k_p P^*\n$$\n$$\nC^* = \\frac{k_p}{k_d} P^*\n$$\n代入 $P^*$ 的表达式：\n$$\nC^* = \\frac{k_p}{k_d} \\left( \\frac{k_t}{k_p + k_d} \\right)\n$$\n$$\nC^* = \\frac{k_p k_t}{k_d (k_p + k_d)}\n$$\n\n因此，稳态浓度为 $(P^*, C^*) = \\left(\\frac{k_t}{k_p + k_d}, \\frac{k_p k_t}{k_d(k_p + k_d)}\\right)$。这些表达式具有物理意义，因为所有速率常数（$k_t, k_p, k_d$）本质上都是正的，这确保了浓度 $P^*$ 和 $C^*$ 也为正。\n\n最终答案是以行向量形式表示的稳态浓度对。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{k_{t}}{k_{p} + k_{d}} & \\frac{k_{p} k_{t}}{k_{d}(k_{p} + k_{d})}\n\\end{pmatrix}\n}\n$$", "id": "3298925"}, {"introduction": "当 CRISPR 核糖核蛋白复合物组装完成后，其核心功能是识别并切割靶标 DNA。这个过程并非瞬时完成，而是由一系列离散的步骤组成，包括结合、R 环形成和催化切割。本练习 [@problem_id:3298988] 演示了如何分析多步动力学数据来识别反应瓶颈，即“限速步骤”，并预测整体的酶切效率。这能够帮助您理解微观的速率常数如何决定宏观上可观测的反应速率，从而深入探究 CRISPR 系统的作用机制。", "problem": "考虑成簇规律间隔短回文重复序列 (Clustered Regularly Interspaced Short Palindromic Repeats, CRISPR) 和 CRISPR 相关蛋白 (Cas) 核酸内切酶的作用，其被建模为一个严格的顺序三步过程，作用于单周转、靶标限制、体外条件下的双链脱氧核糖核酸 (DNA) 靶标：步骤 $1$ 是核糖核蛋白与靶标 DNA 结合，由双分子速率常数 $k_b$ (单位 $\\mathrm{M}^{-1}\\,\\mathrm{s}^{-1}$) 驱动；步骤 $2$ 是 R-环形成，由单分子速率常数 $k_r$ (单位 $\\mathrm{s}^{-1}$) 驱动；步骤 $3$ 是催化切割，由单分子速率常数 $k_c$ (单位 $\\mathrm{s}^{-1}$) 驱动。假设核酸酶浓度 $[E]_0$ 恒定且饱和，使得双分子结合步骤可以被视为伪一级反应，其有效速率常数为 $k_b^{*} = k_b [E]_0$。每一步都是不可逆且无记忆的（指数等待时间），并且产物释放足够慢，以至于在观察窗口内不会发生酶的再循环。现已对两个不同的靶标（A 和 B）进行了表征，得到以下测量值：对于靶标 A，$k_b = 2.0 \\times 10^{7}\\ \\mathrm{M}^{-1}\\,\\mathrm{s}^{-1}$，$k_r = 0.20\\ \\mathrm{s}^{-1}$，以及 $k_c = 1.00\\ \\mathrm{s}^{-1}$；对于靶标 B，$k_b = 4.0 \\times 10^{6}\\ \\mathrm{M}^{-1}\\,\\mathrm{s}^{-1}$，$k_r = 0.80\\ \\mathrm{s}^{-1}$，以及 $k_c = 0.50\\ \\mathrm{s}^{-1}$。在整个测定过程中，核酸酶浓度为 $[E]_0 = 50\\ \\mathrm{nM}$。利用化学动力学的基本原理，确定每个靶标的速率限制步骤（结合步骤报告为 $1$，R-环形成步骤报告为 $2$，或催化切割步骤报告为 $3$）。然后通过计算在这些条件下观察到的切割速率常数之比 $k_{\\mathrm{obs},A}/k_{\\mathrm{obs},B}$ 来预测相对单周转切割速率。将你的最终答案以一个包含三个数字的行矩阵形式报告：靶标 A 的速率限制步骤索引，靶标 B 的速率限制步骤索引，以及比值 $k_{\\mathrm{obs},A}/k_{\\mathrm{obs},B}$（四舍五入到四位有效数字）。将该比值表示为一个无量纲的十进制数。最终答案中不要包含单位。", "solution": "用户提供了一个问题陈述，在尝试解决之前需要进行验证。\n\n### 步骤 1：提取已知条件\n-   **模型**：CRISPR-Cas 核酸内切酶作用的严格顺序三步过程。\n    -   步骤 1：结合，双分子速率常数 $k_b$。\n    -   步骤 2：R-环形成，单分子速率常数 $k_r$。\n    -   步骤 3：催化切割，单分子速率常数 $k_c$。\n-   **条件**：单周转、靶标限制、体外。\n-   **假设**：\n    -   恒定且饱和的核酸酶浓度 $[E]_0$。\n    -   结合步骤是伪一级反应，有效速率常数为 $k_b^{*} = k_b [E]_0$。\n    -   每一步都是不可逆且无记忆的。\n    -   产物释放足够慢（无酶再循环）。\n-   **靶标 A 的数据**：\n    -   $k_{b,A} = 2.0 \\times 10^{7}\\ \\mathrm{M}^{-1}\\,\\mathrm{s}^{-1}$\n    -   $k_{r,A} = 0.20\\ \\mathrm{s}^{-1}$\n    -   $k_{c,A} = 1.00\\ \\mathrm{s}^{-1}$\n-   **靶标 B 的数据**：\n    -   $k_{b,B} = 4.0 \\times 10^{6}\\ \\mathrm{M}^{-1}\\,\\mathrm{s}^{-1}$\n    -   $k_{r,B} = 0.80\\ \\mathrm{s}^{-1}$\n    -   $k_{c,B} = 0.50\\ \\mathrm{s}^{-1}$\n-   **核酸酶浓度**：$[E]_0 = 50\\ \\mathrm{nM}$。\n-   **任务**：\n    1.  确定每个靶标（A 和 B）的速率限制步骤，报告步骤索引（$1$、$2$ 或 $3$）。\n    2.  计算观察到的切割速率常数之比 $k_{\\mathrm{obs},A}/k_{\\mathrm{obs},B}$，四舍五入到四位有效数字。\n\n### 步骤 2：使用提取的已知条件进行验证\n-   **科学性**：该问题基于已确立的化学动力学原理，应用于酶作用（特别是 CRISPR-Cas）的简化但标准的模型。顺序不可逆反应、伪一级近似和速率限制步骤的概念是该领域的基础。所提供的速率常数和浓度对于这样的系统是物理上合理的。该模型是科学上合理的。\n-   **定义明确**：该问题是自包含的，并提供了得出唯一解所需的所有数据和定义。任务陈述清晰，模型在数学上是可解的。\n-   **客观性**：问题以精确、无偏见和正式的科学语言陈述。没有主观因素。\n-   **其他缺陷**：该问题没有说明中列出的缺陷。它是可形式化的、完整的、对于*体外*实验是现实的，并且结构良好。\n\n### 步骤 3：结论和行动\n该问题有效。将提供解决方案。\n\n### 解\nCRISPR-Cas 的作用被建模为三个不可逆基元步骤的序列。在核酸酶浓度 $[E]_0$ 恒定且饱和的假设下，初始的双分子结合步骤可以被视为相对于 DNA 靶标的伪一级反应。因此，动力学方案是一系列三个一级反应：\n$$ \\text{Target} \\xrightarrow{k_1} \\text{Intermediate}_1 \\xrightarrow{k_2} \\text{Intermediate}_2 \\xrightarrow{k_3} \\text{Product} $$\n其中每个步骤的速率常数为：\n-   $k_1 = k_b^* = k_b [E]_0$ 用于结合步骤。\n-   $k_2 = k_r$ 用于 R-环形成步骤。\n-   $k_3 = k_c$ 用于催化切割步骤。\n\n核酸酶浓度必须转换为标准摩尔单位：\n$$ [E]_0 = 50\\ \\mathrm{nM} = 50 \\times 10^{-9}\\ \\mathrm{M} $$\n\n**第 1 部分：确定速率限制步骤**\n\n对于一系列不可逆反应，速率限制步骤是速率常数最小的步骤，因为它作为整个过程的主要瓶颈。我们必须计算每个靶标的伪一级速率常数 $k_b^*$，并将其与序列中的其他速率常数进行比较。\n\n**对于靶标 A：**\n速率常数为 $k_{b,A} = 2.0 \\times 10^{7}\\ \\mathrm{M}^{-1}\\,\\mathrm{s}^{-1}$，$k_{r,A} = 0.20\\ \\mathrm{s}^{-1}$，以及 $k_{c,A} = 1.00\\ \\mathrm{s}^{-1}$。\n首先，我们计算伪一级结合速率常数 $k_{b,A}^*$：\n$$ k_{b,A}^* = k_{b,A} [E]_0 = (2.0 \\times 10^{7}\\ \\mathrm{M}^{-1}\\,\\mathrm{s}^{-1}) \\times (50 \\times 10^{-9}\\ \\mathrm{M}) = 1.0\\ \\mathrm{s}^{-1} $$\n现在我们比较靶标 A 的三个有效速率常数：\n-   步骤 $1$ (结合): $k_{b,A}^* = 1.0\\ \\mathrm{s}^{-1}$\n-   步骤 $2$ (R-环形成): $k_{r,A} = 0.20\\ \\mathrm{s}^{-1}$\n-   步骤 $3$ (切割): $k_{c,A} = 1.00\\ \\mathrm{s}^{-1}$\n最小的速率常数是 $k_{r,A} = 0.20\\ \\mathrm{s}^{-1}$。因此，对于靶标 A，速率限制步骤是 R-环形成（步骤 $2$）。\n\n**对于靶标 B：**\n速率常数为 $k_{b,B} = 4.0 \\times 10^{6}\\ \\mathrm{M}^{-1}\\,\\mathrm{s}^{-1}$，$k_{r,B} = 0.80\\ \\mathrm{s}^{-1}$，以及 $k_{c,B} = 0.50\\ \\mathrm{s}^{-1}$。\n首先，我们计算伪一级结合速率常数 $k_{b,B}^*$：\n$$ k_{b,B}^* = k_{b,B} [E]_0 = (4.0 \\times 10^{6}\\ \\mathrm{M}^{-1}\\,\\mathrm{s}^{-1}) \\times (50 \\times 10^{-9}\\ \\mathrm{M}) = 0.20\\ \\mathrm{s}^{-1} $$\n现在我们比较靶标 B 的三个有效速率常数：\n-   步骤 $1$ (结合): $k_{b,B}^* = 0.20\\ \\mathrm{s}^{-1}$\n-   步骤 $2$ (R-环形成): $k_{r,B} = 0.80\\ \\mathrm{s}^{-1}$\n-   步骤 $3$ (切割): $k_{c,B} = 0.50\\ \\mathrm{s}^{-1}$\n最小的速率常数是 $k_{b,B}^* = 0.20\\ \\mathrm{s}^{-1}$。因此，对于靶标 B，速率限制步骤是结合（步骤 $1$）。\n\n**第 2 部分：计算观察到的速率常数之比**\n\n对于多步不可逆序列，总观察速率常数 $k_{\\mathrm{obs}}$ 可以由每个步骤的平均等待时间之和确定。速率常数为 $k_i$ 的步骤的平均等待时间是 $1/k_i$。总平均时间是各个平均时间之和，而总速率是其倒数：\n$$ k_{\\mathrm{obs}} = \\left( \\sum_i \\frac{1}{k_i} \\right)^{-1} = \\left( \\frac{1}{k_b^*} + \\frac{1}{k_r} + \\frac{1}{k_c} \\right)^{-1} $$\n这提供了对总反应速率的综合度量，考虑了所有步骤的影响，而不仅仅是最慢的单个步骤。\n\n**对于靶标 A：**\n使用靶标 A 的速率常数（$k_{b,A}^* = 1.0\\ \\mathrm{s}^{-1}$，$k_{r,A} = 0.20\\ \\mathrm{s}^{-1}$，$k_{c,A} = 1.00\\ \\mathrm{s}^{-1}$）：\n$$ \\frac{1}{k_{\\mathrm{obs},A}} = \\frac{1}{1.0} + \\frac{1}{0.20} + \\frac{1}{1.00} = 1.0 + 5.0 + 1.0 = 7.0\\ \\mathrm{s} $$\n$$ k_{\\mathrm{obs},A} = \\frac{1}{7.0}\\ \\mathrm{s}^{-1} $$\n\n**对于靶标 B：**\n使用靶标 B 的速率常数（$k_{b,B}^* = 0.20\\ \\mathrm{s}^{-1}$，$k_{r,B} = 0.80\\ \\mathrm{s}^{-1}$，$k_{c,B} = 0.50\\ \\mathrm{s}^{-1}$）：\n$$ \\frac{1}{k_{\\mathrm{obs},B}} = \\frac{1}{0.20} + \\frac{1}{0.80} + \\frac{1}{0.50} = 5.0 + 1.25 + 2.0 = 8.25\\ \\mathrm{s} $$\n$$ k_{\\mathrm{obs},B} = \\frac{1}{8.25}\\ \\mathrm{s}^{-1} $$\n\n**观察到的速率常数之比：**\n我们现在可以计算比值 $k_{\\mathrm{obs},A} / k_{\\mathrm{obs},B}$：\n$$ \\frac{k_{\\mathrm{obs},A}}{k_{\\mathrm{obs},B}} = \\frac{1/7.0\\ \\mathrm{s}^{-1}}{1/8.25\\ \\mathrm{s}^{-1}} = \\frac{8.25}{7.0} \\approx 1.1785714... $$\n四舍五入到四位有效数字，该比率为 $1.179$。\n\n最终答案包括靶标 A 的速率限制步骤索引（$2$）、靶标 B 的速率限制步骤索引（$1$）和计算出的比率（$1.179$）。", "answer": "$$ \\boxed{\\begin{pmatrix} 2 & 1 & 1.179 \\end{pmatrix}} $$", "id": "3298988"}, {"introduction": "CRISPR 基因编辑的成功在很大程度上取决于设计的向导 RNA 是否能在其预定靶点高效工作，同时最大限度地减少在非预期位点的活性。这是一个典型的多目标优化工程挑战。本练习 [@problem_id:3298966] 将指导您建立一个预测模型，该模型基于向导 RNA 的序列特征来评估其在靶效率和脱靶风险。通过应用帕累托最优（Pareto optimality）的原则，您将学会如何在一个具有竞争性目标的设计空间中，系统地筛选出最佳候选方案，从而将基础的动力学模型应用于解决合成生物学中的实际设计问题。", "problem": "考虑对作用于基因组位点的Clustered Regularly Interspaced Short Palindromic Repeats (CRISPR)和CRISPR-associated (Cas)核糖核蛋白的核酸内切酶活性进行建模。一个长度为$20$个核苷酸的单向导核糖核酸（sgRNA）识别一个与原型间隔子相邻基序（Protospacer Adjacent Motif, PAM）相邻的基因组原型间隔子。我们使用以下基本原则对向导的性能进行建模：\n\n- 结合与切割倾向相对于一个可加的序列衍生分数是单调的，并通过逻辑斯谛映射转换为概率。具体而言，存在一个内部潜得分$S$，使得一个位点的切割概率为$p = \\sigma(S)$，其中逻辑斯谛函数为$\\sigma(x) = \\dfrac{1}{1 + e^{-x}}$。这反映了将多步识别视为一种软阈值过程的粗粒度观点。\n- 对于一个靶上位点，潜得分$S_{\\mathrm{on}}$通过向导特征的线性组合进行一阶近似：$S_{\\mathrm{on}} = w_0 + w_{\\mathrm{GC}}\\,x_{\\mathrm{GC}} + w_{\\mathrm{PAM}}\\,x_{\\mathrm{PAM}} + w_{\\mathrm{H}}\\,x_{\\mathrm{H}}$，其中$x_{\\mathrm{GC}} \\in [0,1]$是向导的鸟嘌呤-胞嘧啶含量分数，$x_{\\mathrm{PAM}} \\in \\{0,1\\}$表示是否存在典型的PAM上下文，而$x_{\\mathrm{H}}$是向导中最长同聚物链的长度。系数的符号和大小编码了经验观察到的趋势，例如活性随长同聚物的出现而降低。\n- 对于一个与靶上位点在某些原型间隔子位置上存在差异的脱靶位点，错配会通过位置特异性的惩罚项以加法方式降低分数。如果$\\mathcal{M} \\subset \\{1,2,\\dots,20\\}$是错配位置的集合，且$\\delta_i \\ge 0$是位置$i$上错配的惩罚值，那么脱靶潜得分为$S_{\\mathrm{off}} = S_{\\mathrm{on}} - \\sum_{i \\in \\mathcal{M}} \\delta_i$，脱靶切割概率为$p_{\\mathrm{off}} = \\sigma(S_{\\mathrm{off}})$。这实现了一种位置依赖的“种子”敏感性，而无需在一阶可加性之外规定特定的生物物理微观模型。\n- 一个向导的总脱靶风险是其所有列举的候选脱靶位点上的预期切割概率之和：$R = \\sum_{j=1}^{N_{\\mathrm{off}}} p_{\\mathrm{off},j}$，其中$N_{\\mathrm{off}}$是为该向导考虑的脱靶位点数量。\n- 一个权衡收益（靶上切割）与成本（总脱靶切割）的复合效用分数为$U = p_{\\mathrm{on}} - c \\, R$，其中$c \\ge 0$是一个给定的权衡系数，用以量化脱靶切割相对于靶上切割的相对惩罚。\n\n您的任务是编写一个程序，针对一组测试用例，计算每个候选向导的复合效用分数$U$，并在最大化$p_{\\mathrm{on}}$和最小化$R$的双目标支配关系下，选择Pareto最优的向导集合。当且仅当$p_{\\mathrm{on},a} \\ge p_{\\mathrm{on},b}$且$R_a \\le R_b$，并且其中至少有一个为严格不等式时，我们称向导$a$支配向导$b$。Pareto最优集包含所有不被任何其他向导支配的向导。\n\n您的程序必须使用下面给出的确切参数值作为测试套件来实现上述原理。此处出现的所有数字都是无量纲的。\n\n测试套件参数：\n\n- 案例1：\n  - 线性系数：$w_0 = -1.0$，$w_{\\mathrm{GC}} = 2.5$，$w_{\\mathrm{PAM}} = 1.0$，$w_{\\mathrm{H}} = -0.3$。\n  - 位置错配惩罚$(\\delta_i)_{i=1}^{20}$：位置$1$到$5$：每个$1.6$；位置$6$到$10$：每个$1.0$；位置$11$到$15$：每个$0.6$；位置$16$到$20$：每个$0.4$。\n  - 权衡系数：$c = 0.5$。\n  - 向导（每个项目为 $(x_{\\mathrm{GC}}, x_{\\mathrm{PAM}}, x_{\\mathrm{H}}, \\{\\text{脱靶错配}\\})$），其中错配位置以$\\{1,\\dots,20\\}$内的1-based索引列出：\n    - 向导0：$(0.45, 1, 2, \\{\\{3,12\\}, \\{5\\}\\})$。\n    - 向导1：$(0.60, 1, 3, \\{\\{1,2\\}, \\{15,16,17\\}\\})$。\n    - 向导2：$(0.55, 0, 1, \\{\\{7\\}\\})$。\n    - 向导3：$(0.35, 1, 4, \\{\\{10,11\\}, \\{2\\}, \\{19\\}\\})$。\n- 案例2：\n  - 线性系数：$w_0 = -1.0$，$w_{\\mathrm{GC}} = 2.5$，$w_{\\mathrm{PAM}} = 1.0$，$w_{\\mathrm{H}} = -0.3$。\n  - 位置错配惩罚$(\\delta_i)_{i=1}^{20}$：位置$1$到$5$：每个$1.6$；位置$6$到$10$：每个$1.0$；位置$11$到$15$：每个$0.6$；位置$16$到$20$：每个$0.4$。\n  - 权衡系数：$c = 0.2$。\n  - 向导：\n    - 向导0：$(0.50, 1, 1, \\{\\})$。\n    - 向导1：$(0.65, 1, 2, \\{\\}\\,)$。\n    - 向导2：$(0.40, 0, 1, \\{\\{1,5,10\\}\\})$。\n- 案例3：\n  - 线性系数：$w_0 = -1.0$，$w_{\\mathrm{GC}} = 2.5$，$w_{\\mathrm{PAM}} = 1.0$，$w_{\\mathrm{H}} = -0.3$。\n  - 位置错配惩罚$(\\delta_i)_{i=1}^{20}$：位置$1$到$5$：每个$1.6$；位置$6$到$10$：每个$1.0$；位置$11$到$15$：每个$0.6$；位置$16$到$20$：每个$0.4$。\n  - 权衡系数：$c = 0.8$。\n  - 向导：\n    - 向导0：$(0.62, 1, 2, \\{\\{1\\}, \\{2\\}, \\{3\\}, \\{1,2\\}, \\{4,5\\}\\})$。\n    - 向导1：$(0.50, 1, 2, \\{\\{18,19,20\\}\\})$。\n    - 向导2：$(0.48, 0, 1, \\{\\{12\\}, \\{13\\}\\})$。\n    - 向导3：$(0.36, 1, 1, \\{\\{19\\}\\})$。\n\n实现要求：\n\n- 对于每个案例中的每个向导，计算$S_{\\mathrm{on}}$、$p_{\\mathrm{on}} = \\sigma(S_{\\mathrm{on}})$、每个错配集合$\\mathcal{M}$的脱靶概率$p_{\\mathrm{off}} = \\sigma\\!\\left(S_{\\mathrm{on}} - \\sum_{i \\in \\mathcal{M}} \\delta_i\\right)$、总风险$R = \\sum p_{\\mathrm{off}}$以及复合效用$U = p_{\\mathrm{on}} - c\\,R$。\n- 根据上述支配规则确定Pareto最优集，目标是最大化$p_{\\mathrm{on}}$和最小化$R$。将该集合以0-based索引的升序形式报告。\n- $U$的数值输出必须为浮点数，索引为整数。在报告前将每个$U$四舍五入到$6$位小数。\n\n最终输出格式：\n\n- 您的程序应生成一行输出，其中包含跨案例聚合的结果，形式为方括号括起来的逗号分隔列表。对于每个案例，您需要按顺序输出两个元素：该案例中所有向导的四舍五入后的复合效用列表，以及Pareto最优向导的索引列表。因此，总输出格式为 $[\\,[U^{(1)}_0,\\dots,U^{(1)}_{n_1-1}],\\,[I^{(1)}_0,\\dots],\\,[U^{(2)}_0,\\dots],\\,[I^{(2)}_0,\\dots],\\,[U^{(3)}_0,\\dots],\\,[I^{(3)}_0,\\dots]\\,]$，不含任何额外文本。", "solution": "该问题是有效的，因为它科学地基于CRISPR-Cas建模的既定（尽管简化了的）原则，在数学上是适定的，并为计算解决方案提供了一套完整且一致的数据和定义。\n\n任务是为几个候选单向导RNA（sgRNA）计算复合效用分数$U$，并根据靶上活性和脱靶风险确定Pareto最优的向导集合。解决方案的步骤是首先实现所提供的数学模型，然后应用标准算法来寻找Pareto前沿。\n\n**1. 数学模型实现**\n\n模型的核心是一个潜得分$S$，它通过逻辑斯谛S型函数 $\\sigma(x) = \\frac{1}{1 + e^{-x}}$ 转换为切割概率$p$。\n\n对于每个向导，其特征在于GC含量分数$x_{\\mathrm{GC}}$、典型PAM上下文指示符$x_{\\mathrm{PAM}}$和最长同聚物链长度$x_{\\mathrm{H}}$，我们首先计算靶上潜得分$S_{\\mathrm{on}}$。该分数是向导特征的线性组合：\n$$S_{\\mathrm{on}} = w_0 + w_{\\mathrm{GC}}\\,x_{\\mathrm{GC}} + w_{\\mathrm{PAM}}\\,x_{\\mathrm{PAM}} + w_{\\mathrm{H}}\\,x_{\\mathrm{H}}$$\n其中 $w_0$、$w_{\\mathrm{GC}}$、$w_{\\mathrm{PAM}}$ 和 $w_{\\mathrm{H}}$ 是给定的系数。\n\n靶上切割概率$p_{\\mathrm{on}}$则计算如下：\n$$p_{\\mathrm{on}} = \\sigma(S_{\\mathrm{on}})$$\n\n接下来，我们评估脱靶效应。对于与一个向导相关的$N_{\\mathrm{off}}$个潜在脱靶位点中的每一个，我们都给定了一组错配位置 $\\mathcal{M}_j \\subset \\{1, 2, \\dots, 20\\}$，其中 $j \\in \\{1, \\dots, N_{\\mathrm{off}}\\}$。该模型假定错配以加法方式对潜得分进行惩罚。对于一个脱靶位点$j$的总惩罚是每个错配位置$i \\in \\mathcal{M}_j$上位置特异性惩罚$\\delta_i$的总和：\n$$\\Delta_j = \\sum_{i \\in \\mathcal{M}_j} \\delta_i$$\n位点$j$的脱靶潜得分$S_{\\mathrm{off},j}$是靶上得分减去此惩罚项：\n$$S_{\\mathrm{off},j} = S_{\\mathrm{on}} - \\Delta_j$$\n相应的脱靶切割概率是$p_{\\mathrm{off},j} = \\sigma(S_{\\mathrm{off},j})$。\n\n一个向导的总脱靶风险$R$是其所有考虑的脱靶位点上的这些概率之和：\n$$R = \\sum_{j=1}^{N_{\\mathrm{off}}} p_{\\mathrm{off},j}$$\n如果一个向导没有指定的脱靶位点，其风险$R$为$0$。\n\n最后，复合效用分数$U$是靶上切割收益（$p_{\\mathrm{on}}$）与脱靶风险成本（$R$）之间的线性权衡，由系数$c$加权：\n$$U = p_{\\mathrm{on}} - c \\, R$$\n在测试用例中，为每个向导计算此值，并按要求四舍五入到$6$位小数。\n\n**2. Pareto最优性分析**\n\n任务的第二部分是识别非支配向导的集合。这是一个双目标优化问题，我们试图同时最大化$p_{\\mathrm{on}}$并最小化$R$。\n\n如果向导$a$在两个目标上都至少与向导$b$一样好，并且在至少一个目标上严格更优，则称向导$a$支配向导$b$。形式上，向导$a$支配向导$b$的条件是：\n$$(p_{\\mathrm{on},a} \\ge p_{\\mathrm{on},b} \\text{ and } R_a \\le R_b) \\text{ and } (p_{\\mathrm{on},a} > p_{\\mathrm{on},b} \\text{ or } R_a  R_b)$$\n\n为了找到Pareto最优集，我们进行成对比较。对于所有向导集合中的每个向导$g_i$，我们检查它是否被任何其他向导$g_j$所支配。如果不存在这样的支配向导$g_j$，则$g_i$是Pareto最优集的一部分。\n\n算法如下：\n1. 对每个向导$i$，计算并存储度量对$(p_{\\mathrm{on},i}, R_i)$。\n2. 初始化一个空的Pareto集$\\mathcal{P}$。\n3. 对于每个向导$i$：\n    a. 假设向导$i$未被支配。\n    b. 对于每个其他向导$j$（其中$j \\neq i$）：\n        i. 使用定义的条件检查向导$j$是否支配向导$i$。\n        ii. 如果发现支配关系，将向导$i$标记为被支配，并跳出内层循环。\n    c. 在检查完所有其他向导后，如果向导$i$未被标记为被支配，则将其索引添加到集合$\\mathcal{P}$中。\n4. 最终结果是$\\mathcal{P}$中0-based索引的列表，按升序排序。\n\n这个两阶段过程——首先，系统地计算所有向导的$(p_{\\mathrm{on}},R)$对和效用分数$U$，其次，通过穷举成对比较来识别非支配子集——为每个测试用例提供了完整的解决方案。", "answer": "[[0.60913,0.316828,0.569424,0.380424],[1,2],[0.721115,0.735923,0.42337],[1],[0.046808,0.598263,0.439055,0.563063],[1,3]]", "id": "3298966"}]}