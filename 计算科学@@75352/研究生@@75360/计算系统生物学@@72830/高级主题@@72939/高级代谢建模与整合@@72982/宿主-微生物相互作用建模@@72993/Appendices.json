{"hands_on_practices": [{"introduction": "宿主-微生物相互作用的一个基本方面是争夺有限的资源。这个练习将指导你应用资源竞争理论中的一个核心概念——$R^*$法则，来预测微生物种群的竞争结果。通过推导和计算不同物种的平衡资源需求量（$R^*$），你将能够确定在特定条件下，哪种微生物能够成功入侵并定殖于宿主生态位中[@problem_id:3319034]。", "problem": "考虑宿主体内一个混合均匀的黏膜微环境，其中单一的限制性资源（记为 $R$，单位为毫摩尔/升 $\\mathrm{mmol\\ L^{-1}}$）由宿主以流入浓度 $S$ 供给，并以体积更新速率 $D$（单位为每小时 $\\mathrm{h^{-1}}$）被冲洗掉。三个微生物种群使用资源 $R$：一个病原体 $P$ 和两个共生菌 $C_{A}$ 和 $C_{B}$。假设其动力学行为遵循以下恒化器模型，该模型符合质量平衡和标准微生物生理学：\n- 资源动力学由下式给出：\n$$\n\\frac{dR}{dt} \\;=\\; D\\,(S - R) \\;-\\; \\sum_{i\\in\\{P,C_{A},C_{B}\\}} \\frac{1}{Y_{i}}\\,\\mu_{i}(R)\\,X_{i},\n$$\n其中 $X_{i}$ 是物种 $i$ 的生物量浓度（以任何一致的生物量单位计量），$Y_{i}$ 是每单位资源的生物量产率（单位为生物量/$\\mathrm{mmol}$），而 $\\mu_{i}(R)$ 是总比生长速率。\n- 种群动力学由下式给出：\n$$\n\\frac{dX_{i}}{dt} \\;=\\; \\big(\\mu_{i}(R) - m_{i} - D\\big)\\,X_{i},\n$$\n其中 $m_{i}$ 是一个维持速率（单位为 $\\mathrm{h^{-1}}$），它从总生长中减去，得到可用于在稀释平衡下持久生存的净生长。\n\n假设每个物种的生长动力学遵循米氏-蒙诺 (Monod) 模型，\n$$\n\\mu_{i}(R) \\;=\\; \\mu_{\\max,i}\\,\\frac{R}{K_{i} + R},\n$$\n其中 $\\mu_{\\max,i}$ 是最大比生长速率（单位为 $\\mathrm{h^{-1}}$），$K_{i}$ 是半饱和常数（单位为 $\\mathrm{mmol\\ L^{-1}}$）。物种 $i$ 的平衡资源需求 $R^{*}_{i}$ 被定义为在该动力学模型下，物种 $i$ 恰好能在恒化器中单独持久生存（其人均净生长率与稀释率相平衡）时的稳态资源浓度。\n\n宿主环境和三个物种的参数如下：\n- 宿主供给浓度 $S = 0.25$ $\\mathrm{mmol\\ L^{-1}}$；更新速率 $D = 0.20$ $\\mathrm{h^{-1}}$。\n- 病原体 $P$：$\\mu_{\\max,P} = 0.85$ $\\mathrm{h^{-1}}$，$K_{P} = 0.030$ $\\mathrm{mmol\\ L^{-1}}$，$m_{P} = 0.050$ $\\mathrm{h^{-1}}$，$Y_{P} = 0.45$ (生物量/$\\mathrm{mmol}$)。\n- 共生菌 $C_{A}$：$\\mu_{\\max,C_{A}} = 0.65$ $\\mathrm{h^{-1}}$，$K_{C_{A}} = 0.015$ $\\mathrm{mmol\\ L^{-1}}$，$m_{C_{A}} = 0.020$ $\\mathrm{h^{-1}}$，$Y_{C_{A}} = 0.55$ (生物量/$\\mathrm{mmol}$)。\n- 共生菌 $C_{B}$：$\\mu_{\\max,C_{B}} = 1.10$ $\\mathrm{h^{-1}}$，$K_{C_{B}} = 0.080$ $\\mathrm{mmol\\ L^{-1}}$，$m_{C_{B}} = 0.120$ $\\mathrm{h^{-1}}$，$Y_{C_{B}} = 0.40$ (生物量/$\\mathrm{mmol}$)。\n\n任务：\n1. 从上述动力学定义和 Monod 法则出发，推导任何单个物种 $i$ 的 $R^{*}_{i}$ 关于 $(\\mu_{\\max,i}, K_{i}, m_{i}, D)$ 的通用闭式表达式。\n2. 使用推导出的表达式和给定参数，计算 $R^{*}_{P}$、$R^{*}_{C_{A}}$ 和 $R^{*}_{C_{B}}$。\n3. 假设宿主微环境最初由处于其单物种稳态的 $C_{A}$ 单独主导。利用动力学定义和你的 $R^{*}$ 结果，通过计算以下量来确定当 $P$ 或 $C_{B}$ 以无穷小密度引入时是否能够入侵：\n$$\n\\Delta_{i\\mid C_{A}} \\;=\\; R_{\\mathrm{res}} - R^{*}_{i},\n$$\n其中 $R_{\\mathrm{res}}$ 是只有 $C_{A}$ 存在时的定居状态下的资源浓度。一个正的 $\\Delta_{i\\mid C_{A}}$ 值意味着入侵是可能的；一个负值则意味着入侵失败。\n\n答案格式：\n- 以有序行矩阵 $\\big(R^{*}_{P}\\; R^{*}_{C_{A}}\\; R^{*}_{C_{B}}\\; \\Delta_{P\\mid C_{A}}\\; \\Delta_{C_{B}\\mid C_{A}}\\big)$ 的形式报告这五个所求的量。\n- 将每个条目的单位表示为 $\\mathrm{mmol\\ L^{-1}}$。\n- 将报告的每个值四舍五入到四位有效数字。", "solution": "该问题是良定的，其科学基础是标准生态竞争理论，并包含了获得唯一解所需的所有信息。因此，我们可以进行推导和计算。\n\n**1. 平衡资源需求 $R^{*}_{i}$ 的推导**\n\n平衡资源需求 $R^{*}_{i}$ 被定义为单个物种 $i$ 恰好能在恒化器中持久生存时的稳态资源浓度。这意味着其种群生物量 $X_{i}$ 是非零常数，即处于一个非平凡稳态。任何稳态的条件都是种群的变化率为零：\n$$\n\\frac{dX_{i}}{dt} \\;=\\; \\big(\\mu_{i}(R) - m_{i} - D\\big)\\,X_{i} \\;=\\; 0\n$$\n对于一个非平凡稳态（$X_i > 0$），括号中的项必须为零。满足此条件的资源浓度根据定义即为 $R^{*}_{i}$：\n$$\n\\mu_{i}(R^{*}_{i}) - m_{i} - D \\;=\\; 0\n$$\n该方程表明，在平衡资源水平 $R^{*}_{i}$ 处，总比生长速率必须精确平衡由维持（$m_i$）和冲洗（$D$）造成的总损失速率。重新整理可得持久生存所需的生长速率：\n$$\n\\mu_{i}(R^{*}_{i}) \\;=\\; m_{i} + D\n$$\n现在我们将给定的米氏-蒙诺 (Monod) 动力学模型代入生长速率 $\\mu_{i}(R)$：\n$$\n\\mu_{\\max,i}\\,\\frac{R^{*}_{i}}{K_{i} + R^{*}_{i}} \\;=\\; m_{i} + D\n$$\n为了找到 $R^{*}_{i}$ 的闭式表达式，我们用代数方法求解此方程：\n$$\n\\mu_{\\max,i}\\,R^{*}_{i} \\;=\\; (m_{i} + D)(K_{i} + R^{*}_{i})\n$$\n$$\n\\mu_{\\max,i}\\,R^{*}_{i} \\;=\\; (m_{i} + D)K_{i} + (m_{i} + D)R^{*}_{i}\n$$\n$$\n\\mu_{\\max,i}\\,R^{*}_{i} - (m_{i} + D)R^{*}_{i} \\;=\\; (m_{i} + D)K_{i}\n$$\n$$\nR^{*}_{i}\\,\\big(\\mu_{\\max,i} - m_{i} - D\\big) \\;=\\; K_{i}\\,(m_{i} + D)\n$$\n最后，分离出 $R^{*}_{i}$ 可得到通用表达式：\n$$\nR^{*}_{i} \\;=\\; K_{i}\\,\\frac{m_{i} + D}{\\mu_{\\max,i} - m_{i} - D}\n$$\n该表达式在 $\\mu_{\\max,i} > m_{i} + D$ 的条件下有效，这确保了物种具有足以克服其损失的最大潜在生长速率，从而得到一个有物理意义的正值 $R^{*}_{i}$。\n\n**2. $R^{*}_{P}$、$R^{*}_{C_{A}}$ 和 $R^{*}_{C_{B}}$ 的计算**\n\n使用推导出的公式和所提供的参数，其中稀释速率 $D = 0.20$ $\\mathrm{h^{-1}}$，我们计算每个物种的平衡资源需求。\n\n对于病原体 $P$：\n$m_{P} + D = 0.050 + 0.20 = 0.25$ $\\mathrm{h^{-1}}$\n$\\mu_{\\max,P} - m_{P} - D = 0.85 - 0.050 - 0.20 = 0.60$ $\\mathrm{h^{-1}}$\n$$\nR^{*}_{P} \\;=\\; K_{P}\\,\\frac{m_{P} + D}{\\mu_{\\max,P} - m_{P} - D} \\;=\\; (0.030\\,\\mathrm{mmol\\ L^{-1}})\\,\\frac{0.25}{0.60} \\;=\\; 0.0125\\,\\mathrm{mmol\\ L^{-1}}\n$$\n\n对于共生菌 $C_{A}$：\n$m_{C_{A}} + D = 0.020 + 0.20 = 0.22$ $\\mathrm{h^{-1}}$\n$\\mu_{\\max,C_{A}} - m_{C_{A}} - D = 0.65 - 0.22 = 0.43$ $\\mathrm{h^{-1}}$\n$$\nR^{*}_{C_{A}} \\;=\\; K_{C_{A}}\\,\\frac{m_{C_{A}} + D}{\\mu_{\\max,C_{A}} - m_{C_{A}} - D} \\;=\\; (0.015\\,\\mathrm{mmol\\ L^{-1}})\\,\\frac{0.22}{0.43} \\;\\approx\\; 0.0076744\\,\\mathrm{mmol\\ L^{-1}}\n$$\n\n对于共生菌 $C_{B}$：\n$m_{C_{B}} + D = 0.120 + 0.20 = 0.32$ $\\mathrm{h^{-1}}$\n$\\mu_{\\max,C_{B}} - m_{C_{B}} - D = 1.10 - 0.32 = 0.78$ $\\mathrm{h^{-1}}$\n$$\nR^{*}_{C_{B}} \\;=\\; K_{C_{B}}\\,\\frac{m_{C_{B}} + D}{\\mu_{\\max,C_{B}} - m_{C_{B}} - D} \\;=\\; (0.080\\,\\mathrm{mmol\\ L^{-1}})\\,\\frac{0.32}{0.78} \\;\\approx\\; 0.032821\\,\\mathrm{mmol\\ L^{-1}}\n$$\n\n**3. 入侵分析**\n\n问题假设一个由处于其单物种稳态的共生菌 $C_A$ 主导的微环境。在这种状态下，假设该物种没有被冲洗掉（$X_{C_A} > 0$），该物种会将其限制性资源的浓度降低到其自身的平衡需求水平。因此，定居者环境下的资源浓度为 $R_{\\mathrm{res}} = R^{*}_{C_{A}}$。这是可能的，因为 $R^{*}_{C_{A}} \\approx 0.007674\\,\\mathrm{mmol\\ L^{-1}}$ 小于供给浓度 $S=0.25\\,\\mathrm{mmol\\ L^{-1}}$。\n\n一个入侵物种 $i$（此处为 $P$ 或 $C_B$）如果其初始人均生长率为正，就能在该环境中成功建立种群。处于无穷小密度的入侵者的生长速率由定居者设定的资源水平 $R_{\\mathrm{res}}$ 决定：\n$$\n\\frac{1}{X_i}\\frac{dX_{i}}{dt} \\;=\\; \\mu_{i}(R_{\\mathrm{res}}) - m_{i} - D\n$$\n该生长速率为正当且仅当 $\\mu_{i}(R_{\\mathrm{res}}) > m_{i} + D$。由于 $\\mu_i(R)$ 是 $R$ 的单调递增函数，并且根据定义 $\\mu_{i}(R^{*}_{i}) = m_{i} + D$，因此正增长的条件变为 $R_{\\mathrm{res}} > R^{*}_{i}$。\n\n问题定义了量 $\\Delta_{i\\mid C_{A}} = R_{\\mathrm{res}} - R^{*}_{i}$。正值表示入侵成功。使用 $R_{\\mathrm{res}} = R^{*}_{C_{A}}$，我们计算这两个潜在入侵者的 $\\Delta$ 值。\n\n对于病原体 $P$ 的入侵：\n$$\n\\Delta_{P\\mid C_{A}} \\;=\\; R^{*}_{C_{A}} - R^{*}_{P} \\;\\approx\\; 0.0076744 - 0.0125 \\;=\\; -0.0048256\\,\\mathrm{mmol\\ L^{-1}}\n$$\n由于 $\\Delta_{P\\mid C_{A}}  0$，病原体 $P$ 无法入侵被 $C_A$ 占据的微环境。\n\n对于共生菌 $C_{B}$ 的入侵：\n$$\n\\Delta_{C_{B}\\mid C_{A}} \\;=\\; R^{*}_{C_{A}} - R^{*}_{C_{B}} \\;\\approx\\; 0.0076744 - 0.032821 \\;=\\; -0.0251466\\,\\mathrm{mmol\\ L^{-1}}\n$$\n由于 $\\Delta_{C_{B}\\mid C_{A}}  0$，共生菌 $C_B$ 也无法入侵。\n\n这个结果与 R* 竞争法则一致，该法则指出，对于单一限制性资源，拥有最低 $R^*$ 值的物种将成为优势竞争者并排挤所有其他物种。在这里，$R^{*}_{C_{A}}$ 是三个值中最低的。\n\n将五个所求的量四舍五入到四位有效数字，得到：\n$R^{*}_{P} \\to 0.01250$\n$R^{*}_{C_{A}} \\to 0.007674$\n$R^{*}_{C_{B}} \\to 0.03282$\n$\\Delta_{P\\mid C_{A}} \\to -0.004826$\n$\\Delta_{C_{B}\\mid C_{A}} \\to -0.02515$", "answer": "$$\n\\boxed{\\begin{pmatrix} 0.01250  0.007674  0.03282  -0.004826  -0.02515 \\end{pmatrix}}\n$$", "id": "3319034"}, {"introduction": "从宏观的生态竞争转向微观的代谢整合，宿主和微生物通过交换代谢物形成复杂的相互依赖关系。通量平衡分析（Flux Balance Analysis, FBA）是模拟这种代谢网络相互作用的强大框架。这个实践任务将引导你从头开始构建一个简化的宿主-微生物群落FBA模型，并解决一个线性规划问题，这是计算系统生物学中的一项核心技能[@problem_id:3319045]。", "problem": "要求您形式化并求解一个在稳态质量平衡下耦合宿主和微生物的群落流平衡分析 (FBA) 模型。流平衡分析 (FBA) 通过断言胞内代谢物的稳态质量平衡来为代谢网络建模，该平衡由一个化学计量矩阵和一个通量向量编码，并在物理化学通量边界的约束下优化一个具有生物学意义的线性目标。在宿主-微生物群落 FBA 中，宿主和微生物由独立的化学计量矩阵和通量向量表示，并通过代表室间代谢物运输的交换通量耦合在一起。\n\n从基本原理开始：\n- 每个室的稳态质量平衡意味着在恒定通量模式下，胞内代谢物浓度不随时间变化。这被编码为一个关于通量的齐次线性系统。对于一个化学计量矩阵 $S \\in \\mathbb{R}^{m \\times n}$（其中 $m$ 是胞内代谢物的数量， $n$ 是反应的数量）和通量向量 $v \\in \\mathbb{R}^{n}$，质量平衡为 $S v = 0$。\n- 由于酶容量、热力学和运输限制，反应通量是有界的。每个通量 $v_i$ 都受到下界和上界 $l_i \\le v_i \\le u_i$ 的约束，其物理单位为毫摩尔每克干重每小时 (mmol gDW$^{-1}$ h$^{-1}$)。\n- 群落目标是宿主和微生物目标的加权和。使用宿主目标通量 $v_{h,\\text{obj}}$ 和微生物目标通量 $v_{m,\\text{obj}}$，以及非负权重 $w_h, w_m$，群落目标为 $w_h v_{h,\\text{obj}} + w_m v_{m,\\text{obj}}$。\n\n建立优化问题\n$$\n\\max_{v_h, v_m, v_e}\\quad w_h\\, v_{h,\\text{obj}} + w_m\\, v_{m,\\text{obj}}\n$$\n约束条件为\n$$\nS_h v_h = 0,\\quad S_m v_m = 0,\n$$\n以及通过交换通量 $v_e$ 在宿主和微生物之间建立的交换耦合约束，同时还有各自的通量边界。交换耦合必须强制使宿主交换代谢物的输出通量等于微生物的输入通量，并且也等于交换变量。具体来说，如果 $v_{h,\\text{exp}}$ 是宿主输出反应通量， $v_{m,\\text{imp}}$ 是微生物输入反应通量，则施加约束\n$$\nv_e - v_{h,\\text{exp}} = 0,\\quad v_e - v_{m,\\text{imp}} = 0,\n$$\n其中 $v_e$ 的边界为 $0 \\le v_e \\le E_{\\max}$，单位为 mmol gDW$^{-1}$ h$^{-1}$。\n\n将此线性优化实现为单个程序，该程序在给定以下参数值测试套件的情况下，为每种情况计算最优目标值 $w_h\\, v_{h,\\text{obj}} + w_m\\, v_{m,\\text{obj}}$。将每个最优值以 mmol gDW$^{-1}$ h$^{-1}$ 为单位，报告为四舍五入到六位小数的浮点数。\n\n宿主网络定义：\n- 宿主代谢物：两种胞内物质，由行隐式标记。\n- 宿主反应：$4$ 个反应，其化学计量矩阵为\n$$\nS_h = \\begin{bmatrix}\n1  -1  0  0\\\\\n0  1  -1  -1\n\\end{bmatrix},\n$$\n其中列按顺序对应于反应：$R_{h,1}$（从环境中吸收 $A$），$R_{h,2}$（$A_h \\to B_h$ 的转化），$R_{h,3}$（使用 $B_h$ 的宿主生物量），$R_{h,4}$（将 $B_h$ 输出到微生物）。宿主目标是最大化宿主生物量通量，因此宿主目标选择器为\n$$\nc_h = \\begin{bmatrix}0  0  1  0\\end{bmatrix}^\\top,\n$$\n它选择了 $R_{h,3}$。\n\n微生物网络定义：\n- 微生物代谢物：两种胞内物质，由行隐式标记。\n- 微生物反应：$3$ 个反应，其化学计量矩阵为\n$$\nS_m = \\begin{bmatrix}\n1  -1  0\\\\\n0  1  -1\n\\end{bmatrix},\n$$\n其中列按顺序对应于反应：$R_{m,1}$（从宿主输入 $B$），$R_{m,2}$（$B_m \\to C_m$ 的转化），$R_{m,3}$（使用 $C_m$ 的微生物生物量）。微生物目标选择器为\n$$\nc_m = \\begin{bmatrix}0  0  1\\end{bmatrix}^\\top,\n$$\n它选择了 $R_{m,3}$。\n\n交换耦合：\n- 单个交换变量 $v_e$ 代表从宿主到微生物的 $B$ 的净通量。它通过等式 $v_e = v_{h,4}$ 和 $v_e = v_{m,1}$ 与宿主输出和微生物输入耦合。\n- $v_e$ 的边界：$0 \\le v_e \\le E_{\\max}$，其中 $E_{\\max}$ 在每个测试用例中指定。\n\n通量边界，除非在每个测试用例中另有规定：\n- 宿主反应边界（按 $R_{h,1}$, $R_{h,2}$, $R_{h,3}$, $R_{h,4}$ 的顺序）：下界 $l_h = [0, 0, 0, 0]$ 和上界 $u_h = [U_{\\text{in}}, 10, 10, 10]$，其中 $U_{\\text{in}}$ 是每个测试用例中为 $R_{h,1}$ 提供的宿主吸收能力，单位为 mmol gDW$^{-1}$ h$^{-1}$，其他上界为 $10$ mmol gDW$^{-1}$ h$^{-1}$。\n- 微生物反应边界（按 $R_{m,1}$, $R_{m,2}$, $R_{m,3}$ 的顺序）：下界 $l_m = [0, 0, 0]$ 和上界 $u_m = [10, 10, 10]$，单位为 mmol gDW$^{-1}$ h$^{-1}$。\n\n测试套件：\n- 情况 $1$：权重 $w_h = 0.5$, $w_m = 0.5$；宿主吸收能力 $U_{\\text{in}} = 10$；交换上限 $E_{\\max} = 5$。\n- 情况 $2$：权重 $w_h = 0.5$, $w_m = 0.5$；$U_{\\text{in}} = 10$；$E_{\\max} = 0$。\n- 情况 $3$：权重 $w_h = 0$, $w_m = 1$；$U_{\\text{in}} = 10$；$E_{\\max} = 5$。\n- 情况 $4$：权重 $w_h = 0.2$, $w_m = 0.8$；$U_{\\text{in}} = 3$；$E_{\\max} = 100$。\n\n您的程序应按如下方式为每种情况设置组合线性规划。设完整决策向量为 $x = [v_h; v_m; v_e] \\in \\mathbb{R}^{8}$，其中 $v_h \\in \\mathbb{R}^{4}$， $v_m \\in \\mathbb{R}^{3}$， $v_e \\in \\mathbb{R}^{1}$。通过将 $S_h v_h = 0$ 和 $S_m v_m = 0$ 用适当的补零嵌入到 $A_{\\text{eq}}$ 中，并为 $v_e - v_{h,4} = 0$ 和 $v_e - v_{m,1} = 0$ 添加两行，来构造等式约束\n$$\nA_{\\text{eq}} x = b_{\\text{eq}},\n$$\n$x$ 的边界由宿主边界、微生物边界和交换边界 $0 \\le v_e \\le E_{\\max}$ 拼接而成。用于最大化的目标向量是\n$$\nc^\\top x = w_h c_h^\\top v_h + w_m c_m^\\top v_m + 0 \\cdot v_e,\n$$\n您应通过对 $c$ 取反将其实现为最小化问题。\n\n所需输出格式：\n- 为每种情况计算最优目标值 $w_h\\, v_{h,\\text{obj}} + w_m\\, v_{m,\\text{obj}}$，单位为 mmol gDW$^{-1}$ h$^{-1}$，四舍五入到六位小数。\n- 生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，例如 $[\\alpha_1,\\alpha_2,\\alpha_3,\\alpha_4]$，其中每个 $\\alpha_i$ 是按上述顺序列出的相应情况的浮点数。", "solution": "该问题要求求解一个线性规划（LP）问题，该问题模拟宿主和微生物之间的代谢耦合。目标是在稳态条件下最大化它们各自生物量通量的加权和。\n\n首先，我们通过组合给定的化学计量矩阵、耦合约束和边界来构建完整的线性系统。决策变量向量 $x$ 拼接了宿主通量 ($v_h$)、微生物通量 ($v_m$) 和交换通量 ($v_e$)：\n$$\nx = [v_{h,1}, v_{h,2}, v_{h,3}, v_{h,4}, v_{m,1}, v_{m,2}, v_{m,3}, v_e]^\\top \\in \\mathbb{R}^8\n$$\n要最大化的目标函数是 $Z = w_h v_{h,3} + w_m v_{m,3}$。\n\n系统的约束条件如下：\n1.  **宿主质量平衡 ($S_h v_h = 0$)**:\n    *   $v_{h,1} - v_{h,2} = 0$\n    *   $v_{h,2} - v_{h,3} - v_{h,4} = 0$\n2.  **微生物质量平衡 ($S_m v_m = 0$)**:\n    *   $v_{m,1} - v_{m_2} = 0$\n    *   $v_{m,2} - v_{m,3} = 0$\n3.  **交换耦合**:\n    *   $v_e = v_{h,4} \\implies -v_{h,4} + v_e = 0$\n    *   $v_e = v_{m,1} \\implies -v_{m,1} + v_e = 0$\n4.  **通量边界**:\n    *   $0 \\le v_{h,1} \\le U_{\\text{in}}$\n    *   $0 \\le v_{h,2}, v_{h,3}, v_{h,4} \\le 10$\n    *   $0 \\le v_{m,1}, v_{m,2}, v_{m,3} \\le 10$\n    *   $0 \\le v_e \\le E_{\\max}$\n\n从这些约束中，我们可以推导出更简单的关系。微生物网络是一个线性链，所以 $v_e = v_{m,1} = v_{m,2} = v_{m,3}$。因此，微生物的生物量通量等于交换通量：$v_{m,3} = v_e$。\n对于宿主网络，$v_{h,1} = v_{h,2}$ 且 $v_{h,2} = v_{h,3} + v_{h,4}$。结合耦合约束 $v_e = v_{h,4}$，我们得到 $v_{h,1} = v_{h,3} + v_e$。因此，宿主的生物量通量为 $v_{h,3} = v_{h,1} - v_e$。\n\n将这些关系代入目标函数，我们得到一个只依赖于输入通量 $v_{h,1}$ 和交换通量 $v_e$ 的表达式：\n$$\nZ = w_h(v_{h,1} - v_e) + w_m v_e = w_h v_{h,1} + (w_m - w_h)v_e\n$$\n我们需要在边界 $0 \\le v_{h,1} \\le U_{\\text{in}}$ 和 $0 \\le v_e \\le \\min(E_{\\max}, v_{h,1})$ 的约束下最大化此函数。\n\n为了最大化 $Z$，我们应始终选择 $v_{h,1}$ 为其最大可能值，即 $v_{h,1} = U_{\\text{in}}$，因为权重 $w_h \\ge 0$。问题简化为通过选择 $v_e$ 来最大化 $Z = w_h U_{\\text{in}} + (w_m - w_h)v_e$，其中 $0 \\le v_e \\le \\min(E_{\\max}, U_{\\text{in}})$。\n\n-   若 $w_m > w_h$，$v_e$ 的系数为正。我们应最大化 $v_e$，因此 $v_e = \\min(E_{\\max}, U_{\\text{in}})$。\n-   若 $w_m  w_h$，$v_e$ 的系数为负。我们应最小化 $v_e$，因此 $v_e = 0$。\n-   若 $w_m = w_h$，$v_e$ 的系数为零。$v_e$ 的值不影响目标函数，目标值为 $Z = w_h U_{\\text{in}}$。\n\n现在我们逐一分析四个测试用例：\n\n**情况 1：** $w_h=0.5, w_m=0.5, U_{\\text{in}}=10, E_{\\max}=5$。\n$w_h = w_m$，因此目标值为 $Z = w_h U_{\\text{in}} = 0.5 \\times 10 = 5.0$。\n\n**情况 2：** $w_h=0.5, w_m=0.5, U_{\\text{in}}=10, E_{\\max}=0$。\n$w_h = w_m$，目标值同样为 $Z = w_h U_{\\text{in}} = 0.5 \\times 10 = 5.0$。\n\n**情况 3：** $w_h=0, w_m=1, U_{\\text{in}}=10, E_{\\max}=5$。\n$w_m > w_h$。我们最大化 $v_e$，因此 $v_e = \\min(E_{\\max}, U_{\\text{in}}) = \\min(5, 10) = 5$。\n目标值为 $Z = w_h U_{\\text{in}} + (w_m - w_h)v_e = 0 \\times 10 + (1 - 0) \\times 5 = 5.0$。\n\n**情况 4：** $w_h=0.2, w_m=0.8, U_{\\text{in}}=3, E_{\\max}=100$。\n$w_m > w_h$。我们最大化 $v_e$，因此 $v_e = \\min(E_{\\max}, U_{\\text{in}}) = \\min(100, 3) = 3$。\n目标值为 $Z = w_h U_{\\text{in}} + (w_m - w_h)v_e = 0.2 \\times 3 + (0.8 - 0.2) \\times 3 = 0.6 + 0.6 \\times 3 = 0.6 + 1.8 = 2.4$。\n\n将结果整理并按要求格式化为六位小数，我们得到四个情况的最优目标值。", "answer": "[5.000000,5.000000,5.000000,2.400000]", "id": "3319045"}, {"introduction": "除了生态和代谢层面的相互作用，宿主体内的微生物还会经历快速的进化。这个练习将探讨病毒在宿主体内形成的“准种”（quasispecies）及其突变-选择平衡。你将从第一性原理出发，推导决定病毒种群能否维持其高适应性主基因型的“错误阈值”（error threshold），从而深刻理解突变率、适应度和基因组长度之间的权衡关系[@problem_id:3319085]。", "problem": "在宿主内复制的病毒会形成一个“准种”，其中心是一个高适应性的“主”基因型，周围环绕着一团突变基因型。考虑一个单峰适应性景观，其中主基因型的复制适应性为 $W_0$，所有突变体（云）的适应性较低，为 $W_1$，且 $W_0  W_1$。设病毒基因组长度为 $L$ 个核苷酸，并假设每个位点的突变是独立的，每次复制的每位点突变概率为 $u$。将每位点保真度记为 $q = 1 - u$，因此主基因型在整个基因组上产生无错误拷贝的概率为 $q^L$。假设在长基因组极限下，从突变云到精确主基因型的反向突变可以忽略不计。\n\n使用复制子-突变子框架作为常微分方程（ODE）系统，从第一性原理推导主基因型在种群中持续存在的条件，并获得临界每位点突变概率 $u_c$（“错误阈值”）作为 $W_0$、$W_1$ 和 $L$ 函数的闭式表达式。然后，对参数值 $L = 10^4$，$W_0 = 1.3$ 和 $W_1 = 1.0$ 计算 $u_c$。\n\n将最终答案表示为每次复制的临界每位点突变概率（无量纲），并四舍五入到四位有效数字。", "solution": "这个问题是有效的。它在科学上基于已确立的准种和错误阈值理论，问题陈述清晰，提供了所有必要信息，并且表述客观。\n\n问题要求基于复制子-突变子模型，推导病毒准种的临界每位点突变概率 $u_c$。我们给定一个两类系统：一个复制适应性为 $W_0$ 的主基因型和一团适应性统一较低（为 $W_1$）的突变基因型。\n\n设 $x_0(t)$ 是时刻 $t$ 种群中主基因型的频率，$x_1(t)$ 是突变云的频率。根据定义，$x_0(t) + x_1(t) = 1$。基因组长度为 $L$，每位点突变概率为 $u$，每位点保真度为 $q = 1 - u$。主基因型无任何突变地进行复制的概率为 $Q = q^L = (1-u)^L$。假设任何带有一个或多个突变的复制都会产生一个突变云的成员。从突变云到主基因型的反向突变被认为可以忽略不计。\n\n主基因型个体数 $N_0$ 和突变云个体数 $N_1$ 的动态可以用以下常微分方程（ODE）描述：\n$$ \\frac{dN_0}{dt} = N_0 W_0 Q $$\n$$ \\frac{dN_1}{dt} = N_0 W_0 (1 - Q) + N_1 W_1 $$\n第一个方程表明主种群仅通过无错误复制来增长。第二个方程表明突变种群的增长来自两个来源：主基因型的错误复制和现有突变体的复制。\n\n总种群大小为 $N = N_0 + N_1$。总种群的变化率为：\n$$ \\frac{dN}{dt} = \\frac{dN_0}{dt} + \\frac{dN_1}{dt} = N_0 W_0 Q + N_0 W_0 (1 - Q) + N_1 W_1 = N_0 W_0 + N_1 W_1 $$\n种群的平均适应性 $\\bar{W}$ 由下式给出：\n$$ \\bar{W} = \\frac{1}{N} \\frac{dN}{dt} = \\frac{N_0 W_0 + N_1 W_1}{N_0 + N_1} = x_0 W_0 + x_1 W_1 = x_0 W_0 + (1-x_0)W_1 $$\n接下来，我们推导主基因型频率 $x_0 = N_0 / N$ 的常微分方程：\n$$ \\frac{dx_0}{dt} = \\frac{d}{dt}\\left(\\frac{N_0}{N}\\right) = \\frac{1}{N}\\frac{dN_0}{dt} - \\frac{N_0}{N^2}\\frac{dN}{dt} $$\n代入 $\\frac{dN_0}{dt}$ 和 $\\frac{dN}{dt}$ 的表达式：\n$$ \\frac{dx_0}{dt} = \\frac{N_0 W_0 Q}{N} - \\frac{N_0}{N} \\left(\\frac{N_0 W_0 + N_1 W_1}{N}\\right) $$\n$$ \\frac{dx_0}{dt} = x_0 W_0 Q - x_0 \\bar{W} $$\n$$ \\frac{dx_0}{dt} = x_0 (W_0 Q - \\bar{W}) $$\n代入 $\\bar{W}$ 的表达式：\n$$ \\frac{dx_0}{dt} = x_0 (W_0 Q - (x_0 W_0 + (1-x_0)W_1)) $$\n如果存在一个稳定的稳态解，使得其频率 $x_0^*  0$，则主基因型在种群中持续存在。在稳态时，$\\frac{dx_0}{dt} = 0$。\n$$ x_0^* (W_0 Q - (x_0^* W_0 + (1-x_0^*)W_1)) = 0 $$\n这个方程对于 $x_0^*$ 有两个可能的解：\n1. $x_0^* = 0$：这对应于主基因型的灭绝。\n2. $W_0 Q - (x_0^* W_0 + (1-x_0^*)W_1) = 0$：这对应于一个非平凡稳态。\n\n为了使主基因型持续存在，第二个解必须具有物理意义，即 $0  x_0^* \\le 1$。让我们求解 $x_0^*$：\n$$ W_0 Q - W_1 = x_0^* (W_0 - W_1) $$\n$$ x_0^* = \\frac{W_0 Q - W_1}{W_0 - W_1} $$\n因为给定 $W_0  W_1$，分母为正。因此，为了使 $x_0^*$ 为正，分子也必须为正：\n$$ W_0 Q - W_1  0 \\implies W_0 Q  W_1 $$\n这是主基因型持续存在的条件。这意味着主基因型的有效适应性（即其固有适应性 $W_0$ 乘以忠实复制的概率 $Q$）必须大于突变云的适应性 $W_1$。\n\n错误阈值由临界突变概率 $u_c$ 定义，在该概率下，上述不等式变为等式。设 $q_c = 1 - u_c$ 为临界保真度。条件是：\n$$ W_0 q_c^L = W_1 $$\n问题指定了长基因组极限，其中 $L \\gg 1$。在此极限下，对于小的突变率 $u_c \\ll 1$，我们可以使用近似 $(1-u_c)^L \\approx \\exp(-u_c L)$。将此近似应用于临界条件：\n$$ W_0 \\exp(-u_c L) = W_1 $$\n我们现在求解临界每位点突变概率 $u_c$：\n$$ \\exp(-u_c L) = \\frac{W_1}{W_0} $$\n对两边取自然对数：\n$$ -u_c L = \\ln\\left(\\frac{W_1}{W_0}\\right) = -\\ln\\left(\\frac{W_0}{W_1}\\right) $$\n$$ u_c = \\frac{1}{L} \\ln\\left(\\frac{W_0}{W_1}\\right) $$\n这是错误阈值处临界每位点突变概率的闭式表达式。\n\n现在，我们使用给定的参数计算 $u_c$：$L = 10^4$，$W_0 = 1.3$ 和 $W_1 = 1.0$。\n$$ u_c = \\frac{1}{10^4} \\ln\\left(\\frac{1.3}{1.0}\\right) $$\n$$ u_c = \\frac{\\ln(1.3)}{10000} $$\n使用计算器，$\\ln(1.3) \\approx 0.262364264$。\n$$ u_c \\approx \\frac{0.262364264}{10000} = 0.0000262364264 $$\n这可以写成科学记数法 $2.62364264 \\times 10^{-5}$。\n问题要求答案四舍五入到四位有效数字。\n$$ u_c \\approx 2.624 \\times 10^{-5} $$", "answer": "$$\\boxed{2.624 \\times 10^{-5}}$$", "id": "3319085"}]}