{"hands_on_practices": [{"introduction": "群落通量平衡分析（cFBA）的核心在于如何在一个共享环境中分配有限资源。本练习将引导您解决一个经典的资源分配问题，即如何在一个由两个物种组成的群落中分配有限的葡萄糖，以最大化加权的群落总体生长目标。通过这个计算，您将亲身体会到不同物种的生长效率和目标权重如何决定最优的资源分配策略，这是理解 cFBA 优化原理的基础。[@problem_id:3296431]", "problem": "考虑一个由两个成员组成的微生物群落，使用群落通量平衡分析（cFBA）进行建模。该模型在稳态和容量约束下，将特定生物体的目标函数聚合成一个单一的群落级目标。设生物体 $i \\in \\{1,2\\}$ 的葡萄糖摄取通量为 $v^{(i)}_{\\text{glc}}$，其上限受转运蛋白容量的限制，并以恒定的产率与生物量形成成比例。假设以下基本依据：(i) 稳态通量平衡分析（FBA）强制执行胞内质量平衡，群落交换限制作为交换通量的容量约束；(ii) 在底物限制（单一限制性碳源为葡萄糖）的情况下，生物体 $i$ 的生物量生产速率与其葡萄糖摄取成正比，比例由恒定产率 $Y_i$ （每单位葡萄糖产生的生物量）给出；(iii) cFBA 将群落目标定义为成员特定生长速率的凸组合，其非负权重 $w_i$ 之和为 $1$。群落被供应葡萄糖，使得总的群落摄取受到一个共享上限的限制，同时每个生物体也有其自身的摄取容量限制。给定权重 $w_1=0.7$ 和 $w_2=0.3$，生物体特定的葡萄糖摄取上限 $v^{(1)}_{\\text{glc}} \\leq 5$ 和 $v^{(2)}_{\\text{glc}} \\leq 5$，产率 $Y_1=0.6$ 和 $Y_2=0.3$，以及一个共享的群落葡萄糖约束 $v^{(1)}_{\\text{glc}} + v^{(2)}_{\\text{glc}} \\leq 6$，确定在这些约束下使群落目标最大化的葡萄糖摄取通量分配 $\\left(v^{(1)}_{\\text{glc}}, v^{(2)}_{\\text{glc}}\\right)$。以毫摩尔/克干重/小时为单位表示摄取通量，并使用 $\\texttt{pmatrix}$ 环境将您的最终分配表示为一个行矩阵。无需四舍五入。", "solution": "### 第1步：提取已知条件\n- **群落：** 双成员微生物群落，生物体 $i \\in \\{1,2\\}$。\n- **模型：** 稳态下的群落通量平衡分析（cFBA）。\n- **变量：** 葡萄糖摄取通量 $v^{(1)}_{\\text{glc}}$ 和 $v^{(2)}_{\\text{glc}}$。\n- **生长速率模型：** 生物体 $i$ 的生物量生产速率（生长速率），记为 $\\mu_i$，与其葡萄糖摄取成正比：$\\mu_i = Y_i v^{(i)}_{\\text{glc}}$。\n- **产率：** $Y_1=0.6$， $Y_2=0.3$。\n- **群落目标：** 最大化成员生长速率的凸组合，$Z = w_1 \\mu_1 + w_2 \\mu_2$。\n- **权重：** $w_1=0.7$， $w_2=0.3$。\n- **约束条件：**\n    1. 生物体特定的摄取容量：$v^{(1)}_{\\text{glc}} \\leq 5$。\n    2. 生物体特定的摄取容量：$v^{(2)}_{\\text{glc}} \\leq 5$。\n    3. 共享的群落摄取上限：$v^{(1)}_{\\text{glc}} + v^{(2)}_{\\text{glc}} \\leq 6$。\n    4. 通量的非负性（隐含）：$v^{(1)}_{\\text{glc}} \\geq 0$， $v^{(2)}_{\\text{glc}} \\geq 0$。\n\n### 第2步：验证问题的有效性\n1.  **科学依据**：该问题基于通量平衡分析（FBA）及其群落扩展（cFBA）的既定原则，这些是计算系统生物学中的标准工具。诸如恒定生物量产率和稳态质量平衡等假设在此建模框架中很常见。\n2.  **适定性**：该问题是一个线性规划问题。目标函数是线性的，约束条件在平面上定义了一个非空、闭合且有界（紧致）的可行域。根据线性规划的极值定理，最大值存在且出现在可行域的一个或多个顶点上。\n3.  **客观性**：问题陈述以精确、定量和客观的语言表述，没有歧义或主观论断。\n4.  **完整与一致性**：提供了所有必需的参数（产率、权重、约束边界）。约束条件是一致的，互不矛盾。\n\n### 第3步：求解问题\n该问题是有效的，它是一个定义明确的、基于计算系统生物学原理的线性优化问题。现在开始求解。\n\n群落通量平衡分析（cFBA）的目标是最大化群落的总体生长目标，该目标是单个生物体生长速率的加权和。设葡萄糖摄取通量的变量为 $x = v^{(1)}_{\\text{glc}}$ 和 $y = v^{(2)}_{\\text{glc}}$。单位是毫摩尔/克干重/小时。\n\n生物体 $i$ 的生长速率 $\\mu_i$ 由其葡萄糖摄取通量与其在葡萄糖上的生物量产率 $Y_i$ 的乘积给出。\n对于生物体1：$\\mu_1 = Y_1 x = 0.6x$。\n对于生物体2：$\\mu_2 = Y_2 y = 0.3y$。\n\n群落目标函数 $Z$ 是这些单个生长速率的凸组合，权重为 $w_1=0.7$ 和 $w_2=0.3$。\n$$Z(x, y) = w_1 \\mu_1 + w_2 \\mu_2 = (0.7)(0.6)x + (0.3)(0.3)y$$\n$$Z(x, y) = 0.42x + 0.09y$$\n\n问题是在一组线性约束条件下最大化这个线性目标函数。这些约束条件定义了葡萄糖摄取分配 $(x, y)$ 的可行域。\n\n约束条件如下：\n1.  生物体1的个体摄取上限：$x \\leq 5$\n2.  生物体2的个体摄取上限：$y \\leq 5$\n3.  共享的群落摄取上限：$x + y \\leq 6$\n4.  通量必须为非负：$x \\geq 0$, $y \\geq 0$\n\n这构成了一个线性规划问题。最优解必须位于由这些不等式相交定义的可行域的某个顶点上。我们可以通过找到约束边界线的交点来找到这些顶点。\n\n边界线是 $x=0$，$y=0$，$x=5$，$y=5$ 和 $x+y=6$。可行域是由这些线形成的多边形。让我们确定这个多边形的顶点：\n\n1.  $x=0$ 和 $y=0$ 的交点：$(0, 0)$。该点满足所有约束条件。\n2.  $y=0$ 和 $x=5$ 的交点：$(5, 0)$。该点满足所有约束条件（$5+0=5 \\leq 6$）。\n3.  $x=0$ 和 $y=5$ 的交点：$(0, 5)$。该点满足所有约束条件（$0+5=5 \\leq 6$）。\n4.  $x=5$ 和 $x+y=6$ 的交点：这得出 $5+y=6 \\implies y=1$。顶点是 $(5, 1)$。该点满足所有约束条件（$x=5 \\leq 5$，$y=1 \\leq 5$）。\n5.  $y=5$ 和 $x+y=6$ 的交点：这得出 $x+5=6 \\implies x=1$。顶点是 $(1, 5)$。该点满足所有约束条件（$x=1 \\leq 5$，$y=5 \\leq 5$）。\n\n可行域的顶点集合是 $\\{(0, 0), (5, 0), (0, 5), (5, 1), (1, 5)\\}$。\n\n为了找到目标函数 $Z(x, y) = 0.42x + 0.09y$ 的最大值，我们在每个顶点上对其进行求值：\n\n- 在 $(0, 0)$ 处：$Z(0, 0) = 0.42(0) + 0.09(0) = 0$\n- 在 $(5, 0)$ 处：$Z(5, 0) = 0.42(5) + 0.09(0) = 2.1$\n- 在 $(0, 5)$ 处：$Z(0, 5) = 0.42(0) + 0.09(5) = 0.45$\n- 在 $(5, 1)$ 处：$Z(5, 1) = 0.42(5) + 0.09(1) = 2.1 + 0.09 = 2.19$\n- 在 $(1, 5)$ 处：$Z(1, 5) = 0.42(1) + 0.09(5) = 0.42 + 0.45 = 0.87$\n\n比较目标函数在各个顶点处的值，最大值为 $2.19$，出现在点 $(x, y) = (5, 1)$ 处。\n\n因此，使群落目标最大化的葡萄糖摄取通量分配为 $v^{(1)}_{\\text{glc}} = 5$ 和 $v^{(2)}_{\\text{glc}} = 1$。总群落摄取量为 $5+1=6$，这使得共享群落约束达到饱和。生物体1也以其最大个体容量 $v^{(1)}_{\\text{glc}}=5$ 运行。生物体2使用共享约束下剩余的可用资源。这种分配是更有利的，因为生物体1对群落目标的贡献“效率”（$w_1 Y_1 = 0.42$）显著高于生物体2（$w_2 Y_2 = 0.09$）。\n\n最终分配需要以行矩阵的形式表示。", "answer": "$$ \\boxed{ \\begin{pmatrix} 5 & 1 \\end{pmatrix} } $$", "id": "3296431"}, {"introduction": "微生物群落的复杂性常常源于成员之间的代谢物交换，即交叉哺育。本练习模拟了一个简单的共养关系：一个物种产生乳酸，另一个物种消耗乳酸进行生长。您的任务是计算这种交叉哺育关系所能支持的最大群落生物量，并在此过程中学会识别系统的瓶颈——是生产者的供应能力不足，还是消费者的摄取能力有限。[@problem_id:3296376]", "problem": "考虑一个使用群落流平衡分析 (community FBA) 建模的双物种微生物群落。群落FBA (cFBA) 是流平衡分析 (FBA) 的扩展，它在化学计量矩阵给出的稳态质量平衡约束下，优化代谢流的线性组合。其中，细胞内代谢物的稳态由 $S v = 0$ 捕获。物种 $1$ 消耗葡萄糖并排泄乳酸；物种 $2$ 消耗乳酸以产生生物质。假设一种单一的交叉哺育代谢物（乳酸）介导了相互作用，并且在整个群落范围内保持稳态，因此物种 $1$ 的乳酸排泄和物种 $2$ 的乳酸摄取之间的净交换是守恒的。令 $v^{(1)}_{\\text{glc}}$ 表示物种 $1$ 的葡萄糖摄取流，令 $v^{(2)}_{\\text{lac,upt}}$ 表示物种 $2$ 的乳酸摄取流。物种 $1$ 以葡萄糖为底物的乳酸产率为 $Y_{\\text{lac}}=0.8$ 摩尔乳酸/摩尔葡萄糖，物种 $2$ 以乳酸为底物的生物质产率为 $Y_{2}=0.5$ 生物质单位/摩尔乳酸。以下界限成立：$v^{(1)}_{\\text{glc}} \\leq 6$ 且 $v^{(2)}_{\\text{lac,upt}} \\leq 4$。假设所有摄取和排泄流均为非负值，并且物种 $1$ 分配其葡萄糖摄取以在其产率和界限的约束下最大化乳酸排泄。将可归因于交叉哺育的群落生物量定义为物种 $2$ 由乳酸生成的生物质生成速率，并为此计算忽略物종 $1$ 的任何生物质生成。在这些假设以及从稳态质量平衡和线性流界限出发的cFBA框架下，计算可归因于交叉哺育的最大可实现群落生物量。用生物质单位每小时表示您的答案。提供精确值，不要四舍五入。最终的方框答案中不要包含单位。", "solution": "### 步骤 1：提取已知条件\n- **模型：** 一个双物种微生物群落。\n- **框架：** 稳态下的群落流平衡分析 (cFBA)。\n- **物种 1：** 消耗葡萄糖，排泄乳酸。\n- **物种 2：** 消耗乳酸，产生生物质。\n- **相互作用：** 由单一交叉哺育代谢物（乳酸）介导。\n- **群落约束：** 乳酸的净交换是守恒的，意味着物种 $1$ 的排泄速率等于物种 $2$ 的摄取速率。\n- **变量和参数：**\n  - $v^{(1)}_{\\text{glc}}$：物种 $1$ 的葡萄糖摄取流。\n  - $v^{(2)}_{\\text{lac,upt}}$：物种 $2$ 的乳酸摄取流。\n  - $Y_{\\text{lac}} = 0.8$：物种 $1$ 以葡萄糖为底物的乳酸产率（摩尔乳酸 / 摩尔葡萄糖）。\n  - $Y_{2} = 0.5$：物种 $2$ 以乳酸为底物的生物质产率（生物质单位 / 摩尔乳酸）。\n- **界限：**\n  - $v^{(1)}_{\\text{glc}} \\leq 6$。\n  - $v^{(2)}_{\\text{lac,upt}} \\leq 4$。\n- **假设：**\n  - 所有摄取和排泄流均为非负。\n  - 物种 $1$ 最大化乳酸排泄。\n  - 可归因于交叉哺育的群落生物量被定义为物种 $2$ 的生物质生成速率。\n  - 忽略物种 $1$ 的生物质生成。\n- **目标：** 计算可归因于交叉哺育的最大可实现群落生物量。\n\n### 步骤 2：验证问题的有效性\n该问题具有科学依据，因为它基于已建立的流平衡分析框架及其群落级扩展 cFBA。化学计量矩阵、通量向量、稳态、产率系数和摄取约束等概念是该领域的基础。该问题是适定的，提供了所有必要的数据（产率、界限）和一个明确的目标函数（最大化物种 $2$ 的生物量）。语言精确客观。没有矛盾、歧义或违反科学或数学原理的地方。该问题是基于约束的建模在微生物群落中的一个标准（尽管简化了）的应用。\n\n### 步骤 3：求解问题\n该问题是有效的。现在进行详细求解。\n\n目标是计算可归因于交叉哺育的最大群落生物量。根据问题的定义，这等同于物种2的最大生物质生成速率，我们将其表示为 $v^{(2)}_{\\text{biomass}}$。计算过程分为三步：首先，确定物种1能产生的交叉哺育代谢物的最大量；其次，确定在所有约束下，物种2能消耗该代谢物的最大量；最后，计算物种2的最终生物量。\n\n首先，我们分析物种 $1$。物种 $1$ 的乳酸排泄通量（表示为 $v^{(1)}_{\\text{lac,ex}}$）通过给定的产率系数 $Y_{\\text{lac}}$ 与其葡萄糖摄取通量 $v^{(1)}_{\\text{glc}}$ 相耦合。关系如下：\n$$v^{(1)}_{\\text{lac,ex}} = Y_{\\text{lac}} \\cdot v^{(1)}_{\\text{glc}}$$\n问题指出，物种 $1$ 分配其葡萄糖摄取以最大化乳酸排泄。这意味着物种 $1$ 将会将其葡萄糖摄取通量 $v^{(1)}_{\\text{glc}}$ 最大化，直至达到其指定的上界。葡萄糖摄取的界限给出如下：\n$$v^{(1)}_{\\text{glc}} \\leq 6$$\n为了最大化 $v^{(1)}_{\\text{lac,ex}}$，物种 $1$ 将以其最大能力运行，因此 $v^{(1)}_{\\text{glc}} = 6$。我们现在可以计算出物种 $1$ 的最大乳酸排泄速率：\n$$v^{(1)}_{\\text{lac,ex,max}} = Y_{\\text{lac}} \\cdot v^{(1)}_{\\text{glc,max}} = 0.8 \\cdot 6 = 4.8$$\n\n其次，我们考虑两个物种之间的相互作用。问题指定了交叉哺育代谢物（乳酸）在整个群落范围内的稳态。这施加了一个守恒约束：物种 $1$ 的乳酸排泄速率必须等于物种 $2$ 的乳酸摄取速率 $v^{(2)}_{\\text{lac,upt}}$。\n$$v^{(1)}_{\\text{lac,ex}} = v^{(2)}_{\\text{lac,upt}}$$\n这意味着物种 $2$ 的乳酸供应量由物种 $1$ 的产量决定。因此，物种 $2$ 可能的最大乳酸摄取量受限于物种 $1$ 的最大乳酸排泄量。\n$$v^{(2)}_{\\text{lac,upt}} \\leq v^{(1)}_{\\text{lac,ex,max}} = 4.8$$\n\n第三，我们分析物种 $2$。目标是找到最大生物质生成速率 $v^{(2)}_{\\text{biomass}}$。该速率通过生物质产率 $Y_2$ 与乳酸摄取通量 $v^{(2)}_{\\text{lac,upt}}$ 相关：\n$$v^{(2)}_{\\text{biomass}} = Y_{2} \\cdot v^{(2)}_{\\text{lac,upt}}$$\n为了最大化 $v^{(2)}_{\\text{biomass}}$，我们必须最大化乳酸摄取通量 $v^{(2)}_{\\text{lac,upt}}$。该通量受两个约束条件限制：\n1. 物种 $2$ 的内在代谢能力，由界限给出：$v^{(2)}_{\\text{lac,upt}} \\leq 4$。\n2. 由物种 $1$ 供应的乳酸可用性：$v^{(2)}_{\\text{lac,upt}} \\leq 4.8$。\n\n物种 $2$ 的有效最大乳酸摄取速率是这些约束中最严格的一个，即两个上界中的最小值：\n$$v^{(2)}_{\\text{lac,upt,max}} = \\min(4, 4.8) = 4$$\n这表明物种 $2$ 的生长受其自身摄取能力的限制，而非受物种 $1$ 供应的乳酸可用性的限制。\n\n最后，我们可以使用物种 $2$ 的最大有效乳酸摄取速率，计算可归因于交叉哺育的最大可实现群落生物量，即物种 $2$ 的最大生物量：\n$$v^{(2)}_{\\text{biomass,max}} = Y_{2} \\cdot v^{(2)}_{\\text{lac,upt,max}} = 0.5 \\cdot 4 = 2$$\n通量值通常假定单位为 mmol gDW⁻¹ h⁻¹，生物质单位的构建与其保持一致。问题要求以“生物质单位每小时”作答，这与此公式一致。", "answer": "$$\\boxed{2}$$", "id": "3296376"}, {"introduction": "在许多生物系统中，一个最优的宏观目标（如总生物量）可以由多种不同的内部代谢状态（通量分布）实现。群落通量变异性分析（cFVA）是一种强大的计算工具，用于探索在维持最优群落目标的前提下，每个代谢反应通量的可行范围。本练习要求您编写代码来实现 cFVA，通过求解一系列线性规划问题来确定关键的交叉哺育通量的变化区间，从而更全面地理解群落的代谢灵活性。[@problem_id:3296435]", "problem": "考虑一个使用通量平衡分析 (FBA) 和群落通量变异性分析 (cFVA) 建模的双物种微生物群落。其基础包括以下原则：(i) 由化学计量矩阵和约束条件 $\\mathbf{S}\\mathbf{v}=\\mathbf{0}$ 编码的稳态质量平衡，(ii) 形式为 $L_j \\le v_j \\le U_j$ 的线性反应界限，以及 (iii) 等于一个指定最优值的线性群落目标。胞外代谢物的交叉哺育表现为两个物种之间的稳态交换。目标是计算乳酸交换通量的 cFVA 区间。\n\n使用以下反应通量变量对群落进行建模（所有变量的界限为 $0 \\le v_j \\le 10$，单位任意但在各反应中保持一致）：\n- $v_2$：物种 A 的乳酸生成，\n- $v_3$：物种 A 向胞外空间输出乳酸（这是我们关注的交叉哺育通量），\n- $v_5$：物种 B 从胞外空间输入乳酸，\n- $v_6$：物种 B 的乳酸消耗，\n- $v_{wA}$：物种 A 的乳酸废物（内部汇），\n- $v_{wB}$：物种 B 的乳酸废物（内部汇）。\n\n施加以下稳态化学计量约束，将 $v_3$ 与乳酸的生成和消耗联系起来：\n- 物种 A 胞内乳酸平衡：$v_2 - v_3 - v_{wA} = 0$，\n- 物种 B 胞内乳酸平衡：$v_5 - v_6 - v_{wB} = 0$，\n- 胞外乳酸平衡：$v_3 - v_5 = 0$。\n\n设群落目标为物种生物量之和，其中物种 A 的生物量与乳酸生成成正比，产率为 $y_A$；物种 B 的生物量与乳酸消耗成正比，产率为 $y_B$。强制执行群落目标等式约束\n$$y_A v_2 + y_B v_6 = z^*,$$\n其中 $z^*$ 是给定的最优群落目标值。这定义了 cFVA 的可行多胞体。\n\n对乳酸交换反应 $v_{\\text{lac exchange}} \\equiv v_3$ 进行群落通量变异性分析 (cFVA)，需要在可行域上求解两个线性规划问题：\n- 在所有约束条件下最小化 $v_3$，\n- 在所有约束条件下最大化 $v_3$。\n\n您的任务是编写一个完整的、可运行的程序，针对下面的每个测试用例，构建与约束条件相对应的线性规划问题，并求解它们以返回 cFVA 区间 $[\\min v_3, \\max v_3]$。所有反应界限均为 $L_j = 0$ 和 $U_j = 10$。程序必须将每个区间端点表示为四舍五入到六位小数。\n\n测试套件（每个用例为 $(y_A, y_B, z^*)$）：\n1. $(1, 1, 6)$,\n2. $(0.5, 1.5, 6)$,\n3. $(1.2, 0.8, 6)$,\n4. $(1, 1, 0)$,\n5. $(1, 1, 20)$.\n\n最终输出格式：您的程序应生成单行输出，其中包含一个用方括号括起来的、以逗号分隔的列表。列表中的每个元素是对应测试用例的区间（一个包含两个元素的列表），并按给定顺序排列（例如，$\"[[a_1,b_1],[a_2,b_2],...]\"$）。所有数字必须四舍五入到六位小数，并以小数形式表示（不使用百分比，不带单位）。", "solution": "### 步骤 1：提取已知条件\n- **变量**：反应通量 $v_2$（物种 A 的乳酸生成）、$v_3$（物种 A 的乳酸输出）、$v_5$（物种 B 的乳酸输入）、$v_6$（物种 B 的乳酸消耗）、$v_{wA}$（物种 A 的乳酸废物）、$v_{wB}$（物种 B 的乳酸废物）。\n- **界限**：所有通量 $v_j$ 的界限为 $0 \\le v_j \\le 10$。\n- **化学计量约束**：\n    1. 物种 A 胞内乳酸平衡：$v_2 - v_3 - v_{wA} = 0$。\n    2. 物种 B 胞内乳酸平衡：$v_5 - v_6 - v_{wB} = 0$。\n    3. 胞外乳酸平衡：$v_3 - v_5 = 0$。\n- **群落目标约束**：$y_A v_2 + y_B v_6 = z^*$，其中 $y_A$ 是物种 A 的生物量产率，$y_B$ 是物种 B 的生物量产率，$z^*$ 是一个固定的最优群落目标值。\n- **cFVA 任务**：在所有给定约束条件下，计算区间 $[\\min v_3, \\max v_3]$。\n- **测试用例** $(y_A, y_B, z^*)$：1. $(1, 1, 6)$，2. $(0.5, 1.5, 6)$，3. $(1.2, 0.8, 6)$，4. $(1, 1, 0)$，5. $(1, 1, 20)$。\n\n### 步骤 2：验证问题的有效性\n该问题具有科学依据，采用了通量平衡分析 (FBA) 的标准原则，即稳态下的质量平衡约束 ($\\mathbf{S}\\mathbf{v}=\\mathbf{0}$) 和线性优化。其公式是客观和定量的。通过最小化和最大化一个在由线性约束定义的可行域上的通量来进行通量变异性分析的任务，是线性规划 (LP) 的一个适定应用。所提供的约束和数据是自洽且一致的，并且如下面的解法所示，它们为所有测试用例定义了非空可行域。因此，该问题被认为是**有效的**。\n\n### 步骤 3：求解\n\n问题是在由一组线性等式和不等式约束定义的多胞体内，确定乳酸交换通量 $v_3$ 的可行范围。这可以通过求解两个独立的线性规划 (LP) 问题来实现：一个最小化 $v_3$，另一个最大化 $v_3$。\n\n首先，我们简化约束系统。完整的变量集合是 $\\mathbf{v} = [v_2, v_3, v_5, v_6, v_{wA}, v_{wB}]^T$。等式约束可用于减少独立变量的数量。\n\n从胞外乳酸平衡 $v_3 - v_5 = 0$ 可以清楚地看出 $v_5 = v_3$。我们可以在其他方程中用 $v_3$ 替换 $v_5$。\n\n胞内平衡方程可以重写，以其他通量表示废物通量：\n1. $v_{wA} = v_2 - v_3$\n2. $v_{wB} = v_5 - v_6 = v_3 - v_6$\n\n因此可以消去变量 $v_5$、$v_{wA}$ 和 $v_{wB}$，将问题简化为只包含三个核心变量 $v_2$、$v_3$ 和 $v_6$ 的系统。\n\n被消去变量的界限为剩余变量引入了新的约束。问题陈述所有通量 $v_j$ 的界限为 $0 \\le v_j \\le 10$。将这些界限应用于废物通量：\n- 对于 $v_{wA}$：\n  - $v_{wA} \\ge 0 \\implies v_2 - v_3 \\ge 0 \\implies v_3 \\le v_2$。\n  - $v_{wA} \\le 10 \\implies v_2 - v_3 \\le 10$。这个约束是多余的，因为单个变量的界限 $v_2 \\le 10$ 和 $v_3 \\ge 0$ 已经保证了 $v_2 - v_3 \\le 10 - 0 = 10$。\n- 对于 $v_{wB}$：\n  - $v_{wB} \\ge 0 \\implies v_3 - v_6 \\ge 0 \\implies v_6 \\le v_3$。\n  - $v_{wB} \\le 10 \\implies v_3 - v_6 \\le 10$。这个约束也是多余的，因为 $v_3 \\le 10$ 和 $v_6 \\ge 0$ 保证了 $v_3 - v_6 \\le 10$。\n\n现在，简化后的问题可以表述为在变量向量 $\\mathbf{x} = [v_2, v_3, v_6]^T$ 上求解 $v_3$ 的范围，并满足以下条件：\n\n1.  **等式约束**：必须满足群落目标函数：\n    $$y_A v_2 + y_B v_6 = z^*$$\n2.  **不等式约束**：\n    - $v_3 \\le v_2 \\implies -v_2 + v_3 \\le 0$\n    - $v_6 \\le v_3 \\implies v_6 - v_3 \\le 0$\n3.  **界限**：\n    - $0 \\le v_2 \\le 10$\n    - $0 \\le v_3 \\le 10$\n    - $0 \\le v_6 \\le 10$\n\n这构成了一个标准的 LP 问题。对于一个通用的 LP 求解器，我们可以将约束表示为矩阵形式：\n- 最小化：$\\mathbf{c}^T \\mathbf{x}$\n- 约束条件：$\\mathbf{A_{eq}}\\mathbf{x} = \\mathbf{b_{eq}}$ 和 $\\mathbf{A_{ub}}\\mathbf{x} \\le \\mathbf{b_{ub}}$\n\n对于我们的变量向量 $\\mathbf{x} = [v_2, v_3, v_6]^T$：\n- 等式约束给出：\n  $\\mathbf{A_{eq}} = [[y_A, 0, y_B]]$ 和 $\\mathbf{b_{eq}} = [z^*]$。\n- 不等式约束给出：\n  $\\mathbf{A_{ub}} = \\begin{pmatrix} -1 & 1 & 0 \\\\ 0 & -1 & 1 \\end{pmatrix}$ 和 $\\mathbf{b_{ub}} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}$。\n- $\\mathbf{x}$ 中每个变量的界限是 $[0, 10]$。\n\n为了找到 $v_3$ 的 cFVA 区间，我们求解两个 LP 问题：\n\n1.  **最小化 $v_3$**：目标函数向量是 $\\mathbf{c}_{min} = [0, 1, 0]^T$。求解该 LP 问题得到 $v_3$ 的最小值。\n2.  **最大化 $v_3$**：这等同于最小化 $-v_3$。目标函数向量是 $\\mathbf{c}_{max} = [0, -1, 0]^T$。LP 求解器得到的最小值取反后，即为 $v_3$ 的最大值。\n\n对于每个测试用例 $(y_A, y_B, z^*)$，我们构建这些矩阵和向量，并使用数值 LP 求解器找到最优值，这些最优值构成了所需的 cFVA 区间 $[\\min v_3, \\max v_3]$ 的端点。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import linprog\n\ndef solve():\n    \"\"\"\n    Computes the community Flux Variability Analysis (cFVA) interval for the lactate \n    exchange flux v3 in a simplified two-species microbial model.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (y_A, y_B, z*)\n    test_cases = [\n        (1.0, 1.0, 6.0),\n        (0.5, 1.5, 6.0),\n        (1.2, 0.8, 6.0),\n        (1.0, 1.0, 0.0),\n        (1.0, 1.0, 20.0),\n    ]\n\n    # This cFVA problem is formulated as a Linear Program (LP).\n    # The variables are x = [v2, v3, v6].\n    # v2: species A lactate production\n    # v3: lactate exchange flux (export from A, import to B)\n    # v6: species B lactate consumption\n    \n    # The problem is reduced from 6 variables to 3, with constraints derived\n    # from the original formulation. The new constraints are:\n    # 1. Equality: y_A*v2 + y_B*v6 = z*\n    # 2. Inequalities: v3 = v2 and v6 = v3\n    # 3. Bounds: 0 = v_i = 10 for i in {2, 3, 6}\n\n    # The inequality constraints in standard form (A_ub * x = b_ub):\n    # -v2 + v3 = 0\n    # -v3 + v6 = 0\n    A_ub = np.array([\n        [-1, 1, 0],\n        [0, -1, 1]\n    ])\n    b_ub = np.array([0, 0])\n\n    # Universal bounds for all variables in the reduced system\n    bounds = (0, 10)\n    var_bounds = [bounds, bounds, bounds]\n\n    # Objective vectors 'c' for minimizing/maximizing v3\n    # To minimize v3, c = [0, 1, 0]\n    c_min = np.array([0, 1, 0])\n    # To maximize v3, we minimize -v3, so c = [0, -1, 0]\n    c_max = np.array([0, -1, 0])\n\n    final_results = []\n\n    for y_A, y_B, z_star in test_cases:\n        # Set up the equality constraint matrix and vector for the current case\n        # y_A*v2 + 0*v3 + y_B*v6 = z_star\n        A_eq = np.array([[y_A, 0, y_B]])\n        b_eq = np.array([z_star])\n\n        # --- Solve for the minimum of v3 ---\n        res_min = linprog(c=c_min, A_ub=A_ub, b_ub=b_ub, A_eq=A_eq, b_eq=b_eq, bounds=var_bounds, method='highs')\n\n        # --- Solve for the maximum of v3 ---\n        res_max = linprog(c=c_max, A_ub=A_ub, b_ub=b_ub, A_eq=A_eq, b_eq=b_eq, bounds=var_bounds, method='highs')\n\n        min_v3 = 0.0\n        max_v3 = 0.0\n        \n        if res_min.success and res_max.success:\n            # The minimum value is the objective function value from the LP\n            min_v3 = res_min.fun\n            # The maximum value is the negative of the minimized objective function value\n            max_v3 = -res_max.fun\n        else:\n            # This branch is for infeasible cases.\n            # For z*=20 (case 5), the max possible z is y_A*10 + y_B*10 = 20.\n            # Any solution must have v2=10, v6=10, which forces v3=10.\n            # For z*>20, it would be infeasible.\n            # The linprog result might indicate this. A simple check:\n            # max possible z is y_A*10 + y_B*10. If z_star > this, it's infeasible.\n            # In our case 5, z_star=20 is on the boundary, so it's feasible.\n            # If for some reason the solver fails, we can handle it.\n            min_v3 = float('nan')\n            max_v3 = float('nan')\n\n        final_results.append([min_v3, max_v3])\n\n    # Format the output string exactly as specified in the problem statement.\n    # e.g., \"[[a_1,b_1],[a_2,b_2],...]\"\n    # All numbers must be rounded to six decimal places.\n    output_parts = []\n    for interval in final_results:\n        part = f\"[{interval[0]:.6f},{interval[1]:.6f}]\"\n        output_parts.append(part)\n    \n    final_output_string = f\"[{','.join(output_parts)}]\"\n    \n    print(final_output_string)\n\nsolve()\n```", "id": "3296435"}]}