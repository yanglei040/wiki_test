{"hands_on_practices": [{"introduction": "理解配体浓度如何转化为受体二聚化是量化信号通路的第一步。这个练习旨在通过一个简化的平衡模型，帮助你建立对输入（配体）与初始输出（二聚体形成）之间非线性关系的基本理解。通过将基本的化学平衡原理应用于细胞信号传导，你将能够计算出在给定配体浓度下，处于激活状态的受体比例，并分析信号响应在特定条件下的剂量依赖性。[@problem_id:3344214]", "problem": "一种单一类型的受体酪氨酸激酶 (RTK) 会发生配体诱导的二聚化。考虑一个最简平衡方案，其中未结合配体的受体单体 $R$ 与配体 $L$ 结合形成结合配体的单体 $RL$，然后二聚化形成 $(RL)_{2}$：\n$$R + L \\rightleftharpoons RL,\\qquad RL + RL \\rightleftharpoons (RL)_{2}.$$\n假设系统处于由质量作用定律支配的准平衡状态，其配体结合的解离常数定义为 $K_{d1} = \\frac{[R][L]}{[RL]}$，二聚化的解离常数定义为 $K_{d2} = \\frac{[RL]^{2}}{[(RL)_{2}]}$。设总受体浓度为 $R_{\\text{tot}} = 100\\,\\text{nM}$，游离配体浓度固定为 $[L] = 10\\,\\text{nM}$（假设细胞外配体库是基本恒定的）。取 $K_{d1} = 1\\,\\text{nM}$ 和 $K_{d2} = 10\\,\\text{nM}$。忽略配体非依赖性二聚化和任何更高阶的寡聚体。\n\n仅使用平衡定义和受体质量守恒，求解结合-二聚化平衡，以确定平衡时处于二聚体中的受体亚基分数，\n$$f_{\\text{dim}} \\equiv \\frac{2\\,[(RL)_{2}]}{R_{\\text{tot}}}.$$\n将您的最终答案表示为四舍五入到四位有效数字的小数。在您的推导过程中，从 $K_{d1}$ 和 $K_{d2}$ 的定义以及 $R_{\\text{tot}}$ 的守恒关系开始，并清楚地说明所做的任何近似。作为您推理的一部分（不是最终数值答案），请确定 $f_{\\text{dim}}$ 对 $[L]$ 表现出有效平方依赖关系的参数区间，并给出在该区间内 $f_{\\text{dim}}$ 的相应主导阶标度表达式。", "solution": "首先根据所需标准验证问题陈述。\n\n### 步骤1：提取已知条件\n-   **反应：** $R + L \\rightleftharpoons RL$ 和 $RL + RL \\rightleftharpoons (RL)_{2}$。\n-   **定义：**\n    -   配体结合解离常数：$K_{d1} = \\frac{[R][L]}{[RL]}$。\n    -   二聚化解离常数：$K_{d2} = \\frac{[RL]^{2}}{[(RL)_{2}]}$。\n    -   二聚体中受体亚基的分数：$f_{\\text{dim}} \\equiv \\frac{2\\,[(RL)_{2}]}{R_{\\text{tot}}}$。\n-   **常数和条件：**\n    -   总受体浓度：$R_{\\text{tot}} = 100\\,\\text{nM}$。\n    -   游离配体浓度：$[L] = 10\\,\\text{nM}$。\n    -   $K_{d1} = 1\\,\\text{nM}$。\n    -   $K_{d2} = 10\\,\\text{nM}$。\n-   **约束条件：**\n    -   忽略配体非依赖性二聚化。\n    -   忽略更高阶的寡聚体。\n    -   仅使用平衡定义和受体质量守恒。\n    -   细胞外配体库是基本恒定的。\n\n### 步骤2：使用提取的已知条件进行验证\n-   **科学依据：**该问题描述了一个配体诱导受体二聚化的最简标准模型，这是细胞信号传导中的一个基本过程，尤其适用于受体酪氨酸激酶（RTK）。使用质量作用动力学和解离常数来描述分子平衡是物理化学和系统生物学的基石。该模型具有科学合理性并被广泛使用。\n-   **适定性：**该问题提供了一套完整的代数方程组（两个平衡关系和一个守恒定律）和三个未知浓度（$[R]$, $[RL]$, $[(RL)_2]$）。独立方程的数量与未知数的数量相匹配，确保可以找到解。给定的参数可以导出一个具有物理意义的解（浓度为正）。存在一个唯一的、稳定的、有意义的解。\n-   **客观性：**该问题使用标准的科学记数法和术语，以精确、定量的方式陈述。没有主观或基于意见的陈述。\n\n### 步骤3：结论与行动\n该问题具有科学依据、适定、客观且自洽。这是一个有效的科学问题。我现在将着手求解。\n\n该系统由受体的三种状态描述：未结合配体的单体 ($R$)、结合配体的单体 ($RL$) 和结合配体的二聚体 ($(RL)_2$)。这些物种在平衡时的浓度分别表示为 $[R]$、$[RL]$ 和 $[(RL)_{2}]$。平衡关系由解离常数给出：\n$$K_{d1} = \\frac{[R][L]}{[RL]} \\quad (1)$$\n$$K_{d2} = \\frac{[RL]^{2}}{[(RL)_{2}]} \\quad (2)$$\n受体亚基的总浓度是守恒的。每种单体物种（$R$ 和 $RL$）包含一个亚基，而二聚体 ($(RL)_2$) 包含两个亚基。因此，质量守恒定律为：\n$$R_{\\text{tot}} = [R] + [RL] + 2[(RL)_{2}] \\quad (3)$$\n目标是求解 $f_{\\text{dim}} = \\frac{2[(RL)_{2}]}{R_{\\text{tot}}}$。为此，我们必须首先求出各物种的平衡浓度。我们可以使用方程 $(1)$ 和 $(2)$ 将 $[R]$ 和 $[(RL)_2]$ 表示为 $[RL]$ 的函数：\n根据 $(1)$，我们有 $[R] = \\frac{K_{d1}[RL]}{[L]}$。\n根据 $(2)$，我们有 $[(RL)_{2}] = \\frac{[RL]^2}{K_{d2}}$。\n将这些表达式代入守恒方程 $(3)$，得到一个仅含 $[RL]$ 的方程：\n$$R_{\\text{tot}} = \\left(\\frac{K_{d1}}{[L]}\\right)[RL] + [RL] + 2\\left(\\frac{[RL]^2}{K_{d2}}\\right)$$\n这可以重排为一个标准二次方程 $ax^2 + bx + c = 0$ 的形式，其中 $x = [RL]$：\n$$\\left(\\frac{2}{K_{d2}}\\right)[RL]^2 + \\left(1 + \\frac{K_{d1}}{[L]}\\right)[RL] - R_{\\text{tot}} = 0$$\n此推导不使用任何近似；它是模型定义的精确代数结果。\n\n现在，我们代入给定的数值：$R_{\\text{tot}} = 100\\,\\text{nM}$，$[L] = 10\\,\\text{nM}$，$K_{d1} = 1\\,\\text{nM}$，以及 $K_{d2} = 10\\,\\text{nM}$。\n二次方程的系数为：\n$$a = \\frac{2}{K_{d2}} = \\frac{2}{10} = 0.2\\,(\\text{nM})^{-1}$$\n$$b = 1 + \\frac{K_{d1}}{[L]} = 1 + \\frac{1}{10} = 1.1$$\n$$c = -R_{\\text{tot}} = -100\\,\\text{nM}$$\n关于 $[RL]$ 的二次方程是：\n$$0.2 [RL]^2 + 1.1 [RL] - 100 = 0$$\n我们使用二次公式 $[RL] = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}$ 求解 $[RL]$。由于浓度必须是正值，我们取正根：\n$$[RL] = \\frac{-1.1 + \\sqrt{(1.1)^2 - 4(0.2)(-100)}}{2(0.2)}$$\n$$[RL] = \\frac{-1.1 + \\sqrt{1.21 + 80}}{0.4}$$\n$$[RL] = \\frac{-1.1 + \\sqrt{81.21}}{0.4}$$\n$$[RL] = \\frac{-1.1 + 9.011659...}{0.4}$$\n$$[RL] = \\frac{7.911659...}{0.4} = 19.779147...\\,\\text{nM}$$\n现在我们可以计算二聚体的浓度 $[(RL)_{2}]$：\n$$[(RL)_{2}] = \\frac{[RL]^2}{K_{d2}} = \\frac{(19.779147...)^2}{10} = \\frac{391.2149...}{10} = 39.12149...\\,\\text{nM}$$\n最后，我们计算二聚体中受体亚基的分数 $f_{\\text{dim}}$：\n$$f_{\\text{dim}} = \\frac{2[(RL)_{2}]}{R_{\\text{tot}}} = \\frac{2 \\times 39.12149...}{100} = \\frac{78.24298...}{100} = 0.7824298...$$\n四舍五入到四位有效数字，我们得到 $f_{\\text{dim}} \\approx 0.7824$。\n\n接下来，我们确定 $f_{\\text{dim}}$ 对 $[L]$ 表现出有效平方依赖关系的参数区间。平方依赖关系 $f_{\\text{dim}} \\propto [L]^2$ 通常出现在初始步骤是限制性的多步过程中。在这里，这对应于低配体浓度区间，其中初始结合事件是罕见的。\n我们假设配体浓度非常低，特别是 $[L] \\ll K_{d1}$。在这种情况下，受体结合很弱，我们可以预期大多数受体处于未结合配体的单体状态 $R$。这导致近似 $[R] \\approx R_{\\text{tot}}$。只要结合配体的物种浓度可以忽略不计，即 $[RL] + 2[(RL)_2] \\ll R_{\\text{tot}}$，该近似就成立。\n在 $[R] \\approx R_{\\text{tot}}$ 的近似下，我们可以使用方程 $(1)$ 来找到 $[RL]$ 的主导阶表达式：\n$$[RL] = \\frac{[R][L]}{K_{d1}} \\approx \\frac{R_{\\text{tot}}[L]}{K_{d1}}$$\n这表明在低配体浓度下，$[RL]$ 与 $[L]$ 呈线性关系。\n现在，我们将 $[RL]$ 的这个近似值代入 $f_{\\text{dim}}$ 的表达式中：\n$$f_{\\text{dim}} = \\frac{2[(RL)_2]}{R_{\\text{tot}}} = \\frac{2}{R_{\\text{tot}}} \\frac{[RL]^2}{K_{d2}}$$\n$$f_{\\text{dim}} \\approx \\frac{2}{R_{\\text{tot}}K_{d2}} \\left( \\frac{R_{\\text{tot}}[L]}{K_{d1}} \\right)^2$$\n$$f_{\\text{dim}} \\approx \\frac{2 R_{\\text{tot}}}{K_{d1}^2 K_{d2}} [L]^2$$\n该表达式表明，在 $[L]$ 足够小以至于 $[R] \\approx R_{\\text{tot}}$ 的区间内，二聚化受体的分数 $f_{\\text{dim}}$ 与配体浓度 $[L]$ 呈平方依赖关系。因此，该区间是受体饱和度最低的低配体、弱结合极限。", "answer": "$$\\boxed{0.7824}$$", "id": "3344214"}, {"introduction": "受体激活后，信号会向下游传递。这个练习模拟了受体酪氨酸激酶信号通路中一个关键的第二信使——$PIP3$的动态变化。这是一个经典的案例，展示了如何运用常微分方程(ODEs)来描述信号分子的时间演化，从而使我们能够计算出如响应时间和稳态水平等关键的系统特性。通过解决这个问题，你将掌握分析信号转导模块动态行为的基本方法。[@problem_id:3344245]", "problem": "在一个简化的磷脂酰肌醇信号传导膜模型中，磷脂酰肌醇-4,5-二磷酸 (PIP2) 被受体酪氨酸激酶 (RTK) 招募的磷脂酰肌醇3-激酶 (PI3K) 转化为磷脂酰肌醇-3,4,5-三磷酸 (PIP3)，而 PIP3 又被磷酸酶和张力蛋白同源物 (PTEN) 去磷酸化变回 PIP2。假设在一个充分混合的膜片中，磷脂酰肌醇的总量是守恒的，因此有 $[ \\text{PIP2} ] + [ \\text{PIP3} ] = P_{\\text{tot}}$。假设在非饱和的一级（质量作用）反应体系中，有效正向转化率与活化的 RTK–PI3K 复合物的比例成正比。在时间 $t=0$ 时，一个阶跃刺激瞬时将 RTK–PI3K 的占有率增加到一个恒定的比例 $\\alpha$。在 $t=0$ 之前，没有 PI3K 活化，且 $[ \\text{PIP3} ](0)=0$。设从 PIP2 到 PIP3 的内在（每个活化酶）一级速率常数为 $k_{\\text{PI3K}}$，从 PIP3 到 PIP2 的为 $k_{\\text{PTEN}}$。\n\n仅使用质量作用动力学原理和磷脂酰肌醇总量守恒，推导阶跃刺激后 $[ \\text{PIP3} ](t)$ 的控制动力学，并计算：\n- PIP2 转化为 PIP3 的稳态比例，定义为 $[ \\text{PIP3} ]_{\\text{ss}} / P_{\\text{tot}}$，以及\n- 阶跃刺激后达到此稳态的半衰期，定义为 $[ \\text{PIP3} ](t)$ 等于其稳态值一半时的时间。\n\n取 $k_{\\text{PI3K}} = 0.05\\,\\text{s}^{-1}$，$k_{\\text{PTEN}} = 0.02\\,\\text{s}^{-1}$，$P_{\\text{tot}} = 10\\,\\mu\\text{M}$，以及 $\\alpha = 30\\%$。将稳态比例表示为无量纲小数，半衰期以秒为单位。将两个量都四舍五入到四位有效数字。", "solution": "该问题要求对酶活性发生阶跃变化后磷脂酰肌醇-3,4,5-三磷酸 ($[\\text{PIP3}]$) 浓度的动力学进行建模。给定一个涉及磷脂酰肌醇-4,5-二磷酸 ($[\\text{PIP2}]$) 和 $[\\text{PIP3}]$ 的双态系统，由以下可逆反应控制：\n$$\n\\text{PIP2} \\underset{k_{\\text{rev}}}{\\stackrel{k_{\\text{fwd}}}{\\rightleftharpoons}} \\text{PIP3}\n$$\n这两种磷脂酰肌醇的总浓度是守恒的，即 $[\\text{PIP2}](t) + [\\text{PIP3}](t) = P_{\\text{tot}}$，其中 $P_{\\text{tot}}$ 是一个常数。\n\n根据问题描述，该动力学由质量作用原理控制。\n对于 $t \\ge 0$，恒定比例 $\\alpha$ 的受体酪氨酸激酶-磷脂酰肌醇3-激酶 (RTK–PI3K) 复合物被激活。正向反应（PIP2 到 PIP3）由这些活化复合物催化。该速率对 $[\\text{PIP2}]$ 是一级反应。有效正向速率常数为 $k_{\\text{fwd}} = \\alpha k_{\\text{PI3K}}$。\n逆向反应（PIP3 到 PIP2）由磷酸酶 PTEN 催化。该速率对 $[\\text{PIP3}]$ 是一级反应，其内在速率常数为 $k_{\\text{rev}} = k_{\\text{PTEN}}$。\n\n$[\\text{PIP3}]$ 浓度的变化速率是其生成速率与消耗速率之差：\n$$\n\\frac{d[\\text{PIP3}]}{dt} = (\\text{生成速率}) - (\\text{消耗速率})\n$$\n$$\n\\frac{d[\\text{PIP3}]}{dt} = k_{\\text{fwd}} [\\text{PIP2}] - k_{\\text{rev}} [\\text{PIP3}]\n$$\n代入给定的速率常数：\n$$\n\\frac{d[\\text{PIP3}]}{dt} = \\alpha k_{\\text{PI3K}} [\\text{PIP2}] - k_{\\text{PTEN}} [\\text{PIP3}]\n$$\n为了得到一个单变量的微分方程，我们使用守恒定律：$[\\text{PIP2}] = P_{\\text{tot}} - [\\text{PIP3}]$。将其代入速率方程得到：\n$$\n\\frac{d[\\text{PIP3}]}{dt} = \\alpha k_{\\text{PI3K}} (P_{\\text{tot}} - [\\text{PIP3}]) - k_{\\text{PTEN}} [\\text{PIP3}]\n$$\n这是一个一阶线性常微分方程。我们将其重排为标准形式：\n$$\n\\frac{d[\\text{PIP3}]}{dt} = \\alpha k_{\\text{PI3K}} P_{\\text{tot}} - (\\alpha k_{\\text{PI3K}} + k_{\\text{PTEN}}) [\\text{PIP3}]\n$$\n$$\n\\frac{d[\\text{PIP3}]}{dt} + (\\alpha k_{\\text{PI3K}} + k_{\\text{PTEN}}) [\\text{PIP3}] = \\alpha k_{\\text{PI3K}} P_{\\text{tot}}\n$$\n设有效弛豫速率常数为 $k_{\\text{eff}} = \\alpha k_{\\text{PI3K}} + k_{\\text{PTEN}}$。方程变为：\n$$\n\\frac{d[\\text{PIP3}]}{dt} + k_{\\text{eff}} [\\text{PIP3}] = \\alpha k_{\\text{PI3K}} P_{\\text{tot}}\n$$\n该微分方程的通解是齐次解与特解之和。齐次方程的解为 $C \\exp(-k_{\\text{eff}} t)$，一个特解是稳态值。完整解为：\n$$\n[\\text{PIP3}](t) = \\frac{\\alpha k_{\\text{PI3K}} P_{\\text{tot}}}{k_{\\text{eff}}} + C \\exp(-k_{\\text{eff}} t)\n$$\n我们使用初始条件 $[\\text{PIP3}](0) = 0$ 来确定积分常数 $C$：\n$$\n0 = \\frac{\\alpha k_{\\text{PI3K}} P_{\\text{tot}}}{k_{\\text{eff}}} + C \\exp(0) \\implies C = -\\frac{\\alpha k_{\\text{PI3K}} P_{\\text{tot}}}{k_{\\text{eff}}}\n$$\n将 $C$ 代回，$[\\text{PIP3}]$ 随时间的演化为：\n$$\n[\\text{PIP3}](t) = \\frac{\\alpha k_{\\text{PI3K}} P_{\\text{tot}}}{k_{\\text{eff}}} (1 - \\exp(-k_{\\text{eff}} t))\n$$\n\n稳态浓度 $[\\text{PIP3}]_{\\text{ss}}$ 是 $[\\text{PIP3}](t)$ 在 $t \\to \\infty$ 时的值：\n$$\n[\\text{PIP3}]_{\\text{ss}} = \\lim_{t \\to \\infty} [\\text{PIP3}](t) = \\frac{\\alpha k_{\\text{PI3K}} P_{\\text{tot}}}{k_{\\text{eff}}} = \\frac{\\alpha k_{\\text{PI3K}} P_{\\text{tot}}}{\\alpha k_{\\text{PI3K}} + k_{\\text{PTEN}}}\n$$\n问题要求的是 PIP2 转化为 PIP3 的稳态比例，定义为 $[\\text{PIP3}]_{\\text{ss}} / P_{\\text{tot}}$。\n$$\n\\frac{[\\text{PIP3}]_{\\text{ss}}}{P_{\\text{tot}}} = \\frac{\\alpha k_{\\text{PI3K}}}{\\alpha k_{\\text{PI3K}} + k_{\\text{PTEN}}}\n$$\n\n接下来，我们计算半衰期 $t_{1/2}$，即 $[\\text{PIP3}](t)$ 达到其稳态值一半时的时间：$[\\text{PIP3}](t_{1/2}) = \\frac{1}{2} [\\text{PIP3}]_{\\text{ss}}$。\n$$\n\\frac{1}{2} [\\text{PIP3}]_{\\text{ss}} = [\\text{PIP3}]_{\\text{ss}} (1 - \\exp(-k_{\\text{eff}} t_{1/2}))\n$$\n两边同除以 $[\\text{PIP3}]_{\\text{ss}}$（对于 $\\alpha, k_{\\text{PI3K}} > 0$，该值非零）：\n$$\n\\frac{1}{2} = 1 - \\exp(-k_{\\text{eff}} t_{1/2})\n$$\n$$\n\\exp(-k_{\\text{eff}} t_{1/2}) = \\frac{1}{2}\n$$\n对两边取自然对数：\n$$\n-k_{\\text{eff}} t_{1/2} = \\ln\\left(\\frac{1}{2}\\right) = -\\ln(2)\n$$\n$$\nt_{1/2} = \\frac{\\ln(2)}{k_{\\text{eff}}} = \\frac{\\ln(2)}{\\alpha k_{\\text{PI3K}} + k_{\\text{PTEN}}}\n$$\n\n现在我们代入给定的数值：$k_{\\text{PI3K}} = 0.05\\,\\text{s}^{-1}$，$k_{\\text{PTEN}} = 0.02\\,\\text{s}^{-1}$，以及 $\\alpha = 0.30$。\n首先，计算有效速率常数 $k_{\\text{eff}}$：\n$$\nk_{\\text{eff}} = (0.30)(0.05\\,\\text{s}^{-1}) + 0.02\\,\\text{s}^{-1} = 0.015\\,\\text{s}^{-1} + 0.02\\,\\text{s}^{-1} = 0.035\\,\\text{s}^{-1}\n$$\n稳态比例为：\n$$\n\\frac{[\\text{PIP3}]_{\\text{ss}}}{P_{\\text{tot}}} = \\frac{\\alpha k_{\\text{PI3K}}}{k_{\\text{eff}}} = \\frac{(0.30)(0.05)}{0.035} = \\frac{0.015}{0.035} = \\frac{15}{35} = \\frac{3}{7}\n$$\n转换为小数并四舍五入到四位有效数字：\n$$\n\\frac{3}{7} \\approx 0.428571... \\approx 0.4286\n$$\n半衰期为：\n$$\nt_{1/2} = \\frac{\\ln(2)}{k_{\\text{eff}}} = \\frac{\\ln(2)}{0.035\\,\\text{s}^{-1}} \\approx \\frac{0.693147...}{0.035\\,\\text{s}^{-1}} \\approx 19.8042... \\,\\text{s}\n$$\n四舍五入到四位有效数字得到：\n$$\nt_{1/2} \\approx 19.80\\,\\text{s}\n$$\n总磷脂酰肌醇浓度 $P_{\\text{tot}} = 10\\,\\mu\\text{M}$ 在这些计算中是不需要的。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.4286  19.80\n\\end{pmatrix}\n}\n$$", "id": "3344245"}, {"introduction": "在系统生物学中，构建定量模型是一项核心工作，但我们如何确定模型的参数能够通过实验数据被可靠地估计出来？这个高级实践将引导你使用费雪信息矩阵(FIM)这一强大工具来评估受体运输模型中的参数可辨识性。通过这个编码练习，你将亲身体验从灵敏度分析到模型验证的核心计算流程，这对于构建复杂生物过程（如RTK信号传导）的稳健预测模型至关重要。[@problem_id:3344235]", "problem": "您将获得一个用于描述脉冲追踪实验中受体酪氨酸激酶 (RTK) 转运的双室线性质量作用模型，该模型描述了质膜（表面）和内化室中标记受体的数量。令 $R_s(t)$ 表示在时间 $t$ 时表面标记的受体数量，令 $R_i(t)$ 表示内化标记的受体数量。该模型假设内化、再循环和内部降解均为一级反应。参数向量为 $\\theta = [k_{\\mathrm{int}}, k_{\\mathrm{rec}}, k_{\\mathrm{deg}}]$，其中 $k_{\\mathrm{int}}$ 是内化速率常数，$k_{\\mathrm{rec}}$ 是再循环速率常数，$k_{\\mathrm{deg}}$ 是内部降解速率常数。所有速率常数的单位均为 $\\mathrm{s}^{-1}$。其控制常微分方程为\n$$\n\\frac{dR_s}{dt} = -k_{\\mathrm{int}} R_s + k_{\\mathrm{rec}} R_i, \\quad\n\\frac{dR_i}{dt} = k_{\\mathrm{int}} R_s - (k_{\\mathrm{rec}} + k_{\\mathrm{deg}}) R_i,\n$$\n初始条件代表标记脉冲后的追踪开始：\n$$\nR_s(0) = R_0, \\quad R_i(0) = 0,\n$$\n其中 $R_0$ 是初始标记受体量（无量纲的标记受体分数或归一化为 $R_0=1$）。\n\n您在指定时间观测 $R_s(t)$ 和/或 $R_i(t)$，每个测量组分都带有已知标准差 $\\sigma_y$ 的独立加性高斯噪声。假设测量函数为单位函数（观测值直接等于相应的状态组分），且测量噪声是零均值高斯噪声，方差为 $\\sigma_y^2$，并且在不同时间点和组分之间是独立的。\n\n您的任务是通过根据连续时间灵敏度方程构建的费雪信息矩阵（FIM）来评估局部结构可辨识性和实际可辨识性。令 $x(t) = [R_s(t), R_i(t)]^\\top$ 表示状态向量，令 $S(t) = \\frac{\\partial x(t)}{\\partial \\theta}$ 表示 $2 \\times 3$ 的灵敏度矩阵，其中第 $(j,\\ell)$ 个元素为 $\\frac{\\partial x_j(t)}{\\partial \\theta_\\ell}$。灵敏度动态特性遵循可微流的一阶原理：\n$$\n\\frac{d}{dt} S(t) = A(t) S(t) + B_\\theta(t), \\quad S(0) = 0_{2 \\times 3},\n$$\n其中 $A(t) = \\frac{\\partial f}{\\partial x}\\big|_{x(t),\\theta}$ 和 $B_\\theta(t) = \\frac{\\partial f}{\\partial \\theta}\\big|_{x(t),\\theta}$，这里的 $f(x,\\theta)$ 是状态动力学方程的右侧项。对于上述线性模型，\n$$\nA(t) = \\begin{bmatrix}\n-k_{\\mathrm{int}}  k_{\\mathrm{rec}} \\\\\nk_{\\mathrm{int}}  -(k_{\\mathrm{rec}} + k_{\\mathrm{deg}})\n\\end{bmatrix},\n\\quad\nB_\\theta(t) = \\begin{bmatrix}\n-\\;R_s(t)  \\;\\;R_i(t)  \\;\\;0 \\\\\n\\;\\;R_s(t)  -R_i(t)  -R_i(t)\n\\end{bmatrix}.\n$$\n\n给定观测时间 $t_1, \\dots, t_N$，由索引集 $\\mathcal{O} \\subset \\{1,2\\}$（其中 1 代表 $R_s$，2 代表 $R_i$）指示的观测组分的一个子集，以及所有观测组分共有的标准差 $\\sigma_y$，费雪信息矩阵为\n$$\nF(\\theta) = \\sum_{k=1}^N \\sum_{j \\in \\mathcal{O}} \\frac{1}{\\sigma_y^2} \\left( \\frac{\\partial x_j(t_k)}{\\partial \\theta} \\right)^\\top \\left( \\frac{\\partial x_j(t_k)}{\\partial \\theta} \\right),\n$$\n其中 $\\frac{\\partial x_j(t_k)}{\\partial \\theta}$ 是 $S(t_k)$ 中对应于组分 $j$ 的 $1 \\times 3$ 行向量。对对称矩阵 $F(\\theta)$ 进行特征分解，以提取特征值和特征向量。将 $F(\\theta)$ 的数值条件数定义为\n$$\n\\kappa_{10} = \\log_{10} \\left( \\frac{\\lambda_{\\max}}{\\max(\\lambda_{\\min}, \\epsilon)} \\right),\n$$\n其中 $\\lambda_{\\max}$ 和 $\\lambda_{\\min}$ 分别是 $F(\\theta)$ 的最大和最小特征值，固定正则化子 $\\epsilon = 10^{-12}$ 以避免在奇异情况下的除零错误。将与 $\\lambda_{\\min}$ 相关联的单位特征向量 $v_{\\mathrm{sloppy}}$ 定义为最松弛方向。为了解释哪个参数组合最松弛，计算 $v_{\\mathrm{sloppy}}$ 与 $k_{\\mathrm{rec}}$ 的单位轴向量（即 $e_{\\mathrm{rec}} = [0,1,0]^\\top$）之间的主夹角（以度为单位）。该夹角为\n$$\n\\phi = \\arccos\\!\\left( \\left| v_{\\mathrm{sloppy}} \\cdot e_{\\mathrm{rec}} \\right| \\right) \\cdot \\frac{180}{\\pi},\n$$\n其中绝对值强制得到一个锐角。\n\n编写一个完整程序，对下面指定的每个测试用例，使用上述基于灵敏度的方法构建 $F(\\theta)$，并返回两个输出：条件数 $\\kappa_{10}$ 的以 10 为底的对数，以及最松弛方向夹角 $\\phi$（以度为单位）。所有速率常数必须以 $\\mathrm{s}^{-1}$ 为单位处理，所有角度必须以度为单位报告。此任务中没有任何百分比输出。\n\n使用以下参数集、观测设置和时间网格的测试套件：\n\n- 测试用例 1（平衡转运，观测两个组分）：\n  - $\\theta = [k_{\\mathrm{int}}, k_{\\mathrm{rec}}, k_{\\mathrm{deg}}] = [0.15, 0.08, 0.02]$，单位 $\\mathrm{s}^{-1}$。\n  - $R_0 = 1.0$（无量纲）。\n  - 观测索引集 $\\mathcal{O} = \\{1,2\\}$。\n  - 观测时间 $t_k$（单位：秒）：$[0, 5, 10, 20, 40, 80, 160]$。\n  - $\\sigma_y = 0.01$（无量纲）。\n- 测试用例 2（仅观测表面以探究实际不可辨识性）：\n  - $\\theta = [0.15, 0.08, 0.02]$，单位 $\\mathrm{s}^{-1}$。\n  - $R_0 = 1.0$（无量纲）。\n  - 观测索引集 $\\mathcal{O} = \\{1\\}$。\n  - 观测时间 $t_k$（单位：秒）：$[0, 5, 10, 20, 40, 80, 160]$。\n  - $\\sigma_y = 0.01$（无量纲）。\n- 测试用例 3（慢速再循环机制，观测两个组分）：\n  - $\\theta = [0.20, 0.005, 0.20]$，单位 $\\mathrm{s}^{-1}$。\n  - $R_0 = 1.0$（无量纲）。\n  - 观测索引集 $\\mathcal{O} = \\{1,2\\}$。\n  - 观测时间 $t_k$（单位：秒）：$[0, 2, 4, 8, 16, 32, 64, 128]$。\n  - $\\sigma_y = 0.01$（无量纲）。\n\n您的程序必须：\n- 对每个测试用例，在指定时间积分耦合的状态和灵敏度动力学方程，以获得 $S(t_k)$。\n- 使用上述公式以及指定的 $\\sigma_y$ 和 $\\mathcal{O}$ 来组装费雪信息矩阵 $F(\\theta)$。\n- 计算 $\\kappa_{10}$（使用 $\\epsilon = 10^{-12}$）以及 $v_{\\mathrm{sloppy}}$ 和 $e_{\\mathrm{rec}}$ 之间的锐角 $\\phi$（以度为单位）。\n- 生成单行输出，其中包含所有测试用例的结果，格式为一个由方括号括起来的逗号分隔列表，每个测试用例对应一个双元素列表 $[\\kappa_{10}, \\phi]$。例如，输出格式必须与 $[[a,b],[c,d],[e,f]]$ 完全一样，其中 a,b,c,d,e,f 是浮点数。", "solution": "该问题要求使用基于灵敏度的费雪信息矩阵（FIM）方法，评估一个受体转运双室模型的参数可辨识性。解决方案涉及数值积分一个耦合的常微分方程（ODE）系统，该系统描述了系统状态及其相对于模型参数的灵敏度，然后构建并分析 FIM。\n\n### 数学模型和状态动力学\n该系统描述了细胞表面 $R_s(t)$ 和内部室 $R_i(t)$ 中标记受体的数量。其动力学由一个线性一阶 ODE 系统控制：\n$$\n\\frac{d R_s}{dt} = -k_{\\mathrm{int}} R_s + k_{\\mathrm{rec}} R_i\n$$\n$$\n\\frac{d R_i}{dt} = k_{\\mathrm{int}} R_s - (k_{\\mathrm{rec}} + k_{\\mathrm{deg}}) R_i\n$$\n此处，参数向量为 $\\theta = [k_{\\mathrm{int}}, k_{\\mathrm{rec}}, k_{\\mathrm{deg}}]^\\top$，分别代表内化、再循环和降解的速率常数。实验的追踪阶段初始条件为 $R_s(0) = R_0$ 和 $R_i(0) = 0$，其中 $R_0$ 归一化为 1.0。\n\n### 通过增广 ODE 系统进行灵敏度分析\n为了构建 FIM，我们需要状态变量相对于参数的灵敏度，即灵敏度矩阵 $S(t) = \\frac{\\partial x(t)}{\\partial \\theta}$ 的分量，其中 $x(t) = [R_s(t), R_i(t)]^\\top$。$S(t)$ 的动力学由下式给出：\n$$\n\\frac{d}{dt} S(t) = A S(t) + B_\\theta(t)\n$$\n初始条件为 $S(0) = 0_{2 \\times 3}$，一个 $2 \\times 3$ 的零矩阵。矩阵 $A$ 和 $B_\\theta(t)$ 分别是状态动力学相对于状态和参数的雅可比矩阵：\n$$\nA = \\begin{bmatrix} -k_{\\mathrm{int}}  k_{\\mathrm{rec}} \\\\ k_{\\mathrm{int}}  -(k_{\\mathrm{rec}} + k_{\\mathrm{deg}}) \\end{bmatrix}, \\quad\nB_\\theta(t) = \\begin{bmatrix}\n-R_s(t)  R_i(t)  0 \\\\\nR_s(t)  -R_i(t)  -R_i(t)\n\\end{bmatrix}\n$$\n为了数值求解该系统，我们创建一个维度为 8 的增广状态向量 $y(t)$，它结合了 2 个状态变量和灵敏度矩阵的 6 个分量。为了高效实现，将 $2 \\times 3$ 的灵敏度矩阵 $S(t)$ 按列展平。增广向量为 $y(t) = [R_s, R_i, S_{11}, S_{21}, S_{12}, S_{22}, S_{13}, S_{23}]^\\top$。然后对这个由 8 个耦合 ODE 组成的完整系统进行数值积分。此增广系统的初始条件为 $y(0) = [R_0, 0, 0, 0, 0, 0, 0, 0]^\\top$。\n\n### 数值积分\n使用 `scipy.integrate.solve_ivp` 函数对每个测试用例的增广 ODE 系统从 $t=0$ 积分到最终观测时间。在每个案例中提供的特定时间点 $t_k$ 对解进行求值，从而得到状态轨迹 $x(t_k)$ 和灵敏度矩阵 $S(t_k)$。\n\n### 费雪信息矩阵（FIM）的构建\nFIM $F(\\theta)$ 量化了观测数据提供的关于参数 $\\theta$ 的信息。对于方差为 $\\sigma_y^2$ 的独立加性高斯噪声，它通过对每个时间点的每次观测的贡献求和来计算：\n$$\nF(\\theta) = \\sum_{k=1}^{N} \\sum_{j \\in \\mathcal{O}} \\frac{1}{\\sigma_y^2} \\left( \\frac{\\partial x_j(t_k)}{\\partial \\theta} \\right)^\\top \\left( \\frac{\\partial x_j(t_k)}{\\partial \\theta} \\right)\n$$\n其中 $\\mathcal{O}$ 是观测组分的索引集（例如，$\\{1\\}$ 代表 $R_s$，$\\{1,2\\}$ 代表 $R_s$ 和 $R_i$），而 $\\frac{\\partial x_j(t_k)}{\\partial \\theta}$ 是灵敏度矩阵 $S(t_k)$ 的第 $j$ 行。总和中的每一项都是一个 $3 \\times 3$ 矩阵，由一个灵敏度行向量与其自身的外积形成。该算法遍历指定的观测时间 $t_k$ 和观测组分 $j \\in \\mathcal{O}$，将这些外积累加到 FIM 中，然后乘以 $1/\\sigma_y^2$。\n\n### 可辨识性度量计算\nFIM 的性质揭示了参数的可辨识性。我们对对称的 $3 \\times 3$ 矩阵 $F(\\theta)$ 进行特征分解，以获得其特征值 $\\lambda_i$ 和相应的特征向量 $v_i$。\n\n1.  **条件数**：最大特征值 $\\lambda_{\\max}$ 与最小特征值 $\\lambda_{\\min}$ 的比值表示参数估计问题的刚度。大的条件数意味着“松弛性”，即某些参数组合受到数据的约束很弱。我们计算一个正则化条件数的以 10 为底的对数：\n    $$\n    \\kappa_{10} = \\log_{10} \\left( \\frac{\\lambda_{\\max}}{\\max(\\lambda_{\\min}, \\epsilon)} \\right)\n    $$\n    其中正则化子 $\\epsilon = 10^{-12}$ 防止在 FIM 为奇异矩阵时出现除零错误。\n\n2.  **松弛方向角**：与 $\\lambda_{\\min}$ 相关的特征向量 $v_{\\mathrm{sloppy}}$ 定义了参数空间中的“最松弛”方向——即可辨识性最差的参数组合。为了解释这个方向，我们计算它与特定参数轴的对齐程度。在这里，我们计算 $v_{\\mathrm{sloppy}}$ 与代表 $k_{\\mathrm{rec}}$ 轴的单位向量 $e_{\\mathrm{rec}} = [0,1,0]^\\top$ 之间的主夹角 $\\phi$：\n    $$\n    \\phi = \\arccos\\!\\left( \\left| v_{\\mathrm{sloppy}} \\cdot e_{\\mathrm{rec}} \\right| \\right) \\cdot \\frac{180}{\\pi}\n    $$\n点积的绝对值确保角度为锐角（在 $0^\\circ$ 和 $90^\\circ$ 之间）。一个小的角度 $\\phi$ 表示最松弛方向与 $k_{\\mathrm{rec}}$ 轴紧密对齐，意味着 $k_{\\mathrm{rec}}$ 是最难估计的参数（或不可辨识组合中的主导分量）。\n\n将这整个过程应用于问题中指定的三个测试用例中的每一个，为每个用例生成一对值 $[\\kappa_{10}, \\phi]$。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Main function to run the analysis for all test cases and print the results.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Test case 1: balanced trafficking, both components observed\n        {\n            \"theta\": np.array([0.15, 0.08, 0.02]),  # [k_int, k_rec, k_deg]\n            \"R0\": 1.0,\n            \"obs_indices\": {1, 2},  # 1 for R_s, 2 for R_i\n            \"t_obs\": np.array([0, 5, 10, 20, 40, 80, 160]),\n            \"sigma_y\": 0.01\n        },\n        # Test case 2: surface-only observation\n        {\n            \"theta\": np.array([0.15, 0.08, 0.02]),\n            \"R0\": 1.0,\n            \"obs_indices\": {1},\n            \"t_obs\": np.array([0, 5, 10, 20, 40, 80, 160]),\n            \"sigma_y\": 0.01\n        },\n        # Test case 3: slow recycling regime, both components observed\n        {\n            \"theta\": np.array([0.20, 0.005, 0.20]),\n            \"R0\": 1.0,\n            \"obs_indices\": {1, 2},\n            \"t_obs\": np.array([0, 2, 4, 8, 16, 32, 64, 128]),\n            \"sigma_y\": 0.01\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        result = analyze_identifiability(case)\n        results.append(result)\n\n    # Format the final output as a list of lists of floats\n    formatted_results = [f\"[{res[0]},{res[1]}]\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\ndef dydt_augmented(t, y, theta):\n    \"\"\"\n    Defines the augmented ODE system for states and sensitivities.\n    \n    Args:\n        t (float): Time.\n        y (np.ndarray): Augmented state vector [R_s, R_i, S_11, S_21, ...].\n        theta (np.ndarray): Parameter vector [k_int, k_rec, k_deg].\n\n    Returns:\n        np.ndarray: The derivative of the augmented state vector.\n    \"\"\"\n    k_int, k_rec, k_deg = theta\n    R_s, R_i = y[0], y[1]\n\n    # Initialize derivative vector\n    dydt = np.zeros_like(y)\n\n    # State equations\n    dydt[0] = -k_int * R_s + k_rec * R_i\n    dydt[1] = k_int * R_s - (k_rec + k_deg) * R_i\n\n    # Sensitivity equations\n    # Jacobian of the system w.r.t. states\n    A = np.array([\n        [-k_int, k_rec],\n        [k_int, -(k_rec + k_deg)]\n    ])\n\n    # Jacobian of the system w.r.t. parameters\n    B_theta = np.array([\n        [-R_s, R_i, 0],\n        [R_s, -R_i, -R_i]\n    ])\n\n    # Sensitivities are flattened column-wise in the state vector y\n    # dS/dt = A*S + B_theta\n    # For each parameter (column of S and B_theta):\n    # dS_j/dt = A * S_j + B_theta_j\n\n    # Sensitivity w.r.t. k_int (S_col1)\n    S_col1 = y[2:4]\n    dydt[2:4] = A @ S_col1 + B_theta[:, 0]\n\n    # Sensitivity w.r.t. k_rec (S_col2)\n    S_col2 = y[4:6]\n    dydt[4:6] = A @ S_col2 + B_theta[:, 1]\n\n    # Sensitivity w.r.t. k_deg (S_col3)\n    S_col3 = y[6:8]\n    dydt[6:8] = A @ S_col3 + B_theta[:, 2]\n\n    return dydt\n\ndef analyze_identifiability(case):\n    \"\"\"\n    Performs the full identifiability analysis for a single test case.\n    \n    Args:\n        case (dict): A dictionary containing all parameters for the test case.\n        \n    Returns:\n        list: A list containing [kappa_10, phi].\n    \"\"\"\n    theta = case[\"theta\"]\n    R0 = case[\"R0\"]\n    obs_indices = case[\"obs_indices\"]\n    t_obs = case[\"t_obs\"]\n    sigma_y = case[\"sigma_y\"]\n    epsilon = 1e-12\n\n    # 1. Integrate the augmented ODE system\n    y0 = np.zeros(8)\n    y0[0] = R0  # R_s(0) = R0\n    t_span = [0, t_obs[-1]]\n    \n    sol = solve_ivp(\n        dydt_augmented,\n        t_span,\n        y0,\n        t_eval=t_obs,\n        args=(theta,),\n        method='RK45', \n        rtol=1e-8, \n        atol=1e-10\n    )\n\n    # 2. Assemble the Fisher Information Matrix (FIM)\n    num_params = 3\n    FIM = np.zeros((num_params, num_params))\n    \n    for k in range(len(t_obs)):\n        # Sensitivity matrix S(t_k)\n        # S_ij = d(x_i)/d(theta_j)\n        # Row 1 of S corresponds to R_s sensitivities\n        s_Rs = np.array([sol.y[2, k], sol.y[4, k], sol.y[6, k]])\n        # Row 2 of S corresponds to R_i sensitivities\n        s_Ri = np.array([sol.y[3, k], sol.y[5, k], sol.y[7, k]])\n\n        if 1 in obs_indices:  # R_s is observed\n            FIM += np.outer(s_Rs, s_Rs)\n        if 2 in obs_indices:  # R_i is observed\n            FIM += np.outer(s_Ri, s_Ri)\n    \n    FIM /= (sigma_y**2)\n\n    # 3. Compute identifiability metrics\n    # Eigendecomposition of the symmetric FIM\n    evals, evecs = np.linalg.eigh(FIM)\n    \n    lambda_min = evals[0]\n    lambda_max = evals[-1]\n    v_sloppy = evecs[:, 0]\n\n    # a. Condition number\n    kappa_10 = np.log10(lambda_max / max(lambda_min, epsilon))\n\n    # b. Sloppiest direction angle\n    e_rec = np.array([0., 1., 0.])\n    # The dot product is just the second component of the eigenvector\n    cos_angle_abs = np.abs(np.dot(v_sloppy, e_rec))\n    # Ensure argument to arccos is = 1.0 due to potential float precision issues\n    cos_angle_abs = min(cos_angle_abs, 1.0)\n    angle_rad = np.arccos(cos_angle_abs)\n    phi = np.degrees(angle_rad)\n\n    return [kappa_10, phi]\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "3344235"}]}