{"hands_on_practices": [{"introduction": "细胞信号通路通常表现出比其组分更陡峭的开关式响应，这种现象被称为超敏性（ultrasensitivity）。本练习旨在探讨一个基本问题：级联（cascade）这一常见的网络基序，是如何从遵循简单双曲响应的单个步骤中产生出系统层面的超敏性。通过推导和计算有效希尔系数，您将亲手量化这一涌现特性，并理解细胞中信号放大和决策制定的一个关键机制。[@problem_id:3354029]", "problem": "在计算系统生物学中，考虑一个共价修饰系统，其中底物需要磷酸化才能被激活。假设活性激酶与其磷酸化靶位点之间存在快速结合平衡，因此每个独立的磷酸化步骤的剂量响应可以用一个关于活性激酶浓度 $x$ 的有效解离常数 $K_d$ 来表征。在此假设和质量作用定律下，单个位点被磷酸化的稳态分数可以从结合平衡推导为双曲剂量响应 $f(x)$。\n\n考虑两种情况：\n- 单步激活：输出 $y_1(x)$ 是经过一个磷酸化步骤后，处于磷酸化状态的底物的稳态分数。\n- 两步级联：输出 $y_2(x)$ 是经过两个独立的、连续的磷酸化事件后，完全磷酸化的底物的稳态分数，每个事件都遵循相同的动力学和相同的 $K_d$。\n\n将剂量响应 $y(x)$ 的有效希尔系数 $n_H$ 定义为响应的logit对输入对数在半最大响应点处的斜率：\n$$\nn_H \\equiv \\left.\\frac{d}{d \\ln x} \\ln\\!\\left(\\frac{y(x)}{1 - y(x)}\\right)\\right|_{y(x) = \\frac{1}{2}}.\n$$\n\n从结合平衡和质量作用原理出发，推导 $y_1(x)$ 和 $y_2(x)$ 关于 $x$ 和 $K_d$ 的表达式，然后使用上述定义计算单步和两步情况下的有效希尔系数 $n_{H,1}$ 和 $n_{H,2}$。在可比较的动力学参数下（两个磷酸化步骤的 $K_d$ 相同），报告比率 $R = \\frac{n_{H,2}}{n_{H,1}}$ 的精确解析表达式。请以单个闭式表达式给出你的最终答案。无需四舍五入。", "solution": "该问题在科学上是成立的、表述清晰且客观的。它基于系统生物学中使用的生化反应动力学标准模型，并提供了所有必要的参数和定义。\n\n首先，我们推导单步激活输出 $y_1(x)$ 的表达式。问题指出，磷酸化位点的稳态分数可以从激酶和底物之间的快速结合平衡推导得出。设 $S$ 为未磷酸化的底物位点， $K$ 为活性激酶，其浓度为 $x$。结合反应为 $S + K \\rightleftharpoons SK$。解离常数由 $K_d = \\frac{[S][K]}{[SK]}$ 给出。使用 $[K] = x$，这变为 $K_d = \\frac{[S]x}{[SK]}$。底物位点的总浓度为 $[S]_{tot} = [S] + [SK]$。磷酸化底物的分数 $y_1(x)$ 是平衡时与激酶结合的位点的分数：\n$$\ny_1(x) = \\frac{[SK]}{[S]_{tot}} = \\frac{[SK]}{[S] + [SK]}\n$$\n通过重新整理 $K_d$ 的表达式，我们得到 $[SK] = \\frac{[S]x}{K_d}$。将此代入 $y_1(x)$ 的方程中得到：\n$$\ny_1(x) = \\frac{\\frac{[S]x}{K_d}}{[S] + \\frac{[S]x}{K_d}} = \\frac{\\frac{x}{K_d}}{1 + \\frac{x}{K_d}} = \\frac{x}{K_d + x}\n$$\n这是双曲的米氏-门顿或希尔-朗缪尔剂量响应函数。\n\n接下来，我们计算单步情况下的有效希尔系数 $n_{H,1}$。定义为 $n_{H,1} \\equiv \\left.\\frac{d}{d \\ln x} \\ln\\left(\\frac{y_1(x)}{1 - y_1(x)}\\right)\\right|_{y_1(x) = \\frac{1}{2}}$。我们首先计算logit项 $\\ln\\left(\\frac{y_1(x)}{1 - y_1(x)}\\right)$：\n$$\n\\frac{y_1(x)}{1 - y_1(x)} = \\frac{\\frac{x}{K_d + x}}{1 - \\frac{x}{K_d + x}} = \\frac{\\frac{x}{K_d + x}}{\\frac{(K_d + x) - x}{K_d + x}} = \\frac{x}{K_d}\n$$\n取自然对数得到：\n$$\n\\ln\\left(\\frac{y_1(x)}{1 - y_1(x)}\\right) = \\ln\\left(\\frac{x}{K_d}\\right) = \\ln(x) - \\ln(K_d)\n$$\n对 $\\ln(x)$ 求导得到：\n$$\nn_{H,1} = \\frac{d}{d \\ln x} (\\ln(x) - \\ln(K_d)) = 1\n$$\n这个结果是一个常数，因此它在半最大响应点的值为 $1$。所以，$n_{H,1} = 1$。\n\n现在，我们推导两步级联输出 $y_2(x)$ 的表达式。底物在经过两个独立的、连续的事件后被完全磷酸化，每个事件都具有相同的动力学。单个位点被磷酸化的概率是 $f(x) = y_1(x) = \\frac{x}{K_d + x}$。由于两个磷酸化事件是独立的，两个位点都被磷酸化的概率是它们各自概率的乘积：\n$$\ny_2(x) = f(x) \\cdot f(x) = (f(x))^2 = \\left(\\frac{x}{K_d + x}\\right)^2\n$$\n为了计算 $n_{H,2}$，我们首先找到当 $y_2(x) = \\frac{1}{2}$ 时的激酶浓度 $x_{1/2}$：\n$$\n\\left(\\frac{x_{1/2}}{K_d + x_{1/2}}\\right)^2 = \\frac{1}{2} \\implies \\frac{x_{1/2}}{K_d + x_{1/2}} = \\frac{1}{\\sqrt{2}}\n$$\n我们取正根，因为浓度必须为正。解出 $x_{1/2}$：\n$$\n\\sqrt{2}x_{1/2} = K_d + x_{1/2} \\implies (\\sqrt{2} - 1)x_{1/2} = K_d \\implies x_{1/2} = \\frac{K_d}{\\sqrt{2} - 1} = K_d(\\sqrt{2} + 1)\n$$\n接下来，我们确定 $n_{H,2}$ 的导数项。设 $L(x) = \\ln\\left(\\frac{y_2(x)}{1 - y_2(x)}\\right)$：\n$$\n\\frac{y_2(x)}{1 - y_2(x)} = \\frac{\\left(\\frac{x}{K_d + x}\\right)^2}{1 - \\left(\\frac{x}{K_d + x}\\right)^2} = \\frac{x^2}{(K_d + x)^2 - x^2} = \\frac{x^2}{K_d^2 + 2K_dx + x^2 - x^2} = \\frac{x^2}{K_d^2 + 2K_dx}\n$$\n$$\nL(x) = \\ln\\left(\\frac{x^2}{K_d^2 + 2K_dx}\\right) = 2\\ln(x) - \\ln(K_d^2 + 2K_dx)\n$$\n局部希尔系数作为 $x$ 的函数，我们称之为 $n_H(x)$，是 $\\frac{d L(x)}{d \\ln x}$。使用链式法则 $\\frac{d}{d \\ln x} = x \\frac{d}{dx}$：\n$$\nn_H(x) = x \\frac{d}{dx} \\left[2\\ln(x) - \\ln(K_d^2 + 2K_dx)\\right] = x \\left[\\frac{2}{x} - \\frac{2K_d}{K_d^2 + 2K_dx}\\right] = 2 - \\frac{2K_dx}{K_d(K_d + 2x)} = 2 - \\frac{2x}{K_d + 2x}\n$$\n简化 $n_H(x)$ 的表达式：\n$$\nn_H(x) = \\frac{2(K_d + 2x) - 2x}{K_d + 2x} = \\frac{2K_d + 4x - 2x}{K_d + 2x} = \\frac{2K_d + 2x}{K_d + 2x}\n$$\n我们在 $x = x_{1/2} = K_d(\\sqrt{2} + 1)$ 处计算这个值以求得 $n_{H,2}$：\n$$\nn_{H,2} = \\frac{2K_d + 2K_d(\\sqrt{2} + 1)}{K_d + 2K_d(\\sqrt{2} + 1)} = \\frac{K_d(2 + 2\\sqrt{2} + 2)}{K_d(1 + 2\\sqrt{2} + 2)} = \\frac{4 + 2\\sqrt{2}}{3 + 2\\sqrt{2}}\n$$\n为了简化这个分数，我们将分子和分母乘以分母的共轭 $(3 - 2\\sqrt{2})$：\n$$\nn_{H,2} = \\frac{(4 + 2\\sqrt{2})(3 - 2\\sqrt{2})}{(3 + 2\\sqrt{2})(3 - 2\\sqrt{2})} = \\frac{12 - 8\\sqrt{2} + 6\\sqrt{2} - 4(2)}{3^2 - (2\\sqrt{2})^2} = \\frac{12 - 2\\sqrt{2} - 8}{9 - 8} = 4 - 2\\sqrt{2}\n$$\n最后，我们计算比率 $R = \\frac{n_{H,2}}{n_{H,1}}$：\n$$\nR = \\frac{4 - 2\\sqrt{2}}{1} = 4 - 2\\sqrt{2}\n$$", "answer": "$$\n\\boxed{4 - 2\\sqrt{2}}\n$$", "id": "3354029"}, {"introduction": "建立数学模型只是第一步；一个有用的模型，其参数必须能通过实验数据进行估计。本练习探讨了参数可辨识性（parameter identifiability）这一核心问题：我们能否从一组带噪声的测量数据中唯一地确定模型参数？您将通过分析一个基本的一阶衰变过程，将系统动力学与Fisher信息这一关键统计概念联系起来，从而深入理解实验设计（如测量时间点）和噪声水平如何影响我们对生物过程的定量认知。[@problem_id:3353994]", "problem": "一个单室生物系统表现出某分子种类的浓度呈一阶衰减，其模型为常微分方程 $\\dot{x}(t) = -k x(t)$，其中 $x(t)$ 表示时间 $t$ 时的浓度，$k > 0$ 是一个未知的速率常数。初始条件 $x(0) = x_0$ 已知且为正。在 $N$ 个时间点 $\\{t_i\\}_{i=1}^{N}$（其中 $t_i \\geq 0$）收集实验测量值，产生观测值 $y(t_i) = x(t_i) + \\epsilon_i$，其中测量噪声 $\\epsilon_i$ 是独立同分布的高斯随机变量，均值为零，方差为 $\\sigma^2$。仅使用动力系统和统计估计的基本定义与原理，且不借助任何快捷公式，完成以下任务：\n1. 从模型及其解出发，推导局部参数灵敏度 $s(t) = \\frac{\\partial x(t)}{\\partial k}$。\n2. 对于这组有限的带噪声样本，在高斯采样模型下，推导参数 $k$ 的费雪信息 (FI)，并用 $x_0$、$\\sigma^2$、$k$ 和采样时间 $\\{t_i\\}_{i=1}^{N}$ 表示。使用独立高斯观测的似然函数定义以及连接对数似然函数的负海森矩阵期望与费雪信息的标准信息恒等式。\n3. 使用你推导出的费雪信息表达式，阐明 $k$ 从给定的有限带噪声样本中实际可辨识的条件。基于费雪信息的正定性解释你的结论。\n\n将你的最终答案以单行矩阵的形式给出，包含两个解析表达式：灵敏度 $s(t)$ 和参数 $k$ 的费雪信息。最终答案中不包含单位。无需进行数值四舍五入。所有数学实体均使用标准LaTeX符号表示。", "solution": "在尝试求解之前，对问题陈述进行了严格验证。\n\n### 步骤1：提取已知条件\n-   **模型方程**：某分子种类的浓度 $x(t)$ 由常微分方程 (ODE) $\\dot{x}(t) = -k x(t)$ 控制。\n-   **速率常数**：$k > 0$ 是一个未知常数。\n-   **初始条件**：初始浓度为 $x(0) = x_0$，其中 $x_0 > 0$。\n-   **测量数据**：在时间点 $\\{t_i\\}_{i=1}^{N}$（其中 $t_i \\geq 0$）收集了一组共 $N$ 个观测值 $\\{y(t_i)\\}_{i=1}^{N}$。\n-   **观测模型**：每个观测值由 $y(t_i) = x(t_i) + \\epsilon_i$ 给出。\n-   **噪声模型**：测量误差 $\\epsilon_i$ 是独立同分布 (i.i.d.) 的随机变量，服从均值为零、方差为 $\\sigma^2$ 的高斯分布，记为 $\\epsilon_i \\sim \\mathcal{N}(0, \\sigma^2)$。\n-   **任务1**：推导局部参数灵敏度 $s(t) = \\frac{\\partial x(t)}{\\partial k}$。\n-   **任务2**：推导参数 $k$ 的费雪信息 (FI)。\n-   **任务3**：阐明 $k$ 的实际可辨识性条件。\n\n### 步骤2：使用提取的已知条件进行验证\n对问题的有效性进行评估。\n-   **科学依据**：模型 $\\dot{x}(t) = -k x(t)$ 描述了一阶衰减，这是化学、物理和生物学等众多科学领域中的一个基本过程。用于参数估计的统计框架，涉及高斯噪声、似然函数和费雪信息，是数理统计学中标准且严格建立的。该问题具有科学合理性。\n-   **适定性**：问题定义清晰，提供了所有必要的符号常量（$x_0$、$\\sigma^2$、$N$、$\\{t_i\\}$）。任务具体且可形式化，能够导出唯一的解析表达式。该问题是适定的。\n-   **客观性**：问题使用精确的数学和统计学术语陈述，没有歧义、主观性或观点。\n\n### 步骤3：结论与行动\n该问题被判定为**有效**，因其具有科学依据、数学上的适定性、客观性和自洽性。将提供一个完整的、附带推理过程的解法。\n\n### 求解推导\n求解过程首先解出定义的常微分方程，然后推导灵敏度，接着推导费雪信息，最后解释结果以确定实际可辨识性的条件。\n\n**0. 控制常微分方程的求解**\n\n模型是一阶线性常微分方程：\n$$\n\\frac{dx}{dt} = -k x(t)\n$$\n该方程是可分离的。我们可以将其整理为：\n$$\n\\frac{1}{x} dx = -k dt\n$$\n对两边从初始状态 $(x_0, 0)$ 到一般状态 $(x(t), t)$ 进行积分：\n$$\n\\int_{x_0}^{x(t)} \\frac{1}{x'} dx' = \\int_{0}^{t} -k dt'\n$$\n$$\n[\\ln|x'|]_{x_0}^{x(t)} = [-kt']_{0}^{t}\n$$\n由于 $x_0 > 0$ 且系统描述的是衰减过程，对于所有有限时间 $t$，$x(t)$ 将保持为正。因此，我们可以去掉绝对值符号。\n$$\n\\ln(x(t)) - \\ln(x_0) = -kt\n$$\n$$\n\\ln\\left(\\frac{x(t)}{x_0}\\right) = -kt\n$$\n对两边取指数，得到浓度 $x(t)$ 的解：\n$$\nx(t) = x_0 \\exp(-kt)\n$$\n\n**1. 参数灵敏度 $s(t)$ 的推导**\n\n局部参数灵敏度 $s(t)$ 定义为状态变量 $x(t)$ 对参数 $k$ 的偏导数。\n$$\ns(t) = \\frac{\\partial x(t)}{\\partial k}\n$$\n使用上面推导出的解 $x(t) = x_0 \\exp(-kt)$，我们对 $k$ 进行微分，将 $x_0$ 和 $t$ 视为常数。应用链式法则进行微分：\n$$\ns(t) = \\frac{\\partial}{\\partial k} \\left( x_0 \\exp(-kt) \\right) = x_0 \\cdot \\frac{\\partial}{\\partial k} \\left( \\exp(-kt) \\right)\n$$\n$$\ns(t) = x_0 \\cdot \\exp(-kt) \\cdot \\frac{\\partial}{\\partial k}(-kt)\n$$\n$$\ns(t) = x_0 \\exp(-kt) (-t)\n$$\n$$\ns(t) = -t x_0 \\exp(-kt)\n$$\n这就是浓度 $x(t)$ 对速率常数 $k$ 变化的灵敏度表达式。\n\n**2. 参数 $k$ 的费雪信息 (FI) 的推导**\n\n一个参数的费雪信息量化了一组可观测随机变量所携带的关于该参数的信息量。我们将从对数似然函数推导它。\n\n在时间 $t_i$ 的观测值为 $y(t_i) = x(t_i) + \\epsilon_i$，其中 $\\epsilon_i \\sim \\mathcal{N}(0, \\sigma^2)$。这意味着每个观测值 $y_i \\equiv y(t_i)$ 是一个随机变量，服从均值为 $\\mu_i = x(t_i; k) = x_0 \\exp(-kt_i)$、方差为 $\\sigma^2$ 的高斯分布。单个观测值 $y_i$ 的概率密度函数 (PDF) 为：\n$$\np(y_i | k) = \\frac{1}{\\sqrt{2\\pi\\sigma^2}} \\exp\\left( -\\frac{(y_i - x_0 \\exp(-kt_i))^2}{2\\sigma^2} \\right)\n$$\n由于噪声项 $\\epsilon_i$ 是独立的，观测值 $y_i$ 也是独立的。整个 $N$ 个观测值集合的似然函数 $L(k)$ 是各个 PDF 的乘积：\n$$\nL(k) = \\prod_{i=1}^{N} p(y_i | k) = \\left(\\frac{1}{2\\pi\\sigma^2}\\right)^{N/2} \\exp\\left( -\\frac{1}{2\\sigma^2} \\sum_{i=1}^{N} (y_i - x_0 \\exp(-kt_i))^2 \\right)\n$$\n对数似然函数 $\\mathcal{L}(k) = \\ln(L(k))$ 为：\n$$\n\\mathcal{L}(k) = -\\frac{N}{2}\\ln(2\\pi\\sigma^2) - \\frac{1}{2\\sigma^2} \\sum_{i=1}^{N} (y_i - x_0 \\exp(-kt_i))^2\n$$\n费雪信息 $FI(k)$ 定义为对数似然函数关于参数 $k$ 的二阶导数的期望值的负数：\n$$\nFI(k) = -E\\left[ \\frac{\\partial^2 \\mathcal{L}(k)}{\\partial k^2} \\right]\n$$\n首先，我们计算一阶导数（得分函数）：\n$$\n\\frac{\\partial \\mathcal{L}}{\\partial k} = -\\frac{1}{2\\sigma^2} \\sum_{i=1}^{N} 2(y_i - x_0 \\exp(-kt_i)) \\cdot \\left(-\\frac{\\partial}{\\partial k}(x_0 \\exp(-kt_i))\\right)\n$$\n注意到 $\\frac{\\partial}{\\partial k}(x_0 \\exp(-kt_i)) = s(t_i)$，我们有：\n$$\n\\frac{\\partial \\mathcal{L}}{\\partial k} = \\frac{1}{\\sigma^2} \\sum_{i=1}^{N} (y_i - x_0 \\exp(-kt_i)) \\cdot s(t_i)\n$$\n接下来，我们使用乘法法则对得分函数关于 $k$ 求导，计算二阶导数：\n$$\n\\frac{\\partial^2 \\mathcal{L}}{\\partial k^2} = \\frac{1}{\\sigma^2} \\sum_{i=1}^{N} \\frac{\\partial}{\\partial k} \\left[ (y_i - x_0 \\exp(-kt_i)) \\cdot s(t_i) \\right]\n$$\n$$\n\\frac{\\partial^2 \\mathcal{L}}{\\partial k^2} = \\frac{1}{\\sigma^2} \\sum_{i=1}^{N} \\left[ \\left(\\frac{\\partial}{\\partial k}(y_i - x_0 \\exp(-kt_i))\\right) s(t_i) + (y_i - x_0 \\exp(-kt_i)) \\frac{\\partial s(t_i)}{\\partial k} \\right]\n$$\n方括号中的第一项有 $\\frac{\\partial}{\\partial k}(y_i - x_0 \\exp(-kt_i)) = -s(t_i)$。所以求和的第一部分变为 $-s(t_i)^2$。\n$$\n\\frac{\\partial^2 \\mathcal{L}}{\\partial k^2} = \\frac{1}{\\sigma^2} \\sum_{i=1}^{N} \\left[ -s(t_i)^2 + (y_i - x_0 \\exp(-kt_i)) \\frac{\\partial s(t_i)}{\\partial k} \\right]\n$$\n现在我们计算期望。期望是针对数据 $y_i$ 的分布计算的。\n$$\nFI(k) = -E\\left[ \\frac{\\partial^2 \\mathcal{L}}{\\partial k^2} \\right] = -E\\left[ \\frac{1}{\\sigma^2} \\sum_{i=1}^{N} \\left( -s(t_i)^2 + (y_i - x_0 \\exp(-kt_i)) \\frac{\\partial s(t_i)}{\\partial k} \\right) \\right]\n$$\n根据期望的线性性质：\n$$\nFI(k) = -\\frac{1}{\\sigma^2} \\sum_{i=1}^{N} E\\left[ -s(t_i)^2 + (y_i - x_0 \\exp(-kt_i)) \\frac{\\partial s(t_i)}{\\partial k} \\right]\n$$\n项 $s(t_i)^2$ 和 $\\frac{\\partial s(t_i)}{\\partial k}$ 是 $k$ 和 $t_i$ 的确定性函数，不是随机的。唯一的随机变量是 $y_i$。我们注意到 $E[y_i - x_0 \\exp(-kt_i)] = E[\\epsilon_i] = 0$。因此，求和中第二项的期望为零。\n$$\nE\\left[ (y_i - x_0 \\exp(-kt_i)) \\frac{\\partial s(t_i)}{\\partial k} \\right] = E[y_i - x_0 \\exp(-kt_i)] \\cdot \\frac{\\partial s(t_i)}{\\partial k} = 0\n$$\n这极大地简化了 $FI(k)$ 的表达式：\n$$\nFI(k) = -\\frac{1}{\\sigma^2} \\sum_{i=1}^{N} E[-s(t_i)^2] = \\frac{1}{\\sigma^2} \\sum_{i=1}^{N} s(t_i)^2\n$$\n对于加性独立同分布高斯噪声，这是一个通用结果：费雪信息是灵敏度平方和除以方差（乘以逆方差）。\n代入我们得到的 $s(t_i) = -t_i x_0 \\exp(-kt_i)$ 表达式：\n$$\nFI(k) = \\frac{1}{\\sigma^2} \\sum_{i=1}^{N} (-t_i x_0 \\exp(-kt_i))^2\n$$\n$$\nFI(k) = \\frac{1}{\\sigma^2} \\sum_{i=1}^{N} t_i^2 x_0^2 \\exp(-2kt_i)\n$$\n将常数因子提出，得到费雪信息的最终表达式：\n$$\nFI(k) = \\frac{x_0^2}{\\sigma^2} \\sum_{i=1}^{N} t_i^2 \\exp(-2kt_i)\n$$\n\n**3. 实际可辨识性的条件**\n\n如果一个参数可以从有限的、带噪声的数据集中以有限的不确定性进行估计，那么该参数是实际可辨识的。克拉默-拉奥下界 (CRLB) 指出，任何无偏估计量 $\\hat{k}$ 的方差都有一个下界，即费雪信息的倒数：$\\text{Var}(\\hat{k}) \\geq [FI(k)]^{-1}$。\n\n为了使方差有限，CRLB 必须是有限且为正的。这要求费雪信息 $FI(k)$ 是严格为正且有限的。我们来分析我们的表达式：\n$$\nFI(k) = \\frac{x_0^2}{\\sigma^2} \\sum_{i=1}^{N} t_i^2 \\exp(-2kt_i)\n$$\n已知 $x_0 > 0$ 且方差 $\\sigma^2 > 0$，因此前置因子 $\\frac{x_0^2}{\\sigma^2}$ 严格为正。因此，信息量由求和部分决定。\n求和中的每一项形式为 $t_i^2 \\exp(-2kt_i)$。给定 $k > 0$ 和 $t_i \\geq 0$，指数项 $\\exp(-2kt_i)$ 总是正的。项 $t_i^2$ 是非负的。因此，求和中的每一项都是非负的。\n总和为零当且仅当每一项都为零。项 $t_i^2 \\exp(-2kt_i)$ 为零当且仅当 $t_i = 0$。\n因此，$FI(k) = 0$ 当且仅当所有采样时间 $t_i$ 都等于 $0$。如果所有测量都在 $t=0$ 时进行，我们只能观测到初始状态 $x_0$，而无法获得任何关于由 $k$ 控制的动力学信息。在这种情况下，CRLB 是无限的，参数 $k$ 是实际不可辨识的。\n\n为了使 $k$ 实际可辨识，我们必须有 $FI(k) > 0$。如果求和中至少有一项严格为正，则该条件成立。这发生在至少存在一个采样时间 $t_i$ 使得 $t_i > 0$ 的情况下。\n\n**关于可辨识性的结论**：参数 $k$ 是实际可辨识的，当且仅当至少有一次测量是在时间 $t_i > 0$ 时进行的。", "answer": "$$\n\\boxed{\\begin{pmatrix} -t x_0 \\exp(-kt) & \\frac{x_0^2}{\\sigma^2} \\sum_{i=1}^{N} t_i^2 \\exp(-2kt_i) \\end{pmatrix}}\n$$", "id": "3353994"}, {"introduction": "对细胞代谢等大规模网络进行建模是一项重大挑战。图神经网络（Graph Neural Networks, GNNs）等数据驱动方法功能强大，但其预测可能违背基本的物理定律。本练习将指导您实现一种前沿的混合方法，该方法将GNN的预测能力与化学计量平衡和热力学可行性等生物物理约束的严谨性相结合。通过这个动手编程实践，您将学习如何构建既强大又符合物理现实的大规模生物系统模型，弥合机器学习与传统约束建模之间的鸿沟。[@problem_id:3354052]", "problem": "您的任务是实现一个基于原则、感知约束的代谢通量预测器，该预测器使用简化的图神经网络（GNN）并强制执行生物物理可行性。该系统必须在稳态化学计量平衡和热力学方向性约束下运行，这些约束与公认的系统生物学原理一致。\n\n基本原理：\n- 在代谢稳态下，化学计量质量平衡为 $$S \\, v = 0,$$，其中 $S \\in \\mathbb{R}^{m \\times r}$ 是化学计量矩阵，包含 $m$ 种代谢物和 $r$ 个反应，而 $v \\in \\mathbb{R}^{r}$ 是反应通量向量，单位为 mmol/(gDW·h)。\n- 反应 $j$ 的吉布斯自由能变为 $$\\Delta G_j = \\Delta G^{\\circ}_j + R T \\sum_{i=1}^{m} S_{i j} \\ln c_i,$$，其中 $\\Delta G^{\\circ}_j$ 是标准吉布斯自由能变，单位为 kJ/mol，$R$ 是普适气体常数，单位为 kJ/(mol·K)，$T$ 是温度，单位为 K，$c_i$ 是代谢物浓度，单位为 mol/L (M)。热力学上可行的正向通量要求 $\\Delta G_j  0$（而反向通量要求 $\\Delta G_j  0$）。\n\n您将构建一个基于代谢物-反应二分图的单层消息传递 GNN，以生成无约束的通量预测 $\\hat{v}$，然后通过在热力学符号约束和化学计量矩阵的零空间上进行交替投影来强制实现可行性：\n1. 计算代谢物级别特征 $x_i = \\ln c_i$。\n2. 对于反应 $j$，定义底物系数 $s^{\\mathrm{sub}}_{i j} = \\max(0, -S_{i j})$ 和产物系数 $s^{\\mathrm{prod}}_{i j} = \\max(0, S_{i j})$。设 $W^{\\mathrm{in}} \\in \\mathbb{R}^{m \\times r}$ 和 $W^{\\mathrm{out}} \\in \\mathbb{R}^{m \\times r}$ 为可训练权重，$b \\in \\mathbb{R}^{r}$ 为偏置。计算\n   $$h^{\\mathrm{in}}_j = \\sum_{i=1}^{m} s^{\\mathrm{sub}}_{i j} \\, W^{\\mathrm{in}}_{i j} \\, x_i, \\quad h^{\\mathrm{out}}_j = \\sum_{i=1}^{m} s^{\\mathrm{prod}}_{i j} \\, W^{\\mathrm{out}}_{i j} \\, x_i,$$\n   以及原始反应激活值 $$u_j = h^{\\mathrm{in}}_j - h^{\\mathrm{out}}_j + b_j.$$\n   无约束通量预测为 $$\\hat{v}_j = v_{\\max} \\, \\tanh(u_j),$$ 其中 $v_{\\max}  0$ 设置了一个物理上合理的通量尺度，单位为 mmol/(gDW·h)。\n3. 使用上述公式计算 $\\Delta G_j$。\n4. 应用带有容差 $\\delta_G$（单位 kJ/mol）的热力学门控：如果 $(v_j  0 \\wedge \\Delta G_j \\ge -\\delta_G)$ 或 $(v_j  0 \\wedge \\Delta G_j \\le \\delta_G)$，则设置 $v_j=0$；否则保持 $v_j$ 不变。\n5. 投影到 $S$ 的零空间以确保 $S v = 0$：如果 $N \\in \\mathbb{R}^{r \\times k}$ 是一个矩阵，其列构成了 $S$ 零空间的一组标准正交基，则设置 $$v \\leftarrow N (N^{\\top} v).$$ 如果 $k=0$（满列秩），则设置 $v \\leftarrow 0$。\n6. 交替执行步骤 4 和 5，直到收敛或达到固定的迭代预算。\n\n您的程序必须实现此过程，并评估三个测试用例，这些用例涵盖了典型行为、热力学边界情况和化学计量边缘情况：\n\n常量：\n- 使用 $R = 8.31446261815324 \\times 10^{-3}$ kJ/(mol·K)。\n- 使用 $\\delta_G = 10^{-3}$ kJ/mol 用于热力学门控。\n- 使用 $10^{-12}$ 的数值容差通过奇异值分解来检测零空间。\n\n测试套件：\n- 案例 1（循环，非平凡零空间）：\n  - $m=3$， $r=3$， $$S = \\begin{bmatrix} -1  0  1 \\\\ 1  -1  0 \\\\ 0  1  -1 \\end{bmatrix}.$$\n  - 浓度（单位 M）：$c = [10^{-3}, 10^{-4}, 10^{-6}]$。\n  - 温度 $T = 310$ K。\n  - 标准吉布斯自由能：$\\Delta G^{\\circ} = [-7.0, -3.0, -20.0]$ kJ/mol。\n  - 权重 $W^{\\mathrm{in}}$：\n    $$\\begin{bmatrix} 1.0  0.5  0.2 \\\\ 0.7  1.2  0.3 \\\\ 0.3  0.8  1.1 \\end{bmatrix}, \\quad W^{\\mathrm{out}} = \\begin{bmatrix} 0.2  0.1  0.2 \\\\ 0.1  0.2  0.1 \\\\ 0.05  0.3  0.2 \\end{bmatrix}, \\quad b = [0.10, 0.05, 0.08], \\quad v_{\\max} = 10.0 \\text{ mmol/(gDW·h)}.$$\n- 案例 2（反应 $2$ 处于热力学边界）：\n  - $S$、$c$、$T$、$W^{\\mathrm{in}}$、$W^{\\mathrm{out}}$、$b$、$v_{\\max}$ 与案例 1 相同。\n  - 标准吉布斯自由能：$\\Delta G^{\\circ} = [-7.0, 11.869, -20.0]$ kJ/mol。这使得在给定的 $c$ 和 $T$ 条件下，反应 $2$ 的 $\\Delta G_2 \\approx 0$。\n- 案例 3（满列秩，平凡零空间）：\n  - $m=3$， $r=3$， $$S = \\begin{bmatrix} -1  -1  1 \\\\ 1  0  -1 \\\\ -1  1  0 \\end{bmatrix}.$$\n  - 浓度（单位 M）：$c = [10^{-3}, 2 \\times 10^{-4}, 5 \\times 10^{-4}]$。\n  - 温度 $T = 310$ K。\n  - 标准吉布斯自由能：$\\Delta G^{\\circ} = [-7.0, -2.5, -1.0]$ kJ/mol。\n  - 权重 $W^{\\mathrm{in}}$：\n    $$\\begin{bmatrix} 0.9  0.4  0.6 \\\\ 0.5  0.7  1.1 \\\\ 0.2  0.3  0.8 \\end{bmatrix}, \\quad W^{\\mathrm{out}} = \\begin{bmatrix} 0.1  0.2  0.3 \\\\ 0.2  0.1  0.2 \\\\ 0.1  0.3  0.1 \\end{bmatrix}, \\quad b = [0.06, 0.02, 0.04], \\quad v_{\\max} = 8.0 \\text{ mmol/(gDW·h)}.$$\n\n输出规范：\n- 对于每个案例，在交替投影收敛（或达到固定迭代预算）后，计算：\n  1. 质量平衡残差 $$\\|S v\\|_2$$，单位为 mmol/(gDW·h)。\n  2. 满足热力学符号法则的反应比例，定义为满足 $v_j = 0$ 或 $v_j \\cdot \\Delta G_j \\le -\\delta_G$ 的反应数量除以 $r$（表示为 $[0,1]$ 范围内的小数）。\n- 您的程序应生成单行输出，其中包含六个结果，格式为逗号分隔的列表并用方括号括起，顺序为 [residual_case1,fraction_case1,residual_case2,fraction_case2,residual_case3,fraction_case3]。所有与通量相关的量都必须以 mmol/(gDW·h) 为单位，比例必须是小数。", "solution": "该问题要求实现一种计算方法，用于预测符合基本生物物理定律的代谢通量。该方法是一个两阶段过程：首先，使用简化的图神经网络（GNN）生成初始通量预测；其次，通过迭代过程对此预测进行精炼，以强制执行化学计量和热力学约束。这种基于原则的方法确保最终的通量向量在物理上和生物学上都是合理的。整个过程将使用三个不同的测试用例进行验证。\n\n基本原理是稳态下的化学计量质量平衡（由线性系统 $S v = 0$ 给出）和源自吉布斯自由能变的热力学方向性约束（对于正向通量 $v_j  0$ 要求 $\\Delta G_j  0$）。这里，$S \\in \\mathbb{R}^{m \\times r}$ 是一个包含 $m$ 种代谢物和 $r$ 个反应的系统的化学计量矩阵，$v \\in \\mathbb{R}^{r}$ 是反应通量向量。\n\n流程如下：\n\n首先，预测一个初始的、无约束的通量向量 $\\hat{v}$。该预测基于一个在代谢物和反应的二分图上定义的单层消息传递 GNN 模型。模型的输入特征是代谢物浓度的对数，即 $x_i = \\ln c_i$。GNN 根据其底物和产物的特征为每个反应 $j$ 计算一个激活值 $u_j$。底物和产物的化学计量系数通过定义 $s^{\\mathrm{sub}}_{i j} = \\max(0, -S_{i j})$ 和 $s^{\\mathrm{prod}}_{i j} = \\max(0, S_{i j})$ 来分离。GNN 层的变换则为：\n$$h^{\\mathrm{in}}_j = \\sum_{i=1}^{m} s^{\\mathrm{sub}}_{i j} \\, W^{\\mathrm{in}}_{i j} \\, x_i$$\n$$h^{\\mathrm{out}}_j = \\sum_{i=1}^{m} s^{\\mathrm{prod}}_{i j} \\, W^{\\mathrm{out}}_{i j} \\, x_i$$\n其中 $W^{\\mathrm{in}}$ 和 $W^{\\mathrm{out}}$ 是可训练的权重矩阵。反应 $j$ 的净激活值为 $u_j = h^{\\mathrm{in}}_j - h^{\\mathrm{out}}_j + b_j$，其中 $b_j$ 是一个偏置项。该激活值通过双曲正切函数转换为初始通量预测 $\\hat{v}_j$，并由一个最大合理通量 $v_{\\max}$ 进行缩放：\n$$\\hat{v}_j = v_{\\max} \\, \\tanh(u_j)$$\n\n其次，使用一种称为交替投影的迭代方法对初始预测 $\\hat{v}$ 进行精炼，以满足生物物理约束。将通量向量初始化为 $v = \\hat{v}$，然后在一个固定的迭代次数内，反复对其应用两个类似投影的步骤。\n\n第一步强制执行热力学可行性。每个反应的吉布斯自由能变 $\\Delta G_j$ 由标准吉布斯自由能 $\\Delta G^{\\circ}_j$、温度 $T$、气体常数 $R$ 和代谢物浓度 $c_i$ 计算得出：\n$$\\Delta G_j = \\Delta G^{\\circ}_j + R T \\sum_{i=1}^{m} S_{i j} \\ln c_i$$\n如果一个通量 $v_j$ 的流动方向与热力学驱动力相反（即，逆着一个正的 $\\Delta G_j$ 流动，或反向通量逆着一个负的 $\\Delta G_j$ 流动），则该通量在热力学上是不可行的。一个“门控”操作通过将任何此类不可行通量设置为零来强制执行此约束。一个小的容差 $\\delta_G$ 用于处理接近平衡的反应：如果 $(v_j  0 \\land \\Delta G_j \\ge -\\delta_G)$ 或 $(v_j  0 \\land \\Delta G_j \\le \\delta_G)$，则将 $v_j$ 设置为 $0$。\n\n第二步强制执行稳态质量平衡条件 $S v = 0$。这要求通量向量 $v$ 必须位于化学计量矩阵 $S$ 的零空间内。通过将当前通量向量 $v$ 投影到该零空间来强制执行此约束。首先计算零空间的一组标准正交基，通常通过对 $S$ 进行奇异值分解（SVD）来实现。如果矩阵 $N \\in \\mathbb{R}^{r \\times k}$ 的列构成了这样一组基（其中 $k = \\dim(\\text{null}(S))$），则投影算子为 $P = N N^{\\top}$。然后将通量向量更新为 $v \\leftarrow P v$。在 $S$ 是满列秩的特殊情况下，其零空间是平凡的（只包含零向量），投影会正确地将任何向量映射到 $v = 0$。\n\n这两个步骤——热力学门控和零空间投影——交替应用。经过固定次数的迭代后，得到的向量 $v$ 是一个同时遵循代谢系统化学计量和热力学约束的通量分布。\n\n最后，使用两个指标评估所得通量向量 $v$ 的质量：质量平衡残差的欧几里得范数 $\\|S v\\|_2$（应接近于零），以及满足热力学符号法则的反应比例，其定义为满足 $v_j = 0$ 或条件 $v_j \\cdot \\Delta G_j \\le -\\delta_G$ 的反应所占的比例。此过程将系统地应用于所有指定的测试用例。", "answer": "```python\nimport numpy as np\nfrom scipy.linalg import null_space\n\ndef solve():\n    \"\"\"\n    Implements a GNN-based flux predictor with biophysical constraint enforcement\n    and evaluates it on three test cases.\n    \"\"\"\n\n    # Define universal constants\n    R_CONST = 8.31446261815324e-3  # Universal gas constant in kJ/(mol·K)\n    DELTA_G_TOLERANCE = 1e-3  # Thermodynamic gating tolerance in kJ/mol\n    SVD_TOLERANCE = 1e-12  # Tolerance for nullspace computation\n    ITERATION_BUDGET = 100  # Fixed iteration budget for alternating projections\n\n    test_cases = [\n        {\n            \"name\": \"Case 1 (cycle, nontrivial nullspace)\",\n            \"S\": np.array([[-1.0, 0.0, 1.0], [1.0, -1.0, 0.0], [0.0, 1.0, -1.0]]),\n            \"c\": np.array([1e-3, 1e-4, 1e-6]),\n            \"T\": 310.0,\n            \"dG_standard\": np.array([-7.0, -3.0, -20.0]),\n            \"W_in\": np.array([[1.0, 0.5, 0.2], [0.7, 1.2, 0.3], [0.3, 0.8, 1.1]]),\n            \"W_out\": np.array([[0.2, 0.1, 0.2], [0.1, 0.2, 0.1], [0.05, 0.3, 0.2]]),\n            \"b\": np.array([0.10, 0.05, 0.08]),\n            \"v_max\": 10.0,\n        },\n        {\n            \"name\": \"Case 2 (boundary thermodynamics)\",\n            \"S\": np.array([[-1.0, 0.0, 1.0], [1.0, -1.0, 0.0], [0.0, 1.0, -1.0]]),\n            \"c\": np.array([1e-3, 1e-4, 1e-6]),\n            \"T\": 310.0,\n            \"dG_standard\": np.array([-7.0, 11.869, -20.0]),\n            \"W_in\": np.array([[1.0, 0.5, 0.2], [0.7, 1.2, 0.3], [0.3, 0.8, 1.1]]),\n            \"W_out\": np.array([[0.2, 0.1, 0.2], [0.1, 0.2, 0.1], [0.05, 0.3, 0.2]]),\n            \"b\": np.array([0.10, 0.05, 0.08]),\n            \"v_max\": 10.0,\n        },\n        {\n            \"name\": \"Case 3 (full column rank, trivial nullspace)\",\n            \"S\": np.array([[-1.0, -1.0, 1.0], [1.0, 0.0, -1.0], [-1.0, 1.0, 0.0]]),\n            \"c\": np.array([1e-3, 2e-4, 5e-4]),\n            \"T\": 310.0,\n            \"dG_standard\": np.array([-7.0, -2.5, -1.0]),\n            \"W_in\": np.array([[0.9, 0.4, 0.6], [0.5, 0.7, 1.1], [0.2, 0.3, 0.8]]),\n            \"W_out\": np.array([[0.1, 0.2, 0.3], [0.2, 0.1, 0.2], [0.1, 0.3, 0.1]]),\n            \"b\": np.array([0.06, 0.02, 0.04]),\n            \"v_max\": 8.0,\n        },\n    ]\n\n    results = []\n\n    for case in test_cases:\n        S, c, T, dG_standard = case[\"S\"], case[\"c\"], case[\"T\"], case[\"dG_standard\"]\n        W_in, W_out, b, v_max = case[\"W_in\"], case[\"W_out\"], case[\"b\"], case[\"v_max\"]\n        \n        m, r = S.shape\n\n        # Step 1: Compute metabolite-level features\n        x = np.log(c)\n\n        # Step 2: Compute GNN unconstrained flux prediction\n        s_sub = np.maximum(0, -S)\n        s_prod = np.maximum(0, S)\n        \n        h_in = (s_sub * W_in).T @ x\n        h_out = (s_prod * W_out).T @ x\n        \n        u = h_in - h_out + b\n        v_hat = v_max * np.tanh(u)\n\n        # Step 3: Compute Gibbs free energy change for each reaction\n        delta_G = dG_standard + R_CONST * T * (S.T @ x)\n\n        # Pre-compute nullspace projection matrix for Step 5\n        N = null_space(S, rcond=SVD_TOLERANCE)\n        # If nullspace is trivial (k=0), N has shape (r, 0), and P becomes a zero matrix.\n        if N.shape[1] == 0:\n            P = np.zeros((r, r))\n        else:\n            P = N @ N.T\n\n        # Steps 4, 5, 6: Alternate projections\n        v = v_hat.copy()\n        for _ in range(ITERATION_BUDGET):\n            # Step 4: Thermodynamic gating\n            v_gated = v.copy()\n            \n            mask_pos_violation = (v > 0)  (delta_G >= -DELTA_G_TOLERANCE)\n            mask_neg_violation = (v  0)  (delta_G = DELTA_G_TOLERANCE)\n            \n            v_gated[mask_pos_violation | mask_neg_violation] = 0.0\n            \n            # Step 5: Project onto the nullspace of S\n            v = P @ v_gated\n\n        # --- Output Calculation ---\n        # 1. Mass-balance residual\n        residual = np.linalg.norm(S @ v)\n        results.append(residual)\n\n        # 2. Fraction of reactions satisfying the thermodynamic sign rule\n        # A reaction is satisfied if flux is zero or if v_j * dG_j = -delta_G_tol\n        # `atol` is used for robust floating point comparison to zero\n        zero_flux_mask = np.isclose(v, 0, atol=1e-9)\n        thermo_rule_mask = (v * delta_G) = -DELTA_G_TOLERANCE\n        \n        satisfied_reaction_count = np.sum(zero_flux_mask | thermo_rule_mask)\n        fraction_thermo_satisfied = satisfied_reaction_count / r\n        results.append(fraction_thermo_satisfied)\n\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3354052"}]}