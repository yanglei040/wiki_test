{"hands_on_practices": [{"introduction": "不同的分子动力学软件，如LAMMPS和AMBER，对于1-4相互作用的缩放有着不同的表示约定。这项练习 [@problem_id:3393161] 提供了一个具体的挑战：推导并应用这两种流行约定之间的转换公式。完成这项练习将加深你对不同记法背后是相同物理模型的理解。", "problem": "考虑一个使用分子动力学（MD）模拟的线性烷烃链段，其成对非键相互作用由 Lennard–Jones (LJ) 和库仑静电相互作用组成。在分离距离为 $r_{ij}$ 时，对能量是 LJ 贡献 $E_{ij}^{\\mathrm{LJ}}(r_{ij})$ 和库仑贡献 $E_{ij}^{\\mathrm{C}}(r_{ij})$ 的和，其中 $E_{ij}^{\\mathrm{LJ}}(r_{ij}) = 4 \\epsilon_{ij} \\left[ \\left( \\frac{\\sigma_{ij}}{r_{ij}} \\right)^{12} - \\left( \\frac{\\sigma_{ij}}{r_{ij}} \\right)^{6} \\right]$ 且 $E_{ij}^{\\mathrm{C}}(r_{ij}) = k_{e} \\frac{q_{i} q_{j}}{r_{ij}}$。假设标准的成键项（键伸缩和角弯曲）被分开处理，并且不改变非键对能量的定义。\n\n在“大规模原子/分子并行模拟器”（Large-scale Atomic/Molecular Massively Parallel Simulator, LAMMPS）中，用于缩放或排除成键拓扑近邻之间的成对相互作用的特殊键权重，根据拓扑分离（$1$–$2$、$1$–$3$ 和 $1$–$4$），以乘法方式应用于对能量。对于该体系，LAMMPS 的设置为\n“special_bonds lj/coul $0.0$ $0.0$ $0.4$ $0.0$ $0.0$ $0.5$，”\n这意味着 $1$–$2$、$1$–$3$、$1$–$4$ 相互作用的 LJ 权重分别为 $w_{12}^{\\mathrm{LJ}} = 0$、$w_{13}^{\\mathrm{LJ}} = 0$、$w_{14}^{\\mathrm{LJ}} = 0.4$，库仑权重分别为 $w_{12}^{\\mathrm{C}} = 0$、$w_{13}^{\\mathrm{C}} = 0$、$w_{14}^{\\mathrm{C}} = 0.5$。\n\n在“能量优化辅助模型构建”（Assisted Model Building with Energy Refinement, AMBER）力场家族中，$1$–$4$ 非键缩放的常规表示法使用两个参数：用于 LJ 的 $\\mathrm{SCNB}$ 和用于静电的 $\\mathrm{SCEE}$，使得 $1$–$4$ LJ 能量按因子 $1/\\mathrm{SCNB}$ 缩放，$1$–$4$ 库仑能量按因子 $1/\\mathrm{SCEE}$ 缩放，而 $1$–$2$ 和 $1$–$3$ 的非键相互作用则被排除（即缩放为零）。\n\n从上述定义以及 LAMMPS “special_bonds” 权重作为应用于拓扑分离为 $1$–$2$、$1$–$3$ 和 $1$–$4$ 的 $E_{ij}^{\\mathrm{LJ}}$ 和 $E_{ij}^{\\mathrm{C}}$ 上的乘法因子的含义出发，通过令两种约定中的 $1$–$4$ 能量贡献相等，推导出 LAMMPS $1$–$4$ 权重与 AMBER $\\mathrm{SCNB}$ 和 $\\mathrm{SCEE}$ 参数之间的映射关系。确定 LAMMPS 设置所隐含的对 $1$–$2$ 和 $1$–$3$ 相互作用的明确排除，然后根据给定的 LAMMPS 权重 $w_{14}^{\\mathrm{LJ}} = 0.4$ 和 $w_{14}^{\\mathrm{C}} = 0.5$ 计算 $\\mathrm{SCNB}$ 和 $\\mathrm{SCEE}$ 的数值。\n\n以单行矩阵的形式提供最终答案，其中首先包含 $\\mathrm{SCNB}$，然后是 $\\mathrm{SCEE}$。无需进行四舍五入。", "solution": "问题要求推导在 LAMMPS 分子动力学软件包和 AMBER 力场家族中使用的 $1$–$4$ 非键相互作用缩放约定之间的映射关系。我们首先根据所提供的定义，将每种约定的能量表达式形式化。\n\n两个原子 $i$ 和 $j$ 之间，相隔距离为 $r_{ij}$ 的总非键对能量，由一个 Lennard-Jones (LJ) 项和一个库仑 (C) 项之和给出：\n$$\nE_{ij}(r_{ij}) = E_{ij}^{\\mathrm{LJ}}(r_{ij}) + E_{ij}^{\\mathrm{C}}(r_{ij})\n$$\n其中\n$$\nE_{ij}^{\\mathrm{LJ}}(r_{ij}) = 4 \\epsilon_{ij} \\left[ \\left( \\frac{\\sigma_{ij}}{r_{ij}} \\right)^{12} - \\left( \\frac{\\sigma_{ij}}{r_{ij}} \\right)^{6} \\right]\n$$\n且\n$$\nE_{ij}^{\\mathrm{C}}(r_{ij}) = k_{e} \\frac{q_{i} q_{j}}{r_{ij}}\n$$\n\n问题指明了对于共价键合的拓扑近邻原子，这些相互作用是如何被修改的，特别是对于 $1$–$2$ 对（直接键合）、$1$–$3$ 对（由两个键分隔）和 $1$–$4$ 对（由三个键分隔）。\n\n首先，我们来分析给定的 LAMMPS 设置的含义。命令 `special_bonds lj/coul 0.0 0.0 0.4 0.0 0.0 0.5` 分别指定了 LJ 项和库仑项的 $1$–$2$、$1$–$3$ 和 $1$–$4$ 相互作用的乘法权重。\n权重如下：\n- 对于 Lennard-Jones (LJ)：$w_{12}^{\\mathrm{LJ}} = 0.0$，$w_{13}^{\\mathrm{LJ}} = 0.0$，$w_{14}^{\\mathrm{LJ}} = 0.4$。\n- 对于库仑 (C)：$w_{12}^{\\mathrm{C}} = 0.0$，$w_{13}^{\\mathrm{C}} = 0.0$，$w_{14}^{\\mathrm{C}} = 0.5$。\n\n权重 $w_{12}^{\\mathrm{LJ}} = 0.0$、$w_{13}^{\\mathrm{LJ}} = 0.0$、$w_{12}^{\\mathrm{C}} = 0.0$ 和 $w_{13}^{\\mathrm{C}} = 0.0$ 表明，对于处于 $1$–$2$ 或 $1$–$3$ 拓扑关系的原子对，LJ 和库仑非键相互作用都被完全排除（即缩放为零）。\n\n对于一对互为 $1$–$4$ 近邻的原子 $i$ 和 $j$，在 LAMMPS 约定中，总非键相互作用能 $E_{1-4}^{\\mathrm{LAMMPS}}$ 通过将相应的权重应用于标准对势来给出：\n$$\nE_{1-4}^{\\mathrm{LAMMPS}}(r_{ij}) = w_{14}^{\\mathrm{LJ}} E_{ij}^{\\mathrm{LJ}}(r_{ij}) + w_{14}^{\\mathrm{C}} E_{ij}^{\\mathrm{C}}(r_{ij})\n$$\n\n接下来，我们形式化 AMBER 的约定。问题陈述了在 AMBER 中，$1$–$2$ 和 $1$–$3$ 的非键相互作用被排除。这与所提供的 LAMMPS 设置完全一致，其中相应的权重均为零。对于 $1$–$4$ 相互作用，AMBER 对 LJ 部分使用缩放参数 $\\mathrm{SCNB}$，对静电部分使用 $\\mathrm{SCEE}$。缩放后的能量定义为：\n$$\nE_{1-4}^{\\mathrm{AMBER}}(r_{ij}) = \\frac{1}{\\mathrm{SCNB}} E_{ij}^{\\mathrm{LJ}}(r_{ij}) + \\frac{1}{\\mathrm{SCEE}} E_{ij}^{\\mathrm{C}}(r_{ij})\n$$\n\n为了找到两种约定之间的映射关系，我们令 $1$–$4$ 相互作用能的表达式相等：\n$$\nE_{1-4}^{\\mathrm{LAMMPS}}(r_{ij}) = E_{1-4}^{\\mathrm{AMBER}}(r_{ij})\n$$\n代入详细表达式可得：\n$$\nw_{14}^{\\mathrm{LJ}} E_{ij}^{\\mathrm{LJ}}(r_{ij}) + w_{14}^{\\mathrm{C}} E_{ij}^{\\mathrm{C}}(r_{ij}) = \\frac{1}{\\mathrm{SCNB}} E_{ij}^{\\mathrm{LJ}}(r_{ij}) + \\frac{1}{\\mathrm{SCEE}} E_{ij}^{\\mathrm{C}}(r_{ij})\n$$\n这个方程必须对任何有效的参数集（$\\epsilon_{ij}$、$\\sigma_{ij}$、$q_i$、$q_j$）和任何距离 $r_{ij}$ 都成立。由于 $E_{ij}^{\\mathrm{LJ}}$ 和 $E_{ij}^{\\mathrm{C}}$ 是函数无关的，为了使等式普遍成立，方程两边的 $E_{ij}^{\\mathrm{LJ}}$ 和 $E_{ij}^{\\mathrm{C}}$ 项的系数必须相等。\n\n令 LJ 项的系数相等：\n$$\nw_{14}^{\\mathrm{LJ}} = \\frac{1}{\\mathrm{SCNB}}\n$$\n令库仑项的系数相等：\n$$\nw_{14}^{\\mathrm{C}} = \\frac{1}{\\mathrm{SCEE}}\n$$\n从这两个方程，我们可以用 LAMMPS 权重来求解 AMBER 参数 $\\mathrm{SCNB}$ 和 $\\mathrm{SCEE}$：\n$$\n\\mathrm{SCNB} = \\frac{1}{w_{14}^{\\mathrm{LJ}}}\n$$\n$$\n\\mathrm{SCEE} = \\frac{1}{w_{14}^{\\mathrm{C}}}\n$$\n问题提供了 LAMMPS 权重的数值：$w_{14}^{\\mathrm{LJ}} = 0.4$ 和 $w_{14}^{\\mathrm{C}} = 0.5$。我们代入这些值来计算 $\\mathrm{SCNB}$ 和 $\\mathrm{SCEE}$。\n\n对于 $\\mathrm{SCNB}$：\n$$\n\\mathrm{SCNB} = \\frac{1}{0.4} = \\frac{1}{4/10} = \\frac{10}{4} = 2.5\n$$\n对于 $\\mathrm{SCEE}$：\n$$\n\\mathrm{SCEE} = \\frac{1}{0.5} = \\frac{1}{1/2} = 2\n$$\n计算出的值为 $\\mathrm{SCNB} = 2.5$ 和 $\\mathrm{SCEE} = 2.0$。值得注意的是，这些是许多 AMBER 力场（例如，ff94、ff99、ff14SB）的标准值。问题还要求确定对 $1-2$ 和 $1-3$ 对的排除。如前所述，LAMMPS 权重 $w_{12}^{\\mathrm{LJ}} = 0.0$、$w_{13}^{\\mathrm{LJ}} = 0.0$、$w_{12}^{\\mathrm{C}} = 0.0$ 和 $w_{13}^{\\mathrm{C}} = 0.0$ 意味着对这些对的非键相互作用的完全排除，这与所描述的 AMBER 约定相匹配。\n\n最终答案应以单行矩阵的形式提供，其中先包含 $\\mathrm{SCNB}$，后包含 $\\mathrm{SCEE}$。", "answer": "$$\n\\boxed{\\begin{pmatrix} 2.5  2 \\end{pmatrix}}\n$$", "id": "3393161"}, {"introduction": "在理解了缩放因子的基础上，我们现在将探讨它们在确保物理真实性方面扮演的关键角色。这个思想实验 [@problem_id:3393163] 探究了使用一个不符合物理规律的负缩放因子所导致的灾难性后果。它展示了这些参数如何通过确保原子在短距离内存在排斥核心来维持模拟的稳定性。", "problem": "一个分子动力学模拟使用了一个力场，其中由三个键连接的原子（在二面角中所谓的“1-4对”）之间的非键相互作用，通过一个统一应用于Lennard–Jones (LJ) 和库仑贡献的单一因子 $s_{14}$ 进行缩放。对于一个1-4对 $(i,j)$，势能作为距离 $r$ 的函数为\n$$\nE_{14}(r) \\;=\\; s_{14}\\,\\Big[\\,V_{\\mathrm{LJ}}(r;\\epsilon_{ij},\\sigma_{ij}) \\;+\\; V_{\\mathrm{C}}(r;q_i,q_j)\\,\\Big],\n$$\n其中Lennard–Jones势为\n$$\nV_{\\mathrm{LJ}}(r;\\epsilon_{ij},\\sigma_{ij}) \\;=\\; 4\\,\\epsilon_{ij}\\,\\Big[ \\left(\\frac{\\sigma_{ij}}{r}\\right)^{12} - \\left(\\frac{\\sigma_{ij}}{r}\\right)^6 \\Big],\n$$\n而库仑势为\n$$\nV_{\\mathrm{C}}(r;q_i,q_j) \\;=\\; \\frac{k_e\\,q_i\\,q_j}{\\epsilon_r\\,r}.\n$$\n这里，$\\epsilon_{ij} > 0$ 和 $\\sigma_{ij} > 0$ 是该原子对的Lorentz–Berthelot组合Lennard–Jones参数，$k_e$ 是库仑常数，$\\epsilon_r$ 是相对介电常数。一个用户意外地设置了 $s_{14} = -0.5$。\n\n从上述函数形式和当 $r \\to 0$ 时势的极限行为出发，推断此选择的定性和定量后果。下列哪些陈述是正确的？\n\nA. 对于足够小的 $r$，净1-4势 $E_{14}(r)$ 变得无下界，导致灾难性的吸引和1-4对的坍塌。\n\nB. 即使 $s_{14} < 0$，在小 $r$ 处的总1-4力仍然是向外的（排斥力），因为当 $r \\to 0$ 时，库仑项主导Lennard–Jones项。\n\nC. 一个稳健的验证检查是强制Lennard–Jones部分的 $s_{14} \\ge 0$（或者如果使用单独的缩放因子，则更一般地为 $s_{14,\\mathrm{LJ}} \\ge 0$），因为 $r^{-12}$ 排斥项必须有一个正的前因子以防止坍塌。\n\nD. 通过减小积分时间步长来进行数值稳定化，可以可靠地防止由 $s_{14} < 0$ 引起的灾难性吸引，从而在不改变 $s_{14}$ 的情况下使模拟在物理上稳定。\n\nE. 作为运行前的验证，在一个物理相关的范围内绘制 $E_{14}(r)$ 并验证当 $r \\to 0$ 时 $E_{14}(r)$ 为正且发散到 $+\\infty$，是捕捉错误指定的 $s_{14}$ 的一个可靠诊断方法。\n\nF. 在Lennard–Jones势的最小值点 $r_{\\min} = 2^{1/6}\\sigma_{ij}$ 处，$E_{14}(r_{\\min})$ 的符号不受 $s_{14}$ 符号的影响，因为该最小值点仅由 $V_{\\mathrm{LJ}}(r)$ 的形状决定。", "solution": "在尝试解答之前，对问题陈述进行验证。\n\n### 第1步：提取已知条件\n- 1-4对 $(i,j)$ 的势能是 $E_{14}(r) \\;=\\; s_{14}\\,\\Big[\\,V_{\\mathrm{LJ}}(r;\\epsilon_{ij},\\sigma_{ij}) \\;+\\; V_{\\mathrm{C}}(r;q_i,q_j)\\,\\Big]$。\n- Lennard-Jones (LJ) 势是 $V_{\\mathrm{LJ}}(r;\\epsilon_{ij},\\sigma_{ij}) \\;=\\; 4\\,\\epsilon_{ij}\\,\\Big[ \\left(\\frac{\\sigma_{ij}}{r}\\right)^{12} - \\left(\\frac{\\sigma_{ij}}{r}\\right)^6 \\Big]$。\n- 库仑势是 $V_{\\mathrm{C}}(r;q_i,q_j) \\;=\\; \\frac{k_e\\,q_i\\,q_j}{\\epsilon_r\\,r}$。\n- 参数定义为：$\\epsilon_{ij} > 0$，$\\sigma_{ij} > 0$，$k_e$ 是库仑常数，$\\epsilon_r$ 是相对介电常数，$q_i, q_j$ 是原子局部电荷。\n- 缩放因子指定为 $s_{14} = -0.5$。\n- 任务是基于函数形式和当 $r \\to 0$ 时的极限行为来分析此选择的后果。\n\n### 第2步：使用提取的已知条件进行验证\n- **科学依据**：该问题很好地基于分子力学和分子动力学模拟的原理。Lennard-Jones势和库仑势的函数形式是标准的。对1-4对相互作用进行缩放的概念是许多广泛使用的力场（例如，AMBER, CHARMM, OPLS）的共同特征。用户错误指定参数的情景是计算化学中一个现实且重要的实际问题。\n- **适定性**：该问题在数学上是适定的。它提供了明确的函数和参数值，并要求分析所得势能函数的行为。基于所提供的信息，可以进行唯一且稳定的分析。\n- **客观性**：该问题以精确、客观和技术性的语言陈述，没有歧义或主观论断。\n\n### 第3步：结论与行动\n问题陈述是有效的。这是一个关于分子力学势稳定性的科学上合理且适定的问题。将继续进行分析。\n\n### 物理后果推导\n\n1-4相互作用的总势能由下式给出：\n$$\nE_{14}(r) = s_{14} \\left( V_{\\mathrm{LJ}}(r) + V_{\\mathrm{C}}(r) \\right)\n$$\n代入给定的函数形式和错误的缩放因子 $s_{14} = -0.5$：\n$$\nE_{14}(r) = -0.5 \\left( 4\\epsilon_{ij}\\left[ \\left(\\frac{\\sigma_{ij}}{r}\\right)^{12} - \\left(\\frac{\\sigma_{ij}}{r}\\right)^6 \\right] + \\frac{k_e q_i q_j}{\\epsilon_r r} \\right)\n$$\n为了分析系统的稳定性，我们必须考察当原子间距离 $r$ 趋近于零（即 $r \\to 0$）时势能的行为。这个极限决定了原子是否会因相互坍塌而被阻止。\n\n让我们考察当 $r \\to 0$ 时括号内的各项：\n- Lennard-Jones项是 $V_{\\mathrm{LJ}}(r) = 4\\epsilon_{ij}\\sigma_{ij}^{12} r^{-12} - 4\\epsilon_{ij}\\sigma_{ij}^{6} r^{-6}$。\n- 库仑项是 $V_{\\mathrm{C}}(r) = \\left(\\frac{k_e q_i q_j}{\\epsilon_r}\\right) r^{-1}$。\n\n当 $r \\to 0$ 时，$r$ 的最高阶负幂次项将主导整个表达式。比较各项的幂次，$r^{-12}$ 同时主导 $r^{-6}$ 和 $r^{-1}$。因此，括号内表达式的极限行为由Lennard-Jones势中的 $r^{-12}$ 项决定。\n$$\n\\lim_{r \\to 0} \\Big[ V_{\\mathrm{LJ}}(r) + V_{\\mathrm{C}}(r) \\Big] = \\lim_{r \\to 0} \\left( 4\\epsilon_{ij}\\sigma_{ij}^{12} r^{-12} \\right)\n$$\n由于 $\\epsilon_{ij} > 0$ 和 $\\sigma_{ij} > 0$，项 $4\\epsilon_{ij}\\sigma_{ij}^{12}$ 是一个正常数。因此，极限为：\n$$\n\\lim_{r \\to 0} \\Big[ V_{\\mathrm{LJ}}(r) + V_{\\mathrm{C}}(r) \\Big] = +\\infty\n$$\n这种正向发散是短程排斥力（或“排斥墙”）的来源，在标准、正确参数化的力场中（其中 $s_{14} > 0$），它能防止原子坍塌。\n\n现在，我们应用错误的缩放因子 $s_{14} = -0.5$ 来求总的1-4势 $E_{14}(r)$ 的极限：\n$$\n\\lim_{r \\to 0} E_{14}(r) = \\lim_{r \\to 0} \\left( -0.5 \\Big[ V_{\\mathrm{LJ}}(r) + V_{\\mathrm{C}}(r) \\Big] \\right) = -0.5 \\times \\left( \\lim_{r \\to 0} \\Big[ V_{\\mathrm{LJ}}(r) + V_{\\mathrm{C}}(r) \\Big] \\right)\n$$\n$$\n\\lim_{r \\to 0} E_{14}(r) = -0.5 \\times (+\\infty) = -\\infty\n$$\n当 $r \\to 0$ 时，势能发散到 $-\\infty$，这表示势能无下界。这意味着在零距离处存在无限大的吸引力。任何受此势能控制的原子对都将不可避免地相互加速，导致奇点、数值溢出和模拟中分子结构的灾难性坍塌。\n\n力是势能的负梯度：$F_{14}(r) = - \\frac{dE_{14}(r)}{dr}$。对于小的 $r$，$E_{14}(r)$ 中的主导项是 $E_{14}(r) \\approx -0.5 (4\\epsilon_{ij}\\sigma_{ij}^{12}r^{-12}) = -2\\epsilon_{ij}\\sigma_{ij}^{12}r^{-12}$。\n对应的力是：\n$$\nF_{14}(r) \\approx - \\frac{d}{dr}(-2\\epsilon_{ij}\\sigma_{ij}^{12}r^{-12}) = -(-12)(-2\\epsilon_{ij}\\sigma_{ij}^{12})r^{-13} = -24\\epsilon_{ij}\\sigma_{ij}^{12}r^{-13}\n$$\n由于 $\\epsilon_{ij} > 0$ 和 $\\sigma_{ij} > 0$，对于 $r > 0$，力 $F_{14}(r)$ 是负的。按照惯例，负力是吸引力（指向减小 $r$ 的方向）。这证实了在短程存在灾难性的吸引。\n\n### 逐项分析\n\n**A. 对于足够小的 $r$，净1-4势 $E_{14}(r)$ 变得无下界，导致灾难性的吸引和1-4对的坍塌。**\n这个陈述与我们的推导完全一致。我们证明了 $\\lim_{r \\to 0} E_{14}(r) = -\\infty$，这意味着势能无下界。这在短距离上产生无限大的吸引力，导致原子相互坍塌。\n**结论：正确。**\n\n**B. 即使 $s_{14} < 0$，在小 $r$ 处的总1-4力仍然是向外的（排斥力），因为当 $r \\to 0$ 时，库仑项主导Lennard–Jones项。**\n这个陈述包含两个错误。首先，其前提——库仑项（$V_{\\mathrm{C}} \\propto r^{-1}$）在短程主导Lennard-Jones项（$V_{\\mathrm{LJ}} \\propto r^{-12}$）——是错误的。当 $r \\to 0$ 时，$r^{-12}$ 项无疑是主导项。其次，力是排斥力的结论是错误的。我们对力的分析表明 $F_{14}(r) \\propto -r^{-13}$，这是一个吸引力。\n**结论：错误。**\n\n**C. 一个稳健的验证检查是强制Lennard–Jones部分的 $s_{14} \\ge 0$（或者如果使用单独的缩放因子，则更一般地为 $s_{14,\\mathrm{LJ}} \\ge 0$），因为 $r^{-12}$ 排斥项必须有一个正的前因子以防止坍塌。**\n抗坍塌的稳定性由能量表达式中主导项 $r^{-12}$ 的系数符号决定。完整的系数是 $s_{14} \\cdot 4\\epsilon_{ij}\\sigma_{ij}^{12}$。由于 $4\\epsilon_{ij}\\sigma_{ij}^{12} > 0$，稳定性要求 $s_{14} \\ge 0$。如果 $s_{14} > 0$，前因子为正，当 $r \\to 0$ 时势能发散到 $+\\infty$，形成排斥墙。如果 $s_{14} = 0$，势能变为零（在这个简化的1-4相互作用模型中），这不会导致坍塌。如果 $s_{14} < 0$，前因子为负，导致坍塌。因此，强制执行条件 $s_{14} \\ge 0$ 是防止这种特定灾难的关键验证检查。所提供的理由——即 $r^{-12}$ 排斥项必须有一个正的前因子——是确保排斥墙的基本物理原理，这是最强的稳定性形式。检查 $s_{14} \\ge 0$ 是防止不稳定的负值情况的直接实现。\n**结论：正确。**\n\n**D. 通过减小积分时间步长来进行数值稳定化，可以可靠地防止由 $s_{14} < 0$ 引起的灾难性吸引，从而在不改变 $s_{14}$ 的情况下使模拟在物理上稳定。**\n这个问题不是数值问题，而是势能函数本身的基础问题，它是不符合物理规律的。它包含一个能量为 $-\\infty$ 的奇点。减小积分时间步长 $\\Delta t$ 可能会将不可避免的数值溢出延迟几步，但它不能改变底层的物理或势能面的拓扑结构。当原子接近 $r=0$ 时，力和加速度会无限增长。没有有限的时间步长可以稳定地积分这样的运动方程。该系统在物理上是内在地不稳定的，无法通过数值技术使其稳定。\n**结论：错误。**\n\n**E. 作为运行前的验证，在一个物理相关的范围内绘制 $E_{14}(r)$ 并验证当 $r \\to 0$ 时 $E_{14}(r)$ 为正且发散到 $+\\infty$，是捕捉错误指定的 $s_{14}$ 的一个可靠诊断方法。**\n这描述了一个完全有效的合理性检查。绘制势能函数是可视化其行为的直接方法。当 $s_{14}=-0.5$ 时，这样的图会立即显示势能随着 $r \\to 0$ 而无界地减小，不满足“发散到 $+\\infty$”的指定检查。这种诊断方法将明确无误地识别出错误的参数。额外的正性检查也是在非常小的 $r$ 处对稳定势所观察到的一部分，因为大的正 $r^{-12}$ 项将主导所有其他项。这是一个可靠且实用的诊断方法。\n**结论：正确。**\n\n**F. 在Lennard–Jones势的最小值点 $r_{\\min} = 2^{1/6}\\sigma_{ij}$ 处，$E_{14}(r_{\\min})$ 的符号不受 $s_{14}$ 符号的影响，因为该最小值点仅由 $V_{\\mathrm{LJ}}(r)$ 的形状决定。**\n让我们在特定距离 $r^* = 2^{1/6}\\sigma_{ij}$ 处评估势能 $E_{14}(r)$。在此点，未缩放的LJ势具有其最小值 $V_{\\mathrm{LJ}}(r^*) = -\\epsilon_{ij}$。总势能为 $E_{14}(r^*) = s_{14} \\left( V_{\\mathrm{LJ}}(r^*) + V_{\\mathrm{C}}(r^*) \\right) = s_{14} \\left( -\\epsilon_{ij} + \\frac{k_e q_i q_j}{\\epsilon_r r^*} \\right)$。$E_{14}(r^*)$ 的值与 $s_{14}$ 成正比。如果 $s_{14}$ 改变符号，$E_{14}(r^*)$ 的符号也会翻转（除非括号内的项恰好为零，这通常不成立）。因此，在这一点上 $E_{14}$ 的符号严重依赖于 $s_{14}$ 的符号。给出的理由也是有缺陷的；总势能 $E_{14}(r)$ 的最小值通常不位于 $V_{\\mathrm{LJ}}(r)$ 分量的最小值处。\n**结论：错误。**", "answer": "$$\\boxed{ACE}$$", "id": "3393163"}, {"introduction": "最后的练习将前面的概念整合到一个软件工程的实践中。这项练习 [@problem_id:3393096] 要求你设计并实现一个回归测试。该测试用于确认一个在具有不同约定的两个模拟引擎之间移植的分子拓扑，能够产生完全相同的能量和力，这是确保模拟保真度的关键一步。", "problem": "要求您设计并实现一个最小化的回归测试，用于验证在将一个配体拓扑从一个分子动力学引擎移植到另一个使用不同 $1$-$4$ 对默认缩放约定的引擎后，1-4相互作用（通常称为 $1$-$4$ 相互作用）的能量和力是否被正确处理。该回归测试必须是完全指定且可执行的，用于在应用了保持物理行为的参数映射后，测试两种约定下的能量和力是否相等。\n\n从以下基本基础和定义开始：\n- 牛顿第二定律指出，作用在粒子上的力 $\\mathbf{F}$ 是势能 $U$ 的负梯度，即 $\\mathbf{F} = -\\nabla U$。\n- 由位移矢量 $\\mathbf{r}_{ij}$（其大小为 $r = \\|\\mathbf{r}_{ij}\\|$）分隔的两个位点 $i$ 和 $j$ 之间的总对势能是静电贡献和范德华贡献之和。在约化单位中，静电相互作用为 $U_{\\mathrm{Coul}}(r) = k_e \\, q_i q_j / r$（其中 $k_e = 1$），Lennard-Jones势为 $U_{\\mathrm{LJ}}(r) = 4 \\varepsilon \\left[\\left(\\frac{\\sigma}{r}\\right)^{12} - \\left(\\frac{\\sigma}{r}\\right)^6\\right]$，其中 $\\varepsilon$ 是势阱深度，$\\sigma$ 是长度标度。\n- 力通过 $F(r) = -\\frac{\\mathrm{d}U}{\\mathrm{d}r}$ 获得，由于原子 $j$ 作用在原子 $i$ 上的力矢量为 $\\mathbf{F}_i = F(r)\\, \\hat{\\mathbf{r}}_{ij}$，其中 $\\hat{\\mathbf{r}}_{ij} = \\mathbf{r}_{ij} / r$。作用在原子 $j$ 上的力为 $\\mathbf{F}_j = -\\mathbf{F}_i$。\n- 在许多分子动力学引擎中，$1$-$4$ 相互作用由特定于约定的因子进行缩放：一个静电缩放因子 $s_{\\mathrm{elec}}$ 和一个 Lennard-Jones 缩放因子 $s_{\\mathrm{LJ}}$。这些缩放因子会乘以 $1$-$4$ 对的相应对贡献。\n\n在将拓扑从一个具有不同默认 $1$-$4$ 缩放约定的引擎移植到另一个引擎后，您必须确认映射后的参数对所有测试的几何构型都能产生相同的能量和力。为实现约定不变性，对于所有 $r$，Lennard-Jones分量的一个充分必要映射是确保 $s_{\\mathrm{LJ}}^{(A)} \\varepsilon^{(A)} = s_{\\mathrm{LJ}}^{(B)} \\varepsilon^{(B)}$ 且 $\\sigma^{(A)} = \\sigma^{(B)}$，这意味着当 $s_{\\mathrm{LJ}}^{(B)} > 0$ 时，$\\varepsilon^{(B)} = \\varepsilon^{(A)} \\, \\frac{s_{\\mathrm{LJ}}^{(A)}}{s_{\\mathrm{LJ}}^{(B)}}$。对于静电学，当电荷 $q_i$ 和 $q_j$ 固定时，约定不变性要求 $s_{\\mathrm{elec}}^{(A)} = s_{\\mathrm{elec}}^{(B)}$。如果 $s_{\\mathrm{LJ}}^{(B)} = 0$，则设置 $\\varepsilon^{(B)} = 0$ 以完全移除Lennard-Jones贡献。\n\n全程使用约化单位：\n- 距离以 $\\sigma$ 为单位表示。\n- 能量以 $\\varepsilon$ 为单位表示。\n- 力以 $\\varepsilon / \\sigma$ 为单位表示。\n不使用米或焦耳等物理单位；所有输出在约化单位中都是无量纲的。\n\n您的程序必须：\n1. 实现两种约定（表示为 $A$ 和 $B$）下 $1$-$4$ 对能量和力的计算，每种约定由 $(s_{\\mathrm{elec}}^{(A)}, s_{\\mathrm{LJ}}^{(A)})$ 和 $(s_{\\mathrm{elec}}^{(B)}, s_{\\mathrm{LJ}}^{(B)})$ 定义。\n2. 应用上述映射，从 $(\\varepsilon^{(A)}, s_{\\mathrm{elec}}^{(A)}, s_{\\mathrm{LJ}}^{(A)}, s_{\\mathrm{LJ}}^{(B)})$ 获得 $(\\varepsilon^{(B)}, s_{\\mathrm{elec}}^{(B)})$，其中 $\\sigma^{(B)} = \\sigma^{(A)}$。\n3. 对于每个测试用例，计算约定 $A$ 下以及映射后约定 $B$ 下的能量和力，并进行比较。\n4. 使用数值容差 $\\tau = 10^{-12}$ 来判断相等性：能量的绝对差必须小于 $\\tau$，每个原子上力矢量差的欧几里得范数必须小于 $\\tau$。\n\n测试套件：\n对于每个用例，两个位点位于 $x$ 轴上，位置分别为 $\\mathbf{r}_i = (0, 0, 0)$ 和 $\\mathbf{r}_j = (r, 0, 0)$。必须评估以下五个用例：\n\n- 用例1（普遍的非零库仑和Lennard-Jones，不同缩放）：$r = 1.10$, $q_i = 0.20$, $q_j = -0.30$, $\\varepsilon^{(A)} = 0.50$, $\\sigma = 1.00$, $s_{\\mathrm{elec}}^{(A)} = 0.8333333333333$, $s_{\\mathrm{LJ}}^{(A)} = 0.50$, $s_{\\mathrm{elec}}^{(B)} = 1.00$, $s_{\\mathrm{LJ}}^{(B)} = 1.00$。映射到 $\\varepsilon^{(B)} = \\varepsilon^{(A)} \\cdot \\frac{s_{\\mathrm{LJ}}^{(A)}}{s_{\\mathrm{LJ}}^{(B)}}$ 并且 $s_{\\mathrm{elec}}^{(B)} \\leftarrow s_{\\mathrm{elec}}^{(A)}$。\n- 用例2（纯Lennard-Jones，零电荷）：$r = 0.80$, $q_i = 0.00$, $q_j = 0.00$, $\\varepsilon^{(A)} = 1.00$, $\\sigma = 1.00$, $s_{\\mathrm{elec}}^{(A)} = 1.00$, $s_{\\mathrm{LJ}}^{(A)} = 0.50$, $s_{\\mathrm{elec}}^{(B)} = 1.00$, $s_{\\mathrm{LJ}}^{(B)} = 1.00$。对 $\\varepsilon$ 应用相同的映射。\n- 用例3（Lennard-Jones最小距离，非零电荷）：$r = 2^{1/6} \\approx 1.122462048309373$, $q_i = 0.10$, $q_j = 0.10$, $\\varepsilon^{(A)} = 0.40$, $\\sigma = 1.00$, $s_{\\mathrm{elec}}^{(A)} = 0.8333333333333$, $s_{\\mathrm{LJ}}^{(A)} = 0.50$, $s_{\\mathrm{elec}}^{(B)} = 1.00$, $s_{\\mathrm{LJ}}^{(B)} = 1.00$。对 $\\varepsilon$ 和静电学应用相同的映射。\n- 用例4（纯静电，无Lennard-Jones）：$r = 2.00$, $q_i = 0.25$, $q_j = -0.25$, $\\varepsilon^{(A)} = 0.00$, $\\sigma = 1.00$, $s_{\\mathrm{elec}}^{(A)} = 0.50$, $s_{\\mathrm{LJ}}^{(A)} = 1.00$, $s_{\\mathrm{elec}}^{(B)} = 1.00$, $s_{\\mathrm{LJ}}^{(B)} = 1.00$。设置 $s_{\\mathrm{elec}}^{(B)} \\leftarrow s_{\\mathrm{elec}}^{(A)}$ 并且 $\\varepsilon^{(B)} = 0.00$。\n- 用例5（Lennard-Jones因缩放而被排除）：$r = 1.00$, $q_i = 0.30$, $q_j = -0.10$, $\\varepsilon^{(A)} = 1.50$, $\\sigma = 1.00$, $s_{\\mathrm{elec}}^{(A)} = 1.00$, $s_{\\mathrm{LJ}}^{(A)} = 0.00$, $s_{\\mathrm{elec}}^{(B)} = 1.00$, $s_{\\mathrm{LJ}}^{(B)} = 1.00$。映射到 $\\varepsilon^{(B)} = 0.00$ 并且 $s_{\\mathrm{elec}}^{(B)} \\leftarrow s_{\\mathrm{elec}}^{(A)}$。\n\n输出规范：\n- 对于每个用例，在应用从约定 $A$ 到约定 $B$ 的映射后，产生两个布尔结果：一个用于能量相等性，一个用于力相等性。\n- 您的程序应生成单行输出，其中包含一个逗号分隔的列表，用方括号括起来，顺序为 $\\left[\\mathrm{E}_1,\\mathrm{F}_1,\\mathrm{E}_2,\\mathrm{F}_2,\\mathrm{E}_3,\\mathrm{F}_3,\\mathrm{E}_4,\\mathrm{F}_4,\\mathrm{E}_5,\\mathrm{F}_5\\right]$，其中 $\\mathrm{E}_k$ 和 $\\mathrm{F}_k$ 是用例 $k$ 的布尔值，分别表示能量和力的相等性。", "solution": "目标是确认在将拓扑从一个引擎移植到另一个具有不同默认缩放约定的引擎后，$1$-$4$ 相互作用被等效处理。该测试建立在从基本定义出发的原则性推导之上。\n\n我们从将对势能 $U(r)$ 分解为静电和Lennard-Jones贡献开始。在约化单位中，静电势为 $U_{\\mathrm{Coul}}(r) = k_e \\, q_i q_j / r$（其中 $k_e = 1$），Lennard-Jones势为 $U_{\\mathrm{LJ}}(r) = 4 \\varepsilon \\left[\\left(\\frac{\\sigma}{r}\\right)^{12} - \\left(\\frac{\\sigma}{r}\\right)^6\\right]$。对于一个 $1$-$4$ 对，我们将特定于约定的缩放因子 $s_{\\mathrm{elec}}$ 和 $s_{\\mathrm{LJ}}$ 作为每个分量的乘法因子引入。在移植时，保持跨约定物理行为的一致性至关重要。\n\n力来自于势能的负梯度 $\\mathbf{F} = -\\nabla U$。在对径向坐标 $r$ 中，总力的大小为 $F(r) = -\\frac{\\mathrm{d}}{\\mathrm{d}r} \\left( U_{\\mathrm{Coul}}(r) + U_{\\mathrm{LJ}}(r) \\right)$，方向沿单位矢量 $\\hat{\\mathbf{r}}_{ij}$。计算导数可得\n$$\nU_{\\mathrm{Coul}}(r) = \\frac{q_i q_j}{r}, \\quad \\frac{\\mathrm{d}U_{\\mathrm{Coul}}}{\\mathrm{d}r} = -\\frac{q_i q_j}{r^2}, \\quad F_{\\mathrm{Coul}}(r) = -\\frac{\\mathrm{d}U_{\\mathrm{Coul}}}{\\mathrm{d}r} = \\frac{q_i q_j}{r^2},\n$$\n其中 $q_i q_j$ 的符号决定了是吸引还是排斥，方向为 $\\hat{\\mathbf{r}}_{ij}$。对于Lennard-Jones，\n$$\nU_{\\mathrm{LJ}}(r) = 4 \\varepsilon \\left(\\sigma^{12} r^{-12} - \\sigma^6 r^{-6}\\right),\n$$\n$$\n\\frac{\\mathrm{d}U_{\\mathrm{LJ}}}{\\mathrm{d}r} = 4 \\varepsilon \\left(-12 \\sigma^{12} r^{-13} + 6 \\sigma^6 r^{-7}\\right),\n$$\n所以力的大小为\n$$\nF_{\\mathrm{LJ}}(r) = -\\frac{\\mathrm{d}U_{\\mathrm{LJ}}}{\\mathrm{d}r} = 4 \\varepsilon \\left(12 \\sigma^{12} r^{-13} - 6 \\sigma^6 r^{-7}\\right).\n$$\n包含 $1$-$4$ 缩放因子后，总能量和力的大小变为\n$$\nU^{(\\cdot)}(r) = s_{\\mathrm{elec}}^{(\\cdot)} \\, \\frac{q_i q_j}{r} + s_{\\mathrm{LJ}}^{(\\cdot)} \\, 4 \\varepsilon^{(\\cdot)} \\left[\\left(\\frac{\\sigma}{r}\\right)^{12} - \\left(\\frac{\\sigma}{r}\\right)^6\\right],\n$$\n$$\nF^{(\\cdot)}(r) = s_{\\mathrm{elec}}^{(\\cdot)} \\, \\frac{q_i q_j}{r^2} + s_{\\mathrm{LJ}}^{(\\cdot)} \\, 4 \\varepsilon^{(\\cdot)} \\left(12 \\sigma^{12} r^{-13} - 6 \\sigma^6 r^{-7}\\right),\n$$\n其中 $(\\cdot)$ 表示约定标签 $A$ 或 $B$。作用在原子 $i$ 上的力矢量为 $\\mathbf{F}_i^{(\\cdot)} = F^{(\\cdot)}(r)\\, \\hat{\\mathbf{r}}_{ij}$，作用在原子 $j$ 上的力矢量为 $\\mathbf{F}_j^{(\\cdot)} = -\\mathbf{F}_i^{(\\cdot)}$。\n\n为了确保在具有不同默认 $1$-$4$ 缩放因子的引擎之间约定不变，我们推导出一个映射，该映射保证对于所有分离距离 $r>0$，$U$ 和 $\\mathbf{F}$ 相等：\n\n1. 对于Lennard-Jones部分，在所有 $r$ 处相等的充分必要条件是\n$$\ns_{\\mathrm{LJ}}^{(A)} \\varepsilon^{(A)} = s_{\\mathrm{LJ}}^{(B)} \\varepsilon^{(B)}, \\quad \\sigma^{(A)} = \\sigma^{(B)}.\n$$\n因此，\n$$\n\\varepsilon^{(B)} = \n\\begin{cases}\n\\varepsilon^{(A)} \\, \\dfrac{s_{\\mathrm{LJ}}^{(A)}}{s_{\\mathrm{LJ}}^{(B)}}, & s_{\\mathrm{LJ}}^{(B)} > 0, \\\\\n0, & s_{\\mathrm{LJ}}^{(B)} = 0.\n\\end{cases}\n$$\n这个映射对所有 $r$ 都保持了Lennard-Jones的能量和力贡献，因为整个函数形式被 $s_{\\mathrm{LJ}} \\varepsilon$ 线性缩放。\n\n2. 对于静电学，由于 $U_{\\mathrm{Coul}}$ 和 $F_{\\mathrm{Coul}}$ 对 $s_{\\mathrm{elec}}$ 和电荷都是线性的，如果电荷保持不变，那么对于所有 $r$ 的精确相等要求\n$$\ns_{\\mathrm{elec}}^{(B)} = s_{\\mathrm{elec}}^{(A)}.\n$$\n因此，该映射设置 $s_{\\mathrm{elec}}^{(B)} \\leftarrow s_{\\mathrm{elec}}^{(A)}$。\n\n使用此映射，对每个测试用例，计算 $(U^{(A)}, \\mathbf{F}_i^{(A)}, \\mathbf{F}_j^{(A)})$ 和 $(U^{(B)}, \\mathbf{F}_i^{(B)}, \\mathbf{F}_j^{(B)})$ 并通过检查以下条件来验证相等性\n$$\n|U^{(A)} - U^{(B)}| < \\tau, \\quad \\|\\mathbf{F}_i^{(A)} - \\mathbf{F}_i^{(B)}\\| < \\tau, \\quad \\|\\mathbf{F}_j^{(A)} - \\mathbf{F}_j^{(B)}\\| < \\tau,\n$$\n容差为 $\\tau = 10^{-12}$。\n\n算法设计：\n- 用参数 $(r, q_i, q_j, \\varepsilon^{(A)}, \\sigma, s_{\\mathrm{elec}}^{(A)}, s_{\\mathrm{LJ}}^{(A)}, s_{\\mathrm{elec}}^{(B)}, s_{\\mathrm{LJ}}^{(B)})$ 表示每个测试用例。\n- 计算映射以获得 $\\varepsilon^{(B)}$ 并设置 $s_{\\mathrm{elec}}^{(B)} \\leftarrow s_{\\mathrm{elec}}^{(A)}$。\n- 实现函数，给定 $(r, q_i, q_j, \\varepsilon, \\sigma, s_{\\mathrm{elec}}, s_{\\mathrm{LJ}})$，使用上面推导的公式计算 $U$ 和每个原子上的力矢量。使用 $\\mathbf{r}_i = (0, 0, 0)$ 和 $\\mathbf{r}_j = (r, 0, 0)$，因此 $\\hat{\\mathbf{r}}_{ij} = (1, 0, 0)$，并且力与 $x$ 轴共线。\n- 比较约定 $A$ 和 $B$ 下的结果，每个用例产生两个布尔值：能量相等性和力相等性。将这些聚合到所需的单行输出格式中。\n\n提供的测试套件涵盖：\n- 一个通用情况，静电和Lennard-Jones都非零且具有不同的缩放因子。\n- 一个纯Lennard-Jones情况（零电荷）。\n- 一个Lennard-Jones最小距离情况，其中Lennard-Jones力为零，从而在力测试中隔离了静电学。\n- 一个纯静电情况（Lennard-Jones为零）。\n- 一个Lennard-Jones因缩放而被排除的情况，测试对边界条件 $s_{\\mathrm{LJ}}^{(A)} = 0$ 的处理。\n\n根据构造，该映射为所有情况的能量和力产生了精确的解析相等性，数值测试在指定容差内确认了其正确性。这个回归测试是最小化的，但足以检测在移植拓扑后，引擎之间实现 $1$-$4$ 缩放的任何差异。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef lj_energy_force(r, epsilon, sigma, s_lj):\n    \"\"\"\n    Compute Lennard-Jones energy and force magnitude for a pair at separation r,\n    in reduced units. Returns (U_LJ, F_LJ_mag).\n    \"\"\"\n    if r == 0.0:\n        raise ValueError(\"Separation r must be positive.\")\n    inv_r = 1.0 / r\n    inv_r6 = (sigma * inv_r) ** 6\n    inv_r12 = inv_r6 ** 2\n    # Energy\n    U = s_lj * 4.0 * epsilon * (inv_r12 - inv_r6)\n    # Force magnitude: F = -dU/dr\n    F_mag = s_lj * 4.0 * epsilon * (12.0 * inv_r12 * inv_r - 6.0 * inv_r6 * inv_r)\n    return U, F_mag\n\ndef coul_energy_force(r, qi, qj, s_elec, k_e=1.0):\n    \"\"\"\n    Compute Coulomb energy and force magnitude for a pair at separation r,\n    in reduced units with k_e = 1.\n    Returns (U_C, F_C_mag). Sign of F_C_mag includes charge product.\n    \"\"\"\n    if r == 0.0:\n        raise ValueError(\"Separation r must be positive.\")\n    U = s_elec * k_e * qi * qj / r\n    F_mag = s_elec * k_e * qi * qj / (r * r)\n    return U, F_mag\n\ndef energy_force_total(r_vec, qi, qj, epsilon, sigma, s_elec, s_lj):\n    \"\"\"\n    Compute total energy and force vectors on atom i and j for a pairwise interaction.\n    r_vec points from i to j. Returns (U_total, F_i_vec, F_j_vec).\n    \"\"\"\n    r = np.linalg.norm(r_vec)\n    if r == 0.0:\n        raise ValueError(\"Separation must be positive.\")\n    # Unit vector\n    e_ij = r_vec / r\n    # Components\n    U_lj, F_lj_mag = lj_energy_force(r, epsilon, sigma, s_lj)\n    U_c, F_c_mag = coul_energy_force(r, qi, qj, s_elec, k_e=1.0)\n    U_total = U_lj + U_c\n    # Total force magnitude along e_ij\n    F_mag_total = F_lj_mag + F_c_mag\n    F_i = F_mag_total * e_ij\n    F_j = -F_i\n    return U_total, F_i, F_j\n\ndef mapped_parameters(eps_A, s_lj_A, s_lj_B):\n    \"\"\"\n    Map epsilon from convention A to B to preserve s_lj * epsilon across conventions.\n    If s_lj_B == 0, return epsilon_B = 0 to remove LJ contribution.\n    \"\"\"\n    if s_lj_B == 0.0:\n        return 0.0\n    return eps_A * (s_lj_A / s_lj_B)\n\ndef run_test_case(case, tol=1e-12):\n    \"\"\"\n    Given a test case dict, compute energies and forces under convention A and mapped B,\n    and return two booleans: (energy_equal, force_equal).\n    \"\"\"\n    r = case[\"r\"]\n    qi = case[\"qi\"]\n    qj = case[\"qj\"]\n    eps_A = case[\"epsilon_A\"]\n    sigma = case[\"sigma\"]\n    s_elec_A = case[\"s_elec_A\"]\n    s_lj_A = case[\"s_lj_A\"]\n    s_elec_B_default = case[\"s_elec_B\"]\n    s_lj_B = case[\"s_lj_B\"]\n\n    # Positions along x-axis\n    r_i = np.array([0.0, 0.0, 0.0])\n    r_j = np.array([r, 0.0, 0.0])\n    r_vec = r_j - r_i\n\n    # Convention A\n    U_A, F_i_A, F_j_A = energy_force_total(r_vec, qi, qj, eps_A, sigma, s_elec_A, s_lj_A)\n\n    # Map to convention B\n    eps_B = mapped_parameters(eps_A, s_lj_A, s_lj_B)\n    s_elec_B = s_elec_A  # enforce electrostatic convention invariance\n    U_B, F_i_B, F_j_B = energy_force_total(r_vec, qi, qj, eps_B, sigma, s_elec_B, s_lj_B)\n\n    energy_equal = abs(U_A - U_B)  tol\n    force_equal = (np.linalg.norm(F_i_A - F_i_B)  tol) and (np.linalg.norm(F_j_A - F_j_B)  tol)\n    return energy_equal, force_equal\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"r\": 1.10,\n            \"qi\": 0.20,\n            \"qj\": -0.30,\n            \"epsilon_A\": 0.50,\n            \"sigma\": 1.00,\n            \"s_elec_A\": 0.8333333333333,\n            \"s_lj_A\": 0.50,\n            \"s_elec_B\": 1.00,\n            \"s_lj_B\": 1.00,\n        },\n        {\n            \"r\": 0.80,\n            \"qi\": 0.00,\n            \"qj\": 0.00,\n            \"epsilon_A\": 1.00,\n            \"sigma\": 1.00,\n            \"s_elec_A\": 1.00,\n            \"s_lj_A\": 0.50,\n            \"s_elec_B\": 1.00,\n            \"s_lj_B\": 1.00,\n        },\n        {\n            \"r\": 2 ** (1.0 / 6.0),  # Lennard-Jones minimum distance\n            \"qi\": 0.10,\n            \"qj\": 0.10,\n            \"epsilon_A\": 0.40,\n            \"sigma\": 1.00,\n            \"s_elec_A\": 0.8333333333333,\n            \"s_lj_A\": 0.50,\n            \"s_elec_B\": 1.00,\n            \"s_lj_B\": 1.00,\n        },\n        {\n            \"r\": 2.00,\n            \"qi\": 0.25,\n            \"qj\": -0.25,\n            \"epsilon_A\": 0.00,\n            \"sigma\": 1.00,\n            \"s_elec_A\": 0.50,\n            \"s_lj_A\": 1.00,\n            \"s_elec_B\": 1.00,\n            \"s_lj_B\": 1.00,\n        },\n        {\n            \"r\": 1.00,\n            \"qi\": 0.30,\n            \"qj\": -0.10,\n            \"epsilon_A\": 1.50,\n            \"sigma\": 1.00,\n            \"s_elec_A\": 1.00,\n            \"s_lj_A\": 0.00,  # LJ excluded by scaling\n            \"s_elec_B\": 1.00,\n            \"s_lj_B\": 1.00,\n        },\n    ]\n\n    results = []\n    for case in test_cases:\n        e_ok, f_ok = run_test_case(case, tol=1e-12)\n        results.append(e_ok)\n        results.append(f_ok)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3393096"}]}