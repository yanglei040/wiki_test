{"hands_on_practices": [{"introduction": "本练习将我们对构象平衡的理解建立在统计力学的基本原理之上。我们将分析一个简化的一维双势阱，这是大分子中双态构象转变的经典模型。通过在势能最低点附近应用谐波近似，你将练习如何将能量景观的形状与不同构象态的可观测平衡布居直接联系起来，这是解释平均力势的核心技能。[@problem_id:3404036]", "problem": "考虑一个粗粒化的一维反应坐标 $x$，它描述了在温度为 $T$ 的热浴中大分子的构象转变。沿 $x$ 的有效平均力势由 $U(x)=a x^{4}-b x^{2}$ 给出，其中 $a>0$ 且 $b>0$。假设系统处于正则平衡状态，且坐标 $x$ 是经典的。将左、右构象态定义为 $U(x)$ 两个局域极小值点附近的区域。仅使用正则系综关于平衡概率的定义，并在每个势阱的极小值附近进行谐振子近似，推导出右势阱相对于左势阱的相对平衡布居数 $p_{\\mathrm{R}}/p_{\\mathrm{L}}$。将最终答案表示为一个无量纲数。", "solution": "题目要求计算大分子右（R）构象态和左（L）构象态的相对平衡布居数 $p_{\\mathrm{R}}/p_{\\mathrm{L}}$。该系统处于温度为 $T$ 的热浴中，其状态由一维反应坐标 $x$ 描述。平均力势由 $U(x) = a x^{4} - b x^{2}$ 给出，其中常数 $a>0$ 且 $b>0$。\n\n根据经典统计力学中正则系综的原理，在特定坐标 $x$ 处找到系统的概率密度函数与玻尔兹曼因子成正比：\n$$\nP(x) \\propto \\exp\\left(-\\frac{U(x)}{k_B T}\\right)\n$$\n其中 $k_B$ 是玻尔兹曼常数。\n\n在特定构象态（例如，左势阱 L）中找到系统的总概率，是通过在该状态定义的坐标 $x$ 区域上对概率密度进行积分得到的。题目将这些状态定义为 $U(x)$ 两个局域极小值点附近的区域。势 $U(x)$ 在 $x=0$ 处有一个局域极大值，它作为分隔两个势阱的势垒。因此，很自然地将左态 L 定义为区域 $x \\in (-\\infty, 0)$，右态 R 定义为区域 $x \\in (0, \\infty)$。\n\n概率 $p_{\\mathrm{L}}$ 和 $p_{\\mathrm{R}}$ 由下式给出：\n$$\np_{\\mathrm{L}} = C \\int_{-\\infty}^{0} \\exp\\left(-\\frac{U(x)}{k_B T}\\right) dx\n$$\n$$\np_{\\mathrm{R}} = C \\int_{0}^{\\infty} \\exp\\left(-\\frac{U(x)}{k_B T}\\right) dx\n$$\n其中 $C$ 是归一化常数。相对布居数是这两个概率的比值，常数 $C$ 会被消掉：\n$$\n\\frac{p_{\\mathrm{R}}}{p_{\\mathrm{L}}} = \\frac{\\int_{0}^{\\infty} \\exp\\left(-\\frac{U(x)}{k_B T}\\right) dx}{\\int_{-\\infty}^{0} \\exp\\left(-\\frac{U(x)}{k_B T}\\right) dx}\n$$\n题目指定在每个势阱的极小值附近使用谐振子近似。首先，我们必须找到 $U(x)$ 的极小值点。我们计算一阶导数并令其为零：\n$$\n\\frac{dU}{dx} = 4ax^{3} - 2bx = 2x(2ax^{2} - b) = 0\n$$\n驻点是 $x=0$ 和 $x = \\pm\\sqrt{\\frac{b}{2a}}$。为了确定它们的性质，我们考察二阶导数：\n$$\n\\frac{d^{2}U}{dx^{2}} = 12ax^{2} - 2b\n$$\n在 $x=0$ 处，$U''(0) = -2b  0$（因为 $b>0$），这对应一个局域极大值。\n在 $x = \\pm\\sqrt{\\frac{b}{2a}}$ 处，我们有 $x^2 = \\frac{b}{2a}$。将此代入二阶导数：\n$$\nU''\\left(\\pm\\sqrt{\\frac{b}{2a}}\\right) = 12a\\left(\\frac{b}{2a}\\right) - 2b = 6b - 2b = 4b\n$$\n因为 $b>0$，所以 $U'' > 0$，因此这两点是局域极小值点。我们记左极小值点的位置为 $x_{\\mathrm{L}} = -\\sqrt{\\frac{b}{2a}}$，右极小值点的位置为 $x_{\\mathrm{R}} = \\sqrt{\\frac{b}{2a}}$。\n\n谐振子近似涉及将 $U(x)$ 在每个极小值点 $x_m$ 附近展开到二阶的泰勒级数：\n$$\nU(x) \\approx U(x_m) + U'(x_m)(x-x_m) + \\frac{1}{2}U''(x_m)(x-x_m)^2\n$$\n由于 $x_m$ 是极小值点，$U'(x_m)=0$。因此，近似势为 $U_{h}(x) = U(x_m) + \\frac{1}{2}k_m(x-x_m)^2$，其中 $k_m = U''(x_m)$ 是有效弹性系数。\n\n我们来计算两个势阱的势能值和弹性系数。\n对于右势阱（$m = \\mathrm{R}$）：\n$x_{\\mathrm{R}} = \\sqrt{\\frac{b}{2a}}$。\n极小值点的势能为 $U_{\\mathrm{R}} = U(x_{\\mathrm{R}}) = a\\left(\\frac{b}{2a}\\right)^2 - b\\left(\\frac{b}{2a}\\right) = a\\frac{b^2}{4a^2} - \\frac{b^2}{2a} = \\frac{b^2}{4a} - \\frac{2b^2}{4a} = -\\frac{b^2}{4a}$。\n弹性系数为 $k_{\\mathrm{R}} = U''(x_{\\mathrm{R}}) = 4b$。\n\n对于左势阱（$m = \\mathrm{L}$）：\n$x_{\\mathrm{L}} = -\\sqrt{\\frac{b}{2a}}$。\n势是 $x$ 的偶函数，即 $U(x) = U(-x)$。因此，左极小值点的势能与右极小值点相同：$U_{\\mathrm{L}} = U(x_{\\mathrm{L}}) = U(-x_{\\mathrm{R}}) = U(x_{\\mathrm{R}}) = -\\frac{b^2}{4a}$。\n二阶导数也是 $x$ 的偶函数。因此，弹性系数也相同：$k_{\\mathrm{L}} = U''(x_{\\mathrm{L}}) = U''(-x_{\\mathrm{R}}) = U''(x_{\\mathrm{R}}) = 4b$。\n\n所以，我们有 $U_{\\mathrm{R}} = U_{\\mathrm{L}}$ 和 $k_{\\mathrm{R}} = k_{\\mathrm{L}} = 4b$。我们记 $k=4b$ 和 $U_{min} = -b^2/(4a)$。现在我们将谐振子近似代入 $p_{\\mathrm{R}}$ 和 $p_{\\mathrm{L}}$ 的积分中：\n$$\np_{\\mathrm{R}} \\approx C \\int_{0}^{\\infty} \\exp\\left(-\\frac{U_{\\mathrm{R}} + \\frac{1}{2}k_{\\mathrm{R}}(x-x_{\\mathrm{R}})^2}{k_B T}\\right) dx = C \\exp\\left(-\\frac{U_{\\mathrm{R}}}{k_B T}\\right) \\int_{0}^{\\infty} \\exp\\left(-\\frac{k_{\\mathrm{R}}(x-x_{\\mathrm{R}})^2}{2k_B T}\\right) dx\n$$\n$$\np_{\\mathrm{L}} \\approx C \\int_{-\\infty}^{0} \\exp\\left(-\\frac{U_{\\mathrm{L}} + \\frac{1}{2}k_{\\mathrm{L}}(x-x_{\\mathrm{L}})^2}{k_B T}\\right) dx = C \\exp\\left(-\\frac{U_{\\mathrm{L}}}{k_B T}\\right) \\int_{-\\infty}^{0} \\exp\\left(-\\frac{k_{\\mathrm{L}}(x-x_{\\mathrm{L}})^2}{2k_B T}\\right) dx\n$$\n相对布居数为：\n$$\n\\frac{p_{\\mathrm{R}}}{p_{\\mathrm{L}}} = \\frac{\\exp\\left(-\\frac{U_{\\mathrm{R}}}{k_B T}\\right) \\int_{0}^{\\infty} \\exp\\left(-\\frac{k_{\\mathrm{R}}(x-x_{\\mathrm{R}})^2}{2k_B T}\\right) dx}{\\exp\\left(-\\frac{U_{\\mathrm{L}}}{k_B T}\\right) \\int_{-\\infty}^{0} \\exp\\left(-\\frac{k_{\\mathrm{L}}(x-x_{\\mathrm{L}})^2}{2k_B T}\\right) dx}\n$$\n由于 $U_{\\mathrm{R}} = U_{\\mathrm{L}}$ 且 $k_{\\mathrm{R}} = k_{\\mathrm{L}} = k$，指数前因子和被积函数中的常数是相同的。表达式简化为：\n$$\n\\frac{p_{\\mathrm{R}}}{p_{\\mathrm{L}}} = \\frac{\\int_{0}^{\\infty} \\exp\\left(-\\frac{k(x-x_{\\mathrm{R}})^2}{2k_B T}\\right) dx}{\\int_{-\\infty}^{0} \\exp\\left(-\\frac{k(x-x_{\\mathrm{L}})^2}{2k_B T}\\right) dx}\n$$\n我们来分析这些积分。对于分子积分，令 $u = x - x_{\\mathrm{R}}$，则 $dx = du$。积分限从 $x=0$ 变为 $u = -x_{\\mathrm{R}}$，从 $x=\\infty$ 变为 $u=\\infty$。\n$$\nI_{\\mathrm{R}} = \\int_{-x_{\\mathrm{R}}}^{\\infty} \\exp\\left(-\\frac{ku^2}{2k_B T}\\right) du\n$$\n对于分母积分，令 $v = x - x_{\\mathrm{L}}$，则 $dx = dv$。积分限从 $x=-\\infty$ 变为 $v=-\\infty$，从 $x=0$ 变为 $v = -x_{\\mathrm{L}}$。\n$$\nI_{\\mathrm{L}} = \\int_{-\\infty}^{-x_{\\mathrm{L}}} \\exp\\left(-\\frac{kv^2}{2k_B T}\\right) dv\n$$\n我们知道 $x_{\\mathrm{L}} = -x_{\\mathrm{R}}$。因此，分母积分的上限是 $-x_{\\mathrm{L}} = -(-x_{\\mathrm{R}}) = x_{\\mathrm{R}}$。\n$$\nI_{\\mathrm{L}} = \\int_{-\\infty}^{x_{\\mathrm{R}}} \\exp\\left(-\\frac{kv^2}{2k_B T}\\right) dv\n$$\n$I_{\\mathrm{R}}$ 和 $I_{\\mathrm{L}}$ 中的被积函数是相同的，并且是积分变量的偶函数。令 $f(z) = \\exp\\left(-\\frac{kz^2}{2k_B T}\\right)$。\n$$\nI_{\\mathrm{R}} = \\int_{-x_{\\mathrm{R}}}^{\\infty} f(u) du \\quad \\text{and} \\quad I_{\\mathrm{L}} = \\int_{-\\infty}^{x_{\\mathrm{R}}} f(v) dv\n$$\n我们可以拆分积分 $I_{\\mathrm{L}}$：$I_{\\mathrm{L}} = \\int_{-\\infty}^{-x_{\\mathrm{R}}} f(v) dv + \\int_{-x_{\\mathrm{R}}}^{x_{\\mathrm{R}}} f(v) dv$。在第一部分中使用变量替换 $w = -v$：$\\int_{-\\infty}^{-x_{\\mathrm{R}}} f(v) dv = \\int_{\\infty}^{x_{\\mathrm{R}}} f(-w) (-dw) = \\int_{x_{\\mathrm{R}}}^{\\infty} f(w) dw$，因为 $f$ 是偶函数。所以，$I_{\\mathrm{L}} = \\int_{x_{\\mathrm{R}}}^{\\infty} f(w) dw + \\int_{-x_{\\mathrm{R}}}^{x_{\\mathrm{R}}} f(v) dv = \\int_{-x_{\\mathrm{R}}}^{\\infty} f(z) dz = I_{\\mathrm{R}}$。\n由于分子积分 $I_{\\mathrm{R}}$ 和分母积分 $I_{\\mathrm{L}}$ 相等，它们的比值为 $1$。\n\n由于势 $U(x)$ 的对称性，这个结果是预料之中的。两个势阱互为镜像，深度和形状都相同。在热平衡状态下，系统对两个势阱没有偏好，导致它们的布居数相等。\n\n因此，相对布居数为：\n$$\n\\frac{p_{\\mathrm{R}}}{p_{\\mathrm{L}}} = 1\n$$", "answer": "$$\\boxed{1}$$", "id": "3404036"}, {"introduction": "在能量景观概念的基础上，一个关键挑战是选择一个合适的低维坐标来描述一个复杂的高维过程。本实践问题深入探讨了集体变量（$CVs$）这一至关重要的概念，对比了一个通用几何描述符——回旋半径（$R_g$），与一个基于机制的描述符——天然接触分数（$Q_h$）。通过这个概念性练习，你将培养评估和选择$CVs$所需的批判性思维，这些$CVs$能够有意义地区分构象态并捕捉转变机制的本质。[@problem_id:3404093]", "problem": "一个长度为 $N$ 的肽在显式溶剂分子动力学 (MD) 中经历 $\\alpha$-螺旋 $\\leftrightarrow$ 无规线团的转变。令完整的微观状态为 $\\mathbf{X} \\in \\mathbb{R}^{3N}$，并考虑一个集体变量 (CV) $Z(\\mathbf{X})$，它将构象映射到一个标量描述符上，以分析构象变化。回转半径定义为\n$$\nR_g^2(\\mathbf{X}) \\equiv \\frac{1}{M} \\sum_{i=1}^{N} m_i \\left\\|\\mathbf{r}_i - \\mathbf{r}_{\\mathrm{COM}}\\right\\|^2,\\quad \\mathbf{r}_{\\mathrm{COM}} \\equiv \\frac{1}{M}\\sum_{i=1}^{N} m_i \\mathbf{r}_i,\\quad M \\equiv \\sum_{i=1}^{N} m_i,\n$$\n其中 $m_i$ 和 $\\mathbf{r}_i$ 是原子 $i$ 的质量和位置，而 $\\mathbf{r}_{\\mathrm{COM}}$ 是质心。沿任何 CV $z$ 的平均力势 (PMF) 定义为\n$$\nF(z) \\equiv - k_{\\mathrm{B}} T \\ln p(z) + \\mathrm{const},\n$$\n其中 $k_{\\mathrm{B}}$ 是玻尔兹曼常数，$T$ 是温度，$p(z)$ 是观察到 $Z(\\mathbf{X})=z$ 的平衡边际概率密度。对于螺旋构象盆 $A$ 和无规线团构象盆 $B$ 之间的双态转变，提交概率 (committor) $p_B(\\mathbf{X}) \\in [0,1]$ 是从 $\\mathbf{X}$ 开始的轨迹在到达构象盆 $A$ 之前先到达构象盆 $B$ 的概率；一个理想的反应坐标是 $p_B(\\mathbf{X})$ 的单调函数。\n\n$\\alpha$-螺旋中的二级结构由残基 $i$ 和 $i+4$ 之间的主链氢键接触来表征。定义一个天然螺旋接触集 $\\mathcal{C}_{\\mathrm{h}} \\equiv \\{(i,i+4)\\}$，列举此类配对，其大小为 $N_c \\equiv |\\mathcal{C}_{\\mathrm{h}}|$。考虑一个基于天然接触的螺旋度 CV，\n$$\nQ_{\\mathrm{h}}(\\mathbf{X}) \\equiv \\frac{1}{N_c} \\sum_{(i,j) \\in \\mathcal{C}_{\\mathrm{h}}} s\\!\\left(r_{ij}(\\mathbf{X})\\right),\\quad s(r) \\equiv \\frac{1}{1+(r/r_0)^n},\n$$\n其中 $r_{ij}(\\mathbf{X})$ 是接触 $(i,j)$ 的供体-受体距离，$r_0$ 是一个特征距离，$n$ 是一个陡度参数，从而得到天然螺旋接触的光滑分数。\n\n仅使用上述定义、基础平衡统计力学以及 $R_g$ 的几何意义，通过推理从微观状态 $\\mathbf{X}$ 到 $R_g(\\mathbf{X})$ 以及到二级结构状态的映射，评估 $R_g$ 是否是描述螺旋-无规线团转变的合适的一维 CV。针对此转变，提出一个基于天然接触分数的替代 CV 并说明其理由，并描述你将如何使用第一性原理准则来评估所提出的 CV 的质量。选择所有正确的陈述。\n\nA. 由于许多几何上不同的无规线团构象可以与螺旋构象具有相同的 $R_g$，反之亦然，因此在螺旋和无规线团系综中，映射 $\\mathbf{X} \\mapsto R_g(\\mathbf{X})$ 是高度多对一的；因此，$R_g$ 通常是描述螺旋-无规线团转变的一个差的一维 CV。相比之下，$Q_{\\mathrm{h}}(\\mathbf{X})$ 编码了天然的 $i,i+4$ 氢键接触的存在，并预期与二级结构标签有更强的相关性，使其成为一个更合适的一维 CV。\n\nB. 在大 $N$ 的热力学极限下，从构象到 $R_g$ 的映射变得有效一对一，因此 $R_g$ 成为一个理想的反应坐标，并将在 $F(R_g)$ 中显示一个单一、尖锐的能垒，完全捕捉螺旋-无规线团的转变。\n\nC. 用端到端距离 $R_{\\mathrm{ee}}$ 增强 $R_g$ 对于螺旋-无规线团转变是足够的：提交概率 $p_B(\\mathbf{X})$ 仅取决于 $(R_g(\\mathbf{X}), R_{\\mathrm{ee}}(\\mathbf{X}))$，因此添加任何基于天然接触的 CV（如 $Q_{\\mathrm{h}}$）都不能改善反应坐标。\n\nD. 一个基于天然接触分数的 CV，例如由 $i,i+4$ 对上的平滑切换函数定义的 $Q_{\\mathrm{h}}(\\mathbf{X})$，预期与二元二级结构标签相比，$R_g(\\mathbf{X})$ 具有更高的互信息。其质量可以通过计算 $F(Q_{\\mathrm{h}})$ 来识别分隔构象盆的能垒，并通过验证提交概率 $p_B(\\mathbf{X})$ 近似为 $Q_{\\mathrm{h}}(\\mathbf{X})$ 的单调函数来评估，其中过渡路径构象局域在能垒顶部附近。\n\nE. $R_g$ 不适合作为螺旋-无规线团转变的 CV，因为 $R_g$ 在全局平移和旋转下不是不变的，而 $Q_{\\mathrm{h}}$ 是不变的；这种不变性差异是 $Q_{\\mathrm{h}}$ 优于 $R_g$ 的主要原因。", "solution": "用户要求基于统计力学和分子动力学提供的定义，对用于描述肽中 $\\alpha$-螺旋到无规线团转变的集体变量 (CV) 进行评估。\n\n问题陈述的有效性验证如下：\n1.  **提取已知条件**：问题定义了系统（一个长度为 $N$ 的肽）、微观状态 $\\mathbf{X}$、感兴趣的转变（$\\alpha$-螺旋 $\\leftrightarrow$ 无规线团），以及几个关键概念：回转半径 $R_g(\\mathbf{X})$、平均力势 $F(z)$、提交概率 $p_B(\\mathbf{X})$、理想反应坐标的定义、$\\alpha$-螺旋的结构特征（$i,i+4$ 氢键），以及一个特定的基于天然接触的 CV，$Q_{\\mathrm{h}}(\\mathbf{X})$。所有定义都是标准的且数学上是精确的。\n2.  **有效性检查**：该问题在统计力学和高分子物理学原理上具有**科学依据**。它是**适定的**（well-posed），因为它要求基于所提供的严格定义进行概念性评估，对此可以进行有意义的分析。它使用精确的技术语言，是**客观的**。问题设置没有违反任何科学原理，不是不完整或矛盾的，并且与大分子构象变化的分析直接相关。\n3.  **结论**：问题陈述是有效的。\n\n我们现在通过分析所提出的 CV 的适用性并评估每个选项来解决问题。\n\n问题的核心是评估哪个低维变量，$R_g$ 或 $Q_{\\mathrm{h}}$，能更好地描述肽在结构化的螺旋态 ($A$) 和无序的无规线团态 ($B$) 之间转变的高维过程。一个好的 CV，通常称为反应坐标，应该能有效地分辨这些状态以及连接它们的转变路径。对反应坐标 $Z(\\mathbf{X})$ 的最终检验是它应该是提交概率 $p_B(\\mathbf{X})$ 的单调函数。这意味着对于任何两个构象 $\\mathbf{X}_1$ 和 $\\mathbf{X}_2$，如果 $Z(\\mathbf{X}_1)  Z(\\mathbf{X}_2)$，那么它应该意味着 $p_B(\\mathbf{X}_1) \\le p_B(\\mathbf{X}_2)$（或 $\\ge$，取决于方向）。\n\n**回转半径 ($R_g$) 分析**\n回转半径 $R_g$ 衡量肽的整体紧凑性或空间范围。$\\alpha$-螺旋是一种规则的、棒状的、相对紧凑的结构，因此构象盆 $A$ 中的构象将表现出狭窄的 $R_g$ 值分布。然而，无规线团态不是单一结构，而是大量无序构象的系综。这些构象可以从高度紧凑的球状结构到非常伸展的链状结构。因此，无规线团系综（构象盆 $B$）的 $R_g$ 分布非常宽。\n\n对于这个特定的转变，$R_g$ 作为 CV 的关键缺陷在于从构象空间到 $R_g$ 标量值的映射具有高度的简并性。也就是说，单个 $R_g$ 值可以对应于属于根本不同结构类别的构象。例如，一个紧凑的无规线团构象可以轻易地与一个完全形成的 $\\alpha$-螺旋具有相同的 $R_g$。这种重叠意味着构象空间中恒定 $R_g$ 的等值面将包含来自螺旋和无规线团构象盆以及过渡态的点。结果是，提交概率 $p_B(\\mathbf{X})$ 在此等值面上会大幅变化，违反了好反应坐标的条件。相应的 PMF，$F(R_g) = -k_B T \\ln p(R_g)$，可能会显示出分离不良的构象盆或单个宽阔的势阱，无法揭示潜在的双态转变性质。\n\n**天然接触分数 ($Q_{\\mathrm{h}}$) 分析**\nCV $Q_{\\mathrm{h}}$ 是专门为解决像 $R_g$ 这样的通用坐标的缺点而构建的。它的定义基于残基 $i$ 和 $i+4$ 之间特定氢键的形成，这些氢键是 $\\alpha$-螺旋二级结构的定义特征。\n-   对于一个完全形成的螺旋（构象盆 $A$），$\\mathcal{C}_{\\mathrm{h}}$ 中接触的距离 $r_{ij}$ 会很小，使得切换函数 $s(r_{ij}) \\approx 1$。因此，$Q_{\\mathrm{h}} \\approx 1$。\n-   对于一个完全无序的无规线团（构象盆 $B$），这些特定接触大部分被破坏，距离 $r_{ij}$ 很大，且 $s(r_{ij}) \\approx 0$。因此，$Q_{\\mathrm{h}} \\approx 0$。\n因此，映射 $\\mathbf{X} \\mapsto Q_{\\mathrm{h}}(\\mathbf{X})$ 被设计为根据构象的“螺旋度”来明确区分它们。我们预期 $Q_{\\mathrm{h}}(\\mathbf{X})$ 和 $p_B(\\mathbf{X})$ 之间存在强烈的单调相关性。$Q_{\\mathrm{h}} \\approx 1$ 的构象在构象盆 $A$ 中（$p_B \\approx 0$），而 $Q_{\\mathrm{h}} \\approx 0$ 的构象在构象盆 $B$ 中（$p_B \\approx 1$）。过渡态，其中 $p_B \\approx 0.5$，预期对应于具有中等 $Q_{\\mathrm{h}}$ 值的部分形成的螺旋。这使得 $Q_{\\mathrm{h}}$ 成为一个更合适的反应坐标候选者。\n\n现在我们评估每个选项。\n\n**A. 由于许多几何上不同的无规线团构象可以与螺旋构象具有相同的 $R_g$，反之亦然，因此在螺旋和无规线团系综中，映射 $\\mathbf{X} \\mapsto R_g(\\mathbf{X})$ 是高度多对一的；因此，$R_g$ 通常是描述螺旋-无规线团转变的一个差的一维 CV。相比之下，$Q_{\\mathrm{h}}(\\mathbf{X})$ 编码了天然的 $i,i+4$ 氢键接触的存在，并预期与二级结构标签有更强的相关性，使其成为一个更合适的一维 CV。**\n该陈述准确地总结了上述分析。它正确地指出了 $R_g$ 坐标的简并性（多对一映射问题）是其性能不佳的原因。它还正确地指出，$Q_{\\mathrm{h}}$ 更优越，因为它是根据状态的特定结构定义量身定制的。\n**结论：正确。**\n\n**B. 在大 $N$ 的热力学极限下，从构象到 $R_g$ 的映射变得有效一对一，因此 $R_g$ 成为一个理想的反应坐标，并将在 $F(R_g)$ 中显示一个单一、尖锐的能垒，完全捕捉螺旋-无规线团的转变。**\n这个陈述是根本错误的。随着系统大小 $N$ 的增加，对应于像 $R_g$ 这样的集体变量的单个值的微观构象 $\\mathbf{X}$ 的数量呈指数增长。映射变得更加简并，而不是更少。映射变得“有效一对一”的概念在物理和数学上都是不可能的。因此，$R_g$ 成为理想反应坐标的结论是错误的。\n**结论：不正确。**\n\n**C. 用端到端距离 $R_{\\mathrm{ee}}$ 增强 $R_g$ 对于螺旋-无规线团转变是足够的：提交概率 $p_B(\\mathbf{X})$ 仅取决于 $(R_g(\\mathbf{X}), R_{\\mathrm{ee}}(\\mathbf{X}))$，因此添加任何基于天然接触的 CV（如 $Q_{\\mathrm{h}}$）都不能改善反应坐标。**\n二维 CV $(R_g, R_{\\mathrm{ee}})$ 提供了比单独的 $R_g$ 更多的信息，因为它可以区分紧凑结构（低 $R_g$，低 $R_{\\mathrm{ee}}$）和伸展结构，如棒状螺旋（中等 $R_g$，高 $R_{\\mathrm{ee}}$）。然而，声称它“足够”并且提交概率“仅取决于”这对变量是一个极强的断言，几乎肯定是错误的。提交概率 $p_B(\\mathbf{X})$ 是完整微观状态 $\\mathbf{X}$ 的函数。$(R_g, R_{\\mathrm{ee}})$ 这对变量仍然只描述全局形状，并未明确说明定义螺旋的特定局部氢键的形成。极有可能存在具有相似 $(R_g, R_{\\mathrm{ee}})$ 值但螺旋含量不同，因此提交概率值也不同的构象。将 $Q_{\\mathrm{h}}$ 添加到 CV 集合中几乎肯定会提供对提交概率的更好近似。\n**结论：不正确。**\n\n**D. 一个基于天然接触分数的 CV，例如由 $i,i+4$ 对上的平滑切换函数定义的 $Q_{\\mathrm{h}}(\\mathbf{X})$，预期与二元二级结构标签相比，$R_g(\\mathbf{X})$ 具有更高的互信息。其质量可以通过计算 $F(Q_{\\mathrm{h}})$ 来识别分隔构象盆的能垒，并通过验证提交概率 $p_B(\\mathbf{X})$ 近似为 $Q_{\\mathrm{h}}(\\mathbf{X})$ 的单调函数来评估，其中过渡路径构象局域在能垒顶部附近。**\n该陈述提供了评估反应坐标的正确而全面的描述。一个为转变量身定制的 CV（$Q_{\\mathrm{h}}$）预期会比一个通用的 CV（$R_g$）捕捉更多关于状态的信息（更高的互信息）。描述的评估其质量的方法——检查 PMF 以寻找定义明确的构象盆和能垒，以及检查与提交概率的单调关系——是该领域的标准、基于第一性原理的准则。过渡路径系综（$p_B \\approx 0.5$）在能垒最大值处的局域化是一个好反应坐标的关键特征。\n**结论：正确。**\n\n**E. $R_g$ 不适合作为螺旋-无规线团转变的 CV，因为 $R_g$ 在全局平移和旋转下不是不变的，而 $Q_{\\mathrm{h}}$ 是不变的；这种不变性差异是 $Q_{\\mathrm{h}}$ 优于 $R_g$ 的主要原因。**\n这个陈述包含一个事实不正确的前提。任何用于描述内构象变化的集体变量都必须在整个分子的全局平移和旋转下保持不变。我们来验证一下：\n-   $Q_{\\mathrm{h}}$ 是原子间距离 $r_{ij}$ 的函数，这些距离在刚体运动下是固有不变的。所以，$Q_{\\mathrm{h}}$ 是不变的。\n-   $R_g$ 是根据原子相对于质心的位置 $\\mathbf{r}_i - \\mathbf{r}_{\\mathrm{COM}}$ 定义的。全局平移会给所有 $\\mathbf{r}_i$ 和 $\\mathbf{r}_{\\mathrm{COM}}$ 加上一个恒定的向量，这个向量在相减时被抵消。全局旋转会用同一个旋转矩阵旋转所有的位移向量 $\\mathbf{r}_i - \\mathbf{r}_{\\mathrm{COM}}$，这会保持它们的范数不变。因此，$R_g$ 在全局平移和旋转下也是不变的。\n由于两个 CV 都具有必要的不变性，所谓的“不变性差异”并不存在。因此，这不可能是它们性能差异的原因。真正的原因在选项 A 中已经概述。\n**结论：不正确。**", "answer": "$$\\boxed{AD}$$", "id": "3404093"}, {"introduction": "在定义了构象态之后（通常借助于优良的集体变量），我们可以使用马尔可夫状态模型（$MSMs$）来分析它们之间的转变动力学。这个动手编程练习将指导你完成$MSM$分析流程中的一个关键部分：利用观察到的转变计数来构建模型并量化其不确定性。你将实现一个贝叶斯框架来计算系统的稳态分布（平衡布居）$\\boldsymbol{\\pi}$和转变速率$k_{ij}$的可信区间，从而将理论统计方法与分子动力学中的实际数据分析联系起来。[@problem_id:3404066]", "problem": "您正在使用分子动力学分析大分子在指定延迟时间下离散宏观态之间的构象转变。假设一个离散时间的行随机马尔可夫状态模型，其中每一行对应一个状态，每个条目表示在延迟时间 $\\tau$ 后转移到其他状态的转移概率。给定一个在延迟时间 $\\tau$ 观测到的 $n \\times n$ 转移计数矩阵 $C$，以及一个 $n \\times n$ 的先验伪计数矩阵 $A$，该矩阵在转移矩阵的每一行上引入狄利克雷先验。在给定 $C$ 和 $A$ 的条件下，第 $i$ 行的后验是一个狄利克雷分布，其参数为 $\\alpha_{ij} = A_{ij} + C_{ij}$（其中 $j = 1,\\dots,n$）。后验均值转移矩阵 $\\mathbf{T}(\\tau)$ 的条目为 $T_{ij}(\\tau) = \\mathbb{E}[p_{ij} \\mid \\alpha] = \\alpha_{ij} / \\alpha_{i0}$，其中 $\\alpha_{i0} = \\sum_{j=1}^n \\alpha_{ij}$。稳态分布 $\\boldsymbol{\\pi}$ 是满足 $\\boldsymbol{\\pi} = \\boldsymbol{\\pi}\\mathbf{T}(\\tau)$ 和 $\\sum_{i=1}^n \\pi_i = 1$ 的唯一非负概率向量。\n\n在狄利克雷后验下，每个转移概率 $p_{ij}$ 的不确定性可以使用其精确的边缘分布来量化。对于每一行 $i$ 和分量 $j$，$p_{ij}$ 的边缘分布是 $\\mathrm{Beta}(\\alpha_{ij}, \\alpha_{i0} - \\alpha_{ij})$。对于给定的可信度水平 $q \\in (0,1)$，定义下分位数 $q_{\\mathrm{low}} = (1-q)/2$ 和上分位数 $q_{\\mathrm{high}} = 1 - q_{\\mathrm{low}}$。$p_{ij}$ 的 $(q \\times 100)$% 中心可信区间是 beta 分布的逆累积分布函数在 $q_{\\mathrm{low}}$ 和 $q_{\\mathrm{high}}$ 处求值所得到的区间。为了在由主方程（对于足够小的 $\\tau$）证明合理的小延迟假设下近似连续时间速率，使用 $\\mathbf{T}(\\tau) \\approx \\mathbf{I} + \\tau \\mathbf{K}$，得出 $k_{ij} \\approx p_{ij}/\\tau$（当 $i \\neq j$ 时）以及 $k_{ii} = -\\sum_{j \\neq i} k_{ij}$。因此，通过将 $p_{ij}$ 的可信区间除以 $\\tau$ 来获得非对角速率 $k_{ij}$ 的可信区间，并通过行和约束导出对角速率区间：$\\left[k_{ii}^{\\mathrm{low}}, k_{ii}^{\\mathrm{high}}\\right] = \\left[-\\sum_{j \\neq i} k_{ij}^{\\mathrm{high}}, -\\sum_{j \\neq i} k_{ij}^{\\mathrm{low}}\\right]$。\n\n实现一个程序，对下述每个测试用例，计算：\n- 后验均值转移矩阵 $\\mathbf{T}(\\tau)$ 的稳态分布 $\\boldsymbol{\\pi}$。\n- 使用所述的狄利克雷后验和小延迟近似，计算每个连续时间速率 $k_{ij}$ 的 $(q \\times 100)$% 中心可信区间，单位为 $1/\\mathrm{ns}$，适用于所有 $i,j$。\n\n科学基础与要求：\n- 使用标准的多项式似然和逐行的狄利克雷先验来推导狄利克雷后验参数 $\\alpha_{ij}$。\n- 通过求解不变性方程 $\\boldsymbol{\\pi} = \\boldsymbol{\\pi}\\mathbf{T}(\\tau)$ 并满足归一化条件 $\\sum_i \\pi_i = 1$ 来计算稳态分布。\n- 使用狄利克雷分量的精确边缘 Beta 分布来计算 $p_{ij}$ 的分位数。\n- 通过 $k_{ij} \\approx p_{ij}/\\tau$（当 $i \\neq j$ 时）和行和约束得到的 $k_{ii}$，将概率可信区间转换为速率可信区间。\n\n物理单位：\n- 根据提供的以 $\\mathrm{ns}$ 为单位的 $\\tau$，以 $1/\\mathrm{ns}$ 为单位报告速率。角度不适用。概率是无量纲的。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含所有测试用例的结果，格式为方括号括起来的逗号分隔列表。每个测试用例的结果必须是一个包含两个元素的列表：第一个是稳态分布列表 $\\boldsymbol{\\pi}$，第二个是 $k_{ij}$ 可信区间的嵌套列表，组织为包含 $n$ 行的列表，每行是一个包含 $n$ 个配对 $[k_{ij}^{\\mathrm{low}}, k_{ij}^{\\mathrm{high}}]$ 的列表。因此，整体结构是一个包含每个测试用例结果的列表，例如 $[[\\pi^{(1)}, K\\_{{\\mathrm{CI}}}^{(1)}],[\\pi^{(2)}, K\\_{{\\mathrm{CI}}}^{(2)}],\\dots]$。\n\n测试套件：\n- 案例1（正常路径，中等计数）：\n  - $C = \\begin{bmatrix} 180  15  5 \\\\ 20  160  20 \\\\ 10  30  160 \\end{bmatrix}$，\n  - $A = \\begin{bmatrix} 1  1  1 \\\\ 1  1  1 \\\\ 1  1  1 \\end{bmatrix}$，\n  - $\\tau = 0.5\\,\\mathrm{ns}$，\n  - $q = 0.95$。\n- 案例2（边界情况，含零的稀疏计数和弱先验）：\n  - $C = \\begin{bmatrix} 0  5  0  0 \\\\ 0  0  10  0 \\\\ 0  0  0  0 \\\\ 2  0  0  0 \\end{bmatrix}$，\n  - $A = 0.2 \\times \\mathbf{1}_{4 \\times 4}$（所有条目为 $0.2$），\n  - $\\tau = 0.1\\,\\mathrm{ns}$，\n  - $q = 0.90$。\n- 案例3（边界条件，总数巨大且高度偏斜的计数）：\n  - $C = \\begin{bmatrix} 9500  500 \\\\ 300  9700 \\end{bmatrix}$，\n  - $A = \\begin{bmatrix} 1  1 \\\\ 1  1 \\end{bmatrix}$，\n  - $\\tau = 2.0\\,\\mathrm{ns}$，\n  - $q = 0.99$。\n\n答案规范：\n- 对于每个测试用例，按照所述的精确组织结构，生成一个由稳态分布 $\\boldsymbol{\\pi}$ 和以 $1/\\mathrm{ns}$ 为单位的速率 $k_{ij}$ 的嵌套可信区间组成的列表。您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果，不得包含任何额外文本。", "solution": "该问题要求为源自分子动力学模拟的马尔可夫状态模型（MSM）实现一个标准的贝叶斯分析工作流程。该分析涉及计算系统的稳态分布以及基础连续时间转移速率的可信区间。该问题具有科学依据，是良构的，并且提供了所有必要的参数。\n\n针对给定测试用例解决该问题的步骤如下：\n\n1.  **后验分布的构建**：\n    问题假设在每个状态 $i$ 中，观测到的转移计数 $C_{ij}$ 服从多项式似然。在转移概率矩阵 $\\mathbf{P}$ 的每一行上都设置了狄利克雷先验。该先验的参数由伪计数矩阵 $A$ 给出。狄利克雷分布是多项式似然的共轭先验。因此，转移概率的每一行 $\\mathbf{p}_i = (p_{i1}, \\dots, p_{in})$ 的后验分布也是一个狄利克雷分布。这个后验狄利克雷分布的参数（表示为 $\\alpha_{ij}$）通过将先验伪计数与观测计数相加得到：\n    $$\n    \\alpha_{ij} = A_{ij} + C_{ij}\n    $$\n    因此，第 $i$ 行的后验是 $\\mathrm{Dir}(\\alpha_{i1}, \\dots, \\alpha_{in})$。\n\n2.  **后验均值转移矩阵**：\n    后验均值为转移概率矩阵 $\\mathbf{T}(\\tau)$ 提供了一个点估计。对于狄利克雷分布，每个分量 $p_{ij}$ 的期望值由其参数 $\\alpha_{ij}$ 与该行所有参数之和 $\\alpha_{i0} = \\sum_{j=1}^n \\alpha_{ij}$ 的比值给出。因此，后验均值转移矩阵的条目为：\n    $$\n    T_{ij}(\\tau) = \\mathbb{E}[p_{ij} \\mid \\boldsymbol{\\alpha}_i] = \\frac{\\alpha_{ij}}{\\alpha_{i0}}\n    $$\n\n3.  **稳态分布计算**：\n    稳态分布 $\\boldsymbol{\\pi} = (\\pi_1, \\dots, \\pi_n)$ 是一个表示各状态平衡布居的概率向量。它被定义为满足不变性方程 $\\boldsymbol{\\pi} = \\boldsymbol{\\pi}\\mathbf{T}(\\tau)$ 并服从归一化约束 $\\sum_{i=1}^n \\pi_i = 1$ 的唯一非负向量。这等价于陈述 $\\boldsymbol{\\pi}$ 是矩阵 $\\mathbf{T}(\\tau)$ 对应于特征值 $\\lambda=1$ 的左特征向量。\n    在数值上，这通过寻找转置矩阵 $\\mathbf{T}(\\tau)^T$ 对应于特征值 $\\lambda=1$ 的右特征向量来解决。然后将得到的特征向量进行归一化，使其分量之和为 $1$。这可以通过使用标准的数值线性代数程序（例如 `numpy.linalg.eig` 中的程序）来完成，同时通过识别数值上接近 $1$ 的特征值来注意潜在的浮点数不精确性。\n\n4.  **可信区间计算**：\n    为了量化我们估计中的不确定性，我们计算转移速率的中心可信区间。\n    - **转移概率 $p_{ij}$**：狄利克雷分布的一个关键性质是任何单个分量 $p_{ij}$ 的边缘分布都遵循 Beta 分布。具体来说，对于给定行 $i$，$p_{ij}$ 的边缘后验为：\n      $$\n      p_{ij} \\mid \\boldsymbol{\\alpha}_i \\sim \\mathrm{Beta}(\\alpha_{ij}, \\alpha_{i0} - \\alpha_{ij})\n      $$\n    - 对于给定的可信度水平 $q$，我们将下分位数和上分位数概率定义为 $q_{\\mathrm{low}} = (1-q)/2$ 和 $q_{\\mathrm{high}} = 1 - q_{\\mathrm{low}}$。$p_{ij}$ 的 $(q \\times 100)\\%$ 中心可信区间为 $[p_{ij}^{\\mathrm{low}}, p_{ij}^{\\mathrm{high}}]$，其边界是使用相应 Beta 分布的逆累积分布函数（CDF）或百分点函数（PPF）计算的：\n      $$\n      p_{ij}^{\\mathrm{low}} = \\mathrm{Beta.ppf}(q_{\\mathrm{low}}; \\alpha_{ij}, \\alpha_{i0} - \\alpha_{ij}) \\\\\n      p_{ij}^{\\mathrm{high}} = \\mathrm{Beta.ppf}(q_{\\mathrm{high}}; \\alpha_{ij}, \\alpha_{i0} - \\alpha_{ij})\n      $$\n    - **转移速率 $k_{ij}$**：问题陈述使用小延迟近似，通过 $\\mathbf{T}(\\tau) \\approx \\mathbf{I} + \\tau \\mathbf{K}$ 将离散时间转移矩阵 $\\mathbf{T}(\\tau)$ 与连续时间速率矩阵 $\\mathbf{K}$ 关联起来。这为速率元素提供了直接关系：对于非对角元素（$i \\neq j$），$k_{ij} \\approx p_{ij}/\\tau$。$k_{ij}$ 的可信区间通过简单地将 $p_{ij}$ 的区间乘以 $1/\\tau$ 得到。\n      $$\n      [k_{ij}^{\\mathrm{low}}, k_{ij}^{\\mathrm{high}}] = [p_{ij}^{\\mathrm{low}}/\\tau, p_{ij}^{\\mathrm{high}}/\\tau] \\quad \\text{for } i \\neq j\n      $$\n    - 对角速率 $k_{ii}$ 由生成元矩阵的行和必须为零的约束确定：$k_{ii} = -\\sum_{j \\neq i} k_{ij}$。$k_{ii}$ 的可信区间是根据同一行中非对角速率的界限推导出来的，正如问题陈述中明确指出的：\n      $$\n      [k_{ii}^{\\mathrm{low}}, k_{ii}^{\\mathrm{high}}] = \\left[-\\sum_{j \\neq i} k_{ij}^{\\mathrm{high}}, -\\sum_{j \\neq i} k_{ij}^{\\mathrm{low}}\\right]\n      $$\n      上下界的颠倒是由于负号所致。\n\n该实现将系统地将这些步骤应用于每个测试用例，使用 `numpy` 进行矩阵运算，使用 `scipy.stats.beta` 进行分位数计算。最终结果将被收集并格式化为指定的字符串表示形式。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import stats\n\ndef process_case(C, A, tau, q):\n    \"\"\"\n    Processes a single test case for the Markov State Model analysis.\n\n    For a given counts matrix C, prior A, lag time tau, and credibility q, this\n    function computes the stationary distribution pi and the credible intervals\n    for the continuous-time rates k_ij.\n    \"\"\"\n    C_np = np.array(C, dtype=float)\n    A_np = np.array(A, dtype=float)\n    n = C_np.shape[0]\n\n    # Step 1: Calculate posterior Dirichlet parameters alpha\n    alpha = C_np + A_np\n\n    # Step 2: Calculate posterior mean transition matrix T\n    alpha_i0 = alpha.sum(axis=1, keepdims=True)\n    # Handle rows with zero total counts (after adding prior) - though the problem\n    # setup ensures alpha_i0 > 0.\n    with np.errstate(divide='ignore', invalid='ignore'):\n        T = np.nan_to_num(alpha / alpha_i0)\n\n    # Step 3: Calculate stationary distribution pi\n    # pi is the left eigenvector of T for eigenvalue 1, which is the right\n    # eigenvector of T.T for eigenvalue 1.\n    eigvals, eigvecs = np.linalg.eig(T.T)\n    \n    # Find the index of the eigenvalue that is close to 1\n    idx = np.isclose(eigvals, 1.0)\n    \n    # Extract the corresponding eigenvector (it should be real)\n    stationary_vec = np.real(eigvecs[:, idx].flatten())\n    \n    # Normalize the eigenvector so its components sum to 1\n    pi = stationary_vec / np.sum(stationary_vec)\n\n    # Step 4: Calculate credible intervals for rates k_ij\n    q_low = (1 - q) / 2\n    q_high = 1 - q_low\n    \n    K_CI_list = [[None for _ in range(n)] for _ in range(n)]\n    \n    k_off_diagonal_low = np.zeros_like(T)\n    k_off_diagonal_high = np.zeros_like(T)\n\n    # First, compute intervals for off-diagonal rates\n    for i in range(n):\n        row_sum_alpha = alpha_i0[i, 0]\n        for j in range(n):\n            if i != j:\n                a_ij = alpha[i, j]\n                b_ij = row_sum_alpha - a_ij\n                \n                # The Beta distribution parameters a_ij and b_ij are guaranteed to be > 0\n                # by the problem specification (A has positive entries).\n                p_low = stats.beta.ppf(q_low, a_ij, b_ij)\n                p_high = stats.beta.ppf(q_high, a_ij, b_ij)\n                \n                k_low = p_low / tau\n                k_high = p_high / tau\n                \n                K_CI_list[i][j] = [k_low, k_high]\n                k_off_diagonal_low[i, j] = k_low\n                k_off_diagonal_high[i, j] = k_high\n\n    # Second, compute intervals for diagonal rates using the row-sum constraint\n    S_low = k_off_diagonal_low.sum(axis=1)\n    S_high = k_off_diagonal_high.sum(axis=1)\n\n    for i in range(n):\n        K_CI_list[i][i] = [-S_high[i], -S_low[i]]\n\n    return [pi.tolist(), K_CI_list]\n\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1 (happy path, moderate counts)\n        {\n            \"C\": [[180, 15, 5], [20, 160, 20], [10, 30, 160]],\n            \"A\": [[1, 1, 1], [1, 1, 1], [1, 1, 1]],\n            \"tau\": 0.5,\n            \"q\": 0.95\n        },\n        # Case 2 (edge case, sparse counts with zeros and weak prior)\n        {\n            \"C\": [[0, 5, 0, 0], [0, 0, 10, 0], [0, 0, 0, 0], [2, 0, 0, 0]],\n            \"A\": np.full((4, 4), 0.2).tolist(),\n            \"tau\": 0.1,\n            \"q\": 0.90\n        },\n        # Case 3 (boundary condition, highly skewed counts with large totals)\n        {\n            \"C\": [[9500, 500], [300, 9700]],\n            \"A\": [[1, 1], [1, 1]],\n            \"tau\": 2.0,\n            \"q\": 0.99\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        # Main logic to calculate the result for one case goes here.\n        result = process_case(case[\"C\"], case[\"A\"], case[\"tau\"], case[\"q\"])\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    # The string representation is adjusted to avoid spaces after commas within the innermost lists\n    # to exactly match the expected output format which is typically very strict.\n    results_str = []\n    for res in results:\n        pi_str = str(res[0])\n        k_ci_str = '[' + ','.join(['[' + ','.join([f'[{l:.8f},{h:.8f}]' for l, h in row]) + ']' for row in res[1]]) + ']'\n        # A more standard string conversion with spaces is used here as it's more readable\n        # and usually accepted. Let's try the more standard one first.\n        pi_str = str(res[0])\n        k_ci_str = str(res[1])\n        results_str.append(f\"[{pi_str},{k_ci_str}]\")\n        \n    final_output = f\"[{','.join(results_str)}]\"\n    # Replacing spaces to match the dense format if needed\n    final_output = final_output.replace(\" \", \"\")\n    print(final_output)\n\nsolve()\n```", "id": "3404066"}]}