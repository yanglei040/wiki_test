{"hands_on_practices": [{"introduction": "在分子动力学中，数值积分器的稳定性至关重要，而系统中的高频运动（如化学键的振动）是决定最大积分时间步长的主要瓶颈。我们可以通过一个简化的谐振子模型来精确地理解这一限制。这个练习将指导你通过对广泛使用的速度Verlet积分方法进行线性稳定性分析，从第一性原理推导出其稳定性条件，从而将振动模式的频率与允许的最大时间步长直接联系起来。这项实践不仅能让你掌握核心的理论推导，还能让你体会到数值稳定性与模拟精度之间的重要区别。[@problem_id:3415676]", "problem": "在分子动力学（MD）中，一维高频振动模式可以建模为一个谐振子，其势能为 $U(x) = \\tfrac{1}{2} k x^{2}$，质量为 $m$，其中 $x$ 是位移， $k$ 是力常数， $m$ 是质量。其运动方程源自牛顿第二定律 $m \\,\\dfrac{d^{2} x}{d t^{2}} = -k x$，该方程定义了角频率 $\\omega$ 为 $\\omega = \\sqrt{k/m}$。考虑使用速度 Verlet 积分器进行数值时间演化，时间步长为 $d t$。更新方程为\n$$x_{n+1} = x_{n} + v_{n} d t + \\tfrac{1}{2} a_{n} d t^{2}, \\quad v_{n+1} = v_{n} + \\tfrac{1}{2} \\big(a_{n} + a_{n+1}\\big) d t,$$\n其中 $a_{n} = -\\omega^{2} x_{n}$ 是第 $n$ 步的加速度。\n\n从这些定义和方程出发，对离散动力学进行线性稳定性分析，以获得确保数值解有界运动的稳定性条件。然后，利用该结果，确定在以下物理上现实的参数下的最大时间步长 $d t_{\\max}$：\n- $k = 500\\,\\mathrm{N/m}$，\n- $m = 1.000\\,\\mathrm{amu}$，换算关系为 $1\\,\\mathrm{amu} = 1.66053906660 \\times 10^{-27}\\,\\mathrm{kg}$。\n\n将 $d t_{\\max}$ 以飞秒表示，并将答案四舍五入到四位有效数字。最后，阐述为何在实践中通常选择远小于稳定性所允许的最大时间步长，讨论除了纯粹的数值稳定性之外，对高频模式的精度考虑。", "solution": "该问题是有效的，因为它科学地基于经典力学和数值分析的原理，问题提出得很好，有明确的目标和足够的数据，并且是客观地表述的。该分析涉及速度 Verlet 算法的稳定性，这是分子动力学模拟的基石。\n\n求解过程分为三部分：首先，进行线性稳定性分析以推导稳定性条件；其次，根据给定的物理参数计算最大稳定时间步长；第三，讨论为何实际应用中的时间步长会选择得比这个最大值小。\n\n**1. 线性稳定性分析**\n\n该系统是一个一维谐振子，其运动方程为 $m \\ddot{x} = -k x$，可以写成 $\\ddot{x} = -\\omega^2 x$，其中 $\\omega = \\sqrt{k/m}$ 是角频率。在时间步长 $n$ 处的加速度为 $a_n = -\\omega^2 x_n$。\n\n速度 Verlet 算法由以下更新方程给出：\n$$x_{n+1} = x_{n} + v_{n} d t + \\tfrac{1}{2} a_{n} d t^{2}$$\n$$v_{n+1} = v_{n} + \\tfrac{1}{2} \\big(a_{n} + a_{n+1}\\big) d t$$\n\n为了进行稳定性分析，我们将系统在第 $n+1$ 步的状态（由向量 $\\mathbf{z}_{n+1} = \\begin{pmatrix} x_{n+1} \\\\ v_{n+1} \\end{pmatrix}$ 表示）表示为第 $n$ 步状态 $\\mathbf{z}_{n} = \\begin{pmatrix} x_{n} \\\\ v_{n} \\end{pmatrix}$ 的线性变换。这定义了传递矩阵 $\\mathbf{T}$，使得 $\\mathbf{z}_{n+1} = \\mathbf{T} \\mathbf{z}_{n}$。\n\n首先，我们将 $a_n = -\\omega^2 x_n$ 代入位置更新方程：\n$$x_{n+1} = x_{n} + v_{n} d t - \\tfrac{1}{2} \\omega^{2} x_{n} d t^{2} = \\left(1 - \\tfrac{1}{2}\\omega^2 dt^2\\right) x_n + v_n dt$$\n\n接下来，我们用 $x_n$ 和 $v_n$ 来表示 $v_{n+1}$。我们在速度更新方程中使用 $a_{n+1} = -\\omega^2 x_{n+1}$：\n$$v_{n+1} = v_{n} + \\tfrac{1}{2} \\left(-\\omega^2 x_n - \\omega^2 x_{n+1}\\right) dt = v_n - \\tfrac{1}{2} \\omega^2 dt (x_n + x_{n+1})$$\n代入 $x_{n+1}$ 的表达式：\n$$v_{n+1} = v_n - \\tfrac{1}{2} \\omega^2 dt \\left(x_n + \\left(1 - \\tfrac{1}{2}\\omega^2 dt^2\\right) x_n + v_n dt\\right)$$\n$$v_{n+1} = v_n - \\tfrac{1}{2} \\omega^2 dt \\left(\\left(2 - \\tfrac{1}{2}\\omega^2 dt^2\\right) x_n + v_n dt\\right)$$\n$$v_{n+1} = -\\omega^2 dt \\left(1 - \\tfrac{1}{4}\\omega^2 dt^2\\right) x_n + \\left(1 - \\tfrac{1}{2}\\omega^2 dt^2\\right) v_n$$\n\n现在我们可以将系统写成矩阵形式：\n$$\\begin{pmatrix} x_{n+1} \\\\ v_{n+1} \\end{pmatrix} = \\begin{pmatrix} 1 - \\tfrac{1}{2}\\omega^2 dt^2  dt \\\\ -\\omega^2 dt \\left(1 - \\tfrac{1}{4}\\omega^2 dt^2\\right)  1 - \\tfrac{1}{2}\\omega^2 dt^2 \\end{pmatrix} \\begin{pmatrix} x_n \\\\ v_n \\end{pmatrix}$$\n\n传递矩阵是：\n$$\\mathbf{T} = \\begin{pmatrix} 1 - \\tfrac{1}{2}\\omega^2 dt^2  dt \\\\ -\\omega^2 dt \\left(1 - \\tfrac{1}{4}\\omega^2 dt^2\\right)  1 - \\tfrac{1}{2}\\omega^2 dt^2 \\end{pmatrix}$$\n\n为了使数值解保持有界（稳定），传递矩阵 $\\mathbf{T}$ 的特征值 $\\lambda$ 的模长不得超过 $1$，即 $|\\lambda| \\le 1$。特征值是特征方程 $\\det(\\mathbf{T} - \\lambda \\mathbf{I}) = 0$ 的根。设 $A = 1 - \\tfrac{1}{2}\\omega^2 dt^2$。\n$$\\det \\begin{pmatrix} A - \\lambda  dt \\\\ -\\omega^2 dt \\left(1 - \\tfrac{1}{4}\\omega^2 dt^2\\right)  A - \\lambda \\end{pmatrix} = 0$$\n$$(A - \\lambda)^2 + \\omega^2 dt^2 \\left(1 - \\tfrac{1}{4}\\omega^2 dt^2\\right) = 0$$\n$$\\lambda^2 - 2A\\lambda + A^2 + \\omega^2 dt^2 - \\tfrac{1}{4}\\omega^4 dt^4 = 0$$\n注意 $\\det(\\mathbf{T}) = A^2 + \\omega^2 dt^2 (1 - \\tfrac{1}{4}\\omega^2 dt^2) = (1-\\tfrac{1}{2}\\omega^2 dt^2)^2 + \\omega^2 dt^2 - \\tfrac{1}{4}\\omega^4 dt^4 = 1 - \\omega^2 dt^2 + \\tfrac{1}{4}\\omega^4 dt^4 + \\omega^2 dt^2 - \\tfrac{1}{4}\\omega^4 dt^4 = 1$。由于特征值的乘积为 $1$，如果一个特征值的模长 $|\\lambda|  1$（因此另一个特征值的模长 $|\\lambda|  1$），则会出现不稳定性。稳定性要求特征值是单位圆上的共轭复数。这在二次特征方程的判别式为非正数时发生。\n根为 $\\lambda = A \\pm \\sqrt{A^2 - \\det(\\mathbf{T})} = A \\pm \\sqrt{A^2-1}$。\n对于复数根，我们需要 $A^2 - 1 \\le 0$，即 $|A| \\le 1$。\n$$|1 - \\tfrac{1}{2}\\omega^2 dt^2| \\le 1$$\n这个不等式可以分解为两个条件：\n1) $1 - \\tfrac{1}{2}\\omega^2 dt^2 \\le 1 \\implies -\\tfrac{1}{2}\\omega^2 dt^2 \\le 0$，由于 $\\omega^2  0$ 和 $dt^2  0$，这个条件恒成立。\n2) $1 - \\tfrac{1}{2}\\omega^2 dt^2 \\ge -1 \\implies 2 \\ge \\tfrac{1}{2}\\omega^2 dt^2 \\implies 4 \\ge \\omega^2 dt^2$。\n由于 $\\omega  0$ 且 $dt  0$，我们取平方根：\n$$\\omega dt \\le 2$$\n这就是速度 Verlet 积分器应用于谐振子时的稳定性条件。\n\n**2. 最大时间步长的计算**\n\n稳定性条件 $\\omega dt \\le 2$ 给出了最大允许时间步长为 $dt_{\\max} = \\frac{2}{\\omega}$。我们已获得计算该值所需的物理参数。\n- $k = 500 \\, \\mathrm{N/m} = 500 \\, \\mathrm{kg/s^2}$\n- $m = 1.000 \\, \\mathrm{amu}$\n- $1 \\, \\mathrm{amu} = 1.66053906660 \\times 10^{-27} \\, \\mathrm{kg}$\n\n首先，我们计算以国际单位制（SI）表示的质量：\n$$m = 1.000 \\times (1.66053906660 \\times 10^{-27} \\, \\mathrm{kg}) = 1.66053906660 \\times 10^{-27} \\, \\mathrm{kg}$$\n\n接下来，我们计算角频率 $\\omega$：\n$$\\omega = \\sqrt{\\frac{k}{m}} = \\sqrt{\\frac{500 \\, \\mathrm{kg/s^2}}{1.66053906660 \\times 10^{-27} \\, \\mathrm{kg}}}$$\n$$\\omega \\approx \\sqrt{3.01106031 \\times 10^{29} \\, \\mathrm{s}^{-2}} \\approx 5.48731305 \\times 10^{14} \\, \\mathrm{s}^{-1}$$\n\n现在，我们计算最大时间步长 $dt_{\\max}$：\n$$dt_{\\max} = \\frac{2}{\\omega} = \\frac{2}{5.48731305 \\times 10^{14} \\, \\mathrm{s}^{-1}} \\approx 3.644743 \\times 10^{-15} \\, \\mathrm{s}$$\n\n最后，我们将结果转换为飞秒（$1 \\, \\mathrm{fs} = 10^{-15} \\, \\mathrm{s}$）并四舍五入到四位有效数字：\n$$dt_{\\max} \\approx 3.644743 \\, \\mathrm{fs}$$\n$$dt_{\\max} \\approx 3.645 \\, \\mathrm{fs}$$\n\n**3. 使用更小时间步长的理由**\n\n稳定性条件 $\\omega dt \\le 2$ 仅确保数值轨迹不会指数发散；它不保证准确性。在实践中，分子动力学模拟必须准确地再现物理动力学过程，这对时间步长 $dt$ 施加了更严格的约束。\n\n对于振子而言，准确性的主要衡量标准是数值积分在多大程度上能够守恒能量并再现正确的振荡频率。尽管速度 Verlet 算法是辛算法，并表现出优异的长期能量守恒性，但它会引入一个取决于时间步长大小的相位误差。这个误差表现为振荡频率的偏移。\n\n数值振荡器的频率 $\\omega_{\\text{num}}$ 可以通过传递矩阵的特征值与真实频率 $\\omega$ 联系起来。特征值为 $\\lambda = e^{\\pm i \\omega_{\\text{num}} dt}$。其实部为 $\\Re(\\lambda) = \\cos(\\omega_{\\text{num}} dt)$。根据我们的分析，$\\Re(\\lambda) = A = 1 - \\tfrac{1}{2}(\\omega dt)^2$。\n因此，我们有以下关系：\n$$\\cos(\\omega_{\\text{num}} dt) = 1 - \\tfrac{1}{2}(\\omega dt)^2$$\n我们可以解出 $\\omega_{\\text{num}}$：\n$$\\omega_{\\text{num}} = \\frac{1}{dt} \\arccos\\left(1 - \\tfrac{1}{2}(\\omega dt)^2\\right)$$\n值得注意的是，对于较小的 $\\omega dt$，泰勒展开显示 $\\omega_{\\text{num}} \\approx \\omega(1 - \\frac{1}{24}(\\omega dt)^2)$，表明数值振荡器比真实振荡器慢，导致相位滞后随时间增加。然而，在稳定性极限 $\\omega dt = 2$ 处，我们得到 $\\omega_{\\text{num}} = \\frac{1}{(2/\\omega)} \\arccos(1 - \\frac{1}{2}(2)^2) = \\frac{\\omega}{2} \\arccos(-1) = \\frac{\\pi \\omega}{2} \\approx 1.57\\omega$。这说明相位误差的行为在接近极限时会发生质的变化，并且误差变得非常大，证实了在实践中必须选取远小于极限的时间步长。\n\n频率的相对误差约为 $\\frac{\\omega_{\\text{num}} - \\omega}{\\omega} \\approx -\\frac{1}{24}(\\omega dt)^2$。\n为了保持高保真度，频率误差必须保持在很小的范围内。例如，为了将相对频率误差保持在 $1\\%$ ($0.01$) 以下，我们需要：\n$$\\frac{1}{24}(\\omega dt)^2 \\lesssim 0.01$$\n$$(\\omega dt)^2 \\lesssim 0.24 \\implies \\omega dt \\lesssim \\sqrt{0.24} \\approx 0.49$$\n这个条件 $\\omega dt \\lesssim 0.5$ 比稳定性条件 $\\omega dt \\le 2$ 严格四倍。这意味着时间步长必须至少比 $dt_{\\max}$ 小四倍。\n\n在 MD 中，一个普遍的经验法则是使用一个比系统中最快振动模式的周期（$T = 2\\pi/\\omega$）小至少一个数量级的时间步长。这对应于 $dt \\approx T/10 = (2\\pi/\\omega)/10 = (\\pi/5)\\omega \\approx 0.628/\\omega$。选择 $dt \\approx 0.6/\\omega$ 可以确保最快的振荡在每个周期内被多次采样，从而实现其动力学的精确积分，并保持可接受的能量守恒和相位准确性。对于本问题中的系统，这个实用规则建议的时间步长为 $dt \\approx \\frac{0.628}{5.487 \\times 10^{14}} \\approx 1.14 \\, \\mathrm{fs}$，这远小于 $dt_{\\max}=3.645 \\, \\mathrm{fs}$。\n\n总之，数值稳定性仅仅是防止模拟爆炸的阈值。要获得准确且具有物理意义的结果，需要使用小得多的时间步长，以最小化积分误差，特别是高频模式的相位误差。", "answer": "$$\\boxed{3.645}$$", "id": "3415676"}, {"introduction": "在掌握了谐振子稳定性的基本原理后，让我们来探讨一个现代模拟技术中的实际挑战。为了更精确地描述分子间的相互作用，可极化力场被越来越多地采用，其中一种流行的模型是Drude振子模型。这些振子被特意设计成具有很小的质量和很大的弹性系数，这导致了极高的振动频率。这项练习将展示物理建模中的选择如何直接影响计算成本。通过计算Drude振子所需的安全时间步长，你将深刻理解为何这些高级模型通常需要特殊的多时间步或约束算法来处理。[@problem_id:3415640]", "problem": "一个可极化力场可以通过在每个可极化位点上附加一个一维谐振德鲁德振子来表示，该振子的质量为 $m_{D}$，劲度系数为 $k_{D}$。考虑一个由牛顿第二定律和胡克恢复力支配的单个德鲁德振子。您将分析应用于此谐振动的显式速度Verlet时间离散化方法，以确定一个保守的时间步长约束，从而避免由最高频率模式引起的数值不稳定性。\n\n从德鲁德振子满足 $m_{D}\\,\\frac{d^{2}x}{dt^{2}}=-k_{D}\\,x$ 这一基本出发点，并考虑到对于线性稳定性分析，速度Verlet方案等效于二阶导数的中心差分离散化，请执行以下操作：\n\n1. 对于由 $m_{D}\\,\\frac{d^{2}x}{dt^{2}}+k_{D}\\,x=0$ 支配的谐振子 $x$，使用恒定时间步长 $dt$ 进行积分，推导其离散时间线性稳定性条件。您的推导过程必须通过将形式为 $x_{n}=\\lambda^{n}$ 的试探解代入中心差分方程，并强制要求放大因子满足 $|\\lambda|\\leq 1$ 来进行。\n\n2. 使用您的稳定性条件和振子频率 $\\omega_{D}=\\sqrt{k_{D}/m_{D}}$，用 $\\omega_{D}$ 定义线性稳定性极限 $dt_{\\max}$，然后采用保守的安全因子 $s=0.5$ 来定义 $dt_{\\text{safe}}=s\\,dt_{\\max}$。\n\n3. 对于一个具有 $k_{D}=6.642\\times 10^{4}\\,\\text{N}\\,\\text{m}^{-1}$ 和 $m_{D}=6.642\\times 10^{-28}\\,\\text{kg}$ 的代表性可极化模型，数值计算 $dt_{\\text{safe}}$。用飞秒（fs）表示您的最终时间步长，其中 $1\\,\\text{fs}=10^{-15}\\,\\text{s}$，并将您的答案四舍五入到三位有效数字。\n\n用文字简要比较您计算出的 $dt_{\\text{safe}}$ 与分子动力学（MD）中使用的典型原子时间步长（如 $1\\,\\text{fs}$ 和 $2\\,\\text{fs}$），并解释为什么这种高频德鲁德模式的存在会限制全局时间步长。您最终报告的值必须是一个单一的数字。", "solution": "该问题要求分析应用于谐振德鲁德振子的速度Verlet积分方案的数值稳定性，该振子用于在分子动力学中模拟可极化性。该分析将确定一个安全的积分时间步长 $dt_{\\text{safe}}$。问题分为三个部分：推导稳定性条件，定义安全时间步长，以及根据给定参数计算其数值。\n\n首先，我们来推导离散时间线性稳定性条件。一维德鲁德振子的运动方程为 $m_{D}\\,\\frac{d^{2}x}{dt^{2}}=-k_{D}\\,x$，可以写成简谐振子的标准形式：\n$$\\frac{d^{2}x}{dt^{2}} + \\omega_{D}^{2}\\,x = 0$$\n其中 $\\omega_{D} = \\sqrt{k_{D}/m_{D}}$ 是振子的自然频率。\n\n问题指出，对于线性稳定性分析，速度Verlet方案等效于使用中心差分法对二阶导数进行离散化。对于一个离散时间步长 $dt$，我们将时间 $t_n = n\\,dt$ 处的加速度近似为：\n$$\\frac{d^{2}x}{dt^{2}}\\bigg|_{t=t_n} \\approx \\frac{x_{n+1} - 2x_n + x_{n-1}}{(dt)^2}$$\n其中 $x_n = x(t_n)$。将此代入运动方程，得到有限差分方程：\n$$\\frac{x_{n+1} - 2x_n + x_{n-1}}{(dt)^2} + \\omega_{D}^{2}\\,x_n = 0$$\n这可以重新排列为关于位置 $x_n$ 的线性递推关系：\n$$x_{n+1} = \\left(2 - (\\omega_{D}dt)^2\\right)x_n - x_{n-1}$$\n为分析此递推关系的稳定性，我们假设一个形式为 $x_n = \\lambda^n$ 的试探解，其中 $\\lambda$ 是一个复数放大因子。稳定的解要求 $\\lambda$ 的模长不超过1，即 $|\\lambda| \\leq 1$。代入试探解可得：\n$$\\lambda^{n+1} = \\left(2 - (\\omega_{D}dt)^2\\right)\\lambda^n - \\lambda^{n-1}$$\n假设存在非平凡解（$\\lambda \\neq 0$），我们可以两边同除以 $\\lambda^{n-1}$，得到关于 $\\lambda$ 的特征方程，这是一个二次方程：\n$$\\lambda^2 - \\left(2 - (\\omega_{D}dt)^2\\right)\\lambda + 1 = 0$$\n该方程的根决定了数值解的行为。为使解保持有界，根必须位于复平面的单位圆内或圆上。这些根由二次公式给出：\n$$\\lambda_{\\pm} = \\frac{\\left(2 - (\\omega_{D}dt)^2\\right) \\pm \\sqrt{\\left(2 - (\\omega_{D}dt)^2\\right)^2 - 4}}{2}$$\n为使根为复数或重实根，判别式必须为非正：\n$$\\Delta = \\left(2 - (\\omega_{D}dt)^2\\right)^2 - 4 \\leq 0$$\n这个不等式等价于：\n$$\\left(2 - (\\omega_{D}dt)^2\\right)^2 \\leq 4$$\n两边取平方根，我们得到：\n$$-2 \\leq 2 - (\\omega_{D}dt)^2 \\leq 2$$\n这个复合不等式包含两个条件。第一个条件 $2 - (\\omega_{D}dt)^2 \\leq 2$ 简化为 $-(\\omega_{D}dt)^2 \\leq 0$，对于实数 $\\omega_{D}$ 和 $dt$ 总是成立的。第二个条件 $-2 \\leq 2 - (\\omega_{D}dt)^2$ 提供了关键的约束：\n$$(\\omega_{D}dt)^2 \\leq 4$$\n由于 $\\omega_D$ 和 $dt$ 本身是正数，我们可以取平方根得到线性稳定性条件：\n$$\\omega_{D}dt \\leq 2$$\n当此条件成立时，根是模长为 $|\\lambda|=1$ 的共轭复数，从而得到一个稳定的、非耗散的振荡解。如果 $\\omega_{D}dt  2$，一个根会变为模长大于1的实数，导致指数增长和数值不稳定性。\n\n第二，我们使用这个条件来定义最大和安全时间步长。积分保持稳定的最大时间步长 $dt_{\\max}$ 由等式给出：\n$$dt_{\\max} = \\frac{2}{\\omega_{D}}$$\n应用一个保守的安全因子 $s=0.5$ 来定义安全时间步长 $dt_{\\text{safe}}$：\n$$dt_{\\text{safe}} = s \\cdot dt_{\\max} = 0.5 \\cdot \\frac{2}{\\omega_{D}} = \\frac{1}{\\omega_{D}}$$\n\n第三，我们根据给定的参数 $k_{D}=6.642\\times 10^{4}\\,\\text{N}\\,\\text{m}^{-1}$ 和 $m_{D}=6.642\\times 10^{-28}\\,\\text{kg}$ 对 $dt_{\\text{safe}}$ 进行数值计算。\n角频率 $\\omega_D$ 为：\n$$\\omega_{D} = \\sqrt{\\frac{k_{D}}{m_{D}}} = \\sqrt{\\frac{6.642\\times 10^{4}\\,\\text{N}\\,\\text{m}^{-1}}{6.642\\times 10^{-28}\\,\\text{kg}}} = \\sqrt{10^{32}\\,\\text{s}^{-2}} = 10^{16}\\,\\text{s}^{-1}$$\n使用这个频率，我们计算安全时间步长：\n$$dt_{\\text{safe}} = \\frac{1}{\\omega_{D}} = \\frac{1}{10^{16}\\,\\text{s}^{-1}} = 10^{-16}\\,\\text{s}$$\n为了用飞秒（$1\\,\\text{fs} = 10^{-15}\\,\\text{s}$）表示这个值：\n$$dt_{\\text{safe}} = 10^{-16}\\,\\text{s} \\times \\frac{1\\,\\text{fs}}{10^{-15}\\,\\text{s}} = 0.1\\,\\text{fs}$$\n按要求四舍五入到三位有效数字，最终值为 $0.100\\,\\text{fs}$。\n\n计算出的安全时间步长 $dt_{\\text{safe}} = 0.100\\,\\text{fs}$ 比标准分子动力学模拟中使用的典型时间步长 $1\\,\\text{fs}$ 或 $2\\,\\text{fs}$ 小一个数量级。这个严格约束的原因是，像速度Verlet这样的显式积分器的数值稳定性受系统中最高频率运动的支配。德鲁德振子频率 $\\omega_D = 10^{16}\\,\\text{s}^{-1}$ 非常高，对应的振荡周期为 $T_D = 2\\pi/\\omega_D \\approx 0.628\\,\\text{fs}$。为防止数值积分变得不稳定，时间步长必须足够短以解析这种最快的运动，这要求 $dt$ 是 $T_D$ 的一小部分。如果使用典型的 $1\\,\\text{fs}$ 时间步长，将违反稳定性判据 $\\omega_{D}dt \\leq 2$（因为 $10^{16}\\,\\text{s}^{-1} \\times 10^{-15}\\,\\text{s} = 10  2$），导致模拟发生灾难性失败。因此，包含高频德鲁德模式需要一个更小的全局时间步长，这会显著增加模拟的计算成本。", "answer": "$$\\boxed{0.100}$$", "id": "3415640"}, {"introduction": "既然高频振动模式严重限制了时间步长，一个常见的应对策略便是使用约束算法将其完全“冻结”，例如固定键长。然而，这种处理方式会对模拟的基本性质（如能量守恒）产生深远影响。这项练习将引导你深入分析和对比有约束与无约束动力学中总能量的长期行为。通过区分辛积分器（如无约束的Verlet算法）产生的有界能量振荡和由不精确约束求解（如SHAKE/RATTLE算法）引起的非辛性所导致的长期能量漂移，你将能够更批判性地评估模拟结果的质量，并为特定问题选择最合适的积分方案。[@problem_id:3415632]", "problem": "在分子动力学（MD）中，广泛使用刚性键近似来消除高频振动模式（HFVM），从而可以在不破坏积分器稳定性的前提下采用更大的时间步长。考虑一个双原子分子，其原子质量均为 $m$，通过一个刚性谐振子键势 $V(r) = \\tfrac{1}{2} k (r - r_0)^2$ 连接，其中 $r$ 是原子间距，$r_0$ 是平衡键长，$k$ 是一个大的刚度常数。折合质量为 $\\mu = m/2$，因此键的自然频率为 $\\omega_h = \\sqrt{k / \\mu}$。考虑两种数值方案：\n\n(i) 将无约束的速度Verlet方案应用于完整的哈密顿动力学，其中刚性键势未通过约束进行解析，使用一个满足该方法线性稳定性条件的恒定时间步长 $dt$。\n\n(ii) 一种有约束的速度Verlet方案，通过每一步的位置和速度校正来施加完整键长约束 $r = r_0$，使用一种SHAKE/RATTLE类型方法中的投影算法，该算法迭代求解约束残差，直至其在指定容差 $\\epsilon_c$ 以内，$\\epsilon_c$ 定义为每步校正后位置约束违背的最大范数。\n\n假设没有恒温器、没有恒压器、没有外力，并忽略舍入误差。所有校正都是确定性地执行的。对于方案(ii)，假设约束求解器如果运行到精确满足约束（$\\epsilon_c = 0$），会产生一个辛约束映射；否则，对于有限的 $\\epsilon_c  0$，该映射会偏离精确的辛性。\n\n从双原子系统的牛顿第二定律 $m \\,\\ddot{\\boldsymbol{r}}_1 = - \\nabla_{\\boldsymbol{r}_1} V$，$m \\,\\ddot{\\boldsymbol{r}}_2 = - \\nabla_{\\boldsymbol{r}_2} V$ 出发，并根据速度Verlet在无约束情况下作为二阶、时间可逆、辛积分器的定义，推断在每种方案下总能量 $E(t)$ 的定性和定量的长时间行为。特别是，确定以下各项的领头阶标度（用 $dt$, $\\omega_h$ 和 $\\epsilon_c$ 表示）：\n\n- 方案(i)下 $E(t)$ 围绕其均值的有界振荡的振幅。\n- 方案(i)下 $E(t)$ 中是否存在长期漂移及其速率。\n- 当 $\\epsilon_c  0$ 但很小时，方案(ii)下 $E(t)$ 中有界振荡的振幅。\n- 当 $\\epsilon_c  0$ 但很小时，方案(ii)下 $E(t)$ 中是否存在长期漂移及其速率。\n\n选择最准确地描述这些标度和行为的选项。\n\nA. 对于方案(i)，$E(t)$ 表现出振幅标度为 $\\mathcal{O}\\!\\left( (\\omega_h dt)^2 \\right)$ 的有界振荡，且没有长期漂移。对于方案(ii)，当 $\\epsilon_c  0$ 时，该方法失去精确的辛性，并产生一个速率标度为 $\\mathcal{O}\\!\\left( \\epsilon_c^2 / dt \\right)$ 的长期能量漂移，而剩余自由度（DOF）的能量误差的振荡分量标度为 $\\mathcal{O}\\!\\left( dt^2 \\right)$。\n\nB. 对于方案(i)，$E(t)$ 显示出速率为 $\\mathcal{O}\\!\\left( dt \\right)$ 的长期漂移；对于方案(ii)，约束校正完全消除了漂移，只留下振幅为 $\\mathcal{O}\\!\\left( dt^3 \\right)$ 的有界振荡。\n\nC. 对于方案(i)，有界能量振荡的振幅为 $\\mathcal{O}\\!\\left( dt \\right)$；对于方案(ii)，长期漂移速率为 $\\mathcal{O}\\!\\left( \\epsilon_c / dt \\right)$，振荡分量为 $\\mathcal{O}\\!\\left( dt \\right)$。\n\nD. 对于方案(i)，$E(t)$ 表现出振幅为 $\\mathcal{O}\\!\\left( dt^2 \\right)$ 的有界振荡，外加一个以速率 $\\mathcal{O}\\!\\left( dt^3 \\right)$ 累积的长期漂移；对于方案(ii)，长期漂移速率为 $\\mathcal{O}\\!\\left( \\epsilon_c \\right)$，与 $dt$ 无关。\n\nE. 对于任何 $\\epsilon_c \\ge 0$，两种方案都产生振幅为 $\\mathcal{O}\\!\\left( dt^2 \\right)$ 的纯粹有界振荡，且长期漂移精确为零。", "solution": "该问题陈述是分子动力学数值积分器分析中的一个有效练习。它具有科学依据、问题良定且客观。它准确地描述了两种标准的模拟方案，并就其长时间能量守恒性质提出了一个理论上合理的问题。因此，我们可以进行完整的解答。\n\n分析的关键在于速度Verlet积分器的性质以及施加完整约束的效果。\n\n**方案(i)：无约束的速度Verlet**\n\n速度Verlet算法是一种二阶、时间可逆的辛积分器。根据后向误差分析建立的辛性的一个关键推论是，由积分器生成的数值轨迹并不精确守恒真实的哈密顿量 $H$，而是精确守恒一个附近的“影子哈密顿量” $\\tilde{H}$。对于时间步长为 $dt$ 的二阶积分器，影子哈密顿量可以表示为一个渐近级数：\n$$ \\tilde{H} = H + dt^2 H_2 + dt^4 H_4 + \\dots $$\n其中 $H_2$, $H_4$ 等是涉及势能高阶导数的位置和动量的函数。\n\n由于数值轨迹精确守恒 $\\tilde{H}$，真实系统的总能量 $E(t) = H(\\boldsymbol{q}(t), \\boldsymbol{p}(t))$ 会围绕 $\\tilde{H}$ 的恒定值表现出有界振荡。平均能量没有长期（长期的、系统的）漂移。\n\n这些能量振荡的振幅由影子哈密顿量中的领头阶修正项 $dt^2 H_2$ 的大小决定。$H_2$ 项涉及哈密顿量与自身的泊松括号，并与势的刚度成比例。对于自然频率为 $\\omega_h$ 的谐振子，$H_2$ 项将包含与力常数 $k = \\mu \\omega_h^2$ 成正比的因子。控制误差的无量纲参数是 $\\omega_h dt$。详细分析表明，能量振荡的振幅与此参数成二次方关系。\n$$ \\text{Amplitude}(E_{\\text{osc}}) \\sim \\mathcal{O}\\! \\left( ( \\omega_h dt )^2 \\right) $$\nVerlet积分器的稳定性要求 $\\omega_h dt \\le 2$，因此这个无量纲量是高频模式误差的正确度量。\n\n总之，对于方案(i)，总能量 $E(t)$ 表现出振幅标度为 $\\mathcal{O}((\\omega_h dt)^2)$ 的有界振荡，且没有长期漂移。\n\n**方案(ii)：有约束的速度Verlet (SHAKE/RATTLE)**\n\n该方案用一个刚性完整约束 $g(\\boldsymbol{r}) = r - r_0 = 0$ 替代了刚性谐振子键。SHAKE/RATTLE算法用于在每个时间步施加此约束。\n\n问题陈述正确地指出，如果约束方程被解到机器精度（即 $\\epsilon_c = 0$），那么得到的映射（例如RATTLE）在约束相空间上将是辛的。在这种理想化的情况下，能量行为将类似于方案(i)，但高频 $\\omega_h$ 已被消除。剩余的自由度（平动和转动）具有低得多的特征频率，导致振幅为 $\\mathcal{O}(dt^2)$ 的有界能量振荡，并且没有长期漂移。\n\n然而，问题指定了一个有限容差 $\\epsilon_c  0$。这意味着当位置约束违背小于或等于 $\\epsilon_c$ 时，约束方程的迭代求解器会终止。这种不精确的解在每一步都会引入一个小的非保守微扰，破坏了积分方案的精确辛性。一个非辛积分器通常会表现出能量的长期漂移。\n\n我们可以估算这种漂移的速率。位置约束违背为 $|\\Delta r| \\sim \\mathcal{O}(\\epsilon_c)$。这意味着原子间距为 $r \\approx r_0 \\pm \\epsilon_c$，这会引入一个残余势能和来自原始势的一个相关的人为恢复力，$F_{\\text{res}} \\approx k \\Delta r \\sim \\mathcal{O}(k \\epsilon_c)$。用于速度的RATTLE算法也会产生一个与 $\\epsilon_c$ 相关的误差。平行于键的速度分量本应为零，但现在非零且标度为 $v_{\\parallel} \\sim \\mathcal{O}(\\epsilon_c / dt)$。这个非零速度意味着残余力可以做功。在单个时间步长 $\\Delta t = dt$ 内，这个人为力所做的功近似为：\n$$ \\Delta E_{\\text{step}} \\approx F_{\\text{res}} \\cdot (v_{\\parallel} \\cdot dt) $$\n代入标度行为：\n$$ \\Delta E_{\\text{step}} \\sim (k \\epsilon_c) \\cdot (\\frac{\\epsilon_c}{dt} \\cdot dt) \\sim k \\epsilon_c^2 $$\n这是每步的能量漂移。长期能量漂移的速率是每步的漂移除以时间步长：\n$$ \\frac{dE}{dt} \\approx \\frac{\\Delta E_{\\text{step}}}{dt} \\sim \\mathcal{O}\\! \\left( \\frac{k \\epsilon_c^2}{dt} \\right) \\sim \\mathcal{O}\\! \\left( \\frac{\\omega_h^2 \\epsilon_c^2}{dt} \\right) $$\n问题要求用给定参数表示标度，因此速率标度为 $\\mathcal{O}(\\epsilon_c^2 / dt)$。\n\n除了这种漂移之外，底层的二阶积分器仍然在演化剩余的、无约束的自由度（例如，质心平动、整体转动）。与这些较慢运动相关的能量将表现出Verlet方法的特征性有界振荡，其振幅标度为 $\\mathcal{O}(dt^2)$。\n\n总之，对于 $\\epsilon_c  0$ 的方案(ii)，总能量 $E(t)$ 呈现出一个速率标度为 $\\mathcal{O}(\\epsilon_c^2/dt)$ 的长期漂移和振幅标度为 $\\mathcal{O}(dt^2)$ 的有界振荡的叠加。\n\n**选项评估**\n\n*   **A. 对于方案(i)，$E(t)$ 表现出振幅标度为 $\\mathcal{O}\\!\\left( (\\omega_h dt)^2 \\right)$ 的有界振荡，且没有长期漂移。对于方案(ii)，当 $\\epsilon_c  0$ 时，该方法失去精确的辛性，并产生一个速率标度为 $\\mathcal{O}\\!\\left( \\epsilon_c^2 / dt \\right)$ 的长期能量漂移，而剩余自由度（DOF）的能量误差的振荡分量标度为 $\\mathcal{O}\\!\\left( dt^2 \\right)$。**\n    此陈述与我们为两种方案推导出的行为完全匹配。对方案(i)的分析（有界振荡标度为 $\\mathcal{O}((\\omega_h dt)^2)$，无漂移）是正确的。对方案(ii)的分析（由非辛性引起的长期漂移，漂移速率标度为 $\\mathcal{O}(\\epsilon_c^2/dt)$，以及底层振荡标度为 $\\mathcal{O}(dt^2)$）也是正确的。\n    **结论：正确。**\n\n*   **B. 对于方案(i)，$E(t)$ 显示出速率为 $\\mathcal{O}\\!\\left( dt \\right)$ 的长期漂移；对于方案(ii)，约束校正完全消除了漂移，只留下振幅为 $\\mathcal{O}\\!\\left( dt^3 \\right)$ 的有界振荡。**\n    此陈述在多个方面都是不正确的。方案(i)使用辛积分器，没有领头阶的长期漂移。对于方案(ii)，使用有限容差 $\\epsilon_c  0$ *引入了*长期漂移，而不是消除了它。对于二阶方法，振荡的振幅标度为 $\\mathcal{O}(dt^2)$，而不是 $\\mathcal{O}(dt^3)$。\n    **结论：不正确。**\n\n*   **C. 对于方案(i)，有界能量振荡的振幅为 $\\mathcal{O}\\!\\left( dt \\right)$；对于方案(ii)，长期漂移速率为 $\\mathcal{O}\\!\\left( \\epsilon_c / dt \\right)$，振荡分量为 $\\mathcal{O}\\!\\left( dt \\right)$。**\n    此陈述不正确。对于方案(i)，能量振荡的振幅标度为 $\\mathcal{O}(dt^2)$，而不是 $\\mathcal{O}(dt)$。对于方案(ii)，尽管漂移速率的标度在文献中存在一些争议（一些分析得出 $\\mathcal{O}(\\epsilon_c/dt)$），但振荡分量的标度为 $\\mathcal{O}(dt)$ 是绝对错误的；它应该是 $\\mathcal{O}(dt^2)$。\n    **结论：不正确。**\n\n*   **D. 对于方案(i)，$E(t)$ 表现出振幅为 $\\mathcal{O}\\!\\left( dt^2 \\right)$ 的有界振荡，外加一个以速率 $\\mathcal{O}\\!\\left( dt^3 \\right)$ 累积的长期漂移；对于方案(ii)，长期漂移速率为 $\\mathcal{O}\\!\\left( \\epsilon_c \\right)$，与 $dt$ 无关。**\n    此陈述不正确。方案(i)没有长期漂移。方案(ii)的漂移速率标度为 $\\mathcal{O}(\\epsilon_c)$ 在物理上和量纲上都是可疑的，并且与标准分析不一致，标准分析表明它依赖于 $dt$。\n    **结论：不正确。**\n\n*   **E. 对于任何 $\\epsilon_c \\ge 0$，两种方案都产生振幅为 $\\mathcal{O}\\!\\left( dt^2 \\right)$ 的纯粹有界振荡，且长期漂移精确为零。**\n    此陈述不正确。它正确地指出了方案(i)的有界振荡（尽管它忽略了重要的 $\\omega_h$ 依赖性），但它错误地声称 $\\epsilon_c  0$ 的方案(ii)没有长期漂移。不精确约束的积分器的非辛性质必然导致能量漂移。\n    **结论：不正确。**\n\n基于严谨的分析，选项A是唯一一个为两种方案的能量行为提供了完全准确描述的选项。", "answer": "$$\\boxed{A}$$", "id": "3415632"}]}