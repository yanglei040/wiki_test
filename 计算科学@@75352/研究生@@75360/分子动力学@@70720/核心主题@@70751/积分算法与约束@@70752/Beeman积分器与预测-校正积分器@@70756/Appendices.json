{"hands_on_practices": [{"introduction": "评估一个积分器质量的首要标准是其“局部精度”，即在单个时间步内引入的误差大小。通过运用泰勒级数展开这一基本工具，我们将量化 Beeman 积分器在更新位置和速度时产生的截断误差 ([@problem_id:3396862])。这个练习不仅能揭示该方法的精确度阶数，还能让您熟练掌握分析任何数值积分方案核心性能的基本技能。", "problem": "考虑一个质量为 $m$ 的单个经典粒子在一维空间中运动，其受到光滑力 $F(x,t)$ 的作用，满足牛顿第二定律 $m\\,\\ddot{x}(t)=F(x(t),t)$。定义加速度为 $a(t)=\\ddot{x}(t)$，加加速度（jerk）为 $j(t)=\\dot{a}(t)$，加加加速度（snap）为 $s(t)=\\ddot{a}(t)$。假设 $a(t)$ 足够光滑，使得所有达到所需阶数的时间导数都存在且有界。分子动力学中使用的 Beeman 积分法是一种两步预测-校正方案。在其常用的校正形式中，对于一个恒定的时间步长 $h>0$，位置和速度的更新由以下公式给出：\n$$\nx_{\\mathrm{B}}(t+h)=x(t)+v(t)\\,h+\\left(\\frac{2}{3}\\,a(t)-\\frac{1}{6}\\,a(t-h)\\right)h^{2},\n$$\n$$\nv_{\\mathrm{B}}(t+h)=v(t)+\\frac{h}{6}\\left(2\\,a(t+h)+5\\,a(t)-a(t-h)\\right),\n$$\n其中 $v(t)=\\dot{x}(t)$，并且 $a(\\cdot)$ 是根据指定时间的力计算得出的。为了进行局部截断误差分析，将 $a(t\\pm h)$ 理解为在时间 $t\\pm h$ 处沿精确轨迹的精确加速度。\n\n仅使用牛顿第二定律、定义 $v=\\dot{x}$、$a=\\ddot{x}$、$j=\\dot{a}$、$s=\\ddot{a}$ 以及关于时间 $t$ 的泰勒展开，推导位置和速度更新的主阶局部截断误差，其定义分别为：\n$$\n\\Delta x_{\\mathrm{loc}}=x(t+h)-x_{\\mathrm{B}}(t+h),\\qquad \\Delta v_{\\mathrm{loc}}=v(t+h)-v_{\\mathrm{B}}(t+h),\n$$\n结果用加加加速度 $s(t)$ 表示，并保留到 $h$ 的幂级数展开中的第一个非零项。然后，根据以下定义提取相应的无量纲误差常数 $C_{x}$ 和 $C_{v}$：\n$$\n\\Delta x_{\\mathrm{loc}}=C_{x}\\,s(t)\\,h^{4}+O\\!\\left(h^{5}\\right),\\qquad \\Delta v_{\\mathrm{loc}}=C_{v}\\,s(t)\\,h^{3}+O\\!\\left(h^{4}\\right).\n$$\n以有序对 $\\left(C_{x},\\,C_{v}\\right)$ 的形式报告您的最终答案。无需进行数值计算。按照指定，将您的最终答案表示为单个复合表达式。如果引入任何中间截断级数，请保持常数为符号形式，并且除了方案中已有的数值外，不要代入其他数值。最终答案必须以一对精确有理数的形式给出。误差常数不需要单位。", "solution": "我们的目标是确定由 Beeman 积分法给出的位置和速度的局部截断误差。这可以通过比较精确解的泰勒级数展开与数值方案的展开来实现。\n\n首先，我们写出精确位置 $x(t+h)$ 和速度 $v(t+h)$ 在时间 $t$ 附近的泰勒级数展开。根据定义，我们有：\n$\\dot{x}(t) = v(t)$\n$\\ddot{x}(t) = a(t)$\n$\\dddot{x}(t) = \\dot{a}(t) = j(t)$\n$x^{(4)}(t) = \\ddot{a}(t) = s(t)$\n\n精确位置的展开式为：\n$$x(t+h) = x(t) + v(t)h + \\frac{1}{2}a(t)h^2 + \\frac{1}{6}j(t)h^3 + \\frac{1}{24}s(t)h^4 + O(h^5)$$\n\n类似地，对于精确速度：\n$\\dot{v}(t) = a(t)$\n$\\ddot{v}(t) = \\dot{a}(t) = j(t)$\n$\\dddot{v}(t) = \\ddot{a}(t) = s(t)$\n\n精确速度的展开式为：\n$$v(t+h) = v(t) + a(t)h + \\frac{1}{2}j(t)h^2 + \\frac{1}{6}s(t)h^3 + O(h^4)$$\n\n接下来，我们展开 Beeman 积分法更新中的各项。\n\n**位置误差分析**\nBeeman 位置更新公式为：\n$$x_{\\mathrm{B}}(t+h) = x(t)+v(t)\\,h+\\left(\\frac{2}{3}\\,a(t)-\\frac{1}{6}\\,a(t-h)\\right)h^{2}$$\n为了分析这个公式，我们需要 $a(t-h)$ 在 $t$ 附近的泰勒展开：\n$$a(t-h) = a(t) - j(t)h + \\frac{1}{2}s(t)h^2 + O(h^3)$$\n将此代入 $x_{\\mathrm{B}}(t+h)$ 表达式的括号中的项：\n$$\\left(\\frac{2}{3}\\,a(t)-\\frac{1}{6}\\,a(t-h)\\right) = \\frac{2}{3}a(t) - \\frac{1}{6}\\left(a(t) - j(t)h + \\frac{1}{2}s(t)h^2 + O(h^3)\\right)$$\n$$= \\frac{1}{2}a(t) + \\frac{1}{6}j(t)h - \\frac{1}{12}s(t)h^2 + O(h^3)$$\n现在，我们将此乘以 $h^2$ 并代回 $x_{\\mathrm{B}}(t+h)$ 的表达式中：\n$$x_{\\mathrm{B}}(t+h) = x(t) + v(t)h + \\left(\\frac{1}{2}a(t) + \\frac{1}{6}j(t)h - \\frac{1}{12}s(t)h^2 + O(h^3)\\right)h^2$$\n$$x_{\\mathrm{B}}(t+h) = x(t) + v(t)h + \\frac{1}{2}a(t)h^2 + \\frac{1}{6}j(t)h^3 - \\frac{1}{12}s(t)h^4 + O(h^5)$$\n位置的局部截断误差为 $\\Delta x_{\\mathrm{loc}} = x(t+h) - x_{\\mathrm{B}}(t+h)$。\n$$\\Delta x_{\\mathrm{loc}} = \\left(x(t) + v(t)h + \\frac{1}{2}a(t)h^2 + \\frac{1}{6}j(t)h^3 + \\frac{1}{24}s(t)h^4 + O(h^5)\\right) - \\left(x(t) + v(t)h + \\frac{1}{2}a(t)h^2 + \\frac{1}{6}j(t)h^3 - \\frac{1}{12}s(t)h^4 + O(h^5)\\right)$$\n逐项相减后，主导误差项为：\n$$\\Delta x_{\\mathrm{loc}} = \\left(\\frac{1}{24}s(t)h^4\\right) - \\left(-\\frac{1}{12}s(t)h^4\\right) + O(h^5) = \\left(\\frac{1}{24} + \\frac{2}{24}\\right)s(t)h^4 + O(h^5)$$\n$$\\Delta x_{\\mathrm{loc}} = \\frac{1}{8}s(t)h^4 + O(h^5)$$\n因此，误差常数 $C_x$ 为：\n$$C_x = \\frac{1}{8}$$\n\n**速度误差分析**\nBeeman 速度更新公式为：\n$$v_{\\mathrm{B}}(t+h) = v(t)+\\frac{h}{6}\\left(2\\,a(t+h)+5\\,a(t)-a(t-h)\\right)$$\n我们需要 $a(t+h)$ 和 $a(t-h)$ 在 $t$ 附近的泰勒展开：\n$$a(t+h) = a(t) + j(t)h + \\frac{1}{2}s(t)h^2 + O(h^3)$$\n$$a(t-h) = a(t) - j(t)h + \\frac{1}{2}s(t)h^2 + O(h^3)$$\n将这些代入括号中的项：\n$$2a(t+h)+5a(t)-a(t-h) = 2\\left(a(t) + j(t)h + \\frac{1}{2}s(t)h^2\\right) + 5a(t) - \\left(a(t) - j(t)h + \\frac{1}{2}s(t)h^2\\right) + O(h^3)$$\n合并同类项得到：\n$$6a(t) + 3j(t)h + \\frac{1}{2}s(t)h^2 + O(h^3)$$\n将此代回 $v_{\\mathrm{B}}(t+h)$ 的公式中：\n$$v_{\\mathrm{B}}(t+h) = v(t) + \\frac{h}{6}\\left(6a(t) + 3j(t)h + \\frac{1}{2}s(t)h^2 + O(h^3)\\right)$$\n$$v_{\\mathrm{B}}(t+h) = v(t) + a(t)h + \\frac{1}{2}j(t)h^2 + \\frac{1}{12}s(t)h^3 + O(h^4)$$\n速度的局部截断误差为 $\\Delta v_{\\mathrm{loc}} = v(t+h) - v_{\\mathrm{B}}(t+h)$。\n$$\\Delta v_{\\mathrm{loc}} = \\left(v(t) + a(t)h + \\frac{1}{2}j(t)h^2 + \\frac{1}{6}s(t)h^3 + O(h^4)\\right) - \\left(v(t) + a(t)h + \\frac{1}{2}j(t)h^2 + \\frac{1}{12}s(t)h^3 + O(h^4)\\right)$$\n逐项相减后，主导误差项为：\n$$\\Delta v_{\\mathrm{loc}} = \\left(\\frac{1}{6}s(t)h^3\\right) - \\left(\\frac{1}{12}s(t)h^3\\right) + O(h^4) = \\left(\\frac{2}{12} - \\frac{1}{12}\\right)s(t)h^3 + O(h^4)$$\n$$\\Delta v_{\\mathrm{loc}} = \\frac{1}{12}s(t)h^3 + O(h^4)$$\n因此，误差常数 $C_v$ 为：\n$$C_v = \\frac{1}{12}$$\n\n无量纲误差常数的有序对是 $\\left(C_{x},\\,C_{v}\\right) = \\left(\\frac{1}{8},\\,\\frac{1}{12}\\right)$。", "answer": "$$\n\\boxed{\n\\left( \\frac{1}{8}, \\frac{1}{12} \\right)\n}\n$$", "id": "3396862"}, {"introduction": "高局部精度并不能保证在长时间模拟中表现优异，尤其是在分子动力学所研究的哈密顿系统中。此练习探讨一个更深层次的几何性质：积分器是否保持相空间体积，这是刘维尔定理 (Liouville's theorem) 的离散模拟 ([@problem_id:3396840])。通过分析一个简谐振子的 Beeman 映射，我们将揭示该算法在微正则系综（NVE）模拟中的一个关键局限性。", "problem": "考虑一个质量为 $m$、弹簧常数为 $k$ 的一维 ($1$D) 谐振子，其遵循牛顿第二定律 $m \\ddot{x}(t) = -k x(t)$。令 $\\omega \\equiv \\sqrt{k/m}$ 且 $a(t) \\equiv \\ddot{x}(t)$，因此 $a(t) = -\\omega^{2} x(t)$。在具有固定时间步长 $\\Delta t$ 的分子动力学 (MD) 时间离散化中，应用标准的 Beeman 预测-校正方案，该方案根据加速度历史更新位置和速度，如下所示：\n$$\nx_{n+1} = x_{n} + v_{n} \\Delta t + \\frac{2}{3} a_{n} \\Delta t^{2} - \\frac{1}{6} a_{n-1} \\Delta t^{2},\n$$\n$$\nv_{n+1} = v_{n} + \\frac{1}{3} a_{n+1} \\Delta t + \\frac{5}{6} a_{n} \\Delta t - \\frac{1}{6} a_{n-1} \\Delta t,\n$$\n其中 $a_{n} = -\\omega^{2} x_{n}$ 且 $a_{n+1} = -\\omega^{2} x_{n+1}$。为了使单步映射成为马尔可夫过程，引入增广状态向量 $y_{n} \\equiv (x_{n}, v_{n}, x_{n-1})^{\\top}$，使得 $y_{n+1} = \\Phi(y_{n})$ 是一个线性更新。\n\n仅从牛顿第二定律和所述的 Beeman 方案出发，推导此谐振子单步映射的雅可比矩阵 $J \\equiv \\partial y_{n+1} / \\partial y_{n}$，并计算其行列式 $\\det J$ 作为 $\\Delta t$ 和 $\\omega$ 的显式函数。然后，根据您的结果，讨论其对每步相空间体积变化的意义，以及该方案在分子动力学中用于微正则系综（粒子数、体积和能量恒定；NVE）采样的适用性。\n\n请提供 $\\det J$ 的闭合形式表达式作为最终答案。最终答案中无需讨论。行列式是无量纲的，因此不需要单位。无需四舍五入。", "solution": "首先，我们将 Beeman 方案写成关于增广状态向量 $y_{n} \\equiv (x_{n}, v_{n}, x_{n-1})^{\\top}$ 的单步映射 $y_{n+1} = \\Phi(y_{n})$。下一时间步的状态向量为 $y_{n+1} = (x_{n+1}, v_{n+1}, x_{n})^{\\top}$。我们必须将 $y_{n+1}$ 的分量表示为 $y_{n}$ 分量的线性函数。\n\n**$x_{n+1}$ 的推导**\n位置更新由下式给出，代入谐振子的加速度关系 $a_{n} = -\\omega^{2} x_{n}$ 和 $a_{n-1} = -\\omega^{2} x_{n-1}$：\n$$\nx_{n+1} = x_{n} + v_{n} \\Delta t + \\frac{2}{3} (-\\omega^{2} x_{n}) \\Delta t^{2} - \\frac{1}{6} (-\\omega^{2} x_{n-1}) \\Delta t^{2}\n$$\n按 $y_n$ 的分量对各项进行分组：\n$$\nx_{n+1} = \\left(1 - \\frac{2}{3} \\omega^{2} \\Delta t^{2}\\right) x_{n} + (\\Delta t) v_{n} + \\left(\\frac{1}{6} \\omega^{2} \\Delta t^{2}\\right) x_{n-1}\n$$\n\n**$v_{n+1}$ 的推导**\n速度更新依赖于 $a_{n+1} = -\\omega^{2} x_{n+1}$，因此我们必须首先代入 $x_{n+1}$ 的表达式：\n$$\nv_{n+1} = v_{n} + \\frac{1}{3} a_{n+1} \\Delta t + \\frac{5}{6} a_{n} \\Delta t - \\frac{1}{6} a_{n-1} \\Delta t\n$$\n$$\nv_{n+1} = v_{n} - \\frac{1}{3} \\omega^{2} x_{n+1} \\Delta t - \\frac{5}{6} \\omega^{2} x_{n} \\Delta t + \\frac{1}{6} \\omega^{2} x_{n-1} \\Delta t\n$$\n代入上面推导出的 $x_{n+1}$ 表达式：\n$$\nv_{n+1} = v_{n} - \\frac{1}{3} \\omega^{2} \\Delta t \\left[ \\left(1 - \\frac{2}{3} \\omega^{2} \\Delta t^{2}\\right) x_{n} + (\\Delta t) v_{n} + \\left(\\frac{1}{6} \\omega^{2} \\Delta t^{2}\\right) x_{n-1} \\right] - \\frac{5}{6} \\omega^{2} x_{n} \\Delta t + \\frac{1}{6} \\omega^{2} x_{n-1} \\Delta t\n$$\n按 $x_n$、$v_n$ 和 $x_{n-1}$ 对各项进行分组：\n*   $x_n$ 的系数：\n    $$\n    -\\frac{1}{3} \\omega^{2} \\Delta t \\left(1 - \\frac{2}{3} \\omega^{2} \\Delta t^{2}\\right) - \\frac{5}{6} \\omega^{2} \\Delta t = -\\frac{7}{6} \\omega^{2} \\Delta t + \\frac{2}{9} \\omega^{4} \\Delta t^{3}\n    $$\n*   $v_n$ 的系数：\n    $$\n    1 - \\frac{1}{3} \\omega^{2} \\Delta t (\\Delta t) = 1 - \\frac{1}{3} \\omega^{2} \\Delta t^{2}\n    $$\n*   $x_{n-1}$ 的系数：\n    $$\n    -\\frac{1}{3} \\omega^{2} \\Delta t \\left(\\frac{1}{6} \\omega^{2} \\Delta t^{2}\\right) + \\frac{1}{6} \\omega^{2} \\Delta t = \\frac{1}{6} \\omega^{2} \\Delta t - \\frac{1}{18} \\omega^{4} \\Delta t^{3}\n    $$\n$y_{n+1}$ 的第三个分量是平凡的 $x_n$。\n\n**雅可比矩阵及其行列式**\n更新具有线性形式 $y_{n+1} = J y_{n}$。雅可比矩阵 $J = \\partial y_{n+1} / \\partial y_{n}$ 是我们刚刚推导出的系数矩阵：\n$$\nJ = \\begin{pmatrix}\n1 - \\frac{2}{3} \\omega^{2} \\Delta t^{2} & \\Delta t & \\frac{1}{6} \\omega^{2} \\Delta t^{2} \\\\\n-\\frac{7}{6} \\omega^{2} \\Delta t + \\frac{2}{9} \\omega^{4} \\Delta t^{3} & 1 - \\frac{1}{3} \\omega^{2} \\Delta t^{2} & \\frac{1}{6} \\omega^{2} \\Delta t - \\frac{1}{18} \\omega^{4} \\Delta t^{3} \\\\\n1 & 0 & 0\n\\end{pmatrix}\n$$\n我们沿第三行进行余子式展开来计算 $J$ 的行列式：\n$$\n\\det J = (1) \\cdot \\det \\begin{pmatrix} \\Delta t & \\frac{1}{6} \\omega^{2} \\Delta t^{2} \\\\ 1 - \\frac{1}{3} \\omega^{2} \\Delta t^{2} & \\frac{1}{6} \\omega^{2} \\Delta t - \\frac{1}{18} \\omega^{4} \\Delta t^{3} \\end{pmatrix}\n$$\n$$\n\\det J = (\\Delta t) \\left( \\frac{1}{6} \\omega^{2} \\Delta t - \\frac{1}{18} \\omega^{4} \\Delta t^{3} \\right) - \\left( \\frac{1}{6} \\omega^{2} \\Delta t^{2} \\right) \\left( 1 - \\frac{1}{3} \\omega^{2} \\Delta t^{2} \\right)\n$$\n展开两项：\n$$\n\\det J = \\left(\\frac{1}{6} \\omega^{2} \\Delta t^{2} - \\frac{1}{18} \\omega^{4} \\Delta t^{4}\\right) - \\left(\\frac{1}{6} \\omega^{2} \\Delta t^{2} - \\frac{1}{18} \\omega^{4} \\Delta t^{4}\\right)\n$$\n$$\n\\det J = 0\n$$\n\n雅可比行列式 $\\det J$ 描述了状态空间中的一个无穷小体积元在该映射下的变换方式。在本例中，状态空间是坐标为 $(x, v, x_{prev})$ 的增广三维空间。我们的结果 $\\det J = 0$ 意味着 Beeman 算法作为一个单步映射，是一个奇异变换，它将整个三维状态空间坍缩到一个低维流形上。根据刘维尔定理，真实的哈密顿演化会保持相空间体积，而一个被称为辛积分器的数值方法应具有单位雅可比行列式。$\\det J = 0$ 的结果清楚地表明 Beeman 算法不是辛的，因此不尊重哈密顿动力学的几何结构。这会导致总能量的长期漂移，使其不适用于能量守恒是主要要求的长期 NVE 分子动力学模拟。该计算为此不适用性提供了严格的数学证明。", "answer": "$$\n\\boxed{0}\n$$", "id": "3396840"}, {"introduction": "时间可逆性是实现稳健长期积分的另一个关键几何特性，它确保数值轨迹在时间反演下是对称的。我们将首先证明 Beeman 积分器的标准形式不具备此性质 ([@problem_id:3396867])。然后，我们将从分析转向设计，构建一个新的预测-校正方案，该方案不仅能达到三阶精度，并且是明确时间可逆的。", "problem": "考虑一个一维分子动力学（MD）系统，其质量为$m$，遵循牛顿第二定律 $m\\,\\ddot{x}(t)=F(x(t))$，其中 $F(x)$ 足够光滑，使得加速度的三阶时间导数都存在且连续。定义加速度为 $a(t)=\\frac{F(x(t))}{m}$，其时间导数（加加速度，jerk）为 $j(t)=\\frac{d a(t)}{d t}$，其二阶时间导数（加加加速度，snap）为 $s(t)=\\frac{d^{2} a(t)}{d t^{2}}$。令 $x_{n}=x(t_{n})$，$v_{n}=\\dot{x}(t_{n})$，$a_{n}=a(t_{n})$，以及 $\\Delta t=t_{n+1}-t_{n}$。\n\n从牛顿定律和在 $t_{n}$ 附近的泰勒展开出发，推导一个仅使用 $a_{n}$ 和 $a_{n-1}$ 的三阶精度位置更新公式（这是与 Beeman 位置预测格式相关的形式）。然后，通过写出从 $(x_{n+1},v_{n+1},a_{n+1})$ 到 $(x_{n},v_{n},a_{n})$ 的相应后向步骤，并判断正向和反向映射作为 $\\Delta t$ 和相邻步骤加速度的代数表达式是否相同，来检验其在变换 $\\Delta t\\to -\\Delta t$ 下的不变性。结论未校正的 Beeman 位置更新是否是时间可逆的。\n\n接下来，设计一个最小的预测-校正位置更新方案，该方案在保持三阶精度 $x$ 的同时恢复时间可逆性。为此，考虑一个形式如下的校正后位置更新：\n$$\nx_{n+1}^{(\\mathrm{corr})}=x_{n}+v_{n}\\,\\Delta t+C\\,a_{n}\\,\\Delta t^{2}+E\\left(a_{n+1}^{(\\mathrm{pred})}-a_{n-1}\\right)\\Delta t^{2},\n$$\n其中 $a_{n+1}^{(\\mathrm{pred})}$ 是从三阶位置预测器获得的预测加速度（你可以使用你推导出的 Beeman 型预测器来获得 $x_{n+1}^{(\\mathrm{pred})}$，然后计算 $a_{n+1}^{(\\mathrm{pred})}=a(x_{n+1}^{(\\mathrm{pred})})$）。施加以下设计要求：\n\n- 校正后的更新在 $\\Delta t\\to -\\Delta t$ 下是不变的，即当索引反转（$n+1\\leftrightarrow n-1$）且 $\\Delta t$ 变号时，更新的代数形式保持不变。\n- 对于一般的平滑函数 $F(x)$，校正后的更新能够再现 $x(t_{n+1})$ 的精确泰勒展开至 $\\Delta t^{3}$ 阶。\n\n确定满足给定最小形式要求的系数 $C$ 和 $E$ 的唯一值，并将它们报告为精确的有理数。使用 LaTeX 的 pmatrix 环境，将你的最终答案表示为一个行矩阵，其中元素按 $C$ 和 $E$ 的顺序排列。最终答案无需四舍五入，也无需单位。", "solution": "该问题分为三个部分。\n\n**第 1 部分：Beeman 位置预测格式的推导**\n\n我们从位置 $x(t)$ 在时间 $t_{n}$ 附近的泰勒级数展开开始：\n$$x_{n+1} = x_n + v_n \\Delta t + \\frac{1}{2} a_n \\Delta t^2 + \\frac{1}{6} j_n \\Delta t^3 + O(\\Delta t^4)$$\n为了用 $a_n$ 和 $a_{n-1}$ 来近似加加速度 $j_n$，我们使用一阶后向有限差分：\n$$j_n = \\frac{a_n - a_{n-1}}{\\Delta t} + O(\\Delta t)$$\n将这个近似值代入 $x_{n+1}$ 的展开式中：\n$$x_{n+1} \\approx x_n + v_n \\Delta t + \\frac{1}{2} a_n \\Delta t^2 + \\frac{1}{6} \\left(\\frac{a_n - a_{n-1}}{\\Delta t}\\right) \\Delta t^3$$\n$$x_{n+1} = x_n + v_n \\Delta t + \\left(\\frac{1}{2} + \\frac{1}{6}\\right) a_n \\Delta t^2 - \\frac{1}{6} a_{n-1} \\Delta t^2$$\n$$x_{n+1} = x_n + v_n \\Delta t + \\frac{2}{3} a_n \\Delta t^2 - \\frac{1}{6} a_{n-1} \\Delta t^2$$\n这就是 Beeman 位置预测格式。由于 $j_n$ 的近似误差是 $O(\\Delta t)$，该公式的局部截断误差为 $O(\\Delta t^4)$，因此具有三阶精度。\n\n**第 2 部分：Beeman 预测格式的时间可逆性检验**\n\n从步骤 $n$ 到 $n+1$ 的正向映射是：\n$$x_{n+1} = x_n + v_n \\Delta t + \\frac{2}{3} a_n \\Delta t^2 - \\frac{1}{6} a_{n-1} \\Delta t^2$$\n为了得到反向映射，我们从状态 $(x_{n+1}, v_{n+1})$ 开始，使用时间步长 $-\\Delta t$ 应用相同的算法：\n$$x_n = x_{n+1} + v_{n+1} (-\\Delta t) + \\frac{2}{3} a_{n+1} (-\\Delta t)^2 - \\frac{1}{6} a_n (-\\Delta t)^2$$\n$$x_n = x_{n+1} - v_{n+1} \\Delta t + \\frac{2}{3} a_{n+1} \\Delta t^2 - \\frac{1}{6} a_n \\Delta t^2$$\n现在，重排正向映射来解出 $x_n$：\n$$x_n = x_{n+1} - v_n \\Delta t - \\frac{2}{3} a_n \\Delta t^2 + \\frac{1}{6} a_{n-1} \\Delta t^2$$\n比较反向映射的代数形式与重排后的正向映射，我们发现它们并不相同。例如，涉及加速度的项是不同的：\n$$ \\text{反向映射:} \\quad \\left(\\frac{2}{3} a_{n+1} - \\frac{1}{6} a_n\\right)\\Delta t^2 $$\n$$ \\text{重排后的正向映射:} \\quad \\left(-\\frac{2}{3} a_n + \\frac{1}{6} a_{n-1}\\right)\\Delta t^2 $$\n因此，未校正的 Beeman 位置更新不是时间可逆的。\n\n**第 3 部分：设计一个时间可逆、三阶精度的校正格式**\n\n我们寻求校正后位置更新公式的系数 $C$ 和 $E$：\n$$x_{n+1}^{(\\mathrm{corr})}=x_{n}+v_{n}\\,\\Delta t+C\\,a_{n}\\,\\Delta t^{2}+E\\left(a_{n+1}^{(\\mathrm{pred})}-a_{n-1}\\right)\\Delta t^{2}$$\n为了达到三阶精度，我们将该公式与 $x(t_{n+1})$ 的精确泰勒展开进行比较：\n$$x(t_{n+1}) = x_n + v_n \\Delta t + \\frac{1}{2} a_n \\Delta t^2 + \\frac{1}{6} j_n \\Delta t^3 + O(\\Delta t^4)$$\n在我们的精度阶数内，我们可以用精确加速度 $a_{n+1}$ 替换预测加速度 $a_{n+1}^{(\\mathrm{pred})}$。我们使用 $a_{n+1}$ 和 $a_{n-1}$ 在 $t_n$ 附近的泰勒展开：\n$$a_{n+1} = a_n + j_n \\Delta t + \\frac{1}{2} s_n \\Delta t^2 + O(\\Delta t^3)$$\n$$a_{n-1} = a_n - j_n \\Delta t + \\frac{1}{2} s_n \\Delta t^2 - O(\\Delta t^3)$$\n两者相减得到加加速度的中心差分近似：\n$$a_{n+1} - a_{n-1} = 2 j_n \\Delta t + O(\\Delta t^3)$$\n将此代入校正方程：\n$$x_{n+1}^{(\\mathrm{corr})} = x_n + v_n \\Delta t + C a_n \\Delta t^2 + E(2 j_n \\Delta t + O(\\Delta t^3))\\Delta t^2$$\n$$x_{n+1}^{(\\mathrm{corr})} = x_n + v_n \\Delta t + C a_n \\Delta t^2 + 2E j_n \\Delta t^3 + O(\\Delta t^5)$$\n为了达到三阶精度，这个展开式必须与 $x(t_{n+1})$ 的精确泰勒展开式在 $\\Delta t^3$ 项之前都匹配。通过比较 $\\Delta t$ 各次幂的系数：\n- 对于 $\\Delta t^2$ 项：$C a_n \\Delta t^2 = \\frac{1}{2} a_n \\Delta t^2 \\implies C = \\frac{1}{2}$。\n- 对于 $\\Delta t^3$ 项：$2E j_n \\Delta t^3 = \\frac{1}{6} j_n \\Delta t^3 \\implies 2E = \\frac{1}{6} \\implies E = \\frac{1}{12}$。\n\n系数的唯一值是 $C = 1/2$ 和 $E = 1/12$。校正器中形如 $E(a_{n+1} - a_{n-1})$ 的项，在时间上关于中点 $t_n$ 是对称的，这对于恢复时间可逆性至关重要。这些系数产生了一个与 Stoermer-Verlet 方法相关的时间可逆方案。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{1}{2} & \\frac{1}{12}\n\\end{pmatrix}\n}\n$$", "id": "3396867"}]}