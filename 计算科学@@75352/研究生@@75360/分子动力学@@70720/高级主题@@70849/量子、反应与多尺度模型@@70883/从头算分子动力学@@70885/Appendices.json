{"hands_on_practices": [{"introduction": "任何第一性原理分子动力学模拟的准确性都取决于每一步中力的精确计算。在广泛使用的平面波方法中，控制这种准确性的主要参数是动能截断值 $E_{\\text{cut}}$。本练习将指导您完成收敛性测试的基本过程，以确定能够在力的准确性和计算效率之间取得平衡的最佳 $E_{\\text{cut}}$，这是建立可靠模拟的关键第一步。[@problem_id:3431500]", "problem": "您的任务是设计一个程序，在玻恩-奥本海默分子动力学 (BOMD) 的背景下，确定达到指定力收敛目标所需的最小平面波动能截断 $E_{\\mathrm{cut}}$，并估计计算成本随系统尺寸的标度关系。在 BOMD 中，离子力是通过在每个时间步求解电子基态来获得的。平面波基组由一个动能截断 $E_{\\mathrm{cut}}$ 进行截断；力中的离散化误差随着 $E_{\\mathrm{cut}}$ 的增加而减小。您的程序必须使用一个简单的、有物理动机的模型来预测所需的 $E_{\\mathrm{cut}}$，然后使用一个成本模型来估计多个系统尺寸下的总浮点运算次数 (FLOPs)。\n\n假设有以下基础：\n- 玻恩-奥本海默分子动力学 (BOMD)：在每个时间步，自洽地求解电子基态，并从基态电子密度计算力。\n- 对于平面波基组，在每个原子的晶胞体积固定的情况下，平面波的数量标度关系为 $N_{\\mathrm{pw}} \\propto E_{\\mathrm{cut}}^{3/2}$。\n- 对于给定赝势的硅，其力的离散化误差可以建模为一个幂律，$\\epsilon(E_{\\mathrm{cut}}) = A\\,E_{\\mathrm{cut}}^{-\\beta}$，其中 $A$ 和 $\\beta$ 是正的、依赖于材料和赝势的常数，需要通过拟合测量数据来确定。\n\n需要实现的步骤：\n1. 给定测量数据对 $\\{(E_{\\mathrm{cut},i}, \\epsilon_i)\\}$，通过在对数空间中执行最小二乘回归来拟合模型 $\\epsilon(E_{\\mathrm{cut}}) = A\\,E_{\\mathrm{cut}}^{-\\beta}$。具体来说，拟合 $y = \\ln \\epsilon$ 对 $x = \\ln E_{\\mathrm{cut}}$ 的关系以获得 $y = \\ln A - \\beta x$，然后恢复 $A = e^{\\ln A}$ 和 $\\beta = -(\\text{斜率})$。\n2. 对于一个目标力容差 $\\epsilon_{\\mathrm{target}}$，计算预测的最小截断\n$$\nE_{\\mathrm{cut,min}} = \\left(\\frac{A}{\\epsilon_{\\mathrm{target}}}\\right)^{1/\\beta}.\n$$\n3. 为避免在测量范围之外进行外推，将预测的 $E_{\\mathrm{cut,min}}$ 裁剪到闭区间 $[E_{\\min}, E_{\\max}]$ 内，其中 $E_{\\min} = \\min_i E_{\\mathrm{cut},i}$ 且 $E_{\\max} = \\max_i E_{\\mathrm{cut},i}$。定义一个布尔值 $b$，如果裁剪后的 $E_{\\mathrm{cut,min}}$ 处的预测误差满足 $\\epsilon(E_{\\mathrm{cut,min}}) \\le \\epsilon_{\\mathrm{target}}$，则 $b$ 为 $\\mathrm{True}$，否则为 $\\mathrm{False}$。\n4. 使用以下模型估计 $M$ 个时间步内的总计算成本：\n   - 平面波数量：\n   $$\n   N_{\\mathrm{pw}}(E_{\\mathrm{cut}}, N) = K\\,N\\,E_{\\mathrm{cut}}^{3/2},\n   $$\n   其中 $N$ 是原子数，$K$ 由一个基准参考确定。\n   - 硅的占据科恩-沈轨道数（考虑自旋简并和每个原子 4 个价电子）：\n   $$\n   N_{\\mathrm{states}}(N) = 2 N.\n   $$\n   - 每步的浮点运算次数 (FLOPs) 成本，假设是快速傅里叶变换 (FFT) 和线性代数运算的混合：\n   $$\n   C_{\\mathrm{step}}(E_{\\mathrm{cut}}, N) = c_{\\mathrm{fft}}\\,N_{\\mathrm{pw}}\\,\\ln N_{\\mathrm{pw}} + c_{\\mathrm{ops}}\\,N_{\\mathrm{states}}\\,N_{\\mathrm{pw}}.\n   $$\n   - $M$ 步的总成本：\n   $$\n   C_{\\mathrm{total}}(E_{\\mathrm{cut}}, N, M) = M \\times C_{\\mathrm{step}}(E_{\\mathrm{cut}}, N).\n   $$\n   使用以下基准校准常数：\n   - $E_0 = 400\\,\\mathrm{eV}$，$N_0 = 8$，$N_{\\mathrm{pw},0} = 20000$，从而\n   $$\n   K = \\frac{N_{\\mathrm{pw},0}}{N_0\\,E_0^{3/2}}.\n   $$\n   - $c_{\\mathrm{fft}} = 5\\times 10^{2}$，$c_{\\mathrm{ops}} = 1\\times 10^{2}$。\n   以 FLOPs 为单位报告 $C_{\\mathrm{total}}$，四舍五入到最近的整数。\n\n为以下测试套件实现上述过程。在所有情况下，能量必须以 $\\mathrm{eV}$ 表示，力误差以 $\\mathrm{eV/\\AA}$ 表示：\n- 测试用例 1 (模守恒赝势，硅)：\n  - 测量数据：$E_{\\mathrm{cut}} = [200,\\,300,\\,400,\\,600]\\,\\mathrm{eV}$，$\\epsilon = [5.0\\times 10^{-3},\\,2.5\\times 10^{-3},\\,1.6\\times 10^{-3},\\,0.9\\times 10^{-3}]\\,\\mathrm{eV/\\AA}$。\n  - 目标：$\\epsilon_{\\mathrm{target}} = 1.0\\times 10^{-3}\\,\\mathrm{eV/\\AA}$。\n  - 尺寸和步数：$N = [8,\\,64,\\,512]$，$M = 100$。\n- 测试用例 2 (类投影缀加波行为，硅)：\n  - 测量数据：$E_{\\mathrm{cut}} = [150,\\,250,\\,350,\\,450]\\,\\mathrm{eV}$，$\\epsilon = [3.0\\times 10^{-3},\\,1.5\\times 10^{-3},\\,1.0\\times 10^{-3},\\,0.7\\times 10^{-3}]\\,\\mathrm{eV/\\AA}$。\n  - 目标：$\\epsilon_{\\mathrm{target}} = 1.0\\times 10^{-3}\\,\\mathrm{eV/\\AA}$。\n  - 尺寸和步数：$N = [8,\\,216]$，$M = 50$。\n- 测试用例 3 (边界情况，硅)：\n  - 测量数据：$E_{\\mathrm{cut}} = [300,\\,400,\\,500]\\,\\mathrm{eV}$，$\\epsilon = [2.2\\times 10^{-3},\\,1.6\\times 10^{-3},\\,1.3\\times 10^{-3}]\\,\\mathrm{eV/\\AA}$。\n  - 目标：$\\epsilon_{\\mathrm{target}} = 2.0\\times 10^{-3}\\,\\mathrm{eV/\\AA}$。\n  - 尺寸和步数：$N = [8]$，$M = 10$。\n\n您的程序必须为每个测试用例按顺序执行以下输出：\n- 裁剪后的 $E_{\\mathrm{cut,min}}$，单位为 $\\mathrm{eV}$，作为一个浮点数。\n- 布尔值 $b$，表示在裁剪后的 $E_{\\mathrm{cut,min}}$ 处是否满足目标。\n- 每个指定 $N$ 的总成本 $C_{\\mathrm{total}}$，作为整数，按列出的尺寸顺序列出。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果。例如，对于三个测试用例，输出形式应为 $[\\text{E1},\\text{b1},\\text{C1}_1,\\dots,\\text{E2},\\text{b2},\\text{C2}_1,\\dots,\\text{E3},\\text{b3},\\text{C3}_1,\\dots]$，其中 $\\text{E}$ 是以 $\\mathrm{eV}$ 为单位的浮点数，$\\text{b}$ 是布尔值，$\\text{C}$ 是以 FLOPs 为单位的整数。", "solution": "该问题要求设计一个计算流程，为玻恩-奥本海默分子动力学 (BOMD) 模拟确定一个合适的平面波动能截断 ($E_{\\mathrm{cut}}$)，并估计由此产生的计算成本。这项任务是材料模拟中计算资源规划的一个标准组成部分。解决方案分三个阶段进行：首先，为力收敛拟合一个经验模型；其次，使用该模型预测所需的 $E_{\\mathrm{cut}}$ 并进行验证；第三，应用一个标度模型来估计以浮点运算次数 (FLOPs) 为单位的总计算成本。\n\n### 1. 力误差模型与参数拟合\n\n在基于平面波的电子结构计算中，基组通过仅包含动能低于指定截断值 $E_{\\mathrm{cut}}$ 的平面波来进行截断。这会引入一个离散化误差，该误差会随着 $E_{\\mathrm{cut}}$ 的增加而系统地减小。对于离子上的力，这种收敛行为可以有效地用一个幂律来建模：\n$$\n\\epsilon(E_{\\mathrm{cut}}) = A\\,E_{\\mathrm{cut}}^{-\\beta}\n$$\n在这里，$\\epsilon$ 表示力的误差（例如，与收敛值的均方根差），而 $A$ 和 $\\beta$ 是正的常数，它们依赖于元素（本例中为硅）和所用赝势的具体细节。\n\n为了从一组测量数据点 $\\{(E_{\\mathrm{cut},i}, \\epsilon_i)\\}$ 中确定参数 $A$ 和 $\\beta$，我们通过对等式两边取自然对数来线性化模型：\n$$\n\\ln(\\epsilon) = \\ln(A\\,E_{\\mathrm{cut}}^{-\\beta}) = \\ln(A) + \\ln(E_{\\mathrm{cut}}^{-\\beta}) = \\ln(A) - \\beta \\ln(E_{\\mathrm{cut}})\n$$\n该方程具有直线 $y = c + mx$ 的形式，其中 $y = \\ln(\\epsilon)$，$x = \\ln(E_{\\mathrm{cut}})$，截距为 $c = \\ln(A)$，斜率为 $m = -\\beta$。因此，我们可以对对数转换后的数据 $(\\ln E_{\\mathrm{cut},i}, \\ln \\epsilon_i)$ 进行线性最小二乘回归，以找到斜率和截距的最佳拟合值。然后模型参数可以恢复为 $\\beta = -m$ 和 $A = e^c$。\n\n### 2. 能量截断的确定与验证\n\n一旦误差模型被参数化，就可以用它来预测达到期望的力容差 $\\epsilon_{\\mathrm{target}}$ 所需的最小能量截断。通过重新排列模型方程，我们求解 $E_{\\mathrm{cut}}$：\n$$\nE_{\\mathrm{cut,min}} = \\left(\\frac{A}{\\epsilon_{\\mathrm{target}}}\\right)^{1/\\beta}\n$$\n使用经验模型的一个关键方面是避免远超用于拟合的数据域进行外推。因此，预测的截断值 $E_{\\mathrm{cut,pred}}$ 被裁剪到测量截断值的范围 $[E_{\\min}, E_{\\max}]$ 内，其中 $E_{\\min} = \\min_i(E_{\\mathrm{cut},i})$ 且 $E_{\\max} = \\max_i(E_{\\mathrm{cut},i})$。因此，最终的操作截断值为 $E_{\\mathrm{cut,min}} = \\mathrm{clip}(E_{\\mathrm{cut,pred}}, E_{\\min}, E_{\\max})$。\n\n这种裁剪需要一个验证步骤。目标容差 $\\epsilon_{\\mathrm{target}}$ 可能过于严格，即使在测量的最高截断值 $E_{\\max}$ 下也无法达到。在这种情况下，裁剪后的截断值将是 $E_{\\max}$，但此截断值下的误差 $\\epsilon(E_{\\max})$ 仍将大于 $\\epsilon_{\\mathrm{target}}$。因此，我们必须计算裁剪后截断值处的误差 $\\epsilon(E_{\\mathrm{cut,min}})$，并明确检查它是否满足条件 $\\epsilon(E_{\\mathrm{cut,min}}) \\le \\epsilon_{\\mathrm{target}}$。此检查的结果存储在一个布尔变量 $b$ 中。\n\n### 3. 计算成本估算\n\nBOMD 模拟的总计算成本是根据每时间步的成本和总步数来估算的。每步的成本是系统尺寸（原子数，$N$）和基组大小（平面波数，$N_{\\mathrm{pw}}$）的函数。\n\n平面波的数量 $N_{\\mathrm{pw}}$ 与由 $E_{\\mathrm{cut}}$ 定义的倒易空间中球体的体积成正比，对于固定密度的系统，也与原子数 $N$ 成正比。这被建模为：\n$$\nN_{\\mathrm{pw}}(E_{\\mathrm{cut}}, N) = K\\,N\\,E_{\\mathrm{cut}}^{3/2}\n$$\n比例常数 $K$ 通过一个具有已知 $N_0$、$E_0$ 和 $N_{\\mathrm{pw},0}$ 的单一参考计算进行校准，得出 $K = N_{\\mathrm{pw},0} / (N_0\\,E_0^{3/2})$。\n\n对于每个原子有 4 个价电子的硅，假设自旋简并，占据的科恩-沈轨道（或能带）数是价电子数的一半。因此，$N_{\\mathrm{states}}(N) = 4N/2 = 2N$。\n\n每时间步的计算成本 $C_{\\mathrm{step}}$ 被建模为两个主要贡献的总和：\n$$\nC_{\\mathrm{step}}(E_{\\mathrm{cut}}, N) = c_{\\mathrm{fft}}\\,N_{\\mathrm{pw}}\\,\\ln N_{\\mathrm{pw}} + c_{\\mathrm{ops}}\\,N_{\\mathrm{states}}\\,N_{\\mathrm{pw}}\n$$\n第一项，标度关系为 $O(N_{\\mathrm{pw}} \\log N_{\\mathrm{pw}})$，代表了用于在波函数和密度的实空间和倒易空间表示之间切换的快速傅里叶变换 (FFT) 的成本。第二项，标度关系为 $O(N_{\\mathrm{states}} N_{\\mathrm{pw}})$，代表了线性代数运算（例如电子波函数的正交化）的成本。系数 $c_{\\mathrm{fft}}$ 和 $c_{\\mathrm{ops}}$ 是经验确定的常数。\n\n对于一个包含 $N$ 个原子的系统，使用确定的截断值 $E_{\\mathrm{cut,min}}$ 进行 $M$ 步模拟的总成本为：\n$$\nC_{\\mathrm{total}} = M \\times C_{\\mathrm{step}}(E_{\\mathrm{cut,min}}, N)\n$$\n该值报告为最近的整数。将这整个过程应用于所提供的每个测试用例。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n# from scipy import ...\n\ndef solve():\n    \"\"\"\n    Main function to process all test cases and print the final output.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"E_cut_data\": [200., 300., 400., 600.],\n            \"epsilon_data\": [5.0e-3, 2.5e-3, 1.6e-3, 0.9e-3],\n            \"epsilon_target\": 1.0e-3,\n            \"N_values\": [8, 64, 512],\n            \"M\": 100\n        },\n        {\n            \"E_cut_data\": [150., 250., 350., 450.],\n            \"epsilon_data\": [3.0e-3, 1.5e-3, 1.0e-3, 0.7e-3],\n            \"epsilon_target\": 1.0e-3,\n            \"N_values\": [8, 216],\n            \"M\": 50\n        },\n        {\n            \"E_cut_data\": [300., 400., 500.],\n            \"epsilon_data\": [2.2e-3, 1.6e-3, 1.3e-3],\n            \"epsilon_target\": 2.0e-3,\n            \"N_values\": [8],\n            \"M\": 10\n        }\n    ]\n\n    # Baseline calibration constants\n    E0 = 400.0\n    N0 = 8\n    N_pw0 = 20000\n    \n    # Cost model coefficients\n    c_fft = 5e2\n    c_ops = 1e2\n\n    # Calculate the plane-wave scaling constant K\n    K = N_pw0 / (N0 * E0**(1.5))\n\n    results = []\n\n    for case in test_cases:\n        # Step 1: Fit the error model epsilon = A * E_cut^(-beta)\n        # We fit ln(epsilon) = ln(A) - beta * ln(E_cut)\n        log_E = np.log(case[\"E_cut_data\"])\n        log_eps = np.log(case[\"epsilon_data\"])\n        \n        # polyfit(x, y, 1) returns [slope, intercept] for y = slope*x + intercept\n        slope, intercept = np.polyfit(log_E, log_eps, 1)\n        \n        beta = -slope\n        A = np.exp(intercept)\n\n        # Step 2: For a target, compute the predicted minimum cutoff\n        E_cut_pred = (A / case[\"epsilon_target\"])**(1.0 / beta)\n        \n        # Step 3: Clip the predicted E_cut_min and validate\n        E_min_data = min(case[\"E_cut_data\"])\n        E_max_data = max(case[\"E_cut_data\"])\n        E_cut_clipped = np.clip(E_cut_pred, E_min_data, E_max_data)\n        \n        # Calculate the error at the clipped cutoff to validate\n        epsilon_at_clipped = A * E_cut_clipped**(-beta)\n        b = epsilon_at_clipped = case[\"epsilon_target\"]\n        \n        results.append(E_cut_clipped)\n        results.append(b)\n\n        # Step 4: Estimate the total computational cost\n        M = case[\"M\"]\n        for N in case[\"N_values\"]:\n            # Number of plane waves, using the clipped E_cut\n            N_pw = K * N * E_cut_clipped**(1.5)\n            \n            # Number of occupied Kohn-Sham states for silicon\n            N_states = 2 * N\n            \n            # Per-step cost in FLOPs\n            C_step = c_fft * N_pw * np.log(N_pw) + c_ops * N_states * N_pw\n            \n            # Total cost over M steps\n            C_total = M * C_step\n            \n            # Append the cost, rounded to the nearest integer\n            results.append(round(C_total))\n\n    # Final print statement in the exact required format.\n    # Convert booleans to their string representation \"True\" or \"False\"\n    # Convert numbers to their standard string representation\n    str_results = [str(r) for r in results]\n    print(f\"[{','.join(str_results)}]\")\n\nsolve()\n```", "id": "3431500"}, {"introduction": "一旦能够精确计算力，下一个挑战就是如何正确地在时间上演化原子核的运动。积分时间步长 $\\Delta t$ 的选择至关重要；它必须足够小，以精确描述最快的原子运动（通常是高频振动），同时避免数值不稳定性。本问题提供了一个动手实践，帮助您基于速度 Verlet 算法的准确性和稳定性要求，推导出对 $\\Delta t$ 的约束条件，这是分子动力学的基石之一。[@problem_id:3393482]", "problem": "在 Born–Oppenheimer 分子动力学 (BOMD) 中，原子核在瞬时电子基态势能面上演化，并使用诸如速度 Verlet 算法之类的辛二阶格式进行积分。在一个局域最小值附近，每个原子核简正模都可以很好地近似为一个角频率为 $\\omega$ 的独立谐振子。为了保证数值稳定性和准确性，时间步长 $\\Delta t$ 的选择必须参考最高的简正模角频率 $\\omega_{\\max}$。\n\n假设如下：\n- 原子核使用速度 Verlet 算法进行积分。\n- 最高角频率为 $\\omega_{\\max} = 7.5 \\times 10^{14}\\ \\mathrm{s}^{-1}$。\n- 你将最刚性模式的“相对积分误差”定义为由时间离散化引起的角频率的相对误差，即 $|\\tilde{\\omega} - \\omega|/\\omega$，其中 $\\tilde{\\omega}$ 是积分器对谐振子产生的数值角频率。\n- 你要求对于最刚性模式，相对积分误差满足 $|\\tilde{\\omega} - \\omega|/\\omega \\le \\varepsilon$，其中 $\\varepsilon = 2.0 \\times 10^{-3}$。\n\n从谐振子的牛顿第二定律和速度 Verlet 格式的位置-速度形式出发，推导 $\\Delta t$ 的一个界限，该界限能同时确保格式的线性稳定性，并对频率为 $\\omega_{\\max}$ 的模式强制执行上述相对积分误差要求。然后，取更严格的界限，选择一个时间步长。\n\n将最终的时间步长四舍五入到 $3$ 位有效数字。以飞秒 (fs) 为单位表示最终的时间步长。", "solution": "我们从应用于单个谐振简正模的牛顿第二定律开始，\n$$\nm \\ddot{q}(t) = - m \\omega^{2} q(t),\n$$\n它可以写成\n$$\n\\ddot{q}(t) + \\omega^{2} q(t) = 0.\n$$\n速度 Verlet 算法通过以下方式推进位置 $q$ 和速度 $v$：\n$$\nq_{n+1} = q_{n} + \\Delta t\\, v_{n} + \\tfrac{1}{2} \\Delta t^{2} a_{n}, \\quad a_{n} = -\\omega^{2} q_{n},\n$$\n$$\nv_{n+1} = v_{n} + \\tfrac{1}{2} \\Delta t \\left(a_{n} + a_{n+1}\\right).\n$$\n消去速度可得到一个只含位置的递推关系。利用 $a_{n} = -\\omega^{2} q_{n}$ 以及对 $n+1$ 的相同关系，并组合相邻时间步的位置更新方程，可得：\n$$\nq_{n+1} - 2 q_{n} + q_{n-1} = - \\omega^{2} \\Delta t^{2} q_{n}.\n$$\n寻找形如 $q_{n} = A \\exp(i n \\theta)$ 的谐波解，可得到色散关系\n$$\n\\exp(i\\theta) - 2 + \\exp(-i\\theta) + \\omega^{2} \\Delta t^{2} = 0 \\;\\;\\Longrightarrow\\;\\; 2(\\cos \\theta - 1) + \\omega^{2} \\Delta t^{2} = 0,\n$$\n或\n$$\n\\cos \\theta = 1 - \\tfrac{1}{2} \\omega^{2} \\Delta t^{2}.\n$$\n将 $\\theta = \\tilde{\\omega} \\Delta t$ 代入，通过下式定义数值角频率 $\\tilde{\\omega}$\n$$\n\\cos(\\tilde{\\omega} \\Delta t) = 1 - \\tfrac{1}{2} \\omega^{2} \\Delta t^{2}.\n$$\n对于小的 $\\Delta t$，展开 $\\cos(\\tilde{\\omega} \\Delta t)$ 并进行微扰求解。记 $\\tilde{\\omega} \\Delta t = \\theta$ 并展开 $\\cos \\theta = 1 - \\theta^{2}/2 + \\theta^{4}/24 + \\mathcal{O}(\\theta^{6})$。令其等于 $1 - \\tfrac{1}{2} \\omega^{2} \\Delta t^{2}$ 可得\n$$\n1 - \\frac{\\theta^{2}}{2} + \\frac{\\theta^{4}}{24} + \\cdots = 1 - \\frac{\\omega^{2} \\Delta t^{2}}{2}.\n$$\n消去 1 并两边乘以 $-2$，\n$$\n\\theta^{2} - \\frac{\\theta^{4}}{12} + \\cdots = \\omega^{2} \\Delta t^{2}.\n$$\n通过微扰拟设 $\\theta = \\omega \\Delta t \\left(1 + c\\, \\omega^{2} \\Delta t^{2} + \\cdots \\right)$ 求解 $\\theta$ 到非平凡的主导阶，得到\n$$\n\\theta^{2} = \\omega^{2} \\Delta t^{2} \\left(1 + 2 c\\, \\omega^{2} \\Delta t^{2} + \\cdots \\right), \\quad\n\\theta^{4} = \\omega^{4} \\Delta t^{4} \\left(1 + \\cdots \\right).\n$$\n代入前一个关系式，\n$$\n\\omega^{2} \\Delta t^{2} \\left(1 + 2 c\\, \\omega^{2} \\Delta t^{2}\\right) - \\frac{1}{12} \\omega^{4} \\Delta t^{4} = \\omega^{2} \\Delta t^{2} + \\mathcal{O}(\\Delta t^{6}),\n$$\n这意味着\n$$\n2 c\\, \\omega^{4} \\Delta t^{4} - \\frac{1}{12} \\omega^{4} \\Delta t^{4} = 0 \\;\\;\\Longrightarrow\\;\\; c = \\frac{1}{24}.\n$$\n因此\n$$\n\\tilde{\\omega} \\Delta t = \\theta = \\omega \\Delta t \\left(1 + \\frac{(\\omega \\Delta t)^{2}}{24} + \\mathcal{O}(\\Delta t^{4}) \\right),\n$$\n或者，两边除以 $\\Delta t$，\n$$\n\\tilde{\\omega} = \\omega \\left(1 + \\frac{(\\omega \\Delta t)^{2}}{24} + \\mathcal{O}(\\Delta t^{4}) \\right).\n$$\n因此，角频率的相对积分误差在主导阶上为\n$$\n\\frac{|\\tilde{\\omega} - \\omega|}{\\omega} \\approx \\frac{(\\omega \\Delta t)^{2}}{24}.\n$$\n对 $\\omega = \\omega_{\\max}$ 的最刚性模式施加要求，\n$$\n\\frac{(\\omega_{\\max} \\Delta t)^{2}}{24} \\le \\varepsilon \\;\\;\\Longrightarrow\\;\\; \\Delta t \\le \\frac{\\sqrt{24\\, \\varepsilon}}{\\omega_{\\max}}.\n$$\n除了准确性，线性稳定性要求放大因子保持有界。从 $\\cos(\\tilde{\\omega} \\Delta t) = 1 - \\tfrac{1}{2} \\omega^{2} \\Delta t^{2}$ 可知，$\\tilde{\\omega}$ 为实数（因此振荡不增长）的充要条件是 $|1 - \\tfrac{1}{2} \\omega^{2} \\Delta t^{2}| \\le 1$，由此得出\n$$\n0 \\le \\omega^{2} \\Delta t^{2} \\le 4 \\;\\;\\Longrightarrow\\;\\; \\Delta t \\le \\frac{2}{\\omega}.\n$$\n将此应用于最刚性模式，得到稳定性界限 $\\Delta t \\le 2 / \\omega_{\\max}$。\n\n因此，允许的时间步长为\n$$\n\\Delta t \\le \\min\\!\\left(\\frac{\\sqrt{24\\, \\varepsilon}}{\\omega_{\\max}},\\ \\frac{2}{\\omega_{\\max}}\\right).\n$$\n数值上，使用 $\\omega_{\\max} = 7.5 \\times 10^{14}\\ \\mathrm{s}^{-1}$ 和 $\\varepsilon = 2.0 \\times 10^{-3}$，\n$$\n\\sqrt{24\\, \\varepsilon} = \\sqrt{24 \\times 2.0 \\times 10^{-3}} = \\sqrt{4.8 \\times 10^{-2}} \\approx 2.19089 \\times 10^{-1},\n$$\n所以准确性所限制的时间步长为\n$$\n\\Delta t_{\\mathrm{acc}} = \\frac{2.19089 \\times 10^{-1}}{7.5 \\times 10^{14}}\\ \\mathrm{s} \\approx 2.92119 \\times 10^{-16}\\ \\mathrm{s}.\n$$\n稳定性所限制的时间步长为\n$$\n\\Delta t_{\\mathrm{stab}} = \\frac{2}{7.5 \\times 10^{14}}\\ \\mathrm{s} \\approx 2.66667 \\times 10^{-15}\\ \\mathrm{s}.\n$$\n更严格的约束是准确性要求，所以选择的时间步长为 $\\Delta t \\approx 2.92119 \\times 10^{-16}\\ \\mathrm{s}$。\n\n使用 $1\\ \\mathrm{fs} = 10^{-15}\\ \\mathrm{s}$ 将其转换为飞秒，\n$$\n\\Delta t \\approx 0.292119\\ \\mathrm{fs}.\n$$\n四舍五入到 3 位有效数字，\n$$\n\\Delta t \\approx 0.292\\ \\mathrm{fs}.\n$$", "answer": "$$\\boxed{0.292}$$", "id": "3393482"}, {"introduction": "高质量的微正则系综 (NVE) 模拟的一个标志是总能量守恒。然而，在真实的第一性原理模拟中，数值不准确性不可避免地导致能量的逐渐漂移。本练习探讨了这种漂移的两个主要来源：有限的积分时间步长和不完全收敛的电子自洽场 (SCF) 计算。通过构建一个漂移速率的定量模型，您将学会如何基于其基本参数来诊断和预测模拟的长期稳定性。[@problem_id:3431499]", "problem": "你的任务是编写一个完整、可运行的程序，该程序使用影子哈密顿量论证和 SCF 诱导力误差的简单模型，来估算微正则系综 (NVE) Born-Oppenheimer 分子动力学 (BOMD) 模拟中每皮秒的能量漂移，作为时间步长 $\\Delta t$ 和自洽场 (SCF) 收敛容差 $\\epsilon$ 的函数。\n\n从第一性原理和经过充分检验的公式出发，通过组合两个贡献来源，推导每个自由度的能量漂移率（单位为电子伏特每皮秒，$\\mathrm{eV/ps}$）的定量估计：\n\n1. 一个有限时间步长的贡献，其源于时间可逆的辛积分方法（例如，速度-Verlet 方案）的影子哈密顿量。考虑一个单一的有效谐振模式，其质量为 $m$，角频率为 $\\omega$（单位为弧度每皮秒），势能为 $V(x) = \\tfrac{1}{2} k x^2$（其中 $k = m \\omega^2$），动能为 $T(p) = \\tfrac{p^2}{2m}$。利用对于二阶对称分裂方法，影子哈密顿量存在一个展开式的事实：\n$$\n\\tilde{H} = H + \\frac{\\Delta t^2}{12}\\{V,\\{T,V\\}\\} - \\frac{\\Delta t^2}{24}\\{T,\\{T,V\\}\\} + \\mathcal{O}(\\Delta t^4),\n$$\n其中 $\\{A,B\\}$ 表示泊松括号。对谐振子计算此表达式，并在温度 $T$ 下使用能量均分定理，以获得真实哈密顿量 $H$ 相对于守恒的影子哈密顿量 $\\tilde{H}$ 的能量振荡的特征振幅。然后，通过将该振幅乘以一个特征角频率，从这个振荡误差中估算最坏情况下的瞬时表观漂移率。这必须产生一个与 $\\Delta t^2$ 成正比的贡献项，并且依赖于 $T$ 和 $\\omega$，单位需在物理上保持一致。\n\n2. 一个由非变分力误差引起的 SCF 不完全性贡献。将每个自由度的力误差建模为大小为 $\\sigma_F \\approx C_F \\epsilon$（其中 $C_F$ 是一个单位为 $\\mathrm{eV/\\AA}$ 的常数），并假设力误差和速度之间存在一个非零的相关系数 $c_c \\in [0,1]$，从而每个自由度的平均功率输入可估计为 $\\langle \\dot{E} \\rangle \\approx c_c \\,\\sigma_F \\, v_{\\mathrm{rms}}$，其中 $v_{\\mathrm{rms}}$ 是温度 $T$ 下的均方根速度。使用经典关系 $\\tfrac{1}{2} m v_{\\mathrm{rms}}^2 = \\tfrac{1}{2} k_B T$ 来表示 $v_{\\mathrm{rms}}$（用 $T$ 和 $m$ 表示），并确保单位换算的一致性，以使功率以 $\\mathrm{eV/ps}$ 为单位表示。将 $\\epsilon$ 视为无量纲量。\n\n假设系统有 $n_{\\mathrm{dof}}$ 个独立的谐振自由度，它们具有相同的有效角频率 $\\omega$ 和相同的质量 $m$。总能量漂移率应取为所有自由度的总和：\n$$\nR_{\\mathrm{total}}(\\Delta t, \\epsilon) = n_{\\mathrm{dof}}\\left(R_{\\Delta t,\\mathrm{dof}}(\\Delta t) + R_{\\epsilon,\\mathrm{dof}}(\\epsilon)\\right),\n$$\n其中 $R_{\\Delta t,\\mathrm{dof}}$ 是通过影子哈密顿量论证推导出的由时间步长引起的贡献，而 $R_{\\epsilon,\\mathrm{dof}}$ 是由 SCF 引起的贡献。\n\n在你的推导和实现中使用以下常数值和单位：\n- 玻尔兹曼常数，单位为电子伏特每开尔文：$k_B = 8.617333262145 \\times 10^{-5}\\ \\mathrm{eV/K}$。\n- 玻尔兹曼常数，单位为焦耳每开尔文：$k_B^{(J)} = 1.380649 \\times 10^{-23}\\ \\mathrm{J/K}$。\n- 原子质量单位 (amu)，单位为千克：$1\\ \\mathrm{amu} = 1.66053906660 \\times 10^{-27}\\ \\mathrm{kg}$。\n- 温度 $T = 300\\ \\mathrm{K}$。\n- 有效角频率 $\\omega = 2\\pi \\times 5\\ \\mathrm{rad/ps}$（注意：角度以弧度为单位）。\n- 有效质量 $m = 28.0855\\ \\mathrm{amu}$。\n- 自由度 $n_{\\mathrm{dof}} = 24$。\n- 力误差系数 $C_F = 10\\ \\mathrm{eV/\\AA}$。\n- 相关系数 $c_c = 0.1$（无量纲）。\n\n单位一致性要求：\n- 输入的时间步长 $\\Delta t$ 以飞秒为单位提供，必须在程序内部通过 $\\Delta t_{\\mathrm{ps}} = \\Delta t_{\\mathrm{fs}} / 1000$ 转换为皮秒。\n- 对于 SCF 诱导项，速度以 $\\mathrm{\\AA/ps}$ 表示，力以 $\\mathrm{eV/\\AA}$ 表示，从而使功率以 $\\mathrm{eV/ps}$ 为单位。使用 $v_{\\mathrm{rms}} = \\sqrt{k_B^{(J)} T / m_{\\mathrm{kg}}}$ 计算以 $\\mathrm{m/s}$ 为单位的速度，然后使用 $1\\ \\mathrm{m/s} = 10^{-2}\\ \\mathrm{\\AA/ps}$ 将其转换为 $\\mathrm{\\AA/ps}$。\n- 对于时间步长诱导项，通过使用以 $\\mathrm{rad/ps}$ 为单位的 $\\omega$、以 $\\mathrm{ps}$ 为单位的 $\\Delta t$ 和以 $\\mathrm{eV}$ 为单位的 $k_B T$，确保最终贡献的单位为 $\\mathrm{eV/ps}$。\n\n测试套件：\n你的程序必须为以下每个测试用例计算 $R_{\\mathrm{total}}$（单位为 $\\mathrm{eV/ps}$），其中每个用例是一个数对 $(\\Delta t_{\\mathrm{fs}}, \\epsilon)$：\n- 用例 1: $(1.0,\\ 1.0 \\times 10^{-5})$\n- 用例 2: $(0.5,\\ 1.0 \\times 10^{-5})$\n- 用例 3: $(1.0,\\ 0.0)$\n- 用例 4: $(0.0,\\ 2.0 \\times 10^{-5})$\n- 用例 5: $(2.0,\\ 1.0 \\times 10^{-6})$\n\n最终输出格式：\n- 你的程序应生成单行输出，其中包含用方括号括起来的逗号分隔的结果列表，例如，“[result1,result2,...]”。\n- 每个结果必须是 $\\mathrm{eV/ps}$ 单位的浮点数，小数点后精确到六位。", "solution": "该问题要求在微正则系综下的 Born-Oppenheimer 分子动力学模拟中，推导总能量漂移率 $R_{\\mathrm{total}}$ 的定量估计。总漂移率是来自有限积分时间步长 $\\Delta t$ 和由收敛容差 $\\epsilon$ 参数化的自洽场 (SCF) 计算不完全收敛的贡献之和。推导过程将首先分析每个自由度的贡献，然后对所有自由度求和。\n\n总漂移率由以下表达式给出：\n$$\nR_{\\mathrm{total}}(\\Delta t, \\epsilon) = n_{\\mathrm{dof}}\\left(R_{\\Delta t,\\mathrm{dof}}(\\Delta t) + R_{\\epsilon,\\mathrm{dof}}(\\epsilon)\\right)\n$$\n其中 $n_{\\mathrm{dof}}$ 是自由度的数量。我们现在将推导每个自由度的两个贡献的表达式，$R_{\\Delta t,\\mathrm{dof}}$ 和 $R_{\\epsilon,\\mathrm{dof}}$。\n\n**1. 时间步长贡献 ($R_{\\Delta t,\\mathrm{dof}}$)**\n\n此贡献源于像 velocity-Verlet 这样的辛算法的数值积分误差。积分器不守恒真实的哈密顿量 $H$，而是守恒一个邻近的“影子”哈密顿量 $\\tilde{H}$。问题为二阶对称分裂方法提供了 $\\tilde{H}$ 的展开式：\n$$\n\\tilde{H} = H + \\frac{\\Delta t^2}{12}\\{V,\\{T,V\\}\\} - \\frac{\\Delta t^2}{24}\\{T,\\{T,V\\}\\} + \\mathcal{O}(\\Delta t^4)\n$$\n我们将单个自由度建模为一维谐振子，其哈密顿量为 $H(x,p) = T(p) + V(x)$，其中动能为 $T(p) = \\frac{p^2}{2m}$，势能为 $V(x) = \\frac{1}{2} k x^2 = \\frac{1}{2} m \\omega^2 x^2$。泊松括号定义为 $\\{A,B\\} = \\frac{\\partial A}{\\partial x} \\frac{\\partial B}{\\partial p} - \\frac{\\partial A}{\\partial p} \\frac{\\partial B}{\\partial x}$。\n\n首先，我们计算内部的泊松括号 $\\{T,V\\}$：\n$$\n\\{T,V\\} = \\frac{\\partial}{\\partial x}\\left(\\frac{p^2}{2m}\\right) \\frac{\\partial}{\\partial p}\\left(\\frac{1}{2} m \\omega^2 x^2\\right) - \\frac{\\partial}{\\partial p}\\left(\\frac{p^2}{2m}\\right) \\frac{\\partial}{\\partial x}\\left(\\frac{1}{2} m \\omega^2 x^2\\right) = (0)(0) - \\left(\\frac{p}{m}\\right)(m \\omega^2 x) = -p \\omega^2 x\n$$\n接下来，我们计算两个外部的括号：\n$$\n\\{V,\\{T,V\\}\\} = \\left\\{ \\frac{1}{2} m \\omega^2 x^2, -p \\omega^2 x \\right\\} = (m \\omega^2 x)(-\\omega^2 x) - (0)(-p \\omega^2) = -m \\omega^4 x^2\n$$\n$$\n\\{T,\\{T,V\\}\\} = \\left\\{ \\frac{p^2}{2m}, -p \\omega^2 x \\right\\} = (0)(-\\omega^2 x) - \\left(\\frac{p}{m}\\right)(-p \\omega^2) = \\frac{p^2 \\omega^2}{m}\n$$\n那么，到 $\\Delta t^2$ 阶的修正项 $\\Delta H = \\tilde{H} - H$ 为：\n$$\n\\Delta H = \\frac{\\Delta t^2}{12}(-m \\omega^4 x^2) - \\frac{\\Delta t^2}{24}\\left(\\frac{p^2 \\omega^2}{m}\\right) = -\\frac{\\Delta t^2 \\omega^2}{6}\\left(\\frac{1}{2}m\\omega^2 x^2\\right) - \\frac{\\Delta t^2 \\omega^2}{12}\\left(\\frac{p^2}{2m}\\right)\n$$\n用 $V$ 和 $T$ 表示此式：\n$$\n\\Delta H = -\\frac{\\Delta t^2 \\omega^2}{6}V - \\frac{\\Delta t^2 \\omega^2}{12}T\n$$\n真实能量 $H(t) = \\tilde{H} - \\Delta H(t)$ 不是恒定的。其振荡的振幅 $\\delta E_{\\Delta t, \\mathrm{dof}}$ 可以根据 $\\Delta H$ 在振子一个周期内的变化范围来估计。对于能量为 $E = T+V$ 的谐振子，能量在纯动能 ($T=E, V=0$) 和纯势能 ($V=E, T=0$) 之间变化。因此 $\\Delta H$ 的值在 $-\\frac{\\Delta t^2 \\omega^2}{12}E$ 和 $-\\frac{\\Delta t^2 \\omega^2}{6}E$ 之间振荡。总振荡幅度是其差值的绝对值：\n$$\n\\delta E_{\\Delta t, \\mathrm{dof}} = \\left| \\left(-\\frac{\\Delta t^2 \\omega^2}{12}E\\right) - \\left(-\\frac{\\Delta t^2 \\omega^2}{6}E\\right) \\right| = \\frac{\\Delta t^2 \\omega^2}{12}E\n$$\n根据能量均分定理，温度为 $T$ 的一维谐振子的平均能量是 $\\langle E \\rangle = k_B T$。将此代入 $E$：\n$$\n\\delta E_{\\Delta t, \\mathrm{dof}} \\approx \\frac{\\Delta t^2 \\omega^2}{12} k_B T\n$$\n问题指示我们通过将此振幅乘以一个特征角频率来估算最坏情况下的瞬时漂移率，我们为此使用振子自身的频率 $\\omega$。\n$$\nR_{\\Delta t, \\mathrm{dof}}(\\Delta t) = \\delta E_{\\Delta t, \\mathrm{dof}} \\cdot \\omega = \\frac{(k_B T) \\omega^3 \\Delta t^2}{12}\n$$\n正如预期的，该贡献与 $\\Delta t^2$ 成正比。单位必须保持一致：$k_B T$ 的单位是电子伏特 ($\\mathrm{eV}$)，$\\omega$ 的单位是弧度每皮秒 ($\\mathrm{rad/ps}$)，$\\Delta t$ 的单位是皮秒 ($\\mathrm{ps}$)，最终得到的速率单位为 $\\mathrm{eV/ps}$。\n\n**2. SCF 不完全性贡献 ($R_{\\epsilon, \\mathrm{dof}}$)**\n\n此贡献源于当 SCF 循环未完全收敛时力中的系统误差。每个自由度的平均能量变化率（功率）被建模为：\n$$\nR_{\\epsilon, \\mathrm{dof}} = \\langle \\dot{E} \\rangle \\approx c_c \\, \\sigma_F \\, v_{\\mathrm{rms}}\n$$\n其中 $\\sigma_F$ 是力误差的大小，$v_{\\mathrm{rms}}$ 是均方根速度，$c_c$ 是相关系数。力误差被建模为 $\\sigma_F \\approx C_F \\epsilon$，其中 $C_F$ 是一个常数，$\\epsilon$ 是无量纲的 SCF 收敛容差。\n$$\nR_{\\epsilon, \\mathrm{dof}}(\\epsilon) = c_c (C_F \\epsilon) v_{\\mathrm{rms}}\n$$\n均方根速度由动能的能量均分定理 $\\frac{1}{2} m \\langle v^2 \\rangle = \\frac{1}{2} k_B T$ 得到，这给出 $v_{\\mathrm{rms}} = \\sqrt{k_B T / m}$。为了确保单位正确，我们必须使用国际单位制 (SI) 中的基本常数，然后进行转换。具体来说，$k_B$ 必须以 $\\mathrm{J/K}$ 为单位，质量 $m$ 必须以 $\\mathrm{kg}$ 为单位。\n$$\nv_{\\mathrm{rms}} [\\mathrm{m/s}] = \\sqrt{\\frac{k_B^{(J)} T}{m_{\\mathrm{kg}}}}\n$$\n问题要求速度的单位为埃每皮秒 ($\\mathrm{\\AA/ps}$)。转换关系是 $1\\ \\mathrm{m/s} = \\frac{10^{10}\\ \\mathrm{\\AA}}{10^{12}\\ \\mathrm{ps}} = 10^{-2}\\ \\mathrm{\\AA/ps}$。\n$$\nv_{\\mathrm{rms}} [\\mathrm{\\AA/ps}] = \\sqrt{\\frac{k_B^{(J)} T}{m_{\\mathrm{kg}}}} \\times 10^{-2}\n$$\n质量 $m_{\\mathrm{kg}}$ 是通过转换给定的原子质量单位 ($m_{\\mathrm{amu}}$) 的质量得到的。当 $C_F$ 的单位是 $\\mathrm{eV/\\AA}$ 并且 $v_{\\mathrm{rms}}$ 的单位是 $\\mathrm{\\AA/ps}$ 时，得到的速率 $R_{\\epsilon, \\mathrm{dof}}$ 的单位是 $\\mathrm{eV/ps}$。\n\n**3. 总漂移率与最终计算**\n\n结合这些表达式，总漂移率是：\n$$\nR_{\\mathrm{total}}(\\Delta t, \\epsilon) = n_{\\mathrm{dof}} \\left( \\frac{(k_B T)_{\\mathrm{eV}} \\omega^3 (\\Delta t_{\\mathrm{ps}})^2}{12} + c_c C_F \\epsilon \\, v_{\\mathrm{rms}, \\mathrm{\\AA/ps}} \\right)\n$$\n我们使用给定的常数：\n- $k_B = 8.617333262145 \\times 10^{-5}\\ \\mathrm{eV/K}$（用于 $\\Delta t$ 项）\n- $k_B^{(J)} = 1.380649 \\times 10^{-23}\\ \\mathrm{J/K}$（用于 $\\epsilon$ 项）\n- $1\\ \\mathrm{amu} = 1.66053906660 \\times 10^{-27}\\ \\mathrm{kg}$\n- $T = 300\\ \\mathrm{K}$\n- $\\omega = 2\\pi \\times 5\\ \\mathrm{rad/ps}$\n- $m = 28.0855\\ \\mathrm{amu}$\n- $n_{\\mathrm{dof}} = 24$\n- $C_F = 10\\ \\mathrm{eV/\\AA}$\n- $c_c = 0.1$\n\n输入的时间步长 $\\Delta t_{\\mathrm{fs}}$ 以飞秒为单位，必须转换为皮秒：$\\Delta t_{\\mathrm{ps}} = \\Delta t_{\\mathrm{fs}} / 1000$。下面的程序实现了这个推导出的公式，用于计算给定测试用例的漂移率。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the energy drift rate in a BOMD simulation based on a\n    model combining time-step and SCF-incompleteness errors.\n    \"\"\"\n    # Define the constants and parameters from the problem statement.\n    # Boltzmann constant in eV/K\n    KB_EV = 8.617333262145e-5\n    # Boltzmann constant in J/K\n    KB_J = 1.380649e-23\n    # Conversion from atomic mass unit to kilograms\n    AMU_TO_KG = 1.66053906660e-27\n    # System temperature in Kelvin\n    T_K = 300.0\n    # Effective angular frequency in rad/ps\n    OMEGA_RAD_PER_PS = 2.0 * np.pi * 5.0\n    # Effective mass in amu\n    M_AMU = 28.0855\n    # Number of degrees of freedom\n    N_DOF = 24\n    # Force error coefficient in eV/Angstrom\n    C_F_EV_PER_A = 10.0\n    # Correlation coefficient (dimensionless)\n    C_C = 0.1\n\n    # --- Pre-calculate coefficients for the two drift rate contributions ---\n\n    # 1. SCF incompleteness contribution coefficient\n    # Convert mass from amu to kg\n    m_kg = M_AMU * AMU_TO_KG\n    # Calculate rms velocity in m/s using the equipartition theorem in SI units\n    v_rms_m_s = np.sqrt(KB_J * T_K / m_kg)\n    # Convert velocity from m/s to Angstrom/ps\n    # 1 m/s = 1e10 A / 1e12 ps = 1e-2 A/ps\n    v_rms_a_ps = v_rms_m_s * 1e-2\n    # The rate per DOF is R_eps_dof = (c_c * C_F * epsilon) * v_rms\n    # This coefficient is multiplied by epsilon.\n    r_eps_coeff = C_C * C_F_EV_PER_A * v_rms_a_ps\n\n    # 2. Time-step contribution coefficient\n    # Thermal energy in eV\n    kbt_ev = KB_EV * T_K\n    # The rate per DOF is R_dt_dof = (kbt_ev * omega^3 * dt_ps^2) / 12\n    # We are given dt in fs, so dt_ps = dt_fs / 1000.\n    # The coefficient is to be multiplied by dt_fs^2.\n    r_dt_coeff_fs_sq = (kbt_ev * OMEGA_RAD_PER_PS**3) / 12.0 * (1.0 / 1000.0)**2\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (time_step_fs, scf_tolerance_epsilon)\n    test_cases = [\n        (1.0, 1.0e-5),\n        (0.5, 1.0e-5),\n        (1.0, 0.0),\n        (0.0, 2.0e-5),\n        (2.0, 1.0e-6),\n    ]\n\n    results = []\n    # Loop over test cases and calculate the total drift rate\n    for dt_fs, epsilon in test_cases:\n        # Calculate the contribution from the finite time step\n        rate_dt_dof = r_dt_coeff_fs_sq * dt_fs**2\n        \n        # Calculate the contribution from SCF incompleteness\n        rate_eps_dof = r_eps_coeff * epsilon\n        \n        # Calculate the total rate by summing contributions and multiplying by n_dof\n        total_rate = N_DOF * (rate_dt_dof + rate_eps_dof)\n        \n        # Format the result to six decimal places and append to the list\n        results.append(f\"{total_rate:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "3431499"}]}