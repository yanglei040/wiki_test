{"hands_on_practices": [{"introduction": "为了开始我们的动手实践，我们从最简单的情况入手：单个德鲁德振子。这个练习将引导你从势能最小化的基本原理出发，推导其平衡位移和诱导偶极矩。在进入更复杂的相互作用体系之前，掌握这一基础计算 [@problem_id:3418227] 对于理解如何在原子尺度上模拟极化率至关重要。", "problem": "考虑一个在分子动力学（MD）中通过经典德鲁德振子模型模拟的单个可极化位点。该振子由一个固定在原点、携带电荷$+q_{D}$的大质量核心和一个通过力常数为$k$的谐振弹簧连接到核心、携带电荷$-q_{D}$的无质量德鲁德粒子组成。施加一个均匀的静态外部电场 $\\mathbf{E}$。令德鲁德位移 $\\mathbf{r}$ 定义为德鲁德粒子相对于核心的位置矢量（从核心指向德鲁德粒子）。假设温度为零，因此对于给定的 $\\mathbf{E}$，德鲁德坐标会瞬时弛豫到力学平衡状态。该位点的感应偶极矩定义为 $\\boldsymbol{\\mu}_{\\mathrm{ind}}=\\sum_{i} q_{i}\\mathbf{r}_{i}$，其中原点位于核心处。\n\n从基本原理出发，即 (i) 均匀电场 $\\mathbf{E}$ 中点电荷 $q$ 的势能为 $-q\\,\\mathbf{E}\\cdot\\mathbf{r}$，以及 (ii) 谐振弹簧的势能为 $\\tfrac{1}{2}k|\\mathbf{r}|^{2}$，通过最小化相对于 $\\mathbf{r}$ 的适当势能，推导该位点的平衡位移矢量 $\\mathbf{r}_{\\mathrm{eq}}$ 和感应偶极矩矢量 $\\boldsymbol{\\mu}_{\\mathrm{ind}}$。\n\n然后，对于参数 $q_{D}=1\\,e$，$k=0.5\\,\\mathrm{a.u.}$ 和 $\\mathbf{E}=(0,0,0.01)\\,\\mathrm{a.u.}$，计算平衡位移的 $z$ 分量 $r_{\\mathrm{eq},z}$ 和感应偶极矩的 $z$ 分量 $\\mu_{\\mathrm{ind},z}$（以原子单位计）。将您的最终答案表示为一个二元行矩阵 $\\big(r_{\\mathrm{eq},z},\\,\\mu_{\\mathrm{ind},z}\\big)$，并提供精确值（不要四舍五入）。在最终报告的值中不要包含单位。", "solution": "该问题被验证为具有科学依据、提法恰当、客观且完整。它提出了一个经典力学和电磁学中的标准练习，应用于原子极化率的简化模型——德鲁德振子，该模型常用于分子动力学模拟中。该问题没有任何谬误或含糊之处，可以从所提供的原理和数据中推导出一个唯一的解。\n\n该系统由一个位于原点、电荷为 $+q_{D}$ 的固定核心和一个相对于核心位于位置 $\\mathbf{r}$、电荷为 $-q_{D}$ 的可移动德鲁德粒子组成。两者通过一个力常数为 $k$ 的谐振弹簧连接。该系统处在一个均匀的外部电场 $\\mathbf{E}$ 中。\n\n系统的总势能 $U(\\mathbf{r})$ 是谐振弹簧中储存的势能 $U_{\\text{spring}}$ 和电荷在外部电场中的势能 $U_{\\text{electric}}$ 的总和。\n\n根据问题陈述，谐振弹簧的势能由下式给出：\n$$U_{\\text{spring}} = \\frac{1}{2}k|\\mathbf{r}|^2$$\n其中 $\\mathbf{r}$ 是德鲁德粒子相对于核心的位移矢量。\n\n电荷系统在外部电场中的势能是各个电荷势能的总和。问题陈述指出，在均匀电场 $\\mathbf{E}$ 中，位于位置 $\\mathbf{r}'$ 的点电荷 $q$ 的势能为 $-q\\mathbf{E}\\cdot\\mathbf{r}'$。\n核心的电荷为 $q_{\\text{core}} = +q_{D}$，位于位置 $\\mathbf{r}_{\\text{core}} = \\mathbf{0}$。其势能为：\n$$U_{\\text{core}} = -(+q_{D})\\mathbf{E}\\cdot\\mathbf{r}_{\\text{core}} = -q_{D}\\mathbf{E}\\cdot\\mathbf{0} = 0$$\n德鲁德粒子的电荷为 $q_{\\text{Drude}} = -q_{D}$，位于位置 $\\mathbf{r}_{\\text{Drude}} = \\mathbf{r}$。其势能为：\n$$U_{\\text{Drude}} = -(-q_{D})\\mathbf{E}\\cdot\\mathbf{r}_{\\text{Drude}} = q_{D}\\mathbf{E}\\cdot\\mathbf{r}$$\n因此，总的电势能为 $U_{\\text{electric}} = U_{\\text{core}} + U_{\\text{Drude}} = q_{D}\\mathbf{E}\\cdot\\mathbf{r}$。\n\n德鲁德振子作为位移 $\\mathbf{r}$ 的函数的总势能为：\n$$U(\\mathbf{r}) = U_{\\text{spring}} + U_{\\text{electric}} = \\frac{1}{2}k|\\mathbf{r}|^2 + q_{D}\\mathbf{E}\\cdot\\mathbf{r}$$\n\n在零温度下，系统会弛豫到力学平衡状态，这对应于势能的最小值。为了找到这个最小值，我们必须找到使势能相对于 $\\mathbf{r}$ 的梯度为零的位移 $\\mathbf{r}_{\\mathrm{eq}}$。\n$U(\\mathbf{r})$ 的梯度为：\n$$\\nabla U(\\mathbf{r}) = \\nabla \\left(\\frac{1}{2}k|\\mathbf{r}|^2 + q_{D}\\mathbf{E}\\cdot\\mathbf{r}\\right)$$\n我们可以分别计算每一项的梯度。令 $\\mathbf{r} = (x, y, z)$，则 $|\\mathbf{r}|^2 = x^2+y^2+z^2$。梯度为 $\\nabla|\\mathbf{r}|^2 = (2x, 2y, 2z) = 2\\mathbf{r}$。\n对于第二项，$\\mathbf{E} = (E_x, E_y, E_z)$，所以 $\\mathbf{E}\\cdot\\mathbf{r} = E_x x + E_y y + E_z z$。其梯度为 $\\nabla(\\mathbf{E}\\cdot\\mathbf{r}) = (E_x, E_y, E_z) = \\mathbf{E}$。\n因此，总势能的梯度为：\n$$\\nabla U(\\mathbf{r}) = \\frac{1}{2}k(2\\mathbf{r}) + q_{D}\\mathbf{E} = k\\mathbf{r} + q_{D}\\mathbf{E}$$\n将梯度设为零以求得平衡位移 $\\mathbf{r}_{\\mathrm{eq}}$：\n$$k\\mathbf{r}_{\\mathrm{eq}} + q_{D}\\mathbf{E} = \\mathbf{0}$$\n求解 $\\mathbf{r}_{\\mathrm{eq}}$ 得到平衡位移矢量：\n$$\\mathbf{r}_{\\mathrm{eq}} = -\\frac{q_{D}}{k}\\mathbf{E}$$\n\n接下来，我们推导感应偶极矩 $\\boldsymbol{\\mu}_{\\mathrm{ind}}$。问题将偶极矩定义为以核心为原点：$\\boldsymbol{\\mu}_{\\mathrm{ind}}=\\sum_{i} q_{i}\\mathbf{r}_{i}$。求和是对振子的两个粒子进行的。\n对于核心：$q_1 = +q_{D}$, $\\mathbf{r}_1 = \\mathbf{0}$。\n对于德鲁德粒子：$q_2 = -q_{D}$, $\\mathbf{r}_2 = \\mathbf{r}_{\\mathrm{eq}}$。\n感应偶极矩为：\n$$\\boldsymbol{\\mu}_{\\mathrm{ind}} = (+q_{D})(\\mathbf{0}) + (-q_{D})(\\mathbf{r}_{\\mathrm{eq}}) = -q_{D}\\mathbf{r}_{\\mathrm{eq}}$$\n代入推导出的 $\\mathbf{r}_{\\mathrm{eq}}$ 表达式：\n$$\\boldsymbol{\\mu}_{\\mathrm{ind}} = -q_{D}\\left(-\\frac{q_{D}}{k}\\mathbf{E}\\right) = \\frac{q_{D}^2}{k}\\mathbf{E}$$\n这表明感应偶极矩与外部电场成正比。比例常数 $\\alpha = q_D^2/k$ 是德鲁德振子的极化率。\n\n现在，我们使用给定的原子单位（a.u.）参数，计算平衡位移的 $z$ 分量 $r_{\\mathrm{eq},z}$ 和感应偶极矩的 $z$ 分量 $\\mu_{\\mathrm{ind},z}$ 的数值。\n参数为：\n$q_{D} = 1\\,e$。在原子单位制中，基本电荷 $e$ 为 $1\\,\\mathrm{a.u.}$，所以 $q_{D} = 1$。\n$k = 0.5\\,\\mathrm{a.u.}$\n$\\mathbf{E} = (0, 0, 0.01)\\,\\mathrm{a.u.}$，这意味着 $E_x=0$，$E_y=0$，且 $E_z = 0.01$。\n\n平衡位移的 $z$ 分量是：\n$$r_{\\mathrm{eq},z} = -\\frac{q_{D}}{k}E_z$$\n代入数值：\n$$r_{\\mathrm{eq},z} = -\\frac{1}{0.5}(0.01) = -2 \\times 0.01 = -0.02$$\n\n感应偶极矩的 $z$ 分量是：\n$$\\mu_{\\mathrm{ind},z} = \\frac{q_{D}^2}{k}E_z$$\n代入数值：\n$$\\mu_{\\mathrm{ind},z} = \\frac{1^2}{0.5}(0.01) = 2 \\times 0.01 = 0.02$$\n\n或者，我们可以从 $r_{\\mathrm{eq},z}$ 计算 $\\mu_{\\mathrm{ind},z}$：\n$$\\mu_{\\mathrm{ind},z} = -q_{D} r_{\\mathrm{eq},z} = -(1)(-0.02) = 0.02$$\n两种方法得到相同的结果，验证了计算的正确性。\n\n最终答案是以行矩阵形式表示的一对值 $(r_{\\mathrm{eq},z}, \\mu_{\\mathrm{ind},z})$。", "answer": "$$\n\\boxed{\\begin{pmatrix} -0.02  0.02 \\end{pmatrix}}\n$$", "id": "3418227"}, {"introduction": "真实的分子体系涉及多个可极化位点之间的相互作用。本实践从单个振子过渡到耦合二聚体，引入了必须自洽求解的相互极化这一核心挑战。通过应用雅可比（Jacobi）和高斯-赛德尔（Gauss-Seidel）迭代法 [@problem_id:3418196]，你将获得解决这些相互作用所遵循的自洽场（SCF）方程的数值技术的实践经验。", "problem": "考虑一个由经典杜鲁德（Drude）振子建模的一维、共线、双位点可极化二聚体，使用可极化分子动力学中的标准无量纲单位。每个位点 $i \\in \\{1,2\\}$ 带有一个感应偶极子 $\\,\\mu_i\\,$，该偶极子被约束在分子间轴上，并具有各向同性极化率 $\\,\\alpha_i\\,$。位点 $i$ 处的局域场是外加场 $\\,E_i^{0}\\,$ 与来自另一个位点的偶极场的总和。对于这种共线几何构型，偶极-偶极相互作用由一个 $\\,2 \\times 2\\,$ 的耦合矩阵 $\\,\\mathbf{T}\\,$ 表示，该矩阵的对角元为零且非对角元相同。从经典杜鲁德振子的能量和极化率的定义出发，感应偶极子满足一个自洽线性系统，该系统可以对 $\\,\\boldsymbol{\\mu} = (\\mu_1,\\mu_2)^{\\mathsf{T}}\\,$ 写成向量形式。\n\n在本问题中，您将需要：\n- 从第一性原理（经典杜鲁德振子的能量最小化和定义 $\\,\\mu_i = \\alpha_i E_i^{\\mathrm{loc}}\\,$）推导关于 $\\,\\boldsymbol{\\mu}\\,$ 的自洽线性系统，确定其不动点形式，并由此为 $\\,\\boldsymbol{\\mu}\\,$ 构建单步雅可比（Jacobi）和高斯-赛德尔（Gauss–Seidel）不动点迭代格式。\n- 然后，给定具体数据\n$$\n\\boldsymbol{\\alpha} \\equiv \\mathrm{diag}(\\alpha_1,\\alpha_2)\n=\n\\begin{pmatrix}\n0.7  0 \\\\\n0  0.4\n\\end{pmatrix}, \n\\quad\n\\mathbf{T} = \n\\begin{pmatrix}\n0  0.2 \\\\\n0.2  0\n\\end{pmatrix}, \n\\quad\n\\mathbf{E}^{0} = \n\\begin{pmatrix}\n0.8 \\\\\n-0.6\n\\end{pmatrix},\n$$\n从 $\\,\\boldsymbol{\\mu}^{(0)} = \\mathbf{0}\\,$ 开始，执行一次雅可比迭代和一次高斯-赛德尔迭代，分别得到 $\\,\\boldsymbol{\\mu}^{(1)}_{\\mathrm{J}}\\,$ 和 $\\,\\boldsymbol{\\mu}^{(1)}_{\\mathrm{GS}}\\,$。\n\n最后，计算无量纲标量\n$$\nR \\equiv \\frac{\\|\\boldsymbol{\\mu}^{(1)}_{\\mathrm{J}} - \\boldsymbol{\\mu}^{(1)}_{\\mathrm{GS}}\\|_{2}}{\\|\\boldsymbol{\\mu}^{(1)}_{\\mathrm{GS}}\\|_{2}}.\n$$\n将您计算的 $\\,R\\,$ 的最终结果四舍五入到四位有效数字。最终值以纯数形式表示（无单位）。", "solution": "本题要求我们处理一个双位点可极化二聚体的经典杜鲁德（Drude）振子模型。首先，我们将推导感应偶极子的自洽线性系统。然后，我们将为该系统构建雅可比（Jacobi）和高斯-赛德尔（Gauss-Seidel）迭代法。最后，我们将使用所提供的数据对每种方法执行一次迭代，并计算所要求的标量比值 $R$。\n\n位点 $i$ 处的局域电场，记为 $E_i^{\\mathrm{loc}}$，是外加场 $E_i^{0}$ 与另一个位点 $j$ 的偶极子所产生场的总和。对于一维共线系统，来自偶极子 $\\mu_j$ 在位点 $i$ 处产生的场由 $T_{ij}\\mu_j$ 给出。对于我们的双位点系统（$i \\in \\{1,2\\}$），局域场为：\n$$\nE_1^{\\mathrm{loc}} = E_1^{0} + T_{12} \\mu_2\n$$\n$$\nE_2^{\\mathrm{loc}} = E_2^{0} + T_{21} \\mu_1\n$$\n感应偶极子 $\\mu_i$、各向同性极化率 $\\alpha_i$ 和局域场 $E_i^{\\mathrm{loc}}$ 之间的基本关系为 $\\mu_i = \\alpha_i E_i^{\\mathrm{loc}}$。代入局域场的表达式，我们得到关于偶极子的自洽方程组：\n$$\n\\mu_1 = \\alpha_1 (E_1^{0} + T_{12} \\mu_2)\n$$\n$$\n\\mu_2 = \\alpha_2 (E_2^{0} + T_{21} \\mu_1)\n$$\n该系统可以用矩阵形式表示。令 $\\boldsymbol{\\mu} = \\begin{pmatrix} \\mu_1 \\\\ \\mu_2 \\end{pmatrix}$，$\\mathbf{E}^{0} = \\begin{pmatrix} E_1^{0} \\\\ E_2^{0} \\end{pmatrix}$，$\\boldsymbol{\\alpha} = \\mathrm{diag}(\\alpha_1, \\alpha_2) = \\begin{pmatrix} \\alpha_1  0 \\\\ 0  \\alpha_2 \\end{pmatrix}$，以及 $\\mathbf{T} = \\begin{pmatrix} 0  T_{12} \\\\ T_{21}  0 \\end{pmatrix}$。局域场向量为 $\\mathbf{E}^{\\mathrm{loc}} = \\mathbf{E}^{0} + \\mathbf{T}\\boldsymbol{\\mu}$，偶极子向量为 $\\boldsymbol{\\mu} = \\boldsymbol{\\alpha} \\mathbf{E}^{\\mathrm{loc}}$。代入 $\\mathbf{E}^{\\mathrm{loc}}$ 可得：\n$$\n\\boldsymbol{\\mu} = \\boldsymbol{\\alpha} (\\mathbf{E}^{0} + \\mathbf{T}\\boldsymbol{\\mu})\n$$\n该方程具有不动点形式 $\\boldsymbol{\\mu} = F(\\boldsymbol{\\mu})$，其中 $F(\\boldsymbol{\\mu}) = \\boldsymbol{\\alpha}\\mathbf{E}^{0} + \\boldsymbol{\\alpha}\\mathbf{T}\\boldsymbol{\\mu}$。将其整理为线性系统的标准形式 $A\\mathbf{x}=\\mathbf{b}$，我们得到：\n$$\n\\boldsymbol{\\mu} - \\boldsymbol{\\alpha}\\mathbf{T}\\boldsymbol{\\mu} = \\boldsymbol{\\alpha}\\mathbf{E}^{0} \\implies (\\mathbf{I} - \\boldsymbol{\\alpha}\\mathbf{T}) \\boldsymbol{\\mu} = \\boldsymbol{\\alpha}\\mathbf{E}^{0}\n$$\n其中 $\\mathbf{I}$ 是 $2 \\times 2$ 单位矩阵。这就是关于 $\\boldsymbol{\\mu}$ 的自洽线性系统。\n\n不动点形式直接给出了雅可比迭代的更新规则。对于一个通用线性系统 $A\\boldsymbol{\\mu}=\\mathbf{b}$，我们将 $A$ 分解为其对角部分 $D$、严格下三角部分 $L$ 和严格上三角部分 $U$，$A = D+L+U$。雅可比迭代格式为 $\\boldsymbol{\\mu}^{(k+1)} = D^{-1}(\\mathbf{b} - (L+U)\\boldsymbol{\\mu}^{(k)})$。在我们的例子中，$A = \\mathbf{I} - \\boldsymbol{\\alpha}\\mathbf{T}$，所以 $D=\\mathbf{I}$。迭代格式简化为 $\\boldsymbol{\\mu}^{(k+1)} = \\mathbf{b} - (L+U)\\boldsymbol{\\mu}^{(k)} = \\boldsymbol{\\alpha}\\mathbf{E}^{0} + \\boldsymbol{\\alpha}\\mathbf{T}\\boldsymbol{\\mu}^{(k)}$。\n分量形式的雅可比迭代规则是：\n$$\n\\mu_{1,\\mathrm{J}}^{(k+1)} = \\alpha_1 (E_1^{0} + T_{12} \\mu_2^{(k)})\n$$\n$$\n\\mu_{2,\\mathrm{J}}^{(k+1)} = \\alpha_2 (E_2^{0} + T_{21} \\mu_1^{(k)})\n$$\n高斯-赛德尔方法按顺序更新分量，使用最新的值。其更新规则是：\n$$\n\\mu_{1,\\mathrm{GS}}^{(k+1)} = \\alpha_1 (E_1^{0} + T_{12} \\mu_2^{(k)})\n$$\n$$\n\\mu_{2,\\mathrm{GS}}^{(k+1)} = \\alpha_2 (E_2^{0} + T_{21} \\mu_{1,\\mathrm{GS}}^{(k+1)})\n$$\n\n现在，我们使用给定的数据应用这些方法：\n$$\n\\boldsymbol{\\alpha} = \\begin{pmatrix} 0.7  0 \\\\ 0  0.4 \\end{pmatrix}, \\quad \\mathbf{T} = \\begin{pmatrix} 0  0.2 \\\\ 0.2  0 \\end{pmatrix}, \\quad \\mathbf{E}^{0} = \\begin{pmatrix} 0.8 \\\\ -0.6 \\end{pmatrix}\n$$\n初始猜测值为 $\\boldsymbol{\\mu}^{(0)} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}$。\n\n首先，我们执行一次雅可比迭代（$k=0$）：\n$$\n\\mu_{1,\\mathrm{J}}^{(1)} = 0.7 (0.8 + 0.2 \\times 0) = 0.7 \\times 0.8 = 0.56\n$$\n$$\n\\mu_{2,\\mathrm{J}}^{(1)} = 0.4 (-0.6 + 0.2 \\times 0) = 0.4 \\times (-0.6) = -0.24\n$$\n这得到向量 $\\boldsymbol{\\mu}^{(1)}_{\\mathrm{J}} = \\begin{pmatrix} 0.56 \\\\ -0.24 \\end{pmatrix}$。\n\n接下来，我们执行一次高斯-赛德尔迭代（$k=0$）：\n$$\n\\mu_{1,\\mathrm{GS}}^{(1)} = 0.7 (0.8 + 0.2 \\times 0) = 0.7 \\times 0.8 = 0.56\n$$\n$$\n\\mu_{2,\\mathrm{GS}}^{(1)} = 0.4 (-0.6 + 0.2 \\times \\mu_{1,\\mathrm{GS}}^{(1)}) = 0.4 (-0.6 + 0.2 \\times 0.56) = 0.4 (-0.6 + 0.112) = 0.4(-0.488) = -0.1952\n$$\n这得到向量 $\\boldsymbol{\\mu}^{(1)}_{\\mathrm{GS}} = \\begin{pmatrix} 0.56 \\\\ -0.1952 \\end{pmatrix}$。\n\n最后，我们计算标量 $R \\equiv \\frac{\\|\\boldsymbol{\\mu}^{(1)}_{\\mathrm{J}} - \\boldsymbol{\\mu}^{(1)}_{\\mathrm{GS}}\\|_{2}}{\\|\\boldsymbol{\\mu}^{(1)}_{\\mathrm{GS}}\\|_{2}}$。\n首先，计算差分向量：\n$$\n\\boldsymbol{\\mu}^{(1)}_{\\mathrm{J}} - \\boldsymbol{\\mu}^{(1)}_{\\mathrm{GS}} = \\begin{pmatrix} 0.56 \\\\ -0.24 \\end{pmatrix} - \\begin{pmatrix} 0.56 \\\\ -0.1952 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ -0.0448 \\end{pmatrix}\n$$\n该差分向量的L2范数为：\n$$\n\\|\\boldsymbol{\\mu}^{(1)}_{\\mathrm{J}} - \\boldsymbol{\\mu}^{(1)}_{\\mathrm{GS}}\\|_{2} = \\sqrt{0^2 + (-0.0448)^2} = 0.0448\n$$\n高斯-赛德尔结果的L2范数为：\n$$\n\\|\\boldsymbol{\\mu}^{(1)}_{\\mathrm{GS}}\\|_{2} = \\sqrt{(0.56)^2 + (-0.1952)^2} = \\sqrt{0.3136 + 0.03810304} = \\sqrt{0.35170304}\n$$\n现在，我们计算比值 $R$：\n$$\nR = \\frac{0.0448}{\\sqrt{0.35170304}} \\approx \\frac{0.0448}{0.593045562} \\approx 0.075542205\n$$\n将结果四舍五入到四位有效数字，我们得到 $R \\approx 0.07554$。", "answer": "$$\n\\boxed{0.07554}\n$$", "id": "3418196"}, {"introduction": "在耦合振子概念的基础上，这项高级实践将挑战你为一个通用的 N 位点体系设计并实现一个完整的算法实验。你将构建包含用于正则化短程效应的 Thole 阻尼的完整相互作用矩阵，并比较雅可比、高斯-赛德尔以及强大的预条件共轭梯度（PCG）等多种迭代求解器的效率 [@problem_id:3418178]。这个综合性编程问题模拟了开发和优化可极化分子动力学软件中的真实任务。", "problem": "您的任务是设计并实现一个基于分子动力学的算法实验，用于在使用Thole阻尼时，比较求解感应偶极子方程的迭代求解器。物理和数学模型必须从可极化位点的线性响应和杜鲁德振子 (Drude oscillator) 的第一性原理出发。您的程序必须构建感应偶极子的线性系统，从Thole阻尼相互作用中构建一个具有科学意义的块对角预条件子，并测量不同求解器的迭代次数如何随系统矩阵的条件数变化。\n\n从以下基本原理开始：\n\n- 位点上的感应偶极子对总电场呈线性响应。对于位点索引为 $i$ 的位点，设感应偶极子为向量 $\\mathbf{p}_i \\in \\mathbb{R}^3$，局部外场为 $\\mathbf{E}^{\\mathrm{ext}}_i \\in \\mathbb{R}^3$。包含相互偶极子作用的线性响应为：\n$$\n\\mathbf{p}_i = \\alpha_i \\left( \\mathbf{E}^{\\mathrm{ext}}_i + \\sum_{j \\neq i} \\mathbf{T}_{ij} \\, \\mathbf{p}_j \\right),\n$$\n其中 $\\alpha_i > 0$ 是位点极化率，$\\mathbf{T}_{ij} \\in \\mathbb{R}^{3 \\times 3}$ 是位点 $i$ 和 $j$ 之间的偶极-偶极相互作用张量。\n\n- 对于一个位移坐标为 $\\mathbf{x}$、Drude电荷为 $q_{\\mathrm{D}}$、弹簧常数为 $k_{\\mathrm{D}}$ 的杜鲁德振子，根据牛顿第二定律，存在一个恢复力 $-k_{\\mathrm{D}} \\mathbf{x}$ 和一个电力 $q_{\\mathrm{D}} \\mathbf{E}$。在静态平衡时，$k_{\\mathrm{D}} \\mathbf{x} = q_{\\mathrm{D}} \\mathbf{E}$，因此感应偶极子 $\\mathbf{p} = q_{\\mathrm{D}} \\mathbf{x}$ 满足 $\\mathbf{p} = \\alpha \\mathbf{E}$，其中：\n$$\n\\alpha = \\frac{q_{\\mathrm{D}}^2}{k_{\\mathrm{D}}}.\n$$\n\n- 对于两个由分离向量 $\\mathbf{r}_{ij} = \\mathbf{R}_j - \\mathbf{R}_i$（其大小为 $r_{ij} = \\lVert \\mathbf{r}_{ij} \\rVert$，单位向量为 $\\hat{\\mathbf{n}}_{ij} = \\mathbf{r}_{ij}/r_{ij}$）分隔的位点，未阻尼的偶极相互作用张量为：\n$$\n\\mathbf{T}^{(0)}_{ij} = \\frac{1}{r_{ij}^3}\\left( 3 \\, \\hat{\\mathbf{n}}_{ij} \\hat{\\mathbf{n}}_{ij}^{\\mathsf{T}} - \\mathbf{I}_3 \\right),\n$$\n其中 $\\mathbf{I}_3$ 是 $3 \\times 3$ 的单位矩阵。\n\n- Thole阻尼通过一个依赖于无量纲阻尼变量 $u_{ij}$ 和无量纲Thole参数 $a > 0$ 的形状函数来缩放张量，从而对短程相互作用进行正则化。使用广泛采纳的用于偶极-偶极耦合的指数Thole因子：\n$$\nf_3(u) = 1 - \\exp(-a u)\\left(1 + a u + \\frac{(a u)^2}{2}\\right), \\quad\nu_{ij} = \\frac{r_{ij}}{\\left(\\alpha_i \\alpha_j \\right)^{1/6}}.\n$$\n阻尼后的张量则为：\n$$\n\\mathbf{T}_{ij} = f_3(u_{ij}) \\, \\mathbf{T}^{(0)}_{ij}.\n$$\n\n根据这些原理，推导并实现以下针对 $N$ 个位点的级联偶极子向量 $\\mathbf{p} \\in \\mathbb{R}^{3N}$ 的线性系统：\n$$\n\\mathbf{A} \\mathbf{p} = \\mathbf{b}, \\quad \\text{其中} \\quad \\mathbf{A} = \\boldsymbol{\\alpha}^{-1} - \\mathbf{T}, \\quad \\mathbf{b} = \\mathbf{E}^{\\mathrm{ext}}.\n$$\n在这里，$\\boldsymbol{\\alpha}^{-1}$ 是一个块对角矩阵，其对角块为 $3 \\times 3$ 的 $\\alpha_i^{-1} \\mathbf{I}_3$ 矩阵；$\\mathbf{T}$ 是一个 $3N \\times 3N$ 的块矩阵，其非对角块为 $3 \\times 3$ 的 $\\mathbf{T}_{ij}$ 矩阵，对角块为零。右端项 $\\mathbf{b}$ 包含每个位点的外场。在物理上合理的阻尼和间距下，$\\mathbf{A}$ 是对称正定的，这使得条件数和迭代方法的收敛性都有良好定义。\n\n定义并比较以下用于求解 $\\mathbf{A} \\mathbf{p} = \\mathbf{b}$ 的求解器：\n\n- 使用 $3 \\times 3$ 对角块 $\\mathbf{A}_{ii}$ 的块-Jacobi迭代：\n$$\n\\mathbf{p}^{(k+1)}_i = \\mathbf{p}^{(k)}_i + \\mathbf{A}_{ii}^{-1}\\left(\\mathbf{b}_i - \\sum_{j=1}^{N} \\mathbf{A}_{ij} \\mathbf{p}^{(k)}_j \\right).\n$$\n\n- 使用 $3 \\times 3$ 对角块 $\\mathbf{A}_{ii}$ 的块-Gauss–Seidel迭代：\n$$\n\\mathbf{p}^{(k+1)}_i = \\mathbf{p}^{(k)}_i + \\mathbf{A}_{ii}^{-1}\\left(\\mathbf{b}_i - \\sum_{j  i} \\mathbf{A}_{ij} \\mathbf{p}^{(k+1)}_j - \\sum_{j \\ge i} \\mathbf{A}_{ij} \\mathbf{p}^{(k)}_j \\right).\n$$\n\n- 预条件共轭梯度法（PCG），使用一个块对角预条件子 $\\mathbf{M}$，该预条件子由限制在空间块内的Thole阻尼相互作用组装而成。将 $N$ 个位点划分为大小为 $s$ 的连续块（最后一个块可能更小），并令 $\\mathbf{M}$ 为块对角矩阵，其块等于 $\\mathbf{A}$ 的相应主子矩阵。在PCG中，通过求解 $\\mathbf{M} \\mathbf{z} = \\mathbf{r}$ 来施加 $\\mathbf{M}$ 的作用，其中 $\\mathbf{r}$ 为残差。\n\n所有求解器的停止准则为相对残差容差\n$$\n\\frac{\\lVert \\mathbf{b} - \\mathbf{A} \\mathbf{p}^{(k)} \\rVert_2}{\\lVert \\mathbf{b} \\rVert_2} \\le 10^{-10},\n$$\n或最大迭代次数 $10,000$ 次，以先达到者为准。测量达到容差所需的迭代次数。计算对称条件数\n$$\n\\kappa(\\mathbf{A}) = \\frac{\\lambda_{\\max}(\\mathbf{A})}{\\lambda_{\\min}(\\mathbf{A})},\n$$\n其中 $\\lambda_{\\min}$ 和 $\\lambda_{\\max}$ 是 $\\mathbf{A}$ 的最小和最大特征值。\n\n全程使用无量纲量；不需要物理单位。不涉及角度。数值必须作为纯实数处理。\n\n为以下参数集的测试套件实现该实验。每个测试指定了位点数 $N$、位置 $\\mathbf{R}_i$、极化率 $\\alpha_i$、Thole参数 $a$、预条件子的块大小 $s$ 以及所有 $i$ 的均匀外场 $\\mathbf{E}^{\\mathrm{ext}}_i = \\mathbf{E}_0$：\n\n- 测试1（正常路径）：$N=2$，位置 $\\mathbf{R}_0 = (0,0,0)$, $\\mathbf{R}_1 = (3.0,0,0)$，$\\alpha_0 = \\alpha_1 = 0.5$, $a = 0.39$, $s = 1$, $\\mathbf{E}_0 = (0.1, 0.0, 0.0)$。\n\n- 测试2（中等耦合，全块预条件子）：$N=3$，位置 $\\mathbf{R}_0 = (0,0,0)$, $\\mathbf{R}_1 = (3.0,0,0)$, $\\mathbf{R}_2 = (1.5, \\frac{3.0\\sqrt{3}}{2}, 0)$（边长为 $3.0$ 的等边三角形），所有 $i$ 的 $\\alpha_i = 1.0$， $a = 0.39$, $s = 3$, $\\mathbf{E}_0 = (0.1, 0.0, 0.0)$。\n\n- 测试3（更强耦合，接近病态条件）：$N=5$，位置 $\\mathbf{R}_i = (2.5 i, 0, 0)$ 对 $i = 0,1,2,3,4$（间距为 $2.5$ 的线性链），所有 $i$ 的 $\\alpha_i = 1.2$， $a = 0.30$, $s = 2$, $\\mathbf{E}_0 = (0.1, 0.0, 0.0)$。\n\n- 测试4（边界情况，单位点）：$N=1$，位置 $\\mathbf{R}_0 = (0,0,0)$，$\\alpha_0 = 0.8$, $a = 0.39$, $s = 1$, $\\mathbf{E}_0 = (0.1, 0.0, 0.0)$。\n\n您的程序必须：\n1. 为每个测试构建矩阵 $\\mathbf{A}$ 和右端项 $\\mathbf{b}$。\n2. 使用 $\\mathbf{A}$ 的最大与最小特征值之比计算 $\\kappa(\\mathbf{A})$。\n3. 使用指定的容差和最大迭代次数运行块-Jacobi、块-Gauss–Seidel和预条件共轭梯度法。记录每个求解器的迭代次数，如果求解器在最大迭代次数内未能达到容差，则记为-1。\n4. 生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果。每个测试用例的结果必须是一个四元列表，格式为 $[\\kappa,\\mathrm{itJ},\\mathrm{itGS},\\mathrm{itPCG}]$，其中 $\\kappa$ 是一个浮点数，迭代次数是整数。最终的单行必须包含这些列表的列表，不带空格，例如：\n\"[[kappa1,itJ1,itGS1,itPCG1],[kappa2,itJ2,itGS2,itPCG2],...]\"。", "solution": "该问题要求设计并实现一个数值实验，以比较三种迭代求解器——块-Jacobi、块-Gauss–Seidel和预条件共轭梯度法——在求解可极化分子力学模型中感应偶极子所遵循的线性系统时的收敛行为。该模型的基础是线性响应理论，结合Thole阻尼来对短程静电相互作用进行正则化。\n\n首先，我们通过从所提供的物理原理构建线性系统来将问题形式化。每个位点 $i$ 上的感应偶极子 $\\mathbf{p}_i \\in \\mathbb{R}^3$与该位点上的总电场成线性比例，该总电场是外场 $\\mathbf{E}^{\\mathrm{ext}}_i$ 和所有其他感应偶极子 $\\mathbf{p}_j$ 产生的场的叠加。此关系由下式给出：\n$$\n\\mathbf{p}_i = \\alpha_i \\left( \\mathbf{E}^{\\mathrm{ext}}_i + \\sum_{j \\neq i} \\mathbf{T}_{ij} \\, \\mathbf{p}_j \\right)\n$$\n其中 $\\alpha_i$ 是位点 $i$ 的各向同性极化率，$\\mathbf{T}_{ij}$ 是 $3 \\times 3$ 的偶极-偶极相互作用张量。重新整理这个方程，将涉及未知偶极子 $\\mathbf{p}_j$ 的项归到一边，得到：\n$$\n\\alpha_i^{-1} \\mathbf{p}_i - \\sum_{j \\neq i} \\mathbf{T}_{ij} \\mathbf{p}_j = \\mathbf{E}^{\\mathrm{ext}}_i\n$$\n通过将所有 $N$ 个位点的向量 $\\mathbf{p}_i$ 和 $\\mathbf{E}^{\\mathrm{ext}}_i$ 组装成大的列向量 $\\mathbf{p}, \\mathbf{b} \\in \\mathbb{R}^{3N}$，我们可以将整套方程表示为单个矩阵方程：\n$$\n\\mathbf{A} \\mathbf{p} = \\mathbf{b}\n$$\n系统矩阵 $\\mathbf{A} \\in \\mathbb{R}^{3N \\times 3N}$ 和右端向量 $\\mathbf{b}$ 的构造如下。$\\mathbf{A}$ 是一个由 $3 \\times 3$ 子块 $\\mathbf{A}_{ij}$ 构成的块矩阵。对角块为 $\\mathbf{A}_{ii} = \\alpha_i^{-1} \\mathbf{I}_3$，其中 $\\mathbf{I}_3$ 是 $3 \\times 3$ 的单位矩阵。对于 $i \\neq j$，非对角块为 $\\mathbf{A}_{ij} = -\\mathbf{T}_{ij}$。右端向量 $\\mathbf{b}$ 是外场向量的串联，即 $\\mathbf{b}_i = \\mathbf{E}^{\\mathrm{ext}}_i$。我们可以将 $\\mathbf{A}$ 简明地写成 $\\mathbf{A} = \\boldsymbol{\\alpha}^{-1} - \\mathbf{T}$，其中 $\\boldsymbol{\\alpha}^{-1}$ 是一个对角块为 $\\alpha_i^{-1}\\mathbf{I}_3$ 的块对角矩阵，而 $\\mathbf{T}$ 是一个对角块为零、非对角块为 $\\mathbf{T}_{ij}$ 的块矩阵。由于相互作用张量满足 $\\mathbf{T}_{ij} = \\mathbf{T}_{ji}$，矩阵 $\\mathbf{A}$ 是对称的。\n\n相互作用张量 $\\mathbf{T}_{ij}$ 是标准偶极相互作用张量的Thole阻尼版本。对于由向量 $\\mathbf{r}_{ij}$（大小为 $r_{ij}$，方向为 $\\hat{\\mathbf{n}}_{ij}$）分隔的两个位点，未阻尼的张量为：\n$$\n\\mathbf{T}^{(0)}_{ij} = \\frac{1}{r_{ij}^3}\\left( 3 \\, \\hat{\\mathbf{n}}_{ij} \\hat{\\mathbf{n}}_{ij}^{\\mathsf{T}} - \\mathbf{I}_3 \\right)\n$$\nThole阻尼在短距离处对这种相互作用进行正则化，以防止非物理性的发散。阻尼后的张量为 $\\mathbf{T}_{ij} = f_3(u_{ij}) \\, \\mathbf{T}^{(0)}_{ij}$，其中 $f_3$ 是一个阻尼函数。指定的函数是指数形式：\n$$\nf_3(u) = 1 - \\exp(-a u)\\left(1 + a u + \\frac{(a u)^2}{2}\\right)\n$$\n该函数依赖于一个无量纲的Thole参数 $a$ 和一个无量纲的距离 $u_{ij} = r_{ij} / (\\alpha_i \\alpha_j)^{1/6}$，该距离通过相互作用位点极化率的组合来缩放分离距离。\n\n在建立线性系统 $\\mathbf{A}\\mathbf{p} = \\mathbf{b}$ 后，我们实现并评估三种迭代求解器。每种求解器的停止准则是相对残差范数小于或等于 $10^{-10}$，或最大迭代次数达到 $10,000$ 次。\n\n1.  **块-Jacobi (BJ) 迭代**：此方法基于前一次迭代 $k$ 的偶极子值，同时更新所有偶极子块。对块 $i$ 的更新为：\n    $$\n    \\mathbf{p}^{(k+1)}_i = \\mathbf{p}^{(k)}_i + \\mathbf{A}_{ii}^{-1}\\left(\\mathbf{b}_i - \\sum_{j=1}^{N} \\mathbf{A}_{ij} \\mathbf{p}^{(k)}_j \\right)\n    $$\n    括号中的项是残差向量 $\\mathbf{r}^{(k)} = \\mathbf{b} - \\mathbf{A}\\mathbf{p}^{(k)}$ 的第 $i$ 个块。由于 $\\mathbf{A}_{ii} = \\alpha_i^{-1}\\mathbf{I}_3$，其逆矩阵就是 $\\alpha_i\\mathbf{I}_3$。该更新在计算上是直接的。\n\n2.  **块-Gauss–Seidel (BGS) 迭代**：此方法与Jacobi方法的不同之处在于，它在同一次迭代中使用最新更新的偶极子值。更新是按块 $i=1, \\dots, N$ 顺序进行的：\n    $$\n    \\mathbf{p}^{(k+1)}_i = \\mathbf{p}^{(k)}_i + \\mathbf{A}_{ii}^{-1}\\left(\\mathbf{b}_i - \\sum_{j  i} \\mathbf{A}_{ij} \\mathbf{p}^{(k+1)}_j - \\sum_{j \\ge i} \\mathbf{A}_{ij} \\mathbf{p}^{(k)}_j \\right)\n    $$\n    这种顺序依赖性通常导致比块-Jacobi更快的收敛速度，但它本质上是顺序的，不易并行化。实现时通过对偶极子向量 $\\mathbf{p}$ 进行就地更新来达到此效果。\n\n3.  **预条件共轭梯度法 (PCG)**：共轭梯度法是一种最优的Krylov子空间方法，用于求解像 $\\mathbf{A}$ 这样的对称正定（SPD）矩阵的线性系统。其收敛速率高度依赖于矩阵的条件数。预处理用于将系统转换为具有更有利条件数的系统。PCG算法对一个选定的预条件子 $\\mathbf{M} \\approx \\mathbf{A}$ 求解 $\\mathbf{M}^{-1}\\mathbf{A}\\mathbf{p} = \\mathbf{M}^{-1}\\mathbf{b}$。在这里，$\\mathbf{M}$ 是一个块对角矩阵，通过将 $N$ 个位点划分为指定大小 $s$ 的连续块来构建。$\\mathbf{M}$ 的每个对角块是与该划分块中位点对应的 $\\mathbf{A}$ 的主子矩阵。应用预条件子 $\\mathbf{z} = \\mathbf{M}^{-1}\\mathbf{r}$，涉及到在每个块上求解更小的、独立的线性系统，这通过直接求逆来完成。\n\n求解器的有效性是相对于系统矩阵的条件数 $\\kappa(\\mathbf{A})$ 进行分析的。对于一个SPD矩阵 $\\mathbf{A}$，这是其最大特征值与最小特征值之比：\n$$\n\\kappa(\\mathbf{A}) = \\frac{\\lambda_{\\max}(\\mathbf{A})}{\\lambda_{\\min}(\\mathbf{A})}\n$$\n更大的条件数通常意味着一个更病态的系统，这通常需要迭代求解器进行更多次迭代才能收敛。$\\mathbf{A}$ 的特征谱通过数值计算来求得此值。\n\n实现过程首先是定义一个函数，为给定的测试用例参数集构建 $\\mathbf{A}$ 和 $\\mathbf{b}$。然后，为三种求解器中的每一种实现单独的函数，所有函数都遵循指定的停止准则。一个主函数遍历所有测试用例，构建每个系统，计算 $\\kappa(\\mathbf{A})$，运行求解器以确定其迭代次数，并将结果格式化为所需的输出字符串。", "answer": "[[1.074531804706376,7,4,2],[2.038596603058869,11,6,1],[6.463321016892537,129,65,6],[1.0,1,1,1]]", "id": "3418178"}]}