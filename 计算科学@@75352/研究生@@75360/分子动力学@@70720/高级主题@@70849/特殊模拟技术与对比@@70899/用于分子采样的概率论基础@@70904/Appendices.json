{"hands_on_practices": [{"introduction": "分子动力学模拟本质上会产生时间上相关的构象序列，这使得对模拟结果进行精确的统计误差分析变得尤为重要。积分自相关时间是衡量数据点之间统计独立性的关键指标，它决定了我们从给定长度的轨迹中获得的有效样本数量。这个练习将指导你为一个经典的随机过程模型推导积分自相关时间估计量的统计不确定性，这是进行可靠误差分析的一项基本技能。[@problem_id:3437744]", "problem": "考虑一个标量分子可观测量 $x(t)$，其在一维恒温条件下，在过阻尼朗之万动力学下演化，该过程由 Ornstein–Uhlenbeck 过程建模：\n$$\n\\mathrm{d}x(t) \\;=\\; -\\,\\gamma\\,x(t)\\,\\mathrm{d}t \\;+\\; \\sqrt{2 D}\\,\\mathrm{d}W_t,\n$$\n其中 $\\gamma>0$ 是摩擦弛豫率，$D>0$ 是扩散系数，$W_t$ 是标准维纳过程。假设系统处于平衡状态，因此 $x(t)$ 是一个平稳的、均值为零的高斯过程，其平衡方差为 $\\sigma^{2} = D/\\gamma$。以均匀时间间隔 $\\Delta t>0$ 对 $x(t)$ 进行采样，得到离散序列 $x_n := x(n\\,\\Delta t)$，其中 $n=1,\\dots,N$。离散时间自相关函数为 $\\rho(k) = \\exp(-\\gamma\\,\\Delta t\\, k)$，我们将其记为 $\\rho(k) = \\alpha^{k}$，其中 $\\alpha := \\exp(-\\gamma\\,\\Delta t)\\in(0,1)$。\n\n定义样本自协方差和自相关估计量：\n$$\n\\hat{\\gamma}(k) \\;=\\; \\frac{1}{N}\\sum_{t=1}^{N-k} x_t\\,x_{t+k}, \\qquad \\hat{\\rho}(k) \\;=\\; \\frac{\\hat{\\gamma}(k)}{\\hat{\\gamma}(0)},\n$$\n对于固定的延迟 $k\\geq 1$，并假定均值为零。在 $N$ 较大且 $k$ 固定的渐近区域内进行分析。\n\n(a) 从 $x_n$ 的平稳性和高斯变量的四阶矩分解（Isserlis/Wick 定理）出发，推导样本自协方差向量 $\\{\\hat{\\gamma}(j)\\}_{j=0}^{k}$ 在大 $N$ 下的渐近联合正态性，并通过 delta 方法获得 $\\hat{\\rho}(k)$ 的渐近分布。您的推导必须从上述定义和基本的高斯矩性质开始，并必须证明所有极限过渡的合理性。\n\n(b) 将协方差结构特化为 Ornstein–Uhlenbeck 离散化形式，其中 $\\rho(h)=\\alpha^{|h|}$。推导 $\\operatorname{Var}[\\hat{\\rho}(k)]$ 的一个闭式首项（$1/N$ 阶）表达式，该表达式能正确调整经典的 Bartlett 型公式，以考虑通过 $\\hat{\\gamma}(0)$ 进行的归一化。\n\n(c) 使用一步延迟矩方法估计量 $\\hat{\\alpha} := \\hat{\\rho}(1)$ 来定义离散积分自相关时间的估计量：\n$$\n\\hat{\\tau}_{\\mathrm{int}} \\;=\\; \\frac{1+\\hat{\\alpha}}{1-\\hat{\\alpha}},\n$$\n当 $\\rho(j)=\\alpha^{j}$ 时，该估计量与精确的离散积分自相关时间 $\\tau_{\\mathrm{int}} = 1 + 2\\sum_{j=1}^{\\infty}\\rho(j)$ 一致。使用 delta 方法和您对 $\\operatorname{Var}[\\hat{\\rho}(1)]$ 的结果，推导首项渐近方差 $\\operatorname{Var}[\\hat{\\tau}_{\\mathrm{int}}]$，使其仅为 $N$ 和 $\\alpha$ 的函数。\n\n以 $N$ 和 $\\alpha$ 表示的 $\\operatorname{Var}[\\hat{\\tau}_{\\mathrm{int}}]$ 的单个闭式解析表达式的形式提供最终答案。无需进行数值计算。以离散（无量纲）单位表示 $\\hat{\\tau}_{\\mathrm{int}}$；不要转换为物理时间单位。", "solution": "该问题陈述清晰，并且在随机过程和时间序列分析理论（特别是在分子动力学中的应用）方面具有坚实的科学基础。所有给出的定义和陈述都是标准且一致的。我将开始进行求解。\n\n该问题要求计算积分自相关时间估计量 $\\hat{\\tau}_{\\mathrm{int}}$ 的渐近方差。推导将按照问题各部分所概述的三个阶段进行：(a) 建立样本自相关的一般渐近理论，(b) 将方差表达式特化到 Ornstein-Uhlenbeck 的情况，以及 (c) 使用 delta 方法求出 $\\hat{\\tau}_{\\mathrm{int}}$ 的方差。\n\n设平稳的、均值为零的高斯过程为 $x_t$，其自协方差函数为 $\\gamma(k) = \\mathrm{E}[x_t x_{t+k}] = \\sigma^2 \\rho(k)$。给定模型是一个 AR(1) 过程，其中 $\\rho(k) = \\alpha^{|k|}$ 且 $\\alpha = \\exp(-\\gamma \\Delta t) \\in (0,1)$，因此 $\\gamma(k) = \\sigma^2 \\alpha^{|k|}$。样本自协方差为 $\\hat{\\gamma}(k) = \\frac{1}{N}\\sum_{t=1}^{N-k} x_t x_{t+k}$。\n\n(a) 自协方差和自相关的渐近分布\n\n我们首先求样本自协方差的渐近协方差。考虑向量 $\\hat{\\mathbf{g}} = (\\hat{\\gamma}(i), \\hat{\\gamma}(j))^T$。我们关心 $\\operatorname{Cov}(\\hat{\\gamma}(i),\\hat{\\gamma}(j))$ 在大 $N$ 下的行为。\n$$\n\\operatorname{Cov}(\\hat{\\gamma}(i),\\hat{\\gamma}(j)) = \\mathrm{E}[\\hat{\\gamma}(i)\\hat{\\gamma}(j)] - \\mathrm{E}[\\hat{\\gamma}(i)]\\mathrm{E}[\\hat{\\gamma}(j)]\n$$\n对于大的 $N$，期望 $\\mathrm{E}[\\hat{\\gamma}(k)] = \\frac{N-k}{N}\\gamma(k) \\approx \\gamma(k)$。\n协方差项为：\n$$\n\\operatorname{Cov}(\\hat{\\gamma}(i),\\hat{\\gamma}(j)) = \\frac{1}{N^2} \\sum_{s=1}^{N-i} \\sum_{t=1}^{N-j} \\operatorname{Cov}(x_s x_{s+i}, x_t x_{t+j})\n$$\n由于 $\\{x_t\\}$ 是一个均值为零的高斯过程，我们使用 Isserlis/Wick 定理计算四阶矩：\n$\\mathrm{E}[x_a x_b x_c x_d] = \\mathrm{E}[x_a x_b]\\mathrm{E}[x_c x_d] + \\mathrm{E}[x_a x_c]\\mathrm{E}[x_b x_d] + \\mathrm{E}[x_a x_d]\\mathrm{E}[x_b x_c]$。\n因此，\n$$\n\\operatorname{Cov}(x_s x_{s+i}, x_t x_{t+j}) = \\mathrm{E}[x_s x_{s+i} x_t x_{t+j}] - \\mathrm{E}[x_s x_{s+i}]\\mathrm{E}[x_t x_{t+j}] = \\mathrm{E}[x_s x_t]\\mathrm{E}[x_{s+i} x_{t+j}] + \\mathrm{E}[x_s x_{t+j}]\\mathrm{E}[x_{s+i} x_t]\n$$\n根据平稳性，$\\mathrm{E}[x_a x_b] = \\gamma(b-a)$，所以\n$$\n\\operatorname{Cov}(x_s x_{s+i}, x_t x_{t+j}) = \\gamma(t-s)\\gamma(t+j-s-i) + \\gamma(t+j-s)\\gamma(t-i-s)\n$$\n将此代入双重求和中并取大 $N$ 极限（援引平稳过程的中心极限定理，这一点是合理的，因为 OU 过程是混合的），可以计算该和。令 $h = t-s$。对于大的 $N$，对于一个固定的延迟 $h$，对 $(s,t)$ 的数量约为 $N-|h|$。\n$$\nN \\operatorname{Cov}(\\hat{\\gamma}(i), \\hat{\\gamma}(j)) \\approx \\frac{1}{N} \\sum_{h=-(N-1)}^{N-1} (N-|h|) \\left[ \\gamma(h)\\gamma(h+j-i) + \\gamma(h+j)\\gamma(h-i) \\right]\n$$\n在极限 $N\\to\\infty$ 下，这收敛于：\n$$\n\\Sigma_{ij} = \\lim_{N\\to\\infty} N \\operatorname{Cov}(\\hat{\\gamma}(i), \\hat{\\gamma}(j)) = \\sum_{h=-\\infty}^{\\infty} \\left[ \\gamma(h)\\gamma(h+j-i) + \\gamma(h+j)\\gamma(h-i) \\right]\n$$\n这个结果被称为 Bartlett 公式，它确立了向量 $\\sqrt{N}(\\hat{\\mathbf{g}} - \\boldsymbol{\\gamma})$ 渐近服从均值为零、协方差矩阵为 $\\mathbf{\\Sigma}$ 的正态分布。\n\n为了找到 $\\hat{\\rho}(k) = \\hat{\\gamma}(k)/\\hat{\\gamma}(0)$ 的渐近分布，我们应用 delta 方法。令 $\\mathbf{y} = (\\hat{\\gamma}(0), \\hat{\\gamma}(k))^T$ 并定义函数 $f(u, v) = v/u$。真实值为 $\\rho(k) = \\gamma(k)/\\gamma(0)$。\n向量 $\\sqrt{N}(\\mathbf{y} - (\\gamma(0), \\gamma(k))^T)$ 渐近服从 $\\mathcal{N}(0, \\mathbf{C})$ 分布，其中 $\\mathbf{C}$ 是一个 $2 \\times 2$ 矩阵，其元素为 $C_{ab} = \\Sigma_{ab}$，$a,b \\in \\{0,k\\}$。\n函数 $f$ 在 $(\\gamma(0), \\gamma(k))$ 处的梯度为 $\\nabla f = \\left( \\frac{\\partial f}{\\partial u}, \\frac{\\partial f}{\\partial v} \\right)^T = \\left( -\\frac{\\gamma(k)}{\\gamma(0)^2}, \\frac{1}{\\gamma(0)} \\right)^T = \\left( -\\frac{\\rho(k)}{\\gamma(0)}, \\frac{1}{\\gamma(0)} \\right)^T$。\n根据 delta 方法，$\\sqrt{N}(\\hat{\\rho}(k) - \\rho(k))$ 渐近服从均值为 0、方差为 $V_k = (\\nabla f)^T \\mathbf{C} (\\nabla f)$ 的正态分布。\n$$\nV_k = \\begin{pmatrix} -\\frac{\\rho(k)}{\\gamma(0)} & \\frac{1}{\\gamma(0)} \\end{pmatrix} \\begin{pmatrix} C_{00} & C_{0k} \\\\ C_{k0} & C_{kk} \\end{pmatrix} \\begin{pmatrix} -\\frac{\\rho(k)}{\\gamma(0)} \\\\ \\frac{1}{\\gamma(0)} \\end{pmatrix} = \\frac{1}{\\gamma(0)^2} \\left[ \\rho(k)^2 C_{00} - 2\\rho(k)C_{0k} + C_{kk} \\right]\n$$\n因此，首项渐近方差为 $\\operatorname{Var}[\\hat{\\rho}(k)] \\approx V_k/N$。\n\n(b) Ornstein-Uhlenbeck 过程中 $\\hat{\\rho}(k)$ 的方差\n\n我们现在特化到 $\\gamma(h) = \\sigma^2 \\alpha^{|h|}$ 的情况，因此 $\\gamma(0) = \\sigma^2$ 且对于 $k \\ge 0$，有 $\\rho(k) = \\alpha^k$。\n我们需要计算矩阵元素 $C_{00}$、$C_{0k}$ 和 $C_{kk}$。\n$C_{00} = \\sum_{h=-\\infty}^\\infty 2\\gamma(h)^2 = 2\\sigma^4 \\sum_{h=-\\infty}^\\infty \\alpha^{2|h|} = 2\\sigma^4 \\left(1 + 2\\sum_{h=1}^\\infty \\alpha^{2h}\\right) = 2\\sigma^4 \\left(1 + 2\\frac{\\alpha^2}{1-\\alpha^2}\\right) = 2\\sigma^4 \\frac{1+\\alpha^2}{1-\\alpha^2}$。\n\n$C_{0k} = \\sum_{h=-\\infty}^\\infty 2\\gamma(h)\\gamma(h+k) = 2\\sigma^4 \\sum_{h=-\\infty}^\\infty \\alpha^{|h|}\\alpha^{|h+k|}$。\n对求和 $\\sum_{h=-\\infty}^{\\infty} \\alpha^{|h|+|h+k|}$ 进行更仔细的计算，得到 $\\alpha^k(\\frac{1+\\alpha^2}{1-\\alpha^2}+k)$。\n因此，$C_{0k} = 2\\sigma^4 \\alpha^k \\left(\\frac{1+\\alpha^2}{1-\\alpha^2}+k\\right)$。\n\n$C_{kk} = \\sum_{h=-\\infty}^\\infty [\\gamma(h)^2 + \\gamma(h+k)\\gamma(h-k)] = \\sigma^4 \\sum_{h=-\\infty}^\\infty [\\alpha^{2|h|} + \\alpha^{|h+k|+|h-k|}]$。\n和中的第一项是 $\\frac{1+\\alpha^2}{1-\\alpha^2}$。第二项 $\\sum_h \\alpha^{|h+k|+|h-k|}$，计算结果为 $(2k+1)\\alpha^{2k} + 2\\frac{\\alpha^{2(k+1)}}{1-\\alpha^2}$。\n所以，$C_{kk} = \\sigma^4 \\left( \\frac{1+\\alpha^2}{1-\\alpha^2} + (2k+1)\\alpha^{2k} + \\frac{2\\alpha^{2k+2}}{1-\\alpha^2} \\right)$。\n\n将这些代入 $V_k = N\\operatorname{Var}[\\hat{\\rho}(k)]$ 的表达式中：\n$$\nV_k = \\frac{1}{\\sigma^4} \\left[ (\\alpha^k)^2 (2\\sigma^4 \\frac{1+\\alpha^2}{1-\\alpha^2}) - 2\\alpha^k (2\\sigma^4 \\alpha^k (\\frac{1+\\alpha^2}{1-\\alpha^2}+k)) + C_{kk} \\right]\n$$\n在代入 $C_{kk}$ 并进行大量代数简化后（如验证阶段所示），该表达式可简化为一个著名的紧凑结果：\n$$\nN \\operatorname{Var}[\\hat{\\rho}(k)] \\approx (1-\\alpha^{2k})\\frac{1+\\alpha^2}{1-\\alpha^2} - 2k\\alpha^{2k}\n$$\n这就是所要求的方差的闭式首项表达式。\n\n(c) $\\hat{\\tau}_{\\mathrm{int}}$ 的渐近方差\n\n积分自相关时间的估计量由 $\\hat{\\tau}_{\\mathrm{int}} = g(\\hat{\\alpha})$ 给出，其中 $\\hat{\\alpha} = \\hat{\\rho}(1)$ 且 $g(x) = \\frac{1+x}{1-x}$。\n我们使用 delta 方法来求 $\\hat{\\tau}_{\\mathrm{int}}$ 的方差。\n$$\n\\operatorname{Var}[\\hat{\\tau}_{\\mathrm{int}}] \\approx \\left( g'(\\alpha) \\right)^2 \\operatorname{Var}[\\hat{\\alpha}]\n$$\n其中 $\\alpha = \\mathrm{E}[\\hat{\\alpha}]$。导数为：\n$$\ng'(x) = \\frac{d}{dx}\\left(\\frac{1+x}{1-x}\\right) = \\frac{(1)(1-x) - (1+x)(-1)}{(1-x)^2} = \\frac{2}{(1-x)^2}\n$$\n所以，$\\left( g'(\\alpha) \\right)^2 = \\left(\\frac{2}{(1-\\alpha)^2}\\right)^2 = \\frac{4}{(1-\\alpha)^4}$。\n\n接下来，我们需要 $\\operatorname{Var}[\\hat{\\alpha}] = \\operatorname{Var}[\\hat{\\rho}(1)]$。我们使用 (b) 部分中 $k=1$ 时的公式：\n$$\n\\operatorname{Var}[\\hat{\\rho}(1)] \\approx \\frac{1}{N} \\left[ (1-\\alpha^{2(1)})\\frac{1+\\alpha^2}{1-\\alpha^2} - 2(1)\\alpha^{2(1)} \\right]\n$$\n$$\n\\operatorname{Var}[\\hat{\\rho}(1)] \\approx \\frac{1}{N} \\left[ (1-\\alpha^2)\\frac{1+\\alpha^2}{1-\\alpha^2} - 2\\alpha^2 \\right] = \\frac{1}{N} \\left[ (1+\\alpha^2) - 2\\alpha^2 \\right] = \\frac{1-\\alpha^2}{N}\n$$\n最后，我们将这些结果结合起来求 $\\operatorname{Var}[\\hat{\\tau}_{\\mathrm{int}}]$：\n$$\n\\operatorname{Var}[\\hat{\\tau}_{\\mathrm{int}}] \\approx \\frac{4}{(1-\\alpha)^4} \\cdot \\operatorname{Var}[\\hat{\\rho}(1)] \\approx \\frac{4}{(1-\\alpha)^4} \\frac{1-\\alpha^2}{N}\n$$\n使用因式分解 $1-\\alpha^2 = (1-\\alpha)(1+\\alpha)$，我们得到：\n$$\n\\operatorname{Var}[\\hat{\\tau}_{\\mathrm{int}}] \\approx \\frac{4(1-\\alpha)(1+\\alpha)}{N(1-\\alpha)^4} = \\frac{4(1+\\alpha)}{N(1-\\alpha)^3}\n$$\n这就是估计量 $\\hat{\\tau}_{\\mathrm{int}}$ 的首项渐近方差的最终表达式。", "answer": "$$\n\\boxed{\\frac{4(1+\\alpha)}{N(1-\\alpha)^3}}\n$$", "id": "3437744"}, {"introduction": "在处理完估计量的统计涨落（方差）之后，我们进一步探讨由数据相关性引起的系统性误差（偏差）。当我们计算观测量的一个非线性函数（例如熵）时，有限样本和数据相关性会共同导致一个系统性的偏差，即使概率本身的估计是无偏的。这个练习旨在揭示这种偏差的数学根源，并展示它如何与积分自相关时间联系起来，加深你对从相关数据中计算复杂热力学量时所面临挑战的理解。[@problem_id:3437732]", "problem": "一维反应坐标 $x_t$ 从一个稳态遍历的分子动力学 (MD) 轨迹中采样，该轨迹由恒温下的过阻尼朗之万动力学生成，采样间隔为 $\\Delta t$。稳态分布的概率密度函数为 $p(x)$，其香农熵为 $S=-\\int p(x)\\ln p(x)\\,dx$。在实际的分子采样中，您使用一个固定的直方图来估计 $S$，该直方图包含 $m$ 个等宽的不相交区间 $\\{B_i\\}_{i=1}^{m}$，这些区间划分了 $p(x)$ 的支撑集。定义 $p_i=\\int_{B_i}p(x)\\,dx$ 和置换估计量 $\\hat{S}=-\\sum_{i=1}^{m}\\hat{p}_i\\ln\\hat{p}_i$，其中 $\\hat{p}_i=n_i/N$，$n_i$ 是在 $N$ 个记录的时间点中，样本 $x_t$ 落入区间 $B_i$ 的计数。\n\n假设以下科学上真实的条件：\n- 区间宽度足够小，以至于用离散熵 $-\\sum_{i=1}^{m}p_i\\ln p_i$ 近似 $S$ 时产生的确定性离散化误差与随机采样误差相比可以忽略不计。\n- 指示变量序列 $Y_{t,i}=\\mathbf{1}\\{x_t\\in B_i\\}$ 是弱相关的，其自相关函数 $\\rho(k)=\\mathrm{Corr}(Y_{t,i},Y_{t+k,i})$ 随 $k$ 指数衰减，并且对于所有区间 $i$ 都是相同的。\n- 积分自相关因子定义为 $g=1+2\\sum_{k=1}^{\\infty}\\rho(k)$，并且由于混合性而是有限的。对于指数衰减 $\\rho(k)=\\exp(-k\\Delta t/\\tau_c)$，$g=\\coth\\!\\big(\\frac{\\Delta t}{2\\tau_c}\\big)$，其中 $\\tau_c$ 是相关时间。\n\n从熵的核心定义和直方图计数的多项式采样结构出发，并且仅使用相关时间序列的弱相关中心极限定理缩放，推导由有限相关采样引起的主阶渐近偏差 $\\mathbb{E}[\\hat{S}]-\\sum_{i=1}^{m}p_i\\ln p_i$。用 $m$、$N$ 和 $g$ 将您的最终答案表示为单个闭合形式的解析表达式。\n\n此外，请讨论——在不使用任何给定的快捷公式的情况下——为相关样本构建消除此主阶偏差的原则性修正方法，并借鉴 Grassberger 基于 digamma 函数的熵估计量和贝叶斯狄利克雷后验熵估计量背后的逻辑，解释混合性如何进入这些修正中。您对偏差的推导必须是自洽且逻辑完整的。最终答案应仅为所要求的偏差表达式；无需四舍五入。", "solution": "用户要求推导基于直方图的熵估计量在处理相关时间序列数据时的主阶渐近偏差，并随后讨论偏差修正方法。\n\n### 问题验证\n\n首先，我将验证问题陈述。\n\n#### 步骤 1：提取已知条件\n-   系统是一维反应坐标 $x_t$，来自一个由过阻尼朗之万动力学生成的稳态遍历分子动力学 (MD) 轨迹。\n-   采样间隔为 $\\Delta t$。\n-   稳态概率密度函数为 $p(x)$。\n-   香农熵为 $S = -\\int p(x)\\ln p(x)\\,dx$。\n-   $S$ 的估计量使用一个包含 $m$ 个等宽不相交区间 $\\{B_i\\}_{i=1}^{m}$ 的固定直方图。\n-   样本落入区间 $B_i$ 的真实概率为 $p_i = \\int_{B_i} p(x)\\,dx$。\n-   估计概率为 $\\hat{p}_i = n_i/N$，其中 $n_i$ 是区间 $B_i$ 中的计数，$N$ 是总样本数。\n-   置换熵估计量为 $\\hat{S} = -\\sum_{i=1}^{m} \\hat{p}_i \\ln \\hat{p}_i$。\n-   目标量是主阶渐近偏差 $\\mathbb{E}[\\hat{S}] - S_d$，其中 $S_d = -\\sum_{i=1}^{m} p_i \\ln p_i$。\n-   假设 1：确定性离散化误差可忽略不计，因此我们可以将 $S_d$ 视为真值。\n-   假设 2：指示变量 $Y_{t,i} = \\mathbf{1}\\{x_t \\in B_i\\}$ 构成一个弱相关时间序列。\n-   假设 3：自相关函数 $\\rho(k) = \\mathrm{Corr}(Y_{t,i}, Y_{t+k,i})$ 对所有区间 $i$ 都相同。\n-   假设 4：积分自相关因子 $g = 1 + 2\\sum_{k=1}^{\\infty} \\rho(k)$ 是有限的。对于指数衰减 $\\rho(k) = \\exp(-k\\Delta t/\\tau_c)$，$g=\\coth(\\frac{\\Delta t}{2\\tau_c})$。\n\n#### 步骤 2：使用提取的已知条件进行验证\n该问题具有坚实的科学基础，涉及计算统计力学中的一个标准任务——从相关的模拟数据中估计热力学量。所有术语，如“过阻尼朗之万动力学”、“稳态遍历”、“自相关”和“积分自相关因子”，都是标准且使用正确的。问题设置是自洽的，并为渐近推导提供了所有必要的信息。这些假设是现实的简化，在此背景下估计量的理论分析中常用。该问题未违反任何无效性标准。它是应用概率论中一个非平凡、可形式化的问题。\n\n#### 步骤 3：结论与行动\n问题有效。我现在将进行推导和讨论。\n\n### 偏差的推导\n\n目标是计算主阶渐近偏差 $B = \\mathbb{E}[\\hat{S}] - S_d$，其中 $S_d = -\\sum_{i=1}^{m} p_i \\ln p_i$ 是离散概率分布 $\\{p_i\\}$ 的熵。估计量 $\\hat{S}$ 是随机估计概率 $\\{\\hat{p}_i\\}$ 的函数。我们可以通过将 $\\hat{S}$ 在真实概率 $\\{p_i\\}$ 周围进行泰勒级数展开来分析其期望。\n\n令 $\\Delta p_i = \\hat{p}_i - p_i$。要展开的函数是 $f(\\hat{p}_1, \\dots, \\hat{p}_m) = -\\sum_{i=1}^{m} \\hat{p}_i \\ln \\hat{p}_i$。我们在点 $(p_1, \\dots, p_m)$ 周围展开此函数。二阶泰勒展开式为：\n$$\nf(\\{\\hat{p}_i\\}) \\approx f(\\{p_i\\}) + \\sum_{j=1}^{m} \\frac{\\partial f}{\\partial p_j} \\Delta p_j + \\frac{1}{2} \\sum_{j=1}^{m} \\sum_{k=1}^{m} \\frac{\\partial^2 f}{\\partial p_j \\partial p_k} \\Delta p_j \\Delta p_k\n$$\n$f$ 的偏导数在 $\\{p_i\\}$ 处的值为：\n$$\n\\frac{\\partial f}{\\partial p_j} = -\\frac{\\partial}{\\partial p_j} \\left( \\sum_{i=1}^{m} p_i \\ln p_i \\right) = -(\\ln p_j + 1)\n$$\n$$\n\\frac{\\partial^2 f}{\\partial p_j \\partial p_k} = -\\frac{\\partial}{\\partial p_k} (\\ln p_j + 1) = -\\frac{1}{p_j} \\delta_{jk}\n$$\n其中 $\\delta_{jk}$ 是克罗内克 delta 符号。\n\n将这些导数代入展开式中得到：\n$$\n\\hat{S} \\approx S_d - \\sum_{j=1}^{m} (\\ln p_j + 1) (\\hat{p}_j - p_j) - \\frac{1}{2} \\sum_{j=1}^{m} \\frac{1}{p_j} (\\hat{p}_j - p_j)^2\n$$\n为了求偏差，我们对该表达式取期望。偏差为 $B = \\mathbb{E}[\\hat{S}] - S_d$：\n$$\nB \\approx \\mathbb{E}\\left[ - \\sum_{j=1}^{m} (\\ln p_j + 1) (\\hat{p}_j - p_j) - \\frac{1}{2} \\sum_{j=1}^{m} \\frac{1}{p_j} (\\hat{p}_j - p_j)^2 \\right]\n$$\n根据期望的线性性质：\n$$\nB \\approx - \\sum_{j=1}^{m} (\\ln p_j + 1) \\mathbb{E}[\\hat{p}_j - p_j] - \\frac{1}{2} \\sum_{j=1}^{m} \\frac{1}{p_j} \\mathbb{E}[(\\hat{p}_j - p_j)^2]\n$$\n首先，我们评估偏差的期望 $\\mathbb{E}[\\hat{p}_j - p_j]$。估计量 $\\hat{p}_j$ 是指示变量 $Y_{t,j} = \\mathbf{1}\\{x_t \\in B_j\\}$ 的样本均值。\n$$\n\\hat{p}_j = \\frac{n_j}{N} = \\frac{1}{N} \\sum_{t=1}^{N} Y_{t,j}\n$$\n由于过程是稳态的， $Y_{t,j}$ 的期望对所有 $t$ 都是常数：$\\mathbb{E}[Y_{t,j}] = \\Pr(x_t \\in B_j) = p_j$。\n因此，估计量 $\\hat{p}_j$ 是无偏的：\n$$\n\\mathbb{E}[\\hat{p}_j] = \\frac{1}{N} \\sum_{t=1}^{N} \\mathbb{E}[Y_{t,j}] = \\frac{1}{N} \\sum_{t=1}^{N} p_j = p_j\n$$\n这意味着 $\\mathbb{E}[\\hat{p}_j - p_j] = 0$，所以偏差展开中的一阶项消失。主阶偏差由二阶项给出：\n$$\nB \\approx - \\frac{1}{2} \\sum_{j=1}^{m} \\frac{1}{p_j} \\mathbb{E}[(\\hat{p}_j - p_j)^2] = - \\frac{1}{2} \\sum_{j=1}^{m} \\frac{1}{p_j} \\mathrm{Var}(\\hat{p}_j)\n$$\n接下来，我们必须求出 $\\hat{p}_j$ 的方差。问题指出，对于弱相关时间序列，样本均值的方差根据相关过程的中心极限定理进行缩放。稳态时间序列 $A_t$ 的样本均值 $\\bar{A} = \\frac{1}{N}\\sum_{t=1}^N A_t$ 的方差由下式给出：\n$$\n\\mathrm{Var}(\\bar{A}) \\approx \\frac{\\mathrm{Var}(A_t)}{N_{eff}} = \\frac{\\mathrm{Var}(A_t) g}{N}\n$$\n其中 $g = 1 + 2\\sum_{k=1}^{\\infty} \\mathrm{Corr}(A_t, A_{t+k})$ 是积分自相关因子，它量化了由相关性引起的统计效率损失。\n\n在我们的例子中，时间序列是 $Y_{t,j}$。其方差 $\\mathrm{Var}(Y_{t,j})$ 是成功概率为 $p_j$ 的伯努利随机变量的方差：\n$$\n\\mathrm{Var}(Y_{t,j}) = \\mathbb{E}[Y_{t,j}^2] - (\\mathbb{E}[Y_{t,j}])^2 = p_j - p_j^2 = p_j(1 - p_j)\n$$\n问题指定自相关结构，以及因此的 $g$，对所有区间 $j$ 都是相同的。应用缩放规则，$\\hat{p}_j$ 的方差是：\n$$\n\\mathrm{Var}(\\hat{p}_j) \\approx \\frac{\\mathrm{Var}(Y_{t,j}) g}{N} = \\frac{p_j(1 - p_j)g}{N}\n$$\n将此方差代入偏差 $B$ 的表达式中：\n$$\nB \\approx - \\frac{1}{2} \\sum_{j=1}^{m} \\frac{1}{p_j} \\left( \\frac{p_j(1 - p_j)g}{N} \\right)\n$$\n我们可以简化这个表达式：\n$$\nB \\approx - \\frac{g}{2N} \\sum_{j=1}^{m} (1 - p_j)\n$$\n该和式可以通过注意到区间 $\\{B_j\\}$ 构成了状态空间的一个划分来计算，因此概率总和必须为 1：$\\sum_{j=1}^{m} p_j = 1$。\n$$\n\\sum_{j=1}^{m} (1 - p_j) = \\sum_{j=1}^{m} 1 - \\sum_{j=1}^{m} p_j = m - 1\n$$\n最终，我们得到了相关样本的置换熵估计量的主阶渐近偏差：\n$$\nB \\approx -\\frac{g(m-1)}{2N}\n$$\n这个结果是经典 Miller-Madow 偏差的推广，后者适用于独立多项式采样，其中 $g=1$。时间相关性的效应是将偏差放大了因子 $g$。\n\n### 偏差修正的讨论\n\n偏差的产生是因为熵是概率的非线性凹函数，对于任何这样的函数 $f$，$\\mathbb{E}[f(\\hat{\\theta})]$ 通常不等于 $f(\\mathbb{E}[\\hat{\\theta}])$。原则性的修正方法旨在解决这个问题。上述推导直接提出了一个简单的加性修正：\n$$\n\\hat{S}_{corr} = \\hat{S} - B = \\hat{S} + \\frac{g(m-1)}{2N}\n$$\n这是 Miller-Madow 修正的相关版本。其主要局限性在于它是使用一个假设每个区间中都有大计数 $n_i$ 的渐近展开推导出来的。\n\n更复杂的修正方法，例如 Grassberger 或贝叶斯估计量的方法，会修改估计量的函数形式。这些方法背后的逻辑可以扩展到相关数据，只需认识到相关性减少了统计上独立的样本数量。量 $N_{eff} = N/g$ 代表了这个有效样本量。混合性，由积分自相关因子 $g$ 量化，是连接相关时间序列与等效独立采样问题的关键参数。\n\n1.  **Grassberger 类型修正的逻辑：** 对于独立样本，由 Grassberger 等人开发的估计量通常用 $\\mathbb{E}[\\ln p_i]$ 的改进估计量替换 $\\ln(\\hat{p}_i)$ 项。这些估计量经常涉及 digamma 函数 $\\psi(x)$，它在计算伽马分布或贝塔分布（与泊松和二项计数相关）等分布中随机变量对数的期望时自然出现。例如，一个用于独立数据的估计量可能形如 $\\hat{S}_G = \\sum_{i=1}^m \\frac{n_i}{N}(\\ln N - \\psi(n_i))$。要为相关数据构建原则性的修正，可以应用有效样本量的概念。核心思想是将从长度为 $N$ 的相关序列中观测到的计数 $\\{n_i\\}$ 视作在统计上等效于从长度为 $N/g$ 的独立序列中得到的有效计数 $\\{n_i/g\\}$。因此，一个修正的 Grassberger 式估计量会将 i.i.d. 公式中的 $N$ 替换为 $N/g$，将 $n_i$ 替换为 $n_i/g$，从而得到类似 $\\hat{S}_{G,corr} = \\sum_i \\hat{p}_i (\\ln(N/g) - \\psi(n_i/g))$ 的表达式。这种替换将混合性的影响直接纳入了估计量的结构中。\n\n2.  **贝叶斯修正的逻辑：** 贝叶斯方法将未知概率 $\\{p_i\\}$ 视为随机变量，并计算在给定数据下其后验分布上的期望熵。对于独立多项式计数 $\\{n_i\\}$，狄利克雷先验 $P(\\{p_i\\}) \\propto \\prod_i p_i^{\\alpha_i-1}$ 会得到一个更新参数为 $\\{n_i+\\alpha_i\\}$ 的狄利克雷后验分布。由此产生的熵估计量是该后验分布上熵的均值，这也涉及 digamma 函数。为了将其应用于相关数据，必须修改似然函数 $P(\\{n_i\\}|\\{p_i\\})$，它不再是多项式分布。基于相同的中心极限定理缩放，相关似然可以由一个有效样本量为 $N_{eff} = N/g$ 的多项式似然来近似。因此，对相关样本的原则性贝叶斯修正涉及计算后验分布，就好像观测到了 $N/g$ 个独立样本，从而得到 $n_i/g$ 的有效计数。后验分布将是 $P(\\{p_i\\} | \\{n_i\\}, g) \\propto P(\\{p_i\\}) \\times (\\text{具有 } N/g, \\{n_i/g\\} \\text{ 的多项式似然})$。混合性通过 $g$ 因子，通过重新缩放数据为贝叶斯推断提供的信息量而进入模型。\n\n总而言之，为相关数据构建原则性修正的关键在于有效样本量 $N_{eff} = N/g$ 的概念。混合性通过因子 $g$ 决定了在应用最初为独立数据设计的修正方法之前，必须将样本量向下加权的程度。", "answer": "$$\n\\boxed{-\\frac{g(m-1)}{2N}}\n$$", "id": "3437732"}, {"introduction": "现在，我们将目光从平衡态数据的分析转向非平衡过程中的一个核心挑战：自由能计算。Jarzynski恒等式为计算自由能差提供了一条优雅的路径，但其直接应用常常因为受到稀有但影响巨大的“负功”事件的主导而收敛性极差。这个练习将向你展示如何利用重要性采样这一强大的方差缩减技术，来主动地、智能地对这些关键事件进行采样，从而显著提高非平衡自由能计算的效率和可靠性。[@problem_id:3437697]", "problem": "在一个逆温度为 $\\beta > 0$ 的单分子拉伸实验中，通过驱动协议的独立实现产生了非平衡功值 $W$。亥姆霍兹自由能差 $\\Delta F$ 与功 $W$ 通过 Jarzynski 等式相关联，该等式表述为 $\\Delta F = -\\beta^{-1} \\ln \\langle \\exp(-\\beta W) \\rangle$，其中 $\\langle \\cdot \\rangle$ 表示对真实功分布的期望。在远离平衡的协议中，功分布在做功（大的负 $W$ 值）一侧可能呈重尾分布。考虑以下关于功 $W$ 的统计上合理的模型：它遵循不对称拉普拉斯定律，其位置参数为 $m \\in \\mathbb{R}$，左/右尺度参数为 $s_{-} > 0$ 和 $s_{+} > 0$，概率密度函数为\n$$\nf(w) = \\begin{cases}\n\\dfrac{1}{s_{-} + s_{+}} \\exp\\!\\left(\\dfrac{w - m}{s_{-}}\\right), & w  m \\\\\n\\dfrac{1}{s_{-} + s_{+}} \\exp\\!\\left(-\\dfrac{w - m}{s_{+}}\\right),  w \\ge m\n\\end{cases}\n$$\n该模型在 $s_{-}$ 较大时能够捕捉到较重的左尾，这与主导 $\\langle \\exp(-\\beta W)\\rangle$ 的罕见、大的做功事件相关。\n\n您将通过对数矩生成函数分析估计量的可靠性，并设计一个重要性采样方案来控制方差：\n\n1. 从矩生成函数 $M(t) = \\langle \\exp(t W) \\rangle$ 及其对数 $\\kappa(t) = \\ln M(t)$ 的定义出发，推导上述 $f(w)$ 的 $\\kappa(t)$，并确定使 $\\kappa(t)$ 有限的 $t$ 的定义域。用 $s_{-}$ 和 $s_{+}$ 表述，给出 Jarzynski 期望 $\\langle \\exp(-\\beta W) \\rangle$ 存在的条件，以及 $\\langle \\exp(-\\beta W)\\rangle$ 的朴素样本均值估计量具有有限方差的更严格条件。\n\n2. 考虑带有参数 $\\lambda$ 的指数倾斜重要性采样器，\n$$\ng_{\\lambda}(w) = \\exp\\!\\big(\\lambda w - \\kappa(\\lambda)\\big)\\, f(w),\n$$\n当 $\\kappa(\\lambda)$ 有限时，该采样器是良定义的。当从 $g_{\\lambda}$ 中抽取独立样本 $W^{(1)},\\dots,W^{(N)}$ 时，使用无偏重要性采样估计量\n$$\n\\widehat{Z}_{N}(\\lambda) = \\frac{1}{N} \\sum_{i=1}^{N} \\exp\\!\\big(-( \\beta + \\lambda ) W^{(i)} + \\kappa(\\lambda)\\big),\n$$\n来估计 Jarzynski 期望，使得 $\\langle \\widehat{Z}_{N}(\\lambda) \\rangle = \\langle \\exp(-\\beta W) \\rangle \\equiv Z$。仅使用上述定义和矩生成函数的标准性质，以闭式形式计算单样本二阶矩 $\\langle \\widehat{Z}_{N}(\\lambda)^{2} \\rangle$，并用它来获得渐进单样本方差 $V(\\lambda) = \\langle \\widehat{Z}_{N}(\\lambda)^{2} \\rangle - Z^{2}$。\n\n3. 在所有使所涉及表达式有限的允许的 $\\lambda$ 中，确定最小化 $V(\\lambda)$ 的最优倾斜参数 $\\lambda^{\\ast}$ 的解析表达式。\n\n将 $\\lambda^{\\ast}$ 的最终答案表示为仅包含 $\\beta$ 的闭式符号表达式。不需要数值舍入。最终答案中不要包含单位，但在推导过程中可以假设 $\\beta$ 和 $\\lambda$ 具有相同的物理单位（能量的倒数）。", "solution": "该问题要求对单分子实验中功值的不对称拉普拉斯分布模型进行三部分分析，重点关注 Jarzynski 等式和重要性采样。\n\n### 第一部分：对数矩生成函数和存在性条件\n\n首先，我们为给定的概率密度函数 $f(w)$ 推导矩生成函数 (MGF) $M(t) = \\langle \\exp(t W) \\rangle$。\n$$\nf(w) = \\begin{cases}\n\\dfrac{1}{s_{-} + s_{+}} \\exp\\left(\\dfrac{w - m}{s_{-}}\\right),  w  m \\\\\n\\dfrac{1}{s_{-} + s_{+}} \\exp\\left(-\\dfrac{w - m}{s_{+}}\\right),  w \\ge m\n\\end{cases}\n$$\nMGF 是通过将 $\\exp(tw)f(w)$ 在 $W$ 的定义域上积分来计算的：\n$$\nM(t) = \\int_{-\\infty}^{\\infty} \\exp(tw) f(w) dw = \\int_{-\\infty}^{m} \\exp(tw) f(w) dw + \\int_{m}^{\\infty} \\exp(tw) f(w) dw\n$$\n我们分别计算这两个积分。第一个积分是：\n$$\nI_1 = \\frac{1}{s_{-} + s_{+}} \\int_{-\\infty}^{m} \\exp(tw) \\exp\\left(\\frac{w - m}{s_{-}}\\right) dw = \\frac{\\exp(-m/s_{-})}{s_{-} + s_{+}} \\int_{-\\infty}^{m} \\exp\\left(w\\left(t + \\frac{1}{s_{-}}\\right)\\right) dw\n$$\n为使该积分收敛，指数的系数必须为正：$t + \\frac{1}{s_{-}}  0$，即 $t  -1/s_{-}$。在此条件下：\n$$\nI_1 = \\frac{\\exp(-m/s_{-})}{s_{-} + s_{+}} \\left[ \\frac{\\exp(w(t + 1/s_{-}))}{t + 1/s_{-}} \\right]_{-\\infty}^{m} = \\frac{\\exp(-m/s_{-})}{s_{-} + s_{+}} \\frac{\\exp(m(t+1/s_{-}))}{t+1/s_{-}} = \\frac{\\exp(mt)}{s_{-} + s_{+}} \\frac{s_{-}}{1 + ts_{-}}\n$$\n第二个积分是：\n$$\nI_2 = \\frac{1}{s_{-} + s_{+}} \\int_{m}^{\\infty} \\exp(tw) \\exp\\left(-\\frac{w - m}{s_{+}}\\right) dw = \\frac{\\exp(m/s_{+})}{s_{-} + s_{+}} \\int_{m}^{\\infty} \\exp\\left(w\\left(t - \\frac{1}{s_{+}}\\right)\\right) dw\n$$\n为使该积分收敛，指数的系数必须为负：$t - \\frac{1}{s_{+}}  0$，即 $t  1/s_{+}$。在此条件下：\n$$\nI_2 = \\frac{\\exp(m/s_{+})}{s_{-} + s_{+}} \\left[ \\frac{\\exp(w(t - 1/s_{+}))}{t - 1/s_{+}} \\right]_{m}^{\\infty} = \\frac{\\exp(m/s_{+})}{s_{-} + s_{+}} \\left( 0 - \\frac{\\exp(m(t-1/s_{+}))}{t-1/s_{+}} \\right) = \\frac{\\exp(mt)}{s_{-} + s_{+}} \\frac{s_{+}}{1 - ts_{+}}\n$$\n将两部分合并，对于 $t \\in (-1/s_{-}, 1/s_{+})$：\n$$\nM(t) = I_1 + I_2 = \\frac{\\exp(mt)}{s_{-} + s_{+}} \\left( \\frac{s_{-}}{1 + ts_{-}} + \\frac{s_{+}}{1 - ts_{+}} \\right) = \\frac{\\exp(mt)}{s_{-} + s_{+}} \\frac{s_{-}(1-ts_{+}) + s_{+}(1+ts_{-})}{(1+ts_{-})(1-ts_{+})}\n$$\n$$\nM(t) = \\frac{\\exp(mt)}{s_{-} + s_{+}} \\frac{s_{-} + s_{+}}{1 + t(s_{-} - s_{+}) - t^2 s_{-} s_{+}} = \\frac{\\exp(mt)}{1 + t(s_{-} - s_{+}) - t^2 s_{-} s_{+}}\n$$\n因此，对数矩生成函数 $\\kappa(t) = \\ln M(t)$ 为：\n$$\n\\kappa(t) = mt - \\ln\\left(1 + t(s_{-} - s_{+}) - t^2 s_{-} s_{+}\\right)\n$$\n该函数在开区间 $(-1/s_{-}, 1/s_{+})$ 内的 $t$ 是有限的。\n\nJarzynski 期望为 $\\langle \\exp(-\\beta W) \\rangle = M(-\\beta)$。为使其存在，$-\\beta$ 必须在 $M(t)$ 的定义域内。所以，$-1/s_{-}  -\\beta  1/s_{+}$。\n因为 $\\beta  0$ 且 $s_{+}  0$，右侧不等式 $-\\beta  1/s_{+}$ 总是成立。\n左侧不等式为 $-1/s_{-}  -\\beta$，两边乘以 $-1$ 后变为 $1/s_{-}  \\beta$。因此，Jarzynski 期望存在的条件是 $\\beta  1/s_{-}$。\n\n$\\langle \\exp(-\\beta W) \\rangle$ 的朴素样本均值估计量的方差是有限的，当且仅当被平均的量 $\\exp(-\\beta W)$ 的二阶矩是有限的。这个二阶矩是 $\\langle (\\exp(-\\beta W))^2 \\rangle = \\langle \\exp(-2\\beta W) \\rangle = M(-2\\beta)$。为使其存在，$-2\\beta$ 必须在 $M(t)$ 的定义域内。所以，$-1/s_{-}  -2\\beta  1/s_{+}$。\n右侧不等式 $-2\\beta  1/s_{+}$ 总是成立。左侧不等式为 $-1/s_{-}  -2\\beta$，这意味着 $1/s_{-}  2\\beta$，即 $\\beta  1/(2s_{-})$。这是一个更严格的条件。\n\n### 第二部分：重要性采样估计量的方差\n\n重要性采样估计量为 $\\widehat{Z}_{N}(\\lambda) = \\frac{1}{N} \\sum_{i=1}^{N} Y_i(\\lambda)$，其中 $Y_i(\\lambda) = \\exp(-( \\beta + \\lambda ) W^{(i)} + \\kappa(\\lambda))$ 且 $W^{(i)}$ 是从 $g_{\\lambda}(w)$ 中抽取的独立同分布（i.i.d.）样本。我们已知 $\\langle \\widehat{Z}_{N}(\\lambda) \\rangle = \\langle Y_1(\\lambda) \\rangle = Z$。\n\n问题要求计算单样本二阶矩 $\\langle \\widehat{Z}_{N}(\\lambda)^{2} \\rangle$。由于样本 $W^{(i)}$ 是独立的，随机变量 $Y_i(\\lambda)$ 也是独立同分布的。\n$$\n\\langle \\widehat{Z}_{N}(\\lambda)^{2} \\rangle = \\left\\langle \\left(\\frac{1}{N} \\sum_{i=1}^{N} Y_i(\\lambda)\\right)^2 \\right\\rangle = \\frac{1}{N^2} \\left\\langle \\sum_{i=1}^{N} Y_i(\\lambda)^2 + \\sum_{i \\neq j} Y_i(\\lambda)Y_j(\\lambda) \\right\\rangle\n$$\n$$\n= \\frac{1}{N^2} \\left( \\sum_{i=1}^{N} \\langle Y_i(\\lambda)^2 \\rangle + \\sum_{i \\neq j} \\langle Y_i(\\lambda) \\rangle \\langle Y_j(\\lambda) \\rangle \\right) = \\frac{1}{N^2} \\left( N \\langle Y_1(\\lambda)^2 \\rangle + N(N-1) Z^2 \\right) = \\frac{1}{N} \\langle Y_1(\\lambda)^2 \\rangle + \\frac{N-1}{N} Z^2\n$$\n单个样本的二阶矩 $\\langle Y_1(\\lambda)^2 \\rangle$ 是相对于采样分布 $g_{\\lambda}(w)$ 计算的：\n$$\n\\langle Y_1(\\lambda)^2 \\rangle = \\int_{-\\infty}^{\\infty} \\left[\\exp(-( \\beta + \\lambda ) w + \\kappa(\\lambda))\\right]^2 g_{\\lambda}(w) dw\n$$\n代入 $g_{\\lambda}(w) = \\exp(\\lambda w - \\kappa(\\lambda)) f(w)$：\n$$\n\\langle Y_1(\\lambda)^2 \\rangle = \\int_{-\\infty}^{\\infty} \\exp(-2(\\beta + \\lambda)w + 2\\kappa(\\lambda)) \\exp(\\lambda w - \\kappa(\\lambda)) f(w) dw\n$$\n$$\n= \\exp(\\kappa(\\lambda)) \\int_{-\\infty}^{\\infty} \\exp(-(2\\beta + \\lambda)w) f(w) dw\n$$\n该积分是 $W$ 的 MGF 在 $t=-(2\\beta+\\lambda)$ 处的值，即 $M(-(2\\beta+\\lambda)) = \\exp(\\kappa(-(2\\beta+\\lambda)))$。\n$$\n\\langle Y_1(\\lambda)^2 \\rangle = \\exp(\\kappa(\\lambda)) M(-(2\\beta+\\lambda)) = \\exp(\\kappa(\\lambda) + \\kappa(-(2\\beta+\\lambda)))\n$$\n所以，单样本二阶矩为 $\\langle \\widehat{Z}_{N}(\\lambda)^{2} \\rangle = \\frac{1}{N}\\exp(\\kappa(\\lambda) + \\kappa(-(2\\beta+\\lambda))) + \\frac{N-1}{N}Z^2$。\n渐进单样本方差定义为 $V(\\lambda) = \\langle \\widehat{Z}_{N}(\\lambda)^{2} \\rangle - Z^{2}$。\n$$\nV(\\lambda) = \\left(\\frac{1}{N}\\exp(\\kappa(\\lambda) + \\kappa(-(2\\beta+\\lambda))) + \\frac{N-1}{N}Z^2\\right) - Z^2 = \\frac{1}{N} \\left[ \\exp(\\kappa(\\lambda) + \\kappa(-(2\\beta+\\lambda))) - Z^2 \\right]\n$$\n这个量 $V(\\lambda)$ 依赖于 $N$。然而，最小化 $V(\\lambda)$ 的最优 $\\lambda$ 也是最小化项 $\\exp(\\kappa(\\lambda) + \\kappa(-(2\\beta+\\lambda)))$ 的那个，与因子 $1/N$ 无关。\n\n### 第三部分：最优倾斜参数\n\n为了找到最小化 $V(\\lambda)$ 的最优倾斜参数 $\\lambda^{\\ast}$，我们需要最小化函数 $J(\\lambda) = \\exp(\\kappa(\\lambda) + \\kappa(-(2\\beta+\\lambda)))$。这等价于最小化其对数 $L(\\lambda) = \\kappa(\\lambda) + \\kappa(-(2\\beta+\\lambda))$。我们通过将其关于 $\\lambda$ 的导数设为零来找到最小值：\n$$\n\\frac{dL}{d\\lambda} = \\frac{d}{d\\lambda} \\left[ \\kappa(\\lambda) + \\kappa(-(2\\beta+\\lambda)) \\right] = \\kappa'(\\lambda) + \\kappa'(-(2\\beta+\\lambda)) \\cdot (-1) = 0\n$$\n这给出了最优 $\\lambda^{\\ast}$ 的条件：\n$$\n\\kappa'(\\lambda^{\\ast}) = \\kappa'(-2\\beta-\\lambda^{\\ast})\n$$\n函数 $\\kappa(t)$ 是累积量生成函数。其二阶导数 $\\kappa''(t)$ 对应于指数倾斜分布的方差，该方差必须为非负。我们来计算它：\n$$\n\\kappa'(t) = m - \\frac{s_{-} - s_{+} - 2t s_{-}s_{+}}{1 + t(s_{-} - s_{+}) - t^2 s_{-} s_{+}}\n$$\n$$\n\\kappa''(t) = \\frac{d}{dt} \\left( m - \\frac{s_{-} - s_{+} - 2t s_{-}s_{+}}{P(t)} \\right) = - \\frac{-2s_{-}s_{+}P(t) - (s_{-} - s_{+} - 2t s_{-}s_{+})P'(t)}{P(t)^2}\n$$\n其中 $P(t) = (1+ts_{-})(1-ts_{+})$ 且 $P'(t) = s_{-} - s_{+} - 2t s_{-}s_{+}$，我们得到：\n$$\n\\kappa''(t) = \\frac{2s_{-}s_{+}(1+ts_{-})(1-ts_{+}) + (s_{-} - s_{+} - 2t s_{-}s_{+})^2}{((1+ts_{-})(1-ts_{+}))^2}\n$$\n在收敛域 $t \\in (-1/s_{-}, 1/s_{+})$ 内，分母为正。分子是一个正项 $2s_{-}s_{+}(...)$ 与一个非负平方项之和。因此，在该定义域内的所有 $t$ 都有 $\\kappa''(t)0$。这表明 $\\kappa(t)$ 是一个严格凸函数。\n严格凸性的一个推论是其导数 $\\kappa'(t)$ 是一个严格递增的函数。对于严格递增的函数，等式 $\\kappa'(a) = \\kappa'(b)$ 成立当且仅当 $a=b$。\n将此应用于我们的条件 $\\kappa'(\\lambda^{\\ast}) = \\kappa'(-2\\beta-\\lambda^{\\ast})$，我们必有：\n$$\n\\lambda^{\\ast} = -2\\beta - \\lambda^{\\ast}\n$$\n$$\n2\\lambda^{\\ast} = -2\\beta\n$$\n$$\n\\lambda^{\\ast} = -\\beta\n$$\n如果此解位于方差有限的定义域内，那么它就是允许的。方差涉及到 $\\kappa(\\lambda)$ 和 $\\kappa(-2\\beta-\\lambda)$。它们的自变量必须在 $(-1/s_{-}, 1/s_{+})$ 内。\n对于 $\\lambda = -\\beta$：\n1. $-\\beta \\in (-1/s_{-}, 1/s_{+})$ 要求 $\\beta  1/s_{-}$。这是 Jarzynski 平均本身存在的条件，也是问题的隐含假设。\n2. $-2\\beta-\\lambda = -2\\beta-(-\\beta) = -\\beta$。条件相同。\n因此，最优倾斜参数 $\\lambda^{\\ast}$ 是 $-\\beta$。", "answer": "$$\n\\boxed{-\\beta}\n$$", "id": "3437697"}]}