{"hands_on_practices": [{"introduction": "玻恩-奥本海默近似为我们提供了支配原子核运动的势能面。但是，当电子态发生简并时会发生什么呢？本练习将探讨雅恩-泰勒效应，这是一个基本原理，其中振动-电子耦合（vibronic coupling）通过扭曲原子核骨架来消除电子简并。通过推导著名的“墨西哥帽”势，您将亲身体验对称性破缺是如何作为最简单玻恩-Oppenheimer图像失效的直接后果而出现的，并理解它如何导致更复杂的势能景观 [@problem_id:3493325]。", "problem": "考虑一个晶体材料中的配位点，其高对称性电子基态是双重简并的，根据该配位点的点群的不可约表示 $E$ 进行变换。与该电子简并耦合的最低能量振动畸变是一个双重简并的简正模式，根据 $e$ 进行变换，其质量加权简正坐标为 $Q_{1}$ 和 $Q_{2}$，谐振回复力常数为 $K>0$。在 Born–Oppenheimer (BO) 近似下进行计算，其中电子自由度瞬时适应固定的原子核位置，并将振动耦合相互作用处理到原子核位移的线性阶。假设高对称性几何构型下的电子参考能量设置为零。\n\n任务：\n- 利用对称性考虑以及乘积表示 $E \\otimes e$ 包含全对称表示这一事实，构建此 $E \\otimes e$ 问题的线性 Jahn–Teller (JT) 哈密顿量。您的哈密顿量应包括原子核动能 $T_{\\mathrm{nuc}}$、谐振势 $\\frac{1}{2}K(Q_{1}^{2}+Q_{2}^{2})$ 以及最低阶的振动耦合项。在电子 $E$ 子空间中，用两个 Pauli 矩阵 $\\hat{\\tau}_{x}$ 和 $\\hat{\\tau}_{z}$ 来表示线性无关的算符。\n- 在 BO 近似下，对于固定的原子核坐标 $(Q_{1},Q_{2})$，对角化哈密顿量的电子部分，以获得作为 $(Q_{1},Q_{2})$ 函数的绝热电子能量，并用极坐标 $Q=\\sqrt{Q_{1}^{2}+Q_{2}^{2}}$ 和 $\\phi=\\arctan(Q_{2}/Q_{1})$ 写出两个 BO 势能面 (PES)。\n- 明确证明较低的 BO 势能面由于振动耦合而在非零畸变幅度处具有一个对称性破缺的极小值，并用振动耦合常数 $F$ 和力常数 $K$ 表示平衡畸变幅度 $Q_{0}$。\n- 基于您导出的势能面，简要解释为什么该极小值在原子核构型空间中是导致对称性破缺的。\n\n报告平衡畸变幅度 $Q_{0}$ 作为您的最终答案。不包括单位。不需要进行数值计算。", "solution": "问题陈述具有科学依据，提法得当且客观。它描述了 Jahn-Teller 效应的一个典型例子，这是凝聚态物理和化学中一个公认的原理。其前提是一致的，并为推导所要求的量提供了足够的信息。因此，该问题被认为是有效的。\n\n系统的总哈密顿量 $\\hat{H}$ 可以写成原子核动能 $T_{\\mathrm{nuc}}$ 和势能之和，该势能是原子核坐标 $\\mathbf{Q} = (Q_1, Q_2)$ 和电子自由度的函数。在 Born-Oppenheimer (BO) 近似中，我们首先求解固定原子核时的电子问题。\n\n**第一部分：哈密顿量的构建**\n\n总哈密顿量由 $\\hat{H} = T_{\\mathrm{nuc}} + \\hat{H}_{\\mathrm{el}}(\\mathbf{Q})$ 给出，其中 $\\hat{H}_{\\mathrm{el}}(\\mathbf{Q})$ 是固定原子核构型 $\\mathbf{Q}$ 时的电子哈密顿量。$T_{\\mathrm{nuc}}$ 项是原子核的动能算符。电子哈密顿量在高对称性几何构型 $\\mathbf{Q}=\\mathbf{0}$ 附近展开。\n$$\n\\hat{H}_{\\mathrm{el}}(\\mathbf{Q}) = \\hat{H}_{\\mathrm{el}}(\\mathbf{0}) + \\sum_{i=1,2} \\left(\\frac{\\partial \\hat{H}_{\\mathrm{el}}}{\\partial Q_i}\\right)_{\\mathbf{Q}=\\mathbf{0}} Q_i + \\frac{1}{2} \\sum_{i,j=1,2} \\left(\\frac{\\partial^2 E_0}{\\partial Q_i \\partial Q_j}\\right)_{\\mathbf{Q}=\\mathbf{0}} Q_i Q_j + \\dots\n$$\n第一项 $\\hat{H}_{\\mathrm{el}}(\\mathbf{0})$ 是高对称性点上的电子哈密顿量。其基态是双重简并的，我们将其能量设为 $0$。第三项涉及基态能量的二阶导数，对应于原子核的谐振势，其形式为 $\\frac{1}{2}K(Q_1^2+Q_2^2)$。此项在电子子空间中是标量算符，因此它与单位矩阵 $\\hat{I}$ 成正比。\n\n第二项是线性振动耦合项 $\\hat{H}_{\\mathrm{vc}}$。为了使此项非零，算符 $\\left(\\frac{\\partial \\hat{H}_{\\mathrm{el}}}{\\partial Q_i}\\right)_{\\mathbf{Q}=\\mathbf{0}}$ 必须是全对称的。该算符按对称积 $[E \\otimes E]_{\\mathrm{sym}}$ 变换，而坐标 $(Q_1, Q_2)$ 按 $e$ 变换。耦合项是这些的乘积，为了使其非零（即包含全对称表示），直积 $[E \\otimes E]_{\\mathrm{sym}} \\otimes e$ 必须包含全对称表示。基于 Wigner-Eckart 定理的一个更直接的陈述是，矩阵元 $\\langle \\psi_E | \\hat{H}_{\\mathrm{vc}} | \\psi_E' \\rangle$ 非零的条件是 $E \\otimes e \\otimes E$ 包含全对称表示，这等价于 $E \\otimes E$ 包含 $e$。问题陈述中指出 $E \\otimes e$ 包含全对称表示，这意味着线性耦合是允许的。\n\n线性振动耦合哈密顿量 $\\hat{H}_{\\mathrm{vc}}$ 必须是 $Q_1$ 和 $Q_2$ 的线性组合，并且必须在简并的 $E$ 子空间中表示为一个 $2 \\times 2$ 矩阵。$2 \\times 2$ 厄米矩阵的基算符是单位矩阵 $\\hat{I}$ 和三个 Pauli 矩阵。问题指定使用 $\\hat{\\tau}_z$ 和 $\\hat{\\tau}_x$。在两个简并电子态的基中，我们可以写出：\n$$\n\\hat{\\tau}_z = \\begin{pmatrix} 1  0 \\\\ 0  -1 \\end{pmatrix}, \\quad \\hat{\\tau}_x = \\begin{pmatrix} 0  1 \\\\ 1  0 \\end{pmatrix}\n$$\n最一般的线性振动耦合哈密顿量形式为 $\\hat{H}_{\\mathrm{vc}} = F(Q_1\\hat{O}_1 + Q_2\\hat{O}_2)$，其中 $\\hat{O}_1$ 和 $\\hat{O}_2$ 是电子算符，$F$ 是耦合常数。根据对称性，算符和坐标必须以产生标量的方式耦合。$E \\otimes e$ 问题的标准形式是：\n$$\n\\hat{H}_{\\mathrm{vc}} = F(Q_1 \\hat{\\tau}_z + Q_2 \\hat{\\tau}_x)\n$$\n将所有项合并，完整的 Jahn-Teller 哈密顿量为：\n$$\n\\hat{H} = T_{\\mathrm{nuc}}\\hat{I} + \\frac{1}{2}K(Q_1^2+Q_2^2)\\hat{I} + F(Q_1\\hat{\\tau}_z + Q_2\\hat{\\tau}_x)\n$$\n这就是耦合振动系统的哈密顿量。\n\n**第二部分：Born-Oppenheimer 势能面**\n\n在 BO 近似下，我们将原子核坐标 $(Q_1, Q_2)$ 视为固定参数，并对角化哈密顿量的电子部分 $\\hat{H}_{\\mathrm{el}}(Q_1, Q_2)$。该矩阵的本征值即为 BO 势能面 (PES)。\n$$\n\\hat{H}_{\\mathrm{el}}(Q_1,Q_2) = \\frac{1}{2}K(Q_1^2+Q_2^2)\\hat{I} + F(Q_1\\hat{\\tau}_z + Q_2\\hat{\\tau}_x) = \\begin{pmatrix} \\frac{1}{2}K(Q_1^2+Q_2^2) + FQ_1  FQ_2 \\\\ FQ_2  \\frac{1}{2}K(Q_1^2+Q_2^2) - FQ_1 \\end{pmatrix}\n$$\n为了找到本征值 $E_{\\mathrm{el}}$，我们求解特征方程 $\\det(\\hat{H}_{\\mathrm{el}} - E_{\\mathrm{el}}\\hat{I}) = 0$。\n$$\n\\left( \\frac{1}{2}K(Q_1^2+Q_2^2) + FQ_1 - E_{\\mathrm{el}} \\right) \\left( \\frac{1}{2}K(Q_1^2+Q_2^2) - FQ_1 - E_{\\mathrm{el}} \\right) - (FQ_2)^2 = 0\n$$\n$$\n\\left( \\frac{1}{2}K(Q_1^2+Q_2^2) - E_{\\mathrm{el}} \\right)^2 - (FQ_1)^2 - (FQ_2)^2 = 0\n$$\n$$\n\\left( E_{\\mathrm{el}} - \\frac{1}{2}K(Q_1^2+Q_2^2) \\right)^2 = F^2(Q_1^2+Q_2^2)\n$$\n对两边取平方根可得：\n$$\nE_{\\mathrm{el}} - \\frac{1}{2}K(Q_1^2+Q_2^2) = \\pm \\sqrt{F^2(Q_1^2+Q_2^2)} = \\pm |F|\\sqrt{Q_1^2+Q_2^2}\n$$\n不失一般性，我们假设 $F > 0$，因为其符号可以被吸收到电子基的定义中。两个 BO 势能面为：\n$$\nE_{\\pm}(Q_1,Q_2) = \\frac{1}{2}K(Q_1^2+Q_2^2) \\pm F\\sqrt{Q_1^2+Q_2^2}\n$$\n在极坐标中，$Q = \\sqrt{Q_1^2+Q_2^2}$ 且 $\\phi = \\arctan(Q_2/Q_1)$，这些势能面变为：\n$$\nE_{\\pm}(Q, \\phi) = \\frac{1}{2}KQ^2 \\pm FQ\n$$\n这些势能面与角度 $\\phi$ 无关，这赋予了它们独特的“墨西哥帽”形状。上势能面是 $E_+(Q)$，下势能面是 $E_-(Q)$。\n\n**第三部分：平衡畸变幅度**\n\n为了找到一个稳定的平衡几何构型，我们必须找到势能面的极小值。上势能面 $E_+(Q)$ 的极小值在 $Q=0$ 处。下势能面 $E_-(Q) = \\frac{1}{2}KQ^2 - FQ$ 与系统的基态相关。我们通过对其关于 $Q$ 求导并令其为零来找到其极小值。\n$$\n\\frac{dE_-}{dQ} = \\frac{d}{dQ}\\left(\\frac{1}{2}KQ^2 - FQ\\right) = KQ - F\n$$\n将导数设为零：\n$$\nKQ - F = 0 \\implies Q = \\frac{F}{K}\n$$\n我们将这个平衡畸变幅度记为 $Q_0$。因此，$Q_0 = \\frac{F}{K}$。为确认这是一个极小值，我们检查二阶导数：\n$$\n\\frac{d^2E_-}{dQ^2} = K\n$$\n因为给定 $K0$，这确实是一个极小值。高对称性点 $Q=0$ 不再是基态势能面的极小值点。该极小值处的能量为 $E_-(Q_0) = \\frac{1}{2}K(F/K)^2 - F(F/K) = \\frac{F^2}{2K} - \\frac{F^2}{K} = -\\frac{F^2}{2K}$。这就是 Jahn-Teller 稳定化能。\n\n**第四部分：对称性破缺的解释**\n\n原始的、未畸变的系统，其原子核构型位于 $(Q_1, Q_2) = (0, 0)$，对应于 $Q=0$。该构型拥有配位点的完整点群对称性。在此点，两个势能面发生锥形交叉，$E_+(0) = E_-(0) = 0$，反映了电子简并性。\n我们的分析表明，基态势能面 $E_-(Q)$ 的极小值不在 $Q=0$ 处，而是在一个有限的畸变幅度 $Q_0 = F/K  0$ 处。这意味着系统可以通过偏离高对称性构型来降低其能量。\n所有极小值的集合由条件 $Q = \\sqrt{Q_1^2+Q_2^2} = Q_0$ 给出，这在 $(Q_1, Q_2)$ 原子核构型空间中定义了一个能量极小值的连续圆形槽。该圆上的任何特定点，例如 $(Q_0, 0)$ 或 $(0, Q_0)$，都对应一个特定的畸变几何构型。这样的畸变几何构型必然比 $(0, 0)$ 处的未畸变构型具有更低的对称性。例如，如果初始对称性是八面体 ($O_h$) 且振动模式的对称性为 $e_g$，则沿着 $(Q_1,Q_2)$ 空间中一个坐标轴的畸变对应于八面体的四方畸变，这将对称性降低到 $D_{4h}$。因为系统自发地采用这些较低对称性的构型之一来最小化其能量，所以我们说原子核骨架的对称性被破缺了。这是振动耦合的直接结果，正如 Jahn-Teller 定理所示。", "answer": "$$\n\\boxed{\\frac{F}{K}}\n$$", "id": "3493325"}, {"introduction": "玻恩-奥本海默近似的有效性取决于快速电子和慢速原子核之间时间尺度的分离。我们如何量化这种分离并预测该近似何时可能失效？本练习引入了一个定量的绝热度量 $ \\eta = \\omega_{\\max} / E_g $，它将最快的原子核振动频率与电子能隙进行比较。通过为一个一维固体实现一个紧束缚模型，您将以计算的方式研究压力（改变几何结构）和同位素替换（改变原子核质量）如何影响玻恩-奥本海默近似的可靠性，从而将抽象的理论条件与可测量的材料属性联系起来 [@problem_id:3493289]。", "problem": "考虑一个在玻恩-奥本海默近似下，处于压力下的一维双原子类氢原子链的紧束缚模型。原子核被视为设定电子哈密顿量的经典参数，而原子核动力学则被单独建模为谐振子以评估绝热性。使用原子单位，其中约化普朗克常数为 $1$（Hartree原子单位：能量单位为Hartree，长度单位为Bohr，质量单位为电子质量），因此角频率的单位是能量，且 $\\hbar = 1$。\n\n电子模型。假设一个双位点原胞，其晶格常数为 $a$，分子内键长为 $d$，其中 $a  d  0$。电子紧束缚耦合振幅随距离呈指数衰减：\n- 原胞内跃迁 $t_{\\mathrm{intra}}(a,d) = t_0 \\exp\\left(- d / \\alpha_t \\right)$，\n- 原胞间跃迁 $t_{\\mathrm{inter}}(a,d) = t_0 \\exp\\left( - (a - d) / \\alpha_t \\right)$，\n其中 $t_0  0$ 且 $\\alpha_t  0$。在位能设置为零。对于波矢 $k$，布洛赫哈密顿量是一个 $2 \\times 2$ 的厄米矩阵\n$$\nH(k) =\n\\begin{pmatrix}\n0  \\gamma(k) \\\\\n\\gamma(k)^{\\ast}  0\n\\end{pmatrix},\n$$\n其中\n$\n\\gamma(k) = t_{\\mathrm{intra}}(a,d) + t_{\\mathrm{inter}}(a,d) \\exp(-\\mathrm{i} \\, k \\, a).\n$\n两个电子能带是 $H(k)$ 的本征值，而波矢 $k$ 处的直接带隙是该 $k$ 点上、下本征值之差。基本电子带隙 $E_g$ 是在布里渊区 $k \\in \\left[-\\pi/a,\\pi/a\\right]$ 内的最小直接带隙。\n\n原子核模型与绝热性。通过谐波弹簧来模拟原子核振动，其弹簧常数随距离呈指数衰减：\n- 原胞内弹簧 $K_{\\mathrm{intra}}(a,d) = \\kappa_0 \\exp\\left( - d / \\alpha_K \\right)$，\n- 原胞间弹簧 $K_{\\mathrm{inter}}(a,d) = \\kappa_0 \\exp\\left( - (a - d) / \\alpha_K \\right)$，\n其中 $\\kappa_0  0$ 且 $\\alpha_K  0$。对于两个位点上质量均为 $M$ 的双原子单元，最高光学模式角频率可近似为\n$\n\\omega_{\\max}(a,d,M) = \\sqrt{ \\dfrac{K_{\\mathrm{intra}}(a,d) + K_{\\mathrm{inter}}(a,d)}{M} }.\n$\n定义玻恩-奥本海默绝热性度量\n$\n\\eta(a,d,M) = \\dfrac{\\omega_{\\max}(a,d,M)}{E_g(a,d)}.\n$\n当系统呈金属性，$E_g(a,d) = 0$，或者当 $\\eta(a,d,M) \\ge 1$ 时，预测玻恩-奥本海默近似会失效。\n\n任务。仅从上述定义以及紧束缚和谐波运动的一般形式出发，完成以下操作：\n- 在布里渊区 $k \\in \\left[-\\pi/a,\\pi/a\\right]$ 内一个足够精细的均匀 $k$ 值网格上，通过对角化构建 $H(k)$ 并计算两个电子能带，然后确定 $E_g(a,d)$ 为最小直接带隙。\n- 计算相同 $(a,d)$ 下的 $K_{\\mathrm{intra}}(a,d)$、$K_{\\mathrm{inter}}(a,d)$ 和 $\\omega_{\\max}(a,d,M)$。\n- 计算绝热性度量 $\\eta(a,d,M)$，并在 $E_g(a,d) = 0$ 或 $\\eta(a,d,M) \\ge 1$ 时将玻恩-奥本海默近似分类为不可靠，否则分类为可靠。\n\n单位。统一使用Hartree原子单位。所有能量必须以Hartree为单位，所有长度以Bohr为单位，质量以电子质量为单位，所有角度以弧度为单位。\n\n测试组。使用以下四组参数集来检验不同情况。在每种情况下，假设 $t_0 = 0.5$、$\\alpha_t = 1.0$、$\\kappa_0 = 5.0$ 和 $\\alpha_K = 1.0$：\n- 情况1（大带隙，重原子核）：$a = 5.0$, $d = 1.4$, $M = 1836.0$。\n- 情况2（几何金属性点）：$a = 2.8$, $d = 1.4$, $M = 1836.0$。\n- 情况3（大带隙，极轻原子核）：$a = 5.0$, $d = 1.4$, $M = 10.0$。\n- 情况4（中等压力，较重原子核）：$a = 3.2$, $d = 1.4$, $M = 3672.0$。\n\n答案规格。对于每个测试用例，计算一个布尔值，以指示根据上述标准玻恩-奥本海默近似是否不可靠。最终程序输出必须是单行，其中包含四个布尔结果，按顺序以逗号分隔的列表形式括在方括号中。例如，输出格式必须严格为 $[\\mathrm{result1},\\mathrm{result2},\\mathrm{result3},\\mathrm{result4}]$，其中每个 $\\mathrm{resulti} \\in \\{\\mathrm{True}, \\mathrm{False}\\}$，且无附加文本。", "solution": "该问题是有效的，因为它在凝聚态物理学方面有科学依据，数学上是适定的，并且所有参数和条件都已明确定义。我们开始进行求解。\n\n主要目标是确定一维双原子链的玻恩-奥本海默近似的可靠性。这通过绝热性度量 $\\eta$ 来评估，该度量比较了原子核运动的特征能标 $\\omega_{\\max}$ 与基本电子带隙 $E_g$。如果系统是金属性的（$E_g=0$）或 $\\eta \\ge 1$，则预测近似会失效。\n\n### I. 电子能带结构与基本带隙 ($E_g$)\n\n电子特性由给定波矢 $k$ 的 $2 \\times 2$ 布洛赫哈密顿量描述：\n$$\nH(k) =\n\\begin{pmatrix}\n0  \\gamma(k) \\\\\n\\gamma(k)^{\\ast}  0\n\\end{pmatrix}\n$$\n其中 $\\gamma(k) = t_{\\mathrm{intra}} + t_{\\mathrm{inter}} \\exp(-\\mathrm{i} k a)$。电子能带 $\\epsilon(k)$ 是 $H(k)$ 的本征值。我们求解特征方程 $\\det(H(k) - \\epsilon I) = 0$：\n$$\n\\det \\begin{pmatrix} -\\epsilon  \\gamma(k) \\\\ \\gamma(k)^{\\ast}  -\\epsilon \\end{pmatrix} = \\epsilon^2 - \\gamma(k)\\gamma(k)^{\\ast} = \\epsilon^2 - |\\gamma(k)|^2 = 0\n$$\n这得出了两个能带：$\\epsilon_{\\pm}(k) = \\pm|\\gamma(k)|$。\n\n波矢 $k$ 处的直接带隙是上能带和下能带之间的能量差：\n$$\n\\Delta_k = \\epsilon_{+}(k) - \\epsilon_{-}(k) = 2|\\gamma(k)|\n$$\n基本电子带隙 $E_g$ 是该直接带隙在第一布里渊区 $k \\in [-\\pi/a, \\pi/a]$ 上的最小值。为了找到这个最小值，我们首先分析 $|\\gamma(k)|$：\n$$\n\\begin{align*} |\\gamma(k)|^2 = \\left( t_{\\mathrm{intra}} + t_{\\mathrm{inter}} e^{-\\mathrm{i}ka} \\right) \\left( t_{\\mathrm{intra}} + t_{\\mathrm{inter}} e^{\\mathrm{i}ka} \\right) \\\\ = t_{\\mathrm{intra}}^2 + t_{\\mathrm{inter}}^2 + t_{\\mathrm{intra}}t_{\\mathrm{inter}}(e^{\\mathrm{i}ka} + e^{-\\mathrm{i}ka}) \\\\ = t_{\\mathrm{intra}}^2 + t_{\\mathrm{inter}}^2 + 2 t_{\\mathrm{intra}}t_{\\mathrm{inter}}\\cos(ka) \\end{align*}\n$$\n由于跃迁参数 $t_{\\mathrm{intra}}$ 和 $t_{\\mathrm{inter}}$ 被定义为正值（$t_0 > 0$），$|\\gamma(k)|^2$ 项在 $\\cos(ka)$ 取其最小值 $-1$ 时达到最小。这发生在布里渊区的边界，即 $k = \\pm \\pi/a$。在这些点上，$|\\gamma(k)|^2$ 的最小值为：\n$$\n\\min_k |\\gamma(k)|^2 = t_{\\mathrm{intra}}^2 + t_{\\mathrm{inter}}^2 - 2 t_{\\mathrm{intra}}t_{\\mathrm{inter}} = (t_{\\mathrm{intra}} - t_{\\mathrm{inter}})^2\n$$\n取平方根，我们发现 $|\\gamma(k)|$ 的最小值为 $|t_{\\mathrm{intra}} - t_{\\mathrm{inter}}|$。\n因此，基本电子带隙 $E_g$ 由以下精确解析表达式给出：\n$$\nE_g(a,d) = 2 \\min_k |\\gamma(k)| = 2 |t_{\\mathrm{intra}}(a,d) - t_{\\mathrm{inter}}(a,d)|\n$$\n其中 $t_{\\mathrm{intra}}(a,d) = t_0 \\exp(-d/\\alpha_t)$ 且 $t_{\\mathrm{inter}}(a,d) = t_0 \\exp(-(a-d)/\\alpha_t)$。\n\n如果 $E_g=0$，系统就是金属性的，这在 $t_{\\mathrm{intra}} = t_{\\mathrm{inter}}$ 时发生。此条件意味着 $-d/\\alpha_t = -(a-d)/\\alpha_t$，可简化为 $a=2d$。\n\n### II. 原子核振动与绝热性度量 ($\\eta$)\n\n原子核动力学由谐振子建模。最高光学模式角频率 $\\omega_{\\max}$ 由下式给出：\n$$\n\\omega_{\\max}(a,d,M) = \\sqrt{ \\frac{K_{\\mathrm{intra}}(a,d) + K_{\\mathrm{inter}}(a,d)}{M} }\n$$\n其中 $K_{\\mathrm{intra}}(a,d) = \\kappa_0 \\exp(-d/\\alpha_K)$ 和 $K_{\\mathrm{inter}}(a,d) = \\kappa_0 \\exp(-(a-d)/\\alpha_K)$ 是弹簧常数，$M$ 是原子核质量。\n\n系统的绝热性由度量 $\\eta$ 来量化，即特征核频率与电子能隙之比：\n$$\n\\eta(a,d,M) = \\frac{\\omega_{\\max}(a,d,M)}{E_g(a,d)}\n$$\n\n### III. 算法步骤\n\n对于每组参数 $(a, d, M)$，我们通过以下步骤确定玻恩-奥本海默近似的可靠性：\n\n1.  **定义常数**：使用给定的值 $t_0 = 0.5$、$\\alpha_t = 1.0$、$\\kappa_0 = 5.0$ 和 $\\alpha_K = 1.0$。\n\n2.  **计算跃迁参数**：对于给定的 $(a, d)$，计算 $t_{\\mathrm{intra}} = t_0 \\exp(-d/\\alpha_t)$ 和 $t_{\\mathrm{inter}} = t_0 \\exp(-(a-d)/\\alpha_t)$。\n\n3.  **计算基本带隙 $E_g$**：计算 $E_g = 2 |t_{\\mathrm{intra}} - t_{\\mathrm{inter}}|$。\n\n4.  **评估金属性**：检查 $E_g$ 是否在数值上为零（例如，$E_g  10^{-12}$）。如果是，则系统是金属性的，近似被视为**不可靠**。\n\n5.  **计算原子核频率 $\\omega_{\\max}$**：如果系统不是金属性的，则计算弹簧常数 $K_{\\mathrm{intra}} = \\kappa_0 \\exp(-d/\\alpha_K)$ 和 $K_{\\mathrm{inter}} = \\kappa_0 \\exp(-(a-d)/\\alpha_K)$。然后，计算 $\\omega_{\\max} = \\sqrt{(K_{\\mathrm{intra}} + K_{\\mathrm{inter}})/M}$。\n\n6.  **计算绝热性度量 $\\eta$**：计算 $\\eta = \\omega_{\\max} / E_g$。\n\n7.  **评估绝热性**：检查是否满足 $\\eta \\ge 1$。如果满足此条件，则近似是**不可靠的**。\n\n8.  **最终判定**：如果两个不可靠条件（金属性或 $\\eta \\ge 1$）均未满足，则认为该近似是**可靠的**。\n\n此过程将针对所提供的四个测试用例中的每一个实施。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem for the given test suite, determining the reliability\n    of the Born-Oppenheimer approximation for each case.\n    \"\"\"\n\n    # Define physical constants for the model from the problem statement.\n    # All units are Hartree atomic units.\n    t0 = 0.5      # Hopping amplitude scale (Hartree)\n    alpha_t = 1.0 # Hopping decay length (Bohr)\n    kappa0 = 5.0  # Spring constant scale (Hartree/Bohr^2)\n    alpha_K = 1.0 # Spring constant decay length (Bohr)\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (a, d, M)\n    # a: lattice constant (Bohr)\n    # d: intramolecular bond length (Bohr)\n    # M: nuclear mass (electron masses)\n    test_cases = [\n        (5.0, 1.4, 1836.0), # Case 1: large gap, heavy nuclei\n        (2.8, 1.4, 1836.0), # Case 2: geometric metallic point\n        (5.0, 1.4, 10.0),   # Case 3: large gap, very light nuclei\n        (3.2, 1.4, 3672.0), # Case 4: moderate pressure, heavier nuclei\n    ]\n\n    results = []\n    # A small tolerance for floating point comparisons to zero.\n    ZERO_TOLERANCE = 1e-12\n\n    for a, d, M in test_cases:\n        # Step 1: Calculate tight-binding hopping parameters.\n        t_intra = t0 * np.exp(-d / alpha_t)\n        t_inter = t0 * np.exp(-(a - d) / alpha_t)\n\n        # Step 2: Calculate the fundamental electronic gap Eg.\n        # This is derived analytically as 2 * |t_intra - t_inter|.\n        E_g = 2.0 * np.abs(t_intra - t_inter)\n\n        # Step 3: Check for breakdown criterion 1: Metallicity (Eg = 0).\n        if E_g  ZERO_TOLERANCE:\n            unreliable = True\n            results.append(unreliable)\n            continue\n\n        # Step 4: Calculate parameters for the nuclear model.\n        K_intra = kappa0 * np.exp(-d / alpha_K)\n        K_inter = kappa0 * np.exp(-(a - d) / alpha_K)\n\n        # Step 5: Calculate the highest optical-mode angular frequency.\n        omega_max = np.sqrt((K_intra + K_inter) / M)\n\n        # Step 6: Calculate the adiabaticity metric eta.\n        eta = omega_max / E_g\n\n        # Step 7: Check for breakdown criterion 2: eta >= 1.\n        if eta >= 1.0:\n            unreliable = True\n        else:\n            unreliable = False\n        \n        results.append(unreliable)\n\n    # Final print statement in the exact required format.\n    # The map(str, ...) converts boolean True/False to \"True\"/\"False\" string capitalized.\n    print(f\"[{','.join(str(r).capitalize() for r in results)}]\")\n\nsolve()\n```", "id": "3493289"}, {"introduction": "虽然静态判据很有用，但对玻恩-奥本海默近似的真正考验是在动态的化学过程中。我们如何在分子动力学模拟过程中实时监控其有效性？这项高级练习要求您沿着一条经典轨迹计算非绝热耦合矢量 $d_{ij}(R)$，这些正是玻恩-奥本海默近似中所忽略的项。通过运行分子动力学模拟并分析非绝热耦合，您将直接观察到玻恩-奥本海默近似在何时何地最为脆弱，并将这一动态图像与著名的兰道-齐纳（Landau-Zener）模型联系起来，以估算电子态之间的跃迁概率 [@problem_id:3452111]。", "problem": "考虑一个 Born–Oppenheimer 框架下线性三原子体系的一维有效模型。核构型由一个单一的质量加权反应坐标 $R$ 表示，该坐标近似于一种对称匹配的伸缩模式。电子哈密顿量 $\\hat{H}_e(R)$ 作用于一个由固定的正交归一非绝热基态张成的二维非绝热电子子空间。绝热电子态 $\\{ \\lvert \\phi_i(R) \\rangle \\}$ 和绝热能量 $\\{ E_i(R) \\}$ 定义为 $\\hat{H}_e(R)$ 在每个 $R$ 处的归一化本征向量和本征值。绝热态 $i$ 和 $j$ 之间的非绝热耦合矢量根据 Born–Oppenheimer 分离定义为 $d_{ij}(R) = \\langle \\phi_i(R) \\lvert \\nabla_R \\rvert \\phi_j(R) \\rangle$。在一维模型中，$\\nabla_R$ 简化为 $\\frac{d}{dR}$，因此 $d_{ij}(R)$ 是 $R$ 的一个标量函数。当 $\\lvert d_{ij}(R) \\rvert$ 在经典分子动力学轨迹经过的区域变得很大时，这种非绝热耦合决定了 Born–Oppenheimer 近似的失效。\n\n您将在非绝热表象下使用以下特定模型：\n- 非绝热哈密顿量为\n$$\n\\hat{H}_e(R) = \n\\begin{pmatrix}\n\\varepsilon_1(R)  V(R) \\\\\nV(R)  \\varepsilon_2(R)\n\\end{pmatrix},\n$$\n其中非绝热能量是线性的，并且关于交叉点 $R_c$ 是反对称的，\n$$\n\\varepsilon_1(R) = \\alpha \\, (R - R_c), \\quad \\varepsilon_2(R) = -\\alpha \\, (R - R_c),\n$$\n非绝热耦合是一个局域高斯函数，\n$$\nV(R) = V_0 \\, \\exp\\left( - \\frac{(R - R_c)^2}{2 \\sigma^2} \\right).\n$$\n- 系统在下绝热势能面 $E_-(R)$ 上进行经典传播，使用牛顿第二定律，其中标量核质量为 $\\mu$，位置为 $R(t)$，速度为 $v(t) = \\dot{R}(t)$。力为 $F(R) = - \\frac{d E_-(R)}{dR}$。\n\n所有物理量必须以原子单位表示：能量单位为 Hartree，长度单位为 Bohr，时间单位为原子时间单位，质量单位为电子质量原子单位，约化普朗克常数 ($\\hbar$) 等于 $1$。\n\n您的任务是：\n1) 从不含时电子薛定谔方程 $\\hat{H}_e(R) \\lvert \\phi_j(R) \\rangle = E_j(R) \\lvert \\phi_j(R) \\rangle$ 和非绝热耦合的定义出发，推导出一个用 $\\frac{d \\hat{H}_e}{dR}$、$E_i(R)$、$E_j(R)$ 以及绝热本征向量 $\\lvert \\phi_i(R) \\rangle$ 表示的 $d_{ij}(R)$（其中 $i \\neq j$）的可计算表达式。对于上述模型哈密顿量，实现该表达式以在任意 $R$ 处计算 $d_{12}(R)$。\n2) 在 $E_-(R)$ 上实现经典分子动力学，使用一个二阶精度辛积分器，根据给定的初始条件 $(R_0, v_0)$、质量 $\\mu$、总时间 $T$ 和时间步长 $\\Delta t$ 来计算轨迹 $R(t)$ 和 $v(t)$。在每个积分步骤中，对力 $F(R)$ 使用一个数值稳定且收敛的近似。\n3) 沿着计算出的轨迹，在每个经过的 $R$ 处计算 $\\lvert d_{12}(R) \\rvert$ 并确定：\n   - 最大值 $\\max_t \\lvert d_{12}(R(t)) \\rvert$。\n   - 出现该最大值的位置 $R^\\star$，选择为达到最大值的时间步长处的 $R$ 值。\n   - 沿轨迹的 Born–Oppenheimer 近似失效的布尔指示符，定义为：如果 $\\max_t \\lvert d_{12}(R(t)) \\rvert  \\tau$，则 $\\mathrm{breaks} = \\text{True}$，否则为 $\\text{False}$，阈值 $\\tau = 1.0$，单位为 $\\text{Bohr}^{-1}$。\n4) 使用 Landau–Zener 模型处理线性非绝热交叉，其中非绝热耦合在 $R_c$ 附近为常数，将计算出的轨迹与非绝热跃迁概率联系起来。假设在 $R_c$ 附近，非绝热能量差为 $\\Delta\\varepsilon(R) = \\varepsilon_1(R) - \\varepsilon_2(R) \\approx \\beta \\, (R - R_c)$，斜率为 $\\beta = 2 \\alpha$，并且非绝热耦合近似为常数，等于 $V_0$。设 $v_c$ 是轨迹上最接近 $R_c$ 的点处速度的大小。在这些假设下，计算绝热面之间的 Landau–Zener 非绝热跃迁概率，\n$$\nP_{\\mathrm{LZ}} = \\exp\\left( - \\frac{2 \\pi \\, V_0^2}{\\hbar \\, \\lvert \\beta \\, v_c \\rvert} \\right),\n$$\n其中原子单位下 $\\hbar = 1$。\n\n数值和实现要求：\n- 使用通过对角化 $\\hat{H}_e(R)$ 得到的绝热本征对 $\\{E_\\pm(R), \\lvert \\phi_\\pm(R) \\rangle\\}$ 来计算力和非绝热耦合。\n- 对于力 $F(R) = - \\frac{d E_-(R)}{dR}$，使用一个数值稳定的中心差分近似，当有限差分步长趋于零时该近似收敛。\n- 对于 $d_{12}(R)$，使用您在步骤 1) 中推导的表达式，并通过在当前 $R$ 处的 $\\frac{d \\hat{H}_e}{dR}$ 的矩阵元和绝热本征向量来精确计算它。\n- 绘制 Born–Oppenheimer 近似失效图：使用阈值 $\\tau = 1.0$，单位为 $\\text{Bohr}^{-1}$。\n- 不使用角度单位。任何分数都必须表示为小数。\n- 所有长度以 Bohr 表示，速度以 Bohr 每原子时间单位表示，导数耦合以 $\\text{Bohr}^{-1}$ 表示，概率以无量纲小数表示。\n\n测试套件：\n实现您的程序以运行以下三个测试用例，每个用例由参数元组 $(\\alpha, R_c, V_0, \\sigma, \\mu, R_0, v_0, T, \\Delta t)$ 定义，所有参数均采用上述指定单位：\n- 用例 A (正常路径): $(\\alpha, R_c, V_0, \\sigma, \\mu, R_0, v_0, T, \\Delta t) = (0.02, 3.0, 0.005, 0.5, 5000.0, 1.0, 0.05, 400.0, 0.2)$。\n- 用例 B (小耦合边缘情况): $(\\alpha, R_c, V_0, \\sigma, \\mu, R_0, v_0, T, \\Delta t) = (0.02, 3.0, 0.0005, 0.5, 5000.0, 0.0, 0.1, 300.0, 0.2)$。\n- 用例 C (慢速重质量、强耦合): $(\\alpha, R_c, V_0, \\sigma, \\mu, R_0, v_0, T, \\Delta t) = (0.02, 3.0, 0.02, 0.5, 20000.0, 1.0, 0.02, 500.0, 0.2)$。\n\n要求的输出：\n- 对每个用例，计算并返回列表 $[\\max \\lvert d_{12} \\rvert, R^\\star, P_{\\mathrm{LZ}}, \\mathrm{breaks}]$，其中 $\\max \\lvert d_{12} \\rvert$ 的单位为 $\\text{Bohr}^{-1}$，$R^\\star$ 的单位为 Bohr，$P_{\\mathrm{LZ}}$ 为无量纲，$\\mathrm{breaks}$ 为布尔值。\n- 您的程序应生成单行输出，包含三个测试用例的结果，形式为列表的列表，每个内部列表的格式为 $[\\text{6位小数的浮点数}, \\text{6位小数的浮点数}, \\text{6位小数的浮点数}, \\text{布尔值}]$，整个集合用方括号括起来，例如：$[[x_1,y_1,z_1,b_1],[x_2,y_2,z_2,b_2],[x_3,y_3,z_3,b_3]]$。不要打印单位符号；值必须采用上述指定的单位。", "solution": "该问题被评估为有效，因为它在科学上基于量子化学和分子动力学的原理，问题设定清晰，定义了所有必要的参数和条件，并且陈述客观。因此，我们可以着手解决。\n\n解决方案需要一个多步骤方法，涉及理论推导、经典动力学的数值实现以及非绝热效应的分析。每个任务都将按顺序处理。\n\n### 1. 非绝热耦合的推导与实现\n\n第一个任务是为一个一维系统推导非绝热耦合矢量 $d_{ij}(R)$（其中 $i \\neq j$）的可计算表达式。非绝热耦合定义为 $d_{ij}(R) = \\langle \\phi_i(R) \\lvert \\frac{d}{dR} \\rvert \\phi_j(R) \\rangle$，其中 $\\lvert \\phi_i(R) \\rangle$ 是绝热电子态。\n\n我们从态 $j$ 的不含时电子薛定谔方程开始：\n$$\n\\hat{H}_e(R) \\lvert \\phi_j(R) \\rangle = E_j(R) \\lvert \\phi_j(R) \\rangle\n$$\n我们将此方程对核坐标 $R$ 求导：\n$$\n\\frac{d}{dR} \\left( \\hat{H}_e(R) \\lvert \\phi_j(R) \\rangle \\right) = \\frac{d}{dR} \\left( E_j(R) \\lvert \\phi_j(R) \\rangle \\right)\n$$\n对两边应用乘积法则得到：\n$$\n\\left( \\frac{d\\hat{H}_e}{dR} \\right) \\lvert \\phi_j \\rangle + \\hat{H}_e \\left( \\frac{d}{dR} \\lvert \\phi_j \\rangle \\right) = \\left( \\frac{dE_j}{dR} \\right) \\lvert \\phi_j \\rangle + E_j \\left( \\frac{d}{dR} \\lvert \\phi_j \\rangle \\right)\n$$\n接下来，我们将此方程投影到另一个绝热态 $\\lvert \\phi_i \\rangle$ 上，方法是在左侧与 $\\langle \\phi_i \\rvert$ 作内积，其中 $i \\neq j$：\n$$\n\\langle \\phi_i \\rvert \\left( \\frac{d\\hat{H}_e}{dR} \\right) \\lvert \\phi_j \\rangle + \\langle \\phi_i \\rvert \\hat{H}_e \\left( \\frac{d}{dR} \\lvert \\phi_j \\rangle \\right) = \\left( \\frac{dE_j}{dR} \\right) \\langle \\phi_i \\rvert \\phi_j \\rangle + E_j \\langle \\phi_i \\rvert \\left( \\frac{d}{dR} \\lvert \\phi_j \\rangle \\right)\n$$\n我们使用绝热本征态的性质。由于它们是厄米算符 $\\hat{H}_e$ 的本征函数，我们有 $\\langle \\phi_i \\rvert \\hat{H}_e = E_i \\langle \\phi_i \\rvert$。此外，本征态是正交归一的，所以 $\\langle \\phi_i \\rvert \\phi_j \\rangle = \\delta_{ij}$。对于 $i \\neq j$，此项为零。将这些代入方程，简化为：\n$$\n\\langle \\phi_i \\rvert \\frac{d\\hat{H}_e}{dR} \\lvert \\phi_j \\rangle + E_i \\langle \\phi_i \\rvert \\frac{d}{dR} \\lvert \\phi_j \\rangle = (0) + E_j \\langle \\phi_i \\rvert \\frac{d}{dR} \\lvert \\phi_j \\rangle\n$$\n项 $\\langle \\phi_i \\rvert \\frac{d}{dR} \\lvert \\phi_j \\rangle$ 正是非绝热耦合 $d_{ij}(R)$。重新整理方程以求解 $d_{ij}(R)$：\n$$\n\\langle \\phi_i \\rvert \\frac{d\\hat{H}_e}{dR} \\lvert \\phi_j \\rangle = (E_j(R) - E_i(R)) \\langle \\phi_i \\rvert \\frac{d}{dR} \\lvert \\phi_j \\rangle\n$$\n$$\nd_{ij}(R) = \\frac{\\langle \\phi_i(R) \\rvert \\frac{d\\hat{H}_e}{dR} \\lvert \\phi_j(R) \\rangle}{E_j(R) - E_i(R)}, \\quad \\text{for } i \\neq j\n$$\n这就是非对角 Hellmann-Feynman 定理。为了将此公式用于给定模型，我们需要非绝热哈密顿量 $\\hat{H}_e(R)$ 的导数：\n$$\n\\hat{H}_e(R) = \n\\begin{pmatrix}\n\\alpha(R-R_c)  V_0 \\exp(-\\frac{(R-R_c)^2}{2\\sigma^2}) \\\\\nV_0 \\exp(-\\frac{(R-R_c)^2}{2\\sigma^2})  -\\alpha(R-R_c)\n\\end{pmatrix}\n$$\n关于 $R$ 的导数为：\n$$\n\\frac{d\\hat{H}_e}{dR} = \n\\begin{pmatrix}\n\\alpha  -\\frac{R-R_c}{\\sigma^2} V(R) \\\\\n-\\frac{R-R_c}{\\sigma^2} V(R)  -\\alpha\n\\end{pmatrix}\n$$\n在实现中，对于任何给定的 $R$，我们首先数值对角化 $\\hat{H}_e(R)$ 以获得绝热能量 $E_1(R)$（下势能面，$E_-$）和 $E_2(R)$（上势能面，$E_+$）及其对应的本征向量 $\\lvert \\phi_1(R) \\rangle$ 和 $\\lvert \\phi_2(R) \\rangle$。然后我们构建矩阵 $\\frac{d\\hat{H}_e}{dR}$ 并使用推导出的公式计算耦合 $d_{12}(R)$。\n\n### 2. 经典分子动力学\n核运动在下绝热势能面 $E_-(R)$（我们将其表示为 $E_1(R)$）上根据牛顿第二定律演化：\n$$\n\\mu \\ddot{R}(t) = F(R(t)) = -\\frac{dE_1(R(t))}{dR}\n$$\n我们使用 Velocity Verlet 算法（一种二阶精度且辛的积分器）来积分这个运动方程。给定状态 $(R(t), v(t))$，在时间 $t+\\Delta t$ 的状态计算如下：\n1.  $v(t + \\frac{\\Delta t}{2}) = v(t) + \\frac{F(R(t))}{2\\mu} \\Delta t$\n2.  $R(t + \\Delta t) = R(t) + v(t + \\frac{\\Delta t}{2}) \\Delta t$\n3.  在更新后的位置计算新力 $F(R(t + \\Delta t))$。\n4.  $v(t + \\Delta t) = v(t + \\frac{\\Delta t}{2}) + \\frac{F(R(t + \\Delta t))}{2\\mu} \\Delta t$\n\n力 $F(R) = -\\frac{dE_1(R)}{dR}$ 使用中心差分近似进行数值计算，以保证稳定性和准确性：\n$$\nF(R) \\approx -\\frac{E_1(R+\\delta R) - E_1(R-\\delta R)}{2\\delta R}\n$$\n其中 $\\delta R$ 是一个小的位移（例如，$10^{-6}$ Bohr）。计算 $E_1(R)$ 需要在指定坐标处对角化哈密顿量 $\\hat{H}_e(R)$。\n\n### 3. 非绝热性的轨迹分析\n在总时间 $T$ 内生成一条经典轨迹 $\\{R(t_k), v(t_k)\\}$。沿着这条轨迹，我们评估非绝热耦合的大小。在每个点 $R_k = R(t_k)$，我们使用第一部分的方法计算 $d_{12}(R_k)$。然后我们确定：\n-   $\\max_t \\lvert d_{12}(R(t)) \\rvert$: 在模拟过程中观察到的耦合的最大绝对值。\n-   $R^\\star$: 出现此最大耦合时的位置 $R(t)$。\n-   $\\mathrm{breaks}$: 一个布尔标志，如果 $\\max_t \\lvert d_{12}(R(t)) \\rvert  \\tau$（阈值 $\\tau=1.0\\,\\text{Bohr}^{-1}$），则设置为 $\\text{True}$，否则为 $\\text{False}$。\n\n### 4. Landau–Zener 跃迁概率\nLandau-Zener 公式提供了一个当系统通过 $R_c$ 附近的避免交叉区域时，非绝热跃迁（从下绝热势能面到上绝热势能面）概率的估计。该公式为：\n$$\nP_{\\mathrm{LZ}} = \\exp\\left( - \\frac{2 \\pi \\, V_0^2}{\\hbar \\, \\lvert \\beta \\, v_c \\rvert} \\right)\n$$\n在此表达式中：\n-   $V_0$ 是相互作用区域中心 $R_c$ 处的非绝热耦合。\n-   $\\beta = 2\\alpha$ 是在 $R_c$ 处线性非绝热势斜率差的大小。\n-   $v_c$ 是轨迹上最接近 $R_c$ 的点处的核速度大小。\n-   在原子单位中 $\\hbar=1$。\n\n为了计算 $P_{\\mathrm{LZ}}$，我们首先在生成的轨迹 $\\{R(t_k)\\}$ 中搜索，找到 $\\lvert R(t_k) - R_c \\rvert$ 最小的时间步。该时间步的速度 $v(t_k)$ 给了我们 $v_c = \\lvert v(t_k) \\rvert$。然后我们将参数代入公式。如果 $v_c$ 为零，系统在交叉点花费无限时间，确保绝热跃迁，因此 $P_{\\mathrm{LZ}}=0$。\n\n这四个部分被集成到一个程序中，以处理指定的测试用例并生成所需的输出。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the simulations for all test cases and print the results.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (alpha, Rc, V0, sigma, mu, R0, v0, T, dt)\n        (0.02, 3.0, 0.005, 0.5, 5000.0, 1.0, 0.05, 400.0, 0.2), # Case A\n        (0.02, 3.0, 0.0005, 0.5, 5000.0, 0.0, 0.1, 300.0, 0.2),  # Case B\n        (0.02, 3.0, 0.02, 0.5, 20000.0, 1.0, 0.02, 500.0, 0.2), # Case C\n    ]\n\n    results = []\n    for case_params in test_cases:\n        result = run_simulation(*case_params)\n        results.append(result)\n\n    # Format the final output string\n    output_parts = []\n    for res in results:\n        max_d12, R_star, P_LZ, breaks = res\n        part = f\"[{max_d12:.6f},{R_star:.6f},{P_LZ:.6f},{str(breaks).capitalize()}]\"\n        output_parts.append(part)\n    \n    print(f\"[{','.join(output_parts)}]\")\n\ndef run_simulation(alpha, Rc, V0, sigma, mu, R0, v0, T, dt):\n    \"\"\"\n    Executes a single molecular dynamics simulation and analysis for a given set of parameters.\n    \"\"\"\n    \n    FD_STEP = 1e-6\n    BO_BREAKDOWN_THRESHOLD = 1.0\n\n    # --- Helper functions for the physical model ---\n    \n    def get_hamiltonian(R):\n        e1 = alpha * (R - Rc)\n        e2 = -alpha * (R - Rc)\n        V = V0 * np.exp(-(R - Rc)**2 / (2 * sigma**2))\n        return np.array([[e1, V], [V, e2]])\n\n    def get_hamiltonian_derivative(R):\n        V = V0 * np.exp(-(R - Rc)**2 / (2 * sigma**2))\n        dV_dR = -(R - Rc) / sigma**2 * V\n        return np.array([[alpha, dV_dR], [dV_dR, -alpha]])\n\n    def get_lower_adiabatic_energy(R):\n        H = get_hamiltonian(R)\n        evals, _ = np.linalg.eigh(H)\n        return evals[0]\n\n    def get_force(R):\n        E_plus = get_lower_adiabatic_energy(R + FD_STEP)\n        E_minus = get_lower_adiabatic_energy(R - FD_STEP)\n        force = -(E_plus - E_minus) / (2 * FD_STEP)\n        return force\n\n    def compute_d12(R):\n        H = get_hamiltonian(R)\n        evals, evecs = np.linalg.eigh(H)\n        \n        E1, E2 = evals[0], evals[1]\n        phi1, phi2 = evecs[:, 0], evecs[:, 1]\n        \n        energy_diff = E2 - E1\n        if np.isclose(energy_diff, 0):\n            return np.inf\n\n        dH_dR = get_hamiltonian_derivative(R)\n        \n        numerator = phi1.conj().T @ dH_dR @ phi2\n        return numerator / energy_diff\n\n    # --- Simulation setup ---\n    R, v = R0, v0\n    num_steps = int(T / dt)\n    \n    trajectory_R = np.zeros(num_steps + 1)\n    trajectory_v = np.zeros(num_steps + 1)\n    trajectory_d12 = np.zeros(num_steps + 1)\n    \n    trajectory_R[0] = R\n    trajectory_v[0] = v\n    trajectory_d12[0] = np.abs(compute_d12(R))\n\n    # --- Velocity Verlet MD Loop ---\n    force = get_force(R)\n    for i in range(num_steps):\n        v_half = v + 0.5 * force / mu * dt\n        R = R + v_half * dt\n        force = get_force(R)\n        v = v_half + 0.5 * force / mu * dt\n        \n        trajectory_R[i+1] = R\n        trajectory_v[i+1] = v\n        trajectory_d12[i+1] = np.abs(compute_d12(R))\n\n    # --- Post-simulation analysis ---\n    \n    # 1. Max nonadiabatic coupling\n    max_d12 = np.max(trajectory_d12)\n    max_d12_idx = np.argmax(trajectory_d12)\n    R_star = trajectory_R[max_d12_idx]\n    \n    # 2. BO breakdown check\n    bo_breaks = max_d12 > BO_BREAKDOWN_THRESHOLD\n    \n    # 3. Landau-Zener Probability\n    closest_idx = np.argmin(np.abs(trajectory_R - Rc))\n    vc = np.abs(trajectory_v[closest_idx])\n    \n    beta = 2 * alpha\n    if np.isclose(vc, 0) or np.isclose(beta, 0):\n        P_LZ = 0.0\n    else:\n        # hbar = 1 in atomic units\n        exponent = - (2 * np.pi * V0**2) / np.abs(beta * vc)\n        P_LZ = np.exp(exponent)\n            \n    return [max_d12, R_star, P_LZ, bo_breaks]\n\nsolve()\n```", "id": "3452111"}]}