{"hands_on_practices": [{"introduction": "能量原理是一个变分原理，这意味着我们需要在一组允许的位移中寻找使 $\\delta W$ 最小化的位移。这个实践将引导你从理想磁流体力学（MHD）的基本方程出发，推导出一个位移场 $\\boldsymbol{\\xi}$ 必须满足的物理约束，特别是磁冻结条件和在导电壁上的边界条件。通过解决这个问题[@problem_id:3721115]，你将深刻理解为何必须施加这些约束，并看到忽略它们会如何导致错误的稳定性结论。", "problem": "考虑一个静态、均匀的平衡等离子体，被限制在沿 $x$ 方向厚度为 $a$ 的平板中，在 $y$ 和 $z$ 方向上具有大的周期性。平衡磁场为 $\\mathbf{B} = B_{0}\\,\\hat{\\mathbf{z}}$，质量密度为 $\\rho$（常数），平衡压力为 $p$（常数）。等离子体在 $x=0$ 和 $x=a$ 处被理想导电的刚性壁所限制。\n\n从麦克斯韦方程组的感应方程和磁流体力学（MHD）的理想欧姆定律出发，建立任何容许的线性拉格朗日位移场 $\\boldsymbol{\\xi}(\\mathbf{r})$ 必须满足的约束条件，以不违反理想磁流体力学的磁冻结条件。特别地，推导磁扰动 $\\delta \\mathbf{B}$ 与 $\\boldsymbol{\\xi}$ 之间的关系，并确定在理想导电固定壁上的边界约束。\n\n然后，将注意力限制在一类形式为 $\\boldsymbol{\\xi}(\\mathbf{r}) = \\hat{\\mathbf{x}}\\,f(x)$ 且与 $y$ 和 $z$ 无关的试探位移上，并利用理想磁流体力学能量原理，写出适用于此均匀平衡的二阶势能变化泛函 $\\delta W$。施加您推导出的具有物理依据的约束，以排除那些会违反磁通量冻结守恒或壁条件的非物理试探位移。\n\n在这些约束条件下，对函数 $f(x)$ 在归一化条件\n$$\nI \\equiv \\int_{0}^{a} \\rho\\,|f(x)|^{2}\\,dx\n$$\n（定义为在 $y$–$z$ 平面中的单位面积上的值）下最小化 $\\delta W$。计算这类位移的归一化势能变化的约束最小值 $\\delta W_{\\min}/I$。作为对约束影响的检验，简要说明如果允许 $f(x)$ 为常数并将 $\\delta \\mathbf{B}$ 视为独立于 $\\boldsymbol{\\xi}$，无约束最小化会错误地预测出什么结果。\n\n以 $\\mathrm{s}^{-2}$ 为单位表示您最终的归一化最小值 $\\delta W_{\\min}/I$。无需四舍五入。除了给定的符号 $B_{0}$、$\\mu_{0}$、$\\gamma$、$p$、$\\rho$ 和 $a$ 之外，不要包含任何额外的数值数据。", "solution": "根据理想磁流体力学（MHD）理论，线性化的磁场扰动 $\\delta\\mathbf{B}$ 与拉格朗日位移场 $\\boldsymbol{\\xi}$ 的关系由磁通量冻结条件给出：$\\delta\\mathbf{B} = \\nabla \\times (\\boldsymbol{\\xi} \\times \\mathbf{B}_0)$。对于本问题中的位移 $\\boldsymbol{\\xi} = f(x)\\hat{\\mathbf{x}}$ 和平衡磁场 $\\mathbf{B}_0 = B_0\\hat{\\mathbf{z}}$，我们得到 $\\delta\\mathbf{B} = \\nabla \\times (f(x)B_0 (\\hat{\\mathbf{x}}\\times\\hat{\\mathbf{z}})) = \\nabla \\times (-f(x)B_0\\hat{\\mathbf{y}}) = -B_0 \\frac{df}{dx}\\hat{\\mathbf{z}}$。\n\n在理想导电的刚性壁上，等离子体的法向位移必须为零。因此，在 $x=0$ 和 $x=a$ 处，我们有 $\\boldsymbol{\\xi} \\cdot \\hat{\\mathbf{x}} = 0$，即 $f(0)=0$ 和 $f(a)=0$。\n\n对于均匀的平衡等离子体（$p$ 和 $\\rho$ 是常数），势能变化 $\\delta W$ 的表达式为 $\\delta W = \\frac{1}{2} \\int \\left( \\frac{|\\delta\\mathbf{B}|^2}{\\mu_0} + \\gamma p (\\nabla \\cdot \\boldsymbol{\\xi})^2 \\right) dV$。\n\n对于给定的位移，$\\nabla \\cdot \\boldsymbol{\\xi} = \\frac{df}{dx}$。代入所有量，并考虑在 $y-z$ 平面上的单位面积，积分体积元 $dV$ 变为 $dx$：\n$$ \\delta W[f] = \\frac{1}{2} \\int_0^a \\left( \\frac{(-B_0 f')^2}{\\mu_0} + \\gamma p (f')^2 \\right) dx = \\frac{1}{2} \\left( \\gamma p + \\frac{B_0^2}{\\mu_0} \\right) \\int_0^a (f'(x))^2 dx $$\n我们需要在归一化条件 $I = \\int_0^a \\rho |f(x)|^2 dx$ 和边界条件 $f(0)=f(a)=0$ 下最小化 $\\delta W/I$。这等价于最小化瑞利商 $R[f] = \\frac{\\int_0^a (f')^2 dx}{\\int_0^a f^2 dx}$。这是一个经典的变分问题，其最小值对应于微分方程 $-f'' = \\lambda f$ 在给定边界条件下的最小特征值。最小特征值解是 $f(x) = \\sin(\\frac{\\pi x}{a})$，对应的最小特征值为 $\\lambda_{\\min} = (\\frac{\\pi}{a})^2$。\n\n因此，归一化的最小势能变化为：\n$$ \\frac{\\delta W_{\\min}}{I} = \\frac{1}{2\\rho} \\left( \\gamma p + \\frac{B_0^2}{\\mu_0} \\right) \\min\\left(\\frac{\\int_0^a (f')^2 dx}{\\int_0^a f^2 dx}\\right) = \\frac{1}{2\\rho} \\left( \\gamma p + \\frac{B_0^2}{\\mu_0} \\right) \\left(\\frac{\\pi}{a}\\right)^2 = \\frac{\\pi^2}{2a^2\\rho} \\left( \\gamma p + \\frac{B_0^2}{\\mu_0} \\right) $$\n如果忽略约束（特别是边界条件），并允许 $f(x)$ 为常数，则 $f'(x)=0$，这将错误地导致 $\\delta W=0$，预测系统总是临界稳定，这显然是非物理的。", "answer": "$$\n\\boxed{\\frac{\\pi^{2}}{2 a^{2} \\rho} \\left( \\gamma p + \\frac{B_{0}^{2}}{\\mu_{0}} \\right)}\n$$", "id": "3721115"}, {"introduction": "$m=1$ 外部扭曲模是等离子体柱中一种典型且具有潜在破坏性的宏观不稳定性。这个练习[@problem_id:3721145]将带你深入分析该模式的一个关键方面：计算真空区域的磁场扰动对总能量变化 $\\delta W$ 的贡献。通过这个从第一性原理出发的计算，你将亲身体验到理想MHD边界条件的应用，并定量地理解导电壁在稳定等离子体中的关键作用。", "problem": "考虑一个半径为 $a$ 的无限长、直的圆柱形等离子体，它被置于真空中。该等离子体带有一个均匀的轴向电流密度，产生一个角向平衡磁场 $B_{\\theta 0}(r)$。在等离子体内部，该磁场随 $r$ 线性变化；在真空中，该磁场按 $1/r$ 衰减：对于 $0 \\le r \\le a$，有 $B_{\\theta 0}(r) = B_{a}\\, r/a$；对于 $r \\ge a$，有 $B_{\\theta 0}(r) = B_{a}\\, a/r$，其中 $B_{a} \\equiv B_{\\theta 0}(a)$。在半径为 $b  a$ 处，有一个理想导电的圆柱形壁。\n\n在理想磁流体动力学（MHD）的框架内，使用麦克斯韦方程组的静磁形式和理想磁通冻结约束，确定与一个 $m=1$ 扭曲位移相关的真空磁场扰动，该位移刚性地移动了等离子体边界。具体来说，考虑一个没有轴向变化（即轴向波数 $k=0$）的单螺旋度扰动，其等离子体边界位移为 $\\xi_{r}(a,\\theta) = \\xi_{0}\\cos\\theta$，其中 $\\xi_{0}$ 是一个常实数振幅。假设真空磁场扰动可以用一个二维标量磁通函数 $\\psi(r,\\theta)$ 来表示，该函数在真空区域 $a  r  b$ 内满足拉普拉斯方程，并施加由 $r=a$ 处的磁通冻结和 $r=b$ 处的理想导电性得出的物理上适当的边界条件。\n\n从基本定律（麦克斯韦方程组和理想MHD约束）出发，不引用任何预先推导的稳定性公式，计算真空磁场能量对该 $m=1$ 扭曲的势能变化 $\\delta W$ 的贡献，结果表示为单位轴向长度的值。给出单位轴向长度的真空贡献 $\\delta W_{\\text{vac}}$ 的最终表达式，用 $a$、$b$、$B_{a}$、$\\mu_{0}$ 和 $\\xi_{0}$ 表示，其中 $\\mu_{0}$ 是真空磁导率。然后简要描述该贡献如何依赖于导电壁半径 $b$。\n\n将单位轴向长度的 $\\delta W_{\\text{vac}}$ 的最终答案以焦耳/米为单位表示。不需要进行数值计算。", "solution": "用户希望计算对于圆柱形等离子体的 $m=1, k=0$ 扭曲位移，真空磁场能量对势能变化 $\\delta W_{\\text{vac}}$ 的贡献。\n\n### 步骤 1：提取已知条件\n-   等离子体：无限长、直、圆柱形，半径为 $a$。\n-   等离子体电流：均匀的轴向电流密度。\n-   平衡磁场：角向场 $B_{\\theta 0}(r)$。\n    -   等离子体内部 ($0 \\le r \\le a$): $B_{\\theta 0}(r) = B_{a} \\frac{r}{a}$。\n    -   真空中 ($r \\ge a$): $B_{\\theta 0}(r) = B_{a} \\frac{a}{r}$。\n    -   $B_{a} \\equiv B_{\\theta 0}(a)$ 是等离子体边缘的场强。\n-   边界：位于半径 $b  a$ 的理想导电圆柱壁。\n-   框架：理想磁流体动力学 (MHD)。\n-   扰动：一个没有轴向变化 ($k=0$) 的刚性 $m=1$ 扭曲位移。\n    -   等离子体边界位移：$\\xi_{r}(a,\\theta) = \\xi_{0}\\cos\\theta$。\n    -   $\\xi_{0}$ 是一个常实数振幅。\n-   真空扰动：扰动磁场 $\\mathbf{B}_1$ 可以用一个标量磁通函数 $\\psi(r, \\theta)$ 表示，该函数在真空区域 $a  r  b$ 内满足拉普拉斯方程 $\\nabla^2\\psi = 0$。\n-   任务：\n    1.  计算真空对势能变化 $\\delta W_{\\text{vac}}$ 的贡献，表示为单位轴向长度的值。\n    2.  用 $a$、$b$、$B_{a}$、$\\mu_{0}$ 和 $\\xi_{0}$ 表示结果，其中 $\\mu_{0}$ 是真空磁导率。\n    3.  描述 $\\delta W_{\\text{vac}}$ 对导电壁半径 $b$ 的依赖性。\n\n### 步骤 2：使用提取的已知条件进行验证\n1.  **科学依据：** 该问题描述了一个Z箍缩位形，这是等离子体物理学中用于研究MHD稳定性的一个基本模型。平衡磁场分布与等离子体内部的均匀电流密度一致。使用理想MHD、磁通冻结和导电壁是分析此类位形稳定性的标准和适当方法。所描述的扰动是经典的 $m=1$ 外部扭曲模。该问题牢固地植根于已建立的等离子体物理学原理。\n2.  **适定性：** 该问题提供了一整套物理条件和边界约束（等离子体-真空交界面、导电壁），这些是唯一确定真空磁场扰动所必需的。计算真空能量贡献的目标是MHD稳定性理论中一个明确定义的任务。\n3.  **客观性：** 该问题使用等离子体物理学和数学中的精确、标准术语进行陈述。没有主观或基于意见的陈述。\n4.  **其他缺陷：** 该问题不是非形式化的、不完整的、矛盾的、不切实际的、不适定的、琐碎的或超出科学可验证范围的。这是MHD理论中的一个规范计算。\n\n### 步骤 3：结论和行动\n问题有效。我将继续进行求解。\n\n真空区域内单位轴向长度的势能变化 $\\delta W_{\\text{vac}}$，由扰动磁场能量密度在单位长度的真空体积上的积分给出。\n$$\n\\delta W_{\\text{vac}} = \\frac{1}{2\\mu_0} \\int_{0}^{2\\pi} \\int_{a}^{b} |\\mathbf{B}_1|^2 r \\, dr \\, d\\theta\n$$\n这里，$\\mathbf{B}_1$ 是真空区域 $a  r  b$ 中磁场的一阶扰动。由于真空中没有电流，安培定律给出 $\\nabla \\times \\mathbf{B}_1 = 0$。这与 $\\nabla \\cdot \\mathbf{B}_1 = 0$ 相结合，使我们可以用一个标量势来描述 $\\mathbf{B}_1$。问题指定使用磁通函数 $\\psi(r, \\theta)$，这对于二维问题（$k=0$）是合适的。磁场扰动与 $\\psi$ 的关系为：\n$$\n\\mathbf{B}_1 = \\nabla \\times (\\psi \\hat{\\mathbf{z}}) = \\frac{1}{r}\\frac{\\partial \\psi}{\\partial \\theta} \\hat{\\mathbf{r}} - \\frac{\\partial \\psi}{\\partial r} \\hat{\\mathbf{\\theta}}\n$$\n条件 $\\nabla \\times \\mathbf{B}_1 = 0$ 意味着 $\\psi$ 在真空区域必须满足拉普拉斯方程：\n$$\n\\nabla^2 \\psi = \\frac{1}{r}\\frac{\\partial}{\\partial r}\\left(r\\frac{\\partial \\psi}{\\partial r}\\right) + \\frac{1}{r^2}\\frac{\\partial^2 \\psi}{\\partial \\theta^2} = 0\n$$\n我们必须在两个边界条件下求解这个方程。\n\n首先，在 $r=b$ 处的理想导电壁上，磁场必须是切向的。平衡场 $\\mathbf{B}_0$ 已经是切向的。因此，扰动场的法向分量 $B_{1r}$ 在壁上必须为零。\n$$\nB_{1r}(b, \\theta) = \\frac{1}{b} \\left( \\frac{\\partial \\psi}{\\partial \\theta} \\right)_{r=b} = 0\n$$\n这意味着 $\\psi(b, \\theta)$ 必须与 $\\theta$ 无关。由于势的绝对值是任意的，为简单起见，我们可以将此常数值设为零：\n$$\n\\psi(b, \\theta) = 0\n$$\n其次，在扰动后的等离子体-真空交界面上，理想MHD磁通冻结约束要求总磁场与表面相切。设扰动后的表面为 $r_p(\\theta) = a + \\xi_r(a, \\theta) = a + \\xi_{0}\\cos\\theta$。该表面的一个法向量是 $\\mathbf{n} = \\nabla(r - r_p) = \\hat{\\mathbf{r}} - \\frac{1}{r}\\frac{\\partial r_p}{\\partial\\theta}\\hat{\\mathbf{\\theta}} = \\hat{\\mathbf{r}} + \\frac{\\xi_0}{r}\\sin\\theta \\hat{\\mathbf{\\theta}}$。条件是在 $r=r_p$ 处 $\\mathbf{B} \\cdot \\mathbf{n} = 0$。总场为 $\\mathbf{B} = \\mathbf{B}_0 + \\mathbf{B}_1$。我们对此条件进行线性化。\n$$\n(\\mathbf{B}_0(r_p) + \\mathbf{B}_1(r_p)) \\cdot \\mathbf{n}(r_p) = 0\n$$\n对于 $\\xi_0$ 和 $\\mathbf{B}_1$ 的一阶项：\n$\\mathbf{B}_0(r_p) \\approx \\mathbf{B}_0(a) + (\\boldsymbol{\\xi} \\cdot \\nabla)\\mathbf{B}_0|_{r=a} = B_a \\frac{a}{a}\\hat{\\mathbf{\\theta}} + (\\xi_r \\frac{\\partial}{\\partial r})(B_a a/r)\\hat{\\mathbf{\\theta}}|_{r=a} = B_a\\hat{\\mathbf{\\theta}} - \\frac{B_a}{a}\\xi_r \\hat{\\mathbf{\\theta}}$。\n$\\mathbf{B}_1(r_p) \\approx \\mathbf{B}_1(a)$。\n$\\mathbf{n}(r_p) \\approx \\hat{\\mathbf{r}} + \\frac{\\xi_0}{a}\\sin\\theta\\hat{\\mathbf{\\theta}}$。\n点积变为：\n$$\n(B_{1r}(a)\\hat{\\mathbf{r}} + \\dots) \\cdot \\hat{\\mathbf{r}} + (B_a\\hat{\\mathbf{\\theta}}) \\cdot (\\frac{\\xi_0}{a}\\sin\\theta\\hat{\\mathbf{\\theta}}) + \\mathcal{O}(\\xi_0^2, B_1\\xi_0) = 0\n$$\n$$\nB_{1r}(a, \\theta) + \\frac{B_a \\xi_0}{a} \\sin\\theta = 0 \\implies B_{1r}(a, \\theta) = -\\frac{B_a \\xi_0}{a} \\sin\\theta\n$$\n我们用 $\\psi$ 来表示这个关系：\n$$\n\\frac{1}{a} \\left(\\frac{\\partial \\psi}{\\partial \\theta}\\right)_{r=a} = -\\frac{B_a \\xi_0}{a} \\sin\\theta \\implies \\frac{\\partial \\psi}{\\partial \\theta}(a, \\theta) = -B_a \\xi_0 \\sin\\theta\n$$\n对 $\\theta$ 积分，得到 $\\psi$ 在 $r=a$ 处的边界条件：\n$$\n\\psi(a, \\theta) = B_a \\xi_0 \\cos\\theta\n$$\n问题简化为求解一个 $m=1$ 模的拉普拉斯方程。具有 $\\cos\\theta$ 依赖性的通解形式为 $\\psi(r, \\theta) = R(r)\\cos\\theta$。代入拉普拉斯方程得到欧拉方程 $r^2 R'' + rR' - R = 0$，其通解为 $R(r) = C_1 r + C_2 r^{-1}$。因此，\n$$\n\\psi(r, \\theta) = (C_1 r + C_2 r^{-1}) \\cos\\theta\n$$\n应用边界条件来求解常数 $C_1$ 和 $C_2$：\n在 $r=b$ 处：$\\psi(b, \\theta) = (C_1 b + C_2 b^{-1})\\cos\\theta = 0 \\implies C_1 b + C_2 b^{-1} = 0 \\implies C_2 = -C_1 b^2$。\n在 $r=a$ 处：$\\psi(a, \\theta) = (C_1 a + C_2 a^{-1})\\cos\\theta = B_a\\xi_0\\cos\\theta \\implies C_1 a + C_2 a^{-1} = B_a\\xi_0$。\n将 $C_2$ 代入第二个方程：\n$C_1 a - (C_1 b^2) a^{-1} = B_a\\xi_0 \\implies C_1 (a - b^2/a) = B_a\\xi_0 \\implies C_1 \\frac{a^2-b^2}{a} = B_a\\xi_0$。\n$$\nC_1 = \\frac{a B_a \\xi_0}{a^2 - b^2}, \\quad C_2 = -b^2 C_1 = -\\frac{a b^2 B_a \\xi_0}{a^2 - b^2}\n$$\n磁通函数为：\n$$\n\\psi(r, \\theta) = \\frac{a B_a \\xi_0}{a^2 - b^2} \\left( r - \\frac{b^2}{r} \\right) \\cos\\theta\n$$\n接下来，我们求扰动磁场的分量：\n$$\nB_{1r}(r, \\theta) = \\frac{1}{r}\\frac{\\partial \\psi}{\\partial \\theta} = \\frac{1}{r} \\frac{a B_a \\xi_0}{a^2 - b^2} \\left( r - \\frac{b^2}{r} \\right) (-\\sin\\theta) = \\frac{a B_a \\xi_0}{b^2 - a^2} \\left( 1 - \\frac{b^2}{r^2} \\right) \\sin\\theta\n$$\n$$\nB_{1\\theta}(r, \\theta) = -\\frac{\\partial \\psi}{\\partial r} = -\\frac{a B_a \\xi_0}{a^2 - b^2} \\left( 1 + \\frac{b^2}{r^2} \\right) \\cos\\theta = \\frac{a B_a \\xi_0}{b^2 - a^2} \\left( 1 + \\frac{b^2}{r^2} \\right) \\cos\\theta\n$$\n现在我们计算 $\\delta W_{\\text{vac}}$ 的能量积分。\n$$\n|\\mathbf{B}_1|^2 = B_{1r}^2 + B_{1\\theta}^2 = \\left( \\frac{a B_a \\xi_0}{b^2 - a^2} \\right)^2 \\left[ \\left( 1 - \\frac{b^2}{r^2} \\right)^2 \\sin^2\\theta + \\left( 1 + \\frac{b^2}{r^2} \\right)^2 \\cos^2\\theta \\right]\n$$\n对 $\\theta$ 的积分为：\n$\\int_0^{2\\pi} |\\mathbf{B}_1|^2 d\\theta = \\left( \\frac{a B_a \\xi_0}{b^2 - a^2} \\right)^2 \\left[ \\left( 1 - \\frac{b^2}{r^2} \\right)^2 \\int_0^{2\\pi}\\sin^2\\theta d\\theta + \\left( 1 + \\frac{b^2}{r^2} \\right)^2 \\int_0^{2\\pi}\\cos^2\\theta d\\theta \\right]$。\n使用 $\\int_0^{2\\pi}\\sin^2\\theta d\\theta = \\int_0^{2\\pi}\\cos^2\\theta d\\theta = \\pi$：\n$\\int_0^{2\\pi} |\\mathbf{B}_1|^2 d\\theta = \\pi \\left( \\frac{a B_a \\xi_0}{b^2 - a^2} \\right)^2 \\left[ \\left( 1 - \\frac{b^2}{r^2} \\right)^2 + \\left( 1 + \\frac{b^2}{r^2} \\right)^2 \\right]$。\n方括号中的项可以简化为 $(1 - \\frac{2b^2}{r^2} + \\frac{b^4}{r^4}) + (1 + \\frac{2b^2}{r^2} + \\frac{b^4}{r^4}) = 2 + \\frac{2b^4}{r^4} = 2(1 + \\frac{b^4}{r^4})$。\n所以，$\\delta W_{\\text{vac}} = \\frac{1}{2\\mu_0} \\int_a^b \\pi \\left( \\frac{a B_a \\xi_0}{b^2 - a^2} \\right)^2 2\\left(1 + \\frac{b^4}{r^4}\\right) r \\, dr$。\n$$\n\\delta W_{\\text{vac}} = \\frac{\\pi}{\\mu_0} \\left( \\frac{a B_a \\xi_0}{b^2 - a^2} \\right)^2 \\int_a^b \\left(r + \\frac{b^4}{r^3}\\right) dr\n$$\n余下的对 $r$ 的积分为：\n$\\int_a^b \\left(r + b^4 r^{-3}\\right) dr = \\left[ \\frac{r^2}{2} + b^4 \\frac{r^{-2}}{-2} \\right]_a^b = \\left[ \\frac{r^2}{2} - \\frac{b^4}{2r^2} \\right]_a^b$。\n$= \\left( \\frac{b^2}{2} - \\frac{b^4}{2b^2} \\right) - \\left( \\frac{a^2}{2} - \\frac{b^4}{2a^2} \\right) = \\left( \\frac{b^2}{2} - \\frac{b^2}{2} \\right) - \\frac{a^2}{2} + \\frac{b^4}{2a^2} = \\frac{b^4-a^4}{2a^2} = \\frac{(b^2-a^2)(b^2+a^2)}{2a^2}$。\n将此结果代回 $\\delta W_{\\text{vac}}$ 的表达式中：\n$$\n\\delta W_{\\text{vac}} = \\frac{\\pi}{\\mu_0} \\frac{a^2 B_a^2 \\xi_0^2}{(b^2 - a^2)^2} \\frac{(b^2-a^2)(b^2+a^2)}{2a^2}\n$$\n$$\n\\delta W_{\\text{vac}} = \\frac{\\pi B_a^2 \\xi_0^2}{2\\mu_0} \\frac{b^2+a^2}{b^2-a^2}\n$$\n这是单位轴向长度的真空能量贡献。\n\n对导电壁半径 $b$ 的依赖性包含在因子 $\\frac{b^2+a^2}{b^2-a^2}$ 中。我们可以将其重写为 $1 + \\frac{2a^2}{b^2-a^2}$。由于 $ba$，该项总是正的。因此，真空能量贡献 $\\delta W_{\\text{vac}}$ 总是正的，这意味着真空场对此扰动起稳定作用。\n-   当导电壁靠近等离子体时（$b \\to a^+$），项 $\\frac{2a^2}{b^2-a^2} \\to \\infty$。因此，$\\delta W_{\\text{vac}} \\to \\infty$。这表明紧贴的导电壁具有非常强的稳定作用，因为产生给定位移 $\\xi_0$ 需要无限大的能量。\n-   当导电壁移至无穷远处时（$b \\to \\infty$），项 $\\frac{2a^2}{b^2-a^2} \\to 0$。在这种情况下，$\\delta W_{\\text{vac}}$ 接近其最小值：$\\delta W_{\\text{vac}}(b \\to \\infty) = \\frac{\\pi B_a^2 \\xi_0^2}{2\\mu_0}$。\n总之，对于 $ba$，$\\delta W_{\\text{vac}}$ 是导电壁半径 $b$ 的单调递减函数。导电壁的稳定作用在靠近等离子体时最强，在远离时最弱。", "answer": "$$\n\\boxed{\\frac{\\pi B_a^2 \\xi_0^2}{2 \\mu_0} \\frac{b^2+a^2}{b^2-a^2}}\n$$", "id": "3721145"}, {"introduction": "对于复杂的等离子体位形，解析地最小化能量泛函 $\\delta W$ 往往是不现实的。这个实践将指导你应用瑞利-里兹（Rayleigh-Ritz）方法，这是一种强大的数值技术，它将变分问题转化为一个矩阵广义特征值问题来近似求解稳定性。通过动手实现这个求解器[@problem_id:3721123]，你不仅能掌握一种核心的计算MHD稳定性分析工具，还将用你的结果去验证著名的克鲁斯卡尔-沙夫拉诺夫（Kruskal-Shafranov）稳定性判据。", "problem": "要求您从第一性原理出发，实现一个瑞利-里兹求解器，用于计算理想磁流体力学（MHD）能量泛函对于$m=1$扭曲模的最小特征值。该计算针对一个半径为$a$、磁场为$B_{\\theta}(r)=\\mu\\,r$且$B_{z}=\\text{常数}$的直、周期性圆柱等离子体柱。目标是数值近似与势能泛函$\\delta W[\\xi]$相关的瑞利商$\\lambda[\\xi]$的下确界，并将数值结果与解析的圆柱扭曲不稳定性阈值进行验证。您必须生成一个单一、完整、可运行的程序，该程序实现此数值方法并按规定格式打印其结果。\n\n从理想磁流体力学（MHD）的能量原理出发，该原理指出，对于小的、无散的位移$\\boldsymbol{\\xi}$，势能的二阶变分$\\delta W$决定了稳定性：如果对于所有容许的$\\boldsymbol{\\xi}$都有$\\delta W[\\boldsymbol{\\xi}] \\ge 0$，则该模式是理想稳定的；如果存在一个容许的$\\boldsymbol{\\xi}$使得$\\delta W[\\boldsymbol{\\xi}]  0$，则该模式是理想不稳定的。在圆柱几何中，对于低压（冷等离子体）柱和具有傅里叶依赖关系$\\exp\\{i(m\\theta + kz)\\}$的不可压缩微扰，在薄真空壁近似下，对$\\delta W$的主要贡献——磁力线弯曲——可以被一个关于$m=1$扭曲模径向位移$\\xi(r)$的简化一维泛函所捕捉。在这个简化模型中，能量泛函为\n$$\n\\delta W[\\xi] \\;=\\; \\int_{0}^{a} r \\,\\mathrm{d}r \\left[ B_{z}^{2}\\,\\left|\\frac{\\mathrm{d}\\xi}{\\mathrm{d}r}\\right|^{2} \\;+\\; k^{2} B_{z}^{2}\\,|\\xi|^{2} \\right] \\;-\\; \\frac{B_{\\theta}(a)^{2}}{a^{2}} \\int_{0}^{a} r \\,|\\xi|^{2}\\,\\mathrm{d}r,\n$$\n该式对$m=1$和所述平衡是有效的，其中负项代表与角向场相关的外部（真空）磁能的去稳定贡献。对于$B_{\\theta}(r) = \\mu\\, r$，我们有$\\frac{B_{\\theta}(a)}{a} = \\mu$。用于定义广义特征值问题的相关瑞利商为\n$$\n\\lambda[\\xi] \\;=\\; \\frac{\\delta W[\\xi]}{\\displaystyle \\int_{0}^{a} r\\,|\\xi|^{2}\\,\\mathrm{d}r}.\n$$\n$m=1$的解析圆柱扭曲不稳定性阈值可以写成克鲁斯卡尔-沙夫拉诺夫条件，此处表示为轴向波数为$k$的周期性圆柱体形式，\n$$\nk\\,B_{z} \\;\\gtrless\\; \\frac{B_{\\theta}(a)}{a} \\quad\\Longleftrightarrow\\quad k^{2} B_{z}^{2} \\;\\gtrless\\; \\left(\\frac{B_{\\theta}(a)}{a}\\right)^{2},\n$$\n因此，简化模型对临界稳定点的预测对应于$\\lambda_{\\text{analytic}} = k^{2} B_{z}^{2} - \\mu^{2} = 0$。\n\n使用由$\\phi_{n}(r) = r^{n}$定义的多项式基$\\{\\phi_{n}(r)\\}_{n=0}^{N-1}$来实现瑞利-里兹方法，该基函数在$r=0$处满足正则性要求。在此基下，构建对称的刚度矩阵$W$和质量矩阵$M$：\n$$\nW_{ij} \\;=\\; \\int_{0}^{a} r\\,\\mathrm{d}r\\left[ B_{z}^{2} \\,\\frac{\\mathrm{d}\\phi_{i}}{\\mathrm{d}r} \\,\\frac{\\mathrm{d}\\phi_{j}}{\\mathrm{d}r} \\;+\\; \\left(k^{2} B_{z}^{2} - \\mu^{2}\\right)\\,\\phi_{i}\\,\\phi_{j} \\right], \\qquad\nM_{ij} \\;=\\; \\int_{0}^{a} r\\,\\phi_{i}\\,\\phi_{j}\\,\\mathrm{d}r,\n$$\n并求解广义对称定特征值问题\n$$\nW\\,\\boldsymbol{c} \\;=\\; \\lambda\\, M\\,\\boldsymbol{c},\n$$\n以获得最小特征值$\\lambda_{\\min}$，该值通过将$\\xi$限制在所选基的张成空间内来近似$\\inf_{\\xi}\\lambda[\\xi]$。在这个简化模型中，常数基函数$\\phi_{0}(r)=1$产生的瑞利商等于$\\lambda_{\\text{analytic}} = k^{2}B_{z}^{2} - \\mu^{2}$，因此当基中包含$\\phi_{0}$时，瑞利-里兹近似应能精确再现解析阈值。\n\n对于$\\phi_{n}(r) = r^{n}$，矩阵元素的数值积分可以以闭合形式完成：\n$$\nM_{ij} \\;=\\; \\int_{0}^{a} r^{i+j+1}\\,\\mathrm{d}r \\;=\\; \\frac{a^{i+j+2}}{i+j+2},\n$$\n$$\nW_{ij} \\;=\\; B_{z}^{2}\\,i\\,j\\,\\int_{0}^{a} r^{i+j-1}\\,\\mathrm{d}r \\;+\\; \\left(k^{2} B_{z}^{2} - \\mu^{2}\\right)\\,M_{ij} \\;=\\; B_{z}^{2}\\,i\\,j\\,\\frac{a^{i+j}}{i+j} \\;+\\; \\left(k^{2} B_{z}^{2} - \\mu^{2}\\right)\\,\\frac{a^{i+j+2}}{i+j+2},\n$$\n需要理解的是，由于因子$i$和$j$，当$i=0$或$j=0$时，导数项为零。\n\n您的程序必须：\n- 按照上述定义实现瑞利-里兹方法。\n- 对每个提供的测试用例，计算最小特征值$\\lambda_{\\min}$，并将其与解析预测$\\lambda_{\\text{analytic}} = k^{2} B_{z}^{2} - \\mu^{2}$进行比较，通过检查符号分类（如果$\\lambda_{\\min}  0$则为稳定，如果$\\lambda_{\\min}  0$则为不稳定，如果$|\\lambda_{\\min}|$在数值容差范围内则为临界稳定）是否与从克鲁斯卡尔-沙夫拉诺夫条件导出的解析分类相匹配。\n- 以浮点数形式表示$\\lambda_{\\min}$，单位为$\\mathrm{T}^{2}\\cdot \\mathrm{m}^{-2}$（特斯拉平方每米平方）。\n- 使用$10^{-8}$的数值容差来将一个值分类为临界零值。\n\n测试套件：\n使用以下测试用例，每个用例指定为一个元组$(a, B_{z}, k, \\mu, N)$，其中$a$的单位是米，$B_{z}$的单位是特斯拉，$k$的单位是米分之一，$\\mu$的单位是特斯拉每米，$N$是基函数的数量：\n1. $(1.0,\\, 1.0,\\, 1.0,\\, 0.8,\\, 6)$。\n2. $(0.5,\\, 1.5,\\, 2.0,\\, 3.0,\\, 5)$。\n3. $(1.0,\\, 0.5,\\, 0.5,\\, 0.4,\\, 8)$。\n4. $(2.0,\\, 0.8,\\, 0.25,\\, 0.1,\\, 4)$。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，对于每个测试用例，您需要输出最小特征值，后跟一个布尔值，该布尔值指示数值符号分类是否与解析扭曲阈值分类匹配。具体来说，输出必须采用以下格式\n$[\\lambda_{1},\\,\\texttt{match}_{1},\\,\\lambda_{2},\\,\\texttt{match}_{2},\\,\\lambda_{3},\\,\\texttt{match}_{3},\\,\\lambda_{4},\\,\\texttt{match}_{4}]$，\n其中所有$\\lambda_{i}$的单位均为$\\mathrm{T}^{2}\\cdot \\mathrm{m}^{-2}$。", "solution": "我们从理想磁流体力学（MHD）的能量原理开始，该原理指出，在理想极限下，等离子体的稳定性由势能$\\delta W[\\boldsymbol{\\xi}]$在动力学可及的微扰$\\boldsymbol{\\xi}$下的二阶变分的符号决定。对于满足$\\nabla\\cdot \\boldsymbol{\\xi} = 0$的不可压缩位移场，在压力效应可忽略的低压等离子体中，$\\delta W$的主要贡献来自磁力线弯曲以及与外部真空的相互作用。\n\n在圆柱几何中，对于平衡磁场$\\boldsymbol{B}(r)=B_{z}\\,\\hat{\\boldsymbol{z}} + B_{\\theta}(r)\\,\\hat{\\boldsymbol{\\theta}}$和无旋转的低压平衡，考虑具有角向模数$m$和轴向波数$k$的傅里叶微扰，即对于$m=1$扭曲模附近的主要径向分量，有$\\boldsymbol{\\xi}(r,\\theta,z) = \\xi_{r}(r)\\,\\hat{\\boldsymbol{r}}\\,\\exp\\{i(m\\theta + kz)\\}$。对于$m=1$，该模式类似于等离子体柱的刚性横向平移。在冷等离子体极限和不可压缩位移的情况下，理想MHD能量原理得出由磁力线弯曲主导的磁能变化，\n$$\n\\delta W_{\\text{bend}} \\sim \\frac{1}{2\\mu_{0}} \\int \\mathrm{d}V\\, \\left|\\mathbf{B}\\cdot\\nabla\\boldsymbol{\\xi}_{\\perp}\\right|^{2},\n$$\n其中$\\boldsymbol{\\xi}_{\\perp}$是横向位移。对于所述的傅里叶依赖关系和给定的平衡，沿磁力线的纵向导数贡献一个与$k^{2}B_{z}^{2}|\\xi|^{2}$成正比的项，而径向剪切贡献$B_{z}^{2}|\\mathrm{d}\\xi/\\mathrm{d}r|^{2}$。此外，外部真空磁场会响应边界位移而产生微扰，提供了一个去稳定贡献。在薄真空壁近似下，这可以表示为一个有效的负项，该项与边界角向场的平方$B_{\\theta}(a)^{2}$乘以边界位移的平方成正比。在$m=1$刚性位移近似下，边界位移代表了内部位移的振幅，因此真空贡献可以建模为一个与$\\int r|\\xi|^{2}\\,\\mathrm{d}r$成正比的均匀负项。将这些部分整合起来，我们得到$m=1$模式的简化一维能量泛函，\n$$\n\\delta W[\\xi] \\;=\\; \\int_{0}^{a} r \\,\\mathrm{d}r \\left[ B_{z}^{2}\\,\\left|\\frac{\\mathrm{d}\\xi}{\\mathrm{d}r}\\right|^{2} \\;+\\; k^{2} B_{z}^{2}\\,|\\xi|^{2} \\right] \\;-\\; \\frac{B_{\\theta}(a)^{2}}{a^{2}} \\int_{0}^{a} r \\,|\\xi|^{2}\\,\\mathrm{d}r.\n$$\n对于平衡$B_{\\theta}(r) = \\mu\\,r$，我们有$\\frac{B_{\\theta}(a)}{a}= \\mu$，其中$\\mu$的单位是特斯拉每米。该模型根据克鲁斯卡尔-沙夫拉诺夫条件，捕捉了扭曲不稳定性阈值对轴向场强和边界角向场的本质依赖关系。\n\n为了计算瑞利商的最小值\n$$\n\\lambda[\\xi] \\;=\\; \\frac{\\delta W[\\xi]}{\\displaystyle \\int_{0}^{a} r\\,|\\xi|^{2}\\,\\mathrm{d}r},\n$$\n我们使用瑞利-里兹方法，该方法通过有限基将无限维最小化问题简化为广义矩阵特征值问题。选择多项式基$\\phi_{n}(r)=r^{n}$，其中$n=0,1,\\dots,N-1$。该基在$r=0$处是正则的，并通过$\\phi_{0}(r)=1$包含了物理上相关的刚性位移分量。\n\n使用此基，限制在$\\{\\phi_{n}\\}$张成空间内的瑞利商等价于广义对称定特征值问题的最小特征值\n$$\nW\\,\\boldsymbol{c} \\;=\\; \\lambda\\, M\\,\\boldsymbol{c},\n$$\n其中刚度矩阵$W$和质量矩阵$M$的元素为\n$$\nM_{ij} \\;=\\; \\int_{0}^{a} r\\,\\phi_{i}\\,\\phi_{j}\\,\\mathrm{d}r \\;=\\; \\int_{0}^{a} r^{i+j+1}\\,\\mathrm{d}r \\;=\\; \\frac{a^{i+j+2}}{i+j+2},\n$$\n$$\nW_{ij} \\;=\\; \\int_{0}^{a} r\\,\\left[ B_{z}^{2} \\,\\frac{\\mathrm{d}\\phi_{i}}{\\mathrm{d}r} \\,\\frac{\\mathrm{d}\\phi_{j}}{\\mathrm{d}r} \\;+\\; \\left(k^{2} B_{z}^{2} - \\mu^{2}\\right)\\,\\phi_{i}\\,\\phi_{j} \\right] \\mathrm{d}r \\;=\\; B_{z}^{2}\\,i\\,j\\,\\frac{a^{i+j}}{i+j} \\;+\\; \\left(k^{2} B_{z}^{2} - \\mu^{2}\\right)\\,\\frac{a^{i+j+2}}{i+j+2},\n$$\n需要理解的是，由于前置因子$i\\,j$，当$i=0$或$j=0$时，导数贡献为零。这些积分是精确的，并产生对称的实数矩阵。对于所选的基，$M$矩阵是正定的，而$W$是对称的，因此广义特征值是实数，可以使用针对对称定对的鲁棒求解器进行计算。\n\n从这个广义特征值问题获得的最小特征值$\\lambda_{\\min}$近似了在由基函数张成的函数空间上瑞利商的下确界。由于基中包含了$\\phi_{0}$，在$\\phi_{0}$上计算的瑞利商恰好是\n$$\n\\lambda[\\phi_{0}] \\;=\\; \\frac{\\left(k^{2} B_{z}^{2} - \\mu^{2}\\right) \\int_{0}^{a} r\\,\\mathrm{d}r}{\\int_{0}^{a} r\\,\\mathrm{d}r} \\;=\\; k^{2} B_{z}^{2} - \\mu^{2},\n$$\n因为对于常数函数，导数项为零。因此，当$\\phi_{0}$存在时，瑞利-里兹方法精确地再现了简化模型对临界稳定点的解析预测。这为与克鲁斯卡尔-沙夫拉诺夫条件相关的圆柱扭曲不稳定性阈值提供了直接的数值验证，此处该条件用$k$、$B_{z}$和$B_{\\theta}(a)/a=\\mu$表示。\n\n算法步骤：\n1. 对于每个测试用例$(a, B_{z}, k, \\mu, N)$，使用上述针对基大小为$N$的闭合形式积分来构建矩阵$W$和$M$。\n2. 使用保留对称性的广义特征值求解器（例如，专门用于对称定问题的函数）求解$W\\,\\boldsymbol{c} = \\lambda\\, M\\,\\boldsymbol{c}$以得到$\\lambda$。\n3. 提取最小特征值$\\lambda_{\\min}$并进行分类：如果$\\lambda_{\\min}  \\varepsilon$则为稳定，如果$\\lambda_{\\min}  -\\varepsilon$则为不稳定，如果$|\\lambda_{\\min}| \\le \\varepsilon$则为临界稳定，其中$\\varepsilon$是一个小容差（使用$\\varepsilon=10^{-8}$）。\n4. 使用相同的容差，根据$\\lambda_{\\text{analytic}} = k^{2} B_{z}^{2} - \\mu^{2}$的符号计算解析分类。\n5. 为每个案例报告数值$\\lambda_{\\min}$（单位为$\\mathrm{T}^{2}\\cdot \\mathrm{m}^{-2}$）以及一个指示数值分类是否与解析分类匹配的布尔值。\n\n测试套件包括四个案例，用于探测：\n- $\\lambda_{\\text{analytic}}  0$的一般稳定区域。\n- $\\lambda_{\\text{analytic}} = 0$的临界区域。\n- $\\lambda_{\\text{analytic}}  0$的不稳定区域。\n- 一个具有不同$a$和更小基大小的案例，以检查方法的鲁棒性。\n\n最终的程序为每个测试用例构建并求解广义特征值问题，并按照规定，打印一个包含每个案例的最小特征值和验证布尔值的单一列表。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import eigh\n\ndef assemble_matrices(N, a, Bz, k, mu):\n    \"\"\"\n    Assemble stiffness matrix W and mass matrix M for the Rayleigh–Ritz method\n    using polynomial basis phi_n(r) = r^n, n=0..N-1.\n\n    W_ij = Bz^2 * i * j * a^(i+j) / (i + j) + (k^2 * Bz^2 - mu^2) * a^(i+j+2) / (i + j + 2)\n    M_ij = a^(i+j+2) / (i + j + 2)\n    with the convention that the derivative contribution vanishes for i=0 or j=0.\n    \"\"\"\n    W = np.zeros((N, N), dtype=float)\n    M = np.zeros((N, N), dtype=float)\n    # Precompute powers of a for efficiency\n    # Max power needed is i+j+2 for M and i+j for derivative term\n    # We'll compute on the fly using pow to avoid large arrays\n    for i in range(N):\n        for j in range(N):\n            # Mass matrix element\n            denom_m = i + j + 2\n            M_ij = (a ** (i + j + 2)) / denom_m\n            M[i, j] = M_ij\n            # Stiffness matrix element\n            # Derivative term\n            deriv_term = 0.0\n            if i  0 and j  0:\n                denom_w = i + j\n                deriv_term = (Bz ** 2) * i * j * (a ** (i + j)) / denom_w\n            W[i, j] = deriv_term + (k ** 2 * Bz ** 2 - mu ** 2) * M_ij\n    return W, M\n\ndef smallest_generalized_eigenvalue(W, M):\n    \"\"\"\n    Solve the generalized symmetric definite eigenproblem W x = lambda M x\n    and return the smallest eigenvalue.\n    \"\"\"\n    # eigh solves for symmetric (Hermitian) matrices and supports generalized problems.\n    # We request only eigenvalues for efficiency and sort ascending.\n    evals = eigh(W, M, eigvals_only=True)\n    # eigh returns sorted eigenvalues in ascending order by default for Hermitian problems\n    lam_min = float(evals[0])\n    return lam_min\n\ndef classify(value, tol=1e-8):\n    \"\"\"\n    Classify a float value with tolerance:\n    +1 for positive ( tol), -1 for negative ( -tol), 0 for near-zero (abs = tol).\n    \"\"\"\n    if value  tol:\n        return 1\n    elif value  -tol:\n        return -1\n    else:\n        return 0\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each case: (a [m], Bz [T], k [1/m], mu [T/m], N [basis size])\n    test_cases = [\n        (1.0, 1.0, 1.0, 0.8, 6),    # Stable: k^2 Bz^2 - mu^2 = 1 - 0.64 = 0.36\n        (0.5, 1.5, 2.0, 3.0, 5),    # Marginal: k^2 Bz^2 - mu^2 = 9 - 9 = 0\n        (1.0, 0.5, 0.5, 0.4, 8),    # Unstable: k^2 Bz^2 - mu^2 = 0.0625 - 0.16 = -0.0975\n        (2.0, 0.8, 0.25, 0.1, 4),   # Stable: k^2 Bz^2 - mu^2 = 0.04 - 0.01 = 0.03\n    ]\n\n    results = []\n    tol = 1e-8\n    for a, Bz, k, mu, N in test_cases:\n        W, M = assemble_matrices(N, a, Bz, k, mu)\n        lam_min = smallest_generalized_eigenvalue(W, M)\n        # Analytic prediction from reduced model: lambda_analytic = k^2 Bz^2 - mu^2\n        lam_analytic = k**2 * Bz**2 - mu**2\n        # Compare sign classifications with tolerance\n        cls_num = classify(lam_min, tol=tol)\n        cls_ana = classify(lam_analytic, tol=tol)\n        match = (cls_num == cls_ana)\n        results.append(lam_min)\n        results.append(match)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3721123"}]}