{"hands_on_practices": [{"introduction": "本练习聚焦于离子回旋共振加热（ICRH）最核心的方面：谐振条件 [@problem_id:3704786]。通过从洛伦兹力第一性原理出发，你将推导回旋频率，并考虑相对论质量修正，这对于被ICRH加速产生的高能“尾部”离子至关重要。这项练习旨在巩固你对核心波-粒子相互作用的理解，并将其与托卡马克中的实际磁场分布联系起来。", "problem": "一个大环径比托卡马克的环向磁场随大半径的变化关系为 $B(R) = B_0 \\, R_0 / R$，其中 $B_0$ 是在磁轴 $R = R_0$ 处的轴上磁场。考虑一个包含少量完全电离氦-3离子的氘等离子体。您计划使用离子回旋共振加热 (ICRH) 在氦-3的基频回旋共振处将能量沉积在磁轴上。射频 (RF) 快波以足够小的平行折射率发射，因此在共振层可以忽略多普勒频移。假设波的传播背景为无碰撞的冷等离子体。\n\n仅从洛伦兹力定律和相对论能量-动量关系出发，推导在强磁场存在下适用于基波的回旋共振条件，包括对具有指定动能的共振离子的领头阶相对论质量修正。然后，使用给定参数，计算将动能为 $K$ 的共振离子的氦-3基频离子回旋共振置于磁轴上所需的射频频率 $f$（单位为 $\\mathrm{MHz}$）。\n\n使用以下数据：\n- 轴上磁场：$B_0 = 5.3 \\ \\mathrm{T}$。\n- 少数离子种类：完全电离的氦-3，电荷数 $Z = 2$，静止质量 $m_{3\\mathrm{He}} = 3.0160293 \\, u$。\n- 共振氦-3动能：$K = 600 \\ \\mathrm{keV}$。\n- 原子质量单位：$u = 1.66053906660 \\times 10^{-27} \\ \\mathrm{kg}$。\n- 元电荷：$e = 1.602176634 \\times 10^{-19} \\ \\mathrm{C}$。\n- 光速：$c = 2.99792458 \\times 10^{8} \\ \\mathrm{m/s}$。\n\n陈述您使用的所有中间符号关系，并清楚地证明任何近似的合理性。以 $\\mathrm{MHz}$ 为单位表示最终频率，并将您的答案四舍五入到 $4$ 位有效数字。假设在磁轴处 $R = R_0$。您可以忽略有限拉莫尔半径效应、选择基频共振之外的波极化效应，以及由于少数离子比例小和平行波数小而在磁轴外发生的任何模式转换。", "solution": "该问题要求推导相对论性离子回旋共振条件，并随后计算在托卡马克等离子体中加热氦-3离子所需的射频 (RF) 波频率。验证过程确认了该问题在科学上是合理的、提法得当，并包含所有必要的数据。\n\n首先，我们推导共振条件。在磁场 $\\mathbf{B}$ 中，带电荷 $q$ 和相对论动量 $\\mathbf{p}$ 的离子的运动由洛伦兹力定律决定。在回旋运动的背景下，我们忽略波电场对轨道导向中心的影响，并且只考虑背景磁场对回旋动力学的作用。运动方程为：\n$$ \\frac{d\\mathbf{p}}{dt} = q(\\mathbf{v} \\times \\mathbf{B}) $$\n相对论动量为 $\\mathbf{p} = \\gamma m_0 \\mathbf{v}$，其中 $m_0$ 是离子的静止质量，$\\mathbf{v}$ 是其速度，$\\gamma = (1 - v^2/c^2)^{-1/2}$ 是洛伦兹因子，其中 $v = |\\mathbf{v}|$，$c$ 是光速。\n\n磁力始终垂直于速度，因此它不对离子做功。离子总能量 $E_{tot} = \\gamma m_0 c^2$ 的变化率为零：\n$$ \\frac{dE_{tot}}{dt} = \\mathbf{F} \\cdot \\mathbf{v} = q(\\mathbf{v} \\times \\mathbf{B}) \\cdot \\mathbf{v} = 0 $$\n因此，在静磁场中回旋运动期间，离子的总能量、动能 $K = E_{tot} - m_0 c^2$、速率 $v$ 和洛伦兹因子 $\\gamma$ 都保持不变。由于 $\\gamma$ 和 $m_0$ 是常数，运动方程可以写成：\n$$ \\gamma m_0 \\frac{d\\mathbf{v}}{dt} = q(\\mathbf{v} \\times \\mathbf{B}) \\implies \\frac{d\\mathbf{v}}{dt} = \\frac{q}{\\gamma m_0}(\\mathbf{v} \\times \\mathbf{B}) $$\n该方程描述了垂直于 $\\mathbf{B}$ 的速度矢量分量的匀速圆周运动，其角频率被称为相对论回旋频率 $\\omega_{c,rel}$：\n$$ \\omega_{c,rel} = \\frac{|q|B}{\\gamma m_0} $$\n其中 $B = |\\mathbf{B}|$。\n\n当施加的射频波频率 $\\omega$ 与离子参考系中离子回旋频率的谐波匹配时，就会发生离子回旋共振加热 (ICRH)。问题指定了基频共振，对应于谐波数 $n=1$。问题还指出可以忽略多普勒频移 ($k_\\parallel \\approx 0$)。因此，在实验室坐标系中的共振条件很简单：\n$$ \\omega = \\omega_{c,rel} = \\frac{|q|B}{\\gamma m_0} $$\n为了将动能 $K$ 纳入此条件，我们使用相对论能量关系 $K = (\\gamma - 1)m_0 c^2$。由此，洛伦兹因子表示为：\n$$ \\gamma = 1 + \\frac{K}{m_0 c^2} $$\n将此代入共振条件，得到动能为 $K$ 的离子的精确相对论回旋共振频率：\n$$ \\omega = \\frac{|q|B}{m_0 \\left(1 + \\frac{K}{m_0 c^2}\\right)} $$\n这就是所求的共振条件。为了找到领头阶的相对论质量修正，我们可以对动能远小于静止能量的情况（即 $K \\ll m_0 c^2$）进行泰勒展开。令 $x = K/(m_0 c^2)$。使用展开式 $(1+x)^{-1} \\approx 1 - x + O(x^2)$，我们得到：\n$$ \\omega \\approx \\frac{|q|B}{m_0} \\left(1 - \\frac{K}{m_0 c^2}\\right) = \\omega_{c,0} \\left(1 - \\frac{K}{m_0 c^2}\\right) $$\n这里，$\\omega_{c,0} = |q|B/m_0$ 是非相对论回旋频率。项 $-\\omega_{c,0} (K/m_0c^2)$ 代表了由于离子有效质量增加而引起的领头阶相对论频率偏移。\n\n接下来，我们计算射频频率 $f = \\omega/(2\\pi)$ 的数值。我们将使用精确的相对论公式进行计算，因为它比领头阶近似更准确。共振将发生在磁轴 $R=R_0$ 处，此处的磁场为 $B = B_0$。\n$$ f = \\frac{1}{2\\pi} \\frac{|q|B_0}{m_0 \\left(1 + \\frac{K}{m_0 c^2}\\right)} $$\n给定参数为：\n-   轴上磁场：$B_0 = 5.3 \\ \\mathrm{T}$。\n-   少数离子：完全电离的氦-3 ($^{3}\\mathrm{He}^{2+}$)。\n-   电荷数：$Z = 2$，因此电荷为 $q = Z e$。\n-   静止质量：$m_0 = m_{3\\mathrm{He}} = 3.0160293 \\, u$。\n-   动能：$K = 600 \\ \\mathrm{keV}$。\n-   原子质量单位：$u = 1.66053906660 \\times 10^{-27} \\ \\mathrm{kg}$。\n-   元电荷：$e = 1.602176634 \\times 10^{-19} \\ \\mathrm{C}$。\n-   光速：$c = 2.99792458 \\times 10^{8} \\ \\mathrm{m/s}$。\n\n我们将所有值转换为国际单位制 (SI) 的基本单位。\n离子电荷为 $q = 2 \\times (1.602176634 \\times 10^{-19} \\ \\mathrm{C}) = 3.204353268 \\times 10^{-19} \\ \\mathrm{C}$。\n离子静止质量为 $m_0 = 3.0160293 \\times (1.66053906660 \\times 10^{-27} \\ \\mathrm{kg}) = 5.00823790 \\times 10^{-27} \\ \\mathrm{kg}$。\n动能为 $K = 600 \\times 10^3 \\ \\mathrm{eV} = 600 \\times 10^3 \\times (1.602176634 \\times 10^{-19} \\ \\mathrm{J}) = 9.613059804 \\times 10^{-14} \\ \\mathrm{J}$。\n\n现在我们计算括号中包含洛伦兹因子的项：\n静止能量为 $m_0 c^2 = (5.00823790 \\times 10^{-27} \\ \\mathrm{kg}) \\times (2.99792458 \\times 10^{8} \\ \\mathrm{m/s})^2 = 4.50125500 \\times 10^{-10} \\ \\mathrm{J}$。\n洛伦兹因子为 $\\gamma = 1 + K/(m_0 c^2) = 1 + (9.613059804 \\times 10^{-14} \\ \\mathrm{J}) / (4.50125500 \\times 10^{-10} \\ \\mathrm{J}) = 1.000213565$。\n\n乘积 $\\gamma m_0$ 给出相对论质量：\n$\\gamma m_0 = 1.000213565 \\times (5.00823790 \\times 10^{-27} \\ \\mathrm{kg}) = 5.00930740 \\times 10^{-27} \\ \\mathrm{kg}$。\n\n最后，我们计算频率 $f$：\n$$ f = \\frac{1}{2\\pi} \\frac{|q|B_0}{\\gamma m_0} = \\frac{1}{2\\pi} \\frac{(3.204353268 \\times 10^{-19} \\ \\mathrm{C}) \\times (5.3 \\ \\mathrm{T})}{5.00930740 \\times 10^{-27} \\ \\mathrm{kg}} $$\n$$ f = \\frac{1.698307232 \\times 10^{-18}}{2\\pi \\times (5.00930740 \\times 10^{-27})} \\ \\mathrm{Hz} = \\frac{1.698307232 \\times 10^{-18}}{3.14740260 \\times 10^{-26}} \\ \\mathrm{Hz} $$\n$$ f = 53959146.4 \\ \\mathrm{Hz} = 53.9591464 \\ \\mathrm{MHz} $$\n问题要求将结果四舍五入到 $4$ 位有效数字。\n$$ f \\approx 53.96 \\ \\mathrm{MHz} $$\n相对论修正导致频率相比非相对论值 $f_{c,0} \\approx 53.9708 \\ \\mathrm{MHz}$ 下移了约 $11.7 \\ \\mathrm{kHz}$。这种频移虽然很小，但对于在托卡马克中精确控制共振位置至关重要。", "answer": "$$\n\\boxed{53.96}\n$$", "id": "3704786"}, {"introduction": "为了高效地将波功率耦合到等离子体中，我们需要精确地控制发射波的特性。本练习 [@problem_id:3704793] 探讨了ICRH天线设计的核心物理——如何通过为天线阵列的各个部件设定相位差来主动地塑造平行波数（$k_{\\parallel}$）谱。通过这个实践，你将理解工程师和物理学家如何设计天线来发射满足特定传播和吸收条件的波。", "problem": "托卡马克中的离子回旋共振加热（ICRH）天线被建模为一个由$N$个薄的、沿环向延伸的电流带组成的阵列，安装在等离子体边界处局部平坦的导电壁上。环向由坐标$z$表示，该坐标被视为局部平行于平衡磁场$\\mathbf{B}_{0}$。每个电流带以角频率$\\omega$被驱动，并带有指定的复电流。假设天线与等离子体边界之间的真空区域除了电流带外是无源的，并且等离子体呈现的阻抗使得界面处的场可以描述为由电流带产生的场的叠加，忽略多次散射。\n\n设第$n$个电流带（索引为$n=0,1,\\dots,N-1$）中心位于位置$z_{n}=n d$，间距$d$均匀，并以电流相位$\\phi_{n}=n\\,\\Delta\\phi$驱动，因此界面处沿$z$方向的复电流密度可以建模为\n$$\nJ(z) = \\sum_{n=0}^{N-1} I_{0}\\,\\delta(z - n d)\\,\\exp\\!\\left(i\\,\\phi_{n}\\right),\n$$\n其中$I_{0}$是一个实正常数，$\\delta(\\cdot)$是狄拉克$\\delta$分布。使用真空中的麦克斯韦方程组和相关的亥姆霍兹方程，并在导电壁上施加适当的边界条件，在频域中处理由$J(z)$产生的真空场。考虑界面处切向电场沿$z$方向的空间傅里叶变换，并确定平行波数谱$E_{\\parallel}(k_{\\parallel})$如何依赖于$J(z)$。\n\n从亥姆霍兹方程的源形式和叠加原理出发，推导沿平行（环向）方向的谱振幅$E_{\\parallel}(k_{\\parallel})$的表达式，该表达式用一个依赖于$J(z)$的空间傅里叶变换的因子来表示。然后，对于上述均匀的$N$元阵列，确定使谱振幅的幅度最大化（主瓣）时$k_{\\parallel}$满足的条件。最后，对于特定情况\n$$\nN = 4,\\quad d = 0.65\\ \\text{m},\\quad \\Delta\\phi = \\frac{\\pi}{2}\\ \\text{radians},\n$$\n计算主导的发射平行波数$k_{\\parallel,\\text{max}}$（选择对应于最小$|k_{\\parallel}|$的主最大值）。将您的最终数值结果$k_{\\parallel,\\text{max}}$以$\\text{rad}/\\text{m}$为单位表示，并四舍五入到四位有效数字。", "solution": "适当的出发点是真空中的频域麦克斯韦方程组，这导致了角频率为$\\omega$、波数为$k_{0}=\\omega/c$的电场$\\mathbf{E}(\\mathbf{r})$的矢量亥姆霍兹方程：\n$$\n\\nabla\\times\\nabla\\times \\mathbf{E}(\\mathbf{r}) - k_{0}^{2}\\,\\mathbf{E}(\\mathbf{r}) = i \\omega \\mu_{0}\\,\\mathbf{J}(\\mathbf{r}),\n$$\n其中$\\mathbf{J}(\\mathbf{r})$是电流密度。在界面平面上，我们考虑平行于$\\mathbf{B}_{0}$的切向分量，记为$E_{\\parallel}(z)$，并且在局部平面近似下，我们将注意力限制在环向坐标$z$上，将其他坐标视为参数。\n\n根据线性和叠加原理，$\\mathbf{E}$的解可以表示为亥姆霍兹算子的格林函数与源$\\mathbf{J}$的卷积。由于分布$J(z)$（具有封装在函数$G$中的适当极化和单元因子），界面处沿$z$的切向分量为\n$$\nE_{\\parallel}(z) = \\int_{-\\infty}^{\\infty} G(z - z')\\,J(z')\\,\\mathrm{d}z'.\n$$\n沿$z$方向进行空间傅里叶变换，\n$$\n\\widetilde{E}_{\\parallel}(k_{\\parallel}) \\equiv \\int_{-\\infty}^{\\infty} E_{\\parallel}(z)\\,\\exp(-i k_{\\parallel} z)\\,\\mathrm{d}z,\n$$\n并使用卷积定理，可得\n$$\n\\widetilde{E}_{\\parallel}(k_{\\parallel}) = \\widetilde{G}(k_{\\parallel})\\,\\widetilde{J}(k_{\\parallel}),\n$$\n其中\n$$\n\\widetilde{J}(k_{\\parallel}) = \\int_{-\\infty}^{\\infty} J(z)\\,\\exp(-i k_{\\parallel} z)\\,\\mathrm{d}z,\\qquad \\widetilde{G}(k_{\\parallel}) = \\int_{-\\infty}^{\\infty} G(z)\\,\\exp(-i k_{\\parallel} z)\\,\\mathrm{d}z.\n$$\n因子$\\widetilde{G}(k_{\\parallel})$是单元因子，它取决于几何形状、极化和边界条件。当所有电流带的单元因子相同时，阵列方向图（或阵列因子）完全由$\\widetilde{J}(k_{\\parallel})$产生。因此，平行波数谱的形状由电流分布的傅里叶变换决定：\n$$\n\\widetilde{J}(k_{\\parallel}) = \\sum_{n=0}^{N-1} I_{0}\\,\\exp\\!\\left(i\\,\\phi_{n}\\right)\\,\\exp\\!\\left(-i k_{\\parallel} z_{n}\\right).\n$$\n当$z_{n}=n d$和$\\phi_{n}=n \\Delta\\phi$时，这变成一个有限几何级数：\n$$\n\\widetilde{J}(k_{\\parallel}) = I_{0}\\,\\sum_{n=0}^{N-1} \\exp\\!\\left[i\\,n\\left(\\Delta\\phi - k_{\\parallel} d\\right)\\right].\n$$\n定义\n$$\n\\alpha \\equiv \\Delta\\phi - k_{\\parallel} d.\n$$\n则\n$$\n\\widetilde{J}(k_{\\parallel}) = I_{0}\\,\\sum_{n=0}^{N-1} \\exp(i n \\alpha) = I_{0}\\,\\frac{1 - \\exp(i N \\alpha)}{1 - \\exp(i \\alpha)}.\n$$\n通常将此有限和重写为对称形式，方法是将分子和分母同乘以$\\exp\\!\\left[-i\\alpha(N-1)/2\\right]$：\n$$\n\\widetilde{J}(k_{\\parallel}) = I_{0}\\,\\exp\\!\\left[i\\frac{(N-1)\\alpha}{2}\\right]\\frac{\\sin\\!\\left(\\frac{N\\alpha}{2}\\right)}{\\sin\\!\\left(\\frac{\\alpha}{2}\\right)}.\n$$\n因此，平行电场的谱振幅可以写为\n$$\n\\widetilde{E}_{\\parallel}(k_{\\parallel}) = \\widetilde{G}(k_{\\parallel})\\,I_{0}\\,\\exp\\!\\left[i\\frac{(N-1)\\alpha}{2}\\right]\\frac{\\sin\\!\\left(\\frac{N\\alpha}{2}\\right)}{\\sin\\!\\left(\\frac{\\alpha}{2}\\right)}.\n$$\n阵列因子的大小（它控制最大值的位置，且与单元因子无关）为\n$$\n\\left|\\frac{\\sin\\!\\left(\\frac{N\\alpha}{2}\\right)}{\\sin\\!\\left(\\frac{\\alpha}{2}\\right)}\\right|.\n$$\n主最大值出现在分子最大化而分母不为零或不抑制峰值时。阵列因子的精确最大值发生在\n$$\n\\frac{N\\alpha}{2} = m\\pi,\\quad \\text{其中}\\quad \\alpha \\neq 2\\pi \\ell \\quad \\text{对于会使分子和分母都为零的整数}\\ \\ell\\ \\text{，}\n$$\n更精确地说，主瓣对齐在阵列上的相位递进模$2\\pi$为零的解附近。等价地，主瓣条件是\n$$\n\\alpha = 2\\pi m,\\quad m \\in \\mathbb{Z}.\n$$\n回顾$\\alpha = \\Delta\\phi - k_{\\parallel} d$，瓣的中心满足\n$$\n\\Delta\\phi - k_{\\parallel} d = 2\\pi m \\quad \\Longrightarrow \\quad k_{\\parallel}(m) = \\frac{\\Delta\\phi - 2\\pi m}{d}.\n$$\n在这些值中，主最大值通常取为$k_{\\parallel}$的绝对值最小的那个，即选择使$\\left|k_{\\parallel}(m)\\right|$最小的整数$m$。\n\n对于指定的参数$N=4$，$d=0.65\\ \\text{m}$和$\\Delta\\phi=\\pi/2$，瓣中心的序列为\n$$\nk_{\\parallel}(m) = \\frac{\\frac{\\pi}{2} - 2\\pi m}{0.65}.\n$$\n我们选择$m$以最小化$\\left|k_{\\parallel}(m)\\right|$。测试$m=0$：\n$$\nk_{\\parallel}(0) = \\frac{\\pi/2}{0.65} = \\frac{1.57079632679}{0.65}\\ \\text{rad/m} \\approx 2.41660973353\\ \\text{rad/m}.\n$$\n测试$m=1$：\n$$\nk_{\\parallel}(1) = \\frac{\\frac{\\pi}{2} - 2\\pi}{0.65} = \\frac{-\\frac{3\\pi}{2}}{0.65} \\approx \\frac{-4.71238898038}{0.65} \\approx -7.24982920058\\ \\text{rad/m}.\n$$\n测试$m=-1$：\n$$\nk_{\\parallel}(-1) = \\frac{\\frac{\\pi}{2} + 2\\pi}{0.65} = \\frac{\\frac{5\\pi}{2}}{0.65} \\approx \\frac{7.85398163397}{0.65} \\approx 12.082\\ \\text{rad/m}.\n$$\n显然，最小的绝对值出现在$m=0$时，得到主导瓣接近于\n$$\nk_{\\parallel,\\text{max}} = \\frac{\\pi/2}{0.65}\\ \\text{rad/m}.\n$$\n$k_{\\parallel,\\text{max}}$的符号取决于$\\Delta\\phi$的符号约定。给定$\\Delta\\phi=+\\pi/2$，对于$m=0$，主导瓣位于正$k_{\\parallel}$处。如果将相位定义为渐进延迟，则相反的符号约定可能会产生负值。使用上面建立的约定，我们报告四舍五入到四位有效数字的数值：\n$$\nk_{\\parallel,\\text{max}} \\approx 2.417\\ \\text{rad/m}.\n$$", "answer": "$$\\boxed{2.417}$$", "id": "3704793"}, {"introduction": "发射了具有理想特性的波之后，下一个关键问题是：它能否成功到达等离子体芯部的目标谐振层？本综合练习 [@problem_id:3704788] 将理论推导与编程实践相结合，指导你构建一个WKB模型来分析波在等离子体中的可及性。通过解决这个问题，你将亲身体验如何评估倏逝区（波在其中无法传播）对波功率传输的影响，这是ICRH方案设计中的一个关键步骤。", "problem": "您需要编写一个完整的、可运行的程序，该程序使用一维 Wentzel-Kramers-Brillouin (WKB) 分析，并通过射线追踪的观点确定转折点，以判断在双离子组分冷等离子体中为离子回旋共振加热 (ICRH) 发射的快磁声波是否能到达等离子体中心。物理背景是一个用于描述托卡马克从边界到核心的径向坐标 $x \\in [0,a]$ 的平板模型，其中磁场为常数。该波的特征在于固定的角频率 $\\omega$、由天线谱设定的固定平行折射率 $n_{\\parallel}$，以及由冷等离子体色散关系决定的垂直折射率 $n_{\\perp}(x)$。程序必须计算通过任何 $n_{\\perp}^2(x)  0$ 的消逝区的 WKB 隧穿透射，并且如果透射系数超过指定的阈值，则宣布该波为“可达”。\n\n您必须从以下基本原理出发：\n- 在具有谐波时间依赖性的均匀介质中，麦克斯韦方程组导出一个关于电场的波动方程，该方程可以用介电张量 $\\boldsymbol{\\epsilon}(\\omega)$ 来表示。\n- 对于静态磁场 $\\mathbf{B}$沿固定轴排列的冷磁化等离子体，其介电响应通常通过 Stix 参数 $R$、$L$、$S$、$D$ 和 $P$ 来表示，这些参数由对电子和每种离子组分的求和定义：\n  - $R = 1 - \\sum\\limits_{s} \\dfrac{\\omega_{ps}^2}{\\omega\\left(\\omega + \\Omega_s\\right)}$,\n  - $L = 1 - \\sum\\limits_{s} \\dfrac{\\omega_{ps}^2}{\\omega\\left(\\omega - \\Omega_s\\right)}$,\n  - $S = \\dfrac{R + L}{2}$,\n  - $D = \\dfrac{R - L}{2}$,\n  - $P = 1 - \\sum\\limits_{s} \\dfrac{\\omega_{ps}^2}{\\omega^2}$,\n  其中 $\\omega_{ps}^2 = \\dfrac{n_s q_s^2}{\\varepsilon_0 m_s}$ 是组分 $s$ 的等离子体频率的平方，$\\Omega_s = \\dfrac{q_s B}{m_s}$ 是组分 $s$ 的回旋频率。这里的 $n_s$、$q_s$ 和 $m_s$ 分别是组分 $s$ 的数密度、电荷和质量，$\\varepsilon_0$ 是真空介电常数。\n- 在离子回旋频率范围内，快磁声波遵循一个色散关系，该关系可以通过从冷等离子体介电张量中消去电场极化来获得。在具有固定 $n_{\\parallel}$ 且波斜向于磁场传播的平板中，垂直波数 $k_{\\perp}(x)$ 和折射率 $n_{\\perp}(x) = \\dfrac{c k_{\\perp}(x)}{\\omega}$ 可由此色散关系得出。\n- WKB 转折点出现在 $n_{\\perp}^2(x) = 0$ 的位置。在 $n_{\\perp}^2(x)  0$ 的区间内，波是消逝的，其局部衰减率为 $\\kappa(x) = \\dfrac{\\omega}{c} \\sqrt{-n_{\\perp}^2(x)}$。跨越 $x \\in [x_1, x_2]$ 范围的势垒的 WKB 隧穿透射系数为 $T_{\\mathrm{barrier}} = \\exp\\!\\left(-2 \\int_{x_1}^{x_2} \\kappa(x)\\,dx\\right)$。对于多个不相交的消逝区间，总透射率是各个势垒透射率的乘积。如果总透射率 $T_{\\mathrm{total}}$ 大于或等于给定的阈值，则宣布该波为“可达”。\n\n需要实现的模型假设：\n- 考虑两种离子组分：电荷数为 $Z_{\\mathrm{H}} = 1$、质量为 $m_{\\mathrm{H}}$ 的氢，以及电荷数为 $Z_{\\mathrm{He3}} = 2$、质量为 $m_{\\mathrm{He3}}$ 的氦-3。电子的电荷为 $q_{\\mathrm{e}} = -e$，质量为 $m_{\\mathrm{e}}$。使用国际单位制 (SI) 中的光速 $c$、基本电荷 $e$ 和真空介电常数 $\\varepsilon_0$。\n- 平板在 $x \\in [0,a]$ 范围内延伸，磁场强度 $B$ 为常数。\n- 电子密度剖面为 $n_{\\mathrm{e}}(x) = n_{\\mathrm{e0}}\\left(1 - \\dfrac{x}{a}\\right)$，准中性条件意味着 $n_{\\mathrm{e}}(x) = Z_{\\mathrm{H}} n_{\\mathrm{H}}(x) + Z_{\\mathrm{He3}} n_{\\mathrm{He3}}(x)$。\n- 通过电子电荷分数定义组分：$\\alpha_{\\mathrm{H}}$ 和 $\\alpha_{\\mathrm{He3}}$ 满足 $Z_{\\mathrm{H}} n_{\\mathrm{H}}(x) = \\alpha_{\\mathrm{H}} n_{\\mathrm{e}}(x)$ 和 $Z_{\\mathrm{He3}} n_{\\mathrm{He3}}(x) = \\alpha_{\\mathrm{He3}} n_{\\mathrm{e}}(x)$，且 $\\alpha_{\\mathrm{H}} + \\alpha_{\\mathrm{He3}} = 1$。因此，$n_{\\mathrm{H}}(x) = \\dfrac{\\alpha_{\\mathrm{H}}}{Z_{\\mathrm{H}}} n_{\\mathrm{e}}(x)$ 且 $n_{\\mathrm{He3}}(x) = \\dfrac{\\alpha_{\\mathrm{He3}}}{Z_{\\mathrm{He3}}} n_{\\mathrm{e}}(x)$。\n- 每个测试用例均提供一个固定的平行折射率 $n_{\\parallel}$。\n\n您的任务：\n1. 从上述基本关系出发，推导在离子回旋频率范围内快磁声波的垂直折射率 $n_{\\perp}^2(x)$，用 $R(x)$、$L(x)$、$S(x)$、$P(x)$ 和 $n_{\\parallel}$ 表示，并针对此频率范围进行适当简化。您不能假定任何给定的最终闭合形式表达式；必须从介电响应和色散关系结构中推导出来。\n2. 实现一个一维 WKB 算法，该算法：\n   - 在 $x \\in [0,a]$ 范围内的精细网格上计算 $n_{\\perp}^2(x)$。\n   - 识别 $n_{\\perp}^2(x)  0$ 的消逝区及其转折点（射线追踪的观点是将转折点视为色散面产生反射的点）。\n   - 对每个消逝区计算积分 $\\int \\kappa(x)\\,dx$，并通过将各势垒的透射率相乘来计算总透射率 $T_{\\mathrm{total}}$。\n3. 通过将 $T_{\\mathrm{total}}$ 与固定阈值 $T_{\\mathrm{thr}} = 0.1$ 进行比较来判断“可达性”。\n4. 对每个测试用例，输出一个指示可达性的布尔值。\n\n物理单位和输出：\n- 所有输入和计算均使用国际单位制（米、特斯拉、千克、秒、库仑）。\n- 您的程序应生成单行输出，其中包含一个方括号括起来的逗号分隔列表（例如，“[true,false,true]”）。布尔值必须为小写，并按给定顺序表示每个测试用例的可达性。\n\n测试套件：\n- 为以下四个测试用例实现您的程序，每个用例指定为一个元组 $(a, B, f, n_{\\mathrm{e0}}, n_{\\parallel}, \\alpha_{\\mathrm{H}}, \\alpha_{\\mathrm{He3}})$，其中除无量纲的折射率和分数外，所有量均采用国际单位制：\n- 用例 1：$(0.8, 3.0, 33\\times 10^6, 4.0\\times 10^{19}, 2.0, 0.96, 0.04)$\n- 用例 2：$(0.8, 3.0, 55\\times 10^6, 4.0\\times 10^{19}, 2.0, 0.96, 0.04)$\n- 用例 3：$(0.8, 3.0, 33\\times 10^6, 4.0\\times 10^{19}, 2.0, 0.88, 0.12)$\n- 用例 4：$(0.8, 3.2, 36\\times 10^6, 5.0\\times 10^{19}, 1.2, 0.92, 0.08)$\n\n您的程序必须假定没有用户输入，并且必须以指定格式准确打印一行，其中包含与这些情况相对应的四个布尔值。", "solution": "用户需要一个程序，该程序基于 Wentzel-Kramers-Brillouin (WKB) 分析来确定波在等离子体中的可达性。这需要一个分为两部分的过程：首先，从基本原理推导控制物理方程；其次，设计一个数值算法来求解该方程。\n\n### **第一部分：快波垂直折射率的推导**\n\n问题要求确定快磁声波到达等离子体核心的可达性。这由波的色散关系决定，色散关系指明了波在何处传播、何处消逝。我们将为处于均匀磁场中的冷、多组分等离子体推导此关系。\n\n**1. 磁化等离子体中的波动方程**\n\n我们从麦克斯韦方程组开始，假设时间依赖性为 $e^{-i\\omega t}$ 的谐波形式，适用于无自由电荷或电流的介质。\n$$ \\nabla \\times \\mathbf{E} = i\\omega\\mathbf{B} $$\n$$ \\nabla \\times \\mathbf{B} = -i\\omega\\mu_0\\boldsymbol{\\epsilon}\\cdot\\mathbf{E} $$\n结合这些方程，得到电场 $\\mathbf{E}$ 的波动方程：\n$$ \\nabla \\times (\\nabla \\times \\mathbf{E}) - \\frac{\\omega^2}{c^2}\\boldsymbol{\\epsilon}_r \\cdot \\mathbf{E} = 0 $$\n其中 $\\boldsymbol{\\epsilon}_r$ 是等离子体的相对介电张量，$c = 1/\\sqrt{\\mu_0\\varepsilon_0}$ 是真空中的光速。\n\n对于形式为 $\\mathbf{E}(\\mathbf{r}) = \\mathbf{E}_0 e^{i\\mathbf{k}\\cdot\\mathbf{r}}$ 的平面波，梯度算子 $\\nabla$ 变为 $i\\mathbf{k}$。定义折射率矢量 $\\mathbf{n} = \\frac{c}{\\omega}\\mathbf{k}$，波动方程转换为一个代数方程：\n$$ \\mathbf{n} \\times (\\mathbf{n} \\times \\mathbf{E}) + \\boldsymbol{\\epsilon}_r \\cdot \\mathbf{E} = 0 $$\n这可以写成矩阵形式 $(\\boldsymbol{\\epsilon}_r - n^2\\mathbf{I} + \\mathbf{n}\\mathbf{n}^T)\\cdot\\mathbf{E} = 0$。\n\n**2. 冷等离子体介电张量**\n\n对于处于均匀磁场 $\\mathbf{B}_0 = B\\mathbf{\\hat{z}}$ 中的冷等离子体，其介电张量 $\\boldsymbol{\\epsilon}_r$ 在 Stix 坐标系中由下式给出：\n$$ \\boldsymbol{\\epsilon}_r = \\begin{pmatrix} S  -iD  0 \\\\ iD  S  0 \\\\ 0  0  P \\end{pmatrix} $$\nStix 参数 $S$、$D$ 和 $P$ 由对所有等离子体组分（电子和离子）的求和定义：\n$$ S = 1 - \\sum_s \\frac{\\omega_{ps}^2}{\\omega^2 - \\Omega_s^2} = \\frac{R+L}{2} $$\n$$ D = \\sum_s \\frac{\\Omega_s}{\\omega}\\frac{\\omega_{ps}^2}{\\omega^2 - \\Omega_s^2} = \\frac{R-L}{2} $$\n$$ P = 1 - \\sum_s \\frac{\\omega_{ps}^2}{\\omega^2} $$\n其中 $R$ 和 $L$ 是右旋和左旋极化波的响应：\n$$ R = 1 - \\sum_s \\frac{\\omega_{ps}^2}{\\omega(\\omega + \\Omega_s)}, \\quad L = 1 - \\sum_s \\frac{\\omega_{ps}^2}{\\omega(\\omega - \\Omega_s)} $$\n此处，$\\omega_{ps}^2 = \\frac{n_s q_s^2}{\\varepsilon_0 m_s}$ 是组分 $s$ 的等离子体频率的平方，$\\Omega_s = \\frac{q_s B}{m_s}$ 是组分 $s$ 的回旋频率。\n\n**3. 色散关系**\n\n假设波在 $x-z$ 平面上传播，因此 $\\mathbf{n} = (n_\\perp, 0, n_\\parallel)$。关于 $\\mathbf{E}$ 的矩阵方程变为：\n$$ \\begin{pmatrix}\nS - n_\\parallel^2  -iD  n_\\perp n_\\parallel \\\\\niD  S - n_\\perp^2 - n_\\parallel^2  0 \\\\\nn_\\perp n_\\parallel  0  P - n_\\perp^2\n\\end{pmatrix}\n\\begin{pmatrix} E_x \\\\ E_y \\\\ E_z \\end{pmatrix} = 0\n$$\n仅当矩阵的行列式为零时，$\\mathbf{E}$ 才存在非平凡解。将行列式设为零，即可得到完整的冷等离子体色散关系。\n\n**4. 快波近似**\n\n在离子回旋频率范围 (ICRF) 内，电子质量非常小，这使得 $P$ 中的电子等离子体频率项非常大：$|P| \\approx |\\omega_{pe}^2/\\omega^2| \\gg 1$。完整的色散关系是关于 $n_\\perp^2$ 的三次方程，描述了三种波模。对于快磁声波，平行电场分量 $E_z$ 通常远小于垂直分量。从矩阵方程的第三行，$n_\\perp n_\\parallel E_x + (P - n_\\perp^2) E_z = 0$。由于 $|P|$ 很大，要使 $E_z$ 不可忽略，需要 $n_\\perp^2 \\approx P$。这个条件定义了慢波（在热等离子体中是离子 Bernstein 波）。通过专注于快波，我们假设 $n_\\perp^2$ 的量级不等于 $P$，这意味着 $E_z \\approx 0$。\n当 $E_z=0$ 时，系统简化为左上角的 $2 \\times 2$ 子块：\n$$ \\begin{pmatrix}\nS - n_\\parallel^2  -iD \\\\\niD  S - n_\\perp^2 - n_\\parallel^2\n\\end{pmatrix}\n\\begin{pmatrix} E_x \\\\ E_y \\end{pmatrix} = 0\n$$\n这个较小系统的行列式必须为零：\n$$ (S - n_\\parallel^2)(S - n_\\perp^2 - n_\\parallel^2) - D^2 = 0 $$\n求解 $n_\\perp^2$，我们得到快波的色散关系：\n$$ n_\\perp^2 = S - n_\\parallel^2 - \\frac{D^2}{S - n_\\parallel^2} = \\frac{(S - n_\\parallel^2)^2 - D^2}{S-n_\\parallel^2} $$\n使用恒等式 $S = (R+L)/2$ 和 $D=(R-L)/2$，项 $(S-n_\\parallel^2)^2-D^2$ 可以因式分解为 $(S-D-n_\\parallel^2)(S+D-n_\\parallel^2) = (L-n_\\parallel^2)(R-n_\\parallel^2)$。这得到了需要实现的最终表达式：\n$$ n_\\perp^2(x) = \\frac{(R(x)-n_\\parallel^2)(L(x)-n_\\parallel^2)}{S(x)-n_\\parallel^2} $$\n该表达式通过组分数密度 $n_s(x)$ 依赖于位置 $x$，而数密度决定了 Stix 参数 $R(x)$、$L(x)$ 和 $S(x)$。\n\n### **第二部分：WKB 隧穿算法**\n\nWKB 方法用于分析在缓变介质中的波传播。\n\n**1. 消逝与隧穿**\n\n当波数为实数时，波是传播的，对我们的情况即 $k_\\perp^2  0$ 或 $n_\\perp^2  0$。当波数为虚数时，即 $n_\\perp^2  0$，波是消逝的。$n_\\perp^2(x)=0$ 的点被称为转折点（截止点），它们分隔了传播区和消逝区。\n\n在从 $x_1$ 到 $x_2$ 的消逝区（一个“势垒”）中，波的振幅呈指数衰减。波数的虚部是衰减率 $\\kappa(x) = \\frac{\\omega}{c}\\sqrt{-n_\\perp^2(x)}$。通过单个此类势垒的 WKB 透射系数 $T$ 由下式给出：\n$$ T_{\\mathrm{barrier}} = \\exp(-2\\Gamma), \\quad \\text{其中} \\quad \\Gamma = \\int_{x_1}^{x_2} \\kappa(x)\\,dx $$\n项 $2\\Gamma$ 通常被称为势垒的“光学深度”。如果波遇到多个不相交的消逝区，总透射率是各个透射系数的乘积：\n$$ T_{\\mathrm{total}} = \\prod_j T_{\\mathrm{barrier},j} = \\prod_j \\exp(-2\\Gamma_j) = \\exp\\left(-2 \\sum_j \\Gamma_j\\right) = \\exp\\left(-2 \\int_{\\text{all barriers}} \\kappa(x)\\,dx\\right) $$\n\n**2. 数值实现**\n\n确定可达性的算法如下：\n1.  **离散化域**：在平板域 $x \\in [0, a]$ 上定义一个包含 $N$ 个点的精细、均匀网格 $x_i$。\n2.  **计算 $n_\\perp^2(x)$**：对于网格上的每个点 $x_i$：\n    a. 计算电子密度 $n_{\\mathrm{e}}(x_i) = n_{\\mathrm{e0}}(1 - x_i/a)$。\n    b. 使用给定的电荷分数 $\\alpha_{\\mathrm{H}}$ 和 $\\alpha_{\\mathrm{He3}}$ 计算离子密度 $n_{\\mathrm{H}}(x_i)$ 和 $n_{\\mathrm{He3}}(x_i)$。\n    c. 对于每个组分（电子、H、He3），计算等离子体频率的平方 $\\omega_{ps}^2(x_i)$ 和常数回旋频率 $\\Omega_s$。\n    d. 通过对各组分求和来计算 Stix 参数 $R(x_i), L(x_i), S(x_i)$。\n    e. 使用推导出的色散关系计算 $n_\\perp^2(x_i)$。\n3.  **计算总透射率**：\n    a. 创建一个衰减率数组 $\\kappa(x_i)$。对于每个网格点，如果 $n_\\perp^2(x_i)  0$，则设置 $\\kappa(x_i) = \\frac{\\omega}{c}\\sqrt{-n_\\perp^2(x_i)}$；否则，设置 $\\kappa(x_i) = 0$。\n    b. 使用梯形法则在整个域 $[0, a]$ 上对 $\\kappa(x)$进行数值积分。这等效于对所有单个势垒的积分求和。令结果为 $\\Gamma_{\\mathrm{total}} = \\int_0^a \\kappa(x)\\,dx$。\n    c. 计算总透射系数为 $T_{\\mathrm{total}} = \\exp(-2\\Gamma_{\\mathrm{total}})$。\n4.  **确定可达性**：将总透射率与给定的阈值 $T_{\\mathrm{thr}} = 0.1$ 进行比较。如果 $T_{\\mathrm{total}} \\ge T_{\\mathrm{thr}}$，则波是“可达的”。\n对每个测试用例重复此过程。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n# from scipy import ...\n\ndef solve():\n    \"\"\"\n    Calculates wave accessibility for Ion Cyclotron Resonance Heating (ICRH)\n    in a two-ion-species cold plasma using a WKB model.\n    \"\"\"\n\n    # Physical Constants in SI units\n    C = 299792458.0  # Speed of light\n    E_CHARGE = 1.602176634e-19  # Elementary charge\n    EPSILON_0 = 8.8541878128e-12  # Vacuum permittivity\n    M_E = 9.1093837015e-31  # Electron mass\n    M_H = 1.67262192369e-27  # Hydrogen nucleus mass (proton)\n    M_HE3 = 5.0064127e-27  # Helium-3 nucleus mass\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (a, B, f, n_e0, n_parallel, alpha_H, alpha_He3)\n    test_cases = [\n        (0.8, 3.0, 33e6, 4.0e19, 2.0, 0.96, 0.04),\n        (0.8, 3.0, 55e6, 4.0e19, 2.0, 0.96, 0.04),\n        (0.8, 3.0, 33e6, 4.0e19, 2.0, 0.88, 0.12),\n        (0.8, 3.2, 36e6, 5.0e19, 1.2, 0.92, 0.08),\n    ]\n\n    results = []\n    T_THR = 0.1\n    N_GRID = 2001  # Number of grid points for numerical integration\n\n    for case in test_cases:\n        a, B, f, n_e0, n_parallel, alpha_H, alpha_He3 = case\n        omega = 2.0 * np.pi * f\n\n        # Define species properties: (charge, mass, Z, alpha_fraction_of_electron_charge)\n        species_props = {\n            'e':   (-E_CHARGE, M_E,   -1, 1.0),\n            'H':   (E_CHARGE,  M_H,    1, alpha_H),\n            'He3': (2 * E_CHARGE, M_HE3, 2, alpha_He3)\n        }\n\n        x_grid = np.linspace(0, a, N_GRID)\n        n_perp_sq = np.zeros(N_GRID)\n\n        # Calculate n_perp^2 over the spatial grid\n        for i, x in enumerate(x_grid):\n            # Electron density profile n_e(x) = n_e0 * (1 - x/a)\n            # x=0 is core, x=a is edge.\n            n_e = n_e0 * (1.0 - x / a)\n\n            # At x=a, n_e=0. Handle this case.\n            if n_e == 0:\n                R, L, S = 1.0, 1.0, 1.0\n            else:\n                # Initialize Stix parameters\n                R, L = 1.0, 1.0\n\n                # Sum contributions from all species\n                for _, (q_s, m_s, Z_s, alpha_s) in species_props.items():\n                    omega_c_s = q_s * B / m_s\n                    \n                    if np.abs(omega - omega_c_s)  1e-9: # Avoid numerical singularity at cyclotron resonance\n                         L = np.inf # Divergence\n                         continue\n                    if np.abs(omega + omega_c_s)  1e-9:\n                         R = np.inf # Divergence\n                         continue\n\n                    # Calculate number density n_s from electron density n_e\n                    if Z_s == -1: # Electrons\n                        n_s = n_e\n                    else: # Ions\n                        n_s = (alpha_s / Z_s) * n_e\n\n                    omega_p_s_sq = n_s * q_s**2 / (EPSILON_0 * m_s)\n\n                    R -= omega_p_s_sq / (omega * (omega + omega_c_s))\n                    L -= omega_p_s_sq / (omega * (omega - omega_c_s))\n                \n                S = (R + L) / 2.0\n            \n            # Fast wave dispersion relation: n_perp^2 = (R-n_par^2)(L-n_par^2)/(S-n_par^2)\n            numerator = (R - n_parallel**2) * (L - n_parallel**2)\n            denominator = S - n_parallel**2\n\n            if abs(denominator)  1e-9:\n                # Resonance condition, n_perp^2 -> infinity. Treat as propagating.\n                n_perp_sq[i] = np.sign(numerator * denominator) * 1e12 # large number preserving sign\n            else:\n                n_perp_sq[i] = numerator / denominator\n\n        # Calculate WKB transmission\n        # kappa = (omega/c) * sqrt(-n_perp_sq) for evanescent regions\n        kappa = np.zeros(N_GRID)\n        evan_indices = np.where(n_perp_sq  0)\n        kappa[evan_indices] = (omega / C) * np.sqrt(-n_perp_sq[evan_indices])\n        \n        # Integrate kappa over the domain [0, a] using the trapezoidal rule\n        # This integrates over all evanescent regions at once.\n        total_gamma = np.trapz(kappa, x_grid)\n        \n        # Total transmission coefficient\n        total_transmission = np.exp(-2.0 * total_gamma)\n\n        # Check accessibility\n        is_accessible = total_transmission >= T_THR\n        results.append(str(is_accessible).lower())\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "3704788"}]}