{"hands_on_practices": [{"introduction": "速度分布的矩是表征其物理性质（如平均速率或能量）的关键。本练习将引导你从第一性原理出发，推导麦克斯韦-玻尔兹曼速度分布的通用 $k$ 阶矩的封闭表达式，这需要用到伽马函数这一强大的数学工具 [@problem_id:3725128]。掌握这项技能将为你分析依赖于粒子速率幂次的任何物理量提供一个通用的分析框架。", "problem": "考虑一个在磁约束核聚变等离子体中的非相对论性、各向同性的单一离子种群，理想化为处于温度 $T$ 的热平衡状态下的经典理想气体。设离子质量为 $m$。其平衡速度分布源于正则系综，并取决于动能 $K = \\frac{1}{2} m v^{2}$，其中 $v = |\\mathbf{v}|$ 是速率，$\\mathbf{v}$ 是速度矢量。\n\n从第一性原理出发：\n- 使用经典理想气体的正则系综，构建三维速度空间上的概率密度函数 (PDF) $f_{\\mathbf{v}}(\\mathbf{v})$，并通过施加条件 $\\int_{\\mathbb{R}^{3}} f_{\\mathbf{v}}(\\mathbf{v})\\,d^{3}v = 1$ 来确定其归一化常数。\n- 从 $f_{\\mathbf{v}}(\\mathbf{v})$ 出发，通过援引各向同性假设和球速度坐标系中的测度，推导速率分布 $f_{v}(v)$ (对于 $v \\ge 0$）。\n- 对于整数 $n \\ge 0$ 和参数 $a > 0$，仅使用能将其化为标准特殊函数的变换和定义来计算高斯型积分\n$$\n\\int_{0}^{\\infty} v^{n} \\exp\\!\\left(-a v^{2}\\right)\\,dv\n$$\n。提供一个闭合形式的解，并找出连续整数 $n$ 所遵循的任何递推关系。\n- 应用您的结果，计算对于整数 $k \\ge 0$ 的一般 $k$ 阶速率矩\n$$\n\\langle v^{k} \\rangle \\equiv \\int_{0}^{\\infty} v^{k}\\, f_{v}(v)\\,dv\n$$\n，用 $k$、玻尔兹曼常数 $k_{B}$、温度 $T$ 和质量 $m$ 来表示。\n\n将 $\\langle v^{k} \\rangle$ 的最终结果表示为单个闭合形式的解析表达式。不要提供数值。不要在最终表达式中包含单位。", "solution": "该问题在科学上是适定且自洽的。我们将按照指定的步骤进行严格的推导。\n\n首先，我们为处于热平衡状态的单一离子种群构建速度概率密度函数 (PDF) $f_{\\mathbf{v}}(\\mathbf{v})$。该系统被建模为经典理想气体，适用正则系综。在正则系综中，具有能量 $E$ 的微观状态的概率与玻尔兹曼因子 $\\exp(-E / (k_{B}T))$ 成正比，其中 $k_{B}$ 是玻尔兹曼常数， $T$ 是温度。对于理想气体中质量为 $m$ 的非相对论性粒子，其能量纯粹是动能，$E = K = \\frac{1}{2}m|\\mathbf{v}|^{2}$，其中 $\\mathbf{v} = (v_x, v_y, v_z)$ 是速度矢量。\n\n因此，速度PDF $f_{\\mathbf{v}}(\\mathbf{v})$ 与此玻尔兹曼因子成正比：\n$$\nf_{\\mathbf{v}}(\\mathbf{v}) = C \\exp\\left(-\\frac{\\frac{1}{2}m|\\mathbf{v}|^{2}}{k_{B}T}\\right) = C \\exp\\left(-\\frac{m(v_x^{2} + v_y^{2} + v_z^{2})}{2k_{B}T}\\right)\n$$\n其中 $C$ 是归一化常数。该常数由所有可能速度上的总概率为1的条件确定：\n$$\n\\int_{\\mathbb{R}^{3}} f_{\\mathbf{v}}(\\mathbf{v})\\,d^{3}v = 1\n$$\n代入 $f_{\\mathbf{v}}(\\mathbf{v})$ 的表达式，并注意到积分可以分解为三个笛卡尔速度分量上的积分：\n$$\nC \\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{mv_x^{2}}{2k_{B}T}\\right)dv_x \\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{mv_y^{2}}{2k_{B}T}\\right)dv_y \\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{mv_z^{2}}{2k_{B}T}\\right)dv_z = 1\n$$\n这些积分中的每一个都是标准的高斯积分，形式为 $\\int_{-\\infty}^{\\infty} \\exp(-ax^{2})dx = \\sqrt{\\pi/a}$。在我们的情况下，参数 $a$ 为 $a = \\frac{m}{2k_{B}T}$。\n因此，每个积分的计算结果为 $\\sqrt{\\frac{\\pi}{m/(2k_{B}T)}} = \\sqrt{\\frac{2\\pi k_{B}T}{m}}$。归一化条件变为：\n$$\nC \\left(\\sqrt{\\frac{2\\pi k_{B}T}{m}}\\right)^{3} = C \\left(\\frac{2\\pi k_{B}T}{m}\\right)^{3/2} = 1\n$$\n解出 $C$，我们得到归一化常数：\n$$\nC = \\left(\\frac{m}{2\\pi k_{B}T}\\right)^{3/2}\n$$\n因此，完全归一化的三维速度分布为：\n$$\nf_{\\mathbf{v}}(\\mathbf{v}) = \\left(\\frac{m}{2\\pi k_{B}T}\\right)^{3/2} \\exp\\left(-\\frac{m|\\mathbf{v}|^{2}}{2k_{B}T}\\right)\n$$\n这就是麦克斯韦-玻尔兹曼速度分布。\n\n接下来，我们推导速率分布 $f_{v}(v)$ (对于 $v \\ge 0$）。各向同性的假设意味着 $f_{\\mathbf{v}}(\\mathbf{v})$ 仅取决于速度的大小 $v = |\\mathbf{v}|$，我们推导出的形式也证实了这一点。为了找到粒子速率在区间 $[v, v+dv]$ 内的概率，我们在速度空间中对半径为 $v$、厚度为 $dv$ 的球壳体积进行速度PDF积分。在球速度坐标系中，体积元为 $d^{3}v = v^{2}\\sin\\theta\\,dv\\,d\\theta\\,d\\phi$。\n概率 $f_v(v)dv$ 由下式给出：\n$$\nf_v(v)dv = \\left( \\int_{0}^{2\\pi} \\int_{0}^{\\pi} f_{\\mathbf{v}}(v,\\theta,\\phi) v^{2}\\sin\\theta\\,d\\theta\\,d\\phi \\right) dv\n$$\n由于 $f_{\\mathbf{v}}$ 仅依赖于 $v$，我们可以将其从角度积分中提取出来：\n$$\nf_v(v)dv = f_{\\mathbf{v}}(v) v^{2} \\left( \\int_{0}^{2\\pi} d\\phi \\int_{0}^{\\pi} \\sin\\theta\\,d\\theta \\right) dv\n$$\n角度积分的计算结果为 $2\\pi [-\\cos\\theta]_{0}^{\\pi} = 2\\pi(1 - (-1)) = 4\\pi$。因此，球壳的体积为 $4\\pi v^{2}dv$。速率分布为：\n$$\nf_v(v) = 4\\pi v^{2} f_{\\mathbf{v}}(v) = 4\\pi v^{2} \\left(\\frac{m}{2\\pi k_{B}T}\\right)^{3/2} \\exp\\left(-\\frac{mv^{2}}{2k_{B}T}\\right)\n$$\n这就是麦克斯韦-玻尔兹曼速率分布。\n\n现在我们来处理一般积分 $I_{n} = \\int_{0}^{\\infty} v^{n} \\exp(-av^{2})\\,dv$ 的计算，其中整数 $n \\ge 0$ 且 $a > 0$。我们使用换元法，令 $x = av^{2}$。这意味着 $v = \\sqrt{x/a} = a^{-1/2}x^{1/2}$，微分变为 $dv = \\frac{1}{2}a^{-1/2}x^{-1/2}dx$。积分上下限保持为从 $0$ 到 $\\infty$。\n将这些代入积分：\n$$\nI_{n} = \\int_{0}^{\\infty} (a^{-1/2}x^{1/2})^{n} \\exp(-x) \\left(\\frac{1}{2}a^{-1/2}x^{-1/2}\\right) dx\n$$\n$$\nI_{n} = \\frac{1}{2}a^{-n/2}a^{-1/2} \\int_{0}^{\\infty} x^{n/2}x^{-1/2} \\exp(-x) dx = \\frac{1}{2}a^{-(n+1)/2} \\int_{0}^{\\infty} x^{(n-1)/2} \\exp(-x) dx\n$$\n右边的积分是欧拉伽马函数的定义，$\\Gamma(z) = \\int_{0}^{\\infty} t^{z-1}\\exp(-t)dt$。在这里，宗量为 $z = \\frac{n-1}{2} + 1 = \\frac{n+1}{2}$。\n因此，积分的闭合形式为：\n$$\nI_n = \\int_{0}^{\\infty} v^{n} \\exp(-av^{2})\\,dv = \\frac{1}{2} a^{-(n+1)/2} \\Gamma\\left(\\frac{n+1}{2}\\right)\n$$\n对于 $n \\ge 2$，可以使用分部积分法找到一个递推关系：\n$$\nI_{n} = \\int_{0}^{\\infty} v^{n-1} (v \\exp(-av^{2}))\\,dv = \\left[v^{n-1}\\left(-\\frac{1}{2a}\\exp(-av^{2})\\right)\\right]_{0}^{\\infty} + \\frac{n-1}{2a} \\int_{0}^{\\infty} v^{n-2} \\exp(-av^{2}) \\,dv\n$$\n边界项为零，从而得到递推关系 $I_{n} = \\frac{n-1}{2a}I_{n-2}$。\n\n最后，我们应用此结果来计算一般 $k$ 阶速率矩 $\\langle v^{k} \\rangle$，其定义为：\n$$\n\\langle v^{k} \\rangle = \\int_{0}^{\\infty} v^{k} f_{v}(v) dv\n$$\n代入 $f_v(v)$ 的表达式：\n$$\n\\langle v^{k} \\rangle = \\int_{0}^{\\infty} v^{k} \\left[4\\pi v^{2} \\left(\\frac{m}{2\\pi k_{B}T}\\right)^{3/2} \\exp\\left(-\\frac{mv^{2}}{2k_{B}T}\\right)\\right] dv\n$$\n合并项并从积分中提取常数：\n$$\n\\langle v^{k} \\rangle = 4\\pi \\left(\\frac{m}{2\\pi k_{B}T}\\right)^{3/2} \\int_{0}^{\\infty} v^{k+2} \\exp\\left(-\\frac{mv^{2}}{2k_{B}T}\\right) dv\n$$\n这个积分是 $I_{n}$ 的形式，其中 $n = k+2$ 且 $a = \\frac{m}{2k_{B}T}$。使用我们推导出的 $I_n$ 公式：\n$$\n\\int_{0}^{\\infty} v^{k+2} \\exp\\left(-\\frac{mv^{2}}{2k_{B}T}\\right)dv = \\frac{1}{2} \\left(\\frac{m}{2k_{B}T}\\right)^{-(k+2+1)/2} \\Gamma\\left(\\frac{k+2+1}{2}\\right)\n$$\n$$\n= \\frac{1}{2} \\left(\\frac{m}{2k_{B}T}\\right)^{-(k+3)/2} \\Gamma\\left(\\frac{k+3}{2}\\right)\n$$\n现在，将此结果代回 $\\langle v^{k} \\rangle$ 的表达式中：\n$$\n\\langle v^{k} \\rangle = 4\\pi \\left(\\frac{m}{2\\pi k_{B}T}\\right)^{3/2} \\left[\\frac{1}{2} \\left(\\frac{m}{2k_{B}T}\\right)^{-(k+3)/2} \\Gamma\\left(\\frac{k+3}{2}\\right)\\right]\n$$\n为清晰起见，我们简化表达式。设 $\\beta = \\frac{m}{2k_{B}T}$。\n$$\n\\langle v^{k} \\rangle = 4\\pi \\left(\\frac{\\beta}{\\pi}\\right)^{3/2} \\frac{1}{2} \\beta^{-(k+3)/2} \\Gamma\\left(\\frac{k+3}{2}\\right) = 2\\pi \\frac{\\beta^{3/2}}{\\pi^{3/2}} \\beta^{-(k+3)/2} \\Gamma\\left(\\frac{k+3}{2}\\right)\n$$\n$$\n\\langle v^{k} \\rangle = \\frac{2}{\\sqrt{\\pi}} \\beta^{3/2 - (k+3)/2} \\Gamma\\left(\\frac{k+3}{2}\\right) = \\frac{2}{\\sqrt{\\pi}} \\beta^{-k/2} \\Gamma\\left(\\frac{k+3}{2}\\right)\n$$\n将 $\\beta = \\frac{m}{2k_{B}T}$ 代回：\n$$\n\\langle v^{k} \\rangle = \\frac{2}{\\sqrt{\\pi}} \\left(\\frac{m}{2k_{B}T}\\right)^{-k/2} \\Gamma\\left(\\frac{k+3}{2}\\right) = \\frac{2}{\\sqrt{\\pi}} \\left(\\frac{2k_{B}T}{m}\\right)^{k/2} \\Gamma\\left(\\frac{k+3}{2}\\right)\n$$\n这就是麦克斯韦-玻尔兹曼分布速率的 $k$ 阶矩的最终闭合形式表达式。", "answer": "$$\n\\boxed{\\frac{2}{\\sqrt{\\pi}} \\left(\\frac{2 k_{B} T}{m}\\right)^{k/2} \\Gamma\\left(\\frac{k+3}{2}\\right)}\n$$", "id": "3725128"}, {"introduction": "麦克斯韦-玻尔兹曼分布是一个经典的统计模型，因此，理解其适用范围至关重要。本练习将引入热德布罗意波长作为衡量粒子量子效应的尺度，并通过计算简并参数来判断经典近似的有效性 [@problem_id:3725143]。你将通过对典型聚变等离子体的具体计算，亲手验证为何其中的离子可以用经典统计进行描述，从而加深对物理模型基本假设的理解。", "problem": "在典型的磁约束聚变全电离氘氚等离子体中，通过推导和评估相应的量子-经典跨界参数，判断离子布居是否可以用麦克斯韦-玻尔兹曼（MB）统计来描述。从单个质量为 $m$、温度为 $T$ 的非相对论性粒子的经典平动配分函数出发，该函数是通过在动量空间中对玻尔兹曼因子进行积分构建的，其中量子相空间元的体积为 $h^{3}$，$h$ 是普朗克常数。定义热德布罗意波长 $\\lambda_{\\mathrm{th}}$，使得单粒子配分函数的形式为 $Z_{1}=V/\\lambda_{\\mathrm{th}}^{3}$，并用它来获得以数密度 $n$ 表示的经典性判据。\n\n然后，对于温度 $T=10\\ \\mathrm{keV}$ 的单电荷氘离子和氚离子，使用下面给出的离子静止质量计算每种离子的 $\\lambda_{\\mathrm{th}}$，并在代表性的核心等离子体密度 $n=1.0\\times 10^{20}\\ \\mathrm{m}^{-3}$ 下评估简并参数 $g \\equiv n\\,\\lambda_{\\mathrm{th}}^{3}$。根据你的推导，解释为什么 $g \\ll 1$ 意味着MB统计对离子是有效的。使用以下常量：\n- 普朗克常数 $h=6.62607015\\times 10^{-34}\\ \\mathrm{J\\cdot s}$，\n- 元电荷 $e=1.602176634\\times 10^{-19}\\ \\mathrm{C}$（因此 $1\\ \\mathrm{eV}=e\\ \\mathrm{J}$），\n- 氘核质量 $m_{\\mathrm{D}}=3.343583719\\times 10^{-27}\\ \\mathrm{kg}$，\n- 氚核质量 $m_{\\mathrm{T}}=5.0073567446\\times 10^{-27}\\ \\mathrm{kg}$。\n\n将离子视为非相对论性的，并忽略电子的量子统计。将中间波长以米为单位表示。对于最终报告的结果，提供两个离子简并参数 $g=n\\,\\lambda_{\\mathrm{th}}^{3}$ 中较大的一个的数值（即 $\\lambda_{\\mathrm{th}}$ 较大的离子种类）。将此最终报告值四舍五入到四位有效数字，并将其表示为纯数（无量纲）。", "solution": "首先，根据所需标准对问题进行验证。\n\n### 步骤1：提取给定条件\n- **等离子体成分**：全电离氘氚等离子体。\n- **物理背景**：磁约束聚变。\n- **任务**：判断离子布居是否可以用麦克斯韦-玻尔兹曼（MB）统计来描述。\n- **方法论**：推导和评估一个量子-经典跨界参数。\n- **出发点**：单个质量为 $m$、温度为 $T$ 的非相对论性粒子的经典平动配分函数，该函数是通过在动量空间中对玻尔兹曼因子进行积分构建的，其中量子相空间元的体积为 $h^{3}$。\n- **定义1**：热德布罗意波长 $\\lambda_{\\mathrm{th}}$ 的定义使得单粒子配分函数的形式为 $Z_{1}=V/\\lambda_{\\mathrm{th}}^{3}$。\n- **目标1**：获得以数密度 $n$ 表示的经典性判据。\n- **计算参数**：\n  - 离子种类：单电荷氘和氚。\n  - 温度：$T=10\\ \\mathrm{keV}$。\n  - 数密度：$n=1.0\\times 10^{20}\\ \\mathrm{m}^{-3}$。\n- **定义2**：简并参数 $g \\equiv n\\,\\lambda_{\\mathrm{th}}^{3}$。\n- **目标2**：计算每种离子的 $\\lambda_{\\mathrm{th}}$。\n- **目标3**：在给定的密度 $n$ 下评估简并参数 $g$。\n- **目标4**：解释为什么 $g \\ll 1$ 意味着MB统计的有效性。\n- **常量**：\n  - 普朗克常数：$h=6.62607015\\times 10^{-34}\\ \\mathrm{J\\cdot s}$。\n  - 元电荷：$e=1.602176634\\times 10^{-19}\\ \\mathrm{C}$。\n  - 氘核质量：$m_{\\mathrm{D}}=3.343583719\\times 10^{-27}\\ \\mathrm{kg}$。\n  - 氚核质量：$m_{\\mathrm{T}}=5.0073567446\\times 10^{-27}\\ \\mathrm{kg}$。\n- **假设**：离子是非相对论性的；忽略电子的量子统计。\n- **最终结果说明**：提供两个离子简并参数中较大的一个的数值，四舍五入到四位有效数字。\n\n### 步骤2：使用提取的给定条件进行验证\n- **科学依据**：该问题在标准统计力学和等离子体物理学方面有充分的依据。配分函数、热德布罗意波长和简并参数的概念是评估多体系统中量子效应的基本工具。物理背景（聚变等离子体）和所提供的参数（$T$、$n$、离子质量）都是符合实际的。\n- **问题的适定性**：该问题是适定的。它提供了执行所需推导和计算的所有必要信息、定义和常量。目标明确，解决方案的路径逻辑结构清晰。存在唯一且有意义的解。\n- **客观性**：问题以精确、客观和科学的语言陈述，没有任何主观或模棱两可的术语。\n- **完整性与一致性**：问题是自洽的。提供的常量和参数是充分的。等离子体物理学中以能量单位（电子伏特）指定温度这一不合时宜但常见的做法，通过元电荷 $e$ 隐式定义，其中热能为 $k_B T = 10\\ \\mathrm{keV}$。这是一个标准惯例，不会使问题变得不完整。没有内部矛盾。\n\n### 步骤3：结论与行动\n该问题是**有效的**，因为它在科学上是合理的、适定的且完整的。我们可以继续进行求解。\n\n### 经典性判据的推导\n对于体积为 $V$、温度为 $T$ 的系统中，单个质量为 $m$ 的非相对论性粒子的经典平动配分函数 $Z_1$，由对所有可能的位置和动量进行积分给出。为了考虑相空间的量子化，该积分除以 $h^3$，其中 $h$ 是普朗克常数。\n非相对论性粒子的能量纯粹是动能，$E=p^{2}/(2m)$。配分函数为：\n$$ Z_1 = \\frac{1}{h^3} \\int \\exp\\left(-\\frac{E}{k_B T}\\right) d^3x d^3p = \\frac{1}{h^3} \\int d^3x \\int d^3p \\, \\exp\\left(-\\frac{p^2}{2mk_B T}\\right) $$\n对空间坐标 $d^3x$ 的积分得到体积 $V$。\n$$ Z_1 = \\frac{V}{h^3} \\int_{-\\infty}^{\\infty} \\int_{-\\infty}^{\\infty} \\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{p_x^2 + p_y^2 + p_z^2}{2mk_B T}\\right) dp_x dp_y dp_z $$\n这是三个形式为 $\\int_{-\\infty}^{\\infty} \\exp(-ax^2) dx = \\sqrt{\\pi/a}$ 的相同高斯积分的乘积。当 $a = 1/(2mk_B T)$ 时，每个积分得到 $\\sqrt{2\\pi mk_B T}$。\n$$ Z_1 = \\frac{V}{h^3} \\left(\\sqrt{2\\pi mk_B T}\\right)^3 = \\frac{V}{h^3} (2\\pi mk_B T)^{3/2} $$\n问题通过关系式 $Z_1 = V/\\lambda_{\\mathrm{th}}^3$ 定义了热德布罗意波长 $\\lambda_{\\mathrm{th}}$。将两个 $Z_1$ 的表达式相等：\n$$ \\frac{V}{\\lambda_{\\mathrm{th}}^3} = \\frac{V (2\\pi mk_B T)^{3/2}}{h^3} $$\n解出 $\\lambda_{\\mathrm{th}}$：\n$$ \\lambda_{\\mathrm{th}} = \\frac{h}{\\sqrt{2\\pi mk_B T}} $$\n这个波长 $\\lambda_{\\mathrm{th}}$ 代表了温度为 $T$ 的热系综中粒子的特征德布罗意波长。\n\n当可以忽略粒子的量子性质时，麦克斯韦-玻尔兹曼统计适用。这种情况发生在粒子平均相距足够远，以至于它们的量子波包没有显著重叠。在数密度为 $n$ 的系统中，每个粒子的平均体积为 $1/n$。因此，特征粒子间距为 $d \\sim n^{-1/3}$。当 $\\lambda_{\\mathrm{th}}$ 变得与 $d$ 相当或更大时，量子效应变得不可忽略。因此，MB统计有效的经典（非量子）区域对应于以下条件：\n$$ \\lambda_{\\mathrm{th}} \\ll n^{-1/3} $$\n两边取立方得到 $\\lambda_{\\mathrm{th}}^3 \\ll 1/n$，可以重新整理以定义经典性判据：\n$$ n \\lambda_{\\mathrm{th}}^3 \\ll 1 $$\n量 $g \\equiv n \\lambda_{\\mathrm{th}}^3$ 是简并参数。条件 $g \\ll 1$ 表示该系统是非简并的或“经典的”，因此其组成粒子可以用麦克斯韦-玻尔兹曼统计来描述。\n\n### 对氘氚等离子体的数值评估\n首先，我们将给定的温度转换为以SI单位表示的热能。\n$$ k_B T = 10\\ \\mathrm{keV} = 10 \\times 10^3 \\ \\mathrm{eV} = 10^4 \\times (1.602176634\\times 10^{-19}\\ \\mathrm{J}) = 1.602176634\\times 10^{-15}\\ \\mathrm{J} $$\n现在我们使用公式 $\\lambda_{\\mathrm{th}} = h/\\sqrt{2\\pi m k_B T}$ 计算氘核和氚核离子的热德布罗意波长。\n\n对于氘核 ($D^{+}$)：\n$m_{\\mathrm{D}}=3.343583719\\times 10^{-27}\\ \\mathrm{kg}$。\n$$ \\lambda_{\\mathrm{th, D}} = \\frac{6.62607015\\times 10^{-34}\\ \\mathrm{J\\cdot s}}{\\sqrt{2\\pi (3.343583719\\times 10^{-27}\\ \\mathrm{kg})(1.602176634\\times 10^{-15}\\ \\mathrm{J})}} $$\n$$ \\lambda_{\\mathrm{th, D}} = \\frac{6.62607015\\times 10^{-34}}{\\sqrt{3.3644919 \\times 10^{-41}}} \\ \\mathrm{m} = \\frac{6.62607015\\times 10^{-34}}{5.8004240\\times 10^{-21}}\\ \\mathrm{m} $$\n$$ \\lambda_{\\mathrm{th, D}} \\approx 1.1423447\\times 10^{-13}\\ \\mathrm{m} $$\n\n对于氚核 ($T^{+}$)：\n$m_{\\mathrm{T}}=5.0073567446\\times 10^{-27}\\ \\mathrm{kg}$。\n$$ \\lambda_{\\mathrm{th, T}} = \\frac{6.62607015\\times 10^{-34}\\ \\mathrm{J\\cdot s}}{\\sqrt{2\\pi (5.0073567446\\times 10^{-27}\\ \\mathrm{kg})(1.602176634\\times 10^{-15}\\ \\mathrm{J})}} $$\n$$ \\lambda_{\\mathrm{th, T}} = \\frac{6.62607015\\times 10^{-34}}{\\sqrt{5.0388610 \\times 10^{-41}}} \\ \\mathrm{m} = \\frac{6.62607015\\times 10^{-34}}{7.1009584\\times 10^{-21}}\\ \\mathrm{m} $$\n$$ \\lambda_{\\mathrm{th, T}} \\approx 9.331323\\times 10^{-14}\\ \\mathrm{m} $$\n\n题目要求两个离子简并参数中较大的一个。由于 $g = n \\lambda_{\\mathrm{th}}^3$ 且 $\\lambda_{\\mathrm{th}} \\propto m^{-1/2}$，较轻的粒子（氘核）将具有较大的 $\\lambda_{\\mathrm{th}}$，因此也具有较大的简并参数 $g$。\n\n我们使用 $n=1.0\\times 10^{20}\\ \\mathrm{m}^{-3}$ 计算氘核的 $g_{\\mathrm{D}}$。\n$$ g_{\\mathrm{D}} = n \\lambda_{\\mathrm{th, D}}^3 = (1.0\\times 10^{20}\\ \\mathrm{m}^{-3}) \\times (1.1423447\\times 10^{-13}\\ \\mathrm{m})^3 $$\n$$ g_{\\mathrm{D}} = (1.0\\times 10^{20}) \\times (1.490793 \\times 10^{-39})\\ \\mathrm{m^3 \\cdot m^{-3}} $$\n$$ g_{\\mathrm{D}} \\approx 1.490793 \\times 10^{-19} $$\n$g_{\\mathrm{D}}$ 的值非常小，$g_{\\mathrm{D}} \\ll 1$。这证实了经典性条件得到了充分满足。因此，聚变等离子体中的氘和氚离子布居可以准确地用麦克斯韦-玻尔兹曼统计来描述。\n\n将结果四舍五入到四位有效数字，得到 $1.491 \\times 10^{-19}$。", "answer": "$$\n\\boxed{1.491 \\times 10^{-19}}\n$$", "id": "3725143"}, {"introduction": "现代等离子体物理学在很大程度上依赖于计算机模拟，而这些模拟需要根据特定的分布函数生成大量粒子。本练习将理论与实践相结合，指导你设计一个蒙特卡罗算法，用于从麦克斯韦-玻尔兹曼分布中抽样生成粒子速度 [@problem_id:3725144]。你还将推导相关统计矩的解析表达式，并将其与模拟结果进行比较，从而验证算法的正确性，掌握将理论模型应用于计算科学的关键技能。", "problem": "设计并实现一个完整的蒙特卡洛（MC）算法，用于从热平衡（麦克斯韦-玻尔兹曼）分布中抽样三维粒子速度，以供在粒子模拟（PIC）中使用，并验证抽样得到的统计矩与从正则系综中解析推导出的值一致。背景设定为核聚变等离子体，且必须使用国际单位制（SI）表示。\n\n仅从以下基础和核心定义出发，不预设或引用任何最终目标公式：\n- 正则系综，其哈密顿量为 $H = \\sum_{i=1}^{3} \\dfrac{p_i^2}{2 m}$，适用于质量为 $m$ 的单个粒子，其中 $p_i$ 是动量分量。\n- 正则系综的玻尔兹曼因子为 $\\exp\\!\\left(- H / (k_{\\mathrm{B}} T)\\right)$，其中 $k_{\\mathrm{B}}$ 是玻尔兹曼常数，$T$ 是绝对温度。\n- 速度的定义为 $v_i = p_i / m$，并通过均匀漂移速度 $\\boldsymbol{u}$ 进行伽利略变换，以模拟漂移平衡。\n- 数密度 $n$ 和动能密度 $\\mathcal{E} = \\dfrac{1}{2} m n \\,\\mathbb{E}\\!\\left[\\lVert \\boldsymbol{v} \\rVert^2\\right]$ 的定义。\n- 高斯极限定理，作为生成正态随机变量的依据。\n- 样本均值、无偏样本方差和均值标准误的统计定义。\n\n您的任务是：\n1. 从正则系综基础出发，推导在温度为 $T$、均匀漂移为 $\\boldsymbol{u}$ 的热平衡状态下，单个粒子三个笛卡尔速度分量的抽样分布，并指定一个生成 $\\boldsymbol{v} \\in \\mathbb{R}^3$ 的蒙特卡洛样本的算法。您的算法必须仅使用独立的标准正态变量和仿射变换来实现。所有符号结果需使用 $m$、$T$、$k_{\\mathrm{B}}$ 和 $\\boldsymbol{u}$ 表示。\n2. 以闭合形式推导以下平衡矩的解析表达式，用 $m$、$T$、$k_{\\mathrm{B}}$ 和 $\\boldsymbol{u}$ 表示：\n   - 平均速度矢量 $\\mathbb{E}[\\boldsymbol{v}]$。\n   - 各分量的方差 $\\mathrm{Var}(v_i)$。\n   - 均方速率 $\\mathbb{E}\\!\\left[\\lVert \\boldsymbol{v} \\rVert^2\\right]$。\n   - 均方速率的方差 $\\mathrm{Var}\\!\\left(\\lVert \\boldsymbol{v} \\rVert^2\\right)$，用于量化 $\\mathbb{E}\\!\\left[\\lVert \\boldsymbol{v} \\rVert^2\\right]$ 的蒙特卡洛估计量的抽样不确定性。\n   - 动能密度 $\\mathcal{E}$。\n3. 实现一个程序，该程序能够：\n   - 对下述每个测试用例，使用带有固定种子的伪随机数生成器生成 $N$ 个独立同分布的样本 $\\{\\boldsymbol{v}^{(j)}\\}_{j=1}^N$，以确保可复现性。\n   - 计算经验平均矢量 $\\widehat{\\boldsymbol{v}} = \\dfrac{1}{N} \\sum_{j=1}^N \\boldsymbol{v}^{(j)}$。\n   - 计算各分量的无偏样本方差 $\\widehat{\\sigma}_i^2 = \\dfrac{1}{N-1} \\sum_{j=1}^N \\left(v_i^{(j)} - \\widehat{v}_i\\right)^2$，其中 $i \\in \\{x,y,z\\}$。\n   - 计算经验均方速率 $\\widehat{S}_2 = \\dfrac{1}{N} \\sum_{j=1}^N \\lVert \\boldsymbol{v}^{(j)} \\rVert^2$。\n   - 计算经验动能密度 $\\widehat{\\mathcal{E}} = \\dfrac{1}{2} m n \\widehat{S}_2$。\n   - 基于您推导的抽样分布，使用标准化差异（z-score）来量化一致性：\n     - 对每个分量 $i$，检验 $\\left|\\widehat{v}_i - u_i\\right| \\leq z_{\\star} \\sqrt{\\mathrm{Var}(v_i)/N}$。\n     - 对每个分量 $i$，使用正态分布下无偏样本方差的精确方差，检验 $\\left|\\widehat{\\sigma}_i^2 - \\mathrm{Var}(v_i)\\right| \\leq z_{\\star} \\,\\sqrt{\\mathrm{Var}(\\widehat{\\sigma}_i^2)}$。\n     - 检验 $\\left|\\widehat{S}_2 - \\mathbb{E}\\!\\left[\\lVert \\boldsymbol{v} \\rVert^2\\right]\\right| \\leq z_{\\star} \\sqrt{\\mathrm{Var}\\!\\left(\\lVert \\boldsymbol{v} \\rVert^2\\right)/N}$。\n     - 使用从 $\\mathrm{Var}\\!\\left(\\lVert \\boldsymbol{v} \\rVert^2\\right)$ 传播得到的方差，检验 $\\left|\\widehat{\\mathcal{E}} - \\mathcal{E}\\right| \\leq z_{\\star} \\,\\sqrt{\\mathrm{Var}\\!\\left(\\widehat{\\mathcal{E}}\\right)}$。\n   - 使用标准化阈值 $z_{\\star} = 5$。\n   - 所有速度单位为 $\\mathrm{m/s}$，质量单位为 $\\mathrm{kg}$，温度单位为电子伏特（通过 $1\\,\\mathrm{eV} = 1.602176634 \\times 10^{-19}\\,\\mathrm{J}$ 转换为焦耳），数密度单位为 $\\mathrm{m^{-3}}$，能量密度单位为 $\\mathrm{J/m^3}$。\n   - 将伪随机数种子设置为 $s = 123456789$。\n4. 对每个测试用例，按以下固定顺序生成一个包含四个布尔值的列表，表示四项检查是否通过：\n   - 平均矢量检查。\n   - 各分量方差检查（所有三个分量都必须通过）。\n   - 均方速率检查。\n   - 动能密度检查。\n   将所有测试用例的结果汇总到一个列表的列表中。\n\n测试套件：\n- 测试用例 A（电子，零漂移，中等温度）：\n  - 物种质量 $m = 9.1093837015 \\times 10^{-31}\\,\\mathrm{kg}$。\n  - 温度 $T = 100\\,\\mathrm{eV}$。\n  - 数密度 $n = 1.0 \\times 10^{19}\\,\\mathrm{m^{-3}}$。\n  - 漂移 $\\boldsymbol{u} = (0,0,0)\\,\\mathrm{m/s}$。\n  - 样本数 $N = 200000$。\n- 测试用例 B（氘核，有限漂移，高温）：\n  - 物种质量 $m = 3.343583719 \\times 10^{-27}\\,\\mathrm{kg}$。\n  - 温度 $T = 10000\\,\\mathrm{eV}$。\n  - 数密度 $n = 1.0 \\times 10^{20}\\,\\mathrm{m^{-3}}$。\n  - 漂移 $\\boldsymbol{u} = (10^{5},0,0)\\,\\mathrm{m/s}$。\n  - 样本数 $N = 200000$。\n- 测试用例 C（氚核，零漂移，低温）：\n  - 物种质量 $m = 5.007356665 \\times 10^{-27}\\,\\mathrm{kg}$。\n  - 温度 $T = 1\\,\\mathrm{eV}$。\n  - 数密度 $n = 5.0 \\times 10^{20}\\,\\mathrm{m^{-3}}$。\n  - 漂移 $\\boldsymbol{u} = (0,0,0)\\,\\mathrm{m/s}$。\n  - 样本数 $N = 200000$。\n- 测试用例 D（电子，多轴漂移，较高温度）：\n  - 物种质量 $m = 9.1093837015 \\times 10^{-31}\\,\\mathrm{kg}$。\n  - 温度 $T = 1000\\,\\mathrm{eV}$。\n  - 数密度 $n = 1.0 \\times 10^{19}\\,\\mathrm{m^{-3}}$。\n  - 漂移 $\\boldsymbol{u} = (2.0 \\times 10^{6}, -2.0 \\times 10^{6}, 1.0 \\times 10^{6})\\,\\mathrm{m/s}$。\n  - 样本数 $N = 200000$。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，每个条目对应一个测试用例，其本身是按上述顺序排列的四个布尔值的列表。例如，一个有效的输出结构是 $[ [b_{A1}, b_{A2}, b_{A3}, b_{A4}], [b_{B1}, b_{B2}, b_{B3}, b_{B4}], [b_{C1}, b_{C2}, b_{C3}, b_{C4}], [b_{D1}, b_{D2}, b_{D3}, b_{D4}] ]$，其中每个 $b_{\\cdot}$ 是 $\\mathrm{True}$ 或 $\\mathrm{False}$。", "solution": "该问题要求推导并实现一个用于麦克斯韦-玻尔兹曼速度分布的蒙特卡洛抽样算法，然后根据其解析推导的对应值对抽样矩进行统计验证。\n\n### 1. 抽样算法的推导\n\n问题从质量为 $m$、哈密顿量为 $H = \\sum_{i=1}^{3} p_i^2 / (2m)$ 的单个粒子的正则系综出发，其中 $\\boldsymbol{p} = (p_x, p_y, p_z)$ 是粒子的动量。粒子处于动量为 $\\boldsymbol{p}$ 的微观状态的概率与玻尔兹曼因子 $f(\\boldsymbol{p}) \\propto \\exp(-H / (k_{\\mathrm{B}} T))$ 成正比。这里，$k_{\\mathrm{B}}$ 是玻尔兹曼常数，$T$ 是绝对温度。能量尺度 $k_{\\mathrm{B}} T$ 以电子伏特为单位的温度 $T_{\\text{eV}}$ 给出，并被转换为焦耳，因此我们用 $T_{\\text{J}} = T_{\\text{eV}} \\times e$ 代替 $k_{\\mathrm{B}} T$，其中 $e$ 是元电荷。\n\n代入哈密顿量，动量矢量 $\\boldsymbol{p}$ 的概率密度函数（PDF）为：\n$$\nf(\\boldsymbol{p}) \\propto \\exp\\left(-\\frac{p_x^2 + p_y^2 + p_z^2}{2m (k_{\\mathrm{B}} T)}\\right) = \\exp\\left(-\\frac{p_x^2}{2m k_{\\mathrm{B}} T}\\right) \\exp\\left(-\\frac{p_y^2}{2m k_{\\mathrm{B}} T}\\right) \\exp\\left(-\\frac{p_z^2}{2m k_{\\mathrm{B}} T}\\right)\n$$\n这表明动量分量 $p_x$、$p_y$ 和 $p_z$ 是统计独立的。每个分量 $p_i$ 的 PDF 形式为 $f(p_i) \\propto \\exp(-p_i^2 / (2\\sigma_p^2))$，这是一个均值为 $0$、方差为 $\\sigma_p^2 = m k_{\\mathrm{B}} T$ 的高斯（正态）分布。\n\n速度分量 $v_i$ 通过 $v_i = p_i / m$ 与动量分量相关。由于 $p_i$ 是一个正态分布的随机变量，$v_i$ 也服从正态分布。$v_i$ 的均值为 $\\mathbb{E}[v_i] = \\mathbb{E}[p_i/m] = 0/m = 0$。$v_i$ 的方差为 $\\mathrm{Var}(v_i) = \\mathrm{Var}(p_i/m) = \\mathrm{Var}(p_i)/m^2 = (m k_{\\mathrm{B}} T)/m^2 = k_{\\mathrm{B}} T / m$。我们将此方差定义为 $\\sigma_v^2 \\equiv k_{\\mathrm{B}} T / m$。\n\n这描述了粒子静止参考系中的热速度分布。为考虑流体的宏观运动，我们通过一个均匀漂移速度 $\\boldsymbol{u} = (u_x, u_y, u_z)$ 进行伽利略变换。实验室参考系中的速度 $\\boldsymbol{v}$ 是热速度 $\\boldsymbol{v}'$ 和漂移速度 $\\boldsymbol{u}$ 的和：$\\boldsymbol{v} = \\boldsymbol{v}' + \\boldsymbol{u}$。\n实验室参考系速度的分量为 $v_i = v_i' + u_i$。由于 $v_i' \\sim \\mathcal{N}(0, \\sigma_v^2)$，每个分量 $v_i$ 服从正态分布：\n$$\nv_i \\sim \\mathcal{N}(u_i, \\sigma_v^2) = \\mathcal{N}\\left(u_i, \\frac{k_{\\mathrm{B}} T}{m}\\right)\n$$\n为从此分布生成样本，我们可以使用标准正态变量的仿射变换。设 $Z_i \\sim \\mathcal{N}(0,1)$ 是三个独立的标准正态随机变量。我们可以将每个速度分量 $v_i$ 生成为：\n$$\nv_i = u_i + \\sqrt{\\frac{k_{\\mathrm{B}} T}{m}} Z_i\n$$\n这提供了抽样速度矢量 $\\boldsymbol{v}$ 的完整算法：\n1. 计算热速度参数（热速度分量的标准差），$v_{\\text{th}} = \\sqrt{k_{\\mathrm{B}} T / m}$。\n2. 从标准正态分布 $\\mathcal{N}(0,1)$ 中生成三个独立的随机数 $Z_x, Z_y, Z_z$。\n3. 构造速度矢量 $\\boldsymbol{v} = (v_x, v_y, v_z)$ 如下：\n   $v_x = u_x + v_{\\text{th}} Z_x$\n   $v_y = u_y + v_{\\text{th}} Z_y$\n   $v_z = u_z + v_{\\text{th}} Z_z$\n\n### 2. 解析矩的推导\n\n我们推导所需的解析矩以供验证。设 $\\sigma^2 = k_{\\mathrm{B}} T / m$。速度分量 $v_i \\sim \\mathcal{N}(u_i, \\sigma^2)$ 并且是独立的。\n\n- **平均速度矢量 $\\mathbb{E}[\\boldsymbol{v}]$**：\n每个分量的期望是 $\\mathbb{E}[v_i] = u_i$。因此，平均速度矢量就是漂移速度：\n$$\n\\mathbb{E}[\\boldsymbol{v}] = \\boldsymbol{u}\n$$\n\n- **各分量的方差 $\\mathrm{Var}(v_i)$**：\n每个分量的方差根据定义就是其所抽样的正态分布的方差：\n$$\n\\mathrm{Var}(v_i) = \\sigma^2 = \\frac{k_{\\mathrm{B}} T}{m} \\quad \\text{for } i \\in \\{x,y,z\\}\n$$\n\n- **均方速率 $\\mathbb{E}\\!\\left[\\lVert \\boldsymbol{v} \\rVert^2\\right]$**：\n均方速率为 $\\lVert \\boldsymbol{v} \\rVert^2 = v_x^2 + v_y^2 + v_z^2$。根据期望的线性性，$\\mathbb{E}[\\lVert \\boldsymbol{v} \\rVert^2] = \\sum_{i=x,y,z} \\mathbb{E}[v_i^2]$。\n使用关系式 $\\mathbb{E}[X^2] = \\mathrm{Var}(X) + (\\mathbb{E}[X])^2$，我们有 $\\mathbb{E}[v_i^2] = \\mathrm{Var}(v_i) + (\\mathbb{E}[v_i])^2 = \\sigma^2 + u_i^2$。\n对各分量求和：\n$$\n\\mathbb{E}[\\lVert \\boldsymbol{v} \\rVert^2] = (\\sigma^2 + u_x^2) + (\\sigma^2 + u_y^2) + (\\sigma^2 + u_z^2) = 3\\sigma^2 + \\lVert \\boldsymbol{u} \\rVert^2 = 3\\frac{k_{\\mathrm{B}} T}{m} + \\lVert \\boldsymbol{u} \\rVert^2\n$$\n\n- **动能密度 $\\mathcal{E}$**：\n使用其定义 $\\mathcal{E} = \\frac{1}{2} m n \\,\\mathbb{E}\\!\\left[\\lVert \\boldsymbol{v} \\rVert^2\\right]$，我们代入上述结果：\n$$\n\\mathcal{E} = \\frac{1}{2} m n \\left(3\\frac{k_{\\mathrm{B}} T}{m} + \\lVert \\boldsymbol{u} \\rVert^2\\right) = \\frac{3}{2} n k_{\\mathrm{B}} T + \\frac{1}{2} m n \\lVert \\boldsymbol{u} \\rVert^2\n$$\n\n- **均方速率的方差 $\\mathrm{Var}\\!\\left(\\lVert \\boldsymbol{v} \\rVert^2\\right)$**：\n令 $S_2 = \\lVert \\boldsymbol{v} \\rVert^2 = \\sum_i v_i^2$。我们需要 $\\mathrm{Var}(S_2)$。由于分量 $v_i$ 是独立的，它们的和的方差是它们方差的和：$\\mathrm{Var}(S_2) = \\sum_i \\mathrm{Var}(v_i^2)$。\n我们需要 $\\mathrm{Var}(v_i^2) = \\mathbb{E}[v_i^4] - (\\mathbb{E}[v_i^2])^2$。\n对于一个正态变量 $X \\sim \\mathcal{N}(\\mu, \\sigma^2)$，其中心矩为 $\\mathbb{E}[(X-\\mu)^2] = \\sigma^2$ 和 $\\mathbb{E}[(X-\\mu)^4] = 3\\sigma^4$。\n我们展开 $v_i = u_i + v_i'$，其中 $v_i' \\sim \\mathcal{N}(0, \\sigma^2)$。\n$\\mathbb{E}[v_i^4] = \\mathbb{E}[(u_i + v_i')^4] = u_i^4 + 6u_i^2\\mathbb{E}[(v_i')^2] + \\mathbb{E}[(v_i')^4] = u_i^4 + 6u_i^2\\sigma^2 + 3\\sigma^4$。\n我们已知 $\\mathbb{E}[v_i^2] = u_i^2 + \\sigma^2$。\n所以，$\\mathrm{Var}(v_i^2) = (u_i^4 + 6u_i^2\\sigma^2 + 3\\sigma^4) - (u_i^2 + \\sigma^2)^2 = (u_i^4 + 6u_i^2\\sigma^2 + 3\\sigma^4) - (u_i^4 + 2u_i^2\\sigma^2 + \\sigma^4) = 4u_i^2\\sigma^2 + 2\\sigma^4$。\n对 $i=x,y,z$ 求和：\n$$\n\\mathrm{Var}(\\lVert \\boldsymbol{v} \\rVert^2) = \\sum_i (4u_i^2\\sigma^2 + 2\\sigma^4) = 4\\sigma^2 \\sum_i u_i^2 + \\sum_i 2\\sigma^4 = 4\\sigma^2 \\lVert \\boldsymbol{u} \\rVert^2 + 6\\sigma^4\n$$\n代入 $\\sigma^2 = k_{\\mathrm{B}} T / m$：\n$$\n\\mathrm{Var}(\\lVert \\boldsymbol{v} \\rVert^2) = 4\\frac{k_{\\mathrm{B}} T}{m} \\lVert \\boldsymbol{u} \\rVert^2 + 6\\left(\\frac{k_{\\mathrm{B}} T}{m}\\right)^2\n$$\n\n### 3. 统计验证\n\n蒙特卡洛模拟生成一个包含 $N$ 个速度的样本 $\\{\\boldsymbol{v}^{(j)}\\}_{j=1}^N$。我们计算矩的经验估计值，并检验它们是否落在解析值的统计预期范围内。检验基于中心极限定理，形成 z-score 并使用 $z_{\\star} = 5$ 的阈值。\n\n1.  **平均速度**：经验均值为 $\\widehat{v}_i = \\frac{1}{N}\\sum_j v_i^{(j)}$。均值的标准误为 $\\sqrt{\\mathrm{Var}(v_i)/N}$。对每个分量的检验是 $|\\widehat{v}_i - u_i| \\le z_{\\star} \\sqrt{\\mathrm{Var}(v_i)/N}$。\n\n2.  **各分量方差**：无偏样本方差为 $\\widehat{\\sigma}_i^2 = \\frac{1}{N-1}\\sum_j (v_i^{(j)} - \\widehat{v}_i)^2$。对于来自正态分布 $\\mathcal{N}(\\mu, \\sigma^2)$ 的样本，样本方差的方差为 $\\mathrm{Var}(\\widehat{\\sigma}_i^2) = \\frac{2(\\mathrm{Var}(v_i))^2}{N-1}$。检验为 $|\\widehat{\\sigma}_i^2 - \\mathrm{Var}(v_i)| \\le z_{\\star} \\sqrt{2(\\mathrm{Var}(v_i))^2 / (N-1)}$。\n\n3.  **均方速率**：经验均值为 $\\widehat{S}_2 = \\frac{1}{N}\\sum_j \\lVert \\boldsymbol{v}^{(j)} \\rVert^2$。该均值的标准误为 $\\sqrt{\\mathrm{Var}(\\lVert \\boldsymbol{v} \\rVert^2)/N}$。检验为 $|\\widehat{S}_2 - \\mathbb{E}[\\lVert \\boldsymbol{v} \\rVert^2]| \\le z_{\\star} \\sqrt{\\mathrm{Var}(\\lVert \\boldsymbol{v} \\rVert^2)/N}$。\n\n4.  **动能密度**：经验估计值为 $\\widehat{\\mathcal{E}} = \\frac{1}{2} m n \\widehat{S}_2$。作为 $\\widehat{S}_2$ 的线性缩放，其检验等价于对均方速率的检验。估计量的方差为 $\\mathrm{Var}(\\widehat{\\mathcal{E}}) = \\mathrm{Var}(\\frac{1}{2} m n \\widehat{S}_2) = (\\frac{1}{2} m n)^2 \\mathrm{Var}(\\widehat{S}_2) = (\\frac{1}{2} m n)^2 \\frac{\\mathrm{Var}(\\lVert \\boldsymbol{v} \\rVert^2)}{N}$。检验 $|\\widehat{\\mathcal{E}} - \\mathcal{E}| \\le z_{\\star}\\sqrt{\\mathrm{Var}(\\widehat{\\mathcal{E}})}$ 可简化为对 $\\widehat{S}_2$ 的检验。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the particle velocity sampling and verification problem.\n    \"\"\"\n    # Define constants\n    E_CHARGE = 1.602176634e-19  # Elementary charge in Coulombs\n    SEED = 123456789\n    Z_STAR = 5.0\n\n    # Define the test cases from the problem statement\n    test_cases = [\n        {\n            \"name\": \"A\",\n            \"m\": 9.1093837015e-31,  # Electron mass (kg)\n            \"T_eV\": 100.0,\n            \"n\": 1.0e19,\n            \"u\": np.array([0.0, 0.0, 0.0]),\n            \"N\": 200000\n        },\n        {\n            \"name\": \"B\",\n            \"m\": 3.343583719e-27,   # Deuteron mass (kg)\n            \"T_eV\": 10000.0,\n            \"n\": 1.0e20,\n            \"u\": np.array([1.0e5, 0.0, 0.0]),\n            \"N\": 200000\n        },\n        {\n            \"name\": \"C\",\n            \"m\": 5.007356665e-27,   # Triton mass (kg)\n            \"T_eV\": 1.0,\n            \"n\": 5.0e20,\n            \"u\": np.array([0.0, 0.0, 0.0]),\n            \"N\": 200000\n        },\n        {\n            \"name\": \"D\",\n            \"m\": 9.1093837015e-31,  # Electron mass (kg)\n            \"T_eV\": 1000.0,\n            \"n\": 1.0e19,\n            \"u\": np.array([2.0e6, -2.0e6, 1.0e6]),\n            \"N\": 200000\n        }\n    ]\n\n    # Initialize a pseudorandom number generator with a fixed seed\n    rng = np.random.default_rng(SEED)\n    \n    results = []\n\n    for case in test_cases:\n        m, T_eV, n, u, N = case[\"m\"], case[\"T_eV\"], case[\"n\"], case[\"u\"], case[\"N\"]\n\n        # --- 1. Analytical Moment Calculations ---\n        k_B_T = T_eV * E_CHARGE\n        \n        # Per-component variance\n        var_v_analytic = k_B_T / m\n        \n        # Mean velocity vector (is just u)\n        mean_v_analytic = u\n        \n        # Mean squared speed\n        u_sq_norm = np.sum(u**2)\n        mean_sq_speed_analytic = 3 * var_v_analytic + u_sq_norm\n        \n        # Variance of squared speed\n        var_sq_speed_analytic = 4 * var_v_analytic * u_sq_norm + 6 * var_v_analytic**2\n        \n        # Kinetic energy density\n        energy_density_analytic = 0.5 * m * n * mean_sq_speed_analytic\n\n        # --- 2. Monte Carlo Sampling ---\n        v_th = np.sqrt(var_v_analytic)\n        thermal_velocities = v_th * rng.standard_normal(size=(N, 3))\n        velocities = u + thermal_velocities\n\n        # --- 3. Empirical Moment Calculations ---\n        # Empirical mean vector\n        mean_v_empirical = np.mean(velocities, axis=0)\n        \n        # Empirical per-component variance (unbiased)\n        var_v_empirical = np.var(velocities, axis=0, ddof=1)\n        \n        # Empirical mean squared speed\n        sq_speeds = np.sum(velocities**2, axis=1)\n        mean_sq_speed_empirical = np.mean(sq_speeds)\n\n        # Empirical kinetic energy density\n        energy_density_empirical = 0.5 * m * n * mean_sq_speed_empirical\n\n        # --- 4. Statistical Verification Checks ---\n        \n        # Check 1: Mean vector\n        std_err_mean_v = np.sqrt(var_v_analytic / N)\n        # Avoid division by zero if std_err is zero (e.g., T=0)\n        z_scores_mean = np.zeros(3)\n        if std_err_mean_v > 0:\n            z_scores_mean = np.abs(mean_v_empirical - mean_v_analytic) / std_err_mean_v\n        check_mean_vector = np.all(z_scores_mean = Z_STAR)\n\n        # Check 2: Per-component variance\n        var_of_sample_var = 2 * var_v_analytic**2 / (N - 1)\n        std_err_var_v = np.sqrt(var_of_sample_var)\n        z_scores_var = np.zeros(3)\n        if std_err_var_v > 0:\n             z_scores_var = np.abs(var_v_empirical - var_v_analytic) / std_err_var_v\n        check_variance = np.all(z_scores_var = Z_STAR)\n\n        # Check 3: Mean squared speed\n        std_err_mean_sq_speed = np.sqrt(var_sq_speed_analytic / N)\n        z_score_sq_speed = 0.0\n        if std_err_mean_sq_speed > 0:\n            z_score_sq_speed = np.abs(mean_sq_speed_empirical - mean_sq_speed_analytic) / std_err_mean_sq_speed\n        check_mean_sq_speed = z_score_sq_speed = Z_STAR\n        \n        # Check 4: Kinetic energy density\n        var_of_E_hat = (0.5 * m * n)**2 * var_sq_speed_analytic / N\n        std_err_E = np.sqrt(var_of_E_hat)\n        z_score_E = 0.0\n        if std_err_E > 0:\n            z_score_E = np.abs(energy_density_empirical - energy_density_analytic) / std_err_E\n        check_energy_density = z_score_E = Z_STAR\n        \n        results.append([\n            bool(check_mean_vector),\n            bool(check_variance),\n            bool(check_mean_sq_speed),\n            bool(check_energy_density)\n        ])\n\n    # Final print statement in the exact required format.\n    # The format [ [b1, b2, ...], [b1, b2, ...] ] requires spaces after commas.\n    # The str() representation of a list of lists matches this format.\n    print(str(results).replace(\"'\", \"\"))\n\nsolve()\n```", "id": "3725144"}]}