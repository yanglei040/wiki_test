{"hands_on_practices": [{"introduction": "理解波在多孔岩石中的传播方式，是地震勘探和储层监测等地球物理应用的基础。本练习旨在引导您深入探索流体混合物（例如水和气）的存在如何显著改变岩石的声学特性。通过从第一性原理推导波速并进行数值计算，您将获得一个切实的理解：为何即使是微量的气体，也可能导致地震响应出现剧烈变化，这对于含气储层的识别至关重要 [@problem_id:3611820]。", "problem": "一种线性的、各向同性的、可变形的多孔岩石被水和气体这两种不混溶的相所饱和。考虑在足够高的频率下的小振幅一维（1D）压缩压力扰动，使得（i）在一个波周期内，相与固体骨架之间的达西型相对流动可以忽略不计，以及（ii）剪切效应可以忽略不计。在每个相都处于正压、等温极限的情况下进行分析。假设在扰动尺度上，孔隙尺度的毛细管压力变化可以忽略不计，并且骨架连接良好，因此可以用一个单一的孔隙压力场 $p(x,t)$ 来表征这些扰动。\n\n从混合物的线动量守恒和孔隙中流体的质量守恒出发，结合线性可压缩性定义和 Biot 多孔弹性框架，推导这些压力扰动的传播速度上限 $c$ 的一个显式表达式，该表达式用混合物密度 $\\rho_{\\text{mix}}$ 和单位体积的总储存可压缩性 $C_{t}$ 表示。你的推导应从以下几点开始：\n- 混合物在一维情况下的线动量守恒，\n- 体积应变率和速度散度之间的运动学关系，\n- 流体和固体颗粒的线性可压缩性定义，以及\n- Biot 系数 $\\alpha$ 和固体颗粒体积模量 $K_{s}$。\n\n证明在这个压力主导、无滑移的极限下，波速可以写成“经典”声学形式 $c = \\sqrt{M/\\rho_{\\text{mix}}}$，其中 $M$ 是一个适当的水力模量，你必须用孔隙度 $\\phi$、Biot 系数 $\\alpha$、固体颗粒体积模量 $K_{s}$、流体相体积模量 $K_{w}$ 和 $K_{g}$（或等效地，它们的可压缩性）以及饱和度 $S_{w}$ 和 $S_{g}$ 来表示。\n\n然后，使用以下参数计算双相情况下的波速 $c$ 的数值，这些参数代表了储层条件下的富石英砂岩：\n- 孔隙度：$\\phi = 0.20$。\n- Biot 系数：$\\alpha = 1.00$。\n- 固体颗粒体积模量：$K_{s} = 36 \\times 10^{9}$ Pa。\n- 水的可压缩性：$C_{w} = 4.5 \\times 10^{-10}$ Pa$^{-1}$ (等效于 $K_{w} = 1/C_{w}$)。\n- 气体的可压缩性：$C_{g} = 1.0 \\times 10^{-7}$ Pa$^{-1}$ (等效于 $K_{g} = 1/C_{g}$)。\n- 饱和度：$S_{w} = 0.70$, $S_{g} = 0.30$。\n- 密度：$\\rho_{s} = 2650$ kg m$^{-3}$, $\\rho_{w} = 1000$ kg m$^{-3}$, $\\rho_{g} = 100$ kg m$^{-3}$。\n\n对于混合物密度，使用体积分数平均值 $\\rho_{\\text{mix}} = (1-\\phi)\\,\\rho_{s} + \\phi\\,(S_{w}\\,\\rho_{w} + S_{g}\\,\\rho_{g})$。将双相波速 $c$ 的最终答案以 m s$^{-1}$ 为单位表示，并四舍五入到四位有效数字。\n\n为了提供参考，请在推导中说明当 $S_{w}=1$ 和 $S_{g}=0$ 时的单相极限如何简化为“经典”形式 $c = \\sqrt{M/\\rho}$；但是，最终数值答案只需报告双相波速 $c$。", "solution": "### I. 波动方程的推导\n\n我们首先建立在指定极限下波传播的控制方程。问题描述了一个一维压力扰动。我们考虑一个在 $x$ 方向上传播的平面波，其中 $v(x,t)$ 是混合物（由于无滑移条件，固体和流体相一起移动）的速度。\n\n**1. 线动量守恒**\n整体混合物的线动量守恒的一维方程为：\n$$ \\frac{\\partial \\sigma_{xx}}{\\partial x} = \\rho_{\\text{mix}} \\frac{\\partial v}{\\partial t} $$\n其中 $\\sigma_{xx}$ 是 $x$ 方向上的总应力，$\\rho_{\\text{mix}}$ 是总混合物密度。问题指定了一个“压力主导”的极限。这意味着总应力主要由孔隙压力 $p$ 引起，而由固体骨架支撑的偏应力可以忽略不计。因此，我们近似为 $\\sigma_{xx} \\approx -p$。动量方程简化为一维欧拉方程：\n$$ -\\frac{\\partial p}{\\partial x} = \\rho_{\\text{mix}} \\frac{\\partial v}{\\partial t} $$\n\n**2. 质量守恒**\n混合物的一维连续性方程为：\n$$ \\frac{\\partial \\rho_{\\text{mix}}}{\\partial t} + \\frac{\\partial (\\rho_{\\text{mix}} v)}{\\partial x} = 0 $$\n对于静止状态（$\\rho_0, v_0=0$）周围的小振幅扰动，此方程线性化为：\n$$ \\frac{\\partial \\rho_{\\text{mix}}}{\\partial t} + \\rho_0 \\frac{\\partial v}{\\partial x} = 0 $$\n我们引入混合物的总可压缩性 $C_t$，它将混合物密度的变化与压力的变化联系起来：\n$$ \\frac{1}{\\rho_{\\text{mix}}} \\frac{d\\rho_{\\text{mix}}}{dp} = C_t \\implies d\\rho_{\\text{mix}} = \\rho_{\\text{mix}} C_t dp $$\n对于小扰动，其速率形式为 $\\frac{\\partial \\rho_{\\text{mix}}}{\\partial t} = \\rho_{\\text{mix}} C_t \\frac{\\partial p}{\\partial t}$。将其代入线性化的连续性方程，得到：\n$$ \\rho_{\\text{mix}} C_t \\frac{\\partial p}{\\partial t} + \\rho_{\\text{mix}} \\frac{\\partial v}{\\partial x} = 0 $$\n$$ \\frac{\\partial p}{\\partial t} = -\\frac{1}{C_t} \\frac{\\partial v}{\\partial x} $$\n\n**3. 波动方程与速度**\n我们现在有一个由两个耦合的一阶偏微分方程组成的系统：\n$$ (1) \\quad \\frac{\\partial p}{\\partial x} = -\\rho_{\\text{mix}} \\frac{\\partial v}{\\partial t} $$\n$$ (2) \\quad \\frac{\\partial p}{\\partial t} = -\\frac{1}{C_t} \\frac{\\partial v}{\\partial x} $$\n为了推导波动方程，我们对（1）式关于 $x$ 求导，对（2）式关于 $t$ 求导：\n$$ \\frac{\\partial^2 p}{\\partial x^2} = -\\rho_{\\text{mix}} \\frac{\\partial^2 v}{\\partial x \\partial t} $$\n$$ \\frac{\\partial^2 p}{\\partial t^2} = -\\frac{1}{C_t} \\frac{\\partial^2 v}{\\partial t \\partial x} $$\n令 $v$ 的混合偏导数表达式相等，得到一维声学波动方程：\n$$ \\frac{\\partial^2 p}{\\partial x^2} = \\rho_{\\text{mix}} C_t \\frac{\\partial^2 p}{\\partial t^2} $$\n这个方程描述了波的传播，其速度 $c$ 由以下公式给出：\n$$ c^2 = \\frac{1}{\\rho_{\\text{mix}} C_t} $$\n这个表达式可以写成经典声学形式 $c = \\sqrt{M/\\rho_{\\text{mix}}}$，其中混合物的有效模量为 $M = 1/C_t$。\n\n### II. 水力模量 $M$ 的推导\n\n我们现在的任务是推导总可压缩性 $C_t$ 的表达式。它被定义为单位压力 $p$ 变化引起的体积极分数变化 $V_b$：\n$$ C_t = -\\frac{1}{V_b} \\frac{dV_b}{dp} $$\n在假设的极限下（压力主导，弱骨架），外部施加的压力完全传递给组成部分。体积变化 $dV_b$ 是固体颗粒体积变化（$dV_s$）和孔隙流体体积变化（$dV_{fluid}$ 取为孔隙体积 $dV_p$）的总和。\n$$ dV_b = dV_s + dV_p $$\n固体相和流体相的体积变化由它们各自的可压缩性 $C_s=1/K_s$ 和 $C_f=1/K_f$ 定义：\n$$ dV_s = -V_s C_s dp = -(1-\\phi)V_b C_s dp $$\n$$ dV_p = -V_p C_f dp = -\\phi V_b C_f dp $$\n将这些相加得到总体积变化：\n$$ dV_b = - ( (1-\\phi)C_s + \\phi C_f ) V_b dp $$\n由此，我们得到总可压缩性：\n$$ C_t = -\\frac{1}{V_b}\\frac{dV_b}{dp} = (1-\\phi)C_s + \\phi C_f $$\n这是组分可压缩性的 Reuss 平均值。流体相本身是水和气的混合物。其有效可压缩性 $C_f$ 是单个流体可压缩性的饱和度加权平均值（另一个 Reuss 平均值）：\n$$ C_f = S_w C_w + S_g C_g $$\n将此代入 $C_t$ 的表达式中：\n$$ C_t = (1-\\phi)C_s + \\phi(S_w C_w + S_g C_g) $$\n水力模量 $M$ 是这个总可压缩性的倒数：\n$$ M = \\frac{1}{C_t} = \\frac{1}{(1-\\phi)C_s + \\phi(S_w C_w + S_g C_g)} $$\n用体积模量（$K_i = 1/C_i$）表示：\n$$ M = \\frac{1}{\\frac{1-\\phi}{K_s} + \\phi\\left(\\frac{S_w}{K_w} + \\frac{S_g}{K_g}\\right)} $$\n这是饱和岩石有效模量的 Reuss 界，也称为 Wood 方程。$\\alpha=1$ 的假设与此极限一致，因为它意味着固体骨架刚度非常弱或不存在（$K_{drained} \\ll K_s$）。\n\n**单相极限**：对于仅被水饱和的岩石，$S_w=1$ 且 $S_g=0$。模量 $M$ 变为：\n$$ M_{single} = \\frac{1}{\\frac{1-\\phi}{K_s} + \\frac{\\phi}{K_w}} $$\n波速为 $c_{single} = \\sqrt{M_{single}/\\rho_{\\text{mix}}}$，其中 $\\rho_{\\text{mix}} = (1-\\phi)\\rho_s + \\phi\\rho_w$。\n\n### III. 数值计算\n\n我们现在计算给定双相情况下的波速 $c$。\n\n**1. 混合物密度 $\\rho_{\\text{mix}}$：**\n$$ \\rho_{\\text{mix}} = (1-\\phi)\\rho_{s} + \\phi(S_{w}\\rho_{w} + S_{g}\\rho_{g}) $$\n$$ \\rho_{\\text{mix}} = (1-0.20)(2650) + 0.20(0.70 \\times 1000 + 0.30 \\times 100) $$\n$$ \\rho_{\\text{mix}} = 0.80 \\times 2650 + 0.20(700 + 30) = 2120 + 0.20(730) $$\n$$ \\rho_{\\text{mix}} = 2120 + 146 = 2266 \\, \\text{kg m}^{-3} $$\n\n**2. 总可压缩性 $C_t$**：\n首先，求出颗粒材料的可压缩性 $C_s$：\n$$ C_s = \\frac{1}{K_s} = \\frac{1}{36 \\times 10^{9} \\, \\text{Pa}} \\approx 2.7778 \\times 10^{-11} \\, \\text{Pa}^{-1} $$\n接下来，计算有效流体可压缩性 $C_f$：\n$$ C_f = S_w C_w + S_g C_g $$\n$$ C_f = (0.70)(4.5 \\times 10^{-10} \\, \\text{Pa}^{-1}) + (0.30)(1.0 \\times 10^{-7} \\, \\text{Pa}^{-1}) $$\n$$ C_f = 3.15 \\times 10^{-10} \\, \\text{Pa}^{-1} + 3.0 \\times 10^{-8} \\, \\text{Pa}^{-1} $$\n$$ C_f = 0.315 \\times 10^{-9} \\, \\text{Pa}^{-1} + 30.0 \\times 10^{-9} \\, \\text{Pa}^{-1} = 3.0315 \\times 10^{-8} \\, \\text{Pa}^{-1} $$\n最后，计算总混合物可压缩性 $C_t$：\n$$ C_t = (1-\\phi)C_s + \\phi C_f $$\n$$ C_t = (0.80)(2.7778 \\times 10^{-11}) + (0.20)(3.0315 \\times 10^{-8}) $$\n$$ C_t \\approx 2.2222 \\times 10^{-11} + 6.063 \\times 10^{-9} $$\n$$ C_t \\approx 0.02222 \\times 10^{-9} + 6.063 \\times 10^{-9} = 6.08522 \\times 10^{-9} \\, \\text{Pa}^{-1} $$\n\n**3. 波速 $c$**：\n$$ c = \\sqrt{\\frac{1}{\\rho_{\\text{mix}} C_t}} $$\n$$ c = \\sqrt{\\frac{1}{(2266)(6.08522 \\times 10^{-9})}} $$\n$$ c = \\sqrt{\\frac{1}{1.37912 \\times 10^{-5}}} \\approx \\sqrt{72509.5} $$\n$$ c \\approx 269.2759 \\, \\text{m s}^{-1} $$\n四舍五入到四位有效数字，波速为 $269.3 \\, \\text{m s}^{-1}$。这种低速度是含有自由气相的多孔介质中波传播的特征，因为自由气相使得孔隙流体具有极高的可压缩性。", "answer": "$$\n\\boxed{269.3}\n$$", "id": "3611820"}, {"introduction": "在掌握了多孔介质的宏观物理性质后，下一个关键步骤是理解其力学失效过程。本练习将重点从整体响应转移到裂缝的萌生——这是水力压裂等工程应用中的核心环节，并引入了强大的相场模型方法。通过建立弹性能释放与裂缝表面能消耗之间的平衡，本练习将帮助您理解材料的内在强度是如何在一个特征长度尺度 $\\ell$ 上由能量竞争决定的 [@problem_id:3611805]。", "problem": "考虑一个平面应变下的二维矩形多孔弹性域 $\\Omega = (0,W) \\times (0,H)$，其杨氏模量为 $E$，泊松比为 $\\nu$，Biot系数为 $\\alpha \\in (0,1]$。该域初始无应力，且不含任何预存裂纹或缺口。在整个孔隙空间中施加一个均匀的流体孔隙压力 $p_f$（例如，通过注入），使得固体骨架中的有效柯西应力遵循Biot有效应力原理 $\\boldsymbol{\\sigma}' = \\boldsymbol{\\sigma} - \\alpha p_f \\mathbf{I}$。在没有外部牵引力的情况下，$\\boldsymbol{\\sigma} = \\boldsymbol{0}$，因此 $\\boldsymbol{\\sigma}' = -\\alpha p_f \\mathbf{I}$。\n\n假设一个由标量相场 $d(\\mathbf{x}) \\in [0,1]$ 正则化的脆性断裂模型，其中 $d=0$ 表示完整材料，$d=1$ 表示完全断裂。采用标准的二次退化函数 $g(d) = (1-d)^2$ 和Ambrosio–Tortorelli裂纹表面密度\n$$\n\\gamma_{\\ell}(d,\\nabla d) \\;=\\; \\frac{1}{2\\ell}\\,d^{2} \\;+\\; \\frac{\\ell}{2}\\,|\\nabla d|^{2},\n$$\n其中 $\\ell>0$ 是控制正则化裂纹宽度的内禀长度尺度。固体骨架的总自由能密度为 $g(d)\\,\\psi_{0}(\\boldsymbol{\\varepsilon})$，其中 $\\psi_{0}(\\boldsymbol{\\varepsilon})$ 是未损伤材料的线弹性储能密度。对于平面应变下的I型加载，相关的刚度为平面应变模量 $E' = E/(1-\\nu^{2})$。\n\n考虑在 $\\Omega$ 中心形核一条直的、水平的I型裂纹。假设 $\\ell \\ll \\min\\{W,H\\}$，因此形核过程由沿垂直于预想裂纹面的坐标 $x$ 的一维分布 $d(x)$ 控制，且满足 $d(0)=1$ 和 $d(\\pm\\infty)=0$。使用一个能量论证，该论证基于在宽度为 $\\mathcal{O}(\\ell)$ 的带中材料退化所释放的弹性能与产生相场裂纹所消耗的断裂能之间的平衡。具体来说：\n\n1) 推导在满足 $d(0)=1$ 和 $d(\\pm\\infty)=0$ 的条件下，使 $\\int_{-\\infty}^{\\infty} \\gamma_{\\ell}(d,d')\\,\\mathrm{d}x$ 最小化的稳态一维损伤分布 $d^{*}(x)$，并计算以下两个积分：\n$$\n\\int_{-\\infty}^{\\infty} \\gamma_{\\ell}\\big(d^{*}(x),d^{*'}(x)\\big)\\,\\mathrm{d}x,\n\\qquad\n\\int_{-\\infty}^{\\infty} \\big[1 - g\\big(d^{*}(x)\\big)\\big]\\,\\mathrm{d}x.\n$$\n\n2) 利用第(1)部分的结果，并将在主要I型有效张力作用下的未损伤弹性能密度取为 $\\psi_{0} = \\sigma'^{2}/(2E')$（其中 $\\sigma' = \\alpha p_f$），推导出一个临界孔隙压力 $p_{f,\\mathrm{crit}}(\\ell,G_c,E,\\nu,\\alpha)$ 的闭合形式表达式，在该压力下裂纹形核在能量上变得有利。最终答案以帕斯卡为单位表示。无需四舍五入；请提供一个闭合形式的表达式。\n\n3) 简要讨论您的表达式在 $\\ell \\to 0$ 时的极限行为，及其与线性弹性断裂力学（LEFM）的关系，包括在无瑕疵体中形核与从半长为 $a$ 的预存狭缝裂纹扩展（由I型应力强度因子 $K_{I} = p_f \\sqrt{\\pi a}$ 和Griffith关系 $G_c = K_{I}^{2}/E'$ 控制）之间的对比。\n\n您的最终答案必须是 $p_{f,\\mathrm{crit}}(\\ell,G_c,E,\\nu,\\alpha)$ 的单个闭合形式解析表达式。", "solution": "该问题要求计算在无瑕疵多孔弹性介质中使裂纹形核所需的临界孔隙压力。我们将按照问题陈述中列出的三个部分来解决此问题。\n\n**第1部分：最优一维损伤分布及相关积分的推导**\n\n我们的任务是找到一维损伤分布 $d(x)$，它在边界条件 $d(0)=1$ 和 $d(\\pm\\infty)=0$ 的约束下，最小化总裂纹表面能泛函：\n$$\nJ[d] = \\int_{-\\infty}^{\\infty} \\gamma_{\\ell}(d, d')\\,\\mathrm{d}x = \\int_{-\\infty}^{\\infty} \\left( \\frac{1}{2\\ell}\\,d^{2} + \\frac{\\ell}{2}\\,(d')^{2} \\right) \\mathrm{d}x,\n$$\n此处，$d' = \\mathrm{d}d/\\mathrm{d}x$。\n\n这是一个经典的变分法问题。最小化函数 $d^{*}(x)$ 必须满足欧拉-拉格朗日方程：\n$$\n\\frac{\\partial L}{\\partial d} - \\frac{\\mathrm{d}}{\\mathrm{d}x}\\left(\\frac{\\partial L}{\\partial d'}\\right) = 0,\n$$\n其中拉格朗日量为 $L(d, d') = \\frac{1}{2\\ell}\\,d^{2} + \\frac{\\ell}{2}\\,(d')^{2}$。\n\n偏导数分别为：\n$$\n\\frac{\\partial L}{\\partial d} = \\frac{d}{\\ell},\n$$\n$$\n\\frac{\\partial L}{\\partial d'} = \\ell d'.\n$$\n将这些代入欧拉-拉格朗日方程，得到二阶常微分方程：\n$$\n\\frac{d}{\\ell} - \\frac{\\mathrm{d}}{\\mathrm{d}x}(\\ell d') = 0 \\quad \\implies \\quad \\frac{d}{\\ell} - \\ell d'' = 0 \\quad \\implies \\quad \\ell^{2} d'' - d = 0.\n$$\n这个齐次线性常微分方程的通解是\n$$\nd(x) = C_1 \\exp(x/\\ell) + C_2 \\exp(-x/\\ell).\n$$\n我们应用边界条件。当 $x \\to \\infty$ 时，$d(x) \\to 0$ 的条件要求 $C_1 = 0$。当 $x \\to -\\infty$ 时，$d(x) \\to 0$ 的条件要求 $C_2 = 0$。这表明我们应该对 $x>0$ 和 $x<0$ 分段考虑解。\n\n对于 $x > 0$，满足 $d(\\infty)=0$ 的解是 $d(x) = C_2 \\exp(-x/\\ell)$。\n对于 $x < 0$，满足 $d(-\\infty)=0$ 的解是 $d(x) = C_1 \\exp(x/\\ell)$。\n为确保在 $x=0$ 处的连续性，两个表达式必须得到相同的值。条件 $d(0)=1$ 给出 $C_1 = 1$ 和 $C_2 = 1$。所得分布关于 $x=0$ 对称。\n因此，满足边界条件的稳态损伤分布为：\n$$\nd^{*}(x) = \\exp(-|x|/\\ell).\n$$\n现在我们使用这个最优分布 $d^{*}(x)$ 计算所需的两个积分。\n\n第一个积分：\n该积分表示单位面积的正则化裂纹表面积。$d^{*}(x)$ 的导数为 $d^{*'}(x) = -\\frac{\\mathrm{sgn}(x)}{\\ell} \\exp(-|x|/\\ell)$。其平方为 $(d^{*'}(x))^2 = \\frac{1}{\\ell^2} \\exp(-2|x|/\\ell)$。\n$$\n\\int_{-\\infty}^{\\infty} \\gamma_{\\ell}\\big(d^{*}(x),d^{*'}(x)\\big)\\,\\mathrm{d}x = \\int_{-\\infty}^{\\infty} \\left[ \\frac{(d^{*})^2}{2\\ell} + \\frac{\\ell}{2}(d^{*'})^2 \\right] \\mathrm{d}x\n$$\n$$\n= \\int_{-\\infty}^{\\infty} \\left[ \\frac{\\exp(-2|x|/\\ell)}{2\\ell} + \\frac{\\ell}{2} \\left(\\frac{1}{\\ell^2} \\exp(-2|x|/\\ell)\\right) \\right] \\mathrm{d}x\n$$\n$$\n= \\int_{-\\infty}^{\\infty} \\left[ \\frac{\\exp(-2|x|/\\ell)}{2\\ell} + \\frac{\\exp(-2|x|/\\ell)}{2\\ell} \\right] \\mathrm{d}x = \\int_{-\\infty}^{\\infty} \\frac{1}{\\ell} \\exp(-2|x|/\\ell) \\mathrm{d}x.\n$$\n由于被积函数是偶函数，我们可以写成：\n$$\n= 2 \\int_{0}^{\\infty} \\frac{1}{\\ell} \\exp(-2x/\\ell) \\mathrm{d}x = \\frac{2}{\\ell} \\left[ -\\frac{\\ell}{2} \\exp(-2x/\\ell) \\right]_{0}^{\\infty} = -1 \\left[ \\exp(-\\infty) - \\exp(0) \\right] = -1(0 - 1) = 1.\n$$\n所以，第一个积分为 $\\int_{-\\infty}^{\\infty} \\gamma_{\\ell}\\big(d^{*}(x),d^{*'}(x)\\big)\\,\\mathrm{d}x = 1$。对于此公式，这是一个标准的归一化结果。\n\n第二个积分：\n该积分代表释放弹性能的有效体积。退化函数为 $g(d) = (1-d)^2$。\n$$\n\\int_{-\\infty}^{\\infty} \\big[1 - g\\big(d^{*}(x)\\big)\\big]\\,\\mathrm{d}x = \\int_{-\\infty}^{\\infty} \\left[1 - (1-d^{*}(x))^2\\right]\\mathrm{d}x\n$$\n$$\n= \\int_{-\\infty}^{\\infty} \\big[1 - (1 - 2d^{*} + (d^{*})^2)\\big]\\mathrm{d}x = \\int_{-\\infty}^{\\infty} \\big[2d^{*} - (d^{*})^2\\big]\\mathrm{d}x\n$$\n$$\n= \\int_{-\\infty}^{\\infty} \\left[ 2\\exp(-|x|/\\ell) - \\exp(-2|x|/\\ell) \\right] \\mathrm{d}x.\n$$\n我们分开计算这两部分，利用被积函数的偶函数性质：\n$$\n\\int_{-\\infty}^{\\infty} 2\\exp(-|x|/\\ell) \\mathrm{d}x = 4\\int_{0}^{\\infty} \\exp(-x/\\ell) \\mathrm{d}x = 4 [-\\ell \\exp(-x/\\ell)]_{0}^{\\infty} = 4\\ell.\n$$\n$$\n\\int_{-\\infty}^{\\infty} \\exp(-2|x|/\\ell) \\mathrm{d}x = 2\\int_{0}^{\\infty} \\exp(-2x/\\ell) \\mathrm{d}x = 2 [-\\frac{\\ell}{2} \\exp(-2x/\\ell)]_{0}^{\\infty} = \\ell.\n$$\n结合这些结果：\n$$\n\\int_{-\\infty}^{\\infty} \\big[1 - g\\big(d^{*}(x)\\big)\\big]\\,\\mathrm{d}x = 4\\ell - \\ell = 3\\ell.\n$$\n\n**第2部分：临界孔隙压力的推导**\n\n当形成裂纹时总自由能的变化 $\\Delta\\mathcal{E}$ 为零或负时，裂纹形核在能量上变得有利。临界条件对应于 $\\Delta\\mathcal{E}=0$。\n预想裂纹面上单位面积的总自由能由以下泛函给出：\n$$\n\\mathcal{E}[d] = \\int_{-\\infty}^{\\infty} \\left[ g(d(x))\\,\\psi_{0} + G_c\\,\\gamma_{\\ell}(d(x), d'(x)) \\right] \\mathrm{d}x,\n$$\n其中 $\\psi_0$ 是未损伤弹性能密度，$G_c$ 是材料的断裂韧性（临界能量释放率）。未损伤状态对应于对所有 $x$ 都有 $d(x)=0$，所以其能量为 $\\mathcal{E}[0] = \\int_{-\\infty}^{\\infty} g(0)\\,\\psi_{0} \\,\\mathrm{d}x = \\int_{-\\infty}^{\\infty} \\psi_{0} \\,\\mathrm{d}x$。\n\n由于形成裂纹分布 $d^{*}(x)$ 引起的能量变化为：\n$$\n\\Delta \\mathcal{E} = \\mathcal{E}[d^*] - \\mathcal{E}[0] = \\int_{-\\infty}^{\\infty} \\left[ (g(d^*) - 1)\\,\\psi_{0} + G_c\\,\\gamma_{\\ell}(d^*, d^{*'}) \\right] \\mathrm{d}x\n$$\n$$\n\\Delta \\mathcal{E} = -\\psi_{0} \\int_{-\\infty}^{\\infty} [1 - g(d^*)]\\,\\mathrm{d}x + G_c \\int_{-\\infty}^{\\infty} \\gamma_{\\ell}(d^*, d^{*'})\\,\\mathrm{d}x.\n$$\n第一项表示从体材料中释放的弹性能，第二项是创建断裂面所消耗的能量。\n使用第1部分计算的积分，能量变化为：\n$$\n\\Delta\\mathcal{E} = -\\psi_{0} (3\\ell) + G_c (1).\n$$\n形核的临界条件是 $\\Delta\\mathcal{E}=0$，这给出了临界弹性能密度：\n$$\n\\psi_{0,\\mathrm{crit}} = \\frac{G_c}{3\\ell}.\n$$\n问题陈述指出，对于I型加载，$\\psi_0 = \\sigma'^{2}/(2E')$，其中有效拉伸应力为 $\\sigma' = \\alpha p_f$，平面应变模量为 $E' = E/(1-\\nu^2)$。\n将这些代入临界条件：\n$$\n\\frac{(\\alpha p_{f,\\mathrm{crit}})^{2}}{2E'} = \\frac{G_c}{3\\ell}.\n$$\n我们求解临界孔隙压力 $p_{f,\\mathrm{crit}}$：\n$$\n(\\alpha p_{f,\\mathrm{crit}})^{2} = \\frac{2E'G_c}{3\\ell}\n$$\n$$\np_{f,\\mathrm{crit}}^{2} = \\frac{2E'G_c}{3\\ell\\alpha^2} = \\frac{2EG_c}{3\\ell\\alpha^2(1-\\nu^2)}.\n$$\n取正平方根，得到临界孔隙压力的最终表达式：\n$$\np_{f,\\mathrm{crit}}(\\ell,G_c,E,\\nu,\\alpha) = \\frac{1}{\\alpha}\\sqrt{\\frac{2EG_c}{3\\ell(1-\\nu^2)}}.\n$$\n\n**第3部分：极限行为的讨论**\n\n推导出的临界形核压力表达式为 $p_{f,\\mathrm{crit}} \\propto 1/\\sqrt{\\ell}$。当内禀长度尺度 $\\ell$ 趋近于零（$\\ell \\to 0$）时，形核所需的临界压力趋于无穷大（$p_{f,\\mathrm{crit}} \\to \\infty$）。这个极限对应于从正则化（相场）断裂理论到像线性弹性断裂力学（LEFM）这样的尖锐裂纹理论的过渡。该结果意味着，一个理论上完美的、无瑕疵的、均质的弹性固体具有无穷大的拉伸强度。断裂不能从无到有地形核；它需要一个已存在的缺陷。\n\n这与LEFM方法形成了根本对比，LEFM分析的是预存裂纹的扩展。对于一个长度为 $2a$ 的预存穿透裂纹，在远场拉伸应力 $\\sigma'$ 的作用下，I型应力强度因子为 $K_I = \\sigma' \\sqrt{\\pi a}$。问题陈述给出了一个类似的表达式 $K_I = p_f \\sqrt{\\pi a}$ 用于水力压裂，其中压力 $p_f$ 作用于裂纹表面。根据Griffith准则，当能量释放率 $G = K_I^2/E'$ 达到材料的韧性 $G_c$ 时，裂纹开始扩展。因此，扩展的临界压力为：\n$$\nG_c = \\frac{(p_{f,\\mathrm{prop}} \\sqrt{\\pi a})^2}{E'} \\implies p_{f,\\mathrm{prop}} = \\sqrt{\\frac{E'G_c}{\\pi a}} = \\sqrt{\\frac{EG_c}{\\pi a(1-\\nu^2)}}.\n$$\n在LEFM中，扩展压力 $p_{f,\\mathrm{prop}} \\propto 1/\\sqrt{a}$。强度由最大预存缺陷的尺寸 $a$ 控制，而不是一个内禀的材料长度尺度。当 $a \\to 0$ 时，$p_{f,\\mathrm{prop}} \\to \\infty$，这再次表明LEFM无法预测形核。相场模型通过引入内禀长度尺度 $\\ell$ 来正则化这个奇点，其物理意义可解释为对材料微观结构尺寸（例如晶粒尺寸）的一种度量，为断裂过程区提供了一个特征长度。对于任何 $\\ell > 0$，相场形核强度是有限的，这有效地设定了在没有更大宏观缺陷的情况下材料的内禀强度。", "answer": "$$\n\\boxed{\\frac{1}{\\alpha} \\sqrt{\\frac{2EG_c}{3\\ell(1-\\nu^{2})}}}\n$$", "id": "3611805"}, {"introduction": "探索了流动与断裂的物理原理后，最终的挑战是将这些知识转化为能够捕捉耦合过程的稳健数值模型。本练习的核心任务是设计一种自适应时间步长策略，它必须同时满足流体扩散、裂缝扩展和流体滤失等多个物理过程的约束。这项综合性练习旨在培养计算科学家的一项关键技能：如何将物理洞察力转化为高效且稳定的算法，以应对复杂的多物理场模拟 [@problem_id:3611786]。", "problem": "您需要为多相孔隙力学和水力压裂中的一个简化一维流动-裂缝耦合问题设计并实现一个时间步长自适应策略。该算法必须基于估算水力扩散时间尺度和裂缝前缘推进约束，并将其组合在一个类似于 Courant–Friedrichs–Lewy (CFL) 的耦合稳定性最小化准则中。您的程序必须为每个指定的参数集计算自适应时间步长。\n\n只能从基本定律和核心定义出发。具体来说，从多孔介质中流动的动量平衡（达西定律）和微可压多相混合物的质量守恒相结合开始。在不使用任何预先给定的简化公式的情况下，推导：\n- 一个适用于流经具有固有渗透率的多孔基质的微可压多相混合物的线性化压力方程的有效水力扩散系数。\n- 一个针对在间距为 $\\,\\Delta x\\,$ 的均匀网格上对一维扩散方程进行显式时间积分的稳定性时间步长约束。\n- 一个本着 Courant–Friedrichs–Lewy 准则的精神、基于前缘速度 $\\,v_f\\,$ 和特征尖端单元长度 $\\,\\ell_{\\mathrm{tip}}\\,$，并使用无量纲安全系数的裂缝前缘推进约束。\n- 一个由特征排泄长度 $\\,L_c\\,$ 和扩散系数构建，并带有无量纲安全系数的滤失或横向排泄时间尺度。\n- 一个最终准则，该准则选择时间步长为上述约束和给定最大值中的最小值，但绝不小于规定的最小值。\n\n您的实现必须：\n- 根据相对渗透率和粘度计算多相总流度。\n- 根据固有渗透率、总流度、孔隙度和总压缩系数计算有效扩散系数。\n- 计算三个候选时间步长界限（沿网格扩散、裂缝前缘平流、排泄/滤失），并包含用户指定的安全系数。将任何不适用的约束（例如，零流度或零裂缝速度）视为非限制性的，为其分配一个有效的无限大界限。\n- 选择最终自适应时间步长为所有有限界限和用户指定的最大值中的最小值，然后从下方强制施加一个用户指定的最小界限。\n\n物理单位和数值格式：\n- 所有长度单位均视为米 (m)，渗透率单位为平方米 (m$^2$)，粘度单位为帕斯卡·秒 (Pa·s)，压缩系数单位为帕斯卡的倒数 (Pa$^{-1}$)，速度单位为米/秒 (m/s)，时间单位为秒 (s)。\n- 您的程序必须以秒为单位输出每个自适应时间步长，格式为十进制浮点数，四舍五入到小数点后恰好六位，输出中不含单位符号。\n\n测试套件和要求的输出格式：\n- 使用以下五个测试用例。每个测试用例是一个元组，顺序为 $\\left(\\Delta x, k, \\phi, c_t, k_{rw}, k_{ro}, \\mu_w, \\mu_o, v_f, \\ell_{\\mathrm{tip}}, L_c, C_d, C_{\\mathrm{tip}}, C_{\\mathrm{leak}}, \\Delta t_{\\max}, \\Delta t_{\\min}\\right)$，其中所有符号如上所述，所有输入均以一致的单位给出。下面的每个数值都以其规定单位表示：\n    1. $\\left(0.25,\\;1\\times 10^{-19},\\;0.12,\\;8\\times 10^{-10},\\;0.2,\\;0.6,\\;1\\times 10^{-3},\\;2\\times 10^{-3},\\;0.5,\\;0.05,\\;0.05,\\;0.45,\\;0.8,\\;0.5,\\;1.0,\\;1\\times 10^{-6}\\right)$\n    2. $\\left(0.1,\\;1\\times 10^{-14},\\;0.2,\\;1\\times 10^{-9},\\;0.5,\\;0.5,\\;1\\times 10^{-3},\\;3\\times 10^{-3},\\;0.2,\\;0.02,\\;0.05,\\;0.45,\\;0.8,\\;0.5,\\;0.5,\\;1\\times 10^{-6}\\right)$\n    3. $\\left(0.2,\\;1\\times 10^{-18},\\;0.15,\\;1\\times 10^{-9},\\;0.1,\\;0.1,\\;1\\times 10^{-3},\\;2\\times 10^{-3},\\;0.0,\\;0.05,\\;0.1,\\;0.45,\\;0.8,\\;0.5,\\;100.0,\\;1\\times 10^{-6}\\right)$\n    4. $\\left(0.3,\\;1\\times 10^{-20},\\;0.12,\\;1\\times 10^{-9},\\;0.0,\\;0.0,\\;1\\times 10^{-3},\\;1\\times 10^{-3},\\;1.0,\\;0.01,\\;0.03,\\;0.45,\\;0.8,\\;0.5,\\;1.0,\\;1\\times 10^{-6}\\right)$\n    5. $\\left(0.1,\\;1\\times 10^{-20},\\;0.1,\\;1\\times 10^{-9},\\;0.0,\\;0.0,\\;1\\times 10^{-3},\\;1\\times 10^{-3},\\;0.0,\\;0.02,\\;0.05,\\;0.45,\\;0.8,\\;0.5,\\;10.0,\\;1\\times 10^{-6}\\right)$\n- 您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔的结果列表，例如 $\\left[\\Delta t_1,\\Delta t_2,\\dots\\right]$，其中每个 $\\Delta t_i$ 是测试用例 $i$ 的自适应时间步长，以秒为单位，格式化为小数点后六位。输出不得包含空格或任何其他文本。\n\n确保所有最终数值答案都以秒为单位表示，并严格遵守上述四舍五入规则。", "solution": "该问题要求为简化的流体流动与裂缝扩展一维耦合问题设计并实现一个自适应时间步进算法，这是计算地球物理学中模拟水力压裂的一项常见任务。该方法必须从基本原理（即质量守恒和达西定律）推导得出，并包含与数值稳定性和裂缝扩展物理学相关的约束条件。\n\n推导和算法设计将分五个阶段进行：\n1.  推导多孔介质中多相流的有效水力扩散系数 $D$。\n2.  推导所得扩散方程的显式有限差分格式的数值稳定性约束 $\\Delta t_d$。\n3.  建立与裂缝前缘推进相关的物理时间尺度约束 $\\Delta t_{\\mathrm{tip}}$。\n4.  建立与流体向地层中滤失相关的物理时间尺度约束 $\\Delta t_{\\mathrm{leak}}$。\n5.  将这些约束综合成一个用于选择自适应时间步长 $\\Delta t$ 的单一准则。\n\n**1. 多相流的有效水力扩散系数**\n\n推导始于多孔固体基质内流体混合物的质量守恒原理。单位体积内的流体质量由孔隙度 $\\phi$ 和平均流体密度 $\\rho_t$ 的乘积给出。质量守恒定律的微分形式为：\n$$\n\\frac{\\partial (\\phi \\rho_t)}{\\partial t} + \\nabla \\cdot (\\rho_t \\mathbf{v}_t) = 0\n$$\n其中 $\\mathbf{v}_t$ 是总流体体积通量（达西速度），$t$ 是时间。\n\n对于一个微可压系统，流体密度和孔隙度都随流体压力 $p$ 而变化。这种综合效应由总压缩系数 $c_t$ 捕捉，其定义为单位压力变化引起的流体质量含量的分数变化：\n$$\nc_t = \\frac{1}{\\phi \\rho_t} \\frac{\\partial (\\phi \\rho_t)}{\\partial p}\n$$\n使用链式法则，储集项（守恒方程的第一项）可以表示为：\n$$\n\\frac{\\partial (\\phi \\rho_t)}{\\partial t} = \\frac{\\partial (\\phi \\rho_t)}{\\partial p} \\frac{\\partial p}{\\partial t} = (\\phi c_t \\rho_t) \\frac{\\partial p}{\\partial t}\n$$\n将此代入守恒定律得到：\n$$\n(\\phi c_t \\rho_t) \\frac{\\partial p}{\\partial t} + \\nabla \\cdot (\\rho_t \\mathbf{v}_t) = 0\n$$\n假设密度的空间梯度与通量的梯度相比可以忽略不计（一种常见的线性化方法），我们可以将其简化为：\n$$\n\\phi c_t \\frac{\\partial p}{\\partial t} + \\nabla \\cdot \\mathbf{v}_t = 0\n$$\n总体积通量 $\\mathbf{v}_t$ 由达西定律的多相扩展描述。对于两种不混溶的相，例如水 ($w$) 和油 ($o$)，总通量是各相通量之和：\n$$\n\\mathbf{v}_t = \\mathbf{v}_w + \\mathbf{v}_o\n$$\n每个相的通量由 $\\mathbf{v}_\\alpha = -\\frac{k k_{r\\alpha}}{\\mu_\\alpha} \\nabla p$ 给出，其中 $k$ 是多孔介质的固有渗透率，$k_{r\\alpha}$ 是相 $\\alpha$ 的相对渗透率，$\\mu_\\alpha$ 是其动力粘度。我们假设一个单一的压力场 $p$ 控制着两相的流动。\n将通量相加得到：\n$$\n\\mathbf{v}_t = -\\left( \\frac{k k_{rw}}{\\mu_w} + \\frac{k k_{ro}}{\\mu_o} \\right) \\nabla p\n$$\n我们定义总流度 $\\lambda_t$ 为各相流度之和：$\\lambda_t = \\lambda_w + \\lambda_o = \\frac{k_{rw}}{\\mu_w} + \\frac{k_{ro}}{\\mu_o}$。这将总通量表达式简化为：\n$$\n\\mathbf{v}_t = -k \\lambda_t \\nabla p\n$$\n将此通量代回简化的守恒方程得到：\n$$\n\\phi c_t \\frac{\\partial p}{\\partial t} - \\nabla \\cdot (k \\lambda_t \\nabla p) = 0\n$$\n假设 $k$ 和 $\\lambda_t$ 是局部常数，我们得到线性压力扩散方程：\n$$\n\\frac{\\partial p}{\\partial t} = \\frac{k \\lambda_t}{\\phi c_t} \\nabla^2 p\n$$\n这个方程具有通用形式 $\\frac{\\partial p}{\\partial t} = D \\nabla^2 p$。通过比较，我们确定有效水力扩散系数 $D$ 为：\n$$\nD = \\frac{k \\lambda_t}{\\phi c_t} = \\frac{k}{\\phi c_t} \\left( \\frac{k_{rw}}{\\mu_w} + \\frac{k_{ro}}{\\mu_o} \\right)\n$$\n\n**2. 扩散时间步长约束**\n\n此约束源于扩散方程显式时间积分格式的稳定性要求。对于间距为 $\\Delta x$ 的均匀网格上的一维问题，扩散方程为 $\\frac{\\partial p}{\\partial t} = D \\frac{\\partial^2 p}{\\partial x^2}$。使用前向时间中心空间 (FTCS) 离散格式：\n$$\n\\frac{p_i^{n+1} - p_i^n}{\\Delta t} = D \\frac{p_{i+1}^n - 2p_i^n + p_{i-1}^n}{(\\Delta x)^2}\n$$\n其中 $p_i^n$ 是网格点 $i$ 在时间步 $n$ 处的压力。为使此格式数值稳定，时间步长 $\\Delta t$ 必须满足 Courant–Friedrichs–Lewy (CFL) 条件，对于此方程该条件为：\n$$\n\\frac{2 D \\Delta t}{(\\Delta x)^2} \\le 1 \\implies \\Delta t \\le \\frac{(\\Delta x)^2}{2D}\n$$\n问题指定了一个无量纲安全系数 $C_d$ 应用于此理论极限。因此，由沿网格扩散所允许的最大时间步长为：\n$$\n\\Delta t_d = C_d \\frac{(\\Delta x)^2}{2D}\n$$\n如果扩散系数 $D$ 为零（例如，如果总流度 $\\lambda_t = 0$），则不会发生扩散，此约束变为非限制性的，这在数学上等同于 $\\Delta t_d \\to \\infty$。\n\n**3. 裂缝前缘推进约束**\n\n此约束基于裂缝尖端在介质中扩展的物理学。该扩展是一个类平流过程，其中新裂缝位置的“信息”以前缘速度 $v_f$ 移动。一个类似 CFL 的条件是必要的，以确保裂缝在单个时间步内推进不超过一个特征单元长度 $\\ell_{\\mathrm{tip}}$。基本约束为 $\\Delta t \\le \\ell_{\\mathrm{tip}} / v_f$。包含指定的安全系数 $C_{\\mathrm{tip}}$，我们得到约束：\n$$\n\\Delta t_{\\mathrm{tip}} = C_{\\mathrm{tip}} \\frac{\\ell_{\\mathrm{tip}}}{v_f}\n$$\n如果裂缝是静止的 ($v_f = 0$)，则此约束是非限制性的，因此 $\\Delta t_{\\mathrm{tip}} \\to \\infty$。\n\n**4. 滤失时间尺度约束**\n\n此约束确保模拟能充分解析流体从高压裂缝滤失到低压周围岩石基质的过程。这是一个由水力扩散系数 $D$ 控制的扩散过程。扩散在特征长度 $L$ 上达到平衡所需的特征时间 $T$ 由标度律 $T \\sim L^2/D$ 给出。在此背景下，特征长度是排泄长度 $L_c$。时间步长应为该特征时间的一部分，以捕捉瞬态动力学。使用指定的安全系数 $C_{\\mathrm{leak}}$，该约束公式化为：\n$$\n\\Delta t_{\\mathrm{leak}} = C_{\\mathrm{leak}} \\frac{L_c^2}{D}\n$$\n与扩散约束一样，如果 $D=0$，则不会发生滤失，此约束变为非限制性的，即 $\\Delta t_{\\mathrm{leak}} \\to \\infty$。\n\n**5. 最终自适应时间步长算法**\n\n最终的自适应时间步长 $\\Delta t$ 是通过同时满足所有约束来确定的。这是通过从计算出的界限集合和用户设定的最大时间步长 $\\Delta t_{\\max}$ 中选择最严格（即最小）的时间步长来实现的。此外，时间步长不允许低于用户设定的最小值 $\\Delta t_{\\min}$。完整的准则是：\n1.  计算三个物理推导的时间步长限制：$\\Delta t_d$、$\\Delta t_{\\mathrm{tip}}$ 和 $\\Delta t_{\\mathrm{leak}}$。\n2.  找出这些值和规定的最大值 $\\Delta t_{\\max}$ 中的最小值：\n    $$ \\Delta t_{\\text{candidate}} = \\min(\\Delta t_d, \\Delta t_{\\mathrm{tip}}, \\Delta t_{\\mathrm{leak}}, \\Delta t_{\\max}) $$\n3.  确保最终的时间步长不小于规定的最小值 $\\Delta t_{\\min}$：\n    $$ \\Delta t = \\max(\\Delta t_{\\text{candidate}}, \\Delta t_{\\min}) $$\n这种先取多阶段最小值，再与下限值取最大值的方法，是在复杂多物理场模拟中控制时间步长大小的一种鲁棒方法。实现部分将为每个提供的参数集计算该值。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the adaptive time step for a series of test cases based on \n    multiphase poromechanics and hydraulic fracturing stability criteria.\n    \"\"\"\n\n    # Test cases: tuples in the order\n    # (delta_x, k, phi, c_t, k_rw, k_ro, mu_w, mu_o, v_f, l_tip, L_c, C_d, C_tip, C_leak, dt_max, dt_min)\n    test_cases = [\n        (0.25, 1e-19, 0.12, 8e-10, 0.2, 0.6, 1e-3, 2e-3, 0.5, 0.05, 0.05, 0.45, 0.8, 0.5, 1.0, 1e-6),\n        (0.1, 1e-14, 0.2, 1e-9, 0.5, 0.5, 1e-3, 3e-3, 0.2, 0.02, 0.05, 0.45, 0.8, 0.5, 0.5, 1e-6),\n        (0.2, 1e-18, 0.15, 1e-9, 0.1, 0.1, 1e-3, 2e-3, 0.0, 0.05, 0.1, 0.45, 0.8, 0.5, 100.0, 1e-6),\n        (0.3, 1e-20, 0.12, 1e-9, 0.0, 0.0, 1e-3, 1e-3, 1.0, 0.01, 0.03, 0.45, 0.8, 0.5, 1.0, 1e-6),\n        (0.1, 1e-20, 0.1, 1e-9, 0.0, 0.0, 1e-3, 1e-3, 0.0, 0.02, 0.05, 0.45, 0.8, 0.5, 10.0, 1e-6),\n    ]\n\n    results = []\n    for params in test_cases:\n        dt = calculate_adaptive_timestep(params)\n        results.append(f\"{dt:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\ndef calculate_adaptive_timestep(params):\n    \"\"\"\n    Calculates the adaptive time step for a single parameter set.\n    \"\"\"\n    (delta_x, k, phi, c_t, k_rw, k_ro, mu_w, mu_o, v_f, \n     l_tip, L_c, C_d, C_tip, C_leak, dt_max, dt_min) = params\n\n    # 1. Calculate total mobility and effective diffusivity\n    lambda_t = (k_rw / mu_w) + (k_ro / mu_o)\n    \n    if phi > 0 and c_t > 0 and lambda_t > 0:\n        D = (k * lambda_t) / (phi * c_t)\n    else:\n        D = 0.0\n\n    # 2. Calculate time step bounds\n    # Initialize bounds to infinity (non-restrictive)\n    dt_d = float('inf')\n    dt_leak = float('inf')\n    \n    # Diffusion and leak-off constraints\n    if D > 0:\n        dt_d = C_d * (delta_x**2) / (2 * D)\n        dt_leak = C_leak * (L_c**2) / D\n\n    # Fracture-front advection constraint\n    dt_tip = float('inf')\n    if v_f > 0:\n        dt_tip = C_tip * l_tip / v_f\n\n    # 3. Apply final rule\n    # Find the minimum of all finite bounds and the user-specified maximum\n    dt_candidate = min(dt_d, dt_leak, dt_tip, dt_max)\n\n    # Enforce the user-specified minimum bound from below\n    final_dt = max(dt_candidate, dt_min)\n\n    return final_dt\n\nsolve()\n```", "id": "3611786"}]}