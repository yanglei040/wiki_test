{"hands_on_practices": [{"introduction": "在深入研究复杂二维或三维模型中自由表面边界条件的数值实现之前，通过一个简化的一维模型来建立物理直觉是至关重要的。本练习 [@problem_id:3598388] 旨在通过对比“无牵引力”边界与“夹持”边界这两种情况，阐明自由表面条件对弹性波传播的独特影响。通过分析这两种情况下本征频率和模态能量分布的差异，你将深刻理解为何精确施加无牵引力条件对于模拟地表附近的地震波行为至关重要。", "problem": "考虑一个厚度为 $H$、占据 $z \\in [0,H]$ 空间的均匀、各向同性弹性层中的一维剪切水平弹性动力学运动。设位移场为 $u(z,t)$，它表示一个仅随深度 $z$ 和时间 $t$ 变化的水平剪切分量。其控制方程由各向同性弹性固体的线动量平衡和胡克定律导出，\n$$\n\\rho \\,\\frac{\\partial^2 u}{\\partial t^2} = \\mu \\,\\frac{\\partial^2 u}{\\partial z^2},\n$$\n其中 $\\rho$ 是质量密度，$\\mu$ 是剪切模量，$v_s = \\sqrt{\\mu/\\rho}$ 是剪切波速。\n\n假设在 $z=H$ 处有一个刚性基底，由运动学边界条件 $u(H,t)=0$ 建模。在 $z=0$ 的自由表面处考虑两种备选的边界条件：\n- 自由牵引面：$\\sigma_{xz}(0,t) = \\mu \\,\\frac{\\partial u}{\\partial z}(0,t) = 0$，等效于 $\\frac{\\partial u}{\\partial z}(0,t)=0$。\n- 固支表面：$u(0,t)=0$。\n\n寻求形式为 $u(z,t) = \\phi(z)\\,e^{i\\,\\omega t}$ 的时谐解，其中 $\\omega$ 为角频率，这导出了以下特征值问题\n$$\n- v_s^2\\,\\frac{d^2 \\phi}{dz^2} = \\omega^2 \\,\\phi,\n$$\n该问题受制于混合边界条件 $\\frac{d\\phi}{dz}(0)=0$ 和 $\\phi(H)=0$（在 $z=0$ 处为自由牵引，在 $z=H$ 处为刚性），或者固支边界条件 $\\phi(0)=0$ 和 $\\phi(H)=0$。\n\n您的任务是编写一个完整、可运行的程序，该程序能够：\n1. 从上述基本定律和定义出发，通过求解特征值问题的解析解，计算两种边界条件集的前三个角特征频率。\n2. 对每种边界条件集，独立地将其特征频率按大小升序排列。\n3. 对于每组中按频率升序排列的模态指数 $n\\in\\{1,2,3\\}$，通过计算差值 $\\Delta \\omega_n = \\omega^{\\text{(traction-free)}}_n - \\omega^{\\text{(clamped)}}_n$ 和比值 $R_n = \\omega^{\\text{(traction-free)}}_n / \\omega^{\\text{(clamped)}}_n$ 来比较频谱。\n4. 对于每种边界条件集的第一模态，通过计算厚度为 $h_0$ 的近地表子层中的能量分数来量化近地表模态的局域化，该分数定义为\n$$\nF = \\frac{\\int_{0}^{h_0} |\\phi(z)|^2 \\, dz}{\\int_{0}^{H} |\\phi(z)|^2 \\, dz},\n$$\n并报告 $F_{\\text{traction-free, first mode}}$、$F_{\\text{clamped, first mode}}$、它们的差值 $\\Delta F = F_{\\text{traction-free}} - F_{\\text{clamped}}$，以及一个指示 $F_{\\text{traction-free}} > F_{\\text{clamped}}$ 是否成立的布尔值。\n5. 所有角频率以弧度/秒 (rad/s) 表示，所有长度以米 (m) 表示。三角函数中使用的所有角度必须以弧度为单位。所有报告的分数必须是小数（而非百分比）。\n\n实现该程序，为以下测试套件生成结果，该套件旨在覆盖一个典型案例、一个边界案例和一个极端边缘案例：\n- 测试案例 1：$H=1000\\,\\text{米}$，$v_s=2000\\,\\text{米/秒}$，$h_0=100\\,\\text{米}$。\n- 测试案例 2：$H=50\\,\\text{米}$，$v_s=1000\\,\\text{米/秒}$，$h_0=50\\,\\text{米}$。\n- 测试案例 3：$H=100\\,\\text{米}$，$v_s=1500\\,\\text{米/秒}$，$h_0=10^{-6}\\,\\text{米}$。\n\n对于每个测试案例，您的程序必须计算并返回一个列表，按顺序包含：\n- $\\Delta \\omega_1$, $\\Delta \\omega_2$, $\\Delta \\omega_3$ (浮点数，单位为 rad/s),\n- $R_1$, $R_2$, $R_3$ (无量纲浮点数),\n- $F_{\\text{traction-free, first mode}}$ 和 $F_{\\text{clamped, first mode}}$ (小数),\n- $\\Delta F$ (小数),\n- 一个指示 $F_{\\text{traction-free, first mode}} > F_{\\text{clamped, first mode}}$ 是否成立的布尔值。\n\n最终输出格式要求：您的程序应生成单行输出，其中包含结果，形式为三个按案例划分的列表组成的逗号分隔列表，并用方括号括起来，例如 $[ [\\dots], [\\dots], [\\dots] ]$。", "solution": "该问题要求分析弹性层中的一维剪切水平（SH）波传播，该过程由波动方程控制。我们的任务是找到并比较在 $z=0$ 自由表面处两种不同边界条件下的角特征频率和振型，而在 $z=H$ 处的基底是刚性的。\n\n位移 $u(z,t)$ 的控制偏微分方程是\n$$\n\\rho \\,\\frac{\\partial^2 u}{\\partial t^2} = \\mu \\,\\frac{\\partial^2 u}{\\partial z^2}\n$$\n引入剪切波速 $v_s = \\sqrt{\\mu/\\rho}$，方程变为\n$$\n\\frac{\\partial^2 u}{\\partial t^2} = v_s^2 \\,\\frac{\\partial^2 u}{\\partial z^2}\n$$\n我们寻求 $u(z,t) = \\phi(z)e^{i\\omega t}$ 形式的时谐解。将其代入波动方程，得到关于振型 $\\phi(z)$ 的二阶常微分方程：\n$$\n-\\omega^2 \\phi(z) = v_s^2 \\frac{d^2\\phi}{dz^2}\n$$\n该方程可以重排为亥姆霍兹方程的标准形式，代表一个关于角频率 $\\omega$ 的特征值问题：\n$$\n\\frac{d^2\\phi}{dz^2} + k^2 \\phi = 0, \\quad \\text{其中 } k = \\frac{\\omega}{v_s}\n$$\n这个常微分方程的通解是\n$$\n\\phi(z) = A \\cos(kz) + B \\sin(kz)\n$$\n其中 $A$ 和 $B$ 是由边界条件决定的常数。在 $z=H$ 处的基底是刚性的，这在所有情况下都施加了 $\\phi(H)=0$ 的条件。\n\n我们分别分析这两组边界条件，以找到它们各自的特征频率和特征函数。\n\n### 案例 1：$z=0$ 处为自由牵引面\n边界条件为：\n1.  在 $z=0$ 处为自由牵引：$\\frac{d\\phi}{dz}(0) = 0$\n2.  在 $z=H$ 处为刚性基底：$\\phi(H) = 0$\n\n首先，我们计算通解的导数：\n$$\n\\frac{d\\phi}{dz}(z) = -Ak\\sin(kz) + Bk\\cos(kz)\n$$\n在 $z=0$ 处应用第一个边界条件：\n$$\n\\frac{d\\phi}{dz}(0) = -Ak\\sin(0) + Bk\\cos(0) = Bk = 0\n$$\n为了得到非平凡解，我们需要 $k \\neq 0$（因此 $\\omega \\neq 0$），这意味着 $B=0$。解简化为 $\\phi(z) = A \\cos(kz)$。\n\n接下来，在 $z=H$ 处应用第二个边界条件：\n$$\n\\phi(H) = A \\cos(kH) = 0\n$$\n为了得到非平凡特征函数，$A \\neq 0$，所以必须有 $\\cos(kH)=0$。当余弦函数的参数是 $\\pi/2$ 的奇数倍时，此条件成立：\n$$\nkH = \\frac{(2n-1)\\pi}{2}, \\quad \\text{其中 } n = 1, 2, 3, \\dots\n$$\n这给出了量子化的波数 $k_n^{\\text{(tf)}} = \\frac{(2n-1)\\pi}{2H}$。相应的角特征频率由 $\\omega = k v_s$ 得出：\n$$\n\\omega_n^{\\text{(traction-free)}} = \\frac{(2n-1)\\pi v_s}{2H}, \\quad n=1, 2, 3, \\dots\n$$\n在此情况下，将任意振幅设为 1，特征函数（振型）为：\n$$\n\\phi_n^{\\text{(traction-free)}}(z) = \\cos\\left(\\frac{(2n-1)\\pi z}{2H}\\right)\n$$\n\n### 案例 2：$z=0$ 处为固支表面\n边界条件为：\n1.  在 $z=0$ 处为固支：$\\phi(0) = 0$\n2.  在 $z=H$ 处为刚性基底：$\\phi(H) = 0$\n\n将第一个边界条件应用于通解 $\\phi(z) = A \\cos(kz) + B \\sin(kz)$：\n$$\n\\phi(0) = A\\cos(0) + B\\sin(0) = A = 0\n$$\n解简化为 $\\phi(z) = B \\sin(kz)$。\n\n在 $z=H$ 处应用第二个边界条件：\n$$\n\\phi(H) = B \\sin(kH) = 0\n$$\n为了得到非平凡特征函数，$B \\neq 0$，所以必须有 $\\sin(kH)=0$。当正弦函数的参数是 $\\pi$ 的整数倍时，此条件成立：\n$$\nkH = n\\pi, \\quad \\text{其中 } n = 1, 2, 3, \\dots\n$$\n这给出了量子化的波数 $k_n^{\\text{(clamped)}} = \\frac{n\\pi}{H}$。相应的角特征频率为：\n$$\n\\omega_n^{\\text{(clamped)}} = \\frac{n\\pi v_s}{H}, \\quad n=1, 2, 3, \\dots\n$$\n在此情况下，同样将振幅设为 1，特征函数为：\n$$\n\\phi_n^{\\text{(clamped)}}(z) = \\sin\\left(\\frac{n\\pi z}{H}\\right)\n$$\n\n### 频谱比较\n我们计算差值 $\\Delta \\omega_n = \\omega_n^{\\text{(traction-free)}} - \\omega_n^{\\text{(clamped)}}$ 和比值 $R_n = \\omega_n^{\\text{(traction-free)}} / \\omega_n^{\\text{(clamped)}}$，其中 $n \\in \\{1, 2, 3\\}$。\n\n差值为：\n$$\n\\Delta \\omega_n = \\frac{(2n-1)\\pi v_s}{2H} - \\frac{n\\pi v_s}{H} = \\frac{\\pi v_s}{H} \\left(\\frac{2n-1}{2} - n\\right) = \\frac{\\pi v_s}{H} \\left(n - \\frac{1}{2} - n\\right) = -\\frac{\\pi v_s}{2H}\n$$\n有趣的是，对于所有模态 $n$，特征频率的差值是恒定的。\n\n比值为：\n$$\nR_n = \\frac{\\omega_n^{\\text{(traction-free)}}}{\\omega_n^{\\text{(clamped)}}} = \\frac{(2n-1)\\pi v_s / (2H)}{n\\pi v_s / H} = \\frac{2n-1}{2n} = 1 - \\frac{1}{2n}\n$$\n\n### 近地表能量分数\n能量密度与 $|\\phi(z)|^2$ 成正比。我们计算每种情况下第一模态（$n=1$）在子层 $z \\in [0, h_0]$ 中的能量分数。\n$$\nF = \\frac{\\int_{0}^{h_0} |\\phi(z)|^2 \\, dz}{\\int_{0}^{H} |\\phi(z)|^2 \\, dz}\n$$\n\n对于**自由牵引**情况（$n=1$），$\\phi_1^{\\text{(tf)}}(z) = \\cos(\\frac{\\pi z}{2H})$。\n分母是 $\\int_{0}^{H} \\cos^2(\\frac{\\pi z}{2H}) \\, dz = \\int_{0}^{H} \\frac{1}{2}(1 + \\cos(\\frac{\\pi z}{H})) \\, dz = \\frac{1}{2}\\left[z + \\frac{H}{\\pi}\\sin(\\frac{\\pi z}{H})\\right]_0^H = \\frac{H}{2}$。\n分子是 $\\int_{0}^{h_0} \\cos^2(\\frac{\\pi z}{2H}) \\, dz = \\frac{1}{2}\\left[z + \\frac{H}{\\pi}\\sin(\\frac{\\pi z}{H})\\right]_0^{h_0} = \\frac{h_0}{2} + \\frac{H}{2\\pi}\\sin(\\frac{\\pi h_0}{H})$。\n分数为：\n$$\nF_{\\text{traction-free}} = \\frac{\\frac{h_0}{2} + \\frac{H}{2\\pi}\\sin(\\frac{\\pi h_0}{H})}{H/2} = \\frac{h_0}{H} + \\frac{1}{\\pi}\\sin\\left(\\frac{\\pi h_0}{H}\\right)\n$$\n\n对于**固支**情况（$n=1$），$\\phi_1^{\\text{(clamped)}}(z) = \\sin(\\frac{\\pi z}{H})$。\n分母是 $\\int_{0}^{H} \\sin^2(\\frac{\\pi z}{H}) \\, dz = \\int_{0}^{H} \\frac{1}{2}(1 - \\cos(\\frac{2\\pi z}{H})) \\, dz = \\frac{1}{2}\\left[z - \\frac{H}{2\\pi}\\sin(\\frac{2\\pi z}{H})\\right]_0^H = \\frac{H}{2}$。\n分子是 $\\int_{0}^{h_0} \\sin^2(\\frac{\\pi z}{H}) \\, dz = \\frac{1}{2}\\left[z - \\frac{H}{2\\pi}\\sin(\\frac{2\\pi z}{H})\\right]_0^{h_0} = \\frac{h_0}{2} - \\frac{H}{4\\pi}\\sin(\\frac{2\\pi h_0}{H})$。\n分数为：\n$$\nF_{\\text{clamped}} = \\frac{\\frac{h_0}{2} - \\frac{H}{4\\pi}\\sin(\\frac{2\\pi h_0}{H})}{H/2} = \\frac{h_0}{H} - \\frac{1}{2\\pi}\\sin\\left(\\frac{2\\pi h_0}{H}\\right)\n$$\n然后直接计算差值 $\\Delta F = F_{\\text{traction-free}} - F_{\\text{clamped}}$ 和布尔检查 $F_{\\text{traction-free}} > F_{\\text{clamped}}$。这些推导出的解析表达式在下面的程序中实现，用于计算给定测试案例所需量。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n# No other libraries are used.\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for the given test cases and print the results.\n    \"\"\"\n\n    def calculate_metrics(H, vs, h0):\n        \"\"\"\n        Computes the required metrics for a single test case.\n\n        Args:\n            H (float): Layer thickness in meters.\n            vs (float): Shear-wave speed in m/s.\n            h0 (float): Near-surface sublayer thickness in meters.\n\n        Returns:\n            list: A list containing 10 metric values in the specified order.\n        \"\"\"\n        pi = np.pi\n\n        # Task 3: Compare spectra\n        # The difference in angular frequencies is constant for all modes.\n        delta_omega_n = -pi * vs / (2.0 * H)\n        delta_omegas = [delta_omega_n, delta_omega_n, delta_omega_n]\n\n        # The ratio of angular frequencies depends on the mode index n.\n        ratios = [1.0 - 1.0 / (2.0 * n) for n in range(1, 4)]\n\n        # Task 4: Quantify near-surface mode localization\n        h0_over_H = h0 / H\n\n        # For the traction-free case, first mode (n=1)\n        arg_tf = pi * h0_over_H\n        F_tf = h0_over_H + np.sin(arg_tf) / pi\n\n        # For the clamped case, first mode (n=1)\n        arg_clamped = 2.0 * pi * h0_over_H\n        F_clamped = h0_over_H - np.sin(arg_clamped) / (2.0 * pi)\n\n        # Difference in energy fractions\n        delta_F = F_tf - F_clamped\n\n        # Boolean comparison of energy fractions\n        is_Ftf_gt_Fclamped = F_tf  F_clamped\n\n        return delta_omegas + ratios + [F_tf, F_clamped, delta_F, is_Ftf_gt_Fclamped]\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (H, vs, h0)\n        (1000.0, 2000.0, 100.0),      # Test case 1\n        (50.0, 1000.0, 50.0),         # Test case 2\n        (100.0, 1500.0, 1e-6),        # Test case 3\n    ]\n\n    results = []\n    for case in test_cases:\n        H_val, vs_val, h0_val = case\n        case_results = calculate_metrics(H_val, vs_val, h0_val)\n        results.append(case_results)\n\n    # Final print statement in the exact required format.\n    # The str() representation of a list includes spaces after commas, e.g., '[1.0, 2.0]'.\n    # Joining these string representations with a comma produces the required output format,\n    # e.g., '[[1.0, 2.0],[3.0, 4.0]]'.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3598388"}, {"introduction": "将物理原理转化为可靠的数值算法是计算地球物理学的核心任务。本练习 [@problem_id:3598357] 直接解决了在交错网格有限差分法中实现自由表面边界条件的实际挑战，这是一种广泛应用于地震波模拟的技术。你将推导出一个保持计算精度的单边差分格式，确保在不引入非物理能量的情况下，正确地在离散模型中施加 $\\sigma_{yz}=0$ 的条件，这是保证数值模拟稳定性和准确性的关键一步。", "problem": "考虑一个占据 $z \\ge 0$ 的均匀、各向同性半空间中的剪切水平（SH）弹性动力学问题，其在 $z=0$ 处有一个自由表面。设材料密度为 $\\rho$，剪切模量为 $\\mu$，二者均为常数。在SH运动中，平面外位移为 $u_y(x,z,t)$，唯一非零的应力分量是 $\\sigma_{xy}$ 和 $\\sigma_{yz}$。连续控制方程为\n$$\n\\rho \\, \\frac{\\partial^2 u_y}{\\partial t^2} \\;=\\; \\mu \\left( \\frac{\\partial^2 u_y}{\\partial x^2} + \\frac{\\partial^2 u_y}{\\partial z^2} \\right),\n\\quad\n\\sigma_{xy} \\;=\\; \\mu \\, \\frac{\\partial u_y}{\\partial x},\n\\quad\n\\sigma_{yz} \\;=\\; \\mu \\, \\frac{\\partial u_y}{\\partial z},\n$$\n在自由表面上，无牵引力边界条件为\n$$\n\\sigma_{yz}(x,0,t) \\;=\\; 0.\n$$\n\n在间距为 $\\Delta x$ 和 $\\Delta z$ 的均匀笛卡尔交错网格上对半空间进行离散化，其中 $u_y$ 和 $v_y=\\partial u_y/\\partial t$ 配置在整数网格点 $(x_i,z_j)=(i\\Delta x,j\\Delta z)$ 上，应力 $\\sigma_{xy}$ 配置在 $(x_{i+\\frac{1}{2}},z_j)$ 上，应力 $\\sigma_{yz}$ 配置在 $(x_i,z_{j+\\frac{1}{2}})$ 上。在内部区域，对空间导数使用中心差分；例如，\n$$\n\\sigma_{yz}(i,j+\\tfrac{1}{2},t) \\;=\\; \\mu \\, \\frac{u_y(i,j+1,t) - u_y(i,j,t)}{\\Delta z}.\n$$\n\n在自由表面 $z=0$ 处，你必须为垂直导数构建一个单边差分格式，该格式在施加无牵引力条件 $\\sigma_{yz}(x,0,t)=0$ 的同时，保持内部格式的全局二阶精度。将表面的单边离散导数定义为\n$$\nD_z^{+} u_y(i,0,t) \\;=\\; \\frac{1}{\\Delta z} \\left( c_0 \\, u_y(i,0,t) + c_1 \\, u_y(i,1,t) + c_2 \\, u_y(i,2,t) \\right),\n$$\n并施加条件 $\\sigma_{yz}(i,0,t) = \\mu \\, D_z^{+} u_y(i,0,t) = 0$。\n\n从连续控制方程出发，并使用关于 $z=0$ 的泰勒展开作为精度分析的基本依据，推导 $c_0$、$c_1$ 和 $c_2$ 的值，使得 $D_z^{+} u_y(i,0,t)$ 在 $z=0$ 处以 $\\mathcal{O}(\\Delta z^2)$ 的误差逼近 $\\partial u_y/\\partial z$，确保该格式的全局精度相对于内部中心差分不会降低。然后，在没有源和侧向通量的情况下，验证半离散系统的离散能量平衡，证明离散总能量的变化率等于净离散边界通量，并且你所用的单边差分格式的无牵引力边界条件使 $z=0$ 处的表面通量为零。\n\n你的最终答案必须是上述 $D_z^{+} u_y(i,0,t)$ 定义中的三个系数所组成的行矩阵 $\\left(c_0, c_1, c_2\\right)$。最终的方框表达式中不需要进行数值四舍五入，也不需要单位。", "solution": "在尝试求解之前，将根据所需准则对所述问题进行验证。\n\n### 步骤1：提取已知条件\n- **系统**：在均匀、各向同性的半空间 $z \\ge 0$ 中的剪切水平（SH）弹性动力学。\n- **边界**：位于 $z=0$ 的自由表面。\n- **材料属性**：恒定的密度 $\\rho$ 和恒定的剪切模量 $\\mu$。\n- **场变量**：平面外位移 $u_y(x,z,t)$。\n- **应力分量**：$\\sigma_{xy}$ 和 $\\sigma_{yz}$。\n- **控制方程**：\n  - 波动方程：$\\rho \\, \\frac{\\partial^2 u_y}{\\partial t^2} \\;=\\; \\mu \\left( \\frac{\\partial^2 u_y}{\\partial x^2} + \\frac{\\partial^2 u_y}{\\partial z^2} \\right)$\n  - 本构关系：$\\sigma_{xy} \\;=\\; \\mu \\, \\frac{\\partial u_y}{\\partial x}$, $\\sigma_{yz} \\;=\\; \\mu \\, \\frac{\\partial u_y}{\\partial z}$\n- **边界条件**：无牵引力表面，$\\sigma_{yz}(x,0,t) \\;=\\; 0$。\n- **离散化**：间距为 $\\Delta x$ 和 $\\Delta z$ 的均匀笛卡尔交错网格。\n  - $u_y$ 和 $v_y=\\partial u_y/\\partial t$ 位于整数网格点 $(x_i,z_j)=(i\\Delta x,j\\Delta z)$。\n  - $\\sigma_{xy}$ 位于 $(x_{i+\\frac{1}{2}},z_j)$。\n  - $\\sigma_{yz}$ 位于 $(x_i,z_{j+\\frac{1}{2}})$。\n- **内部格式示例**：中心差分，$\\sigma_{yz}(i,j+\\tfrac{1}{2},t) \\;=\\; \\mu \\, \\frac{u_y(i,j+1,t) - u_y(i,j,t)}{\\Delta z}$。\n- **表面格式定义**：在表面 $z=0$ 处的单边离散导数定义为 $D_z^{+} u_y(i,0,t) \\;=\\; \\frac{1}{\\Delta z} \\left( c_0 \\, u_y(i,0,t) + c_1 \\, u_y(i,1,t) + c_2 \\, u_y(i,2,t) \\right)$。\n- **表面条件实现**：施加 $\\sigma_{yz}(i,0,t) = \\mu \\, D_z^{+} u_y(i,0,t) = 0$。\n- **精度要求**：格式必须在 $z=0$ 处以 $\\mathcal{O}(\\Delta z^2)$ 的误差逼近 $\\partial u_y/\\partial z$。\n- **任务**：\n  1. 推导系数 $c_0$、$c_1$ 和 $c_2$。\n  2. 验证离散能量平衡，证明总能量的变化率等于净边界通量，并且所实现的边界条件使 $z=0$ 处的表面通量为零。\n- **要求的最终答案**：系数 $(c_0, c_1, c_2)$ 组成的行矩阵。\n\n### 步骤2：使用提取的已知条件进行验证\n该问题具有科学依据，是适定且客观的。它描述了计算地球物理学中的一个典型问题：为波传播模拟实现自由表面边界条件。其控制物理、数值方法（交错网格有限差分）以及格式推导的数学技术（泰勒级数分析）都是标准且成熟的。该问题是自洽的，提供了推导所请求系数所需的所有定义和方程。任务逻辑结构清晰，能够导出一个唯一且有意义的系数解。检查清单中未发现任何缺陷。\n\n### 步骤3：结论与行动\n问题有效。将提供解答。\n\n### 解答\n该问题要求推导一个二阶精度的单边有限差分格式的系数，并随后分析该格式在边界处的能量平衡。\n\n**第一部分：格式系数的推导**\n\n目标是找到系数 $c_0$、$c_1$ 和 $c_2$，使得离散算子 $D_z^{+}$ 在表面 $z=0$ 处以 $\\mathcal{O}(\\Delta z^2)$ 的截断误差逼近连续一阶导数 $\\frac{\\partial}{\\partial z}$。\n该算子定义为：\n$$D_z^{+} u_y(i,0,t) = \\frac{1}{\\Delta z} \\left( c_0 \\, u_y(i,0,t) + c_1 \\, u_y(i,1,t) + c_2 \\, u_y(i,2,t) \\right)$$\n为简单起见，我们分析一个通用光滑函数 $u(z)$ 及其在 $z=0$ 处的导数。设 $u_j = u(j\\Delta z)$。问题在于逼近 $u'(0)$。\n我们对点 $z_1=\\Delta z$ 和 $z_2=2\\Delta z$ 使用 $u(z)$ 在 $z=0$ 附近的泰勒级数展开：\n$$u_1 = u(\\Delta z) = u(0) + \\Delta z \\, u'(0) + \\frac{\\Delta z^2}{2} u''(0) + \\frac{\\Delta z^3}{6} u'''(0) + \\mathcal{O}(\\Delta z^4)$$\n$$u_2 = u(2\\Delta z) = u(0) + 2\\Delta z \\, u'(0) + \\frac{(2\\Delta z)^2}{2} u''(0) + \\frac{(2\\Delta z)^3}{6} u'''(0) + \\mathcal{O}(\\Delta z^4)$$\n将这些展开式代入离散算子的定义中：\n$$\\Delta z \\, D_z^{+} u(0) = c_0 u(0) + c_1 \\left( u(0) + \\Delta z \\, u'(0) + \\frac{\\Delta z^2}{2} u''(0) + \\dots \\right) + c_2 \\left( u(0) + 2\\Delta z \\, u'(0) + \\frac{4\\Delta z^2}{2} u''(0) + \\dots \\right)$$\n我们按 $u$ 在 $z=0$ 处的导数阶数对各项进行分组：\n$$D_z^{+} u(0) = \\frac{1}{\\Delta z}(c_0 + c_1 + c_2)u(0) + (c_1 + 2c_2)u'(0) + \\frac{\\Delta z}{2}(c_1 + 4c_2)u''(0) + \\frac{\\Delta z^2}{6}(c_1 + 8c_2)u'''(0) + \\mathcal{O}(\\Delta z^3)$$\n为了使该表达式成为 $u'(0)$ 的一个二阶精度近似，我们必须将各导数项的系数与目标表达式 $u'(0) + \\mathcal{O}(\\Delta z^2)$ 的系数相匹配。这为 $c_0, c_1, c_2$ 产生了一个线性方程组：\n1.  $u(0)$ 的系数必须为零：\n    $$c_0 + c_1 + c_2 = 0$$\n2.  $u'(0)$ 的系数必须为一：\n    $$c_1 + 2c_2 = 1$$\n3.  $\\Delta z \\cdot u''(0)$ 项的系数必须为零，以确保误差至少为 $\\mathcal{O}(\\Delta z^2)$：\n    $$\\frac{1}{2}(c_1 + 4c_2) = 0 \\implies c_1 + 4c_2 = 0$$\n\n现在我们求解这个包含三个未知系数的线性方程组。\n由方程(3)可得 $c_1 = -4c_2$。\n将其代入方程(2)：\n$$-4c_2 + 2c_2 = 1 \\implies -2c_2 = 1 \\implies c_2 = -\\frac{1}{2}$$\n现在，我们求出 $c_1$：\n$$c_1 = -4c_2 = -4\\left(-\\frac{1}{2}\\right) = 2$$\n最后，使用方程(1)，我们求出 $c_0$：\n$$c_0 = -c_1 - c_2 = -2 - \\left(-\\frac{1}{2}\\right) = -\\frac{3}{2}$$\n因此，二阶精度单边格式的系数为：\n$$c_0 = -\\frac{3}{2}, \\quad c_1 = 2, \\quad c_2 = -\\frac{1}{2}$$\n截断误差的主项由 $u'''(0)$ 的系数给出：\n$$\\text{Error} = \\frac{\\Delta z^2}{6}(c_1 + 8c_2)u'''(0) = \\frac{\\Delta z^2}{6}\\left(2 + 8\\left(-\\frac{1}{2}\\right)\\right)u'''(0) = \\frac{\\Delta z^2}{6}(2 - 4)u'''(0) = -\\frac{1}{3}\\Delta z^2 u'''(0)$$\n误差确实是 $\\mathcal{O}(\\Delta z^2)$ 阶，符合要求。\n\n**第二部分：离散能量平衡验证**\n\n该问题要求验证离散能量平衡以及自由表面边界条件的作用。弹性介质的总能量 $E$ 是动能 $E_{kin}$ 和势能（应变能）$E_{pot}$ 的总和。体积 $V$ 内总能量的变化率等于穿过其边界 $\\partial V$ 的能量通量的负值。\n$$\\frac{dE}{dt} = \\frac{d}{dt} \\int_V \\left( \\frac{1}{2}\\rho \\left(\\frac{\\partial u_y}{\\partial t}\\right)^2 + \\frac{\\mu}{2} (\\nabla u_y \\cdot \\nabla u_y) \\right) dV = - \\oint_{\\partial V} (\\mathbf{v} \\cdot \\mathbf{t}) \\, dS$$\n此处，$\\mathbf{v} = \\frac{\\partial u_y}{\\partial t} \\mathbf{e}_y$ 是质点速度矢量，$\\mathbf{t} = \\boldsymbol{\\sigma} \\cdot \\mathbf{n}$ 是法向为 $\\mathbf{n}$ 的表面上的牵引力矢量。项 $\\mathbf{v} \\cdot \\mathbf{t}$ 表示应力在边界上做功的速率，即能量通量。\n\n在自由表面 $z=0$ 处，外法线是 $\\mathbf{n} = -\\mathbf{e}_z$。$y$ 方向上的牵引力矢量分量是 $t_y = (\\boldsymbol{\\sigma}\\cdot\\mathbf{n})_y = \\sigma_{yx}n_x + \\sigma_{yy}n_y + \\sigma_{yz}n_z$。对于我们的几何结构，这简化为 $t_y = \\sigma_{yz}(-1) = -\\sigma_{yz}$。\n穿过自由表面的能量通量是 $v_y t_y = -v_y \\sigma_{yz}$。\n\n连续边界条件是 $\\sigma_{yz}(x,0,t) = 0$。这直接意味着穿过自由表面的能量通量为零：\n$$\\text{Flux}|_{z=0} = -v_y(x,0,t) \\sigma_{yz}(x,0,t) = -v_y(x,0,t) \\cdot 0 = 0$$\n因此，一个完美的自由表面既不辐射也不吸收能量。\n\n现在我们考虑离散系统。一个构造良好的数值格式应该模仿这种能量守恒特性。在网格上求和的离散总能量的变化率必须等于通过区域边界的净通量。\n该问题将自由表面节点 $(i,0)$ 处的边界条件的数值实现指定为：\n$$\\sigma_{yz}(i,0,t) = \\mu D_z^{+} u_y(i,0,t) = 0$$\n这是在离散层面上对无牵引力条件的强制执行。在网格列 $i$ 处穿过表面的离散能量通量是离散速度 $v_y(i,0,t)$ 与此表面相关的离散牵引力的乘积。根据连续情况的类比，离散通量正比于 $v_y(i,0,t)\\sigma_{yz}(i,0,t)$。\n通过施加条件 $\\sigma_{yz}(i,0,t) = 0$，我们明确地将离散通量项中的一个因子设为零。\n$$\\text{Discrete Flux}|_{z=0, \\text{node }i} \\propto v_y(i,0,t) \\cdot \\sigma_{yz}(i,0,t) = v_y(i,0,t) \\cdot 0 = 0$$\n因此，使用推导出的单边格式来实现无牵引力边界条件，可确保通过离散自由表面的数值能量通量为零。这可以防止非物理能量在边界处累积，并有助于数值模拟的整体稳定性和准确性，确保离散系统（在没有其他通量或源的情况下）能量守恒。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n-\\frac{3}{2}  2  -\\frac{1}{2}\n\\end{pmatrix}\n}\n$$", "id": "3598357"}, {"introduction": "任何数值模拟的最终检验标准是其再现真实物理现象的能力。本练习 [@problem_id:3598445] 提供了一个经典的验证案例：利用兰姆问题 (Lamb's problem) 的解析解来检验你的自由表面实现。你将通过编程计算数值模型产生的瑞利波 (Rayleigh wave) 的相速度和质点运动轨迹，并将其与理论预测进行比较，瑞利波是自由表面存在的最显著物理特征，这一实践将确保你的代码不仅在数学上正确，在物理上也是可信的。", "problem": "考虑一个占据 $z \\ge 0$ 的各向同性、均匀、线弹性半空间，其在 $z=0$ 处具有无牵引力边界。设介质的特征为拉梅参数 $\\lambda$ 和 $\\mu$、质量密度 $\\rho$、压缩波速 $V_p = \\sqrt{(\\lambda + 2 \\mu)/\\rho}$ 和剪切波速 $V_s = \\sqrt{\\mu/\\rho}$。设泊松比定义为 $\\nu = \\lambda/[2(\\lambda + \\mu)]$。一个水平传播的瑞利面波沿 $x$ 方向以相速度 $c_R$ 传播，并随深度 $z$ 呈指数衰减，其中 $z=0$ 为自由表面。\n\n从弹性动力学 Navier 方程 $ \\rho \\, \\partial^2 \\mathbf{u} / \\partial t^2 = (\\lambda + \\mu) \\nabla (\\nabla \\cdot \\mathbf{u}) + \\mu \\nabla^2 \\mathbf{u} $ 以及 $z=0$ 处的无牵引力边界条件开始，推导决定瑞利波速 $c_R$ 作为 $V_p$ 和 $V_s$ 函数的自由表面久期条件。对于二维平面内运动，使用标量势 $\\phi$ 和简化为标量 $\\psi$ 的矢量势的势函数表示法，并施加无牵引力条件 $T_{xz}(z=0)=0$ 和 $T_{zz}(z=0)=0$。证明自由表面上的位移分量相位差为 $\\pi/2$ (弧度)，导致椭圆形的质点运动，并推导在 $z=0$ 处此椭圆的垂直半轴与水平半轴长度之比的闭合形式表达式，该表达式是 $c_R$、$V_p$ 和 $V_s$ 的函数。\n\n您的程序必须实现两种独立的验证路径，作为泊松比 $\\nu$ 的函数：\n\n1. 一个“计算”路径，通过求根法数值求解无牵引力久期条件，得到无量纲瑞利波速 $ \\beta = c_R/V_s $，然后通过在一个周期内采样时间演化 $u_x(t)$ 和 $u_z(t)$，从最大绝对值中获得半轴长度，从而数值估计 $z=0$ 处的质点运动椭圆。角度使用弧度。设水平波数为 $k = 1$ rad/m，剪切波速为 $V_s = 2000$ m/s。采样时使用非色散关系 $ \\omega = k \\, c_R $。\n\n2. 一个“解析”路径，通过求解久期条件中消去根式后产生的关于 $w = \\beta^2$ 的瑞利波三次多项式来获得 $c_R$，选择满足 $0  w  1$ 的物理上可接受的根，然后根据无牵引力条件所隐含的自由表面特征向量，计算椭圆半轴比的闭合形式表达式。\n\n使用这两种路径，为每个测试用例计算：\n- 瑞利波速的相对误差，定义为 $ |c_R^{\\text{comp}} - c_R^{\\text{anal}}| / c_R^{\\text{anal}} $ (无量纲)。\n- 表面处椭圆半轴比的绝对误差，定义为 $ |R^{\\text{comp}} - R^{\\text{anal}}| $ (无量纲)。\n\n在适当之处必须使用物理单位：\n- 内部所有速度均以 $\\text{m/s}$ 表示。\n- 任何三角函数求值均使用弧度。\n\n测试套件：\n- 案例 1: $ \\nu = 0.00 $\n- 案例 2: $ \\nu = 0.25 $\n- 案例 3: $ \\nu = 0.33 $\n- 案例 4: $ \\nu = 0.49 $\n\n对于每个案例，设置 $ V_s = 2000 $ m/s 和 $ k = 1 $ rad/m。通过各向同性弹性关系从 $ \\nu $ 计算 $ V_p $：$ V_p / V_s = \\sqrt{ 2 (1 - \\nu) / (1 - 2 \\nu) } $。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，其中每个元素对应一个测试用例，并且本身是一个包含上述两个误差的双元素列表 $[e_{\\text{speed}}, e_{\\text{ratio}}]$。例如，输出应具有以下形式：\n[[e_speed_case1,e_ratio_case1],[e_speed_case2,e_ratio_case2],[e_speed_case3,e_ratio_case3],[e_speed_case4,e_ratio_case4]]", "solution": "该问题要求推导并数值实现瑞利波在均匀、各向同性、线弹性半空间自由表面上传播的解。这涉及到推导控制波速的久期方程以及表面质点运动的表达式。通过将数值求根方法与基于解析多项式的方法进行比较来验证解答。\n\n起点是位移矢量 $\\mathbf{u}(\\mathbf{x}, t)$ 的弹性动力学 Navier 方程：\n$$ \\rho \\, \\frac{\\partial^2 \\mathbf{u}}{\\partial t^2} = (\\lambda + \\mu) \\nabla (\\nabla \\cdot \\mathbf{u}) + \\mu \\nabla^2 \\mathbf{u} $$\n其中 $\\rho$ 是质量密度，$\\lambda, \\mu$ 是拉梅参数。我们使用 Helmholtz 分解，用一个标量势 $\\phi$ 和一个矢量势 $\\boldsymbol{\\psi}$ 来表示位移场：\n$$ \\mathbf{u} = \\nabla\\phi + \\nabla \\times \\boldsymbol{\\psi} $$\n规范条件为 $\\nabla \\cdot \\boldsymbol{\\psi} = 0$。将其代入 Navier 方程，可将其解耦为两个波动方程：\n$$ \\nabla^2\\phi = \\frac{1}{V_p^2} \\frac{\\partial^2\\phi}{\\partial t^2} \\quad , \\quad \\nabla^2\\boldsymbol{\\psi} = \\frac{1}{V_s^2} \\frac{\\partial^2\\boldsymbol{\\psi}}{\\partial t^2} $$\n其中 $V_p = \\sqrt{(\\lambda+2\\mu)/\\rho}$ 是压缩波速，$V_s = \\sqrt{\\mu/\\rho}$ 是剪切波速。\n\n对于 $x-z$ 平面内的二维运动，且沿 $x$ 轴传播，我们有 $\\mathbf{u} = (u_x(x,z,t), 0, u_z(x,z,t))$。矢量势可以简化为 $\\boldsymbol{\\psi} = (0, \\psi(x,z,t), 0)$。位移分量为：\n$$ u_x = \\frac{\\partial\\phi}{\\partial x} - \\frac{\\partial\\psi}{\\partial z} \\quad , \\quad u_z = \\frac{\\partial\\phi}{\\partial z} + \\frac{\\partial\\psi}{\\partial x} $$\n我们寻求沿 $x$ 方向传播的谐波解，其相速度为 $c_R$，角频率为 $\\omega=kc_R$，其中 $k$ 是波数。对于面波，振幅必须随深度 $z \\ge 0$ 衰减。势函数的解为：\n$$ \\phi(x,z,t) = A \\exp(-q_p z) \\exp[i(kx - \\omega t)] $$\n$$ \\psi(x,z,t) = B \\exp(-q_s z) \\exp[i(kx - \\omega t)] $$\n其中 $A$ 和 $B$ 是复振幅。将它们代入波动方程，得到垂直衰减常数：\n$$ q_p = \\sqrt{k^2 - \\frac{\\omega^2}{V_p^2}} = k \\sqrt{1 - \\frac{c_R^2}{V_p^2}} $$\n$$ q_s = \\sqrt{k^2 - \\frac{\\omega^2}{V_s^2}} = k \\sqrt{1 - \\frac{c_R^2}{V_s^2}} $$\n为了使波被限制在表面，衰减常数 $q_p$ 和 $q_s$ 必须为正实数，这要求 $c_R  V_s$ 且 $c_R  V_p$。\n\n$z=0$ 处的边界是无牵引力的，意味着应力分量 $\\sigma_{xz}$ 和 $\\sigma_{zz}$ 为零。各向同性介质的应力-应变关系为：\n$$ \\sigma_{xz} = \\mu \\left( \\frac{\\partial u_x}{\\partial z} + \\frac{\\partial u_z}{\\partial x} \\right) $$\n$$ \\sigma_{zz} = \\lambda \\left( \\frac{\\partial u_x}{\\partial x} + \\frac{\\partial u_z}{\\partial z} \\right) + 2\\mu \\frac{\\partial u_z}{\\partial z} = \\lambda \\nabla^2\\phi + 2\\mu \\left( \\frac{\\partial^2\\phi}{\\partial z^2} + \\frac{\\partial^2\\psi}{\\partial x \\partial z} \\right) $$\n代入势函数解并在 $z=0$ 处求值：\n$$ \\sigma_{xz}|_{z=0} = \\mu \\left[ 2ik(-q_p)A + (k^2+q_s^2)B \\right] \\exp[i(kx-\\omega t)] = 0 $$\n$$ \\sigma_{zz}|_{z=0} = \\left[ A(-\\lambda k^2 - \\lambda q_p^2 + 2\\mu q_p^2) + B(2\\mu ik q_s) \\right] \\exp[i(kx-\\omega t)] = 0 $$\n$\\sigma_{zz}$ 方程中 $A$ 的系数可以简化。使用 $\\lambda k^2 + \\lambda q_p^2 = \\lambda \\omega^2 / V_p^2 = \\rho \\omega^2 (\\lambda / (\\lambda+2\\mu))$ 和 $2\\mu q_p^2$，我们得到 $(\\lambda+2\\mu)q_p^2 - \\lambda k^2 = \\rho V_p^2 q_p^2 - \\lambda k^2 = \\rho V_p^2 (k^2-\\omega^2/V_p^2) - \\lambda k^2 = k^2(\\rho c_R^2 - 2\\mu) = -\\mu(k^2+q_s^2)$。注意，在位移定义（$u_x = \\partial\\phi/\\partial x + \\partial\\psi/\\partial z$）中为 $\\psi$ 选择不同的符号约定会导致一个不同的方程组。根据我们的符号约定，我们得到：\n$$ -2ikq_p A - (k^2+q_s^2) B = 0 $$\n$$ (k^2+q_s^2) A - 2ikq_s B = 0 $$\n这是一个关于振幅 $A$ 和 $B$ 的齐次线性方程组。为了得到非平凡解，系数矩阵的行列式必须为零：\n$$ (-2ikq_p)(-2ikq_s) - (-(k^2+q_s^2))(k^2+q_s^2) = 0 $$\n$$ -4k^2q_p q_s + (k^2+q_s^2)^2 = 0 \\implies (2-\\beta^2)^2 = 4\\sqrt{1-\\beta^2}\\sqrt{1-\\gamma^2\\beta^2} $$\n这就是瑞利波速的久期方程，用无量纲速度 $\\beta = c_R/V_s$ 和速度比 $\\gamma = V_s/V_p$ 表示。项 $\\gamma^2$ 可以表示为泊松比 $\\nu$ 的函数：$\\gamma^2 = V_s^2/V_p^2 = (1-2\\nu)/(2(1-\\nu))$。这个超越方程构成了通过数值求根实现“计算”路径的基础。\n\n将久期方程平方以消去根式，经过代数变换并除以因子 $w=\\beta^2$ 后，得到一个关于 $w$ 的三次多项式：\n$$ w^3 - 8w^2 + (24 - 16\\gamma^2)w + 16(\\gamma^2-1) = 0 $$\n该多项式有一个物理上有意义的实根 $w_0 \\in (0,1)$。求解这个三次方程得到 $w_0$，然后取平方根得到 $\\beta = \\sqrt{w_0}$，这是“解析”路径的基础。\n\n接下来，我们分析自由表面 $z=0$ 处的质点运动。位移分量为：\n$$ u_x(x,0,t) = (ikA - (-q_s)B) e^{i(kx-\\omega t)} = (ikA + q_s B) e^{i(kx-\\omega t)} $$\n$$ u_z(x,0,t) = (-q_pA + ikB) e^{i(kx-\\omega t)} $$\n使用线性方程组第二行的关系式 $B = \\frac{(k^2+q_s^2)}{2ikq_s}A$，我们可以仅用 $A$ 来表示位移。简化后，我们发现：\n$$ u_x(x,0,t) = i A \\frac{k\\beta^2}{2} e^{i(kx-\\omega t)} $$\n$$ u_z(x,0,t) = A k \\left( \\frac{\\beta^2\\sqrt{1-\\gamma^2\\beta^2}}{2-\\beta^2} \\right) e^{i(kx-\\omega t)} $$\n我们选择 $x=0$ 和一个实振幅 $A_r > 0$。物理位移是其實部：\n$$ u_x(t) = \\text{Re}\\left[ i \\left( A_r \\frac{k\\beta^2}{2} \\right) e^{-i\\omega t} \\right] = -A_r \\frac{k\\beta^2}{2} \\sin(-\\omega t) = \\left( A_r \\frac{k\\beta^2}{2} \\right) \\sin(\\omega t) $$\n$$ u_z(t) = \\text{Re}\\left[ A_r k \\left( \\frac{\\beta^2\\sqrt{1-\\gamma^2\\beta^2}}{2-\\beta^2} \\right) e^{-i\\omega t} \\right] = A_r k \\left( \\frac{\\beta^2\\sqrt{1-\\gamma^2\\beta^2}}{2-\\beta^2} \\right) \\cos(\\omega t) $$\n$u_x$ 中的 $\\sin(\\omega t)$ 和 $u_z$ 中的 $\\cos(\\omega t)$ 表明，运动的水平和垂直分量是正交的，即相位相差 $\\pi/2$。它们的组合 $(u_x/H)^2 + (u_z/V)^2=1$ 描述了一个椭圆，其中 $H$ 和 $V$ 是半轴长度（振幅）。垂直半轴与水平半轴长度之比 $R = V/H$ 为：\n$$ R = \\frac{|A_r k \\frac{\\beta^2\\sqrt{1-\\gamma^2\\beta^2}}{2-\\beta^2}|}{|A_r \\frac{k\\beta^2}{2}|} = \\frac{2\\sqrt{1-\\gamma^2\\beta^2}}{2-\\beta^2} $$\n利用久期方程，这可以改写成一个更简单的形式：\n$$ R = \\frac{2-\\beta^2}{2\\sqrt{1-\\beta^2}} $$\n这个闭合形式表达式将用于“解析”路径中计算半轴比。对于“计算”路径，该比率将按规定通过数值计算一个周期内 $u_x(t)$ 和 $u_z(t)$ 时间序列的最大振幅来确定。\n\n两种计算路径是：\n1.  **计算路径**：对于给定的 $\\nu$，计算 $\\gamma^2$。使用求根器数值求解超越久期方程，得到 $\\beta^{\\text{comp}} \\in (0,1)$。计算 $c_R^{\\text{comp}} = \\beta^{\\text{comp}} V_s$。然后，确定势函数 $\\phi$ 和 $\\psi$ 的复振幅，构建 $z=0$ 处 $u_x(t)$ 和 $u_z(t)$ 的时域信号，找到它们的最大绝对值，并计算其比率 $R^{\\text{comp}}$。\n2.  **解析路径**：对于给定的 $\\nu$，计算 $\\gamma^2$ 并构造关于 $w=\\beta^2$ 的三次多项式的系数。求出多项式的根，并选择唯一的物理根 $w_0 \\in (0,1)$。计算 $\\beta^{\\text{anal}} = \\sqrt{w_0}$ 和 $c_R^{\\text{anal}} = \\beta^{\\text{anal}} V_s$。最后，使用闭合形式表达式 $R^{\\text{anal}} = (2-w_0)/(2\\sqrt{1-w_0})$ 来求得半轴比。\n\n速度的相对误差 $|c_R^{\\text{comp}} - c_R^{\\text{anal}}| / c_R^{\\text{anal}}$ 和比率的绝对误差 $|R^{\\text{comp}} - R^{\\text{anal}}|$ 将用于验证两种方法之间的一致性以及实现的正确性。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import optimize\n\ndef solve():\n    \"\"\"\n    Solves for Rayleigh wave properties using two different pathways\n    and computes the errors between them for a suite of test cases.\n    \"\"\"\n\n    def computed_pathway(nu, Vs, k):\n        \"\"\"\n        Computes Rayleigh speed and ellipse ratio via numerical root-finding\n        of the secular equation and time-series sampling of particle motion.\n        \n        Args:\n            nu (float): Poisson's ratio.\n            Vs (float): Shear wave speed in m/s.\n            k (float): Wavenumber in rad/m.\n\n        Returns:\n            tuple: (c_R_comp, R_comp)\n                   c_R_comp: Computed Rayleigh wave speed (m/s).\n                   R_comp: Computed ratio of vertical to horizontal semi-axes.\n        \"\"\"\n        if nu = 0.5:\n             # Vp - infinity, gamma_sq - 0. Handle this limit case.\n             gamma_sq = 0.0\n        else:\n             gamma_sq = (1.0 - 2.0 * nu) / (2.0 * (1.0 - nu))\n\n        # Secular function f(beta) = 0\n        def secular_function(beta):\n            beta_sq = beta**2\n            # Avoid domain errors for sqrt by checking arguments\n            if beta_sq = 1.0 or gamma_sq * beta_sq = 1.0:\n                # Return a large number outside the valid domain of beta in (0,1)\n                return 1e18  \n            return (2.0 - beta_sq)**2 - 4.0 * np.sqrt(1.0 - beta_sq) * np.sqrt(1.0 - gamma_sq * beta_sq)\n\n        # Find the root beta = c_R/V_s in the interval (0, 1)\n        # The root is known to be in (0.87, 0.96) for nu in [0, 0.5]\n        try:\n            beta_comp = optimize.brentq(secular_function, 0.1, 0.999)\n        except ValueError:\n            # Fallback if root is not in bracket, though it should be\n            return np.nan, np.nan\n            \n        c_R_comp = beta_comp * Vs\n\n        # Numerically estimate the ellipse ratio by sampling particle motion\n        omega = k * c_R_comp\n        T = 2.0 * np.pi / omega\n        num_samples = 2000\n        t = np.linspace(0, T, num_samples)\n\n        # Amplitudes derived from the boundary condition system\n        # Set arbitrary potential amplitude A=1\n        A_pot = 1.0 + 0.0j \n        beta_comp_sq = beta_comp**2\n        \n        qp = k * np.sqrt(1.0 - gamma_sq * beta_comp_sq)\n        qs = k * np.sqrt(1.0 - beta_comp_sq)\n        \n        # Relation from boundary conditions: B_pot = A_pot * (k^2+qs^2) / (2*i*k*qs)\n        B_pot = A_pot * (k**2 + qs**2) / (2.0j * k * qs)\n\n        # Displacement components at z=0 are u_x = ik*phi + qs*psi, u_z = -qp*phi + ik*psi\n        # (This corresponds to u = grad(phi) + curl(psi) with curl(psi) = (-dpsi/dz, 0, dpsi/dx))\n        # and potentials phi = A_pot * exp(...), psi = B_pot * exp(...)\n        \n        ux_complex_amp = 1.0j * k * A_pot + qs * B_pot\n        uz_complex_amp = -qp * A_pot + 1.0j * k * B_pot\n        \n        ux_t = np.real(ux_complex_amp * np.exp(-1.0j * omega * t))\n        uz_t = np.real(uz_complex_amp * np.exp(-1.0j * omega * t))\n\n        # Semi-axis lengths are max absolute values\n        H_comp = np.max(np.abs(ux_t))\n        V_comp = np.max(np.abs(uz_t))\n        \n        R_comp = V_comp / H_comp if H_comp != 0 else np.inf\n\n        return c_R_comp, R_comp\n\n    def analytic_pathway(nu, Vs):\n        \"\"\"\n        Computes Rayleigh speed and ellipse ratio by solving the cubic\n        polynomial and using the closed-form expression for the ratio.\n\n        Args:\n            nu (float): Poisson's ratio.\n            Vs (float): Shear wave speed in m/s.\n\n        Returns:\n            tuple: (c_R_anal, R_anal)\n                   c_R_anal: Analytic Rayleigh wave speed (m/s).\n                   R_anal: Analytic ratio of vertical to horizontal semi-axes.\n        \"\"\"\n        if nu = 0.5:\n             gamma_sq = 0.0\n        else:\n             gamma_sq = (1.0 - 2.0 * nu) / (2.0 * (1.0 - nu))\n\n        # Coefficients of the cubic polynomial w^3 - 8w^2 + (24-16g^2)w + 16(g^2-1) = 0\n        coeffs = [1.0, -8.0, 24.0 - 16.0 * gamma_sq, 16.0 * gamma_sq - 16.0]\n        roots = np.roots(coeffs)\n        \n        # Find the physically admissible root w = (c_R/V_s)^2, which is real and in (0,1)\n        w_anal = -1.0\n        for r in roots:\n            if np.isclose(r.imag, 0) and 0  r.real  1:\n                w_anal = r.real\n                break\n\n        if w_anal  0:\n            return np.nan, np.nan # Should not happen for physical nu\n\n        beta_anal = np.sqrt(w_anal)\n        c_R_anal = beta_anal * Vs\n        \n        # Closed-form expression for the semi-axis ratio\n        R_anal = (2.0 - w_anal) / (2.0 * np.sqrt(1.0 - w_anal))\n\n        return c_R_anal, R_anal\n\n    # --- Main execution loop ---\n    test_cases = [\n        0.00,  # Case 1\n        0.25,  # Case 2\n        0.33,  # Case 3\n        0.49,  # Case 4\n    ]\n\n    Vs = 2000.0  # m/s\n    k = 1.0      # rad/m\n\n    results = []\n    for nu in test_cases:\n        c_R_comp, R_comp = computed_pathway(nu, Vs, k)\n        c_R_anal, R_anal = analytic_pathway(nu, Vs)\n        \n        # Calculate errors\n        # Relative error in speed\n        if c_R_anal != 0:\n            e_speed = np.abs(c_R_comp - c_R_anal) / c_R_anal\n        else:\n            e_speed = np.nan\n        \n        # Absolute error in ratio\n        e_ratio = np.abs(R_comp - R_anal)\n        \n        results.append([e_speed, e_ratio])\n\n    # Format output as specified in the problem\n    # Using a simple string representation for the lists\n    output_str_parts = []\n    for res in results:\n        output_str_parts.append(f\"[{res[0]},{res[1]}]\")\n    \n    print(f\"[{','.join(output_str_parts)}]\")\n\n\nsolve()\n```", "id": "3598445"}]}