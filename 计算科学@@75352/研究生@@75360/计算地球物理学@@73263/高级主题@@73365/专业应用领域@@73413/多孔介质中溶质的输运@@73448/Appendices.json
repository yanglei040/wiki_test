{"hands_on_practices": [{"introduction": "在我们将连续介质方程应用于多孔介质之前，必须确保我们的测量尺度足够大，能够平滑微观尺度上的波动，从而得到有意义的平均属性。本练习通过将代表性基本体积（REV）与介质孔隙度的统计特性（方差）相联系，为这一关键尺度提供了定量的定义[@problem_id:3617636]。掌握这一概念对于从微观非均质性过渡到宏观等效参数至关重要，是所有多孔介质建模的理论基石。", "problem": "一个非均质砂岩可以被建模为一个孔隙度的统计平稳且遍历的随机场，记为 $n(\\mathbf{x})$，其平均值恒定为 $\\langle n(\\mathbf{x}) \\rangle = n$，其中 $n = 0.25$。考虑在一个边长为 $L$、体积为 $V = L^{3}$ 的立方体测量窗口上计算孔隙度的空间平均值，即\n$$\n\\bar{n}_{V} = \\frac{1}{V} \\int_{V} n(\\mathbf{x}) \\, d^{3}\\mathbf{x}.\n$$\n设孔隙度波动的两点协方差为 $C(\\mathbf{r}) = \\langle \\big(n(\\mathbf{x}) - n\\big)\\big(n(\\mathbf{x}+\\mathbf{r}) - n\\big) \\rangle$，并假设其可积且衰减足够快，以至于协方差积分\n$$\n\\sigma_{0}^{2} = \\int_{\\mathbb{R}^{3}} C(\\mathbf{r}) \\, d^{3}\\mathbf{r}\n$$\n存在且有限。此处的代表性单元体积（REV）定义为能使体积平均孔隙度的相对波动满足以下条件的最小立方体尺寸 $L$：\n$$\n\\frac{\\sqrt{\\mathrm{Var}[\\bar{n}_{V}]}}{n} \\le \\epsilon,\n$$\n其中容差为 $\\epsilon = 0.01$。从空间平均值方差与协方差函数相关的基本定义出发，并仅使用所述假设，推导当 $L$ 很大时 $\\mathrm{Var}[\\bar{n}_{V}]$ 随 $V$ 变化的渐近标度关系，然后确定满足 REV 准则的最小 $L$。\n\n您的最终答案必须是一个关于最小 $L$ 的封闭形式解析表达式，用 $n$、$\\epsilon$ 和 $\\sigma_{0}$ 表示，并代入数值 $n = 0.25$ 和 $\\epsilon = 0.01$。长度尺度以米为单位表示。无需四舍五入。", "solution": "在尝试解答之前，对问题进行验证。\n\n### 步骤 1：提取已知条件\n- 孔隙度场 $n(\\mathbf{x})$ 是一个统计平稳且遍历的随机场。\n- 平均孔隙度为常数：$\\langle n(\\mathbf{x}) \\rangle = n = 0.25$。\n- 孔隙度的空间平均值定义在一个边长为 $L$、体积为 $V = L^{3}$ 的立方体测量窗口上：\n$$\n\\bar{n}_{V} = \\frac{1}{V} \\int_{V} n(\\mathbf{x}) \\, d^{3}\\mathbf{x}.\n$$\n- 孔隙度波动的两点协方差为 $C(\\mathbf{r}) = \\langle \\big(n(\\mathbf{x}) - n\\big)\\big(n(\\mathbf{x}+\\mathbf{r}) - n\\big) \\rangle$。\n- 协方差函数 $C(\\mathbf{r})$ 可积且衰减足够快。\n- 协方差积分定义为 $\\sigma_{0}^{2} = \\int_{\\mathbb{R}^{3}} C(\\mathbf{r}) \\, d^{3}\\mathbf{r}$，且其值为有限。\n- 代表性单元体积（REV）准则由相对孔隙度波动定义：\n$$\n\\frac{\\sqrt{\\mathrm{Var}[\\bar{n}_{V}]}}{n} \\le \\epsilon,\n$$\n- 指定的容差为 $\\epsilon = 0.01$。\n\n### 步骤 2：使用提取的已知条件进行验证\n- **科学依据：**该问题基于统计力学和地质统计学的基本原理在多孔介质中的应用，这是计算地球物理学和水文地质学的核心课题。空间平均、协方差、遍历性以及 REV 的定义等概念都是标准的、科学合理的。\n- **适定性：**该问题是适定的。它要求推导一个标准的渐近结果并加以应用。所有必要的定义、变量（$n, \\epsilon, \\sigma_0$）和假设（平稳性、遍历性、可积协方差）都已给出，足以唯一确定所需的解析表达式。“大 $L$” 条件恰当地定义了推导所需的渐近区域。\n- **客观性：**该问题使用精确、客观的数学和科学语言陈述，没有歧义或主观看法。\n- **完整性与一致性：**该问题是自洽的且内部一致。定义和约束条件互不矛盾。量纲分析证实了其一致性：由于孔隙度 $n$ 是无量纲的，其协方差 $C(\\mathbf{r})$ 也是无量纲的。因此，积分 $\\sigma_{0}^{2} = \\int_{\\mathbb{R}^{3}} C(\\mathbf{r}) \\, d^{3}\\mathbf{r}$ 的单位是体积，即 $[L]^3$。平均孔隙度的方差 $\\mathrm{Var}[\\bar{n}_{V}]$ 必须是无量纲的。推导出的标度律 $\\mathrm{Var}[\\bar{n}_{V}] \\propto \\sigma_{0}^{2}/V$ 在量纲上是一致的（$[L]^3/[L]^3$）。最终的长度 $L$ 表达式将正确地依赖于 $\\sigma_0$（其单位为 $[L]^{3/2}$）。\n- **其他缺陷：**该问题是统计物理学中一个标准的、非平凡的练习，不存在不适定、不切实际或同义反复等问题。\n\n### 步骤 3：结论与行动\n问题是 **有效的**。将提供一个完整的、有理据的解答。\n\n### 解答推导\n目标是找到满足代表性单元体积（REV）准则的立方体体积 $V=L^3$ 的最小边长 $L$。这需要推导体积平均孔隙度方差 $\\mathrm{Var}[\\bar{n}_{V}]$ 的渐近行为。\n\n首先，我们将 $\\mathrm{Var}[\\bar{n}_{V}]$ 用协方差函数 $C(\\mathbf{r})$ 表示。方差定义为 $\\mathrm{Var}[\\bar{n}_{V}] = \\langle (\\bar{n}_{V} - \\langle \\bar{n}_{V} \\rangle)^2 \\rangle$。我们利用期望算子和积分的线性性质计算平均孔隙度 $\\bar{n}_{V}$ 的期望值：\n$$\n\\langle \\bar{n}_{V} \\rangle = \\left\\langle \\frac{1}{V} \\int_{V} n(\\mathbf{x}) \\, d^{3}\\mathbf{x} \\right\\rangle = \\frac{1}{V} \\int_{V} \\langle n(\\mathbf{x}) \\rangle \\, d^{3}\\mathbf{x}\n$$\n由于场是统计平稳的，平均孔隙度 $\\langle n(\\mathbf{x}) \\rangle = n$ 是一个常数。\n$$\n\\langle \\bar{n}_{V} \\rangle = \\frac{1}{V} \\int_{V} n \\, d^{3}\\mathbf{x} = \\frac{n}{V} \\int_{V} d^{3}\\mathbf{x} = \\frac{n}{V} V = n\n$$\n因此，方差为 $\\mathrm{Var}[\\bar{n}_{V}] = \\langle (\\bar{n}_{V} - n)^2 \\rangle$。我们定义孔隙度波动为 $n'(\\mathbf{x}) = n(\\mathbf{x}) - n$。那么 $(\\bar{n}_{V} - n)$ 项可以写成：\n$$\n\\bar{n}_{V} - n = \\frac{1}{V} \\int_{V} n(\\mathbf{x}) \\, d^{3}\\mathbf{x} - n = \\frac{1}{V} \\int_{V} (n(\\mathbf{x}) - n) \\, d^{3}\\mathbf{x} = \\frac{1}{V} \\int_{V} n'(\\mathbf{x}) \\, d^{3}\\mathbf{x}\n$$\n将此代入方差表达式中：\n$$\n\\mathrm{Var}[\\bar{n}_{V}] = \\left\\langle \\left( \\frac{1}{V} \\int_{V} n'(\\mathbf{x}) \\, d^{3}\\mathbf{x} \\right)^2 \\right\\rangle = \\frac{1}{V^2} \\left\\langle \\left( \\int_{V} n'(\\mathbf{x}) \\, d^{3}\\mathbf{x} \\right) \\left( \\int_{V} n'(\\mathbf{y}) \\, d^{3}\\mathbf{y} \\right) \\right\\rangle\n$$\n这可以写成一个二重积分：\n$$\n\\mathrm{Var}[\\bar{n}_{V}] = \\frac{1}{V^2} \\left\\langle \\int_{V} \\int_{V} n'(\\mathbf{x}) n'(\\mathbf{y}) \\, d^{3}\\mathbf{x} \\, d^{3}\\mathbf{y} \\right\\rangle\n$$\n再次利用期望算子的线性性质：\n$$\n\\mathrm{Var}[\\bar{n}_{V}] = \\frac{1}{V^2} \\int_{V} \\int_{V} \\langle n'(\\mathbf{x}) n'(\\mathbf{y}) \\rangle \\, d^{3}\\mathbf{x} \\, d^{3}\\mathbf{y}\n$$\n项 $\\langle n'(\\mathbf{x}) n'(\\mathbf{y}) \\rangle$ 是两点协方差函数的定义。由于统计平稳性，它仅依赖于分离向量 $\\mathbf{r} = \\mathbf{y} - \\mathbf{x}$。因此，$\\langle n'(\\mathbf{x}) n'(\\mathbf{y}) \\rangle = C(\\mathbf{y}-\\mathbf{x})$。\n$$\n\\mathrm{Var}[\\bar{n}_{V}] = \\frac{1}{V^2} \\int_{V} \\int_{V} C(\\mathbf{y}-\\mathbf{x}) \\, d^{3}\\mathbf{x} \\, d^{3}\\mathbf{y}\n$$\n为了在大体积 $V$ 极限下计算这个六维积分，我们进行变量替换。令 $\\mathbf{r} = \\mathbf{y} - \\mathbf{x}$ 和 $\\mathbf{s} = \\mathbf{x}$。此变换的雅可比行列式为 1。积分区域从 $\\mathbf{x} \\in V, \\mathbf{y} \\in V$ 变为 $\\mathbf{s} \\in V, \\mathbf{s}+\\mathbf{r} \\in V$。这等价于 $\\mathbf{s} \\in V \\cap V_{-\\mathbf{r}}$，其中 $V_{-\\mathbf{r}}$ 是体积 $V$ 沿向量 $-\\mathbf{r}$ 平移后的体积。\n$$\n\\mathrm{Var}[\\bar{n}_{V}] = \\frac{1}{V^2} \\int_{\\mathbb{R}^3} C(\\mathbf{r}) \\left( \\int_{V \\cap V_{-\\mathbf{r}}} d^3\\mathbf{s} \\right) d^3\\mathbf{r}\n$$\n内部积分是 $V$ 与其自身平移 $-\\mathbf{r}$ 后的交集的体积，通常表示为几何因子 $\\gamma_V(\\mathbf{r}) = \\mathrm{Vol}(V \\cap V_{-\\mathbf{r}})$。\n$$\n\\mathrm{Var}[\\bar{n}_{V}] = \\frac{1}{V^2} \\int_{\\mathbb{R}^3} C(\\mathbf{r}) \\gamma_V(\\mathbf{r}) \\, d^3\\mathbf{r}\n$$\n问题要求 $L$ 很大时的渐近标度关系。这对应于体积 $V$ 的尺寸远大于孔隙度场相关长度的情况。相关长度是 $C(\\mathbf{r})$ 显著不为零的特征尺度。问题中指出 $C(\\mathbf{r})$ 衰减“足够快”。\n对于 $|\\mathbf{r}|$ 远小于 $L$ 的值，交集体积 $\\gamma_V(\\mathbf{r})$ 近似等于 $V$。随着 $|\\mathbf{r}|$ 的增加，$\\gamma_V(\\mathbf{r})$ 减小，当两个体积不再重叠时变为零。\n由于 $C(\\mathbf{r})$ 快速衰减，积分的主要贡献来自于小的 $|\\mathbf{r}|$。在这个区域，我们可以近似认为 $\\gamma_V(\\mathbf{r}) \\approx V$。在 $V \\to \\infty$ 的极限下，这个近似是精确的。\n$$\n\\mathrm{Var}[\\bar{n}_{V}] \\approx \\frac{1}{V^2} \\int_{\\mathbb{R}^3} C(\\mathbf{r}) V \\, d^3\\mathbf{r} = \\frac{1}{V} \\int_{\\mathbb{R}^3} C(\\mathbf{r}) \\, d^3\\mathbf{r}\n$$\n使用给定的定义 $\\sigma_{0}^{2} = \\int_{\\mathbb{R}^{3}} C(\\mathbf{r}) \\, d^{3}\\mathbf{r}$，我们得到方差的渐近标度律：\n$$\n\\mathrm{Var}[\\bar{n}_{V}] \\approx \\frac{\\sigma_{0}^{2}}{V}\n$$\n这个结果表明，空间平均值的方差与平均体积成反比衰减。\n\n现在，我们使用这个标度律来确定 REV 的最小尺寸 $L$。准则为：\n$$\n\\frac{\\sqrt{\\mathrm{Var}[\\bar{n}_{V}]}}{n} \\le \\epsilon\n$$\n最小尺寸 $L$ 可以通过考虑等式极限来找到：\n$$\n\\frac{\\sqrt{\\mathrm{Var}[\\bar{n}_{V}]}}{n} = \\epsilon\n$$\n代入方差的渐近表达式和 $V = L^3$：\n$$\n\\frac{\\sqrt{\\sigma_{0}^{2}/L^3}}{n} = \\epsilon\n$$\n假设 $\\sigma_{0} \\ge 0$，因为 $\\sigma_0^2$ 是一个通常为非负的协方差函数的积分：\n$$\n\\frac{\\sigma_{0} / L^{3/2}}{n} = \\epsilon\n$$\n我们现在求解 $L$：\n$$\nL^{3/2} = \\frac{\\sigma_{0}}{n \\epsilon}\n$$\n$$\nL = \\left( \\frac{\\sigma_{0}}{n \\epsilon} \\right)^{2/3}\n$$\n这是立方体 REV 的最小边长。题目要求代入给定的 $n$ 和 $\\epsilon$ 的数值：\n$$\nn = 0.25, \\quad \\epsilon = 0.01\n$$\n乘积 $n\\epsilon$ 为：\n$$\nn \\epsilon = 0.25 \\times 0.01 = 0.0025 = \\frac{1}{400}\n$$\n将此代入 $L$ 的表达式中：\n$$\nL = \\left( \\frac{\\sigma_{0}}{0.0025} \\right)^{2/3} = \\left( 400 \\sigma_{0} \\right)^{2/3}\n$$\n该表达式给出了最小 REV 边长 $L$（单位为米），前提是参数 $\\sigma_0$ 以相应的国际单位制单位 m$^{3/2}$ 给出。", "answer": "$$\n\\boxed{\\left(400 \\sigma_0\\right)^{2/3}}\n$$", "id": "3617636"}, {"introduction": "在确立了连续介质尺度后，我们需要理解亚尺度变化如何影响宏观输运参数。本练习将演示分层介质中，由水力传导性差异引起的层间速度变化如何产生一个有效的“宏观弥散”系数[@problem_id:3617687]。这个升尺度（upscaling）过程是理解污染物在真实非均质含水层中扩散的核心，它展示了如何将微观结构的影响融入到宏观模型中。", "problem": "考虑稳态水平地下水流通过一个分层多孔介质，该介质由无限个厚度相等的平行层组成，各层的水力传导系数在 $K_1$ 和 $K_2$ 之间交替变化。施加的水力梯度是均匀的，因此根据达西定律，每一层都有其特定的达西速度，该速度与其水力传导系数成正比。设整个层系中的算术平均孔隙速度为已知，并记为 $\\bar{v}$。假设所有层的孔隙度恒定且相同，并且与由速度差异和界面混合产生的宏观弥散相比，局部（孔隙尺度）弥散和分子扩散可以忽略不计。\n\n使用一个简单的混合长度模型，通过拉格朗日速度自相关函数 $C_v(\\tau) = \\langle v'(t) v'(t+\\tau)\\rangle$ 来定义纵向宏观弥散系数 $D_{\\mathrm{macro}}$，其中 $v'(t)$ 是拉格朗日溶质速度相对于其平均值 $\\bar{v}$ 的脉动。通过假设一个由界面混合长度 $\\ell$ 表征的指数形式来对 $C_v(\\tau)$ 进行封闭：具体而言，假设 $C_v(\\tau) = \\sigma_v^2 \\exp(-\\bar{v}\\tau/\\ell)$，其中 $\\sigma_v$ 是在共同梯度下，由于 $K_1$ 和 $K_2$ 的交替出现而导致的各层孔隙速度围绕 $\\bar{v}$ 的标准差。\n\n从达西定律以及上述 $D_{\\mathrm{macro}}$ 作为 $C_v(\\tau)$ 对延迟 $\\tau$ 积分的拉格朗日定义出发，推导出一个用 $K_1$、$K_2$、$\\bar{v}$ 和 $\\ell$ 表示的 $D_{\\mathrm{macro}}$ 的闭式解析表达式。将最终答案表示为单个简化表达式。无需进行数值计算。", "solution": "用户要求我扮演一位严谨细致的STEM教授，解决一个与多孔介质中溶质运移相关的问题。这要求我首先验证问题的完整性，如果问题有效，则提供一个严谨的、分步的解答。\n\n### 步骤1：问题验证\n\n我将首先按照既定程序验证问题陈述。\n\n#### 已知条件提取：\n- **流动条件：** 稳态、水平地下水流。\n- **介质：** 由无限个平行层组成的分层多孔介质。\n- **层属性：** 水力传导系数在 $K_1$ 和 $K_2$ 之间交替，且厚度相等。\n- **水力梯度：** 均匀，导致各层具有特定的达西速度。\n- **达西定律：** 假设成立，$q \\propto K$。\n- **平均速度：** 整个层系的算术平均孔隙速度为 $\\bar{v}$。\n- **孔隙度：** 所有层中恒定且相同，记为 $\\phi$。\n- **弥散：** 局部弥散和分子扩散可忽略。宏观弥散占主导。\n- **宏观弥散系数：** $D_{\\mathrm{macro}}$ 通过拉格朗日速度自相关函数 $C_v(\\tau) = \\langle v'(t) v'(t+\\tau)\\rangle$ 定义。\n- **速度脉动：** $v'(t)$ 是拉格朗日溶质速度相对于其平均值 $\\bar{v}$ 的脉动。\n- **自相关模型：** $C_v(\\tau) = \\sigma_v^2 \\exp(-\\bar{v}\\tau/\\ell)$，其中 $\\sigma_v$ 是各层孔隙速度的标准差，$\\ell$ 是混合长度。\n- **目标公式：** $D_{\\mathrm{macro}}$ 是 $C_v(\\tau)$ 对延迟 $\\tau$ 的积分。\n- **目标：** 推导用 $K_1$, $K_2$, $\\bar{v}$ 和 $\\ell$ 表示的 $D_{\\mathrm{macro}}$ 的闭式表达式。\n\n#### 验证评估：\n该问题在科学上基于水文地质学和输运现象的原理（达西定律，泰勒弥散理论）。问题提法得当，目标明确，信息充分且一致，足以推导出唯一解。语言客观、精确。在此类理论模型中，使用无限、完美分层的介质和指数相关函数是标准的、可接受的理想化方法。该问题是一个需要综合多个概念的非平凡推导，而不是一个琐碎或故作高深的问题。\n\n#### 结论：\n问题是 **有效的**。我将继续进行推导。\n\n### 步骤2：推导\n\n推导过程分为三个主要阶段：首先，将各层的孔隙速度与给定的平均速度 $\\bar{v}$ 联系起来；其次，计算孔隙速度的方差 $\\sigma_v^2$；第三，对给定的自相关函数进行积分，求出宏观弥散系数 $D_{\\mathrm{macro}}$。\n\n设均匀水力梯度为 $J$。根据达西定律，达西速度（比流量）$q$ 由 $q = K J$ 给出。孔隙速度 $v$ 通过孔隙度 $\\phi$ 与达西速度相关，即 $v = q/\\phi$。\n\n因此，两种类型层中的孔隙速度（记为 $v_1$ 和 $v_2$）为：\n$$v_1 = \\frac{K_1 J}{\\phi}$$\n$$v_2 = \\frac{K_2 J}{\\phi}$$\n\n问题陈述各层厚度相等。对于这样一个无限层系，一个溶质质点平均而言会在类型1和类型2的层中花费相等的时间。因此，平均孔隙速度 $\\bar{v}$ 是 $v_1$ 和 $v_2$ 的算术平均值：\n$$\\bar{v} = \\frac{v_1 + v_2}{2}$$\n\n代入 $v_1$ 和 $v_2$ 的表达式：\n$$\\bar{v} = \\frac{1}{2} \\left( \\frac{K_1 J}{\\phi} + \\frac{K_2 J}{\\phi} \\right) = \\frac{J}{2\\phi} (K_1 + K_2)$$\n\n这个关系使我们能够消去项 $J/\\phi$，该项包含未知梯度 $J$ 和未指明的孔隙度 $\\phi$：\n$$\\frac{J}{\\phi} = \\frac{2\\bar{v}}{K_1 + K_2}$$\n\n现在我们可以仅用给定的参数 $K_1$、$K_2$ 和 $\\bar{v}$ 来表示 $v_1$ 和 $v_2$：\n$$v_1 = K_1 \\left( \\frac{2\\bar{v}}{K_1 + K_2} \\right) = \\frac{2K_1}{K_1 + K_2} \\bar{v}$$\n$$v_2 = K_2 \\left( \\frac{2\\bar{v}}{K_1 + K_2} \\right) = \\frac{2K_2}{K_1 + K_2} \\bar{v}$$\n\n接下来，我们计算各层孔隙速度的标准差 $\\sigma_v$。方差 $\\sigma_v^2$ 是速度脉动平方 $(v - \\bar{v})^2$ 的期望值。鉴于这是一个两种状态等概率（或等体积分数）的系统，方差是每种类型层中脉动平方的算术平均值。\n\n类型1层中的速度脉动为 $v_1' = v_1 - \\bar{v}$：\n$$v_1' = \\left(\\frac{2K_1}{K_1+K_2}\\right) \\bar{v} - \\bar{v} = \\left(\\frac{2K_1 - (K_1+K_2)}{K_1+K_2}\\right) \\bar{v} = \\left(\\frac{K_1-K_2}{K_1+K_2}\\right) \\bar{v}$$\n\n类型2层中的速度脉动为 $v_2' = v_2 - \\bar{v}$：\n$$v_2' = \\left(\\frac{2K_2}{K_1+K_2}\\right) \\bar{v} - \\bar{v} = \\left(\\frac{2K_2 - (K_1+K_2)}{K_1+K_2}\\right) \\bar{v} = \\left(\\frac{K_2-K_1}{K_1+K_2}\\right) \\bar{v}$$\n注意 $v_2' = -v_1'$。\n\n那么方差 $\\sigma_v^2$ 为：\n$$\\sigma_v^2 = \\frac{1}{2}(v_1')^2 + \\frac{1}{2}(v_2')^2 = \\frac{1}{2}(v_1')^2 + \\frac{1}{2}(-v_1')^2 = (v_1')^2$$\n$$\\sigma_v^2 = \\left[ \\left(\\frac{K_1-K_2}{K_1+K_2}\\right) \\bar{v} \\right]^2 = \\left(\\frac{K_1-K_2}{K_1+K_2}\\right)^2 \\bar{v}^2$$\n\n最后一步是计算纵向宏观弥散系数 $D_{\\mathrm{macro}}$。根据泰勒弥散理论，该系数是拉格朗日速度自相关函数 $C_v(\\tau)$ 的时间积分。\n$$D_{\\mathrm{macro}} = \\int_0^\\infty C_v(\\tau) \\, d\\tau$$\n\n问题给出了 $C_v(\\tau)$ 的封闭模型：\n$$C_v(\\tau) = \\sigma_v^2 \\exp\\left(-\\frac{\\bar{v}\\tau}{\\ell}\\right)$$\n\n将其代入积分中：\n$$D_{\\mathrm{macro}} = \\int_0^\\infty \\sigma_v^2 \\exp\\left(-\\frac{\\bar{v}\\tau}{\\ell}\\right) \\, d\\tau$$\n项 $\\sigma_v^2$ 相对于积分变量 $\\tau$ 是常数：\n$$D_{\\mathrm{macro}} = \\sigma_v^2 \\int_0^\\infty \\exp\\left(-\\frac{\\bar{v}\\tau}{\\ell}\\right) \\, d\\tau$$\n\n进行积分：\n$$D_{\\mathrm{macro}} = \\sigma_v^2 \\left[ -\\frac{\\ell}{\\bar{v}} \\exp\\left(-\\frac{\\bar{v}\\tau}{\\ell}\\right) \\right]_0^\\infty$$\n$$D_{\\mathrm{macro}} = \\sigma_v^2 \\left( 0 - \\left(-\\frac{\\ell}{\\bar{v}} \\exp(0)\\right) \\right) = \\sigma_v^2 \\left(\\frac{\\ell}{\\bar{v}}\\right)$$\n\n最后，我们代入推导出的 $\\sigma_v^2$ 的表达式：\n$$D_{\\mathrm{macro}} = \\left[ \\left(\\frac{K_1-K_2}{K_1+K_2}\\right)^2 \\bar{v}^2 \\right] \\left(\\frac{\\ell}{\\bar{v}}\\right)$$\n\n通过消去一个因子 $\\bar{v}$ 来简化表达式，得到最终结果：\n$$D_{\\mathrm{macro}} = \\bar{v} \\ell \\left(\\frac{K_1-K_2}{K_1+K_2}\\right)^2$$\n这就是用指定参数表示的纵向宏观弥散系数的闭式解析表达式。", "answer": "$$\\boxed{\\bar{v} \\ell \\left(\\frac{K_1-K_2}{K_1+K_2}\\right)^{2}}$$", "id": "3617687"}, {"introduction": "当拥有一个宏观尺度的输运模型后，我们通常会借助数值方法来获得具体问题的解。然而，数值近似并非完美，其本身可能引入会影响模拟结果的误差。本练习通过修正方程分析，揭示了一种常用的数值格式（一阶迎风格式）如何引入非物理的“数值弥散”[@problem_id:3617641]，这种效应可能会掩盖或夸大真实的物理弥散，从而凸显了在计算模拟中批判性地评估和选择数值方法的重要性。", "problem": "考虑保守溶质在均匀饱和多孔介质中的一维输运。浓度场 $C(x,t)$ 满足平流-弥散方程\n$$\n\\frac{\\partial C}{\\partial t} + v\\,\\frac{\\partial C}{\\partial x} = D\\,\\frac{\\partial^{2} C}{\\partial x^{2}},\n$$\n其中 $v$ 是平均孔隙速度，$D$ 是物理流体动力学弥散系数（包括分子扩散和机械弥散）。在间距为 $\\Delta x$ 的均匀网格上，对平流项进行空间离散的一种常用方法是使用一阶迎风差分，这得到在网格点索引 $i$ 处的半离散方程，其形式为\n$$\n\\frac{d C_{i}}{d t} + v\\,\\frac{C_{i} - C_{i-1}}{\\Delta x} = D\\,\\frac{C_{i+1} - 2 C_{i} + C_{i-1}}{\\Delta x^{2}}。\n$$\n使用基于 $x_{i}$ 点的泰勒级数展开的修正方程分析方法，推导该半离散格式所求解的主阶连续方程，并确定由平流项的迎风离散所导致的主阶人工扩散项的系数。然后，对于计算网格 $\\Delta x = 0.050\\,\\text{m}$，平均孔隙速度 $v = 1.2 \\times 10^{-4}\\,\\text{m}\\,\\text{s}^{-1}$，物理流体动力学弥散 $D = 1.0 \\times 10^{-6}\\,\\text{m}^{2}\\,\\text{s}^{-1}$ 的情况，计算由迎风离散引起的数值人工扩散，以及该人工扩散与物理弥散的比值。\n\n将您的最终答案表示为有序对 $\\left(D_{\\text{num}},\\,D_{\\text{num}}/D\\right)$，其中 $D_{\\text{num}}$ 以 $\\text{m}^{2}\\,\\text{s}^{-1}$ 为单位。将您的答案四舍五入到三位有效数字。", "solution": "该问题要求推导一维平流-弥散方程半离散形式的修正方程，确定并计算相关的人工扩散，以及该人工扩散与物理弥散的比值。\n\n控制偏微分方程 (PDE) 为：\n$$\n\\frac{\\partial C}{\\partial t} + v\\,\\frac{\\partial C}{\\partial x} = D\\,\\frac{\\partial^{2} C}{\\partial x^{2}}\n$$\n在间距为 $\\Delta x$ 的均匀网格上的网格节点 $i$ 处，给定的半离散有限差分近似为：\n$$\n\\frac{d C_{i}}{d t} + v\\,\\frac{C_{i} - C_{i-1}}{\\Delta x} = D\\,\\frac{C_{i+1} - 2 C_{i} + C_{i-1}}{\\Delta x^{2}}\n$$\n此处，$C_{i}(t)$ 是连续浓度 $C(x_i, t)$ 的近似值。项 $v\\,\\frac{C_{i} - C_{i-1}}{\\Delta x}$ 是平流项 $v\\,\\frac{\\partial C}{\\partial x}$ 的一阶迎风差分近似（假设 $v > 0$），而 $D\\,\\frac{C_{i+1} - 2 C_{i} + C_{i-1}}{\\Delta x^{2}}$ 是弥散项 $D\\,\\frac{\\partial^{2} C}{\\partial x^{2}}$ 的二阶中心差分近似。\n\n为了推导修正方程，我们将离散项 $C_{i-1}$ 和 $C_{i+1}$ 在点 $x_i$ 附近进行泰勒级数展开，其中我们将 $C_i$ 与连续函数 $C(x_i, t)$ 相关联。令 $\\frac{\\partial^n C}{\\partial x^n} \\big|_{i}$ 表示 $C$ 在 $(x_i, t)$ 处计算的 $n$ 阶空间导数。\n\n泰勒级数展开为：\n$$\nC_{i-1} = C(x_i - \\Delta x, t) = C_i - \\Delta x \\frac{\\partial C}{\\partial x} \\bigg|_{i} + \\frac{\\Delta x^2}{2!} \\frac{\\partial^2 C}{\\partial x^2} \\bigg|_{i} - \\frac{\\Delta x^3}{3!} \\frac{\\partial^3 C}{\\partial x^3} \\bigg|_{i} + \\mathcal{O}(\\Delta x^4)\n$$\n$$\nC_{i+1} = C(x_i + \\Delta x, t) = C_i + \\Delta x \\frac{\\partial C}{\\partial x} \\bigg|_{i} + \\frac{\\Delta x^2}{2!} \\frac{\\partial^2 C}{\\partial x^2} \\bigg|_{i} + \\frac{\\Delta x^3}{3!} \\frac{\\partial^3 C}{\\partial x^3} \\bigg|_{i} + \\mathcal{O}(\\Delta x^4)\n$$\n现在，我们将这些展开式代入半离散方程的空间差分项中。\n\n首先，考虑平流项：\n$$\nv\\,\\frac{C_{i} - C_{i-1}}{\\Delta x} = v\\,\\frac{1}{\\Delta x} \\left[ C_i - \\left( C_i - \\Delta x \\frac{\\partial C}{\\partial x} \\bigg|_{i} + \\frac{\\Delta x^2}{2} \\frac{\\partial^2 C}{\\partial x^2} \\bigg|_{i} - \\dots \\right) \\right]\n$$\n$$\n= v\\,\\frac{1}{\\Delta x} \\left[ \\Delta x \\frac{\\partial C}{\\partial x} \\bigg|_{i} - \\frac{\\Delta x^2}{2} \\frac{\\partial^2 C}{\\partial x^2} \\bigg|_{i} + \\mathcal{O}(\\Delta x^3) \\right]\n$$\n$$\n= v \\frac{\\partial C}{\\partial x} \\bigg|_{i} - \\frac{v \\Delta x}{2} \\frac{\\partial^2 C}{\\partial x^2} \\bigg|_{i} + \\mathcal{O}(\\Delta x^2)\n$$\n右边的第一项 $v \\frac{\\partial C}{\\partial x} \\big|_{i}$ 是原始的平流项。第二项 $-\\frac{v \\Delta x}{2} \\frac{\\partial^2 C}{\\partial x^2} \\big|_{i}$ 是主阶截断误差，其形式为扩散项。\n\n接下来，考虑弥散项：\n$$\nD\\,\\frac{C_{i+1} - 2 C_{i} + C_{i-1}}{\\Delta x^{2}}\n$$\n我们计算分子 $C_{i+1} - 2 C_{i} + C_{i-1}$：\n$$\n\\left( C_i + \\Delta x \\frac{\\partial C}{\\partial x} \\bigg|_{i} + \\frac{\\Delta x^2}{2} \\frac{\\partial^2 C}{\\partial x^2} \\bigg|_{i} + \\dots \\right) - 2C_i + \\left( C_i - \\Delta x \\frac{\\partial C}{\\partial x} \\bigg|_{i} + \\frac{\\Delta x^2}{2} \\frac{\\partial^2 C}{\\partial x^2} \\bigg|_{i} - \\dots \\right)\n$$\n合并同类项，我们得到：\n$$\n(C_i - 2C_i + C_i) + (\\Delta x - \\Delta x)\\frac{\\partial C}{\\partial x} \\bigg|_{i} + \\left(\\frac{\\Delta x^2}{2} + \\frac{\\Delta x^2}{2}\\right)\\frac{\\partial^2 C}{\\partial x^2} \\bigg|_{i} + \\mathcal{O}(\\Delta x^4)\n$$\n$$\n= \\Delta x^2 \\frac{\\partial^2 C}{\\partial x^2} \\bigg|_{i} + \\mathcal{O}(\\Delta x^4)\n$$\n因此离散弥散项变为：\n$$\nD\\,\\frac{C_{i+1} - 2 C_{i} + C_{i-1}}{\\Delta x^{2}} = D\\,\\frac{\\Delta x^2 \\frac{\\partial^2 C}{\\partial x^2} \\bigg|_{i} + \\mathcal{O}(\\Delta x^4)}{\\Delta x^{2}} = D \\frac{\\partial^2 C}{\\partial x^2} \\bigg|_{i} + \\mathcal{O}(\\Delta x^2)\n$$\n该项以二阶精度近似物理弥散项。\n\n现在，我们将这些连续表示代回半离散方程，用 $\\frac{\\partial C}{\\partial t}$ 替换 $\\frac{dC_i}{dt}$：\n$$\n\\frac{\\partial C}{\\partial t} + \\left( v \\frac{\\partial C}{\\partial x} - \\frac{v \\Delta x}{2} \\frac{\\partial^2 C}{\\partial x^2} + \\mathcal{O}(\\Delta x^2) \\right) = D \\frac{\\partial^2 C}{\\partial x^2} + \\mathcal{O}(\\Delta x^2)\n$$\n重新整理各项，将同阶导数归并，我们得到修正方程：\n$$\n\\frac{\\partial C}{\\partial t} + v \\frac{\\partial C}{\\partial x} = D \\frac{\\partial^2 C}{\\partial x^2} + \\frac{v \\Delta x}{2} \\frac{\\partial^2 C}{\\partial x^2} + \\mathcal{O}(\\Delta x^2)\n$$\n$$\n\\frac{\\partial C}{\\partial t} + v \\frac{\\partial C}{\\partial x} = \\left( D + \\frac{v \\Delta x}{2} \\right) \\frac{\\partial^2 C}{\\partial x^2} + \\mathcal{O}(\\Delta x^2)\n$$\n这就是数值格式实际求解的主阶连续方程。该格式引入了一个人工扩散（或数值扩散）项。该人工扩散的系数，记为 $D_{\\text{num}}$，是平流项迎风离散的主阶误差项。\n从修正方程中，我们确定人工扩散系数为：\n$$\nD_{\\text{num}} = \\frac{v \\Delta x}{2}\n$$\n数值格式的总有效弥散系数为 $D_{\\text{eff}} = D + D_{\\text{num}}$。\n\n现在，我们使用给定值计算 $D_{\\text{num}}$ 的数值及其与物理弥散 $D$ 的比值：\n$\\Delta x = 0.050\\,\\text{m}$\n$v = 1.2 \\times 10^{-4}\\,\\text{m}\\,\\text{s}^{-1}$\n$D = 1.0 \\times 10^{-6}\\,\\text{m}^{2}\\,\\text{s}^{-1}$\n\n计算 $D_{\\text{num}}$：\n$$\nD_{\\text{num}} = \\frac{(1.2 \\times 10^{-4}\\,\\text{m}\\,\\text{s}^{-1}) \\times (0.050\\,\\text{m})}{2} = \\frac{6.0 \\times 10^{-6}\\,\\text{m}^2\\,\\text{s}^{-1}}{2} = 3.0 \\times 10^{-6}\\,\\text{m}^2\\,\\text{s}^{-1}\n$$\n计算比值 $D_{\\text{num}}/D$：\n$$\n\\frac{D_{\\text{num}}}{D} = \\frac{3.0 \\times 10^{-6}\\,\\text{m}^2\\,\\text{s}^{-1}}{1.0 \\times 10^{-6}\\,\\text{m}^2\\,\\text{s}^{-1}} = 3.0\n$$\n问题要求将答案四舍五入到三位有效数字。\n$D_{\\text{num}} = 3.00 \\times 10^{-6}\\,\\text{m}^2\\,\\text{s}^{-1}$\n$D_{\\text{num}}/D = 3.00$\n\n最终答案为有序对 $(D_{\\text{num}},\\,D_{\\text{num}}/D)$。", "answer": "$$\n\\boxed{(3.00 \\times 10^{-6}, 3.00)}\n$$", "id": "3617641"}]}