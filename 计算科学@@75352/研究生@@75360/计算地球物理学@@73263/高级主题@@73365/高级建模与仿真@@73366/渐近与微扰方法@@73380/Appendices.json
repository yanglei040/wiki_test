{"hands_on_practices": [{"introduction": "在地球动力学等领域，许多物理系统在本质上是振荡的，但会受到微小的非线性效应影响。直接的微扰展开往往会导致长期发散的“长期项”（secular terms），从而失效。本练习将通过一个经典的弱非线性振子模型，指导您应用 Lindstedt–Poincaré (LP) 方法，这是一种通过引入校正频率来消除长期项，从而获得在长时间内一致有效的近似解的强大技术 [@problem_id:3576366]。", "problem": "在计算地震学和全球地球动力学中，均匀弹性体单个简正模相关的位移，其主阶行为可以被建模为一个角频率为 $\\omega_{0}$ 的线性振子。弱几何或材料非线性会引入小的修正，这些修正可在运动方程中用一个三次项表示。考虑如下的弱非线性振子\n$$\n\\ddot{q}(t) + \\omega_{0}^{2}\\,q(t) + \\epsilon\\,\\alpha\\,q^{3}(t) = 0,\n$$\n其中 $q(t)$ 是模态坐标，$\\omega_{0} > 0$ 是未扰动模的线性角频率，$\\alpha$ 是一个表征三次非线性强度和符号的实常数，而 $0  \\epsilon \\ll 1$ 是一个衡量非线性强弱的无量纲小参数。假设该模态从静止状态被激发，初始条件为 $q(0) = A$ 和 $\\dot{q}(0) = 0$，其中 $A>0$ 是初始位移振幅。\n\n对 $q(t)$ 按 $\\epsilon$ 进行的朴素正则微扰展开会因强迫项与线性频率下的齐次解之间存在近共振而产生久期增长，使得该近似在长时间内非一致有效。为获得一个一致有效的近似，应用林德斯特-庞加莱（Lindstedt–Poincaré, LP）方法，引入一个拉伸的时间变量和频率修正，从而使主阶振荡保持周期性，并在 $\\mathcal{O}(\\epsilon)$ 阶消除所有久期项。\n\n从给定的运动方程和LP方法出发，推导为消除 $\\mathcal{O}(\\epsilon)$ 阶问题中的久期项所需的一阶频率修正 $\\omega_{1}$。你的推导过程必须明确展示时间的重标度、解和频率的展开，以及为消除共振强迫项而施加的可解性条件。请将你的最终答案表示为 $\\omega_{1}$ 关于 $\\omega_{0}$、$\\alpha$ 和 $A$ 的单个符号表达式。不需要进行数值计算，也不需要单位。修正后的一阶角频率为 $\\omega = \\omega_{0} + \\epsilon\\,\\omega_{1}$；然而，你只需报告频率修正 $\\omega_{1}$。", "solution": "该问题要求使用林德斯特-庞加莱（LP）方法推导弱非线性振子的一阶频率修正。其控制运动方程为无阻尼的杜芬方程：\n$$\n\\ddot{q}(t) + \\omega_{0}^{2}\\,q(t) + \\epsilon\\,\\alpha\\,q^{3}(t) = 0,\n$$\n初始条件为 $q(0) = A$ 和 $\\dot{q}(0) = 0$。参数 $\\omega_{0}$、$\\alpha$ 和 $A$ 均为正常数，且 $0  \\epsilon \\ll 1$ 是一个小参数。\n\n林德斯特-庞加莱（LP）方法的核心思想是通过引入一个新的、拉伸的时间变量 $\\tau$，并将解 $q$ 和频率 $\\omega$ 同时按小参数 $\\epsilon$ 展开成幂级数，来寻求一个周期解。此过程旨在消除在直接的正则微扰展开中出现的久期项（随时间无限增长的项），从而保证近似解在所有时间上的一致有效性。\n\n首先，我们引入拉伸的时间变量 $\\tau$：\n$$\n\\tau = \\omega t\n$$\n其中 $\\omega$ 是振荡的修正角频率，我们假设它依赖于 $\\epsilon$。使用链式法则，我们将对 $t$ 的时间导数转换为对 $\\tau$ 的导数：\n$$\n\\frac{d}{dt} = \\frac{d\\tau}{dt}\\frac{d}{d\\tau} = \\omega \\frac{d}{d\\tau}\n$$\n$$\n\\frac{d^2}{dt^2} = \\frac{d}{dt}\\left(\\omega \\frac{d}{d\\tau}\\right) = \\omega^2 \\frac{d^2}{d\\tau^2}\n$$\n将这些代入原微分方程，得到：\n$$\n\\omega^2 q''(\\tau) + \\omega_{0}^{2} q(\\tau) + \\epsilon \\alpha q^{3}(\\tau) = 0\n$$\n其中撇号表示对 $\\tau$ 求导。\n\n接下来，我们将解 $q(\\tau)$ 和频率 $\\omega$ 按 $\\epsilon$ 展开为幂级数：\n$$\nq(\\tau) = q_{0}(\\tau) + \\epsilon q_{1}(\\tau) + \\epsilon^2 q_{2}(\\tau) + \\dots\n$$\n$$\n\\omega = \\omega_{0} + \\epsilon \\omega_{1} + \\epsilon^2 \\omega_{2} + \\dots\n$$\n对于 $\\omega^2$ 项，我们需要其展开到 $\\mathcal{O}(\\epsilon)$ 阶：\n$$\n\\omega^2 = (\\omega_{0} + \\epsilon \\omega_{1} + \\dots)^2 = \\omega_{0}^2 + 2\\epsilon\\omega_{0}\\omega_{1} + \\mathcal{O}(\\epsilon^2)\n$$\n将这些展开式代入变换后的微分方程：\n$$\n(\\omega_{0}^2 + 2\\epsilon\\omega_{0}\\omega_{1} + \\dots)(q_{0}'' + \\epsilon q_{1}'' + \\dots) + \\omega_{0}^2 (q_{0} + \\epsilon q_{1} + \\dots) + \\epsilon\\alpha(q_{0} + \\epsilon q_{1} + \\dots)^3 = 0\n$$\n我们展开三次项：$(q_{0} + \\epsilon q_{1} + \\dots)^3 = q_{0}^3 + 3\\epsilon q_{0}^2 q_{1} + \\mathcal{O}(\\epsilon^2)$。为了找到 $\\mathcal{O}(\\epsilon)$ 阶方程，我们只需要主阶项 $q_0^3$。代入此项并按 $\\epsilon$ 的幂次合并各项：\n$$\n(\\omega_{0}^2 q_{0}'' + \\omega_{0}^2 q_{0}) + \\epsilon(\\omega_{0}^2 q_{1}'' + \\omega_{0}^2 q_{1} + 2\\omega_{0}\\omega_{1} q_{0}'' + \\alpha q_{0}^3) + \\mathcal{O}(\\epsilon^2) = 0\n$$\n此方程必须对所有小的 $\\epsilon$ 成立，因此我们可以将 $\\epsilon$ 的每个幂次的系数设为零。\n\n在 $\\mathcal{O}(\\epsilon^0)$ 阶：\n$$\n\\omega_{0}^2 q_{0}'' + \\omega_{0}^2 q_{0} = 0 \\implies q_{0}'' + q_{0} = 0\n$$\n通解为 $q_{0}(\\tau) = C_0 \\cos(\\tau) + D_0 \\sin(\\tau)$。\n\n在 $\\mathcal{O}(\\epsilon^1)$ 阶：\n$$\n\\omega_{0}^2 q_{1}'' + \\omega_{0}^2 q_{1} = -2\\omega_{0}\\omega_{1} q_{0}'' - \\alpha q_{0}^3\n$$\n可重写为：\n$$\nq_{1}'' + q_{1} = -\\frac{2\\omega_{1}}{\\omega_{0}} q_{0}'' - \\frac{\\alpha}{\\omega_{0}^2} q_{0}^3\n$$\n\n现在我们必须变换初始条件。在 $t=0$ 时，我们有 $\\tau=0$。\n$q(0)=A$ 的条件变为：\n$q(0) = q_{0}(0) + \\epsilon q_{1}(0) + \\dots = A$。\n这意味着 $q_{0}(0) = A$ 且 $q_{1}(0) = 0$，$q_{2}(0) = 0$ 等等。\n\n$\\dot{q}(0)=0$ 的条件变为：\n$\\dot{q}(t) = \\omega \\frac{dq}{d\\tau} = (\\omega_{0} + \\epsilon\\omega_{1} + \\dots)(q_{0}'(\\tau) + \\epsilon q_{1}'(\\tau) + \\dots)$。\n在 $t=0$（即 $\\tau=0$）时：\n$\\dot{q}(0) = (\\omega_{0} + \\epsilon\\omega_{1} + \\dots)(q_{0}'(0) + \\epsilon q_{1}'(0) + \\dots) = 0$。\n由于 $\\omega_{0} \\neq 0$，这要求第二个括号内的整个表达式为零。将其展开并令 $\\epsilon$ 的各幂次系数为零，可得 $q_{0}'(0) = 0$，$q_{1}'(0) = 0$ 等等。\n\n将这些初始条件应用于 $\\mathcal{O}(\\epsilon^0)$ 阶的解：\n$q_{0}(0) = C_0 \\cos(0) + D_0 \\sin(0) = C_0 = A$。\n$q_{0}'(0) = -C_0 \\sin(0) + D_0 \\cos(0) = D_0 = 0$。\n因此，主阶解为：\n$$\nq_{0}(\\tau) = A \\cos(\\tau)\n$$\n从 $\\mathcal{O}(\\epsilon^0)$ 阶微分方程，我们还有 $q_{0}'' = -q_{0} = -A \\cos(\\tau)$。\n\n现在，我们将 $q_{0}$ 和 $q_{0}''$ 代入 $\\mathcal{O}(\\epsilon^1)$ 阶方程的右侧（RHS）：\n$$\nq_{1}'' + q_{1} = -\\frac{2\\omega_{1}}{\\omega_{0}}(-A\\cos(\\tau)) - \\frac{\\alpha}{\\omega_{0}^2}(A\\cos(\\tau))^3\n$$\n$$\nq_{1}'' + q_{1} = \\frac{2A\\omega_{1}}{\\omega_{0}}\\cos(\\tau) - \\frac{\\alpha A^3}{\\omega_{0}^2}\\cos^3(\\tau)\n$$\n右侧的 $\\cos(\\tau)$ 项是一个共振强迫项，因为它与齐次方程 $q_{1}'' + q_{1} = 0$ 的一个解相匹配。这样的项会导致 $q_{1}$ 的解随 $\\tau$ 线性增长（一个久期项），形式为 $\\tau \\sin(\\tau)$。为确保解保持周期性（并因此一致有效），我们必须消除所有共振强迫项。\n\n为此，我们使用三角恒等式 $\\cos(3x) = 4\\cos^3(x) - 3\\cos(x)$，可得 $\\cos^3(x) = \\frac{1}{4}(\\cos(3x) + 3\\cos(x))$。将其代入右侧：\n$$\nRHS = \\frac{2A\\omega_{1}}{\\omega_{0}}\\cos(\\tau) - \\frac{\\alpha A^3}{\\omega_{0}^2}\\left(\\frac{1}{4}\\cos(3\\tau) + \\frac{3}{4}\\cos(\\tau)\\right)\n$$\n$$\nRHS = \\left(\\frac{2A\\omega_{1}}{\\omega_{0}} - \\frac{3\\alpha A^3}{4\\omega_{0}^2}\\right)\\cos(\\tau) - \\frac{\\alpha A^3}{4\\omega_{0}^2}\\cos(3\\tau)\n$$\nLP方法的可解性条件要求共振项 $\\cos(\\tau)$ 的系数必须为零。\n$$\n\\frac{2A\\omega_{1}}{\\omega_{0}} - \\frac{3\\alpha A^3}{4\\omega_{0}^2} = 0\n$$\n我们求解此方程以得到 $\\omega_{1}$。由于 $A0$ 且 $\\omega_00$，我们可以重新整理并简化：\n$$\n\\frac{2A\\omega_{1}}{\\omega_{0}} = \\frac{3\\alpha A^3}{4\\omega_{0}^2}\n$$\n$$\n\\omega_{1} = \\left(\\frac{3\\alpha A^3}{4\\omega_{0}^2}\\right) \\left(\\frac{\\omega_{0}}{2A}\\right)\n$$\n$$\n\\omega_{1} = \\frac{3\\alpha A^2}{8\\omega_{0}}\n$$\n该表达式给出了为消除解中的久期项所需的一阶频率修正，从而得到一个一致有效的渐近近似。修正后的一阶频率为 $\\omega \\approx \\omega_{0} + \\epsilon \\frac{3\\alpha A^2}{8\\omega_{0}}$。", "answer": "$$\n\\boxed{\\frac{3 \\alpha A^{2}}{8 \\omega_{0}}}\n$$", "id": "3576366"}, {"introduction": "地震层析成像是理解地球内部结构的关键工具，其核心是计算波场对模型参数的敏感度核（或梯度）。直接计算这些核的成本非常高，而高频渐近方法提供了一种高效的近似方案。本练习将引导您实现一个基于渐近理论的简化层析成像梯度模型 [@problem_id:3576398]，通过将波场分解为快速变化的相位（走时）和缓慢变化的振幅，展示了渐近分析如何将复杂的波动物理转化为地球物理反演中可行的计算算法。", "problem": "考虑一个非均匀介质中的标量声波方程，其波速场为 $c(\\mathbf{x})$，\n$$\n\\frac{1}{c^2(\\mathbf{x})}\\,\\partial_{tt} u(\\mathbf{x},t)-\\Delta u(\\mathbf{x},t)=s(\\mathbf{x},t),\n$$\n及其在角频率 $\\omega0$ 下的时谐傅里叶变换，\n$$\n\\Delta u(\\mathbf{x};\\omega)+\\omega^2 m(\\mathbf{x})\\,u(\\mathbf{x};\\omega)=q(\\mathbf{x};\\omega),\n$$\n其中 $m(\\mathbf{x})=1/c^2(\\mathbf{x})$ 是慢度平方，$u(\\mathbf{x};\\omega)$ 是复值频域波场，$q(\\mathbf{x};\\omega)$ 是源项，$\\Delta$ 是拉普拉斯算子。引入高频近似（ansatz），设 $\\epsilon=1/\\omega\\ll 1$，\n$$\nu(\\mathbf{x};\\omega)=A(\\mathbf{x})\\,e^{i\\omega T(\\mathbf{x})},\n$$\n其中 $A(\\mathbf{x})$ 是一个缓慢变化的振幅，$T(\\mathbf{x})$ 是相位（走时）。假设一个针对单一频率和一组点接收器的失配泛函，\n$$\nJ=\\frac{1}{2}\\sum_{r}\\left|P_r u-d_r\\right|^2,\n$$\n其中 $P_r$ 提取接收器位置 $\\mathbf{x}_r$ 处的波场，$d_r$ 是观测数据。在频域中使用伴随状态法，关于 $m(\\mathbf{x})$ 的梯度可以用正向波场 $u$ 和伴随波场 $\\lambda$ 来表示，其中伴随波场 $\\lambda$ 求解的是伴随亥姆霍兹方程，其点源位于接收器处，且强度与残差成正比。在渐近极限 $\\epsilon\\to 0$ 下，将快速振荡项 $e^{i\\omega T}$ 与缓慢变化的振幅 $A(\\mathbf{x})$ 分离，并推导出一个输运驱动的梯度近似。在此近似中，乘积 $u(\\mathbf{x})\\,\\lambda(\\mathbf{x})$ 被近似为缓慢变化的振幅乘积与一个快速振荡的相位因子，该相位因子由从源点和接收器到空间点的走时构造而成。\n\n将问题简化到一维空间域，坐标为 $x\\in\\mathbb{R}$，波速 $c(x)$ 为分段常数，即在无重叠地划分区域的区间 $[x_\\ell^{\\text{L}},x_\\ell^{\\text{R}}]$ 上 $c(x)=c_\\ell$。在一维情况下，根据高频近似，程函方程（eikonal equation）简化为\n$$\n\\left|\\frac{dT}{dx}\\right|=\\sqrt{m(x)}=\\frac{1}{c(x)},\n$$\n并且，领先阶的输运方程意味着在每个分段常数段内，沿射线的振幅是恒定的。利用这些事实，可以得到在点 $x$ 处的一个无量纲归一化梯度模型，其形式为\n$$\ng_{\\text{norm}}(x)\\equiv \\cos\\Big(\\omega\\,[T_s(x)+T_r(x)]\\Big),\n$$\n其中 $T_s(x)$ 是从源位置 $x_s$ 到点 $x$ 的走时，$T_r(x)$ 是从点 $x$ 到接收器位置 $x_r$ 的走时，且 $\\omega=2\\pi f$，$f$ 的单位为赫兹。在这里，走时是通过沿一维直线路径对 $1/c(x)$ 进行线积分计算的，即：\n$$\nT(a\\to b)=\\int_{a}^{b}\\frac{1}{c(x)}\\,dx=\\sum_{\\ell}\\frac{\\text{length of }([a,b]\\cap [x_\\ell^{\\text{L}},x_\\ell^{\\text{R}}])}{c_\\ell}.\n$$\n您的任务是实现一个程序，为指定的测试用例计算 $g_{\\text{norm}}(x)$。所有距离单位必须是米，速度单位是米/秒，频率单位是赫兹，余弦函数中的角度单位必须是弧度。需要打印的输出是 $g_{\\text{norm}}(x)$ 的值，这些值是无量纲的。为便于数值报告，请将每个结果四舍五入到六位小数。\n\n请实现以下测试套件。对于每个测试用例，计算每个指定评估点的 $g_{\\text{norm}}(x)$，并按所列顺序将所有结果汇总到如下所述的单行输出中。\n\n- 测试用例1（均匀介质，不同位置）：\n  - 层：一层 $\\left([0,1000],\\,c=2000\\right)$。\n  - 源 $x_s=100$，接收器 $x_r=900$。\n  - 频率 $f=10$。\n  - 评估点 $x\\in\\{50,100,200,500,900,950\\}$。\n\n- 测试用例2（双层介质，跨越界面）：\n  - 层：两层 $\\left([0,500],\\,c=1800\\right)$ 和 $\\left([500,1000],\\,c=2200\\right)$。\n  - 源 $x_s=100$，接收器 $x_r=900$。\n  - 频率 $f=5$。\n  - 评估点 $x\\in\\{400,500,600,50,950\\}$。\n\n- 测试用例3（源和接收器重合，近场变化）：\n  - 层：一层 $\\left([0,1000],\\,c=1500\\right)$。\n  - 源 $x_s=500$，接收器 $x_r=500$。\n  - 频率 $f=20$。\n  - 评估点 $x\\in\\{500,550,450\\}$。\n\n- 测试用例4（均匀介质，长路径，较高频率）：\n  - 层：一层 $\\left([0,1000],\\,c=3000\\right)$。\n  - 源 $x_s=0$，接收器 $x_r=1000$。\n  - 频率 $f=50$。\n  - 评估点 $x\\in\\{0,250,750,1000,1200,-200\\}$。\n\n您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果（例如，“[result1,result2,result3]”）。每个值必须四舍五入到六位小数，不得打印任何其他文本。", "solution": "我们已对问题陈述进行了严格审查，并确定其是有效的。它在科学上基于波传播和渐近分析的原理，特别是在地球物理反演的背景下。该问题是适定的、客观的，并包含计算唯一且有意义的解所需的所有信息。所有术语都已定义，计算任务明确。\n\n目标是为一系列测试用例，在几个指定的空间点 $x$ 处计算无量纲归一化梯度模型 $g_{\\text{norm}}(x)$。控制公式如下：\n$$\ng_{\\text{norm}}(x) \\equiv \\cos\\Big(\\omega\\,[T_s(x)+T_r(x)]\\Big)\n$$\n其中 $\\omega = 2\\pi f$ 是角频率，$T_s(x)$ 是从源点 $x_s$ 到点 $x$ 的声学走时，$T_r(x)$ 是从点 $x$ 到接收器 $x_r$ 的走时。\n\n问题的核心在于准确计算在一维分段常数波速 $c(x)$ 介质中的走时 $T(a \\to b)$。问题给出了此走时的定义公式，即对慢度 $1/c(x)$ 的积分：\n$$\nT(a\\to b)=\\int_{a}^{b}\\frac{1}{c(x)}\\,dx\n$$\n这应被解释为在点 $a$ 和 $b$ 之间的空间段上的积分，因此其值始终为非负，即 $T(a \\to b) = \\int_{\\min(a,b)}^{\\max(a,b)} \\frac{1}{c(x)}\\,dx$。鉴于介质由一组不重叠的层定义，每层在区间 $[x_\\ell^{\\text{L}}, x_\\ell^{\\text{R}}]$ 上具有恒定速度 $c_\\ell$，该积分可简化为对这些层的求和：\n$$\nT(a\\to b)=\\sum_{\\ell}\\frac{\\text{length of }([\\min(a,b), \\max(a,b)] \\cap [x_\\ell^{\\text{L}},x_\\ell^{\\text{R}}])}{c_\\ell}\n$$\n该公式正确地处理了跨越层边界的路径以及可能延伸到速度模型定义域之外的路径。对于路径 $[\\min(a,b), \\max(a,b)]$ 中不与任何层 $[x_\\ell^{\\text{L}},x_\\ell^{\\text{R}}]$ 相交的任何部分，由于相交长度为零，相应的走时贡献也为零。\n\n计算步骤如下：\n1.  根据上述求和公式设计一个函数来计算走时 $T(a \\to b)$。该函数以起始点 $a$、结束点 $b$ 和层定义作为输入。对于给定的路径段 $[\\min(a,b), \\max(a,b)]$，它遍历每个已定义的层，计算路径段与层区间的重叠长度，将此长度除以该层的速度，并累加这些贡献以求得总走时。\n\n2.  对于问题中指定的每个测试用例，使用提供的参数（层、源位置 $x_s$、接收器位置 $x_r$ 和频率 $f$）。角频率计算为 $\\omega = 2\\pi f$。\n\n3.  对于测试用例中的每个评估点 $x$，使用步骤1中的走时函数计算从源到点的走时 $T_s(x) = T(x_s \\to x)$ 和从点到接收器的走时 $T_r(x) = T(x \\to x_r)$。\n\n4.  路径 $x_s \\to x \\to x_r$ 的总走时为和 $T_{\\text{total}} = T_s(x) + T_r(x)$。\n\n5.  然后，归一化梯度的值计算为 $g_{\\text{norm}}(x) = \\cos(\\omega T_{\\text{total}})$。\n\n6.  遵循输出规范，将每个计算值格式化为六位小数。所有结果按指定顺序汇总到单个列表中。\n\n此方法系统地应用于所有测试用例以生成最终输出。使用高精度浮点运算至关重要，并且在数值实现交集逻辑和最终结果格式化时必须小心谨慎。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the computational problem by calculating the normalized gradient model\n    for all specified test cases.\n    \"\"\"\n\n    def calculate_travel_time(start_pos, end_pos, layers):\n        \"\"\"\n        Calculates the travel time between two points in a 1D piecewise-constant medium.\n\n        Args:\n            start_pos (float): The starting position.\n            end_pos (float): The ending position.\n            layers (list): A list of tuples, where each tuple contains\n                           ((layer_start, layer_end), speed).\n\n        Returns:\n            float: The total travel time.\n        \"\"\"\n        path_start = min(start_pos, end_pos)\n        path_end = max(start_pos, end_pos)\n\n        if path_start == path_end:\n            return 0.0\n\n        total_time = 0.0\n        for (layer_bounds, speed) in layers:\n            layer_start, layer_end = layer_bounds\n            \n            # Calculate the intersection of the path and the current layer\n            overlap_start = max(path_start, layer_start)\n            overlap_end = min(path_end, layer_end)\n\n            # If there is a non-zero overlap, add its contribution to the time\n            if overlap_start  overlap_end:\n                overlap_length = overlap_end - overlap_start\n                time_in_layer = overlap_length / speed\n                total_time += time_in_layer\n        \n        return total_time\n\n    test_cases = [\n        {\n            \"layers\": [([0, 1000], 2000)],\n            \"xs\": 100,\n            \"xr\": 900,\n            \"f\": 10,\n            \"eval_points\": [50, 100, 200, 500, 900, 950],\n        },\n        {\n            \"layers\": [([0, 500], 1800), ([500, 1000], 2200)],\n            \"xs\": 100,\n            \"xr\": 900,\n            \"f\": 5,\n            \"eval_points\": [400, 500, 600, 50, 950],\n        },\n        {\n            \"layers\": [([0, 1000], 1500)],\n            \"xs\": 500,\n            \"xr\": 500,\n            \"f\": 20,\n            \"eval_points\": [500, 550, 450],\n        },\n        {\n            \"layers\": [([0, 1000], 3000)],\n            \"xs\": 0,\n            \"xr\": 1000,\n            \"f\": 50,\n            \"eval_points\": [0, 250, 750, 1000, 1200, -200],\n        },\n    ]\n\n    all_results = []\n    for case in test_cases:\n        layers = case[\"layers\"]\n        xs = case[\"xs\"]\n        xr = case[\"xr\"]\n        f = case[\"f\"]\n        eval_points = case[\"eval_points\"]\n\n        omega = 2 * np.pi * f\n\n        for x in eval_points:\n            # Travel time from source to point x\n            Ts_x = calculate_travel_time(xs, x, layers)\n            # Travel time from point x to receiver\n            Tr_x = calculate_travel_time(x, xr, layers)\n            \n            total_time = Ts_x + Tr_x\n            \n            g_norm = np.cos(omega * total_time)\n            \n            # Format to precisely six decimal places\n            all_results.append(\"{:.6f}\".format(g_norm))\n\n    print(f\"[{','.join(all_results)}]\")\n\nsolve()\n```", "id": "3576398"}]}