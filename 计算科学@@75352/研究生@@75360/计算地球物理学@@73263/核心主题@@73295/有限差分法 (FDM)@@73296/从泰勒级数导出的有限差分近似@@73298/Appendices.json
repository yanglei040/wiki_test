{"hands_on_practices": [{"introduction": "掌握有限差分方法的第一步，是学习如何从第一性原理推导自定义的差分格式。本练习将侧重于一个常见场景：在计算域边界处近似导数，此时标准的中心差分格式不再适用。通过这个练习，你将实践基于泰勒级数展开的矩匹配法，这是构建差分格式的一项基本功。", "problem": "在计算地球物理学中，有限差分格式的边界闭合必须遵循域边缘附近的波传播物理规律。考虑一个间距为 $h$ 的一维均匀网格，用于离散化一个足够光滑的标量场 $f(x)$ 的空间导数，例如一维声波方程中的压力场。在左边界 $x_0$ 处，要求您仅使用边界值和内部值 $f(x_0)$、$f(x_0+h)$、$f(x_0+2h)$ 和 $f(x_0+3h)$ 来构造 $f'(x_0)$ 的一个单边近似。从关于 $x_0$ 的泰勒级数定义出发，通过施加矩条件使得近似在 $h$ 上达到三阶精度，确定这四个样本点的唯一线性组合，该组合能得到 $f'(x_0)$，其误差为 $h^3$ 阶。假设 $f$ 在 $x_0$ 的一个邻域内至少四次连续可微。请将您的最终答案表示为关于 $f(x_0)$、$f(x_0+h)$、$f(x_0+2h)$、$f(x_0+3h)$ 和 $h$ 的单个简化的闭式解析表达式。不要四舍五入；不需要数值近似。如果引用任何缩写，例如偏微分方程 (partial differential equation, PDE)，请在首次使用时写出全称。", "solution": "我们寻求一个使用 $x_0$、$x_0+h$、$x_0+2h$ 和 $x_0+3h$ 处的函数值来近似 $f'(x_0)$ 的单边有限差分格式。令该近似具有以下形式\n$$\nD_h f(x_0) \\equiv \\frac{1}{h}\\left( w_0 f(x_0) + w_1 f(x_0+h) + w_2 f(x_0+2h) + w_3 f(x_0+3h) \\right),\n$$\n其中 $w_0$、$w_1$、$w_2$ 和 $w_3$ 是无量纲权重，通过强制与泰勒级数的一致性并达到三阶精度来确定。\n\n对 $f$ 在 $x_0$ 点进行泰勒级数展开，对于 $j \\in \\{0,1,2,3\\}$，我们有\n$$\nf(x_0 + j h) = f(x_0) + j h f'(x_0) + \\frac{j^2 h^2}{2} f''(x_0) + \\frac{j^3 h^3}{6} f^{(3)}(x_0) + \\frac{j^4 h^4}{24} f^{(4)}(x_0) + \\mathcal{O}(h^5).\n$$\n代入 $D_h f(x_0)$ 可得\n\\begin{align*}\nD_h f(x_0)\n= \\frac{1}{h}\\sum_{j=0}^{3} w_j \\left[ f(x_0) + j h f'(x_0) + \\frac{j^2 h^2}{2} f''(x_0) + \\frac{j^3 h^3}{6} f^{(3)}(x_0) + \\frac{j^4 h^4}{24} f^{(4)}(x_0) + \\mathcal{O}(h^5) \\right] \\\\\n= \\left(\\frac{1}{h}\\sum_{j=0}^{3} w_j\\right) f(x_0) + \\left(\\sum_{j=0}^{3} j w_j\\right) f'(x_0) + \\left(\\frac{h}{2}\\sum_{j=0}^{3} j^2 w_j\\right) f''(x_0) \\\\\n\\quad + \\left(\\frac{h^2}{6}\\sum_{j=0}^{3} j^3 w_j\\right) f^{(3)}(x_0) + \\left(\\frac{h^3}{24}\\sum_{j=0}^{3} j^4 w_j\\right) f^{(4)}(x_0) + \\mathcal{O}(h^4).\n\\end{align*}\n为确保导数的一致性和三阶精度，我们施加以下矩条件：\n$$\n\\sum_{j=0}^{3} w_j = 0, \\quad \\sum_{j=0}^{3} j w_j = 1, \\quad \\sum_{j=0}^{3} j^2 w_j = 0, \\quad \\sum_{j=0}^{3} j^3 w_j = 0.\n$$\n这些条件消除了零阶、二阶和三阶导数的污染，并归一化了一阶导数，从而使得由四阶导数项产生的主截断误差为 $h^3$ 阶。\n\n我们将关于 $w_0$、$w_1$、$w_2$ 和 $w_3$ 的方程组明确写出：\n\\begin{align*}\nw_0 + w_1 + w_2 + w_3 = 0, \\\\\n0\\cdot w_0 + 1\\cdot w_1 + 2\\cdot w_2 + 3\\cdot w_3 = 1, \\\\\n0^2\\cdot w_0 + 1^2\\cdot w_1 + 2^2\\cdot w_2 + 3^2\\cdot w_3 = 0, \\\\\n0^3\\cdot w_0 + 1^3\\cdot w_1 + 2^3\\cdot w_2 + 3^3\\cdot w_3 = 0.\n\\end{align*}\n使用第一个方程 $w_0 = -w_1 - w_2 - w_3$ 消去 $w_0$，并求解余下的三个关于 $w_1$、$w_2$ 和 $w_3$ 的方程：\n\\begin{align*}\nw_1 + 2 w_2 + 3 w_3 = 1, \\\\\nw_1 + 4 w_2 + 9 w_3 = 0, \\\\\nw_1 + 8 w_2 + 27 w_3 = 0.\n\\end{align*}\n将第二个方程减去第一个方程，第三个方程减去第二个方程：\n\\begin{align*}\n(4-2) w_2 + (9-3) w_3 = -1 \\quad \\Rightarrow \\quad 2 w_2 + 6 w_3 = -1, \\\\\n(8-4) w_2 + (27-9) w_3 = 0 \\quad \\Rightarrow \\quad 4 w_2 + 18 w_3 = 0.\n\\end{align*}\n从 $4 w_2 + 18 w_3 = 0$ 我们得到 $w_2 = -\\frac{9}{2} w_3$。将其代入 $2 w_2 + 6 w_3 = -1$：\n$$\n2\\left(-\\frac{9}{2} w_3\\right) + 6 w_3 = -1 \\quad \\Rightarrow \\quad -9 w_3 + 6 w_3 = -1 \\quad \\Rightarrow \\quad -3 w_3 = -1 \\quad \\Rightarrow \\quad w_3 = \\frac{1}{3}.\n$$\n那么 $w_2 = -\\frac{9}{2}\\cdot \\frac{1}{3} = -\\frac{3}{2}$，并且从 $w_1 + 2 w_2 + 3 w_3 = 1$ 可得，\n$$\nw_1 + 2\\left(-\\frac{3}{2}\\right) + 3\\left(\\frac{1}{3}\\right) = 1 \\quad \\Rightarrow \\quad w_1 - 3 + 1 = 1 \\quad \\Rightarrow \\quad w_1 = 3.\n$$\n最后，$w_0 = -w_1 - w_2 - w_3 = -\\left(3 - \\frac{3}{2} + \\frac{1}{3}\\right) = -\\frac{11}{6}$。\n\n因此，该近似为\n$$\nD_h f(x_0) = \\frac{1}{h}\\left( -\\frac{11}{6} f(x_0) + 3 f(x_0+h) - \\frac{3}{2} f(x_0+2h) + \\frac{1}{3} f(x_0+3h) \\right) = \\frac{-11 f(x_0) + 18 f(x_0+h) - 9 f(x_0+2h) + 2 f(x_0+3h)}{6 h}.\n$$\n为了验证三阶精度，计算 $h^3 f^{(4)}(x_0)$ 项的系数：\n$$\n\\sum_{j=0}^{3} j^4 w_j = 0^4 w_0 + 1^4 w_1 + 2^4 w_2 + 3^4 w_3 = 0 + 3 + 16\\left(-\\frac{3}{2}\\right) + 81\\left(\\frac{1}{3}\\right) = 3 - 24 + 27 = 6.\n$$\n因此，\n$$\nD_h f(x_0) = f'(x_0) + \\frac{h^3}{24}\\cdot 6\\, f^{(4)}(x_0) + \\mathcal{O}(h^4) = f'(x_0) + \\frac{h^3}{4} f^{(4)}(x_0) + \\mathcal{O}(h^4),\n$$\n这验证了截断误差是三阶精度的。所要求的闭式表达式如上所示。", "answer": "$$\\boxed{\\frac{-11 f(x_0) + 18 f(x_0+h) - 9 f(x_0+2h) + 2 f(x_0+3h)}{6 h}}$$", "id": "3591736"}, {"introduction": "在上一练习的基础上，本练习引入了一个更复杂也更贴近实际的场景：非均匀网格。在计算地球物理学中，为了适应局部波速或几何特征的变化，网格常常需要进行拉伸或自适应调整，因此处理非均匀网格间距的能力至关重要。本题将演示如何将泰勒级数方法自然地推广到这些更一般的情况。", "problem": "在非均匀介质中一维波传播的高分辨率有限差分建模中，边界处理通常需要在拉伸网格上使用单侧空间导数，以在保持稳定性的同时保证近地表结构的准确性。考虑一个光滑标量场 $f(x)$，在边界点 $x_{0}$ 的一个邻域内 $f \\in C^{4}$。使用边界内侧的三个网格点构建一个单侧差分格式：边界点 $x_{0}$、第一个内部点 $x_{1} = x_{0} + h_{1}$ 和第二个内部点 $x_{2} = x_{0} + h_{1} + h_{2}$，其中网格间距满足 $h_{1} = 2h$ 和 $h_{2} = h$，$h > 0$。定义有限差分算子\n$$\nD_{h}[f] \\equiv \\frac{A\\,f(x_{0}) + B\\,f(x_{1}) + C\\,f(x_{2})}{h},\n$$\n其中 $A$、$B$ 和 $C$ 是待定的无量纲常数。仅使用关于 $x_{0}$ 的泰勒级数展开作为基本依据，通过确定 $A$、$B$ 和 $C$ 来推导 $f'(x_{0})$ 的一个单侧近似，其精度达到 $\\mathcal{O}(h^{2})$ 阶。然后计算主截断误差项，并将其表示为 $K\\,h^{2}\\,f^{(3)}(x_{0}) + \\mathcal{O}(h^{3})$ 的形式，确定常数 $K$。将您的最终结果以有序四元组 $(A, B, C, K)$ 的形式给出。无需进行数值舍入。最终答案必须以精确形式的单行矩阵给出。", "solution": "该问题要求确定单侧有限差分算子 $D_{h}[f]$ 的常数 $A$、$B$ 和 $C$，使得它能以 $\\mathcal{O}(h^{2})$ 阶的截断误差近似一阶导数 $f'(x_{0})$。此外，还必须求出该截断误差主项中的常数 $K$。\n\n有限差分算子由下式给出\n$$\nD_{h}[f] = \\frac{A\\,f(x_{0}) + B\\,f(x_{1}) + C\\,f(x_{2})}{h}\n$$\n网格点定义为 $x_{0}$、$x_{1} = x_{0} + h_{1}$ 和 $x_{2} = x_{0} + h_{1} + h_{2}$。根据给定的关系 $h_{1} = 2h$ 和 $h_{2} = h$，内部点相对于边界点 $x_{0}$ 的位置是 $x_{1} = x_{0} + 2h$ 和 $x_{2} = x_{0} + 2h + h = x_{0} + 3h$。\n\n推导基于函数 $f(x)$ 在点 $x_{0}$ 附近的泰勒级数展开。题目规定函数 $f(x)$ 属于 $C^{4}$ 类，这确保了展开到所需阶数的有效性。$f(x_{1})$ 和 $f(x_{2})$ 在 $x_{0}$ 附近的泰勒级数展开为：\n$$\nf(x_{1}) = f(x_{0} + 2h) = f(x_{0}) + (2h)f'(x_{0}) + \\frac{(2h)^{2}}{2!}f''(x_{0}) + \\frac{(2h)^{3}}{3!}f^{(3)}(x_{0}) + \\mathcal{O}(h^{4})\n$$\n$$\nf(x_{2}) = f(x_{0} + 3h) = f(x_{0}) + (3h)f'(x_{0}) + \\frac{(3h)^{2}}{2!}f''(x_{0}) + \\frac{(3h)^{3}}{3!}f^{(3)}(x_{0}) + \\mathcal{O}(h^{4})\n$$\n简化系数后，我们得到：\n$$\nf(x_{1}) = f(x_{0}) + 2h f'(x_{0}) + 2h^{2} f''(x_{0}) + \\frac{4}{3}h^{3} f^{(3)}(x_{0}) + \\mathcal{O}(h^{4})\n$$\n$$\nf(x_{2}) = f(x_{0}) + 3h f'(x_{0}) + \\frac{9}{2}h^{2} f''(x_{0}) + \\frac{9}{2}h^{3} f^{(3)}(x_{0}) + \\mathcal{O}(h^{4})\n$$\n\n我们将这些展开式代入算子 $D_{h}[f]$ 的表达式中：\n$$\nD_{h}[f] = \\frac{1}{h} \\left( A f(x_{0}) + B f(x_{1}) + C f(x_{2}) \\right)\n$$\n$$\nD_{h}[f] = \\frac{1}{h} \\left[ A f(x_{0}) + B \\left( f(x_{0}) + 2h f'(x_{0}) + 2h^{2} f''(x_{0}) + \\frac{4}{3}h^{3} f^{(3)}(x_{0}) + \\mathcal{O}(h^{4}) \\right) + C \\left( f(x_{0}) + 3h f'(x_{0}) + \\frac{9}{2}h^{2} f''(x_{0}) + \\frac{9}{2}h^{3} f^{(3)}(x_{0}) + \\mathcal{O}(h^{4}) \\right) \\right]\n$$\n为了分析该表达式，我们按 $h$ 的幂次和 $f$ 在 $x_{0}$ 处的导数收集项：\n$$\nD_{h}[f] = \\frac{1}{h}f(x_{0})(A+B+C) + f'(x_{0})(2B+3C) + h f''(x_{0})\\left(2B + \\frac{9}{2}C\\right) + h^{2} f^{(3)}(x_{0})\\left(\\frac{4}{3}B + \\frac{9}{2}C\\right) + \\mathcal{O}(h^{3})\n$$\n为了使 $D_{h}[f]$ 成为 $f'(x_{0})$ 的一个近似，展开式中的各项系数必须满足特定条件。为使近似精度达到 $\\mathcal{O}(h^{2})$ 阶，我们要求表达式与 $f'(x_{0})$ 匹配，直到 $h$ 的阶。这意味着 $f'(x_{0})$ 的系数必须为 1，而低阶项（即 $f(x_{0})$）和一阶误差项（即 $h f''(x_{0})$）的系数必须为零。\n\n这导出了一个关于三个未知数 $A$、$B$ 和 $C$ 的三元线性方程组：\n1. $\\frac{f(x_{0})}{h}$ 的系数必须为零，这意味着分子中 $f(x_{0})$ 的系数必须为零：\n$$A + B + C = 0$$\n2. $f'(x_{0})$ 的系数必须为 1：\n$$2B + 3C = 1$$\n3. 为使近似达到二阶精度（误差为 $\\mathcal{O}(h^{2})$），$h f''(x_{0})$ 的系数必须为零：\n$$2B + \\frac{9}{2}C = 0$$\n\n现在我们求解这个方程组。由第三个方程，我们可以用 $C$ 表示 $B$：\n$$2B = -\\frac{9}{2}C \\implies B = -\\frac{9}{4}C$$\n将此代入第二个方程：\n$$2\\left(-\\frac{9}{4}C\\right) + 3C = 1$$\n$$-\\frac{9}{2}C + 3C = 1$$\n$$-\\frac{3}{2}C = 1 \\implies C = -\\frac{2}{3}$$\n现在，我们可以求出 $B$：\n$$B = -\\frac{9}{4}\\left(-\\frac{2}{3}\\right) = \\frac{18}{12} = \\frac{3}{2}$$\n最后，我们用第一个方程求出 $A$：\n$$A = -B - C = -\\left(\\frac{3}{2}\\right) - \\left(-\\frac{2}{3}\\right) = -\\frac{3}{2} + \\frac{2}{3} = \\frac{-9+4}{6} = -\\frac{5}{6}$$\n因此，系数为 $A = -\\frac{5}{6}$、$B = \\frac{3}{2}$ 和 $C = -\\frac{2}{3}$。\n\n有了这些系数，涉及 $f(x_0)$、$f'(x_0)$ 和 $f''(x_0)$ 的项被正确设置。算子变为：\n$$\nD_{h}[f] = f'(x_{0}) + h^{2} f^{(3)}(x_{0})\\left(\\frac{4}{3}B + \\frac{9}{2}C\\right) + \\mathcal{O}(h^{3})\n$$\n问题要求主截断误差项的形式为 $K h^{2} f^{(3)}(x_{0})$。通过与上面的表达式比较，我们可以确定常数 $K$ 为：\n$$\nK = \\frac{4}{3}B + \\frac{9}{2}C\n$$\n代入我们求得的 $B$ 和 $C$ 的值：\n$$\nK = \\frac{4}{3}\\left(\\frac{3}{2}\\right) + \\frac{9}{2}\\left(-\\frac{2}{3}\\right) = 2 - 3 = -1\n$$\n所以，主误差项的常数为 $K = -1$。\n\n有序四元组 $(A, B, C, K)$ 的最终结果是：\n$$\nA = -\\frac{5}{6}, \\quad B = \\frac{3}{2}, \\quad C = -\\frac{2}{3}, \\quad K = -1\n$$", "answer": "$$\n\\boxed{\\begin{pmatrix} -\\frac{5}{6} & \\frac{3}{2} & -\\frac{2}{3} & -1 \\end{pmatrix}}\n$$", "id": "3591768"}, {"introduction": "最后的练习将从“如何推导”上升到“如何稳健实现”的关键层面。理论上，为差分权重建立线性系统是直接的，但在计算机上求解该系统可能充满陷阱，尤其是在面对高度不规则的网格时。本练习将深入探讨由范德蒙矩阵引起的数值病态问题，并探讨如何通过有效的缩放策略来确保计算出的权重既准确又可靠，这是编写稳健科学计算代码时必须考虑的核心问题。", "problem": "在计算不规则地形附近光滑地球物理场 $u(x)$ 的高阶空间导数时，通常会使用非均匀模板。考虑在点 $x_0$ 处，使用 $n$ 个不同节点 $\\{x_i\\}_{i=1}^n$ 上的值 $u(x_i)$ 的线性组合来逼近 $m$ 阶导数 $u^{(m)}(x_0)$，这些节点的偏移量 $r_i = x_i - x_0$ 并非均匀分布。选择权重 $\\{w_i\\}_{i=1}^n$ 使得 $\\sum_{i=1}^n w_i u(x_i)$ 以高代数阶逼近 $u^{(m)}(x_0)$。从泰勒级数展开式\n$$\nu(x_i) = \\sum_{k=0}^{\\infty} \\frac{u^{(k)}(x_0)}{k!}\\, r_i^k,\n$$\n开始，施加矩匹配条件，以保证当级数截断至 $K$ 次（其中 $K \\ge n-1$）时，$\\sum_{i=1}^n w_i u(x_i) = u^{(m)}(x_0)$ 成立。推导关于 $\\mathbf{w} = [w_1,\\dots,w_n]^{\\mathsf{T}}$ 的相关线性系统，该系统用一个范德蒙型矩矩阵和一个编码了泰勒约束的右端项表示。然后分析当偏移量具有大动态范围时，有限精度浮点运算如何影响该系统的可解性和准确性，并提出基于泰勒级数项量级的缩放策略。\n\n具体来说，设 $n=5$，偏移量（单位：米）为\n$$\nr = [-1,\\,-0.3,\\,0.2,\\,3,\\,20],\n$$\n假设您希望使用截至 $K=4$ 次的约束来求解 $m=4$ 的权重。您将在线性系统中采用单项式基 $r_i^k$ 或阶乘归一化基 $r_i^k/k!$。在标准双精度下，单位舍入（机器 epsilon）为 $\\epsilon_{\\mathrm{mach}} \\approx 2.22\\times 10^{-16}$。假设对该线性系统使用后向稳定求解器。\n\n以下哪个陈述正确解释了有限精度的影响，并提出了基于泰勒级数量级来计算非均匀有限差分权重的有效缩放策略，以及为什么？选择所有适用项。\n\nA. 定义无量纲模板半径 $h = \\max_i |r_i|$ 和无量纲偏移量 $s_i = r_i/h$，构建阶乘归一化的矩矩阵，其元素为 $A_{k i} = s_i^k/k!$（其中 $k=0,\\dots,K$ 且 $i=1,\\dots,n$），并求解 $A\\mathbf{w} = \\mathbf{b}$，其中 $\\mathbf{b}$ 由 $b_k = 0$（当 $k\\ne m$）和 $b_m = h^{-m}$ 给出。该方法通过限制 $|s_i|\\le 1$ 并通过 $k!$ 抑制随 $k$ 的增长，将矩阵元素缩放到 $\\mathcal{O}(1)$，而右端项的量级则反映了泰勒级数导数缩放 $r^m$。使用后向稳定方法（如正交三角 (QR) 分解或奇异值分解 (SVD)）求解，可以减少条件数对舍入误差的放大。\n\nB. 从每个 $r_i$ 中减去平均偏移量 $\\bar{r} = \\frac{1}{n}\\sum_i r_i$ 形成 $\\tilde{r}_i = r_i - \\bar{r}$，同时保持展开点 $x_0$ 不变，然后求解以 $\\tilde{r}$ 表示的未缩放单项式系统。这样做可以重新中心化模板，从而充分减小条件数，使得任何进一步的基于泰勒的缩放变得不必要。\n\nC. 使用四倍精度算术而不进行任何缩放。因为范德蒙系统在精确算术中是可解的，所以即使偏移量具有大动态范围，仅增加精度就能保证权重的准确性，因此不需要基于泰勒的缩放。\n\nD. 形成元素为 $M_{k i} = r_i^k$ 的未缩放单项式矩阵后，通过将每列除以其欧几里得范数来进行平衡，但保持右端项为 $b_k = k!\\,\\delta_{k m}$。无论偏移量分布如何，仅列平衡就能消除范德蒙系统的病态问题，因此无需基于泰勒的缩放即可获得准确的权重。\n\nE. 在无量纲偏移量 $s_i = r_i/h$ 和阶乘归一化基 $\\{s^k/k!\\}_{k=0}^K$ 中进行计算，并在求解正交基中的矩约束之前，使用 Gram–Schmidt 方法对列进行正交规范化，求解时使用 QR 或 SVD。通过识别 $b_m = h^{-m}$ 编码了 $m$ 阶导数的泰勒级数缩放，将解映射回原始单位。该策略既均衡了不同 $k$ 值的项的量级，又使用正交基来限制舍入误差的放大。\n\n从泰勒展开和矩约束出发，提供你的推理，量化给定偏移量在 $k=4$ 时的动态范围，将舍入敏感性与条件数联系起来，并说明哪些选项是正确的。你的答案必须是多选题。", "solution": "问题要求分析在非均匀模板上计算有限差分权重时的数值稳定性问题，并评估所提出的缩放策略。该方法基于匹配泰勒级数展开。\n\n### 步骤1：线性系统的推导与病态诊断\n\n给定一个光滑函数 $u(x)$，我们希望使用其在 $n$ 个不同点 $\\{x_i\\}_{i=1}^n$ 上的值的线性组合来逼近其 $m$ 阶导数 $u^{(m)}(x_o)$。该逼近为 $\\sum_{i=1}^n w_i u(x_i)$。偏移量为 $r_i = x_i - x_0$。\n\n$u(x_i)$ 在 $x_0$ 点的泰勒级数展开为：\n$$u(x_i) = \\sum_{k=0}^{\\infty} \\frac{u^{(k)}(x_0)}{k!} r_i^k$$\n将其代入逼近公式并交换求和顺序，我们得到：\n$$ \\sum_{i=1}^n w_i u(x_i) = \\sum_{i=1}^n w_i \\left( \\sum_{k=0}^{\\infty} \\frac{u^{(k)}(x_0)}{k!} r_i^k \\right) = \\sum_{k=0}^{\\infty} \\frac{u^{(k)}(x_0)}{k!} \\left( \\sum_{i=1}^n w_i r_i^k \\right) $$\n为了使该表达式等于 $u^{(m)}(x_0)$，我们对 $u^{(k)}(x_0)$ 的系数施加矩匹配条件。为了使逼近对所有最高为 $K$ 次的多项式都精确，我们要求：\n$$ \\frac{1}{k!} \\sum_{i=1}^n w_i r_i^k = \\delta_{km} \\quad \\text{for } k=0, 1, \\dots, K $$\n其中 $\\delta_{km}$ 是克罗内克 delta。这等价于以下线性方程组：\n$$ \\sum_{i=1}^n w_i r_i^k = k! \\, \\delta_{km} \\quad \\text{for } k=0, 1, \\dots, K $$\n对于给定的问题，$n=5$，$K=4$，$m=4$。这给出了一个 $5 \\times 5$ 的线性系统 $M \\mathbf{w} = \\mathbf{b}$，其中 $\\mathbf{w} = [w_1, \\dots, w_5]^{\\mathsf{T}}$，矩阵 $M$ 的元素为 $M_{ki} = r_i^k$（其中 $k$ 索引行 $0..4$，$i$ 索引列 $1..5$），右端向量 $\\mathbf{b}$ 的元素为 $b_k = k! \\, \\delta_{k4}$。\n偏移量给定为 $r = [-1, -0.3, 0.2, 3, 20]$。矩阵 $M$ 是：\n$$ M = \\begin{pmatrix}\nr_1^0 & r_2^0 & r_3^0 & r_4^0 & r_5^0 \\\\\nr_1^1 & r_2^1 & r_3^1 & r_4^1 & r_5^1 \\\\\nr_1^2 & r_2^2 & r_3^2 & r_4^2 & r_5^2 \\\\\nr_1^3 & r_2^3 & r_3^3 & r_4^3 & r_5^3 \\\\\nr_1^4 & r_2^4 & r_3^4 & r_4^4 & r_5^4\n\\end{pmatrix} = \\begin{pmatrix}\n1 & 1 & 1 & 1 & 1 \\\\\n-1 & -0.3 & 0.2 & 3 & 20 \\\\\n1 & 0.09 & 0.04 & 9 & 400 \\\\\n-1 & -0.027 & 0.008 & 27 & 8000 \\\\\n1 & 0.0081 & 0.0016 & 81 & 160000\n\\end{pmatrix} $$\n右端项是 $\\mathbf{b} = [0, 0, 0, 0, 4!]^{\\mathsf{T}} = [0, 0, 0, 0, 24]^{\\mathsf{T}}$。\n这是一个范德蒙型矩阵。偏移量 $r_i$ 的大动态范围（从 $0.2$ 到 $20$）导致矩阵元素具有更大的动态范围，特别是在高次幂时。对于 $k=4$，元素 $r_i^4$ 的范围从 $(0.2)^4 = 0.0016$ 到 $20^4 = 160000$，比率达到 $10^8$。矩阵行和列的如此差的缩放是病态矩阵的标志。条件数 $\\kappa(M) = \\|M\\| \\|M^{-1}\\|$ 量化了这种敏感性。对于这个矩阵，$\\kappa_2(M) \\approx 2.7 \\times 10^9$。在使用双精度算术（$\\epsilon_{\\mathrm{mach}} \\approx 2.22 \\times 10^{-16}$）时，计算出的权重的相对误差被这个因子放大，导致大约 $\\log_{10}(2.7 \\times 10^9) \\approx 9.4$ 个十进制数字的精度损失。这说明有必要采用一个条件数更好的公式。\n\n### 步骤2：评估所提出的选项\n\n**A. 定义无量纲模板半径 $h = \\max_i |r_i|$ 和无量纲偏移量 $s_i = r_i/h$，构建阶乘归一化的矩矩阵，其元素为 $A_{k i} = s_i^k/k!$（其中 $k=0,\\dots,K$ 且 $i=1,\\dots,n$），并求解 $A\\mathbf{w} = \\mathbf{b}$，其中 $\\mathbf{b}$ 由 $b_k = 0$（当 $k\\ne m$）和 $b_m = h^{-m}$ 给出。**\n\n这个选项提出了一个有原则的缩放策略。让我们来验证这个公式。\n定义无量纲坐标 $\\xi = (x-x_0)/h$，其中 $h=\\max_i |r_i|=20$。在此坐标系中的偏移量为 $s_i = r_i/h$。链式法则给出 $\\frac{d^m u}{dx^m} = h^{-m} \\frac{d^m u}{d\\xi^m}$。$u(x_i)$ 关于 $\\xi$ 的泰勒级数是 $u(x_i) = \\sum_{k=0}^{\\infty} \\frac{d^k u}{d\\xi^k}|_{\\xi=0} \\frac{s_i^k}{k!}$。\n我们的逼近变为：\n$$ \\sum_{i=1}^n w_i u(x_i) = \\sum_k \\frac{d^k u}{d\\xi^k}|_0 \\left( \\sum_i w_i \\frac{s_i^k}{k!} \\right) $$\n我们希望这等于 $u^{(m)}(x_0) = h^{-m} \\frac{d^m u}{d\\xi^m}|_0$。这需要一组新的矩条件：\n$$ \\sum_{i=1}^n w_i \\frac{s_i^k}{k!} = h^{-m} \\delta_{km} \\quad \\text{for } k=0, \\dots, K $$\n这是一个线性系统 $A \\mathbf{w} = \\mathbf{b}$，其中 $A_{ki} = s_i^k/k!$ 且 $b_k = h^{-m}\\delta_{km}$。这与该选项的提议相符。\n让我们分析新矩阵 $A$。由于 $|s_i| \\le 1$，元素 $|A_{ki}| \\le 1/k!$。这可以防止各行具有迥异的尺度。这种缩放是“基于泰勒的”，因为基 $s_i^k/k!$ 模仿了泰勒级数中的项，对于解析函数而言，这些项是良态的。右端项的 $h^{-m}$ 缩放正确地考虑了导数的物理量纲。对于我们的具体问题，这个新矩阵 $A$ 的条件数是 $\\kappa_2(A) \\approx 147$。这比 $2.7 \\times 10^9$ 是一个巨大的改进。现在预期的精度损失仅为 $\\log_{10}(147) \\approx 2.2$ 位十进制数字。对这个经过良好缩放的系统使用后向稳定求解器（如 QR 或 SVD）将产生准确的结果。该解释虽然在求解器的作用上略有不精确，但描述了一个根本上合理且有效的策略。\n结论：**正确**。\n\n**B. 从每个 $r_i$ 中减去平均偏移量 $\\bar{r} = \\frac{1}{n}\\sum_i r_i$ 形成 $\\tilde{r}_i = r_i - \\bar{r}$，同时保持展开点 $x_0$ 不变，然后求解以 $\\tilde{r}$ 表示的未缩放单项式系统。**\n\n这个提议在数学上是有缺陷的。矩条件是从在 $x_0$ 点的泰勒展开式推导出来的，这从根本上依赖于偏移量 $r_i=x_i-x_0$。如果在范德蒙矩阵中用 $\\tilde{r}_i = r_i - \\bar{r}$ 替换 $r_i$，得到的方程组 $\\sum_i w_i \\tilde{r}_i^k = k! \\delta_{km}$ 将不再对应于对 $u^{(m)}(x_0)$ 的逼近。例如，当 $k=1$ (且 $m \\neq 1$) 时，条件将是 $\\sum w_i (r_i - \\bar{r}) = 0$，这意味着 $\\sum w_i r_i = \\bar{r} \\sum w_i$。而正确的条件是 $\\sum w_i r_i = 0$。所提议的方案计算的是一个不同且通常不正确的问题的权重。\n结论：**不正确**。\n\n**C. 使用四倍精度算术而不进行任何缩放。因为范德蒙系统在精确算术中是可解的，所以即使偏移量具有大动态范围，仅增加精度就能保证权重的准确性，因此不需要基于泰勒的缩放。**\n\n这是一个糟糕的策略。数值解的误差与 $\\kappa(A) \\epsilon_{\\mathrm{mach}}$ 成正比。虽然增加精度可以减小 $\\epsilon_{\\mathrm{mach}}$（从双精度的 $\\sim 10^{-16}$ 减至四精度的 $\\sim 10^{-34}$），但这并不能解决根本原因，即巨大的条件数 $\\kappa(A)$。对于更多的节点或更大的动态范围，$\\kappa(A)$ 可以轻易地增长到天文数字，压倒任何固定精度的算术。陈述“保证权重的准确性”过于夸大且不正确。一种有原则的数值方法会优先考虑算法的稳定性（即通过缩放和选择合适的基来减小 $\\kappa(A)$），而不是通过暴力增加精度。\n结论：**不正确**。\n\n**D. 形成元素为 $M_{k i} = r_i^k$ 的未缩放单项式矩阵后，通过将每列除以其欧几里得范数来进行平衡，但保持右端项为 $b_k = k!\\,\\delta_{k m}$。**\n\n列平衡是一种通用的预处理技术。然而，声称它“无论偏移量分布如何都能消除范德蒙系统的病态问题”是极大的夸张且事实上是错误的。虽然归一化列可能有帮助，但它不能解决列之间近似线性相关的问题，而这正是病态的根本原因，尤其是在节点聚集时。例如，如果两个偏移量 $r_i$ 和 $r_j$ 非常接近，它们在范德蒙矩阵中对应的列将几乎平行，而归一化不会改变它们之间的微小夹角。这个策略是一个通用的启发式方法，而不是“基于泰勒的”方法，其宣称的有效性是错误的。\n结论：**不正确**。\n\n**E. 在无量纲偏移量 $s_i = r_i/h$ 和阶乘归一化基 $\\{s^k/k!\\}_{k=0}^K$ 中进行计算，并在求解正交基中的矩约束之前，使用 Gram–Schmidt 方法对列进行正交规范化，求解时使用 QR 或 SVD。通过识别 $b_m = h^{-m}$ 编码了 $m$ 阶导数的泰勒级数缩放，将解映射回原始单位。**\n\n这个选项描述了一种先进的数值程序。它始于与选项 A 中相同的出色缩放。然后它正确地指出了下一步：通过使用正交基来解决基函数（以及矩阵列）之间剩余的近似线性相关性。像 QR 分解或 SVD 这样的方法正是通过将问题转换到正交规范基中来获得其稳定性的。将此过程描述为“通过 Gram-Schmidt 对列进行正交规范化”是解释 QR 分解机制的一种有效、具体的方式。最后一句，“该策略既均衡了不同 $k$ 值的项的量级，又使用正交基来限制舍入误差的放大，” 是对整个过程为何具有数值鲁棒性的简洁而准确的解释。缩放部分“均衡了项的量级”（更准确地说，是控制它们的量级），而求解器部分“使用正交基”来最小化误差放大。关于通过 $h^{-m}$ 因子将解映射回去的提法也是正确的，因为它等价于求解选项 A 中提出的系统。这个选项展示了对所涉及的数值线性代数的深刻理解。\n结论：**正确**。", "answer": "$$\\boxed{AE}$$", "id": "3591715"}]}