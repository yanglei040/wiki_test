{"hands_on_practices": [{"introduction": "要将完美匹配层（PML）理论应用于实际的数值模拟，首要任务是确保算法的稳定性。在时域有限差分（FDTD）方法中，Courant–Friedrichs–Lewy（CFL）条件是保证数值解收敛的关键。本练习 [@problem_id:3612714] 将指导你通过经典的冯·诺依曼稳定性分析，推导在卷积完美匹配层（C-PML）影响下的CFL条件，从而揭示PML参数如何改变最大允许时间步长。掌握这一分析是成功实现任何基于FDTD的PML模拟的基础。", "problem": "考虑在均匀介质中的二维线性声学方程，该介质具有恒定的密度 $\\rho$ 和体积模量 $K$，波速为 $c = \\sqrt{K/\\rho}$。其一阶形式的方程组为\n$$\n\\frac{\\partial p}{\\partial t} = -K\\left(\\frac{\\partial v_x}{\\partial x} + \\frac{\\partial v_y}{\\partial y}\\right), \\quad\n\\frac{\\partial v_x}{\\partial t} = -\\frac{1}{\\rho}\\frac{\\partial p}{\\partial x}, \\quad\n\\frac{\\partial v_y}{\\partial t} = -\\frac{1}{\\rho}\\frac{\\partial p}{\\partial y}.\n$$\n假设整个计算域充满了均匀的卷积完美匹配层 (C-PML)，其特征为恒定的拉伸参数 $\\kappa_x \\ge 1$、$\\kappa_y \\ge 1$，恒定的阻尼剖面 $\\sigma_x = \\sigma_y = \\sigma \\ge 0$，并设置 $\\alpha_x = \\alpha_y = 0$。在频域中，C-PML 坐标拉伸通过 $s_x^{-1}\\partial/\\partial x$ 和 $s_y^{-1}\\partial/\\partial y$ 来修正空间导数，其中 $s_x(\\omega) = \\kappa_x + \\sigma_x/(i\\omega)$ 且 $s_y(\\omega) = \\kappa_y + \\sigma_y/(i\\omega)$。\n\n在均匀交错网格（压力 $p$ 位于整数时间层 $n\\Delta t$ 和整数空间节点，速度 $v_x, v_y$ 位于半时间步 $(n+\\tfrac{1}{2})\\Delta t$ 和交错的空间位置）上，使用空间步长为 $(\\Delta x, \\Delta y)$ 的二阶精度中心差分和标准的蛙跳法时间步进格式对该方程组进行离散化。在 $\\kappa_x$、$\\kappa_y$ 和 $\\sigma$ 在整个时空中均为常数的假设下，进行 von Neumann 分析。对离散场使用以下形式的平面波拟设\n$$\np^n_{j,k} = P\\,G^n \\exp\\!\\left(i k_x j \\Delta x + i k_y k \\Delta y\\right), \\quad v_x^{n+\\frac{1}{2}}{}_{j+\\frac{1}{2},k} = V_x\\,G^{n+\\frac{1}{2}} \\exp\\!\\left(i k_x \\left(j+\\tfrac{1}{2}\\right) \\Delta x + i k_y k \\Delta y\\right),\n$$\n$v_y$ 的形式类似，其中 $G$ 是放大因子，$(k_x, k_y)$ 是空间波数。\n\n从基本声学方程和 C-PML 拉伸算子的定义出发，推导关于 $G$ 的离散色散关系，并通过要求在第一布里渊区内对所有 $(k_x, k_y)$ 都有 $|G| \\le 1$ 来建立 Courant–Friedrichs–Lewy (CFL) 稳定性条件。明确展示 C-PML 参数 $(\\kappa_x,\\kappa_y,\\sigma)$ 如何进入空间算子的符号中，并解释 $\\sigma$ 在稳定性界限中的作用。然后，在所述假设下，计算最大允许时间步长 $\\Delta t_{\\max}$，将其表示为 $c$、$\\Delta x$、$\\Delta y$ 和 PML 参数 $(\\kappa_x, \\kappa_y)$ 的闭式函数。\n\n以秒为单位表示最终的 $\\Delta t_{\\max}$。无需进行数值代入；提供一个单一的闭式解析表达式。不要四舍五入。", "solution": "该问题要求推导在由卷积完美匹配层 (C-PML) 控制的域中，使用有限差分格式离散化的二维声学方程的 Courant–Friedrichs–Lewy (CFL) 稳定性条件。\n\n首先，我们必须验证问题陈述。\n\n### 步骤 1：提取已知条件\n-   **控制方程**：\n    $$\n    \\frac{\\partial p}{\\partial t} = -K\\left(\\frac{\\partial v_x}{\\partial x} + \\frac{\\partial v_y}{\\partial y}\\right), \\quad\n    \\frac{\\partial v_x}{\\partial t} = -\\frac{1}{\\rho}\\frac{\\partial p}{\\partial x}, \\quad\n    \\frac{\\partial v_y}{\\partial t} = -\\frac{1}{\\rho}\\frac{\\partial p}{\\partial y}.\n    $$\n-   **介质属性**：均匀，具有恒定的密度 $\\rho$ 和体积模量 $K$。\n-   **波速**：$c = \\sqrt{K/\\rho}$。\n-   **PML 模型**：具有恒定参数的卷积 PML (C-PML)。\n-   **PML 参数**：拉伸因子 $\\kappa_x \\ge 1$，$\\kappa_y \\ge 1$。阻尼剖面 $\\sigma_x = \\sigma_y = \\sigma \\ge 0$。$\\alpha_x = \\alpha_y = 0$。\n-   **PML 拉伸算子（频域）**：空间导数 $\\partial/\\partial x$ 被因子 $s_x(\\omega)^{-1}$ 修正，$\\partial/\\partial y$ 被 $s_y(\\omega)^{-1}$ 修正，其中 $s_x(\\omega) = \\kappa_x + \\sigma_x/(i\\omega)$ 且 $s_y(\\omega) = \\kappa_y + \\sigma_y/(i\\omega)$。\n-   **离散化方案**：\n    -   网格：均匀交错网格。压力 $p$ 位于整数时间层 $n\\Delta t$ 和整数空间节点 $(j\\Delta x, k\\Delta y)$。速度 $v_x, v_y$ 分别位于半整数时间层 $(n+\\tfrac{1}{2})\\Delta t$ 和交错的空间位置 $((j+\\tfrac{1}{2})\\Delta x, k\\Delta y)$ 和 $(j\\Delta x, (k+\\tfrac{1}{2})\\Delta y)$。\n    -   空间离散化：空间步长为 $\\Delta x, \\Delta y$ 的二阶精度中心差分。\n    -   时间离散化：标准蛙跳法时间步进。\n-   **分析方法**：使用平面波拟设的 von Neumann 稳定性分析。\n-   **平面波拟设**：\n    $$\n    p^n_{j,k} = P\\,G^n \\exp\\!\\left(i k_x j \\Delta x + i k_y k \\Delta y\\right)\n    $$\n    $$\n    v_x^{n+\\frac{1}{2}}{}_{j+\\frac{1}{2},k} = V_x\\,G^{n+\\frac{1}{2}} \\exp\\!\\left(i k_x \\left(j+\\tfrac{1}{2}\\right) \\Delta x + i k_y k \\Delta y\\right)\n    $$\n    $v_y$ 具有相似的形式，其中 $G$ 是放大因子，$(k_x, k_y)$ 是空间波数。\n-   **目标**：推导关于 $G$ 的离散色散关系，通过要求 $|G| \\le 1$ 找到 CFL 稳定性条件，解释 $\\sigma$ 的作用，并找到最大允许时间步长 $\\Delta t_{\\max}$ 作为 $c$、$\\Delta x$、$\\Delta y$、$\\kappa_x$ 和 $\\kappa_y$ 的函数。\n\n### 步骤 2：使用提取的已知条件进行验证\n-   **科学依据**：该问题基于标准的声学波动方程和广泛用于时域有限差分 (FDTD) 模拟中吸收边界条件的 C-PML 公式。该方法是偏微分方程数值分析的基石。该问题在事实上和科学上都是合理的。\n-   **适定性**：问题定义清晰，提供了推导稳定性条件所需的所有必要组成部分。目标明确且可实现。\n-   **目标**：语言精确、技术性强，没有任何主观性或歧义。\n-   **完备性与一致性**：所提供的信息是自洽且充分的。对交错网格、时间步进方案和 C-PML 模型的描述与计算波物理学中的标准实践一致。\n-   **其他缺陷**：该问题并非琐碎、不切实际或存在其他缺陷。\n\n### 步骤 3：结论与行动\n问题有效。我们继续进行求解。\n\n#### 离散色散关系的推导\n\n对于给定的交错网格，蛙跳法时间步进格式可以写为：\n$$\n\\frac{p^{n+1}_{j,k} - p^{n}_{j,k}}{\\Delta t} = -K\\left[ (D_x^{PML} v_x^{n+1/2})_{j,k} + (D_y^{PML} v_y^{n+1/2})_{j,k} \\right] \\quad (1)\n$$\n$$\n\\frac{v_x^{n+\\frac{1}{2}}{}_{j+\\frac{1}{2},k} - v_x^{n-\\frac{1}{2}}{}_{j+\\frac{1}{2},k}}{\\Delta t} = -\\frac{1}{\\rho} (D_x^{PML} p^{n})_{j+\\frac{1}{2},k} \\quad (2)\n$$\n$$\n\\frac{v_y^{n+\\frac{1}{2}}{}_{j,k+\\frac{1}{2}} - v_y^{n-\\frac{1}{2}}{}_{j,k+\\frac{1}{2}}}{\\Delta t} = -\\frac{1}{\\rho} (D_y^{PML} p^{n})_{j,k+\\frac{1}{2}} \\quad (3)\n$$\n其中 $D_x^{PML}$ 和 $D_y^{PML}$ 表示经 PML 修正的离散空间导数算子。\n\n为了进行 von Neumann 分析，我们将平面波拟设代入这些方程。作用于平面波拟设的标准二阶中心差分算子变为乘法因子（符号）。对于场 $f$，算子 $D_x$ 在波数 $k_x$ 处的符号 $\\hat{D}_x$ 为：\n$$\n\\hat{D}_x f = \\frac{\\exp(i k_x \\Delta x/2) - \\exp(-i k_x \\Delta x/2)}{\\Delta x} f = \\frac{2i}{\\Delta x}\\sin\\left(\\frac{k_x \\Delta x}{2}\\right) f\n$$\n类似地，对于 $y$ 方向的导数：\n$$\n\\hat{D}_y f = \\frac{2i}{\\Delta y}\\sin\\left(\\frac{k_y \\Delta y}{2}\\right) f\n$$\n问题陈述 C-PML 在频域中通过因子 $s_x(\\omega)^{-1}$ 和 $s_y(\\omega)^{-1}$ 修正空间导数。在 von Neumann 分析的背景下，连续频率 $\\omega$ 被视为离散模式的数值频率，它通过 $G = \\exp(-i\\omega\\Delta t)$ 与放大因子 $G$ 相关。因此，经 PML 修正的算子的符号变为：\n$$\n\\hat{D}^{PML}_x = \\frac{\\hat{D}_x}{s_x(\\omega)}, \\quad \\hat{D}^{PML}_y = \\frac{\\hat{D}_y}{s_y(\\omega)}\n$$\n将拟设和这些符号代入方程 $(1)-(3)$：\n方程 $(1)$ 变为：\n$P G^n \\frac{G-1}{\\Delta t} = -K \\left[ V_x G^{n+\\frac{1}{2}} \\frac{\\hat{D}_x}{s_x} + V_y G^{n+\\frac{1}{2}} \\frac{\\hat{D}_y}{s_y} \\right]$\n除以 $G^n$ 得：\n$$\nP(G-1) = -K \\Delta t G^{\\frac{1}{2}} \\left( V_x \\frac{\\hat{D}_x}{s_x} + V_y \\frac{\\hat{D}_y}{s_y} \\right) \\quad (1')\n$$\n方程 $(2)$ 变为：\n$V_x G^{n-\\frac{1}{2}} \\frac{G-1}{\\Delta t} = -\\frac{1}{\\rho} P G^n \\frac{\\hat{D}_x}{s_x}$\n除以 $G^{n-\\frac{1}{2}}$ 得：\n$$\nV_x(G-1) = -\\frac{\\Delta t}{\\rho} G^{\\frac{1}{2}} P \\frac{\\hat{D}_x}{s_x} \\quad (2')\n$$\n类似地，方程 $(3)$ 变为：\n$$\nV_y(G-1) = -\\frac{\\Delta t}{\\rho} G^{\\frac{1}{2}} P \\frac{\\hat{D}_y}{s_y} \\quad (3')\n$$\n从 $(2')$ 和 $(3')$，我们将 $V_x$ 和 $V_y$ 用 $P$ 表示：\n$$\nV_x = -\\frac{\\Delta t}{\\rho} \\frac{G^{\\frac{1}{2}}}{G-1} P \\frac{\\hat{D}_x}{s_x}, \\quad V_y = -\\frac{\\Delta t}{\\rho} \\frac{G^{\\frac{1}{2}}}{G-1} P \\frac{\\hat{D}_y}{s_y}\n$$\n将它们代入 $(1')$：\n$$\nP(G-1) = -K \\Delta t G^{\\frac{1}{2}} \\left[ \\left(-\\frac{\\Delta t}{\\rho} \\frac{G^{\\frac{1}{2}}}{G-1} P \\frac{\\hat{D}_x}{s_x}\\right) \\frac{\\hat{D}_x}{s_x} + \\left(-\\frac{\\Delta t}{\\rho} \\frac{G^{\\frac{1}{2}}}{G-1} P \\frac{\\hat{D}_y}{s_y}\\right) \\frac{\\hat{D}_y}{s_y} \\right]\n$$\n对于非平凡解（$P \\ne 0$），我们可以消去 $P$ 并简化：\n$$\n(G-1) = \\frac{K \\Delta t^2}{\\rho} \\frac{G}{G-1} \\left( \\frac{\\hat{D}_x^2}{s_x^2} + \\frac{\\hat{D}_y^2}{s_y^2} \\right)\n$$\n使用 $c^2 = K/\\rho$，这给出了关于 $G$ 的离散色散关系：\n$$\n(G-1)^2 = G c^2 \\Delta t^2 \\left( \\frac{\\hat{D}_x^2}{s_x(\\omega)^2} + \\frac{\\hat{D}_y^2}{s_y(\\omega)^2} \\right)\n$$\n代入 $\\hat{D}_x^2$ 和 $\\hat{D}_y^2$ 的表达式：\n$$\n(G-1)^2 = G c^2 \\Delta t^2 \\left[ \\frac{-4\\sin^2(k_x\\Delta x/2)}{s_x(\\omega)^2 \\Delta x^2} + \\frac{-4\\sin^2(k_y\\Delta y/2)}{s_y(\\omega)^2 \\Delta y^2} \\right]\n$$\n这可以使用关系式 $G=\\exp(-i\\omega\\Delta t)$ 重写。项 $(G-1)^2/G = (G^{1/2}-G^{-1/2})^2 = (\\exp(-i\\omega\\Delta t/2) - \\exp(i\\omega\\Delta t/2))^2 = (-2i\\sin(\\omega\\Delta t/2))^2 = -4\\sin^2(\\omega\\Delta t/2)$。\n$$\n-4\\sin^2\\left(\\frac{\\omega\\Delta t}{2}\\right) = -4 c^2 \\Delta t^2 \\left[ \\frac{\\sin^2(k_x\\Delta x/2)}{s_x(\\omega)^2 \\Delta x^2} + \\frac{\\sin^2(k_y\\Delta y/2)}{s_y(\\omega)^2 \\Delta y^2} \\right]\n$$\n因此，关联数值频率 $\\omega$ 和波数 $(k_x, k_y)$ 的色散关系是：\n$$\n\\sin^2\\left(\\frac{\\omega\\Delta t}{2}\\right) = c^2 \\Delta t^2 \\left[ \\frac{\\sin^2(k_x\\Delta x/2)}{s_x(\\omega)^2 \\Delta x^2} + \\frac{\\sin^2(k_y\\Delta y/2)}{s_y(\\omega)^2 \\Delta y^2} \\right]\n$$\n\n#### CFL 稳定性条件及 $\\sigma$ 的作用\n\n稳定性条件是对所有波数都满足 $|G| \\le 1$。由于 $G = \\exp(-i\\omega\\Delta t)$，这等价于要求数值频率的虚部为非正，即 $\\text{Im}(\\omega) \\le 0$。\n\nC-PML 参数由 $s_x(\\omega) = \\kappa_x + \\sigma/(i\\omega)$ 和 $s_y(\\omega) = \\kappa_y + \\sigma/(i\\omega)$ 给出。时间步长 $\\Delta t$ 的稳定性极限由最不稳定（或最不衰减）的模式决定。我们研究色散关系在极限情况下的行为。\n\n考虑高频模式，其中 $|\\omega| \\to \\infty$。在此极限下，项 $\\sigma/(i\\omega) \\to 0$。拉伸因子趋近于它们的实的、与频率无关的部分：\n$$\n\\lim_{|\\omega|\\to\\infty} s_x(\\omega) = \\kappa_x, \\quad \\lim_{|\\omega|\\to\\infty} s_y(\\omega) = \\kappa_y\n$$\n在此极限下，色散关系简化为：\n$$\n\\sin^2\\left(\\frac{\\omega\\Delta t}{2}\\right) = c^2 \\Delta t^2 \\left[ \\frac{\\sin^2(k_x\\Delta x/2)}{\\kappa_x^2 \\Delta x^2} + \\frac{\\sin^2(k_y\\Delta y/2)}{\\kappa_y^2 \\Delta y^2} \\right]\n$$\n为了使解 $\\omega$ 为实数，右侧（为实数且非负）必须不超过 $1$。如果右侧大于 $1$，$\\sin(\\omega\\Delta t/2)$ 将变得大于 $1$，这意味着 $\\omega\\Delta t/2$ 是复数。在这种非耗散情况下，复数 $\\omega$ 会导致一个增长模式和一个衰减模式（$|G|>1$ 和 $|G|1$），从而导致不稳定。因此，为了所有模式的稳定性，我们必须要求：\n$$\nc^2 \\Delta t^2 \\left[ \\frac{\\sin^2(k_x\\Delta x/2)}{\\kappa_x^2 \\Delta x^2} + \\frac{\\sin^2(k_y\\Delta y/2)}{\\kappa_y^2 \\Delta y^2} \\right] \\le 1\n$$\n这个条件必须在第一布里渊区内对所有波数 $(k_x, k_y)$ 都成立，即 $k_x \\in [-\\pi/\\Delta x, \\pi/\\Delta x]$ 且 $k_y \\in [-\\pi/\\Delta y, \\pi/\\Delta y]$。为了找到对 $\\Delta t$ 最严格的条件，我们必须使左侧关于 $k_x$ 和 $k_y$ 最大化。$\\sin^2(\\cdot)$ 的最大值为 $1$，这发生在奈奎斯特波数 $k_x = \\pm \\pi/\\Delta x$ 和 $k_y = \\pm \\pi/\\Delta y$ 处。\n因此，稳定性条件变为：\n$$\nc^2 \\Delta t^2 \\left[ \\frac{1}{\\kappa_x^2 \\Delta x^2} + \\frac{1}{\\kappa_y^2 \\Delta y^2} \\right] \\le 1\n$$\n\n$\\sigma$ 的作用：参数 $\\sigma \\ge 0$ 为有限频率的系统引入了耗散。项 $\\sigma/(i\\omega)$ 为拉伸因子 $s_x$ 和 $s_y$ 引入了耗散，这使得传播波的数值频率 $\\omega$ 变为复数，并带有负的虚部 ($\\text{Im}(\\omega)  0$)。这对应于放大因子 $|G| = \\exp(\\text{Im}(\\omega)\\Delta t)  1$，从而在 PML 内部引起所需的波衰减。决定稳定性界限的高频极限不受 $\\sigma$ 的影响。耗散不能使一个稳定的格式变得不稳定，因此从无阻尼（$\\sigma=0$ 或 $\\omega \\to \\infty$）情况推导出的稳定性极限对于完整的 C-PML 系统仍然是正确的 CFL 条件。参数 $\\kappa_x \\ge 1$ 和 $\\kappa_y \\ge 1$ 的作用是拉伸计算网格，增加了高频数值波的有效相速度，这要求更小的时间步长以保持稳定性。\n\n#### 最大允许时间步长\n从稳定性不等式中，我们求解最大允许时间步长 $\\Delta t_{\\max}$：\n$$\n\\Delta t^2 \\le \\frac{1}{c^2 \\left( \\frac{1}{(\\kappa_x \\Delta x)^2} + \\frac{1}{(\\kappa_y \\Delta y)^2} \\right)}\n$$\n$$\n\\Delta t_{\\max} = \\frac{1}{c \\sqrt{\\frac{1}{(\\kappa_x \\Delta x)^2} + \\frac{1}{(\\kappa_y \\Delta y)^2}}}\n$$\n这就是最大时间步长的最终闭式表达式。", "answer": "$$\\boxed{\\frac{1}{c \\sqrt{\\frac{1}{(\\kappa_x \\Delta x)^{2}} + \\frac{1}{(\\kappa_y \\Delta y)^{2}}}}}$$", "id": "3612714"}, {"introduction": "虽然PML在理想声学或电磁介质中表现优异，但在更复杂的现实地球物理模型（如含流体的多孔介质）中，其性能可能会变得复杂。在这些耗散系统中，PML阻尼与介质自身的物理耗散之间可能发生耦合，从而在低频段引发非物理的数值增长。本练习 [@problem_id:3612676] 将引导你对一个简化的多孔弹性PML模型进行平面波稳定性分析，以识别导致伪增长的参数范围，从而培养在复杂介质中审慎应用和验证PML的关键能力。", "problem": "考虑一个一维、均匀、各向同性的多孔弹性介质，在低频范围内，通过达西定律消除流体相对运动后，由快压缩波模式建模。固体位移场 $u(x,t)$ 的有效线性动量平衡方程为\n$$\n\\rho\\,\\frac{\\partial^{2}u}{\\partial t^{2}} + b\\,\\frac{\\partial u}{\\partial t} = K\\,\\frac{\\partial^{2}u}{\\partial x^{2}},\n$$\n其中 $\\rho$ 是有效质量密度，$b$ 是由流固相互作用产生的粘性拖曳系数（例如，由达西摩擦产生的 $b = \\eta/\\kappa$，其中 $\\eta$ 为流体粘度，$\\kappa$ 为渗透率），$K$ 是复合骨架的排水体积模量。在频域平面波稳定性分析中，假设一个角频率为 $\\omega > 0$ 的时谐平面波 $u(x,t) = U\\,\\exp(\\mathrm{i}k x - \\mathrm{i}\\omega t)$，其中 $k$ 是复波数 $k = k' + \\mathrm{i}k''$，$k' \\ge 0$ 和 $k'' \\ge 0$ 分别描述传播和衰减。\n\n为了无反射地吸收出射波，通过复坐标拉伸应用了完美匹配层 (PML)。在一个具有恒定吸收参数 $\\sigma > 0$ 的均匀PML段中，$x$ 方向的拉伸因子为\n$$\ns_x(\\omega) = 1 + \\frac{\\sigma}{\\mathrm{i}\\omega} = 1 - \\mathrm{i}\\,\\frac{\\sigma}{\\omega},\n$$\n使得平面波相位变为 $k\\,s_x(\\omega)\\,x$。如果拉伸后波数的虚部变为负值，PML内部就会出现伪增长，导致指数放大而非衰减。\n\n仅从给定的控制方程和平面波拟设出发，进行平面波稳定性分析，推导物理（非PML）介质中的色散关系以及相应的复波数 $k_0(\\omega)$。然后应用PML拉伸，得到PML内部的复波数 $k_{\\mathrm{pml}}(\\omega) = s_x(\\omega)\\,k_0(\\omega)$，并根据 $\\operatorname{Im}(k_{\\mathrm{pml}})$ 的符号表示非放大解的条件。在 $\\rho\\,\\omega \\ll b$ 的低频极限下，确定 $k'(\\omega)$ 和 $k''(\\omega)$ 的主阶行为，并由此推导出PML中衰减符号发生变化的临界PML吸收参数 $\\sigma_{\\mathrm{crit}}(\\omega)$。将 $\\sigma_{\\mathrm{crit}}(\\omega)$ 表示为单个闭式解析表达式。最终结果以 $\\mathrm{s}^{-1}$ 为单位表示。无需进行数值四舍五入。", "solution": "该问题要求确定一维多孔弹性波动方程在低频极限下的临界完美匹配层 (PML) 吸收参数 $\\sigma_{\\mathrm{crit}}(\\omega)$。分析过程应首先建立物理介质中的色散关系，然后分析PML内的波行为。\n\n固体位移场 $u(x,t)$ 的控制方程如下：\n$$\n\\rho\\,\\frac{\\partial^{2}u}{\\partial t^{2}} + b\\,\\frac{\\partial u}{\\partial t} = K\\,\\frac{\\partial^{2}u}{\\partial x^{2}}\n$$\n其中 $\\rho$、$b$ 和 $K$ 是正常数，分别代表有效质量密度、粘性拖曳系数和排水体积模量。\n\n首先，我们推导物理（非PML）介质中的色散关系。我们将平面波拟设 $u(x,t) = U\\,\\exp(\\mathrm{i}k_0 x - \\mathrm{i}\\omega t)$ 代入控制方程。这里，$k_0$ 是物理介质中的复波数，$\\omega > 0$ 是角频率。所需的导数为：\n$$\n\\frac{\\partial u}{\\partial t} = -\\mathrm{i}\\omega u\n$$\n$$\n\\frac{\\partial^{2} u}{\\partial t^{2}} = (-\\mathrm{i}\\omega)^{2} u = -\\omega^{2} u\n$$\n$$\n\\frac{\\partial^{2} u}{\\partial x^{2}} = (\\mathrm{i}k_0)^{2} u = -k_0^{2} u\n$$\n将这些导数代入控制方程，得到：\n$$\n\\rho(-\\omega^{2} u) + b(-\\mathrm{i}\\omega u) = K(-k_0^{2} u)\n$$\n假设存在非平凡解 ($u \\neq 0$)，我们可以两边同除以 $u$，得到代数色散关系：\n$$\n-\\rho\\omega^{2} - \\mathrm{i}b\\omega = -Kk_0^{2}\n$$\n求解 $k_0^2$，我们得到：\n$$\nk_0^2 = \\frac{\\rho\\omega^{2} + \\mathrm{i}b\\omega}{K}\n$$\n问题指明分析应在低频极限下进行，即 $\\rho\\omega \\ll b$。该条件意味着 $\\rho\\omega^2 \\ll b\\omega$。因此，我们可以忽略分子中的 $\\rho\\omega^2$ 项，因为它远小于 $\\mathrm{i}b\\omega$ 项。在此极限下，色散关系简化为其主阶行为：\n$$\nk_0^2 \\approx \\mathrm{i}\\frac{b\\omega}{K}\n$$\n为了找到复波数 $k_0(\\omega) = k'(\\omega) + \\mathrm{i}k''(\\omega)$，我们必须对该表达式取平方根。我们回顾虚数单位的主平方根，即 $\\sqrt{\\mathrm{i}} = \\exp(\\mathrm{i}\\pi/4) = \\frac{1+\\mathrm{i}}{\\sqrt{2}}$。选择此根可确保实部 $k'$（与传播相关）和虚部 $k''$（与衰减相关）均为非负值，这与物理惯例所要求的前向传播衰减波一致。\n$$\nk_0(\\omega) \\approx \\sqrt{\\frac{b\\omega}{K}} \\sqrt{\\mathrm{i}} = \\sqrt{\\frac{b\\omega}{K}} \\left(\\frac{1+\\mathrm{i}}{\\sqrt{2}}\\right) = \\sqrt{\\frac{b\\omega}{2K}} (1+\\mathrm{i})\n$$\n从这个表达式中，我们确定波数实部和虚部的主阶行为：\n$$\nk'(\\omega) \\approx \\sqrt{\\frac{b\\omega}{2K}}\n$$\n$$\nk''(\\omega) \\approx \\sqrt{\\frac{b\\omega}{2K}}\n$$\n接下来，我们分析PML内部的波。PML中的波数 $k_{\\mathrm{pml}}$ 是通过将物理波数 $k_0$ 乘以复拉伸因子 $s_x(\\omega)$ 得到的：\n$$\nk_{\\mathrm{pml}}(\\omega) = s_x(\\omega) k_0(\\omega)\n$$\n给定 $s_x(\\omega) = 1 - \\mathrm{i}\\frac{\\sigma}{\\omega}$ 和 $k_0(\\omega) = k'(\\omega) + \\mathrm{i}k''(\\omega)$，我们有：\n$$\nk_{\\mathrm{pml}} = \\left(1 - \\mathrm{i}\\frac{\\sigma}{\\omega}\\right) (k' + \\mathrm{i}k'') = k' + \\mathrm{i}k'' - \\mathrm{i}\\frac{\\sigma}{\\omega}k' - \\mathrm{i}^2\\frac{\\sigma}{\\omega}k'' = \\left(k' + \\frac{\\sigma}{\\omega}k''\\right) + \\mathrm{i}\\left(k'' - \\frac{\\sigma}{\\omega}k'\\right)\n$$\nPML内部的波幅根据因子 $\\exp(\\mathrm{i}k_{\\mathrm{pml}}x) = \\exp(-\\operatorname{Im}(k_{\\mathrm{pml}})x)\\exp(\\mathrm{i}\\operatorname{Re}(k_{\\mathrm{pml}})x)$ 演化。为了使波在 $x>0$ 时衰减（非放大），$k_{\\mathrm{pml}}$ 的虚部必须为非负：\n$$\n\\operatorname{Im}(k_{\\mathrm{pml}}) = k'' - \\frac{\\sigma}{\\omega}k' \\ge 0\n$$\n临界吸收参数 $\\sigma_{\\mathrm{crit}}$ 是指当衰减项为零时 $\\sigma$ 的值，即稳定性条件变为等式时：\n$$\nk'' - \\frac{\\sigma_{\\mathrm{crit}}}{\\omega}k' = 0\n$$\n求解 $\\sigma_{\\mathrm{crit}}$ 得到：\n$$\n\\sigma_{\\mathrm{crit}}(\\omega) = \\omega \\frac{k''(\\omega)}{k'(\\omega)}\n$$\n问题要求我们从先前推导的 $k'(\\omega)$ 和 $k''(\\omega)$ 的主阶行为中推断出该值。将 $k'(\\omega)$ 和 $k''(\\omega)$ 在低频极限下的表达式代入：\n$$\n\\sigma_{\\mathrm{crit}}(\\omega) \\approx \\omega \\frac{\\sqrt{\\frac{b\\omega}{2K}}}{\\sqrt{\\frac{b\\omega}{2K}}} = \\omega \\times 1\n$$\n因此，临界PML吸收参数就是角频率。\n$$\n\\sigma_{\\mathrm{crit}}(\\omega) = \\omega\n$$\n角频率 $\\omega$ 的单位是弧度/秒，其量纲等价于 $\\mathrm{s}^{-1}$，与所要求的单位相符。此结果表明，在扩散极限下，如果吸收参数 $\\sigma$ 超过波的角频率 $\\omega$，PML将变得不稳定。", "answer": "$$\\boxed{\\omega}$$", "id": "3612676"}, {"introduction": "一个稳定可靠的PML仅仅是起点，实现高性能计算的关键在于最大限度地减少其引入的虚假反射。PML的反射误差通常来源于两个方面：由于层厚度有限而从其后端边界反射回来的波（后向反射），以及由于离散化在PML入口界面处产生的数值反射（界面反射）。本练习 [@problem_id:3612708] 将问题抽象为一个极小化极大（minimax）优化问题，旨在通过调整阻尼剖面的多项式阶数，在给定的厚度和峰值阻尼下找到平衡这两种竞争误差源的最佳方案。完成这项实践将使你对高性能PML的设计艺术有更深刻的理解。", "problem": "考虑一个在速度为 $c$ 的均匀外部介质中的二维声波，该声波被一个完美匹配层 (PML) 截断。PML 占据区域 $x \\in [0,L]$，毗邻位于 $x=L$ 的截断边界；物理域位于 $x0$，PML 在 $x=0$ 处与之相连。设 PML 由多项式阻尼剖面 $\\sigma(x) = \\sigma_{\\max} \\left(\\frac{x}{L}\\right)^{m}$ 定义，适用于 $x \\in [0,L]$，其中 $m \\in \\mathbb{N}$ 是多项式次数，$\\sigma_{\\max} > 0$ 是峰值阻尼（单位为 $\\mathrm{s}^{-1}$），$L>0$ 是固定厚度（单位为 $\\mathrm{m}$）。假设一个角频率为 $\\omega$、入射角为 $\\theta \\in [0,\\theta_{\\max}]$（相对于 PML 的内法线）的平面波从 $x=0$ 进入 PML。\n\n从完美匹配层 (PML) 的频域坐标拉伸公式出发，其中 $x$-导数被替换为 $s_x^{-1}(x,\\omega)\\,\\partial_x$，且 $s_x(x,\\omega)=1+\\mathrm{i}\\,\\sigma(x)/\\omega$，并从 $x$ 方向波数为 $k_x = (\\omega/c)\\cos\\theta$ 的平面波定义出发，推导一个易于处理的模型，用于描述由两种机制引起的最坏情况下的 PML 入口反射振幅：\n- 由 $x=L$ 处的截断引起的有限厚度背向反射，以及\n- 在 $x=0$ 处由离散网格界面引起的反射，这是因为在数值格式中，PML 是在间距为 $\\Delta x$ 的网格上采样的。\n\n您的推导必须从所述的坐标拉伸和平面波表示开始，通过识别与穿过 PML 并返回相关的衰减因子，并提出一个量纲一致、对入射角敏感的离散界面反射代理模型，该模型依赖于 $\\sigma(x)$ 在 $x=\\Delta x/2$ 处的第一个内部采样点。您可以假设采用有限差分离散化，其中伪界面反射随第一个单元中局部无量纲阻尼比的增大而增长，并在法向入射时消失。\n\n使用此建模框架，定义：\n- 背向反射振幅 $R_{\\mathrm{back}}(\\theta;\\,m,L,\\sigma_{\\max},c)$，它由一条入射角为 $\\theta$ 的射线往返穿行厚度为 $L$ 的 PML 产生，表示为一个关于 $\\sigma(x)$ 的一维积分，以及\n- 界面反射振幅 $R_{\\mathrm{if}}(\\theta,\\omega;\\,m,L,\\sigma_{\\max},\\Delta x)$，它依赖于第一个单元中心的值 $\\sigma(\\Delta x/2)$、角频率 $\\omega$ 和 $\\theta$，并在 $\\theta=0$ 时为零。\n\n将总反射模型定义为 $R(\\theta,\\omega)=\\min\\{1,\\,R_{\\mathrm{back}}(\\theta)+R_{\\mathrm{if}}(\\theta,\\omega)\\}$，并针对给定的入射角和角频率离散测试集 $\\Omega$，形式化离散极小化极大设计问题，以求解使 $\\max_{(\\theta,\\omega)\\in \\Omega} R(\\theta,\\omega)$ 最小化的多项式次数 $m \\in \\{1,2,\\dots,M_{\\max}\\}$。\n\n实现一个程序，对于下述测试套件中的每组参数，搜索 $m \\in \\{1,2,\\dots,M_{\\max}\\}$ 并返回使给定离散集 $\\Omega$ 上的最大总反射最小化的整数 $m^{\\star}$，以及相应的最坏情况下的反射值。如果出现平局，选择最小的 $m$。\n\n您的程序必须采用以下与推导一致的建模选择：\n- 使用频域坐标拉伸 $s_x(x,\\omega)=1+\\mathrm{i}\\,\\sigma(x)/\\omega$ 来表明，对于入射角为 $\\theta$ 的平面波，沿 $x$ 方向的振幅衰减由 $\\int_0^L \\mathrm{Im}\\,s_x(x,\\omega)\\,\\mathrm{d}x = \\int_0^L \\sigma(x)/\\omega\\,\\mathrm{d}x$ 控制，并且相应的往返背向反射振幅可以建模为\n$$\nR_{\\mathrm{back}}(\\theta;\\,m,L,\\sigma_{\\max},c) \\;=\\; \\exp\\!\\left(-\\dfrac{2 \\cos\\theta}{c}\\int_0^L \\sigma(x)\\,\\mathrm{d}x\\right).\n$$\n- 使用依赖于角度和频率的代理模型来为离散界面反射振幅建模\n$$\nR_{\\mathrm{if}}(\\theta,\\omega;\\,m,L,\\sigma_{\\max},\\Delta x)\\;=\\;\\left(\\dfrac{\\sigma(\\Delta x/2)}{\\omega}\\right)^{2}\\,\\sin^{2}\\theta,\n$$\n该模型捕捉了界面反射随第一个内部节点处更大的无量纲局部阻尼和更大的倾斜度而增加的特性。\n- 将这些结合起来定义\n$$\nR(\\theta,\\omega)\\;=\\;\\min\\!\\left\\{\\,1,\\; R_{\\mathrm{back}}(\\theta)+R_{\\mathrm{if}}(\\theta,\\omega)\\,\\right\\}.\n$$\n\n所有物理量必须用以下单位表示：$L$ 和 $\\Delta x$ 的单位为 $\\mathrm{m}$，$c$ 的单位为 $\\mathrm{m/s}$，$\\sigma_{\\max}$ 的单位为 $\\mathrm{s}^{-1}$，$\\omega$ 的单位为 $\\mathrm{rad/s}$。角度 $\\theta$ 必须以弧度为单位指定。\n\n测试套件。对于每种情况，使用指定的离散角度和频率集 $\\Omega = \\{(\\theta,\\omega)\\}$ 搜索 $m \\in \\{1,2,\\dots,M_{\\max}\\}$：\n- 情况 A (理想情况)：\n    - $c = 2000\\,\\mathrm{m/s}$，$L=200\\,\\mathrm{m}$，$\\sigma_{\\max}=200\\,\\mathrm{s}^{-1}$，$\\Delta x=10\\,\\mathrm{m}$，$M_{\\max}=10$，\n    - $\\Theta=\\{0,\\;\\pi/6,\\;\\pi/3\\}$，\n    - $\\Omega_{\\omega}=\\{2\\pi\\cdot 5,\\;2\\pi\\cdot 20\\}\\,\\mathrm{rad/s}$。\n- 情况 B (更薄的 PML 和更精细的网格；边界偏向)：\n    - $c = 1500\\,\\mathrm{m/s}$，$L=100\\,\\mathrm{m}$，$\\sigma_{\\max}=200\\,\\mathrm{s}^{-1}$，$\\Delta x=2\\,\\mathrm{m}$，$M_{\\max}=12$，\n    - $\\Theta=\\{0,\\;\\pi/12,\\;\\pi/6\\}$，\n    - $\\Omega_{\\omega}=\\{2\\pi\\cdot 2,\\;2\\pi\\cdot 10,\\;2\\pi\\cdot 30\\}\\,\\mathrm{rad/s}$。\n- 情况 C (厚而强的 PML；斜入射角的边缘挑战)：\n    - $c = 2500\\,\\mathrm{m/s}$，$L=300\\,\\mathrm{m}$，$\\sigma_{\\max}=400\\,\\mathrm{s}^{-1}$，$\\Delta x=15\\,\\mathrm{m}$，$M_{\\max}=12$，\n    - $\\Theta=\\{0,\\;\\pi/8,\\;3\\pi/8\\}$，\n    - $\\Omega_{\\omega}=\\{2\\pi\\cdot 1,\\;2\\pi\\cdot 15\\}\\,\\mathrm{rad/s}$。\n\n要求的最终输出。您的程序应生成一行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果。对于每种情况，输出最优整数 $m^{\\star}$，后跟相应的、保留六位小数的最坏情况下的反射值。因此，最终输出的形式应为\n$[m^{\\star}_{\\mathrm{A}},R^{\\star}_{\\mathrm{A}},m^{\\star}_{\\mathrm{B}},R^{\\star}_{\\mathrm{B}},m^{\\star}_{\\mathrm{C}},R^{\\star}_{\\mathrm{C}}]$，\n其中 $R^{\\star}$ 表示在每种情况下，在指定的离散集 $\\Omega$ 上 $R(\\theta,\\omega)$ 的最小化最大值。所有角度均以弧度为单位，所有频率均以 $\\mathrm{rad/s}$ 为单位。确保程序不需要任何输入，并且只打印这一行。[@problem_id:481]", "solution": "所提出的问题要求通过在指定的入射角和频率范围内最小化最坏情况下的反射系数，来确定完美匹配层 (PML) 阻尼剖面 $\\sigma(x)$ 的最优多项式次数 $m$。总反射被建模为两个部分的和：来自层的有限厚度的背向反射和由数值离散化引起的伪界面反射。我们首先根据所提供的物理原理，对这两种反射机制的模型进行形式化。\n\nPML 由频域中的坐标拉伸定义，其中空间导数算子 $\\partial_x$ 被替换为 $s_x^{-1}(x,\\omega)\\,\\partial_x$。复数拉伸因子由 $s_x(x,\\omega)=1+\\mathrm{i}\\,\\sigma(x)/\\omega$ 给出，其中 $\\sigma(x)$ 是阻尼剖面。穿过介质的平面波具有 $\\exp(\\mathrm{i}(k_x x + k_y y))$ 形式的空间依赖性，其中 $k_x = (\\omega/c)\\cos\\theta$ 和 $k_y = (\\omega/c)\\sin\\theta$ 是入射角为 $\\theta$ 时的波数分量。\n\n在 PML 内部，$x$ 方向的有效波数被修改。与 $x$ 方向相关的传播项 $\\mathrm{i}k_x x$ 被转换为 $\\mathrm{i}k_x \\int_0^x s_x(\\xi,\\omega)\\,\\mathrm{d}\\xi$。代入 $s_x(\\xi,\\omega)$ 的表达式，我们得到：\n$$\n\\mathrm{i} k_x \\int_0^x \\left(1 + \\frac{\\mathrm{i}\\sigma(\\xi)}{\\omega}\\right) \\mathrm{d}\\xi = \\mathrm{i} k_x \\int_0^x \\mathrm{d}\\xi - \\frac{k_x}{\\omega} \\int_0^x \\sigma(\\xi)\\,\\mathrm{d}\\xi = \\mathrm{i} k_x x - \\frac{k_x}{\\omega} \\int_0^x \\sigma(\\xi)\\,\\mathrm{d}\\xi\n$$\n代入 $k_x = (\\omega/c)\\cos\\theta$，第二项变为 $-\\frac{\\cos\\theta}{c}\\int_0^x \\sigma(\\xi)\\,\\mathrm{d}\\xi$。该项是纯实数且为负，表示波在传播到 PML 中时振幅的指数衰减。因此，波穿过距离为 $L$ 的 PML 后的振幅被因子 $A$ 衰减，该因子由下式给出：\n$$\nA = \\exp\\left(-\\frac{\\cos\\theta}{c}\\int_0^L \\sigma(x)\\,\\mathrm{d}x\\right)\n$$\n\n第一种反射机制 $R_{\\mathrm{back}}$ 源于波在截断边界 $x=L$ 处的反射及其随后传播回界面 $x=0$ 的过程。波两次（一次向前，一次向后）穿过 PML 厚度 $L$，因此每次通过时都会被因子 $A$ 衰减。总振幅减小量，即定义了背向反射系数，因此为 $A^2$。\n$$\nR_{\\mathrm{back}}(\\theta; m, L, \\sigma_{\\max}, c) = A^2 = \\exp\\left(-\\frac{2\\cos\\theta}{c}\\int_0^L \\sigma(x)\\,\\mathrm{d}x\\right)\n$$\n阻尼剖面被指定为 $\\sigma(x) = \\sigma_{\\max} (x/L)^m$。我们可以解析地计算该积分：\n$$\n\\int_0^L \\sigma(x)\\,\\mathrm{d}x = \\int_0^L \\sigma_{\\max}\\left(\\frac{x}{L}\\right)^m \\mathrm{d}x = \\frac{\\sigma_{\\max}}{L^m} \\left[\\frac{x^{m+1}}{m+1}\\right]_0^L = \\frac{\\sigma_{\\max}L^{m+1}}{L^m(m+1)} = \\frac{\\sigma_{\\max}L}{m+1}\n$$\n将此结果代入 $R_{\\mathrm{back}}$ 的表达式中，得到最终模型：\n$$\nR_{\\mathrm{back}}(\\theta; m) = \\exp\\left(-\\frac{2\\sigma_{\\max}L\\cos\\theta}{c(m+1)}\\right)\n$$\n此表达式与频率 $\\omega$ 无关。\n\n第二种反射机制 $R_{\\mathrm{if}}$ 是一种源于界面 $x=0$ 处离散过渡的数值伪影。问题为这种反射提供了一个基于物理动机的代理模型：\n$$\nR_{\\mathrm{if}}(\\theta,\\omega; m, L, \\sigma_{\\max}, \\Delta x) = \\left(\\frac{\\sigma(\\Delta x/2)}{\\omega}\\right)^2 \\sin^2\\theta\n$$\n该模型假定界面反射与在第一个网格单元中心 $x=\\Delta x/2$ 处评估的无量纲阻尼参数 $\\sigma/\\omega$ 的平方成正比。$\\sin^2\\theta$ 项正确地强制使此伪反射在法向入射 ($\\theta=0$) 时消失，并随倾斜度的增加而增加。我们使用给定的剖面来评估 $\\sigma(\\Delta x/2)$：\n$$\n\\sigma(\\Delta x/2) = \\sigma_{\\max}\\left(\\frac{\\Delta x/2}{L}\\right)^m = \\sigma_{\\max}\\left(\\frac{\\Delta x}{2L}\\right)^m\n$$\n因此，界面反射模型为：\n$$\nR_{\\mathrm{if}}(\\theta,\\omega; m) = \\left(\\frac{\\sigma_{\\max}}{\\omega}\\left(\\frac{\\Delta x}{2L}\\right)^m\\right)^2 \\sin^2\\theta\n$$\n\n总反射 $R$ 是这两部分贡献的总和，其最大值上限为 1：\n$$\nR(\\theta,\\omega; m) = \\min\\left\\{1, R_{\\mathrm{back}}(\\theta; m) + R_{\\mathrm{if}}(\\theta,\\omega; m)\\right\\}\n$$\n优化问题是找到整数多项式次数 $m^{\\star} \\in \\{1, 2, \\dots, M_{\\max}\\}$，使得在离散测试集 $\\Omega = \\{(\\theta_i, \\omega_j)\\}$ 上的最大反射最小化。这是一个离散极小化极大问题：\n$$\nm^{\\star} = \\arg\\min_{m \\in \\{1, \\dots, M_{\\max}\\}} \\left( \\max_{(\\theta, \\omega) \\in \\Omega} R(\\theta, \\omega; m) \\right)\n$$\n相应的最小最坏情况反射为 $R^{\\star}$。增加 $m$ 会将阻尼集中在 $x=L$ 附近。这会减小 $\\int\\sigma(x)\\mathrm{d}x$（与 $1/(m+1)$ 成正比），从而增加 $R_{\\mathrm{back}}$。然而，它也极大地减小了 $\\sigma(\\Delta x/2)$（与 $(\\Delta x/2L)^m$ 成正比），从而减少了 $R_{\\mathrm{if}}$。最优的 $m^{\\star}$ 代表了在给定的参数和测试条件下，这两种相互竞争的效应之间的最佳权衡。\n\n解决此问题的算法如下：对于每个测试用例，我们遍历从 1 到 $M_{\\max}$ 的每个可能的整数值 $m$。对于每个 $m$，我们为指定的离散集 $\\Omega$ 中的所有 $(\\theta, \\omega)$ 对计算 $R(\\theta, \\omega; m)$，并找到最大值 $R_{\\max}(m)$。然后，我们找到产生最小 $R_{\\max}(m)$ 的 $m$ 值，我们将其表示为 $m^{\\star}$。如果出现平局，则选择最小的 $m$。对所提供的三个测试用例中的每一个都执行此过程。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the PML optimization problem for the given test cases.\n    \"\"\"\n    test_cases = [\n        {\n            'name': 'A',\n            'c': 2000.0,\n            'L': 200.0,\n            'sigma_max': 200.0,\n            'dx': 10.0,\n            'M_max': 10,\n            'thetas': [0.0, np.pi/6, np.pi/3],\n            'omegas': [2 * np.pi * 5.0, 2 * np.pi * 20.0]\n        },\n        {\n            'name': 'B',\n            'c': 1500.0,\n            'L': 100.0,\n            'sigma_max': 200.0,\n            'dx': 2.0,\n            'M_max': 12,\n            'thetas': [0.0, np.pi/12, np.pi/6],\n            'omegas': [2 * np.pi * 2.0, 2 * np.pi * 10.0, 2 * np.pi * 30.0]\n        },\n        {\n            'name': 'C',\n            'c': 2500.0,\n            'L': 300.0,\n            'sigma_max': 400.0,\n            'dx': 15.0,\n            'M_max': 12,\n            'thetas': [0.0, np.pi/8, 3 * np.pi/8],\n            'omegas': [2 * np.pi * 1.0, 2 * np.pi * 15.0]\n        }\n    ]\n\n    final_results = []\n\n    for case in test_cases:\n        c = case['c']\n        L = case['L']\n        sigma_max = case['sigma_max']\n        dx = case['dx']\n        M_max = case['M_max']\n        thetas = case['thetas']\n        omegas = case['omegas']\n\n        min_max_R = float('inf')\n        optimal_m = -1\n\n        # Search over polynomial degree m\n        for m in range(1, M_max + 1):\n            current_max_R = 0.0\n\n            # Evaluate over the discrete set Omega\n            for theta in thetas:\n                # Calculate R_back (independent of omega)\n                integral_sigma = sigma_max * L / (m + 1.0)\n                R_back = np.exp(-2.0 * integral_sigma * np.cos(theta) / c)\n\n                for omega in omegas:\n                    # Calculate R_if\n                    # Handle theta=0 case where sin(theta)=0 to avoid unnecessary power calculations\n                    if theta == 0.0:\n                        R_if = 0.0\n                    else:\n                        sigma_at_half_dx = sigma_max * np.power(dx / (2.0 * L), m)\n                        R_if = np.power(sigma_at_half_dx / omega, 2.0) * np.power(np.sin(theta), 2.0)\n                    \n                    # Calculate total reflection\n                    R_total = min(1.0, R_back + R_if)\n                    \n                    if R_total  current_max_R:\n                        current_max_R = R_total\n\n            # Check if this m gives a better worst-case reflection\n            if current_max_R  min_max_R:\n                min_max_R = current_max_R\n                optimal_m = m\n        \n        final_results.append(str(optimal_m))\n        final_results.append(f\"{min_max_R:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(final_results)}]\")\n\nsolve()\n```", "id": "3612708"}]}