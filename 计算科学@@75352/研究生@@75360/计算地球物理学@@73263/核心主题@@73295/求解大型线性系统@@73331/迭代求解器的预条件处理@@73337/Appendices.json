{"hands_on_practices": [{"introduction": "在地球物理学中，许多耦合场问题（例如斯托克斯流或多孔弹性力学）的有限元离散化会产生具有特定块结构的鞍点线性系统。对这些系统进行预处理是高效求解的关键。本练习 [@problem_id:3613315] 让你亲自实践如何通过对角缩放来改进一个简单的块对角预条件子，通过第一性原理分析其对预处理后算子谱半径的影响，从而加深对耦合系统预处理策略的理解。", "problem": "在计算地球物理学中，耦合场（例如，声学或流体流动中的速度和压力）的混合有限元公式会导致具有块结构的鞍点线性系统。考虑线性系统算子\n$$\nA \\;=\\;\n\\begin{pmatrix}\nK & B^{\\top} \\\\\nB & -M\n\\end{pmatrix},\n$$\n其中 $K \\in \\mathbb{R}^{n_u \\times n_u}$ 和 $M \\in \\mathbb{R}^{n_p \\times n_p}$ 分别是表示刚度和质量贡献的对称正定（SPD）矩阵，而 $B \\in \\mathbb{R}^{n_p \\times n_u}$ 是离散耦合算子。块对角预条件子定义为\n$$\nP \\;=\\;\n\\begin{pmatrix}\nK & 0 \\\\\n0 & M\n\\end{pmatrix}.\n$$\n为了改善迭代求解器中各块之间的平衡，一种常用策略是应用块对角矩阵 $S = \\mathrm{diag}(D_u, D_p)$ 进行合同对角缩放，得到归一化算子\n$$\nA_{\\mathrm{n}} \\;=\\; S A S \\;=\\;\n\\begin{pmatrix}\nD_u K D_u & D_u B^{\\top} D_p \\\\\nD_p B D_u & -D_p M D_p\n\\end{pmatrix}.\n$$\n给定一个 $2 \\times 2$ 的对角块情况\n$$\nK \\;=\\; \\begin{pmatrix}\n9.0 \\times 10^{8} & 0 \\\\\n0 & 2.25 \\times 10^{9}\n\\end{pmatrix}, \\qquad\nM \\;=\\; \\begin{pmatrix}\n1.0 \\times 10^{5} & 0 \\\\\n0 & 4.0 \\times 10^{5}\n\\end{pmatrix},\n$$\n和对角耦合\n$$\nB \\;=\\; \\begin{pmatrix}\n3.0 \\times 10^{6} & 0 \\\\\n0 & 6.0 \\times 10^{6}\n\\end{pmatrix}.\n$$\n从对称正定性和谱半径的定义出发，仅使用块缩放和特征值分析的基本原理，执行以下操作：\n\n1. 推导对角缩放矩阵 $D_u$ 和 $D_p$，当 $A$ 两侧都用 $S$ 进行缩放（合同缩放）时，这些矩阵将 $A_{\\mathrm{n}}$ 的对角块归一化为单位矩阵。\n2. 用 $K$、$M$、$B$、$D_u$ 和 $D_p$ 显式写出得到的归一化算子 $A_{\\mathrm{n}}$，并识别出解耦的 $2 \\times 2$ 子问题。\n3. 使用由归一化对角块（即单位矩阵）构成的块对角预条件子，计算预处理后的算子 $A_{\\mathrm{n}}$ 的谱半径 $\\rho$。\n\n将谱半径 $\\rho$ 的最终答案表示为一个实数，四舍五入到五位有效数字。不需要单位。", "solution": "该问题要求对计算地球物理学中出现的鞍点线性系统进行多步分析。分析过程包括推导缩放矩阵、构建缩放后的算子以及计算其谱半径。按照要求，该过程分为三个主要部分。\n\n### 第1部分：推导缩放矩阵 $D_u$ 和 $D_p$\n\n合同缩放 $A_{\\mathrm{n}} = S A S$（其中 $S = \\mathrm{diag}(D_u, D_p)$）的目标是将所得算子 $A_{\\mathrm{n}}$ 的对角块归一化。归一化算子由下式给出\n$$\nA_{\\mathrm{n}} \\;=\\;\n\\begin{pmatrix}\nD_u K D_u & D_u B^{\\top} D_p \\\\\nD_p B D_u & -D_p M D_p\n\\end{pmatrix}.\n$$\n归一化条件要求所得的对角块 $D_u K D_u$ 和 $D_p M D_p$ 成为单位矩阵。\n$$\nD_u K D_u = I, \\qquad D_p M D_p = I.\n$$\n给定矩阵 $K$ 和 $M$ 是对称正定（SPD）的。这确保了它们的平方根 $K^{1/2}$ 和 $M^{1/2}$ 是实的、唯一的，并且也是对称正定的。我们正在寻找对角缩放矩阵 $D_u$ 和 $D_p$。\n\n对于第一个条件 $D_u K D_u = I$，我们可以通过前后乘以 $D_u^{-1}$ 来重新排列它：$K = D_u^{-1} I D_u^{-1} = (D_u^{-1})^2$。开平方根得到 $K^{1/2} = D_u^{-1}$，这意味着 $D_u = (K^{1/2})^{-1} = K^{-1/2}$。\n同样地，对于第二个条件 $D_p M D_p = I$，我们发现 $D_p = M^{-1/2}$。\n\n给定的矩阵 $K$ 和 $M$ 是对角矩阵：\n$$\nK \\;=\\; \\begin{pmatrix}\n9.0 \\times 10^{8} & 0 \\\\\n0 & 2.25 \\times 10^{9}\n\\end{pmatrix}, \\qquad\nM \\;=\\; \\begin{pmatrix}\n1.0 \\times 10^{5} & 0 \\\\\n0 & 4.0 \\times 10^{5}\n\\end{pmatrix}.\n$$\n由于它们是对角矩阵，它们的平方根和平方根的逆也是对角矩阵，通过对每个对角元进行相应的标量运算得到。\n$K$ 的平方根是：\n$$\nK^{1/2} \\;=\\; \\begin{pmatrix}\n\\sqrt{9.0 \\times 10^{8}} & 0 \\\\\n0 & \\sqrt{2.25 \\times 10^{9}}\n\\end{pmatrix} \\;=\\; \\begin{pmatrix}\n3.0 \\times 10^{4} & 0 \\\\\n0 & 1.5 \\times 10^{4.5}\n\\end{pmatrix}.\n$$\n$M$ 的平方根是：\n$$\nM^{1/2} \\;=\\; \\begin{pmatrix}\n\\sqrt{1.0 \\times 10^{5}} & 0 \\\\\n0 & \\sqrt{4.0 \\times 10^{5}}\n\\end{pmatrix} \\;=\\; \\begin{pmatrix}\n1.0 \\times 10^{2.5} & 0 \\\\\n0 & 2.0 \\times 10^{2.5}\n\\end{pmatrix}.\n$$\n缩放矩阵 $D_u$ 和 $D_p$ 是这些矩阵的逆：\n$$\nD_u = K^{-1/2} = \\begin{pmatrix} (3.0 \\times 10^{4})^{-1} & 0 \\\\ 0 & (1.5 \\times 10^{4.5})^{-1} \\end{pmatrix},\n$$\n$$\nD_p = M^{-1/2} = \\begin{pmatrix} (1.0 \\times 10^{2.5})^{-1} & 0 \\\\ 0 & (2.0 \\times 10^{2.5})^{-1} \\end{pmatrix}.\n$$\n\n### 第2部分：归一化算子 $A_n$ 和解耦的子问题\n\n在推导出缩放矩阵后，归一化算子 $A_{\\mathrm{n}}$ 的形式为：\n$$\nA_{\\mathrm{n}} \\;=\\;\n\\begin{pmatrix}\nI & D_u B^{\\top} D_p \\\\\nD_p B D_u & -I\n\\end{pmatrix},\n$$\n其中 $I$ 是 $2 \\times 2$ 的单位矩阵。需要计算非对角块。耦合矩阵 $B$ 如下：\n$$\nB \\;=\\; \\begin{pmatrix}\n3.0 \\times 10^{6} & 0 \\\\\n0 & 6.0 \\times 10^{6}\n\\end{pmatrix}.\n$$\n由于 $B$ 是对角矩阵，所以它是对称的，即 $B^{\\top} = B$。\n让我们计算块 $\\mathcal{C} = D_p B D_u$。由于 $D_p$、$B$ 和 $D_u$ 都是对角矩阵，它们的乘积也是一个对角矩阵，并且乘法顺序无关紧要。$\\mathcal{C}$ 的元素是相应对角元素的乘积。\n$$\n\\mathcal{C}_{11} = (D_p)_{11} (B)_{11} (D_u)_{11} = (1.0 \\times 10^{2.5})^{-1} \\times (3.0 \\times 10^{6}) \\times (3.0 \\times 10^{4})^{-1} = \\frac{3.0 \\times 10^{6}}{(1.0 \\times 10^{2.5}) \\times (3.0 \\times 10^{4})} = \\frac{10^6}{10^{6.5}} = 10^{-0.5} = \\frac{1}{\\sqrt{10}}.\n$$\n$$\n\\mathcal{C}_{22} = (D_p)_{22} (B)_{22} (D_u)_{22} = (2.0 \\times 10^{2.5})^{-1} \\times (6.0 \\times 10^{6}) \\times (1.5 \\times 10^{4.5})^{-1} = \\frac{6.0 \\times 10^{6}}{(2.0 \\times 10^{2.5}) \\times (1.5 \\times 10^{4.5})} = \\frac{6.0 \\times 10^{6}}{3.0 \\times 10^{7}} = \\frac{2.0}{10} = 0.2.\n$$\n因此，非对角块是 $\\mathcal{C} = \\begin{pmatrix} 1/\\sqrt{10} & 0 \\\\ 0 & 0.2 \\end{pmatrix}$。\n另一个非对角块是 $D_u B^{\\top} D_p = D_u B D_p$。由于所有矩阵都是对角矩阵，因此 $D_u B D_p = D_p B D_u = \\mathcal{C}$。\n所以，归一化算子 $A_{\\mathrm{n}}$ 是\n$$\nA_{\\mathrm{n}} \\;=\\;\n\\begin{pmatrix}\nI & \\mathcal{C} \\\\\n\\mathcal{C} & -I\n\\end{pmatrix}\n\\;=\\;\n\\left( \\begin{array}{cc|cc}\n1 & 0 & 1/\\sqrt{10} & 0 \\\\\n0 & 1 & 0 & 0.2 \\\\\n\\hline\n1/\\sqrt{10} & 0 & -1 & 0 \\\\\n0 & 0.2 & 0 & -1\n\\end{array} \\right).\n$$\n因为块矩阵 $I$ 和 $\\mathcal{C}$ 都是对角矩阵，所以 $4 \\times 4$ 的系统矩阵 $A_n$ 解耦为两个独立的 $2 \\times 2$ 子问题。第一个子问题连接速度场和压力场的第一个分量（$u$ 和 $p$ 中的索引 $1$），第二个子问题连接第二个分量（索引 $2$）。\n通过将基排列为 $(u_1, p_1, u_2, p_2)$，矩阵变为块对角矩阵：\n$$\nP^{\\top} A_{\\mathrm{n}} P \\;=\\;\n\\left( \\begin{array}{cc|cc}\n1 & 1/\\sqrt{10} & 0 & 0 \\\\\n1/\\sqrt{10} & -1 & 0 & 0 \\\\\n\\hline\n0 & 0 & 1 & 0.2 \\\\\n0 & 0 & 0.2 & -1\n\\end{array} \\right).\n$$\n两个解耦的 $2 \\times 2$ 子问题矩阵是：\n$$\nA_1 = \\begin{pmatrix} 1 & 1/\\sqrt{10} \\\\ 1/\\sqrt{10} & -1 \\end{pmatrix}, \\qquad A_2 = \\begin{pmatrix} 1 & 0.2 \\\\ 0.2 & -1 \\end{pmatrix}.\n$$\n\n### 第3部分：预处理算子的谱半径\n\n问题要求计算“预处理后的算子 $A_n$”的谱半径。缩放系统 $A_n$ 的预条件子是通过类比原始预条件子 $P$ 并使用缩放后的对角块来构建的。原始预条件子是 $P = \\mathrm{diag}(K, M)$。缩放后的版本是 $P_n = \\mathrm{diag}(D_u K D_u, D_p M D_p)$。根据我们的构造，$D_u K D_u = I$ 且 $D_p M D_p = I$。因此，预条件子是 $P_n = \\mathrm{diag}(I, I) = I_{4 \\times 4}$，即单位矩阵。\n预处理后的算子是 $P_n^{-1} A_n = I^{-1} A_n = A_n$。因此，我们必须计算谱半径 $\\rho(A_n)$。\n\n$A_n$ 的谱是解耦的子问题矩阵 $A_1$ 和 $A_2$ 的谱的并集。让我们求解形如 $M_c = \\begin{pmatrix} 1 & c \\\\ c & -1 \\end{pmatrix}$ 的通用子问题矩阵的特征值。特征方程是 $\\det(M_c - \\lambda I) = 0$。\n$$\n\\det\\begin{pmatrix} 1-\\lambda & c \\\\ c & -1-\\lambda \\end{pmatrix} \\;=\\; (1-\\lambda)(-1-\\lambda) - c^2 \\;=\\; -(1-\\lambda^2) - c^2 \\;=\\; \\lambda^2 - 1 - c^2 \\;=\\; 0.\n$$\n这得到 $\\lambda^2 = 1 + c^2$，所以特征值为 $\\lambda = \\pm\\sqrt{1+c^2}$。\n\n对于子问题 $A_1$，我们有 $c=c_1=1/\\sqrt{10}$。特征值是：\n$$\n\\lambda_{1, \\pm} = \\pm\\sqrt{1 + (1/\\sqrt{10})^2} = \\pm\\sqrt{1 + \\frac{1}{10}} = \\pm\\sqrt{1.1}.\n$$\n对于子问题 $A_2$，我们有 $c=c_2=0.2$。特征值是：\n$$\n\\lambda_{2, \\pm} = \\pm\\sqrt{1 + (0.2)^2} = \\pm\\sqrt{1 + 0.04} = \\pm\\sqrt{1.04}.\n$$\n$A_n$ 的所有特征值的集合是 $\\{\\sqrt{1.1}, -\\sqrt{1.1}, \\sqrt{1.04}, -\\sqrt{1.04}\\}$。\n谱半径 $\\rho(A_n)$ 定义为特征值绝对值的最大值：\n$$\n\\rho(A_n) = \\max \\left( |\\sqrt{1.1}|, |-\\sqrt{1.1}|, |\\sqrt{1.04}|, |-\\sqrt{1.04}| \\right) = \\max(\\sqrt{1.1}, \\sqrt{1.04}).\n$$\n由于 $1.1 > 1.04$，因此 $\\sqrt{1.1} > \\sqrt{1.04}$。所以，谱半径是：\n$$\n\\rho = \\sqrt{1.1}.\n$$\n数值上，$\\sqrt{1.1} \\approx 1.048808848...$\n将此四舍五入到五位有效数字，得到 $1.0488$。", "answer": "$$\\boxed{1.0488}$$", "id": "3613315"}, {"introduction": "对于由对流占优的输运问题产生的一般非对称稀疏矩阵，不完全LU（ILU）分解是一种流行且强大的预条件子。然而，它的稳定性并非理所当然，分解过程中出现的“主元”过小甚至为零会导致算法失败。本练习 [@problem_id:3613319] 提供了一个具体的例子，让你诊断ILU(0)分解中的主元崩溃问题，并推导一种实用的对角移动稳定化策略，这对于理解和构建稳健的迭代求解器至关重要。", "problem": "在对非均质、弱平流介质中的稳态单相地下水流进行建模时，在一个短一维子网格上采用单元中心有限体积离散化方法，会产生一个用于压力修正的非对称、弱对角占优线性系统。考虑在自然节点排序下得到的稀疏系数矩阵 $A \\in \\mathbb{R}^{4 \\times 4}$，其元素为\n$$\nA \\;=\\;\n\\begin{pmatrix}\n1 & -0.5 & 0 & 0\\\\\n-1 & 0.5 & -0.3 & 0\\\\\n0 & -0.2 & 1 & -0.4\\\\\n0 & 0 & -0.6 & 0.9\n\\end{pmatrix}.\n$$\n此类矩阵通常使用不完全LU (ILU) 分解进行预处理，以加速Krylov子空间求解器（例如广义最小残差（GMRES）方法）的求解过程。你将检验零填充不完全分解的稳定性，并设计一种稳定化修正方法。\n\n任务：\n- 从高斯消元法的定义出发，并将所有更新限制在 $A$ 的原始稀疏模式内（即零填充），构建对自然排序下的 $A$ 的零填充不完全LU分解，记为 $\\text{ILU}(0)$。识别任何主元崩溃风险，并解释它在哪一步发生以及原因。\n- 一种常见的稳定化方法是应用对角移位，形成 $A_{\\alpha} = A + \\alpha I$（其中 $\\alpha \\ge 0$），然后计算 $A_{\\alpha}$ 的 $\\text{ILU}(0)$。设主元幅值安全阈值为 $\\tau = 0.1$。从限于稀疏模式的消元法的第一性原理出发，推导在应用于 $A_{\\alpha}$ 的 Doolittle 形式的 $\\text{ILU}(0)$ 中出现的中间主元 $u_{11}(\\alpha)$、$u_{22}(\\alpha)$、$u_{33}(\\alpha)$ 和 $u_{44}(\\alpha)$ 的显式表达式。\n- 使用这些表达式，确定最小非负对角移位 $\\alpha^{\\star}$，使得 $A_{\\alpha^{\\star}}$ 的 $\\text{ILU}(0)$ 在自然排序下存在且没有零主元，并且对于 $k \\in \\{1,2,3,4\\}$ 满足 $|u_{kk}(\\alpha^{\\star})| \\ge \\tau$。以闭合形式给出 $\\alpha^{\\star}$ 的精确值。\n- 基于图和稀疏性考虑，简要论证一种可以进一步稳定此类矩阵预处理器的重排序或改进的 $\\text{ILU}$ 策略，并解释为什么预期它能降低主元崩溃风险。\n\n答案规格：你的最终答案必须是 $\\alpha^{\\star}$ 的单个精确闭合形式值，无单位。不要提供不等式或方程。不要四舍五入；给出精确的代数形式。", "solution": "该问题要求对给定 $4 \\times 4$ 矩阵 $A$ 的零填充不完全LU分解（记为 $\\text{ILU}(0)$）进行分析。该分析包括识别主元崩溃，使用对角移位 $\\alpha$ 推导一种稳定化策略，确定满足主元阈值的最小移位 $\\alpha^{\\star}$，并提出一种替代的稳定化方法。\n\n给定的矩阵是：\n$$\nA \\;=\\;\n\\begin{pmatrix}\n1 & -0.5 & 0 & 0\\\\\n-1 & 0.5 & -0.3 & 0\\\\\n0 & -0.2 & 1 & -0.4\\\\\n0 & 0 & -0.6 & 0.9\n\\end{pmatrix}\n$$\n\n**第一部分：$A$ 的 ILU(0) 分解与主元崩溃**\n\n$\\text{ILU}(0)$ 分解寻找一个单位下三角矩阵 $L$ 和一个上三角矩阵 $U$，使得乘积 $M = LU$ 在 $A$ 的原始稀疏模式上与 $A$ 匹配。$M$ 的所有其他元素（称为填充元）都被丢弃。因子 $L$ 和 $U$ 被约束为分别具有与 $A$ 的下三角和上三角部分相同的稀疏模式。\n\n设因子为：\n$$\nL = \\begin{pmatrix} 1 & 0 & 0 & 0 \\\\ l_{21} & 1 & 0 & 0 \\\\ 0 & l_{32} & 1 & 0 \\\\ 0 & 0 & l_{43} & 1 \\end{pmatrix}, \\quad\nU = \\begin{pmatrix} u_{11} & u_{12} & 0 & 0 \\\\ 0 & u_{22} & u_{23} & 0 \\\\ 0 & 0 & u_{33} & u_{34} \\\\ 0 & 0 & 0 & u_{44} \\end{pmatrix}\n$$\n乘积 $LU$ 是：\n$$\nLU = \\begin{pmatrix}\nu_{11} & u_{12} & 0 & 0 \\\\\nl_{21}u_{11} & l_{21}u_{12} + u_{22} & u_{23} & 0 \\\\\n0 & l_{32}u_{22} & l_{32}u_{23} + u_{33} & u_{34} \\\\\n0 & 0 & l_{43}u_{33} & l_{43}u_{34} + u_{44}\n\\end{pmatrix}\n$$\n我们将 $LU$ 的元素与 $A$ 的相应非零元素依次相等。\n\n第 1 步（第 1 行）：\n$u_{11} = A_{11} = 1$\n$u_{12} = A_{12} = -0.5$\n\n第 2 步（第 2 行）：\n$l_{21}u_{11} = A_{21} \\implies l_{21}(1) = -1 \\implies l_{21} = -1$\n$l_{21}u_{12} + u_{22} = A_{22} \\implies (-1)(-0.5) + u_{22} = 0.5 \\implies 0.5 + u_{22} = 0.5 \\implies u_{22} = 0$\n\n此时，发生主元崩溃。第二个主元 $u_{22}$ 为零。$\\text{ILU}(0)$ 算法无法继续，因为下一步需要除以 $u_{22}$。具体来说，为了计算 $l_{32}$，我们需要求解 $l_{32}u_{22} = A_{32}$，即 $l_{32}(0) = -0.2$，这是一个无解的方程。因此，自然排序下 $A$ 的 $\\text{ILU}(0)$ 分解不存在。\n\n**第二部分：移位矩阵 $A_{\\alpha}$ 的主元**\n\n我们考虑移位矩阵 $A_{\\alpha} = A + \\alpha I$（其中 $\\alpha \\ge 0$）：\n$$\nA_{\\alpha} \\;=\\;\n\\begin{pmatrix}\n1+\\alpha & -0.5 & 0 & 0\\\\\n-1 & 0.5+\\alpha & -0.3 & 0\\\\\n0 & -0.2 & 1+\\alpha & -0.4\\\\\n0 & 0 & -0.6 & 0.9+\\alpha\n\\end{pmatrix}\n$$\n我们对 $A_{\\alpha}$ 进行 $\\text{ILU}(0)$ 分解。对于三对角矩阵，$\\text{ILU}(0)$ 中主元 $u_{kk}$ 的通用递推公式为：\n$u_{11} = (A_{\\alpha})_{11}$\n$u_{kk} = (A_{\\alpha})_{kk} - \\frac{(A_{\\alpha})_{k,k-1} (A_{\\alpha})_{k-1,k}}{u_{k-1,k-1}}$ for $k > 1$.\n\n对于 $k=1$：\n$u_{11}(\\alpha) = (A_{\\alpha})_{11} = 1+\\alpha$\n\n对于 $k=2$：\n$u_{22}(\\alpha) = (A_{\\alpha})_{22} - \\frac{(A_{\\alpha})_{21} (A_{\\alpha})_{12}}{u_{11}(\\alpha)} = (0.5+\\alpha) - \\frac{(-1)(-0.5)}{1+\\alpha} = 0.5+\\alpha - \\frac{0.5}{1+\\alpha}$\n$u_{22}(\\alpha) = \\frac{(0.5+\\alpha)(1+\\alpha) - 0.5}{1+\\alpha} = \\frac{0.5 + 1.5\\alpha + \\alpha^2 - 0.5}{1+\\alpha} = \\frac{\\alpha^2 + 1.5\\alpha}{1+\\alpha}$\n\n对于 $k=3$：\n$u_{33}(\\alpha) = (A_{\\alpha})_{33} - \\frac{(A_{\\alpha})_{32} (A_{\\alpha})_{23}}{u_{22}(\\alpha)} = (1+\\alpha) - \\frac{(-0.2)(-0.3)}{u_{22}(\\alpha)} = 1+\\alpha - \\frac{0.06}{u_{22}(\\alpha)}$\n代入 $u_{22}(\\alpha)$ 的表达式：\n$u_{33}(\\alpha) = 1+\\alpha - \\frac{0.06(1+\\alpha)}{\\alpha^2 + 1.5\\alpha} = (1+\\alpha) \\left( 1 - \\frac{0.06}{\\alpha(\\alpha+1.5)} \\right) = (1+\\alpha) \\frac{\\alpha^2+1.5\\alpha-0.06}{\\alpha(\\alpha+1.5)}$\n\n对于 $k=4$：\n$u_{44}(\\alpha) = (A_{\\alpha})_{44} - \\frac{(A_{\\alpha})_{43} (A_{\\alpha})_{34}}{u_{33}(\\alpha)} = (0.9+\\alpha) - \\frac{(-0.6)(-0.4)}{u_{33}(\\alpha)} = 0.9+\\alpha - \\frac{0.24}{u_{33}(\\alpha)}$\n\n**第三部分：最小对角移位 $\\alpha^{\\star}$**\n\n我们需要找到最小的 $\\alpha \\ge 0$，使得对所有 $k \\in \\{1, 2, 3, 4\\}$ 都有 $|u_{kk}(\\alpha)| \\ge \\tau = 0.1$。\n\n$u_{11}(\\alpha)$ 的条件：\n$|u_{11}(\\alpha)| = |1+\\alpha| \\ge 0.1$。由于 $\\alpha \\ge 0$，所以 $1+\\alpha \\ge 1$，因此该条件始终满足。\n\n$u_{22}(\\alpha)$ 的条件：\n$|u_{22}(\\alpha)| = |\\frac{\\alpha^2 + 1.5\\alpha}{1+\\alpha}| \\ge 0.1$。对于 $\\alpha \\ge 0$，$u_{22}(\\alpha) \\ge 0$，所以我们求解 $\\frac{\\alpha(\\alpha+1.5)}{1+\\alpha} \\ge 0.1$。\n两边乘以 $10(1+\\alpha)$（对于 $\\alpha \\ge 0$ 为正）：\n$10\\alpha(\\alpha+1.5) \\ge 1+\\alpha$\n$10\\alpha^2 + 15\\alpha \\ge 1+\\alpha$\n$10\\alpha^2 + 14\\alpha - 1 \\ge 0$\n二次方程 $10\\alpha^2 + 14\\alpha - 1 = 0$ 的根是 $\\alpha = \\frac{-14 \\pm \\sqrt{14^2 - 4(10)(-1)}}{20} = \\frac{-14 \\pm \\sqrt{196+40}}{20} = \\frac{-14 \\pm \\sqrt{236}}{20} = \\frac{-7 \\pm \\sqrt{59}}{10}$。\n由于我们要求 $\\alpha \\ge 0$，我们取正根。该二次函数开口向上，因此不等式对于 $\\alpha \\ge \\frac{-7+\\sqrt{59}}{10}$ 成立。设此值为 $\\alpha_{c2}$。\n\n$u_{33}(\\alpha)$ 的条件：\n函数 $u_{22}(\\alpha)$ 在 $\\alpha > 0$ 时是严格递增的。因此，$u_{33}(\\alpha) = 1+\\alpha - \\frac{0.06}{u_{22}(\\alpha)}$ 在 $\\alpha>0$ 时也是严格递增的。\n我们在临界值 $\\alpha_{c2}$ 处计算 $u_{33}$。在这一点上，$u_{22}(\\alpha_{c2})=0.1$。\n$u_{33}(\\alpha_{c2}) = (1+\\alpha_{c2}) - \\frac{0.06}{0.1} = 1+\\alpha_{c2} - 0.6 = 0.4+\\alpha_{c2}$。\n$u_{33}(\\alpha_{c2}) = 0.4 + \\frac{-7+\\sqrt{59}}{10} = \\frac{4-7+\\sqrt{59}}{10} = \\frac{-3+\\sqrt{59}}{10}$。\n由于 $\\sqrt{59} \\approx 7.68 > 3$，该值为正。我们需要验证 $|\\frac{-3+\\sqrt{59}}{10}| \\ge 0.1 \\implies -3+\\sqrt{59} \\ge 1 \\implies \\sqrt{59} \\ge 4 \\implies 59 \\ge 16$。这是成立的。\n由于 $u_{33}(\\alpha)$ 在 $\\alpha > 0$ 时是递增的，对于任何 $\\alpha \\ge \\alpha_{c2}$，我们有 $u_{33}(\\alpha) \\ge u_{33}(\\alpha_{c2}) > 0.1$。因此，对于所有 $\\alpha \\ge \\alpha_{c2}$，$u_{33}$ 的条件都得到满足。\n\n$u_{44}(\\alpha)$ 的条件：\n函数 $u_{33}(\\alpha)$ 在 $\\alpha \\ge \\alpha_{c2}$ 时为正且递增。因此函数 $u_{44}(\\alpha) = 0.9+\\alpha - \\frac{0.24}{u_{33}(\\alpha)}$ 在 $\\alpha \\ge \\alpha_{c2}$ 时也是严格递增的。\n我们在 $\\alpha_{c2}$ 处计算 $u_{44}$：\n$u_{44}(\\alpha_{c2}) = 0.9+\\alpha_{c2} - \\frac{0.24}{u_{33}(\\alpha_{c2})} = 0.9+\\alpha_{c2} - \\frac{0.24}{0.4+\\alpha_{c2}}$。\n代入 $\\alpha_{c2} = \\frac{-7+\\sqrt{59}}{10}$：\n$u_{44}(\\alpha_{c2}) = \\left(0.9 + \\frac{-7+\\sqrt{59}}{10}\\right) - \\frac{0.24}{\\left(0.4 + \\frac{-7+\\sqrt{59}}{10}\\right)} = \\frac{2+\\sqrt{59}}{10} - \\frac{2.4}{-3+\\sqrt{59}}$.\n通过对分母进行有理化处理：\n$u_{44}(\\alpha_{c2}) = \\frac{2+\\sqrt{59}}{10} - \\frac{2.4(-3-\\sqrt{59})}{(-3+\\sqrt{59})(-3-\\sqrt{59})} = \\frac{2+\\sqrt{59}}{10} - \\frac{2.4(-3-\\sqrt{59})}{9-59} = \\frac{2+\\sqrt{59}}{10} + \\frac{2.4(3+\\sqrt{59})}{50}$.\n$u_{44}(\\alpha_{c2}) = \\frac{5(2+\\sqrt{59}) + 2.4(3+\\sqrt{59})}{50} = \\frac{10+5\\sqrt{59} + 7.2+2.4\\sqrt{59}}{50} = \\frac{17.2 + 7.4\\sqrt{59}}{50}$.\n该值显然为正，并且远大于 $0.1$。由于 $u_{44}(\\alpha)$ 在 $\\alpha \\ge \\alpha_{c2}$ 时是递增的，因此对于所有 $\\alpha \\ge \\alpha_{c2}$，$u_{44}$ 的条件也得到满足。\n\n满足所有四个条件的 $\\alpha \\ge 0$ 值的集合是 $[\\alpha_{c2}, \\infty)$。最小的此类值为 $\\alpha_{c2}$。\n因此，最小的非负对角移位是 $\\alpha^{\\star} = \\frac{-7+\\sqrt{59}}{10}$。\n\n**第四部分：替代稳定化策略**\n\n稳定 ILU 分解的另一种策略是在分解前对矩阵应用**对称重排序**。这种重排序的目的是将大幅值的元素放到对角线上。这可以通过找到一个置换矩阵 $P$ 并对 $P^TAP$ 进行分解来实现。例如，在矩阵的图上使用最大权二分匹配算法可以找到一个使对角元素幅值乘积最大化的置换。\n\n这种策略直接解决了主元崩溃的根本原因：对角线元素相对于非对角线元素过小。通过置换矩阵使其更具对角占优性，初始主元 $u_{kk}$（与 $A_{kk}$ 相关）会更大，后续主元在消元过程中变得危险地小或为零的可能性也较小。这与对角移位形成对比，后者是修改矩阵的值而不是重排序它们。对于源于物理问题的矩阵，这类排序通常具有物理上的解释，并且在提高 ILU 预处理器的鲁棒性方面非常有效。", "answer": "$$\\boxed{\\frac{-7+\\sqrt{59}}{10}}$$", "id": "3613319"}, {"introduction": "在地球物理反演或数据同化等应用中，我们常常需要求解一系列仅有微小差异的线性系统，例如模型受到低秩扰动。每次都从头构建一个昂贵的预条件子是极大的浪费。本练习 [@problem_id:3613332] 将引导你使用Sherman-Morrison-Woodbury (SMW) 公式，推导如何为一个经过低秩更新的矩阵高效地更新其预条件子。掌握这项技术，你将能够以极小的计算代价保持预条件子的有效性，这是许多高级计算方法的核心技巧。", "problem": "考虑一个计算地球物理学中的对称正定（SPD）线性系统，该系统由变系数扩散算子的离散化产生，其中基准系统矩阵为 $A \\in \\mathbb{R}^{n \\times n}$，并且有一个右预处理器逆 $M^{-1}$ 可用，它以不低的精度近似 $A^{-1}$。一个低秩、半正定扰动模拟了 $r$ 个数据一致性约束或局部物理修正的引入，从而得到更新后的系统 $A_{\\mathrm{new}} = A + U U^{T}$，其中 $U \\in \\mathbb{R}^{n \\times r}$ 具有满列秩且 $r \\ll n$。您的目标是仅从广为接受的线性代数事实和 $M^{-1}$ 的可用性出发，为 $A_{\\mathrm{new}}$ 构建并分析一个预处理器。\n\n任务：\n- 从第一性原理出发，推导更新后的右预处理器逆 $M^{-1}_{\\mathrm{upd}}$ 的一个闭式表达式，该表达式利用 $M^{-1}$ 来近似 $(A + U U^{T})^{-1}$，且仅使用 $\\mathbb{R}^{r}$ 中的低维运算和 $M^{-1}$ 的应用。\n- 设将 $M^{-1}$ 应用于一个向量的成本为 $t_{M}$，用 $U^{T}$ 乘以一个 $\\mathbb{R}^{n}$ 中向量的成本为 $t_{U^{T}}$，用 $U$ 乘以一个 $\\mathbb{R}^{r}$ 中向量的成本为 $t_{U}$，以及求解一个具有固定的、预分解的对称正定系数矩阵的 $r \\times r$ 线性系统的成本为 $t_{r}$。使用这些符号化成本，估算当您推导中出现的 $r \\times r$ 系统被分解一次并为所有应用复用时，将 $M^{-1}_{\\mathrm{upd}}$ 应用于 $\\mathbb{R}^{n}$ 中任意向量的成本。\n- 在 $M^{-1} = A^{-1}$ 的理想化条件下，并假设 $U$ 具有满列秩，计算右预处理算子 $P = M^{-1}_{\\mathrm{upd}} (A + U U^{T})$ 的条件数（关于欧几里得范数）。\n\n请以单个行矩阵的形式提供您的最终答案，其条目按顺序为：$M^{-1}_{\\mathrm{upd}}$ 的表达式，以 $t_{M}$、$t_{U^{T}}$、$t_{U}$ 和 $t_{r}$ 表示的符号化应用成本，以及 $P$ 的条件数。无需四舍五入。将条件数表示为无单位的纯数。最终答案必须是单个闭式解析表达式或此类表达式的行矩阵。", "solution": "该问题要求为一个经低秩、半正定矩阵更新的线性系统推导并分析一个预处理器。该系统由矩阵 $A_{\\mathrm{new}} = A + U U^{T}$ 描述，其中 $A \\in \\mathbb{R}^{n \\times n}$ 是对称正定（SPD）的，$U \\in \\mathbb{R}^{n \\times r}$ 具有满列秩，且 $r \\ll n$。我们已知基准矩阵 $A$ 的一个近似逆 $M^{-1}$。\n\n### 任务 1：更新后的预处理器逆的推导\n\n第一个任务是推导一个用于更新后的右预处理器逆的闭式表达式，记为 $M^{-1}_{\\mathrm{upd}}$，该表达式近似于 $(A + U U^{T})^{-1}$。推导必须基于第一性原理，并利用可用的预处理器逆 $M^{-1}$ 和低维运算。\n\n寻找秩 $r$ 更新矩阵的逆的主要工具是 Sherman-Morrison-Woodbury (SMW) 公式。对于可逆矩阵 $B$ 和 $(I + Y^{T}B^{-1}X)$，该公式表述如下：\n$$ (B + XY^{T})^{-1} = B^{-1} - B^{-1}X(I + Y^{T}B^{-1}X)^{-1}Y^{T}B^{-1} $$\n我们希望找到 $A_{\\mathrm{new}} = A + U U^{T}$ 的逆。将 SMW 公式应用于 $B=A$、$X=U$ 和 $Y=U$，我们得到 $A_{\\mathrm{new}}$ 的逆的精确表达式：\n$$ (A + U U^{T})^{-1} = A^{-1} - A^{-1}U(I_{r} + U^{T}A^{-1}U)^{-1}U^{T}A^{-1} $$\n其中 $I_{r}$ 是 $r \\times r$ 的单位矩阵。该表达式涉及一个 $r \\times r$ 矩阵的求逆，由于 $r \\ll n$，这在计算上是高效的。\n\n问题指出我们无法直接获取 $A^{-1}$，只有一个近似 $M^{-1} \\approx A^{-1}$。构建更新后预处理器的一个标准且有效的方法是在 SMW 公式中用近似 $M^{-1}$ 替换精确逆 $A^{-1}$。这便得到了我们期望的更新后预处理器逆 $M^{-1}_{\\mathrm{upd}}$ 的表达式：\n$$ M^{-1}_{\\mathrm{upd}} = M^{-1} - M^{-1}U(I_{r} + U^{T}M^{-1}U)^{-1}U^{T}M^{-1} $$\n$M^{-1}_{\\mathrm{upd}}$ 的这个表达式仅依赖于原始预处理器逆 $M^{-1}$ 的应用以及在低维空间 $\\mathbb{R}^{r}$ 中的运算（即，构造 $r \\times r$ 矩阵 $S = I_{r} + U^{T}M^{-1}U$ 并用其求解），正如要求的那样。\n\n### 任务 2：应用预处理器的成本分析\n\n第二个任务是估算将 $M^{-1}_{\\mathrm{upd}}$ 应用于任意向量 $v \\in \\mathbb{R}^{n}$ 的计算成本。成本需要用给定的符号化成本表示：$t_{M}$（应用 $M^{-1}$）、$t_{U}$（乘以 $U$）、$t_{U^{T}}$（乘以 $U^{T}$）和 $t_{r}$（求解小的 $r \\times r$ 系统）。\n\n为了高效地计算 $x = M^{-1}_{\\mathrm{upd}}v$，我们分步进行：\n$$ x = M^{-1}v - M^{-1}U(I_{r} + U^{T}M^{-1}U)^{-1}U^{T}M^{-1}v $$\n计算过程分解如下：\n1.  计算 $w_1 = M^{-1}v$。这是一个 $\\mathbb{R}^{n}$ 中的向量。成本：$t_{M}$。\n2.  计算 $w_2 = U^{T}w_1$。这是一个 $\\mathbb{R}^{r}$ 中的向量。成本：$t_{U^{T}}$。\n3.  求解 $r \\times r$ 系统 $S w_3 = w_2$ 得到 $w_3$，其中 $S = I_{r} + U^{T}M^{-1}U$。由于 $A$ 是对称正定的，$A^{-1}$ 也是对称正定的。通常假设一个好的预处理器 $M^{-1}$ 也是对称正定的。由于 $U$ 具有满列秩，矩阵 $U^{T}M^{-1}U$ 是半正定的（通常是正定的），这使得 $S$ 是对称正定且良态的。问题指出该系统使用预分解矩阵求解，因此这一步的成本是 $t_{r}$。\n4.  计算 $w_4 = U w_3$。这是一个 $\\mathbb{R}^{n}$ 中的向量。成本：$t_{U}$。\n5.  计算 $w_5 = M^{-1}w_4$。这是对基准预处理器的另一次应用。成本：$t_{M}$。\n6.  计算最终结果 $x = w_1 - w_5$。此向量减法成本可忽略不计。\n\n将这些步骤的成本相加，将 $M^{-1}_{\\mathrm{upd}}$ 应用于一个向量的总成本为：\n$$ \\text{Cost} = t_{M} + t_{U^{T}} + t_{r} + t_{U} + t_{M} = 2t_{M} + t_{U} + t_{U^{T}} + t_{r} $$\n\n### 任务 3：条件数分析\n\n第三个任务是在 $M^{-1} = A^{-1}$ 的理想化条件下，计算右预处理算子 $P = M^{-1}_{\\mathrm{upd}} (A + U U^{T})$ 的条件数。条件数是关于欧几里得范数（$\\ell_2$-范数）的。\n\n在 $M^{-1} = A^{-1}$ 的理想假设下，我们推导出的更新后预处理器逆 $M^{-1}_{\\mathrm{upd}}$ 的表达式变为：\n$$ M^{-1}_{\\mathrm{upd}} = A^{-1} - A^{-1}U(I_{r} + U^{T}A^{-1}U)^{-1}U^{T}A^{-1} $$\n正如任务 1 中所确立的，这正是由 SMW 公式得到的更新矩阵的逆的解析表达式。因此，在这种理想化条件下，我们的预处理器逆是新系统矩阵的精确逆：\n$$ M^{-1}_{\\mathrm{upd}} = (A + U U^{T})^{-1} = A_{\\mathrm{new}}^{-1} $$\n现在我们可以计算预处理算子 $P$：\n$$ P = M^{-1}_{\\mathrm{upd}} (A + U U^{T}) = A_{\\mathrm{new}}^{-1} A_{\\mathrm{new}} = I_{n} $$\n其中 $I_n$ 是 $n \\times n$ 的单位矩阵。\n\n矩阵 $P$ 关于欧几里得范数的条件数 $\\kappa_2(P)$ 定义为其谱范数与其逆的谱范数的乘积，即 $\\kappa_2(P) = \\|P\\|_2 \\|P^{-1}\\|_2$。对于单位矩阵 $P = I_n$，其逆为 $P^{-1} = I_n$。单位矩阵的谱范数为：\n$$ \\|I_n\\|_2 = \\sup_{\\|x\\|_2=1} \\|I_n x\\|_2 = \\sup_{\\|x\\|_2=1} \\|x\\|_2 = 1 $$\n因此，条件数为：\n$$ \\kappa_2(P) = \\kappa_2(I_n) = \\|I_n\\|_2 \\|I_n^{-1}\\|_2 = 1 \\cdot 1 = 1 $$\n这个结果意味着一个完美的良态系统，这是当预处理器是算子的精确逆时的预期结果。", "answer": "$$ \\boxed{ \\begin{pmatrix} M^{-1} - M^{-1}U(I_{r} + U^{T}M^{-1}U)^{-1}U^{T}M^{-1} & 2t_{M} + t_{U} + t_{U^{T}} + t_{r} & 1 \\end{pmatrix} } $$", "id": "3613332"}]}