{"hands_on_practices": [{"introduction": "要真正理解格林函数，我们必须从其最基本的性质入手：即它代表了单个点源产生的场。第一个练习将引导您超越抽象的定义，将静态势场的控制方程与物理直觉直接联系起来。通过应用散度定理，您将证明由狄拉克 $\\delta$ 函数定义的数学奇点，正好对应于单位强度的源，这是建立重力场和静电场模型的基石。[@problem_id:3602276]", "problem": "在 $\\mathbb{R}^3$ 中的均匀、各向同性、无界介质中，静态拉普拉斯算子的自由空间格林函数 $G(\\mathbf{x};\\mathbf{x}_0)$ 由以下广义函数方程定义\n$$\n\\nabla^2 G(\\mathbf{x};\\mathbf{x}_0) = -\\delta(\\mathbf{x}-\\mathbf{x}_0),\n$$\n其中 $\\delta$ 是狄拉克δ函数，并满足当 $|\\mathbf{x}| \\to \\infty$ 时 $G(\\mathbf{x};\\mathbf{x}_0) \\to 0$ 的辐射条件。这种归一化在计算地球物理学中对位场问题的边界积分和体积分公式至关重要。\n\n令 $B_R(\\mathbf{x}_0) = \\{\\mathbf{x} \\in \\mathbb{R}^3 : |\\mathbf{x}-\\mathbf{x}_0| < R\\}$ 表示一个以 $\\mathbf{x}_0$ 为中心、半径为 $R>0$ 的球体，并令 $\\partial B_R(\\mathbf{x}_0)$ 表示其边界球面，其外单位法向量为 $\\mathbf{n}$。仅从 $G(\\mathbf{x};\\mathbf{x}_0)$ 的定义方程、狄拉克δ函数的性质以及散度定理出发，完成以下步骤：\n\n1. 对 $\\nabla^2 G(\\mathbf{x};\\mathbf{x}_0)$ 在 $B_R(\\mathbf{x}_0)$ 上积分，并利用散度定理将体积分表示为曲面通量 $\\int_{\\partial B_R(\\mathbf{x}_0)} \\nabla G(\\mathbf{x};\\mathbf{x}_0) \\cdot \\mathbf{n} \\, \\mathrm{d}S$。\n\n2. 仅使用狄拉克δ函数的定义性质精确计算该体积分，从而获得曲面通量的值。论证为何该值与 $R$ 无关。\n\n3. 为了交叉检验一致性，假设 $G(\\mathbf{x};\\mathbf{x}_0)$ 在 $\\mathbf{x}_0$ 之外是球对称的，即 $G(\\mathbf{x};\\mathbf{x}_0) = f(r)$，其中 $r = |\\mathbf{x}-\\mathbf{x}_0|$，并且满足当 $r>0$ 时 $\\nabla^2 G(\\mathbf{x};\\mathbf{x}_0) = 0$ 以及当 $r \\to \\infty$ 时 $G(\\mathbf{x};\\mathbf{x}_0) \\to 0$。推导 $f(r)$ 的一般形式，计算通过 $\\partial B_R(\\mathbf{x}_0)$ 的相应曲面通量，并确认其与第2部分中求得的值相符。\n\n将您的最终答案表示为等于曲面通量 $\\int_{\\partial B_R(\\mathbf{x}_0)} \\nabla G(\\mathbf{x};\\mathbf{x}_0) \\cdot \\mathbf{n} \\, \\mathrm{d}S$ 值的无量纲实数。无需四舍五入。", "solution": "该问题要求解 $\\mathbb{R}^3$ 中拉普拉斯算子自由空间格林函数梯度的曲面通量值。推导过程如问题陈述中所述，分为三个步骤。\n\n格林函数 $G(\\mathbf{x};\\mathbf{x}_0)$ 由以下广义函数方程定义：\n$$\n\\nabla^2 G(\\mathbf{x};\\mathbf{x}_0) = -\\delta(\\mathbf{x}-\\mathbf{x}_0)\n$$\n其中 $\\delta$ 是狄拉克δ函数。我们还被给予了无穷远处的边界条件，即当 $|\\mathbf{x}| \\to \\infty$ 时 $G(\\mathbf{x};\\mathbf{x}_0) \\to 0$。积分体积是一个以源点 $\\mathbf{x}_0$ 为中心、半径为 $R>0$ 的球体 $B_R(\\mathbf{x}_0)$，其边界是球面 $\\partial B_R(\\mathbf{x}_0)$。\n\n**第一部分：应用散度定理**\n\n我们首先对 $G(\\mathbf{x};\\mathbf{x}_0)$ 的定义方程在球体 $B_R(\\mathbf{x}_0)$ 的体积上进行积分。左侧的积分是：\n$$\n\\int_{B_R(\\mathbf{x}_0)} \\nabla^2 G(\\mathbf{x};\\mathbf{x}_0) \\, \\mathrm{d}V\n$$\n拉普拉斯算子可以写成梯度的散度，即 $\\nabla^2 G = \\nabla \\cdot (\\nabla G)$。将其代入积分，得到：\n$$\n\\int_{B_R(\\mathbf{x}_0)} \\nabla \\cdot (\\nabla G(\\mathbf{x};\\mathbf{x}_0)) \\, \\mathrm{d}V\n$$\n散度定理指出，对于定义在具有分片光滑边界 $\\partial V$ 的体积 $V$ 上的连续可微向量场 $\\mathbf{F}$，以下关系成立：\n$$\n\\int_V (\\nabla \\cdot \\mathbf{F}) \\, \\mathrm{d}V = \\oint_{\\partial V} \\mathbf{F} \\cdot \\mathbf{n} \\, \\mathrm{d}S\n$$\n其中 $\\mathbf{n}$ 是曲面 $\\partial V$ 的外单位法向量。在我们的例子中，向量场是 $\\mathbf{F} = \\nabla G$，体积是 $V = B_R(\\mathbf{x}_0)$，边界是 $\\partial V = \\partial B_R(\\mathbf{x}_0)$。请注意，虽然 $G$ 在 $\\mathbf{x}_0$ 处有一个奇点，但对于任何 $R>0$，其梯度 $\\nabla G$ 在边界 $\\partial B_R(\\mathbf{x}_0)$ 上是良态的。应用该定理可得：\n$$\n\\int_{B_R(\\mathbf{x}_0)} \\nabla^2 G(\\mathbf{x};\\mathbf{x}_0) \\, \\mathrm{d}V = \\int_{\\partial B_R(\\mathbf{x}_0)} \\nabla G(\\mathbf{x};\\mathbf{x}_0) \\cdot \\mathbf{n} \\, \\mathrm{d}S\n$$\n此方程将 $G$ 的拉普拉斯算子的体积分表示为其梯度通过包围球面的总通量。\n\n**第二部分：使用狄拉克δ函数求值**\n\n接下来，我们使用 $G$ 的定义方程的右侧直接计算体积分。\n$$\n\\int_{B_R(\\mathbf{x}_0)} \\nabla^2 G(\\mathbf{x};\\mathbf{x}_0) \\, \\mathrm{d}V = \\int_{B_R(\\mathbf{x}_0)} -\\delta(\\mathbf{x}-\\mathbf{x}_0) \\, \\mathrm{d}V = - \\int_{B_R(\\mathbf{x}_0)} \\delta(\\mathbf{x}-\\mathbf{x}_0) \\, \\mathrm{d}V\n$$\n狄拉克δ函数的基本定义性质（筛选性质）是，对于在 $\\mathbf{x}_0$ 处连续的任何函数 $f(\\mathbf{x})$，\n$$\n\\int_V f(\\mathbf{x}) \\delta(\\mathbf{x}-\\mathbf{x}_0) \\, \\mathrm{d}V = f(\\mathbf{x}_0)\n$$\n前提是点 $\\mathbf{x}_0$ 位于积分体积 $V$ 内。在我们的例子中，积分体积是以 $\\mathbf{x}_0$ 为中心的球体 $B_R(\\mathbf{x}_0)$，因此对于任何 $R>0$，奇点总是在体积内部。我们可以对常数函数 $f(\\mathbf{x}) = 1$ 使用筛选性质。这给出：\n$$\n\\int_{B_R(\\mathbf{x}_0)} \\delta(\\mathbf{x}-\\mathbf{x}_0) \\, \\mathrm{d}V = 1\n$$\n因此，体积分的值为：\n$$\n\\int_{B_R(\\mathbf{x}_0)} \\nabla^2 G(\\mathbf{x};\\mathbf{x}_0) \\, \\mathrm{d}V = -1\n$$\n将此结果与第一部分的结论相结合，我们得到曲面通量的值：\n$$\n\\int_{\\partial B_R(\\mathbf{x}_0)} \\nabla G(\\mathbf{x};\\mathbf{x}_0) \\cdot \\mathbf{n} \\, \\mathrm{d}S = -1\n$$\n这个结果是一个常数，具体为 $-1$。它与球体的半径 $R$ 无关，因为对于任何 $R>0$，球体 $B_R(\\mathbf{x}_0)$ 都包围了整个源，正如δ函数所描述的，这个源集中在单一点 $\\mathbf{x}_0$ 处。散度定理将通过闭合曲面的通量与所包围的总源强度联系起来，在本例中，该强度为常数且等于 $-1$。\n\n**第三部分：与球对称解的一致性检验**\n\n最后，我们通过假设格林函数具有球对称形式 $G(\\mathbf{x};\\mathbf{x}_0) = f(r)$（其中 $r = |\\mathbf{x}-\\mathbf{x}_0|$）来交叉检验此结果。对于 $r > 0$，点 $\\mathbf{x}$ 不等于 $\\mathbf{x}_0$，因此 $\\delta(\\mathbf{x}-\\mathbf{x}_0) = 0$。定义方程简化为拉普拉斯方程：\n$$\n\\nabla^2 G(\\mathbf{x};\\mathbf{x}_0) = 0 \\quad \\text{for } r > 0\n$$\n在以 $\\mathbf{x}_0$ 为中心的球坐标系中，仅依赖于径向距离 $r$ 的函数 $f(r)$ 的拉普拉斯算子为：\n$$\n\\nabla^2 f(r) = \\frac{1}{r^2} \\frac{\\mathrm{d}}{\\mathrm{d}r} \\left( r^2 \\frac{\\mathrm{d}f}{\\mathrm{d}r} \\right)\n$$\n对于 $r>0$ 将其设为零，得到 $\\frac{\\mathrm{d}}{\\mathrm{d}r} \\left( r^2 \\frac{\\mathrm{d}f}{\\mathrm{d}r} \\right) = 0$。对 $r$ 积分一次，得到 $r^2 \\frac{\\mathrm{d}f}{\\mathrm{d}r} = C_1$，其中 $C_1$ 是一个积分常数。整理后得到 $\\frac{\\mathrm{d}f}{\\mathrm{d}r} = \\frac{C_1}{r^2}$。再次积分得到：\n$$\nf(r) = -\\frac{C_1}{r} + C_2\n$$\n其中 $C_2$ 是第二个积分常数。辐射条件要求当 $r \\to \\infty$ 时 $G \\to 0$。应用此条件：\n$$\n\\lim_{r\\to\\infty} \\left(-\\frac{C_1}{r} + C_2\\right) = 0 + C_2 = 0\n$$\n这迫使 $C_2=0$。因此，对于 $r>0$ 满足条件的 $G$ 的一般形式是 $G(\\mathbf{x};\\mathbf{x}_0) = f(r) = -C_1/r$。\n\n现在，我们计算这种函数形式的曲面通量。球对称函数 $f(r)$ 的梯度是 $\\nabla f = \\frac{\\mathrm{d}f}{\\mathrm{d}r} \\hat{\\mathbf{r}}$，其中 $\\hat{\\mathbf{r}} = (\\mathbf{x}-\\mathbf{x}_0)/r$ 是径向单位向量。\n$$\n\\nabla G = \\frac{\\mathrm{d}}{\\mathrm{d}r}\\left(-\\frac{C_1}{r}\\right) \\hat{\\mathbf{r}} = \\frac{C_1}{r^2} \\hat{\\mathbf{r}}\n$$\n通量是在球面 $\\partial B_R(\\mathbf{x}_0)$ 上计算的，其中 $r=R$。外单位法向量是 $\\mathbf{n} = \\hat{\\mathbf{r}}$。\n$$\n\\int_{\\partial B_R(\\mathbf{x}_0)} \\nabla G \\cdot \\mathbf{n} \\, \\mathrm{d}S = \\int_{\\partial B_R(\\mathbf{x}_0)} \\left(\\frac{C_1}{r^2} \\hat{\\mathbf{r}}\\right) \\cdot \\hat{\\mathbf{r}} \\, \\mathrm{d}S\n$$\n在积分曲面上，$r=R$ 是常数，因此被积函数是 $\\frac{C_1}{R^2}$。积分变为：\n$$\n\\frac{C_1}{R^2} \\int_{\\partial B_R(\\mathbf{x}_0)} \\, \\mathrm{d}S = \\frac{C_1}{R^2} \\times (\\text{球的表面积}) = \\frac{C_1}{R^2} (4\\pi R^2) = 4\\pi C_1\n$$\n这个通量值 $4\\pi C_1$ 必须与第2部分从第一性原理推导出的值 $-1$ 相一致。令两个结果相等：\n$$\n4\\pi C_1 = -1\n$$\n这证实了两种方法之间的一致性。为了满足格林函数的定义方程，常数必须为 $C_1 = -1/(4\\pi)$。只要格林函数满足其定义的微分方程，通量确实是 $-1$，与其具体形式无关。因此，通量的值被最终确定。", "answer": "$$\\boxed{-1}$$", "id": "3602276"}, {"introduction": "在掌握了静态情况后，我们现在转而探讨格林函数如何描述随时间演化的动态系统，并以热方程为模型。这个练习要求您推导出著名的“热核”（heat kernel），它描述了一个初始热点如何在空间和时间中扩散。通过运用傅里叶变换，您不仅能找到解，还能深入理解叠加原理如何让我们为任意初始条件和热源构建解，这项技术在地球物理学的扩散过程建模中至关重要。[@problem_id:3602304]", "problem": "考虑一个 $d$ 维空间中的均匀、各向同性的无界介质，其热扩散系数 $\\kappa>0$ 为常数。温度场 $u(\\mathbf{x},t)$ 满足热传导方程\n$$\n\\partial_{t} u(\\mathbf{x},t) - \\kappa \\nabla^{2} u(\\mathbf{x},t) = f(\\mathbf{x},t), \\quad t>0,\\ \\mathbf{x}\\in\\mathbb{R}^{d},\n$$\n初始条件为 $u(\\mathbf{x},0)=u_{0}(\\mathbf{x})$。将此场问题的格林函数 $G(\\mathbf{x},t)$ 定义为具有脉冲初始条件的齐次方程的唯一解，\n$$\n\\partial_{t} G(\\mathbf{x},t) - \\kappa \\nabla^{2} G(\\mathbf{x},t) = 0,\\quad t>0,\\ \\mathbf{x}\\in\\mathbb{R}^{d},\\qquad G(\\mathbf{x},0)=\\delta(\\mathbf{x}),\n$$\n其中 $\\delta(\\mathbf{x})$ 是狄拉克 $\\delta$ 分布。从控制方程、能量守恒以及 $\\mathbb{R}^{d}$ 的平移不变性和各向同性的定义出发，推导满足以下条件的 $G(\\mathbf{x},t)$ 的闭式表达式：\n- 对所有 $t>0$ 归一化，$\\int_{\\mathbb{R}^{d}} G(\\mathbf{x},t)\\,\\mathrm{d}\\mathbf{x}=1$，\n- 时间上的半群性质，$G(\\cdot,t)\\ast G(\\cdot,s)=G(\\cdot,t+s)$ 对所有 $s,t>0$ 成立，\n- 在 $\\mathbf{x}$ 上的正性和径向对称性。\n\n然后，使用你推导出的 $G(\\mathbf{x},t)$，通过叠加原理和初始数据来论证受迫问题解的表示形式的合理性，即\n$$\nu(\\mathbf{x},t) = \\int_{\\mathbb{R}^{d}} G(\\mathbf{x}-\\mathbf{y},t)\\,u_{0}(\\mathbf{y})\\,\\mathrm{d}\\mathbf{y} + \\int_{0}^{t}\\int_{\\mathbb{R}^{d}} G(\\mathbf{x}-\\mathbf{y},t-\\tau)\\,f(\\mathbf{y},\\tau)\\,\\mathrm{d}\\mathbf{y}\\,\\mathrm{d}\\tau,\n$$\n需援引线性系统和因果性的相应基本原理，而不是借助于任何现成的公式。\n\n将你的最终答案表示为关于 $\\mathbf{x}$、$t$、$\\kappa$ 和 $d$ 的单一闭式解析表达式。使用国际单位制（SI）：$\\mathbf{x}$ 的单位是米，$t$ 的单位是秒，$\\kappa$ 的单位是平方米每秒。在最终表达式中不要包含单位。", "solution": "问题陈述经过严格验证，具有科学依据、适定性和客观性。它提出了数学物理中的一个标准问题——推导热传导方程的基本解——并且没有任何内部矛盾或歧义。\n\n我们有两个任务目标：首先，推导 $d$ 维热传导方程的格林函数 $G(\\mathbf{x},t)$；其次，论证用叠加原理构建非齐次问题解的合理性。\n\n### 第一部分：格林函数 $G(\\mathbf{x},t)$ 的推导\n\n格林函数 $G(\\mathbf{x},t)$ 定义为在无界域 $\\mathbb{R}^d$ 中，对于原点处的初始点源，齐次热传导方程的解：\n$$\n\\partial_{t} G(\\mathbf{x},t) - \\kappa \\nabla^{2} G(\\mathbf{x},t) = 0, \\quad t>0, \\ \\mathbf{x}\\in\\mathbb{R}^{d}\n$$\n初始条件为：\n$$\nG(\\mathbf{x},0) = \\delta(\\mathbf{x})\n$$\n其中 $\\delta(\\mathbf{x})$ 是 $d$ 维狄拉克 $\\delta$ 分布。\n\n求解此常系数线性偏微分方程最直接的方法是使用空间傅里叶变换。令 $\\hat{G}(\\mathbf{k},t)$ 为 $G(\\mathbf{x},t)$ 关于空间变量 $\\mathbf{x}$ 的傅里叶变换：\n$$\n\\hat{G}(\\mathbf{k},t) = \\mathcal{F}_{\\mathbf{x}}\\{G(\\mathbf{x},t)\\}(\\mathbf{k}) = \\int_{\\mathbb{R}^d} G(\\mathbf{x},t) e^{-i\\mathbf{k}\\cdot\\mathbf{x}} \\mathrm{d}\\mathbf{x}\n$$\n对该偏微分方程应用傅里叶变换，我们使用性质 $\\mathcal{F}\\{\\partial_t G\\} = \\partial_t \\hat{G}$ 和 $\\mathcal{F}\\{\\nabla^2 G\\} = -|\\mathbf{k}|^2 \\hat{G}$。该偏微分方程对每个波矢 $\\mathbf{k}$ 都转化为一个关于时间的一阶常微分方程：\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}t}\\hat{G}(\\mathbf{k},t) + \\kappa |\\mathbf{k}|^2 \\hat{G}(\\mathbf{k},t) = 0\n$$\n初始条件 $G(\\mathbf{x},0) = \\delta(\\mathbf{x})$ 也进行变换：\n$$\n\\hat{G}(\\mathbf{k},0) = \\int_{\\mathbb{R}^d} \\delta(\\mathbf{x}) e^{-i\\mathbf{k}\\cdot\\mathbf{x}} \\mathrm{d}\\mathbf{x} = 1\n$$\n满足此初始条件的常微分方程的解为：\n$$\n\\hat{G}(\\mathbf{k},t) = \\exp\\left(-\\kappa |\\mathbf{k}|^2 t\\right)\n$$\n为了求得 $G(\\mathbf{x},t)$，我们计算 $\\hat{G}(\\mathbf{k},t)$ 的傅里叶逆变换：\n$$\nG(\\mathbf{x},t) = \\mathcal{F}_{\\mathbf{k}}^{-1}\\{\\hat{G}(\\mathbf{k},t)\\}(\\mathbf{x}) = \\frac{1}{(2\\pi)^d} \\int_{\\mathbb{R}^d} \\hat{G}(\\mathbf{k},t) e^{i\\mathbf{k}\\cdot\\mathbf{x}} \\mathrm{d}\\mathbf{k} = \\frac{1}{(2\\pi)^d} \\int_{\\mathbb{R}^d} \\exp\\left(-\\kappa t |\\mathbf{k}|^2\\right) e^{i\\mathbf{k}\\cdot\\mathbf{x}} \\mathrm{d}\\mathbf{k}\n$$\n这个积分是 $\\mathbb{R}^d$ 上的一个标准高斯积分。我们可以通过分离 $\\mathbf{k}=(k_1, \\dots, k_d)$ 和 $\\mathbf{x}=(x_1, \\dots, x_d)$ 的分量来计算它：\n$$\nG(\\mathbf{x},t) = \\frac{1}{(2\\pi)^d} \\int_{\\mathbb{R}^d} \\exp\\left(-\\kappa t \\sum_{j=1}^d k_j^2\\right) \\exp\\left(i \\sum_{j=1}^d k_j x_j\\right) \\prod_{j=1}^d \\mathrm{d}k_j\n$$\n$$\nG(\\mathbf{x},t) = \\frac{1}{(2\\pi)^d} \\prod_{j=1}^d \\int_{-\\infty}^{\\infty} \\exp\\left(-\\kappa t k_j^2 + i k_j x_j\\right) \\mathrm{d}k_j\n$$\n使用一维高斯积分的标准结果 $\\int_{-\\infty}^{\\infty} e^{-az^2+ibz} \\mathrm{d}z = \\sqrt{\\frac{\\pi}{a}} e^{-b^2/(4a)}$，其中 $a = \\kappa t$ 且 $b = x_j$，我们得到：\n$$\n\\int_{-\\infty}^{\\infty} \\exp\\left(-\\kappa t k_j^2 + i k_j x_j\\right) \\mathrm{d}k_j = \\sqrt{\\frac{\\pi}{\\kappa t}} \\exp\\left(-\\frac{x_j^2}{4\\kappa t}\\right)\n$$\n将此结果代回 $G(\\mathbf{x},t)$ 的表达式中：\n$$\nG(\\mathbf{x},t) = \\frac{1}{(2\\pi)^d} \\prod_{j=1}^d \\left[ \\sqrt{\\frac{\\pi}{\\kappa t}} \\exp\\left(-\\frac{x_j^2}{4\\kappa t}\\right) \\right] = \\frac{1}{(2\\pi)^d} \\left(\\frac{\\pi}{\\kappa t}\\right)^{d/2} \\exp\\left(-\\frac{\\sum_{j=1}^d x_j^2}{4\\kappa t}\\right)\n$$\n注意到 $(2\\pi)^d = 2^d \\pi^d = (4\\pi^2)^{d/2}$ 和 $\\sum_{j=1}^d x_j^2 = |\\mathbf{x}|^2$，我们化简该表达式：\n$$\nG(\\mathbf{x},t) = \\frac{\\pi^{d/2}}{(4\\pi^2\\kappa t)^{d/2}} \\exp\\left(-\\frac{|\\mathbf{x}|^2}{4\\kappa t}\\right) = \\frac{1}{(4\\pi\\kappa t)^{d/2}} \\exp\\left(-\\frac{|\\mathbf{x}|^2}{4\\kappa t}\\right)\n$$\n这就是格林函数的闭式表达式，也称为热核。\n\n我们验证该解满足所要求的性质。\n- **正性**：对于 $t>0$ 和 $\\kappa>0$，前置因子 $(4\\pi\\kappa t)^{-d/2}$ 为正，指数函数也恒为正。因此，$G(\\mathbf{x},t) > 0$。\n- **径向对称性**：$G(\\mathbf{x},t)$ 的表达式仅依赖于 $|\\mathbf{x}|$ 的大小，而与 $\\mathbf{x}$ 的方向无关。这是介质各向同性和 $\\nabla^2$ 算子的直接结果。\n- **归一化（能量守恒）**：总“热量”必须守恒。对 $G$ 的偏微分方程在 $\\mathbb{R}^d$ 上积分表明 $\\frac{d}{dt}\\int G(\\mathbf{x},t) \\mathrm{d}\\mathbf{x} = 0$。由于 $\\int G(\\mathbf{x},0)\\mathrm{d}\\mathbf{x} = \\int \\delta(\\mathbf{x})\\mathrm{d}\\mathbf{x} = 1$，该积分对所有 $t>0$ 必须保持为 1。我们来验证一下：\n$$\n\\int_{\\mathbb{R}^d} G(\\mathbf{x},t) \\mathrm{d}\\mathbf{x} = \\int_{\\mathbb{R}^d} \\frac{1}{(4\\pi\\kappa t)^{d/2}} \\exp\\left(-\\frac{|\\mathbf{x}|^2}{4\\kappa t}\\right) \\mathrm{d}\\mathbf{x}\n$$\n使用 $d$ 维高斯积分公式 $\\int_{\\mathbb{R}^d} e^{-a|\\mathbf{x}|^2} \\mathrm{d}\\mathbf{x} = (\\pi/a)^{d/2}$，其中 $a = 1/(4\\kappa t)$：\n$$\n\\int_{\\mathbb{R}^d} G(\\mathbf{x},t) \\mathrm{d}\\mathbf{x} = \\frac{1}{(4\\pi\\kappa t)^{d/2}} \\left(\\pi \\cdot 4\\kappa t\\right)^{d/2} = 1\n$$\n归一化性质得到满足。\n- **半群性质**：$G(\\cdot,t)\\ast G(\\cdot,s)=G(\\cdot,t+s)$。在傅里叶域中，这对应于 $\\hat{G}(\\mathbf{k},t)\\hat{G}(\\mathbf{k},s)=\\hat{G}(\\mathbf{k},t+s)$。根据我们的推导，有 $\\hat{G}(\\mathbf{k},t) = \\exp(-\\kappa |\\mathbf{k}|^2 t)$。因此，$\\exp(-\\kappa |\\mathbf{k}|^2 t) \\exp(-\\kappa |\\mathbf{k}|^2 s) = \\exp(-\\kappa |\\mathbf{k}|^2 (t+s))$，即 $\\hat{G}(\\mathbf{k},t+s)$。这证实了半群性质。\n\n### 第二部分：叠加表示的合理性论证\n\n带有初始数据的受迫问题的解由下式给出：\n$$\nu(\\mathbf{x},t) = \\int_{\\mathbb{R}^{d}} G(\\mathbf{x}-\\mathbf{y},t)\\,u_{0}(\\mathbf{y})\\,\\mathrm{d}\\mathbf{y} + \\int_{0}^{t}\\int_{\\mathbb{R}^{d}} G(\\mathbf{x}-\\mathbf{y},t-\\tau)\\,f(\\mathbf{y},\\tau)\\,\\mathrm{d}\\mathbf{y}\\,\\mathrm{d}\\tau\n$$\n这个公式是热传导方程线性的直接推论。根据叠加原理，通解是给定初始数据的齐次方程解 $u_h(\\mathbf{x},t)$ 与零初始数据的非齐次方程解 $u_p(\\mathbf{x},t)$ 之和。\n\n**1. 齐次解（初值问题）：**\n令 $u_h(\\mathbf{x},t) = \\int_{\\mathbb{R}^{d}} G(\\mathbf{x}-\\mathbf{y},t)\\,u_{0}(\\mathbf{y})\\,\\mathrm{d}\\mathbf{y} = (G(\\cdot, t) \\ast u_0)(\\mathbf{x})$。\n这表示初始温度分布 $u_0(\\mathbf{x})$ 的演化。该公式依赖于将初始状态分解为连续点源：$u_0(\\mathbf{x}) = \\int_{\\mathbb{R}^d} u_0(\\mathbf{y})\\delta(\\mathbf{x}-\\mathbf{y})\\,\\mathrm{d}\\mathbf{y}$。根据线性和平移不变性，如果在 $t=0$ 时的脉冲 $\\delta(\\mathbf{x}-\\mathbf{y})$ 在时刻 $t$ 演化为 $G(\\mathbf{x}-\\mathbf{y},t)$，那么以 $u_0(\\mathbf{y})$ 为权重的这些脉冲的叠加就演化为所示的卷积积分。我们对此进行形式化验证：\n-   **偏微分方程**：$L u_h = (\\partial_t - \\kappa\\nabla^2)u_h = \\int_{\\mathbb{R}^d} L[G(\\mathbf{x}-\\mathbf{y},t)]u_0(\\mathbf{y})\\,\\mathrm{d}\\mathbf{y} = \\int_{\\mathbb{R}^d} 0 \\cdot u_0(\\mathbf{y})\\,\\mathrm{d}\\mathbf{y} = 0$，因为 $G$ 是齐次方程的解。\n-   **初始条件**：当 $t \\to 0^+$ 时，$G(\\mathbf{x},t)$ 的行为类似于狄拉克 $\\delta$ 分布 $\\delta(\\mathbf{x})$。因此，$\\lim_{t\\to 0^+} u_h(\\mathbf{x},t) = \\int_{\\mathbb{R}^d} \\delta(\\mathbf{x}-\\mathbf{y})u_0(\\mathbf{y})\\,\\mathrm{d}\\mathbf{y} = u_0(\\mathbf{x})$。\n\n**2. 特解（受迫问题）：**\n令 $u_p(\\mathbf{x},t) = \\int_{0}^{t} \\int_{\\mathbb{R}^{d}} G(\\mathbf{x}-\\mathbf{y},t-\\tau)\\,f(\\mathbf{y},\\tau)\\,\\mathrm{d}\\mathbf{y}\\,\\mathrm{d}\\tau$。\n这是 Duhamel 原理的应用，该原理将受迫线性系统的解表示为脉冲响应的叠加。源项 $f(\\mathbf{y},\\tau)$ 可被看作是空间和时间上的一系列无穷小脉冲。在位置 $\\mathbf{y}$ 和时间 $\\tau$ 发生的一个强度为 $f(\\mathbf{y},\\tau)\\,\\mathrm{d}\\mathbf{y}\\,\\mathrm{d}\\tau$ 的脉冲，在 $(\\mathbf{x},t)$ 处产生的响应由 $G(\\mathbf{x}-\\mathbf{y}, t-\\tau) f(\\mathbf{y},\\tau)\\,\\mathrm{d}\\mathbf{y}\\,\\mathrm{d}\\tau$ 给出。因果性原理规定响应只能在 $t > \\tau$ 时发生。对所有过去的时间 $\\tau \\in [0,t]$ 和所有源位置 $\\mathbf{y} \\in \\mathbb{R}^d$ 进行积分，即可得到特解 $u_p$。我们对此进行验证：\n- **偏微分方程**：令 $L = \\partial_t - \\kappa\\nabla^2$。将 $L$ 作用于 $u_p$，并对时间导数使用 Leibniz 积分法则，可得：\n$$\n\\partial_t u_p(\\mathbf{x},t) = \\int_{\\mathbb{R}^d} G(\\mathbf{x}-\\mathbf{y}, t-t) f(\\mathbf{y},t)\\,\\mathrm{d}\\mathbf{y} + \\int_0^t \\int_{\\mathbb{R}^d} \\partial_t G(\\mathbf{x}-\\mathbf{y}, t-\\tau) f(\\mathbf{y},\\tau)\\,\\mathrm{d}\\mathbf{y}\\,\\mathrm{d}\\tau\n$$\n第一项可化简为 $\\int_{\\mathbb{R}^d} \\delta(\\mathbf{x}-\\mathbf{y})f(\\mathbf{y},t)\\,\\mathrm{d}\\mathbf{y} = f(\\mathbf{x},t)$。因此，\n$$\nL u_p = f(\\mathbf{x},t) + \\int_0^t \\int_{\\mathbb{R}^d} (\\partial_t - \\kappa\\nabla^2_{\\mathbf{x}})G(\\mathbf{x}-\\mathbf{y},t-\\tau) f(\\mathbf{y},\\tau) \\,\\mathrm{d}\\mathbf{y}\\,\\mathrm{d}\\tau\n$$\n由于当时间变量为 $t-\\tau > 0$ 时，$G$ 是齐次方程的解，因此被积函数为零。所以，$L u_p = f(\\mathbf{x},t)$。\n- **初始条件**：$u_p(\\mathbf{x},0) = \\int_0^0 \\dots \\mathrm{d}\\tau = 0$。\n\n总解 $u(\\mathbf{x},t) = u_h(\\mathbf{x},t) + u_p(\\mathbf{x},t)$ 正确地满足 $L u = f$ 和 $u(\\mathbf{x},0)=u_0(\\mathbf{x})$，从而基于线性、因果性和平移不变性证明了该表示的合理性。", "answer": "$$\n\\boxed{\\frac{1}{(4\\pi\\kappa t)^{d/2}} \\exp\\left(-\\frac{|\\mathbf{x}|^2}{4\\kappa t}\\right)}\n$$", "id": "3602304"}, {"introduction": "我们的最后一个练习将从解析推导过渡到计算实践，解决一个在地球物理学中常见但理想对称性被打破的情景。您将研究一个包含平流或流动项的系统，这使得控制算子非自伴，并打破了互易性原理。通过亲手进行数值实现，您不仅将构建离散的格林函数，还将量化互易性的失效程度，这对于解释来自活动地球过程的数据以及地震干涉法等先进技术而言，是一个关键概念。[@problem_id:3602355]", "problem": "考虑一个占据区间 $(0,L_x)$ 的移动介质中的一维标量场，该场在频域中由一个作用于场 $u(x)$ 的线性微分算子 $L$ 控制，并带有齐次狄利克雷边界条件。算子 $L$ 定义为 $L u = -\\partial_x^2 u + \\beta \\,\\partial_x u - k^2 u$，其中 $\\beta$ 是常数平流参数，而 $k$ 是一个正实数，类似波数的参数。格林函数 $G(x,x')$ 由 $L G(\\cdot,x') = \\delta(\\cdot-x')$ 以及 $G(0,x') = 0$ 和 $G(L_x,x') = 0$ 定义。在具有上述边界条件的标准 $L^2$ 内积 $\\langle f,g \\rangle = \\int_0^{L_x} f(x)\\,g(x)\\,dx$ 中，自伴性要求对于所有足够光滑的 $u,v$，都有 $\\langle u, L v \\rangle = \\langle L u, v \\rangle$。除非 $\\beta=0$，否则 $\\beta\\,\\partial_x$ 项的存在使得 $L$ 非自伴。非自伴性可能导致 $G(x,x')$ 的对称性和互易性被破坏，这意味着通常情况下 $G(x,x') \\neq G(x',x)$。\n\n你的任务是计算在齐次狄利克雷边界条件下，算子 $L$ 在 $(0,L_x)$ 上的数值格林函数，评估离散格林函数矩阵的对称性和互易性，并量化当 $L$ 非自伴时产生的干涉法重构偏差。在内部网格点上使用二阶中心差分离散化，并为 $N$ 个内部点组装离散算子矩阵 $L_h \\in \\mathbb{R}^{N\\times N}$，其间距为 $h = L_x/(N+1)$。通过消除边界节点来引入狄利克雷边界条件。具体来说，对于内部行索引 $i \\in \\{1,\\dots,N\\}$，$L$ 对向量 $u\\in\\mathbb{R}^N$ 的离散作用为\n$$(L_h u)_i = \\frac{-u_{i-1} + 2 u_i - u_{i+1}}{h^2} + \\beta \\,\\frac{u_{i+1} - u_{i-1}}{2h} - k^2 u_i,$$\n其中，由于齐次狄利克雷边界条件，我们理解为 $u_0=u_{N+1}=0$。相应地，当 $\\beta\\neq 0$ 时，将 $L_h$ 组装成一个具有非对称非对角项的三对角矩阵。\n\n将离散格林函数矩阵 $G_h \\in \\mathbb{R}^{N\\times N}$ 定义为 $L_h$ 的逆，因此 $L_h G_h = I_N$，其中 $I_N$ 是 $N\\times N$ 的单位矩阵。评估以下量化指标：\n\n- 对称性偏差率 $S = \\|G_h - G_h^\\top\\|_F / \\|G_h\\|_F$，其中 $\\|\\cdot\\|_F$ 是弗罗贝尼乌斯范数，$(\\cdot)^\\top$ 表示转置。\n\n- 两个接收器位置 $x_A = L_x/3$ 和 $x_B = 2 L_x/3$ 之间的互易性偏差。设 $i_A$ 和 $i_B$ 分别是与 $x_A$ 和 $x_B$ 最近的内部网格索引。定义 $R = |G_{h}[i_A,i_B] - G_{h}[i_B,i_A]| / \\max(|G_{h}[i_A,i_B]|,|G_{h}[i_B,i_A]|)$。\n\n- 在空间白、时间不相关的源激励下的干涉法重构偏差 $B$，其协方差与单位矩阵成正比。在离散设置中，系综平均的互相关矩阵与 $C = G_h G_h^\\top$ 成正比。重构的标称对称目标是 $G_{\\mathrm{sym}} = (G_h + G_h^\\top)/2$。为了量化偏差，确定使弗罗贝尼乌斯范数失配 $\\|\\gamma C - G_{\\mathrm{sym}}\\|_F$ 最小化的标量 $\\gamma$。最优标量为 $\\gamma^\\star = \\frac{\\langle C, G_{\\mathrm{sym}}\\rangle_F}{\\|C\\|_F^2}$，其中 $\\langle A,B\\rangle_F = \\mathrm{trace}(A^\\top B)$。然后定义 $B = \\|\\gamma^\\star C - G_{\\mathrm{sym}}\\|_F / \\|G_{\\mathrm{sym}}\\|_F$。\n\n实现一个程序，为每个测试用例构建 $L_h$，计算 $G_h$，评估 $S$、$R$ 和 $B$，并打印结果。程序必须使用指定的运行时环境，并按照要求的格式生成单行输出。\n\n使用以下参数元组 $(N,L_x,\\beta,k)$ 的测试套件：\n\n- 测试 1：$(50,1.0,0.0,8.0)$，一个基准自伴情况。\n\n- 测试 2：$(50,1.0,4.0,8.0)$，一个中等平流情况。\n\n- 测试 3：$(50,1.0,20.0,8.0)$，一个强平流情况。\n\n- 测试 4：$(50,1.0,-8.0,8.0)$，一个逆流情况。\n\n在此公式中，所有量都是无量纲和无单位的。对于每个测试用例，计算三元组 $(S,B,R)$ 作为实值浮点数。\n\n最终输出格式：你的程序应生成单行输出，包含一个列表的列表，每个内部列表对应一个测试用例，即三元组 $[S,B,R]$。例如，打印的行应类似于 $[[S_1,B_1,R_1],[S_2,B_2,R_2],[S_3,B_3,R_3],[S_4,B_4,R_4]]$，用数值替换符号。不应打印其他任何文本。", "solution": "用户的请求是解决一个涉及一维非自伴微分算子格林函数的计算物理问题。\n\n### **问题验证**\n\n已根据指定标准对问题陈述进行了验证，并被认定为**有效**。\n\n1.  **已知条件提取**：所有必要的物理和数学组件均已提供。这包括微分算子 $L u = -\\partial_x^2 u + \\beta \\,\\partial_x u - k^2 u$，域 $(0, L_x)$ 及齐次狄利克雷边界条件，算子 $L_h$ 的有限差分离散格式，离散格林函数矩阵 $G_h = L_h^{-1}$ 的定义，以及待计算的三个度量指标的精确数学定义：对称性偏差率 ($S$)、互易性偏差 ($R$) 和干涉法重构偏差 ($B$)。还提供了一套完整的四个测试用例的参数。\n\n2.  **验证检查**：\n    *   **科学依据**：该问题基于数学物理（波动方程、格林函数）和数值分析（有限差分法）的成熟原理。该算子是一种标准的平流-扩散-反应类型，对非自伴性和互易性的研究是波物理学和地球物理学中的一个重要课题。\n    *   **适定性**：该问题是适定的。对于给定的参数，离散算子 $L_h$ 是一个对角占优三对角矩阵，这保证了它是非奇异的，并且其逆 $G_h$ 存在且唯一。度量指标 $S$、$R$ 和 $B$ 通过明确的数学公式定义，确保了唯一的解。\n    *   **客观性**：问题以客观、正式的语言陈述，没有任何主观性或歧义。\n    *   **完整性**：问题是自包含的，提供了求解所需的所有数据和定义。\n    *   **现实性与可行性**：所选参数是无量纲的，代表了一个计算上可行且物理上相关的模型。\n    *   **结构**：问题结构逻辑清晰，引导求解者从物理模型到离散化、计算，最后通过特定度量指标进行分析。\n\n该问题是一个标准但详细的计算物理数值练习。它要求根据提供的定义实现一个数值算法。\n\n### **求解方法**\n\n对于由元组 $(N, L_x, \\beta, k)$ 定义的每个测试用例，将通过以下步骤实施解决方案：\n\n1.  **离散化设置**：计算网格间距为 $h = L_x / (N+1)$。该域有 $N$ 个内部点。\n\n2.  **算子矩阵组装**：构建 $N \\times N$ 的离散算子矩阵 $L_h$。根据提供的有限差分公式，\n    $$(L_h u)_i = \\left(-\\frac{1}{h^2} - \\frac{\\beta}{2h}\\right) u_{i-1} + \\left(\\frac{2}{h^2} - k^2\\right) u_i + \\left(-\\frac{1}{h^2} + \\frac{\\beta}{2h}\\right) u_{i+1}$$\n    $L_h$ 是一个三对角矩阵。其对角线为：\n    *   主对角线：$d_i = \\frac{2}{h^2} - k^2$\n    *   上对角线（主对角线上方）：$u_i = -\\frac{1}{h^2} + \\frac{\\beta}{2h}$\n    *   下对角线（主对角线下方）：$l_i = -\\frac{1}{h^2} - \\frac{\\beta}{2h}$\n\n    请注意，如果 $\\beta \\neq 0$，则 $u_i \\neq l_i$，这使得矩阵 $L_h$ 非对称，反映了连续算子 $L$ 的非自伴性质。\n\n3.  **格林函数计算**：通过求算子矩阵 $L_h$ 的逆来计算离散格林函数矩阵 $G_h$：\n    $$G_h = L_h^{-1}$$\n    这可以通过标准的数值线性代数库函数实现。$G_h$ 的 $(i,j)$ 元素表示由于在网格点 $x_j$ 处的狄拉克δ函数源而在网格点 $x_i$ 处产生的场。\n\n4.  **度量指标评估**：\n    *   **对称性偏差 ($S$)**：通过比较 $G_h$ 与其转置 $G_h^\\top$ 来量化与对称性的偏差。弗罗贝尼乌斯范数 $\\|A\\|_F = \\sqrt{\\sum_{i,j} |A_{ij}|^2}$ 用于测量矩阵的“大小”。\n        $$S = \\frac{\\|G_h - G_h^\\top\\|_F}{\\|G_h\\|_F}$$\n        对于自伴情况（$\\beta=0$），$L_h$ 是对称的，因此 $G_h$ 也是对称的，$S$ 应该为零（或在机器精度量级）。\n\n    *   **互易性偏差 ($R$)**：互易性意味着 $G(x, x') = G(x', x)$。我们在两个特定点 $x_A = L_x/3$ 和 $x_B = 2L_x/3$ 测试这一点。首先，我们找到相应的最近网格索引 $i_A$ 和 $i_B$。然后，我们计算 $G_{h}[i_A, i_B]$ 和 $G_{h}[i_B, i_A]$ 之间的相对差异。\n        $$i_A = \\text{round}\\left(\\frac{N+1}{3}\\right) - 1, \\quad i_B = \\text{round}\\left(\\frac{2(N+1)}{3}\\right) - 1 \\quad \\text{（0基索引）}$$\n        $$R = \\frac{|G_{h}[i_A, i_B] - G_{h}[i_B, i_A]|}{\\max(|G_{h}[i_A, i_B]|, |G_{h}[i_B, i_A]|)}$$\n        同样，对于 $\\beta=0$，$R$ 应该为零。\n\n    *   **干涉法偏差 ($B$)**：该度量量化了互相关矩阵 $C = G_h G_h^\\top$（用不相关噪声源进行干涉测量的结果）能多好地逼近对称格林函数 $G_{\\mathrm{sym}} = (G_h + G_h^\\top)/2$。我们找到最佳拟合标量 $\\gamma^\\star$ 以最小化 $\\|\\gamma C - G_{\\mathrm{sym}}\\|_F$，这是一个最小二乘问题。解是通过将 $G_{\\mathrm{sym}}$ 投影到 $C$ 上得到的，在具有弗罗贝尼乌斯内积 $\\langle A,B \\rangle_F = \\mathrm{trace}(A^\\top B) = \\sum_{i,j} A_{ij} B_{ij}$ 的矩阵空间中。\n        $$\\gamma^\\star = \\frac{\\langle C, G_{\\mathrm{sym}}\\rangle_F}{\\|C\\|_F^2}$$\n        这种最佳拟合的归一化误差就是偏差 $B$：\n        $$B = \\frac{\\|\\gamma^\\star C - G_{\\mathrm{sym}}\\|_F}{\\|G_{\\mathrm{sym}}\\|_F}$$\n        与 $S$ 和 $R$ 不同，即使在自伴情况（$\\beta=0$）下，$B$ 通常也非零，因为 $G_h^2$ 通常不与 $G_h$ 成正比。\n\n这些步骤将在一个 Python 脚本中实现，使用 `numpy` 库为每个测试用例执行必要的矩阵运算。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef calculate_metrics(N, Lx, beta, k):\n    \"\"\"\n    Constructs the discrete operator, computes the Green's function matrix,\n    and evaluates the specified metrics S, B, and R.\n\n    Args:\n        N (int): Number of interior grid points.\n        Lx (float): Length of the domain.\n        beta (float): Advection parameter.\n        k (float): Wavenumber-like parameter.\n\n    Returns:\n        list: A list containing the three computed metrics [S, B, R].\n    \"\"\"\n    # 1. Discretization Setup\n    h = Lx / (N + 1)\n\n    # 2. Operator Matrix Assembly\n    diag_main = (2.0 / h**2 - k**2) * np.ones(N)\n    diag_upper = (-1.0 / h**2 + beta / (2.0 * h)) * np.ones(N - 1)\n    diag_lower = (-1.0 / h**2 - beta / (2.0 * h)) * np.ones(N - 1)\n    \n    Lh = np.diag(diag_main) + np.diag(diag_upper, k=1) + np.diag(diag_lower, k=-1)\n    \n    # 3. Green's Function Calculation\n    Gh = np.linalg.inv(Lh)\n    \n    # 4. Metric Evaluation\n    Gh_T = Gh.T\n\n    # 4a. Symmetry deviation ratio S\n    norm_Gh = np.linalg.norm(Gh, 'fro')\n    if norm_Gh == 0:\n        S = 0.0\n    else:\n        norm_diff_S = np.linalg.norm(Gh - Gh_T, 'fro')\n        S = norm_diff_S / norm_Gh\n\n    # 4b. Reciprocity deviation R\n    idx_A = int(np.round((N + 1) / 3.0)) - 1\n    idx_B = int(np.round(2.0 * (N + 1) / 3.0)) - 1\n    \n    G_AB = Gh[idx_A, idx_B]\n    G_BA = Gh[idx_B, idx_A]\n    \n    max_abs_G = max(abs(G_AB), abs(G_BA))\n    if max_abs_G == 0:\n        R = 0.0\n    else:\n        R = abs(G_AB - G_BA) / max_abs_G\n        \n    # 4c. Interferometric retrieval bias B\n    C = Gh @ Gh_T\n    G_sym = (Gh + Gh_T) / 2.0\n    \n    # Optimal scalar gamma_star\n    inner_product_C_Gsym = np.sum(C * G_sym) # Frobenius inner product\n    norm_C_sq = np.linalg.norm(C, 'fro')**2\n    \n    if norm_C_sq == 0:\n        gamma_star = 0.0\n    else:\n        gamma_star = inner_product_C_Gsym / norm_C_sq\n        \n    norm_G_sym = np.linalg.norm(G_sym, 'fro')\n    \n    if norm_G_sym == 0:\n        B = 0.0\n    else:\n        norm_diff_B = np.linalg.norm(gamma_star * C - G_sym, 'fro')\n        B = norm_diff_B / norm_G_sym\n\n    return [S, B, R]\n\ndef solve():\n    \"\"\"\n    Main function to run all test cases and print the results in the required format.\n    \"\"\"\n    test_suite = [\n        (50, 1.0, 0.0, 8.0),   # Test 1: Self-adjoint case\n        (50, 1.0, 4.0, 8.0),   # Test 2: Moderate advection\n        (50, 1.0, 20.0, 8.0),  # Test 3: Strong advection\n        (50, 1.0, -8.0, 8.0),  # Test 4: Reverse advection\n    ]\n\n    results = []\n    for params in test_suite:\n        metrics = calculate_metrics(*params)\n        results.append(metrics)\n    \n    print(results)\n\nsolve()\n```", "id": "3602355"}]}