{"hands_on_practices": [{"introduction": "掌握通过奇异值分解（SVD）定义的广义逆是理解和解决地球物理反问题的关键第一步。这个练习旨在通过一个具体的例子，巩固摩尔-彭罗斯伪逆的基本定义。你将利用一个给定的、存在秩亏和病态问题的矩阵的SVD形式，计算其伪逆，并验证其必须满足的核心代数恒等式([@problem_id:3404364])。完成这个练习不仅能加深你对伪逆计算过程的理解，更能让你体会到这些代数性质为何是伪逆能够为我们提供最小范数最小二乘解的理论基石。", "problem": "考虑一个三维线性逆问题，其中观测值 $\\mathbf{y} \\in \\mathbb{R}^{3}$ 与状态 $\\mathbf{x} \\in \\mathbb{R}^{3}$ 通过 $\\mathbf{y} = A \\mathbf{x} + \\boldsymbol{\\varepsilon}$ 相关联，其中 $\\boldsymbol{\\varepsilon}$ 表示观测误差。为了在 Moore–Penrose 伪逆的背景下研究秩亏和病态问题，通过指定如下的正交-对角-正交分解，构造一个秩为 $2$ 且具有高度病态非零谱的显式矩阵 $A \\in \\mathbb{R}^{3 \\times 3}$。\n\n令 $U \\in \\mathbb{R}^{3 \\times 3}$ 和 $V \\in \\mathbb{R}^{3 \\times 3}$ 为正交矩阵\n$$\nU \\;=\\; \\begin{pmatrix}\n\\frac{3}{5}  0  -\\frac{4}{5} \\\\\n0  1  0 \\\\\n\\frac{4}{5}  0  \\frac{3}{5}\n\\end{pmatrix},\n\\qquad\nV \\;=\\; \\begin{pmatrix}\n\\frac{5}{13}  -\\frac{12}{13}  0 \\\\\n\\frac{12}{13}  \\frac{5}{13}  0 \\\\\n0  0  1\n\\end{pmatrix},\n$$\n并令奇异值矩阵为\n$$\n\\Sigma \\;=\\; \\operatorname{diag}\\!\\big(3,\\, 10^{-3},\\, 0\\big).\n$$\n定义 $A$ 为 $A = U \\Sigma V^{\\top}$。仅使用通过奇异值分解（SVD）得到的 Moore–Penrose 伪逆的定义，计算 $A^{\\dagger}$，并显式地验证以下两个 Moore–Penrose 恒等式\n$$\nA A^{\\dagger} A \\;=\\; A,\n\\qquad\nA^{\\dagger} A A^{\\dagger} \\;=\\; A^{\\dagger}.\n$$\n然后，计算标量\n$$\nS \\;=\\; \\|A A^{\\dagger} A - A\\|_{F}^{2} \\;+\\; \\|A^{\\dagger} A A^{\\dagger} - A^{\\dagger}\\|_{F}^{2},\n$$\n其中 $\\|\\cdot\\|_{F}$ 表示 Frobenius 范数。请给出最终答案，形式为单个实数，无需四舍五入。", "solution": "该问题陈述是有效的，因为它基于线性代数中成熟的数学理论，特别是关于奇异值分解（SVD）和 Moore-Penrose 伪逆的理论。所提供的矩阵 $U$ 和 $V$ 是可验证的正交矩阵，矩阵 $\\Sigma$ 是一个有效的奇异值对角矩阵。这个问题是适定的，提供了计算唯一解所需的所有必要信息。问题是客观的，其组成部分在逻辑上是一致的。\n\n问题通过其奇异值分解（SVD）$A = U \\Sigma V^{\\top}$ 定义了一个矩阵 $A \\in \\mathbb{R}^{3 \\times 3}$，其中 $U$ 和 $V$ 是正交矩阵，$\\Sigma$ 是奇异值对角矩阵。给定的矩阵是：\n$$\nU = \\begin{pmatrix} \\frac{3}{5}  0  -\\frac{4}{5} \\\\ 0  1  0 \\\\ \\frac{4}{5}  0  \\frac{3}{5} \\end{pmatrix}, \\quad V = \\begin{pmatrix} \\frac{5}{13}  -\\frac{12}{13}  0 \\\\ \\frac{12}{13}  \\frac{5}{13}  0 \\\\ 0  0  1 \\end{pmatrix}, \\quad \\Sigma = \\begin{pmatrix} 3  0  0 \\\\ 0  10^{-3}  0 \\\\ 0  0  0 \\end{pmatrix}.\n$$\n该问题要求完成三个任务：\n1. 使用 SVD 定义计算 Moore-Penrose 伪逆 $A^{\\dagger}$。\n2. 显式验证恒等式 $A A^{\\dagger} A = A$ 和 $A^{\\dagger} A A^{\\dagger} = A^{\\dagger}$。\n3. 计算标量 $S = \\|A A^{\\dagger} A - A\\|_{F}^{2} + \\|A^{\\dagger} A A^{\\dagger} - A^{\\dagger}\\|_{F}^{2}$。\n\n首先，我们计算 $A^{\\dagger}$。由 $A = U \\Sigma V^{\\top}$ 的 SVD 定义，Moore-Penrose 伪逆由 $A^{\\dagger} = V \\Sigma^{\\dagger} U^{\\top}$ 给出。\n矩阵 $\\Sigma^{\\dagger}$ 是通过对 $\\Sigma$ 中的非零奇异值取倒数，并保持零值不变而得到的。\n给定 $\\Sigma = \\operatorname{diag}(3, 10^{-3}, 0)$，其伪逆 $\\Sigma^{\\dagger}$ 为：\n$$\n\\Sigma^{\\dagger} = \\operatorname{diag}\\left(\\frac{1}{3}, \\frac{1}{10^{-3}}, 0\\right) = \\operatorname{diag}\\left(\\frac{1}{3}, 1000, 0\\right) = \\begin{pmatrix} \\frac{1}{3}  0  0 \\\\ 0  1000  0 \\\\ 0  0  0 \\end{pmatrix}.\n$$\n我们还需要 $U$ 的转置：\n$$\nU^{\\top} = \\begin{pmatrix} \\frac{3}{5}  0  \\frac{4}{5} \\\\ 0  1  0 \\\\ -\\frac{4}{5}  0  \\frac{3}{5} \\end{pmatrix}.\n$$\n现在我们可以计算 $A^{\\dagger} = V \\Sigma^{\\dagger} U^{\\top}$。首先，我们计算乘积 $V \\Sigma^{\\dagger}$：\n$$\nV \\Sigma^{\\dagger} = \\begin{pmatrix} \\frac{5}{13}  -\\frac{12}{13}  0 \\\\ \\frac{12}{13}  \\frac{5}{13}  0 \\\\ 0  0  1 \\end{pmatrix} \\begin{pmatrix} \\frac{1}{3}  0  0 \\\\ 0  1000  0 \\\\ 0  0  0 \\end{pmatrix} = \\begin{pmatrix} \\frac{5}{13} \\cdot \\frac{1}{3}  -\\frac{12}{13} \\cdot 1000  0 \\\\ \\frac{12}{13} \\cdot \\frac{1}{3}  \\frac{5}{13} \\cdot 1000  0 \\\\ 0  0  0 \\end{pmatrix} = \\begin{pmatrix} \\frac{5}{39}  -\\frac{12000}{13}  0 \\\\ \\frac{4}{13}  \\frac{5000}{13}  0 \\\\ 0  0  0 \\end{pmatrix}.\n$$\n接下来，我们将此结果乘以 $U^{\\top}$ 以求得 $A^{\\dagger}$：\n$$\nA^{\\dagger} = (V \\Sigma^{\\dagger}) U^{\\top} = \\begin{pmatrix} \\frac{5}{39}  -\\frac{12000}{13}  0 \\\\ \\frac{4}{13}  \\frac{5000}{13}  0 \\\\ 0  0  0 \\end{pmatrix} \\begin{pmatrix} \\frac{3}{5}  0  \\frac{4}{5} \\\\ 0  1  0 \\\\ -\\frac{4}{5}  0  \\frac{3}{5} \\end{pmatrix}.\n$$\n执行矩阵乘法：\n$$\nA^{\\dagger} = \\begin{pmatrix} \\frac{5}{39}\\frac{3}{5}  -\\frac{12000}{13}  \\frac{5}{39}\\frac{4}{5} \\\\ \\frac{4}{13}\\frac{3}{5}  \\frac{5000}{13}  \\frac{4}{13}\\frac{4}{5} \\\\ 0  0  0 \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{13}  -\\frac{12000}{13}  \\frac{4}{39} \\\\ \\frac{12}{65}  \\frac{5000}{13}  \\frac{16}{65} \\\\ 0  0  0 \\end{pmatrix}.\n$$\n这就是 $A^{\\dagger}$ 的显式形式。\n\n第二，我们验证两个 Moore-Penrose 恒等式。最直接的方法是使用 SVD 定义，这与问题的框架是一致的。\n验证 $A A^{\\dagger} A = A$：\n代入 $A$ 和 $A^{\\dagger}$ 的 SVD 表达式：\n$$\nA A^{\\dagger} A = (U \\Sigma V^{\\top}) (V \\Sigma^{\\dagger} U^{\\top}) (U \\Sigma V^{\\top}).\n$$\n由于 $V$ 是正交矩阵，因此 $V^{\\top}V = I$，其中 $I$ 是单位矩阵。同样，$U^{\\top}U = I$。\n$$\nA A^{\\dagger} A = U \\Sigma (V^{\\top}V) \\Sigma^{\\dagger} (U^{\\top}U) \\Sigma V^{\\top} = U \\Sigma I \\Sigma^{\\dagger} I \\Sigma V^{\\top} = U (\\Sigma \\Sigma^{\\dagger} \\Sigma) V^{\\top}.\n$$\n我们来计算乘积 $\\Sigma \\Sigma^{\\dagger} \\Sigma$：\n$$\n\\Sigma \\Sigma^{\\dagger} = \\begin{pmatrix} 3  0  0 \\\\ 0  10^{-3}  0 \\\\ 0  0  0 \\end{pmatrix} \\begin{pmatrix} \\frac{1}{3}  0  0 \\\\ 0  1000  0 \\\\ 0  0  0 \\end{pmatrix} = \\begin{pmatrix} 1  0  0 \\\\ 0  1  0 \\\\ 0  0  0 \\end{pmatrix}.\n$$\n然后，\n$$\n(\\Sigma \\Sigma^{\\dagger}) \\Sigma = \\begin{pmatrix} 1  0  0 \\\\ 0  1  0 \\\\ 0  0  0 \\end{pmatrix} \\begin{pmatrix} 3  0  0 \\\\ 0  10^{-3}  0 \\\\ 0  0  0 \\end{pmatrix} = \\begin{pmatrix} 3  0  0 \\\\ 0  10^{-3}  0 \\\\ 0  0  0 \\end{pmatrix} = \\Sigma.\n$$\n因此，我们有 $A A^{\\dagger} A = U \\Sigma V^{\\top} = A$。第一个恒等式得到验证。\n\n验证 $A^{\\dagger} A A^{\\dagger} = A^{\\dagger}$：\n再次代入 SVD 表达式：\n$$\nA^{\\dagger} A A^{\\dagger} = (V \\Sigma^{\\dagger} U^{\\top}) (U \\Sigma V^{\\top}) (V \\Sigma^{\\dagger} U^{\\top}).\n$$\n使用 $U^{\\top}U = I$ 和 $V^{\\top}V = I$：\n$$\nA^{\\dagger} A A^{\\dagger} = V \\Sigma^{\\dagger} (U^{\\top}U) \\Sigma (V^{\\top}V) \\Sigma^{\\dagger} U^{\\top} = V \\Sigma^{\\dagger} I \\Sigma I \\Sigma^{\\dagger} U^{\\top} = V (\\Sigma^{\\dagger} \\Sigma \\Sigma^{\\dagger}) U^{\\top}.\n$$\n我们来计算乘积 $\\Sigma^{\\dagger} \\Sigma \\Sigma^{\\dagger}$：\n$$\n\\Sigma^{\\dagger} \\Sigma = \\begin{pmatrix} \\frac{1}{3}  0  0 \\\\ 0  1000  0 \\\\ 0  0  0 \\end{pmatrix} \\begin{pmatrix} 3  0  0 \\\\ 0  10^{-3}  0 \\\\ 0  0  0 \\end{pmatrix} = \\begin{pmatrix} 1  0  0 \\\\ 0  1  0 \\\\ 0  0  0 \\end{pmatrix}.\n$$\n然后，\n$$\n(\\Sigma^{\\dagger} \\Sigma) \\Sigma^{\\dagger} = \\begin{pmatrix} 1  0  0 \\\\ 0  1  0 \\\\ 0  0  0 \\end{pmatrix} \\begin{pmatrix} \\frac{1}{3}  0  0 \\\\ 0  1000  0 \\\\ 0  0  0 \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{3}  0  0 \\\\ 0  1000  0 \\\\ 0  0  0 \\end{pmatrix} = \\Sigma^{\\dagger}.\n$$\n因此，我们有 $A^{\\dagger} A A^{\\dagger} = V \\Sigma^{\\dagger} U^{\\top} = A^{\\dagger}$。第二个恒等式得到验证。\n\n第三，我们计算标量 $S = \\|A A^{\\dagger} A - A\\|_{F}^{2} + \\|A^{\\dagger} A A^{\\dagger} - A^{\\dagger}\\|_{F}^{2}$。\n根据我们的显式验证，我们已经确定：\n$$\nA A^{\\dagger} A - A = \\mathbf{0},\n$$\n其中 $\\mathbf{0}$ 是 $3 \\times 3$ 的零矩阵。\n并且，\n$$\nA^{\\dagger} A A^{\\dagger} - A^{\\dagger} = \\mathbf{0}.\n$$\n矩阵 $M$ 的 Frobenius 范数，记为 $\\|M\\|_{F}$，是其所有元素平方和的平方根。零矩阵的 Frobenius 范数为 $0$。\n因此，\n$$\n\\|A A^{\\dagger} A - A\\|_{F}^{2} = \\|\\mathbf{0}\\|_{F}^{2} = 0^{2} = 0.\n$$\n$$\n\\|A^{\\dagger} A A^{\\dagger} - A^{\\dagger}\\|_{F}^{2} = \\|\\mathbf{0}\\|_{F}^{2} = 0^{2} = 0.\n$$\n将这些结果代入 $S$ 的表达式中：\n$$\nS = 0 + 0 = 0.\n$$\n标量 $S$ 的值为 $0$。这个结果是 Moore-Penrose 伪逆根据定义必须满足这两个 Penrose 条件这一事实的直接推论。矩阵 $A$ 的病态性质和具体结构是背景信息，但它们并不改变这一基本的代数性质。", "answer": "$$\\boxed{0}$$", "id": "3404364"}, {"introduction": "在掌握了广义逆的数学定义后，下一步是运用它来洞察地球物理问题。这个实践练习将SVD从一个纯粹的计算工具转变为一个强大的分析工具，让你能够从数学结构中解读出物理意义。通过分析一个简化的地震折射实验的灵敏度矩阵$G$，你将学习如何通过奇异值的大小和奇异向量的方向，来判断不同物理参数（如地层慢度和界面深度）的可分辨度([@problem_id:3616825])。这个练习完美地展示了线性反演理论的核心思想：数据的灵敏度如何决定我们对模型参数的认知能力。", "problem": "考虑一个线性化的地震折射实验，该实验具有一个位于半空间上方的单一折射界面。设模型扰动向量为 $\\delta \\mathbf{m} = [\\delta s_1,\\ \\delta s_2,\\ \\delta z]^\\top$，其中 $\\delta s_1$ 和 $\\delta s_2$ 分别是上层和折射层的慢度（秒/米）扰动，$\\delta z$ 是界面深度（米）的扰动。对于大范围的炮检距 $x_k$（首波机制），走时扰动 $\\delta t_k$ 可以通过围绕一个已知参考模型的一阶线性化来近似，表示为\n$$\n\\delta \\mathbf{d} \\approx G \\, \\delta \\mathbf{m},\n$$\n其中 $G \\in \\mathbb{R}^{N \\times 3}$ 包含了偏导数 $\\partial t_k / \\partial m_j$。在一个合成测试中，有 $N=5$ 个炮检距 $x_k \\in \\{500,\\ 1000,\\ 1500,\\ 2000,\\ 2500\\}$ 米。假设灵敏度主要由走时曲线的斜率（即折射层慢度）决定，而对由深度和上层慢度决定的截距时间敏感度较弱。取\n$$\nG = \\begin{bmatrix}\na  x_1  b \\\\\na  x_2  b \\\\\na  x_3  b \\\\\na  x_4  b \\\\\na  x_5  b\n\\end{bmatrix},\n$$\n其中 $a = 0.02$ 秒，$b = 0.01$ 秒，以及如上给出的 $x_k$。假设数据由一个真实扰动 $\\delta \\mathbf{m}_{\\text{true}} = [0,\\ \\delta s_2^{\\star},\\ 0]^\\top$ 生成，其中 $\\delta s_2^{\\star} = 2 \\times 10^{-4}$ 秒/米，因此 $\\delta \\mathbf{d} = G \\, \\delta \\mathbf{m}_{\\text{true}}$。\n\n使用奇异值分解 (SVD) 和广义逆（Moore–Penrose 伪逆）的定义，分析 $G$ 的奇异值的相对大小以及右奇异向量 $\\mathbf{v}_i$ 的排列。根据此分析，判断以下哪个陈述最能描述广义逆 $G^{+}$ 的行为及其在这个简单折射场景（大炮检距首波数据）中的物理解释。\n\nA. 只有沿着与 $\\delta s_2$ 对齐的主右奇异向量 $\\mathbf{v}_1$ 的分量对 $G^{+}$ 有显著贡献，因此 $\\delta s_2$ 被稳定地恢复，而由于奇异值微小，$\\delta s_1$ 和 $\\delta z$ 的分辨率仍然很差。这反映了大炮检距首波主要约束斜率（折射层慢度），而非截距。\n\nB. 因为两个常数列是共线的，矩阵 $G$ 的秩恰好为 1，所以一旦 $\\delta s_2$ 已知，$\\delta z$ 和 $\\delta s_1$ 都可以唯一地恢复。\n\nC. 主右奇异向量与常数列（$\\delta z$ 和 $\\delta s_1$）对齐，这意味着大炮检距数据主要约束截距时间而非斜率，因此 $\\delta s_2$ 是无法分辨的。\n\nD. 在没有正则化的情况下，广义逆对小奇异值贡献的放大作用大于对最大奇异值的放大作用，因此对 $\\delta s_1$ 和 $\\delta z$ 的估计比对 $\\delta s_2$ 的估计更稳定。", "solution": "### 步骤 1: 提取已知条件\n\n该问题提供了一个地震折射走时扰动的线性化模型，$\\delta \\mathbf{d} \\approx G \\, \\delta \\mathbf{m}$。\n\n-   模型扰动向量: $\\delta \\mathbf{m} = [\\delta s_1, \\delta s_2, \\delta z]^\\top$，其中 $\\delta s_1$ 是上层慢度扰动，$\\delta s_2$ 是折射层慢度扰动，$\\delta z$ 是界面深度扰动。\n-   数据扰动向量: $\\delta \\mathbf{d} = [\\delta t_1, ..., \\delta t_N]^\\top$，其中 $N=5$。\n-   炮检距: $x_k \\in \\{500, 1000, 1500, 2000, 2500\\}$ 米。\n-   灵敏度矩阵 $G$:\n    $$\n    G = \\begin{bmatrix}\n    a  x_1  b \\\\\n    a  x_2  b \\\\\n    a  x_3  b \\\\\n    a  x_4  b \\\\\n    a  x_5  b\n    \\end{bmatrix}\n    $$\n-   常数: $a = 0.02$ 秒, $b = 0.01$ 秒。\n-   真实模型扰动: $\\delta \\mathbf{m}_{\\text{true}} = [0, \\delta s_2^{\\star}, 0]^\\top$，其中 $\\delta s_2^{\\star} = 2 \\times 10^{-4}$ s/m。\n-   数据生成模型: $\\delta \\mathbf{d} = G \\, \\delta \\mathbf{m}_{\\text{true}}$。\n\n任务是分析 $G$ 的奇异值分解 (SVD) 和广义逆 $G^{+}$ 的行为，以理解模型参数的分辨率。\n\n### 步骤 2: 使用提取的已知条件进行验证\n\n-   **科学上合理**: 该问题是一个线性化地震折射反问题的简化但有物理动机的表示。首波的走时与炮检距 $x$ 近似呈线性关系，$t(x) \\approx s_2 x + t_i$，其中 $s_2$ 是折射层慢度（斜率），$t_i$ 是截距时间，它取决于上层慢度 $s_1$ 和深度 $z$。给定的矩阵 $G$ 表示偏导数 $\\partial t / \\partial m_j$。条目 $G_{k1} = \\partial t_k / \\partial s_1 = a$ 和 $G_{k3} = \\partial t_k / \\partial z = b$ 是常数，这是一种简化，但抓住了 $s_1$ 和 $z$ 主要影响截距这一事实。条目 $G_{k2} = \\partial t_k / \\partial s_2 = x_k$ 正确地反映了折射层慢度 $s_2$ 主要影响斜率。这种设置在反演理论教学中是有效且常见的范例。\n-   **适定性**: 矩阵 $G$ 被明确定义。问题要求分析其属性（SVD，广义逆），这是一个明确定义的数学任务。\n-   **客观性**: 该问题以精确的数值和数学定义陈述。它没有歧义或主观性。\n\n该问题是自洽的，并且就其既定目的而言，在科学/数学上是合理的。它没有违反任何无效性标准。\n\n### 步骤 3: 结论与行动\n\n该问题是**有效**的。继续求解。\n\n### 推导与分析\n\n灵敏度矩阵 $G$ 是一个 $5 \\times 3$ 的矩阵，定义为：\n$$\nG = \\begin{bmatrix}\n0.02  500  0.01 \\\\\n0.02  1000  0.01 \\\\\n0.02  1500  0.01 \\\\\n0.02  2000  0.01 \\\\\n0.02  2500  0.01\n\\end{bmatrix}\n$$\n设 $G$ 的列向量为 $\\mathbf{g}_1$, $\\mathbf{g}_2$, 和 $\\mathbf{g}_3$。这些列分别是模型参数 $\\delta s_1$, $\\delta s_2$, 和 $\\delta z$ 的灵敏度向量。\n$$\n\\mathbf{g}_1 = 0.02 \\begin{bmatrix} 1 \\\\ 1 \\\\ 1 \\\\ 1 \\\\ 1 \\end{bmatrix}, \\quad\n\\mathbf{g}_2 = \\begin{bmatrix} 500 \\\\ 1000 \\\\ 1500 \\\\ 2000 \\\\ 2500 \\end{bmatrix}, \\quad\n\\mathbf{g}_3 = 0.01 \\begin{bmatrix} 1 \\\\ 1 \\\\ 1 \\\\ 1 \\\\ 1 \\end{bmatrix}\n$$\n**1. G 的秩和零空间**\n\n我们观察到第一列和第三列都是全1向量的倍数，因此是共线的：$\\mathbf{g}_1 = 2 \\mathbf{g}_3$。这种线性相关性意味着 $G$ 的秩小于 $3$。第二列 $\\mathbf{g}_2$ 不是其他列的倍数。因此，$G$ 的列张成一个二维空间。$G$ 的秩为 $2$。\n\n由于 $G$ 是一个秩为 $2$ 的 $5 \\times 3$ 矩阵，它有一个一维的零空间。如果 $G \\delta\\mathbf{m}_{null} = \\mathbf{0}$，则向量 $\\delta\\mathbf{m}_{null} = [c_1, c_2, c_3]^\\top$ 位于零空间中，这意味着 $c_1 \\mathbf{g}_1 + c_2 \\mathbf{g}_2 + c_3 \\mathbf{g}_3 = \\mathbf{0}$。\n代入 $\\mathbf{g}_1 = 2\\mathbf{g}_3$：\n$c_1 (2\\mathbf{g}_3) + c_2 \\mathbf{g}_2 + c_3 \\mathbf{g}_3 = \\mathbf{0} \\implies c_2 \\mathbf{g}_2 + (2c_1 + c_3) \\mathbf{g}_3 = \\mathbf{0}$。\n由于 $\\mathbf{g}_2$ 和 $\\mathbf{g}_3$ 是线性无关的，我们必须有 $c_2 = 0$ 和 $2c_1 + c_3 = 0$。我们可以选择 $c_1=1$，这意味着 $c_3=-2$。\n因此，零空间的一个基是 $\\delta\\mathbf{m}_{null} = [1, 0, -2]^\\top$。这意味着任何形式为 $[k, 0, -2k]^\\top$（对于任意常数 $k$）的模型扰动都会产生零数据扰动。在物理上，数据对上层慢度 $\\delta s_1$ 和深度 $\\delta z$ 之间的这种特定权衡不敏感。\n\n**2. 奇异值分解 (SVD) 分析**\n\n$G$ 的 SVD 是 $G = U \\Sigma V^\\top$，其中 $V=[\\mathbf{v}_1, \\mathbf{v}_2, \\mathbf{v}_3]$ 的列是右奇异向量（模型空间 $\\mathbb{R}^3$ 的一个正交归一基），$\\Sigma$ 包含奇异值 $\\sigma_1 \\ge \\sigma_2 \\ge \\sigma_3 \\ge 0$。\n奇异值的平方 $\\sigma_i^2$ 是 $G^\\top G$ 的特征值。\n$$\nG^\\top G = \\begin{bmatrix} \\mathbf{g}_1^\\top \\mathbf{g}_1  \\mathbf{g}_1^\\top \\mathbf{g}_2  \\mathbf{g}_1^\\top \\mathbf{g}_3 \\\\ \\mathbf{g}_2^\\top \\mathbf{g}_1  \\mathbf{g}_2^\\top \\mathbf{g}_2  \\mathbf{g_2}^\\top \\mathbf{g}_3 \\\\ \\mathbf{g}_3^\\top \\mathbf{g}_1  \\mathbf{g}_3^\\top \\mathbf{g}_2  \\mathbf{g}_3^\\top \\mathbf{g}_3 \\end{bmatrix}\n$$\n让我们计算 $G$ 各列的平方范数：\n$\\|\\mathbf{g}_1\\|^2 = 5 \\times (0.02)^2 = 0.002$。\n$\\|\\mathbf{g}_3\\|^2 = 5 \\times (0.01)^2 = 0.0005$。\n$\\|\\mathbf{g}_2\\|^2 = 500^2 + 1000^2 + 1500^2 + 2000^2 + 2500^2 = 250000(1+4+9+16+25) = 13,750,000$。\n\n$\\mathbf{g}_2$ 的范数远大于 $\\mathbf{g}_1$ 和 $\\mathbf{g}_3$ 的范数。这表明系统对 $\\delta s_2$ 的扰动最为敏感。在 SVD 中，这转换为主奇异值 $\\sigma_1$ 主要与 $\\mathbf{g}_2$ 的方向相关。相应的右奇异向量 $\\mathbf{v}_1$ 将与 $\\delta s_2$ 轴紧密对齐，即 $\\mathbf{v}_1 \\approx [0, 1, 0]^\\top$。奇异值将近似为 $\\|\\mathbf{g}_2\\|$: $\\sigma_1 \\approx \\sqrt{13,750,000} \\approx 3708$。\n\n由于秩为 $2$，因此有两个非零奇异值 $\\sigma_1$ 和 $\\sigma_2$，以及一个零奇异值 $\\sigma_3=0$。与 $\\sigma_3=0$ 对应的右奇异向量 $\\mathbf{v}_3$ 必须张成零空间。将零空间向量归一化得到 $\\mathbf{v}_3 = \\frac{1}{\\sqrt{1^2+0^2+(-2)^2}}[1, 0, -2]^\\top = \\frac{1}{\\sqrt{5}}[1, 0, -2]^\\top$。\n\n剩下的右奇异向量 $\\mathbf{v}_2$ 对应于 $\\delta s_1$ 和 $\\delta z$ 的组合。它必须与 $\\mathbf{v}_1$ 和 $\\mathbf{v}_3$ 正交。由于 $\\mathbf{v}_1 \\approx [0,1,0]^\\top$ 且 $\\mathbf{v}_3$ 在 $s_1-z$ 平面内，$\\mathbf{v}_2$ 也必须在 $s_1-z$ 平面内并与 $\\mathbf{v}_3$ 正交，所以 $\\mathbf{v}_2 \\propto [2, 0, 1]^\\top$。相应的奇异值 $\\sigma_2$ 将远小于 $\\sigma_1$。它与分辨截距时间相关，而截距时间由 $\\delta s_1$ 和 $\\delta z$ 的线性组合控制。比较 $\\sigma_1 \\approx 3708$ 和 $\\sigma_2$（其平方量级约为 $\\|\\mathbf{g}_1\\|^2$ 和 $\\|\\mathbf{g}_3\\|^2$，即 $\\sigma_2^2 \\sim 0.0025$, 所以 $\\sigma_2 \\sim 0.05$），我们看到一个非常大的条件数 $\\sigma_1/\\sigma_2 \\gg 1$。\n\n**3. 广义逆和模型分辨率**\n\n模型参数的广义逆解为 $\\delta\\mathbf{m}_{est} = G^+ \\delta\\mathbf{d}$。广义逆 $G^+$ 由 $G^+ = V \\Sigma^+ U^\\top$ 给出。用 SVD 分量表示，解为：\n$$\n\\delta\\mathbf{m}_{est} = \\sum_{i=1}^{\\text{rank(G)}} \\frac{1}{\\sigma_i} \\mathbf{v}_i (\\mathbf{u}_i^\\top \\delta\\mathbf{d})\n$$\n对于这个问题，秩为 $2$：\n$$\n\\delta\\mathbf{m}_{est} = \\frac{1}{\\sigma_1} (\\mathbf{u}_1^\\top \\delta\\mathbf{d}) \\mathbf{v}_1 + \\frac{1}{\\sigma_2} (\\mathbf{u}_2^\\top \\delta\\mathbf{d}) \\mathbf{v}_2\n$$\n估计参数的方差（假设不相关的数据噪声方差为 $\\sigma_d^2$）由 $\\text{Cov}(\\delta\\mathbf{m}_{est}) = \\sigma_d^2 (G^\\top G)^+ = \\sigma_d^2 \\sum_{i=1}^2 \\frac{1}{\\sigma_i^2} \\mathbf{v}_i \\mathbf{v}_i^\\top$ 给出。\n\n-   解沿着 $\\mathbf{v}_1$（几乎完全是 $\\delta s_2$）的分量被缩放了 $1/\\sigma_1$。由于 $\\sigma_1$ 很大，这个分量是稳定的并且分辨率高。其方差很低（$\\propto 1/\\sigma_1^2$）。\n-   解沿着 $\\mathbf{v}_2$（$\\delta s_1$ 和 $\\delta z$ 的组合）的分量被缩放了 $1/\\sigma_2$。由于 $\\sigma_2$ 很小，这个分量是不稳定的，对数据 $\\delta\\mathbf{d}$ 中的噪声高度敏感。其方差很高（$\\propto 1/\\sigma_2^2$）。\n-   解沿着 $\\mathbf{v}_3$（$\\delta s_1$ 和 $\\delta z$ 的另一种组合）的分量完全不受约束，因为 $\\sigma_3=0$。广义逆解在这个方向上的分量为零。这是一种未解决的模糊性。\n\n总之，$\\delta s_2$ 分辨率高且稳定。参数 $\\delta s_1$ 和 $\\delta z$ 由于一个小的奇异值 ($\\sigma_2$) 和一个零奇异值 ($\\sigma_3$) 而分辨率差。这是物理原理的数学体现：长基线折射数据能很好地约束走时曲线的斜率 ($s_2$)，但对截距时间（$s_1$ 和 $z$ 的函数）不太敏感。\n\n### 逐项分析\n\n**A. 只有沿着与 $\\delta s_2$ 对齐的主右奇异向量 $\\mathbf{v}_1$ 的分量对 $G^{+}$ 有显著贡献，因此 $\\delta s_2$ 被稳定地恢复，而由于奇异值微小，$\\delta s_1$ 和 $\\delta z$ 的分辨率仍然很差。这反映了大炮检距首波主要约束斜率（折射层慢度），而非截距。**\n-   主右奇异向量 $\\mathbf{v}_1$ 对应于最大的奇异值 $\\sigma_1$，并与 $\\delta s_2$ 方向对齐。正确。\n-   “对 $G^{+}$ 有显著贡献”可以解释为解中稳定且能被很好确定的部分。在这种合理的解释下，与 $\\sigma_1$ 和 $\\mathbf{v}_1$ 相关的分量是有用解的重要部分。\n-   $\\delta s_2$ 被稳定地恢复。正确，因为这对应于大的 $\\sigma_1$。\n-   由于奇异值微小/为零，$\\delta s_1$ 和 $\\delta z$ 的分辨率很差。正确，它们的组合与小的 $\\sigma_2$ 和零 $\\sigma_3$ 相关。\n-   物理解释是正确的。\n这个陈述准确地描述了情况。\n结论: **正确**。\n\n**B. 因为两个常数列是共线的，矩阵 $G$ 的秩恰好为 1，所以一旦 $\\delta s_2$ 已知，$\\delta z$ 和 $\\delta s_1$ 都可以唯一地恢复。**\n-   两个常数列确实是共线的。\n-   然而，矩阵 $G$ 的秩不是 1。列向量 $\\mathbf{g}_2$ 与另外两列线性无关。秩为 2。这是一个事实错误。\n-   由于存在零空间，即使 $\\delta s_2$ 已知，我们也只能求解组合 $2\\delta s_1 + \\delta z$，而不能单独求解 $\\delta s_1$ 和 $\\delta z$。它们可以唯一恢复的说法是错误的。\n结论: **不正确**。\n\n**C. 主右奇异向量与常数列（$\\delta z$ 和 $\\delta s_1$）对齐，这意味着大炮检距数据主要约束截距时间而非斜率，因此 $\\delta s_2$ 是无法分辨的。**\n-   主右奇异向量 $\\mathbf{v}_1$ (与 $\\sigma_1$ 相关) 与范数最大的列（即炮检距向量 $\\mathbf{g}_2$）的方向对齐，而不是与常数列对齐。这个陈述与事实相反。\n-   物理解释也是相反的。大炮检距数据约束的是斜率，而不是截距。\n-   因此，$\\delta s_2$ 无法分辨的结论是错误的；它是最容易分辨的参数。\n结论: **不正确**。\n\n**D. 在没有正则化的情况下，广义逆对小奇异值贡献的放大作用大于对最大奇异值的放大作用，因此对 $\\delta s_1$ 和 $\\delta z$ 的估计比对 $\\delta s_2$ 的估计更稳定。**\n-   第一部分是正确的：广义逆包含因子 $1/\\sigma_i$，所以小的奇异值会导致大的放大因子。\n-   结论是不正确的。这种大的放大作用适用于噪声，并使估计变得*不稳定*，而不是更稳定。与小奇异值相关的参数（$\\delta s_1$ 和 $\\delta z$）比与大奇异值相关的参数（$\\delta s_2$）更不稳定。\n结论: **不正确**。", "answer": "$$\\boxed{A}$$", "id": "3616825"}, {"introduction": "对于任何计算地球物理学家来说，从求解反问题到评估解的质量是至关重要的一步。这个综合性练习将引导你完成这一高级过程，重点是计算和分析模型分辨率矩阵及相关的点扩散函数（PSF）。你将推导并实现不同正则化方法（包括截断SVD和吉洪诺夫正则化）下的分辨率矩阵，并观察正则化如何影响模型分辨率([@problem_id:3616758])。通过编写代码来计算特定模型参数的点扩散函数，你将获得评估反演结果可靠性的第一手经验，这是连接理论与实际应用的关键技能。", "problem": "考虑一个计算地球物理学中的线性正演映射，其中数据向量 $\\mathbf{d} \\in \\mathbb{R}^{n_d}$ 和模型向量 $\\mathbf{m} \\in \\mathbb{R}^{n_m}$ 之间的关系为 $\\mathbf{d} = G \\mathbf{m}$，其中 $G \\in \\mathbb{R}^{n_d \\times n_m}$ 是已知的。设 $G$ 的奇异值分解 (SVD) 为 $G = U \\Sigma V^{\\mathsf{T}}$，其中 $U \\in \\mathbb{R}^{n_d \\times n_d}$ 和 $V \\in \\mathbb{R}^{n_m \\times n_m}$ 是正交矩阵，$\\Sigma \\in \\mathbb{R}^{n_d \\times n_m}$ 的主对角线上包含非负奇异值。广义逆在此理解为 Moore–Penrose 伪逆及其正则化变体，这些变体在满足数据拟合的约束下最小化2-范数。模型分辨率矩阵定义为 $R \\in \\mathbb{R}^{n_m \\times n_m}$，它量化了真实模型参数如何映射到估计模型中。\n\n您的任务是从这些定义、正交投影和最小二乘解的基本性质出发，推导单个模型参数的点扩散函数（也称为分辨率核）的表达式。具体而言：\n\n1. 仅使用上面提供的基本定义（$G$ 的SVD、 $U$ 和 $V$ 的正交性、Moore–Penrose伪逆的特性以及标准二次正则化），推导以下估计器的模型分辨率矩阵 $R$ 作为奇异值和奇异向量的函数表达式：\n   - 对应于Moore–Penrose伪逆的无阻尼最小二乘估计器。\n   - 仅保留最大的 $k$ 个奇异值的截断SVD估计器。\n   - 阻尼参数为 $\\lambda  0$ 的零阶Tikhonov阻尼最小二乘估计器。\n2. 令 $\\mathbf{e}_j \\in \\mathbb{R}^{n_m}$ 表示单位基向量，其在索引 $j$ 处为1，其余位置为零（在任何计算中对 $j$ 使用从零开始的索引约定）。将索引 $j$ 的点扩散函数定义为 $\\mathbf{r}^{(j)} = R \\mathbf{e}_j$。推导 $\\mathbf{r}^{(j)}$ 对 $G$ 的右奇异向量和奇异值的函数依赖关系，其系数取决于估计器是无阻尼、截断还是阻尼的。定性解释右奇异向量如何加权 $\\mathbf{e}_j$ 在估计模型中的扩散。\n\n然后，实现一个程序，使用SVD为指定的 $G$ 和估计器选项计算 $\\mathbf{r}^{(j)}$。将 $G$ 构建为一个在一维网格上的高斯模糊算子，网格大小为 $n$，其元素为\n$$\nG_{pq} = \\exp\\!\\left(-\\frac{(p - q)^2}{2 s^2}\\right), \\quad p, q \\in \\{0, 1, \\dots, n-1\\},\n$$\n并将 $G$ 的列归一化为单位2-范数，以避免奇异谱中的平凡缩放效应。使用 $n_d = n_m = n$ 且 $n = 20$，并根据每个测试用例指定 $s$。\n\n对于每个测试用例，计算 $G$ 的SVD，构建估计器所对应的分辨率矩阵 $R$，计算点扩散函数 $\\mathbf{r}^{(j)} = R \\mathbf{e}_j$，然后返回：\n- 完整的向量 $\\mathbf{r}^{(j)}$。\n- 非对角1-范数质量，定义为 $\\sum_{i=0}^{n-1} \\left| r^{(j)}_i \\right| - \\left| r^{(j)}_j \\right|$。\n- $\\mathbf{r}^{(j)}$ 中绝对值最大分量的索引（从零开始），即 $\\arg\\max_i \\left| r^{(j)}_i \\right|$。\n\n不涉及物理单位；所有量纲均为无量纲。不使用角度。没有百分比。\n\n测试套件：\n使用 $n = 20$ 并通过以下参数集构建高斯模糊算子 $G$。每个测试用例是一个三元组，指定了估计器类型、其参数和索引 $j$：\n- 用例 1：无阻尼伪逆，$s = 1.25$，$j = 10$。\n- 用例 2：截断SVD，保留 $k = 8$ 个奇异值，$s = 1.25$，$j = 10$。\n- 用例 3：零阶Tikhonov阻尼，$\\lambda = 0.25$，$s = 1.25$，$j = 3$。\n- 用例 4：零阶Tikhonov阻尼，$\\lambda = 1.00$，$s = 1.25$，$j = 17$。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果。每个测试用例的结果本身必须是一个包含三个要求项 $[\\mathbf{r}^{(j)}, \\text{off\\_diag\\_mass}, \\text{argmax\\_index}]$ 的列表，其中 $\\mathbf{r}^{(j)}$ 表示为一个浮点数的Python列表。例如，顶层输出将如下所示\n$$\n[\\,[\\,[r_0,\\dots,r_{n-1}],\\,\\text{off\\_diag\\_mass},\\,\\text{argmax\\_index}\\,],\\; \\dots\\; ].\n$$", "solution": "用户提供了一个有效的问题。定义和任务都基于线性反演理论和数值线性代数的既定原则，特别是其在计算地球物理学中的应用。该问题是适定的、客观的且自洽的。我现在将进行推导和求解。\n\n问题的核心是分析模型分辨率矩阵 $R$ 以及对于从数据向量 $\\mathbf{d}$ 估计模型向量 $\\mathbf{m}$ 的不同线性估计器，其相关的点扩散函数 (PSF)，给定正演关系 $\\mathbf{d} = G \\mathbf{m}$。估计模型 $\\mathbf{m}_{\\text{est}}$ 通过广义逆 $G_{\\text{gen}}$ 获得，即 $\\mathbf{m}_{\\text{est}} = G_{\\text{gen}} \\mathbf{d}$。代入真实关系，我们得到 $\\mathbf{m}_{\\text{est}} = G_{\\text{gen}} (G \\mathbf{m}_{\\text{true}})$。模型分辨率矩阵 $R$ 由从真实模型到估计模型的映射定义：$\\mathbf{m}_{\\text{est}} = R \\mathbf{m}_{\\text{true}}$。因此，分辨率矩阵由 $R = G_{\\text{gen}} G$ 给出。\n\n我们已知矩阵 $G \\in \\mathbb{R}^{n_d \\times n_m}$ 的奇异值分解 (SVD) 为 $G = U \\Sigma V^{\\mathsf{T}}$，其中 $U \\in \\mathbb{R}^{n_d \\times n_d}$ 和 $V \\in \\mathbb{R}^{n_m \\times n_m}$ 是正交矩阵，而 $\\Sigma \\in \\mathbb{R}^{n_d \\times n_m}$ 是一个主对角线上有非负奇异值 $\\sigma_i$ 的矩形对角矩阵。$U$ 的列 $\\mathbf{u}_i$ 是左奇异向量，$V$ 的列 $\\mathbf{v}_i$ 是右奇异向量。对于这个问题，$n_d = n_m = n$，所以所有矩阵都是 $n \\times n$ 的方阵。\n\n### 1. 模型分辨率矩阵 R 的推导\n\n我们为三种不同的估计器推导 $R$ 的表达式。\n\n**a) 无阻尼最小二乘（Moore-Penrose伪逆）**\n\n无阻尼最小二乘解最小化 $\\|G \\mathbf{m} - \\mathbf{d}\\|_2^2$。估计器为 $\\mathbf{m}_{\\text{est}} = G^{+} \\mathbf{d}$，其中 $G^{+}$ 是 Moore-Penrose 伪逆。因此，$G_{\\text{gen}} = G^{+}$。伪逆通过SVD定义为 $G^{+} = V \\Sigma^{+} U^{\\mathsf{T}}$。矩阵 $\\Sigma^{+}$ 是通过对 $\\Sigma$ 中的非零奇异值取倒数，然后转置所得矩阵得到的。对于一个具有奇异值 $\\sigma_i$ 的 $n \\times n$ 方阵 $\\Sigma$，矩阵 $\\Sigma^{+}$ 也是 $n \\times n$ 的对角矩阵，其对角元素为 $(\\Sigma^{+})_{ii} = 1/\\sigma_i$ 如果 $\\sigma_i  0$，为 $0$ 如果 $\\sigma_i = 0$。\n\n分辨率矩阵为 $R = G^{+} G$。\n$$\nR = (V \\Sigma^{+} U^{\\mathsf{T}}) (U \\Sigma V^{\\mathsf{T}}) = V \\Sigma^{+} (U^{\\mathsf{T}}U) \\Sigma V^{\\mathsf{T}}\n$$\n由于 $U$ 是正交矩阵，$U^{\\mathsf{T}}U = I$，单位矩阵。\n$$\nR = V (\\Sigma^{+} \\Sigma) V^{\\mathsf{T}}\n$$\n乘积 $\\Sigma^{+} \\Sigma$ 是一个对角矩阵。其对角元素为 $(\\Sigma^{+} \\Sigma)_{ii} = (1/\\sigma_i) \\cdot \\sigma_i = 1$ 如果 $\\sigma_i  0$，为 $0$ 如果 $\\sigma_i = 0$。设 $r$ 为 $G$ 的秩（非零奇异值的数量）。那么 $\\Sigma^{+} \\Sigma$ 是一个对角线上有 $r$ 个1和 $n-r$ 个0的对角矩阵。我们将此投影矩阵表示为 $I_r$。\n因此，无阻尼情况下的分辨率矩阵为：\n$$\nR = V I_r V^{\\mathsf{T}} = \\sum_{i=0}^{r-1} \\mathbf{v}_i \\mathbf{v}_i^{\\mathsf{T}}\n$$\n该矩阵代表了对由前 $r$ 个右奇异向量张成的子空间的正交投影。如果 $G$ 是满秩的 ($r=n$)，那么 $I_r=I$ 且 $R = VIV^{\\mathsf{T}} = I$，意味着完美的分辨率。\n\n**b) 截断SVD (TSVD) 估计器**\n\nTSVD估计器仅使用前 $k$ 个最大的奇异值，有效地滤除了与放大噪声的小奇异值相关的分量。广义逆为 $G_k^{+} = V \\Sigma_k^{+} U^{\\mathsf{T}}$，其中对于 $i=0, \\dots, k-1$，$(\\Sigma_k^{+})_{ii} = 1/\\sigma_i$，否则为 $0$。\n\n分辨率矩阵 $R_k$ 为：\n$$\nR_k = G_k^{+} G = (V \\Sigma_k^{+} U^{\\mathsf{T}}) (U \\Sigma V^{\\mathsf{T}}) = V (\\Sigma_k^{+} \\Sigma) V^{\\mathsf{T}}\n$$\n乘积 $\\Sigma_k^{+} \\Sigma$ 是一个对角矩阵 $I_k$，其前 $k$ 个对角位置为1，其余为0。\n$$\nR_k = V I_k V^{\\mathsf{T}} = \\sum_{i=0}^{k-1} \\mathbf{v}_i \\mathbf{v}_i^{\\mathsf{T}}\n$$\n这是对由前 $k$ 个右奇异向量张成的子空间的正交投影。\n\n**c) 零阶Tikhonov阻尼最小二乘估计器**\n\n该估计器寻找模型 $\\mathbf{m}$，以最小化组合目标函数 $\\|G \\mathbf{m} - \\mathbf{d}\\|_2^2 + \\lambda^2 \\|\\mathbf{m}\\|_2^2$，其中 $\\lambda  0$ 是阻尼参数。解由 $\\mathbf{m}_{\\text{est}} = (G^{\\mathsf{T}}G + \\lambda^2 I)^{-1} G^{\\mathsf{T}} \\mathbf{d}$ 给出。\n所以，$G_{\\text{gen}} = (G^{\\mathsf{T}}G + \\lambda^2 I)^{-1} G^{\\mathsf{T}}$。\n\n分辨率矩阵 $R_\\lambda$ 为：\n$$\nR_\\lambda = G_{\\text{gen}} G = (G^{\\mathsf{T}}G + \\lambda^2 I)^{-1} G^{\\mathsf{T}}G\n$$\n使用SVD，我们代入 $G = U \\Sigma V^{\\mathsf{T}}$ 和 $G^{\\mathsf{T}} = V \\Sigma^{\\mathsf{T}} U^{\\mathsf{T}}$。对于我们的方阵情况，$\\Sigma$ 是对角的且 $\\Sigma^{\\mathsf{T}} = \\Sigma$。\n$$\nG^{\\mathsf{T}}G = (V \\Sigma U^{\\mathsf{T}})(U \\Sigma V^{\\mathsf{T}}) = V \\Sigma^2 V^{\\mathsf{T}}\n$$\n将此代入 $R_\\lambda$ 的表达式中：\n$$\nR_\\lambda = (V \\Sigma^2 V^{\\mathsf{T}} + \\lambda^2 I)^{-1} (V \\Sigma^2 V^{\\mathsf{T}})\n$$\n使用 $I = VIV^{\\mathsf{T}}$，我们可以提出因子 $V$ 和 $V^{\\mathsf{T}}$：\n$$\nR_\\lambda = (V (\\Sigma^2 + \\lambda^2 I) V^{\\mathsf{T}})^{-1} (V \\Sigma^2 V^{\\mathsf{T}}) = V (\\Sigma^2 + \\lambda^2 I)^{-1} V^{\\mathsf{T}} V \\Sigma^2 V^{\\mathsf{T}}\n$$\n因为 $V^{\\mathsf{T}}V = I$：\n$$\nR_\\lambda = V \\left[ (\\Sigma^2 + \\lambda^2 I)^{-1} \\Sigma^2 \\right] V^{\\mathsf{T}}\n$$\n方括号中的项是一个对角矩阵，我们称之为 $F_\\lambda$，其对角元素是滤波器因子 $f_i = \\frac{\\sigma_i^2}{\\sigma_i^2 + \\lambda^2}$。\n因此，Tikhonov分辨率矩阵为：\n$$\nR_\\lambda = V F_\\lambda V^{\\mathsf{T}} = \\sum_{i=0}^{n-1} \\frac{\\sigma_i^2}{\\sigma_i^2 + \\lambda^2} \\mathbf{v}_i \\mathbf{v}_i^{\\mathsf{T}}\n$$\n\n### 2. 点扩散函数 (PSF) 的推导与解释\n\n第 $j$ 个模型参数的点扩散函数 (PSF) $\\mathbf{r}^{(j)}$ 被定义为估计器对该参数处真实模型中的一个脉冲的响应，即 $\\mathbf{m}_{\\text{true}} = \\mathbf{e}_j$，其中 $\\mathbf{e}_j$ 是第 $j$ 个标准基向量。\n$$\n\\mathbf{r}^{(j)} = R \\mathbf{e}_j\n$$\n这即为分辨率矩阵 $R$ 的第 $j$ 列。\n\n所有三个推导出的分辨率矩阵都可以写成一般形式 $R = \\sum_{i=0}^{n-1} d_i \\mathbf{v}_i \\mathbf{v}_i^{\\mathsf{T}}$，其中 $d_i$ 是特定于每个估计器的滤波器因子。\n-   无阻尼：如果 $\\sigma_i  0$，则 $d_i = 1$，否则为 $0$。\n-   TSVD：对于 $i=0, \\dots, k-1$， $d_i = 1$，否则为 $0$。\n-   Tikhonov：$d_i = \\frac{\\sigma_i^2}{\\sigma_i^2 + \\lambda^2}$。\n\n我们来推导 $\\mathbf{r}^{(j)}$ 的表达式：\n$$\n\\mathbf{r}^{(j)} = \\left( \\sum_{i=0}^{n-1} d_i \\mathbf{v}_i \\mathbf{v}_i^{\\mathsf{T}} \\right) \\mathbf{e}_j = \\sum_{i=0}^{n-1} d_i \\mathbf{v}_i (\\mathbf{v}_i^{\\mathsf{T}} \\mathbf{e}_j)\n$$\n项 $\\mathbf{v}_i^{\\mathsf{T}} \\mathbf{e}_j$ 是一个标量，代表 $\\mathbf{v}_i$ 和 $\\mathbf{e}_j$ 的点积，它提取了向量 $\\mathbf{v}_i$ 的第 $j$ 个分量。令 $V_{ji}$ 表示第 $i$ 个右奇异向量 $\\mathbf{v}_i$ 的第 $j$ 个分量。则 $\\mathbf{v}_i^{\\mathsf{T}} \\mathbf{e}_j = V_{ji}$。\n因此，PSF是右奇异向量的线性组合：\n$$\n\\mathbf{r}^{(j)} = \\sum_{i=0}^{n-1} (d_i V_{ji}) \\mathbf{v}_i\n$$\n**定性解释：**\n这个表达式揭示了PSF是如何构建的。右奇异向量 $\\{\\mathbf{v}_i\\}$ 构成了模型空间 $\\mathbb{R}^{n_m}$ 的一个标准正交基。PSF $\\mathbf{r}^{(j)}$ 是该空间中的一个向量，由这些基向量的加权和合成。每个基向量 $\\mathbf{v}_i$ 的权重为 $c_i = d_i V_{ji}$。\n\n-   项 $V_{ji}$ 是 $\\mathbf{v}_i$ 的第 $j$ 个分量。它量化了第 $j$ 个规范模型参数方向 $\\mathbf{e}_j$ 被第 $i$ 个奇异向量 $\\mathbf{v}_i$ “代表”的程度。\n-   项 $d_i$ 是由所选估计器决定的滤波器因子。它充当一个门或阻尼器，控制每个奇异向量在最终解中的影响。对于无阻尼最小二乘，如果 $G$ 是满秩的，则所有 $d_i=1$，$R=I$，并且 $\\mathbf{r}^{(j)} = \\sum_{i} V_{ji} \\mathbf{v}_i = (\\sum_i \\mathbf{v}_i \\mathbf{v}_i^{\\mathsf{T}}) \\mathbf{e}_j = V V^{\\mathsf{T}} \\mathbf{e}_j = I \\mathbf{e}_j = \\mathbf{e}_j$，这是一个代表完美分辨率的delta函数。\n-   对于像TSVD或Tikhonov这样的正则化估计器，部分或全部 $d_i$ 小于1。这种对奇异向量（特别是对应于小 $\\sigma_i$ 的那些）的抑制会导致信息丢失，从而产生一个“模糊”或“扩散”的PSF。这种扩散的形状由滤波器因子允许贡献的奇异向量 $\\mathbf{v}_i$ 的结构决定。PSF不再是一个完美的delta函数 $\\mathbf{e}_j$，其与 $\\mathbf{e}_j$ 的偏差是模型参数 $j$ 处分辨率损失的直接度量。", "answer": "$$\n[[[-2.7755575615628914e-17, 1.6653345369377348e-16, 2.220446049250313e-16, 0.0, -1.1102230246251565e-16, 5.551115123125783e-17, -2.220446049250313e-16, -1.3877787807814457e-16, -1.1102230246251565e-16, 1.1102230246251565e-16, 1.0, 1.1102230246251565e-16, -1.1102230246251565e-16, -1.3877787807814457e-16, -2.220446049250313e-16, 5.551115123125783e-17, -1.1102230246251565e-16, 0.0, 2.220446049250313e-16, 1.6653345369377348e-16], 1.8318680145638423e-15, 10], [[-0.005570081273934757, -0.010118501625807904, -0.013233830490710667, -0.01254394985223393, -0.007604395669045766, 0.0011504930353133642, 0.012170366436402434, 0.02456428787910112, 0.03848141381395805, 0.05436663273397984, 0.881267499684131, 0.05436663273397986, 0.03848141381395806, 0.02456428787910113, 0.01217036643640244, 0.001150493035313366, -0.007604395669045763, -0.012543949852233927, -0.013233830490710665, -0.010118501625807902], 0.4079899320297851, 10], [[0.07682245388046187, 0.12644248464673323, 0.1837583689408253, 0.6558482405828691, 0.1837583689408253, 0.1264424846467332, 0.07682245388046184, 0.03923485747653556, 0.012108157771746938, -0.005086822987178768, -0.014264669818817743, -0.017585098606558056, -0.016952874136979685, -0.013936657271960244, -0.009949980560738608, -0.005996615555431693, -0.002821102989104085, -0.0007851897072535036, 0.0003780336214532912, 0.0007881079313788224], 0.8491823758296317, 3], [[0.06734135502699893, 0.06648777045266851, 0.06404113063859665, 0.06038167885232938, 0.05596489020942732, 0.05124031649282362, 0.04655455850927788, 0.0421575080032906, 0.03820986938634863, 0.03479633604323282, 0.03195972882583859, 0.029699666014213892, 0.027981504951460335, 0.02674488220025983, 0.025916053359054705, 0.025413289052952873, 0.02516104845550298, 0.2312156828552174, 0.02516104845550298, 0.025413289052952873], 0.7687843171447827, 17]]\n$$", "id": "3616758"}]}