{"hands_on_practices": [{"introduction": "理解截断误差分析的基石在于掌握其如何从离散化过程中产生。本练习将通过泰勒级数展开这一基本工具，从第一性原理出发，指导你推导一个高阶有限差分格式。这个实践旨在让你亲手构建一个数值格式并显式计算其主导误差项，这是计算科学中的一项核心技能。[@problem_id:3617972]", "problem": "在计算地球物理学中使用的高阶有限差分格式中，需要平滑场的精确空间梯度来减少由偏微分方程（PDE）控制的波传播模拟中的数值频散。考虑一个平滑的标量地球物理场 $u(x)$，它在间距为 $h$ 的均匀网格上采样，采样点为 $x_i + m h$，其中整数偏移量 $m \\in \\{-2,-1,0,1,2\\}$。你的目标是使用如下形式的中心五点差分格式来近似一阶空间导数 $u_x(x_i)$\n$$\nD u_i \\equiv \\frac{1}{h} \\sum_{m=-2}^{2} w_m \\, u(x_i + m h),\n$$\n其中权重 $w_m$ 的选择使得 $D u_i$ 在 $x_i$ 处达到四阶精度。从 $u(x_i + m h)$ 关于 $x_i$ 的泰勒级数展开出发，通过匹配系数来确定权重 $w_m$，使得除了被正确再现的 $u_x(x_i)$ 项之外，$D u_i - u_x(x_i)$ 中与 $h^k$（其中 $k = 0,1,2,3,4$）成正比的项都为零。假设一个与一阶导数一致的中心差分格式，即对于 $m = 1,2$，有 $w_{-m} = - w_m$。然后，使用得到的权重，计算由下式定义的主截断误差系数 $C$\n$$\nD u_i - u_x(x_i) = C \\, h^4 \\, u^{(5)}(x_i) + \\mathcal{O}(h^6).\n$$\n将最终系数 $C$ 表示为一个精确的有理数。不需要四舍五入，且 $C$ 没有单位。", "solution": "用户要求推导用于一阶导数的四阶精度五点中心差分格式的权重，并随后计算主截断误差系数。\n\n问题陈述具有科学依据，是适定的、客观的。它代表了数值分析中的一个标准和基本问题，特别是在为求解偏微分方程创建高阶精度有限差分格式的背景下。所提供的信息是完整和一致的，可以得到唯一解。因此，该问题是有效的。\n\n目标是为以下近似式找到权重 $w_m$ 和系数 $C$：\n$$\nD u_i \\equiv \\frac{1}{h} \\sum_{m=-2}^{2} w_m \\, u(x_i + m h) \\approx u_x(x_i)\n$$\n使得截断误差为 $\\mathcal{O}(h^4)$。截断误差定义为：\n$$\nD u_i - u_x(x_i) = C \\, h^4 \\, u^{(5)}(x_i) + \\mathcal{O}(h^6)\n$$\n\n该差分格式是中心的并近似一阶导数，这意味着权重分布是反对称的：$w_{-m} = -w_m$。对于中心点 $m=0$，该条件得出 $w_0 = -w_0$，这只有在 $w_0=0$ 时才成立。在此条件下，近似式可以写成：\n$$\nD u_i = \\frac{1}{h} \\left( w_{-2} u(x_i - 2h) + w_{-1} u(x_i - h) + w_1 u(x_i + h) + w_2 u(x_i + 2h) \\right)\n$$\n$$\nD u_i = \\frac{1}{h} \\left( w_1 (u(x_i+h) - u(x_i-h)) + w_2 (u(x_i+2h) - u(x_i-2h)) \\right)\n$$\n为了确定未知权重 $w_1$ 和 $w_2$，我们将 $u(x_i+mh)$ 项在点 $x_i$ 附近进行泰勒级数展开。令 $u^{(k)}(x_i)$ 表示 $u$ 在 $x_i$ 处的 $k$ 阶导数。展开式为：\n$$\nu(x_i \\pm mh) = u(x_i) \\pm (mh)u^{(1)}(x_i) + \\frac{(mh)^2}{2!}u^{(2)}(x_i) \\pm \\frac{(mh)^3}{3!}u^{(3)}(x_i) + \\frac{(mh)^4}{4!}u^{(4)}(x_i) \\pm \\frac{(mh)^5}{5!}u^{(5)}(x_i) + \\mathcal{O}(h^6)\n$$\n我们构造差分格式所需的差分项。偶次幂项会抵消：\n$$\nu(x_i+h) - u(x_i-h) = 2h u^{(1)}(x_i) + \\frac{2h^3}{6} u^{(3)}(x_i) + \\frac{2h^5}{120} u^{(5)}(x_i) + \\mathcal{O}(h^7)\n$$\n$$\nu(x_i+2h) - u(x_i-2h) = 2(2h) u^{(1)}(x_i) + \\frac{2(2h)^3}{6} u^{(3)}(x_i) + \\frac{2(2h)^5}{120} u^{(5)}(x_i) + \\mathcal{O}(h^7)\n$$\n简化这些表达式得到：\n$$\nu(x_i+h) - u(x_i-h) = 2h u^{(1)}(x_i) + \\frac{h^3}{3} u^{(3)}(x_i) + \\frac{h^5}{60} u^{(5)}(x_i) + \\mathcal{O}(h^7)\n$$\n$$\nu(x_i+2h) - u(x_i-2h) = 4h u^{(1)}(x_i) + \\frac{8h^3}{3} u^{(3)}(x_i) + \\frac{8h^5}{15} u^{(5)}(x_i) + \\mathcal{O}(h^7)\n$$\n现在，将这些展开式代回到 $D u_i$ 的表达式中：\n$$\nD u_i = \\frac{w_1}{h} \\left( 2h u^{(1)}(x_i) + \\frac{h^3}{3} u^{(3)}(x_i) + \\frac{h^5}{60} u^{(5)}(x_i) + \\dots \\right) + \\frac{w_2}{h} \\left( 4h u^{(1)}(x_i) + \\frac{8h^3}{3} u^{(3)}(x_i) + \\frac{8h^5}{15} u^{(5)}(x_i) + \\dots \\right)\n$$\n我们可以按 $u$ 的导数阶数对各项进行分组：\n$$\nD u_i = (2w_1 + 4w_2) u^{(1)}(x_i) + \\left(\\frac{w_1}{3} + \\frac{8w_2}{3}\\right) h^2 u^{(3)}(x_i) + \\left(\\frac{w_1}{60} + \\frac{8w_2}{15}\\right) h^4 u^{(5)}(x_i) + \\mathcal{O}(h^6)\n$$\n为了实现对 $u_x(x_i) = u^{(1)}(x_i)$ 的四阶精度近似，我们必须确保 $u^{(1)}(x_i)$ 的系数为 $1$，并且更高阶导数项的系数在达到所需阶数前都为零。误差项应从 $\\mathcal{O}(h^4)$ 开始。\n1. $u^{(1)}(x_i)$ 的系数必须为 $1$：\n    $$2w_1 + 4w_2 = 1 \\quad (1)$$\n2. $h^2 u^{(3)}(x_i)$ 的系数必须为 $0$，以消除 $\\mathcal{O}(h^2)$ 误差项：\n    $$\\frac{w_1}{3} + \\frac{8w_2}{3} = 0 \\implies w_1 + 8w_2 = 0 \\quad (2)$$\n\n现在我们得到了一个关于两个未知权重 $w_1$ 和 $w_2$ 的二元线性方程组。从方程 $(2)$，我们将 $w_1$ 用 $w_2$ 表示：\n$$\nw_1 = -8w_2\n$$\n将此代入方程 $(1)$：\n$$\n2(-8w_2) + 4w_2 = 1\n$$\n$$\n-16w_2 + 4w_2 = 1\n$$\n$$\n-12w_2 = 1 \\implies w_2 = -\\frac{1}{12}\n$$\n现在，我们求 $w_1$：\n$$\nw_1 = -8 \\left(-\\frac{1}{12}\\right) = \\frac{8}{12} = \\frac{2}{3}\n$$\n该差分格式的完整权重集是：\n$w_2 = -1/12$, $w_1 = 2/3$, $w_0 = 0$, $w_{-1} = -2/3$, $w_{-2} = 1/12$.\n\n使用这些权重，$u^{(1)}$ 和 $u^{(3)}$ 的项是正确的。截断误差的主项是第一个非零项，即 $h^4 u^{(5)}(x_i)$ 项。\n$$\nD u_i - u_x(x_i) = \\left(\\frac{w_1}{60} + \\frac{8w_2}{15}\\right) h^4 u^{(5)}(x_i) + \\mathcal{O}(h^6)\n$$\n因此，系数 $C$ 为：\n$$\nC = \\frac{w_1}{60} + \\frac{8w_2}{15}\n$$\n代入推导出的 $w_1$ 和 $w_2$ 的值：\n$$\nC = \\frac{2/3}{60} + \\frac{8(-1/12)}{15} = \\frac{2}{3 \\cdot 60} - \\frac{8}{12 \\cdot 15}\n$$\n$$\nC = \\frac{2}{180} - \\frac{8}{180} = \\frac{2-8}{180} = \\frac{-6}{180}\n$$\n简化分数得到系数 $C$ 的最终结果：\n$$\nC = -\\frac{1}{30}\n$$", "answer": "$$\n\\boxed{-\\frac{1}{30}}\n$$", "id": "3617972"}, {"introduction": "在理论上掌握了如何推导截断误差之后，一个关键的实践步骤是验证计算机程序是否正确地实现了该数值格式。本练习将介绍“人造解方法”（Method of Manufactured Solutions, MMS），这是一种强有力的技术，用于验证代码是否达到了其设计的收敛阶。你将把此方法应用于热传导方程，从而连接理论分析与实际的代码验证。[@problem_id:3617926]", "problem": "在计算地球物理学中，一维空间中的热扩散过程由偏微分方程(PDE) $u_{t}=\\kappa u_{xx}$ 在周期性域 $x\\in[0,1]$ 上建模，其中 $\\kappa>0$ 是一个常扩散系数，并且对于所有 $t\\geq 0$ 施加周期性边界条件 $u(0,t)=u(1,t)$ 和 $u_{x}(0,t)=u_{x}(1,t)$。为使用“人工解法”(Method of Manufactured Solutions)评估离散化格式的截断误差，考虑如下人工解\n$$\nu(x,t)=\\exp(\\sigma t)\\sin(2\\pi x)+\\exp(2\\sigma t)\\cos(4\\pi x),\n$$\n其中 $\\sigma\\neq 0$ 是一个给定的实常数。引入一个源项 $s(x,t)$，使得 $u(x,t)$ 是带源项的偏微分方程\n$$\nu_{t}=\\kappa u_{xx}+s(x,t),\n$$\n在相同周期性边界条件下的一个精确解。\n\n在一个均匀网格上，其中整数 $i$ 对应 $x_{i}=i\\,\\Delta x$，整数 $n$ 对应时间层 $t^{n}=n\\,\\Delta t$，考虑以下在时间和空间上均为二阶精确的Crank–Nicolson有限差分格式，该格式使用中心二阶差分和源项的梯形时间平均：\n$$\n\\frac{u_{i}^{n+1}-u_{i}^{n}}{\\Delta t}=\\kappa\\,\\frac{1}{2}\\left[\\frac{u_{i+1}^{n}-2u_{i}^{n}+u_{i-1}^{n}}{\\Delta x^{2}}+\\frac{u_{i+1}^{n+1}-2u_{i}^{n+1}+u_{i-1}^{n+1}}{\\Delta x^{2}}\\right]+\\frac{1}{2}\\left(s_{i}^{n}+s_{i}^{n+1}\\right),\n$$\n其中 $i$ 的索引具有与边界条件一致的周期性。\n\n任务：\n- 推导源项 $s(x,t)$ 的显式闭式表达式，使得给定的 $u(x,t)$ 成为带源项偏微分方程的精确解。\n- 使用关于 $(x_{i},t^{n})$ 的泰勒展开和局部截断误差的定义，预测阶数 $p$，使得局部截断误差的量级为 $\\mathcal{O}(\\Delta t^{p})+\\mathcal{O}(\\Delta x^{p})$。\n\n请以行矩阵的形式提供最终答案，矩阵中依次包含 $s(x,t)$ 的显式表达式和整数 $p$。无需单位。", "solution": "该问题要求我们执行两项任务：首先，推导源项 $s(x,t)$，使得给定的人工解 $u(x,t)$ 满足带源项的热传导方程；其次，预测所用 Crank-Nicolson 格式的精度阶数 $p$。\n\n**1. 推导源项 $s(x,t)$**\n\n根据带源项的偏微分方程 $u_t = \\kappa u_{xx} + s(x,t)$，我们可以将源项表示为：\n$$\ns(x,t) = u_t - \\kappa u_{xx}\n$$\n我们需要计算人工解 $u(x,t)$ 的时间偏导数 $u_t$ 和空间二阶偏导数 $u_{xx}$。\n给定的人工解为：\n$$\nu(x,t) = \\exp(\\sigma t)\\sin(2\\pi x) + \\exp(2\\sigma t)\\cos(4\\pi x)\n$$\n首先，计算时间偏导数 $u_t$：\n$$\nu_t = \\frac{\\partial}{\\partial t} \\left( \\exp(\\sigma t)\\sin(2\\pi x) + \\exp(2\\sigma t)\\cos(4\\pi x) \\right)\n$$\n$$\nu_t = \\sigma \\exp(\\sigma t)\\sin(2\\pi x) + 2\\sigma \\exp(2\\sigma t)\\cos(4\\pi x)\n$$\n接着，计算空间偏导数。首先是一阶导数 $u_x$：\n$$\nu_x = \\frac{\\partial}{\\partial x} \\left( \\exp(\\sigma t)\\sin(2\\pi x) + \\exp(2\\sigma t)\\cos(4\\pi x) \\right)\n$$\n$$\nu_x = 2\\pi \\exp(\\sigma t)\\cos(2\\pi x) - 4\\pi \\exp(2\\sigma t)\\sin(4\\pi x)\n$$\n然后是二阶导数 $u_{xx}$：\n$$\nu_{xx} = \\frac{\\partial}{\\partial x} \\left( 2\\pi \\exp(\\sigma t)\\cos(2\\pi x) - 4\\pi \\exp(2\\sigma t)\\sin(4\\pi x) \\right)\n$$\n$$\nu_{xx} = - (2\\pi)^2 \\exp(\\sigma t)\\sin(2\\pi x) - (4\\pi)^2 \\exp(2\\sigma t)\\cos(4\\pi x)\n$$\n$$\nu_{xx} = -4\\pi^2 \\exp(\\sigma t)\\sin(2\\pi x) - 16\\pi^2 \\exp(2\\sigma t)\\cos(4\\pi x)\n$$\n现在，将 $u_t$ 和 $u_{xx}$ 代入 $s(x,t)$ 的表达式中：\n$$\ns(x,t) = \\left( \\sigma \\exp(\\sigma t)\\sin(2\\pi x) + 2\\sigma \\exp(2\\sigma t)\\cos(4\\pi x) \\right) - \\kappa \\left( -4\\pi^2 \\exp(\\sigma t)\\sin(2\\pi x) - 16\\pi^2 \\exp(2\\sigma t)\\cos(4\\pi x) \\right)\n$$\n通过合并同类项（$\\sin(2\\pi x)$ 和 $\\cos(4\\pi x)$ 的项），我们得到源项的最终表达式：\n$$\ns(x,t) = (\\sigma + 4\\kappa\\pi^2)\\exp(\\sigma t)\\sin(2\\pi x) + (2\\sigma + 16\\kappa\\pi^2)\\exp(2\\sigma t)\\cos(4\\pi x)\n$$\n\n**2. 预测精度阶数 $p$**\n\nCrank-Nicolson 格式通过在时间步 $t^n$ 和 $t^{n+1}$ 对空间导数项和源项取平均来离散方程。让我们分析该格式的各个组成部分：\n- **时间离散化**：$\\frac{u_i^{n+1}-u_i^n}{\\Delta t}$ 是时间导数的中心差分近似（在 $t^{n+1/2}$ 处），而右侧项是 $t^n$ 和 $t^{n+1}$ 处值的平均。这整体上等价于在时间上使用梯形法则，其局部截断误差为 $\\mathcal{O}(\\Delta t^2)$。\n- **空间离散化**：$\\frac{u_{i+1}-2u_i+u_{i-1}}{\\Delta x^2}$ 是标准的二阶中心差分格式，用于近似二阶导数 $u_{xx}$。其局部截断误差为 $\\mathcal{O}(\\Delta x^2)$。\n\n由于该格式在时间上是二阶精确，在空间上也是二阶精确，因此其整体局部截断误差由这两个误差的主导项构成，即 $\\mathcal{O}(\\Delta t^2) + \\mathcal{O}(\\Delta x^2)$。\n因此，阶数 $p$ 为 2。", "answer": "$$\n\\boxed{\\begin{pmatrix} (\\sigma + 4\\kappa\\pi^{2})\\exp(\\sigma t)\\sin(2\\pi x) + (2\\sigma + 16\\kappa\\pi^{2})\\exp(2\\sigma t)\\cos(4\\pi x) & 2 \\end{pmatrix}}\n$$", "id": "3617926"}, {"introduction": "一个微小的局部截断误差保证了数值格式在局部是对偏微分方程的良好逼近，这一性质被称为相容性（consistency）。然而，这并不足以保证全局误差也能保持微小。本练习将通过一个经典案例，阐释数值稳定性（numerical stability）的关键概念，展示即使局部截断误差很小，离散化带来的误差也可能灾难性地累积和增长。[@problem_id:3617985]", "problem": "考虑一维线性平流方程，\n$$\nu_t = a\\,u_x,\n$$\n该方程定义在周期区间 $[0,1]$ 上，周期为 $1$，其中 $a$ 是一个恒定的平流速度。设 $x_j = j\\,\\Delta x$，其中 $j=0,1,\\dots,N-1$，$N$ 是网格点数，$\\Delta x = 1/N$。设 $t^n = n\\,\\Delta t$，时间步长为 $\\Delta t$。定义 Courant–Friedrichs–Lewy 数（也称为 Courant 数）为 $\\nu = a\\,\\Delta t/\\Delta x$。\n\n您将分析前向时间、中心空间有限差分方法，\n$$\n\\frac{u_j^{n+1} - u_j^n}{\\Delta t} = a\\,\\frac{u_{j+1}^n - u_{j-1}^n}{2\\,\\Delta x},\n$$\n该方法应用于周期性网格，其中下标按模 $N$ 解释。此方法是众所周知的对于平流问题是一致但不稳定的。\n\n您的任务是：\n\n- 从离散算子的定义和泰勒展开出发，将网格点 $x_j$ 和时间 $t^n$ 处的局部截断误差定义为将精确解代入有限差分更新式中得到的余项：\n$$\n\\tau_j^n = \\frac{u(x_j,t^{n+1}) - u(x_j,t^n)}{\\Delta t} - a\\,\\frac{u(x_{j+1},t^n) - u(x_{j-1},t^n)}{2\\,\\Delta x}.\n$$\n\n- 使用网格上的离散 $L^2$ 范数，定义为\n$$\n\\|v\\|_2 = \\left(\\Delta x \\sum_{j=0}^{N-1} v_j^2\\right)^{1/2},\n$$\n来量化局部截断误差和数值解的增长。\n\n- 对于波数为 $m \\in \\mathbb{N}$ 的离散傅里叶模初始条件，\n$$\nu(x,0) = \\sin(2\\pi\\,m\\,x),\n$$\n以及精确解 $u(x,t) = \\sin(2\\pi\\,m\\,(x + a t))$，计算在时间 $t^n=0$ 时的局部截断误差向量，\n$$\n\\tau^0 = \\{\\tau_j^0\\}_{j=0}^{N-1},\n$$\n及其范数 $\\|\\tau^0\\|_2$。\n\n- 将单步更新定义为作用于网格向量的线性算子 $A$，$u^{n+1} = A u^n$。使用基于离散 $L^2$ 范数中的诱导算子范数的范数增长估计来界定 $\\|A\\|_2$。然后，使用离散傅里叶模态分析，确定所选模态在 $n$ 步后的观测范数增长因子，并将其与您基于范数的上界进行比较。不要先验地假设一个界限；您必须从周期性网格上 $A$ 的结构中获得它。\n\n- 通过一个光滑模态进行数值展示，表明即使局部截断误差很小，经过多步后观测到的范数增长也可能超过 $1$，从而证明了由于不稳定性导致的全局误差发散。\n\n程序的实现要求：\n\n- 在周期性网格上使用上述格式。对于每个测试用例，计算：\n  1. 在 $t^0=0$ 时的局部截断误差 $\\|\\tau^0\\|_2$，如上定义。\n  2. 在 $n$ 个时间步后，对于指定模态的观测范数增长率 $R_{\\text{obs}} = \\|u^n\\|_2/\\|u^0\\|_2$。您可以通过显式地应用格式 $n$ 次来计算，或者利用格式在周期性网格上是平移不变的，因此傅里叶模态在每一步都保持不变，只是乘以一个由模态和 $\\nu$ 决定的放大因子。\n  3. 理论范数增长上界的对数形式，$\\log R_{\\text{bound}} = n \\log \\|A\\|_2$，其中 $\\|A\\|_2$ 是每个时间步的离散 $L^2$ 诱导算子范数。\n  4. 一个布尔值，表示该测试是否观测到不稳定性，定义为 $R_{\\text{obs}} > 1$。\n\n- 测试套件。使用以下参数集，其中 $a$、$N$、$\\nu$、$T$ 和 $m$ 分别表示平流速度、网格点数、Courant 数、最终时间和傅里叶模态指数。使用 $x_j = j/N$，$\\Delta x = 1/N$，$\\Delta t = \\nu\\,\\Delta x/a$，以及 $n = \\lfloor T/\\Delta t \\rceil$（最近整数）个时间步。\n  - 测试 1：$a=1$，$N=256$，$\\nu=0.05$，$T=10$，$m=1$。\n  - 测试 2：$a=1$，$N=256$，$\\nu=0.10$，$T=20$，$m=1$。\n  - 测试 3：$a=1$，$N=64$，$\\nu=0.50$，$T=5$，$m=1$。\n\n- 对于每个测试：\n  - 计算 $\\|\\tau^0\\|_2$ 为浮点数。\n  - 计算 $R_{\\text{obs}}$ 为浮点数。\n  - 计算 $\\log R_{\\text{obs}}$ 为浮点数。\n  - 计算 $\\log R_{\\text{bound}}$ 为浮点数。\n  - 计算布尔值 $R_{\\text{obs}} > 1$。\n\n- 最终输出格式。您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，每个测试用例按以下顺序贡献一个子列表\n$$\n[\\|\\tau^0\\|_2,\\; R_{\\text{obs}},\\; \\log R_{\\text{obs}},\\; \\log R_{\\text{bound}},\\; R_{\\text{obs}}>1].\n$$\n例如，一个有效的形状是\n$$\n\\big[\\,[\\cdot,\\cdot,\\cdot,\\cdot,\\cdot],\\;[\\cdot,\\cdot,\\cdot,\\cdot,\\cdot],\\;[\\cdot,\\cdot,\\cdot,\\cdot,\\cdot]\\,\\big].\n$$\n所有量都是无量纲的。以标准十进制形式返回浮点数，以 True 或 False 形式返回布尔值。打印的单行必须严格是这种列表的列表表示形式。", "solution": "该问题已经过验证。\n\n### 步骤1：提取已知条件\n- **偏微分方程 (PDE)**：$u_t = a\\,u_x$\n- **定义域**：在 $[0,1]$ 上周期性，周期为 $1$。\n- **平流速度**：$a$ 是一个常数。\n- **空间网格**：$x_j = j\\,\\Delta x$，对于 $j=0,1,\\dots,N-1$，其中 $\\Delta x = 1/N$。\n- **时间网格**：$t^n = n\\,\\Delta t$。\n- **Courant 数 (CFL)**：$\\nu = a\\,\\Delta t/\\Delta x$。\n- **有限差分方法 (FTCS)**：$\\frac{u_j^{n+1} - u_j^n}{\\Delta t} = a\\,\\frac{u_{j+1}^n - u_{j-1}^n}{2\\,\\Delta x}$。下标按模 $N$ 解释。\n- **局部截断误差定义**：$\\tau_j^n = \\frac{u(x_j,t^{n+1}) - u(x_j,t^n)}{\\Delta t} - a\\,\\frac{u(x_{j+1},t^n) - u(x_{j-1},t^n)}{2\\,\\Delta x}$，其中 $u(x,t)$ 是精确解。\n- **离散 $L^2$ 范数**：$\\|v\\|_2 = \\left(\\Delta x \\sum_{j=0}^{N-1} v_j^2\\right)^{1/2}$。\n- **初始条件**：$u(x,0) = \\sin(2\\pi\\,m\\,x)$，对于波数 $m \\in \\mathbb{N}$。\n- **精确解**：$u(x,t) = \\sin(2\\pi\\,m\\,(x + a t))$。\n- **单步算子**：$u^{n+1} = A u^n$。\n- **每个测试用例需要计算的量**：\n  1. $\\|\\tau^0\\|_2$，在 $t=0$ 时的局部截断误差的范数。\n  2. $R_{\\text{obs}} = \\|u^n\\|_2/\\|u^0\\|_2$，$n$ 步后的观测范数增长率。\n  3. $\\log R_{\\text{bound}} = n \\log \\|A\\|_2$，理论范数增长上界的对数。\n  4. 一个布尔值，指示是否 $R_{\\text{obs}} > 1$。\n- **测试参数**：\n  - $n = \\lfloor T/\\Delta t \\rceil$（最近整数）。\n  - 测试 1：$a=1$，$N=256$，$\\nu=0.05$，$T=10$，$m=1$。\n  - 测试 2：$a=1$，$N=256$，$\\nu=0.10$，$T=20$，$m=1$。\n  - 测试 3：$a=1$，$N=64$，$\\nu=0.50$，$T=5$，$m=1$。\n- **输出格式**：代表列表的列表的单行：`[[val1, val2, ...], [val1, val2, ...], ...]`。\n\n### 步骤2：使用提取的已知条件进行验证\n该问题是偏微分方程数值分析中的一个标准练习，特别关注线性平流方程 FTCS 格式的稳定性。\n- **科学基础**：分析基于数值分析的基本原理，包括用于截断误差的泰勒级数展开和用于稳定性的离散傅里叶分析（von Neumann 稳定性分析）。FTCS 格式和平流方程是该领域的经典主题。所有方面在科学上都是合理的。\n- **适定性**：问题要求基于一套完整的初始数据和参数计算特定的、明确定义的量。每个量都存在唯一的解。\n- **客观性**：问题以精确的数学语言陈述，没有主观性或模糊性。\n- **完整性**：提供了所有必要的定义、方程和参数。\n- **一致性**：给定的条件内部一致。提供的精确解确实满足给定的偏微分方程和初始条件。\n\n该问题没有表现出任何无效性缺陷。\n\n### 步骤3：结论与行动\n该问题是**有效的**。将提供一个完整的、有理有据的解答。\n\n### 基于原理的解答\n\n解答要求为每个测试用例计算四个量：局部截断误差的范数 $\\|\\tau^0\\|_2$、观测到的范数增长 $R_{\\text{obs}}$、理论对数范数增长界限 $\\log R_{\\text{bound}}$ 和一个不稳定性标志。我们将为每个量推导解析表达式。\n\n#### 1. 局部截断误差范数 $\\|\\tau^0\\|_2$\n在 $t=0$ 时的局部截断误差通过将精确解代入有限差分格式得到：\n$$\n\\tau_j^0 = \\frac{u(x_j, \\Delta t) - u(x_j, 0)}{\\Delta t} - a \\frac{u(x_{j+1}, 0) - u(x_{j-1}, 0)}{2\\Delta x}\n$$\n使用精确解 $u(x,t) = \\sin(2\\pi m(x+at))$ 和网格点 $x_j=j\\Delta x$，我们有：\n- $u(x_j, 0) = \\sin(2\\pi m x_j)$\n- $u(x_j, \\Delta t) = \\sin(2\\pi m (x_j + a\\Delta t))$\n- $u(x_{j\\pm 1}, 0) = \\sin(2\\pi m (x_j \\pm \\Delta x))$\n\n将这些代入 $\\tau_j^0$ 的表达式中：\n$$\n\\tau_j^0 = \\frac{\\sin(2\\pi m (x_j + a\\Delta t)) - \\sin(2\\pi m x_j)}{\\Delta t} - a \\frac{\\sin(2\\pi m (x_j + \\Delta x)) - \\sin(2\\pi m (x_j - \\Delta x))}{2\\Delta x}\n$$\n使用三角恒等式 $\\sin(A+B)-\\sin(A-B) = 2\\cos A \\sin B$ 和 $\\sin(A)-\\sin(B) = 2\\cos\\frac{A+B}{2}\\sin\\frac{A-B}{2}$，表达式变为：\n$$\n\\tau_j^0 = \\frac{2\\cos(2\\pi m x_j + \\pi m a\\Delta t)\\sin(\\pi m a\\Delta t)}{\\Delta t} - \\frac{a}{2\\Delta x} \\left(2\\cos(2\\pi m x_j)\\sin(2\\pi m \\Delta x)\\right)\n$$\n展开 $\\cos(A+B) = \\cos A \\cos B - \\sin A \\sin B$ 并按 $\\sin(2\\pi m x_j)$ 和 $\\cos(2\\pi m x_j)$ 分组：\n$$\n\\tau_j^0 = \\cos(2\\pi m x_j) \\left[ \\frac{2\\cos(\\pi m a\\Delta t)\\sin(\\pi m a\\Delta t)}{\\Delta t} - \\frac{a\\sin(2\\pi m \\Delta x)}{\\Delta x} \\right] - \\sin(2\\pi m x_j) \\left[ \\frac{2\\sin^2(\\pi m a\\Delta t)}{\\Delta t} \\right]\n$$\n使用恒等式 $\\sin(2\\theta) = 2\\sin\\theta\\cos\\theta$：\n$$\n\\tau_j^0 = \\cos(2\\pi m x_j) \\left[ \\frac{\\sin(2\\pi m a\\Delta t)}{\\Delta t} - \\frac{a\\sin(2\\pi m \\Delta x)}{\\Delta x} \\right] - \\sin(2\\pi m x_j) \\left[ \\frac{2\\sin^2(\\pi m a\\Delta t)}{\\Delta t} \\right]\n$$\n我们定义系数 $E_c$ 和 $E_s$ 如下：\n$$\nE_c = \\frac{\\sin(2\\pi m a \\Delta t)}{\\Delta t} - \\frac{a \\sin(2\\pi m \\Delta x)}{\\Delta x}\n$$\n$$\nE_s = - \\frac{2 \\sin^2(\\pi m a \\Delta t)}{\\Delta t}\n$$\n因此，$\\tau_j^0 = E_c \\cos(2\\pi m j/N) + E_s \\sin(2\\pi m j/N)$。我们现在计算范数 $\\|\\tau^0\\|_2^2 = \\Delta x \\sum_{j=0}^{N-1} (\\tau_j^0)^2$。\n由于离散正弦和余弦函数在网格上的正交性（对于 $m \\neq 0$ 和 $2m \\neq N$，这在所有测试用例中都成立），我们有：\n$\\sum_{j=0}^{N-1} \\cos^2(2\\pi m j/N) = N/2$\n$\\sum_{j=0}^{N-1} \\sin^2(2\\pi m j/N) = N/2$\n$\\sum_{j=0}^{N-1} \\cos(2\\pi m j/N)\\sin(2\\pi m j/N) = 0$\n因此，\n$$\n\\|\\tau^0\\|_2^2 = \\Delta x \\sum_{j=0}^{N-1} [E_c^2 \\cos^2(2\\pi m j/N) + E_s^2 \\sin^2(2\\pi m j/N) + \\dots] = \\Delta x \\left( E_c^2 \\frac{N}{2} + E_s^2 \\frac{N}{2} \\right)\n$$\n由于 $\\Delta x = 1/N$，这简化为：\n$$\n\\|\\tau^0\\|_2^2 = \\frac{1}{2}(E_c^2 + E_s^2) \\implies \\|\\tau^0\\|_2 = \\sqrt{\\frac{1}{2}(E_c^2 + E_s^2)}\n$$\n这个解析表达式将用于计算。\n\n#### 2. 观测范数增长率 $R_{\\text{obs}}$\nFTCS 格式是周期性网格上的一个线性、平移不变的算子。它对傅里叶模的作用是将其乘以一个放大因子。让我们分析它对离散傅里叶模 $u_j^n = G^n e^{i k x_j}$ 的影响，其中 $k$ 是波数。在网格上，相关的波数是 $\\theta_p = 2\\pi p \\Delta x = 2\\pi p/N$，对于 $p=0, \\dots, N-1$。代入格式中：\n$$\nG e^{i\\theta_p j} = e^{i\\theta_p j} + \\frac{\\nu}{2} (e^{i\\theta_p(j+1)} - e^{i\\theta_p(j-1)})\n$$\n除以 $e^{i\\theta_p j}$ 得到放大因子 $G(\\theta_p)$：\n$$\nG(\\theta_p) = 1 + \\frac{\\nu}{2}(e^{i\\theta_p} - e^{-i\\theta_p}) = 1 + i\\nu\\sin(\\theta_p)\n$$\n初始条件 $u(x,0) = \\sin(2\\pi m x)$ 对应于网格函数 $u_j^0 = \\sin(2\\pi m j/N)$。这是两个复指数模的叠加：\n$u_j^0 = \\frac{1}{2i} (e^{i\\theta_m j} - e^{-i\\theta_m j})$，其中 $\\theta_m = 2\\pi m /N$。\n经过 $n$ 个时间步后，解演变为：\n$$\nu_j^n = \\frac{1}{2i} \\left( [G(\\theta_m)]^n e^{i\\theta_m j} - [G(-\\theta_m)]^n e^{-i\\theta_m j} \\right)\n$$\n因为 $\\sin(-\\theta_m) = -\\sin(\\theta_m)$，我们有 $G(-\\theta_m) = 1 - i\\nu\\sin(\\theta_m) = \\overline{G(\\theta_m)}$。\n设 $G_m = G(\\theta_m)$。那么 $u_j^n = \\frac{1}{2i} (G_m^n e^{i\\theta_m j} - \\overline{G_m^n} e^{-i\\theta_m j})$。\n在第 $n$ 步的解的范数与第 $0$ 步的范数通过放大因子的模相关联。$n$ 步后的范数比率为：\n$$\nR_{\\text{obs}} = \\frac{\\|u^n\\|_2}{\\|u^0\\|_2} = |G_m|^n\n$$\n放大因子的模为：\n$$\n|G_m| = |1 + i\\nu\\sin(\\theta_m)| = \\sqrt{1^2 + (\\nu\\sin(\\theta_m))^2} = \\sqrt{1 + \\nu^2\\sin^2(2\\pi m/N)}\n$$\n因此，观测到的增长为：\n$R_{\\text{obs}} = \\left( \\sqrt{1 + \\nu^2\\sin^2(2\\pi m/N)} \\right)^n = \\left( 1 + \\nu^2\\sin^2(2\\pi m/N) \\right)^{n/2}$。\n问题要求 $\\log R_{\\text{obs}}$，它就是：\n$$\n\\log R_{\\text{obs}} = n \\log |G_m| = \\frac{n}{2} \\log\\left(1 + \\nu^2\\sin^2(2\\pi m/N)\\right)\n$$\n\n#### 3. 理论范数增长上界 $\\log R_{\\text{bound}}$\n范数增长的理论界限由单步算子 $A$ 的诱导 2-范数决定，其中 $u^{n+1}=Au^n$。$n$ 步后的增长由 $\\|A^n\\|_2 \\le \\|A\\|_2^n$ 界定。比率的界限是 $R_{\\text{bound}} = \\|A\\|_2^n$。\n矩阵 $A$ 是一个正规矩阵（$AA^H = A^H A$），所以它的诱导 2-范数等于它的谱半径 $\\rho(A)$，也就是其特征值的最大模。$A$ 的特征值是所有可能的网格模 $p=0, \\dots, N-1$ 的放大因子 $G(\\theta_p)$。\n$$\n\\|A\\|_2 = \\rho(A) = \\max_{p} |G(\\theta_p)| = \\max_{p} \\sqrt{1 + \\nu^2\\sin^2(2\\pi p/N)}\n$$\n$\\sin^2(2\\pi p/N)$ 的最大值在 $2\\pi p/N$ 最接近 $\\pi/2$ 时出现。对于给定的测试用例，$N=256$ 和 $N=64$，它们都是 $4$ 的倍数。因此，对于 $p=N/4$，我们有 $2\\pi p/N = \\pi/2$，并且 $\\sin^2(\\pi/2)=1$。\n因此，最大值恰好是 $1$，并且：\n$$\n\\|A\\|_2 = \\sqrt{1 + \\nu^2}\n$$\n对数界限是：\n$$\n\\log R_{\\text{bound}} = n \\log \\|A\\|_2 = n \\log \\sqrt{1+\\nu^2} = \\frac{n}{2}\\log(1+\\nu^2)\n$$\n对于任何非零的 $\\nu$，$\\|A\\|_2 > 1$，这证明了该格式是无条件不稳定的。解的范数可以无界增长，被网格上最高频率的模态放大。\n\n#### 4. 不稳定性布尔值\n这只是一个测试 $R_{\\text{obs}} > 1$。由于对于任何 $\\nu \\neq 0$ 和 $m$ 不是 $N/2$ 的倍数时 $|G_m| > 1$，并且 $n$ 很大，$R_{\\text{obs}}$ 将大于 $1$，这表明即使对于一个光滑、被解析的模态，不稳定性也会出现。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Analyzes the forward-time, centered-space (FTCS) scheme for the\n    1D linear advection equation to demonstrate its inherent instability.\n    \"\"\"\n\n    # Test suite: (a, N, nu, T, m)\n    # a: advection speed\n    # N: number of grid points\n    # nu: Courant number\n    # T: final time\n    # m: Fourier mode index for the initial condition\n    test_cases = [\n        (1.0, 256, 0.05, 10.0, 1),\n        (1.0, 256, 0.10, 20.0, 1),\n        (1.0, 64,  0.50, 5.0,  1),\n    ]\n\n    results = []\n    for case in test_cases:\n        a, N, nu, T, m = case\n\n        # Derive grid parameters\n        dx = 1.0 / N\n        dt = nu * dx / a\n        n = int(round(T / dt))\n\n        # --- 1. Local Truncation Error Norm ||tau^0||_2 ---\n        \n        # Coefficients derived from the analytical expression for tau^0_j\n        # E_c = sin(2*pi*m*a*dt)/dt - a*sin(2*pi*m*dx)/dx\n        # E_s = -2*sin^2(pi*m*a*dt)/dt\n        \n        # Numerator and denominator for the first term of E_c\n        num1_ec = np.sin(2 * np.pi * m * a * dt)\n        den1_ec = dt\n        \n        # Numerator and denominator for the second term of E_c\n        num2_ec = a * np.sin(2 * np.pi * m * dx)\n        den2_ec = dx\n\n        E_c = (num1_ec / den1_ec) - (num2_ec / den2_ec)\n\n        # Numerator and denominator for E_s\n        num_es = -2 * (np.sin(np.pi * m * a * dt))**2\n        den_es = dt\n        \n        E_s = num_es / den_es\n        \n        # Norm of the truncation error vector\n        # ||tau^0||_2 = sqrt(0.5 * (E_c^2 + E_s^2))\n        tau_norm_sq = 0.5 * (E_c**2 + E_s**2)\n        tau_norm = np.sqrt(tau_norm_sq)\n\n        # --- 2. Observed Norm Growth Ratio R_obs ---\n        \n        # Amplification factor G_m for mode m\n        # |G_m| = sqrt(1 + nu^2 * sin^2(2*pi*m/N))\n        theta_m = 2 * np.pi * m / N\n        G_m_mag_sq = 1 + nu**2 * (np.sin(theta_m))**2\n        G_m_mag = np.sqrt(G_m_mag_sq)\n\n        # Observed growth ratio after n steps\n        # R_obs = |G_m|^n\n        R_obs = G_m_mag**n\n        \n        # Logarithm of observed growth\n        log_R_obs = n * np.log(G_m_mag)\n\n        # --- 3. Theoretical Norm-Growth Upper Bound log R_bound ---\n        \n        # The 2-norm of the operator A is ||A||_2 = max_p |G(theta_p)|.\n        # For N being a multiple of 4, max sin^2 is 1.\n        # ||A||_2 = sqrt(1 + nu^2)\n        A_norm_sq = 1 + nu**2\n        A_norm = np.sqrt(A_norm_sq)\n\n        # Logarithm of the theoretical upper bound on growth\n        # log R_bound = n * log(||A||_2)\n        log_R_bound = n * np.log(A_norm)\n\n        # --- 4. Instability Boolean ---\n        is_unstable = R_obs > 1.0\n\n        # Assemble results for the current test case\n        results.append([\n            float(tau_norm), \n            float(R_obs),\n            float(log_R_obs), \n            float(log_R_bound), \n            bool(is_unstable)\n        ])\n\n    # Final print statement in the exact required format.\n    # The str representation of the list of lists must be produced.\n    print(str(results).replace(\"'\", \"\"))\n\nsolve()\n```", "id": "3617985"}]}