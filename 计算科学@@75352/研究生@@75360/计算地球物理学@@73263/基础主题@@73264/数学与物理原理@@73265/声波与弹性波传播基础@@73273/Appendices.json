{"hands_on_practices": [{"introduction": "在模拟波的传播之前，我们必须首先理解材料属性如何决定波速。本练习将介质的弹性常数（拉梅参数 $\\lambda$ 和 $\\mu$）与压缩波（P波）和剪切波（S波）的基本传播速度联系起来。通过从第一性原理推导这些关系，您将巩固对地震学物理基础的理解，并为解译真实世界数据和数值模拟结果打下坚实的基础 [@problem_id:3573453]。", "problem": "考虑一个均匀、各向同性、线弹性固体，代表结晶地殼岩石。小振幅弹性波根据线动量守恒和各向同性线性应力-应变关系进行传播。设质量密度为 $\\rho$，拉梅参数为 $\\lambda$ 和 $\\mu$。从线动量守恒和各向同性胡克定律出发，在没有体力的情况下使用平面波拟设，推导压缩波波速 $c_{P}$ 和剪切波波速 $c_{S}$ 的表达式，并使用相同的本构定律，根据单轴应力下的定义单独推导泊松比 $\\nu$ 的表达式。\n\n然后，对参数组 $\\lambda = 20\\ \\mathrm{GPa}$、$\\mu = 30\\ \\mathrm{GPa}$ 和 $\\rho = 2500\\ \\mathrm{kg/m^3}$ 计算推导出的表达式的值。计算前将吉帕斯卡（GPa）转换为帕斯卡（Pa）。最终的波速以 $\\mathrm{m/s}$ 为单位表示，泊松比以无量纲小数表示。将您的数值结果四舍五入到 $4$ 位有效数字。按 $c_{P}$、$c_{S}$、$\\nu$ 的顺序报告您的最终数值结果。", "solution": "该问题被评估为有效，因为它代表了连续介质力学和弹性动力学中的一个标准推导，具有科学依据，是适定的、客观的，并为得到唯一解提供了所有必要信息。\n\n推导过程分三部分进行：首先，从弹性波方程推导压缩波和剪切波的速度；其次，根据定义推导泊松比；第三，对给定参数进行这些物理量的数值计算。\n\n**第一部分：波速（$c_P$ 和 $c_S$）的推导**\n\n在均匀、各向同性固体中小振幅弹性波的传播由运动方程控制。在没有体力的情况下，线动量守恒表示为：\n$$\n\\rho \\frac{\\partial^2 u_i}{\\partial t^2} = \\frac{\\partial \\sigma_{ij}}{\\partial x_j}\n$$\n其中 $\\rho$ 是质量密度，$\\mathbf{u}(\\mathbf{x}, t)$ 是位移矢量，其分量为 $u_i$，$t$ 是时间，$\\mathbf{x}$ 是位置矢量，其分量为 $x_j$，$\\sigma_{ij}$ 是应力张量。对重复指标使用了爱因斯坦求和约定。\n\n对于线性、各向同性弹性材料，其应力-应变关系由胡克定律给出：\n$$\n\\sigma_{ij} = \\lambda \\epsilon_{kk} \\delta_{ij} + 2\\mu \\epsilon_{ij}\n$$\n这里，$\\lambda$ 和 $\\mu$ 是拉梅参数，$\\delta_{ij}$ 是克罗内克 δ 符号，$\\epsilon_{ij}$ 是无穷小应变张量。项 $\\epsilon_{kk} = \\nabla \\cdot \\mathbf{u}$ 代表体积应变。应变张量与位移场的关系为：\n$$\n\\epsilon_{ij} = \\frac{1}{2} \\left( \\frac{\\partial u_i}{\\partial x_j} + \\frac{\\partial u_j}{\\partial x_i} \\right)\n$$\n将应变的表达式代入胡克定律，然后将结果代入运动方程：\n$$\n\\rho \\frac{\\partial^2 u_i}{\\partial t^2} = \\frac{\\partial}{\\partial x_j} \\left[ \\lambda \\left(\\frac{\\partial u_k}{\\partial x_k}\\right) \\delta_{ij} + 2\\mu \\frac{1}{2} \\left( \\frac{\\partial u_i}{\\partial x_j} + \\frac{\\partial u_j}{\\partial x_i} \\right) \\right]\n$$\n$$\n\\rho \\frac{\\partial^2 u_i}{\\partial t^2} = \\lambda \\frac{\\partial}{\\partial x_i} \\left(\\frac{\\partial u_k}{\\partial x_k}\\right) + \\mu \\left( \\frac{\\partial^2 u_i}{\\partial x_j \\partial x_j} + \\frac{\\partial^2 u_j}{\\partial x_j \\partial x_i} \\right)\n$$\n该方程可以写成矢量形式的弹性波方程：\n$$\n\\rho \\frac{\\partial^2 \\mathbf{u}}{\\partial t^2} = (\\lambda + \\mu) \\nabla(\\nabla \\cdot \\mathbf{u}) + \\mu \\nabla^2 \\mathbf{u}\n$$\n我们寻求形式为 $\\mathbf{u}(\\mathbf{x}, t) = \\mathbf{A} \\exp(i(\\mathbf{k} \\cdot \\mathbf{x} - \\omega t))$ 的平面波解，其中 $\\mathbf{A}$ 是常数振幅矢量，$\\mathbf{k}$ 是波矢，$\\omega$ 是角频率。所需的导数为：\n$$\n\\frac{\\partial^2 \\mathbf{u}}{\\partial t^2} = -\\omega^2 \\mathbf{u}\n$$\n$$\n\\nabla \\cdot \\mathbf{u} = i \\mathbf{k} \\cdot \\mathbf{u}\n$$\n$$\n\\nabla(\\nabla \\cdot \\mathbf{u}) = -\\mathbf{k}(\\mathbf{k} \\cdot \\mathbf{u})\n$$\n$$\n\\nabla^2 \\mathbf{u} = -|\\mathbf{k}|^2 \\mathbf{u} = -k^2 \\mathbf{u}\n$$\n将这些代入波动方程得到：\n$$\n-\\rho \\omega^2 \\mathbf{u} = -(\\lambda + \\mu) \\mathbf{k}(\\mathbf{k} \\cdot \\mathbf{u}) - \\mu k^2 \\mathbf{u}\n$$\n重新整理得到特征方程：\n$$\n\\rho \\omega^2 \\mathbf{u} = (\\lambda + \\mu) (\\mathbf{k} \\cdot \\mathbf{u})\\mathbf{k} + \\mu k^2 \\mathbf{u}\n$$\n我们分析两种关于极化方向 $\\mathbf{A}$ 相对于传播方向 $\\mathbf{k}$ 的不同情况。\n\n情况1：压缩波（P波）。位移平行于波矢（$\\mathbf{A} \\parallel \\mathbf{k}$）。\n在这种情况下，$\\mathbf{k} \\cdot \\mathbf{u} = k u$，其中 $u = |\\mathbf{u}|$。方程变为：\n$$\n\\rho \\omega^2 \\mathbf{u} = (\\lambda + \\mu) (k u) \\frac{\\mathbf{u}}{u} k + \\mu k^2 \\mathbf{u} = (\\lambda + \\mu) k^2 \\mathbf{u} + \\mu k^2 \\mathbf{u}\n$$\n$$\n\\rho \\omega^2 = (\\lambda + 2\\mu) k^2\n$$\n压缩波波速为 $c_P = \\omega/k$。因此：\n$$\nc_P^2 = \\frac{\\omega^2}{k^2} = \\frac{\\lambda + 2\\mu}{\\rho} \\implies c_P = \\sqrt{\\frac{\\lambda + 2\\mu}{\\rho}}\n$$\n\n情况2：剪切波（S波）。位移垂直于波矢（$\\mathbf{A} \\perp \\mathbf{k}$）。\n在这种情况下，$\\mathbf{k} \\cdot \\mathbf{u} = 0$。方程简化为：\n$$\n\\rho \\omega^2 \\mathbf{u} = (\\lambda + \\mu) (0)\\mathbf{k} + \\mu k^2 \\mathbf{u} = \\mu k^2 \\mathbf{u}\n$$\n$$\n\\rho \\omega^2 = \\mu k^2\n$$\n剪切波波速为 $c_S = \\omega/k$。因此：\n$$\nc_S^2 = \\frac{\\omega^2}{k^2} = \\frac{\\mu}{\\rho} \\implies c_S = \\sqrt{\\frac{\\mu}{\\rho}}\n$$\n\n**第二部分：泊松比（$\\nu$）的推导**\n\n泊松比 $\\nu$ 在单轴应力状态下定义为横向应变与轴向应变之比的负值。设应力 $\\sigma_{11}$ 沿 $x_1$ 轴施加，所有其他应力分量均为零。那么 $\\nu = -\\epsilon_{22}/\\epsilon_{11} = -\\epsilon_{33}/\\epsilon_{11}$。\n\n我们必须反转本构关系 $\\sigma_{ij} = \\lambda \\epsilon_{kk} \\delta_{ij} + 2\\mu \\epsilon_{ij}$ 以用应力表示应变。\n取应力张量的迹：$\\sigma_{kk} = \\sigma_{11}+\\sigma_{22}+\\sigma_{33} = 3\\lambda \\epsilon_{kk} + 2\\mu \\epsilon_{kk} = (3\\lambda+2\\mu)\\epsilon_{kk}$。\n所以，$\\epsilon_{kk} = \\frac{\\sigma_{kk}}{3\\lambda+2\\mu}$。\n将此代回本构方程：\n$$\n2\\mu \\epsilon_{ij} = \\sigma_{ij} - \\lambda \\epsilon_{kk} \\delta_{ij} = \\sigma_{ij} - \\frac{\\lambda \\sigma_{ll}}{3\\lambda+2\\mu} \\delta_{ij}\n$$\n$$\n\\epsilon_{ij} = \\frac{1}{2\\mu} \\sigma_{ij} - \\frac{\\lambda}{2\\mu(3\\lambda+2\\mu)} \\sigma_{ll} \\delta_{ij}\n$$\n对于单轴应力 $\\sigma_{11} \\neq 0$ 且所有其他 $\\sigma_{ij}=0$ 的情况，我们有 $\\sigma_{ll} = \\sigma_{11}$。\n轴向应变 $\\epsilon_{11}$ ($i=j=1$) 为：\n$$\n\\epsilon_{11} = \\frac{1}{2\\mu} \\sigma_{11} - \\frac{\\lambda}{2\\mu(3\\lambda+2\\mu)} \\sigma_{11} = \\frac{(3\\lambda+2\\mu)-\\lambda}{2\\mu(3\\lambda+2\\mu)} \\sigma_{11} = \\frac{2\\lambda+2\\mu}{2\\mu(3\\lambda+2\\mu)} \\sigma_{11} = \\frac{\\lambda+\\mu}{\\mu(3\\lambda+2\\mu)} \\sigma_{11}\n$$\n横向应变 $\\epsilon_{22}$ ($i=j=2$) 为：\n$$\n\\epsilon_{22} = \\frac{1}{2\\mu} (\\sigma_{22}=0) - \\frac{\\lambda}{2\\mu(3\\lambda+2\\mu)} \\sigma_{11} = - \\frac{\\lambda}{2\\mu(3\\lambda+2\\mu)} \\sigma_{11}\n$$\n现在，我们计算该比率：\n$$\n\\nu = -\\frac{\\epsilon_{22}}{\\epsilon_{11}} = - \\frac{- \\frac{\\lambda}{2\\mu(3\\lambda+2\\mu)} \\sigma_{11}}{\\frac{\\lambda+\\mu}{\\mu(3\\lambda+2\\mu)} \\sigma_{11}} = \\frac{\\lambda}{2\\mu} \\frac{\\mu}{\\lambda+\\mu}\n$$\n$$\n\\nu = \\frac{\\lambda}{2(\\lambda+\\mu)}\n$$\n\n**第三部分：数值计算**\n\n给定参数为 $\\lambda = 20\\ \\mathrm{GPa} = 20 \\times 10^9\\ \\mathrm{Pa}$，$\\mu = 30\\ \\mathrm{GPa} = 30 \\times 10^9\\ \\mathrm{Pa}$，以及 $\\rho = 2500\\ \\mathrm{kg/m^3}$。\n\nP波波速 $c_P$ 为：\n$$\nc_P = \\sqrt{\\frac{\\lambda + 2\\mu}{\\rho}} = \\sqrt{\\frac{20 \\times 10^9\\ \\mathrm{Pa} + 2(30 \\times 10^9\\ \\mathrm{Pa})}{2500\\ \\mathrm{kg/m^3}}} = \\sqrt{\\frac{80 \\times 10^9}{2500}}\\ \\mathrm{m/s}\n$$\n$$\nc_P = \\sqrt{32 \\times 10^6}\\ \\mathrm{m/s} \\approx 5656.854\\ \\mathrm{m/s}\n$$\n四舍五入到 $4$ 位有效数字，$c_P = 5657\\ \\mathrm{m/s}$。\n\nS波波速 $c_S$ 为：\n$$\nc_S = \\sqrt{\\frac{\\mu}{\\rho}} = \\sqrt{\\frac{30 \\times 10^9\\ \\mathrm{Pa}}{2500\\ \\mathrm{kg/m^3}}} = \\sqrt{\\frac{300 \\times 10^8}{25 \\times 10^2}}\\ \\mathrm{m/s}\n$$\n$$\nc_S = \\sqrt{12 \\times 10^6}\\ \\mathrm{m/s} \\approx 3464.102\\ \\mathrm{m/s}\n$$\n四舍五入到 $4$ 位有效数字，$c_S = 3464\\ \\mathrm{m/s}$。\n\n泊松比 $\\nu$ 为：\n$$\n\\nu = \\frac{\\lambda}{2(\\lambda+\\mu)} = \\frac{20 \\times 10^9\\ \\mathrm{Pa}}{2(20 \\times 10^9\\ \\mathrm{Pa} + 30 \\times 10^9\\ \\mathrm{Pa})} = \\frac{20 \\times 10^9}{2(50 \\times 10^9)} = \\frac{20}{100} = 0.2\n$$\n作为一个有 $4$ 位有效数字的无量纲小数，$\\nu = 0.2000$。\n\n最终结果按 $c_P$、$c_S$、$\\nu$ 的顺序报告。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n5657 & 3464 & 0.2000\n\\end{pmatrix}\n}\n$$", "id": "3573453"}, {"introduction": "当我们对波的传播进行数值模拟时，模拟的稳定性并非理所当然。本练习深入探讨了Courant-Friedrichs-Lewy (CFL) 条件，这是显式时间步进方法的关键稳定性判据。您将学习如何通过求解Christoffel方程确定各向异性介质中的最大波速，并将其与网格尺寸联系起来，从而计算出最大稳定时间步长 [@problem_id:3573435]。掌握这一概念对于任何计算波模拟的实践者都至关重要，因为它确保了数值模拟的可靠性和有效性。", "problem": "您需要推导并以编程方式实现一种评估方法，用于计算在混合单元网格上求解非均匀、各向异性介质中线性弹性波方程时，显式时间步进法的稳定性极限。从三维线性动量守恒和 胡克定律出发，通过平面波拟设将控制方程简化为 Christoffel 型特征值问题，从而推导出方向相关的弹性波相速度。然后，从半离散系统的二阶精度显式中心差分时间积分出发，推导一个保守的 Courant-Friedrichs-Lewy (CFL) 界限，该界限将稳定时间步长与一个维度相关的常数、单元特征长度和最大相速度联系起来。您的实现应为每个测试用例计算以下内容：通过对传播方向进行数值搜索得到最大相速度，以及在一组混合单元类型上计算最小单元长度，并根据您推导的界限返回最大稳定时间步长。\n\n您的推理和推导应基于以下基本定律和定义：\n- 在没有体力的情况下，线性动量守恒为 $ \\rho \\, \\ddot{\\boldsymbol{u}} = \\nabla \\cdot \\boldsymbol{\\sigma} $，其中 $ \\rho $ 是质量密度，$ \\boldsymbol{u} $ 是位移，$ \\boldsymbol{\\sigma} $ 是应力。\n- 对于具有各向异性四阶刚度张量 $ \\mathsf{C} $ 的线性弹性体，其本构关系遵循 $ \\boldsymbol{\\sigma} = \\mathsf{C} : \\boldsymbol{\\varepsilon} $，其中应变 $ \\boldsymbol{\\varepsilon} = \\tfrac{1}{2} \\left( \\nabla \\boldsymbol{u} + \\nabla \\boldsymbol{u}^{\\mathsf{T}} \\right) $。\n- 对于一个平面波 $ \\boldsymbol{u}(\\boldsymbol{x},t) = \\Re \\left\\{ \\boldsymbol{a} \\, e^{\\mathrm{i} \\omega \\left( \\boldsymbol{n} \\cdot \\boldsymbol{x} - t \\right)} \\right\\} $，其单位方向为 $ \\boldsymbol{n} $，角频率为 $ \\omega $，极化方向为 $ \\boldsymbol{a} $，相关的 Christoffel 矩阵为 $ \\Gamma_{ij}(\\boldsymbol{n}) = C_{ikjl} \\, n_k \\, n_l $，非平凡解满足 $ \\left[ \\Gamma(\\boldsymbol{n}) - \\rho \\, v^2(\\boldsymbol{n}) \\, \\mathsf{I} \\right] \\boldsymbol{a} = \\boldsymbol{0} $，其中 $ v(\\boldsymbol{n}) = \\omega / \\lvert \\boldsymbol{k} \\rvert $ 是相速度，$ \\mathsf{I} $ 是单位矩阵。\n- 最大相速度为 $ c_{\\max} = \\max_{\\lVert \\boldsymbol{n} \\rVert = 1} \\sqrt{ \\lambda_{\\max} \\left( \\Gamma(\\boldsymbol{n}) \\right) / \\rho } $，其中 $ \\lambda_{\\max} $ 表示最大特征值。\n- 考虑一个具有一致质量或集中质量的半离散格式，并采用二阶精度的显式中心差分时间积分。在维度为 $ d $、使用线性单元的均匀剖分上，运用冯·诺依曼分析法，推导出一个保守的、与维度相关的常数 $ \\alpha(d) $，使得稳定性界限可以写为 $ \\Delta t \\le \\alpha(d) \\, \\min_{e} \\left( \\Delta x_e / c_{\\max,e} \\right) $，其中 $ \\Delta x_e $ 是一个单元特征尺寸，$ c_{\\max,e} $ 是单元 $ e $ 内的最大相速度。对于本任务，将单元特征尺寸定义为单元的最小边长。\n- 对于二维情况，将传播方向 $ \\boldsymbol{n} $ 限制在平面内（即 $ \\boldsymbol{n} = (\\cos \\theta, \\sin \\theta, 0) $），对于三维情况，使用单位球面上的方向。角度 $ \\theta $ 必须以弧度为单位。\n\n您的程序必须：\n- 使用标准工程剪切约定，从给定的 $ 6 \\times 6 $ Voigt 矩阵构建四阶刚度张量 $ \\mathsf{C} $，并通过在指定方向集上对 $ \\sqrt{ \\lambda_{\\max}(\\Gamma(\\boldsymbol{n})) / \\rho } $ 进行数值最大化来评估 $ c_{\\max} $。\n- 对于三角形、四边形、四面体和六面体单元，将 $ \\Delta x_e $ 计算为单元 $ e $ 的任意两个不同顶点之间的最小欧几里得距离。\n- 使用您推导的保守常数 $ \\alpha(d) $ 来计算稳定时间步长 $ \\Delta t_{\\text{stable}} $。\n\n测试套件和材料，所有物理量均采用国际单位制（SI）：\n- 案例 A（二维各向同性，混合三角形和四边形，答案以秒为单位）：\n  - 维度 $ d = 2 $。\n  - 密度 $ \\rho = 2500 $ kg/m$^3$。\n  - 各向同性拉梅参数 $ \\lambda = 2.0 \\times 10^{9} $ Pa, $ \\mu = 3.0 \\times 10^{9} $ Pa；构建相应的 $ 6 \\times 6 $ Voigt 刚度矩阵。\n  - 单元（坐标单位为米）：\n    - 节点为 $ (0,0,0) $, $ (10,0,0) $, $ (0,10,0) $ 的三角形。\n    - 节点为 $ (0,0,0) $, $ (12,0,0) $, $ (12,12,0) $, $ (0,12,0) $ 的四边形。\n  - 在评估 $ c_{\\max} $ 时，将方向限制在 $ x $-$ y $ 平面内。\n\n- 案例 B（三维正交各向异性，混合四面体和六面体，答案以秒为单位）：\n  - 维度 $ d = 3 $。\n  - 密度 $ \\rho = 2600 $ kg/m$^3$。\n  - 正交各向异性 $ 6 \\times 6 $ Voigt 刚度（Pa）：\n    - $ c_{11} = 5.0 \\times 10^{10} $, $ c_{22} = 4.0 \\times 10^{10} $, $ c_{33} = 3.0 \\times 10^{10} $,\n      $ c_{44} = 1.0 \\times 10^{10} $, $ c_{55} = 1.2 \\times 10^{10} $, $ c_{66} = 0.8 \\times 10^{10} $,\n      $ c_{12} = 1.5 \\times 10^{10} $, $ c_{13} = 1.2 \\times 10^{10} $, $ c_{23} = 1.0 \\times 10^{10} $,\n      所有其他未列出的条目均为对称且为零。\n  - 单元（坐标单位为米）：\n    - 节点为 $ (0,0,0) $, $ (10,0,0) $, $ (0,9,0) $, $ (0,0,8) $ 的四面体。\n    - 节点为 $ (0,0,0) $, $ (20,0,0) $, $ (20,20,0) $, $ (0,20,0) $, $ (0,0,20) $, $ (20,0,20) $, $ (20,20,20) $, $ (0,20,20) $ 的六面体（边长为 $ 20 $ 的立方体）。\n\n- 案例 C（三维横向各向同性（绕 $ z $ 轴），混合四面体和六面体，答案以秒为单位）：\n  - 维度 $ d = 3 $。\n  - 密度 $ \\rho = 2700 $ kg/m$^3$。\n  - 横向各向异性 $ 6 \\times 6 $ Voigt 刚度（Pa），具有对称关系 $ c_{22} = c_{11} $, $ c_{23} = c_{13} $, $ c_{55} = c_{44} $, $ c_{66} = \\tfrac{1}{2}(c_{11} - c_{12}) $：\n    - $ c_{11} = 6.0 \\times 10^{10} $, $ c_{33} = 8.0 \\times 10^{10} $,\n      $ c_{44} = 2.0 \\times 10^{10} $, $ c_{12} = 3.0 \\times 10^{10} $, $ c_{13} = 2.5 \\times 10^{10} $。\n  - 单元（坐标单位为米）：\n    - 节点为 $ (0,0,0) $, $ (1,0,0) $, $ (0,1,0) $, $ (0,0,1) $ 的四面体。\n    - 节点为 $ (0,0,0) $, $ (5,0,0) $, $ (5,5,0) $, $ (0,5,0) $, $ (0,0,5) $, $ (5,0,5) $, $ (5,5,5) $, $ (0,5,5) $ 的六面体（边长为 $ 5 $ 的立方体）。\n\n实现要求：\n- 对于二维情况，通过将方向限制在 $ x $-$ y $ 平面内来采用平面应变解释；刚度仍以三维形式处理，但方向搜索是二维的。\n- 对于二维搜索，在 $ \\theta \\in [0, 2\\pi) $ 弧度范围内以足够的分辨率均匀采样角度，以精确逼近 $ c_{\\max} $。对于三维搜索，使用具有足够分辨率的确定性、近似均匀序列在单位球面上采样方向，以精确逼近 $ c_{\\max} $。\n- 每个单元的特征长度 $ \\Delta x_e $ 是该单元顶点集上的最小边长，使用欧几里得范数计算。\n- 您推导的保守常数 $ \\alpha(d) $ 必须用于计算每个案例的 $ \\Delta t_{\\text{stable}} $。\n\n输出内容：\n- 对于每个案例 $ \\in \\{ \\text{A}, \\text{B}, \\text{C} \\} $，使用您推导的 $ \\alpha(d) $ 和上述定义，计算单个标量 $ \\Delta t_{\\text{stable}} $（以秒为单位）。\n- 您的程序必须生成单行输出，其中包含结果，格式为一个逗号分隔的三个浮点数列表，四舍五入到六位小数，用方括号括起来，顺序为 $ [ \\Delta t_{\\text{A}}, \\Delta t_{\\text{B}}, \\Delta t_{\\text{C}} ] $。", "solution": "用户提供的问题被评估为有效。它在科学上基于连续介质力学和数值分析的原理，问题提法良好，目标明确，数据充分，并使用了客观、正式的语言。解题过程如下。\n\n### 理论推导\n\n该问题要求推导并实现线性弹性波方程数值解的稳定性准则。这涉及两个主要的理论步骤：理解弹性波的传播，以及分析数值时间步进格式的稳定性。\n\n#### 1. 弹性波传播与 Christoffel 方程\n\n在均匀各向异性介质中，线性弹性波的传播由无体力情况下的线性动量守恒控制：\n$$ \\rho \\, \\ddot{\\boldsymbol{u}} = \\nabla \\cdot \\boldsymbol{\\sigma} \\quad(1) $$\n其中 $ \\rho $ 是质量密度，$ \\boldsymbol{u} $ 是位移矢量，$ \\boldsymbol{\\sigma} $ 是柯西应力张量。其本构行为由线性弹性材料的广义胡克定律描述：\n$$ \\boldsymbol{\\sigma} = \\mathsf{C} : \\boldsymbol{\\varepsilon} \\quad(2) $$\n其中 $ \\mathsf{C} $ 是四阶刚度张量，$ \\boldsymbol{\\varepsilon} $ 是无穷小应变张量，由位移梯度的对称部分给出：\n$$ \\boldsymbol{\\varepsilon} = \\frac{1}{2} \\left( \\nabla \\boldsymbol{u} + (\\nabla \\boldsymbol{u})^{\\mathsf{T}} \\right) \\quad(3) $$\n结合这些方程，并利用刚度张量的次对称性（$ C_{ijkl} = C_{ijlk} = C_{jikl} $），运动方程可以用分量形式写为：\n$$ \\rho \\, \\ddot{u}_i = \\partial_j \\sigma_{ij} = \\partial_j (C_{ijkl} \\varepsilon_{kl}) = C_{ijkl} \\partial_j \\partial_k u_l \\quad(4) $$\n我们通过考虑以下形式的平面波拟设来分析此偏微分方程：\n$$ \\boldsymbol{u}(\\boldsymbol{x}, t) = \\boldsymbol{a} \\, \\exp\\left[\\mathrm{i} \\omega \\left(\\frac{\\boldsymbol{n} \\cdot \\boldsymbol{x}}{v} - t\\right)\\right] $$\n其中 $ \\boldsymbol{a} $ 是常数极化矢量，$ \\omega $ 是角频率，$ v $ 是相速度，$ \\boldsymbol{n} $ 是波传播方向上的单位矢量。将此代入方程（4）可得：\n$$ -\\rho \\omega^2 a_i = C_{ijkl} \\left( \\frac{\\mathrm{i}\\omega}{v} n_j \\right) \\left( \\frac{\\mathrm{i}\\omega}{v} n_k \\right) a_l = -\\frac{\\omega^2}{v^2} C_{ijkl} n_j n_k a_l $$\n重新整理得到特征值问题：\n$$ (C_{ikjl} n_k n_l) a_j = \\rho v^2 a_i $$\n这就是著名的 Christoffel 方程。矩阵 $ \\Gamma_{ij}(\\boldsymbol{n}) = C_{ikjl} n_k n_l $ 是 Christoffel 矩阵。该方程可重写为：\n$$ \\left[ \\boldsymbol{\\Gamma}(\\boldsymbol{n}) - \\rho v^2(\\boldsymbol{n}) \\mathsf{I} \\right] \\boldsymbol{a} = \\boldsymbol{0} $$\n对于任意传播方向 $ \\boldsymbol{n} $，只有当方括号中的项是奇异时，才存在极化方向 $ \\boldsymbol{a} $ 的非平凡解。这意味着 $ \\rho v^2 $ 必须是 $ \\boldsymbol{\\Gamma}(\\boldsymbol{n}) $ 的一个特征值。由于 $ \\boldsymbol{\\Gamma} $ 是对称正定的，对于任意 $ \\boldsymbol{n} $，都存在三个实的正特征值，对应于三种具有相互正交极化方向的不同波模（一个准纵波和两个准横波）。最大相速度 $ c_{\\max} $ 通过在所有可能的传播方向上最大化最大相速度来找到：\n$$ c_{\\max} = \\max_{\\|\\boldsymbol{n}\\|=1} \\sqrt{ \\frac{\\lambda_{\\max}(\\boldsymbol{\\Gamma}(\\boldsymbol{n}))}{\\rho} } $$\n其中 $ \\lambda_{\\max} $ 表示 Christoffel 矩阵的最大特征值。\n\n#### 2. CFL 稳定性条件\n\n问题指定了一个采用二阶精度显式中心差分格式进行时间积分的半离散系统。对于一个一般的二阶系统 $ \\ddot{\\boldsymbol{u}} + \\boldsymbol{\\Omega}^2 \\boldsymbol{u} = 0 $，其中 $ \\boldsymbol{\\Omega}^2 $ 代表空间离散算子（例如，在有限元中为 $ \\boldsymbol{M}^{-1}\\boldsymbol{K} $），中心差分更新格式为：\n$$ \\frac{\\boldsymbol{u}^{n+1} - 2\\boldsymbol{u}^n + \\boldsymbol{u}^{n-1}}{(\\Delta t)^2} + \\boldsymbol{\\Omega}^2 \\boldsymbol{u}^n = 0 $$\n冯·诺依曼稳定性分析表明，如果 $ \\Delta t \\le 2/\\omega_{\\max} $，该格式是稳定的，其中 $ \\omega_{\\max} $ 是算子 $ \\boldsymbol{\\Omega} $ 的最大固有频率（特征值）。\n\n为了推导与维度相关的常数 $ \\alpha(d) $，我们遵循提示，在一个维度为 $ d $、间距为 $ \\Delta h $ 的均匀超立方体网格上分析标量波动方程 $ \\ddot{u} = c^2 \\nabla^2 u $。空间算子 $ \\nabla^2 $ 由标准中心差分模板近似。在一个网格点上的半离散方程为：\n$$ \\ddot{u}_{\\boldsymbol{i}} = c^2 \\sum_{j=1}^{d} \\frac{u_{\\boldsymbol{i}+\\boldsymbol{e}_j} - 2u_{\\boldsymbol{i}} + u_{\\boldsymbol{i}-\\boldsymbol{e}_j}}{(\\Delta h)^2} $$\n该离散算子的最大频率对应于网格可以表示的最高频率傅里叶模式（奈奎斯特频率），在该模式下，解沿着一个方向在每个网格点上符号交替。当 $ \\sum (\\dots) $ 项最大化时，数值格式的放大因子最大。这发生在波矢为 $ \\boldsymbol{k} = (\\pi/\\Delta h, \\dots, \\pi/\\Delta h) $ 的模式下。对于此模式，有效离散波数的平方为 $ k_{\\text{eff}}^2 = \\sum_{j=1}^d \\frac{4}{(\\Delta h)^2} = \\frac{4d}{(\\Delta h)^2} $。最大频率约为 $ \\omega_{\\max} \\approx c k_{\\text{eff}} = c \\frac{2\\sqrt{d}}{\\Delta h} $。\n于是，稳定性极限为：\n$$ \\Delta t \\le \\frac{2}{\\omega_{\\max}} = \\frac{2}{c \\frac{2\\sqrt{d}}{\\Delta h}} = \\frac{\\Delta h}{c\\sqrt{d}} $$\n这提供了一个保守的稳定性界限。将其与所要求的形式 $ \\Delta t \\le \\alpha(d) (\\Delta x_e / c_{\\max,e}) $ 进行比较，我们将特征长度 $ \\Delta x_e $ 等同于 $ \\Delta h $，最大速度 $ c_{\\max,e} $ 等同于 $ c $，并将保守的维度相关常数确定为：\n$$ \\alpha(d) = \\frac{1}{\\sqrt{d}} $$\n对于本问题，我们将此一般结果应用于混合单元网格，方法是将 $ c_{\\max} $ 作为材料中的最大相速度，并将 $ \\Delta x_{\\min} = \\min_{e} \\Delta x_e $ 作为网格中所有单元的最小特征长度。用于计算的最终稳定性准则为：\n$$ \\Delta t_{\\text{stable}} = \\alpha(d) \\frac{\\min_{e} \\Delta x_e}{c_{\\max}} = \\frac{1}{\\sqrt{d}} \\frac{\\Delta x_{\\min}}{c_{\\max}} $$\n\n### 算法实现\n\n程序为每个测试用例系统地实现了推导出的公式。\n\n1.  **刚度张量构建**：对于每个案例，根据给定的参数（各向同性材料使用 拉梅参数，正交各向异性材料使用显式分量，横向各向异性材料使用 Thomsen 风格的参数）构建 $6 \\times 6$ Voigt 矩阵 $ C_V $。然后将其转换为完整的 $3 \\times 3 \\times 3 \\times 3$ 刚度张量 $ C_{ijkl} $。该转换分别将 Voigt 索引 $(1,2,3,4,5,6)$ 映射到张量索引对 $(11, 22, 33, 23, 13, 12)$。一个映射数组 `v_map = [[0, 5, 4], [5, 1, 3], [4, 3, 2]]`（使用从 0 开始的索引）有助于此过程：$ C_{ijkl} = C_V[\\text{v\\_map}[i,j], \\text{v\\_map}[k,l]] $。\n\n2.  **最大相速度计算 ($ c_{\\max} $)**：执行数值搜索。\n    *   对于二维情况（$ d=2 $），传播方向 $ \\boldsymbol{n}=(\\cos\\theta, \\sin\\theta, 0) $ 在 $ \\theta \\in [0, 2\\pi) $ 范围内被均匀采样。\n    *   对于三维情况（$ d=3 $），使用斐波那契晶格生成单位球面上的一组近似均匀的方向。\n    *   对于每个方向 $ \\boldsymbol{n} $，使用 `numpy.einsum` 高效地计算 Christoffel 矩阵 $ \\Gamma_{ij} = C_{ikjl} n_k n_l $。\n    *   计算对称矩阵 $ \\boldsymbol{\\Gamma}(\\boldsymbol{n}) $ 的特征值。该方向上的最大相速度为 $ v(\\boldsymbol{n}) = \\sqrt{\\lambda_{\\max}(\\boldsymbol{\\Gamma}) / \\rho} $。\n    *   $ c_{\\max} $ 是在所有采样方向上这些速度的最大值。\n\n3.  **最小单元长度计算 ($ \\Delta x_{\\min} $)**：\n    *   对于测试用例中的每个单元，处理其顶点坐标集。\n    *   计算每对不同顶点之间的欧几里得距离。为此使用 `scipy.spatial.distance.pdist`。\n    *   这些距离的最小值是该单元的特征长度 $ \\Delta x_e $。\n    *   测试用例的 $ \\Delta x_{\\min} $ 是所有 $ \\Delta x_e $ 的最小值。\n\n4.  **稳定时间步长计算 ($ \\Delta t_{\\text{stable}} $)**：\n    *   使用推导出的公式为每个案例计算最终的稳定时间步长：$ \\Delta t_{\\text{stable}} = \\frac{1}{\\sqrt{d}} \\frac{\\Delta x_{\\min}}{c_{\\max}} $。\n\n将此过程应用于三个测试用例中的每一个，并收集得到的稳定时间步长。", "answer": "$$\n\\boxed{[0.001249, 0.000806, 0.000109]}\n$$", "id": "3573435"}]}