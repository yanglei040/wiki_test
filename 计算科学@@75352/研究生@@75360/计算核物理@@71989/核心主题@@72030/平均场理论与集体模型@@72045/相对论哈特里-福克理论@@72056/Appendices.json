{"hands_on_practices": [{"introduction": "与简单的Hartree近似相比，Hartree-Fock理论的决定性特征是包含了源于费米子波函数反对称性的Fock交换项。本练习将让您亲身体验如何量化其重要性。通过对一个均匀核物质与Yukawa相互作用的标准模型，解析计算Fock与Hartree平均场势的比值，您将对这些关键交换效应在何种条件下变得显著建立起具体的直觉 [@problem_id:3587194]。", "problem": "考虑在零温下、无海近似中、由相对论性哈特里-福克理论描述的均匀、自旋饱和、对称核物质。忽略延迟效应和张量分量，并专注于两个洛伦兹渠道：一个标量汤川交换（代表一个标量介子）和一个类时矢量汤川交换（代表一个矢量介子的时间分量）。在每个渠道中，动量空间相互作用采用有限程汤川形式 $V_{X}(\\mathbf{q}) = \\pm \\frac{g_{X}^{2}}{\\mathbf{q}^{2} + \\mu_{X}^{2}}$，其中 $X \\in \\{S,V\\}$ 标记标量（$S$）或矢量（$V$），$g_{X}$ 是耦合常数，$\\mu_{X}$ 是交换玻色子的逆作用程（质量参数）。在静态极限下进行研究，并且为了比较大小，将狄拉克迹近似为其领先的静态值（取 $M/E \\approx 1$ 并仅对矢量渠道保留类时部分）。考虑单一自旋-同位旋种类，因此数密度为 $ \\rho = \\frac{k_{F}^{3}}{6\\pi^{2}}$，其中 $k_{F}$ 是费米动量。\n\n从均匀物质在动量空间中的哈特里和福克平均场的基本定义出发，\n- 哈特里大小：$|\\Sigma^{H}_{X}| = \\frac{g_{X}^{2}}{\\mu_{X}^{2}}\\,\\rho$，\n- 费米面上的福克大小：$|\\Sigma^{F}_{X}(k_{F})| = \\frac{g_{X}^{2}}{(2\\pi)^{3}} \\int_{|\\mathbf{p}| \\le k_{F}} \\frac{d^{3}p}{(\\mathbf{k}_{F} - \\mathbf{p})^{2} + \\mu_{X}^{2}}$，\n\n从第一性原理推导无量纲比率\n$$\nR_{X}(k_{F},\\mu_{X}) \\equiv \\frac{|\\Sigma^{F}_{X}(k_{F})|}{|\\Sigma^{H}_{X}|}\n$$\n的闭合形式解析表达式，仅表示为无量纲参数 $x_{X} \\equiv \\frac{\\mu_{X}}{k_{F}}$ 的函数。\n\n您的推导必须从上述定义开始，通过精确的角度积分将三维福克积分转换为一维形式，并对其进行解析计算以获得闭合形式的结果。您必须将最终答案呈现为一个单一、简化的解析表达式 $R(x)$，该表达式在替换 $x \\to x_{S}$ 或 $x \\to x_{V}$ 后适用于任一渠道，并因此量化了交换（福克）贡献相对于哈特里贡献在数值上何时是显著的（大的 $R$）。不需要进行数值代入；以 $x$ 的闭合形式表达式给出最终答案。不要提供任何不等式或定性标准作为您的最终答案；只提供该单一的解析表达式。", "solution": "问题要求推导无量纲比率 $R_{X}(k_{F},\\mu_{X}) \\equiv \\frac{|\\Sigma^{F}_{X}(k_{F})|}{|\\Sigma^{H}_{X}|}$ 的闭合形式解析表达式，其中 $X$ 表示标量（$S$）或矢量（$V$）介子交换渠道。推导将从所提供的均匀核物质的哈特里和福克平均场大小的定义出发。所有数学实体将根据格式要求以 LaTeX 书写。\n\n给定的大小为：\n哈特里项：$|\\Sigma^{H}_{X}| = \\frac{g_{X}^{2}}{\\mu_{X}^{2}}\\,\\rho$，数密度为 $\\rho = \\frac{k_{F}^{3}}{6\\pi^{2}}$。\n费米面上的福克项（$|\\mathbf{k}|=k_F$）：$|\\Sigma^{F}_{X}(k_{F})| = \\frac{g_{X}^{2}}{(2\\pi)^{3}} \\int_{|\\mathbf{p}| \\le k_{F}} \\frac{d^{3}p}{(\\mathbf{k}_{F} - \\mathbf{p})^{2} + \\mu_{X}^{2}}$。\n\n我们的核心任务是计算福克项表达式中的积分。我们用 $I$ 表示这个积分：\n$$\nI = \\int_{|\\mathbf{p}| \\le k_{F}} \\frac{d^{3}p}{(\\mathbf{k}_{F} - \\mathbf{p})^{2} + \\mu_{X}^{2}}\n$$\n我们展开分母：$(\\mathbf{k}_{F} - \\mathbf{p})^{2} = |\\mathbf{k}_F|^2 - 2\\mathbf{k}_F\\cdot\\mathbf{p} + |\\mathbf{p}|^2 = k_{F}^{2} - 2k_F p \\cos\\theta + p^2$，其中 $\\theta$ 是 $\\mathbf{k}_F$ 和 $\\mathbf{p}$ 之间的夹角。不失一般性，我们可以将 $z$ 轴与 $\\mathbf{k}_F$ 对齐。球坐标系中的体积元是 $d^3p = p^2 \\sin\\theta \\,dp\\,d\\theta\\,d\\phi$。\n\n积分变为：\n$$\nI = \\int_{0}^{k_F} p^2 dp \\int_{0}^{\\pi} \\sin\\theta d\\theta \\int_{0}^{2\\pi} d\\phi \\frac{1}{k_F^2 + p^2 - 2k_F p \\cos\\theta + \\mu_X^2}\n$$\n关于方位角 $\\phi$ 的积分是平凡的，得到一个因子 $2\\pi$。\n$$\nI = 2\\pi \\int_{0}^{k_F} p^2 dp \\int_{0}^{\\pi} \\frac{\\sin\\theta d\\theta}{k_F^2 + p^2 + \\mu_X^2 - 2k_F p \\cos\\theta}\n$$\n为了求解关于 $\\theta$ 的内层积分，我们进行换元 $u = \\cos\\theta$，这意味着 $du = -\\sin\\theta d\\theta$。积分限从 $[0, \\pi]$ 变为 $[1, -1]$。\n$$\n\\int_{0}^{\\pi} \\frac{\\sin\\theta d\\theta}{A - B \\cos\\theta} = \\int_{1}^{-1} \\frac{-du}{A - Bu} = \\int_{-1}^{1} \\frac{du}{A - Bu}\n$$\n其中 $A = k_F^2 + p^2 + \\mu_X^2$ 且 $B = 2k_F p$。该积分为初等积分：\n$$\n\\int_{-1}^{1} \\frac{du}{A - Bu} = \\left[-\\frac{1}{B} \\ln|A - Bu|\\right]_{-1}^{1} = -\\frac{1}{B} (\\ln|A-B| - \\ln|A+B|) = \\frac{1}{B} \\ln\\left|\\frac{A+B}{A-B}\\right|\n$$\n将 $A$ 和 $B$ 代回：\n$A+B = k_F^2 + p^2 + \\mu_X^2 + 2k_F p = (k_F+p)^2 + \\mu_X^2$\n$A-B = k_F^2 + p^2 + \\mu_X^2 - 2k_F p = (k_F-p)^2 + \\mu_X^2$\n角度积分计算结果为：\n$$\n\\frac{1}{2k_F p} \\ln\\left(\\frac{(k_F+p)^2 + \\mu_X^2}{(k_F-p)^2 + \\mu_X^2}\\right)\n$$\n现在，我们将此结果代回到 $I$ 的表达式中：\n$$\nI = 2\\pi \\int_{0}^{k_F} p^2 dp \\left[ \\frac{1}{2k_F p} \\ln\\left(\\frac{(k_F+p)^2 + \\mu_X^2}{(k_F-p)^2 + \\mu_X^2}\\right) \\right] = \\frac{\\pi}{k_F} \\int_{0}^{k_F} p \\ln\\left(\\frac{(k_F+p)^2 + \\mu_X^2}{(k_F-p)^2 + \\mu_X^2}\\right) dp\n$$\n这个积分可以用分部积分法求解，$\\int u \\, dv = uv - \\int v \\, du$。令：\n$u = \\ln\\left(\\frac{(k_F+p)^2 + \\mu_X^2}{(k_F-p)^2 + \\mu_X^2}\\right) = \\ln((k_F+p)^2 + \\mu_X^2) - \\ln((k_F-p)^2 + \\mu_X^2)$\n$dv = p \\, dp \\implies v = \\frac{p^2}{2}$\n则 $du = \\left( \\frac{2(k_F+p)}{(k_F+p)^2+\\mu_X^2} - \\frac{2(k_F-p)(-1)}{(k_F-p)^2+\\mu_X^2} \\right) dp = 2\\left(\\frac{k_F+p}{(k_F+p)^2+\\mu_X^2} + \\frac{k_F-p}{(k_F-p)^2+\\mu_X^2}\\right) dp$。\n\n通过对剩余积分进行冗长但直接的计算，我们得到：\n$$\n\\int_{0}^{k_F} p \\ln\\left(\\frac{(k_F+p)^2 + \\mu_X^2}{(k_F-p)^2 + \\mu_X^2}\\right) dp = 2k_F^2 + \\frac{\\mu_X^2}{2}\\ln\\left(1+\\frac{4k_F^2}{\\mu_X^2}\\right) - 2k_F\\mu_X \\arctan\\left(\\frac{2k_F}{\\mu_X}\\right)\n$$\n将此结果代入 $I$ 的表达式：\n$$\nI = \\frac{\\pi}{k_F} \\left[ 2k_F^2 + \\frac{\\mu_X^2}{2} \\ln\\left(1+\\frac{4k_F^2}{\\mu_X^2}\\right) - 2k_F\\mu_X \\arctan\\left(\\frac{2k_F}{\\mu_X}\\right) \\right]\n$$\n$$\nI = 2\\pi k_F + \\frac{\\pi\\mu_X^2}{2k_F} \\ln\\left(1+\\frac{4k_F^2}{\\mu_X^2}\\right) - 2\\pi\\mu_X \\arctan\\left(\\frac{2k_F}{\\mu_X}\\right)\n$$\n现在我们求 $|\\Sigma^{F}_{X}(k_{F})|$：\n$$\n|\\Sigma^{F}_{X}(k_{F})| = \\frac{g_X^2}{(2\\pi)^3} I = \\frac{g_X^2}{8\\pi^2} \\left[ 2k_F + \\frac{\\mu_X^2}{2k_F} \\ln\\left(1+\\frac{4k_F^2}{\\mu_X^2}\\right) - 2\\mu_X \\arctan\\left(\\frac{2k_F}{\\mu_X}\\right) \\right]\n$$\n比率 $R_X$ 定义为：\n$$\nR_{X} = \\frac{|\\Sigma^{F}_{X}(k_{F})|}{|\\Sigma^{H}_{X}|} = \\frac{\\frac{g_X^2}{8\\pi^2} \\left[ 2k_F + \\frac{\\mu_X^2}{2k_F} \\ln\\left(1+\\frac{4k_F^2}{\\mu_X^2}\\right) - 2\\mu_X \\arctan\\left(\\frac{2k_F}{\\mu_X}\\right) \\right]}{\\frac{g_X^2}{\\mu_X^2} \\frac{k_F^3}{6\\pi^2}}\n$$\n简化常数并消去 $g_X^2$：\n$$\nR_X = \\frac{6\\pi^2\\mu_X^2}{8\\pi^2 k_F^3} \\left[ 2k_F + \\frac{\\mu_X^2}{2k_F} \\ln\\left(1+\\frac{4k_F^2}{\\mu_X^2}\\right) - 2\\mu_X \\arctan\\left(\\frac{2k_F}{\\mu_X}\\right) \\right]\n$$\n$$\nR_X = \\frac{3\\mu_X^2}{4k_F^3} \\left[ 2k_F + \\frac{\\mu_X^2}{2k_F} \\ln\\left(1+\\frac{4k_F^2}{\\mu_X^2}\\right) - 2\\mu_X \\arctan\\left(\\frac{2k_F}{\\mu_X}\\right) \\right]\n$$\n分配前置因子：\n$$\nR_X = \\frac{3\\mu_X^2 \\cdot 2k_F}{4k_F^3} + \\frac{3\\mu_X^2 \\cdot \\mu_X^2}{4k_F^3 \\cdot 2k_F} \\ln\\left(1+\\frac{4k_F^2}{\\mu_X^2}\\right) - \\frac{3\\mu_X^2 \\cdot 2\\mu_X}{4k_F^3} \\arctan\\left(\\frac{2k_F}{\\mu_X}\\right)\n$$\n$$\nR_X = \\frac{3\\mu_X^2}{2k_F^2} + \\frac{3\\mu_X^4}{8k_F^4} \\ln\\left(1+\\frac{4k_F^2}{\\mu_X^2}\\right) - \\frac{3\\mu_X^3}{2k_F^3} \\arctan\\left(\\frac{2k_F}{\\mu_X}\\right)\n$$\n最后，我们用无量纲参数 $x = x_X = \\frac{\\mu_X}{k_F}$ 来表示结果。\n$$\nR(x) = \\frac{3}{2}\\left(\\frac{\\mu_X}{k_F}\\right)^2 + \\frac{3}{8}\\left(\\frac{\\mu_X}{k_F}\\right)^4 \\ln\\left(1+4\\left(\\frac{k_F}{\\mu_X}\\right)^2\\right) - \\frac{3}{2}\\left(\\frac{\\mu_X}{k_F}\\right)^3 \\arctan\\left(2\\frac{k_F}{\\mu_X}\\right)\n$$\n代入 $x$ 和 $1/x$：\n$$\nR(x) = \\frac{3}{2}x^2 + \\frac{3}{8}x^4 \\ln\\left(1+\\frac{4}{x^2}\\right) - \\frac{3}{2}x^3 \\arctan\\left(\\frac{2}{x}\\right)\n$$\n这就是所要求的比率的闭合形式解析表达式。", "answer": "$$\n\\boxed{\\frac{3}{2}x^2 + \\frac{3}{8}x^4 \\ln\\left(1+\\frac{4}{x^2}\\right) - \\frac{3}{2}x^3 \\arctan\\left(\\frac{2}{x}\\right)}\n$$", "id": "3587194"}, {"introduction": "在确定了非局域交换项的重要性之后，下一个关键问题是如何求解由此产生的复杂的自洽方程。本练习将重点从解析推导转向任何RHF计算核心的计算引擎设计。您将分析一个稳健的自洽场（SCF）迭代的结构，包括诸如收敛加速方案（例如DIIS）和验证是否已找到真实解的可靠诊断方法等基本组成部分 [@problem_id:3587200]。", "problem": "考虑有限原子核的相对论 Hartree–Fock (RHF) 理论，其中单体密度算符 $P$ 由已占据的 Dirac 旋量 $\\{ \\lvert \\psi_i \\rangle \\}$ 通过 $P = \\sum_{i \\in \\mathrm{occ}} \\lvert \\psi_i \\rangle \\langle \\psi_i \\rvert$ 构建。自洽平均场由一个 Dirac–Fock 单体算符 $h[P]$ 决定，该算符通过由核子密度和流构建的局域 Hartree 场与非局域 Fock 交换核，在泛函上依赖于 $P$。RHF 方程源于能量泛函 $E[P]$ 在已占据轨道幺正旋转下的定态性，并要求 $P$ 投影到 $h[P]$ 的一个不变子空间上。\n\n实际计算通过不动点迭代进行：给定一个输入密度 $P_n$，构建 $h[P_n]$，求解 Dirac 单粒子问题以获得一组新的已占据轨道，并形成一个“输出”密度 $P_n^{\\mathrm{out}}$；对过去的迭代进行适当混合可以稳定并加速收敛。必须设计收敛诊断方法，以便在谱是离散的且场是有限程的有限原子核中可靠地检测自洽性。\n\n以下哪个/哪些选项正确地概述了在有限原子核中，使用 Pulay 直接迭代子空间反演 (DIIS) 或 Anderson 混合方法进行 RHF 的稳健自洽场 (SCF) 迭代，并提出了基于残差范数和能量方差判据的、有科学依据的收敛诊断？选择所有适用项。\n\nA. 将 SCF 残差定义为在单粒子基中表示的对易子 $e_n = [\\, h[P_n] , P_n \\,]$，并监控其 Frobenius 范数 $\\lVert e_n \\rVert_{\\mathrm{F}}$。通过构建由残差 $\\{ e_{n-m+1}, \\dots, e_n \\}$ 和对应的“输出”密度 $\\{ P_{n-m+1}^{\\mathrm{out}}, \\dots, P_n^{\\mathrm{out}} \\}$ 组成的迭代子空间来实现 Pulay DIIS。确定系数 $\\{ b_j \\}$，使其在 $\\sum_j b_j = 1$ 的约束下最小化范数 $\\left\\lVert \\sum_{j} b_j e_j \\right\\rVert_{\\mathrm{F}}$，并形成混合密度 $P_{n+1}^{\\mathrm{mix}} = \\sum_j b_j P_j^{\\mathrm{out}}$。然后通过求解 $h[P_{n+1}^{\\mathrm{mix}}]$ 并投影到已占据态上来定义 $P_{n+1}$，从而强制实现幂等性和正交归一性。通过同时要求 $\\lVert e_n \\rVert_{\\mathrm{F}}  \\varepsilon$ 和单体平均场能量方差 $\\sigma_{h}^2(P_n) = \\sum_{i \\in \\mathrm{occ}} \\left( \\langle \\psi_i \\lvert h[P_n]^2 \\rvert \\psi_i \\rangle - \\langle \\psi_i \\lvert h[P_n] \\rvert \\psi_i \\rangle^2 \\right)  \\delta$ 趋于零来诊断收敛，其中 $\\varepsilon$ 和 $\\delta$ 是选定的容差。\n\nB. 使用 Anderson 混合进行更新 $P_{n+1} = P_n^{\\mathrm{out}} + \\sum_{j=1}^{m} c_j \\left( P_{n-j}^{\\mathrm{out}} - P_{n-j} \\right)$，其中系数 $\\{ c_j \\}$ 是任意的固定常数。对于收敛，仅需监控总能量的变化 $\\Delta E_n = E[P_n^{\\mathrm{out}}] - E[P_n]$ 即可；如果即使在残差仍然有限的情况下 $\\Delta E_n$ 停止减小，就宣布收敛。\n\nC. 将残差定义为 $r_n = P_n - P_{n-1}$，并将诊断能量方差取为 $\\sigma_E^2(P_n) = \\lVert H \\rVert^2 - \\lVert E[P_n] \\rVert^2$，其中 $H$ 是完整的 Dirac 多体哈密顿算符。因为 RHF 是相对论性的，Dirac 算符不是厄米的，所以能量方差诊断不适用；因此，收敛必须完全基于残差 $r_n$。\n\nD. 从已占据-非占据轨道幺正旋转下的 RHF 变分原理出发，将残差定义为当前基中 Dirac–Fock 矩阵的占据-非占据块，等价于 $e_n = [\\, h[P_n] , P_n \\,]$。要求 $\\lVert e_n \\rVert \\to 0$ 以达到自洽。作为一种补充诊断方法，计算单体平均场能量方差 $\\sigma_{h}^2(P_n) = \\sum_{i \\in \\mathrm{occ}} \\left( \\langle \\psi_i \\lvert h[P_n]^2 \\rvert \\psi_i \\rangle - \\langle \\psi_i \\lvert h[P_n] \\rvert \\psi_i \\rangle^2 \\right)$，当每个已占据的 $\\lvert \\psi_i \\rangle$ 都是 $h[P_n]$ 的本征态时，该方差为零。使用 Pulay DIIS 或 Anderson 混合来加速不动点迭代，确保混合变量是厄米的，并在每一步都投影回一个幂等的 $P$。\n\nE. 因为在 RHF 中， $P$ 的幂等性必须在每个中间步骤都得到保持，所以只有轨道的幺正混合是允许的；Pulay DIIS 不适用，因为组合密度或 Fock 算符会破坏正交归一性，而 Anderson 混合不能用于有限原子核。", "solution": "首先必须评估问题陈述的有效性。\n\n### 第一步：提取已知信息\n-   **理论框架**：有限原子核的相对论 Hartree–Fock (RHF) 理论。\n-   **密度算符**：单体密度算符为 $P = \\sum_{i \\in \\mathrm{occ}} \\lvert \\psi_i \\rangle \\langle \\psi_i \\rvert$，由已占据的 Dirac 旋量 $\\{ \\lvert \\psi_i \\rangle \\}$ 构建。\n-   **平均场算符**：自洽平均场由 Dirac–Fock 单体算符 $h[P]$ 表示，它是 $P$ 的一个泛函。它对 $P$ 的依赖性源于局域 Hartree 场和非局域 Fock 交换核。\n-   **主导原理**：RHF 方程源于能量泛函 $E[P]$ 在已占据轨道幺正旋转下的定态性。\n-   **自洽条件**：收敛时，$P$ 必须投影到 $h[P]$ 的一个不变子空间上。\n-   **数值步骤**：使用不动点迭代：用输入密度 $P_n$ 构建 $h[P_n]$；求解 $h[P_n]$ 的特征值问题得到新的轨道，用这些轨道形成输出密度 $P_n^{\\mathrm{out}}$。\n-   **收敛加速**：提到了诸如 Pulay DIIS 或 Anderson 混合等方法来稳定和加速收敛。\n-   **系统特性**：问题涉及有限原子核，其具有离散能谱和有限程场。\n-   **问题**：任务是确定哪个/哪些选项正确描述了使用 DIIS 或 Anderson 混合的 RHF 稳健自洽场 (SCF) 迭代，并提出了基于残差范数和能量方差判据的有科学依据的收敛诊断。\n\n### 第二步：使用提取的已知信息进行验证\n问题陈述描述了相对论 Hartree-Fock 理论的标准理论和计算框架，这是*从头计算*核结构计算的基石。\n\n-   **科学依据充分**：所有提出的概念——RHF 能量泛函、Dirac-Fock 算符 $h[P]$、密度矩阵 $P$、SCF 迭代循环以及像 DIIS 这样的收敛加速技术——在计算量子多体物理学中都是标准的、成熟的。自洽条件，表述为 $P$ 投影到 $h[P]$ 的一个不变子空间上，在数学上等价于对易子 $[h[P], P]$ 为零，这是求解 Hartree-Fock 方程的基本条件。该描述在事实上和科学上都是合理的。\n-   **定义明确**：问题定义明确，要求根据既定原则评估所提出的计算程序和诊断方法。问题具体，并允许根据该领域的专业知识得出明确的答案。\n-   **客观性**：语言技术性强、精确，没有主观性或歧义。\n\n问题陈述没有可识别的缺陷。它没有违反任何科学原理，不是不完整或矛盾的，并且与指定的主题直接相关。\n\n### 第三步：结论和行动\n问题是有效的。现在有必要对每个选项进行详细分析。\n\n稳健 SCF 程序的核心在于两大支柱：对要最小化的残差的正确定义，以及确认收敛的可靠诊断。\n\n自洽性的基本条件是已占据轨道张成 Fock 算符 $h[P]$ 的一个不变子空间。这等价于 Fock 算符和密度矩阵对易的条件：\n$$[h[P], P] = 0$$\n此方程的左边是 SCF 残差最自然、最稳健的定义。随着迭代的收敛，其范数必须趋于零。\n\n一个强大的辅助诊断是单体 Fock 算符相对于单粒子轨道的方差。在收敛时，轨道 $\\{|\\psi_i\\rangle\\}$ 是最终 Fock 算符 $h$ 的本征态。对于任何本征态，算符的方差为零。因此，量\n$$ \\sigma_{h}^2(P) = \\sum_{i \\in \\mathrm{occ}} \\left( \\langle \\psi_i \\lvert h[P]^2 \\rvert \\psi_i \\rangle - \\langle \\psi_i \\lvert h[P] \\rvert \\psi_i \\rangle^2 \\right) $$\n在自洽时必须为零。这为解的质量提供了补充性的检验。Dirac-Fock 算符 $h[P]$ 是自伴的，所以这个方差是一个定义明确的非负量。\n\n像 Pulay DIIS 和 Anderson 混合这样的收敛加速方案是标准的。它们通过形成先前迭代（或其相关算符/密度）的最优线性组合来运作，以推断出下一次迭代的更好猜测。混合密度矩阵或 Fock 算符的方法的一个关键特征是，得到的混合矩阵（例如 $P_{\\mathrm{mix}}$）通常不是幂等的（$P_{\\mathrm{mix}}^2 \\neq P_{\\mathrm{mix}}$）。因此，一个强制性步骤是根据这个混合矩阵构建一个新的 Fock 算符，对其进行对角化，并从其能量最低的本征函数构建一个新的、幂等的密度矩阵。\n\n在确立了这些原则之后，我们来评估每个选项。\n\n**A. 将 SCF 残差定义为在单粒子基中表示的对易子 $e_n = [\\, h[P_n] , P_n \\,]$，并监控其 Frobenius 范数 $\\lVert e_n \\rVert_{\\mathrm{F}}$。通过构建由残差 $\\{ e_{n-m+1}, \\dots, e_n \\}$ 和对应的“输出”密度 $\\{ P_{n-m+1}^{\\mathrm{out}}, \\dots, P_n^{\\mathrm{out}} \\}$ 组成的迭代子空间来实现 Pulay DIIS。确定系数 $\\{ b_j \\}$，使其在 $\\sum_j b_j = 1$ 的约束下最小化范数 $\\left\\lVert \\sum_{j} b_j e_j \\right\\rVert_{\\mathrm{F}}$，并形成混合密度 $P_{n+1}^{\\mathrm{mix}} = \\sum_j b_j P_j^{\\mathrm{out}}$。然后通过求解 $h[P_{n+1}^{\\mathrm{mix}}]$ 并投影到已占据态上来定义 $P_{n+1}$，从而强制实现幂等性和正交归一性。通过同时要求 $\\lVert e_n \\rVert_{\\mathrm{F}}  \\varepsilon$ 和单体平均场能量方差 $\\sigma_{h}^2(P_n) = \\sum_{i \\in \\mathrm{occ}} \\left( \\langle \\psi_i \\lvert h[P_n]^2 \\rvert \\psi_i \\rangle - \\langle \\psi_i \\lvert h[P_n] \\rvert \\psi_i \\rangle^2 \\right)  \\delta$ 趋于零来诊断收敛，其中 $\\varepsilon$ 和 $\\delta$ 是选定的容差。**\n\n此选项提出了一个完整且正确的算法。\n1.  残差被正确定义为对易子 $e_n = [h[P_n], P_n]$。\n2.  对 Pulay DIIS 方法的描述是准确的，包括最小化残差范数和形成混合输出密度。这是 DIIS 的一个已知的有效变体。\n3.  它正确地指出了恢复幂等性的关键步骤，即基于混合密度构建并对角化 Fock 算符。措辞“求解 $h[P_{n+1}^{\\mathrm{mix}}]$”是“求解由 $P_{n+1}^{\\mathrm{mix}}$ 构建的算符 $h$ 的特征值问题”的常用简写。\n4.  它提出了两种优秀的、互补的、有科学依据的收敛诊断：对易子残差的范数和单体平均场能量方差。\n**结论：正确。**\n\n**B. 使用 Anderson 混合进行更新 $P_{n+1} = P_n^{\\mathrm{out}} + \\sum_{j=1}^{m} c_j \\left( P_{n-j}^{\\mathrm{out}} - P_{n-j} \\right)$，其中系数 $\\{ c_j \\}$ 是任意的固定常数。对于收敛，仅需监控总能量的变化 $\\Delta E_n = E[P_n^{\\mathrm{out}}] - E[P_n]$ 即可；如果即使在残差仍然有限的情况下 $\\Delta E_n$ 停止减小，就宣布收敛。**\n\n此选项包含两个主要错误。\n1.  在 Anderson 混合中，系数 $\\{c_j\\}$ *不是*任意的固定常数。它们是在每次迭代中通过解决一个小型线性最小二乘问题来确定的，这正是该方法威力的本质所在。\n2.  仅依赖于总能量的变化 $\\Delta E_n$ 是一个众所周知的不可靠的收敛判据。SCF 迭代可能会停滞，导致 $\\Delta E_n$ 非常小，而波函数仍远离真正的自洽解。在残差有限的情况下宣布收敛是不正确的。\n**结论：错误。**\n\n**C. 将残差定义为 $r_n = P_n - P_{n-1}$，并将诊断能量方差取为 $\\sigma_E^2(P_n) = \\lVert H \\rVert^2 - \\lVert E[P_n] \\rVert^2$，其中 $H$ 是完整的 Dirac 多体哈密顿算符。因为 RHF 是相对论性的，Dirac 算符不是厄米的，所以能量方差诊断不适用；因此，收敛必须完全基于残差 $r_n$。**\n\n此选项在多个方面存在缺陷。\n1.  所提出的能量方差 $\\sigma_E^2(P_n) = \\lVert H \\rVert^2 - \\lVert E[P_n] \\rVert^2$ 是一个无意义的表达式。$H$ 是一个算符，而 $E[P_n]$ 是一个标量能量值。不能从一个算符的范数平方中减去一个标量的范数平方。多体哈密顿算符方差的正确表达式应为 $\\langle \\Phi | H^2 | \\Phi \\rangle - (\\langle \\Phi | H | \\Phi \\rangle)^2$，但对于 Hartree-Fock 态，此方差通常不为零。\n2.  关于 Dirac 算符不是厄米算符以及方差诊断不适用的说法是错误的。RHF 中使用的单体 Dirac-Fock 算符 $h[P]$ 是自伴的，其特征值是实数，其方差是完全定义明确且有意义的诊断方法，如上所述。\n3.  选择残差 $r_n = P_n - P_{n-1}$ 是一个比 $[h, P]$ 更不直接的自洽性度量。\n**结论：错误。**\n\n**D. 从已占据-非占据轨道幺正旋转下的 RHF 变分原理出发，将残差定义为当前基中 Dirac–Fock 矩阵的占据-非占据块，等价于 $e_n = [\\, h[P_n] , P_n \\,]$。要求 $\\lVert e_n \\rVert \\to 0$ 以达到自洽。作为一种补充诊断方法，计算单体平均场能量方差 $\\sigma_{h}^2(P_n) = \\sum_{i \\in \\mathrm{occ}} \\left( \\langle \\psi_i \\lvert h[P_n]^2 \\rvert \\psi_i \\rangle - \\langle \\psi_i \\lvert h[P_n] \\rvert \\psi_i \\rangle^2 \\right)$，当每个已占据的 $\\lvert \\psi_i \\rangle$ 都是 $h[P_n]$ 的本征态时，该方差为零。使用 Pulay DIIS 或 Anderson 混合来加速不动点迭代，确保混合变量是厄米的，并在每一步都投影回一个幂等的 $P$。**\n\n此选项对稳健的 SCF 程序提供了正确且概念上合理的概述。\n1.  它正确地将变分原理与 Fock 矩阵的占据-非占据块为零的条件联系起来，并正确地将其等同于对易子残差 $[h, P]$。\n2.  它提出了正确的单体能量方差作为补充诊断，并准确解释了其理由。\n3.  它正确地提到了使用标准加速方案（DIIS, Anderson）以及投影回幂等密度矩阵这一基本步骤。\n此选项描述了实现稳健计算必须遵循的核心原则，与既定方法论完全一致。\n**结论：正确。**\n\n**E. 因为在 RHF 中， $P$ 的幂等性必须在每个中间步骤都得到保持，所以只有轨道的幺正混合是允许的；Pulay DIIS 不适用，因为组合密度或 Fock 算符会破坏正交归一性，而 Anderson 混合不能用于有限原子核。**\n\n此选项基于根本性的误解。\n1.  幂等性*不*需要在每个中间步骤都得到保持。像 DIIS 这样的有效方法在外推步骤中会暂时破坏幂等性，并通过对角化来恢复它，正如选项 A 和 D 中正确描述的那样。\n2.  声称 DIIS 不适用的说法是错误的。它是 SCF 计算中使用最广泛、最成功的加速技术之一，正是因为对幂等性/正交归一性的违反是暂时的并且得到了正确处理。\n3.  声称 Anderson 混合不能用于有限原子核的说法是毫无根据的。它是一种通用的数值方法，适用于有限维向量空间中的不动点问题，这正是在有限原子核中进行基组 RHF 计算的情况。\n**结论：错误。**\n\n总而言之，选项 A 和 D 都对稳健的 RHF-SCF 程序给出了正确的描述。选项 A 给出了一个详细、具体的算法，而选项 D 提出了核心概念和原理。根据问题的要求，两者都是有效和正确的概述。", "answer": "$$\\boxed{AD}$$", "id": "3587200"}, {"introduction": "像RHF这样的理论框架的最终目标是解释和预测物理现象。这最后一个练习搭建了从抽象理论到可测量数据之间的桥梁。通过一个基于简化但富有洞察力的模型的手动编码练习，您将直接研究包含精确的库仑交换项如何影响一系列同位素的电荷半径计算，从而展示理论上的改进如何转化为诸如同位素位移等可观测效应 [@problem_id:3587241]。", "problem": "要求您实现并分析在相对论Hartree-Fock (RHF) 理论中，库仑场的精确交换贡献对一系列锡 (Sn) 同位素（质子数 $Z=50$）的同位素位移的影响。目标是计算，当库仑场仅在Hartree水平处理与在包含精确库仑交换的Hartree-Fock水平处理时，所选同位素的均方电荷半径 $\\delta\\langle r^2\\rangle$ 的变化。您的程序必须为固定的同位素测试套件生成所要求的输出，格式需符合规定，且所有半径均以 $\\mathrm{fm}^2$ 为单位报告。\n\n基本出发点和物理原理：\n1. 电磁相互作用由Maxwell方程组支配，在静态极限下由静电学支配。对于多费米子体系，相互作用的能量可以使用Hartree-Fock方法描述，该方法从反对称的Slater行列式出发，对任何两体相互作用都产生一个直接项 (Hartree项) 和一个非定域的精确交换项 (Fock项)。这对质子间的库仑相互作用同样成立。\n2. 在相对论Hartree-Fock (RHF) 理论中，单粒子质子态是Dirac旋量，受核起源的标量和矢量平均场以及质子电磁场的作用。对于主要依赖于全局几何尺度（例如半径）的宏观可观测量，将质子分布近似为半径为 $R$ 的球形核体积内的均匀分布，是科学上合理的，这与液滴模型的唯象学一致。同时，像在均匀质子费米气体中那样精确处理库仑交换也是合理的。\n3. 对于密度为 $n_p$ 的均匀质子费米气体，从Hartree-Fock导出的库仑相互作用的精确交换能量密度是良定义的，并且可以在核体积上积分。这产生一个与 $R^{-1}$ 成正比的交换能，类似于均匀带电球体的Hartree能量。\n\n建模假设与计算任务：\n- 假设每个锡同位素都是一个球形核，其半径为 $R$，球内质子密度均匀，质子数 $Z=50$ 固定，总核子数 $A$ 随同位素链中子数的变化而变化。\n- 每个同位素的半径 $R$ 通过最小化总能量 $E(R)$ 来确定，该能量包括：\n  - 一个体核弹性项，模拟朝向参考核尺寸的宏观恢复趋势，表示为围绕参考半径 $R_0(A)=r_0 A^{1/3}$ 的 $R$ 的二次惩罚项，其刚度与 $A$ 成正比，以反映核体响应的广延性。\n  - 半径为 $R$、电荷为 $Z e$ 的均匀带电球体的库仑直接 (Hartree) 能量。\n  - 通过对密度为 $n_p=Z/V$（其中 $V=(4\\pi/3) R^3$）的均匀质子费米气体的Hartree-Fock交换能量密度进行积分所获得的精确库仑交换 (Fock) 能量。\n\n您的实现必须：\n- 将总能量定义为 $R$ 和 $A$ 的函数，\n  $$E(R;A) = \\frac{1}{2} C(A) \\left[R - R_0(A)\\right]^2 + \\frac{A_{\\mathrm{C}}(Z)}{R} + \\frac{A_{\\mathrm{x}}(Z)}{R},$$\n  其中 $C(A)$ 是一个广延刚度，$A_{\\mathrm{C}}(Z)$ 是均匀带电球体的库仑Hartree系数，$A_{\\mathrm{x}}(Z)$ 是均匀质子费米气体的精确库仑交换系数。当排除交换作用时，设置 $A_{\\mathrm{x}}(Z)=0$。\n- 使用 $R_0(A)=r_0 A^{1/3}$（其中 $r_0$ 在下面指定）和 $C(A)=\\kappa A$（其中 $\\kappa$ 作为刚度常数在下面指定）。库仑Hartree系数必须从均匀带电球体的静电学导出，精确库仑交换系数必须通过对均匀质子费米气体的Hartree-Fock交换能量密度进行积分来导出。\n- 关于 $R>0$ 最小化 $E(R;A)$ 以确定平衡半径 $R^\\ast(A)$，针对两种情况：\n  1. 仅Hartree：$A_{\\mathrm{x}}(Z)=0$，\n  2. Hartree-Fock (包含精确交换)：$A_{\\mathrm{x}}(Z)\\neq 0$ 按推导值。\n- 对每种情况，计算均方电荷半径为\n  $$\\langle r^2 \\rangle = \\frac{3}{5} \\left[R^\\ast(A)\\right]^2,$$\n  并评估相对于参考同位素 $A_{\\mathrm{ref}}=120$ 的同位素位移，\n  $$\\delta\\langle r^2 \\rangle(A) = \\langle r^2 \\rangle(A) - \\langle r^2 \\rangle(A_{\\mathrm{ref}}),$$\n  单位为 $\\mathrm{fm}^2$。\n- 为每个测试同位素报告三个数值：\n  - 无交换作用时的 $\\delta\\langle r^2 \\rangle$ (仅Hartree)，\n  - 有精确交换作用时的 $\\delta\\langle r^2 \\rangle$ (Hartree-Fock)，\n  - 两种位移之差 (Hartree-Fock 减去 仅Hartree)，均以 $\\mathrm{fm}^2$ 为单位。\n\n所需常数和单位：\n- 对锡使用 $Z=50$。\n- 使用 $r_0=1.2\\,\\mathrm{fm}$。\n- 使用 $\\kappa=5.0\\,\\mathrm{MeV}/\\mathrm{fm}$。\n- 使用 $e^2=1.43996448\\,\\mathrm{MeV}\\cdot\\mathrm{fm}$。\n- 角度不出现；所有量都应采用与上述一致的核距离和能量单位。\n- 所有与半径相关的输出均以 $\\mathrm{fm}^2$ 表示。\n\n测试套件：\n- 考虑质量数为 $A=100,112,120,124,132,140$ 的同位素。\n- 使用 $A_{\\mathrm{ref}}=120$ 作为计算 $\\delta\\langle r^2\\rangle$ 的参考。\n- 确保您的数值最小化方法对所有测试用例都是稳健的。\n\n最终输出格式：\n- 您的程序应生成单行输出，包含一个由列表组成的列表，每个内部列表对应一个测试用例，形式为 $[\\delta\\langle r^2\\rangle_{\\mathrm{H}}, \\delta\\langle r^2\\rangle_{\\mathrm{HF}}, \\Delta]$，其中 $\\Delta=\\delta\\langle r^2\\rangle_{\\mathrm{HF}}-\\delta\\langle r^2\\rangle_{\\mathrm{H}}$，所有值均以 $\\mathrm{fm}^2$ 为单位。例如，输出应如下所示：\n  $$[[x_1,y_1,z_1],[x_2,y_2,z_2],\\dots],$$\n  不含任何额外的字符或文本。", "solution": "该问题要求在一个简化的液滴模型框架内，通过推导和计算来分析库仑交换项对锡（Sn）同位素链电荷半径的影响。\n\n**1. 总能量表达式**\n\n模型的核心是总能量 $E(R;A)$，它是原子核半径 $R$ 和质量数 $A$ 的函数：\n$$\nE(R;A) = \\frac{1}{2} C(A) \\left[R - R_0(A)\\right]^2 + \\frac{A_{\\mathrm{C}}(Z)}{R} + \\frac{A_{\\mathrm{x}}(Z)}{R}\n$$\n各项的物理意义如下：\n- **弹性项**：$\\frac{1}{2} C(A) [R - R_0(A)]^2$ 是一个唯象项，描述了原子核偏离其理想半径 $R_0(A) = r_0 A^{1/3}$ 时的能量惩罚。刚度 $C(A)=\\kappa A$ 反映了核物质的广延性。\n- **库仑Hartree项**：$\\frac{A_C(Z)}{R}$ 是质子之间静电排斥的直接（Hartree）能量。\n- **库仑Fock项**：$\\frac{A_x(Z)}{R}$ 是源于质子波函数反对称性的交换（Fock）能量。\n\n**2. 库仑系数的推导**\n\n- **Hartree系数 $A_C(Z)$**：均匀带电球体（总电荷 $Ze$，半径 $R$）的静电能为：\n  $$ E_C = \\frac{3}{5} \\frac{(Ze)^2}{R} $$\n  因此，Hartree系数为 $A_C(Z) = \\frac{3}{5} (Ze)^2$。\n\n- **Fock系数 $A_x(Z)$**：对于密度为 $n_p$ 的均匀质子费米气体，库仑交换能密度为：\n  $$ \\epsilon_x = -\\frac{3}{4} \\left(\\frac{3}{\\pi}\\right)^{1/3} e^2 n_p^{4/3} $$\n  总交换能 $E_x = \\epsilon_x V$，其中体积 $V=\\frac{4\\pi}{3}R^3$，质子密度 $n_p = Z/V$。\n  $$ E_x = -\\frac{3}{4} \\left(\\frac{3}{\\pi}\\right)^{1/3} e^2 \\left(\\frac{Z}{V}\\right)^{4/3} V = -\\frac{3}{4} \\left(\\frac{3}{\\pi}\\right)^{1/3} e^2 Z^{4/3} V^{-1/3} $$\n  将 $V=\\frac{4\\pi}{3}R^3$ 代入：\n  $$ E_x = -\\frac{3}{4} \\left(\\frac{3}{\\pi}\\right)^{1/3} e^2 Z^{4/3} \\left(\\frac{4\\pi}{3}R^3\\right)^{-1/3} = -\\frac{3}{4} e^2 Z^{4/3} \\left(\\frac{3}{\\pi} \\frac{3}{4\\pi}\\right)^{1/3} \\frac{1}{R} = -\\frac{3}{4} e^2 \\left(\\frac{9}{4\\pi^2}\\right)^{1/3} Z^{4/3} \\frac{1}{R} $$\n  因此，Fock系数为 $A_x(Z) = -\\frac{3}{4} e^2 \\left(\\frac{9}{4\\pi^2}\\right)^{1/3} Z^{4/3}$。\n\n**3. 确定平衡半径**\n\n平衡半径 $R^*$ 是使总能量 $E(R;A)$ 最小化的半径。我们通过求解 $\\frac{dE}{dR}=0$ 来找到它。\n$$ \\frac{dE}{dR} = C(A)(R-R_0(A)) - \\frac{A_C(Z) + A_x(Z)}{R^2} = 0 $$\n令 $A_{\\mathrm{tot}} = A_C(Z) + A_x(Z)$ 并代入 $C(A)=\\kappa A$ 和 $R_0(A)=r_0 A^{1/3}$：\n$$ \\kappa A (R - r_0 A^{1/3}) = \\frac{A_{\\mathrm{tot}}}{R^2} $$\n$$ \\kappa A R^3 - \\kappa A (r_0 A^{1/3}) R^2 - A_{\\mathrm{tot}} = 0 $$\n这是一个关于 $R$ 的三次方程。对于给定的 $A$ 和 $Z$，我们可以数值求解这个方程，得到唯一的正实数解 $R^*(A)$。计算分两种情况：\n1.  **仅Hartree (H)**：$A_x=0$，所以 $A_{\\mathrm{tot}} = A_C(Z)$。\n2.  **Hartree-Fock (HF)**：$A_{\\mathrm{tot}} = A_C(Z) + A_x(Z)$。\n\n**4. 计算同位素位移**\n\n得到平衡半径 $R^*(A)$ 后，均方电荷半径由下式给出：\n$$ \\langle r^2 \\rangle(A) = \\frac{3}{5} [R^*(A)]^2 $$\n相对于参考同位素 $A_{\\mathrm{ref}}=120$ 的同位素位移为：\n$$ \\delta\\langle r^2 \\rangle(A) = \\langle r^2 \\rangle(A) - \\langle r^2 \\rangle(A_{\\mathrm{ref}}) $$\n最后，计算包含交换项和不包含交换项时同位素位移的差异：\n$$ \\Delta = \\delta\\langle r^2 \\rangle_{\\mathrm{HF}} - \\delta\\langle r^2 \\rangle_{\\mathrm{H}} $$\n整个过程通过编写一个脚本来实现，该脚本为测试套件中的每个 $A$ 值执行这些计算步骤。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the impact of the exact Coulomb exchange on isotope shifts \n    for a sequence of tin isotopes based on a simplified nuclear model.\n    \"\"\"\n    # Define physical and model constants.\n    Z = 50.0  # Proton number for tin\n    r0 = 1.2  # fm\n    kappa = 5.0  # MeV/fm\n    e_squared = 1.43996448  # MeV*fm\n\n    # Define test cases for mass number A.\n    test_cases = [100, 112, 120, 124, 132, 140]\n    A_ref = 120\n\n    # Calculate Coulomb coefficients A_C(Z) and A_x(Z).\n    # A_C is the Hartree coefficient for a uniformly charged sphere.\n    A_C = (3.0 / 5.0) * (Z**2) * e_squared\n\n    # A_x is the Fock exchange coefficient for a uniform proton Fermi gas.\n    A_x = -(3.0 / 4.0) * e_squared * ((9.0 / (4.0 * np.pi**2)))**(1.0/3.0) * Z**(4.0/3.0)\n\n    def find_equilibrium_radius(A, A_tot):\n        \"\"\"\n        Solves the cubic equation for the equilibrium radius R*.\n        The equation is: kappa*A*R^3 - kappa*A*R0*R^2 - A_tot = 0.\n        \"\"\"\n        R0 = r0 * A**(1.0/3.0)\n        kappa_A = kappa * A\n        \n        # Coefficients of the cubic polynomial p[0]*R^3 + p[1]*R^2 + p[2]*R + p[3] = 0\n        coeffs = [\n            kappa_A,\n            -kappa_A * R0,\n            0.0,\n            -A_tot\n        ]\n        roots = np.roots(coeffs)\n        \n        # The physical root is the single positive real root.\n        positive_real_root = 0.0\n        for root in roots:\n            if np.isreal(root) and root.real > 0:\n                positive_real_root = root.real\n                break\n        return positive_real_root\n\n    # Function to compute mean-square radius from equilibrium radius.\n    def get_msq_radius(R_star):\n        return (3.0 / 5.0) * R_star**2\n\n    # Store mean-square radii for H and HF cases for all isotopes.\n    r2_H = {}\n    r2_HF = {}\n\n    # Calculate for Hartree (H) case (A_x = 0).\n    A_tot_H = A_C\n    for A in test_cases:\n        R_star_H = find_equilibrium_radius(A, A_tot_H)\n        r2_H[A] = get_msq_radius(R_star_H)\n\n    # Calculate for Hartree-Fock (HF) case (A_x != 0).\n    A_tot_HF = A_C + A_x\n    for A in test_cases:\n        R_star_HF = find_equilibrium_radius(A, A_tot_HF)\n        r2_HF[A] = get_msq_radius(R_star_HF)\n\n    # Get reference values for isotope shifts at A_ref.\n    r2_H_ref = r2_H[A_ref]\n    r2_HF_ref = r2_HF[A_ref]\n\n    # Compute final results: isotope shifts and their difference.\n    final_results = []\n    for A in test_cases:\n        delta_r2_H = r2_H[A] - r2_H_ref\n        delta_r2_HF = r2_HF[A] - r2_HF_ref\n        delta_shift = delta_r2_HF - delta_r2_H\n        # Round to a reasonable number of decimal places for clean output\n        final_results.append([round(delta_r2_H, 6), round(delta_r2_HF, 6), round(delta_shift, 6)])\n\n    # Format the output as a string representing a list of lists.\n    # Eg: [[x1, y1, z1], [x2, y2, z2], ...]\n    output_str = f\"[{','.join(map(str, final_results))}]\"\n    print(output_str)\n\nsolve()\n```", "id": "3587241"}]}