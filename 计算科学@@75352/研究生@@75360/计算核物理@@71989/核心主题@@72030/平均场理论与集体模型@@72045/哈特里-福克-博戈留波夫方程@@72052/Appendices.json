{"hands_on_practices": [{"introduction": "从粒子-空穴基矢到准粒子基矢的变换是 Hartree-Fock-Bogoliubov (HFB) 理论的基石。本练习通过对单个时间反演对的 HFB 矩阵进行显式对角化，让您亲手推导 Bogoliubov 变换的振幅 $U$ 和 $V$ [@problem_id:3601817]。掌握这一基本计算对于理解对关联如何重构基态并引出准粒子概念至关重要。", "problem": "考虑一个在 Hartree–Fock–Bogoliubov (HFB) 框架的 Bardeen–Cooper–Schrieffer (BCS) 极限下建模的偶核。假设在一个正则基中，时间反演的伴态形成独立的二维配对子空间，并且配对场是对角的，具有均匀的配对能隙。给定一组三个单粒子轨道，每个轨道都代表一个时间反演对，其相对于实验室零点的平均场能量为\n$$e_{1} = -9.2\\,\\text{MeV},\\quad e_{2} = -8.3\\,\\text{MeV},\\quad e_{3} = -7.4\\,\\text{MeV}.$$\n化学势为\n$$\\lambda = -8.0\\,\\text{MeV},$$\n配对能隙是均匀的，\n$$\\Delta = 1.2\\,\\text{MeV}.$$\n\n从 Hartree–Fock–Bogoliubov 变分原理和正则基假设（即只有时间反演伴态在反常道中耦合）出发，推导第三个轨道的准粒子振幅，记为 $U_{3}$ 和 $V_{3}$。推导过程必须通过显式地对角化由变分方程所蕴含的相应二维配对子空间，并对 Bogoliubov 变换施加费米子反对易关系保持约束来进行。使用推导出的表达式，根据给定的数值输入构造 $U_{3}$ 和 $V_{3}$，然后计算归一化量\n$$U_{3}^{2} + V_{3}^{2}.$$\n\n将最终答案表示为一个无量纲数。由于如果推导正确，归一化应该是精确的，因此不需要四舍五入指令。", "solution": "该问题要求在 Hartree–Fock–Bogoliubov (HFB) 理论的 Bardeen–Cooper–Schrieffer (BCS) 极限内，为一个特定的单粒子轨道推导 Bogoliubov 准粒子振幅 $U_3$ 和 $V_3$，并随后计算归一化量 $U_3^2 + V_3^2$。\n\nHFB 理论将原子核基态描述为准粒子真空，这些准粒子是粒子和空穴的产生和湮没算符的线性组合。从粒子基 $\\{c_k^\\dagger, c_k\\}$ 到准粒子基 $\\{b_k^\\dagger, b_k\\}$ 的变换是 Bogoliubov 变换。将变分原理应用于能量泛函，得到 HFB 方程，这是一个关于准粒子能量和振幅的本征值问题。其矩阵形式为：\n$$\n\\begin{pmatrix} h-\\lambda & \\Delta \\\\ -\\Delta^\\dagger & -(h-\\lambda)^* \\end{pmatrix} \\begin{pmatrix} U_k \\\\ V_k \\end{pmatrix} = E_k \\begin{pmatrix} U_k \\\\ V_k \\end{pmatrix}\n$$\n此处，$h$ 是单粒子平均场哈密顿量，$\\Delta$ 是配对场，$\\lambda$ 是化学势，$E_k$ 是第 $k$ 个准粒子的能量。列向量 $(U_k, V_k)^T$ 是本征态 $k$ 的准粒子振幅矢量。\n\n问题指定了一个正则基，在此基中平均场哈密顿量 $h$ 是对角的，本征值为 $e_k$。在此基中，问题还指出时间反演伴态（记为 $k$ 和 $\\bar{k}$）形成独立的二维配对子空间。这是 BCS 近似的本质。完整的 HFB 矩阵变为块对角矩阵，每个 $(k, \\bar{k})$ 对都对应一个 $2 \\times 2$ 的块。我们关心的是第三个轨道，因此我们关注由态 $|3\\rangle$ 和 $|\\bar{3}\\rangle$ 张成的子空间。\n\n相关的单粒子哈密顿量矩阵元是 $(h-\\lambda)_{3,3} = e_3 - \\lambda$ 和 $(h-\\lambda)_{\\bar{3},\\bar{3}} = e_{\\bar{3}} - \\lambda$。由于时间反演对称性，$e_{\\bar{3}} = e_3$。假设配对场 $\\Delta$ 只连接时间反演伴态，因此该块中唯一的非零元是 $\\Delta_{3\\bar{3}}$，我们将其记为 $\\Delta$。问题指定了一个均匀且实的配对能隙，因此我们设定 $\\Delta_{3\\bar{3}} = \\Delta = 1.2\\,\\text{MeV}$。\n\n对于态对 $(3, \\bar{3})$ 的 HFB 方程简化为对一个 $2 \\times 2$ 矩阵的对角化。算符通常按 $(c_3, c_{\\bar{3}}^\\dagger)$ 的顺序排列。相应的 HFB 矩阵为：\n$$\n\\mathcal{H}_3 = \\begin{pmatrix} e_3 - \\lambda & \\Delta \\\\ -\\Delta & -(e_3 - \\lambda) \\end{pmatrix} = \\begin{pmatrix} \\epsilon_3 & \\Delta \\\\ -\\Delta & -\\epsilon_3 \\end{pmatrix}\n$$\n其中我们定义了移动后的单粒子能量 $\\epsilon_3 = e_3 - \\lambda$。对于正能量解，准粒子振幅 $(U_3, V_3)$ 构成本征值为 $E_3 > 0$ 的本征矢量：\n$$\n\\begin{pmatrix} \\epsilon_3 & \\Delta \\\\ -\\Delta & -\\epsilon_3 \\end{pmatrix} \\begin{pmatrix} U_3 \\\\ V_3 \\end{pmatrix} = E_3 \\begin{pmatrix} U_3 \\\\ V_3 \\end{pmatrix}\n$$\n这就是问题陈述所要求的显式对角化。通过求解特征方程来找到本征值 $E_3$：\n$$\n\\det(\\mathcal{H}_3 - E_3 I) = \\det \\begin{pmatrix} \\epsilon_3 - E_3 & \\Delta \\\\ -\\Delta & -\\epsilon_3 - E_3 \\end{pmatrix} = 0\n$$\n$$\n(\\epsilon_3 - E_3)(-\\epsilon_3 - E_3) - (\\Delta)(-\\Delta) = 0\n$$\n$$\n-(E_3^2 - \\epsilon_3^2) + \\Delta^2 = 0 \\implies E_3^2 = \\epsilon_3^2 + \\Delta^2\n$$\n因此，正的准粒子能量为 $E_3 = \\sqrt{\\epsilon_3^2 + \\Delta^2}$。\n\n接下来，我们求解本征矢量 $(U_3, V_3)^T$。从矩阵方程的第一行得到：\n$$\n(\\epsilon_3 - E_3)U_3 + \\Delta V_3 = 0 \\implies V_3 = -\\frac{\\epsilon_3 - E_3}{\\Delta} U_3 = \\frac{E_3 - \\epsilon_3}{\\Delta} U_3\n$$\nBogoliubov 变换必须保持算符的费米子特性，这意味着准粒子算符必须满足正则反对易关系。这对振幅施加了一个归一化条件：\n$$\nU_3^2 + V_3^2 = 1\n$$\n这就是问题中提到的约束条件。我们将 $V_3$ 的表达式代入此归一化条件：\n$$\nU_3^2 + \\left(\\frac{E_3 - \\epsilon_3}{\\Delta}\\right)^2 U_3^2 = 1\n$$\n$$\nU_3^2 \\left[ 1 + \\frac{(E_3 - \\epsilon_3)^2}{\\Delta^2} \\right] = 1\n$$\n$$\nU_3^2 \\left[ \\frac{\\Delta^2 + E_3^2 - 2E_3\\epsilon_3 + \\epsilon_3^2}{\\Delta^2} \\right] = 1\n$$\n使用关系式 $E_3^2 = \\epsilon_3^2 + \\Delta^2$，分子中的项变为：\n$$\n\\Delta^2 + E_3^2 - 2E_3\\epsilon_3 + \\epsilon_3^2 = (\\epsilon_3^2 + \\Delta^2) + E_3^2 - 2E_3\\epsilon_3 = E_3^2 + E_3^2 - 2E_3\\epsilon_3 = 2E_3(E_3 - \\epsilon_3)\n$$\n将其代回，我们得到：\n$$\nU_3^2 \\left[ \\frac{2E_3(E_3 - \\epsilon_3)}{\\Delta^2} \\right] = 1 \\implies U_3^2 = \\frac{\\Delta^2}{2E_3(E_3 - \\epsilon_3)}\n$$\n为了简化这个表达式，我们将分子和分母同乘以 $(E_3 + \\epsilon_3)$：\n$$\nU_3^2 = \\frac{\\Delta^2(E_3 + \\epsilon_3)}{2E_3(E_3 - \\epsilon_3)(E_3 + \\epsilon_3)} = \\frac{\\Delta^2(E_3 + \\epsilon_3)}{2E_3(E_3^2 - \\epsilon_3^2)}\n$$\n由于 $E_3^2 - \\epsilon_3^2 = \\Delta^2$，上式简化为：\n$$\nU_3^2 = \\frac{\\Delta^2(E_3 + \\epsilon_3)}{2E_3\\Delta^2} = \\frac{E_3 + \\epsilon_3}{2E_3} = \\frac{1}{2} \\left( 1 + \\frac{\\epsilon_3}{E_3} \\right)\n$$\n根据归一化条件，我们可以求出 $V_3^2$：\n$$\nV_3^2 = 1 - U_3^2 = 1 - \\frac{1}{2} \\left( 1 + \\frac{\\epsilon_3}{E_3} \\right) = \\frac{1}{2} - \\frac{\\epsilon_3}{2E_3} = \\frac{1}{2} \\left( 1 - \\frac{\\epsilon_3}{E_3} \\right)\n$$\n这些是在 BCS 近似下准粒子振幅的一般表达式。\n\n现在，我们根据给定的数值输入构造 $U_3$ 和 $V_3$。注意，能量 $e_1$ 和 $e_2$ 与此计算无关。\n已知：\n$e_3 = -7.4\\,\\text{MeV}$\n$\\lambda = -8.0\\,\\text{MeV}$\n$\\Delta = 1.2\\,\\text{MeV}$\n\n首先，我们计算 $\\epsilon_3$：\n$$\n\\epsilon_3 = e_3 - \\lambda = (-7.4\\,\\text{MeV}) - (-8.0\\,\\text{MeV}) = 0.6\\,\\text{MeV}\n$$\n接下来，我们计算准粒子能量 $E_3$：\n$$\nE_3 = \\sqrt{\\epsilon_3^2 + \\Delta^2} = \\sqrt{(0.6\\,\\text{MeV})^2 + (1.2\\,\\text{MeV})^2} = \\sqrt{0.36 + 1.44}\\,\\text{MeV} = \\sqrt{1.8}\\,\\text{MeV}\n$$\n我们可以选择振幅 $U_3$ 和 $V_3$ 为实数和正数，这是一个常见的相位约定。这导出以下表达式：\n$$\nU_3 = \\sqrt{\\frac{1}{2} \\left( 1 + \\frac{\\epsilon_3}{E_3} \\right)} = \\sqrt{\\frac{1}{2} \\left( 1 + \\frac{0.6}{\\sqrt{1.8}} \\right)}\n$$\n$$\nV_3 = \\sqrt{\\frac{1}{2} \\left( 1 - \\frac{\\epsilon_3}{E_3} \\right)} = \\sqrt{\\frac{1}{2} \\left( 1 - \\frac{0.6}{\\sqrt{1.8}} \\right)}\n$$\n该比值可以简化为：$\\frac{0.6}{\\sqrt{1.8}} = \\frac{\\sqrt{0.36}}{\\sqrt{1.8}} = \\sqrt{\\frac{0.36}{1.8}} = \\sqrt{0.2} = \\frac{1}{\\sqrt{5}}$。\n因此，振幅为：\n$$\nU_3 = \\sqrt{\\frac{1}{2} \\left( 1 + \\frac{1}{\\sqrt{5}} \\right)}\n$$\n$$\nV_3 = \\sqrt{\\frac{1}{2} \\left( 1 - \\frac{1}{\\sqrt{5}} \\right)}\n$$\n问题要求计算归一化量 $U_3^2 + V_3^2$。使用推导出的振幅平方的表达式：\n$$\nU_3^2 + V_3^2 = \\frac{1}{2}\\left(1 + \\frac{\\epsilon_3}{E_3}\\right) + \\frac{1}{2}\\left(1 - \\frac{\\epsilon_3}{E_3}\\right)\n$$\n$$\nU_3^2 + V_3^2 = \\left(\\frac{1}{2} + \\frac{1}{2}\\right) + \\left(\\frac{\\epsilon_3}{2E_3} - \\frac{\\epsilon_3}{2E_3}\\right) = 1 + 0 = 1\n$$\n这个结果是一个代数恒等式，源于施加在 Bogoliubov 变换上的归一化条件。只要 $\\Delta \\neq 0$，无论 $e_3$、$\\lambda$ 和 $\\Delta$ 的具体数值如何，这个结果都成立。使用具体数值的计算证实了这一基本性质。Bogoliubov 变换矢量 $(U_k, V_k)^T$ 归一化为1是保持费米子反对易关系的直接结果，而后者是该理论的基石。", "answer": "$$\n\\boxed{1}\n$$", "id": "3601817"}, {"introduction": "虽然单个准粒子的性质很有启发性，但 HFB 理论的力量在于其自洽性，即平均场（包括对力场 $\\Delta$）是由粒子自身决定的。这个计算实践将挑战您构建一个求解耦合的 HFB 对力隙方程和粒子数方程的程序，这是任何现实原子核结构计算中的核心任务 [@problem_id:3601819]。您还将探索不同的正规化方案，这是处理大模型空间中对相互作用引起的发散的一项关键技术。", "problem": "你需要实现一个数值求解器，用于在一个简化的有限原子核模型中，比较 Hartree-Fock-Bogoliubov (HFB) 配对问题里不同正则化方案的收敛行为。该求解器必须通过在一个离散的单粒子基中求解自洽的 HFB/BCS 方程来计算配对能隙，并应用以下三种正则化类型之一：(i) 能量窗口截断，(ii) 准粒子能量截断，以及 (iii) 平滑高斯正则化器。最终输出必须是针对一组指定的正则化器参数所计算出的配对能隙，以兆电子伏 (MeV) 为单位，四舍五入到三位小数，并以单个用方括号括起来的逗号分隔列表形式呈现。\n\n推导和计算使用以下基本依据：\n- 对于一个偶偶核系统，在离散基中，当配对相互作用为常数时，Hartree-Fock-Bogoliubov (HFB) 框架可以简化为正则基中的一个类 Bardeen-Cooper-Schrieffer (BCS) 问题。在平均场近似下，配对相互作用强度为常数 $G$，且每个能级有一个时间反演对，准粒子能量为\n$$\nE_i = \\sqrt{(\\epsilon_i - \\mu)^2 + \\Delta^2},\n$$\n其中 $\\epsilon_i$ 是单粒子能量，$\\mu$ 是化学势，$\\Delta$ 是（与能级无关的）配对能隙。\n- 占据数振幅满足\n$$\nv_i^2 = \\tfrac{1}{2}\\left(1 - \\frac{\\epsilon_i - \\mu}{E_i}\\right), \\quad u_i^2 = 1 - v_i^2, \\quad u_i v_i = \\frac{\\Delta}{2 E_i}.\n$$\n- 对于每个能级有一个时间反演对的偶偶核系统，其粒子数条件为\n$$\nN = 2\\sum_i v_i^2,\n$$\n在正则化器 $w_i \\in [0,1]$ 作用于配对核的情况下，能隙方程为\n$$\n1 = G \\sum_i \\frac{w_i}{2 E_i}.\n$$\n\n正则化器必须按如下方式实现：\n- 能量窗口截断（“energy cutoff”）：对能级 $i$ 包含权重\n$$\nw_i = \\Theta\\!\\left( E_{\\mathrm{cut}} - |\\epsilon_i - \\mu| \\right),\n$$\n其中 $\\Theta$ 是赫维赛德阶跃函数，$E_{\\mathrm{cut}} > 0$ 是以兆电子伏为单位的窗口半宽度。\n- 准粒子能量截断（“quasiparticle cutoff”）：对能级 $i$ 包含权重\n$$\nw_i = \\Theta\\!\\left( E_{\\mathrm{qp}}^{\\mathrm{cut}} - E_i \\right),\n$$\n其中 $E_{\\mathrm{qp}}^{\\mathrm{cut}} > 0$ 是以兆电子伏为单位的准粒子能量截断值。\n- 平滑高斯正则化器（“smooth regulator”）：应用平滑权重\n$$\nw_i = \\exp\\!\\left(-\\left|\\frac{\\epsilon_i - \\mu}{\\Lambda}\\right|^2\\right),\n$$\n其中 $\\Lambda > 0$ 是以兆电子伏为单位的正则化器宽度。\n\n有限原子核模型的设置：\n- 使用一个离散、等间距的单粒子谱，包含 $M = 100$ 个能级，间距 $d = 0.5$ 兆电子伏，以 $0$ 为中心，因此\n$$\n\\epsilon_i = d \\left(i - \\frac{M+1}{2}\\right), \\quad i \\in \\{1,\\dots,M\\}.\n$$\n- 使用恒定的配对强度 $G = 0.17$ 兆电子伏。\n- 使用偶数粒子数 $N = 100$。\n- 在所有计算中，配对能隙 $\\Delta$ 必须以兆电子伏为单位报告，并四舍五入到三位小数。\n\n数学和算法要求：\n- 对于 $\\Delta$ 的每个试探值，化学势 $\\mu$ 必须通过粒子数条件 $N = 2\\sum_i v_i^2$ 自洽地确定。\n- 对于给定的正则化器和参数值，配对能隙 $\\Delta$ 必须通过求解正则化后的能隙方程 $1 = G \\sum_i w_i/(2E_i)$ 来获得。如果对于给定的正则化器参数不存在 $\\Delta > 0$ 的非平庸解，则正确解为 $\\Delta = 0$。\n- 粒子数方程不能被正则化；也就是说，正则化器 $w_i$ 只作用于能隙方程，而不作用于粒子数方程。\n- 在 $\\Delta$ 上的数值解必须稳定，并收敛到最多 $10^{-6}$ 的绝对容差。\n\n测试套件：\n- 使用以下正则化器案例和参数（全部以兆电子伏为单位），并按下列顺序计算每种情况下的配对能隙 $\\Delta$：\n  - 能量截断，$E_{\\mathrm{cut}} = 4.0$。\n  - 能量截断，$E_{\\mathrm{cut}} = 8.0$。\n  - 能量截断，$E_{\\mathrm{cut}} = 16.0$。\n  - 准粒子截断，$E_{\\mathrm{qp}}^{\\mathrm{cut}} = 0.05$。\n  - 准粒子截断，$E_{\\mathrm{qp}}^{\\mathrm{cut}} = 4.0$。\n  - 准粒子截断，$E_{\\mathrm{qp}}^{\\mathrm{cut}} = 8.0$。\n  - 平滑正则化器，$\\Lambda = 2.0$。\n  - 平滑正则化器，$\\Lambda = 4.0$。\n  - 平滑正则化器，$\\Lambda = 8.0$。\n  - 用于比较的参考案例：能量截断，$E_{\\mathrm{cut}} = 25.0$。\n\n输出规范：\n- 你的程序必须输出一行，其中包含一个逗号分隔的列表（用方括号括起来），该列表包含与测试套件相对应的 10 个配对能隙，顺序与给定顺序一致，每个值四舍五入到三位小数，并解释为兆电子伏。例如，一个有效的输出格式是\n$$\n[\\Delta_1,\\Delta_2,\\dots,\\Delta_{10}],\n$$\n其中每个 $\\Delta_k$ 是一个小数点后有三位数字的十进制数。不涉及角度。不涉及百分比。所有数值均代表以兆电子伏（MeV）为单位的能量。", "solution": "已对用户提供的问题陈述进行了分析和验证。\n\n### 步骤1：提取给定条件\n- **框架**：用于偶偶核系统的 Hartree-Fock-Bogoliubov (HFB) 框架，可简化为类 Bardeen-Cooper-Schrieffer (BCS) 问题。\n- **准粒子能量**：$E_i = \\sqrt{(\\epsilon_i - \\mu)^2 + \\Delta^2}$，其中 $\\epsilon_i$ 是单粒子能量，$\\mu$ 是化学势，$\\Delta$ 是配对能隙。\n- **占据数振幅**：$v_i^2 = \\tfrac{1}{2}\\left(1 - \\frac{\\epsilon_i - \\mu}{E_i}\\right)$, $u_i^2 = 1 - v_i^2$, $u_i v_i = \\frac{\\Delta}{2 E_i}$。\n- **粒子数条件**：$N = 2\\sum_i v_i^2$。\n- **正则化能隙方程**：$1 = G \\sum_i \\frac{w_i}{2 E_i}$，其中正则化器 $w_i \\in [0,1]$。\n- **正则化器定义**：\n    1.  **能量截断**：$w_i = \\Theta( E_{\\mathrm{cut}} - |\\epsilon_i - \\mu| )$，其中 $E_{\\mathrm{cut}} > 0$。\n    2.  **准粒子截断**：$w_i = \\Theta( E_{\\mathrm{qp}}^{\\mathrm{cut}} - E_i )$，其中 $E_{\\mathrm{qp}}^{\\mathrm{cut}} > 0$。\n    3.  **平滑高斯正则化器**：$w_i = \\exp(-\\left|\\frac{\\epsilon_i - \\mu}{\\Lambda}\\right|^2)$，其中 $\\Lambda > 0$。\n- **模型参数**：\n    - 能级数：$M = 100$。\n    - 能级间距：$d = 0.5$ MeV。\n    - 单粒子谱：$\\epsilon_i = d \\left(i - \\frac{M+1}{2}\\right)$，其中 $i \\in \\{1,\\dots,M\\}$。\n    - 配对强度：$G = 0.17$ MeV。\n    - 粒子数：$N = 100$。\n- **算法要求**：\n    - 对于每个试探 $\\Delta$，化学势 $\\mu$ 根据粒子数条件自洽确定。\n    - 配对能隙 $\\Delta$ 根据正则化能隙方程自洽确定。\n    - 粒子数方程不进行正则化。\n    - 如果不存在非平庸解 $\\Delta > 0$，则选择平庸解 $\\Delta = 0$。\n    - $\\Delta$ 的数值容差最多为 $10^{-6}$。\n- **测试套件**：\n    - 能量截断：$E_{\\mathrm{cut}} = 4.0, 8.0, 16.0$ MeV。\n    - 准粒子截断：$E_{\\mathrm{qp}}^{\\mathrm{cut}} = 0.05, 4.0, 8.0$ MeV。\n    - 平滑正则化器：$\\Lambda = 2.0, 4.0, 8.0$ MeV。\n    - 参考案例：能量截断，$E_{\\mathrm{cut}} = 25.0$ MeV。\n- **输出规范**：一个包含 10 个配对能隙的逗号分隔列表，用方括号括起来，单位为兆电子伏 (MeV)，四舍五入到三位小数。\n\n### 步骤2：使用提取的给定条件进行验证\n1.  **科学或事实上的不健全**：无。该问题描述了一个简化但标准的 BCS 配对模型，这是原子核多体理论的基石。所涉及的方程和概念在物理上和数学上都是合理的。\n2.  **不可形式化或不相关**：无。该问题是计算核物理领域一个定义明确的数值任务，直接涉及 Hartree-Fock-Bogoliubov 方法论。\n3.  **不完整或矛盾的设置**：无。所有必要的常数（$G$、$N$、$M$、$d$）、定义（正则化器、能量）和程序要求都已明确说明。在包含 $M=100$ 个能级的谱中，配对强度 $G=0.17$ MeV 和粒子数 $N=100$ 是一致的，这将导致一个行为良好的系统，预计会产生配对关联。\n4.  **不切实际或不可行**：无。对于示例性的原子核模型计算而言，这些物理参数处于合理的量级。\n5.  **不适定或结构不良**：无。该问题涉及求解两个耦合的、非线性的、自洽的方程。此类问题在物理学中很常见，并且在这些条件下允许稳定且唯一的解。存在平庸解（$\\Delta = 0$）和可能的非平庸解（$\\Delta > 0$）是能隙方程的典型特征。\n6.  **伪深刻、平庸或同义反复**：无。该问题需要一个涉及嵌套求根的非平庸迭代数值过程，这在计算物理学中构成了一个合理的挑战。\n7.  **超出科学可验证性范围**：无。这些计算基于可验证的物理模型，并且可以被独立复现。\n\n### 步骤3：结论和行动\n该问题具有科学依据、适定且完整。因此，它被视为**有效**。将提供一个解。\n\n### 解题推导\n\n该问题需要为配对能隙 $\\Delta$ 和化学势 $\\mu$ 求解一组耦合的自洽方程。该系统由一个离散的单粒子能谱 $\\{\\epsilon_i\\}$、一个恒定的配对强度 $G$ 和一个固定的粒子数 $N$ 来定义。两个控制方程是粒子数方程和能隙方程。\n\n首先，我们建立单粒子能谱。有 $M=100$ 个能级，间距为 $d=0.5$ MeV，以 $0$ 为中心，能量由 $\\epsilon_i = d(i - \\frac{M+1}{2})$ 给出，其中 $i \\in \\{1, \\dots, M\\}$。这产生了一个从 $\\epsilon_1 = 0.5(1-50.5) = -24.75$ MeV 到 $\\epsilon_{100} = 0.5(100-50.5) = 24.75$ MeV 的能谱。由于粒子数 $N=100$ 等于可用的单粒子态数（考虑到由因子 $2$ 隐式处理的自旋简并），在无相互作用的情况下，费米海将被精确填充到 $\\epsilon=0$ 的能级。这意味着在零温且无配对时，化学势将为 $\\mu=0$ MeV。在有配对的情况下，由于能谱的对称性和填充方式，预计 $\\mu$ 将保持在接近 $0$ MeV。\n\n问题的核心是 $\\Delta$ 和 $\\mu$ 方程的耦合特性：\n$$\nN = \\sum_{i=1}^{M} \\left(1 - \\frac{\\epsilon_i - \\mu}{\\sqrt{(\\epsilon_i - \\mu)^2 + \\Delta^2}}\\right) \\quad \\text{（1. 粒子数方程）}\n$$\n$$\n1 = G \\sum_{i=1}^{M} \\frac{w_i(\\mu, \\Delta)}{2 \\sqrt{(\\epsilon_i - \\mu)^2 + \\Delta^2}} \\quad \\text{（2. 能隙方程）}\n$$\n正则化器权重 $w_i$ 本身可以依赖于 $\\mu$，并且在其中一种情况下，通过准粒子能量 $E_i$ 依赖于 $\\Delta$。这种结构表明需要一个嵌套迭代解。我们可以将问题结构化为求解 $\\Delta$ 的能隙方程的根，其中对于 $\\Delta$ 的每个试探值，我们必须首先找到满足粒子数方程的相应 $\\mu$。\n\n让我们为能隙方程定义一个残差函数：\n$$\nf(\\Delta) = G \\sum_{i=1}^{M} \\frac{w_i(\\mu(\\Delta), \\Delta)}{2 \\sqrt{(\\epsilon_i - \\mu(\\Delta))^2 + \\Delta^2}} - 1\n$$\n我们的目标是找到 $\\Delta \\ge 0$ 使得 $f(\\Delta) = 0$。对于任何给定的 $\\Delta$，计算 $f(\\Delta)$ 的值需要 $\\mu(\\Delta)$ 的值，而 $\\mu(\\Delta)$ 是在该特定 $\\Delta$ 下满足粒子数方程的化学势。\n\n为了找到 $\\mu(\\Delta)$，我们在固定的 $\\Delta$ 下为粒子数方程定义一个残差函数：\n$$\ng(\\mu; \\Delta) = \\sum_{i=1}^{M} \\left(1 - \\frac{\\epsilon_i - \\mu}{\\sqrt{(\\epsilon_i - \\mu)^2 + \\Delta^2}}\\right) - N\n$$\n对于固定的 $\\Delta > 0$，函数 $g(\\mu; \\Delta)$ 是 $\\mu$ 的单调递增函数。这个性质使其非常适合使用稳定的求根算法，如二分法或 Brent 方法。我们可以在单粒子谱的范围内搜索根 $\\mu$，例如 $[\\epsilon_1, \\epsilon_M] = [-24.75, 24.75]$。\n\n整个数值算法的流程如下：\n1.  初始化模型参数：$G=0.17$，$N=100$，以及单粒子谱 $\\epsilon_i$。\n2.  对于测试套件中提供的每个正则化器案例：\n    a. 定义能隙残差函数 $f(\\Delta)$。\n    b. 对于给定的 $\\Delta \\ge 0$，计算 $f(\\Delta)$ 的值涉及一个内循环子问题：\n        i. 定义粒子数方程的残差 $g(\\mu; \\Delta)$。\n        ii. 使用数值求根器（例如 `scipy.optimize.brentq`）在一个有界区间内求解 $g(\\mu; \\Delta) = 0$ 得到 $\\mu$。将此解记为 $\\mu^*$。\n        iii. 使用 $\\mu^*$ 计算正则化器权重 $w_i$。对于能量正则化器和平滑正则化器，$w_i$ 依赖于 $\\epsilon_i - \\mu^*$。对于准粒子截断，$w_i$ 依赖于 $E_i = \\sqrt{(\\epsilon_i - \\mu^*)^2 + \\Delta^2}$。\n        iv. 在确定了 $\\mu^*$ 和 $w_i$ 后，计算并返回 $f(\\Delta)$ 的值。\n    c. 在求解非平庸能隙之前，我们必须检查它是否存在。当且仅当能隙方程对于某个 $\\Delta > 0$ 有解时，非平庸解 $\\Delta > 0$ 才存在，这通常对应于条件 $f(\\Delta \\to 0^+) > 0$。我们将在一个非常小的正值（例如 $\\Delta = 10^{-8}$ MeV）处计算 $f(\\Delta)$。如果 $f(10^{-8}) \\le 0$，则在给定的正则化下，配对相互作用不足以打开能隙，解为平庸解 $\\Delta = 0$。\n    d. 如果 $f(10^{-8}) > 0$，则存在非平庸解。我们使用求根器在一个区间（例如 $[10^{-8}, 20.0]$ MeV，这是一个对配对能隙而言物理上足够大的范围）内求解 $f(\\Delta) = 0$ 得到 $\\Delta$，其绝对容差小于 $10^{-6}$。\n    e. 存储得到的 $\\Delta$。\n\n$w_i$ 正则化器的实现是直接的：\n- **能量截断**：如果 $|\\epsilon_i - \\mu| \\le E_{\\mathrm{cut}}$，则 $w_i = 1$，否则为 $0$。\n- **准粒子截断**：如果 $\\sqrt{(\\epsilon_i - \\mu)^2 + \\Delta^2} \\le E_{\\mathrm{qp}}^{\\mathrm{cut}}$，则 $w_i = 1$，否则为 $0$。\n- **平滑正则化器**：直接计算高斯函数 $w_i = \\exp(-((\\epsilon_i - \\mu)/\\Lambda)^2)$。\n\n这种嵌套求根方法提供了一种鲁棒的方法来求解耦合的自洽方程。每个测试案例计算出的能隙的最终列表将按规定格式化。关于数值稳定性的一点说明：当 $\\Delta = 0$ 时，准粒子能量 $E_i$ 变为 $|\\epsilon_i - \\mu|$，表达式 $(\\epsilon_i - \\mu)/E_i$ 变为 $\\mathrm{sgn}(\\epsilon_i - \\mu)$，这个表达式除了在 $\\epsilon_i = \\mu$ 处都是良定义的。由于我们使用的是离散谱，$\\mu$ 的求根器不太可能遇到这种情况，但鲁棒的代码应该能优雅地处理它。在非平庸解的搜索中使用小的正值 $\\Delta$ 可以避免这个奇异点。", "answer": "```python\nimport numpy as np\nfrom scipy.optimize import brentq\n\ndef solve():\n    \"\"\"\n    Implements a self-consistent solver for the BCS pairing problem with different regulators.\n    \"\"\"\n    #\n    # --- Model Parameters ---\n    #\n    M = 100  # Number of levels\n    d = 0.5  # Level spacing in MeV\n    G = 0.17 # Pairing strength in MeV\n    N = 100  # Particle number\n\n    # Generate single-particle spectrum (centered at 0)\n    # The levels are indexed from 1 to M in the problem statement, which corresponds to 0 to M-1 in Python.\n    # The formula uses i, so we use an array from 1 to M.\n    indices = np.arange(1, M + 1)\n    epsilon = d * (indices - (M + 1) / 2.0)\n    \n    # Numerical precision\n    TOLERANCE = 1e-7 # Stricter than 1e-6 for robustness\n    DELTA_MIN = 1e-8 # Small value to check for non-trivial solution\n\n    def compute_gap(regulator_type, regulator_param):\n        \"\"\"\n        Computes the pairing gap for a given regulator.\n\n        Args:\n            regulator_type (str): 'energy', 'quasiparticle', or 'smooth'.\n            regulator_param (float): The parameter for the regulator (E_cut, E_qp_cut, or Lambda).\n\n        Returns:\n            float: The calculated pairing gap Delta in MeV.\n        \"\"\"\n\n        # Define the search interval for mu. It should be within the spectrum.\n        mu_search_interval = [epsilon[0] - 1.0, epsilon[-1] + 1.0]\n\n        def get_mu_for_delta(delta):\n            \"\"\"\n            Solves the number equation to find mu for a given delta.\n            This is the inner loop of the self-consistent procedure.\n            \"\"\"\n            \n            # Handle the delta=0 case to avoid division by zero.\n            if delta  DELTA_MIN:\n                # For delta=0, v_i^2 is 1 if epsilon_i  mu and 0 if epsilon_i > mu.\n                # The number equation becomes 2 * sum(1 for eps_i  mu) = N.\n                # For N=100 in a spectrum of M=100 levels, mu is between epsilon_49 and epsilon_50 (using 0-indexing).\n                # These are symmetric around 0, so mu=0.\n                return 0.0\n\n            def number_eq_residual(mu):\n                \"\"\"Residual of the number equation N = 2 * sum(v_i^2).\"\"\"\n                e_shifted = epsilon - mu\n                # Use np.sqrt on a non-negative array.\n                quasi_E = np.sqrt(e_shifted**2 + delta**2)\n                v_sq = 0.5 * (1.0 - e_shifted / quasi_E)\n                return 2.0 * np.sum(v_sq) - N\n\n            try:\n                mu_solution = brentq(number_eq_residual, mu_search_interval[0], mu_search_interval[1], xtol=TOLERANCE)\n                return mu_solution\n            except ValueError:\n                # Brentq fails if the function does not have opposite signs at the interval ends.\n                # This can happen in pathological cases but should not for this well-behaved problem.\n                return np.nan\n\n        def gap_eq_residual(delta):\n            \"\"\"\n            Residual of the gap equation. This is the function whose root we seek for Delta.\n            This is the outer loop.\n            \"\"\"\n            if delta  DELTA_MIN:\n                # Handle the Delta -> 0 limit carefully.\n                # The term 1/(2E_i) becomes 1/(2*|epsilon_i - mu|).\n                delta = 0.0\n\n            mu = get_mu_for_delta(delta)\n            if np.isnan(mu):\n                return np.nan\n            \n            e_shifted = epsilon - mu\n            quasi_E = np.sqrt(e_shifted**2 + delta**2)\n\n            # --- Calculate regulator weights w_i ---\n            if regulator_type == 'energy':\n                E_cut = regulator_param\n                weights = np.where(np.abs(e_shifted) = E_cut, 1.0, 0.0)\n            elif regulator_type == 'quasiparticle':\n                E_qp_cut = regulator_param\n                weights = np.where(quasi_E = E_qp_cut, 1.0, 0.0)\n            elif regulator_type == 'smooth':\n                Lambda = regulator_param\n                weights = np.exp(-(e_shifted / Lambda)**2)\n            else:\n                raise ValueError(\"Unknown regulator type\")\n            \n            # Avoid division by zero if any quasi_E is zero (can happen if delta=0 and e_shifted=0)\n            # which is unlikely in practice with floating point arithmetic.\n            # Add a small stabilizer.\n            sum_term = np.sum(weights / (2.0 * quasi_E + DELTA_MIN))\n            \n            return G * sum_term - 1.0\n\n        # --- Check for existence of a non-trivial solution ---\n        # If the gap equation residual at a very small Delta is = 0, no gap opens.\n        if gap_eq_residual(DELTA_MIN) = 0:\n            return 0.0\n        \n        # --- Solve for the non-trivial gap Delta > 0 ---\n        try:\n            # A reasonable search range for pairing gaps in nuclei.\n            delta_solution = brentq(gap_eq_residual, DELTA_MIN, 20.0, xtol=TOLERANCE)\n            return delta_solution\n        except ValueError:\n            # If brentq fails, it implies no root in the interval. Given the check above,\n            # this might suggest an issue or that the root is at 0.\n            return 0.0\n\n\n    # --- Test Suite ---\n    test_cases = [\n        ('energy',        4.0),\n        ('energy',        8.0),\n        ('energy',        16.0),\n        ('quasiparticle', 0.05),\n        ('quasiparticle', 4.0),\n        ('quasiparticle', 8.0),\n        ('smooth',        2.0),\n        ('smooth',        4.0),\n        ('smooth',        8.0),\n        ('energy',        25.0) # Reference case\n    ]\n\n    results = []\n    for reg_type, reg_param in test_cases:\n        delta_val = compute_gap(reg_type, reg_param)\n        results.append(delta_val)\n    \n    # Format the output as specified: rounded to three decimals\n    formatted_results = [f\"{val:.3f}\" for val in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "3601819"}, {"introduction": "HFB 态在构造上破坏了粒子数守恒，这一特性对于描述超流性至关重要，但需要审慎的物理解释。本练习通过让您计算粒子数涨落 $\\langle (\\Delta \\hat{N})^2 \\rangle$，深入探究了这种对称性破缺的物理后果 [@problem_id:3601927]。这个量不仅量化了对称性破缺的程度，而且与对关联的强度以及通过恢复对称性所获得的能量增益直接相关，从而让您对 HFB 真空的物理内涵有更深刻的理解。", "problem": "考虑一个在巨正则系综形式下描述，并用Hartree-Fock-Bogoliubov (HFB)方法处理的时间反演不变核系统。单粒子空间由$\\Omega$个双重简并的时间反演对组成，用$k$和$\\bar{k}$标记，其单粒子能量为$\\epsilon_k$。粒子数算符定义为 $ \\hat{N} = \\sum_{k=1}^{\\Omega} \\left( a_k^{\\dagger} a_k + a_{\\bar{k}}^{\\dagger} a_{\\bar{k}} \\right) $，其中$a_k^{\\dagger}$和$a_k$是费米子产生和湮灭算符，遵循正则反对易关系。模型哈密顿量是常数$G$对偶哈密顿量，\n$$\n\\hat{H} = \\sum_{k=1}^{\\Omega} \\epsilon_k \\left( a_k^{\\dagger} a_k + a_{\\bar{k}}^{\\dagger} a_{\\bar{k}} \\right) - G \\sum_{k,l=1}^{\\Omega} a_k^{\\dagger} a_{\\bar{k}}^{\\dagger} a_{\\bar{l}} a_l ,\n$$\n其中对偶相互作用强度$G0$。\n\n假设HFB真空态$|\\Phi\\rangle$在正则基中给出，具有满足$u_k^2 + v_k^2 = 1$的实数Bogoliubov振幅$u_k$和$v_k$，并且解由实数对偶能隙$\\Delta$和化学势$\\lambda$表征，准粒子能量为\n$$\nE_k = \\sqrt{(\\epsilon_k - \\lambda)^2 + \\Delta^2} .\n$$\n你可以将$\\Delta$和$\\lambda$视为给定常数（即，不需要求解HFB能隙或粒子数方程）。\n\n从粒子数算符的基本定义、费米子反对易关系以及适用于准粒子真空态的Wick定理出发，推导HFB态$|\\Phi\\rangle$的粒子数方差\n$$\n\\langle (\\Delta \\hat{N})^2 \\rangle \\equiv \\langle \\Phi | \\hat{N}^2 | \\Phi \\rangle - \\langle \\Phi | \\hat{N} | \\Phi \\rangle^2\n$$\n，用正则占据振幅表示，然后用$\\Delta$、$\\lambda$和$\\epsilon_k$显式表达。\n\n在你的推导中，指明该方差如何依赖于对偶张量和正常密度，并解释它如何在不使用任何快捷公式的情况下，为通过粒子数投影（例如，通过Kamlah展开）获得的能量增益提供领头阶标度。最后，给出$\\langle (\\Delta \\hat{N})^2 \\rangle$关于$\\Delta$、$\\lambda$和集合$\\{\\epsilon_k\\}_{k=1}^{\\Omega}$的单个闭合形式解析表达式。\n\n你的最终答案必须是单个闭合形式表达式。不需要进行数值计算，也不应进行四舍五入。", "solution": "我们从粒子数算符\n$$\n\\hat{N} = \\sum_{k=1}^{\\Omega} \\left( \\hat{n}_k + \\hat{n}_{\\bar{k}} \\right) , \\quad \\text{其中} \\quad \\hat{n}_k = a_k^{\\dagger} a_k, \\; \\hat{n}_{\\bar{k}} = a_{\\bar{k}}^{\\dagger} a_{\\bar{k}} ,\n$$\n以及费米子反对易关系 $\\{ a_i, a_j^{\\dagger} \\} = \\delta_{ij}$, $\\{ a_i, a_j \\} = \\{ a_i^{\\dagger}, a_j^{\\dagger} \\} = 0$ 开始。\n\nHartree-Fock-Bogoliubov (HFB) 准粒子真空态 $|\\Phi\\rangle$ 定义为被所有准粒子算符湮灭的态，在正则基中，Bogoliubov变换按时间反演对是对角的。对于每一对 $(k,\\bar{k})$，可以选择实数正则振幅 $u_k$ 和 $v_k$ 使得 $u_k^2 + v_k^2 = 1$。在此基中，HFB单体密度和对偶张量按对是对角的：\n$$\n\\rho_{kk} = \\langle \\Phi | a_k^{\\dagger} a_k | \\Phi \\rangle = v_k^2, \\quad \\rho_{\\bar{k}\\bar{k}} = v_k^2,\n$$\n$$\n\\kappa_{k\\bar{k}} = \\langle \\Phi | a_{\\bar{k}} a_k | \\Phi \\rangle = u_k v_k, \\quad \\kappa_{\\bar{k}k} = -u_k v_k,\n$$\n所有其他反常密度在正则基中为零。这些结果源于将Wick定理应用于准粒子真空态以及Bogoliubov变换的结构。\n\n$\\hat{N}$ 在 $|\\Phi\\rangle$ 中的期望值是\n$$\n\\langle \\hat{N} \\rangle = \\sum_{k=1}^{\\Omega} \\left( \\langle \\hat{n}_k \\rangle + \\langle \\hat{n}_{\\bar{k}} \\rangle \\right) = \\sum_{k=1}^{\\Omega} \\left( v_k^2 + v_k^2 \\right) = 2 \\sum_{k=1}^{\\Omega} v_k^2 .\n$$\n为了获得方差，我们使用Wick定理计算 $\\langle \\hat{N}^2 \\rangle$。首先注意\n$$\n\\hat{N}^2 = \\sum_{k} (\\hat{n}_k + \\hat{n}_{\\bar{k}})^2 + \\sum_{k \\neq l} (\\hat{n}_k + \\hat{n}_{\\bar{k}})(\\hat{n}_l + \\hat{n}_{\\bar{l}}) .\n$$\n因为对于费米子有 $\\hat{n}_i^2 = \\hat{n}_i$，所以 $(\\hat{n}_k + \\hat{n}_{\\bar{k}})^2 = \\hat{n}_k + \\hat{n}_{\\bar{k}} + 2 \\hat{n}_k \\hat{n}_{\\bar{k}}$。因此\n$$\n\\langle \\hat{N}^2 \\rangle = \\sum_{k} \\left( \\langle \\hat{n}_k \\rangle + \\langle \\hat{n}_{\\bar{k}} \\rangle + 2 \\langle \\hat{n}_k \\hat{n}_{\\bar{k}} \\rangle \\right) + \\sum_{k \\neq l} \\left( \\langle \\hat{n}_k \\hat{n}_l \\rangle + \\langle \\hat{n}_k \\hat{n}_{\\bar{l}} \\rangle + \\langle \\hat{n}_{\\bar{k}} \\hat{n}_l \\rangle + \\langle \\hat{n}_{\\bar{k}} \\hat{n}_{\\bar{l}} \\rangle \\right) .\n$$\n我们现在用Wick定理计算双体密度。对于 $k \\neq l$，收缩可因子化，\n$$\n\\langle \\hat{n}_k \\hat{n}_l \\rangle = \\langle a_k^{\\dagger} a_k \\rangle \\langle a_l^{\\dagger} a_l \\rangle = v_k^2 v_l^2 ,\n$$\n对于混合指标，如 $\\langle \\hat{n}_k \\hat{n}_{\\bar{l}} \\rangle = v_k^2 v_l^2$ 等，情况类似。对于同一对中的$k$和$\\bar{k}$，\n$$\n\\langle \\hat{n}_k \\hat{n}_{\\bar{k}} \\rangle = \\langle a_k^{\\dagger} a_k a_{\\bar{k}}^{\\dagger} a_{\\bar{k}} \\rangle = \\langle a_k^{\\dagger} a_k \\rangle \\langle a_{\\bar{k}}^{\\dagger} a_{\\bar{k}} \\rangle - \\langle a_k^{\\dagger} a_{\\bar{k}}^{\\dagger} \\rangle \\langle a_k a_{\\bar{k}} \\rangle .\n$$\n在正则基中，非对角正常密度为零，而反常密度为 $\\langle a_k a_{\\bar{k}} \\rangle = -\\kappa_{k\\bar{k}} = -u_k v_k$，$\\langle a_k^{\\dagger} a_{\\bar{k}}^{\\dagger} \\rangle = \\kappa_{k\\bar{k}}^{*} = u_k v_k$，所以\n$$\n\\langle \\hat{n}_k \\hat{n}_{\\bar{k}} \\rangle = v_k^2 v_k^2 - (u_k v_k)(-u_k v_k) = v_k^4 + u_k^2 v_k^2 .\n$$\n收集各项并注意，在相减时，对间贡献恰好重构了 $\\langle \\hat{N} \\rangle^2$，方差简化为独立对贡献之和：\n$$\n\\langle (\\Delta \\hat{N})^2 \\rangle = \\sum_{k=1}^{\\Omega} \\left[ \\left( \\langle \\hat{n}_k \\rangle + \\langle \\hat{n}_{\\bar{k}} \\rangle + 2 \\langle \\hat{n}_k \\hat{n}_{\\bar{k}} \\rangle \\right) - \\left( \\langle \\hat{n}_k \\rangle + \\langle \\hat{n}_{\\bar{k}} \\rangle \\right)^2 \\right] .\n$$\n代入表达式，\n$$\n\\langle (\\Delta \\hat{N})^2 \\rangle = \\sum_{k=1}^{\\Omega} \\left[ 2 v_k^2 + 2 \\left( v_k^4 + u_k^2 v_k^2 \\right) - \\left( 2 v_k^2 \\right)^2 \\right]\n= \\sum_{k=1}^{\\Omega} \\left[ 2 v_k^2 + 2 v_k^4 + 2 u_k^2 v_k^2 - 4 v_k^4 \\right] .\n$$\n使用 $u_k^2 = 1 - v_k^2$，这变为\n$$\n\\langle (\\Delta \\hat{N})^2 \\rangle = \\sum_{k=1}^{\\Omega} \\left[ 2 v_k^2 + 2 v_k^4 + 2 (1 - v_k^2) v_k^2 - 4 v_k^4 \\right]\n= \\sum_{k=1}^{\\Omega} \\left[ 2 v_k^2 + 2 v_k^4 + 2 v_k^2 - 2 v_k^4 - 4 v_k^4 \\right] = \\sum_{k=1}^{\\Omega} 4 v_k^2 (1-v_k^2) = 4\\sum_{k=1}^{\\Omega}u_k^2v_k^2 .\n$$\n上述推导最终得到了标准结果。\n\n该形式揭示了对对偶张量 $\\kappa_{k\\bar{k}} = u_k v_k$ 和正常密度 $\\rho_{kk} = v_k^2$ 的依赖关系。特别地，\n$$\nu_k^2 v_k^2 = (u_k v_k)^2 = \\kappa_{k\\bar{k}}^2 = v_k^2 (1 - v_k^2) ,\n$$\n所以\n$$\n\\langle (\\Delta \\hat{N})^2 \\rangle = 4 \\sum_{k=1}^{\\Omega} \\kappa_{k\\bar{k}}^2 = 4 \\sum_{k=1}^{\\Omega} v_k^2 (1 - v_k^2) .\n$$\n我们现在用HFB谱参数 $\\Delta$、$\\lambda$ 和 $\\epsilon_k$ 来表示它。正则振幅满足\n$$\nv_k^2 = \\frac{1}{2} \\left( 1 - \\frac{\\epsilon_k - \\lambda}{E_k} \\right), \\quad u_k^2 = \\frac{1}{2} \\left( 1 + \\frac{\\epsilon_k - \\lambda}{E_k} \\right) ,\n$$\n其中 $E_k = \\sqrt{(\\epsilon_k - \\lambda)^2 + \\Delta^2}$。因此，\n$$\nu_k^2 v_k^2 = \\left[ \\frac{1}{2} \\left( 1 + \\frac{\\epsilon_k - \\lambda}{E_k} \\right) \\right] \\left[ \\frac{1}{2} \\left( 1 - \\frac{\\epsilon_k - \\lambda}{E_k} \\right) \\right]\n= \\frac{1}{4} \\left( 1 - \\frac{(\\epsilon_k - \\lambda)^2}{E_k^2} \\right) = \\frac{1}{4} \\frac{E_k^2 - (\\epsilon_k - \\lambda)^2}{E_k^2} = \\frac{1}{4} \\frac{\\Delta^2}{E_k^2} .\n$$\n代入方差中，\n$$\n\\langle (\\Delta \\hat{N})^2 \\rangle = 4 \\sum_{k=1}^{\\Omega} \\left( \\frac{1}{4} \\frac{\\Delta^2}{E_k^2} \\right) = \\sum_{k=1}^{\\Omega} \\frac{\\Delta^2}{E_k^2} = \\Delta^2 \\sum_{k=1}^{\\Omega} \\frac{1}{(\\epsilon_k - \\lambda)^2 + \\Delta^2} .\n$$\n\n这个最终表达式明确显示，粒子数方差由通过$\\Delta$体现的对偶关联以及通过$(\\epsilon_k - \\lambda)$体现的与费米面的谱邻近度决定。此外，因为$\\langle (\\Delta \\hat{N})^2 \\rangle$可以写成$4 \\sum_k \\kappa_{k\\bar{k}}^2$，它与对偶张量平方的积分成正比；更强的对偶（更大的$|\\kappa|$或更大的$\\Delta$）会增加粒子数涨落。\n\n关于投影能量增益，在粒子数投影方法中，投影能量可以使用规范角（粒子数）投影核在HFB态周围展开。在Kamlah展开中，对平均场能量的领头修正涉及二阶项，该项与粒子数方差以及一个编码能量对规范角旋转响应的曲率系数成正比。对于吸引对偶相互作用，该系数为正，这意味着投影能量降低的量与$\\langle (\\Delta \\hat{N})^2 \\rangle$成正比。因此，上面推导的方差设定了恢复粒子数对称性所带来的能量增益的标度：更大的$\\Delta$和$\\lambda$附近更多的能级会增加$\\langle (\\Delta \\hat{N})^2 \\rangle$，从而增加投影能量增益。\n\n综合得到最终的闭合形式表达式，我们有\n$$\n\\langle (\\Delta \\hat{N})^2 \\rangle = \\Delta^2 \\sum_{k=1}^{\\Omega} \\frac{1}{(\\epsilon_k - \\lambda)^2 + \\Delta^2} .\n$$", "answer": "$$\\boxed{\\Delta^{2}\\sum_{k=1}^{\\Omega}\\frac{1}{(\\epsilon_{k}-\\lambda)^{2}+\\Delta^{2}}}$$", "id": "3601927"}]}