{"hands_on_practices": [{"introduction": "在Hartree-Fock理论的核心，核子在由所有其他核子产生的平均场中运动。这个练习将指导你完成一个基本但至关重要的计算：从最简单的Skyrme能量密度泛函出发，通过泛函求导，推导出对应的平均场势。掌握这一技能是理解和应用更复杂能量密度泛函的第一步 [@problem_id:3566780]。", "problem": "考虑一个在Hartree-Fock (HF)方法下处理的自旋饱和、同位旋标量核，其能量泛函中仅保留了中心零程Skyrme参数$t_{0}$项的相互作用。在这种简化设定下，$t_{0}$项对总能量的贡献由以下泛函建模：\n$$\nE_{t_{0}}[\\rho] = \\frac{t_{0}}{2} \\int \\rho(\\mathbf{r})^{2} \\, d^{3}\\mathbf{r},\n$$\n其中$t_{0}$为常数，$\\rho(\\mathbf{r})$为局域粒子密度。在一个迭代HF方案中，由该项贡献的局域平均场势通过泛函导数$U_{t_{0}}(\\mathbf{r}) = \\frac{\\delta E_{t_{0}}}{\\delta \\rho(\\mathbf{r})}$得到，并用于构建下一次迭代的单粒子哈密顿量。\n\n假设在某次迭代中，密度是球对称的，并由以下高斯分布给出：\n$$\n\\rho(r) = \\rho_{0} \\exp\\!\\left(-\\frac{r^{2}}{b^{2}}\\right),\n$$\n其中$r = |\\mathbf{r}|$，且$\\rho_{0}  0$和$b  0$是常数。\n\n任务：\n1. 从HF框架内平均场的变分定义出发，推导由$t_{0}$项为给定的$\\rho(r)$所产生的局域平均场势$U_{t_{0}}(r)$的显式形式。\n2. 在迭代方案的自洽不动点上，定态性意味着与辅助泛函\n$$\nF[\\rho] = E_{t_{0}}[\\rho] - \\int U_{t_{0}}(\\mathbf{r}) \\, \\rho(\\mathbf{r}) \\, d^{3}\\mathbf{r}\n$$\n相关的欧拉-拉格朗日条件得到满足，即$\\frac{\\delta F}{\\delta \\rho(\\mathbf{r})} = 0$。当$\\rho(r)$具有上述高斯形式时，对推导出的$U_{t_{0}}(r)$显式地验证此条件。\n\n你的最终答案必须是用$t_{0}$、$\\rho_{0}$、$b$和$r$表示的$U_{t_{0}}(r)$的闭合形式表达式。不需要进行数值计算，也不适用四舍五入。使用自然指数函数表示指数。", "solution": "该问题提出了一个在Hartree-Fock (HF)框架内使用零程Skyrme相互作用项的简化原子核模型。它要求完成两个不同的任务：首先，推导与给定高斯密度分布相对应的平均场势；其次，验证一个与辅助泛函的定态性相关的自洽条件。该问题具有科学依据，提法明确，并提供了求解所需的所有要素。\n\n**任务1：推导平均场势$U_{t_{0}}(r)$**\n\n出发点是单粒子平均场势$U_{t_{0}}(\\mathbf{r})$的定义，即能量泛函$E_{t_{0}}[\\rho]$对局域粒子密度$\\rho(\\mathbf{r})$的泛函导数。\n给定的能量泛函为：\n$$\nE_{t_{0}}[\\rho] = \\frac{t_{0}}{2} \\int \\rho(\\mathbf{r})^{2} \\, d^{3}\\mathbf{r}\n$$\n因此，平均场势为：\n$$\nU_{t_{0}}(\\mathbf{r}) = \\frac{\\delta E_{t_{0}}}{\\delta \\rho(\\mathbf{r})}\n$$\n能量泛函$E_{t_{0}}[\\rho]$是一个函数的积分，该函数仅依赖于密度$\\rho(\\mathbf{r})$的局域值。这样的泛函称为局域或超局域泛函。对于任何形式为$E[\\rho] = \\int \\mathcal{E}(\\rho(\\mathbf{r})) d^3\\mathbf{r}$的局域泛函，其泛函导数就是被积函数$\\mathcal{E}$对$\\rho$的偏导数，并在局域密度$\\rho(\\mathbf{r})$处取值。\n在我们的例子中，能量密度（被积函数）是$\\mathcal{E}_{t_{0}}(\\rho) = \\frac{t_{0}}{2} \\rho^{2}$。\n因此，泛函导数为：\n$$\nU_{t_{0}}(\\mathbf{r}) = \\frac{\\partial \\mathcal{E}_{t_{0}}}{\\partial \\rho}\\bigg|_{\\rho=\\rho(\\mathbf{r})} = \\frac{\\partial}{\\partial \\rho} \\left( \\frac{t_{0}}{2} \\rho^{2} \\right) \\bigg|_{\\rho=\\rho(\\mathbf{r})}\n$$\n将$\\rho$作为变量进行偏微分，得到：\n$$\n\\frac{\\partial}{\\partial \\rho} \\left( \\frac{t_{0}}{2} \\rho^{2} \\right) = \\frac{t_{0}}{2} (2\\rho) = t_{0}\\rho\n$$\n在局域密度$\\rho(\\mathbf{r})$处计算此结果，得到适用于任何密度分布的平均场势的通用表达式：\n$$\nU_{t_{0}}(\\mathbf{r}) = t_{0} \\rho(\\mathbf{r})\n$$\n问题指明，在某次特定迭代中，密度具有球对称的高斯形式：\n$$\n\\rho(r) = \\rho_{0} \\exp\\left(-\\frac{r^{2}}{b^{2}}\\right)\n$$\n其中$r = |\\mathbf{r}|$。将此特定密度分布代入势的通用表达式，我们得到$U_{t_{0}}(r)$的显式形式：\n$$\nU_{t_{0}}(r) = t_{0} \\rho_{0} \\exp\\left(-\\frac{r^{2}}{b^{2}}\\right)\n$$\n这就是对于给定的高斯密度，由$t_{0}$项产生的局域平均场势的闭合形式表达式。\n\n**任务2：验证欧拉-拉格朗日条件**\n\n第二个任务是在自洽不动点上验证辅助泛函的定态性条件$\\frac{\\delta F}{\\delta \\rho(\\mathbf{r})} = 0$：\n$$\nF[\\rho] = E_{t_{0}}[\\rho] - \\int U_{t_{0}}(\\mathbf{r}') \\, \\rho(\\mathbf{r}') \\, d^{3}\\mathbf{r}'\n$$\n在自洽解的背景下，第二项中出现的势$U_{t_{0}}(\\mathbf{r}')$是由自洽密度本身产生的。因此，在对$F[\\rho]$进行变分时，它被视为一个固定的外场。我们使用在第一个任务中推导出的$U_{t_{0}}(r)$的表达式。作为可变密度场$\\rho$的泛函，辅助泛函为：\n$$\nF[\\rho] = \\frac{t_{0}}{2} \\int \\rho(\\mathbf{r'})^{2} \\, d^{3}\\mathbf{r'} - \\int \\left[ t_{0} \\rho_{0} \\exp\\left(-\\frac{r'^{2}}{b^{2}}\\right) \\right] \\rho(\\mathbf{r'}) \\, d^{3}\\mathbf{r'}\n$$\n我们现在计算$F[\\rho]$对$\\rho(\\mathbf{r})$的泛函导数：\n$$\n\\frac{\\delta F}{\\delta \\rho(\\mathbf{r})} = \\frac{\\delta}{\\delta \\rho(\\mathbf{r})} \\left( \\frac{t_{0}}{2} \\int \\rho(\\mathbf{r'})^{2} \\, d^{3}\\mathbf{r'} \\right) - \\frac{\\delta}{\\delta \\rho(\\mathbf{r})} \\left( \\int \\left[ t_{0} \\rho_{0} \\exp\\left(-\\frac{r'^{2}}{b^{2}}\\right) \\right] \\rho(\\mathbf{r'}) \\, d^{3}\\mathbf{r'} \\right)\n$$\n第一项是我们在任务1中计算的泛函导数，即$t_{0}\\rho(\\mathbf{r})$。第二项是形式为$\\int f(\\mathbf{r}')\\rho(\\mathbf{r}')d^3\\mathbf{r'}$的线性泛函的泛函导数，它就是系数函数$f(\\mathbf{r})$。在我们的例子中，系数函数是固定的自洽势$U_{t_0}(\\mathbf{r})$。\n因此，我们有：\n$$\n\\frac{\\delta F}{\\delta \\rho(\\mathbf{r})} = t_{0}\\rho(\\mathbf{r}) - t_{0} \\rho_{0} \\exp\\left(-\\frac{r^{2}}{b^{2}}\\right)\n$$\n定态性条件必须*在*自洽不动点处检验，这意味着我们必须通过将可变密度$\\rho(\\mathbf{r})$设为自洽密度$\\rho(r) = \\rho_{0} \\exp\\left(-\\frac{r^{2}}{b^{2}}\\right)$来计算该导数。\n将此代入我们的导数表达式中，得到：\n$$\n\\frac{\\delta F}{\\delta \\rho(\\mathbf{r})} \\bigg|_{\\rho(r)=\\rho_0 \\exp(-r^2/b^2)} = t_{0}\\left[ \\rho_{0} \\exp\\left(-\\frac{r^{2}}{b^{2}}\\right) \\right] - t_{0} \\rho_{0} \\exp\\left(-\\frac{r^{2}}{b^{2}}\\right) = 0\n$$\n对于所有的$\\mathbf{r}$，这个结果恒为零。因此，对于给定的密度及其产生的势，欧拉-拉格朗日条件$\\frac{\\delta F}{\\delta \\rho(\\mathbf{r})} = 0$得到显式验证，从而证实了解的自洽性。\n\n所要求的最终答案是$U_{t_0}(r)$的表达式。", "answer": "$$\n\\boxed{t_{0} \\rho_{0} \\exp\\left(-\\frac{r^{2}}{b^{2}}\\right)}\n$$", "id": "3566780"}, {"introduction": "为了更真实地模拟多体效应和核物质的饱和性质，现代Skyrme相互作用通常包含依赖于核子密度的耦合项。这种密度依赖性为平均场贡献了一个称为“重排势”的关键项。本练习将引导你推导出这个重排势，理解它对于正确应用密度依赖相互作用及其物理意义至关重要 [@problem_id:3591447]。", "problem": "在计算核物理中，由 Skyrme 有效相互作用构建的能量密度泛函 (EDFs) 通常包含密度依赖的耦合函数，以捕捉介质效应和模拟多体关联。考虑一个均匀同位旋标量体系的能量泛函贡献，其形式如下\n$$\nE[\\rho] = \\int d^{3}r\\, C\\!\\left(\\rho(\\mathbf{r})\\right)\\,\\rho^{2}(\\mathbf{r}),\n$$\n其中 $\\,\\rho(\\mathbf{r})\\,$ 是局域核子数密度，$\\,C(\\rho)\\,$ 是一个光滑的标量耦合函数，它只依赖于同一位置 $\\,\\mathbf{r}\\,$ 处的局域密度值。使用泛函导数的定义，即在微扰 $\\,\\rho(\\mathbf{r}) \\to \\rho(\\mathbf{r}) + \\epsilon\\,\\delta\\rho(\\mathbf{r})\\,$ (其中 $\\,\\epsilon \\to 0\\,$) 下，一阶变分 $\\,\\delta E\\,$ 中 $\\,\\delta \\rho(\\mathbf{r})\\,$ 的系数，推导局域平均场势的显式解析表达式\n$$\n\\frac{\\delta E}{\\delta \\rho(\\mathbf{r})},\n$$\n该表达式需用 $\\,\\rho(\\mathbf{r})\\,$、$\\,C\\!\\left(\\rho(\\mathbf{r})\\right)\\,$ 以及普通导数 $\\,C'\\!\\left(\\rho(\\mathbf{r})\\right) = \\frac{dC}{d\\rho}\\big|_{\\rho=\\rho(\\mathbf{r})}\\,$ 来表示。请明确指出哪个项源于耦合函数的密度依赖性。将最终答案表示为单个闭合形式的解析表达式。无需进行数值近似。", "solution": "在尝试解答之前，对问题进行验证。\n\n### 步骤 1：提取已知条件\n- 均匀同位旋标量体系的能量泛函：$E[\\rho] = \\int d^{3}r\\, C\\!\\left(\\rho(\\mathbf{r})\\right)\\,\\rho^{2}(\\mathbf{r})$\n- $\\rho(\\mathbf{r})$：局域核子数密度\n- $C(\\rho)$：一个光滑的标量耦合函数，仅依赖于局域密度 $\\rho(\\mathbf{r})$\n- 泛函导数的定义：在微扰 $\\rho(\\mathbf{r}) \\to \\rho(\\mathbf{r}) + \\epsilon\\,\\delta\\rho(\\mathbf{r})$（其中 $\\epsilon \\to 0$）下，一阶变分 $\\delta E$ 中 $\\delta \\rho(\\mathbf{r})$ 的系数。\n- 待求量：局域平均场势，$\\frac{\\delta E}{\\delta \\rho(\\mathbf{r})}$。\n- 答案要求形式：用 $\\rho(\\mathbf{r})$、$C(\\rho(\\mathbf{r}))$ 和 $C'(\\rho(\\mathbf{r})) = \\frac{dC}{d\\rho}|_{\\rho=\\rho(\\mathbf{r})}$ 表示的显式解析表达式。\n- 附加要求：明确指出源于耦合函数密度依赖性的项。\n\n### 步骤 2：使用已知条件进行验证\n对问题的科学合理性、适定性和客观性进行审查。\n- **科学依据：** 该问题是核密度泛函理论 (DFT) 中的一个标准练习。能量泛函的结构，特别是带有密度依赖耦合 $C(\\rho)$ 的形式，是 Skyrme-Hartree-Fock 及相关模型的典型特征。通过泛函微分计算单粒子势是该领域的一个基本步骤。由相互作用的密度依赖性产生的“重排项”是一个公认且物理上至关重要的概念。该问题在科学上是合理的。\n- **适定性：** 问题为能量泛函提供了清晰明确的数学表达式，并为待计算的泛函导数提供了精确的定义。所有项都定义良好。存在一个唯一、稳定且有意义的解，并且可以直接从所提供的信息中推导出来。\n- **客观性：** 问题以客观、技术性的语言表述，没有任何主观论断或模糊不清之处。\n\n### 步骤 3：结论与行动\n该问题是**有效的**。它自洽、科学正确且数学上适定。可以开始求解过程。\n\n局域平均场势定义为能量泛函 $E[\\rho]$ 对局域密度 $\\rho(\\mathbf{r})$ 的泛函导数。能量泛函给定为：\n$$\nE[\\rho] = \\int d^{3}r\\, C\\!\\left(\\rho(\\mathbf{r})\\right)\\,\\rho^{2}(\\mathbf{r})\n$$\n我们可以将其写成能量密度泛函 $\\mathcal{E}(\\rho(\\mathbf{r}))$ 的积分形式，即 $E[\\rho] = \\int d^{3}r\\, \\mathcal{E}(\\rho(\\mathbf{r}))$，其中 $\\mathcal{E}(\\rho) = C(\\rho)\\rho^{2}$。\n\n为了求泛函导数，我们考虑密度场的一个小变分 $\\rho(\\mathbf{r}) \\to \\rho(\\mathbf{r}) + \\delta\\rho(\\mathbf{r})$，其中 $\\delta\\rho(\\mathbf{r})$ 是一个无穷小变化。总能量相应的一阶变分 $\\delta E$ 由下式给出：\n$$\n\\delta E = E[\\rho + \\delta\\rho] - E[\\rho]\n$$\n根据定义，泛函导数 $\\frac{\\delta E}{\\delta \\rho(\\mathbf{r})}$ 是满足以下关系的函数：\n$$\n\\delta E = \\int d^{3}r\\, \\frac{\\delta E}{\\delta \\rho(\\mathbf{r})} \\delta\\rho(\\mathbf{r})\n$$\n由于被积函数 $\\mathcal{E}(\\rho(\\mathbf{r}))$ 只依赖于局域密度 $\\rho(\\mathbf{r})$ 而不依赖于其梯度，泛函导数简化为能量密度 $\\mathcal{E}$ 对 $\\rho$ 的普通导数：\n$$\n\\frac{\\delta E}{\\delta \\rho(\\mathbf{r})} = \\frac{d\\mathcal{E}(\\rho)}{d\\rho}\\bigg|_{\\rho=\\rho(\\mathbf{r})}\n$$\n我们现在计算 $\\mathcal{E}(\\rho) = C(\\rho)\\rho^{2}$ 的这个导数。我们必须对 $\\rho$ 应用乘法法则求导：\n$$\n\\frac{d\\mathcal{E}}{d\\rho} = \\frac{d}{d\\rho} \\left[ C(\\rho)\\rho^{2} \\right] = \\left(\\frac{dC}{d\\rho}\\right) \\rho^{2} + C(\\rho) \\left(\\frac{d}{d\\rho}\\rho^{2}\\right)\n$$\n进行微分得到：\n$$\n\\frac{d\\mathcal{E}}{d\\rho} = \\left(\\frac{dC}{d\\rho}\\right) \\rho^{2} + C(\\rho) (2\\rho)\n$$\n使用问题中指定的记法，其中 $C'(\\rho) = \\frac{dC}{d\\rho}$，我们有：\n$$\n\\frac{d\\mathcal{E}}{d\\rho} = C'(\\rho) \\rho^{2} + 2C(\\rho)\\rho\n$$\n在局域密度 $\\rho(\\mathbf{r})$ 处对此式求值，即可得到局域平均场势的表达式：\n$$\n\\frac{\\delta E}{\\delta \\rho(\\mathbf{r})} = 2C\\!\\left(\\rho(\\mathbf{r})\\right)\\rho(\\mathbf{r}) + C'\\!\\left(\\rho(\\mathbf{r})\\right)\\rho^{2}(\\mathbf{r})\n$$\n该表达式由两个不同的项组成。\n第一项 $2C\\!\\left(\\rho(\\mathbf{r})\\right)\\rho(\\mathbf{r})$ 来自能量密度中 $\\rho^{2}$ 因子的变分。它代表了如果耦合 $C$ 是一个常数时将产生的平均场。\n第二项 $C'\\!\\left(\\rho(\\mathbf{r})\\right)\\rho^{2}(\\mathbf{r})$ 特别源于耦合函数的密度依赖性，因为它涉及导数 $C'(\\rho)$。如果 $C$ 是一个常数，$C'$ 将为零，该项将消失。这个贡献在核物理中被称为**重排势**。这是一个关键的多体效应，它解释了这样一个事实：在 $\\mathbf{r}$ 点增加一个核子会改变局域密度，而这又会改变所有核子所感受到的有效相互作用 $C(\\rho)$。\n最终的表达式是这两项贡献之和。", "answer": "$$\n\\boxed{2C\\!\\left(\\rho(\\mathbf{r})\\right)\\rho(\\mathbf{r}) + C'\\!\\left(\\rho(\\mathbf{r})\\right)\\rho^{2}(\\mathbf{r})}\n$$", "id": "3591447"}, {"introduction": "Skyrme参数并非基本常数，而是通过拟合已知的核性质（如饱和性质）和理论计算（如纯中子物质的量子蒙特卡洛方法结果）来确定的。这个高级计算练习模拟了一项真实的研究任务：你将校准一个简化的Skyrme泛函，并计算对天体物理学至关重要的对称能斜率参数 $L$。通过这个实践，你将深入理解核物质饱和性质、中子物质状态方程和有效质量之间的相互作用 [@problem_id:3591471]。", "problem": "您需要实现一个计算程序，以校准简化的Skyrme有效相互作用的选定参数，使其适应纯中子物质的量子蒙特卡洛（QMC）输入，同时保持对称核物质的饱和性质。Skyrme模型被简化为零程中心项和一个在相关密度范围内被视为常数的同位旋标量有效质量。目标是测试对称能的斜率参数如何依赖于所施加的同位旋标量有效质量和拟合的同位旋矢量耦合。\n\n基本基础。使用以下定义：\n- 在重子密度为 $\\rho$ 的均匀对称核物质（SNM）中，每个粒子的能量为\n$$\n\\frac{E}{A}\\bigg|_{\\mathrm{SNM}}(\\rho) \\;=\\; \\frac{E_{\\mathrm{kin}}}{A}\\bigg|_{\\mathrm{SNM}}(\\rho) \\;+\\; \\frac{3}{8}\\,t_0\\,\\rho \\;+\\; \\frac{1}{16}\\,t_3\\,\\rho^{\\alpha+1},\n$$\n其中 $t_0$ 和 $t_3$ 是Skyrme耦合常数，$\\alpha$ 是类三体项的密度指数。\n- 在密度为 $\\rho$ 的均匀纯中子物质（PNM）中，每个粒子的能量为\n$$\n\\frac{E}{A}\\bigg|_{\\mathrm{PNM}}(\\rho) \\;=\\; \\frac{E_{\\mathrm{kin}}}{A}\\bigg|_{\\mathrm{PNM}}(\\rho) \\;+\\; \\frac{1}{4}\\,t_0\\,(1-x_0)\\,\\rho \\;+\\; \\frac{1}{24}\\,t_3\\,(1-x_3)\\,\\rho^{\\alpha+1},\n$$\n其中 $x_0$ 和 $x_3$ 是相应的同位旋矢量交换参数。\n- 每个粒子的动能被视为具有同位旋标量有效质量 $m^*$ 的无相互作用费米气体，并假定在所考虑的密度区间内为常数。使用 $\\hbar^2/(2m) = 20.73553\\,\\mathrm{MeV}\\cdot\\mathrm{fm}^2$ 和指定的 $m^*/m$，定义 $\\hbar^2/(2m^*) = \\left(\\hbar^2/(2m)\\right)\\,(m/m^*)$。然后\n$$\n\\frac{E_{\\mathrm{kin}}}{A}\\bigg|_{\\mathrm{SNM}}(\\rho) \\;=\\; \\frac{3}{5}\\,\\frac{\\hbar^2}{2m^*}\\,k_{F,\\mathrm{SNM}}^2,\\quad k_{F,\\mathrm{SNM}} \\;=\\; \\bigg(\\frac{3\\pi^2\\,\\rho}{2}\\bigg)^{1/3},\n$$\n$$\n\\frac{E_{\\mathrm{kin}}}{A}\\bigg|_{\\mathrm{PNM}}(\\rho) \\;=\\; \\frac{3}{5}\\,\\frac{\\hbar^2}{2m^*}\\,k_{F,\\mathrm{PNM}}^2,\\quad k_{F,\\mathrm{PNM}} \\;=\\; \\big(\\,3\\pi^2\\,\\rho\\,\\big)^{1/3}.\n$$\n- 在密度为 $\\rho_0$ 和每个粒子能量为 $E_0/A$ 时，对SNM施加饱和条件，即\n$$\n\\frac{E}{A}\\bigg|_{\\mathrm{SNM}}(\\rho_0) \\;=\\; E_0/A,\\qquad \\frac{d}{d\\rho}\\bigg(\\frac{E}{A}\\bigg|_{\\mathrm{SNM}}(\\rho)\\bigg)\\bigg|_{\\rho=\\rho_0} \\;=\\; 0.\n$$\n这两个方程确定了选定 $(m^*/m,\\alpha)$ 对应的 $t_0$ 和 $t_3$。\n- 在 $t_0$ 和 $t_3$ 固定的情况下，通过最小化模型PNM每个粒子的能量与一组密度 $\\{\\rho_i\\}$ 下的QMC目标值之间的最小二乘误差来确定 $x_0$ 和 $x_3$：\n$$\n\\min_{x_0,x_3}\\;\\sum_i \\bigg(\\frac{E}{A}\\bigg|_{\\mathrm{PNM}}(\\rho_i) - \\Big(\\frac{E}{A}\\Big)_{\\mathrm{QMC}}(\\rho_i)\\bigg)^2.\n$$\n- 对称能为 $S(\\rho) = \\frac{E}{A}|_{\\mathrm{PNM}}(\\rho) - \\frac{E}{A}|_{\\mathrm{SNM}}(\\rho)$，斜率参数为\n$$\nL \\;=\\; 3\\,\\rho_0\\,\\frac{d S(\\rho)}{d\\rho}\\bigg|_{\\rho=\\rho_0}.\n$$\n对于当前具有恒定 $m^*/m$ 且仅有 $t_0,t_3$ 中心项的模型，\n$$\nS(\\rho) \\;=\\; \\bigg(\\frac{E_{\\mathrm{kin}}}{A}\\bigg|_{\\mathrm{PNM}} - \\frac{E_{\\mathrm{kin}}}{A}\\bigg|_{\\mathrm{SNM}}\\bigg) \\;-\\; \\frac{(1+2x_0)\\,t_0}{8}\\,\\rho \\;-\\; \\frac{(1+2x_3)\\,t_3}{48}\\,\\rho^{\\alpha+1},\n$$\n因此\n$$\nL \\;=\\; 2\\,S_{\\mathrm{kin}}(\\rho_0) \\;-\\; 3\\,\\rho_0\\,\\frac{(1+2x_0)\\,t_0}{8} \\;-\\; 3\\,\\rho_0\\,\\frac{(1+2x_3)\\,t_3}{48}\\,(\\alpha+1)\\,\\rho_0^{\\alpha},\n$$\n其中 $S_{\\mathrm{kin}}(\\rho_0) = \\frac{E_{\\mathrm{kin}}}{A}\\big|_{\\mathrm{PNM}}(\\rho_0) - \\frac{E_{\\mathrm{kin}}}{A}\\big|_{\\mathrm{SNM}}(\\rho_0)$。\n\n数值和单位约定：\n- 使用 $\\rho$ 单位为 $\\mathrm{fm}^{-3}$，能量单位为 $\\mathrm{MeV}$，并将 $L$ 以 $\\mathrm{MeV}$ 表示。将 $m^*/m$ 视为无量纲常数。\n- 使用 $\\rho_0 = 0.16\\,\\mathrm{fm}^{-3}$，$E_0/A = -16.0\\,\\mathrm{MeV}$，以及 $\\alpha = 1/6$。\n- 使用从PNM表达式导出的变量 $(1-x_0)$ 和 $(1-x_3)$，对下列密度值进行线性最小二乘拟合，以确定 $x_0$ 和 $x_3$。\n\n任务：\n1. 对于每个测试用例，给定 $(m^*/m)$，根据在 $\\rho_0$ 处的两个SNM饱和条件确定 $t_0$ 和 $t_3$。\n2. 使用提供的PNM的QMC目标值，对 $\\rho \\le 0.10\\,\\mathrm{fm}^{-3}$ 的数据通过最小二乘法拟合 $x_0$ 和 $x_3$。\n3. 计算每种情况下相应的对称能斜率参数 $L$（单位为 $\\mathrm{MeV}$）。\n\n测试套件：\n- 情况 $1$（边界有效质量）：$(m^*/m) = 1.0$，$\\rho$ 值为 $[0.04,\\,0.08,\\,0.10]\\,\\mathrm{fm}^{-3}$，$\\big(E/A\\big)_{\\mathrm{QMC}}$ 值为 $[4.0,\\,9.5,\\,12.0]\\,\\mathrm{MeV}$。\n- 情况 $2$（典型有效质量）：$(m^*/m) = 0.9$，使用相同的 $\\rho$ 值，$\\big(E/A\\big)_{\\mathrm{QMC}}$ 值为 $[5.0,\\,11.0,\\,14.0]\\,\\mathrm{MeV}$。\n- 情况 $3$（低有效质量）：$(m^*/m) = 0.7$，使用相同的 $\\rho$ 值，$\\big(E/A\\big)_{\\mathrm{QMC}}$ 值为 $[6.0,\\,12.5,\\,16.0]\\,\\mathrm{MeV}$。\n\n角度单位不适用。没有百分比。\n\n要求的最终输出格式：\n- 您的程序应生成一行输出，其中包含三个测试用例的 $L$ 值（单位为 $\\mathrm{MeV}$），每个值四舍五入到三位小数，以逗号分隔并用方括号括起来。例如：[$L_1,L_2,L_3$]。", "solution": "用户希望针对不同的量子蒙特卡洛（QMC）数据集，为一个经过校准的简化Skyrme相互作用找到对称能斜率参数 $L$。该校准取决于所施加的同位旋标量有效质量 $m^*/m$。对于每个测试用例，该过程包括三个主要步骤：\n1.  通过强制执行对称核物质（SNM）的经验饱和性质来确定Skyrme参数 $t_0$ 和 $t_3$。\n2.  通过对纯中子物质（PNM）的QMC数据进行最小二乘拟合来确定同位旋矢量交换参数 $x_0$ 和 $x_3$。\n3.  使用已确定的参数计算斜率参数 $L$。\n\n我们给定了以下常数和经验值：\n-   SNM的饱和密度：$\\rho_0 = 0.16\\,\\mathrm{fm}^{-3}$\n-   SNM的饱和能量：$E_0/A = -16.0\\,\\mathrm{MeV}$\n-   密度依赖指数：$\\alpha = 1/6$\n-   物理常数：$\\hbar^2/(2m) = 20.73553\\,\\mathrm{MeV}\\cdot\\mathrm{fm}^2$\n\n### 步骤1：确定 $t_0$ 和 $t_3$\n\nSNM中每个粒子的能量由下式给出：\n$$ \\frac{E}{A}\\bigg|_{\\mathrm{SNM}}(\\rho) = \\frac{E_{\\mathrm{kin}}}{A}\\bigg|_{\\mathrm{SNM}}(\\rho) + \\frac{3}{8}\\,t_0\\,\\rho + \\frac{1}{16}\\,t_3\\,\\rho^{\\alpha+1} $$\n动能部分对应于具有有效质量 $m^*$ 的费米气体：\n$$ \\frac{E_{\\mathrm{kin}}}{A}\\bigg|_{\\mathrm{SNM}}(\\rho) = \\frac{3}{5}\\frac{\\hbar^2}{2m^*}\\left(\\frac{3\\pi^2\\rho}{2}\\right)^{2/3} = C_{kin,S}\\,\\rho^{2/3} $$\n其中，对于给定的 $m^*/m$，$C_{kin,S}$ 是一个常数。\n\n在 $\\rho=\\rho_0$ 处的两个饱和条件是：\n1.  能量条件：$\\frac{E}{A}\\big|_{\\mathrm{SNM}}(\\rho_0) = E_0/A$\n    $$ C_{kin,S}\\,\\rho_0^{2/3} + \\frac{3}{8}\\,t_0\\,\\rho_0 + \\frac{1}{16}\\,t_3\\,\\rho_0^{\\alpha+1} = E_0/A $$\n    整理后得到我们关于 $t_0$ 和 $t_3$ 的第一个线性方程：\n    $$ \\left(\\frac{3}{8}\\rho_0\\right)t_0 + \\left(\\frac{1}{16}\\rho_0^{\\alpha+1}\\right)t_3 = \\frac{E_0}{A} - \\frac{E_{\\mathrm{kin}}}{A}\\bigg|_{\\mathrm{SNM}}(\\rho_0) $$\n\n2.  压力条件：$\\frac{d}{d\\rho}\\left(\\frac{E}{A}\\big|_{\\mathrm{SNM}}\\right)\\big|_{\\rho_0} = 0$\n    $$ \\frac{2}{3} C_{kin,S}\\,\\rho_0^{-1/3} + \\frac{3}{8}\\,t_0 + \\frac{1}{16}(\\alpha+1)t_3\\,\\rho_0^{\\alpha} = 0 $$\n    整理后得到我们的第二个线性方程：\n    $$ \\left(\\frac{3}{8}\\right)t_0 + \\left(\\frac{\\alpha+1}{16}\\rho_0^{\\alpha}\\right)t_3 = -\\frac{2}{3\\rho_0} \\frac{E_{\\mathrm{kin}}}{A}\\bigg|_{\\mathrm{SNM}}(\\rho_0) $$\n\n这两个方程构成一个 $2 \\times 2$ 线性系统，对于每个给定的 $m^*/m$，我们求解该系统以得到 $t_0$ 和 $t_3$。\n\n### 步骤2：确定 $x_0$ 和 $x_3$\n\nPNM中每个粒子的能量为：\n$$ \\frac{E}{A}\\bigg|_{\\mathrm{PNM}}(\\rho) = \\frac{E_{\\mathrm{kin}}}{A}\\bigg|_{\\mathrm{PNM}}(\\rho) + \\frac{1}{4}\\,t_0\\,(1-x_0)\\,\\rho + \\frac{1}{24}\\,t_3\\,(1-x_3)\\,\\rho^{\\alpha+1} $$\n我们需要通过最小化与给定密度 $\\rho_i$ 下的QMC数据 $\\big(E/A\\big)_{\\mathrm{QMC}}(\\rho_i)$ 的平方误差和来拟合参数 $(1-x_0)$ 和 $(1-x_3)$。我们重新整理PNM能量方程以建立一个线性最小二乘问题。\n\n设 $c_0 = (1-x_0)$ 和 $c_3 = (1-x_3)$。对于每个QMC数据点 $(\\rho_i, E_i)$，我们有：\n$$ E_i - \\frac{E_{\\mathrm{kin}}}{A}\\bigg|_{\\mathrm{PNM}}(\\rho_i) = \\left(\\frac{1}{4} t_0 \\rho_i\\right) c_0 + \\left(\\frac{1}{24} t_3 \\rho_i^{\\alpha+1}\\right) c_3 $$\n这是一个形式为 $A\\mathbf{c} = \\mathbf{b}$ 的线性系统，其中 $\\mathbf{c} = [c_0, c_3]^T$。矩阵 $A$ 和向量 $\\mathbf{b}$ 由QMC数据点构造。使用标准的线性最小二乘算法求解该系统以得到 $\\mathbf{c}$。根据解，我们得到 $x_0 = 1-c_0$ 和 $x_3 = 1-c_3$。\n\n### 步骤3：计算斜率参数 $L$\n\n最后一步是使用提供的公式计算 $L$，该公式由标准定义 $L = 3\\rho_0 \\frac{dS(\\rho)}{d\\rho}\\big|_{\\rho_0}$ 导出：\n$$ L \\;=\\; 2\\,S_{\\mathrm{kin}}(\\rho_0) \\;-\\; 3\\,\\rho_0\\,\\frac{(1+2x_0)\\,t_0}{8} \\;-\\; 3\\,\\rho_0\\,\\frac{(1+2x_3)\\,t_3}{48}\\,(\\alpha+1)\\,\\rho_0^{\\alpha} $$\n其中 $S_{\\mathrm{kin}}(\\rho_0)$ 是饱和密度下对称能的动能部分：\n$$ S_{\\mathrm{kin}}(\\rho_0) = \\frac{E_{\\mathrm{kin}}}{A}\\bigg|_{\\mathrm{PNM}}(\\rho_0) - \\frac{E_{\\mathrm{kin}}}{A}\\bigg|_{\\mathrm{SNM}}(\\rho_0) $$\n在 $\\rho_0$ 处，PNM和SNM的动能由下式给出：\n$$ \\frac{E_{\\mathrm{kin}}}{A}\\bigg|_{\\mathrm{SNM}}(\\rho_0) = \\frac{3}{5}\\frac{\\hbar^2}{2m^*}\\left(\\frac{3\\pi^2\\rho_0}{2}\\right)^{2/3} $$\n$$ \\frac{E_{\\mathrm{kin}}}{A}\\bigg|_{\\mathrm{PNM}}(\\rho_0) = \\frac{3}{5}\\frac{\\hbar^2}{2m^*}\\left(3\\pi^2\\rho_0\\right)^{2/3} $$\n通过代入先前步骤中获得的 $t_0, t_3, x_0, x_3$ 的值，我们可以为每个测试用例计算 $L$。\n\n计算实现将针对测试套件中指定的每个用例遵循这三个步骤。收集每个用例的 $L$ 结果，并按要求格式打印。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the calibration of a simplified Skyrme interaction\n    and calculate the symmetry energy slope L for all test cases.\n    \"\"\"\n    \n    # Fundamental constants and fixed parameters from the problem statement\n    HBARC_SQ_2M = 20.73553  # MeV * fm^2\n    RHO_0 = 0.16             # fm^-3\n    E_PER_A_0 = -16.0        # MeV\n    ALPHA = 1.0 / 6.0\n\n    test_cases = [\n        {'msm': 1.0, 'rho_qmc': np.array([0.04, 0.08, 0.10]), 'E_qmc': np.array([4.0, 9.5, 12.0])},\n        {'msm': 0.9, 'rho_qmc': np.array([0.04, 0.08, 0.10]), 'E_qmc': np.array([5.0, 11.0, 14.0])},\n        {'msm': 0.7, 'rho_qmc': np.array([0.04, 0.08, 0.10]), 'E_qmc': np.array([6.0, 12.5, 16.0])},\n    ]\n\n    results = []\n    for case in test_cases:\n        msm = case['msm']\n        rho_qmc = case['rho_qmc']\n        E_qmc = case['E_qmc']\n\n        # Effective constant for kinetic energy calculations, incorporating m*/m\n        hbarc_sq_2ms = HBARC_SQ_2M / msm\n\n        # --- Step 1: Determine t0 and t3 from SNM saturation conditions ---\n        \n        # Kinetic energy of SNM at saturation density rho_0\n        kF_snm_sq = (3 * np.pi**2 * RHO_0 / 2)**(2.0/3.0)\n        Ekin_snm_rho0 = (3.0 / 5.0) * hbarc_sq_2ms * kF_snm_sq\n\n        # Set up the 2x2 linear system for (t0, t3) based on saturation energy and pressure\n        A_sat = np.zeros((2, 2))\n        b_sat = np.zeros(2)\n\n        A_sat[0, 0] = 3.0 / 8.0 * RHO_0\n        A_sat[0, 1] = 1.0 / 16.0 * RHO_0**(ALPHA + 1)\n        A_sat[1, 0] = 3.0 / 8.0\n        A_sat[1, 1] = (ALPHA + 1) / 16.0 * RHO_0**ALPHA\n\n        b_sat[0] = E_PER_A_0 - Ekin_snm_rho0\n        b_sat[1] = -2.0 / 3.0 * Ekin_snm_rho0 / RHO_0\n        \n        t0, t3 = np.linalg.solve(A_sat, b_sat)\n\n        # --- Step 2: Fit x0 and x3 from PNM data using least squares ---\n\n        # The PNM energy equation is rearranged for a linear fit of c = [1-x0, 1-x3]\n        # This takes the form A_ls * c = b_ls\n        n_points = len(rho_qmc)\n        A_ls = np.zeros((n_points, 2))\n        b_ls = np.zeros(n_points)\n\n        for i, rho in enumerate(rho_qmc):\n            # Kinetic energy of PNM at density rho_i\n            kF_pnm_sq_i = (3 * np.pi**2 * rho)**(2.0/3.0)\n            Ekin_pnm_i = (3.0 / 5.0) * hbarc_sq_2ms * kF_pnm_sq_i\n            \n            # Coefficients for the linear variables (1-x0) and (1-x3)\n            A_ls[i, 0] = 1.0 / 4.0 * t0 * rho\n            A_ls[i, 1] = 1.0 / 24.0 * t3 * rho**(ALPHA + 1)\n            \n            # Target value for the fit (QMC energy minus kinetic energy)\n            b_ls[i] = E_qmc[i] - Ekin_pnm_i\n\n        # Solve the least squares problem for the coefficients c\n        c, _, _, _ = np.linalg.lstsq(A_ls, b_ls, rcond=None)\n        oneminus_x0, oneminus_x3 = c[0], c[1]\n        x0 = 1.0 - oneminus_x0\n        x3 = 1.0 - oneminus_x3\n\n        # --- Step 3: Compute the symmetry energy slope parameter L ---\n        \n        # Kinetic part of the symmetry energy at saturation density\n        kF_pnm_sq_rho0 = (3 * np.pi**2 * RHO_0)**(2.0/3.0)\n        Ekin_pnm_rho0 = (3.0 / 5.0) * hbarc_sq_2ms * kF_pnm_sq_rho0\n        Skin_rho0 = Ekin_pnm_rho0 - Ekin_snm_rho0\n\n        # Calculate L using the formula from the problem statement\n        term1_L = 2 * Skin_rho0\n        term2_L = -3 * RHO_0 * t0 * (1 + 2 * x0) / 8.0\n        term3_L = -3 * RHO_0 * t3 * (1 + 2 * x3) * (ALPHA + 1) * RHO_0**ALPHA / 48.0\n        \n        L = term1_L + term2_L + term3_L\n        results.append(f\"{L:.3f}\")\n\n    # Final print statement in the exact required format\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "3591471"}]}