{"hands_on_practices": [{"introduction": "深入理解像Bardeen-Cooper-Schrieffer (BCS) 这样复杂理论的最佳方式之一，是将其应用于一个简单的、可精确求解的系统中。[@problem_id:3594122]这项练习将处理一个对称的双能级模型，它允许我们解析地求解BCS方程。通过将BCS基态能量与哈密顿量对角化得到的精确能量进行比较，我们可以直接评估平均场近似的准确性，并理解其局限性，尤其是在小系统中。", "problem": "考虑一个对称双能级常数配对模型，该模型用于描述跨越费米能的两个壳模型轨道中的同类核子。单粒子能级相对于化学势的能量为 $+\\epsilon$ 和 $-\\epsilon$，每个能级的对简并度为 $\\Omega$（即，每个能级包含 $\\Omega$ 个时间反演对轨道）。配对哈密顿量为\n$$\nH \\;=\\; \\sum_{j=\\pm} \\epsilon_{j} \\, N_{j} \\;-\\; G \\sum_{j,l=\\pm} P_{j}^{\\dagger} P_{l},\n$$\n其中 $\\epsilon_{+} = +\\epsilon$, $\\epsilon_{-} = -\\epsilon$，$N_{j}$ 计算能级 $j$ 中的粒子数，而 $P_{j}^{\\dagger} \\equiv \\sum_{m>0} c_{j m}^{\\dagger} c_{j \\bar{m}}^{\\dagger}$ 在能级 $j$ 上创建一个对（$c_{j m}^{\\dagger}$ 在能级 $j$ 的单粒子态 $m$ 上创建一个核子，$c_{j \\bar{m}}^{\\dagger}$ 创建其时间反演伴侣）。该系统在对的方面是半满的，$N_{\\text{pairs}} = \\Omega$，因此总对容量 $2\\Omega$ 的一半恰好被占据。\n\n使用 Bardeen-Cooper-Schrieffer (BCS) 变分框架，配对强度为均匀的 $G>0$：\n\n- 从第一性原理出发（从 BCS 变分拟设及其自洽条件开始），推导该对称双能级半满模型下 BCS 方程的解析解。特别地，通过对称性确定化学势的值，并获得配对能隙 $\\Delta$ 关于 $\\epsilon$、$G$ 和 $\\Omega$ 的闭式表达式。\n\n- 从 $H$ 的 BCS 期望值和能隙自洽关系出发，推导该双能级模型中 BCS 基态能量 $E_{\\text{BCS}}$ 的解析闭式表达式，该表达式仅依赖于 $\\epsilon$、$G$ 和 $\\Omega$（不含中间变量 $u_{j}$、$v_{j}$ 或 $\\mu$）。\n\n- 对于 $\\Omega = 1$ 的有限系统，通过在由 $\\{\\,|1\\rangle = P_{-}^{\\dagger} |0\\rangle,\\; |2\\rangle = P_{+}^{\\dagger} |0\\rangle\\,\\}$ 张成的单对子空间中对角化 $H$，计算精确的 seniority-zero 基态能量 $E_{\\text{exact}}$。然后，对于参数值 $\\epsilon = 0.50 \\text{ MeV}$ 和 $G = 0.60 \\text{ MeV}$，计算分数能量误差\n$$\n\\delta \\;=\\; \\frac{E_{\\text{BCS}} - E_{\\text{exact}}}{|E_{\\text{exact}}|},\n$$\n将你最终的数值 $\\delta$ 四舍五入到四位有效数字。将最终数字表示为纯小数（不带百分号）。", "solution": "该问题分为三个主要部分：推导双能级模型的BCS解，推导其BCS基态能量，然后与$\\Omega=1$的精确解进行比较。\n\n### 第1步：双能级模型的BCS解\n\nBCS理论对配对系统的基态采用一种变分拟设。基态由每个能级 $j$ 的对关联态的乘积来近似：\n$$\n|\\text{BCS}\\rangle = \\prod_{j, m>0} (u_j + v_j c_{jm}^{\\dagger} c_{j\\bar{m}}^{\\dagger}) |0\\rangle\n$$\n其中 $u_j^2 + v_j^2 = 1$。为了找到最优的 $u_j$ 和 $v_j$，我们最小化巨势算符 $\\hat{K} = H - \\mu N$ 的期望值。\n在平均场近似中，$\\langle \\hat{K} \\rangle = \\sum_{j=\\pm} 2\\Omega (\\epsilon_j - \\mu) v_j^2 - \\frac{\\Delta^2}{G}$，其中配对能隙 $\\Delta$ 由自洽关系 $\\Delta = G \\sum_j \\Omega u_j v_j$ 定义。\n\n对 $\\langle \\hat{K} \\rangle$ 进行变分最小化，得到标准的BCS方程：\n$$\nv_j^2 = \\frac{1}{2} \\left(1 - \\frac{\\epsilon_j - \\mu}{E_j}\\right), \\quad \\text{其中 } E_j = \\sqrt{(\\epsilon_j - \\mu)^2 + \\Delta^2} \\text{ 是准粒子能量。}\n$$\n化学势 $\\mu$ 和能隙 $\\Delta$ 由粒子数方程和能隙方程自洽地确定。\n\n**粒子数方程**：总粒子数为 $N = 2 N_{\\text{pairs}} = 2\\Omega$。\n$$\nN = \\sum_{j=\\pm} \\langle N_j \\rangle = \\sum_{j=\\pm} 2\\Omega v_j^2 = 2\\Omega \\implies v_-^2 + v_+^2 = 1\n$$\n$$\n\\frac{1}{2} \\left(1 - \\frac{-\\epsilon - \\mu}{E_-}\\right) + \\frac{1}{2} \\left(1 - \\frac{\\epsilon - \\mu}{E_+}\\right) = 1 \\implies \\frac{\\epsilon + \\mu}{E_-} + \\frac{\\epsilon - \\mu}{E_+} = 0\n$$\n对于非平凡解 ($\\Delta \\neq 0$)，该方程要求 $(\\epsilon+\\mu)^2 = (\\epsilon-\\mu)^2$，这意味着 $\\mu=0$（由于能级对称和半满条件）。\n\n**能隙方程**：将 $\\mu=0$ 代入能隙方程 $\\Delta = G \\sum_j \\Omega u_j v_j = G \\sum_j \\Omega \\frac{\\Delta}{2E_j}$，我们得到：\n$$\n1 = \\frac{G\\Omega}{2} \\sum_{j=\\pm} \\frac{1}{E_j}\n$$\n当 $\\mu=0$ 时，$E_- = E_+ = \\sqrt{\\epsilon^2 + \\Delta^2}$。因此：\n$$\n1 = \\frac{G\\Omega}{2} \\left( \\frac{2}{\\sqrt{\\epsilon^2 + \\Delta^2}} \\right) = \\frac{G\\Omega}{\\sqrt{\\epsilon^2 + \\Delta^2}}\n$$\n解出 $\\Delta$：\n$$\n\\sqrt{\\epsilon^2 + \\Delta^2} = G\\Omega \\implies \\epsilon^2 + \\Delta^2 = (G\\Omega)^2\n$$\n$$\n\\Delta = \\sqrt{(G\\Omega)^2 - \\epsilon^2}\n$$\n该解在 $G\\Omega > \\epsilon$ 时存在。\n\n### 第2步：BCS基态能量\n\nBCS基态能量是哈密顿量 $H$ 在BCS态中的期望值：\n$$\nE_{\\text{BCS}} = \\langle H \\rangle = \\sum_{j=\\pm} 2\\Omega \\epsilon_j v_j^2 - \\frac{\\Delta^2}{G}\n$$\n使用 $\\mu=0$，$v_j^2 = \\frac{1}{2} (1 - \\epsilon_j/E_j)$，其中 $E_j = \\sqrt{\\epsilon^2+\\Delta^2} = G\\Omega$。\n$$\nE_{\\text{BCS}} = \\Omega \\sum_{j=\\pm} \\epsilon_j \\left(1 - \\frac{\\epsilon_j}{E_j}\\right) - \\frac{\\Delta^2}{G} = \\Omega \\left( (\\epsilon - \\frac{\\epsilon^2}{E}) + (-\\epsilon - \\frac{(-\\epsilon)^2}{E}) \\right) - \\frac{\\Delta^2}{G}\n$$\n$$\nE_{\\text{BCS}} = \\Omega \\left(-\\frac{2\\epsilon^2}{E}\\right) - \\frac{\\Delta^2}{G} = -\\frac{2\\Omega\\epsilon^2}{G\\Omega} - \\frac{(G\\Omega)^2 - \\epsilon^2}{G}\n$$\n$$\nE_{\\text{BCS}} = \\frac{-2\\epsilon^2 - (G^2\\Omega^2 - \\epsilon^2)}{G} = \\frac{-\\epsilon^2 - G^2\\Omega^2}{G} = -\\frac{\\epsilon^2}{G} - G\\Omega^2\n$$\n\n### 第3步：$\\Omega = 1$ 的精确解及分数误差\n\n对于 $\\Omega = 1$ 和 $N_{\\text{pairs}}=1$，seniority-zero基矢为 $\\{|1\\rangle = P_{-}^{\\dagger} |0\\rangle, |2\\rangle = P_{+}^{\\dagger} |0\\rangle\\}$。我们在此基中构建哈密顿量矩阵 $H_{ij} = \\langle i | H | j \\rangle$。\n- **对角元**：$H_{11} = \\langle 1|H|1 \\rangle = \\langle 1|(\\epsilon N_+ - \\epsilon N_-)|1\\rangle - G\\langle 1|(P_+^\\dagger + P_-^\\dagger)(P_+ + P_-)|1\\rangle$。第一项为 $-2\\epsilon$。第二项中，由于正交性，只有 $P_-^\\dagger P_-$ 项有贡献，其值为 $G\\langle1|P_-^\\dagger P_-|1\\rangle=G$。所以，$H_{11} = -2\\epsilon - G$。同样，$H_{22} = 2\\epsilon - G$。\n- **非对角元**：$H_{12} = \\langle 1|H|2 \\rangle$。单粒子部分为零。相互作用部分为 $-G\\langle 1|(P_-^\\dagger P_+ + P_+^\\dagger P_-)|2\\rangle = -G\\langle 1|P_-^\\dagger P_+|2\\rangle = -G$。\n\n哈密顿量矩阵为：\n$$\n\\mathbf{H} = \\begin{pmatrix} -2\\epsilon - G  -G \\\\ -G  2\\epsilon - G \\end{pmatrix}\n$$\n其本征值为 $E = -G \\pm \\sqrt{4\\epsilon^2 + G^2}$。精确基态能量是较小的那个：\n$$\nE_{\\text{exact}} = -G - \\sqrt{4\\epsilon^2 + G^2}\n$$\n现在，我们计算当 $\\epsilon = 0.50 \\text{ MeV}$，$G = 0.60 \\text{ MeV}$ 且 $\\Omega = 1$ 时的分数误差 $\\delta$。\n\n**BCS 能量**：\n$$\nE_{\\text{BCS}} = -\\frac{\\epsilon^2}{G} - G\\Omega^2 = -\\frac{(0.50)^2}{0.60} - (0.60)(1)^2 = -\\frac{0.25}{0.60} - 0.60 \\approx -0.416667 - 0.60 = -1.016667 \\text{ MeV}\n$$\n**精确能量**：\n$$\nE_{\\text{exact}} = -0.60 - \\sqrt{4(0.50)^2 + (0.60)^2} = -0.60 - \\sqrt{1.00 + 0.36} = -0.60 - \\sqrt{1.36} \\approx -0.60 - 1.166190 = -1.766190 \\text{ MeV}\n$$\n**分数误差 $\\delta$**：\n$$\n\\delta = \\frac{E_{\\text{BCS}} - E_{\\text{exact}}}{|E_{\\text{exact}}|} = \\frac{-1.016667 - (-1.766190)}{|-1.766190|} = \\frac{0.749523}{1.766190} \\approx 0.424360\n$$\n四舍五入到四位有效数字，我们得到 $\\delta = 0.4244$。", "answer": "$$\n\\boxed{0.4244}\n$$", "id": "3594122"}, {"introduction": "在理解了BCS是一种近似之后，[@problem_id:3594137]这项练习将探讨其最著名的特征之一：对粒子数守恒的违背。BCS基态是具有不同粒子数的态的叠加。这项练习将指导你推导并计算粒子数方差 $\\sigma_{N}^{2}$，从而将这一抽象概念具体化，并为给定系统量化此对称性破缺的程度。", "problem": "考虑一个适用于中等质量核的有限价空间，该空间由 $K$ 对时间反演的单粒子态 $\\{k,\\bar{k}\\}$ (Kramers 简并) 张成。Bardeen-Cooper-Schrieffer (BCS) 态定义为归一化的乘积态\n$$\n|\\Phi\\rangle \\equiv \\prod_{k=1}^{K} \\left(u_{k} + v_{k}\\,a_{k}^{\\dagger}a_{\\bar{k}}^{\\dagger}\\right)|0\\rangle,\n$$\n其中 $a_{k}^{\\dagger}$ 在态 $k$ 上产生一个核子，$a_{\\bar{k}}^{\\dagger}$ 产生其时间反演伴态，且实数 BCS 振幅满足 $u_{k}^{2} + v_{k}^{2} = 1$。粒子数算符为\n$$\n\\hat{N} \\equiv \\sum_{k=1}^{K}\\left(a_{k}^{\\dagger}a_{k} + a_{\\bar{k}}^{\\dagger}a_{\\bar{k}}\\right).\n$$\n仅从这些定义、费米子的正则反对易关系以及乘积态中期望值的标准性质出发，完成以下任务：\n\n1) 推导粒子数方差\n$$\n\\sigma_{N}^{2} \\equiv \\langle \\Phi|\\hat{N}^{2}|\\Phi\\rangle - \\langle \\Phi|\\hat{N}|\\Phi\\rangle^{2}\n$$\n的一个显式表达式，该表达式纯粹用 $\\{u_{k},v_{k}\\}$ 表示。\n\n2) 现在，特别考虑一个概略的常数能隙平均场，其特征为一个实数配对能隙 $\\Delta$ 和化学势 $\\mu$，其中准粒子能量 $E_{k}$ 依赖于单粒子能量偏移 $\\xi_{k} \\equiv \\epsilon_{k} - \\mu$。考虑一个具有 $K = 6$ 个对轨道的模型空间，其偏移量为\n$$\n\\{\\xi_{k}\\} = \\{-1.5,\\,-1.0,\\,-0.5,\\,+0.5,\\,+1.0,\\,+1.5\\}\\ \\text{MeV},\n$$\n并取 $\\Delta = 0.80\\ \\text{MeV}$ 和 $\\mu = 0\\ \\text{MeV}$。仅使用 $\\{u_{k},v_{k}\\}$、$\\{\\xi_{k}\\}$ 和 $\\{E_{k}\\}$ 之间的标准 BCS 关系，计算此模型空间的方差 $\\sigma_{N}^{2}$。\n\n将你的 $\\sigma_{N}^{2}$ 最终结果报告为一个纯数（无量纲），并四舍五入到四位有效数字。最终答案中不要包含单位。", "solution": "该问题分为两部分。第一部分要求推导 Bardeen-Cooper-Schrieffer (BCS) 态中粒子数方差 $\\sigma_{N}^{2}$ 的通用表达式。第二部分要求对一个特定的模型系统计算该方差的数值。\n\n### 第1部分：粒子数方差的推导\n\n粒子数方差定义为 $\\sigma_{N}^{2} \\equiv \\langle \\Phi|\\hat{N}^{2}|\\Phi\\rangle - \\langle \\Phi|\\hat{N}|\\Phi\\rangle^{2}$。我们将分别计算这两项。\n\nBCS 态 $|\\Phi\\rangle$ 是每个对能级 $k$ 的态 $|\\phi_k\\rangle = (u_{k} + v_{k}a_{k}^{\\dagger}a_{\\bar{k}}^{\\dagger})|0\\rangle$ 的乘积。由于不同能级的算符作用于乘积态的不同部分，总粒子数方差是每个对能级方差的和：\n$$\n\\sigma_{N}^{2} = \\sum_{k=1}^{K} \\sigma_{\\hat{n}_k}^2 = \\sum_{k=1}^{K} \\left( \\langle\\hat{n}_k^2\\rangle - \\langle\\hat{n}_k\\rangle^2 \\right)\n$$\n其中 $\\hat{n}_k = a_{k}^{\\dagger}a_{k} + a_{\\bar{k}}^{\\dagger}a_{\\bar{k}}$ 是能级 $k$ 的粒子数算符。\n能级 $k$ 是一个叠加态，其中有0个粒子的概率为 $u_k^2$，有2个粒子的概率为 $v_k^2$。\n\n对于单个能级 $k$：\n-   平均粒子数：$\\langle\\hat{n}_k\\rangle = 0 \\cdot u_k^2 + 2 \\cdot v_k^2 = 2v_k^2$。\n-   粒子数平方的平均值：$\\langle\\hat{n}_k^2\\rangle = 0^2 \\cdot u_k^2 + 2^2 \\cdot v_k^2 = 4v_k^2$。\n\n因此，能级 $k$ 的方差为：\n$$\n\\sigma_{\\hat{n}_k}^2 = \\langle\\hat{n}_k^2\\rangle - \\langle\\hat{n}_k\\rangle^2 = 4v_k^2 - (2v_k^2)^2 = 4v_k^2 - 4v_k^4 = 4v_k^2(1 - v_k^2)\n$$\n使用归一化条件 $u_k^2 + v_k^2 = 1$，我们得到 $1 - v_k^2 = u_k^2$。\n$$\n\\sigma_{\\hat{n}_k}^2 = 4u_k^2v_k^2\n$$\n总粒子数方差是所有能级的总和：\n$$\n\\sigma_{N}^{2} = \\sum_{k=1}^{K} 4u_k^2v_k^2\n$$\n这就完成了问题的第一部分。\n\n### 第2部分：数值计算\n\n在第二部分中，我们必须将 BCS 振幅 $\\{u_k, v_k\\}$ 与模型的物理参数联系起来。BCS 理论中的标准关系是：\n$$\nv_k^2 = \\frac{1}{2}\\left(1 - \\frac{\\xi_k}{E_k}\\right) \\quad \\text{and} \\quad u_k^2 = \\frac{1}{2}\\left(1 + \\frac{\\xi_k}{E_k}\\right)\n$$\n其中 $E_k = \\sqrt{\\xi_k^2 + \\Delta^2}$ 是能级 $k$ 的准粒子能量，$\\xi_k = \\epsilon_k - \\mu$ 是相对于化学势 $\\mu$ 的单粒子能量，$\\Delta$ 是配对能隙。\n\n我们将这些关系代入 $\\sigma_N^2$ 的表达式中：\n$$\n4u_k^2v_k^2 = 4 \\left[\\frac{1}{2}\\left(1 + \\frac{\\xi_k}{E_k}\\right)\\right] \\left[\\frac{1}{2}\\left(1 - \\frac{\\xi_k}{E_k}\\right)\\right] = 1 - \\frac{\\xi_k^2}{E_k^2}\n$$\n现在，使用 $E_k^2 = \\xi_k^2 + \\Delta^2$：\n$$\n4u_k^2v_k^2 = 1 - \\frac{\\xi_k^2}{\\xi_k^2 + \\Delta^2} = \\frac{(\\xi_k^2 + \\Delta^2) - \\xi_k^2}{\\xi_k^2 + \\Delta^2} = \\frac{\\Delta^2}{\\xi_k^2 + \\Delta^2}\n$$\n于是总方差由以下求和给出：\n$$\n\\sigma_{N}^{2} = \\sum_{k=1}^{K} \\frac{\\Delta^2}{\\xi_k^2 + \\Delta^2}\n$$\n现在我们使用给定的数值：$K=6$，$\\Delta = 0.80\\ \\text{MeV}$，以及 $\\{\\xi_{k}\\} = \\{-1.5, -1.0, -0.5, +0.5, +1.0, +1.5\\}\\ \\text{MeV}$。\n配对能隙的平方是 $\\Delta^2 = (0.80)^2 = 0.64\\ \\text{MeV}^2$。\n$\\xi_k^2$ 的值为 $\\{2.25, 1.00, 0.25, 0.25, 1.00, 2.25\\}\\ \\text{MeV}^2$。\n$\\sigma_{N}^{2}$ 的求和由 $K=6$ 个能级各自的贡献组成。由于表达式依赖于 $\\xi_k^2$，$\\xi_k = \\pm c$ 的能级贡献相等。\n$$\n\\sigma_N^2 = 2 \\left( \\frac{0.64}{1.5^2 + 0.64} + \\frac{0.64}{1.0^2 + 0.64} + \\frac{0.64}{0.5^2 + 0.64} \\right)\n$$\n$$\n\\sigma_N^2 = 2 \\left( \\frac{0.64}{2.25 + 0.64} + \\frac{0.64}{1.00 + 0.64} + \\frac{0.64}{0.25 + 0.64} \\right)\n$$\n$$\n\\sigma_N^2 = 2 \\left( \\frac{0.64}{2.89} + \\frac{0.64}{1.64} + \\frac{0.64}{0.89} \\right)\n$$\n对各项进行数值计算：\n$$\n\\frac{0.64}{2.89} \\approx 0.221453\n$$\n$$\n\\frac{0.64}{1.64} \\approx 0.390244\n$$\n$$\n\\frac{0.64}{0.89} \\approx 0.719101\n$$\n将这些贡献相加并乘以 2：\n$$\n\\sigma_N^2 \\approx 2 (0.221453 + 0.390244 + 0.719101) = 2 (1.330798) = 2.661596\n$$\n四舍五入到四位有效数字，我们得到 $\\sigma_N^2 = 2.662$。", "answer": "$$\\boxed{2.662}$$", "id": "3594137"}, {"introduction": "最后的这项练习 [@problem_id:3594147] 将从纸笔上的理论过渡到计算物理实践。你将实现一个BCS方程的数值求解器，以研究核结构中的一个关键现象：幻数核处的对关联抑制。通过模拟一个双壳层模型，你将观察到壳层间巨大的能隙如何抑制对关联，以及这种效应如何对对力强度敏感，从而将抽象的方程与可观测的原子核性质联系起来。", "problem": "你的任务是编写一个完整、可运行的程序，该程序使用Bardeen-Cooper-Schrieffer (BCS) 框架，在原子核双壳层模型中演示闭合（幻数）壳层上对关联的抑制，并量化恒定对力强度的小幅增加或包含跨壳层耦合如何恢复非零的对隙。物理内容必须以数学上明确且单位一致的方式实现，以便仅凭逻辑就能产生正确的数值输出。\n\n假设一个简化的Bardeen-Cooper-Schrieffer (BCS) 哈密顿量，其具有大小为 $G$ 的恒定对相互作用，该作用将时间反演对散射到单粒子能级之间。考虑一个双壳层模型，其单粒子能量 $\\{\\epsilon_k\\}$ 以兆电子伏特 (MeV) 为单位，对简并度为 $\\{\\Omega_k\\}$（即能级 $k$ 上不同时间反演对的数量），总粒子数为 $N$。在零温下，BCS方程为\n$$\n\\Delta = G \\sum_{k} \\Omega_k u_k v_k,\n$$\n$$\nN = 2 \\sum_{k} \\Omega_k v_k^2,\n$$\n其中\n$$\nu_k^2 = \\tfrac{1}{2}\\left(1 + \\frac{\\epsilon_k - \\mu}{E_k}\\right), \\quad\nv_k^2 = \\tfrac{1}{2}\\left(1 - \\frac{\\epsilon_k - \\mu}{E_k}\\right), \\quad\nE_k = \\sqrt{(\\epsilon_k - \\mu)^2 + \\Delta^2},\n$$\n这里 $\\Delta$ 是对隙，$\\mu$ 是化学势。对于恒定的相互作用，可以消去显式的 $u_k v_k$ 因子，并将隙方程写成标准形式\n$$\n1 = G \\sum_{k} \\frac{\\Omega_k}{2 E_k}.\n$$\n对于一个具有大主壳层间隙的双壳层模型中的闭合（幻数）壳层，如果只包含低壳层（无跨壳层矩阵元），则低壳层被完全填满，且高壳层不在对空间内；在这种情况下，对无法跨越壳层间隙发生散射，唯一的自洽解是 $\\Delta = 0$。\n\n相比之下，当低壳层和高壳层都包含在对空间内时（即包含跨壳层矩阵元），一个非平凡解 $\\Delta \\neq 0$ 会出现，仅当对力强度超过一个由 $\\Delta \\to 0$ 时的线性化隙方程确定的临界值时。对于一个能量为 $\\epsilon_L = -E_{\\text{gap}}/2$ 和 $\\epsilon_U = +E_{\\text{gap}}/2$ 且对简并度为 $\\Omega_L$ 和 $\\Omega_U$ 的双能级模型，在幻数 $N = 2 \\Omega_L$ 处，化学势 $\\mu$ 在 $\\Delta = 0$ 时位于能隙中，临界耦合强度为\n$$\nG_c = \\frac{E_{\\text{gap}}}{\\Omega_L + \\Omega_U}.\n$$\n对于 $G \\le G_c$，唯一的解是 $\\Delta = 0$；对于 $G > G_c$，从 $\\Delta$ 和 $\\mu$ 的耦合方程的自洽解中会出现一个有限的 $\\Delta$。\n\n你的程序必须：\n- 在双壳层模型中实现上述零温Bardeen-Cooper-Schrieffer (BCS) 方程，并在存在非平凡解时自洽地求解 $\\Delta$ 和 $\\mu$。\n- 在排除高壳层（无跨壳层耦合）的情况下，检测在具有大壳层间隙的幻数处对关联的抑制。\n- 量化在两种不同变化下非零 $\\Delta$ 的恢复：(i) 在固定 $G$ 值下包含跨壳层矩阵元，以及 (ii) 在包含跨壳层耦合时，$G$ 值小幅跨越临界阈值。\n- 一致地使用兆电子伏特 (MeV) 单位，并以 MeV 报告对隙。\n\n数值方法要求：\n- 当两个壳层都包括在内时，你必须通过分析 $\\Delta \\to 0$ 时的线性化隙方程来确定是否存在非平凡解。对于上述双壳层情况，使用隙中化学势 $\\mu = 0$ 来评估线性化判据。如果 $G \\le G_c$，返回 $\\Delta = 0$。如果 $G > G_c$，则数值求解 $\\Delta$ 和 $\\mu$ 的耦合方程。\n- 当在幻数粒子数下只包含低壳层（无跨壳层耦合）时，返回 $\\Delta = 0$，不要尝试数值求解。\n- 对于非平凡解，使用任何适用于非线性系统的稳健数值方法求解 $\\Delta$ 和 $\\mu$ 的耦合方程。最终报告的 $\\Delta$ 必须精确到 $10^{-6}$ MeV 以内。\n\n测试套件：\n使用以下四个测试用例。在每个用例中，能量都以 MeV 为单位，输出必须是以 MeV 为单位的对隙 $\\Delta$。粒子数被设置为对应于一个完全填满的低壳层的幻数值。\n\n- 测试用例 A（无跨壳层耦合时在幻数处的抑制）：\n  - 仅低壳层：$\\{\\epsilon_L\\} = \\{-2.0\\}$, $\\{\\Omega_L\\} = \\{8\\}$。\n  - 排除高壳层。\n  - 主壳层间隙参数（供参考）：$E_{\\text{gap}} = 4.0$。\n  - 粒子数：$N = 2 \\Omega_L = 16$。\n  - 对力强度：$G = 0.18$。\n  - 预期行为：$\\Delta = 0$。\n\n- 测试用例 B（在固定 $G$ 值下通过包含跨壳层耦合实现恢复）：\n  - 包含两个壳层：$\\{\\epsilon_L,\\epsilon_U\\} = \\{-2.0, +2.0\\}$, $\\{\\Omega_L,\\Omega_U\\} = \\{8, 16\\}$，因此 $E_{\\text{gap}} = 4.0$。\n  - 粒子数：$N = 16$。\n  - 对力强度：$G = 0.18$。\n  - 预期行为：$G > G_c = E_{\\text{gap}}/(\\Omega_L+\\Omega_U) = 4.0/(8+16) = 0.166\\overline{6}$，因此 $\\Delta > 0$。\n\n- 测试用例 C（含跨壳层耦合但 $G$ 值低于阈值）：\n  - 包含两个壳层：$\\{\\epsilon_L,\\epsilon_U\\} = \\{-2.0, +2.0\\}$, $\\{\\Omega_L,\\Omega_U\\} = \\{8, 16\\}$。\n  - 粒子数：$N = 16$。\n  - 对力强度：$G = 0.16$。\n  - 预期行为：$G  G_c$，因此 $\\Delta = 0$。\n\n- 测试用例 D（含跨壳层耦合且 $G$ 值小幅跨越阈值）：\n  - 包含两个壳层：$\\{\\epsilon_L,\\epsilon_U\\} = \\{-2.0, +2.0\\}$, $\\{\\Omega_L,\\Omega_U\\} = \\{8, 16\\}$。\n  - 粒子数：$N = 16$。\n  - 对力强度：$G = 0.17$。\n  - 预期行为：$G$ 略大于 $G_c$，因此 $\\Delta > 0$ 但值很小。\n\n最终输出要求：\n- 对于每个测试用例，计算以 MeV 为单位的对隙 $\\Delta$。\n- 将每个 $\\Delta$ 表示为一个浮点数，并精确到六位小数（MeV）。\n- 你的程序应产生单行输出，其中包含一个逗号分隔的列表，用方括号括起来，顺序为 [A, B, C, D]。例如，一个有效的输出格式是\n\"[0.000000,0.123456,0.000000,0.012345]\".", "solution": "该问题要求实现并求解用于原子核双壳层模型的零温Bardeen-Cooper-Schrieffer (BCS) 方程，以演示和量化对关联。我们必须在不同的物理条件下求解对隙 $\\Delta$ 和化学势 $\\mu$。\n\n控制该系统的基本方程是BCS隙方程和粒子数守恒方程。对于一组由 $k$ 索引的单粒子能级，其能量为 $\\epsilon_k$，对简并度为 $\\Omega_k$（即可占据该能级的对的数量），方程为：\n$$\n\\frac{1}{G} = \\sum_{k} \\frac{\\Omega_k}{2 E_k} \\quad (\\text{for } \\Delta \\neq 0)\n$$\n$$\nN = \\sum_{k} \\Omega_k \\left(1 - \\frac{\\epsilon_k - \\mu}{E_k}\\right)\n$$\n其中 $G$ 是恒定对力强度，$N$ 是总粒子数，$\\mu$ 是化学势，$E_k$ 是能级 $k$ 的准粒子能量：\n$$\nE_k = \\sqrt{(\\epsilon_k - \\mu)^2 + \\Delta^2}\n$$\n要求解的变量是对隙 $\\Delta$ 和化学势 $\\mu$。按照惯例，对隙 $\\Delta$ 是一个非负量。\n\n问题指定了四个测试用例，它们属于不同的物理情景。我们将基于所提供的模型参数分析每种情景。\n\n**情景1：单个填满的壳层（测试用例A）**\n此用例涉及一个单一壳层，被指定为低壳层（$L$），能量为 $\\epsilon_L = -2.0$ MeV，对简并度为 $\\Omega_L = 8$。粒子数为 $N = 16$。这个数字恰好对应于填满该壳层，因为 $N = 2 \\Omega_L = 2 \\times 8 = 16$。高壳层被明确地从模型空间中排除。\n\n在BCS模型中，对关联源于粒子对在不同单粒子能级之间的散射。当只有一个壳层存在且被完全填满时，没有可用的空态供对散射进入，也没有来自其他能级的对可以散射出去。这种情况被称为“阻塞”效应。对相互作用变得无效，无法建立对关联。在这种配置下，BCS方程的唯一自洽解是一个平凡解，即对隙为零。\n因此，对于测试用例A，我们得出结论 $\\Delta = 0$ MeV，无需进行数值计算。\n\n**情景2：幻数处的双壳层模型（测试用例B、C、D）**\n这些用例涉及一个具有低壳层（$L$）和高壳层（$U$）的双壳层模型。参数如下：\n-   能量：$\\epsilon_L = -2.0$ MeV, $\\epsilon_U = +2.0$ MeV。主壳层间隙为 $E_{\\text{gap}} = \\epsilon_U - \\epsilon_L = 4.0$ MeV。\n-   简并度：$\\Omega_L = 8$, $\\Omega_U = 16$。\n-   粒子数：$N = 16 = 2 \\Omega_L$。这是一个“幻数”，对应于一个填满的低壳层。\n\n在此情景下，即使低壳层已被填满，空的高壳层的存在也提供了对可以散射进入的状态。如果对力强度 $G$ 足够大，足以克服将对提升跨越壳层间隙 $E_{\\text{gap}}$ 的能量成本，那么一个非平凡的对解（$\\Delta > 0$）就可以存在。\n\n从平凡解（$\\Delta = 0$）到非平凡解（$\\Delta > 0$）的转变发生在一个临界对力强度 $G_c$ 处。为求得 $G_c$，我们分析 $\\Delta \\to 0$ 极限下的隙方程。在此极限下，方程变为：\n$$\n\\frac{1}{G} = \\sum_{k} \\frac{\\Omega_k}{2 |\\epsilon_k - \\mu|}\n$$\n对于一个对称双能级模型（$\\epsilon_L = -\\epsilon_U$）中特定的粒子数 $N = 2 \\Omega_L$，在对关联出现时，化学势恰好位于能隙的中间，即 $\\mu = 0$。代入双壳层模型的参数：\n$$\n\\frac{1}{G_c} = \\frac{\\Omega_L}{2 |\\epsilon_L - 0|} + \\frac{\\Omega_U}{2 |\\epsilon_U - 0|} = \\frac{\\Omega_L}{2 (\\frac{E_{\\text{gap}}}{2})} + \\frac{\\Omega_U}{2 (\\frac{E_{\\text{gap}}}{2})} = \\frac{\\Omega_L + \\Omega_U}{E_{\\text{gap}}}\n$$\n这给出了临界耦合强度：\n$$\nG_c = \\frac{E_{\\text{gap}}}{\\Omega_L + \\Omega_U}\n$$\n对于我们的特定参数，$E_{\\text{gap}} = 4.0$ MeV，$\\Omega_L = 8$ 和 $\\Omega_U = 16$，临界强度为：\n$$\nG_c = \\frac{4.0}{8 + 16} = \\frac{4.0}{24} = \\frac{1}{6} \\approx 0.166667 \\text{ MeV}\n$$\n形式上的条件是：\n-   如果 $G \\le G_c$，唯一的解是平凡解 $\\Delta = 0$。\n-   如果 $G > G_c$，则存在一个 $\\Delta > 0$ 的非平凡解，必须通过数值求解耦合的BCS方程来找到。\n\n我们现在将此判据应用于其余的测试用例。\n\n**测试用例 C：** $G = 0.16$ MeV。\n由于 $0.16  1/6$，对力强度是亚临界的。因此，$\\Delta = 0$ MeV。\n\n**测试用例 B 和 D：** 分别为 $G = 0.18$ MeV 和 $G = 0.17$ MeV。\n在这两种情况下，对力强度 $G$ 都大于 $G_c \\approx 0.166667$ MeV。因此，存在一个 $\\Delta > 0$ 的非平凡解。为了找到它，我们必须求解以下关于两个未知数 $\\Delta$ 和 $\\mu$ 的两个非线性方程组：\n$$\nf_1(\\Delta, \\mu) = \\frac{1}{G} - \\frac{\\Omega_L}{2 \\sqrt{(\\epsilon_L - \\mu)^2 + \\Delta^2}} - \\frac{\\Omega_U}{2 \\sqrt{(\\epsilon_U - \\mu)^2 + \\Delta^2}} = 0\n$$\n$$\nf_2(\\Delta, \\mu) = N - \\Omega_L \\left(1 - \\frac{\\epsilon_L - \\mu}{\\sqrt{(\\epsilon_L - \\mu)^2 + \\Delta^2}}\\right) - \\Omega_U \\left(1 - \\frac{\\epsilon_U - \\mu}{\\sqrt{(\\epsilon_U - \\mu)^2 + \\Delta^2}}\\right) = 0\n$$\n该系统使用数值求根算法求解，例如Python中的 `scipy.optimize.root`。为求解器提供一个合适的初始猜测至关重要。因为我们接近临界点，我们预计 $\\Delta$ 会很小，而 $\\mu$ 会接近0。一个合理的初始猜测是 $(\\Delta_0, \\mu_0) = (0.1, 0.0)$。求解器会迭代地优化这个猜测，直到残差 $f_1$ 和 $f_2$ 同时接近于零，满足最终 $\\Delta$ 指定的 $10^{-6}$ MeV 公差。\n\n**各用例方法总结：**\n-   **用例 A**：一个填满的壳层，无高壳层。对关联被阻塞。结果：$\\Delta = 0.0$。\n-   **用例 B**：两个壳层，$G=0.18 > G_c$。形成一个非平凡对隙 $\\Delta > 0$。结果：数值求解。\n-   **用例 C**：两个壳层，$G=0.16  G_c$。对关联是亚临界的。结果：$\\Delta = 0.0$。\n-   **用例 D**：两个壳层，$G=0.17 > G_c$。对关联刚刚超临界，形成一个很小但非零的隙 $\\Delta > 0$。结果：数值求解。\n\n实现将精确地遵循这一逻辑，在用例B和D中需要时使用 `scipy.optimize.root` 进行数值求解。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import root\n\ndef solve():\n    \"\"\"\n    Solves the BCS equations for four test cases representing pairing suppression\n    and restoration in a nuclear two-shell model.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case A: Lower shell only, magic number\n        {\n            \"name\": \"A\",\n            \"shells\": {\"eps\": np.array([-2.0]), \"omg\": np.array([8])},\n            \"N\": 16,\n            \"G\": 0.18,\n            \"type\": \"one_shell_magic\"\n        },\n        # Case B: Both shells, G > Gc\n        {\n            \"name\": \"B\",\n            \"shells\": {\"eps\": np.array([-2.0, 2.0]), \"omg\": np.array([8, 16])},\n            \"N\": 16,\n            \"G\": 0.18,\n            \"type\": \"two_shell\"\n        },\n        # Case C: Both shells, G  Gc\n        {\n            \"name\": \"C\",\n            \"shells\": {\"eps\": np.array([-2.0, 2.0]), \"omg\": np.array([8, 16])},\n            \"N\": 16,\n            \"G\": 0.16,\n            \"type\": \"two_shell\"\n        },\n        # Case D: Both shells, G slightly > Gc\n        {\n            \"name\": \"D\",\n            \"shells\": {\"eps\": np.array([-2.0, 2.0]), \"omg\": np.array([8, 16])},\n            \"N\": 16,\n            \"G\": 0.17,\n            \"type\": \"two_shell\"\n        }\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        delta_val = 0.0\n        \n        if case[\"type\"] == \"one_shell_magic\":\n            # For a single, completely filled shell, pairing is blocked.\n            # The particle number N = 16 equals 2 * Omega_L = 2 * 8.\n            # The only solution is the trivial one.\n            delta_val = 0.0\n        \n        elif case[\"type\"] == \"two_shell\":\n            eps = case[\"shells\"][\"eps\"]\n            omg = case[\"shells\"][\"omg\"]\n            G = case[\"G\"]\n            N = case[\"N\"]\n            \n            # For a two-shell model at the magic number N=2*Omega_L, a non-trivial\n            # solution exists only if G > Gc.\n            E_gap = eps[1] - eps[0]\n            G_c = E_gap / np.sum(omg)\n            \n            if G = G_c:\n                # Pairing strength is sub-critical.\n                delta_val = 0.0\n            else:\n                # Pairing strength is super-critical. Solve the coupled equations.\n                \n                def bcs_system(variables, G_val, eps_vals, omg_vals, N_val):\n                    \"\"\"\n                    Defines the system of coupled BCS equations to be solved.\n                    variables = [Delta, mu]\n                    \"\"\"\n                    delta, mu = variables[0], variables[1]\n                    \n                    # Ensure Delta is positive, as it appears squared.\n                    # The solver might take a negative step, but the physical gap is positive.\n                    # Also handles the case where delta is ~0 to avoid division by zero.\n                    if np.isclose(delta, 0.0):\n                        delta = 1e-12 \n\n                    # Quasiparticle energies\n                    E_k = np.sqrt((eps_vals - mu)**2 + delta**2)\n                    \n                    # Gap equation residual\n                    # 1/G = sum(Omega_k / (2*E_k))\n                    gap_eq_residual = 1.0/G_val - np.sum(omg_vals / (2.0 * E_k))\n                    \n                    # Number equation residual\n                    # N = sum(Omega_k * (1 - (eps_k-mu)/E_k))\n                    num_eq_residual = N_val - np.sum(omg_vals * (1.0 - (eps_vals - mu) / E_k))\n                    \n                    return [gap_eq_residual, num_eq_residual]\n\n                # Initial guess [Delta, mu]. Near the critical point, Delta is small\n                # and mu is close to the mid-gap value (0).\n                initial_guess = [0.1, 0.0]\n                \n                # Solve the system of non-linear equations\n                solution = root(\n                    bcs_system, \n                    initial_guess, \n                    args=(G, eps, omg, N),\n                    method='hybr',  # A robust method for such problems\n                    tol=1e-9       # Tolerance for high accuracy\n                )\n                \n                if solution.success:\n                    # The pairing gap Delta is conventionally taken as positive.\n                    delta_val = abs(solution.x[0])\n                else:\n                    # This should not happen for the given well-posed problems.\n                    # As a fallback, report a negative value to indicate solver failure.\n                    delta_val = -1.0 \n\n        results.append(delta_val)\n\n    # Format the results to exactly six decimal places and print in the specified format.\n    formatted_results = [f\"{res:.6f}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "3594147"}]}