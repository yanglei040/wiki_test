{"hands_on_practices": [{"introduction": "任何近似方法的有效性都必须通过与精确解的比较来检验。本练习通过一个特殊设计的、可精确求解的可分离势模型，为扭曲波玻恩近似 (DWBA) 提供了一个理想的测试平台[@problem_id:3598541]。通过直接计算并对比 DWBA 振幅与 Lippmann-Schwinger 方程的精确解，你将深刻理解 DWBA 的理论基础、其近似的本质以及其适用范围。", "problem": "考虑一个$s$波中的单通道、无自旋、非相对论性双体散射问题，其中单位已固定，使得 $\\hbar = 1$ 且 $2\\mu = 1$，$\\mu$ 为约化质量。令 $E$ 表示动能，$k$ 表示满足 $E = k^2$ 的在壳动量。自由豫解算符（自由格林函数算符）表示为 $G_0(E)$，精确跃迁算符 $T(E)$ 遵循 Lippmann–Schwinger (LS) 方程 $T(E) = V + V G_0(E) T(E)$，其中 $V$ 是相互作用势算符。相互作用势被选为两个秩为1的可分离势之和，$V = U + W$，其中 $U = \\lambda_U \\lvert g_U \\rangle \\langle g_U \\rvert$ 和 $W = \\lambda_W \\lvert g_W \\rangle \\langle g_W \\rvert$。$\\lambda_U$ 和 $\\lambda_W$ 是耦合强度，动量空间中的形因子定义为 $g_U(p) = \\dfrac{1}{p^2 + \\beta_U^2}$ 和 $g_W(p) = \\dfrac{1}{p^2 + \\beta_W^2}$，力程参数为 $\\beta_U$ 和 $\\beta_W$。\n\n从第一性原理出发，以 Lippmann–Schwinger 方程和秩为1的可分离势的定义为起点，推导总相互作用 $V = U + W$ 的精确在壳跃迁振幅 $t_{\\mathrm{exact}}(k) \\equiv \\langle k \\lvert T(E) \\rvert k \\rangle$。然后，基于相同的 LS 基础和扭曲波玻恩近似 (DWBA) 的定义，推导 DWBA 在壳振幅 $t_{\\mathrm{DWBA}}(k) \\equiv \\langle k \\lvert T_{\\mathrm{DWBA}}(E) \\rvert k \\rangle$。在 DWBA 中，$U$ 被处理到所有阶，而 $W$ 在由 $U$ 生成的扭曲波基中被处理到一阶。确保您的推导明确标示出所有必需的中间算符值对象和标量，包括但不限于圈图积分 $I_{ij}(E) \\equiv \\langle g_i \\lvert G_0(E) \\rvert g_j \\rangle$（其中 $i,j \\in \\{ U, W \\}$），并阐明主值和虚部是如何从豫解算符中产生的。\n\n程序必须实现以下计算任务以验证扭曲波玻恩近似 (DWBA)：\n- 使用秩为2的可分离结构，根据 $V = U + W$ 的完整 LS 解计算 $t_{\\mathrm{exact}}(k)$。\n- 计算 $t_{\\mathrm{DWBA}}(k)$，其中扭曲波由 $U$ 生成，而 $W$ 在扭曲波玻恩的意义下被包含到领头阶。\n- 使用球坐标测度和到有限积分域的变换，在动量空间中评估圈图积分 $I_{ij}(E)$。测度必须是 $\\dfrac{d^3 p}{(2\\pi)^3}$，球坐标约化必须通过在径向积分前乘以因子 $\\dfrac{1}{2\\pi^2}$ 来处理。虚部必须源于 $G_0(E)$ 的在壳 delta 函数结构，而实部必须作为柯西主值积分进行计算。对于较小和中等的在壳动量 $k$，该计算必须是数值稳定的。\n\n对于给定的参数集，定义 DWBA 和精确 LS 之间的一致性度量为\n$$\nM \\equiv \\max_{k \\in \\mathcal{K}} \\frac{\\lvert t_{\\mathrm{DWBA}}(k) - t_{\\mathrm{exact}}(k) \\rvert}{\\lvert t_{\\mathrm{exact}}(k) \\rvert},\n$$\n其中 $\\mathcal{K}$ 是一个在壳动量的有限集合。量 $M$ 是无量纲的。如果 $\\lvert t_{\\mathrm{exact}}(k) \\rvert$ 在数值上与零无法区分，则使用正则化分母 $\\lvert t_{\\mathrm{exact}}(k) \\rvert + \\epsilon$（其中 $\\epsilon$ 是一个小数）以避免除以零，并在您的解决方案中证明 $\\epsilon$ 的选择是合理的。在此 $s$ 波计算中不出现角度，因此不需要角度单位。\n\n您的程序必须为以下参数集测试套件实现计算，每个参数集都对应一组三个在壳动量：\n- 测试用例 1（中等扭曲，弱微扰，典型能量）：$\\lambda_U = -1.0$，$\\beta_U = 1.0$，$\\lambda_W = -0.2$，$\\beta_W = 2.0$，以及 $\\mathcal{K} = \\{ 0.05, 0.30, 0.80 \\}$。\n- 测试用例 2（近阈值能量）：$\\lambda_U = -1.0$，$\\beta_U = 1.0$，$\\lambda_W = -0.2$，$\\beta_W = 2.0$，以及 $\\mathcal{K} = \\{ 0.001, 0.020, 0.050 \\}$。\n- 测试用例 3（更强微扰以探究 DWBA 失效）：$\\lambda_U = -1.0$，$\\beta_U = 1.0$，$\\lambda_W = -0.8$，$\\beta_W = 2.0$，以及 $\\mathcal{K} = \\{ 0.05, 0.30, 0.80 \\}$。\n\n您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果，顺序为测试用例 1、2 和 3，每个条目是相应测试用例的度量 $M$。例如，一个可接受的输出格式是 $\\left[ r_1, r_2, r_3 \\right]$，其中 $r_1$、$r_2$ 和 $r_3$ 是浮点数。", "solution": "该问题要求针对一个特定的非相对论性散射问题，推导并计算精确和扭曲波玻恩近似 (DWBA) 的在壳跃迁振幅。相互作用势 $V$ 是两个秩为一的可分离势之和，$V=U+W$。分析将在 $s$ 波通道中进行，单位为 $\\hbar=1$ 和 $2\\mu=1$，其中 $\\mu$ 是约化质量。对于动量 $k$，在壳能量为 $E=k^2$。\n\n首先，我们推导精确振幅和 DWBA 振幅的表达式。接下来，我们详细说明必要圈图积分的计算。最后，我们概述用于计算一致性度量 $M$ 的计算实现方案。\n\n### 1. 精确在壳振幅 $t_{\\mathrm{exact}}(k)$ 的推导\n\n总势为 $V = U + W$，其中 $U = \\lambda_U \\lvert g_U \\rangle \\langle g_U \\rvert$ 且 $W = \\lambda_W \\lvert g_W \\rangle \\langle g_W \\rvert$。跃迁算符 $T(E)$ 的 Lippmann-Schwinger (LS) 方程为\n$$\nT(E) = V + V G_0(E) T(E)\n$$\n其中 $G_0(E) = (E - H_0 + i\\epsilon)^{-1}$ 是自由豫解算符。由于 $V$ 是一个秩为二的可分离算符，解 $T(E)$ 在由 $\\{ \\lvert g_U \\rangle, \\lvert g_W \\rangle \\}$ 张成的空间内也将是一个可分离算符。我们可以假定其形式为：\n$$\nT(E) = \\sum_{i,j \\in \\{U, W\\}} \\lvert g_i \\rangle \\tau_{ij}(E) \\langle g_j \\rvert\n$$\n一种更直接和系统的方法是代数地求解该算符。让我们将 $V$ 的形式代入 LS 方程：\n$$\nT(E) = \\lambda_U \\lvert g_U \\rangle \\langle g_U \\rvert + \\lambda_W \\lvert g_W \\rangle \\langle g_W \\rvert + (\\lambda_U \\lvert g_U \\rangle \\langle g_U \\rvert + \\lambda_W \\lvert g_W \\rangle \\langle g_W \\rvert) G_0(E) T(E)\n$$\n我们定义 $T(E)$ 在形因子态之间的矩阵元：$T_{ij}(E) = \\langle g_i \\rvert T(E) \\lvert g_j \\rangle$。通过用 $\\langle g_U \\rvert$ 和 $\\langle g_W \\rvert$ 左投影 LS 方程，我们得到一个关于 $\\langle g_U \\rvert T(E)$ 和 $\\langle g_W \\rvert T(E)$ 的方程组。\n我们定义 $f_i(E, \\mathbf{p}) \\equiv \\langle g_i \\rvert T(E) \\rvert \\mathbf{p} \\rangle$。取 LS 方程左边与 $\\langle g_i \\rvert$ 右边与 $\\lvert \\mathbf{p} \\rangle$ 的矩阵元，得到：\n$$\nf_U(E, \\mathbf{p}) = \\lambda_U g_U(p) \\langle g_U \\rvert \\mathbf{p} \\rangle + \\lambda_U \\langle g_U \\rvert G_0(E) T(E) \\rvert \\mathbf{p} \\rangle \\\\\nf_W(E, \\mathbf{p}) = \\lambda_W g_W(p) \\langle g_W \\rvert \\mathbf{p} \\rangle + \\lambda_W \\langle g_W \\rvert G_0(E) T(E) \\rvert \\mathbf{p} \\rangle\n$$\n这一推理思路是不正确的。一个更简单的方法是假设 $T(E)$ 可以写成 $T(E) = \\lvert g_U \\rangle \\langle f_U \\rvert + \\lvert g_W \\rangle \\langle f_W \\rvert$。将此代入 LS 方程并假设 $\\lvert g_U \\rangle$ 和 $\\lvert g_W \\rangle$ 线性无关，可得到一个关于未知右矢 $\\langle f_U \\rvert$ 和 $\\langle f_W \\rvert$ 的耦合代数方程组：\n$$\n\\begin{pmatrix} 1 - \\lambda_U I_{UU}(E)  -\\lambda_U I_{UW}(E) \\\\ -\\lambda_W I_{WU}(E)  1 - \\lambda_W I_{WW}(E) \\end{pmatrix} \\begin{pmatrix} \\langle f_U \\rvert \\\\ \\langle f_W \\rvert \\end{pmatrix} = \\begin{pmatrix} \\lambda_U\\langle g_U \\rvert \\\\ \\lambda_W\\langle g_W \\rvert \\end{pmatrix}\n$$\n此处，$I_{ij}(E) \\equiv \\langle g_i \\rvert G_0(E) \\rvert g_j \\rangle$ 是圈图积分。这个 $2 \\times 2$ 矩阵可以求逆。令其行列式为 $D(E)$：\n$$\nD(E) = (1 - \\lambda_U I_{UU}(E))(1 - \\lambda_W I_{WW}(E)) - \\lambda_U \\lambda_W I_{UW}(E) I_{WU}(E)\n$$\n由于 $G_0$ 是自伴的且形因子是实数，所以 $I_{UW} = I_{WU}$。通过矩阵求逆可求得 $\\langle f_U \\rvert$ 和 $\\langle f_W \\rvert$ 的解。将其代回 $T(E)$ 的假设形式，并取在壳矩阵元 $\\langle k \\rvert T(E=k^2) \\rvert k \\rangle$ 可得：\n$$\nt_{\\mathrm{exact}}(k) = \\frac{1}{D(k^2)} \\left[ \\lambda_U(1-\\lambda_W I_{WW}) g_U(k)^2 + \\lambda_W(1-\\lambda_U I_{UU}) g_W(k)^2 + 2\\lambda_U\\lambda_W I_{UW} g_U(k)g_W(k) \\right]\n$$\n其中所有圈图积分 $I_{ij}$ 均在 $E=k^2+i\\epsilon$ 处求值。动量空间形因子由 $g_i(p) = 1/(p^2+\\beta_i^2)$ 给出。\n\n### 2. DWBA 在壳振幅 $t_{\\mathrm{DWBA}}(k)$ 的推导\n\n在 DWBA 中，势 $U$ 被处理到所有阶，从而产生“扭曲波”，而 $W$ 则被视为一阶微扰。此近似下的 T-算符由在 $W$ 的领头阶截断的双势公式给出：\n$$\nT_{\\mathrm{DWBA}}(E) = T_U(E) + \\Omega_U^{(-)\\dagger}(E) W \\Omega_U^{(+)}(E)\n$$\n其中 $T_U$ 是仅针对势 $U$ 的精确 T-算符，而 $\\Omega_U^{(\\pm)}(E) = 1+G_0(E)T_U(E)$ 是势 $U$ 的 Møller 波算符。在壳跃迁振幅为 $t_{\\mathrm{DWBA}}(k) = \\langle k \\rvert T_{\\mathrm{DWBA}}(E=k^2) \\rvert k \\rangle$。即：\n$$\nt_{\\mathrm{DWBA}}(k) = \\langle k \\rvert T_U(k^2) \\rvert k \\rangle + \\langle k \\rvert \\Omega_U^{(-)\\dagger}(k^2) W \\Omega_U^{(+)}(k^2) \\rvert k \\rangle\n$$\n第二项可被识别为 $W$ 在扭曲波之间的矩阵元：$\\langle \\psi_k^{(-)} \\rvert W \\rvert \\psi_k^{(+)} \\rangle$，其中 $\\lvert \\psi_k^{(+)} \\rangle = \\Omega_U^{(+)}(k^2) \\lvert k \\rangle$ 且 $\\langle \\psi_k^{(-)} \\rvert = \\langle k \\rvert \\Omega_U^{(-)\\dagger}(k^2)$。\n\n首先，我们求 $t_U(k) = \\langle k \\rvert T_U(k^2) \\rvert k \\rangle$。对于秩为1的势 $U$，T-算符为：\n$$\nT_U(E) = \\frac{\\lambda_U \\lvert g_U \\rangle \\langle g_U \\rvert}{1 - \\lambda_U I_{UU}(E)}\n$$\n因此，其在壳元为：\n$$\nt_U(k) = \\frac{\\lambda_U g_U(k)^2}{1 - \\lambda_U I_{UU}(k^2)}\n$$\n接下来，我们评估扭曲波矩阵元。扭曲态为：\n$$\n\\lvert \\psi_k^{(+)} \\rangle = (1 + G_0(k^2) T_U(k^2)) \\lvert k \\rangle = \\lvert k \\rangle + G_0(k^2) \\frac{\\lambda_U g_U(k)}{1 - \\lambda_U I_{UU}(k^2)} \\lvert g_U \\rangle\n$$\n$$\n\\langle \\psi_k^{(-)} \\rvert = \\langle k \\rvert (1 + T_U(k^2) G_0(k^2)) = \\langle k \\rvert + \\frac{\\lambda_U g_U(k)}{1 - \\lambda_U I_{UU}(k^2)} \\langle g_U \\rvert G_0(k^2)\n$$\n$W = \\lambda_W \\lvert g_W \\rangle \\langle g_W \\rvert$ 的矩阵元是 $\\lambda_W \\langle \\psi_k^{(-)} \\rvert g_W \\rangle \\langle g_W \\rvert \\psi_k^{(+)} \\rangle$。我们计算其投影：\n$$\n\\langle g_W \\rvert \\psi_k^{(+)} \\rangle = \\langle g_W \\rvert k \\rangle + \\frac{\\lambda_U g_U(k)}{1 - \\lambda_U I_{UU}(k^2)} \\langle g_W \\rvert G_0(k^2) \\rvert g_U \\rangle = g_W(k) + \\frac{\\lambda_U g_U(k) I_{WU}(k^2)}{1 - \\lambda_U I_{UU}(k^2)}\n$$\n$$\n\\langle \\psi_k^{(-)} \\rvert g_W \\rangle = \\langle k \\rvert g_W \\rangle + \\frac{\\lambda_U g_U(k)}{1 - \\lambda_U I_{UU}(k^2)} \\langle g_U \\rvert G_0(k^2) \\rvert g_W \\rangle = g_W(k) + \\frac{\\lambda_U g_U(k) I_{UW}(k^2)}{1 - \\lambda_U I_{UU}(k^2)}\n$$\n由于 $I_{UW} = I_{WU}$，这两个投影是相同的。我们将此项称为“扭曲形因子” $\\mathcal{D}_W(k)$。\n$$\n\\mathcal{D}_W(k) = g_W(k) + \\frac{\\lambda_U I_{UW}(k^2)}{1 - \\lambda_U I_{UU}(k^2)} g_U(k)\n$$\nDWBA 振幅是 $U$ 的 T-矩阵与 $W$ 在扭曲波基下的玻恩项之和：\n$$\nt_{\\mathrm{DWBA}}(k) = t_U(k) + \\lambda_W \\left( \\mathcal{D}_W(k) \\right)^2\n$$\n\n### 3. 圈图积分 $I_{ij}(E)$ 的评估\n\n圈图积分是此计算的基石。\n$$\nI_{ij}(E) = \\langle g_i \\rvert G_0(E) \\rvert g_j \\rangle = \\int \\frac{d^3p}{(2\\pi)^3} g_i(p) \\frac{1}{E - p^2 + i\\epsilon} g_j(p)\n$$\n使用指定的 $s$ 波测度 $\\frac{1}{2\\pi^2} \\int_0^\\infty p^2 dp$ 以及 $E=k^2$：\n$$\nI_{ij}(k^2) = \\frac{1}{2\\pi^2} \\int_0^\\infty dp \\, p^2 \\frac{g_i(p) g_j(p)}{k^2 - p^2 + i\\epsilon}\n$$\n利用 Sokhotski-Plemelj 定理 $\\frac{1}{x+i\\epsilon} = \\mathcal{P}\\frac{1}{x} - i\\pi\\delta(x)$，我们分离实部和虚部。\n\n虚部为：\n$$\n\\mathrm{Im} \\, I_{ij}(k^2) = -\\frac{\\pi}{2\\pi^2} \\int_0^\\infty dp \\, p^2 g_i(p) g_j(p) \\delta(k^2-p^2)\n$$\n使用 $\\delta(k^2-p^2) = \\frac{1}{2k}\\delta(p-k)$ 对于 $p, k > 0$：\n$$\n\\mathrm{Im} \\, I_{ij}(k^2) = -\\frac{1}{2\\pi} \\int_0^\\infty dp \\, p^2 g_i(p) g_j(p) \\frac{\\delta(p-k)}{2k} = -\\frac{k^2 g_i(k) g_j(k)}{4\\pi k} = -\\frac{k}{4\\pi} g_i(k) g_j(k)\n$$\n\n实部是一个柯西主值积分：\n$$\n\\mathrm{Re} \\, I_{ij}(k^2) = \\frac{1}{2\\pi^2} \\mathcal{P} \\int_0^\\infty dp \\, p^2 \\frac{g_i(p) g_j(p)}{k^2 - p^2}\n$$\n由于在 $p=k$ 处的奇点，该积分在数值上具有挑战性。我们通过减去奇异行为来对其进行正则化：\n$$\n\\mathcal{P} \\int_0^\\infty \\frac{F(p)}{k^2-p^2} dp = \\int_0^\\infty \\frac{F(p) - F(k)}{k^2-p^2} dp\n$$\n其中 $F(p) = p^2 g_i(p) g_j(p)$。现在被积函数在 $p=k$ 处是良态的，其在该点的值为极限：\n$$\n\\lim_{p \\to k} \\frac{F(p)-F(k)}{k^2-p^2} = \\lim_{p \\to k} \\frac{F(p)-F(k)}{-(p-k)(p+k)} = -\\frac{F'(k)}{2k}\n$$\n在无限域 $[0, \\infty)$ 上的积分通过 `scipy.integrate.quad` 进行数值处理，该函数采用稳健的求积方案，适用于此类瑕积分，能有效地将域映射到有限区间。对于 $k=0$ 的特殊情况，该积分不再是主值积分，可以解析求解：\n$$\n\\mathrm{Re} \\, I_{ij}(0) = -\\frac{1}{2\\pi^2} \\int_0^\\infty dp \\, g_i(p)g_j(p) = -\\frac{1}{4\\pi \\beta_i \\beta_j (\\beta_i + \\beta_j)}\n$$\n如果 $\\beta_i = \\beta_j = \\beta$，此式变为 $-\\frac{1}{8\\pi \\beta^3}$。\n\n### 4. 计算策略与度量\n\n对于每个测试用例，算法按以下步骤进行：\n1.  对于集合 $\\mathcal{K}$ 中的每个动量 $k$，如上所述数值计算复数圈图积分 $I_{UU}(k^2)$、$I_{WW}(k^2)$ 和 $IUW(k^2)$。一个辅助函数将通过实现减法方法并显式编码被积函数在奇点处的极限来处理主值积分，以确保数值稳定性。\n2.  使用这些积分和在 $k$ 处求值的形因子，利用它们各自的推导公式计算复振幅 $t_{\\mathrm{exact}}(k)$ 和 $t_{\\mathrm{DWBA}}(k)$。\n3.  对每个 $k$ 计算相对误差 $\\lvert t_{\\mathrm{DWBA}}(k) - t_{\\mathrm{exact}}(k) \\rvert / (\\lvert t_{\\mathrm{exact}}(k) \\rvert + \\epsilon)$。\n4.  在分母中引入正则化参数 $\\epsilon = 10^{-16}$。该值与 `float64` 数字的机器精度在同一数量级，其唯一作用是在 $t_{\\mathrm{exact}}(k)$ 数值上为零（类似拉姆绍尔-汤森效应的零点）时防止除以零的错误，而不会在其他方面对度量产生偏差。\n5.  该测试用例的度量 $M$ 是这些相对误差在集合 $\\mathcal{K}$ 上的最大值。\n最终输出是三个测试用例的 $M$ 值列表。", "answer": "```python\nimport numpy as np\nfrom scipy import integrate\n\ndef solve():\n    \"\"\"\n    Solves the scattering problem for the given test cases.\n\n    Derives and computes the exact and DWBA T-matrix elements for a rank-2\n    separable potential. It then calculates a metric of agreement between\n    the two approximations for three different parameter sets.\n    \"\"\"\n\n    # Epsilon for regularization of the metric's denominator\n    EPSILON = 1e-16\n\n    # Test cases: (lambda_U, beta_U, lambda_W, beta_W, k_values)\n    test_cases = [\n        (-1.0, 1.0, -0.2, 2.0, [0.05, 0.30, 0.80]),\n        (-1.0, 1.0, -0.2, 2.0, [0.001, 0.020, 0.050]),\n        (-1.0, 1.0, -0.8, 2.0, [0.05, 0.30, 0.80]),\n    ]\n\n    # Store a cache for loop integral calculations to avoid re-computation\n    # Key: (k, beta_i, beta_j)\n    loop_integral_cache = {}\n\n    def get_form_factor(p, beta):\n        \"\"\"Calculates the Yamaguchi form factor g(p).\"\"\"\n        return 1.0 / (p**2 + beta**2)\n\n    def calculate_loop_integral(k, beta_i, beta_j):\n        \"\"\"\n        Calculates the complex loop integral I_ij(k^2).\n        I_ij(E) =", "id": "3598541"}, {"introduction": "在核反应中，相互作用的空间形式深刻地影响着角动量转移的特征。本练习利用一个表面相互作用的简化模型，旨在揭示反应区域的“局域化”如何导致某些特定的轨道角动量分波（即 $\\ell$ 值）占据主导地位[@problem_id:3598601]。这个练习将帮助你建立关于反应动力学如何决定最终角分布的物理直觉，这是理解直接核反应的关键一步。", "problem": "考虑一个简化的扭曲波玻恩近似 (DWBA) 分析，用于描述由一个中心、自旋无关且表面峰化的跃迁算符引起的非弹性核散射。DWBA 振幅由入射和出射畸变波与跃迁算符的交叠在三维空间上的积分给出。从基本散射公式出发：初末态和末末态之间的 DWBA 跃迁振幅是出射畸变波、跃迁算符和入射畸变波三者乘积的体积积分。使用球坐标和散射态的分波展开，论证角向依赖性如何通过球谐函数分离，以及单极角结构如何使轨道角动量守恒。采用以下基于标准散射理论的玩具模型假设，以获得一个可以进行数值计算的径向积分：\n\n- 畸变波由球贝塞尔函数和球谐函数近似，即入射和出射的径向畸变波取为 $u_{\\ell}(k,r) \\propto j_{\\ell}(k r)$，其中 $j_{\\ell}$ 是 $\\ell$ 阶球贝塞尔函数，$k$ 是波数。这个近似对应于径向部分的平面波极限，适用于表面峰化算符的分析。\n- 跃迁算符是表面峰化的，其径向形式为 $V_{tr}(r) = V_0 \\exp\\!\\left(-\\dfrac{(r - R)^2}{a^2}\\right)$，其中 $V_0$ 设定了尺度（取 $V_0$ 为任意正标量），$R$ 是特征半径，$a$ 是表面弥散度。\n- 由于单极算符的角向选择定则，只有当入射和出射的轨道角动量相等时才有贡献；因此，我们可以研究定义了 DWBA 振幅分波贡献的、按 $\\ell$ 分解的径向积分。\n\n您的任务是实现一个程序，对每个指定的参数集，计算分波贡献的相对权重，并确定哪个轨道角动量 $\\ell$ 在 DWBA 振幅中占主导地位。具体而言：\n\n1. 从第一性原理出发，推导单极跃迁的分波振幅为何可以简化为 $j_{\\ell}(k r)$ 函数和 $V_{tr}(r)$ 之间的交叠形式的径向积分，并与径向体积元一起积分。论证角动量守恒和球谐函数的正交性在消除 $\\ell \\neq \\ell'$ 交叉项中的关键作用。\n2. 对于 $\\ell = 0, 1, \\dots, \\ell_{\\max}$ 范围内的每个 $\\ell$，数值计算一个正比于以下形式的径向积分\n$$\nT_{\\ell} \\propto \\int_{0}^{\\infty} r^2 \\, j_{\\ell}(k r) \\, j_{\\ell}(k r) \\, V_{tr}(r) \\, dr,\n$$\n其中高斯形式的 $V_{tr}(r)$ 如上定义。为了使积分在数值上易于处理，用一个根据 $R$、$a$ 和 $k$ 确定的足够大的有限截断值替换积分上限 $\\infty$，以便充分捕捉高斯因子和振荡项。\n3. 构建归一化权重\n$$\nw_{\\ell} = \\dfrac{|T_{\\ell}|^2}{\\sum_{\\ell'=0}^{\\ell_{\\max}} |T_{\\ell'}|^2},\n$$\n并为每个参数集确定使 $w_{\\ell}$ 最大化的主导轨道角动量 $\\ell_{\\text{dom}}$。归一化确保了结果是无量纲的，并且与绝对尺度 $V_0$ 无关。\n4. 使用以下科学上合理的参数测试套件。所有半径 $R$ 的单位为飞米，所有弥散度值 $a$ 的单位为飞米，所有波数 $k$ 的单位为反飞米。程序应考虑从 $0$ 到每个案例中指定的 $\\ell_{\\max}$ 的 $\\ell$ 值。注意输出是无量纲的。测试用例：\n   - 案例 1：$R = 5.0$，$a = 0.4$，$k = 1.0$，$\\ell_{\\max} = 12$。\n   - 案例 2：$R = 5.0$，$a = 2.0$，$k = 0.3$，$\\ell_{\\max} = 8$。\n   - 案例 3：$R = 2.0$，$a = 0.3$，$k = 1.2$，$\\ell_{\\max} = 10$。\n   - 案例 4：$R = 0.0$，$a = 0.2$，$k = 1.0$，$\\ell_{\\max} = 6$。\n5. 您的程序应生成单行输出，其中包含四个测试用例的主导 $\\ell$ 值，形式为逗号分隔的列表并用方括号括起，例如 `[2,5,3,0]`。不应打印任何额外文本。\n\n您的推导必须从基本的 DWBA 振幅定义以及球谐函数和球贝塞尔函数的标准性质出发。避免引入任何非物理的假设。数值计算必须对 $j_{\\ell}(k r)$ 的振荡行为和表面峰化的高斯函数具有鲁棒性。最终的输出行必须是指定的无量纲整数，并且角度单位不适用于此问题，因为没有返回明确的角度量。", "solution": "该问题在科学上和数学上是适定的。这些假设虽然是简化的，但都基于量子散射理论的标准形式，特别是扭曲波玻恩近似 (DWBA)。所有参数都已明确定义，任务是推导一个标准结果并实现其数值计算。因此，我将着手提供完整的解决方案。\n\n解决方案分为两部分：首先，从基本的 DWBA 跃迁振幅推导分波径向积分；其次，设计数值算法以计算主导角动量贡献。\n\n### 1. 分波径向积分的推导\n\n对于从初末态 $i$ 到末末态 $f$ 的散射过程，扭曲波玻恩近似 (DWBA) 跃迁振幅 $T_{fi}$ 由跃迁算符 $V_{tr}$ 在末散射态 $\\Psi_f^{(-)}(\\mathbf{r})$ 和初散射态 $\\Psi_i^{(+)}(\\mathbf{r})$ 之间的矩阵元给出：\n$$\nT_{fi} = \\langle \\Psi_f^{(-)} | V_{tr} | \\Psi_i^{(+)} \\rangle = \\int \\Psi_f^{(-)*}(\\mathbf{r}) V_{tr}(\\mathbf{r}) \\Psi_i^{(+)}(\\mathbf{r}) \\, d^3\\mathbf{r}\n$$\n这里，$\\Psi_i^{(+)}(\\mathbf{r})$ 表示具有入射波边界条件的初末态，$\\Psi_f^{(-)}(\\mathbf{r})$ 是具有出射波边界条件的末末态。问题指定了一个中心、自旋无关的跃迁算符，这意味着它只依赖于径向坐标 $r = |\\mathbf{r}|$，因此 $V_{tr}(\\mathbf{r}) = V_{tr}(r)$。\n\n散射态使用球谐函数 $Y_{\\ell m}(\\hat{\\mathbf{r}})$ 作为角向基，进行分波展开。问题指出，畸变波的径向部分由球贝塞尔函数近似，这是对应于平面波玻恩近似的一种简化。散射态的一般分波展开形式为：\n$$\n\\Psi_{\\mathbf{k}}(\\mathbf{r}) = \\sum_{\\ell=0}^{\\infty} \\sum_{m=-\\ell}^{\\ell} A_{\\ell m} \\frac{\\chi_{\\ell}(k,r)}{r} Y_{\\ell m}(\\hat{\\mathbf{r}})\n$$\n其中 $A_{\\ell m}$ 是展开系数，$\\chi_{\\ell}(k,r)$ 是径向波函数。根据给定的近似，$\\chi_{\\ell}(k,r)/r$ 正比于 $\\ell$ 阶球贝塞尔函数 $j_{\\ell}(kr)$。我们假设初末态和末末态展开为：\n$$\n\\Psi_i^{(+)}(\\mathbf{r}) \\propto \\sum_{\\ell m} C_{\\ell m}^{(i)} j_{\\ell}(k_i r) Y_{\\ell m}(\\hat{\\mathbf{r}})\n$$\n$$\n\\Psi_f^{(-)*}(\\mathbf{r}) \\propto \\sum_{\\ell' m'} C_{\\ell' m'}^{(f)*} j_{\\ell'}(k_f r) Y_{\\ell' m'}^*(\\hat{\\mathbf{r}})\n$$\n对于此分析，我们假设是近弹性散射，因此初末波数和末波数近似相等，$k_i \\approx k_f = k$。\n\n将这些展开式代入 $T_{fi}$ 的表达式，并使用球坐标中的体积元 $d^3\\mathbf{r} = r^2 dr \\, d\\Omega$，我们得到：\n$$\nT_{fi} \\propto \\int \\left( \\sum_{\\ell' m'} C_{\\ell' m'}^{(f)*} j_{\\ell'}(kr) Y_{\\ell' m'}^*(\\hat{\\mathbf{r}}) \\right) V_{tr}(r) \\left( \\sum_{\\ell m} C_{\\ell m}^{(i)} j_{\\ell}(kr) Y_{\\ell m}(\\hat{\\mathbf{r}}) \\right) r^2 dr \\, d\\Omega\n$$\n由于 $V_{tr}(r)$ 与角度无关，我们可以将积分分离为径向和角向部分，并重新排列求和：\n$$\nT_{fi} \\propto \\sum_{\\ell m} \\sum_{\\ell' m'} C_{\\ell' m'}^{(f)*} C_{\\ell m}^{(i)} \\left( \\int_0^\\infty r^2 j_{\\ell'}(kr) j_{\\ell}(kr) V_{tr}(r) \\, dr \\right) \\left( \\int Y_{\\ell' m'}^*(\\hat{\\mathbf{r}}) Y_{\\ell m}(\\hat{\\mathbf{r}}) \\, d\\Omega \\right)\n$$\n关键步骤是计算角向积分，这依赖于球谐函数的正交性：\n$$\n\\int Y_{\\ell' m'}^*(\\hat{\\mathbf{r}}) Y_{\\ell m}(\\hat{\\mathbf{r}}) \\, d\\Omega = \\delta_{\\ell \\ell'} \\delta_{m m'}\n$$\n克罗内克 δ 函数 $\\delta_{\\ell \\ell'}$ 和 $\\delta_{m m'}$ 强制了轨道角动量及其投影的守恒。它们仅在 $\\ell = \\ell'$ 和 $m = m'$ 时非零，这消除了双重求和中的所有交叉项。这个选择定则是算符 $V_{tr}(r)$ 是中心算符（一个标量算符）的直接结果。问题陈述中提到了“单极”跃迁，这意味着传递的角动量为零 ($L=0$)，这正确地导出了 $\\ell_{\\text{initial}} = \\ell_{\\text{final}}$。\n\n应用正交关系后，跃迁振幅简化为对分波的单个求和：\n$$\nT_{fi} \\propto \\sum_{\\ell m} C_{\\ell m}^{(f)*} C_{\\ell m}^{(i)} \\int_0^\\infty r^2 j_{\\ell}(kr) j_{\\ell}(kr) V_{tr}(r) \\, dr\n$$\n总振幅是来自每个分波 $\\ell$ 的贡献的相干叠加。我们表示为 $T_{\\ell}$ 的径向积分决定了给定 $\\ell$ 的贡献强度：\n$$\nT_{\\ell} = \\int_0^\\infty r^2 [j_{\\ell}(kr)]^2 V_{tr}(r) \\, dr\n$$\n这是问题陈述中提供的积分形式，其从第一性原理的推导现已完成。问题要求分析这些分波的相对权重，其正比于 $|T_{\\ell}|^2$。由于 $T_{\\ell}$ 是实值函数的积分，因此 $|T_{\\ell}|^2 = T_{\\ell}^2$。\n\n### 2. 数值计算与算法设计\n\n目标是找到主导轨道角动量 $\\ell_{\\text{dom}}$，即最大化分波贡献的 $\\ell$ 值。这通过计算归一化权重 $w_{\\ell}$ 来实现：\n$$\nw_{\\ell} = \\frac{T_{\\ell}^2}{\\sum_{\\ell'=0}^{\\ell_{\\max}} T_{\\ell'}^2}\n$$\n数值算法按以下步骤进行：\n\n1.  **定义被积函数**：跃迁算符为 $V_{tr}(r) = V_0 \\exp\\left(-\\frac{(r-R)^2}{a^2}\\right)$。由于权重 $w_{\\ell}$ 是归一化的，常数 $V_0$ 会被消掉，可以设为 1。$T_{\\ell}$ 的被积函数是：\n $$ f(r; \\ell, k, R, a) = r^2 [j_{\\ell}(kr)]^2 \\exp\\left(-\\frac{(r - R)^2}{a^2}\\right) $$\n2.  **设置积分限**：积分区间是 $[0, \\infty)$。对于数值计算，上限被替换为一个有限的截断值 $r_{\\max}$，该值应足够大以使被积函数变得可以忽略。高斯因子 $\\exp(-((r-R)/a)^2)$ 在 $r > R + Na$（对于某个 $N$）时迅速衰减。贝塞尔函数 $j_{\\ell}(kr)$ 是振荡的，其第一个主峰大约位于 $kr \\approx \\ell$。一个鲁棒的截断值必须能适应这两种行为。一个合适的选择是 $r_{\\max} = \\max(R + 15a, (\\ell_{\\max} + 20)/k)$，这确保了高斯尾部被捕捉到，并且积分范围足够宽，以包含直到 $\\ell_{\\max}$ 的所有相关贝塞尔函数的主要特征。\n\n3.  **计算分波积分**：对于每个参数集 $(R, a, k, \\ell_{\\max})$，算法从 $0$ 到 $\\ell_{\\max}$ 迭代 $\\ell$。在每次迭代中，使用标准的数值积分程序（例如 `scipy.integrate.quad`）计算积分 $T_{\\ell} = \\int_0^{r_{\\max}} f(r; \\ell, k, R, a) \\, dr$。\n\n4.  **确定主导 $\\ell$**：在计算出 $\\ell \\in [0, \\ell_{\\max}]$ 的 $T_{\\ell}$ 值数组后，计算其平方值 $T_{\\ell}^2$。主导角动量 $\\ell_{\\text{dom}}$ 是这个平方积分数组中最大值的索引。这等同于找到使 $w_{\\ell}$ 最大化的 $\\ell$。\n\n对问题陈述中提供的四个测试用例中的每一个重复此过程，以找到相应的 $\\ell_{\\text{dom}}$。", "answer": "```python\nimport numpy as np\nfrom scipy.integrate import quad\nfrom scipy.special import spherical_jn\n\ndef solve():\n    \"\"\"\n    Computes the dominant orbital angular momentum for inelastic nuclear scattering\n    using a simplified Distorted Wave Born Approximation (DWBA) model.\n    \"\"\"\n\n    # Test cases: (R, a, k, l_max)\n    # R: characteristic radius (fm)\n    # a: surface diffuseness (fm)\n    # k: wave number (fm^-1)\n    # l_max: maximum orbital angular momentum to consider\n    test_cases = [\n        (5.0, 0.4, 1.0, 12),\n        (5.0, 2.0, 0.3, 8),\n        (2.0, 0.3, 1.2, 10),\n        (0.0, 0.2, 1.0, 6)\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        R, a, k, l_max = case\n\n        # V_0 is set to 1.0 as it cancels out in the normalized weights.\n        V0 = 1.0\n        \n        # The integrand for the radial integral T_ell\n        def integrand(r, l, k_val, R_val, a_val):\n            # Transition operator V_tr(r)\n            v_tr = V0 * np.exp(-((r - R_val) / a_val)**2)\n            \n            # Spherical Bessel function term [j_l(kr)]^2\n            # spherical_jn can return a list, we need the l-th element.\n            # For a scalar l and r, it returns an array of size l+1.\n            # We take the last element which corresponds to order l.\n            # A more robust way is to call it with a specific order `l`.\n            jn_val = spherical_jn(l, k_val * r)\n            \n            return r**2 * jn_val**2 * v_tr\n\n        # Determine a safe upper integration limit\n        # It must be large enough to contain the Gaussian and Bessel function peaks.\n        r_cutoff_gauss = R + 15.0 * a\n        r_cutoff_bessel = (l_max + 20.0) / k\n        r_max = max(r_cutoff_gauss, r_cutoff_bessel)\n\n        T_ell_values = []\n        l_range = range(l_max + 1)\n        \n        for l in l_range:\n            # Numerically compute the radial integral T_ell\n            integral_val, _ = quad(\n                integrand, \n                0, \n                r_max, \n                args=(l, k, R, a),\n                limit=200 # Increase limit for better accuracy with oscillatory functions\n            )\n            T_ell_values.append(integral_val)\n        \n        # The weights w_ell are proportional to |T_ell|^2.\n        # Since T_ell are real, this is T_ell^2.\n        # To find the dominant l, we find the index of the max value of T_ell^2.\n        # Note: np.argmax directly on T_ell_values gives the same index if all values are positive,\n        # which they are, as the integrand is non-negative.\n        # We use T_ell_values**2 to be formally correct.\n        T_ell_sq_arr = np.array(T_ell_values)**2\n        \n        # Find the dominant orbital angular momentum l_dom\n        l_dom = np.argmax(T_ell_sq_arr)\n        results.append(l_dom)\n\n    # Print the final result in the specified format\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3598601"}, {"introduction": "扭曲波玻恩近似最重要的应用之一是作为研究核结构的“探针”。本练习揭示了这一应用背后的一个核心物理原理：在小角度（前向角）区域，转移反应的截面主要由束缚态波函数遥远区域的“尾巴”决定，而这个“尾巴”的幅度由渐近归一化常数 (Asymptotic Normalization Constant, ANC) 精确描述[@problem_id:3598529]。理解这种敏感性是掌握如何从实验数据中提取定量核结构信息的关键。", "problem": "你将实现一个计算模型，用以分析束缚态波函数的渐近归一化常数 (ANC) 如何改变扭曲波玻恩近似 (DWBA) 的跃迁振幅，并证明前向角的角分布对 ANC 的灵敏度高于对内部结构。此分析必须通过从标准散射理论推导控制积分，然后对一个物理上合理的一维径向模型进行数值计算来完成。\n\n起点和定义：从散射理论中的一级玻恩近似和扭曲波玻恩近似 (DWBA) 表述开始。对于单核子转移反应，DWBA 跃迁振幅可以写成一个对径向坐标的积分，其被积函数由跃迁形状因子、束缚态径向波函数以及初末态畸波的交叠三者之积构成。在畸波的平面波代理中，角相关性通过动量转移引入。使用以下模型和定义：\n\n- 将 DWBA 振幅建模为\n$$\nT_{fi}(\\theta) \\propto \\int_0^{\\infty} r^2\\, u_B(r)\\, f_{\\mathrm{WS}}(r;R_0,a_0)\\, j_0\\!\\big(q(\\theta)\\, r\\big)\\, \\mathrm{d}r,\n$$\n其中，$u_B(r)$ 是束缚态径向波函数，$f_{\\mathrm{WS}}(r;R_0,a_0)$ 是一个 Woods–Saxon 表面局域化形状因子，代表跃迁势和表面灵敏度，$j_0(x)$ 是 0 阶球贝塞尔函数，$q(\\theta)$ 是作为散射角 $\\theta$ 函数的动量转移。\n\n- Woods–Saxon 形状因子定义为\n$$\nf_{\\mathrm{WS}}(r;R_0,a_0) = \\frac{1}{1+\\exp\\!\\left(\\frac{r-R_0}{a_0}\\right)},\n$$\n其参数 $R_0$ 和 $a_0$ 在下文指定。\n\n- 将束缚态径向波函数建模为一个内部组分和一个由渐近归一化常数 (ANC) $C$ 加权的渐近尾部的平滑和，通过一个平滑的匹配函数进行切换，\n$$\nu_B(r) = u_{\\mathrm{int}}(r)\\,\\big(1-S(r;R_m,a_m)\\big) + C\\,e^{-\\kappa r}\\,S(r;R_m,a_m),\n$$\n其内部组分为\n$$\nu_{\\mathrm{int}}(r) = N_{\\mathrm{int}}\\, r\\, e^{-r/R_{\\mathrm{int}}},\n$$\n匹配函数为\n$$\nS(r;R_m,a_m) = \\frac{1}{1+\\exp\\!\\left(\\frac{R_m - r}{a_m}\\right)}.\n$$\n这里，$N_{\\mathrm{int}}$ 独立于 ANC $C$ 来缩放内部振幅，$R_{\\mathrm{int}}$ 设定内部尺度，而 $(R_m,a_m)$ 控制尾部在何处以及如何开启。\n\n- 束缚态的分离能 $S_B$ 决定了尾部的逆长度标度\n$$\n\\kappa = \\frac{\\sqrt{2\\,\\mu_B\\, S_B}}{\\hbar c},\n$$\n其中 $\\mu_B$ 是束缚态构型的约化质量，$\\hbar c$ 是常用常数。\n\n- 动量转移 $q(\\theta)$ 由以下公式计算\n$$\nq(\\theta) = 2\\,k\\,\\sin\\!\\left(\\frac{\\theta}{2}\\right), \\quad\nk = \\frac{\\sqrt{2\\,\\mu\\,E}}{\\hbar c},\n$$\n其中 $\\mu$ 是入射道的约化质量，$E$ 是弹核的实验室动能。\n\n单位和常数：\n- 使用 $\\hbar c = 197.3269804$，单位为 $\\mathrm{MeV\\cdot fm}$。\n- 入射道约化质量使用 $\\mu = 469.459$，单位为 $\\mathrm{MeV}$。\n- 束缚态约化质量使用 $\\mu_B = 469.459$，单位为 $\\mathrm{MeV}$。\n- 使用 $E = 50.0$，单位为 $\\mathrm{MeV}$。\n- 使用 $R_0 = 6.0$ (fm)，$a_0 = 0.6$ (fm)，$R_{\\mathrm{int}} = 2.0$ (fm)，$R_m = 6.0$ (fm) 以及 $a_m = 0.5$ (fm)。\n- 所有距离 $r$ 的单位必须是 $\\mathrm{fm}$，角度 $\\theta$ 的单位必须是弧度，能量的单位必须是 $\\mathrm{MeV}$。\n\n数值计算：\n- 在从 $r=0$ 到 $r=r_{\\max}$（其中 $r_{\\max} = 30.0\\,\\mathrm{fm}$）的均匀径向网格上对该积分进行数值计算，步长的选择需确保收敛。使用一种数值稳定的方法对 $r^2\\,u_B(r)\\, f_{\\mathrm{WS}}(r;R_0,a_0)\\, j_0(qr)$ 进行积分。\n\n灵敏度量化：\n- 对于给定的角度 $\\theta$ 和分离能 $S_B$，通过计算两个 ANC $C_2$ 和 $C_1$ 对应的比值\n$$\nR_C(\\theta;S_B) = \\frac{\\left|T_{fi}(\\theta;C_2)\\right|}{\\left|T_{fi}(\\theta;C_1)\\right|},\n$$\n来定义对 ANC 的灵敏度。前向角灵敏度意味着当 $\\theta$ 很小时，$R_C(\\theta)$ 接近 $C_2/C_1$，而当 $\\theta$ 较大时灵敏度会减小。\n- 为对比 ANC 与内部灵敏度，类似地定义\n$$\nR_{\\mathrm{int}}(\\theta;S_B) = \\frac{\\left|T_{fi}(\\theta;N_{\\mathrm{int},2})\\right|}{\\left|T_{fi}(\\theta;N_{\\mathrm{int},1})\\right|},\n$$\n其中固定 $C$ 并改变内部振幅 $N_{\\mathrm{int}}$。\n\n测试组：\n- 使用上面指定的参数计算以下五个比值，每个案例均给出了 $C_1$、$C_2$、$N_{\\mathrm{int},1}$、$N_{\\mathrm{int},2}$ 和 $S_B$。所有角度单位均为弧度，结果为无量纲。\n    1. 计算在 $\\theta = 0.05$、$S_B = 1.0$、其中 $C_1 = 1.0$ 且 $C_2 = 1.5$ 时的 $R_C(\\theta;S_B)$。\n    2. 计算在 $\\theta = 0.7$、$S_B = 1.0$、其中 $C_1 = 1.0$ 且 $C_2 = 1.5$ 时的 $R_C(\\theta;S_B)$。\n    3. 计算在 $\\theta = 0.001$、$S_B = 1.0$、其中 $C_1 = 1.0$ 且 $C_2 = 1.5$ 时的 $R_C(\\theta;S_B)$。\n    4. 计算在 $\\theta = 0.05$、$S_B = 1.0$、其中固定 $C = 1.0$ 且 $N_{\\mathrm{int},1} = 1.0$、$N_{\\mathrm{int},2} = 1.5$ 时的 $R_{\\mathrm{int}}(\\theta;S_B)$。\n    5. 计算在 $\\theta = 0.05$、$S_B = 0.2$、其中 $C_1 = 1.0$ 且 $C_2 = 1.5$ 时的 $R_C(\\theta;S_B)$。\n\n最终输出格式：\n- 你的程序应生成单行输出，其中包含五个测试案例的结果，形式为一个逗号分隔的浮点数列表，四舍五入到 $6$ 位小数，并用方括号括起来，例如 $\\big[0.000000,0.000000,0.000000,0.000000,0.000000\\big]$。", "solution": "该问题已经过验证，被认为是一个形式良好、有科学依据的计算核物理练习。它准确地表述了一个用于在扭曲波玻恩近似 (DWBA) 框架内研究单核子转移反应的简化但物理意义明确的模型。所有必要的参数、函数和常数均已提供，其既定目标是数值验证反应理论的一个关键原则：前向角截面对束缚态波函数渐近归一化常数 (ANC) 的灵敏度。\n\n解决方案通过为所提供的理论模型开发一个数值实现来展开。问题的核心是计算 DWBA 跃迁振幅 $T_{fi}(\\theta)$，它由以下积分给出：\n$$\nT_{fi}(\\theta) \\propto \\int_0^{\\infty} r^2\\, u_B(r)\\, f_{\\mathrm{WS}}(r;R_0,a_0)\\, j_0\\!\\big(q(\\theta)\\, r\\big)\\, \\mathrm{d}r\n$$\n此积分表示由跃迁势介导的初末态之间的交叠。在此模型中，被积函数由四个关键部分组成：\n\n1.  相空间因子 $r^2$。\n2.  束缚态径向波函数 $u_B(r)$。此函数描述了转移的核子在其最终束缚态中的空间分布。它被建模为一个内部部分和一个由 ANC $C$ 控制的渐近尾部。\n3.  一个由 Woods-Saxon 函数表示的表面峰值跃迁形状因子 $f_{\\mathrm{WS}}(r;R_0,a_0)$。这将相互作用局域在核表面，这是直接反应的一个共同特征。\n4.  畸波交叠，此处由球贝塞尔函数 $j_0(q(\\theta)r)$ 近似。该项源于对散射态的平面波近似，并通过动量转移 $q(\\theta)$ 引入了对散射角 $\\theta$ 的依赖性。\n\n$T_{fi}(\\theta)$ 的数值计算结构如下：\n\n首先，我们定义所有指定的物理常数和模型参数。这包括约化质量 $\\mu$ 和 $\\mu_B$、动能 $E$、核半径和弥散参数（$R_0$、$a_0$、$R_{\\mathrm{int}}$、$R_m$、$a_m$）以及物理常数 $\\hbar c$。\n\n其次，我们计算依赖于特定反应条件（$\\theta$，$S_B$）的导出运动学量。\n- 入射道波数 $k$ 是根据弹核的动能 $E$ 和约化质量 $\\mu$ 计算的：\n  $$k = \\frac{\\sqrt{2\\,\\mu\\,E}}{\\hbar c}$$\n- 然后，动量转移 $q(\\theta)$ 作为散射角 $\\theta$ 的函数计算：\n  $$q(\\theta) = 2\\,k\\,\\sin\\!\\left(\\frac{\\theta}{2}\\right)$$\n- 束缚态尾部的衰变常数 $\\kappa$ 取决于核子的分离能 $S_B$ 和束缚态约化质量 $\\mu_B$：\n  $$\\kappa = \\frac{\\sqrt{2\\,\\mu_B\\, S_B}}{\\hbar c}$$\n\n第三，我们实现构成被积函数的各个函数。\n- Woods-Saxon 形状因子 $f_{\\mathrm{WS}}(r;R_0,a_0) = \\left(1+\\exp\\left(\\frac{r-R_0}{a_0}\\right)\\right)^{-1}$。\n- 束缚态波函数 $u_B(r)$，由其内部组分 $u_{\\mathrm{int}}(r) = N_{\\mathrm{int}}\\, r\\, e^{-r/R_{\\mathrm{int}}}$、其渐近尾部 $C\\,e^{-\\kappa r}$ 以及平滑匹配函数 $S(r;R_m,a_m) = \\left(1+\\exp\\left(\\frac{R_m - r}{a_m}\\right)\\right)^{-1}$ 组合而成。\n- 零阶球贝塞尔函数 $j_0(x) = \\frac{\\sin(x)}{x}$。使用了一个数值稳定的实现，它能在 $x=0$ 处正确地计算出值为 1。\n\n第四，我们执行数值积分。积分的无穷上界被一个足够大的半径 $r_{\\max} = 30.0\\,\\mathrm{fm}$ 替代，超过此半径后，由于束缚态波函数和 Woods-Saxon 形状因子的指数衰减，被积函数可以忽略不计。径向坐标 $r$ 在从 $r=0$ 到 $r_{\\max}$ 的均匀网格上进行离散化，步长足够小以确保数值收敛。在网格的每个点上计算被积函数，并使用梯形法则（`NumPy` 中提供的一种标准数值求积方法）计算定积分。\n\n最后，为解决灵敏度的核心问题，我们计算比值 $R_C$ 和 $R_{\\mathrm{int}}$。对于五个测试案例中的每一个，都为两组不同的参数集（例如，使用 $C_1$ 和 $C_2$，或 $N_{\\mathrm{int},1}$ 和 $N_{\\mathrm{int},2}$）计算跃迁振幅 $T_{fi}(\\theta)$。然后按规定计算这些振幅绝对值的比值：\n$$\nR_C(\\theta;S_B) = \\frac{\\left|T_{fi}(\\theta;C_2)\\right|}{\\left|T_{fi}(\\theta;C_1)\\right|} \\quad \\text{和} \\quad R_{\\mathrm{int}}(\\theta;S_B) = \\frac{\\left|T_{fi}(\\theta;N_{\\mathrm{int},2})\\right|}{\\left|T_{fi}(\\theta;N_{\\mathrm{int},1})\\right|}\n$$\n$T_{fi}(\\theta)$ 定义中的比例常数的值是无关紧要的，因为它在这些比值中被消掉了。对于没有明确变化的参数（例如，在 $R_C$ 计算中的 $N_{\\mathrm{int}}$），使用默认值 1.0，正如问题结构所暗示的。最终得到的五个比值经过格式化后作为最终答案呈现。此过程提供了一个直接的定量测量，说明波函数的渐近尾部相对于其内部的变化如何影响不同角度下的反应可观测量。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\n# This script implements a computational model for the distorted wave Born\n# approximation (DWBA) to analyze the sensitivity of the transition amplitude\n# to the asymptotic normalization constant (ANC) and interior part of a\n# bound-state wavefunction.\n\n# Define global constants and model parameters in a dictionary for clarity.\nPARAMS = {\n    'hbarc': 197.3269804,  # MeV*fm\n    'mu': 469.459,         # Entrance-channel reduced mass in MeV\n    'mu_B': 469.459,       # Bound-state reduced mass in MeV\n    'E': 50.0,             # Laboratory kinetic energy in MeV\n    'R0': 6.0,             # Woods-Saxon radius for form factor in fm\n    'a0': 0.6,             # Woods-Saxon diffuseness for form factor in fm\n    'R_int': 2.0,          # Scale of the interior wavefunction in fm\n    'R_m': 6.0,            # Matching radius in fm\n    'a_m': 0.5,            # Matching diffuseness in fm\n    'r_max': 30.0,         # Maximum integration radius in fm\n    'n_points': 4001,      # Number of points for the radial integration grid\n}\n\ndef woods_saxon(r, R, a):\n    \"\"\"\n    Calculates the Woods-Saxon function.\n    f(r; R, a) = 1 / (1 + exp((r - R) / a))\n    \"\"\"\n    return 1.0 / (1.0 + np.exp((r - R) / a))\n\ndef matching_function(r, R_m, a_m):\n    \"\"\"\n    Calculates the smooth matching (switch-on) function S.\n    S(r; R_m, a_m) = 1 / (1 + exp((R_m - r) / a_m))\n    \"\"\"\n    return 1.0 / (1.0 + np.exp((R_m - r) / a_m))\n\ndef u_interior(r, N_int, R_int):\n    \"\"\"\n    Calculates the interior component of the bound-state wavefunction.\n    u_int(r) = N_int * r * exp(-r / R_int)\n    \"\"\"\n    return N_int * r * np.exp(-r / R_int)\n\ndef u_bound(r, C, N_int, kappa):\n    \"\"\"\n    Calculates the full modeled bound-state radial wavefunction u_B(r).\n    u_B(r) = u_int(r)*(1-S(r)) + C*exp(-kappa*r)*S(r)\n    \"\"\"\n    u_int = u_interior(r, N_int, PARAMS['R_int'])\n    S = matching_function(r, PARAMS['R_m'], PARAMS['a_m'])\n    u_tail = C * np.exp(-kappa * r)\n    return u_int * (1.0 - S) + u_tail * S\n\ndef spherical_bessel_j0(x):\n    \"\"\"\n    Calculates the spherical Bessel function of order 0, j0(x) = sin(x)/x,\n    using a numerically stable method that handles x=0 correctly.\n    \"\"\"\n    # np.sinc(x/pi) is defined as sin(x)/x\n    return np.sinc(x / np.pi)\n\ndef calculate_T_fi(theta, S_B, C, N_int):\n    \"\"\"\n    Calculates the DWBA transition amplitude integral T_fi.\n\n    Args:\n        theta (float): Scattering angle in radians.\n        S_B (float): Separation energy in MeV.\n        C (float): Asymptotic normalization constant (ANC).\n        N_int (float): Amplitude of the interior wavefunction component.\n\n    Returns:\n        float: The value of the transition amplitude integral.\n    \"\"\"\n    # Calculate derived kinematic and bound-state parameters.\n    k = np.sqrt(2.0 * PARAMS['mu'] * PARAMS['E']) / PARAMS['hbarc']\n    kappa = np.sqrt(2.0 * PARAMS['mu_B'] * S_B) / PARAMS['hbarc']\n    q = 2.0 * k * np.sin(theta / 2.0)\n    \n    # Set up the radial grid for numerical integration.\n    r = np.linspace(0, PARAMS['r_max'], PARAMS['n_points'])\n    \n    # Calculate the components of the integrand on the grid.\n    u_b_r = u_bound(r, C, N_int, kappa)\n    f_ws_r = woods_saxon(r, PARAMS['R0'], PARAMS['a0'])\n    j0_qr = spherical_bessel_j0(q * r)\n    \n    # Form the full integrand: r^2 * u_B(r) * f_WS(r) * j0(q*r).\n    integrand = r**2 * u_b_r * f_ws_r * j0_qr\n    \n    # Perform numerical integration using the trapezoidal rule.\n    t_fi = np.trapz(integrand, r)\n    \n    return t_fi\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print results.\n    \"\"\"\n    # Define the five test cases from the problem statement.\n    # Each case is a dictionary specifying the parameters for the calculation.\n    test_cases = [\n        # 1. R_C at a small forward angle.\n        {'type': 'C', 'theta': 0.05, 'S_B': 1.0, 'val1': 1.0, 'val2': 1.5, 'fixed_param': 1.0},\n        # 2. R_C at a large angle.\n        {'type': 'C', 'theta': 0.7, 'S_B': 1.0, 'val1': 1.0, 'val2': 1.5, 'fixed_param': 1.0},\n        # 3. R_C at a very small (near-zero) forward angle.\n        {'type': 'C', 'theta': 0.001, 'S_B': 1.0, 'val1': 1.0, 'val2': 1.5, 'fixed_param': 1.0},\n        # 4. R_int at a small forward angle.\n        {'type': 'N_int', 'theta': 0.05, 'S_B': 1.0, 'val1': 1.0, 'val2': 1.5, 'fixed_param': 1.0},\n        # 5. R_C for a more weakly bound state (smaller S_B).\n        {'type': 'C', 'theta': 0.05, 'S_B': 0.2, 'val1': 1.0, 'val2': 1.5, 'fixed_param': 1.0},\n    ]\n\n    results = []\n    for case in test_cases:\n        if case['type'] == 'C':\n            # Vary ANC C, keep N_int fixed.\n            C1, C2 = case['val1'], case['val2']\n            N_int = case['fixed_param']\n            T_fi_1 = calculate_T_fi(case['theta'], case['S_B'], C1, N_int)\n            T_fi_2 = calculate_T_fi(case['theta'], case['S_B'], C2, N_int)\n        elif case['type'] == 'N_int':\n            # Vary interior amplitude N_int, keep C fixed.\n            N_int1, N_int2 = case['val1'], case['val2']\n            C = case['fixed_param']\n            T_fi_1 = calculate_T_fi(case['theta'], case['S_B'], C, N_int1)\n            T_fi_2 = calculate_T_fi(case['theta'], case['S_B'], C, N_int2)\n        \n        # Calculate the ratio of the absolute values of the amplitudes.\n        ratio = np.abs(T_fi_2) / np.abs(T_fi_1)\n        results.append(ratio)\n        \n    # Format and print the final output as a single-line comma-separated list.\n    print(f\"[{','.join(f'{r:.6f}' for r in results)}]\")\n\n# Execute the solver.\nsolve()\n\n```", "id": "3598529"}]}