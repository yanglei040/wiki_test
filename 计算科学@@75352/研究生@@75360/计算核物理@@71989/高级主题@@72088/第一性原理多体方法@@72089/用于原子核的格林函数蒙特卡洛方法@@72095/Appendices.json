{"hands_on_practices": [{"introduction": "在格林函数蒙特卡洛（GFMC）方法中，虚时传播子（即格林函数）是演化波函数至基态的基本构件。虽然对于平滑势，其形式相对简单，但核物理中常见的奇异相互作用（如接触势）会使其结构变得复杂，这个练习将通过一个精确可解的一维模型，揭示奇异势对短时传播子行为的深刻影响，这种影响直接关系到 GFMC 算法的收敛性和准确性。通过解决这个问题，你将理解为何对奇异势需要采用比简单 Trotter 分解更复杂的传播子近似。", "problem": "考虑一维单粒子在哈密顿量 $H = -D \\,\\frac{d^{2}}{dx^{2}} + \\alpha \\,\\delta(x)$（其中 $D \\equiv \\hbar^{2}/(2m)$，$\\alpha$ 为实耦合常数）中的格林函数蒙特卡洛（GFMC, Green's Function Monte Carlo）虚时传播。虚时格林函数（热核）是短时传播子 $K(x,x';\\Delta\\tau) = \\langle x | \\exp(-\\Delta\\tau\\, H) | x' \\rangle$。自由粒子核为 $K_{0}(x-x';\\Delta\\tau) = (4\\pi D \\Delta\\tau)^{-1/2} \\exp\\!\\big(- (x-x')^{2}/(4 D \\Delta\\tau)\\big)$。\n\n仅使用基本算符恒等式和经过充分检验的公式，按以下步骤进行：\n\n1) 从核的拉普拉斯变换的豫解算符定义 $\\tilde{K}(x,x';s) \\equiv \\int_{0}^{\\infty} d\\tau \\,\\exp(-s \\tau)\\, K(x,x';\\tau) = \\langle x | (H + s)^{-1} | x' \\rangle$ 以及自由哈密顿量的豫解算符出发，通过拉普拉斯逆变换，推导 $K(0,0;\\Delta\\tau)$ 的精确闭式表达式。你可以使用一维自由豫解算符为 $\\tilde{K}_{0}(x-x';s) = \\int_{0}^{\\infty} d\\tau \\,\\exp(-s \\tau)\\, K_{0}(x-x';\\tau) = \\frac{1}{2\\sqrt{D s}} \\exp\\!\\big(-|x-x'| \\sqrt{s/D}\\big)$ 以及接触势的秩一微扰恒等式。\n\n2) 对你在原点处的精确结果进行短时展开，将其整理为如下形式：\n$$\nK(0,0;\\Delta\\tau) \\;=\\; K_{0}(0;\\Delta\\tau) \\;-\\; \\frac{\\alpha}{4 D} \\;+\\; C \\,\\sqrt{\\Delta\\tau} \\;+\\; \\mathcal{O}(\\Delta\\tau),\n$$\n并确定系数 $C$（用 $\\alpha$ 和 $D$ 表示）。\n\n3) 基于此展开式，陈述在光滑势的对称Trotter积公式下，主导与预期解析性产生偏差的 $\\Delta\\tau$ 的主导幂次，并定性解释这与良态相互作用下通常的 $\\mathcal{O}(\\Delta\\tau^{3})$ 误差相比有何不同。你的解释应仅依赖于你推导出的短时展开的结构，而不援引任何本问题中未推导的专门公式。\n\n请以系数 $C$ 的闭式解析表达式作为你的最终答案。不需要进行数值计算，最终方框内的表达式中不应包含任何单位。如果引入任何角度，它们必须以弧度为单位。如果进行任何舍入（此处不需要），你必须指明有效数字，但除非必要，请勿这样做。", "solution": "该问题陈述已经过验证，被认为是科学上可靠、适定且客观的。它提供了一个量子力学和计算物理学中的标准可解问题，并提供了所有必要的定义和公式。其前提事实可靠，问题清晰明确。我们可以着手求解。\n\n该问题分为三个部分。我们将依次进行解答。\n\n**第一部分：精确传播子 $K(0,0;\\Delta\\tau)$ 的推导**\n\n哈密顿量由 $H = H_0 + V$ 给出，其中自由哈密顿量为 $H_0 = -D \\frac{d^2}{dx^2}$，势为 $V = \\alpha \\delta(x)$。我们寻求的量是虚时传播子，或称核，$K(x,x';\\tau) = \\langle x | \\exp(-\\tau H) | x' \\rangle$。问题指导我们从豫解算符开始，它是核的拉普拉斯变换：\n$$\n\\tilde{K}(x,x';s) = \\langle x | (H+s)^{-1} | x' \\rangle\n$$\n算符 $(H+s)^{-1}$ 可以通过 Lippmann-Schwinger 方程（或更一般地，第二豫解算符恒等式）与自由豫解算符 $(H_0+s)^{-1}$ 相关联：\n$$\n(H+s)^{-1} = (H_0+s)^{-1} - (H_0+s)^{-1} V (H+s)^{-1}\n$$\n在位置基中，此算符恒等式变为豫解核 $\\tilde{K}(x,x';s)$ 的一个积分方程：\n$$\n\\tilde{K}(x,x';s) = \\tilde{K}_0(x-x';s) - \\int_{-\\infty}^{\\infty} dz \\, \\tilde{K}_0(x-z;s) \\langle z| V (H+s)^{-1} |x' \\rangle\n$$\n其中 $\\tilde{K}_0(x-x';s) = \\langle x | (H_0+s)^{-1} | x' \\rangle$ 是自由粒子豫解核。势能项为 $\\langle z| V (H+s)^{-1} |x' \\rangle = \\langle z| \\alpha \\delta(\\hat{x}) (H+s)^{-1} |x' \\rangle$。位置算符 $\\hat{x}$ 作用于其本征态 $|z\\rangle$ 上得到本征值 $z$，因此 $\\delta(\\hat{x})|z\\rangle = \\delta(z)|z\\rangle$。这简化了积分：\n$$\n\\langle z| V (H+s)^{-1} |x' \\rangle = \\alpha \\delta(z) \\langle z| (H+s)^{-1} |x' \\rangle = \\alpha \\delta(z) \\tilde{K}(z,x';s)\n$$\n将此代入积分方程：\n$$\n\\tilde{K}(x,x';s) = \\tilde{K}_0(x-x';s) - \\int_{-\\infty}^{\\infty} dz \\, \\tilde{K}_0(x-z;s) \\alpha \\delta(z) \\tilde{K}(z,x';s)\n$$\n$$\n\\tilde{K}(x,x';s) = \\tilde{K}_0(x-x';s) - \\alpha \\tilde{K}_0(x-0;s) \\tilde{K}(0,x';s)\n$$\n这个方程将完整豫解算符与自由豫解算符以及完整豫解算符在原点的值联系起来。为了求出 $\\tilde{K}(0,x';s)$，我们可以在上式中令 $x=0$：\n$$\n\\tilde{K}(0,x';s) = \\tilde{K}_0(0-x';s) - \\alpha \\tilde{K}_0(0;s) \\tilde{K}(0,x';s)\n$$\n由于 $\\tilde{K}_0$ 依赖于 $|x-x'|$，我们有 $\\tilde{K}_0(-x';s) = \\tilde{K}_0(x';s)$。整理以求解 $\\tilde{K}(0,x';s)$：\n$$\n\\tilde{K}(0,x';s) (1 + \\alpha \\tilde{K}_0(0;s)) = \\tilde{K}_0(x';s)\n$$\n$$\n\\tilde{K}(0,x';s) = \\frac{\\tilde{K}_0(x';s)}{1 + \\alpha \\tilde{K}_0(0;s)}\n$$\n我们感兴趣的是从原点到原点的传播子 $K(0,0;\\Delta\\tau)$。其拉普拉斯变换是 $\\tilde{K}(0,0;s)$，通过令 $x'=0$ 得到：\n$$\n\\tilde{K}(0,0;s) = \\frac{\\tilde{K}_0(0;s)}{1 + \\alpha \\tilde{K}_0(0;s)}\n$$\n问题给出了自由豫解算符的表达式：$\\tilde{K}_{0}(x-x';s) = \\frac{1}{2\\sqrt{D s}} \\exp\\big(-|x-x'| \\sqrt{s/D}\\big)$。当 $x=x'=0$ 时，它变为：\n$$\n\\tilde{K}_0(0;s) = \\frac{1}{2\\sqrt{Ds}}\n$$\n将此代入我们关于 $\\tilde{K}(0,0;s)$ 的表达式中：\n$$\n\\tilde{K}(0,0;s) = \\frac{\\frac{1}{2\\sqrt{Ds}}}{1 + \\frac{\\alpha}{2\\sqrt{Ds}}} = \\frac{1}{2\\sqrt{Ds} + \\alpha}\n$$\n为了求得 $K(0,0;\\tau)$，我们必须计算此表达式的拉普拉斯逆变换。设 $\\tau$ 代表时间变量。\n$$\nK(0,0;\\tau) = \\mathcal{L}^{-1}\\left\\{ \\frac{1}{2\\sqrt{D}\\sqrt{s} + \\alpha} \\right\\}(\\tau) = \\frac{1}{2\\sqrt{D}} \\mathcal{L}^{-1}\\left\\{ \\frac{1}{\\sqrt{s} + \\frac{\\alpha}{2\\sqrt{D}}} \\right\\}(\\tau)\n$$\n使用标准拉普拉斯变换对 $\\mathcal{L}^{-1}\\left\\{ (\\sqrt{s}+c)^{-1} \\right\\}(t) = \\frac{1}{\\sqrt{\\pi t}} - c \\exp(c^2 t) \\text{erfc}(c\\sqrt{t})$，其中 $c = \\frac{\\alpha}{2\\sqrt{D}}$ 且 $t=\\tau$：\n$$\nK(0,0;\\tau) = \\frac{1}{2\\sqrt{D}} \\left[ \\frac{1}{\\sqrt{\\pi \\tau}} - \\frac{\\alpha}{2\\sqrt{D}} \\exp\\left(\\left(\\frac{\\alpha}{2\\sqrt{D}}\\right)^2 \\tau\\right) \\text{erfc}\\left(\\frac{\\alpha}{2\\sqrt{D}}\\sqrt{\\tau}\\right) \\right]\n$$\n分配前置因子并简化：\n$$\nK(0,0;\\tau) = \\frac{1}{2\\sqrt{\\pi D \\tau}} - \\frac{\\alpha}{4D} \\exp\\left(\\frac{\\alpha^2 \\tau}{4D}\\right) \\text{erfc}\\left(\\frac{\\alpha\\sqrt{\\tau}}{2\\sqrt{D}}\\right)\n$$\n第一项是原点处的自由传播子，$K_0(0;\\tau) = (4\\pi D \\tau)^{-1/2}$。使用问题中的符号 $\\Delta\\tau$ 表示时间步长，我们得到精确的闭式表达式：\n$$\nK(0,0;\\Delta\\tau) = K_{0}(0;\\Delta\\tau) - \\frac{\\alpha}{4D} \\exp\\left(\\frac{\\alpha^2 \\Delta\\tau}{4D}\\right) \\text{erfc}\\left(\\frac{\\alpha\\sqrt{\\Delta\\tau}}{2\\sqrt{D}}\\right)\n$$\n\n**第二部分：短时展开与 $C$ 的确定**\n\n我们需要将第一部分的结果对小的 $\\Delta\\tau$ 进行展开，以匹配以下形式：\n$$\nK(0,0;\\Delta\\tau) = K_{0}(0;\\Delta\\tau) - \\frac{\\alpha}{4 D} + C \\,\\sqrt{\\Delta\\tau} + \\mathcal{O}(\\Delta\\tau)\n$$\n这需要对项 $f(z) = \\exp(z^2)\\text{erfc}(z)$ 进行小自变量展开，其中 $z = \\frac{\\alpha\\sqrt{\\Delta\\tau}}{2\\sqrt{D}}$。对于小的 $z$，指数函数和互补误差函数的展开式为：\n$$\n\\exp(z^2) = 1 + z^2 + \\mathcal{O}(z^4)\n$$\n$$\n\\text{erfc}(z) = 1 - \\text{erf}(z) = 1 - \\frac{2}{\\sqrt{\\pi}} \\int_0^z e^{-t^2} dt = 1 - \\frac{2}{\\sqrt{\\pi}}\\left(z - \\frac{z^3}{3} + \\dots\\right)\n$$\n将这些级数相乘：\n$$\n\\exp(z^2)\\text{erfc}(z) = \\left(1 + z^2 + \\dots\\right) \\left(1 - \\frac{2}{\\sqrt{\\pi}}z + \\dots\\right) = 1 - \\frac{2}{\\sqrt{\\pi}}z + z^2 + \\mathcal{O}(z^3)\n$$\n现在，我们将 $z = \\frac{\\alpha\\sqrt{\\Delta\\tau}}{2\\sqrt{D}}$ 代回此展开式：\n$$\n\\exp(z^2)\\text{erfc}(z) = 1 - \\frac{2}{\\sqrt{\\pi}} \\left(\\frac{\\alpha\\sqrt{\\Delta\\tau}}{2\\sqrt{D}}\\right) + \\left(\\frac{\\alpha\\sqrt{\\Delta\\tau}}{2\\sqrt{D}}\\right)^2 + \\mathcal{O}((\\Delta\\tau)^{3/2})\n$$\n$$\n= 1 - \\frac{\\alpha}{\\sqrt{\\pi D}} \\sqrt{\\Delta\\tau} + \\frac{\\alpha^2}{4D} \\Delta\\tau + \\mathcal{O}((\\Delta\\tau)^{3/2})\n$$\n我们把这个结果代入 $K(0,0;\\Delta\\tau)$ 的表达式中：\n$$\nK(0,0;\\Delta\\tau) = K_0(0;\\Delta\\tau) - \\frac{\\alpha}{4D} \\left[ 1 - \\frac{\\alpha}{\\sqrt{\\pi D}} \\sqrt{\\Delta\\tau} + \\frac{\\alpha^2}{4D} \\Delta\\tau + \\mathcal{O}((\\Delta\\tau)^{3/2}) \\right]\n$$\n分配因子 $-\\frac{\\alpha}{4D}$：\n$$\nK(0,0;\\Delta\\tau) = K_0(0;\\Delta\\tau) - \\frac{\\alpha}{4D} + \\left(\\frac{\\alpha}{4D}\\right)\\left(\\frac{\\alpha}{\\sqrt{\\pi D}}\\right)\\sqrt{\\Delta\\tau} - \\left(\\frac{\\alpha}{4D}\\right)\\left(\\frac{\\alpha^2}{4D}\\right)\\Delta\\tau + \\mathcal{O}((\\Delta\\tau)^{3/2})\n$$\n$$\nK(0,0;\\Delta\\tau) = K_0(0;\\Delta\\tau) - \\frac{\\alpha}{4D} + \\frac{\\alpha^2}{4D\\sqrt{\\pi D}} \\sqrt{\\Delta\\tau} + \\mathcal{O}(\\Delta\\tau)\n$$\n通过将此结果与目标形式 $K(0,0;\\Delta\\tau) = K_{0}(0;\\Delta\\tau) - \\frac{\\alpha}{4 D} + C \\,\\sqrt{\\Delta\\tau} + \\mathcal{O}(\\Delta\\tau)$ 进行比较，我们可以确定系数 $C$：\n$$\nC = \\frac{\\alpha^2}{4D\\sqrt{\\pi D}} = \\frac{\\alpha^2}{4\\sqrt{\\pi}D^{3/2}}\n$$\n\n**第三部分：关于主导非解析项的定性解释**\n\n原点处传播子的短时展开为\n$$\nK(0,0;\\Delta\\tau) = (4\\pi D \\Delta\\tau)^{-1/2} - \\frac{\\alpha}{4D} + \\frac{\\alpha^2}{4\\sqrt{\\pi}D^{3/2}} (\\Delta\\tau)^{1/2} + \\mathcal{O}(\\Delta\\tau)\n$$\n对于具有光滑势的哈密顿量，对称Trotter积公式 $\\exp(-\\Delta\\tau(T+V)) = \\exp(-\\frac{\\Delta\\tau}{2}V)\\exp(-\\Delta\\tau T)\\exp(-\\frac{\\Delta\\tau}{2}V) + \\mathcal{O}(\\Delta\\tau^3)$ 表明，近似传播子的误差为 $\\Delta\\tau^3$ 阶。这意味着精确传播子本身 $K(x,x';\\Delta\\tau)$ 是 $\\Delta\\tau$ 在 $\\Delta\\tau=0$ 处的解析函数，即其级数展开仅包含 $\\Delta\\tau$ 的整数次幂。\n\n我们为 $\\delta$ 函数势导出的展开式显然违反了这一结构。传播子的相互作用部分 $K(0,0;\\Delta\\tau) - K_0(0;\\Delta\\tau)$ 包含一个项 $C \\sqrt{\\Delta\\tau} = C (\\Delta\\tau)^{1/2}$。这一项由于其非整数次幂，在 $\\Delta\\tau = 0$ 处是非解析的。因此，主导这种与解析性偏差的 $\\Delta\\tau$ 的主导幂次是 $(\\Delta\\tau)^{1/2}$。\n\n定性地看，这种深刻的差异源于 $\\delta$ 函数势的奇异性质。对称Trotter公式的高阶精度依赖于诸如 $[T,[T,V]]$ 和 $[V,[V,T]]$ 等对易子的数学良态性。对于光滑势 $V(x)$，这些对易子的计算结果是良定义的（尽管通常是更高阶的）微分算符。然而，对于接触势 $V(x) = \\alpha \\delta(x)$，其中 $T \\propto d^2/dx^2$，这些对易子变成了涉及 $\\delta$ 函数导数的奇异对象。这种常规算符代数的失效使得支撑标准 $\\mathcal{O}(\\Delta\\tau^3)$ 误差分析的假设不再成立。精确短时展开中 $\\sqrt{\\Delta\\tau}$ 项的存在正是这种奇异性的直接数学表现。它表明，该传播子的行为与光滑势情形有根本的不同，导致任何基于简单类Trotter离散化的算法收敛速度都慢得多。", "answer": "$$\n\\boxed{\\frac{\\alpha^{2}}{4\\sqrt{\\pi}D^{3/2}}}\n$$", "id": "3562636"}, {"introduction": "GFMC 算法通过一个“行走者”总体来随机表示多体波函数，而维持这个总体的稳定是方法成功的关键。行走者的权重会根据局域能量 $E_L$ 的涨落而调整，若不加以控制，可能导致总体崩溃或爆炸。此练习旨在建立一个量化框架，用于分析和确保行走者总体的稳定性，通过它你将学会如何设定时间步长 $\\Delta\\tau$ 和参考能量 $E_T$ 等关键参数，以维持健康的行走者总体，这是运行有效 GFMC 模拟的一项核心技能。", "problem": "考虑用于原子核的格林函数蒙特卡洛 (GFMC) 方法，该方法在虚时间中将一个试探多体波函数投影到基态。波函数 $\\Psi(\\boldsymbol{R},\\tau)$ 的虚时间演化由虚时间中的含时薛定谔方程决定，这意味着一个短时传播子可以被转化为一个带权行走子的随机过程。在此框架下，与试探波函数 $\\Psi_{\\mathrm{T}}(\\boldsymbol{R})$ 相关的局域能量 $E_{\\mathrm{L}}(\\boldsymbol{R})$ 的概念定义为 $E_{\\mathrm{L}}(\\boldsymbol{R}) = \\dfrac{H \\Psi_{\\mathrm{T}}(\\boldsymbol{R})}{\\Psi_{\\mathrm{T}}(\\boldsymbol{R})}$，其中 $H$ 是原子核哈密顿算符。在一个小的虚时间步长 $\\Delta \\tau$ 内，行走子的权重会根据局域能量与一个用于稳定布居的可调参考能量 $E_{\\mathrm{T}}$ 之间的差异进行更新。\n\n你的任务是通过估计给定时间步长 $\\Delta \\tau$ 下的权重分布来分析 GFMC 的稳定性，并采用以下物理上合理的近似：在单个时间步长内，行走子经历的局域能量 $E_{\\mathrm{L}}$ 是一个高斯随机变量，其均值 $\\mu_{E}$ 和标准差 $\\sigma_{E}$ 由原子核哈密顿量和围绕典型核构型选择的试探波函数确定。你必须：\n\n- 从虚时间投影子构造和局域能量的定义出发，假设 $E_{\\mathrm{L}}$ 遵循高斯近似且单步内各行走子之间相互独立，推导出行走子权重因子的单步统计分布，该分布是 $\\Delta \\tau$、$\\mu_{E}$、$\\sigma_{E}$ 和 $E_{\\mathrm{T}}$ 的函数。\n- 根据该分布，推导出以下各项的闭式表达式：\n  1. 行走子权重在一个步骤中的期望乘法增长因子 $g$，完全用 $\\Delta \\tau$、$\\mu_{E}$、$\\sigma_{E}$ 和 $E_{\\mathrm{T}}$ 表示。\n  2. 单步权重因子的变异系数平方 $\\mathrm{CV}^{2}$，以及由此产生的单步后预期有效布居数分数 $f$，定义为 $f = \\dfrac{\\mathrm{ESS}}{N}$，其中 $\\mathrm{ESS} = \\dfrac{\\left(\\sum_{i=1}^{N} w_{i}\\right)^{2}}{\\sum_{i=1}^{N} w_{i}^{2}}$，$N$ 是行走子的数量，$w_{i}$ 是它们的权重。\n  3. 单个权重在一步内低于下阈值 $w_{\\mathrm{lo}}$ 或超过上阈值 $w_{\\mathrm{hi}}$ 的尾部概率。\n- 提出并形式化稳定性判据，以避免在一个时间步长内发生布居崩塌或爆炸。你的判据必须包括以下所有内容：\n  1. 一个最小有效布居数分数 $f_{\\min}$，要求 $f \\geq f_{\\min}$。\n  2. 权重增长的界限 $g_{\\min} \\leq g \\leq g_{\\max}$。\n  3. 一个关于权重落在 $[w_{\\mathrm{lo}}, w_{\\mathrm{hi}}]$ 区间之外的单步概率的尾部约束，要求组合尾部概率小于或等于 $p_{\\max}$。\n- 提出任何能够中和平均权重增长的 $E_{\\mathrm{T}}$ 的建议选择（用给定参数表示），并根据 $\\sigma_{E}$ 和 $f_{\\min}$ 确定一个确保 $f \\geq f_{\\min}$ 的 $\\Delta \\tau$ 界限。\n\n你必须实现一个程序，将你推导出的公式和稳定性判据应用于以下测试套件。所有能量单位为兆电子伏 (MeV)，时间步长单位为逆兆电子伏 ($\\mathrm{MeV}^{-1}$)。行走子数量 $N$ 是为提供上下文而给出的，但稳定性分数 $f$ 必须被视为在大 $N$ 近似下单步的期望值，与 $N$ 无关。阈值是无量纲的：\n\n- 适用于所有情况的全局阈值：\n  - $f_{\\min} = 0.98$\n  - $g_{\\min} = 0.98$\n  - $g_{\\max} = 1.02$\n  - $w_{\\mathrm{lo}} = 0.5$\n  - $w_{\\mathrm{hi}} = 2.0$\n  - $p_{\\max} = 0.05$\n\n- 测试用例（每个用例是一个元组 $(N, \\Delta \\tau, \\mu_{E}, \\sigma_{E}, E_{\\mathrm{T}})$）：\n  1. 用例 A：$(1000, 0.001, -30, 5, -30)$\n  2. 用例 B：$(5000, 0.020, -30, 10, -30)$\n  3. 用例 C：$(2000, 0.005, -40, 8, -20)$\n  4. 用例 D：$(10000, 0.030, -20, 20, -20)$\n\n你的程序必须为每个测试用例计算一个布尔稳定性结论，当且仅当上述所有三个判据同时满足时为真，否则为假。问题中不出现角度，最终结果为无量纲数字；因此，不需要指定角度单位。你的程序应生成单行输出，其中包含四个布尔结果，形式为方括号内以逗号分隔的列表（例如，$[result1,result2,result3,result4]$）。程序必须是自包含的，不使用外部输入或文件，并且实现所推导的公式，而不依赖于标准数学恒等式和高斯分布性质之外的任何未经推导的“捷径”结果。", "solution": "该问题要求在局域能量分布的高斯近似下，为格林函数蒙特卡洛 (GFMC) 模拟推导稳定性判据，然后对这些判据进行数值应用。\n\n首先，我们形式化单步权重更新及其统计特性。在重要性采样的 GFMC 中，每个虚时间步长 $\\Delta \\tau$ 中，行走子的权重乘以一个因子 $w$。该因子通常由以下公式给出：\n$$\nw = \\exp\\left[ - (E_{\\mathrm{L}}(\\boldsymbol{R}) - E_{\\mathrm{T}}) \\Delta \\tau \\right]\n$$\n其中 $E_{\\mathrm{L}}(\\boldsymbol{R})$ 是行走子构型 $\\boldsymbol{R}$ 处的局域能量，$E_{\\mathrm{T}}$ 是一个参考能量。\n\n问题陈述 $E_{\\mathrm{L}}$ 可以被建模为一个高斯随机变量，$E_{\\mathrm{L}} \\sim \\mathcal{N}(\\mu_{E}, \\sigma_{E}^2)$。令权重因子中的指数为一个随机变量 $X$：\n$$\nX = - (E_{\\mathrm{L}} - E_{\\mathrm{T}}) \\Delta \\tau = (E_{\\mathrm{T}} - E_{\\mathrm{L}}) \\Delta \\tau\n$$\n由于 $X$ 是高斯变量 $E_{\\mathrm{L}}$ 的线性变换，所以 $X$ 也是一个高斯随机变量。其均值 $\\mu_X$ 和方差 $\\sigma_X^2$ 分别为：\n$$\n\\mu_X = \\mathbb{E}[X] = \\mathbb{E}[(E_{\\mathrm{T}} - E_{\\mathrm{L}}) \\Delta \\tau] = (E_{\\mathrm{T}} - \\mathbb{E}[E_{\\mathrm{L}}]) \\Delta \\tau = (E_{\\mathrm{T}} - \\mu_{E}) \\Delta \\tau\n$$\n$$\n\\sigma_X^2 = \\mathrm{Var}[X] = \\mathrm{Var}[(E_{\\mathrm{T}} - E_{\\mathrm{L}}) \\Delta \\tau] = (-\\Delta \\tau)^2 \\mathrm{Var}[E_{\\mathrm{L}}] = (\\sigma_{E} \\Delta \\tau)^2\n$$\n$X$ 的标准差是 $\\sigma_X = \\sigma_{E} \\Delta \\tau$。因此，$X \\sim \\mathcal{N}(\\mu_X, \\sigma_X^2)$。\n由于权重因子是 $w = e^X$，其分布是对数正态分布，参数为 $\\mu_X$ 和 $\\sigma_X^2$。$w$ 的概率密度函数是 $p(w) = \\frac{1}{w \\sigma_X \\sqrt{2\\pi}} \\exp\\left( - \\frac{(\\ln w - \\mu_X)^2}{2 \\sigma_X^2} \\right)$，其中 $w  0$。\n\n接下来，我们推导所要求的统计量。\n1.  行走子权重的期望乘法增长因子 $g$ 是对数正态分布的均值：\n$$\ng = \\mathbb{E}[w] = \\exp\\left(\\mu_X + \\frac{\\sigma_X^2}{2}\\right) = \\exp\\left( (E_{\\mathrm{T}} - \\mu_{E}) \\Delta \\tau + \\frac{(\\sigma_{E} \\Delta \\tau)^2}{2} \\right)\n$$\n2.  变异系数的平方 $\\mathrm{CV}^2$ 定义为 $\\frac{\\mathrm{Var}[w]}{(\\mathbb{E}[w])^2}$。对于对数正态分布，方差为 $\\mathrm{Var}[w] = (\\exp(\\sigma_X^2) - 1)\\exp(2\\mu_X + \\sigma_X^2)$。因此：\n$$\n\\mathrm{CV}^2 = \\frac{(\\exp(\\sigma_X^2) - 1)\\exp(2\\mu_X + \\sigma_X^2)}{\\left(\\exp(\\mu_X + \\sigma_X^2/2)\\right)^2} = \\exp(\\sigma_X^2) - 1 = \\exp((\\sigma_{E} \\Delta \\tau)^2) - 1\n$$\n有效样本量 (ESS) 由 $\\mathrm{ESS} = \\frac{(\\sum w_i)^2}{\\sum w_i^2}$ 给出。在大行走子布居极限 ($N \\to \\infty$)下，我们可以用期望值来近似求和：$\\mathrm{ESS} \\approx N \\frac{(\\mathbb{E}[w])^2}{\\mathbb{E}[w^2]}$。有效布居数分数 $f$ 变为：\n$$\nf = \\frac{\\mathrm{ESS}}{N} \\approx \\frac{(\\mathbb{E}[w])^2}{\\mathbb{E}[w^2]} = \\frac{(\\mathbb{E}[w])^2}{\\mathrm{Var}[w] + (\\mathbb{E}[w])^2} = \\frac{1}{\\frac{\\mathrm{Var}[w]}{(\\mathbb{E}[w])^2} + 1} = \\frac{1}{\\mathrm{CV}^2 + 1}\n$$\n代入 $\\mathrm{CV}^2$ 的表达式：\n$$\nf = \\frac{1}{(\\exp((\\sigma_{E} \\Delta \\tau)^2) - 1) + 1} = \\exp(-(\\sigma_{E} \\Delta \\tau)^2)\n$$\n3.  尾部概率是通过将关于 $w$ 的事件关联到正态分布变量 $X = \\ln w$ 上的事件来计算的。令 $\\Phi(z)$ 为标准正态分布 $\\mathcal{N}(0, 1)$ 的累积分布函数 (CDF)。\n权重低于 $w_{\\mathrm{lo}}$ 的概率是：\n$$\nP(w  w_{\\mathrm{lo}}) = P(\\ln w  \\ln w_{\\mathrm{lo}}) = P(X  \\ln w_{\\mathrm{lo}}) = P\\left(\\frac{X - \\mu_X}{\\sigma_X}  \\frac{\\ln w_{\\mathrm{lo}} - \\mu_X}{\\sigma_X}\\right) = \\Phi\\left(\\frac{\\ln w_{\\mathrm{lo}} - \\mu_X}{\\sigma_X}\\right)\n$$\n权重超过 $w_{\\mathrm{hi}}$ 的概率是：\n$$\nP(w > w_{\\mathrm{hi}}) = P(X > \\ln w_{\\mathrm{hi}}) = 1 - P(X \\leq \\ln w_{\\mathrm{hi}}) = 1 - \\Phi\\left(\\frac{\\ln w_{\\mathrm{hi}} - \\mu_X}{\\sigma_X}\\right)\n$$\n组合尾部概率是 $p_{\\mathrm{tail}} = P(w  w_{\\mathrm{lo}}) + P(w > w_{\\mathrm{hi}})$。\n\n通过这些推导，我们形式化稳定性判据：\n1.  **最小有效布居数分数**：$f \\geq f_{\\min}$\n    $$\n    \\exp(-(\\sigma_{E} \\Delta \\tau)^2) \\geq f_{\\min}\n    $$\n2.  **权重增长界限**：$g_{\\min} \\leq g \\leq g_{\\max}$\n    $$\n    g_{\\min} \\leq \\exp\\left( (E_{\\mathrm{T}} - \\mu_{E}) \\Delta \\tau + \\frac{(\\sigma_{E} \\Delta \\tau)^2}{2} \\right) \\leq g_{\\max}\n    $$\n3.  **尾部概率约束**：$p_{\\mathrm{tail}} \\leq p_{\\max}$\n    $$\n    \\Phi\\left(\\frac{\\ln w_{\\mathrm{lo}} - \\mu_X}{\\sigma_X}\\right) + 1 - \\Phi\\left(\\frac{\\ln w_{\\mathrm{hi}} - \\mu_X}{\\sigma_X}\\right) \\leq p_{\\max}\n    $$\n    其中 $\\mu_X = (E_{\\mathrm{T}} - \\mu_{E}) \\Delta \\tau$ 且 $\\sigma_X = \\sigma_{E} \\Delta \\tau$。\n\n为了中和平均权重增长，我们设置 $g=1$：\n$$\n\\exp\\left( (E_{\\mathrm{T}} - \\mu_{E}) \\Delta \\tau + \\frac{(\\sigma_{E} \\Delta \\tau)^2}{2} \\right) = 1\n$$\n取对数并解出 $E_{\\mathrm{T}}$ (对于 $\\Delta \\tau  0$)：\n$$\n(E_{\\mathrm{T}} - \\mu_{E}) \\Delta \\tau + \\frac{\\sigma_{E}^2 (\\Delta \\tau)^2}{2} = 0 \\implies E_{\\mathrm{T}} = \\mu_{E} - \\frac{\\sigma_{E}^2 \\Delta \\tau}{2}\n$$\n这个对 $E_{\\mathrm{T}}$ 的选择确保了期望权重增长为 1。\n\n为了找到给定 $f \\geq f_{\\min}$ 时 $\\Delta \\tau$ 的界限，我们解不等式：\n$$\n\\exp(-(\\sigma_{E} \\Delta \\tau)^2) \\geq f_{\\min} \\implies -(\\sigma_{E} \\Delta \\tau)^2 \\geq \\ln f_{\\min}\n$$\n两边乘以 $-1$ 会反转不等号：\n$$\n(\\sigma_{E} \\Delta \\tau)^2 \\leq -\\ln f_{\\min}\n$$\n由于 $\\Delta \\tau  0$ 且 $\\sigma_E  0$，我们可以取平方根：\n$$\n\\Delta \\tau \\leq \\frac{\\sqrt{-\\ln f_{\\min}}}{\\sigma_{E}}\n$$\n这提供了满足有效布居数约束的最大时间步长。\n我们现在将这些公式应用于测试用例。", "answer": "```python\nimport numpy as np\nfrom scipy.special import erf\n\ndef solve():\n    \"\"\"\n    Analyzes the stability of GFMC simulations for a set of test cases\n    based on derived criteria.\n    \"\"\"\n\n    # Global thresholds defined in the problem statement.\n    f_min = 0.98\n    g_min = 0.98\n    g_max = 1.02\n    w_lo = 0.5\n    w_hi = 2.0\n    p_max = 0.05\n\n    # Test cases: (N, delta_tau, mu_E, sigma_E, E_T)\n    test_cases = [\n        (1000, 0.001, -30.0, 5.0, -30.0),  # Case A\n        (5000, 0.020, -30.0, 10.0, -30.0), # Case B\n        (2000, 0.005, -40.0, 8.0, -20.0),  # Case C\n        (10000, 0.030, -20.0, 20.0, -20.0)  # Case D\n    ]\n\n    def check_stability(delta_tau, mu_E, sigma_E, E_T):\n        \"\"\"\n        Computes stability metrics and returns a boolean verdict for a single case.\n        \"\"\"\n        \n        # Calculate parameters of the log-normal distribution for the weight factor.\n        # X = ln(w) is normally distributed with mean mu_X and std sigma_X.\n        mu_X = (E_T - mu_E) * delta_tau\n        sigma_X = sigma_E * delta_tau\n\n        # Criterion 1: Effective population size fraction f\n        # f = exp(-(sigma_E * delta_tau)^2)\n        f = np.exp(-(sigma_X**2))\n        is_stable_f = (f >= f_min)\n\n        # Criterion 2: Expected weight growth factor g\n        # g = exp(mu_X + sigma_X^2 / 2)\n        g = np.exp(mu_X + (sigma_X**2) / 2)\n        is_stable_g = (g_min = g = g_max)\n\n        # Criterion 3: Tail probability p_tail\n        # Define a standard normal CDF using the error function erf.\n        # Phi(z) = 0.5 * (1 + erf(z / sqrt(2)))\n        def std_norm_cdf(z):\n            return 0.5 * (1.0 + erf(z / np.sqrt(2.0)))\n\n        # Handle sigma_X = 0 case to avoid division by zero.\n        if sigma_X == 0:\n            # If sigma_X is zero, weights are deterministic: w = exp(mu_X).\n            w = np.exp(mu_X)\n            p_tail_lo = 1.0 if w  w_lo else 0.0\n            p_tail_hi = 1.0 if w > w_hi else 0.0\n            p_tail = p_tail_lo + p_tail_hi\n        else:\n            z_lo = (np.log(w_lo) - mu_X) / sigma_X\n            z_hi = (np.log(w_hi) - mu_X) / sigma_X\n            \n            p_tail_lo = std_norm_cdf(z_lo)\n            p_tail_hi = 1.0 - std_norm_cdf(z_hi)\n            p_tail = p_tail_lo + p_tail_hi\n            \n        is_stable_p = (p_tail = p_max)\n\n        # The system is stable if and only if all criteria are met.\n        return is_stable_f and is_stable_g and is_stable_p\n\n    results = []\n    for case in test_cases:\n        # The number of walkers N is for context and not used in the large-N limit.\n        _, delta_tau, mu_E, sigma_E, E_T = case\n        verdict = check_stability(delta_tau, mu_E, sigma_E, E_T)\n        results.append(verdict)\n\n    # Format the final output as specified.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3562632"}, {"introduction": "运行一次成功的 GFMC 模拟会产生一系列能量估计值的时间序列，但这些数据点并非相互独立。由于算法的马尔可夫链性质，相邻的构型和能量值存在自相关性，若忽略这一点会严重低估统计误差。本练习将引导你推导自相关对统计不确定性的影响，并掌握一种可靠的处理方法——分块分析法（blocking analysis），这对于从任何蒙特卡洛模拟中获得可信的物理结果都至关重要。", "problem": "对轻原子核的格林函数蒙特卡洛（GFMC）模拟生成了一个在相等虚时间隔上的能量估计值的平稳时间序列 $\\{E_{t}\\}_{t=1}^{N}$。由于连续的GFMC构型是相关的，因此能量样本不是独立的。\n\n要求您阐述自相关对于从相关的GFMC数据中估计样本均值不确定度的影响，并为此目的阐明一种有原则的分块分析方法。\n\n从平稳过程的时间序列分析的第一性原理出发，完成以下任务：\n1. 为GFMC能量时间序列定义归一化自相关函数 $\\rho_{k}$。\n2. 用自协方差函数或 $\\rho_{k}$ 表示样本均值 $\\bar{E} = \\frac{1}{N}\\sum_{t=1}^{N} E_{t}$ 的方差，并阐明您的表达式成立所依据的假设。\n3. 通过将时间序列划分为 $n_{b} = N/B$ 个大小相等的连续数据块 $B$ 并定义块均值 $Y_{j} = \\frac{1}{B}\\sum_{t=(j-1)B+1}^{jB} E_{t}$（其中 $j = 1, \\dots, n_{b}$）来构建分块分析。推导块均值的方差表达式（用 $B$、方差 $\\sigma^{2} = \\mathrm{Var}(E_{t})$ 和自相关 $\\rho_{k}$ 表示），并展示当块大小 $B$ 足够大时，分块分析如何为相关样本的 $\\bar{E}$ 的标准误差提供一个渐近无偏估计量。\n\n然后，将您的推导应用于以下GFMC数据集：\n- 样本数量为 $N = 4096$。\n- 观测到的单一样本能量的方差为 $\\sigma^{2} = 4\\,\\mathrm{MeV}^{2}$。\n- 归一化自相关函数经验上可以很好地用指数衰减 $\\rho_{k} = \\alpha^{k}$ 来近似，其中 $\\alpha = \\exp(-1/\\kappa)$ 且 $\\kappa = 25$（以样本数为单位）。\n\n假设选择的块大小 $B$ 足够大，以至于块间相关性与块内相关性相比可以忽略不计。使用您的分块分析，计算平均能量标准误差的估计值。以 $\\mathrm{MeV}$ 为单位表示您的最终答案，并将答案四舍五入到四位有效数字。", "solution": "该问题要求对相关时间序列（格林函数蒙特卡洛（GFMC）模拟的特征）进行统计误差分析的理论处理，并随后进行具体计算。该问题在科学上是合理的、提法明确，并包含所有必要信息。我们开始解答。\n\n分析基于这样一个假设：能量估计值的时间序列 $\\{E_{t}\\}_{t=1}^{N}$ 是一个宽平稳过程。这意味着该过程的均值 $\\mathrm{E}[E_{t}] = \\mu$ 和方差 $\\mathrm{Var}(E_{t}) = \\sigma^{2}$ 对所有时间 $t$ 都是常数。此外，样本之间的协方差仅取决于时间延迟 $k = |t-s|$，而不取决于绝对时间 $t$ 和 $s$。\n\n1. 归一化自相关函数的定义\n\n对于一个平稳过程，自协方差函数 $\\gamma_{k}$ 定义为相隔时间延迟为 $k$ 的两个样本之间的协方差：\n$$\n\\gamma_{k} = \\mathrm{Cov}(E_{t}, E_{t+k}) = \\mathrm{E}[(E_{t} - \\mu)(E_{t+k} - \\mu)]\n$$\n方差是时间延迟为零的特殊情况，$\\gamma_{0} = \\mathrm{Cov}(E_{t}, E_{t}) = \\mathrm{Var}(E_{t}) = \\sigma^{2}$。\n\n归一化自相关函数 $\\rho_{k}$ 定义为自协方差函数除以过程的方差：\n$$\n\\rho_{k} = \\frac{\\gamma_{k}}{\\gamma_{0}} = \\frac{\\mathrm{Cov}(E_{t}, E_{t+k})}{\\mathrm{Var}(E_{t})}\n$$\n根据定义，$\\rho_{0} = 1$。函数 $\\rho_{k}$ 量化了样本之间的线性相关程度，作为它们在时间序列中分离度的函数。\n\n2. 样本均值的方差\n\n样本均值 $\\bar{E}$ 定义为：\n$$\n\\bar{E} = \\frac{1}{N} \\sum_{t=1}^{N} E_{t}\n$$\n样本均值的方差由下式给出：\n$$\n\\mathrm{Var}(\\bar{E}) = \\mathrm{Var}\\left(\\frac{1}{N} \\sum_{t=1}^{N} E_{t}\\right) = \\frac{1}{N^{2}} \\mathrm{Var}\\left(\\sum_{t=1}^{N} E_{t}\\right)\n$$\n使用随机变量求和的方差性质：\n$$\n\\mathrm{Var}\\left(\\sum_{t=1}^{N} E_{t}\\right) = \\sum_{t=1}^{N} \\sum_{s=1}^{N} \\mathrm{Cov}(E_{t}, E_{s})\n$$\n引用平稳性假设，$\\mathrm{Cov}(E_{t}, E_{s}) = \\gamma_{|t-s|} = \\sigma^{2} \\rho_{|t-s|}$。这个双重求和可以通过将具有相同延迟 $k = |t-s|$ 的项分组来重写。对于给定的延迟 $k  0$，有 $2(N-k)$ 对 $(t, s)$ 满足 $|t-s| = k$。对于 $k=0$，有 $N$ 对。\n$$\n\\sum_{t=1}^{N} \\sum_{s=1}^{N} \\gamma_{|t-s|} = N\\gamma_{0} + \\sum_{k=1}^{N-1} 2(N-k)\\gamma_{k}\n$$\n将此代回 $\\mathrm{Var}(\\bar{E})$ 的表达式中：\n$$\n\\mathrm{Var}(\\bar{E}) = \\frac{1}{N^{2}} \\left( N\\sigma^{2} + \\sum_{k=1}^{N-1} 2(N-k)\\sigma^{2}\\rho_{k} \\right)\n$$\n提出因子 $\\frac{\\sigma^{2}}{N}$，得到样本均值方差的最终表达式：\n$$\n\\mathrm{Var}(\\bar{E}) = \\frac{\\sigma^{2}}{N} \\left( 1 + 2\\sum_{k=1}^{N-1} \\left(1 - \\frac{k}{N}\\right)\\rho_{k} \\right)\n$$\n在平稳性假设下，此表达式是精确的。如果样本数 $N$ 远大于相关时间（即 $\\rho_{k}$ 显著不为零的 $k$ 的范围），我们可以做两个近似：$1 - k/N \\approx 1$，并且求和可以扩展到无穷大，$\\sum_{k=1}^{N-1} \\to \\sum_{k=1}^{\\infty}$。这导出了著名的渐近公式：\n$$\n\\mathrm{Var}(\\bar{E}) \\approx \\frac{\\sigma^{2}}{N} \\left( 1 + 2\\sum_{k=1}^{\\infty} \\rho_{k} \\right) = \\frac{\\sigma^{2}}{N} \\tau_{corr}\n$$\n其中 $\\tau_{corr} = 1 + 2\\sum_{k=1}^{\\infty} \\rho_{k}$ 是积分自相关时间。这表明，与不相关数据相比，相关性使均值的方差增加了因子 $\\tau_{corr}$，从而有效地将独立样本的数量减少到 $N_{eff} = N / \\tau_{corr}$。\n\n3. 分块分析\n\n分块方法提供了一种稳健的、非参数的方法，可以从相关数据中估计均值的方差，而无需事先知道自相关函数。长度为 $N$ 的时间序列被划分为 $n_{b}$ 个大小为 $B$ 的不重叠块，使得 $N = n_{b}B$。每个块的均值计算如下：\n$$\nY_{j} = \\frac{1}{B} \\sum_{t=(j-1)B+1}^{jB} E_{t} \\quad \\text{for } j = 1, \\dots, n_{b}\n$$\n单个块均值的方差 $\\mathrm{Var}(Y_{j})$ 可以通过应用第2部分中推导的公式（样本大小为 $B$）得到：\n$$\n\\sigma_{B}^{2} \\equiv \\mathrm{Var}(Y_{j}) = \\frac{\\sigma^{2}}{B} \\left( 1 + 2\\sum_{k=1}^{B-1} \\left(1 - \\frac{k}{B}\\right)\\rho_{k} \\right)\n$$\n总体样本均值 $\\bar{E}$ 也是块均值的均值：$\\bar{E} = \\frac{1}{n_{b}}\\sum_{j=1}^{n_{b}} Y_{j}$。\n分块的核心思想是选择块大小 $B$ 远大于原始数据的相关时间 $\\kappa$。当 $B \\gg \\kappa$ 时，不同块中数据点之间的相关性变得可以忽略不计，因此块均值 $\\{Y_{j}\\}$ 可以被近似地视为独立同分布的随机变量。\n\n在这种独立性假设下，块均值的均值（即 $\\bar{E}$）的方差由独立同分布（i.i.d.）样本均值方差的标准公式给出：\n$$\n\\mathrm{Var}(\\bar{E}) \\approx \\frac{\\mathrm{Var}(Y_{j})}{n_{b}} = \\frac{\\sigma_{B}^{2}}{n_{b}}\n$$\n为了证明这会产生一个渐近无偏估计量，考虑 $B$ 很大的极限情况。对于 $B \\gg \\kappa$，对于任何 $\\rho_{k}$ 显著的 $k$，都有 $k/B \\approx 0$。求和也可以扩展到无穷大，因为当 $k \\ge B$ 时 $\\rho_k \\approx 0$。因此：\n$$\n\\lim_{B \\to \\infty} B \\cdot \\mathrm{Var}(Y_{j}) = \\lim_{B \\to \\infty} \\sigma^{2} \\left( 1 + 2\\sum_{k=1}^{B-1} \\left(1 - \\frac{k}{B}\\right)\\rho_{k} \\right) = \\sigma^{2} \\left( 1 + 2\\sum_{k=1}^{\\infty} \\rho_{k} \\right) = \\sigma^{2} \\tau_{corr}\n$$\n因此，对于足够大的B，$\\mathrm{Var}(Y_{j}) \\approx \\frac{\\sigma^{2}\\tau_{corr}}{B}$。将此代入 $\\bar{E}$ 的方差估计中：\n$$\n\\mathrm{Var}(\\bar{E}) \\approx \\frac{\\sigma_{B}^{2}}{n_{b}} \\approx \\frac{1}{n_{b}} \\left( \\frac{\\sigma^{2}\\tau_{corr}}{B} \\right) = \\frac{\\sigma^{2}\\tau_{corr}}{n_{b}B} = \\frac{\\sigma^{2}\\tau_{corr}}{N}\n$$\n这与第2部分推导的渐近公式相符。在实践中，$\\sigma_{B}^{2}$ 是根据块均值的样本方差 $s_{Y}^{2} = \\frac{1}{n_{b}-1}\\sum_{j=1}^{n_{b}} (Y_{j} - \\bar{E})^{2}$ 来估计的。均值的标准误差则估计为 $\\widehat{\\mathrm{SE}}(\\bar{E}) = \\sqrt{s_{Y}^{2}/n_{b}}$。当 $B \\to \\infty$（同时保持 $n_{b}$ 足够大）时，$s_{Y}^{2}$ 成为 $\\sigma_B^2$ 的无偏估计量，整个过程产生了 $\\bar{E}$ 真实标准误差的一个渐近无偏估计量。\n\n对数据集的应用\n\n给定条件如下：\n- 样本数量：$N = 4096$。\n- 单一样本方差：$\\sigma^{2} = 4\\,\\mathrm{MeV}^{2}$，因此 $\\sigma = 2\\,\\mathrm{MeV}$。\n- 自相关函数：$\\rho_{k} = \\alpha^{k}$，其中 $\\alpha = \\exp(-1/\\kappa)$ 且相关时间 $\\kappa = 25$ 个样本。\n\n问题要求在块大小 $B$ 足够大的假设下，估计平均能量的标准误差。这意味着我们应该使用上面推导的、正确考虑了相关性的渐近极限。标准误差是方差的平方根：\n$$\n\\mathrm{SE}(\\bar{E}) = \\sqrt{\\mathrm{Var}(\\bar{E})} = \\sqrt{\\frac{\\sigma^{2}}{N} \\tau_{corr}}\n$$\n我们首先计算给定指数形式 $\\rho_k$ 的积分自相关时间 $\\tau_{corr}$：\n$$\n\\tau_{corr} = 1 + 2\\sum_{k=1}^{\\infty} \\rho_{k} = 1 + 2\\sum_{k=1}^{\\infty} \\alpha^{k}\n$$\n这个求和是一个几何级数：$\\sum_{k=1}^{\\infty} \\alpha^{k} = \\frac{\\alpha}{1-\\alpha}$（因为 $|\\alpha| = \\exp(-1/25)  1$）。\n$$\n\\tau_{corr} = 1 + 2\\frac{\\alpha}{1-\\alpha} = \\frac{1-\\alpha+2\\alpha}{1-\\alpha} = \\frac{1+\\alpha}{1-\\alpha}\n$$\n代入 $\\alpha = \\exp(-1/\\kappa)$：\n$$\n\\tau_{corr} = \\frac{1 + \\exp(-1/\\kappa)}{1 - \\exp(-1/\\kappa)} = \\frac{\\exp(1/(2\\kappa)) + \\exp(-1/(2\\kappa))}{\\exp(1/(2\\kappa)) - \\exp(-1/(2\\kappa))} = \\coth\\left(\\frac{1}{2\\kappa}\\right)\n$$\n当 $\\kappa = 25$ 时，我们得到：\n$$\n\\tau_{corr} = \\coth\\left(\\frac{1}{2 \\times 25}\\right) = \\coth\\left(\\frac{1}{50}\\right) = \\coth(0.02)\n$$\n因此，标准误差为：\n$$\n\\mathrm{SE}(\\bar{E}) = \\sqrt{\\frac{\\sigma^{2}}{N} \\coth(0.02)} = \\sqrt{\\frac{4\\,\\mathrm{MeV}^{2}}{4096}} \\sqrt{\\coth(0.02)}\n$$\n$$\n\\mathrm{SE}(\\bar{E}) = \\frac{2\\,\\mathrm{MeV}}{\\sqrt{4096}} \\sqrt{\\coth(0.02)} = \\frac{2\\,\\mathrm{MeV}}{64} \\sqrt{\\coth(0.02)} = \\frac{1}{32}\\,\\mathrm{MeV} \\sqrt{\\coth(0.02)}\n$$\n现在我们计算数值：\n$$\n\\coth(0.02) \\approx 50.00666755\n$$\n$$\n\\sqrt{\\coth(0.02)} \\approx \\sqrt{50.00666755} \\approx 7.07154067\n$$\n$$\n\\mathrm{SE}(\\bar{E}) \\approx \\frac{1}{32} \\times 7.07154067 \\,\\mathrm{MeV} \\approx 0.220985646 \\,\\mathrm{MeV}\n$$\n四舍五入到四位有效数字，平均能量的标准误差为 $0.2210\\,\\mathrm{MeV}$。", "answer": "$$\\boxed{0.2210}$$", "id": "3562651"}]}