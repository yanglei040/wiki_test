{"hands_on_practices": [{"introduction": "为了真正掌握运动方程耦合簇方法，我们从一个直接的计算开始。这个练习提供了一个动手实践的机会，为一个简单的、具有教学意义的两能级模型构建并对角化核心的EOM-CCSD矩阵，让你对激发能如何从相似变换哈密顿量 $\\bar{H}$ 中产生有一个具体的理解 [@problem_id:3558017]。", "problem": "考虑一个与计算核物理相关的最小双能级模型中的闭壳层参考态。哈密顿量相对于 Hartree-Fock 参考态 $|\\Phi_0\\rangle$ 进行了正规排序，并写为 $H_N = F + V$，其中 $F$ 是单体部分，$V$ 是双体相互作用。耦合簇基态为 $|\\Psi_0\\rangle = \\exp(T) |\\Phi_0\\rangle$，其中簇算符为 $T = T_1 + T_2$，相似变换后的哈密顿量定义为 $\\bar{H} = \\exp(-T) H_N \\exp(T)$。运动方程耦合簇单双激发 (EOM-CCSD) 的激发态问题是求解\n$$\n\\bar{H} R |\\Phi_0\\rangle = \\omega R |\\Phi_0\\rangle,\n$$\n其中激发算符 $R$ 被截断到单激发空间，形式为 $R = \\sum_{ai} r_i^{a} a_a^{\\dagger} a_i$，其中 $i$ 表示已占据（空穴）轨道，$a$ 表示未占据（粒子）轨道。在这个双能级模型中，有一个空穴轨道 $i$ 和两个粒子轨道 $p_1$ 和 $p_2$，它们定义了单激发基矢 $\\{ a_{p_1}^{\\dagger} a_i |\\Phi_0\\rangle, a_{p_2}^{\\dagger} a_i |\\Phi_0\\rangle \\}$。\n\n从 EOM-CCSD 本征值方程和单激发投影的定义出发，建立 $\\bar{H}$ 在单激发空间中的 $2 \\times 2$ 矩阵表示，\n$$\nA_{ai,bj} = \\langle \\Phi_0 | a_i^{\\dagger} a_a \\, \\bar{H} \\, a_b^{\\dagger} a_j | \\Phi_0 \\rangle,\n$$\n限制在 $i=j$ 且 $a,b \\in \\{p_1,p_2\\}$ 的情况下。对于此模型，假设单体缀饰能差以及对 $\\bar{H}$ 的单-单激发块的有效双体贡献已通过耦合簇基态确定如下：\n- 缀饰单体能隙：$\\tilde{\\epsilon}_{p_1} - \\tilde{\\epsilon}_{i} = 6.2$，$\\tilde{\\epsilon}_{p_2} - \\tilde{\\epsilon}_{i} = 8.5$。\n- 单-单激发块中的有效相互作用矩阵元：$\\tilde{W}_{p_1 i}^{p_1 i} = -0.3$，$\\tilde{W}_{p_2 i}^{p_2 i} = -0.2$，以及 $\\tilde{W}_{p_1 i}^{p_2 i} = \\tilde{W}_{p_2 i}^{p_1 i} = 0.4$。\n\n使用这些量，明确写出 $2 \\times 2$ 的单-单激发矩阵并计算其本征值，这些本征值是在此截断的 EOM-CCSD 处理中对激发能 $\\omega$ 的近似。将您的数值答案四舍五入到四位有效数字。以 MeV 为单位表示最终能量。", "solution": "用户提供了一个关于运动方程耦合簇 (EOM-CC) 方法在简化双能级模型中的问题，该模型与计算核物理相关。\n\n### 步骤1：提取已知条件\n- **方法**：运动方程耦合簇单双激发 (EOM-CCSD)，截断到单激发 ($R=R_1$) 空间。\n- **体系**：一个闭壳层参考态 $|\\Phi_0\\rangle$，包含一个用 $i$ 表示的已占据（空穴）轨道和两个用 $p_1$ 和 $p_2$ 表示的未占据（粒子）轨道。\n- **哈密顿量**：相似变换后的哈密顿量为 $\\bar{H} = \\exp(-T) H_N \\exp(T)$，其中 $T=T_1+T_2$。\n- **本征值问题**：$\\bar{H} R |\\Phi_0\\rangle = \\omega R |\\Phi_0\\rangle$，其中 $R = \\sum_{a,i} r_i^a a_a^\\dagger a_i$。在此模型中，求和遍及 $a \\in \\{p_1, p_2\\}$ 和单个空穴态 $i$。\n- **单激发基矢**：单激发空间的基矢为 $\\{ |\\Phi_i^{p_1}\\rangle, |\\Phi_i^{p_2}\\rangle \\}$，其中 $|\\Phi_i^a\\rangle = a_a^\\dagger a_i |\\Phi_0\\rangle$。\n- **矩阵表示**：$\\bar{H}$ 在单激发空间中的矩阵元定义为 $A_{ai,bj} = \\langle \\Phi_0 | a_i^{\\dagger} a_a \\, \\bar{H} \\, a_b^{\\dagger} a_j | \\Phi_0 \\rangle = \\langle \\Phi_i^a | \\bar{H} | \\Phi_j^b \\rangle$。对于此问题，$i=j$ 是固定的。\n- **给定数据（单位为 MeV）**：\n  - 缀饰单体能隙：$\\tilde{\\epsilon}_{p_1} - \\tilde{\\epsilon}_{i} = 6.2$，$\\tilde{\\epsilon}_{p_2} - \\tilde{\\epsilon}_{i} = 8.5$。\n  - 单-单激发块中的有效相互作用矩阵元：$\\tilde{W}_{p_1 i}^{p_1 i} = -0.3$，$\\tilde{W}_{p_2 i}^{p_2 i} = -0.2$，$\\tilde{W}_{p_1 i}^{p_2 i} = 0.4$，以及 $\\tilde{W}_{p_2 i}^{p_1 i} = 0.4$。\n- **任务**：\n  1. 构建 $2 \\times 2$ 的单-单激发矩阵 $A$。\n  2. 计算其本征值 $\\omega$。\n  3. 将结果四舍五入到四位有效数字。\n\n### 步骤2：使用提取的已知条件进行验证\n- **科学依据**：该问题基于成熟的 EOM-CCSD 方法，这是现代量子化学和计算物理学的基石。使用带有预先计算的有效相互作用的简化模型是一种标准且有效的教学方法。给出的能量值对于核结构计算是符合实际的。\n- **适定性**：问题定义清晰。它提供了构建 $2 \\times 2$ 矩阵所需的所有必要组成部分，并要求计算其本征值，这是一个标准的数学过程。存在唯一解。\n- **客观性**：问题以精确的技术语言陈述，没有主观或模棱两可的术语。\n\n### 步骤3：结论与行动\n该问题具有科学合理性、适定性和客观性。判定为**有效**。将提供解答。\n\n### 解答\n该问题要求我们在截断的单激发空间中求解 EOM-CCSD 本征值方程。该方程的矩阵形式为 $A \\mathbf{r} = \\omega \\mathbf{r}$，其中 $A$ 是相似变换后的哈密顿量 $\\bar{H}$ 在单激发基矢下的矩阵表示，$\\mathbf{r}$ 是振幅 $r_i^a$ 的向量。本征值 $\\omega$ 对应于激发能。\n\n单激发空间由两个态 $|\\Phi_i^{p_1}\\rangle = a_{p_1}^{\\dagger} a_i |\\Phi_0\\rangle$ 和 $|\\Phi_i^{p_2}\\rangle = a_{p_2}^{\\dagger} a_i |\\Phi_0\\rangle$ 张成。$2 \\times 2$ 矩阵 $A$ 的矩阵元为 $A_{ab} = \\langle \\Phi_i^a | \\bar{H} | \\Phi_i^b \\rangle$，其中 $a, b \\in \\{p_1, p_2\\}$。\n\n问题提供了这些矩阵元的组成部分：“缀饰单体能隙”和“有效相互作用矩阵元”。在 EOM-CCSD 形式体系中，$\\bar{H}$ 的矩阵元由经耦合簇振幅修正的单体项和双体项构成。给定的量代表了这些贡献的最终值。总矩阵元是这些部分的总和。具体来说，对角元 $A_{aa}$ 是相应缀饰能隙和对角有效相互作用之和，而非对角元 $A_{ab}$ ($a \\neq b$) 仅由非对角有效相互作用项组成。\n\n矩阵元的构造如下：\n$A_{ab} = (\\tilde{\\epsilon}_a - \\tilde{\\epsilon}_i) \\delta_{ab} + \\tilde{W}_{ai}^{bi}$，其中 $\\delta_{ab}$ 是克罗内克 δ。\n\n我们来计算矩阵 $A$ 的四个元素：\n1.  对角元 $A_{p_1, p_1}$：\n    $$A_{p_1, p_1} = (\\tilde{\\epsilon}_{p_1} - \\tilde{\\epsilon}_i) + \\tilde{W}_{p_1 i}^{p_1 i} = 6.2 + (-0.3) = 5.9$$\n\n2.  对角元 $A_{p_2, p_2}$：\n    $$A_{p_2, p_2} = (\\tilde{\\epsilon}_{p_2} - \\tilde{\\epsilon}_i) + \\tilde{W}_{p_2 i}^{p_2 i} = 8.5 + (-0.2) = 8.3$$\n\n3.  非对角元 $A_{p_1, p_2}$：\n    $$A_{p_1, p_2} = \\tilde{W}_{p_1 i}^{p_2 i} = 0.4$$\n\n4.  非对角元 $A_{p_2, p_1}$：\n    $$A_{p_2, p_1} = \\tilde{W}_{p_2 i}^{p_1 i} = 0.4$$\n\n得到的 $2 \\times 2$ 单-单激发矩阵为：\n$$\nA = \\begin{pmatrix} 5.9 & 0.4 \\\\ 0.4 & 8.3 \\end{pmatrix}\n$$\n该矩阵的本征值 $\\omega$ 是特征方程 $\\det(A - \\omega I) = 0$ 的解，其中 $I$ 是 $2 \\times 2$ 单位矩阵。\n$$\n\\det \\begin{pmatrix} 5.9 - \\omega & 0.4 \\\\ 0.4 & 8.3 - \\omega \\end{pmatrix} = 0\n$$\n展开行列式得到二次方程：\n$$\n(5.9 - \\omega)(8.3 - \\omega) - (0.4)(0.4) = 0\n$$\n$$\n48.97 - 5.9\\omega - 8.3\\omega + \\omega^2 - 0.16 = 0\n$$\n$$\n\\omega^2 - 14.2\\omega + 48.81 = 0\n$$\n我们使用二次公式 $\\omega = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}$ 求解这个关于 $\\omega$ 的二次方程，其中 $a=1$, $b=-14.2$, $c=48.81$。\n$$\n\\omega = \\frac{-(-14.2) \\pm \\sqrt{(-14.2)^2 - 4(1)(48.81)}}{2(1)}\n$$\n$$\n\\omega = \\frac{14.2 \\pm \\sqrt{201.64 - 195.24}}{2}\n$$\n$$\n\\omega = \\frac{14.2 \\pm \\sqrt{6.4}}{2}\n$$\n现在，我们计算两个本征值的数值，它们代表以 MeV 为单位的激发能。\n$$\n\\sqrt{6.4} \\approx 2.5298221\n$$\n两个本征值是：\n$$\n\\omega_1 = \\frac{14.2 - 2.5298221}{2} = \\frac{11.6701779}{2} \\approx 5.8350889\n$$\n$$\n\\omega_2 = \\frac{14.2 + 2.5298221}{2} = \\frac{16.7298221}{2} \\approx 8.3649111\n$$\n根据要求，将这些值四舍五入到四位有效数字：\n$$\n\\omega_1 \\approx 5.835 \\, \\text{MeV}\n$$\n$$\n\\omega_2 \\approx 8.365 \\, \\text{MeV}\n$$\n这些是从此截断的 EOM-CCSD 计算中获得的近似激发能。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n5.835 & 8.365\n\\end{pmatrix}\n}\n$$", "id": "3558017"}, {"introduction": "EOM-CC之所以成为一种强大的工具，一个关键特性是其激发能的规模强度性（size-intensivity），这确保了局部激发不受系统中遥远且无相互作用部分的影响。这项计算练习要求你设计一个数值实验来验证这一基本性质，从而深入理解该方法的理论鲁棒性和物理正确性 [@problem_id:3557984]。", "problem": "设计并实现一个完整的、可运行的程序，通过比较孤立子系统 $\\,A\\,$ 的激发能 $\\,\\omega\\,$ 与从一个无相互作用的复合体系 $\\,A+B\\,$ 中提取的激发能，来数值上验证运动方程耦合簇单双激发 (EOM-CCSD) 激发能的尺寸密集性。该实验必须使用相似性变换哈密顿量 $\\,\\bar{H} = e^{-T} H e^{T}\\,$ 和一个与无相互作用子系统一致的块对角（直和）复合体系哈密顿量。\n\n从以下基本概念和定义开始：\n- 耦合簇基态由簇算符 $\\,T\\,$ 构建，形式为 $\\,\\lvert \\Psi_0 \\rangle = e^{T} \\lvert \\Phi_0 \\rangle\\,$，其中 $\\,\\lvert \\Phi_0 \\rangle\\,$ 是一个参考态（相对于激发的真空态）。相似性变换哈密顿量为 $\\,\\bar{H} = e^{-T} H e^{T}\\,$.\n- 正规序相似性变换哈密顿量为 $\\,\\bar{H}_N = \\bar{H} - E_{\\mathrm{CC}}\\mathbb{1}\\,$, 其中 $\\,E_{\\mathrm{CC}} = \\langle \\Phi_0 \\lvert \\bar{H} \\rvert \\Phi_0 \\rangle\\,$ 是耦合簇基态能量。\n- 针对粒子数守恒激发的运动方程 (EOM) 本征问题是 $\\,\\bar{H}_N R \\lvert \\Phi_0 \\rangle = \\omega \\, R \\lvert \\Phi_0 \\rangle\\,$，并投影到选定的激发流形中。本征值 $\\,\\omega\\,$ 是激发能。对于具有块对角哈密顿量的无相互作用子系统 $\\,A\\,$ 和 $\\,B\\,$，尺寸密集性意味着一个局域在 $\\,A\\,$ 上的激发，无论是为单独的 $\\,A\\,$ 计算还是为复合体系 $\\,A+B\\,$ 计算，都具有相同的 $\\,\\omega\\,$.\n\n需要实现的模型和数值方案：\n1. 每个子系统 $\\,X \\in \\{A,B\\}\\,$ 是一个二能级多体模型，其基为 $\\,\\{\\lvert \\Phi_X \\rangle,\\lvert D_X \\rangle\\}\\,$，其中 $\\,\\lvert \\Phi_X \\rangle\\,$ 是参考行列式，而 $\\,\\lvert D_X \\rangle\\,$ 代表一个类 $\\,2p\\text{-}2h\\,$ 的激发组态。$\\,X\\,$ 的哈密顿量是 $\\,2\\times 2\\,$ 矩阵\n   $$ H_X = \\begin{pmatrix} E_X^{(0)}  V_X \\\\ V_X  E_X^{(d)} \\end{pmatrix}, $$\n   其参数 $\\,E_X^{(0)}\\,$, $\\,E_X^{(d)}\\,$, 和 $\\,V_X\\,$ 的单位是兆电子伏 (MeV)。\n2. 复合无相互作用哈密顿量是\n   $$ H_{A+B} = H_A \\otimes \\mathbb{1}_B + \\mathbb{1}_A \\otimes H_B, $$\n   作用在张量积基 $\\,\\{\\lvert \\Phi_A \\rangle,\\lvert D_A \\rangle\\} \\otimes \\{\\lvert \\Phi_B \\rangle,\\lvert D_B \\rangle\\}$ 上。\n3. 对于每个 $\\,X \\in \\{A,B\\}\\,$，构建一个仅在 $\\,X\\,$ 内部进行激发的单双激发簇算符：\n   $$ T_X = t_X \\,\\lvert D_X \\rangle \\langle \\Phi_X \\rvert, $$\n   使得 $\\,T_X^2 = 0\\,$ 且 $\\,e^{T_X} = \\mathbb{1}_X + T_X\\,$. 通过强制施加耦合簇基态条件 $\\,e^{T_X} \\lvert \\Phi_X \\rangle \\propto \\lvert \\Psi_{0,X} \\rangle\\,$ 来确定 $\\,t_X\\,$，其中 $\\,\\lvert \\Psi_{0,X} \\rangle\\,$ 是 $\\,H_X\\,$ 的归一化基态本征矢量。对于复合体系，使用\n   $$ T_{A+B} = T_A \\otimes \\mathbb{1}_B + \\mathbb{1}_A \\otimes T_B, $$\n   其满足 $\\,T_{A+B}^3 = 0\\,$ 和\n   $$ e^{T_{A+B}} = \\mathbb{1} + T_{A+B} + \\tfrac{1}{2} T_{A+B}^2. $$\n4. 构建相似性变换哈密顿量\n   $$ \\bar{H}_A = e^{-T_A} H_A e^{T_A}, \\quad \\bar{H}_{A+B} = e^{-T_{A+B}} H_{A+B} e^{T_{A+B}}, $$\n   以及相应的正规序算符\n   $$ \\bar{H}_{N,A} = \\bar{H}_A - E_{\\mathrm{CC},A}\\,\\mathbb{1}_A, \\quad \\bar{H}_{N,A+B} = \\bar{H}_{A+B} - E_{\\mathrm{CC},A+B}\\,\\mathbb{1}, $$\n   其中 $\\,E_{\\mathrm{CC},A} = \\langle \\Phi_A \\lvert \\bar{H}_A \\rvert \\Phi_A \\rangle\\,$ 且 $\\,E_{\\mathrm{CC},A+B} = \\langle \\Phi_A \\Phi_B \\lvert \\bar{H}_{A+B} \\rvert \\Phi_A \\Phi_B \\rangle\\,$.\n5. 提取局域在 $\\,A\\,$ 上的 EOM 激发能：\n   - 孤立的 $\\,A\\,$：将 $\\,\\bar{H}_{N,A}\\,$ 投影到 $\\,\\lvert D_A \\rangle\\,$ 上，并设 $\\,\\omega_A^{\\text{(iso)}} = \\langle D_A \\lvert \\bar{H}_{N,A} \\rvert D_A \\rangle\\,$.\n   - 复合体系 $\\,A+B\\,$：将 $\\,\\bar{H}_{N,A+B}\\,$ 投影到 $\\,\\lvert D_A \\rangle \\otimes \\lvert \\Phi_B \\rangle\\,$ 上，并设 $\\,\\omega_A^{(A+B)} = \\langle D_A \\Phi_B \\lvert \\bar{H}_{N,A+B} \\rvert D_A \\Phi_B \\rangle\\,$.\n6. 对于下面的每个测试用例，计算绝对差\n   $$ \\Delta \\omega_A = \\left| \\omega_A^{\\text{(iso)}} - \\omega_A^{(A+B)} \\right| \\quad \\text{单位为 MeV}. $$\n\n测试套件 (所有能量和耦合均以 MeV 为单位；以 MeV 为单位，将输出指定为十进制浮点数):\n- 情况 $\\,1\\,$ (一般情况，非平凡耦合):\n  - $\\,A\\,$: $\\,E_A^{(0)} = 0.0\\,$, $\\,E_A^{(d)} = 4.0\\,$, $\\,V_A = 0.5\\,$.\n  - $\\,B\\,$: $\\,E_B^{(0)} = -1.0\\,$, $\\,E_B^{(d)} = 3.5\\,$, $\\,V_B = 0.1\\,$.\n- 情况 $\\,2\\,$ (边界情况：A 中无耦合，B 中强耦合):\n  - $\\,A\\,$: $\\,E_A^{(0)} = 0.0\\,$, $\\,E_A^{(d)} = 4.0\\,$, $\\,V_A = 0.0\\,$.\n  - $\\,B\\,$: $\\,E_B^{(0)} = 2.0\\,$, $\\,E_B^{(d)} = 5.0\\,$, $\\,V_B = 0.8\\,$.\n- 情况 $\\,3\\,$ (A 中近简并，B 中中等耦合):\n  - $\\,A\\,$: $\\,E_A^{(0)} = 0.0\\,$, $\\,E_A^{(d)} = 2.0\\,$, $\\,V_A = 0.7\\,$.\n  - $\\,B\\,$: $\\,E_B^{(0)} = -3.0\\,$, $\\,E_B^{(d)} = 1.0\\,$, $\\,V_B = 0.2\\,$.\n- 情况 $\\,4\\,$ (B 中有大的能量偏移):\n  - $\\,A\\,$: $\\,E_A^{(0)} = 1.0\\,$, $\\,E_A^{(d)} = 6.0\\,$, $\\,V_A = 0.3\\,$.\n  - $\\,B\\,$: $\\,E_B^{(0)} = 10.0\\,$, $\\,E_B^{(d)} = 12.0\\,$, $\\,V_B = 0.4\\,$.\n\n程序要求：\n- 通过强制施加 $\\,e^{T_X} \\lvert \\Phi_X \\rangle\\,$ 等于 $\\,H_X\\,$ 的归一化基态本征矢量这一条件，来实现对 $\\,X \\in \\{A,B\\}\\,$ 的 $\\,T_A\\,$ 和 $\\,T_B\\,$ 的构建。\n- 使用幂零簇算符的精确有限级数来计算 $\\,e^{\\pm T_X}\\,$ 和 $\\,e^{\\pm T_{A+B}}\\,$。\n- 对四个情况中的每一种，计算 $\\,\\Delta \\omega_A\\,$ (以 MeV 为单位)。\n- 最终输出格式：你的程序应产生单行输出，包含用方括号括起来的、以逗号分隔的结果列表，例如 $\\,\\big[\\Delta\\omega_A^{(1)},\\Delta\\omega_A^{(2)},\\Delta\\omega_A^{(3)},\\Delta\\omega_A^{(4)}\\big]\\,$。将每个条目表示为以 MeV 为单位的十进制浮点数，并使用计算的自然精度（输出中不含单位符号）。", "solution": "问题陈述是有效的。它在运动方程耦合簇 (EOM-CC) 理论的框架内提出了一个适定的、具有科学依据的计算任务。所有必要的定义、参数和一个清晰的方案都已提供。该问题是一个极佳的教学示例，用于证明无相互作用子系统的 EOM-CC 激发能的尺寸密集性。\n\n问题的核心是在两种情况下计算子系统 $A$ 的激发能 $\\omega_A$：(1) 对于孤立系统 $A$，以及 (2) 对于一个无相互作用的复合系统 $A+B$。尺寸密集性要求这两个能量是相同的。我们将通过数值方法实现指定的方案来验证此性质。\n\n让我们将子系统 $X \\in \\{A, B\\}$ 的基态表示为矢量：$\\lvert \\Phi_X \\rangle \\equiv \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$ 和 $\\lvert D_X \\rangle \\equiv \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}$。那么子系统 $X$ 的哈密顿量就是 $2 \\times 2$ 矩阵：\n$$\nH_X = \\begin{pmatrix} E_X^{(0)}  V_X \\\\ V_X  E_X^{(d)} \\end{pmatrix}\n$$\n簇算符由 $T_X = t_X \\lvert D_X \\rangle \\langle \\Phi_X \\rvert$ 给出，其矩阵形式为：\n$$\nT_X = \\begin{pmatrix} 0  0 \\\\ t_X  0 \\end{pmatrix}\n$$\n该算符是幂零的，即 $T_X^2 = 0$。因此，簇算符的指数级数精确地截断为：$e^{T_X} = \\mathbb{1}_X + T_X$。\n\n一个关键步骤是确定簇振幅 $t_X$。问题指定 $e^{T_X} \\lvert \\Phi_X \\rangle$ 应与 $H_X$ 的真实基态本征矢量（我们将其记为 $\\lvert \\Psi_{0,X} \\rangle$）成正比。\n首先，我们将算符 $e^{T_X}$ 作用于参考态：\n$$\ne^{T_X} \\lvert \\Phi_X \\rangle = (\\mathbb{1}_X + T_X) \\lvert \\Phi_X \\rangle = \\lvert \\Phi_X \\rangle + t_X \\lvert D_X \\rangle \\equiv \\begin{pmatrix} 1 \\\\ t_X \\end{pmatrix}\n$$\n接下来，我们通过数值对角化找到 $H_X$ 的基态本征矢量。设这个归一化的本征矢量为 $\\lvert \\Psi_{0,X} \\rangle = c_0 \\lvert \\Phi_X \\rangle + c_d \\lvert D_X \\rangle \\equiv \\begin{pmatrix} c_0 \\\\ c_d \\end{pmatrix}$。正比条件意味着 $\\begin{pmatrix} 1 \\\\ t_X \\end{pmatrix} \\propto \\begin{pmatrix} c_0 \\\\ c_d \\end{pmatrix}$。由此，我们推断出振幅 $t_X$ 是本征矢量分量的比值：\n$$\nt_X = \\frac{c_d}{c_0}\n$$\n这为计算任何给定子系统哈密顿量 $H_X$ 的 $t_X$ 提供了一种直接方法。对于 $V_X=0$ 的情况需要特别注意，此时 $H_X$ 是对角的。如果 $E_X^{(0)} < E_X^{(d)}$，基态是 $\\lvert \\Phi_X \\rangle$，因此 $c_d=0$ 且 $t_X=0$。\n\n在确定了 $t_X$ 后，我们可以计算孤立系统 $A$ 的各个量。\n1.  构建相似性变换哈密顿量 $\\bar{H}_A = e^{-T_A} H_A e^{T_A}$，其中 $e^{-T_A} = \\mathbb{1}_A - T_A$。\n2.  计算耦合簇基态能量 $E_{\\mathrm{CC},A} = \\langle \\Phi_A \\lvert \\bar{H}_A \\rvert \\Phi_A \\rangle$，即矩阵 $\\bar{H}_A$ 的左上角 $(0,0)$ 元素。\n3.  构建正规序哈密顿量 $\\bar{H}_{N,A} = \\bar{H}_A - E_{\\mathrm{CC},A}\\mathbb{1}_A$。\n4.  激发能则由 $\\omega_A^{\\text{(iso)}} = \\langle D_A \\lvert \\bar{H}_{N,A} \\rvert D_A \\rangle$ 给出，即矩阵 $\\bar{H}_{N,A}$ 的右下角 $(1,1)$ 元素。这是一个正确的简化，因为 $\\bar{H}_{N,A}$ 的矩阵在 $\\{\\lvert\\Phi_A\\rangle, \\lvert D_A \\rangle\\}$ 基下是上三角的，所以其本征值就是其对角元素。\n\n接下来，我们分析复合系统 $A+B$。其希尔伯特空间是各个空间的张量积，所以基是 $\\{\\lvert\\Phi_A\\Phi_B\\rangle, \\lvert\\Phi_A D_B\\rangle, \\lvert D_A\\Phi_B\\rangle, \\lvert D_A D_B\\rangle\\}$。无相互作用子系统的复合哈密顿量是 $H_{A+B} = H_A \\otimes \\mathbb{1}_B + \\mathbb{1}_A \\otimes H_B$，一个 $4 \\times 4$ 矩阵。\n\n复合簇算符是 $T_{A+B} = T_A \\otimes \\mathbb{1}_B + \\mathbb{1}_A \\otimes T_B$。分量算符对易，$[T_A \\otimes \\mathbb{1}_B, \\mathbb{1}_A \\otimes T_B] = 0$，这使得指数可以因式分解：$e^{T_{A+B}} = (e^{T_A} \\otimes \\mathbb{1}_B) (\\mathbb{1}_A \\otimes e^{T_B}) = e^{T_A} \\otimes e^{T_B}$。这个性质是关键。\n由此还可得出 $T_{A+B}^2 = 2 (T_A \\otimes T_B)$ 和 $T_{A+B}^3 = 0$。因此，问题中给出的级数展开 $e^{T_{A+B}} = \\mathbb{1} + T_{A+B} + \\frac{1}{2} T_{A+B}^2$ 是精确且一致的。\n\n复合哈密顿量的相似性变换大大简化：\n$$\n\\bar{H}_{A+B} = e^{-T_{A+B}} H_{A+B} e^{T_{A+B}} = (e^{-T_A}\\otimes e^{-T_B}) (H_A \\otimes \\mathbb{1}_B + \\mathbb{1}_A \\otimes H_B) (e^{T_A}\\otimes e^{T_B})\n$$\n$$\n\\bar{H}_{A+B} = (e^{-T_A} H_A e^{T_A}) \\otimes (e^{-T_B} \\mathbb{1}_B e^{T_B}) + (e^{-T_A} \\mathbb{1}_A e^{T_A}) \\otimes (e^{-T_B} H_B e^{T_B})\n$$\n$$\n\\bar{H}_{A+B} = \\bar{H}_A \\otimes \\mathbb{1}_B + \\mathbb{1}_A \\otimes \\bar{H}_B\n$$\n这个优美的结果表明，相似性变换哈密顿量对于无相互作用的子系统保留了加和结构。\n\n遵循系统 $A+B$ 的方案：\n1.  使用从各自孤立系统找到的振幅 $t_A$ 和 $t_B$ 来构建 $\\bar{H}_{A+B}$。\n2.  计算复合 CC 能量 $E_{\\mathrm{CC},A+B} = \\langle \\Phi_A \\Phi_B \\lvert \\bar{H}_{A+B} \\rvert \\Phi_A \\Phi_B \\rangle$。利用 $\\bar{H}_{A+B}$ 的加和结构，这简化为 $E_{\\mathrm{CC},A+B} = \\langle\\Phi_A|\\bar{H}_A|\\Phi_A\\rangle + \\langle\\Phi_B|\\bar{H}_B|\\Phi_B\\rangle = E_{\\mathrm{CC},A} + E_{\\mathrm{CC},B}$。这证实了 CC 基态能量的尺寸广延性。\n3.  构建正规序哈密顿量 $\\bar{H}_{N,A+B} = \\bar{H}_{A+B} - E_{\\mathrm{CC},A+B} \\mathbb{1}$。\n4.  局域在 $A$ 上的激发能是 $\\omega_A^{(A+B)} = \\langle D_A \\Phi_B \\lvert \\bar{H}_{N,A+B} \\rvert D_A \\Phi_B \\rangle$。让我们展开它：\n$$\n\\omega_A^{(A+B)} = \\langle D_A \\Phi_B \\lvert (\\bar{H}_A \\otimes \\mathbb{1}_B + \\mathbb{1}_A \\otimes \\bar{H}_B) - (E_{\\mathrm{CC},A} + E_{\\mathrm{CC},B})\\mathbb{1} \\rvert D_A \\Phi_B \\rangle\n$$\n$$\n\\omega_A^{(A+B)} = \\langle D_A|\\bar{H}_A|D_A\\rangle\\langle\\Phi_B|\\mathbb{1}_B|\\Phi_B\\rangle + \\langle D_A|\\mathbb{1}_A|D_A\\rangle\\langle\\Phi_B|\\bar{H}_B|\\Phi_B\\rangle - (E_{\\mathrm{CC},A} + E_{\\mathrm{CC},B})\n$$\n$$\n\\omega_A^{(A+B)} = \\langle D_A|\\bar{H}_A|D_A\\rangle + E_{\\mathrm{CC},B} - E_{\\mathrm{CC},A} - E_{\\mathrm{CC},B} = \\langle D_A|\\bar{H}_A|D_A\\rangle - E_{\\mathrm{CC},A}\n$$\n这与 $\\omega_A^{\\text{(iso)}}$ 的表达式相同。因此，我们预期对于所有情况 $\\Delta \\omega_A = \\left| \\omega_A^{\\text{(iso)}} - \\omega_A^{(A+B)} \\right| = 0$。数值实现将验证这一理论结果。我们将实现完整的数值方案，而不走解析捷径。", "answer": "$[0.0, 0.0, 0.0, 0.0]$", "id": "3557984"}, {"introduction": "EOM-CC理论在本质上是非厄米的，这导致了不同的左右本征矢量和有趣的物理后果。这个高级练习探讨了Petermann因子 $K_i$ 的概念，它是一种衡量双正交性的指标，并要求你数值研究它与物理可观测量在临近本征态合并点时灵敏度增强的联系 [@problem_id:3558048]。这对于理解非厄米量子系统中潜在的数值不稳定性和独特现象至关重要。", "problem": "给定一个源于计算核物理中运动方程耦合簇 (EOM-CC) 方法的非厄米本征值问题。在 EOM-CC 中，相似变换后的哈密顿量定义为 $\\bar{H} = e^{-T} H e^{T}$，其中 $T$ 是来自耦合簇 (CC) 理论的簇算符，$H$ 是核多体哈密顿量。相似变换算符 $\\bar{H}$ 是非厄米的，因此其右本征矢和左本征矢（分别记为 $R_i$ 和 $L_i$）满足不同的本征方程：\n$$\n\\bar{H} R_i = \\omega_i R_i, \\quad L_i^{\\top} \\bar{H} = \\omega_i L_i^{\\top}.\n$$\n对于给定态 $i$，当 $L_i$ 和 $R_i$ 被独立地归一化为单位范数时，Petermann 因子定义为 $K_i = (L_i^{\\top} R_i)^{-1}$。在非厄米系统中，$K_i$ 的较大值表示强的双正交性，并且已知这与可观测量的灵敏度增强以及在近简并（近乎亏损）的本征态附近的数值不稳定性相关。考虑一个 $2 \\times 2$ 实矩阵族，该矩阵族模拟了一个约化空间中的相似变换哈密顿量，\n$$\n\\bar{H}(\\delta) = \\begin{pmatrix} \\lambda  g \\\\ \\delta  \\lambda \\end{pmatrix},\n$$\n其中 $\\lambda$、$g$ 和 $\\delta$ 是实数参数。对于所有测试用例，取 $\\lambda = 0$ 和 $g = 1$。定义一个固定的跃迁算符\n$$\nO = \\begin{pmatrix} 0  1 \\\\ \\alpha  0 \\end{pmatrix},\n$$\n其中 $\\alpha = 0.3$。对每个测试用例，执行以下步骤：\n- 计算 $\\bar{H}(\\delta)$ 的右本征对 $(\\omega_i, R_i)$。\n- 从 $\\bar{H}(\\delta)^{\\top}$ 计算左本征对 $(\\omega_i, L_i)$，并通过最小本征值绝对差将每个左本征矢 $L_i$ 与具有最接近本征值 $\\omega_i$ 的右本征矢 $R_i$ 进行匹配。\n- 将所有 $R_i$ 和 $L_i$ 归一化为单位向量范数。\n- 计算所有态 $i$ 的 Petermann 因子 $K_i = (L_i^{\\top} R_i)^{-1}$，并通过取 $\\max_i |K_i|$ 来汇总结果。\n- 定义较低和较高本征态之间的未受扰跃迁强度为\n$$\nS = \\big| L_{j}^{\\top} O R_{i} \\big|^2,\n$$\n其中 $i$ 索引较低本征值的态，$j$ 索引较高本征值的态。\n- 对哈密顿量参数施加一个大小为 $\\epsilon$ 的小微扰，得到\n$$\n\\bar{H}'(\\delta, \\epsilon) = \\begin{pmatrix} \\lambda  g - \\epsilon \\\\ \\delta + \\epsilon  \\lambda \\end{pmatrix},\n$$\n重新计算左、右本征矢和受扰后的跃迁强度 $S'$。计算相对变化\n$$\nr = \\frac{|S' - S|}{\\max(S, 10^{-16})},\n$$\n使用一个小的正则化子 $10^{-16}$ 来避免除以零。\n\n你的程序必须为每个测试用例计算数对 $[\\max_i |K_i|, r]$，并将所有测试用例的结果汇总到单行输出中，形式为逗号分隔的 Python 风格列表的列表。不要使用任何物理单位，因为所有量都是无量纲的。不出现角度。所有输出都必须是实值浮点数。\n\n测试套件：\n- 情况 1 (正常路径，中等非厄米性): $\\delta = 0.5$, $\\epsilon = 10^{-6}$。\n- 情况 2 (近简并本征值，强非厄米性): $\\delta = 10^{-12}$, $\\epsilon = 10^{-6}$。\n- 情况 3 (厄米边缘情况): $\\delta = 1.0$, $\\epsilon = 10^{-6}$。\n\n最终输出格式：\n你的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果。每个测试用例贡献一个列表 $[\\max_i |K_i|, r]$，因此最终输出必须如下所示：\n$$\n[[k_1, r_1],[k_2, r_2],[k_3, r_3]]\n$$\n其中每个 $k_n$ 和 $r_n$ 都是浮点数。", "solution": "用户希望解决一个来自计算核物理领域、与运动方程耦合簇方法相关的问题。\n\n### 方法\n\n我将编写一个 Python 程序来为三个测试用例中的每一个执行所需的计算。程序的核心将是一个函数，它接受参数 $\\delta$ 和 $\\epsilon$ 并执行以下操作序列：\n\n1.  **定义系统矩阵**：对于给定的测试用例 $(\\delta, \\epsilon)$，构建未受扰的哈密顿量 $\\bar{H}(\\delta)$ 和跃迁算符 $O$。\n    $$\n    \\bar{H}(\\delta) = \\begin{pmatrix} 0 & 1 \\\\ \\delta & 0 \\end{pmatrix}, \\quad O = \\begin{pmatrix} 0 & 1 \\\\ 0.3 & 0 \\end{pmatrix}\n    $$\n\n2.  **求解未受扰本征问题**：\n    -   通过求解 $\\bar{H} R_i = \\omega_i R_i$ 来计算 $\\bar{H}$ 的本征值 $\\omega_i$ 和右本征矢 $R_i$。这将使用 `numpy.linalg.eig` 完成。\n    -   通过求解转置哈密顿量的本征问题 $\\bar{H}^{\\top} L_i = \\omega_i L_i$ 来计算左本征矢 $L_i$。\n    -   $\\bar{H}$ 和 $\\bar{H}^{\\top}$ 的本征值是相同的。为确保正确的配对 $(R_i, L_i)$，两组本征对都将按其实部本征值的升序排序。对于给定的问题，本征值将是 $\\omega_1 = -\\sqrt{\\delta}$ 和 $\\omega_2 = \\sqrt{\\delta}$。\n\n3.  **归一化并计算 Petermann 因子**：\n    -   将每个本征矢 ($R_i, L_i$) 归一化，使其欧几里得范数为 $1$。\n    -   计算每个本征态 $i=1, 2$ 的 Petermann 因子 $K_i = (L_i^{\\top} R_i)^{-1}$。\n    -   确定结果第一部分的最终值 $\\max_i |K_i|$。对于这个特定问题，可以解析地证明 $|K_1| = |K_2| = \\frac{1+\\delta}{2\\sqrt{\\delta}}$。\n\n4.  **计算未受扰的跃迁强度**：\n    -   跃迁强度 $S$ 定义为 $S = |L_j^{\\top} O R_i|^2$，其中 $i$ 对应于具有较低本征值 ($\\omega_1 = -\\sqrt{\\delta}$) 的态，$j$ 对应于具有较高本征值 ($\\omega_2 = \\sqrt{\\delta}$) 的态。\n    -   排序后，较低的态将具有索引 $0$，较高的态将具有索引 $1$。计算将是 $S = |L_1^{\\top} O R_0|^2$。\n\n5.  **分析受扰系统**：\n    -   构建受扰的哈密顿量 $\\bar{H}'(\\delta, \\epsilon)$：\n        $$\n        \\bar{H}'(\\delta, \\epsilon) = \\begin{pmatrix} 0 & 1 - \\epsilon \\\\ \\delta + \\epsilon & 0 \\end{pmatrix}\n        $$\n    -   对 $\\bar{H}'$ 重复步骤 2 和 4，以找到其排序、归一化后的左、右本征矢 ($L'_i, R'_i$)，并计算受扰后的跃迁强度 $S' = |(L'_1)^{\\top} O R'_0|^2$。\n\n6.  **计算相对变化**：\n    -   使用提供的公式计算跃迁强度的相对变化 $r$，该公式包含一个正则化子以防止除以零：\n        $$\n        r = \\frac{|S' - S|}{\\max(S, 10^{-16})}\n        $$\n\n7.  **汇总结果**：\n    -   对于每个测试用例 $(\\delta, \\epsilon)$，计算并存储数对 $[\\max_i |K_i|, r]$。\n    -   最终输出将是一行包含这些数对的 Python 风格列表，格式为 `[[k_1, r_1],[k_2, r_2],[k_3, r_3]]`。\n\n实现将使用 `numpy` 进行所有线性代数运算，以确保数值稳定性和正确性。", "answer": "$$\n[[1.0606601717798212, 1.7333119159040333e-05], [500000.00000025, 4.333333187213346], [1.0, 6.500000021689366e-07]]\n$$", "id": "3558048"}]}