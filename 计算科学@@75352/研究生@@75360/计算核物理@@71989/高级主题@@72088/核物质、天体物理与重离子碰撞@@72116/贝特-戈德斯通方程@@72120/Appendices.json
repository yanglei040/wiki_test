{"hands_on_practices": [{"introduction": "贝特-戈德斯通方程本质上是一个积分方程，直接求解通常很困难。在计算核物理中，一个核心任务是将其转化为可通过数值方法求解的离散形式。本练习将指导您完成这一基本过程：将连续的积分方程近似为一个离散的矩阵线性系统 [@problem_id:3545576]。通过采用一种秩为1的可分离势（山口势），您不仅能够实践数值求解，还能将结果与一个精确的解析解进行比较，这是验证代码正确性的关键一步，从而为更复杂的计算打下坚实的基础。", "problem": "要求您实现一个完全独立的程序，为零总对动量的对称核物质构建介质中相互作用（介质中$G$矩阵）的Bethe-Goldstone方程的离散化矩阵表示。您的任务是从计算核物理的基本原理出发，推导由求积近似产生的离散线性系统，然后对其进行数值实现和评估。您必须使用一个物理上合理的单粒子谱和一个简单但非平凡的可分相互作用，以进行内部自洽性检验。所有动量必须以 $\\mathrm{fm}^{-1}$ 为单位，所有能量以 $\\mathrm{MeV}$ 为单位，所有角度以弧度为单位。\n\n从Brueckner-Hartree-Fock (BHF) 理论的标准物理起点开始：介质中二体反应矩阵 $G$ 的Bethe-Goldstone方程。在$S$波、零总动量近似下，该方程可写为关于相对动量 $k$ 的一维积分方程。采用分波的常规归一化，其中三维积分变为一个因子乘以一个在 $q \\in [0,\\Lambda]$ 上对 $q^{2}\\,\\mathrm{d}q$ 的积分，其中 $\\Lambda$ 是一个有限动量截断。中间态泡利算符必须取角平均值，并且在零总动量下简化为一个阶跃函数 $Q(q,k_{F})=\\Theta(q-k_{F})$，其中 $k_{F}$ 是费米动量。单粒子能量必须取为自由动能谱 $\\epsilon(q)=\\frac{\\hbar^{2}}{2m_{N}}\\,q^{2}$，其中 $\\frac{\\hbar^{2}}{2m_{N}}=20.735\\,\\mathrm{MeV}\\cdot\\mathrm{fm}^{2}$。起始能量是一个形式为 $\\omega + i\\,\\eta$ 的复数量，其中 $\\omega$ 是实数，$\\eta$ 是一个小的正正则化子（单位为 $\\mathrm{MeV}$），它实现了因果性规定并对能量分母进行正则化。\n\n在动量空间中使用秩为1的可分山口势，\n$$\nV(k,k')=-\\lambda\\,g(k)\\,g(k')\\,,\\qquad g(k)=\\frac{1}{k^{2}+\\beta^{2}}\\,,\n$$\n其中 $\\lambda>0$ 且力程参数 $\\beta>0$。在$S$波和零质心动量下，介质中的Bethe-Goldstone方程对每一对 $(k,k')$ 都成为一个关于 $q$ 的一维积分方程，涉及核 $V(k,q)$、泡利因子 $Q(q,k_{F})$ 和传播子分母 $\\left[\\omega-\\epsilon(q)-\\epsilon(q)\\right]^{-1}=\\left[\\omega-2\\,\\epsilon(q)\\right]^{-1}$。您的代码必须在有限动量区间 $[0,\\Lambda]$ 上使用具有 $N$ 个节点和权重 $\\{(q_{i},w_{i})\\}_{i=1}^{N}$ 的高斯求积法来离散化 $q$ 积分。为了在特定的在壳动量 $k_{0}$ 处评估 $G$ 矩阵，您必须通过将 $k_{0}$ 作为一个求积权重为零的额外配置点来扩充求积网格，这样它不会改变积分值，但能通过同一个线性系统产生 $G(k_{0},k')$。在所有表达式中，显式地保留常规的$S$波因子为\n$$\n\\frac{2}{\\pi}\\int_{0}^{\\Lambda} q^{2}\\,\\mathrm{d}q \\,\\cdots \\, .\n$$\n\n在数值上，您必须处理能量分母\n$$\n\\omega-\\epsilon_{p_{1}}-\\epsilon_{p_{2}}=\\omega-2\\,\\epsilon(q)=\\omega - 2 \\times 20.735\\,q^{2}\\,,\n$$\n通过添加小的虚部正则化子，使分母变为 $\\omega-2\\,\\epsilon(q)+i\\,\\eta$，其中 $\\eta \\ge 0$。泡利算符 $Q(q,k_{F})$ 必须实现为一个尖锐的阶跃函数：如果 $q>k_{F}$ 则 $Q(q,k_{F})=1$，否则 $Q(q,k_{F})=0$。您必须将离散化方程表述为在组合网格 $\\{k_{0}\\}\\cup\\{q_{i}\\}_{i=1}^{N}$ 上的一个线性代数问题，并求解在这些网格点上的完整矩阵 $G(k_{a},k_{b};\\omega)$。然后提取在壳元 $G(k_{0},k_{0};\\omega)$。\n\n为了验证正确性并评估能量分母的数值处理，请并行计算秩为1可分势存在的闭式解。这需要将Bethe-Goldstone方程简化为关于一个强度参数的标量方程，然后重构在壳$G$矩阵元。在标量方程中使用相同的求积规则和泡利算符，这样差异将仅反映您的离散化和线性代数的一致性。\n\n测试套件和参数。对于以下每种情况，输入参数为 $(k_{F},k_{0},\\Lambda,N,\\beta,\\lambda,\\omega,\\eta)$，单位如前所述。请严格按此顺序使用这四种情况：\n- 情况 A (自由空间，在壳): $k_{F}=0.0\\,\\mathrm{fm}^{-1}$，$k_{0}=1.0\\,\\mathrm{fm}^{-1}$，$\\Lambda=8.0\\,\\mathrm{fm}^{-1}$，$N=120$，$\\beta=1.4\\,\\mathrm{fm}^{-1}$，$\\lambda=200.0\\,\\mathrm{MeV}\\cdot\\mathrm{fm}^{3}$，$\\omega=2\\times 20.735\\times k_{0}^{2}\\,\\mathrm{MeV}$，$\\eta=1.0\\,\\mathrm{MeV}$。\n- 情况 B (正常密度，在壳，$k_{F}$之上): $k_{F}=1.3\\,\\mathrm{fm}^{-1}$，$k_{0}=1.6\\,\\mathrm{fm}^{-1}$，$\\Lambda=8.0\\,\\mathrm{fm}^{-1}$，$N=120$，$\\beta=1.4\\,\\mathrm{fm}^{-1}$，$\\lambda=200.0\\,\\mathrm{MeV}\\cdot\\mathrm{fm}^{3}$，$\\omega=2\\times 20.735\\times k_{0}^{2}\\,\\mathrm{MeV}$，$\\eta=1.0\\,\\mathrm{MeV}$。\n- 情况 C (费米面附近，在壳，略高于$k_{F}$): $k_{F}=1.3\\,\\mathrm{fm}^{-1}$，$k_{0}=1.31\\,\\mathrm{fm}^{-1}$，$\\Lambda=8.0\\,\\mathrm{fm}^{-1}$，$N=120$，$\\beta=1.4\\,\\mathrm{fm}^{-1}$，$\\lambda=200.0\\,\\mathrm{MeV}\\cdot\\mathrm{fm}^{3}$，$\\omega=2\\times 20.735\\times k_{0}^{2}\\,\\mathrm{MeV}$，$\\eta=0.5\\,\\mathrm{MeV}$。\n- 情况 D (离壳，阈下，自由空间): $k_{F}=0.0\\,\\mathrm{fm}^{-1}$，$k_{0}=0.5\\,\\mathrm{fm}^{-1}$，$\\Lambda=8.0\\,\\mathrm{fm}^{-1}$，$N=120$，$\\beta=1.4\\,\\mathrm{fm}^{-1}$，$\\lambda=200.0\\,\\mathrm{MeV}\\cdot\\mathrm{fm}^{3}$，$\\omega=-20.0\\,\\mathrm{MeV}$，$\\eta=0.0\\,\\mathrm{MeV}$。\n\n对于每种情况，您的程序必须执行以下操作：\n- 在以 $k_{0}$ 作为零求积权重的额外配置点的组合网格上，构建离散化矩阵方程并求解完整的 $G$ 矩阵。\n- 提取在壳元 $G(k_{0},k_{0};\\omega)$。\n- 使用相同的求积和泡利算符，独立计算通过闭式可分简化得到的相应在壳元。\n- 返回两个复数的实部和虚部之间的绝对差异，即 $|\\Re G_{\\mathrm{matrix}}-\\Re G_{\\mathrm{sep}}|$ 和 $|\\Im G_{\\mathrm{matrix}}-\\Im G_{\\mathrm{sep}}|$，以 $\\mathrm{MeV}\\cdot\\mathrm{fm}^{3}$ 为单位表示。\n\n最终输出格式。您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，结果按以下顺序排列\n$\\big[$情况 A 实部差异, 情况 A 虚部差异, 情况 B 实部差异, 情况 B 虚部差异, 情况 C 实部差异, 情况 C 虚部差异, 情况 D 实部差异, 情况 D 虚部差异$\\big]$。", "solution": "用户要求在核物质的Brueckner-Hartree-Fock理论背景下，对Bethe-Goldstone方程进行数值求解和验证。该问题被验证为具有科学依据、提法恰当且内部一致。它代表了计算核物理中一个标准的、尽管是简化了的问题。\n\n### 1. 问题表述\n\n起点是Bethe-Goldstone方程，它描述了在总动量为零的对称核物质中相互作用的两个核子的介质中反应矩阵 $G$。在$S$波通道中，这是一个一维积分方程：\n$$\nG(k, k'; \\omega) = V(k, k') + \\frac{2}{\\pi} \\int_{0}^{\\Lambda} q^2 dq \\, V(k, q) \\frac{Q(q, k_F)}{\\omega + i\\eta - 2\\epsilon(q)} G(q, k'; \\omega)\n$$\n其中：\n- $k$ 和 $k'$ 是初始和最终的相对动量。\n- $V(k, k')$ 是$S$波通道中的核子-核子相互作用。\n- 积分是对中间相对动量 $q$ 进行的，上限为截断值 $\\Lambda$。因子 $\\frac{2}{\\pi}$ 是一个指定的归一化约定。\n- $Q(q, k_F) = \\Theta(q - k_F)$ 是角平均的泡利不相容原理算符，它将中间态限制在费米动量 $k_F$ 之上。当 $q > k_F$ 时为1，否则为0。\n- $\\epsilon(q) = \\frac{\\hbar^2 q^2}{2m_N}$ 是质量为 $m_N$ 的自由核子的单粒子能量。常数给定为 $\\frac{\\hbar^2}{2m_N} = 20.735\\,\\mathrm{MeV}\\cdot\\mathrm{fm}^2$。\n- $\\omega + i\\eta$ 是复起始能量，其中 $\\omega$ 是实能量，$\\eta > 0$ 是一个小的正正则化子，确保正确的因果边界条件并防止能量分母出现奇点。\n\n相互作用是秩为1的可分山口势：\n$$\nV(k, k') = -\\lambda g(k) g(k') \\quad \\text{with} \\quad g(k) = \\frac{1}{k^2 + \\beta^2}\n$$\n其中 $\\lambda$ 是强度，$\\beta$ 与相互作用的力程有关。\n\n### 2. 数值离散化与矩阵表述\n\n为了数值求解该积分方程，我们使用一个 $N$ 点高斯求积法则对 $q \\in [0, \\Lambda]$ 上的积分进行离散化。设求积节点为 $\\{q_i\\}_{i=1}^N$，对应的权重为 $\\{w_i\\}_{i=1}^N$。积分近似为：\n$$\n\\int_{0}^{\\Lambda} f(q) dq \\approx \\sum_{i=1}^{N} w_i f(q_i)\n$$\n问题要求我们在一个特定动量 $k_0$ 处评估 $G$ 矩阵。我们将求积节点集用 $k_0$ 扩充，形成一个组合的配置点网格 $P = \\{p_a\\}_{a=0}^N$，其中 $p_0 = k_0$，对于 $a=1, \\dots, N$，有 $p_a = q_a$。点 $k_0$ 被赋予零求积权重。\n\n离散化的Bethe-Goldstone方程变成了一个关于网格点上 $G$ 矩阵值 $G_{ab} = G(p_a, p_b)$ 的线性方程组：\n$$\nG(p_a, p_b) = V(p_a, p_b) + \\frac{2}{\\pi} \\sum_{i=1}^{N} w_i q_i^2 V(p_a, q_i) \\frac{Q(q_i, k_F)}{\\omega + i\\eta - 2\\epsilon(q_i)} G(q_i, p_b)\n$$\n认识到 $q_i=p_i$ 且 $G(q_i, p_b)=G_{ib}$，我们可以将其写成矩阵方程。我们定义一个大小为 $(N+1) \\times (N+1)$ 的矩阵 $\\mathbf{C}$：\n$$\nC_{ai} = \n\\begin{cases}\n    \\frac{2}{\\pi} w_i q_i^2 V(p_a, q_i) \\frac{Q(q_i, k_F)}{\\omega + i\\eta - 2\\epsilon(q_i)}  \\text{for } i \\in \\{1, \\dots, N\\} \\\\\n    0  \\text{for } i = 0\n\\end{cases}\n$$\n矩阵 $\\mathbf{G}$ (元素为 $G_{ab}$) 关于矩阵 $\\mathbf{V}$ (元素为 $V_{ab}$) 的方程为：\n$$\n\\mathbf{G} = \\mathbf{V} + \\mathbf{C} \\mathbf{G} \\implies (\\mathbf{I} - \\mathbf{C})\\mathbf{G} = \\mathbf{V}\n$$\n其中 $\\mathbf{I}$ 是单位矩阵。形式解为 $\\mathbf{G} = (\\mathbf{I} - \\mathbf{C})^{-1} \\mathbf{V}$。\n\n由于势是可分的，$\\mathbf{V}$ 是一个秩为1的矩阵：$V_{ab} = -\\lambda g(p_a) g(p_b)$，可以写成 $\\mathbf{V} = -\\lambda \\vec{g} \\vec{g}^T$，其中 $\\vec{g}$ 是一个列向量，其元素为 $g_a = g(p_a)$。\n那么 $\\mathbf{G}$ 的解为 $\\mathbf{G} = -\\lambda (\\mathbf{I} - \\mathbf{C})^{-1} (\\vec{g} \\vec{g}^T)$。\n为了找到所需的元素 $G_{00} = G(k_0, k_0)$，我们可以求解线性系统 $(\\mathbf{I} - \\mathbf{C})\\vec{y} = \\vec{g}$ 来得到向量 $\\vec{y}$。解向量为 $\\vec{y} = (\\mathbf{I} - \\mathbf{C})^{-1}\\vec{g}$，完整的 $G$ 矩阵则为 $\\mathbf{G} = -\\lambda \\vec{y} \\vec{g}^T$。\n我们需要的特定元素是 $G_{00} = -\\lambda y_0 g_0$，其中 $y_0$ 是 $\\vec{y}$ 的第一个分量，$g_0 = g(p_0) = g(k_0)$。这种方法避免了构造完整的逆矩阵，计算效率更高。\n\n### 3. 闭式可分简化\n\n秩为1可分势的一个关键特征是积分方程可以解析求解，将其简化为一个标量代数方程。我们将 $V(k, k') = -\\lambda g(k) g(k')$ 代入Bethe-Goldstone方程。方程的结构表明 $G(k, k')$ 也必须是可分的，因此我们作出拟设 $G(k, k') = \\tau(\\omega) g(k) g(k')$。代入此式并消去 $g(k)$ 和 $g(k')$ 后，得到一个关于函数 $\\tau(\\omega)$ 的标量方程：\n$$\n\\tau(\\omega) = -\\lambda + \\frac{2}{\\pi} \\int_0^\\Lambda q^2 dq \\, [-\\lambda g(q)] \\frac{Q(q, k_F)}{\\omega' - 2\\epsilon(q)} [\\tau(\\omega) g(q)]\n$$\n$$\n\\tau(\\omega) = -\\lambda - \\lambda \\tau(\\omega) \\left[ \\frac{2}{\\pi} \\int_0^\\Lambda q^2 dq \\frac{g(q)^2 Q(q, k_F)}{\\omega' - 2\\epsilon(q)} \\right]\n$$\n我们定义圈积分 $I(\\omega')$：\n$$\nI(\\omega') = \\frac{2}{\\pi} \\int_0^\\Lambda q^2 dq \\frac{g(q)^2 Q(q, k_F)}{\\omega' - 2\\epsilon(q)}\n$$\n于是 $\\tau(\\omega) = -\\lambda / (1 + \\lambda I(\\omega'))$。因此G矩阵为：\n$$\nG(k, k'; \\omega) = \\frac{-\\lambda g(k) g(k')}{1 + \\lambda I(\\omega')}\n$$\n为了验证，我们使用与矩阵方法中相同的高斯求积规则来计算积分 $I(\\omega')$：\n$$\nI(\\omega') \\approx \\frac{2}{\\pi} \\sum_{i=1}^{N} w_i q_i^2 \\frac{g(q_i)^2 Q(q_i, k_F)}{\\omega' - 2\\epsilon(q_i)}\n$$\n然后，在壳元 $G(k_0, k_0; \\omega)$ 可以直接从此公式计算得出。\n\n### 4. 一致性检验\n\n该问题的设计使得矩阵方法和可分简化方法是通往相同底层解析解的两条不同数值路径。正如在思考过程中分析推导的那样，两种方法都得出了相同的表达式：$G(k_0, k_0) = \\frac{-\\lambda g(k_0)^2}{1+\\lambda I(\\omega')}$。因此，当使用相同的求积方案进行数值实现时，两种方法的结果应该在浮点精度范围内完全相同。所要求的差异 $|\\Re G_{\\mathrm{matrix}}-\\Re G_{\\mathrm{sep}}|$ 和 $|\\Im G_{\\mathrm{matrix}}-\\Im G_{\\mathrm{sep}}|$，是对离散化线性代数问题实现的正确性和一致性的严格检验。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.special import roots_legendre\n\ndef solve():\n    \"\"\"\n    Main driver function to solve the problem for all specified test cases.\n    \"\"\"\n    # Test suite parameters:\n    # (k_F, k_0, Lambda, N, beta, lambda, omega, eta)\n    HBARC2_2M = 20.735  # MeV*fm^2\n\n    test_cases = [\n        # Case A (free-space, on-shell)\n        (0.0, 1.0, 8.0, 120, 1.4, 200.0, 2 * HBARC2_2M * 1.0**2, 1.0),\n        # Case B (normal density, on-shell above k_F)\n        (1.3, 1.6, 8.0, 120, 1.4, 200.0, 2 * HBARC2_2M * 1.6**2, 1.0),\n        # Case C (near Fermi surface, on-shell just above k_F)\n        (1.3, 1.31, 8.0, 120, 1.4, 200.0, 2 * HBARC2_2M * 1.31**2, 0.5),\n        # Case D (off-shell below threshold, free-space)\n        (0.0, 0.5, 8.0, 120, 1.4, 200.0, -20.0, 0.0),\n    ]\n\n    results = []\n    for case_params in test_cases:\n        d_real, d_imag = solve_case(*case_params)\n        results.append(f\"{d_real:.15e}\")\n        results.append(f\"{d_imag:.15e}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\ndef solve_case(kF, k0, Lambda, N, beta, lam, omega, eta):\n    \"\"\"\n    Solves the Bethe-Goldstone equation for a single set of parameters\n    using both the matrix inversion method and the separable reduction,\n    and returns the discrepancies between them.\n    \"\"\"\n    # Physical constant\n    HBARC2_2M = 20.735  # MeV*fm^2\n\n    # 1. Setup Grid and Quadrature\n    # Get N Gauss-Legendre quadrature points (x) and weights (w_prime) for [-1, 1]\n    x_nodes, w_prime = roots_legendre(N)\n    \n    # Map nodes and weights to the integration interval [0, Lambda]\n    q_nodes = Lambda * (x_nodes + 1.0) / 2.0\n    w_nodes = Lambda * w_prime / 2.0\n\n    # The full momentum grid consists of k0 and the quadrature nodes.\n    # p_grid[0] = k0, p_grid[1:] = q_nodes\n    p_grid = np.concatenate(([k0], q_nodes))\n    \n    # 2. Define Physical Quantities\n    def g_form_factor(k_val):\n        return 1.0 / (k_val**2 + beta**2)\n\n    def energy_spectrum(k_val):\n        return HBARC2_2M * k_val**2\n    \n    # Evaluate quantities on the grids\n    epsilon_q = energy_spectrum(q_nodes)\n    g_p = g_form_factor(p_grid)\n    g_q = g_form_factor(q_nodes)\n    \n    # Pauli operator Q(q, kF) = 1 if q > kF, else 0\n    Q_q = (q_nodes > kF).astype(np.float64)\n\n    # Complex starting energy\n    omega_c = complex(omega, eta)\n    \n    # Propagator denominator for all quadrature points\n    propagator_denom = omega_c - 2.0 * epsilon_q\n\n    # 3. Matrix Method for G(k0, k0)\n    # The discretized B-G equation is (I - C)G = V.\n    # For a separable potential, this leads to solving (I - C)y = g_vec,\n    # and then G_00 = -lam * y_0 * g_0.\n\n    # Construct the matrix C of size (N+1) x (N+1)\n    C = np.zeros((N + 1, N + 1), dtype=np.complex128)\n    \n    # Common part of the kernel for all quadrature points\n    kernel_integrand_base = (2.0 / np.pi) * w_nodes * q_nodes**2 * Q_q / propagator_denom\n    \n    # The matrix C's columns for i=1..N are constructed. C's first column (i=0) is zero.\n    for a in range(N + 1):  # Loop over rows of C (momentum p_a)\n        # V(p_a, q_i) = -lam * g(p_a) * g(q_i)\n        # C_{a,i} for i=1..N involves V(p_a, q_{i-1}) in 0-based indexing\n        V_pa_qi = -lam * g_p[a] * g_q\n        C[a, 1:] = kernel_integrand_base * V_pa_qi\n\n    # Form the matrix M = I - C for the linear system M*y = g_vec\n    M = np.identity(N + 1, dtype=np.complex128) - C\n    \n    # The vector g_vec has components g(p_a)\n    g_vec = g_p.astype(np.complex128)\n    \n    # Solve the linear system M*y = g_vec\n    y = np.linalg.solve(M, g_vec)\n    \n    # Calculate G_matrix(k0, k0) which corresponds to G_00\n    G_matrix = -lam * g_p[0] * y[0]\n\n    # 4. Separable Reduction Method for G(k0, k0)\n    # G(k,k') = V(k,k') / (1 + lam*I)\n    # where I = (2/pi) * integral_q [ q^2 * g(q)^2 * Q(q) / (omega' - 2*eps(q)) ]\n    \n    # Evaluate the loop integral I using the same quadrature rule\n    integrand_I = (2.0 / np.pi) * q_nodes**2 * g_q**2 * Q_q / propagator_denom\n    I_val = np.sum(w_nodes * integrand_I)\n    \n    # Calculate G_sep(k0, k0)\n    G_sep = (-lam * g_p[0]**2) / (1.0 + lam * I_val)\n\n    # 5. Compute and return the absolute discrepancies\n    d_real = np.abs(G_matrix.real - G_sep.real)\n    d_imag = np.abs(G_matrix.imag - G_sep.imag)\n\n    return d_real, d_imag\n\nif __name__ == '__main__':\n    solve()\n\n```", "id": "3545576"}, {"introduction": "在核介质中，核子并非自由运动，而是受到周围其他核子产生的平均场的影响。这一物理效应体现在单粒子能量谱 $\\epsilon(k)$ 的选择上，它不同于真空中自由核子的能量。本练习旨在探索多体理论中的一个核心概念——自洽性，通过研究不同的单粒子谱模型（自由谱、有效质量近似谱、动量依赖平均场谱）如何影响计算出的介质中有效相互作用（即 $G$ 矩阵），来加深您对介质效应的理解 [@problem_id:3594986]。您将定量分析 $G$ 矩阵对单粒子谱选择的敏感性，从而领悟为何在真实核物理计算中，自洽地确定有效相互作用和单粒子能谱是如此重要。", "problem": "考虑无限、各向同性的核物质，其中在填满的费米海存在下的双核子散射由 Bethe-Goldstone 方程描述。在动量空间中进行计算，相对动量大小用 $k$ 表示，并使用角平均泡利阻塞近似，使得高于费米动量的中间态相对动量不被阻塞。设两体相互作用为动量空间中的秩-1可分离势，形式为 $V(k,k')=-\\lambda\\,g(k)\\,g(k')$，其中 $g(k)=1/\\bigl(1+(k/\\beta)^2\\bigr)$ 且 $\\lambda$ 是一个正常数。采用的单位制中，动量单位为 $\\mathrm{fm}^{-1}$，能量单位为 $\\mathrm{MeV}$，动能系数由 $\\hbar^2/(2m)=20.735\\,\\mathrm{MeV\\,fm^2}$ 给出。单粒子能量 $\\epsilon(k)$ 出现在能量分母中，并将通过改变其形式来测试灵敏度。对 $\\epsilon(k)$ 使用以下三种模型：(i) 自由谱 $\\epsilon_{\\mathrm{free}}(k)=\\bigl(\\hbar^2/(2m)\\bigr)\\,k^2$，(ii) 有效质量加常数平均场 $\\epsilon_{\\mathrm{eff}}(k)=\\bigl(\\hbar^2/(2m)\\bigr)\\,(m/m^*)\\,k^2+U_0$，其中有效质量比为 $m^*/m$，以及 (iii) 动量依赖的平均场 $\\epsilon_{\\mathrm{mom}}(k)=\\bigl(\\hbar^2/(2m)\\bigr)\\,k^2-U_0/\\bigl(1+(k/k_c)^2\\bigr)$。对于每种模型，取起始能量为在壳能量，即 $\\omega=2\\,\\epsilon(k_0)$，其中 $k_0>k_F$ 是一个给定的在壳相对动量，$k_F$ 是费米动量。为确保数值稳定性，通过在能量分母中引入一个微小的正虚数调节子 $i\\eta$ 来进行正则化，并在一个紫外截断 $q_{\\max}$ 处截断动量积分。\n\n从 Bethe–Goldstone 方程和所述近似出发，推导秩-1可分离势的在壳、S波、角平均的介质内相互作用 $G(k_0,k_0;\\omega)$ 实部的可数值计算表达式。然后实现一个程序，对测试套件中的每一组参数，计算：\n- $G_{\\mathrm{free}}(k_0,k_0;2\\,\\epsilon_{\\mathrm{free}}(k_0))$ 的实部，\n- $G_{\\mathrm{eff}}(k_0,k_0;2\\,\\epsilon_{\\mathrm{eff}}(k_0))$ 的实部，\n- $G_{\\mathrm{mom}}(k_0,k_0;2\\,\\epsilon_{\\mathrm{mom}}(k_0))$ 的实部，\n并输出两个无量纲灵敏度度量\n- $r_{\\mathrm{eff}}=\\operatorname{Re}\\,G_{\\mathrm{eff}}/\\operatorname{Re}\\,G_{\\mathrm{free}}$，\n- $r_{\\mathrm{mom}}=\\operatorname{Re}\\,G_{\\mathrm{mom}}/\\operatorname{Re}\\,G_{\\mathrm{free}}$，\n四舍五入到六位小数。\n\n所有积分计算时，动量 $q$ 的单位必须是 $\\mathrm{fm}^{-1}$，能量单位是 $\\mathrm{MeV}$。角度已通过角平均积分掉，因此不需要角度单位。所要求的输出是无单位的纯数。你的程序必须评估以下测试套件，其中 $(k_F,k_0,\\beta,\\lambda,m^*/m,U_0,U_0^{(\\mathrm{mom})},k_c,\\eta,q_{\\max})$ 被指定为：\n- 测试 $1$：$(0.4,0.8,1.6,350.0,0.9,-20.0,40.0,1.7,1.0\\times 10^{-3},8.0)$，\n- 测试 $2$：$(1.33,1.5,1.8,400.0,0.7,-50.0,60.0,1.5,2.0\\times 10^{-3},8.0)$，\n- 测试 $3$：$(1.8,2.0,1.4,300.0,0.6,-70.0,80.0,1.2,5.0\\times 10^{-3},8.0)$，\n- 测试 $4$：$(0.0,0.2,1.6,350.0,1.0,0.0,0.0,1.5,1.0\\times 10^{-4},8.0)$。\n\n对于每个测试，计算如上定义的 $r_{\\mathrm{eff}}$ 和 $r_{\\mathrm{mom}}$。你的程序应生成单行输出，包含一个用方括号括起来的逗号分隔列表，该列表按给定顺序将所有测试的结果展开，即 $[r_{\\mathrm{eff}}^{(1)},r_{\\mathrm{mom}}^{(1)},r_{\\mathrm{eff}}^{(2)},r_{\\mathrm{mom}}^{(2)},r_{\\mathrm{eff}}^{(3)},r_{\\mathrm{mom}}^{(3)},r_{\\mathrm{eff}}^{(4)},r_{\\mathrm{mom}}^{(4)}]$，其中每个条目四舍五入到六位小数。", "solution": "该问题要求在角平均泡利阻塞近似下，针对秩-1可分离势，推导并计算在壳、S波的介质内双核子相互作用（即 $G$矩阵）。我们将首先推导 $G$矩阵实部的解析表达式，然后概述其数值计算过程。\n\n$G$矩阵算符的 Bethe-Goldstone 方程由下式给出\n$$ G(\\omega) = V + V \\frac{Q}{\\omega - H_0 + i\\eta} G(\\omega) $$\n其中 $V$ 是双核子势，$H_0$ 是未微扰双粒子哈密顿量，$\\omega$ 是起始能量，$Q$ 是泡利阻塞算符，$i\\eta$ 是一个微小的正虚数调节子（$\\eta \\to 0^+$）。\n\n我们在相对动量表象中进行计算。对于 S波（$l=0$）分波，Bethe-Goldstone 方程成为一个积分方程：\n$$ G_0(k, k'; \\omega) = V_0(k, k') + \\frac{2}{\\pi} \\int_0^\\infty q^2 dq \\, V_0(k, q) \\frac{Q(q)}{\\omega - 2\\epsilon(q) + i\\eta} G_0(q, k'; \\omega) $$\n因子 $2/\\pi$ 来自于分波 Lippmann-Schwinger 型方程的标准归一化。然而，与标准核物理文献中积分 $\\int \\frac{d^3q}{(2\\pi)^3} \\rightarrow \\frac{1}{2\\pi^2} \\int q^2 dq$ 的约定相比，我们将遵循后一种约定。对于可分离势，最终结果对这一选择不敏感，因为该因子会消掉，但为了与已有的文献保持一致，我们使用 $\\frac{1}{2\\pi^2} \\int q^2 dq$。\n$$ G_0(k, k'; \\omega) = V_0(k, k') + \\frac{1}{2\\pi^2} \\int_0^\\infty q^2 dq \\, V_0(k, q) \\frac{Q(q)}{\\omega - 2\\epsilon(q) + i\\eta} G_0(q, k'; \\omega) $$\n问题给出了一个秩-1可分离势，对于 S波，其形式为\n$$ V_0(k, k') = -\\lambda g(k) g(k') $$\n其中 $g(k) = 1/\\bigl(1+(k/\\beta)^2\\bigr)$。该势的可分离特性提示解的形式为\n$$ G_0(k, k'; \\omega) = \\mathcal{T}(\\omega) g(k) g(k') $$\n将 $G_0$ 的试探解和 $V_0$ 的形式代入积分方程：\n$$ \\mathcal{T}(\\omega) g(k) g(k') = -\\lambda g(k) g(k') + \\frac{1}{2\\pi^2} \\int_0^\\infty q^2 dq \\, \\left( -\\lambda g(k) g(q) \\right) \\frac{Q(q)}{\\omega - 2\\epsilon(q) + i\\eta} \\left( \\mathcal{T}(\\omega) g(q) g(k') \\right) $$\n两边同除以 $g(k)g(k')$（对于有限动量，该项非零），我们可以解出反应矩阵 $\\mathcal{T}(\\omega)$：\n$$ \\mathcal{T}(\\omega) = -\\lambda - \\mathcal{T}(\\omega) \\frac{\\lambda}{2\\pi^2} \\int_0^\\infty q^2 dq \\, \\frac{[g(q)]^2 Q(q)}{\\omega - 2\\epsilon(q) + i\\eta} $$\n$$ \\mathcal{T}(\\omega) \\left[ 1 + \\frac{\\lambda}{2\\pi^2} \\int_0^\\infty q^2 dq \\, \\frac{[g(q)]^2 Q(q)}{\\omega - 2\\epsilon(q) + i\\eta} \\right] = -\\lambda $$\n$$ \\mathcal{T}(\\omega) = \\frac{-\\lambda}{1 + \\frac{\\lambda}{2\\pi^2} \\int_0^\\infty q^2 dq \\, \\frac{[g(q)]^2 Q(q)}{\\omega - 2\\epsilon(q) + i\\eta}} $$\n完整的S波 $G$矩阵元则为\n$$ G_0(k, k'; \\omega) = \\frac{-\\lambda g(k) g(k')}{1 + \\frac{\\lambda}{2\\pi^2} \\int_0^\\infty q^2 dq \\, \\frac{[g(q)]^2 Q(q)}{\\omega - 2\\epsilon(q) + i\\eta}} $$\n问题指定了角平均泡利算符，其中如果中间态的相对动量 $q$ 低于费米动量 $k_F$，则该中间态被阻塞。因此，当 $q > k_F$ 时 $Q(q) = 1$，当 $q \\le k_F$ 时 $Q(q) = 0$。动量积分也在紫外截断 $q_{\\max}$ 处被截断。这将积分范围限制在 $[k_F, q_{\\max}]$。我们感兴趣的是在壳矩阵元 $G_0(k_0, k_0; \\omega)$，其中起始能量为 $\\omega = 2\\epsilon(k_0)$。\n$$ G_0(k_0, k_0; 2\\epsilon(k_0)) = \\frac{-\\lambda [g(k_0)]^2}{1 + \\frac{\\lambda}{2\\pi^2} \\int_{k_F}^{q_{\\max}} dq \\, \\frac{q^2 [g(q)]^2}{2\\epsilon(k_0) - 2\\epsilon(q) + i\\eta}} $$\n为求此复值表达式的实部，我们定义复积分 $I$ 为\n$$ I = \\int_{k_F}^{q_{\\max}} dq \\, \\frac{q^2 [g(q)]^2}{2\\epsilon(k_0) - 2\\epsilon(q) + i\\eta} $$\n我们可以将被积函数的分母分离为实部和虚部：\n$$ \\frac{1}{A(q) + i\\eta} = \\frac{A(q) - i\\eta}{A(q)^2 + \\eta^2}, \\quad \\text{其中 } A(q) = 2\\epsilon(k_0) - 2\\epsilon(q) $$\n积分 $I$ 可以写成 $I = I_R + iI_I$，其中\n$$ I_R = \\int_{k_F}^{q_{\\max}} dq \\, q^2 [g(q)]^2 \\frac{2\\epsilon(k_0) - 2\\epsilon(q)}{(2\\epsilon(k_0) - 2\\epsilon(q))^2 + \\eta^2} $$\n$$ I_I = -\\int_{k_F}^{q_{\\max}} dq \\, q^2 [g(q)]^2 \\frac{\\eta}{(2\\epsilon(k_0) - 2\\epsilon(q))^2 + \\eta^2} $$\n于是，在壳 $G$矩阵元为\n$$ G_0(k_0, k_0; \\omega) = \\frac{-\\lambda [g(k_0)]^2}{1 + \\frac{\\lambda}{2\\pi^2}(I_R + iI_I)} = \\frac{-\\lambda [g(k_0)]^2}{\\left(1 + \\frac{\\lambda}{2\\pi^2}I_R\\right) + i\\left(\\frac{\\lambda}{2\\pi^2}I_I\\right)} $$\n$G_0(k_0, k_0; \\omega)$ 的实部，我们记作 $\\operatorname{Re} G$，可通过将分子和分母同乘以分母的复共轭得到：\n$$ \\operatorname{Re} G = \\frac{-\\lambda [g(k_0)]^2 \\left(1 + \\frac{\\lambda}{2\\pi^2}I_R\\right)}{\\left(1 + \\frac{\\lambda}{2\\pi^2}I_R\\right)^2 + \\left(\\frac{\\lambda}{2\\pi^2}I_I\\right)^2} $$\n该表达式可以进行数值计算。对于每组参数，我们必须为单粒子能量 $\\epsilon(k)$ 的三种不同模型计算此量：\n1.  自由谱：$\\epsilon_{\\mathrm{free}}(k) = (\\hbar^2/2m) k^2$。\n2.  有效质量：$\\epsilon_{\\mathrm{eff}}(k) = (\\hbar^2/2m)(m/m^*)k^2 + U_0$。\n3.  动量依赖的平均场：$\\epsilon_{\\mathrm{mom}}(k) = (\\hbar^2/2m)k^2 - U_0^{(\\mathrm{mom})}/\\bigl(1+(k/k_c)^2\\bigr)$。\n\n对于每种模型，我们将壳上能量 $\\omega$ 设置为 $2\\epsilon(k_0)$，其中 $\\epsilon$ 是各自的单粒子能量模型。计算过程为：使用标准求积方法数值计算定积分 $I_R$ 和 $I_I$，然后将结果代入 $\\operatorname{Re} G$ 的表达式中。最后，我们计算所需的灵敏度比 $r_{\\mathrm{eff}}=\\operatorname{Re}\\,G_{\\mathrm{eff}}/\\operatorname{Re}\\,G_{\\mathrm{free}}$ 和 $r_{\\mathrm{mom}}=\\operatorname{Re}\\,G_{\\mathrm{mom}}/\\operatorname{Re}\\,G_{\\mathrm{free}}$。\n\n给定的参数有：动能系数 $\\hbar^2/(2m) = 20.735\\,\\mathrm{MeV\\,fm^2}$，势形状因子 $g(k) = 1/\\bigl(1+(k/\\beta)^2\\bigr)$，以及指定了 $(k_F,k_0,\\beta,\\lambda,m^*/m,U_0,U_0^{(\\mathrm{mom})},k_c,\\eta,q_{\\max})$ 的测试套件。程序实现将定义一个函数，该函数接收这些参数和能量模型类型作为输入，计算 $\\operatorname{Re} G$，然后主程序将为每个模型和测试用例调用此函数以计算最终的比率。\n对于测试用例4，注意 $k_F=0.0$，$m^*/m=1.0$，$U_0=0.0$ 且 $U_0^{(\\mathrm{mom})}=0.0$。这意味着在这种特定情况下，$\\epsilon_{\\mathrm{free}}(k) = \\epsilon_{\\mathrm{eff}}(k) = \\epsilon_{\\mathrm{mom}}(k)$，且积分范围是 $[0, q_{\\max}]$。因此，$\\operatorname{Re}G_{\\mathrm{free}} = \\operatorname{Re}G_{\\mathrm{eff}} = \\operatorname{Re}G_{\\mathrm{mom}}$，这导致预期 $r_{\\mathrm{eff}} = 1.0$ 且 $r_{\\mathrm{mom}} = 1.0$。这可以用来验证实现的正确性。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import quad\n\ndef solve():\n    \"\"\"\n    Computes sensitivity measures for the Bethe-Goldstone G-matrix with a separable potential.\n    \"\"\"\n    # Define the constant from the problem statement.\n    HBAR2_OVER_2M = 20.735  # MeV fm^2\n\n    # Define the test cases from the problem statement.\n    # (k_F, k_0, beta, lam, m_ratio, U0_eff, U0_mom, k_c, eta, q_max)\n    test_cases = [\n        (0.4, 0.8, 1.6, 350.0, 0.9, -20.0, 40.0, 1.7, 1.0e-3, 8.0),\n        (1.33, 1.5, 1.8, 400.0, 0.7, -50.0, 60.0, 1.5, 2.0e-3, 8.0),\n        (1.8, 2.0, 1.4, 300.0, 0.6, -70.0, 80.0, 1.2, 5.0e-3, 8.0),\n        (0.0, 0.2, 1.6, 350.0, 1.0, 0.0, 0.0, 1.5, 1.0e-4, 8.0),\n    ]\n\n    results = []\n\n    def g_potential_form_factor(k, beta):\n        \"\"\"Calculates the potential form factor g(k).\"\"\"\n        return 1.0 / (1.0 + (k / beta)**2)\n\n    def compute_re_g(params, model_type):\n        \"\"\"\n        Computes the real part of the on-shell G-matrix for a given energy model.\n        \"\"\"\n        k_F, k_0, beta, lam, m_ratio, U0_eff, U0_mom, k_c, eta, q_max = params\n\n        # Define the single-particle energy function epsilon(k) based on the model\n        if model_type == 'free':\n            epsilon = lambda k: HBAR2_OVER_2M * k**2\n        elif model_type == 'eff_mass':\n            epsilon = lambda k: HBAR2_OVER_2M * (1.0 / m_ratio) * k**2 + U0_eff\n        elif model_type == 'mom_dep':\n            epsilon = lambda k: HBAR2_OVER_2M * k**2 - U0_mom / (1.0 + (k / k_c)**2)\n        else:\n            raise ValueError(\"Invalid model type provided.\")\n\n        # On-shell starting energy\n        omega = 2.0 * epsilon(k_0)\n\n        # Common part of the integrand numerator, f(q) = q^2 * [g(q)]^2\n        f_q = lambda q: q**2 * g_potential_form_factor(q, beta)**2\n        \n        # Energy denominator term, A(q) = omega - 2*epsilon(q)\n        A_q = lambda q: omega - 2.0 * epsilon(q)\n\n        # Integrand for the real part of the complex integral I\n        integrand_R = lambda q: f_q(q) * A_q(q) / (A_q(q)**2 + eta**2)\n        \n        # Integrand for the imaginary part of the complex integral I\n        integrand_I = lambda q: -f_q(q) * eta / (A_q(q)**2 + eta**2)\n\n        # Perform numerical integration to get I_R and I_I\n        I_R, _ = quad(integrand_R, k_F, q_max)\n        I_I, _ = quad(integrand_I, k_F, q_max)\n\n        # Factor multiplying the integral in the G-matrix denominator\n        integral_term_factor = lam / (2.0 * np.pi**2)\n        \n        # Real and imaginary parts of the G-matrix denominator\n        denom_real = 1.0 + integral_term_factor * I_R\n        denom_imag = integral_term_factor * I_I\n        \n        # G-matrix numerator\n        g_k0_squared = g_potential_form_factor(k_0, beta)**2\n        numerator = -lam * g_k0_squared\n        \n        # Calculate the real part of the G-matrix\n        re_G = (numerator * denom_real) / (denom_real**2 + denom_imag**2)\n        \n        return re_G\n\n    for case in test_cases:\n        # Calculate Re(G) for each of the three models\n        re_g_free = compute_re_g(case, 'free')\n        re_g_eff = compute_re_g(case, 'eff_mass')\n        re_g_mom = compute_re_g(case, 'mom_dep')\n\n        # Calculate the dimensionless sensitivity measures\n        # A check for re_g_free being close to zero is prudent in general,\n        # but for the given parameters, it's not expected to be an issue.\n        r_eff = re_g_eff / re_g_free\n        r_mom = re_g_mom / re_g_free\n\n        results.append(r_eff)\n        results.append(r_mom)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{x:.6f}' for x in results)}]\")\n\nsolve()\n```", "id": "3594986"}, {"introduction": "真实的核子-核子相互作用远比简单的中心力复杂，它还依赖于核子的自旋和轨道角动量。其中，自旋-轨道相互作用是解释原子核壳结构等现象的关键组成部分。本练习将引导您从复杂的核力中分离出自旋-轨道部分，并分析它对三重态P波（$^{3}P_J$）道中有效相互作用的贡献 [@problem_id:3594974]。通过分别计算总角动量 $J=0, 1, 2$ 各通道的 $G$ 矩阵，您将直接观察到自旋-轨道力如何解除简并并导致能级劈裂，这一现象是理解原子核结构物理的基石。", "problem": "考虑在零温下的对称无限核物质，其中双核子总质心动量限制为零。从算符形式的介质中反应矩阵的 Bethe–Goldstone 方程出发，该方程将介质中相互作用与裸核子-核子相互作用、实施泡利不相容原理的泡利投影算符以及无相互作用的双粒子传播子联系起来。限定于轨道角动量 $L=1$ 和自旋 $S=1$ 的三重态 P 波道，即总角动量 $J\\in\\{0,1,2\\}$ 的 $\\,^{3}P_{J}\\,$ 波道。\n\n仅分离出相互作用的自旋-轨道部分，并将其在 P 波中建模为秩-1 可分离形式，\n$$\nV_{LS}^{(J)}(k,k') \\equiv C_{LS}\\,\\langle \\mathbf{L}\\cdot\\mathbf{S}\\rangle_{(L=1,S=1;J)} \\, g(k)\\, g(k') \\,,\n$$\n其中 $g(k)\\equiv k\\,\\exp\\!\\left[-(k/\\beta)^2\\right]$，$k$ 和 $k'$ 是以 $\\mathrm{fm}^{-1}$ 为单位的相对动量，$C_{LS}$ 是一个实耦合常数，而 $\\langle \\mathbf{L}\\cdot\\mathbf{S}\\rangle_{(L,S;J)}$ 是在耦合分波基下的标准期望值。假设在总动量 $K=0$ 时采用自由单粒子谱和角平均的泡利投影算符，因此在相对动量表象中，泡利阻塞表现为径向动量积分在费米动量 $k_F$ 处的一个严格下限。\n\n您的任务是：\n\n1) 从上述算符形式的 Bethe–Goldstone 方程和可分离拟设出发，将每个固定 $J$ 波道的问题简化为一个关于约化的介质中振幅的标量代数方程。该振幅依赖于起始能量 $\\omega$ 和一个泡利阻塞的圈图积分。将该圈图积分表示为一个具有正确三维测度和泡利下限的一维动量积分，并用此约化振幅和形状因子 $g(k_0)$ 来表示外禀相对动量为 $k_0$ 时的在壳介质中反应矩阵元 $G^{(J)}(k_0,k_0;\\omega)$。\n\n2) 在确定的 $(L,S,J)$ 波道中，使用自旋-轨道算符的精确角动量恒等式，将对 $J$ 的依赖关系完全归结于数值 $\\langle \\mathbf{L}\\cdot\\mathbf{S}\\rangle_{(1,1;J)}$。除此期望值外，不假设任何额外的对 $J$ 的依赖。\n\n3) 使用能量单位为兆电子伏（MeV）和动量单位为逆费米（$\\mathrm{fm}^{-1}$）的单位制。取两个等质量核子的自由单粒子能量为 $e(k)=\\alpha\\,k^2$，其中 $\\alpha\\equiv \\hbar^2/(2m_N) = 20.735\\,\\mathrm{MeV\\cdot fm}^2$。使用带有起始能量 $\\omega$ 的自由双粒子传播子和 $K=0$ 的角平均泡利投影算符，即仅对 $k\\ge k_F$进行积分。在相对动量积分上引入一个严格的紫外截断 $\\Lambda$。将起始能量 $\\omega$ 视为实数且严格为负，以确保不出现任何在壳奇异点；计算实值的介质中反应矩阵元。\n\n4) 实现一个程序，对于下面测试套件中的每个参数集，计算五个实数：\n- 对于 $J=0,1,2$ 的 $\\,^{3}P_J\\,$ 波道，介质中反应矩阵 $G^{(J)}(k_0,k_0;\\omega)$ 的三个实在壳自旋-轨道贡献，以及\n- 两个劈裂 $\\Delta_{21}\\equiv \\operatorname{Re}G^{(J=2)} - \\operatorname{Re}G^{(J=1)}$ 和 $\\Delta_{10}\\equiv \\operatorname{Re}G^{(J=1)} - \\operatorname{Re}G^{(J=0)}$。\n所有五个量都必须以 $\\mathrm{MeV\\cdot fm}^3$ 为单位表示，并以浮点数形式报告。\n\n使用以下约定和输入：\n- 圈图积分必须使用带角平均的三维动量测度，即一个因子 $1/(2\\pi^2)$ 乘以一个在 $k\\in[k_{\\min},\\Lambda]$ 上的一维积分，其中 $k_{\\min}\\equiv \\max(k_F,0)$。\n- 双粒子能量分母为 $\\omega - 2 e(k) = \\omega - 2\\alpha k^2$。\n- 形状因子为 $g(k)=k\\,\\exp\\!\\left[-(k/\\beta)^2\\right]$。\n- 期望值为 $\\langle \\mathbf{L}\\cdot\\mathbf{S}\\rangle_{(1,1;J)}=\\frac{1}{2}\\left[J(J+1)-L(L+1)-S(S+1)\\right]$，其中 $L=S=1$。\n- 在程序中将所有输入视为精确值；不要对中间量进行四舍五入。\n\n测试套件（每个案例是一个元组 $(k_F,\\omega,\\Lambda,\\beta,C_{LS},k_0)$，单位如下所示）：\n- 案例 A: $(\\,1.3\\ \\mathrm{fm}^{-1},\\ -20.0\\ \\mathrm{MeV},\\ 6.0\\ \\mathrm{fm}^{-1},\\ 2.0\\ \\mathrm{fm}^{-1},\\ -200.0\\ \\mathrm{MeV\\cdot fm}^5,\\ 1.3\\ \\mathrm{fm}^{-1}\\,)$。\n- 案例 B: $(\\,0.0\\ \\mathrm{fm}^{-1},\\ -5.0\\ \\mathrm{MeV},\\ 6.0\\ \\mathrm{fm}^{-1},\\ 2.0\\ \\mathrm{fm}^{-1},\\ -200.0\\ \\mathrm{MeV\\cdot fm}^5,\\ 1.0\\ \\mathrm{fm}^{-1}\\,)$。\n- 案例 C: $(\\,2.0\\ \\mathrm{fm}^{-1},\\ -40.0\\ \\mathrm{MeV},\\ 6.0\\ \\mathrm{fm}^{-1},\\ 2.0\\ \\mathrm{fm}^{-1},\\ -200.0\\ \\mathrm{MeV\\cdot fm}^5,\\ 2.0\\ \\mathrm{fm}^{-1}\\,)$。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个含三个内部列表的列表，每个内部列表对应一个测试案例，顺序为 A, B, C。\n- 每个内部列表必须包含五个条目，顺序严格为 $[\\,\\operatorname{Re}G^{(J=0)},\\ \\operatorname{Re}G^{(J=1)},\\ \\operatorname{Re}G^{(J=2)},\\ \\Delta_{21},\\ \\Delta_{10}\\,]$，所有值均以 $\\mathrm{MeV\\cdot fm}^3$ 为单位。\n- 外部列表和所有内部列表都必须用方括号打印，数字之间用逗号分隔，不含额外文本。例如：$[[x_{A,0},x_{A,1},x_{A,2},x_{A,3},x_{A,4}],[x_{B,0},\\dots],[x_{C,0},\\dots]]$。", "solution": "用户提供了一个计算核物理问题，要求针对对称核物质中简化的、可分离的自旋-轨道相互作用，推导并数值求解 Bethe-Goldstone 方程。\n\n首先，我将验证问题陈述。\n\n### 步骤 1：提取已知条件\n- **物理系统**：零温下的对称无限核物质，总双核子质心动量 $K=0$。\n- **运动方程**：Bethe–Goldstone 方程。\n- **分波**：三重态 P 波道，$L=1$，$S=1$，产生总角动量 $J \\in \\{0, 1, 2\\}$，记为 $\\,^{3}P_{J}$。\n- **相互作用模型**：秩-1 可分离自旋-轨道势，$V_{LS}^{(J)}(k,k') \\equiv C_{LS}\\,\\langle \\mathbf{L}\\cdot\\mathbf{S}\\rangle_{(L=1,S=1;J)} \\, g(k)\\, g(k')$。\n- **形状因子**：$g(k) \\equiv k\\,\\exp\\!\\left[-(k/\\beta)^2\\right]$，其中 $k$ 和 $k'$ 是以 $\\mathrm{fm}^{-1}$ 为单位的相对动量。\n- **物理模型**：自由单粒子谱和角平均的泡利投影算符，这对中间相对动量积分施加了一个严格的下限 $k_F$。另外还施加了一个严格的紫外截断 $\\Lambda$。\n- **能谱**：两个核子的自由单粒子能量为 $e(k)=\\alpha\\,k^2$，其中 $\\alpha \\equiv \\hbar^2/(2m_N) = 20.735\\,\\mathrm{MeV\\cdot fm}^2$。双粒子能量分母为 $\\omega - 2e(k) = \\omega - 2\\alpha k^2$，其中 $\\omega$ 是一个实的、严格为负的起始能量。\n- **动量积分**：圈图积分使用带角平均的三维测度，$\\frac{1}{2\\pi^2}\\int_{k_{\\min}}^{\\Lambda} k^2 dk$，其中 $k_{\\min} \\equiv \\max(k_F,0)$。\n- **角动量耦合**：自旋-轨道算符的期望值由 $\\langle \\mathbf{L}\\cdot\\mathbf{S}\\rangle_{(1,1;J)}=\\frac{1}{2}\\left[J(J+1)-L(L+1)-S(S+1)\\right]$ 给出，对于 $L=S=1$。\n- **任务**：计算 $J=0,1,2$ 时的实在壳介质中反应矩阵元 $G^{(J)}(k_0,k_0;\\omega)$，以及能量劈裂 $\\Delta_{21}\\equiv \\operatorname{Re}G^{(J=2)} - \\operatorname{Re}G^{(J=1)}$ 和 $\\Delta_{10}\\equiv \\operatorname{Re}G^{(J=1)} - \\operatorname{Re}G^{(J=0)}$。所有值都以 $\\mathrm{MeV\\cdot fm}^3$ 为单位。\n- **测试案例**：\n    - A: $(k_F,\\omega,\\Lambda,\\beta,C_{LS},k_0) = (1.3, -20.0, 6.0, 2.0, -200.0, 1.3)$，单位为 $\\mathrm{fm}^{-1}, \\mathrm{MeV}, \\mathrm{fm}^{-1}, \\mathrm{fm}^{-1}, \\mathrm{MeV\\cdot fm}^5, \\mathrm{fm}^{-1}$。\n    - B: $(k_F,\\omega,\\Lambda,\\beta,C_{LS},k_0) = (0.0, -5.0, 6.0, 2.0, -200.0, 1.0)$。\n    - C: $(k_F,\\omega,\\Lambda,\\beta,C_{LS},k_0) = (2.0, -40.0, 6.0, 2.0, -200.0, 2.0)$。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题具有科学依据，采用了 Bethe-Goldstone 方程，这是核多体理论中的标准工具。使用可分离势是求解此类积分方程的一种成熟且有效的近似方法。物理参数，包括常数 $\\alpha$、费米动量和相互作用强度，都在核物理计算的典型范围内。问题是适定的，为获得唯一解提供了所有必要的定义、常数和数据。语言客观明确。单位内部一致：相互作用 $V^{(J)}(k,k')$ 的单位是 $(\\mathrm{MeV\\cdot fm}^5) \\cdot (\\mathrm{fm}^{-1}) \\cdot (\\mathrm{fm}^{-1}) = \\mathrm{MeV\\cdot fm}^3$，这对应于能量 $\\times$ 体积，是动量空间势矩阵元的正确单位。所要求的输出也使用这些单位。该问题通过了所有验证标准。\n\n### 步骤 3：结论与行动\n问题有效。我现在将着手求解。\n\n### 基于原理的求解\n\n出发点是介质中反应矩阵 $G$ 的 Bethe-Goldstone 方程，该方程对核介质中所有的双粒子梯形图进行了求和。在由总角动量 $J$ 标识的特定分波波道中，它在相对动量表象下呈现为以下积分方程形式：\n$$\nG^{(J)}(k, k'; \\omega) = V^{(J)}(k, k') + \\int_0^\\infty \\frac{p^2 dp}{2\\pi^2} V^{(J)}(k, p) \\frac{Q(p)}{\\omega - H_0(p)} G^{(J)}(p, k'; \\omega)\n$$\n此处，$V^{(J)}$ 是裸核子-核子相互作用，$Q(p)$ 是泡利不相容原理算符，分母包含起始能量 $\\omega$ 和无相互作用的双粒子哈密顿量 $H_0(p)$。\n\n问题指定了以下内容：\n1. 裸相互作用是秩-1 可分离自旋-轨道势：$V_{LS}^{(J)}(k,k') = C_{LS_J} g(k) g(k')$，其中 $C_{LS_J} \\equiv C_{LS} \\langle \\mathbf{L}\\cdot\\mathbf{S} \\rangle_{(1,1;J)}$，形状因子为 $g(k) = k e^{-(k/\\beta)^2}$。\n2. 对于零总动量 ($K=0$) 的角平均泡利投影算符将中间态动量限制在费米动量之上，$p \\ge k_F$。给定紫外截断 $\\Lambda$，积分区域为 $p \\in [k_F, \\Lambda]$。这实际上意味着 $Q(p) = \\theta(p - k_F)\\theta(\\Lambda - p)$。\n3. 中间态能量是两个自由粒子的能量，$H_0(p) = 2e(p) = 2\\alpha p^2$。\n\n将这些代入 Bethe-Goldstone 方程：\n$$\nG^{(J)}(k, k'; \\omega) = C_{LS_J} g(k) g(k') + \\int_{k_F}^{\\Lambda} \\frac{p^2 dp}{2\\pi^2} \\left[ C_{LS_J} g(k) g(p) \\right] \\frac{1}{\\omega - 2\\alpha p^2} G^{(J)}(p, k'; \\omega)\n$$\n由于势是可分离的， $G^{(J)}$ 的解也必须是可分离的。我们做出拟设：\n$$\nG^{(J)}(k, k'; \\omega) = \\tau_J(\\omega) g(k) g(k')\n$$\n其中 $\\tau_J(\\omega)$ 是在起始能量 $\\omega$ 下，$J$ 波道的一个约化的、与动量无关的振幅。将此拟设代入积分方程：\n$$\n\\tau_J(\\omega) g(k) g(k') = C_{LS_J} g(k) g(k') + C_{LS_J} g(k) \\left[ \\int_{k_F}^{\\Lambda} \\frac{p^2 dp}{2\\pi^2} \\frac{g(p)^2}{\\omega - 2\\alpha p^2} \\right] \\tau_J(\\omega) g(k')\n$$\n假设 $g(k)g(k') \\neq 0$，我们可以将其约去，从而得到一个关于 $\\tau_J(\\omega)$ 的标量代数方程：\n$$\n\\tau_J(\\omega) = C_{LS_J} + C_{LS_J} \\tau_J(\\omega) I(\\omega, k_F, \\Lambda)\n$$\n其中泡利阻塞的圈图积分 $I(\\omega, k_F, \\Lambda)$ 定义为：\n$$\nI(\\omega, k_F, \\Lambda) \\equiv \\frac{1}{2\\pi^2} \\int_{k_F}^{\\Lambda} \\frac{p^2 [g(p)]^2}{\\omega - 2\\alpha p^2} dp = \\frac{1}{2\\pi^2} \\int_{k_F}^{\\Lambda} \\frac{p^4 e^{-2(p/\\beta)^2}}{\\omega - 2\\alpha p^2} dp\n$$\n注意，问题将积分下限定义为 $k_{\\min} = \\max(k_F,0)$，由于所有情况下 $k_F \\ge 0$，因此将下限设为 $k_F$ 即可处理。起始能量 $\\omega$ 严格为负，所以分母 $\\omega - 2\\alpha p^2$ 恒为负且永不为零，确保积分为实数且良定义。\n\n求解约化振幅 $\\tau_J(\\omega)$ 的代数方程：\n$$\n\\tau_J(\\omega) \\left[ 1 - C_{LS_J} I(\\omega, k_F, \\Lambda) \\right] = C_{LS_J} \\implies \\tau_J(\\omega) = \\frac{C_{LS_J}}{1 - C_{LS_J} I(\\omega, k_F, \\Lambda)}\n$$\n于是，在外禀相对动量 $k_0$ 处的在壳反应矩阵元由下式给出：\n$$\nG^{(J)}(k_0, k_0; \\omega) = \\tau_J(\\omega) [g(k_0)]^2 = \\frac{C_{LS_J} [g(k_0)]^2}{1 - C_{LS_J} I(\\omega, k_F, \\Lambda)}\n$$\n此表达式提供了所需的矩阵元。\n\n对波道的依赖性由 $C_{LS_J}$ 控制，其中包含自旋-轨道期望值。对于 $^3P_J$ 态 ($L=1, S=1$)：\n$$\n\\langle \\mathbf{L}\\cdot\\mathbf{S}\\rangle_{(1,1;J)} = \\frac{1}{2}[J(J+1) - L(L+1) - S(S+1)] = \\frac{1}{2}[J(J+1) - 2 - 2] = \\frac{1}{2}[J(J+1) - 4]\n$$\n这给出了具体的值：\n- $J=0$: $\\langle \\mathbf{L}\\cdot\\mathbf{S}\\rangle_0 = \\frac{1}{2}[0 - 4] = -2$\n- $J=1$: $\\langle \\mathbf{L}\\cdot\\mathbf{S}\\rangle_1 = \\frac{1}{2}[2 - 4] = -1$\n- $J=2$: $\\langle \\mathbf{L}\\cdot\\mathbf{S}\\rangle_2 = \\frac{1}{2}[6 - 4] = +1$\n\n因此，每个波道的耦合常数为：\n- $C_{LS, J=0} = -2 C_{LS}$\n- $C_{LS, J=1} = -1 C_{LS}$\n- $C_{LS, J=2} = +1 C_{LS}$\n\n计算步骤如下：\n1. 对于每个测试案例，获取参数 $(k_F, \\omega, \\Lambda, \\beta, C_{LS}, k_0)$。\n2. 使用标准的求积方法数值计算公共的圈图积分 $I(\\omega, k_F, \\Lambda)$。\n3. 计算公共因子 $[g(k_0)]^2 = (k_0 e^{-(k_0/\\beta)^2})^2$。\n4. 对每个波道 $J \\in \\{0, 1, 2\\}$：\n    a. 确定波道耦合 $C_{LS_J}$。\n    b. 使用推导出的公式计算 $G^{(J)}(k_0, k_0; \\omega)$。\n5. 计算劈裂 $\\Delta_{21} = G^{(J=2)} - G^{(J=1)}$ 和 $\\Delta_{10} = G^{(J=1)} - G^{(J=0)}$。\n6. 为当前测试案例整理五个结果 $[G^{(J=0)}, G^{(J=1)}, G^{(J=2)}, \\Delta_{21}, \\Delta_{10}]$。\n7. 对所有测试案例重复以上步骤，并将最终输出格式化为列表的列表。", "answer": "```python\nimport numpy as np\nfrom scipy import integrate\n\ndef solve():\n    \"\"\"\n    Solves the Bethe-Goldstone equation for a separable spin-orbit potential\n    in nuclear matter for the specified test cases.\n    \"\"\"\n    \n    # Constant alpha = hbar^2/(2*m_N) in MeV*fm^2\n    ALPHA = 20.735\n\n    # Test suite from the problem statement.\n    # Each case is a tuple (k_F, omega, Lambda, beta, C_LS, k_0) with units:\n    # (fm^-1, MeV, fm^-1, fm^-1, MeV*fm^5, fm^-1)\n    test_cases = [\n        (1.3, -20.0, 6.0, 2.0, -200.0, 1.3),  # Case A\n        (0.0, -5.0, 6.0, 2.0, -200.0, 1.0),   # Case B\n        (2.0, -40.0, 6.0, 2.0, -200.0, 2.0),   # Case C\n    ]\n\n    def calculate_g_matrix_for_case(params):\n        \"\"\"\n        Calculates the G-matrix elements and splittings for a single parameter set.\n        \"\"\"\n        k_F, omega, Lambda, beta, C_LS, k_0 = params\n\n        # Define the integrand for the loop integral calculation\n        # The integrand is p^4 * exp(-2*(p/beta)^2) / (omega - 2*alpha*p^2)\n        def integrand_for_quad(p):\n            return p**4 * np.exp(-2.0 * (p / beta)**2) / (omega - 2.0 * ALPHA * p**2)\n\n        # Numerically compute the loop integral using scipy.integrate.quad\n        # The integration range is [k_min, Lambda] where k_min = max(k_F, 0)\n        # The full loop integral includes the 1/(2*pi^2) factor from the 3D measure\n        k_min = max(k_F, 0.0)\n        integral_val, _ = integrate.quad(integrand_for_quad, k_min, Lambda)\n        loop_integral_I = integral_val / (2.0 * np.pi**2)\n\n        # Calculate the form factor squared at the on-shell point k_0\n        g_k0_sq = (k_0 * np.exp(-(k_0 / beta)**2))**2\n\n        G_values = {}\n        # Iterate over the three J channels in the 3P partial wave (L=1, S=1)\n        # J_vals = (0, 1, 2)\n        L = 1.0\n        S = 1.0\n        for J_val in [0.0, 1.0, 2.0]:\n            # Calculate the expectation value of L.S\n            ls_exp_val = 0.5 * (J_val * (J_val + 1.0) - L * (L + 1.0) - S * (S + 1.0))\n            \n            # Determine the channel-specific coupling constant C_LS_J\n            C_LS_J = C_LS * ls_exp_val\n            \n            # Calculate the G-matrix element for the channel J\n            denominator = 1.0 - C_LS_J * loop_integral_I\n            if abs(denominator)  1e-15: # Avoid division by zero\n                # This case indicates a pole, which should not happen for the given parameters\n                # As omega is strictly negative. But it is good practice to check.\n                G_J = np.inf\n            else:\n                numerator = C_LS_J * g_k0_sq\n                G_J = numerator / denominator\n            \n            G_values[int(J_val)] = G_J\n\n        G0 = G_values[0]\n        G1 = G_values[1]\n        G2 = G_values[2]\n\n        # Calculate the splittings\n        delta_21 = G2 - G1\n        delta_10 = G1 - G0\n\n        return [G0, G1, G2, delta_21, delta_10]\n\n    # Process all test cases\n    results = [calculate_g_matrix_for_case(case) for case in test_cases]\n\n    # Format the output string as specified: [[r1_1, r1_2, ...],[r2_1, r2_2, ...]]\n    formatted_inner_lists = [f\"[{','.join(map(str, row))}]\" for row in results]\n    final_output_string = f\"[{','.join(formatted_inner_lists)}]\"\n    \n    print(final_output_string)\n\nsolve()\n```", "id": "3594974"}]}