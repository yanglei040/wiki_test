{"hands_on_practices": [{"introduction": "理解引力波信号的起源是分析工作的第一步。本练习旨在搭建从广义相对论基本理论到波形可观测属性之间的桥梁，通过从第一性原理推导四极矩公式，您将加深对加速的质量分布是引力波源这一核心概念的理解。此外，通过将其应用于一个典型的双中子星系统，您将掌握估算引力波信号特征应变数量级的实用技能。[@problem_id:3562196]", "problem": "考虑一个在洛伦兹规范条件下的线性化广义相对论（GR）中的孤立、缓慢移动、空间紧凑的源。在辐射（远）区，度规微扰在横向无迹（TT）规范下处理。从线性化爱因斯坦场方程的推迟格林函数解以及非相对论性源的能动量守恒出发，推导连接TT度规微扰与在推迟时刻计算的无迹质量四极矩的二阶时间导数的主阶远场表达式。清晰地定义所使用的质量四极矩和TT投影。\n\n然后，将问题具体化为一个准圆形等质量中子星双星系统，其组分的引力质量为 $m_{1}=m_{2}=1.4\\,M_{\\odot}$。假设轨道为圆形，在所述频率下自旋和潮汐效应可忽略不计，且源-探测器具有最优方向几何构型（相对于轨道角动量为正向）。设观测到的引力波频率为 $f=100\\,\\mathrm{Hz}$，因此轨道角频率满足 $\\Omega=\\pi f$。在整个计算中使用几何单位制 $G=c=1$。用啁啾质量 $M_{c}$、频率 $f$ 和光度距离 $D$ 表示主阶引力波应变振幅，然后估计位于 $D=100\\,\\mathrm{Mpc}$ 处的源的瞬时无量纲应变振幅的数值。\n\n使用以下与 $G=c=1$ 一致的数值转换关系：\n- $M_{\\odot} = 4.92549095\\times 10^{-6}\\,\\mathrm{s}$，\n- $1\\,\\mathrm{Mpc} = 1.02927125\\times 10^{14}\\,\\mathrm{s}$。\n\n将最终答案四舍五入至三位有效数字，并以无量纲数（无单位）的形式表示。", "solution": "用户要求我解决一个关于线性化广义相对论中引力波的两部分问题。首先，我必须推导四极矩公式。其次，我必须将其应用于一个特定的双中子星系统，以计算引力波应变振幅。\n\n### 问题验证\n\n**步骤 1：提取已知条件**\n-   **第 1 部分（推导）：**\n    -   源：孤立、缓慢移动、空间紧凑。\n    -   框架：线性化广义相对论。\n    -   规范：场方程使用洛伦兹规范（$\\partial_{\\mu}\\bar{h}^{\\mu\\nu}=0$），远场度规微扰使用横向无迹（TT）规范。\n    -   出发点：线性化爱因斯坦场方程的推迟格林函数解。\n    -   假设：非相对论性源，且能动量守恒。\n    -   目标：推导连接TT度规微扰（$h_{ij}^{TT}$）与在推迟时刻计算的无迹质量四极矩（$Q_{ij}$）的二阶时间导数的表达式。\n\n-   **第 2 部分（应用）：**\n    -   系统：准圆形等质量中子星双星。\n    -   组分质量：$m_{1} = m_{2} = 1.4\\,M_{\\odot}$。\n    -   轨道：圆形。\n    -   假设：自旋和潮汐效应可忽略不计。\n    -   几何构型：最优方向源-探测器（正向）。\n    -   观测到的引力波频率：$f = 100\\,\\mathrm{Hz}$。\n    -   轨道角频率：$\\Omega = \\pi f$。\n    -   单位：几何单位制（$G=c=1$）。\n    -   光度距离：$D = 100\\,\\mathrm{Mpc}$。\n    -   数值转换：$M_{\\odot} = 4.92549095\\times 10^{-6}\\,\\mathrm{s}$，$1\\,\\mathrm{Mpc} = 1.02927125\\times 10^{14}\\,\\mathrm{s}$。\n    -   最终输出：瞬时无量纲应变振幅的数值，四舍五入至三位有效数字。\n\n**步骤 2：使用提取的已知条件进行验证**\n1.  **科学基础：** 该问题完全基于公认的线性化广义相对论理论及其在双星系统引力波产生中的应用。四极矩公式的推导是引力波理论的基石。\n2.  **问题明确：** 问题为从基本方程到具体应用提供了一条清晰的路径。所有必要的物理参数、假设和数值常数都已提供。问题具体，指向一个唯一且有意义的答案。\n3.  **客观性：** 语言正式、精确，没有主观或含糊的陈述。\n4.  **自洽且一致：** 关系式 $\\Omega = \\pi f$ 与圆形双星系统的主导引力波频率（$f$）是轨道频率（$f_{orb}$）的两倍这一事实是一致的，因为 $\\Omega = 2\\pi f_{orb}$，这意味着 $f = 2f_{orb} = \\Omega/\\pi$。给定的质量、距离和频率对于处于旋进阶段的双中子星系统来说在天体物理学上是合理的。\n\n**步骤 3：结论与行动**\n该问题是有效的。它是理论天体物理学中一个标准的、明确的问题。我将继续进行详细解答。\n\n### 第 1 部分：四极矩公式的推导\n\n我们从洛伦兹规范（$\\partial_\\mu \\bar{h}^{\\mu\\nu} = 0$）下的线性化爱因斯坦场方程开始，以几何单位制（$G=c=1$）表示：\n$$ \\Box \\bar{h}_{\\mu\\nu} = -16\\pi T_{\\mu\\nu} $$\n其中 $\\Box = -\\partial_t^2 + \\nabla^2$ 是达朗贝尔算符，$T_{\\mu\\nu}$ 是源的能动量张量，而 $\\bar{h}_{\\mu\\nu} = h_{\\mu\\nu} - \\frac{1}{2}\\eta_{\\mu\\nu}h$ 是迹反转度规微扰。\n\n这个波动方程的解可以使用推迟格林函数找到：\n$$ \\bar{h}_{\\mu\\nu}(t, \\mathbf{x}) = 4 \\int \\frac{T_{\\mu\\nu}(t - |\\mathbf{x}-\\mathbf{x'}|, \\mathbf{x'})}{|\\mathbf{x}-\\mathbf{x'}|} d^3x' $$\n我们考虑一个位于远区的探测器，其与源的距离 $r=|\\mathbf{x}|$ 远大于源的尺寸 $|\\mathbf{x'}|$。我们可以做以下近似：\n1.  在分母中，$|\\mathbf{x}-\\mathbf{x'}| \\approx r$。\n2.  在时间参数中，$|\\mathbf{x}-\\mathbf{x'}| = \\sqrt{r^2 - 2\\mathbf{x}\\cdot\\mathbf{x'} + r'^2} \\approx r\\sqrt{1-2\\frac{\\mathbf{x}\\cdot\\mathbf{x'}}{r^2}} \\approx r - \\hat{n}\\cdot\\mathbf{x'}$，其中 $\\hat{n} = \\mathbf{x}/r$ 是观测方向。\n3.  对于一个缓慢移动的源（速度 $v \\ll 1$），源的变化发生在比源的光渡时间长得多的时间尺度上。因此，我们可以忽略时间参数中的 $\\hat{n}\\cdot\\mathbf{x'}$ 项，将其简化为推迟时间 $t_r = t - r$。\n\n利用这些近似，度规微扰的空间分量变为：\n$$ \\bar{h}_{ij}(t, \\mathbf{x}) \\approx \\frac{4}{r} \\int T_{ij}(t_r, \\mathbf{x'}) d^3x' $$\n我们需要将应力张量 $T_{ij}$ 的积分与质量分布联系起来。这可以通过能动量守恒 $\\partial_\\mu T^{\\mu\\nu} = 0$ 来实现。对于非相对论性源，我们使用以下恒等式：\n$$ \\frac{d^2}{dt^2} \\int T^{00} x^i x^j d^3x' = 2 \\int T^{ij} d^3x' $$\n在非相对论极限下，能量密度 $T^{00}$ 主要由质量密度 $\\rho$ 决定。我们定义质量分布的二阶矩（质量四极矩张量）为：\n$$ I_{ij}(t) = \\int \\rho(t, \\mathbf{x'}) x'_i x'_j d^3x' $$\n然后，$\\int T_{ij}(t_r) d^3x' \\approx \\frac{1}{2} \\ddot{I}_{ij}(t_r)$，其中双点表示二阶时间导数。将此代入 $\\bar{h}_{ij}$ 的表达式中，得到：\n$$ \\bar{h}_{ij}(t, \\mathbf{x}) \\approx \\frac{2}{r} \\ddot{I}_{ij}(t_r) $$\n物理上可观测的引力波应变是度规微扰的横向无迹（TT）部分 $h_{ij}^{TT}$。TT投影是通过算符 $\\Lambda_{ij,kl}(\\hat{n}) = P_{ik}P_{jl} - \\frac{1}{2}P_{ij}P_{kl}$ 实现的，其中 $P_{ij} = \\delta_{ij} - n_i n_j$ 是投影到传播方向 $\\hat{n}$ 的横向平面上的投影算子。任何张量的TT部分都是横向的（$n^i A_{ij}^{TT} = 0$）和无迹的（$A_{ii}^{TT} = 0$）。\n\n度规微扰的TT部分由 $h_{ij}^{TT} = \\Lambda_{ij,kl}(\\hat{n}) h_{kl}$ 给出。在远区辐射规范中，在不影响物理应变的规范变换下，$h_{ij} = \\bar{h}_{ij}$。因此，我们对 $\\bar{h}_{ij}$ 进行投影：\n$$ h_{ij}^{TT}(t, \\mathbf{x}) = \\frac{2}{r} \\Lambda_{ij,kl}(\\hat{n})\\ddot{I}_{kl}(t_r) $$\n问题要求的是与*无迹*质量四极矩的关系，其定义为：\n$$ Q_{ij}(t) = \\int \\rho(t, \\mathbf{x'}) \\left(x'_i x'_j - \\frac{1}{3}\\delta_{ij}|\\mathbf{x'}|^2\\right) d^3x' = I_{ij} - \\frac{1}{3}\\delta_{ij}I_{kk} $$\n可以证明 $\\Lambda_{ij,kl}\\ddot{I}_{kl} = \\Lambda_{ij,kl}\\ddot{Q}_{kl}$，因为投影算子 $\\Lambda_{ij,kl}$ 会消去任何迹部分。因此，该表达式可以用 $\\ddot{Q}_{kl}$ 来写。采用光度距离 $D$ 代替 $r$，我们得到所需的表达式：\n$$ h_{ij}^{TT}(t, \\mathbf{x}) = \\frac{2}{D} \\Lambda_{ij,kl}(\\hat{n}) \\ddot{Q}_{kl}(t-D) $$\n该表达式将TT度规微扰与在推迟时刻计算的无迹质量四极矩的二阶时间导数联系起来。\n\n### 第 2 部分：应用于双中子星系统\n\n我们现在将问题具体化到给定的双星系统。对于在 $x$-$y$ 平面内以轨道角频率 $\\Omega$ 运行的准圆形轨道，两个等质量 $m_1=m_2=m=1.4\\,M_{\\odot}$ 相对于质心的位置是 $\\mathbf{x}_1 = (R/2)(\\cos(\\Omega t), \\sin(\\Omega t), 0)$ 和 $\\mathbf{x}_2 = -\\mathbf{x}_1$。总间距为 $R$。\n质量四极矩为 $I_{ij} = \\sum_a m_a x_{a,i} x_{a,j} = m(x_{1,i}x_{1,j} + x_{2,i}x_{2,j}) = 2m x_{1,i}x_{1,j}$。\n一个更方便的形式是使用约化质量 $\\mu = m_1 m_2 / (m_1+m_2) = m/2 = 0.7\\,M_{\\odot}$ 和相对分离矢量 $\\mathbf{R} = \\mathbf{x}_1 - \\mathbf{x}_2 = (R\\cos(\\Omega t), R\\sin(\\Omega t), 0)$。那么 $I_{ij} = \\mu R_i R_j$。\n$$ I_{ij}(t) = \\mu R^2 \\begin{pmatrix} \\cos^2(\\Omega t)  \\cos(\\Omega t)\\sin(\\Omega t)  0 \\\\ \\cos(\\Omega t)\\sin(\\Omega t)  \\sin^2(\\Omega t)  0 \\\\ 0  0  0 \\end{pmatrix} $$\n二阶时间导数为：\n$$ \\ddot{I}_{ij}(t) = 2\\mu R^2 \\Omega^2 \\begin{pmatrix} -\\cos(2\\Omega t)  -\\sin(2\\Omega t) \\\\ -\\sin(2\\Omega t)  \\cos(2\\Omega t) \\end{pmatrix} $$\n该张量已经是无迹的，因此 $\\ddot{Q}_{ij} = \\ddot{I}_{ij}$。\n对于正向构型，观测者位于 $z$ 轴上，所以 $\\hat{n}=(0,0,1)$。投影张量 $P_{ij}$ 在 $x-y$ 平面上是单位矩阵。由于 $\\ddot{I}_{ij}$ 在该平面上已经是横向且无迹的，TT投影不会改变它：$\\ddot{I}_{ij}^{TT} = \\ddot{I}_{ij}$。\n因此，$h_{ij}^{TT} = \\frac{2}{D}\\ddot{I}_{ij}$。两个引力波偏振是：\n$$ h_+(t_r) = h_{11}^{TT} = -\\frac{4\\mu R^2\\Omega^2}{D} \\cos(2\\Omega t_r) $$\n$$ h_\\times(t_r) = h_{12}^{TT} = -\\frac{4\\mu R^2\\Omega^2}{D} \\sin(2\\Omega t_r) $$\n瞬时应变振幅 $h_0$ 是这些振荡的振幅：\n$$ h_0 = \\frac{4\\mu R^2\\Omega^2}{D} $$\n我们使用几何单位制下的开普勒第三定律，$M = \\Omega^2 R^3$，其中 $M=m_1+m_2$ 是总质量。这给出 $R^2 = (M/\\Omega^2)^{2/3}$。\n$$ h_0 = \\frac{4\\mu}{D} \\left(\\frac{M}{\\Omega^2}\\right)^{2/3} \\Omega^2 = \\frac{4\\mu M^{2/3}\\Omega^{2/3}}{D} $$\n引力波频率为 $f=2f_{orb}$。轨道角频率为 $\\Omega=2\\pi f_{orb}$。因此，如题所给，$\\Omega = \\pi f$。我们将此代入振幅表达式中：\n$$ h_0 = \\frac{4\\mu M^{2/3}(\\pi f)^{2/3}}{D} $$\n为了用啁啾质量 $M_c = \\mu^{3/5}M^{2/5}$ 来表示，我们注意到 $\\mu M^{2/3} = (\\mu^{3/5}M^{2/5})^{5/3} = M_c^{5/3}$。\n代入此式，得到应变振幅的最终表达式：\n$$ h_0 = \\frac{4 M_c^{5/3}(\\pi f)^{2/3}}{D} = \\frac{4 M_c}{D}(\\pi f M_c)^{2/3} $$\n\n### 数值计算\n\n我们已知：\n-   $m_1=m_2=1.4\\,M_{\\odot}$\n-   $f=100\\,\\mathrm{Hz} = 100\\,\\mathrm{s}^{-1}$\n-   $D=100\\,\\mathrm{Mpc}$\n-   $G=c=1$ 转换关系：$M_{\\odot} = 4.92549095\\times 10^{-6}\\,\\mathrm{s}$ 和 $1\\,\\mathrm{Mpc} = 1.02927125\\times 10^{14}\\,\\mathrm{s}$。\n\n首先，计算啁啾质量 $M_c$：\n对于等质量 $m_1=m_2=m$ 的情况，$M_c = \\frac{(m^2)^{3/5}}{(2m)^{1/5}} = m \\cdot 2^{-1/5}$。\n$ M_c = (1.4\\,M_\\odot) \\cdot 2^{-1/5} \\approx 1.21873\\,M_\\odot $\n\n将 $M_c$ 和 $D$ 转换为秒为单位：\n$ M_c = 1.21873 \\times (4.92549095\\times 10^{-6}\\,\\mathrm{s}) = 6.00280 \\times 10^{-6}\\,\\mathrm{s} $\n$ D = 100 \\times (1.02927125\\times 10^{14}\\,\\mathrm{s}) = 1.02927125 \\times 10^{16}\\,\\mathrm{s} $\n\n现在我们计算无量纲项 $(\\pi f M_c)$：\n$ \\pi f M_c = \\pi \\times (100\\,\\mathrm{s}^{-1}) \\times (6.00280 \\times 10^{-6}\\,\\mathrm{s}) \\approx 0.00188584 $\n\n接下来，我们计算应变振幅 $h_0$：\n$$ h_0 = \\frac{4 M_c}{D}(\\pi f M_c)^{2/3} $$\n$$ h_0 = \\frac{4 \\times (6.00280 \\times 10^{-6})}{1.02927125 \\times 10^{16}} \\times (0.00188584)^{2/3} $$\n$$ h_0 = (2.33281 \\times 10^{-21}) \\times (0.0152636) $$\n$$ h_0 = 3.5610 \\times 10^{-23} $$\n四舍五入到三位有效数字，瞬时应变振幅为 $3.56 \\times 10^{-23}$。", "answer": "$$\\boxed{3.56 \\times 10^{-23}}$$", "id": "3562196"}, {"introduction": "从引力波数据中提取物理信息是该领域的核心目标之一，特别是中子星的潮汐效应，它编码了核物质的状态方程。本练习将引导您应用贝叶斯模型选择这一强大框架，通过一个简化的思想实验来处理一个关键问题：数据是否支持一个包含潮汐效应的复杂模型，而非一个简单的点质量模型？通过计算贝叶斯因子，您将学会如何量化支持不同物理模型的证据强度。[@problem_id:3562203]", "problem": "考虑一个简化的、基于第一性原理的模型比较，用于分析来自双中子星系统的引力波旋近数据，重点关注数据是否支持潮汐效应。在一个由正交归一模板构建的、白化的二维充分统计量空间中进行全部计算。设数据向量为 $s = (x, y)$，其中 $x$ 是到点粒子模板上的匹配滤波器投影，$y$ 是到领头阶潮汐修正模板上的匹配滤波器投影。假设探测器噪声为零均值高斯噪声，每个分量的方差为1，且在 $x$ 和 $y$ 方向上相互独立。在两种模型下，点粒子振幅参数 $a$ 在 $x$ 方向上线性地引入，而在潮汐模型下，一个额外的潮汐参数 $\\lambda$ 在 $y$ 方向上线性地引入。采用零均值高斯先验 $a \\sim \\mathcal{N}(0, \\sigma_a^2)$ 和 $\\lambda \\sim \\mathcal{N}(0, \\sigma_\\lambda^2)$，这些先验反映了在这个白化基上有效投影的真实天体物理和核物质状态方程不确定性。点粒子模型排除了潮汐参数（等效于先验地将 $\\lambda$ 固定为0）。潮汐模型则包含具有指定先验的 $a$ 和 $\\lambda$ 两个参数。假设 $x$ 和 $y$ 是充分统计量，因此在给定参数的情况下，似然函数可以分解为关于这些分量的乘积。您必须完成以下任务：\n- 从上述假设出发，通过对高斯先验积分高斯似然函数，推导每个模型的贝叶斯证据，并构建支持潮汐模型相对于点粒子模型的贝叶斯因子，将其表示为 $y$ 和 $\\sigma_\\lambda$ 的函数。\n- 将潮汐效应的信噪比 (SNR) 定义为此白化基中 $y$ 的绝对值，该值为无量纲。使用决策阈值贝叶斯因子 $B_0 = 100$（解释为“决定性”支持），推导出支持潮汐模型的贝叶斯因子至少为 $B_0$ 所需的最小潮汐信噪比 $y_\\star(\\sigma_\\lambda)$ 的显式表达式。将 $y_\\star$ 表示为一个无单位的正实数。\n- 实现一个程序，对于一组测试用例，计算：\n    1) 给定 $(\\sigma_\\lambda, y)$ 的贝叶斯因子，以及\n    2) 在 $B_0 = 100$ 时，对于相同的 $\\sigma_\\lambda$ 的阈值潮汐信噪比 $y_\\star$。\n使用以下测试套件（每个元组为 $(\\sigma_\\lambda, y)$）：\n- 测试 1：$(1.0, 0.0)$，\n- 测试 2：$(1.5, 3.0)$，\n- 测试 3：$(3.0, 6.0)$。\n您的程序必须计算六个浮点数输出：上述测试的三个贝叶斯因子，后跟三个相应的 SNR 阈值 $y_\\star$（对于同一列表中的每个 $\\sigma_\\lambda$ 各一个），按此顺序排列。所有六个输出必须四舍五入到六位小数，并在一行上打印为方括号括起来的逗号分隔列表，例如 $[r_1,r_2,r_3,r_4,r_5,r_6]$。所有量都是无量纲的；不要包含任何物理单位或百分号。不使用角度，也无需以弧度或度为单位报告。", "solution": "该问题要求推导和计算来自双中子星并合的引力波信号的两个竞争模型的贝叶斯证据，构建贝叶斯因子，并确定潮汐效应的探测阈值。\n\n### 模型定义和贝叶斯框架\n\n设在白化充分统计量空间中的观测数据向量为 $s=(x, y)$。探测器噪声假定为零均值高斯噪声，每个分量的方差为1，且相互独立。我们比较两个模型：点粒子模型（$\\mathcal{M}_P$）和潮汐模型（$\\mathcal{M}_T$）。\n\n似然函数，即给定模型参数下数据的概率，源于噪声模型。如果真实信号为 $\\mu(\\theta)$，其中 $\\theta$ 代表模型参数，那么数据 $s = \\mu(\\theta) + n$，其中 $n \\sim \\mathcal{N}(0, I_2)$ 是噪声向量，$I_2$ 是 $2 \\times 2$ 单位矩阵。因此，似然函数为 $p(s|\\theta, \\mathcal{M}) = \\mathcal{N}(s|\\mu(\\theta), I_2)$。鉴于各分量的独立性，该似然函数可分解为 $p(x, y | \\theta, \\mathcal{M}) = p(x|\\theta, \\mathcal{M}) p(y|\\theta, \\mathcal{M})$。\n\n**模型1：点粒子（$\\mathcal{M}_P$）**\n在此模型下，信号没有潮汐分量，因此均值信号为 $\\mu_P = (a, 0)$。参数为 $a$，即点粒子振幅。似然函数为：\n$$p(x, y | a, \\mathcal{M}_P) = \\mathcal{N}(x|a, 1) \\mathcal{N}(y|0, 1) = \\frac{1}{2\\pi} \\exp\\left(-\\frac{(x-a)^2}{2} - \\frac{y^2}{2}\\right)$$\n参数 $a$ 的先验分布为零均值高斯分布：$p(a|\\mathcal{M}_P) = \\mathcal{N}(a|0, \\sigma_a^2)$。\n\n**模型2：潮汐（$\\mathcal{M}_T$）**\n在此模型下，存在潮汐分量。均值信号为 $\\mu_T = (a, \\lambda)$，其中 $\\lambda$ 是潮汐参数。参数集为 $\\theta = \\{a, \\lambda\\}$。似然函数为：\n$$p(x, y | a, \\lambda, \\mathcal{M}_T) = \\mathcal{N}(x|a, 1) \\mathcal{N}(y|\\lambda, 1) = \\frac{1}{2\\pi} \\exp\\left(-\\frac{(x-a)^2}{2} - \\frac{(y-\\lambda)^2}{2}\\right)$$\n参数的先验是独立的零均值高斯分布：$p(a|\\mathcal{M}_T) = \\mathcal{N}(a|0, \\sigma_a^2)$ 和 $p(\\lambda|\\mathcal{M}_T) = \\mathcal{N}(\\lambda|0, \\sigma_\\lambda^2)$。\n\n### 贝叶斯证据的推导\n\n模型 $\\mathcal{M}$ 的贝叶斯证据，记作 $\\mathcal{Z}_{\\mathcal{M}}$，是给定模型下数据的概率，通过对所有可能的参数值按其先验概率加权积分得到：\n$$\\mathcal{Z}_{\\mathcal{M}} = p(s|\\mathcal{M}) = \\int p(s|\\theta, \\mathcal{M}) p(\\theta|\\mathcal{M}) d\\theta$$\n\n**$\\mathcal{M}_P$ 的证据：**\n点粒子模型 $\\mathcal{Z}_P$ 的证据是：\n$$\\mathcal{Z}_P = \\int_{-\\infty}^{\\infty} p(x, y | a, \\mathcal{M}_P) p(a|\\mathcal{M}_P) da$$\n代入似然函数和先验的表达式：\n$$\\mathcal{Z}_P = \\int \\left(\\frac{1}{\\sqrt{2\\pi}} e^{-\\frac{(x-a)^2}{2}}\\right) \\left(\\frac{1}{\\sqrt{2\\pi}} e^{-\\frac{y^2}{2}}\\right) \\left(\\frac{1}{\\sqrt{2\\pi}\\sigma_a} e^{-\\frac{a^2}{2\\sigma_a^2}}\\right) da$$\n包含 $y$ 的项相对于积分变量 $a$ 是常数，可以提取出来：\n$$\\mathcal{Z}_P = \\left(\\frac{1}{\\sqrt{2\\pi}} e^{-\\frac{y^2}{2}}\\right) \\int \\left(\\frac{1}{\\sqrt{2\\pi}} e^{-\\frac{(x-a)^2}{2}}\\right) \\left(\\frac{1}{\\sqrt{2\\pi}\\sigma_a} e^{-\\frac{a^2}{2\\sigma_a^2}}\\right) da$$\n剩下的积分是 $x$ 的边际似然 $p(x|\\mathcal{M}_P)$。这是一个高斯似然对高斯先验积分的标准结果。$\\mathcal{N}(x|a, \\sigma_L^2)$ 对先验 $\\mathcal{N}(a|\\mu_P, \\sigma_P^2)$ 的积分得到的 $x$ 的边际似然为 $\\mathcal{N}(x|\\mu_P, \\sigma_L^2+\\sigma_P^2)$。在我们的情况下，$\\sigma_L^2=1$，$\\mu_P=0$，$\\sigma_P^2=\\sigma_a^2$。因此，该积分的计算结果为：\n$$p(x|\\mathcal{M}_P) = \\frac{1}{\\sqrt{2\\pi(1+\\sigma_a^2)}} \\exp\\left(-\\frac{x^2}{2(1+\\sigma_a^2)}\\right)$$\n将此结果与提取出的 $y$ 项结合，$\\mathcal{M}_P$ 的总证据为：\n$$\\mathcal{Z}_P = \\frac{1}{\\sqrt{2\\pi(1+\\sigma_a^2)}} \\exp\\left(-\\frac{x^2}{2(1+\\sigma_a^2)}\\right) \\cdot \\frac{1}{\\sqrt{2\\pi}} \\exp\\left(-\\frac{y^2}{2}\\right)$$\n\n**$\\mathcal{M}_T$ 的证据：**\n潮汐模型 $\\mathcal{Z}_T$ 的证据涉及对 $a$ 和 $\\lambda$ 的积分：\n$$\\mathcal{Z}_T = \\iint p(x, y | a, \\lambda, \\mathcal{M}_T) p(a|\\mathcal{M}_T) p(\\lambda|\\mathcal{M}_T) da d\\lambda$$\n由于似然函数的分解和先验的独立性，积分可以分离：\n$$\\mathcal{Z}_T = \\left( \\int p(x|a) p(a) da \\right) \\left( \\int p(y|\\lambda) p(\\lambda) d\\lambda \\right)$$\n对 $a$ 的积分与为 $\\mathcal{Z}_P$ 计算的积分相同。对 $\\lambda$ 的积分是类似的：我们有一个似然 $\\mathcal{N}(y|\\lambda, 1)$ 和一个先验 $\\mathcal{N}(\\lambda|0, \\sigma_\\lambda^2)$。结果是：\n$$p(y|\\mathcal{M}_T) = \\frac{1}{\\sqrt{2\\pi(1+\\sigma_\\lambda^2)}} \\exp\\left(-\\frac{y^2}{2(1+\\sigma_\\lambda^2)}\\right)$$\n因此，$\\mathcal{M}_T$ 的总证据是两个边际似然的乘积：\n$$\\mathcal{Z}_T = \\frac{1}{\\sqrt{2\\pi(1+\\sigma_a^2)}} \\exp\\left(-\\frac{x^2}{2(1+\\sigma_a^2)}\\right) \\cdot \\frac{1}{\\sqrt{2\\pi(1+\\sigma_\\lambda^2)}} \\exp\\left(-\\frac{y^2}{2(1+\\sigma_\\lambda^2)}\\right)$$\n\n### 贝叶斯因子的推导\n\n支持潮汐模型 $\\mathcal{M}_T$ 相对于点粒子模型 $\\mathcal{M}_P$ 的贝叶斯因子 $B_{TP}$ 是它们证据的比值：\n$$B_{TP} = \\frac{\\mathcal{Z}_T}{\\mathcal{Z}_P}$$\n代入 $\\mathcal{Z}_T$ 和 $\\mathcal{Z}_P$ 的表达式：\n$$B_{TP} = \\frac{\\frac{1}{\\sqrt{2\\pi(1+\\sigma_a^2)}} e^{-\\frac{x^2}{2(1+\\sigma_a^2)}} \\cdot \\frac{1}{\\sqrt{2\\pi(1+\\sigma_\\lambda^2)}} e^{-\\frac{y^2}{2(1+\\sigma_\\lambda^2)}}}{\\frac{1}{\\sqrt{2\\pi(1+\\sigma_a^2)}} e^{-\\frac{x^2}{2(1+\\sigma_a^2)}} \\cdot \\frac{1}{\\sqrt{2\\pi}} e^{-\\frac{y^2}{2}}}$$\n涉及 $x$ 和 $\\sigma_a$ 的项完全抵消，这表明支持或反对潮汐参数的证据仅取决于数据分量 $y$ 和先验宽度 $\\sigma_\\lambda$。\n$$B_{TP} = \\frac{\\frac{1}{\\sqrt{1+\\sigma_\\lambda^2}} \\exp\\left(-\\frac{y^2}{2(1+\\sigma_\\lambda^2)}\\right)}{\\exp\\left(-\\frac{y^2}{2}\\right)}$$\n通过合并指数项来简化表达式：\n$$B_{TP} = \\frac{1}{\\sqrt{1+\\sigma_\\lambda^2}} \\exp\\left(\\frac{y^2}{2} - \\frac{y^2}{2(1+\\sigma_\\lambda^2)}\\right)$$\n$$B_{TP} = \\frac{1}{\\sqrt{1+\\sigma_\\lambda^2}} \\exp\\left(\\frac{y^2}{2} \\left(1 - \\frac{1}{1+\\sigma_\\lambda^2}\\right)\\right)$$\n$$B_{TP} = \\frac{1}{\\sqrt{1+\\sigma_\\lambda^2}} \\exp\\left(\\frac{y^2}{2} \\left(\\frac{1+\\sigma_\\lambda^2 - 1}{1+\\sigma_\\lambda^2}\\right)\\right)$$\n这得到了作为 $y$ 和 $\\sigma_\\lambda$ 函数的贝叶斯因子的最终表达式：\n$$B_{TP}(y, \\sigma_\\lambda) = \\frac{1}{\\sqrt{1+\\sigma_\\lambda^2}} \\exp\\left( \\frac{y^2 \\sigma_\\lambda^2}{2(1+\\sigma_\\lambda^2)} \\right)$$\n\n### 阈值潮汐信噪比 $y_\\star$ 的推导\n\n潮汐信噪比 (SNR) 定义为 $|y|$。我们需要找到最小信噪比，记为 $y_\\star$，使得贝叶斯因子达到阈值 $B_0 = 100$。由于 $B_{TP}$ 取决于 $y^2$，我们可以求解 $y_\\star > 0$。\n我们设定 $B_{TP}(y_\\star, \\sigma_\\lambda) = B_0$：\n$$100 = \\frac{1}{\\sqrt{1+\\sigma_\\lambda^2}} \\exp\\left( \\frac{y_\\star^2 \\sigma_\\lambda^2}{2(1+\\sigma_\\lambda^2)} \\right)$$\n为了求解 $y_\\star$，我们首先分离指数项，然后取自然对数：\n$$100 \\sqrt{1+\\sigma_\\lambda^2} = \\exp\\left( \\frac{y_\\star^2 \\sigma_\\lambda^2}{2(1+\\sigma_\\lambda^2)} \\right)$$\n$$\\ln\\left(100 \\sqrt{1+\\sigma_\\lambda^2}\\right) = \\frac{y_\\star^2 \\sigma_\\lambda^2}{2(1+\\sigma_\\lambda^2)}$$\n现在，我们求解 $y_\\star^2$：\n$$y_\\star^2 = \\frac{2(1+\\sigma_\\lambda^2)}{\\sigma_\\lambda^2} \\ln\\left(100 (1+\\sigma_\\lambda^2)^{1/2}\\right)$$\n该表达式也可以利用对数的性质写成：\n$$y_\\star^2 = \\frac{2(1+\\sigma_\\lambda^2)}{\\sigma_\\lambda^2} \\left[ \\ln(100) + \\frac{1}{2}\\ln(1+\\sigma_\\lambda^2) \\right]$$\n取正平方根，得到阈值信噪比 $y_\\star$ 的最终表达式：\n$$y_\\star(\\sigma_\\lambda) = \\sqrt{\\frac{2(1+\\sigma_\\lambda^2)}{\\sigma_\\lambda^2} \\left[ \\ln(100) + \\frac{1}{2}\\ln(1+\\sigma_\\lambda^2) \\right]}$$\n这个表达式和贝叶斯因子的表达式将被用于编程计算所需的值。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the Bayes factor and threshold SNR for tidal effects in a\n    simplified gravitational wave data analysis problem.\n    \"\"\"\n    # Define the test cases from the problem statement as tuples of (sigma_lambda, y).\n    test_cases = [\n        (1.0, 0.0),\n        (1.5, 3.0),\n        (3.0, 6.0),\n    ]\n\n    B_0 = 100.0  # The decision threshold for the Bayes factor.\n    \n    bayes_factor_results = []\n    snr_threshold_results = []\n\n    # Calculate Bayes factors for each test case\n    for sigma_lambda, y in test_cases:\n        # The derived formula for the Bayes factor B_TP in favor of the tidal model\n        # B_TP = (1 / sqrt(1 + sigma_lambda^2)) * exp((y^2 * sigma_lambda^2) / (2 * (1 + sigma_lambda^2)))\n        \n        one_plus_sl_sq = 1.0 + sigma_lambda**2\n        ockham_factor = 1.0 / np.sqrt(one_plus_sl_sq)\n        \n        exponent = (y**2 * sigma_lambda**2) / (2.0 * one_plus_sl_sq)\n        \n        bayes_factor = ockham_factor * np.exp(exponent)\n        bayes_factor_results.append(bayes_factor)\n\n    # Calculate SNR thresholds for each unique sigma_lambda\n    # The unique values of sigma_lambda are the first elements of the test_cases tuples\n    sigma_lambda_values = [case[0] for case in test_cases]\n    \n    for sigma_lambda in sigma_lambda_values:\n        # The derived formula for the threshold SNR y_star\n        # y_star^2 = (2 * (1 + sigma_lambda^2) / sigma_lambda^2) * ln(B_0 * sqrt(1 + sigma_lambda^2))\n        \n        one_plus_sl_sq = 1.0 + sigma_lambda**2\n        \n        # log argument: B_0 * sqrt(1 + sigma_lambda^2)\n        log_arg = B_0 * np.sqrt(one_plus_sl_sq)\n        \n        # Prefactor: 2 * (1 + sigma_lambda^2) / sigma_lambda^2\n        prefactor = 2.0 * one_plus_sl_sq / (sigma_lambda**2)\n        \n        y_star_squared = prefactor * np.log(log_arg)\n        \n        y_star = np.sqrt(y_star_squared)\n        snr_threshold_results.append(y_star)\n\n    # Combine the results in the required order: [B1, B2, B3, y_star1, y_star2, y_star3]\n    all_results = bayes_factor_results + snr_threshold_results\n\n    # Format the final output as a comma-separated list of floats rounded to six decimal places,\n    # enclosed in square brackets.\n    output_str = f\"[{','.join(['{:.6f}'.format(r) for r in all_results])}]\"\n    \n    print(output_str)\n\nsolve()\n```", "id": "3562203"}, {"introduction": "除了提取天体物理信息外，引力波也为检验广义相对论本身提供了前所未有的机遇。本练习介绍了一种标准方法：在理论预测中引入一个参数化的偏离项，并计算实验能将该偏离约束到多小。您将通过动手实现费舍尔信息矩阵的计算，掌握这一用于预测引力波探测器科学潜力、评估其对新物理理论约束能力的重要工具。[@problem_id:3562194]", "problem": "要求您实现一个简化的、参数化的广义相对论（GR）检验，用于双中子星并合旋近过程中的潮汐动力学。您需要使用一个频域波形模型，并在稳态高斯噪声假设下采用 Fisher 信息近似。您的目标是在 5PN（后牛顿）阶的主导潮汐相位项中引入一个分数偏差参数，并利用解析功率谱密度（PSD）模型近似的当前探测器灵敏度，计算对该偏差的预期约束。\n\n从以下基本和核心定义出发，不使用任何无法从这些定义推导出的特殊捷径：\n\n- 匹配滤波中的信噪比（SNR）由噪声加权内积给出，其平方为\n$$\\rho^2 = 4 \\int_{f_{\\mathrm{low}}}^{f_{\\mathrm{high}}} \\frac{|h(f)|^2}{S_n(f)} \\, df,$$\n其中 $h(f)$ 是频域应变，$S_n(f)$ 是单边噪声功率谱密度（PSD）。积分单位为 $\\mathrm{Hz}$，$f$ 的单位为 $\\mathrm{Hz}$。\n\n- 在旋近的稳相近似中，主导阶的振幅取为\n$$|h(f)| = A f^{-7/6},$$\n其中 $A$ 是一个由源的距离和方向决定的常数振幅标度。您必须将 $A$ 视为一个自由归一化因子，其选择应使得在给定的频带和 PSD 下达到目标平方信噪比 $\\rho^2$。\n\n- 相位可以分为点粒子部分和潮汐部分。引入一个分数偏差参数 $\\delta$ 乘以广义相对论（GR）的潮汐相位项：\n$$\\Psi(f) = \\Psi_{\\mathrm{PP}}(f) + \\left(1+\\delta\\right)\\Psi_{\\mathrm{tidal}}(f).$$\n假设相位中 $5\\mathrm{PN}$ 阶的主导潮汐项可以写为\n$$\\Psi_{\\mathrm{tidal}}(f) = -\\frac{39}{2}\\,\\tilde{\\Lambda}\\,v^{10}, \\quad v = (\\pi M f)^{1/3},$$\n其中 $\\tilde{\\Lambda}$ 是无量纲的双星潮汐形变度（作为输入参数处理），$M$ 是几何单位制（$G=c=1$）下的总质量。您必须将质量从太阳质量转换为秒，以使 $M$ 与以 $\\mathrm{Hz}$ 为单位的 $f$ 兼容，换算公式为 $M = (G M_{\\odot}/c^3) \\times (m_1 + m_2)$，其中 $m_1$ 和 $m_2$ 是以太阳质量为单位的分量质量。使用 $G=6.67430\\times 10^{-11}\\,\\mathrm{m}^3\\,\\mathrm{kg}^{-1}\\,\\mathrm{s}^{-2}$，$c=2.99792458\\times 10^8\\,\\mathrm{m/s}$，以及 $M_{\\odot}=1.98847\\times 10^{30}\\,\\mathrm{kg}$。\n\n- 在大信噪比极限下，参数 $\\theta$ 的估计量的方差约等于 Fisher 信息矩阵元 $\\Gamma_{\\theta\\theta}$ 的逆：\n$$\\sigma_{\\theta}^{2} \\approx \\left(\\Gamma_{\\theta\\theta}\\right)^{-1}, \\quad \\Gamma_{\\theta\\theta} = 4\\int_{f_{\\mathrm{low}}}^{f_{\\mathrm{high}}} \\frac{\\left|\\partial h(f)/\\partial \\theta\\right|^2}{S_n(f)}\\,df.$$\n将此应用于 $\\theta=\\delta$。由于 $\\delta$ 仅出现在相位中，且在主导阶上 $\\partial h/\\partial \\delta = i\\,h(f)\\,\\Psi_{\\mathrm{tidal}}(f)$，您必须证明\n$$\\Gamma_{\\delta\\delta} = 4 \\int_{f_{\\mathrm{low}}}^{f_{\\mathrm{high}}} \\frac{|h(f)|^2\\,\\Psi_{\\mathrm{tidal}}(f)^2}{S_n(f)}\\,df.$$\n\n- 使用 SNR 归一化来消除未知振幅 $A$。定义\n$$w(f) \\equiv \\frac{f^{-7/3}}{S_n(f)}, \\quad I_0 \\equiv \\int_{f_{\\mathrm{low}}}^{f_{\\mathrm{high}}} w(f)\\,df, \\quad I_2 \\equiv \\int_{f_{\\mathrm{low}}}^{f_{\\mathrm{high}}} w(f)\\,\\Psi_{\\mathrm{tidal}}(f)^2\\,df.$$\n强制要求达到目标 SNR $\\rho$，这会固定 $A^2 = \\rho^2/[4 I_0]$，因此\n$$\\Gamma_{\\delta\\delta} = \\rho^2 \\frac{I_2}{I_0}, \\quad \\sigma_{\\delta} = \\left(\\Gamma_{\\delta\\delta}\\right)^{-1/2} = \\left(\\rho^2 \\frac{I_2}{I_0}\\right)^{-1/2}.$$\n\n- 将上限截止频率设置为接触频率和采样上限频率的最小值。使用两个半径分别为 $R_1$ 和 $R_2$ 的中子星的牛顿接触频率：\n$$f_{\\mathrm{contact}} = \\frac{1}{\\pi}\\sqrt{\\frac{G\\,(m_1+m_2)M_{\\odot}}{(R_1+R_2)^3}},$$\n$R_1$ 和 $R_2$ 的单位为 $\\mathrm{m}$，$f_{\\mathrm{high}} = \\min\\left(f_{\\mathrm{contact}}, f_{\\mathrm{ceiling}}\\right)$。使用 $f_{\\mathrm{ceiling}} = 2048\\,\\mathrm{Hz}$。下限截止频率是输入的 $f_{\\mathrm{low}}$（单位为 $\\mathrm{Hz}$）。如果 $f_{\\mathrm{high}} \\le f_{\\mathrm{low}}$，则为相应的测试用例返回非数值（not-a-number）。\n\n- 使用三种解析 PSD 模型来简化表示当前探测器的灵敏度（通过字符串标识符选择）：\n    - 类aLIGO的幂律混合模型：\n    $$S_{\\mathrm{pl}}(f) = \\left(\\frac{f_0}{f}\\right)^4 + 2 + \\left(\\frac{f}{f_0}\\right)^2,$$\n      其中 $f_0 = 100\\,\\mathrm{Hz}$。\n    - 平坦噪声：\n    $$S_{\\mathrm{flat}}(f) = 1.$$\n    - 低频主导模型：\n    $$S_{\\mathrm{lf}}(f) = \\left(\\frac{f_0}{f}\\right)^6 + 1,$$\n      其中 $f_0 = 100\\,\\mathrm{Hz}$。\n\n您的任务：\n\n- 实现一个程序，对下面描述的每个测试用例，通过对 $f$（单位为 $\\mathrm{Hz}$）进行数值积分来计算上述的 $\\sigma_{\\delta}$。\n\n- 单位：所有频率必须以 $\\mathrm{Hz}$ 为单位，用于相位计算的质量（以太阳质量为单位）必须使用 $M = (G M_{\\odot}/c^3)(m_1+m_2)$ 转换为秒，半径必须以 $\\mathrm{km}$ 提供并转换为 $\\mathrm{m}$ 用于计算接触频率。最终答案 $\\sigma_{\\delta}$ 是无量纲的，必须以十进制浮点数形式返回。\n\n- 不使用角度单位。\n\n- 不得假设或使用 $\\delta$ 本身的值；您是在 $\\delta=0$ 的零假设下计算预期约束。\n\n测试套件：\n\n为以下五个测试用例提供结果，结果表示为单行内用方括号括起来的逗号分隔列表。每个测试用例是一个元组 $(m_1, m_2, \\tilde{\\Lambda}, R_1, R_2, f_{\\mathrm{low}}, \\rho, \\mathrm{PSD})$，其中质量单位为太阳质量，半径单位为 $\\mathrm{km}$，$f_{\\mathrm{low}}$ 和 $\\rho$ 的单位分别为 $\\mathrm{Hz}$ 和无量纲，$\\mathrm{PSD}\\in\\{\\text{\"pl\"},\\text{\"flat\"},\\text{\"lf\"}\\}$ 用于选择模型。\n\n- 案例1（理想路径）：$(1.35, 1.35, 400.0, 12.0, 12.0, 20.0, 30.0, \\text{\"pl\"})$。\n- 案例2（低信噪比边缘情况）：$(1.35, 1.35, 400.0, 12.0, 12.0, 20.0, 10.0, \\text{\"pl\"})$。\n- 案例3（更硬的状态方程，更大的 $\\tilde{\\Lambda}$）：$(1.40, 1.40, 800.0, 13.0, 13.0, 20.0, 30.0, \\text{\"pl\"})$。\n- 案例4（更软的状态方程，更小的 $\\tilde{\\Lambda}$）：$(1.35, 1.35, 100.0, 11.0, 11.0, 20.0, 30.0, \\text{\"pl\"})$。\n- 案例5（更高的低频截止，备用 PSD）：$(1.30, 1.50, 400.0, 12.0, 12.0, 50.0, 30.0, \\text{\"lf\"})$。\n\n最终输出格式：\n\n您的程序应生成一行输出，其中包含五个测试用例的结果，形式为方括号内逗号分隔的列表（例如，$[\\mathrm{result}_1,\\mathrm{result}_2,\\mathrm{result}_3,\\mathrm{result}_4,\\mathrm{result}_5]$）。每个结果必须是表示 $\\sigma_{\\delta}$（无量纲）的十进制浮点数。", "solution": "目标是计算参数 $\\delta$ 的预期 $1$-$\\sigma$ 不确定度，记为 $\\sigma_{\\delta}$。该参数量化了双中子星并合旋近引力波信号的潮汐相位与广义相对论（GR）的偏离程度。此计算在 Fisher 信息矩阵形式体系内进行，并假设噪声为稳态高斯噪声。\n\n分析始于匹配滤波理论的两个基本表达式。信噪比（SNR）的平方 $\\rho^2$ 由噪声加权内积给出：\n$$\n\\rho^2 = 4 \\int_{f_{\\mathrm{low}}}^{f_{\\mathrm{high}}} \\frac{|h(f)|^2}{S_n(f)} \\, df\n$$\n其中 $h(f)$ 是频域引力波波形，$S_n(f)$ 是探测器噪声的单边功率谱密度（PSD），积分范围是灵敏频带 $[f_{\\mathrm{low}}, f_{\\mathrm{high}}]$。在大信噪比（SNR）极限下，波形参数 $\\theta$ 的无偏估计量的方差 $\\sigma_{\\theta}^2$ 近似为 Fisher 信息矩阵相应对角元素 $\\Gamma_{\\theta\\theta}$ 的逆：\n$$\n\\sigma_{\\theta}^{2} \\approx \\left(\\Gamma_{\\theta\\theta}\\right)^{-1}, \\quad \\text{where} \\quad \\Gamma_{\\theta\\theta} = 4\\int_{f_{\\mathrm{low}}}^{f_{\\mathrm{high}}} \\frac{\\left|\\frac{\\partial h(f)}{\\partial \\theta}\\right|^2}{S_n(f)}\\,df\n$$\n\n问题指定了一个简化的频域波形模型，其中振幅为 $|h(f)| = A f^{-7/6}$，$A$ 是一个未知的振幅常数。相位建模为 $\\Psi(f) = \\Psi_{\\mathrm{PP}}(f) + (1+\\delta)\\Psi_{\\mathrm{tidal}}(f)$，其中 $\\Psi_{\\mathrm{PP}}$ 是点粒子相位的贡献，$\\Psi_{\\mathrm{tidal}}$ 是潮汐相位的贡献。我们关心的参数是偏差 $\\delta$。\n\n我们必须首先推导 $\\Gamma_{\\delta\\delta}$ 的表达式。波形可以写成 $h(f) = |h(f)|e^{i\\Psi(f)}$。对 $\\delta$ 求导只影响相位部分：\n$$\n\\frac{\\partial h(f)}{\\partial \\delta} = |h(f)| \\frac{\\partial}{\\partial \\delta} \\left( e^{i\\Psi(f)} \\right) = |h(f)| e^{i\\Psi(f)} \\left( i \\frac{\\partial \\Psi(f)}{\\partial \\delta} \\right)\n$$\n根据 $\\Psi(f)$ 的定义，我们有 $\\frac{\\partial \\Psi(f)}{\\partial \\delta} = \\Psi_{\\mathrm{tidal}}(f)$。将其代回可得：\n$$\n\\frac{\\partial h(f)}{\\partial \\delta} = i |h(f)| e^{i\\Psi(f)} \\Psi_{\\mathrm{tidal}}(f) = i h(f) \\Psi_{\\mathrm{tidal}}(f)\n$$\n因此，其模的平方为：\n$$\n\\left|\\frac{\\partial h(f)}{\\partial \\delta}\\right|^2 = |i h(f) \\Psi_{\\mathrm{tidal}}(f)|^2 = |i|^2 |h(f)|^2 |\\Psi_{\\mathrm tidal}(f)|^2 = |h(f)|^2 \\Psi_{\\mathrm{tidal}}(f)^2\n$$\n因为 $\\Psi_{\\mathrm{tidal}}(f)$ 是一个实值函数。将此代入 Fisher 矩阵元的公式，得到所需的表达式：\n$$\n\\Gamma_{\\delta\\delta} = 4 \\int_{f_{\\mathrm{low}}}^{f_{\\mathrm{high}}} \\frac{|h(f)|^2 \\Psi_{\\mathrm{tidal}}(f)^2}{S_n(f)}\\,df\n$$\n\n通过将总信噪比（SNR）固定为目标值 $\\rho$，可以消除未知振幅 $A$。我们将 $|h(f)| = A f^{-7/6}$ 代入 $\\rho^2$ 和 $\\Gamma_{\\delta\\delta}$ 的方程中。让我们定义加权函数 $w(f) \\equiv \\frac{f^{-7/3}}{S_n(f)}$。那么：\n$$\n\\rho^2 = 4 A^2 \\int_{f_{\\mathrm{low}}}^{f_{\\mathrm{high}}} \\frac{f^{-7/3}}{S_n(f)} df = 4 A^2 \\int_{f_{\\mathrm{low}}}^{f_{\\mathrm{high}}} w(f) df \\equiv 4 A^2 I_0\n$$\n$$\n\\Gamma_{\\delta\\delta} = 4 A^2 \\int_{f_{\\mathrm{low}}}^{f_{\\mathrm{high}}} \\frac{f^{-7/3} \\Psi_{\\mathrm{tidal}}(f)^2}{S_n(f)} df = 4 A^2 \\int_{f_{\\mathrm{low}}}^{f_{\\mathrm{high}}} w(f) \\Psi_{\\mathrm{tidal}}(f)^2 df \\equiv 4 A^2 I_2\n$$\n从 $\\rho^2$ 的表达式中，我们解出常数项 $4A^2 = \\rho^2 / I_0$。将其代入 $\\Gamma_{\\delta\\delta}$ 的表达式可得：\n$$\n\\Gamma_{\\delta\\delta} = \\left(\\frac{\\rho^2}{I_0}\\right) I_2 = \\rho^2 \\frac{I_2}{I_0}\n$$\n那么，预期的不确定度 $\\sigma_{\\delta}$ 为：\n$$\n\\sigma_{\\delta} = (\\Gamma_{\\delta\\delta})^{-1/2} = \\left(\\rho^2 \\frac{I_2}{I_0}\\right)^{-1/2} = \\frac{1}{\\rho} \\sqrt{\\frac{I_0}{I_2}}\n$$\n这个最终表达式与源振幅 $A$ 无关，仅取决于目标信噪比 $\\rho$、噪声曲线 $S_n(f)$ 以及波形的相位和频率演化。\n\n$5\\mathrm{PN}$ 阶的主导潮汐相位的具体形式为：\n$$\n\\Psi_{\\mathrm{tidal}}(f) = -\\frac{39}{2}\\,\\tilde{\\Lambda}\\,v^{10}, \\quad \\text{with} \\quad v = (\\pi M f)^{1/3}\n$$\n这里，$\\tilde{\\Lambda}$ 是无量纲的双星潮汐形变度，$M$ 是几何单位制（单位为秒）下的总质量。总质量 $M$ 由分量质量 $m_1$ 和 $m_2$（单位为太阳质量 $M_{\\odot}$）通过转换因子 $M_{\\text{s/Msun}} = G M_{\\odot}/c^3$ 得到，即 $M = (m_1+m_2) \\times M_{\\text{s/Msun}}$。使用给定的常数 $G=6.67430\\times 10^{-11}\\,\\mathrm{m}^3\\,\\mathrm{kg}^{-1}\\,\\mathrm{s}^{-2}$，$c=2.99792458\\times 10^8\\,\\mathrm{m/s}$ 和 $M_{\\odot}=1.98847\\times 10^{30}\\,\\mathrm{kg}$，转换因子约为 $4.92549 \\times 10^{-6}\\,\\mathrm{s}/M_{\\odot}$。结合这些，$\\Psi_{\\mathrm{tidal}}(f)$ 可以写为：\n$$\n\\Psi_{\\mathrm{tidal}}(f) = -\\frac{39}{2}\\,\\tilde{\\Lambda}\\,(\\pi M f)^{10/3}\n$$\n\n积分的频率范围 $[f_{\\mathrm{low}}, f_{\\mathrm{high}}]$ 由探测器的低频灵敏度极限 $f_{\\mathrm{low}}$ 和一个上限截止频率 $f_{\\mathrm{high}} = \\min(f_{\\mathrm{contact}}, f_{\\mathrm{ceiling}})$ 决定。频率上限固定为 $f_{\\mathrm{ceiling}} = 2048\\,\\mathrm{Hz}$。接触频率近似为接触时的牛顿轨道频率：\n$$\nf_{\\mathrm{contact}} = \\frac{1}{\\pi}\\sqrt{\\frac{G(m_1+m_2)M_{\\odot}}{(R_1+R_2)^3}}\n$$\n其中半径 $R_1, R_2$ 必须以米为单位。\n\n因此，$\\sigma_{\\delta}$ 的计算简化为在频率范围 $[f_{\\mathrm{low}}, f_{\\mathrm{high}}]$ 上对两个积分 $I_0$ 和 $I_2$ 进行数值评估。被积函数取决于所选的 PSD 模型 $S_n(f)$，它们以解析函数形式给出：\n\\begin{itemize}\n    \\item `pl`: $S_{\\mathrm{pl}}(f) = (f_0/f)^4 + 2 + (f/f_0)^2$ with $f_0=100\\,\\mathrm{Hz}$\n    \\item `flat`: $S_{\\mathrm{flat}}(f) = 1$\n    \\item `lf`: $S_{\\mathrm{lf}}(f) = (f_0/f)^6 + 1$ with $f_0=100\\,\\mathrm{Hz}$\n\\end{itemize}\n积分 $I_0$ 和 $I_2$ 可以表示为：\n$$\nI_0 = \\int_{f_{\\mathrm{low}}}^{f_{\\mathrm{high}}} \\frac{f^{-7/3}}{S_n(f)} df\n$$\n$$\nI_2 = \\int_{f_{\\mathrm{low}}}^{f_{\\mathrm{high}}} \\frac{f^{-7/3}}{S_n(f)} \\left(-\\frac{39}{2}\\,\\tilde{\\Lambda}\\,(\\pi M f)^{10/3}\\right)^2 df = \\left(\\frac{39}{2}\\tilde{\\Lambda}\\right)^2 (\\pi M)^{20/3} \\int_{f_{\\mathrm{low}}}^{f_{\\mathrm{high}}} \\frac{f^{13/3}}{S_n(f)} df\n$$\n这种因式分解在数值计算上是有利的。算法将为每个测试用例计算这些积分，并组合它们以求得 $\\sigma_{\\delta}$。", "answer": "```python\nimport numpy as np\nfrom scipy import integrate\n\ndef solve():\n    \"\"\"\n    Computes the projected 1-sigma uncertainty (sigma_delta) on a fractional GR\n    deviation parameter for tidal dynamics in binary neutron star inspirals.\n    \"\"\"\n    \n    # Define physical constants\n    G = 6.67430e-11  # m^3 kg^-1 s^-2\n    C = 2.99792458e8  # m/s\n    M_SOLAR = 1.98847e30  # kg\n    \n    # Conversion factor from solar mass to seconds\n    M_SOLAR_IN_S = (G * M_SOLAR) / (C**3)\n    \n    # Test cases: (m1, m2, Lambda_tilde, R1_km, R2_km, f_low, rho, psd_model_str)\n    # m_i in M_solar, R_i in km, f_low in Hz\n    test_cases = [\n        (1.35, 1.35, 400.0, 12.0, 12.0, 20.0, 30.0, \"pl\"),\n        (1.35, 1.35, 400.0, 12.0, 12.0, 20.0, 10.0, \"pl\"),\n        (1.40, 1.40, 800.0, 13.0, 13.0, 20.0, 30.0, \"pl\"),\n        (1.35, 1.35, 100.0, 11.0, 11.0, 20.0, 30.0, \"pl\"),\n        (1.30, 1.50, 400.0, 12.0, 12.0, 50.0, 30.0, \"lf\"),\n    ]\n\n    results = []\n\n    for case in test_cases:\n        m1, m2, Lambda_tilde, R1_km, R2_km, f_low, rho, psd_model = case\n        \n        # 1. Calculate case-specific parameters\n        m_total_solar = m1 + m2\n        M_geom = m_total_solar * M_SOLAR_IN_S  # Total mass in seconds\n\n        R1_m = R1_km * 1000.0\n        R2_m = R2_km * 1000.0\n        \n        # 2. Determine integration frequency limits\n        f_ceiling = 2048.0\n        \n        # Calculate contact frequency in Hz (all units in SI)\n        f_contact_num = G * m_total_solar * M_SOLAR\n        f_contact_den = (R1_m + R2_m)**3\n        f_contact = (1.0 / np.pi) * np.sqrt(f_contact_num / f_contact_den)\n        \n        f_high = min(f_contact, f_ceiling)\n        \n        # Handle invalid frequency range\n        if f_high = f_low:\n            results.append(np.nan)\n            continue\n            \n        # 3. Define Power Spectral Density (PSD) function\n        f0 = 100.0\n        if psd_model == \"pl\":\n            Sn = lambda f: (f0 / f)**4 + 2.0 + (f / f0)**2\n        elif psd_model == \"flat\":\n            Sn = lambda f: 1.0\n        elif psd_model == \"lf\":\n            Sn = lambda f: (f0 / f)**6 + 1.0\n        else:\n            raise ValueError(f\"Invalid PSD model: {psd_model}\")\n\n        # 4. Define integrands for I0 and I2\n        # Integrand for I0 = integral(f**(-7/3) / S_n(f) df)\n        integrand0 = lambda f: f**(-7.0/3.0) / Sn(f)\n        \n        # Integrand for the frequency-dependent part of I2\n        # I2 = const_factor * integral(f**(13/3) / S_n(f) df)\n        integrand_for_I2 = lambda f: f**(13.0/3.0) / Sn(f)\n        \n        # 5. Perform numerical integration\n        # Set a higher limit for subdivisions for better accuracy\n        integration_opts = {'limit': 200}\n        I0, _ = integrate.quad(integrand0, f_low, f_high, **integration_opts)\n        integral_part_of_I2, _ = integrate.quad(integrand_for_I2, f_low, f_high, **integration_opts)\n        \n        # 6. Assemble I2 and calculate sigma_delta\n        # I2 = (39/2 * Lambda_tilde)^2 * (pi*M)^(20/3) * integral_part_of_I2\n        tidal_const_factor = ((39.0 / 2.0 * Lambda_tilde)**2 * \n                              (np.pi * M_geom)**(20.0 / 3.0))\n        I2 = tidal_const_factor * integral_part_of_I2\n\n        if I2 == 0 or I0 == 0:\n            sigma_delta = np.inf\n        else:\n            # sigma_delta = (1/rho) * sqrt(I0/I2)\n            Gamma_deltadelta = rho**2 * (I2 / I0)\n            sigma_delta = 1.0 / np.sqrt(Gamma_deltadelta)\n            \n        results.append(sigma_delta)\n        \n    # Final print statement in the exact required format\n    print(f\"[{','.join(f'{r:.15g}' for r in results)}]\")\n\nsolve()\n```", "id": "3562194"}]}