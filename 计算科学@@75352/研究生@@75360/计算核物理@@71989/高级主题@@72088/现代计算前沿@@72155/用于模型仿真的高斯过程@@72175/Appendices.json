{"hands_on_practices": [{"introduction": "在高斯过程模拟中，“白化项”（nugget）不仅仅是一个为了数值稳定性的技术调整，它在模拟含噪声的计算机实验时扮演着核心角色。本练习将探讨白化项如何影响模型对观测噪声的解释，并揭示其在经典的偏差-方差权衡中的关键作用。通过分析白化项从零到无穷大变化时模型的行为，您将深刻理解模型从过拟合到欠拟合的转变过程。", "problem": "一个研究团队正在模拟一个带噪声的中子输运蒙特卡洛代码。对于每个输入设置 $x \\in \\mathbb{R}^d$（例如，编码了材料密度和截面乘子），该代码返回一个感兴趣的潜在量 $f(x)$（如有效增殖因子 $k_{\\mathrm{eff}}$）的随机估计。在设计输入点 $\\{x_i\\}_{i=1}^n$ 处，由于粒子历史数有限，单次运行的代码输出被建模为 $y_i = f(x_i) + \\varepsilon_i$，其中 $\\varepsilon_i \\sim \\mathcal{N}(0,\\tau_i^2)$ 是独立的，$\\tau_i^2 \\propto 1/N_i$，$N_i$ 是在 $x_i$ 处模拟的粒子历史数。该代理模型对潜在函数 $f$ 设置了一个高斯过程先验 $f \\sim \\mathcal{GP}(m(\\cdot), k_\\theta(\\cdot,\\cdot))$，其均值函数为 $m$，协方差核为 $k_\\theta$。它使用具有同方差块金方差 $\\sigma_n^2$ 的高斯似然，因此观测模型为 $\\mathbf{y} \\mid \\mathbf{f} \\sim \\mathcal{N}(\\mathbf{f}, \\sigma_n^2 I_n)$，其中 $I_n$ 是 $n \\times n$ 的单位矩阵。在本次讨论中，超参数 $\\theta$ 和 $\\sigma_n^2$ 被视为固定的。\n\n通过对先验和似然所蕴含的联合高斯分布进行条件化，定义潜在函数 $f(x)$ 的代理模型后验均值预测器 $\\mu_*(x)$ 及其后验方差 $\\sigma_*^2(x)$。将代理模型在测试输入 $x$ 处的偏差定义为 $b(x) = \\mathbb{E}_{\\varepsilon}[\\mu_*(x)] - f(x)$，其中期望是针对相同设计点 $\\{x_i\\}$ 上的重复蒙特卡洛噪声实现 $\\{\\varepsilon_i\\}$ 计算的；并将估计量方差定义为在这些重复中计算的 $v(x) = \\operatorname{Var}_{\\varepsilon}[\\mu_*(x)]$。考虑当块金值 $\\sigma_n^2$ 从0变化到非常大的值（形式上为 $\\sigma_n^2 \\to \\infty$）时，这些量以及后验方差 $\\sigma_*^2(x)$ 的行为，同时保持设计 $\\{x_i\\}$ 和核函数 $k_\\theta$ 固定。\n\n在此情境下，下列哪些陈述是正确的？\n\nA. 如果在数据实际上是带噪声的情况下设置 $\\sigma_n^2 = 0$，代理模型将在训练输入点上对观测值 $y_i$进行插值，导致对 $f$ 的偏差较低，但在蒙特卡洛重复实验中估计量方差 $v(x)$ 较高，并且潜在函数 $f$ 在任何训练输入 $x_i$ 处的后验方差都将坍缩到0。\n\nB. 当 $\\sigma_n^2 \\to \\infty$ 时，后验均值 $\\mu_*(x)$ 回归到先验均值 $m(x)$，后验方差 $\\sigma_*^2(x)$ 趋近于先验方差 $k_\\theta(x,x)$，这反映了来自数据的信息损失。在此极限下，估计量方差 $v(x)$ 减小，而偏差的绝对值 $|b(x)|$ 增加，除非 $m(x) = f(x)$。\n\nC. 当每个设计点的蒙特卡洛噪声方差 $\\{\\tau_i^2\\}$ 可用时，模拟带噪声的蒙特卡洛代码的最优选择总是设置 $\\sigma_n^2 = 0$，因为高斯过程核 $k_\\theta$ 可以通过其长度尺度和幅度来学习随机噪声。\n\nD. 即使对于确定性代码（因此真实的观测噪声为0），引入一个小的正常数块金值（有时称为数值抖动）也可以改善协方差矩阵 $K_\\theta + \\sigma_n^2 I_n$ 的条件数，从而减少矩阵求逆中的数值误差。\n\nE. 增加 $\\sigma_n^2$ 总会减小在所有测试输入 $x$ 处的后验方差 $\\sigma_*^2(x)$，因为随着块金值的增长，模型会忽略噪声波动。\n\n选择所有正确选项。", "solution": "首先，我们将验证问题陈述的科学合理性、一致性和清晰度。\n\n### 第1步：提取已知条件\n- 输入空间为 $x \\in \\mathbb{R}^d$。\n- 感兴趣的量是一个潜在函数 $f(x)$。\n- 一个带噪声的蒙特卡洛代码在设计输入点 $\\{x_i\\}_{i=1}^n$ 处提供观测值。\n- 单次运行的代码输出被建模为 $y_i = f(x_i) + \\varepsilon_i$。\n- 真实的观测噪声为 $\\varepsilon_i \\sim \\mathcal{N}(0,\\tau_i^2)$，且 $\\varepsilon_i$ 是独立的。\n- 真实的噪声方差与模拟投入 $N_i$ 相关，关系为 $\\tau_i^2 \\propto 1/N_i$。\n- 代理模型对潜在函数使用高斯过程（GP）先验：$f \\sim \\mathcal{GP}(m(\\cdot), k_\\theta(\\cdot,\\cdot))$。\n- 代理模型使用具有同方差块金方差 $\\sigma_n^2$ 的高斯似然：$\\mathbf{y} \\mid \\mathbf{f} \\sim \\mathcal{N}(\\mathbf{f}, \\sigma_n^2 I_n)$，其中 $I_n$ 是 $n \\times n$ 单位矩阵。\n- 超参数 $\\theta$ 和 $\\sigma_n^2$ 被视为固定的。\n- 代理模型对 $f(x)$ 的后验均值为 $\\mu_*(x)$。\n- 代理模型对 $f(x)$ 的后验方差为 $\\sigma_*^2(x)$。\n- 代理模型的偏差定义为 $b(x) = \\mathbb{E}_{\\varepsilon}[\\mu_*(x)] - f(x)$，其中期望是针对真实噪声 $\\{\\varepsilon_i\\}$ 的实现计算的。\n- 估计量方差定义为 $v(x) = \\operatorname{Var}_{\\varepsilon}[\\mu_*(x)]$。\n- 核心任务是分析当 $\\sigma_n^2$ 从0变化到 $\\infty$ 时，$\\mu_*(x)$、$\\sigma_*^2(x)$、$b(x)$ 和 $v(x)$ 的行为。\n\n### 第2步：使用提取的已知条件进行验证\n- **科学基础：** 该问题牢固地植根于用于回归的高斯过程理论，这是机器学习和统计学中一种标准且强大的技术。将其应用于模拟计算机实验，特别是物理学中带噪声的蒙特卡洛代码，是GP的一个主要用例。偏差和方差的定义是分析估计量的标准方法。该设置在科学和数学上都是合理的。\n- **适定性：** 该问题是适定的。具有高斯先验和似然的标准GP回归框架导出一个良定义的后验分布。后验均值和方差的方程是唯一的，并且可以解析推导。要分析的量（$b(x)$ 和 $v(x)$）有明确的定义，它们在指定极限下的行为可以被确定。\n- **客观性：** 该问题使用精确、客观和标准的数学术语进行陈述。问题设置中没有主观或基于观点的声明。\n- **完整性和一致性：** 该问题是自洽的。它提供了先验、似然模型和所有必要的定义。问题刻意区分了真实的异方差噪声模型（$\\tau_i^2$）和代理模型假设的同方差噪声模型（$\\sigma_n^2$），这代表了一种模型设定错误的情况。这不是一个矛盾，而是该问题的一个关键特征，在实践中很常见，也是题目所要探讨的。\n- **其他缺陷：** 该问题并非不切实际、不适定、微不足道或无法验证。它代表了高级统计建模中的一个标准场景。\n\n### 第3步：结论与行动\n问题陈述是有效的。我们将推导完整的解决方案。\n\n### 核心方程的推导\n\n给定GP先验 $f \\sim \\mathcal{GP}(m, k_\\theta)$ 和似然 $\\mathbf{y} \\mid \\mathbf{f} \\sim \\mathcal{N}(\\mathbf{f}, \\sigma_n^2 I_n)$，在测试点 $x$ 的潜在函数 $f(x)$ 的后验分布是一个高斯分布，$f(x) \\mid \\mathbf{y} \\sim \\mathcal{N}(\\mu_*(x), \\sigma_*^2(x))$，其中 $\\mathbf{y} = [y_1, \\dots, y_n]^T$。后验均值和方差由以下公式给出：\n$$\n\\mu_*(x) = m(x) + \\mathbf{k}_*(x)^T (K_\\theta + \\sigma_n^2 I_n)^{-1} (\\mathbf{y} - \\mathbf{m})\n$$\n$$\n\\sigma_*^2(x) = k_\\theta(x,x) - \\mathbf{k}_*(x)^T (K_\\theta + \\sigma_n^2 I_n)^{-1} \\mathbf{k}_*(x)\n$$\n此处，$K_\\theta$ 是 $n \\times n$ 的核矩阵，其元素为 $(K_\\theta)_{ij} = k_\\theta(x_i, x_j)$；$\\mathbf{k}_*(x)$ 是一个 $n \\times 1$ 的向量，表示训练点和测试点 $x$ 之间的协方差，其元素为 $(\\mathbf{k}_*(x))_i = k_\\theta(x_i, x)$；$\\mathbf{m}$ 是训练点处的先验均值向量，$(\\mathbf{m})_i = m(x_i)$。\n\n观测数据 $\\mathbf{y}$ 是一个随机过程的实现：$\\mathbf{y} = \\mathbf{f}_{\\text{true}} + \\boldsymbol{\\varepsilon}$，其中 $\\mathbf{f}_{\\text{true}} = [f(x_1), \\dots, f(x_n)]^T$ 并且 $\\boldsymbol{\\varepsilon} \\sim \\mathcal{N}(0, \\Sigma_\\tau)$，其中 $\\Sigma_\\tau = \\text{diag}(\\tau_1^2, \\dots, \\tau_n^2)$。\n\n将此代入后验均值表达式：\n$$\n\\mu_*(x) = m(x) + \\mathbf{k}_*(x)^T (K_\\theta + \\sigma_n^2 I_n)^{-1} (\\mathbf{f}_{\\text{true}} + \\boldsymbol{\\varepsilon} - \\mathbf{m})\n$$\n偏差 $b(x)$ 和估计量方差 $v(x)$ 取决于 $\\mu_*(x)$ 在真实噪声 $\\boldsymbol{\\varepsilon}$ 的实现上的统计特性：\n\n**偏差：** $b(x) = \\mathbb{E}_{\\boldsymbol{\\varepsilon}}[\\mu_*(x)] - f(x)$\n$$\n\\mathbb{E}_{\\boldsymbol{\\varepsilon}}[\\mu_*(x)] = m(x) + \\mathbf{k}_*(x)^T (K_\\theta + \\sigma_n^2 I_n)^{-1} (\\mathbf{f}_{\\text{true}} - \\mathbf{m}) + \\mathbf{k}_*(x)^T (K_\\theta + \\sigma_n^2 I_n)^{-1} \\mathbb{E}_{\\boldsymbol{\\varepsilon}}[\\boldsymbol{\\varepsilon}]\n$$\n由于 $\\mathbb{E}_{\\boldsymbol{\\varepsilon}}[\\boldsymbol{\\varepsilon}] = \\mathbf{0}$，偏差为：\n$$\nb(x) = \\left( m(x) + \\mathbf{k}_*(x)^T (K_\\theta + \\sigma_n^2 I_n)^{-1} (\\mathbf{f}_{\\text{true}} - \\mathbf{m}) \\right) - f(x)\n$$\n\n**估计量方差：** $v(x) = \\operatorname{Var}_{\\boldsymbol{\\varepsilon}}[\\mu_*(x)]$\n$$\nv(x) = \\operatorname{Var}_{\\boldsymbol{\\varepsilon}}\\left[\\mathbf{k}_*(x)^T (K_\\theta + \\sigma_n^2 I_n)^{-1} \\boldsymbol{\\varepsilon}\\right]\n$$\n使用公式 $\\operatorname{Var}(A\\mathbf{z}) = A\\operatorname{Cov}(\\mathbf{z})A^T$：\n$$\nv(x) = \\mathbf{k}_*(x)^T (K_\\theta + \\sigma_n^2 I_n)^{-1} \\Sigma_\\tau (K_\\theta + \\sigma_n^2 I_n)^{-1} \\mathbf{k}_*(x)\n$$\n注意矩阵 $(K_\\theta + \\sigma_n^2 I_n)^{-1}$ 是对称的。\n\n### 逐项分析\n\n**A. 如果在数据实际上是带噪声的情况下设置 $\\sigma_n^2 = 0$ ...**\n\n- **插值：** 对于 $\\sigma_n^2 = 0$，在训练点 $x_j$ 处的后验均值为 $\\mu_*(x_j) = m(x_j) + \\mathbf{k}_*(x_j)^T K_\\theta^{-1} (\\mathbf{y} - \\mathbf{m})$。由于 $\\mathbf{k}_*(x_j)$ 是 $K_\\theta$ 的第j列，所以 $\\mathbf{k}_*(x_j)^T K_\\theta^{-1}$ 是第j个标准基向量 $\\mathbf{e}_j^T$。因此，$\\mu_*(x_j) = m(x_j) + \\mathbf{e}_j^T(\\mathbf{y} - \\mathbf{m}) = m_j + (y_j - m_j) = y_j$。代理模型精确地对带噪声的数据 $\\mathbf{y}$ 进行插值，这是过拟合的一个标志。这部分是正确的。\n- **在 $x_i$ 处的后验方差：** 对于 $\\sigma_n^2 = 0$，在 $x_j$ 处的后验方差为 $\\sigma_*^2(x_j) = k_\\theta(x_j, x_j) - \\mathbf{k}_*(x_j)^T K_\\theta^{-1} \\mathbf{k}_*(x_j)$。使用 $\\mathbf{k}_*(x_j)^T K_\\theta^{-1} = \\mathbf{e}_j^T$，这变成 $\\sigma_*^2(x_j) = k_\\theta(x_j, x_j) - \\mathbf{e}_j^T \\mathbf{k}_*(x_j) = k_\\theta(x_j, x_j) - (K_\\theta)_{jj} = 0$。模型对训练点处的潜在函数值变得完全确定，将其值赋为带噪声的观测值。这部分是正确的。\n- **估计量方差 $v(x)$：** 对于 $\\sigma_n^2 = 0$, $v(x) = \\mathbf{k}_*(x)^T K_\\theta^{-1} \\Sigma_\\tau K_\\theta^{-1} \\mathbf{k}_*(x)$。由于数据是带噪声的，真实的噪声协方差 $\\Sigma_\\tau$ 具有正的对角线元素，因此 $\\Sigma_\\tau$ 不是零矩阵。逆核矩阵 $K_\\theta^{-1}$ 通常会包含很大的元素，特别是对于间距很近的点。最终的 $v(x)$ 会很大，因为预测器 $\\mu_*(x)$ 必须剧烈变化以穿过每个带噪声的数据点，这使其对具体的噪声实现 $\\boldsymbol{\\varepsilon}$ 高度敏感。“高的估计量方差”是正确的。\n- **偏差：** 平均预测器为 $\\mathbb{E}_{\\boldsymbol{\\varepsilon}}[\\mu_*(x)] = m(x) + \\mathbf{k}_*(x)^T K_\\theta^{-1}(\\mathbf{f}_{\\text{true}} - \\mathbf{m})$。这是对真实的、去噪后的函数值的GP插值。如果真实函数 $f(x)$ 能被GP模型很好地近似，那么这个插值的偏差 $b(x) = \\mathbb{E}_{\\boldsymbol{\\varepsilon}}[\\mu_*(x)] - f(x)$ 可以被认为是“低的”。在偏差-方差权衡的背景下，这种情况代表了一个高方差、低偏差的状态。因此，整个陈述是准确的。\n\n结论：**正确**。\n\n**B. 当 $\\sigma_n^2 \\to \\infty$ 时，后验均值 $\\mu_*(x)$ 回归到先验均值 $m(x)$ ...**\n\n- **$\\mu_*(x)$ 的极限：** 当 $\\sigma_n^2 \\to \\infty$ 时，$(K_\\theta + \\sigma_n^2 I_n) \\approx \\sigma_n^2 I_n$。其逆为 $(K_\\theta + \\sigma_n^2 I_n)^{-1} \\approx \\frac{1}{\\sigma_n^2}I_n$。所以，更新项 $\\mathbf{k}_*(x)^T (K_\\theta + \\sigma_n^2 I_n)^{-1} (\\mathbf{y} - \\mathbf{m}) \\to \\mathbf{0}$。因此，$\\lim_{\\sigma_n^2 \\to \\infty} \\mu_*(x) = m(x)$。后验均值回归到先验均值。这是正确的。\n- **$\\sigma_*^2(x)$ 的极限：** 当 $\\sigma_n^2 \\to \\infty$ 时，项 $\\mathbf{k}_*(x)^T (K_\\theta + \\sigma_n^2 I_n)^{-1} \\mathbf{k}_*(x) \\to \\mathbf{0}$。因此，$\\lim_{\\sigma_n^2 \\to \\infty} \\sigma_*^2(x) = k_\\theta(x,x)$。后验方差回归到先验方差。这反映了来自数据的信息的完全丧失。这是正确的。\n- **估计量方差 $v(x)$：** 当 $\\sigma_n^2 \\to \\infty$ 时，$v(x) \\approx \\mathbf{k}_*(x)^T (\\frac{1}{\\sigma_n^2}I_n) \\Sigma_\\tau (\\frac{1}{\\sigma_n^2}I_n) \\mathbf{k}_*(x) = \\frac{1}{\\sigma_n^4} \\mathbf{k}_*(x)^T \\Sigma_\\tau \\mathbf{k}_*(x)$。这显然趋近于0。估计量变得确定性（$\\mu_*(x) \\to m(x)$）并且对噪声 $\\boldsymbol{\\varepsilon}$ 不敏感。这是正确的。\n- **偏差 $|b(x)|$：** 当 $\\sigma_n^2 \\to \\infty$ 时，$\\mathbb{E}_{\\boldsymbol{\\varepsilon}}[\\mu_*(x)] \\to m(x)$。极限偏差为 $m(x) - f(x)$。除非先验均值恰好与真实函数完全匹配，否则此偏差将非零。随着数据越来越被忽略，模型欠拟合得更严重，偏差增加到 $|m(x) - f(x)|$。这是正确的。\n此陈述的所有部分都准确地描述了极端欠拟合的情况。\n\n结论：**正确**。\n\n**C. 当每个设计点的蒙特卡洛噪声方差 $\\{\\tau_i^2\\}$ 可用时，...**\n\n这个陈述是根本上错误的。\n- 核函数 $k_\\theta$ 的作用是为潜在函数 $f(x)$ 的协方差建模，即其平滑度、幅度和其它结构特性。块金项（在似然中）的作用是为观测噪声建模。将这两者混为一谈是一个概念性错误。\n- 如选项A的分析所示，为带噪声的数据设置 $\\sigma_n^2 = 0$ 会迫使代理模型对噪声进行插值，导致过拟合以及预测器对具体噪声实现的高度敏感性（高估计量方差）。这几乎绝不是一个“最优选择”。\n- 当 $\\{\\tau_i^2\\}$ 已知时，正确的方法是使用异方差似然，其中噪声协方差矩阵为 $\\Sigma_\\tau = \\text{diag}(\\tau_1^2, \\dots, \\tau_n^2)$。那么需要求逆的矩阵将是 $K_\\theta + \\Sigma_\\tau$。\n\n结论：**错误**。\n\n**D. 即使对于确定性代码（因此真实的观测噪声为0），...**\n\n- 对于确定性代码，真实噪声为零（$\\tau_i^2 = 0$），正确的统计模型会使用 $\\sigma_n^2 = 0$。此时要求逆的矩阵是核矩阵 $K_\\theta$。\n- 核矩阵 $K_\\theta$ 是半正定的。如果任意两个训练点 $x_i$ 和 $x_j$ 非常接近，那么 $K_\\theta$ 的相应行/列将几乎相同，使矩阵变得病态（ill-conditioned）（即条件数非常大）。\n- 对病态矩阵求逆在数值上是不稳定的。\n- 向对角线元素添加一个小的正常数项 $\\sigma_n^2 > 0$ 会形成矩阵 $K_\\theta + \\sigma_n^2 I_n$。此操作将 $\\sigma_n^2$ 加到 $K_\\theta$ 的每个特征值上，将小的特征值“抬离”零，通常会降低条件数并使矩阵成为严格正定矩阵，从而在数值上稳定求逆。这是许多GP软件包中的标准且必要的做法。\n\n结论：**正确**。\n\n**E. 增加 $\\sigma_n^2$ 总会减小后验预测方差 $\\sigma_*^2(x)$ ...**\n\n让我们分析 $\\sigma_*^2(x)$ 对 $\\sigma_n^2$ 的依赖关系：\n$$\n\\sigma_*^2(x) = k_\\theta(x,x) - \\mathbf{k}_*(x)^T (K_\\theta + \\sigma_n^2 I_n)^{-1} \\mathbf{k}_*(x)\n$$\n考虑项 $Q(\\sigma_n^2) = \\mathbf{k}_*(x)^T (K_\\theta + \\sigma_n^2 I_n)^{-1} \\mathbf{k}_*(x)$。对于 $\\sigma_{n,2}^2 > \\sigma_{n,1}^2 \\ge 0$，有 $K_\\theta + \\sigma_{n,2}^2 I_n > K_\\theta + \\sigma_{n,1}^2 I_n$（在勒夫纳序中）。对于正定矩阵，如果 $A > B$，则 $B^{-1} > A^{-1}$。因此，$(K_\\theta + \\sigma_{n,1}^2 I_n)^{-1} > (K_\\theta + \\sigma_{n,2}^2 I_n)^{-1}$。这意味着二次型 $Q(\\sigma_n^2)$ 是 $\\sigma_n^2$ 的递减函数。\n由于 $\\sigma_*^2(x) = k_\\theta(x,x) - Q(\\sigma_n^2)$，且 $Q(\\sigma_n^2)$ 是一个递减函数，因此 $\\sigma_*^2(x)$ 必定是 $\\sigma_n^2$ 的 *递增* 函数。\n直观地说，增加假定的观测噪声 $\\sigma_n^2$ 意味着我们对数据点 $\\{y_i\\}$ 的信任度降低。对数据的信任度降低意味着数据提供的信息更少，无法有效减少我们对潜在函数 $f$ 的不确定性。因此，我们对 $f(x)$ 的后验不确定性（方差）会增加。该陈述的主张恰恰相反。\n\n结论：**错误**。", "answer": "$$\\boxed{ABD}$$", "id": "3561171"}, {"introduction": "一个强大的模拟器不仅应能学习函数值，还应能融合我们对系统行为的额外物理知识。在许多核物理计算中，例如使用伴随方法的输运计算，我们可以高效地获得模型响应对输入参数的梯度（或敏感性）。本练习将引导您推导并应用一个包含梯度观测的高斯过程框架，这将显著提高模拟器的精度和数据效率。", "problem": "在计算核物理中，来自确定论中子输运的基于伴随的灵敏度提供了反应堆响应相对于输入参数的梯度信息。考虑使用高斯过程 (GP) 来模拟一个标量核响应，具体来说，是作为单个标量输入函数的无限介质有效增殖因子。设该标量响应被建模为一个零均值高斯过程 (GP)，其协方差核为 $k(x,x')$，其中 $x$ 是一个标量输入参数，定义为 $x = \\ln \\Sigma_{a}$，而 $\\Sigma_{a}$ 是均匀混合物在名义状态附近的宏观吸收截面。假设 $k(x,x')$ 是二次连续可微的。\n\n1) 从高斯过程的定义以及应用于高斯过程的线性泛函会产生另一个高斯过程这一事实出发，推导函数值和梯度之间的联合协方差结构。具体而言，用核函数 $k(x,x')$ 的偏导数推导 $\\mathrm{Cov}(f(x), f(x'))$、$\\mathrm{Cov}(f(x), \\partial f/\\partial x'(x'))$ 和 $\\mathrm{Cov}(\\partial f/\\partial x(x), \\partial f/\\partial x'(x'))$ 的表达式。从第一性原理出发，清晰地论证每一步。\n\n2) 在反应堆物理的伴随灵敏度分析中，人们在选定的 $x$ 值处获得 $\\partial f/\\partial x$ 的观测值。请解释如何通过构建由函数值和梯度组成的观测向量的联合高斯先验，将这些梯度观测值纳入高斯过程中。包括函数和梯度通道的独立观测噪声，其方差分别为 $\\sigma_{n,f}^{2}$ 和 $\\sigma_{n,g}^{2}$。\n\n3) 考虑平方指数核\n$$\nk(x,x') \\;=\\; \\sigma_{f}^{2}\\,\\exp\\!\\left(-\\frac{(x-x')^{2}}{2\\ell^{2}}\\right),\n$$\n其超参数为 $\\sigma_{f} = 0.2$ 和 $\\ell = 0.6$。给定一个来自中子输运计算的函数观测值，\n$$\n\\text{在 } x_{1} = 0 \\text{ 处的 } f(x_{1}) \\text{，观测值为 } y_{f} = 1.05,\n$$\n以及一个来自伴随灵敏度计算的梯度观测值，\n$$\n\\text{在 } x_{2} = 0.5 \\text{ 处的 } \\left.\\frac{\\partial f}{\\partial x}\\right|_{x_{2}} \\text{，观测值为 } y_{g} = -0.10.\n$$\n假设函数观测值和梯度观测值具有独立的的高斯观测噪声，分别为 $\\sigma_{n,f} = 0.01$ 和 $\\sigma_{n,g} = 0.02$。使用第 (1) 和 (2) 部分的结果，构建观测值的 $2\\times 2$ 联合协方差矩阵，以及在测试输入 $x_{*} = 0.2$ 处的 $f(x_{*})$ 与观测向量之间的 $2\\times 1$ 互协方差向量，然后推导在给定混合观测值的情况下 $f(x_{*})$ 的后验均值表达式。\n\n4) 对于给定的超参数和观测值，数值计算在 $x_{*} = 0.2$ 处的后验预测均值。将最终预测的增殖因子表示为一个无量纲数，并将答案四舍五入到四位有效数字。", "solution": "此问题经评估为有效。它在科学上基于高斯过程的既定理论及其在代理建模中的应用，这是计算科学中的一种标准技术。该问题是适定的、客观的、自洽的，并且所提供的所有数据和条件都是一致且足以推导出唯一解的。\n\n### 第 1 部分：联合协方差结构的推导\n\n如果对于任意点集 $x_1, \\dots, x_n$，随机向量 $(f(x_1), \\dots, f(x_n))$ 服从多元高斯分布，则标量函数 $f(x)$ 是一个高斯过程 (GP)。一个高斯过程由其均值函数 $m(x) = \\mathbb{E}[f(x)]$ 和协方差函数（或核函数）$k(x,x') = \\mathrm{Cov}(f(x), f(x'))$ 完全确定。问题陈述该响应被建模为零均值高斯过程，因此对所有 $x$ 都有 $m(x) = 0$。\n\n高斯过程的一个关键性质是它们在线性运算下是封闭的。微分算子 $\\frac{\\partial}{\\partial x}$ 是一个线性算子。因此，如果 $f(x)$ 是一个高斯过程，那么它的导数 $\\frac{\\partial f}{\\partial x}(x)$ 也是一个高斯过程。$f(x)$ 及其导数的联合分布也是高斯的。我们可以通过利用协方差的性质以及微分和期望算子可以互换的假设来推导协方差结构。这是允许的，因为核函数 $k(x,x')$ 被假设为二次连续可微，这意味着高斯过程的样本路径是均方可微的。\n\n在零均值假设下，$\\mathbb{E}[f(x)] = 0$，并且根据期望的线性性质，$\\mathbb{E}[\\frac{\\partial f}{\\partial x}(x)] = \\frac{\\partial}{\\partial x}\\mathbb{E}[f(x)] = 0$。\n\n1.  **函数值之间的协方差，$\\mathrm{Cov}(f(x), f(x'))$**：\n    根据高斯过程协方差函数的定义，这本身就是核函数。\n    $$ \\mathrm{Cov}(f(x), f(x')) = \\mathbb{E}[(f(x) - \\mathbb{E}[f(x)])(f(x') - \\mathbb{E}[f(x')])] = \\mathbb{E}[f(x)f(x')] = k(x,x') $$\n\n2.  **函数值和梯度之间的协方差，$\\mathrm{Cov}(f(x), \\frac{\\partial f}{\\partial x'}(x'))$**：\n    我们使用协方差的定义并交换微分和期望运算。\n    $$ \\mathrm{Cov}\\left(f(x), \\frac{\\partial f}{\\partial x'}(x')\\right) = \\mathbb{E}\\left[f(x) \\frac{\\partial f}{\\partial x'}(x')\\right] = \\frac{\\partial}{\\partial x'} \\mathbb{E}[f(x)f(x')] $$\n    由于 $\\mathbb{E}[f(x)f(x')] = k(x,x')$，我们有：\n    $$ \\mathrm{Cov}\\left(f(x), \\frac{\\partial f}{\\partial x'}(x')\\right) = \\frac{\\partial k(x,x')}{\\partial x'} $$\n    根据协方差算子的对称性，$\\mathrm{Cov}(\\frac{\\partial f}{\\partial x}(x), f(x')) = \\mathrm{Cov}(f(x'), \\frac{\\partial f}{\\partial x}(x))$。基于前面的结果，这等于 $\\frac{\\partial k(x',x)}{\\partial x}$。\n\n3.  **梯度之间的协方差，$\\mathrm{Cov}(\\frac{\\partial f}{\\partial x}(x), \\frac{\\partial f}{\\partial x'}(x'))$**：\n    我们应用相同的过程，对两个参数都进行微分。\n    $$ \\mathrm{Cov}\\left(\\frac{\\partial f}{\\partial x}(x), \\frac{\\partial f}{\\partial x'}(x')\\right) = \\mathbb{E}\\left[\\frac{\\partial f}{\\partial x}(x) \\frac{\\partial f}{\\partial x'}(x')\\right] = \\frac{\\partial}{\\partial x} \\mathbb{E}\\left[f(x) \\frac{\\partial f}{\\partial x'}(x')\\right] $$\n    使用上一步的结果：\n    $$ = \\frac{\\partial}{\\partial x} \\left( \\frac{\\partial k(x,x')}{\\partial x'} \\right) = \\frac{\\partial^2 k(x,x')}{\\partial x \\partial x'} $$\n\n### 第 2 部分：纳入梯度观测值和噪声\n\n我们被给予了函数值和函数梯度的观测值。设在输入 $\\{x_{f,i}\\}_{i=1}^{N_f}$ 处有 $N_f$ 个函数观测值 $\\{y_{f,i}\\}_{i=1}^{N_f}$，在输入 $\\{x_{g,j}\\}_{j=1}^{N_g}$ 处有 $N_g$ 个梯度观测值 $\\{y_{g,j}\\}_{j=1}^{N_g}$。这些观测值被建模为被独立高斯噪声污染的真实潜在值。\n$$ y_{f,i} = f(x_{f,i}) + \\epsilon_{f,i}, \\quad \\epsilon_{f,i} \\sim \\mathcal{N}(0, \\sigma_{n,f}^2) $$\n$$ y_{g,j} = \\left.\\frac{\\partial f}{\\partial x}\\right|_{x=x_{g,j}} + \\epsilon_{g,j}, \\quad \\epsilon_{g,j} \\sim \\mathcal{N}(0, \\sigma_{n,g}^2) $$\n我们定义一个增广观测向量 $\\mathbf{y}$ 和一个对应的增广潜在函数向量 $\\mathbf{f}$。对于问题中在输入 $x_1$ 和 $x_2$ 处分别有一个函数和一个梯度观测值的具体情况，我们有：\n$$ \\mathbf{y} = \\begin{pmatrix} y_f \\\\ y_g \\end{pmatrix}, \\quad \\mathbf{f} = \\begin{pmatrix} f(x_1) \\\\ \\left.\\frac{\\partial f}{\\partial x}\\right|_{x=x_2} \\end{pmatrix} $$\n潜在值向量 $\\mathbf{f}$ 从一个零均值多元高斯分布中抽取，其协方差矩阵 $K$ 是使用第 1 部分的结果构建的。\n$$ \\mathbf{f} \\sim \\mathcal{N}(\\mathbf{0}, K) $$\n其中\n$$ K = \\begin{pmatrix}\n\\mathrm{Cov}(f(x_1), f(x_1)) & \\mathrm{Cov}(f(x_1), \\frac{\\partial f}{\\partial x}(x_2)) \\\\\n\\mathrm{Cov}(\\frac{\\partial f}{\\partial x}(x_2), f(x_1)) & \\mathrm{Cov}(\\frac{\\partial f}{\\partial x}(x_2), \\frac{\\partial f}{\\partial x}(x_2))\n\\end{pmatrix} = \\begin{pmatrix}\nk(x_1, x_1) & \\frac{\\partial k(x_1, x')}{\\partial x'}\\big|_{x'=x_2} \\\\\n\\frac{\\partial k(x, x_1)}{\\partial x}\\big|_{x=x_2} & \\frac{\\partial^2 k(x, x')}{\\partial x \\partial x'}\\big|_{x=x_2, x'=x_2}\n\\end{pmatrix} $$\n观测向量 $\\mathbf{y}$ 是潜在向量 $\\mathbf{f}$ 和噪声向量 $\\boldsymbol{\\epsilon} = (\\epsilon_f, \\epsilon_g)^T$ 的和。噪声被假设为与过程 $f$ 无关，并具有协方差矩阵 $\\Sigma_{\\text{noise}}$。由于噪声项的独立性，该矩阵是对角的：\n$$ \\Sigma_{\\text{noise}} = \\begin{pmatrix} \\sigma_{n,f}^2 & 0 \\\\ 0 & \\sigma_{n,g}^2 \\end{pmatrix} $$\n两个独立高斯向量的和是高斯向量。因此，观测向量 $\\mathbf{y}$ 的联合高斯先验是：\n$$ \\mathbf{y} \\sim \\mathcal{N}(\\mathbf{0}, K_y), \\quad \\text{其中} \\quad K_y = K + \\Sigma_{\\text{noise}} $$\n\n### 第 3 部分：针对具体问题的公式化\n\n给定平方指数核：\n$$ k(x,x') = \\sigma_{f}^{2}\\,\\exp\\left(-\\frac{(x-x')^{2}}{2\\ell^{2}}\\right) $$\n所需的偏导数为：\n$$ \\frac{\\partial k(x,x')}{\\partial x'} = \\sigma_{f}^{2}\\,\\exp\\left(-\\frac{(x-x')^{2}}{2\\ell^{2}}\\right) \\left(\\frac{x-x'}{\\ell^2}\\right) $$\n$$ \\frac{\\partial k(x,x')}{\\partial x} = \\sigma_{f}^{2}\\,\\exp\\left(-\\frac{(x-x')^{2}}{2\\ell^{2}}\\right) \\left(-\\frac{x-x'}{\\ell^2}\\right) $$\n$$ \\frac{\\partial^2 k(x,x')}{\\partial x \\partial x'} = \\frac{\\sigma_f^2}{\\ell^2} \\exp\\left(-\\frac{(x-x')^{2}}{2\\ell^{2}}\\right) \\left(1 - \\frac{(x-x')^2}{\\ell^2}\\right) $$\n观测点是 $x_1 = 0$（函数）和 $x_2=0.5$（梯度）。测试点是 $x_*=0.2$。\n\n观测值的 $2\\times 2$ 联合协方差矩阵 $K_y = K + \\Sigma_{\\text{noise}}$ 构建如下：\n$K_{11} = k(x_1, x_1) = k(0,0) = \\sigma_f^2$\n$K_{12} = \\frac{\\partial k(x_1, x')}{\\partial x'}\\big|_{x'=x_2} = \\frac{\\partial k(0, x')}{\\partial x'}\\big|_{x'=0.5} = \\frac{\\sigma_f^2}{\\ell^2}(0-0.5) \\exp\\left(-\\frac{(0-0.5)^2}{2\\ell^2}\\right)$\n$K_{21} = \\frac{\\partial k(x, x_1)}{\\partial x}\\big|_{x=x_2} = \\frac{\\partial k(x, 0)}{\\partial x}\\big|_{x=0.5} = \\frac{\\sigma_f^2}{\\ell^2}(-(0.5-0)) \\exp\\left(-\\frac{(0.5-0)^2}{2\\ell^2}\\right) = K_{12}$\n$K_{22} = \\frac{\\partial^2 k(x, x')}{\\partial x \\partial x'}\\big|_{x=x_2, x'=x_2} = \\frac{\\partial^2 k(x, x')}{\\partial x \\partial x'}\\big|_{x=0.5, x'=0.5} = \\frac{\\sigma_f^2}{\\ell^2} (1-0) = \\frac{\\sigma_f^2}{\\ell^2}$\n所以，完整的观测协方差矩阵是：\n$$ K_y = \\begin{pmatrix} \\sigma_f^2 + \\sigma_{n,f}^2 & \\frac{-\\sigma_f^2}{2\\ell^2}\\exp\\left(\\frac{-1}{8\\ell^2}\\right) \\\\ \\frac{-\\sigma_f^2}{2\\ell^2}\\exp\\left(\\frac{-1}{8\\ell^2}\\right) & \\frac{\\sigma_f^2}{\\ell^2} + \\sigma_{n,g}^2 \\end{pmatrix} $$\n\n$f(x_*)$ 与观测向量 $\\mathbf{f} = (f(x_1), \\partial f/\\partial x(x_2))^T$ 之间的 $2\\times 1$ 互协方差向量记为 $\\mathbf{k}_*$。\n$$ \\mathbf{k}_* = \\begin{pmatrix} \\mathrm{Cov}(f(x_*), f(x_1)) \\\\ \\mathrm{Cov}(f(x_*), \\frac{\\partial f}{\\partial x}(x_2)) \\end{pmatrix} = \\begin{pmatrix} k(x_*, x_1) \\\\ \\frac{\\partial k(x_*, x')}{\\partial x'}\\big|_{x'=x_2} \\end{pmatrix} $$\n$$ \\mathbf{k}_* = \\begin{pmatrix} \\sigma_f^2 \\exp\\left(-\\frac{(x_*-x_1)^2}{2\\ell^2}\\right) \\\\ \\frac{\\sigma_f^2}{\\ell^2}(x_*-x_2)\\exp\\left(-\\frac{(x_*-x_2)^2}{2\\ell^2}\\right) \\end{pmatrix} = \\begin{pmatrix} \\sigma_f^2 \\exp\\left(-\\frac{(0.2-0)^2}{2\\ell^2}\\right) \\\\ \\frac{\\sigma_f^2}{\\ell^2}(0.2-0.5)\\exp\\left(-\\frac{(0.2-0.5)^2}{2\\ell^2}\\right) \\end{pmatrix} $$\n\n在给定观测向量 $\\mathbf{y}_{\\text{obs}} = (y_f, y_g)^T$ 的情况下，$f(x_*)$ 的后验均值由条件高斯分布的标准公式给出。对于零先验均值，该公式为：\n$$ \\bar{f}(x_*) = \\mathbb{E}[f(x_*)|\\mathbf{y}=\\mathbf{y}_{\\text{obs}}] = \\mathbf{k}_*^T K_y^{-1} \\mathbf{y}_{\\text{obs}} $$\n代入推导出的矩阵：\n$$ \\bar{f}(x_*) = \\mathbf{k}_*^T (K+\\Sigma_{\\text{noise}})^{-1} \\mathbf{y}_{\\text{obs}} $$\n\n### 第 4 部分：数值计算\n\n我们有以下给定值：$\\sigma_f=0.2$, $\\ell=0.6$, 在 $x_1=0$ 处 $y_f=1.05$, 在 $x_2=0.5$ 处 $y_g=-0.10$, $\\sigma_{n,f}=0.01$, $\\sigma_{n,g}=0.02$，以及测试点 $x_*=0.2$。\n超参数为 $\\sigma_f^2 = 0.04$ 和 $\\ell^2 = 0.36$。噪声方差为 $\\sigma_{n,f}^2 = 0.0001$ 和 $\\sigma_{n,g}^2 = 0.0004$。\n\n首先，我们计算矩阵 $K$：\n$K_{11} = 0.04$\n$K_{12} = K_{21} = \\frac{0.04}{0.36}(0-0.5)\\exp\\left(-\\frac{0.25}{2(0.36)}\\right) = -\\frac{1}{18} \\exp\\left(-\\frac{25}{72}\\right) \\approx -0.03925836$\n$K_{22} = \\frac{0.04}{0.36} = \\frac{1}{9} \\approx 0.11111111$\n所以，$K \\approx \\begin{pmatrix} 0.04 & -0.03925836 \\\\ -0.03925836 & 0.11111111 \\end{pmatrix}$。\n\n接下来，我们构造 $K_y = K + \\Sigma_{\\text{noise}}$：\n$K_y = \\begin{pmatrix} 0.04+0.0001 & -0.03925836 \\\\ -0.03925836 & 0.11111111+0.0004 \\end{pmatrix} = \\begin{pmatrix} 0.0401 & -0.03925836 \\\\ -0.03925836 & 0.11151111 \\end{pmatrix}$。\n\n现在，我们计算向量 $\\mathbf{k}_*$：\n$(\\mathbf{k}_*)_1 = k(0.2, 0) = 0.04\\exp\\left(-\\frac{0.2^2}{2(0.36)}\\right) = 0.04\\exp\\left(-\\frac{0.04}{0.72}\\right) = 0.04\\exp\\left(-\\frac{1}{18}\\right) \\approx 0.03783835$\n$(\\mathbf{k}_*)_2 = \\frac{0.04}{0.36}(0.2-0.5)\\exp\\left(-\\frac{(0.2-0.5)^2}{2(0.36)}\\right) = -\\frac{0.3}{9}\\exp\\left(-\\frac{0.09}{0.72}\\right) = -\\frac{1}{30}\\exp\\left(-\\frac{1}{8}\\right) \\approx -0.02941656$\n所以，$\\mathbf{k}_* \\approx \\begin{pmatrix} 0.03783835 \\\\ -0.02941656 \\end{pmatrix}$。\n\n我们需要计算 $K_y^{-1}$。其行列式为：\n$\\det(K_y) = (0.0401)(0.11151111) - (-0.03925836)^2 \\approx 0.00447160 - 0.00154122 \\approx 0.00293038$。\n其逆矩阵为：\n$K_y^{-1} \\approx \\frac{1}{0.00293038} \\begin{pmatrix} 0.11151111 & 0.03925836 \\\\ 0.03925836 & 0.0401 \\end{pmatrix} \\approx \\begin{pmatrix} 38.0537 & 13.3970 \\\\ 13.3970 & 13.6842 \\end{pmatrix}$。\n\n现在我们计算后验均值 $\\bar{f}(x_*) = \\mathbf{k}_*^T K_y^{-1} \\mathbf{y}_{\\text{obs}}$，其中 $\\mathbf{y}_{\\text{obs}} = (1.05, -0.10)^T$。\n我们首先求出向量 $\\mathbf{v}^T = \\mathbf{k}_*^T K_y^{-1}$：\n$v_1 = (0.03783835)(38.0537) + (-0.02941656)(13.3970) \\approx 1.44009 - 0.39411 \\approx 1.04598$\n$v_2 = (0.03783835)(13.3970) + (-0.02941656)(13.6842) \\approx 0.50692 - 0.40248 \\approx 0.10444$\n$\\mathbf{v}^T \\approx \\begin{pmatrix} 1.04598 & 0.10444 \\end{pmatrix}$。\n\n最后，后验均值为：\n$\\bar{f}(0.2) = \\mathbf{v}^T \\mathbf{y}_{\\text{obs}} = (1.04598)(1.05) + (0.10444)(-0.10) \\approx 1.09828 - 0.01044 = 1.08784$。\n\n四舍五入到四位有效数字，后验预测均值为 $1.088$。", "answer": "$$\n\\boxed{1.088}\n$$", "id": "3561163"}, {"introduction": "构建模拟器只是第一步，验证其在实际科学任务中的可靠性是至关重要的一环。一个设定不当的模拟器，尤其是在外推或用于参数推断（如马尔可夫链蒙特卡洛方法）时，可能会导致系统性的偏差和过于自信的结论。本练习聚焦于一系列强大的贝叶斯模型检验技术，旨在诊断模拟器可能存在的结构性缺陷，确保其预测的保真度。", "problem": "在手征有效场论 (EFT) 中，利用模拟器辅助推断核可观测量的低能常数 (LEC) 时，一个计算成本高昂的正向代码 $\\mathcal{C}$ 将参数向量 $\\boldsymbol{\\theta}\\in\\mathbb{R}^p$ 映射到预测的可观测量 $\\mathbf{y}(\\boldsymbol{\\theta};A,Z)\\in\\mathbb{R}^N$。这些可观测量对应于由质量数 $A_n$ 和质子数 $Z_n$ 索引的原子核 $n=1,\\dots,N$。观测模型假设 $\\mathbf{d}\\in\\mathbb{R}^N$ 是 $\\mathbf{y}$ 的含噪版本，其似然基于一个经过充分检验的规则，例如加性高斯噪声：$\\mathbf{d}\\mid\\mathbf{y},\\sigma^2\\sim\\mathcal{N}(\\mathbf{y},\\sigma^2\\mathbf{I})$，其中 $\\sigma^2$ 是一个讨厌尺度参数。由于 $\\mathcal{C}$ 的计算成本高昂，我们在 $M$ 个设计点 $\\{\\boldsymbol{\\theta}_m\\}_{m=1}^M$ 及其对应的代码输出上训练一个高斯过程 (GP) 模拟器 $\\mathcal{E}$，以表示映射 $\\boldsymbol{\\theta}\\mapsto \\mathbf{y}(\\boldsymbol{\\theta})$。GP 先验指定了均值函数 $m(\\boldsymbol{\\theta})$ 和带有超参数 $\\boldsymbol{\\phi}$ 的协方差核 $k_{\\boldsymbol{\\phi}}(\\boldsymbol{\\theta},\\boldsymbol{\\theta}')$，从而为新输入下的 $\\mathbf{y}(\\boldsymbol{\\theta})$ 产生一个预测分布。在模拟器辅助的马尔可夫链蒙特卡洛 (MCMC) 中，LEC 的后验分布为 $p(\\boldsymbol{\\theta}\\mid\\mathbf{d})\\propto p(\\mathbf{d}\\mid\\boldsymbol{\\theta})p(\\boldsymbol{\\theta})$，其中 $p(\\mathbf{d}\\mid\\boldsymbol{\\theta})$ 是通过将模拟器对 $\\mathbf{y}(\\boldsymbol{\\theta})$ 的预测分布与观测模型以及任何代码-数据差异项相结合来计算的。\n\n用于模型检验的基本贝叶斯原理使用后验预测分布 $p(\\tilde{\\mathbf{d}}\\mid\\mathbf{d})=\\int p(\\tilde{\\mathbf{d}}\\mid\\boldsymbol{\\theta})\\,p(\\boldsymbol{\\theta}\\mid\\mathbf{d})\\,\\mathrm{d}\\boldsymbol{\\theta}$，并且跨组（例如，按质量数划分的区域）的可交换性概念表明，如果模拟器设定得当，训练出的预测行为应该能够在这些组之间迁移。一个设定不当的 GP 模拟器可能导致对 $\\boldsymbol{\\theta}$ 的后验分布产生偏差或过分自信，尤其是在外推到 $(A,Z)$ 中代表性不足的区域时，或者当核函数对急剧变化的特征拟合不足时。\n\n考虑以下用于在此情境下诊断 GP 设定不当的提议。选择所有在科学上合理且能有效检测影响 $p(\\boldsymbol{\\theta}\\mid\\mathbf{d})$ 的模拟器设定不当的选项：\n\nA. 实施“留一区域法”验证，该方法根据 $A$（或 $(A,Z)$）将原子核划分为不相交的质量数区间 $\\{\\mathcal{R}_1,\\dots,\\mathcal{R}_R\\}$。对于每个 $r$，在 $\\mathcal{D}\\setminus\\mathcal{R}_r$ 上重新训练 $\\mathcal{E}$，对留出的 $\\mathcal{R}_r$ 进行预测，并评估所有 $n\\in\\mathcal{R}_r$ 的标准化预测误差 $e_n$ 和可信区间的覆盖率；某些 $\\mathcal{R}_r$ 中相对于样本内行为出现的持续偏差或覆盖不足表明存在设定不当。\n\nB. 通过从 $p(\\boldsymbol{\\theta}\\mid\\mathbf{d})$ 中抽取样本 $\\boldsymbol{\\theta}^{(s)}$，通过 $\\mathcal{E}$ 和观测模型生成重复数据 $\\tilde{\\mathbf{d}}^{(s)}\\sim p(\\tilde{\\mathbf{d}}\\mid\\boldsymbol{\\theta}^{(s)})$，计算统计量 $T(\\tilde{\\mathbf{d}}^{(s)})$，并将其分布与观测到的 $T(\\mathbf{d})$ 进行比较，来构建后验预测检验；大的差异（例如，极端的后验预测尾部概率）表明模拟器存在缺陷。\n\nC. 依赖 Metropolis–Hastings 接受率 $\\alpha$ 作为主要诊断工具：如果 $\\alpha>0.3$，则模拟器设定得当。\n\nD. 仅通过训练设计上 GP 核矩阵 $\\mathbf{K}$ 的条件数 $\\kappa$ 来判断设定是否得当；如果 $\\kappa$ 低于某个固定阈值，则模拟器足以用于对 $\\boldsymbol{\\theta}$ 进行推断。\n\nE. 仅检查 GP 超参数后验 $p(\\boldsymbol{\\phi}\\mid\\mathcal{D})$ 的集中程度；如果 $p(\\boldsymbol{\\phi}\\mid\\mathcal{D})$ 呈尖锐峰值，则模拟器设定得当，无需进一步检查。\n\n选择所有正确选项。", "solution": "该问题旨在识别用于诊断高斯过程（GP）模拟器设定不当的有效贝叶斯模型检验技术。一个设定不当的模拟器可能导致对物理参数（在此情境中为低能常数 $\\boldsymbol{\\theta}$）的推断产生偏差和/或过于自信。我们需要评估每个提议的方法是否能有效揭示这类模型缺陷。\n\n**A. 实施“留一区域法”验证...**\n这种方法本质上是一种系统性的交叉验证，专门用于评估模型在数据子集上的泛化能力。在核物理背景下，按质量数 $A$（或 $(A,Z)$）将数据划分为不同区域是有物理意义的。通过在一个区域的数据上训练，然后在另一个未见过的区域上测试，我们可以直接检验模拟器的外推能力。如果模拟器在留出的区域（例如，远离稳定谷的原子核）上持续表现出大的预测误差或校准不良（即，观测值频繁落入其预测区间的尾部，导致覆盖率不足），这强烈表明模拟器的设定存在问题。例如，一个平稳的核函数可能无法捕捉到物理行为随质量数变化的非平稳性。因此，这是一种诊断设定不当的强大而直接的方法。\n**结论：正确。**\n\n**B. ...构建后验预测检验...**\n这描述了标准的后验预测检验（Posterior Predictive Checks, PPCs）。其核心思想是：如果模型是好的，它应该能够生成与我们实际观测到的数据相似的数据。我们从后验分布 $p(\\boldsymbol{\\theta}\\mid\\mathbf{d})$ 中抽样，模拟出许多“重复”数据集 $\\tilde{\\mathbf{d}}^{(s)}$。然后，我们选择一个能够捕捉数据某个重要特征的检验统计量 $T(\\cdot)$（例如，数据的均值、方差，或更复杂的量），并比较观测数据的统计量 $T(\\mathbf{d})$ 与重复数据集的统计量分布 $T(\\tilde{\\mathbf{d}}^{(s)})$。如果 $T(\\mathbf{d})$ 在这个分布中显得非常极端（即后验预测p值接近0或1），则表明模型未能捕捉到数据的该方面特征。这是一个基本且通用的贝叶斯模型检验原则，完全适用于评估模拟器的充分性。\n**结论：正确。**\n\n**C. 依赖 Metropolis–Hastings 接受率 $\\alpha$...**\nMetropolis-Hastings 接受率是衡量马尔可夫链蒙特卡洛（MCMC）采样器效率的指标，而非衡量其采样的后验分布（即模型本身）是否正确的指标。一个“理想”的接受率（通常建议在0.2到0.5之间）仅表示提议步长与后验分布的局部几何形状匹配得很好，使得采样器能够高效地探索参数空间。一个模型可能在科学上完全错误，但MCMC采样器仍然可以完美地以高接受率对这个错误的后验分布进行采样。因此，接受率不能作为模型设定是否得当的诊断工具。\n**结论：错误。**\n\n**D. 仅通过...GP 核矩阵 $\\mathbf{K}$ 的条件数 $\\kappa$ 来判断设定是否得当...**\n核矩阵的条件数是衡量其数值稳定性的指标。一个高的条件数（病态矩阵）意味着矩阵接近奇异，其逆的计算可能充满数值误差。这通常发生在训练点非常接近时。虽然处理病态矩阵（例如，通过添加一个“白化项”或“nugget”）对于获得可靠的GP预测至关重要，但这只是一个数值问题。一个条件数很低的、数值上稳定的模型，仍然可能因为核函数选择不当（例如，选择了错误的平滑度或长度尺度）而成为一个糟糕的物理现象模型。因此，条件数诊断的是计算问题，而非模型的统计或科学有效性。\n**结论：错误。**\n\n**E. 仅检查 GP 超参数后验 $p(\\boldsymbol{\\phi}\\mid\\mathcal{D})$ 的集中程度...**\n超参数的后验分布反映了数据对这些参数（如核的长度尺度 $\\ell$ 或幅度 $\\sigma_f$）提供了多少信息。一个集中的、呈尖锐峰值的后验意味着数据强烈支持某组特定的超参数值。然而，这完全是在所选模型（即所选核函数家族）的框架内。如果模型本身结构不正确（例如，用一个平滑的平方指数核去拟合一个具有尖锐特征的函数），数据可能仍然会“自信地”找到该错误模型家族中的“最佳”参数，但这并不能使模型变得正确。模型的不确定性被错误地低估了，因为没有考虑模型结构本身的不确定性。因此，超参数的确定性不能证明模型的设定是得当的。\n**结论：错误。**", "answer": "$$\n\\boxed{AB}\n$$", "id": "3561193"}]}