{"hands_on_practices": [{"introduction": "漂移条件是保证马尔可夫链稳定性的核心，它确保链会从远处返回到一个中心区域。找到一个合适的李雅普诺夫函数 $V(x)$ 并验证漂移不等式是分析几何遍历性的关键一步。本练习将通过一个常见的混合核模型，指导你如何从第一性原理出发，构造一个二次李雅普诺夫函数并精确计算漂移系数，从而为几何遍历性提供保证。[@problem_id:3347148]", "problem": "考虑实线上的时间齐次马尔可夫链，其转移核定义如下。给定当前状态 $x \\in \\mathbb{R}$，下一状态 $X'$ 由一个混合机制生成：\n- 以概率 $\\delta \\in (0,1)$，$X'$ 从均值为 $0$、方差为 $\\sigma_{0}^{2} > 0$ 的高斯分布中独立抽取，即 $X' \\sim \\mathcal{N}(0,\\sigma_{0}^{2})$；\n- 以概率 $1-\\delta$，$X'$ 由自回归更新 $X' = \\rho x + \\varepsilon$ 生成，其中 $\\varepsilon \\sim \\mathcal{N}(0,\\sigma^{2})$，$\\sigma^{2} > 0$，且 $\\rho \\in \\mathbb{R}$ 满足 $|\\rho|  1$。\n\n该核常见于随机模拟和马尔可夫链蒙特卡洛（MCMC）方法中，例如，当从一个易于处理的参考分布中周期性地刷新，而在其他时候遵循一个稳定的线性高斯动态时。\n\n任务：\n1. 从马尔可夫链和不变分布的基本定义出发，陈述保证一个 $\\psi$-不可约、非周期的马尔可夫链存在平稳（不变）分布和几何遍历性的 Foster–Lyapunov 漂移条件。\n2. 对于给定的核，构造一个 Lyapunov 函数 $V:\\mathbb{R}\\to[1,\\infty)$，并通过显式计算 $\\mathbb{E}[V(X')\\mid X=x]$ 来验证漂移不等式，证明它可以用适当的常数和一个合适的小集以 Foster–Lyapunov 形式进行界定。您应通过分析转移机制下的单步期望，并证明在 petite 集之外存在收缩，从而从第一性原理证明您对 $V$ 的选择是合理的。\n\n您的最终答案必须是满足指定核的漂移条件的 Lyapunov 函数 $V(x)$ 的单个闭式解析表达式。无需数值舍入。您的最终答案应仅表示为 $x$ 的函数。", "solution": "该问题被评估为有效。它在科学上基于马尔可夫链理论，问题设定良好、客观且内部一致。\n\n本解答按照题目要求分为两部分呈现。\n\n第一部分：Foster-Lyapunov 漂移条件\n\n一个时间齐次马尔可夫链是一个随机变量序列 $\\{X_n\\}_{n \\ge 0}$，其取值于状态空间 $\\mathcal{X}$，其演化由一个固定的转移核 $P(x, A) = \\mathbb{P}(X_{n+1} \\in A \\mid X_n = x)$ 控制，适用于任何可测集 $A \\subseteq \\mathcal{X}$。一个不变（或平稳）分布是 $\\mathcal{X}$ 上的一个概率测度 $\\pi$，使得如果 $X_n \\sim \\pi$，那么 $X_{n+1} \\sim \\pi$。这等价于条件 $\\pi(A) = \\int_{\\mathcal{X}} P(x, A) \\pi(dx)$ 对所有可测集 $A$ 成立。\n\n对于一个在一般状态空间上的马尔可夫链，几何遍历性保证了唯一平稳分布 $\\pi$ 的存在，并且 $X_n$ 的分布以几何速率在全变分范数下收敛到 $\\pi$，而与初始状态 $X_0=x$ 无关。Foster-Lyapunov 漂移准则为几何遍历性提供了一个充分条件。\n\n首先，需要一些初步定义。一个马尔可夫链是 $\\psi$-不可约的，如果对于某个在 $\\mathcal{X}$ 上的测度 $\\psi$，对于每个 $x \\in \\mathcal{X}$ 和任何满足 $\\psi(A) > 0$ 的集合 $A$，存在一个整数 $n \\ge 1$ 使得 $P^n(x, A) > 0$。一个不可约链是非周期的，如果它不会陷入循环中。一个可测集 $C \\subseteq \\mathcal{X}$ 被称为小集（或 $m$-小集），如果存在一个整数 $m \\ge 1$、一个常数 $\\epsilon > 0$ 和一个概率测度 $\\nu$，使得对所有 $x \\in C$，其 $m$-步转移核满足 $P^m(x, \\cdot) \\ge \\epsilon \\nu(\\cdot)$。如果 $m=1$，该集被称为单步小集。一个集合 $C$ 是 petite 集，如果对于某个在非负整数上的概率分布 $a$，核 $K_a(x, \\cdot) = \\sum_{n=0}^{\\infty} a(n) P^n(x, \\cdot)$ 对所有 $x \\in C$ 满足 $K_a(x, \\cdot) \\ge \\epsilon \\nu(\\cdot)$。\n\n几何遍历性的 Foster-Lyapunov 漂移条件陈述如下：一个 $\\psi$-不可约且非周期的马尔可夫链是几何遍历的，如果存在一个测试函数（或 Lyapunov 函数）$V: \\mathcal{X} \\to [1, \\infty)$、一个 petite 集 $C \\subset \\mathcal{X}$ 以及常数 $\\lambda \\in [0, 1)$ 和 $L  \\infty$，使得以下漂移不等式成立：\n$$ \\mathbb{E}[V(X_{n+1}) \\mid X_n = x] \\le \\lambda V(x) + L \\mathbb{I}_C(x) \\quad \\text{对所有 } x \\in \\mathcal{X} $$\n其中 $\\mathbb{I}_C(x)$ 是指示函数，当 $x \\in C$ 时为 $1$，否则为 $0$。该期望是关于转移核 $P(x, \\cdot)$ 计算的。一个等价且通常更实用的表述是，对于某个 $\\lambda' \\in [0, 1)$ 和 $L'  \\infty$，该条件对 petite 集 $C$ 之外的所有 $x$ 成立：\n$$ \\mathbb{E}[V(X_{n+1}) \\mid X_n = x] \\le \\lambda' V(x) + L' \\quad \\text{对所有 } x \\in \\mathcal{X} \\setminus C $$\n\n第二部分：Lyapunov 函数的构造与验证\n\n我们给定一个在 $\\mathcal{X} = \\mathbb{R}$ 上的马尔可夫链。从当前状态 $x$ 生成下一个状态 $X'$ 的转移机制是一个混合模型：以概率 $\\delta$，$X' \\sim \\mathcal{N}(0, \\sigma_0^2)$；以概率 $1-\\delta$，$X' = \\rho x + \\varepsilon$，其中 $\\varepsilon \\sim \\mathcal{N}(0, \\sigma^2)$。参数满足 $\\delta \\in (0,1)$， $|\\rho|  1$， $\\sigma_0^2 > 0$ 和 $\\sigma^2 > 0$。\n\n首先，我们确立该链的不可约性和非周期性。转移核 $P(x, dy)$ 包含一个分量 $\\delta \\phi(y; 0, \\sigma_0^2) dy$，其中 $\\phi(y; \\mu, s^2)$ 是高斯概率密度函数。因为 $\\delta > 0$ 且对所有 $y \\in \\mathbb{R}$ 都有 $\\phi(y; 0, \\sigma_0^2) > 0$，所以从任何 $x$ 到任何开集的转移概率都是正的。这意味着该链是勒贝格-不可约的（即 $\\psi$-不可约，其中 $\\psi$ 是勒贝格测度）且非周期的。此外，这也意味着 $\\mathbb{R}$ 中的任何紧集都是一个单步小集，因此也是 petite 集。\n\n接下来，我们构造一个 Lyapunov 函数 $V(x)$。该动态过程包含一个线性自回归分量 $X' = \\rho x + \\varepsilon$。计算二阶矩时固有的平方运算表明，二次函数是 Lyapunov 函数的自然候选者，因为下一状态的二次函数的期望可能是当前状态的二次函数。我们寻求一个函数 $V: \\mathbb{R} \\to [1, \\infty)$。满足此条件的最简单的二次函数是 $V(x) = x^2 + 1$。我们将使用它作为我们的候选 Lyapunov 函数。\n\n我们现在计算以 $X=x$ 为条件下 $V(X')$ 的单步期望值：\n$$ \\mathbb{E}[V(X') \\mid X=x] = \\mathbb{E}[(X')^2 + 1 \\mid X=x] = \\mathbb{E}[(X')^2 \\mid X=x] + 1 $$\n使用全期望定律对混合分量进行计算：\n$$ \\mathbb{E}[(X')^2 \\mid X=x] = \\delta \\cdot \\mathbb{E}[Y_0^2] + (1-\\delta) \\cdot \\mathbb{E}[Y_1^2 \\mid X=x] $$\n其中 $Y_0 \\sim \\mathcal{N}(0, \\sigma_0^2)$ 且 $Y_1 \\sim \\mathcal{N}(\\rho x, \\sigma^2)$。\n对于一个随机变量 $Y \\sim \\mathcal{N}(\\mu, s^2)$，其二阶矩为 $\\mathbb{E}[Y^2] = \\text{Var}(Y) + (\\mathbb{E}[Y])^2 = s^2 + \\mu^2$。\n应用此公式，我们得到：\n- 对于第一个分量，$\\mathbb{E}[Y_0^2] = \\sigma_0^2 + 0^2 = \\sigma_0^2$。\n- 对于第二个分量，$\\mathbb{E}[Y_1^2 \\mid X=x] = \\sigma^2 + (\\rho x)^2 = \\sigma^2 + \\rho^2 x^2$。\n\n将这些结果代回到 $(X')^2$ 的条件期望表达式中：\n$$ \\mathbb{E}[(X')^2 \\mid X=x] = \\delta \\sigma_0^2 + (1-\\delta)(\\sigma^2 + \\rho^2 x^2) = (1-\\delta)\\rho^2 x^2 + \\delta\\sigma_0^2 + (1-\\delta)\\sigma^2 $$\n因此，我们的 Lyapunov 函数的期望值为：\n$$ \\mathbb{E}[V(X') \\mid X=x] = (1-\\delta)\\rho^2 x^2 + \\delta\\sigma_0^2 + (1-\\delta)\\sigma^2 + 1 $$\n为了验证漂移条件，我们将右侧用 $V(x) = x^2+1$ 来表示。我们有 $x^2 = V(x) - 1$。\n$$ \\mathbb{E}[V(X') \\mid X=x] = (1-\\delta)\\rho^2 (V(x) - 1) + \\delta\\sigma_0^2 + (1-\\delta)\\sigma^2 + 1 $$\n$$ \\mathbb{E}[V(X') \\mid X=x] = (1-\\delta)\\rho^2 V(x) + [1 - (1-\\delta)\\rho^2 + \\delta\\sigma_0^2 + (1-\\delta)\\sigma^2] $$\n这个方程的形式是 $\\mathbb{E}[V(X') \\mid X=x] = \\lambda_V V(x) + b_V$，其中漂移系数是 $\\lambda_V = (1-\\delta)\\rho^2$，加性常数是 $b_V = 1 - (1-\\delta)\\rho^2 + \\delta\\sigma_0^2 + (1-\\delta)\\sigma^2$。\n\n参数的条件是 $\\delta \\in (0,1)$ 和 $|\\rho|1$。这意味着 $0  1-\\delta  1$ 和 $0 \\le \\rho^2  1$。因此，漂移系数满足 $0 \\le \\lambda_V  1$。常数 $b_V$ 是有限的，因为所有参数都是有限的。\n推导出的关系\n$$ \\mathbb{E}[V(X') \\mid X=x] = \\lambda_V V(x) + b_V $$\n对所有 $x \\in \\mathbb{R}$ 成立。这是一个全局漂移条件，比 Foster-Lyapunov 定理所要求的更强。它直接满足漂移不等式 $\\mathbb{E}[V(X') \\mid X=x] \\le \\lambda V(x) + L$，对于任何 petite 集 $C$ 的选择，都有 $\\lambda = \\lambda_V$ 和 $L=b_V$。状态空间向中心的收缩由 $\\lambda_V  1$ 保证。这证实了 $V(x) = x^2+1$ 是给定马尔可夫链的一个有效 Lyapunov 函数，从而保证了其几何遍历性和唯一平稳分布的存在性。", "answer": "$$\n\\boxed{x^2 + 1}\n$$", "id": "3347148"}, {"introduction": "漂移条件保证马尔可夫链会返回到一个中心集（小集），而极小化条件则确保链在该集合内能够充分混合，避免陷入局部。本练习要求你直接应用小集的定义，为一个给定的转移核构造一个显式的极小化测度 $\\nu$ 和常数 $\\epsilon$。通过计算最大可能的 $\\epsilon$，你将深入理解极小化条件如何量化链的局部移动能力。[@problem_id:3310306]", "problem": "考虑一个在 $\\mathbb{R}$ 上的时间齐次马尔可夫转移核 $P$，其关于勒贝格测度的密度为 $p(x,y)$，对于一个固定的 $\\lambda \\in (0,1)$ 定义如下\n$$\np(x,y) \\;=\\; \\lambda \\cdot \\frac{1}{2}\\,\\mathbf{1}_{[-1,1]}(y) \\;+\\; (1-\\lambda)\\cdot \\frac{1}{2}\\,\\exp\\!\\big(-|y-x|\\big),\n$$\n其中 $\\mathbf{1}_{[-1,1]}$ 是区间 $[-1,1]$ 的示性函数。令 $C = [-2,2]$。马尔可夫转移核和小集的概念按标准方式理解：一个可测集 $C$ 被称为是 $1$-小的，如果存在一个常数 $\\epsilon \\in (0,1]$ 和一个在 $(\\mathbb{R},\\mathcal{B}(\\mathbb{R}))$ 上的概率测度 $\\nu$，使得对所有 $x \\in C$ 和所有可测集 $A \\subset \\mathbb{R}$，都有 $P(x,A) \\ge \\epsilon\\,\\nu(A)$。\n\n从基本定义出发，仅使用马尔可夫转移核、示性函数和小集（下控制）条件的定义，构造一个显式的概率测度 $\\nu$ 和一个常数 $\\epsilon$，以验证集合 $C$ 上的小集条件。在所有满足 $\\nu$ 是一个概率测度的对 $(\\epsilon,\\nu)$ 中，确定 $\\epsilon$ 的最大可能值，并以 $\\lambda$ 的闭式解析表达式给出。\n\n你的最终答案必须是这个最大的 $\\epsilon$ 值，以最简精确形式表示。不需要四舍五入。不包含单位。", "solution": "我们从在 $\\mathbb{R}$ 上的马尔可夫转移核 $P$ 的定义开始，其关于勒贝格测度的密度为 $p(x,y)$，因此对于每个 $x \\in \\mathbb{R}$ 和可测集 $A \\subset \\mathbb{R}$，\n$$\nP(x,A) \\;=\\; \\int_{A} p(x,y)\\,\\mathrm{d}y.\n$$\n一个集合 $C \\subset \\mathbb{R}$ 被称为是 $1$-小的，如果存在 $\\epsilon \\in (0,1]$ 和一个在 $\\mathbb{R}$ 上的概率测度 $\\nu$，使得对所有 $x \\in C$ 和所有可测集 $A \\subset \\mathbb{R}$，\n$$\nP(x,A) \\;\\ge\\; \\epsilon\\,\\nu(A).\n$$\n等价地，若将 $\\nu$ 用其关于勒贝格测度的密度 $v(y)$ （如果存在）来表示，那么只要能找到一个非负函数 $g(y)$ 和一个常数 $\\epsilon$，使得对所有 $x \\in C$ 和几乎所有 $y \\in \\mathbb{R}$，下控制条件即被验证，\n$$\np(x,y) \\;\\ge\\; g(y), \\qquad \\text{且} \\qquad \\epsilon \\;=\\; \\int_{\\mathbb{R}} g(y)\\,\\mathrm{d}y, \\qquad v(y) \\;=\\; \\frac{g(y)}{\\epsilon}.\n$$\n确实，如果对所有 $x \\in C$ 都有 $p(x,y) \\ge g(y)$，那么对所有可测集 $A$，\n$$\nP(x,A) \\;=\\; \\int_{A} p(x,y)\\,\\mathrm{d}y \\;\\ge\\; \\int_{A} g(y)\\,\\mathrm{d}y \\;=\\; \\epsilon \\int_{A} \\frac{g(y)}{\\epsilon}\\,\\mathrm{d}y \\;=\\; \\epsilon\\,\\nu(A),\n$$\n其中 $\\nu(\\mathrm{d}y) = v(y)\\,\\mathrm{d}y = \\frac{g(y)}{\\epsilon}\\,\\mathrm{d}y$。根据构造，$\\nu$ 是一个概率测度，因为\n$$\n\\int_{\\mathbb{R}} \\nu(\\mathrm{d}y) \\;=\\; \\int_{\\mathbb{R}} \\frac{g(y)}{\\epsilon}\\,\\mathrm{d}y \\;=\\; \\frac{1}{\\epsilon} \\int_{\\mathbb{R}} g(y)\\,\\mathrm{d}y \\;=\\; 1.\n$$\n\n我们现在将此原理应用于给定的密度\n$$\np(x,y) \\;=\\; \\lambda \\cdot \\frac{1}{2}\\,\\mathbf{1}_{[-1,1]}(y) \\;+\\; (1-\\lambda)\\cdot \\frac{1}{2}\\,\\exp\\!\\big(-|y-x|\\big),\n$$\n其中 $C = [-2,2]$。对于固定的 $y \\in \\mathbb{R}$，我们计算在 $x \\in C$ 上的逐点下包络：\n$$\ng(y) \\;:=\\; \\inf_{x \\in C} p(x,y).\n$$\n我们分别处理这两个混合分量。第一个分量不依赖于 $x$，并直接对 $g(y)$ 贡献了\n$$\n\\lambda \\cdot \\frac{1}{2}\\,\\mathbf{1}_{[-1,1]}(y)\n$$\n。对于第二个分量，我们在 $x \\in [-2,2]$ 上最小化 $\\frac{1}{2}\\exp(-|y-x|)$。由于 $x \\mapsto \\exp(-|y-x|)$ 在 $|y-x|$ 上是严格递减的，因此在 $x \\in [-2,2]$ 上的下确界在 $[-2,2]$ 中使 $|y-x|$ 最大化的点处取得。从 $y$ 到区间 $[-2,2]$ 的最大距离是\n$$\n\\max_{x \\in [-2,2]} |y-x| \\;=\\; 2 + |y|.\n$$\n因此，\n$$\n\\inf_{x \\in C} \\frac{1}{2}\\exp\\!\\big(-|y-x|\\big) \\;=\\; \\frac{1}{2}\\,\\exp\\!\\big(-(2+|y|)\\big).\n$$\n结合这两个分量，我们得到公共下界\n$$\ng(y) \\;=\\; \\lambda \\cdot \\frac{1}{2}\\,\\mathbf{1}_{[-1,1]}(y) \\;+\\; (1-\\lambda)\\cdot \\frac{1}{2}\\,\\exp\\!\\big(-(2+|y|)\\big),\n$$\n它对所有 $x \\in C$ 和所有 $y \\in \\mathbb{R}$ 满足 $p(x,y) \\ge g(y)$。\n\n我们现在计算\n$$\n\\epsilon \\;=\\; \\int_{\\mathbb{R}} g(y)\\,\\mathrm{d}y \\;=\\; \\lambda \\int_{\\mathbb{R}} \\frac{1}{2}\\,\\mathbf{1}_{[-1,1]}(y)\\,\\mathrm{d}y \\;+\\; (1-\\lambda) \\int_{\\mathbb{R}} \\frac{1}{2}\\,\\exp\\!\\big(-(2+|y|)\\big)\\,\\mathrm{d}y.\n$$\n第一个积分等于\n$$\n\\int_{\\mathbb{R}} \\frac{1}{2}\\,\\mathbf{1}_{[-1,1]}(y)\\,\\mathrm{d}y \\;=\\; \\frac{1}{2} \\cdot 2 \\;=\\; 1.\n$$\n对于第二个积分，提出因子 $\\exp(-2)$ 并利用拉普拉斯密度的对称性：\n$$\n\\int_{\\mathbb{R}} \\frac{1}{2}\\,\\exp\\!\\big(-(2+|y|)\\big)\\,\\mathrm{d}y \\;=\\; \\exp(-2)\\int_{\\mathbb{R}} \\frac{1}{2}\\,\\exp(-|y|)\\,\\mathrm{d}y \\;=\\; \\exp(-2)\\cdot 1 \\;=\\; \\exp(-2).\n$$\n因此，\n$$\n\\epsilon \\;=\\; \\lambda \\cdot 1 \\;+\\; (1-\\lambda)\\cdot \\exp(-2) \\;=\\; \\lambda \\;+\\; (1-\\lambda)\\,\\exp(-2).\n$$\n\n通过其密度定义概率测度 $\\nu$\n$$\nv(y) \\;=\\; \\frac{g(y)}{\\epsilon} \\;=\\; \\frac{\\lambda \\cdot \\frac{1}{2}\\,\\mathbf{1}_{[-1,1]}(y) \\;+\\; (1-\\lambda)\\cdot \\frac{1}{2}\\,\\exp\\!\\big(-(2+|y|)\\big)}{\\lambda \\;+\\; (1-\\lambda)\\,\\exp(-2)}.\n$$\n那么，对于所有 $x \\in C$ 和所有可测集 $A \\subset \\mathbb{R}$，\n$$\nP(x,A) \\;=\\; \\int_{A} p(x,y)\\,\\mathrm{d}y \\;\\ge\\; \\int_{A} g(y)\\,\\mathrm{d}y \\;=\\; \\epsilon \\int_{A} v(y)\\,\\mathrm{d}y \\;=\\; \\epsilon\\,\\nu(A),\n$$\n从而验证了 $C$ 对于这个显式的 $\\nu$ 和 $\\epsilon$ 是 $1$-小的。\n\n剩下需要证明的是，这个 $\\epsilon$ 在所有概率测度 $\\nu$ 中是最大的。假设存在一个概率测度 $\\tilde{\\nu}$ 和一个常数 $\\tilde{\\epsilon}$，使得对所有 $x \\in C$ 和所有可测集 $A$，\n$$\nP(x,A) \\;\\ge\\; \\tilde{\\epsilon}\\,\\tilde{\\nu}(A).\n$$\n如果 $\\tilde{\\nu}$ 具有关于勒贝格测度的密度 $\\tilde{v}(y)$，那么对所有 $x \\in C$ 和几乎所有的 $y$，$p(x,y) \\ge \\tilde{\\epsilon}\\,\\tilde{v}(y)$。对 $x \\in C$ 取下确界可得，几乎处处有 $g(y) \\ge \\tilde{\\epsilon}\\,\\tilde{v}(y)$。将两边在 $\\mathbb{R}$ 上积分，得到\n$$\n\\epsilon \\;=\\; \\int_{\\mathbb{R}} g(y)\\,\\mathrm{d}y \\;\\ge\\; \\tilde{\\epsilon} \\int_{\\mathbb{R}} \\tilde{v}(y)\\,\\mathrm{d}y \\;=\\; \\tilde{\\epsilon},\n$$\n因为 $\\tilde{\\nu}$ 是一个概率测度。因此，不可能有比 $\\epsilon$ 更大的 $\\tilde{\\epsilon}$，所以\n$$\n\\epsilon \\;=\\; \\lambda \\;+\\; (1-\\lambda)\\,\\exp(-2)\n$$\n这个值是使得 $C$ 上的小集下控制条件成立的最大常数。\n\n因此，一个显式的验证对是\n$$\n\\nu(\\mathrm{d}y) \\;=\\; \\frac{\\lambda \\cdot \\frac{1}{2}\\,\\mathbf{1}_{[-1,1]}(y) \\;+\\; (1-\\lambda)\\cdot \\frac{1}{2}\\,\\exp\\!\\big(-(2+|y|)\\big)}{\\lambda \\;+\\; (1-\\lambda)\\,\\exp(-2)}\\,\\mathrm{d}y,\n$$\n和\n$$\n\\epsilon \\;=\\; \\lambda \\;+\\; (1-\\lambda)\\,\\exp(-2),\n$$\n并且这个 $\\epsilon$ 是最大的。", "answer": "$$\\boxed{\\lambda+(1-\\lambda)\\exp(-2)}$$", "id": "3310306"}, {"introduction": "漂移和极小化理论的真正威力在于其能够量化分析并比较MCMC等实用算法的性能。本练习通过一个经典的例子——对二元高斯分布进行吉布斯抽样——来展示这一点。你将推导并比较坐标式更新和块更新两种策略下的漂移常数 $\\lambda$，揭示算法设计（如更新策略）如何直接影响收敛速度，并将其与协方差矩阵的条件数联系起来。[@problem_id:3310291]", "problem": "考虑一个用于马尔可夫链蒙特卡洛（MCMC）的零均值二元高斯目标分布，其协方差矩阵为\n$$\n\\Sigma \\;=\\; \\begin{pmatrix} 1  \\rho \\\\ \\rho  1 \\end{pmatrix}, \\qquad |\\rho|1,\n$$\n并令 $\\kappa(\\Sigma)$ 表示 $\\Sigma$ 的矩阵条件数，定义为 $\\kappa(\\Sigma) \\equiv \\lambda_{\\max}(\\Sigma)/\\lambda_{\\min}(\\Sigma)$。考虑两种 Gibbs 采样方案：\n\n1. 一种系统性的坐标式 Gibbs 采样器，它执行一次完整的扫描，首先从给定 $Y$ 时 $X$ 的条件分布中更新 $X$，然后从给定新更新的 $X$ 时 $Y$ 的条件分布中更新 $Y$。\n\n2. 一种块 Gibbs 采样器，它通过从目标分布 $\\mathcal{N}\\!\\left(0,\\Sigma\\right)$ 中抽取一个新样本来联合更新整个向量 $(X,Y)$。\n\n令漂移（Lyapunov）函数为\n$$\nV(x,y) \\;=\\; y^{2}.\n$$\n对于每个采样器，令 $P$ 表示其作用于函数上的马尔可夫转移核，并考虑漂移不等式\n$$\n(PV)(x,y) \\;\\le\\; \\lambda\\, V(x,y) + b\\,\\mathbf{1}_{C}(x,y),\n$$\n其中 $C \\subseteq \\mathbb{R}^{2}$ 是一个可测集，常数 $b \\ge 0$，乘性漂移常数 $\\lambda \\in [0,1)$。对于本问题，取 $C=\\mathbb{R}^{2}$，因此对所有 $(x,y)$ 都有 $\\mathbf{1}_{C}(x,y)=1$，并专注于确定两种采样器的精确乘性漂移常数 $\\lambda$（对于某个有限的 $b$ 使不等式成立的最小可能值）。\n\n仅从多元高斯分布的 Gibbs 采样和漂移不等式的定义出发，推导坐标式和块 Gibbs 采样器的乘性漂移常数，并用条件数 $\\kappa(\\Sigma)$ 表示。将你的最终答案报告为用 $\\kappa(\\Sigma)$ 解析表示的有序对 $(\\lambda_{\\text{coord}},\\lambda_{\\text{block}})$。", "solution": "本问题要求推导两种不同的 Gibbs 采样器的精确乘性漂移常数 $\\lambda$，这两种采样器都以一个零均值二元高斯分布为目标，该分布的协方差矩阵为 $\\Sigma = \\begin{pmatrix} 1  \\rho \\\\ \\rho  1 \\end{pmatrix}$。漂移函数由 $V(x,y) = y^2$ 给出，漂移不等式为 $(PV)(x,y) \\le \\lambda V(x,y) + b$，其中常数 $b \\ge 0$，小集 $C$ 被取为整个状态空间 $\\mathbb{R}^2$。\n\n首先，我们建立矩阵条件数 $\\kappa(\\Sigma)$ 和相关系数 $\\rho$ 之间的关系。条件数定义为 $\\Sigma$ 的最大特征值与最小特征值之比。特征值 $\\lambda_e$ 可以通过求解特征方程 $\\det(\\Sigma - \\lambda_e I) = 0$ 得到。\n$$\n\\det\\begin{pmatrix} 1-\\lambda_e  \\rho \\\\ \\rho  1-\\lambda_e \\end{pmatrix} = (1-\\lambda_e)^2 - \\rho^2 = 0\n$$\n这得到 $1-\\lambda_e = \\pm \\rho$，因此特征值为 $\\lambda_e = 1 \\mp \\rho$。给定约束 $|\\rho|  1$，两个特征值都为正，并且矩阵 $\\Sigma$ 是正定的。最大和最小特征值分别为 $\\lambda_{\\max}(\\Sigma) = 1 + |\\rho|$ 和 $\\lambda_{\\min}(\\Sigma) = 1 - |\\rho|$。\n\n因此，条件数为：\n$$\n\\kappa(\\Sigma) = \\frac{\\lambda_{\\max}(\\Sigma)}{\\lambda_{\\min}(\\Sigma)} = \\frac{1 + |\\rho|}{1 - |\\rho|}\n$$\n我们可以用 $\\kappa(\\Sigma)$ 来表示 $|\\rho|$，为简洁起见，我们将其记为 $\\kappa$：\n$$\n\\kappa(1 - |\\rho|) = 1 + |\\rho| \\implies \\kappa - \\kappa|\\rho| = 1 + |\\rho| \\implies \\kappa - 1 = |\\rho|(\\kappa + 1)\n$$\n$$\n|\\rho| = \\frac{\\kappa - 1}{\\kappa + 1}\n$$\n这个关系将被用来表示最终答案。\n\n接下来，我们分析每个采样器以找到其漂移常数。\n\n**采样器2：块 Gibbs 采样器**\n\n块 Gibbs 采样器通过直接从目标分布 $\\pi = \\mathcal{N}(0, \\Sigma)$ 中抽取一个新样本 $(X',Y')$ 来更新整个向量 $(X,Y)$。因此，新状态与当前状态 $(x,y)$ 无关。算子 $(P_{\\text{block}}V)(x,y)$ 是 $V(X',Y')$ 的期望，其中 $(X',Y') \\sim \\pi$。\n$$\n(P_{\\text{block}}V)(x,y) = \\mathbb{E}_{(X',Y')\\sim\\pi}[V(X',Y')] = \\mathbb{E}_{\\pi}[(Y')^2]\n$$\n由于 $(X',Y')$ 是从零均值高斯分布中抽取的，一个分量的平方的期望是其方差。$Y'$ 的边际分布是 $\\mathcal{N}(0, \\Sigma_{22})$，其中 $\\Sigma_{22} = 1$。因此，$\\mathbb{E}_{\\pi}[(Y')^2] = \\text{Var}(Y') = 1$。\n$(P_{\\text{block}}V)(x,y)$ 的值是常数，等于 $1$。\n\n漂移不等式变为：\n$$\n1 \\le \\lambda_{\\text{block}} V(x,y) + b \\implies 1 \\le \\lambda_{\\text{block}} y^2 + b\n$$\n我们寻求最小的常数 $\\lambda_{\\text{block}} \\in [0,1)$，使得这个不等式对所有 $y \\in \\mathbb{R}$ 以及某个有限的 $b \\ge 0$ 成立。如果我们选择 $\\lambda_{\\text{block}} = 0$，不等式变为 $1 \\le b$。我们可以通过选择任何 $b \\ge 1$ 来满足这个条件，例如 $b=1$。因为对于 $\\lambda_{\\text{block}} = 0$ 存在一个有效解，并且 $\\lambda$ 必须是非负的，所以最小可能值为 $\\lambda_{\\text{block}} = 0$。这与“从目标分布中进行的独立同分布采样器表现出最快的收敛速度”这一理解是一致的。\n\n**采样器1：系统性坐标式 Gibbs 采样器**\n\n该采样器执行一次完整的扫描，先更新 $X$ 再更新 $Y$。令扫描开始时的状态为 $(x,y)$。\n1. 抽取 $X' \\sim p(X|Y=y)$。\n2. 抽取 $Y' \\sim p(Y|X=X')$。\n得到的状态是 $(X',Y')$。我们需要计算 $(P_{\\text{coord}}V)(x,y) = \\mathbb{E}[V(X',Y') | (x,y)] = \\mathbb{E}[ (Y')^2 | (x,y) ]$。\n\n对于给定的二元高斯分布，条件分布为：\n$p(X|Y=y) \\sim \\mathcal{N}(\\rho y, 1-\\rho^2)$\n$p(Y|X=x) \\sim \\mathcal{N}(\\rho x, 1-\\rho^2)$\n\n让我们对采样步骤进行建模。令 $\\epsilon_X$ 和 $\\epsilon_Y$ 为独立的标准正态随机变量，$\\epsilon_X, \\epsilon_Y \\sim \\mathcal{N}(0,1)$。\n新状态的分量可以写为：\n步骤 1：$X' = \\rho y + \\sqrt{1-\\rho^2} \\epsilon_X$\n步骤 2：$Y' = \\rho X' + \\sqrt{1-\\rho^2} \\epsilon_Y$\n\n将 $X'$ 的表达式代入 $Y'$ 的表达式中：\n$$\nY' = \\rho \\left( \\rho y + \\sqrt{1-\\rho^2} \\epsilon_X \\right) + \\sqrt{1-\\rho^2} \\epsilon_Y = \\rho^2 y + \\rho\\sqrt{1-\\rho^2} \\epsilon_X + \\sqrt{1-\\rho^2} \\epsilon_Y\n$$\n现在我们计算 $(Y')^2$ 的期望，以起始状态 $(x,y)$ 为条件。注意结果将只依赖于 $y$。\n$$\n\\mathbb{E}[(Y')^2 | y] = \\mathbb{E}\\left[ \\left( \\rho^2 y + \\rho\\sqrt{1-\\rho^2} \\epsilon_X + \\sqrt{1-\\rho^2} \\epsilon_Y \\right)^2 \\right]\n$$\n展开平方时，涉及单个 $\\epsilon_X$ 或 $\\epsilon_Y$ 的交叉项的期望将为零，因为 $\\mathbb{E}[\\epsilon_X]=\\mathbb{E}[\\epsilon_Y]=0$ 且 $\\epsilon_X, \\epsilon_Y$ 是独立的。我们剩下平方项的期望：\n$$\n\\mathbb{E}[(Y')^2 | y] = \\mathbb{E}\\left[ (\\rho^2 y)^2 + (\\rho\\sqrt{1-\\rho^2} \\epsilon_X)^2 + (\\sqrt{1-\\rho^2} \\epsilon_Y)^2 \\right]\n$$\n$$\n= \\rho^4 y^2 + \\rho^2(1-\\rho^2)\\mathbb{E}[\\epsilon_X^2] + (1-\\rho^2)\\mathbb{E}[\\epsilon_Y^2]\n$$\n由于 $\\mathbb{E}[\\epsilon_X^2] = \\text{Var}(\\epsilon_X)=1$ 且 $\\mathbb{E}[\\epsilon_Y^2] = \\text{Var}(\\epsilon_Y)=1$，我们有：\n$$\n(P_{\\text{coord}}V)(x,y) = \\rho^4 y^2 + \\rho^2(1-\\rho^2) + (1-\\rho^2) = \\rho^4 y^2 + (1-\\rho^2)(1+\\rho^2) = \\rho^4 y^2 + 1 - \\rho^4\n$$\n漂移不等式为：\n$$\n\\rho^4 y^2 + 1 - \\rho^4 \\le \\lambda_{\\text{coord}} y^2 + b\n$$\n整理各项，我们得到：\n$$\n(\\rho^4 - \\lambda_{\\text{coord}}) y^2 + (1 - \\rho^4 - b) \\le 0\n$$\n为了使该不等式对所有 $y \\in \\mathbb{R}$ 成立，二次项 $y^2$ 的系数必须是非正的，因为否则当 $|y| \\to \\infty$ 时，左侧将增长到 $+\\infty$。\n$$\n\\rho^4 - \\lambda_{\\text{coord}} \\le 0 \\implies \\lambda_{\\text{coord}} \\ge \\rho^4\n$$\n漂移常数的最小可能值为 $\\lambda_{\\text{coord}} = \\rho^4$。通过这个选择，不等式变为 $1 - \\rho^4 - b \\le 0$，这可以通过选择任何 $b \\ge 1 - \\rho^4$ 来满足。由于 $|\\rho|1$，$1-\\rho^4 > 0$，因此存在一个有效的非负 $b$。\n\n漂移常数为 $\\lambda_{\\text{coord}} = \\rho^4 = (|\\rho|)^4$。我们现在将 $|\\rho|$ 的表达式用条件数 $\\kappa = \\kappa(\\Sigma)$ 代入：\n$$\n\\lambda_{\\text{coord}} = \\left( \\frac{\\kappa - 1}{\\kappa + 1} \\right)^4\n$$\n题目要求有序对 $(\\lambda_{\\text{coord}}, \\lambda_{\\text{block}})$。\n\n因此，坐标式采样器的漂移常数为 $\\left(\\frac{\\kappa(\\Sigma) - 1}{\\kappa(\\Sigma) + 1}\\right)^4$，块采样器的漂移常数为 $0$。", "answer": "$$\n\\boxed{\\begin{pmatrix} \\left(\\frac{\\kappa(\\Sigma) - 1}{\\kappa(\\Sigma) + 1}\\right)^{4}  0 \\end{pmatrix}}\n$$", "id": "3310291"}]}