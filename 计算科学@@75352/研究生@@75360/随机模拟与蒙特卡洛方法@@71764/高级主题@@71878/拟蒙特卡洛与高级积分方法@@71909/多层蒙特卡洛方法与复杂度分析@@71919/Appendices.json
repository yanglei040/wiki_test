{"hands_on_practices": [{"introduction": "任何数值方法的核心目标都是用最小的计算量达到预设的精度。第一个练习将挑战你从第一性原理出发，推导多层蒙特卡罗方法的著名复杂度结论。通过在固定的均方误差容差下最小化总计算功，你将揭示出MLMC方法的效率是如何关键性地依赖于方差、成本和偏差收敛率之间的相互作用。[@problem_id:3322273]", "problem": "考虑一个用于标量目标量 $Q$ 的多层蒙特卡洛 (MLMC) 估计器，其中在网格尺寸 $h_{\\ell}$ 上的离散化 $Q(h_{\\ell})$ 被组织在层级 $\\ell = 0,1,\\dots,L$ 上。假设几何细化 $h_{\\ell} = h_{0} m^{-\\ell}$（其中 $m  1$），并定义层级差 $\\Delta_{\\ell} = Q(h_{\\ell}) - Q(h_{\\ell-1})$，约定 $Q(h_{-1}) \\equiv 0$。MLMC 估计器被构造为 $\\Delta_{\\ell}$ 的样本均值的伸缩求和。假设以下广泛使用的尺度假设成立：\n- 偏差（离散化误差）满足 $\\left|\\mathbb{E}[Q(h_{L})] - \\mathbb{E}[Q]\\right| \\leq c_{b} h_{L}^{\\alpha}$，其中 $c_{b}  0$ 和 $\\alpha  0$ 为常数。\n- 层级差的方差满足 $\\mathrm{Var}(\\Delta_{\\ell}) \\asymp c_{v} h_{\\ell}^{\\beta}$，其中 $c_{v}  0$ 和 $\\beta  0$ 为常数。\n- $\\Delta_{\\ell}$ 的每个独立样本的计算成本满足 $C_{\\ell} \\asymp c_{c} h_{\\ell}^{-\\gamma}$，其中 $c_{c}  0$ 和 $\\gamma  0$ 为常数。\n\n令 $N_{\\ell}$ 表示在层级 $\\ell$ 上使用的独立样本数，因此 MLMC 估计器使用的总计算功为 $W = \\sum_{\\ell=0}^{L} N_{\\ell} C_{\\ell}$，其均方误差为 $\\mathrm{MSE} = \\left(\\text{bias}\\right)^{2} + \\sum_{\\ell=0}^{L} \\mathrm{Var}(\\Delta_{\\ell})/N_{\\ell}$。目标是选择层级 $L(\\varepsilon)$ 和分配 $\\{N_{\\ell}(\\varepsilon)\\}$，使得在 $\\varepsilon \\to 0$ 时，$\\mathrm{MSE} \\leq \\varepsilon^{2}$ 的同时最小化计算功 $W$。\n\n关于 $L(\\varepsilon)$ 的最优选择、跨层级的最优方差分配以及最终的渐近计算功复杂度（包括任何对数因子），以下哪个陈述是正确的？\n\nA. 选择 $L(\\varepsilon)$ 为满足 $c_{b} h_{L}^{\\alpha} \\leq \\varepsilon/\\sqrt{2}$ 的最小整数；通过最优方差分配 $N_{\\ell} \\propto \\sqrt{\\mathrm{Var}(\\Delta_{\\ell})/C_{\\ell}}$ 选择样本量。那么，最小计算功的尺度关系为：如果 $\\beta  \\gamma$，则 $W(\\varepsilon) = \\mathcal{O}(\\varepsilon^{-2})$；如果 $\\beta = \\gamma$，则 $W(\\varepsilon) = \\mathcal{O}\\!\\left(\\varepsilon^{-2} \\left(\\log \\varepsilon^{-1}\\right)^{2}\\right)$；如果 $\\beta  \\gamma$，则 $W(\\varepsilon) = \\mathcal{O}\\!\\left(\\varepsilon^{-2 - (\\gamma - \\beta)/\\alpha}\\right)$。\n\nB. 选择 $L(\\varepsilon)$ 为满足 $c_{b} h_{L}^{\\alpha} \\leq \\varepsilon^{2}$ 的最小整数；按 $N_{\\ell} \\propto \\mathrm{Var}(\\Delta_{\\ell})$ 分配样本。那么，对于 $\\beta$ 和 $\\gamma$ 之间的所有关系，最小计算功的尺度关系均为 $W(\\varepsilon) = \\mathcal{O}(\\varepsilon^{-2})$，且没有对数因子。\n\nC. 选择 $L(\\varepsilon)$ 使得 $h_{L} \\asymp \\varepsilon^{1/\\alpha}$；按 $N_{\\ell} \\propto \\sqrt{\\mathrm{Var}(\\Delta_{\\ell})\\,C_{\\ell}}$ 分配样本。那么，当 $\\beta = \\gamma$ 时，最小计算功的尺度关系为 $W(\\varepsilon) = \\mathcal{O}\\!\\left(\\varepsilon^{-2} \\log \\varepsilon^{-1}\\right)$；当 $\\beta  \\gamma$ 时，为 $W(\\varepsilon) = \\mathcal{O}\\!\\left(\\varepsilon^{-2 - (\\gamma - \\beta)/(2\\alpha)}\\right)$。\n\nD. 选择 $L(\\varepsilon)$ 使得 $h_{L} \\asymp \\varepsilon^{1/\\alpha}$；分配样本以均衡每层的方差贡献，即 $N_{\\ell} \\propto \\mathrm{Var}(\\Delta_{\\ell})$。那么，如果 $\\beta  \\gamma$，则 $W(\\varepsilon) = \\mathcal{O}(\\varepsilon^{-2})$；如果 $\\beta  \\gamma$，则 $W(\\varepsilon) = \\mathcal{O}(\\varepsilon^{-3})$。\n\nE. 在临界情况 $\\beta = \\gamma$ 下，如果使用最优分配 $N_{\\ell} \\propto \\sqrt{\\mathrm{Var}(\\Delta_{\\ell})/C_{\\ell}}$，最小计算功的尺度关系为 $W(\\varepsilon) = \\mathcal{O}\\!\\left(\\varepsilon^{-2} \\log \\varepsilon^{-1}\\right)$，其中对数因子完全是因为 $L(\\varepsilon)$ 的增长方式类似 $\\log \\varepsilon^{-1}$。", "solution": "问题陈述描述了多层蒙特卡洛 (MLMC) 方法复杂度分析的标准设置。所有给出的定义、假设和目标都与该主题的既有文献一致（例如，Giles, M. B. \"Multilevel Monte Carlo path simulation.\" Operations Research 56.3 (2008): 607-617）。该问题具有科学依据，提法恰当，客观，并包含足够的信息以得出关于渐近复杂度的唯一解。因此，问题陈述是有效的。\n\n我们接下来推导 MLMC 估计器的最优计算功复杂度。\n目标是最小化总计算功 $W$，约束条件是均方误差 $\\mathrm{MSE}$ 小于或等于一个预设的容差 $\\varepsilon^2$。\n$W = \\sum_{\\ell=0}^{L} N_{\\ell} C_{\\ell}$\n$\\mathrm{MSE} = \\left(\\mathbb{E}[Q(h_{L})] - \\mathbb{E}[Q]\\right)^{2} + \\sum_{\\ell=0}^{L} \\frac{\\mathrm{Var}(\\Delta_{\\ell})}{N_{\\ell}} \\leq \\varepsilon^{2}$\n\n尺度假设为：\n1.  偏差：$|\\mathbb{E}[Q(h_{L})] - \\mathbb{E}[Q]| \\leq c_{b} h_{L}^{\\alpha}$\n2.  层级方差：$\\mathrm{Var}(\\Delta_{\\ell}) \\asymp c_{v} h_{\\ell}^{\\beta}$，我们将其视为 $\\mathrm{Var}(\\Delta_{\\ell}) \\approx K_v h_{\\ell}^{\\beta}$，其中 $K_v  0$ 为某个常数。\n3.  层级成本：$C_{\\ell} \\asymp c_{c} h_{\\ell}^{-\\gamma}$，我们将其视为 $C_{\\ell} \\approx K_c h_{\\ell}^{-\\gamma}$，其中 $K_c  0$ 为某个常数。\n\n满足 MSE 约束的一个最优策略是平衡平方偏差和总方差的贡献。一个标准的选择是要求每一项都以 $\\varepsilon^2/2$ 为界：\na) $(\\text{bias})^2 \\leq \\varepsilon^2/2 \\implies |\\mathbb{E}[Q(h_{L})] - \\mathbb{E}[Q]| \\leq \\varepsilon/\\sqrt{2}$。\nb) $\\sum_{\\ell=0}^{L} \\mathrm{Var}(\\Delta_{\\ell})/N_{\\ell} \\leq \\varepsilon^2/2$。\n\n根据约束 (a) 和偏差假设，我们必须选择最精细的层级 $L$ 使得：\n$c_{b} h_{L}^{\\alpha} \\leq \\varepsilon/\\sqrt{2}$\n由于 $h_{L} = h_{0} m^{-L}$，这个不等式决定了 $L$ 所需的最小值。在渐近情况下，对于 $\\varepsilon \\to 0$，这意味着 $h_{L} \\asymp \\varepsilon^{1/\\alpha}$。这又得到 $h_0 m^{-L} \\asymp \\varepsilon^{1/\\alpha}$，从而导致 $-L \\log m \\asymp (1/\\alpha) \\log \\varepsilon$，因此 $L \\asymp \\frac{1}{\\alpha \\log m} \\log(\\varepsilon^{-1})$。所以，$L$ 随 $\\varepsilon^{-1}$ 对数增长。\n\n接下来，我们在方差约束 (b) 下最小化计算功 $W$。为了使计算功最小，不等式变为等式：$\\sum_{\\ell=0}^{L} \\mathrm{Var}(\\Delta_{\\ell})/N_{\\ell} = \\varepsilon^2/2$。令 $V_{\\ell} = \\mathrm{Var}(\\Delta_{\\ell})$。我们在约束 $\\sum_{\\ell=0}^{L} V_{\\ell}/N_{\\ell} = \\varepsilon^2/2$ 下最小化 $W = \\sum_{\\ell=0}^{L} N_{\\ell} C_{\\ell}$。我们使用拉格朗日乘子法。\n拉格朗日函数为 $\\mathcal{L}(\\{N_{\\ell}\\}, \\lambda) = \\sum_{\\ell=0}^{L} N_{\\ell} C_{\\ell} + \\lambda \\left(\\sum_{\\ell=0}^{L} \\frac{V_{\\ell}}{N_{\\ell}} - \\frac{\\varepsilon^2}{2}\\right)$。\n将关于 $N_k$ 的偏导数设为零：\n$\\frac{\\partial \\mathcal{L}}{\\partial N_k} = C_k - \\lambda \\frac{V_k}{N_k^2} = 0 \\implies N_k^2 = \\lambda \\frac{V_k}{C_k} \\implies N_k = \\sqrt{\\lambda} \\sqrt{V_k/C_k}$。\n这表明在层级 $\\ell$ 上的最优样本数与 $\\sqrt{V_{\\ell}/C_{\\ell}}$ 成正比。\n\n为了找到比例常数 $\\sqrt{\\lambda}$，我们将 $N_{\\ell}$ 代回方差约束中：\n$\\sum_{\\ell=0}^{L} \\frac{V_{\\ell}}{\\sqrt{\\lambda} \\sqrt{V_{\\ell}/C_{\\ell}}} = \\frac{1}{\\sqrt{\\lambda}} \\sum_{\\ell=0}^{L} \\sqrt{V_{\\ell}C_{\\ell}} = \\frac{\\varepsilon^2}{2}$。\n因此，$\\sqrt{\\lambda} = \\frac{2}{\\varepsilon^2} \\sum_{k=0}^{L} \\sqrt{V_k C_k}$。\n最优样本量为 $N_{\\ell} = \\frac{2}{\\varepsilon^2} \\left(\\sum_{k=0}^{L} \\sqrt{V_k C_k}\\right) \\sqrt{\\frac{V_{\\ell}}{C_{\\ell}}}$。\n\n那么最小总计算功为：\n$W = \\sum_{\\ell=0}^{L} N_{\\ell} C_{\\ell} = \\sum_{\\ell=0}^{L} \\left[ \\frac{2}{\\varepsilon^2} \\left(\\sum_{k=0}^{L} \\sqrt{V_k C_k}\\right) \\sqrt{\\frac{V_{\\ell}}{C_{\\ell}}} \\right] C_{\\ell} = \\frac{2}{\\varepsilon^2} \\left(\\sum_{k=0}^{L} \\sqrt{V_k C_k}\\right) \\left(\\sum_{\\ell=0}^{L} \\sqrt{V_{\\ell}C_{\\ell}}\\right)$。\n$W = \\frac{2}{\\varepsilon^2} \\left(\\sum_{\\ell=0}^{L} \\sqrt{V_{\\ell}C_{\\ell}}\\right)^2$。\n\n现在我们通过考察求和 $\\sum_{\\ell=0}^{L} \\sqrt{V_{\\ell}C_{\\ell}}$ 来分析渐近复杂度。\n使用尺度假设，$\\sqrt{V_{\\ell}C_{\\ell}} \\asymp \\sqrt{h_{\\ell}^{\\beta} h_{\\ell}^{-\\gamma}} = h_{\\ell}^{(\\beta-\\gamma)/2}$。\n由于 $h_{\\ell} = h_{0} m^{-\\ell}$，我们有 $h_{\\ell}^{(\\beta-\\gamma)/2} = (h_0 m^{-\\ell})^{(\\beta-\\gamma)/2} = h_0^{(\\beta-\\gamma)/2} (m^{-(\\beta-\\gamma)/2})^{\\ell}$。\n该求和是一个几何级数：$\\sum_{\\ell=0}^{L} \\sqrt{V_{\\ell}C_{\\ell}} \\asymp \\sum_{\\ell=0}^{L} (m^{-(\\beta-\\gamma)/2})^{\\ell}$。\n令公比为 $r = m^{-(\\beta-\\gamma)/2}$。其行为取决于 $r$。\n\n情况1：$\\beta  \\gamma$。\n那么 $\\beta - \\gamma  0$，所以指数 $-(\\beta-\\gamma)/2$ 是负的。由于 $m1$，公比 $r = m^{-(\\beta-\\gamma)/2}$ 满足 $0  r  1$。当 $L \\to \\infty$ 时，几何级数收敛到一个常数：$\\sum_{\\ell=0}^{\\infty} r^{\\ell} = \\frac{1}{1-r}$。\n该求和为 $\\mathcal{O}(1)$。\n计算功为 $W \\asymp \\varepsilon^{-2} (\\mathcal{O}(1))^2 = \\mathcal{O}(\\varepsilon^{-2})$。\n\n情况2：$\\beta = \\gamma$。\n那么 $\\beta - \\gamma = 0$，所以公比 $r = m^0 = 1$。求和变为：\n$\\sum_{\\ell=0}^{L} 1 = L+1$。\n由于 $L \\asymp \\log(\\varepsilon^{-1})$，该求和为 $\\mathcal{O}(\\log \\varepsilon^{-1})$。\n计算功为 $W \\asymp \\varepsilon^{-2} (\\mathcal{O}(\\log \\varepsilon^{-1}))^2 = \\mathcal{O}(\\varepsilon^{-2}(\\log \\varepsilon^{-1})^2)$。\n\n情况3：$\\beta  \\gamma$。\n那么 $\\beta - \\gamma  0$，所以指数 $-(\\beta-\\gamma)/2$ 是正的。公比 $r = m^{(\\gamma-\\beta)/2}$ 大于 1。几何级数由其最后一项主导：\n$\\sum_{\\ell=0}^{L} r^{\\ell} = \\frac{r^{L+1}-1}{r-1} \\asymp r^L$。\n该求和 $\\asymp (m^{(\\gamma-\\beta)/2})^L = (m^L)^{(\\gamma-\\beta)/2}$。\n从 $h_L \\asymp \\varepsilon^{1/\\alpha}$，我们有 $h_0 m^{-L} \\asymp \\varepsilon^{1/\\alpha}$，所以 $m^L \\asymp \\varepsilon^{-1/\\alpha}$。\n该求和 $\\asymp (\\varepsilon^{-1/\\alpha})^{(\\gamma-\\beta)/2} = \\varepsilon^{-(\\gamma-\\beta)/(2\\alpha)}$。\n计算功为 $W \\asymp \\varepsilon^{-2} \\left( \\sum_{\\ell=0}^{L} \\sqrt{V_{\\ell}C_{\\ell}} \\right)^2 \\asymp \\varepsilon^{-2} \\left( \\varepsilon^{-(\\gamma-\\beta)/(2\\alpha)} \\right)^2 = \\varepsilon^{-2} \\varepsilon^{-(\\gamma-\\beta)/\\alpha} = \\varepsilon^{-2 - (\\gamma-\\beta)/\\alpha}$。\n\n推导出的复杂度总结：\n- 如果 $\\beta  \\gamma$：$W(\\varepsilon) = \\mathcal{O}(\\varepsilon^{-2})$。\n- 如果 $\\beta = \\gamma$：$W(\\varepsilon) = \\mathcal{O}(\\varepsilon^{-2} (\\log \\varepsilon^{-1})^2)$。\n- 如果 $\\beta  \\gamma$：$W(\\varepsilon) = \\mathcal{O}(\\varepsilon^{-2 - (\\gamma - \\beta)/\\alpha})$。\n\n现在我们评估给出的选项。\n\nA. 选择 $L(\\varepsilon)$ 为满足 $c_{b} h_{L}^{\\alpha} \\leq \\varepsilon/\\sqrt{2}$ 的最小整数；通过最优方差分配 $N_{\\ell} \\propto \\sqrt{\\mathrm{Var}(\\Delta_{\\ell})/C_{\\ell}}$ 选择样本量。那么，最小计算功的尺度关系为：如果 $\\beta  \\gamma$，则 $W(\\varepsilon) = \\mathcal{O}(\\varepsilon^{-2})$；如果 $\\beta = \\gamma$，则 $W(\\varepsilon) = \\mathcal{O}\\!\\left(\\varepsilon^{-2} \\left(\\log \\varepsilon^{-1}\\right)^{2}\\right)$；如果 $\\beta  \\gamma$，则 $W(\\varepsilon) = \\mathcal{O}\\!\\left(\\varepsilon^{-2 - (\\gamma - \\beta)/\\alpha}\\right)$。\n该陈述准确地描述了 $L$ 的最优选择（通过正确平衡偏差和方差误差）、样本 $N_{\\ell}$ 的最优分配（通过拉格朗日乘子法推导）以及所有三种情况下的最终计算功复杂度。这些结果与我们的推导完全匹配。\n结论：**正确**。\n\nB. 选择 $L(\\varepsilon)$ 为满足 $c_{b} h_{L}^{\\alpha} \\leq \\varepsilon^{2}$ 的最小整数；按 $N_{\\ell} \\propto \\mathrm{Var}(\\Delta_{\\ell})$ 分配样本。那么，对于 $\\beta$ 和 $\\gamma$ 之间的所有关系，最小计算功的尺度关系均为 $W(\\varepsilon) = \\mathcal{O}(\\varepsilon^{-2})$，且没有对数因子。\n对 $L$ 的选择对应于 $\\mathcal{O}(\\varepsilon^4)$ 的平方偏差，这是一种低效的误差分配。分配 $N_{\\ell} \\propto \\mathrm{Var}(\\Delta_{\\ell})$ 不是最优的。所声称的复杂度是不正确的，因为它忽略了对 $\\beta$ 和 $\\gamma$ 的依赖性。\n结论：**不正确**。\n\nC. 选择 $L(\\varepsilon)$ 使得 $h_{L} \\asymp \\varepsilon^{1/\\alpha}$；按 $N_{\\ell} \\propto \\sqrt{\\mathrm{Var}(\\Delta_{\\ell})\\,C_{\\ell}}$ 分配样本。那么，当 $\\beta = \\gamma$ 时，最小计算功的尺度关系为 $W(\\varepsilon) = \\mathcal{O}\\!\\left(\\varepsilon^{-2} \\log \\varepsilon^{-1}\\right)$；当 $\\beta  \\gamma$ 时，为 $W(\\varepsilon) = \\mathcal{O}\\!\\left(\\varepsilon^{-2 - (\\gamma - \\beta)/(2\\alpha)}\\right)$。\n$L$ 的选择是正确的。然而，样本分配 $N_{\\ell} \\propto \\sqrt{V_{\\ell}C_{\\ell}}$ 是不正确的；最优分配是 $N_{\\ell} \\propto \\sqrt{V_{\\ell}/C_{\\ell}}$。所断言的复杂度也是不正确的：对于 $\\beta=\\gamma$，对数因子是平方的，而不是 1 次方；对于 $\\beta\\gamma$，$\\varepsilon$ 的指数中分母是 $2\\alpha$，这是不正确的（应该是 $\\alpha$）。\n结论：**不正确**。\n\nD. 选择 $L(\\varepsilon)$ 使得 $h_{L} \\asymp \\varepsilon^{1/\\alpha}$；分配样本以均衡每层的方差贡献，即 $N_{\\ell} \\propto \\mathrm{Var}(\\Delta_{\\ell})$。那么，如果 $\\beta  \\gamma$，则 $W(\\varepsilon) = \\mathcal{O}(\\varepsilon^{-2})$；如果 $\\beta  \\gamma$，则 $W(\\varepsilon) = \\mathcal{O}(\\varepsilon^{-3})$。\n$L$ 的选择是正确的。分配规则“均衡每层的方差贡献”意味着 $V_{\\ell}/N_{\\ell} = \\text{常数}$，即 $N_{\\ell} \\propto V_{\\ell}$。这不是成本最优的分配。最终的计算功复杂度陈述也是不正确的。对于 $\\beta  \\gamma$，这种次优分配导致 $W \\asymp \\varepsilon^{-2} \\log \\varepsilon^{-1}$，而不是 $\\varepsilon^{-2}$。对于 $\\beta  \\gamma$ 的说法通常也不成立。\n结论：**不正确**。\n\nE. 在临界情况 $\\beta = \\gamma$ 下，如果使用最优分配 $N_{\\ell} \\propto \\sqrt{\\mathrm{Var}(\\Delta_{\\ell})/C_{\\ell}}$，最小计算功的尺度关系为 $W(\\varepsilon) = \\mathcal{O}\\!\\left(\\varepsilon^{-2} \\log \\varepsilon^{-1}\\right)$，其中对数因子完全是因为 $L(\\varepsilon)$ 的增长方式类似 $\\log \\varepsilon^{-1}$。\n此选项针对特定情况 $\\beta=\\gamma$，并正确指出了最优分配。然而，它将复杂度陈述为 $\\mathcal{O}(\\varepsilon^{-2} \\log \\varepsilon^{-1})$，这是不正确的。根据推导，复杂度应为 $\\mathcal{O}(\\varepsilon^{-2} (\\log \\varepsilon^{-1})^2)$，因为计算功与一个增长类似 $L+1$ 的和的平方成正比。\n结论：**不正确**。\n\n唯一完全正确的陈述是 A。", "answer": "$$\\boxed{A}$$", "id": "3322273"}, {"introduction": "在许多实际的科学应用中，我们的计算资源是有限且预先确定的。本练习将探讨前一个问题的对偶问题：如何在固定的计算预算下获得尽可能小的误差。这一视角对于理解如何在真实场景中最好地部署MLMC，以及分析该方法性能对模型参数估计准确性的敏感度至关重要。[@problem_id:3423160]", "problem": "考虑一个标量目标量 $Q(\\omega)$，它与定义在有界Lipschitz域上的一个一致椭圆偏微分方程的弱解 $u(\\omega,x)$ 相关。该方程具有随机输入系数 $a(\\omega,x)$ 和确定性右端项 $f(x)$。假设在一系列嵌套网格上进行协调有限元逼近，网格尺寸为 $h_\\ell = h_0 2^{-\\ell}$，其中层级 $\\ell = 0, 1, \\dots, L$。多层蒙特卡洛（MLMC）估计量是基于伸缩恒等式 $Q_{h_L} = Q_{h_0} + \\sum_{\\ell=1}^{L} \\left(Q_{h_\\ell}-Q_{h_{\\ell-1}}\\right)$ 构建的，其中 $Q_{h_\\ell}$ 表示在层级 $\\ell$ 上计算的 $Q$ 的逼近。令 $Y_\\ell := Q_{h_\\ell} - Q_{h_{\\ell-1}}$（对于 $\\ell \\ge 1$）以及 $Y_0 := Q_{h_0}$，并考虑 MLMC 估计量\n$$\n\\widehat{Q}^{\\mathrm{ML}} = \\sum_{\\ell=0}^{L} \\frac{1}{N_\\ell} \\sum_{i=1}^{N_\\ell} Y_\\ell^{(i)},\n$$\n其中 $Y_\\ell^{(i)}$ 是 $Y_\\ell$ 的独立同分布样本，$N_\\ell \\in \\mathbb{N}$ 是每层的样本数量。用 $\\mathrm{MSE}(L,\\{N_\\ell\\})$ 表示使用 $\\widehat{Q}^{\\mathrm{ML}}$ 估计 $\\mathbb{E}[Q]$ 时的均方误差，它可以分解为\n$$\n\\mathrm{MSE}(L,\\{N_\\ell\\}) = \\left|\\mathbb{E}[Q]-\\mathbb{E}[Q_{h_L}]\\right|^2 + \\sum_{\\ell=0}^{L} \\frac{\\mathbb{V}[Y_\\ell]}{N_\\ell}.\n$$\n假设以下经过充分检验的速率模型成立：存在正常数 $c_B, c_V, c_C$ 和指数 $\\alpha0, \\beta0, \\gamma0$，使得偏差满足 $\\left|\\mathbb{E}[Q]-\\mathbb{E}[Q_{h_L}]\\right| \\asymp c_B h_L^\\alpha$，层级方差满足 $\\mathbb{V}[Y_\\ell] \\asymp c_V h_\\ell^\\beta$，单个样本的成本满足 $C_\\ell \\asymp c_C h_\\ell^{-\\gamma}$。给定一个固定的计算预算 $B0$，你必须选择 $L$ 和 $\\{N_\\ell\\}_{\\ell=0}^{L}$ 以在预算约束\n$$\n\\sum_{\\ell=0}^{L} N_\\ell C_\\ell \\le B.\n$$\n下最小化 MSE。\n建立该约束优化问题，并在固定 $L$ 的情况下推导出 $\\{N_\\ell\\}$ 的优化器结构。然后分析最优均方误差关于 $B$ 的缩放关系对错误指定的速率参数的敏感性，区分 $\\beta>\\gamma$、$\\beta=\\gamma$ 和 $\\beta\\gamma$ 这几种情况。\n\n选择所有正确的陈述。\n\nA. 对于固定的 $L$，将 $N_\\ell$ 松弛到 $\\mathbb{R}_+$ 并在预算约束下最小化方差，得到分配\n$$\nN_\\ell^\\star = \\frac{B\\,\\sqrt{\\mathbb{V}[Y_\\ell]/C_\\ell}}{\\sum_{k=0}^{L} \\sqrt{\\mathbb{V}[Y_k]\\,C_k}},\n$$\n且最小化后的方差贡献等于\n$$\n\\sum_{\\ell=0}^{L} \\frac{\\mathbb{V}[Y_\\ell]}{N_\\ell^\\star} = \\frac{\\left(\\sum_{\\ell=0}^{L} \\sqrt{\\mathbb{V}[Y_\\ell]\\,C_\\ell}\\right)^2}{B}.\n$$\n因此，在层级 $L$ 的预算约束下的目标函数变为\n$$\n\\mathrm{MSE}(L) = c_B^2 h_L^{2\\alpha} + \\frac{\\left(\\sum_{\\ell=0}^{L} \\sqrt{c_V h_\\ell^\\beta \\cdot c_C h_\\ell^{-\\gamma}}\\right)^2}{B},\n$$\n且最优的 $L$ 平衡了偏差项和方差项。最终，最优均方误差关于 $B$ 的缩放关系（在相差一个乘法常数的意义下）为\n$$\n\\mathrm{MSE}(B) \\asymp \n\\begin{cases}\nB^{-1},  \\beta\\gamma,\\\\\n(\\log B)^2\\,B^{-1},  \\beta=\\gamma,\\\\\nB^{-\\frac{2\\alpha}{2\\alpha+\\gamma-\\beta}},  \\beta\\gamma,\n\\end{cases}\n$$\n\nB. 在预算约束下，最优分配满足 $N_\\ell^\\star \\propto \\mathbb{V}[Y_\\ell]/C_\\ell$，这使得方差项等于 $\\sum_{\\ell=0}^{L} \\mathbb{V}[Y_\\ell]^2/C_\\ell$。在所有情况下，均方误差都由最细层级主导，并且速率的错误指定对关于 $B$ 的缩放关系的影响可以忽略不计。\n\nC. 对于固定的 $L$，预算下的方差最小化分配满足 $N_\\ell^\\star \\propto \\sqrt{\\mathbb{V}[Y_\\ell]/C_\\ell}$，但最小化后的方差等于 $\\left(\\sum_{\\ell=0}^{L} \\mathbb{V}[Y_\\ell]/C_\\ell\\right)/B$，这导致对于所有的 $\\beta$ 和 $\\gamma$，都有 $\\mathrm{MSE}(B)\\asymp B^{-1}$。\n\nD. 对错误指定速率的敏感性是分情况的。错误判断 $\\beta-\\gamma$ 的符号（例如，当实际上 $\\beta\\gamma$ 时，使用假设 $\\beta\\gamma$ 的模型，反之亦然）会改变最优均方误差关于 $B$ 的速率指数。错误指定偏差指数 $\\alpha$ 仅在 $\\beta\\gamma$ 的情况下会改变速率指数，此时 $\\mathrm{MSE}(B)\\asymp B^{-\\frac{2\\alpha}{2\\alpha+\\gamma-\\beta}}$ 依赖于 $\\alpha$；而对于 $\\beta\\ge\\gamma$，我们有 $\\mathrm{MSE}(B)\\asymp B^{-1}$（当 $\\beta=\\gamma$ 时相差一个平方对数因子），这对 $\\alpha$ 是鲁棒的。\n\nE. 最优的 $L$ 选择满足 $h_L^{2\\alpha}\\asymp B^{-1}$，而不管 $\\beta$ 和 $\\gamma$ 的值如何，因此预算约束下的均方误差总是按 $B^{-1}$ 缩放（在相差一个常数的意义下）。", "solution": "用户需要对一个关于在预算约束下优化多层蒙特卡洛（MLMC）估计量的问题进行详细的验证和解答。\n\n### 问题验证\n\n首先，我将验证问题陈述。\n\n**步骤1：提取已知条件**\n\n-   **目标量**：$Q(\\omega)$，一个与具有随机系数 $a(\\omega,x)$ 的一致椭圆偏微分方程解 $u(\\omega,x)$ 相关的标量泛函。\n-   **离散化**：在一系列嵌套网格上进行协调有限元，网格尺寸为 $h_\\ell = h_0 2^{-\\ell}$，层级为 $\\ell = 0, 1, \\dots, L$。\n-   **逼近**：$Q_{h_\\ell}$ 是在层级 $\\ell$ 上对 $Q$ 的有限元逼近。\n-   **MLMC 恒等式**：$Q_{h_L} = Q_{h_0} + \\sum_{\\ell=1}^{L} (Q_{h_\\ell} - Q_{h_{\\ell-1}})$。\n-   **层级差分**：$Y_\\ell := Q_{h_\\ell} - Q_{h_{\\ell-1}}$（对于 $\\ell \\ge 1$）以及 $Y_0 := Q_{h_0}$。\n-   **MLMC 估计量**：$\\widehat{Q}^{\\mathrm{ML}} = \\sum_{\\ell=0}^{L} \\frac{1}{N_\\ell} \\sum_{i=1}^{N_\\ell} Y_\\ell^{(i)}$。\n-   **均方误差 (MSE)**：对于估计 $\\mathbb{E}[Q]$，MSE由 $\\mathrm{MSE}(L,\\{N_\\ell\\}) = \\left|\\mathbb{E}[Q]-\\mathbb{E}[Q_{h_L}]\\right|^2 + \\sum_{\\ell=0}^{L} \\frac{\\mathbb{V}[Y_\\ell]}{N_\\ell}$ 给出。\n-   **速率模型**：存在正常数 $c_B, c_V, c_C$ 和指数 $\\alpha0, \\beta0, \\gamma0$ 使得：\n    -   偏差：$\\left|\\mathbb{E}[Q]-\\mathbb{E}[Q_{h_L}]\\right| \\asymp c_B h_L^\\alpha$。\n    -   方差：$\\mathbb{V}[Y_\\ell] \\asymp c_V h_\\ell^\\beta$（对于 $\\ell \\ge 1$）。（我们假设 $\\mathbb{V}[Y_0]$ 是一个常数，如果 $\\beta=0$，这对于 $\\ell=0$ 也符合此模型；然而，标准理论将其作为一个独立的常数处理，这不影响渐近分析。）\n    -   成本：$C_\\ell \\asymp c_C h_\\ell^{-\\gamma}$。\n-   **约束**：总计算预算 $B  0$，满足 $\\sum_{\\ell=0}^{L} N_\\ell C_\\ell \\le B$。\n-   **目标**：通过选择层级数 $L$ 和每层的样本数量 $\\{N_\\ell\\}_{\\ell=0}^{L}$ 来最小化 MSE。\n\n**步骤2：根据提取的已知条件进行验证**\n\n根据验证标准对问题陈述进行评估：\n\n-   **科学依据**：该问题描述了分析应用于具有随机输入的偏微分方程的多层蒙特卡洛方法复杂性的标准理论框架。MSE的模型、对偏差、方差和成本的速率假设是不确定性量化和数值分析领域的基础。该设置在科学上是合理的。\n-   **适定的**：该问题是一个约束优化问题。目标函数在优化变量 ($1/N_\\ell$) 上是凸的，约束是线性的，这确保了一个定义明确的唯一解。问题要求的是优化后的 MSE 随预算 $B$ 的渐近缩放关系，这是复杂度分析中一个标准且有意义的问题。\n-   **客观的**：语言精确、数学化，并且没有主观性。所有术语都在数值分析的标准背景下定义。\n\n该问题不存在以下任何无效性缺陷：\n1.  **科学/事实不合理**：无违反。\n2.  **非形式化/不相关**：该问题是一个形式化的数学优化问题，与所述主题直接相关。\n3.  **不完整/矛盾的设置**：设置为执行所需的渐近分析是完整的。\n4.  **不切实际/不可行**：该设置为一大类问题提供了标准和现实的框架。\n5.  **不适定/结构不良**：该问题是适定的。\n6.  **琐碎/同义反复**：推导过程不平凡，需要几个步骤的分析。\n7.  **外部科学可验证性**：该问题是一个纯数学问题，可以通过推导来验证。\n\n**步骤3：结论与行动**\n\n问题陈述有效。我们可以继续进行求解。\n\n### 推导与求解\n\n目标是选择 $L$ 和 $\\{N_\\ell\\}$ 以在总预算 $B$ 的约束下最小化均方误差（MSE）。\n$$\n\\mathrm{MSE}(L, \\{N_\\ell\\}) = \\underbrace{\\left|\\mathbb{E}[Q] - \\mathbb{E}[Q_{h_L}]\\right|^2}_{\\text{偏差}^2} + \\underbrace{\\sum_{\\ell=0}^{L} \\frac{\\mathbb{V}[Y_\\ell]}{N_\\ell}}_{\\text{方差}} \\quad \\text{约束条件} \\quad \\sum_{\\ell=0}^{L} N_\\ell C_\\ell \\le B.\n$$\n优化通常分两个阶段进行：\n1.  对于固定的层级数 $L$，找到样本 $\\{N_\\ell\\}_{\\ell=0}^L$ 的最优分配，以在给定预算 $B$ 下最小化 MSE 的方差部分。\n2.  找到最优的层级数 $L$，以最小化总 MSE，这涉及到平衡偏差和最小化后的方差。\n\n**1. 固定 L 时的最优样本分配**\n\n对于固定的 $L$，偏差项是常数。问题简化为在预算约束下最小化方差。我们可以将 $N_\\ell$ 视为连续变量，并使用拉格朗日乘子法。在最优解处，约束将是激活的，即 $\\sum_{\\ell=0}^{L} N_\\ell C_\\ell = B$。\n\n拉格朗日函数为：\n$$\n\\mathcal{L}(\\{N_\\ell\\}, \\lambda) = \\sum_{\\ell=0}^{L} \\frac{\\mathbb{V}[Y_\\ell]}{N_\\ell} + \\lambda \\left(\\sum_{\\ell=0}^{L} N_\\ell C_\\ell - B\\right)\n$$\n令关于 $N_\\ell$ 的偏导数为零：\n$$\n\\frac{\\partial\\mathcal{L}}{\\partial N_\\ell} = -\\frac{\\mathbb{V}[Y_\\ell]}{N_\\ell^2} + \\lambda C_\\ell = 0 \\implies N_\\ell = \\frac{1}{\\sqrt{\\lambda}} \\sqrt{\\frac{\\mathbb{V}[Y_\\ell]}{C_\\ell}}\n$$\n我们将此结果代回预算约束中以求得拉格朗日乘子 $\\lambda$：\n$$\n\\sum_{\\ell=0}^{L} \\frac{1}{\\sqrt{\\lambda}} \\sqrt{\\frac{\\mathbb{V}[Y_\\ell]}{C_\\ell}} C_\\ell = B \\implies \\frac{1}{\\sqrt{\\lambda}} \\sum_{\\ell=0}^{L} \\sqrt{\\mathbb{V}[Y_\\ell] C_\\ell} = B \\implies \\frac{1}{\\sqrt{\\lambda}} = \\frac{B}{\\sum_{k=0}^{L} \\sqrt{\\mathbb{V}[Y_k] C_k}}\n$$\n将此结果代回 $N_\\ell$ 的表达式，我们得到最优分配 $N_\\ell^\\star$：\n$$\nN_\\ell^\\star = \\frac{B \\sqrt{\\mathbb{V}[Y_\\ell]/C_\\ell}}{\\sum_{k=0}^{L} \\sqrt{\\mathbb{V}[Y_k] C_k}}\n$$\n此分配下的最小化方差为：\n$$\n\\sum_{\\ell=0}^{L} \\frac{\\mathbb{V}[Y_\\ell]}{N_\\ell^\\star} = \\sum_{\\ell=0}^{L} \\mathbb{V}[Y_\\ell] \\frac{\\sum_{k=0}^{L} \\sqrt{\\mathbb{V}[Y_k] C_k}}{B \\sqrt{\\mathbb{V}[Y_\\ell]/C_\\ell}} = \\frac{1}{B} \\left(\\sum_{k=0}^{L} \\sqrt{\\mathbb{V}[Y_k] C_k}\\right) \\left(\\sum_{\\ell=0}^{L} \\sqrt{\\mathbb{V}[Y_\\ell] C_\\ell}\\right) = \\frac{1}{B} \\left(\\sum_{\\ell=0}^{L} \\sqrt{\\mathbb{V}[Y_\\ell] C_\\ell}\\right)^2\n$$\n\n**2. 最优 MSE 关于预算 B 的缩放关系**\n\n使用最优的 $\\{N_\\ell^\\star\\}$，对于给定的 $L$，MSE 为：\n$$\n\\mathrm{MSE}(L) = \\left|\\mathbb{E}[Q] - \\mathbb{E}[Q_{h_L}]\\right|^2 + \\frac{1}{B} \\left(\\sum_{\\ell=0}^{L} \\sqrt{\\mathbb{V}[Y_\\ell] C_\\ell}\\right)^2\n$$\n使用给定的速率模型：\n-   偏差项：$|\\mathbb{E}[Q] - \\mathbb{E}[Q_{h_L}]|^2 \\asymp (c_B h_L^\\alpha)^2 = c_B^2 h_L^{2\\alpha}$。\n-   求和项：$\\sqrt{\\mathbb{V}[Y_\\ell]C_\\ell} \\asymp \\sqrt{(c_V h_\\ell^\\beta)(c_C h_\\ell^{-\\gamma})} = \\sqrt{c_V c_C} h_\\ell^{(\\beta-\\gamma)/2}$。\n\n所以，MSE 的行为如下：\n$$\n\\mathrm{MSE}(L) \\asymp c_B^2 h_L^{2\\alpha} + \\frac{c_V c_C}{B} \\left(\\sum_{\\ell=0}^{L} h_\\ell^{(\\beta-\\gamma)/2}\\right)^2\n$$\n该和的行为取决于 $\\beta-\\gamma$ 的符号。令 $q = 2^{-(\\beta-\\gamma)/2}$。该和与 $\\sum_{\\ell=0}^L q^\\ell$ 成正比。\n\n**情况1：$\\beta  \\gamma$**\n此时，$q  1$。几何级数 $\\sum_{\\ell=0}^\\infty q^\\ell$ 收敛。对于大的 $L$，该和近似为常数。\n$\\mathrm{MSE}(L) \\asymp c_B^2 h_L^{2\\alpha} + \\frac{K_1}{B}$，其中 $K_1$ 是一个常数。\n为最小化此式，我们平衡这两项：$c_B^2 h_L^{2\\alpha} \\asymp B^{-1}$。\n那么最小 MSE 为 $\\mathrm{MSE}(B) \\asymp B^{-1} + B^{-1} \\asymp B^{-1}$。\n\n**情况2：$\\beta = \\gamma$**\n此时，$q = 1$。该和为 $\\sum_{\\ell=0}^{L} 1 = L+1$。\n$\\mathrm{MSE}(L) \\asymp c_B^2 h_L^{2\\alpha} + \\frac{K_2 (L+1)^2}{B}$。\n我们平衡这两项：$h_L^{2\\alpha} \\asymp \\frac{(L+1)^2}{B}$。由于 $h_L = h_0 2^{-L}$，这给出 $c(2^{-L})^{2\\alpha} \\asymp \\frac{L^2}{B} \\implies B \\asymp L^2 2^{2\\alpha L}$。取对数，对于大的 $L$，我们发现 $L \\asymp \\log B$。\n将其代回，最优 MSE 为 $\\mathrm{MSE}(B) \\asymp \\frac{(L+1)^2}{B} \\asymp \\frac{(\\log B)^2}{B}$。\n\n**情况3：$\\beta  \\gamma$**\n此时，$q  1$。几何级数由最后一项 $q^L$ 主导。\n$\\sum_{\\ell=0}^{L} h_\\ell^{(\\beta-\\gamma)/2} \\asymp h_L^{(\\beta-\\gamma)/2}$ (这是一个 slight simplification, the sum is proportional to the last term, which is correct).\n更准确地说，$\\sum_{\\ell=0}^L h_\\ell^{(\\beta-\\gamma)/2} \\asymp h_L^{(\\beta-\\gamma)/2}$，其中隐藏的常数取决于 $\\beta, \\gamma, h_0$。\nMSE 变为：\n$\\mathrm{MSE}(L) \\asymp c_B^2 h_L^{2\\alpha} + \\frac{K_3}{B} (h_L^{(\\beta-\\gamma)/2})^2 = c_B^2 h_L^{2\\alpha} + \\frac{K_3}{B} h_L^{\\beta-\\gamma}$。\n注意 $\\beta-\\gamma  0$。令 $h=h_L$。我们最小化 $f(h) = C_1 h^{2\\alpha} + C_2 B^{-1} h^{-(\\gamma-\\beta)}$。令导数为零可得 $h_{opt}^{2\\alpha+\\gamma-\\beta} \\asymp B^{-1}$。\n因此，$h_{opt} \\asymp B^{-1/(2\\alpha+\\gamma-\\beta)}$。\n那么最小 MSE 为 $\\mathrm{MSE}(B) \\asymp h_{opt}^{2\\alpha} \\asymp \\left(B^{-1/(2\\alpha+\\gamma-\\beta)}\\right)^{2\\alpha} = B^{-2\\alpha/(2\\alpha+\\gamma-\\beta)}$。\n\n### 逐项分析\n\n**A. 对于固定的 $L$，将 $N_\\ell$ 松弛到 $\\mathbb{R}_+$ ... 最终，最优均方误差关于 $B$ 的缩放关系为 ...**\n该选项正确地陈述了最优分配 $N_\\ell^\\star$、由此产生的最小化方差以及目标函数 $\\mathrm{MSE}(L)$。然后它正确地推导了最优 MSE 相对于预算 $B$ 的渐近缩放关系，涵盖了所有三种情况：$\\beta\\gamma$, $\\beta=\\gamma$ 和 $\\beta\\gamma$。推导结果与我们的分析完全吻合。\n**结论：正确。**\n\n**B. 在预算约束下，最优分配满足 $N_\\ell^\\star \\propto \\mathbb{V}[Y_\\ell]/C_\\ell$ ...**\n这是不正确的。根据推导，最优分配是 $N_\\ell^\\star \\propto \\sqrt{\\mathbb{V}[Y_\\ell]/C_\\ell}$。该陈述的其余部分基于这个错误的前提，因此也是不正确的。声称速率的错误指定影响可以忽略不计的说法与我们的分析直接矛盾，我们的分析显示了三个不同的缩放区。\n**结论：不正确。**\n\n**C. 对于固定的 $L$，预算下的方差最小化分配满足 $N_\\ell^\\star \\propto \\sqrt{\\mathbb{V}[Y_\\ell]/C_\\ell}$，但最小化后的方差等于 $\\left(\\sum_{\\ell=0}^{L} \\mathbb{V}[Y_\\ell]/C_\\ell\\right)/B$ ...**\n$N_\\ell^\\star$ 的比例关系陈述正确。但是，最小化方差的公式是错误的。我们的推导显示最小化方差是 $\\frac{1}{B} (\\sum_{\\ell=0}^{L} \\sqrt{\\mathbb{V}[Y_\\ell] C_\\ell})^2$。根据柯西-施瓦茨不等式，$(\\sum \\sqrt{V_\\ell C_\\ell})^2 \\neq \\sum (V_\\ell/C_\\ell)$ 在一般情况下不成立。这个不正确的公式导致了在所有情况下 $\\mathrm{MSE}(B)\\asymp B^{-1}$ 的错误结论。\n**结论：不正确。**\n\n**D. 对错误指定速率的敏感性是分情况的。错误判断 $\\beta-\\gamma$ 的符号 ... 会改变最优均方误差关于 B 的速率指数 ... 错误指定偏差指数 $\\alpha$ 仅在 $\\beta\\gamma$ 的情况下会改变速率指数 ...**\n这个陈述准确地总结了所推導的缩放定律的含义。\n-   最优 MSE 中 $B$ 的指数在 $\\beta\\gamma$ 时是 $-1$，在 $\\beta\\gamma$ 时是 $-\\frac{2\\alpha}{2\\alpha+\\gamma-\\beta}$。由于 $\\frac{2\\alpha}{2\\alpha+\\gamma-\\beta} \\neq 1$ (因为 $\\gamma-\\beta0$)，错误地分类情况（$\\beta-\\gamma$的符号）意味着会以一个不正确的理论复杂度率为目标。\n-   评估了速率指数对 $\\alpha$ 的依赖性。对于 $\\beta  \\gamma$，指数是 $-1$。对于 $\\beta = \\gamma$，速率是 $(\\log B)^2 B^{-1}$，所以 $B$ 的指数是 $-1$。两者都不依赖于 $\\alpha$。对于 $\\beta  \\gamma$，指数是 $-\\frac{2\\alpha}{2\\alpha+\\gamma-\\beta}$，它明确地依赖于 $\\alpha$。\n该陈述是根据理论结果得出的一个正确且富有洞察力的结论。\n**结论：正确。**\n\n**E. 最优的 $L$ 选择满足 $h_L^{2\\alpha}\\asymp B^{-1}$ 而不管 $\\beta$ 和 $\\gamma$ 的值如何，因此预算约束下的均方误差总是按 $B^{-1}$ 缩放（在相差一个常数的意义下）。**\n这个陈述是错误的。我们的分析表明，平衡条件 $h_L^{2\\alpha}\\asymp B^{-1}$ 仅在 $\\beta  \\gamma$ 的情况下才能实现。在另外两种情况下，关系是不同的。对于 $\\beta=\\gamma$，$h_L^{2\\alpha} \\asymp (\\log B)^2/B$。对于 $\\beta  \\gamma$，$h_L^{2\\alpha} \\asymp B^{-2\\alpha/(2\\alpha+\\gamma-\\beta)}$。因为前提是错误的，所以均方误差总是按 $B^{-1}$ 缩放的结论也是错误的。\n**结论：不正确。**", "answer": "$$\\boxed{AD}$$", "id": "3423160"}, {"introduction": "在探索了MLMC复杂度的理论基础之后，将这些概念与具体的数值结果联系起来是至关重要的。这个练习提供了一组具体的模拟数据，要求你为感兴趣的真实值构建一个置信区间。这项任务需要你仔细地综合两种误差来源——统计采样误差和确定性的离散化偏差——以得出一个关于最终估计不确定性的严谨陈述。[@problem_id:3322294]", "problem": "考虑一个用于随机过程实值泛函 $P$ 的期望的多层蒙特卡洛 (MLMC) 估计量，该估计量通过层级修正 $Y_{l} = P_{l} - P_{l-1}$（其中 $P_{-1} \\equiv 0$）的伸缩求和来构造。在层级 $L$ 上，截断期望 $\\mathbb{E}[P_{L}]$ 的 MLMC 估计量形式为 $\\widehat{P}_{\\mathrm{ML}} = \\sum_{l=0}^{L} \\widehat{Y}_{l}$，其中 $\\widehat{Y}_{l}$ 是 $Y_{l}$ 的 $N_{l}$ 个独立同分布样本的样本均值。假设各层级之间相互独立，并且在每个层级 $l$，样本方差 $s_{l}^{2}$ 是从 $N_{l}$ 个样本计算得出的。\n\n假设给定以下信息：\n- 层级数 $L = 3$。\n- 样本数量 $(N_{0}, N_{1}, N_{2}, N_{3}) = (1000, 800, 400, 200)$。\n- 样本方差 $(s_{0}^{2}, s_{1}^{2}, s_{2}^{2}, s_{3}^{2}) = (0.80, 0.40, 0.10, 0.025)$。\n- MLMC 点估计值 $\\widehat{P}_{\\mathrm{ML}} = 1.234$。\n- 一个基于弱阶 $\\alpha = 1$、常数 $C_{b} = 0.12$ 和二分加密因子 $2$ 的弱误差（偏差）界，使得截断偏差满足 $|\\mathbb{E}[P] - \\mathbb{E}[P_{L}]| \\leq C_{b} \\, 2^{-\\alpha L}$。\n- 置信水平参数 $\\delta = 0.05$。\n\n使用中心极限定理 (CLT) 对 MLMC 估计量和方差估计量\n$$\\widehat{\\sigma}^{2} = \\sum_{l=0}^{L} \\frac{s_{l}^{2}}{N_{l}}$$\n来为 $\\mathbb{E}[P]$ 构建一个保守的双边 $(1-\\delta)$ 置信区间，该区间需要同时考虑抽样方差和截断偏差。您的构建必须基于基本原理：伸缩求和表示、针对独立零均值项之和的 CLT 以及偏差界。然后，使用给定数据计算区间的数值端点。将您最终的区间端点四舍五入到四位有效数字。将您的最终答案表示为端点有序对 $\\bigl[\\text{下界}, \\text{上界}\\bigr]$。", "solution": "该问题要求使用多层蒙特卡洛 (MLMC) 估计量，为目标量的真实期望 $\\mathbb{E}[P]$ 构建一个双边 $(1-\\delta)$ 置信区间。MLMC 点估计值 $\\widehat{P}_{\\mathrm{ML}}$ 相对于真实期望 $\\mathbb{E}[P]$ 的总误差可以分解为两个部分：统计误差和截断误差（偏差）。\n\n总误差由下式给出：\n$$\n\\mathbb{E}[P] - \\widehat{P}_{\\mathrm{ML}} = \\underbrace{(\\mathbb{E}[P] - \\mathbb{E}[P_{L}])}_{\\text{偏差}} + \\underbrace{(\\mathbb{E}[P_{L}] - \\widehat{P}_{\\mathrm{ML}})}_{\\text{统计误差}}\n$$\n此处，$\\mathbb{E}[P_{L}]$ 是在最精细层级 $L$ 上近似的目标量的期望。\n\n第一项，即偏差，是未知的，但我们得到了其大小的界：\n$$\n|\\mathbb{E}[P] - \\mathbb{E}[P_{L}]| \\leq B_{L}\n$$\n其中 $B_{L} = C_{b} \\, 2^{-\\alpha L}$。给定的参数为弱收敛阶 $\\alpha=1$、常数 $C_b=0.12$ 以及层级数 $L=3$。我们可以计算这个界：\n$$\nB_{3} = C_{b} \\, 2^{-\\alpha L} = 0.12 \\times 2^{-1 \\times 3} = 0.12 \\times 2^{-3} = 0.12 \\times \\frac{1}{8} = 0.015\n$$\n\n第二项，即统计误差，是一个随机变量。MLMC 估计量定义为 $\\widehat{P}_{\\mathrm{ML}} = \\sum_{l=0}^{L} \\widehat{Y}_{l}$，其中 $\\widehat{Y}_{l}$ 是层级修正 $Y_l$ 的 $N_l$ 次实现的样本均值。MLMC 估计量的期望为 $\\mathbb{E}[\\widehat{P}_{\\mathrm{ML}}] = \\mathbb{E}[P_L]$，这意味着它是截断期望的无偏估计量。假设各层级之间独立，MLMC 估计量的方差是各层级估计量方差之和：\n$$\n\\mathbb{V}[\\widehat{P}_{\\mathrm{ML}}] = \\sum_{l=0}^{L} \\mathbb{V}[\\widehat{Y}_{l}] = \\sum_{l=0}^{L} \\frac{\\mathbb{V}[Y_{l}]}{N_{l}} = \\sum_{l=0}^{L} \\frac{\\sigma_{l}^{2}}{N_{l}}\n$$\n我们得到了一个基于样本方差 $s_{l}^{2}$ 的该方差的估计量：\n$$\n\\widehat{\\sigma}^{2} = \\sum_{l=0}^{L} \\frac{s_{l}^{2}}{N_{l}}\n$$\n使用 $L=3$ 的给定数据：\n- 样本数量 $(N_{0}, N_{1}, N_{2}, N_{3}) = (1000, 800, 400, 200)$\n- 样本方差 $(s_{0}^{2}, s_{1}^{2}, s_{2}^{2}, s_{3}^{2}) = (0.80, 0.40, 0.10, 0.025)$\n我们计算估计方差：\n$$\n\\widehat{\\sigma}^{2} = \\frac{0.80}{1000} + \\frac{0.40}{800} + \\frac{0.10}{400} + \\frac{0.025}{200}\n$$\n$$\n\\widehat{\\sigma}^{2} = 0.0008 + 0.0005 + 0.00025 + 0.000125 = 0.001675\n$$\n估计的标准差为 $\\widehat{\\sigma} = \\sqrt{0.001675}$。\n\n根据中心极限定理，统计误差经其标准差归一化后，其分布近似于标准正态分布。这使我们能够为截断期望 $\\mathbb{E}[P_{L}]$ 构建一个置信区间：\n$$\n\\mathbb{P}\\left(|\\widehat{P}_{\\mathrm{ML}} - \\mathbb{E}[P_{L}]| \\leq z_{1-\\delta/2} \\widehat{\\sigma}\\right) \\approx 1-\\delta\n$$\n其中 $z_{1-\\delta/2}$ 是标准正态分布的 $(1-\\delta/2)$-分位数。对于给定的置信参数 $\\delta = 0.05$，我们需要一个 $(1-0.05) = 0.95$ 的置信水平，这对应于 $z_{1-0.05/2} = z_{0.975} \\approx 1.96$。\n\n为了为真实期望 $\\mathbb{E}[P]$ 构建一个置信区间，我们必须同时考虑统计不确定性和偏差。一个保守的方法是将偏差界加到统计误差范围上。总误差由以下不等式界定：\n$$\n|\\mathbb{E}[P] - \\widehat{P}_{\\mathrm{ML}}| \\leq |\\mathbb{E}[P] - \\mathbb{E}[P_L]| + |\\mathbb{E}[P_L] - \\widehat{P}_{\\mathrm{ML}}|\n$$\n这导出了 $\\mathbb{E}[P]$ 的一个置信区间，形式为 $\\widehat{P}_{\\mathrm{ML}} \\pm E$，其中总误差范围 $E$ 是统计半宽和偏差界之和：\n$$\nE = z_{1-\\delta/2} \\widehat{\\sigma} + B_{3}\n$$\n我们继续计算 $E$：\n$$\nE = 1.96 \\times \\sqrt{0.001675} + 0.015\n$$\n$$\nE \\approx 1.96 \\times 0.04092676 + 0.015 \\approx 0.08021645 + 0.015 = 0.09521645\n$$\n$\\mathbb{E}[P]$ 的置信区间由 $[\\text{下端点}, \\text{上端点}]$ 给出，其中：\n- 下端点: $\\widehat{P}_{\\mathrm{ML}} - E = 1.234 - 0.09521645 = 1.13878355$\n- 上端点: $\\widehat{P}_{\\mathrm{ML}} + E = 1.234 + 0.09521645 = 1.32921645$\n\n问题要求将最终的区间端点四舍五入到四位有效数字。\n- 下端点: $1.13878355 \\approx 1.139$\n- 上端点: $1.32921645 \\approx 1.329$\n\n最终得到的置信区间是 $[1.139, 1.329]$。", "answer": "$$\\boxed{\\bigl[1.139, 1.329\\bigr]}$$", "id": "3322294"}]}