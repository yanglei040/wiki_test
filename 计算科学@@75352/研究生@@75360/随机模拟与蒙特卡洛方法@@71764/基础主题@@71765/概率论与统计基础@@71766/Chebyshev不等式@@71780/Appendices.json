{"hands_on_practices": [{"introduction": "这项练习是一个思想实验，旨在巩固您对“方差”这一核心概念的理解。当一个随机变量的方差为零时，意味着什么？切比雪夫不等式为这个问题提供了一个严谨的答案，帮助我们阐明方差与变量偏离其均值的概率之间的根本联系。[@problem_id:1903432]", "problem": "一位投资分析师正在研究一种理论上的金融资产，其日收益由随机变量 $X$ 表示。该资产被宣传为“完全稳定”，这意味着它被设计为具有恒定的回报。从统计学上讲，这意味着其期望收益是一个常数 $\\mu$，且其方差为 $\\sigma^2 = 0$。该分析师在未对 $X$ 的具体概率分布做任何假设的情况下，决定使用切比雪夫不等式来分析收益偏离其期望值的概率。\n\n根据切比雪夫不等式，概率 $P(X \\neq \\mu)$ 的上界值是多少？\n\nA. 1\n\nB. 0.5\n\nC. 0\n\nD. 在不知道 $\\mu$ 的情况下无法确定上界。\n\nE. 切比雪夫不等式不适用于零方差的情况。", "solution": "问题要求基于切比雪夫不等式，求出均值为 $\\mu$、方差为 $\\sigma^2 = 0$ 的随机变量 $X$ 的概率 $P(X \\neq \\mu)$ 的上界。\n\n首先，我们陈述切比雪夫不等式的一种常见形式。对于具有有限均值 $\\mu$ 和有限非零方差 $\\sigma^2$ 的随机变量 $X$，以及对于任何实数 $\\epsilon > 0$，该不等式表明：\n$$P(|X - \\mu| \\ge \\epsilon) \\le \\frac{\\sigma^2}{\\epsilon^2}$$\n该不等式在 $\\sigma^2=0$ 的情况下也成立。选项 E 声称该不等式不适用，但这是不正确的；有限均值和方差的条件得到了满足。\n\n我们关心的是概率 $P(X \\neq \\mu)$。条件 $X \\neq \\mu$ 等价于条件 $|X - \\mu| > 0$。\n事件 $|X - \\mu| > 0$ 可以表示为嵌套事件的可数并集。让我们考虑一个趋近于零的正数序列，例如，对于 $n = 1, 2, 3, \\ldots$，有 $\\epsilon_n = \\frac{1}{n}$。事件 $|X - \\mu|$ 严格大于零与存在某个整数 $n$ 使得 $|X - \\mu| \\ge \\frac{1}{n}$ 的事件是相同的。\n因此，我们可以写出：\n$$ \\{X \\neq \\mu\\} = \\bigcup_{n=1}^{\\infty} \\left\\{ |X - \\mu| \\ge \\frac{1}{n} \\right\\} $$\n\n现在，我们将切比雪夫不等式应用于这个并集中的每个事件。对于任何特定的 $n$，我们可以设 $\\epsilon = \\frac{1}{n}$。我们已知方差 $\\sigma^2 = 0$。\n应用该不等式可得：\n$$ P\\left(|X - \\mu| \\ge \\frac{1}{n}\\right) \\le \\frac{\\sigma^2}{(1/n)^2} = \\frac{0}{(1/n)^2} = 0 $$\n由于概率必须为非负数，这个不等式意味着对于每个正整数 $n$：\n$$ P\\left(|X - \\mu| \\ge \\frac{1}{n}\\right) = 0 $$\n\n现在我们可以确定这个并集的概率。使用概率对于递增事件序列的连续性性质，我们有：\n$$ P(X \\neq \\mu) = P\\left(\\bigcup_{n=1}^{\\infty} \\left\\{ |X - \\mu| \\ge \\frac{1}{n} \\right\\}\\right) = \\lim_{n\\to\\infty} P\\left(|X - \\mu| \\ge \\frac{1}{n}\\right) $$\n由于极限中的每一项都是 0，结果是：\n$$ P(X \\neq \\mu) = \\lim_{n\\to\\infty} 0 = 0 $$\n或者，我们可以使用布尔不等式（Boole's inequality，或称并集界），它指出对于任何可数事件集合 $A_n$，有 $P(\\cup A_n) \\le \\sum P(A_n)$。\n$$ P(X \\neq \\mu) \\le \\sum_{n=1}^{\\infty} P\\left(|X - \\mu| \\ge \\frac{1}{n}\\right) = \\sum_{n=1}^{\\infty} 0 = 0 $$\n同样，由于概率是非负的，这迫使 $P(X \\neq \\mu) = 0$。\n\n切比雪夫不等式使我们得出结论，即概率 $P(X \\neq \\mu)$ 至多为 0。因此，这个概率的上界值为 0。\n\n让我们回顾一下选项：\nA. 1: 不正确。\nB. 0.5: 不正确。\nC. 0: 正确。不等式给出的上界是 0。\nD. 在不知道 $\\mu$ 的情况下无法确定上界：不正确。结果与 $\\mu$ 无关。\nE. 切比雪夫不等式不适用于零方差：不正确。该不等式对于 $\\sigma^2 \\ge 0$ 是有效的。\n\n正确的结论是该概率的上界为 0。", "answer": "$$\\boxed{C}$$", "id": "1903432"}, {"introduction": "切比雪夫不等式因其普适性而非常强大，但它的一个重要特点是其界限通常比较宽松。本练习将通过一个具体的计算来量化这个界限到底有多“松”，您将把切比雪夫界与著名的高斯分布的精确尾部概率进行比较。这有助于培养一种批判性思维，即在何种情况下使用该不等式是合适的，并理解其保守性的来源。[@problem_id:3294065]", "problem": "考虑一个实值随机变量 $X$，它服从均值为 $\\mu$、方差为 $\\sigma^{2}$ 的高斯（正态）分布，记为 $X \\sim \\mathcal{N}(\\mu,\\sigma^{2})$。在随机模拟和蒙特卡洛（MC）方法中，尾部边界控制着估计量大偏差的概率。对于有界方差的随机变量，一个基本的不等式是切比雪夫不等式，它指出对于任何 $k>0$，\n$$\n\\mathbb{P}\\!\\left(|X-\\mu|\\geq k\\,\\sigma\\right)\\leq \\frac{1}{k^{2}}.\n$$\n请从第一性原理出发，计算高斯分布的实际双边尾部概率，然后将其与切比雪夫界进行比较。具体而言：\n- 从正态分布的概率密度函数\n$$\nf_{X}(x)=\\frac{1}{\\sqrt{2\\pi}\\,\\sigma}\\,\\exp\\!\\left(-\\frac{(x-\\mu)^{2}}{2\\sigma^{2}}\\right),\n$$\n以及累积分布函数（CDF）的定义出发，推导出对于一般 $k>0$ 的 $\\mathbb{P}(|X-\\mu|\\geq k\\,\\sigma)$ 的精确表达式。\n- 对阈值集合 $\\{k=1,\\,k=2,\\,k=3\\}$ 计算这个精确的尾部概率。\n- 通过将集合 $\\{1,2,3\\}$ 上的几何平均保守性指数定义为\n$$\nC:=\\left(\\prod_{k\\in\\{1,2,3\\}}\\frac{\\frac{1}{k^{2}}}{\\mathbb{P}\\!\\left(|X-\\mu|\\geq k\\,\\sigma\\right)}\\right)^{\\frac{1}{3}}.\n$$\n来量化切比雪夫不等式的保守性。从您推导出的尾部概率中精确计算 $C$。\n\n解释为什么该指数能够捕捉到在蒙特卡洛（MC）误差分析中，切比雪夫界对次高斯尾部的典型乘性高估，并将此计算与高斯尾部的结构联系起来，除了核心定义和关于高斯积分的公认事实外，不使用任何快捷公式。\n\n将您的最终数值 $C$ 四舍五入到四位有效数字。答案不需要单位。", "solution": "该问题要求推导高斯随机变量的精确尾部概率，将此概率与切比雪夫不等式提供的界进行比较，并计算一个量化这种差异的“保守性指数”。\n\n设 $X$ 是一个服从均值为 $\\mu$、方差为 $\\sigma^2$ 的高斯（正态）分布的随机变量，记为 $X \\sim \\mathcal{N}(\\mu, \\sigma^2)$。其概率密度函数（PDF）由下式给出\n$$f_{X}(x) = \\frac{1}{\\sqrt{2\\pi}\\sigma} \\exp\\left(-\\frac{(x - \\mu)^2}{2\\sigma^2}\\right)$$\n\n首先，我们推导对于某个常数 $k > 0$ 的双边尾部概率 $\\mathbb{P}(|X-\\mu| \\geq k\\sigma)$ 的精确表达式。不等式 $|X - \\mu| \\geq k\\sigma$ 等价于两个不相交事件的并集：$(X - \\mu) \\geq k\\sigma$ 或 $(X - \\mu) \\leq -k\\sigma$。\n因此，该概率是这两个事件概率的和：\n$$\\mathbb{P}(|X - \\mu| \\geq k\\sigma) = \\mathbb{P}(X \\geq \\mu + k\\sigma) + \\mathbb{P}(X \\leq \\mu - k\\sigma)$$\n为了简化计算，我们对随机变量 $X$ 进行标准化。令 $Z = \\frac{X - \\mu}{\\sigma}$。随机变量 $Z$ 服从标准正态分布 $Z \\sim \\mathcal{N}(0, 1)$，其概率密度函数为 $\\phi(z) = \\frac{1}{\\sqrt{2\\pi}} \\exp(-z^2/2)$。不等式 $|X - \\mu| \\geq k\\sigma$ 可以用 $Z$ 重写为：\n$$\\left|\\frac{X - \\mu}{\\sigma}\\right| \\geq k \\implies |Z| \\geq k$$\n概率变为\n$$\\mathbb{P}(|Z| \\geq k) = \\mathbb{P}(Z \\geq k) + \\mathbb{P}(Z \\leq -k)$$\n由于标准正态分布关于 $z=0$ 的对称性，我们有 $\\mathbb{P}(Z \\leq -k) = \\mathbb{P}(Z \\geq k)$。因此，\n$$\\mathbb{P}(|Z| \\geq k) = 2 \\, \\mathbb{P}(Z \\geq k)$$\n这个概率可以表示为标准正态概率密度函数的积分：\n$$\\mathbb{P}(|Z| \\geq k) = 2 \\int_{k}^{\\infty} \\phi(z) \\, dz = 2 \\int_{k}^{\\infty} \\frac{1}{\\sqrt{2\\pi}} \\exp\\left(-\\frac{z^2}{2}\\right) dz$$\n这个积分定义了标准正态分布的尾部概率。它通常用互补误差函数 $\\text{erfc}(x)$ 来表示，其定义为\n$$\\text{erfc}(x) = \\frac{2}{\\sqrt{\\pi}} \\int_{x}^{\\infty} \\exp(-t^2) dt$$\n为了将我们的积分与此定义联系起来，我们在积分中进行变量替换。令 $t = z/\\sqrt{2}$。那么 $z = \\sqrt{2}t$ 且 $dz = \\sqrt{2}dt$。积分下限 $z=k$ 变为 $t=k/\\sqrt{2}$。上限仍为无穷大。\n\\begin{align*} \\mathbb{P}(|X-\\mu| \\geq k\\sigma) &= 2 \\int_{k}^{\\infty} \\frac{1}{\\sqrt{2\\pi}} \\exp\\left(-\\frac{z^2}{2}\\right) dz \\\\ &= \\frac{2}{\\sqrt{2\\pi}} \\int_{k/\\sqrt{2}}^{\\infty} \\exp(-t^2) (\\sqrt{2}dt) \\\\ &= \\frac{2\\sqrt{2}}{\\sqrt{2\\pi}} \\int_{k/\\sqrt{2}}^{\\infty} \\exp(-t^2) dt \\\\ &= \\frac{2}{\\sqrt{\\pi}} \\int_{k/\\sqrt{2}}^{\\infty} \\exp(-t^2) dt \\end{align*}\n根据互补误差函数的定义，这恰好是 $\\text{erfc}(k/\\sqrt{2})$。\n因此，尾部概率的精确表达式是\n$$\\mathbb{P}(|X-\\mu| \\geq k\\sigma) = \\text{erfc}\\left(\\frac{k}{\\sqrt{2}}\\right)$$\n\n接下来，我们对 $k \\in \\{1, 2, 3\\}$ 计算这个精确概率。我们将这些概率记为 $P_k = \\mathbb{P}(|X-\\mu| \\geq k\\sigma)$。\n对于 $k=1$：\n$$P_1 = \\text{erfc}\\left(\\frac{1}{\\sqrt{2}}\\right) \\approx 0.3173105$$\n对于 $k=2$：\n$$P_2 = \\text{erfc}\\left(\\frac{2}{\\sqrt{2}}\\right) = \\text{erfc}(\\sqrt{2}) \\approx 0.0455003$$\n对于 $k=3$：\n$$P_3 = \\text{erfc}\\left(\\frac{3}{\\sqrt{2}}\\right) \\approx 0.0026998$$\n相应的切比雪夫界为 $1/k^2$：对于 $k=1$，界是 $1$；对于 $k=2$，界是 $1/4 = 0.25$；对于 $k=3$，界是 $1/9 \\approx 0.1111$。\n\n现在，我们计算几何平均保守性指数 $C$。\n$$C = \\left(\\prod_{k\\in\\{1,2,3\\}} \\frac{1/k^2}{P_k}\\right)^{1/3} = \\left( \\frac{1/1^2}{P_1} \\cdot \\frac{1/2^2}{P_2} \\cdot \\frac{1/3^2}{P_3} \\right)^{1/3}$$\n让我们计算各个比率，这些比率代表了切比雪夫不等式高估真实概率的因子：\n$k=1$ 的比率：$R_1 = \\frac{1}{P_1} = \\frac{1}{0.3173105} \\approx 3.15147$\n$k=2$ 的比率：$R_2 = \\frac{1/4}{P_2} = \\frac{0.25}{0.0455003} \\approx 5.49448$\n$k=3$ 的比率：$R_3 = \\frac{1/9}{P_3} = \\frac{1/9}{0.0026998} \\approx 41.1565$\n这些比率的乘积是\n$$R_1 \\cdot R_2 \\cdot R_3 \\approx 3.15147 \\times 5.49448 \\times 41.1565 \\approx 712.56$$\n指数 $C$ 是这个乘积的立方根：\n$$C = (712.56)^{1/3} \\approx 8.93208$$\n四舍五入到四位有效数字，我们得到 $C \\approx 8.932$。\n\n保守性指数 $C$ 量化了切比雪夫不等式为高斯分布提供一个宽松界的程度。乘积中的每一项 $\\frac{1/k^2}{P_k}$ 是切比雪夫界超过实际尾部概率的乘性因子。几何平均数是这些因子的合适平均值，因为它给出了在所选尺度 $k \\in \\{1, 2, 3\\}$ 上的典型高估程度。$C \\approx 8.932$ 的值表明，对于这些小的 $k$ 值，平均而言，切比雪夫界比真实的高斯尾部概率大将近一个数量级。\n\n这种显著的差异是因为切比雪夫不等式是普适的。它适用于任何具有有限方差的随机变量，而无需对其分布形状做任何进一步的假设。该界仅对将概率质量集中在远离均值、恰好在 $\\pm k\\sigma$ 边界上的“最坏情况”分布是“紧”的。高斯分布则根本不同；它是一个“次高斯”分布，意味着其尾部以指数速度衰减（具体为 $\\exp(-z^2/2)$）。这比切比雪夫界的代数衰减 $1/k^2$ 快得多。随着 $k$ 的增加，高估因子迅速增长，从 $R_1 \\approx 3.15$ 到 $R_3 \\approx 41.16$ 的跳跃就说明了这一点。在蒙特卡洛（MC）误差分析的背景下，估计量通常是许多随机变量的和，根据中心极限定理，它们的分布近似于高斯分布。使用切比雪夫不等式来界定大估计误差的概率将是极其悲观的。这个计算表明，利用（近似的）分布形状知识可以得到更紧、更现实的误差界，这对于评估蒙特卡洛（MC）模拟的可靠性和效率至关重要。", "answer": "$$\n\\boxed{8.932}\n$$", "id": "3294065"}, {"introduction": "现在我们转向一个实际应用。在许多现实场景中（例如蒙特卡洛模拟），我们并不知道真实的方差。这个问题将展示一种强大的技术：如何利用其他已知信息（如变量的取值范围）来推导一个“最坏情况”下的方差上界，然后应用切比雪夫不等式来构建一个可靠的置信区间。这个练习展示了该不等式在提供稳健统计保证方面的重要作用。[@problem_id:3294078]", "problem": "在一个蒙特卡洛估计情景中，设 $X$ 是一个标量随机变量，其分布未知，但支撑集为一个已知的区间 $[a,b]$，其中 $a<b$。给定 $n$ 个来自 $X$ 的独立同分布（i.i.d.）样本，我们用样本均值 $\\overline{X}_{n} := \\frac{1}{n} \\sum_{i=1}^{n} X_i$ 来估计未知的真实均值 $\\mu = \\mathbb{E}[X]$。\n\n您的任务是推导一个基于切比雪夫不等式的双侧对称置信区间的最小确定性半宽度 $h$。该区间的形式为 $[\\overline{X}_{n} - h, \\overline{X}_{n} + h]$，并且必须为任何在 $[a,b]$ 上有支撑集的分布提供至少为 $1-\\delta$ 的覆盖保证。换句话说，您需要找到一个函数 $h(a,b,n,\\delta)$，使得对于任何在 $[a,b]$ 上有支撑集的随机变量 $X$，都有 $\\mathbb{P}(|\\overline{X}_{n} - \\mu| \\le h) \\ge 1-\\delta$。\n\n为此，您需要首先推导单个样本方差 $\\sigma^2 = \\mathbb{V}\\mathrm{ar}(X)$ 的一个仅依赖于 $a$ 和 $b$ 的最紧上界。然后，将此上界应用于样本均值的切比雪夫不等式，以确定所需的半宽度 $h$。", "solution": "首先，我们来推导方差 $\\sigma^2 = \\mathbb{V}\\mathrm{ar}(X)$ 的一个上界，该上界仅依赖于已知的区间端点 $a$ 和 $b$。$X$ 的方差定义为 $\\sigma^2 = \\mathbb{E}[X^2] - (\\mathbb{E}[X])^2 = \\mathbb{E}[X^2] - \\mu^2$。由于 $X$ 的支撑集是 $[a, b]$，因此可以保证 $a \\le X \\le b$。这意味着 $(X-a) \\ge 0$ 且 $(X-b) \\le 0$。因此，这两项的乘积必然是非正的：\n$$ (X-a)(X-b) \\le 0 $$\n展开不等式的左侧得到：\n$$ X^2 - (a+b)X + ab \\le 0 $$\n根据期望的线性性质，我们可以对该不等式两边取期望：\n$$ \\mathbb{E}[X^2 - (a+b)X + ab] \\le 0 $$\n$$ \\mathbb{E}[X^2] - (a+b)\\mathbb{E}[X] + ab \\le 0 $$\n代入 $\\mu = \\mathbb{E}[X]$，我们得到 $\\mathbb{E}[X^2]$ 的一个上界：\n$$ \\mathbb{E}[X^2] \\le (a+b)\\mu - ab $$\n现在，我们可以将此上界代入方差的表达式中：\n$$ \\sigma^2 = \\mathbb{E}[X^2] - \\mu^2 \\le (a+b)\\mu - ab - \\mu^2 $$\n我们定义一个函数 $f(\\mu) = -\\mu^2 + (a+b)\\mu - ab$。为了找到 $\\sigma^2$ 的最紧上界，我们需要求出 $f(\\mu)$ 的最大值。函数 $f(\\mu)$ 是一个关于 $\\mu$ 的二次函数，表示一个开口向下的抛物线。其最大值出现在顶点处。顶点的 $\\mu$ 坐标是：\n$$ \\mu_{\\text{vertex}} = -\\frac{(a+b)}{2(-1)} = \\frac{a+b}{2} $$\n由于 $X$ 的支撑集是 $[a, b]$，其均值 $\\mu$ 也必须位于这个区间内，即 $a \\le \\mu \\le b$。顶点 $\\mu = \\frac{a+b}{2}$ 是 $[a, b]$ 的中点，因此是均值的一个有效的可能值。$f(\\mu)$ 的最大值在此顶点处取得：\n$$ \\max_{\\mu} f(\\mu) = f\\left(\\frac{a+b}{2}\\right) = -\\left(\\frac{a+b}{2}\\right)^2 + (a+b)\\left(\\frac{a+b}{2}\\right) - ab $$\n$$ = -\\frac{(a+b)^2}{4} + \\frac{2(a+b)^2}{4} - \\frac{4ab}{4} = \\frac{(a+b)^2 - 4ab}{4} = \\frac{a^2 + 2ab + b^2 - 4ab}{4} = \\frac{a^2 - 2ab + b^2}{4} = \\frac{(b-a)^2}{4} $$\n因此，我们得到了方差的上界，这被称为波波维奇不等式（Popoviciu's inequality）：\n$$ \\sigma^2 \\le \\frac{(b-a)^2}{4} $$\n\n接下来，我们构建置信区间。给定 $n$ 个独立同分布的样本 $X_1, \\dots, X_n$ 和样本均值 $\\overline{X}_n = \\frac{1}{n}\\sum_{i=1}^{n} X_i$。样本均值的均值为 $\\mathbb{E}[\\overline{X}_n] = \\mu$，其方差为 $\\mathbb{V}\\mathrm{ar}(\\overline{X}_n) = \\frac{\\sigma^2}{n}$。\n\n切比雪夫不等式指出，对于一个均值为 $\\mathbb{E}[Y]$、方差为 $\\mathbb{V}\\mathrm{ar}(Y)$ 的随机变量 $Y$，以及任意常数 $k > 0$：\n$$ P(|Y - \\mathbb{E}[Y]| \\ge k) \\le \\frac{\\mathbb{V}\\mathrm{ar}(Y)}{k^2} $$\n我们将此不等式应用于随机变量 $Y = \\overline{X}_n$，并将常数 $k$ 设为所需的半宽度 $h$：\n$$ P(|\\overline{X}_n - \\mu| \\ge h) \\le \\frac{\\mathbb{V}\\mathrm{ar}(\\overline{X}_n)}{h^2} = \\frac{\\sigma^2}{nh^2} $$\n置信区间为 $[\\overline{X}_n - h, \\overline{X}_n + h]$。要求是其覆盖概率（即该区间包含真实均值 $\\mu$ 的概率）至少为 $1-\\delta$。该条件表示为：\n$$ P(\\mu \\in [\\overline{X}_n - h, \\overline{X}_n + h]) \\ge 1-\\delta $$\n这等价于 $P(|\\overline{X}_n - \\mu| \\le h) \\ge 1-\\delta$。其互补事件，或称失败事件，是 $\\mu$ 不在该区间内，即 $|\\overline{X}_n - \\mu| > h$。这个失败事件的概率必须至多为 $\\delta$：\n$$ P(|\\overline{X}_n - \\mu| > h) \\le \\delta $$\n根据概率的性质，$P(|\\overline{X}_n - \\mu| > h) \\le P(|\\overline{X}_n - \\mu| \\ge h)$。因此，为了保证失败概率至多为 $\\delta$，施加更强的条件 $P(|\\overline{X}_n - \\mu| \\ge h) \\le \\delta$ 就足够了。\n使用切比雪夫不等式的界，我们要求：\n$$ \\frac{\\sigma^2}{nh^2} \\le \\delta $$\n这个不等式仍然包含未知的方差 $\\sigma^2$。为确保该条件对 $[a, b]$ 上的任何有效分布都成立，我们必须使用 $\\sigma^2$ 的最坏情况，即其可能的最大值。我们代入之前推导出的上界 $\\sigma^2 \\le \\frac{(b-a)^2}{4}$：\n$$ \\frac{(b-a)^2 / 4}{nh^2} \\le \\delta $$\n现在我们求解 $h$。由于 $h$ 是一个宽度，它必须是正数。重新整理不等式得到：\n$$ \\frac{(b-a)^2}{4n\\delta} \\le h^2 $$\n对两边取正平方根，我们得到：\n$$ h \\ge \\sqrt{\\frac{(b-a)^2}{4n\\delta}} = \\frac{b-a}{2\\sqrt{n\\delta}} $$\n问题要求的是保证覆盖概率的最小确定性半宽度 $h$。这对应于选择 $h$ 的最小可能值，即其下界本身。因此，$h(a,b,n,\\delta)$ 的表达式为：\n$$ h(a,b,n,\\delta) = \\frac{b-a}{2\\sqrt{n\\delta}} $$\n该表达式仅依赖于给定的量 $a$、$b$、$n$ 和 $\\delta$，符合要求。", "answer": "$$\\boxed{\\frac{b-a}{2\\sqrt{n\\delta}}}$$", "id": "3294078"}]}