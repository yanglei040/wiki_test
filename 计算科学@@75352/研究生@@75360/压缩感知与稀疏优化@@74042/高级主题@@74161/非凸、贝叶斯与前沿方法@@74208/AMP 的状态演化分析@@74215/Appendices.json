{"hands_on_practices": [{"introduction": "状态演化（State Evolution, SE）不仅能预测近似消息传递（AMP）算法的性能，更是一个强大的算法设计工具。本练习将引导您亲手实践这一设计原则，通过分析计算来优化一个简单去噪器中的关键参数。您将看到，通过最小化状态演化所预测的均方误差（MSE），我们可以为正软阈值（positive soft-thresholding）去噪器确定最优的阈值[@problem_id:3481509]，从而将状态演化从一个纯粹的分析工具转变为一个主动的优化工具。", "problem": "考虑用于压缩感知的近似消息传递（AMP）算法，其测量比为 $\\delta \\in (0,1)$，加性高斯白测量噪声的方差为 $\\sigma_{w}^{2}$。状态演化（SE）通过以下公式跟踪第 $t$ 次迭代时的有效标量噪声：\n$$\n\\tau_{t+1}^{2} \\;=\\; \\sigma_{w}^{2} \\;+\\; \\frac{1}{\\delta} \\,\\mathbb{E}\\!\\left[\\big(\\eta_{t}(X_{0}+\\tau_{t} Z) - X_{0}\\big)^{2}\\right],\n$$\n其中 $Z \\sim \\mathcal{N}(0,1)$ 与 $X_{0}$ 独立，$\\eta_{t}$ 是逐分量应用的标量去噪器。\n\n在本问题中，您将确定一个标量去噪阈值，该阈值能够最小化状态演化（SE）更新中的均方误差（MSE），然后用它来预测下一个有效方差。假设设置如下：\n\n- 迭代索引 $t$ 是固定的，已知量为 $\\delta = 0.8$，$\\sigma_{w}^{2} = 1.0 \\times 10^{-2}$ 和 $\\tau_{t} = 0.5$。\n- 未知信号分量是非负且确定性的，$X_{0} = \\mu$，其中 $\\mu = 0.3989422804$。\n- 标量去噪器是正软阈值规则\n$$\n\\eta_{t}(u;\\lambda) \\;=\\; \\max(u-\\lambda,\\,0),\n$$\n其中标量阈值 $\\lambda \\geq 0$ 需要被优化。\n\n从上述 SE 定义出发，利用高斯随机变量的条件期望定律和微积分基本原理，推导出能使均方误差（MSE）最小化的阈值 $\\lambda^{\\star}$\n$$\n\\mathbb{E}\\!\\left[\\big(\\eta_{t}(X_{0}+\\tau_{t} Z;\\lambda) - X_{0}\\big)^{2}\\right]\n$$\n在 $\\lambda \\geq 0$ 的范围内。然后，将 $\\lambda^{\\star}$ 代入 SE 更新公式以预测 $\\tau_{t+1}^{2}$。\n\n在代入数值之前，请以符号形式进行所有必要的推导。将最终答案中的所有数值结果四舍五入到四位有效数字。以双元素行向量 $\\big(\\lambda^{\\star},\\,\\tau_{t+1}^{2}\\big)$ 的形式提供您的最终答案，不带单位。", "solution": "我们从 AMP 状态演化（SE）递归式开始\n$$\n\\tau_{t+1}^{2} \\;=\\; \\sigma_{w}^{2} \\;+\\; \\frac{1}{\\delta} \\,\\mathbb{E}\\!\\left[\\big(\\eta_{t}(X_{0}+\\tau_{t} Z) - X_{0}\\big)^{2}\\right],\n$$\n其中 $Z \\sim \\mathcal{N}(0,1)$，并且在本问题中，$X_{0} = \\mu \\geq 0$ 是确定性的。去噪器是正软阈值\n$$\n\\eta_{t}(u;\\lambda) \\;=\\; \\max(u-\\lambda,\\,0), \\quad \\lambda \\geq 0.\n$$\n令 $Y = X_{0} + \\tau_{t} Z = \\mu + \\tau_{t} Z$。需要对 $\\lambda$ 最小化的均方误差（MSE）为\n$$\nR(\\lambda) \\;=\\; \\mathbb{E}\\!\\left[\\big(\\eta_{t}(Y;\\lambda) - \\mu\\big)^{2}\\right].\n$$\n由于 $Y$ 是均值为 $\\mu$、方差为 $\\tau_{t}^{2}$ 的高斯变量，即 $Y \\sim \\mathcal{N}(\\mu,\\tau_{t}^{2})$。根据阈值定义事件划分：\n- 如果 $Y \\leq \\lambda$，则 $\\eta_{t}(Y;\\lambda) = 0$，平方误差为 $\\mu^{2}$。\n- 如果 $Y > \\lambda$，则 $\\eta_{t}(Y;\\lambda) = Y - \\lambda$，平方误差为 $(Y - \\lambda - \\mu)^{2}$。\n\n为了找到最优阈值，我们将 $R(\\lambda)$ 对 $\\lambda$ 求导并令其导数为零。使用莱布尼茨积分法则或更直接的基于斯坦无偏风险估计（SURE）的技巧，可以证明导数为 $\\frac{dR}{d\\lambda} = 2\\lambda Q(a) - 2\\tau_t\\phi(a)$，其中 $a = (\\lambda-\\mu)/\\tau_t$，$\\phi(\\cdot)$ 和 $Q(\\cdot)$ 分别是标准正态PDF和上尾概率。令导数为零得到一阶最优性条件：\n$$\n\\lambda\\,Q(a) \\;=\\; \\tau_{t}\\,\\phi(a), \\qquad \\text{其中} \\quad a \\;=\\; \\frac{\\lambda - \\mu}{\\tau_{t}}.\n$$\n消去 $\\lambda$ 得到一个关于 $a$ 的标量不动点方程：\n$$\n\\frac{\\mu}{\\tau_{t}} \\;=\\; \\frac{\\phi(a)}{Q(a)} \\;-\\; a,\n$$\n其中 $\\phi(a)/Q(a)$ 是（上）米尔斯比。在我们的数值实例中，$\\tau_{t} = 0.5$ 且 $\\mu = 0.3989422804$。注意到\n$$\n\\frac{\\mu}{\\tau_{t}} \\;=\\; \\frac{0.3989422804}{0.5} \\;=\\; 0.7978845608 \\approx \\sqrt{\\frac{2}{\\pi}}.\n$$\n当 $a = 0$ 时，我们有 $\\phi(0) = \\frac{1}{\\sqrt{2\\pi}}$ 和 $Q(0) = 1 - \\Phi(0) = \\frac{1}{2}$，因此\n$$\n\\frac{\\phi(0)}{Q(0)} \\;-\\; 0 \\;=\\; \\frac{\\frac{1}{\\sqrt{2\\pi}}}{\\frac{1}{2}} \\;=\\; \\sqrt{\\frac{2}{\\pi}}.\n$$\n这与 $\\mu/\\tau_t$ 的值相匹配，因此 $a^{\\star} = 0$ 是该不动点方程的解。最优阈值可由 $\\lambda^{\\star} = \\mu + a^{\\star}\\tau_{t}$ 得出。使用 $a^{\\star} = 0$，\n$$\n\\lambda^{\\star} \\;=\\; \\mu + 0 \\cdot \\tau_{t} \\;=\\; \\mu \\;=\\; 0.3989422804.\n$$\n我们现在计算最小化的 MSE $R(\\lambda^{\\star})$。根据定义，\n$$\nR(\\lambda^{\\star}) = \\mu^2 P(Y \\le \\mu) + \\mathbb{E}[(Y - \\mu - \\mu)^2 \\mathbf{1}\\{Y > \\mu\\}]\n$$\n这可以展开为\n$$\nR(\\lambda^{\\star}) = \\mu^{2}\\Phi(0) + \\tau_{t}^{2}Q(0) - 2\\mu\\tau_t\\phi(0) + \\mu^2 Q(0) = \\mu^2 + \\frac{\\tau_t^2}{2} - 2\\mu\\tau_t\\phi(0).\n$$\n由 $\\mu/\\tau_t = \\sqrt{2/\\pi} = 2/\\sqrt{2\\pi} = 2\\phi(0)$，我们得到 $\\mu = 2\\tau_t\\phi(0)$。代入上式中的第三项，我们有 $2\\mu\\tau_t\\phi(0) = \\mu \\cdot (2\\tau_t\\phi(0)) = \\mu^2$。因此，\n$$\nR(\\lambda^{\\star}) \\;=\\; \\mu^2 + \\frac{\\tau_t^2}{2} - \\mu^2 = \\frac{\\tau_t^2}{2}.\n$$\n当 $\\tau_{t} = 0.5$ 时，我们有 $\\tau_{t}^{2} = 0.25$，因此\n$$\nR(\\lambda^{\\star}) \\;=\\; \\frac{0.25}{2} \\;=\\; 0.125.\n$$\n最后，将这个最小化的 MSE 代入 SE 更新公式：\n$$\n\\tau_{t+1}^{2} \\;=\\; \\sigma_{w}^{2} \\;+\\; \\frac{1}{\\delta}\\,R(\\lambda^{\\star}) \\;=\\; 1.0 \\times 10^{-2} \\;+\\; \\frac{1}{0.8}\\times 0.125 \\;=\\; 0.01 \\;+\\; 0.15625 \\;=\\; 0.16625.\n$$\n四舍五入到四位有效数字，\n$$\n\\lambda^{\\star} \\;\\approx\\; 0.3989, \\qquad \\tau_{t+1}^{2} \\;\\approx\\; 0.1663.\n$$", "answer": "$$\\boxed{\\begin{pmatrix}0.3989  0.1663\\end{pmatrix}}$$", "id": "3481509"}, {"introduction": "在许多实际应用中，信号本身常常需要满足特定的物理约束，例如非负性或被限制在某个区间内。本练习旨在探讨如何在AMP算法中融入这类约束，并分析其对状态演化方程的影响。我们将使用一个投影去噪器（projected denoiser）来施加箱形约束（box constraint），并深入研究这种非线性操作如何改变Onsager反应项和均方误差的计算[@problem_id:3481500]。这有助于我们理解状态演化理论在处理更贴近实际的复杂去噪函数时的分析能力。", "problem": "考虑一个标准线性观测模型 $y = A x_{0} + w$，其中传感矩阵 $A \\in \\mathbb{R}^{m \\times n}$ 的条目是独立同分布的高斯随机变量，满足 $A_{ij} \\sim \\mathcal{N}(0, 1/n)$，噪声 $w \\sim \\mathcal{N}(0, \\sigma_{w}^{2} I_{m})$。设测量率为 $\\delta = m/n$。运行近似消息传递（AMP）算法，该算法使用可分离的、分量化的去噪器 $\\eta$ 和 Onsager 反应项，即 $x^{t+1} = \\eta\\!\\left(x^{t} + A^{\\top} r^{t}\\right)$，其中 $r^{t} = y - A x^{t} + b_{t} r^{t-1}$，且 $b_{t}$ 与在当前伪数据处评估的 $\\eta$ 的散度成正比。在 $x_{0}$ 的分量独立同分布的高维极限下，状态演化（SE）理论假设标量伪数据 $X_{0} + \\tau_{t} Z$（其中 $Z \\sim \\mathcal{N}(0,1)$）控制着迭代的统计特性，并且 Onsager 系数和有效噪声方差的更新由经验平均的极限给出。\n\n现在，通过使用投影去噪器\n$$\n\\eta(u) \\triangleq \\min\\{\\max\\{u - \\theta, 0\\}, U\\}, \n$$\n施加一个分量化的盒约束 $x \\in [0, U]^{n}$，其中 $U > 0$。此处，$\\theta > 0$ 是一个固定的软阈值参数，投影是到区间 $[0, U]$ 上的。该去噪器是平移 $\\theta$ 和到 $[0, U]$ 上的投影的复合，因此它强制了非负性和一个上界。\n\n任务：\n- 从 Onsager 反应项作为 $\\eta$ 的归一化散度的 AMP 定义出发，推导在大系统极限下，投影如何改变 Onsager 系数 $b_{t}$。明确地识别几乎处处成立的 $\\eta'(u)$，并用测量率 $\\delta$ 以及一个涉及 $X_{0}$ 和 $Z$ 的概率来表示 $b_{t}$。\n- 从状态演化递归出发，用 $\\delta$、$\\sigma_{w}^{2}$ 以及应用于 $X_{0} + \\tau_{t} Z$ 的 $\\eta$ 的均方去噪误差来推导方差更新 $\\tau_{t+1}^{2}$。请仔细考虑投影的饱和区域。\n\n然后，将其特化到具体实例，其中 $X_{0} \\equiv 0$（恒为零的信号），迭代方差 $\\tau_{t} = 1$，噪声方差 $\\sigma_{w}^{2} = 0.02$，测量率 $\\delta = 0.8$，阈值 $\\theta = 0.5$，上界 $U = 1$。使用您推导的表达式，计算此实例的下一个状态演化方差 $\\tau_{t+1}^{2}$。在需要时使用标准正态概率密度函数（PDF）$\\phi$ 和累积分布函数（CDF）$\\Phi$。将您的答案四舍五入到4位有效数字。", "solution": "AMP 算法中的 Onsager 系数 $b_t$ 在大系统极限下收敛于 $b_t \\to \\frac{1}{\\delta} \\mathbb{E}[\\eta'(X_0 + \\tau_t Z)]$，其中期望是关于信号分量分布 $X_0$ 和一个标准正态随机变量 $Z \\sim \\mathcal{N}(0,1)$ 计算的。\n\n给定的去噪器是 $\\eta(u) = \\min\\{\\max\\{u - \\theta, 0\\}, U\\}$。我们可以将其写成分段形式：\n$$\n\\eta(u) = \\begin{cases} 0  \\text{if } u \\le \\theta \\\\ u-\\theta  \\text{if } \\theta  u \\le \\theta+U \\\\ U  \\text{if } u > \\theta+U \\end{cases}\n$$\n$\\eta(u)$ 的导数几乎处处存在：\n$$\n\\eta'(u) = \\begin{cases} 0  \\text{if } u  \\theta \\\\ 1  \\text{if } \\theta  u  \\theta+U \\\\ 0  \\text{if } u > \\theta+U \\end{cases}\n$$\n该导数可以使用指示函数来表示：$\\eta'(u) = \\mathbf{1}_{\\{\\theta  u  \\theta+U\\}}$。在 $u=\\theta$ 和 $u=\\theta+U$ 处的不可导点相对于 $X_0 + \\tau_t Z$ 的连续分布构成一个测度为零的集合，因此它们不影响期望值。\n\n将此代入 $b_t$ 的表达式中：\n$$\nb_t = \\frac{1}{\\delta} \\mathbb{E}[\\mathbf{1}_{\\{\\theta  X_0 + \\tau_t Z  \\theta+U\\}}]\n$$\n指示函数的期望是它所指示事件的概率。因此，\n$$\nb_t = \\frac{1}{\\delta} P(\\theta  X_0 + \\tau_t Z  \\theta+U)\n$$\n这个表达式定义了在大系统极限下 Onsager 系数的演化。\n\n有效噪声方差的状态演化递归由下式给出：\n$$\n\\tau_{t+1}^{2} = \\sigma_{w}^{2} + \\frac{1}{\\delta} \\mathbb{E}[(\\eta(X_0 + \\tau_t Z) - X_0)^2]\n$$\n$\\mathbb{E}[(\\eta(X_0 + \\tau_t Z) - X_0)^2]$ 项代表去噪器的均方误差（MSE）。令 $V = X_0 + \\tau_t Z$。MSE 可以通过对 $V$ 的值取条件来计算：\n\\begin{enumerate}\n    \\item 对于 $V \\le \\theta$：$\\eta(V) = 0$，因此平方误差为 $(0 - X_0)^2 = X_0^2$。\n    \\item 对于 $\\theta  V \\le \\theta+U$：$\\eta(V) = V - \\theta = (X_0 + \\tau_t Z) - \\theta$，因此平方误差为 $((X_0 + \\tau_t Z) - \\theta - X_0)^2 = (\\tau_t Z - \\theta)^2$。\n    \\item 对于 $V > \\theta+U$：$\\eta(V) = U$，因此平方误差为 $(U - X_0)^2$。\n\\end{enumerate}\n总 MSE 是这些项在各自定义域上的期望之和：\n$$\n\\text{MSE} = \\mathbb{E}[X_0^2 \\cdot \\mathbf{1}_{\\{X_0+\\tau_t Z \\le \\theta\\}}] + \\mathbb{E}[(\\tau_t Z - \\theta)^2 \\cdot \\mathbf{1}_{\\{\\theta  X_0+\\tau_t Z \\le \\theta+U\\}}] + \\mathbb{E}[(U-X_0)^2 \\cdot \\mathbf{1}_{\\{X_0+\\tau_t Z > \\theta+U\\}}]\n$$\n因此，方差的更新规则是：\n$$\n\\tau_{t+1}^2 = \\sigma_w^2 + \\frac{1}{\\delta}\\left( \\mathbb{E}[X_0^2 \\mathbf{1}_{\\{V \\le \\theta\\}}] + \\mathbb{E}[(\\tau_t Z - \\theta)^2 \\mathbf{1}_{\\{\\theta  V \\le \\theta+U\\}}] + \\mathbb{E}[(U-X_0)^2 \\mathbf{1}_{\\{V > \\theta+U\\}}] \\right)\n$$\n其中 $V = X_0+\\tau_t Z$。\n\n我们现在将这些公式应用于具有以下参数的具体实例：$X_0 \\equiv 0$，$\\tau_t = 1$，$\\sigma_w^2 = 0.02$，$\\delta = 0.8$，$\\theta = 0.5$ 和 $U = 1$。\n\n当 $X_0 \\equiv 0$ 且 $\\tau_t = 1$ 时，随机变量 $V$ 变为 $V = 0 + 1 \\cdot Z = Z$，其中 $Z \\sim \\mathcal{N}(0,1)$。MSE 表达式显著简化：\n$$\n\\text{MSE} = \\mathbb{E}[0^2 \\cdot \\mathbf{1}_{\\{Z \\le \\theta\\}}] + \\mathbb{E}[(Z - \\theta)^2 \\cdot \\mathbf{1}_{\\{\\theta  Z \\le \\theta+U\\}}] + \\mathbb{E}[(U-0)^2 \\cdot \\mathbf{1}_{\\{Z > \\theta+U\\}}]\n$$\n所以，MSE 为：\n$$\n\\text{MSE} = \\int_{\\theta}^{\\theta+U} (z-\\theta)^2 \\phi(z) dz + U^2 \\int_{\\theta+U}^\\infty \\phi(z) dz\n$$\n代入给定值 $\\theta = 0.5$ 和 $U=1$：\n$$\n\\text{MSE} = \\int_{0.5}^{1.5} (z-0.5)^2 \\phi(z) dz + 1^2 \\int_{1.5}^\\infty \\phi(z) dz\n$$\n第一项是 $E_1 = \\int_{0.5}^{1.5} (z-0.5)^2 \\phi(z) dz$。令 $a=0.5$ 和 $b=1.5$。展开被积函数为 $(z^2 - 2az + a^2)\\phi(z)$，并使用标准高斯矩分部积分公式：\n- $\\int_a^b \\phi(z)dz = \\Phi(b) - \\Phi(a)$\n- $\\int_a^b z\\phi(z)dz = \\phi(a) - \\phi(b)$\n- $\\int_a^b z^2\\phi(z)dz = (a\\phi(a)-b\\phi(b)) + (\\Phi(b)-\\Phi(a))$\n代入 $a=0.5$ 和 $b=1.5$：\n- $\\Phi(0.5) \\approx 0.691462$, $\\Phi(1.5) \\approx 0.933193$\n- $\\phi(0.5) \\approx 0.352065$, $\\phi(1.5) \\approx 0.129518$\n\\begin{align*} E_1 =  \\int_{0.5}^{1.5} z^2\\phi(z)dz - 2(0.5)\\int_{0.5}^{1.5} z\\phi(z)dz + (0.5)^2\\int_{0.5}^{1.5} \\phi(z)dz \\\\ =  \\left[ (0.5\\phi(0.5)-1.5\\phi(1.5)) + (\\Phi(1.5)-\\Phi(0.5)) \\right] - \\left[ \\phi(0.5) - \\phi(1.5) \\right] + 0.25 \\left[ \\Phi(1.5)-\\Phi(0.5) \\right] \\\\ \\approx  \\left[ (0.176033 - 0.194277) + (0.933193 - 0.691462) \\right] - \\left[ 0.352065 - 0.129518 \\right] + 0.25 \\left[ 0.933193 - 0.691462 \\right] \\\\ \\approx  \\left[ -0.018244 + 0.241731 \\right] - 0.222547 + 0.25 \\times 0.241731 \\\\ \\approx  0.223487 - 0.222547 + 0.060433 \\\\ \\approx  0.061373 \\end{align*}\nMSE 的第二项是 $E_2 = \\int_{1.5}^\\infty \\phi(z)dz = 1 - \\Phi(1.5) \\approx 1 - 0.933193 = 0.066807$。\n总 MSE $\\approx E_1 + E_2 = 0.061373 + 0.066807 = 0.12818$。\n\n最后，我们计算下一个状态方差 $\\tau_{t+1}^2$：\n$$\n\\tau_{t+1}^2 = \\sigma_w^2 + \\frac{1}{\\delta} \\text{MSE}\n$$\n当 $\\sigma_w^2=0.02$ 且 $\\delta=0.8$ 时：\n$$\n\\tau_{t+1}^2 \\approx 0.02 + \\frac{1}{0.8} \\times 0.12818 = 0.02 + 1.25 \\times 0.12818\n$$\n$$\n\\tau_{t+1}^2 \\approx 0.02 + 0.160225 = 0.180225\n$$\n四舍五入到4位有效数字，我们得到 $\\tau_{t+1}^2 \\approx 0.1802$。", "answer": "$$\\boxed{0.1802}$$", "id": "3481500"}, {"introduction": "标准的AMP状态演化理论通常假设去噪函数是可分离的，但许多先进的估计算法，如排序L1范数惩罚估计（SLOPE），其对应的去噪器却是不可分离的。本练习将带您探索一种在理论与实践之间架起桥梁的强大技巧：通过一个更简单的可分离函数来近似一个复杂的不可分离去噪器。我们将以一个近似的软阈值函数来模拟SLOPE去噪器的行为，并推导其对应的状态演化不动点方程[@problem_id:3481529]。这个过程展示了如何运用状态演化，通过合理的近似来分析和理解那些原本难以直接处理的复杂算法。", "problem": "考虑线性测量模型 $y = A x_{0} + w$，其中 $A \\in \\mathbb{R}^{m \\times n}$ 的元素 $A_{ij} \\sim \\mathcal{N}(0, 1/n)$ 是独立同分布的，信号恒为零 $x_{0} = 0 \\in \\mathbb{R}^{n}$，噪声 $w \\in \\mathbb{R}^{m}$ 的元素 $w_{i} \\sim \\mathcal{N}(0, \\sigma_{w}^{2})$ 是独立同分布的。假设当 $m, n \\to \\infty$ 时，测量比率 $m/n \\to \\delta \\in (0, \\infty)$。考虑一个近似消息传递（Approximate Message Passing, AMP）算法，其在迭代 $t$ 时的去噪器是应用于其伪数据 $r^{t} \\in \\mathbb{R}^{n}$ 的排序 L1 范数惩罚估计（Sorted L-One Penalized Estimation, SLOPE）的近端算子。SLOPE 近端算子是非可分的，因为它依赖于 $|r^{t}|$ 的顺序统计量和一个非增的权重序列 $\\{\\lambda_{i}\\}_{i=1}^{n}$。\n\n为了使状态演化（State Evolution, SE）分析易于处理，我们通过跟踪作用于顺序统计量的阈值的经验分布来近似这个非可分的去噪器，并假设该经验分布集中于一个单点。具体来说，假设在大系统极限下，排序阈值的经验分布收敛到阈值水平 $c \\sigma_{t}$ 处的一个退化分布，其中 $c  0$ 是一个固定的正则化设计参数，$\\sigma_{t}^{2}$ 是 SE 中当前的等效噪声方差。在此近似下，近端算子简化为阈值为 $c \\sigma_{t}$ 的逐分量软阈值处理，因此标量去噪函数可以写为 $\\eta(r; c \\sigma_{t}) = \\mathrm{sign}(r)\\max\\{|r| - c \\sigma_{t}, 0\\}$。\n\n从独立同分布高斯感知和上述近似下 AMP SE 的第一性原理出发，推导不动点等效噪声方差 $\\sigma_{*}^{2}$ 关于 $\\delta$、$\\sigma_{w}^{2}$ 和 $c$ 的闭式解析表达式。你的推导必须：\n- 从 AMP 的基础 SE 描述开始，即将其视为一个等效的标量高斯信道，其方差由 SE 跟踪。\n- 使用精确的软阈值处理规则，以关于标准正态分布的期望来表示每坐标的均方误差。\n- 将均方误差简化为标准正态分布函数，仅在需要时引入 $\\phi(z) = \\frac{1}{\\sqrt{2\\pi}}\\exp(-z^{2}/2)$ 和 $Q(z) = \\int_{z}^{\\infty} \\phi(u)\\,\\mathrm{d}u$。\n\n请提供你的最终答案，即 $\\sigma_{*}^{2}$ 关于 $\\delta$、$\\sigma_{w}^{2}$、$c$、$\\phi(c)$ 和 $Q(c)$ 的单一闭式解析表达式。无需进行数值计算。", "solution": "AMP 的状态演化（SE）刻画了该算法迭代值在大系统极限下（$m, n \\to \\infty$，$m/n \\to \\delta$）的统计特性。SE 的核心原理是，在每次迭代 $t$ 中，伪数据向量 $r^t$（去噪器的输入）在统计上等价于真实信号 $x_0$ 被方差为 $\\sigma_t^2$ 的加性高斯白噪声所污染。也就是说，对于任意分量 $i$，_i^t$ 的行为如同一个从分布 $x_{0,i} + \\sigma_t Z_i$ 中抽取的随机变量，其中 $Z_i \\sim \\mathcal{N}(0,1)$ 是一个标准正态随机变量。\n\n从一次迭代到下一次迭代的等效噪声方差的演化由 SE 递推式描述：\n$$ \\sigma_{t+1}^2 = \\sigma_w^2 + \\frac{1}{\\delta} \\mathbb{E}\\left[ \\left( \\eta(x_0 + \\sigma_t Z; \\tau_t) - x_0 \\right)^2 \\right] $$\n其中期望是关于信号 $x_0$ 和标准正态变量 $Z$ 的联合分布计算的，$\\tau_t$ 是迭代 $t$ 时的阈值参数。\n\n在这个具体问题中，我们有几个简化条件：\n1.  真实信号恒为零：$x_0 = 0$。\n2.  去噪函数是逐分量软阈值处理：$\\eta(r; \\tau) = \\mathrm{sign}(r)\\max\\{|r| - \\tau, 0\\}$。\n3.  阈值 $\\tau_t$ 与等效噪声标准差 $\\sigma_t$ 通过 $\\tau_t = c \\sigma_t$ 相关联，其中 $c$ 是一个正常数。\n\n将这些代入通用的 SE 递推式，我们得到：\n$$ \\sigma_{t+1}^2 = \\sigma_w^2 + \\frac{1}{\\delta} \\mathbb{E}\\left[ \\left( \\eta(0 + \\sigma_t Z; c \\sigma_t) - 0 \\right)^2 \\right] $$\n其中 $Z \\sim \\mathcal{N}(0,1)$。这可以简化为：\n$$ \\sigma_{t+1}^2 = \\sigma_w^2 + \\frac{1}{\\delta} \\mathbb{E}\\left[ \\eta(\\sigma_t Z; c \\sigma_t)^2 \\right] $$\n\n我们的下一个任务是计算期望项。令 $V = \\sigma_t Z$。那么 $V$ 是一个均值为 $0$、方差为 $\\sigma_t^2$ 的高斯随机变量。期望为：\n$$ \\mathbb{E}\\left[ \\eta(\\sigma_t Z; c \\sigma_t)^2 \\right] = \\mathbb{E}\\left[ \\left( \\mathrm{sign}(\\sigma_t Z)\\max\\{|\\sigma_t Z| - c\\sigma_t, 0\\} \\right)^2 \\right] \\\\ = \\mathbb{E}\\left[ \\left( \\max\\{\\sigma_t|Z| - c\\sigma_t, 0\\} \\right)^2 \\right] \\\\ = \\sigma_t^2 \\, \\mathbb{E}\\left[ \\left( \\max\\{|Z| - c, 0\\} \\right)^2 \\right] $$\n期望是关于 $Z \\sim \\mathcal{N}(0,1)$ 计算的。我们通过对标准正态概率密度函数（PDF）$\\phi(z) = \\frac{1}{\\sqrt{2\\pi}} \\exp(-z^2/2)$ 进行积分来计算这个期望。\n$$ \\mathbb{E}\\left[ (\\max\\{|Z| - c, 0\\})^2 \\right] = \\int_{-\\infty}^{\\infty} (\\max\\{|z| - c, 0\\})^2 \\phi(z) \\, \\mathrm{d}z $$\n被积函数仅在 $|z| > c$ 时非零。由于被积函数 $(|z|-c)^2 \\phi(z)$ 的对称性，我们可以将积分写为：\n$$ = 2 \\int_{c}^{\\infty} (z - c)^2 \\phi(z) \\, \\mathrm{d}z $$\n展开平方项 $(z - c)^2 = z^2 - 2cz + c^2$，我们得到：\n$$ = 2 \\left[ \\int_{c}^{\\infty} z^2 \\phi(z) \\, \\mathrm{d}z - 2c \\int_{c}^{\\infty} z \\phi(z) \\, \\mathrm{d}z + c^2 \\int_{c}^{\\infty} \\phi(z) \\, \\mathrm{d}z \\right] $$\n我们分别计算每个积分：\n1.  第三个积分是互补累积分布函数（CDF）$Q(z)$ 的定义：\n    $$ \\int_{c}^{\\infty} \\phi(z) \\, \\mathrm{d}z = Q(c) $$\n2.  第二个积分可以直接求解：\n    $$ \\int_{c}^{\\infty} z \\phi(z) \\, \\mathrm{d}z = \\int_{c}^{\\infty} z \\frac{1}{\\sqrt{2\\pi}}\\exp\\left(-\\frac{z^2}{2}\\right) \\, \\mathrm{d}z = \\frac{1}{\\sqrt{2\\pi}} \\left[ -\\exp\\left(-\\frac{z^2}{2}\\right) \\right]_{c}^{\\infty} = \\frac{1}{\\sqrt{2\\pi}} \\exp\\left(-\\frac{c^2}{2}\\right) = \\phi(c) $$\n3.  第一个积分可以使用分部积分法 $\\int u \\, \\mathrm{d}v = uv - \\int v \\, \\mathrm{d}u$ 求解。令 $u = z$ 和 $\\mathrm{d}v = z \\phi(z) \\, \\mathrm{d}z$。则 $\\mathrm{d}u = \\mathrm{d}z$ 且 $v = -\\phi(z)$。\n    $$ \\int_{c}^{\\infty} z^2 \\phi(z) \\, \\mathrm{d}z = \\left[ -z\\phi(z) \\right]_{c}^{\\infty} - \\int_{c}^{\\infty} (-\\phi(z)) \\, \\mathrm{d}z = (0 - (-c\\phi(c))) + \\int_{c}^{\\infty} \\phi(z) \\, \\mathrm{d}z = c\\phi(c) + Q(c) $$\n    其中我们使用了 $\\lim_{z\\to\\infty} z\\phi(z) = 0$ 这个事实。\n\n将这些结果代回期望的表达式中：\n$$ \\mathbb{E}\\left[ (\\max\\{|Z| - c, 0\\})^2 \\right] = 2 \\left[ (c\\phi(c) + Q(c)) - 2c(\\phi(c)) + c^2(Q(c)) \\right] \\\\ = 2 \\left[ Q(c) - c\\phi(c) + c^2 Q(c) \\right] \\\\ = 2 \\left[ (1+c^2)Q(c) - c\\phi(c) \\right] $$\n因此，总均方误差项为：\n$$ \\mathbb{E}\\left[ \\eta(\\sigma_t Z; c \\sigma_t)^2 \\right] = \\sigma_t^2 \\cdot 2 \\left[ (1+c^2)Q(c) - c\\phi(c) \\right] $$\n我们定义一个仅依赖于参数 $c$ 的常数 $K(c)$：\n$$ K(c) = 2 \\left[ (1+c^2)Q(c) - c\\phi(c) \\right] $$\nSE 递推式简化为关于方差的线性映射：\n$$ \\sigma_{t+1}^2 = \\sigma_w^2 + \\frac{K(c)}{\\delta} \\sigma_t^2 $$\n为了找到不动点 $\\sigma_*^2$，我们令 $\\sigma_{t+1}^2 = \\sigma_t^2 = \\sigma_*^2$：\n$$ \\sigma_*^2 = \\sigma_w^2 + \\frac{K(c)}{\\delta} \\sigma_*^2 $$\n求解 $\\sigma_*^2$：\n$$ \\sigma_*^2 \\left( 1 - \\frac{K(c)}{\\delta} \\right) = \\sigma_w^2 \\\\ \\sigma_*^2 \\left( \\frac{\\delta - K(c)}{\\delta} \\right) = \\sigma_w^2 \\\\ \\sigma_*^2 = \\frac{\\delta \\sigma_w^2}{\\delta - K(c)} $$\n最后，代入 $K(c)$ 的表达式，得到闭式解：\n$$ \\sigma_*^2 = \\frac{\\delta \\sigma_w^2}{\\delta - 2 \\left[ (1+c^2)Q(c) - c\\phi(c) \\right]} $$\n$$ \\sigma_*^2 = \\frac{\\delta \\sigma_w^2}{\\delta - 2(1+c^2)Q(c) + 2c\\phi(c)} $$\n这是不动点等效噪声方差，表示为问题参数 $\\delta$、$\\sigma_w^2$ 和 $c$，以及标准正态函数 $\\phi(c)$ 和 $Q(c)$ 的函数。", "answer": "$$\\boxed{\\frac{\\delta \\sigma_{w}^{2}}{\\delta - 2(1+c^{2})Q(c) + 2c\\phi(c)}}$$", "id": "3481529"}]}