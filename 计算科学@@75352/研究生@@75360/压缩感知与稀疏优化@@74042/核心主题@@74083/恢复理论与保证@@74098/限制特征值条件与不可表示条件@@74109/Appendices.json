{"hands_on_practices": [{"introduction": "为建立对不可表示性条件（Irrepresentable Condition, IC）的直观理解，从一个简化的场景入手将非常有帮助。本练习 [@problem_id:3489701] 探讨了当真实支撑集内的预测变量构成的格拉姆矩阵 $G_{SS}=I$ 时，IC所呈現的简化形式。这个特殊情况优雅地揭示了该条件如何仅依赖于支撑集内外预测变量之间的互相关矩阵 $G_{S^{c}S}$，从而清晰地说明了它在防止Lasso估计器选入无关变量中的作用。", "problem": "考虑一个线性模型，其设计矩阵 $X \\in \\mathbb{R}^{n \\times p}$ 是固定的，且其列是 $\\ell_{2}$-归一化的。令 $S \\subset \\{1,\\dots,p\\}$ 表示一个支撑集，令 $S^{c}$ 表示其补集。令 $G := X^{\\top}X$ 表示（列归一化的）Gram 矩阵。您将分析稀疏估计中使用的两个结构性条件：限制性特征值条件和不可表示条件，特别是在支撑集上的 Gram 块是标准正交的，即 $G_{SS} = I$ 的特定情况下。\n\n从最小绝对收缩和选择算子（Lasso）的 Karush–Kuhn–Tucker 最优性条件出发，推导当 $G_{SS}=I$ 时，不可表示条件对于非支撑集/支撑集交叉块 $G_{S^{c}S}$ 的符号一致性依赖关系。在您的推导中，请清楚地解释为什么在这种情况下，不可表示条件完全依赖于 $G_{S^{c}S}$ 而不是 $G_{SS}$，并将其与限制性特征值条件的作用进行对比。\n\n然后，实例化以下具体设计。令 $n=3$ 且 $p=4$。定义 $X$ 的列为\n- $x_{1} = (1,0,0)^{\\top}$，\n- $x_{2} = (0,1,0)^{\\top}$，\n- $x_{3} = (0.6,\\,0.6,\\,\\sqrt{1 - 0.36 - 0.36})^{\\top}$，\n- $x_{4} = (0.9,\\,0.3,\\,\\sqrt{1 - 0.81 - 0.09})^{\\top}$。\n所有列都具有单位 $\\ell_{2}$-范数，且 $x_{1}$ 和 $x_{2}$ 是标准正交的。\n\n考虑以下两个支撑集和符号模式：\n- $S_{1} = \\{1\\}$，其符号模式为 $\\operatorname{sgn}(\\beta_{S_{1}}) = (+1)$，\n- $S_{2} = \\{1,2\\}$，其符号模式为 $\\operatorname{sgn}(\\beta_{S_{2}}) = (+1,+1)$。\n\n使用您的推导，评估 $S_{1}$ 的不可表示条件，并计算使得 $S_{1}$ 和 $\\operatorname{sgn}(\\beta_{S_{1}}) = (+1)$ 的符号一致性得以保证的最大边界 $\\eta$。然后，通过显式计算验证，将支撑集从 $S_{1}$ 扩展到 $S_{2}$（增加一列）并使用指定的符号模式，会导致不可表示条件失效。\n\n提供 $S_{1}$ 的最大边界 $\\eta$ 作为您的最终答案。将其表示为单个实数。无需四舍五入。", "solution": "该问题要求在支撑集上的 Gram 矩阵是标准正交（$G_{SS} = I$）的特定假设下，推导 Lasso 的不可表示条件（IC）。然后，我们将使用此推导来分析一个具体的例子。\n\n首先，我们从 Lasso 问题的 Karush–Kuhn–Tucker (KKT) 最优性条件开始。Lasso 估计量 $\\hat{\\beta}$ 是以下优化问题的解：\n$$ \\min_{\\beta \\in \\mathbb{R}^p} \\frac{1}{2} \\|y - X\\beta\\|_2^2 + \\lambda \\|\\beta\\|_1 $$\n其中 $y \\in \\mathbb{R}^n$ 是响应向量，$X \\in \\mathbb{R}^{n \\times p}$ 是设计矩阵，$\\lambda > 0$ 是正则化参数。KKT 条件指出，在解 $\\hat{\\beta}$ 处，目标函数的次梯度必须包含零向量。这给出：\n$$ -X^T(y - X\\hat{\\beta}) + \\lambda v = 0 $$\n其中 $v$ 是 $\\ell_1$-范数次梯度中的一个向量，即，如果 $\\hat{\\beta}_j \\neq 0$，则 $v_j = \\operatorname{sgn}(\\hat{\\beta}_j)$；如果 $\\hat{\\beta}_j = 0$，则 $|v_j| \\le 1$。\n\n我们假设存在一个真实的稀疏系数向量 $\\beta^*$，其支撑集为 $S = \\{j : \\beta^*_j \\neq 0\\}$，并且线性模型是无噪声的，$y = X\\beta^* = X_S \\beta^*_S$。我们感兴趣的是，在什么条件下 Lasso 解 $\\hat{\\beta}$ 能够恢复正确的支撑集 $S$ 和符号模式 $s_S = \\operatorname{sgn}(\\beta^*_S)$。这意味着我们分析一个潜在的解 $\\hat{\\beta}$，其中 $\\operatorname{supp}(\\hat{\\beta}) = S$ 且 $\\operatorname{sgn}(\\hat{\\beta}_S) = s_S$。对于这样的解，$\\hat{\\beta}_{S^c} = 0$。\n\nKKT 条件可以根据支撑集 $S$ 及其补集 $S^c$ 进行拆分：\n1. 对于索引 $j \\in S$，我们有 $\\hat{\\beta}_j \\neq 0$，所以 $v_j = \\operatorname{sgn}(\\hat{\\beta}_j) = s_j$。在支撑集 $S$ 上的 KKT 条件是：\n$$ (X^T(X\\hat{\\beta} - y))_S = -\\lambda s_S $$\n代入 $y = X_S \\beta^*_S$ 和 $\\hat{\\beta} = (\\hat{\\beta}_S, 0)$，这变成：\n$$ X_S^T(X_S\\hat{\\beta}_S - X_S \\beta^*_S) = -\\lambda s_S \\implies G_{SS}(\\hat{\\beta}_S - \\beta^*_S) = -\\lambda s_S $$\n其中 $G_{SS} = X_S^T X_S$ 是支撑集上的 Gram 矩阵。\n\n2. 对于索引 $j \\in S^c$，我们有 $\\hat{\\beta}_j = 0$，所以 $|v_j| \\le 1$。在非支撑集 $S^c$ 上的 KKT 条件是：\n$$ \\left| (X^T(X\\hat{\\beta} - y))_{S^c} \\right| \\le \\lambda \\quad (\\text{逐元素的}) $$\n代入 $y$ 和 $\\hat{\\beta}$ 得到：\n$$ \\left| X_{S^c}^T(X_S\\hat{\\beta}_S - X_S \\beta^*_S) \\right| \\le \\lambda \\implies \\left| G_{S^c S}(\\hat{\\beta}_S - \\beta^*_S) \\right| \\le \\lambda $$\n其中 $G_{S^c S} = X_{S^c}^T X_S$。\n\n从支撑集上的条件，我们可以将估计值与真实向量的偏差表示为 $\\hat{\\beta}_S - \\beta^*_S = -\\lambda G_{SS}^{-1} s_S$。将此代入非支撑集上的条件，我们得到：\n$$ \\left| G_{S^c S} (-\\lambda G_{SS}^{-1} s_S) \\right| \\le \\lambda $$\n由于 $\\lambda > 0$，我们可以除以它来获得不可表示条件（IC）的一般形式：\n$$ \\left| G_{S^c S} G_{SS}^{-1} s_S \\right| \\le 1 \\quad (\\text{逐元素的}) $$\n通常，为了保证鲁棒性，该条件会以一个边界 $\\eta > 0$ 的形式表述为严格不等式：\n$$ \\left| G_{S^c S} G_{SS}^{-1} s_S \\right| \\le 1 - \\eta $$\n\n问题指定了 $G_{SS} = I$（适当大小的单位矩阵）的情况。在这种情况下，其逆矩阵也是单位矩阵，$G_{SS}^{-1} = I$。IC 急剧简化为：\n$$ \\left| G_{S^c S} I s_S \\right| \\le 1 - \\eta \\implies \\left| G_{S^c S} s_S \\right| \\le 1 - \\eta $$\n这个推导清楚地表明，当支撑集上的预测变量是标准正交时，正确支撑集恢复的条件完全取决于互相关块 $G_{S^c S}$ 和符号模式 $s_S$。支撑集上的块 $G_{SS}$ 在表达式中变成了一个平凡的单位矩阵，因此在这种特定情况下没有影响。IC 本质上确保了真实支撑集 $S$ 之外的任何预测变量都不会与支撑集内预测变量的符号加权组合有太高的相关性。\n\n相比之下，限制性特征值（RE）条件是设计矩阵的一个更全局的属性。RE 条件的一个版本要求对于某个锥内的所有向量 $\\Delta$，二次型 $\\Delta^T G \\Delta$ 有下界，例如，对于某个常数 $\\kappa > 0$，有 $\\frac{1}{n} \\|X\\Delta\\|_2^2 = \\frac{1}{n}\\Delta^T G \\Delta \\ge \\kappa \\|\\Delta_S\\|_2^2$。$G_{SS}=I$ 的假设对于仅在 $S$ 上有支撑的向量 $\\Delta$ 意味着该性质的一个非常强的形式，因为对于这样的向量，$\\Delta^T G \\Delta = \\Delta_S^T G_{SS} \\Delta_S = \\|\\Delta_S\\|_2^2$。然而，RE 条件必须对更广泛的一类向量 $\\Delta$ 成立，这些向量在 $S^c$ 上可以有非零分量。对于这类向量，二次型 $\\Delta^T G \\Delta$ 仍然依赖于 $G_{S^c S}$ 和 $G_{S^c S^c}$。因此，虽然 $G_{SS}=I$ 的假设加强了 RE 属性，但它不像对 IC 的影响那样，使该属性变得平凡或消除了其对非支撑集块的依赖。\n\n现在，我们用给定的具体设计来实例化问题。\n设计矩阵 $X \\in \\mathbb{R}^{3 \\times 4}$ 的列为：\n$x_1 = (1,0,0)^{\\top}$，$x_2 = (0,1,0)^{\\top}$，$x_3 = (0.6, 0.6, \\sqrt{0.28})^{\\top}$，$x_4 = (0.9, 0.3, \\sqrt{0.1})^{\\top}$。\nGram 矩阵 $G=X^{\\top}X$ 的元素为 $G_{ij} = x_i^{\\top}x_j$。我们计算相关元素：\n$G_{12} = x_1^{\\top}x_2 = 0$\n$G_{13} = x_1^{\\top}x_3 = 0.6$\n$G_{14} = x_1^{\\top}x_4 = 0.9$\n$G_{23} = x_2^{\\top}x_3 = 0.6$\n$G_{24} = x_2^{\\top}x_4 = 0.3$\n\n**情况 1：$S_1 = \\{1\\}$ 且 $\\operatorname{sgn}(\\beta_{S_1}) = s_{S_1} = (+1)$**\n支撑集为 $S = \\{1\\}$，其补集为 $S^c = \\{2,3,4\\}$。符号向量是一个标量 $s_S = 1$。\n支撑集上的 Gram 矩阵是 $G_{SS} = G_{11} = x_1^{\\top}x_1 = 1$，这是一个 $1 \\times 1$ 的单位矩阵。假设成立。\n不可表示条件是 $|G_{S^c S} s_S| \\le 1 - \\eta$。\n$G_{S^c S}$ 是行来自 $S^c$、列来自 $S$ 的块：\n$$ G_{S^c S} = \\begin{pmatrix} G_{21} \\\\ G_{31} \\\\ G_{41} \\end{pmatrix} = \\begin{pmatrix} G_{12} \\\\ G_{13} \\\\ G_{14} \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0.6 \\\\ 0.9 \\end{pmatrix} $$\n我们计算用于 IC 检查的向量：\n$$ G_{S^c S} s_S = \\begin{pmatrix} 0 \\\\ 0.6 \\\\ 0.9 \\end{pmatrix} (1) = \\begin{pmatrix} 0 \\\\ 0.6 \\\\ 0.9 \\end{pmatrix} $$\n该条件要求对于所有 $j \\in S^c$ 都有 $|G_{S^c S} s_S|_j \\le 1 - \\eta$。\n这意味着 $\\max_{j \\in S^c} |(G_{S^c S} s_S)_j| \\le 1 - \\eta$。\n$$ \\max(|0|, |0.6|, |0.9|) = 0.9 \\le 1 - \\eta $$\n这意味着 $\\eta \\le 1 - 0.9 = 0.1$。使得 $S_1$ 的 IC 得以保证的最大边界 $\\eta$ 是 $0.1$。\n\n**情况 2：$S_2 = \\{1,2\\}$ 且 $\\operatorname{sgn}(\\beta_{S_2}) = (+1,+1)$**\n支撑集为 $S = \\{1,2\\}$，其补集为 $S^c = \\{3,4\\}$。符号向量是 $s_S = (1,1)^{\\top}$。\n支撑集上的 Gram 矩阵是：\n$$ G_{SS} = \\begin{pmatrix} G_{11}  G_{12} \\\\ G_{21}  G_{22} \\end{pmatrix} = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} = I_2 $$\n假设成立。IC 检查同样是 $|G_{S^c S} s_S|  1$（对于任何 $\\eta > 0$ 的严格 IC）。\n$G_{S^c S}$ 是行来自 $S^c$、列来自 $S$ 的块：\n$$ G_{S^c S} = \\begin{pmatrix} G_{31}  G_{32} \\\\ G_{41}  G_{42} \\end{pmatrix} = \\begin{pmatrix} G_{13}  G_{23} \\\\ G_{14}  G_{24} \\end{pmatrix} = \\begin{pmatrix} 0.6  0.6 \\\\ 0.9  0.3 \\end{pmatrix} $$\n我们计算用于 IC 检查的向量：\n$$ G_{S^c S} s_S = \\begin{pmatrix} 0.6  0.6 \\\\ 0.9  0.3 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 0.6+0.6 \\\\ 0.9+0.3 \\end{pmatrix} = \\begin{pmatrix} 1.2 \\\\ 1.2 \\end{pmatrix} $$\nIC 要求对于所有 $j \\in S^c$ 都有 $|(G_{S^c S} s_S)_j|  1$。\n对于 $j=3$，我们必须有 $|1.2|  1$，这是不成立的。\n对于 $j=4$，我们必须有 $|1.2|  1$，这同样是不成立的。\n对于支撑集 $S_2$ 和给定的符号模式，不可表示条件失效。这验证了将支撑集从 $S_1$ 扩展到 $S_2$ 会导致 IC 失效的说法。\n\n所要求的最终答案是 $S_1$ 的最大边界 $\\eta$，我们计算出其值为 $0.1$。", "answer": "$$\n\\boxed{0.1}\n$$", "id": "3489701"}, {"introduction": "在对IC有了基本理解之后，我们现在从一个特定的数据矩阵转向一类更普遍的统计模型。本实践 [@problem_id:3489705] 考察了一种具有结构化相关性的设计，即活跃集内的格拉姆矩阵 $\\Sigma_{S,S}$ 具有等相关结构。通过推导IC成立所需的互相关参数 $\\gamma$ 的临界值，您将学习到抽象的理论条件如何转化为对统计模型参数的具体约束。", "problem": "考虑一个线性模型，其设计矩阵 $X \\in \\mathbb{R}^{n \\times p}$ 固定，且其列已被标准化，使得经验格拉姆矩阵 $\\,\\Sigma := X^{\\top}X/n\\,$ 的对角线元素为1。假设真实支撑集 $S \\subset \\{1,\\dots,p\\}$ 的基数 $\\,|S| = s \\geq 2\\,$，并且子矩阵 $\\,\\Sigma_{S,S}\\,$ 具有等相关结构，其参数为 $\\,\\alpha \\in \\left(-\\frac{1}{s-1},\\,1\\right)\\,$，即\n$$\n\\Sigma_{S,S}(i,j) \\;=\\; \\begin{cases}\n1  \\text{若 } i=j,\\\\\n\\alpha  \\text{若 } i\\neq j.\n\\end{cases}\n$$\n假设非活动坐标与活动坐标之间存在结构化的互相关：对于每一个 $\\,i \\in S^{c}\\,$，行 $\\,\\Sigma_{i,S}\\,$ 是一个常数，即 $\\,\\Sigma_{i,S} = \\gamma\\,\\mathbf{1}_{s}^{\\top}\\,$，其中 $\\,\\gamma \\in \\mathbb{R}\\,$ 且 $\\,\\mathbf{1}_{s} \\in \\mathbb{R}^{s}\\,$ 是全1向量。对 $\\,\\Sigma_{S^{c},S^{c}}\\,$ 不作进一步的结构假设。\n\n重点关注最小绝对收缩和选择算子 (LASSO) 及其模型选择性质。支撑这些性质的有两个标准条件：\n\n- 受限特征值 (Restricted Eigenvalue, RE) 条件保证了在某个方向锥上的可识别性和曲率；其一个基本先决条件是 $\\,\\Sigma_{S,S}\\,$ 为正定矩阵。\n\n- 不可表示条件 (Irrepresentable Condition, IRC) 要求，非活动坐标对活动集的影响，经 $\\,\\Sigma_{S,S}^{-1}\\,$ 归一化并投影到 $S$ 上的任意符号模式后，其绝对值一致有界于 $1$。\n\n从以上定义出发，并基于基本原理，推导在此结构化设定下，不可表示条件对 $S$ 上的所有符号模式一致成立时，互相关参数 $\\,\\gamma\\,$ 的最大量值。将你的最终答案表示为关于 $\\,s\\,$ 和 $\\,\\alpha\\,$ 的闭式符号函数 $\\,\\gamma_{\\mathrm{IRC}}^{\\star}(s,\\alpha)\\,$。你的答案必须是单一的解析表达式，无需四舍五入。", "solution": "该问题要求推导在不可表示条件 (IRC) 成立的情况下，互相关参数 $\\gamma$ 的最大量值。我们首先将条件形式化，然后进行推导。\n\n问题对不可表示条件的描述如下：对于任何非活动变量 $j \\in S^c$，该变量对活动集的影响，在经过活动集协方差结构 $\\Sigma_{S,S}$ 归一化后，必须是有界的。此影响被投影到活动集 $S$ 上的所有可能符号模式上。形式上，令 $c_j^\\top = \\Sigma_{j,S} \\Sigma_{S,S}^{-1}$ 为非活动变量 $j \\in S^c$ 的影响系数行向量。IRC 要求对于所有 $j \\in S^c$，该向量在任何符号向量 $v \\in \\{-1, 1\\}^s$ 上的最大投影有界于 $1$。该条件的边界情况为：\n$$ \\max_{j \\in S^c} \\max_{v \\in \\{-1, 1\\}^s} \\left| c_j^\\top v \\right| = 1 $$\n内部的最大化 $\\max_{v \\in \\{-1, 1\\}^s} |c_j^\\top v|$ 是一个关于向量 $c_j$ 的 $L_1$ 范数的著名恒等式。具体来说，如果 $c_j$ 的分量为 $(c_{j,k})_{k \\in S}$，那么 $c_j^\\top v = \\sum_{k \\in S} c_{j,k} v_k$。通过为每个 $k \\in S$ 选择 $v_k = \\text{sgn}(c_{j,k})$，可以使该和的绝对值最大化，从而得到 $\\sum_{k \\in S} |c_{j,k}| = \\|c_j\\|_1$。因此，IRC 可以用 $L_1$ 范数写为：\n$$ \\max_{j \\in S^c} \\| \\Sigma_{j,S} \\Sigma_{S,S}^{-1} \\|_1 \\le 1 $$\n我们正在寻找满足此不等式的最大 $|\\gamma|$。\n\n问题为协方差矩阵 $\\Sigma$ 指定了一个特定结构。对于任何非活动变量 $j \\in S^c$，互相关子矩阵由 $\\Sigma_{j,S} = \\gamma \\mathbf{1}_s^\\top$ 给出，其中 $\\mathbf{1}_s$ 是 $s$ 维全1向量。由于此结构对所有 $j \\in S^c$ 都是相同的，因此对 $j \\in S^c$ 的最大化是多余的。该条件简化为：\n$$ \\| \\gamma \\mathbf{1}_s^\\top \\Sigma_{S,S}^{-1} \\|_1 \\le 1 $$\n这等价于 $|\\gamma| \\| \\mathbf{1}_s^\\top \\Sigma_{S,S}^{-1} \\|_1 \\le 1$。我们的下一步是计算向量量 $\\mathbf{1}_s^\\top \\Sigma_{S,S}^{-1}$。\n\n首先，我们必须求出矩阵 $\\Sigma_{S,S}$ 的逆。问题指出 $\\Sigma_{S,S}$ 具有等相关结构：\n$$ \\Sigma_{S,S} = (1-\\alpha)I_s + \\alpha \\mathbf{1}_s \\mathbf{1}_s^\\top $$\n其中 $I_s$ 是 $s \\times s$ 单位矩阵。参数 $\\alpha$ 被限制在区间 $\\alpha \\in \\left(-\\frac{1}{s-1}, 1\\right)$ 内。这个范围确保 $\\Sigma_{S,S}$ 是正定的，因此是可逆的。$\\Sigma_{S,S}$ 的特征值为 $1-\\alpha$（重数为 $s-1$）和 $1+(s-1)\\alpha$（重数为 $1$）。对 $\\alpha$ 的条件确保了两个特征值都为正。\n\n为了求逆，我们对形如 $(A + UV^\\top)^{-1}$ 的矩阵使用 Sherman-Morrison-Woodbury 公式。令 $A = (1-\\alpha)I_s$，$U = \\alpha \\mathbf{1}_s$，$V = \\mathbf{1}_s$。该公式给出：\n$$ \\Sigma_{S,S}^{-1} = ((1-\\alpha)I_s + \\alpha \\mathbf{1}_s \\mathbf{1}_s^\\top)^{-1} = \\frac{1}{1-\\alpha}I_s - \\frac{\\alpha}{(1-\\alpha)^2} \\frac{\\mathbf{1}_s \\mathbf{1}_s^\\top}{1 + \\frac{\\alpha}{1-\\alpha}\\mathbf{1}_s^\\top \\mathbf{1}_s} $$\n由于 $\\mathbf{1}_s^\\top \\mathbf{1}_s = s$，分母变为 $1 + \\frac{s\\alpha}{1-\\alpha} = \\frac{1-\\alpha+s\\alpha}{1-\\alpha} = \\frac{1+(s-1)\\alpha}{1-\\alpha}$。\n将此代回，我们得到：\n$$ \\Sigma_{S,S}^{-1} = \\frac{1}{1-\\alpha}I_s - \\frac{\\alpha}{(1-\\alpha)^2} \\frac{(1-\\alpha)}{1+(s-1)\\alpha} \\mathbf{1}_s \\mathbf{1}_s^\\top $$\n$$ \\Sigma_{S,S}^{-1} = \\frac{1}{1-\\alpha}I_s - \\frac{\\alpha}{(1-\\alpha)(1+(s-1)\\alpha)} \\mathbf{1}_s \\mathbf{1}_s^\\top $$\n现在，我们可以计算影响向量的转置，我们将其记作 $c^\\top = \\mathbf{1}_s^\\top \\Sigma_{S,S}^{-1}$：\n$$ c^\\top = \\mathbf{1}_s^\\top \\left( \\frac{1}{1-\\alpha}I_s - \\frac{\\alpha}{(1-\\alpha)(1+(s-1)\\alpha)} \\mathbf{1}_s \\mathbf{1}_s^\\top \\right) $$\n$$ c^\\top = \\frac{1}{1-\\alpha}\\mathbf{1}_s^\\top - \\frac{\\alpha}{(1-\\alpha)(1+(s-1)\\alpha)} (\\mathbf{1}_s^\\top \\mathbf{1}_s) \\mathbf{1}_s^\\top $$\n再次使用 $\\mathbf{1}_s^\\top \\mathbf{1}_s = s$：\n$$ c^\\top = \\left( \\frac{1}{1-\\alpha} - \\frac{s\\alpha}{(1-\\alpha)(1+(s-1)\\alpha)} \\right) \\mathbf{1}_s^\\top $$\n我们为括号中的标量项找到一个公分母：\n$$ \\frac{1+(s-1)\\alpha - s\\alpha}{(1-\\alpha)(1+(s-1)\\alpha)} = \\frac{1-\\alpha}{(1-\\alpha)(1+(s-1)\\alpha)} = \\frac{1}{1+(s-1)\\alpha} $$\n因此，向量 $c^\\top$ 简化为：\n$$ c^\\top = \\frac{1}{1+(s-1)\\alpha} \\mathbf{1}_s^\\top $$\n向量 $c$ 本身是 $c = \\frac{1}{1+(s-1)\\alpha} \\mathbf{1}_s$。该向量有 $s$ 个相同的分量，每个分量都等于 $\\frac{1}{1+(s-1)\\alpha}$。\n\n接下来，我们计算这个向量 $c$ 的 $L_1$ 范数：\n$$ \\|c\\|_1 = \\sum_{k=1}^s \\left| \\frac{1}{1+(s-1)\\alpha} \\right| = s \\cdot \\frac{1}{|1+(s-1)\\alpha|} $$\n从给定的 $\\alpha$ 范围可知，我们有 $1+(s-1)\\alpha  0$。因此，绝对值是多余的。\n$$ \\|c\\|_1 = \\frac{s}{1+(s-1)\\alpha} $$\n将此代回 IRC，$|\\gamma| \\|c\\|_1 \\le 1$：\n$$ |\\gamma| \\frac{s}{1+(s-1)\\alpha} \\le 1 $$\n对 $|\\gamma|$ 求解，得到其量值的上界：\n$$ |\\gamma| \\le \\frac{1+(s-1)\\alpha}{s} $$\n不可表示条件成立时 $\\gamma$ 的最大量值是达到此边界的值。我们将此临界值记为 $\\gamma_{\\mathrm{IRC}}^{\\star}(s,\\alpha)$。\n$$ \\gamma_{\\mathrm{IRC}}^{\\star}(s,\\alpha) = \\frac{1+(s-1)\\alpha}{s} $$\n该表达式表示了一致互相关 $\\gamma$ 的最大允许量值，是支撑集大小 $s$ 和支撑集内部相关性 $\\alpha$ 的函数。", "answer": "$$\\boxed{\\frac{1+(s-1)\\alpha}{s}}$$", "id": "3489705"}, {"introduction": "在实践中，一个关键问题是如何通过计算来验证不可表示性条件，特别是它在所有可能符号模式下的最坏情况。最后的这个练习 [@problem_id:3489711] 要求您设计一个高效的算法，以避免对所有 $2^{|S|}$ 种符号组合进行遍历的指数级搜索。通过利用凸分析中的范数对偶原理，您将发现这个组合优化问题可以等价地转化为一个计算 $\\ell_1$ 范数的问题，从而将理论与高效的计算实践联系起来。", "problem": "给定一个确定性数据矩阵 $X \\in \\mathbb{R}^{n \\times p}$ 和一个支撑集 $S \\subset \\{1,2,\\dots,p\\}$，以及一个边际参数 $\\eta \\in (0,1)$。目标是通过有原则且可验证的计算，判断 $X$ 的几何结构是否允许在使用最小绝对收缩和选择算子 (LASSO)，即 Least Absolute Shrinkage and Selection Operator，时，对支撑于 $S$ 上的稀疏系数向量进行精确的符号恢复。该判断由一个基于凸分析的不可表示性类型准则来认证。您的任务是设计并实现一个程序，该程序仅使用凸优化以及线性代数和范数对偶性的第一性原理，计算由 $X$ 在 $S$ 上的所有符号模式下引发的紧凑的最坏情况下的非活动到活动预测效应。您必须避免遍历所有符号模式，而是将最坏情况的计算重构为一个易于处理的凸优化问题。\n\n从以下基础开始：\n- 将 $X$ 划分为 $X_S \\in \\mathbb{R}^{n \\times |S|}$ 和 $X_{S^c} \\in \\mathbb{R}^{n \\times (p - |S|)}$，其中 $S^c$ 表示 $S$ 在 $\\{1,2,\\dots,p\\}$ 中的补集。\n- 假设 $X_S^T X_S$ 是可逆的。仅使用矩阵转置、可逆性和诱导范数的标准性质，结合 $\\ell_\\infty$ 球的支撑函数和线性规划对偶性，推导出一个用于表示符号恢复的某个几何障碍的紧凑最坏情况值的凸表示。这个障碍应表示为在 $S$ 上的所有符号向量上的上确界，其形式为一个 $\\ell_\\infty$-范数，该范数用 $X_S$ 的格拉姆矩阵进行适当归一化后，量化了 $X_{S^c}$ 与 $X_S$ 的线性张成空间之间的对齐程度。\n- 将离散超立方体上的上确界重构为 $\\mathbb{R}^{|S|}$ 中 $\\ell_\\infty$ 球的支撑函数形式，并将计算简化为一系列具有简单边界约束的线性规划问题。\n\n您的程序必须：\n1. 仅使用 $X$、$S$ 和 $X_S^T X_S$ 的可逆性来构建交叉效应矩阵。\n2. 通过求解捕捉 $\\mathbb{R}^{|S|}$ 中 $\\ell_\\infty$ 单位球上绝对线性泛函上确界的凸优化问题，计算紧凑的最坏情况值。\n3. 判断是否存在一个边际 $\\eta \\in (0,1)$，使得最坏情况值被 $1 - \\eta$ 作为上界。\n4. 为每个测试用例生成一个布尔值，指示该条件是否被满足。\n\n每个测试用例的结果必须是一个布尔值。程序的最终输出必须是单行，包含一个用方括号括起来的、逗号分隔的布尔值列表，例如 $[{\\tt True},{\\tt False},{\\tt True}]$。\n\n测试套件。对于下面的每个测试用例，都给定了明确的 $(n,p)$、矩阵 $X$、支撑集 $S$（使用基于0的索引）和边际参数 $\\eta$。在所有情况下，假设列向量如所列，任何省略的条目均为零。所有数值都是精确的实数；仅用布尔值回答，因此不涉及物理单位。\n\n- 1号测试用例（顺利路径，严格可行）：$n = 6$，$p = 4$，$S = \\{0,1\\}$，$\\eta = 0.6$。$X$ 的列为：\n  - 第0列：$[1,0,0,0,0,0]^T$。\n  - 第1列：$[0,1,0,0,0,0]^T$。\n  - 第2列：$[0.1,0,\\sqrt{1-0.1^2},0,0,0]^T$。\n  - 第3列：$[0,0.1,0,\\sqrt{1-0.1^2},0,0]^T$。\n\n- 2号测试用例（边界相等）：$n = 6$，$p = 4$，$S = \\{0,1\\}$，$\\eta = 0.25$。$X$ 的列为：\n  - 第0列：$[1,0,0,0,0,0]^T$。\n  - 第1列：$[0,1,0,0,0,0]^T$。\n  - 第2列：$[0.375,0.375,\\sqrt{1 - 2 \\cdot 0.375^2},0,0,0]^T$。\n  - 第3列：$[0.2,0.2,0,\\sqrt{1 - 2 \\cdot 0.2^2},0,0]^T$。\n\n- 3号测试用例（违反条件）：$n = 6$，$p = 4$，$S = \\{0,1\\}$，$\\eta = 0.2$。$X$ 的列为：\n  - 第0列：$[1,0,0,0,0,0]^T$。\n  - 第1列：$[0,1,0,0,0,0]^T$。\n  - 第2列：$[0.45,0.45,\\sqrt{1 - 2 \\cdot 0.45^2},0,0,0]^T$。\n  - 第3列：$[0.35,0.35,0,\\sqrt{1 - 2 \\cdot 0.35^2},0,0]^T$。\n\n- 4号测试用例（病态活动集格拉姆矩阵，违反条件）：$n = 6$，$p = 4$，$S = \\{0,1\\}$，$\\eta = 0.1$。$X$ 的列为：\n  - 第0列：$[1,0,0,0,0,0]^T$。\n  - 第1列：$[0.999,\\sqrt{1 - 0.999^2},0,0,0,0]^T$。\n  - 第2列：$[0.35,0.35,\\sqrt{1 - 0.35^2 - 0.35^2},0,0,0]^T$。\n  - 第3列：$[0.2,0.05,0,\\sqrt{1 - 0.2^2 - 0.05^2},0,0]^T$。\n\n要求和交付成果：\n- 从第一性原理出发，且不遍历离散超立方体，推导出一个凸优化公式，其最优值等于所需的最坏情况障碍值。\n- 在一个程序中实现推导出的公式，该程序使用线性规划解决所需的凸问题。\n- 对于每个测试用例，输出一个布尔值，指示条件是否满足，即最坏情况值是否至多为 $1 - \\eta$。\n- 程序的最终输出必须是单行，其结果为用方括号括起来的逗号分隔列表，例如 $[{\\tt True},{\\tt False},{\\tt True},{\\tt False}]$。\n\n您的程序必须完全自包含，无需任何输入。它必须解决所有测试用例，并按指定格式打印最终列表。如果从平方根和内积中隐式产生任何三角量，请使用弧度；然而，如此处所述的问题，除了 $\\mathbb{R}^n$ 中的标准内积外，不需要任何角度规范。", "solution": "该问题被评估为**有效**。这是一个在高维统计学和稀疏优化领域内提法恰当且有科学依据的问题。问题陈述是形式化、客观且自包含的，提供了推导唯一且可验证解所需的所有数据和理论背景。其基础概念，例如LASSO的不可表示条件，在科学文献中已有完善的论述。\n\n目标是确定数据矩阵 $X \\in \\mathbb{R}^{n \\times p}$ 的几何结构是否允许对支撑于集合 $S$ 上的稀疏向量进行精确的符号恢复。这由一个不可表示性类型的条件来认证，该条件必须在边际 $\\eta \\in (0,1)$ 下成立。我们必须计算在支撑集 $S$ 上所有可能的符号模式下的几何障碍的最坏情况值，并检查该值是否被 $1 - \\eta$ 所约束。关键的约束是通过使用凸分析重构问题来避免对符号模式进行组合枚举。\n\n令 $s \\in \\{-1, 1\\}^{|S|}$ 为对应于支撑集 $S$ 上系数的符号向量。不可表示条件是在某些条件下LASSO能够唯一恢复正确带符号支撑集的充要条件，可表示为：\n$$\n\\| X_{S^c}^T X_S (X_S^T X_S)^{-1} s \\|_{\\infty} \\le 1\n$$\n其中，该不等式被理解为对真实底层稀疏向量的特定符号模式 $s$ 成立。本问题要求检查在支撑集 $S$ 上所有可能符号模式下的*最坏情况*。这引出了以下量的计算，我们将其表示为 $C(X, S)$：\n$$\nC(X, S) = \\sup_{s \\in \\{-1, 1\\}^{|S|}} \\| X_{S^c}^T X_S (X_S^T X_S)^{-1} s \\|_{\\infty}\n$$\n需要验证的条件是 $C(X, S) \\le 1 - \\eta$。\n\n让我们定义“交叉效应”矩阵 $\\Gamma \\in \\mathbb{R}^{(p-|S|) \\times |S|}$ 如下：\n$$\n\\Gamma = X_{S^c}^T X_S (X_S^T X_S)^{-1}\n$$\n问题假设活动集上的格拉姆矩阵 $G_S = X_S^T X_S$ 是可逆的，因此 $\\Gamma$ 是良定义的。令 $\\gamma_j^T$ 表示 $\\Gamma$ 的第 $j$ 行，其中 $j$ 是来自非活动集 $S^c$ 的索引。量 $C(X, S)$ 可以展开为：\n$$\nC(X, S) = \\sup_{s \\in \\{-1, 1\\}^{|S|}} \\max_{j \\in S^c} |\\gamma_j^T s|\n$$\n我们可以交换上确界和最大值算子：\n$$\nC(X, S) = \\max_{j \\in S^c} \\sup_{s \\in \\{-1, 1\\}^{|S|}} |\\gamma_j^T s|\n$$\n这将问题简化为对每个非活动特征 $j \\in S^c$ 计算 $\\sup_{s \\in \\{-1, 1\\}^{|S|}} |\\gamma_j^T s|$。暴力破解方法将涉及枚举所有 $2^{|S|}$ 个可能的符号向量 $s$，对于较大的 $|S|$ 而言，这在计算上是不可行的。\n\n按照提示，我们使用凸分析的原理重构这个上确界。符号向量集合 $\\{-1, 1\\}^{|S|}$ 构成了 $|S|$ 维 $\\ell_{\\infty}$ 单位球 $B_{\\infty}^{|S|} = \\{ v \\in \\mathbb{R}^{|S|} : \\|v\\|_{\\infty} \\le 1 \\}$ 的极点（顶点）集合。一个线性函数，如 $f(v) = \\gamma_j^T v$，在像 $B_{\\infty}^{|S|}$ 这样的紧凸集上最大化时，总是在一个极点上达到其最大值。因此，在离散顶点集上的上确界等于在整个凸球上的上确界：\n$$\n\\sup_{s \\in \\{-1, 1\\}^{|S|}} \\gamma_j^T s = \\sup_{v \\in B_{\\infty}^{|S|}} \\gamma_j^T v\n$$\n我们需要计算的项涉及一个绝对值 $|\\gamma_j^T s|$。我们可以将其表示为：\n$$\n\\sup_{s \\in \\{-1, 1\\}^{|S|}} |\\gamma_j^T s| = \\sup_{v \\in B_{\\infty}^{|S|}} |\\gamma_j^T v| = \\max\\left( \\sup_{v \\in B_{\\infty}^{|S|}} \\gamma_j^T v, \\sup_{v \\in B_{\\infty}^{|S|}} -\\gamma_j^T v \\right)\n$$\n这两个上确界问题中的每一个都是一个具有简单边界约束的线性规划 (LP) 问题：\n$$\n\\begin{array}{ll}\n\\text{maximize}  \\gamma_j^T v \\\\\n\\text{subject to}  -1 \\le v_k \\le 1, \\quad \\forall k \\in \\{1, \\dots, |S|\\}\n\\end{array}\n$$\n这个LP的解可以通过观察得到。为了最大化和 $\\sum_k (\\gamma_j)_k v_k$，我们应该选择每个 $v_k$ 在其边界上，其符号与 $(\\gamma_j)_k$ 的符号相匹配。也就是说，最优解是 $v_k^* = \\text{sign}((\\gamma_j)_k)$。因此，最优值为 $\\sum_k (\\gamma_j)_k \\text{sign}((\\gamma_j)_k) = \\sum_k |(\\gamma_j)_k| = \\|\\gamma_j\\|_1$。\n\n这个结果是对偶范数概念的直接应用。在范数 $\\|\\cdot\\|$ 的单位球上，线性泛函 $z^T v$ 的上确界定义了对偶范数 $\\|z\\|_*$。$\\ell_{\\infty}$-范数的对偶范数是 $\\ell_1$-范数。因此：\n$$\n\\sup_{v \\in B_{\\infty}^{|S|}} |\\gamma_j^T v| = \\|\\gamma_j\\|_1\n$$\n这为计算内部上确界提供了一种易于处理的、非枚举的方法。将此代回到我们对 $C(X, S)$ 的表达式中，我们得到：\n$$\nC(X, S) = \\max_{j \\in S^c} \\|\\gamma_j\\|_1\n$$\n这就是矩阵 $\\Gamma = X_{S^c}^T X_S (X_S^T X_S)^{-1}$ 各行 $\\ell_1$-范数的最大值。\n\n最终的算法如下：\n1.  根据支撑集 $S$ 将矩阵 $X$ 的列划分为 $X_S$ 和 $X_{S^c}$。\n2.  计算活动集的格拉姆矩阵 $G_S = X_S^T X_S$。\n3.  计算其逆矩阵 $G_S^{-1} = (X_S^T X_S)^{-1}$。\n4.  计算交叉积矩阵 $X_{S^c}^T X_S$。\n5.  计算矩阵 $\\Gamma = (X_{S^c}^T X_S) G_S^{-1}$。\n6.  对于 $\\Gamma$ 的每一行 $\\gamma_j^T$，计算其 $\\ell_1$-范数 $\\|\\gamma_j\\|_1$。\n7.  最坏情况障碍是这些 $\\ell_1$-范数的最大值：$C(X, S) = \\max_{j \\in S^c} \\|\\gamma_j\\|_1$。\n8.  将此值与阈值进行比较：确定是否 $C(X, S) \\le 1 - \\eta$。\n\n对每个测试用例实施此程序以产生最终的布尔结果。", "answer": "```python\nimport numpy as np\n\ndef solve_case(n, p, X, S, eta):\n    \"\"\"\n    Computes the irrepresentability condition for a single test case.\n\n    Args:\n        n (int): Number of samples.\n        p (int): Number of features.\n        X (np.ndarray): The data matrix of shape (n, p).\n        S (list): The list of indices in the support set (0-based).\n        eta (float): The margin parameter.\n\n    Returns:\n        bool: True if the condition is satisfied, False otherwise.\n    \"\"\"\n    # 1. Partition X into X_S and X_S^c\n    s_indices = sorted(list(S))\n    sc_indices = sorted([i for i in range(p) if i not in s_indices])\n    \n    X_S = X[:, s_indices]\n    X_Sc = X[:, sc_indices]\n    \n    # 2. Compute the Gram matrix on the active set\n    G_S = X_S.T @ X_S\n    \n    # Check for invertibility, though problem assumes it.\n    # A small determinant implies near-singularity.\n    if np.linalg.det(G_S) == 0:\n        # This case should not happen based on problem statement, but is good practice.\n        # If G_S is singular, the condition is ill-defined. We can treat this as a failure.\n        return False\n\n    # 3. Compute its inverse\n    try:\n        G_S_inv = np.linalg.inv(G_S)\n    except np.linalg.LinAlgError:\n        # Fails if matrix is singular or ill-conditioned\n        return False\n        \n    # 4. Compute the cross-product matrix\n    cross_product = X_Sc.T @ X_S\n    \n    # 5. Calculate the matrix Gamma\n    Gamma = cross_product @ G_S_inv\n    \n    # 6. For each row of Gamma, compute its l1-norm\n    # 7. Find the maximum l1-norm\n    # np.linalg.norm(Gamma, ord=1, axis=1) computes the l1 norm of each row.\n    l1_norms_of_rows = np.linalg.norm(Gamma, ord=1, axis=1)\n    worst_case_obstruction = np.max(l1_norms_of_rows) if l1_norms_of_rows.size > 0 else 0.0\n\n    # 8. Compare with the threshold\n    threshold = 1.0 - eta\n    return worst_case_obstruction = threshold\n\ndef solve():\n    \"\"\"\n    Main function to define test cases, run the solver, and print results.\n    \"\"\"\n    test_cases = [\n        {\n            \"n\": 6, \"p\": 4, \"S\": {0, 1}, \"eta\": 0.6,\n            \"X_cols\": [\n                [1, 0, 0, 0, 0, 0],\n                [0, 1, 0, 0, 0, 0],\n                [0.1, 0, np.sqrt(1 - 0.1**2), 0, 0, 0],\n                [0, 0.1, 0, np.sqrt(1 - 0.1**2), 0, 0]\n            ]\n        },\n        {\n            \"n\": 6, \"p\": 4, \"S\": {0, 1}, \"eta\": 0.25,\n            \"X_cols\": [\n                [1, 0, 0, 0, 0, 0],\n                [0, 1, 0, 0, 0, 0],\n                [0.375, 0.375, np.sqrt(1 - 2 * 0.375**2), 0, 0, 0],\n                [0.2, 0.2, 0, np.sqrt(1 - 2 * 0.2**2), 0, 0]\n            ]\n        },\n        {\n            \"n\": 6, \"p\": 4, \"S\": {0, 1}, \"eta\": 0.2,\n            \"X_cols\": [\n                [1, 0, 0, 0, 0, 0],\n                [0, 1, 0, 0, 0, 0],\n                [0.45, 0.45, np.sqrt(1 - 2 * 0.45**2), 0, 0, 0],\n                [0.35, 0.35, 0, np.sqrt(1 - 2 * 0.35**2), 0, 0]\n            ]\n        },\n        {\n            \"n\": 6, \"p\": 4, \"S\": {0, 1}, \"eta\": 0.1,\n            \"X_cols\": [\n                [1, 0, 0, 0, 0, 0],\n                [0.999, np.sqrt(1 - 0.999**2), 0, 0, 0, 0],\n                [0.35, 0.35, np.sqrt(1 - 0.35**2 - 0.35**2), 0, 0, 0],\n                [0.2, 0.05, 0, np.sqrt(1 - 0.2**2 - 0.05**2), 0, 0]\n            ]\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        n, p, S, eta = case['n'], case['p'], case['S'], case['eta']\n        X = np.array(case['X_cols']).T\n        result = solve_case(n, p, X, S, eta)\n        results.append(result)\n\n    # Format the final output as a comma-separated list of booleans\n    # The output must be exactly in the format [True,False,True,False] for example\n    final_output = f\"[{','.join(str(r) for r in results)}]\"\n    print(final_output)\n\nsolve()\n```", "id": "3489711"}]}