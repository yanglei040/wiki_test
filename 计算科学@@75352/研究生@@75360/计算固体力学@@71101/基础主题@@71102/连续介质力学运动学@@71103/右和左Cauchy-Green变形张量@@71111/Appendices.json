{"hands_on_practices": [{"introduction": "要真正掌握右柯西-格林($C$)和左柯西-格林($B$)变形张量的概念，最有效的方法之一就是通过一个具体的例子亲手计算它们。本练习将以一个简单的剪切变形为例，指导您直接应用它们的定义($C=F^{\\mathsf{T}} F$和$B=F F^{\\mathsf{T}}$)以及相关不变量的计算，从而将抽象的数学公式转化为具体的物理量。通过这个基础练习[@problem_id:3596643]，您将熟悉这些关键张量的基本计算过程。", "problem": "在三维空间中，一个连续体的均匀变形可以通过线性映射 $x = F X$ 来描述，其中 $F$ 是变形梯度。右柯西-格林变形张量 $C$ 和左柯西-格林变形张量 $B$ 分别定义为 $C = F^{\\mathsf{T}} F$ 和 $B = F F^{\\mathsf{T}}$。一个具有实特征值 $\\lambda_1$、$\\lambda_2$ 和 $\\lambda_3$ 的二阶张量 $T$ 的主不变量由其特征多项式的系数定义，即 $I_1(T) = \\lambda_1 + \\lambda_2 + \\lambda_3$、$I_2(T) = \\lambda_1 \\lambda_2 + \\lambda_2 \\lambda_3 + \\lambda_3 \\lambda_1$ 以及 $I_3(T) = \\lambda_1 \\lambda_2 \\lambda_3 = \\det(T)$。局部体积变化为 $J = \\det(F)$。\n\n考虑具有变形梯度的单剪切变形\n$$\nF = \\begin{bmatrix}\n1  \\gamma  0 \\\\\n0  1  0 \\\\\n0  0  1\n\\end{bmatrix},\n$$\n其中 $\\gamma$ 是一个实值剪切参数。仅使用上述基本定义及由其导出的恒等式，计算以下量，并将其明确表示为 $\\gamma$ 的函数：右柯西-格林变形张量 $C$、左柯西-格林变形张量 $B$、$C$ 的第一和第二主不变量（记为 $I_1$ 和 $I_2$）以及雅可比行列式 $J$。提供闭式表达式。不需要进行数值计算，也无需四舍五入。", "solution": "问题陈述是有效的，因为它基于连续介质力学原理，是适定的、自洽的且客观的。我们着手系统地计算所要求的量。\n\n单剪切的变形梯度 $F$ 如下所示：\n$$\nF = \\begin{bmatrix}\n1  \\gamma  0 \\\\\n0  1  0 \\\\\n0  0  1\n\\end{bmatrix}\n$$\n其中 $\\gamma$ 是剪切参数。\n\n首先，我们计算右柯西-格林变形张量 $C$。根据定义，$C = F^{\\mathsf{T}} F$。$F$ 的转置是：\n$$\nF^{\\mathsf{T}} = \\begin{bmatrix}\n1  0  0 \\\\\n\\gamma  1  0 \\\\\n0  0  1\n\\end{bmatrix}\n$$\n执行矩阵乘法得到：\n$$\nC = F^{\\mathsf{T}} F = \\begin{bmatrix}\n1  0  0 \\\\\n\\gamma  1  0 \\\\\n0  0  1\n\\end{bmatrix}\n\\begin{bmatrix}\n1  \\gamma  0 \\\\\n0  1  0 \\\\\n0  0  1\n\\end{bmatrix} = \\begin{bmatrix}\n1(1) + 0(0) + 0(0)  & 1(\\gamma) + 0(1) + 0(0)  & 1(0) + 0(0) + 0(1) \\\\\n\\gamma(1) + 1(0) + 0(0)  & \\gamma(\\gamma) + 1(1) + 0(0)  & \\gamma(0) + 1(0) + 0(1) \\\\\n0(1) + 0(0) + 1(0)  & 0(\\gamma) + 0(1) + 1(0)  & 0(0) + 0(0) + 1(1)\n\\end{bmatrix}\n$$\n$$\nC = \\begin{bmatrix}\n1  & \\gamma  & 0 \\\\\n\\gamma  & 1+\\gamma^2  & 0 \\\\\n0  & 0  & 1\n\\end{bmatrix}\n$$\n\n其次，我们计算左柯西-格林变形张量 $B$。根据定义，$B = F F^{\\mathsf{T}}$。\n$$\nB = F F^{\\mathsf{T}} = \\begin{bmatrix}\n1  & \\gamma  & 0 \\\\\n0  & 1  & 0 \\\\\n0  & 0  & 1\n\\end{bmatrix}\n\\begin{bmatrix}\n1  & 0  & 0 \\\\\n\\gamma  & 1  & 0 \\\\\n0  & 0  & 1\n\\end{bmatrix} = \\begin{bmatrix}\n1(1) + \\gamma(\\gamma) + 0(0)  & 1(0) + \\gamma(1) + 0(0)  & 1(0) + \\gamma(0) + 0(1) \\\\\n0(1) + 1(\\gamma) + 0(0)  & 0(0) + 1(1) + 0(0)  & 0(0) + 1(0) + 0(1) \\\\\n0(1) + 0(\\gamma) + 1(0)  & 0(0) + 0(1) + 1(0)  & 0(0) + 0(0) + 1(1)\n\\end{bmatrix}\n$$\n$$\nB = \\begin{bmatrix}\n1+\\gamma^2  & \\gamma  & 0 \\\\\n\\gamma  & 1  & 0 \\\\\n0  & 0  & 1\n\\end{bmatrix}\n$$\n\n第三，我们计算 $C$ 的第一主不变量，记为 $I_1$。张量的第一不变量是其迹。\n$$\nI_1 = I_1(C) = \\text{tr}(C) = 1 + (1+\\gamma^2) + 1 = 3+\\gamma^2\n$$\n\n第四，我们计算 $C$ 的第二主不变量，记为 $I_2$。第二不变量可以通过公式 $I_2(T) = \\frac{1}{2} [(\\text{tr}(T))^2 - \\text{tr}(T^2)]$ 计算。我们已经求得 $\\text{tr}(C) = 3+\\gamma^2$。现在我们计算 $C^2$ 以求其迹。\n$$\nC^2 = \\begin{bmatrix}\n1  & \\gamma  & 0 \\\\\n\\gamma  & 1+\\gamma^2  & 0 \\\\\n0  & 0  & 1\n\\end{bmatrix}\n\\begin{bmatrix}\n1  & \\gamma  & 0 \\\\\n\\gamma  & 1+\\gamma^2  & 0 \\\\\n0  & 0  & 1\n\\end{bmatrix} = \\begin{bmatrix}\n1+\\gamma^2  & \\gamma + \\gamma(1+\\gamma^2)  & 0 \\\\\n\\gamma + \\gamma(1+\\gamma^2)   & \\gamma^2 + (1+\\gamma^2)^2  & 0 \\\\\n0  & 0  & 1\n\\end{bmatrix}\n$$\n$C^2$ 的迹是其对角元素之和：\n$$\n\\text{tr}(C^2) = (1+\\gamma^2) + (\\gamma^2 + (1+\\gamma^2)^2) + 1 = 1+\\gamma^2 + \\gamma^2 + (1+2\\gamma^2+\\gamma^4) + 1 = 3 + 4\\gamma^2 + \\gamma^4\n$$\n现在，我们可以计算 $I_2$：\n$$\nI_2 = I_2(C) = \\frac{1}{2} [(\\text{tr}(C))^2 - \\text{tr}(C^2)] = \\frac{1}{2} [(3+\\gamma^2)^2 - (3 + 4\\gamma^2 + \\gamma^4)]\n$$\n$$\nI_2 = \\frac{1}{2} [(9+6\\gamma^2+\\gamma^4) - 3 - 4\\gamma^2 - \\gamma^4] = \\frac{1}{2} [6+2\\gamma^2] = 3+\\gamma^2\n$$\n一个已知的性质是 $C$ 和 $B$ 是同谱的，这意味着它们具有相同的特征值，因此具有相同的主不变量。确实，我们发现 $I_1(C) = I_1(B) = 3+\\gamma^2$ 和 $I_2(C) = I_2(B) = 3+\\gamma^2$。\n\n最后，我们计算雅可比行列式 $J$，即变形梯度 $F$ 的行列式。由于 $F$ 是一个上三角矩阵，其行列式是其对角元素的乘积。\n$$\nJ = \\det(F) = \\det\\begin{bmatrix}\n1  & \\gamma  & 0 \\\\\n0  & 1  & 0 \\\\\n0  & 0  & 1\n\\end{bmatrix} = 1 \\cdot 1 \\cdot 1 = 1\n$$\n这个结果 $J=1$ 证实了单剪切是等容（保持体积）变形。\n\n所要求的量现在已完全确定为 $\\gamma$ 的函数。", "answer": "$$\n\\boxed{\n\\begin{aligned}\nC &= \\begin{bmatrix} 1 & \\gamma & 0 \\\\ \\gamma & 1+\\gamma^2 & 0 \\\\ 0 & 0 & 1 \\end{bmatrix} \\\\\nB &= \\begin{bmatrix} 1+\\gamma^2 & \\gamma & 0 \\\\ \\gamma & 1 & 0 \\\\ 0 & 0 & 1 \\end{bmatrix} \\\\\nI_1 &= 3+\\gamma^2 \\\\\nI_2 &= 3+\\gamma^2 \\\\\nJ &= 1\n\\end{aligned}\n}\n$$", "id": "3596643"}, {"introduction": "在掌握了柯西-格林张量的基本计算之后，下一步是理解它们的物理意义。柯西-格林张量的真正威力在于其谱分解（即特征值和特征向量），它们分别量化了材料局部拉伸的量值和方向。本练习[@problem_id:3596678]通过一个特殊的纯拉伸变形案例，巧妙地揭示了变形梯度$F$、主拉伸，以及$C$和$B$张量特征系统之间的直接联系。", "problem": "考虑一个给定的变形梯度 $F \\in \\mathbb{R}^{3 \\times 3}$，其表达式为 $F = Q \\, \\operatorname{diag}(2, \\tfrac{1}{2}, 1) \\, Q^{T}$，其中 $Q \\in \\mathbb{R}^{3 \\times 3}$ 是一个满足 $Q^{T} Q = I$ 的正交矩阵。右柯西-格林变形张量定义为 $C = F^{T} F$，左柯西-格林变形张量定义为 $B = F F^{T}$。主拉伸定义为 $C$（或等效地，$B$）的特征值的平方根。从这些定义和正交矩阵的性质出发，推导主拉伸，并以 $Q$ 的列向量形式确定 $C$ 和 $B$ 相应的标准正交特征向量。最终答案需以 $Q$ 的符号形式表示；无需四舍五入，也无单位。你的最终答案应列出主拉伸，然后是张成 $C$ 和 $B$ 的特征空间的三个特征向量（以列向量形式）。", "solution": "该问题被验证为具有科学依据、适定且客观。这是连续介质力学中的一个标准问题，内容自洽且无矛盾。\n\n设给定的变形梯度为 $F \\in \\mathbb{R}^{3 \\times 3}$。其表达式为\n$$F = Q \\, \\operatorname{diag}\\left(2, \\frac{1}{2}, 1\\right) \\, Q^{T}$$\n其中 $Q \\in \\mathbb{R}^{3 \\times 3}$ 是一个正交矩阵，满足 $Q^{T}Q = Q Q^{T} = I$，其中 $I$ 是单位矩阵。我们将对角矩阵记为 $D$，所以\n$$D = \\operatorname{diag}\\left(2, \\frac{1}{2}, 1\\right)$$\n因此，$F = Q D Q^{T}$。$D$ 的对角线元素均为正，所以 $D$ 是一个正定对角矩阵。\n\n首先，我们分析 $F$ 的结构。我们计算其转置 $F^T$：\n$$F^{T} = \\left(Q D Q^{T}\\right)^{T} = \\left(Q^{T}\\right)^{T} D^{T} Q^{T}$$\n因为乘积的转置是转置的逆序乘积。对于任意矩阵 $A$，有 $(A^T)^T = A$。由于 $D$ 是一个对角矩阵，它是对称的，所以 $D^T = D$。因此，\n$$F^{T} = Q D Q^{T} = F$$\n这表明给定的变形梯度 $F$ 是一个对称矩阵。这是一种特殊的变形，称为纯拉伸，其中变形的旋转部分是单位矩阵。\n\n右柯西-格林变形张量 $C$ 定义为 $C = F^{T}F$。由于 $F^T = F$，我们有：\n$$C = F^{T}F = F F = F^2$$\n代入给定的 $F$ 的表达式：\n$$C = (Q D Q^{T})(Q D Q^{T})$$\n利用 $Q$ 是正交矩阵的性质，$Q^{T}Q = I$：\n$$C = Q D (Q^{T}Q) D Q^{T} = Q D I D Q^{T} = Q D^2 Q^{T}$$\n矩阵 $D^2$ 为\n$$D^2 = \\operatorname{diag}\\left(2^2, \\left(\\frac{1}{2}\\right)^2, 1^2\\right) = \\operatorname{diag}\\left(4, \\frac{1}{4}, 1\\right)$$\n表达式 $C = Q D^2 Q^T$ 是对称矩阵 $C$ 的谱分解。$C$ 的特征值是 $D^2$ 的对角元素，相应的特征向量是 $Q$ 的列向量。\n\n主拉伸，记为 $\\lambda_i$，定义为 $C$ 的特征值的平方根。设 $C$ 的特征值为 $\\mu_i$。\n$$\\mu_1 = 4, \\quad \\mu_2 = \\frac{1}{4}, \\quad \\mu_3 = 1$$\n因此，主拉伸为：\n$$\\lambda_1 = \\sqrt{\\mu_1} = \\sqrt{4} = 2$$\n$$\\lambda_2 = \\sqrt{\\mu_2} = \\sqrt{\\frac{1}{4}} = \\frac{1}{2}$$\n$$\\lambda_3 = \\sqrt{\\mu_3} = \\sqrt{1} = 1$$\n\n接下来，我们确定特征向量。设矩阵 $Q$ 的列向量记为 $q_1, q_2, q_3$，使得 $Q = \\begin{pmatrix} q_1 & q_2 & q_3 \\end{pmatrix}$。由于 $Q$ 是一个正交矩阵，向量集合 $\\{q_1, q_2, q_3\\}$ 构成一个标准正交基。\n根据谱分解 $C = Q D^2 Q^T$，$C$ 对应于特征值 $\\mu_i$ 的特征向量是 $Q$ 的第 $i$ 列。\n对应于 $\\mu_1 = 4$ 的特征向量是 $q_1$。\n对应于 $\\mu_2 = \\frac{1}{4}$ 的特征向量是 $q_2$。\n对应于 $\\mu_3 = 1$ 的特征向量是 $q_3$。\n\n现在我们考虑左柯西-格林变形张量 $B$，定义为 $B = FF^{T}$。由于我们已经确定 $F$ 是对称的（$F = F^T$），这给出：\n$$B = FF^{T} = FF = F^2$$\n这意味着 $B = C$。\n$$B = C = Q D^2 Q^{T}$$\n因此，左柯西-格林张量 $B$ 与右柯西-格林张量 $C$ 具有完全相同的特征值和特征向量。\n$B$ 的特征值为 $\\mu_1 = 4$，$\\mu_2 = \\frac{1}{4}$ 和 $\\mu_3 = 1$。相应的标准正交特征向量分别是 $q_1$，$q_2$ 和 $q_3$。\n\n问题要求 $C$ 和 $B$ 的主拉伸以及相应的标准正交特征向量。由于 $C=B$，它们的特征系统是相同的。标准正交特征向量 $q_1, q_2, q_3$ 张成了这两个张量的特征空间。\n\n总结如下：\n主拉伸为 $\\lambda_1 = 2$，$\\lambda_2 = \\frac{1}{2}$ 和 $\\lambda_3 = 1$。\n$C$ 和 $B$ 的标准正交特征向量都是矩阵 $Q$ 的列向量。设 $q_1, q_2, q_3$ 为 $Q$ 的列向量。\n- 对应于主拉伸 $\\lambda_1 = 2$（特征值 $\\mu_1=4$）的特征向量是 $q_1$。\n- 对应于主拉伸 $\\lambda_2 = \\frac{1}{2}$（特征值 $\\mu_2=\\frac{1}{4}$）的特征向量是 $q_2$。\n- 对应于主拉伸 $\\lambda_3 = 1$（特征值 $\\mu_3=1$）的特征向量是 $q_3$。\n\n最终答案将列出主拉伸，然后是这三个相应特征向量的符号表示。", "answer": "$$\n\\boxed{\n\\begin{aligned}\n\\text{主拉伸: } & \\lambda_1=2, \\lambda_2=\\frac{1}{2}, \\lambda_3=1 \\\\\n\\text{C 和 B 的特征向量: } & q_1, q_2, q_3\n\\end{aligned}\n}\n$$", "id": "3596678"}, {"introduction": "理论知识和物理直觉最终需要在计算实践中得到应用。本练习[@problem_id:3596619]将指导您完成一个在计算固体力学中至关重要的核心任务：对变形梯度$F$进行极分解，将其分离为一个旋转张量$R$和一个拉伸张量$U$。您将通过对右柯西-格林张量$C$进行谱分解来计算右拉伸张量$U=\\sqrt{C}$，从而将前面练习中获得的理论知识应用于解决一个实际的计算问题。", "problem": "给定一系列三维情况下的变形梯度矩阵。您的任务是实现一个数值程序，为每种情况构建右柯西-格林（Cauchy-Green）变形张量，通过谱分解获得右拉伸张量，重构右极分解中的旋转，并验证其正交性。推导必须从连续介质运动学的基本定义开始。具体来说，请使用以下基础：\n- 变形梯度由 $F \\in \\mathbb{R}^{3 \\times 3}$ 表示。\n- 右柯西-格林变形张量为 $C = F^{T} F$。\n- 左柯西-格林变形张量为 $B = F F^{T}$。\n- 右拉伸张量 $U$ 是 $C$ 唯一的对称正定（SPD）平方根，即 $U = C^{1/2}$，其中 $U \\succ 0$ 且 $U^{2} = C$。\n- 左拉伸张量 $V$ 是 $B$ 唯一的对称正定（SPD）平方根，即 $V = B^{1/2}$，其中 $V \\succ 0$ 且 $V^{2} = B$。\n- 右极分解为 $F = R U$，其中 $R$ 是正交的，$U$ 是对称正定的。\n- 左极分解为 $F = V R$，其中 $V$ 是对称正定的，$R$ 是正交的。\n\n您的程序必须在不使用任何外部数据的情况下，为每个给定的 $F$ 执行以下操作：\n1. 构建 $C = F^{T} F$ 和 $B = F F^{T}$。\n2. 使用对称矩阵 $C$ 的谱分解计算 $U$ 作为 $C$ 的对称正定平方根：如果 $C = Q \\Lambda Q^{T}$，其中 $Q$ 是正交矩阵，$\\Lambda = \\mathrm{diag}(\\lambda_{1},\\lambda_{2},\\lambda_{3})$ 且 $\\lambda_{i} \\ge 0$，则定义 $U = Q \\,\\mathrm{diag}(\\sqrt{\\lambda_{1}},\\sqrt{\\lambda_{2}},\\sqrt{\\lambda_{3}})\\, Q^{T}$。为保证数值稳健性，如果任何 $\\lambda_{i}$ 由于浮点误差而略微为负，则将其视为 $0$。\n3. 使用通过相同特征基构建的 $U$ 的逆矩阵，形成 $R = F U^{-1}$：$U^{-1} = Q \\,\\mathrm{diag}(1/\\sqrt{\\lambda_{1}},1/\\sqrt{\\lambda_{2}},1/\\sqrt{\\lambda_{3}})\\, Q^{T}$，假设 $\\lambda_{i} > 0$（提供的测试套件确保了可逆性）。\n4. 通过计算弗罗贝尼乌斯（Frobenius）范数 $||R^{T} R - I||_{F}$ 并与容差 $\\tau_{\\mathrm{orth}} = 1 \\times 10^{-8}$ 进行比较来验证正交性。\n5. 独立地通过 $B$ 的谱分解计算左拉伸张量 $V = B^{1/2}$，形成 $R_{\\mathrm{alt}} = V^{-1} F$，并通过评估 $||R_{\\mathrm{alt}} - R||_{F} \\le \\tau_{\\mathrm{cons}}$（其中 $\\tau_{\\mathrm{cons}} = 1 \\times 10^{-8}$）来检查与先前旋转的一致性。\n6. 通过检查相对弗罗贝尼乌斯误差 $||F - R U||_{F} / ||F||_{F} \\le \\tau_{\\mathrm{rec}}$（其中 $\\tau_{\\mathrm{rec}} = 1 \\times 10^{-9}$）来验证重构。\n\n对于每个测试用例，输出一个布尔值，当且仅当所有三个检查都通过时为真：\n- $||R^{T} R - I||_{F} \\le \\tau_{\\mathrm{orth}}$，\n- $||R_{\\mathrm{alt}} - R||_{F} \\le \\tau_{\\mathrm{cons}}$，\n- $||F - R U||_{F} / ||F||_{F} \\le \\tau_{\\mathrm{rec}}$，\n否则为假。\n\n用于构建以下矩阵的角度单位已经嵌入到数值中；您的程序不得计算角度。最终答案不涉及物理单位。\n\n测试套件（每个用例是一个 $3 \\times 3$ 矩阵 $F$）：\n- 用例 1（一般拉伸和旋转）：\n  $$\n  F_{1} = \\begin{bmatrix}\n  1.4330047336884090  -0.2364161653290717  0.0 \\\\\n  0.4432803099920094  0.7642691913004848  0.0 \\\\\n  0.0  0.0  1.2\n  \\end{bmatrix}.\n  $$\n- 用例 2（绕 $x$ 轴旋转 $- \\pi/3$ 弧度的纯旋转）：\n  $$\n  F_{2} = \\begin{bmatrix}\n  1.0  0.0  0.0 \\\\\n  0.0  0.5  0.8660254037844386 \\\\\n  0.0  -0.8660254037844386  0.5\n  \\end{bmatrix}.\n  $$\n- 用例 3（具有负行列式的非正常变形）：\n  $$\n  F_{3} = \\begin{bmatrix}\n  -1.1  0.0  0.0 \\\\\n  0.0  0.9  0.0 \\\\\n  0.0  0.0  1.3\n  \\end{bmatrix}.\n  $$\n- 用例 4（病态但可逆）：\n  $$\n  F_{4} = \\begin{bmatrix}\n  0.0008775825618903728  0.0  47.9425538604203 \\\\\n  0.0  1.0  0.0 \\\\\n  -0.000479425538604203  0.0  87.75825618903728\n  \\end{bmatrix}.\n  $$\n\n最终输出格式：\n- 您的程序应生成一行输出，其中包含用方括号括起来的逗号分隔的结果列表（例如，\"[true1,true2,true3,true4]\"，但使用 Python 布尔格式 \"True\" 或 \"False\"）。具体来说，输出必须是 \"[$b_{1},b_{2},b_{3},b_{4}$]\" 的形式，其中 $b_{k} \\in \\{\\mathrm{True},\\mathrm{False}\\}$ 是用例 $k$ 的结果。", "solution": "该问题要求实现并验证一个给定的 $3 \\times 3$ 变形梯度张量 $F$ 的极分解。极分解定理指出，任何可逆张量 $F$ 都可以唯一地分解为一个正交张量 $R$ 和一个对称正定（SPD）张量 $U$ 或 $V$ 的乘积。具体来说，我们有右极分解 $F=RU$ 和左极分解 $F=VR$。张量 $U$ 和 $V$ 分别称为右拉伸张量和左拉伸张量，$R$ 是旋转张量。该数值程序将根据三个标准进行验证：$R$ 的正交性、右分解和左分解之间的一致性，以及重构的准确性。\n\n提供的运动学定义构成了我们算法的基础。变形梯度为 $F \\in \\mathbb{R}^{3 \\times 3}$。右和左柯西-格林变形张量 $C$ 和 $B$ 定义为：\n$$\nC = F^{T} F\n$$\n$$\nB = F F^{T}\n$$\n根据构造，$C$ 和 $B$ 都是对称矩阵。它们也是半正定的，因为对于任何向量 $x \\in \\mathbb{R}^{3}$，我们有 $x^{T} C x = x^{T} F^{T} F x = (Fx)^{T}(Fx) = ||Fx||_{2}^{2} \\ge 0$。如果 $F$ 是可逆的，如测试用例中所指定，那么 $C$ 和 $B$ 是正定的。\n\n右拉伸张量 $U$ 和左拉伸张量 $V$ 分别是 $C$ 和 $B$ 唯一的对称正定平方根：\n$$\nU = C^{1/2}, \\quad U^2 = C, \\quad U=U^T, \\quad U \\succ 0\n$$\n$$\nV = B^{1/2}, \\quad V^2 = B, \\quad V=V^T, \\quad V \\succ 0\n$$\n\n数值任务的核心是计算这些张量的平方根。这通过使用对称矩阵 $C$ 和 $B$ 的谱分解（或特征分解）来完成。对于对称矩阵 $C$，存在一个正交矩阵 $Q$（其列是 $C$ 的标准正交特征向量）和一个对角矩阵 $\\Lambda$（其对角线元素是对应的实特征值 $\\lambda_{i}$）。分解为：\n$$\nC = Q \\Lambda Q^{T}\n$$\n其中 $\\Lambda = \\mathrm{diag}(\\lambda_{1}, \\lambda_{2}, \\lambda_{3})$。由于 $C$ 是正定的，其所有特征值都严格为正，$\\lambda_i > 0$。然后，平方根 $U$ 可以计算为：\n$$\nU = C^{1/2} = Q \\Lambda^{1/2} Q^{T}\n$$\n其中 $\\Lambda^{1/2} = \\mathrm{diag}(\\sqrt{\\lambda_{1}}, \\sqrt{\\lambda_{2}}, \\sqrt{\\lambda_{3}})$。作为数值稳健性的措施，如果由于浮点不精确而发现任何特征值为小的负数，则在取平方根之前将其截断为 $0$。\n\n一旦计算出 $U$，就可以通过对 $U$求逆来找到右极分解 $F = RU$ 中的旋转张量 $R$：\n$$\nR = F U^{-1}\n$$\n利用相同的特征分解可以高效地计算 $U$ 的逆：\n$$\nU^{-1} = (Q \\Lambda^{1/2} Q^{T})^{-1} = (Q^{T})^{-1} (\\Lambda^{1/2})^{-1} Q^{-1} = Q \\Lambda^{-1/2} Q^{T}\n$$\n其中 $\\Lambda^{-1/2} = \\mathrm{diag}(1/\\sqrt{\\lambda_{1}}, 1/\\sqrt{\\lambda_{2}}, 1/\\sqrt{\\lambda_{3}})$。由于所有 $\\lambda_i > 0$，这是有效的。\n\n对于每个给定的 $F$，算法按以下步骤进行：\n1. 计算 $C = F^{T} F$ 和 $B = F F^{T}$。\n2. 对 $C$ 进行谱分解，得到特征值 $\\lambda_i$ 和特征向量矩阵 $Q$。计算 $U = Q \\, \\mathrm{diag}(\\sqrt{\\lambda_i}) \\, Q^{T}$。\n3. 计算逆矩阵 $U^{-1} = Q \\, \\mathrm{diag}(1/\\sqrt{\\lambda_i}) \\, Q^{T}$，然后计算旋转矩阵 $R = F U^{-1}$。\n4. 进行第一次验证：检查正交性。一个正交矩阵 $R$ 满足 $R^{T} R = I$，其中 $I$ 是单位矩阵。通过计算残差的弗罗贝尼乌斯范数 $||R^{T} R - I||_{F}$ 并确保其低于容差 $\\tau_{\\mathrm{orth}} = 1 \\times 10^{-8}$ 来执行检查。\n5. 进行第二次验证：检查一致性。旋转矩阵也可以从左分解 $F=VR$ 中计算得出，即 $R_{\\mathrm{alt}} = V^{-1}F$。左拉伸张量 $V=B^{1/2}$ 及其逆 $V^{-1}$ 通过 $B$ 的谱分解计算。理论保证 $R_{\\mathrm{alt}}$ 必须与 $R$ 相同。通过计算 $||R_{\\mathrm{alt}} - R||_{F}$ 并确保其低于容差 $\\tau_{\\mathrm{cons}} = 1 \\times 10^{-8}$ 来进行检查。\n6. 进行第三次验证：检查重构精度。计算出的分解 $F \\approx RU$ 必须能高精度地重构原始矩阵 $F$。通过评估相对弗罗贝尼乌斯误差 $||F - R U||_{F} / ||F||_{F}$ 并确保其低于容差 $\\tau_{\\mathrm{rec}} = 1 \\times 10^{-9}$ 来进行检查。\n\n一个测试用例被认为是成功的（评估为真），当且仅当所有三个数值检查都满足。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef compute_spd_sqrt_and_inv(A):\n    \"\"\"\n    Computes the symmetric positive-definite square root of a matrix A and its inverse\n    using spectral decomposition.\n    A must be a symmetric positive semi-definite matrix.\n    \"\"\"\n    # Use eigh for symmetric matrices; it's more efficient and numerically stable.\n    eigvals, eigvecs = np.linalg.eigh(A)\n    \n    # Clamp small negative eigenvalues that may arise from floating-point errors.\n    eigvals[eigvals < 0] = 0\n    \n    # Compute square root of eigenvalues\n    sqrt_eigvals = np.sqrt(eigvals)\n    \n    # Form the diagonal matrix of square root eigenvalues\n    Lambda_sqrt = np.diag(sqrt_eigvals)\n    \n    # Reconstruct the matrix square root\n    A_sqrt = eigvecs @ Lambda_sqrt @ eigvecs.T\n    \n    # Compute inverse square root of eigenvalues.\n    # Add a small epsilon to avoid division by zero if an eigenvalue is exactly 0,\n    # although the problem statement implies invertible F, so eigenvalues of C and B are > 0.\n    inv_sqrt_eigvals = np.zeros_like(eigvals)\n    # Check for non-zero eigenvalues before division\n    non_zero_mask = eigvals > 1e-12 # A practical tolerance for non-zero\n    inv_sqrt_eigvals[non_zero_mask] = 1.0 / sqrt_eigvals[non_zero_mask]\n\n    Lambda_inv_sqrt = np.diag(inv_sqrt_eigvals)\n    \n    # Reconstruct the inverse of the matrix square root\n    A_inv_sqrt = eigvecs @ Lambda_inv_sqrt @ eigvecs.T\n    \n    return A_sqrt, A_inv_sqrt\n\ndef solve():\n    \"\"\"\n    Performs polar decomposition for a series of deformation gradients F\n    and verifies the results against several criteria.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        np.array([\n            [1.4330047336884090, -0.2364161653290717, 0.0],\n            [0.4432803099920094, 0.7642691913004848, 0.0],\n            [0.0, 0.0, 1.2]\n        ]),\n        np.array([\n            [1.0, 0.0, 0.0],\n            [0.0, 0.5, 0.8660254037844386],\n            [0.0, -0.8660254037844386, 0.5]\n        ]),\n        np.array([\n            [-1.1, 0.0, 0.0],\n            [0.0, 0.9, 0.0],\n            [0.0, 0.0, 1.3]\n        ]),\n        np.array([\n            [0.0008775825618903728, 0.0, 47.9425538604203],\n            [0.0, 1.0, 0.0],\n            [-0.000479425538604203, 0.0, 87.75825618903728]\n        ])\n    ]\n\n    # Define tolerances\n    tau_orth = 1e-8\n    tau_cons = 1e-8\n    tau_rec = 1e-9\n\n    results = []\n    I = np.identity(3)\n\n    for F in test_cases:\n        # 1. Construct C and B\n        C = F.T @ F\n        B = F @ F.T\n\n        # 2. Compute U from C\n        U, U_inv = compute_spd_sqrt_and_inv(C)\n        \n        # 3. Form R\n        R = F @ U_inv\n\n        # 4. Verify orthogonality of R\n        orth_error = np.linalg.norm(R.T @ R - I, 'fro')\n        check_orth = orth_error <= tau_orth\n\n        # 5. Compute R_alt from B and V, and check consistency\n        V, V_inv = compute_spd_sqrt_and_inv(B)\n        R_alt = V_inv @ F\n        cons_error = np.linalg.norm(R_alt - R, 'fro')\n        check_cons = cons_error <= tau_cons\n\n        # 6. Verify reconstruction accuracy\n        F_norm = np.linalg.norm(F, 'fro')\n        # Avoid division by zero for a zero matrix F, although not in test cases\n        if F_norm > 1e-12:\n            rec_error_rel = np.linalg.norm(F - R @ U, 'fro') / F_norm\n        else:\n            rec_error_rel = np.linalg.norm(F - R @ U, 'fro')\n        \n        check_rec = rec_error_rel <= tau_rec\n\n        # Final result for the case is true if all checks pass\n        results.append(check_orth and check_cons and check_rec)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3596619"}]}