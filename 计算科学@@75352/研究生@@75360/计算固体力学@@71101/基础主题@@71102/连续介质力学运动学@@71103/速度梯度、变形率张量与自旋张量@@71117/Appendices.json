{"hands_on_practices": [{"introduction": "在连续介质力学中，一个基本原则是物理定律不应依赖于观测者的刚体运动，这一特性被称为物质坐标系无关性或客观性。变形率张量 $D$ 作为描述材料真实变形的量，必须是客观的，而自旋张量 $W$ 则不然。这个练习 [@problem_id:3609175] 将通过编程实践，让你亲手验证这一核心原则，加深对本构模型必须建立在客观率之上的理解。", "problem": "在计算固体力学中，构造一个程序化验证，以检验变形率张量在叠加刚性旋转下的不变性。从以下基本概念开始：空间速度场 $\\mathbf{v}(\\mathbf{x},t)$ 及其由 $L_{ij}=\\partial v_{i}/\\partial x_{j}$ 定义的速度梯度 $\\mathbf{L}(\\mathbf{x},t)$，对称的变形率张量 $\\mathbf{D}=\\tfrac{1}{2}\\left(\\mathbf{L}+\\mathbf{L}^{\\mathsf{T}}\\right)$，以及反对称的自旋张量 $\\mathbf{W}=\\tfrac{1}{2}\\left(\\mathbf{L}-\\mathbf{L}^{\\mathsf{T}}\\right)$。考虑一个角速度向量为 $\\boldsymbol{\\omega}(t)$ 的叠加刚性旋转，它为速度场增加了刚体贡献 $\\mathbf{v}^{\\mathrm{R}}(\\mathbf{x},t)=\\boldsymbol{\\omega}(t)\\times\\mathbf{x}$。该刚体贡献的梯度是一个反对称张量 $\\boldsymbol{\\Omega}$，对于任意向量 $\\mathbf{a}$，它满足 $\\boldsymbol{\\Omega}\\,\\mathbf{a}=\\boldsymbol{\\omega}\\times\\mathbf{a}$，并具有以下矩阵表示\n$$\n\\boldsymbol{\\Omega}=\\begin{bmatrix}\n0  -\\omega_{3}  \\omega_{2} \\\\\n\\omega_{3}  0  -\\omega_{1} \\\\\n-\\omega_{2}  \\omega_{1}  0\n\\end{bmatrix}.\n$$\n在叠加刚性旋转下，修改后的速度梯度为 $\\mathbf{L}^{\\ast}=\\mathbf{L}+\\boldsymbol{\\Omega}$，这意味着 $\\mathbf{D}^{\\ast}=\\tfrac{1}{2}\\left(\\mathbf{L}^{\\ast}+\\mathbf{L}^{\\ast\\mathsf{T}}\\right)$ 和 $\\mathbf{W}^{\\ast}=\\tfrac{1}{2}\\left(\\mathbf{L}^{\\ast}-\\mathbf{L}^{\\ast\\mathsf{T}}\\right)$。需要验证的不变性和变换性质是：$\\mathbf{D}^{\\ast}=\\mathbf{D}$ 和 $\\mathbf{W}^{\\ast}=\\mathbf{W}+\\boldsymbol{\\Omega}$。你的程序必须实现这些定义，计算相关张量，并使用弗罗贝尼乌斯范数 $\\|\\cdot\\|_{\\mathrm{F}}$ 来数值验证所述性质。\n\n使用以下参数值测试套件，其中每个测试用例提供一个单位为 $\\mathrm{s}^{-1}$ 的恒定基础速度梯度 $\\mathbf{L}$ 和一个单位为弧度/秒 (rad/s) 的角速度向量 $\\boldsymbol{\\omega}$。所有量均以国际单位制 (SI) 表示。角度单位是弧度。\n\n测试用例 $\\mathbf{1}$ (一般非对称 $\\mathbf{L}$，非零 $\\boldsymbol{\\omega}$):\n$$\n\\mathbf{L}_{1}=\\begin{bmatrix}\n0.5  -1.2  0.3 \\\\\n2.1  0.0  -0.7 \\\\\n0.4  -0.9  1.8\n\\end{bmatrix}\\,\\mathrm{s}^{-1},\\quad\n\\boldsymbol{\\omega}_{1}=\\begin{bmatrix}\n0.6\\\\\n-0.2\\\\\n0.4\n\\end{bmatrix}\\,\\mathrm{rad/s}.\n$$\n\n测试用例 $\\mathbf{2}$ (一般 $\\mathbf{L}$，零 $\\boldsymbol{\\omega}$ 边界情况):\n$$\n\\mathbf{L}_{2}=\\begin{bmatrix}\n-0.3  0.7  -0.5 \\\\\n1.2  0.4  -1.1 \\\\\n0.8  -1.1  0.2\n\\end{bmatrix}\\,\\mathrm{s}^{-1},\\quad\n\\boldsymbol{\\omega}_{2}=\\begin{bmatrix}\n0.0\\\\\n0.0\\\\\n0.0\n\\end{bmatrix}\\,\\mathrm{rad/s}.\n$$\n\n测试用例 $\\mathbf{3}$ (纯对称 $\\mathbf{L}$，非零 $\\boldsymbol{\\omega}$):\n$$\n\\mathbf{L}_{3}=\\begin{bmatrix}\n1.0  0.2  -0.3 \\\\\n0.2  0.5  0.1 \\\\\n-0.3  0.1  0.8\n\\end{bmatrix}\\,\\mathrm{s}^{-1},\\quad\n\\boldsymbol{\\omega}_{3}=\\begin{bmatrix}\n1.0\\\\\n1.0\\\\\n1.0\n\\end{bmatrix}\\,\\mathrm{rad/s}.\n$$\n\n测试用例 $\\mathbf{4}$ (纯反对称 $\\mathbf{L}$，非零 $\\boldsymbol{\\omega}$):\n$$\n\\mathbf{L}_{4}=\\begin{bmatrix}\n0.0  -2.0  3.0 \\\\\n2.0  0.0  -1.0 \\\\\n-3.0  1.0  0.0\n\\end{bmatrix}\\,\\mathrm{s}^{-1},\\quad\n\\boldsymbol{\\omega}_{4}=\\begin{bmatrix}\n-0.5\\\\\n2.0\\\\\n0.0\n\\end{bmatrix}\\,\\mathrm{rad/s}.\n$$\n\n测试用例 $\\mathbf{5}$ (微小量值边缘情况):\n$$\n\\mathbf{L}_{5}=\\begin{bmatrix}\n10^{-12}  -2\\times 10^{-12}  3\\times 10^{-12} \\\\\n-2\\times 10^{-12}  5\\times 10^{-12}  -4\\times 10^{-12} \\\\\n3\\times 10^{-12}  -4\\times 10^{-12}  -10^{-12}\n\\end{bmatrix}\\,\\mathrm{s}^{-1},\\quad\n\\boldsymbol{\\omega}_{5}=\\begin{bmatrix}\n10^{-12}\\\\\n-10^{-12}\\\\\n2\\times 10^{-12}\n\\end{bmatrix}\\,\\mathrm{rad/s}.\n$$\n\n验证方法与数值容差：对于每个测试用例，计算 $\\mathbf{D}$、$\\mathbf{W}$、$\\boldsymbol{\\Omega}$、$\\mathbf{D}^{\\ast}$ 和 $\\mathbf{W}^{\\ast}$。令 $e_{D}=\\left\\|\\mathbf{D}^{\\ast}-\\mathbf{D}\\right\\|_{\\mathrm{F}}$ 和 $e_{W}=\\left\\|\\mathbf{W}^{\\ast}-\\left(\\mathbf{W}+\\boldsymbol{\\Omega}\\right)\\right\\|_{\\mathrm{F}}$。如果 $e_{D}\\leq \\varepsilon$ 且 $e_{W}\\leq \\varepsilon$，则测试用例通过，其中绝对容差为 $\\varepsilon=10^{-12}\\,\\mathrm{s}^{-1}$。\n\n最终输出规范：你的程序应生成单行输出，其中包含五个测试用例的通过/失败结果，格式为一个用方括号括起来的、以逗号分隔的布尔值列表，例如 $\\left[\\mathrm{True},\\mathrm{False},\\mathrm{True},\\mathrm{True},\\mathrm{True}\\right]$。当且仅当第 $i$ 个测试用例的两个不变性检查在所述容差下都通过时，第 $i$ 个布尔值必须为 $\\mathrm{True}$。", "solution": "问题陈述被评估为有效。它在连续介质力学中有科学依据，是适定、客观且自洽的。所提供的数据和定义是一致的，并且足以得到唯一解。\n\n任务是验证在叠加刚体旋转下，变形率张量和自旋张量的两个基本性质。这些性质是变形率张量的不变性 $\\mathbf{D}^{\\ast}=\\mathbf{D}$，以及自旋张量的变换法则 $\\mathbf{W}^{\\ast}=\\mathbf{W}+\\boldsymbol{\\Omega}$。我们将首先提供这些性质的解析证明，然后概述数值验证算法。\n\n### 解析验证\n\n分析从问题陈述中提供的定义开始。速度梯度 $\\mathbf{L}$ 可加法分解为一个对称部分，即变形率张量 $\\mathbf{D}$，和一个反对称部分，即自旋张量 $\\mathbf{W}$：\n$$ \\mathbf{L} = \\mathbf{D} + \\mathbf{W} $$\n其中\n$$ \\mathbf{D}=\\frac{1}{2}\\left(\\mathbf{L}+\\mathbf{L}^{\\mathsf{T}}\\right) \\quad \\text{和} \\quad \\mathbf{W}=\\frac{1}{2}\\left(\\mathbf{L}-\\mathbf{L}^{\\mathsf{T}}\\right) $$\n一个角速度向量为 $\\boldsymbol{\\omega}$ 的叠加刚体旋转增加了一个速度分量 $\\boldsymbol{\\omega} \\times \\mathbf{x}$。该速度场的梯度是一个反对称张量 $\\boldsymbol{\\Omega}$。这会将总速度梯度修改为 $\\mathbf{L}^{\\ast}$：\n$$ \\mathbf{L}^{\\ast}=\\mathbf{L}+\\boldsymbol{\\Omega} $$\n修改后的变形率张量 $\\mathbf{D}^{\\ast}$ 和自旋张量 $\\mathbf{W}^{\\ast}$ 是根据 $\\mathbf{L}^{\\ast}$ 定义的，其方式与 $\\mathbf{D}$ 和 $\\mathbf{W}$ 根据 $\\mathbf{L}$ 定义的方式相同。\n\n**1. $\\mathbf{D}^{\\ast}=\\mathbf{D}$ 的验证**\n\n我们从 $\\mathbf{D}^{\\ast}$ 的定义开始：\n$$ \\mathbf{D}^{\\ast} = \\frac{1}{2}\\left(\\mathbf{L}^{\\ast}+\\mathbf{L}^{\\ast\\mathsf{T}}\\right) $$\n代入 $\\mathbf{L}^{\\ast}$ 的表达式：\n$$ \\mathbf{D}^{\\ast} = \\frac{1}{2}\\left((\\mathbf{L}+\\boldsymbol{\\Omega}) + (\\mathbf{L}+\\boldsymbol{\\Omega})^{\\mathsf{T}}\\right) $$\n使用转置操作的线性性质，$(\\mathbf{A}+\\mathbf{B})^{\\mathsf{T}} = \\mathbf{A}^{\\mathsf{T}}+\\mathbf{B}^{\\mathsf{T}}$：\n$$ \\mathbf{D}^{\\ast} = \\frac{1}{2}\\left(\\mathbf{L}+\\boldsymbol{\\Omega} + \\mathbf{L}^{\\mathsf{T}}+\\boldsymbol{\\Omega}^{\\mathsf{T}}\\right) $$\n根据定义，张量 $\\boldsymbol{\\Omega}$ 是反对称的，这意味着 $\\boldsymbol{\\Omega}^{\\mathsf{T}} = -\\boldsymbol{\\Omega}$。代入此性质可得：\n$$ \\mathbf{D}^{\\ast} = \\frac{1}{2}\\left(\\mathbf{L}+\\boldsymbol{\\Omega} + \\mathbf{L}^{\\mathsf{T}}-\\boldsymbol{\\Omega}\\right) $$\n$\\boldsymbol{\\Omega}$ 和 $-\\boldsymbol{\\Omega}$ 项相互抵消：\n$$ \\mathbf{D}^{\\ast} = \\frac{1}{2}\\left(\\mathbf{L}+\\mathbf{L}^{\\mathsf{T}}\\right) $$\n这正是原始变形率张量 $\\mathbf{D}$ 的定义。因此，我们已经解析地证明了：\n$$ \\mathbf{D}^{\\ast}=\\mathbf{D} $$\n这个结果表明，表征材料元拉伸和剪切的变形率是客观的或参考系不变的；它不受叠加的刚体旋转的影响。\n\n**2. $\\mathbf{W}^{\\ast}=\\mathbf{W}+\\boldsymbol{\\Omega}$ 的验证**\n\n接下来，我们研究修改后的自旋张量 $\\mathbf{W}^{\\ast}$，其定义为：\n$$ \\mathbf{W}^{\\ast} = \\frac{1}{2}\\left(\\mathbf{L}^{\\ast}-\\mathbf{L}^{\\ast\\mathsf{T}}\\right) $$\n再次，我们代入 $\\mathbf{L}^{\\ast}=\\mathbf{L}+\\boldsymbol{\\Omega}$：\n$$ \\mathbf{W}^{\\ast} = \\frac{1}{2}\\left((\\mathbf{L}+\\boldsymbol{\\Omega}) - (\\mathbf{L}+\\boldsymbol{\\Omega})^{\\mathsf{T}}\\right) $$\n应用转置性质：\n$$ \\mathbf{W}^{\\ast} = \\frac{1}{2}\\left(\\mathbf{L}+\\boldsymbol{\\Omega} - \\mathbf{L}^{\\mathsf{T}}-\\boldsymbol{\\Omega}^{\\mathsf{T}}\\right) $$\n使用反对称性 $\\boldsymbol{\\Omega}^{\\mathsf{T}} = -\\boldsymbol{\\Omega}$：\n$$ \\mathbf{W}^{\\ast} = \\frac{1}{2}\\left(\\mathbf{L}+\\boldsymbol{\\Omega} - \\mathbf{L}^{\\mathsf{T}}- (-\\boldsymbol{\\Omega})\\right) = \\frac{1}{2}\\left(\\mathbf{L}+\\boldsymbol{\\Omega} - \\mathbf{L}^{\\mathsf{T}}+\\boldsymbol{\\Omega}\\right) $$\n重新排列括号内的项，将 $\\mathbf{W}$ 的分量和 $\\boldsymbol{\\Omega}$ 项组合在一起：\n$$ \\mathbf{W}^{\\ast} = \\frac{1}{2}\\left((\\mathbf{L}-\\mathbf{L}^{\\mathsf{T}}) + 2\\boldsymbol{\\Omega}\\right) $$\n分配标量因子 1/2：\n$$ \\mathbf{W}^{\\ast} = \\frac{1}{2}\\left(\\mathbf{L}-\\mathbf{L}^{\\mathsf{T}}\\right) + \\frac{1}{2}(2\\boldsymbol{\\Omega}) $$\n第一项是原始自旋张量 $\\mathbf{W}$ 的定义。这可以简化为：\n$$ \\mathbf{W}^{\\ast} = \\mathbf{W} + \\boldsymbol{\\Omega} $$\n这证实了自旋张量的变换法则。材料的自旋被叠加的刚性旋转的自旋所增强，这是一个符合预期的物理结果。\n\n### 程序化验证算法\n\n程序将为每个提供的测试用例数值验证这两个恒等式。对于每个测试用例 $(\\mathbf{L}, \\boldsymbol{\\omega})$，算法如下：\n\n1.  **初始化**：给定速度梯度矩阵 $\\mathbf{L}$ 和角速度向量 $\\boldsymbol{\\omega} = [\\omega_1, \\omega_2, \\omega_3]^{\\mathsf{T}}$。\n2.  **构造 $\\boldsymbol{\\Omega}$**：根据 $\\boldsymbol{\\omega}$ 的分量，使用提供的公式构造 $3 \\times 3$ 的反对称矩阵 $\\boldsymbol{\\Omega}$：\n    $$\n    \\boldsymbol{\\Omega}=\\begin{bmatrix}\n    0  -\\omega_{3}  \\omega_{2} \\\\\n    \\omega_{3}  0  -\\omega_{1} \\\\\n    -\\omega_{2}  \\omega_{1}  0\n    \\end{bmatrix}\n    $$\n3.  **计算基础张量**：根据 $\\mathbf{L}$ 计算原始的变形率张量 $\\mathbf{D}$ 和自旋张量 $\\mathbf{W}$：\n    - $\\mathbf{D} = 0.5 \\times (\\mathbf{L} + \\mathbf{L}^{\\mathsf{T}})$\n    - $\\mathbf{W} = 0.5 \\times (\\mathbf{L} - \\mathbf{L}^{\\mathsf{T}})$\n4.  **计算修改后的张量**：\n    - 首先，计算修改后的速度梯度 $\\mathbf{L}^{\\ast} = \\mathbf{L} + \\boldsymbol{\\Omega}$。\n    - 然后，根据 $\\mathbf{L}^{\\ast}$ 计算修改后的张量 $\\mathbf{D}^{\\ast}$ 和 $\\mathbf{W}^{\\ast}$：\n    - $\\mathbf{D}^{\\ast} = 0.5 \\times (\\mathbf{L}^{\\ast} + \\mathbf{L}^{\\ast\\mathsf{T}})$\n    - $\\mathbf{W}^{\\ast} = 0.5 \\times (\\mathbf{L}^{\\ast} - \\mathbf{L}^{\\ast\\mathsf{T}})$\n5.  **计算误差**：使用弗罗贝尼乌斯范数 $\\|\\cdot\\|_{\\mathrm{F}}$ 计算每个恒等式的误差：\n    - $\\mathbf{D}$ 不变性误差：$e_{D} = \\|\\mathbf{D}^{\\ast} - \\mathbf{D}\\|_{\\mathrm{F}}$\n    - $\\mathbf{W}$ 变换误差：$e_{W} = \\|\\mathbf{W}^{\\ast} - (\\mathbf{W} + \\boldsymbol{\\Omega})\\|_{\\mathrm{F}}$\n6.  **验证**：将计算出的误差与指定的容差 $\\varepsilon = 10^{-12}$ 进行比较。当且仅当同时满足以下两个条件时，测试用例通过：\n    - $e_{D} \\leq \\varepsilon$\n    - $e_{W} \\leq \\varepsilon$\n7.  **存储结果**：测试用例的结果是一个布尔值（`True` 表示通过，`False` 表示失败）。对所有测试用例重复此过程。\n8.  **输出**：最终输出是这些布尔结果按指定格式组成的列表。\n\n该算法直接实现了数学定义和验证标准，并利用数值库进行矩阵运算和范数计算。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Verifies the invariance of the rate of deformation tensor (D) and the\n    transformation rule for the spin tensor (W) under a superposed rigid rotation.\n    \"\"\"\n    # Define the absolute tolerance for numerical verification.\n    epsilon = 1e-12\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Test case 1\n        (\n            np.array([[0.5, -1.2, 0.3], [2.1, 0.0, -0.7], [0.4, -0.9, 1.8]]),\n            np.array([0.6, -0.2, 0.4])\n        ),\n        # Test case 2\n        (\n            np.array([[-0.3, 0.7, -0.5], [1.2, 0.4, -1.1], [0.8, -1.1, 0.2]]),\n            np.array([0.0, 0.0, 0.0])\n        ),\n        # Test case 3\n        (\n            np.array([[1.0, 0.2, -0.3], [0.2, 0.5, 0.1], [-0.3, 0.1, 0.8]]),\n            np.array([1.0, 1.0, 1.0])\n        ),\n        # Test case 4\n        (\n            np.array([[0.0, -2.0, 3.0], [2.0, 0.0, -1.0], [-3.0, 1.0, 0.0]]),\n            np.array([-0.5, 2.0, 0.0])\n        ),\n        # Test case 5\n        (\n            np.array([\n                [1e-12, -2e-12, 3e-12],\n                [-2e-12, 5e-12, -4e-12],\n                [3e-12, -4e-12, -1e-12]\n            ]),\n            np.array([1e-12, -1e-12, 2e-12])\n        ),\n    ]\n\n    results = []\n    for L, omega in test_cases:\n        # Construct the skew-symmetric tensor Omega from the angular velocity vector omega.\n        w1, w2, w3 = omega[0], omega[1], omega[2]\n        Omega = np.array([\n            [0, -w3, w2],\n            [w3, 0, -w1],\n            [-w2, w1, 0]\n        ])\n\n        # Calculate the base rate of deformation tensor D and spin tensor W from L.\n        D = 0.5 * (L + L.T)\n        W = 0.5 * (L - L.T)\n\n        # Calculate the modified velocity gradient L_star.\n        L_star = L + Omega\n\n        # Calculate the modified rate of deformation D_star and spin W_star from L_star.\n        D_star = 0.5 * (L_star + L_star.T)\n        W_star = 0.5 * (L_star - L_star.T)\n\n        # Calculate the verification errors using the Frobenius norm.\n        # e_D should be numerically close to zero, as D_star = D analytically.\n        e_D = np.linalg.norm(D_star - D, 'fro')\n        \n        # e_W should be numerically close to zero, as W_star = W + Omega analytically.\n        e_W = np.linalg.norm(W_star - (W + Omega), 'fro')\n\n        # A test case passes if both errors are within the tolerance.\n        passes = (e_D = epsilon) and (e_W = epsilon)\n        results.append(passes)\n\n    # Format the final output as a comma-separated list of booleans.\n    # Python's str(bool) produces 'True'/'False' with capitalization, as required.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3609175"}, {"introduction": "为了将连续介质力学理论应用于工程计算，我们必须将其离散化。在有限元等数值方法中，连续的速度场是通过节点值和形函数来近似的。这个练习 [@problem_id:3609150] 将带你走过从连续到离散的关键一步，推导一个标准单元的速度梯度算子，并用它来计算 $L$、$D$ 和 $W$，从而揭示这些连续介质张量在计算环境中的具体实现方式。", "problem": "考虑一个三维、等参、三线性 (Q1) 八节点六面体有限元，其母（参考）坐标为 $\\left(\\xi,\\eta,\\zeta\\right)\\in[-1,1]^3$。该物理单元是一个中心位于 $\\left(x_c,y_c,z_c\\right)$ 的正交长方体，其边长 $L_x$、$L_y$ 和 $L_z$ 与笛卡尔坐标轴对齐。等参映射由 $x = x_c + \\frac{L_x}{2}\\,\\xi$，$y = y_c + \\frac{L_y}{2}\\,\\eta$ 和 $z = z_c + \\frac{L_z}{2}\\,\\zeta$ 给出，节点 $a$ 处的三线性形函数为 $N_a(\\xi,\\eta,\\zeta) = \\frac{1}{8}\\left(1+\\xi\\,\\xi_a\\right)\\left(1+\\eta\\,\\eta_a\\right)\\left(1+\\zeta\\,\\zeta_a\\right)$，其中 $\\left(\\xi_a,\\eta_a,\\zeta_a\\right)\\in\\{-1,1\\}^3$ 表示节点的母空间符号。\n\n单元内的空间速度场通过插值得到：$\\mathbf{v}(\\mathbf{x})=\\sum_{a=1}^{8} N_a(\\mathbf{x})\\,\\mathbf{v}_a$，其中 $\\mathbf{v}_a$ 是节点速度。速度梯度张量定义为 $L_{ij} = v_{i,j}$，其中 $v_{i,j}=\\frac{\\partial v_i}{\\partial x_j}$。变形率张量定义为 $D = \\frac{1}{2}\\left(L + L^{\\mathsf{T}}\\right)$，自旋张量定义为 $W = \\frac{1}{2}\\left(L - L^{\\mathsf{T}}\\right)$。\n\n任务：\n1) 仅从上述定义出发，利用等参映射的链式法则，推导在单元中心 $\\left(\\xi,\\eta,\\zeta\\right)=(0,0,0)$ 处将堆叠的节点速度向量映射到速度梯度张量 $L$ 的离散梯度算子。用在单元中心求值的梯度 $\\nabla N_a$ 表示你的结果，并提供在中心处物理坐标系下 $\\nabla N_a$ 关于 $L_x$、$L_y$、$L_z$ 和节点符号 $\\left(\\xi_a,\\eta_a,\\zeta_a\\right)$ 的显式表达式。\n\n2) 单元承受均匀的纯剪切，剪切率为常数 $\\kappa$，使得其对应的连续介质速度场为 $\\mathbf{v}(\\mathbf{x})=\\left[\\kappa\\,y,\\,0,\\,0\\right]^{\\mathsf{T}}$。将此场精确地施加于节点上，即 $\\mathbf{v}_a=\\left[\\kappa\\,y_a,\\,0,\\,0\\right]^{\\mathsf{T}}$，其中 $y_a = y_c + \\frac{L_y}{2}\\,\\eta_a$。使用你的离散梯度算子，计算单元中心处的速度梯度张量 $L$、变形率张量 $D$ 和自旋张量 $W$。\n\n答案规格：\n- 以单行矩阵的形式提供最终答案，该矩阵按行优先顺序串联 $L$、$D$ 和 $W$ 的分量，即 $\\left[L_{11},L_{12},\\dots,L_{33},D_{11},\\dots,D_{33},W_{11},\\dots,W_{33}\\right]$。\n- 用 $\\kappa$ 的符号形式表示各分量。\n- 每个分量的单位是 $\\mathrm{s}^{-1}$；不要在最终的方框答案中包含单位。\n- 无需四舍五入。", "solution": "问题陈述已经过验证，并被确定为计算固体力学领域中一个有效、自洽且适定的问题。\n\n目标是在特定速度场下，计算三线性六面体单元中心的速度梯度张量 $L$、变形率张量 $D$ 和自旋张量 $W$。\n\n### 第 1 部分：离散梯度算子的推导\n\n速度场 $\\mathbf{v}$ 是使用形函数 $N_a$ 从节点速度 $\\mathbf{v}_a$ 插值得到的：\n$$ \\mathbf{v}(\\mathbf{x}) = \\sum_{a=1}^{8} N_a(\\mathbf{x})\\,\\mathbf{v}_a $$\n速度梯度张量定义为 $L_{ij} = \\frac{\\partial v_i}{\\partial x_j}$。形函数 $N_a$ 是用母坐标 $\\boldsymbol{\\xi} = (\\xi, \\eta, \\zeta)$ 表示的，而梯度是相对于物理坐标 $\\mathbf{x} = (x, y, z)$ 的。因此，必须应用链式法则。物理坐标系下任意函数 $f$ 的梯度通过以下关系与其在母坐标系下的梯度相关联：\n$$ \\nabla_{\\mathbf{x}} f = \\mathbf{J}^{-\\mathsf{T}} \\nabla_{\\boldsymbol{\\xi}} f $$\n其中 $\\mathbf{J}$ 是等参映射 $\\mathbf{x}(\\boldsymbol{\\xi})$ 的雅可比矩阵。$\\mathbf{J}$ 的分量为 $J_{ij} = \\frac{\\partial x_i}{\\partial \\xi_j}$。\n\n给定的映射为：\n$x = x_c + \\frac{L_x}{2}\\,\\xi$\n$y = y_c + \\frac{L_y}{2}\\,\\eta$\n$z = z_c + \\frac{L_z}{2}\\,\\zeta$\n\n雅可比矩阵 $\\mathbf{J}$ 计算如下：\n$$\n\\mathbf{J} = \\begin{pmatrix}\n\\frac{\\partial x}{\\partial \\xi}  \\frac{\\partial x}{\\partial \\eta}  \\frac{\\partial x}{\\partial \\zeta} \\\\\n\\frac{\\partial y}{\\partial \\xi}  \\frac{\\partial y}{\\partial \\eta}  \\frac{\\partial y}{\\partial \\zeta} \\\\\n\\frac{\\partial z}{\\partial \\xi}  \\frac{\\partial z}{\\partial \\eta}  \\frac{\\partial z}{\\partial \\zeta}\n\\end{pmatrix}\n= \\begin{pmatrix}\n\\frac{L_x}{2}  0  0 \\\\\n0  \\frac{L_y}{2}  0 \\\\\n0  0  \\frac{L_z}{2}\n\\end{pmatrix}\n$$\n该雅可比矩阵在整个单元内是常数。其逆矩阵为：\n$$\n\\mathbf{J}^{-1} = \\begin{pmatrix}\n\\frac{2}{L_x}  0  0 \\\\\n0  \\frac{2}{L_y}  0 \\\\\n0  0  \\frac{2}{L_z}\n\\end{pmatrix}\n$$\n由于 $\\mathbf{J}$ 是对角矩阵，其转置等于其自身，因此 $\\mathbf{J}^{-\\mathsf{T}} = \\mathbf{J}^{-1}$。\n\n第 $i$ 个速度分量 $v_i = \\sum_{a=1}^{8} N_a v_{ia}$ 的梯度为：\n$$ \\nabla_{\\mathbf{x}} v_i = \\sum_{a=1}^{8} (\\nabla_{\\mathbf{x}} N_a) v_{ia} $$\n其中 $v_{ia}$ 是节点速度向量 $\\mathbf{v}_a$ 的第 $i$ 个分量。物理坐标系下形函数的梯度为 $\\nabla_{\\mathbf{x}} N_a = \\mathbf{J}^{-\\mathsf{T}} \\nabla_{\\boldsymbol{\\xi}} N_a$。\n速度梯度张量的分量则由下式给出：\n$$ L_{ij} = \\frac{\\partial v_i}{\\partial x_j} = \\left( \\nabla_{\\mathbf{x}} v_i \\right)_j = \\sum_{a=1}^{8} \\left( \\nabla_{\\mathbf{x}} N_a \\right)_j v_{ia} = \\sum_{a=1}^{8} \\frac{\\partial N_a}{\\partial x_j} v_{ia} $$\n这就是离散梯度算子。\n\n为了找到在单元中心 $(\\xi, \\eta, \\zeta) = (0,0,0)$ 处 $\\nabla_{\\mathbf{x}} N_a$ 的显式表达式，我们首先计算 $N_a$ 在母坐标系下的梯度：\n$$ N_a(\\xi,\\eta,\\zeta) = \\frac{1}{8}\\left(1+\\xi\\,\\xi_a\\right)\\left(1+\\eta\\,\\eta_a\\right)\\left(1+\\zeta\\,\\zeta_a\\right) $$\n偏导数为：\n$$ \\frac{\\partial N_a}{\\partial \\xi} = \\frac{1}{8}\\xi_a\\left(1+\\eta\\,\\eta_a\\right)\\left(1+\\zeta\\,\\zeta_a\\right) $$\n$$ \\frac{\\partial N_a}{\\partial \\eta} = \\frac{1}{8}\\eta_a\\left(1+\\xi\\,\\xi_a\\right)\\left(1+\\zeta\\,\\zeta_a\\right) $$\n$$ \\frac{\\partial N_a}{\\partial \\zeta} = \\frac{1}{8}\\zeta_a\\left(1+\\xi\\,\\xi_a\\right)\\left(1+\\eta\\,\\eta_a\\right) $$\n在中心 $(\\xi, \\eta, \\zeta) = (0,0,0)$ 处求值：\n$$ \\left.\\frac{\\partial N_a}{\\partial \\xi}\\right|_{(0,0,0)} = \\frac{\\xi_a}{8}, \\quad \\left.\\frac{\\partial N_a}{\\partial \\eta}\\right|_{(0,0,0)} = \\frac{\\eta_a}{8}, \\quad \\left.\\frac{\\partial N_a}{\\partial \\zeta}\\right|_{(0,0,0)} = \\frac{\\zeta_a}{8} $$\n所以，$\\left.\\nabla_{\\boldsymbol{\\xi}} N_a\\right|_{(0,0,0)} = \\frac{1}{8} \\begin{pmatrix} \\xi_a  \\eta_a  \\zeta_a \\end{pmatrix}^{\\mathsf{T}}$。\n现在，我们将其转换到物理坐标系：\n$$ \\left.\\nabla_{\\mathbf{x}} N_a\\right|_{(0,0,0)} = \\mathbf{J}^{-1} \\left.\\nabla_{\\boldsymbol{\\xi}} N_a\\right|_{(0,0,0)} = \\begin{pmatrix} \\frac{2}{L_x}  0  0 \\\\ 0  \\frac{2}{L_y}  0 \\\\ 0  0  \\frac{2}{L_z} \\end{pmatrix} \\frac{1}{8} \\begin{pmatrix} \\xi_a \\\\ \\eta_a \\\\ \\zeta_a \\end{pmatrix} = \\frac{1}{4} \\begin{pmatrix} \\xi_a/L_x \\\\ \\eta_a/L_y \\\\ \\zeta_a/L_z \\end{pmatrix} $$\n这就完成了第一个任务。\n\n### 第 2 部分：纯剪切的计算\n\n节点速度由 $\\mathbf{v}_a = [\\kappa\\,y_a, 0, 0]^{\\mathsf{T}}$ 给出，其中 $y_a = y_c + \\frac{L_y}{2}\\eta_a$。因此，对于所有节点 $a=1, \\dots, 8$，有 $v_{1a} = \\kappa y_a$，且 $v_{2a} = v_{3a} = 0$。\n\n单元中心处速度梯度张量 $L$ 的分量是使用上面推导的公式计算的。\n由于 $v_{2a} = v_{3a} = 0$，$L$ 的最后两行为零：\n$$ L_{2j} = \\sum_{a=1}^{8} \\frac{\\partial N_a}{\\partial x_j} v_{2a} = 0, \\quad L_{3j} = \\sum_{a=1}^{8} \\frac{\\partial N_a}{\\partial x_j} v_{3a} = 0 \\quad \\text{for } j=1,2,3. $$\n我们只需要计算第一行 $L_{1j}$ 的分量：\n$$ L_{1j} = \\sum_{a=1}^{8} \\left.\\frac{\\partial N_a}{\\partial x_j}\\right|_{(0,0,0)} v_{1a} = \\sum_{a=1}^{8} \\left.\\frac{\\partial N_a}{\\partial x_j}\\right|_{(0,0,0)} (\\kappa y_a) $$\n\n对于 $j=1$ ($x$-分量)：\n$$ L_{11} = \\sum_{a=1}^{8} \\left(\\frac{1}{4}\\frac{\\xi_a}{L_x}\\right) (\\kappa y_a) = \\frac{\\kappa}{4L_x} \\sum_{a=1}^{8} \\xi_a \\left(y_c + \\frac{L_y}{2}\\eta_a\\right) = \\frac{\\kappa}{4L_x} \\left(y_c \\sum_{a=1}^{8}\\xi_a + \\frac{L_y}{2} \\sum_{a=1}^{8}\\xi_a\\eta_a\\right) $$\n求和是针对母立方体角点对应的 8 个节点进行的，其中 $(\\xi_a, \\eta_a, \\zeta_a) \\in \\{-1,1\\}^3$。由于对称性，$\\sum_{a=1}^{8}\\xi_a = 0$ 且 $\\sum_{a=1}^{8}\\xi_a\\eta_a = 0$。因此，$L_{11} = 0$。\n\n对于 $j=2$ ($y$-分量)：\n$$ L_{12} = \\sum_{a=1}^{8} \\left(\\frac{1}{4}\\frac{\\eta_a}{L_y}\\right) (\\kappa y_a) = \\frac{\\kappa}{4L_y} \\sum_{a=1}^{8} \\eta_a \\left(y_c + \\frac{L_y}{2}\\eta_a\\right) = \\frac{\\kappa}{4L_y} \\left(y_c \\sum_{a=1}^{8}\\eta_a + \\frac{L_y}{2} \\sum_{a=1}^{8}\\eta_a^2\\right) $$\n同样，$\\sum_{a=1}^{8}\\eta_a = 0$。对于 $\\eta_a \\in \\{-1,1\\}$，我们有 $\\eta_a^2=1$。因此，$\\sum_{a=1}^{8}\\eta_a^2 = 8$。\n$$ L_{12} = \\frac{\\kappa}{4L_y} \\left(0 + \\frac{L_y}{2} \\cdot 8\\right) = \\frac{\\kappa}{4L_y} (4L_y) = \\kappa $$\n\n对于 $j=3$ ($z$-分量)：\n$$ L_{13} = \\sum_{a=1}^{8} \\left(\\frac{1}{4}\\frac{\\zeta_a}{L_z}\\right) (\\kappa y_a) = \\frac{\\kappa}{4L_z} \\sum_{a=1}^{8} \\zeta_a \\left(y_c + \\frac{L_y}{2}\\eta_a\\right) = \\frac{\\kappa}{4L_z} \\left(y_c \\sum_{a=1}^{8}\\zeta_a + \\frac{L_y}{2} \\sum_{a=1}^{8}\\zeta_a\\eta_a\\right) $$\n根据对称性，$\\sum_{a=1}^{8}\\zeta_a = 0$ 且 $\\sum_{a=1}^{8}\\zeta_a\\eta_a = 0$。因此，$L_{13} = 0$。\n\n在中心处得到的速度梯度张量为：\n$$ L = \\begin{pmatrix} 0  \\kappa  0 \\\\ 0  0  0 \\\\ 0  0  0 \\end{pmatrix} $$\n该结果与连续介质场 $\\mathbf{v}(\\mathbf{x}) = [\\kappa y, 0, 0]^{\\mathsf{T}}$ 的解析梯度相匹配。\n\n现在，我们计算变形率张量 $D$ 和自旋张量 $W$。\n$$ D = \\frac{1}{2}\\left(L + L^{\\mathsf{T}}\\right) = \\frac{1}{2}\\left( \\begin{pmatrix} 0  \\kappa  0 \\\\ 0  0  0 \\\\ 0  0  0 \\end{pmatrix} + \\begin{pmatrix} 0  0  0 \\\\ \\kappa  0  0 \\\\ 0  0  0 \\end{pmatrix} \\right) = \\begin{pmatrix} 0  \\frac{\\kappa}{2}  0 \\\\ \\frac{\\kappa}{2}  0  0 \\\\ 0  0  0 \\end{pmatrix} $$\n$$ W = \\frac{1}{2}\\left(L - L^{\\mathsf{T}}\\right) = \\frac{1}{2}\\left( \\begin{pmatrix} 0  \\kappa  0 \\\\ 0  0  0 \\\\ 0  0  0 \\end{pmatrix} - \\begin{pmatrix} 0  0  0 \\\\ \\kappa  0  0 \\\\ 0  0  0 \\end{pmatrix} \\right) = \\begin{pmatrix} 0  \\frac{\\kappa}{2}  0 \\\\ -\\frac{\\kappa}{2}  0  0 \\\\ 0  0  0 \\end{pmatrix} $$\n\n最终答案是按行优先顺序串联 $L$、$D$ 和 $W$ 的分量。\n$L$ 的分量：$[0, \\kappa, 0, 0, 0, 0, 0, 0, 0]$\n$D$ 的分量：$[0, \\frac{\\kappa}{2}, 0, \\frac{\\kappa}{2}, 0, 0, 0, 0, 0]$\n$W$ 的分量：$[0, \\frac{\\kappa}{2}, 0, -\\frac{\\kappa}{2}, 0, 0, 0, 0, 0]$\n将这些组合起来得到最终的向量。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0  \\kappa  0  0  0  0  0  0  0  0  \\frac{\\kappa}{2}  0  \\frac{\\kappa}{2}  0  0  0  0  0  0  \\frac{\\kappa}{2}  0  -\\frac{\\kappa}{2}  0  0  0  0  0\n\\end{pmatrix}\n}\n$$", "id": "3609150"}, {"introduction": "让我们将所学概念应用于固体力学中的一个常见挑战：不可压缩材料的模拟。材料的不可压缩性在运动学上直接体现为变形率张量的迹为零，即 $\\text{tr}(D)=0$。这个练习 [@problem_id:3609164] 将探讨这一条件的运动学后果、在数值积分过程中可能出现的体积漂移等问题，并指导你实现一种基于投影的方法来在计算中强制施加该约束。", "problem": "在连续介质力学中，给定变形梯度的运动学演化。速度梯度张量定义为 $L = \\nabla v$，它通过定义 $D = \\tfrac{1}{2}\\left(L + L^{T}\\right)$ 和 $W = \\tfrac{1}{2}\\left(L - L^{T}\\right)$ 分解为对称的变形率张量 $D$ 和反对称的自旋张量 $W$。变形梯度 $F$ 遵循基本运动学关系 $\\dot{F} = L\\,F$ 演化，初始条件为 $F(0)=I$，其中 $I$ 是单位张量。令 $J = \\det F$。对于不可压缩运动，$J$ 必须在所有时间内保持等于 $1$。\n\n你的任务是：\n- 从基本运动学关系和基础矩阵微积分出发，推导 $J$ 的演化方程，并确定 $J$ 随时间保持恒定所需要满足的关于 $D$ 的条件。\n- 解释为什么即使满足了 $J$ 恒定的理论条件，数值舍入和时间积分误差仍会导致 $J$ 的值偏离 $1$。\n- 提出并论证一种通过对 $F$ 进行各向同性校正，在每个时间步强制 $J=1$ 的投影方法。该投影必须完全用 $F$ 及其行列式表示，并且应独立于 $L$ 的具体形式。\n\n然后，实现一个程序，该程序：\n- 对由给定的 $D$ 和 $W$ 定义的、随时间恒定的 $L$，积分 $\\dot{F} = L\\,F$。\n- 比较三种离散更新策略：\n    1. 不带投影的前向欧拉法：$F_{n+1} = F_n + \\Delta t\\, L F_n$。\n    2. 带每步体积投影的前向欧拉法：计算 $\\widehat{F}_{n+1} = F_n + \\Delta t\\, L F_n$，然后设置 $F_{n+1} = \\alpha\\,\\widehat{F}_{n+1}$，其中 $\\alpha$ 的选择要使 $\\det(F_{n+1}) = 1$。\n    3. 使用矩阵指数在总时间 $T$ 上求解恒定 $L$ 的精确解：$F(T) = \\exp(L\\,T)$。\n- 同时，使用相同的时间步长 $\\Delta t$ 和初始值 $J(0)=1$，通过前向欧拉法对你在推导中得到的 $J$ 的标量常微分方程进行积分，以观察标量演化中的舍入效应。\n\n使用以下随时间恒定的测试套件。在每种情况下，定义 $D = \\mathrm{diag}(a,-a,0)$，$W$ 为绕 $z$ 轴的平面自旋，角速度为 $\\omega$，由下式给出\n$$\nW = \\begin{bmatrix}\n0  -\\omega  0 \\\\\n\\omega  0  0 \\\\\n0  0  0\n\\end{bmatrix},\n$$\n并设置 $L = D + W$。使用单位矩阵 $I$ 作为初始条件 $F(0)$。\n\n测试套件（所有量均为无量纲，因此不需要物理单位）：\n- 情况 A（边界情况，零自旋）：$a = 0.2$, $\\omega = 0.0$, $\\Delta t = 10^{-3}$, $T = 10^{-1}$。\n- 情况 B（理想情况，中等自旋）：$a = 0.2$, $\\omega = 50.0$, $\\Delta t = 10^{-4}$, $T = 5\\times 10^{-2}$。\n- 情况 C（边缘情况，大自旋）：$a = 0.2$, $\\omega = 2000.0$, $\\Delta t = 10^{-6}$, $T = 2\\times 10^{-3}$。\n\n对于每种情况，计算并报告以下四个标量：\n- $e_{\\mathrm{unproj}}^{\\mathrm{final}} = \\left|\\det\\!\\left(F_{\\mathrm{Euler\\;unproj}}(T)\\right) - 1\\right|$。\n- $e_{\\mathrm{unproj}}^{\\mathrm{max}} = \\max_{0 \\le n \\le N} \\left|\\det\\!\\left(F_{\\mathrm{Euler\\;unproj}}(t_n)\\right) - 1\\right|$，其中 $t_n = n\\,\\Delta t$ 且 $N = \\lfloor T/\\Delta t \\rfloor$。\n- $e_{\\mathrm{proj}}^{\\mathrm{final}} = \\left|\\det\\!\\left(F_{\\mathrm{Euler\\;proj}}(T)\\right) - 1\\right|$。\n- $e_{\\mathrm{expm}}^{\\mathrm{final}} = \\left|\\det\\!\\left(F_{\\mathrm{expm}}(T)\\right) - 1\\right|$。\n\n你的程序必须实现这三种积分策略，包括你提出的体积投影方法，并且必须按照指定的顺序（情况 A，然后情况 B，然后情况 C）为这三种情况中的每一种计算上述四个标量结果。最终输出必须是单行，其中包含这些结果，格式为方括号内用逗号分隔的浮点数列表，顺序如下\n$$\n\\big[e_{\\mathrm{unproj}}^{\\mathrm{final}}(\\mathrm{A}),\\ e_{\\mathrm{unproj}}^{\\mathrm{max}}(\\mathrm{A}),\\ e_{\\mathrm{proj}}^{\\mathrm{final}}(\\mathrm{A}),\\ e_{\\mathrm{expm}}^{\\mathrm{final}}(\\mathrm{A}),\\ e_{\\mathrm{unproj}}^{\\mathrm{final}}(\\mathrm{B}),\\ e_{\\mathrm{unproj}}^{\\mathrm{max}}(\\mathrm{B}),\\ e_{\\mathrm{proj}}^{\\mathrm{final}}(\\mathrm{B}),\\ e_{\\mathrm{expm}}^{\\mathrm{final}}(\\mathrm{B}),\\ e_{\\mathrm{unproj}}^{\\mathrm{final}}(\\mathrm{C}),\\ e_{\\mathrm{unproj}}^{\\mathrm{max}}(\\mathrm{C}),\\ e_{\\mathrm{proj}}^{\\mathrm{final}}(\\mathrm{C}),\\ e_{\\mathrm{expm}}^{\\mathrm{final}}(\\mathrm{C})\\big].\n$$\n\n所有计算都是无量纲的。不直接报告角度。不使用百分比。程序必须是自包含的，不得需要任何外部输入或文件。答案是实数（浮点值）。", "solution": "该问题定义明确，并在连续介质力学和数值分析方面具有坚实的科学基础。我们继续进行求解，求解过程包括三个部分：理论推导、数值误差的解释、以及投影方法的提出，最后是实现。\n\n首先，我们推导变形梯度行列式 $J = \\det F$ 的演化方程。一个随时间变化的矩阵 $F(t)$ 的行列式的时间导数由 Jacobi 公式给出：\n$$\n\\dot{J} = \\frac{d}{dt}(\\det F) = (\\det F) \\mathrm{tr}( \\dot{F} F^{-1} ) = J \\, \\mathrm{tr}( \\dot{F} F^{-1} )\n$$\n问题陈述了基本运动学关系 $\\dot{F} = L F$，其中 $L$ 是速度梯度。将此代入 Jacobi 公式可得：\n$$\n\\dot{J} = J \\, \\mathrm{tr}( (L F) F^{-1} ) = J \\, \\mathrm{tr}(L (F F^{-1})) = J \\, \\mathrm{tr}(L)\n$$\n速度梯度 $L$ 可以分解为其对称部分（变形率张量 $D$）和其反对称部分（自旋张量 $W$），即 $L = D + W$。迹是一个线性算子，所以 $\\mathrm{tr}(L) = \\mathrm{tr}(D + W) = \\mathrm{tr}(D) + \\mathrm{tr}(W)$。任何反对称矩阵的迹都为零，因为其对角线元素必然为零。因此，$\\mathrm{tr}(W) = 0$。这将 $J$ 的演化方程简化为：\n$$\n\\dot{J} = J \\, \\mathrm{tr}(D)\n$$\n为了使 $J$ 随时间保持恒定，其时间导数 $\\dot{J}$ 必须为零。给定初始条件 $F(0) = I$，我们有 $J(0) = \\det(I) = 1$。由于该常微分方程的解为 $J(t) = J(0) \\exp(\\int_0^t \\mathrm{tr}(D(\\tau)) d\\tau)$，$J$ 将始终为正。因此，条件 $\\dot{J} = 0$ 等价于要求 $\\mathrm{tr}(D) = 0$。这个条件意味着体积应变率为零，这是等容（体积保持）或不可压缩运动的定义。在所提供的测试案例的背景下，$D = \\mathrm{diag}(a, -a, 0)$，所以 $\\mathrm{tr}(D) = a - a + 0 = 0$。因此，该运动在理论上是不可压缩的，$J$ 应在所有时间内保持等于 $1$。\n\n其次，我们解释为什么数值计算会导致 $J$ 的值从 $1$ 发生漂移。有两个主要的误差来源：时间积分（截断）误差和浮点舍入误差。\n前向欧拉法将变形梯度更新为 $F_{n+1} = F_n + \\Delta t L F_n = (I + \\Delta t L) F_n$。对这个更新规则应用行列式运算，得到 $J_{n+1} = \\det(F_{n+1}) = \\det(I + \\Delta t L) J_n$。在一个时间步长 $\\Delta t$ 内的精确演化应为 $F(t_n + \\Delta t) = \\exp(\\Delta t L) F(t_n)$，其行列式为 $J(t_n + \\Delta t) = \\det(\\exp(\\Delta t L)) J(t_n) = \\exp(\\mathrm{tr}(\\Delta t L)) J(t_n)$。由于 $\\mathrm{tr}(L) = 0$，精确演化给出 $J(t_n + \\Delta t) = \\exp(0) J(t_n) = J(t_n)$，完美地保持了体积。然而，前向欧拉传播算子 $I + \\Delta t L$ 只是 $\\exp(\\Delta t L)$ 的一阶近似。该传播算子的行列式为 $\\det(I + \\Delta t L) \\approx 1 + \\Delta t \\mathrm{tr}(L) + \\mathcal{O}(\\Delta t^2)$。当 $\\mathrm{tr}(L)=0$ 时，这变为 $\\det(I + \\Delta t L) = 1 + \\mathcal{O}(\\Delta t^2)$。行列式在每一步中并没有被精确保持。这就是积分方案的**截断误差**。它导致 $J$ 在多个时间步上产生系统性漂移，误差随步数近似线性累积。\n**舍入误差**是另一个问题，源于计算机上浮点数的有限精度。每次算术运算都可能引入微小的误差。这对所有三种方法都有影响。对于前向欧拉法，这种误差通常次要于较大的截断误差。对于“精确”解 $F(T) = \\exp(LT)$，该解是使用像 Padé 近似这样的数值算法计算的，舍入误差是其唯一的偏差来源。因此，$\\det(\\exp(LT))$ 将非常接近 $1$ 但不完全等于 $1$，其差值与机器精度有关。简单的标量积分 $J_{n+1} = J_n + \\Delta t \\cdot 0 \\cdot J_n = J_n$ 且 $J_0=1$ 在理想情况下会永远保持 $J=1$。在这种平凡更新的数值实现中观察到的任何偏差都纯粹是由舍入误差引起的。\n\n第三，我们提出一个在每一步强制 $J=1$ 的投影方法。在一个时间步之后，我们计算一个暂定的变形梯度，称之为 $\\widehat{F}_{n+1}$，其行列式 $\\widehat{J}_{n+1} = \\det(\\widehat{F}_{n+1})$ 可能不为 $1$。我们寻求一个校正后的变形梯度 $F_{n+1}$，它“接近”$\\widehat{F}_{n+1}$ 并且满足 $\\det(F_{n+1})=1$。问题建议采用各向同性校正，可以表示为均匀缩放：\n$$\nF_{n+1} = \\alpha \\widehat{F}_{n+1}\n$$\n其中 $\\alpha$ 是一个标量校正因子。我们通过强制施加不可压缩性约束来找到 $\\alpha$。对等式两边取行列式，对于一个在 $d=3$ 维空间中的问题：\n$$\n\\det(F_{n+1}) = \\det(\\alpha \\widehat{F}_{n+1}) = \\alpha^3 \\det(\\widehat{F}_{n+1}) = \\alpha^3 \\widehat{J}_{n+1}\n$$\n令 $\\det(F_{n+1})=1$，我们得到 $1 = \\alpha^3 \\widehat{J}_{n+1}$。求解 $\\alpha$ 可得：\n$$\n\\alpha = \\left( \\frac{1}{\\widehat{J}_{n+1}} \\right)^{1/3} = \\widehat{J}_{n+1}^{-1/3}\n$$\n因此，投影更新为：\n$$\nF_{n+1} = (\\det \\widehat{F}_{n+1})^{-1/3} \\widehat{F}_{n+1}\n$$\n这个投影完全用计算出的状态 $\\widehat{F}_{n+1}$ 及其行列式表示。它对应于应用一个均匀的体积校正来恢复单位体积，这是计算力学中用于通过显式时间积分方案强制实现不可压缩性的一种常用且有效技术。最终误差 $e_{\\mathrm{proj}}^{\\mathrm{final}}$ 将仅由于最后一次投影后计算 $\\det(F_{n+1})$ 时的舍入误差而为非零。", "answer": "```python\nimport numpy as np\nfrom scipy.linalg import expm\n\ndef solve():\n    \"\"\"\n    Main function to run the simulations and compute the required error metrics.\n    \"\"\"\n    test_cases = [\n        # Case A (boundary, zero spin)\n        {'a': 0.2, 'omega': 0.0, 'dt': 1e-3, 'T': 1e-1},\n        # Case B (happy path, moderate spin)\n        {'a': 0.2, 'omega': 50.0, 'dt': 1e-4, 'T': 5e-2},\n        # Case C (edge, large spin)\n        {'a': 0.2, 'omega': 2000.0, 'dt': 1e-6, 'T': 2e-3},\n    ]\n\n    all_results = []\n\n    for case in test_cases:\n        a = case['a']\n        omega = case['omega']\n        dt = case['dt']\n        T = case['T']\n\n        # Ensure N is an integer, safe for floating point inaccuracies in T/dt\n        N = int(round(T / dt))\n\n        # Define D, W, and L tensors\n        D = np.array([\n            [a, 0, 0],\n            [0, -a, 0],\n            [0, 0, 0]\n        ])\n        W = np.array([\n            [0, -omega, 0],\n            [omega, 0, 0],\n            [0, 0, 0]\n        ])\n        L = D + W\n\n        # --- Method 1: Forward Euler without projection ---\n        F_unproj = np.eye(3)\n        # Pre-compute the update matrix for efficiency\n        Id_plus_dt_L = np.eye(3) + dt * L\n        \n        dets_unproj = []\n        for _ in range(N):\n            F_unproj = Id_plus_dt_L @ F_unproj\n            det_F = np.linalg.det(F_unproj)\n            dets_unproj.append(abs(det_F - 1.0))\n        \n        e_unproj_final = dets_unproj[-1] if dets_unproj else 0.0\n        e_unproj_max = max(dets_unproj) if dets_unproj else 0.0\n\n        # --- Method 2: Forward Euler with per-step volumetric projection ---\n        F_proj = np.eye(3)\n        # Re-using the same update matrix\n        for _ in range(N):\n            F_hat = Id_plus_dt_L @ F_proj\n            J_hat = np.linalg.det(F_hat)\n            \n            # Avoid division by zero or complex numbers if J_hat is negative\n            if J_hat = 0:\n                # This case is not expected in this problem but is good practice\n                # In a real simulation, this might indicate an instability\n                alpha = 1.0 \n            else:\n                alpha = J_hat**(-1.0/3.0)\n                \n            F_proj = alpha * F_hat\n            \n        det_F_proj_final = np.linalg.det(F_proj)\n        e_proj_final = abs(det_F_proj_final - 1.0)\n        \n        # --- Method 3: Exact constant-L solution using matrix exponential ---\n        F_expm = expm(L * T)\n        det_F_expm = np.linalg.det(F_expm)\n        e_expm_final = abs(det_F_expm - 1.0)\n\n        all_results.extend([e_unproj_final, e_unproj_max, e_proj_final, e_expm_final])\n\n    print(f\"[{','.join(map(str, all_results))}]\")\n\nif __name__ == \"__main__\":\n    solve()\n\n```", "id": "3609164"}]}