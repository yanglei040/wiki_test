{"hands_on_practices": [{"introduction": "对于边界光滑且载荷良好的问题，强形式和弱形式通常是等价的。然而，在工程实践中，当区域的几何形状包含重入角等奇点时，解的正则性可能会降低，导致传统的强形式解（例如，要求解在$H^{2}(\\Omega)$空间内）可能不存在。本练习[@problem_id:3604122]将引导你通过一个经典的L形区域问题，亲手分析这种奇性行为，从而深刻理解为何需要弱形式，因为它对解的光滑性要求更低，能够确保在更广泛的工程问题中获得适定的解。", "problem": "考虑二维小应变线性弹性理论中的反平面剪切模型。设 $\\Omega \\subset \\mathbb{R}^{2}$ 为 L 形域 $\\Omega = (-1,1)^{2} \\setminus \\left([0,1] \\times [-1,0]\\right)$，其在原点处有一个内角为 $\\omega = \\frac{3\\pi}{2}$ 的凹角。平面外位移 $u:\\Omega \\to \\mathbb{R}$ 满足静态线性动量平衡方程 $-\\nabla \\cdot \\boldsymbol{\\sigma} = b$ 和本构关系 $\\boldsymbol{\\sigma} = \\mu \\nabla u$，其中 $\\mu > 0$ 是剪切模量，$b$ 是一个常体力密度。假设 $\\mu = 1$ 且 $b \\equiv 1$。本质（狄利克雷）边界 $\\Gamma_{D} = \\partial \\Omega$ 指定 $u = 0$。\n\n1.  从线性动量平衡和本构关系出发，构建在 $\\Omega$ 上的强形式边值问题以及在 Sobolev 空间 $H^{1}_{0}(\\Omega)$ 上的弱（变分）形式，并精确定义所有符号。明确说明试探函数和检验函数的函数空间。\n2.  通过引用 Lax–Milgram 定理（陈述有界性和矫顽性条件），证明该弱形式在 $H^{1}_{0}(\\Omega)$ 中存在唯一解。\n3.  分析解在凹角附近的局部行为。仅使用偏微分方程（PDE）的基本原理和以凹角为中心的极坐标 $(r,\\theta)$ 下拉普拉斯算子的标准性质，构造一个反例，表明由于角点奇性，强解 $u \\in H^{2}(\\Omega)$ 未必存在，尽管弱解 $u \\in H^{1}(\\Omega)$ 是良定义的。\n4.  确定解在凹角附近的主阶奇异项 $u_{s}(r,\\theta)$，用原点处的极坐标表示。你的推导必须从偏微分方程和构成凹角的射线上的边界条件开始，并确定奇异指数。通过估计二阶导数的可积性，严谨地论证并得出 $u \\in H^{2}(\\Omega)$ 是否成立的结论。\n5.  讨论这种奇异行为对在弱形式和数值近似中施加本质边界条件于 $\\Gamma_{D}$ 上的影响，包括 $H^{1}(\\Omega)$ 函数迹的概念以及如何在 $\\Gamma_{D}$ 上施加 $u=0$。\n\n你的最终答案应该是凹角附近主阶奇异项 $u_{s}(r,\\theta)$ 的符号表达式。无需进行数值四舍五入。最终答案仅用 $r$ 和 $\\theta$ 表示。", "solution": "所述问题在科学上是合理的、适定的、客观的、完整的且一致的。它是偏微分方程理论和计算力学中一个标准且重要的问题，用于阐释在存在区域奇性时弱解和正则性理论的概念。该问题是有效的。\n\n### 1. 强形式和弱形式边值问题的建立\n\n该问题由静态线性动量平衡和线性弹性本构关系控制。\n\n**强形式：**\n线性动量平衡由以下公式给出：\n$$-\\nabla \\cdot \\boldsymbol{\\sigma} = b$$\n反平面剪切的本构关系为：\n$$\\boldsymbol{\\sigma} = \\mu \\nabla u$$\n其中 $u$ 是平面外位移，$\\boldsymbol{\\sigma}$ 是应力向量（在此二维背景下，若平面为 $xy$ 且位移在 $z$ 方向，则 $\\boldsymbol{\\sigma}$ 是分量为 $(\\sigma_{zx}, \\sigma_{zy})$ 的向量），$\\mu$ 是剪切模量，$b$ 是体力密度。\n\n将本构关系代入平衡方程得到：\n$$-\\nabla \\cdot (\\mu \\nabla u) = b$$\n鉴于 $\\mu$ 是一个正常数，这可以简化为：\n$$-\\mu \\nabla \\cdot (\\nabla u) = b$$\n$$-\\mu \\Delta u = b$$\n其中 $\\Delta u = \\nabla \\cdot \\nabla u$ 是 $u$ 的拉普拉斯算子。\n\n问题指定了区域 $\\Omega = (-1,1)^{2} \\setminus ([0,1] \\times [-1,0])$，剪切模量 $\\mu=1$，以及常体力密度 $b=1$。位移在整个边界 $\\Gamma_D = \\partial \\Omega$ 上被指定为零。\n因此，该边值问题的强形式是找到一个足够光滑的函数 $u$（例如，$u \\in C^{2}(\\Omega) \\cap C^{0}(\\bar{\\Omega})$），满足：\n$$\n\\begin{cases}\n-\\Delta u = 1  \\text{在 } \\Omega \\text{ 内} \\\\\nu = 0  \\text{在 } \\partial \\Omega \\text{ 上}\n\\end{cases}\n$$\n\n**弱（变分）形式：**\n为了推导弱形式，我们从强形式开始，乘以一个任意的检验函数 $v$，并在区域 $\\Omega$ 上积分。检验函数 $v$ 必须从一个合适的函数空间中选取。由于边界条件 $u=0$ 是本质（狄利克雷）的，我们要求试探函数 $u$ 和检验函数 $v$ 属于一个满足此条件的空间。合适的空间是 Sobolev 空间 $H^{1}_{0}(\\Omega)$。\n\n空间 $H^{1}(\\Omega)$ 是 $L^{2}(\\Omega)$ 中其一阶弱导数也在 $L^{2}(\\Omega)$ 中的函数构成的空间。空间 $H^{1}_{0}(\\Omega)$ 是 $H^{1}(\\Omega)$ 中迹（广义边界值）在 $\\partial\\Omega$ 上为零的函数子集。形式上，$H^{1}_{0}(\\Omega)$ 是 $C^{\\infty}_{0}(\\Omega)$（在 $\\Omega$ 中具有紧支集的无限可微函数）在 $H^{1}$ 范数下的闭包。\n\n令 $u \\in H^{1}_{0}(\\Omega)$ 为试探解，$v \\in H^{1}_{0}(\\Omega)$ 为检验函数。\n将偏微分方程乘以 $v$ 并积分：\n$$ \\int_{\\Omega} (-\\Delta u) v \\, d\\Omega = \\int_{\\Omega} 1 \\cdot v \\, d\\Omega $$\n我们对左侧应用格林第一恒等式（多维分部积分）：\n$$ \\int_{\\Omega} \\nabla u \\cdot \\nabla v \\, d\\Omega - \\int_{\\partial\\Omega} (\\nabla u \\cdot \\mathbf{n}) v \\, dS = \\int_{\\Omega} v \\, d\\Omega $$\n这里，$\\mathbf{n}$ 是边界 $\\partial\\Omega$ 的外单位法向量。由于检验函数 $v$ 属于 $H^{1}_{0}(\\Omega)$，其在边界上的迹为零，即在 $\\partial\\Omega$ 上 $v = 0$。因此，边界积分消失：\n$$ \\int_{\\partial\\Omega} (\\nabla u \\cdot \\mathbf{n}) v \\, dS = 0 $$\n得到的方程即为该问题的弱形式：找到 $u \\in H^{1}_{0}(\\Omega)$，使得\n$$ \\int_{\\Omega} \\nabla u \\cdot \\nabla v \\, d\\Omega = \\int_{\\Omega} v \\, d\\Omega \\quad \\forall v \\in H^{1}_{0}(\\Omega) $$\n为了将其形式化以便应用 Lax-Milgram 定理，我们定义一个双线性形式 $a(u,v)$ 和一个线性泛函 $L(v)$：\n-   双线性形式：$a(u,v) := \\int_{\\Omega} \\nabla u \\cdot \\nabla v \\, d\\Omega$\n-   线性泛函：$L(v) := \\int_{\\Omega} v \\, d\\Omega$\n\n弱问题即为：找到 $u \\in V$，使得对所有 $v \\in V$ 都有 $a(u,v) = L(v)$，其中试探函数和检验函数的函数空间均为 $V = H^{1}_{0}(\\Omega)$。\n\n### 2. 通过 Lax-Milgram 定理证明存在唯一性\n\nLax–Milgram 定理指出，如果 $V$ 是一个希尔伯特空间，$a(\\cdot,\\cdot): V \\times V \\to \\mathbb{R}$ 是一个有界且矫顽的双线性形式，并且 $L(\\cdot): V \\to \\mathbb{R}$ 是一个有界的线性泛函，那么问题 $a(u,v) = L(v)$ 对所有 $v \\in V$ 存在唯一解 $u \\in V$。\n\n我们对 $V = H^{1}_{0}(\\Omega)$ 的问题验证这些条件。$H^{1}(\\Omega)$ 上的内积为 $\\langle u,v \\rangle_{H^1} = \\int_\\Omega (uv + \\nabla u \\cdot \\nabla v) d\\Omega$，范数为 $\\|v\\|_{H^1} = \\sqrt{\\langle v,v \\rangle_{H^1}}$。\n\n**a) 线性泛函 $L(v)$ 的有界性：**\n$$ |L(v)| = \\left| \\int_{\\Omega} v \\, d\\Omega \\right| = \\left| \\int_{\\Omega} 1 \\cdot v \\, d\\Omega \\right| $$\n根据 $L^{2}(\\Omega)$ 中的柯西-施瓦茨不等式：\n$$ |L(v)| \\le \\left(\\int_{\\Omega} 1^{2} \\, d\\Omega \\right)^{1/2} \\left(\\int_{\\Omega} v^{2} \\, d\\Omega \\right)^{1/2} = \\sqrt{\\text{Area}(\\Omega)} \\|v\\|_{L^2} $$\nL 形域的面积为 $3$。所以，$|L(v)| \\le \\sqrt{3} \\|v\\|_{L^2}$。由于 $\\|v\\|_{L^2} \\le \\|v\\|_{H^1}$，我们有\n$$ |L(v)| \\le \\sqrt{3} \\|v\\|_{H^1} $$\n因此，$L$ 是 $H^{1}_{0}(\\Omega)$ 上的一个有界线性泛函。\n\n**b) 双线性形式 $a(u,v)$ 的有界性：**\n$$ |a(u,v)| = \\left| \\int_{\\Omega} \\nabla u \\cdot \\nabla v \\, d\\Omega \\right| $$\n根据 $\\mathbb{R}^2$ 中向量的柯西-施瓦茨不等式，然后是 $L^{2}(\\Omega)$ 中函数的柯西-施瓦茨不等式：\n$$ |a(u,v)| \\le \\int_{\\Omega} |\\nabla u| |\\nabla v| \\, d\\Omega \\le \\|\\nabla u\\|_{L^2} \\|\\nabla v\\|_{L^2} $$\n梯度的 $L^2$ 范数是 $H^1$ 范数的一部分：$\\|\\nabla v\\|_{L^2} \\le \\|v\\|_{H^1}$。因此，\n$$ |a(u,v)| \\le \\|u\\|_{H^1} \\|v\\|_{H^1} $$\n这表明 $a(u,v)$ 是有界的，其有界性常数 $M=1$。\n\n**c) 双线性形式 $a(u,v)$ 的矫顽性（或 V-椭圆性）：**\n我们需要证明存在一个常数 $\\alpha > 0$，使得对所有 $v \\in V$ 都有 $a(v,v) \\ge \\alpha \\|v\\|_{H^1}^{2}$。对于 $v \\in H^{1}_{0}(\\Omega)$，我们有：\n$$ a(v,v) = \\int_{\\Omega} \\nabla v \\cdot \\nabla v \\, d\\Omega = \\|\\nabla v\\|_{L^2}^{2} $$\n庞加莱不等式对于像 $\\Omega$ 这样的有界域成立：对任意 $v \\in H^{1}_{0}(\\Omega)$，存在一个常数 $C_P > 0$（仅依赖于 $\\Omega$），使得 $\\|v\\|_{L^2} \\le C_P \\|\\nabla v\\|_{L^2}$。\n$H^1$ 范数为 $\\|v\\|_{H^1}^{2} = \\|v\\|_{L^2}^{2} + \\|\\nabla v\\|_{L^2}^{2}$。使用庞加莱不等式：\n$$ \\|v\\|_{H^1}^{2} \\le C_P^{2} \\|\\nabla v\\|_{L^2}^{2} + \\|\\nabla v\\|_{L^2}^{2} = (C_P^{2} + 1) \\|\\nabla v\\|_{L^2}^{2} $$\n整理此式，我们得到：\n$$ \\|\\nabla v\\|_{L^2}^{2} \\ge \\frac{1}{C_P^{2} + 1} \\|v\\|_{H^1}^{2} $$\n因此，\n$$ a(v,v) \\ge \\alpha \\|v\\|_{H^1}^{2} \\quad \\text{其中} \\quad \\alpha = \\frac{1}{C_P^{2} + 1} > 0 $$\n双线性形式 $a(u,v)$ 在 $H^{1}_{0}(\\Omega)$ 上是矫顽的。\n\n由于 Lax-Milgram 定理的所有条件都已满足，该问题存在唯一的弱解 $u \\in H^{1}_{0}(\\Omega)$。\n\n### 3.  4. 角点奇性分析与 $H^{2}(\\Omega)$ 中强解的不存在性\n\n强解 $u \\in H^2(\\Omega)$ 的存在性取决于区域的正则性和数据。虽然数据 $b=1$ 是光滑的，但 L 形域 $\\Omega$ 不是凸的，并且有一个凹角，这阻止了解属于 $H^2(\\Omega)$。\n\n为了分析局部行为，我们关注原点凹角附近的齐次拉普拉斯方程 $\\Delta u = 0$。局部奇性由偏微分方程的齐次部分决定。我们使用极坐标 $(r,\\theta)$，其中角点位于 $r=0$。该区域局部对应于楔形域 $0  r  \\epsilon$ 和 $0  \\theta  \\omega = \\frac{3\\pi}{2}$。相邻边上的边界条件为 $\\theta=0$ 和 $\\theta=\\omega$ 时 $u=0$。\n\n我们使用分离变量法，寻找形如 $u(r,\\theta) = r^{\\lambda} \\phi(\\theta)$ 的非平凡解。将其代入极坐标下的拉普拉斯方程 $\\Delta u = u_{rr} + \\frac{1}{r} u_r + \\frac{1}{r^2} u_{\\theta\\theta} = 0$，得到：\n$$ \\lambda(\\lambda-1) r^{\\lambda-2} \\phi(\\theta) + \\frac{1}{r} \\lambda r^{\\lambda-1} \\phi(\\theta) + \\frac{1}{r^2} r^{\\lambda} \\phi''(\\theta) = 0 $$\n$$ r^{\\lambda-2} [\\lambda^2 \\phi(\\theta) + \\phi''(\\theta)] = 0 $$\n这简化为常微分方程：\n$$ \\phi''(\\theta) + \\lambda^2 \\phi(\\theta) = 0 $$\n通解为 $\\phi(\\theta) = A \\cos(\\lambda\\theta) + B \\sin(\\lambda\\theta)$。\n边界条件 $u(r,0)=0$ 和 $u(r,\\omega)=0$ 转化为 $\\phi(0)=0$ 和 $\\phi(\\omega)=0$。\n-   $\\phi(0) = A \\cos(0) + B \\sin(0) = A = 0$。\n-   所以，$\\phi(\\theta) = B \\sin(\\lambda\\theta)$。\n-   $\\phi(\\omega) = B \\sin(\\lambda\\omega) = 0$。\n为了得到非平凡解（$B \\neq 0$），必须有 $\\sin(\\lambda\\omega) = 0$，这意味着 $\\lambda\\omega = k\\pi$，其中整数 $k \\ge 1$。\n$$ \\lambda_k = \\frac{k\\pi}{\\omega} $$\n对于给定的区域，$\\omega = \\frac{3\\pi}{2}$。指数为：\n$$ \\lambda_k = \\frac{k\\pi}{3\\pi/2} = \\frac{2k}{3}, \\quad k=1, 2, 3, \\dots $$\n角点附近的解是这些基函数的线性组合：$u(r,\\theta) = \\sum_{k=1}^\\infty c_k r^{2k/3} \\sin\\left(\\frac{2k\\theta}{3}\\right)$。\n\n解的最奇异部分对应于最小的正指数 $\\lambda_1 = \\lambda = \\frac{2}{3}$。这是**主阶奇异项**：\n$$ u_s(r,\\theta) = c_1 r^{2/3} \\sin\\left(\\frac{2\\theta}{3}\\right) $$\n其中 $c_1$ 是一个常数，称为应力强度因子，由整体几何形状和载荷决定。问题要求的是该项的形式。\n\n现在我们可以通过分析该项的正则性来构造第 3 部分所要求的反例。我们来检验一个在原点附近行为类似 $u_s$ 的函数是否属于 $H^1(\\Omega)$ 和 $H^2(\\Omega)$。\n\n**正则性检验：**\n$u_s$ 的导数行为如下：\n-   一阶导数：$|\\nabla u_s| \\sim \\frac{\\partial}{\\partial r} r^{2/3} \\sim r^{2/3 - 1} = r^{-1/3}$。\n-   二阶导数：$|\\nabla^2 u_s| \\sim \\frac{\\partial^2}{\\partial r^2} r^{2/3} \\sim r^{2/3 - 2} = r^{-4/3}$。\n\n为了检验 $u_s$ 是否局部属于 $H^1$，我们必须检验其一阶导数是否平方可积。在原点附近，$|\\nabla u_s|^2$ 的积分行为如下：\n$$ \\int_0^\\epsilon \\int_0^{3\\pi/2} |\\nabla u_s|^2 r \\, d\\theta \\, dr \\sim \\int_0^\\epsilon (r^{-1/3})^2 r \\, dr = \\int_0^\\epsilon r^{-2/3} r \\, dr = \\int_0^\\epsilon r^{1/3} \\, dr $$\n这个积分是 $\\left[\\frac{3}{4} r^{4/3}\\right]_0^\\epsilon$，是有限的。因此，弱解 $u \\in H^1(\\Omega)$。\n\n为了检验 $u_s$ 是否局部属于 $H^2$，我们必须检验其二阶导数是否平方可积。$|\\nabla^2 u_s|^2$ 的积分行为如下：\n$$ \\int_0^\\epsilon \\int_0^{3\\pi/2} |\\nabla^2 u_s|^2 r \\, d\\theta \\, dr \\sim \\int_0^\\epsilon (r^{-4/3})^2 r \\, dr = \\int_0^\\epsilon r^{-8/3} r \\, dr = \\int_0^\\epsilon r^{-5/3} \\, dr $$\n这个积分是 $\\left[-\\frac{3}{2} r^{-2/3}\\right]_0^\\epsilon$，当 $r \\to 0$ 时发散。\n由于二阶导数不是平方可积的，所以在原点的任何邻域内 $u_s \\notin H^2$。这意味着完整解 $u$ 不在 $H^2(\\Omega)$ 中。\n\n这个分析构成了反例，表明即使唯一的弱解在 $H^1(\\Omega)$ 中得到保证，$H^2(\\Omega)$ 意义下的强解也不存在。$H^2$ 正则性的缺失是区域中凹角的直接后果。\n\n### 5. 对边界条件的影响\n\n施加本质边界条件 $u=0$ on $\\Gamma_D$ 在弱形式中的处理方式与人们对经典解的构想不同。\n-   **在弱形式中：** 在 $\\partial\\Omega$ 上 $u=0$ 的条件是通过迹定理以广义的方式满足的。解的函数空间 $H^1_0(\\Omega)$ 被专门定义为 $H^1(\\Omega)$ 中在边界 $\\partial\\Omega$ 上迹为零的函数集合。通过在这个空间内寻找解 $u$，边界条件被作为对容许函数空间的约束而*先验地*施加。它是问题设定的“本质”部分，而不是一个需要解以逐点方式满足的方程（这对于 $H^1$ 函数可能没有意义）。\n-   **在数值近似（如有限元法）中：** 应用相同的原理。我们构造一个有限维子空间 $V_h \\subset H^1_0(\\Omega)$。这通常是通过在 $\\Omega$ 上定义一个网格，并使用一组分段多项式函数（形函数）$\\phi_i(x)$ 作为基底来完成的。为确保 $V_h$ 中的任何函数 $u_h = \\sum c_i \\phi_i$ 在 $\\partial\\Omega$ 上满足 $u_h=0$，我们只需确保所有与*不在*边界上的节点相关联的基函数 $\\phi_i$ 在 $\\partial\\Omega$ 上为零。在实践中，对应于狄利克雷边界上节点的自由度会从全局代数方程组中消除。\n\n奇性 $u_s \\sim r^{2/3}$ 的存在对数值近似有深远的影响。使用均匀网格和多项式基函数的标准有限元法难以捕捉这种奇异行为。对于光滑解，能量范数误差 $\\|u-u_h\\|_{H^1}$ 的收敛率本应为 $O(h^p)$（其中 $h$ 是网格尺寸，$p$ 是多项式次数），但现在受限于解的正则性。对于此问题，收敛率降至 $O(h^{\\lambda_1}) = O(h^{2/3})$，这比线性单元的最优收敛率 $O(h)$ 要慢得多。这需要使用高级技术，如朝向角点的渐变网格加密，或用已知的奇异形式丰富基函数（例如，使用 XFEM 或奇异单元），以恢复最优收敛率。", "answer": "$$\n\\boxed{r^{2/3}\\sin\\left(\\frac{2\\theta}{3}\\right)}\n$$", "id": "3604122"}, {"introduction": "在建立了弱形式的重要性之后，我们需要关注其在有限元方法中的实际应用。为了计算效率，我们常常对几何形状或积分进行近似处理，这些操作在文献中被戏称为“变分罪行”(variational crimes)，它们会破坏离散格式与原始弱形式之间的一致性。本练习[@problem_id:3604073]提供了一个直观的一维杆模型，让你能够量化这些近似所引入的误差，并学习如何通过构造一个相容性指标来“侦测”这些罪行对求解精度的影响。", "problem": "考虑一根长度为 $L>0$ 的直棱杆，占据区域 $x \\in [0,L]$，处于小应变一维线性弹性状态下。设杨氏模量为 $E>0$，横截面积线性变化，表达式为 $A(x) = A_{0}\\left(1 + \\alpha \\frac{x}{L}\\right)$，其中 $A_{0}>0$ 且 $\\alpha$ 为无量纲参数。该杆受到分布轴向体力 $b(x) = b_{1} x$（其中 $b_{1}$ 为常数）的作用，并具有边界条件 $u(0) = 0$（本质边界条件）和在 $x=L$ 处给定的牵引力 $t_{0}$（自然边界条件）。轴向平衡的强形式为 $-\\frac{\\mathrm{d}}{\\mathrm{d}x}\\left(E A(x) u'(x)\\right) = b(x)$ on $[0,L]$，且在 $x=L$ 处有 $E A(L) u'(L) = t_{0}$。\n\n从线性动量平衡以及应变 $\\varepsilon(x) = u'(x)$ 和应力 $\\sigma(x) = E \\varepsilon(x)$ 的定义出发，使用虚功原理和一个在 $x=0$ 处为零的通用测试函数 $w(x)$，推导在 $[0,L]$ 上的弱形式。然后，考虑在 $[0,L]$ 上使用单个两节点有限元法（FEM）进行离散化，采用线性形函数 $N_{1}(x) = 1 - \\frac{x}{L}$ 和 $N_{2}(x) = \\frac{x}{L}$。通过将第一个自由度设为零来施加狄利克雷边界条件，并使用单参数试探函数 $u_{h}(x) = d_{2} N_{2}(x)$ 和测试函数 $w_{h}(x) = N_{2}(x)$。\n\n研究以下两种“变分罪”对弱形式一致性的影响：\n1. 几何近似：在刚度积分中，用常数近似面积 $\\widehat{A}(x) = A_{0}$ 替代真实面积 $A(x)$。\n2. 降阶求积：通过中点法则近似体力积分 $\\int_{0}^{L} b(x) w_{h}(x) \\,\\mathrm{d}x$，即 $b\\!\\left(\\frac{L}{2}\\right) w_{h}\\!\\left(\\frac{L}{2}\\right) L$。\n\n对牵引力项 $t_{0} w_{h}(L)$ 进行精确计算。\n\n(a) 在上述变分罪条件下，推导 $d_{2}$ 的离散方程，并用 $E$、$A_{0}$、$\\alpha$、$L$、$b_{1}$ 和 $t_{0}$ 符号化地求解 $d_{2}$。\n\n(b) 将与 $u_{h}$ 相关的强形式残差定义为 $r(x) = -\\frac{\\mathrm{d}}{\\mathrm{d}x}\\left(E A(x) u_{h}'(x)\\right) - b(x)$，将在 $x=L$ 处的诺伊曼边界不匹配定义为 $m = E A(L) u_{h}'(L) - t_{0}$。使用精确的系数 $E$ 和 $A(x)$，构建标量一致性指标\n$$\nJ := \\int_{0}^{L} r(x)\\, N_{2}(x) \\,\\mathrm{d}x \\;+\\; m\\, N_{2}(L),\n$$\n该指标通过强形式残差和边界项不匹配来检测对精确弱形式的违背。将(a)部分得到的 $d_{2}$ 代入，计算 $J$ 的闭式解。\n\n将 $J$ 的最终值以牛顿为单位表示。不代入任何数值；用 $E$、$A_{0}$、$\\alpha$、$L$、$b_{1}$ 和 $t_{0}$ 给出单个简化的解析表达式。最终答案必须是单个表达式。如果在推导中进行了任何近似，请从第一性原理出发进行论证。无需四舍五入。", "solution": "本问题要求使用有限元法（FEM）分析一维线性弹性杆，特别关注“变分罪”对公式一致性的影响。我们将首先推导弱形式，然后推导带有指定近似的离散方程，求解未知位移，最后计算一致性指标 $J$。\n\n该边值问题的控制强形式由以下公式给出：\n$$-\\frac{\\mathrm{d}}{\\mathrm{d}x}\\left(E A(x) u'(x)\\right) = b(x) \\quad \\text{for } x \\in (0, L)$$\n边界条件为：\n$$u(0) = 0 \\quad (\\text{本质边界条件})$$\n$$E A(L) u'(L) = t_{0} \\quad (\\text{自然边界条件})$$\n其中 $u(x)$ 是轴向位移，$E$ 是杨氏模量，$A(x) = A_{0}\\left(1 + \\alpha \\frac{x}{L}\\right)$ 是可变横截面积，$b(x) = b_{1} x$ 是分布体力（单位长度上的力），$t_0$ 是在端点 $x=L$ 处施加的牵引力（一个集中力）。\n\n为了推导弱形式，我们采用虚功原理。我们将控制微分方程乘以一个虚位移或测试函数 $w(x)$，该函数必须满足齐次本质边界条件，即 $w(0)=0$。然后我们在域 $[0,L]$ 上进行积分：\n$$-\\int_{0}^{L} \\frac{\\mathrm{d}}{\\mathrm{d}x}\\left(E A(x) u'(x)\\right) w(x) \\,\\mathrm{d}x = \\int_{0}^{L} b(x) w(x) \\,\\mathrm{d}x$$\n我们对左侧（LHS）应用分部积分：\n$$ \\text{LHS} = \\int_{0}^{L} E A(x) u'(x) w'(x) \\,\\mathrm{d}x - \\left[ E A(x) u'(x) w(x) \\right]_{0}^{L} $$\n计算边界项：\n$$ \\left[ E A(x) u'(x) w(x) \\right]_{0}^{L} = E A(L) u'(L) w(L) - E A(0) u'(0) w(0) $$\n在 $x=0$ 处的项因 $w(0)=0$ 而消失。在 $x=L$ 处，我们应用自然边界条件 $E A(L) u'(L) = t_0$。因此，边界项变为 $t_0 w(L)$。将其代回，我们得到弱形式：\n寻找 $u(x)$，使得 $u(0)=0$，并且对于所有满足 $w(0)=0$ 的测试函数 $w(x)$：\n$$ \\int_{0}^{L} E A(x) u'(x) w'(x) \\,\\mathrm{d}x = \\int_{0}^{L} b(x) w(x) \\,\\mathrm{d}x + t_0 w(L) $$\n\n现在，我们进行有限元离散化。域 $[0,L]$ 通过单个两节点单元进行离散。未知位移场 $u(x)$ 由试探函数 $u_h(x) = \\sum_{i=1}^{2} d_i N_i(x)$ 近似，其中 $d_i$ 是节点位移，$N_i(x)$ 是线性形函数：$N_{1}(x) = 1 - \\frac{x}{L}$ 和 $N_{2}(x) = \\frac{x}{L}$。本质边界条件 $u(0)=0$ 意味着 $u_h(0) = d_1 N_1(0) + d_2 N_2(0) = d_1 \\cdot 1 + d_2 \\cdot 0 = d_1 = 0$。测试函数从同一空间中选取，$w_h(x) = c_2 N_2(x)$。由于线性关系，我们可以简单地设 $w_h(x) = N_2(x)$。\n试探函数及其导数为：\n$$u_{h}(x) = d_{2} N_{2}(x) = d_{2} \\frac{x}{L}$$\n$$u_{h}'(x) = d_{2} \\frac{1}{L}$$\n测试函数及其导数为：\n$$w_{h}(x) = N_{2}(x) = \\frac{x}{L}$$\n$$w_{h}'(x) = N_{2}'(x) = \\frac{1}{L}$$\n\n(a) 在变分罪条件下推导 $d_{2}$ 的离散方程。\n\n离散弱形式为 $a(u_h, w_h) = l(w_h)$。我们必须使用指定的“变分罪”来计算双线性形式 $a(\\cdot, \\cdot)$ 和线性泛函 $l(\\cdot)$。\n\n1.  **刚度项 (LHS)**：几何罪是在刚度积分中用常数近似 $\\widehat{A}(x) = A_{0}$ 替换 $A(x)$。\n    $$ \\text{LHS} = \\int_{0}^{L} E \\widehat{A}(x) u_{h}'(x) w_{h}'(x) \\,\\mathrm{d}x = \\int_{0}^{L} E A_{0} \\left( \\frac{d_2}{L} \\right) \\left( \\frac{1}{L} \\right) \\,\\mathrm{d}x $$\n    $$ \\text{LHS} = \\frac{E A_{0} d_{2}}{L^2} \\int_{0}^{L} \\mathrm{d}x = \\frac{E A_{0} d_{2}}{L^2} [x]_{0}^{L} = \\frac{E A_{0} d_{2}}{L} $$\n\n2.  **力项 (RHS)**：这包括体力积分和牵引力项。\n    -   体力积分使用中点法则（一种求积罪）进行近似。\n    $$ \\int_{0}^{L} b(x) w_{h}(x) \\,\\mathrm{d}x \\approx L \\cdot b\\left(\\frac{L}{2}\\right) w_{h}\\left(\\frac{L}{2}\\right) $$\n    我们有 $b(x) = b_1 x$，所以 $b(L/2) = b_1 \\frac{L}{2}$。测试函数是 $w_h(x) = N_2(x) = \\frac{x}{L}$，所以 $w_h(L/2) = \\frac{L/2}{L} = \\frac{1}{2}$。\n    $$ \\text{体力项} \\approx L \\left( b_1 \\frac{L}{2} \\right) \\left( \\frac{1}{2} \\right) = \\frac{b_1 L^2}{4} $$\n    -   牵引力项被精确计算。\n    $$ t_{0} w_{h}(L) = t_{0} N_{2}(L) = t_{0} \\left( \\frac{L}{L} \\right) = t_{0} $$\n    将这些组合起来得到 RHS：\n    $$ \\text{RHS} = \\frac{b_1 L^2}{4} + t_0 $$\n\n将 LHS 和 RHS 相等，得到 $d_2$ 的离散方程：\n$$ \\frac{E A_{0} d_{2}}{L} = \\frac{b_1 L^2}{4} + t_0 $$\n求解 $d_2$：\n$$ d_{2} = \\frac{L}{E A_{0}} \\left( \\frac{b_1 L^2}{4} + t_0 \\right) = \\frac{b_1 L^3}{4 E A_0} + \\frac{t_0 L}{E A_0} $$\n\n(b) 计算一致性指标 $J$。\n\n一致性指标定义为：\n$$ J := \\int_{0}^{L} r(x)\\, N_{2}(x) \\,\\mathrm{d}x \\;+\\; m\\, N_{2}(L) $$\n其中 $r(x) = -\\frac{\\mathrm{d}}{\\mathrm{d}x}\\left(E A(x) u_{h}'(x)\\right) - b(x)$ 是强形式残差，$m = E A(L) u_{h}'(L) - t_{0}$ 是诺伊曼边界不匹配。\n\n让我们将 $r(x)$ 和 $m$ 的定义代入 $J$。注意 $N_2(L)=1$。\n$$ J = \\int_{0}^{L} \\left(-\\frac{\\mathrm{d}}{\\mathrm{d}x}\\left(E A(x) u_{h}'(x)\\right) - b(x)\\right) N_{2}(x) \\,\\mathrm{d}x + \\left(E A(L) u_{h}'(L) - t_{0}\\right) \\cdot 1 $$\n我们对积分中的第一项应用分部积分：\n$$ -\\int_{0}^{L} \\frac{\\mathrm{d}}{\\mathrm{d}x}\\left(E A(x) u_{h}'(x)\\right) N_{2}(x) \\,\\mathrm{d}x = \\int_{0}^{L} E A(x) u_{h}'(x) N_{2}'(x) \\,\\mathrm{d}x - \\left[E A(x) u_{h}'(x) N_{2}(x)\\right]_0^L $$\n边界项计算为 $E A(L) u_{h}'(L) N_{2}(L) - E A(0) u_{h}'(0) N_{2}(0)$。在 $x=0$ 处的项为零，因为 $N_2(0)=0$。\n将此代回 $J$ 的表达式中：\n$$ J = \\left(\\int_{0}^{L} E A(x) u_{h}'(x) N_{2}'(x) \\,\\mathrm{d}x - E A(L) u_{h}'(L) N_{2}(L) \\right) - \\int_0^L b(x) N_2(x) dx + E A(L) u_{h}'(L) - t_0 $$\n由于 $N_2(L)=1$，包含 $E A(L) u_{h}'(L)$ 的项相互抵消：\n$$ J = \\int_{0}^{L} E A(x) u_{h}'(x) N_{2}'(x) \\,\\mathrm{d}x - \\int_0^L b(x) N_2(x) dx - t_0 $$\n这表明 $J$ 是用近似解 $u_h$ 和测试函数 $w_h=N_2$ 计算的*精确*弱形式的残差。\n$$J = a_{exact}(u_h, N_2) - l_{exact}(N_2)$$\n解 $d_2$ 是从*有罪的*弱形式 $a_{approx}(u_h, N_2) = l_{approx}(N_2)$ 得到的。因此，我们可以将 $J$ 表示为由变分罪引入的误差之和：\n$$ J = [ a_{exact}(u_h, N_2) - a_{approx}(u_h, N_2) ] - [ l_{exact}(N_2) - l_{approx}(N_2) ] $$\n让我们计算这两个误差项。\n\n1.  **刚度误差:** $E_K = a_{exact} - a_{approx}$\n$$ E_K = \\int_0^L E A(x) u_h'(x) N_2'(x) dx - \\int_0^L E \\widehat{A}(x) u_h'(x) N_2'(x) dx $$\n$$ E_K = \\int_0^L E (A(x) - \\widehat{A}(x)) u_h'(x) N_2'(x) dx $$\n代入 $A(x) = A_{0}(1 + \\alpha \\frac{x}{L})$，$\\widehat{A}(x) = A_0$，$u_h'(x) = d_2/L$ 和 $N_2'(x) = 1/L$：\n$$ E_K = \\int_0^L E \\left( A_{0}\\alpha \\frac{x}{L} \\right) \\left( \\frac{d_2}{L} \\right) \\left( \\frac{1}{L} \\right) dx = \\frac{E A_0 \\alpha d_2}{L^3} \\int_0^L x \\,dx $$\n$$ E_K = \\frac{E A_0 \\alpha d_2}{L^3} \\left[ \\frac{x^2}{2} \\right]_0^L = \\frac{E A_0 \\alpha d_2}{L^3} \\frac{L^2}{2} = \\frac{E A_0 \\alpha d_2}{2L} $$\n\n2.  **力项误差:** $E_F = l_{exact} - l_{approx}$\n牵引力项 $t_0 N_2(L)$ 相同并抵消。误差仅来自体力积分。\n$$ E_F = \\int_0^L b(x) N_2(x) dx - \\left( L \\cdot b\\left(\\frac{L}{2}\\right) N_2\\left(\\frac{L}{2}\\right) \\right) $$\n精确积分为：\n$$ \\int_0^L (b_1 x) \\left(\\frac{x}{L}\\right) dx = \\frac{b_1}{L} \\int_0^L x^2 dx = \\frac{b_1}{L} \\left[ \\frac{x^3}{3} \\right]_0^L = \\frac{b_1 L^2}{3} $$\n近似积分计算为 $\\frac{b_1 L^2}{4}$。\n$$ E_F = \\frac{b_1 L^2}{3} - \\frac{b_1 L^2}{4} = b_1 L^2 \\left(\\frac{4-3}{12}\\right) = \\frac{b_1 L^2}{12} $$\n\n现在，组合 $J = E_K - E_F$：\n$$ J = \\frac{E A_0 \\alpha d_2}{2L} - \\frac{b_1 L^2}{12} $$\n最后，我们代入在(a)部分找到的 $d_2$ 的表达式：\n$$ d_2 = \\frac{L}{E A_0} \\left( \\frac{b_1 L^2}{4} + t_0 \\right) $$\n$$ J = \\frac{E A_0 \\alpha}{2L} \\left[ \\frac{L}{E A_0} \\left( \\frac{b_1 L^2}{4} + t_0 \\right) \\right] - \\frac{b_1 L^2}{12} $$\n在第一部分中，$E A_0$ 和 $L$ 项抵消：\n$$ J = \\frac{\\alpha}{2} \\left( \\frac{b_1 L^2}{4} + t_0 \\right) - \\frac{b_1 L^2}{12} $$\n$$ J = \\frac{\\alpha b_1 L^2}{8} + \\frac{\\alpha t_0}{2} - \\frac{b_1 L^2}{12} $$\n合并包含 $b_1 L^2$ 的项：\n$$ J = b_1 L^2 \\left( \\frac{\\alpha}{8} - \\frac{1}{12} \\right) + \\frac{\\alpha t_0}{2} $$\n$$ J = b_1 L^2 \\left( \\frac{3\\alpha - 2}{24} \\right) + \\frac{\\alpha t_0}{2} $$\n这个最终的 $J$ 表达式量化了由两种变分罪引入的不一致性。与 $b_1$ 成比例的项既有来自几何罪的成分（$\\alpha$），也有来自求积罪的成分（常数部分），而与 $t_0$ 成比例的项仅来自几何罪。如果没有犯任何变分罪（$\\alpha=0$ 且精确积分），$J$ 将为零。", "answer": "$$\\boxed{b_{1} L^2 \\left( \\frac{3\\alpha - 2}{24} \\right) + \\frac{\\alpha t_{0}}{2}}$$", "id": "3604073"}, {"introduction": "将弱形式的应用从线性问题推广到非线性问题是计算力学的核心步骤之一，其中一个典型的例子是处理非保守的“跟随力”。在这种情况下，外力的大小或方向取决于结构的变形，导致虚功方程中的外力项本身就是位移的函数。本练习[@problem_id:3604053]要求你对该非线性外力项进行严格的变分线性化，以推导出一致的“载荷刚度矩阵”，并与不一致的简化公式进行对比，从而揭示不恰当的弱形式处理如何引入虚假的、非物理的刚度效应。", "problem": "考虑一个二维弹性体，其占据一个域 $\\Omega \\subset \\mathbb{R}^{2}$，边界为 $\\partial \\Omega = \\Gamma_{u} \\cup \\Gamma_{t}$，其中 $\\Gamma_{u}$ 和 $\\Gamma_{t}$ 不相交。该物体处于准静态平衡状态，并遵循线性动量守恒和牵引力边界条件。设Cauchy应力为 $\\boldsymbol{\\sigma}$，在 $\\Gamma_{t}$ 上施加的牵引力为一个大小为 $p$ 的均匀随动线荷载，其作用方向沿边界段当前构型的外单位法线，记为 $\\mathbf{n}(\\boldsymbol{\\varphi})$，其中 $\\boldsymbol{\\varphi}$ 是变形映射。假设边界段上为小应变但有限转动设定，因此内部的材料响应保持线性弹性，但边界牵引力跟随当前的法线方向。\n\n从强形式的线性动量守恒和牵引力边界条件出发，推导该边值问题的弱（变分）形式，并将 $\\Gamma_{t}$ 上的外虚功贡献具体化到单个直边界边 $\\Gamma_{e} \\subset \\Gamma_{t}$ 的情况，该边由一个双节点线性段离散化，其节点在参考构型中的位置为 $\\mathbf{X}_{1}$ 和 $\\mathbf{X}_{2}$，节点位移为 $\\mathbf{u}_{1}$ 和 $\\mathbf{u}_{2}$。记当前边向量为 $\\mathbf{a} = \\big(\\mathbf{X}_{2} + \\mathbf{u}_{2}\\big) - \\big(\\mathbf{X}_{1} + \\mathbf{u}_{1}\\big)$，其当前长度为 $L = \\|\\mathbf{a}\\|$，当前单位切线为 $\\mathbf{t} = \\mathbf{a}/L$，当前单位法线为 $\\mathbf{n} = \\mathbf{P}\\,\\mathbf{t}$，其中 $\\mathbf{P} = \\begin{pmatrix} 0  -1 \\\\ 1  0 \\end{pmatrix}$ 表示将 $\\mathbb{R}^{2}$ 中任意向量逆时针旋转 $\\pi/2$ 弧度的矩阵。在这种设定下，$\\Gamma_{e}$ 上的外虚功为\n$$\n\\delta W_{\\text{ext}}(\\mathbf{u};\\delta \\mathbf{u}) = \\int_{\\Gamma_{e}} p\\,\\mathbf{n}(\\mathbf{u}) \\cdot \\delta \\mathbf{u}\\, \\mathrm{d}s.\n$$\n\n利用虚功原理和变分线性化，推导 $\\delta W_{\\text{ext}}$ 关于Newton增量 $(\\Delta \\mathbf{u}_{1}, \\Delta \\mathbf{u}_{2})$ 的一致线性化，并证明对于具有线性形函数的双节点直边，每个节点的单元级外荷载向量为 $\\mathbf{f}_{i} = \\frac{pL}{2}\\,\\mathbf{n}$，其一致Gateaux导数（即所谓的荷载刚度）满足\n$$\n\\Delta \\mathbf{f}_{i} = \\frac{p}{2}\\Big[ \\big(\\mathbf{n} \\otimes \\mathbf{t}\\big) + \\mathbf{P}\\big(\\mathbf{I} - \\mathbf{t} \\otimes \\mathbf{t}\\big) \\Big] \\big(\\Delta \\mathbf{u}_{2} - \\Delta \\mathbf{u}_{1}\\big).\n$$\n\n对初始方向（参考边与全局 $x$ 轴对齐）即 $\\mathbf{X}_{2} - \\mathbf{X}_{1} = (L_{0}, 0)^{\\mathsf{T}}$ 评估此表达式，并考虑此方向附近的构型，使得 $\\mathbf{t} \\approx (1,0)^{\\mathsf{T}}$ 且 $\\mathbf{n} \\approx (0,1)^{\\mathsf{T}}$。证明一致荷载刚度简化为\n$$\n\\Delta \\mathbf{f}_{i} = \\frac{p}{2}\\,\\mathbf{P}\\,\\big(\\Delta \\mathbf{u}_{2} - \\Delta \\mathbf{u}_{1}\\big).\n$$\n\n现在，通过将随动方向和当前线元测度冻结在其参考值来构建一个非一致弱形式，即使用 $\\mathbf{N} = \\mathbf{P}\\,\\mathbf{T}_{0}$（其中 $\\mathbf{T}_{0} = (\\mathbf{X}_{2} - \\mathbf{X}_{1})/\\|\\mathbf{X}_{2} - \\mathbf{X}_{1}\\|$），并在外虚功中用 $L_{0} = \\|\\mathbf{X}_{2} - \\mathbf{X}_{1}\\|$ 替换 $L$，使得\n$$\n\\delta W_{\\text{ext}}^{\\text{inc}}(\\mathbf{u};\\delta \\mathbf{u}) = \\int_{\\Gamma_{e}} p\\,\\mathbf{N} \\cdot \\delta \\mathbf{u}\\, \\mathrm{d}s \\approx p\\,\\frac{L_{0}}{2}\\,\\mathbf{N} \\cdot \\big(\\delta \\mathbf{u}_{1} + \\delta \\mathbf{u}_{2}\\big).\n$$\n对此非一致表达式关于 $(\\Delta \\mathbf{u}_{1}, \\Delta \\mathbf{u}_{2})$ 进行线性化，但允许当前长度 $L$ 变化，同时保持 $\\mathbf{N}$ 和 $L_{0}$ 固定，并证明得到的每个节点的非一致荷载刚度为\n$$\n\\Delta \\mathbf{f}_{i}^{\\text{inc}} = \\frac{p}{2}\\,\\big(\\mathbf{N} \\otimes \\mathbf{t}\\big)\\,\\big(\\Delta \\mathbf{u}_{2} - \\Delta \\mathbf{u}_{1}\\big).\n$$\n\n对于相同的初始方向 $\\mathbf{t} \\approx (1,0)^{\\mathsf{T}}$ 和 $\\mathbf{N} \\approx (0,1)^{\\mathsf{T}}$，通过考虑节点1处节点力变化的 $x$ 分量中乘以 $\\Delta a_{y} = \\big(\\Delta u_{2,y} - \\Delta u_{1,y}\\big)$ 的系数，来识别和量化由该非一致弱形式引入的一个伪刚度分量，即\n$$\n\\Delta f_{1,x} = k_{\\text{spur}}\\,\\Delta a_{y}.\n$$\n计算标量系数 $k_{\\text{spur}}$ 如下\n$$\nk_{\\text{spur}} = \\frac{p}{2}\\,\\big([\\mathbf{B}_{\\text{inc}} - \\mathbf{B}]_{1,2}\\big),\n$$\n其中对于指定方向，$\\mathbf{B}_{\\text{inc}} = \\mathbf{N} \\otimes \\mathbf{t}$ 且 $\\mathbf{B} = \\mathbf{P}$。将 $k_{\\text{spur}}$ 的最终值以 $\\mathrm{N}\\,\\mathrm{m}^{-1}$ 为单位，表示为关于 $p$ 的单一闭式解析表达式。无需进行数值四舍五入。", "solution": "虚功原理指出，对于处于平衡状态的物体，外力所做的虚功等于内力所做的虚功，这对任何运动学上容许的虚位移都成立。平衡的强形式，即在 $\\Omega$ 中的 $\\nabla \\cdot \\boldsymbol{\\sigma} + \\mathbf{b} = \\mathbf{0}$ 以及在 $\\Gamma_t$ 上的牵引力边界条件 $\\boldsymbol{\\sigma} \\mathbf{n}_{\\text{bdy}} = \\mathbf{t}_{\\text{ prescribed}}$，通过乘以一个虚位移场 $\\delta\\mathbf{u}$ 并在域 $\\Omega$ 上积分，可以转换为弱形式。应用散度定理可得标准弱形式：\n$$\n\\int_{\\Omega} \\nabla(\\delta\\mathbf{u}) : \\boldsymbol{\\sigma} \\, \\mathrm{d}V = \\int_{\\Omega} \\delta\\mathbf{u} \\cdot \\mathbf{b} \\, \\mathrm{d}V + \\int_{\\Gamma_t} \\delta\\mathbf{u} \\cdot \\mathbf{t}_{\\text{prescribed}} \\, \\mathrm{d}A\n$$\n问题聚焦于在 $\\Gamma_t$ 上的边界积分，它代表了外虚功 $\\delta W_{\\text{ext}}$。\n\n**第1部分：外虚功和节点力的离散化**\n在双节点直边 $\\Gamma_e$ 上的外虚功由 $\\delta W_{\\text{ext}} = \\int_{\\Gamma_{e}} p\\,\\mathbf{n}(\\mathbf{u}) \\cdot \\delta \\mathbf{u}\\, \\mathrm{d}s$ 给出。对于双节点线性单元，位移和虚位移场由节点值插值得到：$\\mathbf{u}(\\xi) = N_1(\\xi)\\mathbf{u}_1 + N_2(\\xi)\\mathbf{u}_2$ 和 $\\delta\\mathbf{u}(\\xi) = N_1(\\xi)\\delta\\mathbf{u}_1 + N_2(\\xi)\\delta\\mathbf{u}_2$，其中线性形函数为 $N_1(\\xi) = \\frac{1-\\xi}{2}$ 和 $N_2(\\xi) = \\frac{1+\\xi}{2}$，对于 $\\xi \\in [-1, 1]$。当前构型中的微分弧长为 $\\mathrm{d}s = \\frac{L}{2}\\mathrm{d}\\xi$。由于 $p$、$\\mathbf{n}$ 和 $L$ 在直段上是常数：\n$$\n\\delta W_{\\text{ext}} = \\int_{-1}^{1} p\\,\\mathbf{n} \\cdot \\left(N_1(\\xi)\\delta\\mathbf{u}_1 + N_2(\\xi)\\delta\\mathbf{u}_2\\right) \\frac{L}{2} \\, \\mathrm{d}\\xi = p\\frac{L}{2}\\mathbf{n} \\cdot \\left( \\delta\\mathbf{u}_1 \\int_{-1}^{1} N_1(\\xi)\\mathrm{d}\\xi + \\delta\\mathbf{u}_2 \\int_{-1}^{1} N_2(\\xi)\\mathrm{d}\\xi \\right)\n$$\n线性形函数在父单元上的积分为 $\\int_{-1}^{1} N_1(\\xi)\\mathrm{d}\\xi = 1$ 和 $\\int_{-1}^{1} N_2(\\xi)\\mathrm{d}\\xi = 1$。因此，\n$$\n\\delta W_{\\text{ext}} = p\\frac{L}{2}\\mathbf{n} \\cdot \\left(\\delta\\mathbf{u}_1 + \\delta\\mathbf{u}_2\\right) = \\left(\\frac{pL}{2}\\mathbf{n}\\right) \\cdot \\delta\\mathbf{u}_1 + \\left(\\frac{pL}{2}\\mathbf{n}\\right) \\cdot \\delta\\mathbf{u}_2\n$$\n根据定义，$\\delta W_{\\text{ext}} = \\mathbf{f}_1 \\cdot \\delta\\mathbf{u}_1 + \\mathbf{f}_2 \\cdot \\delta\\mathbf{u}_2$。比较各项，我们发现每个节点 $i \\in \\{1,2\\}$ 的单元级外荷载向量为 $\\mathbf{f}_i = \\frac{pL}{2}\\mathbf{n}$。\n\n**第2部分：一致线性化（荷载刚度）**\n为了求出荷载刚度矩阵，我们必须计算节点力 $\\mathbf{f}_i$ 相对于节点位移的Gateaux导数，其方向为增量位移 $(\\Delta\\mathbf{u}_1, \\Delta\\mathbf{u}_2)$。\n$$\n\\Delta\\mathbf{f}_i = D[\\mathbf{f}_i](\\mathbf{u})[\\Delta\\mathbf{u}] = \\frac{d}{d\\epsilon}\\bigg|_{\\epsilon=0} \\mathbf{f}_i(\\mathbf{u} + \\epsilon\\Delta\\mathbf{u})\n$$\n由于 $\\mathbf{f}_i = \\frac{p}{2}L\\mathbf{n}$，$L$ 和 $\\mathbf{n}$ 都依赖于 $\\mathbf{u}$。使用乘法法则：\n$$\n\\Delta\\mathbf{f}_i = \\frac{p}{2}\\left( (\\Delta L)\\mathbf{n} + L(\\Delta\\mathbf{n}) \\right)\n$$\n我们对 $L$ 和 $\\mathbf{n}$ 进行线性化。设 $\\mathbf{a} = (\\mathbf{X}_2-\\mathbf{X}_1) + (\\mathbf{u}_2-\\mathbf{u}_1) = \\mathbf{A} + \\mathbf{a}_u$。增量为 $\\Delta\\mathbf{a} = \\Delta\\mathbf{u}_2-\\Delta\\mathbf{u}_1$。\n长度为 $L = (\\mathbf{a}\\cdot\\mathbf{a})^{1/2}$。其变分为 $\\Delta L = \\frac{\\mathbf{a} \\cdot \\Delta\\mathbf{a}}{L} = \\frac{\\mathbf{a}}{L} \\cdot \\Delta\\mathbf{a} = \\mathbf{t} \\cdot \\Delta\\mathbf{a}$。\n单位切线为 $\\mathbf{t}=\\mathbf{a}/L$。其变分为 $\\Delta \\mathbf{t} = \\frac{\\Delta\\mathbf{a}}{L} - \\frac{\\mathbf{a}}{L^2}\\Delta L = \\frac{1}{L} \\left(\\Delta\\mathbf{a} - \\mathbf{t}(\\mathbf{t}\\cdot\\Delta\\mathbf{a})\\right) = \\frac{1}{L}(\\mathbf{I} - \\mathbf{t}\\otimes\\mathbf{t})\\Delta\\mathbf{a}$。\n单位法线为 $\\mathbf{n}=\\mathbf{P}\\mathbf{t}$。其变分为 $\\Delta\\mathbf{n} = \\mathbf{P}\\Delta\\mathbf{t} = \\frac{1}{L}\\mathbf{P}(\\mathbf{I} - \\mathbf{t}\\otimes\\mathbf{t})\\Delta\\mathbf{a}$。\n将 $\\Delta L$ 和 $\\Delta\\mathbf{n}$ 代入 $\\Delta\\mathbf{f}_i$ 的表达式中：\n$$\n\\Delta\\mathbf{f}_i = \\frac{p}{2} \\left( (\\mathbf{t} \\cdot \\Delta\\mathbf{a})\\mathbf{n} + L \\left( \\frac{1}{L}\\mathbf{P}(\\mathbf{I} - \\mathbf{t}\\otimes\\mathbf{t})\\Delta\\mathbf{a} \\right) \\right)\n$$\n使用张量积恒等式 $(\\mathbf{v}\\cdot\\mathbf{w})\\mathbf{u} = (\\mathbf{u}\\otimes\\mathbf{v})\\mathbf{w}$，我们将 $(\\mathbf{t} \\cdot \\Delta\\mathbf{a})\\mathbf{n}$ 写为 $(\\mathbf{n}\\otimes\\mathbf{t})\\Delta\\mathbf{a}$。\n$$\n\\Delta\\mathbf{f}_i = \\frac{p}{2} \\left[ (\\mathbf{n}\\otimes\\mathbf{t}) + \\mathbf{P}(\\mathbf{I} - \\mathbf{t}\\otimes\\mathbf{t}) \\right] \\Delta\\mathbf{a}\n$$\n这与问题陈述中给出的一致线性化表达式相符，其中 $\\Delta\\mathbf{a} = \\Delta\\mathbf{u}_2 - \\Delta\\mathbf{u}_1$。\n\n**第3部分：针对参考方向的具体化**\n对于方向 $\\mathbf{t} \\approx (1,0)^{\\mathsf{T}}$ 和 $\\mathbf{n} \\approx (0,1)^{\\mathsf{T}}$：\n- $\\mathbf{t}\\otimes\\mathbf{t} \\approx \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} \\begin{pmatrix} 1  0 \\end{pmatrix} = \\begin{pmatrix} 1  0 \\\\ 0  0 \\end{pmatrix}$\n- $\\mathbf{n}\\otimes\\mathbf{t} \\approx \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} \\begin{pmatrix} 1  0 \\end{pmatrix} = \\begin{pmatrix} 0  0 \\\\ 1  0 \\end{pmatrix}$\n- $\\mathbf{I} - \\mathbf{t}\\otimes\\mathbf{t} \\approx \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} - \\begin{pmatrix} 1  0 \\\\ 0  0 \\end{pmatrix} = \\begin{pmatrix} 0  0 \\\\ 0  1 \\end{pmatrix}$\n- $\\mathbf{P}(\\mathbf{I} - \\mathbf{t}\\otimes\\mathbf{t}) \\approx \\begin{pmatrix} 0  -1 \\\\ 1  0 \\end{pmatrix} \\begin{pmatrix} 0  0 \\\\ 0  1 \\end{pmatrix} = \\begin{pmatrix} 0  -1 \\\\ 0  0 \\end{pmatrix}$\n方括号中的项变为：\n$$\n(\\mathbf{n}\\otimes\\mathbf{t}) + \\mathbf{P}(\\mathbf{I} - \\mathbf{t}\\otimes\\mathbf{t}) \\approx \\begin{pmatrix} 0  0 \\\\ 1  0 \\end{pmatrix} + \\begin{pmatrix} 0  -1 \\\\ 0  0 \\end{pmatrix} = \\begin{pmatrix} 0  -1 \\\\ 1  0 \\end{pmatrix} = \\mathbf{P}\n$$\n因此，一致荷载刚度简化为 $\\Delta\\mathbf{f}_i = \\frac{p}{2}\\mathbf{P}(\\Delta\\mathbf{u}_2 - \\Delta\\mathbf{u}_1)$，这证实了问题陈述。\n\n**第4部分：非一致形式和线性化**\n问题要求我们对一个非一致形式进行线性化，其中节点力取为 $\\mathbf{f}_i^{\\text{inc}} = \\frac{pL}{2}\\mathbf{N}$，这里 $\\mathbf{N}$ 是固定的参考法线，$L$ 是当前长度。\n线性化结果为 $\\Delta\\mathbf{f}_i^{\\text{inc}} = \\frac{p}{2}(\\Delta L)\\mathbf{N}$。\n使用先前推导的表达式 $\\Delta L = \\mathbf{t} \\cdot (\\Delta\\mathbf{u}_2 - \\Delta\\mathbf{u}_1)$：\n$$\n\\Delta\\mathbf{f}_i^{\\text{inc}} = \\frac{p}{2} (\\mathbf{t} \\cdot (\\Delta\\mathbf{u}_2 - \\Delta\\mathbf{u}_1)) \\mathbf{N} = \\frac{p}{2} (\\mathbf{N}\\otimes\\mathbf{t})(\\Delta\\mathbf{u}_2 - \\Delta\\mathbf{u}_1)\n$$\n这证实了非一致荷载刚度的表达式。\n\n**第5部分：伪刚度分量的计算**\n我们被要求计算 $k_{\\text{spur}}$，其通过关系式 $k_{\\text{spur}} = \\frac{p}{2}\\,\\big([\\mathbf{B}_{\\text{inc}} - \\mathbf{B}]_{1,2}\\big)$ 定义。该系数表示将相对垂直位移增量 $\\Delta a_y$ 与水平力增量 $\\Delta f_{1,x}$ 耦合的交叉刚度项中的误差。\n根据推导，将 $\\Delta\\mathbf{f}_i$ 与 $\\Delta\\mathbf{a}$ 关联的荷载刚度矩阵为：\n- 一致的：$\\mathbf{K}_{\\text{load}} = \\frac{p}{2} \\left[ (\\mathbf{n}\\otimes\\mathbf{t}) + \\mathbf{P}(\\mathbf{I} - \\mathbf{t}\\otimes\\mathbf{t}) \\right] = \\frac{p}{2}\\mathbf{B}$。对于指定方向，$\\mathbf{B} = \\mathbf{P}$。\n- 非一致的：$\\mathbf{K}_{\\text{load}}^{\\text{inc}} = \\frac{p}{2} (\\mathbf{N}\\otimes\\mathbf{t}) = \\frac{p}{2}\\mathbf{B}_{\\text{inc}}$。\n\n我们对方向 $\\mathbf{t} \\approx (1,0)^{\\mathsf{T}}$ 和 $\\mathbf{N} \\approx (0,1)^{\\mathsf{T}}$ 评估 $\\mathbf{B}$ 和 $\\mathbf{B}_{\\text{inc}}$：\n$$\n\\mathbf{B} = \\mathbf{P} = \\begin{pmatrix} 0  -1 \\\\ 1  0 \\end{pmatrix}\n$$\n$$\n\\mathbf{B}_{\\text{inc}} = \\mathbf{N}\\otimes\\mathbf{t} \\approx \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} \\begin{pmatrix} 1  0 \\end{pmatrix} = \\begin{pmatrix} 0  0 \\\\ 1  0 \\end{pmatrix}\n$$\n现在，我们计算差分矩阵 $\\mathbf{B}_{\\text{inc}} - \\mathbf{B}$：\n$$\n\\mathbf{B}_{\\text{inc}} - \\mathbf{B} = \\begin{pmatrix} 0  0 \\\\ 1  0 \\end{pmatrix} - \\begin{pmatrix} 0  -1 \\\\ 1  0 \\end{pmatrix} = \\begin{pmatrix} 0 - 0  0 - (-1) \\\\ 1 - 1  0 - 0 \\end{pmatrix} = \\begin{pmatrix} 0  1 \\\\ 0  0 \\end{pmatrix}\n$$\n该矩阵的(1,2)分量是 $[\\mathbf{B}_{\\text{inc}} - \\mathbf{B}]_{1,2} = 1$。\n将此代入给定的 $k_{\\text{spur}}$ 公式中：\n$$\nk_{\\text{spur}} = \\frac{p}{2} \\big( [\\mathbf{B}_{\\text{inc}} - \\mathbf{B}]_{1,2} \\big) = \\frac{p}{2} \\cdot 1 = \\frac{p}{2}\n$$\n量 $p$ 是单位长度的力（单位为 $\\mathrm{N}\\,\\mathrm{m}^{-1}$），所以 $k_{\\text{spur}}$ 的单位是刚度，这是一致的。", "answer": "$$\\boxed{\\frac{p}{2}}$$", "id": "3604053"}]}