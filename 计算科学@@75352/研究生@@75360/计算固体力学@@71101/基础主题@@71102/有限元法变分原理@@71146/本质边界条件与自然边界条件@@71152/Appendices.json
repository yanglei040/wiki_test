{"hands_on_practices": [{"introduction": "在有限元分析中，施加指定的位移，即本质边界条件，是一项基本任务。本练习将对两种最常见的处理方法——强施加（消元）法和弱施加（罚）法——进行直接的动手实践比较。通过为一个简单的一维杆实现这两种方法，您将通过数值验证它们之间的关系，并学习如何在每个框架中一致地计算反作用力 [@problem_id:3563196]。", "problem": "考虑一根长度为 $L$、具有恒定横截面积 $A$ 和杨氏模量 $E$ 的一维线性弹性杆。令 $x \\in [0,L]$ 表示轴向坐标。未知位移场为 $u(x)$（单位为米）。该杆受到均匀体力密度 $b$（单位为牛顿/米）和在 $x=L$ 处施加的端点力 $F$（单位为牛顿）的作用。轴向应变为 $\\varepsilon(x) = u'(x)$，轴向应力为 $\\sigma(x) = E \\varepsilon(x)$。乘积 $EA$（单位为牛顿）是杆的轴向刚度。\n\n我们研究两种方法来施加 $x=0$ 处形式为 $u(0) = \\bar{u}$ 的本质（Dirichlet）边界条件，其中 $\\bar{u}$ 是一个给定的位移（单位为米）：\n- 强施加：在第一个节点上对离散位移精确施加 Dirichlet 条件。\n- 弱（罚）施加：通过在离散系统中增加一个大小为 $\\gamma$（单位为牛顿/米）的罚项来施加 Dirichlet 条件，该罚项惩罚 $u(0)$ 与 $\\bar{u}$ 之间的偏差。\n\n在 $x=L$ 处的自然（Neumann）边界条件是施加的端点力 $F$（单位为牛顿）。体力密度 $b$ 构成沿杆的分布荷载。控制弱形式建立在虚功原理之上：对于所有运动学容许的虚位移，内虚功等于外虚功。\n\n您的任务：\n1. 使用有限元法（FEM），将杆离散为 $n$ 个等长的线性单元，节点为 $x_i = i h$，$i=0,\\dots,n$，其中 $h = L/n$ 是单元长度。使用标准的线性单元公式组装全局刚度矩阵 $K \\in \\mathbb{R}^{(n+1) \\times (n+1)}$ 和荷载向量 $f \\in \\mathbb{R}^{n+1}$：\n   - 每个单元的单元刚度矩阵 $k_e = \\dfrac{EA}{h} \\begin{bmatrix} 1  -1 \\\\ -1  1 \\end{bmatrix}$。\n   - 每个单元由均布体力引起的一致单元荷载向量 $f_e = \\dfrac{b h}{2} \\begin{bmatrix} 1 \\\\ 1 \\end{bmatrix}$。\n   - 端点力 $F$ 添加到最后一个节点：$f_{n} \\leftarrow f_{n} + F$。\n2. 强施加 $u(0) = \\bar{u}$：在线性系统中消去第一个自由度以求解剩余的未知数，然后构建完整的位移向量 $u^{\\star}$，其中 $u^{\\star}_0 = \\bar{u}$。将 $x=0$ 处的反作用力定义为平衡第一个节点处外荷载的内节点力：\n   $$ r_{\\infty} := \\left( K u^{\\star} - f \\right)_0 \\quad \\text{单位为牛顿。} $$\n3. 罚施加 $u(0) = \\bar{u}$：构建罚化系统\n   $$ (K + \\gamma e_0 e_0^{\\top}) u_{\\gamma} = f + \\gamma \\bar{u} \\, e_0, $$\n   其中 $e_0 \\in \\mathbb{R}^{n+1}$ 是第一个分量为 $1$ 其余分量为零的单位向量，$\\gamma > 0$ 是罚参数。求解 $u_{\\gamma}$，并将罚反作用力定义为\n   $$ r_{\\gamma} := \\gamma \\left( \\bar{u} - u_{\\gamma,0} \\right) \\quad \\text{单位为牛顿，} $$\n   其中 $u_{\\gamma,0}$ 是 $u_{\\gamma}$ 的第一个分量。同时定义 Dirichlet 违背量\n   $$ v_{\\gamma} := \\left| u_{\\gamma,0} - \\bar{u} \\right| \\quad \\text{单位为米。} $$\n4. 通过比较 $r_{\\gamma}$ 和 $r_{\\infty}$ 来验证反作用力计算的一致性。具体来说，对于每个测试用例，计算绝对反作用力误差\n   $$ e_{\\gamma} := \\left| r_{\\gamma} - r_{\\infty} \\right| \\quad \\text{单位为牛顿} $$\n   和 Dirichlet 违背量 $v_{\\gamma}$（单位为米）。\n\n程序必须为以下参数集测试套件实现上述步骤。每个测试用例是一个元组 $(L, E, A, n, F, b, \\bar{u}, \\gamma)$，单位如指定：\n- 测试 1（正常情况，小罚参数）：$(1.0 \\text{ m}, 210\\times 10^{9} \\text{ Pa}, 1.0\\times 10^{-4} \\text{ m}^2, 20, 1000 \\text{ N}, 0 \\text{ N/m}, 0 \\text{ m}, 1.0\\times 10^{3} \\text{ N/m})$。\n- 测试 2（正常情况，中等罚参数）：$(1.0 \\text{ m}, 210\\times 10^{9} \\text{ Pa}, 1.0\\times 10^{-4} \\text{ m}^2, 20, 1000 \\text{ N}, 0 \\text{ N/m}, 0 \\text{ m}, 1.0\\times 10^{6} \\text{ N/m})$。\n- 测试 3（极限行为，非常大的罚参数）：$(1.0 \\text{ m}, 210\\times 10^{9} \\text{ Pa}, 1.0\\times 10^{-4} \\text{ m}^2, 20, 1000 \\text{ N}, 0 \\text{ N/m}, 0 \\text{ m}, 1.0\\times 10^{12} \\text{ N/m})$。\n- 测试 4（带体力）：$(1.0 \\text{ m}, 70\\times 10^{9} \\text{ Pa}, 5.0\\times 10^{-5} \\text{ m}^2, 30, 500 \\text{ N}, 200 \\text{ N/m}, 0 \\text{ m}, 1.0\\times 10^{6} \\text{ N/m})$。\n- 测试 5（软杆）：$(1.0 \\text{ m}, 1.0\\times 10^{6} \\text{ Pa}, 1.0\\times 10^{-6} \\text{ m}^2, 10, 1.0 \\text{ N}, 1.0 \\text{ N/m}, 0 \\text{ m}, 1.0\\times 10^{6} \\text{ N/m})$。\n\n所有反作用力以牛顿表示，所有位移以米表示。不涉及角度。您的程序应生成单行输出，包含一个由方括号括起来的逗号分隔列表。对于每个测试用例，按顺序附加四个数字：$r_{\\infty}$、$r_{\\gamma}$、$e_{\\gamma}$、$v_{\\gamma}$。因此，最终输出是一个包含20个数字的扁平列表，对应于5个测试用例。", "solution": "该问题陈述被评估为具有科学依据、适定且客观。它展示了有限元法（FEM）在一维线性弹性问题上的标准应用，这是计算固体力学中的一个基本课题。所提供的物理参数、控制方程、单元公式以及边界条件施加（强施加法和罚方法）的定义均与既有理论一致。该问题是自洽的，为每个测试用例提供了所有必要的数据。因此，可以构建一个完整且合理的解。\n\n求解过程分四个阶段进行：\n1.  连续问题的离散化及全局线性方程组的组装。\n2.  使用强（消元）法施加本质边界条件并计算反作用力。\n3.  使用弱（罚）法施加本质边界条件并计算近似反作用力和边界位移违背量。\n4.  比较两种方法获得的反作用力。\n\n**1. 有限元离散化与组装**\n\n长度为 $L$ 的一维域 $x \\in [0, L]$ 被离散为 $n$ 个等长 $h = L/n$ 的线性有限元。这产生了 $n+1$ 个节点，位置在 $x_i = i h$，$i=0, 1, \\dots, n$。位移场 $u(x)$ 在这些单元上被近似为分段线性函数。未知节点位移被收集在向量 $u \\in \\mathbb{R}^{n+1}$ 中。\n\n虚功原理导出一个线性方程组 $K u = f$，其中 $K$ 是全局刚度矩阵，$f$ 是全局荷载向量。它们由单元级的贡献组装而成。\n\n对于每个单元 $e$（连接局部节点 $0$ 和 $1$，对应于全局节点 $i$ 和 $i+1$），单元刚度矩阵 $k_e$ 由下式给出：\n$$\nk_e = \\frac{EA}{h} \\begin{bmatrix} 1  -1 \\\\ -1  1 \\end{bmatrix}\n$$\n其中 $E$ 是杨氏模量，$A$ 是横截面积，$h$ 是单元长度。\n\n由均匀体力 $b$ 引起的一致单元荷载向量 $f_e$ 为：\n$$\nf_e = \\frac{b h}{2} \\begin{bmatrix} 1 \\\\ 1 \\end{bmatrix}\n$$\n\n全局刚度矩阵 $K \\in \\mathbb{R}^{(n+1) \\times (n+1)}$ 和荷载向量 $f \\in \\mathbb{R}^{n+1}$ 被初始化为零矩阵。然后，对于每个跨越全局节点 $i$ 和 $i+1$ 的单元 $e$（$i=0, \\dots, n-1$），$k_e$ 和 $f_e$ 的条目被添加到 $K$ 和 $f$ 的相应位置。这是标准的“组装”过程。例如，$K_{i,i}$ 接收来自单元 $i-1$ 和 $i$ 的贡献。\n\n最后，将 $x=L$（节点 $n$）处的外部点荷载 $F$ 添加到全局荷载向量的最后一个分量上：$f_n \\leftarrow f_n + F$。\n\n**2. 本质边界条件的强施加**\n\n本质（Dirichlet）边界条件是 $u(0) = \\bar{u}$。在离散系统中，这对应于将第一个节点的位移设置为给定值：$u_0 = \\bar{u}$。这是“强”施加，因为该条件被精确满足。\n\n全局系统 $K u = f$ 可以根据已知和未知的自由度（DOFs）进行分块。这里，$u_0$ 是已知的，剩余的位移 $u_R = [u_1, u_2, \\dots, u_n]^\\top$ 是未知的。\n$$\n\\begin{bmatrix}\nK_{00}  K_{0R} \\\\\nK_{R0}  K_{RR}\n\\end{bmatrix}\n\\begin{Bmatrix}\nu_0 \\\\\nu_R\n\\end{Bmatrix}\n=\n\\begin{Bmatrix}\nf_0 \\\\\nf_R\n\\end{Bmatrix}\n$$\n从该分块系统的第二行，我们可以求解未知位移 $u_R$：\n$$\nK_{R0} u_0 + K_{RR} u_R = f_R \\implies K_{RR} u_R = f_R - K_{R0} u_0\n$$\n由于 $u_0 = \\bar{u}$ 是已知的，我们求解规模为 $n \\times n$ 的简化系统以得到 $u_R$。设该解为 $u_R^{\\star}$。然后，通过组合给定值和计算值来构建完整的位移向量，记为 $u^{\\star}$：$u^{\\star} = [\\bar{u}, (u_R^{\\star})^\\top]^\\top$。\n\n约束节点（$x=0$）处的反作用力是维持规定位移所需的力。它是在求解所有位移*之后*，从原始系统的第一行计算得出的：\n$$\nr_{\\infty} := (K u^{\\star} - f)_0 = K_{00} u^{\\star}_0 + K_{0R} u^{\\star}_R - f_0\n$$\n下标 $\\infty$ 概念上表示这是精确的反作用力，对应于无穷大的罚参数。\n\n**3. 本质边界条件的罚施加**\n\n罚方法以近似的、“弱”意义上施加边界条件 $u_0 = \\bar{u}$。其思想是在系统节点0处增加一个刚度为 $\\gamma$ 的大“弹簧”，将该节点拉向位置 $\\bar{u}$。这在数学上通过向势能泛函增加一个罚项 $\\frac{1}{2}\\gamma(u_0 - \\bar{u})^2$ 来实现。\n\n这一修改导出一个修改后的线性系统：\n$$\nK_{\\gamma} u_{\\gamma} = f_{\\gamma}\n$$\n其中 $K_{\\gamma}$ 和 $f_{\\gamma}$ 分别是罚化刚度矩阵和荷载向量。它们是通过在对应于边界条件的自由度（索引为0）处修改原始系统而形成的：\n$$\nK_{\\gamma} = K + \\gamma e_0 e_0^{\\top} \\quad \\text{（即 } K_{\\gamma,00} = K_{00} + \\gamma \\text{）}\n$$\n$$\nf_{\\gamma} = f + \\gamma \\bar{u} \\, e_0 \\quad \\text{（即 } f_{\\gamma,0} = f_0 + \\gamma \\bar{u} \\text{）}\n$$\n这里，$e_0$ 是索引0处为1、其余处为零的标准基向量。这个修改后的 $(n+1) \\times (n+1)$ 系统是非奇异的（如果原始的简化系统是非奇异的），可以直接求解得到完整的位移向量 $u_{\\gamma}$。\n\n罚化系统的第一个方程是 $(K_{00} + \\gamma) u_{\\gamma,0} + \\sum_{j=1}^{n} K_{0j} u_{\\gamma,j} = f_0 + \\gamma \\bar{u}$。重新整理得到 $\\gamma (\\bar{u} - u_{\\gamma,0}) = \\sum_{j=0}^{n} K_{0j} u_{\\gamma,j} - f_0$，其中右侧代表内节点力。这启发了罚反作用力的定义：\n$$\nr_{\\gamma} := \\gamma \\left( \\bar{u} - u_{\\gamma,0} \\right)\n$$\n与强施加不同，计算出的位移 $u_{\\gamma,0}$ 不会精确等于 $\\bar{u}$。这个差异的大小就是 Dirichlet 违背量：\n$$\nv_{\\gamma} := \\left| u_{\\gamma,0} - \\bar{u} \\right|\n$$\n可以证明，当罚参数 $\\gamma \\to \\infty$ 时，$u_{\\gamma} \\to u^{\\star}$ 且 $r_{\\gamma} \\to r_{\\infty}$。\n\n**4. 误差分析**\n\n为了验证罚方法向强解的收敛性，我们计算反作用力之间的绝对误差：\n$$\ne_{\\gamma} := \\left| r_{\\gamma} - r_{\\infty} \\right|\n$$\n所提供的测试用例探讨了罚参数 $\\gamma$ 的选择如何影响计算的反作用力的准确性（由 $e_{\\gamma}$ 衡量）和本质边界条件的满足程度（由 $v_{\\gamma}$ 衡量）。较大的 $\\gamma$ 通常会导致 $v_{\\gamma}$ 和 $e_{\\gamma}$ 的值更小，但如果它相对于 $K$ 的对角线元素过大，可能会导致数值病态。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves a 1D linear elastic bar problem using FEM with both strong and penalty\n    enforcement of Dirichlet boundary conditions and compares the results.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (L, E, A, n, F, b, u_bar, gamma)\n    test_cases = [\n        # (L, E, A, n, F, b, u_bar, gamma)\n        (1.0, 210e9, 1.0e-4, 20, 1000.0, 0.0, 0.0, 1.0e3),\n        (1.0, 210e9, 1.0e-4, 20, 1000.0, 0.0, 0.0, 1.0e6),\n        (1.0, 210e9, 1.0e-4, 20, 1000.0, 0.0, 0.0, 1.0e12),\n        (1.0, 70e9, 5.0e-5, 30, 500.0, 200.0, 0.0, 1.0e6),\n        (1.0, 1.0e6, 1.0e-6, 10, 1.0, 1.0, 0.0, 1.0e6),\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        L, E, A, n, F, b, u_bar, gamma = case\n\n        # 1. Discretization and Assembly\n        h = L / n\n        n_nodes = n + 1\n        \n        # Initialize global stiffness matrix and load vector\n        K_global = np.zeros((n_nodes, n_nodes))\n        f_global = np.zeros(n_nodes)\n        \n        # Element properties\n        axial_stiffness = E * A\n        k_elem_val = axial_stiffness / h\n        k_elem = k_elem_val * np.array([[1, -1], [-1, 1]])\n        \n        f_elem_val = b * h / 2\n        f_elem = f_elem_val * np.array([1, 1])\n\n        # Assembly loop\n        for i in range(n):\n            # Global node indices for element i\n            nodes = [i, i + 1]\n            # Add element contributions to global system\n            K_global[np.ix_(nodes, nodes)] += k_elem\n            f_global[nodes] += f_elem\n            \n        # Apply natural boundary condition (point force F at x=L)\n        f_global[n] += F\n\n        # 2. Strong Enforcement\n        # Partition the system: K u = f\n        K_RR = K_global[1:, 1:]\n        f_R = f_global[1:]\n        K_R0 = K_global[1:, 0]\n\n        # Solve for unknown displacements: K_RR * u_R = f_R - K_R0 * u_bar\n        rhs_strong = f_R - K_R0 * u_bar\n        u_R_star = np.linalg.solve(K_RR, rhs_strong)\n        \n        # Reconstruct the full displacement vector\n        u_star = np.concatenate(([u_bar], u_R_star))\n\n        # Calculate reaction force r_inf = (K*u_star - f)[0]\n        r_inf = (K_global @ u_star - f_global)[0]\n\n        # 3. Penalty Enforcement\n        # Form the penalized system\n        K_penalty = K_global.copy()\n        K_penalty[0, 0] += gamma\n        \n        f_penalty = f_global.copy()\n        f_penalty[0] += gamma * u_bar\n        \n        # Solve for displacements u_gamma\n        u_gamma = np.linalg.solve(K_penalty, f_penalty)\n        u_gamma_0 = u_gamma[0]\n\n        # Calculate penalty reaction r_gamma\n        r_gamma = gamma * (u_bar - u_gamma_0)\n        \n        # Calculate Dirichlet violation v_gamma\n        v_gamma = np.abs(u_gamma_0 - u_bar)\n\n        # 4. Comparison\n        # Calculate absolute reaction error e_gamma\n        e_gamma = np.abs(r_gamma - r_inf)\n        \n        # Append results for this test case\n        results.extend([r_inf, r_gamma, e_gamma, v_gamma])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{x:.8e}' for x in results)}]\")\n\nsolve()\n```", "id": "3563196"}, {"introduction": "虽然罚方法为施加本质边界条件提供了一种简便的途径，但它并非没有挑战。本练习将深入探讨其主要缺点：当罚参数 $\\alpha$ 变得非常大时，可能引发的数值病态问题。通过解析推导，您将发现刚度矩阵的条件数如何直接受罚参数影响，从而为理解基于罚方法的有限元系统的稳定性提供关键的洞察 [@problem_id:3563169]。", "problem": "考虑一根长度为 $h$、杨氏模量为 $E$、单位横截面积的一维、等截面、线弹性杆，占据区间 $x \\in [0,h]$。其位移 $u(x)$ 由基于虚功原理推导的平衡方程决定，其对称双线性形式为\n$$\na(u,v) \\;=\\; \\int_{0}^{h} E \\, u'(x)\\, v'(x)\\, dx \\;+\\; \\alpha\\, u(0)\\, v(0),\n$$\n且外功的线性泛函设为零。其中 $\\alpha > 0$ 的项通过模拟一个连接在 $x=0$ 处的非常刚性的弹簧，来惩罚对本质边界条件 $u(0)=0$ 的违反，而右端 $x=h$ 为无应力端，这是一个自然边界条件。\n\n使用标准的双节点线性有限元对杆进行离散化，节点位移为 $u_1 \\approx u(0)$ 和 $u_2 \\approx u(h)$。利用双线性形式的定义，组装与二次型 $a(\\cdot,\\cdot)$ 对应的离散 $2 \\times 2$ 刚度矩阵，并观察罚刚度 $\\alpha$ 是如何进入代数系统的。将得到的矩阵记为 $K(\\alpha,E,h)$，并将其在欧几里得范数下的条件数（谱条件数）定义为\n$$\n\\kappa_2\\big(K(\\alpha,E,h)\\big) \\;=\\; \\frac{\\lambda_{\\max}\\big(K(\\alpha,E,h)\\big)}{\\lambda_{\\min}\\big(K(\\alpha,E,h)\\big)},\n$$\n其中 $\\lambda_{\\max}$ 和 $\\lambda_{\\min}$ 分别是最大和最小特征值。从第一性原理出发，不假定任何已有的特征值或条件数公式，推导出 $K(\\alpha,E,h)$ 两个特征值的精确解析表达式，然后获得当 $E$ 和 $h$ 保持不变时 $\\alpha \\to \\infty$ 的主阶渐近表达式。\n\n你的最终答案必须是条件数增长的主阶渐近表达式，表示为 $\\alpha$、$E$ 和 $h$ 的闭式函数。最终答案中不应包含任何单位。条件数是无量纲的。", "solution": "问题陈述已经过验证，并被确定为有效。它具有科学依据，是适定的、客观的，并且不包含任何矛盾或模糊之处。我们可以继续进行解答。\n\n问题要求推导一维杆单元刚度矩阵条件数的主阶渐近表达式，其中本质边界条件通过罚方法施加。\n\n首先，我们使用一个双节点线性有限元在域 $x \\in [0, h]$ 上离散化位移场 $u(x)$。节点位于 $x=0$ 和 $x=h$。节点位移分别用 $u_1$ 和 $u_2$ 表示。插值位移场由下式给出：\n$$u(x) = N_1(x) u_1 + N_2(x) u_2,$$\n其中 $N_1(x)$ 和 $N_2(x)$ 是线性形函数。对于在 $[0, h]$ 上定义的长度为 $h$ 的单元，它们是：\n$$N_1(x) = 1 - \\frac{x}{h}$$\n$$N_2(x) = \\frac{x}{h}$$\n形函数对 $x$ 的导数是常数：\n$$N_1'(x) = -\\frac{1}{h}$$\n$$N_2'(x) = \\frac{1}{h}$$\n\n刚度矩阵 $K$ 是一个 $2 \\times 2$ 矩阵，其分量 $K_{ij}$ 由给定的对称双线性形式 $a(\\cdot,\\cdot)$ 应用于基函数来定义：$K_{ij} = a(N_j, N_i)$。\n双线性形式为\n$$a(u,v) = \\int_{0}^{h} E \\, u'(x)\\, v'(x)\\, dx \\;+\\; \\alpha\\, u(0)\\, v(0).$$\n我们计算刚度矩阵 $K(\\alpha, E, h)$ 的四个分量。\n\n对于 $K_{11}$：\n$$K_{11} = a(N_1, N_1) = \\int_{0}^{h} E \\, (N_1'(x))^2 \\, dx + \\alpha \\, N_1(0) \\, N_1(0).$$\n在 $x=0$ 处，我们有 $N_1(0)=1$ 和 $N_2(0)=0$。\n$$K_{11} = \\int_{0}^{h} E \\left(-\\frac{1}{h}\\right)^2 dx + \\alpha (1)(1) = \\frac{E}{h^2} \\int_{0}^{h} dx + \\alpha = \\frac{E}{h^2} [x]_0^h + \\alpha = \\frac{E}{h} + \\alpha.$$\n\n对于 $K_{12}$：\n$$K_{12} = a(N_2, N_1) = \\int_{0}^{h} E \\, N_2'(x) \\, N_1'(x) \\, dx + \\alpha \\, N_2(0) \\, N_1(0).$$\n$$K_{12} = \\int_{0}^{h} E \\left(\\frac{1}{h}\\right) \\left(-\\frac{1}{h}\\right) dx + \\alpha (0)(1) = -\\frac{E}{h^2} \\int_{0}^{h} dx = -\\frac{E}{h}.$$\n\n对于 $K_{21}$：\n由于双线性形式是对称的，所以 $K_{21} = a(N_1, N_2) = K_{12} = -E/h$。\n\n对于 $K_{22}$：\n$$K_{22} = a(N_2, N_2) = \\int_{0}^{h} E \\, (N_2'(x))^2 \\, dx + \\alpha \\, N_2(0) \\, N_2(0).$$\n$$K_{22} = \\int_{0}^{h} E \\left(\\frac{1}{h}\\right)^2 dx + \\alpha (0)(0) = \\frac{E}{h^2} \\int_{0}^{h} dx = \\frac{E}{h}.$$\n\n组装这些分量，刚度矩阵为：\n$$K(\\alpha, E, h) = \\begin{pmatrix} \\frac{E}{h} + \\alpha  -\\frac{E}{h} \\\\ -\\frac{E}{h}  \\frac{E}{h} \\end{pmatrix}.$$\n通过将力向量的相应分量设为零，来隐式地满足 $x=h$ 处无应力端的自然边界条件，这与问题陈述中外功的线性泛函为零是一致的。\n\n接下来，我们求 $K$ 的特征值 $\\lambda$。特征值是特征方程 $\\det(K - \\lambda I) = 0$ 的根，其中 $I$ 是单位矩阵。\n$$\\det \\begin{pmatrix} \\frac{E}{h} + \\alpha - \\lambda  -\\frac{E}{h} \\\\ -\\frac{E}{h}  \\frac{E}{h} - \\lambda \\end{pmatrix} = 0.$$\n展开行列式得到特征多项式：\n$$\\left(\\frac{E}{h} + \\alpha - \\lambda\\right)\\left(\\frac{E}{h} - \\lambda\\right) - \\left(-\\frac{E}{h}\\right)^2 = 0$$\n$$\\lambda^2 - \\left(2\\frac{E}{h} + \\alpha\\right)\\lambda + \\alpha\\frac{E}{h} = 0.$$\n这是一个关于 $\\lambda$ 的二次方程。我们使用二次方程求根公式求解 $\\lambda$：\n$$\\lambda = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a},$$\n其中 $a=1$，$b = -(2E/h + \\alpha)$，$c = \\alpha E/h$。\n$$\\lambda = \\frac{ (2\\frac{E}{h} + \\alpha) \\pm \\sqrt{\\left(2\\frac{E}{h} + \\alpha\\right)^2 - 4(1)\\left(\\alpha\\frac{E}{h}\\right)} }{2}.$$\n让我们简化平方根下的项（判别式）：\n$$\\left(2\\frac{E}{h} + \\alpha\\right)^2 - 4\\alpha\\frac{E}{h} = \\left(4\\left(\\frac{E}{h}\\right)^2 + 4\\alpha\\frac{E}{h} + \\alpha^2\\right) - 4\\alpha\\frac{E}{h} = 4\\left(\\frac{E}{h}\\right)^2 + \\alpha^2.$$\n所以，精确的特征值是：\n$$\\lambda = \\frac{1}{2} \\left[ \\left(2\\frac{E}{h} + \\alpha\\right) \\pm \\sqrt{4\\left(\\frac{E}{h}\\right)^2 + \\alpha^2} \\right].$$\n最大和最小特征值是：\n$$\\lambda_{\\max} = \\frac{1}{2} \\left[ \\left(2\\frac{E}{h} + \\alpha\\right) + \\sqrt{4\\left(\\frac{E}{h}\\right)^2 + \\alpha^2} \\right]$$\n$$\\lambda_{\\min} = \\frac{1}{2} \\left[ \\left(2\\frac{E}{h} + \\alpha\\right) - \\sqrt{4\\left(\\frac{E}{h}\\right)^2 + \\alpha^2} \\right].$$\n\n现在，我们求当 $\\alpha \\to \\infty$ 时这些特征值的主阶渐近表达式。我们通过提出 $\\alpha$ 来分析平方根项：\n$$\\sqrt{4\\left(\\frac{E}{h}\\right)^2 + \\alpha^2} = \\alpha \\sqrt{1 + 4\\left(\\frac{E}{h\\alpha}\\right)^2}.$$\n对小量 $x$ 使用泰勒展开 $\\sqrt{1+x} = 1 + \\frac{1}{2}x + O(x^2)$，其中当 $\\alpha \\to \\infty$ 时 $x = 4(E/(h\\alpha))^2 \\to 0$：\n$$\\sqrt{4\\left(\\frac{E}{h}\\right)^2 + \\alpha^2} = \\alpha \\left[ 1 + \\frac{1}{2} \\left(4\\left(\\frac{E}{h\\alpha}\\right)^2\\right) + O(\\alpha^{-4}) \\right] = \\alpha \\left[ 1 + 2\\frac{E^2}{h^2\\alpha^2} + O(\\alpha^{-4}) \\right] = \\alpha + \\frac{2E^2}{h^2\\alpha} + O(\\alpha^{-3}).$$\n\n将此展开式代回特征值的表达式中。\n对于 $\\lambda_{\\max}$：\n$$\\lambda_{\\max} = \\frac{1}{2} \\left[ 2\\frac{E}{h} + \\alpha + \\left(\\alpha + \\frac{2E^2}{h^2\\alpha} + O(\\alpha^{-3})\\right) \\right] = \\frac{1}{2} \\left[ 2\\alpha + 2\\frac{E}{h} + O(\\alpha^{-1}) \\right] = \\alpha + \\frac{E}{h} + O(\\alpha^{-1}).$$\n$\\lambda_{\\max}$ 的主阶项是 $\\alpha$。\n\n对于 $\\lambda_{\\min}$：\n$$\\lambda_{\\min} = \\frac{1}{2} \\left[ 2\\frac{E}{h} + \\alpha - \\left(\\alpha + \\frac{2E^2}{h^2\\alpha} + O(\\alpha^{-3})\\right) \\right] = \\frac{1}{2} \\left[ 2\\frac{E}{h} - \\frac{2E^2}{h^2\\alpha} + O(\\alpha^{-3}) \\right] = \\frac{E}{h} - \\frac{E^2}{h^2\\alpha} + O(\\alpha^{-3}).$$\n$\\lambda_{\\min}$ 的主阶项是一个常数 $E/h$。\n\n条件数 $\\kappa_2$ 是最大与最小特征值之比：\n$$\\kappa_2(K(\\alpha,E,h)) = \\frac{\\lambda_{\\max}}{\\lambda_{\\min}} = \\frac{\\alpha + \\frac{E}{h} + O(\\alpha^{-1})}{\\frac{E}{h} - \\frac{E^2}{h^2\\alpha} + O(\\alpha^{-3})}.$$\n为了求出当 $\\alpha \\to \\infty$ 时 $\\kappa_2$ 增长的主阶渐近表达式，我们取分子和分母主阶项的比值：\n$$\\kappa_2 \\sim \\frac{\\alpha}{E/h} \\quad \\text{当 } \\alpha \\to \\infty \\text{ 时}.$$\n因此，主阶渐近表达式为：\n$$\\kappa_2 \\sim \\frac{\\alpha h}{E}.$$\n这个结果表明，条件数随罚参数 $\\alpha$ 线性增长，这是基于罚方法的有限元法中病态问题的一个典型特征。", "answer": "$$\\boxed{\\frac{\\alpha h}{E}}$$", "id": "3563169"}, {"introduction": "与约束解空间的本质边界条件不同，自然边界条件（如施加的力或力矩）被整合到系统载荷向量中。本练习演示了将连续分布的载荷——板边缘上的弯矩——转换为功等效的节点力的关键过程。这一实践植根于虚功原理，对于在有限元分析中准确地模拟外部载荷至关重要 [@problem_id:3563213]。", "problem": "一块基于基尔霍夫-乐甫假设建模的薄板，为进行有限元法 (FEM) 分析而被离散化。考虑一个长度为 $L$ 的单元的单条直边，该边由弧长坐标 $s \\in [0, L]$ 参数化，并通过仿射关系 $s = \\tfrac{L}{2}(\\xi + 1)$（其中 $ds = \\tfrac{L}{2}\\,d\\xi$）映射到一维母坐标 $\\xi \\in [-1, 1]$。沿此边，绕切向轴的单位长度弯矩（法向弯矩）被指定为 $m_{n}(s) = m_{0} + m_{1}\\,s$，这在板问题的弱形式中构成了一个自然边界条件。其功共轭的边运动场是绕切向轴的边转角，记作 $\\theta_{n}(s)$，它通过与位于 $\\xi = -1, 0, 1$ 的三个边节点相关的二次拉格朗日形函数进行插值：\n$$\nN_{1}(\\xi) = \\frac{\\xi(\\xi - 1)}{2}, \\qquad\nN_{2}(\\xi) = 1 - \\xi^{2}, \\qquad\nN_{3}(\\xi) = \\frac{\\xi(\\xi + 1)}{2}.\n$$\n以虚功原理为基本出发点，推导沿该边的等效节点力矩向量的表达式，其节点分量对应于 $\\xi = -1, 0, 1$ 处与 $\\theta_{n}$ 相关的自由度。然后，使用横坐标为 $\\xi = \\pm 1/\\sqrt{3}$、权重为 $1$ 的两点高斯-勒让德求积法计算所得的边积分。用符号 $L$、$m_{0}$ 和 $m_{1}$ 表示你的最终答案。等效节点力矩应以牛顿·米 (N·m) 为单位表示。无需进行数值代入，也无需四舍五入。最终答案必须是一个单一的复合表达式。", "solution": "该问题被验证为具有科学依据、适定且客观。所有必要信息均已提供，且设置一致。该问题是虚功原理在结构力学有限元法背景下的一个标准应用。\n\n等效节点力矩的推导始于虚功原理。由沿单元边的指定单位长度法向弯矩 $m_{n}(s)$ 所做的外虚功 $\\delta W_{\\text{ext}}$，由该力矩乘以相应的虚转角 $\\delta\\theta_{n}(s)$ 的积分给出：\n$$\n\\delta W_{\\text{ext}} = \\int_{s=0}^{s=L} m_{n}(s) \\delta\\theta_{n}(s) \\, ds\n$$\n在有限元法中，运动场 $\\theta_{n}(s)$ 及其变分 $\\delta\\theta_{n}(s)$ 是使用形函数从节点自由度插值得到的。给定沿该边的三个节点，转角 $\\theta_{n}(s)$ 表示为：\n$$\n\\theta_{n}(s) = \\sum_{i=1}^{3} N_{i}(\\xi(s)) \\theta_{ni}\n$$\n其中 $\\theta_{ni}$ 是节点 $i=1, 2, 3$（对应于 $\\xi = -1, 0, 1$）处的转角节点值。那么虚转角为：\n$$\n\\delta\\theta_{n}(s) = \\sum_{i=1}^{3} N_{i}(\\xi(s)) \\delta\\theta_{ni}\n$$\n将此代入虚功表达式：\n$$\n\\delta W_{\\text{ext}} = \\int_{s=0}^{s=L} m_{n}(s) \\left( \\sum_{i=1}^{3} N_{i}(\\xi(s)) \\delta\\theta_{ni} \\right) \\, ds\n$$\n由于虚节点转角 $\\delta\\theta_{ni}$ 相对于积分变量 $s$ 是任意常数，我们可以重新整理该表达式：\n$$\n\\delta W_{\\text{ext}} = \\sum_{i=1}^{3} \\left( \\int_{s=0}^{s=L} m_{n}(s) N_{i}(\\xi(s)) \\, ds \\right) \\delta\\theta_{ni}\n$$\n外虚功也可以直接表示为与虚节点转角 $\\delta\\theta_{ni}$ 共轭的等效节点力矩 $M_i$ 所做功的总和：\n$$\n\\delta W_{\\text{ext}} = \\sum_{i=1}^{3} M_{i} \\delta\\theta_{ni}\n$$\n通过比较 $\\delta W_{\\text{ext}}$ 的两个表达式，我们确定了第 $i$ 个等效节点力矩的公式：\n$$\nM_{i} = \\int_{s=0}^{s=L} m_{n}(s) N_{i}(\\xi(s)) \\, ds\n$$\n为计算此积分，我们将积分变量从弧长坐标 $s$ 变换为母坐标 $\\xi$。题目给出了仿射映射 $s = \\frac{L}{2}(\\xi + 1)$，这意味着微分关系为 $ds = \\frac{L}{2} d\\xi$。积分限 $s \\in [0, L]$ 映射到 $\\xi \\in [-1, 1]$。分布力矩 $m_{n}(s)$ 也必须用 $\\xi$ 表示：\n$$\nm_{n}(s(\\xi)) = m_{0} + m_{1}s(\\xi) = m_{0} + m_{1} \\frac{L}{2}(\\xi + 1)\n$$\n$M_{i}$ 的积分变为：\n$$\nM_{i} = \\int_{-1}^{1} \\left( m_{0} + m_{1} \\frac{L}{2}(\\xi + 1) \\right) N_{i}(\\xi) \\frac{L}{2} \\, d\\xi\n$$\n题目指定该积分需使用两点高斯-勒让德求积法进行计算。该数值积分的公式为：\n$$\n\\int_{-1}^{1} f(\\xi) \\, d\\xi \\approx \\sum_{j=1}^{2} w_{j} f(\\xi_{j})\n$$\n其中横坐标为 $\\xi_{1} = -1/\\sqrt{3}$、$\\xi_{2} = 1/\\sqrt{3}$，权重为 $w_{1}=w_{2}=1$。第 $i$ 个力矩的被积函数为 $f_i(\\xi) = \\frac{L}{2} \\left[ m_{0} + m_{1} \\frac{L}{2}(\\xi + 1) \\right] N_{i}(\\xi)$。因此，节点力矩可近似为：\n$$\nM_{i} \\approx f_i(-\\frac{1}{\\sqrt{3}}) + f_i(\\frac{1}{\\sqrt{3}})\n$$\n首先，我们在高斯点 $\\xi = \\pm 1/\\sqrt{3}$ 处计算形函数 $N_i(\\xi)$ 和分布力矩 $m_n(\\xi)$ 的值。\n\n高斯点处的形函数：\n$N_{1}(\\xi) = \\frac{\\xi(\\xi-1)}{2} \\implies N_{1}(-\\frac{1}{\\sqrt{3}}) = \\frac{1}{6} + \\frac{1}{2\\sqrt{3}}, \\quad N_{1}(\\frac{1}{\\sqrt{3}}) = \\frac{1}{6} - \\frac{1}{2\\sqrt{3}}$\n$N_{2}(\\xi) = 1 - \\xi^{2} \\implies N_{2}(-\\frac{1}{\\sqrt{3}}) = \\frac{2}{3}, \\quad N_{2}(\\frac{1}{\\sqrt{3}}) = \\frac{2}{3}$\n$N_{3}(\\xi) = \\frac{\\xi(\\xi+1)}{2} \\implies N_{3}(-\\frac{1}{\\sqrt{3}}) = \\frac{1}{6} - \\frac{1}{2\\sqrt{3}}, \\quad N_{3}(\\frac{1}{\\sqrt{3}}) = \\frac{1}{6} + \\frac{1}{2\\sqrt{3}}$\n\n高斯点处的分布力矩：\n$m_n(\\xi) = m_{0} + m_{1} \\frac{L}{2}(\\xi + 1)$\n$m_n(-\\frac{1}{\\sqrt{3}}) = m_{0} + m_{1} \\frac{L}{2}(1 - \\frac{1}{\\sqrt{3}})$\n$m_n(\\frac{1}{\\sqrt{3}}) = m_{0} + m_{1} \\frac{L}{2}(1 + \\frac{1}{\\sqrt{3}})$\n\n现在我们计算每个节点力矩 $M_i$：\n$M_i \\approx \\frac{L}{2} \\left[ m_n(-\\frac{1}{\\sqrt{3}}) N_i(-\\frac{1}{\\sqrt{3}}) + m_n(\\frac{1}{\\sqrt{3}}) N_i(\\frac{1}{\\sqrt{3}}) \\right]$\n\n对于 $M_1$：\n$M_1 \\approx \\frac{L}{2} \\left[ \\left(m_{0} + \\frac{m_{1}L}{2} - \\frac{m_{1}L}{2\\sqrt{3}}\\right) \\left(\\frac{1}{6} + \\frac{1}{2\\sqrt{3}}\\right) + \\left(m_{0} + \\frac{m_{1}L}{2} + \\frac{m_{1}L}{2\\sqrt{3}}\\right) \\left(\\frac{1}{6} - \\frac{1}{2\\sqrt{3}}\\right) \\right]$\n设 $A = m_0 + \\frac{m_1L}{2}$，$B = \\frac{m_1L}{2\\sqrt{3}}$，$C = \\frac{1}{6}$，$D = \\frac{1}{2\\sqrt{3}}$。表达式为 $\\frac{L}{2}[(A-B)(C+D) + (A+B)(C-D)] = \\frac{L}{2}[2AC - 2BD] = L(AC-BD)$。\n$AC = (m_0 + \\frac{m_1L}{2})\\frac{1}{6} = \\frac{m_0}{6} + \\frac{m_1L}{12}$。\n$BD = (\\frac{m_1L}{2\\sqrt{3}})(\\frac{1}{2\\sqrt{3}}) = \\frac{m_1L}{12}$。\n$M_1 = L \\left( \\frac{m_0}{6} + \\frac{m_1L}{12} - \\frac{m_1L}{12} \\right) = \\frac{m_0L}{6}$。\n\n对于 $M_2$：\n$N_2$ 在两个高斯点处均为常数，$N_2(\\pm\\frac{1}{\\sqrt{3}}) = 2/3$。\n$M_2 \\approx \\frac{L}{2} \\cdot \\frac{2}{3} \\left[ m_n(-\\frac{1}{\\sqrt{3}}) + m_n(\\frac{1}{\\sqrt{3}}) \\right] = \\frac{L}{3} \\left[ \\left(m_0 + \\frac{m_1L}{2} - \\frac{m_1L}{2\\sqrt{3}}\\right) + \\left(m_0 + \\frac{m_1L}{2} + \\frac{m_1L}{2\\sqrt{3}}\\right) \\right]$\n$M_2 \\approx \\frac{L}{3} \\left[ 2m_0 + m_1L \\right] = \\frac{2m_0L}{3} + \\frac{m_1L^2}{3}$。\n\n对于 $M_3$：\n表达式为 $\\frac{L}{2}[(A-B)(C-D) + (A+B)(C+D)] = \\frac{L}{2}[2AC + 2BD] = L(AC+BD)$。\n$M_3 = L \\left( (\\frac{m_0}{6} + \\frac{m_1L}{12}) + \\frac{m_1L}{12} \\right) = L \\left( \\frac{m_0}{6} + \\frac{m_1L}{6} \\right) = \\frac{m_0L}{6} + \\frac{m_1L^2}{6}$。\n\n被积函数是关于 $\\xi$ 的 3 次多项式，而两点高斯求积法对于最高 $2(2)-1=3$ 次的多项式是精确的。因此，这些结果是精确值，而非近似值。\n等效节点力矩向量的分量为：\n$M_{1} = \\frac{m_{0}L}{6}$\n$M_{2} = \\frac{2m_{0}L}{3} + \\frac{m_{1}L^{2}}{3} = \\frac{2m_{0}L + m_{1}L^{2}}{3}$\n$M_{3} = \\frac{m_{0}L}{6} + \\frac{m_{1}L^{2}}{6} = \\frac{m_{0}L + m_{1}L^{2}}{6}$", "answer": "$$\n\\boxed{\n\\begin{pmatrix} \\frac{m_{0}L}{6} & \\frac{2m_{0}L + m_{1}L^{2}}{3} & \\frac{m_{0}L + m_{1}L^{2}}{6} \\end{pmatrix}\n}\n$$", "id": "3563213"}]}