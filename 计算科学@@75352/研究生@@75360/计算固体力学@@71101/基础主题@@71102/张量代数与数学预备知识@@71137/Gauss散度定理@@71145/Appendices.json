{"hands_on_practices": [{"introduction": "在有限元方法 (FEM) 中，为了简化计算，我们通常在规则的参考单元上定义积分。然而，物理定律是在实际的、可能变形的物理单元上表述的。本练习将引导你亲手实践如何通过雅可比矩阵和其代数余子式，将参考单元上的曲面积分转换到物理单元上，这是数值计算高斯散度定理中边界项的基础技能。", "problem": "考虑有限元法（FEM）中的一个八节点六面体有限元，其参考域为 $\\widehat{\\Omega} = [-1,1]^3$，从参考坐标 $(\\xi,\\eta,\\zeta)$ 到物理坐标 $\\boldsymbol{x}=(x,y,z)$ 的仿射映射 $\\boldsymbol{x}(\\xi,\\eta,\\zeta)$ 由下式给出：\n$$\n\\boldsymbol{x}(\\xi,\\eta,\\zeta) = \n\\begin{pmatrix}\n2\\,\\xi + \\eta + \\frac{1}{2}\\,\\zeta + 1 \\\\\n-\\xi + 3\\,\\eta + \\zeta - 2 \\\\\n\\xi - \\eta + 4\\,\\zeta\n\\end{pmatrix}.\n$$\n设参考单元的边界面 $\\widehat{F}$ 为 $\\zeta=1$ 处的四边形，即 $\\widehat{F}=\\{(\\xi,\\eta,1): \\xi\\in[-1,1], \\eta\\in[-1,1]\\}$。在物理面上给定一个矢量场 $\\boldsymbol{v}(\\boldsymbol{x})$ 为：\n$$\n\\boldsymbol{v}(\\boldsymbol{x})=\n\\begin{pmatrix}\n1 + \\frac{1}{5}\\,x + \\frac{2}{5}\\,y - \\frac{1}{10}\\,z \\\\\n-\\frac{1}{2} + \\frac{2}{5}\\,x - \\frac{3}{10}\\,y + \\frac{1}{5}\\,z \\\\\n\\frac{7}{10} - \\frac{1}{5}\\,x + \\frac{1}{10}\\,y + \\frac{3}{10}\\,z\n\\end{pmatrix}.\n$$\n从雅可比矩阵 $\\mathbf{J}=\\partial\\boldsymbol{x}/\\partial(\\xi,\\eta,\\zeta)$ 的基本定义及其列作为协变基矢量的几何意义出发，使用 $\\mathbf{J}$ 的代数余子式来：\n(1) 推导在 $\\zeta=1$ 面上的物理单位法向量 $\\boldsymbol{n}$ 和标量面积元 $dS$，\n(2) 用参考变量 $(\\xi,\\eta)$ 表示该面上的通量被积函数 $\\boldsymbol{v}\\cdot\\boldsymbol{n}\\,dS$，以及\n(3) 计算曲面通量\n$$\n\\int_{\\partial\\Omega_e\\cap\\{\\zeta=1\\}} \\boldsymbol{v}\\cdot\\boldsymbol{n}\\, dS\n$$\n通过在 $[-1,1]^2$ 上使用张量积两点高斯-勒让德求积，其中求积点为 $\\xi=\\pm\\frac{1}{\\sqrt{3}}$、$\\eta=\\pm\\frac{1}{\\sqrt{3}}$，权重为 $w_\\xi=w_\\eta=1$。假设映射是保向的，并取 $\\zeta=1$ 面上的外法线为与 $\\zeta$ 增加方向相关联的法线。将通量的最终值以单个精确数的形式给出。不需要进行单位转换，也不需要四舍五入。", "solution": "用户希望计算一个八节点六面体有限元一个面上的曲面通量积分。此问题将按要求分三部分解决：（1）计算曲面法线和面积元，（2）在参考坐标下表示通量被积函数，以及（3）使用高斯求积计算通量积分。\n\n首先，我们必须验证问题陈述。\n\n### 步骤 1：提取已知条件\n-   **参考域**: 一个立方体 $\\widehat{\\Omega} = [-1,1]^3$，坐标为 $(\\xi,\\eta,\\zeta)$。\n-   **仿射映射**: 从参考坐标到物理坐标 $\\boldsymbol{x}=(x,y,z)$ 的映射 $\\boldsymbol{x}(\\xi,\\eta,\\zeta)$ 由下式给出：\n    $$\n    \\boldsymbol{x}(\\xi,\\eta,\\zeta) = \n    \\begin{pmatrix}\n    2\\,\\xi + \\eta + \\frac{1}{2}\\,\\zeta + 1 \\\\\n    -\\xi + 3\\,\\eta + \\zeta - 2 \\\\\n    \\xi - \\eta + 4\\,\\zeta\n    \\end{pmatrix}\n    $$\n-   **边界面**: 参考面为 $\\widehat{F}=\\{(\\xi,\\eta,1): \\xi\\in[-1,1], \\eta\\in[-1,1]\\}$，对应于物理面 $\\partial\\Omega_e\\cap\\{\\zeta=1\\}$。\n-   **矢量场**: 矢量场 $\\boldsymbol{v}(\\boldsymbol{x})$ 为：\n    $$\n    \\boldsymbol{v}(\\boldsymbol{x})=\n    \\begin{pmatrix}\n    1 + \\frac{1}{5}\\,x + \\frac{2}{5}\\,y - \\frac{1}{10}\\,z \\\\\n    -\\frac{1}{2} + \\frac{2}{5}\\,x - \\frac{3}{10}\\,y + \\frac{1}{5}\\,z \\\\\n    \\frac{7}{10} - \\frac{1}{5}\\,x + \\frac{1}{10}\\,y + \\frac{3}{10}\\,z\n    \\end{pmatrix}\n    $$\n-   **任务**:\n    1.  使用雅可比矩阵 $\\mathbf{J}$ 的代数余子式推导在 $\\zeta=1$ 面上的物理单位法向量 $\\boldsymbol{n}$ 和标量面积元 $dS$。\n    2.  用 $(\\xi,\\eta)$ 表示通量被积函数 $\\boldsymbol{v}\\cdot\\boldsymbol{n}\\,dS$。\n    3.  使用张量积两点高斯-勒让德求积计算通量积分 $\\int \\boldsymbol{v}\\cdot\\boldsymbol{n}\\, dS$，求积点为 $\\xi=\\pm\\frac{1}{\\sqrt{3}}$、$\\eta=\\pm\\frac{1}{\\sqrt{3}}$，权重为 $w_\\xi=w_\\eta=1$。\n-   **假设**: 映射是保向的。$\\zeta=1$ 面上的外法线与 $\\zeta$ 增加的方向相关联。\n\n### 步骤 2：使用提取的已知条件进行验证\n-   **科学上成立**: 该问题基于连续介质力学和有限元法（FEM）的标准原理，特别是等参映射和曲面积分。这些是计算固体力学中成熟的概念。\n-   **适定的**: 该问题提供了所有必要的信息：几何映射、矢量场和积分法则。任务规定明确，可得出一个唯一的数值答案。\n-   **客观的**: 问题以精确的数学语言陈述，没有歧义或主观陈述。\n\n该问题没有任何缺陷，如科学上不成立、不完整、矛盾或不可行。这是一个计算工程领域中适定的标准问题。\n\n### 步骤 3：结论和行动\n问题被判定为**有效**。我们继续进行求解。\n\n### 详细解答\n\n**第 (1) 部分：推导物理单位法向量 $\\boldsymbol{n}$ 和标量面积元 $dS$。**\n\n给定了从参考坐标 $(\\xi,\\eta,\\zeta)$到物理坐标 $\\boldsymbol{x}=(x,y,z)$ 的映射。该映射的雅可比矩阵 $\\mathbf{J}$ 定义为：\n$$\n\\mathbf{J} = \\frac{\\partial\\boldsymbol{x}}{\\partial(\\xi,\\eta,\\zeta)} = \\begin{pmatrix}\n\\frac{\\partial x}{\\partial \\xi}  \\frac{\\partial x}{\\partial \\eta}  \\frac{\\partial x}{\\partial \\zeta} \\\\\n\\frac{\\partial y}{\\partial \\xi}  \\frac{\\partial y}{\\partial \\eta}  \\frac{\\partial y}{\\partial \\zeta} \\\\\n\\frac{\\partial z}{\\partial \\xi}  \\frac{\\partial z}{\\partial \\eta}  \\frac{\\partial z}{\\partial \\zeta}\n\\end{pmatrix}\n$$\n$\\mathbf{J}$的列是协变基矢量 $\\boldsymbol{g}_1 = \\frac{\\partial\\boldsymbol{x}}{\\partial\\xi}$、$\\boldsymbol{g}_2 = \\frac{\\partial\\boldsymbol{x}}{\\partial\\eta}$ 和 $\\boldsymbol{g}_3 = \\frac{\\partial\\boldsymbol{x}}{\\partial\\zeta}$。对于给定的仿射映射，这些矢量是常数：\n$$\n\\boldsymbol{g}_1 = \\begin{pmatrix} 2 \\\\ -1 \\\\ 1 \\end{pmatrix}, \\quad\n\\boldsymbol{g}_2 = \\begin{pmatrix} 1 \\\\ 3 \\\\ -1 \\end{pmatrix}, \\quad\n\\boldsymbol{g}_3 = \\begin{pmatrix} \\frac{1}{2} \\\\ 1 \\\\ 4 \\end{pmatrix}\n$$\n因此，雅可比矩阵是常数：\n$$\n\\mathbf{J} = \\begin{pmatrix} 2  1  \\frac{1}{2} \\\\ -1  3  1 \\\\ 1  -1  4 \\end{pmatrix}\n$$\n物理面元矢量 $d\\boldsymbol{S} = \\boldsymbol{n}\\,dS$ 与其对应的参考面元矢量 $d\\boldsymbol{S}_0 = \\boldsymbol{N}\\,dA$ 之间的关系由Nanson公式给出，该公式涉及 $\\mathbf{J}$ 的代数余子式矩阵：\n$$\nd\\boldsymbol{S} = \\text{Cof}(\\mathbf{J})\\,d\\boldsymbol{S}_0\n$$\n所关注的面位于 $\\zeta=1$。在参考域中，该面具有单位法向量 $\\boldsymbol{N} = (0, 0, 1)^T$ 和面积元 $dA = d\\xi\\,d\\eta$。因此，$d\\boldsymbol{S}_0 = (0, 0, 1)^T d\\xi\\,d\\eta$。\n因此，物理面元矢量 $d\\boldsymbol{S}$ 是 $\\mathbf{J}$ 的代数余子式矩阵的第三列乘以 $d\\xi\\,d\\eta$。代数余子式矩阵 $\\mathbf{C} = \\text{Cof}(\\mathbf{J})$ 由 $C_{ij} = (-1)^{i+j} M_{ij}$ 给出，其中 $M_{ij}$ 是元素 $J_{ij}$ 的余子式。我们需要第三列（$j=3$）：\n$$\nC_{13} = (-1)^{1+3} \\det\\begin{pmatrix} -1  3 \\\\ 1  -1 \\end{pmatrix} = (1)(1) - (3)(1) = -2\n$$\n$$\nC_{23} = (-1)^{2+3} \\det\\begin{pmatrix} 2  1 \\\\ 1  -1 \\end{pmatrix} = -((2)(-1) - (1)(1)) = -(-2-1) = 3\n$$\n$$\nC_{33} = (-1)^{3+3} \\det\\begin{pmatrix} 2  1 \\\\ -1  3 \\end{pmatrix} = (2)(3) - (1)(-1) = 6+1 = 7\n$$\n所以，面元矢量为：\n$$\nd\\boldsymbol{S} = \\boldsymbol{n}\\,dS = \\begin{pmatrix} -2 \\\\ 3 \\\\ 7 \\end{pmatrix} d\\xi\\,d\\eta\n$$\n标量面积元 $dS$ 是 $d\\xi\\,d\\eta$ 的矢量系数的模：\n$$\ndS = \\left\\| \\begin{pmatrix} -2 \\\\ 3 \\\\ 7 \\end{pmatrix} \\right\\| d\\xi\\,d\\eta = \\sqrt{(-2)^2 + 3^2 + 7^2}\\,d\\xi\\,d\\eta = \\sqrt{4+9+49}\\,d\\xi\\,d\\eta = \\sqrt{62}\\,d\\xi\\,d\\eta\n$$\n单位法向量 $\\boldsymbol{n}$ 为：\n$$\n\\boldsymbol{n} = \\frac{1}{\\sqrt{62}} \\begin{pmatrix} -2 \\\\ 3 \\\\ 7 \\end{pmatrix}\n$$\n必须检查该矢量的方向。外法线方向与 $\\zeta$ 增加方向一致，由 $\\boldsymbol{g}_3$ 表示。$\\det(\\mathbf{J}) = (\\boldsymbol{g}_1 \\times \\boldsymbol{g}_2) \\cdot \\boldsymbol{g}_3$ 的符号决定了方向。$d\\boldsymbol{S}$ 中 $d\\xi\\,d\\eta$ 的矢量系数是 $\\boldsymbol{g}_1 \\times \\boldsymbol{g}_2$。它与 $\\boldsymbol{g}_3$ 的点积为：\n$$\n\\begin{pmatrix} -2 \\\\ 3 \\\\ 7 \\end{pmatrix} \\cdot \\begin{pmatrix} \\frac{1}{2} \\\\ 1 \\\\ 4 \\end{pmatrix} = (-2)(\\frac{1}{2}) + (3)(1) + (7)(4) = -1 + 3 + 28 = 30\n$$\n由于 $\\det(\\mathbf{J})=30 > 0$，我们计算出的法向量正确地指向外侧，与问题陈述一致。\n\n**第 (2) 部分：用 $(\\xi,\\eta)$ 表示通量被积函数 $\\boldsymbol{v}\\cdot\\boldsymbol{n}\\,dS$。**\n\n通量被积函数是 $\\boldsymbol{v}\\cdot\\boldsymbol{n}\\,dS$，即 $\\boldsymbol{v}\\cdot d\\boldsymbol{S}$。\n$$\n\\boldsymbol{v}\\cdot\\boldsymbol{n}\\,dS = \\boldsymbol{v} \\cdot \\left( \\begin{pmatrix} -2 \\\\ 3 \\\\ 7 \\end{pmatrix} d\\xi\\,d\\eta \\right) = (-2v_x + 3v_y + 7v_z) \\,d\\xi\\,d\\eta\n$$\n我们首先用物理坐标 $(x,y,z)$ 表示项 $(-2v_x + 3v_y + 7v_z)$：\n$$\n-2v_x = -2\\left(1 + \\frac{1}{5}x + \\frac{2}{5}y - \\frac{1}{10}z\\right) = -2 - \\frac{2}{5}x - \\frac{4}{5}y + \\frac{1}{5}z\n$$\n$$\n3v_y = 3\\left(-\\frac{1}{2} + \\frac{2}{5}x - \\frac{3}{10}y + \\frac{1}{5}z\\right) = -\\frac{3}{2} + \\frac{6}{5}x - \\frac{9}{10}y + \\frac{3}{5}z\n$$\n$$\n7v_z = 7\\left(\\frac{7}{10} - \\frac{1}{5}x + \\frac{1}{10}y + \\frac{3}{10}z\\right) = \\frac{49}{10} - \\frac{7}{5}x + \\frac{7}{10}y + \\frac{21}{10}z\n$$\n将这些相加得到：\n$$\n(-2-\\frac{3}{2}+\\frac{49}{10}) + (-\\frac{2}{5}+\\frac{6}{5}-\\frac{7}{5})x + (-\\frac{4}{5}-\\frac{9}{10}+\\frac{7}{10})y + (\\frac{1}{5}+\\frac{3}{5}+\\frac{21}{10})z\n$$\n$$\n= \\frac{-20-15+49}{10} + \\frac{-2+6-7}{5}x + \\frac{-8-9+7}{10}y + \\frac{2+6+21}{10}z\n$$\n$$\n= \\frac{14}{10} - \\frac{3}{5}x - \\frac{10}{10}y + \\frac{29}{10}z = \\frac{7}{5} - \\frac{3}{5}x - y + \\frac{29}{10}z\n$$\n现在，将在 $\\zeta=1$ 面上的物理坐标用参考坐标 $(\\xi,\\eta)$ 代入：\n$$\n\\boldsymbol{x}(\\xi,\\eta,1) = \\begin{pmatrix} x \\\\ y \\\\ z \\end{pmatrix} = \\begin{pmatrix}\n2\\xi + \\eta + \\frac{3}{2} \\\\ -\\xi + 3\\eta - 1 \\\\ \\xi - \\eta + 4\n\\end{pmatrix}\n$$\n将这些代入 $\\boldsymbol{v}\\cdot(-2,3,7)^T$ 的表达式中：\n$$\nI(\\xi,\\eta) = \\frac{7}{5} - \\frac{3}{5}\\left(2\\xi + \\eta + \\frac{3}{2}\\right) - \\left(-\\xi + 3\\eta - 1\\right) + \\frac{29}{10}\\left(\\xi - \\eta + 4\\right)\n$$\n$$\nI(\\xi,\\eta) = \\frac{7}{5} - \\frac{6}{5}\\xi - \\frac{3}{5}\\eta - \\frac{9}{10} + \\xi - 3\\eta + 1 + \\frac{29}{10}\\xi - \\frac{29}{10}\\eta + \\frac{116}{10}\n$$\n合并同分母项：\n$$\n\\text{常数项:} \\quad \\frac{14}{10} - \\frac{9}{10} + \\frac{10}{10} + \\frac{116}{10} = \\frac{131}{10}\n$$\n$$\n\\xi\\text{ 项:} \\quad \\left(-\\frac{12}{10} + \\frac{10}{10} + \\frac{29}{10}\\right)\\xi = \\frac{27}{10}\\xi\n$$\n$$\n\\eta\\text{ 项:} \\quad \\left(-\\frac{6}{10} - \\frac{30}{10} - \\frac{29}{10}\\right)\\eta = -\\frac{65}{10}\\eta = -\\frac{13}{2}\\eta\n$$\n被积函数是 $I(\\xi, \\eta) = \\frac{27}{10}\\xi - \\frac{13}{2}\\eta + \\frac{131}{10}$。\n因此，通量被积函数为 $\\left(\\frac{27}{10}\\xi - \\frac{13}{2}\\eta + \\frac{131}{10}\\right)d\\xi\\,d\\eta$。\n\n**第 (3) 部分：使用高斯求积计算曲面通量。**\n\n曲面通量是被积函数在参考面 $\\widehat{F}$ 上的积分：\n$$\n\\text{通量} = \\int_{-1}^{1} \\int_{-1}^{1} I(\\xi,\\eta)\\,d\\xi\\,d\\eta = \\int_{-1}^{1} \\int_{-1}^{1} \\left(\\frac{27}{10}\\xi - \\frac{13}{2}\\eta + \\frac{131}{10}\\right)d\\xi\\,d\\eta\n$$\n我们使用张量积两点高斯-勒让德求积。求积点为 $(\\xi_i, \\eta_j)$，其中 $\\xi_i, \\eta_j \\in \\{-\\frac{1}{\\sqrt{3}}, \\frac{1}{\\sqrt{3}}\\}$，权重为 $w_i = w_j = 1$。\n积分近似为：\n$$\n\\text{通量} \\approx \\sum_{i=1}^{2} \\sum_{j=1}^{2} w_i w_j I(\\xi_i, \\eta_j) = \\sum_{i=1}^{2} \\sum_{j=1}^{2} I(\\xi_i, \\eta_j)\n$$\n四个求值点是 $(-\\frac{1}{\\sqrt{3}}, -\\frac{1}{\\sqrt{3}})$、$(-\\frac{1}{\\sqrt{3}}, \\frac{1}{\\sqrt{3}})$、$(\\frac{1}{\\sqrt{3}}, -\\frac{1}{\\sqrt{3}})$ 和 $(\\frac{1}{\\sqrt{3}}, \\frac{1}{\\sqrt{3}})$。\n被积函数 $I(\\xi, \\eta)$ 是关于 $\\xi$ 和 $\\eta$ 的线性多项式。两点高斯-勒让德求积对次数最高为 $2n-1 = 2(2)-1=3$ 的多项式是精确的。因此，该求积将得到积分的精确值。\n对于一个线性函数 $f(\\xi,\\eta) = a\\xi + b\\eta + c$，在四个对称高斯点上的和为：\n$$\n\\sum_{i,j} f(\\xi_i, \\eta_j) = f(-\\alpha,-\\alpha) + f(-\\alpha,\\alpha) + f(\\alpha,-\\alpha) + f(\\alpha,\\alpha) \\quad \\left(\\alpha = \\frac{1}{\\sqrt{3}}\\right)\n$$\n$$\n= (-a\\alpha -b\\alpha + c) + (-a\\alpha +b\\alpha + c) + (a\\alpha -b\\alpha + c) + (a\\alpha +b\\alpha + c)\n$$\n$$\n= (-a-a+a+a)\\alpha + (-b+b-b+b)b\\alpha + 4c = 4c\n$$\n在我们的例子中，$a = \\frac{27}{10}$，$b = -\\frac{13}{2}$，而 $c = \\frac{131}{10}$。\n积分的值恰好是常数项乘以积分区域的面积(4)，这与求积公式的结果是一致的。\n求和结果为 $4c = 4 \\times \\frac{131}{10} = \\frac{524}{10} = \\frac{262}{5}$。\n为了步骤清晰，我们转换为小数：$4 \\times 13.1 = 52.4$。\n最终值必须是一个精确数。\n$$\n\\text{通量} = \\frac{262}{5}\n$$", "answer": "$$\\boxed{\\frac{262}{5}}$$", "id": "3567179"}, {"introduction": "理解了如何在数值上计算曲面积分后，我们必须思考一个更深刻的问题：高斯散度定理的应用前提是什么？本练习通过一个线弹性断裂力学中的经典场景——裂纹尖端的应力奇异性——来挑战你的理解。你将需要解释为何必须将奇异点排除在积分域之外，并利用这一思想来推导一个重要的物理结论。", "problem": "考虑一个二维、静态、线弹性的固体，其中包含一个尖端位于原点的直裂纹。设极坐标 $(r,\\theta)$ 以裂纹尖端为中心，裂纹表面沿 $\\theta=\\pm \\pi$ 分布。假设在裂纹尖端没有体力，也没有集中力。在尖端附近，柯西应力张量 $\\boldsymbol{\\sigma}(r,\\theta)$ 表现出经典线弹性断裂力学中 $\\boldsymbol{\\sigma}(r,\\theta)\\sim r^{-1/2}$ 形式的奇点，即存在一个有界的张量值角度函数 $\\boldsymbol{S}(\\theta)$ 和一个有限常数 $C>0$，使得对于足够小的 $r>0$，有\n$$\n\\boldsymbol{\\sigma}(r,\\theta)=\\frac{C}{\\sqrt{r}}\\,\\boldsymbol{S}(\\theta)+\\boldsymbol{\\sigma}_{\\mathrm{reg}}(r,\\theta),\n$$\n其中 $\\boldsymbol{\\sigma}_{\\mathrm{reg}}$ 在尖端的一个邻域内是有界的。令 $\\Gamma_{R}$ 表示以尖端为中心、半径为 $R>0$ 的正向圆，其外向单位法向量为 $\\boldsymbol{n}=\\boldsymbol{e}_{r}$，线元为 $\\mathrm{d}s=R\\,\\mathrm{d}\\theta$。定义穿过 $\\Gamma_{R}$ 传递的合力为\n$$\n\\boldsymbol{F}(R)=\\int_{\\Gamma_{R}}\\boldsymbol{\\sigma}\\,\\boldsymbol{n}\\,\\mathrm{d}s.\n$$\n从局部线性动量平衡和面力的定义出发，解释为何在应用高斯散度定理之前，必须通过处理一个环形域 $\\mathcal{A}_{\\varepsilon,R}=\\{(r,\\theta)\\,|\\,\\varepsilon<r<R,\\ -\\pi<\\theta<\\pi\\}$ 来排除裂纹尖端，其中 $0<\\varepsilon<R$。然后，假设裂纹表面是无面力的，计算合力 $\\boldsymbol{F}(R)$，以二维列向量的形式给出。", "solution": "该问题被评估为有效。它在科学上基于线弹性断裂力学和连续介质力学的原理，是适定的、客观的且内部一致的。\n\n该问题要求两件事：首先，解释在应用高斯散度定理时为何必须排除裂纹尖端；其次，计算穿过围绕尖端的圆形轮廓所传递的合力。\n\n**第一部分：排除裂纹尖端的必要性**\n\n二维高斯散度定理将矢量场散度的面积分与该场在区域边界上的法向分量的线积分联系起来。对于域 $\\mathcal{D}$ 上的矢量场 $\\boldsymbol{v}$，其边界为 $\\partial\\mathcal{D}$，该定理表述为：\n$$\n\\int_{\\mathcal{D}} (\\nabla \\cdot \\boldsymbol{v}) \\, \\mathrm{d}A = \\oint_{\\partial\\mathcal{D}} \\boldsymbol{v} \\cdot \\boldsymbol{n} \\, \\mathrm{d}s\n$$\n该定理可以应用于平衡方程的每个笛卡尔分量。例如，考虑 $x_1$ 分量，我们设 $\\boldsymbol{v} = (\\sigma_{11}, \\sigma_{12})^T$。那么 $\\nabla \\cdot \\boldsymbol{v} = \\frac{\\partial \\sigma_{11}}{\\partial x_1} + \\frac{\\partial \\sigma_{12}}{\\partial x_2}$，这是 $\\nabla \\cdot \\boldsymbol{\\sigma}$ 的第一个分量。\n\n高斯散度定理有效性的一个关键要求是，矢量场 $\\boldsymbol{v}$ 必须在整个域 $\\mathcal{D}$ 上是连续可微的（$C^1$ 类）。问题陈述，裂纹尖端附近的柯西应力张量 $\\boldsymbol{\\sigma}(r,\\theta)$ 有一个奇异部分，其行为类似于 $r^{-1/2}$：\n$$\n\\boldsymbol{\\sigma}(r,\\theta) = \\frac{C}{\\sqrt{r}}\\,\\boldsymbol{S}(\\theta) + \\boldsymbol{\\sigma}_{\\mathrm{reg}}(r,\\theta)\n$$\n当径向距离 $r$ 趋近于零时，应力张量的大小趋于无穷大。因此，$\\boldsymbol{\\sigma}$ 的分量在原点（$r=0$）处是不连续的，并且在那里显然是不可微的。任何试图将高斯散度定理直接应用于包含裂纹尖端的域（例如半径为 $R$ 的圆盘）的尝试，在数学上都是无效的，因为定理的假设在原点处被违反了。\n\n为了正确使用该定理，必须在一个应力场是良态的域上进行操作。问题指出，局部线性动量平衡 $\\nabla \\cdot \\boldsymbol{\\sigma} = \\mathbf{0}$ 在*远离尖端*处成立。这意味着对于任何 $r > 0$，应力场是连续可微的。因此，有必要切除原点处的奇点。这可以通过考虑一个环形域 $\\mathcal{A}_{\\varepsilon,R} = \\{(r,\\theta) \\,|\\, \\varepsilon < r < R\\}$ 来实现，其中 $\\varepsilon > 0$ 是一个小数。在这个环形域内，应力张量 $\\boldsymbol{\\sigma}$ 是连续可微的，高斯散度定理可以被严格应用。然后可以通过取极限 $\\varepsilon \\to 0$ 来研究尖端处的行为。\n\n**第二部分：合力 $\\boldsymbol{F}(R)$ 的计算**\n\n穿过圆 $\\Gamma_R$ 传递的合力定义为 $\\boldsymbol{F}(R) = \\int_{\\Gamma_R} \\boldsymbol{\\sigma} \\boldsymbol{n} \\, \\mathrm{d}s$。这里，$\\boldsymbol{\\sigma n}$ 是作用在圆形边界上的面力矢量 $\\boldsymbol{t}$。\n\n我们将散度定理应用于环形域 $\\mathcal{A}_{\\varepsilon,R}$ 上的应力张量场 $\\boldsymbol{\\sigma}$。物体处于静力平衡状态且没有体力，因此平衡方程 $\\nabla \\cdot \\boldsymbol{\\sigma} = \\mathbf{0}$ 在 $\\mathcal{A}_{\\varepsilon,R}$ 内的所有点都成立。\n将平衡方程在域上积分得到：\n$$\n\\int_{\\mathcal{A}_{\\varepsilon,R}} (\\nabla \\cdot \\boldsymbol{\\sigma}) \\, \\mathrm{d}A = \\int_{\\mathcal{A}_{\\varepsilon,R}} \\mathbf{0} \\, \\mathrm{d}A = \\mathbf{0}\n$$\n根据高斯散度定理，这个面积分等于面力矢量在域边界 $\\partial\\mathcal{A}_{\\varepsilon,R}$ 上的积分：\n$$\n\\oint_{\\partial\\mathcal{A}_{\\varepsilon,R}} \\boldsymbol{\\sigma} \\boldsymbol{n} \\, \\mathrm{d}s = \\mathbf{0}\n$$\n边界 $\\partial\\mathcal{A}_{\\varepsilon,R}$ 由四个部分组成：外圆 $\\Gamma_R$、内圆 $\\Gamma_\\varepsilon$、上裂纹面 $C^+$ 和下裂纹面 $C^-$。积分可以写为：\n$$\n\\int_{\\Gamma_R} \\boldsymbol{\\sigma} \\boldsymbol{n} \\, \\mathrm{d}s + \\int_{\\Gamma_\\varepsilon} \\boldsymbol{\\sigma} \\boldsymbol{n} \\, \\mathrm{d}s + \\int_{C^+} \\boldsymbol{\\sigma} \\boldsymbol{n} \\, \\mathrm{d}s + \\int_{C^-} \\boldsymbol{\\sigma} \\boldsymbol{n} \\, \\mathrm{d}s = \\mathbf{0}\n$$\n给定的应力场形式 $\\boldsymbol{\\sigma} \\sim r^{-1/2}$ 是线弹性断裂力学（LEFM）的经典解。这个解是在裂纹面无面力的假设下推导出来的。因此，面力矢量 $\\boldsymbol{t} = \\boldsymbol{\\sigma n}$ 在 $C^+$ 和 $C^-$ 上都为零。因此，裂纹面上的积分消失：\n$$\n\\int_{C^+} \\boldsymbol{\\sigma} \\boldsymbol{n} \\, \\mathrm{d}s = \\mathbf{0} \\quad \\text{和} \\quad \\int_{C^-} \\boldsymbol{\\sigma} \\boldsymbol{n} \\, \\mathrm{d}s = \\mathbf{0}\n$$\n方程简化为联系两条圆形路径上的积分。在外圆 $\\Gamma_R$ 上，环形域的外向单位法向量为 $\\boldsymbol{n} = \\boldsymbol{e}_r$。在内圆 $\\Gamma_\\varepsilon$ 上，环形域的外向单位法向量为 $\\boldsymbol{n} = -\\boldsymbol{e}_r$。\n$$\n\\int_{\\Gamma_R} \\boldsymbol{\\sigma} \\boldsymbol{e}_r \\, \\mathrm{d}s + \\int_{\\Gamma_\\varepsilon} \\boldsymbol{\\sigma} (-\\boldsymbol{e}_r) \\, \\mathrm{d}s = \\mathbf{0}\n$$\n使用问题中的定义 $\\boldsymbol{F}(r) = \\int_{\\Gamma_r} \\boldsymbol{\\sigma} \\boldsymbol{e}_r \\, \\mathrm{d}s$（其中积分是逆时针方向，$\\boldsymbol{e}_r$ 是从原点出发的外向法线），我们有：\n$$\n\\boldsymbol{F}(R) - \\boldsymbol{F}(\\varepsilon) = \\mathbf{0} \\implies \\boldsymbol{F}(R) = \\boldsymbol{F}(\\varepsilon)\n$$\n这表明，对于任何以尖端为中心的圆形路径，合力 $\\boldsymbol{F}(r)$ 是与路径无关的。为了求其值，我们可以评估路径 $\\Gamma_\\varepsilon$ 上的积分，并取极限 $\\varepsilon \\to 0$。\n$$\n\\boldsymbol{F}(R) = \\lim_{\\varepsilon \\to 0} \\boldsymbol{F}(\\varepsilon) = \\lim_{\\varepsilon \\to 0} \\int_{\\Gamma_\\varepsilon} \\boldsymbol{\\sigma}(\\varepsilon, \\theta) \\boldsymbol{e}_r \\, \\mathrm{d}s\n$$\n在 $\\Gamma_\\varepsilon$ 上，$r=\\varepsilon$，线元为 $\\mathrm{d}s = \\varepsilon \\, \\mathrm{d}\\theta$。积分范围是 $\\theta \\in [-\\pi, \\pi]$。\n$$\n\\boldsymbol{F}(R) = \\lim_{\\varepsilon \\to 0} \\int_{-\\pi}^{\\pi} \\left( \\frac{C}{\\sqrt{\\varepsilon}}\\,\\boldsymbol{S}(\\theta) + \\boldsymbol{\\sigma}_{\\mathrm{reg}}(\\varepsilon, \\theta) \\right) \\boldsymbol{e}_r \\, (\\varepsilon \\, \\mathrm{d}\\theta)\n$$\n我们将积分分成两部分：\n$$\n\\boldsymbol{F}(R) = \\lim_{\\varepsilon \\to 0} \\left( \\int_{-\\pi}^{\\pi} \\frac{C}{\\sqrt{\\varepsilon}}\\,\\boldsymbol{S}(\\theta) \\boldsymbol{e}_r \\, \\varepsilon \\, \\mathrm{d}\\theta + \\int_{-\\pi}^{\\pi} \\boldsymbol{\\sigma}_{\\mathrm{reg}}(\\varepsilon, \\theta) \\boldsymbol{e}_r \\, \\varepsilon \\, \\mathrm{d}\\theta \\right)\n$$\n$$\n\\boldsymbol{F}(R) = \\lim_{\\varepsilon \\to 0} \\left( C\\sqrt{\\varepsilon} \\int_{-\\pi}^{\\pi} \\boldsymbol{S}(\\theta) \\boldsymbol{e}_r \\, \\mathrm{d}\\theta + \\varepsilon \\int_{-\\pi}^{\\pi} \\boldsymbol{\\sigma}_{\\mathrm{reg}}(\\varepsilon, \\theta) \\boldsymbol{e}_r \\, \\mathrm{d}\\theta \\right)\n$$\n我们已知角度函数 $\\boldsymbol{S}(\\theta)$ 和正则应力部分 $\\boldsymbol{\\sigma}_{\\mathrm{reg}}(r,\\theta)$ 是有界的。这意味着积分 $\\int_{-\\pi}^{\\pi} \\boldsymbol{S}(\\theta) \\boldsymbol{e}_r \\, \\mathrm{d}\\theta$ 和 $\\int_{-\\pi}^{\\pi} \\boldsymbol{\\sigma}_{\\mathrm{reg}}(\\varepsilon, \\theta) \\boldsymbol{e}_r \\, \\mathrm{d}\\theta$ 的计算结果为有限的常数矢量（我们称它们为 $\\boldsymbol{I}_S$ 和 $\\boldsymbol{I}_{\\mathrm{reg}}(\\varepsilon)$，后者也是有界的）。\n表达式变为：\n$$\n\\boldsymbol{F}(R) = \\lim_{\\varepsilon \\to 0} \\left( C\\sqrt{\\varepsilon} \\, \\boldsymbol{I}_S + \\varepsilon \\, \\boldsymbol{I}_{\\mathrm{reg}}(\\varepsilon) \\right)\n$$\n当 $\\varepsilon \\to 0$ 时，两项都趋近于零矢量：$C\\sqrt{\\varepsilon} \\, \\boldsymbol{I}_S \\to \\mathbf{0}$ 和 $\\varepsilon \\, \\boldsymbol{I}_{\\mathrm{reg}}(\\varepsilon) \\to \\mathbf{0}$。\n因此，合力为零：\n$$\n\\boldsymbol{F}(R) = \\mathbf{0}\n$$\n这个结果对于任何半径 $R>0$ 都有效。它与初始条件——裂纹尖端没有集中力作用——相一致。如果这个极限的结果非零，将意味着在原点存在一个集中力（一个狄拉克δ动量源），而这已经被明确排除了。最终答案是零矢量，其分量为 $(0, 0)$，单位为牛顿。", "answer": "$$\\boxed{\\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}}$$", "id": "3567207"}, {"introduction": "理论和概念最终需要在计算实践中得到验证。本练习将指导你使用制造解方法 (Method of Manufactured Solutions, MMS) 编写程序，以数值方式验证应力张量的高斯散度定理。通过这个过程，你不仅能加深对定理本身的理解，还能体会到数值求积阶次对计算精度和离散守恒律的关键影响。", "problem": "考虑一个计算固体力学（CSM）中的二维静态体，其具有一个被构造的对称二阶 Cauchy 应力张量场 $\\boldsymbol{\\sigma}(\\boldsymbol{x})$，其中 $\\boldsymbol{x}=(x,y)$ 且 $\\boldsymbol{\\sigma}=\\begin{bmatrix}\\sigma_{xx}\\sigma_{xy}\\\\\\sigma_{xy}\\sigma_{yy}\\end{bmatrix}$。设应力张量的散度按分量定义为 $(\\nabla\\cdot\\boldsymbol{\\sigma})_i=\\sum_{j=1}^{2}\\partial \\sigma_{ij}/\\partial x_j$（对于 $i\\in\\{1,2\\}$），并将产生的矢量场记为 $\\boldsymbol{b}(\\boldsymbol{x})=\\nabla\\cdot\\boldsymbol{\\sigma}(\\boldsymbol{x})$。张量场的 Gauss 散度定理意味着 $\\int_{\\partial\\Omega}\\boldsymbol{\\sigma}\\boldsymbol{n}\\,dS=\\int_{\\Omega}\\nabla\\cdot\\boldsymbol{\\sigma}\\,d\\Omega$，其中 $\\Omega\\subset\\mathbb{R}^2$ 是一个具有分段光滑边界 $\\partial\\Omega$ 的有界域，而 $\\boldsymbol{n}$ 是单位外法向量。在多项式场的计算验证中，数值求积法则可能能够也可能无法精确积分所需的多项式，这取决于其阶数。\n\n从无惯性的静态体的线性动量守恒（其表述为 $\\nabla\\cdot\\boldsymbol{\\sigma}+\\boldsymbol{b}_{\\text{phys}}=\\boldsymbol{0}$）出发，通过设置 $\\boldsymbol{b}=\\nabla\\cdot\\boldsymbol{\\sigma}$ 来构建一个构造源场。然后，在变化的求积阶数下，使用高斯-勒让德求积法数值验证恒等式 $\\int_{\\partial\\Omega}\\boldsymbol{\\sigma}\\boldsymbol{n}\\,dS-\\int_{\\Omega}\\boldsymbol{b}\\,d\\Omega=\\boldsymbol{0}$。所有量均为无量纲。\n\n你的任务是编写一个完整、可运行的程序，该程序：\n- 为每个测试用例实现以下多项式应力场 $\\boldsymbol{\\sigma}(\\boldsymbol{x})$（满足 $\\sigma_{xy}=\\sigma_{yx}$），并从 $\\boldsymbol{\\sigma}(\\boldsymbol{x})$ 的散度精确构造出 $\\boldsymbol{b}(\\boldsymbol{x})$。\n- 分别使用指定阶数的 高斯-勒让德求积法则对边界段和区域进行数值计算，以求得 $\\int_{\\partial\\Omega}\\boldsymbol{\\sigma}\\boldsymbol{n}\\,dS$ 和 $\\int_{\\Omega}\\boldsymbol{b}\\,d\\Omega$。\n- 报告残差向量 $\\boldsymbol{r}=\\int_{\\partial\\Omega}\\boldsymbol{\\sigma}\\boldsymbol{n}\\,dS-\\int_{\\Omega}\\boldsymbol{b}\\,d\\Omega$ 的欧几里得范数，每个测试用例的结果为一个浮点数值。\n\n使用矩形域 $\\Omega=[x_0,x_1]\\times[y_0,y_1]$，其四条边上的外法向量分别为：底边 $\\boldsymbol{n}=(0,-1)$，右边 $\\boldsymbol{n}=(1,0)$，顶边 $\\boldsymbol{n}=(0,1)$，以及左边 $\\boldsymbol{n}=(-1,0)$。在每条边界边上使用阶数为 $m$ 的高斯-勒让德求积法，并在区域内使用阶数为 $(n_x,n_y)$ 的张量积高斯-勒让德求积法。欧几里得范数必须报告为无量纲的浮点数。\n\n构造的应力多项式和测试套件：\n- 测试用例 $1$（理想情况，预期精确积分）：\n  - 域：$[0,1]\\times[0,1]$。\n  - 求积阶数：边界 $m=2$，区域 $(n_x,n_y)=(2,2)$。\n  - 应力分量：\n    - $\\sigma_{xx}=2x+3y+1$,\n    - $\\sigma_{xy}=4x+5y+2$,\n    - $\\sigma_{yy}=-x+2y+\\tfrac{1}{2}$。\n- 测试用例 $2$（积分不足，预期非零残差）：\n  - 域：$[0,1]\\times[0,1]$。\n  - 求积阶数：边界 $m=1$，区域 $(n_x,n_y)=(1,1)$。\n  - 应力分量：\n    - $\\sigma_{xx}=x^3+2x^2y+xy^2+y^3+x^2+y^2+x+y+1$,\n    - $\\sigma_{xy}=x^2y+xy^2+x^2+y^2+x+y+1$,\n    - $\\sigma_{yy}=2x^3+x^2y+xy^2+\\tfrac{1}{2}y^3+x^2+y^2+x+y$。\n- 测试用例 $3$（一般矩形，预期精确积分）：\n  - 域：$[-1,2]\\times[0,3]$。\n  - 求积阶数：边界 $m=3$，区域 $(n_x,n_y)=(3,3)$。\n  - 应力分量：\n    - $\\sigma_{xx}=3x^2+2xy+y^2+x+2y+1$,\n    - $\\sigma_{xy}=-x^2+3xy+2y^2+0.1x+0.2y+0.3$,\n    - $\\sigma_{yy}=2x^2-xy+4y^2+0.5x+1.5y+2$。\n- 测试用例 $4$（小域，高阶求积，预期残差接近机器精度）：\n  - 域：$[0,0.01]\\times[0,0.02]$。\n  - 求积阶数：边界 $m=5$，区域 $(n_x,n_y)=(5,5)$。\n  - 应力分量：\n    - $\\sigma_{xx}=0.1x^3+0.2x^2y+0.3xy^2+0.4y^3+0.5x+0.6y+0.7$,\n    - $\\sigma_{xy}=0.2x^2y+0.1xy^2+0.3x^2+0.4y^2+0.5x+0.6y+0.1$,\n    - $\\sigma_{yy}=0.3x^3+0.1x^2y+0.2x*y^2+0.5y^3+0.4x+0.3y+0.2$。\n\n实现要求：\n- 通过对四条边的积分求和来计算 $\\int_{\\partial\\Omega}\\boldsymbol{\\sigma}\\boldsymbol{n}\\,dS$。每条边上的积分使用阶数为 $m$ 的一维高斯-勒让德求积法，并结合适当的弧长缩放和外法向量 $\\boldsymbol{n}$。\n- 使用阶数为 $(n_x,n_y)$ 的张量积二维高斯-勒让德求积法计算 $\\int_{\\Omega}\\boldsymbol{b}\\,d\\Omega$，其中利用了从 $[-1,1]$ 到 $[x_0,x_1]$ 和 $[y_0,y_1]$ 的仿射映射。\n- 对于每个测试用例，将欧几里得范数 $\\|\\boldsymbol{r}\\|_2$ 作为无量纲浮点数输出。\n\n最终输出格式：\n- 你的程序应生成单行输出，其中包含用方括号括起来的逗号分隔结果列表（例如 $[r_1,r_2,r_3,r_4]$），其中每个 $r_k$ 是测试用例 $k$ 的残差范数。\n\n不允许外部输入、文件或网络访问。最终输出必须严格遵循上述单行格式。", "solution": "用户希望在一个矩形域 $\\Omega$ 上，对一个二阶 Cauchy 应力张量场 $\\boldsymbol{\\sigma}$ 进行 Gauss 散度定理的数值验证。该定理指出，边界 $\\partial\\Omega$ 上的牵引力矢量 $\\boldsymbol{t} = \\boldsymbol{\\sigma}\\boldsymbol{n}$ 的积分，等于域 $\\Omega$ 上应力张量散度 $\\nabla\\cdot\\boldsymbol{\\sigma}$ 的积分。该问题是在计算固体力学中制造解方法（MMS）的背景下提出的，其中一个已知的应力场 $\\boldsymbol{\\sigma}$ 被“制造”出来，其散度被视为一个体力源项 $\\boldsymbol{b} = \\nabla\\cdot\\boldsymbol{\\sigma}$。待验证的恒等式为 $\\int_{\\partial\\Omega}\\boldsymbol{\\sigma}\\boldsymbol{n}\\,dS = \\int_{\\Omega}\\boldsymbol{b}\\,d\\Omega$，或者等价地，残差向量 $\\boldsymbol{r} = \\int_{\\partial\\Omega}\\boldsymbol{\\sigma}\\boldsymbol{n}\\,dS - \\int_{\\Omega}\\boldsymbol{b}\\,d\\Omega$ 是零向量。我们将针对几个涉及多项式应力场和不同阶数高斯-勒让德求积的测试用例，计算该残差的欧几里得范数 $\\|\\boldsymbol{r}\\|_2$。\n\n### 步骤 1：数学公式\n\n设域为矩形 $\\Omega = [x_0, x_1] \\times [y_0, y_1]$。边界 $\\partial\\Omega$ 由四条线段组成。\n\n**1.1. 应力张量及其散度**\n给定的应力张量是一个对称的 $2 \\times 2$ 矩阵场：\n$$\n\\boldsymbol{\\sigma}(\\boldsymbol{x}) = \\begin{bmatrix} \\sigma_{xx}(x,y)  \\sigma_{xy}(x,y) \\\\ \\sigma_{xy}(x,y)  \\sigma_{yy}(x,y) \\end{bmatrix}\n$$\n体力源项 $\\boldsymbol{b}$ 定义为 $\\boldsymbol{\\sigma}$ 的散度：\n$$\n\\boldsymbol{b}(\\boldsymbol{x}) = \\nabla\\cdot\\boldsymbol{\\sigma}(\\boldsymbol{x}) = \\begin{pmatrix} b_x(x,y) \\\\ b_y(x,y) \\end{pmatrix} = \\begin{pmatrix} \\frac{\\partial \\sigma_{xx}}{\\partial x} + \\frac{\\partial \\sigma_{xy}}{\\partial y} \\\\ \\frac{\\partial \\sigma_{xy}}{\\partial x} + \\frac{\\partial \\sigma_{yy}}{\\partial y} \\end{pmatrix}\n$$\n对于每个测试用例，我们首先从给定的 $\\sigma_{ij}$ 多项式表达式中解析计算出函数 $b_x(x,y)$ 和 $b_y(x,y)$。\n\n**1.2. 边界积分**\n边界积分 $\\int_{\\partial\\Omega}\\boldsymbol{\\sigma}\\boldsymbol{n}\\,dS$ 是矩形四条边上积分的总和。我们用 $\\boldsymbol{I}_{\\partial\\Omega}$ 表示此积分。\n四条边分别是：\n- 底边：$y = y_0$， $x \\in [x_0, x_1]$，$\\boldsymbol{n} = (0, -1)$。牵引力为 $\\boldsymbol{\\sigma}\\boldsymbol{n} = (-\\sigma_{xy}, -\\sigma_{yy})^T$。\n  $$ \\boldsymbol{I}_{\\text{bottom}} = \\int_{x_0}^{x_1} \\begin{pmatrix} -\\sigma_{xy}(x, y_0) \\\\ -\\sigma_{yy}(x, y_0) \\end{pmatrix} dx $$\n- 右边：$x = x_1$， $y \\in [y_0, y_1]$，$\\boldsymbol{n} = (1, 0)$。牵引力为 $\\boldsymbol{\\sigma}\\boldsymbol{n} = (\\sigma_{xx}, \\sigma_{xy})^T$。\n  $$ \\boldsymbol{I}_{\\text{right}} = \\int_{y_0}^{y_1} \\begin{pmatrix} \\sigma_{xx}(x_1, y) \\\\ \\sigma_{xy}(x_1, y) \\end{pmatrix} dy $$\n- 顶边：$y = y_1$， $x \\in [x_0, x_1]$，$\\boldsymbol{n} = (0, 1)$。牵引力为 $\\boldsymbol{\\sigma}\\boldsymbol{n} = (\\sigma_{xy}, \\sigma_{yy})^T$。\n  $$ \\boldsymbol{I}_{\\text{top}} = \\int_{x_0}^{x_1} \\begin{pmatrix} \\sigma_{xy}(x, y_1) \\\\ \\sigma_{yy}(x, y_1) \\end{pmatrix} dx $$\n- 左边：$x = x_0$， $y \\in [y_0, y_1]$，$\\boldsymbol{n} = (-1, 0)$。牵引力为 $\\boldsymbol{\\sigma}\\boldsymbol{n} = (-\\sigma_{xx}, -\\sigma_{xy})^T$。\n  $$ \\boldsymbol{I}_{\\text{left}} = \\int_{y_0}^{y_1} \\begin{pmatrix} -\\sigma_{xx}(x_0, y) \\\\ -\\sigma_{xy}(x_0, y) \\end{pmatrix} dy $$\n总边界积分为 $\\boldsymbol{I}_{\\partial\\Omega} = \\boldsymbol{I}_{\\text{bottom}} + \\boldsymbol{I}_{\\text{right}} + \\boldsymbol{I}_{\\text{top}} + \\boldsymbol{I}_{\\text{left}}$。\n\n**1.3. 面积积分**\n面积积分是体力向量 $\\boldsymbol{b}$ 在域 $\\Omega$ 上的积分：\n$$\n\\boldsymbol{I}_{\\Omega} = \\int_{\\Omega} \\boldsymbol{b}\\,d\\Omega = \\int_{y_0}^{y_1} \\int_{x_0}^{x_1} \\begin{pmatrix} b_x(x,y) \\\\ b_y(x,y) \\end{pmatrix} dx dy\n$$\n\n### 步骤 2：数值求积\n\n我们使用高斯-勒让德求积来近似计算积分。一个 $k$ 阶（使用 $k$ 个点）的一维高斯-勒让德法则可以精确积分最高 $2k-1$ 次的多项式。\n\n**2.1. 一维高斯-勒让德求积（用于边界积分）**\n为计算积分 $\\int_a^b f(t) dt$，我们使用 $t(\\xi) = \\frac{b-a}{2}\\xi + \\frac{a+b}{2}$ 将参考区间 $\\xi \\in [-1, 1]$ 映射到 $[a, b]$。微分为 $dt = \\frac{b-a}{2}d\\xi$。积分近似为：\n$$\n\\int_a^b f(t) dt \\approx \\frac{b-a}{2} \\sum_{i=1}^{m} w_i f(t(\\xi_i))\n$$\n其中 $\\xi_i$ 是求积点，$w_i$ 是对应的权重，$m$ 是求积阶数。项 $\\frac{b-a}{2}$ 是一维变换的雅可比行列式。\n\n**2.2. 二维张量积高斯-勒让德求积（用于面积积分）**\n为计算 $\\int_{y_0}^{y_1} \\int_{x_0}^{x_1} \\boldsymbol{g}(x,y) dx dy$，我们将参考正方形 $(\\xi, \\eta) \\in [-1, 1] \\times [-1, 1]$ 映射到矩形 $[x_0, x_1] \\times [y_0, y_1]$。\n映射为 $x(\\xi) = \\frac{x_1-x_0}{2}\\xi + \\frac{x_0+x_1}{2}$ 和 $y(\\eta) = \\frac{y_1-y_0}{2}\\eta + \\frac{y_0+y_1}{2}$。\n面积微元为 $d\\Omega = dx dy = \\left(\\frac{x_1-x_0}{2}\\right)\\left(\\frac{y_1-y_0}{2}\\right)d\\xi d\\eta = J d\\xi d\\eta$，其中 $J$ 是变换的雅可比行列式。积分近似为：\n$$\n\\int_{\\Omega} \\boldsymbol{g}\\,d\\Omega \\approx J \\sum_{j=1}^{n_y} \\sum_{i=1}^{n_x} w_j^{\\eta} w_i^{\\xi} \\boldsymbol{g}(x(\\xi_i), y(\\eta_j))\n$$\n其中 $(w_i^{\\xi}, \\xi_i)$ 和 $(w_j^{\\eta}, \\eta_j)$ 分别是阶数为 $n_x$ 和 $n_y$ 的高斯-勒让德法则的权重和点。\n\n### 步骤 3：算法实现\n\n对于每个测试用例，算法按以下步骤进行：\n1. 为应力张量的分量 $\\sigma_{xx}, \\sigma_{xy}, \\sigma_{yy}$ 定义 Python 函数。\n2. 解析推导并为体力向量的分量 $b_x, b_y$ 定义 Python 函数。\n3. 使用 `scipy.special.roots_legendre` 获取指定阶数的求积点和权重。\n4. **计算边界积分 $\\boldsymbol{I}_{\\partial\\Omega}$**：\n   - 初始化一个二维向量 $\\boldsymbol{I}_{\\partial\\Omega} = [0, 0]^T$。\n   - 对四条边中的每一条：\n     - 确定积分限 $[a,b]$、相应的雅可比行列式 $\\frac{b-a}{2}$、被积向量函数以及固定坐标。\n     - 应用一维高斯-勒让德求积公式，将每个求积点的贡献（按权重和雅可比行列式缩放）求和。\n     - 将该边的结果加到 $\\boldsymbol{I}_{\\partial\\Omega}$ 上。\n5. **计算面积积分 $\\boldsymbol{I}_{\\Omega}$**：\n   - 初始化一个二维向量 $\\boldsymbol{I}_{\\Omega} = [0, 0]^T$。\n   - 计算面积雅可比行列式 $J = (\\frac{x_1-x_0}{2})(\\frac{y_1-y_0}{2})$。\n   - 使用嵌套循环遍历求积点 $(\\xi_i, \\eta_j)$ 的张量积。\n   - 在内层循环中，将参考坐标映射到物理坐标 $(x,y)$，计算 $\\boldsymbol{b}(x,y)$，并将贡献 $w_i^{\\xi} w_j^{\\eta} \\boldsymbol{b}(x,y)$ 加到一个运行总和中。\n   - 将最终总和乘以面积雅可比行列式 $J$ 得到 $\\boldsymbol{I}_{\\Omega}$。\n6. **计算残差**：\n   - 计算残差向量 $\\boldsymbol{r} = \\boldsymbol{I}_{\\partial\\Omega} - \\boldsymbol{I}_{\\Omega}$。\n   - 计算并返回其欧几里得范数 $\\|\\boldsymbol{r}\\|_2 = \\sqrt{r_x^2 + r_y^2}$。\n\n该实现将被结构化以处理测试用例列表，存储每个用例的结果，并将最终输出格式化为单行列表。\n\n- **测试用例 1 (精确积分)**：边界被积函数是线性的（1次），面积被积函数是常数（0次）。求积阶数 $m=2$ 和 $(n_x, n_y)=(2, 2)$ 分别可以精确积分最高 3 次和 (3,3) 次的多项式。因此，两个积分都将被精确计算，残差范数应接近机器精度。\n- **测试用例 2 (积分不足)**：应力张量分量是 3 次多项式。边界被积函数也是 3 次，面积被积函数是 2 次。求积阶数 $m=1$ 和 $(n_x, n_y)=(1, 1)$ 只能精确积分最高 1 次和 (1,1) 次的多项式。由于这种积分不足，预计会产生显著的非零残差。\n- **测试用例 3 (精确积分)**：边界被积函数是 2 次，面积被积函数是 1 次。求积阶数 $m=3$ 和 $(n_x, n_y)=(3, 3)$ 可以积分最高 5 次和 (5,5) 次的多项式，这足以实现精确积分。残差范数应接近机器精度。\n- **测试用例 4 (精确积分)**：边界被积函数是 3 次，面积被积函数是 2 次。使用了高阶求积 $m=5$ 和 $(n_x, n_y)=(5, 5)$，它们可以积分最高 9 次和 (9,9) 次的多项式，确保了精确积分。残差范数应接近机器精度。\n\n这种数值验证程序是科学计算中代码验证的基石，它确认了连续数学算子（此处为散度）的离散实现是正确的。", "answer": "```python\nimport numpy as np\nfrom scipy.special import roots_legendre\n\ndef compute_boundary_integral(domain, m_order, sigma_funcs):\n    \"\"\"\n    Computes the boundary integral of sigma*n over a rectangular domain.\n    \"\"\"\n    x0, x1, y0, y1 = domain\n    sxx, sxy, syy = sigma_funcs['xx'], sigma_funcs['xy'], sigma_funcs['yy']\n    \n    points, weights = roots_legendre(m_order)\n    \n    total_integral = np.zeros(2, dtype=float)\n\n    # Edge definitions: (integration_var, fixed_coord_val, integrand_funcs)\n    # integrand_funcs is a tuple of functions defining the vector components of sigma*n\n    edges = [\n        # Bottom edge: n=(0,-1). Integrand: (-sxy, -syy)\n        ('x', y0, (lambda x, y: -sxy(x,y), lambda x, y: -syy(x,y))),\n        # Right edge: n=(1,0). Integrand: (sxx, sxy)\n        ('y', x1, (lambda x, y: sxx(x,y), lambda x, y: sxy(x,y))),\n        # Top edge: n=(0,1). Integrand: (sxy, syy)\n        ('x', y1, (lambda x, y: sxy(x,y), lambda x, y: syy(x,y))),\n        # Left edge: n=(-1,0). Integrand: (-sxx, -sxy)\n        ('y', x0, (lambda x, y: -sxx(x,y), lambda x, y: -sxy(x,y))),\n    ]\n\n    for int_var, fixed_val, integrand_funcs in edges:\n        edge_integral = np.zeros(2, dtype=float)\n        if int_var == 'x':\n            a, b = x0, x1\n        else: # int_var == 'y'\n            a, b = y0, y1\n            \n        jac = (b - a) / 2.0\n        \n        for i in range(m_order):\n            xi, wi = points[i], weights[i]\n            # Affine map from [-1,1] to [a,b]\n            t = jac * xi + (a + b) / 2.0\n            \n            coords = {'x': t, 'y': fixed_val} if int_var == 'x' else {'x': fixed_val, 'y': t}\n            \n            integrand_vec = np.array([\n                integrand_funcs[0](coords['x'], coords['y']),\n                integrand_funcs[1](coords['x'], coords['y'])\n            ])\n            edge_integral += wi * integrand_vec\n            \n        total_integral += jac * edge_integral\n        \n    return total_integral\n\ndef compute_area_integral(domain, n_orders, b_funcs):\n    \"\"\"\n    Computes the area integral of b over a rectangular domain.\n    \"\"\"\n    x0, x1, y0, y1 = domain\n    nx, ny = n_orders\n    bx, by = b_funcs['x'], b_funcs['y']\n    \n    points_x, weights_x = roots_legendre(nx)\n    points_y, weights_y = roots_legendre(ny)\n    \n    jac_x = (x1 - x0) / 2.0\n    jac_y = (y1 - y0) / 2.0\n    jac_area = jac_x * jac_y\n    \n    total_integral = np.zeros(2, dtype=float)\n    \n    for j in range(ny):\n        eta, wj = points_y[j], weights_y[j]\n        y = jac_y * eta + (y0 + y1) / 2.0\n        for i in range(nx):\n            xi, wi = points_x[i], weights_x[i]\n            x = jac_x * xi + (x0 + x1) / 2.0\n            \n            integrand_vec = np.array([bx(x, y), by(x, y)])\n            total_integral += wi * wj * integrand_vec\n            \n    return jac_area * total_integral\n\ndef solve():\n    \"\"\"\n    Solves the problem for all specified test cases.\n    \"\"\"\n    test_cases = [\n        # Test Case 1\n        {\n            \"domain\": (0., 1., 0., 1.),\n            \"quad_orders\": (2, (2, 2)), # m, (nx, ny)\n            \"sigma\": {\n                \"xx\": lambda x, y: 2*x + 3*y + 1,\n                \"xy\": lambda x, y: 4*x + 5*y + 2,\n                \"yy\": lambda x, y: -x + 2*y + 0.5,\n            },\n            \"b\": {\n                \"x\": lambda x, y: 2.0 + 5.0,  # d(s_xx)/dx + d(s_xy)/dy\n                \"y\": lambda x, y: 4.0 + 2.0,  # d(s_xy)/dx + d(s_yy)/dy\n            },\n        },\n        # Test Case 2\n        {\n            \"domain\": (0., 1., 0., 1.),\n            \"quad_orders\": (1, (1, 1)),\n            \"sigma\": {\n                \"xx\": lambda x, y: x**3 + 2*x**2*y + x*y**2 + y**3 + x**2 + y**2 + x + y + 1,\n                \"xy\": lambda x, y: x**2*y + x*y**2 + x**2 + y**2 + x + y + 1,\n                \"yy\": lambda x, y: 2*x**3 + x**2*y + x*y**2 + 0.5*y**3 + x**2 + y**2 + x + y,\n            },\n            \"b\": {\n                \"x\": lambda x, y: (3*x**2 + 4*x*y + y**2 + 2*x + 1) + (x**2 + 2*x*y + 2*y + 1),\n                \"y\": lambda x, y: (2*x*y + y**2 + 2*x + 1) + (x**2 + 2*x*y + 1.5*y**2 + 2*y + 1),\n            },\n        },\n        # Test Case 3\n        {\n            \"domain\": (-1., 2., 0., 3.),\n            \"quad_orders\": (3, (3, 3)),\n            \"sigma\": {\n                \"xx\": lambda x, y: 3*x**2 + 2*x*y + y**2 + x + 2*y + 1,\n                \"xy\": lambda x, y: -x**2 + 3*x*y + 2*y**2 + 0.1*x + 0.2*y + 0.3,\n                \"yy\": lambda x, y: 2*x**2 - x*y + 4*y**2 + 0.5*x + 1.5*y + 2,\n            },\n            \"b\": {\n                \"x\": lambda x, y: (6*x + 2*y + 1) + (3*x + 4*y + 0.2),\n                \"y\": lambda x, y: (-2*x + 3*y + 0.1) + (-x + 8*y + 1.5),\n            },\n        },\n        # Test Case 4\n        {\n            \"domain\": (0., 0.01, 0., 0.02),\n            \"quad_orders\": (5, (5, 5)),\n            \"sigma\": {\n                \"xx\": lambda x, y: 0.1*x**3 + 0.2*x**2*y + 0.3*x*y**2 + 0.4*y**3 + 0.5*x + 0.6*y + 0.7,\n                \"xy\": lambda x, y: 0.2*x**2*y + 0.1*x*y**2 + 0.3*x**2 + 0.4*y**2 + 0.5*x + 0.6*y + 0.1,\n                \"yy\": lambda x, y: 0.3*x**3 + 0.1*x**2*y + 0.2*x*y**2 + 0.5*y**3 + 0.4*x + 0.3*y + 0.2,\n            },\n            \"b\": {\n                \"x\": lambda x, y: (0.3*x**2 + 0.4*x*y + 0.3*y**2 + 0.5) + (0.2*x**2 + 0.2*x*y + 0.8*y + 0.6),\n                \"y\": lambda x, y: (0.4*x*y + 0.1*y**2 + 0.6*x + 0.5) + (0.1*x**2 + 0.4*x*y + 1.5*y**2 + 0.3),\n            },\n        },\n    ]\n\n    results = []\n    for case in test_cases:\n        domain = case[\"domain\"]\n        m_order, n_orders = case[\"quad_orders\"]\n        sigma_funcs = case[\"sigma\"]\n        b_funcs = case[\"b\"]\n        \n        boundary_int = compute_boundary_integral(domain, m_order, sigma_funcs)\n        area_int = compute_area_integral(domain, n_orders, b_funcs)\n        \n        residual_vector = boundary_int - area_int\n        residual_norm = np.linalg.norm(residual_vector)\n        \n        results.append(residual_norm)\n    \n    print(f\"[{','.join(f'{r:.17e}' for r in results)}]\")\n\nsolve()\n```", "id": "3567224"}]}