{"hands_on_practices": [{"introduction": "理论学习的下一步是亲手实践。这项练习将通过一个基础的一维杆单元问题，引导你手动推导并求解约束系统。通过直接对比拉格朗日乘子法和罚函数法，你将深入理解这两种方法在代数结构上的根本差异，并分析罚函数法中刚度矩阵条件数随罚参数 $\\beta$ 变化的渐近行为，从而揭示其数值病态性的根源。[@problem_id:3586814]", "problem": "考虑一根占据区间 $x \\in [0,2]$ 的直棱柱杆，其杨氏模量 $E$ 和横截面积 $A$ 为常数，且无体力。该杆使用两个等长、线性、双节点的有限元进行建模（节点位于 $x=0,1,2$）。在右端 $x=2$ 处施加一个大小为 $1$ 的节点力，并需强制施加运动学边界条件 $u(0)=0$。采用无量纲化处理，令 $EA=1$ 且单元长度 $h=1$，因此所有刚度项均为无量纲量，施加的节点力在这些无量纲单位下大小为 $1$。令 $u_1$、$u_2$、$u_3$ 分别表示 $x=0,1,2$ 处的节点位移。\n\n从最小势能原理和一维线性弹性的应变-位移关系出发，完成以下任务：\n\n1) 推导单元刚度矩阵，并为无约束的三自由度模型（尚未施加边界条件）组装全局刚度矩阵。组装与 $x=2$ 处的单个节点力相对应的相容全局载荷向量。\n\n2) 通过以下方法强制施加 $u(0)=0$：\n- 在 Karush–Kuhn–Tucker (KKT) 鞍点系统中使用单个拉格朗日乘子 $\\lambda$。精确求解节点位移和该乘子。\n- 使用罚函数法，参数为 $\\beta>0$，通过对全局刚度矩阵增加一个针对 $u_1$ 的秩一项，并保持载荷向量不变（规定的位移为零）。精确求解作为 $\\beta$ 函数的节点位移。\n\n3) 通过与组装矩阵结构相关的极限论证，证明当 $\\beta \\to \\infty$ 时，罚函数解收敛于拉格朗日乘子解。\n\n4) 令 $\\kappa_2(\\boldsymbol{K}_\\beta)$ 表示对称正定罚函数刚度矩阵 $\\boldsymbol{K}_\\beta$ 的 $2$-范数条件数，即其最大特征值与最小特征值之比。在此特定的双单元设置中，利用组装过程且不借助于任何外部公式，确定精确常数 $c$，使得\n$$\n\\kappa_2(\\boldsymbol{K}_\\beta) \\sim c\\,\\beta \\quad \\text{当 } \\beta \\to \\infty,\n$$\n其中 $\\sim$ 表示渐近等价。你可以使用任何基于组装矩阵及其在 $\\beta \\to \\infty$ 时极限的有效谱论证。\n\n给出常数 $c$ 的精确封闭形式表达式（无量纲）。不要四舍五入。", "solution": "首先根据指定标准对问题进行验证。\n\n### 问题验证\n**步骤1：提取已知条件**\n- 一根位于区间 $x \\in [0,2]$ 的直棱柱杆。\n- 恒定的杨氏模量 $E$ 和横截面积 $A$。\n- 无体力。\n- 使用两个等长、线性、双节点的有限元进行建模，节点位于 $x=0, 1, 2$。\n- 在 $x=2$ 处施加一个大小为 $1$ 的节点力。\n- 运动学边界条件：$u(0)=0$。\n- 无量纲化：$EA=1$ 且单元长度 $h=1$。\n- 节点位移分别表示为 $u_1, u_2, u_3$，对应于 $x=0, 1, 2$。\n- 任务1：为无约束系统推导单元和全局刚度矩阵以及全局载荷向量。\n- 任务2：使用拉格朗日乘子法和罚函数法强制施加 $u(0)=0$，并求解节点位移。\n- 任务3：证明当罚参数 $\\beta \\to \\infty$ 时，罚函数解收敛于拉格朗日乘子解。\n- 任务4：确定条件数 $\\kappa_2(\\boldsymbol{K}_\\beta) \\sim c\\,\\beta$ 在 $\\beta \\to \\infty$ 时的渐近行为中的常数 $c$。\n\n**步骤2：使用提取的已知条件进行验证**\n- **科学性**：该问题是计算固体力学中的一个标准练习，将有限元法应用于一维弹性问题。势能、刚度矩阵、拉格朗日乘子和罚函数法等概念都是基础性的，且应用正确。\n- **适定性**：问题定义清晰，有足够的信息来推导出唯一解。边界条件和施加的载荷都已明确，确保了非平凡的唯一位移场。\n- **客观性**：问题使用精确、专业的技术语言陈述，没有任何主观性或模糊性。\n- **完整性与一致性**：所有必要的参数（$EA, h$）和条件均已提供。问题是自洽的，没有矛盾。\n- **现实性与可行性**：问题描述了一个简化但物理上现实的力学系统。无量纲化是力学中的标准做法。\n- **结构性与非平凡性**：问题结构良好，从基本推导逐步深入到对数值方法的更高级分析。它需要大量的计算和概念理解，特别是对于条件数的渐近分析，因此并非无关紧要。\n\n**步骤3：结论与行动**\n该问题被判定为**有效**。有必要给出完整解答。\n\n### 解答\n\n**1) 单元和全局系统的推导**\n\n一维杆的势能泛函为 $\\Pi = U - W_{ext}$，其中 $U$ 是应变能，$W_{ext}$ 是外力势。\n$U = \\frac{1}{2} \\int_0^2 EA \\left(\\frac{du}{dx}\\right)^2 dx$ 且 $W_{ext} = \\boldsymbol{F}^T \\boldsymbol{u}$，其中 $\\boldsymbol{u}=\\{u_1, u_2, u_3\\}^T$。\n对于一个长度为 $h$、节点位移为 $u_i$ 和 $u_{i+1}$ 的线性双节点有限元，其位移场为 $u^{(e)}(x') = (1-x'/h)u_i + (x'/h)u_{i+1}$，其中 $x'$ 是单元内的局部坐标。应变为常数：$\\epsilon^{(e)} = \\frac{du^{(e)}}{dx'} = \\frac{u_{i+1}-u_i}{h}$。\n一个单元的应变能为\n$U^{(e)} = \\frac{1}{2} \\int_0^h EA (\\epsilon^{(e)})^2 dx' = \\frac{1}{2} EA \\left(\\frac{u_{i+1}-u_i}{h}\\right)^2 h = \\frac{1}{2}\\frac{EA}{h}(u_{i+1}-u_i)^2$。\n这个二次型可以写成 $U^{(e)} = \\frac{1}{2} \\begin{pmatrix} u_i & u_{i+1} \\end{pmatrix} \\boldsymbol{k}^{(e)} \\begin{pmatrix} u_i \\\\ u_{i+1} \\end{pmatrix}$。\n通过展开 $(u_{i+1}-u_i)^2 = u_i^2 - 2u_i u_{i+1} + u_{i+1}^2$，我们确定单元刚度矩阵为：\n$\\boldsymbol{k}^{(e)} = \\frac{EA}{h} \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix}$。\n根据给定的无量纲化 $EA=1$ 和 $h=1$，单元刚度矩阵为 $\\boldsymbol{k}^{(e)} = \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix}$。\n\n该系统由两个单元组成：一个连接节点1和2，另一个连接节点2和3。全局刚度矩阵 $\\boldsymbol{K}$ 通过对每个单元的贡献求和来组装：\n$\\boldsymbol{K} = \\begin{pmatrix} 1 & -1 & 0 \\\\ -1 & 1 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix} + \\begin{pmatrix} 0 & 0 & 0 \\\\ 0 & 1 & -1 \\\\ 0 & -1 & 1 \\end{pmatrix} = \\begin{pmatrix} 1 & -1 & 0 \\\\ -1 & 2 & -1 \\\\ 0 & -1 & 1 \\end{pmatrix}$。\n\n全局载荷向量 $\\boldsymbol{F}$ 代表节点力。在节点3（$x=2$）处施加一个大小为1的力，因此该向量为：\n$\\boldsymbol{F} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix}$。\n\n**2) 边界条件 $u(0)=0$ 的施加**\n\n*   **拉格朗日乘子法：**\n约束条件是 $u_1=0$。增广势能（拉格朗日函数）为 $\\mathcal{L}(\\boldsymbol{u}, \\lambda) = \\frac{1}{2}\\boldsymbol{u}^T \\boldsymbol{K} \\boldsymbol{u} - \\boldsymbol{u}^T \\boldsymbol{F} + \\lambda u_1$。\n驻值条件 $\\nabla_{\\boldsymbol{u}} \\mathcal{L} = \\boldsymbol{0}$ 和 $\\frac{\\partial \\mathcal{L}}{\\partial \\lambda} = 0$ 产生 Karush–Kuhn–Tucker (KKT) 系统：\n$$\n\\begin{pmatrix} \\boldsymbol{K} & \\boldsymbol{C} \\\\ \\boldsymbol{C}^T & 0 \\end{pmatrix} \\begin{pmatrix} \\boldsymbol{u} \\\\ \\lambda \\end{pmatrix} = \\begin{pmatrix} \\boldsymbol{F} \\\\ g \\end{pmatrix}\n$$\n其中 $\\boldsymbol{C} = \\{1, 0, 0\\}^T$ 且 $g=0$。代入矩阵：\n$$\n\\begin{pmatrix}\n1 & -1 & 0 & 1 \\\\\n-1 & 2 & -1 & 0 \\\\\n0 & -1 & 1 & 0 \\\\\n1 & 0 & 0 & 0\n\\end{pmatrix}\n\\begin{pmatrix} u_1 \\\\ u_2 \\\\ u_3 \\\\ \\lambda \\end{pmatrix}\n=\n\\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\\\ 0 \\end{pmatrix}\n$$\n第四个方程给出 $u_1=0$。\n由第三个方程，$-u_2 + u_3 = 1$，所以 $u_3 = u_2+1$。\n将 $u_1=0$ 代入第二个方程，得到 $2u_2 - u_3 = 0$，所以 $u_3 = 2u_2$。\n联立 $u_3$ 的表达式：$u_2+1 = 2u_2 \\implies u_2 = 1$。\n于是 $u_3 = 2(1) = 2$。\n最后，由第一个方程，$u_1 - u_2 + \\lambda = 0 \\implies 0 - 1 + \\lambda = 0 \\implies \\lambda = 1$。\n解为 $\\boldsymbol{u} = \\{0, 1, 2\\}^T$，拉格朗日乘子为 $\\lambda=1$。\n\n*   **罚函数法：**\n势能通过增加一个罚函数项进行增广：$\\Pi_\\beta(\\boldsymbol{u}) = \\frac{1}{2}\\boldsymbol{u}^T \\boldsymbol{K} \\boldsymbol{u} - \\boldsymbol{u}^T \\boldsymbol{F} + \\frac{1}{2}\\beta u_1^2$。\n对 $\\boldsymbol{u}$ 最小化 $\\Pi_\\beta$ 得到 $\\boldsymbol{K}\\boldsymbol{u} - \\boldsymbol{F} + \\beta \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix} u_1 = \\boldsymbol{0}$。\n这可以写成 $\\boldsymbol{K}_\\beta \\boldsymbol{u} = \\boldsymbol{F}$，其中罚函数刚度矩阵为：\n$\\boldsymbol{K}_\\beta = \\boldsymbol{K} + \\beta \\begin{pmatrix} 1 & 0 & 0 \\\\ 0 & 0 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix} = \\begin{pmatrix} 1+\\beta & -1 & 0 \\\\ -1 & 2 & -1 \\\\ 0 & -1 & 1 \\end{pmatrix}$。\n方程组为：\n$$\n\\begin{pmatrix}\n1+\\beta & -1 & 0 \\\\\n-1 & 2 & -1 \\\\\n0 & -1 & 1\n\\end{pmatrix}\n\\begin{pmatrix} u_1 \\\\ u_2 \\\\ u_3 \\end{pmatrix}\n=\n\\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix}\n$$\n由第三个方程，$-u_2 + u_3 = 1 \\implies u_3 = u_2+1$。\n代入第二个方程：$-u_1 + 2u_2 - (u_2+1) = 0 \\implies u_2 = u_1+1$。\n将此代入第一个方程：$(1+\\beta)u_1 - (u_1+1) = 0 \\implies \\beta u_1 = 1 \\implies u_1 = \\frac{1}{\\beta}$。\n于是，$u_2 = \\frac{1}{\\beta}+1$ 且 $u_3 = u_2+1 = \\frac{1}{\\beta}+2$。\n罚函数解为 $\\boldsymbol{u}_\\beta = \\{\\frac{1}{\\beta}, 1+\\frac{1}{\\beta}, 2+\\frac{1}{\\beta}\\}^T$。\n\n**3) 罚函数解向拉格朗日乘子解的收敛性**\n\n我们将罚函数解 $\\boldsymbol{u}_\\beta$ 与拉格朗日乘子解 $\\boldsymbol{u}_{LM} = \\{0, 1, 2\\}^T$ 进行比较。\n取 $\\boldsymbol{u}_\\beta$ 的每个分量在 $\\beta \\to \\infty$ 时的极限：\n$\\lim_{\\beta \\to \\infty} u_{1,\\beta} = \\lim_{\\beta \\to \\infty} \\frac{1}{\\beta} = 0$。\n$\\lim_{\\beta \\to \\infty} u_{2,\\beta} = \\lim_{\\beta \\to \\infty} (1+\\frac{1}{\\beta}) = 1$。\n$\\lim_{\\beta \\to \\infty} u_{3,\\beta} = \\lim_{\\beta \\to \\infty} (2+\\frac{1}{\\beta}) = 2$。\n因此，$\\lim_{\\beta \\to \\infty} \\boldsymbol{u}_\\beta = \\boldsymbol{u}_{LM}$。\n\n为了通过矩阵结构来证明这一点，我们识别出罚力。在罚函数法中，平衡方程第一项中的 $\\beta u_1$ 可被看作是拉格朗日乘子的代理，即 $\\lambda_\\beta = \\beta u_1$。从我们的解中，我们发现 $\\lambda_\\beta = \\beta (1/\\beta) = 1$。这是一个常数。罚函数系统 $(\\boldsymbol{K}+\\beta \\boldsymbol{C}\\boldsymbol{C}^T)\\boldsymbol{u}_\\beta = \\boldsymbol{F}$ 可以重写为以下方程组：\n$\\boldsymbol{K} \\boldsymbol{u}_\\beta + \\lambda_\\beta \\boldsymbol{C} = \\boldsymbol{F}$\n$u_{1,\\beta} = \\lambda_\\beta / \\beta$\n在我们的案例中，$\\lambda_\\beta = 1$。当 $\\beta \\to \\infty$ 时，第二个方程变为 $u_{1,\\beta} \\to 0$。在极限情况下，该系统变为：\n$\\boldsymbol{K} \\boldsymbol{u} + \\lambda \\boldsymbol{C} = \\boldsymbol{F}$\n$u_1 = 0$\n这正是拉格朗日乘子法的 KKT 系统。因此，罚函数系统的解收敛于拉格朗日乘子系统的解。\n\n**4) 条件数的渐近行为**\n\n条件数为 $\\kappa_2(\\boldsymbol{K}_\\beta) = \\frac{\\mu_{max}(\\beta)}{\\mu_{min}(\\beta)}$，其中 $\\mu_{max}(\\beta)$ 和 $\\mu_{min}(\\beta)$ 分别是 $\\boldsymbol{K}_\\beta$ 的最大和最小特征值。我们需要找到这些特征值在 $\\beta \\to \\infty$ 时的渐近行为。\n矩阵为 $\\boldsymbol{K}_\\beta = \\boldsymbol{K} + \\beta \\boldsymbol{P}$，其中 $\\boldsymbol{P} = \\boldsymbol{C}\\boldsymbol{C}^T$，$\\boldsymbol{C}=\\{1,0,0\\}^T$。\n\n*   **最大特征值 $\\mu_{max}(\\beta)$：**\n    矩阵 $\\boldsymbol{P}$ 是一个秩一投影矩阵。特征值的微扰理论表明，对于形如 $\\beta \\boldsymbol{P}$ 的微扰，一个特征值将与 $\\beta$ 成比例增长。其渐近行为由 $\\mu_{max}(\\beta) \\approx \\beta (\\boldsymbol{C}^T \\boldsymbol{C}) + \\boldsymbol{C}^T\\boldsymbol{K}\\boldsymbol{C} = \\beta(1) + 1$ 给出。\n    因此，当 $\\beta \\to \\infty$ 时，$\\mu_{max}(\\beta) \\sim \\beta$。\n\n*   **最小特征值 $\\mu_{min}(\\beta)$：**\n    $\\boldsymbol{K}_\\beta$ 的其他特征值收敛到原始矩阵 $\\boldsymbol{K}$ 在精确满足约束条件的子空间上的投影的特征值。这个子空间是 $u_1=0$ 的子空间。找到这个约束系统的特征值等价于找到在强制 $u_1=0$ 条件下，对应于自由度 $u_2, u_3$ 的刚度矩阵的特征值。这是通过移除 $\\boldsymbol{K}$ 的第一行和第一列得到的子矩阵 $\\boldsymbol{K}_{red}$：\n    $\\boldsymbol{K}_{red} = \\begin{pmatrix} 2 & -1 \\\\ -1 & 1 \\end{pmatrix}$。\n    $\\boldsymbol{K}_{red}$ 的特征值 $\\mu'$ 由特征方程求得：\n    $\\det(\\boldsymbol{K}_{red} - \\mu' \\boldsymbol{I}) = (2-\\mu')(1-\\mu') - (-1)^2 = 0$\n    $\\mu'^2 - 3\\mu' + 2 - 1 = 0$\n    $\\mu'^2 - 3\\mu' + 1 = 0$。\n    其根为 $\\mu' = \\frac{3 \\pm \\sqrt{3^2 - 4(1)(1)}}{2} = \\frac{3 \\pm \\sqrt{5}}{2}$。\n    当 $\\beta \\to \\infty$ 时，$\\boldsymbol{K}_\\beta$ 的最小特征值 $\\mu_{min}(\\beta)$ 将收敛到这两个值中较小的一个。\n    当 $\\beta \\to \\infty$ 时，$\\mu_{min}(\\beta) \\to \\frac{3 - \\sqrt{5}}{2}$。\n\n*   **条件数：**\n    条件数的渐近行为是最大和最小特征值渐近行为的比率：\n    $$\n    \\kappa_2(\\boldsymbol{K}_\\beta) = \\frac{\\mu_{max}(\\beta)}{\\mu_{min}(\\beta)} \\sim \\frac{\\beta}{\\frac{3 - \\sqrt{5}}{2}} = \\left(\\frac{2}{3 - \\sqrt{5}}\\right) \\beta.\n    $$\n    问题要求常数 $c$ 满足 $\\kappa_2(\\boldsymbol{K}_\\beta) \\sim c\\,\\beta$。因此，\n    $c = \\frac{2}{3 - \\sqrt{5}}$。\n    为了简化这个表达式，我们对分母进行有理化：\n    $c = \\frac{2}{3 - \\sqrt{5}} \\times \\frac{3 + \\sqrt{5}}{3 + \\sqrt{5}} = \\frac{2(3 + \\sqrt{5})}{3^2 - (\\sqrt{5})^2} = \\frac{2(3 + \\sqrt{5})}{9 - 5} = \\frac{2(3 + \\sqrt{5})}{4}$。\n    $c = \\frac{3 + \\sqrt{5}}{2}$。\n此即为所求常数。可以认出，它正是黄金比例的平方，$\\phi^2$。", "answer": "$$\\boxed{\\frac{3 + \\sqrt{5}}{2}}$$", "id": "3586814"}, {"introduction": "在理解了罚函数法的病态性挑战后，一个自然的疑问是：如何明智地选择罚参数？这项练习旨在回答这一关键的实际问题。你将从第一性原理出发，为罚参数 $\\epsilon$ 推导出一个封闭形式的规则，该规则将其与单元的物理刚度及用户指定的目标精度公差 $\\theta$ 直接联系起来，从而在精度和数值稳定性之间取得平衡。[@problem_id:3586819]", "problem": "考虑一根沿$x$轴放置的线性弹性杆，其横截面积$A$、杨氏模量$E$和网格尺寸（单元长度）$h$均为常数。在有限元法（FEM）框架内，使用一个标准的双节点线性有限元对此杆进行建模。左节点的位移$u_{1}$被指定为$\\bar{u}$，但将通过带有罚参数$\\epsilon$的二次罚函数法来施加。右节点的位移$u_{2}$被精确固定为零。不存在外部体力或面力。罚函数法在总势能中增加了一个项 $\\frac{1}{2}\\,\\epsilon\\,(u_{1}-\\bar{u})^{2}$。\n\n从最小势能原理和基本线性弹性理论出发，推导出一个关于罚参数$\\epsilon$的闭式法则，以保证点约束违背量的大小$|u_{1}-\\bar{u}|$不超过指定幅值的一个用户指定的无量纲容差分数$\\theta$，即$|u_{1}-\\bar{u}| \\leq \\theta\\,|\\bar{u}|$，其中 $0  \\theta  1$。您的法则必须将$\\epsilon$明确地表示为局部单元刚度、网格尺寸和容差的函数。使用双节点杆的标准单元刚度$k_{e}$，并将其与材料和几何参数相关联，以明确其对网格尺寸的依赖性。\n\n为了物理上的清晰性，请通过展示从能量驻值条件推导出的平衡条件，并根据拉格朗日乘子（反力）概念解释罚函数的施加方式，从而从第一性原理证明该法则的合理性，并注意在二次罚函数法中，派生的反力为$\\lambda \\approx \\epsilon\\,g$，其中$g=u_{1}-\\bar{u}$。\n\n提供$\\epsilon$关于$E$、$A$、$h$和$\\theta$的最终表达式。以牛顿/米（Newton per meter）为单位表示$\\epsilon$。无需进行数值计算。", "solution": "首先对问题进行验证，以确保其科学基础可靠、提法恰当且客观。\n\n**步骤 1：提取已知条件**\n- **系统：** 沿$x$轴的线性弹性杆。\n- **模型：** 单个双节点线性有限元。\n- **几何与材料属性：** 恒定的横截面积$A$、杨氏模量$E$和单元长度（网格尺寸）$h$。\n- **节点位移：** 左节点位移为$u_{1}$，右节点位移为$u_{2}$。\n- **边界条件与约束：**\n    - 左节点位移$u_{1}$被指定为$\\bar{u}$。此约束通过二次罚函数法施加。\n    - 右节点位移固定为：$u_{2} = 0$。\n- **载荷：** 无外部体力或面力。\n- **罚函数公式：** 罚函数在总势能中增加一个项 $\\frac{1}{2}\\,\\epsilon\\,(u_{1}-\\bar{u})^{2}$，其中$\\epsilon$是罚参数。\n- **要求条件：** 约束违背量的大小必须有界：$|u_{1}-\\bar{u}| \\leq \\theta\\,|\\bar{u}|$，其中$\\theta$是用户指定的无量纲容差分数，且 $0  \\theta  1$。\n- **目标：** 推导$\\epsilon$关于$E$、$A$、$h$和$\\theta$的闭式法则。\n- **论证：** 必须从最小势能原理出发论证该法则，并结合拉格朗日乘子概念进行解释。\n\n**步骤 2：使用提取的已知条件进行验证**\n该问题在科学上基于线性弹性理论和有限元法（FEM）。使用二次罚函数法施加本质边界条件是计算力学中的一种标准且被广泛理解的技术。问题提法恰当，提供了所有必要的参数和明确的目标。语言精确客观。不存在矛盾、数据缺失或违反物理原理的情况。\n\n**步骤 3：结论与行动**\n问题被判定为**有效**。将推导解答。\n\n**解答推导**\n\n求解从最小势能原理开始。由于没有外部载荷，系统的总势能$\\Pi$是内应变能$U$和罚函数项势能$\\Pi_{penalty}$之和。\n\n一个双节点杆单元的内应变能由下式给出：\n$$\nU = \\frac{1}{2} \\mathbf{d}^T \\mathbf{K}_e \\mathbf{d}\n$$\n其中$\\mathbf{d} = \\begin{pmatrix} u_1 \\\\ u_2 \\end{pmatrix}$是节点位移向量，$\\mathbf{K}_e$是单元刚度矩阵。对于长度为$h$、面积为$A$、杨氏模量为$E$的标准杆单元，其刚度矩阵为：\n$$\n\\mathbf{K}_e = \\frac{A E}{h} \\begin{pmatrix} 1  -1 \\\\ -1  1 \\end{pmatrix}\n$$\n我们可以将标量单元刚度定义为$k_e = \\frac{A E}{h}$，因此$\\mathbf{K}_e = k_e \\begin{pmatrix} 1  -1 \\\\ -1  1 \\end{pmatrix}$。\n\n总势能$\\Pi$为：\n$$\n\\Pi(u_1, u_2) = U + \\Pi_{penalty} = \\frac{1}{2} \\begin{pmatrix} u_1  u_2 \\end{pmatrix} \\left( k_e \\begin{pmatrix} 1  -1 \\\\ -1  1 \\end{pmatrix} \\right) \\begin{pmatrix} u_1 \\\\ u_2 \\end{pmatrix} + \\frac{1}{2} \\epsilon (u_1 - \\bar{u})^2\n$$\n展开矩阵乘积，应变能为$U = \\frac{1}{2} k_e (u_1^2 - 2u_1 u_2 + u_2^2)$。\n总势能为：\n$$\n\\Pi(u_1, u_2) = \\frac{1}{2} k_e (u_1^2 - 2u_1 u_2 + u_2^2) + \\frac{1}{2} \\epsilon (u_1 - \\bar{u})^2\n$$\n我们通过设置$u_2 = 0$来施加右节点的本质边界条件。势能变为仅关于$u_1$的函数：\n$$\n\\Pi(u_1) = \\frac{1}{2} k_e u_1^2 + \\frac{1}{2} \\epsilon (u_1 - \\bar{u})^2\n$$\n根据最小势能原理，通过将$\\Pi$对自由度$u_1$的一次变分（或导数）设为零，可以找到平衡状态：\n$$\n\\frac{d\\Pi}{du_1} = 0\n$$\n$$\n\\frac{d}{du_1} \\left( \\frac{1}{2} k_e u_1^2 + \\frac{1}{2} \\epsilon (u_1 - \\bar{u})^2 \\right) = k_e u_1 + \\epsilon (u_1 - \\bar{u}) (1) = 0\n$$\n该方程代表系统的平衡方程。我们现在可以求解位移$u_1$：\n$$\nk_e u_1 + \\epsilon u_1 - \\epsilon \\bar{u} = 0\n$$\n$$\n(k_e + \\epsilon) u_1 = \\epsilon \\bar{u}\n$$\n$$\nu_1 = \\frac{\\epsilon}{k_e + \\epsilon} \\bar{u}\n$$\n约束违背量，我们记为$g$，是计算出的位移$u_1$与指定位移$\\bar{u}$之间的差值：\n$$\ng = u_1 - \\bar{u} = \\frac{\\epsilon}{k_e + \\epsilon} \\bar{u} - \\bar{u} = \\left( \\frac{\\epsilon}{k_e + \\epsilon} - 1 \\right) \\bar{u}\n$$\n$$\ng = \\left( \\frac{\\epsilon - (k_e + \\epsilon)}{k_e + \\epsilon} \\right) \\bar{u} = \\frac{-k_e}{k_e + \\epsilon} \\bar{u}\n$$\n问题要求该违背量的大小不超过指定的容差：\n$$\n|g| = |u_1 - \\bar{u}| \\leq \\theta |\\bar{u}|\n$$\n代入我们关于$g$的表达式，并假设$\\bar{u} \\neq 0$：\n$$\n\\left| \\frac{-k_e}{k_e + \\epsilon} \\bar{u} \\right| \\leq \\theta |\\bar{u}|\n$$\n$$\n\\frac{|-k_e|}{|k_e + \\epsilon|} |\\bar{u}| \\leq \\theta |\\bar{u}|\n$$\n由于$k_e = \\frac{AE}{h}  0$且罚参数$\\epsilon$必须选择为正值，分母$k_e + \\epsilon$总是正的。因此，我们可以去掉绝对值符号：\n$$\n\\frac{k_e}{k_e + \\epsilon} \\leq \\theta\n$$\n我们现在求解这个关于罚参数$\\epsilon$的不等式。由于$0  \\theta  1$：\n$$\nk_e \\leq \\theta (k_e + \\epsilon)\n$$\n$$\nk_e \\leq \\theta k_e + \\theta \\epsilon\n$$\n$$\nk_e - \\theta k_e \\leq \\theta \\epsilon\n$$\n$$\nk_e (1 - \\theta) \\leq \\theta \\epsilon\n$$\n由于$\\theta  0$，我们可以用$\\theta$除不等式两边而不改变不等号方向：\n$$\n\\epsilon \\geq \\frac{k_e (1 - \\theta)}{\\theta}\n$$\n这个不等式提供了选择$\\epsilon$的法则。为保证条件得到满足，我们必须选择至少这么大的$\\epsilon$。一种常见的做法是将$\\epsilon$设为满足条件的最小值，这给出了可接受区域的边界。因此，该法则是：\n$$\n\\epsilon = \\frac{1-\\theta}{\\theta} k_e\n$$\n最后，我们代入单元刚度的定义$k_e = \\frac{AE}{h}$，将$\\epsilon$用基本材料和几何参数表示：\n$$\n\\epsilon = \\frac{1-\\theta}{\\theta} \\frac{A E}{h}\n$$\n$\\epsilon$的单位与刚度相同，为$[N/m]$，符合要求。\n\n**论证与解释**\n从势能驻值条件推导出的平衡方程是$k_e u_1 + \\epsilon (u_1 - \\bar{u}) = 0$。\n项$k_e u_1$代表节点1抵抗变形的内弹性力。项$\\epsilon (u_1 - \\bar{u})$是由罚约束施加的力。让我们将约束违背量定义为$g = u_1 - \\bar{u}$。则平衡方程为$k_e u_1 + \\epsilon g = 0$。\n\n在拉格朗日乘子法中，通过引入一个拉格朗日乘子$\\lambda$并在势能中增加一个项$\\lambda g(u)$来施加约束$g(u)=0$。关于位移的驻值条件随后产生一个形式为$F_{internal} + \\lambda \\frac{\\partial g}{\\partial u} = 0$的平衡方程。对于我们的约束$g=u_1-\\bar{u}$，这变为$k_e u_1 + \\lambda = 0$。在这里，$\\lambda$是为精确施加约束$u_1 = \\bar{u}$所需的反力。\n\n将罚函数法的平衡方程与拉格朗日乘子法的平衡方程进行比较，我们可以识别出罚函数法中派生的反力为$\\lambda_{penalty} = \\epsilon g = \\epsilon(u_1 - \\bar{u})$。这就是所要求的解释，即反力$\\lambda$被近似为$\\epsilon g$。当$\\epsilon \\to \\infty$时，违背量$g \\to 0$，迫使$u_1 \\to \\bar{u}$，罚函数法收敛到精确解。我们推导的$\\epsilon$法则量化了对于一个给定的、有限的、非零的误差容差$\\theta$，罚参数需要多大。它表明，要实现更小的容差（更小的$\\theta$），需要更大的罚参数$\\epsilon$，因为当$\\theta \\to 0^{+}$时，$\\frac{1-\\theta}{\\theta} \\to \\infty$。该法则还表明，$\\epsilon$必须与单元的物理刚度$k_e$成比例，这在物理上是直观的：一个更刚性的结构需要一个更刚性的罚“弹簧”来施加位移。", "answer": "$$\n\\boxed{\\left(\\frac{1-\\theta}{\\theta}\\right) \\frac{A E}{h}}\n$$", "id": "3586819"}, {"introduction": "最后，我们将从线性问题迈向更具挑战性的非线性、非光滑领域。此练习将引导你为一个模拟摩擦粘滑转换的简化模型，实施并分析一个增广拉格朗日算法。你将探索如何通过对罚参数 $\\rho$ 的连续化策略（即 $\\rho_{k+1} = \\beta \\rho_k$）来保证求解器在处理复杂路径依赖问题时的收敛性和鲁棒性，这对于解决实际工程中的接触问题至关重要。[@problem_id:3586825]", "problem": "考虑一个通过约束最小化来捕捉粘滑转换的单自由度准静态切向接触代理模型。设在给定加载步下的施加相对位移为 $u \\in \\mathbb{R}$，切向刚度为 $k_t  0$，库仑摩擦阈值（切向极限力）为 $T_c  0$。定义试探牵引力 $t_{\\text{trial}} = k_t u$。容许牵引力集是闭区间 $\\mathcal{T} = [-T_c, T_c]$。在该加载步下，物理上一致的牵引力是以下凸约束最小化问题的解\n$$\n\\min_{t \\in \\mathbb{R}} \\ \\phi(t) \\quad \\text{subject to} \\quad g_1(t) \\le 0, \\ g_2(t) \\le 0,\n$$\n其中，类能量目标函数为\n$$\n\\phi(t) = \\tfrac{1}{2}\\,k_t^{-1}\\,(t - k_t u)^2,\n$$\n不等式约束通过以下方式强制执行容许集\n$$\ng_1(t) = t - T_c \\le 0, \\qquad g_2(t) = -t - T_c \\le 0.\n$$\n该模型再现了粘滑行为：如果 $|t_{\\text{trial}}| \\le T_c$（粘着），则约束最小化解为 $t^\\star = t_{\\text{trial}}$；如果 $|t_{\\text{trial}}|  T_c$（滑动），则约束最小化解为 $t^\\star = \\operatorname{sign}(t_{\\text{trial}})\\,T_c$。\n\n您将使用 Powell–Hestenes–Rockafellar 增广拉格朗日方法来强制执行不等式约束。对于给定的一对非负拉格朗日乘子 $\\lambda_1 \\ge 0$、$\\lambda_2 \\ge 0$ 和罚参数 $\\rho  0$，增广拉格朗日函数为\n$$\n\\mathcal{L}_\\rho(t,\\lambda_1,\\lambda_2) \\equiv \\phi(t) + \\sum_{i=1}^2 \\frac{\\rho}{2}\\left(\\left[ g_i(t) + \\frac{\\lambda_i}{\\rho} \\right]_+^2 - \\left(\\frac{\\lambda_i}{\\rho}\\right)^2\\right),\n$$\n其中 $[x]_+ = \\max(x,0)$。对于固定的 $(\\lambda_1,\\lambda_2,\\rho)$，内层（原始）最小化步骤计算\n$$\nt^{(m)} \\in \\arg\\min_{t \\in \\mathbb{R}} \\ \\mathcal{L}_{\\rho^{(m)}}\\!\\left(t,\\lambda_1^{(m)},\\lambda_2^{(m)}\\right).\n$$\n然后执行标准的投影拉格朗日乘子更新\n$$\n\\lambda_i^{(m+1)} = \\max\\left(0, \\ \\lambda_i^{(m)} + \\rho^{(m)} g_i\\!\\left(t^{(m)}\\right)\\right), \\quad i \\in \\{1,2\\}.\n$$\n您将对罚参数使用由下式给出的延拓方案\n$$\n\\rho^{(m+1)} = \\beta \\, \\rho^{(m)}, \\qquad \\beta  1.\n$$\n\n将外层迭代中的基于 Karush–Kuhn–Tucker (KKT) 残差的评价函数定义为\n$$\n\\mathcal{M}\\!\\left(t,\\lambda_1,\\lambda_2\\right) = \\tfrac{1}{2}\\left(r_s^2 + \\left[g_1(t)\\right]_+^2 + \\left[g_2(t)\\right]_+^2 \\right),\n$$\n其中驻点残差使用经典的拉格朗日驻点条件（其中 $a = k_t^{-1}$）\n$$\nr_s = a\\,(t - k_t u) + \\lambda_1 - \\lambda_2.\n$$\n当且仅当 KKT 条件在 $\\lambda_1,\\lambda_2 \\ge 0$ 和 $g_1(t),g_2(t) \\le 0$ 的情况下得到满足时，此 $\\mathcal{M}$ 才为零。\n\n为一系列能够引发重复粘滑转换的加载步 $u_n$ 实现上述增广拉格朗日算法：\n- 在两个完整周期内，使用 $k_t = 10.0$、$T_c = 1.0$ 和 $N = 40$ 个等间距加载步，其中\n$$\nu_n = A \\sin\\!\\left(2\\pi \\frac{n}{N/2}\\right), \\quad n = 0,1,\\dots,N,\n$$\n其中 $A = 0.2$。注意 $k_t A = 2.0  T_c$，这保证了在峰值处发生滑动，在零点附近发生粘着。\n- 在 $n=0$ 时，使用 $t^{(0)} = 0$、$\\lambda_1^{(0)} = 0$、$\\lambda_2^{(0)} = 0$ 和 $\\rho^{(0)} = \\rho_0$（其中 $\\rho_0 = 1.0$）进行初始化。\n- 对于 $n \\ge 1$，将 $t$ 初始化为前一个收敛值，以捕捉跨越粘滑转换的路径依赖性。\n\n对于每个加载步 $n$，执行由以下部分组成的外层迭代 $m = 0,1,2,\\dots$：\n- 通过在一维光滑、分段二次可微的目标函数上使用线搜索牛顿法进行原始最小化 $t^{(m)} = \\arg\\min_t \\mathcal{L}_{\\rho^{(m)}}(t,\\lambda_1^{(m)},\\lambda_2^{(m)})$。当梯度绝对值范数满足 $|\\partial \\mathcal{L}_{\\rho^{(m)}}/\\partial t| \\le \\varepsilon_{\\text{inner}}$（其中 $\\varepsilon_{\\text{inner}} = 10^{-10}$）时，终止内层求解。\n- 计算 $\\mathcal{M}^{(m)} = \\mathcal{M}(t^{(m)},\\lambda_1^{(m)},\\lambda_2^{(m)})$。\n- 检查外层收敛性：如果 $\\mathcal{M}^{(m)} \\le \\varepsilon_{\\text{outer}}$（其中 $\\varepsilon_{\\text{outer}} = 10^{-8}$），则宣布当前加载步收敛；否则，如上更新 $(\\lambda_1,\\lambda_2)$ 和 $\\rho$ 并继续，为保证鲁棒性，最多进行 $m_{\\max} = 50$ 次外层迭代。\n\n按如下方式量化延拓因子 $\\beta$ 对评价函数下降率和跨粘滑转换的鲁棒性的影响：\n- 对于每个加载步，收集外层迭代中的序列 $\\{\\mathcal{M}^{(m)}\\}$。对于前项严格为正的每个连续对，构成比率 $r^{(m)} = \\mathcal{M}^{(m+1)}/\\mathcal{M}^{(m)}$。将所有加载步和迭代中的所有此类比率聚合到单个集合 $\\mathcal{R}$ 中，并计算几何平均缩减因子\n$$\n\\bar{r} = \\exp\\!\\left(\\frac{1}{|\\mathcal{R}|}\\sum_{r \\in \\mathcal{R}} \\ln r\\right),\n$$\n约定如果 $|\\mathcal{R}| = 0$，则 $\\bar{r} = 1.0$。\n- 将鲁棒性定义为一个布尔值，指示是否所有加载步都在 $m_{\\max}$ 次外层迭代内收敛，即外循环是否对每个加载步都满足 $\\mathcal{M}^{(m)} \\le \\varepsilon_{\\text{outer}}$。\n\n测试套件：\n- 三个测试用例，具有不同的延拓因子 $\\beta$，同时保持 $\\rho_0 = 1.0$：\n  1. $\\beta = 1.2$。\n  2. $\\beta = 2.0$。\n  3. $\\beta = 10.0$。\n所有其他参数均如上所述。\n\n您的程序必须：\n- 实现上述算法。\n- 对于每个测试用例，计算序对 $[\\bar{r}, \\text{robust}]$，其中 $\\bar{r}$ 是一个浮点数，$\\text{robust}$ 是一个布尔值。\n- 生成单行输出，其中包含三个测试用例的结果，格式为方括号内以逗号分隔的列表，其中每个元素本身就是一个包含两个元素的列表。例如，输出格式必须与以下完全相同\n$[ [r_1,\\ \\text{robust}_1],\\ [r_2,\\ \\text{robust}_2],\\ [r_3,\\ \\text{robust}_3] ]$\n无附加文本。\n\n不需要物理单位；所有量都是无量纲的。角度（如有）以弧度为单位，但此处未使用。描述中的所有数值常数都应严格按给定值处理。实现必须采用现代编程语言，并且不得要求任何用户输入。", "solution": "该问题要求针对一个一维准静态摩擦接触问题，实现并分析 Powell-Hestenes-Rockafellar (PHR) 增广拉格朗日方法 (ALM)。其目标是解决一个模拟粘滑行为的约束最小化问题，并评估该算法在不同罚参数更新策略下的性能。\n\n该物理模型被定义为对一个类能量目标函数 $\\phi(t)$ 进行约束最小化，约束条件是牵引力保持在容许牵引力集 $\\mathcal{T}$ 内。\n问题是：\n$$\n\\min_{t \\in \\mathbb{R}} \\ \\phi(t) = \\frac{1}{2} k_t^{-1} (t - k_t u)^2 \\quad \\text{subject to} \\quad t \\in [-T_c, T_c].\n$$\n在此，$t$ 是切向牵引力，$u$ 是施加的相对位移，$k_t = 10.0$ 是切向刚度，$T_c = 1.0$ 是摩擦极限。约束可以写为 $g_1(t) = t - T_c \\le 0$ 和 $g_2(t) = -t - T_c \\le 0$。这是一个凸优化问题，因为它涉及在一个闭合的凸集（一个区间）上最小化一个严格凸的二次函数，这保证了其解的唯一性。\n\n增广拉格朗日方法将这个约束问题转化为一系列无约束问题。PHR 增广拉格朗日函数由下式给出：\n$$\n\\mathcal{L}_\\rho(t,\\lambda_1,\\lambda_2) = \\phi(t) + \\sum_{i=1}^2 \\frac{\\rho}{2}\\left(\\left[ g_i(t) + \\frac{\\lambda_i}{\\rho} \\right]_+^2 - \\left(\\frac{\\lambda_i}{\\rho}\\right)^2\\right),\n$$\n其中 $\\lambda_1, \\lambda_2 \\ge 0$ 分别是与 $g_1$ 和 $g_2$ 相关联的拉格朗日乘子，$\\rho  0$ 是一个罚参数，$[x]_+ = \\max(x, 0)$ 是斜坡函数。\n\n整个算法通过一系列加载步 $u_n$（其中 $n=0, 1, \\dots, N$）进行。对于每个加载步，一个外循环（由 $m$ 索引）迭代地求解 Karush-Kuhn-Tucker (KKT) 条件。\n\n**外循环：乘子与罚参数更新**\n在每次外层迭代 $m$ 中，给定当前状态 $(t^{(m-1)}, \\lambda_1^{(m)}, \\lambda_2^{(m)}, \\rho^{(m)})$，算法首先解决一个原始最小化问题，然后更新对偶变量和罚参数。\n\n1.  **原始最小化（内循环）：** 每次外层迭代的核心是找到牵引力 $t^{(m)}$，它能为当前的一组乘子和罚参数最小化增广拉格朗日函数：\n    $$\n    t^{(m)} \\in \\arg\\min_{t \\in \\mathbb{R}} \\ \\mathcal{L}_{\\rho^{(m)}}\\!\\left(t,\\lambda_1^{(m)},\\lambda_2^{(m)}\\right).\n    $$\n    这是一个无约束的一维最小化问题。目标函数 $\\mathcal{L}_\\rho$ 是凸函数且分段二次可微。我们采用线搜索 Newton-Raphson 方法来找到其梯度的根。$\\mathcal{L}_\\rho$ 对 $t$ 的一阶导数为：\n    $$\n    \\frac{\\partial \\mathcal{L}_\\rho}{\\partial t} = k_t^{-1}(t - k_t u) + \\rho \\left[ t - T_c + \\frac{\\lambda_1}{\\rho} \\right]_+ - \\rho \\left[ -t - T_c + \\frac{\\lambda_2}{\\rho} \\right]_+.\n    $$\n    其二阶导数（Hessian 矩阵）是分段常数，为：\n    $$\n    \\frac{\\partial^2 \\mathcal{L}_\\rho}{\\partial t^2} = k_t^{-1} + \\rho H\\left(t - T_c + \\frac{\\lambda_1}{\\rho}\\right) + \\rho H\\left(-t - T_c + \\frac{\\lambda_2}{\\rho}\\right),\n    $$\n    其中 $H(x)$ 是 Heaviside 阶跃函数（如果 $x  0$ 则 $H(x) = 1$，否则为 $0$）。内层牛顿循环一直迭代，直到梯度的绝对值降至容差 $\\varepsilon_{\\text{inner}} = 10^{-10}$ 以下。使用回溯线搜索来确保牛顿迭代的全局收敛性。\n\n2.  **收敛性检查：** 在获得 $t^{(m)}$ 后，我们使用一个评价函数 $\\mathcal{M}$ 来检查外循环的收敛性，该函数衡量 KKT 条件的违反程度：\n    $$\n    \\mathcal{M}(t,\\lambda_1,\\lambda_2) = \\frac{1}{2}\\left(r_s^2 + [g_1(t)]_+^2 + [g_2(t)]_+^2 \\right),\n    $$\n    其中驻点残差为 $r_s = k_t^{-1}(t - k_t u) + \\lambda_1 - \\lambda_2$。如果 $\\mathcal{M}(t^{(m)}, \\lambda_1^{(m)}, \\lambda_2^{(m)}) \\le \\varepsilon_{\\text{outer}}$（其中 $\\varepsilon_{\\text{outer}} = 10^{-8}$），则该加载步已收敛。\n\n3.  **变量更新：** 如果未达到收敛，则为下一次迭代 $m+1$ 更新拉格朗日乘子和罚参数：\n    $$\n    \\lambda_i^{(m+1)} = \\max\\left(0, \\ \\lambda_i^{(m)} + \\rho^{(m)} g_i(t^{(m)})\\right), \\quad i \\in \\{1,2\\}.\n    $$\n    $$\n    \\rho^{(m+1)} = \\beta \\, \\rho^{(m)}.\n    $$\n    此过程重复进行，直到收敛或达到最大迭代次数 $m_{\\max} = 50$。\n\n**模拟与分析**\n该算法针对由 $u_n = A \\sin(4\\pi n / N)$ 定义的 $N+1=41$ 个加载步序列执行，其中振幅 $A=0.2$， $N=40$。路径依赖性对摩擦至关重要；因此，加载步 $n$ 处牵引力 $t$ 的初始猜测值是第 $n-1$ 步的收敛解。ALM 变量 $(\\lambda_1, \\lambda_2, \\rho)$ 在每个加载步开始时重新初始化，其中 $\\lambda_1^{(0)}=\\lambda_2^{(0)}=0$ 且 $\\rho^{(0)}=\\rho_0=1.0$。\n\n该研究分析了算法在三种延拓因子 $\\beta \\in \\{1.2, 2.0, 10.0\\}$ 下的性能。性能由两个指标量化：\n- **鲁棒性：** 一个布尔值，指示算法是否在所有 $N+1$ 个加载步中都在 $m_{\\max}$ 次迭代内收敛。\n- **收敛速率：** 评价函数的几何平均缩减因子 $\\bar{r}$，计算范围涵盖所有加载步的所有迭代。对于比率集合 $\\mathcal{R} = \\{\\mathcal{M}^{(m+1)}/\\mathcal{M}^{(m)}\\}$，其定义为：\n  $$\n  \\bar{r} = \\exp\\left(\\frac{1}{|\\mathcal{R}|}\\sum_{r \\in \\mathcal{R}} \\ln r\\right).\n  $$\n  如果集合 $\\mathcal{R}$ 中有任何比率 $r$ 为零（表示在一次迭代中收敛），则几何平均值取为零。如果集合 $\\mathcal{R}$ 为空，则 $\\bar{r}=1.0$。\n\n实现将遵循此详细过程，为每个指定的 $\\beta$ 值计算序对 $[\\bar{r}, \\text{robustness}]$。", "answer": "```python\nimport numpy as np\nimport math\n\ndef solve():\n    \"\"\"\n    Implements and analyzes an augmented Lagrangian method for a 1D frictional contact problem.\n    \"\"\"\n    # Define problem constants\n    kt = 10.0\n    Tc = 1.0\n    N = 40\n    A = 0.2\n    rho0 = 1.0\n    eps_inner = 1e-10\n    eps_outer = 1e-8\n    m_max = 50\n    betas = [1.2, 2.0, 10.0]\n\n    # Generate load steps\n    u_steps = A * np.sin(2 * np.pi * np.arange(N + 1) / (N / 2))\n\n    final_results = []\n\n    for beta in betas:\n        t_prev = 0.0\n        all_ratios = []\n        is_robust = True\n\n        for n in range(N + 1):\n            u = u_steps[n]\n\n            # Initialize state for the current load step\n            t = t_prev  # Path-dependence from previous load step\n            lambda1, lambda2 = 0.0, 0.0\n            rho = rho0\n\n            converged_in_time = False\n            M_prev = -1.0 \n\n            # Outer ALM loop\n            for m in range(m_max):\n                # --- Inner Newton-Raphson solve for t ---\n                t_k = t  # Initial guess for Newton method is primal variable from previous outer step\n\n                def L_rho(t_val):\n                    z1 = t_val - Tc + lambda1 / rho\n                    z2 = -t_val - Tc + lambda2 / rho\n                    phi = 0.5 / kt * (t_val - kt * u)**2\n                    penalty = 0.5 * rho * (max(0, z1)**2 + max(0, z2)**2)\n                    return phi + penalty\n\n                # Newton's method with line search\n                for _ in range(100):  # Max inner iterations\n                    z1 = t_k - Tc + lambda1 / rho\n                    z2 = -t_k - Tc + lambda2 / rho\n                    \n                    grad = (1/kt) * (t_k - kt * u) + rho * max(0, z1) - rho * max(0, z2)\n\n                    if abs(grad) = eps_inner:\n                        break\n                    \n                    H1 = 1.0 if z1 > 0 else 0.0\n                    H2 = 1.0 if z2 > 0 else 0.0\n                    hess = (1/kt) + rho * (H1 + H2)\n                    \n                    if hess == 0:\n                        break # Should not happen due to kt > 0\n\n                    delta_t = -grad / hess\n                    \n                    # Backtracking line search\n                    alpha = 1.0\n                    c1 = 1e-4\n                    tau = 0.5\n                    L_k = L_rho(t_k)\n                    \n                    while L_rho(t_k + alpha * delta_t) > L_k + c1 * alpha * grad * delta_t:\n                        alpha *= tau\n                        if alpha  1e-9:\n                            break\n                    \n                    t_k += alpha * delta_t\n                \n                t_m = t_k  # Converged primal variable for this outer iteration\n\n                # --- Compute KKT Merit Function and check convergence ---\n                rs = (1/kt) * (t_m - kt * u) + lambda1 - lambda2\n                g1 = t_m - Tc\n                g2 = -t_m - Tc\n                M_m = 0.5 * (rs**2 + max(0, g1)**2 + max(0, g2)**2)\n                \n                if m > 0 and M_prev > 0:\n                    ratio = M_m / M_prev\n                    all_ratios.append(ratio)\n                \n                M_prev = M_m\n                \n                if M_m = eps_outer:\n                    converged_in_time = True\n                    break\n                \n                # --- Update and prepare for next outer iteration ---\n                lambda1 = max(0, lambda1 + rho * g1)\n                lambda2 = max(0, lambda2 + rho * g2)\n                rho *= beta\n                t = t_m  # Carry forward the primal variable\n\n            if not converged_in_time:\n                is_robust = False\n            \n            t_prev = t_m # Update history for the next load step\n\n        # --- Post-process results for this beta ---\n        if not all_ratios:\n            geom_mean_r = 1.0\n        else:\n            if any(r = 0 for r in all_ratios):\n                geom_mean_r = 0.0\n            else:\n                log_sum = np.sum(np.log(all_ratios))\n                geom_mean_r = np.exp(log_sum / len(all_ratios))\n\n        final_results.append([geom_mean_r, is_robust])\n\n    # The required format is a list of lists, but Python's default print adds spaces.\n    # To match the example format exactly: `[ [r1, robust1], [r2, robust2], [r3, robust3] ]`\n    # we need to build the string manually.\n    result_str = \"[\"\n    for i, res in enumerate(final_results):\n        r_val, rob_val = res\n        # Format the boolean as lowercase 'true'/'false' as in JSON, which is a common convention\n        # though the problem shows `robust_1` which might imply a variable name. Let's use Python's bool string.\n        rob_str = str(rob_val)\n        result_str += f\"[{r_val}, {rob_str}]\"\n        if i  len(final_results) - 1:\n            result_str += \", \"\n    result_str += \"]\"\n    \n    # Based on the problem's example format `[ [r_1, robust_1], [r_2, robust_2] ...]`\n    # It appears the output should be a Python list representation. Let's use that.\n    print(final_results)\n\nsolve()\n```", "id": "3586825"}]}