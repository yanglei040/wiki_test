{"hands_on_practices": [{"introduction": "这项基础练习旨在阐明不同接触模型对计算结果的影响。通过对比无摩擦和库仑摩擦两种情况下的接触力 [@problem_id:3573033]，你将练习应用Karush-Kuhn-Tucker (KKT) 条件，并掌握接触算法中至关重要的“粘着-滑移”状态判断逻辑。", "problem": "在单个潜在接触点处，一个线性弹性体通过一个具有一个法向和一个切向的接触标架中的局部柔度映射来近似。在一个小的准静态载荷增量上，自由（无约束）相对位移增量与接触反力之间的凝聚关系被假定为线性的，并由下式给出\n$$\n\\begin{pmatrix}\ng_{n} \\\\\ns_{t}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\ng_{n}^{\\mathrm{tr}} \\\\\ns_{t}^{\\mathrm{tr}}\n\\end{pmatrix}\n+\n\\begin{pmatrix}\nc_{n}  \\alpha \\\\\n\\alpha  c_{t}\n\\end{pmatrix}\n\\begin{pmatrix}\nr_{n} \\\\\nr_{t}\n\\end{pmatrix},\n$$\n其中 $g_{n}$ 是校正后的法向间隙增量，$s_{t}$ 是校正后的切向滑移增量，$g_{n}^{\\mathrm{tr}}$ 和 $s_{t}^{\\mathrm{tr}}$ 是法向和切向上的试探（自由）相对位移，$r_{n}$ 是法向接触反力（压缩为正），$r_{t}$ 是切向接触反力（符号约定：正的 $r_{t}$ 作用在正切向方向上）。系数 $c_{n}$、$c_{t}$ 和 $\\alpha$ 是对称正定局部柔度矩阵的分量。\n\n通过法向上的 Karush–Kuhn–Tucker (KKT) 条件来强制执行不可穿透性和接触互补性，\n$$\ng_{n} \\ge 0,\\quad r_{n} \\ge 0,\\quad r_{n}\\,g_{n} = 0,\n$$\n并在切向考虑两种备选的摩擦模型：\n\n1. 无摩擦接触：$r_{t} = 0$。\n\n2. 摩擦系数为 $\\mu$ 的库仑摩擦：该集值定律强制执行以下两种情况之一：粘滞，此时 $s_{t} = 0$ 且 $|r_{t}| \\le \\mu\\,r_{n}$；或者滑移，此时 $s_{t} \\ne 0$，$|r_{t}| = \\mu\\,r_{n}$，且 $r_{t}$ 的方向与 $s_{t}$ 的方向相反。\n\n假设增量的以下数据：$c_{n} = 1.0 \\times 10^{-6}$，$c_{t} = 3.0 \\times 10^{-6}$，$\\alpha = 0.5 \\times 10^{-6}$，$g_{n}^{\\mathrm{tr}} = -1.0 \\times 10^{-4}$，$s_{t}^{\\mathrm{tr}} = 3.0 \\times 10^{-4}$，以及 $\\mu = 0.5$。所有柔度的单位为 $\\mathrm{m}/\\mathrm{N}$，所有位移的单位为 $\\mathrm{m}$，所有反力的单位为 $\\mathrm{N}$。刚性障碍物是一个理想平面。\n\n仅从上述柔度映射、不可穿透性互补条件和库仑摩擦定律出发，推导无摩擦情况下的法向反力 $r_{n}^{\\mathrm{F}}$ 和库仑摩擦情况下的法向反力 $r_{n}^{\\mathrm{C}}$。通过检查与摩擦定律和 KKT 条件的一致性，判断库仑解是粘滞还是滑移。然后计算比值\n$$\n\\frac{r_{n}^{\\mathrm{C}}}{r_{n}^{\\mathrm{F}}}.\n$$\n\n以单个实数作答。无需四舍五入。该比值为无量纲；最终答案中不要包含单位。", "solution": "用户希望我按照以下步骤解决问题。\n1.  **问题验证：** 首先验证问题，以确保其在科学上是合理的、适定的和完整的。\n\n    **第 1 步：提取已知条件**\n    已知条件如下：\n    -   柔度映射：\n        $$\n        \\begin{pmatrix}\n        g_{n} \\\\\n        s_{t}\n        \\end{pmatrix}\n        =\n        \\begin{pmatrix}\n        g_{n}^{\\mathrm{tr}} \\\\\n        s_{t}^{\\mathrm{tr}}\n        \\end{pmatrix}\n        +\n        \\begin{pmatrix}\n        c_{n}  \\alpha \\\\\n        \\alpha  c_{t}\n        \\end{pmatrix}\n        \\begin{pmatrix}\n        r_{n} \\\\\n        r_{t}\n        \\end{pmatrix}\n        $$\n    -   法向 Karush-Kuhn-Tucker (KKT) 条件：$g_{n} \\ge 0$，$r_{n} \\ge 0$，$r_{n}\\,g_{n} = 0$。\n    -   无摩擦接触模型：$r_{t} = 0$。\n    -   库仑摩擦模型：粘滞 ($s_{t} = 0$ 且 $|r_{t}| \\le \\mu\\,r_{n}$) 或滑移 ($|r_{t}| = \\mu\\,r_{n}$ 且 $r_{t}$ 与 $s_{t}$ 方向相反)。\n    -   数据：$c_{n} = 1.0 \\times 10^{-6} \\, \\mathrm{m/N}$，$c_{t} = 3.0 \\times 10^{-6} \\, \\mathrm{m/N}$，$\\alpha = 0.5 \\times 10^{-6} \\, \\mathrm{m/N}$，$g_{n}^{\\mathrm{tr}} = -1.0 \\times 10^{-4} \\, \\mathrm{m}$，$s_{t}^{\\mathrm{tr}} = 3.0 \\times 10^{-4} \\, \\mathrm{m}$，以及 $\\mu = 0.5$。\n\n    **第 2 步：使用提取的已知条件进行验证**\n    该问题设置在计算接触力学的标准框架内。使用局部柔度矩阵、法向接触的 KKT 条件以及摩擦的集值定律的表述是该领域的基石。所提供的柔度矩阵是对称的。必须检查其正定性：\n    -   $c_{n} = 1.0 \\times 10^{-6}  0$。\n    -   行列式为 $\\det(C) = c_{n}c_{t} - \\alpha^2 = (1.0 \\times 10^{-6})(3.0 \\times 10^{-6}) - (0.5 \\times 10^{-6})^2 = 3.0 \\times 10^{-12} - 0.25 \\times 10^{-12} = 2.75 \\times 10^{-12}  0$。\n    由于顺序主子式和行列式均为正，因此该柔度矩阵是正定的，这是稳定系统在物理和数学上的要求。该问题有科学依据、适定、客观且完整。为求得唯一解提供了所有数据和条件。\n\n    **第 3 步：结论与行动**\n    问题被判定为有效。将推导解答。\n\n2.  **解答推导**\n\n    该问题要求计算两种情况下的法向反力：无摩擦接触 ($r_{n}^{\\mathrm{F}}$) 和库仑摩擦接触 ($r_{n}^{\\mathrm{C}}$)，然后计算它们的比值。\n\n    给定的试探法向间隙为 $g_{n}^{\\mathrm{tr}} = -1.0 \\times 10^{-4}  0$。负的试探间隙表示，如果不产生接触反力，将会发生相互穿透。为满足不可穿透条件 $g_{n} \\ge 0$，必须产生一个法向接触反力 $r_{n}  0$。KKT 互补条件 $r_{n}\\,g_{n} = 0$ 继而要求最终间隙为零，即 $g_{n} = 0$。这一点对无摩擦和有摩擦两种情况都成立。\n\n    **情况 1：无摩擦接触**\n\n    对于无摩擦接触，根据定义，切向反力为零：$r_{t} = 0$。法向的柔度关系为：\n    $$\n    g_{n} = g_{n}^{\\mathrm{tr}} + c_{n}r_{n} + \\alpha r_{t}\n    $$\n    代入条件 $g_{n} = 0$ 和 $r_{t} = 0$，我们得到：\n    $$\n    0 = g_{n}^{\\mathrm{tr}} + c_{n}r_{n}^{\\mathrm{F}}\n    $$\n    求解无摩擦情况下的法向反力 $r_{n}^{\\mathrm{F}}$：\n    $$\n    r_{n}^{\\mathrm{F}} = -\\frac{g_{n}^{\\mathrm{tr}}}{c_{n}}\n    $$\n    代入给定的数值：\n    $$\n    r_{n}^{\\mathrm{F}} = -\\frac{-1.0 \\times 10^{-4} \\, \\mathrm{m}}{1.0 \\times 10^{-6} \\, \\mathrm{m/N}} = 100 \\, \\mathrm{N}\n    $$\n\n    **情况 2：库仑摩擦接触**\n\n    对于库仑摩擦情况，我们必须确定接触是处于粘滞状态还是滑移状态。通常的做法是首先假设粘滞条件，然后验证其有效性。\n\n    **假设：粘滞**\n    粘滞条件规定最终的切向滑移增量为零：$s_{t} = 0$。根据法向接触条件，我们还有 $g_{n} = 0$。柔度方程成为一个关于未知反力 $r_{n}$ 和 $r_{t}$ 的二元线性方程组：\n    $$\n    g_{n} = 0 = g_{n}^{\\mathrm{tr}} + c_{n}r_{n} + \\alpha r_{t}\n    $$\n    $$\n    s_{t} = 0 = s_{t}^{\\mathrm{tr}} + \\alpha r_{n} + c_{t}r_{t}\n    $$\n    该方程组可以写成矩阵形式：\n    $$\n    \\begin{pmatrix}\n    c_{n}  \\alpha \\\\\n    \\alpha  c_{t}\n    \\end{pmatrix}\n    \\begin{pmatrix}\n    r_{n} \\\\\n    r_{t}\n    \\end{pmatrix}\n    =\n    -\n    \\begin{pmatrix}\n    g_{n}^{\\mathrm{tr}} \\\\\n    s_{t}^{\\mathrm{tr}}\n    \\end{pmatrix}\n    $$\n    通过矩阵求逆求解反力：\n    $$\n    \\begin{pmatrix}\n    r_{n} \\\\\n    r_{t}\n    \\end{pmatrix}\n    =\n    -\\frac{1}{c_{n}c_{t} - \\alpha^2}\n    \\begin{pmatrix}\n    c_{t}  -\\alpha \\\\\n    -\\alpha  c_{n}\n    \\end{pmatrix}\n    \\begin{pmatrix}\n    g_{n}^{\\mathrm{tr}} \\\\\n    s_{t}^{\\mathrm{tr}}\n    \\end{pmatrix}\n    $$\n    我们首先在该粘滞假设下计算反力。\n    行列式为 $\\det(C) = c_{n}c_{t} - \\alpha^2 = 2.75 \\times 10^{-12} \\, (\\mathrm{m/N})^2$。\n    粘滞假设下的法向反力为：\n    $$\n    r_{n}^{\\mathrm{stick}} = -\\frac{c_{t}g_{n}^{\\mathrm{tr}} - \\alpha s_{t}^{\\mathrm{tr}}}{c_{n}c_{t} - \\alpha^2} = \\frac{- (3.0 \\times 10^{-6})(-1.0 \\times 10^{-4}) + (0.5 \\times 10^{-6})(3.0 \\times 10^{-4})}{2.75 \\times 10^{-12}}\n    $$\n    $$\n    r_{n}^{\\mathrm{stick}} = \\frac{3.0 \\times 10^{-10} + 1.5 \\times 10^{-10}}{2.75 \\times 10^{-12}} = \\frac{4.5 \\times 10^{-10}}{2.75 \\times 10^{-12}} = \\frac{4.5}{2.75} \\times 10^2 = \\frac{18}{11} \\times 100 = \\frac{1800}{11} \\, \\mathrm{N}\n    $$\n    粘滞假设下的切向反力为：\n    $$\n    r_{t}^{\\mathrm{stick}} = -\\frac{-\\alpha g_{n}^{\\mathrm{tr}} + c_{n}s_{t}^{\\mathrm{tr}}}{c_{n}c_{t} - \\alpha^2} = \\frac{- (-(0.5 \\times 10^{-6}))(-1.0 \\times 10^{-4}) - (1.0 \\times 10^{-6})(3.0 \\times 10^{-4})}{2.75 \\times 10^{-12}}\n    $$\n    $$\n    r_{t}^{\\mathrm{stick}} = \\frac{-0.5 \\times 10^{-10} - 3.0 \\times 10^{-10}}{2.75 \\times 10^{-12}} = \\frac{-3.5 \\times 10^{-10}}{2.75 \\times 10^{-12}} = -\\frac{3.5}{2.75} \\times 10^2 = -\\frac{14}{11} \\times 100 = -\\frac{1400}{11} \\, \\mathrm{N}\n    $$\n    **粘滞假设的验证**\n    为使粘滞假设有效，切向反力必须满足摩擦不等式 $|r_{t}^{\\mathrm{stick}}| \\le \\mu r_{n}^{\\mathrm{stick}}$。\n    $$\n    |r_{t}^{\\mathrm{stick}}| = \\left|-\\frac{1400}{11}\\right| = \\frac{1400}{11} \\, \\mathrm{N}\n    $$\n    $$\n    \\mu r_{n}^{\\mathrm{stick}} = 0.5 \\times \\frac{1800}{11} = \\frac{900}{11} \\, \\mathrm{N}\n    $$\n    比较这两个值，我们发现 $\\frac{1400}{11}  \\frac{900}{11}$。因此，条件 $|r_{t}^{\\mathrm{stick}}| \\le \\mu r_{n}^{\\mathrm{stick}}$ 不被满足。粘滞假设无效，接触点必定处于滑移状态。\n\n    **滑移计算**\n    在滑移状态下，切向反力的大小通过摩擦系数与法向反力相关联：$|r_{t}| = \\mu r_{n}$。切向力的方向与相对运动（或临界运动）的方向相反。试探滑移 $s_{t}^{\\mathrm{tr}} = 3.0 \\times 10^{-4}  0$ 和计算出的粘滞摩擦力 $r_{t}^{\\mathrm{stick}} = -1400/11  0$ 都表明摩擦力作用在负切向方向上。因此，我们有：\n    $$\n    r_{t} = -\\mu r_{n}\n    $$\n    我们将此关系代入 $g_{n} = 0$ 的法向柔度方程中：\n    $$\n    0 = g_{n}^{\\mathrm{tr}} + c_{n}r_{n} + \\alpha r_{t} = g_{n}^{\\mathrm{tr}} + c_{n}r_{n} + \\alpha(-\\mu r_{n})\n    $$\n    $$\n    0 = g_{n}^{\\mathrm{tr}} + (c_{n} - \\alpha \\mu)r_{n}\n    $$\n    求解库仑摩擦情况下的法向反力 $r_{n}^{\\mathrm{C}}$：\n    $$\n    r_{n}^{\\mathrm{C}} = -\\frac{g_{n}^{\\mathrm{tr}}}{c_{n} - \\alpha \\mu}\n    $$\n    代入数值：\n    $$\n    c_{n} - \\alpha \\mu = (1.0 \\times 10^{-6}) - (0.5 \\times 10^{-6})(0.5) = (1.0 - 0.25) \\times 10^{-6} = 0.75 \\times 10^{-6} \\, \\mathrm{m/N}\n    $$\n    $$\n    r_{n}^{\\mathrm{C}} = -\\frac{-1.0 \\times 10^{-4} \\, \\mathrm{m}}{0.75 \\times 10^{-6} \\, \\mathrm{m/N}} = \\frac{1.0}{0.75} \\times 10^2 \\, \\mathrm{N} = \\frac{4}{3} \\times 100 \\, \\mathrm{N} = \\frac{400}{3} \\, \\mathrm{N}\n    $$\n    滑移非零，与滑移假设一致。其大小为 $s_{t} = s_{t}^{\\mathrm{tr}} + (\\alpha - c_{t}\\mu)r_{n}^{\\mathrm{C}} = 3.0 \\times 10^{-4} + (0.5 \\times 10^{-6} - 3.0 \\times 10^{-6} \\times 0.5)(400/3) = 3.0 \\times 10^{-4} - 1.0 \\times 10^{-6} \\times (400/3) = (3 - 4/3) \\times 10^{-4} = 5/3 \\times 10^{-4}  0$。得到的滑移为正，这与负的摩擦力 $r_{t} = -\\mu r_{n}^{\\mathrm{C}}  0$ 一致。\n\n    **最终计算：比值**\n\n    最后，我们计算所需的比值：\n    $$\n    \\frac{r_{n}^{\\mathrm{C}}}{r_{n}^{\\mathrm{F}}} = \\frac{400/3 \\, \\mathrm{N}}{100 \\, \\mathrm{N}} = \\frac{400}{300} = \\frac{4}{3}\n    $$\n    这就是最终答案。该比值为无量纲量，符合要求。", "answer": "$$\\boxed{\\frac{4}{3}}$$", "id": "3573033"}, {"introduction": "罚函数法是处理接触约束的一种常用数值近似方法，但其精度如何？本练习将理论与实践相结合，通过推导罚函数法在罚参数趋于无穷大时的渐近误差 [@problem_id:3573078]，让你深入理解该方法的收敛特性。这项实践有助于培养严谨的数学分析能力，并建立对数值方法性能的批判性认识。", "problem": "考虑一个模拟与刚性障碍物单边接触的单自由度线弹性系统。设未知位移为 $u \\in \\mathbb{R}$，线弹性刚度为 $K0$，作用方向为减小间隙的外部施加载荷为 $F0$，初始间隙为 $g_{0}0$。不可穿透约束由间隙函数 $g(u) = g_{0} - u$ 描述，并满足标准互补条件 $g(u) \\geq 0$，$\\lambda \\geq 0$ 和 $\\lambda\\,g(u) = 0$，其中 $\\lambda$ 是接触反力（拉格朗日乘子）。力学平衡（合力为零）表示为 $K\\,u + \\lambda = F$。假设系统处于接触激活状态 $F \\geq K\\,g_{0}$，因此精确的乘子解满足 $g(u)=0$。\n\n在仅原始变量的罚函数法中，通过引入罚参数 $k0$ 和罚接触力 $\\lambda_{k} = k\\,g^{-}$ 来松弛不可穿透约束，其中 $g^{-} = \\max\\{0,-g(u)\\}$。在接触激活状态下，罚函数平衡方程为 $K\\,u + \\lambda_{k} = F$，且 $g^{-} = u - g_{0}$。\n\n仅从力学平衡原理和单边接触的互补条件出发，并使用上述罚函数方法，推导当 $k \\to \\infty$ 时力预测误差 $\\Delta \\lambda(k) = \\lambda_{k} - \\lambda_{\\text{exact}}$ 的渐近展开式，展开至并包括 $k^{-2}$ 阶项，结果用 $F$、$K$、$g_{0}$ 和 $k$ 表示。你的最终答案必须是 $\\Delta \\lambda(k)$ 的一个封闭形式解析表达式，且只包含到 $k^{-2}$ 的项。无需进行数值代入；最终的方框答案中不要包含单位。", "solution": "用户要求我解决一个计算固体力学领域的问题，重点是单边接触约束。以下是解决该问题的结构化方法：\n\n**第1部分：问题验证**\n\n首先，我将根据指定规则验证问题陈述。\n\n**第1步：提取已知条件**\n\n*   系统：具有单边接触的单自由度线弹性系统。\n*   未知数：位移 $u \\in \\mathbb{R}$。\n*   常数：\n    *   线弹性刚度 $K  0$。\n    *   外部施加载荷 $F  0$。\n    *   初始间隙 $g_{0}  0$。\n*   间隙函数：$g(u) = g_{0} - u$。\n*   互补条件（精确问题）：\n    1.  $g(u) \\geq 0$。\n    2.  $\\lambda \\geq 0$，其中 $\\lambda$ 是接触反力拉格朗日乘子。\n    3.  $\\lambda\\,g(u) = 0$。\n*   平衡方程（精确问题）：$K\\,u + \\lambda = F$。\n*   假设状态：接触激活，$F \\geq K\\,g_{0}$，这意味着精确解具有 $g(u)=0$。\n*   罚函数法：\n    *   罚参数 $k  0$。\n    *   罚接触力 $\\lambda_{k} = k\\,g^{-}$，其中 $g^{-} = \\max\\{0,-g(u)\\}$。\n    *   罚函数平衡：$K\\,u + \\lambda_{k} = F$。\n    *   在接触激活状态下，$g^{-} = u - g_{0}$。\n*   目标：推导当 $k \\to \\infty$ 时力预测误差 $\\Delta \\lambda(k) = \\lambda_{k} - \\lambda_{\\text{exact}}$ 的渐近展开式，展开至并包括 $k^{-2}$ 阶项。\n\n**第2步：使用提取的已知条件进行验证**\n\n*   **科学依据：** 该问题描述了一个经典的单边接触模型，使用弹簧、刚性障碍物以及 Karush-Kuhn-Tucker (KKT) 或互补条件。罚函数法是对此类约束问题进行数值近似的标准且广泛使用的方法。所有概念都是接触力学和优化理论的基础。该设置在科学上是合理的。\n*   **适定性：** 问题定义清晰。假设 $F \\geq K\\,g_{0}$ 确保了在精确解中发生接触，使得接触未激活和接触激活状态之间的区别明确，并简化了分析。寻找渐近展开式是一个标准的数学目标，存在唯一解。\n*   **客观性：** 语言是形式化和数学化的，没有主观或模糊的术语。\n*   **完整性：** 提供了推导所需表达式的所有必要方程、定义和参数（$u, K, F, g_0, \\lambda, k, \\lambda_k$）。问题是自洽的。\n*   **一致性：** 所提供的方程和条件是相互一致的。例如，条件 $F \\geq K\\,g_{0}$ 与精确解同时满足 $g(u)=0$ 和 $\\lambda \\geq 0$ 是一致的。\n\n**第3步：结论与行动**\n\n问题陈述在科学上合理、适定、客观、完整且一致。它不违反任何无效性标准。因此，该问题是 **有效的**。我将继续进行求解。\n\n**第2部分：求解推导**\n\n目标是找到误差 $\\Delta \\lambda(k) = \\lambda_{k} - \\lambda_{\\text{exact}}$ 的渐近展开式。我将首先找到精确解（$\\lambda_{\\text{exact}}$），然后找到罚函数解（$\\lambda_{k}$）。\n\n**步骤A：确定精确解**\n\n在精确问题中，系统由平衡方程和互补条件控制。问题指定了接触激活状态，即发生接触。这意味着间隙已闭合。\n根据互补条件，只有当间隙为零，$g(u) = 0$ 时，才能存在非零的接触力 $\\lambda  0$。条件 $F \\geq K g_0$ 确保了这种情况的发生。\n将间隙函数设为零，得到精确位移 $u_{\\text{exact}}$：\n$$g(u_{\\text{exact}}) = g_{0} - u_{\\text{exact}} = 0 \\implies u_{\\text{exact}} = g_{0}$$\n现在，将此位移代入平衡方程，求得精确接触力 $\\lambda_{\\text{exact}}$：\n$$K u_{\\text{exact}} + \\lambda_{\\text{exact}} = F$$\n$$K g_{0} + \\lambda_{\\text{exact}} = F$$\n$$\\lambda_{\\text{exact}} = F - K g_{0}$$\n条件 $F \\geq K g_0$ 确保了 $\\lambda_{\\text{exact}} \\geq 0$，满足互补条件。\n\n**步骤B：确定罚函数解**\n\n在罚函数法中，互补条件 $\\lambda g(u) = 0$ 被松弛。罚函数平衡方程为：\n$$K u_{k} + \\lambda_{k} = F$$\n其中 $u_k$ 是罚函数系统中的位移。罚函数力 $\\lambda_k$ 定义为：\n$$\\lambda_{k} = k g^{-} = k \\max\\{0, -g(u_k)\\}$$\n由于系统处于接触激活状态，我们预计位移 $u_k$ 会导致微小的穿透，即 $u_k  g_0$。因此，间隙函数 $g(u_k) = g_0 - u_k$ 将为负。这得到：\n$$g^{-} = \\max\\{0, -(g_0 - u_k)\\} = u_k - g_0$$\n因此，罚函数力为：\n$$\\lambda_{k} = k(u_k - g_{0})$$\n我们现在得到一个关于两个未知数 $u_k$ 和 $\\lambda_k$ 的线性方程组：\n1. $K u_k + \\lambda_k = F$\n2. $\\lambda_k = k(u_k - g_0)$\n\n为了求解 $\\lambda_k$，我们可以先从第二个方程中表示出 $u_k$：\n$$u_k = g_{0} + \\frac{\\lambda_k}{k}$$\n将这个 $u_k$ 的表达式代入第一个方程：\n$$K \\left( g_{0} + \\frac{\\lambda_k}{k} \\right) + \\lambda_k = F$$\n$$K g_{0} + \\frac{K}{k}\\lambda_k + \\lambda_k = F$$\n提取公因式 $\\lambda_k$：\n$$\\lambda_k \\left( \\frac{K}{k} + 1 \\right) = F - K g_{0}$$\n$$\\lambda_k \\left( \\frac{K+k}{k} \\right) = F - K g_{0}$$\n求解 $\\lambda_k$ 得：\n$$\\lambda_k = (F - K g_{0}) \\frac{k}{k+K}$$\n\n**步骤C：计算误差及其渐近展开式**\n\n力预测误差为 $\\Delta \\lambda(k) = \\lambda_{k} - \\lambda_{\\text{exact}}$。代入 $\\lambda_k$ 和 $\\lambda_{\\text{exact}}$ 的表达式：\n$$\\Delta \\lambda(k) = (F - K g_{0}) \\frac{k}{k+K} - (F - K g_{0})$$\n提取公因式 $(F - K g_0)$：\n$$\\Delta \\lambda(k) = (F - K g_{0}) \\left( \\frac{k}{k+K} - 1 \\right)$$\n$$\\Delta \\lambda(k) = (F - K g_{0}) \\left( \\frac{k - (k+K)}{k+K} \\right)$$\n$$\\Delta \\lambda(k) = (F - K g_{0}) \\left( \\frac{-K}{k+K} \\right) = -K(F - K g_{0}) \\frac{1}{k+K}$$\n为了找到当 $k \\to \\infty$ 时的渐近展开式，我们展开项 $\\frac{1}{k+K}$。我们从分母中提取 $k$：\n$$\\frac{1}{k+K} = \\frac{1}{k(1 + K/k)} = \\frac{1}{k} \\left( 1 + \\frac{K}{k} \\right)^{-1}$$\n使用几何级数展开式 $(1+x)^{-1} = 1 - x + x^2 - x^3 + \\dots$（对于 $|x|1$），其中 $x = K/k$：\n$$\\left( 1 + \\frac{K}{k} \\right)^{-1} = 1 - \\frac{K}{k} + \\left(\\frac{K}{k}\\right)^2 - O\\left(k^{-3}\\right)$$\n将此代回 $\\frac{1}{k+K}$ 的表达式中：\n$$\\frac{1}{k+K} = \\frac{1}{k} \\left( 1 - \\frac{K}{k} + \\frac{K^2}{k^2} - O(k^{-3}) \\right) = \\frac{1}{k} - \\frac{K}{k^2} + \\frac{K^2}{k^3} - O(k^{-4})$$\n现在，将此展开式代入 $\\Delta \\lambda(k)$ 的表达式中：\n$$\\Delta \\lambda(k) = -K(F - K g_{0}) \\left( \\frac{1}{k} - \\frac{K}{k^2} + O(k^{-3}) \\right)$$\n分配项 $-K(F - K g_0)$：\n$$\\Delta \\lambda(k) = -\\frac{K(F - K g_{0})}{k} + \\frac{K^2(F - K g_{0})}{k^2} + O(k^{-3})$$\n问题要求展开式包含到 $k^{-2}$ 阶的项。截断级数得到最终表达式：\n$$\\Delta \\lambda(k) = -\\frac{K(F - K g_{0})}{k} + \\frac{K^2(F - K g_{0})}{k^2}$$", "answer": "$$\n\\boxed{-\\frac{K(F - K g_0)}{k} + \\frac{K^2(F - K g_0)}{k^2}}\n$$", "id": "3573078"}, {"introduction": "本章的综合性练习将带你从零开始构建一个现代化的接触问题求解器。你将学习如何利用Fischer-Burmeister互补函数将复杂的接触条件转化为非线性方程组，并为其推导一致化切线（雅可比）矩阵 [@problem_id:3573041]。完成这项练习意味着你将获得将理论公式转化为高效、稳健的半光滑牛顿法代码的核心计算力学技能。", "problem": "考虑在有限变形运动学下，一个可变形体与一个刚性固定平面之间的无摩擦单边接触。设一个代表性接触点的当前位置为 $\\mathbf{x}(\\mathbf{X}) = \\mathbf{X} + \\mathbf{u}$，其中 $\\mathbf{X}$ 是材料坐标，$\\mathbf{u}$ 是位移。不可穿透性通过一个标量间隙函数 $g(\\mathbf{u}) \\ge 0$、一个解释为法向接触力密度的非负拉格朗日乘子 $\\lambda \\ge 0$ 以及互补条件 $\\lambda\\, g(\\mathbf{u}) = 0$ 来强制执行。未知量是位移场和拉格朗日乘子场。从虚功原理和库恩-塔克互补条件出发，进行有限元离散化，以在当前构型中强制执行节点到刚性平面接触的不可穿透性。\n\n假设以下基本依据：\n- 虚功原理：在平衡状态下，内虚功、外虚功和接触虚功之和为零。\n- 有限变形映射：$\\mathbf{x} = \\mathbf{X} + \\mathbf{u}$，接触间隙在当前构型中进行评估。\n- 接触不可穿透性与互补性（库恩-塔克）：$g(\\mathbf{u}) \\ge 0$，$\\lambda \\ge 0$，$\\lambda\\, g(\\mathbf{u}) = 0$。\n- 对接触约束（节点到刚性平面）使用逐点拉格朗日乘子，并使用具有固定单位法向量 $\\mathbf{n}$ 的刚性平面。\n\n为确保互补重构中的量纲一致性，引入一个单位为米/牛顿的正缩放参数 $s$，使得 $s\\,\\lambda$ 的单位与 $g(\\mathbf{u})$ 一样为米。使用应用于 $(g(\\mathbf{u}), s\\,\\lambda)$ 的 Fischer–Burmeister 函数 $\\phi(a,b) = \\sqrt{a^2 + b^2} - (a + b)$ 来重构互补条件。为了数值稳健性，可以考虑一个平滑变体 $\\phi_\\mu(a,b) = \\sqrt{a^2 + b^2 + \\mu^2} - (a + b)$，其中 $\\mu  0$ 是一个单位为米的小平滑参数。\n\n任务 A (推导)：从虚功原理和上述定义出发，具体化到刚性平面法向上的单个节点接触自由度。设刚性平面为 $\\Gamma_c: \\mathbf{x}\\cdot\\mathbf{n} = 0$，其中 $\\mathbf{n}$ 固定。设代表性节点沿 $\\mathbf{n}$ 方向与平面的初始有符号距离为 $y_0 = \\mathbf{X}\\cdot\\mathbf{n}  0$，沿 $\\mathbf{n}$ 方向的标量位移为 $u = \\mathbf{u}\\cdot\\mathbf{n}$。间隙为 $g(u) = y_0 + u \\ge 0$。假设节点的线性弹性支撑在法向上的标量刚度为 $k$（单位：牛顿/米），因此在没有接触的情况下，节点内力等于 $k\\,u$。设沿法向的节点外力为 $f_{\\mathrm{ext}}$（单位：牛顿），在 $\\mathbf{n}$ 方向为正。推导：\n- 法向平衡的离散残差，以及使用带缩放参数 $s$（并可选地使用平滑参数 $\\mu$）的 Fischer–Burmeister 互补重构的接触残差。\n- 应用于平衡与互补方程耦合系统的半光滑牛顿法的一致切线（雅可比矩阵）。将所有导数明确地用 $u$、$\\lambda$、$g(u)$、$k$、$s$ 和 $\\mu$ 表示。\n\n任务 B (算法)：设计一个半光滑牛顿迭代法，使用任务 A 中推导的一致切线来求解 $(u, \\lambda)$ 的耦合非线性系统。使用基于残差范数小于容差的停止准则。为避免在 $(g,\\lambda) = (0,0)$ 处的不可微性，使用带有小平滑参数 $\\mu  0$ 的平滑 Fischer–Burmeister 函数 $\\phi_\\mu$。\n\n测试套件和数值规范：在一个完整的、可运行的程序中实现您的推导，并求解以下测试用例。所有量都必须使用国际单位制（SI）处理。以米为单位报告每个位移，以牛顿为单位报告每个拉格朗日乘子。\n\n- 测试用例 1（非激活接触）：$k = 1000\\,\\mathrm{N/m}$，$y_0 = 0.01\\,\\mathrm{m}$，$f_{\\mathrm{ext}} = -2\\,\\mathrm{N}$，$s = 10^{-4}\\,\\mathrm{m/N}$，$\\mu = 10^{-12}\\,\\mathrm{m}$。\n- 测试用例 2（激活接触）：$k = 1000\\,\\mathrm{N/m}$，$y_0 = 0.01\\,\\mathrm{m}$，$f_{\\mathrm{ext}} = -50\\,\\mathrm{N}$，$s = 10^{-4}\\,\\mathrm{m/N}$，$\\mu = 10^{-12}\\,\\mathrm{m}$。\n- 测试用例 3（临界接触情况）：$k = 1000\\,\\mathrm{N/m}$，$y_0 = 0.01\\,\\mathrm{m}$，$f_{\\mathrm{ext}} = -10\\,\\mathrm{N}$，$s = 10^{-4}\\,\\mathrm{m/N}$，$\\mu = 10^{-12}\\,\\mathrm{m}$。\n- 测试用例 4（中性角点）：$k = 1000\\,\\mathrm{N/m}$，$y_0 = 0.0\\,\\mathrm{m}$，$f_{\\mathrm{ext}} = 0\\,\\mathrm{N}$，$s = 10^{-4}\\,\\mathrm{m/N}$，$\\mu = 10^{-12}\\,\\mathrm{m}$。\n\n答案规范：\n- 对每个测试用例，数值求解 $(u, \\lambda)$。\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，顺序为 $[u_1, \\lambda_1, u_2, \\lambda_2, u_3, \\lambda_3, u_4, \\lambda_4]$，每个浮点数四舍五入到六位小数。", "solution": "问题陈述经评估是有效的，因为它在计算接触力学方面有科学依据，是适定的、客观的，并为可解的数值问题提供了完整且一致的设置。\n\n任务是推导一维节点到平面接触问题的控制方程和一致切线，然后实现一个半光滑牛顿法来求解节点位移 $u$ 和接触力（拉格朗日乘子）$\\lambda$。\n\n### 1. 控制方程的推导\n\n该系统由两个主要未知量定义：沿刚性平面法向的位移 $u$ 和接触力大小 $\\lambda$。我们需要建立一个包含两个方程的方程组 $\\mathbf{R}(u, \\lambda) = \\mathbf{0}$ 来求解这些未知量。\n\n第一个方程源于作用在节点上的力平衡。根据标准的有限元公式，平衡残差 $R_u$ 是外力总和与内力之差。沿外法向 $\\mathbf{n}$ 的力包括：\n- 来自刚度为 $k$ 的线性弹性支撑的内部恢复力。该力为 $F_{\\mathrm{int}} = k\\,u$。\n- 外部施加的力 $f_{\\mathrm{ext}}$。\n- 接触力 $\\lambda$，它作用于节点上，方向与 $\\mathbf{n}$ 一致，且必须为非负值，$\\lambda \\ge 0$。\n\n平衡方程的建立基于内力必须平衡总外力（施加的力加接触力）：\n$$ k\\,u = f_{\\mathrm{ext}} + \\lambda $$\n我们要求解其根的相应残差方程为：\n$$ R_u(u, \\lambda) = k\\,u - f_{\\mathrm{ext}} - \\lambda = 0 $$\n\n第二个方程强制执行接触约束，也称为单边接触的库恩-塔克条件：\n1.  **不可穿透性**：间隙 $g(u)$ 必须为非负。间隙是节点当前位置到刚性平面（位置为0）的距离。初始距离为 $y_0$，位移为 $u$，则间隙为 $g(u) = y_0 + u \\ge 0$。\n2.  **无拉力**：接触力必须是压缩的（或为零），因此 $\\lambda \\ge 0$。\n3.  **互补性**：只有当间隙闭合（$g(u)=0$）时，才能产生接触力。这表示为 $\\lambda\\,g(u) = 0$。\n\n这三个条件可以通过使用平滑的 Fischer-Burmeister 函数 $\\phi_\\mu(a,b) = \\sqrt{a^2 + b^2 + \\mu^2} - (a+b)$ 将它们重构为一个单一方程来紧凑地表示。该函数具有 $\\phi_\\mu(a,b) \\approx 0$ 等价于 $a$ 和 $b$ 的互补条件的性质。为确保量纲一致性，我们将此函数应用于对 $(g(u), s\\lambda)$，其中 $s$ 是单位为 m/N 的缩放参数。这导出了第二个残差方程：\n$$ R_\\lambda(u, \\lambda) = \\phi_\\mu(g(u), s\\lambda) = \\sqrt{(y_0+u)^2 + (s\\lambda)^2 + \\mu^2} - (y_0 + u + s\\lambda) = 0 $$\n\n求解状态向量 $\\mathbf{v} = [u, \\lambda]^T$ 的完整非线性方程组为：\n$$ \\mathbf{R}(\\mathbf{v}) = \\begin{Bmatrix} R_u(u, \\lambda) \\\\ R_\\lambda(u, \\lambda) \\end{Bmatrix} = \\begin{Bmatrix} k\\,u - f_{\\mathrm{ext}} - \\lambda \\\\ \\sqrt{(y_0+u)^2 + (s\\lambda)^2 + \\mu^2} - (y_0 + u + s\\lambda) \\end{Bmatrix} = \\mathbf{0} $$\n\n### 2. 一致切线（雅可比矩阵）的推导\n\n为了用半光滑牛顿法求解该系统，我们需要残差向量 $\\mathbf{R}$ 相对于状态向量 $\\mathbf{v}$ 的雅可比矩阵。该雅可比矩阵就是一致切线矩阵 $\\mathbf{K}_T$。\n$$ \\mathbf{K}_T(\\mathbf{v}) = \\frac{\\partial \\mathbf{R}}{\\partial \\mathbf{v}} = \\begin{bmatrix} \\frac{\\partial R_u}{\\partial u}  \\frac{\\partial R_u}{\\partial \\lambda} \\\\ \\frac{\\partial R_\\lambda}{\\partial u}  \\frac{\\partial R_\\lambda}{\\partial \\lambda} \\end{bmatrix} $$\n我们计算这个 $2 \\times 2$ 矩阵的每个分量：\n\n- **$R_u$ 的导数**：\n  $$ \\frac{\\partial R_u}{\\partial u} = \\frac{\\partial}{\\partial u}(k\\,u - f_{\\mathrm{ext}} - \\lambda) = k $$\n  $$ \\frac{\\partial R_u}{\\partial \\lambda} = \\frac{\\partial}{\\partial \\lambda}(k\\,u - f_{\\mathrm{ext}} - \\lambda) = -1 $$\n\n- **$R_\\lambda$ 的导数**：为清晰起见，令 $g = y_0+u$ 且 $C = \\sqrt{(y_0+u)^2 + (s\\lambda)^2 + \\mu^2}$。\n  关于 $u$ 的导数是：\n  $$ \\frac{\\partial R_\\lambda}{\\partial u} = \\frac{\\partial}{\\partial u} \\left( C - (g+s\\lambda) \\right) = \\frac{\\partial C}{\\partial g}\\frac{\\partial g}{\\partial u} - \\frac{\\partial g}{\\partial u} = \\left(\\frac{g}{C} - 1\\right) \\frac{\\partial g}{\\partial u} $$\n  由于 $\\frac{\\partial g}{\\partial u} = 1$，我们得到：\n  $$ \\frac{\\partial R_\\lambda}{\\partial u} = \\frac{g(u)}{C} - 1 = \\frac{y_0+u}{\\sqrt{(y_0+u)^2 + (s\\lambda)^2 + \\mu^2}} - 1 $$\n  关于 $\\lambda$ 的导数是：\n  $$ \\frac{\\partial R_\\lambda}{\\partial \\lambda} = \\frac{\\partial}{\\partial \\lambda} \\left( C - (g+s\\lambda) \\right) = \\frac{\\partial C}{\\partial \\lambda} - \\frac{\\partial(s\\lambda)}{\\partial \\lambda} = \\frac{s \\cdot (s\\lambda)}{C} - s $$\n  提出缩放参数 $s$：\n  $$ \\frac{\\partial R_\\lambda}{\\partial \\lambda} = s\\left(\\frac{s\\lambda}{C} - 1\\right) = s\\left(\\frac{s\\lambda}{\\sqrt{(y_0+u)^2 + (s\\lambda)^2 + \\mu^2}} - 1\\right) $$\n\n因此，完整的一致切线矩阵为：\n$$ \\mathbf{K}_T(u,\\lambda) = \\begin{bmatrix} k  -1 \\\\ \\frac{y_0+u}{C} - 1  s\\left(\\frac{s\\lambda}{C} - 1\\right) \\end{bmatrix} $$\n其中 $C = \\sqrt{(y_0+u)^2 + (s\\lambda)^2 + \\mu^2}$。\n\n### 3. 算法：半光滑牛顿法\n\n该数值算法通过迭代求解 $\\mathbf{R}(\\mathbf{v})=\\mathbf{0}$。从一个初始猜测 $\\mathbf{v}_0$（例如 $\\mathbf{v}_0=[0,0]^T$）开始，每次迭代 $i$ 包括：\n1.  计算残差 $\\mathbf{R}_i = \\mathbf{R}(\\mathbf{v}_i)$。\n2.  检查 $||\\mathbf{R}_i||$ 是否小于容差。如果是，则已找到解。\n3.  计算切线矩阵 $\\mathbf{K}_{T,i} = \\mathbf{K}_T(\\mathbf{v}_i)$。\n4.  求解线性系统 $\\mathbf{K}_{T,i} \\Delta \\mathbf{v}_i = -\\mathbf{R}_i$ 以获得更新量 $\\Delta \\mathbf{v}_i$。\n5.  更新解：$\\mathbf{v}_{i+1} = \\mathbf{v}_i + \\Delta \\mathbf{v}_i$。\n重复此过程直至收敛。所实现的代码使用这些推导来求解指定的测试用例。", "answer": "```python\n# The final answer must be a single, complete, standalone program.\n# This program implements the semismooth Newton method for a 1D contact problem.\n\nimport numpy as np\n\ndef solve_contact(k, y0, f_ext, s, mu, tol=1e-12, max_iter=20):\n    \"\"\"\n    Solves the 1D frictionless contact problem using a semismooth Newton method\n    with a Fischer-Burmeister complementarity reformulation.\n\n    Args:\n        k (float): Spring stiffness (N/m).\n        y0 (float): Initial gap (m).\n        f_ext (float): External force (N).\n        s (float): Scaling parameter (m/N).\n        mu (float): Smoothing parameter (m).\n        tol (float): Convergence tolerance for the residual norm.\n        max_iter (int): Maximum number of Newton iterations.\n\n    Returns:\n        tuple: A tuple (u, lam) containing the converged displacement (m)\n               and Lagrange multiplier (N).\n    \"\"\"\n    # Initial guess for displacement (u) and Lagrange multiplier (lam)\n    u, lam = 0.0, 0.0\n\n    for _ in range(max_iter):\n        # --- Evaluate state-dependent quantities ---\n        \n        # Gap function\n        g = y0 + u\n        \n        # Term inside the square root of the Fischer-Burmeister function\n        # This is guaranteed to be non-negative.\n        C_squared_arg = g**2 + (s * lam)**2 + mu**2\n        C = np.sqrt(C_squared_arg)\n\n        # --- Assemble the residual vector R = [R_u, R_lambda] ---\n        \n        # Residual of the equilibrium equation\n        R_u = k * u - f_ext - lam\n        \n        # Residual of the complementarity equation (Fischer-Burmeister)\n        R_lam = C - (g + s * lam) \n        \n        R = np.array([R_u, R_lam])\n\n        # --- Check for convergence ---\n        if np.linalg.norm(R)  tol:\n            break\n\n        # --- Assemble the consistent tangent (Jacobian) matrix K_T ---\n        \n        K_T_11 = k\n        K_T_12 = -1.0\n        K_T_21 = g / C - 1.0\n        K_T_22 = s * (s * lam / C - 1.0)\n        \n        K_T = np.array([[K_T_11, K_T_12], [K_T_21, K_T_22]])\n\n        # --- Solve the linear system K_T * dv = -R for the update dv ---\n        try:\n            dv = np.linalg.solve(K_T, -R)\n        except np.linalg.LinAlgError:\n            # Safeguard in case the Jacobian becomes singular,\n            # which is unlikely with mu > 0 for this well-posed problem.\n            break\n            \n        # --- Update the solution vector [u, lam] ---\n        u += dv[0]\n        lam += dv[1]\n\n    # Post-processing: ensure the contact force is non-negative, as a small\n    # negative value can result from the smoothing for inactive contact.\n    if lam  0:\n        lam = 0.0\n\n    return u, lam\n\ndef solve():\n    \"\"\"\n    Main function to define and run the test suite, then print results\n    in the specified format.\n    \"\"\"\n    # Define the test cases from the problem statement:\n    # (k [N/m], y0 [m], f_ext [N], s [m/N], mu [m])\n    test_cases = [\n        (1000.0, 0.01, -2.0, 1e-4, 1e-12),   # Case 1 (inactive contact)\n        (1000.0, 0.01, -50.0, 1e-4, 1e-12),  # Case 2 (active contact)\n        (1000.0, 0.01, -10.0, 1e-4, 1e-12),  # Case 3 (boundary case)\n        (1000.0, 0.0, 0.0, 1e-4, 1e-12)      # Case 4 (neutral corner)\n    ]\n\n    results_list = []\n    for case in test_cases:\n        k, y0, f_ext, s, mu = case\n        u, lam = solve_contact(k, y0, f_ext, s, mu)\n        results_list.append(u)\n        results_list.append(lam)\n\n    # Format the results to 6 decimal places and join into the required string format.\n    formatted_results = [f\"{x:.6f}\" for x in results_list]\n    print(f\"[{','.join(formatted_results)}]\")\n\n# Execute the solver\nsolve()\n```", "id": "3573041"}]}