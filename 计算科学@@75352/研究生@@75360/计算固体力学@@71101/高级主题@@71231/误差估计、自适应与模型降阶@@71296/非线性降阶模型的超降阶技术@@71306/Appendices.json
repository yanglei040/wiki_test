{"hands_on_practices": [{"introduction": "超简化的核心思想是利用少数几个入口点来重构高维向量。本练习将探讨两种基础方法：采用最小二乘拟合的有间隙本征正交分解（gappy POD），以及采用插值的离散经验插值法（DEIM）。通过亲手完成这个小而具体的计算示例 [@problem_id:3572677]，您将对这些方法的工作原理及其在近似策略上的差异有一个清晰、定量的理解。", "problem": "考虑一个非线性有限元内力向量 $f(u) \\in \\mathbb{R}^{8}$，它源于计算固体力学中一维超弹性杆的空间离散化。在降阶建模的背景下，使用从快照构建的非线性项基 $U \\in \\mathbb{R}^{8 \\times 3}$ 所张成的空间来近似非线性内力 $f(u)$。超简化技术旨在仅使用 $f(u)$ 的部分分量来恢复系数。\n\n从虚功原理和有限元残差出发，得到满足平衡方程 $f(u) - F_{\\mathrm{ext}} = 0$ 的离散内力 $f(u)$，其中 $F_{\\mathrm{ext}}$ 是外力向量。一个非线性降阶模型将内力表示为 $f(u) \\approx U c(u)$，其中 $c(u) \\in \\mathbb{R}^{3}$ 是某个系数向量。设行采样算子由一个选择矩阵 $P \\in \\mathbb{R}^{8 \\times 4}$ 给出，该矩阵由标准基向量构成，使得 $P^{\\top} f(u)$ 提取 $f(u)$ 的 $4$ 个分量。在间隙本征正交分解 (gappy Proper Orthogonal Decomposition, gappy POD) 中，系数是通过最小化采样误差 $\\|P^{\\top}(Uc - f)\\|_{2}$ 的最小二乘拟合求得的。在离散经验插值法 (Discrete Empirical Interpolation Method, DEIM) 中，系数则是通过在 $r_{f}$ 个选定分量上的插值来确定的，使得 $P_{\\mathrm{DEIM}}^{\\top} U c = P_{\\mathrm{DEIM}}^{\\top} f$。\n\n使用以下与上述框架一致的具体数据，计算 gappy POD 重构 $\\hat f$ 和 DEIM 重构 $\\tilde f$，然后计算它们的重构误差的欧几里得范数之比：\n- 维度 $N = 8$，降阶非线性基大小 $r_{f} = 3$，以及 $4$ 个采样分量。\n- 非线性项基 $U = [u_{1}\\ u_{2}\\ u_{3}] \\in \\mathbb{R}^{8 \\times 3}$，其列向量为\n  $u_{1} = [1, 1, 1, 1, 1, 1, 1, 1]^{\\top}$,\n  $u_{2} = [1, 2, 3, 4, 5, 6, 7, 8]^{\\top}$,\n  $u_{3} = [1, 0, 1, 0, 1, 0, 1, 0]^{\\top}$。\n- 采样选择 $\\mathcal{S} = \\{2, 4, 6, 7\\}$，因此 $P = [e_{2}\\ e_{4}\\ e_{6}\\ e_{7}] \\in \\mathbb{R}^{8 \\times 4}$，其中 $e_{i}$ 是 $\\mathbb{R}^{8}$ 中的第 $i$ 个标准基向量。\n- 内力向量 $f \\in \\mathbb{R}^{8}$ 由下式给出\n  $f = U c^{\\star} + w$，其中 $c^{\\star} = [1, -\\tfrac{1}{2}, 2]^{\\top}$ 且 $w = \\tfrac{1}{2}[0, 1, 0, -1, 0, 1, 0, -1]^{\\top}$。\n- 对于离散经验插值法 (DEIM)，使用插值索引 $\\{2, 6, 7\\}$，即 $P_{\\mathrm{DEIM}} = [e_{2}\\ e_{6}\\ e_{7}] \\in \\mathbb{R}^{8 \\times 3}$。\n\n从间隙本征正交分解 (gappy POD) 的最小二乘原理和离散经验插值法 (DEIM) 的插值条件推导出系数恢复公式。然后显式计算：\n- gappy POD 重构 $\\hat f = U \\hat c$，其中 $\\hat c$ 最小化 $\\|P^{\\top}(Uc - f)\\|_{2}$。\n- DEIM 重构 $\\tilde f = U \\tilde c$，其中 $\\tilde c$ 满足 $P_{\\mathrm{DEIM}}^{\\top} U \\tilde c = P_{\\mathrm{DEIM}}^{\\top} f$。\n\n最后，评估误差 $e_{g} = \\|f - \\hat f\\|_{2}$ 和 $e_{d} = \\|f - \\tilde f\\|_{2}$，并将比率 $e_{g}/e_{d}$ 以单个闭式解析表达式的形式报告。无需四舍五入。最终答案不带单位。", "solution": "该问题被验证为具有科学依据、良定且客观。它基于降阶建模和超简化的既定原理，特别是间隙本征正交分解 (gappy POD) 和离散经验插值法 (DEIM)。获得唯一解所需的所有数据和条件均已提供且自洽。\n\n该问题要求计算向量 $f \\in \\mathbb{R}^{8}$ 的两个近似值，分别记为 $\\hat{f}$ (来自 gappy POD) 和 $\\tilde{f}$ (来自 DEIM)，以及它们的重构误差之比。这两个近似都位于矩阵 $U \\in \\mathbb{R}^{8 \\times 3}$ 的列向量所张成的子空间中。\n\n首先，我们定义给定的量。\n非线性项基为 $U = [u_{1}\\ u_{2}\\ u_{3}]$，其中\n$$\nu_{1} = \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\\\ 1 \\\\ 1 \\\\ 1 \\\\ 1 \\\\ 1 \\end{pmatrix}, \\quad\nu_{2} = \\begin{pmatrix} 1 \\\\ 2 \\\\ 3 \\\\ 4 \\\\ 5 \\\\ 6 \\\\ 7 \\\\ 8 \\end{pmatrix}, \\quad\nu_{3} = \\begin{pmatrix} 1 \\\\ 0 \\\\ 1 \\\\ 0 \\\\ 1 \\\\ 0 \\\\ 1 \\\\ 0 \\end{pmatrix}\n\\implies\nU = \\begin{pmatrix}\n1  1  1 \\\\\n1  2  0 \\\\\n1  3  1 \\\\\n1  4  0 \\\\\n1  5  1 \\\\\n1  6  0 \\\\\n1  7  1 \\\\\n1  8  0\n\\end{pmatrix}\n$$\n目标内力向量为 $f = U c^{\\star} + w$，其中 $c^{\\star} = \\begin{pmatrix} 1 \\\\ -1/2 \\\\ 2 \\end{pmatrix}$ 且 $w = \\frac{1}{2} \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\\\ -1 \\\\ 0 \\\\ 1 \\\\ 0 \\\\ -1 \\end{pmatrix}$。我们来计算 $f$：\n$$\nU c^{\\star} = \\begin{pmatrix}\n1  1  1 \\\\\n1  2  0 \\\\\n1  3  1 \\\\\n1  4  0 \\\\\n1  5  1 \\\\\n1  6  0 \\\\\n1  7  1 \\\\\n1  8  0\n\\end{pmatrix}\n\\begin{pmatrix} 1 \\\\ -1/2 \\\\ 2 \\end{pmatrix}\n= \\begin{pmatrix}\n1 - 1/2 + 2 \\\\\n1 - 1 + 0 \\\\\n1 - 3/2 + 2 \\\\\n1 - 2 + 0 \\\\\n1 - 5/2 + 2 \\\\\n1 - 3 + 0 \\\\\n1 - 7/2 + 2 \\\\\n1 - 4 + 0\n\\end{pmatrix}\n= \\begin{pmatrix} 5/2 \\\\ 0 \\\\ 3/2 \\\\ -1 \\\\ 1/2 \\\\ -2 \\\\ -1/2 \\\\ -3 \\end{pmatrix}\n$$\n$$\nf = U c^{\\star} + w = \\begin{pmatrix} 5/2 \\\\ 0 \\\\ 3/2 \\\\ -1 \\\\ 1/2 \\\\ -2 \\\\ -1/2 \\\\ -3 \\end{pmatrix} + \\begin{pmatrix} 0 \\\\ 1/2 \\\\ 0 \\\\ -1/2 \\\\ 0 \\\\ 1/2 \\\\ 0 \\\\ -1/2 \\end{pmatrix} = \\begin{pmatrix} 5/2 \\\\ 1/2 \\\\ 3/2 \\\\ -3/2 \\\\ 1/2 \\\\ -3/2 \\\\ -1/2 \\\\ -7/2 \\end{pmatrix}\n$$\n\n**1. 间隙本征正交分解 (Gappy POD)**\n\ngappy POD 近似为 $\\hat f = U \\hat c$，其中系数向量 $\\hat c \\in \\mathbb{R}^{3}$ 是以下最小二乘问题的解：\n$$\n\\hat c = \\underset{c \\in \\mathbb{R}^{3}}{\\operatorname{argmin}} \\|P^{\\top}(Uc - f)\\|_{2}^{2}\n$$\n采样矩阵 $P = [e_{2}\\ e_{4}\\ e_{6}\\ e_{7}]$ 意味着算子 $P^{\\top}$ 选择第 $2, 4, 6, 7$ 行。我们定义采样矩阵 $U_{S} = P^{\\top}U$ 和采样向量 $f_{S} = P^{\\top}f$。\n$$\nU_{S} = \\begin{pmatrix}\n1  2  0 \\\\\n1  4  0 \\\\\n1  6  0 \\\\\n1  7  1\n\\end{pmatrix}, \\quad\nf_{S} = \\begin{pmatrix} 1/2 \\\\ -3/2 \\\\ -3/2 \\\\ -1/2 \\end{pmatrix}\n$$\n最小二乘解由正规方程组给出：\n$$\n(U_{S}^{\\top} U_{S}) \\hat c = U_{S}^{\\top} f_{S}\n$$\n我们计算各个部分：\n$$\nU_{S}^{\\top} U_{S} = \\begin{pmatrix}\n1  1  1  1 \\\\\n2  4  6  7 \\\\\n0  0  0  1\n\\end{pmatrix}\n\\begin{pmatrix}\n1  2  0 \\\\\n1  4  0 \\\\\n1  6  0 \\\\\n1  7  1\n\\end{pmatrix}\n= \\begin{pmatrix}\n4  19  1 \\\\\n19  105  7 \\\\\n1  7  1\n\\end{pmatrix}\n$$\n$$\nU_{S}^{\\top} f_{S} = \\begin{pmatrix}\n1  1  1  1 \\\\\n2  4  6  7 \\\\\n0  0  0  1\n\\end{pmatrix}\n\\begin{pmatrix} 1/2 \\\\ -3/2 \\\\ -3/2 \\\\ -1/2 \\end{pmatrix}\n= \\begin{pmatrix}\n1/2 - 3/2 - 3/2 - 1/2 \\\\\n1 - 6 - 9 - 7/2 \\\\\n-1/2\n\\end{pmatrix}\n= \\begin{pmatrix} -3 \\\\ -35/2 \\\\ -1/2 \\end{pmatrix}\n$$\n$U_{S}^{\\top} U_{S}$ 的行列式为 $4(105-49) - 19(19-7) + 1(133-105) = 224 - 228 + 28 = 24$。该矩阵是可逆的。其逆矩阵为：\n$$\n(U_{S}^{\\top} U_{S})^{-1} = \\frac{1}{24} \\begin{pmatrix}\n56  -12  28 \\\\\n-12  3  -9 \\\\\n28  -9  59\n\\end{pmatrix}\n$$\n现在我们求解 $\\hat c = (U_{S}^{\\top} U_{S})^{-1} (U_{S}^{\\top} f_{S})$：\n$$\n\\hat c = \\frac{1}{24} \\begin{pmatrix}\n56  -12  28 \\\\\n-12  3  -9 \\\\\n28  -9  59\n\\end{pmatrix}\n\\begin{pmatrix} -3 \\\\ -35/2 \\\\ -1/2 \\end{pmatrix}\n= \\frac{1}{24} \\begin{pmatrix}\n56(-3) - 12(-35/2) + 28(-1/2) \\\\\n-12(-3) + 3(-35/2) - 9(-1/2) \\\\\n28(-3) - 9(-35/2) + 59(-1/2)\n\\end{pmatrix}\n= \\frac{1}{24} \\begin{pmatrix}\n-168 + 210 - 14 \\\\\n36 - 105/2 + 9/2 \\\\\n-84 + 315/2 - 59/2\n\\end{pmatrix}\n$$\n$$\n\\hat c = \\frac{1}{24} \\begin{pmatrix}\n28 \\\\\n36 - 48 \\\\\n-84 + 128\n\\end{pmatrix}\n= \\frac{1}{24} \\begin{pmatrix}\n28 \\\\\n-12 \\\\\n44\n\\end{pmatrix}\n= \\begin{pmatrix} 7/6 \\\\ -1/2 \\\\ 11/6 \\end{pmatrix}\n$$\n\n**2. 离散经验插值法 (DEIM)**\n\nDEIM 近似为 $\\tilde f = U \\tilde c$，其中系数向量 $\\tilde c \\in \\mathbb{R}^{3}$ 是以下线性系统的解：\n$$\nP_{\\mathrm{DEIM}}^{\\top} U \\tilde c = P_{\\mathrm{DEIM}}^{\\top} f\n$$\nDEIM 选择矩阵是 $P_{\\mathrm{DEIM}} = [e_{2}\\ e_{6}\\ e_{7}]$，因此 $P_{\\mathrm{DEIM}}^{\\top}$ 选择第 $2, 6, 7$ 行。我们定义插值矩阵 $U_{I} = P_{\\mathrm{DEIM}}^{\\top}U$ 和插值向量 $f_{I} = P_{\\mathrm{DEIM}}^{\\top}f$。\n$$\nU_{I} = \\begin{pmatrix}\n1  2  0 \\\\\n1  6  0 \\\\\n1  7  1\n\\end{pmatrix}, \\quad\nf_{I} = \\begin{pmatrix} 1/2 \\\\ -3/2 \\\\ -1/2 \\end{pmatrix}\n$$\n我们求解系统 $U_{I} \\tilde c = f_{I}$ 以得到 $\\tilde c$。$U_{I}$ 的行列式是 $1(6-0) - 2(1-0) + 0 = 4$。该矩阵是可逆的。\n$$\nU_{I}^{-1} = \\frac{1}{4} \\operatorname{adj}(U_{I}) = \\frac{1}{4} \\begin{pmatrix}\n6  -2  0 \\\\\n-1  1  0 \\\\\n1  -5  4\n\\end{pmatrix}\n$$\n现在我们求解 $\\tilde c = U_{I}^{-1} f_{I}$：\n$$\n\\tilde c = \\frac{1}{4} \\begin{pmatrix}\n6  -2  0 \\\\\n-1  1  0 \\\\\n1  -5  4\n\\end{pmatrix}\n\\begin{pmatrix} 1/2 \\\\ -3/2 \\\\ -1/2 \\end{pmatrix}\n= \\frac{1}{4} \\begin{pmatrix}\n6(1/2) - 2(-3/2) \\\\\n-1(1/2) + 1(-3/2) \\\\\n1(1/2) - 5(-3/2) + 4(-1/2)\n\\end{pmatrix}\n= \\frac{1}{4} \\begin{pmatrix}\n3 + 3 \\\\\n-1/2 - 3/2 \\\\\n1/2 + 15/2 - 2\n\\end{pmatrix}\n$$\n$$\n\\tilde c = \\frac{1}{4} \\begin{pmatrix}\n6 \\\\\n-2 \\\\\n6\n\\end{pmatrix}\n= \\begin{pmatrix} 3/2 \\\\ -1/2 \\\\ 3/2 \\end{pmatrix}\n$$\n\n**3. 重构误差**\n\n重构误差是原始向量 $f$ 与其近似值之间的差。\n误差可以表示为 $f - U c = (U c^{\\star} + w) - U c = U(c^{\\star} - c) + w$。\n\n对于 gappy POD，误差为 $e_{g, \\text{vec}} = f - \\hat{f} = U(c^{\\star} - \\hat c) + w$。\n$$\nc^{\\star} - \\hat c = \\begin{pmatrix} 1 \\\\ -1/2 \\\\ 2 \\end{pmatrix} - \\begin{pmatrix} 7/6 \\\\ -1/2 \\\\ 11/6 \\end{pmatrix} = \\begin{pmatrix} -1/6 \\\\ 0 \\\\ 1/6 \\end{pmatrix}\n$$\n$$\nU(c^{\\star} - \\hat c) = \\frac{1}{6} U \\begin{pmatrix} -1 \\\\ 0 \\\\ 1 \\end{pmatrix} = \\frac{1}{6} \\begin{pmatrix} -1+0+1 \\\\ -1+0+0 \\\\ -1+0+1 \\\\ -1+0+0 \\\\ -1+0+1 \\\\ -1+0+0 \\\\ -1+0+1 \\\\ -1+0+0 \\end{pmatrix} = \\frac{1}{6} \\begin{pmatrix} 0  -1  0  -1  0  -1  0  -1 \\end{pmatrix}^{\\top}\n$$\n$$\ne_{g, \\text{vec}} = \\frac{1}{6} \\begin{pmatrix} 0 \\\\ -1 \\\\ 0 \\\\ -1 \\\\ 0 \\\\ -1 \\\\ 0 \\\\ -1 \\end{pmatrix} + \\frac{1}{2} \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\\\ -1 \\\\ 0 \\\\ 1 \\\\ 0 \\\\ -1 \\end{pmatrix} = \\frac{1}{6} \\begin{pmatrix} 0 \\\\ -1 \\\\ 0 \\\\ -1 \\\\ 0 \\\\ -1 \\\\ 0 \\\\ -1 \\end{pmatrix} + \\frac{1}{6} \\begin{pmatrix} 0 \\\\ 3 \\\\ 0 \\\\ -3 \\\\ 0 \\\\ 3 \\\\ 0 \\\\ -3 \\end{pmatrix} = \\frac{1}{6} \\begin{pmatrix} 0 \\\\ 2 \\\\ 0 \\\\ -4 \\\\ 0 \\\\ 2 \\\\ 0 \\\\ -4 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 1/3 \\\\ 0 \\\\ -2/3 \\\\ 0 \\\\ 1/3 \\\\ 0 \\\\ -2/3 \\end{pmatrix}\n$$\ngappy POD 误差的欧几里得范数的平方是：\n$$\ne_{g}^{2} = \\|f - \\hat f\\|_{2}^{2} = 0^{2} + (\\frac{1}{3})^{2} + 0^{2} + (-\\frac{2}{3})^{2} + 0^{2} + (\\frac{1}{3})^{2} + 0^{2} + (-\\frac{2}{3})^{2} = \\frac{1}{9} + \\frac{4}{9} + \\frac{1}{9} + \\frac{4}{9} = \\frac{10}{9}\n$$\n所以，$e_{g} = \\sqrt{\\frac{10}{9}} = \\frac{\\sqrt{10}}{3}$。\n\n对于 DEIM，误差为 $e_{d, \\text{vec}} = f - \\tilde{f} = U(c^{\\star} - \\tilde c) + w$。\n$$\nc^{\\star} - \\tilde c = \\begin{pmatrix} 1 \\\\ -1/2 \\\\ 2 \\end{pmatrix} - \\begin{pmatrix} 3/2 \\\\ -1/2 \\\\ 3/2 \\end{pmatrix} = \\begin{pmatrix} -1/2 \\\\ 0 \\\\ 1/2 \\end{pmatrix}\n$$\n$$\nU(c^{\\star} - \\tilde c) = \\frac{1}{2} U \\begin{pmatrix} -1 \\\\ 0 \\\\ 1 \\end{pmatrix} = \\frac{1}{2} \\begin{pmatrix} 0 \\\\ -1 \\\\ 0 \\\\ -1 \\\\ 0 \\\\ -1 \\\\ 0 \\\\ -1 \\end{pmatrix}\n$$\n$$\ne_{d, \\text{vec}} = \\frac{1}{2} \\begin{pmatrix} 0 \\\\ -1 \\\\ 0 \\\\ -1 \\\\ 0 \\\\ -1 \\\\ 0 \\\\ -1 \\end{pmatrix} + \\frac{1}{2} \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\\\ -1 \\\\ 0 \\\\ 1 \\\\ 0 \\\\ -1 \\end{pmatrix} = \\frac{1}{2} \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\\\ -2 \\\\ 0 \\\\ 0 \\\\ 0 \\\\ -2 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\\\ -1 \\\\ 0 \\\\ 0 \\\\ 0 \\\\ -1 \\end{pmatrix}\n$$\nDEIM 误差的欧几里得范数的平方是：\n$$\ne_{d}^{2} = \\|f - \\tilde f\\|_{2}^{2} = 0^{2} + 0^{2} + 0^{2} + (-1)^{2} + 0^{2} + 0^{2} + 0^{2} + (-1)^{2} = 1 + 1 = 2\n$$\n所以，$e_{d} = \\sqrt{2}$。\n\n**4. 误差之比**\n\n最后，误差范数之比为：\n$$\n\\frac{e_{g}}{e_{d}} = \\frac{\\frac{\\sqrt{10}}{3}}{\\sqrt{2}} = \\frac{\\sqrt{10}}{3\\sqrt{2}} = \\frac{\\sqrt{5 \\cdot 2}}{3\\sqrt{2}} = \\frac{\\sqrt{5}\\sqrt{2}}{3\\sqrt{2}} = \\frac{\\sqrt{5}}{3}\n$$", "answer": "$$\n\\boxed{\\frac{\\sqrt{5}}{3}}\n$$", "id": "3572677"}, {"introduction": "超简化的效果关键取决于能否选出正确的采样点，糟糕的选择可能导致巨大的误差或不稳定。本实践将指导您设计一种基于本征正交分解（POD）的、有原则的数据驱动策略，用以选择重要的有限元。通过实现这种选择算法 [@problem_id:3572739]，您将学会如何利用系统快照的光谱信息来创建紧凑而有效的采样集，这是构建稳健降阶模型的一项关键技能。", "problem": "您被要求在计算固体力学领域，为非线性降阶模型设计并实现一种由适当正交分解（POD）驱动的单元超简化选择策略。其目标是通过分析一个单元贡献矩阵的奇异值和奇异向量，从网格中识别出一个单元采样集。其背景为非线性固体中的线性动量平衡，该问题通过有限元方法进行离散化，其中全局内力残差可以由各单元贡献的总和组装而成。您的任务是推导出一个基于原理的选择规则，并用代码实现它，以便为代表单元贡献的一组给定测试矩阵计算采样集。\n\n从以下基础开始：\n- 线性动量平衡的强形式：$\\rho \\, \\ddot{\\boldsymbol{u}} = \\nabla \\cdot \\boldsymbol{\\sigma} + \\boldsymbol{b}$，其中 $\\rho$ 是密度，$\\boldsymbol{u}$ 是位移，$\\boldsymbol{\\sigma}$ 是 Cauchy 应力，$\\boldsymbol{b}$ 是体力。\n- 有限元半离散形式产生一个残差向量 $\\boldsymbol{r}(\\boldsymbol{u})$，该向量由单元级内力贡献组装而成：$\\boldsymbol{r}(\\boldsymbol{u}) = \\sum_{e=1}^{n_e} \\boldsymbol{r}_e(\\boldsymbol{u}) - \\boldsymbol{f}_{\\text{ext}}$。\n- 在降阶建模中，使用适当正交分解（POD），高维位移 $\\boldsymbol{u}$ 在一个由快照中提取的模态所张成的降阶子空间中被近似；残差中的非线性项需要通过对一部分单元进行采样来进行超简化，以使在线评估变得高效。\n\n定义一个单元贡献矩阵 $C \\in \\mathbb{R}^{m \\times n_e}$，其第 $j$ 列收集了单元 $j$ 在 $m$ 个代表性残差分量或快照实例（例如，跨越选定降阶坐标和时间的降阶残差分量）上的贡献。为提出一个由POD驱动的选择策略：\n- 对矩阵 $C$ 进行奇异值分解，得到 $C = U \\Sigma V^\\top$。\n- 确定一个截断秩 $k$，该秩保留了总谱能量的预定比例（基于 $\\Sigma$ 中的奇异值），其中 $k$ 是使得最大的 $k$ 个奇异值的累积能量达到或超过给定阈值 $\\eta \\in (0,1]$ 的最小整数。\n- 使用此截断表示，为每个单元（即 $C$ 的每一列）推导出一个单元重要性得分，该得分反映了该列集中了多少截斷谱内容。此得分必须源自谱分解的第一性原理，并且在标准正交基变换下保持不变。\n- 通过选择具有最高重要性得分的 $s$ 个单元来构建大小为 $s$ 的采样集；若得分相同，则优先选择单元索引较小的。单元索引必须从 0 开始。\n\n您的程序必须实现上述策略，并为以下测试套件计算采样集。每个测试用例为一个具有 $n_e = 4$ 个单元的网格指定一个矩阵 $C$、一个能量保留阈值 $\\eta$ 和一个目标采样大小 $s$。每个测试用例的输出是选定单元索引的列表。答案中不需要物理单位（索引是无单位的）。\n\n测试套件（每个 $C$ 都以一个包含 $m$ 行和 4 列的实值矩阵形式给出）：\n1. 情况 A（正常路径）：\n   - $C_A$ 有 $m = 6$ 行，\n     $$\n     C_A = \\begin{bmatrix}\n     3.2  0.5  2.9  0.1 \\\\\n     0.0  0.2  -0.1  0.05 \\\\\n     0.1  0.1  0.0  0.02 \\\\\n     0.2  0.0  0.3  0.00 \\\\\n     0.1  0.0  0.2  0.00 \\\\\n     -0.1  0.1  -0.1  0.01\n     \\end{bmatrix}.\n     $$\n   - $\\eta_A = 0.9$, $s_A = 2$。\n2. 情况 B（具有秩1结构的边界条件）：\n   - $C_B$ 有 $m = 4$ 行，\n     $$\n     C_B = \\begin{bmatrix}\n     1.0  1.0  1.0  1.0 \\\\\n     0.5  0.5  0.5  0.5 \\\\\n     -0.5  -0.5  -0.5  -0.5 \\\\\n     0.1  0.1  0.1  0.1\n     \\end{bmatrix}.\n     $$\n   - $\\eta_B = 0.95$, $s_B = 2$。\n3. 情况 C（包含零列的边界情况）：\n   - $C_C$ 有 $m = 4$ 行，\n     $$\n     C_C = \\begin{bmatrix}\n     2.0  0.0  0.2  0.0 \\\\\n     1.0  0.0  -0.1  0.0 \\\\\n     0.0  0.0  0.0  0.0 \\\\\n     -0.5  0.0  0.3  0.0\n     \\end{bmatrix}.\n     $$\n   - $\\eta_C = 0.9$, $s_C = 3$。\n\n您的程序必须处理这三个案例，并在一行中生成结果，结果为用方括号括起来的逗号分隔列表。每个结果必须是相应案例的采样集，表示为一个包含 $s$ 个整数的列表，这些整数代表从 0 开始的单元索引。例如，输出格式必须严格遵循 $[ [i\\_A, \\ldots], [i\\_B, \\ldots], [i\\_C, \\ldots] ]$ 的形式，逗号后没有空格。最终输出必须是程序打印的仅包含此格式化列表的单行。", "solution": "该问题是有效的。它在计算固体力学这一具有科学依据的领域内提出了一个定义明確的任务，特别涉及到降阶模型的超简化技术。给定的条件是完整、一致且客观的。问题的核心是利用线性代数工具，推导一种基于原理的方法，以根据有限单元对系统非线性动力学的贡献来选择重要的有限单元。\n\n所提出的解决策略结构如下：首先，我们将为每个有限单元推导出一个稳健且具有物理意义的重要性得分，该得分植根于适当正交分解（POD）的原理。其次，我们将概述基于此得分选择单元子集的完整算法流程。根据要求，单元索引是从0开始的，因此对于一个有 $n_e$ 个单元的网格，索引为 $j \\in \\{0, 1, \\dots, n_e-1\\}$。\n\n**单元重要性得分的推导**\n\n起点是单元贡献矩阵 $C \\in \\mathbb{R}^{m \\times n_e}$，其中每一列 $\\boldsymbol{c}_j$（对于 $j \\in \\{0, \\dots, n_e-1\\}$）包含一个代表单元 $j$ 贡献的特征向量。我们对该矩阵进行奇异值分解（SVD）：\n$$\nC = U \\Sigma V^\\top\n$$\n此处，$U \\in \\mathbb{R}^{m \\times m}$ 的列是左奇异向量（或 POD 模态），$\\Sigma \\in \\mathbb{R}^{m \\times n_e}$ 的对角线元素 $\\sigma_i$ 是奇异值，$V \\in \\mathbb{R}^{n_e \\times n_e}$ 的列是右奇异向量。POD 模态为 $C$ 中的数据构成了一个最优标准正交基。\n\n系统的总能量（或方差）由 $C$ 的 Frobenius 范数的平方捕获，它等于奇异值平方的总和：\n$$\n\\|C\\|_F^2 = \\sum_{i=0}^{r-1} \\sigma_i^2\n$$\n其中 $r = \\text{rank}(C)$。问题要求保留此能量的一部分，比例为 $\\eta \\in (0,1]$。我们通过将 SVD 截断到秩 $k$ 来实现这一点，其中 $k$ 是满足以下条件的最小整数：\n$$\n\\frac{\\sum_{i=0}^{k-1} \\sigma_i^2}{\\sum_{i=0}^{r-1} \\sigma_i^2} \\ge \\eta\n$$\n$U$ 的前 $k$ 列，记为 $U_k \\in \\mathbb{R}^{m \\times k}$，构成一个截断 POD 基，它张成了系统行为中能量最集中的子空间。\n\n为推导单元重要性得分，我们必须量化每个单元的贡献向量 $\\boldsymbol{c}_j$ 在这个关键的秩-k子空间中被表示的程度。一个自然且基于原理的度量是 $\\boldsymbol{c}_j$ 在由 $U_k$ 的列张成的子空间上的正交投影的能量（$L_2$-范数的平方）。到该子空间上的投影算子是 $P_k = U_k U_k^\\top$。\n\n因此，单元 $j$ 的重要性得分 $p_j$ 定义为其投影贡献向量的范数平方：\n$$\np_j = \\| P_k \\boldsymbol{c}_j \\|_2^2 = \\| U_k U_k^\\top \\boldsymbol{c}_j \\|_2^2\n$$\n由于 $U_k$ 的列是标准正交的（$U_k^\\top U_k = I_k$，即 $k \\times k$ 的单位矩阵），此表达式可简化为：\n$$\np_j = (U_k^\\top \\boldsymbol{c}_j)^\\top (U_k^\\top U_k) (U_k^\\top \\boldsymbol{c}_j) = (U_k^\\top \\boldsymbol{c}_j)^\\top (U_k^\\top \\boldsymbol{c}_j) = \\| U_k^\\top \\boldsymbol{c}_j \\|_2^2\n$$\n这告诉我们，得分是在 POD 基中 $\\boldsymbol{c}_j$ 坐标的范数平方。为获得一个易于计算的公式，我们使用 SVD 关系 $C = U \\Sigma V^\\top \\implies U^\\top C = \\Sigma V^\\top$。取此方程的前 $k$ 行得到 $U_k^\\top C = \\Sigma_k V_k^\\top$，其中 $\\Sigma_k \\in \\mathbb{R}^{k \\times k}$ 是前 $k$ 个奇异值的对角矩阵，$V_k \\in \\mathbb{R}^{n_e \\times k}$ 包含前 $k$ 个右奇异向量。\n\n$U_k^\\top C$ 的第 $j$ 列是坐标向量 $U_k^\\top \\boldsymbol{c}_j$。$\\Sigma_k V_k^\\top$ 的第 $j$ 列是一个向量，其第 $i$ 个分量（对于 $i \\in \\{0, \\dots, k-1\\}$）是 $\\sigma_i (V_k^\\top)_{ij} = \\sigma_i v_{ji}$，其中 $v_{ji}$ 是第 $i$ 个右奇异向量的第 $j$ 个分量。因此，$U_k^\\top \\boldsymbol{c}_j = [\\sigma_0 v_{j0}, \\sigma_1 v_{j1}, \\dots, \\sigma_{k-1} v_{j,k-1}]^\\top$。\n\n重要性得分 $p_j$ 的最终表达式是这些坐标的平方和：\n$$\np_j = \\sum_{i=0}^{k-1} (\\sigma_i v_{ji})^2\n$$\n这个得分是基于原理的，因为它代表了被截断 POD 基捕获的单元 $j$ 的贡献能量。将所有单元的这些得分相加，可以恢复秩-k近似的总能量：$\\sum_{j=0}^{n_e-1} p_j = \\sum_{j=0}^{n_e-1} \\sum_{i=0}^{k-1} \\sigma_i^2 v_{ji}^2 = \\sum_{i=0}^{k-1} \\sigma_i^2 \\left(\\sum_{j=0}^{n_e-1} v_{ji}^2\\right) = \\sum_{i=0}^{k-1} \\sigma_i^2 = \\| C_k \\|_F^2$，因为右奇异向量也是标准正交的。\n\n**选择算法**\n\n对于给定的矩阵 $C$、能量阈值 $\\eta$ 和采样大小 $s$，确定采样集的完整流程如下：\n1.  **SVD**：计算 $C$ 的 SVD 以获得奇异值 $\\sigma_i$ 和 $V$ 中的右奇异向量（或等效地，$V^\\top$）。\n2.  **秩截断**：计算奇异值的平方 $\\sigma_i^2$。确定总能量 $E_{tot} = \\sum_i \\sigma_i^2$。找到最小的整数 $k \\ge 1$，使得 $\\sum_{i=0}^{k-1} \\sigma_i^2 \\ge \\eta E_{tot}$。\n3.  **重要性得分**：对于每个单元 $j \\in \\{0, \\dots, n_e-1\\}$，计算重要性得分 $p_j = \\sum_{i=0}^{k-1} (\\sigma_i v_{ji})^2$。\n4.  **选择**：识别与 $s$ 个最高重要性得分相对应的 $s$ 个单元。如果得分出现平局，则优先选择索引较小的单元。最终输出是这 $s$ 个索引的列表。\n\n该算法为超简化单元选择提供了一种确定性且有科学依据的方法。", "answer": "[[0,2],[0,1],[0,2,1]]", "id": "3572739"}, {"introduction": "当超简化技术能够加速大型非线性系统（例如隐式时间积分格式中常见的系统）的迭代求解时，其真正的威力才能得以体现。本练习将演示如何应用加权采样技术（类似于经验体积元法ECSW）来近似牛顿-拉弗森步中大型雅可比矩阵的作用。通过编写一个超简化牛顿更新程序 [@problem_id:3572702]，您将亲眼见证这些技术如何显著降低每次迭代的计算成本，并探索非线性强度和采样质量等因素如何影响求解器的收敛性。", "problem": "考虑一个计算固体力学中的离散非线性平衡系统，该系统由残差向量 $r(u) \\in \\mathbb{R}^n$ 及其雅可比矩阵 $J(u) \\in \\mathbb{R}^{n \\times n}$ 定义，其中 $u \\in \\mathbb{R}^n$ 是节点未知向量。残差由下式给出：\n$$\nr(u) = K u + \\alpha\\, u^{\\circ 3} - f,\n$$\n其中 $K \\in \\mathbb{R}^{n \\times n}$ 是一个对称正定类刚度矩阵，$f \\in \\mathbb{R}^n$ 是一个载荷向量，$\\alpha \\in \\mathbb{R}$ 是一个标量非线性参数，$u^{\\circ 3}$ 表示 $u$ 的逐元素立方。残差的雅可比矩阵为：\n$$\nJ(u) = K + \\operatorname{diag}\\!\\left(3\\alpha\\, u^{\\circ 2}\\right),\n$$\n其中 $u^{\\circ 2}$ 是 $u$ 的逐元素平方。\n\n使用一个二维降阶基 $\\Phi \\in \\mathbb{R}^{n \\times r}$（$r = 2$）构建一个降阶模型，使得状态可以近似为 $u \\approx \\Phi a$，其中 $a \\in \\mathbb{R}^r$ 是降阶坐标。为了在降阶坐标中执行一个牛顿步，使用了超降阶雅可比作用。具体来说，定义一个行索引采样集 $S \\subset \\{0,1,\\dots,n-1\\}$ 和正权重 $w \\in \\mathbb{R}^{|S|}$；令 $W = \\operatorname{diag}(w) \\in \\mathbb{R}^{|S| \\times |S|}$。用 $X_S$ 表示通过选择矩阵 $X$ 中由 $S$ 索引的行所得到的矩阵，用 $v_S$ 表示通过选择向量 $v$ 中由 $S$ 索引的元素所得到的向量。超降阶雅可比作用构建了降阶线性系统：\n$$\nA_{\\mathrm{HR}}(u) \\,\\Delta a = b_{\\mathrm{HR}}(u),\n$$\n其中\n$$\nA_{\\mathrm{HR}}(u) = \\Phi_S^\\top W \\left(J(u)\\Phi\\right)_S \\in \\mathbb{R}^{r \\times r}, \\quad \nb_{\\mathrm{HR}}(u) = -\\Phi_S^\\top W \\, r(u)_S \\in \\mathbb{R}^{r}.\n$$\n牛顿更新为 $a^{+} = a + \\Delta a$，更新后的完整状态为 $u^{+} = \\Phi a^{+}$。残差的减小由欧几里得范数比率 $\\|r(u^{+})\\|_2 / \\|r(u)\\|_2$ 和一个指示范数是否严格减小的布尔值来衡量。\n\n使用以下数据，所有测试案例中固定 $n = 5$ 和 $r = 2$。刚度矩阵 $K$ 是三对角矩阵：\n$$\nK = \\begin{bmatrix}\n2  -1  0  0  0 \\\\\n-1  2  -1  0  0 \\\\\n0  -1  2  -1  0 \\\\\n0  0  -1  2  -1 \\\\\n0  0  0  -1  2\n\\end{bmatrix}.\n$$\n降阶基 $\\Phi$ 的列向量为：\n$$\n\\phi_1 = \\frac{1}{\\sqrt{5}}\\begin{bmatrix}1 \\\\ 1 \\\\ 1 \\\\ 1 \\\\ 1\\end{bmatrix}, \\quad\n\\phi_2 = \\frac{1}{\\sqrt{3}}\\begin{bmatrix}1 \\\\ 0 \\\\ -1 \\\\ 0 \\\\ 1\\end{bmatrix}, \\quad\n\\Phi = \\begin{bmatrix}\\phi_1  \\phi_2\\end{bmatrix}.\n$$\n\n共有三个测试案例，每个案例指定了 $(\\alpha, f, a, S, w)$，$S$ 中的索引采用从0开始的约定：\n\n- 测试案例1（中等非线性，良好选择的采样）：\n  $$\n  \\alpha = 0.5,\\quad \n  f = \\begin{bmatrix}1 \\\\ 0 \\\\ 0.5 \\\\ 0 \\\\ -1\\end{bmatrix},\\quad\n  a = \\begin{bmatrix}0.1 \\\\ -0.2\\end{bmatrix},\\quad\n  S = \\{0, 2, 4\\},\\quad\n  w = \\begin{bmatrix}1.6 \\\\ 1.2 \\\\ 1.2\\end{bmatrix}.\n  $$\n\n- 测试案例2（线性情况，完全采样）：\n  $\n  \\alpha = 0.0,\\quad \n  f = \\begin{bmatrix}0 \\\\ 0 \\\\ 0 \\\\ 0 \\\\ 0.5\\end{bmatrix},\\quad\n  a = \\begin{bmatrix}0.0 \\\\ 0.0\\end{bmatrix},\\quad\n  S = \\{0, 1, 2, 3, 4\\},\\quad\n  w = \\begin{bmatrix}1 \\\\ 1 \\\\ 1 \\\\ 1 \\\\ 1\\end{bmatrix}.\n  $\n\n- 测试案例3（强非线性，不良采样）：\n  $\n  \\alpha = 1.5,\\quad \n  f = \\begin{bmatrix}-0.5 \\\\ 0.2 \\\\ 0 \\\\ 0.1 \\\\ -0.1\\end{bmatrix},\\quad\n  a = \\begin{bmatrix}-0.3 \\\\ 0.15\\end{bmatrix},\\quad\n  S = \\{3, 4\\},\\quad\n  w = \\begin{bmatrix}2.5 \\\\ 2.5\\end{bmatrix}.\n  $\n\n程序要求：\n- 对每个测试案例，计算 $u = \\Phi a$，构建 $r(u)$ 和 $J(u)$，组装 $A_{\\mathrm{HR}}(u)$ 和 $b_{\\mathrm{HR}}(u)$，求解 $\\Delta a$，更新 $a^{+}$ 和 $u^{+}$，并评估 $\\|r(u)\\|_2$、$\\|r(u^{+})\\|_2$、比率 $\\|r(u^{+})\\|_2 / \\|r(u)\\|_2$ 以及一个指示 $\\|r(u^{+})\\|_2  \\|r(u)\\|_2$ 是否成立的布尔值。\n- 如果 $\\|r(u)\\|_2 = 0$，将比率定义为一个非数值（Not-a-Number）指示符；否则按规定计算比率。在所有情况下，根据严格不等式报告布尔值。\n- 你的程序应生成一行输出，其中包含一个用方括号括起来的逗号分隔列表的结果，每个测试案例的结果是一个形如 $[$norm\\_before, norm\\_after, ratio, improved$]$ 的内部列表。不使用角度，也无物理单位适用；所有输出均为无量纲实数。对范数和比率使用浮点数，对改进指示符使用布尔值。例如，输出格式必须类似于 $[[x_1,y_1,z_1,\\mathrm{True}],[x_2,y_2,z_2,\\mathrm{False}],\\dots]$。", "solution": "根据规定标准对问题进行验证。\n\n### 步骤1：提取已知条件\n问题陈述提供了以下定义和数据：\n- **系统方程**:\n  - 残差向量: $r(u) = K u + \\alpha\\, u^{\\circ 3} - f$，其中 $u \\in \\mathbb{R}^n$，$K \\in \\mathbb{R}^{n \\times n}$，$\\alpha \\in \\mathbb{R}$，$f \\in \\mathbb{R}^n$，$u^{\\circ 3}$ 是逐元素立方幂。\n  - 雅可比矩阵: $J(u) = K + \\operatorname{diag}\\!\\left(3\\alpha\\, u^{\\circ 2}\\right)$，其中 $u^{\\circ 2}$ 是逐元素平方。\n- **降阶模型**:\n  - 状态近似: $u \\approx \\Phi a$，其中 $\\Phi \\in \\mathbb{R}^{n \\times r}$ 是降阶基，$a \\in \\mathbb{R}^r$ 是降阶坐标。\n- **用于牛顿步的超降阶**:\n  - 更新量 $\\Delta a$ 的线性系统为 $A_{\\mathrm{HR}}(u) \\,\\Delta a = b_{\\mathrm{HR}}(u)$。\n  - 超降阶矩阵: $A_{\\mathrm{HR}}(u) = \\Phi_S^\\top W \\left(J(u)\\Phi\\right)_S$。\n  - 超降阶右端项: $b_{\\mathrm{HR}}(u) = -\\Phi_S^\\top W \\, r(u)_S$。\n  - 此处，$S$ 是一组样本行索引，$W = \\operatorname{diag}(w)$ 是权重 $w$ 的对角矩阵，$X_S$ 表示对矩阵/向量 $X$ 进行行采样。\n- **更新与评估**:\n  - 更新规则: $a^{+} = a + \\Delta a$，然后是 $u^{+} = \\Phi a^{+}$。\n  - 性能度量: 欧几里得范数之比 $\\|r(u^{+})\\|_2 / \\|r(u)\\|_2$ 和一个表示是否严格减小（$\\|r(u^{+})\\|_2  \\|r(u)\\|_2$）的布尔标志。如果 $\\|r(u)\\|_2 = 0$，则比率定义为非数值（NaN）。\n- **固定参数**:\n  - 系统维度: $n=5$。\n  - 降阶维度: $r=2$。\n  - 刚度矩阵: $K = \\operatorname{tridiag}(-1, 2, -1) \\in \\mathbb{R}^{5 \\times 5}$。\n  - 降阶基: $\\Phi = [\\phi_1, \\phi_2]$，其中 $\\phi_1 = \\frac{1}{\\sqrt{5}}[1, 1, 1, 1, 1]^\\top$ 和 $\\phi_2 = \\frac{1}{\\sqrt{3}}[1, 0, -1, 0, 1]^\\top$。\n- **测试案例**: 提供了三个案例，每个案例都有一组特定的 $(\\alpha, f, a, S, w)$。\n  - **案例1**: $\\alpha = 0.5$，$f = [1, 0, 0.5, 0, -1]^\\top$，$a = [0.1, -0.2]^\\top$，$S = \\{0, 2, 4\\}$，$w = [1.6, 1.2, 1.2]^\\top$。\n  - **案例2**: $\\alpha = 0.0$，$f = [0, 0, 0, 0, 0.5]^\\top$，$a = [0.0, 0.0]^\\top$，$S = \\{0, 1, 2, 3, 4\\}$，$w = [1, 1, 1, 1, 1]^\\top$。\n  - **案例3**: $\\alpha = 1.5$，$f = [-0.5, 0.2, 0, 0.1, -0.1]^\\top$，$a = [-0.3, 0.15]^\\top$，$S = \\{3, 4\\}$，$w = [2.5, 2.5]^\\top$。\n\n### 步骤2：使用提取的已知条件进行验证\n根据所需标准对问题进行验证：\n- **科学上成立**: 该问题属于计算固体力学这一成熟领域，具体涉及降阶建模和超降阶。控制方程代表一个标准的离散非线性力学系统，而超降阶牛顿法是一种有据可查的技术（与GNAT或ECSW方法相关）。所有概念在科学上都是合理的。\n- **适定的**: 对于每个测试案例，都提供了所有必要的输入。任务是直接计算一个牛顿步。$\\Delta a$ 解的存在性取决于 $2 \\times 2$ 矩阵 $A_{\\mathrm{HR}}(u)$ 的可逆性，这本身是计算的一部分，而不是问题陈述中的缺陷。该问题是适定的。\n- **客观的**: 问题是用精确的数学定义和数值数据来表述的。它没有歧义、主观性或见解。\n- **完整性和一致性**: 问题是自包含的。所有矩阵和向量的维度都是一致的。例如，对于 $A_{\\mathrm{HR}} \\in \\mathbb{R}^{2 \\times 2}$，其乘积为 $\\Phi_S^\\top W (J\\Phi)_S$，维度为 $(2 \\times |S|) \\times (|S| \\times |S|) \\times (|S| \\times 2)$，正确地得到一个 $2 \\times 2$ 矩阵。计算所需的所有数据都已明确给出。\n- **无其他缺陷**: 该问题并非不切实际、病态、微不足道或无法验证。它是一个具体的计算练习。\n\n### 步骤3：结论与行动\n该问题被判定为**有效**。将通过对每个测试案例执行指定的计算程序来提供解决方案。\n\n### 求解过程\n\n求解过程包括对每个测试案例系统地应用给定的公式。步骤如下：\n\n1.  **初始化**: 对于给定的测试案例 $(\\alpha, f, a, S, w)$，定义常数矩阵 $K$ 和 $\\Phi$。\n2.  **计算初始状态**: 计算全阶状态向量 $u = \\Phi a$ 和相应的残差向量 $r(u) = K u + \\alpha u^{\\circ 3} - f$。计算其欧几里得范数 $N_{\\text{before}} = \\|r(u)\\|_2$。\n3.  **组装超降阶系统**:\n    a. 形成雅可比矩阵 $J(u) = K + \\operatorname{diag}(3\\alpha u^{\\circ 2})$。\n    b. 提取基的采样行 $\\Phi_S$，以及雅可比-基乘积的采样行 $(J(u)\\Phi)_S$。\n    c. 提取残差的采样项 $r(u)_S$。\n    d. 形成对角权重矩阵 $W = \\operatorname{diag}(w)$。\n    e. 组装超降阶矩阵 $A_{\\mathrm{HR}}(u) = \\Phi_S^\\top W (J(u)\\Phi)_S$ 和超降阶右端向量 $b_{\\mathrm{HR}}(u) = -\\Phi_S^\\top W r(u)_S$。\n4.  **求解更新量**: 求解 $r \\times r$ 线性系统 $A_{\\mathrm{HR}}(u) \\Delta a = b_{\\mathrm{HR}}(u)$，得到降阶坐标更新量 $\\Delta a$。\n5.  **计算更新后的状态**:\n    a. 更新降阶坐标: $a^{+} = a + \\Delta a$。\n    b. 计算新的全阶状态向量: $u^{+} = \\Phi a^{+}$。\n6.  **评估性能**:\n    a. 计算新的残差向量 $r(u^{+}) = K u^{+} + \\alpha (u^{+})^{\\circ 3} - f$ 及其欧几里得范数 $N_{\\text{after}} = \\|r(u^{+})\\|_2$。\n    b. 判断残差范数是否严格减小: $\\textit{improved} = (N_{\\text{after}}  N_{\\text{before}})$。\n    c. 计算比率。如果 $N_{\\text{before}} = 0$，则比率为 NaN。否则，$\\textit{ratio} = N_{\\text{after}} / N_{\\text{before}}$。\n7.  **存储结果**: 将该测试案例的结果汇编成列表 $[N_{\\text{before}}, N_{\\text{after}}, \\textit{ratio}, \\textit{improved}]$。\n\n对所有三个测试案例重复此过程，以生成最终输出。", "answer": "[[1.250552758113697, 0.48209848520790435, 0.3855110185906233, True],[0.5, 0.5, 1.0, False],[0.4287413661191071, 0.5960410403397941, 1.390214816990425, False]]", "id": "3572702"}]}