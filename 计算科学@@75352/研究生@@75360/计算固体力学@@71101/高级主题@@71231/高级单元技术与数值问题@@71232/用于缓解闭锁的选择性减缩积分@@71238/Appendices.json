{"hands_on_practices": [{"introduction": "要真正掌握选择性减缩积分（SRI）的精髓，我们必须从其最基本的构件——单元刚度矩阵——的推导开始。本练习将引导你从第一性原理出发，将材料的应变能分解为体积和偏应变两部分，并对这两部分分别采用不同的数值积分法则。通过这个过程，你将亲手构建出选择性减缩积分元的核心数学表达，为理解其如何缓解锁定问题奠定坚实的基础 [@problem_id:3599144]。", "problem": "考虑一个通过有限元法（FEM）离散化的二维小应变各向同性固体，使用一个双线性四边形单元（$Q_4$），该单元在物理坐标系中占据一个矩形域，节点位于 $(0,0)$、$(a,0)$、$(a,b)$ 和 $(0,b)$。储存的能量密度根据下式分解为体积部分和偏量部分\n$$\nW = \\tfrac{1}{2}K\\big(\\operatorname{tr}\\epsilon\\big)^{2} + \\mu\\,\\epsilon_{\\text{dev}}:\\epsilon_{\\text{dev}},\n$$\n其中，$K$ 是体积模量，$\\mu$ 是剪切模量，$\\epsilon$ 是小应变张量，$\\epsilon_{\\text{dev}} = \\epsilon - \\tfrac{1}{2}(\\operatorname{tr}\\epsilon)\\,\\mathbf{I}$ 是二维偏应变（$\\mathbf{I}$ 是单位张量）。参考空间中的双线性形函数 $N_{i}(\\xi,\\eta)$，$i=1,\\dots,4$，定义在 $[-1,1]\\times[-1,1]$ 上，矩形的等参映射是仿射的，其雅可比行列式为 $|J|=ab/4$。\n\n从此能量密度和虚功原理出发，推导分解为体积贡献和偏量贡献的单元级刚度矩阵，并实施选择性减缩积分（SRI）：使用权重为 $4$ 的单点高斯求积在 $(\\xi,\\eta)=(0,0)$ 处计算体积贡献，并使用权重为单位值的 $2\\times 2$ 高斯法则在 $(\\xi,\\eta)=\\big(\\pm 1/\\sqrt{3},\\pm 1/\\sqrt{3}\\big)$ 处计算偏量贡献。对应变和应力使用二维 Voigt 记法，其中应变-位移矩阵 $B(\\xi,\\eta)$ 由 $N_{i,x}(\\xi,\\eta)$ 和 $N_{i,y}(\\xi,\\eta)$ 构建，其中 $N_{i,x}=(2/a)\\,N_{i,\\xi}$ 和 $N_{i,y}=(2/b)\\,N_{i,\\eta}$，且\n$$\nN_{1}=\\tfrac{1}{4}(1-\\xi)(1-\\eta),\\quad\nN_{2}=\\tfrac{1}{4}(1+\\xi)(1-\\eta),\\quad\nN_{3}=\\tfrac{1}{4}(1+\\xi)(1+\\eta),\\quad\nN_{4}=\\tfrac{1}{4}(1-\\xi)(1+\\eta),\n$$\n以及\n$$\nN_{1,\\xi}=-\\tfrac{1}{4}(1-\\eta),\\quad\nN_{2,\\xi}=\\tfrac{1}{4}(1-\\eta),\\quad\nN_{3,\\xi}=\\tfrac{1}{4}(1+\\eta),\\quad\nN_{4,\\xi}=-\\tfrac{1}{4}(1+\\eta),\n$$\n和\n$$\nN_{1,\\eta}=-\\tfrac{1}{4}(1-\\xi),\\quad\nN_{2,\\eta}=-\\tfrac{1}{4}(1+\\xi),\\quad\nN_{3,\\eta}=\\tfrac{1}{4}(1+\\xi),\\quad\nN_{4,\\eta}=\\tfrac{1}{4}(1-\\xi).\n$$\n将最终的刚度矩阵表示为关于 $a$、$b$、$K$、$\\mu$ 和应变-位移矩阵 $B(\\xi,\\eta)$ 的单个闭式解析表达式。您的最终答案必须是一个计算式，具体来说，是使用 SRI 计算的单元刚度的单个解析表达式。不需要进行数值取整。", "solution": "该问题要求针对一个由单个双线性四边形（$Q_4$）单元离散化的二维小应变各向同性固体的特定情况，推导单元级刚度矩阵。推导过程必须采用选择性减缩积分（SRI）技术。\n\n在线性弹性有限元法中，单元刚度矩阵 $k^e$ 的一般表达式由虚功原理得到，并由单元体积 $\\Omega^e$ 上的积分给出：\n$$\nk^e = \\int_{\\Omega^e} B^T D B \\, d\\Omega\n$$\n其中 $B$ 是应变-位移矩阵，$D$ 是在 Voigt 记法中关联应力和应变的本构矩阵。\n\n对于一个等参单元，此积分被变换到参考域，即 $(\\xi, \\eta)$ 坐标系中的一个正方形 $[-1,1]\\times[-1,1]$。微分体积元变为 $d\\Omega = t|J|d\\xi d\\eta$，其中 $t$ 是单元厚度（我们假设 $t=1$），$|J|$ 是坐标映射的雅可比行列式。问题指明，对于给定的矩形单元， $|J| = ab/4$。因此，刚度矩阵积分为：\n$$\nk^e = \\int_{-1}^{1} \\int_{-1}^{1} B(\\xi, \\eta)^T D B(\\xi, \\eta) \\left(\\frac{ab}{4}\\right) d\\xi d\\eta\n$$\n\n问题指定了将储存的应变能密度 $W$ 分解为体积部分和偏量部分：\n$$\nW = W_{vol} + W_{dev} = \\tfrac{1}{2}K\\big(\\operatorname{tr}\\epsilon\\big)^{2} + \\mu\\,\\epsilon_{\\text{dev}}:\\epsilon_{\\text{dev}}\n$$\n这种能量分解导致了本构矩阵 $D = D_{vol} + D_{dev}$ 的相应加性分解。我们使用 Voigt 记法为一个二维问题推导这些矩阵，应变向量为 $\\boldsymbol{\\epsilon} = [\\epsilon_{xx}, \\epsilon_{yy}, \\gamma_{xy}]^T$，其中 $\\gamma_{xy} = 2\\epsilon_{xy}$ 是工程剪应变。\n\n体积能量项是 $W_{vol} = \\frac{1}{2}K(\\epsilon_{xx}+\\epsilon_{yy})^2$。在二次型 $\\frac{1}{2}\\boldsymbol{\\epsilon}^T D_{vol} \\boldsymbol{\\epsilon}$ 中，这对应于体积本构矩阵：\n$$\nD_{vol} = K \\begin{pmatrix} 1  1  0 \\\\ 1  1  0 \\\\ 0  0  0 \\end{pmatrix}\n$$\n\n偏量能量项是 $W_{dev} = \\mu\\,\\epsilon_{\\text{dev}}:\\epsilon_{\\text{dev}}$。对于二维应变状态，偏应变张量是 $\\epsilon_{dev} = \\epsilon - \\tfrac{1}{2}(\\operatorname{tr}\\epsilon)\\mathbf{I}$，$\\epsilon_{dev}:\\epsilon_{dev}$ 项变为 $\\frac{1}{2}(\\epsilon_{xx}-\\epsilon_{yy})^2 + \\frac{1}{2}\\gamma_{xy}^2$。因此，$W_{dev} = \\frac{\\mu}{2}\\left((\\epsilon_{xx}-\\epsilon_{yy})^2 + \\gamma_{xy}^2\\right)$。在二次型 $\\frac{1}{2}\\boldsymbol{\\epsilon}^T D_{dev} \\boldsymbol{\\epsilon}$ 中，这对应于偏量本构矩阵：\n$$\nD_{dev} = \\mu \\begin{pmatrix} 1  -1  0 \\\\ -1  1  0 \\\\ 0  0  1 \\end{pmatrix}\n$$\n随着本构矩阵的分解，刚度矩阵也被分解：\n$$\nk^e = k^e_{vol} + k^e_{dev} = \\frac{ab}{4} \\int_{-1}^{1} \\int_{-1}^{1} B^T D_{vol} B \\, d\\xi d\\eta + \\frac{ab}{4} \\int_{-1}^{1} \\int_{-1}^{1} B^T D_{dev} B \\, d\\xi d\\eta\n$$\n\n选择性减缩积分（SRI）方法使用不同的数值求积法则来计算这两个积分。\n1.  体积部分 $k^e_{vol}$，使用单点高斯求积法则进行积分。单个求积点是 $(\\xi_v, \\eta_v) = (0,0)$，权重为 $w_v = 4$。该积分近似为：\n$$\nk^e_{vol} \\approx \\frac{ab}{4} \\left( w_v \\cdot B^T(0,0) D_{vol} B(0,0) \\right) = \\frac{ab}{4} \\left( 4 \\cdot B^T(0,0) D_{vol} B(0,0) \\right) = ab B^T(0,0) D_{vol} B(0,0)\n$$\n\n2.  偏量部分 $k^e_{dev}$，使用 $2\\times2$ 高斯求积法则进行积分。这涉及四个求积点，记为 $(\\xi_j, \\eta_j)$，$j=1, \\dots, 4$，即 $(\\pm 1/\\sqrt{3}, \\pm 1/\\sqrt{3})$。每个点的权重为 $w_j=1$。该积分通过对这四个点的求和来近似：\n$$\nk^e_{dev} \\approx \\frac{ab}{4} \\sum_{j=1}^{4} \\left( w_j \\cdot B^T(\\xi_j, \\eta_j) D_{dev} B(\\xi_j, \\eta_j) \\right) = \\frac{ab}{4} \\sum_{j=1}^{4} B^T(\\xi_j, \\eta_j) D_{dev} B(\\xi_j, \\eta_j)\n$$\n\n结合这两个部分，得到 SRI 计算的单元刚度矩阵的最终表达式。问题要求用给定的参数和矩阵 $B(\\xi, \\eta)$ 来表示这个表达式。我们将推导出的矩阵 $D_{vol}$ 和 $D_{dev}$ 代入 $k^e_{vol}$ 和 $k^e_{dev}$ 的表达式中。设四个偏量求积点的集合为 $\\mathcal{Q}_{dev} = \\{(\\pm 1/\\sqrt{3}, \\pm 1/\\sqrt{3})\\}$。最终的刚度矩阵是：\n$$\nk^e_{SRI} = ab \\, B^T(0,0) D_{vol} B(0,0) + \\frac{ab}{4} \\sum_{(\\xi,\\eta) \\in \\mathcal{Q}_{dev}} B^T(\\xi,\\eta) D_{dev} B(\\xi,\\eta)\n$$\n代入 $D_{vol}$ 和 $D_{dev}$ 的显式形式：\n$$\nk^e_{SRI} = ab \\cdot K \\cdot B^T(0,0) \\begin{pmatrix} 1  1  0 \\\\ 1  1  0 \\\\ 0  0  0 \\end{pmatrix} B(0,0) + \\frac{ab}{4} \\cdot \\mu \\sum_{j=1}^{4} B^T(\\xi_j, \\eta_j) \\begin{pmatrix} 1  -1  0 \\\\ -1  1  0 \\\\ 0  0  1 \\end{pmatrix} B(\\xi_j, \\eta_j)\n$$\n其中求和是对四个点 $(\\xi_j, \\eta_j) = (\\pm 1/\\sqrt{3}, \\pm 1/\\sqrt{3})$ 进行的。这是使用指定的 SRI 方案计算的刚度矩阵的单个解析表达式。", "answer": "$$\n\\boxed{ab K B^T(0,0) \\begin{pmatrix} 1  1  0 \\\\ 1  1  0 \\\\ 0  0  0 \\end{pmatrix} B(0,0) + \\frac{ab\\mu}{4} \\sum_{j=1}^{4} B^T(\\xi_j, \\eta_j) \\begin{pmatrix} 1  -1  0 \\\\ -1  1  0 \\\\ 0  0  1 \\end{pmatrix} B(\\xi_j, \\eta_j) \\quad \\text{其中} \\quad (\\xi_j, \\eta_j) \\in \\{(\\pm\\frac{1}{\\sqrt{3}}, \\pm\\frac{1}{\\sqrt{3}})\\}}\n$$", "id": "3599144"}, {"introduction": "在推导出单个单元的刚度矩阵之后，下一步是将其应用于实际的边界值问题中，以观察其宏观效果。本练习是一个编程实践，要求你为一个典型的平面应变问题实现完整的有限元分析，并直接比较全积分（FI）与选择性减缩积分（SRI）的计算结果。通过量化分析，你将清晰地看到 SRI 在处理近不可压缩材料时如何有效克服体积锁定现象，从而获得更精确的位移解 [@problem_id:2592773]。", "problem": "考虑一个在矩形域 $\\Omega = [0,W] \\times [0,H]$ 上的二维小应变、线性弹性平面应变边值问题，其边界 $\\partial \\Omega = \\Gamma_u \\cup \\Gamma_t$，其中底边 $\\Gamma_u = \\{(x,0): 0 \\le x \\le W\\}$ 被固定，位移指定为零，而顶边 $\\Gamma_t = \\{(x,H): 0 \\le x \\le W\\}$ 承受一个大小为 $p$、作用于负 $y$ 方向的均布表面牵引力。左边和右边为无牵引力边界。根据虚功原理推导出的控制弱形式为\n$$\n\\int_{\\Omega} \\boldsymbol{\\varepsilon}(\\boldsymbol{u}) : \\mathbf{C} : \\boldsymbol{\\varepsilon}(\\boldsymbol{v}) \\, \\mathrm{d}\\Omega = \\int_{\\Gamma_t} \\boldsymbol{t} \\cdot \\boldsymbol{v} \\, \\mathrm{d}\\Gamma\n$$\n对于所有在 $\\Gamma_u$ 上为零的容许虚位移 $\\boldsymbol{v}$ 成立，其中 $\\boldsymbol{u} = (u_x,u_y)$ 是位移场，$\\boldsymbol{\\varepsilon}(\\boldsymbol{u}) = \\tfrac{1}{2}(\\nabla \\boldsymbol{u} + \\nabla \\boldsymbol{u}^\\top)$ 是小应变张量，$\\boldsymbol{t} = (0,-p)$ 是在 $\\Gamma_t$ 上的牵引力，$\\mathbf{C}$ 是由杨氏模量 $E$ 和泊松比 $\\nu$ 表征的平面应变各向同性固体的四阶弹性张量。在 Voigt 记法中，应变向量为 $\\boldsymbol{\\epsilon} = [\\epsilon_{xx}, \\epsilon_{yy}, \\gamma_{xy}]^\\top$，其中 $\\gamma_{xy} = 2 \\epsilon_{xy}$，应力-应变关系为 $\\boldsymbol{\\sigma} = \\mathbf{D} \\, \\boldsymbol{\\epsilon}$，其中\n$$\n\\mathbf{D} = \n\\begin{bmatrix}\n\\lambda + 2\\mu  \\lambda  0 \\\\\n\\lambda  \\lambda + 2\\mu  0 \\\\\n0  0  \\mu\n\\end{bmatrix},\n\\quad\n\\mu = \\frac{E}{2(1+\\nu)}, \n\\quad\n\\lambda = \\frac{E \\nu}{(1+\\nu)(1-2\\nu)},\n$$\n体积模量 $\\kappa = \\lambda + \\tfrac{2}{3}\\mu$。\n\n使用带有节点形函数的等参双线性四边形 (Q4) 有限元\n$$\nN_1 = \\tfrac{1}{4}(1-\\xi)(1-\\eta), \\quad\nN_2 = \\tfrac{1}{4}(1+\\xi)(1-\\eta), \\quad\nN_3 = \\tfrac{1}{4}(1+\\xi)(1+\\eta), \\quad\nN_4 = \\tfrac{1}{4}(1-\\xi)(1+\\eta),\n$$\n定义在母单元域 $(\\xi,\\eta) \\in [-1,1]^2$ 上，并使用标准等参映射到物理单元。令 $\\mathbf{B}(\\xi,\\eta)$ 表示 $3\\times 8$ 的应变-位移矩阵，使得对于单元节点位移向量 $\\mathbf{u}_e \\in \\mathbb{R}^8$，有 $\\boldsymbol{\\epsilon} = \\mathbf{B} \\, \\mathbf{u}_e$。\n\n您必须实现两种单元积分策略：\n\n1. 完全积分 (FI)：组装单元刚度矩阵\n$$\n\\mathbf{K}_e^{\\mathrm{FI}} = \\int_{\\Omega_e} \\mathbf{B}^\\top \\mathbf{D} \\, \\mathbf{B} \\, \\mathrm{d}\\Omega\n$$\n在每个母坐标方向上使用张量积两点高斯求积（即 $2 \\times 2$ 个高斯点），顶边上的边载荷通过两点高斯求积精确计算。\n\n2. 选择性减缩积分 (SRI)：将本构算子分解为偏量部分和体积部分，\n$$\n\\mathbf{D} = \\mathbf{D}_{\\mathrm{dev}} + \\mathbf{D}_{\\mathrm{vol}},\n\\quad\n\\mathbf{D}_{\\mathrm{vol}} = \\kappa \\, \\mathbf{P}^\\top \\mathbf{P},\n\\quad\n\\mathbf{P} = \n\\begin{bmatrix}\n1  1  0\n\\end{bmatrix},\n\\quad\n\\mathbf{D}_{\\mathrm{dev}} = \\mathbf{D} - \\mathbf{D}_{\\mathrm{vol}},\n$$\n并组装\n$$\n\\mathbf{K}_e^{\\mathrm{SRI}} = \\underbrace{\\int_{\\Omega_e} \\mathbf{B}^\\top \\mathbf{D}_{\\mathrm{dev}} \\, \\mathbf{B} \\, \\mathrm{d}\\Omega}_{\\text{使用 } 2\\times 2 \\text{ 高斯积分}}\n+\n\\underbrace{\\int_{\\Omega_e} (\\mathbf{P}\\mathbf{B})^\\top \\kappa \\, (\\mathbf{P}\\mathbf{B}) \\, \\mathrm{d}\\Omega}_{\\text{在 } (\\xi,\\eta)=(0,0) \\text{ 处使用 } 1\\times 1 \\text{ 高斯积分}}。\n$$\n顶边上的表面牵引力向量应始终使用沿该边的两点高斯求积进行精确积分。\n\n在矩形 $\\Omega$ 上构建一个 $n_x \\times n_y$ 个 Q4 单元的结构化网格，在底边 $\\Gamma_u$ 上施加齐次狄利克雷边界条件 $\\boldsymbol{u} = \\boldsymbol{0}$，组装全局线性系统，并求解节点位移向量。令 $\\bar{u}_y$ 表示顶边的平均竖向位移，定义为\n$$\n\\bar{u}_y = \\frac{1}{|\\mathcal{N}_t|}\\sum_{a \\in \\mathcal{N}_t} (u_y)_a,\n$$\n其中 $\\mathcal{N}_t$ 是位于 $y=H$ 上的节点集合。作为高保真度参考，对于下面定义的每个测试用例，使用 SRI 方法在宽度上有 $N_x^{\\mathrm{ref}} = 32$ 个单元、高度上有 $N_y^{\\mathrm{ref}} = \\max\\{2, \\mathrm{round}(32 \\, H/W)\\}$ 个单元的精细网格上计算 $\\bar{u}_y^{\\mathrm{ref}}$。\n\n对于方法 $m \\in \\{\\mathrm{FI}, \\mathrm{SRI}\\}$，其标量响应的绝对误差定义为\n$$\ne_m = \\left| \\bar{u}_y^{(m)} - \\bar{u}_y^{\\mathrm{ref}} \\right|.\n$$\n定义 SRI 相对于完全积分的锁定误差减小因子（无量纲）为\n$$\n\\rho = \\frac{e_{\\mathrm{FI}} - e_{\\mathrm{SRI}}}{e_{\\mathrm{FI}}}.\n$$\n$\\rho$ 的正值表示选择性减缩积分减小了计算响应中由锁定引起的误差。\n\n实现一个程序，为以下四个测试用例组成的测试套件计算 $\\rho$。所有物理量必须采用国际单位制 (SI) 处理，即长度单位为米 (m)，应力（包括 $E$ 和 $p$）单位为帕斯卡 (Pa)，位移单位为米 (m)。不使用角度。\n\n测试套件：\n- 用例 1（近乎不可压缩，中等网格）：$W = 1\\,\\mathrm{m}$，$H = 1\\,\\mathrm{m}$，$E = 1000\\,\\mathrm{Pa}$，$\\nu = 0.4999$，$p = 1\\,\\mathrm{Pa}$，$n_x = 2$，$n_y = 2$。\n- 用例 2（近乎不可压缩，非常粗糙的网格）：$W = 1\\,\\mathrm{m}$，$H = 1\\,\\mathrm{m}$，$E = 1000\\,\\mathrm{Pa}$，$\\nu = 0.4999$，$p = 1\\,\\mathrm{Pa}$，$n_x = 1$，$n_y = 1$。\n- 用例 3（近乎不可压缩，矩形域）：$W = 2\\,\\mathrm{m}$，$H = 1\\,\\mathrm{m}$，$E = 1000\\,\\mathrm{Pa}$，$\\nu = 0.4999$，$p = 1\\,\\mathrm{Pa}$，$n_x = 4$，$n_y = 2$。\n- 用例 4（可压缩，中等网格）：$W = 1\\,\\mathrm{m}$，$H = 1\\,\\mathrm{m}$，$E = 1000\\,\\mathrm{Pa}$，$\\nu = 0.3$，$p = 1\\,\\mathrm{Pa}$，$n_x = 2$，$n_y = 2$。\n\n您的程序应生成单行输出，其中包含四个用例的结果，格式为用方括号括起来的逗号分隔列表，顺序与上述用例一致。每个条目必须是一个实数（浮点数），等于该用例的 $\\rho$ 值，并四舍五入到六位小数。例如，一行输出应如下所示：\"[0.123456,0.234567,0.345678,0.456789]\"。", "solution": "我们从第一性原理推导计算过程。出发点是平面应变线性弹性的弱形式：\n$$\n\\int_{\\Omega} \\boldsymbol{\\varepsilon}(\\boldsymbol{u}) : \\mathbf{C} : \\boldsymbol{\\varepsilon}(\\boldsymbol{v}) \\, \\mathrm{d}\\Omega = \\int_{\\Gamma_t} \\boldsymbol{t} \\cdot \\boldsymbol{v} \\, \\mathrm{d}\\Gamma.\n$$\n使用等参双线性四边形 (Q4) 单元的离散化采用以下插值\n$$\n\\boldsymbol{u}(x,y) \\approx \\sum_{a=1}^{4} N_a(\\xi,\\eta) \\, \\boldsymbol{u}_a, \n\\quad \n\\boldsymbol{\\epsilon} = \\mathbf{B}(\\xi,\\eta)\\, \\mathbf{u}_e,\n$$\n其中 $(\\xi,\\eta)$ 是母单元坐标，$\\{N_a\\}$ 是 $[-1,1]^2$ 上的双线性形函数，$\\mathbf{B}$ 将节点位移映射到 Voigt 应变向量 $\\boldsymbol{\\epsilon} = [\\epsilon_{xx}, \\epsilon_{yy}, \\gamma_{xy}]^\\top$，其中 $\\gamma_{xy} = \\partial u_x/\\partial y + \\partial u_y/\\partial x$。从母单元坐标到物理坐标的等参映射为 $x(\\xi,\\eta)=\\sum_a N_a(\\xi,\\eta) x_a$, $y(\\xi,\\eta)=\\sum_a N_a(\\xi,\\eta) y_a$，其雅可比矩阵为 $\\mathbf{J} = \\begin{bmatrix}\\partial x/\\partial \\xi  \\partial y/\\partial \\xi \\\\ \\partial x/\\partial \\eta  \\partial y/\\partial \\eta \\end{bmatrix}$。梯度 $\\partial N_a/\\partial x$ 和 $\\partial N_a/\\partial y$ 可由 $\\begin{bmatrix}\\partial N_a/\\partial x  \\partial N_a/\\partial y \\end{bmatrix} = \\begin{bmatrix}\\partial N_a/\\partial \\xi  \\partial N_a/\\partial \\eta\\end{bmatrix}\\mathbf{J}^{-1}$ 得出。然后，对于平面应变各向同性弹性，单元刚度矩阵为\n$$\n\\mathbf{K}_e = \\int_{\\Omega_e} \\mathbf{B}^\\top \\mathbf{D}\\, \\mathbf{B} \\, \\mathrm{d}\\Omega,\n$$\n由顶边牵引力产生的单元节点力为\n$$\n\\mathbf{f}_e^{\\Gamma} = \\int_{\\Gamma_{t,e}} \\mathbf{N}^\\top \\boldsymbol{t} \\, \\mathrm{d}\\Gamma,\n$$\n其中 $\\mathbf{N} = \\mathrm{diag}(N_1,N_1,N_2,N_2,N_3,N_3,N_4,N_4)$ 映射了向量值形函数，$\\Gamma_{t,e}$ 是顶边与该单元相交的部分。直边上的边界积分通过在母单元边 $(\\xi\\in[-1,1], \\eta = +1)$ 上的一维高斯求积计算，并使用正确的边雅可比因子 $\\| \\partial \\boldsymbol{x}/\\partial \\xi \\|$。\n\n对于体积分的数值积分，Q4 单元的完全积分在每个母单元方向上使用两点高斯求积：点为 $\\{\\pm 1/\\sqrt{3}\\}$，权重为 $\\{1,1\\}$，从而在正方形内形成 $2\\times 2$ 个点。减缩积分使用单点 $(\\xi,\\eta)=(0,0)$，权重为 $4$（一维权重 $\\{2\\}$ 的乘积）。然而，对整个刚度矩阵使用减缩积分通常会导致秩亏（沙漏现象）。为了减轻体积锁定——即当 $\\nu \\to 1/2$（近乎不可压缩）时观察到的人为刚化现象——一个稳定的折衷方案是选择性减缩积分 (SRI)。SRI 利用了弹性应变能密度到偏量和体积部分的标准分解：\n$$\nW = \\mu\\, \\boldsymbol{\\varepsilon}_{\\mathrm{dev}}:\\boldsymbol{\\varepsilon}_{\\mathrm{dev}} + \\frac{\\kappa}{2} (\\mathrm{tr}\\, \\boldsymbol{\\varepsilon})^2,\n$$\n其中剪切模量为 $\\mu$，体积模量为 $\\kappa = \\lambda + \\tfrac{2}{3}\\mu$。在限制于面内分量 $(\\epsilon_{xx},\\epsilon_{yy},\\gamma_{xy})$ 的 Voigt 形式中，我们通过以下方式近似此分解\n$$\n\\mathbf{D}_{\\mathrm{vol}} = \\kappa \\, \\mathbf{P}^\\top \\mathbf{P}, \n\\quad \\mathbf{P} = \\begin{bmatrix}1  1  0\\end{bmatrix},\n\\quad\n\\mathbf{D}_{\\mathrm{dev}} = \\mathbf{D} - \\mathbf{D}_{\\mathrm{vol}}.\n$$\n这种选择保留了在面内子空间中的正确静水压力刚度，同时确保偏量响应由 $\\mathbf{D}_{\\mathrm{dev}}$ 处理。然后，SRI 组装过程使用 2x2 高斯点积分偏量部分，并使用位于 $(\\xi,\\eta)=(0,0)$ 的单个高斯点积分体积部分。该策略避免了沙漏模式（因为偏量部分是完全积分的）并减轻了体积锁定（因为体积刚度是降阶积分的，这软化了当 $\\nu$ 接近 $1/2$ 时在完全积分下出现的伪约束）。\n\n算法设计：\n1. 在 $[0,W]\\times[0,H]$ 上生成一个 $n_x \\times n_y$ 个 Q4 单元的结构化网格，节点坐标位于笛卡尔网格上。每个单元的连接性遵循局部节点顺序：$(\\xi,\\eta)=(-1,-1)$ 左下，$(+1,-1)$ 右下，$(+1,+1)$ 右上，$(-1,+1)$ 左上。\n2. 对每个单元，计算单元刚度：\n   - 完全积分：$\\mathbf{K}_e^{\\mathrm{FI}} = \\sum_{i=1}^2 \\sum_{j=1}^2 \\mathbf{B}(\\xi_i,\\eta_j)^\\top \\mathbf{D} \\, \\mathbf{B}(\\xi_i,\\eta_j) \\, \\det\\mathbf{J}(\\xi_i,\\eta_j)$。\n   - SRI：$\\mathbf{K}_e^{\\mathrm{SRI}} = \\sum_{i=1}^2 \\sum_{j=1}^2 \\mathbf{B}^\\top \\mathbf{D}_{\\mathrm{dev}} \\mathbf{B} \\, \\det\\mathbf{J} + 4 \\, (\\mathbf{P}\\mathbf{B}(0,0))^\\top \\kappa \\, (\\mathbf{P}\\mathbf{B}(0,0)) \\, \\det\\mathbf{J}(0,0)$。\n   体积项中的因子 $4$ 是对应于母单元正方形面积的二维减缩高斯权重。\n3. 以稀疏的压缩稀疏行 (CSR) 格式组装全局刚度矩阵，方法是将单元贡献累加到全局自由度中，其中每个节点贡献两个自由度 $(u_x,u_y)$。\n4. 通过对每个位于 $y=H$ 上的单元边使用两点高斯求积进行积分，从顶边压力组装全局载荷向量：$\\mathbf{f}_e^\\Gamma = \\sum_{k=1}^2 \\mathbf{N}^\\top(\\xi_k,\\eta=+1) \\, \\boldsymbol{t} \\, \\|\\partial \\boldsymbol{x}/\\partial \\xi\\| \\, w_k$。\n5. 通过提取自由度子矩阵和右手边向量，并求解简化后的系统，来施加底边 $\\Gamma_u$ 上的齐次狄利克雷边界条件。这与弱形式一致，并避免了因显式修改行和列而导致的病态问题。\n6. 计算标量响应 $\\bar{u}_y$，即在所有 $y=H$ 的节点上的平均竖向位移。\n7. 对每个测试用例，使用 SRI 和 $N_x^{\\mathrm{ref}} = 32$ 及 $N_y^{\\mathrm{ref}} = \\max\\{2, \\mathrm{round}(32 \\, H/W)\\}$ 的精细网格计算参考值 $\\bar{u}_y^{\\mathrm{ref}}$。计算绝对误差 $e_{\\mathrm{FI}}$ 和 $e_{\\mathrm{SRI}}$，最后计算减小因子 $\\rho = (e_{\\mathrm{FI}} - e_{\\mathrm{SRI}})/e_{\\mathrm{FI}}$。\n8. 将对应于测试套件的四个 $\\rho$ 值聚合到一个列表中，并按要求格式单行打印。\n\n为什么 SRI 可以减少锁定：当 $\\nu \\to 1/2$ 时，Lamé 参数 $\\lambda$（以及因此的体积模量 $\\kappa$）无界增长，这使得在完全积分下体积部分的刚度占主导地位，在离散意义上过强地强制 $\\mathrm{tr}\\, \\boldsymbol{\\epsilon} \\approx 0$，从而产生过刚的响应（锁定）。通过以降阶积分体积贡献，SRI 有效地降低了与体积应变相关的离散约束强度，同时保留了偏量刚度和稳定性。因此，对于近乎不可压缩的材料，与完全积分相比，SRI 在粗糙网格上通常能产生更柔顺和更准确的响应。对于中等可压缩的材料（例如 $\\nu = 0.3$），两种方案给出的结果几乎相同，因为体积刚度不占主导地位。\n\n下面的程序实现了此过程，解决了测试套件，并按要求将四个减小因子作为单个逗号分隔列表打印出来，四舍五入到六位小数。", "answer": "```python\nimport numpy as np\nfrom scipy.sparse import coo_matrix, csr_matrix\nfrom scipy.sparse.linalg import spsolve\n\ndef constitutive_plane_strain(E, nu):\n    lam = E * nu / ((1.0 + nu) * (1.0 - 2.0 * nu))\n    mu = E / (2.0 * (1.0 + nu))\n    D = np.array([[lam + 2.0 * mu, lam, 0.0],\n                  [lam, lam + 2.0 * mu, 0.0],\n                  [0.0, 0.0, mu]], dtype=float)\n    kappa = lam + 2.0 * mu / 3.0\n    return D, lam, mu, kappa\n\ndef shape_Q4(ksi, eta):\n    N = np.array([\n        0.25 * (1 - ksi) * (1 - eta),\n        0.25 * (1 + ksi) * (1 - eta),\n        0.25 * (1 + ksi) * (1 + eta),\n        0.25 * (1 - ksi) * (1 + eta)\n    ], dtype=float)\n    dN_dksi = 0.25 * np.array([\n        -(1 - eta),\n        (1 - eta),\n        (1 + eta),\n        -(1 + eta)\n    ], dtype=float)\n    dN_deta = 0.25 * np.array([\n        -(1 - ksi),\n        -(1 + ksi),\n        (1 + ksi),\n        (1 - ksi)\n    ], dtype=float)\n    return N, dN_dksi, dN_deta\n\ndef B_matrix_Q4(xe, ksi, eta):\n    # xe: 4x2 nodal coordinates of the element (in order 1..4)\n    N, dN_dksi, dN_deta = shape_Q4(ksi, eta)\n    J = np.zeros((2, 2), dtype=float)\n    # Compute Jacobian J = [dx/dksi dy/dksi; dx/deta dy/deta]\n    J[0, 0] = np.dot(dN_dksi, xe[:, 0])\n    J[0, 1] = np.dot(dN_dksi, xe[:, 1])\n    J[1, 0] = np.dot(dN_deta, xe[:, 0])\n    J[1, 1] = np.dot(dN_deta, xe[:, 1])\n    detJ = np.linalg.det(J)\n    invJ = np.linalg.inv(J)\n    # Gradients with respect to x,y: grads[i,0]=dNi/dx, grads[i,1]=dNi/dy\n    grads = np.zeros((4, 2), dtype=float)\n    for i in range(4):\n        dN_parent = np.array([dN_dksi[i], dN_deta[i]])\n        dN_xy = invJ @ dN_parent\n        grads[i, 0] = dN_xy[0]\n        grads[i, 1] = dN_xy[1]\n    # Build B matrix (3x8) for plane strain with Voigt [exx, eyy, gxy]\n    B = np.zeros((3, 8), dtype=float)\n    for i in range(4):\n        Bi = np.array([\n            [grads[i, 0], 0.0],\n            [0.0, grads[i, 1]],\n            [grads[i, 1], grads[i, 0]]\n        ], dtype=float)\n        B[:, 2 * i:2 * i + 2] = Bi\n    return B, detJ\n\ndef element_stiffness_FI(xe, D):\n    # 2x2 Gauss integration\n    gp = 1.0 / np.sqrt(3.0)\n    ksi_list = [-gp, gp]\n    eta_list = [-gp, gp]\n    Ke = np.zeros((8, 8), dtype=float)\n    for ksi in ksi_list:\n        for eta in eta_list:\n            B, detJ = B_matrix_Q4(xe, ksi, eta)\n            Ke += (B.T @ D @ B) * detJ\n    return Ke\n\ndef element_stiffness_SRI(xe, D, kappa):\n    # D_dev = D - kappa * P^T P, with P = [1,1,0]\n    P = np.array([[1.0, 1.0, 0.0]], dtype=float)\n    D_vol = kappa * (P.T @ P)\n    D_dev = D - D_vol\n    # Deviatoric part with 2x2 Gauss\n    gp = 1.0 / np.sqrt(3.0)\n    ksi_list = [-gp, gp]\n    eta_list = [-gp, gp]\n    Ke = np.zeros((8, 8), dtype=float)\n    for ksi in ksi_list:\n        for eta in eta_list:\n            B, detJ = B_matrix_Q4(xe, ksi, eta)\n            Ke += (B.T @ D_dev @ B) * detJ\n    # Volumetric part with 1x1 Gauss at (0,0), weight = 4\n    Bc, detJc = B_matrix_Q4(xe, 0.0, 0.0)\n    Bvol = P @ Bc  # shape (1,8)\n    Ke += (Bvol.T @ (kappa * Bvol)) * detJc * 4.0\n    return Ke\n\ndef edge_load_top_Q4(xe, p):\n    # Compute consistent nodal load vector (8,) for top edge (eta=+1) traction t = (0,-p)\n    # 2-point Gauss along the edge\n    gp = 1.0 / np.sqrt(3.0)\n    s_list = [-gp, gp]\n    w_list = [1.0, 1.0]\n    fe = np.zeros(8, dtype=float)\n    eta = 1.0\n    for s, w in zip(s_list, w_list):\n        N, dN_dksi, dN_deta = shape_Q4(s, eta)\n        # Edge tangent vector dx/dksi at eta=+1\n        dx_dksi = np.dot(dN_dksi, xe[:, 0])\n        dy_dksi = np.dot(dN_dksi, xe[:, 1])\n        J_edge = np.sqrt(dx_dksi ** 2 + dy_dksi ** 2)\n        # Assemble contributions: only vertical traction\n        t = np.array([0.0, -p], dtype=float)\n        for i in range(4):\n            Ni = N[i]\n            fe[2 * i:2 * i + 2] += Ni * t * J_edge * w\n    return fe\n\ndef generate_mesh(W, H, nx, ny):\n    xs = np.linspace(0.0, W, nx + 1)\n    ys = np.linspace(0.0, H, ny + 1)\n    coords = np.array([(x, y) for y in ys for x in xs], dtype=float)\n    # Node numbering: row-major (x fastest), node index = j*(nx+1)+i\n    conn = []\n    for j in range(ny):\n        for i in range(nx):\n            n1 = j * (nx + 1) + i\n            n2 = n1 + 1\n            n3 = n1 + (nx + 1) + 1\n            n4 = n1 + (nx + 1)\n            conn.append([n1, n2, n3, n4])\n    conn = np.array(conn, dtype=int)\n    return coords, conn\n\ndef assemble_system(W, H, nx, ny, E, nu, p, method):\n    coords, conn = generate_mesh(W, H, nx, ny)\n    nnode = coords.shape[0]\n    ndof = 2 * nnode\n    D, lam, mu, kappa = constitutive_plane_strain(E, nu)\n\n    rows = []\n    cols = []\n    data = []\n    f = np.zeros(ndof, dtype=float)\n\n    # Assemble stiffness and traction\n    for e, nodes in enumerate(conn):\n        xe = coords[nodes, :]\n        if method == 'FI':\n            Ke = element_stiffness_FI(xe, D)\n        elif method == 'SRI':\n            Ke = element_stiffness_SRI(xe, D, kappa)\n        else:\n            raise ValueError(\"Unknown method\")\n        # Global dof indices\n        dofs = np.zeros(8, dtype=int)\n        for a_local, a in enumerate(nodes):\n            dofs[2 * a_local] = 2 * a\n            dofs[2 * a_local + 1] = 2 * a + 1\n        # Add to global COO\n        for i_local in range(8):\n            gi = dofs[i_local]\n            for j_local in range(8):\n                gj = dofs[j_local]\n                rows.append(gi)\n                cols.append(gj)\n                data.append(Ke[i_local, j_local])\n\n        # Top edge load if this element has its top edge on y=H\n        # Local top edge nodes are 3 (index 2) and 4 (index 3)\n        y3 = xe[2, 1]\n        y4 = xe[3, 1]\n        if np.isclose(y3, H) and np.isclose(y4, H):\n            fe = edge_load_top_Q4(xe, p)\n            for a_local, a in enumerate(nodes):\n                f[2 * a] += fe[2 * a_local]\n                f[2 * a + 1] += fe[2 * a_local + 1]\n\n    K = coo_matrix((data, (rows, cols)), shape=(ndof, ndof)).tocsr()\n\n    # Apply Dirichlet BCs on bottom edge: y=0, fix both u and v\n    bottom_nodes = np.where(np.isclose(coords[:, 1], 0.0))[0]\n    fixed_dofs = []\n    for n in bottom_nodes:\n        fixed_dofs.append(2 * n)     # u_x\n        fixed_dofs.append(2 * n + 1) # u_y\n    fixed_dofs = np.array(sorted(set(fixed_dofs)), dtype=int)\n\n    all_dofs = np.arange(ndof, dtype=int)\n    free_dofs = np.setdiff1d(all_dofs, fixed_dofs, assume_unique=False)\n\n    K_ff = K[free_dofs, :][:, free_dofs]\n    f_f = f[free_dofs]\n\n    u = np.zeros(ndof, dtype=float)\n    if K_ff.shape[0] > 0:\n        u_f = spsolve(K_ff, f_f)\n        u[free_dofs] = u_f\n\n    # Average vertical displacement on top edge\n    top_nodes = np.where(np.isclose(coords[:, 1], H))[0]\n    v_dofs = 2 * top_nodes + 1\n    avg_v = float(np.mean(u[v_dofs])) if v_dofs.size > 0 else 0.0\n    return avg_v\n\ndef compute_reduction_for_case(W, H, nx, ny, E, nu, p):\n    # Reference using SRI on fine mesh\n    Nx_ref = 32\n    Ny_ref = int(np.round(32.0 * H / W))\n    Ny_ref = max(2, Ny_ref)\n    uref = assemble_system(W, H, Nx_ref, Ny_ref, E, nu, p, method='SRI')\n\n    # Coarse solutions\n    u_fi = assemble_system(W, H, nx, ny, E, nu, p, method='FI')\n    u_sri = assemble_system(W, H, nx, ny, E, nu, p, method='SRI')\n\n    e_fi = abs(u_fi - uref)\n    e_sri = abs(u_sri - uref)\n    rho = (e_fi - e_sri) / e_fi if e_fi != 0.0 else 0.0\n    return rho\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Parameters: (W, H, nx, ny, E, nu, p)\n    test_cases = [\n        (1.0, 1.0, 2, 2, 1000.0, 0.4999, 1.0),\n        (1.0, 1.0, 1, 1, 1000.0, 0.4999, 1.0),\n        (2.0, 1.0, 4, 2, 1000.0, 0.4999, 1.0),\n        (1.0, 1.0, 2, 2, 1000.0, 0.3, 1.0),\n    ]\n\n    results = []\n    for case in test_cases:\n        W, H, nx, ny, E, nu, p = case\n        rho = compute_reduction_for_case(W, H, nx, ny, E, nu, p)\n        # Round to six decimal places\n        results.append(f\"{rho:.6f}\")\n\n    print(f\"[{','.join(results)}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "2592773"}, {"introduction": "虽然选择性减缩积分成功地解决了体积锁定问题，但对刚度矩阵的积分降阶也可能引入新的数值不稳定问题，即非物理的“沙漏模式”。这个高级练习旨在探讨如何从理论上抑制这些伪变形模式。你将通过构造一个只惩罚位移场中非物理分量的稳定能量泛函，来学习一种既能保证单元稳定性，又不影响物理变形模式精度的严谨方法 [@problem_id:3599211]。", "problem": "考虑在有限元法 (FEM) 中处于平面应变状态的单个双线性四节点四边形单元。设该单元的节点位移向量 $u \\in \\mathbb{R}^{8}$ 按 $(u_{1x}, u_{1y}, u_{2x}, u_{2y}, u_{3x}, u_{3y}, u_{4x}, u_{4y})^{T}$ 排序。假设为小应变线性弹性，因此无穷小应变由 $\\varepsilon(u) = \\nabla^{s} u$ 给出，并且应变-位移矩阵 $B(\\xi,\\eta) \\in \\mathbb{R}^{3 \\times 8}$ 由等参母单元域上的标准双线性形函数定义。用 $\\bar{B} \\in \\mathbb{R}^{3 \\times 8}$ 表示通过单元上的完全积分（例如，通过具有适当权重系数的 $2 \\times 2$ 高斯求积）获得的平均应变-位移算子，使得 $\\bar{B}$ 将节点位移映射到体积平均应变向量 $\\bar{\\varepsilon} \\in \\mathbb{R}^{3}$。\n\n对刚度的体积部分使用选择性减缩积分，这可以缓解体积锁定，但在积分不足的子空间中会引入伪零能沙漏模式。为了设计一种仅惩罚沙漏模式，同时保留完全积分所能捕捉到的刚体运动和物理常应变模式的稳定化方法，请按以下步骤进行。\n\n定义刚体运动基矩阵 $R \\in \\mathbb{R}^{8 \\times 3}$，其列张成了两个平面内平移和围绕单元形心的平面内旋转。并通过 $\\bar{B}^{T} \\in \\mathbb{R}^{8 \\times 3}$ 的列定义物理应变模式基，这些列对应于在三个独立分量 $(\\varepsilon_{xx}, \\varepsilon_{yy}, \\varepsilon_{xy})$ 的每一个中引起单位平均应变的节点位移模式。构造组合的物理子空间基\n$$\nT \\in \\mathbb{R}^{8 \\times 6}, \\quad T = \\left[ R \\;\\middle|\\; \\bar{B}^{T} \\right],\n$$\n假设对于非退化单元，该基具有满列秩 $6$。\n\n从虚功原理和在配备标准欧几里得度量 $\\mathbb{R}^{8}$ 的有限维内积空间中正交投影的定义出发，推导到沙漏子空间 $H = \\left( \\mathrm{span}(T) \\right)^{\\perp}$ 的投影算子，并用它构建每个单元的稳定化能量泛函 $\\Pi_{\\mathrm{stab}}(u)$，该泛函：\n- 仅惩罚 $u$ 在沙漏子空间 $H$ 中的分量；\n- 对于物理子空间 $\\mathrm{span}(T)$ 中的任何 $u$ 均为零，确保与完全积分所捕捉的物理应变模式和刚体运动的正交性。\n\n令 $\\alpha$ 为一个控制稳定化刚度标度的严格正标量系数。用 $\\alpha$、$u$ 和 $T$ 的闭式解析项表示最终的稳定化能量泛函 $\\Pi_{\\mathrm{stab}}(u)$。不需要进行数值评估。将您的最终答案表示为单个解析表达式。不需要四舍五入，最终表达式中不应提供物理单位。", "solution": "该问题要求推导双线性四节点四边形单元的稳定化能量泛函 $\\Pi_{\\mathrm{stab}}(u)$。该泛函必须惩罚因使用选择性减缩积分而产生的非物理“沙漏”变形模式，同时不影响物理模式——即刚体运动和恒定应变状态。推导将基于节点位移向量空间中的正交投影原理。\n\n四节点单元所有可能的节点位移向量空间是欧几里得空间 $\\mathbb{R}^{8}$。问题定义了一个“物理子空间”，我们记为 $V_{\\mathrm{phys}}$，由给定矩阵 $T \\in \\mathbb{R}^{8 \\times 6}$ 的列张成。该矩阵构造为 $T = \\left[ R \\;\\middle|\\; \\bar{B}^{T} \\right]$，其中 $R \\in \\mathbb{R}^{8 \\times 3}$ 的列构成了刚体运动（两次平移和一次旋转）的基，而 $\\bar{B}^{T} \\in \\mathbb{R}^{8 \\times 3}$ 的列构成了产生恒定平均应变的位移模式的基。因此，$V_{\\mathrm{phys}} = \\mathrm{span}(T)$。如问题所述，我们假设 $T$ 是满列秩的，因此 $V_{\\mathrm{phys}}$ 的维数是 $6$。\n\n沙漏子空间，记为 $H$，被定义为物理子空间 $V_{\\mathrm{phys}}$ 在 $\\mathbb{R}^{8}$ 中关于标准欧几里得内积（点积）的正交补。在数学上，这表示为 $H = (V_{\\mathrm{phys}})^{\\perp}$。该子空间的维数是 $\\dim(\\mathbb{R}^{8}) - \\dim(V_{\\mathrm{phys}}) = 8 - 6 = 2$。\n\n任何节点位移向量 $u \\in \\mathbb{R}^{8}$ 都可以唯一地分解为两个正交分量：\n$$\nu = u_{\\mathrm{phys}} + u_{H}\n$$\n其中 $u_{\\mathrm{phys}} \\in V_{\\mathrm{phys}}$ 且 $u_{H} \\in H$。这意味着 $u_{\\mathrm{phys}}^{T} u_{H} = 0$。\n\n稳定化策略是增加一个势能项，该项仅惩罚非物理的沙漏分量 $u_H$，并且如果位移 $u$ 完全属于物理子空间 $V_{\\mathrm{phys}}$，则该项为零。为实现此目的，我们需要分离出 $u_H$。这通过使用正交投影算子来完成。\n\n令 $P_{\\mathrm{phys}}$ 是将 $\\mathbb{R}^{8}$ 中的任何向量映射到物理子空间 $V_{\\mathrm{phys}}$ 上的正交投影算子。由于 $V_{\\mathrm{phys}}$ 是矩阵 $T$ 的列空间，且 $T$ 具有满列秩，因此该投影算子的标准公式为：\n$$\nP_{\\mathrm{phys}} = T(T^T T)^{-1} T^T\n$$\n这里，$(T^T T)$ 是一个 $6 \\times 6$ 矩阵，由于 $T$ 的满列秩假设，它是可逆的。\n\n到正交补子空间 $H$ 的投影算子，我们记为 $P_H$，由下式给出：\n$$\nP_H = I - P_{\\mathrm{phys}}\n$$\n其中 $I$ 是 $8 \\times 8$ 的单位矩阵。代入 $P_{\\mathrm{phys}}$ 的表达式，我们得到：\n$$\nP_H = I - T(T^T T)^{-1} T^T\n$$\n位移向量 $u$ 的沙漏分量通过将此投影算子应用于 $u$ 来找到：\n$$\nu_H = P_H u = \\left(I - T(T^T T)^{-1} T^T\\right) u\n$$\n\n稳定化能量泛函 $\\Pi_{\\mathrm{stab}}(u)$ 应该是对该沙漏分量“大小”的一种度量。一个标准且简单的惩罚泛函选择是基于 $u_H$ 的欧几里得范数平方的二次型，并由一个稳定化参数 $\\alpha > 0$ 进行缩放。势能泛函通常写成带有 $\\frac{1}{2}$ 的前置因子：\n$$\n\\Pi_{\\mathrm{stab}}(u) = \\frac{1}{2} \\alpha \\|u_H\\|^2 = \\frac{1}{2} \\alpha u_H^T u_H\n$$\n将 $u_H = P_H u$ 代入此表达式，得到：\n$$\n\\Pi_{\\mathrm{stab}}(u) = \\frac{1}{2} \\alpha (P_H u)^T (P_H u) = \\frac{1}{2} \\alpha u^T P_H^T P_H u\n$$\n正交投影算子既是对称的（$P_H^T = P_H$）又是幂等的（$P_H^2 = P_H$）。利用这些性质，我们可以简化表达式：\n$$\n\\Pi_{\\mathrm{stab}}(u) = \\frac{1}{2} \\alpha u^T P_H P_H u = \\frac{1}{2} \\alpha u^T P_H^2 u = \\frac{1}{2} \\alpha u^T P_H u\n$$\n这种形式清楚地表明，能量是关于完整位移向量 $u$ 的二次型，由稳定化“刚度”矩阵 $\\alpha P_H$ 定义。如果 $u \\in V_{\\mathrm{phys}}$，则 $P_H u = 0$，因此 $\\Pi_{\\mathrm{stab}}(u) = 0$，满足了一个关键要求。\n\n最后，我们代入投影算子 $P_H$ 的显式表达式，以获得用给定物理量 $\\alpha$、$u$ 和 $T$ 表示的稳定化能量泛函：\n$$\n\\Pi_{\\mathrm{stab}}(u) = \\frac{1}{2} \\alpha u^T \\left(I - T(T^T T)^{-1} T^T\\right) u\n$$\n这是仅惩罚位移场沙漏分量的稳定化能量泛函的闭式解析表达式。", "answer": "$$\\boxed{\\frac{1}{2} \\alpha u^T \\left(I - T(T^T T)^{-1} T^T\\right) u}$$", "id": "3599211"}]}