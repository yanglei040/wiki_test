{"hands_on_practices": [{"introduction": "有限元方法的一个基本要求是，一个有效的单元必须能够精确地再现常数应变状态。本练习将通过一个具体算例来阐明这一核心原理[@problem_id:3606154]。我们将从一个给定的均匀应变场出发，推导出相应的线性位移场，并验证有限元公式能够准确地再现正确的常数应力场。", "problem": "考虑一个由双线性等参四边形单元组成的2x2方形单元组，用于小应变、线性弹性平面应力问题的有限元法（FEM）分析。物理域为方形区域 $[0,L] \\times [0,L]$，通过均匀网格被划分为四个相等的单元，节点坐标位于\n$$(x_i,y_i) \\in \\{0,\\tfrac{L}{2},L\\} \\times \\{0,\\tfrac{L}{2},L\\},$$\n节点编号方式为从左到右、从下到上，如下所示：\n$$\n\\text{节点 }1:(0,0),\\quad \\text{节点 }2:(\\tfrac{L}{2},0),\\quad \\text{节点 }3:(L,0),\\\\\n\\text{节点 }4:(0,\\tfrac{L}{2}),\\quad \\text{节点 }5:(\\tfrac{L}{2},\\tfrac{L}{2}),\\quad \\text{节点 }6:(L,\\tfrac{L}{2}),\\\\\n\\text{节点 }7:(0,L),\\quad \\text{节点 }8:(\\tfrac{L}{2},L),\\quad \\text{节点 }9:(L,L).\n$$\n假设为小应变运动学，其中面内应变定义为\n$$\\varepsilon_{xx}=\\frac{\\partial u}{\\partial x},\\quad \\varepsilon_{yy}=\\frac{\\partial v}{\\partial y},\\quad \\gamma_{xy}=\\frac{\\partial u}{\\partial y}+\\frac{\\partial v}{\\partial x},$$\n其中位移分量为 $u(x,y)$ 和 $v(x,y)$。在整个单元组上施加一个均匀应变状态：\n$$\\varepsilon_{xx}=\\varepsilon_0,\\quad \\varepsilon_{yy}=0,\\quad \\gamma_{xy}=0,$$\n刚体平移和旋转由约束条件 $u(0,0)=0$ 和 $v(0,0)=0$ 固定。材料是线性弹性、均匀且各向同性的，其杨氏模量为 $E$，泊松比为 $\\nu$，应力-应变关系为（平面应力关系）。\n\n任务：\n1. 从小应变运动学定义和均匀应变规定出发，推导与约束条件一致的精确位移场 $(u(x,y),v(x,y))$，然后构建这个九节点单元组的全局节点位移向量，其顺序为 $\\left[u_1, v_1, u_2, v_2, \\dots, u_9, v_9\\right]$。\n2. 利用当节点值取自精确场时，双线性等参四边形单元能精确再现全局线性位移场这一事实，推导在平面应力条件下该单元组产生的组合应力场。用 $E$、$\\nu$ 和 $\\varepsilon_0$ 的符号形式表示应力分量 $\\sigma_{xx}$、$\\sigma_{yy}$ 和 $\\tau_{xy}$。\n\n位移单位为米，应力单位为帕斯卡。最终答案必须是一个单行矩阵，包含按顺序排列的节点位移分量，后跟三个应力分量，所有分量都以闭合形式的解析表达式给出。无需四舍五入。", "solution": "用户希望我解决这个问题。我已经验证了问题，现在开始解答。\n该问题要求确定在给定均匀应变场下，有限元单元组的节点位移和由此产生的应力状态。求解过程分为两个主要部分：首先，推导精确位移场和相应的节点位移；其次，利用有限元的性质确定应力场。\n\n第1部分：精确位移场和节点位移的推导\n\n问题指定了整个域内的均匀应变状态：\n$$ \\varepsilon_{xx} = \\varepsilon_0 $$\n$$ \\varepsilon_{yy} = 0 $$\n$$ \\gamma_{xy} = 0 $$\n\n小应变运动学关系如下：\n$$ \\varepsilon_{xx} = \\frac{\\partial u}{\\partial x}, \\quad \\varepsilon_{yy} = \\frac{\\partial v}{\\partial y}, \\quad \\gamma_{xy} = \\frac{\\partial u}{\\partial y} + \\frac{\\partial v}{\\partial x} $$\n\n我们对这些关系进行积分，以求得位移场 $(u(x,y), v(x,y))$。\n由 $\\frac{\\partial u}{\\partial x} = \\varepsilon_0$，我们对 $x$ 积分得到：\n$$ u(x,y) = \\int \\varepsilon_0 \\, dx = \\varepsilon_0 x + f(y) $$\n其中 $f(y)$ 是 $y$ 的任意函数。\n\n由 $\\frac{\\partial v}{\\partial y} = 0$，我们对 $y$ 积分得到：\n$$ v(x,y) = \\int 0 \\, dy = g(x) $$\n其中 $g(x)$ 是 $x$ 的任意函数。\n\n接下来，我们使用剪切应变条件 $\\gamma_{xy} = 0$：\n$$ \\frac{\\partial u}{\\partial y} + \\frac{\\partial v}{\\partial x} = 0 $$\n代入 $u$ 和 $v$ 的表达式：\n$$ \\frac{\\partial}{\\partial y}(\\varepsilon_0 x + f(y)) + \\frac{\\partial}{\\partial x}(g(x)) = 0 $$\n$$ \\frac{df}{dy} + \\frac{dg}{dx} = 0 \\implies \\frac{df}{dy} = -\\frac{dg}{dx} $$\n由于左侧仅是 $y$ 的函数，右侧仅是 $x$ 的函数，因此它们必须都等于一个常数，我们称之为 $C_1$。\n$$ \\frac{df}{dy} = C_1 \\implies f(y) = \\int C_1 \\, dy = C_1 y + C_2 $$\n$$ \\frac{dg}{dx} = -C_1 \\implies g(x) = \\int -C_1 \\, dx = -C_1 x + C_3 $$\n此处，$C_2$ 和 $C_3$ 是积分常数。\n\n将这些函数代回，得到给定均匀应变状态下的通用位移场：\n$$ u(x,y) = \\varepsilon_0 x + C_1 y + C_2 $$\n$$ v(x,y) = -C_1 x + C_3 $$\n包含 $C_1, C_2, C_3$ 的项代表刚体运动。$(C_2, C_3)$ 是一个均匀平移，而项 $C_1 y$ 和 $-C_1 x$ 代表绕原点的小角度刚体旋转。问题指出刚体平移和旋转是固定的。给出的具体约束是 $u(0,0)=0$ 和 $v(0,0)=0$。\n应用这些约束：\n$$ u(0,0) = \\varepsilon_0(0) + C_1(0) + C_2 = 0 \\implies C_2 = 0 $$\n$$ v(0,0) = -C_1(0) + C_3 = 0 \\implies C_3 = 0 $$\n这些约束固定了刚体平移。问题的措辞暗示刚体旋转也应被抑制。旋转分量为 $\\omega_z = \\frac{1}{2}(\\frac{\\partial v}{\\partial x} - \\frac{\\partial u}{\\partial y}) = \\frac{1}{2}(-C_1 - C_1) = -C_1$。为将旋转固定为零，我们必须设置 $C_1 = 0$。\n\n因此，对应于无刚体运动的纯应变状态的精确位移场为：\n$$ u(x,y) = \\varepsilon_0 x $$\n$$ v(x,y) = 0 $$\n该场在其空间坐标上是线性的。\n\n接下来，我们在这九个节点坐标处计算该精确位移场的值，以构建全局节点位移向量。节点坐标已给出，向量按 $[u_1, v_1, u_2, v_2, \\dots, u_9, v_9]$ 顺序排列。\n\n节点 1: $(x_1,y_1) = (0,0) \\implies u_1 = \\varepsilon_0(0) = 0$, $v_1=0$\n节点 2: $(x_2,y_2) = (\\frac{L}{2},0) \\implies u_2 = \\varepsilon_0(\\frac{L}{2})$, $v_2=0$\n节点 3: $(x_3,y_3) = (L,0) \\implies u_3 = \\varepsilon_0 L$, $v_3=0$\n节点 4: $(x_4,y_4) = (0,\\frac{L}{2}) \\implies u_4 = \\varepsilon_0(0) = 0$, $v_4=0$\n节点 5: $(x_5,y_5) = (\\frac{L}{2},\\frac{L}{2}) \\implies u_5 = \\varepsilon_0(\\frac{L}{2})$, $v_5=0$\n节点 6: $(x_6,y_6) = (L,\\frac{L}{2}) \\implies u_6 = \\varepsilon_0 L$, $v_6=0$\n节点 7: $(x_7,y_7) = (0,L) \\implies u_7 = \\varepsilon_0(0) = 0$, $v_7=0$\n节点 8: $(x_8,y_8) = (\\frac{L}{2},L) \\implies u_8 = \\varepsilon_0(\\frac{L}{2})$, $v_8=0$\n节点 9: $(x_9,y_9) = (L,L) \\implies u_9 = \\varepsilon_0 L$, $v_9=0$\n\n全局节点位移向量 $\\mathbf{d}$ 是一个18分量的向量：\n$$ \\mathbf{d} = \\left[ 0, 0, \\frac{\\varepsilon_0 L}{2}, 0, \\varepsilon_0 L, 0, 0, 0, \\frac{\\varepsilon_0 L}{2}, 0, \\varepsilon_0 L, 0, 0, 0, \\frac{\\varepsilon_0 L}{2}, 0, \\varepsilon_0 L, 0 \\right]^T $$\n\n第2部分：组合应力场的推导\n\n问题陈述了双线性等参四边形单元的一个关键特性：它们能精确地再现全局线性位移场。这一特性被称为通过完备性单元组检验（patch test）。由于精确位移场 $(u(x,y) = \\varepsilon_0 x, v(x,y) = 0)$ 是线性的，因此根据精确节点位移构建的有限元近似解 $u^h(x,y), v^h(x,y)$ 将在单元组内处处与精确场相同。\n$$ u^h(x,y) = u(x,y) = \\varepsilon_0 x $$\n$$ v^h(x,y) = v(x,y) = 0 $$\n因此，根据有限元解计算出的应变是常数，且等于给定的应变：\n$$ \\varepsilon_{xx}^h = \\frac{\\partial u^h}{\\partial x} = \\varepsilon_0 $$\n$$ \\varepsilon_{yy}^h = \\frac{\\partial v^h}{\\partial y} = 0 $$\n$$ \\gamma_{xy}^h = \\frac{\\partial u^h}{\\partial y} + \\frac{\\partial v^h}{\\partial x} = 0 + 0 = 0 $$\n应力场可以通过线性弹性、各向同性材料的平面应力本构关系从应变场获得。该关系为：\n$$ \\begin{Bmatrix} \\sigma_{xx} \\\\ \\sigma_{yy} \\\\ \\tau_{xy} \\end{Bmatrix} = \\frac{E}{1-\\nu^2} \\begin{bmatrix} 1  \\nu  0 \\\\ \\nu  1  0 \\\\ 0  0  \\frac{1-\\nu}{2} \\end{bmatrix} \\begin{Bmatrix} \\varepsilon_{xx} \\\\ \\varepsilon_{yy} \\\\ \\gamma_{xy} \\end{Bmatrix} $$\n代入应变值 $\\{\\varepsilon_0, 0, 0\\}^T$：\n$$ \\begin{Bmatrix} \\sigma_{xx} \\\\ \\sigma_{yy} \\\\ \\tau_{xy} \\end{Bmatrix} = \\frac{E}{1-\\nu^2} \\begin{bmatrix} 1  \\nu  0 \\\\ \\nu  1  0 \\\\ 0  0  \\frac{1-\\nu}{2} \\end{bmatrix} \\begin{Bmatrix} \\varepsilon_0 \\\\ 0 \\\\ 0 \\end{Bmatrix} $$\n这给出了应力分量：\n$$ \\sigma_{xx} = \\frac{E}{1-\\nu^2} (1 \\cdot \\varepsilon_0 + \\nu \\cdot 0) = \\frac{E \\varepsilon_0}{1-\\nu^2} $$\n$$ \\sigma_{yy} = \\frac{E}{1-\\nu^2} (\\nu \\cdot \\varepsilon_0 + 1 \\cdot 0) = \\frac{\\nu E \\varepsilon_0}{1-\\nu^2} $$\n$$ \\tau_{xy} = \\frac{E}{1-\\nu^2} \\left( \\frac{1-\\nu}{2} \\cdot 0 \\right) = 0 $$\n由于整个单元组的应变场是均匀的，所以应力场也是均匀的。\n\n最后，我们将最终答案组合成一个单行矩阵，其中包含18个有序的节点位移分量，后跟3个应力分量 $(\\sigma_{xx}, \\sigma_{yy}, \\tau_{xy})$。", "answer": "$$ \\boxed{\\begin{pmatrix} 0  0  \\frac{\\varepsilon_0 L}{2}  0  \\varepsilon_0 L  0  0  0  \\frac{\\varepsilon_0 L}{2}  0  \\varepsilon_0 L  0  0  0  \\frac{\\varepsilon_0 L}{2}  0  \\varepsilon_0 L  0  \\frac{E \\varepsilon_0}{1-\\nu^2}  \\frac{\\nu E \\varepsilon_0}{1-\\nu^2}  0 \\end{pmatrix}} $$", "id": "3606154"}, {"introduction": "在第一个练习的基础上，本练习将深入探讨为何形函数的某些特定属性是必不可少的。我们将分析一个违反了“单位分解”属性的假设单元，并预测其在常应变测试中的表现[@problem_id:3606135]。这个思想实验对于理解保证单元可靠性的理论基础至关重要。", "problem": "考虑一个针对有限元法（FEM）的小应变、二维、线性弹性分片检验问题，该检验在一个覆盖矩形域 $\\Omega = [0,2L] \\times [0,2H]$ 的 $2 \\times 2$ 相同4节点等参四边形单元的网格上进行。设精确位移场为一个均匀应变状态，\n$$\n\\mathbf{u}(\\mathbf{x}) = \\mathbf{B}\\,\\mathbf{x}, \\quad \\text{其中 } \\mathbf{B} \\text{ 是一个常数 } 2 \\times 2 \\text{ 矩阵}, \\quad \\boldsymbol{\\varepsilon} = \\mathrm{sym}(\\nabla \\mathbf{u}) = \\mathrm{sym}(\\mathbf{B}),\n$$\n且体力为零。整个边界 $\\partial \\Omega$ 上的节点位移被指定，使得对于每个边界节点 $i$，节点值都精确满足 $\\mathbf{u}(\\mathbf{x}_i) = \\mathbf{B}\\,\\mathbf{x}_i$。\n\n对于每个单元，假设几何映射在母空间 $(\\xi,\\eta) \\in [-1,1]^2$ 上使用标准的双线性形函数，\n$$\nN_1 = \\tfrac{1}{4}(1-\\xi)(1-\\eta), \\quad N_2 = \\tfrac{1}{4}(1+\\xi)(1-\\eta), \\quad N_3 = \\tfrac{1}{4}(1+\\xi)(1+\\eta), \\quad N_4 = \\tfrac{1}{4}(1-\\xi)(1+\\eta),\n$$\n使得物理坐标被插值为 $\\mathbf{x}(\\xi,\\eta) = \\sum_{i=1}^{4} N_i(\\xi,\\eta)\\,\\mathbf{x}_i$。然而，假设位移插值通过仅使用一个气泡函数修改第一个位移形函数而违反了单位分解（PoU）性质：\n$$\n\\tilde{N}_1(\\xi,\\eta) = N_1(\\xi,\\eta) + \\beta\\,b(\\xi,\\eta), \\quad \\tilde{N}_2 = N_2, \\quad \\tilde{N}_3 = N_3, \\quad \\tilde{N}_4 = N_4,\n$$\n其中 $\\beta \\neq 0$ 是一个固定的无量纲参数，且 $b(\\xi,\\eta) = \\tfrac{1}{4}(1-\\xi^2)(1-\\eta^2)$ 在单元边界上满足 $b=0$ 但在单元内部满足 $b0$。因此，在内部 $\\sum_{i=1}^{4} \\tilde{N}_i = 1 + \\beta\\,b \\neq 1$，而在单元边界上 $\\sum_{i=1}^{4} \\tilde{N}_i = 1$。\n\n在 $2 \\times 2$ 分片的每个单元上使用上述假设的位移形函数 $\\{\\tilde{N}_i\\}$，并使用对应于均匀应变场的精确节点边界位移，下列哪项最能描述计算得到的应变场中的定性误差和分片检验的结果？\n\nA. 计算得到的应变场在整个分片上保持精确均匀，因为节点边界位移强制了精确解；分片检验通过。\n\nB. 计算得到的位移场在所有单元边界上是精确的，但每个单元的内部表现出量级为 $\\mathcal{O}(\\beta)$ 的非均匀、振荡的应变，导致非恒定的应力和不一致的节点反力；分片检验失败，且除非 $\\beta \\to 0$，否则误差不会消失。\n\nC. 由于违反 PoU 性质，仅失去了刚体运动的再现能力，但均匀应变的再现能力保持精确；分片检验通过。\n\nD. 该修改引入了一个零能沙漏模式，它会消除刚度，导致在整个分片上产生恒等于零的应力，而与施加的均匀应变无关。\n\nE. 由于违反 PoU 性质，会诱导出一个人为的恒定体力，使得边界反力保持正确并且均匀应变得以再现；分片检验通过。", "solution": "用户希望我扮演一位STEM教授，解决一个与有限元法（FEM）相关的问题，特别是分片检验。\n\n这是我的计划：\n1.  **验证问题陈述**：我将仔细检查问题的科学合理性、完整性和清晰度。\n    *   **提取已知条件**：\n        *   问题类型：小应变、二维、线性弹性分片检验。\n        *   网格：$2 \\times 2$ 的相同4节点等参四边形单元网格。\n        *   域：$\\Omega = [0, 2L] \\times [0, 2H]$。\n        *   精确位移场：$\\mathbf{u}(\\mathbf{x}) = \\mathbf{B}\\,\\mathbf{x}$，其中 $\\mathbf{B}$ 是一个常数 $2 \\times 2$ 矩阵。这对应于一个恒定的应变场 $\\boldsymbol{\\varepsilon} = \\mathrm{sym}(\\mathbf{B})$。\n        *   体力：零。\n        *   边界条件：$\\partial\\Omega$ 上的节点位移被指定为 $\\mathbf{u}(\\mathbf{x}_i) = \\mathbf{B}\\,\\mathbf{x}_i$，对边界节点 $i$ 成立。\n        *   几何插值：使用标准双线性形函数 $N_i$，因此 $\\mathbf{x}(\\xi,\\eta) = \\sum_{i=1}^{4} N_i(\\xi,\\eta)\\,\\mathbf{x}_i$。此映射是等参的。\n        *   位移插值：使用修改后的形函数 $\\{\\tilde{N}_i\\}$。\n            *   $\\tilde{N}_1(\\xi,\\eta) = N_1(\\xi,\\eta) + \\beta\\,b(\\xi,\\eta)$\n            *   $\\tilde{N}_2 = N_2$, $\\tilde{N}_3 = N_3$, $\\tilde{N}_4 = N_4$\n            *   $\\beta \\neq 0$ 是一个常数。\n            *   $b(\\xi,\\eta) = \\tfrac{1}{4}(1-\\xi^2)(1-\\eta^2)$ 是一个气泡函数。\n        *   修改后形函数的关键性质：$\\sum_{i=1}^{4} \\tilde{N}_i = 1 + \\beta\\,b(\\xi,\\eta)$。这在单元内部违反了单位分解（PoU）性质。在单元边界上（$\\xi=\\pm1$ 或 $\\eta=\\pm1$），$b=0$，因此 $\\sum \\tilde{N}_i = 1$。\n        *   问题：哪个陈述最能描述计算得到的应变场的定性误差和分片检验的结果？\n\n    *   **验证检查**：\n        *   **科学上是否成立？**：是的，问题设定在FEM和计算力学的既定框架内。分片检验是标准的验证程序。形函数、等参映射、单位分解和线性弹性的概念都是标准的。\n        *   **是否适定？**：是的，设定很清晰。问题要求一个特定数值实验的结果。条件已定义，预期会有唯一的结果。\n        *   **是否客观？**：是的，语言是精确和技术性的。没有主观因素。\n        *   **缺陷检查表**：\n            1.  **科学/事实不健全？**：否。问题描述了一个假设的（且不正确的）单元格式，但这是一个有效的“如果……会怎样”的情景，用以测试对FEM原理的理解。它不违反基本物理定律，而是探讨违反形函数理想性质的后果。\n            2.  **非形式化/不相关？**：否。问题直接关于有限元验证的分片检验，这是计算力学的核心主题。它是完全可以形式化的。\n            3.  **不完整/矛盾？**：否。设定看起来是完整的。我们有域、网格、单元类型、精确解、边界条件和对形函数的具体修改。\n            4.  **不切实际/不可行？**：否。虽然在实践中使用这样的形函数是个坏主意，但它是一个有效的理论练习。\n            5.  **不适定/结构不良？**：否。术语定义明确。\n            6.  **伪深刻/琐碎？**：否。这个问题测试一个基本概念：单位分解性质在单元再现恒定应变状态能力中的作用。其被违反的后果并非一目了然。\n            7.  **超出科学可验证性？**：否。结果可以通过数学推导出来。\n\n    *   **结论**：问题是**有效的**。我可以继续进行求解。\n\n2.  **解决问题**：\n    *   **核心概念**：如果对于一个任意的单元分片，当其边界条件对应于一个恒定应变状态时，有限元解能在整个分片上**精确**再现该恒定应变状态，则该分片检验通过。\n    *   **通过分片检验的关键要求**：为了使一个单元格式通过分片检验，它必须能够精确表示任何线性位移场 $\\mathbf{u}(x,y) = \\mathbf{a} + \\mathbf{B}\\mathbf{x}$。这是因为这样的场对应于一个恒定应变状态。\n    *   **让我们分析一个单元内的位移场。** 有限元位移场 $\\mathbf{u}^h$ 是通过使用修改后的形函数 $\\tilde{N}_i$ 从节点位移 $\\mathbf{d}_i$ 插值得到的：\n        $$ \\mathbf{u}^h(\\xi, \\eta) = \\sum_{i=1}^4 \\tilde{N}_i(\\xi, \\eta) \\mathbf{d}_i $$\n    *   问题陈述边界条件是精确的。对于分片的内部节点，节点位移是未知的，通过FEM系统 $K\\mathbf{d} = \\mathbf{f}$ 求解。由于体力为零，力向量 $\\mathbf{f}$ 仅来自指定的面力，这里隐式地为零，因为位移在边界各处都被指定。未知内部节点位移的系统方程右侧是由已知边界位移的刚度贡献决定的。\n    *   形函数表示恒定状态的一个关键性质是单位分解（PoU）：$\\sum N_i = 1$。这是再现刚体运动所必需的。\n    *   表示线性场（从而表示恒定应变）的一个关键性质是形函数必须能够再现坐标的线性函数。也就是说，对于任何线性函数 $p(\\mathbf{x}) = a_0 + a_1 x + a_2 y$，我们必须有 $\\sum_{i=1}^n N_i(\\mathbf{x}) p(\\mathbf{x}_i) = p(\\mathbf{x})$。这被称为一阶一致性。对于使用满足PoU性质的标准形函数的等参单元，此性质成立。\n    *   让我们看看修改后的形函数 $\\tilde{N}_i$ 会发生什么。\n    *   精确位移场是 $\\mathbf{u}(\\mathbf{x}) = \\mathbf{B}\\mathbf{x}$。让我们用分量来写 $\\mathbf{B}$ 和 $\\mathbf{x}$：\n        $$ \\mathbf{x} = \\begin{pmatrix} x \\\\ y \\end{pmatrix}, \\quad \\mathbf{B} = \\begin{pmatrix} B_{11}  B_{12} \\\\ B_{21}  B_{22} \\end{pmatrix} $$\n        所以，精确位移的分量是：\n        $$ u(x,y) = B_{11}x + B_{12}y $$\n        $$ v(x,y) = B_{21}x + B_{22}y $$\n        这些是坐标的线性函数。\n    *   内部节点位移的有限元解将满足全局方程组。如果有限元解再现了精确解，那么所有地方（内部和边界）的节点位移都将是 $\\mathbf{d}_i = \\mathbf{u}(\\mathbf{x}_i) = \\mathbf{B}\\mathbf{x}_i$。\n    *   让我们假设这是真的，看看一个单元内得到的位移场 $\\mathbf{u}^h$ 是否正确。\n        $$ \\mathbf{u}^h(\\xi, \\eta) = \\sum_{i=1}^4 \\tilde{N}_i(\\xi, \\eta) \\mathbf{d}_i = \\sum_{i=1}^4 \\tilde{N}_i(\\xi, \\eta) (\\mathbf{B}\\mathbf{x}_i) $$\n        $$ \\mathbf{u}^h(\\xi, \\eta) = \\mathbf{B} \\left( \\sum_{i=1}^4 \\tilde{N}_i(\\xi, \\eta) \\mathbf{x}_i \\right) $$\n    *   几何是使用标准形函数插值的：$\\mathbf{x}(\\xi, \\eta) = \\sum_{i=1}^4 N_i(\\xi, \\eta) \\mathbf{x}_i$。\n    *   代入 $\\tilde{N}_i$ 的定义：\n        $$ \\sum_{i=1}^4 \\tilde{N}_i \\mathbf{x}_i = (\\tilde{N}_1 \\mathbf{x}_1 + \\tilde{N}_2 \\mathbf{x}_2 + \\tilde{N}_3 \\mathbf{x}_3 + \\tilde{N}_4 \\mathbf{x}_4) $$\n        $$ = (N_1 + \\beta b) \\mathbf{x}_1 + N_2 \\mathbf{x}_2 + N_3 \\mathbf{x}_3 + N_4 \\mathbf{x}_4 $$\n        $$ = \\left( \\sum_{i=1}^4 N_i \\mathbf{x}_i \\right) + \\beta b(\\xi, \\eta) \\mathbf{x}_1 $$\n        $$ = \\mathbf{x}(\\xi, \\eta) + \\beta b(\\xi, \\eta) \\mathbf{x}_1 $$\n    *   所以，插值位移场是：\n        $$ \\mathbf{u}^h(\\xi, \\eta) = \\mathbf{B} \\left( \\mathbf{x}(\\xi, \\eta) + \\beta b(\\xi, \\eta) \\mathbf{x}_1 \\right) = \\mathbf{u}(\\mathbf{x}(\\xi, \\eta)) + \\beta b(\\xi, \\eta) \\mathbf{B} \\mathbf{x}_1 $$\n    *   这表明插值位移场 $\\mathbf{u}^h$ 不是精确场 $\\mathbf{u}(\\mathbf{x})$。存在一个误差项：$\\mathbf{e}_{\\mathbf{u}} = \\mathbf{u}^h - \\mathbf{u} = \\beta b(\\xi, \\eta) \\mathbf{B} \\mathbf{x}_1$。\n    *   即使我们使用精确的节点位移，单元内的插值解也无法再现精确解，因此该格式不能通过分片检验。有限元解将在内部节点产生精确节点位移的假设可能是错误的。系统将求解到一个使势能最小化的状态，而该状态将*不*对应于精确解。\n    *   让我们更直接地分析这些性质。要通过分片检验，单元必须能够精确再现一个恒定应变状态。这需要能够再现一个线性位移场。\n        设 $u(x,y) = c_0 + c_1 x + c_2 y$ 是一个任意线性场。\n        插值场为 $u^h(\\xi, \\eta) = \\sum_{i=1}^4 \\tilde{N}_i(\\xi, \\eta) u(\\mathbf{x}_i)$。\n        我们需要 $u^h(\\mathbf{x}(\\xi, \\eta)) = u(\\mathbf{x}(\\xi, \\eta))$。\n        让我们代入 $\\tilde{N}_i$ 和 $u(\\mathbf{x}_i)$：\n        $$ u^h = (N_1 + \\beta b) (c_0 + c_1 x_1 + c_2 y_1) + \\sum_{i=2}^4 N_i (c_0 + c_1 x_i + c_2 y_i) $$\n        $$ u^h = \\sum_{i=1}^4 N_i (c_0 + c_1 x_i + c_2 y_i) + \\beta b (c_0 + c_1 x_1 + c_2 y_1) $$\n    *   标准双线性形函数 $N_i$ 满足线性场的一致性条件，因为它们是单位分解且几何也用它们插值（等参）。所以，$\\sum N_i (c_0 + c_1 x_i + c_2 y_i) = c_0 (\\sum N_i) + c_1 (\\sum N_i x_i) + c_2 (\\sum N_i y_i)$。由于 $\\sum N_i=1$ 且 $\\mathbf{x} = \\sum N_i \\mathbf{x}_i$，此项就是 $c_0 + c_1 x + c_2 y = u(x,y)$。\n    *   因此，插值场为：\n        $$ u^h(x,y) = u(x,y) + \\beta b(\\xi(x,y), \\eta(x,y)) (c_0 + c_1 x_1 + c_2 y_1) $$\n    *   插值场 $u^h$ 不等于精确线性场 $u$，因为存在一个附加项，它与 $\\beta$ 和气泡函数 $b$ 成正比。由于在内部 $b \\neq 0$，线性场没有被再现。\n    *   由于单元不能再现任意线性位移场，它不能再现分片检验所要求的恒定应变状态。因此，分片检验失败。\n\n    *   现在让我们计算应变场。应变为 $\\boldsymbol{\\varepsilon}^h = \\mathrm{sym}(\\nabla \\mathbf{u}^h)$。\n        $$ \\mathbf{u}^h(\\mathbf{x}) = \\mathbf{u}(\\mathbf{x}) + \\beta b(\\xi(\\mathbf{x}), \\eta(\\mathbf{x})) \\mathbf{B} \\mathbf{x}_1 $$\n        应变误差为 $\\mathbf{e}_{\\boldsymbol{\\varepsilon}} = \\boldsymbol{\\varepsilon}^h - \\boldsymbol{\\varepsilon} = \\mathrm{sym}(\\nabla (\\beta b \\mathbf{B} \\mathbf{x}_1))$。\n        项 $\\mathbf{B}\\mathbf{x}_1$ 是一个常数向量。我们称之为 $\\mathbf{c} = \\begin{pmatrix} c_x \\\\ c_y \\end{pmatrix}$。\n        位移误差为 $\\mathbf{e}_{\\mathbf{u}}(\\mathbf{x}) = \\beta b(\\xi(\\mathbf{x}), \\eta(\\mathbf{x})) \\mathbf{c}$。\n        位移误差的梯度为 $\\nabla \\mathbf{e}_{\\mathbf{u}} = \\beta (\\nabla b) \\otimes \\mathbf{c}$。\n        应变误差为：\n        $$ \\mathbf{e}_{\\boldsymbol{\\varepsilon}} = \\beta \\, \\mathrm{sym} \\left( (\\nabla b) \\otimes \\mathbf{c} \\right) = \\frac{\\beta}{2} \\left[ (\\nabla b) \\otimes \\mathbf{c} + \\mathbf{c} \\otimes (\\nabla b) \\right] $$\n        用分量形式表示：\n        $$ \\nabla b = \\begin{pmatrix} \\partial b / \\partial x \\\\ \\partial b / \\partial y \\end{pmatrix} $$\n        $$ (\\nabla b) \\otimes \\mathbf{c} = \\begin{pmatrix} \\frac{\\partial b}{\\partial x} c_x  \\frac{\\partial b}{\\partial x} c_y \\\\ \\frac{\\partial b}{\\partial y} c_x  \\frac{\\partial b}{\\partial y} c_y \\end{pmatrix} $$\n        $$ \\mathbf{e}_{\\boldsymbol{\\varepsilon}} = \\beta \\begin{pmatrix} \\frac{\\partial b}{\\partial x} c_x  \\frac{1}{2}\\left(\\frac{\\partial b}{\\partial x} c_y + \\frac{\\partial b}{\\partial y} c_x\\right) \\\\ \\frac{1}{2}\\left(\\frac{\\partial b}{\\partial x} c_y + \\frac{\\partial b}{\\partial y} c_x\\right)  \\frac{\\partial b}{\\partial y} c_y \\end{pmatrix} $$\n    *   气泡函数的梯度 $\\nabla b$ 在单元内通常是非零且非恒定的。气泡函数 $b(\\xi, \\eta) = \\frac{1}{4}(1-\\xi^2)(1-\\eta^2)$ 是 $\\xi, \\eta$ 的多项式。它关于 $x, y$ 的梯度涉及到映射 $\\mathbf{x} \\to (\\xi, \\eta)$ 的雅可比矩阵，该矩阵通常是位置的函数。\n        $$ \\begin{pmatrix} \\partial b / \\partial x \\\\ \\partial b / \\partial y \\end{pmatrix} = \\mathbf{J}^{-T} \\begin{pmatrix} \\partial b / \\partial \\xi \\\\ \\partial b / \\partial \\eta \\end{pmatrix} $$\n        其中 $\\mathbf{J}$ 是坐标映射 $\\mathbf{x}(\\xi, \\eta)$ 的雅可比矩阵。对于一般的四边形，$\\mathbf{J}$ 不是常数。\n    *   由于 $\\nabla b$ 不是常数，应变误差 $\\mathbf{e}_{\\boldsymbol{\\varepsilon}}$ 在单元内不是常数。这意味着计算得到的应变场 $\\boldsymbol{\\varepsilon}^h = \\boldsymbol{\\varepsilon} + \\mathbf{e}_{\\boldsymbol{\\varepsilon}}$ 是不均匀的，并包含虚假的、非物理的变化。该误差的量级为 $\\mathcal{O}(\\beta)$。\n    *   气泡函数 $b$ 及其导数本质上是振荡的（例如，$\\partial b / \\partial \\xi = -\\frac{1}{2}\\xi(1-\\eta^2)$）。这意味着应变误差将是振荡的。\n    *   因为对形函数的修改是一个气泡函数，所以在单元边界上（$\\xi=\\pm1$ 或 $\\eta=\\pm1$），$\\tilde{N_i} = N_i$。这意味着沿任何单元边界，位移插值与标准插值相同。\n        $$ \\mathbf{u}^h |_{\\partial E} = \\sum_{i \\in \\partial E} \\tilde{N}_i \\mathbf{d}_i = \\sum_{i \\in \\partial E} N_i \\mathbf{d}_i $$\n    *   问题陈述整个分片的边界节点具有指定的位移。内部节点的位移是通过求解得到的。让我们考虑两个相邻的单元。它们共享一个公共边界（一条边和两个节点）。共享节点处的位移必须相同（协调性）。沿着共享边，从一个单元计算的位移场是 $\\mathbf{u}^h_1 = \\sum N_i \\mathbf{d}_i$（因为在那里 $b=0$），而从另一个单元计算的是 $\\mathbf{u}^h_2 = \\sum N_j \\mathbf{d}_j$。由于节点位移相同，位移场在单元边界上是连续的。所以，$\\mathbf{u}^h$ 是 $C^0$ 连续的。\n    *   最终的解 $\\mathbf{u}^h$ 将使势能 $\\Pi(\\mathbf{v}) = \\frac{1}{2} \\int_\\Omega \\boldsymbol{\\varepsilon}(\\mathbf{v}):\\mathbf{C}:\\boldsymbol{\\varepsilon}(\\mathbf{v}) \\, d\\Omega$ 在满足边界条件的容许函数空间上最小化。有限元解 $\\mathbf{u}^h$ 属于由形函数 $\\{\\tilde{N}_i\\}$ 决定的函数空间。这个空间*不*包含精确解 $\\mathbf{u}(\\mathbf{x}) = \\mathbf{B}\\mathbf{x}$（正如我们前面所示）。因此，最小化子 $\\mathbf{u}^h$ 将不同于 $\\mathbf{u}$。\n    *   让我们检查单元边界上的位移场。形函数 $\\tilde{N}_i$ 在单元边界上等于 $N_i$。这意味着，如果我们给定单个单元四个节点的精确节点位移 $\\mathbf{d}_i = \\mathbf{B}\\mathbf{x}_i$，该单元*边界上*的位移将是完全正确的：\n        在一条边上，比如说 $\\eta = -1$，位移仅使用节点1和2进行插值。\n        $\\mathbf{u}^h(\\xi, -1) = \\tilde{N}_1(\\xi, -1)\\mathbf{d}_1 + \\tilde{N}_2(\\xi, -1)\\mathbf{d}_2 = N_1(\\xi,-1)\\mathbf{d}_1 + N_2(\\xi,-1)\\mathbf{d}_2$。\n        $N_1(\\xi,-1) = \\frac{1}{2}(1-\\xi)$, $N_2(\\xi,-1) = \\frac{1}{2}(1+\\xi)$。这是一个线性插值。\n        由于几何也在这条边上是线性插值的，所以位移是边上的精确线性函数。由于精确解也是线性的，如果节点值是正确的，单元边界上的位移场将被正确表示。\n    *   由于位移在单元边界上是连续的，并且我们在外边界 $\\partial\\Omega$ 上指定了精确值，那么如果内部节点位移也恰好是精确值，则解在分片中所有单元的边界上都将具有精确的位移。\n    *   内部节点位移会是精确的吗？刚度矩阵由在单元上对 $\\mathbf{B}^T \\mathbf{C} \\mathbf{B}$ 的积分构建，其中 $\\mathbf{B}$ 是从形函数 $\\tilde{N}_i$ 导出的应变-位移矩阵。由于 $\\tilde{N}_i$ 是‘错误’的，单元刚度矩阵 $\\mathbf{k}^e$ 将不同于标准刚度矩阵。组装的全局刚度矩阵 $\\mathbf{K}$ 也将不同。\n    *   对于内部节点，平衡方程是 $\\mathbf{K}_{II}\\mathbf{d}_I = -\\mathbf{K}_{IB}\\mathbf{d}_B$，其中 $I$ 表示内部节点，$B$ 表示边界节点。我们已知 $\\mathbf{d}_B$。\n    *   如果使用通过分片检验的标准单元，则内部节点的解将恰好是 $\\mathbf{d}_I = \\mathbf{B}\\mathbf{x}_I$。这是因为内力将平衡为零。这是该格式一致性的结果。\n    *   对于修改后的单元，一致性丧失了。内部节点 $j$ 上的力向量是 $F_j = \\sum_e (\\int_e B_j^T C \\varepsilon dV)$。当代入精确线性位移场时，该积分不再为零。这意味着存在虚假的内部节点力，平衡方程将不被精确的节点位移所满足。因此，计算得到的内部节点位移将是不正确的，$\\mathbf{d}_I \\neq \\mathbf{B}\\mathbf{x}_I$。\n    *   然而，问题说“计算得到的位移场在所有单元边界上是精确的”。让我们重新考虑这一点。位移是由每个单元上的形函数描述的。所以 $\\mathbf{u}|_{\\text{edge}} = \\sum_{nodes \\in \\text{edge}} N_i|_{\\text{edge}} \\mathbf{d}_i$。沿一条边的位移完全由该边上的节点的位移决定。对于分片边界上的一条边，节点位移是精确指定的。所以在 $\\partial \\Omega$ 上，位移场是精确的。对于一条内部边，位移是在两个节点之间插值的，例如节点 $i$ 和 $j$。沿边的位移是 $\\mathbf{u}_{ij}(s) = N_i(s)\\mathbf{d}_i + N_j(s)\\mathbf{d}_j$。要使这位移“精确”，我们需要求解出的节点位移 $\\mathbf{d}_i$ 和 $\\mathbf{d}_j$ 精确等于 $\\mathbf{B}\\mathbf{x}_i$ 和 $\\mathbf{B}\\mathbf{x}_j$。如前所述，这不是必然的。违反PoU性质引入了虚假的刚度特性，导致内部节点位移的解不正确。因此，沿*内部*单元边界的位移场将*不*是精确的。这使得选项B的前提值得怀疑。\n    *   然而，让我们与其他选项比较。\n    *   A：“分片检验通过。”这是错误的。我们已经证明恒定应变状态没有被再现。\n    *   C：“只有刚体运动的再现能力因违反PoU而丧失……但均匀应变的再现保持精确……分片检验通过。”这是错误的。违反PoU（$\\sum \\tilde{N}_i \\neq 1$）意味着单元甚至不能正确表示恒定位移场（刚体平移）。$\\mathbf{u}^h = \\sum \\tilde{N}_i \\mathbf{u}_0 = (\\sum N_i + \\beta b \\delta_{i1}) \\mathbf{u}_0 = (1 + \\beta b (\\text{if i=1})) \\mathbf{u}_0 \\neq \\mathbf{u}_0$。等等，让我们更精确一点。\n        $u^h = \\sum_{i=1}^4 \\tilde{N}_i u_i$。如果我们对所有 $i=1..4$ 设 $u_i = c$，我们得到\n        $u^h = \\tilde{N}_1 c + \\tilde{N}_2 c + \\tilde{N}_3 c + \\tilde{N}_4 c = (\\sum \\tilde{N}_i) c = (1 + \\beta b) c \\neq c$。\n        所以刚体运动没有被再现。该选项说RBM再现能力丧失，这是正确的。但它接着说“均匀应变的再现保持精确”，我们已经证明这是错误的。因此，C不正确。\n    *   D：“……引入了一个零能沙漏模式，它会消除刚度，产生恒等于零的应力……”。零能模式是一个非零节点位移向量 $\\mathbf{d}$，使得应变能 $\\frac{1}{2} \\mathbf{d}^T \\mathbf{k}^e \\mathbf{d} = 0$。这对应于一个产生零应变（至少在积分点处）的非零变形。气泡函数 $b$ 已知与减缩积分单元中的沙漏控制有关。然而，这里它被添加到一个形函数上，而不是用来定义一个额外的模式。将其添加到 $N_1$ 会使单元格式不一致。它不一定会创建一个新的零能模式。实际上，它更可能导致虚假刚度（闭锁）或只是一般的误差。声称“恒等于零的应力”是极端的，并且不太可能。边界条件指定了非零的应变状态，所以我们期望非零的应力。一个总是产生零应力的单元将是无用的。这是不正确的。\n    *   E：“由于违反PoU，会诱导出一个人为的恒定体力……分片检验通过”。分片检验失败。而且，我们导出的应变误差项 $\\mathbf{e}_{\\boldsymbol{\\varepsilon}}$ 不是常数，所以从它导出的任何等效节点力都不会等效于一个*恒定*体力。此选项不正确。\n    *   这使得B成为最合理的选项，尽管其“位移场在所有单元边界上是精确的”这一说法可能不精确。让我们再次审视这句话。它说的是*计算的*位移场。计算的场是最终的FEM解 $\\mathbf{u}^h$，它满足全局方程组。如前所述，内部节点位移 $\\mathbf{d}_I$ 将是不正确的，即 $\\mathbf{d}_I \\ne \\mathbf{B}\\mathbf{x}_I$。因此，沿内部边的位移，依赖于这些不正确的节点值，将不是精确的。所以，陈述B的那部分是严格不正确的。\n    *   然而，陈述B的其余部分非常准确：\n        *   “……但每个单元的内部表现出量级为 $\\mathcal{O}(\\beta)$ 的非均匀、振荡的应变……”：这正是我们推导出来的。应变误差 $\\mathbf{e}_{\\boldsymbol{\\varepsilon}} \\propto \\beta \\nabla b$，并且 $\\nabla b$ 是非恒定且振荡的。\n        *   “……导致非恒定的应力和不一致的节点反力……”：由于应力与应变成正比（$\\boldsymbol{\\sigma}=\\mathbf{C}\\boldsymbol{\\varepsilon}$），非均匀应变意味着非均匀应力。\n        *   “……和不一致的节点反力……”：这有点模糊，但未通过分片检验意味着平衡在逐点意义上不满足，并且计算的节点力（反力）将与精确的恒定应力场不一致。对于一个内部节点，来自相邻单元的力之和应为零。如果FEM解给出精确的节点位移，计算出的节点力将是非零的（存在残差），意味着系统不处于平衡状态。求解器找到一个不同的位移场以在弱形式下强制平衡，导致不正确的节点位移和应力。\n        *   “……分片检验失败，且除非 $\\beta \\to 0$，否则误差不会消失。”：这是核心结论，并且是正确的。误差项与 $\\beta$ 成正比。\n\n    *   所以，选项B包含一个严格不正确的子句（“位移场在所有单元边界上是精确的”），但其对物理后果的其余描述是完全正确的。其他选项（A、C、D、E）在关于分片检验的结果或误差性质方面从根本上是错误的。在多项选择题中，人们常常必须选择“最佳”描述，即使它有微小的瑕疵。\n    *   让我们重新考虑那个有问题的短语。在某种解释下它可能是正确的吗？也许这是一种简化。在单元边界上，插值的*形式*是正确的（标准的线性/双线性），因为 $\\tilde{N}_i=N_i$。所以，位移是 $C^0$ 连续的。沿内部边的位移误差*仅*来自求解出的节点位移的误差，而不是来自沿该边的错误插值公式。这与单元*内部*形成对比，那里的插值公式本身就是错误的。也许这就是该选项试图作出的区分？这是一个薄弱的辩护，但有可能。\n    *   让我们再次构建主要论点。通过分片检验所需的基本性质是（1）再现刚体模式，和（2）再现恒定应变状态。\n    *   （1）刚体运动：设 $\\mathbf{u}(\\mathbf{x}) = \\mathbf{u}_0$（常数）。节点位移均为 $\\mathbf{u}_0$。插值位移为 $\\mathbf{u}^h = \\sum \\tilde{N}_i \\mathbf{u}_0 = (\\sum \\tilde{N}_i) \\mathbf{u}_0 = (1 + \\beta b) \\mathbf{u}_0 \\neq \\mathbf{u}_0$。所以RBM没有被再现。这是由于违反了PoU。\n    *   （2）恒定应变状态：设 $\\mathbf{u}(\\mathbf{x}) = \\mathbf{B}\\mathbf{x}$。节点位移为 $\\mathbf{d}_i = \\mathbf{B}\\mathbf{x}_i$。插值位移为 $\\mathbf{u}^h = \\sum \\tilde{N}_i (\\mathbf{B}\\mathbf{x}_i) = \\mathbf{B} (\\sum \\tilde{N}_i \\mathbf{x}_i)$。\n        $\\sum \\tilde{N}_i \\mathbf{x}_i = (N_1+\\beta b)\\mathbf{x}_1 + N_2\\mathbf{x}_2 + N_3\\mathbf{x}_3 + N_4\\mathbf{x}_4 = (\\sum N_i \\mathbf{x}_i) + \\beta b \\mathbf{x}_1 = \\mathbf{x}(\\xi, \\eta) + \\beta b \\mathbf{x}_1$。\n        所以 $\\mathbf{u}^h(\\mathbf{x}) = \\mathbf{B}(\\mathbf{x} + \\beta b \\mathbf{x}_1) = \\mathbf{u}(\\mathbf{x}) + \\beta b \\mathbf{B}\\mathbf{x}_1$。\n        插值场不是精确的线性场。误差取决于气泡函数 $b$。\n    *   为了得到应变，我们对 $\\mathbf{u}^h$ 求导。应变为 $\\boldsymbol{\\varepsilon}^h = \\mathrm{sym}(\\nabla\\mathbf{u}^h) = \\mathrm{sym}(\\mathbf{B}) + \\mathrm{sym}(\\nabla(\\beta b \\mathbf{B}\\mathbf{x}_1))$。\n    *   精确应变为 $\\boldsymbol{\\varepsilon} = \\mathrm{sym}(\\mathbf{B})$，是常数。计算的应变有一个附加的非恒定项，它取决于气泡函数的梯度 $\\nabla b$。\n    *   因此，计算的应变场*不是*均匀的。它将在每个单元内变化。这意味着分片检验失败。\n\n    *   现在让我们带着这个坚定的结论重新审视这些选项。\n    *   **A**：失败。说分片检验通过。\n    *   **B**：“计算的位移场在所有单元边界上是精确的”。这是不确定的部分。“……但每个单元的内部表现出量级为 $\\mathcal{O}(\\beta)$ 的非均匀、振荡的应变……”。这是正确的。“……导致非恒定的应力和不一致的节点反力……”。正确。“……分片检验失败，且除非 $\\beta \\to 0$，否则误差不会消失。” 正确。\n    *   **C**：失败。说均匀应变的再现是精确的，且分片检验通过。\n    *   **D**：失败。声称零应力是错误的。\n    *   **E**：失败。说分片检验通过。\n\n    *   所以，选项A、C、D和E作出了根本上不正确的断言。选项B正确地指出了分片检验的失败，并正确地描述了应变/应力场中误差的性质。它唯一的缺陷是关于单元边界上位移场的初始子句。\n    *   为什么会包含那个子句？也许它是一个干扰项，或者它基于一个轻微的误解。如所讨论的，边界上的插值*方案*是标准的，但它插值的*值*（内部节点位移）是错误的。所以最终的场是错误的。很可能出题人混淆了“边界上的插值是标准的”和“边界上得到的场是精确的”。鉴于选项B的每一其他部分都是正确的，而所有其他选项都从根本上是错误的，B必须是预期的答案。在一个要求“最佳描述”的问题的背景下，B比其他选项好得多。\n    *   让我们再检查一次逻辑。违反单位分解性质，即 $\\sum \\tilde{N}_i \\neq 1$，是根本原因。这一违反立即意味着恒定场（刚体平移）不能被再现。如果一个恒定场不能被再现，一个线性场（恒定应变）通常也不能。我们的直接检查证实了这一点。在线性场的再现中的误差项 $\\beta b(\\xi,\\eta) \\mathbf{u}(\\mathbf{x}_1)$ 导致了一个与 $\\beta \\nabla b$ 成正比的非恒定应变误差。这个误差在单元内部是非零的，但函数 $b$ 在单元边界上是零。应变误差涉及 $b$ 的梯度。$b$ 的梯度在边界上不一定为零（例如，在远离角点的边 $\\xi=\\pm 1$ 上，$\\partial b/\\partial\\xi = -\\frac{1}{2}\\xi(1-\\eta^2)$ 非零）。所以应变甚至可能在单元边界上不连续，因为气泡函数的梯度在两侧是不同的（取决于哪个节点获得气泡，对所有单元都是节点1）。让我们检查一下。问题说“相同的，4节点……单元”。所以每个单元都使用相同的局部节点编号和相同的修改形函数 $\\tilde{N}_1$。整个网格的全局节点1只与一个单元相关联。但对于其他单元，它们的局部节点1将是不同的全局节点。这使连续性的分析复杂化，但每个单元内的核心结论保持不变：应变不是恒定的。\n    *   核心点仍然是：单元是不一致的。它不能再现一个线性位移场。因此，它未通过分片检验。应变场将被虚假的、非恒定的项污染。选项B完美地捕捉到了这一本质。一个子句的不准确性与其他选项中的根本错误相比，是一个小瑕疵。\n\n    *   选项B评估总结：\n        *   “计算的位移场在所有单元边界上是精确的”：对于内部边界是不正确的。\n        *   “但每个单元的内部表现出量级为 $\\mathcal{O}(\\beta)$ 的非均匀、振荡的应变”：正确。\n        *   “导致非恒定的应力和不一致的节点反力”：正确。\n        *   “分片检验失败，且除非 $\\beta \\to 0$，否则误差不会消失”：正确。\n    *   鉴于提示要求找到“最佳”描述，B是明确的选择。\n\n我已验证问题陈述，并发现它是一个有效、适定的计算力学问题。我现在将进行解答。\n\n所测试的基本原理是分片检验，这是有限元格式收敛的必要条件。如果对于任意一个单元分片，当其边界上施加了对应的线性位移场时，有限元解能够精确地再现任意恒定的应变状态，那么该单元就通过了分片检验。\n\n首先，我们来分析所提出的位移形函数 $\\{\\tilde{N}_i\\}$ 的性质。这些形函数的和为：\n$$\n\\sum_{i=1}^{4} \\tilde{N}_i(\\xi,\\eta) = \\tilde{N}_1 + N_2 + N_3 + N_4 = (N_1 + \\beta b) + N_2 + N_3 + N_4 = \\left(\\sum_{i=1}^{4} N_i\\right) + \\beta b(\\xi,\\eta)\n$$\n标准双线性形函数满足单位分解（PoU）性质，即 $\\sum_{i=1}^{4} N_i = 1$。因此，对于修改后的形函数：\n$$\n\\sum_{i=1}^{4} \\tilde{N}_i(\\xi,\\eta) = 1 + \\beta b(\\xi,\\eta)\n$$\n由于在单元内部 $\\beta \\neq 0$ 且气泡函数 $b(\\xi,\\eta)  0$，所以单位分解性质被违反了。这一违反会立即产生后果。例如，该单元无法精确再现刚体平移。如果我们将所有节点位移设置为一个恒定向量 $\\mathbf{u}_0$，则插值得到的位移是：\n$$\n\\mathbf{u}^h = \\sum_{i=1}^{4} \\tilde{N}_i \\mathbf{u}_0 = \\left(\\sum_{i=1}^{4} \\tilde{N}_i\\right) \\mathbf{u}_0 = (1 + \\beta b) \\mathbf{u}_0 \\neq \\mathbf{u}_0\n$$\n由于再现刚体运动是通过分片检验的必要条件，我们已经可以断定该单元会失败。然而，让我们研究一下恒定应变状态的具体情况。\n\n分片检验要求精确再现线性位移场，即 $\\mathbf{u}(\\mathbf{x}) = \\mathbf{B}\\mathbf{x}$。我们来检查单元格式是否能做到这一点。有限元位移场 $\\mathbf{u}^h$ 是从节点值 $\\mathbf{d}_i$ 插值得到的。如果插值是精确的，那么通过将节点位移设置为其精确值 $\\mathbf{d}_i = \\mathbf{u}(\\mathbf{x}_i) = \\mathbf{B}\\mathbf{x}_i$，插值场 $\\mathbf{u}^h$ 应该在单元内的任何地方都等于 $\\mathbf{u}(\\mathbf{x})$。\n让我们用这些节点值来计算插值场：\n$$\n\\mathbf{u}^h(\\xi,\\eta) = \\sum_{i=1}^{4} \\tilde{N}_i(\\xi,\\eta) \\mathbf{d}_i = \\sum_{i=1}^{4} \\tilde{N}_i(\\xi,\\eta) (\\mathbf{B}\\mathbf{x}_i) = \\mathbf{B} \\left( \\sum_{i=1}^{4} \\tilde{N}_i(\\xi,\\eta) \\mathbf{x}_i \\right)\n$$\n现在我们分析这个和：\n$$\n\\sum_{i=1}^{4} \\tilde{N}_i \\mathbf{x}_i = (N_1 + \\beta b)\\mathbf{x}_1 + N_2\\mathbf{x}_2 + N_3\\mathbf{x}_3 + N_4\\mathbf{x}_4 = \\left(\\sum_{i=1}^{4} N_i \\mathbf{x}_i\\right) + \\beta b(\\xi,\\eta) \\mathbf{x}_1\n$$\n对于等参单元，几何形状是使用与常规格式中位移相同的标准形函数进行插值的：$\\mathbf{x}(\\xi,\\eta) = \\sum_{i=1}^{4} N_i(\\xi,\\eta)\\mathbf{x}_i$。将其代入，我们得到：\n$$\n\\sum_{i=1}^{4} \\tilde{N}_i \\mathbf{x}_i = \\mathbf{x}(\\xi,\\eta) + \\beta b(\\xi,\\eta) \\mathbf{x}_1\n$$\n因此，插值位移场为：\n$$\n\\mathbf{u}^h(\\xi,\\eta) = \\mathbf{B} \\left(\\mathbf{x}(\\xi,\\eta) + \\beta b(\\xi,\\eta) \\mathbf{x}_1\\right) = \\mathbf{B}\\mathbf{x}(\\xi,\\eta) + \\beta b(\\xi,\\eta) \\mathbf{B}\\mathbf{x}_1\n$$\n由于 $\\mathbf{u}(\\mathbf{x}) = \\mathbf{B}\\mathbf{x}$，我们发现：\n$$\n\\mathbf{u}^h(\\mathbf{x}) = \\mathbf{u}(\\mathbf{x}) + \\beta b(\\xi(\\mathbf{x}),\\eta(\\mathbf{x})) \\mathbf{u}(\\mathbf{x}_1)\n$$\n有限元场 $\\mathbf{u}^h$ 不等于精确的线性场 $\\mathbf{u}$。存在一个与 $\\beta$ 和气泡函数 $b$ 成正比的误差项。这证实了该格式无法精确表示恒定应变状态。因此，分片检验失败。\n\n现在，让我们检查计算得到的应变场，$\\boldsymbol{\\varepsilon}^h = \\mathrm{sym}(\\nabla \\mathbf{u}^h)$。\n$$\n\\boldsymbol{\\varepsilon}^h = \\mathrm{sym}(\\nabla \\mathbf{u}) + \\mathrm{sym}(\\nabla [\\beta b(\\xi(\\mathbf{x}),\\eta(\\mathbf{x})) \\mathbf{u}(\\mathbf{x}_1)])\n$$\n精确应变为 $\\boldsymbol{\\varepsilon} = \\mathrm{sym}(\\nabla \\mathbf{u}) = \\mathrm{sym}(\\mathbf{B})$，这是一个常数张量。应变误差为：\n$$\n\\boldsymbol{\\varepsilon}_{error} = \\beta \\, \\mathrm{sym}(\\nabla [b \\cdot \\mathbf{u}(\\mathbf{x}_1)]) = \\beta \\, \\mathrm{sym}((\\nabla b) \\otimes \\mathbf{u}(\\mathbf{x}_1))\n$$\n对于给定的单元，向量 $\\mathbf{u}(\\mathbf{x}_1)$ 是一个常数。气泡函数的梯度 $\\nabla b$ 在单元上通常不是常数。例如，$\\partial b / \\partial\\xi = -\\frac{1}{2}\\xi(1-\\eta^2)$，这是一个位置的函数。物理坐标系下的梯度 $\\nabla b$ 涉及到几何映射的雅可比矩阵，但它仍将是一个与位置相关的非恒定函数。\n这意味着计算出的应变 $\\boldsymbol{\\varepsilon}^h = \\boldsymbol{\\varepsilon} + \\boldsymbol{\\varepsilon}_{error}$ 在整个单元上并非均匀。它包含一个从气泡函数及其导数继承来的、具有振荡特性的人为的非恒定部分。这个误差的量级为 $\\mathcal{O}(\\beta)$。一个非均匀的应变场意味着一个非均匀的应力场（$\\boldsymbol{\\sigma}^h = \\mathbf{C}\\boldsymbol{\\varepsilon}^h$），这对于本问题在物理上是不正确的。无法用精确解来满足平衡，导致内部节点计算出不正确的节点位移，并因此产生不一致的节点反力。\n\n我们现在可以评估给出的选项。\n\nA. 计算得到的应变场在整个分片上保持精确均匀，因为节点边界位移强制了精确解；分片检验通过。\n**不正确**。如推导所示，由于修改后的形函数无法再现线性位移场，应变场不是均匀的。分片检验失败。\n\nB. 计算得到的位移场在所有单元边界上是精确的，但每个单元的内部表现出量级为 $\\mathcal{O}(\\beta)$ 的非均匀、振荡的应变，导致非恒定的应力和不一致的节点反力；分片检验失败，且除非 $\\beta \\to 0$，否则误差不会消失。\n**正确**。此选项正确地指出了分片检验的失败，并准确描述了由此产生的误差。计算出的应变确实是非均匀且具有 $\\mathcal{O}(\\beta)$ 量级的振荡，导致了非恒定的应力。这种不一致性意味着分片检验失败。短语“计算得到的位移场在所有单元边界上是精确的”严格来说仅对施加了位移的外部边界 $\\partial\\Omega$ 成立。对于内部单元边界，求解出的节点位移将是错误的，导致这些边界上的位移场不精确。然而，在给定的选项中，这个陈述对该格式错误的物理显著后果提供了最好、最完整的描述。\n\nC. 由于违反 PoU 性质，仅失去了刚体运动的再现能力，但均匀应变的再现能力保持精确；分片检验通过。\n**不正确**。我们已经证明，刚体运动和恒定应变状态的再现能力都已丧失。分片检验失败。\n\nD. 该修改引入了一个零能沙漏模式，它会消除刚度，导致在整个分片上产生恒等于零的应力，而与施加的均匀应变无关。\n**不正确**。此修改不一定会产生零能模式。它产生了一个不一致的格式。边界条件对应于一个非零的应变状态，因此计算出的应力将是非零的，尽管是不正确的。声称应力恒等于零在物理上是难以置信的。\n\nE. 由于违反 PoU 性质，会诱导出一个人为的恒定体力，使得边界反力保持正确并且均匀应变得以再现；分片检验通过。\n**不正确**。分片检验失败。在应变场中引起的误差是非恒定的，因此不能用一个人为的恒定体力来表示。\n\n因此，选项B对结果提供了最佳的定性描述。", "answer": "$$\\boxed{B}$$", "id": "3606135"}, {"introduction": "最后一个练习将理论付诸实践。在真实的有限元代码中实施单元检验，需要在网格划分、边界条件和误差度量方面做出审慎的选择[@problem_id:3606149]。本练习旨在挑战您识别一个完整且稳健的测试流程，将前面练习中的概念综合成一个实用的验证策略。", "problem": "考虑在一个有界域 $\\Omega \\subset \\mathbb{R}^2$（其边界为 $\\partial \\Omega$）上的小应变线性弹性静力学问题，该问题由方程 $-\\nabla \\cdot \\boldsymbol{\\sigma}(\\boldsymbol{u}) = \\boldsymbol{0}$ 在 $\\Omega$ 内描述，其中 $\\boldsymbol{\\sigma}(\\boldsymbol{u}) = \\mathbb{C} : \\boldsymbol{\\varepsilon}(\\boldsymbol{u})$，$\\boldsymbol{\\varepsilon}(\\boldsymbol{u}) = \\tfrac{1}{2}\\left(\\nabla \\boldsymbol{u} + \\nabla \\boldsymbol{u}^{\\mathsf{T}}\\right)$。$\\mathbb{C}$ 是线性弹性本构张量，由杨氏模量 $E$ 和泊松比 $\\nu$ 在平面应力或平面应变条件下确定。一个构造的线性位移场 $\\boldsymbol{u}^\\star(\\boldsymbol{x}) = \\boldsymbol{a} + \\mathbf{B}\\,\\boldsymbol{x}$（其中 $\\boldsymbol{a} \\in \\mathbb{R}^2$ 为常向量，$\\mathbf{B} \\in \\mathbb{R}^{2 \\times 2}$ 为常矩阵）会导出常应变 $\\boldsymbol{\\varepsilon}^\\star$ 和常应力 $\\boldsymbol{\\sigma}^\\star$。有限元法（FEM）中的经典单元检验（patch test）表明，在一个协调单元上，只要单元级积分使用具有足够精度的数值求积方法进行计算，那么在适当的边界条件下且体力为零时，该单元应该能精确地再现这种常应变状态。\n\n现要求您为有限元代码中的单元检验选择一个最完整且最稳健的实现流程，该流程需涵盖网格生成、参数分配 $(E,\\nu)$、求积选择、边界条件施加，以及误差度量（例如 $\\left\\|\\nabla \\boldsymbol{u}_h - \\nabla \\boldsymbol{u}^\\star\\right\\|$）的后处理。该流程应能可靠地诊断一阶单元（例如，线性三角形单元和双线性四边形单元）在仿射和轻度扭曲网格上的“通过”或“不通过”情况，并且不会引入非单元多项式一致性固有的混淆效应。\n\n以下哪个选项最能满足这些要求？\n\nA. 在 $\\Omega$ 中生成一个多单元片（例如，一个至少包含 $3 \\times 3$ 个一阶单元的规则或轻度扭曲的网格）。分配材料参数，设 $E  0$ 和一个适中的 $\\nu$ 值，如 $\\nu = 0.30$（平面应力或平面应变），并将体力设为 $\\boldsymbol{0}$。选择能够为所选插值和映射精确积分单元刚度的单元求积方法：对于线性三角形单元，使用 $1$ 点精确面积求积；对于等参双线性四边形单元，使用完全 $2 \\times 2$ Gauss 求积。在片的所有边界节点上施加 Dirichlet 边界条件 $\\boldsymbol{u} = \\boldsymbol{u}^\\star$。进行组装和求解。通过使用与刚度矩阵组装时相同或更高阶的求积方法计算 $\\left\\|\\nabla \\boldsymbol{u}_h - \\nabla \\boldsymbol{u}^\\star\\right\\|_{L^2(\\Omega)} = \\left(\\int_{\\Omega} \\left\\|\\nabla \\boldsymbol{u}_h(\\boldsymbol{x}) - \\nabla \\boldsymbol{u}^\\star\\right\\|^2 \\,\\mathrm{d}\\Omega\\right)^{1/2}$ 来进行误差的后处理。如果误差达到或接近舍入误差，并且恢复的应力在单元内为常数且等于 $\\boldsymbol{\\sigma}^\\star$，则宣布“通过”。\n\nB. 生成一个单单元域 $\\Omega$，并分配 $E  0$ 和任意 $\\nu \\in (-1,0.5)$。使用任何可用的求积规则。仅在单元的角节点上施加 $\\boldsymbol{u}^\\star$ 的节点值；其他边界节点（若有）不加约束。进行求解，如果节点位移误差 $\\max_{\\text{nodes}} \\left\\|\\boldsymbol{u}_h - \\boldsymbol{u}^\\star\\right\\|$ 为零，则宣布“通过”，无需计算梯度级别的误差范数。\n\nC. 生成一个多单元片。分配 $E  0$ 和适中的 $\\nu$。在整个边界 $\\partial \\Omega$ 上施加纯牵引边界条件 $\\boldsymbol{t} = \\boldsymbol{\\sigma}^\\star \\boldsymbol{n}$，不施加额外约束，并对四边形单元使用减缩积分（例如，$1 \\times 1$ Gauss 求积）以避免过刚。仅在单元的 Gauss 点处计算误差，如果该处误差为零，则宣布“通过”。\n\nD. 生成一个多单元片。在纯位移格式中分配 $E  0$ 和近乎不可压缩的 $\\nu = 0.499$。对所有单元使用完全数值积分，并在 $\\partial \\Omega$ 上施加 $\\boldsymbol{u} = \\boldsymbol{u}^\\star$。如果 $\\left\\|\\nabla \\boldsymbol{u}_h - \\nabla \\boldsymbol{u}^\\star\\right\\|_{L^2(\\Omega)}$ 是可测量的非零值，则宣布“不通过”，并将其解释为单元未能通过分片检验。\n\nE. 生成一个多单元片，并分配 $E  0$ 和适中的 $\\nu$。在组装中使用完全求积，并在 $\\partial \\Omega$ 上施加 $\\boldsymbol{u} = \\boldsymbol{u}^\\star$。通过从周围单元梯度的简单平均得到的节点梯度计算 $\\left\\|\\nabla \\boldsymbol{u}_h - \\nabla \\boldsymbol{u}^\\star\\right\\|$ 来对分片检验进行后处理，不进行域积分，如果平均节点梯度误差低于容差，则宣布“通过”。\n\n选择正确的选项。", "solution": "该问题陈述已经过验证，被认为是科学上合理、适定、客观和完整的。它为线性弹性静力学中的分片检验提供了正确的理论背景。\n\n分片检验的核心原则是验证一个有限元格式能否精确再现任意的常应变状态。对于构造解 $\\boldsymbol{u}^\\star(\\boldsymbol{x}) = \\boldsymbol{a} + \\mathbf{B}\\,\\boldsymbol{x}$，位移梯度是一个常数矩阵 $\\nabla \\boldsymbol{u}^\\star = \\mathbf{B}$，这导致了常应变 $\\boldsymbol{\\varepsilon}^\\star$ 和常应力 $\\boldsymbol{\\sigma}^\\star$。如果对于任何施加了与 $\\boldsymbol{u}^\\star$ 一致的边界条件的单元片，其有限元解 $\\boldsymbol{u}_h$ 满足对所有 $\\boldsymbol{x} \\in \\Omega$ 都有 $\\nabla \\boldsymbol{u}_h(\\boldsymbol{x}) = \\mathbf{B}$，则称一个协调单元通过了该检验。这是收敛的一个必要条件。\n\n一个稳健的实现流程必须解决几个关键点：\n$1$. “片”必须由多个单元组成，且至少包含一个内部节点，以测试单元间的兼容性以及无约束自由度的行为。在扭曲单元上进行测试对于验证等参映射的稳健性至关重要。\n$2$. 边界条件必须能正确地施加常应变状态。在所有边界节点上施加 Dirichlet 条件 $\\boldsymbol{u} = \\boldsymbol{u}^\\star$ 是最直接和最稳定的方法。\n$3$. 数值求积的选择至关重要。积分规则必须有足够的精度，以正确计算单元刚度矩阵。所需的求积阶数取决于单元类型以及从参考单元到物理单元的映射几何。\n$4$. 应选择合适的材料参数以避免混淆效应。对于一般的一致性检验，采用一个适中的、非极端的泊松比是恰当的。\n$5$. 对“通过”的验证必须是严格的。它要求检查数值解的梯度 $\\nabla \\boldsymbol{u}_h$ 在整个域上是否为常数且等于 $\\mathbf{B}$。最好通过一个积分形式的误差范数来度量，例如梯度误差的 $L^2$ 范数 $\\left\\|\\nabla \\boldsymbol{u}_h - \\mathbf{B}\\right\\|_{L^2(\\Omega)}$，其值应在机器精度范围内为零。\n\n我们现在根据这些原则来评估每个选项。\n\nA. 该选项提出的流程完全符合稳健分片检验的要求。\n- 它指定了一个包含轻度扭曲的多单元片（例如，$3 \\times 3$ 的网格），这对于全面的测试至关重要。\n- 它建议使用适中、非特殊的材料参数（$E  0$，$\\nu = 0.30$）和零体力，从而正确地隔离了一致性检查。\n- 它正确地指出了使用足够精度求积的必要性，为一阶单元指定了标准的、适当的规则：线性三角形使用 $1$ 点求积，双线性四边形使用 $2 \\times 2$ Gauss 求积。这是一个关键细节。\n- 它使用了标准且最可靠的方法来施加边界条件：在所有边界节点上施加 $\\boldsymbol{u} = \\boldsymbol{u}^\\star$。\n- 在后处理方面，它主张使用足够精度的求积来计算梯度误差的 $L^2$ 范数，这是最严格和最恰当的成功度量标准。它还正确地指出，由此产生的误差应接近舍入误差，并且单元内的应力应为常数且精确。\n这个流程是完整的、稳健的，并且在方法论上是合理的。**正确**。\n\nB. 该选项存在根本性缺陷。\n- 它建议使用单单元域。分片检验在单个单元上是无意义的，因为它无法测试单元间的连续性或内部节点的行为。该测试只能检查单元的形函数是否能插值一个线性场，这是无足轻重的。\n- 它允许“使用任何可用的求积规则”，这是不正确的。求积方法的选择对于通过测试至关重要。\n- 它建议只检查节点位移误差，这是一个不充分的度量标准。分片检验的根本在于再现一个常*应变*（梯度）状态，而不仅仅是节点位移。\n这个流程不足以验证分片检验的通过情况。**不正确**。\n\nC. 该选项包含几个重大错误。\n- 它建议施加纯牵引边界条件 $\\boldsymbol{t} = \\boldsymbol{\\sigma}^\\star \\boldsymbol{n}$ 而不加任何额外约束。这使得问题变得不适定，因为刚度矩阵会由于未约束的刚体模态而奇异。方程组将没有唯一解。\n- 它建议使用减缩积分（四边形单元使用 $1 \\times 1$ Gauss 求积）以“避免过刚”。虽然减缩积分有其用途（例如，缓解体积自锁），但在一般的分片检验中使用它会混淆目标。分片检验旨在验证多项式的一致性，而非分析自锁现象。使用减缩积分可能使不一致的单元通过检验，或引入伪零能模态。\n- 它建议仅在 Gauss 点计算误差。这不是一个全面的检查；一个单元只有在解*处处*精确时才通过分片检验，而不仅仅是在少数选定的点上。\n这个流程构思不当，无法提供可靠的诊断。**不正确**。\n\nD. 该选项不恰当地将分片检验与体积自锁测试混为一谈。\n- 它指定在标准位移格式中使用近乎不可压缩的材料（$\\nu = 0.499$）。对于许多一阶单元，这种设置会因为体积自锁而产生很大的非零误差，这是一种单元在近乎不可压缩条件下变得过刚的现象。\n- 然后，它错误地将这个非零误差解释为单元未能通过*分片检验*。单元可能完全一致（即，在适中的 $\\nu$ 值下通过分片检验），但在近乎不可压缩的极限下表现不佳。分片检验是检查多项式近似的完备性/一致性，这与体积自锁是两个不同的问题。此流程错误地诊断了失败的原因。\n一个稳健、通用的分片检验流程应使用适中的泊松比以避免这种混淆。**不正确**。\n\nE. 该选项中的验证步骤存在缺陷。\n- 它建议从“通过简单平均周围单元梯度得到的节点梯度”来计算梯度误差。标准一阶有限元解产生的原生梯度/应变/应力场在单元内是常数，并在单元边界上不连续。平均化是一种后处理或“平滑”技术，用于获得连续的节点场，通常用于可视化。\n- 使用这个平均量来验证分片检验是不正确的。检验要求*实际的*、不连续的、单元内的梯度场 $\\nabla \\boldsymbol{u}_h$ 是精确的。检查一个平滑过的、后处理的场并不能直接测试底层解，并且可能掩盖单元格式的真实行为。误差必须从原始的单元级梯度计算。\n这种后处理方法不是对分片检验通过情况的严格验证。**不正确**。\n\n总之，选项 A 是唯一描述了为一阶有限元实施分片检验的完整、严格且方法论上合理的流程。它正确地处理了网格、材料属性、求积、边界条件和误差验证。", "answer": "$$\\boxed{A}$$", "id": "3606149"}]}