{"hands_on_practices": [{"introduction": "在计算力学中，许多问题的核心在于理解刚体运动如何影响系统刚度矩阵的特性。一个无约束的结构在物理上可以自由平移或旋转，这在数学上表现为刚度矩阵的奇异性，即存在零特征值，导致迭代求解器无法直接求解。本练习 ([@problem_id:3590165]) 将通过一个简单的一维杆模型，让您亲手构建一个奇异的刚度矩阵，并探索施加不同约束如何消除奇异性、改善矩阵的条件数，从而揭示约束选择对求解效率的深刻影响。", "problem": "一根长度为 $L$、横截面积为 $A$、杨氏模量为 $E$ 的均匀、直棱柱一维杆，在无外部载荷的小应变、线性弹性条件下进行建模。使用两个相等的线性有限元，将杆离散化为三个节点，并采用自由-自由边界条件。从胡克定律 $\\sigma = E \\varepsilon$ 和总势能 $\\Pi(u) = \\frac{1}{2}\\int_{0}^{L} E A \\left(\\frac{du}{dx}\\right)^{2} dx$ 出发，使用标准的双节点线性形函数和单元逐元组装的方法，推导该自由-自由系统的 $3 \\times 3$ 组装后全局刚度矩阵 $A$。解释为什么 $A$ 是对称半正定的，并且具有对应于刚体平移的一维零空间。\n\n为消除零空间，通过钉扎一个节点来施加单个位移约束（即，在节点 $p$ 处施加狄利克雷条件 $u_{p}=0$）。通过消除与节点 $p$ 相关联的行和列，形成缩减后的对称正定刚度矩阵 $A_{p}$。考虑两种情况：钉扎端点节点（$p=1$）和钉扎中间节点（$p=2$）。对于每种情况，计算 $A_{p}$ 的所有特征值，并由此计算谱条件数 $\\kappa_{2}(A_{p}) = \\lambda_{\\max}(A_{p}) / \\lambda_{\\min}(A_{p})$。\n\n最后，通过计算比值\n$$\nR = \\frac{\\kappa_{2}(A_{1})}{\\kappa_{2}(A_{2})}\n$$\n来量化单个约束位置对条件数改善的效果。将 $R$ 表示为最简根式形式，无需四舍五入。在您的推导中，请清楚地阐述约束如何消除零空间并将最小特征值从零移至一个正值，并简要评论约束位置对计算固体力学中迭代求解器（例如，应用于对称正定（SPD）系统的共轭梯度法（CG））的预条件子设计的影响。", "solution": "该问题要求推导和分析一维杆在不同边界条件下的刚度矩阵。分析将分步进行：首先，推导单元刚度矩阵；其次，为自由-自由系统组装全局刚度矩阵；第三，分析该全局矩阵的性质；第四，施加约束并分析得到的缩减系统；最后，计算条件数的比值并讨论其意义。\n\n一根长度为 $L$ 的一维杆，使用两个等长的线性有限元进行离散化，每个单元长度为 $h = L/2$。这样产生了三个节点，位置分别为 $x_1=0$，$x_2=L/2$ 和 $x_3=L$。对应的轴向位移为 $u_1$、$u_2$ 和 $u_3$。\n\n长度为 $h$ 的单个单元的应变能由 $\\Pi^{(e)} = \\frac{1}{2}\\int_{0}^{h} E A \\left(\\frac{du}{dx}\\right)^{2} dx$ 给出。对于一个双节点线性单元，位移场为 $u(x) = N_1(x) u_i + N_2(x) u_j$，其中 $u_i$ 和 $u_j$ 是节点位移。线性形函数为 $N_1(x) = 1 - x/h$ 和 $N_2(x) = x/h$。应变为 $\\varepsilon = \\frac{du}{dx} = \\frac{d N_1}{dx} u_i + \\frac{d N_2}{dx} u_j = -\\frac{1}{h} u_i + \\frac{1}{h} u_j$。写成矩阵形式为 $\\varepsilon = \\mathbf{B} \\mathbf{u}^{(e)}$，其中应变-位移矩阵为 $\\mathbf{B} = \\frac{1}{h} \\begin{pmatrix} -1 & 1 \\end{pmatrix}$，节点位移向量为 $\\mathbf{u}^{(e)} = \\begin{pmatrix} u_i \\\\ u_j \\end{pmatrix}$。\n\n单元刚度矩阵 $\\mathbf{k}^{(e)}$ 由关系式 $\\Pi^{(e)} = \\frac{1}{2} (\\mathbf{u}^{(e)})^{T} \\mathbf{k}^{(e)} \\mathbf{u}^{(e)}$ 定义。代入应变表达式，并假设 $E$ 和 $A$ 为常数：\n$$\n\\Pi^{(e)} = \\frac{1}{2}\\int_{0}^{h} E A \\left( (\\mathbf{B} \\mathbf{u}^{(e)})^T (\\mathbf{B} \\mathbf{u}^{(e)}) \\right) dx = \\frac{1}{2} (\\mathbf{u}^{(e)})^{T} \\left( \\int_{0}^{h} E A \\mathbf{B}^T \\mathbf{B} dx \\right) \\mathbf{u}^{(e)}\n$$\n由于 $\\mathbf{B}$、$E$ 和 $A$ 在单元上是常数，单元刚度矩阵为：\n$$\n\\mathbf{k}^{(e)} = E A h \\mathbf{B}^T \\mathbf{B} = E A h \\left( \\frac{1}{h} \\begin{pmatrix} -1 \\\\ 1 \\end{pmatrix} \\right) \\left( \\frac{1}{h} \\begin{pmatrix} -1 & 1 \\end{pmatrix} \\right) = \\frac{EA}{h} \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix}\n$$\n对于我们的问题，两个单元的长度为 $h = L/2$。设常数项为 $C = \\frac{EA}{h} = \\frac{EA}{L/2} = \\frac{2EA}{L}$。\n单元 $1$ 连接节点 $1$ 和 $2$，因此其刚度矩阵为 $\\mathbf{k}^{(1)} = C \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix}$。\n单元 $2$ 连接节点 $2$ 和 $3$，因此其刚度矩阵为 $\\mathbf{k}^{(2)} = C \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix}$。\n\n$3 \\times 3$ 的全局刚度矩阵 $A$ 是通过将每个单元的贡献加到相应的全局自由度上组装而成的：\n$$\nA = \\begin{pmatrix}\nk^{(1)}_{11} & k^{(1)}_{12} & 0 \\\\\nk^{(1)}_{21} & k^{(1)}_{22} + k^{(2)}_{11} & k^{(2)}_{12} \\\\\n0 & k^{(2)}_{21} & k^{(2)}_{22}\n\\end{pmatrix}\n= C \\begin{pmatrix}\n1 & -1 & 0 \\\\\n-1 & 1+1 & -1 \\\\\n0 & -1 & 1\n\\end{pmatrix}\n= \\frac{2EA}{L} \\begin{pmatrix}\n1 & -1 & 0 \\\\\n-1 & 2 & -1 \\\\\n0 & -1 & 1\n\\end{pmatrix}\n$$\n这就是自由-自由系统的组装后全局刚度矩阵。\n\n矩阵 $A$ 是对称半正定的。其对称性（$A = A^T$）从其构造中显而易见。它是半正定的，因为二次型 $\\mathbf{u}^T A \\mathbf{u}$ 代表总应变能 $\\Pi$ 的两倍，即 $\\int_{0}^{L} E A (\\frac{du}{dx})^2 dx$。由于 $E>0$ 且 $A>0$，该能量始终为非负。能量为零当且仅当应变 $\\frac{du}{dx}$ 处处为零。这种情况发生在 $u(x)$ 为常数时，这对应于整个杆的刚体平移。对于离散系统，这意味着对于任意常数 $c \\neq 0$，有 $u_1=u_2=u_3=c$。这个非零位移向量 $\\mathbf{u} = c \\begin{pmatrix} 1 & 1 & 1 \\end{pmatrix}^T$ 导致能量为零，即 $\\mathbf{u}^T A \\mathbf{u} = 0$。因此，$A$ 是半正定的，而不是正定的。$A$ 的零空间由所有此类向量组成，它是一个由向量 $\\mathbf{v} = \\begin{pmatrix} 1 & 1 & 1 \\end{pmatrix}^T$ 张成的一维空间。我们可以验证这一点：\n$$\nA \\mathbf{v} = \\frac{2EA}{L} \\begin{pmatrix}\n1 & -1 & 0 \\\\\n-1 & 2 & -1 \\\\\n0 & -1 & 1\n\\end{pmatrix} \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\end{pmatrix} = \\frac{2EA}{L} \\begin{pmatrix} 1-1+0 \\\\ -1+2-1 \\\\ 0-1+1 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix}\n$$\n这个零空间（一个零特征值）的存在意味着 $A$ 是奇异的。\n\n为了获得唯一解，我们必须施加边界条件以消除刚体运动。这通过钉扎一个节点来实现。\n\n情况 1：钉扎端点节点，$p=1$。\n我们施加条件 $u_1=0$。通过从 $A$ 中移除第一行和第一列来获得缩减系统。缩减后的刚度矩阵 $A_1$ 控制着剩余的自由度 $u_2$ 和 $u_3$：\n$$\nA_1 = \\frac{2EA}{L} \\begin{pmatrix} 2 & -1 \\\\ -1 & 1 \\end{pmatrix}\n$$\n为了找到特征值，我们分析矩阵部分 $M_1 = \\begin{pmatrix} 2 & -1 \\\\ -1 & 1 \\end{pmatrix}$。特征方程为 $\\det(M_1 - \\lambda I) = 0$：\n$$\n(2-\\lambda)(1-\\lambda) - (-1)(-1) = 0 \\implies \\lambda^2 - 3\\lambda + 2 - 1 = 0 \\implies \\lambda^2 - 3\\lambda + 1 = 0\n$$\n根为 $\\lambda = \\frac{3 \\pm \\sqrt{9-4}}{2} = \\frac{3 \\pm \\sqrt{5}}{2}$。\n$A_1$ 的特征值是这些值乘以比例因子 $C = \\frac{2EA}{L}$：\n$\\lambda_{\\min}(A_1) = \\frac{2EA}{L} \\left(\\frac{3-\\sqrt{5}}{2}\\right) = \\frac{EA}{L}(3-\\sqrt{5})$\n$\\lambda_{\\max}(A_1) = \\frac{2EA}{L} \\left(\\frac{3+\\sqrt{5}}{2}\\right) = \\frac{EA}{L}(3+\\sqrt{5})$\n两个特征值都是正的，所以 $A_1$ 是对称正定（SPD）的。谱条件数为：\n$$\n\\kappa_2(A_1) = \\frac{\\lambda_{\\max}(A_1)}{\\lambda_{\\min}(A_1)} = \\frac{3+\\sqrt{5}}{3-\\sqrt{5}} = \\frac{(3+\\sqrt{5})(3+\\sqrt{5})}{(3-\\sqrt{5})(3+\\sqrt{5})} = \\frac{9+6\\sqrt{5}+5}{9-5} = \\frac{14+6\\sqrt{5}}{4} = \\frac{7+3\\sqrt{5}}{2}\n$$\n\n情况 2：钉扎中间节点，$p=2$。\n我们施加条件 $u_2=0$。通过从 $A$ 中移除第二行和第二列来获得缩减系统。缩减后的矩阵 $A_2$ 控制着自由度 $u_1$ 和 $u_3$：\n$$\nA_2 = \\frac{2EA}{L} \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix}\n$$\n这个矩阵是对角矩阵。其特征值就是对角线上的元素。\n$\\lambda_1 = \\lambda_2 = \\frac{2EA}{L}$。\n因此，$\\lambda_{\\min}(A_2) = \\lambda_{\\max}(A_2) = \\frac{2EA}{L}$。两者都是正的，所以 $A_2$ 是 SPD。\n谱条件数为：\n$$\n\\kappa_2(A_2) = \\frac{\\lambda_{\\max}(A_2)}{\\lambda_{\\min}(A_2)} = \\frac{2EA/L}{2EA/L} = 1\n$$\n\n最后，我们计算比值 $R$：\n$$\nR = \\frac{\\kappa_2(A_1)}{\\kappa_2(A_2)} = \\frac{\\frac{7+3\\sqrt{5}}{2}}{1} = \\frac{7+3\\sqrt{5}}{2}\n$$\n\n对计算固体力学中预条件处理的启示：\n未约束的矩阵 $A$ 由于其对应于刚体运动的零空间而是奇异的（$\\kappa_2(A)=\\infty$）。像共轭梯度（CG）法这样的迭代求解器需要一个对称正定（SPD）矩阵，因此在处理 $A$ 时会失败。施加单个位移约束可以消除零空间，将最小特征值从 $0$ 移至一个正值，从而使矩阵变为 SPD，系统变得可解。\n\n此分析表明，约束位置的选择对最终系统矩阵的条件数有深远的影响。钉扎中心节点（$p=2$）会得到一个理想条件的矩阵，其条件数为 $\\kappa_2(A_2)=1$。物理上，这会将系统解耦为两个独立的长度为 $L/2$ 的杆，一根在 $x=L/2$ 处固定，在 $x=0$ 处自由；另一根在 $x=L/2$ 处固定，在 $x=L$ 处自由，从而得到对角矩阵 $A_2$。对于这样的系统，迭代求解器将以最少的迭代次数收敛。钉扎端点节点（$p=1$）会得到一个耦合系统，其条件数为 $\\kappa_2(A_1) \\approx 6.85$，虽然条件良好，但明显劣于最优情况。\n\n这个简单的例子阐明了大规模固体力学中高级预条件技术的一个关键原则，例如在区域分解法（如 FETI、BDD）中。在这些方法中，会专门构建一个全局“粗网格问题”，以处理浮动子区域的零空间模态（刚体运动）。在粗网格问题中约束这些子区域的方式，类似于我们在杆问题中选择钉扎点的位置。一个精心设计的粗网格问题，通常涉及约束平均或中心的自由度，会得到一个条件数好得多的预条件系统，从而极大地加速迭代求解器的收敛。约束的选择并非任意，而是实现高性能计算力学模拟的算法设计中的一个关键方面。", "answer": "$$\n\\boxed{\\frac{7+3\\sqrt{5}}{2}}\n$$", "id": "3590165"}, {"introduction": "当面对具有挑战性的物理现象，如材料各向异性时，标准预条件技术（或多重网格中的光滑子）的性能可能会急剧下降。理解其失效的原因并设计更有效的方法是高级计算工程师的核心技能。本练习 ([@problem_id:3552374]) 将指导您使用局部傅里叶分析（LFA）这一强大的工具，量化分析为何简单的点雅可比方法在处理强各向异性问题时失效，并在此基础上构建一个能够恢复光滑效率的线光滑子。", "problem": "考虑在分层地质材料中的稳态各向异性扩散，其主渗透率与笛卡尔坐标轴对齐，由算子 $-\\nabla \\cdot ( \\mathbf{K} \\nabla u )$ 建模，其中 $\\mathbf{K} = \\operatorname{diag}(K_x, K_y)$。该问题定义在一个矩形域上，并用两个方向上间距均为 $h$ 的均匀网格进行离散化。假设采用周期性边界条件，以便进行局部傅里叶分析 (LFA)。设 $K_x = 1$ 和 $K_y = \\epsilon$，其中 $0 < \\epsilon \\ll 1$，表示各向异性比 $\\kappa = K_x/K_y = 1/\\epsilon$。使用标准的五点有限差分离散格式，作用在网格函数 $u_{i,j}$ 上的离散算子形式如下\n$$\n(Au)_{i,j} = \\frac{1}{h^2}\\Big( 2(1+\\epsilon) u_{i,j} - u_{i-1,j} - u_{i+1,j} - \\epsilon u_{i,j-1} - \\epsilon u_{i,j+1} \\Big).\n$$\n你将需要分析对高频误差分量的光滑效果，并设计一个有效的行光滑子。\n\n任务：\n1) 从点-Jacobi迭代的定义 $u^{(k+1)} = u^{(k)} + D^{-1}(f - Au^{(k)})$ 出发，其中 $D = \\operatorname{diag}(A)$，通过将 $I - D^{-1}A$ 应用于一个傅里叶模 $e_{i,j} = \\exp(i(\\theta_x i + \\theta_y j))$ 来推导误差传播符号 $\\tilde{S}_J(\\theta_x,\\theta_y)$。然后，计算波数为 $(\\theta_x,\\theta_y) = (0,\\pi)$ 的高频模的放大因子。根据你推导的表达式，解释其在 $\\epsilon \\to 0$ 时的行为，并说明点-Jacobi方法是否能充分光滑此模式。\n\n2) 构建一个 $x$-行对称 Gauss–Seidel (GS) 光滑子，具体如下：对每一行 $j$，精确求解由 $x$ 方向耦合定义的三对角系统，并在 $y$ 方向上进行前向扫描（使用新更新的第 $j-1$ 行），然后在 $y$ 方向上进行后向扫描（使用新更新的第 $j+1$ 行）。从离散方程的分块形式出发，推导在一次完整的对称行-GS扫描之后，一个通用傅里叶模 $e_{i,j} = \\exp(i(\\theta_x i + \\theta_y j))$ 的 LFA 误差放大因子。然后，在各向异性比 $\\kappa = 10^3$（即 $\\epsilon = 10^{-3}$）的情况下，计算相同高频模 $(\\theta_x,\\theta_y) = (0,\\pi)$ 的放大因子的模。\n\n请给出该放大因子模的精确值作为最终答案；无需四舍五入，也不包含单位。", "solution": "我们依次解决这两个任务。\n\n第1部分：点-Jacobi光滑子的分析\n\n对于线性系统 $Au = f$，点-Jacobi迭代由 $u^{(k+1)} = u^{(k)} + D^{-1}(f - Au^{(k)})$ 给出，其中 $D$ 是矩阵 $A$ 的对角部分。误差 $e^{(k)} = u - u^{(k)}$ 根据方程 $e^{(k+1)} = (I - D^{-1}A) e^{(k)}$ 进行传播。矩阵 $S_J = I - D^{-1}A$ 是点-Jacobi方法的误差传播矩阵。为进行局部傅里叶分析 (LFA)，我们分析该算子对单个傅里叶模 $e_{i,j} = \\exp(i(\\theta_x i + \\theta_y j))$ 的作用，其中 $\\theta_x, \\theta_y \\in [-\\pi, \\pi]$ 是波数。\n\n离散算子 $A$ 由下式给出\n$$\n(Au)_{i,j} = \\frac{1}{h^2}\\Big( 2(1+\\epsilon) u_{i,j} - u_{i-1,j} - u_{i+1,j} - \\epsilon u_{i,j-1} - \\epsilon u_{i,j+1} \\Big).\n$$\n将 $A$ 应用于傅里叶模 $e_{i,j}$ 得到：\n$$\n(Ae)_{i,j} = \\frac{1}{h^2} \\Big( 2(1+\\epsilon) - \\exp(-i\\theta_x) - \\exp(i\\theta_x) - \\epsilon\\exp(-i\\theta_y) - \\epsilon\\exp(i\\theta_y) \\Big) e_{i,j}\n$$\n使用欧拉公式 $\\exp(i\\phi) + \\exp(-i\\phi) = 2\\cos(\\phi)$，我们得到算子 $A$ 的符号（特征值）$\\tilde{A}(\\theta_x, \\theta_y)$：\n$$\n\\tilde{A}(\\theta_x, \\theta_y) = \\frac{1}{h^2} \\Big( 2(1+\\epsilon) - 2\\cos(\\theta_x) - 2\\epsilon\\cos(\\theta_y) \\Big) = \\frac{2}{h^2} \\Big( 1+\\epsilon - \\cos(\\theta_x) - \\epsilon\\cos(\\theta_y) \\Big).\n$$\n$A$ 的对角部分，记为 $D$，是乘以 $u_{i,j}$ 的项：$(Du)_{i,j} = \\frac{2(1+\\epsilon)}{h^2} u_{i,j}$。因此 $D$ 的符号是一个常数：\n$$\n\\tilde{D} = \\frac{2(1+\\epsilon)}{h^2}.\n$$\n点-Jacobi方法的误差传播符号 $\\tilde{S}_J(\\theta_x, \\theta_y)$ 是 $I - D^{-1}A$ 的符号：\n$$\n\\tilde{S}_J(\\theta_x, \\theta_y) = 1 - \\frac{\\tilde{A}(\\theta_x, \\theta_y)}{\\tilde{D}} = 1 - \\frac{\\frac{2}{h^2} \\Big( 1+\\epsilon - \\cos(\\theta_x) - \\epsilon\\cos(\\theta_y) \\Big)}{\\frac{2(1+\\epsilon)}{h^2}}.\n$$\n化简该表达式，我们得到：\n$$\n\\tilde{S}_J(\\theta_x, \\theta_y) = \\frac{(1+\\epsilon) - \\Big( 1+\\epsilon - \\cos(\\theta_x) - \\epsilon\\cos(\\theta_y) \\Big)}{1+\\epsilon} = \\frac{\\cos(\\theta_x) + \\epsilon\\cos(\\theta_y)}{1+\\epsilon}.\n$$\n现在，我们计算波数为 $(\\theta_x, \\theta_y) = (0, \\pi)$ 的高频模的放大因子。此模式在 $x$ 方向上是光滑的，在 $y$ 方向上是高振荡的。\n$$\n\\tilde{S}_J(0, \\pi) = \\frac{\\cos(0) + \\epsilon\\cos(\\pi)}{1+\\epsilon} = \\frac{1 - \\epsilon}{1+\\epsilon}.\n$$\n为了解在强各向异性极限下（$\\epsilon \\to 0$）光滑子的有效性，我们考察该放大因子的行为：\n$$\n\\lim_{\\epsilon \\to 0} \\tilde{S}_J(0, \\pi) = \\lim_{\\epsilon \\to 0} \\frac{1 - \\epsilon}{1+\\epsilon} = 1.\n$$\n放大因子为 $1$ 表示与此模式对应的误差分量完全没有被衰减。因此，点-Jacobi方法对于此问题不是一个合适的光滑子，因为对于在弱耦合方向上振荡的模式，其性能会灾难性地下降。\n\n第2部分：$x$-行对称 Gauss-Seidel 光滑子的分析\n\n对于 $x$-行光滑子，我们按行（线）对未知数进行分组。离散方程可以写成分块三对角形式。矩阵 $A$ 可以分解为分块形式 $A = L_b+D_b+U_b$，其中 $D_b$ 是由行内耦合构成的分块对角矩阵，$L_b$ 和 $U_b$ 是分别表示行间耦合的严格分块下三角和上三角矩阵。\n$$ A = \\frac{1}{h^2} \\begin{pmatrix} T_x  & -\\epsilon I &  \\\\ -\\epsilon I & T_x & -\\epsilon I  \\\\  & \\ddots & \\ddots & \\ddots \\\\ & & -\\epsilon I & T_x \\end{pmatrix} $$\n这里，$T_x$ 是单行的三对角矩阵，其元素为 $(-1, 2(1+\\epsilon), -1)$。$h^2 D_b$ 的符号是 $T_x$ 的符号，我们记为 $\\tilde{T}_x(\\theta_x)$：\n$$\n\\tilde{T}_x(\\theta_x) = 2(1+\\epsilon) - 2\\cos(\\theta_x) = 4\\sin^2(\\frac{\\theta_x}{2}) + 2\\epsilon.\n$$\n分块算子 $h^2 L_b$ 和 $h^2 U_b$ 的 LFA 符号分别记为 $\\tilde{L}'(\\theta_y)$ 和 $\\tilde{U}'(\\theta_y)$：\n$$\n\\tilde{L}'(\\theta_y) = -\\epsilon\\exp(-i\\theta_y), \\quad \\tilde{U}'(\\theta_y) = -\\epsilon\\exp(i\\theta_y).\n$$\n一次对称行-Gauss-Seidel扫描的误差传播算子是 $S_{\\text{line-SGS}} = (D_b+U_b)^{-1}L_b (D_b+L_b)^{-1}U_b$。相应的 LFA 符号是：\n$$\n\\tilde{S}_{SGS}(\\theta_x, \\theta_y) = (\\tilde{D}' + \\tilde{U}')^{-1} \\tilde{L}' (\\tilde{D}' + \\tilde{L}')^{-1} \\tilde{U}'.\n$$\n代入分块算子的符号（由 $h^2$ 缩放，我们用 $\\tilde{D}'$ 表示 $\\tilde{T}_x(\\theta_x)$）：\n$$\n\\tilde{S}_{SGS}(\\theta_x, \\theta_y) = \\frac{1}{\\tilde{T}_x(\\theta_x) - \\epsilon\\exp(i\\theta_y)} \\cdot \\big(-\\epsilon\\exp(-i\\theta_y)\\big) \\cdot \\frac{1}{\\tilde{T}_x(\\theta_x) - \\epsilon\\exp(-i\\theta_y)} \\cdot \\big(-\\epsilon\\exp(i\\theta_y)\\big).\n$$\n$$\n\\tilde{S}_{SGS}(\\theta_x, \\theta_y) = \\frac{\\epsilon^2}{\\big(\\tilde{T}_x(\\theta_x)-\\epsilon\\exp(i\\theta_y)\\big)\\big(\\tilde{T}_x(\\theta_x)-\\epsilon\\exp(-i\\theta_y)\\big)}.\n$$\n分母是一个复数与其共轭的乘积，结果是其模的平方：\n$$\n\\tilde{S}_{SGS}(\\theta_x, \\theta_y) = \\frac{\\epsilon^2}{|\\tilde{T}_x(\\theta_x) - \\epsilon\\exp(i\\theta_y)|^2} = \\frac{\\epsilon^2}{(\\tilde{T}_x(\\theta_x) - \\epsilon\\cos(\\theta_y))^2 + (-\\epsilon\\sin(\\theta_y))^2}.\n$$\n$$\n\\tilde{S}_{SGS}(\\theta_x, \\theta_y) = \\frac{\\epsilon^2}{\\tilde{T}_x(\\theta_x)^2 - 2\\epsilon\\tilde{T}_x(\\theta_x)\\cos(\\theta_y) + \\epsilon^2}.\n$$\n我们需要计算在 $\\kappa = 10^3$（即 $\\epsilon = 10^{-3}$）时，模式 $(\\theta_x, \\theta_y) = (0, \\pi)$ 的该因子的模。首先，我们在指定的波数下计算符号。\n对于 $\\theta_x = 0$：\n$$\n\\tilde{T}_x(0) = 4\\sin^2(0) + 2\\epsilon = 2\\epsilon.\n$$\n对于 $\\theta_y = \\pi$：\n$$\n\\cos(\\pi) = -1.\n$$\n将这些代入 $\\tilde{S}_{SGS}$ 的表达式中：\n$$\n\\tilde{S}_{SGS}(0, \\pi) = \\frac{\\epsilon^2}{(2\\epsilon)^2 - 2\\epsilon(2\\epsilon)(-1) + \\epsilon^2} = \\frac{\\epsilon^2}{4\\epsilon^2 + 4\\epsilon^2 + \\epsilon^2} = \\frac{\\epsilon^2}{9\\epsilon^2} = \\frac{1}{9}.\n$$\n该放大因子是一个与 $\\epsilon$（因此也与 $\\kappa$）无关的实正常数。因此，模式 $(0, \\pi)$ 的放大因子的模为 $|\\frac{1}{9}| = \\frac{1}{9}$。$\\kappa = 10^3$ 的具体值不影响此结果。", "answer": "$$\\boxed{\\frac{1}{9}}$$", "id": "3552374"}, {"introduction": "在实际的工程应用中，选择“最佳”预条件子不仅是一个理论问题，更是一个涉及计算成本与求解效率权衡的工程决策。不同的预条件子家族（如不完全分解和代数多重网格）具有截然不同的设置成本、内存占用和随问题规模变化的性能。本练习 ([@problem_id:3590222]) 将引导您建立一个简化的成本模型，用于比较两种先进的预条件策略，并根据问题的规模做出最优选择，从而培养在算法层面进行性能预测和决策的能力。", "problem": "考虑单位立方体上的准静态、小应变、线性弹性问题，其边界条件为齐次狄利克雷边界条件。强形式为 $\\nabla \\cdot \\sigma = f$，本构关系为 $\\sigma = \\mathbb{C} : \\varepsilon(u)$，其中 $\\varepsilon(u) = (\\nabla u + \\nabla u^{\\top})/2$，$\\mathbb{C}$ 是一个一致椭圆、有界的四阶张量。标准的相容有限元离散化产生一个稀疏对称正定线性系统 $A u = b$，其中 $A \\in \\mathbb{R}^{N \\times N}$，$N$ 是位移未知数的数量。我们考虑一系列由 $k \\in \\{0,1,2,\\dots\\}$ 索引的一致加密网格，其中 $N_k = N_0 \\cdot 8^k$，$N_0 = 1.5 \\times 10^4$。\n\n该线性系统使用预条件共轭梯度法 (PCG) 求解，并应用于两种备选的预条件子：\n- 带阈值的不完全LU分解 (ILUT)，其特征为舍弃容差 $\\tau \\in (0,\\infty)$。\n- 代数多重网格 (AMG)，每次 PCG 迭代使用单个 V 循环。\n\n采用以下基于三维弹性计算复杂度和收敛性方面经过充分验证的事实的建模假设：\n- 在一次 PCG 迭代中，稀疏矩阵向量积和向量运算的成本与 $N$ 呈线性关系；将其成本建模为 $a_0 N$，其中 $a_0 = 5.0 \\times 10^{-1}$（归一化成本单位）。\n- 在一次迭代中应用 ILUT 预条件子的成本主要由两次三角求解决定，其成本与非零元素的数量成线性关系，而非零元素的数量随着 $\\tau$ 的减小而增加。将其建模为一个附加项 $a_1 \\tau^{-q} N$，其中 $a_1 = 5.0 \\times 10^{-2}$ 且 $q = 1$。\n- ILUT 的设置（分解）成本与 $N$ 呈线性关系，并具有相同的填充因子依赖性；将其建模为 $s_1 \\tau^{-q} N$，其中 $s_1 = 1.0 \\times 10^2$。\n- 对于三维弹性问题，使用 ILU 类型预处理的 PCG 迭代次数随着网格加密大致按 $N^{1/3}$ 增长，而较弱的预条件子（较大的 $\\tau$）会增加迭代次数。将 ILUT 的迭代次数建模为 $K_{\\mathrm{ILUT}}(N,\\tau) = b N^{1/3} \\tau^{q}$，其中 $b = 1$ 且 $q = 1$。\n- 对于使用 V 循环的 AMG，每次迭代的应用成本与 $N$ 呈线性关系，且当近零空间被正确处理时，迭代次数与网格无关。将 AMG 的设置和求解成本汇总为一个线性模型 $T_{\\mathrm{AMG}}(N) = g N$，其中 $g = 2.0 \\times 10^2$（使用相同的归一化单位）。\n\n使用这些假设，为带舍弃容差 $\\tau$ 的ILUT（包括其设置成本）和使用V循环的AMG建立一个简单的成本模型，该模型平衡了每次迭代的成本和迭代次数。然后：\n1. 推导在给定 $N$ 的情况下，使总 ILUT 成本最小化的 $\\tau$。\n2. 确定最小的加密级别 $k$，使得对于 $N_k = N_0 \\cdot 8^k$，总 AMG 成本严格小于最小化的总 ILUT 成本。\n\n将最终答案表示为上述指定的整数 $k$。由于 $k$ 是整数，无需进行四舍五入。", "solution": "使用 ILUT 预条件子的求解器总计算成本，记为 $T_{\\mathrm{ILUT}}(N, \\tau)$，是一次性设置（分解）成本与迭代求解总成本之和。设置成本给定为 $s_1 \\tau^{-q} N$。总求解成本是迭代次数 $K_{\\mathrm{ILUT}}(N, \\tau)$ 与每次迭代成本的乘积。每次 PCG 迭代的成本是稀疏矩阵向量积和向量运算成本 $a_0 N$ 与应用预条件子成本 $a_1 \\tau^{-q} N$ 之和。\n\n因此，ILUT 的总成本为：\n$$\nT_{\\mathrm{ILUT}}(N, \\tau) = (\\text{设置成本}) + (\\text{迭代次数}) \\times (\\text{每次迭代成本})\n$$\n$$\nT_{\\mathrm{ILUT}}(N, \\tau) = (s_1 \\tau^{-q} N) + K_{\\mathrm{ILUT}}(N, \\tau) \\times (a_0 N + a_1 \\tau^{-q} N)\n$$\n代入迭代次数的模型 $K_{\\mathrm{ILUT}}(N, \\tau) = b N^{1/3} \\tau^{q}$ 以及给定的参数值 $b=1$ 和 $q=1$：\n$$\nT_{\\mathrm{ILUT}}(N, \\tau) = s_1 N \\tau^{-1} + (N^{1/3} \\tau) (a_0 N + a_1 N \\tau^{-1})\n$$\n展开表达式，我们得到总成本作为自由度数 $N$ 和舍弃容差 $\\tau$ 的函数：\n$$\nT_{\\mathrm{ILUT}}(N, \\tau) = s_1 N \\tau^{-1} + a_0 N^{4/3} \\tau + a_1 N^{4/3}\n$$\n为了找到在给定 $N$ 的情况下使该成本最小化的最优舍弃容差 $\\tau_{\\mathrm{opt}}$，我们计算 $T_{\\mathrm{ILUT}}$ 关于 $\\tau$ 的一阶导数并将其设为零。\n$$\n\\frac{\\partial T_{\\mathrm{ILUT}}}{\\partial \\tau} = -s_1 N \\tau^{-2} + a_0 N^{4/3} = 0\n$$\n求解 $\\tau^2$：\n$$\na_0 N^{4/3} = s_1 N \\tau^{-2} \\implies \\tau^2 = \\frac{s_1 N}{a_0 N^{4/3}} = \\frac{s_1}{a_0 N^{1/3}}\n$$\n由于 $\\tau$ 必须为正，我们取正平方根：\n$$\n\\tau_{\\mathrm{opt}}(N) = \\sqrt{\\frac{s_1}{a_0}} N^{-1/6}\n$$\n二阶导数 $\\frac{\\partial^2 T_{\\mathrm{ILUT}}}{\\partial \\tau^2} = 2 s_1 N \\tau^{-3}$ 对所有有效参数（$s_1 > 0$，$N > 0$，$\\tau > 0$）均为正，这确认了此 $\\tau$ 值对应于一个局部最小值。\n\n接下来，我们将 $\\tau_{\\mathrm{opt}}$ 代入成本函数 $T_{\\mathrm{ILUT}}(N, \\tau)$ 以找到最小化的 ILUT 成本 $T_{\\mathrm{ILUT, min}}(N)$。\n$$\nT_{\\mathrm{ILUT, min}}(N) = s_1 N (\\tau_{\\mathrm{opt}})^{-1} + a_0 N^{4/3} \\tau_{\\mathrm{opt}} + a_1 N^{4/3}\n$$\n各项为：\n$$\ns_1 N (\\tau_{\\mathrm{opt}})^{-1} = s_1 N \\left(\\sqrt{\\frac{a_0}{s_1}} N^{1/6}\\right) = \\sqrt{s_1 a_0} N^{7/6}\n$$\n$$\na_0 N^{4/3} \\tau_{\\mathrm{opt}} = a_0 N^{4/3} \\left(\\sqrt{\\frac{s_1}{a_0}} N^{-1/6}\\right) = \\sqrt{a_0 s_1} N^{4/3 - 1/6} = \\sqrt{a_0 s_1} N^{7/6}\n$$\n合并这些项，ILUT 的最小化总成本为：\n$$\nT_{\\mathrm{ILUT, min}}(N) = 2 \\sqrt{a_0 s_1} N^{7/6} + a_1 N^{4/3}\n$$\nAMG 的总成本由线性模型 $T_{\\mathrm{AMG}}(N) = g N$ 给出。我们需要找到最小的整数加密级别 $k$，使得对于 $N_k = N_0 \\cdot 8^k$，总 AMG 成本严格小于最小化的总 ILUT 成本。条件是：\n$$\nT_{\\mathrm{AMG}}(N_k)  T_{\\mathrm{ILUT, min}}(N_k)\n$$\n$$\ng N_k  2 \\sqrt{a_0 s_1} N_k^{7/6} + a_1 N_k^{4/3}\n$$\n由于 $N_k  0$，我们可以将不等式两边同时除以 $N_k$：\n$$\ng  2 \\sqrt{a_0 s_1} N_k^{1/6} + a_1 N_k^{1/3}\n$$\n让我们代入给定的数值：$g=2.0 \\times 10^2$, $a_0 = 5.0 \\times 10^{-1}$, $s_1 = 1.0 \\times 10^2$, and $a_1 = 5.0 \\times 10^{-2}$。\n$$\n200  2 \\sqrt{(0.5)(100)} N_k^{1/6} + 0.05 N_k^{1/3}\n$$\n$$\n200  2 \\sqrt{50} N_k^{1/6} + 0.05 N_k^{1/3}\n$$\n$$\n200  10 \\sqrt{2} N_k^{1/6} + 0.05 N_k^{1/3}\n$$\n现在，代入 $N_k = N_0 \\cdot 8^k = (1.5 \\times 10^4) \\cdot 8^k$。\n$$\nN_k^{1/6} = (N_0 \\cdot 8^k)^{1/6} = N_0^{1/6} \\cdot (8^{1/6})^k = N_0^{1/6} \\cdot (\\sqrt{2})^k = N_0^{1/6} \\cdot 2^{k/2}\n$$\n$$\nN_k^{1/3} = (N_0 \\cdot 8^k)^{1/3} = N_0^{1/3} \\cdot (8^{1/3})^k = N_0^{1/3} \\cdot 2^k\n$$\n不等式变为：\n$$\n200  10 \\sqrt{2} \\cdot N_0^{1/6} \\cdot 2^{k/2} + 0.05 \\cdot N_0^{1/3} \\cdot 2^k\n$$\n我们计算涉及 $N_0 = 1.5 \\times 10^4$ 的系数：\n$$\nN_0^{1/6} = (15000)^{1/6} \\approx 4.9635\n$$\n$$\nN_0^{1/3} = (15000)^{1/3} \\approx 24.6621\n$$\n不等式近似为：\n$$\n200  10 \\sqrt{2} (4.9635) \\cdot 2^{k/2} + 0.05 (24.6621) \\cdot 2^k\n$$\n$$\n200  (70.194) \\cdot 2^{k/2} + (1.2331) \\cdot 2^k\n$$\n令 $x = 2^{k/2}$。由于 $k \\ge 0$，我们有 $x \\ge 1$。不等式转化为关于 $x$ 的二次不等式：\n$$\n1.2331 x^2 + 70.194 x - 200 > 0\n$$\n为了找到该不等式成立的区域，我们求二次方程 $1.2331 x^2 + 70.194 x - 200 = 0$ 的根。\n$$\nx = \\frac{-70.194 \\pm \\sqrt{70.194^2 - 4(1.2331)(-200)}}{2(1.2331)}\n$$\n$$\nx = \\frac{-70.194 \\pm \\sqrt{4927.2 + 986.48}}{2.4662} = \\frac{-70.194 \\pm \\sqrt{5913.68}}{2.4662} \\approx \\frac{-70.194 \\pm 76.900}{2.4662}\n$$\n由于 $x = 2^{k/2}$ 必须为正，我们取正根：\n$$\nx \\approx \\frac{6.706}{2.4662} \\approx 2.7191\n$$\n该二次函数在 $x > 2.7191$ 时为正。我们必须找到满足此条件的最小整数 $k$。\n$$\n2^{k/2} > 2.7191\n$$\n对两边取自然对数：\n$$\n\\frac{k}{2} \\ln(2) > \\ln(2.7191)\n$$\n$$\nk > \\frac{2 \\ln(2.7191)}{\\ln(2)} \\approx \\frac{2 (1.0003)}{0.6931} \\approx 2.8864\n$$\n因为 $k$ 必须是整数，所以满足此条件的最小整数 $k$ 值为 $3$。", "answer": "$$\\boxed{3}$$", "id": "3590222"}]}