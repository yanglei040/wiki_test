{"hands_on_practices": [{"introduction": "本练习将带您实践有限应变塑性理论的运动学基石：乘法分解。理解如何将总变形梯度 $\\boldsymbol{F}$ 分解为弹性的 $\\boldsymbol{F}_e$ 和塑性的 $\\boldsymbol{F}_p$ 部分，是建立任何复杂塑性模型的起点。通过这个具体的计算[@problem_id:3566178]，您将掌握如何通过基本的矩阵运算，从已知的总变形和塑性变形中分离出引起应力的弹性变形部分。", "problem": "一个经历有限应变塑性和乘法分解的可压缩固体承受一个均匀变形。总变形梯度被指定为一个对角拉伸和一个简单剪切的乘积，\n$$\n\\boldsymbol{F}=\\operatorname{diag}(1.1,\\,0.9,\\,1.0)\\,\\begin{bmatrix}1 & 0.2 & 0\\\\ 0 & 1 & 0\\\\ 0 & 0 & 1\\end{bmatrix}.\n$$\n塑性部分是一个形式如下的等体积简单剪切\n$$\n\\boldsymbol{F}_{p}=\\begin{bmatrix}1 & \\gamma_{p} & 0\\\\ 0 & 1 & 0\\\\ 0 & 0 & 1\\end{bmatrix},\\quad \\gamma_{p}=0.1,\n$$\n其行列式为单位值。假设变形梯度的乘法分解为，\n$$\n\\boldsymbol{F}=\\boldsymbol{F}_{e}\\,\\boldsymbol{F}_{p},\n$$\n其中 $\\boldsymbol{F}_{e}$ 是弹性变形梯度。弹性右柯西-格林变形张量的定义为\n$$\n\\boldsymbol{C}_{e}=\\boldsymbol{F}_{e}^{\\mathsf{T}}\\,\\boldsymbol{F}_{e}.\n$$\n仅使用这些定义和矩阵运算，显式计算 $\\boldsymbol{F}_{e}$ 和 $\\boldsymbol{C}_{e}$。作为您最终报告的量，请提供弹性右柯西-格林张量的第一不变量，\n$$\nI_{1}(\\boldsymbol{C}_{e})=\\operatorname{tr}(\\boldsymbol{C}_{e}),\n$$\n以单个精确数（无单位）的形式给出。不要四舍五入；报告精确值。", "solution": "用户希望从总变形梯度及其到弹性和塑性部分的乘法分解出发，计算弹性右柯西-格林变形张量的第一不变量。\n\n### 第一步：问题验证\n\n在尝试解决问题之前，该问题会经过严格的验证程序。\n\n**1.1. 提取已知条件**\n\n- 总变形梯度由以下乘积给出：\n$$ \\boldsymbol{F}=\\operatorname{diag}(1.1,\\,0.9,\\,1.0)\\,\\begin{bmatrix}1 & 0.2 & 0\\\\ 0 & 1 & 0\\\\ 0 & 0 & 1\\end{bmatrix} $$\n- 变形梯度的塑性部分是一个等体积简单剪切：\n$$ \\boldsymbol{F}_{p}=\\begin{bmatrix}1 & \\gamma_{p} & 0\\\\ 0 & 1 & 0\\\\ 0 & 0 & 1\\end{bmatrix},\\quad \\gamma_{p}=0.1 $$\n- 乘法分解定义为：\n$$ \\boldsymbol{F}=\\boldsymbol{F}_{e}\\,\\boldsymbol{F}_{p} $$\n- 弹性右柯西-格林变形张量定义为：\n$$ \\boldsymbol{C}_{e}=\\boldsymbol{F}_{e}^{\\mathsf{T}}\\,\\boldsymbol{F}_{e} $$\n- 需要计算的量是 $\\boldsymbol{C}_{e}$ 的第一不变量：\n$$ I_{1}(\\boldsymbol{C}_{e})=\\operatorname{tr}(\\boldsymbol{C}_{e}) $$\n\n**1.2. 使用提取的已知条件进行验证**\n\n- **科学依据（关键）：** 该问题牢固地植根于连续介质力学的原理，特别是有限应变塑性。乘法分解 $\\boldsymbol{F}=\\boldsymbol{F}_{e}\\,\\boldsymbol{F}_{p}$ 是该领域中一个标准且基本的概念。所有定义都是标准的。该问题在科学上是合理的。\n- **适定性：** 该问题提供了计算所需量的所有必要定义和数值。运算（矩阵乘法、求逆、转置、求迹）都有明确定义。存在唯一、稳定且有意义的解。该问题是适定的。\n- **客观性（关键）：** 该问题使用精确的数学语言和客观的定义进行陈述。没有主观或模棱两可的术语。该问题是客观的。\n- **完整性和一致性：** 该问题是自洽的。所有变量和常量都有定义。所提供的信息中没有矛盾之处。\n- **其他标准：** 该问题不违反任何其他有效性标准。它不是比喻性的、琐碎的，或超出科学可验证性的范围。\n\n**1.3. 结论与行动**\n\n该问题被判定为 **有效**。将提供一个完整的、有理有据的解答。\n\n### 第二步：求解\n\n求解过程通过系统地应用给定的定义并执行所需的矩阵运算来展开。\n\n**2.1. 计算总变形梯度 $\\boldsymbol{F}$**\n\n首先，我们显式计算总变形梯度 $\\boldsymbol{F}$ 的矩阵。\n对角矩阵为：\n$$ \\operatorname{diag}(1.1,\\,0.9,\\,1.0) = \\begin{bmatrix}1.1 & 0 & 0 \\\\ 0 & 0.9 & 0 \\\\ 0 & 0 & 1.0\\end{bmatrix} $$\n将其与简单剪切矩阵相乘得到：\n$$ \\boldsymbol{F} = \\begin{bmatrix}1.1 & 0 & 0 \\\\ 0 & 0.9 & 0 \\\\ 0 & 0 & 1.0\\end{bmatrix} \\begin{bmatrix}1 & 0.2 & 0 \\\\ 0 & 1 & 0 \\\\ 0 & 0 & 1\\end{bmatrix} $$\n$$ \\boldsymbol{F} = \\begin{bmatrix} (1.1)(1) & (1.1)(0.2) & (1.1)(0) \\\\ (0.9)(0) & (0.9)(1) & (0.9)(0) \\\\ (1.0)(0) & (1.0)(0) & (1.0)(1) \\end{bmatrix} = \\begin{bmatrix} 1.1 & 0.22 & 0 \\\\ 0 & 0.9 & 0 \\\\ 0 & 0 & 1.0 \\end{bmatrix} $$\n\n**2.2. 计算弹性变形梯度 $\\boldsymbol{F}_{e}$**\n\n乘法分解为 $\\boldsymbol{F} = \\boldsymbol{F}_{e} \\boldsymbol{F}_{p}$。为了求出 $\\boldsymbol{F}_{e}$，我们必须重新排列这个方程：\n$$ \\boldsymbol{F}_{e} = \\boldsymbol{F} \\boldsymbol{F}_{p}^{-1} $$\n首先，我们需要求出 $\\boldsymbol{F}_{p}$ 的逆矩阵。塑性变形梯度给出为：\n$$ \\boldsymbol{F}_{p} = \\begin{bmatrix}1 & 0.1 & 0 \\\\ 0 & 1 & 0 \\\\ 0 & 0 & 1\\end{bmatrix} $$\n行列式为 $\\det(\\boldsymbol{F}_{p}) = (1)(1)(1) = 1$。一个 $3 \\times 3$ 矩阵 $\\boldsymbol{A}$ 的逆由 $\\boldsymbol{A}^{-1} = \\frac{1}{\\det(\\boldsymbol{A})} \\operatorname{adj}(\\boldsymbol{A})$ 给出。\n代数余子式矩阵为：\n$$ \\begin{bmatrix} \\begin{vmatrix} 1 & 0 \\\\ 0 & 1 \\end{vmatrix} & -\\begin{vmatrix} 0 & 0 \\\\ 0 & 1 \\end{vmatrix} & \\begin{vmatrix} 0 & 1 \\\\ 0 & 0 \\end{vmatrix} \\\\ -\\begin{vmatrix} 0.1 & 0 \\\\ 0 & 1 \\end{vmatrix} & \\begin{vmatrix} 1 & 0 \\\\ 0 & 1 \\end{vmatrix} & -\\begin{vmatrix} 1 & 0.1 \\\\ 0 & 0 \\end{vmatrix} \\\\ \\begin{vmatrix} 0.1 & 0 \\\\ 1 & 0 \\end{vmatrix} & -\\begin{vmatrix} 1 & 0 \\\\ 0 & 0 \\end{vmatrix} & \\begin{vmatrix} 1 & 0.1 \\\\ 0 & 1 \\end{vmatrix} \\end{bmatrix} = \\begin{bmatrix} 1 & 0 & 0 \\\\ -0.1 & 1 & 0 \\\\ 0 & 0 & 1 \\end{bmatrix} $$\n伴随矩阵是代数余子式矩阵的转置：\n$$ \\operatorname{adj}(\\boldsymbol{F}_{p}) = \\begin{bmatrix} 1 & -0.1 & 0 \\\\ 0 & 1 & 0 \\\\ 0 & 0 & 1 \\end{bmatrix} $$\n由于 $\\det(\\boldsymbol{F}_{p}) = 1$，逆矩阵为：\n$$ \\boldsymbol{F}_{p}^{-1} = \\begin{bmatrix} 1 & -0.1 & 0 \\\\ 0 & 1 & 0 \\\\ 0 & 0 & 1 \\end{bmatrix} $$\n现在我们可以计算 $\\boldsymbol{F}_{e}$：\n$$ \\boldsymbol{F}_{e} = \\boldsymbol{F} \\boldsymbol{F}_{p}^{-1} = \\begin{bmatrix} 1.1 & 0.22 & 0 \\\\ 0 & 0.9 & 0 \\\\ 0 & 0 & 1.0 \\end{bmatrix} \\begin{bmatrix} 1 & -0.1 & 0 \\\\ 0 & 1 & 0 \\\\ 0 & 0 & 1 \\end{bmatrix} $$\n$$ \\boldsymbol{F}_{e} = \\begin{bmatrix} (1.1)(1) + (0.22)(0) & (1.1)(-0.1) + (0.22)(1) & 0 \\\\ 0 & (0.9)(1) & 0 \\\\ 0 & 0 & (1.0)(1) \\end{bmatrix} = \\begin{bmatrix} 1.1 & -0.11 + 0.22 & 0 \\\\ 0 & 0.9 & 0 \\\\ 0 & 0 & 1.0 \\end{bmatrix} $$\n$$ \\boldsymbol{F}_{e} = \\begin{bmatrix} 1.1 & 0.11 & 0 \\\\ 0 & 0.9 & 0 \\\\ 0 & 0 & 1.0 \\end{bmatrix} $$\n\n**2.3. 计算弹性右柯西-格林张量 $\\boldsymbol{C}_{e}$**\n\n定义为 $\\boldsymbol{C}_{e} = \\boldsymbol{F}_{e}^{\\mathsf{T}} \\boldsymbol{F}_{e}$。首先，我们求 $\\boldsymbol{F}_{e}$ 的转置：\n$$ \\boldsymbol{F}_{e}^{\\mathsf{T}} = \\begin{bmatrix} 1.1 & 0.11 & 0 \\\\ 0 & 0.9 & 0 \\\\ 0 & 0 & 1.0 \\end{bmatrix}^{\\mathsf{T}} = \\begin{bmatrix} 1.1 & 0 & 0 \\\\ 0.11 & 0.9 & 0 \\\\ 0 & 0 & 1.0 \\end{bmatrix} $$\n现在，我们进行矩阵乘法：\n$$ \\boldsymbol{C}_{e} = \\begin{bmatrix} 1.1 & 0 & 0 \\\\ 0.11 & 0.9 & 0 \\\\ 0 & 0 & 1.0 \\end{bmatrix} \\begin{bmatrix} 1.1 & 0.11 & 0 \\\\ 0 & 0.9 & 0 \\\\ 0 & 0 & 1.0 \\end{bmatrix} $$\n$$ \\boldsymbol{C}_{e} = \\begin{bmatrix} (1.1)(1.1) & (1.1)(0.11) & 0 \\\\ (0.11)(1.1) & (0.11)(0.11) + (0.9)(0.9) & 0 \\\\ 0 & 0 & (1.0)(1.0) \\end{bmatrix} $$\n$$ \\boldsymbol{C}_{e} = \\begin{bmatrix} 1.21 & 0.121 & 0 \\\\ 0.121 & 0.0121 + 0.81 & 0 \\\\ 0 & 0 & 1.0 \\end{bmatrix} $$\n$$ \\boldsymbol{C}_{e} = \\begin{bmatrix} 1.21 & 0.121 & 0 \\\\ 0.121 & 0.8221 & 0 \\\\ 0 & 0 & 1.0 \\end{bmatrix} $$\n作为检查，$\\boldsymbol{C}_{e}$ 是对称的，根据定义它必须如此。\n\n**2.4. 计算第一不变量 $I_{1}(\\boldsymbol{C}_{e})$**\n\n张量的第一不变量是它的迹，即对角元素之和。\n$$ I_{1}(\\boldsymbol{C}_{e}) = \\operatorname{tr}(\\boldsymbol{C}_{e}) = C_{e,11} + C_{e,22} + C_{e,33} $$\n$$ I_{1}(\\boldsymbol{C}_{e}) = 1.21 + 0.8221 + 1.0 $$\n$$ I_{1}(\\boldsymbol{C}_{e}) = 3.0321 $$\n这就是最终要求的量。它是一个符合要求的精确数值。", "answer": "$$\n\\boxed{3.0321}\n$$", "id": "3566178"}, {"introduction": "在掌握了如何分离弹性应变之后，下一个关键问题是：材料何时开始发生塑性流动？本练习[@problem_id:3566189]将运动学与动力学联系起来，引导您利用弹性应变张量 $\\boldsymbol{C}_e$ 来计算材料内部的应力状态（Mandel应力），并评估一个常用的屈服函数（$J_2$ 屈服准则）。通过这个实践，您将学会如何判断一个给定的变形状态是处于弹性阶段还是已经进入了塑性阶段，这是塑性分析中的一个核心决策步骤。", "problem": "考虑一个有限应变下的各向同性弹塑性固体，其变形梯度具有乘法分解形式 $\\,\\boldsymbol{F} = \\boldsymbol{F}_{e}\\,\\boldsymbol{F}_{p}\\,$。设弹性右柯西-格林张量为 $\\,\\boldsymbol{C}_{e} = \\boldsymbol{F}_{e}^{\\mathsf{T}}\\boldsymbol{F}_{e}\\,$，弹性雅可比行列式为 $\\,J_{e} = \\det(\\boldsymbol{F}_{e}) = \\sqrt{\\det(\\boldsymbol{C}_{e})}\\,$. 假设单位中间构型体积的可压缩neo-Hooke弹性自由能形式为\n$$\n\\psi_{e}(\\boldsymbol{C}_{e},\\alpha) = \\frac{\\mu}{2}\\big(\\mathrm{tr}\\,\\boldsymbol{C}_{e} - 3\\big) - \\mu\\,\\ln J_{e} + \\frac{\\kappa}{2}\\big(\\ln J_{e}\\big)^{2} + \\psi_{\\mathrm{iso}}(\\alpha),\n$$\n其中剪切模量 $\\,\\mu>0\\,$，体积模量 $\\,\\kappa>0\\,$，以及依赖于累积塑性应变 $\\,\\alpha\\,$ 的各向同性硬化势 $\\,\\psi_{\\mathrm{iso}}(\\alpha)\\,$。对于该模型，中间构型中的基尔霍夫应力 $\\,\\boldsymbol{\\tau}\\,$ 满足经过充分检验的关系式\n$$\n\\boldsymbol{\\tau} = \\mu\\big(\\boldsymbol{b}_{e}-\\boldsymbol{I}\\big) + \\kappa\\,\\ln J_{e}\\,\\boldsymbol{I},\n$$\n其中 $\\,\\boldsymbol{b}_{e} = \\boldsymbol{F}_{e}\\boldsymbol{F}_{e}^{\\mathsf{T}}\\,$ 是弹性左柯西-格林张量，$\\,\\boldsymbol{I}\\,$ 是单位张量。Mandel应力定义为 $\\,\\boldsymbol{M} = \\boldsymbol{C}_{e}\\boldsymbol{S}_{e}\\,$，其中 $\\,\\boldsymbol{S}_{e} = 2\\,\\partial \\psi_{e}/\\partial \\boldsymbol{C}_{e}\\,$ 是弹性第二Piola-Kirchhoff应力，它通过 $\\,\\boldsymbol{M} = \\boldsymbol{F}_{e}^{\\mathsf{T}}\\boldsymbol{\\tau}\\,\\boldsymbol{F}_{e}^{-\\mathsf{T}}\\,$ 与 $\\,\\boldsymbol{\\tau}\\,$ 相关联。各向同性 $J_{2}$-塑性的屈服函数取为\n$$\nf(\\boldsymbol{M},\\alpha) = \\sqrt{\\frac{3}{2}}\\left\\|\\mathrm{dev}\\,\\boldsymbol{M}\\right\\| - \\sigma_{y}(\\alpha),\n$$\n其中 $\\,\\mathrm{dev}\\,\\boldsymbol{A} = \\boldsymbol{A} - \\tfrac{1}{3}\\,\\mathrm{tr}(\\boldsymbol{A})\\,\\boldsymbol{I}\\,$，$\\,\\|\\cdot\\|\\,$ 是弗罗贝尼乌斯范数。硬化定律为 $\\,\\sigma_{y}(\\alpha) = \\sigma_{y0} + H\\,\\alpha\\,$，其中常数 $\\,\\sigma_{y0} > 0\\,$ 和 $\\,H \\ge 0\\,$.\n\n考虑一个特殊的弹性状态，其中不存在弹性旋转，因此 $\\,\\boldsymbol{F}_{e}\\,$ 是对称的且 $\\,\\boldsymbol{b}_{e} = \\boldsymbol{C}_{e}\\,$。设\n$$\n\\boldsymbol{C}_{e} = \\mathrm{diag}\\big(1.30,\\,0.75,\\,1.00\\big),\\quad \\alpha = 0.02,\\quad \\mu = 80\\ \\text{MPa},\\quad \\kappa = 160\\ \\text{MPa},\n$$\n及\n$$\n\\sigma_{y0} = 35\\ \\text{MPa},\\quad H = 20\\ \\text{MPa}.\n$$\n\n任务：\n- 从上述定义和关系出发，计算给定 $\\,\\boldsymbol{C}_{e}\\,$ 下的Mandel应力 $\\,\\boldsymbol{M}\\,$。\n- 计算屈服函数 $\\,f(\\boldsymbol{M},\\alpha)\\,$。\n- 根据 $\\,f\\,$ 的符号判断状态是弹性的还是塑性的，并使用标准的Karush-Kuhn-Tucker条件简要说明你的判断依据。\n\n以兆帕（MPa）为单位表示 $\\,f\\,$ 的最终值，并将答案四舍五入到四位有效数字。最终答案必须是一个实数。", "solution": "该问题在连续介质力学和有限应变塑性力学的框架内是适定的且具有科学依据。所有必需的数据和本构关系均已提供，并与既定理论一致。我们可以开始求解。\n\n问题要求计算Mandel应力 $\\boldsymbol{M}$，评估屈服函数 $f(\\boldsymbol{M}, \\alpha)$，并确定给定状态是弹性的还是塑性的。\n\n提供的本构关系如下：\n单位中间构型体积的弹性自由能：\n$$\n\\psi_{e}(\\boldsymbol{C}_{e},\\alpha) = \\frac{\\mu}{2}\\big(\\mathrm{tr}\\,\\boldsymbol{C}_{e} - 3\\big) - \\mu\\,\\ln J_{e} + \\frac{\\kappa}{2}\\big(\\ln J_{e}\\big)^{2} + \\psi_{\\mathrm{iso}}(\\alpha)\n$$\nMandel应力定义为 $\\boldsymbol{M} = \\boldsymbol{C}_{e}\\boldsymbol{S}_{e}$，其中弹性第二Piola-Kirchhoff应力 $\\boldsymbol{S}_{e}$ 由 $\\boldsymbol{S}_{e} = 2\\,\\frac{\\partial \\psi_{e}}{\\partial \\boldsymbol{C}_{e}}$ 给出。\n\n首先，我们从给定的势函数 $\\psi_e$ 推导 $\\boldsymbol{S}_{e}$ 的表达式。使用恒等式 $\\frac{\\partial(\\mathrm{tr}\\,\\boldsymbol{C}_{e})}{\\partial \\boldsymbol{C}_{e}} = \\boldsymbol{I}$ 和 $\\frac{\\partial J_{e}}{\\partial \\boldsymbol{C}_{e}} = \\frac{1}{2}J_{e}\\boldsymbol{C}_{e}^{-1}$，我们有 $\\frac{\\partial(\\ln J_{e})}{\\partial \\boldsymbol{C}_{e}} = \\frac{1}{J_e}\\frac{\\partial J_{e}}{\\partial \\boldsymbol{C}_{e}} = \\frac{1}{2}\\boldsymbol{C}_{e}^{-1}$。\n对 $\\psi_{e}$ 求导可得：\n$$\n\\boldsymbol{S}_{e} = 2\\,\\frac{\\partial \\psi_{e}}{\\partial \\boldsymbol{C}_{e}} = 2\\left[ \\frac{\\mu}{2}\\boldsymbol{I} - \\mu\\left(\\frac{1}{2}\\boldsymbol{C}_{e}^{-1}\\right) + \\frac{\\kappa}{2}(2\\ln J_{e})\\left(\\frac{1}{2}\\boldsymbol{C}_{e}^{-1}\\right) \\right] = \\mu\\,\\boldsymbol{I} + (\\kappa\\,\\ln J_{e} - \\mu)\\boldsymbol{C}_{e}^{-1}\n$$\n现在，我们可以计算Mandel应力 $\\boldsymbol{M}$：\n$$\n\\boldsymbol{M} = \\boldsymbol{C}_{e}\\boldsymbol{S}_{e} = \\boldsymbol{C}_{e}\\big(\\mu\\,\\boldsymbol{I} + (\\kappa\\,\\ln J_{e} - \\mu)\\boldsymbol{C}_{e}^{-1}\\big) = \\mu\\,\\boldsymbol{C}_{e} + (\\kappa\\,\\ln J_{e} - \\mu)\\boldsymbol{I}\n$$\n这可以重排为 $\\boldsymbol{M} = \\mu(\\boldsymbol{C}_{e} - \\boldsymbol{I}) + \\kappa\\,\\ln J_{e}\\,\\boldsymbol{I}$。该表达式与从提供的基尔霍夫应力 $\\boldsymbol{\\tau}$ 关系式以及 $\\boldsymbol{F}_{e}$ 是对称的（这意味着 $\\boldsymbol{b}_{e} = \\boldsymbol{C}_{e}$）这一条件推导出的表达式一致。\n\n屈服函数涉及Mandel应力的偏量 $\\mathrm{dev}\\,\\boldsymbol{M} = \\boldsymbol{M} - \\frac{1}{3}\\mathrm{tr}(\\boldsymbol{M})\\boldsymbol{I}$。我们来求 $\\mathrm{dev}\\,\\boldsymbol{M}$ 的表达式。\n首先，我们求 $\\boldsymbol{M}$ 的迹：\n$$\n\\mathrm{tr}(\\boldsymbol{M}) = \\mathrm{tr}\\big(\\mu\\,\\boldsymbol{C}_{e} + (\\kappa\\,\\ln J_{e} - \\mu)\\boldsymbol{I}\\big) = \\mu\\,\\mathrm{tr}(\\boldsymbol{C}_{e}) + 3(\\kappa\\,\\ln J_{e} - \\mu) = \\mu\\big(\\mathrm{tr}(\\boldsymbol{C}_{e}) - 3\\big) + 3\\kappa\\,\\ln J_{e}\n$$\n$\\boldsymbol{M}$ 的偏量则为：\n$$\n\\mathrm{dev}\\,\\boldsymbol{M} = \\big(\\mu\\,\\boldsymbol{C}_{e} + (\\kappa\\,\\ln J_{e} - \\mu)\\boldsymbol{I}\\big) - \\frac{1}{3}\\big(\\mu(\\mathrm{tr}(\\boldsymbol{C}_{e}) - 3) + 3\\kappa\\,\\ln J_{e}\\big)\\boldsymbol{I}\n$$\n$$\n\\mathrm{dev}\\,\\boldsymbol{M} = \\mu\\,\\boldsymbol{C}_{e} + (\\kappa\\,\\ln J_{e})\\boldsymbol{I} - \\mu\\,\\boldsymbol{I} - \\frac{\\mu}{3}\\mathrm{tr}(\\boldsymbol{C}_{e})\\boldsymbol{I} + \\mu\\,\\boldsymbol{I} - (\\kappa\\,\\ln J_{e})\\boldsymbol{I}\n$$\n$$\n\\mathrm{dev}\\,\\boldsymbol{M} = \\mu\\,\\boldsymbol{C}_{e} - \\frac{\\mu}{3}\\mathrm{tr}(\\boldsymbol{C}_{e})\\boldsymbol{I} = \\mu\\left(\\boldsymbol{C}_{e} - \\frac{1}{3}\\mathrm{tr}(\\boldsymbol{C}_{e})\\boldsymbol{I}\\right) = \\mu\\,\\mathrm{dev}\\,\\boldsymbol{C}_{e}\n$$\n这是一个重要的简化。Mandel应力的偏量部分与弹性右柯西-格林张量的偏量部分成正比。\n\n现在我们使用所提供的数据进行数值计算：$\\mu = 80 \\text{ MPa}$，$\\kappa = 160 \\text{ MPa}$，$\\sigma_{y0} = 35 \\text{ MPa}$，$H = 20 \\text{ MPa}$，$\\alpha = 0.02$，以及 $\\boldsymbol{C}_{e} = \\mathrm{diag}(1.30, 0.75, 1.00)$。\n\n1. 计算 $\\boldsymbol{C}_{e}$ 的迹和偏量：\n   $$\n   \\mathrm{tr}\\,\\boldsymbol{C}_{e} = 1.30 + 0.75 + 1.00 = 3.05\n   $$\n   $$\n   \\frac{1}{3}\\mathrm{tr}\\,\\boldsymbol{C}_{e} = \\frac{3.05}{3}\n   $$\n   $$\n   \\mathrm{dev}\\,\\boldsymbol{C}_{e} = \\boldsymbol{C}_{e} - \\frac{3.05}{3}\\boldsymbol{I} = \\mathrm{diag}\\left(1.30 - \\frac{3.05}{3}, 0.75 - \\frac{3.05}{3}, 1.00 - \\frac{3.05}{3}\\right)\n   $$\n   $$\n   \\mathrm{dev}\\,\\boldsymbol{C}_{e} = \\mathrm{diag}\\left(\\frac{3.90 - 3.05}{3}, \\frac{2.25 - 3.05}{3}, \\frac{3.00 - 3.05}{3}\\right) = \\mathrm{diag}\\left(\\frac{0.85}{3}, -\\frac{0.80}{3}, -\\frac{0.05}{3}\\right)\n   $$\n\n2. 计算Mandel应力的偏量 $\\mathrm{dev}\\,\\boldsymbol{M}$：\n   $$\n   \\mathrm{dev}\\,\\boldsymbol{M} = \\mu\\,\\mathrm{dev}\\,\\boldsymbol{C}_{e} = 80 \\times \\mathrm{diag}\\left(\\frac{0.85}{3}, -\\frac{0.80}{3}, -\\frac{0.05}{3}\\right) = \\mathrm{diag}\\left(\\frac{68}{3}, -\\frac{64}{3}, -\\frac{4}{3}\\right)\n   $$\n\n3. 计算 $\\mathrm{dev}\\,\\boldsymbol{M}$ 的弗罗贝尼乌斯范数：\n   $$\n   \\|\\mathrm{dev}\\,\\boldsymbol{M}\\| = \\sqrt{\\left(\\frac{68}{3}\\right)^{2} + \\left(-\\frac{64}{3}\\right)^{2} + \\left(-\\frac{4}{3}\\right)^{2}} = \\sqrt{\\frac{4624 + 4096 + 16}{9}} = \\sqrt{\\frac{8736}{9}}\n   $$\n\n4. 计算Mandel应力的von Mises等效应力，$\\sqrt{\\frac{3}{2}}\\|\\mathrm{dev}\\,\\boldsymbol{M}\\|$：\n   $$\n   \\sqrt{\\frac{3}{2}}\\|\\mathrm{dev}\\,\\boldsymbol{M}\\| = \\sqrt{\\frac{3}{2} \\times \\frac{8736}{9}} = \\sqrt{\\frac{8736}{6}} = \\sqrt{1456} \\approx 38.157568 \\text{ MPa}\n   $$\n\n5. 计算当前屈服应力 $\\sigma_{y}(\\alpha)$：\n   $$\n   \\sigma_{y}(\\alpha) = \\sigma_{y0} + H\\,\\alpha = 35 + 20 \\times 0.02 = 35 + 0.4 = 35.4 \\text{ MPa}\n   $$\n\n6. 计算屈服函数 $f(\\boldsymbol{M},\\alpha)$：\n   $$\n   f = \\sqrt{\\frac{3}{2}}\\|\\mathrm{dev}\\,\\boldsymbol{M}\\| - \\sigma_{y}(\\alpha) = \\sqrt{1456} - 35.4 \\approx 38.157568 - 35.4 = 2.757568 \\text{ MPa}\n   $$\n   四舍五入到四位有效数字得到 $f \\approx 2.758 \\text{ MPa}$。\n\n7. 确定状态（弹性的或塑性的）：\n   对于率无关塑性，Karush-Kuhn-Tucker (KKT) 条件要求对于任何容许状态，屈服函数必须为非正值，即 $f \\le 0$。如果 $f  0$（且没有塑性流动发生），则状态是弹性的。塑性流动仅在 $f = 0$ 时发生。在弹塑性分析中，状态变量通常通过一个弹性试探步进行更新。如果这个试探步导致的状态满足 $f > 0$，则表明已经超过了弹性极限，该状态是不可容许的。这意味着必须已经发生了塑性变形，以将状态维持在屈服面上。因此，对于给定的类应变状态变量 $(\\boldsymbol{C}_e, \\alpha)$，屈服函数为正值表示材料处于塑性状态。\n   由于我们计算出 $f \\approx 2.758 > 0$，因此给定状态是塑性的。", "answer": "$$\n\\boxed{2.758}\n$$", "id": "3566189"}, {"introduction": "当材料的应力状态超出了屈服面，就必须发生塑性流动以满足一致性条件。这个过程在计算塑性力学中是通过“返回映射算法”来实现的。本编程练习[@problem_id:3566219]将带您深入该算法的核心，通过推导并实现一个牛顿迭代求解器，来计算塑性乘子增量 $\\Delta\\gamma$。这不仅是一个编码任务，更是一次对塑性流动法则如何在数值上得以实施的深刻理解。", "problem": "考虑一个有限应变弹塑性模型，其变形梯度具有乘法分解形式 $\\,\\boldsymbol{F} = \\boldsymbol{F}^{\\mathrm{e}} \\boldsymbol{F}^{\\mathrm{p}}\\,$，其中 $\\,\\boldsymbol{F}^{\\mathrm{e}}\\,$ 是弹性部分，$\\,\\boldsymbol{F}^{\\mathrm{p}}\\,$ 是塑性部分。假设材料是各向同性的，遵循关联流动法则的 von Mises（也称为偏应力第二不变量，$J_{2}$）类型，并采用线性各向同性硬化。令 $\\,\\boldsymbol{\\tau}\\,$ 表示 Kirchhoff 应力，$\\,\\boldsymbol{s} = \\mathrm{dev}\\,\\boldsymbol{\\tau}\\,$ 为其偏量部分，$\\,\\|\\boldsymbol{s}\\|\\,$ 为其欧几里得范数，并令 $\\,\\kappa\\,$ 表示等效塑性应变（无量纲）。屈服函数由偏应力大小定义为\n$$\nf(\\boldsymbol{\\tau},\\kappa) = \\|\\boldsymbol{s}\\| - \\sqrt{\\frac{2}{3}}\\,\\sigma_{y}(\\kappa),\n$$\n其中当前屈服应力随硬化变量线性演化，\n$$\n\\sigma_{y}(\\kappa) = \\sigma_{y0} + H\\,\\kappa,\n$$\n$\\,\\sigma_{y0}\\,$ 是初始屈服应力（单位为帕斯卡），$\\,H\\,$ 是线性硬化模量（单位为帕斯卡）。弹性响应由剪切模量 $\\,\\mu\\,$（单位为帕斯卡）表征。在等体积弹性预测和关联塑性流动（在 von Mises 准则的意义下）的条件下，塑性修正会使 Kirchhoff 应力偏量部分的大小减小，减小量与塑性乘子增量 $\\,\\Delta\\gamma\\,$ 和弹性剪切模量 $\\,\\mu\\,$ 成比例，而硬化变量的增加量与 $\\,\\Delta\\gamma\\,$ 成比例，比例系数为几何因子 $\\,\\sqrt{2/3}\\,$。一致性条件要求，当发生塑性加载时，在增量结束时屈服函数的值为零。\n\n任务：\n- 根据上述基本定义和定律，推导出一个关于未知塑性乘子增量 $\\,\\Delta\\gamma\\,$（无量纲）的标量非线性方程，该方程在有限应变下通过径向返回映射，强制满足带线性各向同性硬化的 von Mises 屈服函数的一致性条件。该方程必须包含试探偏量 Kirchhoff 应力大小 $\\,\\|\\boldsymbol{s}^{\\mathrm{tr}}\\|\\,$（单位为帕斯卡）、剪切模量 $\\,\\mu\\,$、初始屈服应力 $\\,\\sigma_{y0}\\,$、硬化模量 $\\,H\\,$ 和前一硬化变量 $\\,\\kappa_{n}\\,$（无量纲）。\n- 实现一个稳健的一维 Newton 迭代来求解 $\\,\\Delta\\gamma\\,$，该迭代需带有线搜索，以保证 $\\,\\Delta\\gamma\\,$ 的非负性，并确保基于标量方程残差选择的评价函数有足够的下降。如果试探状态是弹性的，算法必须返回 $\\,\\Delta\\gamma = 0\\,$。\n- 使用以下测试套件。每个测试提供参数 $\\,\\mu\\,$、$\\,H\\,$、$\\,\\sigma_{y0}\\,$、$\\,\\kappa_{n}\\,$ 和 $\\,\\|\\boldsymbol{s}^{\\mathrm{tr}}\\|\\,$。所有类似应力的量都必须以帕斯卡（SI单位）为单位，$\\,\\Delta\\gamma\\,$ 必须作为无量纲浮点数返回。\n    1. $\\,\\mu = 80\\times 10^{9}\\,$, $\\,H = 1\\times 10^{9}\\,$, $\\,\\sigma_{y0} = 400\\times 10^{6}\\,$, $\\,\\kappa_{n} = 0.05\\,$, $\\,\\|\\boldsymbol{s}^{\\mathrm{tr}}\\| = 0.9 \\sqrt{\\tfrac{2}{3}}\\big(\\sigma_{y0} + H\\,\\kappa_{n}\\big)\\,$。这是一个弹性情况。\n    2. $\\,\\mu = 80\\times 10^{9}\\,$, $\\,H = 1\\times 10^{9}\\,$, $\\,\\sigma_{y0} = 400\\times 10^{6}\\,$, $\\,\\kappa_{n} = 0.05\\,$, $\\,\\|\\boldsymbol{s}^{\\mathrm{tr}}\\| = \\sqrt{\\tfrac{2}{3}}\\big(\\sigma_{y0} + H\\,\\kappa_{n}\\big) + 50\\times 10^{6}\\,$。这是一个塑性屈服情况。\n    3. $\\,\\mu = 80\\times 10^{9}\\,$, $\\,H = 1\\times 10^{9}\\,$, $\\,\\sigma_{y0} = 400\\times 10^{6}\\,$, $\\,\\kappa_{n} = 0.05\\,$, $\\,\\|\\boldsymbol{s}^{\\mathrm{tr}}\\| = \\sqrt{\\tfrac{2}{3}}\\big(\\sigma_{y0} + H\\,\\kappa_{n}\\big)\\,$。这表示试探状态恰好在屈服面上。\n    4. $\\,\\mu = 80\\times 10^{9}\\,$, $\\,H = 0\\,$, $\\,\\sigma_{y0} = 400\\times 10^{6}\\,$, $\\,\\kappa_{n} = 0.20\\,$, $\\,\\|\\boldsymbol{s}^{\\mathrm{tr}}\\| = \\sqrt{\\tfrac{2}{3}}\\big(\\sigma_{y0}\\big) + 100\\times 10^{6}\\,$。这是一个理想塑性情况。\n    5. $\\,\\mu = 80\\times 10^{9}\\,$, $\\,H = 10\\times 10^{9}\\,$, $\\,\\sigma_{y0} = 300\\times 10^{6}\\,$, $\\,\\kappa_{n} = 0.20\\,$, $\\,\\|\\boldsymbol{s}^{\\mathrm{tr}}\\| = \\sqrt{\\tfrac{2}{3}}\\big(\\sigma_{y0} + H\\,\\kappa_{n}\\big) + 10\\times 10^{6}\\,$。这个测试用于检验硬硬化情况。\n- 您的程序必须不接受任何输入，并且必须生成单行输出，其中包含用方括号括起来的逗号分隔的结果列表（例如，$[\\Delta\\gamma_{1},\\Delta\\gamma_{2},\\Delta\\gamma_{3},\\Delta\\gamma_{4},\\Delta\\gamma_{5}]$）。每个条目是相应测试用例计算出的 $\\,\\Delta\\gamma\\,$，单位为无量纲。\n\n推导和算法必须基于上述定义和定律，不得使用省略推理过程的简化公式。实现必须包括：弹性试探状态的检测、一个强制 $\\,\\Delta\\gamma \\ge 0\\,$ 并确保评价函数充分下降的带线搜索的 Newton 迭代，以及基于残差容差的终止条件。", "solution": "根据指定标准，该问题被评估为有效。它在科学上基于成熟的连续介质塑性理论，是适定的、客观的，并包含获得唯一解所需的所有必要信息。\n\n任务是推导并实现一个数值算法，用于求解有限应变 J2 塑性模型（带线性各向同性硬化）的塑性乘子增量 Δγ。问题的核心是求解标量一致性方程，以确保最终应力状态位于更新后的屈服面上。\n\n对于给定的载荷增量，求解 Δγ 的算法被称为返回映射算法，它包括两个主要阶段：弹性预测和塑性修正。\n\n1.  **弹性预测和塑性检查**\n    该过程首先假设整个变形增量是弹性的。这给出了一个试探应力状态，其特征是试探偏量 Kirchhoff 应力 $\\boldsymbol{s}^{\\mathrm{tr}}$。增量开始时的材料状态由累积的等效塑性应变 $\\kappa_n$ 定义。相应的屈服应力为 $\\sigma_y(\\kappa_n) = \\sigma_{y0} + H\\kappa_n$。\n\n    在此试探状态下评估 von Mises 屈服函数：\n    $$\n    f^{\\mathrm{tr}} = f(\\boldsymbol{\\tau}^{\\mathrm{tr}}, \\kappa_n) = \\|\\boldsymbol{s}^{\\mathrm{tr}}\\| - \\sqrt{\\frac{2}{3}}\\sigma_{y}(\\kappa_n)\n    $$\n    如果 $f^{\\mathrm{tr}} \\le 0$，则试探状态在屈服面内或屈服面上。弹性假设是正确的，该步是弹性的（或中性加载），没有塑性变形发生。因此，塑性乘子增量为 $\\Delta\\gamma = 0$。\n\n2.  **塑性修正和一致性方程推导**\n    如果 $f^{\\mathrm{tr}}  0$，则试探状态在屈服面之外，这在物理上是不允许的。必须发生塑性变形，以使应力状态返回到更新后的屈服面上。这需要找到一个非零的塑性乘子增量 $\\Delta\\gamma  0$。增量结束时的最终状态（用下标 $n+1$ 表示）必须满足一致性条件：\n    $$\n    f(\\boldsymbol{\\tau}_{n+1}, \\kappa_{n+1}) = \\|\\boldsymbol{s}_{n+1}\\| - \\sqrt{\\frac{2}{3}}\\sigma_{y}(\\kappa_{n+1}) = 0\n    $$\n    为了求解 $\\Delta\\gamma$，我们必须将 $\\|\\boldsymbol{s}_{n+1}\\|$ 和 $\\kappa_{n+1}$ 表示为 $\\Delta\\gamma$ 的函数。\n\n    **应力更新（径向返回）：**\n    对于关联流动法则，塑性应变率垂直于屈服面。使用后向欧拉积分格式，步末的偏量 Kirchhoff 应力 $\\boldsymbol{s}_{n+1}$ 与试探应力 $\\boldsymbol{s}^{\\mathrm{tr}}$ 的关系如下：\n    $$\n    \\boldsymbol{s}_{n+1} = \\boldsymbol{s}^{\\mathrm{tr}} - 2\\mu\\Delta\\boldsymbol{\\epsilon}^{\\mathrm{p}}_{\\mathrm{d}}\n    $$\n    其中 $\\Delta\\boldsymbol{\\epsilon}^{\\mathrm{p}}_{\\mathrm{d}}$ 是偏量塑性应变的增量。关联流动法则将其与塑性乘子增量 $\\Delta\\gamma$ 和流动方向 $\\boldsymbol{N}_{n+1}$ 联系起来：\n    $$\n    \\Delta\\boldsymbol{\\epsilon}^{\\mathrm{p}}_{\\mathrm{d}} = \\Delta\\gamma \\boldsymbol{N}_{n+1} = \\Delta\\gamma \\frac{\\boldsymbol{s}_{n+1}}{\\|\\boldsymbol{s}_{n+1}\\|}\n    $$\n    将此代入应力更新方程，得到 $\\boldsymbol{s}_{n+1}$ 的一个隐式关系：\n    $$\n    \\boldsymbol{s}_{n+1} = \\boldsymbol{s}^{\\mathrm{tr}} - 2\\mu\\Delta\\gamma \\frac{\\boldsymbol{s}_{n+1}}{\\|\\boldsymbol{s}_{n+1}\\|}\n    $$\n    重新整理各项，我们得到：\n    $$\n    \\boldsymbol{s}_{n+1} \\left(1 + \\frac{2\\mu\\Delta\\gamma}{\\|\\boldsymbol{s}_{n+1}\\|}\\right) = \\boldsymbol{s}^{\\mathrm{tr}}\n    $$\n    这个方程表明 $\\boldsymbol{s}_{n+1}$ 和 $\\boldsymbol{s}^{\\mathrm{tr}}$ 是共线的，意味着它们方向相同。因此，我们可以写成 $\\boldsymbol{s}_{n+1} = c \\boldsymbol{s}^{\\mathrm{tr}}$，其中 c 是某个标量。对重新整理后的方程两边取欧几里得范数，得到：\n    $$\n    \\|\\boldsymbol{s}_{n+1}\\| \\left(1 + \\frac{2\\mu\\Delta\\gamma}{\\|\\boldsymbol{s}_{n+1}\\|}\\right) = \\|\\boldsymbol{s}^{\\mathrm{tr}}\\| \\implies \\|\\boldsymbol{s}_{n+1}\\| + 2\\mu\\Delta\\gamma = \\|\\boldsymbol{s}^{\\mathrm{tr}}\\|\n    $$\n    这就得出了偏应力大小的显式径向返回公式：\n    $$\n    \\|\\boldsymbol{s}_{n+1}\\| = \\|\\boldsymbol{s}^{\\mathrm{tr}}\\| - 2\\mu\\Delta\\gamma\n    $$\n\n    **硬化变量更新：**\n    问题陈述，硬化变量的增量 $\\Delta\\kappa$ 通过 $\\Delta\\kappa = \\sqrt{2/3}\\Delta\\gamma$ 与 $\\Delta\\gamma$ 成比例。该关系源于塑性功等效原理。因此，步末的硬化变量为：\n    $$\n    \\kappa_{n+1} = \\kappa_n + \\Delta\\kappa = \\kappa_n + \\sqrt{\\frac{2}{3}}\\Delta\\gamma\n    $$\n    相应的屈服应力为 $\\sigma_y(\\kappa_{n+1}) = \\sigma_{y0} + H\\kappa_{n+1}$。\n\n    **标量一致性方程：**\n    将 $\\|\\boldsymbol{s}_{n+1}\\|$ 和 $\\kappa_{n+1}$ 的表达式代入一致性条件 $f(\\boldsymbol{\\tau}_{n+1}, \\kappa_{n+1}) = 0$，得到关于 $\\Delta\\gamma$ 的标量方程：\n    $$\n    \\left(\\|\\boldsymbol{s}^{\\mathrm{tr}}\\| - 2\\mu\\Delta\\gamma\\right) - \\sqrt{\\frac{2}{3}}\\left(\\sigma_{y0} + H\\left(\\kappa_n + \\sqrt{\\frac{2}{3}}\\Delta\\gamma\\right)\\right) = 0\n    $$\n    这就是必须求解 $\\Delta\\gamma$ 的方程。我们定义一个残差函数 $R(\\Delta\\gamma)$，其根就是所需的解：\n    $$\n    R(\\Delta\\gamma) = \\|\\boldsymbol{s}^{\\mathrm{tr}}\\| - 2\\mu\\Delta\\gamma - \\sqrt{\\frac{2}{3}}\\left(\\sigma_{y0} + H\\kappa_n\\right) - \\frac{2}{3}H\\Delta\\gamma\n    $$\n    将各项分组，我们可以写成：\n    $$\n    R(\\Delta\\gamma) = \\left(\\|\\boldsymbol{s}^{\\mathrm{tr}}\\| - \\sqrt{\\frac{2}{3}}\\sigma_{y}(\\kappa_n)\\right) - \\left(2\\mu + \\frac{2}{3}H\\right)\\Delta\\gamma\n    $$\n    认识到第一项是试探屈服函数值 $f^{\\mathrm{tr}}$，我们有：\n    $$\n    R(\\Delta\\gamma) = f^{\\mathrm{tr}} - \\left(2\\mu + \\frac{2}{3}H\\right)\\Delta\\gamma\n    $$\n    对于指定的线性硬化情况，这是一个关于 $\\Delta\\gamma$ 的线性方程。尽管它有直接的解析解，但问题要求实现一个 Newton-Raphson 求解器，这是一种也适用于非线性硬化定律的通用方法。\n\n3.  **带线搜索的 Newton-Raphson 方法**\n    我们使用 Newton 法求解 $R(\\Delta\\gamma) = 0$。迭代格式为：\n    $$\n    \\Delta\\gamma_{k+1} = \\Delta\\gamma_k - \\frac{R(\\Delta\\gamma_k)}{R'(\\Delta\\gamma_k)}\n    $$\n    残差函数关于 $\\Delta\\gamma$ 的导数是常数：\n    $$\n    R'(\\Delta\\gamma) = -\\left(2\\mu + \\frac{2}{3}H\\right)\n    $$\n    在第 k 次迭代的搜索方向是 $p_k = -R(\\Delta\\gamma_k)/R'(\\Delta\\gamma_k)$。为了确保稳健性，引入了线搜索，得到更新式 $\\Delta\\gamma_{k+1} = \\Delta\\gamma_k + \\alpha_k p_k$，其中 $\\alpha_k \\in (0, 1]$ 是步长。\n\n    线搜索（回溯法）找到一个满足两个条件的 $\\alpha_k$：\n    1.  **非负性**: $\\Delta\\gamma_{k+1} \\geq 0$。\n    2.  **充分下降（Armijo 条件）**: 一个评价函数 $M(\\Delta\\gamma) = \\frac{1}{2}R(\\Delta\\gamma)^2$ 必须充分下降。这通过不等式 $M(\\Delta\\gamma_k + \\alpha_k p_k) \\le M(\\Delta\\gamma_k) + c_1 \\alpha_k \\nabla M(\\Delta\\gamma_k) \\cdot p_k$ 来检查，其中 $c_1$ 是一个小常数（例如 $10^{-4}$）。\n\n    算法从一个初始猜测 $\\Delta\\gamma_0 = 0$ 开始。对于线性残差，一个完整的 Newton 步（$\\alpha_k=1$）可以在一次迭代中找到精确解。所实现的代码遵循了完整的框架，包括按要求进行的线搜索。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef compute_delta_gamma(mu, H, sigma_y0, kappa_n, s_tr_norm):\n    \"\"\"\n    Computes the plastic multiplier increment Δγ using a Newton-Raphson method\n    with a line search for J2 plasticity with linear isotropic hardening.\n\n    Args:\n        mu (float): Shear modulus in Pascals.\n        H (float): Linear hardening modulus in Pascals.\n        sigma_y0 (float): Initial yield stress in Pascals.\n        kappa_n (float): Equivalent plastic strain at the start of the increment.\n        s_tr_norm (float): Euclidean norm of the trial deviatoric Kirchhoff stress in Pascals.\n\n    Returns:\n        float: The computed plastic multiplier increment Δγ (dimensionless).\n    \"\"\"\n    # Constants for the numerical solver\n    TOL = 1e-9  # Tolerance for the residual\n    MAX_ITER = 10  # Maximum number of Newton iterations\n    C1_ARMIJO = 1e-4  # Parameter for Armijo condition in line search\n    SQRT2_3 = np.sqrt(2.0/3.0)\n\n    # Step 1: Evaluate the yield function at the trial state to check for plastic loading.\n    sigma_y_n = sigma_y0 + H * kappa_n\n    f_tr = s_tr_norm - SQRT2_3 * sigma_y_n\n\n    # If f_tr = 0, the step is elastic or neutral. No plastic deformation occurs.\n    if f_tr = 0.0:\n        return 0.0\n\n    # Step 2: For f_tr > 0, set up and run the Newton-Raphson solver.\n    # The unknown is the plastic multiplier increment, delta_gamma.\n    delta_gamma = 0.0\n\n    # Define the residual function R(Δγ) and its constant derivative R'(Δγ).\n    # R(Δγ) = ||s_n+1|| - sqrt(2/3)σ_y(κ_n+1) = 0\n    # where ||s_n+1|| = ||s^tr|| - 2μΔγ and κ_n+1 = κ_n + sqrt(2/3)Δγ.\n    def R(dg):\n        \"\"\"Scalar residual function for the consistency condition.\"\"\"\n        s_norm_updated = s_tr_norm - 2.0 * mu * dg\n        sigma_y_updated = sigma_y0 + H * (kappa_n + SQRT2_3 * dg)\n        return s_norm_updated - SQRT2_3 * sigma_y_updated\n\n    # The derivative is constant for linear hardening.\n    R_prime = - (2.0 * mu + (2.0/3.0) * H)\n\n    for _ in range(MAX_ITER):\n        # Calculate the residual at the current guess for delta_gamma.\n        residual = R(delta_gamma)\n\n        # Check for convergence.\n        if abs(residual)  TOL:\n            break\n\n        # Calculate the Newton search direction.\n        p_k = -residual / R_prime\n\n        # Step 3: Perform a line search (backtracking) to ensure robustness.\n        alpha = 1.0  # Start with a full Newton step.\n        current_merit = 0.5 * residual**2\n        # For a Newton step, the directional derivative of the merit function is -residual^2.\n        slope_term = - (residual**2)\n\n        while True:\n            trial_delta_gamma = delta_gamma + alpha * p_k\n\n            # Ensure the update is non-negative.\n            if trial_delta_gamma  0.0:\n                alpha /= 2.0\n                continue\n\n            # Check the Armijo condition for sufficient decrease of the merit function.\n            trial_merit = 0.5 * R(trial_delta_gamma)**2\n            if trial_merit = current_merit + C1_ARMIJO * alpha * slope_term:\n                break\n            \n            # If condition not met, reduce the step size.\n            alpha /= 2.0\n\n            # Failsafe for the line search. Should not be triggered for this problem.\n            if alpha  1e-10:\n                break\n\n        # Update the solution.\n        delta_gamma += alpha * p_k\n\n    return delta_gamma\n\ndef solve():\n    \"\"\"\n    Main function to run the specified test suite and print results.\n    \"\"\"\n    SQRT2_3 = np.sqrt(2.0/3.0)\n    \n    # Each tuple contains: (μ, H, σ_y0, κ_n, ||s^tr||)\n    test_cases = [\n        # Test Case 1: Elastic case. ||s^tr|| is 90% of the yield radius.\n        (80e9, 1e9, 400e6, 0.05, 0.9 * SQRT2_3 * (400e6 + 1e9 * 0.05)),\n\n        # Test Case 2: Plastically yielding case.\n        (80e9, 1e9, 400e6, 0.05, SQRT2_3 * (400e6 + 1e9 * 0.05) + 50e6),\n\n        # Test Case 3: Trial state exactly on the yield surface.\n        (80e9, 1e9, 400e6, 0.05, SQRT2_3 * (400e6 + 1e9 * 0.05)),\n\n        # Test Case 4: Perfectly plastic case (H=0).\n        (80e9, 0, 400e6, 0.20, SQRT2_3 * 400e6 + 100e6),\n\n        # Test Case 5: Stiff hardening case.\n        (80e9, 10e9, 300e6, 0.20, SQRT2_3 * (300e6 + 10e9 * 0.20) + 10e6)\n    ]\n    \n    results = []\n    for case in test_cases:\n        # Unpack the case parameters and call the solver.\n        result = compute_delta_gamma(*case)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3566219"}]}