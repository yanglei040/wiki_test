{"hands_on_practices": [{"introduction": "直接时间积分方法的核心在于逐步推进求解动力学方程。本练习将引导你使用中心差分法——一种简单而有效的显式方法——来求解一个多自由度系统的自由振动响应。通过这个实践，你不仅能掌握该方法的计算步骤，更重要的是，你将深入理解条件稳定性这一关键概念，即将数值积分的步长与系统的物理特性（最高固有频率）联系起来。", "problem": "考虑一个由牛顿第二定律支配的二自由度 (DOF) 集总参数结构模型，其矩阵形式写作 $M \\ddot{u}(t) + C \\dot{u}(t) + K u(t) = f(t)$，其中 $M$ 是质量矩阵，$C$ 是阻尼矩阵，$K$ 是刚度矩阵，$u(t)$ 是位移向量，$f(t)$ 是外力向量。系统数据为 $M=\\mathrm{diag}(1,1)$ kg, $K=\\begin{bmatrix}2000  -1000\\\\ -1000  2000\\end{bmatrix}$ N/m, $C=\\begin{bmatrix}0  0\\\\ 0  0\\end{bmatrix}$, 以及 $f(t)=\\begin{bmatrix}0\\\\0\\end{bmatrix}$。初始位移和初始速度分别为 $u^{0}=\\begin{bmatrix}1\\\\0\\end{bmatrix}$ mm 和 $\\dot{u}^{0}=\\begin{bmatrix}0\\\\0\\end{bmatrix}$ mm/s。设均匀时间步长为 $\\Delta t = 0.001$ s。\n\n从控制方程出发，使用关于时间 $t^{n}$ 的泰勒级数展开，推导推进无阻尼自由振动响应所需的显式中心差分更新公式。使用这些公式根据给定的初始条件计算前两个位移状态 $u^{1}$ 和 $u^{2}$。将 $u^{1}$ 和 $u^{2}$ 以毫米为单位表示，并将每个分量四舍五入至七位有效数字。\n\n然后，通过广义特征值问题 $K \\phi = \\lambda M \\phi$（其中 $\\omega = \\sqrt{\\lambda}$）确定离散系统的最大无阻尼自振圆频率 $\\omega_{\\max}$，从而评估显式积分的稳定性。计算中心差分法的临界时间步长 $\\Delta t_{\\mathrm{cr}} = 2 / \\omega_{\\max}$，并构建无量纲稳定性比率 $r = \\Delta t / \\Delta t_{\\mathrm{cr}}$。根据 $r$ 的值，判断所选的 $\\Delta t$ 是否稳定。\n\n将 $r$ 的最终值报告为一个四舍五入到五位有效数字的数值。$r$ 不需要单位。", "solution": "该问题陈述经评估有效。它在科学上基于结构动力学和计算力学的原理，问题设定良好，数据完整一致，并以客观、正式的语言表述。所有必要信息均已提供，且无矛盾之处。\n\n无阻尼自由振动系统的运动控制方程由牛顿第二定律以矩阵形式给出：\n$$\nM \\ddot{u}(t) + K u(t) = 0\n$$\n其中 $M$ 是质量矩阵，$K$ 是刚度矩阵，$u(t)$ 是位移向量。所有计算将使用国际单位制（米、千克、秒、牛顿）。初始条件被转换为国际单位制：\n$$\nu^{0} = \\begin{bmatrix} 1 \\\\ 0 \\end{bmatrix} \\text{ mm} = \\begin{bmatrix} 0.001 \\\\ 0 \\end{bmatrix} \\text{ m}\n$$\n$$\n\\dot{u}^{0} = \\begin{bmatrix} 0 \\\\ 0 \\end{bmatrix} \\text{ mm/s} = \\begin{bmatrix} 0 \\\\ 0 \\end{bmatrix} \\text{ m/s}\n$$\n给定的系统矩阵和时间步长为：\n$$\nM = \\begin{bmatrix} 1  0 \\\\ 0  1 \\end{bmatrix} \\text{ kg}, \\quad K = \\begin{bmatrix} 2000  -1000 \\\\ -1000  2000 \\end{bmatrix} \\text{ N/m}, \\quad \\Delta t = 0.001 \\text{ s}\n$$\n由于 $M$ 是单位矩阵 $I$，运动方程简化为 $\\ddot{u}(t) + K u(t) = 0$。\n\n首先，我们推导中心差分更新公式。由 $u(t^{n+1})$ 和 $u(t^{n-1})$ 在 $t^n$ 处的泰勒级数展开，可得到在时间 $t^n = n \\Delta t$ 处加速度的中心差分近似为：\n$$\n\\ddot{u}^n \\approx \\frac{u^{n+1} - 2u^n + u^{n-1}}{(\\Delta t)^2}\n$$\n将此代入时间 $t^n$ 处的运动方程 $M \\ddot{u}^n + K u^n = 0$，得到：\n$$\nM \\left( \\frac{u^{n+1} - 2u^n + u^{n-1}}{(\\Delta t)^2} \\right) + K u^n = 0\n$$\n重新整理以求解下一时间步的位移 $u^{n+1}$，得到显式更新公式：\n$$\nM u^{n+1} = (2M - (\\Delta t)^2 K) u^n - M u^{n-1}\n$$\n由于 $M=I$，该公式简化为：\n$$\nu^{n+1} = (2I - (\\Delta t)^2 K) u^n - u^{n-1}\n$$\n此公式需要一个特殊的启动程序，因为在第一步（$n=0$）时，需要一个虚拟时间 $t^{-1}=-\\Delta t$ 处的位移 $u^{-1}$。我们可以利用初始条件来求得 $u^{-1}$。初始速度 $\\dot{u}^0$ 的中心差分近似为：\n$$\n\\dot{u}^0 \\approx \\frac{u^1 - u^{-1}}{2 \\Delta t} \\implies u^{-1} = u^1 - 2 \\Delta t \\dot{u}^0\n$$\n根据 $u(t)$ 在 $t=0$ 处的泰勒展开，我们有 $u(-\\Delta t) \\approx u(0) - \\Delta t \\dot{u}(0) + \\frac{(\\Delta t)^2}{2} \\ddot{u}(0)$。因此，\n$$\nu^{-1} \\approx u^0 - \\Delta t \\dot{u}^0 + \\frac{(\\Delta t)^2}{2} \\ddot{u}^0\n$$\n初始加速度 $\\ddot{u}^0$ 可由 $t=0$ 时的运动方程 $M \\ddot{u}^0 + K u^0 = 0$ 求得，即 $\\ddot{u}^0 = -M^{-1} K u^0$。\n考虑到 $\\dot{u}^0=0$，$u^{-1}$ 的表达式简化为 $u^{-1} = u^0 + \\frac{(\\Delta t)^2}{2} \\ddot{u}^0$。\n将此代入 $n=0$ 时的通用更新公式：\n$$\nu^1 = (2I - (\\Delta t)^2 K) u^0 - u^{-1} = (2I - (\\Delta t)^2 K) u^0 - \\left(u^0 + \\frac{(\\Delta t)^2}{2} \\ddot{u}^0 \\right)\n$$\n$$\nu^1 = u^0 - (\\Delta t)^2 K u^0 - \\frac{(\\Delta t)^2}{2} (-K u^0) = u^0 - \\frac{(\\Delta t)^2}{2} K u^0 = \\left( I - \\frac{(\\Delta t)^2}{2} K \\right) u^0\n$$\n这就是用于计算第一个位移状态 $u^1$ 的专门公式。\n\n现在，我们计算位移。\n首先，我们预先计算矩阵 $(2I - (\\Delta t)^2 K)$：\n$$\n(\\Delta t)^2 = (0.001)^2 = 10^{-6}\n$$\n$$\n(\\Delta t)^2 K = 10^{-6} \\begin{bmatrix} 2000  -1000 \\\\ -1000  2000 \\end{bmatrix} = \\begin{bmatrix} 0.002  -0.001 \\\\ -0.001  0.002 \\end{bmatrix}\n$$\n$$\n2I - (\\Delta t)^2 K = \\begin{bmatrix} 2  0 \\\\ 0  2 \\end{bmatrix} - \\begin{bmatrix} 0.002  -0.001 \\\\ -0.001  0.002 \\end{bmatrix} = \\begin{bmatrix} 1.998  0.001 \\\\ 0.001  1.998 \\end{bmatrix}\n$$\n接下来，我们使用上面推导的启动公式计算 $u^1$（并注意到 $\\dot{u}^0=0$）：\n$$\n\\frac{(\\Delta t)^2}{2} K u^0 = \\frac{10^{-6}}{2} \\begin{bmatrix} 2000  -1000 \\\\ -1000  2000 \\end{bmatrix} \\begin{bmatrix} 0.001 \\\\ 0 \\end{bmatrix} = 0.5 \\times 10^{-6} \\begin{bmatrix} 2 \\\\ -1 \\end{bmatrix} = \\begin{bmatrix} 10^{-6} \\\\ -0.5 \\times 10^{-6} \\end{bmatrix}\n$$\n$$\nu^1 = u^0 - \\frac{(\\Delta t)^2}{2} K u^0 = \\begin{bmatrix} 0.001 \\\\ 0 \\end{bmatrix} - \\begin{bmatrix} 0.000001 \\\\ -0.0000005 \\end{bmatrix} = \\begin{bmatrix} 0.000999 \\\\ 0.0000005 \\end{bmatrix} \\text{ m}\n$$\n为了计算 $u^2$，我们使用 $n=1$ 时的通用更新公式：\n$$\nu^2 = (2I - (\\Delta t)^2 K) u^1 - u^0\n$$\n$$\nu^2 = \\begin{bmatrix} 1.998  0.001 \\\\ 0.001  1.998 \\end{bmatrix} \\begin{bmatrix} 0.000999 \\\\ 0.0000005 \\end{bmatrix} - \\begin{bmatrix} 0.001 \\\\ 0 \\end{bmatrix}\n$$\n矩阵-向量乘积为：\n$$\n\\begin{bmatrix} 1.998 \\times 0.000999 + 0.001 \\times 0.0000005 \\\\ 0.001 \\times 0.000999 + 1.998 \\times 0.0000005 \\end{bmatrix} = \\begin{bmatrix} 0.001996002 + 0.0000000005 \\\\ 0.000000999 + 0.000000999 \\end{bmatrix} = \\begin{bmatrix} 0.0019960025 \\\\ 0.000001998 \\end{bmatrix}\n$$\n$$\nu^2 = \\begin{bmatrix} 0.0019960025 \\\\ 0.000001998 \\end{bmatrix} - \\begin{bmatrix} 0.001 \\\\ 0 \\end{bmatrix} = \\begin{bmatrix} 0.0009960025 \\\\ 0.000001998 \\end{bmatrix} \\text{ m}\n$$\n将结果转换为毫米并四舍五入到七位有效数字：\n$$\nu^1 = \\begin{bmatrix} 0.9990000 \\\\ 0.0005000000 \\end{bmatrix} \\text{ mm}\n$$\n$$\nu^2 = \\begin{bmatrix} 0.9960025 \\\\ 0.001998000 \\end{bmatrix} \\text{ mm}\n$$\n\n最后，我们评估积分的稳定性。这需要从广义特征值问题 $K \\phi = \\lambda M \\phi$ 中找出系统的最大无阻尼自振圆频率 $\\omega_{\\max}$。由于 $M=I$，这是一个标准的特征值问题 $K \\phi = \\lambda \\phi$。特征值 $\\lambda = \\omega^2$ 可通过特征方程 $\\det(K - \\lambda I) = 0$ 求得：\n$$\n\\det \\begin{bmatrix} 2000-\\lambda  -1000 \\\\ -1000  2000-\\lambda \\end{bmatrix} = 0\n$$\n$$\n(2000-\\lambda)^2 - (-1000)^2 = 0 \\implies (2000-\\lambda)^2 = 1000^2\n$$\n这给出了 $(2000-\\lambda)$ 的两个解：\n$$\n2000 - \\lambda_1 = 1000 \\implies \\lambda_1 = 1000\n$$\n$$\n2000 - \\lambda_2 = -1000 \\implies \\lambda_2 = 3000\n$$\n自振圆频率为 $\\omega_1 = \\sqrt{\\lambda_1} = \\sqrt{1000}$ rad/s 和 $\\omega_2 = \\sqrt{\\lambda_2} = \\sqrt{3000}$ rad/s。最大频率是：\n$$\n\\omega_{\\max} = \\sqrt{3000} \\approx 54.7722558 \\text{ rad/s}\n$$\n中心差分法的临界时间步长由 $\\Delta t_{\\mathrm{cr}} = 2 / \\omega_{\\max}$ 给出：\n$$\n\\Delta t_{\\mathrm{cr}} = \\frac{2}{\\sqrt{3000}} \\approx 0.0365148 \\text{ s}\n$$\n无量纲稳定性比率 $r$ 是所选时间步长与临界时间步长之比：\n$$\nr = \\frac{\\Delta t}{\\Delta t_{\\mathrm{cr}}} = \\frac{0.001}{2 / \\sqrt{3000}} = \\frac{0.001 \\sqrt{3000}}{2} = 0.0005 \\sqrt{3000}\n$$\n该值的数值为：\n$$\nr \\approx 0.0273861279\n$$\n对于无阻尼系统，中心差分法的稳定性条件是 $\\Delta t \\le \\Delta t_{\\mathrm{cr}}$，这等价于 $r \\le 1$。由于我们计算出的值是 $r \\approx 0.02739 \\ll 1$，因此所选的时间步长 $\\Delta t = 0.001$ s 是稳定的。\n\n将 $r$ 的最终值四舍五入到五位有效数字，得到 $0.027386$。", "answer": "$$\\boxed{0.027386}$$", "id": "3558173"}, {"introduction": "与显式方法不同，隐式方法通常具有更优的稳定性，允许使用更大的时间步长。本练习将介绍在结构动力学中占有核心地位的Newmark方法族，这是一种强大的隐式算法。你将通过求解一个受迫阻尼振子的运动，学习如何构建和求解每个时间步的“有效刚度”系统，这是隐式方法的一个标志性特征。", "problem": "考虑计算固体力学中一个阻尼振子的线性单自由度 (SDOF) 运动方程，\n$$\nm\\,\\ddot{u}(t) + c\\,\\dot{u}(t) + k\\,u(t) = f(t),\n$$\n其质量 $m=1$ kg，粘性阻尼系数 $c=0.2$ N s/m，刚度 $k=100$ N/m，外载荷 $f(t)=10\\sin(5t)$ N。使用 Newmark 族直接时间积分方法的一个时间步，参数为 $(\\beta,\\gamma)=(\\tfrac{1}{4},\\tfrac{1}{2})$，时间步长 $\\Delta t=0.01$ s，从 $t^n=0.01$ s 推进到 $t^{n+1}=0.02$ s，计算在时间 $t^{n+1}$ 时的位移 $u^{n+1}$。在时间 $t^n$ 的给定状态为 $u^n=0$，$\\dot{u}^n=0$，以及 $\\ddot{u}^n=f^n/m$，其中 $f^n=f(t^n)$。在进行数值计算之前，请从半离散运动方程和 Newmark 族的定义出发，建立在 $t^{n+1}$ 时的离散平衡方程。\n\n最终位移以米为单位表示，并将您的答案四舍五入到六位有效数字。", "solution": "分析问题陈述，认定其有效。该问题在科学上基于结构动力学原理，给出了所有必要信息，问题提法完善，语言客观。问题是自洽的，没有矛盾。我们可以开始求解。\n\n任务是使用 Newmark 直接时间积分法的一个步长，计算单自由度 (SDOF) 系统在时间 $t^{n+1}$ 的位移 $u^{n+1}$。\n\n该 SDOF 系统的半离散运动方程由下式给出：\n$$\nm\\,\\ddot{u}(t) + c\\,\\dot{u}(t) + k\\,u(t) = f(t)\n$$\n在离散时间 $t^{n+1}$，该方程写作：\n$$\nm\\,\\ddot{u}^{n+1} + c\\,\\dot{u}^{n+1} + k\\,u^{n+1} = f^{n+1}\n$$\n其中 $u^{n+1} = u(t^{n+1})$，$\\dot{u}^{n+1} = \\dot{u}(t^{n+1})$，$\\ddot{u}^{n+1} = \\ddot{u}(t^{n+1})$，以及 $f^{n+1} = f(t^{n+1})$。\n\nNewmark 族方法提供了位移和速度的更新法则：\n$$\nu^{n+1} = u^n + \\Delta t\\,\\dot{u}^n + \\Delta t^2 \\left[ \\left(\\frac{1}{2} - \\beta\\right)\\ddot{u}^n + \\beta\\,\\ddot{u}^{n+1} \\right] \\quad (1)\n$$\n$$\n\\dot{u}^{n+1} = \\dot{u}^n + \\Delta t \\left[ (1 - \\gamma)\\ddot{u}^n + \\gamma\\,\\ddot{u}^{n+1} \\right] \\quad (2)\n$$\n目标是求解未知位移 $u^{n+1}$。为此，我们首先用 $u^{n+1}$ 和时间步 $n$ 的已知量来表示未知加速度 $\\ddot{u}^{n+1}$ 和速度 $\\dot{u}^{n+1}$。\n\n从方程 (1) 重新整理以求解 $\\ddot{u}^{n+1}$：\n$$\n\\beta \\Delta t^2 \\ddot{u}^{n+1} = u^{n+1} - u^n - \\Delta t\\,\\dot{u}^n - \\left(\\frac{1}{2} - \\beta\\right)\\Delta t^2 \\ddot{u}^n\n$$\n$$\n\\ddot{u}^{n+1} = \\frac{1}{\\beta \\Delta t^2} \\left( u^{n+1} - u^n - \\Delta t\\,\\dot{u}^n \\right) - \\left(\\frac{1}{2\\beta} - 1\\right)\\ddot{u}^n \\quad (3)\n$$\n接下来，我们将 $\\ddot{u}^{n+1}$ 的这个表达式代入方程 (2) 以求得 $\\dot{u}^{n+1}$：\n$$\n\\dot{u}^{n+1} = \\dot{u}^n + (1 - \\gamma)\\Delta t\\,\\ddot{u}^n + \\gamma \\Delta t \\left[ \\frac{1}{\\beta \\Delta t^2} \\left( u^{n+1} - u^n - \\Delta t\\,\\dot{u}^n \\right) - \\left(\\frac{1}{2\\beta} - 1\\right)\\ddot{u}^n \\right]\n$$\n合并同类项，我们得到：\n$$\n\\dot{u}^{n+1} = \\frac{\\gamma}{\\beta \\Delta t}(u^{n+1} - u^n) + \\left(1 - \\frac{\\gamma}{\\beta}\\right)\\dot{u}^n + \\Delta t \\left(1 - \\gamma - \\frac{\\gamma}{2\\beta} + \\gamma\\right)\\ddot{u}^n\n$$\n$$\n\\dot{u}^{n+1} = \\frac{\\gamma}{\\beta \\Delta t}(u^{n+1} - u^n) + \\left(1 - \\frac{\\gamma}{\\beta}\\right)\\dot{u}^n + \\Delta t \\left(1 - \\frac{\\gamma}{2\\beta}\\right)\\ddot{u}^n \\quad (4)\n$$\n现在，我们将方程 (3) 和 (4) 代入在 $t^{n+1}$ 时的离散运动方程：\n$$\nm\\left[\\frac{1}{\\beta \\Delta t^2}(u^{n+1} - u^n - \\Delta t\\,\\dot{u}^n) - (\\frac{1}{2\\beta} - 1)\\ddot{u}^n\\right] + c\\left[\\frac{\\gamma}{\\beta \\Delta t}(u^{n+1} - u^n) + (1 - \\frac{\\gamma}{\\beta})\\dot{u}^n + \\Delta t(1 - \\frac{\\gamma}{2\\beta})\\ddot{u}^n\\right] + k\\,u^{n+1} = f^{n+1}\n$$\n我们重新整理这个方程，将所有包含未知数 $u^{n+1}$ 的项归到左侧 (LHS)，所有已知项归到右侧 (RHS)。\n$$\n\\left( \\frac{1}{\\beta \\Delta t^2}m + \\frac{\\gamma}{\\beta \\Delta t}c + k \\right) u^{n+1} = f^{n+1} + m\\left[ \\frac{1}{\\beta \\Delta t^2}u^n + \\frac{1}{\\beta \\Delta t}\\dot{u}^n + \\left(\\frac{1}{2\\beta} - 1\\right)\\ddot{u}^n \\right] + c\\left[ \\frac{\\gamma}{\\beta \\Delta t}u^n + \\left(\\frac{\\gamma}{\\beta} - 1\\right)\\dot{u}^n + \\Delta t\\left(\\frac{\\gamma}{2\\beta} - 1\\right)\\ddot{u}^n \\right]\n$$\n这是一个形如 $\\hat{k} u^{n+1} = \\hat{f}^{n+1}$ 的线性系统，其中有效刚度 $\\hat{k}$ 和有效力 $\\hat{f}^{n+1}$ 定义为：\n$$\n\\hat{k} = k + \\frac{\\gamma}{\\beta \\Delta t}c + \\frac{1}{\\beta \\Delta t^2}m\n$$\n$$\n\\hat{f}^{n+1} = f^{n+1} + c\\left[\\frac{\\gamma}{\\beta \\Delta t}u^n + \\left(\\frac{\\gamma}{\\beta} - 1\\right)\\dot{u}^n + \\Delta t\\left(\\frac{\\gamma}{2\\beta} - 1\\right)\\ddot{u}^n\\right] + m\\left[\\frac{1}{\\beta \\Delta t^2}u^n + \\frac{1}{\\beta \\Delta t}\\dot{u}^n + \\left(\\frac{1}{2\\beta} - 1\\right)\\ddot{u}^n\\right]\n$$\n给定以下数值：\n$m=1$ kg, $c=0.2$ N s/m, $k=100$ N/m, $\\Delta t=0.01$ s, $\\beta=\\frac{1}{4}$, $\\gamma=\\frac{1}{2}$。\n参数 $(\\beta, \\gamma) = (\\frac{1}{4}, \\frac{1}{2})$ 定义了常平均加速度法（或梯形法则）。\n\n首先，我们计算有效刚度和有效力的系数：\n$$\n\\frac{1}{\\beta \\Delta t^2} = \\frac{1}{(\\frac{1}{4})(0.01)^2} = \\frac{4}{0.0001} = 40000\n$$\n$$\n\\frac{\\gamma}{\\beta \\Delta t} = \\frac{\\frac{1}{2}}{(\\frac{1}{4})(0.01)} = \\frac{2}{0.01} = 200\n$$\n现在，我们计算有效刚度 $\\hat{k}$：\n$$\n\\hat{k} = 100 + (200)(0.2) + (40000)(1) = 100 + 40 + 40000 = 40140 \\text{ N/m}\n$$\n接下来，我们确定在时间 $t^n = 0.01$ s 的状态：\n$u^n=0$ m\n$\\dot{u}^n=0$ m/s\n策动力函数为 $f(t) = 10\\sin(5t)$ N。因此，$f^n = f(0.01) = 10\\sin(5 \\times 0.01) = 10\\sin(0.05)$ N。\n加速度为 $\\ddot{u}^n = f^n/m = (10\\sin(0.05))/1 = 10\\sin(0.05)$ m/s$^2$。\n在时间 $t^{n+1} = 0.02$ s 的力为 $f^{n+1} = f(0.02) = 10\\sin(5 \\times 0.02) = 10\\sin(0.1)$ N。\n\n现在我们计算有效力 $\\hat{f}^{n+1}$。由于 $u^n=0$ 和 $\\dot{u}^n=0$，$\\hat{f}^{n+1}$ 的表达式大大简化：\n$$\n\\hat{f}^{n+1} = f^{n+1} + c\\left[\\Delta t\\left(\\frac{\\gamma}{2\\beta} - 1\\right)\\ddot{u}^n\\right] + m\\left[\\left(\\frac{1}{2\\beta} - 1\\right)\\ddot{u}^n\\right]\n$$\n我们来计算 $\\ddot{u}^n$ 项的系数：\n$$\n\\frac{\\gamma}{2\\beta} - 1 = \\frac{\\frac{1}{2}}{2(\\frac{1}{4})} - 1 = \\frac{\\frac{1}{2}}{\\frac{1}{2}} - 1 = 1 - 1 = 0\n$$\n$$\n\\frac{1}{2\\beta} - 1 = \\frac{1}{2(\\frac{1}{4})} - 1 = \\frac{1}{\\frac{1}{2}} - 1 = 2 - 1 = 1\n$$\n乘以 $c$ 的项消失。有效力变为：\n$$\n\\hat{f}^{n+1} = f^{n+1} + m\\ddot{u}^n\n$$\n代入数值：\n$$\n\\hat{f}^{n+1} = 10\\sin(0.1) + (1)(10\\sin(0.05)) = 10(\\sin(0.1) + \\sin(0.05)) \\text{ N}\n$$\n现在我们可以求解 $u^{n+1}$：\n$$\nu^{n+1} = \\frac{\\hat{f}^{n+1}}{\\hat{k}} = \\frac{10(\\sin(0.1) + \\sin(0.05))}{40140}\n$$\n使用计算器计算三角函数（以弧度为单位）：\n$\\sin(0.1) \\approx 0.0998334166$\n$\\sin(0.05) \\approx 0.0499791693$\n$$\nu^{n+1} \\approx \\frac{10(0.0998334166 + 0.0499791693)}{40140} = \\frac{10(0.1498125859)}{40140} = \\frac{1.498125859}{40140}\n$$\n$$\nu^{n+1} \\approx 0.0000373225276 \\text{ m}\n$$\n题目要求答案四舍五入到六位有效数字。前六位有效数字是 $3$、$7$、$3$、$2$、$2$、$5$。下一位数字是 $2$，小于 $5$，所以我们不向上取整。\n$$\nu^{n+1} \\approx 0.0000373225 \\text{ m}\n$$", "answer": "$$\n\\boxed{0.0000373225}\n$$", "id": "3558209"}, {"introduction": "将数值算法应用于实际工程问题是计算力学的重要一环，而有限元法是连接理论与实践的桥梁。本练习将理论知识应用于一个通过有限元离散化的杆系统。通过计算并比较一致质量矩阵和集中质量矩阵下的临界稳定时间步长，你将直观地看到有限元建模中的选择（例如质量矩阵的类型）如何直接影响显式动力学分析的稳定性和计算效率。", "problem": "一根均匀的一维轴向杆被离散为三个等长的双节点线性单元，用于使用直接时间积分法进行瞬态动力学分析。采用小应变线弹性假设。该杆有四个节点，两端固定，因此节点 $1$ 和 $4$ 具有规定的零轴向位移。不存在外力且无阻尼。每个单元的质量参数为 $\\rho A L = 1$ $\\mathrm{kg}$，轴向刚度参数为 $E A / L = 10^{4}$ $\\mathrm{N/m}$，其中 $L$ 表示单元长度。使用有限元（FE）方法，采用轴向杆的标准线性形函数，建立包含一致质量矩阵 $M_{c}$ 和集中质量矩阵 $M_{l}$ 的组装后的半离散运动方程，施加本质边界条件，并通过广义特征值问题确定每种质量表示下的最大固有圆频率 $\\omega_{\\max}$。然后，从第一性原理分析显式中心差分格式及其对无阻尼齐次系统的放大条件，推导出每种情况对应的临界稳定时间步长。将这两个时间步长（单位为秒）表示为单个行矩阵，并将每个值四舍五入到四位有效数字。", "solution": "用户希望我解决一个计算固体力学问题。\n\n我的计划如下：\n1.  **验证问题**：我将检查问题是否适定、科学上是否合理以及是否完整。这似乎是有限元分析中的一个标准学术问题。\n2.  **构建单元矩阵**：我将使用给定参数，为一个双节点杆单元写出刚度矩阵和两种类型的质量矩阵（一致质量矩阵和集中质量矩阵）。\n3.  **组装全局矩阵**：我将通过组合三个单元的贡献，为整个四节点系统组装全局刚度矩阵和质量矩阵。\n4.  **施加边界条件**：我将缩减全局矩阵以考虑固定端边界条件，从而得到一个关于自由度的 2x2 系统。\n5.  **求解特征值问题**：对于每种质量矩阵公式（一致质量和集中质量），我将求解广义特征值问题以找到缩减系统的固有频率。我将在每种情况下确定最大固有频率 $\\omega_{\\max}$。\n6.  **确定临界时间步长**：我将使用显式中心差分法的稳定性判据 $\\Delta t_{\\text{crit}} = 2/\\omega_{\\max}$，来计算一致质量和集中质量系统的临界时间步长。\n7.  **最终答案**：我将按照要求，以行矩阵的形式呈现两个计算出的时间步长，并四舍五入到四位有效数字。\n\n这种结构化的方法将确保问题的所有部分都得到正确和逻辑性的处理。我现在开始验证，如果成功，则开始求解。\n\n### 步骤 1：提取已知条件\n- **系统**：一根均匀的一维轴向杆。\n- **离散化**：三个等长的双节点线性单元，共四个节点。\n- **分析类型**：使用直接时间积分法的瞬态动力学分析，假设为小应变线弹性。\n- **边界条件**：两端（节点 $1$ 和 $4$）固定，因此轴向位移 $u_1 = 0$ 和 $u_4 = 0$。\n- **载荷**：无外力。\n- **阻尼**：无阻尼。\n- **单元属性**：\n    - 质量参数：$\\rho A L = 1$ $\\mathrm{kg}$。\n    - 轴向刚度参数：$E A / L = 10^4$ $\\mathrm{N/m}$。\n    - $L$ 是单元长度。\n- **任务**：\n    1. 建立包含一致质量矩阵 $M_c$ 和集中质量矩阵 $M_l$ 的半离散运动方程。\n    2. 施加本质边界条件。\n    3. 通过广义特征值问题确定每种质量表示下的最大固有圆频率 $\\omega_{\\max}$。\n    4. 为每种情况推导显式中心差分格式对应的临界稳定时间步长。\n    5. 将这两个时间步长（单位为秒）表示为单个行矩阵，并四舍五入到四位有效数字。\n\n### 步骤 2：使用提取的已知条件进行验证\n- **科学依据**：该问题基于成熟的结构动力学有限元方法，具体涉及一维轴向杆的分析。一致质量矩阵和集中质量矩阵、固有频率以及中心差分法的稳定性等概念是计算力学中的基本原理。该问题不含伪科学或事实错误。\n- **适定性**：该问题提供了一个清晰的物理设置，包含了所有必要的参数（$EA/L$, $\\rho A L$）、边界条件和明确的方法论。它要求计算具体的、可量化的值（$\\omega_{\\max}$, $\\Delta t_{crit}$）。每个量都有唯一的解。\n- **客观性**：问题以精确的技术语言陈述，没有主观或模棱两可的术语。\n- **完整性与一致性**：所有需要的数据都已提供。设置中没有矛盾之处。参数在物理上是一致的（质量单位为 kg，刚度单位为 N/m）。\n\n### 步骤 3：结论与行动\n该问题科学上合理、适定、客观且自洽。它是计算固体力学中的一个标准问题。因此，该问题是 **有效的**。我将进行完整求解。\n\n无外力、无阻尼系统的半离散运动方程为：\n$$\nM \\ddot{U} + K U = 0\n$$\n其中 $M$ 是全局质量矩阵，$K$ 是全局刚度矩阵，$U$ 是节点位移向量。我们将考虑质量矩阵的两种情况：一致质量矩阵 $M_c$ 和集中质量矩阵 $M_l$。\n\n首先，我们定义单个双节点线性轴向杆单元的单元刚度矩阵和质量矩阵。\n单元刚度矩阵 $k^e$ 为：\n$$\nk^e = \\frac{EA}{L} \\begin{pmatrix} 1  -1 \\\\ -1  1 \\end{pmatrix} = 10^4 \\begin{pmatrix} 1  -1 \\\\ -1  1 \\end{pmatrix} \\, \\mathrm{N/m}\n$$\n单元一致质量矩阵 $m_c^e$ 为：\n$$\nm_c^e = \\frac{\\rho A L}{6} \\begin{pmatrix} 2  1 \\\\ 1  2 \\end{pmatrix} = \\frac{1}{6} \\begin{pmatrix} 2  1 \\\\ 1  2 \\end{pmatrix} \\, \\mathrm{kg}\n$$\n单元集中质量矩阵 $m_l^e$ 是通过将 $m_c^e$ 的每行之和放置在对角线上得到的：\n$$\nm_l^e = \\frac{\\rho A L}{2} \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} = \\frac{1}{2} \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} \\, \\mathrm{kg}\n$$\n系统由连接四个节点的三个单元组成。我们组装 $4 \\times 4$ 的全局矩阵。\n\n全局刚度矩阵 $K$ 组装如下：\n$$\nK = \\frac{EA}{L} \\begin{pmatrix}\n1  -1  0  0 \\\\\n-1  1+1  -1  0 \\\\\n0  -1  1+1  -1 \\\\\n0  0  -1  1\n\\end{pmatrix} = 10^4 \\begin{pmatrix}\n1  -1  0  0 \\\\\n-1  2  -1  0 \\\\\n0  -1  2  -1 \\\\\n0  0  -1  1\n\\end{pmatrix}\n$$\n全局一致质量矩阵 $M_c$ 组装如下：\n$$\nM_c = \\frac{\\rho A L}{6} \\begin{pmatrix}\n2  1  0  0 \\\\\n1  2+2  1  0 \\\\\n0  1  2+2  1 \\\\\n0  0  1  2\n\\end{pmatrix} = \\frac{1}{6} \\begin{pmatrix}\n2  1  0  0 \\\\\n1  4  1  0 \\\\\n0  1  4  1 \\\\\n0  0  1  2\n\\end{pmatrix}\n$$\n全局集中质量矩阵 $M_l$ 组装如下：\n$$\nM_l = \\frac{\\rho A L}{2} \\begin{pmatrix}\n1  0  0  0 \\\\\n0  1+1  0  0 \\\\\n0  0  1+1  0 \\\\\n0  0  0  1\n\\end{pmatrix} = \\frac{1}{2} \\begin{pmatrix}\n1  0  0  0 \\\\\n0  2  0  0 \\\\\n0  0  2  0 \\\\\n0  0  0  1\n\\end{pmatrix}\n$$\n边界条件为 $u_1=0$ 和 $u_4=0$。我们通过消除与固定自由度（DOF）对应的行和列来施加这些条件，即自由度 $1$ 和 $4$。剩余的自由度为 $u_2$ 和 $u_3$。针对自由度的缩减矩阵为：\n$$\nK_{red} = 10^4 \\begin{pmatrix} 2  -1 \\\\ -1  2 \\end{pmatrix}\n$$\n$$\nM_{c,red} = \\frac{1}{6} \\begin{pmatrix} 4  1 \\\\ 1  4 \\end{pmatrix}\n$$\n$$\nM_{l,red} = \\frac{1}{2} \\begin{pmatrix} 2  0 \\\\ 0  2 \\end{pmatrix} = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} = I\n$$\n通过求解广义特征值问题 $(K_{red} - \\omega^2 M_{red})\\phi = 0$ 来找到固有频率。\n\n情况 1：一致质量矩阵\n我们求解 $\\det(K_{red} - \\omega^2 M_{c,red}) = 0$。令 $\\lambda = \\omega^2$。\n$$\n\\det\\left( 10^4 \\begin{pmatrix} 2  -1 \\\\ -1  2 \\end{pmatrix} - \\lambda \\frac{1}{6} \\begin{pmatrix} 4  1 \\\\ 1  4 \\end{pmatrix} \\right) = 0\n$$\n$$\n\\det \\begin{pmatrix} 2 \\times 10^4 - \\frac{4\\lambda}{6}  -10^4 - \\frac{\\lambda}{6} \\\\ -10^4 - \\frac{\\lambda}{6}  2 \\times 10^4 - \\frac{4\\lambda}{6} \\end{pmatrix} = 0\n$$\n这导出了特征方程：\n$$\n\\left( 2 \\times 10^4 - \\frac{2}{3}\\lambda \\right)^2 - \\left( 10^4 + \\frac{1}{6}\\lambda \\right)^2 = 0\n$$\n使用平方差公式 $a^2 - b^2 = (a-b)(a+b)=0$：\n$$\n\\left[ \\left(2 \\times 10^4 - \\frac{2}{3}\\lambda\\right) - \\left(10^4 + \\frac{1}{6}\\lambda\\right) \\right] \\left[ \\left(2 \\times 10^4 - \\frac{2}{3}\\lambda\\right) + \\left(10^4 + \\frac{1}{6}\\lambda\\right) \\right] = 0\n$$\n$$\n\\left( 10^4 - \\frac{5}{6}\\lambda \\right) \\left( 3 \\times 10^4 - \\frac{1}{2}\\lambda \\right) = 0\n$$\n$\\lambda = \\omega^2$ 的解为：\n$$\n\\lambda_1 = \\frac{10^4}{5/6} = \\frac{6}{5} \\times 10^4 = 1.2 \\times 10^4\n$$\n$$\n\\lambda_2 = \\frac{3 \\times 10^4}{1/2} = 6 \\times 10^4\n$$\n最大特征值为 $\\lambda_{c,max} = \\omega_{c,max}^2 = 6 \\times 10^4 \\, (\\mathrm{rad/s})^2$。\n最大固有圆频率为 $\\omega_{c,max} = \\sqrt{6 \\times 10^4} = 100\\sqrt{6} \\, \\mathrm{rad/s}$。\n\n情况 2：集中质量矩阵\n我们求解 $\\det(K_{red} - \\omega^2 M_{l,red}) = 0$。由于 $M_{l,red}$ 是单位矩阵 $I$，这是一个关于 $K_{red}$ 的标准特征值问题。令 $\\lambda = \\omega^2$。\n$$\n\\det(K_{red} - \\lambda I) = \\det\\left( 10^4 \\begin{pmatrix} 2  -1 \\\\ -1  2 \\end{pmatrix} - \\lambda \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} \\right) = 0\n$$\n$$\n\\det \\begin{pmatrix} 2 \\times 10^4 - \\lambda  -10^4 \\\\ -10^4  2 \\times 10^4 - \\lambda \\end{pmatrix} = 0\n$$\n$$\n(2 \\times 10^4 - \\lambda)^2 - (10^4)^2 = 0\n$$\n再次使用平方差公式：\n$$\n(2 \\times 10^4 - \\lambda - 10^4)(2 \\times 10^4 - \\lambda + 10^4) = 0\n$$\n$$\n(10^4 - \\lambda)(3 \\times 10^4 - \\lambda) = 0\n$$\n$\\lambda = \\omega^2$ 的解为：\n$$\n\\lambda_1 = 10^4\n$$\n$$\n\\lambda_2 = 3 \\times 10^4\n$$\n最大特征值为 $\\lambda_{l,max} = \\omega_{l,max}^2 = 3 \\times 10^4 \\, (\\mathrm{rad/s})^2$。\n最大固有圆频率为 $\\omega_{l,max} = \\sqrt{3 \\times 10^4} = 100\\sqrt{3} \\, \\mathrm{rad/s}$。\n\n现在，我们推导显式中心差分法的临界时间步长。对于无阻尼线性系统，该格式的稳定性要求时间步长 $\\Delta t$ 满足以下条件：\n$$\n\\Delta t \\le \\frac{2}{\\omega_{\\max}}\n$$\n临界稳定时间步长 $\\Delta t_{crit}$ 是满足此条件的最大可能 $\\Delta t$ 值，因此 $\\Delta t_{crit} = 2/\\omega_{\\max}$。\n\n对于一致质量矩阵的情况：\n$$\n\\Delta t_{c, crit} = \\frac{2}{\\omega_{c,max}} = \\frac{2}{100\\sqrt{6}} = \\frac{1}{50\\sqrt{6}} = \\frac{\\sqrt{6}}{300} \\, \\mathrm{s}\n$$\n数值上，$\\Delta t_{c, crit} \\approx 0.0081649658 \\, \\mathrm{s}$。四舍五入到四位有效数字，结果是 $0.008165 \\, \\mathrm{s}$。\n\n对于集中质量矩阵的情况：\n$$\n\\Delta t_{l, crit} = \\frac{2}{\\omega_{l,max}} = \\frac{2}{100\\sqrt{3}} = \\frac{1}{50\\sqrt{3}} = \\frac{\\sqrt{3}}{150} \\, \\mathrm{s}\n$$\n数值上，$\\Delta t_{l, crit} \\approx 0.011547005 \\, \\mathrm{s}$。四舍五入到四位有效数字，结果是 $0.01155 \\, \\mathrm{s}$。\n\n问题要求将两个时间步长表示为单个行矩阵。第一个对应于一致质量矩阵，第二个对应于集中质量矩阵。", "answer": "$$\n\\boxed{\\begin{pmatrix} 0.008165  0.01155 \\end{pmatrix}}\n$$", "id": "3558222"}]}