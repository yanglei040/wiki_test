{"hands_on_practices": [{"introduction": "在非线性有限元分析中，牛顿-拉夫逊法是求解平衡方程的基石。然而，完整的牛顿步长有时可能导致发散，因此引入线搜索来调节步长至关重要。本练习将带你实践牛顿迭代中一个核心环节：如何利用残差的一阶线性化来估算并控制线搜索步长 $\\alpha$，以确保迭代步满足预设的收敛容差。这项技能对于理解和调试非线性求解器的收敛行为至关重要。[@problem_id:3595455]", "problem": "考虑一个正在进行有限元离散化的准静态非线性固体。平衡条件由虚功原理陈述，该原理要求内虚功与外虚功相平衡。在离散形式下，这产生了一个节点平衡残差，定义为 $r(u) = f_{\\text{int}}(u) - f_{\\text{ext}}$，其中 $f_{\\text{int}}(u)$ 是节点内力向量，$f_{\\text{ext}}$ 是施加的节点外力向量。在当前迭代步 $u^{k}$，内力的一致线性化得到切向刚度矩阵 $K_{t}(u^{k})$，一个牛顿步 $\\Delta u$ 满足 $K_{t}(u^{k}) \\,\\Delta u = -r(u^{k})$。然后定义线性搜索更新为 $u^{k+1}(\\alpha) = u^{k} + \\alpha \\,\\Delta u$，步长为 $\\alpha \\in (0,1]$。\n\n在当前迭代步，数据如下：\n- $f_{\\text{ext}} = \\begin{pmatrix} 1000 \\\\ -500 \\\\ 250 \\end{pmatrix} \\,\\text{N}$，\n- $f_{\\text{int}}(u^{k}) = \\begin{pmatrix} 1010 \\\\ -505 \\\\ 252 \\end{pmatrix} \\,\\text{N}$，\n- $K_{t}(u^{k}) = \\begin{pmatrix} 20000 & -5000 & 0 \\\\ -5000 & 15000 & -3000 \\\\ 0 & -3000 & 10000 \\end{pmatrix} \\text{ N/m}$。\n\n将相对残差范数定义为 $\\|r(u)\\|_{2} / \\|f_{\\text{ext}}\\|_{2}$，其中 $\\|\\cdot\\|_{2}$ 表示欧几里得范数。在与牛顿法一致的、关于 $u^{k}$ 的残差标准一阶线性化下，确定最小步长 $\\alpha \\in (0,1]$，使得 $u^{k+1}(\\alpha)$ 处的相对残差范数满足收敛准则\n$$\\frac{\\|r(u^{k+1}(\\alpha))\\|_{2}}{\\|f_{\\text{ext}}\\|_{2}} \\le \\tau_{\\text{rel}},$$\n其中 $\\tau_{\\text{rel}} = 0.003$ (无量纲)。将 $\\alpha$ 的最终答案表示为一个无量纲量。将您的答案四舍五入到四位有效数字。", "solution": "该问题要求找到满足非线性有限元问题给定相对残差范数收敛准则的最小步长 $\\alpha \\in (0,1]$。解决方案基于与牛顿-拉夫逊法一致的残差一阶线性化。\n\n首先，我们定义当前迭代步 $u^k$ 处的残差向量。残差 $r(u)$ 由内力向量 $f_{\\text{int}}(u)$ 和外力向量 $f_{\\text{ext}}$ 之差给出。\n$$r(u) = f_{\\text{int}}(u) - f_{\\text{ext}}$$\n在迭代步 $u^k$ 处，残差为 $r(u^k) = f_{\\text{int}}(u^k) - f_{\\text{ext}}$。使用所提供的数据：\n$$f_{\\text{ext}} = \\begin{pmatrix} 1000 \\\\ -500 \\\\ 250 \\end{pmatrix} \\,\\text{N}$$\n$$f_{\\text{int}}(u^{k}) = \\begin{pmatrix} 1010 \\\\ -505 \\\\ 252 \\end{pmatrix} \\,\\text{N}$$\n因此，当前迭代步的残差为：\n$$r(u^k) = \\begin{pmatrix} 1010 \\\\ -505 \\\\ 252 \\end{pmatrix} - \\begin{pmatrix} 1000 \\\\ -500 \\\\ 250 \\end{pmatrix} = \\begin{pmatrix} 10 \\\\ -5 \\\\ 2 \\end{pmatrix} \\,\\text{N}$$\n\n接下来，我们在更新后的构型 $u^{k+1}(\\alpha) = u^k + \\alpha \\Delta u$ 处对残差进行线性化。残差 $r(u)$ 在 $u^k$ 附近的一阶泰勒级数展开为：\n$$r(u^{k+1}(\\alpha)) \\approx r(u^k) + \\frac{\\partial r}{\\partial u}\\bigg|_{u^k} (u^{k+1}(\\alpha) - u^k)$$\n假设外力向量 $f_{\\text{ext}}$ 与 $u$ 无关，则残差相对于位移向量 $u$ 的导数是切向刚度矩阵：\n$$\\frac{\\partial r}{\\partial u} = \\frac{\\partial}{\\partial u} (f_{\\text{int}}(u) - f_{\\text{ext}}) = \\frac{\\partial f_{\\text{int}}}{\\partial u} = K_t(u)$$\n将此式和 $u^{k+1}(\\alpha) - u^k = \\alpha \\Delta u$ 代入展开式，我们得到：\n$$r(u^{k+1}(\\alpha)) \\approx r(u^k) + K_t(u^k) (\\alpha \\Delta u) = r(u^k) + \\alpha (K_t(u^k) \\Delta u)$$\n牛顿步 $\\Delta u$ 由线性系统 $K_t(u^k) \\Delta u = -r(u^k)$ 定义。将此关系代入线性化残差表达式，得到：\n$$r(u^{k+1}(\\alpha)) \\approx r(u^k) + \\alpha (-r(u^k)) = (1-\\alpha) r(u^k)$$\n这是线性搜索步中残差的标准一阶近似。\n\n收敛准则以相对残差范数的形式给出：\n$$\\frac{\\|r(u^{k+1}(\\alpha))\\|_{2}}{\\|f_{\\text{ext}}\\|_{2}} \\le \\tau_{\\text{rel}}$$\n使用线性化残差，我们有：\n$$\\frac{\\|(1-\\alpha) r(u^k)\\|_{2}}{\\|f_{\\text{ext}}\\|_{2}} \\le \\tau_{\\text{rel}}$$\n由于 $\\alpha \\in (0,1]$，因子 $(1-\\alpha)$ 是非负的。因此，范数可以简化为：\n$$\\frac{(1-\\alpha) \\|r(u^k)\\|_{2}}{\\|f_{\\text{ext}}\\|_{2}} \\le \\tau_{\\text{rel}}$$\n我们需要找到满足此不等式的最小 $\\alpha \\in (0,1]$。我们可以求解 $\\alpha$：\n$$1-\\alpha \\le \\frac{\\tau_{\\text{rel}} \\|f_{\\text{ext}}\\|_{2}}{\\|r(u^k)\\|_{2}}$$\n$$\\alpha \\ge 1 - \\frac{\\tau_{\\text{rel}} \\|f_{\\text{ext}}\\|_{2}}{\\|r(u^k)\\|_{2}}$$\n满足此条件的最小 $\\alpha$ 值由等式给出：\n$$\\alpha = 1 - \\frac{\\tau_{\\text{rel}} \\|f_{\\text{ext}}\\|_{2}}{\\|r(u^k)\\|_{2}}$$\n\n现在，我们计算所需的欧几里得范数：\n残差 $r(u^k)$ 的范数是：\n$$\\|r(u^k)\\|_{2} = \\sqrt{10^2 + (-5)^2 + 2^2} = \\sqrt{100 + 25 + 4} = \\sqrt{129} \\,\\text{N}$$\n外力向量 $f_{\\text{ext}}$ 的范数是：\n$$\\|f_{\\text{ext}}\\|_{2} = \\sqrt{1000^2 + (-500)^2 + 250^2} = \\sqrt{1000000 + 250000 + 62500}$$\n$$\\|f_{\\text{ext}}\\|_{2} = \\sqrt{1312500} = \\sqrt{62500 \\times 21} = 250\\sqrt{21} \\,\\text{N}$$\n给定的收敛容差为 $\\tau_{\\text{rel}} = 0.003$。\n\n将这些值代入 $\\alpha$ 的表达式中：\n$$\\alpha = 1 - \\frac{0.003 \\times 250\\sqrt{21}}{\\sqrt{129}} = 1 - \\frac{0.75\\sqrt{21}}{\\sqrt{129}}$$\n为了获得数值，我们计算该表达式：\n$$\\alpha = 1 - 0.75 \\times \\sqrt{\\frac{21}{129}} = 1 - 0.75 \\times \\sqrt{\\frac{7}{43}}$$\n$$\\alpha \\approx 1 - 0.75 \\times \\sqrt{0.16279069...} \\approx 1 - 0.75 \\times 0.4034733...$$\n$$\\alpha \\approx 1 - 0.30260499... \\approx 0.6973950...$$\n问题要求将答案四舍五入到四位有效数字。\n$$\\alpha \\approx 0.6974$$\n该值位于指定区间 $\\alpha \\in (0,1]$ 内，因此是一个有效的解。", "answer": "$$\\boxed{0.6974}$$", "id": "3595455"}, {"introduction": "残差范数不仅仅是一个衡量力不平衡的抽象数字，它还可以具有深刻的物理意义。本练习将引导你探索一种基于能量的范数，即由刚度矩阵的逆（$K^{-1}$）导出的范数。通过将抽象的残差向量与应变能的概念联系起来，你将学会如何从能量角度量化当前状态与平衡状态的偏差，从而对收敛性有更物理直观的理解。[@problem_id:3595528]", "problem": "在计算固体力学中，一个缩聚的双自由度子系统的线性化静力平衡可以写作 $K u = f$，其中 $K$ 是对称正定 (SPD) 缩聚刚度矩阵，其元素单位为 $\\text{N/m}$，$u$ 是位移向量，其元素单位为 $\\text{m}$，$f$ 是外力向量，其元素单位为 $\\text{N}$。在给定的非线性迭代步 $k$，残差（不平衡节点力）为 $r^{(k)} = f - K u^{(k)}$，其元素单位为 $\\text{N}$。考虑以下代表一个 $2 \\times 2$ 缩聚子系统的特定 SPD 刚度矩阵和残差向量：\n$$\nK = \\begin{pmatrix}\n3.0 \\times 10^{6} & -1.0 \\times 10^{6} \\\\\n-1.0 \\times 10^{6} & 2.0 \\times 10^{6}\n\\end{pmatrix} \\ \\text{N/m}, \n\\qquad\nr = \\begin{pmatrix}\n5.00 \\times 10^{2} \\\\\n-2.00 \\times 10^{2}\n\\end{pmatrix} \\ \\text{N}.\n$$\n利用线性弹性中的能量第一性原理和逆刚度矩阵诱导的范数，将由 $K^{-1}$ 诱导的残差范数解释为一种基于能量的不平衡度量并进行计算。具体来说，计算残差的 $K^{-1}$ 诱导范数 $\\|r\\|_{K^{-1}}$ 的值，以及相关的类余能度量 $\\tfrac{1}{2} \\, r^{\\mathsf{T}} K^{-1} r$。解释这两个量的物理单位，并根据当前迭代步的应变能一致性来阐述其量值的意义。\n\n将类余能度量以 $\\text{J}$ 为单位表示，范数以 $\\sqrt{\\text{J}}$ 为单位表示。将范数 $\\|r\\|_{K^{-1}}$ 四舍五入到四位有效数字。仅报告 $\\|r\\|_{K^{-1}}$ 的数值。", "solution": "一个缩聚子系统的线性化静力平衡方程为 $K u = f$，其中 $K$ 是对称正定 (SPD) 的。在位移为 $u^{(k)}$ 的一次迭代中，残差为 $r = f - K u^{(k)}$，其元素单位为 $\\text{N}$。从能量角度来看，对于一个 SPD 矩阵 $M$，向量 $x$ 的 $M$ 诱导范数定义为 $\\|x\\|_{M} = \\sqrt{x^{\\mathsf{T}} M x}$。选择 $M = K^{-1}$，可得到 $K^{-1}$ 诱导范数 $\\|r\\|_{K^{-1}} = \\sqrt{r^{\\mathsf{T}} K^{-1} r}$。量 $r^{\\mathsf{T}} K^{-1} r$ 的单位是 $\\text{N} \\cdot \\text{m} = \\text{J}$，因为 $K$ 的单位是 $\\text{N/m}$，所以 $K^{-1}$ 的单位是 $\\text{m/N}$，而 $r^{\\mathsf{T}} K^{-1} r$ 的单位是 $\\text{N} \\cdot \\text{m/N} \\cdot \\text{N} = \\text{N} \\cdot \\text{m} = \\text{J}$。因此，$\\|r\\|_{K^{-1}}$ 的单位是 $\\sqrt{\\text{J}}$。标量 $\\tfrac{1}{2} r^{\\mathsf{T}} K^{-1} r$ 是一个类能量，它等于通过柔性位移增量来平衡残差所对应的余能；它衡量了当前迭代步的应变能不一致性。\n\n我们现在计算 $K^{-1}$。对于一个 $2 \\times 2$ 矩阵，\n$$\nK^{-1} = \\frac{1}{\\det K} \\begin{pmatrix} K_{22} & -K_{12} \\\\ -K_{21} & K_{11} \\end{pmatrix}.\n$$\n计算行列式：\n$$\n\\det K = (3.0 \\times 10^{6})(2.0 \\times 10^{6}) - (-1.0 \\times 10^{6})(-1.0 \\times 10^{6}) = 6.0 \\times 10^{12} - 1.0 \\times 10^{12} = 5.0 \\times 10^{12} \\ \\text{N}^2/\\text{m}^2.\n$$\n因此，\n$$\nK^{-1} = \\frac{1}{5.0 \\times 10^{12}}\n\\begin{pmatrix}\n2.0 \\times 10^{6} & 1.0 \\times 10^{6} \\\\\n1.0 \\times 10^{6} & 3.0 \\times 10^{6}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n4.0 \\times 10^{-7} & 2.0 \\times 10^{-7} \\\\\n2.0 \\times 10^{-7} & 6.0 \\times 10^{-7}\n\\end{pmatrix} \\ \\text{m/N}.\n$$\n接下来计算 $r^{\\mathsf{T}} K^{-1} r$。首先，计算 $K^{-1} r$：\n$$\nK^{-1} r\n=\n\\begin{pmatrix}\n4.0 \\times 10^{-7} & 2.0 \\times 10^{-7} \\\\\n2.0 \\times 10^{-7} & 6.0 \\times 10^{-7}\n\\end{pmatrix}\n\\begin{pmatrix}\n5.00 \\times 10^{2} \\\\\n-2.00 \\times 10^{2}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n(4.0 \\times 10^{-7})(5.00 \\times 10^{2}) + (2.0 \\times 10^{-7})(-2.00 \\times 10^{2}) \\\\\n(2.0 \\times 10^{-7})(5.00 \\times 10^{2}) + (6.0 \\times 10^{-7})(-2.00 \\times 10^{2})\n\\end{pmatrix}.\n$$\n计算每个分量：\n$$\n(4.0 \\times 10^{-7})(5.00 \\times 10^{2}) = 2.00 \\times 10^{-4}, \\quad\n(2.0 \\times 10^{-7})(-2.00 \\times 10^{2}) = -4.00 \\times 10^{-5},\n$$\n所以第一个分量是 $2.00 \\times 10^{-4} - 4.00 \\times 10^{-5} = 1.60 \\times 10^{-4} \\ \\text{m}$。\n对于第二个分量，\n$$\n(2.0 \\times 10^{-7})(5.00 \\times 10^{2}) = 1.00 \\times 10^{-4}, \\quad\n(6.0 \\times 10^{-7})(-2.00 \\times 10^{2}) = -1.20 \\times 10^{-4},\n$$\n所以第二个分量是 $1.00 \\times 10^{-4} - 1.20 \\times 10^{-4} = -2.00 \\times 10^{-5} \\ \\text{m}$。\n因此，\n$$\nK^{-1} r = \\begin{pmatrix} 1.60 \\times 10^{-4} \\\\ -2.00 \\times 10^{-5} \\end{pmatrix} \\ \\text{m}.\n$$\n现在计算\n$$\nr^{\\mathsf{T}} K^{-1} r = \n\\begin{pmatrix}\n5.00 \\times 10^{2} & -2.00 \\times 10^{2}\n\\end{pmatrix}\n\\begin{pmatrix}\n1.60 \\times 10^{-4} \\\\\n-2.00 \\times 10^{-5}\n\\end{pmatrix}\n= (5.00 \\times 10^{2})(1.60 \\times 10^{-4}) + (-2.00 \\times 10^{2})(-2.00 \\times 10^{-5}).\n$$\n计算各项：\n$$\n(5.00 \\times 10^{2})(1.60 \\times 10^{-4}) = 8.00 \\times 10^{-2}, \\quad\n(-2.00 \\times 10^{2})(-2.00 \\times 10^{-5}) = 4.00 \\times 10^{-3}.\n$$\n因此，\n$$\nr^{\\mathsf{T}} K^{-1} r = 8.00 \\times 10^{-2} + 4.00 \\times 10^{-3} = 8.40 \\times 10^{-2} \\ \\text{J}.\n$$\n类余能度量是\n$$\n\\frac{1}{2} \\, r^{\\mathsf{T}} K^{-1} r = \\frac{1}{2} \\times 8.40 \\times 10^{-2} = 4.20 \\times 10^{-2} \\ \\text{J}.\n$$\n残差的 $K^{-1}$ 诱导范数是\n$$\n\\|r\\|_{K^{-1}} = \\sqrt{r^{\\mathsf{T}} K^{-1} r} = \\sqrt{8.40 \\times 10^{-2}} \\ \\sqrt{\\text{J}} \\approx 2.898275349 \\times 10^{-1} \\ \\sqrt{\\text{J}}.\n$$\n四舍五入到四位有效数字，结果是 $2.898 \\times 10^{-1} \\ \\sqrt{\\text{J}} = 0.2898 \\ \\sqrt{\\text{J}}$。\n\n解释：标量 $\\tfrac{1}{2} r^{\\mathsf{T}} K^{-1} r = 4.20 \\times 10^{-2} \\ \\text{J}$ 是通过系统柔度来平衡残差所需的余能。作为一种基于能量的收敛准则，将此量趋近于零可强制实现内力功与外力功的一致性。范数 $\\|r\\|_{K^{-1}}$ 提供了一个能量平方根形式的不平衡度量，它在标准正交基变换下保持不变，并直接反映了不平衡力的刚度加权严重程度。", "answer": "$$\\boxed{0.2898}$$", "id": "3595528"}, {"introduction": "在开发稳健的有限元求解器时，收敛准则中范数的选择并非无足轻重，它对求解的可靠性有重大影响。本练习将对比最常用的欧几里得范数（$\\ell_2$）和最大范数（$\\ell_{\\infty}$），揭示它们在面对局部化与分布式力不平衡时的不同敏感性。你还将探索旨在平衡灵敏度与稳健性的混合范数，这是制定可靠收敛标准的关键考量，能够有效避免过早收敛或不必要的迭代。[@problem_id:3595529]", "problem": "给定计算固体力学中的离散静力平衡设定，其中残差向量 $r \\in \\mathbb{R}^n$ 表示当前的节点力不平衡，它源于平衡方程 $K(u) u = f$ 中内力和外力的不匹配 $r(u) = f_{\\text{int}}(u) - f_{\\text{ext}}$。在诸如 Newton–Raphson 方法等非线性求解器中，收敛性通常通过 $r$ 的范数来监控。两种典型的选择是欧几里得范数（也称为 $\\ell_2$ 范数）和最大范数（也称为 $\\ell_{\\infty}$ 范数），定义如下\n$$\n\\|r\\|_2 = \\left( \\sum_{i=1}^n r_i^2 \\right)^{1/2}, \\quad \\|r\\|_{\\infty} = \\max_{1 \\le i \\le n} |r_i|.\n$$\n在实践中，当出现局部失效时（例如，单个节点出现大的不平衡），$\\|r\\|_{\\infty}$ 是高度敏感的，因为它直接度量了最大的不平衡；而 $\\|r\\|_2$ 则聚合了各项贡献，可能会低估局部的峰值，但对随机噪声更具鲁棒性。为了平衡敏感性和鲁棒性，定义了两种混合度量，它们都明确地包含了最大不平衡并降低了噪声敏感性：\n\n1) 一种聚合了归一化的 $\\ell_2$ 和 $\\ell_{\\infty}$ 信息的类范数混合度量：\n$$\n\\|r\\|_{\\text{hyb1}} = \\left( \\left(\\frac{\\|r\\|_2}{\\Theta_2}\\right)^2 + \\left(\\frac{\\|r\\|_{\\infty}}{\\Theta_{\\infty}}\\right)^2 \\right)^{1/2}.\n$$\n\n2) 一种 Huber 增广的最大值度量，它裁剪大分量的二次增长，同时仍然对最大值进行限制：\n$$\n\\phi_{\\delta}(x) = \\begin{cases}\nx^2, & |x| \\le \\delta,\\\\\n2\\delta |x| - \\delta^2, & |x| > \\delta,\n\\end{cases}\n\\qquad\n\\|r\\|_{\\text{Huber}} = \\left( \\sum_{i=1}^n \\phi_{\\delta}(r_i) \\right)^{1/2}, \\qquad\n\\|r\\|_{\\text{hyb2}} = \\max\\!\\left( \\frac{\\|r\\|_{\\infty}}{\\Theta_{\\infty}}, \\frac{\\|r\\|_{\\text{Huber}}}{\\Theta_2} \\right).\n$$\n\n设节点容差为 $\\Theta_{\\infty} = \\theta$，聚合容差为 $\\Theta_2 = \\sqrt{n}\\,\\theta$，这对应于所有分量同时被允许达到节点容差 $\\theta$ 的情况。取 Huber 参数 $\\delta > 0$ 为固定值。定义以下无量纲决策规则，每个规则返回一个布尔值：\n- $\\text{det}_{\\infty} = \\left(\\frac{\\|r\\|_{\\infty}}{\\Theta_{\\infty}} > 1\\right)$，\n- $\\text{det}_2 = \\left(\\frac{\\|r\\|_2}{\\Theta_2} > 1\\right)$，\n- $\\text{det}_{\\text{hyb1}} = \\left(\\|r\\|_{\\text{hyb1}} > 1\\right)$，\n- $\\text{det}_{\\text{hyb2}} = \\left(\\|r\\|_{\\text{hyb2}} > 1\\right)$。\n\n您必须编写一个完整的、可运行的程序，该程序针对一组指定的残差向量测试套件，计算四种无量纲度量\n$$\nm_2 = \\frac{\\|r\\|_2}{\\Theta_2}, \\quad m_{\\infty} = \\frac{\\|r\\|_{\\infty}}{\\Theta_{\\infty}}, \\quad m_{\\text{hyb1}} = \\|r\\|_{\\text{hyb1}}, \\quad m_{\\text{hyb2}} = \\|r\\|_{\\text{hyb2}},\n$$\n以及相应的布尔决策 $\\text{det}_2$、$\\text{det}_{\\infty}$、$\\text{det}_{\\text{hyb1}}$、$\\text{det}_{\\text{hyb2}}$。\n\n对所有测试用例使用以下参数：\n- 节点容差 $\\theta = 10$，因此 $\\Theta_{\\infty} = \\theta$ 且 $\\Theta_2 = \\sqrt{n}\\,\\theta$，其中 $n$ 等于每个残差向量的长度。\n- Huber 参数 $\\delta = 1$。\n\n测试套件（每个残差向量都是无量纲的，必须严格按照所列出的使用；所有向量的 $n=12$）：\n- 案例 A（局部异常值加小噪声）：$r = [0.1,\\,-0.05,\\,0.12,\\,-0.08,\\,12.0,\\,0.07,\\,-0.03,\\,0.02,\\,-0.01,\\,0.04,\\,-0.06,\\,0.09]$。\n- 案例 B（分布式中等不平衡，每个节点低于阈值）：$r = [6.0,\\,-5.5,\\,6.2,\\,-5.8,\\,0.3,\\,-0.2,\\,0.1,\\,0.0,\\,0.2,\\,-0.1,\\,0.05,\\,-0.05]$。\n- 案例 C（小的类随机噪声）：$r = [0.1,\\,-0.07,\\,0.05,\\,-0.09,\\,0.08,\\,-0.04,\\,0.02,\\,-0.03,\\,0.01,\\,-0.02,\\,0.0,\\,0.03]$。\n- 案例 D（精确平衡）：$r = [0.0,\\,0.0,\\,0.0,\\,0.0,\\,0.0,\\,0.0,\\,0.0,\\,0.0,\\,0.0,\\,0.0,\\,0.0,\\,0.0]$。\n- 案例 E（两个严重的局部异常值）：$r = [50.0,\\,-45.0,\\,0.2,\\,-0.1,\\,0.0,\\,0.0,\\,0.0,\\,0.15,\\,-0.05,\\,0.0,\\,0.0,\\,0.0]$。\n- 案例 F（处于容差边界的单节点）：$r = [10.0,\\,0.1,\\,-0.1,\\,0.05,\\,-0.05,\\,0.02,\\,-0.02,\\,0.0,\\,0.0,\\,0.01,\\,-0.01,\\,0.0]$。\n- 案例 G（多个节点接近容差，符号交替）：$r = [9.5,\\,-9.5,\\,9.5,\\,-9.5,\\,9.5,\\,-9.5,\\,9.5,\\,-9.5,\\,9.5,\\,-9.5,\\,9.5,\\,-9.5]$。\n\n您的程序必须：\n- 对每个案例，计算如上定义的 $m_2$, $m_{\\infty}$, $m_{\\text{hyb1}}$, $m_{\\text{hyb2}}$，以及四个布尔值 $\\text{det}_2$, $\\text{det}_{\\infty}$, $\\text{det}_{\\text{hyb1}}$, $\\text{det}_{\\text{hyb2}}$。\n- 生成单行输出，其中包含一个顶级列表，每个测试用例对应一个条目。每个条目必须是包含八个项目的列表，顺序完全一致：\n  $[m_2, m_{\\infty}, m_{\\text{hyb1}}, m_{\\text{hyb2}}, \\text{det}_2, \\text{det}_{\\infty}, \\text{det}_{\\text{hyb1}}, \\text{det}_{\\text{hyb2}}]$。\n- 所有浮点值必须四舍五入到恰好 $6$ 位小数。\n- 最终打印的行不得包含任何空白字符。例如，它必须看起来像 $[[\\dots],[\\dots],\\dots]$，使用逗号作为分隔符，没有空格。\n\n预期的输出是指定的无量纲浮点数和布尔值。不需要物理单位，也不涉及角度或百分比。该测试套件涵盖了局部异常值、分布式的亚阈值不平衡、小噪声、精确零值、多个极端异常值、边界阈值情况以及多个接近阈值的条目，用以评估异常值敏感性和所提出的混合度量的行为。", "solution": "所述问题在形式上是合理的，科学上基于计算固体力学和数值分析的原理，并且是适定的。所有定义、参数和测试用例都提供了足够的清晰度和一致性，以得到唯一且可验证的解。因此，我们可以直接进行分析。\n\n目标是为一组残差向量 $r \\in \\mathbb{R}^n$ 计算四种无量纲收敛度量及其对应的布尔决策标志。分析在以下固定参数下进行：\n- 向量维度：$n = 12$。\n- 节点容差参数：$\\theta = 10$。\n- Huber 函数参数：$\\delta = 1$。\n\n基于这些参数，我们定义最大范数和欧几里得范数的容差阈值：\n- 节点容差：$\\Theta_{\\infty} = \\theta = 10$。\n- 聚合容差：$\\Theta_2 = \\sqrt{n}\\,\\theta = \\sqrt{12}\\,\\theta = 2\\sqrt{3}\\,\\theta \\approx 34.641016$。\n\n需要计算的四种无量纲度量是：\n1.  归一化欧几里得范数：$m_2 = \\frac{\\|r\\|_2}{\\Theta_2}$，其中 $\\|r\\|_2 = \\left( \\sum_{i=1}^n r_i^2 \\right)^{1/2}$。如果残差分量的均方根超过节点容差 $\\theta$，该度量值将大于 $1$。\n2.  归一化最大范数：$m_{\\infty} = \\frac{\\|r\\|_{\\infty}}{\\Theta_{\\infty}}$，其中 $\\|r\\|_{\\infty} = \\max_{1 \\le i \\le n} |r_i|$。如果任何单个节点残差超过节点容差 $\\theta$，该度量值将大于 $1$。\n3.  混合度量 1：$m_{\\text{hyb1}} = \\|r\\|_{\\text{hyb1}} = \\left( m_2^2 + m_{\\infty}^2 \\right)^{1/2}$。该度量结合了归一化的 $\\ell_2$ 和 $\\ell_{\\infty}$ 准则，如果向量 $(m_2, m_{\\infty})$ 位于 $\\mathbb{R}^2$ 中的单位圆之外，则标记收敛失败。\n4.  混合度量 2：$m_{\\text{hyb2}} = \\|r\\|_{\\text{hyb2}} = \\max\\!\\left( \\frac{\\|r\\|_{\\infty}}{\\Theta_{\\infty}}, \\frac{\\|r\\|_{\\text{Huber}}}{\\Theta_2} \\right) = \\max(m_{\\infty}, \\frac{\\|r\\|_{\\text{Huber}}}{\\Theta_2})$。该度量使用 Huber 函数 $\\phi_{\\delta}(x)$ 定义了一个鲁棒的类范数量 $\\|r\\|_{\\text{Huber}} = \\left( \\sum_{i=1}^n \\phi_{\\delta}(r_i) \\right)^{1/2}$，其中当 $|x| \\le \\delta$ 时 $\\phi_{\\delta}(x) = x^2$，当 $|x| > \\delta$ 时 $\\phi_{\\delta}(x) = 2\\delta|x| - \\delta^2$。如果归一化最大范数超过 $1$，或者一个鲁棒聚合的残差超过聚合容差，它就会触发。\n\n对于每个度量 $m_j$，一个布尔决策标志 $\\text{det}_j$ 被计算为 $(m_j > 1)$。我们现在将为每个测试用例评估这些量。\n\n**案例 A：局部异常值加小噪声**\n$r = [0.1, -0.05, 0.12, -0.08, 12.0, 0.07, -0.03, 0.02, -0.01, 0.04, -0.06, 0.09]$\n$\\|r\\|_{\\infty} = 12.0$, $\\|r\\|_2 \\approx 12.0022$, $\\|r\\|_{\\text{Huber}} \\approx 4.8013$\n$m_{\\infty} = 12.0 / 10 = 1.2$\n$m_2 = 12.0022 / 34.6410 = 0.3465$\n$m_{\\text{hyb1}} = \\sqrt{1.2^2 + 0.3465^2} \\approx 1.2490$\n$m_{\\text{hyb2}} = \\max(1.2, 4.8013 / 34.6410) = 1.2$\n决策：$\\text{det}_{\\infty}=\\text{True}$，$\\text{det}_2=\\text{False}$，$\\text{det}_{\\text{hyb1}}=\\text{True}$，$\\text{det}_{\\text{hyb2}}=\\text{True}$。\n$r_5=12$ 处的局部异常值正确地触发了所有对最大范数敏感的准则。$\\ell_2$ 范数准则未能检测到这个局部问题，因为这个大的值在向量的维度上被“抹平”了。\n\n**案例 B：分布式中等不平衡**\n$r = [6.0, -5.5, 6.2, -5.8, 0.3, -0.2, 0.1, 0.0, 0.2, -0.1, 0.05, -0.05]$\n$\\|r\\|_{\\infty} = 6.2$, $\\|r\\|_2 \\approx 11.7697$, $\\|r\\|_{\\text{Huber}} \\approx 6.5723$\n$m_{\\infty} = 6.2 / 10 = 0.62$\n$m_2 = 11.7697 / 34.6410 = 0.3400$\n$m_{\\text{hyb1}} = \\sqrt{0.62^2 + 0.3400^2} \\approx 0.7071$\n$m_{\\text{hyb2}} = \\max(0.62, 6.5723 / 34.6410) = 0.62$\n决策：$\\text{det}_{\\infty}=\\text{False}$，$\\text{det}_2=\\text{False}$，$\\text{det}_{\\text{hyb1}}=\\text{False}$，$\\text{det}_{\\text{hyb2}}=\\text{False}$。\n尽管有几个分量中等偏大，但没有一个超过节点容差 $\\theta=10$，并且它们的聚合值也不足以触发 $\\ell_2$ 准则。所有度量都表明收敛。\n\n**案例 C：小的类随机噪声**\n$r = [0.1, -0.07, 0.05, -0.09, 0.08, -0.04, 0.02, -0.03, 0.01, -0.02, 0.0, 0.03]$\n$\\|r\\|_{\\infty} = 0.1$, $\\|r\\|_2 \\approx 0.1918$, $\\|r\\|_{\\text{Huber}} \\approx 0.1918$ (因为所有 $|r_i| \\le \\delta=1$)\n$m_{\\infty} = 0.1 / 10 = 0.01$\n$m_2 = 0.1918 / 34.6410 = 0.0055$\n$m_{\\text{hyb1}} = \\sqrt{0.01^2 + 0.0055^2} \\approx 0.0114$\n$m_{\\text{hyb2}} = \\max(0.01, 0.1918 / 34.6410) = 0.01$\n决策：$\\text{det}_{\\infty}=\\text{False}$，$\\text{det}_2=\\text{False}$，$\\text{det}_{\\text{hyb1}}=\\text{False}$，$\\text{det}_{\\text{hyb2}}=\\text{False}$。\n正如对小残差所预期的那样，所有度量都非常小，并表明收敛。\n\n**案例 D：精确平衡**\n$r = [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]$\n$\\|r\\|_{\\infty} = 0.0$, $\\|r\\|_2 = 0.0$, $\\|r\\|_{\\text{Huber}} = 0.0$\n$m_{\\infty} = 0.0$, $m_2 = 0.0$, $m_{\\text{hyb1}} = 0.0$, $m_{\\text{hyb2}} = 0.0$\n决策：$\\text{det}_{\\infty}=\\text{False}$，$\\text{det}_2=\\text{False}$，$\\text{det}_{\\text{hyb1}}=\\text{False}$，$\\text{det}_{\\text{hyb2}}=\\text{False}$。\n平凡的零向量正确地使所有度量都为零。\n\n**案例 E：两个严重的局部异常值**\n$r = [50.0, -45.0, 0.2, -0.1, 0.0, 0.0, 0.0, 0.15, -0.05, 0.0, 0.0, 0.0]$\n$\\|r\\|_{\\infty} = 50.0$, $\\|r\\|_2 \\approx 67.2713$, $\\|r\\|_{\\text{Huber}} \\approx 13.7840$\n$m_{\\infty} = 50.0 / 10 = 5.0$\n$m_2 = 67.2713 / 34.6410 = 1.9428$\n$m_{\\text{hyb1}} = \\sqrt{5.0^2 + 1.9428^2} \\approx 5.3638$\n$m_{\\text{hyb2}} = \\max(5.0, 13.7840 / 34.6410) = 5.0$\n决策：$\\text{det}_{\\infty}=\\text{True}$，$\\text{det}_2=\\text{True}$，$\\text{det}_{\\text{hyb1}}=\\text{True}$，$\\text{det}_{\\text{hyb2}}=\\text{True}$。\n极大的异常值确保了所有准则都被触发，包括 $\\ell_2$ 范数，尽管其是局部的，但其聚合值现在也足够大。\n\n**案例 F：处于容差边界的单节点**\n$r = [10.0, 0.1, -0.1, 0.05, -0.05, 0.02, -0.02, 0.0, 0.0, 0.01, -0.01, 0.0]$\n$\\|r\\|_{\\infty} = 10.0$, $\\|r\\|_2 \\approx 10.0016$, $\\|r\\|_{\\text{Huber}} \\approx 4.3592$\n$m_{\\infty} = 10.0 / 10 = 1.0$\n$m_2 = 10.0016 / 34.6410 = 0.2887$\n$m_{\\text{hyb1}} = \\sqrt{1.0^2 + 0.2887^2} \\approx 1.0409$\n$m_{\\text{hyb2}} = \\max(1.0, 4.3592 / 34.6410) = 1.0$\n决策：$\\text{det}_{\\infty}=\\text{False}$，$\\text{det}_2=\\text{False}$，$\\text{det}_{\\text{hyb1}}=\\text{True}$，$\\text{det}_{\\text{hyb2}}=\\text{False}$。\n此处，由于决策规则是严格不等式 $(>1)$，标准准则 $\\text{det}_{\\infty}$ 和 $\\text{det}_{\\text{hyb2}}$ 不会触发。然而，$\\text{det}_{\\text{hyb1}}$ 会触发，因为即使 $m_\\infty=1$，来自 $m_2$ 的贡献也使得 $m_{\\text{hyb1}} > 1$。这显示了它在收敛区域边界附近的敏感性。\n\n**案例 G：多个节点接近容差**\n$r = [9.5, -9.5, 9.5, -9.5, 9.5, -9.5, 9.5, -9.5, 9.5, -9.5, 9.5, -9.5]$\n$\\|r\\|_{\\infty} = 9.5$, $\\|r\\|_2 \\approx 32.9090$, $\\|r\\|_{\\text{Huber}} = \\sqrt{216} \\approx 14.6969$\n$m_{\\infty} = 9.5 / 10 = 0.95$\n$m_2 = 32.9090 / 34.6410 = 0.95$\n$m_{\\text{hyb1}} = \\sqrt{0.95^2 + 0.95^2} \\approx 1.3435$\n$m_{\\text{hyb2}} = \\max(0.95, 14.6969 / 34.6410) = 0.95$\n决策：$\\text{det}_{\\infty}=\\text{False}$，$\\text{det}_2=\\text{False}$，$\\text{det}_{\\text{hyb1}}=\\text{True}$，$\\text{det}_{\\text{hyb2}}=\\text{False}$。\n这个案例很有说明性。两个标准准则都表明收敛，因为没有单个节点超过容差，并且均方根值也刚好在容差之下。然而，系统显然处于一种不良状态，每个自由度都接近容差极限。$\\text{hyb1}$ 度量通过结合两种范数的信息，正确地识别出了这种有问题的状态，从而证明了它的实用性。\n\n总之，该测试套件有效地探究了四种收敛准则的不同行为，突显了 $\\| \\cdot \\|_{\\infty}$ 对异常值的敏感性以及 $\\| \\cdot \\|_2$ 的聚合特性。混合度量展示了平衡这些行为的不同方式，其中 $\\| \\cdot \\|_{\\text{hyb1}}$ 被证明对局部和分布式的边界情况都敏感。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes four convergence measures and decision flags for a suite of residual vectors.\n    \"\"\"\n    \n    def format_item(item):\n        \"\"\"Formats an item for the final output string.\"\"\"\n        if isinstance(item, (float, np.floating)):\n            return f\"{item:.6f}\"\n        elif isinstance(item, (bool, np.bool_)):\n            return str(item).lower()\n        else:\n            return str(item)\n\n    # Define parameters\n    theta = 10.0\n    delta = 1.0\n\n    # Define the test suite of residual vectors\n    test_cases = {\n        'A': [0.1, -0.05, 0.12, -0.08, 12.0, 0.07, -0.03, 0.02, -0.01, 0.04, -0.06, 0.09],\n        'B': [6.0, -5.5, 6.2, -5.8, 0.3, -0.2, 0.1, 0.0, 0.2, -0.1, 0.05, -0.05],\n        'C': [0.1, -0.07, 0.05, -0.09, 0.08, -0.04, 0.02, -0.03, 0.01, -0.02, 0.0, 0.03],\n        'D': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],\n        'E': [50.0, -45.0, 0.2, -0.1, 0.0, 0.0, 0.0, 0.15, -0.05, 0.0, 0.0, 0.0],\n        'F': [10.0, 0.1, -0.1, 0.05, -0.05, 0.02, -0.02, 0.0, 0.0, 0.01, -0.01, 0.0],\n        'G': [9.5, -9.5, 9.5, -9.5, 9.5, -9.5, 9.5, -9.5, 9.5, -9.5, 9.5, -9.5],\n    }\n    \n    # Order of cases as specified in problem\n    case_order = ['A', 'B', 'C', 'D', 'E', 'F', 'G']\n\n    all_results = []\n    \n    for case_key in case_order:\n        r_list = test_cases[case_key]\n        r = np.array(r_list, dtype=np.float64)\n        n = len(r)\n\n        # Calculate tolerances\n        Theta_inf = theta\n        Theta_2 = np.sqrt(n) * theta\n\n        # Calculate norms\n        norm_2 = np.linalg.norm(r, 2)\n        norm_inf = np.linalg.norm(r, np.inf)\n\n        # Calculate Huber-based norm\n        r_abs = np.abs(r)\n        phi_vals = np.where(r_abs <= delta, r_abs**2, 2 * delta * r_abs - delta**2)\n        norm_huber = np.sqrt(np.sum(phi_vals))\n\n        # Calculate dimensionless measures\n        m_2 = norm_2 / Theta_2\n        m_inf = norm_inf / Theta_inf\n        m_hyb1 = np.sqrt(m_2**2 + m_inf**2)\n        m_hyb2 = np.maximum(m_inf, norm_huber / Theta_2)\n        \n        # Calculate boolean decision flags\n        det_2 = m_2 > 1.0\n        det_inf = m_inf > 1.0\n        det_hyb1 = m_hyb1 > 1.0\n        det_hyb2 = m_hyb2 > 1.0\n\n        case_result = [m_2, m_inf, m_hyb1, m_hyb2, det_2, det_inf, det_hyb1, det_hyb2]\n        all_results.append(case_result)\n        \n    # Format final output string\n    final_case_strings = []\n    for case_result in all_results:\n        formatted_items = [format_item(item) for item in case_result]\n        final_case_strings.append(f'[{\",\".join(formatted_items)}]')\n\n    # Print in the exact required format with no whitespace\n    print(f'[[{\",\".join(final_case_strings)}]]'.replace(\" \", \"\"))\n\nsolve()\n```", "id": "3595529"}]}