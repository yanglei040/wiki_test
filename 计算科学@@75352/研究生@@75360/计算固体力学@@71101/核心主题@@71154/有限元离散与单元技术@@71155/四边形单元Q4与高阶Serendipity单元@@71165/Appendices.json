{"hands_on_practices": [{"introduction": "等参映射是Q4单元的核心，但一个常被忽视的关键细节是节点排序。本练习将探讨节点排序如何影响雅可比矩阵及其行列式的符号，揭示单元方向性的概念，并阐明其对数值积分和网格组装的深远影响。通过从第一性原理出发分析两种不同的节点排序方案，您将深入理解为何在有限元实践中保持一致的节点编号约定至关重要 [@problem_id:3592210]。", "problem": "一个双线性等参四边形单元（$\\mathrm{Q}4$）通过标准的等参构造，将父单元正方形 $\\{(\\xi,\\eta)\\,|\\,\\xi,\\eta\\in[-1,1]\\}$ 映射到一个凸的物理四边形。考虑一个物理四边形，其顶点坐标为 $\\mathbf{x}_A=(0,0)$、$\\mathbf{x}_B=(2,0)$、$\\mathbf{x}_C=(2.5,1.5)$ 和 $\\mathbf{x}_D=(-0.2,1.2)$，按平面内逆时针顺序 $(A,B,C,D)$ 给出。\n\n使用两种不同的节点排序来定义同一个几何单元：\n- 排序 $\\mathcal{O}_1$：节点 $1\\mapsto A$，节点 $2\\mapsto B$，节点 $3\\mapsto C$，节点 $4\\mapsto D$。\n- 排序 $\\mathcal{O}_2$：节点 $1\\mapsto A$，节点 $2\\mapsto D$，节点 $3\\mapsto C$，节点 $4\\mapsto B$。\n\n仅从4节点四边形的双线性等参映射的定义出发，完成以下任务：\n- 推导每种排序下的等参映射 $\\mathbf{x}(\\xi,\\eta)$，并明确指出父单元正方形的每个角点 $\\{(-1,-1),(1,-1),(1,1),(-1,1)\\}$ 与哪个物理顶点相关联。\n- 从基本原理出发，构建雅可比矩阵 $\\mathbf{J}(\\xi,\\eta)=\\partial\\mathbf{x}/\\partial(\\xi,\\eta)$，并对两种排序，计算其在单元中心 $(\\xi,\\eta)=(0,0)$ 处的行列式。\n- 使用您的推导，讨论不同节点排序对单元内部的高斯积分以及在有限元法（FEM）中沿单元边界应用诺伊曼边界条件的影响。您的讨论应说明哪些发生了改变，哪些必须保持一致，哪些不变量被保留，并简要评论这些考虑如何推广到高阶 serendipity 单元（例如，$\\mathrm{Q}8$ 和 $\\mathrm{Q}9$）。\n\n报告最终答案为带符号的比值\n$$\nr \\;=\\; \\frac{\\det\\mathbf{J}_{\\mathcal{O}_2}(0,0)}{\\det\\mathbf{J}_{\\mathcal{O}_1}(0,0)}\\,.\n$$\n比值 $r$ 是无量纲的。提供精确值。如果需要数值计算，则四舍五入到四位有效数字。", "solution": "本问题要求分析一个双线性等参四边形单元（$\\mathrm{Q}4$）在两种不同节点排序方案下的行为。我们必须推导等参映射，计算每种情况下单元中心的雅可比行列式，并讨论其影响。\n\n$\\mathrm{Q}4$ 单元的标准父单元是参数空间 $(\\xi, \\eta)$ 中的一个正方形，定义为 $\\{(\\xi,\\eta) \\,|\\, \\xi, \\eta \\in [-1, 1]\\}$。父单元的四个节点按逆时针编号，位于：\n节点 1：$(\\xi, \\eta) = (-1, -1)$\n节点 2：$(\\xi, \\eta) = (1, -1)$\n节点 3：$(\\xi, \\eta) = (1, 1)$\n节点 4：$(\\xi, \\eta) = (-1, 1)$\n\n从父坐标 $(\\xi, \\eta)$ 到物理坐标 $\\mathbf{x} = (x, y)$ 的等参映射由下式给出：\n$$\n\\mathbf{x}(\\xi, \\eta) = \\sum_{i=1}^{4} N_i(\\xi, \\eta) \\mathbf{x}_i\n$$\n其中 $\\mathbf{x}_i$ 是物理节点的坐标，而 $N_i(\\xi, \\eta)$ 是双线性形函数：\n$N_1(\\xi, \\eta) = \\frac{1}{4}(1-\\xi)(1-\\eta)$\n$N_2(\\xi, \\eta) = \\frac{1}{4}(1+\\xi)(1-\\eta)$\n$N_3(\\xi, \\eta) = \\frac{1}{4}(1+\\xi)(1+\\eta)$\n$N_4(\\xi, \\eta) = \\frac{1}{4}(1-\\xi)(1+\\eta)$\n\n映射的雅可比矩阵定义为 $\\mathbf{J} = \\frac{\\partial \\mathbf{x}}{\\partial(\\xi, \\eta)}$，它是一个 $2 \\times 2$ 矩阵：\n$$\n\\mathbf{J}(\\xi, \\eta) = \\begin{pmatrix} \\frac{\\partial x}{\\partial \\xi} & \\frac{\\partial x}{\\partial \\eta} \\\\ \\frac{\\partial y}{\\partial \\xi} & \\frac{\\partial y}{\\partial \\eta} \\end{pmatrix}\n$$\n雅可比矩阵的列向量通过对映射函数求导来计算：\n$\\frac{\\partial \\mathbf{x}}{\\partial \\xi} = \\sum_{i=1}^{4} \\frac{\\partial N_i}{\\partial \\xi} \\mathbf{x}_i$ 和 $\\frac{\\partial \\mathbf{x}}{\\partial \\eta} = \\sum_{i=1}^{4} \\frac{\\partial N_i}{\\partial \\eta} \\mathbf{x}_i$。\n\n形函数的导数为：\n$\\frac{\\partial N_1}{\\partial \\xi} = -\\frac{1}{4}(1-\\eta)$, $\\frac{\\partial N_2}{\\partial \\xi} = \\frac{1}{4}(1-\\eta)$, $\\frac{\\partial N_3}{\\partial \\xi} = \\frac{1}{4}(1+\\eta)$, $\\frac{\\partial N_4}{\\partial \\xi} = -\\frac{1}{4}(1+\\eta)$\n$\\frac{\\partial N_1}{\\partial \\eta} = -\\frac{1}{4}(1-\\xi)$, $\\frac{\\partial N_2}{\\partial \\eta} = -\\frac{1}{4}(1+\\xi)$, $\\frac{\\partial N_3}{\\partial \\eta} = \\frac{1}{4}(1+\\xi)$, $\\frac{\\partial N_4}{\\partial \\eta} = \\frac{1}{4}(1-\\xi)$\n\n我们被要求在单元中心 $(\\xi, \\eta) = (0, 0)$ 处计算雅可比矩阵。在该点，形函数的导数简化为：\n$\\frac{\\partial N_1}{\\partial \\xi}(0,0) = -\\frac{1}{4}$, $\\frac{\\partial N_2}{\\partial \\xi}(0,0) = \\frac{1}{4}$, $\\frac{\\partial N_3}{\\partial \\xi}(0,0) = \\frac{1}{4}$, $\\frac{\\partial N_4}{\\partial \\xi}(0,0) = -\\frac{1}{4}$\n$\\frac{\\partial N_1}{\\partial \\eta}(0,0) = -\\frac{1}{4}$, $\\frac{\\partial N_2}{\\partial \\eta}(0,0) = -\\frac{1}{4}$, $\\frac{\\partial N_3}{\\partial \\eta}(0,0) = \\frac{1}{4}$, $\\frac{\\partial N_4}{\\partial \\eta}(0,0) = \\frac{1}{4}$\n\n因此，中心点处的雅可比矩阵的列向量为：\n$\\frac{\\partial \\mathbf{x}}{\\partial \\xi}(0,0) = \\frac{1}{4}(-\\mathbf{x}_1 + \\mathbf{x}_2 + \\mathbf{x}_3 - \\mathbf{x}_4)$\n$\\frac{\\partial \\mathbf{x}}{\\partial \\eta}(0,0) = \\frac{1}{4}(-\\mathbf{x}_1 - \\mathbf{x}_2 + \\mathbf{x}_3 + \\mathbf{x}_4)$\n\n物理顶点坐标为 $\\mathbf{x}_A=(0,0)$、$\\mathbf{x}_B=(2,0)$、$\\mathbf{x}_C=(2.5,1.5)$ 和 $\\mathbf{x}_D=(-0.2,1.2)$。\n\n**排序 $\\mathcal{O}_1$ 的分析**\n对于排序 $\\mathcal{O}_1$，父单元节点与物理顶点的映射关系为：\n节点 $1 \\to \\mathbf{x}_1 = \\mathbf{x}_A = (0,0)$\n节点 $2 \\to \\mathbf{x}_2 = \\mathbf{x}_B = (2,0)$\n节点 $3 \\to \\mathbf{x}_3 = \\mathbf{x}_C = (2.5,1.5)$\n节点 $4 \\to \\mathbf{x}_4 = \\mathbf{x}_D = (-0.2,1.2)$\n这对应于物理四边形 $A \\to B \\to C \\to D$ 的逆时针遍历。\n\n等参映射为 $\\mathbf{x}_{\\mathcal{O}_1}(\\xi, \\eta) = N_1(\\xi,\\eta)\\mathbf{x}_A + N_2(\\xi,\\eta)\\mathbf{x}_B + N_3(\\xi,\\eta)\\mathbf{x}_C + N_4(\\xi,\\eta)\\mathbf{x}_D$。\n\n我们来计算在 $(\\xi,\\eta)=(0,0)$ 处的雅可比矩阵 $\\mathbf{J}_{\\mathcal{O}_1}$ 的列向量：\n$\\frac{\\partial \\mathbf{x}_{\\mathcal{O}_1}}{\\partial \\xi}(0,0) = \\frac{1}{4}(-\\mathbf{x}_A + \\mathbf{x}_B + \\mathbf{x}_C - \\mathbf{x}_D)$\n$= \\frac{1}{4} \\left( -\\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix} + \\begin{pmatrix} 2 \\\\ 0 \\end{pmatrix} + \\begin{pmatrix} 2.5 \\\\ 1.5 \\end{pmatrix} - \\begin{pmatrix} -0.2 \\\\ 1.2 \\end{pmatrix} \\right)$\n$= \\frac{1}{4} \\begin{pmatrix} 2 + 2.5 + 0.2 \\\\ 0 + 1.5 - 1.2 \\end{pmatrix} = \\frac{1}{4} \\begin{pmatrix} 4.7 \\\\ 0.3 \\end{pmatrix} = \\begin{pmatrix} 1.175 \\\\ 0.075 \\end{pmatrix}$\n\n$\\frac{\\partial \\mathbf{x}_{\\mathcal{O}_1}}{\\partial \\eta}(0,0) = \\frac{1}{4}(-\\mathbf{x}_A - \\mathbf{x}_B + \\mathbf{x}_C + \\mathbf{x}_D)$\n$= \\frac{1}{4} \\left( -\\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix} - \\begin{pmatrix} 2 \\\\ 0 \\end{pmatrix} + \\begin{pmatrix} 2.5 \\\\ 1.5 \\end{pmatrix} + \\begin{pmatrix} -0.2 \\\\ 1.2 \\end{pmatrix} \\right)$\n$= \\frac{1}{4} \\begin{pmatrix} -2 + 2.5 - 0.2 \\\\ 0 + 1.5 + 1.2 \\end{pmatrix} = \\frac{1}{4} \\begin{pmatrix} 0.3 \\\\ 2.7 \\end{pmatrix} = \\begin{pmatrix} 0.075 \\\\ 0.675 \\end{pmatrix}$\n\n排序 $\\mathcal{O}_1$ 在中心点处的雅可比矩阵为：\n$$\n\\mathbf{J}_{\\mathcal{O}_1}(0,0) = \\begin{pmatrix} 1.175 & 0.075 \\\\ 0.075 & 0.675 \\end{pmatrix}\n$$\n其行列式为：\n$\\det\\mathbf{J}_{\\mathcal{O}_1}(0,0) = (1.175)(0.675) - (0.075)(0.075) = 0.793125 - 0.005625 = 0.7875$。\n正的行列式与从父单元出发的逆时针（保持方向）映射一致。\n\n**排序 $\\mathcal{O}_2$ 的分析**\n对于排序 $\\mathcal{O}_2$，映射关系为：\n节点 $1 \\to \\mathbf{x}_1 = \\mathbf{x}_A = (0,0)$\n节点 $2 \\to \\mathbf{x}_2 = \\mathbf{x}_D = (-0.2,1.2)$\n节点 $3 \\to \\mathbf{x}_3 = \\mathbf{x}_C = (2.5,1.5)$\n节点 $4 \\to \\mathbf{x}_4 = \\mathbf{x}_B = (2,0)$\n这对应于物理四边形 $A \\to D \\to C \\to B$ 的顺时针遍历。\n\n等参映射为 $\\mathbf{x}_{\\mathcal{O}_2}(\\xi, \\eta) = N_1(\\xi,\\eta)\\mathbf{x}_A + N_2(\\xi,\\eta)\\mathbf{x}_D + N_3(\\xi,\\eta)\\mathbf{x}_C + N_4(\\xi,\\eta)\\mathbf{x}_B$。\n\n我们来计算在 $(\\xi,\\eta)=(0,0)$ 处的雅可比矩阵 $\\mathbf{J}_{\\mathcal{O}_2}$ 的列向量：\n$\\frac{\\partial \\mathbf{x}_{\\mathcal{O}_2}}{\\partial \\xi}(0,0) = \\frac{1}{4}(-\\mathbf{x}_A + \\mathbf{x}_D + \\mathbf{x}_C - \\mathbf{x}_B)$\n$= \\frac{1}{4} \\left( -\\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix} + \\begin{pmatrix} -0.2 \\\\ 1.2 \\end{pmatrix} + \\begin{pmatrix} 2.5 \\\\ 1.5 \\end{pmatrix} - \\begin{pmatrix} 2 \\\\ 0 \\end{pmatrix} \\right)$\n$= \\frac{1}{4} \\begin{pmatrix} -0.2 + 2.5 - 2 \\\\ 1.2 + 1.5 - 0 \\end{pmatrix} = \\frac{1}{4} \\begin{pmatrix} 0.3 \\\\ 2.7 \\end{pmatrix} = \\begin{pmatrix} 0.075 \\\\ 0.675 \\end{pmatrix}$\n\n$\\frac{\\partial \\mathbf{x}_{\\mathcal{O}_2}}{\\partial \\eta}(0,0) = \\frac{1}{4}(-\\mathbf{x}_A - \\mathbf{x}_D + \\mathbf{x}_C + \\mathbf{x}_B)$\n$= \\frac{1}{4} \\left( -\\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix} - \\begin{pmatrix} -0.2 \\\\ 1.2 \\end{pmatrix} + \\begin{pmatrix} 2.5 \\\\ 1.5 \\end{pmatrix} + \\begin{pmatrix} 2 \\\\ 0 \\end{pmatrix} \\right)$\n$= \\frac{1}{4} \\begin{pmatrix} 0.2 + 2.5 + 2 \\\\ -1.2 + 1.5 + 0 \\end{pmatrix} = \\frac{1}{4} \\begin{pmatrix} 4.7 \\\\ 0.3 \\end{pmatrix} = \\begin{pmatrix} 1.175 \\\\ 0.075 \\end{pmatrix}$\n\n排序 $\\mathcal{O}_2$ 在中心点处的雅可比矩阵为：\n$$\n\\mathbf{J}_{\\mathcal{O}_2}(0,0) = \\begin{pmatrix} 0.075 & 1.175 \\\\ 0.675 & 0.075 \\end{pmatrix}\n$$\n我们观察到 $\\mathbf{J}_{\\mathcal{O}_2}(0,0)$ 是通过交换 $\\mathbf{J}_{\\mathcal{O}_1}(0,0)$ 的列得到的。交换矩阵的两列会使其行列式变号。\n$\\det\\mathbf{J}_{\\mathcal{O}_2}(0,0) = (0.075)(0.075) - (1.175)(0.675) = 0.005625 - 0.793125 = -0.7875$。\n负的行列式与顺时针（反转方向）映射一致。\n\n**最终答案计算**\n比值 $r$ 为：\n$$\nr = \\frac{\\det\\mathbf{J}_{\\mathcal{O}_2}(0,0)}{\\det\\mathbf{J}_{\\mathcal{O}_1}(0,0)} = \\frac{-0.7875}{0.7875} = -1\n$$\n\n**影响讨论**\n\n这些推导突出了有限元法中节点排序的几个关键方面。\n\n1.  **对高斯积分的影响**：在物理单元域 $\\Omega_e$ 上的数值积分是在父单元域中进行的：$\\int_{\\Omega_e} f(\\mathbf{x}) d\\Omega = \\int_{-1}^{1}\\int_{-1}^{1} f(\\mathbf{x}(\\xi,\\eta)) \\det\\mathbf{J}(\\xi,\\eta) d\\xi d\\eta$。雅可比行列式 $\\det\\mathbf{J}$ 的符号直接取决于节点排序。逆时针排序（如 $\\mathcal{O}_1$）产生正的行列式，而顺时针排序（如 $\\mathcal{O}_2$）则产生负的行列式。对于一个有效的物理映射，行列式在单元内的任何地方都必须非零。大多数有限元方法（FEM）代码要求 $\\det\\mathbf{J} > 0$，并将 $\\det\\mathbf{J}$ 为负的单元标记为“反转”或“不当定义”。为了计算像质量或能量这样必须为正的物理量，积分必须使用行列式的绝对值 $|\\det\\mathbf{J}|$。虽然对单元的最终积分值是相同的（因为对于这种特定变化，$|\\det\\mathbf{J}_{\\mathcal{O}_1}| = |\\det\\mathbf{J}_{\\mathcal{O}_2}|$），但在每个高斯点上被求值的函数——包括映射后的函数 $f(\\mathbf{x}(\\xi,\\eta))$ 和 $\\det\\mathbf{J}(\\xi,\\eta)$——对于每种排序都是不同的。一个一致的节点排序约定（例如，总是逆时针）对于稳健的网格生成和分析至关重要。\n\n2.  **对诺伊曼边界条件的影响**：诺伊曼边界条件，如表面牵引力或热通量，是在单元边界上进行积分的。边的定义与节点排序相关联。对于排序 $\\mathcal{O}_1$，节点1和2之间的父单元边（$\\eta=-1$, $\\xi \\in [-1,1]$）映射到物理边 $A-B$。对于排序 $\\mathcal{O}_2$，同一个父单元边映射到物理边 $A-D$。因此，对物理边施加边界条件需要精确知道它对应于哪个父单元边，而这完全由节点排序决定。在由多个单元组成的网格中，相邻单元必须对其共享边有一致的定义。例如，如果单元1用节点 $(i, j)$ 定义边 $I-J$，那么相邻的单元2必须用节点 $(j, i)$ 来定义它。这确保了外法线向量的计算是一致的，并且单元间的通量得到正确平衡。杂乱无章的节点排序将使得边界条件的应用和全局系统矩阵的组装无法正确管理。\n\n3.  **不变量与变化量**：\n    -   **变化量**：节点排序直接改变了等参映射 $\\mathbf{x}(\\xi,\\eta)$、雅可比矩阵 $\\mathbf{J}(\\xi,\\eta)$ 及其行列式 $\\det\\mathbf{J}$ 的符号。父单元特征（如边 1-2）与物理特征（如边 A-B）之间的关联被改变。\n    -   **不变量**：物理几何形状（四边形本身）及其固有属性（如面积）是不变的。在特定物理点上的微分面积元的大小 $|d\\Omega| = |\\det\\mathbf{J}| d\\xi d\\eta$ 也是不变的，尽管该物理点在每个映射中对应于不同的 $(\\xi,\\eta)$ 坐标。\n\n4.  **对高阶单元的推广**：这些原理直接推广到高阶 serendipity（$\\mathrm{Q}8$）和拉格朗日（$\\mathrm{Q}9$）单元。对于这些单元，一致的节点编号方案（通常是角节点逆时针，然后是边中节点逆时针，最后是内部节点）甚至更为关键。映射函数是更高次的多项式，不正确的节点排序或边中/内部节点的不良布局很容易导致映射在单元内部的某些点变得不可逆（$\\det\\mathbf{J} \\le 0$），即使物理四边形是凸的。这种“单元扭曲”会使分析无效。因此，严格遵守标准排序约定是生成带有高阶单元的有效网格的基本要求。", "answer": "$$\n\\boxed{-1}\n$$", "id": "3592210"}, {"introduction": "在定义了单元映射之后，下一步自然是利用它来构建单元刚度矩阵，这是结构分析的基石。本练习将引导您完成这一过程，但其中蕴含一个概念上的挑战。它要求您计算一个扭曲四边形单元的刚度矩阵并评估其非对称性指数，从而验证刚度矩阵的一个基本属性——对称性，该属性直接源于线性弹性材料的本构关系 [@problem_id:3592225]。", "problem": "考虑一个使用四节点等参双线性四边形单元 (Q4) 的二维小应变平面应力分析。该单元的厚度为 $t$，在物理坐标中占据一个扭曲的平行四边形，节点位置如下\n$$\n(x_1,y_1)=(0,0),\\quad (x_2,y_2)=(2,0.5),\\quad (x_3,y_3)=(2.5,2.0),\\quad (x_4,y_4)=(0.5,1.5).\n$$\n假设材料为线弹性、均匀、各向同性，在平面应力条件下，其杨氏模量为 $E$，泊松比为 $\\nu$，因此本构矩阵 $D$ 为\n$$\nD=\\frac{E}{1-\\nu^2}\n\\begin{bmatrix}\n1 & \\nu & 0\\\\\n\\nu & 1 & 0\\\\\n0 & 0 & \\frac{1-\\nu}{2}\n\\end{bmatrix}.\n$$\n设 $E=200\\times 10^{9}$，$\\nu=0.3$，且 $t=0.01$，所有长度单位为米，力单位为牛顿。在父单元 $(\\xi,\\eta)\\in[-1,1]\\times[-1,1]$ 中使用标准 $2\\times 2$ 高斯积分法，高斯点位于 $(\\pm 1/\\sqrt{3},\\pm 1/\\sqrt{3})$，权重为单位权重。\n\n从微小应变的运动学定义和等参映射出发，计算四个高斯点上各自的应变-位移矩阵 $B$。然后，使用高斯积分法组装单元刚度矩阵\n$$\nK_e=\\sum_{g=1}^{4} B(\\xi_g,\\eta_g)^{\\mathsf{T}}\\,D\\,B(\\xi_g,\\eta_g)\\,t\\,\\det(J(\\xi_g,\\eta_g)),\n$$\n其中 $J$ 是等参映射的雅可比矩阵。最后，定义无量纲非对称指数\n$$\ns=\\frac{\\|K_e-K_e^{\\mathsf{T}}\\|_{F}}{\\|K_e\\|_{F}},\n$$\n其中 $\\|\\cdot\\|_{F}$ 表示弗罗贝尼乌斯范数。计算 $s$ 并将最终数值答案四舍五入至四位有效数字。根据您的计算，明确说明所计算的 $K_e$ 是否对称。", "solution": "该问题要求计算单元刚度矩阵 $K_e$ 的非对称指数 $s$。所概述的步骤涉及使用数值积分法组装 $K_e$，然后评估该指数。虽然直接进行数值计算是可行的，但首先检查问题的理论结构更具指导性和严谨性。\n\n单元刚度矩阵 $K_e$ 使用权重为单位权重 ($w_g=1$) 的 $2\\times 2$ 高斯积分法组装如下：\n$$\nK_e = \\sum_{g=1}^{4} B(\\xi_g,\\eta_g)^{\\mathsf{T}}\\,D\\,B(\\xi_g,\\eta_g)\\,t\\,\\det(J(\\xi_g,\\eta_g))\n$$\n此处，$B$ 是应变-位移矩阵，$D$ 是本构矩阵，$t$ 是厚度，$J$ 是等参映射的雅可比矩阵。求和是对四个高斯点 $(\\xi_g, \\eta_g)$进行的。\n\n问题的核心在于确定 $K_e$ 的对称性。如果一个矩阵等于其自身的转置，即 $K_e = K_e^{\\mathsf{T}}$，则该矩阵是对称的。我们来计算 $K_e$ 的转置：\n$$\nK_e^{\\mathsf{T}} = \\left( \\sum_{g=1}^{4} B_g^{\\mathsf{T}}\\,D\\,B_g\\,t\\,\\det(J_g) \\right)^{\\mathsf{T}}\n$$\n为简洁起见，记 $B_g = B(\\xi_g,\\eta_g)$ 和 $J_g = J(\\xi_g,\\eta_g)$。由于和的转置等于转置的和，并且标量 $t$ 和 $\\det(J_g)$ 不受矩阵转置运算的影响，我们有：\n$$\nK_e^{\\mathsf{T}} = \\sum_{g=1}^{4} \\left( B_g^{\\mathsf{T}}\\,D\\,B_g \\right)^{\\mathsf{T}} t\\,\\det(J_g)\n$$\n使用性质 $(ABC)^{\\mathsf{T}} = C^{\\mathsf{T}}B^{\\mathsf{T}}A^{\\mathsf{T}}$，我们可以展开矩阵乘积的转置：\n$$\n\\left( B_g^{\\mathsf{T}}\\,D\\,B_g \\right)^{\\mathsf{T}} = (B_g)^{\\mathsf{T}} \\, (D)^{\\mathsf{T}} \\, (B_g^{\\mathsf{T}})^{\\mathsf{T}}\n$$\n使用性质 $(A^{\\mathsf{T}})^{\\mathsf{T}} = A$，我们得到：\n$$\n\\left( B_g^{\\mathsf{T}}\\,D\\,B_g \\right)^{\\mathsf{T}} = B_g^{\\mathsf{T}} \\, D^{\\mathsf{T}} \\, B_g\n$$\n将此代回 $K_e^{\\mathsf{T}}$ 的表达式中：\n$$\nK_e^{\\mathsf{T}} = \\sum_{g=1}^{4} B_g^{\\mathsf{T}}\\,D^{\\mathsf{T}}\\,B_g\\,t\\,\\det(J_g)\n$$\n为了使 $K_e$ 对称，我们必须有 $K_e = K_e^{\\mathsf{T}}$。比较 $K_e$ 和 $K_e^{\\mathsf{T}}$ 的表达式，此等式当且仅当 $D = D^{\\mathsf{T}}$ 时成立。因此，单元刚度矩阵的对称性直接继承自本构矩阵的对称性。\n\n我们来检查问题描述中给出的平面应力本构矩阵 $D$：\n$$\nD = \\frac{E}{1-\\nu^2}\n\\begin{bmatrix}\n1 & \\nu & 0 \\\\\n\\nu & 1 & 0 \\\\\n0 & 0 & \\frac{1-\\nu}{2}\n\\end{bmatrix}\n$$\n这是线弹性、各向同性材料的标准本构矩阵。通过观察可知，该矩阵是对称的 ($D_{12} = D_{21} = \\frac{E\\nu}{1-\\nu^2}$)。因此，$D = D^{\\mathsf{T}}$。\n\n由于本构矩阵 $D$ 是对称的，因此可以得出 $K_e^{\\mathsf{T}} = K_e$。单元刚度矩阵根据其理论构造，是一个对称矩阵。\n\n只要单元不是退化的（即 $\\det(J) > 0$），并且对于任何有效的材料属性（$E>0$，$-1 < \\nu < 0.5$），这一基本结果都成立，而与具体几何形状（即节点坐标）无关。在每个高斯点上计算应变-位移矩阵 $B$ 是数值实现中的一个必要步骤，在这些条件下，它将始终产生一个对称的刚度矩阵。\n\n非对称指数定义为：\n$$\ns = \\frac{\\|K_e - K_e^{\\mathsf{T}}\\|_{F}}{\\|K_e\\|_{F}}\n$$\n由于我们已经确定 $K_e = K_e^{\\mathsf{T}}$，差值 $K_e - K_e^{\\mathsf{T}}$ 是一个 $8 \\times 8$ 的零矩阵。零矩阵的弗罗贝尼乌斯范数为 $0$：\n$$\n\\|K_e - K_e^{\\mathsf{T}}\\|_{F} = \\|0\\|_{F} = 0\n$$\n分母 $\\|K_e\\|_{F}$ 是刚度矩阵的弗罗贝尼乌斯范数。对于具有有效材料属性的非退化单元，刚度矩阵 $K_e$ 是一个非零的正半定矩阵。因此，其弗罗贝尼乌斯范数严格为正，即 $\\|K_e\\|_{F} > 0$。\n\n因此，非对称指数精确地为：\n$$\ns = \\frac{0}{\\|K_e\\|_{F}} = 0\n$$\n精确值为 $0$。问题要求将最终数值答案四舍五入至四位有效数字。精确值 $0$ 可以写成 $0.0000$ 来满足此要求。\n\n基于此评估，计算出的刚度矩阵 $K_e$ 是对称的。任何通过数值计算得到的非零非对称指数都将完全归因于浮点运算误差，而这不属于理论模型的范畴。", "answer": "$$\n\\boxed{0.0000}\n$$", "id": "3592225"}, {"introduction": "基础Q4单元的局限性促使我们转向更高阶的单元。这个高级练习旨在探讨物理问题的复杂性（本例中为二次体力）与有限元形函数为获得精确解所需的完备性之间的联系。它还将演示一种常见的失效模式：标准数值积分方案对于扭曲单元可能不准确，从而突显了单元几何、多项式阶次和数值精度之间的相互作用 [@problem_id:3592231]。", "problem": "一个单一的等参四边形单元占据了一个物理域，该物理域是从父坐标 $(\\xi,\\eta)\\in[-1,1]\\times[-1,1]$ 的父正方形映射而来的。考虑一个均匀、线弹性、平面应变固体，其拉梅算子作用于位移场 $\\boldsymbol{u}=(u_x,u_y)$，体力为 $\\boldsymbol{b}=(b_x,b_y)$，总势能 $\\Pi[\\boldsymbol{u}]$ 由标准的最小势能原理定义。体力是物理坐标中的二次多项式：$b_x=x^2$ 和 $b_y=y^2$。单元映射是双线性的（使用四节点双线性形函数的等参映射）且轻微扭曲，具体由下式给出\n$$\nx(\\xi,\\eta)=\\xi+\\alpha\\,\\xi\\,\\eta,\\quad y(\\xi,\\eta)=\\eta,\n$$\n其中扭曲参数 $\\alpha\\neq 0$ 是一个定值。用于四节点双线性四边形单元 $Q4$ 的标准高斯-勒让德求积法是在父正方形上的 $2\\times 2$ 法则。\n\n在全文中，凡声称精确的地方均假设精确的材料积分，并使用以下基本事实：（i）在没有惯性项的情况下，线性动量平衡为 $\\nabla\\cdot\\boldsymbol{\\sigma}+\\boldsymbol{b}=\\boldsymbol{0}$，其中柯西应力为 $\\boldsymbol{\\sigma}=\\mathbb{C}:\\boldsymbol{\\varepsilon}$，小应变张量为 $\\boldsymbol{\\varepsilon}=\\tfrac{1}{2}(\\nabla\\boldsymbol{u}+\\nabla\\boldsymbol{u}^{\\top})$；（ii）应力的散度涉及 $\\boldsymbol{u}$ 的二阶导数，因此如果 $u_x,u_y$ 是总次数为 $k$ 的多项式，则 $\\nabla\\cdot\\boldsymbol{\\sigma}$ 是总次数为 $k-2$ 的多项式。\n\n任务 (a)：仅使用上述基本结构，确定二维 serendipity 族 $S_p$ 中的最小阶数 $p$，使得在精确数值积分下，单个单元上的有限元空间能够表示一个位移场，该位移场在弱形式下精确平衡给定的二次体力，从而再现精确的总势能而无离散化误差。将此最小的 $p$ 值以单个整数形式报告。\n\n任务 (b)：对于指定的双线性映射下的四节点双线性四边形 $Q4$（即 $S_1$），考虑对应于节点1在 $x$ 方向上的一致节点等效荷载，\n$$\nf_{1x}=\\int_{-1}^{1}\\int_{-1}^{1} N_1(\\xi,\\eta)\\,b_x\\big(x(\\xi,\\eta),y(\\xi,\\eta)\\big)\\,J(\\xi,\\eta)\\,\\mathrm{d}\\xi\\,\\mathrm{d}\\eta,\n$$\n其中 $N_1(\\xi,\\eta)=\\tfrac{1}{4}(1-\\xi)(1-\\eta)$ 是节点1的形函数，$J(\\xi,\\eta)$ 是等参映射的雅可比行列式。通过明确指出被积函数在 $\\xi$ 和 $\\eta$ 中的多项式次数，论证标准的 $2\\times 2$ 高斯-勒让德求积法对于 $\\alpha\\neq 0$ 是否能精确积分 $f_{1x}$，并简要解释你发现的失效模式。\n\n答案规格：你的最终答案必须仅为任务 (a) 中最小 $p$ 值的整数。无需四舍五入。无需单位。", "solution": "**解答**\n\n**任务 (a)：Serendipity 单元的最小阶数**\n\n无离散化误差地再现精确总势能的要求，等同于边值问题的精确解 $\\boldsymbol{u}_{exact}$ 必须包含在有限元逼近空间 $\\boldsymbol{V}_h$ 中的条件。如果 $\\boldsymbol{u}_{exact} \\in \\boldsymbol{V}_h$，则在 $\\boldsymbol{V}_h$ 上最小化势能泛函 $\\Pi[\\boldsymbol{u}]$ 将得到 $\\boldsymbol{u}_{exact}$ 本身。这也被称为通过了针对特定解场的“分片检验”（patch test）。\n\n强形式的控制微分方程是 $\\nabla \\cdot \\boldsymbol{\\sigma} + \\boldsymbol{b} = \\boldsymbol{0}$。对于均匀线弹性材料，应力 $\\boldsymbol{\\sigma}$ 是位移场 $\\boldsymbol{u}$ 二阶导数的线性函数。问题提供了关键关系：如果 $\\boldsymbol{u}$ 的分量是物理坐标 $(x,y)$ 中总次数为 $k$ 的多项式，记为 $\\mathcal{P}_k(x,y)$，则 $\\nabla \\cdot \\boldsymbol{\\sigma}$ 的分量是 $(x,y)$ 中总次数为 $k-2$ 的多项式。\n\n给定的体力向量为 $\\boldsymbol{b} = (x^2, y^2)$。分量 $b_x=x^2$ 和 $b_y=y^2$ 是物理坐标 $(x,y)$ 中总次数为 2 的多项式。为了满足平衡方程 $\\nabla \\cdot \\boldsymbol{\\sigma} = -\\boldsymbol{b}$，$\\nabla \\cdot \\boldsymbol{\\sigma}$ 的分量必须能够表示总次数为 2 的多项式。根据提供的提示，这意味着精确位移解 $\\boldsymbol{u}_{exact}$ 必须由总次数为 $k$ 的多项式组成，其中 $k-2=2$，即 $k=4$。因此，有限元空间必须能够精确表示任何总次数最高为 4 的任意多项式位移场，即 $\\mathcal{P}_4(x,y) \\subseteq \\boldsymbol{V}_h$。\n\n对于一个等参单元，其在物理坐标中表示多项式场的能力取决于其在父坐标 $(\\xi, \\eta)$ 中形函数的多项式基。有限元理论中的一个标准结果是，对于一个具有任意（非仿射）等参映射的单元，要通过 $m$ 阶分片检验（即精确再现任何 $m$ 次多项式），其在父域中的形函数空间必须包含 $m$ 次完全多项式集 $\\mathcal{P}_m(\\xi,\\eta)$。\n\n在我们的情况下，我们需要通过 4 阶分片检验，即 $m=4$。因此，单元的形函数空间，对于阶数为 $p$ 的 serendipity 族记为 $\\mathcal{S}_p(\\xi, \\eta)$，必须包含 $\\mathcal{P}_4(\\xi, \\eta)$。\n\n阶数为 $p$ 的 serendipity 单元族 $S_p$ 的构造使其形函数空间 $\\mathcal{S}_p$ 包含完全多项式空间 $\\mathcal{P}_p(\\xi, \\eta)$。为了使 $\\mathcal{S}_p$ 包含 $\\mathcal{P}_4(\\xi, \\eta)$，必须有 $p \\ge 4$。满足此条件的最小整数阶数 $p$ 是 $p=4$。\n\n因此，能够满足所述要求的 serendipity 族的最小阶数是 $p=4$。\n\n**任务 (b)：节点荷载求积的精确性**\n\n我们被要求分析对于一个四节点双线性四边形 ($Q4$) 单元（对应于 serendipity 族 $S_1$）的一致节点荷载 $f_{1x}$ 的数值积分的精确性。求积法则是 $2 \\times 2$ 的高斯-勒让德方案。\n\n节点荷载的积分为：\n$$\nf_{1x}=\\int_{-1}^{1}\\int_{-1}^{1} N_1(\\xi,\\eta)\\,b_x\\big(x(\\xi,\\eta),y(\\xi,\\eta)\\big)\\,J(\\xi,\\eta)\\,\\mathrm{d}\\xi\\,\\mathrm{d}\\eta\n$$\n让我们分析被积函数，我们将其记为 $I(\\xi, \\eta)$。\n被积函数的组成部分是：\n1.  节点1的形函数：$N_1(\\xi,\\eta) = \\frac{1}{4}(1-\\xi)(1-\\eta)$。\n2.  在父坐标中表示的体力 $b_x = x^2$，使用映射 $x(\\xi,\\eta)=\\xi(1+\\alpha\\eta)$：\n    $b_x(x(\\xi,\\eta), y(\\xi,\\eta)) = [\\xi(1+\\alpha\\eta)]^2 = \\xi^2(1+\\alpha\\eta)^2$。\n3.  映射的雅可比行列式。雅可比矩阵为 $\\boldsymbol{J} = \\begin{pmatrix} \\partial x/\\partial\\xi & \\partial y/\\partial\\xi \\\\ \\partial x/\\partial\\eta & \\partial y/\\partial\\eta \\end{pmatrix} = \\begin{pmatrix} 1+\\alpha\\eta & 0 \\\\ \\alpha\\xi & 1 \\end{pmatrix}$。行列式为 $J(\\xi, \\eta) = \\det(\\boldsymbol{J}) = 1+\\alpha\\eta$。\n\n完整的被积函数是这三项的乘积：\n$$\nI(\\xi, \\eta) = N_1(\\xi, \\eta) \\cdot b_x \\cdot J = \\left[\\frac{1}{4}(1-\\xi)(1-\\eta)\\right] \\cdot \\left[\\xi^2(1+\\alpha\\eta)^2\\right] \\cdot \\left[1+\\alpha\\eta\\right]\n$$\n$$\nI(\\xi, \\eta) = \\frac{1}{4} ( (1-\\xi)\\xi^2 ) \\cdot ( (1-\\eta)(1+\\alpha\\eta)^3 )\n$$\n要确定 $2 \\times 2$ 高斯-勒让德求积法是否精确，我们必须分别找出被积函数关于 $\\xi$ 和 $\\eta$ 的多项式次数。\n-   关于 $\\xi$ 的多项式项是 $(1-\\xi)\\xi^2 = \\xi^2-\\xi^3$。这是一个关于 $\\xi$ 的 3 次多项式。\n-   关于 $\\eta$ 的多项式项是 $(1-\\eta)(1+\\alpha\\eta)^3$。由于 $\\alpha \\neq 0$，展开此式得到：\n    $(1-\\eta)(1 + 3\\alpha\\eta + 3\\alpha^2\\eta^2 + \\alpha^3\\eta^3) = 1 + (3\\alpha-1)\\eta + (3\\alpha^2-3\\alpha)\\eta^2 + (\\alpha^3-3\\alpha^2)\\eta^3 - \\alpha^3\\eta^4$。\n    这是一个关于 $\\eta$ 的 4 次多项式。\n\n在一个给定方向上具有 $n$ 个点的高斯-勒让德求积法则可以精确积分最高为 $2n-1$ 次的多项式。指定的 $2 \\times 2$ 法则在 $\\xi$ 方向使用 $n=2$ 个点，在 $\\eta$ 方向使用 $n=2$ 个点。\n-   在 $\\xi$ 方向，该法则对最高 3 次 ($2(2)-1 = 3$) 的多项式是精确的。被积函数在 $\\xi$ 方向是 3 次的，因此关于 $\\xi$ 的积分可以精确执行。\n-   在 $\\eta$ 方向，该法则对最高 3 次 ($2(2)-1 = 3$) 的多项式是精确的。被积函数在 $\\eta$ 方向是 4 次的。\n\n由于被积函数在 $\\eta$ 方向的次数 (4) 大于求积法则能精确积分的次数 (3)，因此 $f_{1x}$ 的数值积分不是精确的。\n\n失效模式是沿 $\\eta$ 坐标轴的求积法则阶数不足。$\\eta$ 方向的高次多项式是单元几何扭曲的直接后果，该扭曲由参数 $\\alpha \\neq 0$ 表征。形函数、映射后的体力以及雅可比行列式的乘积产生了一个多项式，其次数超过了用于非扭曲双线性单元的标准 $2\\times 2$ 法则的积分能力。如果单元未扭曲 ($\\alpha=0$)，被积函数对 $\\eta$ 的依赖将是 $\\frac{1}{4}(1-\\eta)$，这是一个 1 次多项式，可以被精确积分。", "answer": "$$\n\\boxed{4}\n$$", "id": "3592231"}]}