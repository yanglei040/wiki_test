{"hands_on_practices": [{"introduction": "第一个实践是应用高斯求积于有限元方法的一个基础练习。通过为一个简单的一维线性单元计算一致质量矩阵的一个分量，你将看到抽象的数值积分法则如何被具体地用于组装单元矩阵。这个练习将巩固你对形函数、等参映射和求积过程之间相互作用的理解 ([@problem_id:3567628])。", "problem": "考虑一个用于计算固体力学中有限元法 (FEM) 的一维、双节点、线性等参有限元，其物理坐标为 $x \\in [x_{1}, x_{2}]$，单元长度为 $h = x_{2} - x_{1} > 0$。令 $N_{1}(x)$ 和 $N_{2}(x)$ 表示线性拉格朗日形函数，它们在节点上精确插值一个标量场，并满足 $N_{1}(x_{1}) = 1$, $N_{1}(x_{2}) = 0$, $N_{2}(x_{1}) = 0$, 以及 $N_{2}(x_{2}) = 1$。从参考坐标 $\\xi \\in [-1, 1]$ 到物理坐标 $x \\in [x_{1}, x_{2}]$ 的仿射等参映射被用来将积分从物理域变换到参考域。使用参考区间 $[-1, 1]$ 上的标准两点高斯求积法则和仿射映射，精确计算一致质量矩阵项\n$$\nM_{11} = \\int_{x_{1}}^{x_{2}} N_{1}(x)^{2} \\, dx,\n$$\n并将您的最终答案表示为关于 $x_{1}$ 和 $x_{2}$ 的单个闭式解析表达式。最终表达式中无需进行数值舍入，也不应包含任何物理单位。", "solution": "### 解答\n目标是使用等参映射和一个$2$点高斯求积法则来计算一致质量矩阵项 $M_{11} = \\int_{x_{1}}^{x_{2}} N_{1}(x)^{2} \\, dx$。\n\n首先，我们在覆盖域 $\\xi \\in [-1, 1]$ 的参考单元上定义线性拉格朗日形函数。对应于节点 $\\xi = -1$ 和 $\\xi = 1$ 的形函数为：\n$$\nN_{1}(\\xi) = \\frac{1 - \\xi}{2}\n$$\n$$\nN_{2}(\\xi) = \\frac{1 + \\xi}{2}\n$$\n这些函数满足所需属性：$N_{1}(-1) = 1$, $N_{1}(1) = 0$, $N_{2}(-1) = 0$, 以及 $N_{2}(1) = 1$。\n\n等参映射使用这些相同的形函数，将物理坐标 $x$ 表示为参考坐标 $\\xi$ 的函数：\n$$\nx(\\xi) = N_{1}(\\xi)x_{1} + N_{2}(\\xi)x_{2} = \\frac{1 - \\xi}{2}x_{1} + \\frac{1 + \\xi}{2}x_{2}\n$$\n这是一个仿射映射。为了将积分从物理域变换到参考域，我们需要变换的雅可比 $J$：\n$$\nJ = \\frac{dx}{d\\xi} = \\frac{d}{d\\xi} \\left( \\frac{x_{1} + x_{2}}{2} + \\xi \\frac{x_{2} - x_{1}}{2} \\right) = \\frac{x_{2} - x_{1}}{2}\n$$\n微分元变换为 $dx = J \\, d\\xi$。\n\n现在可以在参考坐标系中重写 $M_{11}$ 的积分。根据等参单元的定义，在点 $x(\\xi)$ 处求值的形函数 $N_{1}(x)$ 等价于参考形函数 $N_{1}(\\xi)$。\n$$\nM_{11} = \\int_{x_{1}}^{x_{2}} N_{1}(x)^{2} \\, dx = \\int_{-1}^{1} (N_{1}(x(\\xi)))^{2} J \\, d\\xi = \\int_{-1}^{1} (N_{1}(\\xi))^{2} J \\, d\\xi\n$$\n让我们将参考域中的被积函数定义为 $f(\\xi)$：\n$$\nf(\\xi) = (N_{1}(\\xi))^{2} J = \\left( \\frac{1 - \\xi}{2} \\right)^{2} \\left( \\frac{x_{2} - x_{1}}{2} \\right) = \\frac{x_{2} - x_{1}}{8} (1 - \\xi)^{2}\n$$\n这个被积函数是关于 $\\xi$ 的一个2次多项式。\n\n问题指定使用$2$点高斯求积法则来计算该积分。高斯求积的一般形式为：\n$$\n\\int_{-1}^{1} f(\\xi) \\, d\\xi \\approx \\sum_{i=1}^{n} w_{i} f(\\xi_{i})\n$$\n其中 $\\xi_i$ 是求积点（横坐标），$w_i$ 是对应的权重。对于 $n=2$，求积点和权重为：\n- 点：$\\xi_{1} = -\\frac{1}{\\sqrt{3}}$, $\\xi_{2} = \\frac{1}{\\sqrt{3}}$\n- 权重：$w_{1} = 1$, $w_{2} = 1$\n\n一个$2$点高斯法则对于最高为 $2n-1 = 2(2)-1 = 3$ 次的多项式被积函数能提供精确结果。由于我们的被积函数 $f(\\xi)$ 是一个2次多项式，因此求积将是精确计算，而非近似。\n$$\nM_{11} = \\sum_{i=1}^{2} w_{i} f(\\xi_{i}) = w_{1} f(\\xi_{1}) + w_{2} f(\\xi_{2})\n$$\n代入求积点和权重的值：\n$$\nM_{11} = (1) \\cdot f\\left(-\\frac{1}{\\sqrt{3}}\\right) + (1) \\cdot f\\left(\\frac{1}{\\sqrt{3}}\\right)\n$$\n现在我们在两个高斯点上计算函数 $f(\\xi)$ 的值：\n在 $\\xi_1 = -1/\\sqrt{3}$ 处：\n$$\nf\\left(-\\frac{1}{\\sqrt{3}}\\right) = \\frac{x_{2} - x_{1}}{8} \\left(1 - \\left(-\\frac{1}{\\sqrt{3}}\\right)\\right)^{2} = \\frac{x_{2} - x_{1}}{8} \\left(1 + \\frac{1}{\\sqrt{3}}\\right)^{2}\n$$\n在 $\\xi_2 = 1/\\sqrt{3}$ 处：\n$$\nf\\left(\\frac{1}{\\sqrt{3}}\\right) = \\frac{x_{2} - x_{1}}{8} \\left(1 - \\frac{1}{\\sqrt{3}}\\right)^{2}\n$$\n将这两项相加得到 $M_{11}$：\n$$\nM_{11} = \\frac{x_{2} - x_{1}}{8} \\left[ \\left(1 + \\frac{1}{\\sqrt{3}}\\right)^{2} + \\left(1 - \\frac{1}{\\sqrt{3}}\\right)^{2} \\right]\n$$\n我们来简化方括号中的表达式。使用恒等式 $(a+b)^{2} + (a-b)^{2} = 2(a^{2} + b^{2})$，其中 $a=1$ 且 $b=1/\\sqrt{3}$：\n$$\n\\left(1 + \\frac{1}{\\sqrt{3}}\\right)^{2} + \\left(1 - \\frac{1}{\\sqrt{3}}\\right)^{2} = 2 \\left(1^{2} + \\left(\\frac{1}{\\sqrt{3}}\\right)^{2}\\right) = 2 \\left(1 + \\frac{1}{3}\\right) = 2 \\left(\\frac{4}{3}\\right) = \\frac{8}{3}\n$$\n将此结果代回 $M_{11}$ 的表达式中：\n$$\nM_{11} = \\frac{x_{2} - x_{1}}{8} \\left( \\frac{8}{3} \\right)\n$$\n这可以简化为：\n$$\nM_{11} = \\frac{x_{2} - x_{1}}{3}\n$$\n这就是质量矩阵项 $M_{11}$ 的精确值，表示为关于节点坐标 $x_1$ 和 $x_2$ 的闭式解析表达式。", "answer": "$$\n\\boxed{\\frac{x_{2} - x_{1}}{3}}\n$$", "id": "3567628"}, {"introduction": "在一维情况的基础上，这个实践将高斯求积扩展到二维矩形域，并采用张量积方法。核心任务是确定精确积分一个多项式所需的*最少*求积点数，这是开发计算高效的有限元程序的关键技能。本题强调了“精确度” ($2n-1$ 法则) 概念及其在二维问题中的实际应用 ([@problem_id:3567549])。", "problem": "在计算固体力学中，等参单元上的积分通常被映射到一个参考域上，并使用高斯求积法进行计算。考虑参考方形域 $\\Omega = [-1,1]\\times [-1,1]$ 和标量场 $f(x,y) = x^{3} y^{4}$。使用 $\\Omega$ 上的张量积高斯-勒让德求积法，完成以下任务：\n\n- 选择一个在 $x$ 方向上有 $n_{x}$ 个点、在 $y$ 方向上有 $n_{y}$ 个点的张量积高斯-勒让德法则，该法则是最小的，即它基于高斯-勒让德求积法的一维精度阶性质保证了对 $f(x,y)$ 的精确积分，而不依赖于 $f(x,y)$ 的任何偶然对称性。\n- 通过引用一维高斯-勒让德法则的精度阶概念以及二维中的张量积构造，论证您选择的 $(n_{x},n_{y})$ 为何是最小的。\n- 明确说明每个方向上使用的一维求积节点和权重，构建张量积法则，并通过执行您所选法则所隐含的有限求和来计算二重积分\n$$\nI \\;=\\; \\int_{-1}^{1} \\int_{-1}^{1} x^{3} y^{4} \\, dx \\, dy\n$$\n\n将 $I$ 的最终值报告为一个精确的实数。不要在最终答案框中提供中间表达式。", "solution": "问题要求使用最小的张量积高斯-勒让德求积法则来计算二重积分\n$$\nI = \\int_{-1}^{1} \\int_{-1}^{1} x^{3} y^{4} \\, dx \\, dy\n$$\n法则的选择必须基于精度阶性质来保证精确性，而不是基于被积函数的偶然性质。\n\n在一个区间 $[-1, 1]$ 上的一个一维 $n$ 点高斯-勒让德求积法则，可以精确积分任何次数最高为 $2n-1$ 的多项式。对于在域 $\\Omega = [-1,1]\\times [-1,1]$ 上，$x$ 方向有 $n_x$ 个点，$y$ 方向有 $n_y$ 个点的张量积法则，可分离函数 $f(x,y) = g(x)h(y)$ 的积分由下式给出\n$$\n\\int_{-1}^{1} \\int_{-1}^{1} g(x)h(y) \\, dx \\, dy = \\left( \\int_{-1}^{1} g(x) \\, dx \\right) \\left( \\int_{-1}^{1} h(y) \\, dy \\right)\n$$\n其数值近似为\n$$\nI \\approx \\left( \\sum_{i=1}^{n_x} w_i^x g(x_i) \\right) \\left( \\sum_{j=1}^{n_y} w_j^y h(y_j) \\right)\n$$\n如果 $n_x$ 点法则对 $g(x)$ 是精确的，并且 $n_y$ 点法则对 $h(y)$ 是精确的，那么这个近似就是精确的。\n\n在本问题中，被积函数为 $f(x,y) = x^3 y^4$。我们可以确定 $g(x) = x^3$ 和 $h(y) = y^4$。\n\n1.  **确定 $x$ 方向上的最小法则 ($n_x$)：**\n    需要积分的函数是 $g(x) = x^3$，这是一个次数为 $d_x = 3$ 的多项式。为保证精确积分，求积法则的精度阶必须至少为 $3$。因此，我们需要：\n    $$\n    2n_x - 1 \\ge 3\n    $$\n    $$\n    2n_x \\ge 4\n    $$\n    $$\n    n_x \\ge 2\n    $$\n    最小的整数点数为 $n_x=2$。尽管 $x^3$ 在 $[-1,1]$ 上的积分为零，并且以 $x=0$ 为中心的 1 点法则也能得到正确结果，但这将是利用被积函数的奇对称性，而题目陈述明确禁止这样做。*保证*对任何 3 次多项式都精确的最小法则是 2 点法则。\n\n2.  **确定 $y$ 方向上的最小法则 ($n_y$)：**\n    需要积分的函数是 $h(y) = y^4$，这是一个次数为 $d_y = 4$ 的多项式。为保证精确积分，我们需要：\n    $$\n    2n_y - 1 \\ge 4\n    $$\n    $$\n    2n_y \\ge 5\n    $$\n    $$\n    n_y \\ge 2.5\n    $$\n    由于点数必须是整数，所以最小点数为 $n_y=3$。\n\n因此，保证精确性的最小张量积求积法则是 $(n_x, n_y) = (2, 3)$ 点法则。\n\n接下来，我们列出所选一维法则的节点和权重。\n\n**对于 $x$ 方向的 2 点法则 ($n_x=2$)：**\n节点是 2 次勒让德多项式 $P_2(x) = \\frac{1}{2}(3x^2-1)$ 的根。\n根为 $x_1 = -\\frac{1}{\\sqrt{3}}$ 和 $x_2 = \\frac{1}{\\sqrt{3}}$。\n对应的权重为 $w_1^x = 1$ 和 $w_2^x = 1$。\n所以，节点集为 {$x_1, x_2$} = $\\{-\\frac{1}{\\sqrt{3}}, \\frac{1}{\\sqrt{3}}\\}$，权重集为 {$w_1^x, w_2^x$} = $\\{1, 1\\}$。\n\n**对于 $y$ 方向的 3 点法则 ($n_y=3$)：**\n节点是 3 次勒让德多项式 $P_3(y) = \\frac{1}{2}(5y^3-3y)$ 的根。\n根为 $y_1 = -\\sqrt{\\frac{3}{5}}$，$y_2 = 0$ 和 $y_3 = \\sqrt{\\frac{3}{5}}$。\n对应的权重为 $w_1^y = \\frac{5}{9}$，$w_2^y = \\frac{8}{9}$ 和 $w_3^y = \\frac{5}{9}$。\n所以，节点集为 {$y_1, y_2, y_3$} = $\\{-\\sqrt{\\frac{3}{5}}, 0, \\sqrt{\\frac{3}{5}}\\}$，权重集为 {$w_1^y, w_2^y, w_3^y$} = $\\{\\frac{5}{9}, \\frac{8}{9}, \\frac{5}{9}\\}$。\n\n最后，我们应用张量积法则来计算积分。该积分可以通过以下求和精确计算：\n$$\nI = \\sum_{i=1}^{2} \\sum_{j=1}^{3} w_i^x w_j^y f(x_i, y_j) = \\sum_{i=1}^{2} \\sum_{j=1}^{3} w_i^x w_j^y (x_i^3 y_j^4)\n$$\n由于被积函数和求和的可分离性，我们可以将其写成两个独立求和的乘积：\n$$\nI = \\left( \\sum_{i=1}^{2} w_i^x x_i^3 \\right) \\left( \\sum_{j=1}^{3} w_j^y y_j^4 \\right)\n$$\n让我们分别计算每个求和。\n\n$x$ 方向的求和为：\n$$\n\\sum_{i=1}^{2} w_i^x x_i^3 = w_1^x x_1^3 + w_2^x x_2^3 = (1)\\left(-\\frac{1}{\\sqrt{3}}\\right)^3 + (1)\\left(\\frac{1}{\\sqrt{3}}\\right)^3 = -\\frac{1}{3\\sqrt{3}} + \\frac{1}{3\\sqrt{3}} = 0\n$$\n\n$y$ 方向的求和为：\n$$\n\\sum_{j=1}^{3} w_j^y y_j^4 = w_1^y y_1^4 + w_2^y y_2^4 + w_3^y y_3^4\n$$\n$$\n= \\left(\\frac{5}{9}\\right) \\left(-\\sqrt{\\frac{3}{5}}\\right)^4 + \\left(\\frac{8}{9}\\right) (0)^4 + \\left(\\frac{5}{9}\\right) \\left(\\sqrt{\\frac{3}{5}}\\right)^4\n$$\n$$\n= \\left(\\frac{5}{9}\\right) \\left(\\frac{3}{5}\\right)^2 + 0 + \\left(\\frac{5}{9}\\right) \\left(\\frac{3}{5}\\right)^2 = \\left(\\frac{5}{9}\\right) \\left(\\frac{9}{25}\\right) + \\left(\\frac{5}{9}\\right) \\left(\\frac{9}{25}\\right)\n$$\n$$\n= \\frac{5}{25} + \\frac{5}{25} = \\frac{1}{5} + \\frac{1}{5} = \\frac{2}{5}\n$$\n(这与解析积分 $\\int_{-1}^{1} y^4 dy = [\\frac{y^5}{5}]_{-1}^{1} = \\frac{1}{5} - (-\\frac{1}{5}) = \\frac{2}{5}$ 的结果一致，符合预期)。\n\n综合这些结果，积分 $I$ 的值为：\n$$\nI = (0) \\times \\left(\\frac{2}{5}\\right) = 0\n$$\n积分的值精确为 $0$。", "answer": "$$\\boxed{0}$$", "id": "3567549"}, {"introduction": "最后一个实践转向在有限元分析中无处不在的、几何形状更复杂的三角形单元。你将使用一个非张量积的对称求积法则，验证其对二次多项式的精确性，并识别其在处理三次项时的局限性。这个练习对于理解如何为非矩形形状的单元选择和验证合适的积分方案至关重要 ([@problem_id:3567605])。", "problem": "在计算固体力学中，在组装一致质量矩阵和单元刚度矩阵时，会出现对三角形有限元的积分。考虑参考三角形 $\\mathcal{T}=\\{(x,y)\\in\\mathbb{R}^{2}: x\\geq 0,\\ y\\geq 0,\\ x+y\\leq 1\\}$，其顶点位于 $(0,0)$、$(1,0)$ 和 $(0,1)$。一个在 $\\mathcal{T}$ 上广泛使用的对称 $3$ 点求积法则将节点置于重心坐标 $(\\frac{2}{3},\\frac{1}{6},\\frac{1}{6})$ 及其循环排列处，其笛卡尔坐标为\n$$(x_{1},y_{1})=\\left(\\frac{1}{6},\\frac{1}{6}\\right),\\quad (x_{2},y_{2})=\\left(\\frac{2}{3},\\frac{1}{6}\\right),\\quad (x_{3},y_{3})=\\left(\\frac{1}{6},\\frac{2}{3}\\right),$$\n权重 $w$ 相等，且选择的 $w$ 值使得该法则能精确积分 $\\mathcal{T}$ 上的常数函数。求积近似值为\n$$\\widehat{I}[f]\\;=\\;\\sum_{i=1}^{3} w\\, f(x_{i},y_{i}).$$\n仅使用 $\\mathbb{R}^{2}$ 上积分的基本定义和直接计算，验证这个 $3$ 点对称三角形法则能精确积分 $\\mathcal{T}$ 上所有全次数至多为 $2$ 的多项式。然后，找出一个该法则不能精确积分的三次单项式，并计算其求积误差\n$$E[f]\\;=\\;\\widehat{I}[f]\\;-\\;\\int_{\\mathcal{T}} f(x,y)\\,\\mathrm{d}A,$$\n对于你选择的单项式。作为一个具体的、完全指定的计算，报告 $E[x^{3}]$ 的精确值作为你的最终答案。不要对答案进行四舍五入。", "solution": "函数 $f(x,y)$ 在参考三角形 $\\mathcal{T}=\\{(x,y)\\in\\mathbb{R}^{2}: x\\geq 0,\\ y\\geq 0,\\ x+y\\leq 1\\}$ 上的积分记为 $I[f] = \\int_{\\mathcal{T}} f(x,y)\\,\\mathrm{d}A$。求积近似值由 $\\widehat{I}[f]\\;=\\;\\sum_{i=1}^{3} w\\, f(x_{i},y_{i})$ 给出，其中求积点为 $(x_{1},y_{1})=(\\frac{1}{6},\\frac{1}{6})$、$(x_{2},y_{2})=(\\frac{2}{3},\\frac{1}{6})$、$(x_{3},y_{3})=(\\frac{1}{6},\\frac{2}{3})$，权重 $w$ 是一个常数。\n\n首先，我们确定权重 $w$ 的值。问题陈述 $w$ 的选择使得该法则能精确积分常数函数。我们考虑常数函数 $f(x,y) = 1$。\n精确积分是三角形 $\\mathcal{T}$ 的面积。\n$$I[1] = \\int_{\\mathcal{T}} 1 \\,\\mathrm{d}A = \\int_{0}^{1} \\int_{0}^{1-x} 1 \\,\\mathrm{d}y\\,\\mathrm{d}x = \\int_{0}^{1} [y]_{0}^{1-x} \\,\\mathrm{d}x = \\int_{0}^{1} (1-x) \\,\\mathrm{d}x = \\left[x - \\frac{x^2}{2}\\right]_{0}^{1} = 1 - \\frac{1}{2} = \\frac{1}{2}.$$\n对于 $f(x,y) = 1$ 的求积近似值为：\n$$\\widehat{I}[1] = w \\, f(x_1, y_1) + w \\, f(x_2, y_2) + w \\, f(x_3, y_3) = w(1) + w(1) + w(1) = 3w.$$\n为使该法则对常数函数精确，我们必须有 $\\widehat{I}[1] = I[1]$，这得出 $3w = \\frac{1}{2}$，所以 $w = \\frac{1}{6}$。\n\n接下来，我们验证该法则对所有全次数至多为 $2$ 的多项式都是精确的。全次数至多为 $2$ 的多项式空间的一组基是 $\\{1, x, y, x^2, xy, y^2\\}$。由于积分和求积和都是线性算子，我们只需对每个基函数验证其精确性。我们已经对 $f(x,y)=1$ 证明了这一点。\n\n对于 $f(x,y) = x$：\n$$I[x] = \\int_{0}^{1} \\int_{0}^{1-x} x \\,\\mathrm{d}y\\,\\mathrm{d}x = \\int_{0}^{1} x(1-x) \\,\\mathrm{d}x = \\int_{0}^{1} (x - x^2) \\,\\mathrm{d}x = \\left[\\frac{x^2}{2} - \\frac{x^3}{3}\\right]_{0}^{1} = \\frac{1}{2} - \\frac{1}{3} = \\frac{1}{6}.$$\n$$\\widehat{I}[x] = w \\sum_{i=1}^{3} x_i = \\frac{1}{6} \\left(\\frac{1}{6} + \\frac{2}{3} + \\frac{1}{6}\\right) = \\frac{1}{6} \\left(\\frac{1}{6} + \\frac{4}{6} + \\frac{1}{6}\\right) = \\frac{1}{6} \\left(\\frac{6}{6}\\right) = \\frac{1}{6}.$$\n该法则对 $f(x,y)=x$ 是精确的。\n\n对于 $f(x,y) = y$：\n根据区域 $\\mathcal{T}$ 和求积点相对于直线 $y=x$ 的对称性，我们可以断定 $I[y] = I[x] = \\frac{1}{6}$。我们来验证其近似值：\n$$\\widehat{I}[y] = w \\sum_{i=1}^{3} y_i = \\frac{1}{6} \\left(\\frac{1}{6} + \\frac{1}{6} + \\frac{2}{3}\\right) = \\frac{1}{6} \\left(\\frac{1}{6} + \\frac{1}{6} + \\frac{4}{6}\\right) = \\frac{1}{6} \\left(\\frac{6}{6}\\right) = \\frac{1}{6}.$$\n该法则对 $f(x,y)=y$ 是精确的。\n\n对于 $f(x,y) = x^2$：\n$$I[x^2] = \\int_{0}^{1} \\int_{0}^{1-x} x^2 \\,\\mathrm{d}y\\,\\mathrm{d}x = \\int_{0}^{1} x^2(1-x) \\,\\mathrm{d}x = \\int_{0}^{1} (x^2 - x^3) \\,\\mathrm{d}x = \\left[\\frac{x^3}{3} - \\frac{x^4}{4}\\right]_{0}^{1} = \\frac{1}{3} - \\frac{1}{4} = \\frac{1}{12}.$$\n$$\\widehat{I}[x^2] = w \\sum_{i=1}^{3} x_i^2 = \\frac{1}{6} \\left( \\left(\\frac{1}{6}\\right)^2 + \\left(\\frac{2}{3}\\right)^2 + \\left(\\frac{1}{6}\\right)^2 \\right) = \\frac{1}{6} \\left(\\frac{1}{36} + \\frac{4}{9} + \\frac{1}{36}\\right) = \\frac{1}{6} \\left(\\frac{1}{36} + \\frac{16}{36} + \\frac{1}{36}\\right) = \\frac{1}{6} \\left(\\frac{18}{36}\\right) = \\frac{1}{6} \\cdot \\frac{1}{2} = \\frac{1}{12}.$$\n该法则对 $f(x,y)=x^2$ 是精确的。\n\n对于 $f(x,y) = y^2$：\n根据对称性， $I[y^2] = I[x^2] = \\frac{1}{12}$。\n$$\\widehat{I}[y^2] = w \\sum_{i=1}^{3} y_i^2 = \\frac{1}{6} \\left( \\left(\\frac{1}{6}\\right)^2 + \\left(\\frac{1}{6}\\right)^2 + \\left(\\frac{2}{3}\\right)^2 \\right) = \\frac{1}{6} \\left(\\frac{1}{36} + \\frac{1}{36} + \\frac{16}{36}\\right) = \\frac{1}{6} \\left(\\frac{18}{36}\\right) = \\frac{1}{12}.$$\n该法则对 $f(x,y)=y^2$ 是精确的。\n\n对于 $f(x,y) = xy$：\n$$I[xy] = \\int_{0}^{1} \\int_{0}^{1-x} xy \\,\\mathrm{d}y\\,\\mathrm{d}x = \\int_{0}^{1} x \\left[\\frac{y^2}{2}\\right]_{0}^{1-x} \\,\\mathrm{d}x = \\frac{1}{2} \\int_{0}^{1} x(1-x)^2 \\,\\mathrm{d}x = \\frac{1}{2} \\int_{0}^{1} (x - 2x^2 + x^3) \\,\\mathrm{d}x = \\frac{1}{2} \\left[\\frac{x^2}{2} - \\frac{2x^3}{3} + \\frac{x^4}{4}\\right]_{0}^{1} = \\frac{1}{2} \\left(\\frac{1}{2} - \\frac{2}{3} + \\frac{1}{4}\\right) = \\frac{1}{2} \\left(\\frac{6 - 8 + 3}{12}\\right) = \\frac{1}{24}.$$\n$$\\widehat{I}[xy] = w \\sum_{i=1}^{3} x_i y_i = \\frac{1}{6} \\left( \\left(\\frac{1}{6}\\right)\\left(\\frac{1}{6}\\right) + \\left(\\frac{2}{3}\\right)\\left(\\frac{1}{6}\\right) + \\left(\\frac{1}{6}\\right)\\left(\\frac{2}{3}\\right) \\right) = \\frac{1}{6} \\left(\\frac{1}{36} + \\frac{2}{18} + \\frac{2}{18}\\right) = \\frac{1}{6} \\left(\\frac{1}{36} + \\frac{4}{36} + \\frac{4}{36}\\right) = \\frac{1}{6} \\left(\\frac{9}{36}\\right) = \\frac{1}{6} \\cdot \\frac{1}{4} = \\frac{1}{24}.$$\n该法则对 $f(x,y)=xy$ 是精确的。\n由于该法则对所有全次数至多为 $2$ 的基多项式都是精确的，因此它对任何全次数至多为 $2$ 的多项式都是精确的。验证完成。\n\n最后，我们必须计算单项式 $f(x,y) = x^3$ 的求积误差 $E[f]=\\widehat{I}[f] - I[f]$。\n首先，我们计算精确积分：\n$$I[x^3] = \\int_{0}^{1} \\int_{0}^{1-x} x^3 \\,\\mathrm{d}y\\,\\mathrm{d}x = \\int_{0}^{1} x^3(1-x) \\,\\mathrm{d}x = \\int_{0}^{1} (x^3 - x^4) \\,\\mathrm{d}x = \\left[\\frac{x^4}{4} - \\frac{x^5}{5}\\right]_{0}^{1} = \\frac{1}{4} - \\frac{1}{5} = \\frac{1}{20}.$$\n接下来，我们计算求积近似值：\n$$\\widehat{I}[x^3] = w \\sum_{i=1}^{3} x_i^3 = \\frac{1}{6} \\left( \\left(\\frac{1}{6}\\right)^3 + \\left(\\frac{2}{3}\\right)^3 + \\left(\\frac{1}{6}\\right)^3 \\right) = \\frac{1}{6} \\left( \\frac{1}{216} + \\frac{8}{27} + \\frac{1}{216} \\right) = \\frac{1}{6} \\left( \\frac{2}{216} + \\frac{8}{27} \\right) = \\frac{1}{6} \\left( \\frac{1}{108} + \\frac{8 \\cdot 4}{27 \\cdot 4} \\right) = \\frac{1}{6} \\left( \\frac{1}{108} + \\frac{32}{108} \\right) = \\frac{1}{6} \\left(\\frac{33}{108}\\right).$$\n将分数 $\\frac{33}{108}$ 的分子和分母同除以 $3$ 进行化简，得到 $\\frac{11}{36}$。\n$$\\widehat{I}[x^3] = \\frac{1}{6} \\cdot \\frac{11}{36} = \\frac{11}{216}.$$\n积分值 $I[x^3] = \\frac{1}{20}$ 和 $\\widehat{I}[x^3] = \\frac{11}{216}$ 不相等，这证实了该三次单项式未被精确积分。\n\n求积误差为：\n$$E[x^3] = \\widehat{I}[x^3] - I[x^3] = \\frac{11}{216} - \\frac{1}{20}.$$\n为了找到公分母，我们计算 $216$ 和 $20$ 的最小公倍数。$216 = 2^3 \\cdot 3^3$ 且 $20 = 2^2 \\cdot 5$。最小公倍数是 $2^3 \\cdot 3^3 \\cdot 5 = 8 \\cdot 27 \\cdot 5 = 1080$。\n$$E[x^3] = \\frac{11 \\cdot 5}{216 \\cdot 5} - \\frac{1 \\cdot 54}{20 \\cdot 54} = \\frac{55}{1080} - \\frac{54}{1080} = \\frac{1}{1080}.$$\n$f(x,y)=x^3$ 的求积误差的精确值为 $\\frac{1}{1080}$。", "answer": "$$\\boxed{\\frac{1}{1080}}$$", "id": "3567605"}]}