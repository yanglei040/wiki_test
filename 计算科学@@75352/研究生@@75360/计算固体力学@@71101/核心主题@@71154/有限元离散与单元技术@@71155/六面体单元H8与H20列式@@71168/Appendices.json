{"hands_on_practices": [{"introduction": "我们从最基础的8节点六面体单元（H8）开始。这项实践将引导你从第一性原理出发，推导其三线性形函数，理解通过雅可比矩阵实现的等参映射，并构建一致质量矩阵。掌握这些基本步骤对于理解有限元如何描述几何与物理特性至关重要，是计算力学后续所有分析的基石。[@problem_id:3570555]", "problem": "考虑在三维实体力学中，有限元法 (FEM) 所使用的八节点六面体 (H8) 等参有限元。参考单元占据参数域 $[-1,1] \\times [-1,1] \\times [-1,1]$，其局部坐标为 $(\\xi,\\eta,\\zeta)$。物理单元是一个与全局笛卡尔坐标轴对齐的矩形砖块，边长分别为 $L_x$、$L_y$ 和 $L_z$，其顶点位于 $(0,0,0)$、$(L_x,0,0)$、$(L_x,L_y,0)$、$(0,L_y,0)$、$(0,0,L_z)$、$(L_x,0,L_z)$、$(L_x,L_y,L_z)$、$(0,L_y,L_z)$。质量密度是均匀的，等于 $\\rho$。\n\n从插值和等参映射的基本原理出发，通过在八个角点 $(\\xi,\\eta,\\zeta) \\in \\{-1,1\\}^3$ 处施加节点插值属性，推导参考域上的 H8 形函数。证明这些形函数在参考域上具有单位分解性。使用等参映射 $x(\\xi,\\eta,\\zeta) = \\sum_{i=1}^{8} N_i(\\xi,\\eta,\\zeta) \\, x_i$，$y(\\xi,\\eta,\\zeta) = \\sum_{i=1}^{8} N_i(\\xi,\\eta,\\zeta) \\, y_i$，$z(\\xi,\\eta,\\zeta) = \\sum_{i=1}^{8} N_i(\\xi,\\eta,\\zeta) \\, z_i$，推导上述矩形砖块的雅可比行列式 $J(\\xi,\\eta,\\zeta)$。\n\n然后，从连续介质动能及其 Galerkin 离散化出发，写出与节点 $(\\xi,\\eta,\\zeta) = (-1,-1,-1)$ 相关的一致质量矩阵项 $M_{11}$ 的表达式，用该节点的形函数表示。对于给定的矩形砖块和均匀密度，精确计算 $M_{11}$。\n\n最后，计算当 $L_x = 1.2\\,\\mathrm{m}$、$L_y = 0.8\\,\\mathrm{m}$、$L_z = 0.5\\,\\mathrm{m}$ 和 $\\rho = 7{,}850\\,\\mathrm{kg/m^3}$ 时 $M_{11}$ 的值。将最终结果四舍五入到四位有效数字。以千克 (kg) 为单位表示最终质量。最终答案必须是单个实数值。", "solution": "首先验证问题，以确保其具有科学依据、是良定的和客观的。\n\n**第 1 步：提取已知条件**\n- 单元：八节点六面体 (H8) 等参有限元。\n- 领域：三维 (3D) 实体力学。\n- 参考单元：参数域 $[-1,1] \\times [-1,1] \\times [-1,1]$，局部坐标为 $(\\xi,\\eta,\\zeta)$。\n- 物理单元：矩形砖块，边长为 $L_x$、$L_y$ 和 $L_z$。\n- 顶点：砖块的 8 个顶点位于 $(0,0,0)$、$(L_x,0,0)$、$(L_x,L_y,0)$、$(0,L_y,0)$、$(0,0,L_z)$、$(L_x,0,L_z)$、$(L_x,L_y,L_z)$、$(0,L_y,L_z)$。\n- 材料属性：均匀质量密度 $\\rho$。\n- 任务：\n  1. 推导 H8 形函数 $N_i(\\xi,\\eta,\\zeta)$。\n  2. 证明单位分解性。\n  3. 推导映射的雅可比行列式 $J(\\xi,\\eta,\\zeta)$。\n  4. 写出与节点 $(\\xi,\\eta,\\zeta) = (-1,-1,-1)$ 相关的一致质量矩阵项 $M_{11}$ 的表达式。\n  5. 解析计算 $M_{11}$。\n  6. 当 $L_x = 1.2\\,\\mathrm{m}$、$L_y = 0.8\\,\\mathrm{m}$、$L_z = 0.5\\,\\mathrm{m}$ 和 $\\rho = 7{,}850\\,\\mathrm{kg/m^3}$ 时，计算 $M_{11}$ 的值，并四舍五入到四位有效数字。\n\n**第 2 步：使用提取的已知条件进行验证**\n- **有科学依据：** 问题是有限元法 (FEM) 在线性弹性动力学中的一个标准应用，其根植于连续介质力学和数值分析的既定原理。所有概念都是计算固体力学的基础。\n- **良定性：** 问题提供了推导唯一且有意义的解所需的所有必要的几何数据、材料属性和定义。\n- **客观性：** 问题使用有限元领域的精确、标准术语陈述，没有歧义或主观看法。\n\n问题不违反任何无效性标准。它是计算力学中一个完整、一致和标准的问题。\n\n**第 3 步：结论与行动**\n问题有效。将制定一个完整的解决方案。\n\n**H8 形函数的推导**\nH8 单元形函数是三线性多项式，由一维线性拉格朗日多项式的乘积构成。在参考域 $\\xi \\in [-1, 1]$ 中，一端为 1 另一端为 0 的线性基函数是 $L_{-1}(\\xi) = \\frac{1}{2}(1-\\xi)$ 和 $L_{+1}(\\xi) = \\frac{1}{2}(1+\\xi)$。\n\n位于角点 $(\\xi_i, \\eta_i, \\zeta_i)$（其中 $\\xi_i, \\eta_i, \\zeta_i \\in \\{-1, 1\\}$）的节点 $i$ 的形函数 $N_i(\\xi, \\eta, \\zeta)$ 是由每个坐标方向上相应线性函数的乘积形成的。这种构造内在地满足了节点插值属性，$N_i(\\xi_j, \\eta_j, \\zeta_j) = \\delta_{ij}$。\n\n节点 $i$ 的形函数的一般形式是：\n$$N_i(\\xi, \\eta, \\zeta) = \\left( \\frac{1}{2}(1 + \\xi_i\\xi) \\right) \\left( \\frac{1}{2}(1 + \\eta_i\\eta) \\right) \\left( \\frac{1}{2}(1 + \\zeta_i\\zeta) \\right) = \\frac{1}{8}(1 + \\xi_i\\xi)(1 + \\eta_i\\eta)(1 + \\zeta_i\\zeta)$$\n\n**单位分解性**\n单位分解性断言，在单元内任何位置，所有形函数的总和都等于 1。我们必须证明 $\\sum_{i=1}^{8} N_i(\\xi, \\eta, \\zeta) = 1$。\n$$ \\sum_{i=1}^{8} N_i(\\xi, \\eta, \\zeta) = \\frac{1}{8} \\sum_{i=1}^{8} (1 + \\xi_i\\xi)(1 + \\eta_i\\eta)(1 + \\zeta_i\\zeta) $$\n求和是在所有 8 个节点位置上进行的，即对 $(\\xi_i, \\eta_i, \\zeta_i) \\in \\{-1,1\\}^3$ 的所有组合进行求和。\n让我们展开乘积项：\n$$ (1 + \\xi_i\\xi)(1 + \\eta_i\\eta)(1 + \\zeta_i\\zeta) = 1 + \\xi_i\\xi + \\eta_i\\eta + \\zeta_i\\zeta + \\xi_i\\eta_i\\xi\\eta + \\xi_i\\zeta_i\\xi\\zeta + \\eta_i\\zeta_i\\eta\\zeta + \\xi_i\\eta_i\\zeta_i\\xi\\eta\\zeta $$\n当对 8 个节点求和时，任何包含 $\\xi_i, \\eta_i,$ 或 $\\zeta_i$ 中至少一个的项其和将为零。例如，考虑项 $\\xi_i\\xi$。对 8 个节点求和为 $\\xi \\sum_{i=1}^8 \\xi_i = \\xi(4 \\times 1 + 4 \\times (-1)) = 0$。同样的逻辑适用于所有其他混合项（例如，$\\sum \\xi_i\\eta_i = 2 \\times (1 \\cdot 1) + 2 \\times (1 \\cdot -1) + 2 \\times (-1 \\cdot 1) + 2 \\times (-1 \\cdot -1) = 0$）。只有常数项 '1' 保留下来。\n$$ \\sum_{i=1}^{8} (1 + \\xi_i\\xi + \\dots) = \\sum_{i=1}^{8} 1 = 8 $$\n因此，\n$$ \\sum_{i=1}^{8} N_i(\\xi, \\eta, \\zeta) = \\frac{1}{8} \\times 8 = 1 $$\n这证实了单位分解性。\n\n**等参映射和雅可比行列式**\n全局坐标 $(x, y, z)$ 使用形函数从局部坐标 $(\\xi, \\eta, \\zeta)$ 映射而来：\n$x(\\xi, \\eta, \\zeta) = \\sum_{i=1}^{8} N_i x_i$，$y(\\xi, \\eta, \\zeta) = \\sum_{i=1}^{8} N_i y_i$，$z(\\xi, \\eta, \\zeta) = \\sum_{i=1}^{8} N_i z_i$。\n对于给定的矩形砖块，映射简化了。利用单位分解性和组合项，我们可以证明：\n$x(\\xi, \\eta, \\zeta) = \\frac{L_x}{2}(1+\\xi)$\n$y(\\xi, \\eta, \\zeta) = \\frac{L_y}{2}(1+\\eta)$\n$z(\\xi, \\eta, \\zeta) = \\frac{L_z}{2}(1+\\zeta)$\n变换的雅可比矩阵 $\\mathbf{J}$ 由下式给出：\n$$ \\mathbf{J} = \\begin{pmatrix} \\frac{\\partial x}{\\partial \\xi}  \\frac{\\partial y}{\\partial \\xi}  \\frac{\\partial z}{\\partial \\xi} \\\\ \\frac{\\partial x}{\\partial \\eta}  \\frac{\\partial y}{\\partial \\eta}  \\frac{\\partial z}{\\partial \\eta} \\\\ \\frac{\\partial x}{\\partial \\zeta}  \\frac{\\partial y}{\\partial \\zeta}  \\frac{\\partial z}{\\partial \\zeta} \\end{pmatrix}^T = \\begin{pmatrix} \\frac{\\partial x}{\\partial \\xi}  \\frac{\\partial x}{\\partial \\eta}  \\frac{\\partial x}{\\partial \\zeta} \\\\ \\frac{\\partial y}{\\partial \\xi}  \\frac{\\partial y}{\\partial \\eta}  \\frac{\\partial y}{\\partial \\zeta} \\\\ \\frac{\\partial z}{\\partial \\xi}  \\frac{\\partial z}{\\partial \\eta}  \\frac{\\partial z}{\\partial \\zeta} \\end{pmatrix} $$\n计算偏导数：\n$\\frac{\\partial x}{\\partial \\xi} = \\frac{L_x}{2}$，$\\frac{\\partial x}{\\partial \\eta} = 0$，$\\frac{\\partial x}{\\partial \\zeta} = 0$\n$\\frac{\\partial y}{\\partial \\xi} = 0$，$\\frac{\\partial y}{\\partial \\eta} = \\frac{L_y}{2}$，$\\frac{\\partial y}{\\partial \\zeta} = 0$\n$\\frac{\\partial z}{\\partial \\xi} = 0$，$\\frac{\\partial z}{\\partial \\eta} = 0$，$\\frac{\\partial z}{\\partial \\zeta} = \\frac{L_z}{2}$\n雅可比矩阵是一个常数对角矩阵：\n$$ \\mathbf{J} = \\begin{pmatrix} L_x/2  0  0 \\\\ 0  L_y/2  0 \\\\ 0  0  L_z/2 \\end{pmatrix} $$\n雅可比行列式 $J$ 是该矩阵的行列式：\n$$ J = \\det(\\mathbf{J}) = \\left(\\frac{L_x}{2}\\right) \\left(\\frac{L_y}{2}\\right) \\left(\\frac{L_z}{2}\\right) = \\frac{L_x L_y L_z}{8} $$\n\n**一致质量矩阵项 $M_{11}$**\n一致质量矩阵将节点加速度与节点力联系起来。其矩阵项由 $M_{ab} = \\int_{V} \\rho N_a N_b \\, dV$ 给出，其中 $a$ 和 $b$ 指的是全局自由度。完整的质量矩阵由每对节点 $i$ 和 $j$ 的 $3 \\times 3$ 块 $\\mathbf{M}_{ij}$ 组成。对于各向同性的材料属性 $\\rho$，该块为 $\\mathbf{M}_{ij} = m_{ij} \\mathbf{I}$，其中 $m_{ij} = \\int_V \\rho N_i N_j \\, dV$ 且 $\\mathbf{I}$ 是 $3 \\times 3$ 单位矩阵。\n矩阵项 $M_{11}$ 对应于第一个节点的第一个自由度。设节点 1 位于 $(\\xi_1, \\eta_1, \\zeta_1) = (-1, -1, -1)$。其 x-位移的质量矩阵项是 $\\mathbf{M}_{11}$ 块的左上角元素，即 $m_{11}$。\n$$ M_{11} = m_{11} = \\int_{V} \\rho N_1^2 \\, dV $$\n为了计算这个积分，我们将其转换到参考单元域：$dV = J\\,d\\xi d\\eta d\\zeta$。\n$$ M_{11} = \\int_{-1}^{1}\\int_{-1}^{1}\\int_{-1}^{1} \\rho [N_1(\\xi, \\eta, \\zeta)]^2 J \\, d\\xi d\\eta d\\zeta $$\n节点 1 在 $(\\xi_1, \\eta_1, \\zeta_1) = (-1, -1, -1)$ 处的形函数是：\n$$ N_1(\\xi, \\eta, \\zeta) = \\frac{1}{8}(1 - \\xi)(1 - \\eta)(1 - \\zeta) $$\n将 $N_1$ 和 $J$ 代入积分：\n$$ M_{11} = \\rho \\left( \\frac{L_x L_y L_z}{8} \\right) \\int_{-1}^{1}\\int_{-1}^{1}\\int_{-1}^{1} \\left[ \\frac{1}{8}(1-\\xi)(1-\\eta)(1-\\zeta) \\right]^2 d\\xi d\\eta d\\zeta $$\n$$ M_{11} = \\rho \\frac{L_x L_y L_z}{8 \\cdot 64} \\int_{-1}^{1} (1-\\xi)^2 d\\xi \\int_{-1}^{1} (1-\\eta)^2 d\\eta \\int_{-1}^{1} (1-\\zeta)^2 d\\zeta $$\n让我们计算这个一维积分：\n$$ \\int_{-1}^{1} (1-u)^2 \\, du = \\int_{-1}^{1} (1 - 2u + u^2) \\, du = \\left[ u - u^2 + \\frac{u^3}{3} \\right]_{-1}^{1} $$\n$$ = \\left(1 - 1^2 + \\frac{1^3}{3}\\right) - \\left(-1 - (-1)^2 + \\frac{(-1)^3}{3}\\right) = \\left(\\frac{1}{3}\\right) - \\left(-1 - 1 - \\frac{1}{3}\\right) = \\frac{1}{3} - \\left(-\\frac{7}{3}\\right) = \\frac{8}{3} $$\n三重积分是三个这样积分的乘积：\n$$ \\left(\\frac{8}{3}\\right) \\times \\left(\\frac{8}{3}\\right) \\times \\left(\\frac{8}{3}\\right) = \\frac{512}{27} $$\n将此结果代回 $M_{11}$ 的表达式中：\n$$ M_{11} = \\rho \\frac{L_x L_y L_z}{512} \\left( \\frac{512}{27} \\right) = \\frac{\\rho L_x L_y L_z}{27} $$\n这就是矩阵项 $M_{11}$ 的精确解析表达式。\n\n**数值计算**\n给定值为：\n$L_x = 1.2\\,\\mathrm{m}$\n$L_y = 0.8\\,\\mathrm{m}$\n$L_z = 0.5\\,\\mathrm{m}$\n$\\rho = 7850\\,\\mathrm{kg/m^3}$\n\n首先，计算砖块的体积 $V$：\n$$ V = L_x L_y L_z = 1.2 \\times 0.8 \\times 0.5 = 0.48\\,\\mathrm{m^3} $$\n然后，计算单元的总质量 $M_{\\text{total}}$：\n$$ M_{\\text{total}} = \\rho V = 7850\\,\\mathrm{kg/m^3} \\times 0.48\\,\\mathrm{m^3} = 3768\\,\\mathrm{kg} $$\n现在，计算 $M_{11}$：\n$$ M_{11} = \\frac{\\rho V}{27} = \\frac{M_{\\text{total}}}{27} = \\frac{3768}{27} \\approx 139.555... \\,\\mathrm{kg} $$\n将结果四舍五入到四位有效数字得到：\n$$ M_{11} = 139.6\\,\\mathrm{kg} $$\n最终答案是质量的数值，单位为千克。", "answer": "$$\\boxed{139.6}$$", "id": "3570555"}, {"introduction": "在掌握了线性H8单元之后，我们进阶到更高级的20节点二次单元（H20）。本练习聚焦于如何利用插值和边界条件，推导一个“巧凑”单元的边中点形函数。通过这项实践，你不仅能理解高阶单元的构造方法以获得更高精度，还能体会巧凑族单元背后精妙的设计逻辑，从而提升处理复杂公式时的建模能力。[@problem_id:3570589]", "problem": "考虑二十节点 serendipity 六面体单元 (H20)，其位于参考域 $\\widehat{\\Omega} = [-1,1]^{3}$ 上，自然坐标为 $(\\xi,\\eta,\\zeta)$。节点位于八个顶点 $(\\pm 1,\\pm 1,\\pm 1)$ 和十二条边的中点，即一个坐标等于 $0$ 而另外两个坐标等于 $\\pm 1$ 的点。在等参有限元法 (FEM) 插值中，每个形函数 $N_{a}(\\xi,\\eta,\\zeta)$ 都需要满足在单元节点处的克罗内克-德尔塔 (Kronecker-delta) 插值特性，并且属于 H20 单元所对应的 serendipity 多项式空间，即在每个自然坐标上最多是二次的，并且在每条边上能再现一维二次插值的多项式。\n\n关注连接顶点 $(-1,1,-1)$ 和 $(1,1,-1)$ 的边的中点，也即位于 $(\\xi,\\eta,\\zeta)=(0,1,-1)$ 的边中点。仅使用以下条件：\n- 在所有二十个节点上满足克罗内克-德尔塔插值特性，\n- 形函数在边 $\\{\\eta=1,\\zeta=-1\\}$ 上的限制能再现横坐标 $\\xi \\in \\{-1,0,1\\}$ 上的一维二次拉格朗日 (Lagrange) 插值，\n- 以及该函数在 $\\xi$ 上最多是二次的，在 $\\eta$ 和 $\\zeta$ 上最多是线性的，并在不与该边相邻的面上为零的要求，\n\n推导该边中点形函数的唯一多项式表达式（在代数简化意义下）。然后，计算该形函数在自然坐标为 $(\\xi,\\eta,\\zeta)=\\left(\\tfrac{1}{3},\\tfrac{1}{2},-\\tfrac{1}{2}\\right)$ 的点 $P$ 处的值。\n\n请以单个实数形式提供最终答案。无需单位。不要四舍五入；给出精确值。", "solution": "问题陈述经过了严格验证，被确定为是合理的。它在科学上基于有限元法的原理，是适定的，并提供了一套完整且一致的约束条件来推导唯一解。\n\n目标是为二十节点 serendipity 六面体单元 ($H20$) 中位于坐标 $(\\xi_{a}, \\eta_{a}, \\zeta_{a}) = (0, 1, -1)$ 的边中点推导其形函数 $N_{a}(\\xi, \\eta, \\zeta)$，然后在特定点 $P(\\tfrac{1}{3}, \\tfrac{1}{2}, -\\tfrac{1}{2})$ 处求值。\n\n问题陈述指出，形函数在自然坐标 $\\xi$ 上最多是二次的，在自然坐标 $\\eta$ 和 $\\zeta$ 上最多是线性的。这一结构性约束使我们能够以变量分离的形式寻找解：\n$$N_{a}(\\xi, \\eta, \\zeta) = f(\\xi) g(\\eta) h(\\zeta)$$\n其中 $f(\\xi)$ 是一个二次多项式，而 $g(\\eta)$ 和 $h(\\zeta)$ 是线性多项式。推导过程通过使用所给的约束条件来确定这些函数中的每一个。\n\n1.  **确定 $f(\\xi)$**：\n    问题要求 $N_{a}$ 在边 $\\{\\eta=1, \\zeta=-1\\}$ 上的限制必须再现一维二次拉格朗日插值。位于 $(0, 1, -1)$ 的节点 $a$ 是这条边的中心节点，该边还包含位于 $(-1, 1, -1)$ 和 $(1, 1, -1)$ 的节点。沿这条边的相应横坐标为 $\\xi \\in \\{-1, 0, 1\\}$。\n    中心节点（在 $\\xi=0$ 处）的一维二次拉格朗日基函数 $L_0(\\xi)$ 由下式给出：\n    $$L_0(\\xi) = \\frac{(\\xi - (-1))(\\xi - 1)}{(0 - (-1))(0 - 1)} = \\frac{(\\xi+1)(\\xi-1)}{-1} = 1 - \\xi^2$$\n    形函数 $N_{a}$ 必须满足克罗内克-德尔塔特性，因此 $N_a(\\xi, 1, -1)$ 在 $\\xi=0$ 时必须为 $1$，在 $\\xi=\\pm 1$ 时必须为 $0$。这正是 $L_0(\\xi)$ 所提供的。因此，我们必须有：\n    $$N_{a}(\\xi, 1, -1) = 1 - \\xi^2$$\n    代入我们的分离变量形式，得到 $f(\\xi)g(1)h(-1) = 1 - \\xi^2$。这在相差一个常数的意义下确定了 $f(\\xi)$ 的函数形式。我们可以设 $f(\\xi) = 1 - \\xi^2$，并施加归一化条件 $g(1)h(-1) = 1$。\n\n2.  **确定 $g(\\eta)$ 和 $h(\\zeta)$**：\n    问题要求形函数在不与边 $\\{\\eta=1, \\zeta=-1\\}$ 相邻的面上为零。这些不相邻的面是 $\\eta=-1$, $\\zeta=1$, $\\xi=1$ 和 $\\xi=-1$。\n    - 在面 $\\xi=\\pm 1$ 上为零的条件已经满足，因为 $f(\\pm 1) = 1 - (\\pm 1)^2 = 0$。\n    - 为了使函数在面 $\\eta=-1$ 上为零，对于所有的 $\\xi, \\zeta \\in [-1, 1]$，必须有 $N_a(\\xi, -1, \\zeta) = 0$。\n      $$N_a(\\xi, -1, \\zeta) = f(\\xi)g(-1)h(\\zeta) = (1-\\xi^2)g(-1)h(\\zeta) = 0$$\n      由于 $(1-\\xi^2)$ 和 $h(\\zeta)$ 并非恒等于零，这要求 $g(-1)=0$。由于 $g(\\eta)$ 是一个线性函数，比如说 $g(\\eta) = c_1\\eta + c_0$，这意味着 $-c_1 + c_0 = 0$，所以 $c_1=c_0$。我们可以将 $g(\\eta)$ 写为 $g(\\eta) = c_0(1+\\eta)$。\n    - 类似地，为了使函数在面 $\\zeta=1$ 上为零，对于所有的 $\\xi, \\eta \\in [-1, 1]$，必须有 $N_a(\\xi, \\eta, 1) = 0$。\n      $$N_a(\\xi, \\eta, 1) = f(\\xi)g(\\eta)h(1) = (1-\\xi^2)g(\\eta)h(1) = 0$$\n      这要求 $h(1)=0$。由于 $h(\\zeta)$ 是一个线性函数，比如说 $h(\\zeta) = d_1\\zeta + d_0$，这意味着 $d_1 + d_0 = 0$，所以 $d_1=-d_0$。我们可以将 $h(\\zeta)$ 写为 $h(\\zeta) = d_0(1-\\zeta)$。\n\n3.  **组合与归一化**：\n    我们组合 $f(\\xi)$, $g(\\eta)$ 和 $h(\\zeta)$ 的表达式：\n    $$N_{a}(\\xi, \\eta, \\zeta) = (1-\\xi^2) \\cdot c_0(1+\\eta) \\cdot d_0(1-\\zeta) = c_0 d_0 (1-\\xi^2)(1+\\eta)(1-\\zeta)$$\n    现在我们应用归一化条件 $g(1)h(-1)=1$。\n    由 $g(\\eta) = c_0(1+\\eta)$，我们有 $g(1)=2c_0$。\n    由 $h(\\zeta) = d_0(1-\\zeta)$，我们有 $h(-1)=d_0(1-(-1))=2d_0$。\n    条件变为 $(2c_0)(2d_0) = 4c_0d_0 = 1$，这给出 $c_0d_0 = \\frac{1}{4}$。\n    将这个常数代回 $N_a$ 的表达式，得到形函数的最终唯一多项式：\n    $$N_{a}(\\xi, \\eta, \\zeta) = \\frac{1}{4}(1-\\xi^2)(1+\\eta)(1-\\zeta)$$\n    这个函数满足问题的所有约束，包括在 H20 单元的所有 20 个节点上的克罗内克-德尔塔特性。在节点 $a=(0,1,-1)$ 处，$N_a(0,1,-1) = \\frac{1}{4}(1-0^2)(1+1)(1-(-1)) = \\frac{1}{4}(1)(2)(2) = 1$。在任何其他节点处，因子 $(1-\\xi^2)$, $(1+\\eta)$ 或 $(1-\\zeta)$ 中至少有一个会是零。\n\n4.  **在点 P 处求值**：\n    最后，我们在坐标为 $(\\xi, \\eta, \\zeta) = (\\frac{1}{3}, \\frac{1}{2}, -\\frac{1}{2})$ 的点 $P$ 处计算所推导的形函数的值。\n    $$N_{a}\\left(\\frac{1}{3}, \\frac{1}{2}, -\\frac{1}{2}\\right) = \\frac{1}{4}\\left(1 - \\left(\\frac{1}{3}\\right)^2\\right)\\left(1 + \\frac{1}{2}\\right)\\left(1 - \\left(-\\frac{1}{2}\\right)\\right)$$\n    我们分别计算每一项：\n    $$1 - \\left(\\frac{1}{3}\\right)^2 = 1 - \\frac{1}{9} = \\frac{8}{9}$$\n    $$1 + \\frac{1}{2} = \\frac{3}{2}$$\n    $$1 - \\left(-\\frac{1}{2}\\right) = 1 + \\frac{1}{2} = \\frac{3}{2}$$\n    将这些值代入主表达式中：\n    $$N_{a}\\left(\\frac{1}{3}, \\frac{1}{2}, -\\frac{1}{2}\\right) = \\frac{1}{4} \\cdot \\frac{8}{9} \\cdot \\frac{3}{2} \\cdot \\frac{3}{2}$$\n    $$N_{a}\\left(\\frac{1}{3}, \\frac{1}{2}, -\\frac{1}{2}\\right) = \\frac{1 \\cdot 8 \\cdot 3 \\cdot 3}{4 \\cdot 9 \\cdot 2 \\cdot 2} = \\frac{72}{144} = \\frac{1}{2}$$\n    形函数在点 $P$ 处的精确值为 $\\frac{1}{2}$。", "answer": "$$\\boxed{\\frac{1}{2}}$$", "id": "3570589"}, {"introduction": "建立单元公式后，我们来探讨一个关键的数值问题：H8单元中的“沙漏”现象。本问题研究了在H8单元上使用减缩积分（一种提高计算效率和性能的常用技术）所带来的后果，要求计算在此情况下产生的非物理、零能量变形模式（即沙漏模式）的数量。这项分析对于有限元实际应用至关重要，因为它揭示了数值模拟中一个潜在的不稳定根源，而理解和识别沙漏模式是确保计算结果可靠性和准确性的核心技能。[@problem_id:3570550]", "problem": "考虑一个在三维线性弹性力学中，通过有限元法 (FEM) 构建的等参 8 节点六面体 (H8) 有限元。其父域为立方体 $[-1,1] \\times [-1,1] \\times [-1,1]$，自然坐标为 $(\\xi,\\eta,\\zeta)$，并采用标准的三线性形函数。该单元通过一个仿射、可逆的变换映射到一个物理平行六面体，该变换具有恒定的雅可比矩阵 $\\mathbf{J}$ 和恒定的行列式 $\\det \\mathbf{J} \\neq 0$。材料是均匀的线性弹性体，具有正定的本构张量 $\\mathbf{D}$。\n\n从虚功原理和单元刚度矩阵（定义为应变-位移算子的域积分）出发，考虑采用在形心 $(\\xi,\\eta,\\zeta)=(0,0,0)$ 处使用单个高斯点及相应的三维高斯权重的减缩积分方案。在这种减缩积分下，离散单元刚度成为一个单点近似，仅取决于在形心处计算的应变-位移矩阵。\n\n确定在该减缩积分下，单元离散刚度的非刚体零能子空间（即所谓的沙漏模式）的维数（以单个整数表示）。也就是说，计算在排除刚体模式后，能够产生零内应变能的线性无关节点位移向量的数量。请以单个整数形式提供最终答案，不带单位。无需四舍五入。", "solution": "用户希望确定在单点减缩积分下，8 节点六面体单元的非刚体零能子空间（沙漏模式）的维数。\n\n### 问题验证\n\n**步骤 1：提取已知条件**\n- 单元：等参 8 节点六面体 (H8)。\n- 物理背景：3D 线性弹性力学。\n- 父域：立方体 $[-1,1] \\times [-1,1] \\times [-1,1]$，坐标为 $(\\xi,\\eta,\\zeta)$。\n- 形函数：标准三线性。\n- 映射：到物理平行六面体的仿射、可逆变换。\n- 雅可比矩阵：恒定矩阵 $\\mathbf{J}$，且 $\\det \\mathbf{J} \\neq 0$。\n- 材料：均匀、线性弹性、正定本构张量 $\\mathbf{D}$。\n- 积分方案：在形心 $(\\xi,\\eta,\\zeta)=(0,0,0)$ 处使用单个高斯点的减缩积分。\n- 目标：确定非刚体零能子空间（沙漏模式）的维数。\n\n**步骤 2：使用提取的已知条件进行验证**\n- **科学依据：** 该问题是有限元法 (FEM) 理论中的一个标准课题，具体涉及欠积分实体单元的数值稳定性。等参映射、减缩积分和沙漏现象等概念是计算固体力学的基础。所有前提在事实上和科学上都是合理的。\n- **适定性：** 问题定义清晰。它要求在一组精确的假设下，求一个特定的整数（一个向量子空间的维数）。所提供的条件足以得出一个唯一的、有意义的答案。\n- **客观性：** 语言正式、精确，没有任何主观或模糊的术语。\n\n该问题是有效的，因为它具有科学依据、适定性和客观性。它是计算力学中一个标准的、可形式化的问题。\n\n### 解答\n\n单元刚度矩阵 $\\mathbf{K}^e$ 由虚功原理导出，通过在单元物理体积 $V^e$ 上的积分给出：\n$$ \\mathbf{K}^e = \\int_{V^e} \\mathbf{B}^T \\mathbf{D} \\mathbf{B} \\, dV $$\n其中 $\\mathbf{B}$ 是应变-位移矩阵，$\\mathbf{D}$ 是本构材料张量。\n\n使用等参格式，该积分被转换到由 $\\xi, \\eta, \\zeta \\in [-1, 1]$ 定义的父域（一个立方体）上：\n$$ \\mathbf{K}^e = \\int_{-1}^{1} \\int_{-1}^{1} \\int_{-1}^{1} \\mathbf{B}(\\xi, \\eta, \\zeta)^T \\mathbf{D} \\mathbf{B}(\\xi, \\eta, \\zeta) \\det(\\mathbf{J}) \\, d\\xi d\\eta d\\zeta $$\n问题指定了使用单个高斯点的减缩积分方案，该点位于父单元的形心，即 $(\\xi, \\eta, \\zeta) = (0, 0, 0)$。相应的高斯权重为 $w = 2 \\times 2 \\times 2 = 8$。因此，刚度矩阵近似为：\n$$ \\mathbf{K}^e \\approx w \\det(\\mathbf{J}) \\mathbf{B}(0,0,0)^T \\mathbf{D} \\mathbf{B}(0,0,0) $$\n令 $\\mathbf{B}_0 = \\mathbf{B}(0,0,0)$。由于映射是仿射的，雅可比行列式 $\\det(\\mathbf{J})$ 是一个非零常数。材料是均匀的，因此 $\\mathbf{D}$ 也是常数。\n\n如果一个节点位移向量 $\\mathbf{u}^e$ 产生的应变能为零，即 $(\\mathbf{u}^e)^T \\mathbf{K}^e \\mathbf{u}^e = 0$，则它对应一个零能模式。根据近似的 $\\mathbf{K}^e$ 的形式：\n$$ (\\mathbf{u}^e)^T \\left( w \\det(\\mathbf{J}) \\mathbf{B}_0^T \\mathbf{D} \\mathbf{B}_0 \\right) \\mathbf{u}^e = 0 $$\n由于 $w  0$，$\\det(\\mathbf{J}) \\neq 0$，且本构张量 $\\mathbf{D}$ 是正定的，该条件等价于：\n$$ (\\mathbf{B}_0 \\mathbf{u}^e)^T \\mathbf{D} (\\mathbf{B}_0 \\mathbf{u}^e) = 0 \\implies \\mathbf{B}_0 \\mathbf{u}^e = \\mathbf{0} $$\n因此，零能模式空间是矩阵 $\\mathbf{B}_0$ 的零空间（核）。我们需要找到这个零空间的维数，即 $\\dim(\\ker(\\mathbf{B}_0))$。\n\nH8 单元有 8 个节点。在 3D 弹性力学中，每个节点有 3 个自由度（位移）。因此，单元的总自由度数为 $N_{dof} = 8 \\times 3 = 24$。节点位移向量 $\\mathbf{u}^e$ 属于 $\\mathbb{R}^{24}$。\n在 3D 中，应变向量有 6 个分量：$\\boldsymbol{\\epsilon} = [\\epsilon_{xx}, \\epsilon_{yy}, \\epsilon_{zz}, \\gamma_{xy}, \\gamma_{yz}, \\gamma_{zx}]^T$。应变-位移矩阵 $\\mathbf{B}_0$ 将 24 个节点位移映射到这 6 个应变分量。因此，$\\mathbf{B}_0$ 是一个 $6 \\times 24$ 的矩阵。\n\n根据秩-零度定理，$\\mathbf{B}_0$ 的零空间维数为：\n$$ \\dim(\\ker(\\mathbf{B}_0)) = N_{dof} - \\text{rank}(\\mathbf{B}_0) = 24 - \\text{rank}(\\mathbf{B}_0) $$\n为了找到零能子空间的维数，我们必须确定 $\\mathbf{B}_0$ 的秩。秩是矩阵的线性无关行（或列）的数量。\n\n节点 $i$ 的矩阵 $\\mathbf{B}_i$ 是：\n$$ \\mathbf{B}_i = \\begin{pmatrix}\n\\frac{\\partial N_i}{\\partial x}  0  0 \\\\\n0  \\frac{\\partial N_i}{\\partial y}  0 \\\\\n0  0  \\frac{\\partial N_i}{\\partial z} \\\\\n\\frac{\\partial N_i}{\\partial y}  \\frac{\\partial N_i}{\\partial x}  0 \\\\\n0  \\frac{\\partial N_i}{\\partial z}  \\frac{\\partial N_i}{\\partial y} \\\\\n\\frac{\\partial N_i}{\\partial z}  0  \\frac{\\partial N_i}{\\partial x}\n\\end{pmatrix} $$\n其中导数在形心处计算。完整的矩阵是 $\\mathbf{B}_0 = [\\mathbf{B}_1, \\mathbf{B}_2, \\ldots, \\mathbf{B}_8]_0$。\n三线性形函数 $N_i = \\frac{1}{8}(1+\\xi_i\\xi)(1+\\eta_i\\eta)(1+\\zeta_i\\zeta)$ 在形心 $(\\xi,\\eta,\\zeta)=(0,0,0)$ 处的导数为：\n$$ \\frac{\\partial N_i}{\\partial \\xi}\\bigg|_0 = \\frac{1}{8}\\xi_i, \\quad \\frac{\\partial N_i}{\\partial \\eta}\\bigg|_0 = \\frac{1}{8}\\eta_i, \\quad \\frac{\\partial N_i}{\\partial \\zeta}\\bigg|_0 = \\frac{1}{8}\\zeta_i $$\n其中 $(\\xi_i, \\eta_i, \\zeta_i)$ 是节点 $i$ 的坐标（值为 $\\pm 1$）。\n空间导数通过逆雅可比矩阵 $\\mathbf{J}^{-1}$ 与这些导数相关联：\n$$ \\begin{Bmatrix} \\frac{\\partial N_i}{\\partial x} \\\\ \\frac{\\partial N_i}{\\partial y} \\\\ \\frac{\\partial N_i}{\\partial z} \\end{Bmatrix}_0 = \\mathbf{J}^{-1} \\begin{Bmatrix} \\frac{\\partial N_i}{\\partial \\xi} \\\\ \\frac{\\partial N_i}{\\partial \\eta} \\\\ \\frac{\\partial N_i}{\\partial \\zeta} \\end{Bmatrix}_0 = \\frac{1}{8} \\mathbf{J}^{-1} \\begin{Bmatrix} \\xi_i \\\\ \\eta_i \\\\ \\zeta_i \\end{Bmatrix} $$\n令 $\\mathbf{d}_{x}$、$\\mathbf{d}_{y}$、$\\mathbf{d}_{z}$ 为 $\\mathbb{R}^8$ 中的向量，其分量是每个节点在形心处计算的空间导数。例如，$(\\mathbf{d}_{x})_i = \\frac{\\partial N_i}{\\partial x}|_0$。这三个向量是节点坐标向量 $\\boldsymbol{\\xi_v} = (\\xi_1, \\dots, \\xi_8)^T$、$\\boldsymbol{\\eta_v} = (\\eta_1, \\dots, \\eta_8)^T$ 和 $\\boldsymbol{\\zeta_v} = (\\zeta_1, \\dots, \\zeta_8)^T$ 的线性组合，其系数为 $\\frac{1}{8}\\mathbf{J}^{-1}$ 的行。向量 $\\boldsymbol{\\xi_v}$、$\\boldsymbol{\\eta_v}$、$\\boldsymbol{\\zeta_v}$ 是线性无关的。由于 $\\mathbf{J}^{-1}$ 是可逆的，向量 $\\mathbf{d}_{x}$、$\\mathbf{d}_{y}$、$\\mathbf{d}_{z}$ 也是线性无关的。\n\n这个 $6 \\times 24$ 矩阵 $\\mathbf{B}_0$ 的 6 个行可以用这些向量表示：\n- 第 1 行：$[\\mathbf{d}_{x}^T, \\mathbf{0}^T, \\mathbf{0}^T]$\n- 第 2 行：$[\\mathbf{0}^T, \\mathbf{d}_{y}^T, \\mathbf{0}^T]$\n- 第 3 行：$[\\mathbf{0}^T, \\mathbf{0}^T, \\mathbf{d}_{z}^T]$\n- 第 4 行：$[\\mathbf{d}_{y}^T, \\mathbf{d}_{x}^T, \\mathbf{0}^T]$\n- 第 5 行：$[\\mathbf{0}^T, \\mathbf{d}_{z}^T, \\mathbf{d}_{y}^T]$\n- 第 6 行：$[\\mathbf{d}_{z}^T, \\mathbf{0}^T, \\mathbf{d}_{x}^T]$\n\n我们检查这些行的线性无关性。假设行的线性组合等于零向量：$\\sum_{k=1}^{6} c_k \\text{Row}_k = \\mathbf{0}$。考察前 8 个分块，得到 $c_1 \\mathbf{d}_{x} + c_4 \\mathbf{d}_{y} + c_6 \\mathbf{d}_{z} = \\mathbf{0}$。由于 $\\mathbf{d}_{x}$、$\\mathbf{d}_{y}$、$\\mathbf{d}_{z}$ 是线性无关的，这意味着 $c_1 = c_4 = c_6 = 0$。将这些代入中间 8 个分块的方程，得到 $c_2 \\mathbf{d}_{y} + c_5 \\mathbf{d}_{z} = \\mathbf{0}$，这意味着 $c_2 = c_5 = 0$。最后，第三个分块给出 $c_3 \\mathbf{d}_{z} = \\mathbf{0}$，这意味着 $c_3=0$。所有系数 $c_k$ 都必须为零，因此这 6 个行是线性无关的。\n\n因此，$\\mathbf{B}_0$ 的秩为 6。\n总零能子空间的维数是：\n$$ \\dim(\\ker(\\mathbf{B}_0)) = 24 - \\text{rank}(\\mathbf{B}_0) = 24 - 6 = 18 $$\n这个 18 维空间包含了所有在单元形心处产生零应变的节点位移向量。该空间包括刚体模式，刚体模式在任何地方都产生零应变。对于一个 3D 物体，有 6 个线性无关的刚体模式：3 个平移和 3 个转动。\n\n问题要求的是*非刚体*零能子空间的维数，也就是沙漏模式的维数。这可以通过从总零能子空间的维数中减去刚体模式子空间的维数来得到。\n$$ \\text{沙漏模式的维数} = \\dim(\\ker(\\mathbf{B}_0)) - \\text{刚体模式的维数} $$\n$$ \\text{沙漏模式的维数} = 18 - 6 = 12 $$\n对于采用单点减缩积分的 8 节点六面体单元，存在 12 种沙漏模式。", "answer": "$$\\boxed{12}$$", "id": "3570550"}]}