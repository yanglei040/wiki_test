{"hands_on_practices": [{"introduction": "我们首先将探讨计算塑性力学的基石：返回映射算法。第一个练习 [@problem_id:3545035] 将引导您推导标准关联von Mises塑性模型中的塑性乘子，该模型常用于描述金属材料。通过这个基础示例，您将牢固掌握“径向返回”的核心概念，以及确保更新后的应力状态准确返回屈服面的数学步骤。", "problem": "一个均匀、各向同性、小应变、率无关的弹塑性实体遵循带有线性各向同性硬化的 von Mises 相关流动法则。其弹性行为是线性的，杨氏模量为 $E$，泊松比为 $\\nu$。屈服函数定义为 $f(\\boldsymbol{\\sigma},\\kappa) = \\sigma_{\\mathrm{eq}} - \\sigma_{y}(\\kappa)$，其中 $\\sigma_{\\mathrm{eq}} = \\sqrt{\\frac{3}{2}\\,\\boldsymbol{s}:\\boldsymbol{s}}$ 是 von Mises 等效应力，$\\boldsymbol{s} = \\boldsymbol{\\sigma} - \\frac{1}{3}\\,\\mathrm{tr}(\\boldsymbol{\\sigma})\\,\\boldsymbol{I}$ 是偏应力，$\\sigma_{y}(\\kappa) = \\sigma_{y0} + H\\,\\kappa$ 是当前屈服应力，其中 $H$ 是线性各向同性硬化模量，$\\kappa$ 是累积塑性应变。塑性流动是相关的，因此塑性应变增量遵循在增量步结束时计算的 $\\Delta\\boldsymbol{\\varepsilon}^{p} = \\Delta\\lambda\\,\\frac{\\partial f}{\\partial\\boldsymbol{\\sigma}}$，硬化变量更新为 $\\kappa^{n+1} = \\kappa^{n} + \\Delta\\lambda$。应力更新通过隐式后向 Euler 返回映射算法计算，该算法包括一个弹性预测（试探）偏应力 $\\boldsymbol{s}^{\\mathrm{tr}}$，然后是一个塑性修正，以强制满足一致性条件 $f(\\boldsymbol{\\sigma}^{n+1},\\kappa^{n+1}) = 0$。偏弹性模量是剪切模量 $G = \\frac{E}{2(1+\\nu)}$。\n\n从这些定义和离散化出发，通过将试探应力投影到屈服面 $f=0$ 上并强制满足一致性条件，推导塑性乘子 $\\Delta\\lambda$。然后根据以下数据计算其数值，所有应力和模量均使用兆帕 (MPa) 为单位：\n\n- $E = 210{,}000\\,\\text{MPa}$，$\\nu = 0.3$，\n- $\\sigma_{y0} = 350\\,\\text{MPa}$，\n- $H = 1{,}500\\,\\text{MPa}$，\n- $\\kappa^{n} = 0.02$，\n- 步末的试探 Cauchy 应力（弹性预测值）：$\\boldsymbol{\\sigma}^{\\mathrm{tr}} = \\mathrm{diag}(600,\\,-100,\\,-200)\\,\\text{MPa}$。\n\n将 $\\Delta\\lambda$ 的最终数值结果四舍五入到四位有效数字。最终答案表示为一个无单位的纯数字。", "solution": "题目要求推导在 von Mises 屈服准则下，具有线性各向同性硬化的率无关弹塑性固体的塑性乘子 $\\Delta\\lambda$，并随后进行数值计算。本解答将使用隐式后向 Euler 返回映射算法进行推导。\n\n总应变增量 $\\Delta\\boldsymbol{\\varepsilon}$ 可加性地分解为一个弹性部分 $\\Delta\\boldsymbol{\\varepsilon}^{e}$ 和一个塑性部分 $\\Delta\\boldsymbol{\\varepsilon}^{p}$：\n$$\n\\Delta\\boldsymbol{\\varepsilon} = \\Delta\\boldsymbol{\\varepsilon}^{e} + \\Delta\\boldsymbol{\\varepsilon}^{p}\n$$\n应力增量通过 Hooke 定律与弹性应变增量相关。对于各向同性材料，其分解形式为，偏应力 $\\boldsymbol{s}$ 和静水压力 $p = -\\frac{1}{3}\\mathrm{tr}(\\boldsymbol{\\sigma})$ 的更新方式如下：\n$$\n\\boldsymbol{s}^{n+1} = \\boldsymbol{s}^{n} + 2\\,G\\,\\Delta\\boldsymbol{\\varepsilon}^{e}_{\\mathrm{dev}}\n$$\n$$\np^{n+1} = p^{n} + K\\,\\Delta\\varepsilon^{e}_{\\mathrm{vol}}\n$$\n其中 $G = \\frac{E}{2(1+\\nu)}$ 是剪切模量，$K$ 是体积模量，并假设塑性流动是等体积的（$\\mathrm{tr}(\\Delta\\boldsymbol{\\varepsilon}^{p}) = 0$），因此 $\\Delta\\varepsilon^{e}_{\\mathrm{vol}} = \\Delta\\varepsilon_{\\mathrm{vol}}$。偏弹性应变增量为 $\\Delta\\boldsymbol{\\varepsilon}^{e}_{\\mathrm{dev}} = \\Delta\\boldsymbol{\\varepsilon}_{\\mathrm{dev}} - \\Delta\\boldsymbol{\\varepsilon}^{p}_{\\mathrm{dev}}$。由于 von Mises 屈服准则仅取决于偏应力，塑性应变也完全是偏量，因此 $\\Delta\\boldsymbol{\\varepsilon}^{p} = \\Delta\\boldsymbol{\\varepsilon}^{p}_{\\mathrm{dev}}$。\n\n返回映射算法始于一个弹性预测步，其中假定整个应变增量都是弹性的（$\\Delta\\boldsymbol{\\varepsilon}^{p} = \\boldsymbol{0}$）。这会产生一个试探应力状态：\n$$\n\\boldsymbol{\\sigma}^{\\mathrm{tr}} = \\boldsymbol{\\sigma}^{n} + \\boldsymbol{C}:\\Delta\\boldsymbol{\\varepsilon}\n$$\n其中 $\\boldsymbol{C}$ 是四阶弹性张量。对于偏量部分，这表示为：\n$$\n\\boldsymbol{s}^{\\mathrm{tr}} = \\boldsymbol{s}^{n} + 2\\,G\\,\\Delta\\boldsymbol{\\varepsilon}_{\\mathrm{dev}}\n$$\n结合 $\\boldsymbol{s}^{n+1}$ 的更新和 $\\boldsymbol{s}^{\\mathrm{tr}}$ 的定义，我们得到塑性修正方程：\n$$\n\\boldsymbol{s}^{n+1} = \\boldsymbol{s}^{\\mathrm{tr}} - 2\\,G\\,\\Delta\\boldsymbol{\\varepsilon}^{p}\n$$\n题目指定了相关流动法则，在增量步结束时进行计算（后向 Euler 格式）：\n$$\n\\Delta\\boldsymbol{\\varepsilon}^{p} = \\Delta\\lambda\\,\\frac{\\partial f}{\\partial\\boldsymbol{\\sigma}}\\bigg|_{\\boldsymbol{\\sigma}^{n+1}}\n$$\n屈服函数是 $f(\\boldsymbol{\\sigma},\\kappa) = \\sigma_{\\mathrm{eq}} - \\sigma_{y}(\\kappa)$，其中 $\\sigma_{\\mathrm{eq}} = \\sqrt{\\frac{3}{2}\\boldsymbol{s}:\\boldsymbol{s}}$。屈服函数相对于应力张量 $\\boldsymbol{\\sigma}$ 的梯度是：\n$$\n\\frac{\\partial f}{\\partial \\boldsymbol{\\sigma}} = \\frac{\\partial \\sigma_{\\mathrm{eq}}}{\\partial \\boldsymbol{\\sigma}} = \\frac{\\partial}{\\partial \\boldsymbol{\\sigma}}\\left(\\frac{3}{2}\\boldsymbol{s}:\\boldsymbol{s}\\right)^{1/2} = \\frac{1}{2\\sigma_{\\mathrm{eq}}} \\cdot \\frac{3}{2} \\cdot \\frac{\\partial(\\boldsymbol{s}:\\boldsymbol{s})}{\\partial \\boldsymbol{\\sigma}}\n$$\n使用张量微积分，$\\frac{\\partial(\\boldsymbol{s}:\\boldsymbol{s})}{\\partial\\boldsymbol{\\sigma}} = 2\\boldsymbol{s}$，这给出了塑性流动方向 $\\boldsymbol{N}$：\n$$\n\\boldsymbol{N} = \\frac{\\partial f}{\\partial \\boldsymbol{\\sigma}} = \\frac{3}{2}\\frac{\\boldsymbol{s}}{\\sigma_{\\mathrm{eq}}}\n$$\n在时间步末 $\\boldsymbol{\\sigma}^{n+1}$ 处进行计算，并代入流动法则：\n$$\n\\Delta\\boldsymbol{\\varepsilon}^{p} = \\Delta\\lambda\\,\\frac{3}{2}\\frac{\\boldsymbol{s}^{n+1}}{\\sigma_{\\mathrm{eq}}^{n+1}}\n$$\n现在，将其代入偏应力的塑性修正方程中：\n$$\n\\boldsymbol{s}^{n+1} = \\boldsymbol{s}^{\\mathrm{tr}} - 2\\,G\\,\\left(\\Delta\\lambda\\,\\frac{3}{2}\\frac{\\boldsymbol{s}^{n+1}}{\\sigma_{\\mathrm{eq}}^{n+1}}\\right) = \\boldsymbol{s}^{\\mathrm{tr}} - 3\\,G\\,\\Delta\\lambda\\,\\frac{\\boldsymbol{s}^{n+1}}{\\sigma_{\\mathrm{eq}}^{n+1}}\n$$\n重新整理各项以求解 $\\boldsymbol{s}^{n+1}$：\n$$\n\\boldsymbol{s}^{n+1}\\left(1 + \\frac{3\\,G\\,\\Delta\\lambda}{\\sigma_{\\mathrm{eq}}^{n+1}}\\right) = \\boldsymbol{s}^{\\mathrm{tr}}\n$$\n该方程表明，最终的偏应力 $\\boldsymbol{s}^{n+1}$ 必须与试探偏应力 $\\boldsymbol{s}^{\\mathrm{tr}}$ 共线。这是径向返回算法的几何解释。通过对两边取 Frobenius 范数（并将其与等效应力的大小联系起来），我们得到：\n$$\n\\sqrt{\\boldsymbol{s}^{n+1}:\\boldsymbol{s}^{n+1}}\\left(1 + \\frac{3\\,G\\,\\Delta\\lambda}{\\sigma_{\\mathrm{eq}}^{n+1}}\\right) = \\sqrt{\\boldsymbol{s}^{\\mathrm{tr}}:\\boldsymbol{s}^{\\mathrm{tr}}}\n$$\n使用定义 $\\sigma_{\\mathrm{eq}} = \\sqrt{\\frac{3}{2}\\boldsymbol{s}:\\boldsymbol{s}}$，这意味着 $\\sqrt{\\boldsymbol{s}:\\boldsymbol{s}} = \\sqrt{\\frac{2}{3}}\\sigma_{\\mathrm{eq}}$：\n$$\n\\sqrt{\\frac{2}{3}}\\sigma_{\\mathrm{eq}}^{n+1}\\left(1 + \\frac{3\\,G\\,\\Delta\\lambda}{\\sigma_{\\mathrm{eq}}^{n+1}}\\right) = \\sqrt{\\frac{2}{3}}\\sigma_{\\mathrm{eq}}^{\\mathrm{tr}}\n$$\n简化此式可得到返回映射算法中的一个基本关系：\n$$\n\\sigma_{\\mathrm{eq}}^{n+1} + 3\\,G\\,\\Delta\\lambda = \\sigma_{\\mathrm{eq}}^{\\mathrm{tr}}\n$$\n算法的第二部分是强制满足一致性条件 $f(\\boldsymbol{\\sigma}^{n+1},\\kappa^{n+1})=0$，该条件表明对于塑性加载，最终应力状态必须位于更新后的屈服面上。\n$$\n\\sigma_{\\mathrm{eq}}^{n+1} - \\sigma_{y}(\\kappa^{n+1}) = 0 \\implies \\sigma_{\\mathrm{eq}}^{n+1} = \\sigma_{y}(\\kappa^{n+1})\n$$\n硬化定律由 $\\sigma_{y}(\\kappa) = \\sigma_{y0} + H\\,\\kappa$ 给出，硬化变量的更新为 $\\kappa^{n+1} = \\kappa^{n} + \\Delta\\lambda$。增量开始时的屈服应力为 $\\sigma_y^n = \\sigma_{y0} + H\\kappa^n$。因此，\n$$\n\\sigma_{\\mathrm{eq}}^{n+1} = \\sigma_{y0} + H(\\kappa^{n} + \\Delta\\lambda) = (\\sigma_{y0} + H\\kappa^{n}) + H\\Delta\\lambda = \\sigma_y^n + H\\Delta\\lambda\n$$\n我们现在得到一个关于两个未知数 $\\sigma_{\\mathrm{eq}}^{n+1}$ 和 $\\Delta\\lambda$ 的方程组：\n1. $\\sigma_{\\mathrm{eq}}^{n+1} + 3\\,G\\,\\Delta\\lambda = \\sigma_{\\mathrm{eq}}^{\\mathrm{tr}}$\n2. $\\sigma_{\\mathrm{eq}}^{n+1} = \\sigma_y^n + H\\Delta\\lambda$\n将 (2) 代入 (1)：\n$$\n(\\sigma_y^n + H\\Delta\\lambda) + 3\\,G\\,\\Delta\\lambda = \\sigma_{\\mathrm{eq}}^{\\mathrm{tr}}\n$$\n求解 $\\Delta\\lambda$：\n$$\n\\Delta\\lambda (H + 3\\,G) = \\sigma_{\\mathrm{eq}}^{\\mathrm{tr}} - \\sigma_y^n\n$$\n$$\n\\Delta\\lambda = \\frac{\\sigma_{\\mathrm{eq}}^{\\mathrm{tr}} - \\sigma_y^n}{3\\,G + H}\n$$\n仅当发生塑性加载时，即试探状态在屈服面之外时（$f^{\\mathrm{tr}} = \\sigma_{\\mathrm{eq}}^{\\mathrm{tr}} - \\sigma_y^n > 0$），此表达式才有效。如果 $f^{\\mathrm{tr}} \\le 0$，则该步是弹性的，并且 $\\Delta\\lambda = 0$。\n\n现在，我们使用所提供的数据计算此表达式。\n数据为：$E = 210,000\\,\\text{MPa}$，$\\nu = 0.3$，$\\sigma_{y0} = 350\\,\\text{MPa}$，$H = 1,500\\,\\text{MPa}$，$\\kappa^{n} = 0.02$，$\\boldsymbol{\\sigma}^{\\mathrm{tr}} = \\mathrm{diag}(600, -100, -200)\\,\\text{MPa}$。\n\n首先，计算剪切模量 $G$：\n$$\nG = \\frac{E}{2(1+\\nu)} = \\frac{210,000}{2(1+0.3)} = \\frac{210,000}{2.6} = \\frac{1,050,000}{13}\\,\\text{MPa}\n$$\n接下来，计算增量开始时的屈服应力 $\\sigma_y^n$：\n$$\n\\sigma_y^n = \\sigma_{y0} + H\\,\\kappa^n = 350 + 1,500 \\times 0.02 = 350 + 30 = 380\\,\\text{MPa}\n$$\n接下来，计算试探等效应力 $\\sigma_{\\mathrm{eq}}^{\\mathrm{tr}}$。我们首先需要试探偏应力 $\\boldsymbol{s}^{\\mathrm{tr}}$。\n试探应力的迹为 $\\mathrm{tr}(\\boldsymbol{\\sigma}^{\\mathrm{tr}}) = 600 - 100 - 200 = 300\\,\\text{MPa}$。\n试探平均应力为 $\\sigma_m^{\\mathrm{tr}} = \\frac{1}{3}\\mathrm{tr}(\\boldsymbol{\\sigma}^{\\mathrm{tr}}) = \\frac{300}{3} = 100\\,\\text{MPa}$。\n试探偏应力张量为 $\\boldsymbol{s}^{\\mathrm{tr}} = \\boldsymbol{\\sigma}^{\\mathrm{tr}} - \\sigma_m^{\\mathrm{tr}}\\boldsymbol{I}$：\n$$\n\\boldsymbol{s}^{\\mathrm{tr}} = \\begin{pmatrix} 600  0  0 \\\\ 0  -100  0 \\\\ 0  0  -200 \\end{pmatrix} - \\begin{pmatrix} 100  0  0 \\\\ 0  100  0 \\\\ 0  0  100 \\end{pmatrix} = \\begin{pmatrix} 500  0  0 \\\\ 0  -200  0 \\\\ 0  0  -300 \\end{pmatrix}\\,\\text{MPa}\n$$\n现在，计算 $\\boldsymbol{s}^{\\mathrm{tr}}:\\boldsymbol{s}^{\\mathrm{tr}}$ 项：\n$$\n\\boldsymbol{s}^{\\mathrm{tr}}:\\boldsymbol{s}^{\\mathrm{tr}} = (500)^2 + (-200)^2 + (-300)^2 = 250,000 + 40,000 + 90,000 = 380,000\\,\\text{MPa}^2\n$$\n试探等效应力为：\n$$\n\\sigma_{\\mathrm{eq}}^{\\mathrm{tr}} = \\sqrt{\\frac{3}{2}\\boldsymbol{s}^{\\mathrm{tr}}:\\boldsymbol{s}^{\\mathrm{tr}}} = \\sqrt{\\frac{3}{2} \\times 380,000} = \\sqrt{3 \\times 190,000} = \\sqrt{570,000}\\,\\text{MPa}\n$$\n试探屈服函数值为 $f^{\\mathrm{tr}} = \\sigma_{\\mathrm{eq}}^{\\mathrm{tr}} - \\sigma_y^n = \\sqrt{570,000} - 380 \\approx 754.98 - 380 = 374.98\\,\\text{MPa}$。由于 $f^{\\mathrm{tr}} > 0$，发生塑性流动且 $\\Delta\\lambda > 0$。\n\n我们现在可以计算 $\\Delta\\lambda$：\n$$\n\\Delta\\lambda = \\frac{\\sqrt{570,000} - 380}{3\\left(\\frac{1,050,000}{13}\\right) + 1,500} = \\frac{\\sqrt{570,000} - 380}{\\frac{3,150,000}{13} + \\frac{1,500 \\times 13}{13}}\n$$\n$$\n\\Delta\\lambda = \\frac{\\sqrt{570,000} - 380}{\\frac{3,150,000 + 19,500}{13}} = \\frac{13(\\sqrt{570,000} - 380)}{3,169,500}\n$$\n数值计算，\n$$\n\\Delta\\lambda \\approx \\frac{13 \\times (754.98344 - 380)}{3,169,500} = \\frac{13 \\times 374.98344}{3,169,500} \\approx \\frac{4874.7847}{3,169,500} \\approx 0.0015380299\n$$\n四舍五入到四位有效数字，塑性乘子的值为 $0.001538$。", "answer": "$$\\boxed{0.001538}$$", "id": "3545035"}, {"introduction": "在建立了关联流动的计算过程后，我们现在来探究非关联流动法则的物理后果。这个练习 [@problem_id:3545061] 聚焦于塑性变形的能量问题，要求您推导塑性功耗率如何在体积和偏量分量之间进行分配。这一推导过程清晰地揭示了塑性势函数的物理意义及其在控制剪胀等现象中的作用，让您更深入地理解为何非关联法则是模拟许多岩土地质材料所必需的。", "problem": "考虑一个由 Drucker-Prager 型屈服函数和可能非关联的塑性势描述的各向同性弹塑性固体。令柯西应力分解为 $\\boldsymbol{\\sigma} = \\boldsymbol{s} + p \\boldsymbol{I}$，其中 $p = \\tfrac{1}{3} \\operatorname{tr}(\\boldsymbol{\\sigma})$ 是平均应力，$\\boldsymbol{s} = \\boldsymbol{\\sigma} - p \\boldsymbol{I}$ 是偏应力，$\\boldsymbol{I}$ 是二阶单位张量。令偏应力的第二不变量为 $J_{2} = \\tfrac{1}{2} \\boldsymbol{s}:\\boldsymbol{s}$，并定义 $q = \\sqrt{3 J_{2}}$。塑性流动由率无关流动法则 $\\dot{\\boldsymbol{\\varepsilon}}^{p} = \\dot{\\lambda} \\, \\partial g / \\partial \\boldsymbol{\\sigma}$ 控制，其中 $\\dot{\\lambda} \\ge 0$ 是塑性乘子，塑性势为 Drucker-Prager 形式 $g(\\boldsymbol{\\sigma}) = q + \\eta \\, p$，其中 $\\eta$ 是一个恒定的剪胀参数。塑性功速率为 $w^{p} = \\boldsymbol{\\sigma} : \\dot{\\boldsymbol{\\varepsilon}}^{p}$，其可以通过分解 $\\dot{\\boldsymbol{\\varepsilon}}^{p} = \\dot{\\boldsymbol{\\varepsilon}}^{p}_{\\mathrm{dev}} + \\tfrac{1}{3} \\dot{\\varepsilon}^{p}_{v} \\boldsymbol{I}$ 分为偏量部分和体积部分，其中 $\\dot{\\varepsilon}^{p}_{v} = \\operatorname{tr}(\\dot{\\boldsymbol{\\varepsilon}}^{p})$。\n\n仅从这些定义出发，并且不引用任何预先推导的特例公式，执行以下步骤：\n- 推导 $\\partial q / \\partial \\boldsymbol{\\sigma}$ 和 $\\partial p / \\partial \\boldsymbol{\\sigma}$。\n- 使用流动法则，以 $\\boldsymbol{s}$、$q$、$p$、$\\eta$ 和 $\\dot{\\lambda}$ 显式地表示 $\\dot{\\varepsilon}^{p}_{v}$ 和 $\\dot{\\boldsymbol{\\varepsilon}}^{p}_{\\mathrm{dev}}$。\n- 推导塑性功速率的分解 $w^{p} = w^{p}_{\\mathrm{dev}} + w^{p}_{\\mathrm{vol}}$，并以 $q$、$p$、$\\eta$ 和 $\\dot{\\lambda}$ 表示 $w^{p}_{\\mathrm{dev}}$ 和 $w^{p}_{\\mathrm{vol}}$。\n- 考虑一个平均应力恒定的加载路径 $p = p_{0}$，其中 $p_{0}$ 是一个常数。在这种恒定 $p$ 的加载条件下，推导由体积塑性应变承担的塑性功速率的分数，$R_{v} = w^{p}_{\\mathrm{vol}} / w^{p}$，作为 $q$、$p_{0}$ 和 $\\eta$ 的闭式函数。\n\n您的最终答案必须是 $R_{v}$ 关于 $q$、$p_{0}$ 和 $\\eta$ 的单一闭式解析表达式。最终答案不需要单位，因为它是一个分数，并且不应代入任何数值。", "solution": "任务是推导一个表达式，用于表示在特定加载路径下，遵循 Drucker-Prager 型非关联流动法则的弹塑性固体中，由体积应变引起的塑性功速率的分数，$R_{v} = w^{p}_{\\mathrm{vol}} / w^{p}$。该推导分四个连续步骤进行。\n\n首先，我们推导平均应力 $p$ 和等效偏应力 $q$ 相对于柯西应力张量 $\\boldsymbol{\\sigma}$ 的梯度。\n平均应力定义为 $p = \\frac{1}{3} \\operatorname{tr}(\\boldsymbol{\\sigma})$。在张量指标表示法中，$p = \\frac{1}{3} \\sigma_{kk}$。它对 $\\sigma_{ij}$ 的导数为：\n$$\n\\frac{\\partial p}{\\partial \\sigma_{ij}} = \\frac{\\partial}{\\partial \\sigma_{ij}} \\left( \\frac{1}{3} \\sigma_{kk} \\right) = \\frac{1}{3} \\frac{\\partial \\sigma_{kk}}{\\partial \\sigma_{ij}} = \\frac{1}{3} \\delta_{ki} \\delta_{kj} = \\frac{1}{3} \\delta_{ij}\n$$\n在直接张量表示法中，此为 $\\frac{\\partial p}{\\partial \\boldsymbol{\\sigma}} = \\frac{1}{3} \\boldsymbol{I}$，其中 $\\boldsymbol{I}$ 是二阶单位张量。\n\n等效偏应力 $q$ 定义为 $q = \\sqrt{3 J_{2}}$，其中 $J_{2} = \\frac{1}{2} \\boldsymbol{s}:\\boldsymbol{s}$。这得到 $q^2 = 3 J_{2} = \\frac{3}{2} \\boldsymbol{s}:\\boldsymbol{s}$。我们使用链式法则对该表达式关于 $\\boldsymbol{\\sigma}$ 求导：\n$$\n\\frac{\\partial (q^2)}{\\partial \\boldsymbol{\\sigma}} = 2q \\frac{\\partial q}{\\partial \\boldsymbol{\\sigma}} = \\frac{3}{2} \\frac{\\partial (\\boldsymbol{s}:\\boldsymbol{s})}{\\partial \\boldsymbol{\\sigma}} = \\frac{3}{2} \\left( 2 \\boldsymbol{s} : \\frac{\\partial \\boldsymbol{s}}{\\partial \\boldsymbol{\\sigma}} \\right) = 3 \\boldsymbol{s} : \\frac{\\partial \\boldsymbol{s}}{\\partial \\boldsymbol{\\sigma}}\n$$\n偏应力为 $\\boldsymbol{s} = \\boldsymbol{\\sigma} - p \\boldsymbol{I} = \\boldsymbol{\\sigma} - \\frac{1}{3}\\operatorname{tr}(\\boldsymbol{\\sigma})\\boldsymbol{I}$。它对 $\\boldsymbol{\\sigma}$ 的导数是四阶偏量投影张量 $\\mathbb{P}_{\\text{dev}}$：\n$$\n\\frac{\\partial s_{kl}}{\\partial \\sigma_{ij}} = \\frac{\\partial}{\\partial \\sigma_{ij}} \\left( \\sigma_{kl} - \\frac{1}{3}\\sigma_{mm}\\delta_{kl} \\right) = \\delta_{ki}\\delta_{lj} - \\frac{1}{3}\\delta_{ij}\\delta_{kl}\n$$\n项 $\\boldsymbol{s} : \\frac{\\partial \\boldsymbol{s}}{\\partial \\boldsymbol{\\sigma}}$ 变为 $s_{kl} \\frac{\\partial s_{kl}}{\\partial \\sigma_{ij}} = s_{kl}(\\delta_{ki}\\delta_{lj} - \\frac{1}{3}\\delta_{ij}\\delta_{kl}) = s_{ij} - \\frac{1}{3}(s_{kl}\\delta_{kl})\\delta_{ij} = s_{ij} - \\frac{1}{3}\\operatorname{tr}(\\boldsymbol{s})\\delta_{ij}$。由于根据定义 $\\operatorname{tr}(\\boldsymbol{s}) = 0$，此项简化为 $\\boldsymbol{s}$。\n将其代回，我们得到 $2q \\frac{\\partial q}{\\partial \\boldsymbol{\\sigma}} = 3\\boldsymbol{s}$，这给出了梯度：\n$$\n\\frac{\\partial q}{\\partial \\boldsymbol{\\sigma}} = \\frac{3}{2q}\\boldsymbol{s}\n$$\n\n第二，我们使用流动法则来求塑性应变率的体积和偏量分量，$\\dot{\\varepsilon}^{p}_{v}$ 和 $\\dot{\\boldsymbol{\\varepsilon}}^{p}_{\\mathrm{dev}}$。\n塑性势为 $g(\\boldsymbol{\\sigma}) = q + \\eta p$。其梯度使用第一步的结果求得：\n$$\n\\frac{\\partial g}{\\partial \\boldsymbol{\\sigma}} = \\frac{\\partial q}{\\partial \\boldsymbol{\\sigma}} + \\eta \\frac{\\partial p}{\\partial \\boldsymbol{\\sigma}} = \\frac{3}{2q}\\boldsymbol{s} + \\frac{\\eta}{3}\\boldsymbol{I}\n$$\n流动法则是 $\\dot{\\boldsymbol{\\varepsilon}}^{p} = \\dot{\\lambda} \\frac{\\partial g}{\\partial \\boldsymbol{\\sigma}}$，因此：\n$$\n\\dot{\\boldsymbol{\\varepsilon}}^{p} = \\dot{\\lambda} \\left( \\frac{3}{2q}\\boldsymbol{s} + \\frac{\\eta}{3}\\boldsymbol{I} \\right)\n$$\n体积塑性应变率为 $\\dot{\\varepsilon}^{p}_{v} = \\operatorname{tr}(\\dot{\\boldsymbol{\\varepsilon}}^{p})$：\n$$\n\\dot{\\varepsilon}^{p}_{v} = \\operatorname{tr}\\left[ \\dot{\\lambda} \\left( \\frac{3}{2q}\\boldsymbol{s} + \\frac{\\eta}{3}\\boldsymbol{I} \\right) \\right] = \\dot{\\lambda} \\left( \\frac{3}{2q}\\operatorname{tr}(\\boldsymbol{s}) + \\frac{\\eta}{3}\\operatorname{tr}(\\boldsymbol{I}) \\right)\n$$\n使用 $\\operatorname{tr}(\\boldsymbol{s}) = 0$ 和 $\\operatorname{tr}(\\boldsymbol{I}) = 3$，我们发现：\n$$\n\\dot{\\varepsilon}^{p}_{v} = \\dot{\\lambda} \\left( 0 + \\frac{\\eta}{3} \\cdot 3 \\right) = \\dot{\\lambda} \\eta\n$$\n偏塑性应变率张量 $\\dot{\\boldsymbol{\\varepsilon}}^{p}_{\\mathrm{dev}}$ 从分解 $\\dot{\\boldsymbol{\\varepsilon}}^{p} = \\dot{\\boldsymbol{\\varepsilon}}^{p}_{\\mathrm{dev}} + \\frac{1}{3}\\dot{\\varepsilon}^{p}_{v}\\boldsymbol{I}$ 得到：\n$$\n\\dot{\\boldsymbol{\\varepsilon}}^{p}_{\\mathrm{dev}} = \\dot{\\boldsymbol{\\varepsilon}}^{p} - \\frac{1}{3}\\dot{\\varepsilon}^{p}_{v}\\boldsymbol{I} = \\dot{\\lambda} \\left( \\frac{3}{2q}\\boldsymbol{s} + \\frac{\\eta}{3}\\boldsymbol{I} \\right) - \\frac{1}{3}(\\dot{\\lambda}\\eta)\\boldsymbol{I} = \\dot{\\lambda} \\frac{3}{2q}\\boldsymbol{s}\n$$\n\n第三，我们推导塑性功速率的偏量和体积部分，$w^{p}_{\\mathrm{dev}}$ 和 $w^{p}_{\\mathrm{vol}}$。\n总塑性功速率为 $w^{p} = \\boldsymbol{\\sigma} : \\dot{\\boldsymbol{\\varepsilon}}^{p}$。使用正交分解 $\\boldsymbol{\\sigma} = \\boldsymbol{s} + p\\boldsymbol{I}$ 和 $\\dot{\\boldsymbol{\\varepsilon}}^{p} = \\dot{\\boldsymbol{\\varepsilon}}^{p}_{\\mathrm{dev}} + \\frac{1}{3}\\dot{\\varepsilon}^{p}_{v}\\boldsymbol{I}$，并注意到偏量张量和球量张量的双点积为零，我们得到分解：\n$$\nw^{p} = (\\boldsymbol{s} + p\\boldsymbol{I}) : \\left(\\dot{\\boldsymbol{\\varepsilon}}^{p}_{\\mathrm{dev}} + \\frac{1}{3}\\dot{\\varepsilon}^{p}_{v}\\boldsymbol{I}\\right) = \\boldsymbol{s}:\\dot{\\boldsymbol{\\varepsilon}}^{p}_{\\mathrm{dev}} + (p\\boldsymbol{I}):\\left(\\frac{1}{3}\\dot{\\varepsilon}^{p}_{v}\\boldsymbol{I}\\right) = w^{p}_{\\mathrm{dev}} + w^{p}_{\\mathrm{vol}}\n$$\n偏量部分为 $w^{p}_{\\mathrm{dev}} = \\boldsymbol{s}:\\dot{\\boldsymbol{\\varepsilon}}^{p}_{\\mathrm{dev}}$。代入 $\\dot{\\boldsymbol{\\varepsilon}}^{p}_{\\mathrm{dev}}$ 的表达式：\n$$\nw^{p}_{\\mathrm{dev}} = \\boldsymbol{s} : \\left(\\dot{\\lambda} \\frac{3}{2q}\\boldsymbol{s}\\right) = \\dot{\\lambda} \\frac{3}{2q} (\\boldsymbol{s}:\\boldsymbol{s})\n$$\n使用 $\\boldsymbol{s}:\\boldsymbol{s} = 2J_{2}$ 和 $q^2 = 3J_{2}$，我们有 $\\boldsymbol{s}:\\boldsymbol{s} = \\frac{2}{3}q^2$。因此：\n$$\nw^{p}_{\\mathrm{dev}} = \\dot{\\lambda} \\frac{3}{2q} \\left(\\frac{2}{3}q^2\\right) = \\dot{\\lambda} q\n$$\n体积部分为 $w^{p}_{\\mathrm{vol}} = (p\\boldsymbol{I}):(\\frac{1}{3}\\dot{\\varepsilon}^{p}_{v}\\boldsymbol{I}) = p \\dot{\\varepsilon}^{p}_{v} (\\frac{1}{3} \\boldsymbol{I}:\\boldsymbol{I}) = p \\dot{\\varepsilon}^{p}_{v}$。代入 $\\dot{\\varepsilon}^{p}_{v} = \\dot{\\lambda} \\eta$：\n$$\nw^{p}_{\\mathrm{vol}} = p (\\dot{\\lambda} \\eta) = \\dot{\\lambda} \\eta p\n$$\n\n第四，我们推导分数 $R_v = w^{p}_{\\mathrm{vol}} / w^{p}$。\n总塑性功速率为 $w^{p} = w^{p}_{\\mathrm{dev}} + w^{p}_{\\mathrm{vol}} = \\dot{\\lambda} q + \\dot{\\lambda} \\eta p$。该比率为：\n$$\nR_{v} = \\frac{w^{p}_{\\mathrm{vol}}}{w^{p}_{\\mathrm{dev}} + w^{p}_{\\mathrm{vol}}} = \\frac{\\dot{\\lambda} \\eta p}{\\dot{\\lambda} q + \\dot{\\lambda} \\eta p}\n$$\n为了发生塑性流动，塑性乘子 $\\dot{\\lambda}$ 必须大于零，所以它可以被消去：\n$$\nR_{v} = \\frac{\\eta p}{q + \\eta p}\n$$\n该问题考虑了一个平均应力恒定的加载路径，$p = p_{0}$。将此条件代入一般表达式，得到最终结果：\n$$\nR_{v} = \\frac{\\eta p_{0}}{q + \\eta p_{0}}\n$$\n该表达式给出了由体积塑性应变承担的塑性功速率的分数，它是等效偏应力 $q$、恒定平均应力 $p_{0}$ 和剪胀参数 $\\eta$ 的函数。", "answer": "$$\\boxed{\\frac{\\eta p_{0}}{q + \\eta p_{0}}}$$", "id": "3545061"}, {"introduction": "最后的这个练习将带您从理论走向实践，挑战您为一个非关联模型构建数值求解器。在练习 [@problem_id:3545042] 中，您将推导并实现一个牛顿-拉弗森 (Newton-Raphson) 算法，直面非关联模型中标志性的非对称雅可比矩阵问题。成功完成这项任务，意味着您在开发用于高等材料模拟的稳健有限元程序方面迈出了重要一步。", "problem": "您需要推导并实现一个牛顿-拉夫逊（Newton–Raphson, NR）返回映射算法，该算法用于一个在静水压力-偏应力空间中表达的压力敏感非关联塑性模型。目标是计算精确的塑性乘子增量 $\\Delta \\lambda$，以在向后欧拉校正步结束时强制满足一致性条件 $\\Delta f = 0$。所有计算必须在小应变、各向同性、线性弹性的框架下进行，并使用独立的静水模量和偏模量。您的程序必须对类应力量使用兆帕（MPa）单位，并且必须返回无量纲的浮点数形式的塑性乘子增量 $\\Delta \\lambda$。\n\n从以下基础出发：\n- 小应变加法分解：$d\\boldsymbol{\\varepsilon} = d\\boldsymbol{\\varepsilon}^{e} + d\\boldsymbol{\\varepsilon}^{p}$。\n- 线性各向同性弹性：$d\\boldsymbol{\\sigma} = \\mathbb{C} : (d\\boldsymbol{\\varepsilon}^{e})$，其中 $\\mathbb{C}$ 是四阶刚度张量，具有体积模量 $K$ 和剪切模量 $G$。\n- 压力-偏应力不变量：$p = \\frac{1}{3} \\text{tr}(\\boldsymbol{\\sigma})$ 和 $q = \\sqrt{\\frac{3}{2}} \\|\\boldsymbol{s}\\|$，其中 $\\boldsymbol{s} = \\boldsymbol{\\sigma} - p \\boldsymbol{I}$。\n- 非关联流动：$d\\boldsymbol{\\varepsilon}^{p} = d\\lambda \\, \\frac{\\partial g}{\\partial \\boldsymbol{\\sigma}}$，其中塑性势 $g(p,q)$ 不等于屈服函数 $f(p,q)$。\n\n假设一个 Drucker–Prager 型屈服函数\n$$\nf(p,q) = q + \\beta p - \\sigma_{y},\n$$\n其中 $\\beta > 0$ 是一个材料常数，$\\sigma_{y} > 0$ 是当前屈服应力（假设理想塑性，即无硬化）。假设一个凸的非关联塑性势\n$$\ng(p,q) = \\sqrt{q^{2} + (\\beta_{g} p)^{2}},\n$$\n其中 $\\beta_{g} \\ge 0$ 是剪胀参数。考虑向后欧拉应力更新\n$$\n\\boldsymbol{\\sigma}_{n+1} = \\boldsymbol{\\sigma}_{\\text{tr}} - \\mathbb{C} : \\left(\\Delta \\lambda \\, \\frac{\\partial g}{\\partial \\boldsymbol{\\sigma}}\\Big|_{n+1}\\right),\n$$\n其中 $\\boldsymbol{\\sigma}_{\\text{tr}}$ 是弹性试探应力，而 $g$ 的梯度在更新后的状态下进行评估。用不变量表示该更新，并为强制满足一致性条件 $\\Delta f = 0$ 的未知量 $\\{p, q, \\Delta \\lambda\\}$ 推导耦合的非线性残差系统：\n- 使用弹性算子的不变量形式，在非关联流动方向下，将 $(p, q)$ 与 $(p_{\\text{tr}}, q_{\\text{tr}})$ 和 $\\Delta \\lambda$ 关联起来。\n- 推导残差向量 $\\boldsymbol{R}(p,q,\\Delta \\lambda)$ 和雅可比矩阵 $\\boldsymbol{J} = \\frac{\\partial \\boldsymbol{R}}{\\partial (p,q,\\Delta \\lambda)}$。证明当 $g \\ne f$ 时，$\\boldsymbol{J}$ 通常是非对称的。\n\n您的推导必须从上述基本定律和定义开始，不得假设任何简化公式。您必须用 $K$、$G$、$p_{\\text{tr}}$、$q_{\\text{tr}}$、$\\beta$、$\\beta_{g}$ 和 $\\sigma_{y}$ 表示所有中间量。然后，为该非线性系统实现一个稳健的牛顿-拉夫逊求解器，以获得每个测试用例的 $\\Delta \\lambda$。如果试探状态是弹性的，即 $f(p_{\\text{tr}}, q_{\\text{tr}}) \\le 0$，则正确的更新是 $\\Delta \\lambda = 0$。\n\n单位和输出：\n- 对所有类应力量（$p$, $q$, $\\sigma_{y}$）使用兆帕（MPa）。\n- 塑性乘子更新 $\\Delta \\lambda$ 是无量纲的。\n- 您的程序必须计算并输出所有测试用例的 $\\Delta \\lambda$ 的最终值，格式为浮点数。\n\n测试套件：\n使用以下五个参数集来测试您的实现。每个测试用例是一个元组 $(p_{\\text{tr}}, q_{\\text{tr}}, \\beta, \\beta_{g}, \\sigma_{y}, K, G)$，其中 $p_{\\text{tr}}$ 和 $q_{\\text{tr}}$ 的单位是 MPa，$K$ 和 $G$ 的单位是 MPa：\n1. $(150.0, 120.0, 0.30, 0.10, 100.0, 10000.0, 8000.0)$\n2. $(200.0, 100.0, 0.25, 0.20, 150.0, 12000.0, 9000.0)$\n3. $(0.0, 200.0, 0.30, 0.30, 180.0, 11000.0, 8500.0)$\n4. $(-50.0, 150.0, 0.20, 0.15, 160.0, 10000.0, 8000.0)$\n5. $(100.0, 150.0, 0.28, 0.60, 120.0, 15000.0, 10000.0)$\n\n要求：\n- 从给定的基本假设出发，为未知量 $\\{p, q, \\Delta \\lambda\\}$ 推导残差系统和非对称雅可比矩阵。\n- 实现一个牛顿-拉夫逊迭代，该迭代具有基于残差范数的合适停止准则，并确保对于塑性步，收敛时 $\\Delta f = 0$。\n- 当 $f(p_{\\text{tr}}, q_{\\text{tr}}) \\le 0$ 时，通过返回 $\\Delta \\lambda = 0$ 来显式处理弹性情况。\n- 您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔的结果列表，结果顺序与测试用例完全一致，例如 `\"[r_{1},r_{2},r_{3},r_{4},r_{5}]\"`，其中每个 $r_{i}$ 是计算出的 $\\Delta \\lambda$。\n\n每个测试用例的预期输出是浮点数。您的算法应对于由非关联势以及静水和偏响应之间的耦合引起的中等非线性具有鲁棒性，并应在所提供的测试套件中表现出正确的行为，涵盖典型的塑性修正、边界一致性情况、静水边缘情况、弹性情况和强剪胀情况。", "solution": "该问题要求推导并实现一个用于压力敏感、非关联弹塑性模型的牛顿-拉夫逊返回映射算法。目标是计算塑性乘子增量 $\\Delta\\lambda$，以确保在一个时间步结束时的应力状态 $\\boldsymbol{\\sigma}_{n+1}$ 位于屈服面上。\n\n### 1. 基础方程\n\n我们从给定的小应变、各向同性弹塑性本构关系开始。\n总应变增量 $d\\boldsymbol{\\varepsilon}$ 的加法分解为：\n$$d\\boldsymbol{\\varepsilon} = d\\boldsymbol{\\varepsilon}^{e} + d\\boldsymbol{\\varepsilon}^{p}$$\n其中 $d\\boldsymbol{\\varepsilon}^{e}$ 是弹性应变增量，$d\\boldsymbol{\\varepsilon}^{p}$ 是塑性应变增量。\n\n各向同性线性弹性应力-应变关系由胡克定律（Hooke's law）给出：\n$$d\\boldsymbol{\\sigma} = \\mathbb{C} : d\\boldsymbol{\\varepsilon}^{e}$$\n其中 $\\mathbb{C}$ 是四阶弹性张量，由体积模量 $K$ 和剪切模量 $G$ 定义。\n\n塑性流动由非关联流动法则控制：\n$$d\\boldsymbol{\\varepsilon}^{p} = d\\lambda \\, \\frac{\\partial g}{\\partial \\boldsymbol{\\sigma}}$$\n其中 $d\\lambda \\ge 0$ 是塑性乘子增量，$g(p,q)$ 是塑性势函数，它与屈服函数 $f(p,q)$ 不同。\n\n屈服条件由一个 Drucker–Prager 屈服函数描述：\n$$f(p,q) = q + \\beta p - \\sigma_{y} = 0$$\n其中 $p = \\frac{1}{3}\\text{tr}(\\boldsymbol{\\sigma})$ 是静水压力，$q = \\sqrt{\\frac{3}{2}\\boldsymbol{s}:\\boldsymbol{s}}$ 是偏应力（其中 $\\boldsymbol{s}=\\boldsymbol{\\sigma}-p\\boldsymbol{I}$），$\\beta$ 是与摩擦相关的材料参数，$\\sigma_{y}$ 是纯剪切下的屈服应力（假设理想塑性，因此 $\\sigma_y$ 是常数）。\n\n塑性势由一个凸函数给出：\n$$g(p,q) = \\sqrt{q^{2} + (\\beta_{g} p)^{2}}$$\n其中 $\\beta_{g}$ 是剪胀参数。非关联性意味着 $g \\ne f$，这在这里通常是成立的，特别是在函数形式上，并且因为 $\\beta_g$ 可能不同于 $\\beta$。\n\n### 2. 向后欧拉积分与返回映射\n\n问题指定了用于应力更新的向后欧拉积分格式。给定在步骤 $n+1$ 的试探弹性应力 $\\boldsymbol{\\sigma}_{\\text{tr}}$（通过假设整个应变增量都是弹性的来计算），最终应力 $\\boldsymbol{\\sigma}_{n+1}$ 会根据塑性流动进行修正：\n$$\\boldsymbol{\\sigma}_{n+1} = \\boldsymbol{\\sigma}_{\\text{tr}} - \\mathbb{C} : \\Delta\\boldsymbol{\\varepsilon}^{p}_{n+1}$$\n其中 $\\Delta\\boldsymbol{\\varepsilon}^{p}_{n+1}$ 是该步骤内的塑性应变增量。使用向后欧拉法则，右侧的所有量都在步骤结束时（$n+1$）进行评估：\n$$\\Delta\\boldsymbol{\\varepsilon}^{p}_{n+1} = \\Delta\\lambda \\, \\frac{\\partial g}{\\partial \\boldsymbol{\\sigma}}\\bigg|_{n+1}$$\n目标是找到 $\\boldsymbol{\\sigma}_{n+1}$（以及相应的 $\\Delta\\lambda$），使其满足更新方程和塑性一致性条件 $f(\\boldsymbol{\\sigma}_{n+1}) = 0$。\n\n### 3. 在不变量空间中的推导\n\n为了简化张量方程，我们将其投影到静水-偏应力空间（$p,q$）。各向同性弹性张量 $\\mathbb{C}$ 分别作用于张量参数的体积部分和偏量部分。应力更新可以分解如下：\n- 静水部分：$p_{n+1} = p_{\\text{tr}} - K \\, \\text{tr}(\\Delta\\boldsymbol{\\varepsilon}^{p}_{n+1})$\n- 偏量部分：$\\boldsymbol{s}_{n+1} = \\boldsymbol{s}_{\\text{tr}} - 2G \\, (\\Delta\\boldsymbol{\\varepsilon}^{p}_{n+1})'$\n其中 $(\\cdot)'$ 表示张量的偏量部分。\n\n我们需要塑性势的梯度 $\\frac{\\partial g}{\\partial \\boldsymbol{\\sigma}}$。使用链式法则：\n$$\\frac{\\partial g}{\\partial \\boldsymbol{\\sigma}} = \\frac{\\partial g}{\\partial p}\\frac{\\partial p}{\\partial \\boldsymbol{\\sigma}} + \\frac{\\partial g}{\\partial q}\\frac{\\partial q}{\\partial \\boldsymbol{\\sigma}}$$\n由于 $\\frac{\\partial p}{\\partial \\boldsymbol{\\sigma}} = \\frac{1}{3}\\boldsymbol{I}$ 和 $\\frac{\\partial q}{\\partial \\boldsymbol{\\sigma}} = \\frac{3}{2q}\\boldsymbol{s}$，我们得到：\n$$\\frac{\\partial g}{\\partial \\boldsymbol{\\sigma}} = \\frac{\\partial g}{\\partial p} \\frac{1}{3}\\boldsymbol{I} + \\frac{\\partial g}{\\partial q} \\frac{3}{2q}\\boldsymbol{s}_{n+1}$$\n我们将 $g$ 在状态 $(p_{n+1}, q_{n+1})$ 下的偏导数记为 $g_p$ 和 $g_q$：\n$$g_p = \\frac{\\partial g}{\\partial p} = \\frac{\\beta_g^2 p_{n+1}}{\\sqrt{q_{n+1}^2 + (\\beta_g p_{n+1})^2}} = \\frac{\\beta_g^2 p_{n+1}}{g_{n+1}}$$\n$$g_q = \\frac{\\partial g}{\\partial q} = \\frac{q_{n+1}}{\\sqrt{q_{n+1}^2 + (\\beta_g p_{n+1})^2}} = \\frac{q_{n+1}}{g_{n+1}}$$\n塑性应变增量为 $\\Delta\\boldsymbol{\\varepsilon}^{p}_{n+1} = \\Delta\\lambda (\\frac{g_p}{3}\\boldsymbol{I} + g_q \\frac{3}{2q_{n+1}}\\boldsymbol{s}_{n+1})$。\n\n其迹和偏量部分为：\n$$\\text{tr}(\\Delta\\boldsymbol{\\varepsilon}^{p}_{n+1}) = \\Delta\\lambda \\, g_p$$\n$$(\\Delta\\boldsymbol{\\varepsilon}^{p}_{n+1})' = \\Delta\\lambda \\, g_q \\frac{3}{2q_{n+1}}\\boldsymbol{s}_{n+1}$$\n\n将这些代入分解后的应力更新方程，得到：\n$p_{n+1} = p_{\\text{tr}} - K \\Delta\\lambda \\, g_p$\n$\\boldsymbol{s}_{n+1} = \\boldsymbol{s}_{\\text{tr}} - 2G \\Delta\\lambda \\left(g_q \\frac{3}{2q_{n+1}}\\boldsymbol{s}_{n+1}\\right) = \\boldsymbol{s}_{\\text{tr}} - 3G \\Delta\\lambda\\frac{g_q}{q_{n+1}}\\boldsymbol{s}_{n+1}$\n\n偏量方程意味着 $\\boldsymbol{s}_{n+1}$ 和 $\\boldsymbol{s}_{\\text{tr}}$ 是共轴的。我们可以对两边取缩放范数 $q = \\sqrt{\\frac{3}{2}}\\|\\boldsymbol{s}\\|$：\n$q_{n+1} = q_{\\text{tr}} - 3G \\Delta\\lambda\\frac{g_q}{q_{n+1}}q_{n+1} = q_{\\text{tr}} - 3G \\Delta\\lambda \\, g_q$\n\n因此，我们得到了一个在 $(p,q)$ 空间中定义返回映射的方程组。为方便起见，我们省略未知变量 $p, q, \\Delta\\lambda$ 的下标 $n+1$：\n$$p = p_{\\text{tr}} - K \\Delta\\lambda \\, g_p(p,q)$$\n$$q = q_{\\text{tr}} - 3G \\Delta\\lambda \\, g_q(p,q)$$\n\n### 4. 非线性系统与雅可比矩阵\n\n为了求解未知量 $\\{p, q, \\Delta\\lambda\\}$，我们将两个返回映射方程与一致性条件 $f(p,q) = 0$ 结合起来。这形成了一个 $3 \\times 3$ 的非线性系统 $\\boldsymbol{R}(p,q,\\Delta\\lambda) = \\boldsymbol{0}$：\n\\begin{align*}\nR_1(p,q,\\Delta\\lambda) = p - p_{\\text{tr}} + K \\Delta\\lambda \\, g_p = p - p_{\\text{tr}} + K \\Delta\\lambda \\frac{\\beta_g^2 p}{\\sqrt{q^2 + (\\beta_g p)^2}} = 0 \\\\\nR_2(p,q,\\Delta\\lambda) = q - q_{\\text{tr}} + 3G \\Delta\\lambda \\, g_q = q - q_{\\text{tr}} + 3G \\Delta\\lambda \\frac{q}{\\sqrt{q^2 + (\\beta_g p)^2}} = 0 \\\\\nR_3(p,q,\\Delta\\lambda) = q + \\beta p - \\sigma_y = 0\n\\end{align*}\n\n为使用牛顿-拉夫逊方法求解该系统，我们需要雅可比矩阵 $\\boldsymbol{J} = \\frac{\\partial \\boldsymbol{R}}{\\partial \\boldsymbol{x}}$，其中 $\\boldsymbol{x} = [p, q, \\Delta\\lambda]^T$。分量 $J_{ij} = \\frac{\\partial R_i}{\\partial x_j}$ 的推导如下，令 $g = \\sqrt{q^2 + (\\beta_g p)^2}$：\n\n$R_1$ 的导数：\n$\\frac{\\partial R_1}{\\partial p} = 1 + K \\Delta\\lambda \\beta_g^2 \\frac{\\partial}{\\partial p}\\left(\\frac{p}{g}\\right) = 1 + K \\Delta\\lambda \\beta_g^2 \\frac{q^2}{g^3}$\n$\\frac{\\partial R_1}{\\partial q} = K \\Delta\\lambda \\beta_g^2 p \\frac{\\partial}{\\partial q}\\left(\\frac{1}{g}\\right) = -K \\Delta\\lambda \\beta_g^2 \\frac{pq}{g^3}$\n$\\frac{\\partial R_1}{\\partial \\Delta\\lambda} = K g_p = K \\frac{\\beta_g^2 p}{g}$\n\n$R_2$ 的导数：\n$\\frac{\\partial R_2}{\\partial p} = 3G \\Delta\\lambda q \\frac{\\partial}{\\partial p}\\left(\\frac{1}{g}\\right) = -3G \\Delta\\lambda \\frac{\\beta_g^2 pq}{g^3}$\n$\\frac{\\partial R_2}{\\partial q} = 1 + 3G \\Delta\\lambda \\frac{\\partial}{\\partial q}\\left(\\frac{q}{g}\\right) = 1 + 3G \\Delta\\lambda \\frac{(\\beta_g p)^2}{g^3}$\n$\\frac{\\partial R_2}{\\partial \\Delta\\lambda} = 3G g_q = 3G \\frac{q}{g}$\n\n$R_3$ 的导数：\n$\\frac{\\partial R_3}{\\partial p} = \\beta$\n$\\frac{\\partial R_3}{\\partial q} = 1$\n$\\frac{\\partial R_3}{\\partial \\Delta\\lambda} = 0$\n\n完整的雅可比矩阵为：\n$$\n\\boldsymbol{J} =\n\\begin{pmatrix}\n1 + K \\Delta\\lambda \\beta_g^2 \\frac{q^2}{g^3}   -K \\Delta\\lambda \\frac{\\beta_g^2 pq}{g^3}   K \\frac{\\beta_g^2 p}{g} \\\\\n-3G \\Delta\\lambda \\frac{\\beta_g^2 pq}{g^3}   1 + 3G \\Delta\\lambda \\frac{(\\beta_g p)^2}{g^3}   3G \\frac{q}{g} \\\\\n\\beta   1   0\n\\end{pmatrix}\n$$\n\n由于非关联流动法则，该雅可比矩阵是非对称的。具体来说，非对角线项 $J_{12}$ 和 $J_{21}$ 通常不相等，因为对于大多数材料 $K \\ne 3G$：\n$$J_{12} = -K \\Delta\\lambda \\frac{\\beta_g^2 pq}{g^3} \\neq -3G \\Delta\\lambda \\frac{\\beta_g^2 pq}{g^3} = J_{21}$$\n如果流动是关联的（$f=g$），该公式将大大简化，通常会得到一个对称的雅可比矩阵，甚至是 $\\Delta\\lambda$ 的一个闭式解。\n\n### 5. 牛顿-拉夫逊算法\n\n首先，我们通过评估屈服函数来检查试探状态是否为弹性：如果 $f_{\\text{tr}}(p_{\\text{tr}}, q_{\\text{tr}}) = q_{\\text{tr}} + \\beta p_{\\text{tr}} - \\sigma_y \\le 0$，则状态是弹性的或位于屈服面上。不需要进行塑性修正，因此 $\\Delta\\lambda = 0$。\n\n如果 $f_{\\text{tr}}  0$，则状态是塑性的，我们必须执行返回映射修正。我们迭代求解 $\\boldsymbol{R}(\\boldsymbol{x}) = \\boldsymbol{0}$：\n1.  初始化迭代计数器 $k=0$ 和解向量 $\\boldsymbol{x}_0 = [p_{\\text{tr}}, q_{\\text{tr}}, 0]^T$。\n2.  在每次迭代 $k$ 中：\n    a. 计算残差向量 $\\boldsymbol{R}_k = \\boldsymbol{R}(\\boldsymbol{x}_k)$。\n    b. 检查收敛性：如果范数 $\\|\\boldsymbol{R}_k\\|$ 低于指定的容差（例如 $10^{-8}$），则已找到解。\n    c. 计算雅可比矩阵 $\\boldsymbol{J}_k = \\boldsymbol{J}(\\boldsymbol{x}_k)$。\n    d. 求解线性系统以获得更新步长 $\\Delta\\boldsymbol{x}_k$：$\\boldsymbol{J}_k \\Delta\\boldsymbol{x}_k = -\\boldsymbol{R}_k$。\n    e. 更新解：$\\boldsymbol{x}_{k+1} = \\boldsymbol{x}_k + \\Delta\\boldsymbol{x}_k$。\n3.  重复此过程，直到收敛或达到最大迭代次数。塑性乘子的最终结果是收敛解向量的第三个分量，即 $\\Delta\\lambda = x_2$。\n\n将实现此算法来求解所提供测试用例的 $\\Delta\\lambda$。", "answer": "```python\nimport numpy as np\n\ndef solve_case(p_tr, q_tr, beta, beta_g, sigma_y, K, G):\n    \"\"\"\n    Computes the plastic multiplier increment Delta_lambda for a single test case\n    using a Newton-Raphson return-mapping algorithm.\n\n    Args:\n        p_tr (float): Trial hydrostatic pressure (MPa).\n        q_tr (float): Trial deviatoric stress (MPa).\n        beta (float): Material parameter for the yield function.\n        beta_g (float): Dilation parameter for the plastic potential.\n        sigma_y (float): Yield stress (MPa).\n        K (float): Bulk modulus (MPa).\n        G (float): Shear modulus (MPa).\n\n    Returns:\n        float: The computed plastic multiplier increment Delta_lambda.\n    \"\"\"\n    # Step 1: Check if the trial state is elastic\n    f_tr = q_tr + beta * p_tr - sigma_y\n    if f_tr = 0:\n        return 0.0\n\n    # Step 2: Set up the Newton-Raphson iteration\n    # Initial guess for x = [p, q, delta_lambda]\n    x = np.array([p_tr, q_tr, 0.0], dtype=np.float64)\n    \n    max_iter = 20\n    tolerance = 1e-8\n\n    for _ in range(max_iter):\n        p, q, delta_lambda = x\n\n        # Step 3: Evaluate geometric and material quantities\n        # Add a small stabilization term to prevent division by zero at the apex,\n        # although not strictly necessary for the given test cases.\n        g_sq = q**2 + (beta_g * p)**2\n        g = np.sqrt(g_sq) if g_sq > 1e-24 else 1e-12\n\n        # Step 4: Assemble the residual vector R\n        R = np.zeros(3, dtype=np.float64)\n        R[0] = p - p_tr + K * delta_lambda * beta_g**2 * p / g\n        R[1] = q - q_tr + 3.0 * G * delta_lambda * q / g\n        R[2] = q + beta * p - sigma_y\n\n        # Step 5: Check for convergence\n        residual_norm = np.linalg.norm(R)\n        if residual_norm  tolerance:\n            return x[2]\n\n        # Step 6: Assemble the Jacobian matrix J\n        g3 = g**3\n        J = np.zeros((3, 3), dtype=np.float64)\n\n        # Row 1 gradients (dR1/dp, dR1/dq, dR1/d_delta_lambda)\n        J[0, 0] = 1.0 + K * delta_lambda * beta_g**2 * q**2 / g3\n        J[0, 1] = -K * delta_lambda * beta_g**2 * p * q / g3\n        J[0, 2] = K * beta_g**2 * p / g\n\n        # Row 2 gradients (dR2/dp, dR2/dq, dR2/d_delta_lambda)\n        J[1, 0] = -3.0 * G * delta_lambda * beta_g**2 * p * q / g3\n        J[1, 1] = 1.0 + 3.0 * G * delta_lambda * (beta_g * p)**2 / g3\n        J[1, 2] = 3.0 * G * q / g\n\n        # Row 3 gradients (dR3/dp, dR3/dq, dR3/d_delta_lambda)\n        J[2, 0] = beta\n        J[2, 1] = 1.0\n        J[2, 2] = 0.0\n\n        # Step 7: Solve the linear system J * delta_x = -R and update x\n        try:\n            delta_x = np.linalg.solve(J, -R)\n        except np.linalg.LinAlgError:\n            # This indicates a singular Jacobian, which suggests a problem\n            # with the formulation or state (e.g., apex). Fail gracefully.\n            raise RuntimeError(\"NR failed due to a singular Jacobian matrix.\")\n        \n        x += delta_x\n\n    # If the loop completes without converging, raise an error.\n    raise RuntimeError(f\"Newton-Raphson failed to converge within {max_iter} iterations.\")\n\ndef solve():\n    \"\"\"\n    Main function to run all test cases and print the results.\n    \"\"\"\n    # Test suite: (p_tr, q_tr, beta, beta_g, sigma_y, K, G)\n    test_cases = [\n        (150.0, 120.0, 0.30, 0.10, 100.0, 10000.0, 8000.0),\n        (200.0, 100.0, 0.25, 0.20, 150.0, 12000.0, 9000.0),\n        (0.0, 200.0, 0.30, 0.30, 180.0, 11000.0, 8500.0),\n        (-50.0, 150.0, 0.20, 0.15, 160.0, 10000.0, 8000.0),\n        (100.0, 150.0, 0.28, 0.60, 120.0, 15000.0, 10000.0)\n    ]\n\n    results = []\n    for case in test_cases:\n        delta_lambda = solve_case(*case)\n        results.append(delta_lambda)\n\n    # Format the output as a comma-separated list in brackets.\n    # Using sufficient precision to capture the float value accurately.\n    output_str = \"[\" + \",\".join(f\"{r:.12f}\" for r in results) + \"]\"\n    print(output_str)\n\n# Execute the solver\nsolve()\n```", "id": "3545042"}]}