{"hands_on_practices": [{"introduction": "理解同位素图谱的形成是解读它的第一步。本练习将指导您从第一性原理出发，为一个同时含有硫和硅的分子计算 $M+2$ 峰的强度。通过组合不同同位素构型的概率，您将对元素组成如何直接转化为质谱图谱建立起基础的理解。[@problem_id:3709664]", "problem": "一个有机分子在单电荷状态下通过质谱（MS）进行分析。该分子含有 $n_{\\mathrm{S}}=3$ 个硫原子和 $n_{\\mathrm{Si}}=2$ 个硅原子。假设每个原子上的同位素选择是独立的，并遵循硫和硅的自然同位素丰度。对于硫，取 $^{34}\\mathrm{S}$ 和 $^{33}\\mathrm{S}$ 的分数丰度分别为 $p_{34}=0.0425$ 和 $p_{33}=0.0075$，并将基线 $^{32}\\mathrm{S}$ 的分数定义为 $p_{32}=1-p_{33}-p_{34}$。对于硅，取 $^{30}\\mathrm{Si}$ 和 $^{29}\\mathrm{Si}$ 的分数丰度分别为 $q_{30}=0.0310$ 和 $q_{29}=0.0469$，并将基线 $^{28}\\mathrm{Si}$ 的分数定义为 $q_{28}=1-q_{29}-q_{30}$。由于 $^{36}\\mathrm{S}$ 的丰度极低，忽略其影响，并忽略分子中所有其他元素的贡献。\n\n在同位素模式分析中，单一同位素组成（$^{32}\\mathrm{S}$ 和 $^{28}\\mathrm{Si}$）定义了 $M$ 峰。相对于基线重 $+1$ 的同位素的存在对质量偏移贡献 $+1$，重 $+2$ 的同位素对质量偏移贡献 $+2$。具体来说，$^{33}\\mathrm{S}$ 和 $^{29}\\mathrm{Si}$ 贡献 $+1$，而 $^{34}\\mathrm{S}$ 和 $^{30}\\mathrm{Si}$ 贡献 $+2$。观测到的 $M+2$ 强度来自于净质量偏移恰好为 $+2$ 的构型。\n\n从同位素选择的独立性和相同位点的基本计数原理出发，根据第一性原理推导一个闭式表达式，用于计算该分子仅因硫和硅同位素而表现出相对于单一同位素组成恰好为 $+2$ 道尔顿质量偏移的概率。您的表达式必须对所有产生净 $+2$ 偏移的允许构型的不相交贡献求和。然后使用上面指定的 $p_{34}$、$p_{33}$、$p_{32}$、$q_{30}$、$q_{29}$ 和 $q_{28}$ 对该表达式进行数值计算。\n\n将您的最终答案表示为无量纲小数，并四舍五入到四位有效数字。", "solution": "该问题提法清晰，具有科学依据，并包含了推导唯一解所需的所有信息。我们可以开始推导。\n\n问题要求计算观测到相对于单一同位素质量有 $+2$ 道尔顿质量偏移的概率，这对应于质谱中的 $M+2$ 峰。该分子含有 $n_{\\mathrm{S}}=3$ 个硫原子和 $n_{\\mathrm{Si}}=2$ 个硅原子。总质量偏移 $\\Delta m_{total}$ 是硫同位素的质量偏移 $\\Delta m_{\\mathrm{S}}$ 和硅同位素的质量偏移 $\\Delta m_{\\mathrm{Si}}$ 的和。\n$$\n\\Delta m_{total} = \\Delta m_{\\mathrm{S}} + \\Delta m_{\\mathrm{Si}}\n$$\n我们要求解概率 $P(\\Delta m_{total} = 2)$。由于每个原子位点上的同位素选择是独立的，因此硫原子组的选择与硅原子组的选择是独立的。因此，总偏移为 $+2$ 的概率可以表示为所有不相交复合事件的概率之和，其中各个偏移量之和为 $+2$。\n$$\nP(\\Delta m_{total} = 2) = \\sum_{i+j=2} P(\\Delta m_{\\mathrm{S}} = i \\text{ and } \\Delta m_{\\mathrm{Si}} = j)\n$$\n根据独立性，这变为：\n$$\nP(M+2) = P(\\Delta m_{\\mathrm{S}}=0)P(\\Delta m_{\\mathrm{Si}}=2) + P(\\Delta m_{\\mathrm{S}}=1)P(\\Delta m_{\\mathrm{Si}}=1) + P(\\Delta m_{\\mathrm{S}}=2)P(\\Delta m_{\\mathrm{Si}}=0)\n$$\n我们现在必须从第一性原理出发，分别推导硫部分和硅部分的质量偏移为 $0$、$1$ 和 $2$ 的概率表达式。\n\n给定的同位素丰度为：\n硫：$p_{34}=0.0425$ ($\\Delta m = +2$)，$p_{33}=0.0075$ ($\\Delta m = +1$)，以及 $p_{32}=1-p_{33}-p_{34}=1-0.0075-0.0425=0.9500$ ($\\Delta m = 0$)。\n硅：$q_{30}=0.0310$ ($\\Delta m = +2$)，$q_{29}=0.0469$ ($\\Delta m = +1$)，以及 $q_{28}=1-q_{29}-q_{30}=1-0.0469-0.0310=0.9221$ ($\\Delta m = 0$)。\n\n**1. 硫部分（$n_{\\mathrm{S}}=3$）的概率分布**\n3个硫原子的同位素选择遵循多项分布。含有 $k_{32}$ 个 $^{32}\\mathrm{S}$ 原子、$k_{33}$ 个 $^{33}\\mathrm{S}$ 原子和 $k_{34}$ 个 $^{34}\\mathrm{S}$ 原子的概率为：\n$$\nP(k_{32}, k_{33}, k_{34}) = \\frac{n_{\\mathrm{S}}!}{k_{32}! k_{33}! k_{34}!} p_{32}^{k_{32}} p_{33}^{k_{33}} p_{34}^{k_{34}}\n$$\n其中 $k_{32}+k_{33}+k_{34}=3$。硫的总质量偏移为 $\\Delta m_{\\mathrm{S}} = 1 \\cdot k_{33} + 2 \\cdot k_{34}$。\n\n-   **$P(\\Delta m_{\\mathrm{S}}=0)$**：这要求 $k_{33}=0$ 和 $k_{34}=0$，意味着 $k_{32}=3$。\n    构型：($3 \\times ^{32}\\mathrm{S}$)。\n    $P(\\Delta m_{\\mathrm{S}}=0) = \\frac{3!}{3!0!0!} p_{32}^3 p_{33}^0 p_{34}^0 = p_{32}^3$。\n\n-   **$P(\\Delta m_{\\mathrm{S}}=1)$**：这要求 $k_{33}=1$ 和 $k_{34}=0$，意味着 $k_{32}=2$。\n    构型：($1 \\times ^{33}\\mathrm{S}$，$2 \\times ^{32}\\mathrm{S}$)。\n    $P(\\Delta m_{\\mathrm{S}}=1) = \\frac{3!}{2!1!0!} p_{32}^2 p_{33}^1 p_{34}^0 = 3 p_{32}^2 p_{33}$。\n\n-   **$P(\\Delta m_{\\mathrm{S}}=2)$**：这可以通过两种不相交的方式实现：\n    a) 一个 $^{34}\\mathrm{S}$ 同位素：$k_{34}=1, k_{33}=0 \\implies k_{32}=2$。构型：($1 \\times ^{34}\\mathrm{S}$，$2 \\times ^{32}\\mathrm{S}$)。\n    概率：$\\frac{3!}{2!0!1!} p_{32}^2 p_{33}^0 p_{34}^1 = 3 p_{32}^2 p_{34}$。\n    b) 两个 $^{33}\\mathrm{S}$ 同位素：$k_{33}=2, k_{34}=0 \\implies k_{32}=1$。构型：($2 \\times ^{33}\\mathrm{S}$，$1 \\times ^{32}\\mathrm{S}$)。\n    概率：$\\frac{3!}{1!2!0!} p_{32}^1 p_{33}^2 p_{34}^0 = 3 p_{32} p_{33}^2$。\n    总概率是其和：$P(\\Delta m_{\\mathrm{S}}=2) = 3 p_{32}^2 p_{34} + 3 p_{32} p_{33}^2$。\n\n**2. 硅部分（$n_{\\mathrm{Si}}=2$）的概率分布**\n类似地，对于2个硅原子，其概率为 $q_{28}, q_{29}, q_{30}$：\n硅的总质量偏移为 $\\Delta m_{\\mathrm{Si}} = 1 \\cdot j_{29} + 2 \\cdot j_{30}$，其中 $j_{28}+j_{29}+j_{30}=2$。\n\n-   **$P(\\Delta m_{\\mathrm{Si}}=0)$**：要求 $j_{29}=0, j_{30}=0 \\implies j_{28}=2$。\n    构型：($2 \\times ^{28}\\mathrm{Si}$)。\n    $P(\\Delta m_{\\mathrm{Si}}=0) = \\frac{2!}{2!0!0!} q_{28}^2 q_{29}^0 q_{30}^0 = q_{28}^2$。\n\n-   **$P(\\Delta m_{\\mathrm{Si}}=1)$**：要求 $j_{29}=1, j_{30}=0 \\implies j_{28}=1$。\n    构型：($1 \\times ^{29}\\mathrm{Si}$，$1 \\times ^{28}\\mathrm{Si}$)。\n    $P(\\Delta m_{\\mathrm{Si}}=1) = \\frac{2!}{1!1!0!} q_{28}^1 q_{29}^1 q_{30}^0 = 2 q_{28} q_{29}$。\n\n-   **$P(\\Delta m_{\\mathrm{Si}}=2)$**：这可以通过两种不相交的方式实现：\n    a) 一个 $^{30}\\mathrm{Si}$ 同位素：$j_{30}=1, j_{29}=0 \\implies j_{28}=1$。构型：($1 \\times ^{30}\\mathrm{Si}$，$1 \\times ^{28}\\mathrm{Si}$)。\n    概率：$\\frac{2!}{1!0!1!} q_{28}^1 q_{29}^0 q_{30}^1 = 2 q_{28} q_{30}$。\n    b) 两个 $^{29}\\mathrm{Si}$ 同位素：$j_{29}=2, j_{30}=0 \\implies j_{28}=0$。构型：($2 \\times ^{29}\\mathrm{Si}$)。\n    概率：$\\frac{2!}{0!2!0!} q_{28}^0 q_{29}^2 q_{30}^0 = q_{29}^2$。\n    总概率是其和：$P(\\Delta m_{\\mathrm{Si}}=2) = 2 q_{28} q_{30} + q_{29}^2$。\n\n**3. $P(M+2)$ 的最终闭式表达式**\n将这些推导出的表达式代入我们原始的 $P(M+2)$ 公式中：\n$$\nP(M+2) = (p_{32}^3) \\cdot (2 q_{28} q_{30} + q_{29}^2) + (3 p_{32}^2 p_{33}) \\cdot (2 q_{28} q_{29}) + (3 p_{32}^2 p_{34} + 3 p_{32} p_{33}^2) \\cdot (q_{28}^2)\n$$\n这就是从第一性原理推导出的所需闭式表达式。\n\n**4. 数值计算**\n首先，我们计算各组成部分的概率数值：\n$P(\\Delta m_{\\mathrm{S}}=0) = (0.9500)^3 = 0.857375$\n$P(\\Delta m_{\\mathrm{S}}=1) = 3(0.9500)^2(0.0075) = 0.02030625$\n$P(\\Delta m_{\\mathrm{S}}=2) = 3(0.9500)^2(0.0425) + 3(0.9500)(0.0075)^2 = 0.11506875 + 0.0001603125 = 0.1152290625$\n\n$P(\\Delta m_{\\mathrm{Si}}=0) = (0.9221)^2 = 0.85026841$\n$P(\\Delta m_{\\mathrm{Si}}=1) = 2(0.9221)(0.0469) = 0.08649298$\n$P(\\Delta m_{\\mathrm{Si}}=2) = 2(0.9221)(0.0310) + (0.0469)^2 = 0.0571702 + 0.00219961 = 0.05936981$\n\n现在，我们计算 $P(M+2)$ 的三个项：\n第1项：$P(\\Delta m_{\\mathrm{S}}=0)P(\\Delta m_{\\mathrm{Si}}=2) = (0.857375)(0.05936981) \\approx 0.05089850$\n第2项：$P(\\Delta m_{\\mathrm{S}}=1)P(\\Delta m_{\\mathrm{Si}}=1) = (0.02030625)(0.08649298) \\approx 0.00175635$\n第3项：$P(\\Delta m_{\\mathrm{S}}=2)P(\\Delta m_{\\mathrm{Si}}=0) = (0.1152290625)(0.85026841) \\approx 0.09798028$\n\n将这些项相加得到总概率：\n$P(M+2) \\approx 0.05089850 + 0.00175635 + 0.09798028 = 0.15063513$\n\n四舍五入到四位有效数字，我们得到 $0.1506$。\n让我们使用全精度值进行最终求和：\n$P(M+2) = (0.857375)(0.05936981) + (0.02030625)(0.08649298) + (0.1152290625)(0.85026841)$\n$P(M+2) = 0.050898495146875 + 0.001756346288875 + 0.09798028213200625$\n$P(M+2) = 0.15063512356775625$\n\n四舍五入到四位有效数字，最终结果为 $0.1506$。", "answer": "$$\\boxed{0.1506}$$", "id": "3709664"}, {"introduction": "在实际分析中，我们常常需要从谱图反推未知的化学组成。本问题挑战您基于观测到的 $M+2$ 强度比，推导并应用一个估算硫原子数量的估计量。该练习能够锻炼您解构同位素图谱的能力，并突显质谱定量分析中的统计学本质。[@problem_id:3709605]", "problem": "一个有机分子离子在高分辨率质谱条件下被记录，该条件可以分辨标称质量峰。其组成被限制为含有碳和硫，但不含硅。已知碳原子数为 $n_{\\mathrm{C}}=30$，硅原子数为 $n_{\\mathrm{Si}}=0$。硫原子数 $n_{\\mathrm{S}}$ 未知。观测到的 $M+2$ 峰与单同位素 $M$ 峰的强度比为 $I_{M+2}=0.12$。假设使用自然同位素丰度，其中碳-13的丰度分数为 $p_{^{13}\\mathrm{C}}=0.0107$，硫-34的丰度分数为 $p_{^{34}\\mathrm{S}}=0.0421$。忽略对 $M+2$ 峰的所有其他同位素贡献，只考虑以下两种途径：在 $n_{\\mathrm{C}}$ 个碳原子中恰好发生两次 $^{13}\\mathrm{C}$ 取代（所有硫均为 $^{32}\\mathrm{S}$），以及在 $n_{\\mathrm{S}}$ 个硫原子中恰好发生一次 $^{34}\\mathrm{S}$ 取代（所有碳均为 $^{12}\\mathrm{C}$）。在您的推导中，保留两种元素精确的 $(1-p)$ 形式的存活因子。\n\n您可以假设 $M$ 峰和 $M+2$ 峰的积分离子计数服从独立的泊松计数统计。在本实验中，记录的 $M$ 峰面积为 $N_{M}=1.00\\times 10^{5}$ 计数，且 $M+2$ 峰的面积与报告的比率 $I_{M+2}=0.12$ 一致。\n\n从每个原子位点同位素独立抽样的多项式模型出发，并且仅使用上述事实，推导出一个关于 $n_{\\mathrm{S}}$ 的显式估计量，用 $I_{M+2}$、$n_{\\mathrm{C}}$、$p_{^{13}\\mathrm{C}}$ 和 $p_{^{34}\\mathrm{S}}$ 表示。然后，对给定数据数值计算该估计量，以获得最大似然估计值 $\\hat{n}_{\\mathrm{S}}$。将您报告的 $\\hat{n}_{\\mathrm{S}}$ 值四舍五入至三位有效数字。作为推理的一部分，通过一阶误差传播评估由计数噪声引起的 $\\hat{n}_{\\mathrm{S}}$ 的单标准差不确定度，但不要将此不确定度包含在最终报告的值中。", "solution": "对所述问题进行形式化分析，并根据所需标准进行验证。\n\n**步骤1：提取已知条件**\n- 分子离子含有碳（C）和硫（S），不含硅（Si）。\n- 碳原子数：$n_{\\mathrm{C}}=30$。\n- 硅原子数：$n_{\\mathrm{Si}}=0$。\n- 硫原子数 $n_{\\mathrm{S}}$ 未知。\n- 观测到的 $M+2$ 峰与单同位素 $M$ 峰的强度比：$I_{M+2}=0.12$。\n- $^{13}\\mathrm{C}$ 的自然同位素丰度（分数）：$p_{^{13}\\mathrm{C}}=0.0107$。\n- $^{34}\\mathrm{S}$ 的自然同位素丰度（分数）：$p_{^{34}\\mathrm{S}}=0.0421$。\n- $M+2$ 峰的模型被限制在两个途径：（1）恰好两次 $^{13}\\mathrm{C}$ 取代和（2）恰好一次 $^{34}\\mathrm{S}$ 取代。所有其他同位素贡献均被忽略。\n- 必须保留 $(1-p)$ 形式的存活因子。\n- $M$ 峰和 $M+2$ 峰的离子计数服从独立的泊松计数统计。\n- 记录的 $M$ 峰面积（计数）：$N_{M}=1.00\\times 10^{5}$。\n- $M+2$ 峰的面积与比率 $I_{M+2}=0.12$ 一致。\n\n**步骤2：使用提取的已知条件进行验证**\n- **科学依据**：该问题基于质谱学和同位素丰度分析的既定原理。使用多项式（或二项式近似）分布来模拟同位素模式是一种标准方法。给定的同位素丰度是正确的。假设离子计数服从泊松统计是探测器物理学的一个基本方面。所做的简化（例如忽略 $^{33}\\mathrm{S}$ 等次要同位素或一个 $^{13}\\mathrm{C}$ 和一个 $^{33}\\mathrm{S}$ 的贡献）已明确说明，并且是在该领域中创建易于处理的问题的常用做法。\n- **适定性**：该问题是适定的。它提供了足够的数据和一组清晰的模型假设，以推导出单个未知变量 $n_{\\mathrm{S}}$ 的唯一估计量。\n- **客观性**：该问题以精确、定量和客观的语言陈述，没有任何主观或模棱两可的术语。\n\n**步骤3：结论与行动**\n该问题科学上合理，自洽且适定。因此，它被判定为**有效**。将推导解决方案。\n\n**$n_{\\mathrm{S}}$ 估计量的推导**\n\n质谱峰的强度与相应同位素组成的出现概率成正比。我们将每个原子位点上同位素的选择建模为独立的伯努利试验。\n\n单同位素峰 $M$ 对应于完全由最丰富的同位素 $^{12}\\mathrm{C}$ 和 $^{32}\\mathrm{S}$ 组成的分子。碳原子为 $^{12}\\mathrm{C}$ 的概率是 $(1 - p_{^{13}\\mathrm{C}})$。根据问题陈述，由于忽略了其他硫同位素，硫原子为 $^{32}\\mathrm{S}$ 的概率近似为 $(1 - p_{^{34}\\mathrm{S}})$。单同位素物种的概率 $P(M)$ 为：\n$$P(M) = (1 - p_{^{13}\\mathrm{C}})^{n_{\\mathrm{C}}} (1 - p_{^{34}\\mathrm{S}})^{n_{\\mathrm{S}}}$$\n\n$M+2$ 峰的强度是两个指定途径的概率之和。\n1.  **途径1：两个 $^{13}\\mathrm{C}$ 原子。** 分子在 $n_{\\mathrm{C}}$ 个碳原子中恰好含有两个 $^{13}\\mathrm{C}$ 原子，并且所有 $n_{\\mathrm{S}}$ 个硫原子都是 $^{32}\\mathrm{S}$。选择两个碳原子的方式有 $\\binom{n_{\\mathrm{C}}}{2}$ 种。此途径的概率 $P(M+2)_{\\mathrm{C}}$ 为：\n    $$P(M+2)_{\\mathrm{C}} = \\binom{n_{\\mathrm{C}}}{2} (p_{^{13}\\mathrm{C}})^{2} (1 - p_{^{13}\\mathrm{C}})^{n_{\\mathrm{C}}-2} (1 - p_{^{34}\\mathrm{S}})^{n_{\\mathrm{S}}}$$\n2.  **途径2：一个 $^{34}\\mathrm{S}$ 原子。** 分子在 $n_{\\mathrm{S}}$ 个硫原子中恰好含有一个 $^{34}\\mathrm{S}$ 原子，并且所有 $n_{\\mathrm{C}}$ 个碳原子都是 $^{12}\\mathrm{C}$。选择一个硫原子的方式有 $\\binom{n_{\\mathrm{S}}}{1} = n_{\\mathrm{S}}$ 种。此途径的概率 $P(M+2)_{\\mathrm{S}}$ 为：\n    $$P(M+2)_{\\mathrm{S}} = \\binom{n_{\\mathrm{S}}}{1} p_{^{34}\\mathrm{S}} (1 - p_{^{34}\\mathrm{S}})^{n_{\\mathrm{S}}-1} (1 - p_{^{13}\\mathrm{C}})^{n_{\\mathrm{C}}}$$\n\n$M+2$ 同位素物种的总概率 $P(M+2)$ 是这些互斥事件的和：\n$$P(M+2) = P(M+2)_{\\mathrm{C}} + P(M+2)_{\\mathrm{S}}$$\n\n理论强度比 $I_{\\text{theory}}$ 是这些概率的比值，我们将其等同于观测比率 $I_{M+2}$：\n$$I_{M+2} = \\frac{P(M+2)}{P(M)} = \\frac{P(M+2)_{\\mathrm{C}}}{P(M)} + \\frac{P(M+2)_{\\mathrm{S}}}{P(M)}$$\n代入表达式并化简：\n$$I_{M+2} = \\frac{\\binom{n_{\\mathrm{C}}}{2} (p_{^{13}\\mathrm{C}})^{2} (1 - p_{^{13}\\mathrm{C}})^{n_{\\mathrm{C}}-2} (1 - p_{^{34}\\mathrm{S}})^{n_{\\mathrm{S}}}}{(1 - p_{^{13}\\mathrm{C}})^{n_{\\mathrm{C}}} (1 - p_{^{34}\\mathrm{S}})^{n_{\\mathrm{S}}}} + \\frac{\\binom{n_{\\mathrm{S}}}{1} p_{^{34}\\mathrm{S}} (1 - p_{^{34}\\mathrm{S}})^{n_{\\mathrm{S}}-1} (1 - p_{^{13}\\mathrm{C}})^{n_{\\mathrm{C}}}}{(1 - p_{^{13}\\mathrm{C}})^{n_{\\mathrm{C}}} (1 - p_{^{34}\\mathrm{S}})^{n_{\\mathrm{S}}}}$$\n$$I_{M+2} = \\binom{n_{\\mathrm{C}}}{2} \\frac{(p_{^{13}\\mathrm{C}})^2}{(1 - p_{^{13}\\mathrm{C}})^2} + \\binom{n_{\\mathrm{S}}}{1} \\frac{p_{^{34}\\mathrm{S}}}{1 - p_{^{34}\\mathrm{S}}}$$\n使用 $\\binom{n}{k} = \\frac{n(n-1)...(n-k+1)}{k!}$，我们有 $\\binom{n_{\\mathrm{C}}}{2} = \\frac{n_{\\mathrm{C}}(n_{\\mathrm{C}}-1)}{2}$ 和 $\\binom{n_{\\mathrm{S}}}{1} = n_{\\mathrm{S}}$。\n$$I_{M+2} = \\frac{n_{\\mathrm{C}}(n_{\\mathrm{C}}-1)}{2} \\left(\\frac{p_{^{13}\\mathrm{C}}}{1 - p_{^{13}\\mathrm{C}}}\\right)^2 + n_{\\mathrm{S}} \\left(\\frac{p_{^{34}\\mathrm{S}}}{1 - p_{^{34}\\mathrm{S}}}\\right)$$\n现在我们可以重新整理这个方程来求解 $n_{\\mathrm{S}}$。这就得到了显式估计量：\n$$n_{\\mathrm{S}} \\left(\\frac{p_{^{34}\\mathrm{S}}}{1 - p_{^{34}\\mathrm{S}}}\\right) = I_{M+2} - \\frac{n_{\\mathrm{C}}(n_{\\mathrm{C}}-1)}{2} \\left(\\frac{p_{^{13}\\mathrm{C}}}{1 - p_{^{13}\\mathrm{C}}}\\right)^2$$\n$$\\hat{n}_{\\mathrm{S}} = \\left( I_{M+2} - \\frac{n_{\\mathrm{C}}(n_{\\mathrm{C}}-1)}{2} \\left(\\frac{p_{^{13}\\mathrm{C}}}{1 - p_{^{13}\\mathrm{C}}}\\right)^2 \\right) \\left(\\frac{1 - p_{^{34}\\mathrm{S}}}{p_{^{34}\\mathrm{S}}}\\right)$$\n\n**数值计算**\n我们将给定值代入 $\\hat{n}_{\\mathrm{S}}$ 的估计量中：\n- $I_{M+2} = 0.12$\n- $n_{\\mathrm{C}} = 30$\n- $p_{^{13}\\mathrm{C}} = 0.0107$\n- $p_{^{34}\\mathrm{S}} = 0.0421$\n\n首先，计算来自碳的贡献：\n$$\\text{碳项} = \\frac{30(29)}{2} \\left(\\frac{0.0107}{1 - 0.0107}\\right)^2 = 435 \\left(\\frac{0.0107}{0.9893}\\right)^2 \\approx 435 \\times (0.0108157)^2 \\approx 0.050895$$\n接下来，计算硫项的乘法因子：\n$$\\frac{1 - p_{^{34}\\mathrm{S}}}{p_{^{34}\\mathrm{S}}} = \\frac{1 - 0.0421}{0.0421} = \\frac{0.9579}{0.0421} \\approx 22.753$$\n现在，将这些代入 $\\hat{n}_{\\mathrm{S}}$ 的表达式中：\n$$\\hat{n}_{\\mathrm{S}} \\approx (0.12 - 0.050895) \\times 22.753$$\n$$\\hat{n}_{\\mathrm{S}} \\approx 0.069105 \\times 22.753 \\approx 1.57228$$\n四舍五入至三位有效数字，最大似然估计值为 $\\hat{n}_{\\mathrm{S}} = 1.57$。这个非整数结果是基于噪声数据的统计估计量的预期结果。\n\n**不确定度分析**\n$\\hat{n}_{\\mathrm{S}}$ 的不确定度源于 $I_{M+2}$ 测量中的泊松计数噪声。\n估计量的形式为 $\\hat{n}_{\\mathrm{S}} = (I_{M+2} - C)K$，其中 $C$ 和 $K$ 是从 $n_{\\mathrm{C}}$、$p_{^{13}\\mathrm{C}}$ 和 $p_{^{34}\\mathrm{S}}$ 导出的常数。\n使用一阶误差传播，$\\hat{n}_{\\mathrm{S}}$ 的方差为 $\\sigma^2_{\\hat{n}_{\\mathrm{S}}} \\approx \\left(\\frac{\\partial \\hat{n}_{\\mathrm{S}}}{\\partial I_{M+2}}\\right)^2 \\sigma^2_{I_{M+2}}$。\n导数为 $\\frac{\\partial \\hat{n}_{\\mathrm{S}}}{\\partial I_{M+2}} = K = \\frac{1 - p_{^{34}\\mathrm{S}}}{p_{^{34}\\mathrm{S}}}$。\n比率 $I_{M+2} = N_{M+2}/N_M$ 的方差由 $\\sigma^2_I \\approx \\frac{I(1+I)}{N_M}$ 给出，其中 $N_M$ 和 $N_{M+2}$ 是独立的泊松计数。\n当 $N_M = 1.00 \\times 10^5$ 且 $I_{M+2} = 0.12$ 时：\n$$\\sigma^2_{I_{M+2}} \\approx \\frac{0.12(1+0.12)}{1.00 \\times 10^5} = \\frac{0.1344}{10^5} = 1.344 \\times 10^{-6}$$\n该比率的标准差为 $\\sigma_{I_{M+2}} = \\sqrt{1.344 \\times 10^{-6}} \\approx 1.159 \\times 10^{-3}$。\n$\\hat{n}_{\\mathrm{S}}$ 的不确定度为：\n$$\\sigma_{\\hat{n}_{\\mathrm{S}}} \\approx |K| \\sigma_{I_{M+2}} \\approx 22.753 \\times (1.159 \\times 10^{-3}) \\approx 0.026$$\n因此，估计值可报告为 $\\hat{n}_{\\mathrm{S}} = 1.572 \\pm 0.026$。这个很小的不确定度表明，真实的整数值极不可能是1，但与2是一致的。然而，问题要求的是估计量本身的数值。", "answer": "$$\\boxed{1.57}$$", "id": "3709605"}, {"introduction": "区分具有相似同位素特征的元素（如硫和硅）可能颇具挑战性，特别是当碳同位素的贡献显著时。这个计算练习模拟了这一确切场景，要求您量化在低分辨率谱图中发生错误指认的风险。通过本次模拟，您将对同位素分析的局限性以及分辨率和精确建模的重要性获得切实的体会。[@problem_id:3709626]", "problem": "您必须编写一个完整且可运行的程序，该程序模拟含有单个硫原子或单个硅原子，并在存在指定数量碳原子的情况下的有机分子的低分辨率同位素丰度分布，然后评估由于碳贡献重叠而将硅误判为硫（或反之）的风险。程序必须遵守以下有科学依据的原理和定义，并严格按照指定格式生成输出。\n\n基本原理：\n- 自然同位素丰度被视为独立同位素替换的概率。对于碳，在任何给定碳位点上出现碳-13同位素的概率是 $p_C = 0.0107$，而出现碳-12的概率是 $1 - p_C = 0.9893$。对于硫，典型的自然丰度为 $\\text{^{32}S}: 0.9502$，$\\text{^{33}S}: 0.0075$，$\\text{^{34}S}: 0.0421$，$\\text{^{36}S}: 0.0002$；对于硅，其丰度为 $\\text{^{28}Si}: 0.9223$，$\\text{^{29}Si}: 0.0467$，$\\text{^{30}Si}: 0.0310$。如果需要，所有概率都应在内部重新归一化，使其总和为 $1$。这些值代表了在有机化合物质谱鉴定中广泛使用的自然同位素组成。\n- 在低分辨率（LR）质谱（MS）中，峰根据相对于单一同位素峰的标称质量位移进行分箱。低分辨率丰度分布使用整数质量位移指数 $m \\in \\{0, 1, 2, 3\\}$，分别代表 $M$、$M+1$、$M+2$ 和 $M+3$。\n- 对于一个含有 $N_C$ 个碳原子的分子，恰好发生 $k$ 次碳-13替换的分布是二项分布：$P_C(k) = \\binom{N_C}{k} p_C^k (1 - p_C)^{N_C - k}$，其中 $k \\in \\{0, 1, \\dots, N_C\\}$。这是每个碳位点上替换事件独立且概率均为 $p_C$ 的结果。\n- 硫和硅对标称质量位移 $j$ 的元素贡献由它们相对于最丰富同位素的同位素替换定义：硫贡献的位移为 $j \\in \\{0, 1, 2, 4\\}$，其概率分别对应于 $\\text{^{32}S}$、$\\text{^{33}S}$、$\\text{^{34}S}$、$\\text{^{36}S}$；而硅贡献的位移为 $j \\in \\{0, 1, 2\\}$，其概率分别对应于 $\\text{^{28}Si}$、$\\text{^{29}Si}$、$\\text{^{30}Si}$。这些概率应被视为在允许的 $j$ 值上的一个离散分布。\n- 对于给定的组成，组合的同位素丰度分布（总标称质量位移的分布）是独立的碳分布和元素分布的离散卷积：如果 $P_E(j)$ 表示硫或硅的元素分布，则 $P_{\\text{total}}(m) = \\sum_{k} P_C(k) \\, P_E(m - k)$，其中 $k$ 的取值范围使得 $P_E(m - k)$ 有定义。得到的 $P_{\\text{total}}(m)$ 随后在所有 $m$ 上进行归一化，使其总概率为1。\n- 用于比较的低分辨率丰度分布是受限集合 $\\{P_{\\text{total}}(0), P_{\\text{total}}(1), P_{\\text{total}}(2), P_{\\text{total}}(3)\\}$，即从完全归一化的分布中提取的 $m \\in \\{0,1,2,3\\}$ 处的概率。所有强度和距离必须以小数（而非百分比）表示。\n\n风险与误差量化：\n- 将硫的低分辨率丰度分布定义为 $e_S(m)$（其中 $m \\in \\{0,1,2,3\\}$），类似地，硅的丰度分布定义为 $e_{Si}(m)$。误判误差（距离）是低分辨率窗口上的欧几里得范数，\n$$\nd = \\sqrt{ \\sum_{m=0}^{3} \\left( e_S(m) - e_{Si}(m) \\right)^2 }.\n$$\n- 提供一个特定案例的阈值 $\\tau$。误判风险被定义为一个布尔值：如果 $d \\le \\tau$，则为 $\\text{True}$，否则为 $\\text{False}$。\n\n您的程序必须：\n- 完全按照规定实现上述分布和卷积。\n- 对于每个测试用例，针对给定的 $N_C$ 计算硫和硅的低分辨率丰度分布，计算 $d$，然后使用提供的 $\\tau$ 确定风险布尔值。\n- 为保证可复现性，假设测量噪声为零，并使用精确的二项分布和离散卷积模型。\n\n测试套件：\n使用以下六个测试用例，每个用例指定为一个元组 $(\\text{真实元素}, N_C, \\tau)$，其中真实元素指示哪个组分生成了观测到的丰度分布，但欧几里得距离 $d$ 是对称的，并在硫和硅的低分辨率丰度分布之间计算：\n- 案例1：$(\\text{\"S\"}, 8, 0.030)$。\n- 案例2：$(\\text{\"Si\"}, 8, 0.030)$。\n- 案例3：$(\\text{\"S\"}, 24, 0.020)$。\n- 案例4：$(\\text{\"Si\"}, 24, 0.020)$。\n- 案例5：$(\\text{\"S\"}, 40, 0.020)$。\n- 案例6：$(\\text{\"Si\"}, 1, 0.040)$。\n\n最终输出格式：\n- 对于每个测试用例，输出一个列表，其中包含四舍五入到六位小数的距离 $d$ 和风险布尔值。将六个案例的结果汇总到一个列表中。您的程序应生成单行输出，其中包含一个用方括号括起来、以逗号分隔且不含任何空格的列表，例如：$[\\,[d_1,\\text{True}],[d_2,\\text{False}],\\dots,[d_6,\\text{True}]\\,]$.\n- 不应打印任何额外文本。\n\n角度单位不适用。物理单位不适用。所有输出均为指定的无量纲小数或布尔值。", "solution": "所述问题在科学上和数学上都是有效的。它是一个适定、客观的问题，并包含足够的信息以获得唯一解。\n\n用于模拟低分辨率同位素丰度分布的基础模型基于质谱学和概率论的既定原理。所有常数和步骤都已明确定义。因此，我们可以着手提供完整解答。\n\n目标是量化两种分子的低分辨率质谱同位素丰度分布之间的相似性：一种含有单个硫原子和 $N_C$ 个碳原子，另一种含有单个硅原子和 $N_C$ 个碳原子。这种相似性通过它们各自同位素模式之间的欧几里得距离来衡量，并基于给定的阈值 $\\tau$ 来确定误判风险。该表述不需要考虑氢等其他原子，因为它们的主要同位素（例如 $^{1}\\text{H}$）定义了单一同位素质量，而其较重的同位素（例如 $^{2}\\text{H}$）丰度足够低，因此在这个由 C、S 和 Si 主导的 M、M+1、M+2 模式的标准模型中被合理地忽略。\n\n该解答源于概率论和分析化学的以下基本原理。\n\n首先，我们定义与碳、硫和硅的同位素组成相对应的概率分布。同位素峰中的总标称质量位移是每个元素的较重同位素相对于其最丰富、最轻的同位素所贡献的位移之和。\n\n对于一个含有 $N_C$ 个碳原子的分子，观测到恰好 $k$ 次 $^{13}\\text{C}$ 替换 $^{12}\\text{C}$ 的概率服从二项分布。这是基于以下假设：$N_C$ 个碳原子中的每一个都有独立且相同的概率 $p_C = 0.0107$ 成为 $^{13}\\text{C}$ 同位素。由 $k$ 次此类替换贡献的质量位移为 $k$。因此，碳贡献的概率分布 $P_C(k)$ 为：\n$$\nP_C(k) = \\binom{N_C}{k} p_C^k (1 - p_C)^{N_C - k}\n$$\n其中 $k \\in \\{0, 1, 2, \\dots, N_C\\}$。\n\n对于杂原子，其分布是离散的，并从其自然同位素丰度中导出。对于硫，其稳定同位素为 $^{32}\\text{S}$、$^{33}\\text{S}$、$^{34}\\text{S}$ 和 $^{36}\\text{S}$。相对于最丰富的同位素 $^{32}\\text{S}$ 的标称质量位移 $j$ 分别为 $0$、$1$、$2$ 和 $4$。概率分布 $P_S(j)$ 由它们的丰度给出：\n$P_S(0) = 0.9502$，$P_S(1) = 0.0075$，$P_S(2) = 0.0421$，$P_S(4) = 0.0002$，对于其他整数位移 $j$，$P_S(j)=0$。\n\n对于硅，其稳定同位素为 $^{28}\\text{Si}$、$^{29}\\text{Si}$ 和 $^{30}\\text{Si}$。相对于 $^{28}\\text{Si}$ 的标称质量位移 $j$ 分别为 $0$、$1$ 和 $2$。从它们的丰度导出的概率分布 $P_{Si}(j)$ 为：\n$P_{Si}(0) = 0.9223$，$P_{Si}(1) = 0.0467$，$P_{Si}(2) = 0.0310$，对于其他 $j$，$P_{Si}(j)=0$。\n\n第二，我们组合这些独立的概率分布以求得总同位素丰度分布。整个分子的总标称质量位移 $m$ 是来自碳的位移 $k$ 与来自杂原子（S或Si）的位移 $j$ 之和。由于同位素替换是独立事件，总质量位移的概率分布 $P_{\\text{total}}(m)$ 是各个分布的离散卷积。对于元素分布 $P_E(j)$（其中E为S或Si），总分布为：\n$$\nP_{\\text{total}}(m) = (P_C * P_E)(m) = \\sum_{k=0}^{N_C} P_C(k) \\, P_E(m-k)\n$$\n该卷积产生了所有可能的整数质量位移 $m$ 的完整概率分布。问题规定，这个得到的分布 $P_{\\text{total}}(m)$ 必须进行数值归一化，以确保其在所有 $m$ 上的总和恰好为1，这可以处理任何轻微的浮点或输入数据不一致性。\n\n第三，我们构建低分辨率（LR）丰度分布并计算它们之间的距离。低分辨率丰度分布是一个向量，由归一化总分布的前四个概率组成，对应于质量位移 $m \\in \\{0, 1, 2, 3\\}$。对于含硫化合物，其丰度分布为 $e_S = [P_{\\text{total,S}}(0), P_{\\text{total,S}}(1), P_{\\text{total,S}}(2), P_{\\text{total,S}}(3)]$。类似地，对于含硅化合物，其丰度分布为 $e_{Si} = [P_{\\text{total,Si}}(0), P_{\\text{total,Si}}(1), P_{\\text{total,Si}}(2), P_{\\text{total,Si}}(3)]$。这两个丰度分布之间的不相似性通过它们的欧几里得距离 $d$ 来量化：\n$$\nd = \\sqrt{ \\sum_{m=0}^{3} \\left( e_S(m) - e_{Si}(m) \\right)^2 }\n$$\n\n第四，我们评估误判风险。此风险定义为一个布尔值，通过将计算出的距离 $d$ 与特定案例的阈值 $\\tau$ 进行比较来确定。如果距离小于或等于阈值 $d \\le \\tau$，则认为风险显著（评估为 $\\text{True}$），否则认为不显著（$\\text{False}$）。值得注意的是，对于给定的 $N_C$，距离 $d$ 是对称的，并且与哪个元素被认为是“真实”元素无关；测试用例中的“真实元素”参数是上下文相关的，不会改变 $d$ 的计算。\n\n解决该问题的算法步骤如下：\n1.  对于每个测试用例 $(N_C, \\tau)$：\n2.  基于同位素丰度和相应的质量位移，将固定的概率分布 $P_S(j)$ 和 $P_{Si}(j)$ 定义为稀疏数组。\n3.  使用二项式公式计算 $k$ 从 $0$ 到 $N_C$ 的碳同位素分布 $P_C(k)$。\n4.  通过对 $P_C$ 和 $P_S$ 进行卷积，计算硫化合物的总分布 $P_{\\text{total,S}}$。\n5.  通过对 $P_C$ 和 $P_{Si}$ 进行卷积，计算硅化合物的总分布 $P_{\\text{total,Si}}$。\n6.  将 $P_{\\text{total,S}}$ 和 $P_{\\text{total,Si}}$ 各自除以其总和来进行归一化。\n7.  通过取归一化分布的前四个元素来提取低分辨率丰度分布向量 $e_S$ 和 $e_{Si}$，如果分布的元素少于四个，则用零填充。\n8.  计算 $e_S$ 和 $e_{Si}$ 之间的欧几里得距离 $d$。\n9.  将 $d$ 与 $\\tau$ 进行比较，以确定布尔风险值。\n10. 存储结果对：四舍五入到六位小数的距离 $d$ 和布尔风险值。\n11. 处理完所有测试用例后，将汇总结果格式化为指定的单行字符串格式。\n此过程将在提供的 Python 环境中实现，利用 `numpy` 进行数组操作和卷积，并使用 `scipy.special.comb` 高效地计算二项式系数。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.special import comb\n\ndef solve():\n    \"\"\"\n    Calculates the risk of misassigning sulfur for silicon (or vice versa)\n    in low-resolution mass spectrometry based on isotopic envelope similarity.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        (\"S\", 8, 0.030),\n        (\"Si\", 8, 0.030),\n        (\"S\", 24, 0.020),\n        (\"Si\", 24, 0.020),\n        (\"S\", 40, 0.020),\n        (\"Si\", 1, 0.040),\n    ]\n\n    # Foundational constants and isotopic abundance data.\n    P_C13 = 0.0107  # Probability of a Carbon-13 isotope.\n\n    ISOTOPE_S = {\n        0: 0.9502,  # 32S\n        1: 0.0075,  # 33S\n        2: 0.0421,  # 34S\n        4: 0.0002,  # 36S\n    }\n    \n    ISOTOPE_SI = {\n        0: 0.9223,  # 28Si\n        1: 0.0467,  # 29Si\n        2: 0.0310,  # 30Si\n    }\n\n    # Pre-process elemental distributions into numpy arrays for convolution.\n    # The array index corresponds to the nominal mass shift j.\n    \n    # Sulfur distribution P_S(j)\n    max_s_shift = max(ISOTOPE_S.keys())\n    p_s_dist = np.zeros(max_s_shift + 1)\n    for shift, prob in ISOTOPE_S.items():\n        p_s_dist[shift] = prob\n\n    # Silicon distribution P_Si(j)\n    max_si_shift = max(ISOTOPE_SI.keys())\n    p_si_dist = np.zeros(max_si_shift + 1)\n    for shift, prob in ISOTOPE_SI.items():\n        p_si_dist[shift] = prob\n\n    results = []\n    for _, n_c, tau in test_cases:\n        # Step 1: Calculate the carbon isotope distribution P_C(k).\n        # The number of 13C atoms, k, can range from 0 to n_c.\n        k_values = np.arange(n_c + 1)\n        p_c_dist = comb(n_c, k_values, exact=False) * (P_C13**k_values) * ((1 - P_C13)**(n_c - k_values))\n\n        # Step 2: Compute the total isotopic envelope via discrete convolution.\n        p_total_s = np.convolve(p_c_dist, p_s_dist)\n        p_total_si = np.convolve(p_c_dist, p_si_dist)\n\n        # Step 3: Normalize the total distributions to sum to 1, as specified.\n        # This is a safeguard against floating-point inaccuracies.\n        sum_s = np.sum(p_total_s)\n        if sum_s > 0:\n            p_total_s /= sum_s\n        \n        sum_si = np.sum(p_total_si)\n        if sum_si > 0:\n            p_total_si /= sum_si\n\n        # Step 4: Extract the low-resolution (LR) envelope for m = 0, 1, 2, 3.\n        # Ensure the envelope vectors are of length 4 by padding with zeros if needed.\n        e_s = np.zeros(4)\n        len_s = min(len(p_total_s), 4)\n        e_s[:len_s] = p_total_s[:len_s]\n\n        e_si = np.zeros(4)\n        len_si = min(len(p_total_si), 4)\n        e_si[:len_si] = p_total_si[:len_si]\n\n        # Step 5: Calculate the Euclidean distance between the LR envelopes.\n        distance = np.sqrt(np.sum((e_s - e_si)**2))\n\n        # Step 6: Determine the misassignment risk.\n        risk = distance = tau\n        \n        # Step 7: Store the result with rounded distance.\n        results.append([round(distance, 6), risk])\n\n    # Final print statement in the exact required format.\n    # The format must be a list of lists, as a string, with no spaces.\n    output_parts = [f\"[{d},{str(r)}]\" for d, r in results]\n    final_output_string = f\"[{','.join(output_parts)}]\"\n    \n    print(final_output_string.replace(\"'\", \"\"))\n\nsolve()\n```", "id": "3709626"}]}