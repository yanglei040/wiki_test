{"hands_on_practices": [{"introduction": "一个好的闭合关系不仅仅是数学上的便利，它应该具有坚实的物理基础。本练习将引导您从狭义相对论的第一性原理出发，推导广泛使用的 $M1$ 闭合关系，揭示它如何从一个协动参考系中的各向同性辐射场通过洛伦兹变换自然产生 [@problem_id:3522603]。通过这个实践，您将具体理解辐射通量与辐射压强各向异性之间的内在联系，以及 $M1$ 闭合关系如何弥合物态方程在扩散和自由传播极限之间的鸿沟。", "problem": "考虑一个由比辐射强度的前三阶角矩描述的辐射场：辐射能量密度 $E$、辐射通量矢量 $\\mathbf{F}$ 和辐射压强张量 $\\mathsf{P}$。折合通量定义为 $f \\equiv |\\mathbf{F}|/(c E)$，其中 $c$ 是光速。在矩方法中，需要一个闭合关系来用低阶矩表示 $\\mathsf{P}$。一种有物理动机的闭合关系是通过假设辐射场在共动参考系中是各向同性的，并通过一个与通量方向对齐的洛伦兹变换来关联实验室参考系中的矩。从共动参考系中的辐射应力-能量张量出发，并利用狭义相对论沿通量方向进行助推，推导爱丁顿因子 $\\chi(f)$ 的解析表达式，该因子定义为平行于通量方向的压强分量与能量密度之比，并将整个张量 $\\mathsf{P}$ 用 $E$、$\\chi(f)$ 和单位通量方向 $\\hat{\\mathbf{n}}$ 表示。\n\n然后，对于一个状态，其 $E=1$（任意单位），$|\\mathbf{F}|=0.6\\,c$，且 $\\hat{\\mathbf{n}}=\\hat{\\mathbf{x}}$，计算 $f$，评估 $\\chi(f)$，并计算 $\\mathsf{P}$ 的非零分量。最后，将得到的 $\\mathsf{P}$ 与扩散极限下的张量进行比较，并定性地评论其差异。\n\n将你的数值结果四舍五入到四位有效数字。用与 $E$ 相同的任意单位表示 $\\mathsf{P}$ 的分量。最终报告的答案必须是由 $\\chi(f)$、$P_{xx}$、$P_{yy}$ 和 $P_{zz}$ 组成的有序四元组。", "solution": "用户希望我解决一个计算天体物理学中辐射转移领域的问题。该问题被认为是有效的，因为它科学地基于狭义相对论和辐射转移理论的原理，是适定的，有足够的信息得到唯一解，并且以客观、正式的语言陈述。我现在将着手解决。\n\n解答分为三个部分：\n1.  爱丁顿因子 $\\chi(f)$ 和辐射压强张量 $\\mathsf{P}$ 的解析表达式的推导。\n2.  对给定状态的 $f$、$\\chi(f)$ 和 $\\mathsf{P}$ 的分量进行数值计算。\n3.  将得到的压强张量与扩散近似下的压强张量进行定性比较。\n\n**第一部分：M1闭合关系的推导**\n\n辐射场由应力-能量张量 $T^{\\alpha\\beta}$ 描述，其在实验室参考系中的分量与辐射能量密度 $E$、通量矢量 $\\mathbf{F}$ 和压强张量 $\\mathsf{P}$ 相关，如下所示：\n$$\nT^{00} = E, \\quad T^{0i} = T^{i0} = \\frac{F_i}{c}, \\quad T^{ij} = P_{ij}\n$$\n其中 $c$ 是光速，索引 $i, j$ 的取值范围为 1 到 3。\n\n问题陈述，在一个相对于实验室参考系以速度 $\\mathbf{v}$ 运动的共动参考系中，辐射场是各向同性的。这是辐射的静止参考系。在这个参考系中（用带撇的坐标表示），辐射通量为零（$\\mathbf{F}'=0$），且压强是各向同性的。对于光子气体，各向同性压强 $p'$ 与能量密度 $E'$ 的关系为 $p' = E'/3$。因此，静止参考系中的压强张量为 $P'_{ij} = (E'/3)\\delta_{ij}$。\n\n因此，静止参考系中的应力-能量张量 $T'^{\\alpha'\\beta'}$ 为：\n$$\nT'^{\\alpha'\\beta'} = \\begin{pmatrix} E'  0  0  0 \\\\ 0  E'/3  0  0 \\\\ 0  0  E'/3  0 \\\\ 0  0  0  E'/3 \\end{pmatrix}\n$$\n\n为了找到实验室参考系中的张量，我们对 $T'^{\\alpha'\\beta'}$ 进行洛伦兹变换。我们将助推方向与辐射通量 $\\mathbf{F}$ 的方向对齐，不失一般性地，我们取其为 $x$ 轴方向。静止参考系相对于实验室参考系的速度为 $\\mathbf{v} = v\\hat{\\mathbf{x}}$。用于此助推的洛伦兹变换矩阵 $\\Lambda^{\\alpha}_{\\alpha'}$ 是：\n$$\n\\Lambda^{\\alpha}_{\\alpha'} = \\begin{pmatrix} \\gamma  \\gamma\\beta  0  0 \\\\ \\gamma\\beta  \\gamma  0  0 \\\\ 0  0  1  0 \\\\ 0  0  0  1 \\end{pmatrix}\n$$\n其中 $\\beta = v/c$ 且 $\\gamma = (1-\\beta^2)^{-1/2}$。\n\n实验室参考系中的张量 $T^{\\alpha\\beta}$ 通过变换 $T^{\\alpha\\beta} = \\Lambda^{\\alpha}_{\\alpha'} \\Lambda^{\\beta}_{\\beta'} T'^{\\alpha'\\beta'}$ 获得。我们计算相关分量：\n\n$T^{00} = E = (\\Lambda^{0}_{0})^2 T'^{00} + (\\Lambda^{0}_{1})^2 T'^{11} = \\gamma^2 E' + (\\gamma\\beta)^2 (E'/3) = \\gamma^2 E' (1 + \\beta^2/3)$。\n\n$T^{01} = F_x/c = \\Lambda^{0}_{0}\\Lambda^{1}_{0} T'^{00} + \\Lambda^{0}_{1}\\Lambda^{1}_{1} T'^{11} = (\\gamma)(\\gamma\\beta) E' + (\\gamma\\beta)(\\gamma) (E'/3) = \\gamma^2\\beta E'(1 + 1/3) = \\frac{4}{3}\\gamma^2\\beta E'$。通过类似的计算，可得 $F_y=F_z=0$。\n\n$T^{11} = P_{xx} = (\\Lambda^{1}_{0})^2 T'^{00} + (\\Lambda^{1}_{1})^2 T'^{11} = (\\gamma\\beta)^2 E' + \\gamma^2 (E'/3) = \\gamma^2 E'(\\beta^2 + 1/3)$。\n\n$T^{22} = P_{yy} = (\\Lambda^{2}_{2})^2 T'^{22} = (1)^2(E'/3) = E'/3$。\n\n$T^{33} = P_{zz} = (\\Lambda^{3}_{3})^2 T'^{33} = (1)^2(E'/3) = E'/3$。\n\n所有非对角压强分量 $P_{ij}$ ($i\\neq j$) 均为零。\n\n折合通量 $f$ 定义为 $f \\equiv |\\mathbf{F}|/(cE)$。使用我们推导的表达式：\n$$\nf = \\frac{F_x}{cE} = \\frac{\\frac{4}{3}\\gamma^2\\beta E'}{\\gamma^2 E' (1 + \\beta^2/3)} = \\frac{4\\beta/3}{1+\\beta^2/3} = \\frac{4\\beta}{3+\\beta^2}\n$$\n对于 $\\beta \\in [0, 1]$，$f$ 的物理范围是 $[0, 1]$。\n\n爱丁顿因子 $\\chi(f)$ 是平行于通量的压强与能量密度之比，即 $\\chi(f) = P_{\\parallel}/E = P_{xx}/E$。\n$$\n\\chi = \\frac{P_{xx}}{E} = \\frac{\\gamma^2 E'(\\beta^2 + 1/3)}{\\gamma^2 E' (1 + \\beta^2/3)} = \\frac{3\\beta^2+1}{3+\\beta^2}\n$$\n为了将 $\\chi$ 表示为 $f$ 的函数，我们消去 $\\beta$。从 $f$ 和 $\\chi$ 的表达式中，我们可以建立一个关系。令 $X=\\chi$。则 $\\beta^2 = (3X-1)/(3-X)$。将此代入 $f$ 的平方表达式中：\n$$\nf^2 = \\frac{16\\beta^2}{(3+\\beta^2)^2} = \\frac{16(3X-1)/(3-X)}{(3+(3X-1)/(3-X))^2} = \\frac{16(3X-1)(3-X)}{(9-3X+3X-1)^2} = \\frac{16(9X-3X^2-3+X)}{64} = \\frac{-3X^2+10X-3}{4}\n$$\n这给出了一个关于 $X=\\chi(f)$ 的二次方程：$3X^2 - 10X + (3+4f^2) = 0$。解出 $X$：\n$$\n\\chi(f) = \\frac{10 \\pm \\sqrt{100 - 12(3+4f^2)}}{6} = \\frac{10 \\pm \\sqrt{64 - 48f^2}}{6} = \\frac{5 \\pm 2\\sqrt{4 - 3f^2}}{3}\n$$\n为了选择正确的物理分支，我们考虑各向同性极限，即 $f \\to 0$，此时我们期望 $\\chi \\to 1/3$。负号分支得出 $\\chi(0) = (5 - 2\\sqrt{4})/3 = 1/3$，这是正确的。正号分支给出一个非物理的结果 $\\chi(0)=3$。因此，爱丁顿因子是：\n$$\n\\chi(f) = \\frac{5 - 2\\sqrt{4 - 3f^2}}{3}\n$$\n接下来，我们用 $E$、$\\chi(f)$ 和单位通量方向 $\\hat{\\mathbf{n}} = \\mathbf{F}/|\\mathbf{F}|$ 来表示压强张量 $\\mathsf{P}$。该张量必须具有形式 $P_{ij} = A\\delta_{ij} + B n_i n_j$。在与 $\\hat{\\mathbf{n}}$ 对齐的坐标系中，$P_{xx} = A+B$ 且 $P_{yy}=P_{zz}=A$。我们有两个条件：\n1.  $\\chi$ 的定义：$P_{\\parallel} = P_{xx} = \\chi E \\implies A+B = \\chi E$。\n2.  应力-能量张量的迹：迹 $T^\\alpha_\\alpha = E - \\text{tr}(\\mathsf{P})$ 是一个洛伦兹不变量。在静止参考系中，$T'^{\\alpha'}_{\\alpha'} = E' - (P'_{xx}+P'_{yy}+P'_{zz}) = E' - 3(E'/3) = 0$。因此，$E - \\text{tr}(\\mathsf{P}) = 0$，这意味着 $\\text{tr}(\\mathsf{P}) = P_{xx}+P_{yy}+P_{zz} = E$。\n\n使用这些条件：\n$(A+B) + A + A = E \\implies 3A+B=E$。\n我们解这个方程组：\n$3A+B=E$\n$A+B=\\chi E$\n第一个方程减去第二个方程得到 $2A = (1-\\chi)E \\implies A = \\frac{1-\\chi}{2}E$。\n将 $A$ 代回得到 $B = \\chi E - A = \\chi E - \\frac{1-\\chi}{2}E = \\frac{2\\chi-1+\\chi}{2}E = \\frac{3\\chi-1}{2}E$。\n因此，压强张量为：\n$$\n\\mathsf{P} = E \\left[ \\frac{1-\\chi(f)}{2} \\mathsf{I} + \\frac{3\\chi(f)-1}{2} \\hat{\\mathbf{n}} \\otimes \\hat{\\mathbf{n}} \\right]\n$$\n其中 $\\mathsf{I}$ 是单位张量，且 $(\\hat{\\mathbf{n}} \\otimes \\hat{\\mathbf{n}})_{ij} = n_i n_j$。\n\n**第二部分：数值计算**\n\n给定 $E=1$（任意单位），$|\\mathbf{F}|=0.6c$，且 $\\hat{\\mathbf{n}}=\\hat{\\mathbf{x}}=(1,0,0)$。\n\n首先，我们计算折合通量 $f$：\n$$\nf = \\frac{|\\mathbf{F}|}{cE} = \\frac{0.6c}{c(1)} = 0.6\n$$\n\n接下来，我们为 $f=0.6$ 计算爱丁顿因子 $\\chi(f)$：\n$$\n\\chi(0.6) = \\frac{5 - 2\\sqrt{4 - 3(0.6)^2}}{3} = \\frac{5 - 2\\sqrt{4 - 3(0.36)}}{3} = \\frac{5 - 2\\sqrt{4 - 1.08}}{3} = \\frac{5 - 2\\sqrt{2.92}}{3}\n$$\n$$\n\\chi(0.6) \\approx \\frac{5 - 2(1.7088007)}{3} = \\frac{5 - 3.4176014}{3} = \\frac{1.5823986}{3} \\approx 0.5274662\n$$\n四舍五入到四位有效数字，$\\chi(0.6) = 0.5275$。\n\n现在我们计算压强张量 $\\mathsf{P}$ 的非零分量。当 $\\hat{\\mathbf{n}}=\\hat{\\mathbf{x}}$ 时，分量为：\n$P_{xx} = P_{\\parallel} = \\chi E = (0.5274662)(1) = 0.5274662$。\n$P_{yy} = P_{zz} = P_{\\perp} = \\frac{1-\\chi}{2} E = \\frac{1-0.5274662}{2}(1) = \\frac{0.4725338}{2} = 0.2362669$。\n非对角分量为零。\n\n四舍五入到四位有效数字：\n$P_{xx} = 0.5275$\n$P_{yy} = 0.2363$\n$P_{zz} = 0.2363$\n\n有序四元组 $(\\chi(f), P_{xx}, P_{yy}, P_{zz})$ 是 $(0.5275, 0.5275, 0.2363, 0.2363)$。\n\n**第三部分：与扩散极限的比较**\n\n扩散近似在近似各向同性的辐射场极限下有效，即 $f \\ll 1$。在此极限下，$\\chi \\to 1/3$。扩散近似中的压强张量是各向同性的：\n$$\n\\mathsf{P}_{\\text{diff}} = \\frac{1}{3} E \\mathsf{I}\n$$\n对于 $E=1$，这得到 $P_{xx} = P_{yy} = P_{zz} = 1/3 \\approx 0.3333$。\n\n比较我们计算的张量 $\\mathsf{P}_{\\text{M1}}$ 与 $\\mathsf{P}_{\\text{diff}}$：\n- **各向异性：** $\\mathsf{P}_{\\text{M1}}$ 是强各向异性的，而 $\\mathsf{P}_{\\text{diff}}$ 是各向同性的。M1闭合正确地反映了净辐射通量（$f=0.6$ 不小）意味着一个各向异性的压强场。\n- **压强分量：** 在 M1 模型中，平行于通量的压强分量显著增强（$P_{xx} \\approx 0.5275$ 对比 $0.3333$），而垂直分量则被抑制（$P_{yy}=P_{zz} \\approx 0.2363$ 对比 $0.3333$）。这在物理上是直观的：辐射流携带的动量增加了流动方向上的压强。\n- **有效性：** $f=0.6$ 的状态远离扩散区域。在这种“半透明”或“流出”条件下，M1闭合比简单的扩散近似能更好地物理描述辐射压强张量，而扩散近似会在辐射与物质的动力学耦合中产生巨大误差。M1闭合正确地在扩散极限（$f=0$, $\\chi=1/3$）和自由流出极限（$f=1$, $\\chi=1$）之间进行插值。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.5275  0.5275  0.2363  0.2363\n\\end{pmatrix}\n}\n$$", "id": "3522603"}, {"introduction": "尽管 $M1$ 闭合功能强大，但理解其局限性至关重要，这些局限性源于辐射角分布信息的丢失。本实践将探讨经典的“交叉束流测试”，这是一个 $M1$ 模型会产生被称为“人工束流合并”的非物理结果的场景 [@problem_id:3522552]。通过分析叠加后的辐射矩，您将精确地看到 $M1$ 闭合为何以及如何无法正确表示一个多向辐射场，而是将其误解为一个更宽的单向辐射束。", "problem": "为辐射转移中的一阶矩方法 (M$1$) 闭合构建一个严谨且自洽的二维交叉束测试。考虑一个理想化情景，其中两个无限窄、无碰撞的辐射束在平面内的自由空间中传播。设比强度表示为 $I(\\hat{\\boldsymbol{n}})$，其中 $\\hat{\\boldsymbol{n}}$ 是一个单位方向。使用辐射能量密度 $E$ 和辐射通量矢量 $\\boldsymbol{F}$ 的基本定义，它们由 $I(\\hat{\\boldsymbol{n}})$ 的角矩得出：\n- $E = \\dfrac{1}{c} \\int I(\\hat{\\boldsymbol{n}})\\, \\mathrm{d}\\Omega$，\n- $\\boldsymbol{F} = \\int \\hat{\\boldsymbol{n}}\\, I(\\hat{\\boldsymbol{n}})\\, \\mathrm{d}\\Omega$，\n\n其中 $c$ 是光速，$\\mathrm{d}\\Omega$ 是微分立体角。在 M$1$ 闭合中，单参数各向异性由约化通量捕捉：\n$$\nf \\equiv \\dfrac{\\lVert \\boldsymbol{F} \\rVert}{c\\, E}.\n$$\n在交叉束测试中，强度为 $I_1$ 和 $I_2$ 的两束射束以方向 $\\hat{\\boldsymbol{n}}_1$ 和 $\\hat{\\boldsymbol{n}}_2$ 在一点相交。假设两束射束都是完美准直的（角度上为狄拉克δ函数）、无相互作用且稳态的，因此交点处的辐射场是两束射束的叠加。不失一般性地，定义 $\\hat{\\boldsymbol{n}}_1$ 沿 $x$ 轴方向，$\\hat{\\boldsymbol{n}}_2$ 在平面内相对于 $\\hat{\\boldsymbol{n}}_1$ 逆时针旋转一个角度 $\\theta$（以弧度为单位）。仅使用这些基本定义，推导在交点处 $f$ 关于 $I_1$、$I_2$ 和 $\\theta$ 的显式表达式。\n\n任务：\n1. 从第一性原理（仅使用上述定义）推导在交点处两束射束叠加场的约化通量 $f$ 的公式，该公式由 $I_1$、$I_2$ 和射束间夹角 $\\theta$（以弧度为单位）参数化。以没有剩余积分的闭合形式表示结果。\n2. 将您的结果应用于两个等强度射束成直角相交的情况（$I_1 = I_2$，$\\theta = \\pi/2$），并获得在交点处预测的 M$1$ 解 $f$。基于矩描述，解释为什么 M$1$ 闭合在这种配置下表现出人为的射束合并现象，并指出 M$1$ 模型在交点处推断出的单一传播方向。\n3. 实现一个程序，为以下测试套件评估您得到的 $f$ 的通用公式。角度必须以弧度解释，强度是无量纲的非负标量。如果 $I_1 + I_2 = 0$，则对于此退化边界情况，定义 $f = 0$。\n   - 测试 1：$(I_1, I_2, \\theta) = (1.0, 1.0, \\pi/2)$。\n   - 测试 2：$(I_1, I_2, \\theta) = (1.0, 1.0, 0)$。\n   - 测试 3：$(I_1, I_2, \\theta) = (1.0, 1.0, \\pi)$。\n   - 测试 4：$(I_1, I_2, \\theta) = (1.0, 0.5, \\pi/2)$。\n   - 测试 5：$(I_1, I_2, \\theta) = (1.0, 0.1, \\pi/2)$。\n   - 测试 6：$(I_1, I_2, \\theta) = (1.0, 0.9, \\pi)$。\n   - 测试 7：$(I_1, I_2, \\theta) = (1.0, 0.0, \\pi/3)$。\n   - 测试 8：$(I_1, I_2, \\theta) = (0.0, 0.0, \\pi/3)$。\n\n输出要求：\n- 计算每个测试用例的约化通量 $f$。\n- 将每个 $f$ 四舍五入到 $9$ 位小数进行报告。\n- 您的程序应生成单行输出，包含以逗号分隔并用方括号括起来的结果（例如，“[0.123000000,0.456000000]”）。\n\n注意：角度必须以弧度为单位。$f$ 是无量纲的，无需报告物理单位。", "solution": "该问题陈述已经过验证，被认为是具有科学依据、问题明确且客观的。它为基于矩的辐射转移方法提供了一个标准的理论测试。所有必要的定义、变量和条件都已提供，可以得出一个严谨且唯一的解。该问题不违反任何物理学或数学原理，并且没有歧义或矛盾。\n\n解答分两部分进行。首先，根据问题陈述中给出的第一性原理，推导出约化通量 $f$ 的通用闭合形式表达式。其次，将此公式应用于两个等强度射束成直角相交的特定情况，以分析一阶矩 (M$1$) 闭合的行为。\n\n**1. 约化通量 $f$ 的通用公式推导**\n\n该问题描述了两个完美准直、无相互作用的辐射束在一点相交。组合辐射场的比强度 $I(\\hat{\\boldsymbol{n}})$ 可以建模为两个角度上的狄拉克δ函数的叠加，代表两个无限窄的射束。总比强度为：\n$$\nI(\\hat{\\boldsymbol{n}}) = I_1 \\delta^{(2)}(\\hat{\\boldsymbol{n}} - \\hat{\\boldsymbol{n}}_1) + I_2 \\delta^{(2)}(\\hat{\\boldsymbol{n}} - \\hat{\\boldsymbol{n}}_2)\n$$\n其中 $I_1$ 和 $I_2$ 分别是传播方向由单位矢量 $\\hat{\\boldsymbol{n}}_1$ 和 $\\hat{\\boldsymbol{n}}_2$ 给出的射束的强度。函数 $\\delta^{(2)}$ 是定义在单位球面上的狄拉克δ函数，具有筛选性质 $\\int f(\\hat{\\boldsymbol{n}}) \\delta^{(2)}(\\hat{\\boldsymbol{n}} - \\hat{\\boldsymbol{n}}_0) \\mathrm{d}\\Omega = f(\\hat{\\boldsymbol{n}}_0)$。\n\n问题设置在二维平面上。我们将方向矢量定义为：\n- $\\hat{\\boldsymbol{n}}_1$：沿 $x$ 轴，因此 $\\hat{\\boldsymbol{n}}_1 = (1, 0)^T$。\n- $\\hat{\\boldsymbol{n}}_2$：从 $\\hat{\\boldsymbol{n}}_1$ 逆时针旋转角度 $\\theta$，因此 $\\hat{\\boldsymbol{n}}_2 = (\\cos\\theta, \\sin\\theta)^T$。\n\n首先，我们使用其定义计算辐射场的零阶矩，即辐射能量密度 $E$：\n$$\nE = \\frac{1}{c} \\int I(\\hat{\\boldsymbol{n}}) \\, \\mathrm{d}\\Omega = \\frac{1}{c} \\int \\left( I_1 \\delta^{(2)}(\\hat{\\boldsymbol{n}} - \\hat{\\boldsymbol{n}}_1) + I_2 \\delta^{(2)}(\\hat{\\boldsymbol{n}} - \\hat{\\boldsymbol{n}}_2) \\right) \\mathrm{d}\\Omega\n$$\n应用狄拉克δ函数的筛选性质，我们得到：\n$$\nE = \\frac{1}{c} (I_1 \\cdot 1 + I_2 \\cdot 1) = \\frac{I_1 + I_2}{c}\n$$\n\n接下来，我们计算一阶矩，即辐射通量矢量 $\\boldsymbol{F}$：\n$$\n\\boldsymbol{F} = \\int \\hat{\\boldsymbol{n}} I(\\hat{\\boldsymbol{n}}) \\, \\mathrm{d}\\Omega = \\int \\hat{\\boldsymbol{n}} \\left( I_1 \\delta^{(2)}(\\hat{\\boldsymbol{n}} - \\hat{\\boldsymbol{n}}_1) + I_2 \\delta^{(2)}(\\hat{\\boldsymbol{n}} - \\hat{\\boldsymbol{n}}_2) \\right) \\mathrm{d}\\Omega\n$$\n再次使用筛选性质，积分得到各个射束通量的矢量和：\n$$\n\\boldsymbol{F} = I_1 \\hat{\\boldsymbol{n}}_1 + I_2 \\hat{\\boldsymbol{n}}_2\n$$\n代入方向矢量的分量：\n$$\n\\boldsymbol{F} = I_1 \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} + I_2 \\begin{pmatrix} \\cos\\theta \\\\ \\sin\\theta \\end{pmatrix} = \\begin{pmatrix} I_1 + I_2 \\cos\\theta \\\\ I_2 \\sin\\theta \\end{pmatrix}\n$$\n为了求出约化通量 $f$，我们需要通量矢量的大小 $\\lVert \\boldsymbol{F} \\rVert$：\n$$\n\\lVert \\boldsymbol{F} \\rVert = \\sqrt{(I_1 + I_2 \\cos\\theta)^2 + (I_2 \\sin\\theta)^2}\n$$\n$$\n\\lVert \\boldsymbol{F} \\rVert = \\sqrt{I_1^2 + 2 I_1 I_2 \\cos\\theta + I_2^2 \\cos^2\\theta + I_2^2 \\sin^2\\theta}\n$$\n使用三角恒等式 $\\cos^2\\theta + \\sin^2\\theta = 1$：\n$$\n\\lVert \\boldsymbol{F} \\rVert = \\sqrt{I_1^2 + I_2^2 + 2 I_1 I_2 \\cos\\theta}\n$$\n最后，我们将 $\\lVert \\boldsymbol{F} \\rVert$ 和 $E$ 的表达式代入约化通量 $f$ 的定义中：\n$$\nf \\equiv \\frac{\\lVert \\boldsymbol{F} \\rVert}{c E} = \\frac{\\sqrt{I_1^2 + I_2^2 + 2 I_1 I_2 \\cos\\theta}}{c \\left( \\frac{I_1 + I_2}{c} \\right)}\n$$\n这简化为最终的闭合形式表达式：\n$$\nf(I_1, I_2, \\theta) = \\frac{\\sqrt{I_1^2 + I_2^2 + 2 I_1 I_2 \\cos\\theta}}{I_1 + I_2}\n$$\n对于 $I_1 + I_2 = 0$ 的情况，由于强度非负，这意味着 $I_1=0$ 和 $I_2=0$，该公式将导致不定形式 $0/0$。按照规定，在这种退化情况下我们定义 $f=0$，这在物理上是一致的，因为没有辐射。\n\n**2. 等强度、直角情况的分析**\n\n我们现在分析 $I_1 = I_2 = I_0$ 且射束以直角 $\\theta = \\pi/2$ 相交的特殊情况。将这些值代入我们的 $f$ 通用公式：\n$$\nf = \\frac{\\sqrt{I_0^2 + I_0^2 + 2 I_0 I_0 \\cos(\\pi/2)}}{I_0 + I_0} = \\frac{\\sqrt{2 I_0^2 + 0}}{2 I_0} = \\frac{\\sqrt{2} I_0}{2 I_0} = \\frac{\\sqrt{2}}{2}\n$$\n所以，对于两个等强度射束以 $90^\\circ$ 交叉，M$1$ 模型预测的约化通量为 $f = \\sqrt{2}/2 \\approx 0.7071$。\n\n在这种配置下，M$1$ 闭合模型表现出人为的射束合并现象。其根本原因是矩方法固有的信息损失。真实的辐射场是双峰的，具有两个不同的传播方向 $\\hat{\\boldsymbol{n}}_1$ 和 $\\hat{\\boldsymbol{n}}_2$。然而，M$1$ 模型仅使用前两个矩构建：总能量密度 $E$ 和净通量矢量 $\\boldsymbol{F}$。任何能产生相同 $E$ 和 $\\boldsymbol{F}$ 的角分布集合对于该模型来说都是不可区分的。\n\n对于 $I_1=I_2=I_0$ 和 $\\theta=\\pi/2$ 的情况：\n- 能量密度为 $E = (I_0 + I_0)/c = 2I_0/c$。\n- 净通量矢量为 $\\boldsymbol{F} = I_0 \\hat{\\boldsymbol{n}}_1 + I_0 \\hat{\\boldsymbol{n}}_2 = I_0 (1, 0)^T + I_0 (0, 1)^T = I_0(1, 1)^T$。\n\nM$1$ 闭合方案重构一个与这两个矩相匹配的等效辐射场。这个重构的场本质上是单峰的，并假设其关于净通量矢量 $\\boldsymbol{F}$ 的方向对称。因此，该模型错误地将两个不同的交叉射束解释为在它们通量的矢量和方向上传播的一个稍宽的单一射束。这种现象被称为人为射束合并。关于角强度分布双峰性质的信息丢失了。\n\nM$1$ 模型推断出的单一传播方向是净通量矢量 $\\boldsymbol{F} = I_0(1, 1)^T$ 的方向。此方向上的单位矢量是 $\\frac{(1, 1)^T}{\\sqrt{1^2+1^2}} = (\\frac{1}{\\sqrt{2}}, \\frac{1}{\\sqrt{2}})^T$，这对应于从 $x$ 轴逆时针旋转 $\\pi/4$ 弧度（$45^\\circ$）的角度。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the reduced flux 'f' for several crossing-beam test cases\n    based on the M1 closure model for radiative transfer.\n    \"\"\"\n\n    # The formula for the reduced flux f is derived as:\n    # f = sqrt(I1^2 + I2^2 + 2*I1*I2*cos(theta)) / (I1 + I2)\n\n    # Define the test cases from the problem statement.\n    # Each tuple is (I1, I2, theta_in_radians).\n    test_cases = [\n        (1.0, 1.0, np.pi / 2),\n        (1.0, 1.0, 0.0),\n        (1.0, 1.0, np.pi),\n        (1.0, 0.5, np.pi / 2),\n        (1.0, 0.1, np.pi / 2),\n        (1.0, 0.9, np.pi),\n        (1.0, 0.0, np.pi / 3),\n        (0.0, 0.0, np.pi / 3),\n    ]\n\n    results = []\n    for case in test_cases:\n        I1, I2, theta = case\n        \n        # Handle the degenerate edge case where total intensity is zero.\n        if I1 + I2 == 0:\n            f = 0.0\n        else:\n            # Numerator is the magnitude of the total flux vector.\n            numerator = np.sqrt(I1**2 + I2**2 + 2 * I1 * I2 * np.cos(theta))\n            \n            # Denominator is proportional to the total radiation energy density.\n            denominator = I1 + I2\n            \n            f = numerator / denominator\n        \n        # Format the result to 9 decimal places as a string.\n        results.append(f\"{f:.9f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "3522552"}, {"introduction": "连接理论与实践的最后一步是在计算机上求解 $M1$ 矩方程组。本练习要求您设计一个现代辐射流体力学程序的核心组件：一维 $M1$ 系统的一个有限体积数值通量 [@problem_id:3522592]。您将实现一个鲁棒的 Harten-Lax-van Leer-Einfeldt (HLLE) 近似黎曼求解器，学习如何处理方程组的双曲性质，并通过正确设定特征波速的界限来保证物理因果律。", "problem": "要求您为采用最大熵（M1）闭合的双矩辐射输运系统设计并实现一个一维有限体积（Finite Volume, FV）离散化方案。该系统在空间坐标 $x$ 和时间 $t$ 上演化辐射能量密度 $E$ 和辐射通量 $F$ ，其中光速 $c$ 以及源项 $S_E$ 和 $S_{F,x}$ 已给定。包含源项的控制双曲系统为\n$$\n\\partial_t \\begin{pmatrix} E \\\\ F \\end{pmatrix}\n+ \\partial_x \\begin{pmatrix} F \\\\ c^2 P_{xx} \\end{pmatrix}\n= \\begin{pmatrix} c S_E \\\\ S_{F,x} \\end{pmatrix}.\n$$\n沿 $x$ 方向缩并的辐射压力张量为 $P_{xx}$，这需要一个闭合关系。在 M1 闭合中，引入了约化通量 $f$ 和由 $f$ 的函数关系定义的爱丁顿因子 $\\chi$。在一维情况下，该闭合简化为 $P_{xx}=\\chi E$，其中方向性与 $F$ 的符号一致。约化通量定义为 $f=\\lvert F \\rvert/(c E)$，根据因果性满足 $0 \\le f \\le 1$，且 $\\chi$ 必须满足 $\\chi(0)=1/3$（各向同性扩散极限）和 $\\chi(1)=1$（自由流动极限）。该系统必须在尺寸为 $\\Delta x$ 的均匀网格和时间增量为 $\\Delta t$ 的条件下进行离散化，并通过近似黎曼求解器（Approximate Riemann Solver, ARS）在网格单元交界面上构造数值通量。您的离散化方案必须保证特征信号速度不超过光速 $c$。\n\n您必须从“辐射矩的传播速度以 $c$ 为界”以及“控制系统是具有两个特征场的双曲系统”这两个基本原则出发，推导一个与这些界限一致的 ARS，并实现它以计算交界面通量。一个合适的选择是将左右信号速度限制为 $s_L=-c$ 和 $s_R=+c$，从而产生一个两波 Harten–Lax–van Leer–Einfeldt (HLLE) 通量。根据状态向量 $\\mathbf{Q}=(E,F)^\\top$ 和由 $(E,F)$ 计算出的闭合关系 $P_{xx}=\\chi E$，物理通量向量为 $\\mathcal{F}(\\mathbf{Q})=(F,\\,c^2 P_{xx})^\\top$。您的程序必须为交界面上给定的左右状态 $(E_L,F_L)$ 和 $(E_R,F_R)$ 计算该交界面上的 HLLE 数值通量向量 $\\hat{\\mathcal{F}}_{i+1/2}$。\n\n您必须从第一性原理出发：\n- 从辐射输运中的矩定义开始，其中 $E$ 和 $F$ 是比辐射强度的零阶和一阶角矩，$P$ 是二阶矩。\n- 强制执行因果性约束 $0 \\le f \\le 1$，并推导与最大熵原理一致的 M1 爱丁顿因子 $\\chi(f)$，使其能够恢复极限值 $\\chi(0)=1/3$ 和 $\\chi(1)=1$。\n- 论证一个 ARS 的合理性，其信号速度 $s_L$ 和 $s_R$ 将所有特征线界定在 $\\pm c$ 范围内，并用它根据左右物理通量和状态构造一个自洽的数值通量。\n- 说明如何从 $(E,F)$ 和闭合关系计算 $P_{xx}$，以及 $\\hat{\\mathcal{F}}$ 如何通过 $\\chi(f)$ 依赖于 $(E,F)$。\n\n所有计算必须使用国际单位制（SI）进行。您必须使用 $c=2.99792458\\times 10^{8}$ $\\mathrm{m/s}$，其中 $E$ 的单位为 $\\mathrm{J/m^3}$，$F$ 的单位为 $\\mathrm{J/(m^2\\,s)}$，$P_{xx}$ 的单位为 $\\mathrm{J/m^3}$，通量的第二个分量 $c^2 P_{xx}$ 的单位为 $\\mathrm{J/(m\\,s^2)}$。在此一维问题中不出现角度。不得使用百分比。\n\n测试套件：\n为以下四组左右状态计算 HLLE 数值通量，每组以 $(E_L,F_L,E_R,F_R)$ 的形式提供：\n- 情况1（各向同性极限）：$(E_L,F_L,E_R,F_R)=(1.0,\\,0.0,\\,1.0,\\,0.0)$。\n- 情况2（向右自由流动）：$(E_L,F_L,E_R,F_R)=(1.0,\\,c,\\,0.5,\\,0.5c)$。\n- 情况3（等能量逆向流动）：$(E_L,F_L,E_R,F_R)=(1.0,\\,0.5c,\\,1.0,\\,-0.5c)$。\n- 情况4（近似真空能量伴随单向通量）：$(E_L,F_L,E_R,F_R)=(10^{-12},\\,0.0,\\,10^{-12},\\,c\\times 10^{-12})$。\n\n对于每种情况，计算 HLLE 数值通量向量 $\\hat{\\mathcal{F}}$ 的两个分量：\n- 第一个分量是能量通量，单位为 $\\mathrm{J/(m^2\\,s)}$。\n- 第二个分量是 $c^2 P_{xx}$，单位为 $\\mathrm{J/(m\\,s^2)}$。\n\n最终输出格式：\n您的程序应生成单行输出，包含一个由 8 个浮点数组成的逗号分隔列表，顺序为 $[\\hat{\\mathcal{F}}^{(1)}_1,\\hat{\\mathcal{F}}^{(2)}_1,\\hat{\\mathcal{F}}^{(1)}_2,\\hat{\\mathcal{F}}^{(2)}_2,\\hat{\\mathcal{F}}^{(1)}_3,\\hat{\\mathcal{F}}^{(2)}_3,\\hat{\\mathcal{F}}^{(1)}_4,\\hat{\\mathcal{F}}^{(2)}_4]$，其中上标表示通量分量，下标表示情况。例如，输出必须形如 $[x_1,y_1,x_2,y_2,x_3,y_3,x_4,y_4]$，不含空格，其中每个 $x_k$ 和 $y_k$ 是一个使用 SI 单位的浮点数。程序必须完全独立，且不得读取任何输入。", "solution": "问题陈述已经过验证，并被认为是有效的。它在科学上基于已建立的辐射输运理论和矩方法，特别是 M1 闭合。该问题是适定的、客观的且自洽的，提供了计算唯一且有意义的数值结果所需的所有必要定义、常数和数据。指定的单位和数值是一致的。\n\n任务是使用最大熵（M1）闭合模型，为一维双矩辐射输运方程实现一个有限体积数值通量。该数值通量将使用 Harten–Lax–van Leer–Einfeldt (HLLE) 近似黎曼求解器进行计算。\n\n控制方程组演化辐射能量密度 $E$ 和辐射通量 $F$：\n$$\n\\partial_t \\begin{pmatrix} E \\\\ F \\end{pmatrix}\n+ \\partial_x \\begin{pmatrix} F \\\\ c^2 P_{xx} \\end{pmatrix}\n= \\mathbf{S}\n$$\n其中 $\\mathbf{S}$ 是一个源向量，它不影响网格单元交界面上数值通量的计算。状态向量为 $\\mathbf{Q} = (E, F)^\\top$，物理通量向量为 $\\mathcal{F}(\\mathbf{Q}) = (F, c^2 P_{xx})^\\top$。光速为 $c$。\n\n为了求解这个双曲系统，我们首先需要定义闭合关系，用演化矩 $E$ 和 $F$ 来表示二阶矩，即辐射压力 $P_{xx}$。\n\n**辐射矩与 M1 闭合关系**\n\n辐射场的矩由比辐射强度 $I$ 的角积分定义。在一维情况下，通过与x轴夹角的余弦 $\\mu \\in [-1, 1]$ 来参数化方向，前三个矩为：\n- 零阶矩（辐射能量密度）：$E = \\frac{2\\pi}{c} \\int_{-1}^{1} I(\\mu) d\\mu$\n- 一阶矩（辐射通量）：$F_x \\equiv F = 2\\pi \\int_{-1}^{1} \\mu I(\\mu) d\\mu$\n- 二阶矩（辐射压力）：$P_{xx} = \\frac{2\\pi}{c} \\int_{-1}^{1} \\mu^2 I(\\mu) d\\mu$\n\n通过定义 $P_{xx}$ 与演化变量 $E$ 和 $F$ 之间的关系来闭合该系统。M1 闭合模型通过假设比辐射强度 $I$ 是在能够再现给定 $E$ 和 $F$ 的约束条件下使辐射熵最大化的那一个来实现此目的。这个过程导出了爱丁顿因子 $\\chi = P_{xx}/E$ 和约化通量 $f = |F|/(cE)$ 之间的唯一函数关系。约化通量受到因果性的物理约束，$0 \\le f \\le 1$。爱丁顿因子必须满足已知的物理极限：各向同性扩散极限 $\\chi(0) = 1/3$ 和自由流动极限 $\\chi(1) = 1$。\n\n对于三维各向同性系统的最大熵推导结果（在一维代码中常用），给出了爱丁顿因子的以下表达式：\n$$\n\\chi(f) = \\frac{3 + 4f^2}{5 + 2\\sqrt{4 - 3f^2}}\n$$\n这个函数正确地再现了所需的极限。我们将使用这个函数从状态 $(E, F)$ 计算 $P_{xx} = \\chi(f) E$。\n\n**HLLE 近似黎曼求解器**\n\n对于有限体积法，我们需要在两个状态分别为 $\\mathbf{Q}_L$ 和 $\\mathbf{Q}_R$ 的网格单元 $i$ 和 $i+1$ 之间的交界面上，计算一个数值通量 $\\hat{\\mathcal{F}}_{i+1/2}$。HLLE 近似黎曼求解器基于对从该交界面出现的最小（$s_L$）和最大（$s_R$）特征信号速度的估计来提供这样一个通量。HLLE 通量的通用公式为：\n$$\n\\hat{\\mathcal{F}}_{\\text{HLLE}} = \\frac{s_R \\mathcal{F}(\\mathbf{Q}_L) - s_L \\mathcal{F}(\\mathbf{Q}_R) + s_L s_R (\\mathbf{Q}_R - \\mathbf{Q}_L)}{s_R - s_L}\n$$\n辐射矩方程的特征速度从根本上受限于光速 $c$。因此，如问题中所述，对信号速度估计的一个简单而稳健的选择是取最耗散的界限：$s_L = -c$ 和 $s_R = +c$。这被称为 HLLE-C 通量。\n\n将这些速度代入通用公式，我们得到：\n$$\n\\hat{\\mathcal{F}} = \\frac{c \\mathcal{F}_L - (-c) \\mathcal{F}_R + (-c)(c) (\\mathbf{Q}_R - \\mathbf{Q}_L)}{c - (-c)} = \\frac{c(\\mathcal{F}_L + \\mathcal{F}_R) - c^2(\\mathbf{Q}_R - \\mathbf{Q}_L)}{2c}\n$$\n这可简化为：\n$$\n\\hat{\\mathcal{F}} = \\frac{1}{2}(\\mathcal{F}_L + \\mathcal{F}_R) - \\frac{c}{2}(\\mathbf{Q}_R - \\mathbf{Q}_L)\n$$\n\n**计算算法**\n\n为了计算给定左状态 $\\mathbf{Q}_L = (E_L, F_L)^\\top$ 和右状态 $\\mathbf{Q}_R = (E_R, F_R)^\\top$ 的 HLLE 数值通量 $\\hat{\\mathcal{F}} = (\\hat{\\mathcal{F}}^{(1)}, \\hat{\\mathcal{F}}^{(2)})^\\top$，我们执行以下步骤：\n\n1.  **读取输入**：输入为左状态 $(E_L, F_L)$ 和右状态 $(E_R, F_R)$，以及常数 $c = 2.99792458 \\times 10^8 \\, \\mathrm{m/s}$。\n\n2.  **计算约化通量**：计算左右状态的约化通量。为确保在 $E$ 非常小的情况下的数值稳定性，我们强制规定如果 $E=0$ 则 $F=0$ 并且我们定义 $f=0$。对于 $E>0$：\n    $$ f_L = \\frac{|F_L|}{c E_L}, \\quad f_R = \\frac{|F_R|}{c E_R} $$\n\n3.  **计算爱丁顿因子**：使用 M1 闭合公式，计算每个状态的爱丁顿因子：\n    $$ \\chi_L = \\chi(f_L) = \\frac{3 + 4f_L^2}{5 + 2\\sqrt{4 - 3f_L^2}}, \\quad \\chi_R = \\chi(f_R) = \\frac{3 + 4f_R^2}{5 + 2\\sqrt{4 - 3f_R^2}} $$\n\n4.  **计算物理通量**：构造物理通量向量 $\\mathcal{F}_L$ 和 $\\mathcal{F}_R$：\n    $$ P_{xx, L} = \\chi_L E_L, \\quad P_{xx, R} = \\chi_R E_R $$\n    $$ \\mathcal{F}_L = \\begin{pmatrix} F_L \\\\ c^2 P_{xx, L} \\end{pmatrix}, \\quad \\mathcal{F}_R = \\begin{pmatrix} F_R \\\\ c^2 P_{xx, R} \\end{pmatrix} $$\n\n5.  **计算 HLLE 通量分量**：逐分量应用简化的 HLLE 公式。\n    - 第一个分量（数值能量通量）：\n      $$ \\hat{\\mathcal{F}}^{(1)} = \\frac{1}{2}(F_L + F_R) - \\frac{c}{2}(E_R - E_L) $$\n    - 第二个分量（数值动量通量，使用 $P_{xx}$ 的定义）：\n      $$ \\hat{\\mathcal{F}}^{(2)} = \\frac{1}{2}(c^2 P_{xx, L} + c^2 P_{xx, R}) - \\frac{c}{2}(F_R - F_L) = \\frac{c^2}{2}(\\chi_L E_L + \\chi_R E_R) - \\frac{c}{2}(F_R - F_L) $$\n\n该算法提供了交界面上数值通量向量的两个分量，可用于有限体积格式中，在一个时间步长 $\\Delta t$ 内更新 $E$ 和 $F$ 的单元平均值。我们现在将此算法应用于给定的测试套件。例如，对于情况3，$(E_L,F_L,E_R,F_R)=(1.0,\\,0.5c,\\,1.0,\\,-0.5c)$：\n$f_L = |0.5c|/(c \\cdot 1.0) = 0.5$。 $f_R = |-0.5c|/(c \\cdot 1.0) = 0.5$。\n$\\chi_L = \\chi_R = \\chi(0.5) = (3 + 4(0.5^2))/(5 + 2\\sqrt{4 - 3(0.5^2)}) = 4/(5+2\\sqrt{3.25}) \\approx 0.464828$。\n$\\hat{\\mathcal{F}}^{(1)} = \\frac{1}{2}(0.5c - 0.5c) - \\frac{c}{2}(1.0 - 1.0) = 0$。\n$P_{xx,L} = \\chi(0.5) \\cdot 1.0$, $P_{xx,R} = \\chi(0.5) \\cdot 1.0$。\n$\\hat{\\mathcal{F}}^{(2)} = \\frac{c^2}{2}(P_{xx,L} + P_{xx,R}) - \\frac{c}{2}(F_R - F_L) = c^2 \\chi(0.5) - \\frac{c}{2}(-0.5c - 0.5c) = c^2(\\chi(0.5) + 0.5)$。\n以下程序为所有测试用例实现了此过程。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the HLLE numerical flux for the 1D M1 radiation transport system\n    for a given set of test cases.\n    \"\"\"\n    # Define physical constants\n    c = 2.99792458e8  # Speed of light in m/s\n\n    # Define the test cases as a list of tuples: (E_L, F_L, E_R, F_R)\n    test_cases = [\n        # Case 1: Isotropic limit\n        (1.0, 0.0, 1.0, 0.0),\n        # Case 2: Free-streaming to the right\n        (1.0, c, 0.5, 0.5 * c),\n        # Case 3: Counter-streaming of equal energy\n        (1.0, 0.5 * c, 1.0, -0.5 * c),\n        # Case 4: Nearly vacuum energy with one-sided flux\n        (1e-12, 0.0, 1e-12, c * 1e-12),\n    ]\n\n    results = []\n\n    def get_reduced_flux(E, F, c_val):\n        \"\"\"Calculates the reduced flux f = |F|/(cE).\"\"\"\n        # A robust implementation would handle E -> 0.\n        if E == 0:\n            return 0.0\n        f = abs(F) / (c_val * E)\n        # Clamp to 1.0 to handle potential floating point inaccuracies\n        return min(f, 1.0)\n\n\n    def get_eddington_factor(f):\n        \"\"\"Calculates the M1 Eddington factor chi(f).\"\"\"\n        # The argument of the square root is 4 - 3f^2.\n        # Causality ensures |F| = cE, so f = 1.\n        # Since 0 = f = 1, this is always >= 1.\n        numerator = 3.0 + 4.0 * f**2\n        denominator = 5.0 + 2.0 * np.sqrt(4.0 - 3.0 * f**2)\n        return numerator / denominator\n\n    for case in test_cases:\n        E_L, F_L, E_R, F_R = case\n        \n        # --- Left State ---\n        f_L = get_reduced_flux(E_L, F_L, c)\n        chi_L = get_eddington_factor(f_L)\n        Pxx_L = chi_L * E_L\n        \n        # --- Right State ---\n        f_R = get_reduced_flux(E_R, F_R, c)\n        chi_R = get_eddington_factor(f_R)\n        Pxx_R = chi_R * E_R\n\n        # --- Physical Fluxes ---\n        # F_flux_L = F_L is just the variable itself\n        # F_flux_R = F_R is just the variable itself\n        P_flux_L = c**2 * Pxx_L\n        P_flux_R = c**2 * Pxx_R\n        \n        # --- HLLE Numerical Flux (with s_L = -c, s_R = +c) ---\n        # Formula: flux_hat = 0.5*(flux_L + flux_R) - 0.5*c*(Q_R - Q_L)\n        \n        # Component 1: Energy flux\n        flux1 = 0.5 * (F_L + F_R) - 0.5 * c * (E_R - E_L)\n        \n        # Component 2: Momentum flux\n        flux2 = 0.5 * (P_flux_L + P_flux_R) - 0.5 * c * (F_R - F_L)\n\n        results.extend([flux1, flux2])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3522592"}]}