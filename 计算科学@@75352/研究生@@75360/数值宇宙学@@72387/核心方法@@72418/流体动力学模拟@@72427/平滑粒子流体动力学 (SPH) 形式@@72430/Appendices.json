{"hands_on_practices": [{"introduction": "平滑核是平滑粒子流体动力学（SPH）方法的核心。为了使SPH表示成为一种真正能守恒质量的插值，核函数必须归一化，即其在整个空间上的积分必须为一。本练习 [@problem_id:3534761] 将指导您在任意维度下推导归一化常数的一般表达式，从而巩固您对SPH数学基础的理解。", "problem": "在光滑粒子流体动力学（Smoothed Particle Hydrodynamics, SPH）中，光滑核必须被归一化，以使其在$\\nu$维欧几里得空间中质量守恒。考虑一个球对称核，其形式为$W(r,h) = \\sigma_{\\nu}\\, h^{-\\nu}\\, f(r/h)$，具有紧支集$0 \\le r  \\kappa h$，其中$\\kappa > 0$是一个有限的支撑参数，$h > 0$是光滑长度，$f:[0,\\kappa) \\to \\mathbb{R}_{\\ge 0}$是一个无量纲的形状函数，满足当$q \\ge \\kappa$时$f(q) = 0$。施加归一化要求$\\int_{\\mathbb{R}^{\\nu}} W(|\\boldsymbol{x}|,h)\\, \\mathrm{d}^{\\nu} x = 1$，并推导归一化常数$\\sigma_{\\nu}$关于$\\nu$、$\\kappa$和$f$的闭式解析表达式。你可以使用一个标准事实，即$\\nu$维单位球体的表面积为$S_{\\nu-1} = \\frac{2 \\pi^{\\nu/2}}{\\Gamma(\\nu/2)}$。请以$\\sigma_{\\nu}$的单个解析表达式的形式提供最终答案。不需要数值近似，最终答案中也不需要单位。", "solution": "本问题要求在$\\nu$维欧几里得空间中，为一个球对称光滑核$W(r,h)$的归一化常数$\\sigma_{\\nu}$推导一个闭式解析表达式。\n\n首先，我们对问题陈述进行验证。\n\n**第1步：提取已知条件**\n- 光滑核由$W(r,h) = \\sigma_{\\nu}\\, h^{-\\nu}\\, f(r/h)$给出。\n- 空间是$\\nu$维欧几里得空间，$\\mathbb{R}^{\\nu}$。\n- $r = |\\boldsymbol{x}|$是径向距离。\n- $h > 0$是光滑长度。\n- $\\sigma_{\\nu}$是待求的归一化常数。\n- $f(q)$是一个无量纲形状函数，其中$q = r/h$。\n- 核函数在$0 \\le r  \\kappa h$上具有紧支集，其中$\\kappa > 0$是一个有限的支撑参数。这意味着当$q \\ge \\kappa$时，$f(q) = 0$。\n- 归一化要求为$\\int_{\\mathbb{R}^{\\nu}} W(|\\boldsymbol{x}|,h)\\, \\mathrm{d}^{\\nu} x = 1$。\n- $\\nu$维单位球体的表面积由$S_{\\nu-1} = \\frac{2 \\pi^{\\nu/2}}{\\Gamma(\\nu/2)}$给出。\n\n**第2步：使用提取的已知条件进行验证**\n- **科学依据：**该问题是光滑粒子流体动力学（SPH）理论中的一个标准和基础的推导，SPH 是一种成熟的计算物理方法。核函数归一化、紧支集以及超球坐标的使用等概念都是标准且合理的。\n- **适定性：**该问题提供了一个明确的目标（求$\\sigma_{\\nu}$），并附有所有必要的约束和定义。预期会有一个唯一且有意义的解。\n- **客观性：**问题以精确的数学语言陈述，没有歧义或主观性。\n- **结论：**该问题是有效的，因为它具有科学依据、适定性、客观性，并且没有违反任何无效标准。\n\n我们现在开始求解。\n\n出发点是归一化条件：\n$$\n\\int_{\\mathbb{R}^{\\nu}} W(|\\boldsymbol{x}|,h)\\, \\mathrm{d}^{\\nu} x = 1\n$$\n我们将给定的核函数形式$W(r,h) = \\sigma_{\\nu}\\, h^{-\\nu}\\, f(r/h)$代入，其中$r = |\\boldsymbol{x}|$:\n$$\n\\int_{\\mathbb{R}^{\\nu}} \\sigma_{\\nu}\\, h^{-\\nu}\\, f(|\\boldsymbol{x}|/h)\\, \\mathrm{d}^{\\nu} x = 1\n$$\n由于被积函数是球对称的（它只依赖于模长$r=|\\boldsymbol{x}|$），从笛卡尔坐标转换到$\\nu$维超球坐标是有利的。在超球坐标中，体积元$\\mathrm{d}^{\\nu} x$由$\\mathrm{d}^{\\nu} x = r^{\\nu-1} \\mathrm{d}r\\, \\mathrm{d}\\Omega_{\\nu-1}$给出，其中$\\mathrm{d}\\Omega_{\\nu-1}$是$(\\nu-1)$维单位球面上的无穷小立体角元。\n\n积分可以重写为：\n$$\n\\int_0^\\infty \\int_{S_{\\nu-1}} \\sigma_{\\nu}\\, h^{-\\nu}\\, f(r/h)\\, r^{\\nu-1} \\mathrm{d}\\Omega_{\\nu-1} \\mathrm{d}r = 1\n$$\n被积函数不依赖于角变量。因此，对立体角$\\mathrm{d}\\Omega_{\\nu-1}$的积分得到$(\\nu-1)$维单位球面的总表面积，即$S_{\\nu-1}$。\n$$\nS_{\\nu-1} \\int_0^\\infty \\sigma_{\\nu}\\, h^{-\\nu}\\, f(r/h)\\, r^{\\nu-1} \\mathrm{d}r = 1\n$$\n常数$\\sigma_{\\nu}$和$h^{-\\nu}$可以移到积分符号外面：\n$$\n\\sigma_{\\nu}\\, h^{-\\nu}\\, S_{\\nu-1} \\int_0^\\infty f(r/h)\\, r^{\\nu-1} \\mathrm{d}r = 1\n$$\n核函数具有紧支集，意味着当$r \\ge \\kappa h$时，$f(r/h) = 0$。这将径向积分的上限从$\\infty$修改为$\\kappa h$。\n$$\n\\sigma_{\\nu}\\, h^{-\\nu}\\, S_{\\nu-1} \\int_0^{\\kappa h} f(r/h)\\, r^{\\nu-1} \\mathrm{d}r = 1\n$$\n为了计算剩余的积分，我们进行变量替换。令$q = r/h$。则$r = qh$且$\\mathrm{d}r = h\\, \\mathrm{d}q$。新变量$q$的积分限从$r=0 \\implies q=0$到$r=\\kappa h \\implies q=\\kappa$。将这些代入积分中：\n$$\n\\int_0^{\\kappa h} f(r/h)\\, r^{\\nu-1} \\mathrm{d}r = \\int_0^{\\kappa} f(q)\\, (qh)^{\\nu-1} (h\\, \\mathrm{d}q)\n$$\n$$\n= \\int_0^{\\kappa} f(q)\\, q^{\\nu-1}\\, h^{\\nu-1}\\, h\\, \\mathrm{d}q = h^{\\nu} \\int_0^{\\kappa} f(q)\\, q^{\\nu-1} \\mathrm{d}q\n$$\n现在我们将此结果代回归一化方程：\n$$\n\\sigma_{\\nu}\\, h^{-\\nu}\\, S_{\\nu-1} \\left( h^{\\nu} \\int_0^{\\kappa} f(q)\\, q^{\\nu-1} \\mathrm{d}q \\right) = 1\n$$\n$h^{-\\nu}$和$h^{\\nu}$项相互抵消，这证实了归一化常数$\\sigma_{\\nu}$与光滑长度$h$的具体选择无关。\n$$\n\\sigma_{\\nu}\\, S_{\\nu-1} \\int_0^{\\kappa} f(q)\\, q^{\\nu-1} \\mathrm{d}q = 1\n$$\n我们现在可以解出$\\sigma_{\\nu}$：\n$$\n\\sigma_{\\nu} = \\frac{1}{S_{\\nu-1} \\int_0^{\\kappa} f(q)\\, q^{\\nu-1} \\mathrm{d}q}\n$$\n最后，我们代入给定的$(\\nu-1)$维球体表面积表达式$S_{\\nu-1} = \\frac{2 \\pi^{\\nu/2}}{\\Gamma(\\nu/2)}$：\n$$\n\\sigma_{\\nu} = \\frac{1}{\\left( \\frac{2 \\pi^{\\nu/2}}{\\Gamma(\\nu/2)} \\right) \\int_0^{\\kappa} f(q)\\, q^{\\nu-1} \\mathrm{d}q}\n$$\n化简后得到归一化常数$\\sigma_{\\nu}$的最终闭式解析表达式：\n$$\n\\sigma_{\\nu} = \\frac{\\Gamma(\\nu/2)}{2 \\pi^{\\nu/2} \\int_0^{\\kappa} f(q)\\, q^{\\nu-1} \\mathrm{d}q}\n$$\n正如所要求的，$\\sigma_{\\nu}$的这个表达式取决于维度$\\nu$、支撑参数$\\kappa$（作为积分的上限）以及形状函数$f$的形式。", "answer": "$$\\boxed{\\frac{\\Gamma(\\frac{\\nu}{2})}{2 \\pi^{\\frac{\\nu}{2}} \\int_0^{\\kappa} f(q)\\, q^{\\nu-1} \\mathrm{d}q}}$$", "id": "3534761"}, {"introduction": "激波是计算天体物理学中的一个关键挑战，而标准的SPH方法需要特殊处理才能正确捕捉它们。本练习 [@problem_id:3498269] 对比了两种主流范式：传统的人工粘性方法和更现代的、基于黎曼求解器的Godunov-SPH方法。通过推导两者的特征信号速度，您将更深入地理解这些方法的工作原理，以及它们为何在激波锐度和激波后振荡方面产生不同的结果。", "problem": "考虑一个一维可压缩理想气体，其绝热指数为$\\gamma$，由守恒形式的欧拉方程描述。在光滑粒子流体动力学 (SPH) 中，流体量由具有位置$\\mathbf{r}_i$、速度$\\mathbf{v}_i$、质量$m_i$、密度$\\rho_i$和压力$P_i$的粒子表示，并通过带有光滑长度$h$的核函数加权成对算子相互作用。在激波捕捉 SPH 中，存在两种主要方法：(i) 添加由粒子间成对“信号速度”控制的人工粘性耗散；(ii) 使用近似波速求解粒子间的黎曼问题 (Godunov SPH)。\n\n从一维欧拉方程的特征分析出发，对于界面两侧速度为$u_L$、$u_R$和声速为$c_L$、$c_R$（其中$c \\equiv \\sqrt{\\gamma P/\\rho}$）的状态，最快的左行和右行特征分别为$u_L - c_L$和$u_R + c_R$。在 SPH 中，相关界面是粒子对$(i,j)$之间的中心连线，其单位向量为$\\hat{\\mathbf{r}}_{ij} \\equiv (\\mathbf{r}_i - \\mathbf{r}_j)/|\\mathbf{r}_i - \\mathbf{r}_j|$，沿中心连线的相对速度分量为$s_{ij} \\equiv -\\mathbf{v}_{ij}\\cdot \\hat{\\mathbf{r}}_{ij}$，其中$\\mathbf{v}_{ij} \\equiv \\mathbf{v}_i - \\mathbf{v}_j$。当$s_{ij} > 0$时，为压缩性相互作用。\n\n仅使用这些第一性原理和定义，推导两种信号速度的选择：\n\n- 对于人工粘性 SPH，推导一个保守的成对信号速度$v_{\\mathrm{sig},ij}$，它能界定声学信息的成对传播，并且仅对压缩粒子对施加耗散。讨论由此产生的数值耗散如何随$h$缩放，以及这对以$h$为单位的激波厚度的影响，还有激波后振荡的趋势。\n\n- 对于使用近似 Harten-Lax-van Leer (HLL) 求解器的基于黎曼求解器的 SPH (Godunov SPH)，从欧拉方程的极端特征速度推导出沿$\\hat{\\mathbf{r}}_{ij}$的左行和右行信号速度$S_L$和$S_R$。讨论这些选择如何影响相对于$h$的激波宽度及其对激波后振荡的影响，包括接触间断捕捉的作用。\n\n根据您的推导和讨论，回答以下多项选择题。哪个陈述最能反映人工粘性 SPH 与 Godunov SPH 在激波捕捉方面的正确比较行为，包括适当的信号速度构造、激波宽度和激波后振荡？\n\nA. 在人工粘性 SPH 中，一个保守的选择是$v_{\\mathrm{sig},ij} = \\max(c_i, c_j) + \\max(0, s_{ij})$，且仅在$s_{ij} > 0$时应用；这会产生厚度为几个光滑长度$h$量级的激波（取决于耗散系数），并且由于不完美的接触处理和粒子无序，会持续存在残余的激波后振荡。在带有 HLL 求解器的 Godunov SPH 中，使用$S_L = \\min(u_L - c_L, u_R - c_R)$和$S_R = \\max(u_L + c_L, u_R + c_R)$将激波限制在$h$的量级，并通过更好地解析波来显著抑制激波后振荡，尤其是在包含接触波时。\n\nB. 在人工粘性 SPH 中，选择$v_{\\mathrm{sig},ij} = s_{ij}$（不包括任何声速）会将激波宽度压缩到接近零并消除激波后振荡。在 Godunov SPH 中，HLL 速度会因为平均化特征而使激波相对于人工粘性方法变宽。\n\nC. 在带有精确黎曼求解器的 Godunov SPH 中，接触间断的解析与核函数的选择和光滑长度$h$无关，即使在粗糙的粒子间距上，激波也会变得比$h$的任何分数都薄；人工粘性 SPH 永远无法产生比$10 h$更薄的激波。\n\nD. 带有随时间变化的系数并调整为在远离压缩区时消失的人工粘性，可以在激波宽度（可达$h/10$）和消除激波后振荡方面与 Godunov SPH 相媲美，前提是$v_{\\mathrm{sig},ij}$不包含声速以防止过度耗散；在 SPH 中，HLL 速度对于精确的激波捕捉并非必需。", "solution": "用户请求对一个关于光滑粒子流体动力学 (SPH) 中激波捕捉方法的问题进行细致的验证和解答。\n\n### 问题验证\n\n**步骤 1：提取已知条件**\n\n-   系统：一维可压缩理想气体。\n-   绝热指数：$\\gamma$。\n-   控制方程：守恒形式的欧拉方程。\n-   SPH 表示：具有位置$\\mathbf{r}_i$、速度$\\mathbf{v}_i$、质量$m_i$、密度$\\rho_i$和压力$P_i$的粒子。\n-   相互作用：带有光滑长度$h$的核函数加权成对算子。\n-   激波捕捉方法：(i) 由成对“信号速度”控制的人工粘性 (AV) 耗散；(ii) 使用近似波速求解粒子间黎曼问题 (Godunov SPH)。\n-   特征分析 (1D Euler)：状态$(u_L, c_L)$和$(u_R, c_R)$，声速$c \\equiv \\sqrt{\\gamma P/\\rho}$。最快特征为$u_L - c_L$和$u_R + c_R$。\n-   SPH 界面定义：单位向量$\\hat{\\mathbf{r}}_{ij} \\equiv (\\mathbf{r}_i - \\mathbf{r}_j)/|\\mathbf{r}_i - \\mathbf{r}_j|$。相对速度分量$s_{ij} \\equiv -\\mathbf{v}_{ij}\\cdot \\hat{\\mathbf{r}}_{ij}$，其中$\\mathbf{v}_{ij} \\equiv \\mathbf{v}_i - \\mathbf{v}_j$。\n-   压缩条件：$s_{ij} > 0$。\n-   任务 1 (推导)：为 AV SPH 推导一个保守的成对信号速度$v_{\\mathrm{sig},ij}$，仅适用于压缩粒子对。\n-   任务 2 (讨论)：讨论 AV 的数值耗散如何随$h$缩放、激波厚度以及激波后振荡。\n-   任务 3 (推导)：为基于 HLL 的 Godunov SPH 推导左行和右行信号速度$S_L$和$S_R$。\n-   任务 4 (讨论)：讨论 Godunov SPH 相对于$h$的激波宽度及其对激波后振荡的影响。\n-   任务 5 (问题)：回答一个比较这两种方法的多项选择题。\n\n**步骤 2：使用提取的已知条件进行验证**\n\n根据验证标准对问题陈述进行评估：\n\n-   **科学依据：** 该问题牢固地植根于计算流体动力学的既定原则，特别是用于求解欧拉方程的 SPH 方法。人工粘性、Godunov 方法、黎曼问题 (HLL 变体)、特征速度和激波捕捉等概念都是标准的且描述正确。所提供的定义，如声速$c$和相对速度$s_{ij}$，都是准确的。\n-   **适定性：** 该问题要求推导标准的数值构造（AV 和 HLL 方法的信号速度）并讨论其众所周知的所有性质（激波宽度、振荡）。这些任务定义清晰，并能导出一个具体的、唯一的比较，可用于回答多项选择题。\n-   **客观性：** 语言技术性强、精确，没有主观或模糊的术语。\n-   **缺陷清单：** 该问题没有违反任何指定的缺陷条件。它在科学上是合理的、可形式化的、完整的、可行的、适定的、非平凡的，并且是科学可验证的。\n\n**步骤 3：结论与行动**\n\n问题陈述是**有效的**。现在开始解答。\n\n### 推导与讨论\n\n#### 人工粘性 (AV) SPH\n\n**信号速度 $v_{\\mathrm{sig},ij}$ 的推导**\n人工粘性的目的是在强压缩区域（激波）引入耗散，以防止粒子相互穿透并捕捉激波前后的熵增。这种耗散必须是因果的，意味着数值效应的传播必须快于相互作用粒子之间的任何物理信号。物理信号是相对于流体流动以速度$c$传播的声波。\n\n对于一对粒子$(i,j)$，我们考虑沿中心连线$\\hat{\\mathbf{r}}_{ij}$的相互作用。相关的物理速度是声速$c_i$和$c_j$，以及接近的整体速度$s_{ij} = -\\mathbf{v}_{ij}\\cdot\\hat{\\mathbf{r}}_{ij} > 0$。一个保守的信号速度$v_{\\mathrm{sig},ij}$必须界定粒子间信息交换的最大速度。该速度是声学传播和整体运动的组合。\n\n信号速度的一个稳健且保守的选择是粒子对的最大声速与它们的接近速度之和。这确保了耗散信号能超过在粒子间传播的任何物理波。因此，一个有效的信号速度选择是：\n$$\nv_{\\mathrm{sig},ij} \\approx \\bar{c}_{ij} + s_{ij}\n$$\n其中$\\bar{c}_{ij}$是一个平均声速，例如$(c_i + c_j)/2$。为了最大程度地保守，可以使用$\\max(c_i, c_j)$。\n\n问题指出耗散应仅适用于压缩粒子对 ($s_{ij} > 0$)。这通常通过在动量方程的整个 AV 项上乘以一个开关来实现，例如 Heaviside 函数$\\Theta(s_{ij})$或一个与$\\max(0, s_{ij})$成正比的因子。如果我们要像选项中暗示的那样构造一个反映这一点的单一信号速度变量，一种可能的形式是$v_{\\mathrm{sig},ij}' = \\max(c_i, c_j) + \\max(0, s_{ij})$。然而，必须为非压缩相互作用消失的是整个粘性力，而不仅仅是信号速度。核心的推导原则是信号速度必须结合声速和压缩速度。\n\n**AV SPH 属性的讨论**\n-   **数值耗散与激波厚度：** AV 项在 SPH 动量方程中增加了一个粘性压力$\\Pi_{ij}$。线性粘性项的一个常见形式是$\\Pi_{ij} \\propto \\alpha \\bar{c}_{ij} \\mu_{ij}$，其中$\\alpha$是耗散系数，$\\mu_{ij} \\propto s_{ij}$。这导致一个作用类似于速度上的数值耗散的粘性力。有效扩散系数为$\\nu \\propto \\alpha \\bar{c} h$。平衡激波宽度$\\Delta x$上的对流项和扩散项表明$\\Delta x \\propto \\alpha h$。因此，激波被涂抹在几个光滑长度上，精确的宽度可通过参数$\\alpha$进行调整。激波宽度的量级为$\\mathcal{O}(h)$。\n-   **激波后振荡：** AV 项是一个各向同性地增加的标量压力（在 SPH 公式中，它沿中心连线作用）。它不区分欧拉方程的不同波族（声波、熵波、接触波）。其主要功能是将动能耗散为热能。这种“暴力”方法并非针对流体动力学间断的特定波结构量身定制。这种非特异性，加上 SPH 离散粒子可能会过冲其平衡的激波后状态，导致在激波锋面后出现虚假的、非物理的压力和密度振荡。\n\n#### Godunov SPH (HLL 求解器)\n\n**信号速度 $S_L$ 和 $S_R$ 的推导**\nGodunov SPH 用一种更复杂的方法取代了标准 SPH 的简单压力平均和 AV：在每个相互作用的粒子对之间求解一个近似黎曼问题。界面是粒子$i$和$j$之间的中间平面。“左”状态 (L) 可取为$(\\rho_i, \\mathbf{v}_i, P_i)$，“右”状态 (R) 可取为$(\\rho_j, \\mathbf{v}_j, P_j)$。我们将这些状态投影到中心连线$\\hat{\\mathbf{r}}_{ij}$上。设投影速度为$u_i = \\mathbf{v}_i \\cdot \\hat{\\mathbf{r}}_{ij}$和$u_j = \\mathbf{v}_j \\cdot \\hat{\\mathbf{r}}_{ij}$。问题变成一个状态为$(L) \\equiv (\\rho_i, u_i, P_i)$和$(R) \\equiv (\\rho_j, u_j, P_j)$的一维黎曼问题。\n\nHarten-Lax-van Leer (HLL) 求解器通过假设黎曼问题的解由两个速度为$S_L$和$S_R$的波组成来近似求解，这两个波界定了整个波扇（左行波、接触波、右行波）。为确保所有物理波都被捕捉到，$S_L$必须小于或等于从界面出现的最小波速，$S_R$必须大于或等于最大波速。欧拉方程的特征速度是$u-c$、$u$和$u+c$。来自两个初始状态（L 和 R）的可能波速的全集是$\\{u_i-c_i, u_i, u_i+c_i\\}$和$\\{u_j-c_j, u_j, u_j+c_j\\}$。\n\n对$S_L$和$S_R$的保守估计需要界定该集合中的极值速度：\n-   从界面向左传播最远的波的速度将由两侧$u-c$速度的最小值给出。\n    $$S_L = \\min(u_i - c_i, u_j - c_j)$$\n-   向右传播最远的波的速度将由两侧$u+c$速度的最大值给出。\n    $$S_R = \\max(u_i + c_i, u_j + c_j)$$\n这些是 HLL 求解器标准、稳健的信号速度估计，与问题的符号表示（用 L/R 代表 i/j）一致。\n\n**Godunov SPH 属性的讨论**\n-   **激波宽度：** 通过求解黎曼问题，通量计算内在地考虑了信息流的方向（迎风格式）。这会自动施加捕捉粒子间波结构所需的正确耗散量。因此，激波通常被非常尖锐地捕捉，过渡发生在粒子间距的尺度上，量级为$h$。在相同分辨率下，Godunov SPH 通常比 AV SPH 产生更尖锐的激波。\n-   **激波后振荡：** HLL 方法为间断提供了比简单标量粘性好得多的物理模型。通过近似解析波扇，它显著抑制了在 AV SPH 中看到的虚假激波后振荡。HLL 求解器的主要局限性在于它没有显式解析接触间断，而是将其合并到$S_L$和$S_R$之间的区域。这可能是一个次要误差的来源。然而，整体性能有了实质性改善，导致更干净的激波剖面。更高级的求解器，如 HLLC（增加了接触波），几乎可以完全消除这些振荡。\n\n### 选项评估\n\n**A. 在人工粘性 SPH 中，一个保守的选择是$v_{\\mathrm{sig},ij} = \\max(c_i, c_j) + \\max(0, s_{ij})$，且仅在$s_{ij} > 0$时应用；这会产生厚度为几个光滑长度$h$量级的激波（取决于耗散系数），并且由于不完美的接触处理和粒子无序，会持续存在残余的激波后振荡。在带有 HLL 求解器的 Godunov SPH 中，使用$S_L = \\min(u_L - c_L, u_R - c_R)$和$S_R = \\max(u_L + c_L, u_R + c_R)$将激波限制在$h$的量级，并通过更好地解析波来显著抑制激波后振荡，尤其是在包含接触波时。**\n-   **AV 部分：** 该信号速度是一个合理的、基于第一性原理（界定声速和压缩速度）的保守构造。关于激波宽度（约几个$h$）和激波后振荡的描述是准确的。短语“仅在$s_{ij}0$时应用”正确地指出了施加粘性的条件，即使$v_{\\mathrm{sig},ij}$本身的表述略有非标准。\n-   **Godunov 部分：** $S_L$和$S_R$的公式基于从极端特征速度的推导是正确的。关于激波宽度（约$h$）和振荡被显著抑制的描述也是正确的。提及包含接触波指出了基于黎曼方法的一般优越性。\n-   **结论：** **正确**。此选项提供了对两种方法的准确且内部一致的比较，与推导相符。\n\n**B. 在人工粘性 SPH 中，选择$v_{\\mathrm{sig},ij} = s_{ij}$（不包括任何声速）会将激波宽度压缩到接近零并消除激波后振荡。在 Godunov SPH 中，HLL 速度会因为平均化特征而使激波相对于人工粘性方法变宽。**\n-   **AV 部分：** 从信号速度中排除声速在物理上是不正确的。它违反了亚音速压缩的因果关系，并会导致严重的数值不稳定性，而不是干净的激波。\n-   **Godunov 部分：** Godunov 方法（包括 HLL）已知比标准 AV 产生*更尖锐*的激波，而不是更宽。\n-   **结论：** **不正确**。两个论点在事实上都是错误的。\n\n**C. 在带有精确黎曼求解器的 Godunov SPH 中，接触间断的解析与核函数的选择和光滑长度$h$无关，即使在粗糙的粒子间距上，激波也会变得比$h$的任何分数都薄；人工粘性 SPH 永远无法产生比$10 h$更薄的激波。**\n-   **Godunov 部分：** SPH 中任何特征的解析度都从根本上受到光滑长度$h$的限制。任何数值方法都无法“独立于... $h$”或达到“比$h$的任何分数都薄”的尺度来解析特征。\n-   **AV 部分：** “永远无法产生比$10h$更薄的激波”这个说法有些夸张。宽度与$\\alpha h$成正比，虽然非常小的$\\alpha$有问题，但几个$h$的宽度是典型的，不一定大于$10h$。\n-   **结论：** **不正确**。关于解析度的说法对于基于粒子的方法在物理上是不可能的。\n\n**D. 带有随时间变化的系数并调整为在远离压缩区时消失的人工粘性，可以在激波宽度（可达$h/10$）和消除激波后振荡方面与 Godunov SPH 相媲美，前提是$v_{\\mathrm{sig},ij}$不包含声速以防止过度耗散；在 SPH 中，HLL 速度对于精确的激波捕捉并非必需。**\n-   此选项包含其他选项中出现的多个错误。它声称亚 h 分辨率（$h/10$），这是不可能的。它错误地主张从信号速度中排除声速，这是危险的。虽然现代 AV 开关提高了性能，但声称它们能够完全媲美并消除所有振荡，如同 Godunov 方法一样，是一种夸大。\n-   **结论：** **不正确**。这些说法在物理上和数值上都是不成立的。", "answer": "$$\\boxed{A}$$", "id": "3498269"}, {"introduction": "除了激波，模拟流体混合和像开尔文-亥姆霍兹不稳定性（KHI）这样的不稳定性，揭示了SPH中更微妙的挑战。不同的SPH方程数学形式，虽然在连续谱极限下是等价的，但在接触间断处的行为可能截然不同。这个动手编程练习 [@problem_id:3498213] 使用KHI的线性理论作为诊断工具，量化了压力-熵形式如何抑制困扰传统密度-能量形式的虚假表面张力效应。", "problem": "本题要求您构建、分析并实现一个简化的线性理论诊断工具，用于在开尔文-亥姆霍兹不稳定性 (KHI) 的背景下，研究光滑粒子流体动力学 (SPH) 方法中不同公式选择对接触间断处伪表面张力的影响。从两种无粘性、不可混溶、可压缩流体在亚音速、小扰动极限下的欧拉方程出发，将其简化为经典的不可压缩、无旋线性分析，研究一个分隔两种半无限流体的平面剪切层。这两种流体的密度分别为$\\rho_{1}$和$\\rho_{2}$，均匀水平速度为$U_{1}$和$U_{2}$，平衡压力相等，为$P_{0}$，并存在一个波数为$k$、振幅为无穷小的单模界面扰动。在界面上施加运动学边界条件，以及包含由集中在接触间断处的有效表面张力$S$引起的类毛细恢复力的动力学边界条件。\n\n在这些假设下，请推导与$\\exp[i(kx - \\omega t)]$成正比的简正模扰动的色散关系，并获得线性增长率$\\gamma \\equiv \\operatorname{Im}\\,\\omega \\ge 0$作为$\\rho_{1}$、$\\rho_{2}$、$\\Delta U \\equiv U_{1}-U_{2}$、$k$和$S$的函数的显式公式。然后，给定时间$t$，定义振幅增益因子$G \\equiv \\exp(\\gamma t)$。\n\n将 SPH 中的伪表面张力效应建模为有效界面张力\n$$\nS_{\\mathrm{eff}} = C\\, P_{0}\\, h,\n$$\n其中$C$是一个与公式相关的无量纲系数，$P_{0}$是界面处的平衡压力，$h$是光滑长度。使用该模型来表示在相同初始条件下（不同运行之间场匹配，而非不同相之间匹配）的两种 SPH 公式：密度-能量公式（设置$C = C_{\\mathrm{DE}}$）和压力-熵公式（设置$C = C_{\\mathrm{PE}}$）。假设采用理想气体状态方程，因此具有$\\rho_{1} \\ne \\rho_{2}$和相等$P_{0}$的接触间断意味着界面两侧的熵函数不同，这是密度-能量公式中伪张力效应的来源；而压力-熵公式通过其构造抑制了这种效应。\n\n请实现一个程序，为下面的每个测试用例计算在时间$t$的三个无量纲振幅增益因子：解析无表面张力增益$G_{\\mathrm{an}}$（$S=0$），密度-能量 SPH 模型增益$G_{\\mathrm{DE}}$（$S=S_{\\mathrm{eff}}$且$C=C_{\\mathrm{DE}}$），以及压力-熵 SPH 模型增益$G_{\\mathrm{PE}}$（$S=S_{\\mathrm{eff}}$且$C=C_{\\mathrm{PE}}$）。如果推导出的色散关系预测给定参数下系统是线性稳定的（即非增长模），则将增长率$\\gamma$设置为$0$，从而$G=1$。所有量均被视为无量纲代码单位；所有输出均报告为无单位的无量纲数。\n\n测试套件参数（每个元组为$(\\rho_{1}, \\rho_{2}, U_{1}, U_{2}, k, P_{0}, h, C_{\\mathrm{DE}}, C_{\\mathrm{PE}}, t)$）：\n- 案例 A（理想情况，中等对比度，在所有模型中均不稳定）：$(1.0, 2.0, +0.5, -0.5, 2\\pi, 1.0, 0.02, 0.25, 0.0, 2.0)$。\n- 案例 B（边界情况，密度-能量模型因伪张力而稳定，而解析模型和压力-熵模型则增长）：$(1.0, 2.0, +0.25, -0.25, 4\\pi, 1.0, 0.2, 0.25, 0.0, 2.0)$。\n- 案例 C（密度相等，检查对称性）：$(1.0, 1.0, +0.5, -0.5, 2\\pi, 1.0, 0.05, 0.25, 0.0, 2.0)$。\n- 案例 D（密度-能量模型的近阈值行为）：$(1.0, 2.0, +0.15, -0.15, 3\\pi, 1.0, 0.02, 0.25, 0.0, 3.0)$。\n\n您的程序必须：\n- 推导并使用您从第一性原理得到的、包含上述有效$S_{\\mathrm{eff}}$模型的线性增长率$\\gamma$。\n- 对于每个案例，按顺序计算并收集三元组$\\left(G_{\\mathrm{an}}, G_{\\mathrm{DE}}, G_{\\mathrm{PE}}\\right)$。\n- 生成单行输出，包含所有结果，按案例顺序排列，形式为用方括号括起来的逗号分隔列表。列表必须按$\\left[G_{\\mathrm{an}}^{(A)}, G_{\\mathrm{DE}}^{(A)}, G_{\\mathrm{PE}}^{(A)}, G_{\\mathrm{an}}^{(B)}, G_{\\mathrm{DE}}^{(B)}, G_{\\mathrm{PE}}^{(B)}, G_{\\mathrm{an}}^{(C)}, G_{\\mathrm{DE}}^{(C)}, G_{\\mathrm{PE}}^{(C)}, G_{\\mathrm{an}}^{(D)}, G_{\\mathrm{DE}}^{(D)}, G_{\\mathrm{PE}}^{(D)}\\right]$的顺序展开。每个浮点数最多表示$6$位小数。\n\n设计覆盖范围：\n- 案例 A 检验具有适度伪张力抑制的一般不稳定状态。\n- 案例 B 探究由密度-能量公式中的伪张力引起的稳定边界。\n- 案例 C 测试增长率简化时的等密度极限。\n- 案例 D 探究接近阈值时对参数的敏感性，确保正确处理小的正增长率。\n\n最终答案必须是下面指定的完整、可运行的程序。", "solution": "该问题要求推导并应用开尔文-亥姆霍兹不稳定性 (KHI) 在两种无粘性、无旋、不可压缩流体之间的平面界面处的线性增长率，并包含表面张力的影响。这提供了一个诊断工具，用以理解光滑粒子流体动力学 (SPH) 模拟中的伪数值伪影。\n\n推导的起点是两种半无限流体界面上形式为$\\exp[i(kx - \\omega t)]$的简正模扰动的色散关系。流体1（密度$\\rho_1$，速度$U_1$）占据上半空间（$y>0$），流体2（密度$\\rho_2$，速度$U_2$）占据下半空间（$y0$）。这是流体动力学中的一个经典结果，通常通过线性化欧拉方程并在扰动界面上应用运动学和动力学边界条件来推导。该问题忽略了重力。包含界面表面张力$S$的最终色散关系为：\n$$\n\\rho_1 (\\omega - k U_1)^2 + \\rho_2 (\\omega - k U_2)^2 = S k^3\n$$\n这里，$k$是扰动的波数，$\\omega$是其复频率。$\\omega$的实部对应相速度，虚部$\\gamma \\equiv \\operatorname{Im}(\\omega)$对应不稳定性的增长率。\n\n该方程是关于$\\omega$的二次方程：\n$$\n(\\rho_1 + \\rho_2)\\omega^2 - 2k(\\rho_1 U_1 + \\rho_2 U_2)\\omega + [k^2(\\rho_1 U_1^2 + \\rho_2 U_2^2) - S k^3] = 0\n$$\n我们使用一元二次方程求根公式$\\omega = (-b \\pm \\sqrt{b^2-4ac})/(2a)$来解$\\omega$，其中：\n$a = \\rho_1 + \\rho_2$\n$b = -2k(\\rho_1 U_1 + \\rho_2 U_2)$\n$c = k^2(\\rho_1 U_1^2 + \\rho_2 U_2^2) - S k^3$\n\n$\\omega$的解为：\n$$\n\\omega = \\frac{2k(\\rho_1 U_1 + \\rho_2 U_2) \\pm \\sqrt{4k^2(\\rho_1 U_1 + \\rho_2 U_2)^2 - 4(\\rho_1+\\rho_2)(k^2(\\rho_1 U_1^2 + \\rho_2 U_2^2) - Sk^3)}}{2(\\rho_1+\\rho_2)}\n$$\n当判别式为负时 ($\\Delta  0$)，出现不稳定性，导致$\\omega$有共轭复根。增长率$\\gamma$是$\\omega$的虚部。\n我们来分析判别式$\\Delta = b^2 - 4ac$：\n$$\n\\Delta = 4k^2(\\rho_1 U_1 + \\rho_2 U_2)^2 - 4(\\rho_1+\\rho_2)(k^2(\\rho_1 U_1^2 + \\rho_2 U_2^2) - Sk^3)\n$$\n平方根内与速度相关的项可简化为：\n$$\n(\\rho_1 U_1 + \\rho_2 U_2)^2 - (\\rho_1+\\rho_2)(\\rho_1 U_1^2 + \\rho_2 U_2^2) \\\\\n= (\\rho_1^2 U_1^2 + \\rho_2^2 U_2^2 + 2\\rho_1\\rho_2 U_1 U_2) - (\\rho_1^2 U_1^2 + \\rho_1\\rho_2 U_2^2 + \\rho_2\\rho_1 U_1^2 + \\rho_2^2 U_2^2) \\\\\n= -\\rho_1\\rho_2(U_1^2 - 2U_1U_2 + U_2^2) = -\\rho_1\\rho_2(U_1 - U_2)^2 = -\\rho_1\\rho_2 (\\Delta U)^2\n$$\n其中$\\Delta U \\equiv U_1 - U_2$。\n将此结果代回$\\Delta$的表达式中：\n$$\n\\Delta = 4k^2 [-\\rho_1\\rho_2 (\\Delta U)^2] + 4k^3 S (\\rho_1+\\rho_2) = 4k^2 [kS(\\rho_1+\\rho_2) - \\rho_1\\rho_2(\\Delta U)^2]\n$$\n当$\\Delta  0$时发生不稳定性，这要求方括号内的项为负。$\\omega$的解变为：\n$$\n\\omega = k\\frac{\\rho_1 U_1 + \\rho_2 U_2}{\\rho_1+\\rho_2} \\pm i \\frac{\\sqrt{-\\Delta}}{2(\\rho_1+\\rho_2)}\n$$\n增长率$\\gamma = \\operatorname{Im}(\\omega)$是正的虚部：\n$$\n\\gamma = \\frac{\\sqrt{-\\Delta}}{2(\\rho_1+\\rho_2)} = \\frac{\\sqrt{4k^2[\\rho_1\\rho_2(\\Delta U)^2 - kS(\\rho_1+\\rho_2)]}}{2(\\rho_1+\\rho_2)}\n$$\n$$\n\\gamma = \\frac{k}{\\rho_1+\\rho_2} \\sqrt{\\rho_1\\rho_2(\\Delta U)^2 - kS(\\rho_1+\\rho_2)}\n$$\n该表达式仅当平方根下的项为非负时有效，此即不稳定性条件：$\\rho_1\\rho_2(\\Delta U)^2 > kS(\\rho_1+\\rho_2)$。若此条件不满足，则模式是稳定或中性稳定的，增长率为零。因此，我们将$\\gamma$定义为：\n$$\n\\gamma = \\frac{k}{\\rho_1+\\rho_2} \\sqrt{\\max\\left(0, \\rho_1\\rho_2(\\Delta U)^2 - kS(\\rho_1+\\rho_2)\\right)}\n$$\n问题将 SPH 模拟中的伪表面张力建模为有效表面张力$S_{\\mathrm{eff}} = C P_0 h$。我们计算三种情况下的增长率：\n1.  解析情况（$S=0$）：$\\gamma_{\\mathrm{an}}$使用$S=0$计算。\n2.  密度-能量 SPH（$S=S_{\\mathrm{DE}}$）：$\\gamma_{\\mathrm{DE}}$使用$S = S_{\\mathrm{DE}} = C_{\\mathrm{DE}} P_0 h$计算。\n3.  压力-熵 SPH（$S=S_{\\mathrm{PE}}$）：$\\gamma_{\\mathrm{PE}}$使用$S = S_{\\mathrm{PE}} = C_{\\mathrm{PE}} P_0 h$计算。\n\n最后，给定时间$t$的振幅增益因子定义为$G = \\exp(\\gamma t)$。\n\n每个测试用例的算法如下：\n1.  提取参数：$(\\rho_1, \\rho_2, U_1, U_2, k, P_0, h, C_{\\mathrm{DE}}, C_{\\mathrm{PE}}, t)$。\n2.  计算$\\Delta U = U_1 - U_2$。\n3.  计算$S_{\\mathrm{DE}} = C_{\\mathrm{DE}} P_0 h$和$S_{\\mathrm{PE}} = C_{\\mathrm{PE}} P_0 h$。\n4.  分别使用$S=0$、$S=S_{\\mathrm{DE}}$和$S=S_{\\mathrm{PE}}$，通过推导出的$\\gamma$公式计算$\\gamma_{\\mathrm{an}}$、$\\gamma_{\\mathrm{DE}}$和$\\gamma_{\\mathrm{PE}}$。\n5.  计算相应的增益因子$G_{\\mathrm{an}} = \\exp(\\gamma_{\\mathrm{an}} t)$、$G_{\\mathrm{DE}} = \\exp(\\gamma_{\\mathrm{DE}} t)$和$G_{\\mathrm{PE}} = \\exp(\\gamma_{\\mathrm{PE}} t)$。\n6.  收集三元组$(G_{\\mathrm{an}}, G_{\\mathrm{DE}}, G_{\\mathrm{PE}})$。\n最终输出是所有测试用例的这些三元组的展开列表。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes and prints the amplitude gain factors for Kelvin-Helmholtz instability\n    under different SPH formulation models.\n    \"\"\"\n    \n    # Test suite parameters:\n    # (rho1, rho2, U1, U2, k, P0, h, C_DE, C_PE, t)\n    test_cases = [\n        (1.0, 2.0, 0.5, -0.5, 2 * np.pi, 1.0, 0.02, 0.25, 0.0, 2.0),\n        (1.0, 2.0, 0.25, -0.25, 4 * np.pi, 1.0, 0.2, 0.25, 0.0, 2.0),\n        (1.0, 1.0, 0.5, -0.5, 2 * np.pi, 1.0, 0.05, 0.25, 0.0, 2.0),\n        (1.0, 2.0, 0.15, -0.15, 3 * np.pi, 1.0, 0.02, 0.25, 0.0, 3.0),\n    ]\n\n    results = []\n\n    def calculate_growth_rate(rho1, rho2, delta_U, k, S):\n        \"\"\"\n        Calculates the KHI linear growth rate gamma.\n        \n        Args:\n            rho1 (float): Density of fluid 1.\n            rho2 (float): Density of fluid 2.\n            delta_U (float): Velocity difference U1 - U2.\n            k (float): Wavenumber.\n            S (float): Surface tension.\n            \n        Returns:\n            float: The growth rate gamma.\n        \"\"\"\n        shear_term = rho1 * rho2 * delta_U**2\n        tension_term = k * S * (rho1 + rho2)\n        \n        # Argument of the square root\n        instability_criterion = shear_term - tension_term\n        \n        if instability_criterion = 0:\n            return 0.0\n        \n        gamma = (k / (rho1 + rho2)) * np.sqrt(instability_criterion)\n        return gamma\n\n    for case in test_cases:\n        rho1, rho2, U1, U2, k, P0, h, C_DE, C_PE, t = case\n        \n        delta_U = U1 - U2\n        \n        # Case 1: Analytic (no surface tension)\n        S_an = 0.0\n        gamma_an = calculate_growth_rate(rho1, rho2, delta_U, k, S_an)\n        G_an = np.exp(gamma_an * t)\n        \n        # Case 2: Density-Energy SPH model\n        S_DE = C_DE * P0 * h\n        gamma_DE = calculate_growth_rate(rho1, rho2, delta_U, k, S_DE)\n        G_DE = np.exp(gamma_DE * t)\n        \n        # Case 3: Pressure-Entropy SPH model\n        S_PE = C_PE * P0 * h\n        gamma_PE = calculate_growth_rate(rho1, rho2, delta_U, k, S_PE)\n        G_PE = np.exp(gamma_PE * t)\n        \n        results.extend([G_an, G_DE, G_PE])\n\n    # Format the output as specified: a comma-separated list of floats\n    # with at most 6 decimal places, enclosed in square brackets.\n    formatted_results = []\n    for r in results:\n        if r == 1.0:\n            formatted_results.append(\"1.0\")\n        else:\n            # {:f} gives 6 decimal places by default\n            formatted_results.append(f\"{r:.6f}\")\n\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "3498213"}]}