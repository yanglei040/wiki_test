{"hands_on_practices": [{"introduction": "弗拉索夫-泊松方程组描述了物质分布与引力场之间的自洽演化。理解这一系统的第一步是掌握物质密度如何产生引力场。本练习将通过一个基础的解析计算，来求解一个简单但极具代表性的密度扰动（单模正弦波）所对应的引力势和引力加速度场。这不仅是宇宙学微扰理论中的一个经典问题，也是构建数值模拟中引力求解器的理论基石。", "problem": "考虑一个在共动边长为 $L$ 的三维立方周期性区域中，根据弗拉索夫-泊松系统演化的无碰撞物质分布，其所有面均满足周期性边界条件。令共动空间坐标为 $\\boldsymbol{x}=(x,y,z)$，共动波数 $k$ 为箱中的一个允许傅里叶模式，即 $k=2\\pi n/L$，其中 $n$ 为某个非零整数。总质量密度为 $\\rho(\\boldsymbol{x})=\\bar{\\rho}\\,[1+\\delta(\\boldsymbol{x})]$，其中 $\\bar{\\rho}$ 是均匀背景密度，$\\delta(\\boldsymbol{x})$ 是密度对比度。假设密度对比度是一个由 $\\delta(\\boldsymbol{x})=\\sin(kx)$ 给出的单模微扰，它只依赖于 $x$ 而与 $y$ 和 $z$ 无关。\n\n在共动坐标系中，特引力势 $\\phi(\\boldsymbol{x})$ 被定义为满足关于密度微扰的牛顿泊松方程，\n$$\n\\nabla^{2}\\phi(\\boldsymbol{x})=4\\pi G\\,a^{2}\\,\\bar{\\rho}\\,\\delta(\\boldsymbol{x}),\n$$\n其中 $G$ 是引力常数，$a$ 是所关注时刻的宇宙学尺度因子。进入无碰撞弗拉索夫（相空间）动力学的特引力加速度场为\n$$\n\\boldsymbol{a}(\\boldsymbol{x})=-\\frac{1}{a}\\,\\nabla\\phi(\\boldsymbol{x}).\n$$\n对 $\\phi(\\boldsymbol{x})$ 施加与箱体一致的周期性边界条件，并通过要求 $\\phi$ 在箱体上的空间平均值为零来固定残余的规范自由度。仅从上述定义和定律出发，确定特引力势 $\\phi(\\boldsymbol{x})$ 和特引力加速度分量 $a_{x}(\\boldsymbol{x})$、$a_{y}(\\boldsymbol{x})$ 及 $a_{z}(\\boldsymbol{x})$ 的闭合形式表达式，并用 $G$、$\\bar{\\rho}$、$a$、$k$ 和 $x$ 表示。\n\n您的最终答案必须是单个闭合形式的解析表达式。如果答案包含多个分量，请使用 $\\mathrm{pmatrix}$ 环境将它们写成单个行矩阵的条目。不需要进行数值近似或舍入。", "solution": "该问题是有效的。它在牛顿宇宙学的原理上具有科学依据，具备完整的方程组和边界条件，是适定的，并以客观、正式的语言表述。我们开始求解。\n\n特引力势 $\\phi(\\boldsymbol{x})$ 由共动坐标系中的泊松方程确定：\n$$\n\\nabla^{2}\\phi(\\boldsymbol{x}) = 4\\pi G\\,a^{2}\\,\\bar{\\rho}\\,\\delta(\\boldsymbol{x})\n$$\n密度对比度 $\\delta(\\boldsymbol{x})$ 是一个只依赖于坐标 $x$ 的单模微扰，给定为：\n$$\n\\delta(\\boldsymbol{x}) = \\sin(kx)\n$$\n将此代入泊松方程，得到：\n$$\n\\nabla^{2}\\phi(\\boldsymbol{x}) = 4\\pi G\\,a^{2}\\,\\bar{\\rho}\\,\\sin(kx)\n$$\n拉普拉斯算子为 $\\nabla^{2} = \\frac{\\partial^{2}}{\\partial x^{2}} + \\frac{\\partial^{2}}{\\partial y^{2}} + \\frac{\\partial^{2}}{\\partial z^{2}}$。由于右侧的源项仅是 $x$ 的函数，我们可以寻找一个也只依赖于 $x$ 的解，即 $\\phi(\\boldsymbol{x}) = \\phi(x)$。在此拟设下，关于 $y$ 和 $z$ 的偏导数消失，$\\frac{\\partial^{2}\\phi}{\\partial y^{2}} = 0$ 且 $\\frac{\\partial^{2}\\phi}{\\partial z^{2}} = 0$。泊松方程简化为一个常微分方程（ODE）：\n$$\n\\frac{d^{2}\\phi}{dx^{2}} = 4\\pi G\\,a^{2}\\,\\bar{\\rho}\\,\\sin(kx)\n$$\n我们可以通过对 $x$ 积分两次来解这个常微分方程。第一次积分得到：\n$$\n\\frac{d\\phi}{dx} = \\int 4\\pi G\\,a^{2}\\,\\bar{\\rho}\\,\\sin(kx)\\,dx = -\\frac{4\\pi G\\,a^{2}\\,\\bar{\\rho}}{k}\\cos(kx) + C_{1}\n$$\n其中 $C_{1}$ 是第一个积分常数。第二次积分给出 $\\phi(x)$ 的通解：\n$$\n\\phi(x) = \\int \\left(-\\frac{4\\pi G\\,a^{2}\\,\\bar{\\rho}}{k}\\cos(kx) + C_{1}\\right)dx = -\\frac{4\\pi G\\,a^{2}\\,\\bar{\\rho}}{k^{2}}\\sin(kx) + C_{1}x + C_{2}\n$$\n其中 $C_{2}$ 是第二个积分常数。\n\n现在我们必须使用边界条件和归一化条件来确定常数 $C_{1}$ 和 $C_{2}$。\n首先，我们应用周期性边界条件，该条件要求 $\\phi(\\boldsymbol{x})$ 在边长为 $L$ 的立方体箱内是周期的。由于我们的解只依赖于 $x$，这意味着 $\\phi(x+L) = \\phi(x)$。\n$$\n-\\frac{4\\pi G\\,a^{2}\\,\\bar{\\rho}}{k^{2}}\\sin(k(x+L)) + C_{1}(x+L) + C_{2} = -\\frac{4\\pi G\\,a^{2}\\,\\bar{\\rho}}{k^{2}}\\sin(kx) + C_{1}x + C_{2}\n$$\n波数 $k$ 是一个允许的傅里叶模式，由 $k = \\frac{2\\pi n}{L}$ 给出，其中 $n$ 是某个非零整数。因此，$kL = 2\\pi n$。正弦项是周期的：$\\sin(k(x+L)) = \\sin(kx + kL) = \\sin(kx + 2\\pi n) = \\sin(kx)$。方程简化为：\n$$\n-\\frac{4\\pi G\\,a^{2}\\,\\bar{\\rho}}{k^{2}}\\sin(kx) + C_{1}x + C_{1}L + C_{2} = -\\frac{4\\pi G\\,a^{2}\\,\\bar{\\rho}}{k^{2}}\\sin(kx) + C_{1}x + C_{2}\n$$\n这可简化为 $C_{1}L = 0$。由于箱体尺寸 $L$ 非零，我们必须有 $C_{1}=0$。因此，势的解现在的形式为：\n$$\n\\phi(x) = -\\frac{4\\pi G\\,a^{2}\\,\\bar{\\rho}}{k^{2}}\\sin(kx) + C_{2}\n$$\n接下来，我们应用势在箱体体积 $V=L^{3}$ 上的空间平均值为零的条件：$\\langle \\phi \\rangle = 0$。\n$$\n\\langle \\phi \\rangle = \\frac{1}{L^{3}}\\int_{0}^{L}\\int_{0}^{L}\\int_{0}^{L} \\phi(x) \\,dx\\,dy\\,dz = 0\n$$\n由于 $\\phi(x)$ 不依赖于 $y$ 或 $z$，对这些坐标的积分是平凡的：\n$$\n\\frac{1}{L^{3}} \\left( \\int_{0}^{L} dy \\right) \\left( \\int_{0}^{L} dz \\right) \\left( \\int_{0}^{L} \\phi(x) \\,dx \\right) = \\frac{L^{2}}{L^{3}} \\int_{0}^{L} \\phi(x) \\,dx = \\frac{1}{L} \\int_{0}^{L} \\phi(x) \\,dx = 0\n$$\n代入 $\\phi(x)$ 的表达式：\n$$\n\\frac{1}{L} \\int_{0}^{L} \\left(-\\frac{4\\pi G\\,a^{2}\\,\\bar{\\rho}}{k^{2}}\\sin(kx) + C_{2}\\right) dx = 0\n$$\n$$\n-\\frac{4\\pi G\\,a^{2}\\,\\bar{\\rho}}{k^{2}L} \\int_{0}^{L} \\sin(kx)\\,dx + \\frac{1}{L} \\int_{0}^{L} C_{2}\\,dx = 0\n$$\n第一个积分为零，因为 $k = 2\\pi n/L$ 且 $n \\neq 0$：\n$$\n\\int_{0}^{L}\\sin\\left(\\frac{2\\pi n}{L}x\\right)dx = \\left[-\\frac{L}{2\\pi n}\\cos\\left(\\frac{2\\pi n}{L}x\\right)\\right]_{0}^{L} = -\\frac{L}{2\\pi n}(\\cos(2\\pi n) - \\cos(0)) = -\\frac{L}{2\\pi n}(1-1) = 0\n$$\n第二个积分为 $\\int_{0}^{L} C_{2}\\,dx = C_{2}L$。因此，平均值方程变为：\n$$\n0 + \\frac{1}{L}(C_{2}L) = C_{2} = 0\n$$\n因此，两个积分常数都为零，特引力势的唯一解为：\n$$\n\\phi(\\boldsymbol{x}) = -\\frac{4\\pi G\\,a^{2}\\,\\bar{\\rho}}{k^{2}}\\sin(kx)\n$$\n现在，我们确定特引力加速度场 $\\boldsymbol{a}(\\boldsymbol{x})$：\n$$\n\\boldsymbol{a}(\\boldsymbol{x}) = -\\frac{1}{a}\\nabla\\phi(\\boldsymbol{x})\n$$\n我们需要计算 $\\phi(\\boldsymbol{x})$ 的梯度。由于 $\\phi$ 只依赖于 $x$，其梯度为：\n$$\n\\nabla\\phi(\\boldsymbol{x}) = \\left( \\frac{\\partial\\phi}{\\partial x}, \\frac{\\partial\\phi}{\\partial y}, \\frac{\\partial\\phi}{\\partial z} \\right) = \\left( \\frac{d\\phi}{dx}, 0, 0 \\right)\n$$\n关于 $x$ 的导数是：\n$$\n\\frac{d\\phi}{dx} = \\frac{d}{dx}\\left(-\\frac{4\\pi G\\,a^{2}\\,\\bar{\\rho}}{k^{2}}\\sin(kx)\\right) = -\\frac{4\\pi G\\,a^{2}\\,\\bar{\\rho}}{k^{2}} \\cdot k\\cos(kx) = -\\frac{4\\pi G\\,a^{2}\\,\\bar{\\rho}}{k}\\cos(kx)\n$$\n所以，$\\nabla\\phi(\\boldsymbol{x}) = \\left(-\\frac{4\\pi G\\,a^{2}\\,\\bar{\\rho}}{k}\\cos(kx), 0, 0\\right)$。\n将此代入加速度的表达式中：\n$$\n\\boldsymbol{a}(\\boldsymbol{x}) = -\\frac{1}{a} \\left(-\\frac{4\\pi G\\,a^{2}\\,\\bar{\\rho}}{k}\\cos(kx), 0, 0\\right) = \\left(\\frac{4\\pi G\\,a\\,\\bar{\\rho}}{k}\\cos(kx), 0, 0\\right)\n$$\n特引力加速度的分量是：\n$$\na_{x}(\\boldsymbol{x}) = \\frac{4\\pi G\\,a\\,\\bar{\\rho}}{k}\\cos(kx)\n$$\n$$\na_{y}(\\boldsymbol{x}) = 0\n$$\n$$\na_{z}(\\boldsymbol{x}) = 0\n$$\n我们现在已经找到了势和加速度三个分量的闭合形式表达式。", "answer": "$$\n\\boxed{\\begin{pmatrix} -\\frac{4\\pi G a^{2} \\bar{\\rho}}{k^{2}} \\sin(kx)  \\frac{4\\pi G a \\bar{\\rho}}{k} \\cos(kx)  0  0 \\end{pmatrix}}\n$$", "id": "3500379"}, {"introduction": "理解了密度如何产生引力之后，我们进而研究粒子在引力场中的运动及其导致的结构增长。本练习聚焦于引力坍缩过程中的一个关键概念——“壳层穿越”（shell crossing），它标志着简单流体描述的失效和多流区域的形成，是无碰撞系统独有的重要特征。通过比较“冷”尘埃模型和包含速度弥散的“温”模型，我们将深入理解速度弥散如何提供压力支持以抵抗引力坍缩，这对于理解冷暗物质和温暗物质的结构形成差异至关重要。", "problem": "考虑一个在一维 (1D) 静态牛顿背景下的无碰撞自引力介质，其平均质量密度为均匀的 $\\,\\rho_{0}\\,$。其相空间动力学由 Vlasov-Poisson (VP) 方程组控制，分布函数 $\\,f(x,v,t)\\,$ 满足 $\\,\\partial_{t} f + v\\,\\partial_{x} f - \\partial_{x} \\phi\\,\\partial_{v} f = 0\\,$，引力势 $\\,\\phi(x,t)\\,$ 由 $\\,\\partial_{x}^{2}\\phi = 4\\pi G\\left(\\int f\\,\\mathrm{d}v - \\rho_{0}\\right)\\,$ 确定，其中 $\\,G\\,$ 是牛顿引力常数。假设系统在 $\\,t=0\\,$ 时处于一个近冷状态，具有一个标准差为 $\\,\\sigma_{v}\\,$ 的窄麦克斯韦速度弥散，以及一个单模正弦拉格朗日位移\n$$\ns(q) \\equiv -\\frac{A}{k}\\,\\sin(k q),\n$$\n对于拉格朗日坐标 $\\,q\\,$，其振幅为 $A \\in (0,1)$，波数为 $k>0$。欧拉位置映射为 $\\,x(q,t) = q + D(t)\\,s(q)\\,$，其中 $\\,D(t)\\,$ 是该模式的位移增长因子。最早的“壳层穿越”定义为第一个使得拉格朗日到欧拉的雅可比行列式\n$$\nJ(q,t) \\equiv \\frac{\\partial x}{\\partial q} = 1 + D(t)\\,s'(q)\n$$\n在 $\\,q\\,$ 的某个位置上为零的时间 $\\,t\\,$。\n\n您将对两种动力学进行建模和比较：\n\n- 尘埃模型（速度弥散为零），通过采用单动能分布 $\\,f(x,v,t) = \\rho(x,t)\\,\\delta\\!\\left(v-u(x,t)\\right)\\,$ 得到，这会产生无压流体矩系统。在 $\\,\\rho=\\rho_{0}\\,$ 和 $\\,u=0\\,$ 周围线性化其动力学，并针对波数为 $\\,k\\,$ 的单一傅里叶模式，在位移增长因子 $\\,D(t)\\,$ 的层面上进行研究。施加物理上合理的种子初始条件 $\\,D(0)=0\\,$ 和 $\\,\\dot{D}(0)=1\\,$。\n\n- 一种有限弥散的 Vlasov 估计，通过使用有效各向同性压力 $\\,P=\\rho\\,\\sigma_{v}^{2}\\,$（$\\,\\sigma_{v}\\,$ 为常数）在二阶上闭合流体矩得到，并在 $\\,\\rho=\\rho_{0}\\,$ 和 $\\,u=0\\,$ 周围进行线性化。再次在相同的初始条件 $\\,D_{\\sigma}(0)=0\\,$ 和 $\\,\\dot{D}_{\\sigma}(0)=1\\,$ 下，使用单模位移增长因子 $\\,D_{\\sigma}(t)\\,$ 进行研究。假设处于亚 Jeans 区域 $\\sigma_{v}^{2} k^{2}  4\\pi G \\rho_{0}$，以便发生增长。\n\n仅从 VP 方程组、Poisson 方程和流体矩定义出发，推导 $\\,D(t)\\,$ 和 $\\,D_{\\sigma}(t)\\,$ 的线性演化方程。使用这些方程求出壳层穿越时间 $\\,t_{\\mathrm{sc}}^{\\mathrm{dust}}\\,$ 和 $\\,t_{\\mathrm{sc}}^{\\sigma}\\,$，该时间定义为使得 $\\,\\min_{q} J(q,t)=0\\,$ 的最早时间 $\\,t0\\,$。然后，提供比率\n$$\nR \\equiv \\frac{t_{\\mathrm{sc}}^{\\sigma}}{t_{\\mathrm{sc}}^{\\mathrm{dust}}}\n$$\n的精确闭合形式解析表达式，用 $\\,G\\,$, $\\,\\rho_{0}\\,$, $\\,\\sigma_{v}\\,$, $\\,k\\,$ 和 $\\,A\\,$ 表示。不代入任何数值。将最终答案表示为单一的解析表达式；无需单位，因为 $\\,R\\,$ 是无量纲的。", "solution": "首先验证问题，发现其是适定的且科学上合理的，允许进行完整求解。推导过程首先从 Vlasov-Poisson 方程组建立流体矩方程，然后针对所要求的两种模型（尘埃模型和有限弥散模型）将其特殊化和线性化。推导并求解各自的增长因子演化方程，从而得到壳层穿越时间，并最终得到它们的比率。\n\n相空间动力学由 Vlasov-Poisson 方程组控制：\n$$\n\\partial_{t} f + v\\,\\partial_{x} f - (\\partial_{x} \\phi)\\,\\partial_{v} f = 0\n$$\n$$\n\\partial_{x}^{2}\\phi = 4\\pi G\\left(\\int f\\,\\mathrm{d}v - \\rho_{0}\\right)\n$$\n我们定义流体矩：质量密度 $\\rho(x,t) = \\int f(x,v,t)\\,\\mathrm{d}v$ 和体速度 $u(x,t) = \\frac{1}{\\rho}\\int v f(x,v,t)\\,\\mathrm{d}v$。\n\n将 Vlasov 方程对所有速度 $v$ 积分，假设当 $|v| \\to \\infty$ 时 $f \\to 0$，得到连续性方程：\n$$\n\\partial_{t} \\rho + \\partial_{x}(\\rho u) = 0\n$$\n将 Vlasov 方程乘以 $v$ 并积分，得到动量（Euler-Jeans）方程：\n$$\n\\partial_t (\\rho u) + \\partial_x (\\rho \\langle v^2 \\rangle) + \\rho \\partial_x \\phi = 0\n$$\n其中 $\\langle v^2 \\rangle = \\frac{1}{\\rho}\\int v^2 f\\,\\mathrm{d}v$。我们将速度弥散的平方定义为 $\\sigma_v^2 = \\langle(v-u)^2\\rangle = \\langle v^2 \\rangle - u^2$。压力定义为 $P = \\rho \\sigma_v^2$。动量方程可以写成：\n$$\n\\rho(\\partial_t u + u \\partial_x u) = -\\partial_x P - \\rho \\partial_x \\phi\n$$\n\n对壳层穿越的分析始于拉格朗日到欧拉映射的雅可比行列式 $J(q,t) = \\frac{\\partial x}{\\partial q}$。给定 $x(q,t) = q + D(t)s(q)$ 和 $s(q) = -\\frac{A}{k}\\sin(kq)$，雅可比行列式为：\n$$\nJ(q,t) = 1 + D(t)s'(q) = 1 - A D(t) \\cos(kq)\n$$\n壳层穿越发生在第一个使得对于某个 $q$ 有 $J(q,t)=0$ 的时间 $t  0$。这个条件首先在第二项为最大负值时满足，即，在 $\\cos(kq) = 1$ 的位置 $q$ 处。因此，壳层穿越的条件是：\n$$\n1 - A D(t_{\\mathrm{sc}}) = 0 \\implies D(t_{\\mathrm{sc}}) = \\frac{1}{A}\n$$\n这个条件对两个模型是相同的；只有 $D(t)$ 的函数形式会不同。\n\n**1. 尘埃模型 ($\\sigma_v = 0$)**\n在尘埃模型中，速度弥散为零，因此压力 $P=0$。关于静态背景 ($\\rho_0, u=0$) 的扰动 $\\delta\\rho = \\rho - \\rho_0$、$u_1=u$ 和 $\\phi_1=\\phi$ 的线性化流体方程为：\n1. 连续性方程： $\\partial_t \\delta\\rho + \\rho_0 \\partial_x u_1 = 0$\n2. 欧拉方程： $\\rho_0 \\partial_t u_1 = -\\rho_0 \\partial_x \\phi_1$\n3. 泊松方程： $\\partial_x^2 \\phi_1 = 4\\pi G \\delta\\rho$\n\n结合这些方程，我们对 (1) 式求时间导数，对 (2) 式求空间导数：\n$$\n\\partial_t^2 \\delta\\rho + \\rho_0 \\partial_x \\partial_t u_1 = 0\n$$\n$$\n\\partial_x \\partial_t u_1 = -\\partial_x^2 \\phi_1\n$$\n将 (3) 式代入第二个方程得到 $\\partial_x \\partial_t u_1 = -4\\pi G \\delta\\rho$。将此结果代回第一个方程得到：\n$$\n\\partial_t^2 \\delta\\rho_1 - 4\\pi G \\rho_0 \\delta\\rho_1 = 0\n$$\n密度扰动与位移增长因子 $D(t)$ 相关。根据质量守恒，$\\rho_0 \\mathrm{d}q = \\rho(x,t) \\mathrm{d}x$，所以 $\\rho = \\rho_0 J^{-1} = \\rho_0 (1 - A D(t) \\cos(kq))^{-1}$。到线性阶，$\\delta\\rho = \\rho-\\rho_0 \\approx \\rho_0 A D(t) \\cos(kq)$。由于 $\\delta\\rho$ 与 $D(t)$ 成正比，$D(t)$ 的单一模式也必须满足相同的微分方程。\n令 $\\omega_J^2 = 4\\pi G \\rho_0$。增长因子 $D(t)$ 的演化方程为：\n$$\n\\ddot{D}(t) - \\omega_J^2 D(t) = 0\n$$\n通解为 $D(t) = c_1 \\cosh(\\omega_J t) + c_2 \\sinh(\\omega_J t)$。应用初始条件 $D(0)=0$ 和 $\\dot D(0)=1$：\n$D(0) = c_1 = 0$.\n$\\dot D(t) = c_2 \\omega_J \\cosh(\\omega_J t) \\implies \\dot D(0) = c_2 \\omega_J = 1 \\implies c_2 = 1/\\omega_J$.\n因此，对于尘埃模型，增长因子为：\n$$\nD(t) = \\frac{1}{\\omega_J} \\sinh(\\omega_J t)\n$$\n壳层穿越时间 $t_{\\mathrm{sc}}^{\\mathrm{dust}}$ 通过求解 $D(t_{\\mathrm{sc}}^{\\mathrm{dust}}) = 1/A$ 得到：\n$$\n\\frac{1}{\\omega_J} \\sinh(\\omega_J t_{\\mathrm{sc}}^{\\mathrm{dust}}) = \\frac{1}{A} \\implies t_{\\mathrm{sc}}^{\\mathrm{dust}} = \\frac{1}{\\omega_J} \\operatorname{arcsinh}\\left(\\frac{\\omega_J}{A}\\right)\n$$\n\n**2. 有限弥散模型 ($P = \\rho \\sigma_v^2$)**\n对于这个模型，压力项不为零。线性化的压力扰动为 $P_1 = \\delta\\rho \\sigma_v^2$。线性化的欧拉方程变为：\n$$\n\\rho_0 \\partial_t u_1 = -\\partial_x P_1 - \\rho_0\\partial_x \\phi_1 = -\\sigma_v^2 \\partial_x \\delta\\rho - \\rho_0 \\partial_x \\phi_1\n$$\n遵循与之前相同的步骤，我们将其与线性化的连续性方程和泊松方程结合：\n$$\n\\partial_t^2 \\delta\\rho + \\rho_0 \\partial_x \\partial_t u_1 = \\partial_t^2 \\delta\\rho + \\partial_x ( -\\sigma_v^2 \\partial_x \\delta\\rho - \\rho_0 \\partial_x \\phi_1) = 0\n$$\n$$\n\\partial_t^2 \\delta\\rho - \\sigma_v^2 \\partial_x^2 \\delta\\rho - \\rho_0 \\partial_x^2 \\phi_1 = 0\n$$\n使用泊松方程 $\\partial_x^2 \\phi_1 = 4\\pi G \\delta\\rho$，我们得到：\n$$\n\\partial_t^2 \\delta\\rho - \\sigma_v^2 \\partial_x^2 \\delta\\rho - 4\\pi G \\rho_0 \\delta\\rho = 0\n$$\n我们考虑一个波数为 $k$ 的单一傅里叶模式，因此 $\\delta\\rho \\propto \\cos(kx)$ 或 $\\exp(ikx)$，对于它有 $\\partial_x^2 \\delta\\rho_k = -k^2 \\delta\\rho_k$。模式振幅的方程变为：\n$$\n\\ddot{\\delta\\rho_k} - \\sigma_v^2 (-k^2) \\delta\\rho_k - 4\\pi G \\rho_0 \\delta\\rho_k = 0 \\implies \\ddot{\\delta\\rho_k} - (4\\pi G \\rho_0 - \\sigma_v^2 k^2) \\delta\\rho_k = 0\n$$\n由于 $\\delta\\rho_k$ 与 $D_\\sigma(t)$ 成正比，增长因子 $D_\\sigma(t)$ 遵循相同的方程。我们定义 $\\omega_{\\sigma}^2 = 4\\pi G \\rho_0 - \\sigma_v^2 k^2 = \\omega_J^2 - \\sigma_v^2 k^2$。问题假设处于亚 Jeans 区域，即 $\\sigma_v^2 k^2  4\\pi G \\rho_0$，这确保了 $\\omega_{\\sigma}^2 > 0$ 并因此产生引力不稳定性。演化方程是：\n$$\n\\ddot{D}_{\\sigma}(t) - \\omega_{\\sigma}^2 D_{\\sigma}(t) = 0\n$$\n这个方程与尘埃模型具有相同的形式，只是将 $\\omega_J$ 替换为 $\\omega_{\\sigma}$。使用相同的初始条件 $D_{\\sigma}(0)=0$ 和 $\\dot{D}_{\\sigma}(0)=1$，解为：\n$$\nD_{\\sigma}(t) = \\frac{1}{\\omega_{\\sigma}} \\sinh(\\omega_{\\sigma} t)\n$$\n壳层穿越时间 $t_{\\mathrm{sc}}^{\\sigma}$ 通过求解 $D_{\\sigma}(t_{\\mathrm{sc}}^{\\sigma}) = 1/A$ 得到：\n$$\n\\frac{1}{\\omega_{\\sigma}} \\sinh(\\omega_{\\sigma} t_{\\mathrm{sc}}^{\\sigma}) = \\frac{1}{A} \\implies t_{\\mathrm{sc}}^{\\sigma} = \\frac{1}{\\omega_{\\sigma}} \\operatorname{arcsinh}\\left(\\frac{\\omega_{\\sigma}}{A}\\right)\n$$\n\n**3. 壳层穿越时间的比率**\n比率 $R$ 定义为 $R \\equiv t_{\\mathrm{sc}}^{\\sigma} / t_{\\mathrm{sc}}^{\\mathrm{dust}}$。代入我们推导出的表达式：\n$$\nR = \\frac{\\frac{1}{\\omega_{\\sigma}} \\operatorname{arcsinh}\\left(\\frac{\\omega_{\\sigma}}{A}\\right)}{\\frac{1}{\\omega_J} \\operatorname{arcsinh}\\left(\\frac{\\omega_J}{A}\\right)} = \\frac{\\omega_J}{\\omega_{\\sigma}} \\frac{\\operatorname{arcsinh}\\left(\\frac{\\omega_{\\sigma}}{A}\\right)}{\\operatorname{arcsinh}\\left(\\frac{\\omega_J}{A}\\right)}\n$$\n代入定义式 $\\omega_J = \\sqrt{4\\pi G \\rho_0}$ 和 $\\omega_{\\sigma} = \\sqrt{4\\pi G \\rho_0 - \\sigma_v^2 k^2}$：\n$$\nR = \\frac{\\sqrt{4\\pi G \\rho_0}}{\\sqrt{4\\pi G \\rho_0 - \\sigma_v^2 k^2}} \\frac{\\operatorname{arcsinh}\\left(\\frac{\\sqrt{4\\pi G \\rho_0 - \\sigma_v^2 k^2}}{A}\\right)}{\\operatorname{arcsinh}\\left(\\frac{\\sqrt{4\\pi G \\rho_0}}{A}\\right)}\n$$\n这是该比率关于给定参数的最终闭合形式表达式。速度弥散起到压力的作用，减缓了引力坍缩，这导致了更长的壳层穿越时间（$R1$）。", "answer": "$$\\boxed{\\frac{\\sqrt{4\\pi G \\rho_{0}}}{\\sqrt{4\\pi G \\rho_{0} - \\sigma_{v}^{2} k^{2}}} \\frac{\\operatorname{arcsinh}\\left(\\frac{\\sqrt{4\\pi G \\rho_{0} - \\sigma_{v}^{2} k^{2}}}{A}\\right)}{\\operatorname{arcsinh}\\left(\\frac{\\sqrt{4\\pi G \\rho_{0}}}{A}\\right)}}$$", "id": "3500416"}, {"introduction": "前面的解析练习为我们进行完整的数值模拟奠定了基础。在这个综合性的实践中，我们将运用粒子-网格（Particle-Mesh, PM）方法，构建一个一维弗拉索夫-泊松方程求解器，以模拟一个密度微扰的非线性演化过程。我们的目标不止于观察系统的演化，更将采用一种先进的分析技术：通过测量粗粒化熵的增长，来量化相空间混合的程度，并估算由此产生的精细纤维状结构的特征尺度。这项练习将数值模拟与统计物理的深刻概念联系起来，揭示了无碰撞系统演化的复杂性与内在规律。", "problem": "您需要编写一个完整、可运行的程序，该程序从一维空间中具有周期性边界条件的无碰撞物质的Vlasov-Poisson系统第一性原理离散化出发，模拟高斯滤波下的相混合和粗粒化熵的增长。您将通过分析熵如何随高斯滤波器宽度的变化而变化，来量化粗粒化吉布斯熵，并提取相空间中的特征丝状结构尺度。\n\n从以下基本和核心定义开始。\n\n- 相空间分布：令 $f(x,v,t)$ 为单粒子分布函数，其归一化使得 $\\int f(x,v,t)\\,dx\\,dv = 1$。在无碰撞极限下，$f$ 满足Vlasov方程\n$$\n\\frac{\\partial f}{\\partial t} + v\\frac{\\partial f}{\\partial x} - \\frac{\\partial \\Phi}{\\partial x}\\frac{\\partial f}{\\partial v} = 0,\n$$\n其中 $\\Phi(x,t)$ 是引力势。\n\n- 势 $\\Phi$ 由一维空间中具有周期性边界条件和零均值密度扰动的泊松方程确定：\n$$\n\\frac{\\partial^2 \\Phi}{\\partial x^2} = 4\\pi G \\left[\\rho(x,t) - \\bar \\rho\\right], \\quad \\rho(x,t)=\\int f(x,v,t)\\,dv,\n$$\n其中 $\\bar\\rho$ 是空间平均密度。使用无量纲单位，域长度 $L=1$，并设 $4\\pi G=1$，因此泊松方程为\n$$\n\\frac{\\partial^2 \\Phi}{\\partial x^2} = \\rho(x,t) - \\bar \\rho.\n$$\n\n- 粗粒化熵：给定一个在下述适当缩放的无量纲相空间坐标系中应用的具有各向同性宽度 $\\epsilon$ 的高斯滤波器，定义粗粒化分布 $\\bar f_\\epsilon$ 和粗粒化吉布斯熵\n$$\nS_\\epsilon \\equiv -\\int \\bar f_\\epsilon(\\xi,\\eta,t)\\,\\ln \\bar f_\\epsilon(\\xi,\\eta,t)\\,d\\xi\\,d\\eta.\n$$\n\n您的程序必须实现以下任务集，以保持在不同语言和环境下的通用性和可测试性。\n\n1) 模拟模型和数值方法\n\n- 使用Particle-Mesh (PM)方法（首次使用时定义为Particle-Mesh (PM)）在一维空间 $x\\in [0,1)$ 中演化具有周期性边界条件的系统，以近似无碰撞物质的自洽引力场。用 $N_p$ 个等质量的模拟粒子表示无碰撞分布 $f(x,v,t)$，这些粒子具有位置 $x_i(t)$ 和速度 $v_i(t)$。\n\n- 使用Cloud-In-Cell (CIC)分配方法在具有 $N_x$ 个单元的均匀网格上计算密度。使用快速傅里叶变换 (FFT，定义为Fast Fourier Transform (FFT)) 和谱恒等式 $\\widehat{\\partial_x^2 \\Phi}(k) = -(2\\pi k)^2 \\widehat{\\Phi}(k)$ 在傅里叶空间中求解泊松方程，并设置 $\\widehat{\\Phi}(0)=0$。通过 $a(x) = -\\partial_x \\Phi$ 以谱方法计算加速度。使用CIC将加速度插值回粒子。使用二阶辛 (蛙跳) 格式推进粒子。\n\n- 初始条件：在 $[0,1)$ 上均匀采样初始拉格朗日坐标 $q_i$，并设置\n$$\nx_i(0) = \\left[q_i + \\frac{A}{2\\pi}\\sin(2\\pi q_i)\\right] \\bmod 1,\n$$\n初始速度 $v_i(0)$ 从标准差为 $\\sigma_v$ 的零均值正态分布中抽取。这提供了一个在自引力下坍缩的单模扰动。\n\n- 单位：所有量均为无量纲，其中 $L=1$，$4\\pi G=1$，总质量归一化为 $1$。时间 $t$ 采用由这些归一化所隐含的动力学单位。如果出现任何角度，必须以弧度解释。\n\n2) 粗粒化和熵\n\n- 在演化到指定时间 $t=t_{\\mathrm{end}}$ 后，将粒子相空间位置映射到一个缩放的单位正方形 $(\\xi,\\eta)\\in [0,1]\\times [0,1]$，具体如下：设 $\\xi=x$，并确定一个对称的速度范围 $[-V_{\\max},V_{\\max}]$，其中 $V_{\\max}$ 选择为速度标准差的倍数 $V_{\\max}=\\alpha \\sqrt{\\langle v^2\\rangle}$，$\\alpha>0$ 为固定常数因子。然后映射 $\\eta = (v+V_{\\max})/(2V_{\\max})$ 并将 $\\eta$ 的值裁剪到 $[0,1]$。\n\n- 使用二维直方图在具有 $N_\\xi\\times N_\\eta$ 个单元的规则网格上估计连续密度 $f(\\xi,\\eta,t_{\\mathrm{end}})$。通过以下方式将计数 $n_{ij}$ 转换为连续密度\n$$\nf_{ij} = \\frac{n_{ij}}{N_p\\,\\Delta \\xi\\,\\Delta \\eta},\n$$\n其中 $\\Delta \\xi = 1/N_\\xi$ 和 $\\Delta\\eta = 1/N_\\eta$，使得 $\\sum_{ij} f_{ij}\\,\\Delta\\xi\\,\\Delta\\eta \\approx 1$。\n\n- 在 $(\\xi,\\eta)$ 中定义高斯滤波器为\n$$\nG_\\epsilon(\\Delta \\xi,\\Delta \\eta) = \\frac{1}{2\\pi \\epsilon^2}\\exp\\left[-\\frac{\\Delta \\xi^2+\\Delta \\eta^2}{2\\epsilon^2}\\right],\n$$\n并通过卷积计算 $\\bar f_\\epsilon = f \\star G_\\epsilon$。使用约定 $\\mathcal{F}\\{G_\\epsilon\\}(k_\\xi,k_\\eta) = \\exp\\left[-2\\pi^2\\epsilon^2\\left(k_\\xi^2+k_\\eta^2\\right)\\right]$，在傅里叶空间中用FFT高效地实现卷积，其中 $k_\\xi$ 和 $k_\\eta$ 是单位区间内每周期傅里叶频率。确保 $\\bar f_\\epsilon$ 的数值非负性，如果需要，进行重新归一化，以使积分在机器精度内保持为1。\n\n- 计算每个滤波器宽度的粗粒化熵：\n$$\nS_\\epsilon = -\\sum_{i,j} \\bar f_{\\epsilon,ij}\\,\\ln \\bar f_{\\epsilon,ij}\\,\\Delta\\xi\\,\\Delta\\eta,\n$$\n使用约定，即当 $\\bar f_{\\epsilon,ij}=0$ 时，该项贡献为 $0$。\n\n3) 从熵产生中估计丝状结构尺度\n\n- 给定一组滤波器宽度 $\\{\\epsilon_\\ell\\}$，其范围从小到中等平滑尺度，计算 $S_{\\epsilon_\\ell}$ 并使用有限差分格式在 $\\ln \\epsilon$ 网格上近似导数 $dS_\\epsilon/d\\ln \\epsilon$。定义一个阈值分数 $\\tau\\in (0,1)$，并将特征丝状结构尺度 $\\epsilon_\\star$ 定义为超过 $dS_\\epsilon/d\\ln \\epsilon$ 最大值位置的最小滤波器宽度，在该宽度下 $dS_\\epsilon/d\\ln \\epsilon \\le \\tau \\max_\\ell dS_{\\epsilon_\\ell}/d\\ln \\epsilon$。如果集合中不存在这样的宽度，则取 $\\epsilon_\\star$ 为测试的最大 $\\epsilon$。\n\n4) 测试套件\n\n您的程序必须运行以下三种情况（每种情况指定 $(A,\\sigma_v,t_{\\mathrm{end}})$），所有情况在其他方面使用相同的数值参数：\n\n- 情况 1（正常路径）：$(A,\\sigma_v,t_{\\mathrm{end}}) = (0.1, 0.02, 1.0)$。\n\n- 情况 2（更强、更冷的坍缩）：$(A,\\sigma_v,t_{\\mathrm{end}}) = (0.2, 0.0, 1.2)$。\n\n- 情况 3（早期边界）：$(A,\\sigma_v,t_{\\mathrm{end}}) = (0.1, 0.01, 0.1)$。\n\n对于所有情况，使用 $N_p=2000$ 个粒子，一个具有 $N_x=256$ 个单元的PM网格，以及时间步长为 $\\Delta t = 0.002$ 的蛙跳格式，使得步数为 $t_{\\mathrm{end}}/\\Delta t$ 四舍五入到最近的整数。对于粗粒化，使用 $(N_\\xi,N_\\eta)=(128,128)$，选择 $V_{\\max}=\\alpha \\sqrt{\\langle v^2\\rangle}$，其中 $\\alpha=5$，并在 $\\epsilon \\in [5\\times 10^{-3}, 1.5\\times 10^{-1}]$ 的对数间隔网格上评估 $S_\\epsilon$，该网格至少有 $10$ 个不同的值。使用阈值 $\\tau=0.2$ 来确定 $\\epsilon_\\star$。\n\n5) 最终输出格式\n\n您的程序应生成单行输出，其中包含三个测试用例的三个 $\\epsilon_\\star$ 结果值，格式为逗号分隔的Python风格列表，例如，\"[result1,result2,result3]\"。每个结果必须是浮点数。不得有其他打印输出。\n\n在上述公式中，所有量都是无量纲的，并且必须以无量纲数的形式报告。不需要进行物理单位转换。在适用的情况下，角度以弧度为单位。在分析过程中逻辑上考虑的任何百分比，必须在内部表示为小数或分数，而不是以百分号打印。", "solution": "我们从相空间分布 $f(x,v,t)$ 的无碰撞玻尔兹曼方程开始，该方程通常称为Vlasov方程，\n$$\n\\frac{\\partial f}{\\partial t} + v\\frac{\\partial f}{\\partial x} - \\frac{\\partial \\Phi}{\\partial x}\\frac{\\partial f}{\\partial v} = 0,\n$$\n以及引力势 $\\Phi(x,t)$ 的泊松方程，\n$$\n\\frac{\\partial^2 \\Phi}{\\partial x^2} = \\rho(x,t) - \\bar \\rho,\\quad \\rho(x,t)=\\int f(x,v,t)\\,dv,\n$$\n在单位制中 $4\\pi G=1$，域长 $L=1$ 并具有周期性边界条件。Vlasov方程表示相空间中的哈密顿平流。沿着特征线 $(x(t),v(t))$，$f$ 是守恒的，细粒化吉布斯熵\n$$\nS_{\\mathrm{fine}} = -\\int f\\ln f\\,dx\\,dv\n$$\n不随时间变化。然而，相混合形成的精细丝状结构导致 $f$ 中出现越来越精细的结构，这些结构无法通过有限分辨率的测量来解析。在使用宽度为 $\\epsilon$ 的平滑核进行粗粒化后，粗粒化分布 $\\bar f_\\epsilon$ 遵循 $S_\\epsilon \\equiv -\\int \\bar f_\\epsilon \\ln \\bar f_\\epsilon\\,dx\\,dv \\ge S_{\\mathrm{fine}}$，这是由于函数 $x\\mapsto x\\ln x$ 的严格凸性和应用于线性卷积算子的詹森不等式。当 $\\epsilon$ 增加到超过相空间中特征丝状结构宽度时，$S_\\epsilon$ 增加；增加率 $dS_\\epsilon/d\\ln \\epsilon$ 在滤波器开始合并跨越丝状结构尺度的 $f$ 的反号梯度处最大。因此，$dS_\\epsilon/d\\ln \\epsilon$ 下降到其峰值的一小部分的位置，为丝状结构尺度提供了一个稳健的代理。\n\n基于第一性原理的算法设计如下。\n\n1) Particle-Mesh (PM) 演化和蛙跳法\n\n- 粒子：设 $N_p$ 个等质量粒子携带总单位质量，即 $m=1/N_p$。为了产生一个会坍缩的动力学不稳定构型，我们初始化粒子的位置为\n$$\nx_i(0) = \\left[q_i + \\frac{A}{2\\pi}\\sin(2\\pi q_i)\\right] \\bmod 1,\n$$\n其中 $q_i$ 在 $[0,1)$ 上均匀采样，初始速度 $v_i(0)$ 从标准差为 $\\sigma_v$ 的高斯分布（零均值）中抽取。这在周期性域上实现了一个单模超密度，并引发了自引力下的坍缩。该映射是一种保持粒子标记的拉格朗日扰动，初始的 $f$ 是 $v$ 空间中的一个窄水袋模型。\n\n- 网格沉积：将空间域离散化为 $N_x$ 个宽度为 $\\Delta x = 1/N_x$ 的均匀单元。通过Cloud-In-Cell (CIC)将粒子质量沉积到网格上，该方法 conserving 质量并生成在单元中心定义的连续密度场 $\\rho_j$。具体来说，对于位于位置 $x$ 的粒子，计算左侧单元索引 $i=\\lfloor x/\\Delta x\\rfloor$ 和权重 $w=(x/\\Delta x - i)$；将 $(1-w)m$ 沉积到单元 $i$，将 $wm$ 沉积到单元 $(i+1)\\bmod N_x$。然后通过除以单元宽度将单元质量转换为密度，$\\rho_j = M_j/\\Delta x$。平均密度为 $\\bar \\rho = 1$。\n\n- 通过FFT求解泊松方程：对零均值密度扰动 $\\delta \\rho(x) \\equiv \\rho(x) - \\bar \\rho$ 进行傅里叶变换得到 $\\widehat{\\delta\\rho}(k)$。在FFT使用核 $e^{-2\\pi i k x}$ 的约定下，谱泊松方程为 $-(2\\pi k)^2 \\widehat{\\Phi}(k) = \\widehat{\\delta\\rho}(k)$，所以\n$$\n\\widehat{\\Phi}(k) = -\\frac{\\widehat{\\delta\\rho}(k)}{(2\\pi k)^2},\\quad \\widehat{\\Phi}(0)=0.\n$$\n以谱方法计算加速度 $\\widehat{a}(k) = - (2\\pi i k)\\,\\widehat{\\Phi}(k)$，并进行傅里叶逆变换得到网格上的 $a(x)$。使用相同的CIC格式将 $a(x)$ 插值回粒子位置以保持动量。\n\n- 时间积分：使用时间步长为 $\\Delta t$ 的二阶辛蛙跳（踢-漂-踢）格式：\n  - 踢：$v^{n+1/2} = v^n + (\\Delta t/2)\\,a(x^n)$。\n  - 漂：$x^{n+1} = x^n + \\Delta t\\,v^{n+1/2}$，周期性地卷绕到 $[0,1)$。\n  - 重新计算 $a(x^{n+1})$。\n  - 踢：$v^{n+1} = v^{n+1/2} + (\\Delta t/2)\\,a(x^{n+1})$。\n该方法全局上保持相空间结构，并准确地捕捉了所选单位制下的无碰撞动力学。\n\n2) 粗粒化和熵\n\n- 缩放坐标：在时间 $t_{\\mathrm{end}}$，通过 $\\xi=x \\in [0,1)$ 和 $\\eta = (v+V_{\\max})/(2V_{\\max}) \\in [0,1]$ 构造 $(\\xi,\\eta)$，其中 $V_{\\max}=\\alpha \\sqrt{\\langle v^2\\rangle}$，$\\alpha=5$。将 $\\eta$ 裁剪到 $[0,1]$ 中，以便所有粒子都映射到单位正方形内。这种无量纲映射允许在 $(\\xi,\\eta)$ 平面上使用各向同性的高斯滤波器。\n\n- 直方图和密度：使用一个 $N_\\xi\\times N_\\eta$ 的直方图获得均匀网格上的计数 $n_{ij}$。通过 $f_{ij} = n_{ij}/(N_p\\,\\Delta \\xi\\,\\Delta \\eta)$ 转换为连续密度，其中 $\\Delta \\xi = 1/N_\\xi$ 和 $\\Delta \\eta=1/N_\\eta$，使得 $\\sum_{ij} f_{ij}\\,\\Delta \\xi\\,\\Delta\\eta \\approx 1$。这是对连续 $f(\\xi,\\eta)$ 的黎曼近似。\n\n- 高斯滤波：定义各向同性高斯核\n$$\nG_\\epsilon(\\Delta \\xi,\\Delta \\eta) = \\frac{1}{2\\pi \\epsilon^2}\\exp\\left[-\\frac{\\Delta \\xi^2+\\Delta \\eta^2}{2\\epsilon^2}\\right].\n$$\n在FFT约定 $e^{-2\\pi i k x}$ 下，使用傅里叶空间中的卷积，其变换为 $\\mathcal{F}\\{G_\\epsilon\\}(k_\\xi,k_\\eta) = \\exp\\left[-2\\pi^2 \\epsilon^2 (k_\\xi^2+k_\\eta^2)\\right]$。令 $\\widehat f(k_\\xi,k_\\eta)$ 为 $f$ 的FFT。然后通过在傅里叶空间中相乘来获得平滑场，\n$$\n\\widehat{\\bar f_\\epsilon}(k_\\xi,k_\\eta) = \\widehat f(k_\\xi,k_\\eta)\\,\\exp\\left[-2\\pi^2 \\epsilon^2 (k_\\xi^2+k_\\eta^2)\\right],\n$$\n并进行傅里叶逆变换。在归一化之前，将由数值伪影产生的微小负值裁剪到一个小的正底值。如果需要，重新归一化 $\\bar f_\\epsilon$ 以确保 $\\sum \\bar f_\\epsilon\\,\\Delta \\xi\\,\\Delta \\eta = 1$。\n\n- 熵：计算粗粒化吉布斯熵\n$$\nS_\\epsilon = -\\sum_{i,j} \\bar f_{\\epsilon,ij}\\,\\ln \\bar f_{\\epsilon,ij}\\,\\Delta\\xi\\,\\Delta\\eta,\n$$\n约定 $0\\ln 0=0$。这个黎曼和近似于连续积分。\n\n3) 从熵产生中估计丝状结构尺度\n\n当滤波器宽度 $\\epsilon$ 在对数网格上变化时，计算 $S_\\epsilon$ 并通过有限差分估计 $dS_\\epsilon/d\\ln \\epsilon$。由于凸性和丝状结构引起的混合，$S_\\epsilon$ 随 $\\epsilon$ 非递减，并且导数 $dS_\\epsilon/d\\ln\\epsilon$ 通常在特征丝状结构宽度附近出现一个峰值，然后当滤波器超过最小结构时衰减。我们操作上将 $\\epsilon_\\star$ 定义为超过 $dS_\\epsilon/d\\ln \\epsilon$ 最大值处的最小 $\\epsilon$，在该处斜率下降到其最大值的一小部分 $\\tau$：\n$$\n\\epsilon_\\star = \\min\\left\\{\\epsilon \\ge \\epsilon_{\\mathrm{peak}}:\\ \\frac{dS_\\epsilon}{d\\ln \\epsilon} \\le \\tau \\max_{\\epsilon'} \\frac{dS_{\\epsilon'}}{d\\ln \\epsilon'}\\right\\},\n$$\n其中 $\\tau=0.2$。如果集合中不包含这样的 $\\epsilon$，则取 $\\epsilon_\\star$ 为测试的最大宽度。\n\n4) 数值参数和测试套件\n\n我们使用 $N_p=2000$，$N_x=256$，以及蛙跳时间步长 $\\Delta t=0.002$；因此对于每种情况，步数是 $t_{\\mathrm{end}}/\\Delta t$ 四舍五入到最近的整数。对于粗粒化，$N_\\xi=N_\\eta=128$，速度范围的 $\\alpha=5$，以及在 $[5\\times 10^{-3}, 1.5\\times 10^{-1}]$ 范围内的一组10个对数间隔的 $\\epsilon$ 值。三个测试用例如下：\n\n- 情况 1：$(A,\\sigma_v,t_{\\mathrm{end}})=(0.1,0.02,1.0)$。\n\n- 情况 2：$(A,\\sigma_v,t_{\\mathrm{end}})=(0.2,0.0,1.2)$。\n\n- 情况 3：$(A,\\sigma_v,t_{\\mathrm{end}})=(0.1,0.01,0.1)$。\n\n5) 输出\n\n对于每种情况，计算定义的 $\\epsilon_\\star$ 并输出包含三个 $\\epsilon_\\star$ 值的单行，格式为Python风格列表，例如，\"[0.0123,0.0087,0.0456]\"。这些是与缩放的 $(\\xi,\\eta)$ 空间相关的无量纲数，并量化了从粗粒化熵产生推断的相空间丝状结构尺度。\n\n此设计遵循第一性原理：我们使用PM近似的Vlasov-Poisson系统在自引力下演化无碰撞物质，通过在无量纲缩放相空间中的各向同性高斯函数定义粗粒化，并通过 $dS_\\epsilon/d\\ln \\epsilon$ 的行为将熵产生与丝状结构尺度联系起来。数值选择是标准的、科学合理的，并以适度的成本产生了一个稳健、可测试的计算。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\n# Set a global random seed for reproducibility\nrng = np.random.default_rng(42)\n\ndef cic_deposit_1d(x, mass_per_particle, nx):\n    \"\"\"\n    Cloud-In-Cell deposition of particle masses onto a 1D grid.\n    x: particle positions in [0,1)\n    mass_per_particle: scalar mass for each particle\n    nx: number of grid cells\n    Returns mass per cell (not yet divided by cell width).\n    \"\"\"\n    dx = 1.0 / nx\n    # Compute left cell index and weight\n    gx = x * nx\n    i0 = np.floor(gx).astype(int) % nx\n    fx = gx - i0\n    # Initialize grid mass\n    mass_grid = np.zeros(nx, dtype=np.float64)\n    # Deposit to left and right cells\n    w_left = (1.0 - fx) * mass_per_particle\n    w_right = fx * mass_per_particle\n    # Use np.add.at for scatter add\n    np.add.at(mass_grid, i0, w_left)\n    np.add.at(mass_grid, (i0 + 1) % nx, w_right)\n    return mass_grid\n\ndef cic_interpolate_1d(x, grid_values):\n    \"\"\"\n    Cloud-In-Cell interpolation of grid values to particle positions.\n    x: particle positions in [0,1)\n    grid_values: values on a 1D grid of length nx\n    Returns interpolated values at particle positions.\n    \"\"\"\n    nx = grid_values.shape[0]\n    gx = x * nx\n    i0 = np.floor(gx).astype(int) % nx\n    fx = gx - i0\n    v_left = grid_values[i0]\n    v_right = grid_values[(i0 + 1) % nx]\n    return (1.0 - fx) * v_left + fx * v_right\n\ndef compute_acceleration_pm(x_particles, nx):\n    \"\"\"\n    Compute gravitational acceleration on particles using a 1D PM scheme.\n    Units: L=1, 4pi G = 1 - Poisson: phi_xx = rho - rho_mean\n    \"\"\"\n    npart = x_particles.shape[0]\n    mass_per_particle = 1.0 / npart\n    # Deposit mass onto grid\n    mass_grid = cic_deposit_1d(x_particles, mass_per_particle, nx)\n    dx = 1.0 / nx\n    # Convert to density\n    rho = mass_grid / dx  # mass per cell / cell width\n    # Subtract mean density (should be ~1.0)\n    rho_mean = np.mean(rho)\n    drho = rho - rho_mean\n    # FFT to solve Poisson\n    rho_k = np.fft.fft(drho)\n    k = np.fft.fftfreq(nx, d=dx)  # cycles per unit length\n    # Avoid division by zero at k=0\n    phi_k = np.zeros_like(rho_k, dtype=np.complex128)\n    # (2πk)^2 factor in denominator\n    nonzero = k != 0.0\n    denom = (2.0 * np.pi * k[nonzero]) ** 2\n    phi_k[nonzero] = -rho_k[nonzero] / denom\n    # Acceleration a = - dphi/dx = in k-space: a_k = -(2π i k) * phi_k\n    a_k = -(2.0j * np.pi * k) * phi_k\n    a_grid = np.fft.ifft(a_k).real\n    # Interpolate acceleration to particle positions\n    a_particles = cic_interpolate_1d(x_particles, a_grid)\n    return a_particles\n\ndef leapfrog_pm(x, v, nx, dt, nsteps):\n    \"\"\"\n    Advance particles using leapfrog with PM accelerations.\n    \"\"\"\n    # Initial half-kick\n    a = compute_acceleration_pm(x, nx)\n    v = v + 0.5 * dt * a\n    for _ in range(nsteps):\n        # Drift\n        x = x + dt * v\n        # Periodic wrap\n        x = np.mod(x, 1.0)\n        # Compute new acceleration\n        a = compute_acceleration_pm(x, nx)\n        # Kick\n        v = v + dt * a\n    # Final half-step correction to ensure end at full step:\n    v = v - 0.5 * dt * a\n    return x, v\n\ndef histogram_density_phase_space(x, v, nxi, neta, alpha=5.0):\n    \"\"\"\n    Build a 2D histogram-based density f(ξ,η) on [0,1]x[0,1].\n    ξ = x in [0,1)\n    η = (v + Vmax)/(2 Vmax), Vmax = alpha * std(v)\n    Returns:\n      f: 2D density array normalized so sum f dξ dη ~ 1\n      dxi, deta: grid spacings\n    \"\"\"\n    v_std = np.std(v)\n    vmax = alpha * v_std if v_std > 0 else 1.0  # avoid zero\n    # Map to [0,1]\n    xi = np.mod(x, 1.0)\n    eta = (v + vmax) / (2.0 * vmax)\n    eta = np.clip(eta, 0.0, 1.0)\n    # 2D histogram\n    counts, xedges, yedges = np.histogram2d(xi, eta, bins=[nxi, neta], range=[[0.0, 1.0], [0.0, 1.0]])\n    npart = x.shape[0]\n    dxi = 1.0 / nxi\n    deta = 1.0 / neta\n    # Convert counts to density\n    f = counts / (npart * dxi * deta)\n    return f, dxi, deta\n\ndef gaussian_filter_fft_2d(f, sigma):\n    \"\"\"\n    Apply isotropic Gaussian filter with width sigma (in units of the [0,1] scaled coordinates)\n    using FFT-based multiplication by exp(-2 pi^2 sigma^2 (k_x^2 + k_y^2)).\n    \"\"\"\n    ny, nx = f.shape\n    # FFT\n    Fk = np.fft.fft2(f)\n    # Frequencies in cycles per unit interval\n    ky = np.fft.fftfreq(ny, d=1.0/ny)\n    kx = np.fft.fftfreq(nx, d=1.0/nx)\n    ky2 = ky**2\n    kx2 = kx**2\n    # Build separable Gaussian in k-space\n    Gk_y = np.exp(-2.0 * (np.pi**2) * (sigma**2) * ky2)\n    Gk_x = np.exp(-2.0 * (np.pi**2) * (sigma**2) * kx2)\n    Gk = np.outer(Gk_y, Gk_x)\n    # Apply filter\n    Fk_s = Fk * Gk\n    f_s = np.fft.ifft2(Fk_s).real\n    # Numerical cleanup: enforce non-negativity and renormalize integral\n    f_s = np.maximum(f_s, 0.0)\n    integral = f_s.sum() / (ny * nx)\n    if integral > 0:\n        f_s *= 1.0 / integral\n    return f_s\n\ndef coarse_grained_entropy(fbar, dxi, deta):\n    \"\"\"\n    Compute S = -∑ f ln f dξ dη with 0 ln 0 = 0 by convention.\n    \"\"\"\n    # Avoid log(0) by masking zeros\n    mask = fbar > 0.0\n    vals = fbar[mask]\n    S = -np.sum(vals * np.log(vals)) * dxi * deta\n    return S\n\ndef entropy_vs_epsilon(f, dxi, deta, epsilons):\n    \"\"\"\n    Compute S_epsilon for a list of epsilons using Gaussian smoothing in scaled coords.\n    \"\"\"\n    S_list = []\n    for eps in epsilons:\n        fbar = gaussian_filter_fft_2d(f, sigma=eps)\n        S = coarse_grained_entropy(fbar, dxi, deta)\n        S_list.append(S)\n    return np.array(S_list)\n\ndef epsilon_star_from_entropy(epsilons, S_list, tau=0.2):\n    \"\"\"\n    Determine epsilon_star based on derivative threshold criterion.\n    \"\"\"\n    # Use derivative w.r.t. ln epsilon\n    ln_eps = np.log(epsilons)\n    # Central differences on nonuniform grid handled by numpy.gradient\n    dS_dln = np.gradient(S_list, ln_eps)\n    # Find index of max derivative\n    imax = int(np.argmax(dS_dln))\n    max_slope = dS_dln[imax]\n    # Find first index beyond imax where slope = tau * max_slope\n    idx = None\n    for i in range(imax + 1, len(epsilons)):\n        if dS_dln[i] = tau * max_slope:\n            idx = i\n            break\n    if idx is None:\n        return float(epsilons[-1])\n    else:\n        return float(epsilons[idx])\n\ndef run_case(A, sigma_v, t_end, npart=2000, nx=256, dt=0.002, nxi=128, neta=128, alpha=5.0, eps_range=(5e-3, 1.5e-1), n_eps=10, tau=0.2):\n    \"\"\"\n    Run a single test case and return epsilon_star.\n    \"\"\"\n    # Initialize particle positions and velocities\n    q = rng.random(npart)\n    x0 = (q + (A / (2.0 * np.pi)) * np.sin(2.0 * np.pi * q)) % 1.0\n    if sigma_v > 0:\n        v0 = rng.normal(loc=0.0, scale=sigma_v, size=npart)\n    else:\n        v0 = np.zeros(npart, dtype=np.float64)\n    # Determine number of steps\n    nsteps = int(np.round(t_end / dt))\n    # Evolve with PM leapfrog\n    x, v = leapfrog_pm(x0.copy(), v0.copy(), nx, dt, nsteps)\n    # Construct phase-space density on unit square\n    f, dxi, deta = histogram_density_phase_space(x, v, nxi, neta, alpha=alpha)\n    # Epsilon grid\n    epsilons = np.logspace(np.log10(eps_range[0]), np.log10(eps_range[1]), num=n_eps)\n    # Compute entropy vs epsilon\n    S_list = entropy_vs_epsilon(f, dxi, deta, epsilons)\n    # Determine epsilon_star\n    eps_star = epsilon_star_from_entropy(epsilons, S_list, tau=tau)\n    return eps_star\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (A, sigma_v, t_end)\n        (0.1, 0.02, 1.0),  # Case 1\n        (0.2, 0.0, 1.2),   # Case 2\n        (0.1, 0.01, 0.1),  # Case 3\n    ]\n\n    results = []\n    for A, sigma_v, t_end in test_cases:\n        eps_star = run_case(A, sigma_v, t_end,\n                            npart=2000, nx=256, dt=0.002,\n                            nxi=128, neta=128, alpha=5.0,\n                            eps_range=(5e-3, 1.5e-1), n_eps=10, tau=0.2)\n        # Format with a reasonable precision to be concise and reproducible\n        results.append(f\"{eps_star:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "3500426"}]}