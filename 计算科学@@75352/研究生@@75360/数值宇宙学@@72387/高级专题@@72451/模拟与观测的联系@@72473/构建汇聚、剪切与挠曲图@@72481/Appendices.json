{"hands_on_practices": [{"introduction": "弱引力透镜质量图构建的核心任务是从观测到的剪切场反演汇聚场（即质量图）。本练习将引导你完成这一过程，通过在一个受控的模拟数据上，从基本关系出发推导并数值化实现著名的Kaiser-Squires反演。此练习不仅涵盖了理论，还引入了观测中的一个关键实际问题——巡天掩模（mask）所导致的E/B模式泄露，并探索了如何通过平滑化（apodization）来缓解这一系统误差[@problem_id:3468591]。", "problem": "考虑一个平坦天区上的弱引力透镜效应，该效应在一个二维周期性方形网格上建模。从引力透镜势 $\\,\\psi(\\boldsymbol{\\theta})\\,$、汇聚度 $\\,\\kappa(\\boldsymbol{\\theta})\\,$ 以及剪切分量 $\\,\\gamma_1(\\boldsymbol{\\theta}),\\gamma_2(\\boldsymbol{\\theta})\\,$ 出发，这些量由 $\\,\\psi\\,$ 的线性微分算子定义。假设一个受控的模拟质量分布，它产生一个纯标量势 $\\,\\psi\\,$，因此产生一个无旋度（“磁模式”）分量的纯梯度（“电模式”）剪切场。观测是通过一个任意的二元掩模 $\\,W_0(\\boldsymbol{\\theta})\\in\\{0,1\\}\\,$进行的，该掩模移除了选定区域的数据；观测到的剪切为 $\\,\\gamma^{\\mathrm{obs}}(\\boldsymbol{\\theta})=W(\\boldsymbol{\\theta})\\,\\gamma(\\boldsymbol{\\theta})\\,$，其中 $\\,W(\\boldsymbol{\\theta})\\,$ 可以包含一个平滑的切趾（apodization），在掩模边界附近从 $\\,0\\,$ 过渡到 $\\,1\\,$。\n\n您的任务是：\n- 在傅里叶空间中推导线性反演，将观测到的剪切场映射到平坦天区上的“电模式”汇聚度 $\\,\\kappa_E(\\boldsymbol{\\theta})\\,$ 和“磁模式”汇聚度 $\\,\\kappa_B(\\boldsymbol{\\theta})\\,$。推导应仅从 $\\,\\psi\\,$, $\\,\\kappa\\,$ 和 $\\,\\gamma\\,$ 之间的基本关系出发，不假设任何已知的反演公式。\n- 提出一个切趾函数 $\\,A(d)\\,$，它仅依赖于到最近掩模边界的距离 $\\,d\\,$，并在掩模区域内产生 $\\,W(\\boldsymbol{\\theta})\\,$ 的平滑过渡，以减少 $\\,E/B\\,$ 混合。基于最小化尖锐边缘效应来证明 $\\,A(d)\\,$ 选择的合理性。\n- 在方形网格上实现一个数值实验来评估泄漏，泄漏定义为无量纲比率\n$$L \\equiv \\sqrt{\\frac{\\sum_{i} W_i \\,\\kappa_B(\\boldsymbol{\\theta}_i)^2}{\\sum_{i} W_i \\,\\kappa_E(\\boldsymbol{\\theta}_i)^2}},$$\n其中求和遍历所有 $\\,W_i>0\\,$ 的像素，并演示与硬（非切趾）掩模相比，切趾如何减少 $\\,L\\,$。\n\n使用以下受控模拟和网格配置：\n- 线性尺寸为 $\\,N=128\\,$ 像素的方形网格，单位像素间距。对于傅里叶变换，将该域视为周期性的。所有场都是无量纲的；不需要物理单位。\n- 汇聚度 $\\,\\kappa(\\boldsymbol{\\theta})\\,$ 是两个各向同性高斯团块的叠加，中心分别位于 $\\,\\boldsymbol{\\theta}_1=(N/4,N/4)\\,$ 和 $\\,\\boldsymbol{\\theta}_2=(3N/4,3N/4)\\,$，振幅分别为 $\\,A_1=1.0\\,$ 和 $\\,A_2=0.8\\,$，标准差分别为 $\\,\\sigma_1=5\\,$ 像素和 $\\,\\sigma_2=8\\,$ 像素。减去 $\\,\\kappa\\,$ 的平均值，以使零模为零。\n- 使用周期性网格上的傅里叶导数，从 $\\,\\kappa(\\boldsymbol{\\theta})\\,$ 计算 $\\,\\psi(\\boldsymbol{\\theta})\\,$、$\\,\\gamma_1(\\boldsymbol{\\theta})\\,$ 和 $\\,\\gamma_2(\\boldsymbol{\\theta})\\,$。\n\n为测试套件定义掩模和切趾宽度如下：\n1.  情况1（基准）：无掩模，即处处 $\\,W_0(\\boldsymbol{\\theta})=1\\,$；切趾宽度 $\\,w=0\\,$ 像素。\n2.  情况2（硬圆形孔）：在以 $\\,\\boldsymbol{\\theta}=(N/2,N/2)\\,$ 为中心、半径为 $\\,r=12\\,$ 像素的圆内 $\\,W_0(\\boldsymbol{\\theta})=0\\,$，其他地方 $\\,W_0(\\boldsymbol{\\theta})=1\\,$；切趾宽度 $\\,w=0\\,$ 像素。\n3.  情况3（切趾圆形孔）：与情况2相同的 $\\,W_0\\,$，但切趾宽度 $\\,w=6\\,$ 像素。\n4.  情况4（切趾垂直条带孔）：对于中心垂直条带 $\\,|x-N/2|\\leq s\\,$（其中 $\\,s=6\\,$ 像素），$\\,W_0(\\boldsymbol{\\theta})=0\\,$，其他地方 $\\,W_0(\\boldsymbol{\\theta})=1\\,$；切趾宽度 $\\,w=6\\,$ 像素。\n\n对于切趾，通过在未掩模区域内宽度为 $\\,w\\,$ 像素的边界层上使用相同的 $\\,A(d)\\,$ 函数，从 $\\,0\\,$ 平滑过渡到 $\\,1\\,$，从而由 $\\,W_0(\\boldsymbol{\\theta})\\,$ 构建 $\\,W(\\boldsymbol{\\theta})\\,$。如果 $\\,w=0\\,$，则设 $\\,W(\\boldsymbol{\\theta})=W_0(\\boldsymbol{\\theta})\\,$。\n\n您的程序必须：\n- 在平坦天区上实现从观测剪切到 $\\,\\kappa_E\\,$ 和 $\\,\\kappa_B\\,$ 的基于推导的反演。\n- 实现所提出的切趾函数 $\\,A(d)\\,$，并将其应用于每个掩模 $\\,W_0\\,$ 以生成 $\\,W\\,$。\n- 在指定的模拟数据上为每种情况计算泄漏度量 $\\,L\\,$，并将每个结果四舍五入到六位小数。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含一个逗号分隔的列表，用方括号括起来（例如，\"[result1,result2,result3,result4]\"）。每个条目必须是对应情况下的浮点数 $\\,L\\,$，按上述顺序排列，并四舍五入到六位小数。\n\n因此，测试套件是参数三元组的有序列表 $\\,(\\text{掩模类型},\\,\\text{掩模参数},\\,w)\\,$：\n- 情况1：$\\,(\\text{无},\\,0,\\,0)\\,$\n- 情况2：$\\,(\\text{圆形},\\,r=12,\\,0)\\,$\n- 情况3：$\\,(\\text{圆形},\\,r=12,\\,6)\\,$\n- 情况4：$\\,(\\text{条带},\\,s=6,\\,6)\\,$", "solution": "该问题要求推导用于带掩模数据的弱引力透镜 E/B 模式反演，提出一种切趾方案，并进行数值实现以量化 E-B 模式泄漏。该问题定义明确，科学上基于宇宙学和数据分析的原理，并提供了数值求解所需的所有参数。\n\n### 1. E/B 模式反演的推导\n\n分析始于连接平坦天区上引力透镜势 $\\psi(\\boldsymbol{\\theta})$、汇聚度 $\\kappa(\\boldsymbol{\\theta})$ 以及剪切场两个分量 $\\gamma_1(\\boldsymbol{\\theta})$ 和 $\\gamma_2(\\boldsymbol{\\theta})$ 的基本关系。这些关系由势的二阶导数给出：\n$$ \\kappa = \\frac{1}{2}(\\partial_1^2 + \\partial_2^2)\\psi = \\frac{1}{2}\\nabla^2\\psi $$\n$$ \\gamma_1 = \\frac{1}{2}(\\partial_1^2 - \\partial_2^2)\\psi $$\n$$ \\gamma_2 = \\partial_1 \\partial_2 \\psi $$\n其中 $\\partial_i$ 表示对角坐标 $\\theta_i$ 的偏导数。\n\n这些关系在傅里叶空间中得以简化。令 $\\hat{f}(\\boldsymbol{k})$ 表示场 $f(\\boldsymbol{\\theta})$ 的傅里叶变换。导数算子 $\\partial_i$ 变换为乘以 $i k_i$，其中 $k_i$ 是波矢分量。因此，关系式变为：\n$$ \\hat{\\kappa}(\\boldsymbol{k}) = -\\frac{1}{2}(k_1^2 + k_2^2)\\hat{\\psi}(\\boldsymbol{k}) = -\\frac{1}{2}k^2\\hat{\\psi}(\\boldsymbol{k}) $$\n$$ \\hat{\\gamma}_1(\\boldsymbol{k}) = -\\frac{1}{2}(k_1^2 - k_2^2)\\hat{\\psi}(\\boldsymbol{k}) $$\n$$ \\hat{\\gamma}_2(\\boldsymbol{k}) = -(k_1 k_2)\\hat{\\psi}(\\boldsymbol{k}) $$\n这里，$k^2 = k_1^2 + k_2^2$。对于此问题，假定基础质量分布产生纯E模式（仅梯度）场，因此 $\\kappa$ 是真实的E模式汇聚度。我们可以通过代入 $\\hat{\\psi}(\\boldsymbol{k}) = -2\\hat{\\kappa}(\\boldsymbol{k})/k^2$（对于 $\\boldsymbol{k} \\neq \\boldsymbol{0}$）来用汇聚度表示剪切分量：\n$$ \\hat{\\gamma}_1(\\boldsymbol{k}) = \\frac{k_1^2 - k_2^2}{k^2}\\hat{\\kappa}(\\boldsymbol{k}) $$\n$$ \\hat{\\gamma}_2(\\boldsymbol{k}) = \\frac{2k_1 k_2}{k^2}\\hat{\\kappa}(\\boldsymbol{k}) $$\n\n一个广义的剪切场可以分解为一个由势 $\\kappa_E$ 产生的无旋E模式部分，和一个由赝势 $\\kappa_B$ 产生的无散B模式部分。对于广义剪切场，傅里叶空间关系为：\n$$ \\hat{\\gamma}_1(\\boldsymbol{k}) = \\frac{k_1^2 - k_2^2}{k^2}\\hat{\\kappa}_E(\\boldsymbol{k}) + \\frac{2k_1 k_2}{k^2}\\hat{\\kappa}_B(\\boldsymbol{k}) $$\n$$ \\hat{\\gamma}_2(\\boldsymbol{k}) = \\frac{2k_1 k_2}{k^2}\\hat{\\kappa}_E(\\boldsymbol{k}) - \\frac{k_1^2 - k_2^2}{k^2}\\hat{\\kappa}_B(\\boldsymbol{k}) $$\n这代表了在每个波矢 $\\boldsymbol{k}$ 处关于 $\\hat{\\kappa}_E(\\boldsymbol{k})$ 和 $\\hat{\\kappa}_B(\\boldsymbol{k})$ 的两个线性方程组。求解此方程组可得到反演公式。将第一个方程乘以 $(k_1^2 - k_2^2)/k^2$，第二个方程乘以 $(2k_1 k_2)/k^2$ 并相加，可分离出 $\\hat{\\kappa}_E$。类似地，将第一个方程乘以 $(2k_1 k_2)/k^2$，第二个方程乘以 $-(k_1^2 - k_2^2)/k^2$ 并相加，可分离出 $\\hat{\\kappa}_B$。反演公式为：\n$$ \\hat{\\kappa}_E(\\boldsymbol{k}) = \\frac{k_1^2 - k_2^2}{k^2}\\hat{\\gamma}_1(\\boldsymbol{k}) + \\frac{2k_1 k_2}{k^2}\\hat{\\gamma}_2(\\boldsymbol{k}) $$\n$$ \\hat{\\kappa}_B(\\boldsymbol{k}) = \\frac{2k_1 k_2}{k^2}\\hat{\\gamma}_1(\\boldsymbol{k}) - \\frac{k_1^2 - k_2^2}{k^2}\\hat{\\gamma}_2(\\boldsymbol{k}) $$\n这些表达式定义在 $\\boldsymbol{k} \\neq \\boldsymbol{0}$ 处。平均汇聚度 $\\hat{\\kappa}(\\boldsymbol{0})$ 无法从剪切中观测到（质量片退化），我们设置 $\\hat{\\kappa}_E(\\boldsymbol{0}) = \\hat{\\kappa}_B(\\boldsymbol{0}) = 0$。\n\n在观测环境中，真实剪切场 $\\gamma(\\boldsymbol{\\theta})$ 被一个窗口函数（掩模）$W(\\boldsymbol{\\theta})$ 相乘，使得观测到的剪切为 $\\gamma^{\\mathrm{obs}}(\\boldsymbol{\\theta}) = W(\\boldsymbol{\\theta})\\gamma(\\boldsymbol{\\theta})$。实空间中的乘法对应于傅里叶空间中的卷积：$\\hat{\\gamma}^{\\mathrm{obs}}(\\boldsymbol{k}) = (\\hat{W} * \\hat{\\gamma})(\\boldsymbol{k})$。如果 $W(\\boldsymbol{\\theta})$ 有尖锐的边缘，其傅里叶变换 $\\hat{W}(\\boldsymbol{k})$ 将有宽阔且缓慢衰减的翼。这种卷积混合了不同傅里叶模式之间的功率。由于E/B滤波器依赖于 $\\boldsymbol{k}$ 的方向，这种模式混合会破坏分离，导致来自纯E模式信号的功率“泄漏”到重建的B模式图中。因此，反演过程应用于*观测*场 $\\hat{\\gamma}^{\\mathrm{obs}}_1$ 和 $\\hat{\\gamma}^{\\mathrm{obs}}_2$ 的傅里叶变换，即使原始场是纯E模式，这也会导致非零的 $\\kappa_B$。\n\n### 2. 切趾策略\n\n为了减轻由尖锐掩模边界引起的E/B泄漏，必须对窗口函数 $W(\\boldsymbol{\\theta})$ 进行平滑处理。这个过程称为切趾。一个好的切趾函数在掩模边缘处的一个有限宽度 $w$ 上平滑地从 $0$ 过渡到 $1$。问题要求一个依赖于到最近掩模区域距离 $d$ 的函数 $A(d)$。\n\n我们提出一个正弦平方（或余弦钟形）锥削函数。令 $W_0(\\boldsymbol{\\theta})$ 为二元掩模（在排除区域为 $0$，其他地方为 $1$）。对于未掩模区域（$W_0(\\boldsymbol{\\theta})=1$）中的任意点 $\\boldsymbol{\\theta}$，令 $d(\\boldsymbol{\\theta})$ 为其到最近掩模区域中点的欧几里得距离。切趾后的窗口 $W(\\boldsymbol{\\theta})$ 定义为：\n$$\nW(\\boldsymbol{\\theta}) =\n\\begin{cases}\n    0  \\text{若 } W_0(\\boldsymbol{\\theta}) = 0 \\\\\n    \\sin^2\\left(\\frac{\\pi d(\\boldsymbol{\\theta})}{2w}\\right)  \\text{若 } W_0(\\boldsymbol{\\theta}) = 1 \\text{ 且 } d(\\boldsymbol{\\theta})  w \\\\\n    1  \\text{若 } W_0(\\boldsymbol{\\theta}) = 1 \\text{ 且 } d(\\boldsymbol{\\theta}) \\ge w\n\\end{cases}\n$$\n选择此函数的理由是其平滑性。该函数在过渡点 $d=0$（原始掩模的边界）和 $d=w$（切趾区域的内边缘）处是连续的，并且其一阶导数也是连续的。具有连续导数的函数 $f(x)$ 的傅里叶变换 $\\hat{f}(k)$ 在大 $k$ 处衰减得更快。通过确保 $W(\\boldsymbol{\\theta})$ 及其一阶导数的连续性，我们抑制了 $\\hat{W}(\\boldsymbol{k})$ 中的高频功率，收窄了其核心，并减少了模式混合的程度，从而最小化了E/B泄漏。\n\n### 3. 数值实验设计\n\n数值实验旨在展示切趾的有效性。步骤如下：\n1.  **网格和模拟场：** 定义一个 $128 \\times 128$ 像素的网格。通过叠加两个具有指定参数的高斯团块来构建真实的汇聚度场 $\\kappa(\\boldsymbol{\\theta})$。减去其平均值以确保 $\\hat{\\kappa}(\\boldsymbol{0}) = 0$。\n2.  **真实剪切生成：** 使用上面推导的傅里叶空间关系，从 $\\kappa(\\boldsymbol{\\theta})$ 生成真实的剪切场 $\\gamma_1(\\boldsymbol{\\theta})$ 和 $\\gamma_2(\\boldsymbol{\\theta})$。这包括对 $\\kappa$ 进行FFT，在k空间应用适当的滤波器，然后进行IFFT。\n3.  **掩模应用：** 对于四个测试用例中的每一个，创建相应的二元掩模 $W_0$。然后使用具有指定宽度 $w$ 的正弦平方锥削函数构建切趾掩模 $W$。通过将真实剪切场与 $W$ 相乘，得到观测到的剪切场 $\\gamma_1^{\\mathrm{obs}}$ 和 $\\gamma_2^{\\mathrm{obs}}$。\n4.  **E/B 重建：** 对观测到的剪切场进行傅里叶变换。在傅里叶空间中应用E/B反演公式以获得 $\\hat{\\kappa}_E(\\boldsymbol{k})$ 和 $\\hat{\\kappa}_B(\\boldsymbol{k})$。然后对它们进行傅里叶逆变换，得到实空间图 $\\kappa_E(\\boldsymbol{\\theta})$ 和 $\\kappa_B(\\boldsymbol{\\theta})$。\n5.  **泄漏计算：** 使用以下公式计算每个案例的泄漏度量 $L$：\n    $$ L = \\sqrt{\\frac{\\sum_{i} W_i \\,\\kappa_B(\\boldsymbol{\\theta}_i)^2}{\\sum_{i} W_i \\,\\kappa_E(\\boldsymbol{\\theta}_i)^2}} $$\n    该度量量化了重建的B模式与E模式中的功率比，并由掩模本身加权，以关注观测区域。四个案例的结果将表明，$L$ 在无掩模情况下可以忽略不计，对于硬边缘掩模则很显著，并通过切趾得到显著降低。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.ndimage import distance_transform_edt\n\ndef create_mock_kappa(N, clumps):\n    \"\"\"Generates the mock convergence map.\"\"\"\n    y, x = np.meshgrid(np.arange(N), np.arange(N), indexing='ij')\n    kappa = np.zeros((N, N))\n    for clump in clumps:\n        A, (x0, y0), sigma = clump\n        dist_sq = (x - x0)**2 + (y - y0)**2\n        kappa += A * np.exp(-dist_sq / (2 * sigma**2))\n    \n    # Subtract the mean to ensure the DC mode is zero.\n    kappa -= np.mean(kappa)\n    return kappa\n\ndef kappa_to_shear(kappa, N):\n    \"\"\"Computes shear fields from a convergence map in Fourier space.\"\"\"\n    kappa_k = np.fft.fft2(kappa)\n    \n    ky = np.fft.fftfreq(N)[:, None]\n    kx = np.fft.fftfreq(N)[None, :]\n    \n    # Square of the wavenumber. Avoid division by zero at k=0.\n    k_sq = kx**2 + ky**2\n    k_sq[0, 0] = 1.0  # Avoid division by zero\n    \n    # Shear-to-convergence filters\n    # gamma1_k = kappa_k * (kx^2 - ky^2) / k^2\n    # gamma2_k = kappa_k * (2*kx*ky) / k^2\n    g1_k_filter = (kx**2 - ky**2) / k_sq\n    g2_k_filter = (2 * kx * ky) / k_sq\n    \n    # The k=0 mode has no shear, set filter to 0\n    g1_k_filter[0, 0] = 0.0\n    g2_k_filter[0, 0] = 0.0\n    \n    gamma1_k = kappa_k * g1_k_filter\n    gamma2_k = kappa_k * g2_k_filter\n        \n    gamma1 = np.fft.ifft2(gamma1_k).real\n    gamma2 = np.fft.ifft2(gamma2_k).real\n    \n    return gamma1, gamma2\n\ndef reconstruct_kEB(gamma1_obs, gamma2_obs, N):\n    \"\"\"Reconstructs E-mode and B-mode convergence from observed shear.\"\"\"\n    gamma1_obs_k = np.fft.fft2(gamma1_obs)\n    gamma2_obs_k = np.fft.fft2(gamma2_obs)\n\n    ky = np.fft.fftfreq(N)[:, None]\n    kx = np.fft.fftfreq(N)[None, :]\n    \n    k_sq = kx**2 + ky**2\n    k_sq[0, 0] = 1.0  # Avoid division by zero\n    \n    # E-mode filter: kE_k = ((kx^2-ky^2)*g1_k + (2*kx*ky)*g2_k)/k^2\n    kE_k = ((kx**2 - ky**2) * gamma1_obs_k + 2 * kx * ky * gamma2_obs_k) / k_sq\n    \n    # B-mode filter: kB_k = ((2*kx*ky)*g1_k - (kx^2-ky^2)*g2_k)/k^2\n    kB_k = (2 * kx * ky * gamma1_obs_k - (kx**2 - ky**2) * gamma2_obs_k) / k_sq\n\n    # Set DC modes to zero (mass sheet degeneracy)\n    kE_k[0, 0] = 0.0\n    kB_k[0, 0] = 0.0\n    \n    kappa_E = np.fft.ifft2(kE_k).real\n    kappa_B = np.fft.ifft2(kB_k).real\n    \n    return kappa_E, kappa_B\n\ndef generate_mask(mask_type, param, N):\n    \"\"\"Generates the binary mask W0.\"\"\"\n    W0 = np.ones((N, N))\n    y, x = np.meshgrid(np.arange(N), np.arange(N), indexing='ij')\n    center = (N - 1) / 2.0\n\n    if mask_type == \"none\":\n        pass\n    elif mask_type == \"circular\":\n        radius = param\n        dist_sq = (x - center)**2 + (y - center)**2\n        W0[dist_sq = radius**2] = 0\n    elif mask_type == \"stripe\":\n        half_width = param\n        W0[:, np.abs(np.arange(N) - center) = half_width] = 0\n        \n    return W0\n\ndef apply_apodization(W0, w, N):\n    \"\"\"Applies sine-squared apodization to a binary mask.\"\"\"\n    if w == 0:\n        return W0.astype(float)\n\n    # distance_transform_edt computes the distance from each non-zero pixel \n    # to the nearest zero pixel. This is exactly d(theta).\n    dist_map = distance_transform_edt(W0)\n    \n    W = W0.copy().astype(float)\n    \n    # Identify the region to apply tapering\n    taper_zone = (W0 == 1)  (dist_map  w)\n    \n    # Apply the sine-squared apodization function\n    W[taper_zone] = np.sin(np.pi * dist_map[taper_zone] / (2 * w))**2\n    \n    return W\n\ndef calculate_leakage(kappa_E, kappa_B, W):\n    \"\"\"Calculates the E-to-B leakage metric L.\"\"\"\n    \n    # The sum is over all pixels, weighted by W_i.\n    # Pixels where W_i=0 contribute nothing.\n    power_B = np.sum(W * kappa_B**2)\n    power_E = np.sum(W * kappa_E**2)\n    \n    if power_E == 0:\n        return np.inf\n        \n    return np.sqrt(power_B / power_E)\n\ndef solve():\n    N = 128\n    \n    # Define the mock kappa field\n    clumps = [\n        (1.0, (N/4, N/4), 5.0),\n        (0.8, (3*N/4, 3*N/4), 8.0)\n    ]\n    kappa_true = create_mock_kappa(N, clumps)\n    \n    # Generate the true, unmasked shear fields\n    gamma1_true, gamma2_true = kappa_to_shear(kappa_true, N)\n    \n    # Define the test cases\n    test_cases = [\n        {\"mask_type\": \"none\", \"param\": 0, \"w\": 0},\n        {\"mask_type\": \"circular\", \"param\": 12, \"w\": 0},\n        {\"mask_type\": \"circular\", \"param\": 12, \"w\": 6},\n        {\"mask_type\": \"stripe\", \"param\": 6, \"w\": 6},\n    ]\n    \n    results = []\n    \n    for case in test_cases:\n        # 1. Generate binary mask\n        W0 = generate_mask(case[\"mask_type\"], case[\"param\"], N)\n        \n        # 2. Apply apodization to get final window function W\n        W = apply_apodization(W0, case[\"w\"], N)\n        \n        # 3. Create observed (masked) shear fields\n        gamma1_obs = gamma1_true * W\n        gamma2_obs = gamma2_true * W\n        \n        # 4. Reconstruct E and B modes from observed shear\n        kappa_E, kappa_B = reconstruct_kEB(gamma1_obs, gamma2_obs, N)\n        \n        # 5. Calculate leakage\n        leakage = calculate_leakage(kappa_E, kappa_B, W)\n        results.append(leakage)\n\n    # Format the final output\n    formatted_results = [f\"{r:.6f}\" for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "3468591"}, {"introduction": "在构建了质量图之后，下一个关键步骤是理解其不确定性。本练习通过一个简化但科学上现实的设置，讓你深入探讨噪声是如何从单个星系的测量传播到最终平滑化的透镜图中的[@problem_id:3468635]。通过专注于挠曲（flexion）这一高阶透镜效应，你将亲手计算信噪比，并理解为何某些透镜观测量在当前巡天深度下是噪声主导的。", "problem": "弱引力透镜质量作图流程从星系图像中构建汇聚度、剪切和曲张场。令一阶曲张场定义为 $ \\mathbf{F}(\\boldsymbol{\\theta}) = \\boldsymbol{\\nabla}\\kappa(\\boldsymbol{\\theta}) $，其中 $ \\kappa $ 是汇聚度，$ \\boldsymbol{\\theta} $ 是天空角。考虑以下一个简化但科学上真实的设置，用于从一个包含每个星系测得的一阶曲张估计值的星系表中，构建一阶曲张振幅 $ F(\\boldsymbol{\\theta}) $ 的平滑图。\n\n假设：\n1. 单个星系的曲张估计量是线性且无偏的。对于星系 $ j $，它满足 $ \\hat{F}_{j} = F_{\\mathrm{true},j} + \\eta_{j} + \\epsilon_{j} $，其中 $ \\eta_{j} $ 是一个均值为零、方差为 $ \\sigma_{F,\\mathrm{int}}^{2} $ 的内禀形态项，而 $ \\epsilon_{j} $ 是由像素噪声引起的测量贡献，其均值为零、方差为 $ \\sigma_{F,\\mathrm{pix}}^{2} $。这两项贡献在不同星系间是独立的，并且对于每个星系是相互独立的。\n2. 星系分布为一个空间均匀的泊松过程，其数密度为 $ n_{g} $，且噪声实现是独立的。该图通过核函数加权平均构建，使用宽度为 $ R $ 的高斯核函数，\n$$\nW_{R}(\\boldsymbol{\\theta}) = \\frac{1}{2\\pi R^{2}}\\exp\\!\\left(-\\frac{|\\boldsymbol{\\theta}|^{2}}{2R^{2}}\\right),\n$$\n归一化使得 $ \\int \\mathrm{d}^{2}\\boldsymbol{\\theta}\\, W_{R}(\\boldsymbol{\\theta}) = 1 $。在位置 $ \\boldsymbol{\\theta} $ 处平滑曲张场的估计量为\n$$\n\\hat{F}_{R}(\\boldsymbol{\\theta}) = \\frac{\\sum_{j} W_{R}(\\boldsymbol{\\theta}-\\boldsymbol{\\theta}_{j})\\,\\hat{F}_{j}}{\\sum_{j} W_{R}(\\boldsymbol{\\theta}-\\boldsymbol{\\theta}_{j})}.\n$$\n3. 角度以角秒（arcsec）为单位表示，高斯宽度为 $ R = 30\\,\\mathrm{arcsec} $ (即 $ R = 0.5\\,\\mathrm{arcmin} $)。数密度为 $ n_{g} = 20\\,\\mathrm{arcmin}^{-2} $。单个星系的内禀形态离散和像素噪声引起的测量离散分别为 $ \\sigma_{F,\\mathrm{int}} = 0.05\\,\\mathrm{arcsec}^{-1} $ 和 $ \\sigma_{F,\\mathrm{pix}} = 0.03\\,\\mathrm{arcsec}^{-1} $。\n4. 在此平滑尺度下，宇宙学一阶曲张信号的均方根 (RMS) 为 $ \\sigma_{F,\\mathrm{cos}} = 6.7\\times 10^{-4}\\,\\mathrm{arcsec}^{-1} $。此处 RMS 表示均方根。所求的信噪比 (SNR) 定义为 $ \\mathrm{SNR} = \\sigma_{F,\\mathrm{cos}} / \\sigma_{F,\\mathrm{map}} $，其中 $ \\sigma_{F,\\mathrm{map}} $ 是仅由 $ \\eta_{j} $ 和 $ \\epsilon_{j} $ 产生的平滑图估计量的均方根噪声。\n\n从无偏估计量的线性误差传播、泊松采样的性质以及独立噪声样本的核平滑等第一性原理出发，推导平滑曲张图方差 $ \\mathrm{Var}[\\hat{F}_{R}(\\boldsymbol{\\theta})] $ 的解析表达式，用 $ \\sigma_{F,\\mathrm{int}}^{2} $、$ \\sigma_{F,\\mathrm{pix}}^{2} $、$ n_{g} $ 和 $ W_{R} $ 表示。对于高斯核和上述数值，计算该表达式，并计算最终的信噪比。将最终的信噪比四舍五入到两位有效数字。将信噪比表示为无量纲数。", "solution": "我们首先回顾相关的透镜场如何用透镜势 $ \\psi(\\boldsymbol{\\theta}) $ 定义：汇聚度为 $ \\kappa = \\tfrac{1}{2}\\nabla^{2}\\psi $，剪切是 $ \\psi $ 的二阶导数的自旋为2的组合，一阶曲张是 $ \\mathbf{F} = \\boldsymbol{\\nabla}\\kappa $。任务是量化由包含内禀和像素噪声贡献的单个星系估计量构建的一阶曲张振幅平滑图中的噪声，然后将该噪声与给定的宇宙学均方根信号进行比较。\n\n基本原理：线性误差传播和独立随机变量平均值的性质。对于一个通过对独立样本进行加权平均的无偏线性估计量，其加权平均的方差等于单个样本方差的加权和，并用权重和的平方进行归一化。对于位于 $ \\boldsymbol{\\theta}_{j} $ 的星系，其估计量分解为 $ \\hat{F}_{j} = F_{\\mathrm{true},j} + \\nu_{j} $，其中 $ \\nu_{j} = \\eta_{j} + \\epsilon_{j} $ 的均值为零，方差为\n$$\n\\mathrm{Var}[\\nu_{j}] = \\sigma_{F,\\mathrm{int}}^{2} + \\sigma_{F,\\mathrm{pix}}^{2} \\equiv \\sigma_{F,\\mathrm{gal}}^{2}.\n$$\n此处 $ \\sigma_{F,\\mathrm{gal}}^{2} $ 是由内禀形态和像素噪声引起的单个星系的总方差，并假设这两个来源在不同星系间是独立且不相关的。\n\n使用归一化核函数的平滑图估计量为\n$$\n\\hat{F}_{R}(\\boldsymbol{\\theta}) = \\frac{\\sum_{j} W_{R}(\\boldsymbol{\\theta}-\\boldsymbol{\\theta}_{j})\\,\\hat{F}_{j}}{\\sum_{j} W_{R}(\\boldsymbol{\\theta}-\\boldsymbol{\\theta}_{j})}.\n$$\n在空间均匀泊松采样（密度为 $ n_{g} $）且分母的涨落相对于其均值可以忽略不计的假设下，我们在大样本极限下将分母近似为其期望值 $ \\mathbb{E}\\!\\left[\\sum_{j} W_{R}(\\boldsymbol{\\theta}-\\boldsymbol{\\theta}_{j})\\right] = n_{g}\\int \\mathrm{d}^{2}\\boldsymbol{\\theta}'\\,W_{R}(\\boldsymbol{\\theta}') = n_{g} $，因为核函数被归一化为单位积分。这是弱引力透镜质量作图中的标准连续近似。\n\n在这个近似下，并专注于图的噪声（即，为了评估噪声方差，将真实的曲张场视为固定的、无噪声的），图噪声是独立的零均值 $ \\nu_{j} $ 的加权平均，其有效权重为 $ W_{R}(\\boldsymbol{\\theta}-\\boldsymbol{\\theta}_{j})/n_{g} $。因此，根据独立同分布变量加权和的方差，\n$$\n\\mathrm{Var}[\\hat{F}_{R}(\\boldsymbol{\\theta})] \\approx \\frac{1}{n_{g}^{2}}\\,\\mathbb{E}\\!\\left[\\sum_{j} W_{R}(\\boldsymbol{\\theta}-\\boldsymbol{\\theta}_{j})^{2}\\,\\mathrm{Var}[\\nu_{j}]\\right] = \\frac{\\sigma_{F,\\mathrm{gal}}^{2}}{n_{g}^{2}}\\,\\mathbb{E}\\!\\left[\\sum_{j} W_{R}(\\boldsymbol{\\theta}-\\boldsymbol{\\theta}_{j})^{2}\\right].\n$$\n对于一个密度为 $ n_{g} $ 的空间泊松过程，对任何函数 $ f(\\boldsymbol{\\theta}-\\boldsymbol{\\theta}_{j}) $ 关于所有星系求和的期望值等于 $ n_{g}\\int \\mathrm{d}^{2}\\boldsymbol{\\theta}'\\, f(\\boldsymbol{\\theta}') $。因此，\n$$\n\\mathbb{E}\\!\\left[\\sum_{j} W_{R}(\\boldsymbol{\\theta}-\\boldsymbol{\\theta}_{j})^{2}\\right] = n_{g} \\int \\mathrm{d}^{2}\\boldsymbol{\\theta}'\\, W_{R}(\\boldsymbol{\\theta}')^{2}.\n$$\n综合这些因子，\n$$\n\\mathrm{Var}[\\hat{F}_{R}(\\boldsymbol{\\theta})] \\approx \\frac{\\sigma_{F,\\mathrm{gal}}^{2}}{n_{g}} \\int \\mathrm{d}^{2}\\boldsymbol{\\theta}'\\, W_{R}(\\boldsymbol{\\theta}')^{2}.\n$$\n这就是所求的用单个星系方差、数密度和核函数表示的通用表达式。它体现了这样一个基本事实：来自独立样本的平滑图的方差与平滑核下的有效源数量成反比减小，而有效源数量由 $ n_{g} $ 和核函数的自卷积面积 $ \\int W_{R}^{2} $ 量化。\n\n对于一个高斯核函数\n$$\nW_{R}(\\boldsymbol{\\theta}) = \\frac{1}{2\\pi R^{2}}\\exp\\!\\left(-\\frac{|\\boldsymbol{\\theta}|^{2}}{2R^{2}}\\right),\n$$\n我们计算其自重叠积分，\n$$\n\\int \\mathrm{d}^{2}\\boldsymbol{\\theta}\\, W_{R}(\\boldsymbol{\\theta})^{2} = \\int \\mathrm{d}^{2}\\boldsymbol{\\theta}\\, \\frac{1}{(2\\pi R^{2})^{2}}\\exp\\!\\left(-\\frac{|\\boldsymbol{\\theta}|^{2}}{R^{2}}\\right) = \\frac{1}{4\\pi R^{2}},\n$$\n其中最后一个等式由二维标准高斯积分得出。因此，\n$$\n\\mathrm{Var}[\\hat{F}_{R}(\\boldsymbol{\\theta})] = \\frac{\\sigma_{F,\\mathrm{gal}}^{2}}{4\\pi R^{2} n_{g}}, \\quad \\text{and} \\quad \\sigma_{F,\\mathrm{map}} \\equiv \\sqrt{\\mathrm{Var}[\\hat{F}_{R}]} = \\sqrt{\\frac{\\sigma_{F,\\mathrm{gal}}^{2}}{4\\pi R^{2} n_{g}}}.\n$$\n\n我们现在使用提供的值进行数值计算，并将所有角度以角秒表示。首先，单个星系的总方差是\n$$\n\\sigma_{F,\\mathrm{gal}}^{2} = \\sigma_{F,\\mathrm{int}}^{2} + \\sigma_{F,\\mathrm{pix}}^{2} = (0.05)^{2} + (0.03)^{2} = 0.0025 + 0.0009 = 0.0034 \\quad \\text{(in } \\mathrm{arcsec}^{-2}\\text{)}.\n$$\n高斯宽度为 $ R = 30\\,\\mathrm{arcsec} $，数密度 $ n_{g} = 20\\,\\mathrm{arcmin}^{-2} $ 必须转换为 $ \\mathrm{arcsec}^{-2} $：\n$$\n1\\,\\mathrm{arcmin}^{2} = (60\\,\\mathrm{arcsec})^{2} = 3600\\,\\mathrm{arcsec}^{2}, \\quad n_{g} = \\frac{20}{3600}\\,\\mathrm{arcsec}^{-2} = \\frac{1}{180}\\,\\mathrm{arcsec}^{-2}.\n$$\n因此，\n$$\n\\mathrm{Var}[\\hat{F}_{R}] = \\frac{0.0034}{4\\pi (30)^{2} \\cdot \\frac{1}{180}} = \\frac{0.0034}{4\\pi \\cdot 900} \\cdot 180 = \\frac{0.0034}{20\\pi}.\n$$\n因此，\n$$\n\\sigma_{F,\\mathrm{map}} = \\sqrt{\\frac{0.0034}{20\\pi}}.\n$$\n信噪比定义为\n$$\n\\mathrm{SNR} = \\frac{\\sigma_{F,\\mathrm{cos}}}{\\sigma_{F,\\mathrm{map}}} = \\frac{6.7\\times 10^{-4}}{\\sqrt{\\frac{0.0034}{20\\pi}}}.\n$$\n进行数值计算，\n$$\n\\frac{0.0034}{20\\pi} \\approx \\frac{0.0034}{62.831853\\ldots} \\approx 5.4110\\times 10^{-5}, \\quad \\sigma_{F,\\mathrm{map}} \\approx \\sqrt{5.4110\\times 10^{-5}} \\approx 7.3569\\times 10^{-3},\n$$\n所以\n$$\n\\mathrm{SNR} \\approx \\frac{6.7\\times 10^{-4}}{7.3569\\times 10^{-3}} \\approx 9.1048\\times 10^{-2}.\n$$\n\n四舍五入到两位有效数字，信噪比为 $ 9.1\\times 10^{-2} $。这个定量结果概括了整个论证：即使在乐观的数密度和平滑条件下，由内禀形态离散和像素噪声引起的曲张图中的噪声，在当前巡天深度下也远超过宇宙学曲张的均方根值，导致信噪比远低于1，从而得到一个由噪声主导的图。", "answer": "$$\\boxed{9.1\\times 10^{-2}}$$", "id": "3468635"}, {"introduction": "仅从剪切数据构建的质量图存在一个固有的模糊性，即“质量片简并性”（mass-sheet degeneracy）。本练习将让你直面这一挑战，并演示如何通过引入另一个独立的观测量——引力透镜放大效应（magnification）——来打破这种简并性[@problem_id:3468642]。你将使用Fisher信息分析这一强大工具，定量计算放大效应对约束简并性参数的贡献，从而体会多探针宇宙学分析的威力。", "problem": "给定一个总立体角为 $A_{\\mathrm{tot}}$ 的弱引力透镜巡天，你已经通过数值方法构建了约化剪切图 $g(\\boldsymbol{\\theta})$ 和一个独立的放大率图 $\\hat{\\mu}(\\boldsymbol{\\theta})$。在整个计算中，我们工作在弱引力透镜机制下，并考虑一个子区域，其中 $| \\kappa | \\leq 0.1$ 且 $| g | \\leq 0.2$，因此，在主导阶上，你可以将在基准质量面选择下的基线放大率场近似为空间常数，即 $\\mu(\\boldsymbol{\\theta}; \\lambda{=}1) \\approx \\mu_{0}$，其中 $\\mu_{0} \\approx 1$。假设约化剪切 $g(\\boldsymbol{\\theta})$ 的测量噪声相对于放大率噪声可以忽略不计，并且星系位置是随机分布的，因此在所选的像素尺度上，本征成团性可以忽略。\n\n采用引力透镜雅可比矩阵的定义，其中包含汇聚度 $\\kappa$ 和复剪切 $\\gamma$，并将放大率 $\\mu$ 定义为雅可比矩阵行列式的倒数。约化剪切定义为 $g \\equiv \\gamma / (1 - \\kappa)$。质量面变换由一个全局参数 $\\lambda$ 参数化，它作用于汇聚度和剪切，形式为 $\\kappa \\rightarrow \\lambda \\kappa + (1 - \\lambda)$ 和 $\\gamma \\rightarrow \\lambda \\gamma$。你将通过仅使用放大率数据计算 $\\lambda$ 的费雪极限残余不确定度，来量化增加放大率信息如何打破质量面简并性，并且不边缘化任何其他参数。\n\n对于放大率估计，使用星系数量计数放大率偏置，其中在流量极限下的对数计数斜率为 $s$。在一个立体角为 $A_{\\mathrm{pix}}$ 的像素中，星系的期望数量为 $n_{0} A_{\\mathrm{pix}} \\mu^{2.5 s - 1}$，其中 $n_{0}$ 是未被透镜效应影响的星系平均表面密度。假设每个像素中的星系计数服从泊松统计，并且巡天中的各个像素是相互独立的。如有需要，你可以围绕弱引力透镜极限对任何表达式进行线性化。\n\n巡天规格：\n- 总面积 $A_{\\mathrm{tot}} = 200~\\mathrm{deg}^{2}$。\n- 未透镜化的源密度 $n_{0} = 20~\\mathrm{arcmin}^{-2}$。\n- 数量计数斜率 $s = 0.3$。\n- 在选定的弱引力透镜子区域内，将 $\\mu(\\boldsymbol{\\theta}; \\lambda{=}1) \\approx \\mu_{0} = 1$ 处理。\n- 在真值 $\\lambda = 1$ 处评估不确定度。\n\n仅从上述定义和独立泊松计数的标准概率出发，根据所述近似，推导 $\\lambda$ 的费雪信息极限不确定度 $\\sigma_{\\lambda}$ 的闭合形式表达式（用 $(A_{\\mathrm{tot}}, n_{0}, s, \\mu_{0})$ 表示），然后针对给定的巡天进行数值计算。将最终答案表示为单个实数，并四舍五入至三位有效数字。答案是无量纲的；不要在最终答案中包含单位。", "solution": "问题要求仅从放大率数据中推导质量面变换参数 $\\lambda$ 的费雪信息极限不确定度 $\\sigma_{\\lambda}$。求解过程首先基于所提供的星系数量计数统计模型推导 $\\lambda$ 的费雪信息，然后对得到的表达式进行求值。\n\n放大率 $\\mu$ 定义为透镜雅可比矩阵 $A_{ij} = \\frac{\\partial \\theta_S^i}{\\partial \\theta^j}$ 行列式的倒数，该矩阵的分量与汇聚度 $\\kappa$ 和复剪切 $\\gamma = \\gamma_1 + i\\gamma_2$ 有关。雅可比矩阵为 $A = \\begin{pmatrix} 1-\\kappa-\\gamma_1  -\\gamma_2 \\\\ -\\gamma_2  1-\\kappa+\\gamma_1 \\end{pmatrix}$。\n放大率为 $\\mu = (\\det A)^{-1} = ((1-\\kappa)^2 - |\\gamma|^2)^{-1}$。\n\n质量面变换 (MST) 由以下公式给出：\n$$ \\kappa \\rightarrow \\kappa' = \\lambda \\kappa + (1 - \\lambda) $$\n$$ \\gamma \\rightarrow \\gamma' = \\lambda \\gamma $$\n在此变换下，放大率 $\\mu$ 的变换如下：\n$$ \\mu(\\lambda) = \\frac{1}{(1-\\kappa')^2 - |\\gamma'|^2} = \\frac{1}{(1 - (\\lambda\\kappa + 1 - \\lambda))^2 - |\\lambda\\gamma|^2} = \\frac{1}{(\\lambda(1-\\kappa))^2 - \\lambda^2|\\gamma|^2} = \\frac{1}{\\lambda^2 ((1-\\kappa)^2 - |\\gamma|^2)} $$\n这给出了在通用 $\\lambda$ 下的放大率（记为 $\\mu(\\lambda)$）与真实放大率（在 $\\lambda=1$ 处，记为 $\\mu_{1}$）之间的精确关系：\n$$ \\mu(\\lambda) = \\frac{\\mu_{1}}{\\lambda^2} $$\n这个关系显示了放大率如何打破质量面简并性，否则约化剪切 $g = \\gamma/(1-\\kappa)$ 在此变换下是不变的。\n\n数据由巡天中各个像素的星系计数组成。在一个立体角为 $A_{\\mathrm{pix}}$ 的像素 $i$ 中，星系的期望数量由下式给出：\n$$ \\langle N_i \\rangle = n_0 A_{\\mathrm{pix}} [\\mu_i(\\lambda)]^{\\alpha} $$\n其中 $n_0$ 是未透镜化的星系表面密度，$\\alpha = 2.5s-1$，$s$ 是对数计数斜率。假设不同像素中的星系计数是独立的，并且服从泊松统计。\n\n参数 $\\lambda$ 的总费雪信息是来自每个独立像素的费雪信息之和：$F_{\\lambda\\lambda} = \\sum_i F_{\\lambda\\lambda}^{(i)}$。对于期望值为 $\\langle N_i(\\lambda) \\rangle$ 的单个泊松观测值 $N_i$，其费雪信息为 $F_{\\lambda\\lambda}^{(i)} = \\frac{1}{\\langle N_i \\rangle} \\left( \\frac{\\partial \\langle N_i \\rangle}{\\partial \\lambda} \\right)^2$。\n或者，这可以写成 $F_{\\lambda\\lambda}^{(i)} = \\langle N_i \\rangle \\left( \\frac{\\partial \\ln \\langle N_i \\rangle}{\\partial \\lambda} \\right)^2$。\n\n我们来计算对数期望值的导数：\n$$ \\ln \\langle N_i \\rangle = \\ln(n_0 A_{\\mathrm{pix}}) + \\alpha \\ln(\\mu_i(\\lambda)) $$\n$$ \\frac{\\partial \\ln \\langle N_i \\rangle}{\\partial \\lambda} = \\alpha \\frac{1}{\\mu_i(\\lambda)} \\frac{\\partial \\mu_i(\\lambda)}{\\partial \\lambda} $$\n使用关系式 $\\mu_i(\\lambda) = \\mu_{1,i}/\\lambda^2$，我们有：\n$$ \\frac{\\partial \\mu_i(\\lambda)}{\\partial \\lambda} = \\mu_{1,i} (-2\\lambda^{-3}) = -\\frac{2\\mu_i(\\lambda)}{\\lambda} $$\n将此代入对数期望值的导数中：\n$$ \\frac{\\partial \\ln \\langle N_i \\rangle}{\\partial \\lambda} = \\alpha \\frac{1}{\\mu_i(\\lambda)} \\left( -\\frac{2\\mu_i(\\lambda)}{\\lambda} \\right) = -\\frac{2\\alpha}{\\lambda} $$\n那么单个像素的费雪信息为：\n$$ F_{\\lambda\\lambda}^{(i)} = \\langle N_i(\\lambda) \\rangle \\left( -\\frac{2\\alpha}{\\lambda} \\right)^2 = \\frac{4\\alpha^2}{\\lambda^2} \\langle N_i(\\lambda) \\rangle = \\frac{4\\alpha^2}{\\lambda^2} n_0 A_{\\mathrm{pix}} [\\mu_i(\\lambda)]^{\\alpha} $$\n总费雪信息是所有像素的总和：\n$$ F_{\\lambda\\lambda}(\\lambda) = \\sum_i \\frac{4\\alpha^2}{\\lambda^2} n_0 A_{\\mathrm{pix}} [\\mu_i(\\lambda)]^{\\alpha} = \\frac{4\\alpha^2 n_0}{\\lambda^2} \\sum_i A_{\\mathrm{pix}} \\left(\\frac{\\mu_{1,i}}{\\lambda^2}\\right)^{\\alpha} $$\n$$ F_{\\lambda\\lambda}(\\lambda) = \\frac{4\\alpha^2 n_0}{\\lambda^{2+2\\alpha}} \\int_{A_{\\mathrm{tot}}} [\\mu_1(\\boldsymbol{\\theta})]^{\\alpha} d^2\\theta $$\n我们需要在真值 $\\lambda=1$ 处计算这个表达式：\n$$ F_{\\lambda\\lambda}|_{\\lambda=1} = 4\\alpha^2 n_0 \\int_{A_{\\mathrm{tot}}} [\\mu_1(\\boldsymbol{\\theta})]^{\\alpha} d^2\\theta $$\n问题陈述中要求将基线放大率视为常数，即 $\\mu_1(\\boldsymbol{\\theta}) \\approx \\mu_0 = 1$。这个近似简化了积分：\n$$ \\int_{A_{\\mathrm{tot}}} [\\mu_1(\\boldsymbol{\\theta})]^{\\alpha} d^2\\theta \\approx \\int_{A_{\\mathrm{tot}}} (1)^{\\alpha} d^2\\theta = A_{\\mathrm{tot}} $$\n这个近似等价于假设放大率场的空间涨落平均为零，即在弱引力透镜极限下 $\\mu_1 \\approx 1+2\\kappa$，并且考虑到巡天上的平均汇聚度 $\\bar{\\kappa}$为零，有 $\\int (1+2\\kappa)^\\alpha d^2\\theta \\approx \\int(1+2\\alpha\\kappa)d^2\\theta = A_{\\mathrm{tot}}$。\n\n将此代入费雪信息的表达式中，得到：\n$$ F_{\\lambda\\lambda} = 4\\alpha^2 n_0 A_{\\mathrm{tot}} $$\n$\\lambda$ 的不确定度由克拉默-拉奥下界给出，$\\sigma_\\lambda^2 \\ge 1/F_{\\lambda\\lambda}$。费雪极限不确定度为 $\\sigma_\\lambda = 1/\\sqrt{F_{\\lambda\\lambda}}$。\n$$ \\sigma_\\lambda = \\frac{1}{\\sqrt{4\\alpha^2 n_0 A_{\\mathrm{tot}}}} = \\frac{1}{2|\\alpha| \\sqrt{n_0 A_{\\mathrm{tot}}}} $$\n代入 $\\alpha = 2.5s-1$，我们得到最终的闭合形式表达式：\n$$ \\sigma_\\lambda = \\frac{1}{2|2.5s-1| \\sqrt{n_0 A_{\\mathrm{tot}}}} $$\n\n现在，我们使用给定的巡天规格对该表达式进行数值计算：\n$A_{\\mathrm{tot}} = 200~\\mathrm{deg}^2$\n$n_0 = 20~\\mathrm{arcmin}^{-2}$\n$s = 0.3$\n\n首先，我们必须确保单位一致。我们将总面积 $A_{\\mathrm{tot}}$ 转换为平方角分：\n$1~\\mathrm{degree} = 60~\\mathrm{arcminutes}$，所以 $1~\\mathrm{deg}^2 = 3600~\\mathrm{arcmin}^2$。\n$A_{\\mathrm{tot}} = 200 \\times 3600~\\mathrm{arcmin}^2 = 720,000~\\mathrm{arcmin}^2$。\n\n接下来，我们计算未透镜化的星系总数 $n_0 A_{\\mathrm{tot}}$：\n$n_0 A_{\\mathrm{tot}} = (20~\\mathrm{arcmin}^{-2}) \\times (720,000~\\mathrm{arcmin}^2) = 14,400,000 = 1.44 \\times 10^7$。\n\n然后，我们计算指数因子 $\\alpha$：\n$\\alpha = 2.5s - 1 = 2.5 \\times 0.3 - 1 = 0.75 - 1 = -0.25$。\n$|\\alpha| = 0.25$。\n\n现在我们可以计算 $\\sigma_\\lambda$：\n$$ \\sigma_\\lambda = \\frac{1}{2 \\times 0.25 \\times \\sqrt{1.44 \\times 10^7}} = \\frac{1}{0.5 \\times \\sqrt{1.44 \\times 10^7}} = \\frac{2}{\\sqrt{1.44 \\times 10^7}} $$\n$$ \\sigma_\\lambda = \\frac{2}{1.2 \\times \\sqrt{10^7}} = \\frac{2}{1.2 \\times 10^{3.5}} \\approx \\frac{2}{1.2 \\times 3162.277} \\approx \\frac{2}{3794.733} \\approx 0.000527046 $$\n将结果四舍五入到三位有效数字，得到 $0.000527$ 或 $5.27 \\times 10^{-4}$。", "answer": "$$\\boxed{5.27 \\times 10^{-4}}$$", "id": "3468642"}]}