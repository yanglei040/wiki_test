{"hands_on_practices": [{"introduction": "吸积盘并非静态不变，而是表现出跨越多个时间尺度的复杂变化。天文学家利用功率谱密度（PSD）等工具来量化这种时变性，并从中探究潜在的物理过程。本练习 [@problem_id:3479056] 提供了一个将吸积盘理论与可观测现象联系起来的实践机会，您将通过一个简化的、但符合物理现实的PSD模型，计算出特征时变时间尺度，从而深入理解动力学、热学和粘滞时间尺度等理论概念与实际观测信号之间的关系。", "problem": "考虑一个围绕质量为 $M=10^8\\,M_\\odot$ 的无自旋黑洞的几何薄、辐射有效的 Shakura–Sunyaev $\\alpha$ 盘。设我们感兴趣的柱半径为 $R=50\\,r_g$，其中引力半径定义为 $r_g \\equiv GM/c^2$。假设在半径 $R$ 处的局域质量吸积率的随机涨落，在一个由低频截断 $f_{\\min}$ 和高频截断 $f_{\\max}$ 界定的有限频带上，具有闪烁噪声功率谱密度（PSD）$P(f)\\propto f^{-1}$。采用以下具有物理动机的认定：高频截断由局域动力学（轨道）时间决定，$f_{\\max} = 1/t_{\\mathrm{dyn}}(R)$；低频截断由局域粘滞时间决定，$f_{\\min} = 1/t_{\\mathrm{visc}}(R)$。使用带有 $\\alpha$ 粘滞的标准薄盘时间标度层级：开普勒角频率 $\\Omega_K(R)=\\sqrt{GM/R^3}$，动力学时间 $t_{\\mathrm{dyn}}(R)=2\\pi/\\Omega_K(R)$，热时间 $t_{\\mathrm{th}}(R)=\\alpha^{-1} t_{\\mathrm{dyn}}(R)$，以及粘滞时间 $t_{\\mathrm{visc}}(R)=(r/h)^2 t_{\\mathrm{th}}(R)$，其中 $h/r$ 是常数盘高比。在半径 $R=50\\,r_g$ 处，取 $\\alpha=0.1$ 和 $h/r=0.05$。\n\n将频带 $[f_{\\min},f_{\\max}]$ 上闪烁噪声过程的特征变化频率 $f_{\\mathrm{var}}$ 定义为每对数频率区间的方差的对数中心，\n$$\nf_{\\mathrm{var}} \\equiv \\exp\\!\\left(\\frac{\\int_{\\ln f_{\\min}}^{\\ln f_{\\max}} \\ln f \\, w(f)\\, d\\ln f}{\\int_{\\ln f_{\\min}}^{\\ln f_{\\max}} w(f)\\, d\\ln f}\\right),\n$$\n其中权重是每对数区间的方差密度 $w(f)\\propto f P(f)$。相应的特征变化时间标度为 $t_{\\mathrm{var}} \\equiv 1/f_{\\mathrm{var}}$。\n\n从上述定义以及 $f_{\\min}$ 和 $f_{\\max}$ 的认定出发，推导在 $R=50\\,r_g$ 处 $t_{\\mathrm{var}}$ 的解析表达式，该表达式应使用基本常数和给定的盘参数来表示。然后，对 $M=10^8\\,M_\\odot$ 的情况进行数值计算，并将最终结果以天为单位表示。将最终数值答案四舍五入至 $3$ 位有效数字。\n\n使用常数 $G=6.67430\\times 10^{-11}\\,\\mathrm{m^3\\,kg^{-1}\\,s^{-2}}$，$c=2.99792458\\times 10^8\\,\\mathrm{m\\,s^{-1}}$ 和 $M_\\odot=1.98847\\times 10^{30}\\,\\mathrm{kg}$。", "solution": "### 步骤 1：提取已知条件\n问题陈述提供了以下信息：\n-   黑洞质量：$M=10^8\\,M_\\odot$\n-   自旋：无自旋黑洞\n-   吸积盘模型：几何薄、辐射有效的 Shakura–Sunyaev $\\alpha$ 盘\n-   感兴趣的半径：$R=50\\,r_g$\n-   引力半径定义：$r_g \\equiv GM/c^2$\n-   质量吸积率涨落的功率谱密度（PSD）：$P(f)\\propto f^{-1}$\n-   频带：$[f_{\\min}, f_{\\max}]$\n-   高频截断：$f_{\\max} = 1/t_{\\mathrm{dyn}}(R)$\n-   低频截断：$f_{\\min} = 1/t_{\\mathrm{visc}}(R)$\n-   时间标度层级定义：\n    -   开普勒角频率：$\\Omega_K(R)=\\sqrt{GM/R^3}$\n    -   动力学时间：$t_{\\mathrm{dyn}}(R)=2\\pi/\\Omega_K(R)$\n    -   热时间：$t_{\\mathrm{th}}(R)=\\alpha^{-1} t_{\\mathrm{dyn}}(R)$\n    -   粘滞时间：$t_{\\mathrm{visc}}(R)=(r/h)^2 t_{\\mathrm{th}}(R)$，其中 $h/r$ 是常数盘高比\n-   半径 R 处的盘参数：\n    -   粘滞参数：$\\alpha=0.1$\n    -   盘高比：$h/r=0.05$\n-   特征变化频率的定义：\n    $f_{\\mathrm{var}} \\equiv \\exp\\!\\left(\\frac{\\int_{\\ln f_{\\min}}^{\\ln f_{\\max}} \\ln f \\, w(f)\\, d\\ln f}{\\int_{\\ln f_{\\min}}^{\\ln f_{\\max}} w(f)\\, d\\ln f}\\right)$\n-   权重函数：$w(f)\\propto f P(f)$\n-   特征变化时间标度的定义：$t_{\\mathrm{var}} \\equiv 1/f_{\\mathrm{var}}$\n-   常数：\n    -   $G=6.67430\\times 10^{-11}\\,\\mathrm{m^3\\,kg^{-1}\\,s^{-2}}$\n    -   $c=2.99792458\\times 10^8\\,\\mathrm{m\\,s^{-1}}$\n    -   $M_\\odot=1.98847\\times 10^{30}\\,\\mathrm{kg}$\n-   要求输出：$t_{\\mathrm{var}}$ 的解析表达式及其以天为单位的数值，四舍五入到 $3$ 位有效数字。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题科学上基于成熟的黑洞吸积盘理论，特别是 Shakura-Sunyaev 模型。物理时间标度（动力学、热、粘滞）的定义是该领域的标准定义。闪烁噪声功率谱密度（$f^{-1}$）的概念在吸积系统中很常见。将特征频率定义为对数中心在数学上是适定的和客观的。所有参数都定义清晰，且给定的数值对于超大质量黑洞而言是符合物理现实的。该问题是自洽、一致的，并且要求基于已建立的物理和数学原理进行求解，没有明显的缺陷。\n\n### 步骤 3：结论与行动\n问题有效。我将继续进行求解。\n\n### 解析表达式的推导\n\n首先，我们确定特征变化频率 $f_{\\mathrm{var}}$。权重函数 $w(f)$ 与 $f P(f)$ 成正比。已知功率谱密度 $P(f) \\propto f^{-1}$，我们可以写成 $P(f) = k f^{-1}$，其中 $k$ 为某个常数。因此，权重函数 $w(f) \\propto f (k f^{-1}) = k$，是一个常数。我们将其记为 $C$。\n\n$f_{\\mathrm{var}}$ 的定义涉及量 $\\ln f_{\\mathrm{var}}$：\n$$ \\ln f_{\\mathrm{var}} = \\frac{\\int_{\\ln f_{\\min}}^{\\ln f_{\\max}} \\ln f \\, w(f)\\, d(\\ln f)}{\\int_{\\ln f_{\\min}}^{\\ln f_{\\max}} w(f)\\, d(\\ln f)} $$\n由于 $w(f)=C$ 是一个常数，它可以从积分中提出并消掉：\n$$ \\ln f_{\\mathrm{var}} = \\frac{\\int_{\\ln f_{\\min}}^{\\ln f_{\\max}} \\ln f \\, d(\\ln f)}{\\int_{\\ln f_{\\min}}^{\\ln f_{\\max}} d(\\ln f)} $$\n令 $u = \\ln f$。积分变为：\n$$ \\ln f_{\\mathrm{var}} = \\frac{\\int_{\\ln f_{\\min}}^{\\ln f_{\\max}} u \\, du}{\\int_{\\ln f_{\\min}}^{\\ln f_{\\max}} du} = \\frac{\\left[ \\frac{1}{2}u^2 \\right]_{\\ln f_{\\min}}^{\\ln f_{\\max}}  }{ \\left[ u \\right]_{\\ln f_{\\min}}^{\\ln f_{\\max}} } = \\frac{\\frac{1}{2}((\\ln f_{\\max})^2 - (\\ln f_{\\min})^2)}{\\ln f_{\\max} - \\ln f_{\\min}} $$\n使用平方差公式，$a^2-b^2=(a-b)(a+b)$：\n$$ \\ln f_{\\mathrm{var}} = \\frac{\\frac{1}{2}(\\ln f_{\\max} - \\ln f_{\\min})(\\ln f_{\\max} + \\ln f_{\\min})}{\\ln f_{\\max} - \\ln f_{\\min}} = \\frac{1}{2}(\\ln f_{\\max} + \\ln f_{\\min}) $$\n使用对数性质，这可以简化为：\n$$ \\ln f_{\\mathrm{var}} = \\ln((f_{\\max} f_{\\min})^{1/2}) $$\n对两边取指数，得到特征频率是边界频率的几何平均值：\n$$ f_{\\mathrm{var}} = \\sqrt{f_{\\max}f_{\\min}} $$\n特征时间标度是 $t_{\\mathrm{var}} = 1/f_{\\mathrm{var}}$。代入 $f_{\\mathrm{var}}$ 的表达式：\n$$ t_{\\mathrm{var}} = \\frac{1}{\\sqrt{f_{\\max}f_{\\min}}} $$\n问题认定 $f_{\\max} = 1/t_{\\mathrm{dyn}}(R)$ 和 $f_{\\min} = 1/t_{\\mathrm{visc}}(R)$。将它们代入 $t_{\\mathrm{var}}$ 的表达式得到：\n$$ t_{\\mathrm{var}} = \\frac{1}{\\sqrt{(1/t_{\\mathrm{dyn}}(R))(1/t_{\\mathrm{visc}}(R))}} = \\sqrt{t_{\\mathrm{dyn}}(R) t_{\\mathrm{visc}}(R)} $$\n接下来，我们用 $t_{\\mathrm{dyn}}(R)$ 和盘参数来表示 $t_{\\mathrm{visc}}(R)$。定义为 $t_{\\mathrm{th}}(R) = \\alpha^{-1} t_{\\mathrm{dyn}}(R)$ 和 $t_{\\mathrm{visc}}(R)=(r/h)^2 t_{\\mathrm{th}}(R)$。我们已知盘高比为 $h/r$，所以 $(r/h)=(h/r)^{-1}$。\n$$ t_{\\mathrm{visc}}(R) = \\left(\\frac{h}{r}\\right)^{-2} t_{\\mathrm{th}}(R) = \\left(\\frac{h}{r}\\right)^{-2} \\alpha^{-1} t_{\\mathrm{dyn}}(R) $$\n现在，我们将此代入 $t_{\\mathrm{var}}$ 的表达式中：\n$$ t_{\\mathrm{var}} = \\sqrt{t_{\\mathrm{dyn}}(R) \\left[ \\left(\\frac{h}{r}\\right)^{-2} \\alpha^{-1} t_{\\mathrm{dyn}}(R) \\right]} = \\sqrt{t_{\\mathrm{dyn}}(R)^2 \\left(\\frac{h}{r}\\right)^{-2} \\alpha^{-1}} $$\n$$ t_{\\mathrm{var}} = t_{\\mathrm{dyn}}(R) \\left(\\frac{h}{r}\\right)^{-1} \\alpha^{-1/2} $$\n动力学时间为 $t_{\\mathrm{dyn}}(R) = 2\\pi / \\Omega_K(R) = 2\\pi \\sqrt{R^3/(GM)}$。半径为 $R=50\\,r_g = 50\\,GM/c^2$。\n$$ t_{\\mathrm{dyn}}(R) = 2\\pi \\sqrt{\\frac{(50GM/c^2)^3}{GM}} = 2\\pi \\sqrt{\\frac{50^3 G^3 M^3 / c^6}{GM}} = 2\\pi \\sqrt{\\frac{50^3 G^2 M^2}{c^6}} $$\n$$ t_{\\mathrm{dyn}}(R) = 2\\pi \\cdot 50^{3/2} \\frac{GM}{c^3} $$\n最后，我们将 $t_{\\mathrm{dyn}}(R)$ 的这个表达式代入 $t_{\\mathrm{var}}$ 的方程，得到完整的解析表达式：\n$$ t_{\\mathrm{var}} = \\left( 2\\pi \\cdot 50^{3/2} \\frac{GM}{c^3} \\right) \\left(\\frac{h}{r}\\right)^{-1} \\alpha^{-1/2} $$\n如题所求，这个 $t_{\\mathrm{var}}$ 的表达式是用基本常数 $G$ 和 $c$、黑洞质量 $M$ 以及盘参数 $\\alpha$ 和 $h/r$ 来表示的。\n\n### 数值计算\n\n我们已知以下数值：\n-   $M = 10^8 M_\\odot = 10^8 \\times 1.98847 \\times 10^{30}\\,\\mathrm{kg} = 1.98847 \\times 10^{38}\\,\\mathrm{kg}$\n-   $G = 6.67430 \\times 10^{-11}\\,\\mathrm{m^3\\,kg^{-1}\\,s^{-2}}$\n-   $c = 2.99792458 \\times 10^8\\,\\mathrm{m\\,s^{-1}}$\n-   $\\alpha = 0.1$\n-   $h/r = 0.05$\n\n首先，我们计算引力半径的光行时，$t_g = GM/c^3$：\n$$ t_g = \\frac{(6.67430 \\times 10^{-11}\\,\\mathrm{m^3\\,kg^{-1}\\,s^{-2}}) \\times (1.98847 \\times 10^{38}\\,\\mathrm{kg})}{(2.99792458 \\times 10^8\\,\\mathrm{m\\,s^{-1}})^3} $$\n$$ t_g \\approx \\frac{1.32712 \\times 10^{28}\\,\\mathrm{m^3\\,s^{-2}}}{2.69440 \\times 10^{25}\\,\\mathrm{m^3\\,s^{-3}}} \\approx 492.549\\,\\mathrm{s} $$\n接下来，我们计算在 $R=50\\,r_g$ 处的动力学时间 $t_{\\mathrm{dyn}}$：\n$$ t_{\\mathrm{dyn}} = 2\\pi \\cdot 50^{3/2} t_g = 2\\pi \\cdot (50 \\sqrt{50}) \\cdot t_g \\approx 2\\pi \\cdot 353.553 \\cdot 492.549\\,\\mathrm{s} \\approx 1094060\\,\\mathrm{s} $$\n现在，我们计算特征时间标度 $t_{\\mathrm{var}}$：\n$$ t_{\\mathrm{var}} = t_{\\mathrm{dyn}} \\left(\\frac{h}{r}\\right)^{-1} \\alpha^{-1/2} = t_{\\mathrm{dyn}} \\cdot (0.05)^{-1} \\cdot (0.1)^{-1/2} $$\n$$ t_{\\mathrm{var}} = t_{\\mathrm{dyn}} \\cdot (20) \\cdot \\sqrt{10} \\approx 1094060\\,\\mathrm{s} \\times 20 \\times 3.16228 \\approx 69192430\\,\\mathrm{s} $$\n最后，我们将结果从秒转换为天。一天中的秒数为 $24 \\times 60 \\times 60 = 86400\\,\\mathrm{s}$。\n$$ t_{\\mathrm{var}} \\text{ (in days)} = \\frac{69192430\\,\\mathrm{s}}{86400\\,\\mathrm{s/day}} \\approx 800.838\\,\\text{days} $$\n四舍五入到 $3$ 位有效数字，我们得到 $801$ 天。", "answer": "$$\n\\boxed{801}\n$$", "id": "3479056"}, {"introduction": "在现代吸积理论中，磁场是驱动物质向内运动和能量向外传输的关键引擎。然而，在数值模拟中精确地处理磁场演化极具挑战性，因为必须严格遵守麦克斯韦方程组所要求的无散度约束 $\\nabla \\cdot \\mathbf{B} = 0$。本练习 [@problem_id:3479125] 将指导您实现“约束输运”（Constrained Transport, CT）方法——一种保证该约束在离散网格上维持到机器精度的核心数值技术，从而确保模拟结果的物理真实性。", "problem": "您必须使用约束输运（CT）方法，在理想磁流体动力学（MHD）中实现并研究磁场的演化。目标是解析和数值地证明，在有限体积格式中，离散磁场散度约束 $\\,\\nabla\\cdot\\mathbf{B}=0\\,$ 能够保持到机器精度。在背景上，这代表了黑洞吸积流中几何薄片内的磁动力学，其中理想MHD感应方程控制着场的演化。数学基础应从法拉第定律和理想欧姆定律开始，不引入任何快捷公式。\n\n基本原理：\n- 理想磁流体动力学（MHD）中的理想欧姆定律：$\\mathbf{E}=-\\mathbf{v}\\times\\mathbf{B}$。\n- 法拉第定律：$\\partial_t\\mathbf{B}=-\\nabla\\times\\mathbf{E}$。\n- 磁场无散约束：$\\nabla\\cdot\\mathbf{B}=0$。\n\n离散几何与变量：\n- 在无量纲代码单位中，使用一个边长为 $L_x=L_y=1$ 的方形域上的均匀、周期性笛卡尔网格。设沿 $x$ 和 $y$ 方向的单元格数量分别为 $N_x$ 和 $N_y$，间距为 $\\Delta x=L_x/N_x$ 和 $\\Delta y=L_y/N_y$。\n- 将 $B_x$ 存储在索引为 $(i+\\tfrac{1}{2},j)$ 的 $x$ 面上，将 $B_y$ 存储在索引为 $(i,j+\\tfrac{1}{2})$ 的 $y$ 面上。将电场电动势分量 $E_z$ 存储在单元格角点 $(i+\\tfrac{1}{2},j+\\tfrac{1}{2})$ 处。\n- 从角点为中心的矢量势 $A_z$ 初始化磁场，使得离散散度精确为零，方法是在面上使用源自角点差分的离散形式 $B_x=\\partial_y A_z$ 和 $B_y=-\\partial_x A_z$。所有量均为无量纲。\n\n有限体积约束输运更新：\n- 从法拉第定律的积分形式推导CT更新，应用于面平均磁通量和角点中心电动势。更新必须使用一组由 $B_x$ 和 $B_y$ 更新一致共享的角点 $E_z$ 值。您必须获得一个面中心的更新，它是角点中心 $E_z$ 的离散旋度，并证明通过面中心有限体积差分计算的离散散度在此更新下是不变的。\n\n速度场：\n- 使用预定的、无散度的速度场在角点计算 $\\mathbf{E}=-\\mathbf{v}\\times\\mathbf{B}$。速度场应在角点处求值，并且可以是时间相关的。所有场都是周期性的。\n\n要求的数值演示：\n- 在代码单位（无量纲）中实现CT格式，使用根据最大角点速度大小计算的、CFL数在 $(0,1)$ 内的Courant–Friedrichs–Lewy (CFL) 条件，将磁场演化指定的步数，并为每个测试用例计算演化后网格中的最大绝对离散散度。\n\n测试套件：\n- 提供恰好四个测试用例，参数集如下，均以无量纲代码单位表示：\n  1. $N_x=32$, $N_y=32$, $A_z(x,y)=B_0\\sin(2\\pi x)\\sin(2\\pi y)$，其中 $B_0=1$，刚体旋转 $\\mathbf{v}(x,y)=(-\\Omega y,\\ \\Omega x)$，其中 $\\Omega=0.1$，时间步数 $N_{\\text{step}}=50$，CFL数 $C=0.3$。\n  2. $N_x=16$, $N_y=16$, $A_z(x,y)=B_0\\sin(2\\pi x)\\sin(2\\pi y)$，其中 $B_0=0.5$，静态速度 $\\mathbf{v}=(0,0)$，时间步数 $N_{\\text{step}}=10$，CFL数 $C=0.5$。\n  3. $N_x=8$, $N_y=8$, $A_z(x,y)=B_0\\sin(2\\pi x)\\sin(2\\pi y)$，其中 $B_0=1$，线性剪切 $\\mathbf{v}(x,y)=(S y,\\ 0)$，其中 $S=0.2$，时间步数 $N_{\\text{step}}=40$，CFL数 $C=0.4$。\n  4. $N_x=12$, $N_y=10$, $A_z(x,y)=B_0\\sin(2\\pi x)\\sin(2\\pi y)$，其中 $B_0=1$，时间相关的不可压缩涡旋 $\\mathbf{v}(x,y,t)=(\\sin(2\\pi y)\\cos(2\\pi t),\\ -\\sin(2\\pi x)\\cos(2\\pi t))$，时间步数 $N_{\\text{step}}=25$，CFL数 $C=0.3$。\n\n算法约束：\n- 角点中心的 $E_z$ 必须根据角点中心的速度和通过将相邻面中心值平均到角点获得的角点中心磁场分量来计算。\n- 在所有插值和差分中必须强制执行周期性。\n- 时间步长 $\\Delta t$ 必须计算为 $\\Delta t=C\\min(\\Delta x,\\Delta y)/v_{\\max}$，其中 $v_{\\max}$ 是角点速度的最大模；如果 $v_{\\max}=0$，则设置 $\\Delta t=C\\min(\\Delta x,\\Delta y)$。\n\n输出规格：\n- 对于每个测试用例，计算最后时间步后单元格中心离散散度的最大绝对值。单元格 $(i,j)$ 处的离散散度为\n  $$D_{i,j}=\\frac{B_x|_{i+\\frac{1}{2},j}-B_x|_{i-\\frac{1}{2},j}}{\\Delta x}+\\frac{B_y|_{i,j+\\frac{1}{2}}-B_y|_{i,j-\\frac{1}{2}}}{\\Delta y}。$$\n- 将输出表示为无量纲浮点数。您的程序应生成一行输出，其中包含一个逗号分隔的列表，用方括号括起来（例如，`[result1,result2,result3,result4]`）。\n\n角度单位：\n- 所有三角函数均使用弧度。\n\n单位：\n- 全程使用无量纲代码单位。\n\n您的程序必须是一个完整的、可运行的实现，能够产生指定的输出，无需用户输入。", "solution": "该问题要求在二维笛卡尔网格上实现并验证用于理想磁流体动力学（MHD）感应方程的约束输运（CT）方法。主要目标是解析和数值地证明，磁场的离散散度随时间保持在机器精度内。\n\n我们从控制理想MHD中磁场 $\\mathbf{B}$ 演化的基本方程开始。这些是法拉第感应定律和理想欧姆定律：\n$$\n\\frac{\\partial \\mathbf{B}}{\\partial t} = -\\nabla \\times \\mathbf{E}\n$$\n$$\n\\mathbf{E} = -\\mathbf{v} \\times \\mathbf{B}\n$$\n其中 $\\mathbf{E}$ 是电场，$\\mathbf{v}$ 是等离子体速度。将它们结合起来得到理想感应方程：\n$$\n\\frac{\\partial \\mathbf{B}}{\\partial t} = \\nabla \\times (\\mathbf{v} \\times \\mathbf{B})\n$$\n磁场的一个基本性质是无散约束，$\\nabla \\cdot \\mathbf{B} = 0$。这个条件在感应方程下是守恒的。对法拉第定律取散度，我们发现：\n$$\n\\frac{\\partial}{\\partial t}(\\nabla \\cdot \\mathbf{B}) = \\nabla \\cdot \\left(\\frac{\\partial \\mathbf{B}}{\\partial t}\\right) = -\\nabla \\cdot (\\nabla \\times \\mathbf{E})\n$$\n由于任何矢量场的旋度的散度恒为零（$\\nabla \\cdot (\\nabla \\times \\mathbf{F}) \\equiv 0$），因此可得 $\\frac{\\partial}{\\partial t}(\\nabla \\cdot \\mathbf{B}) = 0$。这意味着如果 $\\nabla \\cdot \\mathbf{B} = 0$ 在初始时刻 $t=0$ 成立，那么它将在所有后续时间都保持为零。数值MHD中的一个关键挑战是构建一个在离散层面上也尊重这一性质的格式。约束输运方法正是为此目的而设计的。\n\n我们在一个大小为 $N_x \\times N_y$ 的均匀、周期性笛卡尔网格上离散化问题，该网格定义在域 $[0, L_x] \\times [0, L_y]$ 上，其中 $L_x=L_y=1$。网格间距为 $\\Delta x = L_x/N_x$ 和 $\\Delta y = L_y/N_y$。我们采用一种交错网格（类Yee网格），其中不同的场分量位于相对于网格单元 $(i,j)$ 的不同位置：\n- 单元格中心量位于 $(x_i, y_j) = ((i+0.5)\\Delta x, (j+0.5)\\Delta y)$。\n- 磁场的 $x$ 分量 $B_x$ 定义在 $x$ 面上，位置为 $(x_{i+1/2}, y_j) = ((i+1)\\Delta x, (j+0.5)\\Delta y)$。\n- $y$ 分量 $B_y$ 定义在 $y$ 面上，位置为 $(x_i, y_{j+1/2}) = ((i+0.5)\\Delta x, (j+1)\\Delta y)$。\n- 电场的 $z$ 分量 $E_z$ 定义在单元格角点上，位置为 $(x_{i+1/2}, y_{j+1/2}) = ((i+1)\\Delta x, (j+1)\\Delta y)$。\n\n$\\mathbf{B}$ 的离散散度自然地定义在单元格中心 $(i,j)$ 处，使用中心有限差分格式：\n$$\nD_{i,j} = \\left(\\nabla \\cdot \\mathbf{B}\\right)_{i,j} = \\frac{B_x|_{i+1/2,j} - B_x|_{i-1/2,j}}{\\Delta x} + \\frac{B_y|_{i,j+1/2} - B_y|_{i,j-1/2}}{\\Delta y}\n$$\n为确保初始离散散度为零，我们从一个角点中心的矢量势 $A_z$ 初始化磁场，$A_z$ 与 $E_z$ 位于相同的位置。磁场定义为 $A_z$ 的离散旋度：\n$$\nB_x|_{i+1/2,j} = \\frac{A_z|_{i+1/2,j+1/2} - A_z|_{i+1/2,j-1/2}}{\\Delta y}\n$$\n$$\nB_y|_{i,j+1/2} = -\\frac{A_z|_{i+1/2,j+1/2} - A_z|_{i-1/2,j+1/2}}{\\Delta x}\n$$\n将这些定义代入离散散度公式，会得到一个代数上为零的和，因为各项以伸缩级数的方式完美抵消。因此，在初始化时，$D_{i,j}=0$，精度达到机器浮点精度。\n\nCT方法使用从法拉第定律的积分形式 $\\oint_{\\partial S} \\mathbf{E} \\cdot d\\mathbf{l} = -\\frac{d}{dt}\\int_S \\mathbf{B} \\cdot d\\mathbf{A}$ 推导出的有限体积更新来演化磁场。将其应用于 $x$ 面（面积为 $\\Delta y \\times 1$）和 $y$ 面（面积为 $\\Delta x \\times 1$），可得到 $B_x$ 和 $B_y$ 的更新方程：\n$$\n\\frac{\\partial B_x|_{i+1/2,j}}{\\partial t} = -\\frac{E_z|_{i+1/2,j+1/2} - E_z|_{i+1/2,j-1/2}}{\\Delta y}\n$$\n$$\n\\frac{\\partial B_y|_{i,j+1/2}}{\\partial t} = \\frac{E_z|_{i+1/2,j+1/2} - E_z|_{i-1/2,j+1/2}}{\\Delta x}\n$$\n请注意，面中心磁场分量的时间演化由角点中心电场 $E_z$ 的离散旋度给出。此结构与从 $A_z$ 定义 $\\mathbf{B}$ 的方式相同。\n\n为了证明该格式保持零散度条件，我们考察离散散度的时间演化。为简单起见，使用前向欧拉时间步 $B^{n+1} = B^n + \\Delta t (\\partial B/\\partial t)$，第 $n+1$ 步的散度为：\n$$\nD^{n+1}_{i,j} = D^n_{i,j} + \\Delta t \\left( \\frac{(\\partial_t B_x)|_{i+1/2,j} - (\\partial_t B_x)|_{i-1/2,j}}{\\Delta x} + \\frac{(\\partial_t B_y)|_{i,j+1/2} - (\\partial_t B_y)|_{i,j-1/2}}{\\Delta y} \\right)\n$$\n乘以 $\\Delta t$ 的项是时间导数场 $\\nabla \\cdot (\\partial_t \\mathbf{B})$ 的离散散度。代入CT更新方程，该项恰好变为从 $E_z$ 的旋度派生的场的离散散度。正如用 $A_z$ 进行初始化时所展示的，这种构造会导致一个代数上为零的离散散度。因此，$D^{n+1}_{i,j} = D^n_{i,j}$。由于 $D^0_{i,j} = 0$，离散散度在所有时间都保持为零，仅受浮点舍入误差的累积限制。\n\n数值算法流程如下：\n1.  为给定的测试用例初始化网格和参数。\n2.  定义角点坐标并计算这些角点处的初始矢量势 $A_z$。\n3.  计算初始的面中心场 $B_x$ 和 $B_y$ 作为 $A_z$ 的离散旋度，确保初始离散散度为零。\n4.  计算恒定时间步长 $\\Delta t = C \\min(\\Delta x, \\Delta y) / v_{\\max}$，其中 $v_{\\max}$ 是整个模拟过程中角点速度可能的最大模值。\n5.  开始进行 $N_{\\text{step}}$ 次迭代的时间步进循环：\n    a.  计算当前时间 $t$ 每个角点处的速度分量 $(v_x, v_y)$。\n    b.  将面中心的磁场分量 $B_x$ 和 $B_y$ 平均到角点。例如，$B_x|_{i+1/2,j+1/2} = 0.5 \\left( B_x|_{i+1/2,j} + B_x|_{i+1/2,j+1} \\right)$，同时遵守周期性边界。\n    c.  计算角点电场 $E_z = v_y B_x - v_x B_y$。\n    d.  使用前向欧拉步，根据从 $E_z$ 的离散旋度计算出的时间导数来更新 $B_x$ 和 $B_y$。\n6.  在最后一步之后，计算所有单元格中心的离散散度 $D_{i,j}$。\n7.  该测试用例的最终结果是该散度数组的最大绝对值 $\\max |D_{i,j}|$。该值预期在机器epsilon的量级。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the Constrained Transport MHD simulation for all test cases.\n    \"\"\"\n    test_cases = [\n        {\n            'Nx': 32, 'Ny': 32, 'B0': 1.0, 'vel_type': 'rotation',\n            'vel_param': 0.1, 'N_step': 50, 'CFL': 0.3\n        },\n        {\n            'Nx': 16, 'Ny': 16, 'B0': 0.5, 'vel_type': 'static',\n            'vel_param': 0.0, 'N_step': 10, 'CFL': 0.5\n        },\n        {\n            'Nx': 8, 'Ny': 8, 'B0': 1.0, 'vel_type': 'shear',\n            'vel_param': 0.2, 'N_step': 40, 'CFL': 0.4\n        },\n        {\n            'Nx': 12, 'Ny': 10, 'B0': 1.0, 'vel_type': 'swirl',\n            'vel_param': None, 'N_step': 25, 'CFL': 0.3\n        }\n    ]\n\n    results = []\n    \n    for params in test_cases:\n        max_div = run_simulation(params)\n        results.append(max_div)\n\n    print(f\"[{','.join(map(str, results))}]\")\n\ndef run_simulation(params):\n    \"\"\"\n    Executes a single 2D ideal MHD simulation using the Constrained Transport method.\n    \"\"\"\n    # Unpack parameters\n    Nx, Ny = params['Nx'], params['Ny']\n    B0 = params['B0']\n    vel_type = params['vel_type']\n    vel_param = params['vel_param']\n    N_step = params['N_step']\n    CFL = params['CFL']\n\n    # Grid setup\n    Lx, Ly = 1.0, 1.0\n    dx, dy = Lx / Nx, Ly / Ny\n\n    # Define corner coordinates. These are at ((i+1)dx, (j+1)dy) for i,j in [0,N-1]\n    # np.linspace with endpoint=False gives [0, L-d], so we add d to get [d, L]\n    x_corner_1d = np.linspace(0, Lx, Nx, endpoint=False) + dx\n    y_corner_1d = np.linspace(0, Ly, Ny, endpoint=False) + dy\n    xx_c, yy_c = np.meshgrid(x_corner_1d, y_corner_1d, indexing='ij')\n    \n    # Initialize Vector Potential Az at corners\n    Az = B0 * np.sin(2 * np.pi * xx_c) * np.sin(2 * np.pi * yy_c)\n\n    # Initialize Magnetic Field Bx, By from Az to ensure div(B)=0\n    # Bx lives on x-faces (i+1/2, j)\n    # By lives on y-faces (i, j+1/2)\n    # B = curl(A), Bx=dAz/dy, By=-dAz/dx\n    # Using np.roll for periodic boundary conditions\n    Bx = (Az - np.roll(Az, 1, axis=1)) / dy\n    By = -(Az - np.roll(Az, 1, axis=0)) / dx\n\n    # Determine maximum velocity for timestep calculation\n    v_max = 0.0\n    if vel_type == 'rotation':\n        # v = (-omega*y, omega*x), max |v| at corner (Lx, Ly)\n        v_max = vel_param * np.sqrt(Lx**2 + Ly**2)\n    elif vel_type == 'static':\n        v_max = 0.0\n    elif vel_type == 'shear':\n        # v = (S*y, 0), max |v| at max y\n        v_max = vel_param * Ly\n    elif vel_type == 'swirl':\n        # v = (sin(2py)cos(2pt), -sin(2px)cos(2pt))\n        # max |v| over space and time is sqrt(1^2+1^2) = sqrt(2)\n        v_max = np.sqrt(2.0)\n\n    # Calculate timestep dt using CFL condition\n    min_ds = min(dx, dy)\n    if v_max == 0.0:\n        dt = CFL * min_ds\n    else:\n        dt = CFL * min_ds / v_max\n\n    # --- Time Evolution Loop ---\n    t = 0.0\n    for _ in range(N_step):\n        # 1. Compute velocity at corners (vx_c, vy_c)\n        if vel_type == 'rotation':\n            vx_c = -vel_param * yy_c\n            vy_c =  vel_param * xx_c\n        elif vel_type == 'static':\n            vx_c = np.zeros_like(xx_c)\n            vy_c = np.zeros_like(yy_c)\n        elif vel_type == 'shear':\n            vx_c = vel_param * yy_c\n            vy_c = np.zeros_like(yy_c)\n        elif vel_type == 'swirl':\n            cos_t = np.cos(2 * np.pi * t)\n            vx_c = np.sin(2 * np.pi * yy_c) * cos_t\n            vy_c = -np.sin(2 * np.pi * xx_c) * cos_t\n        \n        # 2. Average B from faces to corners\n        Bx_c = 0.5 * (Bx + np.roll(Bx, -1, axis=1))\n        By_c = 0.5 * (By + np.roll(By, -1, axis=0))\n\n        # 3. Compute Electric Field Ez at corners: E = -v x B => Ez = vy*Bx - vx*By\n        Ez = vy_c * Bx_c - vx_c * By_c\n\n        # 4. Update B using CT: dB/dt = -curl(E)\n        # dBx/dt = -dEz/dy\n        # dBy/dt = dEz/dx\n        dBx_dt = -(Ez - np.roll(Ez, 1, axis=1)) / dy\n        dBy_dt = (Ez - np.roll(Ez, 1, axis=0)) / dx\n\n        # 5. Simple forward Euler step\n        Bx += dBx_dt * dt\n        By += dBy_dt * dt\n\n        # Update time\n        t += dt\n\n    # --- Post-simulation: Compute final divergence ---\n    # div(B) at cell centers (i,j)\n    divB = (Bx - np.roll(Bx, 1, axis=0)) / dx + \\\n           (By - np.roll(By, 1, axis=1)) / dy\n           \n    return np.max(np.abs(divB))\n\nsolve()\n```", "id": "3479125"}, {"introduction": "数值算法的选择并非无足轻重的技术细节，它能深刻影响天体物理模拟的最终预测结果。本练习 [@problem_id:3479107] 运用一个简化模型，让您探究不同的数值格式（如黎曼求解器）和磁场散度控制方法如何直接影响由旋转黑洞驱动的喷流的能量提取效率。这个实践清晰地揭示了数值保真度与天体物理预测准确性之间的重要联系，凸显了在进行复杂模拟时审慎选择数值方法的必要性。", "problem": "要求您设计并实现一个降阶、通量守恒的模型，以比较广义相对论磁流体动力学（GRMHD）中使用的两种近似黎曼求解器，即 Harten–Lax–van Leer (HLL) 和 Harten–Lax–van Leer with Discontinuities (HLLD)，并结合约束输运（CT）散度控制或无约束输运两种情况。重点是视界尺度的喷流从旋转黑洞中发射的过程，量化磁散度误差及其对预测的喷流效率的影响。程序必须为一组测试用例计算归一化散度大小和相应的喷流效率，并将结果汇总为指定的单行格式。\n\n完全在几何化单位制下工作，其中引力常数和光速均设为1，即使用 $G=c=1$。将黑洞质量归一化为 $M_{\\mathrm{BH}}=1$，因此所有长度和时间都以 $M_{\\mathrm{BH}}$ 为单位进行测量，并要求输出无量纲的结果。\n\n仅从以下基础出发：\n\n- 麦克斯韦方程组的无散度约束为 $\\nabla\\cdot\\mathbf{B}=0$；数值格式会引入离散散度误差，其主要贡献与截断误差成比例。\n- 理想磁流体动力学中的感应方程组织了磁场的演化，而由近似黎曼求解器（例如 HLL、HLLD）计算的离散通量控制着耗散和截断误差。\n- 约束输运格式旨在维持磁场的离散无散度性，并相对于非约束格式减少主阶散度误差。\n- 对于无量纲自旋为 $a\\in[0,1)$ 的克尔黑洞，其视界半径为 $r_{\\mathrm{H}}(a)=1+\\sqrt{1-a^2}$，视界角频率为 $\\Omega_{\\mathrm{H}}(a)=\\dfrac{a}{2\\,r_{\\mathrm{H}}(a)}$。\n- 在 Blandford–Znajek 的电磁能量提取图像中，喷流功率的标度关系为 $P_{\\mathrm{BZ}}\\propto \\Phi^2 \\Omega_{\\mathrm{H}}^2$，其中 $\\Phi$ 是穿过视界的磁通量。喷流效率是喷流功率与吸积功率之比，即 $\\eta=P_{\\mathrm{jet}}/\\dot{M}$，根据上述标度关系，在忽略一个与几何相关的常数的情况下，它与 $(\\Phi^2/\\dot{M})\\Omega_{\\mathrm{H}}^2$ 成正比。\n\n构建一个遵守以下数学指定规则的降阶模型，以实现程序化计算：\n\n1. 视界几何与时间步进：\n   - 计算 $r_{\\mathrm{H}}(a)=1+\\sqrt{1-a^2}$ 和 $\\Omega_{\\mathrm{H}}(a)=\\dfrac{a}{2\\,r_{\\mathrm{H}}(a)}$。\n   - 特征长度为 $L=r_{\\mathrm{H}}(a)$。\n   - 给定一个表示跨越 $r_{\\mathrm{H}}$ 的单元数的解析度参数 $N_{\\mathrm{res}}$，设置网格尺度 $\\Delta x = L/N_{\\mathrm{res}}$。\n   - 给定一个 Courant 数 $\\mathrm{CFL}\\in(0,1)$ 并将最大特征速度设为1，定义时间步长 $\\Delta t = \\mathrm{CFL}\\,\\Delta x$。\n   - 对于一个最终时间 $t_{\\mathrm{final}}$，定义步数 $N_{\\mathrm{steps}}=t_{\\mathrm{final}}/\\Delta t$。\n\n2. 离散磁散度误差模型：\n   - 设每步的局部归一化散度振幅标度为\n     $$\\epsilon_{\\mathrm{local}} = C_0\\, f_{\\mathrm{flux}}\\, f_{\\mathrm{CT}}\\left(\\frac{\\Delta x}{L}\\right)^p,$$\n     其中 $C_0=0.25$ 是一个基础系数，对于 HLL $f_{\\mathrm{flux}}=1.0$，对于 HLLD $f_{\\mathrm{flux}}=0.6$；如果启用 CT 则 $f_{\\mathrm{CT}}=0.08$，否则 $f_{\\mathrm{CT}}=1.0$；如果启用 CT 则截断阶数 $p=2$，否则 $p=1$。\n   - 假设散度误差随时间步不相关地累积，则净归一化散度大小为\n     $$\\epsilon_{\\nabla\\cdot\\mathbf{B}} = \\sqrt{N_{\\mathrm{steps}}}\\,\\epsilon_{\\mathrm{local}} + \\epsilon_{\\mathrm{floor}},$$\n     其中数值底限 $\\epsilon_{\\mathrm{floor}}=10^{-12}$ 表示舍入效应。\n   - 将进入通量抑制的有效散度上限设为 $\\epsilon_{\\max}=0.9$，以避免非物理的负有效通量，即\n     $$\\epsilon_{\\mathrm{eff}}=\\min\\left(\\epsilon_{\\nabla\\cdot\\mathbf{B}},\\,\\epsilon_{\\max}\\right)。$$\n\n3. 考虑散度引起的通量减少的喷流效率：\n   - 将连接视界的有效磁通量建模为\n     $$\\Phi_{\\mathrm{eff}} = \\Phi\\,\\max\\left(0,\\,1 - \\chi\\,\\epsilon_{\\mathrm{eff}}\\right),$$\n     其中 $\\chi=1.0$。\n   - 使用一个校准的 Blandford–Znajek 比例常数 $\\kappa_{\\mathrm{BZ}}=0.002$ 并计算喷流效率为\n     $$\\eta = \\kappa_{\\mathrm{BZ}}\\,\\frac{\\Phi_{\\mathrm{eff}}^2}{\\dot{M}}\\,\\Omega_{\\mathrm{H}}(a)^2。$$\n\n在所选单位制中，所有量均为无量纲。程序必须精确实现上述定义，并为每个测试用例返回由归一化散度大小 $\\epsilon_{\\nabla\\cdot\\mathbf{B}}$（截断前）和使用截断后的 $\\epsilon_{\\mathrm{eff}}$ 计算的喷流效率 $\\eta$ 组成的对。报告的每个数字必须四舍五入到六位小数。\n\n测试套件：\n为以下六个参数集提供计算，每个参数集指定为一个8元组 $(a, \\dot{M}, \\Phi, N_{\\mathrm{res}}, \\mathrm{CFL}, t_{\\mathrm{final}}, \\mathrm{solver}, \\mathrm{CT})$：\n- 用例1（基准非CT，较低分辨率）： $(0.9, 1.0, 50.0, 16, 0.4, 200.0, \\text{HLL}, \\text{False})$。\n- 用例2（CT与更高保真度通量，相同分辨率）： $(0.9, 1.0, 50.0, 16, 0.4, 200.0, \\text{HLLD}, \\text{True})$。\n- 用例3（非CT，较高分辨率）： $(0.9, 1.0, 50.0, 64, 0.4, 200.0, \\text{HLL}, \\text{False})$。\n- 用例4（零自旋边界，任何散度都不应产生喷流功率）： $(0.0, 1.0, 50.0, 16, 0.4, 200.0, \\text{HLL}, \\text{False})$。\n- 用例5（弱通量边缘情况）： $(0.8, 1.0, 5.0, 32, 0.4, 200.0, \\text{HLLD}, \\text{False})$。\n- 用例6（无CT的长时间累积）： $(0.9, 1.0, 50.0, 16, 0.4, 1000.0, \\text{HLLD}, \\text{False})$。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。该列表必须按顺序包含每个测试用例的散度大小 $\\epsilon_{\\nabla\\cdot\\mathbf{B}}$（截断前）和喷流效率 $\\eta$（使用截断后的 $\\epsilon_{\\mathrm{eff}}$ 计算），每个值都四舍五入到六位小数。因此，对于六个用例，输出包含十二个数字，平铺为\n$$[\\epsilon_1, \\eta_1, \\epsilon_2, \\eta_2, \\ldots, \\epsilon_6, \\eta_6].$$", "solution": "该问题要求实现一个降阶模型，以量化吸积黑洞模拟中数值磁散度对喷流效率的影响。该模型由一组代数方程完全指定。任务是为一组给定的测试用例计算两个关键指标——归一化散度大小 $\\epsilon_{\\nabla\\cdot\\mathbf{B}}$ 和喷流效率 $\\eta$。整个问题在几何化单位制中表述，其中 $G=c=1$ 且黑洞质量归一化为 $M_{\\mathrm{BH}}=1$。\n\n解决方案是所提供模型的直接、分步实现。对于每个由8元组参数 $(a, \\dot{M}, \\Phi, N_{\\mathrm{res}}, \\mathrm{CFL}, t_{\\mathrm{final}}, \\mathrm{solver}, \\mathrm{CT})$ 指定的测试用例，我们按以下步骤进行。\n\n**步骤1：计算几何和时间步进量**\n\n首先，我们根据输入参数确定克尔黑洞时空和数值网格的属性。\n- 无量纲黑洞自旋参数为 $a$。\n- 视界半径 $r_{\\mathrm{H}}$ 使用为克尔黑洞提供的公式计算：\n$$r_{\\mathrm{H}}(a) = 1 + \\sqrt{1 - a^2}$$\n- 视界角频率 $\\Omega_{\\mathrm{H}}$ 决定了视界处的时空参考系拖拽率，由以下公式给出：\n$$\\Omega_{\\mathrm{H}}(a) = \\frac{a}{2\\,r_{\\mathrm{H}}(a)}$$\n请注意，对于非旋转黑洞（$a=0$），$\\Omega_{\\mathrm{H}}(0)=0$，这正确地反映了没有参考系拖拽。\n- 问题的特征长度尺度 $L$ 设置为视界半径，$L=r_{\\mathrm{H}}(a)$。\n- 网格尺度 $\\Delta x$ 由分辨率参数 $N_{\\mathrm{res}}$ 决定，该参数表示跨越特征长度的网格单元数：\n$$\\Delta x = \\frac{L}{N_{\\mathrm{res}}}$$\n- 时间步长 $\\Delta t$ 由 Courant-Friedrichs-Lewy (CFL) 条件确定，其中 Courant 数作为 $\\mathrm{CFL}$ 给出，最大特征速度设为1：\n$$\\Delta t = \\mathrm{CFL} \\cdot \\Delta x$$\n- 演化到最终时间 $t_{\\mathrm{final}}$ 的总时间步数 $N_{\\mathrm{steps}}$ 为：\n$$N_{\\mathrm{steps}} = \\frac{t_{\\mathrm{final}}}{\\Delta t}$$\n根据问题定义，此值被视为一个连续量。\n\n**步骤2：建立数值散度误差模型**\n\n接下来，我们计算累积的磁散度误差，该误差取决于黎曼求解器的选择以及是否使用约束输运（CT）。\n- 局部、每步散度误差 $\\epsilon_{\\mathrm{local}}$ 的模型为：\n$$\\epsilon_{\\mathrm{local}} = C_0\\, f_{\\mathrm{flux}}\\, f_{\\mathrm{CT}}\\left(\\frac{\\Delta x}{L}\\right)^p$$\n- 基础系数是一个常数，$C_0 = 0.25$。\n- 因子 $f_{\\mathrm{flux}}$ 取决于黎曼求解器：对于 HLL 为 $f_{\\mathrm{flux}}=1.0$，对于 HLLD 为 $f_{\\mathrm{flux}}=0.6$。HLLD 求解器更为复杂，模型设定其产生更小的误差。\n- 因子 $f_{\\mathrm{CT}}$ 和收敛阶数 $p$ 取决于是否使用散度控制方案（CT）。如果启用 CT，则 $f_{\\mathrm{CT}}=0.08$ 且 $p=2$，表示误差幅度显著减小且精度阶数更高。如果禁用 CT，则 $f_{\\mathrm{CT}}=1.0$ 且 $p=1$。\n- 比率 $\\frac{\\Delta x}{L}$ 简化为 $\\frac{1}{N_{\\mathrm{res}}}$。\n- 总归一化散度大小 $\\epsilon_{\\nabla\\cdot\\mathbf{B}}$ 被建模为在 $N_{\\mathrm{steps}}$ 步内的随机游走累积，外加一个数值噪声基底 $\\epsilon_{\\mathrm{floor}}$：\n$$\\epsilon_{\\nabla\\cdot\\mathbf{B}} = \\sqrt{N_{\\mathrm{steps}}}\\,\\epsilon_{\\mathrm{local}} + \\epsilon_{\\mathrm{floor}}$$\n其中 $\\epsilon_{\\mathrm{floor}} = 10^{-12}$。这是每个测试用例要报告的第一个量。\n- 为防止在效率计算中出现非物理结果，此散度被设置上限。有效散度 $\\epsilon_{\\mathrm{eff}}$ 定义为：\n$$\\epsilon_{\\mathrm{eff}} = \\min(\\epsilon_{\\nabla\\cdot\\mathbf{B}}, \\epsilon_{\\max})$$\n其最大允许值为 $\\epsilon_{\\max} = 0.9$。\n\n**步骤3：计算喷流效率**\n\n最后，我们计算喷流效率 $\\eta$，其中考虑了数值散度误差对磁通量的抑制作用。\n- 由数值引起的、穿过视界的磁通量 $\\Phi$ 的抑制被建模为：\n$$\\Phi_{\\mathrm{eff}} = \\Phi \\cdot \\max(0, 1 - \\chi\\,\\epsilon_{\\mathrm{eff}})$$\n其中抑制耦合常数为 $\\chi=1.0$。此公式确保有效通量不会变为负值。\n- 然后使用校准版的 Blandford-Znajek 公式计算喷流效率 $\\eta$：\n$$\\eta = \\kappa_{\\mathrm{BZ}}\\,\\frac{\\Phi_{\\mathrm{eff}}^2}{\\dot{M}}\\,\\Omega_{\\mathrm{H}}(a)^2$$\n其中 $\\kappa_{\\mathrm{BZ}} = 0.002$ 是给定的比例常数，$\\dot{M}$ 是质量吸积率。这是要报告的第二个量。\n\n实现将包含一个函数，该函数接收单个用例的8元组参数，按顺序执行这些计算，并返回对 $(\\epsilon_{\\nabla\\cdot\\mathbf{B}}, \\eta)$。一个主脚本将遍历所有指定的测试用例，收集结果，将对的列表平铺，将每个数字格式化为六位小数，并按所需格式打印最终的合并列表。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to orchestrate the computation for all test cases and print the final result.\n    \"\"\"\n    \n    # Test suite as defined in the problem statement.\n    # Each case is an 8-tuple:\n    # (a, M_dot, Phi, N_res, CFL, t_final, solver, CT_enabled)\n    test_cases = [\n        (0.9, 1.0, 50.0, 16, 0.4, 200.0, 'HLL', False),\n        (0.9, 1.0, 50.0, 16, 0.4, 200.0, 'HLLD', True),\n        (0.9, 1.0, 50.0, 64, 0.4, 200.0, 'HLL', False),\n        (0.0, 1.0, 50.0, 16, 0.4, 200.0, 'HLL', False),\n        (0.8, 1.0, 5.0, 32, 0.4, 200.0, 'HLLD', False),\n        (0.9, 1.0, 50.0, 16, 0.4, 1000.0, 'HLLD', False),\n    ]\n\n    results = []\n    for case in test_cases:\n        divergence_mag, jet_efficiency = compute_model_metrics(*case)\n        results.append(divergence_mag)\n        results.append(jet_efficiency)\n\n    # Format results to six decimal places and create the final output string.\n    formatted_results = [f\"{res:.6f}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\ndef compute_model_metrics(a, M_dot, Phi, N_res, CFL, t_final, solver, CT_enabled):\n    \"\"\"\n    Computes the divergence magnitude and jet efficiency for a single test case\n    based on the provided reduced-order model.\n    \"\"\"\n    # Physics and model constants\n    C0 = 0.25\n    epsilon_floor = 1e-12\n    epsilon_max = 0.9\n    chi = 1.0\n    kappa_BZ = 0.002\n\n    # Step 1: Compute Geometric and Time-Stepping Quantities\n    if a  1.0:\n        r_H = 1 + np.sqrt(1 - a**2)\n    else: # Should not happen with given inputs, but good practice\n        r_H = 1.0\n\n    # For a=0, Omega_H is 0. This is handled correctly by the formula.\n    if r_H > 0:\n        Omega_H = a / (2 * r_H)\n    else: # Should not happen\n        Omega_H = 0\n\n    L = r_H\n    delta_x = L / N_res\n    if delta_t := CFL * delta_x > 0:\n        N_steps = t_final / delta_t\n    else: # Handles cases with t_final=0 or CFL=0, etc.\n        N_steps = 0\n\n\n    # Step 2: Model the Numerical Divergence Error\n    if solver == 'HLL':\n        f_flux = 1.0\n    elif solver == 'HLLD':\n        f_flux = 0.6\n    else:\n        raise ValueError(f\"Unknown solver: {solver}\")\n\n    if CT_enabled:\n        f_CT = 0.08\n        p = 2\n    else:\n        f_CT = 1.0\n        p = 1\n        \n    # The ratio delta_x / L simplifies to 1 / N_res\n    epsilon_local = C0 * f_flux * f_CT * ((1 / N_res)**p)\n    \n    epsilon_div_B = np.sqrt(N_steps) * epsilon_local + epsilon_floor\n    \n    epsilon_eff = min(epsilon_div_B, epsilon_max)\n\n    # Step 3: Calculate the Jet Efficiency\n    Phi_eff = Phi * max(0, 1 - chi * epsilon_eff)\n    \n    eta = kappa_BZ * (Phi_eff**2 / M_dot) * (Omega_H**2)\n\n    return epsilon_div_B, eta\n\nsolve()\n```", "id": "3479107"}]}