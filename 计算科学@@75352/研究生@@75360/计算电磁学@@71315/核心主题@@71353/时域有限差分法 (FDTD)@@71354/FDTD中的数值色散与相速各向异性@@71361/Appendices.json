{"hands_on_practices": [{"introduction": "本练习是理解FDTD方法中数值色散现象的基础。通过从麦克斯韦方程组和Yee网格的离散化出发，您将亲手推导三维FDTD的数值色散关系式，这是分析所有网格效应的核心工具。在此基础上，通过计算沿主轴和对角线方向的波速，您将直接量化数值各向异性——即波速依赖于传播方向的现象，从而对仿真误差的来源有更深刻的认识。[@problem_id:3335203]", "problem": "一个无损、均匀、各向同性的介质，其光速为 $c$，使用 Yee 格式的三维时域有限差分 (FDTD) 方法进行离散化，采用相等的空间步长 $\\Delta x=\\Delta y=\\Delta z=\\Delta$ 和均匀的时间步长 $\\Delta t$。考虑由在交错网格上离散化的麦克斯韦旋度方程所描述的无源传播，并分析限制在离散时空晶格上的形式为 $E,H \\propto \\exp\\!\\big(i(k_x x + k_y y + k_z z - \\omega t)\\big)$ 的平面波解。设无量纲频率固定为 $\\Omega \\equiv \\omega \\Delta t = \\frac{3\\pi}{5}$ (弧度)，并定义 Courant 数 $S \\equiv \\frac{c\\,\\Delta t}{\\Delta}$。设传播方向由单位矢量 $\\hat{\\boldsymbol{n}}=(n_x,n_y,n_z)$ 指定，其中 $n_x^2+n_y^2+n_z^2=1$。定义无量纲慢度 (归一化到 $1/c$) 为 $\\sigma(\\hat{\\boldsymbol{n}})\\equiv \\frac{c}{v_p(\\hat{\\boldsymbol{n}})}=\\frac{c\\,k_{\\text{num}}(\\hat{\\boldsymbol{n}})}{\\omega}$，其中 $k_{\\text{num}}(\\hat{\\boldsymbol{n}})$ 是与沿方向 $\\hat{\\boldsymbol{n}}$ 的离散色散关系一致的数值波数大小。\n\n仅从无源麦克斯韦旋度方程和均匀网格上的 Yee 格式离散更新出发，推导完全离散的平面波色散关系。利用该关系式，求出在以下各个对称方向上传播时，$\\sigma(\\hat{\\boldsymbol{n}})$ 关于 $\\Omega$ 和 $S$ 的闭式表达式：\n- $\\langle 100\\rangle$: $\\hat{\\boldsymbol{n}}=(1,0,0)$，\n- $\\langle 110\\rangle$: $\\hat{\\boldsymbol{n}}=\\left(\\frac{1}{\\sqrt{2}},\\frac{1}{\\sqrt{2}},0\\right)$，\n- $\\langle 111\\rangle$: $\\hat{\\boldsymbol{n}}=\\left(\\frac{1}{\\sqrt{3}},\\frac{1}{\\sqrt{3}},\\frac{1}{\\sqrt{3}}\\right)$。\n\n您的结果必须表示为单一的行矩阵 $\\big[\\sigma_{\\langle 100\\rangle}\\;\\;\\sigma_{\\langle 110\\rangle}\\;\\;\\sigma_{\\langle 111\\rangle}\\big]$ 的闭式形式，仅使用 $\\Omega=\\frac{3\\pi}{5}$、$S$ 以及标准常数和函数。不要引入任何数值四舍五入。所有角度均以弧度表示，并将慢度表示为无量纲量（无单位）。", "solution": "首先验证该问题，以确保其具有科学依据、提法恰当且客观。已知条件为一个无损、均匀、各向同性的介质，其光速为 $c$，通过三维时域有限差分 (FDTD) 方法，使用空间步长为 $\\Delta$、时间步长为 $\\Delta t$ 的均匀 Yee 网格进行离散化。我们需要分析无源平面波的传播。关键定义包括无量纲频率 $\\Omega \\equiv \\omega \\Delta t = \\frac{3\\pi}{5}$，Courant 数 $S \\equiv \\frac{c\\,\\Delta t}{\\Delta}$，传播方向单位矢量 $\\hat{\\boldsymbol{n}}$，以及无量纲慢度 $\\sigma(\\hat{\\boldsymbol{n}})\\equiv \\frac{c}{v_p(\\hat{\\boldsymbol{n}})}=\\frac{c\\,k_{\\text{num}}(\\hat{\\boldsymbol{n}})}{\\omega}$。问题要求推导完全离散的色散关系，并用它来求出在 $\\langle 100\\rangle$、$\\langle 110\\rangle$ 和 $\\langle 111\\rangle$ 方向上的 $\\sigma$ 值。\n\n该问题是有效的。这是计算电磁学中一个标准且基础的练习，基于麦克斯韦方程和有限差分法的原理。所有术语都有精确定义，所需信息是自洽的。该问题是客观且可形式化的。我们可以开始求解。\n\n推导始于无损、均匀、各向同性介质中的无源麦克斯韦旋度方程，该介质由介电常数 $\\epsilon$ 和磁导率 $\\mu$ 表征：\n$$ \\nabla \\times \\boldsymbol{E} = -\\mu \\frac{\\partial \\boldsymbol{H}}{\\partial t} $$\n$$ \\nabla \\times \\boldsymbol{H} = \\epsilon \\frac{\\partial \\boldsymbol{E}}{\\partial t} $$\n该介质中的光速为 $c = \\frac{1}{\\sqrt{\\epsilon\\mu}}$。\n\nYee FDTD 格式在交错网格上使用中心差分近似来离散化这些方程的空间和时间导数。对于形式为 $\\boldsymbol{F}(\\boldsymbol{r}, t) = \\boldsymbol{F}_0 \\exp(i(\\boldsymbol{k}_{\\text{num}}\\cdot\\boldsymbol{r} - \\omega t))$ 的平面波解，其中 $\\boldsymbol{F}$ 是任一场分量（$\\boldsymbol{E}$ 或 $\\boldsymbol{H}$），$\\boldsymbol{k}_{\\text{num}} = (k_x, k_y, k_z)$ 是数值波矢量，可以找到离散算子的作用。\n\n作用于场分量 $F$ 的、在时间上交错 $\\Delta t/2$ 的中心差分变为：\n$$ \\frac{F^{n+1/2} - F^{n-1/2}}{\\Delta t} \\rightarrow \\frac{\\exp(-i\\omega(t_n+\\Delta t/2)) - \\exp(-i\\omega(t_n-\\Delta t/2))}{\\Delta t} F_0 \\exp(i\\boldsymbol{k}_{\\text{num}}\\cdot\\boldsymbol{r}) = \\frac{-2i}{\\Delta t}\\sin\\left(\\frac{\\omega\\Delta t}{2}\\right) F $$\n因此，在傅里叶域中，算子 $\\frac{\\partial}{\\partial t}$ 被一个乘法因子所替代：\n$$ \\frac{\\partial}{\\partial t} \\rightarrow \\frac{-2i}{\\Delta t}\\sin\\left(\\frac{\\omega\\Delta t}{2}\\right) $$\n类似地，在空间维度（例如 $x$）上交错 $\\Delta/2$ 的中心差分：\n$$ \\frac{F_{i+1/2} - F_{i-1/2}}{\\Delta} \\rightarrow \\frac{\\exp(ik_x(x_i+\\Delta/2)) - \\exp(ik_x(x_i-\\Delta/2))}{\\Delta} F_0 \\exp(i(k_y y+k_z z - \\omega t)) = \\frac{2i}{\\Delta}\\sin\\left(\\frac{k_x\\Delta}{2}\\right) F $$\n因此，空间导数算子被替换为：\n$$ \\frac{\\partial}{\\partial x_j} \\rightarrow \\frac{2i}{\\Delta}\\sin\\left(\\frac{k_j\\Delta}{2}\\right) \\quad \\text{for } j \\in \\{x,y,z\\} $$\n将这些代入麦克斯韦方程。定义作用于波的离散算子为：\n$$ \\omega_d \\equiv \\frac{2}{\\Delta t}\\sin\\left(\\frac{\\omega\\Delta t}{2}\\right) $$\n$$ K_j \\equiv \\frac{2}{\\Delta}\\sin\\left(\\frac{k_j\\Delta}{2}\\right) \\quad \\text{for } j \\in \\{x,y,z\\} $$\n离散化的麦克斯韦方程在谱域中变为：\n$$ \\boldsymbol{K} \\times \\boldsymbol{E} = \\mu \\omega_d \\boldsymbol{H} $$\n$$ \\boldsymbol{K} \\times \\boldsymbol{H} = -\\epsilon \\omega_d \\boldsymbol{E} $$\n其中 $\\boldsymbol{K} = (K_x, K_y, K_z)$。对第一个方程取旋度并代入第二个方程：\n$$ \\boldsymbol{K} \\times (\\boldsymbol{K} \\times \\boldsymbol{E}) = \\mu \\omega_d (\\boldsymbol{K} \\times \\boldsymbol{H}) = \\mu \\omega_d (-\\epsilon \\omega_d \\boldsymbol{E}) = -\\mu\\epsilon \\omega_d^2 \\boldsymbol{E} $$\n使用矢量恒等式 $\\boldsymbol{A} \\times (\\boldsymbol{B} \\times \\boldsymbol{C}) = \\boldsymbol{B}(\\boldsymbol{A} \\cdot \\boldsymbol{C}) - \\boldsymbol{C}(\\boldsymbol{A} \\cdot \\boldsymbol{B})$ 并假设横波满足 $\\boldsymbol{K} \\cdot \\boldsymbol{E} = 0$：\n$$ -\\boldsymbol{E}(\\boldsymbol{K} \\cdot \\boldsymbol{K}) = -\\mu\\epsilon \\omega_d^2 \\boldsymbol{E} $$\n这给出了代数关系 $|\\boldsymbol{K}|^2 = \\mu\\epsilon \\omega_d^2$。代入 $\\omega_d$ 和 $K_j$ 的定义，以及 $\\mu\\epsilon = 1/c^2$：\n$$ \\left(\\frac{2}{\\Delta}\\right)^2 \\left[ \\sin^2\\left(\\frac{k_x\\Delta}{2}\\right) + \\sin^2\\left(\\frac{k_y\\Delta}{2}\\right) + \\sin^2\\left(\\frac{k_z\\Delta}{2}\\right) \\right] = \\frac{1}{c^2} \\left(\\frac{2}{\\Delta t}\\right)^2 \\sin^2\\left(\\frac{\\omega\\Delta t}{2}\\right) $$\n除以 $4$ 并整理各项，我们得到 FDTD 数值色散关系：\n$$ \\frac{1}{(c\\Delta t)^2} \\sin^2\\left(\\frac{\\omega\\Delta t}{2}\\right) = \\frac{1}{\\Delta^2} \\left[ \\sin^2\\left(\\frac{k_x\\Delta}{2}\\right) + \\sin^2\\left(\\frac{k_y\\Delta}{2}\\right) + \\sin^2\\left(\\frac{k_z\\Delta}{2}\\right) \\right] $$\n使用无量纲 Courant 数 $S = \\frac{c\\Delta t}{\\Delta}$ 和无量纲频率 $\\Omega = \\omega \\Delta t$：\n$$ \\frac{1}{S^2} \\sin^2\\left(\\frac{\\Omega}{2}\\right) = \\sin^2\\left(\\frac{k_x\\Delta}{2}\\right) + \\sin^2\\left(\\frac{k_y\\Delta}{2}\\right) + \\sin^2\\left(\\frac{k_z\\Delta}{2}\\right) $$\n现在，我们引入无量纲慢度 $\\sigma = \\frac{ck_{\\text{num}}}{\\omega}$。数值波矢量的分量为 $k_j = k_{\\text{num}}n_j$，其中 $\\hat{\\boldsymbol{n}}=(n_x,n_y,n_z)$ 是传播方向。右侧正弦函数的自变量可以用 $\\sigma$、$S$ 和 $\\Omega$ 重新表示：\n$$ \\frac{k_j\\Delta}{2} = \\frac{(k_{\\text{num}}n_j)\\Delta}{2} = \\frac{(\\omega\\sigma/c)n_j\\Delta}{2} = \\frac{\\omega\\Delta t}{2} \\frac{\\sigma n_j}{c\\Delta t/\\Delta} = \\frac{(\\Omega/2)\\sigma n_j}{S} = \\frac{n_j\\Omega\\sigma}{2S} $$\n将其代入色散关系，得到关于 $\\sigma(\\hat{\\boldsymbol{n}})$ 的一个通用方程：\n$$ \\frac{1}{S^2} \\sin^2\\left(\\frac{\\Omega}{2}\\right) = \\sum_{j \\in \\{x,y,z\\}} \\sin^2\\left(\\frac{n_j\\Omega\\sigma}{2S}\\right) $$\n已知 $\\Omega = \\frac{3\\pi}{5}$，所以 $\\frac{\\Omega}{2} = \\frac{3\\pi}{10}$。我们现在求解沿三个指定对称方向的 $\\sigma$。\n\n情况1：轴向传播，$\\langle 100\\rangle$ 方向。\n此处，$\\hat{\\boldsymbol{n}} = (1, 0, 0)$。关于 $\\sigma_{\\langle 100\\rangle}$ 的方程变为：\n$$ \\frac{1}{S^2} \\sin^2\\left(\\frac{\\Omega}{2}\\right) = \\sin^2\\left(\\frac{\\Omega\\sigma_{\\langle 100\\rangle}}{2S}\\right) + 0 + 0 $$\n取正平方根：\n$$ \\frac{1}{S} \\sin\\left(\\frac{\\Omega}{2}\\right) = \\sin\\left(\\frac{\\Omega\\sigma_{\\langle 100\\rangle}}{2S}\\right) $$\n求解 $\\sigma_{\\langle 100\\rangle}$：\n$$ \\sigma_{\\langle 100\\rangle} = \\frac{2S}{\\Omega} \\arcsin\\left(\\frac{1}{S}\\sin\\left(\\frac{\\Omega}{2}\\right)\\right) = \\frac{2S}{3\\pi/5} \\arcsin\\left(\\frac{1}{S}\\sin\\left(\\frac{3\\pi}{10}\\right)\\right) = \\frac{10S}{3\\pi} \\arcsin\\left(\\frac{\\sin(\\frac{3\\pi}{10})}{S}\\right) $$\n\n情况2：平面对角线传播，$\\langle 110\\rangle$ 方向。\n此处，$\\hat{\\boldsymbol{n}} = \\left(\\frac{1}{\\sqrt{2}}, \\frac{1}{\\sqrt{2}}, 0\\right)$。关于 $\\sigma_{\\langle 110\\rangle}$ 的方程变为：\n$$ \\frac{1}{S^2} \\sin^2\\left(\\frac{\\Omega}{2}\\right) = \\sin^2\\left(\\frac{\\Omega\\sigma_{\\langle 110\\rangle}}{2\\sqrt{2}S}\\right) + \\sin^2\\left(\\frac{\\Omega\\sigma_{\\langle 110\\rangle}}{2\\sqrt{2}S}\\right) + 0 = 2\\sin^2\\left(\\frac{\\Omega\\sigma_{\\langle 110\\rangle}}{2\\sqrt{2}S}\\right) $$\n取正平方根：\n$$ \\frac{1}{S} \\sin\\left(\\frac{\\Omega}{2}\\right) = \\sqrt{2}\\sin\\left(\\frac{\\Omega\\sigma_{\\langle 110\\rangle}}{2\\sqrt{2}S}\\right) $$\n$$ \\sigma_{\\langle 110\\rangle} = \\frac{2\\sqrt{2}S}{\\Omega} \\arcsin\\left(\\frac{1}{\\sqrt{2}S}\\sin\\left(\\frac{\\Omega}{2}\\right)\\right) = \\frac{10\\sqrt{2}S}{3\\pi} \\arcsin\\left(\\frac{\\sin(\\frac{3\\pi}{10})}{\\sqrt{2}S}\\right) $$\n\n情况3：空间对角线传播，$\\langle 111\\rangle$ 方向。\n此处，$\\hat{\\boldsymbol{n}} = \\left(\\frac{1}{\\sqrt{3}}, \\frac{1}{\\sqrt{3}}, \\frac{1}{\\sqrt{3}}\\right)$。关于 $\\sigma_{\\langle 111\\rangle}$ 的方程变为：\n$$ \\frac{1}{S^2} \\sin^2\\left(\\frac{\\Omega}{2}\\right) = 3\\sin^2\\left(\\frac{\\Omega\\sigma_{\\langle 111\\rangle}}{2\\sqrt{3}S}\\right) $$\n取正平方根：\n$$ \\frac{1}{S} \\sin\\left(\\frac{\\Omega}{2}\\right) = \\sqrt{3}\\sin\\left(\\frac{\\Omega\\sigma_{\\langle 111\\rangle}}{2\\sqrt{3}S}\\right) $$\n$$ \\sigma_{\\langle 111\\rangle} = \\frac{2\\sqrt{3}S}{\\Omega} \\arcsin\\left(\\frac{1}{\\sqrt{3}S}\\sin\\left(\\frac{\\Omega}{2}\\right)\\right) = \\frac{10\\sqrt{3}S}{3\\pi} \\arcsin\\left(\\frac{\\sin(\\frac{3\\pi}{10})}{\\sqrt{3}S}\\right) $$\n\n这三个闭式表达式构成了最终答案。按要求将它们组合成一个单一的行矩阵。", "answer": "$$ \\boxed{ \\begin{bmatrix} \\frac{10S}{3\\pi} \\arcsin\\left(\\frac{\\sin\\left(\\frac{3\\pi}{10}\\right)}{S}\\right)  \\frac{10\\sqrt{2}S}{3\\pi} \\arcsin\\left(\\frac{\\sin\\left(\\frac{3\\pi}{10}\\right)}{\\sqrt{2}S}\\right)  \\frac{10\\sqrt{3}S}{3\\pi} \\arcsin\\left(\\frac{\\sin\\left(\\frac{3\\pi}{10}\\right)}{\\sqrt{3}S}\\right) \\end{bmatrix} } $$", "id": "3335203"}, {"introduction": "在认识到数值各向异性存在之后，一个自然的工程问题是如何控制它。本练习将理论分析与实际仿真设计相结合，指导您使用小参数渐近展开的方法，从复杂的色散关系中提取出主导误差项。这个过程将揭示一个简洁而重要的设计准则，它直接关联了网格分辨率（以波长 $\\lambda$ 为单位）和最大相位速度误差，让您能够在设定仿真时，为满足特定的精度要求而做出有理论依据的选择。[@problem_id:3335173]", "problem": "对三维时域有限差分（FDTD）方法进行平面波数值色散分析，其中时域有限差分（FDTD）指代真空中的标准 Yee 交错网格格式。考虑一个在所有三个方向上间距均为 $\\Delta$ 的均匀立方空间网格，以及一个时间步长 $\\Delta t$。定义 Courant 数为 $S = c\\,\\Delta t/\\Delta$，其中 $c$ 是真空中的光速。设连续波频率为 $f$，其波长为 $\\lambda = c/f$，波数大小为 $k = 2\\pi/\\lambda$。对于一个传播方向为 $\\hat{\\mathbf{k}} = (\\mu_x,\\mu_y,\\mu_z)$（满足 $\\mu_x^2+\\mu_y^2+\\mu_z^2=1$）的平面波，用 $v_p(\\hat{\\mathbf{k}})$ 表示在固定 $k$ 值下，离散格式所支持的数值相速度。\n\n从真空中的麦克斯韦方程组和 Yee 有限差分离散化出发，推导离散色散关系，并利用关于 $k\\Delta$ 的小参数渐近展开（保留足以解析角度依赖性的项），求得 $v_p(\\hat{\\mathbf{k}})$ 的领头阶角度依赖性。将固定 $k$ 值下的角度各向异性定义为\n$$\n\\mathcal{A} \\equiv \\frac{\\max_{\\hat{\\mathbf{k}}} v_p(\\hat{\\mathbf{k}}) - \\min_{\\hat{\\mathbf{k}}} v_p(\\hat{\\mathbf{k}})}{c}.\n$$\n在给定频率 $f$ 下，施加一个目标容差 $\\mathcal{A} \\le \\epsilon$，其中 $\\epsilon = 0.01$。通过界定 $v_p(\\hat{\\mathbf{k}})$ 在所有方向上的变化范围，推导出一个关于 $\\Delta/\\lambda$ 和 $S$ 的约束条件，以保证在 $k\\Delta$ 的领头阶上满足 $\\mathcal{A} \\le \\epsilon$。利用你的结果，确定最大的允许比率 $\\Delta/\\lambda$，使得在三维情况下，对于某个容许的 Courant 数 $S$，该目标得以满足。将你计算出的最大 $\\Delta/\\lambda$ 的最终数值答案四舍五入到四位有效数字。将最终数字表示为无单位的无量纲量。", "solution": "分析的出发点是无源真空中的麦克斯韦旋度方程：\n$$ \\nabla \\times \\mathbf{E} = -\\mu_0 \\frac{\\partial \\mathbf{H}}{\\partial t} $$\n$$ \\nabla \\times \\mathbf{H} = \\epsilon_0 \\frac{\\partial \\mathbf{E}}{\\partial t} $$\n其中 $\\mathbf{E}$ 是电场，$\\mathbf{H}$ 是磁场，$\\mu_0$ 和 $\\epsilon_0$ 分别是真空的磁导率和介电常数，满足 $\\mu_0\\epsilon_0 = 1/c^2$，其中 $c$ 是光速。\n\n对于均匀立方网格（间距为 $\\Delta$）上的标准 Yee FDTD 格式，我们使用中心差分来近似空间和时间导数。我们假设场的离散平面波解（ansatz）形式如下，在网格点 $(i\\Delta, j\\Delta, k\\Delta)$ 和时间步 $n\\Delta t$ 处采样：\n$$ \\mathbf{F}(i\\Delta, j\\Delta, k\\Delta, n\\Delta t) = \\mathbf{F}_0 \\exp\\left[i\\left(\\tilde{k}_x i\\Delta + \\tilde{k}_y j\\Delta + \\tilde{k}_z k\\Delta - \\tilde{\\omega} n\\Delta t\\right)\\right] $$\n其中 $\\mathbf{F}$ 代表 $\\mathbf{E}$ 或 $\\mathbf{H}$，$\\tilde{\\mathbf{k}}=(\\tilde{k}_x, \\tilde{k}_y, \\tilde{k}_z)$ 是数值波矢量，$\\tilde{\\omega}$ 是数值角频率。\n\n将此 ansatz 代入 Yee 离散化的麦克斯韦方程组，可将微分算子转换为代数因子。一个空间差分，例如 $\\frac{f(x+\\Delta/2) - f(x-\\Delta/2)}{\\Delta}$，作用于 $\\exp(i\\tilde{k}_x x)$ 会得到 $\\frac{2i}{\\Delta}\\sin(\\frac{\\tilde{k}_x\\Delta}{2})\\exp(i\\tilde{k}_x x)$。类似地，时间差分算子变为 $\\frac{-2i}{\\Delta t}\\sin(\\frac{\\tilde{\\omega}\\Delta t}{2})\\exp(-i\\tilde{\\omega}t)$。\n\n这个过程得到一个代数方程组，通过将连续算子 $(\\nabla, \\frac{\\partial}{\\partial t})$ 替换为其等效的数值对应物，可以将其简写。该系统等价于进行以下替换后的连续波方程：\n$$ k_j \\rightarrow \\tilde{k}'_j = \\frac{2}{\\Delta} \\sin\\left(\\frac{\\tilde{k}_j\\Delta}{2}\\right) \\quad \\text{for } j \\in \\{x,y,z\\} $$\n$$ \\omega \\rightarrow \\tilde{\\omega}' = \\frac{2}{\\Delta t} \\sin\\left(\\frac{\\tilde{\\omega}\\Delta t}{2}\\right) $$\n真空中的连续波色散关系为 $|\\mathbf{k}|^2 = (\\omega/c)^2$。因此，其数值对应形式为：\n$$ (\\tilde{k}'_x)^2 + (\\tilde{k}'_y)^2 + (\\tilde{k}'_z)^2 = \\left(\\frac{\\tilde{\\omega}'}{c}\\right)^2 $$\n代入 $\\tilde{k}'_j$ 和 $\\tilde{\\omega}'$ 的表达式：\n$$ \\left(\\frac{2}{\\Delta}\\right)^2 \\left[ \\sin^2\\left(\\frac{\\tilde{k}_x\\Delta}{2}\\right) + \\sin^2\\left(\\frac{\\tilde{k}_y\\Delta}{2}\\right) + \\sin^2\\left(\\frac{\\tilde{k}_z\\Delta}{2}\\right) \\right] = \\frac{1}{c^2} \\left(\\frac{2}{\\Delta t}\\right)^2 \\sin^2\\left(\\frac{\\tilde{\\omega}\\Delta t}{2}\\right) $$\n两边乘以 $\\frac{c^2(\\Delta t)^2}{4}$ 并使用 Courant 数的定义 $S = c\\Delta t/\\Delta$：\n$$ S^2 \\left[ \\sin^2\\left(\\frac{\\tilde{k}_x\\Delta}{2}\\right) + \\sin^2\\left(\\frac{\\tilde{k}_y\\Delta}{2}\\right) + \\sin^2\\left(\\frac{\\tilde{k}_z\\Delta}{2}\\right) \\right] = \\sin^2\\left(\\frac{\\tilde{\\omega}\\Delta t}{2}\\right) $$\n这就是三维 Yee FDTD 格式的数值色散关系。\n\n我们正在分析一个固定频率 $f$ 的连续波，因此我们将数值频率设置为连续频率：$\\tilde{\\omega} = \\omega = 2\\pi f = ck$。数值波矢量为 $\\tilde{\\mathbf{k}} = \\tilde{k}\\hat{\\mathbf{k}} = \\tilde{k}(\\mu_x, \\mu_y, \\mu_z)$。色散关系变为：\n$$ S^2 \\left[ \\sin^2\\left(\\frac{\\tilde{k}\\mu_x\\Delta}{2}\\right) + \\sin^2\\left(\\frac{\\tilde{k}\\mu_y\\Delta}{2}\\right) + \\sin^2\\left(\\frac{\\tilde{k}\\mu_z\\Delta}{2}\\right) \\right] = \\sin^2\\left(\\frac{\\omega\\Delta t}{2}\\right) $$\n为了求出相速度 $v_p = \\tilde{\\omega}/\\tilde{k} = \\omega/\\tilde{k}$，我们对小的 $k\\Delta$ 进行渐近展开。这意味着 $\\lambda \\gg \\Delta$，因此正弦函数的自变量很小。我们使用泰勒级数 $\\sin(x) = x - x^3/6 + O(x^5)$，这给出 $\\sin^2(x) = x^2 - x^4/3 + O(x^6)$。\n\n色散关系的右侧 (RHS) 变为：\n$$ \\text{RHS} = \\sin^2\\left(\\frac{\\omega\\Delta t}{2}\\right) = \\sin^2\\left(\\frac{ck\\Delta t}{2}\\right) = \\sin^2\\left(\\frac{k\\Delta S}{2}\\right) \\approx \\left(\\frac{k\\Delta S}{2}\\right)^2 - \\frac{1}{3}\\left(\\frac{k\\Delta S}{2}\\right)^4 = \\frac{S^2(k\\Delta)^2}{4} - \\frac{S^4(k\\Delta)^4}{48} $$\n色散关系的左侧 (LHS) 变为：\n$$ \\text{LHS} = S^2 \\sum_{j \\in \\{x,y,z\\}} \\sin^2\\left(\\frac{\\tilde{k}\\mu_j\\Delta}{2}\\right) \\approx S^2 \\sum_j \\left[ \\left(\\frac{\\tilde{k}\\mu_j\\Delta}{2}\\right)^2 - \\frac{1}{3}\\left(\\frac{\\tilde{k}\\mu_j\\Delta}{2}\\right)^4 \\right] $$\n$$ \\text{LHS} \\approx S^2 \\left[ \\frac{(\\tilde{k}\\Delta)^2}{4}\\sum_j\\mu_j^2 - \\frac{(\\tilde{k}\\Delta)^4}{48}\\sum_j\\mu_j^4 \\right] $$\n由于 $\\sum_j\\mu_j^2 = 1$：\n$$ \\text{LHS} \\approx S^2\\frac{(\\tilde{k}\\Delta)^2}{4} - S^2\\frac{(\\tilde{k}\\Delta)^4}{48}\\sum_j\\mu_j^4 $$\n令展开后的 LHS 和 RHS 相等：\n$$ S^2\\frac{(\\tilde{k}\\Delta)^2}{4} - S^2\\frac{(\\tilde{k}\\Delta)^4}{48}\\sum_j\\mu_j^4 \\approx \\frac{S^2(k\\Delta)^2}{4} - \\frac{S^4(k\\Delta)^4}{48} $$\n两边除以 $S^2(\\Delta^2/4)$：\n$$ \\tilde{k}^2 - \\frac{\\tilde{k}^4\\Delta^2}{12}\\sum_j\\mu_j^4 \\approx k^2 - \\frac{S^2k^4\\Delta^2}{12} $$\n为了求解 $\\tilde{k}$，我们使用微扰法。在领头阶上，$\\tilde{k} \\approx k$。我们将此代入高阶项中：\n$$ \\tilde{k}^2 \\approx k^2 - \\frac{S^2k^4\\Delta^2}{12} + \\frac{k^4\\Delta^2}{12}\\sum_j\\mu_j^4 = k^2\\left[1 - \\frac{(k\\Delta)^2}{12}\\left(S^2 - \\sum_j\\mu_j^4\\right)\\right] $$\n$$ \\tilde{k} \\approx k\\left[1 - \\frac{(k\\Delta)^2}{12}\\left(S^2 - \\sum_j\\mu_j^4\\right)\\right]^{1/2} \\approx k\\left[1 - \\frac{(k\\Delta)^2}{24}\\left(S^2 - \\sum_j\\mu_j^4\\right)\\right] $$\n归一化数值相速度为 $v_p/c = (\\omega/\\tilde{k})/c = k/\\tilde{k}$：\n$$ \\frac{v_p(\\hat{\\mathbf{k}})}{c} = \\frac{k}{\\tilde{k}} \\approx \\left[1 - \\frac{(k\\Delta)^2}{24}\\left(S^2 - \\sum_j\\mu_j^4\\right)\\right]^{-1} \\approx 1 + \\frac{(k\\Delta)^2}{24}\\left(S^2 - \\sum_j\\mu_j^4\\right) $$\n各向异性 $\\mathcal{A}$ 取决于 $v_p$ 随方向 $\\hat{\\mathbf{k}}$ 的变化。这种变化由项 $F(\\hat{\\mathbf{k}}) = \\sum_j\\mu_j^4 = \\mu_x^4+\\mu_y^4+\\mu_z^4$ 控制。我们需在约束条件 $\\mu_x^2+\\mu_y^2+\\mu_z^2=1$ 下求出 $F$ 的最小值和最大值。\n令 $x=\\mu_x^2, y=\\mu_y^2, z=\\mu_z^2$。我们寻求在约束条件 $x+y+z=1$ 和 $x,y,z \\ge 0$ 下 $x^2+y^2+z^2$ 的极值。\n最大值出现在约束域的顶点处，例如 $(x,y,z)=(1,0,0)$。这对应于沿网格轴的传播，例如 $\\hat{\\mathbf{k}} = (1,0,0)$。\n$$ F_{\\max} = 1^4+0^4+0^4 = 1 $$\n最小值出现在 $x=y=z=1/3$ 时。这对应于沿空间对角线的传播，例如 $\\hat{\\mathbf{k}} = (1/\\sqrt{3}, 1/\\sqrt{3}, 1/\\sqrt{3})$。\n$$ F_{\\min} = 3 \\times (1/\\sqrt{3})^4 = 3 \\times (1/9) = 1/3 $$\n由于其公式中的负号，当 $\\sum_j \\mu_j^4$ 最小时相速度最大，而当 $\\sum_j \\mu_j^4$ 最大时相速度最小：\n$$ \\frac{v_{p,\\max}}{c} \\approx 1 + \\frac{(k\\Delta)^2}{24}(S^2 - F_{\\min}) = 1 + \\frac{(k\\Delta)^2}{24}\\left(S^2 - \\frac{1}{3}\\right) $$\n$$ \\frac{v_{p,\\min}}{c} \\approx 1 + \\frac{(k\\Delta)^2}{24}(S^2 - F_{\\max}) = 1 + \\frac{(k\\Delta)^2}{24}(S^2 - 1) $$\n各向异性定义为 $\\mathcal{A} \\equiv (\\max v_p - \\min v_p)/c$：\n$$ \\mathcal{A} = \\frac{v_{p,\\max}}{c} - \\frac{v_{p,\\min}}{c} \\approx \\frac{(k\\Delta)^2}{24}\\left[\\left(S^2 - \\frac{1}{3}\\right) - (S^2 - 1)\\right] = \\frac{(k\\Delta)^2}{24}\\left(1 - \\frac{1}{3}\\right) = \\frac{(k\\Delta)^2}{24}\\left(\\frac{2}{3}\\right) $$\n$$ \\mathcal{A} \\approx \\frac{(k\\Delta)^2}{36} $$\n这个关于各向异性的领头阶结果与 Courant 数 $S$ 无关。题目要求对于*某个*容许的 $S$ 满足此条件。对于三维 Yee 格式，稳定性条件是 $S \\le 1/\\sqrt{3}$。由于我们得到的 $\\mathcal{A}$ 的结果与 $S$ 无关，因此可以选择任何稳定的 $S$ 而不影响各向异性约束。\n\n我们给定的容差为 $\\mathcal{A} \\le \\epsilon$，其中 $\\epsilon=0.01$。代入 $k = 2\\pi/\\lambda$：\n$$ \\frac{((2\\pi/\\lambda)\\Delta)^2}{36} \\le \\epsilon $$\n$$ \\frac{4\\pi^2(\\Delta/\\lambda)^2}{36} \\le \\epsilon $$\n$$ \\frac{\\pi^2}{9}\\left(\\frac{\\Delta}{\\lambda}\\right)^2 \\le \\epsilon $$\n$$ \\left(\\frac{\\Delta}{\\lambda}\\right)^2 \\le \\frac{9\\epsilon}{\\pi^2} $$\n因此，最大允许比率 $\\Delta/\\lambda$ 为：\n$$ \\left(\\frac{\\Delta}{\\lambda}\\right)_{\\max} = \\sqrt{\\frac{9\\epsilon}{\\pi^2}} = \\frac{3\\sqrt{\\epsilon}}{\\pi} $$\n代入 $\\epsilon = 0.01$：\n$$ \\left(\\frac{\\Delta}{\\lambda}\\right)_{\\max} = \\frac{3\\sqrt{0.01}}{\\pi} = \\frac{3 \\times 0.1}{\\pi} = \\frac{0.3}{\\pi} $$\n现在，我们计算数值并四舍五入到四位有效数字：\n$$ \\left(\\frac{\\Delta}{\\lambda}\\right)_{\\max} \\approx \\frac{0.3}{3.14159265...} \\approx 0.0954929658... $$\n四舍五入到四位有效数字得到 $0.09549$。", "answer": "$$\\boxed{0.09549}$$", "id": "3335173"}, {"introduction": "虽然渐近分析提供了宝贵的设计指导，但完整的数值探索能揭示更丰富的细节。本练习是一个计算实践，要求您编写程序来实现之前推导的色散公式，并通过参数扫描系统地研究数值各向异性。通过绘制误差等高线图和寻找最优工作点，您将学习到一种在实践中平衡精度、稳定性和计算成本的通用方法，这是计算科学家必备的核心技能。[@problem_id:3335136]", "problem": "考虑在真空中，使用时域有限差分（FDTD）方法在均匀正交Yee网格上离散化的二维电磁波，其中空间步长相等，为 $\\Delta x = \\Delta y = \\Delta$，时间步长为 $\\Delta t$。定义无量纲Courant数 $S = c \\, \\Delta t / \\Delta$，其中 $c$ 是真空光速。假设一个平面波解，其传播波数矢量为 $\\mathbf{k} = (k_x, k_y)$，大小为 $k = \\|\\mathbf{k}\\|$，方向单位矢量为 $\\hat{\\mathbf{k}} = (\\cos \\theta, \\sin \\theta)$，角频率为 $\\omega$。定义无量纲空间采样参数 $\\alpha = k \\Delta$。所有角度都必须以弧度为单位指定和使用。\n\n从真空中的宏观麦克斯韦方程组和Yee交错网格离散化出发，推导在相等空间步长下二维传播的数值色散关系。基于此结果，推导数值相速度 $v_p(\\theta; S, \\alpha)$ 的公式，以及方向性相对相速度误差\n$$\nE(\\theta; S, \\alpha) = \\left| \\frac{v_p(\\theta; S, \\alpha) - c}{c} \\right|.\n$$\n将各向异性度量定义为在所有传播方向上的最坏情况角度误差\n$$\nA(S,\\alpha) = \\max_{\\theta \\in [0,\\pi/2]} E(\\theta; S, \\alpha),\n$$\n由于对称性，将 $\\theta$ 限制在 $[0,\\pi/2]$ 范围内是足够的。对于二维等步长Yee网格，数值稳定性条件要求 $S \\le 1/\\sqrt{2}$；请将 $S$ 限制在闭区间 $[0.1, 0.705]$ 内。\n\n编写一个完整的程序，该程序：\n- 仅使用基本常数和无量纲参数 $S$ 和 $\\alpha$ 实现推导出的 $v_p(\\theta; S, \\alpha)$ 表达式，并计算 $E(\\theta; S, \\alpha)$。\n- 通过在 $\\theta \\in [0,\\pi/2]$ 上均匀采样 $N_\\theta = 1441$ 个点进行数值最大化，来计算 $A(S,\\alpha)$。\n- 在 $S \\in \\{ 0.100, 0.101, \\ldots, 0.705 \\}$ 上进行参数扫描，以在网格上评估 $A(S,\\alpha)$。\n- 对于给定的误差水平 $\\varepsilon  0$，将在给定 $\\alpha$ 下的等各向异性轮廓点定义为在扫描范围内使 $\\left|A(S,\\alpha) - \\varepsilon\\right|$ 最小的任意 $S$。报告找到的 $S$ 值以及在该 $S$ 值下达到的各向异性水平。\n- 将在给定 $\\alpha$ 下的最小角度误差工作点定义为在扫描范围内使 $A(S,\\alpha)$ 最小的任意 $S$。报告找到的 $S$ 值以及最小各向异性水平。\n\n所有量都是无量纲的，所有角度都必须以弧度处理。您的程序必须使用上述定义，并按照规定通过均匀采样执行数值最大化。\n\n测试套件和答案规范：\n- 使用以下四个测试用例，每个用例都按下列顺序返回一对浮点数作为所要求的值。对于返回的每一对值，报告四舍五入到六位小数的结果。\n  1. 对于 $\\alpha_1 = 1.0$，返回最小角度误差工作点 $[S_{\\text{opt}}(\\alpha_1), A_{\\min}(\\alpha_1)]$，其中 $S_{\\text{opt}}(\\alpha_1) = \\arg\\min_{S \\in [0.1,0.705]} A(S,\\alpha_1)$ 且 $A_{\\min}(\\alpha_1) = \\min_{S \\in [0.1,0.705]} A(S,\\alpha_1)$。\n  2. 对于 $\\alpha_2 = 1.5$ 和等值水平 $\\varepsilon_2 = 0.02$，返回等各向异性轮廓点 $[S_{\\varepsilon_2}(\\alpha_2), A(S_{\\varepsilon_2}(\\alpha_2), \\alpha_2)]$，其中 $S_{\\varepsilon_2}(\\alpha_2) = \\arg\\min_{S \\in [0.1,0.705]} |A(S,\\alpha_2)-\\varepsilon_2|$。\n  3. 对于 $\\alpha_3 = 0.5$ 和等值水平 $\\varepsilon_3 = 0.005$，根据相同定义返回等各向异性轮廓点 $[S_{\\varepsilon_3}(\\alpha_3), A(S_{\\varepsilon_3}(\\alpha_3), \\alpha_3)]$。\n  4. 为了在更高空间频率下进行边界测试，对于 $\\alpha_4 = 2.5$，返回最小角度误差工作点 $[S_{\\text{opt}}(\\alpha_4), A_{\\min}(\\alpha_4)]$。\n\n最终输出格式：\n- 您的程序应生成一行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，列表中的每个条目本身是对应一个测试用例的双元素列表。顺序必须与上述四个测试用例匹配。例如，打印的行必须类似于 $[\\,[S_1,A_1],[S_2,A_2],[S_3,A_3],[S_4,A_4]\\,]$，所有浮点数均四舍五入到六位小数。", "solution": "用户提供的问题被评估为有效，因为它科学地基于计算电磁学的原理，问题定义明确，目标客观，并包含一套完整且一致的定义和约束。这些任务在数值方法的分析中是标准的，并且并非微不足道。因此，有必要提供完整的解决方案。\n\n问题的核心是推导和分析在等空间步长的Yee网格上，二维（2D）时域有限差分（FDTD）方法的数值色散关系。\n\n### 数值色散关系的推导\n\n我们从无源真空中的麦克斯韦旋度方程组开始，考虑横磁（$TM_z$）波，其场分量为 $E_z$、$H_x$ 和 $H_y$：\n$$ \\frac{\\partial E_z}{\\partial t} = \\frac{1}{\\varepsilon_0} \\left( \\frac{\\partial H_y}{\\partial x} - \\frac{\\partial H_x}{\\partial y} \\right) $$\n$$ \\frac{\\partial H_x}{\\partial t} = -\\frac{1}{\\mu_0} \\frac{\\partial E_z}{\\partial y} $$\n$$ \\frac{\\partial H_y}{\\partial t} = \\frac{1}{\\mu_0} \\frac{\\partial E_z}{\\partial x} $$\n\nFDTD方法在Yee网格上离散化这些方程。在均匀空间步长 $\\Delta x = \\Delta y = \\Delta$ 和时间步长 $\\Delta t$ 的条件下，偏导数由二阶精度的中心有限差分近似。对于形式为 $F(x,y,t) = F_0 e^{i(k_x x + k_y y - \\omega t)}$ 的谐波平面波解，其中 $F$ 是任意场分量，连续微分算子 $(\\frac{\\partial}{\\partial t}, \\frac{\\partial}{\\partial x}, \\frac{\\partial}{\\partial y})$ 在谱域中被转换为乘法因子。对于标准的Yee格式，这种转换为：\n$$ \\frac{\\partial}{\\partial t} \\rightarrow \\frac{-2i}{\\Delta t} \\sin\\left(\\frac{\\omega \\Delta t}{2}\\right) $$\n$$ \\frac{\\partial}{\\partial x} \\rightarrow \\frac{2i}{\\Delta} \\sin\\left(\\frac{k_x \\Delta}{2}\\right) $$\n$$ \\frac{\\partial}{\\partial y} \\rightarrow \\frac{2i}{\\Delta} \\sin\\left(\\frac{k_y \\Delta}{2}\\right) $$\n这里，$\\omega$ 是数值角频率，$k_x$ 和 $k_y$ 是数值波数，我们假设它们与入射波的连续对应量相同。\n\n将这些代入麦克斯韦方程组（在相量域中，$\\partial/\\partial t \\rightarrow i\\omega$）得到关于场振幅 $E_{z0}, H_{x0}, H_{y0}$ 的代数方程组：\n$$ \\frac{2i}{\\Delta t}\\sin\\left(\\frac{\\omega \\Delta t}{2}\\right) E_{z0} = \\frac{1}{\\varepsilon_0} \\left( \\frac{2i}{\\Delta}\\sin\\left(\\frac{k_x \\Delta}{2}\\right) H_{y0} - \\frac{2i}{\\Delta}\\sin\\left(\\frac{k_y \\Delta}{2}\\right) H_{x0} \\right) $$\n$$ \\frac{2i}{\\Delta t}\\sin\\left(\\frac{\\omega \\Delta t}{2}\\right) H_{x0} = -\\frac{1}{\\mu_0} \\frac{2i}{\\Delta}\\sin\\left(\\frac{k_y \\Delta}{2}\\right) E_{z0} $$\n$$ \\frac{2i}{\\Delta t}\\sin\\left(\\frac{\\omega \\Delta t}{2}\\right) H_{y0} = \\frac{1}{\\mu_0} \\frac{2i}{\\Delta}\\sin\\left(\\frac{k_x \\Delta}{2}\\right) E_{z0} $$\n\n从后两个方程中，我们将 $H_{x0}$ 和 $H_{y0}$ 用 $E_{z0}$ 表示：\n$$ H_{x0} = -\\frac{\\Delta t}{\\mu_0 \\Delta} \\frac{\\sin(k_y \\Delta / 2)}{\\sin(\\omega \\Delta t / 2)} E_{z0} $$\n$$ H_{y0} = \\frac{\\Delta t}{\\mu_0 \\Delta} \\frac{\\sin(k_x \\Delta / 2)}{\\sin(\\omega \\Delta t / 2)} E_{z0} $$\n\n将这些代入 $E_{z0}$ 的方程并化简，消去场振幅，得到数值色散关系：\n$$ \\left( \\frac{1}{c\\Delta t} \\sin\\left(\\frac{\\omega \\Delta t}{2}\\right) \\right)^2 = \\left( \\frac{1}{\\Delta} \\sin\\left(\\frac{k_x \\Delta}{2}\\right) \\right)^2 + \\left( \\frac{1}{\\Delta} \\sin\\left(\\frac{k_y \\Delta}{2}\\right) \\right)^2 $$\n其中 $c = 1/\\sqrt{\\varepsilon_0\\mu_0}$ 是真空光速。\n\n### 数值相速度与各向异性\n\n为了分析此关系，我们引入指定的无量纲参数：Courant数 $S = c\\Delta t/\\Delta$、空间采样参数 $\\alpha = k\\Delta$ 以及传播角 $\\theta$，其中 $k_x = k\\cos\\theta$ 和 $k_y = k\\sin\\theta$。数值色散关系变为：\n$$ \\left( \\frac{1}{S} \\sin\\left(\\frac{\\omega \\Delta t}{2}\\right) \\right)^2 = \\sin^2\\left(\\frac{k\\Delta\\cos\\theta}{2}\\right) + \\sin^2\\left(\\frac{k\\Delta\\sin\\theta}{2}\\right) $$\n$$ \\sin\\left(\\frac{\\omega \\Delta t}{2}\\right) = S \\sqrt{\\sin^2\\left(\\frac{\\alpha\\cos\\theta}{2}\\right) + \\sin^2\\left(\\frac{\\alpha\\sin\\theta}{2}\\right)} $$\n\n数值相速度定义为 $v_p = \\omega/k$。我们可以从上述关系中解出 $\\omega$：\n$$ \\omega = \\frac{2}{\\Delta t} \\arcsin\\left( S \\sqrt{\\sin^2\\left(\\frac{\\alpha\\cos\\theta}{2}\\right) + \\sin^2\\left(\\frac{\\alpha\\sin\\theta}{2}\\right)} \\right) $$\n然后，我们求出归一化到 $c$ 的相速度：\n$$ \\frac{v_p(\\theta; S, \\alpha)}{c} = \\frac{\\omega}{ck} = \\frac{\\omega \\Delta}{ck\\Delta} = \\frac{\\omega \\Delta}{c\\alpha} = \\frac{\\Delta}{c\\alpha} \\frac{2}{\\Delta t} \\arcsin(\\dots) = \\frac{2}{\\alpha S} \\arcsin(\\dots) $$\n这给出了归一化数值相速度的最终公式：\n$$ \\frac{v_p(\\theta; S, \\alpha)}{c} = \\frac{2}{\\alpha S} \\arcsin\\left( S \\sqrt{\\sin^2\\left(\\frac{\\alpha\\cos\\theta}{2}\\right) + \\sin^2\\left(\\frac{\\alpha\\sin\\theta}{2}\\right)} \\right) $$\n\n方向性相对相速度误差 $E$ 则为：\n$$ E(\\theta; S, \\alpha) = \\left| \\frac{v_p(\\theta; S, \\alpha)}{c} - 1 \\right| $$\n各向异性度量 $A(S, \\alpha)$ 是该误差在传播角 $\\theta \\in [0, \\pi/2]$ 上的最大值：\n$$ A(S,\\alpha) = \\max_{\\theta \\in [0,\\pi/2]} E(\\theta; S, \\alpha) $$\n\n### 数值实现\n程序将实现推导出的 $E(\\theta; S, \\alpha)$ 公式，并按规定执行数值任务。\n1. 基于推导的表达式实现一个计算 $E(\\theta; S, \\alpha)$ 的函数。\n2. 通过在 $\\theta \\in [0, \\pi/2]$ 的均匀网格（含 $N_\\theta = 1441$ 个点）上数值计算 $E$ 并找到最大值，来计算各向异性 $A(S,\\alpha)$。\n3. 对 $S \\in [0.100, 0.705]$ 以 $0.001$ 为步长进行参数扫描。对于来自测试用例的给定 $\\alpha$，为扫描中的每个 $S$ 计算 $A(S,\\alpha)$。\n4. 为了找到最小角度误差的工作点，程序找到计算出的 $A(S,\\alpha)$ 数组的最小值及对应的 $S$。\n5. 为了找到给定 $\\varepsilon$ 的等各向异性轮廓点，程序找到使绝对差 $|A(S,\\alpha) - \\varepsilon|$ 最小的 $S$ 值。\n6. 计算四个指定测试用例的结果，并将其格式化为所需的输出字符串。\n\n该实现使用 `numpy` 在 $S$ 和 $\\theta$ 值的网格上高效地进行 $E$ 的矢量化计算，以确保正确性和性能。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the FDTD numerical dispersion problem by deriving and implementing\n    the formulas for phase velocity error and anisotropy, and then performing\n    parametric sweeps to find optimal operating points as specified.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (alpha, kind, parameter)\n        (1.0, 'min', None),     # Case 1: Minimal error for alpha=1.0\n        (1.5, 'iso', 0.02),     # Case 2: Iso-contour for alpha=1.5, epsilon=0.02\n        (0.5, 'iso', 0.005),    # Case 3: Iso-contour for alpha=0.5, epsilon=0.005\n        (2.5, 'min', None)      # Case 4: Minimal error for alpha=2.5\n    ]\n\n    # Set up numerical grids as per the problem description.\n    # Grid for maximizing over theta\n    N_theta = 1441\n    theta_grid = np.linspace(0, np.pi / 2, N_theta)\n\n    # Grid for sweeping the Courant number S\n    # S ranges from 0.100 to 0.705 in steps of 0.001\n    s_start, s_end, s_step = 0.100, 0.705, 0.001\n    num_s_points = int(round((s_end - s_start) / s_step)) + 1\n    S_sweep = np.linspace(s_start, s_end, num_s_points)\n\n    final_results = []\n\n    for alpha, kind, epsilon in test_cases:\n        # Use broadcasting for efficient vectorized computation over S and theta grids.\n        # S_b will have shape (num_s_points, 1)\n        # theta_b will have shape (1, N_theta)\n        S_b = S_sweep[:, np.newaxis]\n        theta_b = theta_grid[np.newaxis, :]\n\n        # Calculate the argument for the arcsin function in the dispersion relation.\n        # This part of the calculation depends on both S and theta.\n        arg_sin_x = alpha * np.cos(theta_b) / 2\n        arg_sin_y = alpha * np.sin(theta_b) / 2\n        \n        sqrt_term = np.sqrt(np.sin(arg_sin_x)**2 + np.sin(arg_sin_y)**2)\n        \n        # The argument of arcsin must be = 1. This is guaranteed by the stability\n        # condition S = 1/sqrt(2), which our sweep range respects.\n        arcsin_arg = S_b * sqrt_term\n        \n        # Calculate normalized phase velocity vp/c.\n        vp_over_c = (2 / (alpha * S_b)) * np.arcsin(arcsin_arg)\n        \n        # Calculate the directional relative phase velocity error E.\n        # E_matrix has shape (num_s_points, N_theta).\n        E_matrix = np.abs(vp_over_c - 1)\n        \n        # Calculate the anisotropy metric A(S, alpha) by maximizing E over theta for each S.\n        # A_values is an array of shape (num_s_points,).\n        A_values = np.max(E_matrix, axis=1)\n\n        # Process the results based on the test case type ('min' or 'iso').\n        if kind == 'min':\n            # Find the index of the minimum anisotropy value.\n            idx = np.argmin(A_values)\n            s_opt = S_sweep[idx]\n            a_min = A_values[idx]\n            final_results.append([s_opt, a_min])\n        elif kind == 'iso':\n            # Find the index where A is closest to the target epsilon.\n            diffs = np.abs(A_values - epsilon)\n            idx = np.argmin(diffs)\n            s_iso = S_sweep[idx]\n            a_at_s_iso = A_values[idx]\n            final_results.append([s_iso, a_at_s_iso])\n\n    # Format the final output string as specified.\n    # Each number is rounded to six decimal places.\n    formatted_pairs = [f\"[{s:.6f},{a:.6f}]\" for s, a in final_results]\n    output_string = f\"[{','.join(formatted_pairs)}]\"\n    \n    # Final print statement in the exact required format.\n    print(output_string)\n\nsolve()\n```", "id": "3335136"}]}