{"hands_on_practices": [{"introduction": "本实践探讨一个经典问题：如何在电准静态（EQS）近似下分析含损耗介质的传输线结构。通过从麦克斯韦方程组出发，您将亲手推导出一个同轴电缆的导纳，并学习如何运用复介电常数 $\\epsilon^{*}$ 的概念，将介质的电导损耗和位移电流统一处理。这项练习能够加深您对准静态场与路之间联系的理解，并将理论知识应用于实际的无源器件分析中。[@problem_id:3326252]", "problem": "一个长度为 $L$ 的理想导电、无限薄壁的同轴结构，由一个半径为 $a$ 的内圆柱电极和一个内半径为 $b$ 的同心外圆柱电极组成，其中 $0  a  b$。电极之间的空间由一种均匀的、各向同性的、有损耗的电介质填充，其介电常数 $\\epsilon$ 和电导率 $\\sigma$ 均为常数。在电极之间施加一个时谐电压 $V(t) = V_{0} \\cos(\\omega t)$，其中 $V_{0}$ 是振幅，$\\omega$ 是角频率。假设该结构在电准静态 (EQS) 体系下工作，请推导出该同轴结构的单位长度导纳 $Y$（单位：S/m）。将您的最终答案表示为仅包含 $\\sigma$、$\\omega$、$\\epsilon$、$a$ 和 $b$ 的复数表达式，使用 $j = \\sqrt{-1}$ 表示虚数单位。不需要任何数值代入。", "solution": "在尝试求解之前，首先对问题进行验证，以确保其在科学上是合理的、适定的和客观的。\n\n### 第1步：提取已知条件\n-   **结构：** 理想导电、无限薄壁的同轴结构。\n-   **长度：** $L$。\n-   **半径：** 内电极半径 $a$，外电极内半径 $b$，且 $0  a  b$。\n-   **介质：** 均匀、各向同性、有损耗，具有恒定的介电常数 $\\epsilon$ 和电导率 $\\sigma$。\n-   **激励：** 时谐电压 $V(t) = V_{0} \\cos(\\omega t)$，即 $V = \\Re\\{V_0 e^{j\\omega t}\\}$。\n-   **假设：** 电准静态（EQS）近似适用。\n-   **目标：** 推导单位长度导纳 $Y$。\n\n### 第2步：分析问题\n在 EQS 近似下，电场 $\\mathbf{E}$ 是无旋的 ($\\nabla \\times \\mathbf{E} \\approx \\mathbf{0}$)，因此可以表示为标量电势 $\\phi$ 的负梯度，$\\mathbf{E} = -\\nabla\\phi$。在无源区域，高斯定律 $\\nabla \\cdot (\\epsilon \\mathbf{E}) = 0$ 成立，这意味着 $\\nabla^2 \\phi = 0$。\n\n由于结构的圆柱对称性，电势 $\\phi$ 和电场 $\\mathbf{E}$ 仅依赖于径向坐标 $r$。拉普拉斯方程变为：\n$$ \\frac{1}{r}\\frac{d}{dr}\\left(r\\frac{d\\phi}{dr}\\right) = 0 $$\n积分两次得到 $\\phi(r) = C_1 \\ln(r) + C_2$。我们施加边界条件：$\\phi(a) - \\phi(b) = V_0$（假设内导体电势高）和 $\\phi(b)=0$（作为参考）。\n-   $\\phi(b) = C_1 \\ln(b) + C_2 = 0 \\implies C_2 = -C_1 \\ln(b)$\n-   $\\phi(a) = C_1 \\ln(a) + C_2 = V_0 \\implies C_1(\\ln(a) - \\ln(b)) = V_0$\n-   $C_1 = \\frac{V_0}{\\ln(a/b)} = -\\frac{V_0}{\\ln(b/a)}$\n\n电场为 $\\mathbf{E} = -\\frac{d\\phi}{dr}\\hat{\\mathbf{r}} = -\\frac{C_1}{r}\\hat{\\mathbf{r}} = \\frac{V_0}{r\\ln(b/a)}\\hat{\\mathbf{r}}$。\n\n总电流由传导电流和位移电流两部分组成，总电流密度为 $\\mathbf{J}_{\\text{total}} = \\mathbf{J}_{\\text{cond}} + \\mathbf{J}_{\\text{disp}} = \\sigma\\mathbf{E} + \\frac{\\partial(\\epsilon\\mathbf{E})}{\\partial t}$。在相量表示法中，$\\frac{\\partial}{\\partial t} \\to j\\omega$，因此 $\\mathbf{J}_{\\text{total}} = (\\sigma + j\\omega\\epsilon)\\mathbf{E}$。\n\n总电流 $I$ 是电流密度在任一半径为 $r$ 的圆柱面上的积分：\n$$ I = \\int_S \\mathbf{J}_{\\text{total}} \\cdot d\\mathbf{S} = J_{\\text{total}}(r) \\cdot (2\\pi r L) = (\\sigma + j\\omega\\epsilon)E(r) \\cdot (2\\pi r L) $$\n$$ I = (\\sigma + j\\omega\\epsilon) \\frac{V_0}{r\\ln(b/a)} (2\\pi r L) = \\frac{2\\pi L (\\sigma + j\\omega\\epsilon)}{\\ln(b/a)} V_0 $$\n导纳 $Y_{\\text{total}}$ 定义为总电流与电压之比：\n$$ Y_{\\text{total}} = \\frac{I}{V_0} = \\frac{2\\pi L (\\sigma + j\\omega\\epsilon)}{\\ln(b/a)} $$\n问题要求单位长度导纳 $Y = Y_{\\text{total}} / L$。\n$$ Y = \\frac{2\\pi (\\sigma + j\\omega\\epsilon)}{\\ln(b/a)} $$\n这与复电导率 $\\sigma^* = \\sigma + j\\omega\\epsilon$ 或复介电常数 $\\epsilon^* = \\epsilon - j\\sigma/\\omega$ 的概念一致。最终答案与预期形式匹配。", "answer": "$$\\boxed{\\frac{2\\pi (\\sigma + j\\omega\\epsilon)}{\\ln\\left(\\frac{b}{a}\\right)}}$$", "id": "3326252"}, {"introduction": "从频域的EQS分析转向时域的磁准静态（MQS）领域，本实践将引导您探索导体中一个核心的物理现象：磁场扩散。您将从基本方程出发，推导控制涡流衰减的磁扩散方程，并求解一个特定初始条件下的瞬态响应。通过这个过程，您将深入理解磁场在良导体中渗透和能量耗散的机制，并掌握分析其特征时间常数的方法。[@problem_id:3326232]", "problem": "考虑一个在平面内可视为无限大且厚度均匀的导电板，其磁导率 $\\mu$ 和电导率 $\\sigma$ 均为常数。施加一个磁准静态 (MQS) 激励，使得在时间 $t=0^{+}$ 的阶跃之后瞬间，板内的离面（out-of-plane）磁通量密度分布为\n$$\nB_{z}(x,y,t=0^{+}) = B_{0} \\cos\\!\\left(\\frac{x}{L}\\right),\n$$\n其中 $B_{0}$ 为给定的振幅，$L0$ 为空间尺度。然后移除激励，使得在 $t0$ 时不再有外部磁源作用。假设位移电流可以忽略，材料是均匀且各向同性的，并且对于磁矢量势 $\\mathbf{A}$，规范 $\\nabla\\cdot \\mathbf{A}=0$ 是可接受的。\n\n直接从麦克斯韦方程组和所述的 MQS 假设出发，推导磁场的时域扩散控制方程，并求解对应于给定初始条件的 $B_{z}(x,y,t)$ 的初值问题。从你的解中，确定与给定空间模式相关的磁通量密度振幅的主导衰减时间常数。将此时间常数的最终答案表示为仅含 $\\mu$、$\\sigma$ 和 $L$ 的单个解析表达式，单位为秒。不需要数值代入，也不需要取整。最终答案必须是单个表达式。", "solution": "该问题要求在磁准静态 (MQS) 假设下推导磁扩散方程，求解给定初始条件下的解，并确定相关的衰减时间常数。\n\n首先，我们从麦克斯韦方程组推导控制方程。在一个无自由电荷、磁导率 $\\mu$ 和电导率 $\\sigma$ 恒定的导电介质中，相关方程如下：\n1.  法拉第电磁感应定律：$\\nabla \\times \\mathbf{E} = -\\frac{\\partial \\mathbf{B}}{\\partial t}$\n2.  安培定律（位移电流可忽略，MQS 近似）：$\\nabla \\times \\mathbf{H} = \\mathbf{J}$\n3.  磁高斯定律：$\\nabla \\cdot \\mathbf{B} = 0$\n4.  线性、均匀、各向同性材料的本构关系：$\\mathbf{B} = \\mu \\mathbf{H}$ 和 $\\mathbf{J} = \\sigma \\mathbf{E}$。\n\n根据本构关系 $\\mathbf{B} = \\mu \\mathbf{H}$ 以及 $\\mu$ 的均匀性，安培定律可以用的 $\\mathbf{B}$ 形式写为 $\\nabla \\times \\mathbf{B} = \\mu \\mathbf{J}$。对该方程取旋度，我们得到：\n$$\n\\nabla \\times (\\nabla \\times \\mathbf{B}) = \\nabla \\times (\\mu \\mathbf{J})\n$$\n由于 $\\mu$ 是一个均匀标量，它可以从旋度算子中提出来：\n$$\n\\nabla \\times (\\nabla \\times \\mathbf{B}) = \\mu (\\nabla \\times \\mathbf{J})\n$$\n接下来，我们使用欧姆定律 $\\mathbf{J} = \\sigma \\mathbf{E}$。由于 $\\sigma$ 也是均匀的，我们有 $\\nabla \\times \\mathbf{J} = \\sigma (\\nabla \\times \\mathbf{E})$。将法拉第定律代入该表达式，得到：\n$$\n\\nabla \\times \\mathbf{J} = \\sigma \\left(-\\frac{\\partial \\mathbf{B}}{\\partial t}\\right) = -\\sigma \\frac{\\partial \\mathbf{B}}{\\partial t}\n$$\n将此结果代回 $\\mathbf{B}$ 的旋度的旋度方程中：\n$$\n\\nabla \\times (\\nabla \\times \\mathbf{B}) = -\\mu \\sigma \\frac{\\partial \\mathbf{B}}{\\partial t}\n$$\n我们现在使用矢量恒等式 $\\nabla \\times (\\nabla \\times \\mathbf{B}) = \\nabla(\\nabla \\cdot \\mathbf{B}) - \\nabla^2 \\mathbf{B}$。根据磁高斯定律，$\\nabla \\cdot \\mathbf{B} = 0$，所以该恒等式简化为 $\\nabla \\times (\\nabla \\times \\mathbf{B}) = -\\nabla^2 \\mathbf{B}$。\n令 $\\nabla \\times (\\nabla \\times \\mathbf{B})$ 的两个表达式相等，得到：\n$$\n-\\nabla^2 \\mathbf{B} = -\\mu \\sigma \\frac{\\partial \\mathbf{B}}{\\partial t}\n$$\n这可以简化为矢量磁扩散方程，也就是此 MQS 问题中磁场的控制方程：\n$$\n\\nabla^2 \\mathbf{B} = \\mu \\sigma \\frac{\\partial \\mathbf{B}}{\\partial t}\n$$\n问题指定了离面磁通量密度，我们将其视为 $z$ 分量，即 $\\mathbf{B} = B_z \\hat{\\mathbf{z}}$。条件 $\\nabla \\cdot \\mathbf{B} = \\frac{\\partial B_z}{\\partial z} = 0$ 必须成立，这意味着 $B_z$ 与 $z$ 无关。矢量扩散方程随之简化为关于 $B_z$ 的标量方程：\n$$\n\\nabla^2 B_z = \\mu \\sigma \\frac{\\partial B_z}{\\partial t}\n$$\n其中 $\\nabla^2 = \\frac{\\partial^2}{\\partial x^2} + \\frac{\\partial^2}{\\partial y^2}$。给定的初始条件是 $B_z(x, y, t=0^{+}) = B_0 \\cos(x/L)$。由于初始条件与 $y$ 无关，且导电板在 $y$ 方向上无限延伸且均匀，因此解 $B_z(x, t)$ 也与 $y$ 无关。所以，$\\frac{\\partial^2 B_z}{\\partial y^2} = 0$。控制偏微分方程简化为一维扩散方程：\n$$\n\\frac{\\partial^2 B_z}{\\partial x^2} = \\mu \\sigma \\frac{\\partial B_z}{\\partial t}\n$$\n我们用分离变量法求解该方程。设 $B_z(x,t) = X(x)T(t)$。将其代入偏微分方程中，得到：\n$$\nX''(x)T(t) = \\mu\\sigma X(x)T'(t)\n$$\n分离变量，我们得到：\n$$\n\\frac{X''(x)}{X(x)} = \\mu\\sigma \\frac{T'(t)}{T(t)} = -k^2\n$$\n其中 $-k^2$ 是分离常数。选择负常数是预期解在空间上是振荡的，在时间上是衰减的。这得到两个常微分方程：\n1. 空间部分：$X''(x) + k^2 X(x) = 0$\n2. 时间部分：$T'(t) + \\frac{k^2}{\\mu\\sigma} T(t) = 0$\n\n空间方程的解是 $X(x) = C_1 \\cos(kx) + C_2 \\sin(kx)$。初始条件 $B_z(x,0) = B_0 \\cos(x/L)$ 意味着解的空间依赖关系必须是 $\\cos(x/L)$ 的形式。通过将其与 $X(x)$ 的通解进行比较，我们可以推断出 $C_2=0$ 且波数 $k = 1/L$。\n\n当 $k=1/L$ 时，时间方程变为：\n$$\nT'(t) + \\frac{1}{\\mu\\sigma L^2} T(t) = 0\n$$\n这是一个标准的一阶线性齐次常微分方程，其解为：\n$$\nT(t) = T(0) \\exp\\left(-\\frac{t}{\\mu\\sigma L^2}\\right)\n$$\n结合空间解和时间解，我们构造出 $B_z(x,t)$ 的通解：\n$$\nB_z(x,t) = A \\cos\\left(\\frac{x}{L}\\right) \\exp\\left(-\\frac{t}{\\mu\\sigma L^2}\\right)\n$$\n其中 $A$ 是一个常数。我们通过应用在 $t=0^{+}$ 时的初始条件来确定 $A$：\n$$\nB_z(x,0) = A \\cos\\left(\\frac{x}{L}\\right) \\exp(0) = A \\cos\\left(\\frac{x}{L}\\right)\n$$\n已知 $B_z(x,0) = B_0 \\cos(x/L)$，我们得到 $A=B_0$。因此，该初值问题的解为：\n$$\nB_z(x,t) = B_0 \\cos\\left(\\frac{x}{L}\\right) \\exp\\left(-\\frac{t}{\\mu\\sigma L^2}\\right)\n$$\n该解描述了一个空间上呈正弦分布的磁场，其振幅 $B_0 \\cos(x/L)$ 随时间指数衰减。解中与时间相关的部分形式为 $\\exp(-t/\\tau)$，其中 $\\tau$ 是衰减时间常数。通过将此形式与我们的解进行比较，我们确定指数部分分母中的项即为时间常数：\n$$\n\\tau = \\mu\\sigma L^2\n$$\n由于初始条件由单一的空间模式构成，因此只有一个相关的时间常数。因此，这就是主导衰减时间常数。", "answer": "$$\n\\boxed{\\mu\\sigma L^2}\n$$", "id": "3326232"}, {"introduction": "本项高级实践将理论推导与现代计算电磁学方法相结合，旨在解决MQS分析中的一个常见挑战：如何在计算中高效处理良导体。您将首先通过渐近分析推导表面阻抗边界条件（IBC），这是一种在趋肤深度 $\\delta$ 远小于结构尺寸时极为有效的近似。随后，您将设计一个混合有限元-IBC算法，该算法能根据物理尺度自适应地选择精细的体网格或高效的边界条件，这是多尺度电磁建模中的一项关键技术。[@problem_id:3326242]", "problem": "考虑一个占据半空间 $x \\ge 0$ 的线性、各向同性、均匀的良导体中的时谐磁准静态问题，其中所有场都以 $\\exp(i \\omega t)$ 的形式变化，并且仅依赖于坐标 $x$。其控制基础是频域麦克斯韦方程组和欧姆定律：$\\nabla \\times \\mathbf{E} = - i \\omega \\mu \\mathbf{H}$，$\\nabla \\times \\mathbf{H} = \\mathbf{J}$，以及 $\\mathbf{J} = \\sigma \\mathbf{E}$，其中 $\\mu$ 是磁导率，$\\sigma$ 是电导率。在具有高电导率的磁准静态体系中，$x=0$ 附近存在一个薄的集肤层，其厚度由感应和传导之间的平衡决定。导体内部的切向电场 $\\mathbf{E}_t(x)$ 满足一个扩散型常微分方程，而表面电流 $\\mathbf{J}_s$ 则是传导电流密度在集肤层上的积分。\n\n任务1（推导）：从上述基础出发，并针对平面半空间导体（其中 $\\mathbf{E}_t(x)$ 和 $\\mathbf{H}_t(x)$ 与表面相切且仅依赖于 $x$）进行特化，使用内部集肤层解和外部解之间的匹配渐近展开，推导连接表面切向电场与表面电流的经典阻抗边界条件。您的推导必须从 $i \\omega \\mu$ 和 $\\sigma$ 之间的平衡中明确确定集肤深度 $\\delta$，并说明内部解如何在 $x = O(\\delta)$ 的尺度上衰减。最后给出以 $\\sigma$、$\\mu$ 和 $\\omega$ 表示的表面阻抗 $Z_s$ 的显式形式，以及 $\\mathbf{E}_t(0)$ 和 $\\mathbf{J}_s$ 之间的关系。\n\n任务2（算法）：设计一个混合有限元法-阻抗边界条件求解器。对于一个截断为有限计算厚度 $L$ 的一维半无限导体，该求解器能够自适应地决定：\n- 在 $[0,L]$ 上使用线性有限元求解切向电场的体扩散方程，并采用狄利克雷边界条件 $\\mathbf{E}_t(0) = E_0$ 和 $\\mathbf{E}_t(L) = 0$，或者\n- 用阻抗边界条件替换体网格，并直接从推导出的公式计算表面阻抗，\n\n其判据是集肤深度远小于网格尺寸 $h$。将此标准形式化如下：选择一个常数 $\\alpha0$，当 $\\delta \\le \\alpha h$ 时使用阻抗边界条件，当 $\\delta  \\alpha h$ 时使用体有限元法。在您的实现中，使用 $\\alpha = 0.5$。\n\n任务3（计算输出）：对于均匀的切向边界激励振幅 $E_0$（单位：伏特/米），将表面电流 $\\mathbf{J}_s$（单位：安培/米）定义为体电流密度 $\\mathbf{J}(x) = \\sigma \\mathbf{E}_t(x)$ 在 $x \\in [0,\\infty)$ 上的积分，并将有效表面阻抗定义为 $Z_{\\mathrm{eff}} = E_0 / J_s$（单位：欧姆·米）。当在截断域 $[0,L]$ 上使用体有限元法时，用 $\\sigma \\int_0^L \\mathbf{E}_t(x) \\, dx$ 近似 $\\mathbf{J}_s$，并取 $L = m_\\delta \\, \\delta$（其中 $m_\\delta$ 是指定的正整数），确保 $L$ 足够大以使 $\\mathbf{E}_t(L) \\approx 0$。\n\n您的程序必须：\n- 根据 $\\sigma$、$\\mu$ 和 $\\omega$ 计算集肤深度 $\\delta$；\n- 使用上述标准自适应地在有限元法和阻抗边界条件之间进行选择；\n- 如果使用有限元法，则在 $[0,L]$ 上对方程 $- \\dfrac{d^2 E_t}{dx^2} + k^2 E_t = 0$（其中 $k^2 = i \\omega \\mu \\sigma$）组装并求解一维线性有限元系统，边界条件为 $E_t(0)=E_0$ 和 $E_t(L)=0$；并通过逐单元对分段线性有限元解进行精确积分来近似 $\\int_0^L E_t(x)\\, dx$；\n- 根据所选方法计算 $Z_{\\mathrm{eff}}$；\n- 计算任务1中推导的解析表面阻抗 $Z_s$；\n- 对每个测试用例，按顺序返回两个值：一个整数方法标志（如果使用阻抗边界条件则为 $1$，如果使用有限元法则为 $0$）和一个等于相对误差 $\\left| Z_{\\mathrm{eff}} - Z_s \\right| / \\left| Z_s \\right|$ 的浮点数。\n\n使用以下测试套件，所有量均采用国际单位制（SI）：\n- 测试用例1（强集肤效应，预期使用阻抗边界条件）：$\\sigma = 5.8 \\times 10^{7} \\,\\mathrm{S/m}$，$\\mu = \\mu_0 = 4 \\pi \\times 10^{-7} \\,\\mathrm{H/m}$，$f = 1.0 \\times 10^{4} \\,\\mathrm{Hz}$，$\\omega = 2 \\pi f \\,\\mathrm{rad/s}$，$h = 5.0 \\times 10^{-3} \\,\\mathrm{m}$，$m_\\delta = 10$，$E_0 = 1.0 \\,\\mathrm{V/m}$。\n- 测试用例2（中等集肤效应，预期使用有限元法）：$\\sigma = 5.8 \\times 10^{7} \\,\\mathrm{S/m}$，$\\mu = \\mu_0$，$f = 1.0 \\times 10^{3} \\,\\mathrm{Hz}$，$\\omega = 2 \\pi f \\,\\mathrm{rad/s}$，$h = 5.0 \\times 10^{-4} \\,\\mathrm{m}$，$m_\\delta = 10$，$E_0 = 1.0 \\,\\mathrm{V/m}$。\n- 测试用例3（标准边界情况，当 $\\delta \\le \\alpha h$ 时使用阻抗边界条件）：$\\sigma = 5.8 \\times 10^{7} \\,\\mathrm{S/m}$，$\\mu = \\mu_0$，$f = 1.0 \\times 10^{4} \\,\\mathrm{Hz}$，$\\omega = 2 \\pi f \\,\\mathrm{rad/s}$，$h = 1.32 \\times 10^{-3} \\,\\mathrm{m}$，$m_\\delta = 10$，$E_0 = 1.0 \\,\\mathrm{V/m}$。\n- 测试用例4（弱集肤效应，预期使用有限元法）：$\\sigma = 1.0 \\times 10^{4} \\,\\mathrm{S/m}$，$\\mu = \\mu_0$，$f = 1.0 \\times 10^{4} \\,\\mathrm{Hz}$，$\\omega = 2 \\pi f \\,\\mathrm{rad/s}$，$h = 1.0 \\times 10^{-1} \\,\\mathrm{m}$，$m_\\delta = 10$，$E_0 = 1.0 \\,\\mathrm{V/m}$。\n\n角度单位：$\\omega$ 使用弧度。\n\n物理单位：$\\mu$ 使用 $\\mathrm{H/m}$（亨利/米），$\\sigma$ 使用 $\\mathrm{S/m}$（西门子/米），$\\omega$ 使用 $\\mathrm{rad/s}$（弧度/秒），$h$ 使用 $\\mathrm{m}$（米），$E_0$ 使用 $\\mathrm{V/m}$（伏特/米）。有效表面阻抗必须以 $\\mathrm{\\Omega \\cdot m}$（欧姆·米）为单位计算，相对误差是无量纲的。\n\n最终输出格式：您的程序应生成单行输出，其中包含按顺序排列的测试用例结果，形式为方括号内的逗号分隔列表 $[\\text{flag}_1,\\text{error}_1,\\text{flag}_2,\\text{error}_2,\\text{flag}_3,\\text{error}_3,\\text{flag}_4,\\text{error}_4]$，其中每个 $\\text{flag}_i$ 为 $0$ 或 $1$，每个 $\\text{error}_i$ 为一个浮点数。", "solution": "用户提供的问题已经过验证，被认为是合理且可解的。关于表面阻抗物理单位的微小不一致是一个文本错误，不影响数学公式的建立或计算任务的执行。\n\n### **第1部分：解析表面阻抗的推导**\n\n该问题考虑在一个占据半空间 $x \\ge 0$ 的良导体中的时谐磁准静态场景。切向电场 $\\mathbf{E}_t$ 被假定为 $\\mathbf{E}_t = E_t(x) \\hat{z}$ 的形式，并以 $\\exp(i\\omega t)$ 变化。从频域麦克斯韦方程组 $\\nabla \\times \\mathbf{E} = -i\\omega\\mu\\mathbf{H}$ 和 $\\nabla \\times \\mathbf{H} = \\sigma\\mathbf{E}$（其中位移电流被忽略）出发，我们推导 $E_t(x)$ 的控制方程。\n\n对法拉第定律取旋度得到 $\\nabla \\times (\\nabla \\times \\mathbf{E}) = -i\\omega\\mu(\\nabla \\times \\mathbf{H})$。使用矢量恒等式 $\\nabla \\times (\\nabla \\times \\mathbf{E}) = \\nabla(\\nabla \\cdot \\mathbf{E}) - \\nabla^2 \\mathbf{E}$ 并代入安培定律，我们得到 $\\nabla(\\nabla \\cdot \\mathbf{E}) - \\nabla^2 \\mathbf{E} = -i\\omega\\mu\\sigma\\mathbf{E}$。在良导体中，电荷密度可忽略不计，因此 $\\nabla \\cdot \\mathbf{E} = 0$。方程简化为 $\\nabla^2 \\mathbf{E} - i\\omega\\mu\\sigma\\mathbf{E} = 0$。\n\n对于仅在 $x$ 方向变化的场 $E_t(x)$，这变成一个常微分方程：\n$$ \\frac{d^2 E_t}{dx^2} - k^2 E_t = 0 $$\n其中 $k^2 = i\\omega\\mu\\sigma$。问题陈述中给出的方程是 $-\\frac{d^2 E_t}{dx^2} + k^2 E_t = 0$，这是等价的。\n\n为了找到解，我们确定复波数 $k$：\n$$ k = \\sqrt{i\\omega\\mu\\sigma} = \\sqrt{\\omega\\mu\\sigma} \\cdot \\sqrt{i} = \\sqrt{\\omega\\mu\\sigma} \\cdot e^{i\\pi/4} = \\sqrt{\\omega\\mu\\sigma} \\left(\\frac{1}{\\sqrt{2}} + i\\frac{1}{\\sqrt{2}}\\right) = \\frac{1+i}{\\delta} $$\n这里我们定义了集肤深度 $\\delta$ 为：\n$$ \\delta = \\sqrt{\\frac{2}{\\omega\\mu\\sigma}} $$\n该常微分方程的通解是 $E_t(x) = C_1 e^{kx} + C_2 e^{-kx}$。由于当 $x \\to \\infty$ 时场必须保持物理上有界，且 $k$ 的实部为正（$1/\\delta > 0$），我们必须有 $C_1 = 0$。因此，解是一个指数衰减波：\n$$ E_t(x) = C_2 e^{-kx} = E_t(0) e^{-kx} = E_t(0) e^{-x/\\delta} e^{-ix/\\delta} $$\n这个表达式代表了集肤层内的“内部”解，在 $\\delta$ 量级的空间尺度上衰减。\n\n表面电流 $J_s$（单位 A/m）是体电流密度 $J_t(x) = \\sigma E_t(x)$ 在导体深度上的积分：\n$$ J_s = \\int_0^\\infty J_t(x) \\,dx = \\sigma \\int_0^\\infty E_t(x) \\,dx = \\sigma \\int_0^\\infty E_t(0) e^{-kx} \\,dx $$\n$$ J_s = \\sigma E_t(0) \\left[ \\frac{e^{-kx}}{-k} \\right]_0^\\infty = \\sigma E_t(0) \\left( 0 - \\frac{1}{-k} \\right) = \\frac{\\sigma}{k} E_t(0) $$\n解析表面阻抗 $Z_s$ 是表面切向电场与总表面电流的比率：\n$$ Z_s = \\frac{E_t(0)}{J_s} = \\frac{k}{\\sigma} $$\n代入 $k$ 和 $\\delta$ 的表达式：\n$$ Z_s = \\frac{1+i}{\\sigma\\delta} = \\frac{1+i}{\\sigma} \\sqrt{\\frac{\\omega\\mu\\sigma}{2}} = (1+i)\\sqrt{\\frac{\\omega\\mu}{2\\sigma}} $$\n这是良导体表面阻抗的经典公式。阻抗边界条件是关系式 $E_t(0) = Z_s J_s$。\n\n### **第2部分：混合有限元/阻抗边界条件算法**\n\n任务是实现一个自适应求解器，该求解器根据计算网格对集肤深度的解析能力，在完整数值模拟和解析阻抗模型之间进行选择。\n\n**自适应标准：**\n给定网格尺寸 $h$ 和常数 $\\alpha = 0.5$，求解器按以下方式选择方法：\n- 如果 $\\delta \\le \\alpha h$：集肤深度被认为无法被网格解析。物理导体体积被阻抗边界条件所取代。这对应于 `method_flag = 1`。\n- 如果 $\\delta  \\alpha h$：集肤深度相对于网格尺寸足够大，可以被解析。使用体有限元法（FEM）求解扩散方程。这对应于 `method_flag = 0`。\n\n**IBC方法实现（$\\delta \\le \\alpha h$）：**\n在这种情况下，有效表面阻抗 $Z_{\\mathrm{eff}}$ 被取为解析表面阻抗 $Z_s$：\n$$ Z_{\\mathrm{eff}} = Z_s = (1+i)\\sqrt{\\frac{\\omega\\mu}{2\\sigma}} $$\n根据定义，相对误差为零：$|Z_{\\mathrm{eff}} - Z_s|/|Z_s| = 0$。\n\n**FEM方法实现（$\\delta  \\alpha h$）：**\n扩散方程 $-\\frac{d^2 E_t}{dx^2} + k^2 E_t = 0$ 在一个截断的一维域 $[0, L]$ 上求解。该域在长度 $L = m_\\delta \\delta$ 处截断，其中 $m_\\delta=10$ 被选得足够大，以强制执行衰减条件 $E_t(L) \\approx 0$。边界条件为 $E_t(0) = E_0$ 和 $E_t(L)=0$。\n\n边值问题的弱形式通过乘以一个测试函数 $v(x)$ 并在 $[0, L]$ 上积分得到。通过分部积分，我们在一个合适的函数空间中寻找解 $E_t$，使得对于所有在边界处为零的测试函数 $v$：\n$$ \\int_0^L \\left( \\frac{dE_t}{dx} \\frac{dv}{dx} + k^2 E_t v \\right) dx = 0 $$\n域 $[0,L]$ 被离散化为 $N = \\lceil L/h \\rceil$ 个尺寸均匀为 $h' = L/N$ 的线性有限元。未知场 $E_t(x)$ 由分段线性函数 $E_h(x) = \\sum_{j=0}^{N} E_j \\phi_j(x)$ 近似，其中 $E_j$ 是节点值，$\\phi_j(x)$ 是标准线性“帽”基函数。\n\n将此代入弱形式，得到节点值向量 $\\mathbf{E} = [E_0, E_1, \\dots, E_N]^T$ 的线性方程组 $\\mathbf{A} \\mathbf{E} = \\mathbf{b}$。全局矩阵 $\\mathbf{A}$ 的元素由 $A_{ij} = \\int_0^L (\\phi_i' \\phi_j' + k^2 \\phi_i \\phi_j) dx$ 给出。对于尺寸为 $h'$ 的均匀网格，连接两个节点的单元的局部单元矩阵是：\n$$ \\mathbf{K}^e = \\frac{1}{h'} \\begin{pmatrix} 1  -1 \\\\ -1  1 \\end{pmatrix} + k^2 \\frac{h'}{6} \\begin{pmatrix} 2  1 \\\\ 1  2 \\end{pmatrix} $$\n组装后，全局矩阵 $\\mathbf{A}$ 是三对角的。施加狄利克雷边界条件 $E_0=E_0$ 和 $E_N=0$。这将问题简化为求解 $N-1$ 个内部节点值 $[E_1, \\dots, E_{N-1}]^T$。这导致一个 $(N-1) \\times (N-1)$ 的三对角系统。主对角线元素是 $d_0 = \\frac{2}{h'} + k^2 \\frac{2h'}{3}$，非对角线元素是 $d_1 = -\\frac{1}{h'} + k^2 \\frac{h'}{6}$。右端向量只有一个非零项，源于 $x=0$ 处的条件：$b_1 = -d_1 E_0$。求解这个复值三对角系统以获得内部节点值。\n\n一旦完整的节点值向量 $\\mathbf{E} = [E_0, E_1, \\dots, E_{N-1}, 0]^T$ 已知，通过积分分段线性有限元解来近似表面电流 $J_s$：\n$$ J_s \\approx \\sigma \\int_0^L E_h(x) dx = \\sigma \\sum_{j=0}^{N-1} \\frac{E_j + E_{j+1}}{2} h' $$\n然后计算有效表面阻抗为 $Z_{\\mathrm{eff}} = E_0 / J_s$。最后，相对于解析值 $Z_s$ 计算相对误差：\n$$ \\text{误差} = \\frac{|Z_{\\mathrm{eff}} - Z_s|}{|Z_s|} $$", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import solve_banded\n\ndef solve():\n    \"\"\"\n    Solves the hybrid FEM/IBC problem for magnetoquasistatics.\n    \"\"\"\n    # Define physical constants and problem parameters\n    MU_0 = 4 * np.pi * 1e-7  # Permeability of free space in H/m\n    ALPHA = 0.5               # Adaptive criterion constant\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (sigma, mu, f, h, m_delta, E0)\n        (5.8e7, MU_0, 1.0e4, 5.0e-3, 10, 1.0),\n        (5.8e7, MU_0, 1.0e3, 5.0e-4, 10, 1.0),\n        (5.8e7, MU_0, 1.0e4, 1.32e-3, 10, 1.0),\n        (1.0e4, MU_0, 1.0e4, 1.0e-1, 10, 1.0),\n    ]\n\n    results = []\n    for sigma, mu, f, h, m_delta, E0 in test_cases:\n        # Calculate primary physical quantities\n        omega = 2 * np.pi * f\n        \n        # Calculate skin depth\n        delta = np.sqrt(2 / (omega * mu * sigma))\n        \n        # Calculate analytical surface impedance Z_s\n        k_sq = 1j * omega * mu * sigma\n        k = np.sqrt(k_sq)\n        z_s = k / sigma\n        \n        # Apply the adaptive criterion\n        if delta = ALPHA * h:\n            # Use Impedance Boundary Condition (IBC)\n            method_flag = 1\n            z_eff = z_s\n            relative_error = 0.0\n        else:\n            # Use Finite Element Method (FEM)\n            method_flag = 0\n            \n            # --- FEM Setup ---\n            L = m_delta * delta\n            # Ensure at least one element\n            num_elements = int(np.ceil(L / h))\n            if num_elements == 0:\n                num_elements = 1\n            \n            h_prime = L / num_elements\n            num_nodes = num_elements + 1\n            num_unknowns = num_nodes - 2\n            \n            if num_unknowns = 0:\n              # Handle cases with very few elements where no internal nodes exist.\n              # This can happen if L is very small compared to h, but is unlikely\n              # with the problem parameters. We approximate the integral based on\n              # the two boundary nodes.\n              integral = (E0 + 0) / 2 * L\n            else:\n              # --- Assemble and solve the linear system for internal nodes ---\n              # Tridiagonal system A_int * E_int = b_int\n              # Main diagonal\n              d0 = (2 / h_prime) + k_sq * (2 * h_prime / 3)\n              # Off-diagonals\n              d1 = (-1 / h_prime) + k_sq * (h_prime / 6)\n              \n              # Create the banded matrix for scipy.linalg.solve_banded\n              # Shape (3, num_unknowns): [upper_diag, main_diag, lower_diag]\n              # Note: scipy's format for (l,u)=(1,1) has row 0 padded (super), \n              # row 1 is main, row 2 is sub.\n              ab = np.zeros((3, num_unknowns), dtype=complex)\n              ab[0, 1:] = d1  # Upper diagonal\n              ab[1, :] = d0   # Main diagonal\n              ab[2, :-1] = d1 # Lower diagonal\n\n              # Create the right-hand side vector\n              b_int = np.zeros(num_unknowns, dtype=complex)\n              # From boundary condition E(0)=E0\n              b_int[0] = -d1 * E0\n              \n              # Solve for internal node values E_1, ..., E_{N-1}\n              e_internal = solve_banded((1, 1), ab, b_int)\n              \n              # --- Post-processing ---\n              # Reconstruct the full solution vector\n              e_solution = np.concatenate(([E0], e_internal, [0]))\n              \n              # Calculate integral of the piecewise linear solution\n              # This is the sum of trapezoidal areas for each element.\n              integral = np.sum((e_solution[:-1] + e_solution[1:]) / 2) * h_prime\n\n            # Calculate effective surface impedance\n            j_s_fem = sigma * integral\n            \n            # Handle case where j_s_fem might be zero for some reason\n            if abs(j_s_fem)  1e-15:\n                z_eff = np.inf\n            else:\n                z_eff = E0 / j_s_fem\n\n            # Calculate relative error\n            if abs(z_s) > 1e-15:\n                relative_error = np.abs(z_eff - z_s) / np.abs(z_s)\n            else:\n                # This case (z_s = 0) shouldn't happen with the given parameters\n                relative_error = np.inf if abs(z_eff) > 1e-15 else 0.0\n\n        results.extend([method_flag, relative_error])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3326242"}]}