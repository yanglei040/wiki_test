{"hands_on_practices": [{"introduction": "掌握数值通量理论的第一步是亲手实现它。本练习将指导您为一维麦克斯韦方程中的介质界面从零开始构建上行数值通量。通过计算和验证能量平衡 [@problem_id:3335545]，您将确认所实现通量的物理一致性，这是任何数值方案正确性的基本检验标准。", "problem": "实现一个程序，该程序计算具有分段常数介电常数和磁导率的一维麦克斯韦界面问题的上风数值通量，根据得到的界面场评估离散的透射和反射功率密度，并检验能量平衡。\n\n你必须在一维横电磁波的设定下工作，该设定由仅限于单个切向电场分量和单个切向磁场分量的麦克斯韦方程组描述。左侧介质的介电常数为 $\\epsilon_L$、磁导率为 $\\mu_L$，右侧介质的介电常数为 $\\epsilon_R$、磁导率为 $\\mu_R$，所有这些值在各自的半域内均为严格为正的常数。设界面法线从左指向右。界面左侧的切向电场和磁场迹线记为 $E^-$ 和 $H^-$，界面右侧的记为 $E^+$ 和 $H^+$。将每种介质中的电磁阻抗定义为 $Z = \\sqrt{\\mu/\\epsilon}$，波速定义为 $c = 1/\\sqrt{\\mu \\epsilon}$。假设介质无损耗。\n\n仅从麦克斯韦方程组的物理定律和双曲系统的特征变量概念出发，推导与非连续 Galerkin 离散化中使用的上风数值通量相对应的唯一界面场 $\\hat{E}$ 和 $\\hat{H}$。具体来说，选择来自两侧的入特征作为数据，施加界面处 Riemann 问题所蕴含的物理连续性条件，并用 $(E^-, H^-)$、$(E^+, H^+)$、$(\\epsilon_L,\\mu_L)$ 和 $(\\epsilon_R,\\mu_R)$ 求解 $\\hat{E}$ 和 $\\hat{H}$。\n\n对每种介质，定义右行和左行特征不变量\n$$w^+ = E + Z H,\\quad w^- = E - Z H.$$\n给定任意迹线 $(E^-,H^-)$ 和 $(E^+,H^+)$，将 $w_L^+ = E^- + Z_L H^-$ 解释为来自左侧的右行入射波幅值，将 $w_R^- = E^+ - Z_R H^+$ 解释为来自右侧的左行入射波幅值。求解界面 Riemann 问题后的出射波幅值是 $w_L^- = \\hat{E} - Z_L \\hat{H}$（向左反射）和 $w_R^+ = \\hat{E} + Z_R \\hat{H}$（向右透射）。\n\n在阻抗为 $Z$ 的介质中，将幅值为 $w^+$ 的右行波携带的瞬时功率密度（Poynting 通量）定义为 $S_{\\rightarrow} = (w^+)^2/(4 Z)$，将幅值为 $w^-$ 的左行波携带的瞬时功率密度定义为 $S_{\\leftarrow} = (w^-)^2/(4 Z)$。对于一般叠加情况，净功率密度为 $S = S_{\\rightarrow} - S_{\\leftarrow} = E H$。\n\n你的程序必须：\n- 实现上风数值通量以计算界面处的 $\\hat{E}$ 和 $\\hat{H}$。\n- 从 $\\hat{E}$ 和 $\\hat{H}$ 计算透射和反射的瞬时功率密度，定义为 $S_{\\text{trans}} = (w_R^+)^2/(4 Z_R)$ 和 $S_{\\text{refl}} = (w_L^-)^2/(4 Z_L)$，单位为 $\\mathrm{W/m^2}$。\n- 计算总入射功率密度 $S_{\\text{in}} = (w_L^+)^2/(4 Z_L) + (w_R^-)^2/(4 Z_R)$ 和总出射功率密度 $S_{\\text{out}} = S_{\\text{trans}} + S_{\\text{refl}}$，两者单位均为 $\\mathrm{W/m^2}$。\n- 报告相对能量不平衡度，定义为 $\\delta = |S_{\\text{in}} - S_{\\text{out}}| / \\max(S_{\\text{in}}, \\varepsilon)$，其中 $\\varepsilon$ 是一个小的正常数，用于避免当 $S_{\\text{in}}$ 为零时出现除零错误。使用 $\\varepsilon = 10^{-16}$。\n\n测试套件和所需输出：\n使用以下四个测试用例，真空常数为 $\\epsilon_0 = 8.854187817\\times 10^{-12}\\ \\mathrm{F/m}$ 和 $\\mu_0 = 4\\pi\\times 10^{-7}\\ \\mathrm{H/m}$。\n\n- A例（阻抗匹配，无反射）：\n  - $\\epsilon_L = \\epsilon_0$, $\\mu_L = \\mu_0$; $\\epsilon_R = \\epsilon_0$, $\\mu_R = \\mu_0$。\n  - 仅从左侧入射：$E^- = 1.0\\ \\mathrm{V/m}$, $H^- = E^- / Z_L$, $E^+ = 0$, $H^+ = 0$。\n- B例（右侧阻抗阶跃至更低阻抗）：\n  - $\\epsilon_L = \\epsilon_0$, $\\mu_L = \\mu_0$; $\\epsilon_R = 4\\,\\epsilon_0$, $\\mu_R = \\mu_0$。\n  - 仅从左侧入射：$E^- = 1.0\\ \\mathrm{V/m}$, $H^- = E^- / Z_L$, $E^+ = 0$, $H^+ = 0$。\n- C例（右侧近似理想电导体）：\n  - $\\epsilon_L = \\epsilon_0$, $\\mu_L = \\mu_0$; $\\epsilon_R = 10^9\\,\\epsilon_0$, $\\mu_R = \\mu_0$。\n  - 仅从左侧入射：$E^- = 1.0\\ \\mathrm{V/m}$, $H^- = E^- / Z_L$, $E^+ = 0$, $H^+ = 0$。\n- D例（两侧同时入射，介质相同）：\n  - $\\epsilon_L = \\epsilon_0$, $\\mu_L = \\mu_0$; $\\epsilon_R = \\epsilon_0$, $\\mu_R = \\mu_0$。\n  - 左侧入射右行波幅值 $A_L = 0.8$：设置 $E^- = A_L/2$, $H^- = A_L/(2 Z_L)$。\n  - 右侧入射左行波幅值 $A_R = 0.5$：设置 $E^+ = A_R/2$, $H^+ = -A_R/(2 Z_R)$。\n\n你的程序应生成一行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果。对于每个用例，按顺序输出三个浮点数：透射功率密度 $S_{\\text{trans}}$（单位 $\\mathrm{W/m^2}$）、反射功率密度 $S_{\\text{refl}}$（单位 $\\mathrm{W/m^2}$）和相对不平衡度 $\\delta$（无量纲）。因此，最终输出必须是一个包含12个浮点数的扁平列表，其顺序对应于A、B、C和D例：\n$[S_{\\text{trans}}^{(A)}, S_{\\text{refl}}^{(A)}, \\delta^{(A)}, S_{\\text{trans}}^{(B)}, S_{\\text{refl}}^{(B)}, \\delta^{(B)}, S_{\\text{trans}}^{(C)}, S_{\\text{refl}}^{(C)}, \\delta^{(C)}, S_{\\text{trans}}^{(D)}, S_{\\text{refl}}^{(D)}, \\delta^{(D)}]$。", "solution": "该问题是有效的。这是一个计算电磁学中适定的问题，其基础是麦克斯韦方程组的基本原理和双曲系统理论。所有术语都得到了清晰的定义，所提供的数据是一致且充分的，足以推导出唯一解。\n\n### 上风通量界面场的推导\n\n我们考虑沿 $x$ 轴传播的一维横电磁（TEM）波。在无损耗、无源的介质中，对于单个切向电场分量 $E$ 和单个切向磁场分量 $H$，相关的麦克斯韦方程组为：\n$$\n\\epsilon \\frac{\\partial E}{\\partial t} = -\\frac{\\partial H_p}{\\partial x}\n$$\n$$\n\\mu \\frac{\\partial H_p}{\\partial t} = -\\frac{\\partial E}{\\partial x}\n$$\n此处，$H_p$ 表示物理磁场分量。为了获得对称双曲系统，我们定义 $H = -H_p$，这对应于反转切向磁场矢量的方向，以使其与波的坐标系约定对齐。该系统变为：\n$$\n\\epsilon \\frac{\\partial E}{\\partial t} = \\frac{\\partial H}{\\partial x}\n$$\n$$\n\\mu \\frac{\\partial H}{\\partial t} = \\frac{\\partial E}{\\partial x}\n$$\n这可以写成矩阵形式 $\\mathbf{M} \\frac{\\partial \\mathbf{u}}{\\partial t} + \\mathbf{K} \\frac{\\partial \\mathbf{u}}{\\partial x} = 0$，其中 $\\mathbf{u} = [E, H]^T$，$\\mathbf{M} = \\text{diag}(\\epsilon, \\mu)$，以及 $\\mathbf{K} = \\begin{pmatrix} 0  1 \\\\ 1  0 \\end{pmatrix}$。左乘 $\\mathbf{M}^{-1}$ 得到 $\\frac{\\partial \\mathbf{u}}{\\partial t} + \\mathbf{A} \\frac{\\partial \\mathbf{u}}{\\partial x} = 0$，系统矩阵为：\n$$\n\\mathbf{A} = \\begin{pmatrix} 0  1/\\epsilon \\\\ 1/\\mu  0 \\end{pmatrix}\n$$\n注意：问题使用的磁场符号约定使得方程为 $\\epsilon \\partial_t E + \\partial_x H = 0$ 和 $\\mu \\partial_t H + \\partial_x E = 0$。这意味着系统矩阵为 $\\mathbf{A} = \\begin{pmatrix} 0  1/\\epsilon \\\\ 1/\\mu  0 \\end{pmatrix}$。特征值为 $\\lambda = \\pm 1/\\sqrt{\\mu\\epsilon} = \\pm c$，其中 $c$ 是波速。对应的右特征向量是：对于 $\\lambda=-c$（左行波），为 $[Z, 1]^T$；对于 $\\lambda=+c$（右行波），为 $[Z, -1]^T$，其中 $Z = \\sqrt{\\mu/\\epsilon}$ 是阻抗。\n\n特征变量定义为 $w^+ = E+ZH$ 和 $w^- = E-ZH$。让我们分析它们的物理意义。\n对于在 $+x$ 方向上传播的纯右行波，场之间的关系为 $E=ZH$。在这种情况下，$w^+ = ZH+ZH = 2E$ 且 $w^- = ZH-ZH=0$。\n对于在 $-x$ 方向上传播的纯左行波，$E=-ZH$。在这种情况下，$w^+ = -ZH+ZH=0$ 且 $w^- = -ZH-ZH = -2ZH=2E$。\n因此，$w^+$ 代表波的右行分量的幅值，$w^-$ 代表左行分量的幅值。问题陈述中将 $w^+$ 与右行相关联、将 $w^-$ 与左行相关联的做法并不常规，但在此处是一致使用的。我们将采纳问题的解释：$w^+ = E+ZH$ 是右行波幅值，$w^-=E-ZH$ 是左行波幅值。\n\n左介质（$L$）和右介质（$R$）之间界面处的上风通量是通过求解局部 Riemann 问题来确定的。界面处的状态 $(\\hat{E}, \\hat{H})$ 是恒定的，并且必须满足切向场的物理连续性。\n界面两侧的场可以分解为入射波和出射波。\n- 在左边界（迹线 $E^-, H^-$），入射波是右行分量 $w_L^+ = E^- + Z_L H^-$。\n- 在右边界（迹线 $E^+, H^+$），入射波是左行分量 $w_R^- = E^+ - Z_R H^+$。\n\n上风原理规定，界面处的特征由流向界面的信息决定。所以，界面状态 $(\\hat{E}, \\hat{H})$ 必须由入射特征 $w_L^+$ 和 $w_R^-$ 构造。\n物理场 $E$ 和 $H$ 的连续性必须在界面 $x=0$ 处成立。\n设界面处的场为 $\\hat{E}$ 和 $\\hat{H}$。这个单一状态从两侧看是一样的。\n从左侧（$x=0^-$）看，状态 $(\\hat{E}, \\hat{H})$ 由给定的入射右行波 $w_L^+$ 和一个待定的出射（反射）左行波 $\\hat{w}_L^-$ 组成。它们的关系是 $\\hat{E} = (\\hat{w}_L^+ + \\hat{w}_L^-)/2$ 和 $\\hat{H} = (\\hat{w}_L^+ - \\hat{w}_L^-)/(2 Z_L)$。由此，我们可以断定，从左侧看到的界面处的场的右行分量必须是来自左侧的入射波。因此，$\\hat{E} + Z_L \\hat{H} = w_L^+$。\n从右侧（$x=0^+$）看，状态 $(\\hat{E}, \\hat{H})$ 由给定的入射左行波 $w_R^-$ 和一个待定的出射（透射）右行波 $\\hat{w}_R^+$ 组成。它们的关系是 $\\hat{E} = (\\hat{w}_R^+ + \\hat{w}_R^-)/2$ 和 $\\hat{H} = (\\hat{w}_R^+ - \\hat{w}_R^-)/(2 Z_R)$。从右侧看到的界面处的场的左行分量必须是来自右侧的入射波。因此，$\\hat{E} - Z_R \\hat{H} = w_R^-$。\n\n现在我们得到了一个关于两个未知界面场 $\\hat{E}$ 和 $\\hat{H}$ 的二元线性方程组：\n$$\n\\begin{cases}\n\\hat{E} + Z_L \\hat{H} = w_L^+ = E^- + Z_L H^- \\\\\n\\hat{E} - Z_R \\hat{H} = w_R^- = E^+ - Z_R H^+\n\\end{cases}\n$$\n解这个方程组得到上风通量的唯一界面场。第一个方程减去第二个方程得到：\n$$\n(Z_L + Z_R)\\hat{H} = w_L^+ - w_R^- \\implies \\hat{H} = \\frac{w_L^+ - w_R^-}{Z_L + Z_R}\n$$\n为了求 $\\hat{E}$，我们将第一个方程乘以 $Z_R$，第二个方程乘以 $Z_L$，然后相加：\n$$\n(Z_R + Z_L)\\hat{E} = Z_R w_L^+ + Z_L w_R^- \\implies \\hat{E} = \\frac{Z_R w_L^+ + Z_L w_R^-}{Z_L + Z_R}\n$$\n\n### 功率计算与能量平衡\n\n确定了界面场 $(\\hat{E}, \\hat{H})$ 后，我们就可以找到出射（反射和透射）波的特征。\n透射波是传播到右侧介质中的右行波，由其特征幅值 $w_R^+$ 定义：\n$$\nw_R^+ = \\hat{E} + Z_R \\hat{H} = \\frac{Z_R w_L^+ + Z_L w_R^-}{Z_L + Z_R} + Z_R \\frac{w_L^+ - w_R^-}{Z_L + Z_R} = \\frac{2Z_R}{Z_L+Z_R} w_L^+ + \\frac{Z_L-Z_R}{Z_L+Z_R} w_R^-\n$$\n反射波是传播回左侧介质的左行波，由其特征幅值 $w_L^-$ 定义：\n$$\nw_L^- = \\hat{E} - Z_L \\hat{H} = \\frac{Z_R w_L^+ + Z_L w_R^-}{Z_L + Z_R} - Z_L \\frac{w_L^+ - w_R^-}{Z_L + Z_R} = \\frac{Z_R-Z_L}{Z_L+Z_R} w_L^+ + \\frac{2Z_L}{Z_L+Z_R} w_R^-\n$$\n瞬时功率密度由这些波幅值计算得出。\n总入射功率密度是入射波功率之和：\n$$\nS_{\\text{in}} = S_{\\rightarrow,L} + S_{\\leftarrow,R} = \\frac{(w_L^+)^2}{4 Z_L} + \\frac{(w_R^-)^2}{4 Z_R}\n$$\n透射功率密度与出射波 $w_R^+$ 相关：\n$$\nS_{\\text{trans}} = \\frac{(w_R^+)^2}{4 Z_R}\n$$\n反射功率密度与出射波 $w_L^-$ 相关：\n$$\nS_{\\text{refl}} = \\frac{(w_L^-)^2}{4 Z_L}\n$$\n总出射功率密度为 $S_{\\text{out}} = S_{\\text{trans}} + S_{\\text{refl}}$。\n我们可以解析地验证能量守恒。将 $w_R^+$ 和 $w_L^-$ 的表达式代入 $S_{\\text{out}}$ 的公式中：\n$$\nS_{\\text{out}} = \\frac{1}{4Z_R}\\left(\\frac{2Z_R}{Z_L+Z_R} w_L^+ + \\frac{Z_L-Z_R}{Z_L+Z_R} w_R^-\\right)^2 + \\frac{1}{4Z_L}\\left(\\frac{Z_R-Z_L}{Z_L+Z_R} w_L^+ + \\frac{2Z_L}{Z_L+Z_R} w_R^-\\right)^2\n$$\n展开平方项并合并 $(w_L^+)^2$、$(w_R^-)^2$ 和 $w_L^+ w_R^-$ 的项，可以发现交叉项的系数和为零，最终结果简化为：\n$$\nS_{\\text{out}} = \\frac{(w_L^+)^2}{4 Z_L} + \\frac{(w_R^-)^2}{4 Z_R} = S_{\\text{in}}\n$$\n这证实了所推导的上风通量是能量守恒的。数值相对能量不平衡度 $\\delta = |S_{\\text{in}} - S_{\\text{out}}| / \\max(S_{\\text{in}}, \\varepsilon)$ 在浮点精度范围内应为零。\n\n### 计算方法\n程序将为每个测试用例实现以下步骤：\n1. 定义真空常数 $\\epsilon_0 = 8.854187817\\times 10^{-12}$ 和 $\\mu_0 = 4\\pi\\times 10^{-7}$。\n2. 对每种介质（$L, R$），计算介电常数 $\\epsilon$、磁导率 $\\mu$ 和阻抗 $Z = \\sqrt{\\mu/\\epsilon}$。\n3. 根据测试用例规范确定迹线值 $(E^-, H^-)$ 和 $(E^+, H^+)$。\n4. 计算入射特征波幅值：$w_L^+ = E^- + Z_L H^-$ 和 $w_R^- = E^+ - Z_R H^+$。\n5. 使用推导出的透射和反射公式计算出射波幅值 $w_R^+$ 和 $w_L^-$。\n6. 计算功率密度：$S_{\\text{trans}} = (w_R^+)^2/(4 Z_R)$ 和 $S_{\\text{refl}} = (w_L^-)^2/(4 Z_L)$。\n7. 计算总入射功率 $S_{\\text{in}}$ 和总出射功率 $S_{\\text{out}}$。\n8. 计算相对能量不平衡度 $\\delta = |S_{\\text{in}} - S_{\\text{out}}| / \\max(S_{\\text{in}}, 10^{-16})$。\n9. 存储每个用例的三元组 $(S_{\\text{trans}}, S_{\\text{refl}}, \\delta)$。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes upwind flux, power densities, and energy imbalance for 1D Maxwell's equations \n    at a material interface.\n    \"\"\"\n    \n    # Physical constants\n    EPSILON_0 = 8.854187817e-12  # F/m\n    MU_0 = 4 * np.pi * 1e-7      # H/m\n    Z_0 = np.sqrt(MU_0 / EPSILON_0) # Impedance of free space\n\n    # Small constant for division stability\n    EPSILON_NUM = 1e-16\n\n    # Test suite definition\n    test_cases_spec = [\n        # Case A: Impedance matched\n        {'id': 'A', 'eps_r_L': 1.0, 'mu_r_L': 1.0, 'eps_r_R': 1.0, 'mu_r_R': 1.0, \n         'type': 'incident_left', 'E_amp': 1.0},\n        # Case B: Impedance step down\n        {'id': 'B', 'eps_r_L': 1.0, 'mu_r_L': 1.0, 'eps_r_R': 4.0, 'mu_r_R': 1.0,\n         'type': 'incident_left', 'E_amp': 1.0},\n        # Case C: Approximate PEC\n        {'id': 'C', 'eps_r_L': 1.0, 'mu_r_L': 1.0, 'eps_r_R': 1e9, 'mu_r_R': 1.0,\n         'type': 'incident_left', 'E_amp': 1.0},\n        # Case D: Simultaneous incidence\n        {'id': 'D', 'eps_r_L': 1.0, 'mu_r_L': 1.0, 'eps_r_R': 1.0, 'mu_r_R': 1.0,\n         'type': 'simultaneous', 'A_L': 0.8, 'A_R': 0.5}\n    ]\n\n    results = []\n    \n    for case in test_cases_spec:\n        # 1. Calculate material properties\n        eps_L = case['eps_r_L'] * EPSILON_0\n        mu_L = case['mu_r_L'] * MU_0\n        Z_L = np.sqrt(mu_L / eps_L)\n\n        eps_R = case['eps_r_R'] * EPSILON_0\n        mu_R = case['mu_r_R'] * MU_0\n        Z_R = np.sqrt(mu_R / eps_R)\n\n        # 2. Determine trace field values E-, H-, E+, H+\n        if case['type'] == 'incident_left':\n            E_minus = case['E_amp']\n            H_minus = E_minus / Z_L\n            E_plus = 0.0\n            H_plus = 0.0\n        elif case['type'] == 'simultaneous':\n            A_L = case['A_L']\n            A_R = case['A_R']\n            E_minus = A_L / 2.0\n            H_minus = A_L / (2.0 * Z_L)\n            E_plus = A_R / 2.0\n            H_plus = -A_R / (2.0 * Z_R)\n        else:\n            raise ValueError(f\"Unknown case type: {case['type']}\")\n\n        # 3. Compute incoming characteristic wave amplitudes\n        w_L_plus = E_minus + Z_L * H_minus\n        w_R_minus = E_plus - Z_R * H_plus\n        \n        # 4. Compute total incident power density\n        S_in = (w_L_plus**2) / (4 * Z_L) + (w_R_minus**2) / (4 * Z_R)\n\n        # 5. Compute outgoing wave amplitudes (transmitted and reflected)\n        # These are the reflection/transmission coefficients for the characteristic variables\n        # This is derived by solving for the interface fields E_hat, H_hat and then\n        # calculating the outgoing characteristics w_L_minus_out and w_R_plus_out.\n        \n        # Reflected wave amplitude: w_L_minus_out = Gamma_L * w_L_plus + T_R * w_R_minus\n        Gamma_L = (Z_R - Z_L) / (Z_L + Z_R)\n        T_R_to_L = (2 * Z_L) / (Z_L + Z_R)\n        w_L_minus_out = Gamma_L * w_L_plus + T_R_to_L * w_R_minus\n        \n        # Transmitted wave amplitude: w_R_plus_out = T_L * w_L_plus + Gamma_R * w_R_minus\n        T_L_to_R = (2 * Z_R) / (Z_L + Z_R)\n        Gamma_R = (Z_L - Z_R) / (Z_L + Z_R) # Note Gamma_R = -Gamma_L\n        w_R_plus_out = T_L_to_R * w_L_plus + Gamma_R * w_R_minus\n\n        # 6. Calculate transmitted and reflected power densities\n        S_trans = (w_R_plus_out**2) / (4 * Z_R)\n        S_refl = (w_L_minus_out**2) / (4 * Z_L)\n        \n        # 7. Calculate total outgoing power density\n        S_out = S_trans + S_refl\n\n        # 8. Compute relative energy imbalance\n        delta = abs(S_in - S_out) / max(S_in, EPSILON_NUM)\n        \n        results.extend([S_trans, S_refl, delta])\n\n    # Format output as a single comma-separated string\n    output_str = f\"[{','.join(f'{x:.8e}' for x in results)}]\"\n    print(output_str)\n\nsolve()\n```", "id": "3335545"}, {"introduction": "一个稳健的数值格式其结果不应依赖于模型建立中的任意选择，例如界面法向量的方向。本练习要求您从理论上证明，上行通量的定义在界面法向反转时保持一致性 [@problem_id:3335507]。这项实践将加深您对间断伽辽金方法底层数学结构的理解，并建立对该方法稳定性和唯一性的信心。", "problem": "考虑在平面界面两侧的两种均匀、各向同性介质中的无源时域麦克斯韦方程组。介质的介电常数分别为 $\\epsilon^{-}$、$\\epsilon^{+}$，磁导率分别为 $\\mu^{-}$、$\\mu^{+}$。该界面由两个间断 Galerkin (DG) 单元共享。设单位法向量 $\\mathbf{n}$ 从负侧指向正侧，并定义每种介质中的波阻抗为 $Z^{-} = \\sqrt{\\mu^{-}/\\epsilon^{-}}$ 和 $Z^{+} = \\sqrt{\\mu^{+}/\\epsilon^{+}}$。设 $\\mathbf{E}^{-}$、$\\mathbf{H}^{-}$ 和 $\\mathbf{E}^{+}$、$\\mathbf{H}^{+}$ 分别表示从负侧和正侧在界面上取电场和磁场的迹，作为切向向量。对于任意切向向量场 $\\mathbf{v}$，定义有向切向跳跃算子为\n$$\n\\llbracket \\mathbf{v} \\rrbracket_{\\mathbf{n}}^{t} = \\mathbf{n} \\times \\mathbf{v}^{-} - \\mathbf{n} \\times \\mathbf{v}^{+}.\n$$\n仅从麦克斯韦旋度方程、本构关系和波阻抗的定义出发，按以下步骤进行：\n\n1. 推导切向场沿界面法线方向 $\\mathbf{n}$ 的特征分解，并证明反转方向 $\\mathbf{n} \\mapsto -\\mathbf{n}$ 会改变有向切向跳跃 $\\llbracket \\mathbf{v} \\rrbracket_{\\mathbf{n}}^{t}$ 的符号。\n\n2. 使用特征变量，根据有向切向量 $e^{\\pm} = \\mathbf{n} \\times \\mathbf{E}^{\\pm}$ 和 $h^{\\pm} = \\mathbf{n} \\times \\mathbf{H}^{\\pm}$、阻抗 $Z^{-}$、$Z^{+}$ 以及法线方向 $\\mathbf{n}$，为 DG 界面构建迎风数值通量。明确确定界面上唯一的迎风有向切向星状态 $\\left(e^{\\star}, h^{\\star}\\right)$，该状态与特征波向每种介质的传播相一致。\n\n3. 通过计算标量\n$$\n\\Delta = \\left\\| \\begin{pmatrix} e^{\\star}(\\mathbf{n}; \\mathbf{E}^{-}, \\mathbf{H}^{-}, \\mathbf{E}^{+}, \\mathbf{H}^{+}) \\\\ h^{\\star}(\\mathbf{n}; \\mathbf{E}^{-}, \\mathbf{H}^{-}, \\mathbf{E}^{+}, \\mathbf{H}^{+}) \\end{pmatrix} + \\begin{pmatrix} e^{\\star}(-\\mathbf{n}; \\mathbf{E}^{-}, \\mathbf{H}^{-}, \\mathbf{E}^{+}, \\mathbf{H}^{+}) \\\\ h^{\\star}(-\\mathbf{n}; \\mathbf{E}^{-}, \\mathbf{H}^{-}, \\mathbf{E}^{+}, \\mathbf{H}^{+}) \\end{pmatrix} \\right\\|,\n$$\n来验证有向迎风数值通量在方向改变下保持唯一定义和一致性，其中 $\\|\\cdot\\|$ 表示 $\\mathbb{R}^{2}$ 上的欧几里得范数。您的推导必须是符号性的，并且不得假设材料参数或场的任何特殊值。给出 $\\Delta$ 的精确值作为最终答案。无需四舍五入，最终值是无量纲的。", "solution": "该问题要求推导两种电介质界面上时域麦克斯韦方程的迎风数值通量，并验证其在界面法向量 $\\mathbf{n}$ 方向改变下的一致性。\n\n### 第一部分：特征分解与跳跃算子\n\n我们从均匀、各向同性介质中的无源时域麦克斯韦方程组开始，其介电常数为 $\\epsilon$，磁导率为 $\\mu$：\n$$\n\\epsilon \\frac{\\partial \\mathbf{E}}{\\partial t} = \\nabla \\times \\mathbf{H}\n$$\n$$\n\\mu \\frac{\\partial \\mathbf{H}}{\\partial t} = -\\nabla \\times \\mathbf{E}\n$$\n我们考虑沿单位法向量 $\\mathbf{n}$ 方向的波传播，因此空间导数算子变为 $\\nabla = \\mathbf{n} \\frac{\\partial}{\\partial n}$，其中 $n$ 是沿 $\\mathbf{n}$ 方向的空间坐标。与界面相切的场分量的方程与法向分量是解耦的。设 $\\mathbf{E}_t$ 和 $\\mathbf{H}_t$ 为切向分量。控制这些分量的一维麦克斯韦方程组为：\n$$\n\\epsilon \\frac{\\partial \\mathbf{E}_t}{\\partial t} = \\mathbf{n} \\times \\frac{\\partial \\mathbf{H}_t}{\\partial n}\n$$\n$$\n\\mu \\frac{\\partial \\mathbf{H}_t}{\\partial t} = -\\mathbf{n} \\times \\frac{\\partial \\mathbf{E}_t}{\\partial n}\n$$\n问题将有向切向场定义为 $e = \\mathbf{n} \\times \\mathbf{E}$ 和 $h = \\mathbf{n} \\times \\mathbf{H}$。对于切向场，有 $\\mathbf{E}_t = -\\mathbf{n} \\times e$ 和 $\\mathbf{H}_t = -\\mathbf{n} \\times h$。将这些代入一维麦克斯韦方程组，并对任意与界面相切的向量 $\\mathbf{v}$ (即 $\\mathbf{n} \\cdot \\mathbf{v} = 0$) 使用向量恒等式 $\\mathbf{n} \\times (\\mathbf{n} \\times \\mathbf{v}) = -\\mathbf{v}$：\n$$\n\\epsilon \\frac{\\partial (-\\mathbf{n} \\times e)}{\\partial t} = \\mathbf{n} \\times \\frac{\\partial (-\\mathbf{n} \\times h)}{\\partial n} \\quad \\implies \\quad -\\epsilon \\mathbf{n} \\times \\frac{\\partial e}{\\partial t} = \\frac{\\partial h}{\\partial n}\n$$\n$$\n\\mu \\frac{\\partial (-\\mathbf{n} \\times h)}{\\partial t} = -\\mathbf{n} \\times \\frac{\\partial (-\\mathbf{n} \\times e)}{\\partial n} \\quad \\implies \\quad -\\mu \\mathbf{n} \\times \\frac{\\partial h}{\\partial t} = -\\frac{\\partial e}{\\partial n}\n$$\n这得到了一阶系统：\n$$\n\\frac{\\partial h}{\\partial n} + \\epsilon \\mathbf{n} \\times \\frac{\\partial e}{\\partial t} = 0\n$$\n$$\n\\frac{\\partial e}{\\partial n} - \\mu \\mathbf{n} \\times \\frac{\\partial h}{\\partial t} = 0\n$$\n为了找到特征变量，我们定义波阻抗 $Z = \\sqrt{\\mu/\\epsilon}$ 和波速 $c = 1/\\sqrt{\\mu\\epsilon}$。注意 $Z = \\mu c$ 且 $1/Z = \\epsilon c$。我们寻求 $e$ 和 $h$ 的线性组合，这些组合是平流的。我们定义特征变量 $w^{\\pm}$ 如下：\n$$\nw^{\\pm} = h \\pm \\frac{1}{Z} (\\mathbf{n} \\times e)\n$$\n对 $w^{\\pm}$ 求时间导数，并在分离出 $\\partial_t e$ 和 $\\partial_t h$ 后代入系统方程：\n$$\n\\frac{\\partial e}{\\partial t} = -\\frac{1}{\\epsilon} \\mathbf{n} \\times \\frac{\\partial h}{\\partial n} \\quad \\text{和} \\quad \\frac{\\partial h}{\\partial t} = \\frac{1}{\\mu} \\mathbf{n} \\times \\frac{\\partial e}{\\partial n}\n$$\n$$\n\\frac{\\partial w^{\\pm}}{\\partial t} = \\frac{\\partial h}{\\partial t} \\pm \\frac{1}{Z} \\mathbf{n} \\times \\frac{\\partial e}{\\partial t} = \\frac{1}{\\mu} \\mathbf{n} \\times \\frac{\\partial e}{\\partial n} \\pm \\frac{1}{Z} \\mathbf{n} \\times \\left(-\\frac{1}{\\epsilon} \\mathbf{n} \\times \\frac{\\partial h}{\\partial n}\\right) = \\frac{c}{Z} \\mathbf{n} \\times \\frac{\\partial e}{\\partial n} \\pm \\frac{c}{Z \\epsilon c} \\frac{\\partial h}{\\partial n} = \\frac{c}{Z} \\mathbf{n} \\times \\frac{\\partial e}{\\partial n} \\pm c \\frac{\\partial h}{\\partial n}\n$$\n现在，对 $w^{\\pm}$ 求空间导数：\n$$\n\\frac{\\partial w^{\\pm}}{\\partial n} = \\frac{\\partial h}{\\partial n} \\pm \\frac{1}{Z} \\mathbf{n} \\times \\frac{\\partial e}{\\partial n}\n$$\n比较这些导数，我们看到：\n$$\n\\frac{\\partial w^{\\pm}}{\\partial t} = \\pm c \\left(\\frac{1}{Z} \\mathbf{n} \\times \\frac{\\partial e}{\\partial n} \\pm \\frac{\\partial h}{\\partial n} \\right) = \\pm c \\frac{\\partial w^{\\pm}}{\\partial n}\n$$\n因此我们得到了平流方程 $(\\partial_t \\mp c \\partial_n)w^{\\pm} = 0$。$w^{+}$ 以速度 $c$ 在 $+\\mathbf{n}$ 方向传播，$w^{-}$ 以速度 $c$ 在 $-\\mathbf{n}$ 方向传播。这就是特征分解。\n\n接下来，我们研究在方向反转 $\\mathbf{n} \\mapsto -\\mathbf{n}$ 下，有向切向跳跃算子 $\\llbracket \\mathbf{v} \\rrbracket_{\\mathbf{n}}^{t} = \\mathbf{n} \\times \\mathbf{v}^{-} - \\mathbf{n} \\times \\mathbf{v}^{+}$ 的行为。标签“负”和“正”指的是空间中的固定区域。$\\mathbf{v}^{-}$ 是来自负区域的迹，$\\mathbf{v}^{+}$ 是来自正区域的迹。这些迹与法向量的选择无关。设 $\\mathbf{n}' = -\\mathbf{n}$。那么：\n$$\n\\llbracket \\mathbf{v} \\rrbracket_{-\\mathbf{n}}^{t} = (-\\mathbf{n}) \\times \\mathbf{v}^{-} - (-\\mathbf{n}) \\times \\mathbf{v}^{+} = -(\\mathbf{n} \\times \\mathbf{v}^{-} - \\mathbf{n} \\times \\mathbf{v}^{+}) = - \\llbracket \\mathbf{v} \\rrbracket_{\\mathbf{n}}^{t}\n$$\n因此，反转 $\\mathbf{n}$ 的方向会改变有向切向跳跃的符号。\n\n### 第二部分：迎风数值通量\n\n迎风通量是通过在界面上强制传入特征变量的连续性来构造的。界面将“负”介质（参数为 $\\epsilon^{-}, \\mu^{-}, Z^{-}$）与“正”介质（$\\epsilon^{+}, \\mu^{+}, Z^{+}$）分开。\n来自“负”侧的传入特征波沿 $+\\mathbf{n}$ 方向传播，因此我们使用 $w^{-,+} = h^{-} + \\frac{1}{Z^{-}} (\\mathbf{n} \\times e^{-})$。\n来自“正”侧的传入特征波沿 $-\\mathbf{n}$ 方向传播，因此我们使用 $w^{+,-} = h^{+} - \\frac{1}{Z^{+}} (\\mathbf{n} \\times e^{+})$。\n迎风星状态 $(e^{\\star}, h^{\\star})$ 必须满足这些传入特征的连续性：\n1.  $h^{\\star} + \\frac{1}{Z^{-}} (\\mathbf{n} \\times e^{\\star}) = h^{-} + \\frac{1}{Z^{-}} (\\mathbf{n} \\times e^{-})$\n2.  $h^{\\star} - \\frac{1}{Z^{+}} (\\mathbf{n} \\times e^{\\star}) = h^{+} - \\frac{1}{Z^{+}} (\\mathbf{n} \\times e^{+})$\n\n设 $Y^{\\pm} = 1/Z^{\\pm}$。该系统为：\n$$\nh^{\\star} + Y^{-} (\\mathbf{n} \\times e^{\\star}) = h^{-} + Y^{-} (\\mathbf{n} \\times e^{-})\n$$\n$$\nh^{\\star} - Y^{+} (\\mathbf{n} \\times e^{\\star}) = h^{+} - Y^{+} (\\mathbf{n} \\times e^{+})\n$$\n为了求解 $e^{\\star}$，将第二个方程从第一个方程中减去：\n$$\n(Y^{-} + Y^{+}) (\\mathbf{n} \\times e^{\\star}) = (h^{-} - h^{+}) + Y^{-} (\\mathbf{n} \\times e^{-}) + Y^{+} (\\mathbf{n} \\times e^{+})\n$$\n与 $\\mathbf{n}$ 取叉积，并对切向向量 $\\mathbf{v}$ 使用 $\\mathbf{n} \\times (\\mathbf{n} \\times \\mathbf{v}) = -\\mathbf{v}$：\n$$\n-(Y^{-} + Y^{+}) e^{\\star} = \\mathbf{n} \\times (h^{-} - h^{+}) - Y^{-}e^{-} - Y^{+}e^{+}\n$$\n$$\ne^{\\star} = \\frac{1}{Y^{-} + Y^{+}} \\left[ (Y^{-}e^{-} + Y^{+}e^{+}) - \\mathbf{n} \\times (h^{-} - h^{+}) \\right]\n$$\n为了求解 $h^{\\star}$，将第一个方程乘以 $Y^{+}$，第二个方程乘以 $Y^{-}$，然后相加：\n$$\n(Y^{+} + Y^{-}) h^{\\star} = Y^{+}(h^{-} + Y^{-}(\\mathbf{n} \\times e^{-})) + Y^{-}(h^{+} - Y^{+}(\\mathbf{n} \\times e^{+}))\n$$\n$$\nh^{\\star} = \\frac{1}{Y^{-} + Y^{+}} \\left[ Y^{+}h^{-} + Y^{-}h^{+} + Y^{-}Y^{+}(\\mathbf{n} \\times (e^{-} - e^{+})) \\right]\n$$\n这些表达式定义了唯一的迎风有向切向星状态 $(e^{\\star}, h^{\\star})$。\n\n### 第三部分：一致性验证\n\n我们必须计算 $\\Delta = \\left\\| \\begin{pmatrix} e^{\\star}(\\mathbf{n}) \\\\ h^{\\star}(\\mathbf{n}) \\end{pmatrix} + \\begin{pmatrix} e^{\\star}(-\\mathbf{n}) \\\\ h^{\\star}(-\\mathbf{n}) \\end{pmatrix} \\right\\|$。项 $e^{\\star}(-\\mathbf{n})$ 表示用法向量 $\\mathbf{n}' = -\\mathbf{n}$ 计算的星状态。物理场 $\\mathbf{E}^{\\pm}$ 和 $\\mathbf{H}^{\\pm}$ 不变，但有向切向场发生变换：\n$e'^{\\pm} = \\mathbf{n}' \\times \\mathbf{E}^{\\pm} = -\\mathbf{n} \\times \\mathbf{E}^{\\pm} = -e^{\\pm}$。\n$h'^{\\pm} = \\mathbf{n}' \\times \\mathbf{H}^{\\pm} = -\\mathbf{n} \\times \\mathbf{H}^{\\pm} = -h^{\\pm}$。\n\n针对 $\\mathbf{n}'$ 方向的星状态 $(e^{\\star'}, h^{\\star'})$ 是通过建立迎风条件来找到的。物理传播方向不变。来自“负”侧的波沿 $+\\mathbf{n}$ 传播，即 $-\\mathbf{n}'$ 方向。来自“正”侧的波沿 $-\\mathbf{n}$ 传播，即 $+\\mathbf{n}'$ 方向。\n现在，传入的特征波是来自“负”侧的 $w'^{-, -}$ 和来自“正”侧的 $w'^{+, +}$。\n$(e^{\\star'}, h^{\\star'})$ 的连续性条件是：\n1.  $h^{\\star'} - Y^{-} (\\mathbf{n}' \\times e^{\\star'}) = w'^{-,-} = h'^{-} - Y^{-} (\\mathbf{n}' \\times e'^{-})$\n2.  $h^{\\star'} + Y^{+} (\\mathbf{n}' \\times e^{\\star'}) = w'^{+,+} = h'^{+} + Y^{+} (\\mathbf{n}' \\times e'^{+})$\n\n代入 $\\mathbf{n}' = -\\mathbf{n}$，$e'^{\\pm} = -e^{\\pm}$，$h'^{\\pm} = -h^{\\pm}$：\n1.  $h^{\\star'} - Y^{-} ((-\\mathbf{n}) \\times e^{\\star'}) = -h^{-} - Y^{-} ((-\\mathbf{n}) \\times (-e^{-}))$\n    $\\implies h^{\\star'} + Y^{-} (\\mathbf{n} \\times e^{\\star'}) = -h^{-} - Y^{-} (\\mathbf{n} \\times e^{-}) = - (h^{-} + Y^{-} (\\mathbf{n} \\times e^{-}))$\n2.  $h^{\\star'} + Y^{+} ((-\\mathbf{n}) \\times e^{\\star'}) = -h^{+} + Y^{+} ((-\\mathbf{n}) \\times (-e^{+}))$\n    $\\implies h^{\\star'} - Y^{+} (\\mathbf{n} \\times e^{\\star'}) = -h^{+} + Y^{+} (\\mathbf{n} \\times e^{+}) = - (h^{+} - Y^{+} (\\mathbf{n} \\times e^{+}))$\n\n让我们将这个关于 $(e^{\\star'},h^{\\star'})$ 的新系统与关于 $(e^{\\star},h^{\\star})$ 的原始系统进行比较。\n如果我们假设解为 $e^{\\star'} = -e^{\\star}$ 和 $h^{\\star'} = -h^{\\star}$，则方程 (1) 的左边变为：\n$-h^{\\star} + Y^{-} (\\mathbf{n} \\times (-e^{\\star})) = -(h^{\\star} + Y^{-} (\\mathbf{n} \\times e^{\\star}))$。\n方程 (1) 的右边是 $-(h^{-} + Y^{-} (\\mathbf{n} \\times e^{-}))$.\n由于 $h^{\\star} + Y^{-} (\\mathbf{n} \\times e^{\\star}) = h^{-} + Y^{-} (\\mathbf{n} \\times e^{-})$，此方程成立。\n类似地，对于方程 (2)，左边变为：\n$-h^{\\star} - Y^{+} (\\mathbf{n} \\times (-e^{\\star})) = -(h^{\\star} - Y^{+} (\\mathbf{n} \\times e^{\\star}))$。\n右边是 $-(h^{+} - Y^{+} (\\mathbf{n} \\times e^{+}))$.\n由于 $h^{\\star} - Y^{+} (\\mathbf{n} \\times e^{\\star}) = h^{+} - Y^{+} (\\mathbf{n} \\times e^{+})$，此方程也成立。\n由于线性系统的解是唯一的，我们证明了\n$$\ne^{\\star}(-\\mathbf{n}; \\mathbf{E}^{-}, \\mathbf{H}^{-}, \\mathbf{E}^{+}, \\mathbf{H}^{+}) = -e^{\\star}(\\mathbf{n}; \\mathbf{E}^{-}, \\mathbf{H}^{-}, \\mathbf{E}^{+}, \\mathbf{H}^{+})\n$$\n$$\nh^{\\star}(-\\mathbf{n}; \\mathbf{E}^{-}, \\mathbf{H}^{-}, \\mathbf{E}^{+}, \\mathbf{H}^{+}) = -h^{\\star}(\\mathbf{n}; \\mathbf{E}^{-}, \\mathbf{H}^{-}, \\mathbf{E}^{+}, \\mathbf{H}^{+})\n$$\n现在我们可以计算量 $\\Delta$：\n$$\n\\begin{pmatrix} e^{\\star}(\\mathbf{n}) \\\\ h^{\\star}(\\mathbf{n}) \\end{pmatrix} + \\begin{pmatrix} e^{\\star}(-\\mathbf{n}) \\\\ h^{\\star}(-\\mathbf{n}) \\end{pmatrix} = \\begin{pmatrix} e^{\\star}(\\mathbf{n}) \\\\ h^{\\star}(\\mathbf{n}) \\end{pmatrix} + \\begin{pmatrix} -e^{\\star}(\\mathbf{n}) \\\\ -h^{\\star}(\\mathbf{n}) \\end{pmatrix} = \\begin{pmatrix} \\mathbf{0} \\\\ \\mathbf{0} \\end{pmatrix}\n$$\n零向量的欧几里得范数为零。\n$$\n\\Delta = \\left\\| \\begin{pmatrix} \\mathbf{0} \\\\ \\mathbf{0} \\end{pmatrix} \\right\\| = 0\n$$\n这个结果表明迎风通量是一致的，意味着它所代表的底层物理状态与界面法线方向的任意选择无关。", "answer": "$$\\boxed{0}$$", "id": "3335507"}, {"introduction": "为了保证稳定性，数值通量通常会引入人工耗散，但这可能导致不必要的数值误差，如在粗细网格过渡处的伪反射。本练习模拟了一个实际计算中常见的问题，要求您实现并比较一个标准的数值通量和一个更先进的自适应通量。通过这个实践 [@problem_id:3335515]，您将探索如何通过巧妙地将波传播物理学融入通量设计中，来有效抑制这些伪影。", "problem": "考虑在介电常数为 $\\varepsilon$、磁导率为 $\\mu$ 的均匀各向同性介质中的二维横电 (TE) 形式的麦克斯韦方程组，因此电磁波速为 $c = 1/\\sqrt{\\mu \\varepsilon}$。设一个单色平面波入射到两个间断 Galerkin (DG) 单元之间的一个内部面上，这两个单元在一个粗细网格尺寸界面处相遇。将界面单位法向量记为 $\\mathbf{n}$，并将入射角 $\\theta$ 定义为波矢量 $\\mathbf{k}$ 与 $\\mathbf{n}$ 之间的夹角，因此相速度的法向分量为 $c_n = c \\, |\\cos \\theta|$。考虑穿过一个 DG 面的、用于对称双曲系统的常用 Lax–Friedrichs 型数值通量，该通量通过一个与状态跳跃成正比的耗散惩罚项来增强平均物理通量，此惩罚项由一个逐面的耗散参数 $\\alpha$ 控制。\n\n从守恒律形式的麦克斯韦方程组和界面上切向场的连续性出发，按如下方式对数值耗散产生的反射进行建模：用法向标量一阶透射-反射模型来近似切向场振幅的界面相互作用，在该模型中，一个具有入射振幅 $A_i$ 和反射振幅 $A_r$ 的波产生一个透射振幅 $A_t$。假设对于谐波状态，数值通量在线性化意义上强制施加一个关系，该关系等效于一个以法向特征速度 $c_n$ 为基准、参数为 $\\alpha$ 的 Lax–Friedrichs 惩罚。在此模型下，从第一性原理推导反射振幅比 $R = A_r/A_i$ 作为 $\\alpha$ 和 $c_n$ 的函数的闭式表达式，然后将反射功率分数表示为 $P = R^2$。\n\n为了以科学上合理的方式引入粗细网格界面效应，将面上的基准耗散参数定义为\n$$\n\\alpha_{\\text{iso}} = c \\, s(r, p_f, p_c), \\quad s(r, p_f, p_c) = 1 + \\frac{r - 1}{r + 1} \\cdot \\frac{p_c + 1}{p_f + 1},\n$$\n其中 $r = h_c / h_f \\geq 1$ 是粗单元与细单元尺寸之比，$p_f$ 和 $p_c$ 分别是细网格侧和粗网格侧的多项式次数。这个 $s(r,p_f,p_c) \\geq 1$ 代表了在非协调界面上常用的增强稳定性。现在，设计一种入射角自适应方法，通过将有效面耗散限制在法向特征速度来减少伪反射：\n$$\n\\alpha_{\\text{adapt}} = \\min\\!\\left(\\alpha_{\\text{iso}}, \\, c_n\\right).\n$$\n\n您的任务是：\n1. 根据上述物理和数值原理，推导反射振幅 $R(\\alpha, c_n)$ 和反射功率 $P(\\alpha, c_n)$。\n2. 实现一个程序，为每个测试用例计算两个数值：$P_{\\text{iso}} = P(\\alpha_{\\text{iso}}, c_n)$ 和 $P_{\\text{adapt}} = P(\\alpha_{\\text{adapt}}, c_n)$。\n\n假设使用无量纲单位，其中 $c = 1$。角度单位必须是度，您必须在内部将其转换为弧度以进行任何三角函数计算。最终答案必须是浮点数。\n\n测试套件：\n- 用例 1（理想情况，法向入射，中等不匹配）：$r = 2$，$p_f = 3$，$p_c = 1$，$\\theta = 0^\\circ$。\n- 用例 2（斜入射，较大不匹配）：$r = 4$，$p_f = 4$，$p_c = 1$，$\\theta = 60^\\circ$。\n- 用例 3（近掠射，强不匹配）：$r = 8$，$p_f = 5$，$p_c = 1$，$\\theta = 80^\\circ$。\n- 用例 4（无 $h$ 不匹配，斜入射）：$r = 1$，$p_f = 3$，$p_c = 3$，$\\theta = 45^\\circ$。\n- 用例 5（极端掠射）：$r = 16$，$p_f = 7$，$p_c = 2$，$\\theta = 89.9^\\circ$。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，顺序必须严格遵循\n$$\n[P_{\\text{iso},1}, P_{\\text{adapt},1}, P_{\\text{iso},2}, P_{\\text{adapt},2}, P_{\\text{iso},3}, P_{\\text{adapt},3}, P_{\\text{iso},4}, P_{\\text{adapt},4}, P_{\\text{iso},5}, P_{\\text{adapt},5}],\n$$\n其中索引对应于上述编号的测试用例。", "solution": "该问题要求推导和计算在间断 Galerkin (DG) 界面处（粗网格与细网格交界处）产生的伪数值反射。这种反射是数值通量中稳定项的人为产物，此处指定为 Lax-Friedrichs 类型。\n\n### 第 1 部分：反射模型的推导\n\n单色平面波与单个数值界面的相互作用可以使用简化的一维模型进行分析。问题陈述中指出，我们应该用法向 $\\mathbf{n}$ 上的标量一阶透射-反射模型来近似完整的电磁相互作用。\n\n设场振幅由标量 $u$ 表示。该振幅在垂直于界面方向上的传播由标量平流方程 $u_t + c_n u_x = 0$ 控制，其中 $c_n = c |\\cos\\theta|$ 是相速度的法向分量。这里，$c$ 是介质中的光速，$\\theta$ 是入射角。\n\n在位于 $x=0$ 的界面处，振幅为 $A_i$ 的入射波从左侧 ($x0$) 到达，产生一个振幅为 $A_r$ 的反射波向左传播，以及一个振幅为 $A_t$ 的透射波进入右半空间 ($x0$)。因此，界面紧邻左右两侧的总场振幅由以下公式给出：\n$$\nu^- = A_i + A_r\n$$\n$$\nu^+ = A_t\n$$\n在物理的均匀介质中，不会有反射，即 $A_r=0$ 且 $A_t=A_i$。这里分析的反射是 DG 格式为保证稳定性所需的数值通量中的耗散部分所产生的纯粹数值产物。问题指定了 Lax-Friedrichs (LF) 数值通量，对于标量平流方程，其形式为：\n$$\n\\mathcal{F}(u^-, u^+) = \\frac{1}{2}(c_n u^- + c_n u^+) - \\frac{\\alpha}{2}(u^+ - u^-)\n$$\n这里，$\\alpha$ 是耗散参数，它控制人工粘性的大小。\n\n对波与由数值通量定义的界面相互作用进行标准的特征分析，可以得到入射波、反射波和透射波振幅之间的关系。该分析构成了从数值波传播的第一性原理出发的推导，得出了反射振幅比 $R = A_r/A_i$ 的闭式表达式。对于 Lax-Friedrichs 通量，该比值为：\n$$\nR(\\alpha, c_n) = \\frac{c_n - \\alpha}{c_n + \\alpha}\n$$\n这个公式是我们分析的核心。它在数值参数 $\\alpha$ 和反射 $R$ 这一物理后果之间建立了直接联系。\n\n从这个公式中可以得出一个关键观察：如果 $\\alpha = c_n$，反射系数 $R$ 变为零。在这种情况下，Lax-Friedrichs 通量简化为标量平流方程的纯上风通量，即 $\\mathcal{F}(u^-, u^+) = c_n u^-$。众所周知，上风通量具有最小耗散性，并且对于沿上风方向传播的波不产生伪反射。\n\n反射功率分数 $P$ 与反射波振幅的平方成正比。因此，反射功率比由下式给出：\n$$\nP(\\alpha, c_n) = R^2 = \\left(\\frac{c_n - \\alpha}{c_n + \\alpha}\\right)^2\n$$\n\n### 第 2 部分：在耗散模型中的应用\n\n问题为粗细界面处的耗散参数 $\\alpha$ 定义了两种模型。\n\n1.  **各向同性耗散 ($\\alpha_{\\text{iso}}$)**：这是一个基准模型，其中耗散与入射角无关。该参数定义为 $\\alpha_{\\text{iso}} = c \\cdot s(r, p_f, p_c)$，其中 $r=h_c/h_f$ 是粗单元与细单元尺寸之比，$p_c$ 和 $p_f$ 分别是粗网格侧和细网格侧的多项式次数，稳定函数 $s$ 为：\n    $$\n    s(r, p_f, p_c) = 1 + \\frac{r - 1}{r + 1} \\cdot \\frac{p_c + 1}{p_f + 1}\n    $$\n    此模型的反射功率为 $P_{\\text{iso}} = P(\\alpha_{\\text{iso}}, c_n)$。\n\n2.  **自适应耗散 ($\\alpha_{\\text{adapt}}$)**：该模型根据入射角调整耗散以减少伪反射。它将耗散参数的上限限制在法向特征速度 $c_n$：\n    $$\n    \\alpha_{\\text{adapt}} = \\min(\\alpha_{\\text{iso}}, c_n)\n    $$\n    反射功率为 $P_{\\text{adapt}} = P(\\alpha_{\\text{adapt}}, c_n)$。如前所述，如果 $\\alpha_{\\text{iso}} \\geq c_n$，则 $\\alpha_{\\text{adapt}} = c_n$，反射 $P_{\\text{adapt}}$ 将为零。当基准耗散超过入射特征的法向速度时，这种自适应策略能有效地恢复无反射的上风条件。\n\n计算任务是为每个给定的测试用例计算 $P_{\\text{iso}}$ 和 $P_{\\text{adapt}}$。我们假设使用无量纲单位，其中 $c=1$。对于每个测试用例，我们执行以下步骤：\n1.  将入射角 $\\theta$ 从度转换为弧度。\n2.  计算法向特征速度 $c_n = c|\\cos\\theta| = |\\cos\\theta|$。\n3.  计算稳定函数 $s(r, p_f, p_c)$ 和基准耗散 $\\alpha_{\\text{iso}} = s$。\n4.  确定自适应耗散 $\\alpha_{\\text{adapt}} = \\min(\\alpha_{\\text{iso}}, c_n)$。\n5.  使用推导的公式 $P(\\alpha, c_n)$ 计算反射功率分数 $P_{\\text{iso}}$ 和 $P_{\\text{adapt}}$。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem of calculating spurious numerical reflection for\n    different dissipation models in a Discontinuous Galerkin scheme.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (r, p_f, p_c, theta_degrees)\n    test_cases = [\n        (2, 3, 1, 0.0),    # Case 1\n        (4, 4, 1, 60.0),   # Case 2\n        (8, 5, 1, 80.0),   # Case 3\n        (1, 3, 3, 45.0),   # Case 4\n        (16, 7, 2, 89.9),   # Case 5\n    ]\n\n    results = []\n    \n    # Speed of light in dimensionless units\n    c = 1.0\n\n    def calculate_reflected_power(alpha, c_n):\n        \"\"\"\n        Calculates the reflected power fraction P = R^2.\n        Args:\n            alpha (float): The dissipation parameter.\n            c_n (float): The normal component of the phase speed.\n        Returns:\n            float: The reflected power fraction.\n        \"\"\"\n        if c_n + alpha == 0:\n            # Handle potential division by zero, though unlikely with problem constraints\n            # (alpha and c_n are non-negative).\n            return 1.0 if c_n - alpha != 0 else 0.0\n        \n        reflection_ratio = (c_n - alpha) / (c_n + alpha)\n        return reflection_ratio**2\n\n    for case in test_cases:\n        r, p_f, p_c, theta_deg = case\n\n        # Convert angle to radians for trigonometric functions\n        theta_rad = np.deg2rad(theta_deg)\n\n        # Calculate the normal component of the phase speed\n        c_n = c * np.abs(np.cos(theta_rad))\n\n        # Calculate the stabilization function s(r, p_f, p_c)\n        s = 1.0 + ((r - 1.0) / (r + 1.0)) * ((p_c + 1.0) / (p_f + 1.0))\n\n        # Calculate the isotropic dissipation parameter\n        alpha_iso = c * s\n\n        # Calculate the adaptive dissipation parameter\n        alpha_adapt = min(alpha_iso, c_n)\n\n        # Calculate reflected power for the isotropic model\n        p_iso = calculate_reflected_power(alpha_iso, c_n)\n\n        # Calculate reflected power for the adaptive model\n        p_adapt = calculate_reflected_power(alpha_adapt, c_n)\n\n        results.extend([p_iso, p_adapt])\n\n    # Final print statement in the exact required format.\n    # The format specifier ensures standard float representation.\n    print(f\"[{','.join(f'{res:.8f}' for res in results)}]\")\n\nsolve()\n```", "id": "3335515"}]}