{"hands_on_practices": [{"introduction": "理论上的完美电导体在现实世界中并不存在；所有金属都具有有限的电导率，这会导致欧姆损耗。本实践旨在通过一个物理上合理的简化模型，量化这种损耗对每个特征模式的影响。通过计算和分析模式品质因数 $Q_n$ 和辐射效率 $\\eta_n$，您将深入理解在实际天线设计中辐射功率与损耗功率之间的基本权衡关系 [@problem_id:3292846]。", "problem": "给定一个位于自由空间中、半径为 $a$ 的薄壁、闭合、完美光滑的金属球壳，考虑在电场积分方程 (EFIE) 框架下的特征模式分析 (CMA)。该球壳的阻抗算子建模为 $$[Z(\\omega)] = [R_\\text{rad}(\\omega)] + [R_\\text{ohm}(\\omega)] + j[X(\\omega)],$$ 其中 $[R_\\text{rad}]$ 是表示辐射功率的辐射电阻算子，$[R_\\text{ohm}]$ 是表示由有限电导率引起的传导损耗的欧姆电阻算子，而 $[X]$ 是电抗算子。CMA 特征问题由广义特征值方程构成 $$[X(\\omega)] \\mathbf{J}_n(\\omega) = \\lambda_n(\\omega) [R_\\text{rad}(\\omega)] \\mathbf{J}_n(\\omega),$$ 其中 $\\mathbf{J}_n$ 是第 $n$ 个特征电流模式，$\\lambda_n$ 是对应的特征值。\n\n假设就 $ka$ 而言，该球壳为电小尺寸到中等尺寸，其中 $k = \\omega/c$ 是自由空间波数，$c$ 是光速。在球壳上使用由 $l$ 阶切向矢量球谐函数构成的模式基，其中 $l = 1,2,\\dots,L$ 为模式族的索引。在此基下，使用以下具有物理动机的标度关系，将算子近似为关于 $l$ 的对角阵：\n\n- 每个模式的辐射电阻：\n$$R_{\\text{rad},l}(\\omega) = Z_0 \\, C_l \\, (ka)^{2l+1},$$\n其中 $Z_0 = \\sqrt{\\mu_0/\\epsilon_0}$ 是自由空间波阻抗，$\\mu_0$ 是真空磁导率，$\\epsilon_0$ 是真空介电常数，$C_l > 0$ 是一个无量纲且与几何相关的模式辐射系数。\n\n- 使用良导体表面电阻模型计算每个模式的欧姆电阻：\n$$R_{\\text{ohm},l}(\\omega) = R_s(\\omega,\\sigma) \\, D_l,$$\n表面电阻为\n$$R_s(\\omega,\\sigma) = \\sqrt{\\frac{\\omega \\mu_0}{2\\sigma}} = \\sqrt{\\frac{\\pi f \\mu_0}{\\sigma}},$$\n其中角频率为 $\\omega = 2\\pi f$，电导率为 $\\sigma$。$D_l > 0$ 是一个无量纲的模式耗散系数，表示第 $l$ 个模式在球壳上的电流集中和路径长度效应。\n\n- 使用存储能量和辐射功率计算的模式品质因数：\n$$Q_l(ka) = \\frac{\\omega \\, W_l(ka)}{P_{\\text{rad},l}(ka)},$$\n其中 $W_l$ 是第 $l$ 个模式的时间平均存储无功能量，$P_{\\text{rad},l}$ 是时间平均辐射功率。对于电小球壳，$Q_l$ 主要由近场储能项决定，这些项与 $ka$ 的负幂成比例，从而得到一个复合渐近模型\n$$Q_l(ka) \\approx \\frac{A_l}{(ka)^3} + \\frac{B_l}{ka},$$\n其中 $A_l>0$ 和 $B_l>0$ 是无量纲的模式形状因子，分别表示电场型和磁场型储能的贡献。\n\n将第 $l$ 个模式的辐射效率定义为\n$$\\eta_l(\\omega) = \\frac{R_{\\text{rad},l}(\\omega)}{R_{\\text{rad},l}(\\omega) + R_{\\text{ohm},l}(\\omega)}.$$\n\n您的任务是实现一个程序，使用上述算子标度关系，评估有限电导率如何影响薄金属壳上不同模式的模式品质因数 $Q_l$ 和辐射效率 $\\eta_l$。使用以下模式形状因子来捕捉随模式指数 $l$ 增加而预期的近场储能和耗散的增长：\n- $$A_l = \\frac{l(l+1)}{2}, \\quad B_l = l, \\quad C_l = 10^{-3}, \\quad D_l = l(l+1)。$$\n\n为以下测试套件计算这些量（所有量均采用国际单位制 (SI)）：\n\n- 案例1（常规正常路径）：$a = 0.05$ 米，$f = 300 \\times 10^6$ 赫兹，$\\sigma = 5.8 \\times 10^7$ 西门子/米，$L = 4$。\n- 案例2（电小边界）：$a = 0.05$ 米，$f = 30 \\times 10^6$ 赫兹，$\\sigma = 5.8 \\times 10^7$ 西门子/米，$L = 4$。\n- 案例3（不良导体边缘情况）：$a = 0.05$ 米，$f = 1 \\times 10^9$ 赫兹，$\\sigma = 1 \\times 10^5$ 西门子/米，$L = 4$。\n- 案例4（更高频率正常路径）：$a = 0.05$ 米，$f = 3 \\times 10^9$ 赫兹，$\\sigma = 5.8 \\times 10^7$ 西门子/米，$L = 4$。\n\n对于每个案例，评估 $l = 1,2,3,4$ 时的 $Q_l$ 和 $\\eta_l$。程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。结果按案例和递增的模式指数 $l$ 排序，每对作为连续条目 $[Q_1,\\eta_1,Q_2,\\eta_2,\\dots,Q_4,\\eta_4]$，首先是案例1的结果，然后依次附加案例2、案例3和案例4的结果。所有输出均为无量纲实数。不使用角度。不使用百分比。", "solution": "问题陈述已经过严格评估，并被确定为有效。它是自洽的，科学上基于计算电磁学的原理，并且在数学上是适定的。它为薄金属球壳的特征模式分析 (CMA) 提供了一个简化但一致的模型。任务是使用提供的公式和参数计算定义的物理量。\n\n目标是为一组测试案例计算模式品质因数 $Q_l$ 和模式辐射效率 $\\eta_l$。计算基于一系列为球壳模式特性指定的解析模型。使用的基本物理常数是真空中的光速 $c \\approx 299792458 \\, \\text{m/s}$ 和真空磁导率 $\\mu_0 = 4\\pi \\times 10^{-7} \\, \\text{H/m}$。由此，自由空间的阻抗推导为 $Z_0 = \\sqrt{\\mu_0/\\epsilon_0} = c\\mu_0 \\approx 376.73 \\, \\Omega$。\n\n对于每个由壳半径 $a$、工作频率 $f$ 和壳电导率 $\\sigma$ 定义的测试案例，其计算步骤如下。对于从 $1$ 到最大指定阶数 $L=4$ 的每个模式指数 $l$：\n\n1.  **计算派生物理参数**：首先，我们计算依赖于工作频率 $f$ 的参数。\n    -   角频率为 $\\omega = 2\\pi f$。\n    -   自由空间波数为 $k = \\omega/c$。\n    -   球体的无量纲尺寸参数为 $ka$。\n\n2.  **确定模式相关系数**：问题指定了以下依赖于模式指数 $l$ 的无量纲系数：\n    -   $A_l = \\frac{l(l+1)}{2}$\n    -   $B_l = l$\n    -   $C_l = 10^{-3}$ (对所有 $l$ 恒定)\n    -   $D_l = l(l+1)$\n\n3.  **计算模式品质因数 $Q_l$**：使用提供的渐近模型，第 $l$ 个模式的品质因数计算如下：\n    $$Q_l(ka) = \\frac{A_l}{(ka)^3} + \\frac{B_l}{ka}$$\n    该公式结合了电场型（$A_l$）和磁场型（$B_l$）储能机制的贡献，这两种机制在电小结构中占主导地位。\n\n4.  **计算模式电阻**：辐射效率取决于模式辐射电阻 $R_{\\text{rad},l}$ 和模式欧姆电阻 $R_{\\text{ohm},l}$。\n    -   首先，计算金属壳的表面电阻 $R_s$。该值取决于频率和电导率：\n        $$R_s(\\omega,\\sigma) = \\sqrt{\\frac{\\pi f \\mu_0}{\\sigma}}$$\n    -   然后，通过将表面电阻与耗散系数 $D_l$ 相乘，得到模式欧姆电阻 $R_{\\text{ohm},l}$：\n        $$R_{\\text{ohm},l}(\\omega) = R_s(\\omega,\\sigma) \\cdot D_l$$\n    -   模式辐射电阻 $R_{\\text{rad},l}$ 根据其与 $ka$ 的指定标度关系进行计算：\n        $$R_{\\text{rad},l}(\\omega) = Z_0 \\cdot C_l \\cdot (ka)^{2l+1}$$\n\n5.  **计算模式辐射效率 $\\eta_l$**：最后，第 $l$ 个模式的辐射效率计算为辐射功率（与 $R_{\\text{rad},l}$ 成正比）与通过辐射和欧姆损耗消耗的总功率（与 $R_{\\text{rad},l} + R_{\\text{ohm},l}$ 成正比）之比：\n    $$\\eta_l(\\omega) = \\frac{R_{\\text{rad},l}(\\omega)}{R_{\\text{rad},l}(\\omega) + R_{\\text{ohm},l}(\\omega)}$$\n\n对四个指定测试案例中的每一个，都为每个模式指数 $l \\in \\{1, 2, 3, 4\\}$ 执行这一完整的计算序列。然后将得到的 $Q_l$ 和 $\\eta_l$ 的值按规定顺序连接起来，形成最终输出。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the Characteristic Mode Analysis problem for a spherical shell.\n    \"\"\"\n    # Define fundamental physical constants in SI units.\n    C0 = 299792458.0  # Speed of light in vacuum (m/s)\n    MU0 = 4.0 * np.pi * 1e-7  # Vacuum permeability (H/m)\n    Z0 = C0 * MU0  # Free-space wave impedance (Ohms)\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (a, f, sigma, L)\n        (0.05, 300e6, 5.8e7, 4),   # Case 1\n        (0.05, 30e6, 5.8e7, 4),    # Case 2\n        (0.05, 1e9, 1e5, 4),     # Case 3\n        (0.05, 3e9, 5.8e7, 4),     # Case 4\n    ]\n\n    def calculate_metrics_for_case(a, f, sigma, l_max):\n        \"\"\"\n        Calculates Q_l and eta_l for a single test case for l from 1 to l_max.\n        \n        Args:\n            a (float): Radius of the spherical shell in meters.\n            f (float): Frequency in Hertz.\n            sigma (float): Conductivity in Siemens per meter.\n            l_max (int): Maximum mode index to compute.\n            \n        Returns:\n            list: A flat list of [Q1, eta1, Q2, eta2, ...].\n        \"\"\"\n        # Calculate derived physical parameters\n        omega = 2.0 * np.pi * f\n        k = omega / C0\n        ka = k * a\n\n        # Calculate surface resistance Rs\n        Rs = np.sqrt((np.pi * f * MU0) / sigma)\n\n        case_results = []\n        for l in range(1, l_max + 1):\n            # Define mode-dependent coefficients\n            A_l = float(l * (l + 1)) / 2.0\n            B_l = float(l)\n            C_l = 1e-3\n            D_l = float(l * (l + 1))\n\n            # Compute modal quality factor Q_l\n            # The problem context ensures ka > 0\n            Q_l = (A_l / np.power(ka, 3)) + (B_l / ka)\n\n            # Compute modal resistances\n            R_ohm_l = Rs * D_l\n            R_rad_l = Z0 * C_l * np.power(ka, 2 * l + 1)\n            \n            # Compute modal radiation efficiency eta_l\n            denominator = R_rad_l + R_ohm_l\n            if denominator == 0.0:\n                 # This case is unlikely with the given formulas but handled for robustness.\n                eta_l = 0.0\n            else:\n                eta_l = R_rad_l / denominator\n\n            case_results.append(Q_l)\n            case_results.append(eta_l)\n        \n        return case_results\n\n    # Process all test cases and collect results\n    all_results = []\n    for case in test_cases:\n        a, f, sigma, l_max = case\n        all_results.extend(calculate_metrics_for_case(a, f, sigma, l_max))\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, all_results))}]\")\n\nsolve()\n```", "id": "3292846"}, {"introduction": "当一个结构的几何对称性被破坏时，其特征模式的行为并非随机，而是遵循深刻的物理规律。本练习利用一个简洁的矩阵模型来模拟这一过程，揭示模式简并、模式交叉和模式趋避（或称避免交叉）等现象背后的原理。通过这个实践，您将直观地理解对称性选择定则如何决定模式间的相互作用，这对于在复杂系统中准确追踪和解释模式频谱至关重要 [@problem_id:3292914]。", "problem": "你需要设计并实现一个基于特定原理的数值实验，在理想电导体 (PEC) 的特征模式分析框架下，探究特征本征值的趋避交叉 (veering/avoided crossing) 与真实交叉 (true crossing)现象。你的出发点必须是电场积分方程 (EFIE) 的算子形式以及特征模式的定义：一个模式电流被定义为一个非平凡向量 $\\mathbf{J}$ 和一个实标量 $\\lambda$，使得实对称电抗算子 $\\mathbf{X}(\\omega)$ 和实对称辐射算子 $\\mathbf{R}(\\omega)$ 满足广义厄米本征值问题\n$$\n\\mathbf{X}(\\omega)\\,\\mathbf{J} \\;=\\; \\lambda(\\omega)\\,\\mathbf{R}(\\omega)\\,\\mathbf{J}.\n$$\n对于在对称性参数 $s=0$ 时具有高度几何对称性的 PEC，当对称群的不可约表示的维度大于1时，会发生模式简并。当对称性因一个小扰动 $s>0$ 而降低时，只有属于剩余对称群的同一不可约表示的模式之间才允许耦合（群论选择定则），这通常会产生趋避交叉。而那些保持在降阶对称性的不同不可约表示中的模式则不会耦合，因此会发生交叉。\n\n为了使这个实验自洽且在计算上适定，无需进行完整的电磁离散化，你将实现一个降阶的、对称性匹配的 $4\\times 4$ 实对称矩阵束模型 $\\left(\\mathbf{X}(\\omega,s),\\mathbf{R}(s)\\right)$，该模型是通过在四个对称性匹配的基函数上进行伽辽金截断得到的。这些基函数按两个族（$A$ 和 $B$）进行标记，每个族在 $s=0$ 时由于高对称性而具有二重简并，并带有一个剩余宇称标签 $p\\in\\{+,-\\}$，该标签编码了降阶对称性的不可约表示：\n- 索引 0：族 $A$，宇称 $+$，\n- 索引 1：族 $A$，宇称 $-$，\n- 索引 2：族 $B$，宇称 $+$，\n- 索引 3：族 $B$，宇称 $-$。\n\n你的构建必须满足以下基于物理的结构规则：\n- 算子 $\\mathbf{R}(s)$ 是正定的、实对称的，并且在所选基中是对角的，每个族内的条目重复。\n- 算子 $\\mathbf{X}(\\omega,s)$ 是实对称的，并且在 $s=0$ 时是对角的，每个族内有两个相同的对角线条目，从而产生与高对称性一致的简并。对于 $s>0$，通过以下方式引入对称性破缺：(i) 每个族内与 $s^2$ 成正比且在 $+$ 和 $-$ 宇称之间改变符号的小的宇称分裂对角位移，以及 (ii) 仅在共享相同剩余宇称标签 $p$ 的基函数之间允许的非对角耦合，这模拟了群论选择定则。\n\n使用以下显式参数化，它在物理上一致、数值上稳定且无量纲：\n- 辐射算子：\n$$\n\\mathbf{R}(s)=\\operatorname{diag}\\big(r_A,\\,r_A,\\,r_B,\\,r_B\\big),\\quad r_A=1.0,\\quad r_B=1.1.\n$$\n- 在对称性参数 $s$ 和角频率 $\\omega$ 下的电抗算子：\n$$\n\\mathbf{X}(\\omega,s)=\\operatorname{diag}\\big(x_A(\\omega)+\\delta_A(s,+),\\;x_A(\\omega)+\\delta_A(s,-),\\;x_B(\\omega)+\\delta_B(s,+),\\;x_B(\\omega)+\\delta_B(s,-)\\big)\\;+\\;\\mathbf{C}(s),\n$$\n其中对角色散函数为\n$$\nx_A(\\omega)=\\omega-2.0,\\qquad x_B(\\omega)=0.6\\,(\\omega-1.0),\n$$\n宇称分裂位移为\n$$\n\\delta_A(s,\\pm)=\\pm d_A\\,s^2,\\quad d_A=0.03,\\qquad \\delta_B(s,\\pm)=\\pm d_B\\,s^2,\\quad d_B=0.02,\n$$\n对称性允许的非对角耦合矩阵 $\\mathbf{C}(s)$ 定义为\n$$\n\\mathbf{C}(s)_{0,2}=\\mathbf{C}(s)_{2,0}=g_{+}\\,s,\\quad g_{+}=0.12,\\qquad \\mathbf{C}(s)_{1,3}=\\mathbf{C}(s)_{3,1}=g_{-}\\,s,\\quad g_{-}=0.0,\n$$\n$\\mathbf{C}(s)$ 的所有其他条目均为 $0$。该构造强制要求耦合仅在相同的剩余宇称 $p$ 分区内发生，即索引 $\\{0,2\\}$ 对应 $p=+$，索引 $\\{1,3\\}$ 对应 $p=-$，这与群论选择定则一致。\n\n将与给定有序索引对 $(i,j)$ 相关联的二乘二子矩阵束表示为 $\\left(\\mathbf{X}_{ij}(\\omega,s),\\mathbf{R}_{ij}(s)\\right)$，其中 $\\mathbf{X}_{ij}$ 和 $\\mathbf{R}_{ij}$ 分别是 $\\mathbf{X}$ 和 $\\mathbf{R}$ 在索引 $(i,j)$ 上的主子矩阵。限制在该子空间内的特征本征值被定义为下式的两个实根 $\\lambda_1(\\omega,s)\\le \\lambda_2(\\omega,s)$：\n$$\n\\det\\!\\left(\\mathbf{X}_{ij}(\\omega,s)-\\lambda\\,\\mathbf{R}_{ij}(s)\\right)=0.\n$$\n定义对 $(i,j)$ 的频率相关的间隙为\n$$\n\\Delta_{ij}(\\omega,s)=\\left|\\lambda_2(\\omega,s)-\\lambda_1(\\omega,s)\\right|,\n$$\n并定义在闭合频率区间 $[\\omega_{\\min},\\omega_{\\max}]$ 上的最小间隙为\n$$\n\\Delta^{\\star}_{ij}(s;[\\omega_{\\min},\\omega_{\\max}])=\\min_{\\omega\\in[\\omega_{\\min},\\omega_{\\max}]}\\Delta_{ij}(\\omega,s).\n$$\n\n你的任务是：\n- 实现一个程序，该程序如上构建 $\\mathbf{R}(s)$ 和 $\\mathbf{X}(\\omega,s)$，为指定的对 $(i,j)$ 提取二乘二子矩阵束，在每个采样频率处使用数值稳定的方法（约化为标准对称本征值问题）求解广义厄米本征值问题，并通过在区间 $[\\omega_{\\min},\\omega_{\\max}]$ 上进行密集采样来计算 $\\Delta^{\\star}_{ij}$。\n- 使用 $\\mathbf{R}_{ij}(s)$ 的 Cholesky 分解来形成一个标准对称本征值问题，以确保数值稳定性。\n- 在由 $N$ 个均匀间隔采样点组成的频率网格上进行评估，其中 $N$ 在下面的每个测试案例中指定。\n\n测试套件：\n- 案例 1（高对称性边界，存在简并）：$s=0.0$，对 $(i,j)=(0,2)$，$\\omega\\in[2.5,\\,3.9]$，$N=20001$。\n- 案例 2（$p=+$ 分区中的弱对称性破缺，预期出现趋避交叉）：$s=0.05$，对 $(i,j)=(0,2)$，$\\omega\\in[2.5,\\,3.9]$，$N=20001$。\n- 案例 3（$p=-$ 分区中受对称性保护的交叉，根据选择定则无耦合）：$s=0.2$，对 $(i,j)=(1,3)$，$\\omega\\in[2.5,\\,3.9]$，$N=20001$。\n\n要求输出：\n- 对于每个案例，计算最小间隙 $\\Delta^{\\star}_{ij}$，结果为浮点数。\n- 你的程序应生成单行输出，包含一个用方括号括起来的逗号分隔列表（例如，\"[$r_1$,$r_2$,$r_3$]\"），其中每个 $r_k$ 是相应案例的最小间隙，四舍五入到 $6$ 位小数。\n- 本问题无需物理单位；所有量均为无量纲。", "solution": "任务是设计一个数值实验，为一个简化的 $4 \\times 4$ 理想电导体 (PEC) 矩阵束模型计算特征本征值之间的最小频率相关间隙。关注的现象是模式趋避（趋避交叉）与真实模式交叉之间的区别，这由一个对称性破缺参数 $s$ 控制。\n\n问题的核心是广义厄米本征值问题\n$$\n\\mathbf{X}(\\omega,s)\\,\\mathbf{J} \\;=\\; \\lambda(\\omega,s)\\,\\mathbf{R}(s)\\,\\mathbf{J}\n$$\n其中 $\\mathbf{X}(\\omega,s)$ 是实对称电抗算子，$\\mathbf{R}(s)$ 是实对称且正定的辐射算子。两者都以参数化的 $4 \\times 4$ 矩阵形式给出。目标是为特定的 $2 \\times 2$ 子矩阵束计算在某个频率区间内的最小间隙 $\\Delta^{\\star}_{ij}$。\n\n解决方案主要分为四个步骤：模型构建、子问题提取、子问题的解析解和数值计算。\n\n1.  **模型构建**：\n根据问题中的显式参数化构建 $4 \\times 4$ 矩阵 $\\mathbf{R}(s)$ 和 $\\mathbf{X}(\\omega,s)$。\n辐射算子 $\\mathbf{R}(s)$ 是常数对角矩阵：\n$$\n\\mathbf{R}(s)=\\operatorname{diag}\\big(r_A,\\,r_A,\\,r_B,\\,r_B\\big)\n$$\n其中 $r_A=1.0$，$r_B=1.1$。\n\n电抗算子 $\\mathbf{X}(\\omega,s)$ 是一个对角部分和一个非对角耦合部分之和，$\\mathbf{X}(\\omega,s) = \\mathbf{D}(\\omega, s) + \\mathbf{C}(s)$。对角元素由下式给出：\n$$\n\\begin{aligned}\n\\mathbf{D}(\\omega,s)_{0,0} = x_A(\\omega) + \\delta_A(s,+) = (\\omega-2.0) + d_A s^2 \\\\\n\\mathbf{D}(\\omega,s)_{1,1} = x_A(\\omega) + \\delta_A(s,-) = (\\omega-2.0) - d_A s^2 \\\\\n\\mathbf{D}(\\omega,s)_{2,2} = x_B(\\omega) + \\delta_B(s,+) = 0.6(\\omega-1.0) + d_B s^2 \\\\\n\\mathbf{D}(\\omega,s)_{3,3} = x_B(\\omega) + \\delta_B(s,-) = 0.6(\\omega-1.0) - d_B s^2\n\\end{aligned}\n$$\n其中 $d_A=0.03$，$d_B=0.02$。非对角耦合矩阵 $\\mathbf{C}(s)$ 只有两对非零元素，受群论选择定则支配，即耦合只在相同宇称 $p$ 的模式之间发生：\n$$\n\\mathbf{C}(s)_{0,2}=\\mathbf{C}(s)_{2,0}=g_{+}\\,s \\quad (p=+) \\\\\n\\mathbf{C}(s)_{1,3}=\\mathbf{C}(s)_{3,1}=g_{-}\\,s \\quad (p=-)\n$$\n其中 $g_{+}=0.12$，$g_{-}=0.0$。\n\n2.  **子问题提取**：\n对于给定的索引对 $(i,j)$，从完整的 $4 \\times 4$ 矩阵中提取 $2 \\times 2$ 子矩阵 $\\mathbf{X}_{ij}(\\omega,s)$ 和 $\\mathbf{R}_{ij}(s)$。$\\mathbf{R}_{ij}(s)$ 是一个对角矩阵，其条目从 $\\{r_A, r_B\\}$ 中选取。$\\mathbf{X}_{ij}(\\omega,s)$ 包含来自 $\\mathbf{D}(\\omega,s)$ 的相应对角元素和来自 $\\mathbf{C}(s)$ 的单个相关耦合项。\n\n3.  **$2 \\times 2$ 子问题的解析解**：\n分析集中于 $2 \\times 2$ 广义本征值问题：\n$$\n\\det\\!\\left(\\mathbf{X}_{ij}(\\omega,s)-\\lambda\\,\\mathbf{R}_{ij}(s)\\right)=0\n$$\n由于 $\\mathbf{R}_{ij}(s)$ 是对角且正定的，该问题可以转化为标准对称本征值问题。设 $\\mathbf{R}_{ij} = \\mathbf{L}\\mathbf{L}^T$ 是 $\\mathbf{R}_{ij}$ 的 Cholesky 分解。问题等价于求矩阵 $\\mathbf{A} = \\mathbf{L}^{-1}\\mathbf{X}_{ij}(\\mathbf{L}^T)^{-1}$ 的本征值。\n\n对于 $2 \\times 2$ 的情况，一个更直接的方法是解析地求解特征多项式。设子矩阵为\n$$\n\\mathbf{X}_{ij}(\\omega,s) = \\begin{pmatrix} a(\\omega, s) & c(s) \\\\ c(s) & b(\\omega, s) \\end{pmatrix}, \\quad \\mathbf{R}_{ij}(s) = \\begin{pmatrix} r_i & 0 \\\\ 0 & r_j \\end{pmatrix}.\n$$\n特征方程是 $(a - \\lambda r_i)(b - \\lambda r_j) - c^2 = 0$，这是一个关于 $\\lambda$ 的二次方程：\n$$\n(r_i r_j)\\lambda^2 - (a r_j + b r_i)\\lambda + (ab - c^2) = 0.\n$$\n两个根 $\\lambda_1$ 和 $\\lambda_2$ 可以用二次公式求得。间隙 $\\Delta_{ij} = |\\lambda_2 - \\lambda_1|$ 由判别式除以首项系数给出：\n$$\n\\Delta_{ij}(\\omega,s) = \\frac{\\sqrt{(a r_j + b r_i)^2 - 4 r_i r_j (ab - c^2)}}{r_i r_j} = \\frac{\\sqrt{(a r_j - b r_i)^2 + 4 c^2 r_i r_j}}{r_i r_j}.\n$$\n这个间隙的解析表达式允许进行高效的向量化计算。此公式在数学上等同于通过 Cholesky 分解得到的标准对称本征值问题的解。\n\n4.  **数值计算**：\n实现的核心是在密集的频率网格上评估此解析间隙公式。对于由 $s$、$(i,j)$ 和区间 $[\\omega_{\\min}, \\omega_{\\max}]$ 定义的每个测试案例，执行以下算法：\na.  在 $[\\omega_{\\min}, \\omega_{\\max}]$ 上生成一个包含 $N$ 个频率的均匀网格 $\\{\\omega_k\\}$。\nb.  为指定的子矩阵束 $(i,j)$ 确定频率相关的对角项 $a(\\omega_k, s)$ 和 $b(\\omega_k, s)$，以及常数项 $c(s)$、$r_i$ 和 $r_j$。\nc.  使用推导出的解析公式，以向量化的方式（使用 NumPy）为网格中所有的 $\\omega_k$ 计算间隙函数 $\\Delta_{ij}(\\omega_k, s)$。这将生成一个间隙值数组。\nd.  通过取此数组中的最小值来找到最小间隙：\n$$\n\\Delta^{\\star}_{ij}(s;[\\omega_{\\min},\\omega_{\\max}])=\\min_{k} \\Delta_{ij}(\\omega_k,s).\n$$\n对三个测试案例中的每一个重复此过程，并收集结果。当非对角耦合 $c(s)$ 为零时（如案例1和案例3），间隙公式简化为 $\\Delta_{ij}(\\omega, s) = |a(\\omega, s) r_j - b(\\omega, s) r_i| / (r_i r_j)$。如果交叉频率（即 $a(\\omega, s) r_j = b(\\omega, s) r_i$ 的地方）位于采样区间内，最小间隙将为零。如果交叉频率是网格上的一个精确点，计算出的最小值在数值上为零。否则，它是一个由网格分辨率决定的小的非零值。当 $c(s) \\neq 0$ 时（案例2，趋避交叉），间隙永远不为零，其最小值为 $\\frac{2|c(s)|}{\\sqrt{r_i r_j}}$。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the minimal characteristic eigenvalue gap for three test cases\n    of a symmetry-adapted 4x4 matrix pencil model.\n    \"\"\"\n\n    # Define physical and model parameters from the problem statement\n    r_A = 1.0\n    r_B = 1.1\n    d_A = 0.03\n    d_B = 0.02\n    g_plus = 0.12\n    g_minus = 0.0\n\n    # Test suite: (s, (i, j), omega_min, omega_max, N)\n    test_cases = [\n        (0.0, (0, 2), 2.5, 3.9, 20001),\n        (0.05, (0, 2), 2.5, 3.9, 20001),\n        (0.2, (1, 3), 2.5, 3.9, 20001),\n    ]\n\n    results = []\n\n    # Map of indices to basis function properties: (family_type, parity_sign)\n    # family_type 'A' or 'B'. parity_sign +1 or -1.\n    basis_map = {\n        0: ('A', 1),  # Family A, parity +\n        1: ('A', -1), # Family A, parity -\n        2: ('B', 1),  # Family B, parity +\n        3: ('B', -1), # Family B, parity -\n    }\n\n    for s, (i, j), omega_min, omega_max, N in test_cases:\n        # Generate the frequency grid\n        omegas = np.linspace(omega_min, omega_max, N, dtype=np.float64)\n\n        # Get properties for the selected indices i and j\n        family_i, parity_i = basis_map[i]\n        family_j, parity_j = basis_map[j]\n\n        # Determine the diagonal elements of the X_ij submatrix as functions of omega\n        if family_i == 'A':\n            a_omega = omegas - 2.0\n            delta_a = parity_i * d_A * s**2\n        else: # family 'B'\n            a_omega = 0.6 * (omegas - 1.0)\n            delta_a = parity_i * d_B * s**2\n        \n        if family_j == 'A':\n            b_omega = omegas - 2.0\n            delta_b = parity_j * d_A * s**2\n        else: # family 'B'\n            b_omega = 0.6 * (omegas - 1.0)\n            delta_b = parity_j * d_B * s**2\n\n        # a(omega, s) and b(omega, s) are the diagonal elements of X_ij\n        a_vals = a_omega + delta_a\n        b_vals = b_omega + delta_b\n\n        # Determine the off-diagonal element c(s) of X_ij\n        # Coupling is only between indices {0,2} (p=+) or {1,3} (p=-)\n        if {i, j} == {0, 2}:\n            c_val = g_plus * s\n        elif {i, j} == {1, 3}:\n            c_val = g_minus * s\n        else:\n            c_val = 0.0\n\n        # Determine diagonal elements r_i, r_j of the R_ij submatrix\n        r_i = r_A if family_i == 'A' else r_B\n        r_j = r_A if family_j == 'A' else r_B\n\n        # Calculate the eigenvalue gap using the derived analytical formula\n        # Delta = sqrt((a*r_j - b*r_i)^2 + 4*c^2*r_i*r_j) / (r_i*r_j)\n        term1 = (a_vals * r_j - b_vals * r_i)**2\n        term2 = 4.0 * c_val**2 * r_i * r_j\n        \n        gaps = np.sqrt(term1 + term2) / (r_i * r_j)\n\n        # Find the minimum gap over the frequency grid\n        min_gap = np.min(gaps)\n        results.append(min_gap)\n\n    # Format the final output string as required\n    formatted_results = [f\"{r:.6f}\" for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "3292914"}, {"introduction": "特征模式分析不仅是一种分析工具，更是一种强大的设计工具。本实践将带您跨越从理论到工程应用的桥梁，学习如何将一个谐振的特征模式等效为一个简单的串联 $RLC$ 电路。您将通过计算从模式特征值 $\\lambda_n$ 的频率导数中提取等效电路参数，并利用这些参数设计一个标准的 L 型匹配网络，从而将抽象的模式特性转化为具体的工程解决方案 [@problem_id:3292877]。", "problem": "考虑在计算电磁学领域内，基于特征模式分析（CMA）设计一个多端口匹配网络的任务。从第一性原理出发：麦克斯韦方程组、矩量法中阻抗算子的定义以及特征模式的定义。设矩量法阻抗算子可分解为实部和虚部，即 $[\\mathbf{Z}(\\omega)] = [\\mathbf{R}(\\omega)] + j[\\mathbf{X}(\\omega)]$，其中 $[\\mathbf{R}(\\omega)]$ 和 $[\\mathbf{X}(\\omega)]$ 分别是表示耗散和电抗分量的频率相关埃尔米特算子。特征模式 $\\mathbf{J}_n(\\omega)$ 及其无量纲特征值 $\\lambda_n(\\omega)$ 满足广义特征值问题 $[\\mathbf{X}(\\omega)]\\,\\mathbf{J}_n(\\omega) = \\lambda_n(\\omega)\\,[\\mathbf{R}(\\omega)]\\,\\mathbf{J}_n(\\omega)$。模式辐射功率和欧姆损耗被封装在一个等效的模式电阻中。在设计角频率 $\\omega_0$ 附近，假设存在小信号行为，其中第 $n$ 个模式局部谐振，因此 $\\lambda_n(\\omega_0) = 0$。在标准CMA归一化下，第 $n$ 个模式所见的模式阻抗可以建模为一个等效串联 $RLC$ 电路，$Z_n(\\omega) = R_n + jX_n(\\omega)$，其中 $R_n$ 汇总了 $\\omega_0$ 处的辐射和耗散损耗。\n\n您的任务是：\n- 根据广义特征值问题以及储能、辐射功率和耗散损耗的定义，推导出一个在 $\\omega_0$ 附近将每个特征模式映射到等效串联 $RLC$ 电路的映射关系。\n- 利用在 $\\omega_0$ 处模式电抗相对于角频率的斜率，推断出每个模式的等效电感和电容。\n- 为选定的模式子集，设计一个最小双元件L节匹配网络，在 $\\omega_0$ 处将其等效串联电阻与一个实数源阻抗进行匹配。L节包含一个串联电抗和一个并联电抗；根据负载电阻是大于还是小于源电阻来选择拓扑结构，并将电抗元件表示为在 $\\omega_0$ 处计算的物理电感或电容。\n\n所有涉及物理单位的答案必须用指定的单位表示：\n- 角频率单位为弧度/秒。\n- 电阻单位为欧姆。\n- 电感单位为亨利。\n- 电容单位为法拉。\n\n除角频率外，不涉及其他角度；除 $\\omega$ 使用弧度外，无需指定其他角度单位。\n\n为使此任务精确且可测试，请使用以下模式和参数的测试套件。您必须将所有频率值视为精确值，并通过中心差分公式对 $\\lambda_n(\\omega)$ 进行数值微分。设设计频率为 $f_0 = 1.0 \\times 10^9$ 赫兹，$\\omega_0 = 2\\pi f_0$。使用频率样本 $f_- = 0.95 \\times 10^9$ 赫兹，$f_0 = 1.0 \\times 10^9$ 赫兹，以及 $f_+ = 1.05 \\times 10^9$ 赫兹，对应的角频率为 $\\omega_- = 2\\pi f_-$，$\\omega_0 = 2\\pi f_0$，和 $\\omega_+ = 2\\pi f_+$。对于每个模式，给定 $\\lambda_n(\\omega_-)$、$\\lambda_n(\\omega_0)$ 和 $\\lambda_n(\\omega_+)$，以及在 $\\omega_0$ 处的模式辐射电阻和欧姆损耗电阻。源阻抗为纯实数，$Z_0 = 50$ 欧姆。\n\n测试套件：\n- 模式 $0$：$\\lambda_0(\\omega_-) = -0.6283185307179586$，$\\lambda_0(\\omega_0) = 0.0$，$\\lambda_0(\\omega_+) = 0.6283185307179586$；$R_{\\text{rad},0} = 20$ 欧姆；$R_{\\text{loss},0} = 5$ 欧姆。\n- 模式 $1$：$\\lambda_1(\\omega_-) = -0.25132741228718347$，$\\lambda_1(\\omega_0) = 0.0$，$\\lambda_1(\\omega_+) = 0.25132741228718347$；$R_{\\text{rad},1} = 60$ 欧姆；$R_{\\text{loss},1} = 10$ 欧姆。\n- 模式 $2$：$\\lambda_2(\\omega_-) = -0.34557519189487723$，$\\lambda_2(\\omega_0) = 0.0$，$\\lambda_2(\\omega_+) = 0.34557519189487723$；$R_{\\text{rad},2} = 40$ 欧姆；$R_{\\text{loss},2} = 0$ 欧姆。\n- 模式 $3$：$\\lambda_3(\\omega_-) = -0.3141592653589793$，$\\lambda_3(\\omega_0) = 0.0$，$\\lambda_3(\\omega_+) = 0.3141592653589793$；$R_{\\text{rad},3} = 50$ 欧姆；$R_{\\text{loss},3} = 0$ 欧姆。\n\n选择要匹配的模式子集：模式 $0$、$2$ 和 $3$。\n\n算法要求：\n1. 对于每个模式 $n$，计算在 $\\omega_0$ 处的总等效电阻 $R_n = R_{\\text{rad},n} + R_{\\text{loss},n}$。\n2. 使用中心差分公式 $\\frac{\\lambda_n(\\omega_+) - \\lambda_n(\\omega_-)}{\\omega_+ - \\omega_-}$ 来近似导数 $\\frac{d\\lambda_n}{d\\omega}\\big\\rvert_{\\omega_0}$。\n3. 使用您从第一性原理推导出的映射关系，计算 $\\frac{dX_n}{d\\omega}\\big\\rvert_{\\omega_0}$ 并推断出在 $\\omega_0$ 附近模拟模式 $n$ 的串联 $RLC$ 电路的等效电感 $L_n$ 和电容 $C_n$。\n4. 对于每个选定的模式，设计一个L节匹配网络，在 $\\omega_0$ 处将 $R_n$ 与 $Z_0$ 匹配。使用一个双元件L网络：一个串联电抗 $X_{\\text{series}}$ 和一个并联电抗 $X_{\\text{shunt}}$；根据 $R_n > Z_0$ 还是 $R_n < Z_0$ 选择合适的拓扑。然后使用 $X = \\omega_0 L$（对于电感）和 $X = -\\frac{1}{\\omega_0 C}$（对于电容）将 $X_{\\text{series}}$ 和 $X_{\\text{shunt}}$ 转换为在 $\\omega_0$ 处的物理元件。报告所选元件的物理电感或电容值，并将未使用的元件值设为 $0$。\n5. 边缘情况：如果 $R_n = Z_0$，则将所有匹配元件设为 $0$。\n\n最终输出格式：\n- 您的程序应生成一行输出，其中包含一个用方括号括起来的逗号分隔列表。每个选定模式的结果必须是一个包含七个浮点数的列表，顺序为 $[R_n, L_n, C_n, L_{\\text{series}}, C_{\\text{series}}, L_{\\text{shunt}}, C_{\\text{shunt}}]$，其中电阻单位为欧姆，电感单位为亨利，电容单位为法拉。例如：$[[\\cdots],[\\cdots],[\\cdots]]$。", "solution": "推导从计算电磁学的第一性原理开始。麦克斯韦方程组控制电磁场，而矩量法（MoM）对辐射结构的边界积分方程进行离散化。得到的阻抗算子为 $[\\mathbf{Z}(\\omega)] = [\\mathbf{R}(\\omega)] + j[\\mathbf{X}(\\omega)]$，其中 $[\\mathbf{R}(\\omega)]$ 与辐射和耗散功率相关，$[\\mathbf{X}(\\omega)]$ 与储存的无功功率相关。特征模式分析（CMA）通过广义埃尔米特特征问题定义\n$$\n[\\mathbf{X}(\\omega)]\\,\\mathbf{J}_n(\\omega) = \\lambda_n(\\omega)\\,[\\mathbf{R}(\\omega)]\\,\\mathbf{J}_n(\\omega),\n$$\n其中 $\\mathbf{J}_n(\\omega)$ 是第 $n$ 个模式表面电流，$\\lambda_n(\\omega)$ 是对应的实特征值。\n\n$\\lambda_n(\\omega)$ 的解释源于双线性形式：如果采用标准的CMA归一化，其中模式辐射功率与 $\\mathbf{J}_n^\\mathsf{T}[\\mathbf{R}]\\mathbf{J}_n$ 成正比，模式无功功率与 $\\mathbf{J}_n^\\mathsf{T}[\\mathbf{X}]\\mathbf{J}_n$ 成正比，那么特征值 $\\lambda_n(\\omega)$ 量化了第 $n$ 个模式的电抗效应与电阻效应之比。在设计角频率 $\\omega_0$ 附近，且 $\\lambda_n(\\omega_0) = 0$ 时，第 $n$ 个模式处于谐振状态。我们考虑一个等效串联电路模型 $Z_n(\\omega) = R_n + jX_n(\\omega)$，其中 $R_n$ 汇总了在 $\\omega_0$ 处的模式辐射和欧姆损耗，而 $X_n(\\omega)$ 代表模式电抗。\n\n从特征问题和归一化中，可以得到模式电抗和电阻之间的标量关系，\n$$\nX_n(\\omega) \\propto \\lambda_n(\\omega)\\,R_n(\\omega),\n$$\n并且通过对模式电流进行适当的归一化，比例常数在模式意义上为1，从而得到\n$$\nX_n(\\omega) = \\lambda_n(\\omega)\\,R_n(\\omega).\n$$\n这个映射关系体现了CMA的基本解释，即特征值对每个模式的无功功率与有功功率进行缩放。对角频率求导并在谐振点 $\\omega_0$ 处取值（此时 $\\lambda_n(\\omega_0) = 0$），我们得到\n$$\n\\left.\\frac{dX_n}{d\\omega}\\right\\rvert_{\\omega_0}\n= R_n(\\omega_0)\\left.\\frac{d\\lambda_n}{d\\omega}\\right\\rvert_{\\omega_0} + \\lambda_n(\\omega_0)\\left.\\frac{dR_n}{d\\omega}\\right\\rvert_{\\omega_0}\n= R_n(\\omega_0)\\left.\\frac{d\\lambda_n}{d\\omega}\\right\\rvert_{\\omega_0}.\n$$\n因此，在谐振时模式电抗的斜率由 $\\omega_0$ 处的模式电阻乘以 $\\omega_0$ 处的特征值斜率给出。\n\n接下来，我们将 $X_n(\\omega)$ 与一个等效串联 $RLC$ 电路联系起来。串联 $RLC$ 电路的电抗是\n$$\nX_{\\text{series}}(\\omega) = \\omega L - \\frac{1}{\\omega C}.\n$$\n在谐振时，电抗为零：$X_{\\text{series}}(\\omega_0) = 0$ 意味着 $\\omega_0 L = \\frac{1}{\\omega_0 C}$，因此 $\\omega_0^2 L C = 1$。对 $X_{\\text{series}}(\\omega)$ 对 $\\omega$ 求导得到\n$$\n\\frac{dX_{\\text{series}}}{d\\omega} = L + \\frac{1}{\\omega^2 C},\n$$\n并在 $\\omega_0$ 处使用 $\\omega_0^2 L C = 1$ 进行计算，得到\n$$\n\\left.\\frac{dX_{\\text{series}}}{d\\omega}\\right\\rvert_{\\omega_0} = L + \\frac{1}{\\omega_0^2 C} = L + L = 2L.\n$$\n将此斜率与从CMA推导出的模式斜率相等，即可得到等效电感：\n$$\nL_n = \\frac{1}{2}\\,R_n(\\omega_0)\\left.\\frac{d\\lambda_n}{d\\omega}\\right\\rvert_{\\omega_0}.\n$$\n一旦 $L_n$ 已知，等效电容可从谐振条件得出：\n$$\nC_n = \\frac{1}{\\omega_0^2 L_n}.\n$$\n这些表达式仅使用CMA派生的量和设计频率，就将每个模式映射到 $\\omega_0$ 附近的一个等效串联 $RLC$ 电路。\n\n现在我们设计一个最小双元件L节来将 $R_n$ 与一个实数源阻抗 $Z_0$ 在 $\\omega_0$ 处进行匹配。一个L节由一个串联电抗 $X_{\\text{series}}$ 和一个并联电抗 $X_{\\text{shunt}}$ 组成。拓扑的选择取决于 $R_n$ 是大于还是小于 $Z_0$。利用标准网络分析，我们通过强制在源端口看到的变换后负载为纯实数且等于 $Z_0$ 来推导所需的电抗。\n\n令负载电阻 $R_L = R_n$，源电阻 $R_S = Z_0$。对于一个串联电抗后跟一个在负载侧接地的并联电抗的L节，所需的品质因数 $Q$ 和电抗为：\n- 情况 $R_L > R_S$（低通L型匹配）：\n$$\nQ = \\sqrt{\\frac{R_L}{R_S} - 1},\\quad X_{\\text{series}} = Q R_S,\\quad X_{\\text{shunt}} = \\frac{R_L}{Q}.\n$$\n- 情况 $R_L < R_S$（高通L型匹配）：\n$$\nQ = \\sqrt{\\frac{R_S}{R_L} - 1},\\quad X_{\\text{series}} = Q R_L,\\quad X_{\\text{shunt}} = \\frac{R_S}{Q}.\n$$\n这些结果是通过求解级联串并联网络的输入阻抗，并使其真实部分等于 $R_S$，同时虚部为零而得到的。电抗的符号决定了元件在给定频率区域是感性还是容性。在 $\\omega_0$ 处，一个常规的可实现性选择是：\n- 如果 $R_L > R_S$：选择一个串联电感和一个并联电容，即 $L_{\\text{series}} = \\frac{X_{\\text{series}}}{\\omega_0}$ 和 $C_{\\text{shunt}} = \\frac{1}{\\omega_0 X_{\\text{shunt}}}$，其中 $C_{\\text{series}} = 0$ 和 $L_{\\text{shunt}} = 0$。\n- 如果 $R_L < R_S$：选择一个串联电容和一个并联电感，即 $C_{\\text{series}} = \\frac{1}{\\omega_0 X_{\\text{series}}}$ 和 $L_{\\text{shunt}} = \\frac{X_{\\text{shunt}}}{\\omega_0}$，其中 $L_{\\text{series}} = 0$ 和 $C_{\\text{shunt}} = 0$。\n- 边缘情况 $R_L = R_S$：无需匹配，所有匹配元件都设为零。\n\n我们现在将该算法应用于测试套件。数值输入：\n- $f_0 = 1.0 \\times 10^9$ 赫兹，因此 $\\omega_0 = 2\\pi f_0 = 2\\pi \\times 10^9$ 弧度/秒。\n- $f_- = 0.95 \\times 10^9$ 赫兹和 $f_+ = 1.05 \\times 10^9$ 赫兹，得到 $\\omega_- = 2\\pi f_-$ = $2\\pi \\times 0.95\\times 10^9$ 弧度/秒和 $\\omega_+ = 2\\pi f_+$ = $2\\pi \\times 1.05\\times 10^9$ 弧度/秒。\n- 角频率的中心差分步长为 $\\Delta\\omega = \\omega_+ - \\omega_- = 2\\pi(f_+ - f_-) = 2\\pi \\times 0.10\\times 10^9$ 弧度/秒。\n\n对于每个模式 $n$：\n1. 计算 $R_n = R_{\\text{rad},n} + R_{\\text{loss},n}$。\n2. 计算 $\\left.\\frac{d\\lambda_n}{d\\omega}\\right\\rvert_{\\omega_0} \\approx \\frac{\\lambda_n(\\omega_+) - \\lambda_n(\\omega_-)}{\\omega_+ - \\omega_-}$。\n3. 计算 $L_n = \\frac{1}{2} R_n \\left.\\frac{d\\lambda_n}{d\\omega}\\right\\rvert_{\\omega_0}$。\n4. 计算 $C_n = \\frac{1}{\\omega_0^2 L_n}$。\n5. 给定 $R_S = Z_0 = 50$ 欧姆和 $R_L = R_n$，使用适当的情况设计L型匹配电抗，并在 $\\omega_0$ 处转换为 $L$ 或 $C$。\n\n这样，对于每个选定的模式，可以得到七个所要求的量 $[R_n, L_n, C_n, L_{\\text{series}}, C_{\\text{series}}, L_{\\text{shunt}}, C_{\\text{shunt}}]$，并使用指定的单位。最终程序使用提供的数值精确执行这些步骤，并以要求的单行格式打印汇总结果。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    # Design frequency and angular frequencies\n    f0 = 1.0e9  # Hz\n    f_minus = 0.95e9  # Hz\n    f_plus = 1.05e9  # Hz\n    w0 = 2.0 * np.pi * f0\n    w_minus = 2.0 * np.pi * f_minus\n    w_plus = 2.0 * np.pi * f_plus\n    dw = w_plus - w_minus\n\n    # Source impedance (ohms)\n    Z0 = 50.0\n\n    # Test suite: modes with lambda values at w_minus, w0, w_plus and resistances at w0\n    # Each entry: (lambda_minus, lambda_0, lambda_plus, R_rad, R_loss)\n    modes = [\n        # Mode 0\n        (-0.6283185307179586, 0.0, 0.6283185307179586, 20.0, 5.0),\n        # Mode 1\n        (-0.25132741228718347, 0.0, 0.25132741228718347, 60.0, 10.0),\n        # Mode 2\n        (-0.34557519189487723, 0.0, 0.34557519189487723, 40.0, 0.0),\n        # Mode 3\n        (-0.3141592653589793, 0.0, 0.3141592653589793, 50.0, 0.0),\n    ]\n\n    # Chosen mode subset indices to be matched\n    subset_indices = [0, 2, 3]\n\n    results = []\n\n    for idx in subset_indices:\n        lam_minus, lam_0, lam_plus, R_rad, R_loss = modes[idx]\n\n        # Total resistance at w0\n        R = R_rad + R_loss\n\n        # Central difference derivative d lambda / d omega at w0\n        dlam_domega = (lam_plus - lam_minus) / dw\n\n        # Equivalent series RLC parameters near w0\n        L_eq = 0.5 * R * dlam_domega\n        # Avoid division by zero (if L_eq == 0, set C_eq to 0)\n        if L_eq > 0.0:\n            C_eq = 1.0 / (w0**2 * L_eq)\n        else:\n            # Physically, L_eq should be positive; handle pathological numerical case\n            L_eq = 0.0\n            C_eq = 0.0\n\n        # L-section matching from R to Z0 at w0\n        RL = R\n        RS = Z0\n\n        L_series = 0.0\n        C_series = 0.0\n        L_shunt = 0.0\n        C_shunt = 0.0\n\n        # Edge case: already matched\n        if np.isclose(RL, RS):\n            # No matching elements required\n            pass\n        else:\n            if RL > RS:\n                # Low-pass L-match: series inductor, shunt capacitor\n                Q = np.sqrt(RL / RS - 1.0)\n                X_series = Q * RS\n                X_shunt = RL / Q\n                L_series = X_series / w0\n                C_shunt = 1.0 / (w0 * X_shunt)\n            else: # R_L  R_S\n                # High-pass L-match: series capacitor, shunt inductor\n                Q = np.sqrt(RS / RL - 1.0)\n                X_series = Q * RL\n                X_shunt = RS / Q\n                C_series = 1.0 / (w0 * X_series)\n                L_shunt = X_shunt / w0\n\n        # Append results for this mode:\n        # [R_n (ohm), L_n (H), C_n (F), L_series (H), C_series (F), L_shunt (H), C_shunt (F)]\n        results.append([R, L_eq, C_eq, L_series, C_series, L_shunt, C_shunt])\n\n    # Final print statement in the exact required format.\n    # Single line: list of lists with floats\n    print(f\"[{','.join(['[' + ','.join(map(str, r)) + ']' for r in results])}]\")\n\nsolve()\n```", "id": "3292877"}]}