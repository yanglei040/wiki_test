{"hands_on_practices": [{"introduction": "我们的动手实践始于镜像理论最基础的应用：一个点电荷位于平面介质分界面附近。这个练习 [@problem_id:3316430] 将引导你通过严格应用静电边界条件来推导镜像电荷的大小。通过检验其极限情况，你将看到介质的一般解如何巧妙地简化为我们所熟悉的完美电导体和完美磁导体的情形，从而巩固你对背后物理原理的理解。", "problem": "考虑一个位于 $z=0$ 的平面界面，该界面分隔了两种均匀、各向同性、非磁性的介质，其电容率分别为 $\\epsilon_{1}$（对于 $z>0$）和 $\\epsilon_{2}$（对于 $z0$）。一个点电荷 $q$ 位于上层介质 $z>0$ 中的 $(0,0,d)$ 处，其中 $d>0$。在上层区域，寻求一个静电势的表示，该表示由位于 $(0,0,d)$ 的实际电荷的电势与位于 $(0,0,-d)$ 的单个未知镜像电荷 $q'$ 的电势叠加而成。在下层区域，假设一个静电势表示，该表示仅由位于 $(0,0,d)$ 的强度未知的有效等效源产生，并且在 $z0$ 区域没有奇点。\n\n使用专用于静电学的麦克斯韦方程组、本构关系 $\\mathbf{D}=\\epsilon \\mathbf{E}$ 以及无电荷平面界面上的电磁边界条件，确定镜像电荷比 $q'/q$（用 $\\epsilon_{1}$ 和 $\\epsilon_{2}$ 表示），而不引用任何已知的镜像理论公式。然后，分析极限情况 $\\epsilon_{2}\\to\\infty$ 和 $\\epsilon_{2}\\to 0$，以分别恢复理想电导体 (PEC) 和理想磁导体 (PMC) 的镜像极限。\n\n将您的最终答案表示为一个行矩阵，其中包含 $q'/q$ 的两个极限值，顺序为 $\\left(\\lim_{\\epsilon_{2}\\to\\infty} q'/q,\\ \\lim_{\\epsilon_{2}\\to 0} q'/q\\right)$。无需四舍五入。最终答案是无量纲的。", "solution": "问题陈述已经过严格验证，被认为是有效的。这是一个科学上成立、适定、客观且自洽的问题，根植于静电学的基本原理。其前提与已建立的物理定律一致，并且问题结构可以导出一个唯一、有意义、没有歧义或矛盾的解。\n\n我们首先根据问题的规定，建立两个区域中的静电势。设位置矢量为 $\\mathbf{r}$。由于问题的方位对称性，我们将使用柱坐标 $(\\rho, \\phi, z)$，其中 $\\rho = \\sqrt{x^2 + y^2}$。\n\n一个点电荷 $q$ 位于区域 1 ($z>0$) 中的 $(0,0,d)$ 处，该区域的电容率为 $\\epsilon_1$。两种介质之间的界面是平面 $z=0$。区域 2 ($z0$) 的电容率为 $\\epsilon_2$。\n\n区域 1 ($z>0$) 中的电势 $V_1$ 由位于 $(0,0,d)$ 的原始电荷 $q$ 和位于 $(0,0,-d)$ 的镜像电荷 $q'$ 的电势叠加构成。从观测点 $(\\rho, \\phi, z)$ 到电荷 $q$ 的距离是 $R_1 = \\sqrt{\\rho^2 + (z-d)^2}$。到镜像电荷 $q'$ 的距离是 $R_2 = \\sqrt{\\rho^2 + (z+d)^2}$。因此，在电容率为 $\\epsilon_1$ 的介质区域 1 中的电势为：\n$$V_1(\\rho, z) = \\frac{1}{4\\pi\\epsilon_1} \\left( \\frac{q}{R_1} + \\frac{q'}{R_2} \\right) = \\frac{1}{4\\pi\\epsilon_1} \\left( \\frac{q}{\\sqrt{\\rho^2 + (z-d)^2}} + \\frac{q'}{\\sqrt{\\rho^2 + (z+d)^2}} \\right)$$\n\n区域 2 ($z0$) 中的电势 $V_2$ 被构建为仿佛它源自于位于原始电荷位置 $(0,0,d)$ 的单个有效电荷 $q''$。问题表述要求这种电势表示在 $z=0$ 处满足边界条件，同时在 $z0$ 区域内非奇异。建立此电势的标准且最直接的方法是将其表示为一种便于匹配边界条件的形式。我们将 $V_2$ 写成与 $V_1$ 具有相同归一化常数的形式，以简化电势连续性条件：\n$$V_2(\\rho, z) = \\frac{1}{4\\pi\\epsilon_1} \\frac{q''}{R_1} = \\frac{1}{4\\pi\\epsilon_1} \\frac{q''}{\\sqrt{\\rho^2 + (z-d)^2}}$$\n这种形式正确地将从区域 2 看到的场源置于 $(0,0,d)$ 处，并确保由于 $d>0$，区域 2 ($z0$) 内没有源（奇点）。\n\n未知电荷 $q'$ 和 $q''$ 通过在无电荷界面 $z=0$ 处应用静电场边界条件来确定：\n1.  电场 $\\mathbf{E}$ 的切向分量连续，这意味着静电势 $V$ 连续：$V_1(\\rho, z=0) = V_2(\\rho, z=0)$。\n2.  电位移场 $\\mathbf{D}$ 的法向分量连续：$\\mathbf{\\hat{n}} \\cdot (\\mathbf{D}_1 - \\mathbf{D}_2) = 0$。在界面 $z=0$ 处，法向量 $\\mathbf{\\hat{n}}$ 是 $\\mathbf{\\hat{z}}$。使用本构关系 $\\mathbf{D} = \\epsilon \\mathbf{E}$ 和 $\\mathbf{E} = -\\nabla V$，此条件变为在 $z=0$ 处 $\\epsilon_1 E_{1z} = \\epsilon_2 E_{2z}$，或明确地写为：\n    $$\\epsilon_1 \\left(-\\frac{\\partial V_1}{\\partial z}\\right)\\bigg|_{z=0} = \\epsilon_2 \\left(-\\frac{\\partial V_2}{\\partial z}\\right)\\bigg|_{z=0}$$\n\n让我们应用第一个边界条件，$V_1 = V_2$ 于 $z=0$。\n在 $z=0$ 处，$R_1 = R_2 = \\sqrt{\\rho^2 + d^2}$。\n$$V_1(\\rho, 0) = \\frac{1}{4\\pi\\epsilon_1} \\left( \\frac{q}{\\sqrt{\\rho^2 + d^2}} + \\frac{q'}{\\sqrt{\\rho^2 + d^2}} \\right) = \\frac{q+q'}{4\\pi\\epsilon_1\\sqrt{\\rho^2 + d^2}}$$\n$$V_2(\\rho, 0) = \\frac{1}{4\\pi\\epsilon_1} \\frac{q''}{\\sqrt{\\rho^2 + d^2}}$$\n对所有 $\\rho$ 令二者相等，我们得到电荷之间的第一个关系：\n$$q+q' = q''$$\n\n现在，我们应用第二个边界条件。我们首先需要电势对 $z$ 的导数。\n$$\\frac{\\partial V_1}{\\partial z} = \\frac{1}{4\\pi\\epsilon_1} \\left[ q \\left( -\\frac{z-d}{(\\rho^2 + (z-d)^2)^{3/2}} \\right) + q' \\left( -\\frac{z+d}{(\\rho^2 + (z+d)^2)^{3/2}} \\right) \\right]$$\n在 $z=0$ 处求值：\n$$\\frac{\\partial V_1}{\\partial z}\\bigg|_{z=0} = \\frac{1}{4\\pi\\epsilon_1} \\left[ \\frac{qd}{(\\rho^2 + d^2)^{3/2}} - \\frac{q'd}{(\\rho^2 + d^2)^{3/2}} \\right] = \\frac{d(q-q')}{4\\pi\\epsilon_1(\\rho^2 + d^2)^{3/2}}$$\n\n对于区域 2 中的电势：\n$$\\frac{\\partial V_2}{\\partial z} = \\frac{1}{4\\pi\\epsilon_1} \\left[ q'' \\left( -\\frac{z-d}{(\\rho^2 + (z-d)^2)^{3/2}} \\right) \\right]$$\n在 $z=0$ 处求值：\n$$\\frac{\\partial V_2}{\\partial z}\\bigg|_{z=0} = \\frac{1}{4\\pi\\epsilon_1} \\left[ \\frac{q''d}{(\\rho^2 + d^2)^{3/2}} \\right] = \\frac{dq''}{4\\pi\\epsilon_1(\\rho^2 + d^2)^{3/2}}$$\n\n将这些代入第二个边界条件，$\\epsilon_1 \\left(-\\frac{\\partial V_1}{\\partial z}\\right)|_{z=0} = \\epsilon_2 \\left(-\\frac{\\partial V_2}{\\partial z}\\right)|_{z=0}$：\n$$\\epsilon_1 \\left( \\frac{d(q-q')}{4\\pi\\epsilon_1(\\rho^2 + d^2)^{3/2}} \\right) = \\epsilon_2 \\left( \\frac{dq''}{4\\pi\\epsilon_1(\\rho^2 + d^2)^{3/2}} \\right)$$\n公共因子消去，得到我们的第二个关系：\n$$q-q' = \\frac{\\epsilon_2}{\\epsilon_1} q''$$\n\n我们现在有一个关于 $q'$ 和 $q''$ 的二元线性方程组：\n$$(1) \\quad q+q' = q''$$\n$$(2) \\quad q-q' = \\frac{\\epsilon_2}{\\epsilon_1} q''$$\n将 $(1)$ 代入 $(2)$ 以消去 $q''$：\n$$q-q' = \\frac{\\epsilon_2}{\\epsilon_1} (q+q')$$\n我们需要求出比率 $q'/q$。两边乘以 $\\epsilon_1$ 以消去分母：\n$$\\epsilon_1(q-q') = \\epsilon_2(q+q')$$\n$$\\epsilon_1 q - \\epsilon_1 q' = \\epsilon_2 q + \\epsilon_2 q'$$\n重新排列以组合含 $q$ 和 $q'$ 的项：\n$$\\epsilon_1 q - \\epsilon_2 q = \\epsilon_1 q' + \\epsilon_2 q'$$\n$$q(\\epsilon_1 - \\epsilon_2) = q'(\\epsilon_1 + \\epsilon_2)$$\n求解比率 $q'/q$：\n$$\\frac{q'}{q} = \\frac{\\epsilon_1 - \\epsilon_2}{\\epsilon_1 + \\epsilon_2}$$\n\n接下来，我们分析两个指定的极限情况。\n\n情况 1：理想电导体 (PEC) 极限，$\\epsilon_2 \\to \\infty$。\n理想电导体是一种具有无限电导率的材料，在静电学中，其行为如同具有无限电容率的介质。这个边界条件迫使其表面上的切向电场为零，因此电势也为零（假设其接地，这是电势的隐含参考点）。\n$$\\lim_{\\epsilon_2 \\to \\infty} \\frac{q'}{q} = \\lim_{\\epsilon_2 \\to \\infty} \\frac{\\epsilon_1 - \\epsilon_2}{\\epsilon_1 + \\epsilon_2}$$\n为了计算该极限，我们将分子和分母同除以 $\\epsilon_2$：\n$$\\lim_{\\epsilon_2 \\to \\infty} \\frac{\\frac{\\epsilon_1}{\\epsilon_2} - 1}{\\frac{\\epsilon_1}{\\epsilon_2} + 1} = \\frac{0-1}{0+1} = -1$$\n在此极限下，$q' = -q$，这是导体平面相对的镜像电荷的著名结果。\n\n情况 2：理想磁导体 (PMC) 极限，$\\epsilon_2 \\to 0$。\n理想磁导体是理想电导体的理论对偶。在静电学中，取极限 $\\epsilon_2 \\to 0$ 对应于表面上电场法向分量为零的边界条件。\n$$\\lim_{\\epsilon_2 \\to 0} \\frac{q'}{q} = \\lim_{\\epsilon_2 \\to 0} \\frac{\\epsilon_1 - \\epsilon_2}{\\epsilon_1 + \\epsilon_2}$$\n将 $\\epsilon_2 = 0$ 直接代入表达式中：\n$$\\frac{\\epsilon_1 - 0}{\\epsilon_1 + 0} = \\frac{\\epsilon_1}{\\epsilon_1} = 1$$\n在此极限下，$q' = q$，这是理想磁导体表面相对的镜像电荷的已知结果。\n\n最终答案要求一个行矩阵，按指定顺序包含这两个极限值。\n第一个值是理想电导体极限的结果，$-1$。\n第二个值是理想磁导体极限的结果，$1$。\n因此，行矩阵是 $(-1, 1)$。", "answer": "$$\n\\boxed{\\begin{pmatrix} -1  1 \\end{pmatrix}}\n$$", "id": "3316430"}, {"introduction": "掌握了平面问题后，我们现在进入一个更具挑战性的曲面几何问题：一个点电荷位于接地的导电球体附近。这个问题 [@problem_id:3316422] 是一个经典的例子，展示了镜像法的强大威力，但它更进一步，要求你计算球体表面上感应出的物理电荷分布。通过对这个表面电荷密度进行积分，你将直接验证总感应电荷等于镜像电荷，从而在数学构造与物理现实之间建立起具体的联系。", "problem": "一个大小为 $q$ 的点电荷位于 $z$ 轴上的 $z=r_{0}$ 处（其中 $r_{0}>a$），在一个半径为 $a$、以原点为中心的接地完美导电（PEC）球体之外。接地连接将导体在球面 $r=a$ 上的电势固定为 $V=0$，并且电势在空间无穷远处消失。仅使用库仑定律、完美导电体的静电边界条件以及静电学唯一性定理，按以下步骤进行：\n\n- 论证用适当的镜像电荷配置替换导电球体的合理性，并确定单个镜像电荷的大小 $q'$ 和位置 $r'$（沿 $z$ 轴从中心测量），该镜像电荷能在所有极角 $\\theta$ 下使 $r=a$ 处的电势 $V=0$。\n- 根据得到的外部电势，通过完美导电体上的法向电场边界条件推导出球体上的感应表面电荷密度 $\\sigma(\\theta)$，然后将 $\\sigma(\\theta)$ 在整个球面上积分以获得总感应电荷 $Q_{\\mathrm{ind}}$。\n- 您的结果必须证明 $Q_{\\mathrm{ind}}$ 不等于 $-q$，并且必须用 $q$、$a$ 和 $r_{0}$ 以闭合形式表示。基于第一性原理，简要解释为什么接地会导致这个值而不是 $-q$。\n\n将最终的总感应电荷 $Q_{\\mathrm{ind}}$ 表示为包含 $q$、$a$ 和 $r_0$ 的符号表达式（如果进行数值计算，单位为库仑）。无需四舍五入。", "solution": "该问题是有效的，因为它是静电学中一个标准的、适定的问题，基于基本原理（库仑定律、导体性质、唯一性定理），并使用清晰、客观的语言。所有必要的信息都已提供，其设置在物理上和数学上都是一致的。\n\n该问题要求计算接地导电球体上的总感应电荷。我们将使用镜像法来解决这个问题。静电学唯一性定理指出，对于一个由指定电势的表面所包围的体积，内部只有一个满足拉普拉斯方程（$\\nabla^2 V = 0$）和给定边界条件的电势函数。\n\n在本例中，该体积是球体外部的区域（$r>a$）。除了在 $z=r_0$ 处的点电荷 $q$ 外，该区域的电荷密度为零。因此，我们必须在 $r>a$ 的区域求解泊松方程 $\\nabla^2 V = -\\delta(\\mathbf{r} - r_0\\mathbf{\\hat{z}})/\\epsilon_0$，并满足边界条件 $V(r=a) = 0$ 和 $V(r\\to\\infty) = 0$。\n\n镜像法将球体上感应电荷的复杂问题替换为一个更简单的等效问题。我们移除球体，并在原球体占据的区域内部（r", "answer": "$$ \\boxed{-q \\frac{a}{r_0}} $$", "id": "3316422"}, {"introduction": "我们最后的实践将从静电学转向计算波工程的动态世界，展示镜像理论在现代工程中的实际应用。在这个高级问题 [@problem_id:3316445] 中，你将通过策略性地放置一个复数值的“镜像”来抵消来自截断仿真区域的反射，从而实现一个吸收边界条件。这个练习将静态的镜像概念与动态的波现象及完美匹配层（PML）联系起来，为解决天线和散射分析中至关重要的开放区域问题提供了宝贵的实践经验。", "problem": "您需要使用平面波镜像抵消法，为一个由有限厚度完美匹配层截断的均匀半空间，实现并分析一个镜像理论吸收边界。考虑角频率为 $\\omega$、隐去时间因子 $\\exp(j \\omega t)$ 的二维时谐场。使用以下基本理论：频域中的麦克斯韦方程组、平面界面上切向场的边界条件、均匀介质中的平面波分解，以及完美匹配层（PML）的复坐标伸缩公式。该吸收边界的实现方式是，放置一个镜像源，其复振幅的选择旨在抵消由截断产生的反射。您必须通过平面波在斜入射时所见的有效反射系数，推导出镜像振幅与PML参数之间的关系。\n\n假设背景介质为均匀、各向同性，其介电常数为 $\\varepsilon_0$，磁导率为 $\\mu_0$。设PML占据区域 $x \\in [0,L]$，并在 $x=L$ 处由一个理想电导体（PEC）作为背衬。PML通过在 $x$ 方向上标准的复坐标伸缩进行建模，其形式为\n$$\ns_x(x) = \\kappa + \\frac{\\sigma(x)}{j \\,\\omega\\, \\varepsilon_0} + j \\,\\frac{\\alpha}{\\omega},\n$$\n其中 $\\kappa \\ge 1$ 是无量纲的，$\\sigma(x)$ 是单位为 $\\mathrm{S/m}$ 的电导率分布，$\\alpha \\ge 0$ 的单位为 $\\mathrm{s^{-1}}$，$\\omega = 2 \\pi f$，其中频率 $f$ 的单位为 $\\mathrm{Hz}$。使用 $m \\in \\mathbb{N}$ 阶的多项式电导率分布 $\\sigma(x) = \\sigma_{\\max} \\left(\\frac{x}{L}\\right)^m$，并且在整个PML中 $\\kappa$ 和 $\\alpha$ 为常数。\n\n对于一个从均匀区域入射的平面波分量，其入射角为 $\\theta \\in [0,\\pi/2)$（相对于 $+x$ 轴，以弧度为单位），横向波数是守恒的，真空波数的 $x$ 分量为 $k_{x0} = k_0 \\cos \\theta$，其中 $k_0 = \\omega \\sqrt{\\varepsilon_0 \\mu_0}$。在复坐标伸缩下，穿过PML的 $x$ 方向相位累积由下式决定\n$$\n\\Phi(\\theta) = k_{x0} \\int_{0}^{L} \\frac{dx}{s_x(x)}.\n$$\n假设入口 $x=0$ 处为理想匹配（无反射）。唯一的反射是由 $x=L$ 处的PEC以及波在有损PML中的双程传播引起的。设入口 $x=0$ 处的有效反射系数为 $R_{\\mathrm{eff}}(\\theta)$，该系数必须从第一性原理推导。然后在 $x0$ 处实现一个镜像源，其复振幅为 $C_{\\mathrm{img}}$，以抵消反射。如果 $C_{\\mathrm{img}}$ 在法向入射 $\\theta = 0$ 时被调谐以达到 $C_{\\mathrm{img}} = - R_{\\mathrm{eff}}(0)$，则量化在斜入射 $\\theta \\ne 0$ 时的残余反射，其形式为复数残差\n$$\nR_{\\mathrm{res}}(\\theta) = R_{\\mathrm{eff}}(\\theta) - R_{\\mathrm{eff}}(0),\n$$\n并报告残余功率反射 $|R_{\\mathrm{res}}(\\theta)|^2$。\n\n您的程序必须：\n- 实现对给定参数集计算 $R_{\\mathrm{eff}}(\\theta)$ 的功能，通过计算 $1/s_x(x)$ 在PML上的积分。您必须以足够的精度对积分进行数值计算。\n- 对每个不同的PML参数集，通过 $C_{\\mathrm{img}} = -R_{\\mathrm{eff}}(0)$ 设置镜像振幅。\n- 对于下面的每个测试用例，计算并返回残余功率反射 $|R_{\\mathrm{res}}(\\theta)|^2$，结果为十进制浮点数（无单位）。所有角度必须以弧度为单位。\n\n使用常数 $\\varepsilon_0 = 8.854187817\\times 10^{-12}\\ \\mathrm{F/m}$ 和 $\\mu_0 = 4 \\pi \\times 10^{-7}\\ \\mathrm{H/m}$。\n\n测试套件（每个测试引用一个特定的PML参数集，然后提供一个角度 $\\theta$）：\n- 参数集 $\\mathsf{A}$：$f = 3.0 \\times 10^{9}\\ \\mathrm{Hz}$, $L = 0.2\\ \\mathrm{m}$, $m = 3$, $\\kappa = 1.0$, $\\alpha = 0.0\\ \\mathrm{s^{-1}}$, $\\sigma_{\\max} = 0.5\\ \\mathrm{S/m}$。\n- 参数集 $\\mathsf{B}$：$f = 3.0 \\times 10^{9}\\ \\mathrm{Hz}$, $L = 0.2\\ \\mathrm{m}$, $m = 3$, $\\kappa = 3.0$, $\\alpha = 2 \\pi \\times 1.0 \\times 10^{8}\\ \\mathrm{s^{-1}}$, $\\sigma_{\\max} = 0.5\\ \\mathrm{S/m}$。\n- 参数集 $\\mathsf{C}$：$f = 3.0 \\times 10^{9}\\ \\mathrm{Hz}$, $L = 0.05\\ \\mathrm{m}$, $m = 3$, $\\kappa = 1.0$, $\\alpha = 0.0\\ \\mathrm{s^{-1}}$, $\\sigma_{\\max} = 0.5\\ \\mathrm{S/m}$。\n\n待评估的测试用例（每个返回 $|R_{\\mathrm{res}}(\\theta)|^2$）：\n- 用例 1：使用 $\\mathsf{A}$ 和 $\\theta = 0.0$。\n- 用例 2：使用 $\\mathsf{A}$ 和 $\\theta = \\pi/6$。\n- 用例 3：使用 $\\mathsf{A}$ 和 $\\theta = \\pi/2 - 0.01$。\n- 用例 4：使用 $\\mathsf{B}$ 和 $\\theta = \\pi/2 - 0.01$。\n- 用例 5：使用 $\\mathsf{C}$ 和 $\\theta = 0.0$。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的、以逗号分隔的结果列表，顺序与用例1到5相同。", "solution": "问题陈述是有效的。这是一个计算电磁学中定义明确的问题，其基础是麦克斯韦方程组、平面波理论以及完美匹配层（PML）的复坐标伸缩公式等既定原理。所有必要的参数和条件都已提供，目标也以科学和数学的精度进行了陈述。\n\n求解过程如下：首先，我们推导由PEC背衬的PML的角度相关有效反射系数。其次，我们形式化由基于镜像理论的吸收边界条件（为法向入射调谐）所产生的残余反射。最后，我们实现一种基于数值积分的方法来计算指定测试用例所需的残余功率。\n\n设角频率为 $\\omega = 2\\pi f$，隐去的时间因子为 $\\exp(j\\omega t)$。背景介质是真空，其特征为介电常数 $\\varepsilon_0$ 和磁导率 $\\mu_0$。真空波数为 $k_0 = \\omega\\sqrt{\\varepsilon_0\\mu_0}$。\n\nPML定义在区域 $x \\in [0, L]$ 内，由复伸缩因子 $s_x(x)$ 描述：\n$$\ns_x(x) = \\kappa + \\frac{\\sigma(x)}{j \\omega \\varepsilon_0} + j \\frac{\\alpha}{\\omega}\n$$\n电导率分布 $\\sigma(x)$ 以 $m$ 阶多项式形式给出：\n$$\n\\sigma(x) = \\sigma_{\\max} \\left(\\frac{x}{L}\\right)^m\n$$\n利用 $1/j = -j$，将 $s_x(x)$ 表示为标准复数形式 $A+jB$：\n$$\ns_x(x) = \\kappa + j\\left(\\frac{\\alpha}{\\omega} - \\frac{\\sigma_{\\max}}{\\omega\\varepsilon_0}\\left(\\frac{x}{L}\\right)^m\\right)\n$$\n该函数是空间坐标 $x$ 的复值函数。\n\n一束平面波从真空区域（$x0$）以相对于 $+x$ 轴的 $\\theta$ 角入射。其沿 $x$ 轴的波矢量分量为 $k_{x0} = k_0 \\cos\\theta$。根据问题的表述，该平面波分量在PML中的传播由一个修正的相位累积所决定。在 $x$ 方向的有效传播常数变为 $k_x(x) = k_{x0}/s_x(x)$。波从 $x=0$ 传播到 $x=L$ 穿过PML所累积的总复相位 $\\Phi(\\theta)$ 是该量的积分：\n$$\n\\Phi(\\theta) = \\int_0^L k_x(x') dx' = k_{x0} \\int_0^L \\frac{dx'}{s_x(x')} = (k_0 \\cos\\theta) \\int_0^L \\frac{dx'}{s_x(x')}\n$$\n对于给定的PML参数集，积分 $\\int_0^L \\frac{dx}{s_x(x)}$ 是一个复常数。我们将其记为 $I_s$：\n$$\nI_s = \\int_0^L \\frac{dx'}{s_x(x')}\n$$\n因此，相位累积简化为 $\\Phi(\\theta) = k_0 \\cos\\theta \\cdot I_s$。\n\n问题指定了在PML入口（$x=0$）处存在理想阻抗匹配，并在背板（$x=L$）处有一个理想电导体（PEC）。一个单位振幅的入射波进入PML，传播到PEC，反射，然后传播回入口。从 $x=0$ 到 $x=L$ 的行程会产生一个复相位因子 $\\exp(-j\\Phi(\\theta))$。在PEC处，切向电场经受硬壁反射，引入了-1的反射系数。然后，波从 $x=L$ 传回 $x=0$，再次累积一个相位因子 $\\exp(-j\\Phi(\\theta))$。在 $x=0$ 界面处的有效反射系数 $R_{\\mathrm{eff}}(\\theta)$ 是这三种效应的乘积：\n$$\nR_{\\mathrm{eff}}(\\theta) = \\left( \\exp(-j\\Phi(\\theta)) \\right) \\cdot (-1) \\cdot \\left( \\exp(-j\\Phi(\\theta)) \\right) = -\\exp(-j2\\Phi(\\theta))\n$$\n代入 $\\Phi(\\theta)$ 的表达式，我们得到：\n$$\nR_{\\mathrm{eff}}(\\theta) = -\\exp(-j 2 k_0 \\cos\\theta \\cdot I_s)\n$$\n\n镜像理论吸收边界是通过一个镜像源实现的，该镜像源的场旨在抵消法向入射（$\\theta=0$）时的反射。因此，镜像源贡献的复振幅 $C_{\\mathrm{img}}$ 为：\n$$\nC_{\\mathrm{img}} = -R_{\\mathrm{eff}}(0)\n$$\n在任意角度 $\\theta$ 下的总反射场是来自PML的物理反射与来自镜像源的场的叠加。复数残余反射 $R_{\\mathrm{res}}(\\theta)$ 为：\n$$\nR_{\\mathrm{res}}(\\theta) = R_{\\mathrm{eff}}(\\theta) + C_{\\mathrm{img}} = R_{\\mathrm{eff}}(\\theta) - R_{\\mathrm{eff}}(0)\n$$\n需要计算的量是残余功率反射，即该复数值的模的平方：$|R_{\\mathrm{res}}(\\theta)|^2$。\n\n积分 $I_s$ 没有通用的解析解，必须进行数值计算。我们使用数值积分法来评估复值被积函数 $1/s_x(x)$ 在区间 $[0, L]$ 上的积分的实部和虚部。计算出 $I_s$ 后，我们就可以对任意给定的 $\\theta$ 计算 $R_{\\mathrm{eff}}(\\theta)$，并随后求出所需的残余功率。对于 $\\theta=0$ 的特殊情况，$R_{\\mathrm{res}}(0) = R_{\\mathrm{eff}}(0) - R_{\\mathrm{eff}}(0) = 0$，所以残余功率恰好为 $0$。\n\n算法如下：\n1. 对每一组不同的PML参数，使用数值积分法计算复积分 $I_s$。\n2. 对每个由参数集和角度 $\\theta$ 指定的测试用例：\n   a. 获取预先计算好的 $I_s$。\n   b. 计算 $R_{\\mathrm{eff}}(\\theta) = -\\exp(-j 2 k_0 \\cos\\theta \\cdot I_s)$。\n   c. 计算 $R_{\\mathrm{eff}}(0) = -\\exp(-j 2 k_0 \\cdot I_s)$。\n   d. 计算残余反射 $R_{\\mathrm{res}}(\\theta) = R_{\\mathrm{eff}}(\\theta) - R_{\\mathrm{eff}}(0)$。\n   e. 最终结果是残余功率 $|R_{\\mathrm{res}}(\\theta)|^2$。", "answer": "```python\nimport numpy as np\nfrom scipy import integrate\n\ndef solve():\n    \"\"\"\n    Main function to solve the PML image theory problem, computing residual reflection\n    power for several test cases.\n    \"\"\"\n    # Physical constants\n    EPS0 = 8.854187817e-12  # Permittivity of free space in F/m\n    MU0 = 4 * np.pi * 1e-7    # Permeability of free space in H/m\n    C0 = 1 / np.sqrt(EPS0 * MU0) # Speed of light in vacuum in m/s\n\n    class PMLAnalyzer:\n        \"\"\"\n        A class to encapsulate the calculation for a given set of PML parameters.\n        It pre-computes the complex integral I_s and the normal-incidence reflection\n        coefficient to efficiently calculate residuals for various angles.\n        \"\"\"\n        def __init__(self, f, L, m, kappa, alpha, sigma_max):\n            self.f = f\n            self.L = L\n            self.m = m\n            self.kappa = kappa\n            self.alpha = alpha\n            self.sigma_max = sigma_max\n\n            self.omega = 2 * np.pi * self.f\n            self.k0 = self.omega / C0\n\n            self._I_s = self._compute_integral()\n            # Cache R_eff(0) for repeated use in residual calculation\n            self._r_eff_0 = self._calculate_r_eff(0.0)\n\n        def _s_x(self, x):\n            \"\"\"Computes the complex stretching factor s_x at position x.\"\"\"\n            if self.L == 0:\n                return self.kappa + 1j * (self.alpha / self.omega)\n            \n            # Polynomial-graded conductivity\n            sigma_x = self.sigma_max * (x / self.L)**self.m\n            \n            # Complex stretching factor, s_x(x)\n            return self.kappa + 1j * (self.alpha / self.omega - sigma_x / (self.omega * EPS0))\n\n        def _compute_integral(self):\n            \"\"\"Numerically computes the integral of 1/s_x(x) from 0 to L.\"\"\"\n            if self.L == 0:\n                return 0.0 + 0.0j\n\n            integrand = lambda x: 1.0 / self._s_x(x)\n            \n            # Use numerical quadrature to integrate the real and imaginary parts of the integrand\n            quad_opts = {'epsabs': 1e-13, 'epsrel': 1e-13}\n            I_s_real, _ = integrate.quad(lambda x: integrand(x).real, 0, self.L, **quad_opts)\n            I_s_imag, _ = integrate.quad(lambda x: integrand(x).imag, 0, self.L, **quad_opts)\n            \n            return I_s_real + 1j * I_s_imag\n\n        def _calculate_r_eff(self, theta):\n            \"\"\"Calculates the effective reflection coefficient for a given angle theta.\"\"\"\n            # Complex phase accumulation through the PML\n            phi = self.k0 * np.cos(theta) * self._I_s\n            # Reflection from PEC-backed PML\n            r_eff = -np.exp(-2j * phi)\n            return r_eff\n\n        def get_residual_power(self, theta):\n            \"\"\"\n            Calculates the residual power reflection |R_res(theta)|^2, where\n            R_res(theta) = R_eff(theta) - R_eff(0).\n            \"\"\"\n            # By definition, residual at the design angle (theta=0) is zero.\n            if theta == 0.0:\n                return 0.0\n            \n            r_eff_theta = self._calculate_r_eff(theta)\n            r_res = r_eff_theta - self._r_eff_0\n            return np.abs(r_res)**2\n\n    # Define the parameter sets from the problem statement.\n    param_sets = {\n        'A': {'f': 3.0e9, 'L': 0.2, 'm': 3, 'kappa': 1.0, 'alpha': 0.0, 'sigma_max': 0.5},\n        'B': {'f': 3.0e9, 'L': 0.2, 'm': 3, 'kappa': 3.0, 'alpha': 2 * np.pi * 1.0e8, 'sigma_max': 0.5},\n        'C': {'f': 3.0e9, 'L': 0.05, 'm': 3, 'kappa': 1.0, 'alpha': 0.0, 'sigma_max': 0.5},\n    }\n\n    # Instantiate analyzers for each parameter set, pre-computing the integrals.\n    # This design is efficient as the integral is computed only once per parameter set.\n    analyzers = {key: PMLAnalyzer(**params) for key, params in param_sets.items()}\n    \n    # Define the test cases from the problem statement.\n    # Each case is a tuple of (parameter set key, angle theta in radians).\n    test_cases = [\n        ('A', 0.0),\n        ('A', np.pi / 6),\n        ('A', np.pi / 2 - 0.01),\n        ('B', np.pi / 2 - 0.01),\n        ('C', 0.0),\n    ]\n\n    results = []\n    for param_key, theta in test_cases:\n        analyzer = analyzers[param_key]\n        result = analyzer.get_residual_power(theta)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    # The output is a list of decimal floats.\n    print(f\"[{','.join(f'{r:.12f}' for r in results)}]\")\n\nsolve()\n```", "id": "3316445"}]}