{"hands_on_practices": [{"introduction": "有限差分方法的核心在于对导数进行近似。本练习将运用泰勒级数展开这一基本工具，来严谨地分析这种近似所引入的误差 [@problem_id:3593417]。掌握这一推导过程，能让您从第一性原理出发理解“精度阶数”的概念，是分析更复杂数值格式的基石。", "problem": "在一维地震波传播的数值模拟中，沿一条测线的光滑标量波场 $f(x)$ 的空间梯度，通常在间距为 $h$ 的均匀网格上使用对称有限差分格式进行近似。考虑中心差分近似\n$$\n\\frac{f_{i+1}-f_{i-1}}{2h}\n$$\n用于近似空间导数 $f'(x_i)$，其中 $f_i \\equiv f(x_i)$ 且 $x_{i\\pm 1} = x_i \\pm h$。假设函数 $f$ 在 $x_i$ 附近足够光滑，可以进行泰勒级数展开。\n\n从函数 $f$ 在 $x_i$ 点的泰勒级数出发，推导当使用上述中心差分近似 $f'(x_i)$ 时的精度阶和主阶截断误差项。您的推导必须从泰勒级数定义开始，并通过格式对称性所蕴含的逐项系统性相消来进行；请勿在未推导的情况下直接引用任何误差项公式。\n\n请提供主阶截断误差项作为最终答案，其形式应为关于 $h$ 和 $f$ 在 $x_i$ 处导数的单个闭式解析表达式。无需进行数值舍入，也无需单位。精度阶应在您的推导过程中得到论证，但不应包含在最终方框内的答案中。", "solution": "该问题要求推导一阶导数 $f'(x_i)$ 的中心差分近似的精度阶和主阶截断误差项。该近似由公式 $\\frac{f_{i+1}-f_{i-1}}{2h}$ 给出，其中 $f_j \\equiv f(x_j)$ 且 $x_{i \\pm 1} = x_i \\pm h$。推导必须基于函数 $f(x)$ 在点 $x_i$ 的泰勒级数展开。\n\n局部截断误差（我们记为 $\\tau(x_i, h)$）的形式化定义为：将有限差分近似应用于精确函数所得到的值，与它旨在近似的精确导数值之间的差。因此，我们有：\n$$\n\\tau(x_i, h) = \\frac{f(x_i+h) - f(x_i-h)}{2h} - f'(x_i)\n$$\n为分析此表达式，我们引用 $f(x)$ 在点 $x_i$ 的泰勒级数展开。问题中 $f(x)$ “足够光滑” 的前提保证了此展开的有效性。我们展开 $f(x_i+h)$ 和 $f(x_i-h)$，并将 $f(x)$ 在 $x_i$ 处的n阶导数记为 $f^{(n)}(x_i)$。为清晰起见，我们还使用记号 $f_i \\equiv f(x_i)$。\n\n$f(x_i+h)$ 的泰勒级数展开为：\n$$\nf_{i+1} = f(x_i+h) = f(x_i) + h f'(x_i) + \\frac{h^2}{2!} f''(x_i) + \\frac{h^3}{3!} f^{(3)}(x_i) + \\frac{h^4}{4!} f^{(4)}(x_i) + \\frac{h^5}{5!} f^{(5)}(x_i) + \\mathcal{O}(h^6)\n$$\n代入阶乘的数值：\n$$\nf_{i+1} = f_i + h f'(x_i) + \\frac{h^2}{2} f''(x_i) + \\frac{h^3}{6} f^{(3)}(x_i) + \\frac{h^4}{24} f^{(4)}(x_i) + \\frac{h^5}{120} f^{(5)}(x_i) + \\mathcal{O}(h^6)\n$$\n类似地，$f(x_i-h)$ 的泰勒级数展开为：\n$$\nf_{i-1} = f(x_i-h) = f(x_i) + (-h) f'(x_i) + \\frac{(-h)^2}{2!} f''(x_i) + \\frac{(-h)^3}{3!} f^{(3)}(x_i) + \\frac{(-h)^4}{4!} f^{(4)}(x_i) + \\frac{(-h)^5}{5!} f^{(5)}(x_i) + \\mathcal{O}(h^6)\n$$\n$$\nf_{i-1} = f_i - h f'(x_i) + \\frac{h^2}{2} f''(x_i) - \\frac{h^3}{6} f^{(3)}(x_i) + \\frac{h^4}{24} f^{(4)}(x_i) - \\frac{h^5}{120} f^{(5)}(x_i) + \\mathcal{O}(h^6)\n$$\n根据问题的要求，我们现在系统地展示各项的相消过程。我们计算差值 $f_{i+1} - f_{i-1}$，它构成了中心差分公式的分子。\n\\begin{align*}\nf_{i+1} - f_{i-1} =  \\left( f_i + h f'(x_i) + \\frac{h^2}{2} f''(x_i) + \\frac{h^3}{6} f^{(3)}(x_i) + \\frac{h^4}{24} f^{(4)}(x_i) + \\dots \\right) \\\\\n - \\left( f_i - h f'(x_i) + \\frac{h^2}{2} f''(x_i) - \\frac{h^3}{6} f^{(3)}(x_i) + \\frac{h^4}{24} f^{(4)}(x_i) - \\dots \\right)\n\\end{align*}\n按 $f(x)$ 的导数阶数对各项进行分组：\n\\begin{align*}\n\\text{零阶项：} \\quad  f_i - f_i = 0 \\\\\n\\text{一阶项：} \\quad  h f'(x_i) - (-h f'(x_i)) = 2h f'(x_i) \\\\\n\\text{二阶项：} \\quad  \\frac{h^2}{2} f''(x_i) - \\frac{h^2}{2} f''(x_i) = 0 \\\\\n\\text{三阶项：} \\quad  \\frac{h^3}{6} f^{(3)}(x_i) - \\left(-\\frac{h^3}{6} f^{(3)}(x_i)\\right) = 2 \\frac{h^3}{6} f^{(3)}(x_i) = \\frac{h^3}{3} f^{(3)}(x_i) \\\\\n\\text{四阶项：} \\quad  \\frac{h^4}{24} f^{(4)}(x_i) - \\frac{h^4}{24} f^{(4)}(x_i) = 0 \\\\\n\\text{五阶项：} \\quad  \\frac{h^5}{120} f^{(5)}(x_i) - \\left(-\\frac{h^5}{120} f^{(5)}(x_i)\\right) = 2 \\frac{h^5}{120} f^{(5)}(x_i) = \\frac{h^5}{60} f^{(5)}(x_i)\n\\end{align*}\n此计算展示了对称格式的一个关键特性：所有对应于偶数阶导数（$f_i$, $f''(x_i)$, $f^{(4)}(x_i)$ 等）的项都相互抵消，而对应于奇数阶导数（$f'(x_i)$, $f^{(3)}(x_i)$, $f^{(5)}(x_i)$ 等）的项则会相加。\n\n将非零项求和，差值 $f_{i+1} - f_{i-1}$ 为：\n$$\nf_{i+1} - f_{i-1} = 2h f'(x_i) + \\frac{h^3}{3} f^{(3)}(x_i) + \\frac{h^5}{60} f^{(5)}(x_i) + \\mathcal{O}(h^7)\n$$\n现在，我们除以 $2h$ 来构建完整的中心差分近似：\n$$\n\\frac{f_{i+1} - f_{i-1}}{2h} = \\frac{1}{2h} \\left( 2h f'(x_i) + \\frac{h^3}{3} f^{(3)}(x_i) + \\frac{h^5}{60} f^{(5)}(x_i) + \\mathcal{O}(h^7) \\right)\n$$\n$$\n\\frac{f_{i+1} - f_{i-1}}{2h} = f'(x_i) + \\frac{h^2}{6} f^{(3)}(x_i) + \\frac{h^4}{120} f^{(5)}(x_i) + \\mathcal{O}(h^6)\n$$\n通过从两侧减去 $f'(x_i)$，我们分离出截断误差 $\\tau(x_i, h)$：\n$$\n\\tau(x_i, h) = \\frac{f_{i+1} - f_{i-1}}{2h} - f'(x_i) = \\frac{h^2}{6} f^{(3)}(x_i) + \\frac{h^4}{120} f^{(5)}(x_i) + \\mathcal{O}(h^6)\n$$\n一个数值格式的精度阶由其局部截断误差级数展开中网格间距 $h$ 的最低次幂决定。当 $h \\to 0$ 时，假设 $f^{(3)}(x_i) \\neq 0$，则误差的主部是 $\\frac{h^2}{6} f^{(3)}(x_i)$ 这一项。因此，误差与 $h^2$ 成正比，记作 $\\mathcal{O}(h^2)$。这意味着中心差分近似是二阶精度的。\n\n主阶截断误差项是误差级数中的第一个非零项。根据我们推导的表达式，该项为：\n$$\n\\frac{h^2}{6} f^{(3)}(x_i)\n$$\n至此，完成了所要求的推导。", "answer": "$$\n\\boxed{\\frac{h^2}{6} f^{(3)}(x_i)}\n$$", "id": "3593417"}, {"introduction": "虽然低阶格式易于实现，但在精确的波模拟中通常需要更高阶的格式。本练习将泰勒级数分析方法推广，用于设计一个高阶精度的中心差分格式，并进一步研究其“符号”或离散波数 [@problem_id:3358119]。这一过程揭示了精度阶数与数值色散之间的关键联系，而数值色散是长距离波传播模拟中的主要误差来源。", "problem": "一维无损均匀介质的介电常数为 $\\epsilon$，磁导率为 $\\mu$，该介质支持由麦克斯韦方程组所描述的横电磁波。这组方程可以推导出波动方程 $\\,\\partial_{tt} u = c^{2}\\,\\partial_{xx} u\\,$，其中波速 $\\,c = 1/\\sqrt{\\epsilon \\mu}\\,$，该方程对于作为解的任意场分量 $u(x,t)$ 均成立。在计算电磁学中，使用均匀网格 $x_{i} = x_{0} + i h$（间距为 $h$）上的中心有限差分来近似空间导数。考虑在模板 $\\{x_{i-m},\\dots,x_{i+m}\\}$ 上对 $\\partial_{x}$ 的一个对称的 $2m+1$ 点中心差分近似：\n$$\nD_{h} u(x_{i}) \\coloneqq \\frac{1}{h} \\sum_{j=-m}^{m} a_{j}\\,u(x_{i}+j h),\n$$\n其中 $a_{j}$ 是未知的实数系数，受反对称性 $a_{-j} = -a_{j}$ 和 $a_{0}=0$ 的约束，以确保奇数阶导数的精度。设计目标是 $2m$ 阶精度，意味着截断误差为 $O(h^{2m})$。\n\n从 $u(x_{i} + j h)$ 的泰勒级数展开和与 $\\partial_{x}$ 相容性所隐含的矩匹配条件出发，构建当 $m=3$ 时的系数 $\\{a_{j}\\}_{j=-m}^{m}$。然后，对于傅里叶模式 $u(x) = \\exp(i k x)$，定义无量纲波数 $\\xi \\coloneqq k h$，并推导离散波数映射 $k_{d}(\\xi)$，该映射由 $D_{h}$ 的符号通过 $D_{h} \\exp(i k x_{i}) = i\\,k_{d}(\\xi)\\,\\exp(i k x_{i})$ 定义。利用此结果阐明半离散波动方程的离散色散关系 $\\omega = c\\,k_{d}(\\xi)$，该方程的时间导数是精确的，而空间离散化由 $D_{h}$ 实现。\n\n任务：\n1. 推导并求解矩匹配条件，以获得保证 6 阶精度的模板正半部分系数 $a_{1}$、$a_{2}$ 和 $a_{3}$ 的精确有理数值。\n2. 使用这些系数，推导 $k_{d}(\\xi)$ 的精确闭式解析表达式。\n3. 通过提取 $k_{d}(\\xi)$ 在 $\\xi=0$ 附近的泰勒展开式的主阶项，简要解释 6 阶空间离散化在 $\\xi$ 较小时如何影响离散色散（相速度和群速度）。\n\n将最终的离散波数映射 $k_{d}(\\xi)$ 表示为单个精确的解析表达式；不要四舍五入。最终表达式中无需单位。", "solution": "首先根据指定标准对问题陈述进行验证。\n\n### 步骤 1：提取已知条件\n- **控制方程：** 一维波动方程 $\\partial_{tt} u = c^{2}\\,\\partial_{xx} u$，波速为 $c = 1/\\sqrt{\\epsilon \\mu}$。\n- **系统：** 介电常数为 $\\epsilon$、磁导率为 $\\mu$ 的无损均匀介质。\n- **离散化算子：** 在均匀网格 $x_i = x_0 + i h$ 上对 $\\partial_x$ 的一个 $(2m+1)$ 点中心有限差分近似 $D_h$。\n$$ D_{h} u(x_{i}) \\coloneqq \\frac{1}{h} \\sum_{j=-m}^{m} a_{j}\\,u(x_{i}+j h) $$\n- **情况：** $m=3$，对应一个 7 点模板。\n- **系数约束：**\n  - 反对称性：$a_{-j} = -a_{j}$。\n  - 中心系数：$a_{0}=0$。\n- **精度要求：** $2m=6$ 阶，意味着截断误差为 $O(h^6)$。\n- **分析函数：** 傅里叶模式 $u(x) = \\exp(i k x)$。\n- **无量纲波数：** $\\xi \\coloneqq k h$。\n- **离散波数定义：** $D_{h} \\exp(i k x_{i}) = i\\,k_{d}(\\xi)\\,\\exp(i k x_{i})$。\n- **任务：**\n  1. 推导保证 6 阶精度的模板系数 $\\{a_1, a_2, a_3\\}$。\n  2. 推导离散波数映射 $k_d(\\xi)$ 的闭式表达式。\n  3. 分析在 $\\xi$ 较小时，离散化对离散色散关系的影响。\n\n### 步骤 2：使用提取的已知条件进行验证\n- **科学依据：** 该问题牢固地植根于偏微分方程数值方法的理论，特别是在计算电磁学中使用的时域有限差分（FDTD）方法。通过傅里叶方法分析截断误差和数值色散是该领域的标准和基础技术。\n- **适定性：** 该问题是适定的。从泰勒级数展开推导有限差分系数会得到一个非奇异的线性方程组，并产生唯一解。离散波数的定义是精确的，并允许唯一的推导。\n- **客观性：** 语言是正式的，所有量都经过数学定义，没有主观解释的余地。\n\n### 步骤 3：结论与行动\n问题有效。这是数值分析在波现象中应用的一个标准练习。将提供完整解答。\n\n### 求解推导\n\n**任务 1：模板系数的推导**\n\n为达到 $2m=6$ 阶精度，有限差分算子 $D_h u(x)$ 必须与精确导数 $\\partial_x u(x)$ 的泰勒级数展开式匹配，直到 $h^5$ 阶项。第一个非零误差项应为 $h^6$ 阶。\n\n首先，我们展开算子 $D_h$。使用反对称性约束 $a_{-j} = -a_j$ 和 $a_0=0$：\n$$ D_h u(x) = \\frac{1}{h} \\sum_{j=1}^{m} a_j \\left[ u(x+jh) - u(x-jh) \\right] $$\n我们对 $u(x+jh) - u(x-jh)$ 在 $x$ 附近进行泰勒级数展开：\n$$ u(x+jh) - u(x-jh) = \\sum_{n=0}^{\\infty} \\frac{u^{(n)}(x)}{n!} (jh)^n - \\sum_{n=0}^{\\infty} \\frac{u^{(n)}(x)}{n!} (-jh)^n = 2 \\sum_{k=0}^{\\infty} \\frac{u^{(2k+1)}(x)}{(2k+1)!} (jh)^{2k+1} $$\n将此代入 $D_h u(x)$ 的表达式中：\n$$ D_h u(x) = \\frac{1}{h} \\sum_{j=1}^{m} a_j \\left[ 2(jh)u'(x) + \\frac{2(jh)^3}{3!}u'''(x) + \\frac{2(jh)^5}{5!}u^{(5)}(x) + \\frac{2(jh)^7}{7!}u^{(7)}(x) + O(h^9) \\right] $$\n按导数阶次对各项进行分组：\n$$ D_h u(x) = u'(x) \\left[ 2 \\sum_{j=1}^{m} j a_j \\right] + u'''(x) \\left[ \\frac{h^2}{3} \\sum_{j=1}^{m} j^3 a_j \\right] + u^{(5)}(x) \\left[ \\frac{h^4}{60} \\sum_{j=1}^{m} j^5 a_j \\right] + u^{(7)}(x) \\left[ \\frac{h^6}{2520} \\sum_{j=1}^{m} j^7 a_j \\right] + \\dots $$\n为了使 $D_h u(x)$ 以 $O(h^6)$ 的误差近似 $\\partial_x u(x)$，我们必须将 $u'(x)$ 的系数匹配为 $1$，并将 $u'''(x)$ 和 $u^{(5)}(x)$ 的系数设为零。对于 $m=3$，这为系数 $a_1, a_2, a_3$ 提供了三个线性方程组成的方程组：\n1. $2 \\sum_{j=1}^{3} j a_j = 1 \\implies a_1 + 2a_2 + 3a_3 = \\frac{1}{2}$\n2. $\\sum_{j=1}^{3} j^3 a_j = 0 \\implies a_1 + 8a_2 + 27a_3 = 0$\n3. $\\sum_{j=1}^{3} j^5 a_j = 0 \\implies a_1 + 32a_2 + 243a_3 = 0$\n\n我们求解这个方程组。将方程 (3) 减去方程 (2)：\n$$ (32-8)a_2 + (243-27)a_3 = 0 \\implies 24a_2 + 216a_3 = 0 \\implies a_2 = -9a_3 $$\n将方程 (2) 减去方程 (1)：\n$$ (8-2)a_2 + (27-3)a_3 = -\\frac{1}{2} \\implies 6a_2 + 24a_3 = -\\frac{1}{2} $$\n将 $a_2 = -9a_3$ 代入这个新方程：\n$$ 6(-9a_3) + 24a_3 = -\\frac{1}{2} \\implies -54a_3 + 24a_3 = -\\frac{1}{2} \\implies -30a_3 = -\\frac{1}{2} \\implies a_3 = \\frac{1}{60} $$\n回代求解 $a_2$ 和 $a_1$：\n$$ a_2 = -9 \\left(\\frac{1}{60}\\right) = -\\frac{9}{60} = -\\frac{3}{20} $$\n$$ a_1 = \\frac{1}{2} - 2a_2 - 3a_3 = \\frac{1}{2} - 2\\left(-\\frac{3}{20}\\right) - 3\\left(\\frac{1}{60}\\right) = \\frac{1}{2} + \\frac{6}{20} - \\frac{3}{60} = \\frac{30}{60} + \\frac{18}{60} - \\frac{3}{60} = \\frac{45}{60} = \\frac{3}{4} $$\n系数为 $a_1 = \\frac{3}{4}$，$a_2 = -\\frac{3}{20}$ 和 $a_3 = \\frac{1}{60}$。\n\n**任务 2：离散波数 $k_d(\\xi)$ 的推导**\n\n我们将算子 $D_h$ 应用于傅里叶模式 $u(x_i) = \\exp(i k x_i)$：\n$$ D_h \\exp(i k x_i) = \\frac{1}{h} \\sum_{j=-m}^{m} a_j \\exp(i k(x_i+jh)) = \\frac{\\exp(i k x_i)}{h} \\sum_{j=-m}^{m} a_j \\exp(i kjh) $$\n使用 $a_{-j}=-a_j$ 和 $a_0=0$，求和变为：\n$$ \\sum_{j=-m}^{m} a_j \\exp(i kjh) = \\sum_{j=1}^{m} \\left( a_j \\exp(i kjh) + a_{-j} \\exp(-i kjh) \\right) = \\sum_{j=1}^{m} a_j \\left( \\exp(i kjh) - \\exp(-i kjh) \\right) $$\n使用欧拉恒等式 $\\exp(i\\theta) - \\exp(-i\\theta) = 2i\\sin(\\theta)$ 和定义 $\\xi = kh$：\n$$ \\sum_{j=1}^{m} a_j (2i\\sin(kjh)) = 2i \\sum_{j=1}^{m} a_j \\sin(j\\xi) $$\n将此代回 $D_h$ 的表达式：\n$$ D_h \\exp(i k x_i) = \\frac{\\exp(i k x_i)}{h} \\left( 2i \\sum_{j=1}^{m} a_j \\sin(j\\xi) \\right) = i \\left( \\frac{2}{h} \\sum_{j=1}^{m} a_j \\sin(j\\xi) \\right) \\exp(i k x_i) $$\n通过将其与定义 $D_{h} \\exp(i k x_{i}) = i\\,k_{d}(\\xi)\\,\\exp(i k x_{i})$ 进行比较，我们确定离散波数映射为：\n$$ k_d(\\xi) = \\frac{2}{h} \\sum_{j=1}^{m} a_j \\sin(j\\xi) $$\n对于 $m=3$，使用任务 1 中求得的系数：\n$$ k_d(\\xi) = \\frac{2}{h} \\left( a_1 \\sin(\\xi) + a_2 \\sin(2\\xi) + a_3 \\sin(3\\xi) \\right) $$\n$$ k_d(\\xi) = \\frac{2}{h} \\left( \\frac{3}{4} \\sin(\\xi) - \\frac{3}{20} \\sin(2\\xi) + \\frac{1}{60} \\sin(3\\xi) \\right) $$\n$$ k_d(\\xi) = \\frac{1}{h} \\left( \\frac{3}{2} \\sin(\\xi) - \\frac{3}{10} \\sin(2\\xi) + \\frac{1}{30} \\sin(3\\xi) \\right) $$\n为了得到更紧凑的形式，我们可以将所有项通分到公分母 $30$：\n$$ k_d(\\xi) = \\frac{1}{30h} \\left( 45 \\sin(\\xi) - 9 \\sin(2\\xi) + \\sin(3\\xi) \\right) $$\n\n**任务 3：离散色散分析**\n\n通过比较离散波数 $k_d$ 和精确波数 $k = \\xi/h$ 可以理解离散化的影响。我们将 $k_d(\\xi)$ 在小 $\\xi$ 处展开为泰勒级数。\n$$ \\sin(x) = x - \\frac{x^3}{6} + \\frac{x^5}{120} - \\frac{x^7}{5040} + O(x^9) $$\n展开 $h k_d(\\xi)$ 表达式中的每一项：\n$$ h k_d(\\xi) = \\frac{3}{2}\\left(\\xi - \\frac{\\xi^3}{6} + \\frac{\\xi^5}{120} - \\frac{\\xi^7}{5040} + \\dots\\right) - \\frac{3}{10}\\left(2\\xi - \\frac{(2\\xi)^3}{6} + \\frac{(2\\xi)^5}{120} - \\frac{(2\\xi)^7}{5040} + \\dots\\right) + \\frac{1}{30}\\left(3\\xi - \\frac{(3\\xi)^3}{6} + \\frac{(3\\xi)^5}{120} - \\frac{(3\\xi)^7}{5040} + \\dots\\right) $$\n收集 $\\xi$ 各次幂的系数：\n- $\\xi^1$ 的系数：$\\frac{3}{2} - \\frac{3}{10}(2) + \\frac{1}{30}(3) = \\frac{3}{2} - \\frac{3}{5} + \\frac{1}{10} = \\frac{15-6+1}{10} = 1$。\n- $\\xi^3$ 的系数：$-\\frac{3}{2 \\cdot 6} + \\frac{3 \\cdot 8}{10 \\cdot 6} - \\frac{1 \\cdot 27}{30 \\cdot 6} = \\frac{1}{180}(-45 + 72 - 27) = 0$。\n- $\\xi^5$ 的系数：$\\frac{3}{2 \\cdot 120} - \\frac{3 \\cdot 32}{10 \\cdot 120} + \\frac{1 \\cdot 243}{30 \\cdot 120} = \\frac{1}{3600}(45 - 288 + 243) = 0$。\n这些零系数是满足矩匹配条件的直接结果。第一个非零误差项将是 $\\xi^7$ 阶。\n- $\\xi^7$ 的系数：$-\\frac{3}{2 \\cdot 5040} + \\frac{3 \\cdot 128}{10 \\cdot 5040} - \\frac{1 \\cdot 2187}{30 \\cdot 5040} = \\frac{1}{151200}(-45 \\cdot 3 + 3 \\cdot 128 \\cdot 3 - 2187)$，（草稿中的计算错误）。\n让我们使用另一个求和：`(1/5040) * [ -3/2 + 384/10 - 2187/30 ] = (1/5040) * [(-45+1152-2187)/30] = (1/151200) * [-1080] = -1/140`。\n\n所以，展开式为：\n$$ h k_d(\\xi) = \\xi - \\frac{1}{140}\\xi^7 + O(\\xi^9) $$\n$$ k_d(\\xi) = \\frac{\\xi}{h} - \\frac{\\xi^7}{140h} + O\\left(\\frac{\\xi^9}{h}\\right) $$\n由于 $k = \\xi/h$，我们可以将其写为 $k_d(k) = k - \\frac{(kh)^6}{140}k + O(h^8)$。波数误差 $k_d-k$ 为 $h^6$ 阶，这与格式的设计精度一致。\n\n该误差导致了数值色散。离散相速度为 $v_{p,d} = \\frac{\\omega}{k} = \\frac{c k_d}{k} = c \\frac{k_d(\\xi)}{\\xi/h} = c \\frac{h k_d(\\xi)}{\\xi}$。\n$$ v_{p,d} = c \\left( 1 - \\frac{1}{140}\\xi^6 + O(\\xi^8) \\right) = c \\left( 1 - \\frac{1}{140}(kh)^6 + O((kh)^8) \\right) $$\n数值相速度小于 $c$（相位滞后误差），并且依赖于波数 $k$，导致不同的傅里叶分量以不同的速度传播，这就是数值色散的本质。误差对 $kh$ 的六次方依赖性表明，对于解析良好的波（即 $kh$ 较小），色散非常小。", "answer": "$$\\boxed{\\frac{1}{30h} \\left( 45 \\sin(\\xi) - 9 \\sin(2\\xi) + \\sin(3\\xi) \\right)}$$", "id": "3358119"}, {"introduction": "理论分析给出了格式的形式精度阶数，但在实际代码中验证这一性能至关重要。本动手编程练习要求您实现应用广泛的Yee FDTD格式来模拟麦克斯韦方程 [@problem_id:3358130]。通过进行数值收敛性研究，您将直接观察到全局误差如何随着网格加密而减小，从而验证理论精度阶数，并获得对模拟性能的实践性认识。", "problem": "考虑周期域上周期为 $L=1$ 的无量纲形式的一维无源麦克斯韦方程组，\n$$\n\\frac{\\partial E}{\\partial t} = -\\frac{\\partial H}{\\partial x}, \\qquad \\frac{\\partial H}{\\partial t} = -\\frac{\\partial E}{\\partial x},\n$$\n其中 $E(x,t)$ 和 $H(x,t)$ 分别表示电场和磁场分量，波速为1。场在 $x$ 方向上是光滑且周期为1的。所有三角函数中的角度必须以弧度处理。\n\n使用Yee有限差分时域格式（在空间和时间上交错）。设空间网格为 $x_i = i \\Delta x$，$i=0,1,\\dots,N_x-1$，其中 $\\Delta x = L/N_x$，并设磁场样本位于半整数索引位置 $x_{i+\\tfrac{1}{2}} = (i+\\tfrac{1}{2})\\Delta x$。时间步长为 $\\Delta t = s \\Delta x$，其中 $s$ 是无量纲的Courant数，格式的更新步骤如下\n$$\nH_{i+\\tfrac{1}{2}}^{n+\\tfrac{1}{2}} = H_{i+\\tfrac{1}{2}}^{n-\\tfrac{1}{2}} - \\frac{\\Delta t}{\\Delta x} \\left( E_{i+1}^{n} - E_{i}^{n} \\right),\n$$\n$$\nE_{i}^{n+1} = E_{i}^{n} - \\frac{\\Delta t}{\\Delta x} \\left( H_{i+\\tfrac{1}{2}}^{n+\\tfrac{1}{2}} - H_{i-\\tfrac{1}{2}}^{n+\\tfrac{1}{2}} \\right),\n$$\n有限差分应用了周期性边界条件。\n\n采用光滑精确解\n$$\nE(x,t) = \\sin\\!\\big(2\\pi (x - t)\\big), \\qquad H(x,t) = \\sin\\!\\big(2\\pi (x - t)\\big),\n$$\n该解满足连续方程。为了避免第一步更新受到启动不一致性的污染，请根据此精确解在 $t=0$ 时刻对 $E$ 进行初始化，并在 $t=-\\tfrac{1}{2}\\Delta t$ 时刻对 $H$ 进行初始化。将该格式演化至最终时间 $T=1$；如果 $T/\\Delta t$ 不是整数，则演化 $N=\\mathrm{round}(T/\\Delta t)$ 步，并在场的实际离散时刻（即电场样本的 $t_E = N\\Delta t$ 和磁场样本的 $t_H = N\\Delta t - \\tfrac{1}{2}\\Delta t$）与精确解进行比较。\n\n定义离散 $\\ell^2$ 误差\n$$\n\\varepsilon_E = \\left( \\frac{1}{N_x} \\sum_{i=0}^{N_x-1} \\left[ E_i^N - \\sin\\!\\big(2\\pi (x_i - t_E)\\big) \\right]^2 \\right)^{1/2}, \\qquad\n\\varepsilon_H = \\left( \\frac{1}{N_x} \\sum_{i=0}^{N_x-1} \\left[ H_{i+\\tfrac{1}{2}}^{N-\\tfrac{1}{2}} - \\sin\\!\\big(2\\pi (x_{i+\\tfrac{1}{2}} - t_H)\\big) \\right]^2 \\right)^{1/2},\n$$\n以及组合误差\n$$\n\\varepsilon_{\\mathrm{tot}} = \\left( \\varepsilon_E^2 + \\varepsilon_H^2 \\right)^{1/2}.\n$$\n\n对于每个固定的Courant数 $s$，考虑空间分辨率序列 $N_x \\in \\{50, 100, 200, 400\\}$，其对应的 $\\Delta x = 1/N_x$ 和 $\\Delta t = s \\Delta x$，并计算在 $T=1$ 时每个分辨率下的 $\\varepsilon_{\\mathrm{tot}}$。将固定 $s$ 下的渐近误差建模为\n$$\n\\varepsilon_{\\mathrm{tot}}(\\Delta x; s) \\approx C(s)\\, (\\Delta x)^{p(s)},\n$$\n其中 $p(s)$ 是观测到的全局精度阶，而 $C(s)$ 是在Courant数 $s$ 下的误差常数。通过在给定分辨率上对 $\\log \\varepsilon_{\\mathrm{tot}}$ 与 $\\log \\Delta x$ 进行线性回归来估计 $p(s)$ 和 $C(s)$。定义Courant数 $s$ 相对于参考Courant数 $s_{\\mathrm{ref}}$ 的误差放大因子为\n$$\n\\Gamma(s) = \\frac{C(s)}{C(s_{\\mathrm{ref}})}.\n$$\n\n您的任务是实现一个完整的程序，对Yee格式进行此项研究，计算一组Courant数下的观测阶 $p(s)$ 和放大因子 $\\Gamma(s)$，并输出结果。\n\n使用以下Courant数（无量纲）测试集：$s \\in \\{0.2, 0.5, 0.8, 0.95, 0.99\\}$。取参考Courant数为 $s_{\\mathrm{ref}} = 0.2$。对于测试集中的每个 $s$，使用上述四种空间分辨率，进行模拟，在适当的离散时间计算 $\\varepsilon_{\\mathrm{tot}}$，通过在对数-对数空间中的最小二乘线性回归估计 $p(s)$ 和 $C(s)$，然后计算 $\\Gamma(s)$。\n\n最终输出格式：您的程序应生成单行输出，其中包含五个Courant数的结果，格式为方括号内包含的逗号分隔列表。列表中的每个元素本身必须是一个包含 $p(s)$ 和 $\\Gamma(s)$ 的双元素列表，两者均报告为四舍五入到六位小数的浮点数。例如，\n$$\n\\text{[}[p(s_1),\\Gamma(s_1)], [p(s_2),\\Gamma(s_2)], \\dots \\text{]}.\n$$\n不使用物理单位；所有量均为无量纲量，且三角函数中出现的角度必须以弧度解释。", "solution": "我们从无量纲形式的无源一维麦克斯韦方程组开始，\n$$\n\\frac{\\partial E}{\\partial t} = -\\frac{\\partial H}{\\partial x}, \\qquad \\frac{\\partial H}{\\partial t} = -\\frac{\\partial E}{\\partial x},\n$$\n这是一个波速为1的对称双曲系统。一个光滑周期解是\n$$\nE(x,t) = \\sin\\!\\big(2\\pi (x - t)\\big), \\qquad H(x,t) = \\sin\\!\\big(2\\pi (x - t)\\big),\n$$\n该解满足此系统，因为 $\\frac{\\partial}{\\partial t}\\sin\\!\\big(2\\pi (x - t)\\big) = -2\\pi \\cos\\!\\big(2\\pi (x - t)\\big)$ 且 $\\frac{\\partial}{\\partial x}\\sin\\!\\big(2\\pi (x - t)\\big) = 2\\pi \\cos\\!\\big(2\\pi (x - t)\\big)$，因此 $\\frac{\\partial E}{\\partial t} = -\\frac{\\partial H}{\\partial x}$ 和 $\\frac{\\partial H}{\\partial t} = -\\frac{\\partial E}{\\partial x}$ 均成立。\n\nYee有限差分时域格式在空间和时间上都对 $E$ 和 $H$ 进行交错排列。在间距为 $\\Delta x$ 的均匀网格上，时间步长为 $\\Delta t = s \\Delta x$，其更新步骤如下\n$$\nH_{i+\\tfrac{1}{2}}^{n+\\tfrac{1}{2}} = H_{i+\\tfrac{1}{2}}^{n-\\tfrac{1}{2}} - \\frac{\\Delta t}{\\Delta x}\\left( E_{i+1}^{n} - E_{i}^{n} \\right),\n$$\n$$\nE_{i}^{n+1} = E_{i}^{n} - \\frac{\\Delta t}{\\Delta x}\\left( H_{i+\\tfrac{1}{2}}^{n+\\tfrac{1}{2}} - H_{i-\\tfrac{1}{2}}^{n+\\tfrac{1}{2}} \\right),\n$$\n其中，周期性边界条件通过环绕索引来实施，以使域边界处的差分保持一致。\n\n为了测量截断误差和观测到的全局精度阶，我们使用人造解方法，采用上面给出的光滑周期精确场，并在 $t=0$ 时刻对 $E$ 和 $t=-\\tfrac{1}{2}\\Delta t$ 时刻对 $H$ 进行一致的离散格式初始化。这消除了与渐近截断误差无关的启动瞬态。我们将场演化 $N=\\mathrm{round}(T/\\Delta t)$ 步，以达到电场时间 $t_E = N \\Delta t$ 和磁场时间 $t_H = N \\Delta t - \\tfrac{1}{2}\\Delta t$，然后计算离散 $\\ell^2$ 误差\n$$\n\\varepsilon_E = \\left( \\frac{1}{N_x} \\sum_{i=0}^{N_x-1} \\left[ E_i^N - \\sin\\!\\big(2\\pi (x_i - t_E)\\big) \\right]^2 \\right)^{1/2},\n$$\n$$\n\\varepsilon_H = \\left( \\frac{1}{N_x} \\sum_{i=0}^{N_x-1} \\left[ H_{i+\\tfrac{1}{2}}^{N-\\tfrac{1}{2}} - \\sin\\!\\big(2\\pi (x_{i+\\tfrac{1}{2}} - t_H)\\big) \\right]^2 \\right)^{1/2}.\n$$\n我们将这些误差汇总成一个组合误差范数\n$$\n\\varepsilon_{\\mathrm{tot}} = \\left( \\varepsilon_E^2 + \\varepsilon_H^2 \\right)^{1/2},\n$$\n这便于对两个场分量拟合单一的收敛率。\n\n对于一个固定的Courant数 $s$，对于光滑解，Yee格式在空间和时间上都是形式上二阶精确的。在最终时间 $T$ 的 $\\ell^2$ 范数下的全局误差预计会渐近表现为\n$$\n\\varepsilon_{\\mathrm{tot}}(\\Delta x; s) \\approx C(s)\\, (\\Delta x)^{p(s)},\n$$\n其中 $p(s)$ 是观测到的全局阶，而 $C(s)$ 是一个依赖于 $s$ 的误差常数。为了估计 $(p(s), C(s))$，我们对 $\\log \\varepsilon_{\\mathrm{tot}}$ 与 $\\log \\Delta x$ 进行线性回归，即\n$$\n\\log \\varepsilon_{\\mathrm{tot}} \\approx \\log C(s) + p(s)\\, \\log \\Delta x,\n$$\n因此，斜率得出 $p(s)$，截距得出 $\\log C(s)$，从而 $C(s) = \\exp(\\text{截距})$。相对于参考Courant数 $s_{\\mathrm{ref}}$ 的误差放大因子是\n$$\n\\Gamma(s) = \\frac{C(s)}{C(s_{\\mathrm{ref}})}.\n$$\n\n一个基于原理的补充视角是使用离散格式的傅里叶分析。结合交错更新，可以得到一维的离散色散关系，\n$$\n\\sin^2\\!\\left(\\frac{\\omega \\Delta t}{2}\\right) = s^2 \\sin^2\\!\\left(\\frac{k \\Delta x}{2}\\right),\n$$\n其中 $\\omega$ 是离散角频率，$k$ 是波数。对于小的 $\\Delta x$ 和固定的Courant数 $s$，对两边进行展开可得\n$$\n\\omega \\approx k + \\frac{(s^2 - 1)}{24} k^3 \\Delta x^2 + \\mathcal{O}(\\Delta x^4),\n$$\n这揭示了二阶色散误差，其主导系数依赖于 $s$。在一维情况下，当 $s \\to 1$ 时，主导色散误差系数趋于零，而对于较小的 $s$，该系数为负且绝对值更大。这个分析解释了尽管对于光滑解，形式阶 $p(s)$ 保持在2附近，但误差常数 $C(s)$ 如何随 $s$ 变化。在实践中，有限分辨率的准渐近效应会轻微改变观测到的 $p(s)$，特别是在Courant数接近稳定性极限或时间步数增加时，但通过对多个分辨率进行最小二乘回归可以减轻这些影响。\n\n程序的算法步骤：\n1. 对于测试集 $\\{0.2, 0.5, 0.8, 0.95, 0.99\\}$ 中的每个Courant数 $s$，为每个分辨率 $N_x \\in \\{50, 100, 200, 400\\}$ 设置 $\\Delta t = s \\Delta x$。\n2. 初始化 $E_i^0 = \\sin\\!\\big(2\\pi x_i\\big)$ 和 $H_{i+\\tfrac{1}{2}}^{-\\tfrac{1}{2}} = \\sin\\!\\big(2\\pi (x_{i+\\tfrac{1}{2}} + \\tfrac{1}{2}\\Delta t)\\big)$。\n3. 使用带周期性环绕的Yee更新演化 $N=\\mathrm{round}(1/\\Delta t)$ 步。\n4. 在 $t_E = N\\Delta t$ 和 $t_H = N\\Delta t - \\tfrac{1}{2}\\Delta t$ 时刻计算 $\\varepsilon_E$、$\\varepsilon_H$ 和 $\\varepsilon_{\\mathrm{tot}}$。\n5. 拟合 $\\log \\varepsilon_{\\mathrm{tot}}$ 与 $\\log \\Delta x$ 的关系以估计 $p(s)$ 和 $C(s)$，然后计算相对于 $s_{\\mathrm{ref}}=0.2$ 的 $\\Gamma(s)$。\n6. 将结果汇总为 $[p(s), \\Gamma(s)]$ 对的单个列表，四舍五入到六位小数，并将其打印为方括号内包含的单行逗号分隔列表。\n\n此过程将基本的麦克斯韦方程组和Yee离散化与截断误差行为和观测全局阶的有原则估计相结合，并通过误差放大因子量化了Courant数如何影响误差常数。", "answer": "```python\nimport numpy as np\n\ndef yee_1d_error(Nx: int, s: float, T: float = 1.0) - float:\n    \"\"\"\n    Compute the combined L2 error for 1D Yee FDTD at final time T for a smooth periodic solution.\n    Domain length L=1, periodic boundary conditions, nondimensional units, angles in radians.\n    \"\"\"\n    L = 1.0\n    dx = L / Nx\n    dt = s * dx\n    # Number of steps to reach approximately T; use integer number of steps and exact discrete times for error comparison.\n    Nsteps = int(np.round(T / dt))\n    tE = Nsteps * dt\n    tH = tE - 0.5 * dt\n\n    # Grid points\n    x = np.arange(Nx) * dx\n    xh = (np.arange(Nx) + 0.5) * dx  # half-index positions for H\n\n    # Initialize E at t=0 and H at t=-dt/2 using the exact solution E=H=sin(2*pi*(x - t))\n    E = np.sin(2.0 * np.pi * (x - 0.0))\n    H_minus_half = np.sin(2.0 * np.pi * (xh - (-0.5 * dt)))  # H at t = -dt/2\n\n    # Time stepping\n    cfl = dt / dx\n    for _ in range(Nsteps):\n        # Update H at n+1/2 from H at n-1/2 and E at n\n        E_forward_diff = np.roll(E, -1) - E  # periodic forward difference E_{i+1} - E_i\n        H_plus_half = H_minus_half - cfl * E_forward_diff\n\n        # Update E at n+1 from E at n and H at n+1/2\n        H_diff = H_plus_half - np.roll(H_plus_half, 1)  # periodic difference H_{i+1/2} - H_{i-1/2}\n        E_next = E - cfl * H_diff\n\n        # Advance fields\n        E = E_next\n        H_minus_half = H_plus_half\n\n    # Exact fields at discrete times\n    E_exact = np.sin(2.0 * np.pi * (x - tE))\n    H_exact = np.sin(2.0 * np.pi * (xh - tH))\n\n    # L2 errors (discrete)\n    errE = np.sqrt(np.mean((E - E_exact) ** 2))\n    errH = np.sqrt(np.mean((H_minus_half - H_exact) ** 2))\n    err_tot = np.sqrt(errE ** 2 + errH ** 2)\n    return err_tot\n\n\ndef estimate_order_and_constant(dx_vals, err_vals):\n    \"\"\"\n    Estimate p (slope) and C (exp(intercept)) from linear regression of log(err) vs log(dx).\n    \"\"\"\n    x = np.log(np.array(dx_vals))\n    y = np.log(np.array(err_vals))\n    # Fit y = a + p * x\n    p, a = np.polyfit(x, y, 1)\n    C = np.exp(a)\n    return p, C\n\n\ndef solve():\n    # Test suite Courant numbers\n    s_values = [0.2, 0.5, 0.8, 0.95, 0.99]\n    # Spatial resolutions\n    Nx_values = [50, 100, 200, 400]\n    dx_values = [1.0 / Nx for Nx in Nx_values]\n\n    # Compute errors for each s over all resolutions\n    p_list = []\n    C_list = []\n    for s in s_values:\n        errs = []\n        for Nx in Nx_values:\n            err = yee_1d_error(Nx, s, T=1.0)\n            errs.append(err)\n        p, C = estimate_order_and_constant(dx_values, errs)\n        p_list.append(p)\n        C_list.append(C)\n\n    # Reference Courant number s_ref = 0.2 is the first entry\n    C_ref = C_list[0]\n\n    # Prepare results: [p(s), Gamma(s)] rounded to six decimals\n    results = []\n    for p, C in zip(p_list, C_list):\n        gamma = C / C_ref\n        results.append([round(p, 6), round(gamma, 6)])\n\n    # Print in the exact required format\n    # A single line: list of [p, Gamma] pairs\n    print(\"[\" + \",\".join(f\"[{pair[0]},{pair[1]}]\" for pair in results) + \"]\")\n\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "3358130"}]}