{"hands_on_practices": [{"introduction": "这个练习旨在通过一个简化的、可手动计算的一维模型，帮助您掌握微动弹性带（NEB）方法的核心力学原理。通过亲手计算，您将直观地理解为何标准NEB方法中的最高能量构象（image）不会精确收敛到过渡态，从而体会到“攀爬构象”（climbing-image）修正的必要性。[@problem_id:3437572]", "problem": "考虑一个一维构型坐标 $x$，它描述了在双势阱 $V(x) = x^{4} - x^{2}$ 的两个对称相关的极小值点之间的过渡。极小值点位于 $x = -1/\\sqrt{2}$ 和 $x = +1/\\sqrt{2}$。一条离散化路径由 $N = 5$ 个构象点定义，索引为 $i = 0, 1, 2, 3, 4$，其端点固定在 $x_{0} = -1/\\sqrt{2}$ 和 $x_{4} = +1/\\sqrt{2}$。中间构象点的初始位置为 $x_{1}^{(0)} = -0.35$，$x_{2}^{(0)} = 0.02$ 和 $x_{3}^{(0)} = 0.40$。对此路径，执行一次微动弹性带 (Nudged Elastic Band, NEB) 方法的迭代，步骤如下。\n\n使用核心NEB定义：\n- 构象点 $i$ 处的切向 $\\hat{\\tau}_{i}$ 沿路径方向，对于一维单调递增路径，可视为 $\\hat{\\tau}_{i} = +1$（适用于 $i = 1, 2, 3$）。\n- 构象点 $i$ 处的势（真实）力为 $F_{i}^{V} = -\\nabla V(x_{i}) = -\\frac{dV}{dx}\\big|_{x_{i}}$。\n- 势力的垂直分量为 $F_{i}^{\\perp} = F_{i}^{V} - \\left(F_{i}^{V} \\cdot \\hat{\\tau}_{i}\\right)\\hat{\\tau}_{i}$。\n- 弹簧力的平行分量为 $F_{i}^{\\text{spr},\\parallel} = k\\left(\\left|x_{i+1} - x_{i}\\right| - \\left|x_{i} - x_{i-1}\\right|\\right)\\hat{\\tau}_{i}$，其中弹簧常数 $k = 1$。\n\n对于 $i = 1, 2, 3$，采用简单的最速下降更新 $x_{i}^{(1)} = x_{i}^{(0)} + \\eta\\left(F_{i}^{\\perp} + F_{i}^{\\text{spr},\\parallel}\\right)$，步长 $\\eta = 0.2$。保持端点固定，$x_{0}^{(1)} = x_{0}^{(0)}$ 和 $x_{4}^{(1)} = x_{4}^{(0)}$。尽管本题主题是攀爬构象微动弹性带 (Climbing-Image Nudged Elastic Band, CI-NEB)，但在本次迭代中不要应用攀爬构象修正；使用如上定义的标准NEB力。\n\n计算 $i = 1, 2, 3$ 时的 $F_{i}^{\\perp}$ 和 $F_{i}^{\\text{spr},\\parallel}$，然后计算 $i = 0, 1, 2, 3, 4$ 时更新后的位置 $x_{i}^{(1)}$。将最终更新的位置四舍五入到八位有效数字。将最终答案表示为一个单行矩阵，其中包含按顺序排列的五个更新后的位置 $\\left(x_{0}^{(1)}, x_{1}^{(1)}, x_{2}^{(1)}, x_{3}^{(1)}, x_{4}^{(1)}\\right)$。", "solution": "该问题要求针对给定的一维势和初始路径离散化，计算一次微动弹性带 (NEB) 方法的迭代。\n\n势函数由 $V(x) = x^{4} - x^{2}$ 给出。路径被离散化为 $N = 5$ 个构象点，索引为 $i = 0, 1, 2, 3, 4$。端点固定在势的极小值点，$x_{0} = -1/\\sqrt{2}$ 和 $x_{4} = +1/\\sqrt{2}$。三个中间构象点的初始位置是 $x_{1}^{(0)} = -0.35$，$x_{2}^{(0)} = 0.02$ 和 $x_{3}^{(0)} = 0.40$。位置的更新规则是一个最速下降步骤：$x_{i}^{(1)} = x_{i}^{(0)} + \\eta\\mathbf{F}_{i}^{\\text{tot}}$，其中总力为 $\\mathbf{F}_{i}^{\\text{tot}} = F_{i}^{\\perp} + F_{i}^{\\text{spr},\\parallel}$，步长为 $\\eta = 0.2$。我们将对可移动的构象点 $i = 1, 2, 3$ 执行此更新。\n\n首先，我们定义作用在每个构象点上的力。势（或“真实”）力由势的负梯度给出：\n$$F_{i}^{V} = -\\frac{dV}{dx}\\bigg|_{x_{i}} = -\\left(4x_{i}^{3} - 2x_{i}\\right) = 2x_{i} - 4x_{i}^{3}$$\n问题定义了NEB更新中使用的两个力分量：势力的垂直分量 $F_{i}^{\\perp}$ 和弹簧力的平行分量 $F_{i}^{\\text{spr},\\parallel}$。\n\n让我们分析力的垂直分量 $F_{i}^{\\perp} = F_{i}^{V} - \\left(F_{i}^{V} \\cdot \\hat{\\tau}_{i}\\right)\\hat{\\tau}_{i}$。在一维系统中，所有向量（位置、力、切向）都是共线的。切向向量 $\\hat{\\tau}_{i}$ 沿路径方向。由于初始路径坐标是单调递增的（$x_{0}^{(0)}  x_{1}^{(0)}  x_{2}^{(0)}  x_{3}^{(0)}  x_{4}^{(0)}$），每个构象点的切向向量可以由标量 $\\hat{\\tau}_{i} = +1$ 表示。在这种一维背景下，势力 $F_{i}^{V}$ 也是一个标量。点积 $\\left(F_{i}^{V} \\cdot \\hat{\\tau}_{i}\\right)$ 变为简单的标量乘法：$F_{i}^{V} \\times 1 = F_{i}^{V}$。\n因此，势力的垂直分量为：\n$$F_{i}^{\\perp} = F_{i}^{V} - (F_{i}^{V})(1) = 0$$\n这是标准NEB公式在一维中的一个已知结果：势力被完全投影掉，构象点仅在弹簧力分量的影响下移动，该分量作用是使构象点之间的间距均等。尽管该问题属于CI-NEB主题，但我们被指示不使用攀爬构象修正，这是一种克服鞍点处这种特定行为的机制。\n\n第二个力分量是弹簧力的平行分量：\n$$F_{i}^{\\text{spr},\\parallel} = k\\left(\\left|x_{i+1} - x_{i}\\right| - \\left|x_{i} - x_{i-1}\\right|\\right)\\hat{\\tau}_{i}$$\n当弹簧常数 $k = 1$ 且切向 $\\hat{\\tau}_{i} = 1$ 时，这简化为：\n$$F_{i}^{\\text{spr},\\parallel} = \\left|x_{i+1} - x_{i}\\right| - \\left|x_{i} - x_{i-1}\\right|$$\n\n现在我们可以为每个可移动的构象点计算力和更新后的位置。初始路径是：\n$x_{0}^{(0)} = -1/\\sqrt{2} \\approx -0.70710678$\n$x_{1}^{(0)} = -0.35$\n$x_{2}^{(0)} = 0.02$\n$x_{3}^{(0)} = 0.40$\n$x_{4}^{(0)} = +1/\\sqrt{2} \\approx 0.70710678$\n\n对于构象点 $i=1$：\n其相邻点是 $x_{0}^{(0)} = -1/\\sqrt{2}$ 和 $x_{2}^{(0)} = 0.02$。\n垂直力为 $F_{1}^{\\perp} = 0$。\n弹簧力为：\n$$F_{1}^{\\text{spr},\\parallel} = \\left|x_{2}^{(0)} - x_{1}^{(0)}\\right| - \\left|x_{1}^{(0)} - x_{0}^{(0)}\\right|$$\n$$F_{1}^{\\text{spr},\\parallel} = |0.02 - (-0.35)| - |-0.35 - (-1/\\sqrt{2})|$$\n$$F_{1}^{\\text{spr},\\parallel} = |0.37| - |-0.35 + 0.70710678| = 0.37 - 0.35710678 = 0.01289322$$\n用于更新的总力为 $F_{1}^{\\text{tot}} = F_{1}^{\\perp} + F_{1}^{\\text{spr},\\parallel} = 0.01289322$。\n更新后的位置是：\n$$x_{1}^{(1)} = x_{1}^{(0)} + \\eta F_{1}^{\\text{tot}} = -0.35 + 0.2 \\times (0.01289322) = -0.35 + 0.002578644 = -0.347421356$$\n\n对于构象点 $i=2$：\n其相邻点是 $x_{1}^{(0)} = -0.35$ 和 $x_{3}^{(0)} = 0.40$。\n垂直力为 $F_{2}^{\\perp} = 0$。\n弹簧力为：\n$$F_{2}^{\\text{spr},\\parallel} = \\left|x_{3}^{(0)} - x_{2}^{(0)}\\right| - \\left|x_{2}^{(0)} - x_{1}^{(0)}\\right|$$\n$$F_{2}^{\\text{spr},\\parallel} = |0.40 - 0.02| - |0.02 - (-0.35)| = |0.38| - |0.37| = 0.01$$\n用于更新的总力为 $F_{2}^{\\text{tot}} = F_{2}^{\\perp} + F_{2}^{\\text{spr},\\parallel} = 0.01$。\n更新后的位置是：\n$$x_{2}^{(1)} = x_{2}^{(0)} + \\eta F_{2}^{\\text{tot}} = 0.02 + 0.2 \\times (0.01) = 0.02 + 0.002 = 0.022$$\n\n对于构象点 $i=3$：\n其相邻点是 $x_{2}^{(0)} = 0.02$ 和 $x_{4}^{(0)} = 1/\\sqrt{2}$。\n垂直力为 $F_{3}^{\\perp} = 0$。\n弹簧力为：\n$$F_{3}^{\\text{spr},\\parallel} = \\left|x_{4}^{(0)} - x_{3}^{(0)}\\right| - \\left|x_{3}^{(0)} - x_{2}^{(0)}\\right|$$\n$$F_{3}^{\\text{spr},\\parallel} = |(1/\\sqrt{2}) - 0.40| - |0.40 - 0.02|$$\n$$F_{3}^{\\text{spr},\\parallel} = |0.70710678 - 0.40| - |0.38| = 0.30710678 - 0.38 = -0.07289322$$\n用于更新的总力为 $F_{3}^{\\text{tot}} = F_{3}^{\\perp} + F_{3}^{\\text{spr},\\parallel} = -0.07289322$。\n更新后的位置是：\n$$x_{3}^{(1)} = x_{3}^{(0)} + \\eta F_{3}^{\\text{tot}} = 0.40 + 0.2 \\times (-0.07289322) = 0.40 - 0.014578644 = 0.385421356$$\n\n端点保持固定：\n$x_{0}^{(1)} = x_{0}^{(0)} = -1/\\sqrt{2} \\approx -0.70710678$\n$x_{4}^{(1)} = x_{4}^{(0)} = 1/\\sqrt{2} \\approx 0.70710678$\n\n问题要求将最终更新的位置四舍五入到八位有效数字。\n$x_{0}^{(1)} \\approx -0.70710678$\n$x_{1}^{(1)} = -0.347421356 \\approx -0.34742136$\n$x_{2}^{(1)} = 0.022 \\approx 0.022000000$\n$x_{3}^{(1)} = 0.385421356 \\approx 0.38542136$\n$x_{4}^{(1)} \\approx 0.70710678$\n\n经过一次迭代后的最终更新路径由坐标集 $(x_{0}^{(1)}, x_{1}^{(1)}, x_{2}^{(1)}, x_{3}^{(1)}, x_{4}^{(1)})$ 给出。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n-0.70710678  -0.34742136  0.02200000  0.38542136  0.70710678\n\\end{pmatrix}\n}\n$$", "id": "3437572"}, {"introduction": "在理解了标准NEB方法的局限性之后，本练习将带您实践攀爬构象（CI-NEB）方法的核心修正。您将为一个二维势能面上的路径计算攀爬力，即通过反转最高能量构象处的平行于路径的势能力分量，使其主动向过渡态攀升。这个练习是掌握CI-NEB算法精髓的关键一步。[@problem_id:3437606]", "problem": "考虑一个用作扩散势垒简化模型的二维势能面，它由标量场 $V(x,y) = (x^{2} - 1)^{2} + y^{2}$ 定义，单位为电子伏特 (eV)。两个极小值点位于 $(-1,0)$ 和 $(1,0)$，由一个位于 $(0,0)$ 的一阶鞍点隔开。极小值点之间的一条离散路径由五个构象 $\\{\\mathbf{r}_{0},\\mathbf{r}_{1},\\mathbf{r}_{2},\\mathbf{r}_{3},\\mathbf{r}_{4}\\}$ 表示，其端点固定为 $\\mathbf{r}_{0} = (-1,0)$ 和 $\\mathbf{r}_{4} = (1,0)$，当前内部位置为\n$\\mathbf{r}_{1} = (-0.4, 0.2)$，$\\mathbf{r}_{2} = (0.0, 0.1)$ 和 $\\mathbf{r}_{3} = (0.3, -0.1)$。\n您将从第一性原理和核心定义出发，对能量最高的构象执行一次“攀爬构象微动弹性带方法”（Climbing-Image Nudged Elastic Band, CI-NEB）的迭代。\n\n假设以下建模前提：\n- 内部构象 $i$ 处的路径切线是通过将其两个相邻构象连接的弦进行归一化得到的单位向量，$\\hat{\\boldsymbol{\\tau}}_{i} = \\dfrac{\\mathbf{r}_{i+1} - \\mathbf{r}_{i-1}}{\\lVert \\mathbf{r}_{i+1} - \\mathbf{r}_{i-1}\\rVert}$。\n- 由势能产生的真实力为 $-\\nabla V$。\n- 平行和垂直于单位方向 $\\hat{\\boldsymbol{\\tau}}$ 的矢量分量通过正交投影定义：对于任意矢量 $\\mathbf{A}$，$\\mathbf{A}^{\\parallel} = (\\mathbf{A}\\cdot \\hat{\\boldsymbol{\\tau}})\\hat{\\boldsymbol{\\tau}}$ 且 $\\mathbf{A}^{\\perp} = \\mathbf{A} - \\mathbf{A}^{\\parallel}$。\n\n将具有最高势能的内部构象视为攀爬构象。对该构象，构建真实力的平行和垂直分量，并根据该方法的定义应用攀爬构象修正。然后使用步长参数 $h = 0.5$ 对攀爬构象执行一次显式欧拉位置更新：\n$\\mathbf{r}_{i}^{\\text{new}} = \\mathbf{r}_{i}^{\\text{old}} + h\\,\\mathbf{F}_{i}^{\\text{CI}}$，\n其中 $\\mathbf{F}_{i}^{\\text{CI}}$ 是您根据上述原理构建的总攀爬构象力。\n\n从给定位置开始，对能量最高的构象 $i$ 执行以下操作：\n1. 通过计算内部构象处的 $V(\\mathbf{r}_{i})$ 来确定攀爬构象的索引 $i$。\n2. 根据其相邻构象计算切线 $\\hat{\\boldsymbol{\\tau}}_{i}$。\n3. 在 $\\mathbf{r}_{i}$ 处计算梯度 $\\nabla V$，然后使用上述投影定义将真实力 $-\\nabla V$ 分解为 $\\mathbf{F}_{i}^{\\parallel}$ 和 $\\mathbf{F}_{i}^{\\perp}$。\n4. 根据攀爬构象修正，为该构象构建攀爬构象力 $\\mathbf{F}_{i}^{\\text{CI}}$。\n5. 使用给定的欧拉步长更新攀爬构象的位置。\n6. 计算更新后的能量 $V(\\mathbf{r}_{i}^{\\text{new}})$。\n\n报告攀爬构象更新后的能量 $V(\\mathbf{r}_{i}^{\\text{new}})$ 作为您的最终答案，单位为 eV。将您的答案四舍五入到四位有效数字。以 eV 表示最终能量。", "solution": "解答过程遵循问题陈述中概述的六个步骤。\n\n**1. 确定攀爬构象**\n对每个内部构象 $\\mathbf{r}_i = (x_i, y_i)$ 计算其势能 $V(\\mathbf{r}_i)$。\n势能函数为 $V(x,y) = (x^{2} - 1)^{2} + y^{2}$。\n\n对于构象 $\\mathbf{r}_{1} = (-0.4, 0.2)$：\n$$V(\\mathbf{r}_{1}) = ((-0.4)^{2} - 1)^{2} + (0.2)^{2} = (0.16 - 1)^{2} + 0.04 = (-0.84)^{2} + 0.04 = 0.7056 + 0.04 = 0.7456 \\, \\text{eV}$$\n\n对于构象 $\\mathbf{r}_{2} = (0.0, 0.1)$：\n$$V(\\mathbf{r}_{2}) = ((0.0)^{2} - 1)^{2} + (0.1)^{2} = (-1)^{2} + 0.01 = 1 + 0.01 = 1.01 \\, \\text{eV}$$\n\n对于构象 $\\mathbf{r}_{3} = (0.3, -0.1)$：\n$$V(\\mathbf{r}_{3}) = ((0.3)^{2} - 1)^{2} + (-0.1)^{2} = (0.09 - 1)^{2} + 0.01 = (-0.91)^{2} + 0.01 = 0.8281 + 0.01 = 0.8381 \\, \\text{eV}$$\n\n比较能量，$V(\\mathbf{r}_2)  V(\\mathbf{r}_3)  V(\\mathbf{r}_1)$。势能最高的构象是 $\\mathbf{r}_{2}$。因此，攀爬构象是构象 $i=2$。\n\n**2. 计算切线 $\\hat{\\boldsymbol{\\tau}}_{2}$**\n$\\mathbf{r}_2$ 处的切线由其相邻构象 $\\mathbf{r}_1$ 和 $\\mathbf{r}_3$ 决定。\n$$\\mathbf{r}_{3} - \\mathbf{r}_{1} = (0.3 - (-0.4), -0.1 - 0.2) = (0.7, -0.3)$$\n该向量的模为：\n$$\\lVert \\mathbf{r}_{3} - \\mathbf{r}_{1} \\rVert = \\sqrt{(0.7)^{2} + (-0.3)^{2}} = \\sqrt{0.49 + 0.09} = \\sqrt{0.58}$$\n单位切向量为：\n$$\\hat{\\boldsymbol{\\tau}}_{2} = \\frac{\\mathbf{r}_{3} - \\mathbf{r}_{1}}{\\lVert \\mathbf{r}_{3} - \\mathbf{r}_{1} \\rVert} = \\frac{1}{\\sqrt{0.58}}(0.7, -0.3)$$\n\n**3. 计算梯度并分解真实力**\n势函数 $V(x,y) = (x^2-1)^2+y^2 = x^4-2x^2+1+y^2$ 的梯度为：\n$$\\nabla V = \\left( \\frac{\\partial V}{\\partial x}, \\frac{\\partial V}{\\partial y} \\right) = (4x^{3} - 4x, 2y)$$\n在攀爬构象的位置 $\\mathbf{r}_{2} = (0.0, 0.1)$ 处：\n$$\\nabla V |_{\\mathbf{r}_2} = (4(0.0)^{3} - 4(0.0), 2(0.1)) = (0, 0.2)$$\n真实力为 $\\mathbf{F}_{\\text{true}} = -\\nabla V |_{\\mathbf{r}_2}$：\n$$\\mathbf{F}_{\\text{true}} = (0, -0.2)$$\n该力被分解为平行于切线 $\\hat{\\boldsymbol{\\tau}}_{2}$ 的分量 ($\\mathbf{F}_{2}^{\\parallel}$) 和垂直于切线的分量 ($\\mathbf{F}_{2}^{\\perp}$)。\n$$\\mathbf{F}_{2}^{\\parallel} = (\\mathbf{F}_{\\text{true}} \\cdot \\hat{\\boldsymbol{\\tau}}_{2}) \\hat{\\boldsymbol{\\tau}}_{2}$$\n首先，计算点积：\n$$\\mathbf{F}_{\\text{true}} \\cdot \\hat{\\boldsymbol{\\tau}}_{2} = (0, -0.2) \\cdot \\frac{1}{\\sqrt{0.58}}(0.7, -0.3) = \\frac{1}{\\sqrt{0.58}} [0 \\cdot (0.7) + (-0.2) \\cdot (-0.3)] = \\frac{0.06}{\\sqrt{0.58}}$$\n现在，构建平行力向量：\n$$\\mathbf{F}_{2}^{\\parallel} = \\left(\\frac{0.06}{\\sqrt{0.58}}\\right) \\left(\\frac{1}{\\sqrt{0.58}}(0.7, -0.3)\\right) = \\frac{0.06}{0.58}(0.7, -0.3) = \\frac{6}{58}(0.7, -0.3) = \\frac{3}{29}(0.7, -0.3)$$\n$$\\mathbf{F}_{2}^{\\parallel} = \\left(\\frac{2.1}{29}, -\\frac{0.9}{29}\\right)$$\n\n**4. 构建攀爬构象力 $\\mathbf{F}_{2}^{\\text{CI}}$**\n对于攀爬构象，其受力被修正为 $\\mathbf{F}_{i}^{\\text{CI}} = \\mathbf{F}_{i}^{\\perp} - \\mathbf{F}_{i}^{\\parallel}$。这等同于 $\\mathbf{F}_{\\text{true}} - 2 \\mathbf{F}_{i}^{\\parallel}$。\n$$\\mathbf{F}_{2}^{\\text{CI}} = (0, -0.2) - 2 \\left(\\frac{2.1}{29}, -\\frac{0.9}{29}\\right) = (0, -0.2) - \\left(\\frac{4.2}{29}, -\\frac{1.8}{29}\\right)$$\n$$\\mathbf{F}_{2}^{\\text{CI}} = \\left(-\\frac{4.2}{29}, -0.2 + \\frac{1.8}{29}\\right) = \\left(-\\frac{4.2}{29}, -\\frac{5.8}{29} + \\frac{1.8}{29}\\right) = \\left(-\\frac{4.2}{29}, -\\frac{4.0}{29}\\right)$$\n\n**5. 更新攀爬构象的位置**\n使用步长 $h=0.5$ 的显式欧拉法更新位置。\n$$\\mathbf{r}_{2}^{\\text{new}} = \\mathbf{r}_{2}^{\\text{old}} + h\\,\\mathbf{F}_{2}^{\\text{CI}}$$\n$$\\mathbf{r}_{2}^{\\text{new}} = (0.0, 0.1) + 0.5 \\left(-\\frac{4.2}{29}, -\\frac{4.0}{29}\\right) = (0, 0.1) + \\left(-\\frac{2.1}{29}, -\\frac{2.0}{29}\\right)$$\n新坐标为：\n$$x_{2}^{\\text{new}} = -\\frac{2.1}{29}$$\n$$y_{2}^{\\text{new}} = 0.1 - \\frac{2.0}{29} = \\frac{1}{10} - \\frac{2}{29} = \\frac{29 - 20}{290} = \\frac{9}{290}$$\n所以，新位置为 $\\mathbf{r}_{2}^{\\text{new}} = \\left(-\\frac{2.1}{29}, \\frac{9}{290}\\right)$。\n\n**6. 计算更新后的能量 $V(\\mathbf{r}_{2}^{\\text{new}})$**\n新位置处的能量计算如下：\n$$V(\\mathbf{r}_{2}^{\\text{new}}) = \\left( \\left(x_{2}^{\\text{new}}\\right)^{2} - 1 \\right)^{2} + \\left(y_{2}^{\\text{new}}\\right)^{2}$$\n$$V(\\mathbf{r}_{2}^{\\text{new}}) = \\left( \\left(-\\frac{2.1}{29}\\right)^{2} - 1 \\right)^{2} + \\left(\\frac{9}{290}\\right)^{2}$$\n对各项进行数值计算：\n$$x_{2}^{\\text{new}} = -\\frac{2.1}{29} \\approx -0.07241379$$\n$$y_{2}^{\\text{new}} = \\frac{9}{290} \\approx 0.03103448$$\n$$V(\\mathbf{r}_{2}^{\\text{new}}) \\approx ((-0.07241379)^{2} - 1)^{2} + (0.03103448)^{2}$$\n$$V(\\mathbf{r}_{2}^{\\text{new}}) \\approx (0.00524376 - 1)^{2} + 0.00096314$$\n$$V(\\mathbf{r}_{2}^{\\text{new}}) \\approx (-0.99475624)^{2} + 0.00096314$$\n$$V(\\mathbf{r}_{2}^{\\text{new}}) \\approx 0.98954002 + 0.00096314 = 0.99050316 \\, \\text{eV}$$\n将结果四舍五入到四位有效数字，得到 $0.9905$。", "answer": "$$\n\\boxed{0.9905}\n$$", "id": "3437606"}, {"introduction": "当CI-NEB计算收敛后，一个至关重要的步骤是验证找到的驻点确实是一阶鞍点，即过渡态。本练习要求您编写一个程序，通过计算收敛后的攀爬构象处的赫斯矩阵（Hessian matrix）并分析其本征值，来完成这一验证过程。这是连接CI-NEB计算结果与过渡态理论定义的关键实践，也是科研工作流中的标准操作。[@problem_id:3471062]", "problem": "设计并实现一个完整的、可运行的程序，该程序针对一组通过攀爬构象微动弹性带 (Climbing-Image Nudged Elastic Band, CI-NEB) 方法收敛后得到的指定攀爬构象几何构型，计算攀爬构象点上势能的Hessian矩阵，并验证对于一个$N$原子系统，恰好有一个特征值为负，其余$3N-1$个特征值为非负。该程序必须基于第一性原理：Hessian矩阵定义为势能函数相对于所有笛卡尔坐标的二阶偏导数矩阵。使用以下基本原理：(i) 势能面是$\\mathbb{R}^{3N}$上的一个标量场$V(\\mathbf{x})$，(ii) 梯度为$\\nabla V$，(iii) Hessian矩阵是梯度的雅可比矩阵，(iv) 二阶泰勒展开通过Hessian矩阵描述局部曲率。除下述势函数明确定义的对称性外，不得假定任何特殊的对称性。将所有物理量视为无量纲量。\n\n通过直接应用于能量的对称中心有限差分法来数值实现Hessian矩阵：\n- 对于对角线元素，使用\n$$\nH_{ii} \\approx \\frac{V(\\mathbf{x}+h\\mathbf{e}_i) - 2 V(\\mathbf{x}) + V(\\mathbf{x}-h\\mathbf{e}_i)}{h^2}.\n$$\n- 对于非对角线元素，使用\n$$\nH_{ij} \\approx \\frac{V(\\mathbf{x}+h\\mathbf{e}_i+h\\mathbf{e}_j) - V(\\mathbf{x}+h\\mathbf{e}_i-h\\mathbf{e}_j) - V(\\mathbf{x}-h\\mathbf{e}_i+h\\mathbf{e}_j) + V(\\mathbf{x}-h\\mathbf{e}_i-h\\mathbf{e}_j)}{4h^2}, \\quad i\\neq j.\n$$\n对所有测试用例使用固定的步长$h=10^{-4}$。在获得对称的Hessian矩阵后，计算其所有特征值。如果一个特征值$\\lambda  -\\tau$，则将其归类为负值，否则归类为非负值。其中$\\tau=10^{-6}$是一个固定的数值容差，用于稳健地处理接近零的模。\n\n你的程序必须为每个测试用例验证是否存在恰好$1$个负特征值和恰好$3N-1$个非负特征值。请注意，非负特征值包括零特征值，这可能由整体平移和旋转等连续对称性引起。每个测试的最终结果必须是一个布尔值。\n\n测试套件。实现以下四个独立的测试用例。在每个用例中，$\\mathbf{x}\\in \\mathbb{R}^{3N}$将所有原子的笛卡尔坐标堆叠为$(x_1,y_1,z_1,\\ldots,x_N,y_N,z_N)$，所提供的几何构型是收敛的攀爬构象（$V$上的一个驻点）。所有能量和坐标均为无量纲量。\n\n- 测试 $1$（单原子四次鞍点，理想情况）：\n  - $N=1$。\n  - 势能 $V(\\mathbf{x}) = a x^4 - b x^2 + \\frac{k}{2}(y^2+z^2)$，参数为 $a=1.0$, $b=1.5$, $k=2.0$。\n  - 攀爬构象几何构型 $\\mathbf{x}=(0,0,0)$。\n\n- 测试 $2$（具有径向四次势垒的双原子中心势，平移和旋转零模）：\n  - $N=2$。\n  - 令 $\\mathbf{r}=\\mathbf{r}_2-\\mathbf{r}_1$, $r=\\|\\mathbf{r}\\|$。势能 $V(\\mathbf{x})=a(r-r_c)^4 - b(r-r_c)^2$，参数为 $a=1.0$, $b=2.0$, $r_c=1.0$。\n  - 攀爬构象几何构型 $\\mathbf{r}_1=(0,0,0)$, $\\mathbf{r}_2=(1.0,0,0)$，因此 $r=r_c$。\n\n- 测试 $3$（由线性反应坐标构建的三原子一阶鞍点）：\n  - $N=3$。\n  - 令一个固定的单位向量 $\\mathbf{w}\\in\\mathbb{R}^{9}$ 定义反应坐标 $s=\\mathbf{w}^\\top \\mathbf{x}$，并定义正交投影 $\\mathbf{P}_\\perp=\\mathbf{I}-\\mathbf{w}\\mathbf{w}^\\top$，使得 $\\mathbf{P}_\\perp \\mathbf{x}$ 提取与 $\\mathbf{w}$ 正交的分量。势能为\n    $$\n    V(\\mathbf{x}) = a s^4 - b s^2 + \\frac{k}{2}\\|\\mathbf{P}_\\perp \\mathbf{x}\\|^2,\n    $$\n    参数为 $a=1.0$, $b=1.0$, $k=0.7$。使用显式向量\n    $$\n    \\mathbf{w}=\\frac{1}{\\sqrt{4}}\\,[1,\\,-1,\\,0,\\,0,\\,0,\\,1,\\,0,\\,0,\\,-1]^\\top,\n    $$\n    该向量已被归一化。攀爬构象几何构型 $\\mathbf{x}=\\mathbf{0}\\in\\mathbb{R}^9$。\n\n- 测试 $4$（具有近零横向刚度的单原子鞍点，容差的边界情况）：\n  - $N=1$。\n  - 势能 $V(\\mathbf{x}) = a x^4 - b x^2 + \\frac{k_\\perp}{2}(y^2+z^2)$，参数为 $a=1.0$, $b=1.0$, $k_\\perp=10^{-8}$。\n  - 攀爬构象几何构型 $\\mathbf{x}=(0,0,0)$。\n\n所需输出。你的程序应生成单行输出，其中包含一个用方括号括起来的、以逗号分隔的小写布尔值列表（例如，$[\\text{true},\\text{false},\\text{true},\\text{true}]$），按顺序对应测试 1 到测试 4 的结果。\n\n评分标准。对于每个测试，当且仅当存在恰好 $1$ 个负特征值和恰好 $3N-1$ 个非负特征值时，返回 $\\text{true}$；否则返回 $\\text{false}$。程序必须是自包含的，不需要用户输入，并使用指定的数值参数 $h=10^{-4}$ 和 $\\tau=10^{-6}$。", "solution": "### 一阶鞍点验证简介\n\n该问题要求我们验证给定势能面 $V(\\mathbf{x})$ 上的特定点是否为一阶鞍点。在计算化学和材料科学的背景下，一阶鞍点或称过渡态，代表了连接两个局部极小值之间的最小能量路径 (MEP) 上的最大能垒。攀爬构象微动弹性带 (CI-NEB) 方法是一种旨在将一个“构象”（系统几何构型的离散表示）收敛到这样一个鞍点的算法。\n\n势能面 $V(\\mathbf{x})$ 上的驻点 $\\mathbf{x}_0$ 由梯度为零的条件定义：$\\nabla V(\\mathbf{x}_0) = \\mathbf{0}$。该驻点的性质（极小值点、极大值点或鞍点）由该点处曲面的曲率决定。这种曲率在数学上由Hessian矩阵 $\\mathbf{H}$ 描述，该矩阵是势能相对于系统 $D=3N$ 个笛卡尔坐标的所有二阶偏导数组成的矩阵：\n$$\nH_{ij} = \\frac{\\partial^2 V}{\\partial x_i \\partial x_j}\n$$\n一阶鞍点是Hessian矩阵恰好有一个负特征值的驻点。与此负特征值对应的特征向量指明了反应坐标的方向，即从鞍点出发朝向相连的极小值点的最速下降路径。其余的 $D-1 = 3N-1$ 个特征值为非负，对应于势能处于局部极小值的方向。零特征值，或称“零模”，对应于构型空间中势能保持不变的方向，例如整个系统的整体平移和旋转。\n\n### Hessian矩阵的数值计算\n\n由于Hessian矩阵的解析形式可能很复杂或无法获得，我们的任务是使用有限差分法对其进行数值计算。Hessian矩阵是一个对称矩阵，$\\mathbf{H} = \\mathbf{H}^\\top$。问题提供了具体的、二阶精度的中心差分公式。\n\n对于对角元素 ($i=j$)，公式为：\n$$\nH_{ii} \\approx \\frac{V(\\mathbf{x}+h\\mathbf{e}_i) - 2 V(\\mathbf{x}) + V(\\mathbf{x}-h\\mathbf{e}_i)}{h^2}\n$$\n其中 $\\mathbf{x}$ 是驻点的坐标向量，$h$ 是一个很小的步长，$\\mathbf{e}_i$ 是沿第 $i$ 个坐标轴的单位向量。\n\n对于非对角元素 ($i \\neq j$)，公式为：\n$$\nH_{ij} \\approx \\frac{V(\\mathbf{x}+h\\mathbf{e}_i+h\\mathbf{e}_j) - V(\\mathbf{x}+h\\mathbf{e}_i-h\\mathbf{e}_j) - V(\\mathbf{x}-h\\mathbf{e}_i+h\\mathbf{e}_j) + V(\\mathbf{x}-h\\mathbf{e}_i-h\\mathbf{e}_j)}{4h^2}\n$$\n这些公式源于多变量函数 $V(\\mathbf{x})$ 的泰勒级数展开。数值微分使用 $h=10^{-4}$ 的固定步长。\n\n### 特征值分析与验证\n\n一旦构建了 $3N \\times 3N$ 的对称Hessian矩阵 $\\mathbf{H}$，便计算其特征值 $\\{\\lambda_k\\}_{k=1}^{3N}$。问题为这些特征值的分类定义了一个稳健的标准。由于数值精度的限制，那些本应精确为零的特征值（例如，对应平移或旋转模）可能会被计算为非常小的正数或负数。为了解决这个问题，引入了一个容差 $\\tau=10^{-6}$。\n- 如果一个特征值 $\\lambda  -\\tau$，则归类为**负值**。\n- 如果一个特征值 $\\lambda \\ge -\\tau$，则归类为**非负值**。\n\n每个测试用例的验证过程包括计算所有 $3N$ 个特征值，并确认负特征值的数量恰好为一个。如果此条件成立，则该点是一个有效的一阶鞍点。\n\n### 算法实现策略\n\n程序被设计为按顺序解决四个测试用例中的每一个。\n\n1.  **主循环**：一个主函数遍历四个测试用例。对于每个用例，它定义了特定的势能函数 $V(\\mathbf{x})$、原子数 $N$ 以及攀爬构象的坐标 $\\mathbf{x}_0$。\n\n2.  **势能函数**：为每个测试用例实现一个专用的 Python 函数来实现势能 $V(\\mathbf{x})$。这些函数接受一个代表系统坐标的 NumPy 数组，并返回一个标量能量值。\n\n3.  **Hessian矩阵构建**：实现了一个通用函数 `calculate_hessian`。它接受 $V(\\mathbf{x})$、$\\mathbf{x}_0$、$N$ 和 $h$ 作为输入。通过系统地应用所提供的有限差分公式计算对角和非对角元素，来构建 $3N \\times 3N$ 的Hessian矩阵。为确保正确性，它遍历所有索引对 $(i, j)$ 并在所需的位移坐标上计算 $V$。\n\n4.  **验证**：构建Hessian矩阵后，使用 `numpy.linalg.eigh` 计算其特征值，该函数针对对称矩阵进行了优化。然后根据条件 $\\lambda  -\\tau$ 对特征值进行计数。如果负特征值的数量恰好为 $1$，则函数返回 `True`，否则返回 `False`。\n\n5.  **输出格式化**：将每个测试用例的布尔结果收集到一个列表中，转换为小写字符串，并以所需的格式 `[result1,result2,result3,result4]` 打印。\n\n### 测试用例分析\n\n- **测试 1（$N=1$ 四次鞍点）**：一个简单的三维势。在 $\\mathbf{x}=(0,0,0)$ 处的解析Hessian矩阵是对角的，特征值为 $\\{-3, 2, 2\\}$。这是一个典型的一阶鞍点，预期结果为 `True`。\n\n- **测试 2（$N=2$ 中心势）**：该势仅取决于原子间距 $r$。系统具有平移和旋转对称性。在给定几何构型 $r=r_c=1.0$ 处，沿键伸缩方向的曲率为负。我们预期有一个对应于该模式的负特征值，以及五个零特征值（三个用于平移，两个用于线性双原子分子的旋转）。其余的 $3N-1=5$ 个特征值应为非负。预期结果为 `True`。\n\n- **测试 3（$N=3$ 线性反应坐标）**：这是一个使用投影算子构建的更抽象的 $9$ 维势。该势在特定方向 $\\mathbf{w}$ 上不稳定，而在与 $\\mathbf{w}$ 正交的 $8$ 维子空间中是稳定的。我们预期有一个负特征值和八个正特征值。预期结果为 `True`。\n\n- **测试 4（$N=1$ 具有近零刚度）**：这与测试 1 类似，但在 $y$ 和 $z$ 方向上的刚度 $k_\\perp$ 非常小 ($10^{-8}$) 。特征值将约为 $\\{-2, 10^{-8}, 10^{-8}\\}$。这测试了容差 $\\tau=10^{-6}$ 的实现。由于 $10^{-8} > -10^{-6}$，这些特征值被正确地归类为非负值。预期结果为 `True`。\n\n这种系统化的方法确保了实现是对问题陈述中描述的基于第一性原理的验证过程的直接和忠实的执行。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the Hessian verification for all test cases.\n    \"\"\"\n    \n    # Global parameters as defined in the problem statement\n    H_STEP = 1e-4\n    EIG_TOLERANCE = 1e-6\n\n    def calculate_hessian(V_func, x0, D, h):\n        \"\"\"\n        Calculates the Hessian matrix for a potential V_func at point x0.\n\n        Args:\n            V_func (callable): The potential energy function V(x).\n            x0 (np.ndarray): The point at which to calculate the Hessian.\n            D (int): The dimension of the coordinate space (3*N).\n            h (float): The step size for finite differences.\n\n        Returns:\n            np.ndarray: The D x D Hessian matrix.\n        \"\"\"\n        H = np.zeros((D, D))\n        V0 = V_func(x0)\n\n        # Diagonal elements H_ii\n        for i in range(D):\n            x_p = x0.copy()\n            x_m = x0.copy()\n            x_p[i] += h\n            x_m[i] -= h\n            V_p = V_func(x_p)\n            V_m = V_func(x_m)\n            H[i, i] = (V_p - 2 * V0 + V_m) / (h**2)\n\n        # Off-diagonal elements H_ij\n        for i in range(D):\n            for j in range(i + 1, D):\n                x_pp = x0.copy()\n                x_pm = x0.copy()\n                x_mp = x0.copy()\n                x_mm = x0.copy()\n\n                x_pp[i] += h\n                x_pp[j] += h\n\n                x_pm[i] += h\n                x_pm[j] -= h\n\n                x_mp[i] -= h\n                x_mp[j] += h\n\n                x_mm[i] -= h\n                x_mm[j] -= h\n\n                V_pp = V_func(x_pp)\n                V_pm = V_func(x_pm)\n                V_mp = V_func(x_mp)\n                V_mm = V_func(x_mm)\n                \n                val = (V_pp - V_pm - V_mp + V_mm) / (4 * h**2)\n                H[i, j] = val\n                H[j, i] = val\n        \n        return H\n\n    def verify_saddle_point(V_func, x0, N, h, tau):\n        \"\"\"\n        Verifies if a point is a first-order saddle point.\n        \n        Args:\n            V_func (callable): The potential energy function V(x).\n            x0 (np.ndarray): The geometry of the climbing image.\n            N (int): The number of atoms.\n            h (float): The finite difference step size.\n            tau (float): The tolerance for classifying eigenvalues.\n            \n        Returns:\n            bool: True if there is exactly 1 negative eigenvalue, False otherwise.\n        \"\"\"\n        D = 3 * N\n        hessian = calculate_hessian(V_func, x0, D, h)\n        \n        # Use np.linalg.eigh for symmetric matrices\n        eigenvalues = np.linalg.eigvalsh(hessian)\n        \n        negative_eigenvalue_count = np.sum(eigenvalues  -tau)\n        \n        # The condition for a first-order saddle point is exactly one negative eigenvalue.\n        # The total number of eigenvalues is 3N. If one is negative, the other 3N-1 must\n        # be non-negative, so this single check is sufficient.\n        return negative_eigenvalue_count == 1\n\n    # --- Test Cases ---\n    \n    test_suite = []\n\n    # Test 1: Single-atom quartic saddle\n    def setup_test1():\n        N = 1\n        a, b, k = 1.0, 1.5, 2.0\n        x0 = np.array([0.0, 0.0, 0.0])\n        def V_func(x_vec):\n            x, y, z = x_vec[0], x_vec[1], x_vec[2]\n            return a * x**4 - b * x**2 + 0.5 * k * (y**2 + z**2)\n        return V_func, x0, N\n    test_suite.append(setup_test1())\n\n    # Test 2: Two-atom central potential\n    def setup_test2():\n        N = 2\n        a, b, rc = 1.0, 2.0, 1.0\n        x0 = np.array([0.0, 0.0, 0.0, 1.0, 0.0, 0.0])\n        def V_func(x_vec):\n            r1 = x_vec[0:3]\n            r2 = x_vec[3:6]\n            r_vec = r2 - r1\n            r = np.linalg.norm(r_vec)\n            return a * (r - rc)**4 - b * (r - rc)**2\n        return V_func, x0, N\n    test_suite.append(setup_test2())\n    \n    # Test 3: Three-atom index-1 saddle\n    def setup_test3():\n        N = 3\n        a, b, k = 1.0, 1.0, 0.7\n        x0 = np.zeros(9)\n        w = np.array([1.0, -1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, -1.0]) / np.sqrt(4.0)\n        def V_func(x_vec):\n            s = np.dot(w, x_vec)\n            # P_perp_x = x - (w^T x)w\n            P_perp_x = x_vec - s * w\n            norm_sq_P_perp_x = np.dot(P_perp_x, P_perp_x)\n            return a * s**4 - b * s**2 + 0.5 * k * norm_sq_P_perp_x\n        return V_func, x0, N\n    test_suite.append(setup_test3())\n\n    # Test 4: Single-atom saddle with near-zero transverse stiffness\n    def setup_test4():\n        N = 1\n        a, b, k_perp = 1.0, 1.0, 1e-8\n        x0 = np.array([0.0, 0.0, 0.0])\n        def V_func(x_vec):\n            x, y, z = x_vec[0], x_vec[1], x_vec[2]\n            return a * x**4 - b * x**2 + 0.5 * k_perp * (y**2 + z**2)\n        return V_func, x0, N\n    test_suite.append(setup_test4())\n\n    # Run all tests and collect results\n    results = []\n    for V_f, x_0, n_atoms in test_suite:\n        is_saddle = verify_saddle_point(V_f, x_0, n_atoms, H_STEP, EIG_TOLERANCE)\n        results.append(str(is_saddle).lower())\n        \n    # Print results in the specified format\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "3471062"}]}