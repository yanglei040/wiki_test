{"hands_on_practices": [{"introduction": "从理论到实践的第一步是掌握表面能的基本计算方法。在密度泛函理论（DFT）计算中，最常用的方法是平板模型（slab model）。本练习将指导你完成一个典型的计算流程：首先，使用从DFT计算中获得的总能量，通过基本公式估算表面能；然后，分析并校正由模型尺寸有限（即平板厚度和真空层厚度）引起的系统误差，从而获得更精确的结果。这个过程不仅能巩固你对表面能物理定义的理解，也是评估计算结果可靠性的关键技能。[@problem_id:3490960]", "problem": "一个对称的晶体材料板层使用密度泛函理论（DFT）进行建模。该板层包含 $N$ 个原子，具有两个面积均为 $A$ 的等效表面，由厚度为 $L_{\\mathrm{vac}}$ 的真空层隔开。板层的零温总能量为 $E_{\\mathrm{slab}}$，每个原子的体相参考能量为 $E_{\\mathrm{bulk}}$。假设对于所选的晶胞，DFT总能量等于零压下的内能。\n\n从零温下表面过剩自由能的定义（即从体相材料中创造单位面积表面所需的可逆功）出发，并假设对称板层的体相和表面贡献具有可加性，推导出一个用 $E_{\\mathrm{slab}}$、$E_{\\mathrm{bulk}}$、$N$ 和 $A$ 表示的表面能 $\\gamma$ 的可计算表达式。使用此表达式，并通过下述的偏差模型校正有限板层厚度和有限真空尺寸带来的影响，计算半无限表面能 $\\gamma_{\\infty}$ 的最佳估计值。\n\n使用以下数据：\n- $E_{\\mathrm{bulk}} = -5.432 \\ \\mathrm{eV/atom}$，\n- $E_{\\mathrm{slab}} = -636.234 \\ \\mathrm{eV}$，\n- $N = 120$，\n- $A = 100 \\ \\text{\\AA}^{2}$ （每个表面），\n- $L_{\\mathrm{vac}} = 15 \\ \\text{\\AA}$，\n- 计算出的有限尺寸表面能 $\\gamma(N,L_{\\mathrm{vac}})$ 相对于半无限值 $\\gamma_{\\infty}$ 存在偏差，该偏差为两个正偏差项之和，\n  $$\\delta_{t}(N) = C_{t} \\exp\\!\\left(-\\frac{N}{\\xi}\\right), \\quad \\delta_{v}(L_{\\mathrm{vac}}) = C_{v} \\exp\\!\\left(-\\frac{L_{\\mathrm{vac}}}{\\lambda}\\right),$$\n  其中 $C_{t} = 0.12 \\ \\mathrm{J/m^{2}}$，$\\xi = 30$，$C_{v} = 0.25 \\ \\mathrm{J/m^{2}}$，且 $\\lambda = 5 \\ \\text{\\AA}$。\n\n单位换算常数：\n- $1 \\ \\mathrm{eV} = 1.602176634 \\times 10^{-19} \\ \\mathrm{J}$，\n- $1 \\ \\text{\\AA}^{2} = 1 \\times 10^{-20} \\ \\mathrm{m}^{2}$。\n\n任务：\n1. 根据上述描述，从第一性原理推导 $\\gamma(N,L_{\\mathrm{vac}})$ 的公式。\n2. 根据提供的DFT能量计算 $\\gamma(N,L_{\\mathrm{vac}})$，并将结果转换为 $\\mathrm{J/m^{2}}$。\n3. 使用偏差模型，通过消除有限尺寸偏差来计算 $\\gamma_{\\infty}$。\n4. 在你的推理中，通过量化 $\\delta_{t}(N)$ 和 $\\delta_{v}(L_{\\mathrm{vac}})$ 的各自贡献来分析误差预算，并评论在给定设置下哪个误差来源占主导地位。\n\n仅提供最终的最佳估计值 $\\gamma_{\\infty}$ 作为你的答案。将答案四舍五入到四位有效数字。以 $\\mathrm{J/m^{2}}$ 表示最终结果（在最终的方框数字中不要包含单位）。", "solution": "该问题陈述清晰且科学上合理，描述了计算材料科学中从第一性原理计算确定表面能的标准流程。因此，我们可以开始求解。\n\n问题要求逐步推导和计算半无限表面能 $\\gamma_{\\infty}$，并对板层计算中存在的有限尺寸效应进行校正。\n\n**1. 表面能公式的推导**\n\n表面能 $\\gamma$ 定义为相对于体相材料的单位面积表面的过剩自由能。在零温下，这等同于过剩内能。对于一个具有两个面积为 $A$ 的表面的对称板层模型，板层的总能量 $E_{\\mathrm{slab}}$ 被建模为等效数量（$N$个）原子在体相中的能量与创造这两个表面所需能量之和。\n\n在体相参考态中，$N$ 个原子的总能量由 $N E_{\\mathrm{bulk}}$ 给出。总的表面创造能是单位面积表面能 $\\gamma$、每个表面的面积 $A$ 以及表面数量（2个）的乘积。因此，总表面能为 $2A\\gamma$。\n\n基于可加性假设，我们可以将板层的总能量写为：\n$$E_{\\mathrm{slab}} = N E_{\\mathrm{bulk}} + 2A\\gamma$$\n这个方程描述了从包含 $N$ 个原子和真空厚度为 $L_{\\mathrm{vac}}$ 的板层计算出的有限尺寸表面能，我们将其表示为 $\\gamma(N, L_{\\mathrm{vac}})$。重新整理方程以求解该量，即可得到所需的可计算表达式：\n$$\\gamma(N, L_{\\mathrm{vac}}) = \\frac{E_{\\mathrm{slab}} - N E_{\\mathrm{bulk}}}{2A}$$\n\n**2. 有限尺寸表面能的计算**\n\n我们从密度泛函理论（DFT）计算中获得了以下数据：\n- 板层总能量：$E_{\\mathrm{slab}} = -636.234 \\ \\mathrm{eV}$\n- 每个原子的体相能量：$E_{\\mathrm{bulk}} = -5.432 \\ \\mathrm{eV/atom}$\n- 板层中的原子数：$N = 120$\n- 每个表面的面积：$A = 100 \\ \\text{\\AA}^{2}$\n\n首先，我们计算板层中的总过剩能量，即我们表达式的分子部分：\n$$E_{\\mathrm{slab}} - N E_{\\mathrm{bulk}} = -636.234 \\ \\mathrm{eV} - (120 \\times -5.432 \\ \\mathrm{eV})$$\n$$E_{\\mathrm{slab}} - N E_{\\mathrm{bulk}} = -636.234 \\ \\mathrm{eV} - (-651.84 \\ \\mathrm{eV})$$\n$$E_{\\mathrm{slab}} - N E_{\\mathrm{bulk}} = 15.606 \\ \\mathrm{eV}$$\n这个正值代表了创造这两个表面的能量代价。两个表面的总面积为 $2A = 2 \\times 100 \\ \\text{\\AA}^{2} = 200 \\ \\text{\\AA}^{2}$。\n\n现在，我们以 $\\mathrm{eV/\\text{\\AA}^2}$ 为单位计算 $\\gamma(N, L_{\\mathrm{vac}})$：\n$$\\gamma(N, L_{\\mathrm{vac}}) = \\frac{15.606 \\ \\mathrm{eV}}{200 \\ \\text{\\AA}^{2}} = 0.07803 \\ \\mathrm{eV/\\text{\\AA}^2}$$\n为了将其转换为国际单位制（SI）单位（$\\mathrm{J/m^2}$），我们使用提供的换算因子：\n- $1 \\ \\mathrm{eV} = 1.602176634 \\times 10^{-19} \\ \\mathrm{J}$\n- $1 \\ \\text{\\AA}^{2} = 1 \\times 10^{-20} \\ \\mathrm{m}^{2}$\n换算因子为：\n$$\\frac{1 \\ \\mathrm{eV}}{1 \\ \\text{\\AA}^2} = \\frac{1.602176634 \\times 10^{-19} \\ \\mathrm{J}}{1 \\times 10^{-20} \\ \\mathrm{m}^2} = 16.02176634 \\ \\mathrm{J/m^2}$$\n应用此换算：\n$$\\gamma(N, L_{\\mathrm{vac}}) = 0.07803 \\ \\mathrm{eV/\\text{\\AA}^2} \\times 16.02176634 \\ \\frac{\\mathrm{J/m^2}}{\\mathrm{eV/\\text{\\AA}^2}} \\approx 1.250167 \\ \\mathrm{J/m^2}$$\n\n**3. 半无限表面能的计算**\n\n计算得到的 $\\gamma(N, L_{\\mathrm{vac}})$ 值因板层厚度有限和真空分离距离有限而存在偏差。问题提供了一个模型，其中观测到的表面能是真实的半无限值加上两个正的偏差项：\n$$\\gamma(N, L_{\\mathrm{vac}}) = \\gamma_{\\infty} + \\delta_{t}(N) + \\delta_{v}(L_{\\mathrm{vac}})$$\n因此，半无限表面能的最佳估计值可以通过减去这些偏差得到：\n$$\\gamma_{\\infty} = \\gamma(N, L_{\\mathrm{vac}}) - \\delta_{t}(N) - \\delta_{v}(L_{\\mathrm{vac}})$$\n\n首先，我们计算由有限板层厚度引起的偏差 $\\delta_{t}(N)$：\n$$\\delta_{t}(N) = C_{t} \\exp\\left(-\\frac{N}{\\xi}\\right)$$\n使用给定的参数 $C_{t} = 0.12 \\ \\mathrm{J/m^{2}}$，$N = 120$，和 $\\xi = 30$：\n$$\\delta_{t}(120) = 0.12 \\ \\mathrm{J/m^{2}} \\times \\exp\\left(-\\frac{120}{30}\\right) = 0.12 \\times \\exp(-4) \\ \\mathrm{J/m^{2}}$$\n$$\\delta_{t}(120) \\approx 0.12 \\times 0.0183156 \\approx 0.002198 \\ \\mathrm{J/m^{2}}$$\n\n接下来，我们计算由有限真空尺寸引起的偏差 $\\delta_{v}(L_{\\mathrm{vac}})$：\n$$\\delta_{v}(L_{\\mathrm{vac}}) = C_{v} \\exp\\left(-\\frac{L_{\\mathrm{vac}}}{\\lambda}\\right)$$\n使用给定的参数 $C_{v} = 0.25 \\ \\mathrm{J/m^{2}}$，$L_{\\mathrm{vac}} = 15 \\ \\text{\\AA}$，和 $\\lambda = 5 \\ \\text{\\AA}$：\n$$\\delta_{v}(15) = 0.25 \\ \\mathrm{J/m^{2}} \\times \\exp\\left(-\\frac{15}{5}\\right) = 0.25 \\times \\exp(-3) \\ \\mathrm{J/m^{2}}$$\n$$\\delta_{v}(15) \\approx 0.25 \\times 0.0497871 \\approx 0.012447 \\ \\mathrm{J/m^{2}}$$\n\n现在我们可以计算 $\\gamma_{\\infty}$：\n$$\\gamma_{\\infty} \\approx 1.250167 \\ \\mathrm{J/m^{2}} - 0.002198 \\ \\mathrm{J/m^{2}} - 0.012447 \\ \\mathrm{J/m^{2}}$$\n$$\\gamma_{\\infty} \\approx 1.235522 \\ \\mathrm{J/m^{2}}$$\n\n根据要求将最终结果四舍五入到四位有效数字，得到 $1.236 \\ \\mathrm{J/m^{2}}$。\n\n**4. 误差预算分析**\n\n有限尺寸偏差的两个来源是穿过板层的表面间相互作用 $\\delta_{t}(N)$，以及穿过真空的表面间相互作用 $\\delta_{v}(L_{\\mathrm{vac}})$。我们已经计算出它们的贡献分别为：\n- 有限厚度偏差：$\\delta_{t}(120) \\approx 0.0022 \\ \\mathrm{J/m^{2}}$\n- 有限真空偏差：$\\delta_{v}(15) \\approx 0.0124 \\ \\mathrm{J/m^{2}}$\n\n通过比较这两个值，我们可以确定在此特定计算中误差的主要来源。偏差的比值为：\n$$\\frac{\\delta_{v}(15)}{\\delta_{t}(120)} \\approx \\frac{0.012447}{0.002198} \\approx 5.7$$\n由有限真空尺寸引起的偏差 $\\delta_{v}$ 大约是有限板层厚度引起的偏差 $\\delta_{t}$ 的 $5.7$ 倍。指数衰减参数 $N/\\xi=4$ 和 $L_{\\mathrm{vac}}/\\lambda=3$ 表明，虽然板层相当厚（将误差抑制到 $\\exp(-4)$ 的因子），但真空层的收敛性相对较差（仅将误差抑制到 $\\exp(-3)$ 的因子）。因此，对于给定的计算设置，两个板层表面穿过真空的相互作用是有限尺寸误差的主要来源。要获得更精确的计算结果，最有效的方法是增加真空厚度 $L_{\\mathrm{vac}}$。", "answer": "$$\\boxed{1.236}$$", "id": "3490960"}, {"introduction": "单点的计算结果往往是不够的，获得可靠的表面能数值需要进行系统的收敛性测试。本练习将重点关注一个至关重要的参数：平板厚度$N$。你需要设计一个系统的收敛性研究方案，并根据材料的物理特性（在此案例中为半导体）选择一个有物理依据的外推模型，以从一系列有限厚度的计算结果中推断出无限厚度极限下的表面能。这个练习旨在培养严谨的科学计算思维，确保计算结果的物理意义和准确性。[@problem_id:3491035]", "problem": "您的任务是使用密度泛函理论（DFT）中的一系列板层计算来确定一个非极性重构半导体表面的表面能 $\\,\\gamma\\,$。目标材料是一种共价半导体，具有有限的体带隙 $\\,E_g\\,$，且在费米能级处没有本征金属性表面态。您将使用周期性边界条件，对一个包含 $\\,N\\,$ 个原子层、面内面积为 $\\,A\\,$、真空层厚度为 $\\,t_v\\,$ 的周期性重复板层进行建模，并从板层总能量 $\\,E_{\\mathrm{slab}}(N)\\,$ 和一个单独收敛的每层体能量 $\\,E_{\\mathrm{bulk}}\\,$ 中提取 $\\,\\gamma\\,$。假设横向晶格参数被约束为弛豫后的体材料值，并且板层的两个表面在晶体学上是相同的，都表现出相同的 $(2\\times 1)$ 表面重构。总能计算是自旋非极化的，并在零温下进行。\n\n从 $\\,\\gamma\\,$ 是指从体材料中产生一个表面所关联的每单位面积的过剩自由能这一定义出发，并基于第一性原理推断在重复板层计算中出现的有限尺寸误差（包括穿过板层的电子态交叠、周期性边界条件下的长程静电作用、由表面应力引起的弹性耦合以及量子尺寸效应），请选择一个选项，该选项为获取这种半导体的、非极性的、对称重构表面在无限厚度极限下的 $\\,\\gamma\\,$ 值，提出了一个物理上合理且可系统验证的收敛方案和外推形式。您的选择应与费米能级处不存在金属性态、存在有限的体带隙以及固定的面内晶格参数等条件相符。\n\nA. 在固定的真空层厚度 $\\,t_v\\gtrsim 15\\,\\text{\\AA}\\,$ 下，对一系列对称板层（$\\,N\\in\\{8,12,16,20,24\\}\\,$）进行计算，其中两个表面都进行相同的重构，且面内晶格常数固定为弛豫后的体材料值。完全弛豫离子位置，但固定少数中心层在体材料位置上以定义中心平面。对于每个 $\\,N\\,$，使用共享相同数值设置的体材料和板层计算来计算 $\\,\\gamma(N) = \\big(E_{\\mathrm{slab}}(N) - N\\,E_{\\mathrm{bulk}}\\big)/(2A)\\,$。使用 $\\,\\gamma(N) = \\gamma_{\\infty} + C\\,\\exp\\!\\big(-N a/\\xi\\big)\\,$ 进行外推，其中 $\\,a\\,$ 是层间距，$\\,\\xi\\,$ 是一个作为拟合参数处理的电子衰减长度。通过对两个 $\\,N\\,$ 值使用加倍的 $\\,t_v\\,$ 重复计算，来验证 $\\,\\gamma_{\\infty}\\,$ 对 $\\,t_v\\,$ 不敏感。通过以下理由证明指数形式的合理性：在所述约束条件下，存在穿过板层的有带隙表面态的倏逝波交叠，且不存在长程静电作用或全局弹性 $\\,1/N\\,$ 项。\n\nB. 构建非对称板层，其顶层是感兴趣的重构表面，底层是氢钝化表面，弛豫所有离子，并允许面内晶格参数随 $\\,N\\,$ 变化。在真空中省略任何偶极校正。对于 $\\,N\\in\\{6,8,10,12,14\\}\\,$，计算 $\\,\\gamma(N) = \\big(E_{\\mathrm{slab}}(N) - N\\,E_{\\mathrm{bulk}}\\big)/A\\,$，并使用 $\\,\\gamma(N) = \\gamma_{\\infty} + D/N\\,$ 将 $\\,\\gamma(N)\\,$ 对 $\\,1/N\\,$ 进行线性外推，将该 $\\,1/N\\,$ 行为归因于板层偶极子和两个端面之间的弹性耦合。\n\nC. 对于同样的非极性半导体重构，构建对称板层（$\\,N\\in\\{9,11,13,15,17\\}\\,$），并基于费米能级处的量子阱态会引起类 Friedel 振荡的理由，将 $\\,\\gamma(N)\\,$ 拟合到一个振荡的代数形式 $\\,\\gamma(N) = \\gamma_{\\infty} + \\big[C\\cos(2k_F N a + \\phi)\\big]/N^2\\,$，其中 $\\,k_F\\,$ 和 $\\,\\phi\\,$ 作为拟合参数处理。\n\nD. 使用对称板层（$\\,N\\in\\{10,14,18\\}\\,$）在固定的 $\\,t_v\\,$ 下进行计算，并将 $\\,\\gamma(N)\\,$ 对 $\\,1/N\\,$ 线性拟合为 $\\,\\gamma(N) = \\gamma_{\\infty} + C/N\\,$，其论据是表面应力通常会产生一种长程弹性相互作用，即使在有带隙的材料中，这种相互作用也主导了有限尺寸误差；如果这三个点几乎在一条直线上，则接受此拟合。\n\n对于本案例，哪个选项是合适的、最具说服力的方案和外推形式？", "solution": "我们从具有两个相同表面的板层的表面能定义开始。设 $\\,E_{\\mathrm{slab}}(N)\\,$ 是一个包含 $\\,N\\,$ 个原子层、面内面积为 $\\,A\\,$ 的对称板层的总能量，并设 $\\,E_{\\mathrm{bulk}}\\,$ 表示使用一致的数值设置计算的每层体能量。表面能定义为在半无限极限下每单位表面积的过剩能量，\n$$\n\\gamma \\equiv \\lim_{N\\to\\infty}\\frac{E_{\\mathrm{slab}}(N) - N\\,E_{\\mathrm{bulk}}}{2A}.\n$$\n在实践中，人们计算 $\\,\\gamma(N) = \\big(E_{\\mathrm{slab}}(N)-N E_{\\mathrm{bulk}}\\big)/(2A)\\,$ 并将 $\\,\\gamma(N)\\,$ 外推至 $\\,N\\to\\infty\\,$。\n\n在重复板层计算中影响 $\\,\\gamma(N)\\,$ 的有限尺寸误差可以按物理来源分解为：\n\n- 穿过板层的电子态交叠：在体带隙 $\\,E_g>0\\,$ 且费米能级没有金属性表面能带穿过的半导体中，与表面微扰相关的 Kohn–Sham 态作为复能带结构的倏逝解向体材料内部衰减。如果 $\\,\\kappa\\,$ 是沿表面法线方向在带隙中波矢的最小虚部分量，则振幅按 $\\,\\exp(-\\kappa z)\\,$ 衰减，因此两个表面之间的耦合按 $\\,\\exp(-2\\kappa L)\\,$ 衰减，其中 $\\,L\\,$ 是板层厚度。等效地，对于层间距为 $\\,a\\,$ 的 $\\,N\\,$ 个原子层，这导致一个指数修正项 $\\,\\sim \\exp(-N a/\\xi)\\,$，其衰减长度为 $\\,\\xi\\sim 1/\\kappa\\,$。因此，在没有金属性表面态的有带隙系统中，$\\,\\gamma(N)\\,$ 中主要的电子有限尺寸误差与 $\\,N\\,$ 呈指数关系。\n\n- 长程静电作用：在重复板层中，沿表面法线方向的总偶极矩会在周期性边界条件下于真空区域产生一个伪影般的均匀电场，从而产生一个与原胞尺寸呈代数关系的修正项（通常为 $\\,\\sim 1/t_v\\,$ 或 $\\,\\sim 1/N\\,$，取决于设置）。对于具有相同端面的对称非极性板层，由于对称性，净偶极矩为 $\\,0\\,$，因此这个人为效应在主导项上不存在。如果板层是非对称的，则应施加偶极校正以消除该电场；否则，一个人为的 $\\,1/N\\,$ 依赖性可能会主导表观收敛性。\n\n- 弹性耦合和表面应力：如果允许面内晶格常数对每个 $\\,N\\,$ 进行弛豫，两个表面应力层可以通过有限厚度的薄膜耦合，导致一个依赖于 $\\,N\\,$ 的面内应变和每单位面积 $\\,\\sim 1/N\\,$ 标度的弹性能。然而，如果将面内晶格参数固定为体材料平衡值（旨在达到半无限极限的表面计算的通常做法），全局面内应变将被抑制；残余弹性能仍局域在每个表面附近，并且不会在 $\\,\\gamma(N)\\,$ 中产生一个主导的 $\\,1/N\\,$ 项。\n\n- 金属中的量子尺寸效应：对于金属薄膜，费米能级处态的限制会产生振荡修正，该修正按代数关系衰减，通常为 $\\,\\sim \\cos(2 k_F L + \\phi)/L^2\\,$，其中 $\\,k_F\\,$ 是费米波矢，$\\,\\phi\\,$ 是一个相位。在具有有限带隙且费米能级没有金属性表面能带穿过的半导体中，这种振荡的代数行为不存在。\n\n- 真空层厚度：周期性重复板层之间的静电和交换-相关相互作用随 $\\,t_v\\,$ 衰减。对于电中性的对称板层，主导误差随 $\\,t_v\\,$ 指数衰减，其衰减速率由面内方向的最小倒格矢和真空倏逝衰减决定；验证 $\\,\\gamma_{\\infty}\\,$ 对 $\\,t_v\\,$ 的不敏感性可以检验伪影般的原胞间相互作用是否可忽略。\n\n基于这些原理，对于一个具有固定面内晶格参数的非极性、对称、重构的半导体表面，一个合理的收敛方案应该：\n\n- 使用两个表面等效的对称板层，以避免产生净偶极矩，从而避免伪影般的静电 $\\,1/N\\,$ 项。\n- 将面内晶格常数固定为体材料值，以抑制全局弹性 $\\,1/N\\,$ 耦合。\n- 在足够宽的范围内改变 $\\,N\\,$，以分辨出指数衰减。\n- 使用一致的体材料和板层数值设置，以便进行清晰的能量参考。\n- 通过使用更大的 $\\,t_v\\,$ 进行抽查，来验证 $\\,\\gamma_{\\infty}\\,$ 对 $\\,t_v\\,$ 不敏感。\n- 将 $\\,\\gamma(N)\\,$ 拟合到指数形式，其动机是在有带隙的主体材料中表面微扰的倏逝波交叠。\n\n我们现在评估每个选项：\n\n选项 A: 该方案使用具有相同重构的对称板层，将面内晶格参数固定为体材料值，并使用共享的数值设置计算 $\\,\\gamma(N) = \\big(E_{\\mathrm{slab}}(N) - N E_{\\mathrm{bulk}}\\big)/(2A)\\,$。它提出了指数外推形式 $\\,\\gamma(N) = \\gamma_{\\infty} + C\\,\\exp(-N a/\\xi)\\,$，并通过对一个子集加倍 $\\,t_v\\,$ 来验证真空收敛性。其理由援引了穿过有带隙体材料的倏逝波交叠，以及不存在净偶极矩和全局弹性 $\\,1/N\\,$ 项。这与第一性原理的预期相符：在一个没有金属性表面态、具有对称端面和固定面内参数的半导体中，主导的有限尺寸修正与 $\\,N\\,$ 呈指数关系。对真空不敏感性和一致参考的检验是恰当的。结论：正确。\n\n选项 B: 该选项使用氢钝化的非对称板层并省略了偶极校正，然后拟合一个 $\\,1/N\\,$ 依赖关系。非对称板层会沿表面法线方向产生一个净偶极矩，在周期性边界条件下产生一个伪影般的内部电场和依赖于厚度的静电学。省略偶极校正会导致一个人为的类 $\\,1/N\\,$ 趋势，这并不能反映目标表面的本征表面能。允许面内晶格参数随 $\\,N\\,$ 变化进一步引入了弹性 $\\,1/N\\,$ 耦合，这不能代表固定体晶格下的半无限表面。此外，非对称定义中的每单位面积能量也错误地只使用了一个 $\\,A\\,$，没有仔细分离两个不同端面的贡献。结论：不正确。\n\n选项 C: 该选项假设了金属性量子尺寸效应特有的振荡代数有限尺寸效应 $\\,\\sim \\cos(2 k_F N a + \\phi)/N^2\\,$。问题指明了这是一个具有有限带隙且费米能级没有金属性表面态的半导体，因此在费米能级处没有传播态来产生类 Friedel 振荡。所以，这种外推形式不适用于所述情况。结论：不正确。\n\n选项 D: 该选项使用对称板层，但仅用三个厚度对 $\\,1/N\\,$ 进行线性拟合，其论据是表面应力通常会产生一个主导的 $\\,1/N\\,$ 项。在面内晶格参数固定为体材料值的情况下，主导的全局弹性 $\\,1/N\\,$ 项被抑制；剩余的弹性能局域在表面，不会产生主导的 $\\,1/N\\,$ 衰减。在有带隙的系统中，主导的电子耦合是指数型的。此外，仅使用三个点不足以可靠地区分指数收敛和代数收敛。结论：不正确。\n\n因此，对于给定的非极性半导体对称表面，唯一物理上合理且可系统验证的选项是选项 A。", "answer": "$$\\boxed{A}$$", "id": "3491035"}, {"introduction": "在理解了如何精确计算静态表面的能量后，一个更高级也更具挑战性的问题是研究不同表面重构之间的相变过程。这需要我们不仅知道反应物和产物的能量，还要找到它们之间的最小能量路径（MEP）和活化能垒。本练习将引导你规划一个完整的微动弹性带（Nudged Elastic Band, NEB）计算工作流程，这是当前寻找过渡态和计算活化能的标准方法。通过这个练习，你将学会如何设置初始路径、理解NEB中的力投影机制、判断计算收敛以及最终提取关键的动力学参数。[@problem_id:3491011]", "problem": "您正在使用密度泛函理论 (DFT) 模拟半导体板坯上两种亚稳态重构表面态之间的转变。该表面由一个包含 $M$ 个原子层的周期性超胞表示；底部的 $m$ 层被约束在其体相位置，并由氢原子封端以消除悬挂键，而顶部的 $M-m$ 层则完全弛豫。势能是所有原子坐标 $\\mathbf{R}$ 的函数 $E(\\mathbf{R})$，原子受到的物理力是负梯度 $-\\nabla E(\\mathbf{R})$。连接两个局部极小值的最小能量路径 (MEP) 是构型空间中的一条路径，在该路径上的每一点，垂直于路径的力的分量都为零。MEP 上唯一的一阶鞍点将活化能垒 $E_a$ 定义为鞍点与所选初始极小值之间的能量差。\n\n您的任务是规划一个微动弹性带 (NEB) 计算，以获得两种重构表面态之间的 MEP 和 $E_a$。假设两种重构在一个共同的超胞中是相称的，并且所有图像的电子结构设置（平面波截断能、$k$ 点网格、展宽）都将相同。\n\n对于此表面问题，哪个选项最好地概述了一个科学上合理且完整的 NEB 工作流程，并具体说明了初始路径生成、力投影和收敛标准？\n\nA. 使用一个可容纳两种重构的共同超胞。通过对两个弛豫端点结构之间仅未受约束的原子的笛卡尔坐标进行线性插值来生成初始路径，并在所有图像中保持底部 $m$ 层和氢封端固定。放置 $N$ 个初始间距近似均匀的中间图像。用恒定刚度 $k$ 的谐振子弹簧连接相邻图像，以保持均匀间距。在每个几何优化步骤中，根据相邻图像及其能量在图像 $i$ 处定义一个局部切线 $\\hat{\\tau}_i$ 以避免扭结，将真实力 $-\\nabla E(\\mathbf{R}_i)$ 投影到垂直于 $\\hat{\\tau}_i$ 的方向上以驱动图像到 MEP 上，并仅沿 $\\hat{\\tau}_i$ 方向施加弹簧力以控制图像的分布。一旦能带大致收敛，通过移除其弹簧力并反转真实力的平行分量，将能量最高的中间图像提升为爬升图像，以收敛到鞍点。当所有非端点图像上垂直于路径的力的分量的最大范数低于选定的阈值（例如 $0.02\\,\\text{eV}\\,\\text{\\AA}^{-1}$）、图像间距近似均匀、且端点保持在其弛豫能量时，即为收敛。将 $E_a$ 报告为爬升图像的能量（无任何弹簧贡献）与所选初始态能量之差。\n\nB. 为每个图像使用独立的 $k$ 点网格以降低成本。通过对所有原子位置（包括受约束的层）进行线性插值来生成初始路径，以确保连续性。用弹簧连接图像，并在每一步中将真实力和弹簧力都投影到垂直于路径的方向，以使图像不会沿能带滑动。当所有图像的优化步骤之间的总 DFT 能量变化小于 $10^{-4}\\,\\text{eV}$ 时收敛。将 $E_a$ 报告为最终态和初始态能量之差。\n\nC. 使用一组密集的 $N$ 个图像，通过在周期性晶胞内对分数（直接）坐标进行线性插值来初始化，允许包括底部 $m$ 层在内的所有原子移动以避免偏差。施加刚度为 $k$ 的弹簧，并在垂直和平行方向上都包含弹簧力以使能带更硬。不修改能带进行爬升；而是从能量最高的图像的总能量（包括弹簧能量贡献）中读取鞍点能量。当所有图像上的平均力大小低于 $0.05\\,\\text{eV}\\,\\text{\\AA}^{-1}$ 时收斂。将 $E_a$ 报告为最高能量图像相对于端点能量平均值的能量。\n\nD. 使用少量图像，并通过对端点结构进行随机扰动来初始化能带以避免偏差。在优化过程中，定义一个切线，并仅沿切线方向投影真实力，将其垂直分量设置为零以防止“切角”。在垂直方向施加弹簧力以使能带保持在 MEP 附近。当第一个和最后一个图像之间的弧长停止变化时收敛。将 $E_a$ 报告为最大弹簧力乘以平均图像间距。\n\n选择最佳选项。", "solution": "用户提供了一个关于在计算材料科学中规划微动弹性带 (NEB) 计算的问题陈述。第一步是验证问题陈述本身。\n\n### 问题验证\n\n**步骤1：提取已知条件**\n- **系统**：半导体板坯上两种亚稳态重构表面态之间的转变。\n- **模型**：一个包含 $M$ 个原子层的周期性超胞。\n- **约束**：底部的 $m$ 层被约束在其体相位置。\n- **边界条件**：底面由氢原子封端。\n- **自由度**：顶部的 $M-m$ 层完全弛豫。\n- **物理**：势能是 $E(\\mathbf{R})$，力是 $-\\nabla E(\\mathbf{R})$。\n- **定义**：\n    - 最小能量路径 (MEP)：路径上垂直于路径的力分量为零的路径。\n    - 活化能垒 ($E_a$)：MEP 上的一阶鞍点与初始极小值之间的能量差。\n- **任务**：选择一个最佳选项，该选项概述了寻找 MEP 和 $E_a$ 的科学上合理且完整的 NEB 工作流程。\n- **假设**：\n    - 两种重构都适用于一个共同的超胞。\n    - 所有图像的电子结构设置（平面波截断能、$k$ 点网格、展宽）都相同。\n\n**步骤2：使用提取的已知条件进行验证**\n对问题陈述的科学合理性、清晰度和完整性进行详细审查。\n\n- **科学依据**：该问题牢固地植根于计算材料科学和固态物理学的原理。使用密度泛函理论 (DFT)、带有固定层的板坯模型、氢钝化以及最小能量路径 (MEP) 的概念都是研究表面现象的标准且有效的技术。NEB 方法、MEP 和活化能垒的定义与已有的文献（例如 Henkelman、Uberuaga、Jónsson）一致。\n- **适定性**：问题是适定的。它要求对一项标准计算任务的几个提议工作流程进行评估，该任务有正确的、既定的程序。目标是在选项中识别出“最佳”（即最正确和完整）的描述。\n- **客观性**：语言是技术性的、精确的，并且没有主观或含糊的术语。所有术语都是该领域内的标准术语。\n\n**步骤3：结论与行动**\n该问题陈述科学合理、适定、客观且自洽。它描述了计算研究中的一个标准、现实的场景。未检测到任何缺陷。因此，该问题是**有效的**。解决方案将通过推导 NEB 方法的原理并评估每个选项来展开。\n\n### 正确 NEB 工作流程的推导\n\n微动弹性带 (Nudged Elastic Band, NEB) 方法是一种寻找系统已知初始态和最终态之间最小能量路径 (MEP) 的算法。该路径由一组离散的系统图像（或副本）表示，$\\lbrace \\mathbf{R}_0, \\mathbf{R}_1, \\ldots, \\mathbf{R}_N, \\mathbf{R}_{N+1} \\rbrace$，其中 $\\mathbf{R}_0$ 和 $\\mathbf{R}_{N+1}$ 分别是弛豫后的初始态和最终态。\n\n1.  **初始路径生成**：通常通过对 $\\mathbf{R}_0$ 和 $\\mathbf{R}_{N+1}$ 之间可移动原子的原子坐标进行线性插值，来生成一个合理的初始路径猜测。在给定问题的背景下，只应插值顶部 $M-m$ 层中原子的坐标，而底部 $m$ 层中的原子和封端的氢原子必须在所有图像中保持其受约束的位置。\n\n2.  **NEB 中的力**：每个中间图像 $\\mathbf{R}_i$（对于 $i=1, \\ldots, N$）都受到一个特定的 NEB 力的作用进行弛豫。这个力是两个分量的总和：\n    - 源于势能面 $E(\\mathbf{R})$ 的真实力的垂直分量。设真实力为 $\\mathbf{F}_i^{\\text{true}} = -\\nabla E(\\mathbf{R}_i)$。其垂直于局部路径切线 $\\hat{\\tau}_i$ 的分量是 $(\\mathbf{F}_i^{\\text{true}})_{\\perp}$。该分量将图像推向 MEP。\n    - 虚拟弹簧力的平行分量，$(\\mathbf{F}_i^{\\text{spring}})_{\\parallel}$。弹簧力 $\\mathbf{F}_i^{\\text{spring}}$ 在相邻图像之间作用，以确保它们大致保持等距，防止它们滑入能量极小值。仅使用其平行于路径的分量可以防止弹簧力干扰路径向 MEP 的弛豫。\n\n    因此，作用在图像 $i$ 上的总 NEB 力为：\n    $$ \\mathbf{F}_i^{\\text{NEB}} = (\\mathbf{F}_i^{\\text{true}})_{\\perp} + (\\mathbf{F}_i^{\\text{spring}})_{\\parallel} $$\n    或者，用势能梯度表示：\n    $$ \\mathbf{F}_i^{\\text{NEB}} = (-\\nabla E(\\mathbf{R}_i))_{\\perp} + (\\mathbf{F}_i^{\\text{spring}})_{\\parallel} $$\n    局部路径切线 $\\hat{\\tau}_i$ 的定义经过精心设计，通常使用基于能量的加权方案以避免路径中的扭结，如原始文献中所述。\n\n3.  **爬升图像 NEB (CI-NEB)**：标准 NEB 可能无法将图像精确定位在鞍点。CI-NEB 修改版纠正了这一点。一旦能带部分收敛，能量最高的图像 $\\mathbf{R}_{i_{\\text{max}}}$ 被指定为“爬升图像”。对于这个图像，弹簧力被移除，真实力的平行分量被反转。作用在爬升图像上的力变为：\n    $$ \\mathbf{F}_{i_{\\text{max}}}^{\\text{CI}} = (\\mathbf{F}_{i_{\\text{max}}}^{\\text{true}})_{\\perp} - (\\mathbf{F}_{i_{\\text{max}}}^{\\text{true}})_{\\parallel} = -\\nabla E(\\mathbf{R}_{i_{\\text{max}}}) + 2(\\nabla E(\\mathbf{R}_{i_{\\text{max}}}) \\cdot \\hat{\\tau}_{i_{\\text{max}}})\\hat{\\tau}_{i_{\\text{max}}} $$\n    这个力驱动图像沿 MEP 向上攀升到势能面上，以精确收敛到一阶鞍点，其中 $\\nabla E = \\mathbf{0}$。\n\n4.  **收敛和活化能垒**：当任何中间图像中任何原子上的最大力低于指定的阈值时，计算即告收敛。一个稳健的标准是基于垂直于路径的力的大小，因为它表明了向 MEP 的收敛。一旦收敛，活化能垒 $E_a$ 就被计算为收敛后的爬升图像的势能 $E(\\mathbf{R}_{i_{\\text{max}}})$ 与初始态能量 $E(\\mathbf{R}_0)$ 之差：\n    $$ E_a = E(\\mathbf{R}_{i_{\\text{max}}}) - E(\\mathbf{R}_0) $$\n    虚拟的弹簧能量不计入物理活化能垒。\n\n### 选项评估\n\n**A. 使用一个可容纳两种重构的共同超胞。通过对两个弛豫端点结构之间仅未受约束的原子的笛卡尔坐标进行线性插值来生成初始路径，并在所有图像中保持底部 $m$ 层和氢封端固定。放置 $N$ 个初始间距近似均匀的中间图像。用恒定刚度 $k$ 的谐振子弹簧连接相邻图像，以保持均匀间距。在每个几何优化步骤中，根据相邻图像及其能量在图像 $i$ 处定义一个局部切线 $\\hat{\\tau}_i$ 以避免扭结，将真实力 $-\\nabla E(\\mathbf{R}_i)$ 投影到垂直于 $\\hat{\\tau}_i$ 的方向上以驱动图像到 MEP 上，并仅沿 $\\hat{\\tau}_i$ 方向施加弹簧力以控制图像的分布。一旦能带大致收敛，通过移除其弹簧力并反转真实力的平行分量，将能量最高的中间图像提升为爬升图像，以收敛到鞍点。当所有非端点图像上垂直于路径的力的分量的最大范数低于选定的阈值（例如 $0.02\\,\\text{eV}\\,\\text{\\AA}^{-1}$）、图像间距近似均匀、且端点保持在其弛豫能量时，即为收敛。将 $E_a$ 报告为爬升图像的能量（无任何弹簧贡献）与所选初始态能量之差。**\n\n此选项周密且准确地描述了最先进的 CI-NEB 方法，并正确地应用于指定的板坯模型问题。\n- **初始路径**：正确地仅插值可移动的原子。\n- **力投影**：正确地描述了“微动”—使用垂直的真实力和水平的弹簧力。提及基于能量的切线是一个先进且正确的细节。\n- **鞍点搜索**：正确地描述了爬升图像的修改。\n- **收敛**：使用了基于力的、物理上有意义且稳健的标准。$0.02\\,\\text{eV}\\,\\text{\\AA}^{-1}$ 的示例值是高质量计算的标准值。\n- **$E_a$ 计算**：正确地将活化能垒定义为相对于初始态，使用收敛的鞍点图像的能量，且不包括虚拟的弹簧能量。\n结论：**正确**。\n\n**B. 为每个图像使用独立的 $k$ 点网格以降低成本。通过对所有原子位置（包括受约束的层）进行线性插值来生成初始路径，以确保连续性。用弹簧连接图像，并在每一步中将真实力和弹簧力都投影到垂直于路径的方向，以使图像不会沿能带滑动。当所有图像的优化步骤之间的总 DFT 能量变化小于 $10^{-4}\\,\\text{eV}$ 时收敛。将 $E_a$ 报告为最终态和初始态能量之差。**\n\n此选项包含几个基本错误。\n- **$k$ 点网格**：使用不同的网格意味着每个图像存在于不同的势能面上，这使得 MEP 成为一个不明确的概念。这是一个关键的科学错误。\n- **初始路径**：插值受约束的原子违反了问题的物理设置。\n- **力投影**：将弹簧力投影到垂直于路径的方向是错误的；它应该是平行的。将真实力投影到垂直方向是正确的，但给出的理由（“以使图像不会滑动”）不精确；移除平行真实力才是防止滑动的做法。\n- **收敛**：基于能量的收敛标准通常不如基于力的标准可靠。\n- **$E_a$ 计算**：最终态和初始态能量之差是反应能 $\\Delta E$，而不是活化能垒 $E_a$。\n结论：**错误**。\n\n**C. 使用一组密集的 $N$ 个图像，通过在周期性晶胞内对分数（直接）坐标进行线性插值来初始化，允许包括底部 $m$ 层在内的所有原子移动以避免偏差。施加刚度为 $k$ 的弹簧，并在垂直和平行方向上都包含弹簧力以使能带更硬。不修改能带进行爬升；而是从能量最高的图像的总能量（包括弹簧能量贡献）中读取鞍点能量。当所有图像上的平均力大小低于 $0.05\\,\\text{eV}\\,\\text{\\AA}^{-1}$ 时收斂。将 $E_a$ 报告为最高能量图像相对于端点能量平均值的能量。**\n\n此选项也存在根本性缺陷。\n- **初始路径**：对于定义的问题，允许受约束的原子移动是错误的。\n- **力投影**：包含垂直弹簧力直接违反了 NEB 算法的设计；它会将路径从 MEP 上拉开。\n- **鞍点搜索**：不使用爬升图像只能得到鞍点的近似值。更严重的是，将虚拟的弹簧能量包含在物理能垒计算中是一个严重的概念错误。\n- **收敛**：平均力是一个弱标准；必须控制最大力。\n- **$E_a$ 计算**：能垒必须相对于初始态计算，而不是端点的平均值（除非它们是简并的）。\n结论：**错误**。\n\n**D. 使用少量图像，并通过对端点结构进行随机扰动来初始化能带以避免偏差。在优化过程中，定义一个切线，并仅沿切线方向投影真实力，将其垂直分量设置为零以防止“切角”。在垂直方向施加弹簧力以使能带保持在 MEP 附近。当第一个和最后一个图像之间的弧长停止变化时收敛。将 $E_a$ 报告为最大弹簧力乘以平均图像间距。**\n\n此选项表明对 NEB 方法完全不理解。\n- **初始路径**：随机初始化是一个糟糕的策略，很可能导致一个高度复杂且不物理的路径，从而无法收敛。\n- **力投影**：力的投影描述完全是颠倒的。垂直真实力至关重要，*不能*设置为零。弹簧力是平行于路径施加的，而不是垂直。\n- **收敛**：弧长不是寻找像 MEP 这样的静止路径的有效收敛标准。\n- **$E_a$ 计算**：提出的 $E_a$ 计算公式毫无意义，没有物理基础。\n结论：**错误**。\n\n### 结论\n\n选项 A 是唯一描述了针对指定问题的科学有效、完整且稳健的工作流程的选项。它正确地抓住了 CI-NEB 方法的细微之处及其在现实表面科学模型中的应用。选项 B、C 和 D 在物理模型、算法和分析的多个方面都存在根本性错误。", "answer": "$$\\boxed{A}$$", "id": "3491011"}]}