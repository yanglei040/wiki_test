{"hands_on_practices": [{"introduction": "在深入研究复杂的计算方法之前，通过一个理想化的解析模型来巩固基本物理原理至关重要。这项练习将带你推导最简单的一维单原子链的声子色散关系。通过这个“纸笔”实践，你将亲手建立起原子间相互作用、牛顿运动定律以及最终的集体振动（声子）之间的联系，为后续更复杂的计算奠定概念基石。[@problem_id:3477371]", "problem": "考虑一个一维（1D）单原子链，由质量为 $M$ 的相同原子组成，它们以晶格常数 $a$ 等距排列，并通过劲度系数为 $K$ 的最近邻谐波弹簧相互作用。设 $u_n(t)$ 表示位于平衡位置 $x_n = n a$ 的原子在时间 $t$ 时偏离其平衡位置的小位移。假设原子间势能采用谐波近似，系统具有平移不变性，并满足周期性玻恩–冯·卡门边界条件（BvK）。从牛顿第二定律和晶格振动在倒易空间中的动力学矩阵的定义出发，推导该系统的声子色散关系。将您的最终答案表示为关于 $q$、$a$、$K$ 和 $M$ 的单个闭合形式解析表达式 $\\omega(q)$。最终表达式中不应包含任何单位。", "solution": "所述问题是固态物理学中一个有效、适定且基础的练习。它提供了所有必要的信息，并依赖于已建立的物理原理。我们将进行严格的推导。\n\n该系统是一个由质量为“$M$”的相同原子组成的一维链，其平衡晶格间距为“$a$”。我们只考虑由常数为“$K$”的谐波弹簧建模的最近邻相互作用。设“$u_n(t)$”是第“$n$”个原子偏离其平衡位置“$x_n = na$”的位移。\n\n在谐波近似下，晶格的总势能“$V$”可以写成各个弹簧势能的总和：\n$$\nV = \\frac{1}{2} K \\sum_n (u_{n+1} - u_n)^2\n$$\n作用在第“$n$”个原子上的力“$F_n$”由势能对其位移“$u_n$”的负梯度给出：\n$$\nF_n = -\\frac{\\partial V}{\\partial u_n} = - \\frac{1}{2} K \\left[ \\frac{\\partial}{\\partial u_n} (u_n - u_{n-1})^2 + \\frac{\\partial}{\\partial u_n} (u_{n+1} - u_n)^2 \\right]\n$$\n$$\nF_n = - \\frac{1}{2} K \\left[ 2(u_n - u_{n-1})(1) + 2(u_{n+1} - u_n)(-1) \\right] = -K [(u_n - u_{n-1}) - (u_{n+1} - u_n)]\n$$\n$$\nF_n = K (u_{n+1} - 2u_n + u_{n-1})\n$$\n应用牛顿第二定律“$F_n = M \\ddot{u}_n$”，我们得到第“$n$”个原子的运动方程：\n$$\nM \\frac{d^2 u_n}{dt^2} = K (u_{n+1} - 2u_n + u_{n-1})\n$$\n这组耦合微分方程描述了晶格振动。问题要求通过动力学矩阵形式主义求解。运动方程通常可以写成原子间力常数“$\\Phi(n, n')$”的形式：\n$$\nM \\ddot{u}_n = -\\sum_{n'} \\Phi(n, n') u_{n'}\n$$\n其中“$\\Phi(n, n') = \\frac{\\partial^2 V}{\\partial u_n \\partial u_{n'}}$”。通过将此形式与我们推导出的运动方程进行比较，我们可以确定力常数。让我们直接从势能计算它们：\n$$\n\\frac{\\partial V}{\\partial u_n} = K(2u_n - u_{n-1} - u_{n+1})\n$$\n二阶导数给出力常数：\n对于“$n' = n$”：\n$$\n\\Phi(n, n) = \\frac{\\partial^2 V}{\\partial u_n^2} = 2K\n$$\n对于“$n' = n+1$”：\n$$\n\\Phi(n, n+1) = \\frac{\\partial^2 V}{\\partial u_n \\partial u_{n+1}} = -K\n$$\n对于“$n' = n-1$”：\n$$\n\\Phi(n, n-1) = \\frac{\\partial^2 V}{\\partial u_n \\partial u_{n-1}} = -K\n$$\n对于“$|n - n'| > 1$”，力常数为零，这与最近邻相互作用一致。\n\n实空间中的动力学矩阵定义为“$D(n, n') = \\frac{1}{M}\\Phi(n,n')$”。由于无限长链（或具有周期性边界条件的链）的平移不变性，这些矩阵元只依赖于原子间的相对距离，即“$D(n, n') = D(n-n')$”。\n我们寻求形式为“$u_n(t) = A \\exp[i(q x_n - \\omega t)]$”的平面波解，其中“$q$”是波矢，“$\\omega$”是角频率。将此拟设代入运动方程，得到一个本征值问题。倒易空间中的动力学矩阵“$D(q)$”是实空间动力学矩阵元的傅里叶变换：\n$$\nD(q) = \\sum_{l=-\\infty}^{\\infty} D(l) \\exp(-i q l a)\n$$\n其中“$l = n-n'$”是邻居指数。在我们的情况下，求和是有限的，只包括“$l=0, +1, -1$”：\n$$\nD(0) = \\frac{\\Phi(n,n)}{M} = \\frac{2K}{M}\n$$\n$$\nD(1) = \\frac{\\Phi(n,n+1)}{M} = -\\frac{K}{M}\n$$\n$$\nD(-1) = \\frac{\\Phi(n,n-1)}{M} = -\\frac{K}{M}\n$$\n将这些代入“$D(q)$”的傅里叶求和中：\n$$\nD(q) = D(0) + D(1)\\exp(-iqa) + D(-1)\\exp(iqa)\n$$\n$$\nD(q) = \\frac{2K}{M} - \\frac{K}{M}\\exp(-iqa) - \\frac{K}{M}\\exp(iqa)\n$$\n提取公因式“$\\frac{K}{M}$”：\n$$\nD(q) = \\frac{K}{M} \\left( 2 - [\\exp(iqa) + \\exp(-iqa)] \\right)\n$$\n使用欧拉公式“$\\cos(x) = \\frac{\\exp(ix) + \\exp(-ix)}{2}$”，方括号中的项变为“$2\\cos(qa)$”。\n$$\nD(q) = \\frac{K}{M} (2 - 2\\cos(qa)) = \\frac{2K}{M} (1 - \\cos(qa))\n$$\n我们现在使用半角三角恒等式“$1 - \\cos(\\theta) = 2\\sin^2(\\frac{\\theta}{2})$”。\n$$\nD(q) = \\frac{2K}{M} \\left( 2\\sin^2\\left(\\frac{qa}{2}\\right) \\right) = \\frac{4K}{M} \\sin^2\\left(\\frac{qa}{2}\\right)\n$$\n对于单原子晶格，动力学矩阵“$D(q)$”是一个“$1 \\times 1$”的矩阵（一个标量）。其本征值等于“$\\omega^2(q)$”。\n$$\n\\omega^2(q) = D(q) = \\frac{4K}{M} \\sin^2\\left(\\frac{qa}{2}\\right)\n$$\n为了找到色散关系“$\\omega(q)$”，我们取平方根。由于频率是一个物理上的非负量，我们取正根，这需要在正弦函数上加上绝对值，因为波矢“$q$”可以为负。\n$$\n\\omega(q) = \\sqrt{\\frac{4K}{M}} \\left| \\sin\\left(\\frac{qa}{2}\\right) \\right|\n$$\n该表达式可以简化为：\n$$\n\\omega(q) = 2\\sqrt{\\frac{K}{M}} \\left| \\sin\\left(\\frac{qa}{2}\\right) \\right|\n$$\n这是具有最近邻相互作用的一维单原子链的声子色散关系。", "answer": "$$\n\\boxed{2\\sqrt{\\frac{K}{M}} \\left| \\sin\\left(\\frac{qa}{2}\\right) \\right|}\n$$", "id": "3477371"}, {"introduction": "这项实践从理想化的解析模型转向了更贴近现实的计算场景。在这里，我们不再从给定的力常数出发，而是面对模拟计算的原始数据——给定原子位移所产生的力——并需要从中提取出力常数。这个“逆问题”是计算材料科学中的一项核心任务，它将引导你处理实际的数值挑战，例如病态矩阵，并学习使用伪逆和正则化等技术来获得稳定可靠的解。[@problem_id:3477423]", "problem": "您的任务是构建并求解一个逆问题：在一个使用 $3 \\times 3 \\times 3$ 超胞的周期性简立方晶体中，根据对指定原子位移的力响应来提取原子间力常数 (IFC)。请在谐波近似的框架内进行计算。您必须使用的基本依据是晶体中力与位移之间的线性化关系：对于由 $i, j$ 索引的原子和由 $\\mu, \\nu$ 索引的笛卡尔分量，力由 $F_{i\\mu} = - \\sum_{j\\nu} \\Phi_{i\\mu,j\\nu} u_{j\\nu}$ 给出，其中 $\\Phi_{i\\mu,j\\nu}$ 是 IFC，而 $u_{j\\nu}$ 是位移。在一个每个原胞含一个原子且仅考虑最近邻中心相互作用的简立方晶格中，位于原点的中心原子与其位于 $\\pm \\hat{x}$、$\\pm \\hat{y}$ 和 $\\pm \\hat{z}$ 的邻居之间的 IFC 块简化为与键方向对齐的对角形式。在本问题中，将每个轴视为解耦的，并将未知数建模为六个标量最近邻方向性 IFC：$k_{x}^{(+)}$、$k_{x}^{(-)}$、$k_{y}^{(+)}$、$k_{y}^{(-)}$、$k_{z}^{(+)}$、$k_{z}^{(-)}$，单位均为电子伏特每平方埃 ($\\mathrm{eV}/\\text{\\AA}^{2}$)。因此，在某个位移模式下，中心原子沿轴 $\\alpha \\in \\{x,y,z\\}$ 受到的力为 $F_{\\alpha} = - k_{\\alpha}^{(+)} u_{\\alpha}^{(+\\alpha)} - k_{\\alpha}^{(-)} u_{\\alpha}^{(-\\alpha)}$，其中 $u_{\\alpha}^{(+\\alpha)}$ 和 $u_{\\alpha}^{(-\\alpha)}$ 分别是位于 $+\\hat{\\alpha}$ 和 $-\\hat{\\alpha}$ 的邻居沿轴 $\\alpha$ 的位移分量，单位为埃 ($\\text{\\AA}$)。\n\n您的目标是：\n- 根据一组位移模式及其对应的力响应，构建线性系统 $A \\mathbf{x} = \\mathbf{b}$，其中 $\\mathbf{x} = [k_{x}^{(+)}, k_{x}^{(-)}, k_{y}^{(+)}, k_{y}^{(-)}, k_{z}^{(+)}, k_{z}^{(-)}]^T$。\n- 使用矩阵伪逆（通过奇异值分解 (SVD)）求解 $\\mathbf{x}$，并在需要时使用带有 Tikhonov (岭) 正则化的正则化最小二乘估计来稳定病态或欠定情况。正则化解是 $\\|\\!A \\mathbf{x} - \\mathbf{b}\\!\\|_2^2 + \\lambda \\|\\!\\mathbf{x}\\!\\|_2^2$ 的最小值点，满足 $(A^T A + \\lambda I)\\mathbf{x} = A^T \\mathbf{b}$，其中 $\\lambda > 0$。\n- 从概念上使用声学求和规则将每个轴上的自身 IFC 块解释为 $k_{\\alpha}^{(\\mathrm{self})} = k_{\\alpha}^{(+)} + k_{\\alpha}^{(-)}$，尽管您不需要输出自身项。您必须在解决方案中讨论此约束是如何产生的以及它在实践中如何使用。\n\n本问题不使用角度。所有物理量必须使用其明确单位处理：位移单位为埃 ($\\text{\\AA}$)，力单位为电子伏特每埃 ($\\mathrm{eV}/\\text{\\AA}$)，IFC 单位为电子伏特每平方埃 ($\\mathrm{eV}/\\text{\\AA}^{2}$)。您的程序必须以 $\\mathrm{eV}/\\text{\\AA}^{2}$ 为单位输出所有恢复的 IFC，并将每个报告值四舍五入到六位小数。\n\n测试套件：\n您必须在程序中实现以下三个测试用例。在每个用例中，底层的真实 IFC 值为 $k_{x}^{(+)} = k_{x}^{(-)} = 10.0$，$k_{y}^{(+)} = k_{y}^{(-)} = 12.0$，$k_{z}^{(+)} = k_{z}^{(-)} = 8.0$，单位为 $\\mathrm{eV}/\\text{\\AA}^{2}$，并且必须根据公式 $F_{\\alpha} = - k_{\\alpha}^{(+)} u_{\\alpha}^{(+\\alpha)} - k_{\\alpha}^{(-)} u_{\\alpha}^{(-\\alpha)}$ 计算力。\n\n- 测试用例 1（良态，信息丰富的模式）：使用以下六个位移模式，每个模式表示为 $\\left[u_{x}^{(+)}, u_{x}^{(-)}, u_{y}^{(+)}, u_{y}^{(-)}, u_{z}^{(+)}, u_{z}^{(-)}\\right]$，单位为埃 ($\\text{\\AA}$)。\n  1. $[0.02, 0, 0, 0, 0, 0]$\n  2. $[0, 0.03, 0, 0, 0, 0]$\n  3. $[0, 0, 0.01, 0, 0, 0]$\n  4. $[0, 0, 0, 0.04, 0, 0]$\n  5. $[0, 0, 0, 0, 0.05, 0]$\n  6. $[0, 0, 0, 0, 0, 0.02]$\n  使用真实值 IFC 计算相应的力分量 $\\left[F_x, F_y, F_z\\right]$，并仅将非平凡的分量方程包含在线性系统中。\n\n- 测试用例 2（病态，列几乎共线，外加确定性测量噪声）：使用以下五个位移模式，表示方式同上：\n  1. $[0.01, 0.0099, 0.02, 0.0202, 0.015, 0.0148]$\n  2. $[0.015, 0.0151, 0.025, 0.0249, 0.02, 0.0202]$\n  3. $[0.02, 0.02005, 0.03, 0.02995, 0.025, 0.02495]$\n  4. $[0.025, 0.02495, 0.035, 0.03505, 0.03, 0.0301]$\n  5. $[0.03, 0.0299, 0.04, 0.0402, 0.035, 0.0349]$\n  根据真实值计算力，然后按模式逐个添加以下确定性噪声偏移（单位为 $\\mathrm{eV}/\\text{\\AA}$）：\n  - 对于 $F_x$：$[0.0001, -0.0002, 0.00015, -0.0001, 0.00025]$，\n  - 对于 $F_y$：$[-0.00013, 0.00022, -0.00017, 0.0001, -0.0002]$，\n  - 对于 $F_z$：$[0.00011, -0.00012, 0.00013, -0.00014, 0.00015]$。\n  同时使用伪逆和岭回归（使用 $\\lambda = 10^{-3}$）进行求解。\n\n- 测试用例 3（欠定，$\\pm$ 对的列完全共线）：使用以下四个位移模式：\n  1. $[0.02, 0.02, 0, 0, 0, 0]$\n  2. $[0, 0, 0.02, 0.02, 0, 0]$\n  3. $[0, 0, 0, 0, 0.05, 0.05]$\n  4. $[0.01, 0.01, 0.01, 0.01, 0, 0]$\n  根据真实值计算力，不加噪声。同时使用伪逆和岭回归（使用 $\\lambda = 10^{-3}$）进行求解。\n\n算法要求：\n- 为每个非零力分量和模式构建矩阵 $A$ 的一行方程。对于对应于轴 $\\alpha$ 的方程，该行在 $k_{\\alpha}^{(+)}$ 和 $k_{\\alpha}^{(-)}$ 的列中的条目分别为 $-u_{\\alpha}^{(+\\alpha)}$ 和 $-u_{\\alpha}^{(-\\alpha)}$，其他位置为零。右侧是相应的力分量 $F_{\\alpha}$。\n- 计算伪逆解 $\\mathbf{x}_{\\mathrm{pinv}} = A^{+} \\mathbf{b}$，其中 $A^{+}$ 是通过奇异值分解构建的 Moore–Penrose 伪逆。\n- 计算岭回归解 $\\mathbf{x}_{\\mathrm{ridge}} = (A^T A + \\lambda I)^{-1} A^T \\mathbf{b}$，其中 $\\lambda = 10^{-3}$。\n\n最终输出格式：\n您的程序应生成一行输出，其中包含一个用方括号括起来的逗号分隔列表。该列表必须按顺序包括：\n- 测试用例 1 的六个伪逆恢复的 IFC，\n- 测试用例 2 的六个伪逆恢复的 IFC，后跟测试用例 2 的六个岭回归恢复的 IFC，\n- 测试用例 3 的六个伪逆恢复的 IFC，后跟测试用例 3 的六个岭回归恢复的 IFC。\n所有值必须以 $\\mathrm{eV}/\\text{\\AA}^{2}$ 为单位报告，并四舍五入到六位小数。例如，格式必须类似于 $[\\dots]$，只包含数值条目。", "solution": "该问题要求我们从一组给定的原子位移模式及中心原子所受的合力中，确定一组六个未知的最近邻原子间力常数 (IFC)，记为向量 $\\mathbf{x} = [k_{x}^{(+)}, k_{x}^{(-)}, k_{y}^{(+)}, k_{y}^{(-)}, k_{z}^{(+)}, k_{z}^{(-)}]^T$。这构成了简立方晶格动力学谐波近似框架下的一个逆问题。\n\n所提供的基本物理关系是关联力 $F$ 与位移 $u$ 的线性方程：\n$$F_{i\\mu} = - \\sum_{j\\nu} \\Phi_{i\\mu,j\\nu} u_{j\\nu}$$\n其中 $\\Phi_{i\\mu,j\\nu}$ 是力常数张量，表示由于原子 $j$ 在方向 $\\nu$ 上发生单位位移而对原子 $i$ 在方向 $\\mu$ 上产生的力的负值。对于指定的模型——一个只有最近邻中心相互作用且各轴解耦的简立方晶格——这种通用形式得到了显著简化。中心原子（位于原点）沿笛卡尔轴 $\\alpha \\in \\{x,y,z\\}$ 受到的力仅取决于其沿同一轴的两个最近邻原子的位移。这些邻居相对于中心原子的位置在 $+\\hat{\\alpha}$ 和 $-\\hat{\\alpha}$ 处。它们沿 $\\alpha$ 轴的位移分别表示为 $u_{\\alpha}^{(+\\alpha)}$ 和 $u_{\\alpha}^{(-\\alpha)}$。中心原子受到的力由下式给出：\n$$F_{\\alpha} = - k_{\\alpha}^{(+)} u_{\\alpha}^{(+\\alpha)} - k_{\\alpha}^{(-)} u_{\\alpha}^{(-\\alpha)}$$\n在这里，$k_{\\alpha}^{(+)}$ 和 $k_{\\alpha}^{(-)}$ 是我们旨在求出的标量 IFC。它们代表连接中心原子与其在正负 $\\alpha$ 方向上邻居的弹簧常数。所有 IFC 的单位为 $\\mathrm{eV}/\\text{\\AA}^{2}$，力的单位为 $\\mathrm{eV}/\\text{\\AA}$，位移的单位为 $\\text{\\AA}$。\n\n为了求解六个未知的 IFC，我们构建一个形式为 $A \\mathbf{x} = \\mathbf{b}$ 的线性方程组。每个位移模式最多提供三个方程，每个笛卡尔轴一个。对应于给定 位移模式下 $\\alpha$ 轴的单个方程可以写成：\n$$F_{\\alpha} = (-u_{\\alpha}^{(+\\alpha)}) k_{\\alpha}^{(+)} + (-u_{\\alpha}^{(-\\alpha)}) k_{\\alpha}^{(-)} + (0) k_{y}^{(+)} + \\dots$$\n这个结构定义了矩阵 $A$ 中的一行和向量 $\\mathbf{b}$ 中的相应元素。对于一个与轴 $\\alpha$ 相关的方程，$A$ 中的行向量将仅在对应于 $k_{\\alpha}^{(+)}$ 和 $k_{\\alpha}^{(-)}$ 的列中具有非零项；这些项分别是 $-u_{\\alpha}^{(+\\alpha)}$ 和 $-u_{\\alpha}^{(-\\alpha)}$。向量 $\\mathbf{b}$ 中的相应元素是测得的力分量 $F_{\\alpha}$。通过为所有信息丰富的位移模式组合这些行，我们形成了完整的线性系统 $A \\mathbf{x} = \\mathbf{b}$。如果相关位移 $u_{\\alpha}^{(+\\alpha)}$ 或 $u_{\\alpha}^{(-\\alpha)}$ 中至少有一个非零，则该方程被认为是信息丰富的并被包含在系统中。\n\n问题要求讨论声学求和规则 (ASR)。ASR 是源于晶体势能平移不变性的对 IFC 的一个基本约束。整个晶体沿任意向量的刚性平移不能在任何原子上产生任何净力。在数学上，这意味着对于任何 $i, \\mu, \\nu$，都有 $\\sum_{j} \\Phi_{i\\mu,j\\nu} = 0$。我们可以将这个和分解为自身项 ($j=i$) 和邻居贡献项 ($j \\neq i$)：$\\Phi_{i\\mu,i\\nu} = - \\sum_{j \\neq i} \\Phi_{i\\mu,j\\nu}$。$\\Phi_{i\\mu,i\\nu}$ 项是原子 $i$ 的自身 IFC 或在位 IFC。在我们的简化模型中，力方程 $F_{\\alpha} = - k_{\\alpha}^{(+)} u_{\\alpha}^{(+\\alpha)} - k_{\\alpha}^{(-)} u_{\\alpha}^{(-\\alpha)}$ 允许我们将 $k_{\\alpha}^{(\\pm)}$ 与 $\\Phi$ 张量的特定非对角元等同起来。ASR 随后规定对角自身项为 $\\Phi_{0\\alpha,0\\alpha} = - (k_{\\alpha}^{(+)} + k_{\\alpha}^{(-)})$。问题引入了量 $k_{\\alpha}^{(\\mathrm{self})} = k_{\\alpha}^{(+)} + k_{\\alpha}^{(-)}$，它是真实自身 IFC 分量的负值。在实践中，ASR至关重要：它提供了一个物理约束，可用于对拟合模型强制施加物理真实性，或解决模糊性，例如在欠定系统中，只能确定某些 IFC 的和。\n\n我们将使用两种方法求解该系统：\n\n1. Moore-Penrose 伪逆：$\\mathbf{x}_{\\mathrm{pinv}} = A^{+} \\mathbf{b}$。此方法稳健，并提供了唯一的最小范数 ($L_2$) 解，该解也最小化了最小二乘误差 $\\|\\!A \\mathbf{x} - \\mathbf{b}\\!\\|_{2}^{2}$。对于欠定系统，它从无限解集中选择一个特定的解。伪逆 $A^{+}$ 通过对 $A = U \\Sigma V^T$ 进行奇异值分解 (SVD) 计算得出，其中 $A^{+} = V \\Sigma^{+} U^T$。\n\n2. Tikhonov (岭) 正则化：此方法找到向量 $\\mathbf{x}$，使正则化成本函数 $\\|\\!A \\mathbf{x} - \\mathbf{b}\\!\\|_{2}^{2} + \\lambda \\|\\!\\mathbf{x}\\!\\|_{2}^{2}$ 最小化，其中正则化参数 $\\lambda > 0$。解由正规方程给出：$\\mathbf{x}_{\\mathrm{ridge}} = (A^T A + \\lambda I)^{-1} A^T \\mathbf{b}$。$\\lambda I$ 项（其中 $I$ 是单位矩阵）使得矩阵 $(A^T A + \\lambda I)$ 可逆且条件良好，即使 $A^T A$ 是奇异的或病态的。这可以稳定解以抵抗噪声，并通过惩罚大范数解来解决秩亏系统中的模糊性。\n\n三个测试用例探讨了不同的情景：\n- **测试用例 1** 是良态的。位移模式分离了六个 IFC 中的每一个，从而得到一个对角矩阵 $A$ 和一个唯一的精确解。\n- **测试用例 2** 是病态的。位移 $u_{\\alpha}^{(+)}$ 和 $u_{\\alpha}^{(-)}$几乎相等，使得 $A$ 中相应的列几乎共线。噪声的存在使得伪逆解不稳定且不准确。岭回归通过对问题进行正则化，有望提供一个更稳定且具有物理意义的结果。\n- **测试用例 3** 是欠定的和秩亏的。选择的位移使得 $u_{\\alpha}^{(+)} = u_{\\alpha}^{(-)}$，导致 $A$ 中对应于 $k_{\\alpha}^{(+)}$ 和 $k_{\\alpha}^{(-)}$ 的列完全相同。因此无法唯一地确定 $k_{\\alpha}^{(+)}$ 和 $k_{\\alpha}^{(-)}$ 各自的值；只能找到它们的和 $k_{\\alpha}^{(+)} + k_{\\alpha}^{(-)}$。伪逆法将产生最小范数解，在本例中这意味着 $k_{\\alpha}^{(+)} = k_{\\alpha}^{(-)}$。由于真实值数据恰好满足此条件，伪逆解将是精确的。岭回归解将非常相似，同样会强制一个解，其中共线列的系数彼此接近。\n\n```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes Interatomic Force Constants (IFCs) from force-displacement data\n    for three distinct test cases, demonstrating solutions for well-conditioned,\n    ill-conditioned, and underdetermined linear systems.\n    \"\"\"\n\n    k_true = np.array([10.0, 10.0, 12.0, 12.0, 8.0, 8.0]) # [k_x+, k_x-, k_y+, k_y-, k_z+, k_z-] in eV/A^2\n\n    test_cases = [\n        {\n            \"id\": 1,\n            \"displacements\": np.array([\n                [0.02, 0, 0, 0, 0, 0],\n                [0, 0.03, 0, 0, 0, 0],\n                [0, 0, 0.01, 0, 0, 0],\n                [0, 0, 0, 0.04, 0, 0],\n                [0, 0, 0, 0, 0.05, 0],\n                [0, 0, 0, 0, 0, 0.02]\n            ]), # in Angstrom\n            \"noise\": None,\n            \"lambda_reg\": None,\n        },\n        {\n            \"id\": 2,\n            \"displacements\": np.array([\n                [0.01, 0.0099, 0.02, 0.0202, 0.015, 0.0148],\n                [0.015, 0.0151, 0.025, 0.0249, 0.02, 0.0202],\n                [0.02, 0.02005, 0.03, 0.02995, 0.025, 0.02495],\n                [0.025, 0.02495, 0.035, 0.03505, 0.03, 0.0301],\n                [0.03, 0.0299, 0.04, 0.0402, 0.035, 0.0349]\n            ]),\n            \"noise\": {\n                \"Fx\": np.array([0.0001, -0.0002, 0.00015, -0.0001, 0.00025]),\n                \"Fy\": np.array([-0.00013, 0.00022, -0.00017, 0.0001, -0.0002]),\n                \"Fz\": np.array([0.00011, -0.00012, 0.00013, -0.00014, 0.00015])\n            }, # in eV/A\n            \"lambda_reg\": 1e-3,\n        },\n        {\n            \"id\": 3,\n            \"displacements\": np.array([\n                [0.02, 0.02, 0, 0, 0, 0],\n                [0, 0, 0.02, 0.02, 0, 0],\n                [0, 0, 0, 0, 0.05, 0.05],\n                [0.01, 0.01, 0.01, 0.01, 0, 0]\n            ]),\n            \"noise\": None,\n            \"lambda_reg\": 1e-3,\n        }\n    ]\n\n    all_results = []\n\n    def generate_system(displacements, k_gt, noise_data):\n        \"\"\"\n        Constructs the linear system A*x = b from displacement patterns.\n        \"\"\"\n        A_rows = []\n        b_elements = []\n        \n        for i, u_pattern in enumerate(displacements):\n            u_x_p, u_x_n, u_y_p, u_y_n, u_z_p, u_z_n = u_pattern\n\n            k_x_p, k_x_n, k_y_p, k_y_n, k_z_p, k_z_n = k_gt\n\n            # Calculate forces from ground truth\n            Fx = - (k_x_p * u_x_p + k_x_n * u_x_n)\n            Fy = - (k_y_p * u_y_p + k_y_n * u_y_n)\n            Fz = - (k_z_p * u_z_p + k_z_n * u_z_n)\n\n            # Add noise if provided\n            if noise_data:\n                Fx += noise_data[\"Fx\"][i]\n                Fy += noise_data[\"Fy\"][i]\n                Fz += noise_data[\"Fz\"][i]\n\n            # Add equation for x-axis if displacements are non-zero\n            if not (u_x_p == 0 and u_x_n == 0):\n                A_rows.append([-u_x_p, -u_x_n, 0, 0, 0, 0])\n                b_elements.append(Fx)\n            \n            # Add equation for y-axis if displacements are non-zero\n            if not (u_y_p == 0 and u_y_n == 0):\n                A_rows.append([0, 0, -u_y_p, -u_y_n, 0, 0])\n                b_elements.append(Fy)\n\n            # Add equation for z-axis if displacements are non-zero\n            if not (u_z_p == 0 and u_z_n == 0):\n                A_rows.append([0, 0, 0, 0, -u_z_p, -u_z_n])\n                b_elements.append(Fz)\n\n        return np.array(A_rows), np.array(b_elements)\n\n    for case in test_cases:\n        A, b = generate_system(case[\"displacements\"], k_true, case[\"noise\"])\n        \n        # --- Pseudoinverse Solution ---\n        x_pinv = np.linalg.pinv(A) @ b\n        all_results.extend(x_pinv)\n\n        # --- Ridge Regression Solution (if applicable) ---\n        if case[\"lambda_reg\"] is not None:\n            lambda_val = case[\"lambda_reg\"]\n            num_vars = A.shape[1]\n            I = np.identity(num_vars)\n            \n            # x_ridge = (A.T @ A + lambda * I)^-1 @ A.T @ b\n            AtA = A.T @ A\n            Atb = A.T @ b\n            x_ridge = np.linalg.inv(AtA + lambda_val * I) @ Atb\n            all_results.extend(x_ridge)\n    \n    # This part is for local execution to generate the answer string\n    # and would not be part of the final output itself.\n    # formatted_results = [f\"{r:.6f}\" for r in all_results]\n    # print(f\"[{','.join(formatted_results)}]\")\n```", "answer": "[10.000000,10.000000,12.000000,12.000000,8.000000,8.000000,11.838521,8.166418,10.354181,13.639144,8.567086,7.426214,10.046903,9.957962,11.969188,12.030584,7.989715,8.010166,10.000000,10.000000,12.000000,12.000000,8.000000,8.000000,9.998000,9.998000,11.998800,11.998800,7.999200,7.999200]", "id": "3477423"}, {"introduction": "在计算出力常数并构建动力学矩阵后，下一步就是计算声子色散。但如果结果中出现了虚频，我们该如何应对？这项练习提供了一个关键的诊断流程，教会你如何区分真实的晶格不稳定性与计算中常见的数值伪影（例如由有限超胞尺寸或位移振幅引起的误差）。掌握这种诊断技能对于获得可靠的计算结果至关重要。[@problem_id:3477409]", "problem": "考虑一个三维 Bravais 晶体，每个原胞中有一个质量为 $M$ 的原子。在谐波近似中，围绕平衡位置的小位移 $\\mathbf{u}$ 会产生力 $\\mathbf{F} = -\\Phi^{(2)} \\mathbf{u}$，其中 $\\Phi^{(2)}$ 是谐波力常数矩阵（Born–Oppenheimer 势能面相对于原子位移的 Hessian 矩阵）。波矢为 $\\mathbf{q}$ 处的动力学矩阵 $D_{\\alpha\\beta}(\\mathbf{q})$ 定义为\n$$\nD_{\\alpha\\beta}(\\mathbf{q}) = \\frac{1}{M} \\sum_{\\mathbf{R}} \\Phi^{(2)}_{\\alpha\\beta}(\\mathbf{R}) \\, e^{i \\mathbf{q}\\cdot \\mathbf{R}},\n$$\n其中 $\\Phi^{(2)}_{\\alpha\\beta}(\\mathbf{R})$ 耦合了由晶格矢量 $\\mathbf{R}$ 分隔的晶胞之间的位移的笛卡尔分量 $\\alpha,\\beta \\in \\{x,y,z\\}$。声子频率 $\\omega(\\mathbf{q},s)$ 由本征值问题 $D(\\mathbf{q}) \\mathbf{e}_{\\mathbf{q}s} = \\omega^2(\\mathbf{q},s) \\mathbf{e}_{\\mathbf{q}s}$ 决定，其中 $s$ 标记声子支。虚频声子对应于 $\\omega^2(\\mathbf{q},s)  0$。\n\n在有限位移法中，通过对线性尺寸为 $L$ 的超胞（因此对于简单立方晶格，超胞包含 $L^3$ 个原胞）中的原子施加振幅为 $\\Delta$ 的小位移，计算力，并形成有限差分，来估计 $\\Phi^{(2)}$。于是引入了两种不同的数值误差来源：\n- 有限位移振幅效应，因为有限差分探测的是超出严格谐波区域的势能，以及\n- 有限超胞截断，因为 $\\Phi^{(2)}(\\mathbf{R})$ 被有效截断到 $|\\mathbf{R}| \\lesssim R_L$ 的范围内，其中 $R_L$ 与 $L$ 成比例，这导致一个误差项 $E_L(\\mathbf{q}) = \\sum_{\\mathbf{R}\\notin \\text{supercell}} \\Phi^{(2)}(\\mathbf{R}) e^{i \\mathbf{q}\\cdot \\mathbf{R}}$，当实空间相互作用衰减足够快时，该误差项在 $L \\to \\infty$ 时消失。\n\n此外，在有限温度 $T$ 下的非谐重整化可以使模式稳定或不稳定，因此重整化后的 $\\omega^2(\\mathbf{q},s;T)$ 可能随 $T$ 变化，其在 $T\\to 0$ 的极限下接近由 $\\Phi^{(2)}$ 决定的裸谐波值。\n\n假设您在一次计算中在 $\\mathbf{q}^*$ 处观察到一个虚频模式。您系统地扫描位移振幅 $\\Delta$ 和超胞尺寸 $L$，并且还考虑了通过自洽谐波方案得到的重整化频率 $\\omega(\\mathbf{q}^*;T)$ 的温度依赖性。基于上述定义的第一性原理推断以及 $\\Delta \\to 0$、$L \\to \\infty$ 和 $T \\to 0$ 的极限行为，以下哪个诊断性陈述能正确地区分数值赝象和真实的晶格不稳定性？\n\n选择所有适用项。\n\nA. 如果 $|\\omega^2(\\mathbf{q}^*)|$ 随着 $L$ 的增加而单调减小，并在 $L \\to \\infty$ 时外推至 $0$，同时在 $\\Delta$ 足够小时基本不依赖于 $\\Delta$，那么该虚频与有限超胞截断误差最一致，即一个在 $L \\to \\infty$ 时消失的数值赝象。\n\nB. 如果在固定的较大 $L$ 下，$|\\omega^2(\\mathbf{q}^*)|$ 表现出对 $\\Delta$ 的强烈依赖性，并且向 $\\Delta \\to 0$ 的外推得到 $\\omega^2(\\mathbf{q}^*) > 0$，那么在有限 $\\Delta$ 下的虚频与谐波力常数的有限位移污染最一致，即一个在 $\\Delta \\to 0$ 时消失的数值赝象。\n\nC. 如果在 $\\Delta \\to 0$ 和 $L \\to \\infty$ 的双重极限下，$\\omega^2(\\mathbf{q}^*)$ 保持为负，并且随着 $T \\to 0$，$|\\omega^2(\\mathbf{q}^*;T)|$ 的量值增加，那么该虚频与真实的晶格不稳定性最一致，即谐波势的一个负曲率，该曲率在 $T \\to 0$ 时持续存在并加深。\n\nD. 如果虚频仅在 $\\mathbf{q} \\approx \\mathbf{0}$ 附近出现，并且在对 $\\Phi^{(2)}$ 或 $D(\\mathbf{q})$ 强制执行声学求和规则（平移不变性）后消失，那么这种消除表明在小 $\\mathbf{q}$ 处存在真实的晶格不稳定性。", "solution": "该问题要求分析不同的计算观测结果，以区分声子计算中的真实晶格不稳定性与数值赝象。一个真实的晶格不稳定性对应于真实动力学矩阵 $D(\\mathbf{q})$ 的一个负本征值 $\\omega^2(\\mathbf{q},s)  0$。真实的动力学矩阵源自精确的谐波力常数 $\\Phi^{(2)}$，这原则上需要在无限大超胞（$L \\to \\infty$）和无穷小位移（$\\Delta \\to 0$）的极限下进行计算。数值赝象是在接近这些极限时会消失的表面不稳定性。我们将基于这一基本原则来评估每个陈述。\n\n**A. 如果 $|\\omega^2(\\mathbf{q}^*)|$ 随着 $L$ 的增加而单调减小，并在 $L \\to \\infty$ 时外推至 $0$，同时在 $\\Delta$ 足够小时基本不依赖于 $\\Delta$，那么该虚频与有限超胞截断误差最一致，即一个在 $L \\to \\infty$ 时消失的数值赝象。**\n\n该陈述描述了关于超胞尺寸 $L$ 的收敛性测试。使用有限超胞计算的动力学矩阵 $D_L(\\mathbf{q})$ 是对无限晶体的精确动力学矩阵 $D_\\infty(\\mathbf{q})$ 的一个近似。误差由 $E_L(\\mathbf{q}) = \\sum_{\\mathbf{R}\\notin \\text{supercell}} \\Phi^{(2)}(\\mathbf{R}) e^{i \\mathbf{q}\\cdot \\mathbf{R}}$ 给出，这是对所有未包含在超胞内的晶格矢量 $\\mathbf{R}$ 的求和。只要力常数 $\\Phi^{(2)}(\\mathbf{R})$ 随距离 $|\\mathbf{R}|$ 衰减得足够快，该误差项就会在 $L \\to \\infty$ 时消失。\n\n观察到的是，在有限的 $L$ 下发现了一个虚频，意味着计算出的本征值 $\\omega^2_L(\\mathbf{q}^*)  0$。这个虚频模式的量值为 $|\\omega^2(\\mathbf{q}^*)| = -\\omega^2_L(\\mathbf{q}^*)$。该陈述说，随着 $L$ 的增加，$-\\omega^2_L(\\mathbf{q}^*)$ 单调递减并外推至 $0$。这意味着在 $L \\to \\infty$ 的极限下，本征值 $\\omega^2_\\infty(\\mathbf{q}^*)$ 是非负的。因此，在有限 $L$ 下观察到的虚频是截断误差 $E_L(\\mathbf{q})$ 的直接后果，并不代表真实无限晶体的性质。当 $\\Delta$ 足够小时，行为与位移振幅 $\\Delta$ 无关这一条件，正确地将有限超胞尺寸分离出来，作为数值误差的主要来源。这是由超胞截断引起的数值赝象的典型特征。\n\n结论：**正确**。\n\n**B. 如果在固定的较大 $L$ 下，$|\\omega^2(\\mathbf{q}^*)|$ 表现出对 $\\Delta$ 的强烈依赖性，并且向 $\\Delta \\to 0$ 的外推得到 $\\omega^2(\\mathbf{q}^*) > 0$，那么在有限 $\\Delta$ 下的虚频与谐波力常数的有限位移污染最一致，即一个在 $\\Delta \\to 0$ 时消失的数值赝象。**\n\n该陈述描述了关于位移振幅 $\\Delta$ 的收敛性测试。有限位移法使用有限差分近似来估计谐波力常数（势能的二阶导数）。对于任何有限的 $\\Delta$，这种近似都包含来自势能更高阶的非谐项的贡献。只有在 $\\Delta \\to 0$ 的极限下才能恢复真实的谐波力常数。\n\n该情景描述了在固定的、较大的超胞尺寸 $L$ 下的计算，这可以最小化在 A 中讨论的截断误差。对于一个有限的 $\\Delta$，观察到了一个虚频 $\\omega^2(\\mathbf{q}^*)  0$。然而，在系统地减小 $\\Delta$ 并外推至 $\\Delta \\to 0$ 时，相应的本征值变为正值，$\\omega^2(\\mathbf{q}^*) > 0$。这表明负曲率（不稳定性）不是真实谐波势的一个特征，而是在有限 $\\Delta$ 下由非谐污染引入的赝象。该虚频模式在正确的谐波极限下消失。\n\n结论：**正确**。\n\n**C. 如果在 $\\Delta \\to 0$ 和 $L \\to \\infty$ 的双重极限下，$\\omega^2(\\mathbf{q}^*)$ 保持为负，并且随着 $T \\to 0$，$|\\omega^2(\\mathbf{q}^*;T)|$ 的量值增加，那么该虚频与真实的晶格不稳定性最一致，即谐波势的一个负曲率，该曲率在 $T \\to 0$ 时持续存在并加深。**\n\n该陈述描述了证实一个真实不稳定性的条件。首先，负本征值 $\\omega^2(\\mathbf{q}^*)  0$ 被证明在 $\\Delta \\to 0$ 和 $L \\to \\infty$ 的双重极限下持续存在。这个过程正是消除选项 A 和 B 中讨论的数值赝象并获得晶体真实谐波性质所必需的。如果不稳定性在这个极限下仍然存在，它就是谐波势能面的一个真实特征。\n\n其次，考虑了温度依赖性。问题陈述到，在有限温度 $T$ 下的重整化频率 $\\omega^2(\\mathbf{q},s;T)$ 在 $T \\to 0$ 时接近裸谐波值。有限温度下的非谐效应通常起到稳定晶格的作用（即，使 $\\omega^2$ 更正）。观察到 $|\\omega^2(\\mathbf{q}^*;T)|$ 随着 $T \\to 0$ 而增加，意味着随着温度降低，本征值 $\\omega^2(\\mathbf{q}^*;T)$ 变得更负。这种行为与系统在 $T=0$ 时接近一个真实的、潜在的谐波不稳定性完全一致。有限温度的非谐性部分地缓解了这种不稳定性，通过冷却消除这种热效应揭示了谐波不稳定性的全部程度。\n\n结论：**正确**。\n\n**D. 如果虚频仅在 $\\mathbf{q} \\approx \\mathbf{0}$ 附近出现，并且在对 $\\Phi^{(2)}$ 或 $D(\\mathbf{q})$ 强制执行声学求和规则（平移不变性）后消失，那么这种消除表明在小 $\\mathbf{q}$ 处存在真实的晶格不稳定性。**\n\n声学求和规则（ASR）是一个源于晶体势平移不变性的物理约束。它规定了三个声学声子支在布里渊区中心 $\\mathbf{q}=\\mathbf{0}$ 处必须具有零频率。在数值计算中，特别是使用有限精度和有限超胞的计算，这个规则可能会被轻微违反。这种数值上的违反通常表现为声学模式在 $\\mathbf{q}=\\mathbf{0}$ 处的非零频率，这可能错误地表现为在 $\\mathbf{q}$ 接近 $\\mathbf{0}$ 时的小虚频。\n\n对计算出的力常数施加一个校正以强制执行声学求和规则是一种标准做法。这个程序旨在消除这些与声学模式相关的特定数值赝象。如果施加此校正导致 $\\mathbf{q} \\approx \\mathbf{0}$ 附近的虚频消失，那就证明它们是数值上违反声学求和规则的直接结果。因此，这些虚频是数值赝象，而不是一个真实的物理不稳定性。一个真实的不稳定性（例如，一个铁电软模）不会被一个仅仅旨在恢复声学支的平移不变性的程序所消除。该陈述得出了完全相反的结论。\n\n结论：**不正确**。", "answer": "$$\\boxed{ABC}$$", "id": "3477409"}]}