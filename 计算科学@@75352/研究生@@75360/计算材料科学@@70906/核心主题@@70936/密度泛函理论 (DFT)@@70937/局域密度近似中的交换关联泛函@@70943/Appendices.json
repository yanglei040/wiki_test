{"hands_on_practices": [{"introduction": "这第一个实践练习旨在巩固局域密度近似（LDA）中交换能量密度与交换势之间的基本联系。通过泛函微分推导交换势，并将其应用于一个简单非均匀密度系统，我们可以直接观察到LDA泛函的非线性特性，这是其区别于简单线性响应理论的关键特征。这个练习是理解如何从能量泛函构建Kohn-Sham势的基础 [@problem_id:3450841]。", "problem": "在密度泛函理论 (DFT) 中，局域密度近似 (LDA) 通过使用均匀电子气的单位粒子交换能来局域地近似一个非均匀电子体系的交换能。考虑均匀电子气的单位粒子交换能由 $e_{x}(n)=-\\frac{3}{4}\\left(\\frac{3}{\\pi}\\right)^{1/3}n^{1/3}$ 给出，其中 $n$ 是电子密度。交换能泛函为 $E_{x}[n]=\\int n(\\mathbf{r})\\,e_{x}(n(\\mathbf{r}))\\,d^{3}\\mathbf{r}$，而 LDA 交换势定义为 $v_{x}^{\\text{LDA}}(\\mathbf{r})=\\frac{\\delta E_{x}[n]}{\\delta n(\\mathbf{r})}$。\n\n从这些定义和给定的 $e_{x}(n)$ 出发，执行以下操作：\n- 通过从第一性原理出发进行泛函求导，推导 $v_{x}^{\\text{LDA}}(n)$ 作为 $n$ 的函数的显式局域表达式。\n- 对于非均匀一维调制 $n(\\mathbf{r})=n_{0}\\left[1+\\alpha\\cos(kx)\\right]$（其中 $n_{0}0$，$|\\alpha|\\ll 1$ 且 $k0$），通过按 $\\alpha$ 的幂次展开至并包括 $\\alpha^{2}$ 阶项，来计算 $v_{x}^{\\text{LDA}}(\\mathbf{r})$。使用三角恒等式重写 $\\cos(kx)$ 的幂，将结果表示为 $\\cos(kx)$ 和 $\\cos(2kx)$ 的形式，并合并项以揭示 $v_{x}^{\\text{LDA}}$ 中的谐波生成。\n\n以单个闭合形式的解析表达式给出 $v_{x}^{\\text{LDA}}(\\mathbf{r})$ 直到 $\\alpha^{2}$ 阶的最终答案。无需四舍五入，最终表达式中不应包含任何单位。", "solution": "问题陈述被认为是具有科学依据、提法恰当、客观且完整的。这是应用密度泛函理论 (DFT) 基本原理，特别是局域密度近似 (LDA) 的一个标准练习。所有给出的定义和表达式在该领域都是正确和标准的。因此，该问题是有效的，并将提供解答。\n\n问题分为两部分。第一部分是推导 LDA 交换势 $v_{x}^{\\text{LDA}}(n)$ 作为电子密度 $n$ 的函数的通用表达式。第二部分是将此结果应用于特定的空间变化密度 $n(\\mathbf{r})$，并求出在调制幅度 $\\alpha$ 中直到二阶的势。\n\n第一部分：LDA 交换势 $v_{x}^{\\text{LDA}}(n)$ 的推导\n\nLDA 中的交换能泛函由下式给出\n$$E_{x}[n]=\\int n(\\mathbf{r})\\,e_{x}(n(\\mathbf{r}))\\,d^{3}\\mathbf{r}$$\n其中 $e_{x}(n)$ 是密度为 $n$ 的均匀电子气的单位粒子交换能。问题提供了 $e_{x}(n)$ 的表达式：\n$$e_{x}(n)=-\\frac{3}{4}\\left(\\frac{3}{\\pi}\\right)^{1/3}n^{1/3}$$\n为方便起见，我们定义一个常数 $C_{x} = \\frac{3}{4}\\left(\\frac{3}{\\pi}\\right)^{1/3}$，因此 $e_{x}(n) = -C_{x}n^{1/3}$。\n将此代入 $E_{x}[n]$ 的泛函中，我们得到：\n$$E_{x}[n]=\\int n(\\mathbf{r})\\left(-C_{x}\\left(n(\\mathbf{r})\\right)^{1/3}\\right)d^{3}\\mathbf{r} = -C_{x}\\int \\left(n(\\mathbf{r})\\right)^{4/3}d^{3}\\mathbf{r}$$\n被积函数是密度的局域函数，形式为 $f(n(\\mathbf{r})) = -C_{x}(n(\\mathbf{r}))^{4/3}$。LDA 交换势 $v_{x}^{\\text{LDA}}(\\mathbf{r})$ 定义为交换能泛函关于密度的泛函导数：\n$$v_{x}^{\\text{LDA}}(\\mathbf{r})=\\frac{\\delta E_{x}[n]}{\\delta n(\\mathbf{r})}$$\n对于形式为 $F[n] = \\int f(n(\\mathbf{r}))\\,d^{3}\\mathbf{r}$ 的局域泛函，其泛函导数由被积函数对密度的依赖关系的普通导数给出：\n$$\\frac{\\delta F[n]}{\\delta n(\\mathbf{r})} = \\frac{d f(n)}{dn}\\bigg|_{n=n(\\mathbf{r})}$$\n将此规则应用于我们的交换泛函 $E_{x}[n]$：\n$$v_{x}^{\\text{LDA}}(\\mathbf{r}) = \\frac{d}{dn}\\left(-C_{x}n^{4/3}\\right)\\bigg|_{n=n(\\mathbf{r})} = -C_{x}\\frac{d}{dn}\\left(n^{4/3}\\right)\\bigg|_{n=n(\\mathbf{r})}$$\n进行微分得到：\n$$v_{x}^{\\text{LDA}}(\\mathbf{r}) = -C_{x}\\left(\\frac{4}{3}n^{1/3}\\right)\\bigg|_{n=n(\\mathbf{r})} = -\\frac{4}{3}C_{x}\\left(n(\\mathbf{r})\\right)^{1/3}$$\n这给出了作为密度局域函数的交换势。将常数 $C_{x}$ 代回：\n$$v_{x}^{\\text{LDA}}(n) = -\\frac{4}{3}\\left(\\frac{3}{4}\\left(\\frac{3}{\\pi}\\right)^{1/3}\\right)n^{1/3} = -\\left(\\frac{3}{\\pi}\\right)^{1/3}n^{1/3}$$\n这就是 LDA 交换势作为局域电子密度 $n$ 的函数的通用表达式。\n\n第二部分：对 $n(\\mathbf{r})=n_{0}\\left[1+\\alpha\\cos(kx)\\right]$ 进行求值\n\n给定一维密度调制：\n$$n(\\mathbf{r}) = n(x) = n_{0}\\left[1+\\alpha\\cos(kx)\\right]$$\n其中 $n_{0}0$，$k0$ 且微扰幅度 $|\\alpha| \\ll 1$。我们需要使用第一部分推导的表达式来计算 $v_{x}^{\\text{LDA}}(\\mathbf{r})$，并将结果按 $\\alpha$ 的幂次展开至 $\\alpha^{2}$ 阶。\n\n将 $n(\\mathbf{r})$ 代入 $v_{x}^{\\text{LDA}}(n)$ 的表达式中：\n$$v_{x}^{\\text{LDA}}(\\mathbf{r}) = -\\left(\\frac{3}{\\pi}\\right)^{1/3}\\left(n(\\mathbf{r})\\right)^{1/3} = -\\left(\\frac{3}{\\pi}\\right)^{1/3}\\left(n_{0}\\left[1+\\alpha\\cos(kx)\\right]\\right)^{1/3}$$\n我们可以分离出常数部分：\n$$v_{x}^{\\text{LDA}}(\\mathbf{r}) = -\\left(\\frac{3n_{0}}{\\pi}\\right)^{1/3}\\left[1+\\alpha\\cos(kx)\\right]^{1/3}$$\n由于 $|\\alpha| \\ll 1$，我们可以对 $\\left[1+\\alpha\\cos(kx)\\right]^{1/3}$ 项进行泰勒展开。令 $u = \\alpha\\cos(kx)$。我们使用 $(1+u)^{p}$ 的二项式展开式，直到 $u$ 的二阶：\n$$(1+u)^{p} \\approx 1 + pu + \\frac{p(p-1)}{2!}u^{2} + O(u^{3})$$\n在我们的例子中，指数为 $p = 1/3$。系数为：\n- 零阶：$1$\n- 一阶：$p = 1/3$\n- 二阶：$\\frac{p(p-1)}{2} = \\frac{(1/3)(1/3 - 1)}{2} = \\frac{(1/3)(-2/3)}{2} = -\\frac{1}{9}$\n代入这些系数和 $u = \\alpha\\cos(kx)$，我们得到：\n$$\\left[1+\\alpha\\cos(kx)\\right]^{1/3} \\approx 1 + \\frac{1}{3}\\left(\\alpha\\cos(kx)\\right) - \\frac{1}{9}\\left(\\alpha\\cos(kx)\\right)^{2}$$\n$$ = 1 + \\frac{1}{3}\\alpha\\cos(kx) - \\frac{1}{9}\\alpha^{2}\\cos^{2}(kx)$$\n问题要求结果用 $\\cos(kx)$ 和 $\\cos(2kx)$ 表示。我们使用三角恒等式 $\\cos^{2}(\\theta) = \\frac{1+\\cos(2\\theta)}{2}$。将其应用于 $\\cos^{2}(kx)$：\n$$\\cos^{2}(kx) = \\frac{1+\\cos(2kx)}{2}$$\n将此代入我们的展开式中：\n$$\\left[1+\\alpha\\cos(kx)\\right]^{1/3} \\approx 1 + \\frac{1}{3}\\alpha\\cos(kx) - \\frac{1}{9}\\alpha^{2}\\left(\\frac{1+\\cos(2kx)}{2}\\right)$$\n$$ = 1 + \\frac{1}{3}\\alpha\\cos(kx) - \\frac{1}{18}\\alpha^{2} - \\frac{1}{18}\\alpha^{2}\\cos(2kx)$$\n现在，我们合并各项：一个常数项（零次谐波），一个含 $\\cos(kx)$ 的项（基波），以及一个含 $\\cos(2kx)$ 的项（二次谐波）。\n$$\\left[1+\\alpha\\cos(kx)\\right]^{1/3} \\approx \\left(1 - \\frac{1}{18}\\alpha^{2}\\right) + \\frac{1}{3}\\alpha\\cos(kx) - \\frac{1}{18}\\alpha^{2}\\cos(2kx)$$\n最后，我们将此展开形式代回 $v_{x}^{\\text{LDA}}(\\mathbf{r})$ 的表达式中：\n$$v_{x}^{\\text{LDA}}(\\mathbf{r}) = -\\left(\\frac{3n_{0}}{\\pi}\\right)^{1/3} \\left[ \\left(1 - \\frac{1}{18}\\alpha^{2}\\right) + \\frac{1}{3}\\alpha\\cos(kx) - \\frac{1}{18}\\alpha^{2}\\cos(2kx) \\right]$$\n这是给定密度调制的 LDA 交换势的最终表达式，在 $\\alpha$ 中展开到二阶，展示了二次谐波的产生。", "answer": "$$ \\boxed{-\\left(\\frac{3n_{0}}{\\pi}\\right)^{1/3} \\left(1 - \\frac{1}{18}\\alpha^{2} + \\frac{1}{3}\\alpha\\cos(kx) - \\frac{1}{18}\\alpha^{2}\\cos(2kx)\\right)} $$", "id": "3450841"}, {"introduction": "在理解了LDA的力学机制后，我们转向其最显著的局限之一：自相互作用误差（SIE）。一个精确的交换关联泛函应该对任何单电子体系，都能完美抵消Hartree能量中存在的虚假自相互作用。此实践提供了一个具体的数值练习，来计算谐振子势阱中单个电子的自相互作用误差，展示了LDA如何未能通过这一关键测试，以及误差的大小如何随电子的束缚强度而变化 [@problem_id:3450830]。", "problem": "考虑一个三维各向同性谐振子阱中的单电子，其角频率为 $\\omega$（原子单位），其中电子质量 $m=1$，约化普朗克常数 $\\hbar=1$。基态波函数是归一化的高斯函数\n$$\n\\psi(\\mathbf{r})=\\left(\\frac{\\alpha}{\\pi}\\right)^{3/4}\\exp\\left(-\\frac{\\alpha r^2}{2}\\right),\n$$\n相应的电子密度为\n$$\nn(\\mathbf{r})=\\left|\\psi(\\mathbf{r})\\right|^2=\\left(\\frac{\\alpha}{\\pi}\\right)^{3/2}\\exp\\left(-\\alpha r^2\\right),\n$$\n其中 $\\alpha\\equiv\\omega$。使用该密度，计算自相互作用误差\n$$\nE_{\\text{SIE}}[n]=E_{\\text{H}}[n]+E_{xc}^{\\text{LDA}}[n],\n$$\n其中 $E_{\\text{H}}[n]$ 是哈特里（Hartree）能量，$E_{xc}^{\\text{LDA}}[n]$ 是局域密度近似（LDA）中的交换相关能量。\n\n从以下基本定义和事实出发：\n\n1. 哈特里能量泛函为\n$$\nE_{\\text{H}}[n]=\\frac{1}{2}\\int d^3\\mathbf{r}\\int d^3\\mathbf{r}'\\frac{n(\\mathbf{r})\\,n(\\mathbf{r}')}{\\left\\|\\mathbf{r}-\\mathbf{r}'\\right\\|}.\n$$\n\n2. 对于自旋相关的局域自旋密度近似（LSDA），交换能为\n$$\nE_{x}^{\\text{LSDA}}[n_\\uparrow,n_\\downarrow]=-\\frac{3}{4}\\left(\\frac{3}{\\pi}\\right)^{1/3}\\int d^3\\mathbf{r}\\,\\left[n_\\uparrow(\\mathbf{r})^{4/3}+n_\\downarrow(\\mathbf{r})^{4/3}\\right].\n$$\n对于单电子，假设完全自旋极化，因此 $n_\\uparrow(\\mathbf{r})=n(\\mathbf{r})$ 且 $n_\\downarrow(\\mathbf{r})=0$。\n\n3. LSDA中的相关能由下式给出\n$$\nE_{c}^{\\text{LSDA}}[n_\\uparrow,n_\\downarrow]=\\int d^3\\mathbf{r}\\, n(\\mathbf{r})\\,\\varepsilon_c\\!\\left(r_s(\\mathbf{r}),\\zeta\\right),\n$$\n其中 Wigner–Seitz 半径为 $r_s(\\mathbf{r})=\\left(\\frac{3}{4\\pi n(\\mathbf{r})}\\right)^{1/3}$，自旋极化率为 $\\zeta=\\frac{n_\\uparrow-n_\\downarrow}{n_\\uparrow+n_\\downarrow}$。对于单电子，取 $\\zeta=1$。对于完全自旋极化情况（$\\zeta=1$），使用 Perdew–Zunger 1981 (PZ81) 参数化形式表示每个电子的相关能 $\\varepsilon_c(r_s,\\zeta)$，即：\n- 对于 $r_s  1$,\n$$\n\\varepsilon_c(r_s,1)=A_p\\ln r_s + B_p + C_p r_s \\ln r_s + D_p r_s,\n$$\n- 对于 $r_s\\ge 1$,\n$$\n\\varepsilon_c(r_s,1)=\\frac{\\gamma_p}{1+\\beta_{1p}\\sqrt{r_s}+\\beta_{2p}r_s},\n$$\n其中常数为\n$$\nA_p=0.01555,\\quad B_p=-0.0269,\\quad C_p=0.0007,\\quad D_p=-0.0048,\n$$\n$$\n\\gamma_p=-0.0843,\\quad \\beta_{1p}=1.3981,\\quad \\beta_{2p}=0.2611.\n$$\n\n您的任务是实现一个程序，对于每个指定的 $\\omega$ 值，构建 $n(\\mathbf{r})$ 并计算\n$$\nE_{\\text{SIE}}(\\omega)=E_{\\text{H}}[n]+E_{x}^{\\text{LSDA}}[n]+E_{c}^{\\text{LSDA}}[n],\n$$\n以哈特里（原子单位）表示。\n\n为确保数值稳健性，请在适当情况下利用球对称性，并对相关能部分使用稳定的数值积分方法。您可以根据上述基本定义进行解析简化，但不要引入任何非标准的近似。\n\n物理单位：所有能量均以哈特里（Hartree）报告。最终输出必须以浮点数形式列出计算值。\n\n测试组：\n- 情况1：$\\omega=0.01$,\n- 情况2：$\\omega=0.10$,\n- 情况3：$\\omega=1.00$,\n- 情况4：$\\omega=5.00$,\n- 情况5：$\\omega=20.00$,\n- 情况6：$\\omega=50.00$。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含用方括号括起来的六个结果的逗号分隔列表（例如，“[result1,result2,result3,result4,result5,result6]”）。", "solution": "用户提供的问题是有效的，因为它在密度泛函理论方面有科学依据，数学上是适定的，并为获得唯一解提供了所有必要信息。\n\n我们的目标是计算由高斯密度描述的单电子系统的自相互作用误差 $E_{\\text{SIE}}$。自相互作用误差定义为哈特里能量 $E_{\\text{H}}$ 与交换相关能量的局域密度近似（LDA）值 $E_{xc}^{\\text{LDA}}$ 之和。对于单电子系统，精确的交换相关泛函必须正好抵消虚假的哈特里自相互作用，从而使总自相互作用能为零。因此，计算出的 $E_{\\text{SIE}}$ 量化了 LDA 对该系统的误差。\n\n总自相互作用误差由下式给出：\n$$\nE_{\\text{SIE}}(\\omega) = E_{\\text{H}}[n] + E_{x}^{\\text{LSDA}}[n] + E_{c}^{\\text{LSDA}}[n]\n$$\n角频率为 $\\omega$ 的三维各向同性谐振子阱中电子的电子密度 $n(\\mathbf{r})$ 如下所示：\n$$\nn(\\mathbf{r}) = \\left(\\frac{\\alpha}{\\pi}\\right)^{3/2}\\exp\\left(-\\alpha r^2\\right)\n$$\n其中 $\\alpha \\equiv \\omega$，$r = \\left\\|\\mathbf{r}\\right\\|$。密度被归一化，使得 $\\int n(\\mathbf{r}) d^3\\mathbf{r} = 1$。下面将讨论各能量分量的计算。\n\n**1. 哈特里能量，$E_{\\text{H}}[n]$**\n\n哈特里能量表示电荷分布 $n(\\mathbf{r})$ 的经典静电自能：\n$$\nE_{\\text{H}}[n]=\\frac{1}{2}\\int d^3\\mathbf{r}\\int d^3\\mathbf{r}'\\frac{n(\\mathbf{r})\\,n(\\mathbf{r}')}{\\left\\|\\mathbf{r}-\\mathbf{r}'\\right\\|}\n$$\n对于球对称的高斯电荷分布，该积分有一个众所周知的解析解。首先，我们计算由密度 $n(r)$ 产生的静电势 $\\phi(r)$：\n$$\n\\phi(r) = \\int d^3\\mathbf{r}' \\frac{n(r')}{\\left\\|\\mathbf{r}-\\mathbf{r}'\\right\\|} = \\frac{\\text{erf}(\\sqrt{\\alpha}r)}{r}\n$$\n其中 $\\text{erf}(x)$ 是误差函数。哈特里能量则为：\n$$\nE_{\\text{H}}[n] = \\frac{1}{2} \\int n(\\mathbf{r}) \\phi(\\mathbf{r}) d^3\\mathbf{r} = \\frac{1}{2} \\int_0^\\infty 4\\pi r^2 dr \\, \\left(\\frac{\\alpha}{\\pi}\\right)^{3/2} e^{-\\alpha r^2} \\frac{\\text{erf}(\\sqrt{\\alpha}r)}{r}\n$$\n该积分的计算结果为：\n$$\nE_{\\text{H}}[n] = \\sqrt{\\frac{\\alpha}{2\\pi}}\n$$\n由于 $\\alpha = \\omega$，哈特里能量为 $E_{\\text{H}} = \\sqrt{\\frac{\\omega}{2\\pi}}$。\n\n**2. 交换能，$E_{x}^{\\text{LSDA}}[n]$**\n\n对于单个完全自旋极化的电子（$n_\\uparrow = n$, $n_\\downarrow = 0$），LSDA 交换能泛函为：\n$$\nE_{x}^{\\text{LSDA}}[n] = -\\frac{3}{4}\\left(\\frac{3}{\\pi}\\right)^{1/3}\\int d^3\\mathbf{r}\\,n(\\mathbf{r})^{4/3}\n$$\n我们将高斯密度代入此表达式：\n$$\nn(\\mathbf{r})^{4/3} = \\left[\\left(\\frac{\\alpha}{\\pi}\\right)^{3/2} e^{-\\alpha r^2}\\right]^{4/3} = \\left(\\frac{\\alpha}{\\pi}\\right)^2 e^{-\\frac{4\\alpha}{3} r^2}\n$$\n对全空间的积分变为：\n$$\n\\int n(\\mathbf{r})^{4/3} d^3\\mathbf{r} = 4\\pi \\left(\\frac{\\alpha}{\\pi}\\right)^2 \\int_0^\\infty r^2 e^{-\\frac{4\\alpha}{3} r^2} dr\n$$\n这是一个标准的高斯积分，其值为 $\\frac{\\sqrt{\\pi}}{4(4\\alpha/3)^{3/2}}$。因此，整个积分为 $\\frac{3\\sqrt{3}}{8\\sqrt{\\pi}}\\sqrt{\\alpha}$。\n将其代回 $E_{x}^{\\text{LSDA}}[n]$ 的表达式，得到解析结果：\n$$\nE_{x}^{\\text{LSDA}}[n] = -\\frac{3}{4}\\left(\\frac{3}{\\pi}\\right)^{1/3} \\frac{3\\sqrt{3}}{8\\sqrt{\\pi}}\\sqrt{\\alpha} = -\\frac{3^{17/6}}{32 \\pi^{5/6}} \\sqrt{\\omega}\n$$\n\n**3. 相关能，$E_{c}^{\\text{LSDA}}[n]$**\n\n相关能由一个必须进行数值计算的积分给出：\n$$\nE_{c}^{\\text{LSDA}}[n]=\\int d^3\\mathbf{r}\\, n(\\mathbf{r})\\,\\varepsilon_c(r_s(\\mathbf{r}),1) = \\int_0^\\infty 4\\pi r^2 n(r) \\varepsilon_c(r_s(r),1) dr\n$$\nWigner-Seitz 半径 $r_s$ 取决于局域密度 $n(r)$：\n$$\nr_s(r) = \\left(\\frac{3}{4\\pi n(r)}\\right)^{1/3} = \\left(\\frac{3}{4\\pi} \\left(\\frac{\\pi}{\\alpha}\\right)^{3/2} e^{\\alpha r^2}\\right)^{1/3} = \\left(\\frac{3 \\pi^{1/2}}{4 \\alpha^{3/2}}\\right)^{1/3} e^{\\alpha r^2/3}\n$$\n每个粒子的相关能 $\\varepsilon_c(r_s,1)$ 由 Perdew-Zunger 1981 (PZ81) 参数化形式给出，这是一个分段函数，具体取决于 $r_s  1$（高密度区）还是 $r_s \\ge 1$（低密度区）。\n\n条件 $r_s(r)=1$ 定义了一个过渡半径 $r_t$。$r_s(r)$ 是 $r$ 的单调递增函数。其最小值出现在 $r=0$ 处。$r_s(0)$ 的值取决于 $\\alpha$：\n$$\nr_s(0) = \\left(\\frac{3 \\pi^{1/2}}{4 \\alpha^{3/2}}\\right)^{1/3}\n$$\n存在一个 $\\alpha$ 的临界值，记为 $\\alpha_{\\text{crit}}$，在该值处 $r_s(0)=1$：\n$$\n\\alpha_{\\text{crit}} = \\left(\\frac{3\\sqrt{\\pi}}{4}\\right)^{2/3} \\approx 1.2106\n$$\n- 如果 $\\omega = \\alpha \\le \\alpha_{\\text{crit}}$，则对于所有 $r \\ge 0$ 都有 $r_s(r) \\ge 1$。整个积分域使用低密度（$r_s \\ge 1$）的 $\\varepsilon_c$ 公式。\n- 如果 $\\omega = \\alpha  \\alpha_{\\text{crit}}$，则 $r_s(r)$ 在一个特定的半径 $r_t$ 处穿过值 1。积分必须分成两部分。过渡半径 $r_t$ 通过求解 $r_s(r_t)=1$ 得到：\n$$\nr_t = \\sqrt{\\frac{1}{\\alpha} \\ln\\left(\\frac{4 \\alpha^{3/2}}{3 \\pi^{1/2}}\\right)}\n$$\n对于 $\\alpha  \\alpha_{\\text{crit}}$，相关能计算如下：\n$$\nE_c = \\int_0^{r_t} 4\\pi r^2 n(r) \\varepsilon_c(r_s1) dr + \\int_{r_t}^{\\infty} 4\\pi r^2 n(r) \\varepsilon_c(r_s\\ge1) dr\n$$\n\n**数值算法**\n总体算法如下：\n1. 对于每个给定的 $\\omega$ 值，设置 $\\alpha = \\omega$。\n2. 使用推导出的对 $\\sqrt{\\omega}$ 的依赖关系，解析计算 $E_{\\text{H}}$ 和 $E_{x}^{\\text{LSDA}}$。\n3. 对于 $E_{c}^{\\text{LSDA}}$，确定是 $\\alpha \\le \\alpha_{\\text{crit}}$ 还是 $\\alpha  \\alpha_{\\text{crit}}$。\n4. 根据此条件，使用相应的 PZ81 公式为 $E_c$ 建立适当的数值积分。积分可使用像 `scipy.integrate.quad` 这样的求积方法高效计算。无限积分域在一个值 $r_{\\text{max}}$ 处被截断，在该处高斯密度 $n(r)$ 变得可以忽略不计（例如，$\\alpha r_{\\text{max}}^2 \\approx 30$）。\n5. 将三个能量分量相加：$E_{\\text{SIE}} = E_{\\text{H}} + E_{x}^{\\text{LSDA}} + E_{c}^{\\text{LSDA}}$。\n\n此过程为每个指定的频率 $\\omega$ 提供了稳健且准确的自相互作用误差值。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import integrate\n\ndef solve():\n    \"\"\"\n    Computes the self-interaction error for a single electron in a 3D harmonic trap\n    using the Local Density Approximation (LDA) for exchange-correlation.\n    \"\"\"\n    \n    # Define the constants for the PZ81 correlation functional (spin-polarized case, zeta=1)\n    # High-density regime (rs  1)\n    AP = 0.01555\n    BP = -0.0269\n    CP = 0.0007\n    DP = -0.0048\n    # Low-density regime (rs = 1)\n    GAMMA_P = -0.0843\n    BETA_1P = 1.3981\n    BETA_2P = 0.2611\n\n    def calculate_sie(omega):\n        \"\"\"\n        Calculates E_SIE for a given angular frequency omega.\n        \"\"\"\n        alpha = float(omega)\n\n        # 1. Hartree Energy (analytical result)\n        # E_H = sqrt(alpha / (2*pi))\n        e_h = np.sqrt(alpha / (2 * np.pi))\n\n        # 2. Exchange Energy (analytical result for LSDA)\n        # E_x = - (3**(17/6)) / (32 * pi**(5/6)) * sqrt(alpha)\n        exch_coeff = (3**(17/6)) / (32 * np.pi**(5/6))\n        e_x = -exch_coeff * np.sqrt(alpha)\n\n        # 3. Correlation Energy (numerical integration)\n        # Define helper functions for the integrand\n        def n_func(r, a):\n            # Electron density n(r)\n            return (a / np.pi)**1.5 * np.exp(-a * r**2)\n\n        def rs_func_direct(r, a):\n            # Wigner-Seitz radius r_s(r)\n            # This form is numerically stable and avoids underflow of n(r)\n            return ((3 * np.sqrt(np.pi)) / (4 * a**1.5))**(1/3) * np.exp(a * r**2 / 3)\n        \n        # Determine if the integral needs to be split\n        alpha_crit = (3 * np.sqrt(np.pi) / 4)**(2/3) # ~1.2106\n\n        e_c = 0.0\n        # The integration upper bound can be truncated as the Gaussian decays rapidly.\n        # A limit where alpha * r^2 = 35 is sufficient for double precision.\n        r_max_integration = np.sqrt(35 / alpha)\n\n        if alpha = alpha_crit:\n            # For small alpha, rs = 1 for all r. Use only the low-density formula.\n            def ec_integrand_low(r, a):\n                rs = rs_func_direct(r, a)\n                n_r = n_func(r, a)\n                eps_c = GAMMA_P / (1 + BETA_1P * np.sqrt(rs) + BETA_2P * rs)\n                return 4 * np.pi * r**2 * n_r * eps_c\n            \n            e_c, _ = integrate.quad(ec_integrand_low, 0, r_max_integration, args=(alpha,), epsabs=1e-12, epsrel=1e-12)\n        else:\n            # For large alpha, rs crosses 1. Split the integral at r_t.\n            r_t = np.sqrt((1/alpha) * np.log( (4 * alpha**1.5) / (3 * np.sqrt(np.pi)) ))\n\n            # Integrand for high-density regime (rs  1)\n            def ec_integrand_high(r, a):\n                rs = rs_func_direct(r, a)\n                # rs can be very small, so log(rs) might be an issue, but quad handles it.\n                if rs == 0: return 0.0\n                n_r = n_func(r, a)\n                eps_c = AP * np.log(rs) + BP + CP * rs * np.log(rs) + DP * rs\n                return 4 * np.pi * r**2 * n_r * eps_c\n\n            # Integrand for low-density regime (rs = 1)\n            def ec_integrand_low(r, a):\n                rs = rs_func_direct(r, a)\n                n_r = n_func(r, a)\n                eps_c = GAMMA_P / (1 + BETA_1P * np.sqrt(rs) + BETA_2P * rs)\n                return 4 * np.pi * r**2 * n_r * eps_c\n\n            # Part 1: Integral from 0 to r_t (high-density)\n            e_c1, _ = integrate.quad(ec_integrand_high, 0, r_t, args=(alpha,), epsabs=1e-12, epsrel=1e-12)\n            \n            # Part 2: Integral from r_t to infinity (low-density)\n            e_c2, _ = integrate.quad(ec_integrand_low, r_t, r_max_integration, args=(alpha,), epsabs=1e-12, epsrel=1e-12)\n\n            e_c = e_c1 + e_c2\n\n        # Total Self-Interaction Error\n        return e_h + e_x + e_c\n\n    # Define the test cases from the problem statement.\n    test_cases = [0.01, 0.10, 1.00, 5.00, 20.00, 50.00]\n\n    results = []\n    for omega_val in test_cases:\n        result = calculate_sie(omega_val)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3450830"}, {"introduction": "在自相互作用误差分析的基础上，这最后一个实践在一个简单但非平凡的*相互作用*体系——一个双电子原子中，评估LDA的性能。对于这个自旋单重态体系，精确的交换能量和势与Hartree能量和势之间存在一个已知的简单关系。通过将LDA交换量与这些精确基准进行比较，我们可以使用几种标准度量来量化该近似的误差，从而获得关于LDA描述电子-电子交换准确性的实践性见解 [@problem_id:3450757]。", "problem": "考虑一个在三维空间中被角频率为$\\omega$的各向同性谐振子势所限制的双电子自旋单重态系统（使用原子单位：电子质量、基本电荷、约化普朗克常数和$4\\pi\\varepsilon_0$均设为$1$）。其基态Kohn–Sham空间轨道是谐振子基态，这产生了一个球对称的电子密度\n$$\nn_{\\omega}(r) = 2 \\left(\\frac{\\alpha}{\\pi}\\right)^{3/2} e^{-\\alpha r^2}, \\quad \\text{其中 } \\alpha = \\omega,\n$$\n总电子数为$N=2$。对于任何自旋单重态双电子密度，精确交换能等于哈特里（经典库仑）能量的负二分之一，精确交换势等于哈特里势的负二分之一：\n$$\nE_{x}^{\\text{exact}}[n] = -\\frac{1}{2} E_{H}[n], \\quad v_{x}^{\\text{exact}}(\\mathbf{r}) = -\\frac{1}{2} v_{H}(\\mathbf{r}).\n$$\n使用以下基本定义和标准结果作为您的出发点：\n- 哈特里能量为\n$$\nE_{H}[n] = \\frac{1}{2} \\int \\int \\frac{n(\\mathbf{r})\\, n(\\mathbf{r}')}{|\\mathbf{r}-\\mathbf{r}'|} \\, d^3 r \\, d^3 r'.\n$$\n- 在针对自旋非极化系统的均匀电子气的局域密度近似（LDA）中，单位体积的交换能密度为\n$$\ne_{x}^{\\text{LDA}}(n) = - C_{F} \\, n^{4/3}, \\quad \\text{其中 } C_{F} = \\frac{3}{4}\\left(\\frac{3}{\\pi}\\right)^{1/3},\n$$\nLDA交换势是其泛函导数\n$$\nv_{x}^{\\text{LDA}}(n) = \\frac{\\partial e_{x}^{\\text{LDA}}(n)}{\\partial n} = -\\frac{4}{3} C_{F} \\, n^{1/3}.\n$$\n- 哈特里势为\n$$\nv_{H}(\\mathbf{r}) = \\int \\frac{n(\\mathbf{r}')}{|\\mathbf{r}-\\mathbf{r}'|} \\, d^3 r'.\n$$\n任务。为上面给出的高斯密度$n_{\\omega}(r)$推导$E_{x}^{\\text{exact}}(\\omega)$、$E_{x}^{\\text{LDA}}(\\omega)$、$v_{x}^{\\text{exact}}(r;\\omega)$和$v_{x}^{\\text{LDA}}(r;\\omega)$的解析公式。然后，对下面列出的每个$\\omega$测试值，计算三个基准：\n1. 相对交换能误差\n$$\n\\delta_E(\\omega) = \\frac{E_{x}^{\\text{LDA}}(\\omega) - E_{x}^{\\text{exact}}(\\omega)}{\\left|E_{x}^{\\text{exact}}(\\omega)\\right|}.\n$$\n此值为无量纲。\n2. 原点处的逐点交换势误差\n$$\n\\Delta v_0(\\omega) = v_{x}^{\\text{LDA}}(0;\\omega) - v_{x}^{\\text{exact}}(0;\\omega),\n$$\n以哈特里（Hartree）为单位表示。\n3. 全空间上交换势的密度加权$L^2$相对误差，\n$$\n\\delta_{v}^{(2)}(\\omega) = \n\\left(\n\\frac{\\int \\left[v_{x}^{\\text{LDA}}(\\mathbf{r};\\omega) - v_{x}^{\\text{exact}}(\\mathbf{r};\\omega)\\right]^2 n_{\\omega}(\\mathbf{r}) \\, d^3 r}{\\int \\left[v_{x}^{\\text{exact}}(\\mathbf{r};\\omega)\\right]^2 n_{\\omega}(\\mathbf{r}) \\, d^3 r}\n\\right)^{1/2},\n$$\n此值为无量纲。\n\n您必须从上述基本定义和事实出发进行推导。所有能量和势均以哈特里（Hartree）表示，所有长度均以玻尔半径（Bohr radii）表示。\n\n必需的测试套件。使用以下四个限制强度（原子单位）：$\\omega \\in \\{0.05,\\,0.5,\\,2.0,\\,8.0\\}$。\n\n最终输出格式。您的程序应生成单行输出，其中包含一个逗号分隔的列表的列表形式的结果，每个内部列表按顺序对应一个$\\omega$，并按顺序包含三个值$[\\delta_E(\\omega), \\Delta v_0(\\omega), \\delta_{v}^{(2)}(\\omega)]$。该行必须没有空格。例如：“[[x11,x12,x13],[x21,x22,x23],[x31,x32,x33],[x41,x42,x43]]”。", "solution": "该问题要求推导具有高斯密度的双电子系统的精确交换能与交换势，以及局域密度近似（LDA）下的交换能与交换势，然后为指定的限制强度$\\omega$计算三个误差度量。\n\n该双电子自旋单重态系统的电子密度为：\n$$\nn_{\\omega}(r) = 2 \\left(\\frac{\\alpha}{\\pi}\\right)^{3/2} e^{-\\alpha r^2}, \\quad \\text{其中 } \\alpha = \\omega\n$$\n总电子数为 $N=\\int n_{\\omega}(\\mathbf{r}) d^3r = 2$。\n\n**1. 精确交换量的推导**\n\n问题指出，对于双电子自旋单重态系统，精确交换能$E_{x}^{\\text{exact}}$和交换势$v_{x}^{\\text{exact}}$与哈特里能量$E_{H}$和哈特里势$v_{H}$直接相关：\n$$\nE_{x}^{\\text{exact}}[n] = -\\frac{1}{2} E_{H}[n], \\quad v_{x}^{\\text{exact}}(\\mathbf{r}) = -\\frac{1}{2} v_{H}(\\mathbf{r})\n$$\n我们的首要任务是为给定的密度$n_{\\omega}(r)$计算$E_{H}$和$v_{H}$。\n\n**哈特里势, $v_{H}(\\mathbf{r})$**\n哈特里势是由电荷分布$n(\\mathbf{r})$产生的静电势：\n$$\nv_{H}(\\mathbf{r}) = \\int \\frac{n(\\mathbf{r}')}{|\\mathbf{r}-\\mathbf{r}'|} \\, d^3 r'\n$$\n对于总电荷为$N$的球对称高斯电荷分布$n(r) = N (\\frac{\\alpha}{\\pi})^{3/2} e^{-\\alpha r^2}$，距离原点$r$处的势是静电学中的一个标准结果：\n$$\nv_{H}(r) = \\frac{N}{r} \\text{erf}(\\sqrt{\\alpha}r)\n$$\n其中$\\text{erf}(x)$是误差函数。给定$N=2$和$\\alpha=\\omega$，我们有：\n$$\nv_{H}(r;\\omega) = \\frac{2}{r} \\text{erf}(\\sqrt{\\omega}r)\n$$\n因此，精确交换势为：\n$$\nv_{x}^{\\text{exact}}(r;\\omega) = -\\frac{1}{2} v_{H}(r;\\omega) = -\\frac{1}{r} \\text{erf}(\\sqrt{\\omega}r)\n$$\n\n**哈特里能量, $E_{H}[n]$**\n哈特里能量是密度$n(\\mathbf{r})$的自相互作用能：\n$$\nE_{H}[n] = \\frac{1}{2} \\int n(\\mathbf{r}) v_{H}(\\mathbf{r}) \\, d^3 r\n$$\n代入$n_{\\omega}(r)$和$v_{H}(r;\\omega)$的表达式：\n$$\nE_{H}(\\omega) = \\frac{1}{2} \\int_{0}^{\\infty} \\left(2 \\left(\\frac{\\omega}{\\pi}\\right)^{3/2} e^{-\\omega r^2}\\right) \\left(\\frac{2}{r} \\text{erf}(\\sqrt{\\omega}r)\\right) 4\\pi r^2 \\, dr\n$$\n$$\nE_{H}(\\omega) = 8\\pi \\left(\\frac{\\omega}{\\pi}\\right)^{3/2} \\int_{0}^{\\infty} r e^{-\\omega r^2} \\text{erf}(\\sqrt{\\omega}r) \\, dr\n$$\n我们进行变量替换，令$u = \\sqrt{\\omega}r$，则$r = u/\\sqrt{\\omega}$且$dr = du/\\sqrt{\\omega}$。\n$$\nE_{H}(\\omega) = 8\\pi \\frac{\\omega^{3/2}}{\\pi^{3/2}} \\int_{0}^{\\infty} \\left(\\frac{u}{\\sqrt{\\omega}}\\right) e^{-u^2} \\text{erf}(u) \\left(\\frac{du}{\\sqrt{\\omega}}\\right) = \\frac{8\\sqrt{\\omega}}{\\sqrt{\\pi}} \\int_{0}^{\\infty} u e^{-u^2} \\text{erf}(u) \\, du\n$$\n定积分$\\int_{0}^{\\infty} u e^{-u^2} \\text{erf}(u) \\, du$可以使用分部积分法求解，得到$1/(2\\sqrt{2})$。\n$$\nE_{H}(\\omega) = \\frac{8\\sqrt{\\omega}}{\\sqrt{\\pi}} \\left(\\frac{1}{2\\sqrt{2}}\\right) = \\frac{4\\sqrt{\\omega}}{\\sqrt{2\\pi}} = 2\\sqrt{\\frac{2\\omega}{\\pi}}\n$$\n于是，精确交换能为：\n$$\nE_{x}^{\\text{exact}}(\\omega) = -\\frac{1}{2} E_{H}(\\omega) = -\\sqrt{\\frac{2\\omega}{\\pi}}\n$$\n\n**2. LDA交换量的推导**\n\n**LDA交换势, $v_{x}^{\\text{LDA}}(r;\\omega)$**\n自旋非极化系统的LDA交换势由下式给出：\n$$\nv_{x}^{\\text{LDA}}(n) = -\\frac{4}{3} C_{F} \\, n^{1/3}, \\quad \\text{其中 } C_{F} = \\frac{3}{4}\\left(\\frac{3}{\\pi}\\right)^{1/3}\n$$\n首先，我们求$n_{\\omega}(r)^{1/3}$：\n$$\nn_{\\omega}(r)^{1/3} = \\left(2 \\left(\\frac{\\omega}{\\pi}\\right)^{3/2} e^{-\\omega r^2}\\right)^{1/3} = 2^{1/3} \\left(\\frac{\\omega}{\\pi}\\right)^{1/2} e^{-\\frac{\\omega r^2}{3}}\n$$\n将其代入$v_{x}^{\\text{LDA}}$的表达式中：\n$$\nv_{x}^{\\text{LDA}}(r;\\omega) = -\\frac{4}{3} \\left(\\frac{3}{4}\\left(\\frac{3}{\\pi}\\right)^{1/3}\\right) 2^{1/3} \\left(\\frac{\\omega}{\\pi}\\right)^{1/2} e^{-\\frac{\\omega r^2}{3}}\n$$\n$$\nv_{x}^{\\text{LDA}}(r;\\omega) = -\\left(\\frac{3}{\\pi}\\right)^{1/3} 2^{1/3} \\sqrt{\\frac{\\omega}{\\pi}} e^{-\\frac{\\omega r^2}{3}} = -\\left(\\frac{6}{\\pi}\\right)^{1/3} \\sqrt{\\frac{\\omega}{\\pi}} e^{-\\frac{\\omega r^2}{3}}\n$$\n\n**LDA交换能, $E_{x}^{\\text{LDA}}(\\omega)$**\nLDA交换能是交换能密度的积分：\n$$\nE_{x}^{\\text{LDA}}(\\omega) = \\int e_{x}^{\\text{LDA}}(n_{\\omega}(\\mathbf{r})) \\, d^3 r = \\int -C_{F} n_{\\omega}(\\mathbf{r})^{4/3} \\, d^3 r\n$$\n我们可以通过$e_{x}^{\\text{LDA}} = \\frac{3}{4} n v_{x}^{\\text{LDA}}$将其与势关联起来。\n$$\nE_{x}^{\\text{LDA}}(\\omega) = \\frac{3}{4} \\int n_{\\omega}(\\mathbf{r}) v_{x}^{\\text{LDA}}(\\mathbf{r}) \\, d^3 r\n$$\n$$\nE_{x}^{\\text{LDA}}(\\omega) = \\frac{3}{4} \\int_0^\\infty \\left(2 \\left(\\frac{\\omega}{\\pi}\\right)^{3/2} e^{-\\omega r^2}\\right) \\left(-\\left(\\frac{6}{\\pi}\\right)^{1/3} \\sqrt{\\frac{\\omega}{\\pi}} e^{-\\frac{\\omega r^2}{3}}\\right) 4\\pi r^2 \\,dr\n$$\n$$\nE_{x}^{\\text{LDA}}(\\omega) = -\\frac{3}{4} \\cdot 8\\pi \\cdot \\left(\\frac{\\omega}{\\pi}\\right)^2 \\left(\\frac{6}{\\pi}\\right)^{1/3} \\int_0^\\infty r^2 e^{-(\\omega + \\omega/3)r^2} \\,dr\n$$\n$$\nE_{x}^{\\text{LDA}}(\\omega) = -6\\pi \\frac{\\omega^2}{\\pi^2} \\left(\\frac{6}{\\pi}\\right)^{1/3} \\int_0^\\infty r^2 e^{-\\frac{4\\omega}{3}r^2} \\,dr\n$$\n使用标准高斯积分$\\int_0^\\infty x^2 e^{-ax^2}dx = \\frac{\\sqrt{\\pi}}{4a^{3/2}}$，其中$a = 4\\omega/3$：\n$$\n\\int_0^\\infty r^2 e^{-\\frac{4\\omega}{3}r^2} \\,dr = \\frac{\\sqrt{\\pi}}{4(4\\omega/3)^{3/2}} = \\frac{\\sqrt{\\pi}}{4 \\cdot 8/(3\\sqrt{3}) \\cdot \\omega^{3/2}} = \\frac{3\\sqrt{3\\pi}}{32\\omega^{3/2}}\n$$\n将其代回：\n$$\nE_{x}^{\\text{LDA}}(\\omega) = -6 \\frac{\\omega^2}{\\pi} \\left(\\frac{6}{\\pi}\\right)^{1/3} \\frac{3\\sqrt{3\\pi}}{32\\omega^{3/2}} = -\\frac{18\\sqrt{3}}{32} \\frac{\\sqrt{\\omega}}{\\sqrt{\\pi}} \\left(\\frac{6}{\\pi}\\right)^{1/3}\n$$\n$$\nE_{x}^{\\text{LDA}}(\\omega) = -\\frac{9\\sqrt{3}}{16} \\frac{6^{1/3}}{\\pi^{1/3}} \\frac{\\sqrt{\\omega}}{\\pi^{1/2}} = -\\frac{9\\sqrt{3} \\cdot 6^{1/3}}{16\\pi^{5/6}} \\sqrt{\\omega}\n$$\n\n**3. 基准计算**\n\n**1. 相对交换能误差, $\\delta_E(\\omega)$**\n$$\n\\delta_E(\\omega) = \\frac{E_{x}^{\\text{LDA}}(\\omega) - E_{x}^{\\text{exact}}(\\omega)}{\\left|E_{x}^{\\text{exact}}(\\omega)\\right|}\n$$\n由于两种交换能均为负值，我们有 $|E_{x}^{\\text{exact}}(\\omega)| = -E_{x}^{\\text{exact}}(\\omega) = \\sqrt{\\frac{2\\omega}{\\pi}}$。因此，误差为：\n$$\n\\delta_E(\\omega) = \\frac{E_{x}^{\\text{LDA}}(\\omega)}{-E_{x}^{\\text{exact}}(\\omega)} - \\frac{E_{x}^{\\text{exact}}(\\omega)}{-E_{x}^{\\text{exact}}(\\omega)} = 1 - \\frac{E_{x}^{\\text{LDA}}(\\omega)}{E_{x}^{\\text{exact}}(\\omega)}\n$$\n由于$E_{x}^{\\text{LDA}}$和$E_{x}^{\\text{exact}}$都与$\\sqrt{\\omega}$成正比，它们的比值是一个与$\\omega$无关的常数：\n$$\n\\frac{E_{x}^{\\text{LDA}}(\\omega)}{E_{x}^{\\text{exact}}(\\omega)} = \\frac{-\\frac{9\\sqrt{3} \\cdot 6^{1/3}}{16\\pi^{5/6}} \\sqrt{\\omega}}{-\\sqrt{\\frac{2\\omega}{\\pi}}} = \\frac{9\\sqrt{3} \\cdot 6^{1/3}}{16\\pi^{5/6}} \\sqrt{\\frac{\\pi}{2}} = \\frac{9}{16} \\left(\\frac{243}{2\\pi^2}\\right)^{1/6}\n$$\n因此，$\\delta_E$是一个与$\\omega$无关的常数。\n\n**2. 原点处的逐点势误差, $\\Delta v_0(\\omega)$**\n我们需要势在$r=0$处的值。对于$v_{x}^{\\text{exact}}$，我们取极限$r \\to 0$：\n$$\n\\lim_{r\\to 0} v_{x}^{\\text{exact}}(r;\\omega) = \\lim_{r\\to 0} -\\frac{1}{r} \\text{erf}(\\sqrt{\\omega}r)\n$$\n使用泰勒级数$\\text{erf}(x) \\approx \\frac{2}{\\sqrt{\\pi}}x$对小$x$进行近似：\n$$\nv_{x}^{\\text{exact}}(0;\\omega) = \\lim_{r\\to 0} -\\frac{1}{r} \\left(\\frac{2}{\\sqrt{\\pi}}\\sqrt{\\omega}r\\right) = -2\\sqrt{\\frac{\\omega}{\\pi}}\n$$\n对于$v_{x}^{\\text{LDA}}(r;\\omega)$，我们令$r=0$：\n$$\nv_{x}^{\\text{LDA}}(0;\\omega) = -\\left(\\frac{6}{\\pi}\\right)^{1/3} \\sqrt{\\frac{\\omega}{\\pi}}\n$$\n误差为：\n$$\n\\Delta v_0(\\omega) = v_{x}^{\\text{LDA}}(0;\\omega) - v_{x}^{\\text{exact}}(0;\\omega) = \\left(2 - \\left(\\frac{6}{\\pi}\\right)^{1/3}\\right) \\sqrt{\\frac{\\omega}{\\pi}}\n$$\n\n**3. 加权$L^2$相对势误差, $\\delta_{v}^{(2)}(\\omega)$**\n$$\n\\delta_{v}^{(2)}(\\omega)^2 = \n\\frac{\\int [v_{x}^{\\text{LDA}}(\\mathbf{r};\\omega) - v_{x}^{\\text{exact}}(\\mathbf{r};\\omega)]^2 n_{\\omega}(\\mathbf{r}) \\, d^3 r}{\\int [v_{x}^{\\text{exact}}(\\mathbf{r};\\omega)]^2 n_{\\omega}(\\mathbf{r}) \\, d^3 r}\n$$\n我们进行变量替换$u = \\sqrt{\\omega}r$。\n体积元变为$n_{\\omega}(r)d^3r = \\frac{8}{\\sqrt{\\pi}} u^2 e^{-u^2}du$。\n势变为：\n$v_{x}^{\\text{exact}}(r) = -\\frac{\\sqrt{\\omega}}{u}\\text{erf}(u) = \\sqrt{\\omega} V_{\\text{exact}}(u)$\n$v_{x}^{\\text{LDA}}(r) = -\\left(\\frac{6}{\\pi}\\right)^{1/3} \\frac{\\sqrt{\\omega}}{\\sqrt{\\pi}} e^{-u^2/3} = \\sqrt{\\omega} V_{\\text{LDA}}(u)$\n因子$\\sqrt{\\omega}^2 = \\omega$同时出现在分子和分母的积分中，因此可以消去。因此，$\\delta_{v}^{(2)}$也是一个与$\\omega$无关的常数。\n$$\n\\delta_{v}^{(2)2} = \\frac{\\int_0^\\infty [V_{\\text{LDA}}(u) - V_{\\text{exact}}(u)]^2 u^2 e^{-u^2} \\, du}{\\int_0^\\infty [V_{\\text{exact}}(u)]^2 u^2 e^{-u^2} \\, du}\n$$\n被积函数变为：\n分子：$(-C u e^{-u^2/3} + \\text{erf}(u))^2 e^{-u^2}$，其中 $C = \\frac{(6/\\pi)^{1/3}}{\\sqrt{\\pi}}$。\n分母：$(\\text{erf}(u))^2 e^{-u^2}$。\n这些定积分需要通过数值方法计算。\n\n最终的公式在下面的Python代码中实现。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.special import erf\nfrom scipy.integrate import quad\n\ndef solve():\n    \"\"\"\n    Computes benchmarks for the Local Density Approximation (LDA) applied to a \n    two-electron system in a harmonic potential.\n\n    The problem requires calculating three error metrics for the exchange energy and potential:\n    1. delta_E: Relative exchange energy error.\n    2. Delta v_0: Pointwise exchange potential error at the origin.\n    3. delta_v^(2): Density-weighted L^2 relative error of the exchange potential.\n\n    Based on the derivations in the solution text, delta_E and delta_v^(2) are fundamental\n    constants independent of the confinement strength omega, while Delta v_0 scales with sqrt(omega).\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases_omega = [0.05, 0.5, 2.0, 8.0]\n\n    # Use high-precision value of pi\n    pi = np.pi\n\n    # --- Pre-calculate constant benchmarks ---\n\n    # 1. Calculate delta_E (constant)\n    # delta_E = 1 - (E_x^LDA / E_x^exact)\n    # E_x^LDA / E_x^exact = (9/16) * (243 / (2 * pi^2))^(1/6)\n    k_ratio = (9/16) * (243 / (2 * pi**2))**(1/6)\n    delta_E = 1.0 - k_ratio\n\n    # 3. Calculate delta_v^(2) (constant)\n    # This requires numerical integration of two definite integrals, I_num and I_den.\n    # delta_v^(2) = sqrt(I_num / I_den)\n\n    # Constant C in the numerator's integrand\n    # C = ( (6/pi)^(1/3) ) / sqrt(pi)\n    const_v_lda = (6/pi)**(1/3) / np.sqrt(pi)\n\n    def integrand_num(u):\n        \"\"\"Integrand for the numerator of delta_v^(2)^2.\"\"\"\n        # This form avoids division by u at u=0.\n        # [V_LDA(u) - V_exact(u)]^2 * u^2 = [-C * u * exp(-u^2/3) + erf(u)]^2\n        term1 = -const_v_lda * u * np.exp(-u**2 / 3)\n        term2 = erf(u)\n        return (term1 + term2)**2 * np.exp(-u**2)\n\n    def integrand_den(u):\n        \"\"\"Integrand for the denominator of delta_v^(2)^2.\"\"\"\n        # [V_exact(u)]^2 * u^2 = erf(u)^2\n        return erf(u)**2 * np.exp(-u**2)\n    \n    # Perform numerical integration from 0 to infinity.\n    # The integration returns a tuple (result, error_estimate). We only need the result.\n    I_num, _ = quad(integrand_num, 0, np.inf)\n    I_den, _ = quad(integrand_den, 0, np.inf)\n    \n    delta_v_sq = np.sqrt(I_num / I_den)\n    \n    # --- Compute benchmarks for each omega ---\n    \n    results = []\n    for omega in test_cases_omega:\n        # 2. Calculate Delta v_0(omega)\n        # Delta v_0(w) = (2 - (6/pi)^(1/3)) * sqrt(w/pi)\n        dv0_const = 2.0 - (6/pi)**(1/3)\n        delta_v0 = dv0_const * np.sqrt(omega / pi)\n        \n        # Assemble the results for the current omega\n        current_result = [delta_E, delta_v0, delta_v_sq]\n        results.append(current_result)\n\n    # Format the final output as a single string with no spaces as required.\n    # e.g., \"[[x11,x12,x13],[x21,x22,x23],...]\"\n    output_str = \"[\" + \",\".join([\"[\" + \",\".join(map(str, res)) + \"]\" for res in results]) + \"]\"\n\n    # Final print statement in the exact required format.\n    print(output_str)\n\nsolve()\n```", "id": "3450757"}]}