{"hands_on_practices": [{"introduction": "我们从分析一个看似最直观的数值方案开始：时间上使用前向欧拉法，空间上使用中心差分法。这项练习将运用冯·诺依曼稳定性分析，揭示这种组合方法的一个根本性缺陷。这个被称为 FTCS（时间前向，空间中心）的方案将展示为何为保证模拟的稳定性，谨慎选择数值方法是至关重要的 [@problem_id:3518829]。", "problem": "在一个分步多物理场求解器中，有一个线性平流子步骤，该求解器在流体平流和被动标量输运之间交替进行。考虑具有恒定波速的一维标量平流方程：\n$$\nu_{t} + a\\,u_{x} = 0\n$$\n该方程定义在周期为 $L$ 的周期性域上，其中 $a>0$ 为常数。在空间步长为 $\\Delta x$、时间步长为 $\\Delta t$ 的均匀网格上，平流子步骤通过时间上的前向欧拉更新和空间上的中心差分进行近似。用 $u_{j}^{n}$ 表示空间索引为 $j$、时间层为 $n$ 处的数值解。假设解和离散算子都是周期性且具有平移不变性。\n\n从前向欧拉法和中心差分算子的定义出发，并使用与周期性域兼容的空间傅里叶模态，执行 von Neumann（傅里叶）稳定性分析，以确定离散放大因子及其模。引入由 $C = a\\,\\Delta t / \\Delta x$ 定义的 Courant-Friedrichs-Lewy (CFL) 数 $C$，以及与空间傅里叶模态相关的无量纲相位 $\\theta$。利用以下事实：对于周期性网格上的线性、常系数、平移不变格式，复指数是离散空间导数的特征函数。\n\n基于第一性原理和你推导出的放大因子的模，解释为什么这种时空离散格式在 von Neumann 意义上是无条件不稳定的。你的最终答案应为放大因子的模关于 $\\theta$ 和 $C$ 的单个、闭式解析表达式。最终答案中不包含任何单位。无需进行数值舍入。", "solution": "首先验证问题陈述，以确保其科学基础可靠、适定且客观。\n\n**步骤 1：提取已知条件**\n- **控制方程：** $u_{t} + a\\,u_{x} = 0$\n- **波速：** $a > 0$，常数。\n- **域：** 周期性，周期为 $L$。\n- **离散化：**\n  - 时间：前向欧拉法。\n  - 空间：中心差分法。\n  - 网格：均匀网格，空间步长为 $\\Delta x$，时间步长为 $\\Delta t$。\n- **数值解记法：** $u_{j}^{n}$，在空间索引 $j$ 和时间层 $n$ 处。\n- **假设：** 解和离散算子具有周期性及平移不变性。\n- **分析方法：** von Neumann（傅里叶）稳定性分析。\n- **定义：**\n  - Courant-Friedrichs-Lewy (CFL) 数： $C = a\\,\\Delta t / \\Delta x$。\n  - 无量纲相位： $\\theta$，用于空间傅里叶模态。\n- **任务：** 推导离散放大因子及其模，并用该结果解释为什么该格式是无条件不稳定的。\n\n**步骤 2：使用提取的已知条件进行验证**\n该问题是偏微分方程数值分析中的一个经典练习。控制方程是基本的线性平流方程。数值格式（时间前向，空间中心，或 FTCS）是一种标准但有缺陷的离散化方法。分析方法，即 von Neumann 稳定性分析，是处理周期性域上线性常系数问题的标准工具。所有定义和术语（$C$, $\\theta$）都是标准的。该问题是自洽的、科学上合理的且适定的。它没有违反任何无效标准。\n\n**步骤 3：结论与行动**\n该问题有效。将提供完整解答。\n\n**求解推导**\n\n给定的偏微分方程（PDE）是一维线性平流方程：\n$$\n\\frac{\\partial u}{\\partial t} + a \\frac{\\partial u}{\\partial x} = 0\n$$\n我们被要求使用时间上的前向差分（前向欧拉法）和空间上的中心差分来离散化这个方程。在网格点 $(j, n)$ 处，时间导数的前向差分近似为：\n$$\n\\frac{\\partial u}{\\partial t} \\bigg|_{j}^{n} \\approx \\frac{u_{j}^{n+1} - u_{j}^{n}}{\\Delta t}\n$$\n空间导数的中心差分近似为：\n$$\n\\frac{\\partial u}{\\partial x} \\bigg|_{j}^{n} \\approx \\frac{u_{j+1}^{n} - u_{j-1}^{n}}{2 \\Delta x}\n$$\n将这些近似代入偏微分方程，得到有限差分方程：\n$$\n\\frac{u_{j}^{n+1} - u_{j}^{n}}{\\Delta t} + a \\left( \\frac{u_{j+1}^{n} - u_{j-1}^{n}}{2 \\Delta x} \\right) = 0\n$$\n为了找到 $u_{j}^{n+1}$ 的更新规则，我们求解此项：\n$$\nu_{j}^{n+1} = u_{j}^{n} - a \\frac{\\Delta t}{2 \\Delta x} (u_{j+1}^{n} - u_{j-1}^{n})\n$$\n我们引入 Courant-Friedrichs-Lewy (CFL) 数，定义为 $C = a\\,\\Delta t / \\Delta x$。将 $C$ 代入方程，得到离散格式的最终形式：\n$$\nu_{j}^{n+1} = u_{j}^{n} - \\frac{C}{2} (u_{j+1}^{n} - u_{j-1}^{n})\n$$\n对于 von Neumann 稳定性分析，我们考虑单个空间傅里叶模态作为解。在具有点 $x_j = j \\Delta x$ 的网格上，一个通用的傅里叶模态具有 $e^{i k x_j} = e^{i k j \\Delta x}$ 的形式，其中 $k$ 是波数。我们定义无量纲相角 $\\theta = k \\Delta x$。在给定时间层 $n$ 的解表示为这些模态的叠加。由于格式的线性特性，我们可以分析单个模态的行为：\n$$\nu_{j}^{n} = \\hat{u}^{n}(k) e^{i j \\theta}\n$$\n其中 $\\hat{u}^{n}(k)$ 是在时间层 $n$ 处，相位为 $\\theta$ 的模态的振幅。将此拟设代入离散格式得到：\n$$\n\\hat{u}^{n+1} e^{i j \\theta} = \\hat{u}^{n} e^{i j \\theta} - \\frac{C}{2} \\left( \\hat{u}^{n} e^{i (j+1) \\theta} - \\hat{u}^{n} e^{i (j-1) \\theta} \\right)\n$$\n我们可以提出公因子 $\\hat{u}^{n} e^{i j \\theta}$：\n$$\n\\hat{u}^{n+1} e^{i j \\theta} = \\hat{u}^{n} e^{i j \\theta} \\left( 1 - \\frac{C}{2} (e^{i \\theta} - e^{-i \\theta}) \\right)\n$$\n两边除以 $e^{i j \\theta}$ 得到模态振幅的演化：\n$$\n\\hat{u}^{n+1} = \\hat{u}^{n} \\left( 1 - \\frac{C}{2} (e^{i \\theta} - e^{-i \\theta}) \\right)\n$$\n放大因子 $G(\\theta)$ 定义为连续时间步长上振幅的比率，即 $G(\\theta) = \\hat{u}^{n+1} / \\hat{u}^{n}$。因此：\n$$\nG(\\theta) = 1 - \\frac{C}{2} (e^{i \\theta} - e^{-i \\theta})\n$$\n使用欧拉恒等式 $e^{i\\phi} - e^{-i\\phi} = 2i\\sin(\\phi)$，我们可以简化 $G(\\theta)$ 的表达式：\n$$\nG(\\theta) = 1 - \\frac{C}{2} (2i \\sin(\\theta)) = 1 - iC\\sin(\\theta)\n$$\n这是复放大因子。为了评估稳定性，我们必须求出其模 $|G(\\theta)|$。对于一个复数 $z = x + iy$，其模为 $|z| = \\sqrt{x^2 + y^2}$。在我们的例子中，实部是 $1$，虚部是 $-C\\sin(\\theta)$。\n$$\n|G(\\theta)| = \\sqrt{1^2 + (-C\\sin(\\theta))^2}\n$$\n$$\n|G(\\theta)| = \\sqrt{1 + C^2 \\sin^2(\\theta)}\n$$\n该表达式给出了放大因子的模，它是 CFL 数 $C$ 和无量纲相位 $\\theta$ 的函数。\n\n**无条件不稳定性的解释**\n对于一个数值格式，von Neumann 稳定性判据要求所有可能的傅里叶模态的放大因子的模都必须小于或等于 1，即对所有 $\\theta \\in [-\\pi, \\pi]$ 都有 $|G(\\theta)| \\le 1$。如果任何一个模态违反了这个条件，该模态的振幅将在每个时间步呈指数增长，导致数值不稳定，并迅速淹没真实解。\n\n我们来检验推导出的模 $|G(\\theta)| = \\sqrt{1 + C^2 \\sin^2(\\theta)}$。\n根据问题陈述，波速 $a$ 是正的。网格间距 $\\Delta x$ 和时间步长 $\\Delta t$ 也是正的物理量。因此，CFL 数 $C = a \\Delta t / \\Delta x$ 是严格为正的（$C > 0$）。\n项 $\\sin^2(\\theta)$ 总是非负的，即 $\\sin^2(\\theta) \\ge 0$。\n因此，乘积 $C^2 \\sin^2(\\theta)$ 也是非负的。\n\n仅在以下情况下 $C^2 \\sin^2(\\theta) = 0$：\n1.  如果 $C = 0$。这是一个平凡的情况，其中 $\\Delta t = 0$，意味着模拟在时间上没有推进。\n2.  如果 $\\sin(\\theta) = 0$。这发生在 $\\theta = n\\pi$（其中 $n$ 为任意整数）时。这些模态对应于网格上的常数值（$\\theta=0$）或奈奎斯特频率模态（$\\theta=\\pi$），它们分别具有无限波长或最小波长。对于这些特定的模态， $|G(\\theta)| = \\sqrt{1+0} = 1$，所以它们不会增长。\n\n然而，对于任何其他傅里叶模态，其中 $\\sin(\\theta) \\neq 0$，项 $C^2 \\sin^2(\\theta)$ 都是严格为正的。因此，对于任何这样的模态：\n$$\n1 + C^2 \\sin^2(\\theta) > 1\n$$\n取平方根，我们发现：\n$$\n|G(\\theta)| = \\sqrt{1 + C^2 \\sin^2(\\theta)} > 1\n$$\n这个不等式对于任何非零的 CFL 数 $C$ 和任何非 $\\pi$ 整数倍的模态 $\\theta$ 都成立。由于稳定性判据必须对所有模态都满足，而对于几乎所有模态，无论如何选择 $\\Delta t$ 和 $\\Delta x$（只要 $C>0$），该判据都无法满足，因此该格式对于任何时间步长的选择都是不稳定的。这就是无条件不稳定性的定义。放大因子中的虚数项 $iC\\sin(\\theta)$ 源于中心差分算子，其作用纯粹是在每个时间步向系统增加能量，而没有任何相应的耗散机制，导致解无界增长。", "answer": "$$\n\\boxed{\\sqrt{1 + C^2 \\sin^2(\\theta)}}\n$$", "id": "3518829"}, {"introduction": "在见证了中心差分方案的失败后，我们现在转向一种基于平流物理特性的方法：迎风格式。这项练习将展示如何通过使数值模板与信息流动方向对齐来构建一个条件稳定的数值方案。我们将再次使用冯·诺依曼分析来推导其特定的稳定性约束，即经典的 Courant-Friedrichs-Lewy (CFL) 条件 [@problem_id:3518897]。", "problem": "考虑在一维分区多物理场环境中，一个被动标量 $u(x,t)$ 以恒定速度 $a$ 平流，其中标量 $u$ 代表通过显式、滞后耦合与第二个物理模块交换的场。输运步骤的控制偏微分方程 (PDE) 为 $u_{t} + a\\,u_{x} = 0$，定义在一个长度为 $L$ 的周期性域上，网格间距均匀，为 $\\Delta x = L/N$，其中 $N$ 是一个正整数。与第二个物理模块的耦合是代数的且在时间上是滞后的，因此在显式输运更新期间，它不会改变作用于 $u$ 的空间算子。\n\n你使用空间上的一阶迎风有限差分和时间上步长为 $\\Delta t$ 的前向欧拉更新来离散化该输运方程。必须根据 $a$ 的符号选择迎风格式，以确保物理迎风特性。假设采用周期性边界条件，并用 $u_{j}^{n} \\approx u(j\\,\\Delta x, n\\,\\Delta t)$ 表示所有整数索引 $j$ 和时间层 $n$ 的网格值。\n\n使用 von Neumann (傅里叶) 稳定性分析，推导该格式的放大因子，并确定 $\\Delta t$ 需满足的条件，以使得对于周期性网格所容许的任何傅里叶模态，放大因子的模都不超过 1。由此，以 $a$ 和 $\\Delta x$ 的闭式表达式形式，导出保持稳定性的最大允许时间步长。报告此最大稳定时间步长，并以秒为单位表示你的最终答案。不要引用任何已有的 Courant-Friedrichs-Lewy (CFL) 条件；而是直接从离散更新和傅里叶模态 ansatz 推导它。最终答案必须是单个解析表达式。", "solution": "首先验证问题，以确保其科学上合理、自洽且适定。\n\n### 步骤 1：提取已知条件\n- **控制 PDE**：$u_{t} + a\\,u_{x} = 0$，其中 $u(x,t)$ 是一个被动标量，$a$ 是一个恒定的平流速度。\n- **域**：周期性，长度为 $L$。\n- **网格**：均匀间距 $\\Delta x = L/N$，其中 $N$ 为正整数。\n- **时间离散**：前向欧拉法，时间步长为 $\\Delta t$。\n- **空间离散**：一阶迎风有限差分。\n- **边界条件**：周期性。\n- **记号**：$u_{j}^{n} \\approx u(j\\,\\Delta x, n\\,\\Delta t)$。\n- **分析方法**：von Neumann 稳定性分析。\n- **目标**：推导放大因子，并找到最大稳定时间步长 $\\Delta t_{max}$，作为 $a$ 和 $\\Delta x$ 的函数。\n\n### 步骤 2：使用提取的已知条件进行验证\n- **科学依据**：该问题探讨了线性平流方程的标准数值格式（时间前向，空间迎风）的稳定性，这是计算流体动力学的基石之一。使用 von Neumann 分析是解决此类问题的正确且标准的程序。该设定在科学上是严谨的。\n- **适定性**：问题定义清晰，包含所有必要组成部分：PDE、离散化方法、边界条件以及待回答的问题。该格式存在一个唯一、明确的稳定性判据。\n- **客观性**：问题以精确、客观和标准的数学语言陈述，没有歧义或主观陈述。\n\n### 步骤 3：结论与行动\n问题有效。这是一个数值分析中的经典且适定的问题。现在开始求解过程。\n\n### 稳定性条件的推导\n\n控制偏微分方程为：\n$$\n\\frac{\\partial u}{\\partial t} + a \\frac{\\partial u}{\\partial x} = 0\n$$\n我们使用时间上的前向差分（前向欧拉法）和空间上的一阶迎风差分来离散化该方程。迎风格式的选择取决于平流速度 $a$ 的符号。\n\n时间导数近似为：\n$$\n\\frac{\\partial u}{\\partial t} \\bigg|_{j}^{n} \\approx \\frac{u_{j}^{n+1} - u_{j}^{n}}{\\Delta t}\n$$\n空间导数 $\\frac{\\partial u}{\\partial x}$ 根据信息来源的“上游”方向进行近似。\n\n**情况 1: $a > 0$**\n如果速度 $a$ 为正，波从左向右传播。迎风方向在左侧，因此我们使用后向差分来近似空间导数：\n$$\n\\frac{\\partial u}{\\partial x} \\bigg|_{j}^{n} \\approx \\frac{u_{j}^{n} - u_{j-1}^{n}}{\\Delta x}\n$$\n将这些近似代入 PDE $u_t = -a u_x$ 中，得到离散更新方程：\n$$\n\\frac{u_{j}^{n+1} - u_{j}^{n}}{\\Delta t} = -a \\left( \\frac{u_{j}^{n} - u_{j-1}^{n}}{\\Delta x} \\right)\n$$\n$$\nu_{j}^{n+1} = u_{j}^{n} - \\frac{a \\Delta t}{\\Delta x} (u_{j}^{n} - u_{j-1}^{n})\n$$\n\n**情况 2: $a < 0$**\n如果速度 $a$ 为负，波从右向左传播。迎风方向在右侧，因此我们使用前向差分来近似空间导数：\n$$\n\\frac{\\partial u}{\\partial x} \\bigg|_{j}^{n} \\approx \\frac{u_{j+1}^{n} - u_{j}^{n}}{\\Delta x}\n$$\n代入 PDE 得到离散更新方程：\n$$\n\\frac{u_{j}^{n+1} - u_{j}^{n}}{\\Delta t} = -a \\left( \\frac{u_{j+1}^{n} - u_{j}^{n}}{\\Delta x} \\right)\n$$\n$$\nu_{j}^{n+1} = u_{j}^{n} - \\frac{a \\Delta t}{\\Delta x} (u_{j+1}^{n} - u_{j}^{n})\n$$\n\n现在，我们进行 von Neumann 稳定性分析。我们考虑网格上解的单个傅里叶模态：\n$$\nu_{j}^{n} = G^{n} e^{i k x_{j}} = G^{n} e^{i k j \\Delta x}\n$$\n其中 $k$ 是波数，$i = \\sqrt{-1}$，$G$ 是每个时间步的放大因子。为使格式稳定，对于任何可能的波数，放大因子的模都不得超过 1，即 $|G| \\le 1$。\n\n让我们用这个 ansatz 重新分析这两种情况。\n\n**对 $a > 0$ 的稳定性分析**\n我们将傅里叶模态代入 $a > 0$ 的离散方程中：\n$$\nG^{n+1} e^{i k j \\Delta x} = G^{n} e^{i k j \\Delta x} - \\frac{a \\Delta t}{\\Delta x} \\left( G^{n} e^{i k j \\Delta x} - G^{n} e^{i k (j-1) \\Delta x} \\right)\n$$\n我们定义库朗数 $\\sigma = \\frac{a \\Delta t}{\\Delta x}$。由于 $a > 0$，$\\sigma$ 是正的。将整个方程除以 $G^n e^{i k j \\Delta x}$，得到放大因子 $G$：\n$$\nG = 1 - \\sigma \\left( 1 - e^{-i k \\Delta x} \\right)\n$$\n令 $\\theta = k \\Delta x$ 为无量纲波数。\n$$\nG = 1 - \\sigma (1 - (\\cos\\theta - i\\sin\\theta)) = (1 - \\sigma + \\sigma\\cos\\theta) + i\\sigma\\sin\\theta\n$$\n放大因子的模的平方是 $|G|^2$：\n$$\n|G|^2 = (1 - \\sigma + \\sigma\\cos\\theta)^2 + (\\sigma\\sin\\theta)^2\n$$\n$$\n|G|^2 = (1 - \\sigma(1 - \\cos\\theta))^2 + \\sigma^2 \\sin^2\\theta\n$$\n$$\n|G|^2 = 1 - 2\\sigma(1 - \\cos\\theta) + \\sigma^2(1 - \\cos\\theta)^2 + \\sigma^2\\sin^2\\theta\n$$\n使用 $\\sin^2\\theta = (1-\\cos\\theta)(1+\\cos\\theta)$:\n$$\n|G|^2 = 1 - 2\\sigma(1 - \\cos\\theta) + \\sigma^2(1 - \\cos\\theta)^2 + \\sigma^2(1 - \\cos\\theta)(1 + \\cos\\theta)\n$$\n$$\n|G|^2 = 1 - 2\\sigma(1 - \\cos\\theta) + \\sigma^2(1 - \\cos\\theta) [ (1 - \\cos\\theta) + (1 + \\cos\\theta) ]\n$$\n$$\n|G|^2 = 1 - 2\\sigma(1 - \\cos\\theta) + \\sigma^2(1 - \\cos\\theta)(2)\n$$\n$$\n|G|^2 = 1 - 2\\sigma(1 - \\cos\\theta) + 2\\sigma^2(1 - \\cos\\theta)\n$$\n$$\n|G|^2 = 1 - 2\\sigma(1 - \\sigma)(1 - \\cos\\theta)\n$$\n为保证稳定性，我们要求 $|G|^2 \\le 1$。这意味着 $1 - 2\\sigma(1 - \\sigma)(1 - \\cos\\theta) \\le 1$，简化后为：\n$$\n-2\\sigma(1 - \\sigma)(1 - \\cos\\theta) \\le 0\n$$\n由于 $\\sigma = \\frac{a \\Delta t}{\\Delta x} > 0$ 且对所有实数 $\\theta$，$(1 - \\cos\\theta) \\ge 0$，该不等式成立的充要条件是：\n$$\n1 - \\sigma \\ge 0 \\implies \\sigma \\le 1\n$$\n因此，对于 $a > 0$，稳定性条件是 $\\frac{a \\Delta t}{\\Delta x} \\le 1$。\n\n**对 $a < 0$ 的稳定性分析**\n我们将傅里叶模态代入 $a < 0$ 的离散方程中：\n$$\nG^{n+1} e^{i k j \\Delta x} = G^{n} e^{i k j \\Delta x} - \\frac{a \\Delta t}{\\Delta x} \\left( G^{n} e^{i k (j+1) \\Delta x} - G^{n} e^{i k j \\Delta x} \\right)\n$$\n再次，令 $\\sigma = \\frac{a \\Delta t}{\\Delta x}$。由于 $a < 0$，$\\sigma$ 是负的。方程两边同除以 $G^n e^{i k j \\Delta x}$ 得到：\n$$\nG = 1 - \\sigma (e^{i k \\Delta x} - 1)\n$$\n我们定义一个非负库朗数 $C = \\frac{|a| \\Delta t}{\\Delta x}$。那么 $\\sigma = -C$。将此代入 $G$ 的表达式中：\n$$\nG = 1 - (-C) (e^{i\\theta} - 1) = 1 + C(e^{i\\theta} - 1)\n$$\n$$\nG = 1 + C(\\cos\\theta - 1 + i\\sin\\theta) = (1 - C + C\\cos\\theta) + iC\\sin\\theta\n$$\n这个 $G$ 的表达式在形式上与为 $a > 0$ 推导出的表达式相同，只是用 $C$ 替换了 $\\sigma$。因此，后续对 $|G|^2$ 的推导也是相同的，只需将 $\\sigma$ 替换为 $C$：\n$$\n|G|^2 = 1 - 2C(1 - C)(1 - \\cos\\theta)\n$$\n为保证稳定性，需满足 $|G|^2 \\le 1$，即要求 $-2C(1 - C)(1 - \\cos\\theta) \\le 0$。\n由于 $C = \\frac{|a| \\Delta t}{\\Delta x} > 0$ 且 $(1 - \\cos\\theta) \\ge 0$，该不等式成立的充要条件是：\n$$\n1 - C \\ge 0 \\implies C \\le 1\n$$\n因此，对于 $a < 0$，稳定性条件是 $\\frac{|a| \\Delta t}{\\Delta x} \\le 1$。\n\n**结论**\n两种情况都导出了相同的稳定性要求，该要求可以使用速度的绝对值紧凑地表示为：\n$$\n\\frac{|a| \\Delta t}{\\Delta x} \\le 1\n$$\n这就是一阶迎风格式的 Courant-Friedrichs-Lewy (CFL) 条件。问题要求的是使格式稳定的最大允许时间步长 $\\Delta t_{max}$。这在条件达到其极限时获得：\n$$\n\\frac{|a| \\Delta t_{max}}{\\Delta x} = 1\n$$\n求解 $\\Delta t_{max}$ 得到最终表达式。\n$$\n\\Delta t_{max} = \\frac{\\Delta x}{|a|}\n$$\n此表达式代表了能确保网格可分辨的任何傅里叶模态都数值稳定的最大时间步长。它的物理意义是，在单个时间步内，信息传播的距离不能超过一个网格单元。", "answer": "$$\n\\boxed{\\frac{\\Delta x}{|a|}}\n$$", "id": "3518897"}, {"introduction": "实际的模拟问题很少能拥有标准傅里叶分析所依赖的周期性边界条件这一理想环境。最后的这项练习将超越理想化的周期性区域，探讨在有限系统中边界条件如何影响稳定性。通过分析一个带有特定入口边界处理的小型双单元系统，我们将学习如何应用矩阵稳定性分析来确定 CFL 极限，并揭示边界本身可能比内部格式施加更严格的约束 [@problem_id:3518925]。", "problem": "考虑一个从更大的多物理场耦合模拟中提取出的一维线性输运子问题，其中一个守恒标量场 $u(x,t)$（例如，被规定流场平流的被动热示踪剂）遵循平流方程 $\\partial_t u + a \\,\\partial_x u = 0$，作用于一个由 $2$ 个大小为 $\\Delta x$ 的均匀有限体积单元组成的短域上，平流速度为常数 $a>0$。时间离散化采用时间步长为 $\\Delta t$ 的显式前向欧拉方法。空间离散化采用一阶迎风有限体积法，每个面上的通量为 $F = a \\, u$。这里的 Courant–Friedrichs–Lewy (CFL) 数定义为 $\\nu = \\dfrac{a \\, \\Delta t}{\\Delta x}$。\n\n位于 $x=0$ 的左边界是流入边界，通过一个虚拟单元值 $u_0$ 来施加，该值进入第一个内部单元的左侧面通量。考虑两种边界处理方式：\n\n- 反射（零梯度）虚拟单元，$u_0 = u_1$。\n- 用于施加流入的罚函数虚拟单元，$u_0 = u_1 - \\tau \\,(u_1 - u_{\\mathrm{in}})$，其中 $u_{\\mathrm{in}}$ 是一个恒定的流入状态，$\\tau>0$ 是一个无量纲的罚系数。\n\n位于 $x=2 \\Delta x$ 的右边界是流出边界，对于 $a>0$ 无需特殊处理。假设 $u_{\\mathrm{in}}$ 随时间恒定，因此它仅作为对第一个单元的稳态非齐次强迫项。\n\n从平流方程、守恒有限体积更新和显式前向欧拉时间步进出发，为两种边界处理方式分别推导将 $\\begin{pmatrix} u_1^n \\\\ u_2^n \\end{pmatrix}$ 映射到 $\\begin{pmatrix} u_1^{n+1} \\\\ u_2^{n+1} \\end{pmatrix}$ 的齐次双单元放大算子。然后，利用应用于齐次放大算子特征值的前向欧拉绝对稳定性要求，确定 CFL 数 $\\nu$ 关于罚参数 $\\tau$ 的紧界。\n\n最后，计算当罚系数 $\\tau = 3$ 时，罚函数流入边界所允许的最大 CFL 数。将最终答案以单个无单位的简化有理数形式给出。无需四舍五入。", "solution": "该问题要求推导一维平流方程在两种不同边界条件下双单元有限体积离散的放大算子，然后进行稳定性分析，以找到其中一种条件下的 CFL 限制。\n\n首先，我们建立两个单元中标量场 $u(x,t)$ 的半离散有限体积方程。设 $u_1(t)$ 和 $u_2(t)$ 分别是单元 1 ($[0, \\Delta x]$) 和单元 2 ($[\\Delta x, 2\\Delta x]$) 中的单元平均值。控制偏微分方程为 $\\partial_t u + a \\, \\partial_x u = 0$。\n\n单元 $i$ 的守恒有限体积公式为：\n$$ \\frac{d u_i}{dt} = - \\frac{1}{\\Delta x} (F_{i+1/2} - F_{i-1/2}) $$\n其中 $F_{i \\pm 1/2}$ 是单元面上的数值通量。我们双单元系统的面位于 $x_{1/2}=0$、$x_{3/2}=\\Delta x$ 和 $x_{5/2}=2\\Delta x$。\n\n$u_1$ 和 $u_2$ 的更新方程为：\n$$ \\frac{d u_1}{dt} = - \\frac{1}{\\Delta x} (F_{3/2} - F_{1/2}) $$\n$$ \\frac{d u_2}{dt} = - \\frac{1}{\\Delta x} (F_{5/2} - F_{3/2}) $$\n\n我们对通量 $F=au$ 使用一阶迎风格式。由于平流速度 $a>0$，流动方向是从左到右。任何面上的通量由其紧邻左侧的单元值确定。\n- 单元 1 和 2 之间的交界面 $x_{3/2}=\\Delta x$ 处的通量为 $F_{3/2} = a u_1$。\n- 流出边界 $x_{5/2}=2\\Delta x$ 处的通量为 $F_{5/2} = a u_2$。\n- 流入边界 $x_{1/2}=0$ 处的通量为 $F_{1/2} = a u_0$，其中 $u_0$ 是单元 1 左侧虚拟单元中的值。\n\n将这些通量代入守恒律可得：\n$$ \\frac{d u_1}{dt} = - \\frac{1}{\\Delta x} (a u_1 - a u_0) = \\frac{a}{\\Delta x} (u_0 - u_1) $$\n$$ \\frac{d u_2}{dt} = - \\frac{1}{\\Delta x} (a u_2 - a u_1) = \\frac{a}{\\Delta x} (u_1 - u_2) $$\n\n该系统可以写成向量形式：\n$$ \\frac{d}{dt} \\begin{pmatrix} u_1 \\\\ u_2 \\end{pmatrix} = \\frac{a}{\\Delta x} \\begin{pmatrix} -1  0 \\\\ 1  -1 \\end{pmatrix} \\begin{pmatrix} u_1 \\\\ u_2 \\end{pmatrix} + \\frac{a}{\\Delta x} \\begin{pmatrix} u_0 \\\\ 0 \\end{pmatrix} $$\n\n为确定齐次放大算子，我们必须用 $u_1$ 和 $u_2$ 表示 $u_0$，并将任何外部强迫项设为零。\n\n**情况 1：反射边界条件**\n边界条件为 $u_0 = u_1$。将其代入 $du_1/dt$ 的方程中：\n$$ \\frac{d u_1}{dt} = \\frac{a}{\\Delta x} (u_1 - u_1) = 0 $$\n$$ \\frac{d u_2}{dt} = \\frac{a}{\\Delta x} (u_1 - u_2) $$\n半离散系统为 $\\frac{d\\mathbf{u}}{dt} = A_1 \\mathbf{u}$，其中 $\\mathbf{u} = \\begin{pmatrix} u_1 \\\\ u_2 \\end{pmatrix}$，矩阵 $A_1$ 为：\n$$ A_1 = \\frac{a}{\\Delta x} \\begin{pmatrix} 0  0 \\\\ 1  -1 \\end{pmatrix} $$\n应用显式前向欧拉方法，$\\mathbf{u}^{n+1} = \\mathbf{u}^n + \\Delta t (A_1 \\mathbf{u}^n) = (I + \\Delta t A_1) \\mathbf{u}^n$。放大算子 $G_1$ 为 $G_1 = I + \\Delta t A_1$。定义 CFL 数 $\\nu = \\frac{a \\Delta t}{\\Delta x}$：\n$$ G_1 = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} + \\frac{a \\Delta t}{\\Delta x} \\begin{pmatrix} 0  0 \\\\ 1  -1 \\end{pmatrix} = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} + \\nu \\begin{pmatrix} 0  0 \\\\ 1  -1 \\end{pmatrix} = \\begin{pmatrix} 1  0 \\\\ \\nu  1-\\nu \\end{pmatrix} $$\n\n**情况 2：罚函数边界条件**\n边界条件为 $u_0 = u_1 - \\tau(u_1 - u_{\\mathrm{in}})$。对于齐次系统，我们将外部强迫项 $u_{\\mathrm{in}}$ 设为零，得到 $u_0 = u_1 - \\tau u_1 = (1-\\tau)u_1$。\n将其代入 $du_1/dt$ 的方程中：\n$$ \\frac{d u_1}{dt} = \\frac{a}{\\Delta x} ((1-\\tau)u_1 - u_1) = -\\frac{a\\tau}{\\Delta x} u_1 $$\n$$ \\frac{d u_2}{dt} = \\frac{a}{\\Delta x} (u_1 - u_2) $$\n半离散系统为 $\\frac{d\\mathbf{u}}{dt} = A_2 \\mathbf{u}$，矩阵 $A_2$ 为：\n$$ A_2 = \\frac{a}{\\Delta x} \\begin{pmatrix} -\\tau  0 \\\\ 1  -1 \\end{pmatrix} $$\n放大算子 $G_2$ 为 $G_2 = I + \\Delta t A_2$：\n$$ G_2 = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} + \\frac{a \\Delta t}{\\Delta x} \\begin{pmatrix} -\\tau  0 \\\\ 1  -1 \\end{pmatrix} = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} + \\nu \\begin{pmatrix} -\\tau  0 \\\\ 1  -1 \\end{pmatrix} = \\begin{pmatrix} 1-\\nu\\tau  0 \\\\ \\nu  1-\\nu \\end{pmatrix} $$\n\n**罚函数边界的稳定性分析**\n为使格式稳定，放大矩阵 $G_2$ 的谱半径必须不大于 $1$。也就是说，对于 $G_2$ 的每个特征值 $\\lambda$，必须有 $|\\lambda| \\le 1$。\n矩阵 $G_2$ 是一个下三角矩阵，因此其特征值是其对角线元素：\n$$ \\lambda_1 = 1 - \\nu\\tau $$\n$$ \\lambda_2 = 1 - \\nu $$\n\n我们必须满足两个特征值的稳定性条件：\n1.  $|\\lambda_1| \\le 1 \\implies |1 - \\nu\\tau| \\le 1$。该不等式等价于 $-1 \\le 1 - \\nu\\tau \\le 1$。\n    -   $1 - \\nu\\tau \\le 1 \\implies -\\nu\\tau \\le 0$。由于 $\\nu = a\\Delta t/\\Delta x > 0$ 且 $\\tau > 0$，此条件恒成立。\n    -   $-1 \\le 1 - \\nu\\tau \\implies \\nu\\tau \\le 2 \\implies \\nu \\le \\frac{2}{\\tau}$。\n\n2.  $|\\lambda_2| \\le 1 \\implies |1 - \\nu| \\le 1$。该不等式等价于 $-1 \\le 1 - \\nu \\le 1$。\n    -   $1 - \\nu \\le 1 \\implies -\\nu \\le 0 \\implies \\nu \\ge 0$。此条件恒成立。\n    -   $-1 \\le 1 - \\nu \\implies \\nu \\le 2$。\n\n为使整个格式稳定，必须同时满足这两个条件。因此，CFL 数 $\\nu$ 必须小于或等于两个导出上界中的最小值：\n$$ \\nu \\le \\min\\left(\\frac{2}{\\tau}, 2\\right) $$\n这就是 CFL 数 $\\nu$ 关于罚参数 $\\tau$ 的紧界。\n\n**最终计算**\n问题要求计算当罚系数为 $\\tau = 3$ 时，所允许的最大 CFL 数。我们将此值代入我们导出的稳定性边界：\n$$ \\nu_{\\max} = \\min\\left(\\frac{2}{3}, 2\\right) $$\n这两个值中的最小值显然是 $\\frac{2}{3}$。\n因此，所允许的最大 CFL 数为 $\\frac{2}{3}$。", "answer": "$$\\boxed{\\frac{2}{3}}$$", "id": "3518925"}]}