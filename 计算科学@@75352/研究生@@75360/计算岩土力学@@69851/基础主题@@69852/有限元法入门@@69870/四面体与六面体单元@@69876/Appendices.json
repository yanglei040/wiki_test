{"hands_on_practices": [{"introduction": "在三维有限元分析中，正确地实现材料的本构法则是至关重要的。本练习 ([@problem_id:3567423]) 提供了一个实践场景，在一个六面体单元中对比完整的三维应力-应变关系与错误的二维平面应变简化。通过这个练习，你将深入理解这种常见误解可能导致的重大计算误差，从而巩固对本构模型在不同维度下应用的理解。", "problem": "在一个三维小应变有限元方法（FEM）分析中，使用一个八节点三线性六面体单元来模拟一个小土样。该材料为各向同性线弹性固体，其杨氏模量 $E = 30$ MPa，泊松比 $\\nu = 0.3$。在单元形心处，测得的工程应变向量（采用工程剪应变的 Voigt 序）为\n$[\\varepsilon_{xx},\\, \\varepsilon_{yy},\\, \\varepsilon_{zz},\\, \\gamma_{yz},\\, \\gamma_{zx},\\, \\gamma_{xy}]^{\\mathsf{T}} = [1.0\\times 10^{-3},\\, 5.0\\times 10^{-4},\\, -2.0\\times 10^{-4},\\, 4.0\\times 10^{-4},\\, -1.0\\times 10^{-4},\\, 3.0\\times 10^{-4}]^{\\mathsf{T}}$。\n\n假设为小变形，并使用三维各向同性线弹性应力-应变定律计算形心处的应力向量 $[\\sigma_{xx},\\, \\sigma_{yy},\\, \\sigma_{zz},\\, \\tau_{yz},\\, \\tau_{zx},\\, \\tau_{xy}]^{\\mathsf{T}}$。现在，假设一位经验不足的分析师在组装三维六面体单元时，错误地为法向分量选择了二维平面应变本构矩阵，具体操作如下：\n- 他们根据面内应变计算 $\\sigma_{xx}$ 和 $\\sigma_{yy}$，如同 $\\varepsilon_{zz} = 0$ 一样（因此忽略了 $\\varepsilon_{zz}$ 对 $\\sigma_{xx}$ 和 $\\sigma_{yy}$ 的耦合作用），\n- 他们将 $\\sigma_{zz}$ 设为 0，\n- 他们使用三维剪切模量计算所有三个剪切分量，即 $\\tau_{ij} = G\\,\\gamma_{ij}$。\n\n下列哪个陈述最能从定性和定量上描述这种不当的本构选择对形心处计算出的应力的影响？\n\nA. 错误计算的 $\\sigma_{xx}$ 和 $\\sigma_{yy}$ 各比正确的三维值高出恰好 $-\\lambda\\,\\varepsilon_{zz}$，而 $\\sigma_{zz}$ 被错误地设为零；剪切分量不变。对于给定数据，法向应力误差为 $\\Delta \\sigma_{xx} = \\Delta \\sigma_{yy} = 3.461538462\\times 10^{-3}$ MPa，且不正确的面外法向应力为 $\\sigma_{zz}^{\\text{wrong}} = 0$ MPa。\n\nB. 错误计算的 $\\sigma_{xx}$ 等于正确的三维 $\\sigma_{xx}$，但 $\\sigma_{yy}$ 比正确的三维 $\\sigma_{yy}$ 低 $\\lambda\\,\\varepsilon_{zz}$；$\\sigma_{zz}$ 仍然被正确计算。\n\nC. 剪应力也受到影响：错误计算的 $\\tau_{xy}$ 恰好是正确三维值的两倍，而 $\\tau_{yz}$ 和 $\\tau_{zx}$ 保持正确。\n\nD. 使用平面应变本构矩阵不会改变平均（静水）应力 $p = (\\sigma_{xx} + \\sigma_{yy} + \\sigma_{zz})/3$，即使在 $\\varepsilon_{zz} \\neq 0$ 的情况下也是如此，因此应力张量的迹被保留。", "solution": "### 推导与分析\n\n问题的核心是比较使用正确的3D各向同性线弹性定律计算的应力向量与使用分析师的错误程序计算的应力向量。\n\n**1. 材料常数**\n\n首先，我们根据给定的杨氏模量 $E = 30$ MPa 和泊松比 $\\nu = 0.3$ 计算所需的弹性常数。\n\n剪切模量 $G$ 为：\n$$ G = \\frac{E}{2(1+\\nu)} = \\frac{30 \\text{ MPa}}{2(1+0.3)} = \\frac{30}{2.6} \\text{ MPa} \\approx 11.53846 \\text{ MPa} $$\n\n拉梅第一参数 $\\lambda$ 为：\n$$ \\lambda = \\frac{E\\nu}{(1+\\nu)(1-2\\nu)} = \\frac{(30 \\text{ MPa})(0.3)}{(1+0.3)(1 - 2(0.3))} = \\frac{9}{1.3 \\times 0.4} = \\frac{9}{0.52} \\text{ MPa} \\approx 17.30769 \\text{ MPa} $$\n\n**2. 正确的应力计算（3D弹性理论）**\n\n对于3D各向同性线弹性材料，其应力-应变关系可以用 $\\lambda$ 和 $G$ 写成：\n$$ \\sigma_{ij} = \\lambda \\delta_{ij} \\varepsilon_v + 2G \\varepsilon_{ij} $$\n其中 $\\varepsilon_v = \\varepsilon_{kk} = \\varepsilon_{xx} + \\varepsilon_{yy} + \\varepsilon_{zz}$ 是体积应变，$\\delta_{ij}$ 是克罗内克符号，$\\varepsilon_{ij}$ 是张量应变的分量。用工程应变表示，应力分量的方程为：\n\n$$ \\sigma_{xx}^{\\text{corr}} = \\lambda \\varepsilon_v + 2G \\varepsilon_{xx} $$\n$$ \\sigma_{yy}^{\\text{corr}} = \\lambda \\varepsilon_v + 2G \\varepsilon_{yy} $$\n$$ \\sigma_{zz}^{\\text{corr}} = \\lambda \\varepsilon_v + 2G \\varepsilon_{zz} $$\n$$ \\tau_{yz}^{\\text{corr}} = G \\gamma_{yz} $$\n$$ \\tau_{zx}^{\\text{corr}} = G \\gamma_{zx} $$\n$$ \\tau_{xy}^{\\text{corr}} = G \\gamma_{xy} $$\n\n首先，我们根据给定数据计算体积应变：\n$$ \\varepsilon_v = \\varepsilon_{xx} + \\varepsilon_{yy} + \\varepsilon_{zz} = (1.0\\times 10^{-3}) + (5.0\\times 10^{-4}) + (-2.0\\times 10^{-4}) = (10 \\times 10^{-4}) + (5 \\times 10^{-4}) - (2 \\times 10^{-4}) = 13.0\\times 10^{-4} $$\n\n现在，我们计算正确的应力分量：\n$$ \\sigma_{xx}^{\\text{corr}} = (17.30769 \\text{ MPa})(13.0\\times 10^{-4}) + 2(11.53846 \\text{ MPa})(1.0\\times 10^{-3}) = 0.022500 + 0.023077 = 0.045577 \\text{ MPa} $$\n$$ \\sigma_{yy}^{\\text{corr}} = (17.30769 \\text{ MPa})(13.0\\times 10^{-4}) + 2(11.53846 \\text{ MPa})(5.0\\times 10^{-4}) = 0.022500 + 0.011538 = 0.034038 \\text{ MPa} $$\n$$ \\sigma_{zz}^{\\text{corr}} = (17.30769 \\text{ MPa})(13.0\\times 10^{-4}) + 2(11.53846 \\text{ MPa})(-2.0\\times 10^{-4}) = 0.022500 - 0.004615 = 0.017885 \\text{ MPa} $$\n$$ \\tau_{yz}^{\\text{corr}} = (11.53846 \\text{ MPa})(4.0\\times 10^{-4}) = 0.004615 \\text{ MPa} $$\n$$ \\tau_{zx}^{\\text{corr}} = (11.53846 \\text{ MPa})(-1.0\\times 10^{-4}) = -0.001154 \\text{ MPa} $$\n$$ \\tau_{xy}^{\\text{corr}} = (11.53846 \\text{ MPa})(3.0\\times 10^{-4}) = 0.003462 \\text{ MPa} $$\n\n**3. 错误的应力计算（分析师的方法）**\n\n分析师的步骤如下：\n1.  **面内法向应力：** 使用二维平面应变本构定律，该定律在 $\\varepsilon_{zz}=0$ 的假设下，将面内应力与面内应变联系起来。方程为：\n    $$ \\sigma_{xx} = (\\lambda+2G)\\varepsilon_{xx} + \\lambda\\varepsilon_{yy} $$\n    $$ \\sigma_{yy} = \\lambda\\varepsilon_{xx} + (\\lambda+2G)\\varepsilon_{yy} $$\n    分析师将这些方程应用于给定的 $\\varepsilon_{xx}$ 和 $\\varepsilon_{yy}$ 值。\n    $$ \\lambda+2G = 17.30769 + 2(11.53846) = 40.38461 \\text{ MPa} $$\n    $$ \\sigma_{xx}^{\\text{wrong}} = (40.38461)(1.0\\times 10^{-3}) + (17.30769)(5.0\\times 10^{-4}) = 0.040385 + 0.008654 = 0.049039 \\text{ MPa} $$\n    $$ \\sigma_{yy}^{\\text{wrong}} = (17.30769)(1.0\\times 10^{-3}) + (40.38461)(5.0\\times 10^{-4}) = 0.017308 + 0.020192 = 0.037500 \\text{ MPa} $$\n\n2.  **面外法向应力：** 将其设为零。\n    $$ \\sigma_{zz}^{\\text{wrong}} = 0 \\text{ MPa} $$\n\n3.  **剪应力：** 使用三维剪切模量计算所有三个剪切分量。\n    $$ \\tau_{yz}^{\\text{wrong}} = G \\gamma_{yz} = (11.53846 \\text{ MPa})(4.0\\times 10^{-4}) = 0.004615 \\text{ MPa} $$\n    $$ \\tau_{zx}^{\\text{wrong}} = G \\gamma_{zx} = (11.53846 \\text{ MPa})(-1.0\\times 10^{-4}) = -0.001154 \\text{ MPa} $$\n    $$ \\tau_{xy}^{\\text{wrong}} = G \\gamma_{xy} = (11.53846 \\text{ MPa})(3.0\\times 10^{-4}) = 0.003462 \\text{ MPa} $$\n\n**4. 比较与误差分析**\n\n让我们比较正确和错误的应力向量。\n\n-   **剪应力：** 分析师计算剪应力的程序（$\\tau_{ij} = G\\gamma_{ij}$）与正确的3D公式相同。因此，所有剪应力分量都被正确计算：$\\tau_{ij}^{\\text{wrong}} = \\tau_{ij}^{\\text{corr}}$。\n\n-   **法向应力：**\n    -   让我们通过代数方法找出 $\\sigma_{xx}$ 和 $\\sigma_{yy}$ 中的误差。\n    $\\sigma_{xx}$ 的正确表达式可以改写为：\n    $$ \\sigma_{xx}^{\\text{corr}} = \\lambda(\\varepsilon_{xx}+\\varepsilon_{yy}+\\varepsilon_{zz}) + 2G\\varepsilon_{xx} = (\\lambda+2G)\\varepsilon_{xx} + \\lambda\\varepsilon_{yy} + \\lambda\\varepsilon_{zz} $$\n    错误的表达式为：\n    $$ \\sigma_{xx}^{\\text{wrong}} = (\\lambda+2G)\\varepsilon_{xx} + \\lambda\\varepsilon_{yy} $$\n    因此，误差 $\\Delta\\sigma_{xx} = \\sigma_{xx}^{\\text{wrong}} - \\sigma_{xx}^{\\text{corr}}$ 为：\n    $$ \\Delta\\sigma_{xx} = [(\\lambda+2G)\\varepsilon_{xx} + \\lambda\\varepsilon_{yy}] - [(\\lambda+2G)\\varepsilon_{xx} + \\lambda\\varepsilon_{yy} + \\lambda\\varepsilon_{zz}] = -\\lambda\\varepsilon_{zz} $$\n    同理，对于 $\\sigma_{yy}$：\n    $$ \\sigma_{yy}^{\\text{corr}} = \\lambda\\varepsilon_{xx} + (\\lambda+2G)\\varepsilon_{yy} + \\lambda\\varepsilon_{zz} $$\n    $$ \\sigma_{yy}^{\\text{wrong}} = \\lambda\\varepsilon_{xx} + (\\lambda+2G)\\varepsilon_{yy} $$\n    误差 $\\Delta\\sigma_{yy} = \\sigma_{yy}^{\\text{wrong}} - \\sigma_{yy}^{\\text{corr}}$ 为：\n    $$ \\Delta\\sigma_{yy} = -\\lambda\\varepsilon_{zz} $$\n    两个面内法向应力的误差是相同的，都等于 $-\\lambda\\varepsilon_{zz}$。\n\n    -   让我们计算这个误差的数值：\n    $$ \\text{Error} = -\\lambda\\varepsilon_{zz} = -(17.30769 \\text{ MPa})(-2.0\\times 10^{-4}) = 3.461538\\times 10^{-3} \\text{ MPa} $$\n    这个正误差意味着错误计算的应力比正确的应力*更高*。\n    让我们用完整的计算来验证这一点：\n    $\\Delta\\sigma_{xx} = 0.049039 - 0.045577 = 0.003462 \\approx 3.46 \\times 10^{-3}$ MPa。\n    $\\Delta\\sigma_{yy} = 0.037500 - 0.034038 = 0.003462 \\approx 3.46 \\times 10^{-3}$ MPa。\n    数值结果证实了代数推导。\n\n    -   对于面外法向应力，误差为：\n    $$ \\Delta\\sigma_{zz} = \\sigma_{zz}^{\\text{wrong}} - \\sigma_{zz}^{\\text{corr}} = 0 - 0.017885 = -0.017885 \\text{ MPa} $$\n    分析师的方法错误地将此应力设为零。\n\n### 逐项分析选项\n\n**A. 错误计算的 $\\sigma_{xx}$ 和 $\\sigma_{yy}$ 各比正确的三维值高出恰好 $-\\lambda\\,\\varepsilon_{zz}$，而 $\\sigma_{zz}$ 被错误地设为零；剪切分量不变。对于给定数据，法向应力误差为 $\\Delta \\sigma_{xx} = \\Delta \\sigma_{yy} = 3.461538462\\times 10^{-3}$ MPa，且不正确的面外法向应力为 $\\sigma_{zz}^{\\text{wrong}} = 0$ MPa。**\n- $\\sigma_{xx}$ 和 $\\sigma_{yy}$ 的误差确实是 $\\Delta\\sigma = \\sigma^{\\text{wrong}} - \\sigma^{\\text{corr}} = -\\lambda\\varepsilon_{zz}$。因为 $\\lambda > 0$ 且 $\\varepsilon_{zz}  0$，误差项 $-\\lambda\\varepsilon_{zz}$ 是正的，这意味着错误的值更高。这个陈述是正确的。\n- 误差的代数形式 $-\\lambda\\varepsilon_{zz}$ 是正确的。\n- 剪切分量不变，这是正确的。\n- $\\sigma_{zz}$ 被错误地设为零，这是正确的。\n- 误差的数值 $-\\lambda\\varepsilon_{zz} = 3.461538...\\times 10^{-3}$ MPa 是正确的。\n- 错误的值 $\\sigma_{zz}^{\\text{wrong}} = 0$ MPa 是正确的。\n该陈述的每一部分都与我们的推导一致。\n**结论：正确**\n\n**B. 错误计算的 $\\sigma_{xx}$ 等于正确的三维 $\\sigma_{xx}$，但 $\\sigma_{yy}$ 比正确的三维 $\\sigma_{yy}$ 低 $\\lambda\\,\\varepsilon_{zz}$；$\\sigma_{zz}$ 仍然被正确计算。**\n- 错误。$\\sigma_{xx}$ 不等于正确的值；其误差为 $-\\lambda\\varepsilon_{zz} \\neq 0$。\n- 错误。$\\sigma_{yy}$ 更高，而不是更低，误差量是 $-\\lambda\\varepsilon_{zz}$，而不是 $\\lambda\\varepsilon_{zz}$。\n- 错误。$\\sigma_{zz}$ 被错误地设为 $0$。\n**结论：错误**\n\n**C. 剪应力也受到影响：错误计算的 $\\tau_{xy}$ 恰好是正确三维值的两倍，而 $\\tau_{yz}$ 和 $\\tau_{zx}$ 保持正确。**\n- 错误。问题陈述指明所有三个剪切分量都是使用 $\\tau_{ij} = G\\gamma_{ij}$ 计算的，这是正确的3D公式。因此，所有剪应力都被正确计算且保持不变。\n**结论：错误**\n\n**D. 使用平面应变本构矩阵不会改变平均（静水）应力 $p = (\\sigma_{xx} + \\sigma_{yy} + \\sigma_{zz})/3$，即使在 $\\varepsilon_{zz} \\neq 0$ 的情况下也是如此，因此应力张量的迹被保留。**\n- 让我们检查应力张量的迹，$\\text{tr}(\\sigma) = \\sigma_{xx} + \\sigma_{yy} + \\sigma_{zz}$。\n- 正确的迹：$\\text{tr}(\\sigma^{\\text{corr}}) = \\sigma_{xx}^{\\text{corr}} + \\sigma_{yy}^{\\text{corr}} + \\sigma_{zz}^{\\text{corr}}$。根据弹性理论我们知道 $\\text{tr}(\\sigma) = (3\\lambda+2G)\\varepsilon_v$。根据我们的数据，$\\text{tr}(\\sigma^{\\text{corr}}) = (0.045577 + 0.034038 + 0.017885) \\text{ MPa} = 0.0975 \\text{ MPa}$。\n- 错误的迹：$\\text{tr}(\\sigma^{\\text{wrong}}) = \\sigma_{xx}^{\\text{wrong}} + \\sigma_{yy}^{\\text{wrong}} + \\sigma_{zz}^{\\text{wrong}} = (0.049039 + 0.037500 + 0) \\text{ MPa} = 0.086539 \\text{ MPa}$。\n- 由于 $0.0975 \\neq 0.086539$，迹不被保留，平均应力也发生了改变。\n**结论：错误**", "answer": "$$\\boxed{A}$$", "id": "3567423"}, {"introduction": "有限元分析的准确性不仅取决于物理原理的正确应用，还依赖于单元的几何形状。本练习 ([@problem_id:3567421]) 将引导你通过解析推导，来量化一个六面体单元的几何畸变（扭曲）如何影响数值积分的精度。这项实践有助于揭示有限元方法中一个关键的误差来源，即等参映射和数值求积之间的相互作用。", "problem": "考虑一个在计算岩土力学中使用的八节点一阶三线性六面体单元 (Q1)，该单元用于有限元法 (FEM)。设母（参考）单元域为立方体 $\\{(\\xi,\\eta,\\zeta)\\,|\\,\\xi,\\eta,\\zeta\\in[-1,1]\\}$。通过如下方式指定节点的物理坐标，来定义到物理坐标 $(x,y,z)$ 的等参映射。对于每个母坐标为 $(\\xi_i,\\eta_i,\\zeta_i)\\in\\{\\pm 1\\}^{3}$ 的节点，指定\n$$\nx_i \\;=\\; L\\,\\xi_i \\;+\\; \\varepsilon\\,L\\,\\xi_i\\,\\eta_i,\\qquad\ny_i \\;=\\; L\\,\\eta_i,\\qquad\nz_i \\;=\\; L\\,\\zeta_i,\n$$\n其中 $L0$ 是一个长度尺度，$\\varepsilon$ 是一个小的无量纲偏斜参数，满足 $|\\varepsilon|\\ll 1$。使用标准三线性形函数的等参插值随之导出一个三线性映射 $(\\xi,\\eta,\\zeta)\\mapsto(x(\\xi,\\eta,\\zeta),y(\\xi,\\eta,\\zeta),z(\\xi,\\eta,\\zeta))$ 及其雅可比矩阵 $\\mathbf{J}(\\xi,\\eta,\\zeta)=\\partial(x,y,z)/\\partial(\\xi,\\eta,\\zeta)$ 和行列式 $\\det \\mathbf{J}(\\xi,\\eta,\\zeta)$。\n\n设物理空间中的标量应力场为多项式\n$$\n\\sigma(x,y,z)\\;=\\;\\beta\\,y,\n$$\n其中 $\\beta$ 是一个常数。考虑应力在物理单元上的单元体积积分，\n$$\nI \\;=\\; \\int_{\\Omega_e} \\sigma(x,y,z)\\,\\mathrm{d}V \\;=\\; \\int_{-1}^{1}\\int_{-1}^{1}\\int_{-1}^{1} \\sigma\\!\\bigl(x(\\xi,\\eta,\\zeta),y(\\xi,\\eta,\\zeta),z(\\xi,\\eta,\\zeta)\\bigr)\\,\\det\\mathbf{J}(\\xi,\\eta,\\zeta)\\,\\mathrm{d}\\xi\\,\\mathrm{d}\\eta\\,\\mathrm{d}\\zeta,\n$$\n并使用母空间中的单点高斯法则对其进行近似，\n$$\nI_G \\;=\\; 8\\,\\sigma\\!\\bigl(x(0,0,0),y(0,0,0),z(0,0,0)\\bigr)\\,\\det\\mathbf{J}(0,0,0).\n$$\n\n仅从等参映射的定义、雅可比行列式和体积积分的变量替换公式以及单点高斯法则出发，通过显式分析给定偏斜所引起的 $\\det\\mathbf{J}$ 在单元内的变化，推导主阶（关于 $\\varepsilon$）绝对积分误差\n$$\nE \\;=\\; I - I_G\n$$\n。假设 $|\\varepsilon|\\ll 1$ 并忽略 $\\varepsilon^{2}$ 及更高阶的项。请将最终结果表示为以 $\\beta$、$L$ 和 $\\varepsilon$ 表示的闭式解析表达式。最终表达式中不应包含单位。无需进行数值舍入。", "solution": "本题旨在确定使用单点高斯求积法则近似计算一个线性应力场在特定偏斜六面体有限元上的体积积分时的主阶积分误差。求解过程首先推导等参坐标映射，然后计算该映射的雅可比行列式，最后通过计算精确积分和近似积分来求得它们的差值。\n\n首先，我们建立从母坐标 $(\\xi, \\eta, \\zeta) \\in [-1, 1]^3$ 到物理坐标 $(x, y, z)$ 的等参映射。该映射由标准三线性形函数 $N_i(\\xi, \\eta, \\zeta)$ 和给定的节点坐标 $(x_i, y_i, z_i)$ 定义。物理坐标由下式给出：\n$$x(\\xi, \\eta, \\zeta) = \\sum_{i=1}^{8} N_i(\\xi, \\eta, \\zeta) x_i$$\n$$y(\\xi, \\eta, \\zeta) = \\sum_{i=1}^{8} N_i(\\xi, \\eta, \\zeta) y_i$$\n$$z(\\xi, \\eta, \\zeta) = \\sum_{i=1}^{8} N_i(\\xi, \\eta, \\zeta) z_i$$\n节点坐标被指定为 $x_i = L\\,\\xi_i + \\varepsilon\\,L\\,\\xi_i\\,\\eta_i$，$y_i = L\\,\\eta_i$ 和 $z_i = L\\,\\zeta_i$，其中 $(\\xi_i, \\eta_i, \\zeta_i)$ 是节点 $i$ 的母坐标。\n\n根据三线性插值的性质，如果函数 $f$ 是诸如 $1, \\xi, \\eta, \\zeta, \\xi\\eta, \\eta\\zeta, \\zeta\\xi, \\xi\\eta\\zeta$ 等项的线性组合，那么形如 $\\sum_{i=1}^{8} N_i(\\xi, \\eta, \\zeta) f(\\xi_i, \\eta_i, \\zeta_i)$ 的表达式就能精确地插值函数 $f$。本题中的节点坐标定义就属于这种情况。\n对于 $y$ 和 $z$ 坐标，我们有：\n$$y(\\xi, \\eta, \\zeta) = \\sum_{i=1}^{8} N_i(\\xi, \\eta, \\zeta) (L\\,\\eta_i) = L \\left(\\sum_{i=1}^{8} N_i \\eta_i\\right) = L\\,\\eta$$\n$$z(\\xi, \\eta, \\zeta) = \\sum_{i=1}^{8} N_i(\\xi, \\eta, \\zeta) (L\\,\\zeta_i) = L \\left(\\sum_{i=1}^{8} N_i \\zeta_i\\right) = L\\,\\zeta$$\n对于 $x$ 坐标，映射为：\n$$x(\\xi, \\eta, \\zeta) = \\sum_{i=1}^{8} N_i (L\\,\\xi_i + \\varepsilon L\\,\\xi_i\\eta_i) = L \\left(\\sum_{i=1}^{8} N_i \\xi_i\\right) + \\varepsilon L \\left(\\sum_{i=1}^{8} N_i \\xi_i\\eta_i\\right) = L\\xi + \\varepsilon L\\xi\\eta$$\n因此，完整的坐标映射为：\n$$x(\\xi, \\eta, \\zeta) = L(\\xi + \\varepsilon\\xi\\eta)$$\n$$y(\\xi, \\eta, \\zeta) = L\\eta$$\n$$z(\\xi, \\eta, \\zeta) = L\\zeta$$\n\n接下来，我们计算雅可比矩阵 $\\mathbf{J} = \\frac{\\partial(x,y,z)}{\\partial(\\xi,\\eta,\\zeta)}$。其分量是物理坐标对母坐标的偏导数：\n$$J_{11} = \\frac{\\partial x}{\\partial \\xi} = L(1 + \\varepsilon\\eta), \\quad J_{12} = \\frac{\\partial x}{\\partial \\eta} = L\\varepsilon\\xi, \\quad J_{13} = \\frac{\\partial x}{\\partial \\zeta} = 0$$\n$$J_{21} = \\frac{\\partial y}{\\partial \\xi} = 0, \\quad J_{22} = \\frac{\\partial y}{\\partial \\eta} = L, \\quad J_{23} = \\frac{\\partial y}{\\partial \\zeta} = 0$$\n$$J_{31} = \\frac{\\partial z}{\\partial \\xi} = 0, \\quad J_{32} = \\frac{\\partial z}{\\partial \\eta} = 0, \\quad J_{33} = \\frac{\\partial z}{\\partial \\zeta} = L$$\n雅可比矩阵为：\n$$\\mathbf{J}(\\xi, \\eta, \\zeta) = \\begin{pmatrix} L(1 + \\varepsilon\\eta)  L\\varepsilon\\xi  0 \\\\ 0  L  0 \\\\ 0  0  L \\end{pmatrix}$$\n雅可比矩阵的行列式 $\\det\\mathbf{J}$ 为：\n$$\\det\\mathbf{J}(\\xi, \\eta, \\zeta) = L(1 + \\varepsilon\\eta) \\cdot (L \\cdot L - 0 \\cdot 0) - L\\varepsilon\\xi \\cdot (0 \\cdot L - 0 \\cdot 0) = L^3(1 + \\varepsilon\\eta)$$\n\n现在，我们可以计算精确积分 $I$。应力场为 $\\sigma(x, y, z) = \\beta y$。在母坐标系下，这变为 $\\sigma = \\beta y(\\xi, \\eta, \\zeta) = \\beta L\\eta$。被积函数为 $\\sigma \\det\\mathbf{J}$：\n$$\\sigma \\det\\mathbf{J} = (\\beta L\\eta) \\cdot (L^3(1 + \\varepsilon\\eta)) = \\beta L^4 (\\eta + \\varepsilon\\eta^2)$$\n精确积分 $I$ 为：\n$$I = \\int_{-1}^{1}\\int_{-1}^{1}\\int_{-1}^{1} \\beta L^4 (\\eta + \\varepsilon\\eta^2) \\, \\mathrm{d}\\xi\\,\\mathrm{d}\\eta\\,\\mathrm{d}\\zeta$$\n我们可以分离积分：\n$$I = \\beta L^4 \\left(\\int_{-1}^{1} \\mathrm{d}\\xi\\right) \\left(\\int_{-1}^{1} \\mathrm{d}\\zeta\\right) \\left(\\int_{-1}^{1} (\\eta + \\varepsilon\\eta^2) \\, \\mathrm{d}\\eta\\right)$$\n关于 $\\xi$ 和 $\\zeta$ 的积分为 $\\int_{-1}^{1} \\mathrm{d}\\xi = 2$ 和 $\\int_{-1}^{1} \\mathrm{d}\\zeta = 2$。\n关于 $\\eta$ 的积分为：\n$$\\int_{-1}^{1} (\\eta + \\varepsilon\\eta^2) \\, \\mathrm{d}\\eta = \\left[ \\frac{\\eta^2}{2} + \\varepsilon\\frac{\\eta^3}{3} \\right]_{-1}^{1} = \\left(\\frac{1}{2} + \\frac{\\varepsilon}{3}\\right) - \\left(\\frac{(-1)^2}{2} + \\varepsilon\\frac{(-1)^3}{3}\\right) = \\left(\\frac{1}{2} + \\frac{\\varepsilon}{3}\\right) - \\left(\\frac{1}{2} - \\frac{\\varepsilon}{3}\\right) = \\frac{2\\varepsilon}{3}$$\n将这些结果代回 $I$ 的表达式中：\n$$I = \\beta L^4 \\cdot (2) \\cdot (2) \\cdot \\left(\\frac{2\\varepsilon}{3}\\right) = \\frac{8}{3}\\beta L^4 \\varepsilon$$\n\n接下来，我们使用单点高斯法则计算近似积分 $I_G$。该法则在母单元域的中心 $(\\xi, \\eta, \\zeta)=(0, 0, 0)$ 处计算被积函数的值，然后乘以该域的体积 $8$。\n$$I_G = 8\\,\\sigma\\bigl(x(0,0,0),y(0,0,0),z(0,0,0)\\bigr)\\,\\det\\mathbf{J}(0,0,0)$$\n首先，计算在 $(\\xi, \\eta, \\zeta)=(0, 0, 0)$ 处的各项值：\n$$y(0,0,0) = L \\cdot 0 = 0$$\n因此，单元中心的应力为：\n$$\\sigma\\bigl(x(0,0,0),y(0,0,0),z(0,0,0)\\bigr) = \\beta \\cdot y(0,0,0) = 0$$\n中心的雅可比行列式为：\n$$\\det\\mathbf{J}(0,0,0) = L^3(1 + \\varepsilon \\cdot 0) = L^3$$\n将这些值代入 $I_G$ 的公式中：\n$$I_G = 8 \\cdot (0) \\cdot (L^3) = 0$$\n\n最后，积分误差 $E$ 是差值 $I - I_G$。\n$$E = I - I_G = \\frac{8}{3}\\beta L^4 \\varepsilon - 0 = \\frac{8}{3}\\beta L^4 \\varepsilon$$\n该表达式是关于 $\\varepsilon$ 的线性表达式，因此它代表了主阶误差，没有出现也无需忽略 $\\varepsilon^2$ 或更高阶的项。", "answer": "$$\\boxed{\\frac{8}{3}\\beta L^4 \\varepsilon}$$", "id": "3567421"}, {"introduction": "简单的线性单元，特别是四面体单元，在分析中常常表现出“锁定”或“过于刚硬”的问题，这限制了它们的应用。本练习 ([@problem_id:3567369]) 介绍了一种先进的补救技术，即基于边的光滑有限元法（ES-FEM）。通过对比标准四面体单元组合与光滑单元的能量（等效于刚度），你将深入了解这些现代方法是如何通过修正梯度计算来提升单元性能的。", "problem": "将稳态标量扩散视为计算岩土力学中小应变线性运动学的替代模型。设其控制强形式为 $-\\nabla \\cdot \\left(k \\nabla u \\right)=0$，定义在一个有界域上，其中 $k$ 为一个正常数。标准 Galerkin 有限元法 (FEM) 使用基于四面体上线性形函数构建的离散场 $u_{h}$，其离散能量泛函为 $E_{\\mathrm{std}}(u_{h})=\\frac{1}{2}\\int_{\\Omega} k \\, |\\nabla u_{h}|^{2}\\, \\mathrm{d}V$。一种基于边的光滑有限元法 (ES-FEM) 用基于边的光滑单元上的光滑梯度替代了单元梯度。对于与某条边关联的任意光滑域 $\\Omega^{(s)}$，光滑梯度算子通过场梯度的域平均来定义。\n\n考虑由节点定义的双四面体片 $\\Omega=\\mathrm{T}_{1}\\cup \\mathrm{T}_{2}$：\n- $\\mathbf{x}_{1}=(0,0,0)$、$\\mathbf{x}_{2}=(1,0,0)$、$\\mathbf{x}_{3}=(0,1,0)$、$\\mathbf{x}_{4}=(0,0,1)$ 定义了 $\\mathrm{T}_{1}=\\mathrm{conv}\\{\\mathbf{x}_{1},\\mathbf{x}_{2},\\mathbf{x}_{3},\\mathbf{x}_{4}\\}$，以及\n- $\\mathbf{x}_{5}=(0,0,-1)$ 与 $\\mathbf{x}_{1},\\mathbf{x}_{2},\\mathbf{x}_{3}$ 一起定义了 $\\mathrm{T}_{2}=\\mathrm{conv}\\{\\mathbf{x}_{1},\\mathbf{x}_{2},\\mathbf{x}_{3},\\mathbf{x}_{5}\\}$，\n\n因此 $\\mathrm{T}_{1}$ 和 $\\mathrm{T}_{2}$ 共享面 $\\mathrm{conv}\\{\\mathbf{x}_{1},\\mathbf{x}_{2},\\mathbf{x}_{3}\\}$ 以及三条内部边 $\\overline{\\mathbf{x}_{1}\\mathbf{x}_{2}}$、$\\overline{\\mathbf{x}_{1}\\mathbf{x}_{3}}$ 和 $\\overline{\\mathbf{x}_{2}\\mathbf{x}_{3}}$。取 $k=1$。在每个四面体上使用线性形函数，并采用常规的节点插值。ES-FEM 基于边的光滑单元 $\\Omega^{(e)}$ 定义如下：对于每个网格边 $e$，以及每个与 $e$ 邻接的四面体 $\\mathrm{T}$，构建四个点的凸包：单元形心 $\\mathbf{C}_{\\mathrm{T}}$、$\\mathrm{T}$ 中与 $e$ 邻接的两个面的面心，以及 $e$ 的边中点。基于边的光滑单元 $\\Omega^{(e)}$ 是对所有与 $e$ 邻接的四面体所生成的这些凸包的并集。假设此构造将每个四面体 $\\mathrm{T}$ 精确地划分为六个由边贡献的子单元，每个子单元的体积为 $V_{\\mathrm{T}}/6$，其中 $V_{\\mathrm{T}}$ 是 $\\mathrm{T}$ 的体积。\n\n任务：\n- (i) 从散度定理出发，推导一般光滑域 $\\Omega^{(s)}$ 上线性形函数 $N_{I}$ 的光滑梯度算子 $\\tilde{\\nabla} N_{I}$ 的表达式，该表达式应以 $\\nabla N_{I}$ 的体积平均形式给出。\n- (ii) 对于节点向量 $u$，其满足 $u(\\mathbf{x}_{4})=1$ 且对于所有 $i\\in\\{1,2,3,5\\}$ 都有 $u(\\mathbf{x}_{i})=0$，计算 $\\Omega$ 上的标准 FEM 离散能量 $E_{\\mathrm{std}}(u)$。\n- (iii) 使用基于边的光滑构造以及 (i) 部分的结果，计算 ES-FEM 离散能量 $E_{\\mathrm{ES}}(u)=\\frac{1}{2}\\sum_{e} \\int_{\\Omega^{(e)}} |\\tilde{\\nabla} u|^{2} \\, \\mathrm{d}V$，其中求和遍及该双四面体片中的所有边。然后计算比率 $R=\\frac{E_{\\mathrm{ES}}(u)}{E_{\\mathrm{std}}(u)}$。\n\n将 $R$ 的最终答案表示为单个精确数。无需四舍五入。无需单位。", "solution": "### 解答\n本解答按顺序处理这三个任务。\n\n**(i) 光滑梯度算子的推导**\n在体积为 $V^{(s)} = \\int_{\\Omega^{(s)}} \\mathrm{d}V$ 的光滑域 $\\Omega^{(s)}$ 上的光滑梯度 $\\tilde{\\nabla} u$ 被定义为一个常向量，该常向量满足以下弱形式等价关系：\n$$ \\int_{\\Omega^{(s)}} \\mathbf{v} \\cdot \\tilde{\\nabla} u \\, \\mathrm{d}V = \\int_{\\Omega^{(s)}} \\mathbf{v} \\cdot \\nabla u \\, \\mathrm{d}V $$\n对于任意恒定的测试向量 $\\mathbf{v}$。\n由于 $\\mathbf{v}$ 和 $\\tilde{\\nabla} u$ 在域 $\\Omega^{(s)}$ 上是常数，左侧变为：\n$$ \\mathbf{v} \\cdot (\\tilde{\\nabla} u) V^{(s)} = \\int_{\\Omega^{(s)}} \\mathbf{v} \\cdot \\nabla u \\, \\mathrm{d}V = \\mathbf{v} \\cdot \\left( \\int_{\\Omega^{(s)}} \\nabla u \\, \\mathrm{d}V \\right) $$\n此等式必须对任意常向量 $\\mathbf{v}$ 成立，这意味着光滑梯度的表达式是常规梯度的体积平均：\n$$ \\tilde{\\nabla} u = \\frac{1}{V^{(s)}} \\int_{\\Omega^{(s)}} \\nabla u \\, \\mathrm{d}V $$\n问题要求从散度定理出发进行推导，散度定理将向量场 $\\mathbf{F}$ 的散度的体积分与该场在边界 $\\partial\\Omega^{(s)}$ 上的面积分联系起来：$\\int_{\\Omega^{(s)}} \\nabla \\cdot \\mathbf{F} \\, \\mathrm{d}V = \\int_{\\partial\\Omega^{(s)}} \\mathbf{F} \\cdot \\mathbf{n} \\, \\mathrm{d}A$，其中 $\\mathbf{n}$ 是表面的外法向单位向量。\n令 $\\mathbf{F} = u \\mathbf{c}$，其中 $\\mathbf{c}$ 是任意常向量。$\\mathbf{F}$ 的散度为 $\\nabla \\cdot (u\\mathbf{c}) = (\\nabla u) \\cdot \\mathbf{c} + u (\\nabla \\cdot \\mathbf{c})$。由于 $\\mathbf{c}$ 是常数，$\\nabla \\cdot \\mathbf{c} = 0$，所以 $\\nabla \\cdot (u\\mathbf{c}) = (\\nabla u) \\cdot \\mathbf{c}$。\n应用散度定理：\n$$ \\int_{\\Omega^{(s)}} (\\nabla u) \\cdot \\mathbf{c} \\, \\mathrm{d}V = \\int_{\\partial\\Omega^{(s)}} (u\\mathbf{c}) \\cdot \\mathbf{n} \\, \\mathrm{d}A $$\n$$ \\left( \\int_{\\Omega^{(s)}} \\nabla u \\, \\mathrm{d}V \\right) \\cdot \\mathbf{c} = \\left( \\int_{\\partial\\Omega^{(s)}} u\\mathbf{n} \\, \\mathrm{d}A \\right) \\cdot \\mathbf{c} $$\n由于这对任意常向量 $\\mathbf{c}$ 都成立，我们得到梯度定理：\n$$ \\int_{\\Omega^{(s)}} \\nabla u \\, \\mathrm{d}V = \\int_{\\partial\\Omega^{(s)}} u\\mathbf{n} \\, \\mathrm{d}A $$\n将此代入光滑梯度的定义，得到一个基于面积分的替代表达式：\n$$ \\tilde{\\nabla} u = \\frac{1}{V^{(s)}} \\int_{\\partial\\Omega^{(s)}} u\\mathbf{n} \\, \\mathrm{d}A $$\n对于线性形函数 $N_I$，表达式为：\n$$ \\tilde{\\nabla} N_I = \\frac{1}{V^{(s)}} \\int_{\\Omega^{(s)}} \\nabla N_I \\, \\mathrm{d}V = \\frac{1}{V^{(s)}} \\int_{\\partial\\Omega^{(s)}} N_I\\mathbf{n} \\, \\mathrm{d}A $$\n\n**(ii) 标准 FEM 离散能量的计算**\n标准 FEM 能量为 $E_{\\mathrm{std}}(u) = \\frac{1}{2}\\int_{\\Omega} k |\\nabla u_h|^2 \\mathrm{d}V$。当 $k=1$ 时，为 $E_{\\mathrm{std}}(u) = \\frac{1}{2}\\int_{\\Omega} |\\nabla u_h|^2 \\mathrm{d}V$。\n离散场为 $u_h(\\mathbf{x}) = \\sum_{I} u_I N_I(\\mathbf{x})$。给定节点值 $u_4=1$ 且对于 $i \\in \\{1,2,3,5\\}$ 有 $u_i=0$，该场为 $u_h(\\mathbf{x}) = N_4(\\mathbf{x})$。\n形函数 $N_4(\\mathbf{x})$ 仅在节点 4 所属的四面体 $\\mathrm{T}_1$ 上非零。因此，$u_h(\\mathbf{x})$ 在 $\\mathrm{T}_1$ 上非零，在 $\\mathrm{T}_2$ 上恒等于零。能量积分因此局限于 $\\mathrm{T}_1$ 内：\n$$ E_{\\mathrm{std}}(u) = \\frac{1}{2}\\int_{\\mathrm{T}_1} |\\nabla N_4|^2 \\mathrm{d}V $$\n对于线性四面体单元，形函数的梯度在整个单元内是恒定的。因此，积分变为：\n$$ E_{\\mathrm{std}}(u) = \\frac{1}{2} |\\nabla N_4|^2 V_{\\mathrm{T}_1} $$\n其中 $V_{\\mathrm{T}_1}$ 是四面体 $\\mathrm{T}_1$ 的体积。$\\mathrm{T}_1$ 的节点为 $\\mathbf{x}_{1}=(0,0,0)$、$\\mathbf{x}_{2}=(1,0,0)$、$\\mathbf{x}_{3}=(0,1,0)$ 和 $\\mathbf{x}_{4}=(0,0,1)$。其体积由下式给出：\n$$ V_{\\mathrm{T}_1} = \\frac{1}{6} |(\\mathbf{x}_2 - \\mathbf{x}_1) \\cdot ((\\mathbf{x}_3 - \\mathbf{x}_1) \\times (\\mathbf{x}_4 - \\mathbf{x}_1))| = \\frac{1}{6} \\left| \\det \\begin{pmatrix} 1  0  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{pmatrix} \\right| = \\frac{1}{6} $$\n对于 $\\mathbf{x}=(x,y,z) \\in \\mathrm{T}_1$ 的线性形函数 $N_4(\\mathbf{x})$ 必须满足 $N_4(\\mathbf{x}_I) = \\delta_{4I}$。一个线性函数 $N_4(x,y,z) = a+bx+cy+dz$ 必须满足 $N_4(\\mathbf{x}_1)=a=0$，$N_4(\\mathbf{x}_2)=a+b=0 \\implies b=0$，$N_4(\\mathbf{x}_3)=a+c=0 \\implies c=0$，以及 $N_4(\\mathbf{x}_4)=a+d=1 \\implies d=1$。因此，$N_4(x,y,z) = z$。\n梯度为 $\\nabla N_4 = (0,0,1)$，其模的平方为 $|\\nabla N_4|^2 = 1^2 = 1$。\n标准 FEM 能量为：\n$$ E_{\\mathrm{std}}(u) = \\frac{1}{2} (1) \\left(\\frac{1}{6}\\right) = \\frac{1}{12} $$\n\n**(iii) ES-FEM 离散能量及比率 R 的计算**\nES-FEM 能量为 $E_{\\mathrm{ES}}(u) = \\frac{1}{2}\\sum_{e} \\int_{\\Omega^{(e)}} |\\tilde{\\nabla} u_h|^2 \\mathrm{d}V$。由于 $\\tilde{\\nabla} u_h$ 在每个光滑单元 $\\Omega^{(e)}$ 上是常数，这可以简化为：\n$$ E_{\\mathrm{ES}}(u) = \\frac{1}{2}\\sum_{e} V^{(e)} |\\tilde{\\nabla} u_h|_{\\Omega^{(e)}}|^2 $$\n其中 $u_h = N_4$。边 $e$ 上的光滑梯度为 $\\tilde{\\nabla} N_4|_{\\Omega^{(e)}} = \\frac{1}{V^{(e)}} \\int_{\\Omega^{(e)}} \\nabla N_4 \\, \\mathrm{d}V$。\n该网格有 9 条唯一的边：\n- 3 条为 $\\mathrm{T}_1$ 和 $\\mathrm{T}_2$ 所共有的内部边：$e_{\\text{int}} \\in \\{\\overline{\\mathbf{x}_1\\mathbf{x}_2}, \\overline{\\mathbf{x}_1\\mathbf{x}_3}, \\overline{\\mathbf{x}_2\\mathbf{x}_3}\\}$。\n- 3 条仅属于 $\\mathrm{T}_1$ 的边界边：$e_{\\text{b,1}} \\in \\{\\overline{\\mathbf{x}_1\\mathbf{x}_4}, \\overline{\\mathbf{x}_2\\mathbf{x}_4}, \\overline{\\mathbf{x}_3\\mathbf{x}_4}\\}$。\n- 3 条仅属于 $\\mathrm{T}_2$ 的边界边：$e_{\\text{b,2}} \\in \\{\\overline{\\mathbf{x}_1\\mathbf{x}_5}, \\overline{\\mathbf{x}_2\\mathbf{x}_5}, \\overline{\\mathbf{x}_3\\mathbf{x}_5}\\}$。\n\n具有节点 $\\mathbf{x}_{1}(0,0,0), \\mathbf{x}_{2}(1,0,0), \\mathbf{x}_{3}(0,1,0), \\mathbf{x}_{5}(0,0,-1)$ 的四面体 $\\mathrm{T}_2$ 的体积为 $V_{\\mathrm{T}_2} = \\frac{1}{6} \\left| \\det \\begin{pmatrix} 1  0  0 \\\\ 0  1  0 \\\\ 0  0  -1 \\end{pmatrix} \\right| = \\frac{1}{6}$。\n每个基于边的光滑单元 $V^{(e)}$ 的体积是其邻接四面体贡献之和。每个四面体 $\\mathrm{T}$ 对其 6 条边中的每一条贡献体积 $V_{\\mathrm{T}}/6$。\n- 对于一条内部边 $e_{\\text{int}}$，$V^{(e_{\\text{int}})} = V_{\\mathrm{T}_1}/6 + V_{\\mathrm{T}_2}/6 = (1/6)/6 + (1/6)/6 = 1/18$。\n- 对于一条边界边 $e_{\\text{b,1}}$，$V^{(e_{\\text{b,1}})} = V_{\\mathrm{T}_1}/6 = 1/36$。\n- 对于一条边界边 $e_{\\text{b,2}}$，$V^{(e_{\\text{b,2}})} = V_{\\mathrm{T}_2}/6 = 1/36$。\n\n梯度 $\\nabla N_4$ 在每个四面体上是常数：$\\nabla N_4|_{\\mathrm{T}_1} = (0,0,1)$ 且 $\\nabla N_4|_{\\mathrm{T}_2} = \\mathbf{0}$（因为 $N_4$ 在 $\\mathrm{T}_2$ 的所有节点上均为零）。\n光滑梯度的积分变成了对子单元的求和：$\\int_{\\Omega^{(e)}} \\nabla N_4 \\, \\mathrm{d}V = \\sum_{\\mathrm{T} \\ni e} (\\nabla N_4|_\\mathrm{T}) (V_\\mathrm{T}/6)$。\n\n- 对于 3 条内部边 $e_{\\text{int}}$：\n$\\int_{\\Omega^{(e_{\\text{int}})}} \\nabla N_4 \\mathrm{d}V = (\\nabla N_4|_{\\mathrm{T}_1}) (V_{\\mathrm{T}_1}/6) + (\\nabla N_4|_{\\mathrm{T}_2}) (V_{\\mathrm{T}_2}/6) = (0,0,1)(1/36) + \\mathbf{0}(1/36) = (0,0,1/36)$。\n$\\tilde{\\nabla} N_4|_{\\Omega^{(e_{\\text{int}})}} = \\frac{(0,0,1/36)}{1/18} = (0,0,1/2)$。\n$|\\tilde{\\nabla} N_4|^2 = (1/2)^2 = 1/4$。\n能量贡献：$3 \\times \\frac{1}{2} V^{(e_{\\text{int}})} |\\tilde{\\nabla} N_4|^2 = 3 \\times \\frac{1}{2} \\times \\frac{1}{18} \\times \\frac{1}{4} = \\frac{3}{144} = \\frac{1}{48}$。\n\n- 对于 3 条边界边 $e_{\\text{b,1}}$：\n$\\int_{\\Omega^{(e_{\\text{b,1}})}} \\nabla N_4 \\mathrm{d}V = (\\nabla N_4|_{\\mathrm{T}_1}) (V_{\\mathrm{T}_1}/6) = (0,0,1)(1/36)$。\n$\\tilde{\\nabla} N_4|_{\\Omega^{(e_{\\text{b,1}})}} = \\frac{(0,0,1/36)}{1/36} = (0,0,1)$。\n$|\\tilde{\\nabla} N_4|^2 = 1^2 = 1$。\n能量贡献：$3 \\times \\frac{1}{2} V^{(e_{\\text{b,1}})} |\\tilde{\\nabla} N_4|^2 = 3 \\times \\frac{1}{2} \\times \\frac{1}{36} \\times 1 = \\frac{3}{72} = \\frac{1}{24}$。\n\n- 对于 3 条边界边 $e_{\\text{b,2}}$：\n$\\int_{\\Omega^{(e_{\\text{b,2}})}} \\nabla N_4 \\mathrm{d}V = (\\nabla N_4|_{\\mathrm{T}_2}) (V_{\\mathrm{T}_2}/6) = \\mathbf{0}(1/36) = \\mathbf{0}$。\n$\\tilde{\\nabla} N_4|_{\\Omega^{(e_{\\text{b,2}})}} = \\mathbf{0}$，因此能量贡献为 0。\n\nES-FEM 总能量是这些贡献之和：\n$$ E_{\\mathrm{ES}}(u) = \\frac{1}{48} + \\frac{1}{24} + 0 = \\frac{1+2}{48} = \\frac{3}{48} = \\frac{1}{16} $$\n最后，比率 $R$ 为：\n$$ R = \\frac{E_{\\mathrm{ES}}(u)}{E_{\\mathrm{std}}(u)} = \\frac{1/16}{1/12} = \\frac{12}{16} = \\frac{3}{4} $$\n最终答案是所要求的精确数。", "answer": "$$\\boxed{\\frac{3}{4}}$$", "id": "3567369"}]}