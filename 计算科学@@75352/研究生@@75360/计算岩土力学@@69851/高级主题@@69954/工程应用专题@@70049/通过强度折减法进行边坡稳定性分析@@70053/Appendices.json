{"hands_on_practices": [{"introduction": "强度折减法的核心在于系统地降低岩土材料的强度参数，即黏聚力 $c'$ 和摩擦角 $\\phi'$。此练习旨在深入探究在强度折减过程中，对摩擦角进行折减的标准方法所产生的数学后果。通过推导折减后的摩擦角表达式并分析其对原始摩擦角的依赖关系，您将更深刻地理解强度折减的非线性特性，这对于准确解读数值模拟结果至关重要。[@problem_id:3560645]", "problem": "考虑一个均质、各向同性的边坡，在有限元法（FEM）中使用剪切强度折减（SSR）法进行分析。土体遵循莫尔–库仑破坏准则，其有效黏聚力为 $c'$，有效摩擦角为 $\\phi'$，因此在有效正应力为 $\\sigma_n'$ 的平面上，其发挥的剪切强度由 $\\tau = c' + \\sigma_n' \\tan\\phi'$ 给出。在SSR法中，强度参数通过一个试算安全系数 $F_s > 1$ 进行系统性折减，直到在数值模型中检测到整体破坏。标准的SSR折减方式为 $c' \\mapsto c_r' = c'/F_s$ 和 $\\tan\\phi' \\mapsto \\tan\\phi_r' = \\tan\\phi'/F_s$。\n\n从上述的莫尔–库仑破坏条件和SSR折减方式出发，推导出一个单一的折减后摩擦角 $\\phi_r$，使得折减后的应力-强度关系可以写成与原始形式相同的函数形式，即 $\\tau_r = c_r' + \\sigma_n' \\tan\\phi_r$。请将 $\\phi_r$ 明确地表示为以 $\\phi'$ 和 $F_s$ 为变量的闭式解析表达式，并以弧度为单位指定该角度。\n\n然后，利用正切和反正切函数的基本原理性质，分析在以下两种情况下 $\\phi_r$ 如何依赖于 $F_s$：\n- 小角度 $0  \\phi' \\ll 1$ （以弧度为单位），以及\n- 中到大角度，例如 $\\phi'$ 在 $0.5 \\lesssim \\phi' \\lesssim \\pi/3$ 范围内。\n\n在你的分析中，通过适当的级数展开和单调性论证来证明 $\\phi_r$ 对 $F_s$ 的极限行为和敏感性。除所述的莫尔–库仑准则和SSR折减方式外，不要假设或引用任何预先推导的强度折减公式。请以所要求的以弧度为单位的 $\\phi_r$ 闭式解析表达式作为最终答案。无需四舍五入。", "solution": "该问题要求在剪切强度折减（SSR）法的背景下推导折减后的摩擦角，并分析其性质。该问题具有科学依据，提法恰当且客观，因此被认为是有效的。\n\n分析始于土体抗剪强度的莫尔–库仑破坏准则，即 $\\tau$。有效抗剪强度由黏聚力部分和摩擦力部分之和给出。对于一个有效正应力为 $\\sigma_n'$ 的给定平面，其抗剪强度为：\n$$\n\\tau = c' + \\sigma_n' \\tan\\phi'\n$$\n其中，$c'$ 是有效黏聚力，$\\phi'$ 是有效内摩擦角。\n\n剪切强度折减（SSR）法涉及寻找一个安全系数，记为 $F_s$。将该系数应用于土体的强度参数时，会使土体达到极限平衡状态（即破坏）。问题指明了莫尔–库仑参数的标准SSR折减方式：黏聚力 $c'$ 和摩擦角的正切值 $\\tan\\phi'$ 均除以系数 $F_s$ 进行折减。\n\n设折减后的强度参数记为 $c_r'$ 和 $\\phi_r$。根据题目陈述，新的、折减后的黏聚力为：\n$$\nc_r' = \\frac{c'}{F_s}\n$$\n题目指出，折减同样应用于摩擦角的正切值。这意味着新的、折减后的摩擦角的正切值 $\\tan\\phi_r$ 是通过对原始摩擦角的正切值进行折减来定义的：\n$$\n\\tan\\phi_r = \\frac{\\tan\\phi'}{F_s}\n$$\n由此得到的折减后抗剪强度 $\\tau_r$ 代表了破坏点处发挥的剪切强度，其函数形式与原始准则相同，但使用了折减后的参数：\n$$\n\\tau_r = c_r' + \\sigma_n' \\tan\\phi_r\n$$\n问题要求给出折减后摩擦角 $\\phi_r$ 关于原始摩擦角 $\\phi'$ 和安全系数 $F_s$ 的闭式解析表达式。根据摩擦分量的折减定义，我们可以直接求解 $\\phi_r$。由于 $\\phi_r$ 是这样一个角度，其正切值为 $\\frac{\\tan\\phi'}{F_s}$，我们可以使用反正切函数来表示 $\\phi_r$。假设角度 $\\phi'$ 和 $\\phi_r$ 都在主值范围 $(-\\pi/2, \\pi/2)$ 内，这对于摩擦角是物理上所要求的，我们有：\n$$\n\\phi_r = \\arctan\\left(\\frac{\\tan\\phi'}{F_s}\\right)\n$$\n这就是所要求的以弧度表示的折减后摩擦角的闭式表达式。\n\n接下来，我们分析在 $\\phi'$ 的两种不同情况下，$\\phi_r$ 对 $F_s$ 的依赖关系。\n\n情况1：小角度（$0  \\phi' \\ll 1$，以弧度为单位）\n\n对于小角度 $x$，$\\tan(x)$ 和 $\\arctan(y)$ 的麦克劳林级数为：\n$$\n\\tan(x) = x + \\frac{x^3}{3} + O(x^5)\n$$\n$$\n\\arctan(y) = y - \\frac{y^3}{3} + O(y^5)\n$$\n鉴于 $\\phi'$ 很小，我们可以近似 $\\tan\\phi'$：\n$$\n\\tan\\phi' \\approx \\phi'\n$$\n我们表达式中反正切函数的自变量变为 $\\frac{\\tan\\phi'}{F_s} \\approx \\frac{\\phi'}{F_s}$。由于 $F_s > 1$，该自变量也很小。因此，折减后的角度 $\\phi_r$ 也很小，这使得我们可以使用反正切函数的小角度近似：\n$$\n\\phi_r = \\arctan\\left(\\frac{\\tan\\phi'}{F_s}\\right) \\approx \\frac{\\tan\\phi'}{F_s} \\approx \\frac{\\phi'}{F_s}\n$$\n这表明对于小摩擦角，折减后的角度 $\\phi_r$ 约等于原始角度 $\\phi'$ 除以安全系数 $F_s$。该关系近似线性。\n\n为了更严谨，我们将 $\\phi_r$ 的表达式按 $\\phi'$ 的幂次展开。令 $x = \\phi'$。\n$$\n\\frac{\\tan(x)}{F_s} = \\frac{x + x^3/3 + O(x^5)}{F_s} = \\frac{x}{F_s} + \\frac{x^3}{3F_s} + O(x^5)\n$$\n现在，我们将此式代入 $\\arctan(y)$ 的级数中，其中 $y = \\frac{\\tan(x)}{F_s}$：\n$$\n\\phi_r = \\left(\\frac{x}{F_s} + \\frac{x^3}{3F_s}\\right) - \\frac{1}{3}\\left(\\frac{x}{F_s}\\right)^3 + O(x^5)\n$$\n$$\n\\phi_r = \\frac{x}{F_s} + \\left(\\frac{1}{3F_s} - \\frac{1}{3F_s^3}\\right)x^3 + O(x^5)\n$$\n将 $x = \\phi'$ 代回：\n$$\n\\phi_r = \\frac{\\phi'}{F_s} + \\frac{F_s^2 - 1}{3F_s^3}(\\phi')^3 + O((\\phi')^5)\n$$\n由于 $F_s > 1$，$(\\phi')^3$ 项的系数 $\\frac{F_s^2 - 1}{3F_s^3}$ 为正。这严格证明了 $\\phi_r$ 略大于线性近似值 $\\phi'/F_s$。这意味着，与假设的对角度本身直接进行折减（$\\phi' \\mapsto \\phi'/F_s$）相比，对 $\\tan\\phi'$ 进行标准的SSR折减导致对摩擦角本身的折减程度较小。\n\n情况2：中到大角度（$0.5 \\lesssim \\phi' \\lesssim \\pi/3$）\n\n在此范围内，小角度近似不再有效，关系式 $\\phi_r = \\arctan\\left(\\frac{\\tan\\phi'}{F_s}\\right)$ 是高度非线性的。为了分析 $\\phi_r$ 对 $F_s$ 的敏感性，我们考察偏导数 $\\frac{\\partial\\phi_r}{\\partial F_s}$。使用链式法则进行求导，其中 $u = \\frac{\\tan\\phi'}{F_s}$：\n$$\n\\frac{\\partial\\phi_r}{\\partial F_s} = \\frac{\\partial}{\\partial F_s} \\arctan(u) = \\frac{1}{1+u^2} \\frac{\\partial u}{\\partial F_s}\n$$\n$u$ 对 $F_s$ 的导数为：\n$$\n\\frac{\\partial u}{\\partial F_s} = \\tan\\phi' \\left(-\\frac{1}{F_s^2}\\right) = -\\frac{\\tan\\phi'}{F_s^2}\n$$\n将此代回，我们得到：\n$$\n\\frac{\\partial\\phi_r}{\\partial F_s} = \\frac{1}{1 + \\left(\\frac{\\tan\\phi'}{F_s}\\right)^2} \\left(-\\frac{\\tan\\phi'}{F_s^2}\\right) = -\\frac{\\tan\\phi'}{F_s^2 + (\\tan\\phi')^2}\n$$\n由于 $\\phi' \\in (0, \\pi/2)$，因此 $\\tan\\phi' > 0$。又因为 $F_s > 1$，分母始终为正。所以，$\\frac{\\partial\\phi_r}{\\partial F_s} < 0$，这证实了 $\\phi_r$ 是 $F_s$ 的单调递减函数。这在物理上是直观的：更大的安全系数要求更大的强度折减，因此折减后的摩擦角更小。\n\n折减的非线性可以通过证明不等式 $\\phi_r > \\phi'/F_s$ 对所有 $\\phi' \\in (0, \\pi/2)$ 和 $F_s > 1$ 成立来进一步说明。让我们定义变量 $x$ 的两个函数：$f(x) = \\arctan\\left(\\frac{\\tan x}{F_s}\\right)$ 和 $g(x) = \\frac{x}{F_s}$。我们注意到 $f(0) = g(0) = 0$。现在我们比较它们的导数：\n$$\ng'(x) = \\frac{1}{F_s}\n$$\n$$\nf'(x) = \\frac{d}{dx}\\arctan\\left(\\frac{\\tan x}{F_s}\\right) = \\frac{1}{1+\\left(\\frac{\\tan x}{F_s}\\right)^2} \\cdot \\frac{\\sec^2 x}{F_s} = \\frac{F_s \\sec^2 x}{F_s^2 + \\tan^2 x}\n$$\n我们想检验是否 $f'(x) > g'(x)$：\n$$\n\\frac{F_s \\sec^2 x}{F_s^2 + \\tan^2 x} > \\frac{1}{F_s}\n$$\n$$\nF_s^2 \\sec^2 x > F_s^2 + \\tan^2 x\n$$\n使用恒等式 $\\sec^2 x = 1 + \\tan^2 x$：\n$$\nF_s^2 (1 + \\tan^2 x) > F_s^2 + \\tan^2 x\n$$\n$$\nF_s^2 + F_s^2 \\tan^2 x > F_s^2 + \\tan^2 x\n$$\n$$\n(F_s^2 - 1) \\tan^2 x > 0\n$$\n由于 $F_s > 1$，所以 $F_s^2 - 1 > 0$。对于 $x \\in (0, \\pi/2)$，$\\tan^2 x > 0$。因此，该不等式成立。因为 $f(0) = g(0)$ 且对于 $x > 0$ 有 $f'(x) > g'(x)$，根据中值定理可知，对于所有 $x > 0$ 都有 $f(x) > g(x)$。代入 $x = \\phi'$，我们便确定地证明了：\n$$\n\\arctan\\left(\\frac{\\tan\\phi'}{F_s}\\right) > \\frac{\\phi'}{F_s}\n$$\n这个不等式证实了标准的SSR折减方法比直接对角度 $\\phi'$ 本身进行折减要不那么保守（即得到一个更高的折减后摩擦角）。与线性的偏差 $\\phi_r - \\phi'/F_s$ 随着 $\\phi'$ 从小角度区间移动到中到大角度区间而增加。这种非线性行为是莫尔–库仑准则和标准SSR折减程序的内在属性。", "answer": "$$\\boxed{\\arctan\\left(\\frac{\\tan\\phi'}{F_s}\\right)}$$", "id": "3560645"}, {"introduction": "在理解了强度折减的“内容”（即折减哪些参数）之后，下一个关键问题是“如何”找到导致边坡失稳的临界强度折减系数，即安全系数 $F_s$。本练习将指导您设计一个数值算法，该算法通过迭代增加折减系数直至检测到失稳，从而模拟计算软件自动确定 $F_s$ 的过程。通过为一个简化的无限边坡模型实施自适应搜索和区间套索算法，您将揭开强度折减法分析自动化过程的神秘面纱，并培养核心的计算问题解决能力。[@problem_id:3560694]", "problem": "设计并实现一个完整的、可运行的程序，该程序为几种指定的边坡配置，在采用自适应步长控制和对失稳乘数进行严格区间限定的强度折减法（SRM）分析中，计算出引发破坏的临界强度折减系数 $F_s^\\star$。该分析必须基于以下基本原理。\n\n基本原理：\n- 力平衡要求内部调动的剪切牵引力与外部驱动的剪切需求相平衡。\n- 以有效应力表示的莫尔-库仑剪切强度为 $ \\tau_\\mathrm{s} = c' + \\sigma_n' \\tan \\phi'$，其中 $c'$ 是有效黏聚力，$\\phi'$ 是有效内摩擦角。\n- 在强度折减法中，强度参数被安全系数 $F_s$ 折减，即 $c'_r = c'/F_s$ 和 $\\tan \\phi'_r = \\tan \\phi'/F_s$。\n- 对于深度为 $z$ 的干燥无限边坡，在平行于坡面的平面上，驱动剪应力和法向应力分别为 $ \\tau_\\mathrm{d}(z) = \\gamma z \\sin\\beta \\cos\\beta$ 和 $ \\sigma_n(z) = \\gamma z \\cos^2 \\beta$，其中 $\\gamma$ 是重度，$\\beta$ 是坡角。此处取 $z = H$（特征深度等于边坡高度 $H$）。角度必须以度为单位提供，并在计算时转换为弧度。\n- 当找不到满足折减后强度容许性条件的非线性平衡解时，即表示发生破坏，也就是说，平衡所需的调动剪切牵引力超过了折减后的强度。\n\n您必须将计算问题纯粹用数学术语表述如下。\n\n1) 每个试验 $F_s$ 的非线性平衡问题：\n- 在一个具有单位面积弹性刚度 $k_t$ 的代表性界面上，引入一个标量滑移位移 $w \\ge 0$，该界面遵循带有莫尔-库仑上限的弹塑性定律：\n  - 弹性试探牵引力：$t_\\mathrm{trial} = k_t w$。\n  - 折减后的屈服强度：$t_\\mathrm{y}(F_s) = c'/F_s + \\sigma_n \\tan\\phi'/F_s$。\n  - 容许牵引力：$t(w;F_s) = \\min\\{t_\\mathrm{trial}, t_\\mathrm{y}(F_s)\\}$。\n- 平衡残差为 $r(w;F_s) = t(w;F_s) - \\tau_\\mathrm{d}$，其中 $\\tau_\\mathrm{d} = \\gamma H \\sin\\beta \\cos\\beta$ 和 $\\sigma_n = \\gamma H \\cos^2 \\beta$。\n- 对于给定的 $F_s$，求解非线性方程 $r(w;F_s)=0$ 以得到 $w \\ge 0$。如果不存在满足 $r(w;F_s)=0$ 的 $w$（即如果 $\\tau_\\mathrm{d} > t_\\mathrm{y}(F_s)$），则声明该 $F_s$ 发生“破坏”。计算过程中角度必须解释为弧度。应力必须以 $\\mathrm{kPa}$ 为单位进行一致计算，$\\gamma$ 的单位为 $\\mathrm{kN/m^3}$，$H$ 的单位为 $\\mathrm{m}$，这样 $\\gamma H$ 的结果单位为 $\\mathrm{kPa}$。\n\n2) 外部算法：自适应步长控制与 $F_s^\\star$ 的区间限定：\n- 从 $F_s = 1$ 开始。\n- 基于带符号的稳定裕度 $g(F_s) = t_\\mathrm{y}(F_s) - \\tau_\\mathrm{d}$，使用自适应步长 $\\Delta F_s$ 迭代增加 $F_s$：\n  - 如果 $g(F_s) \\ge 0$，则系统在此 $F_s$ 下稳定；通过一个正步长增加 $F_s$。当 $g(F_s)$ 为强正值时，使 $\\Delta F_s$ 更大；当 $g(F_s)$ 接近零时，使其更小，并受限于上下界以保证数值稳健性。\n  - 如果 $g(F_s) < 0$，则系统在此 $F_s$ 下不稳定；您已经对失稳乘数进行了区间限定。将最后一个稳定的 $F_s$ 记录为下界，将当前不稳定的 $F_s$ 记录为上界。\n- 如果在 $F_s = 1$ 时的初始配置已经不稳定，则自适应地减小 $F_s$（例如，通过折半）直到达到稳定状态以获得下界，从而从下方限定 $F_s^\\star$ 的区间。\n- 一旦确定了满足 $g(F_s^\\mathrm{L}) \\ge 0$ 和 $g(F_s^\\mathrm{U}) < 0$ 的区间 $[F_s^\\mathrm{L}, F_s^\\mathrm{U}]$，则通过对 $g(F_s)$ 进行二分法来细化 $F_s^\\star$，直到满足公差标准。在 $F_s$ 上使用 $10^{-8}$ 的收敛公差。\n- 最终报告的 $F_s^\\star$ 是使非线性平衡失效的最小 $F_s$（强度折减的失稳乘数），即通过区间限定和二分法找到的 $g(F_s) = 0$ 的根。\n\n3) 数值要求：\n- 输入中的所有角度都以度为单位，并且必须在计算中转换为弧度。\n- 使用 $k_t = 10^3\\,\\mathrm{kPa}$ 作为单位面积的界面弹性刚度。该参数确保了在平衡求解器中有一个明确定义的弹性预测器；最终的 $F_s^\\star$ 不得依赖于 $k_t$，因为破坏指标由容许性条件决定。\n- 实现带有安全措施的稳健自适应步长控制：强制 $\\Delta F_s \\in [10^{-2}, 2]$ 并设置最多 $10^4$ 次外部迭代以保证终止。\n\n测试套件：\n为以下四种情况提供 $F_s^\\star$。使用 $H$ 单位为 $\\mathrm{m}$，$\\gamma$ 单位为 $\\mathrm{kN/m^3}$，$c'$ 单位为 $\\mathrm{kPa}$，角度单位为度。将最终答案报告为无量纲浮点数。程序必须按顺序计算所有四种情况，并将最终结果打印在单行上，格式为方括号内以逗号分隔的列表，每个值四舍五入到小数点后六位。\n\n- 情况A（一般稳定情况）：\n  - $\\gamma = 20\\,\\mathrm{kN/m^3}$，\n  - $H = 10\\,\\mathrm{m}$，\n  - $\\beta = 30^\\circ$，\n  - $c' = 5\\,\\mathrm{kPa}$，\n  - $\\phi' = 30^\\circ$。\n- 情况B（在 $F_s=1$ 时初始不稳定）：\n  - $\\gamma = 18\\,\\mathrm{kN/m^3}$，\n  - $H = 12\\,\\mathrm{m}$，\n  - $\\beta = 35^\\circ$，\n  - $c' = 0\\,\\mathrm{kPa}$，\n  - $\\phi' = 28^\\circ$。\n- 情况C（稳定但具有较大的失稳乘数）：\n  - $\\gamma = 18\\,\\mathrm{kN/m^3}$，\n  - $H = 5\\,\\mathrm{m}$，\n  - $\\beta = 25^\\circ$，\n  - $c' = 2\\,\\mathrm{kPa}$，\n  - $\\phi' = 35^\\circ$。\n- 情况D（边界情况）：\n  - $\\gamma = 21\\,\\mathrm{kN/m^3}$，\n  - $H = 8\\,\\mathrm{m}$，\n  - $\\beta = 26^\\circ$，\n  - $c' = 0\\,\\mathrm{kPa}$，\n  - $\\phi' = 26^\\circ$。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如 $[x_1,x_2,x_3,x_4]$）的结果，每个 $x_i$ 精确四舍五入到小数点后六位。每个输出项是对应情况计算出的 $F_s^\\star$，并且是无量纲的。不得打印任何其他文本。", "solution": "该问题被评估为有效。它在科学上基于土力学原理，问题提法适定，并为数值求解提供了一套完整且一致的要求。该问题要求设计并实现一种算法，为几种无限边坡配置找到临界强度折减系数 $F_s^\\star$。尽管该问题可以解析求解，但核心任务是实现指定的数值方案，该方案涉及自适应搜索和二分法，这是计算工程中常见且实用的任务。\n\n解决方案步骤如下：首先，建立控制物理和数学方程。其次，详细阐述用于定位临界安全系数的指定数值算法。最后，在 Python 程序中实现此算法以解决给定的测试用例。\n\n**1. 理论阐述**\n\n分析了一个无限、干燥、无黏聚力-摩擦性边坡的稳定性。基本输入是土的重度 $\\gamma$、边坡高度 $H$（应力评估点）、坡角 $\\beta$、有效黏聚力 $c'$ 和有效内摩擦角 $\\phi'$。\n\n对于潜在破坏面上深度为 $H$ 的一点，该破坏面平行于边坡表面，驱动剪应力 $\\tau_\\mathrm{d}$ 和法向应力 $\\sigma_n$ 由下式给出：\n$$\n\\tau_\\mathrm{d} = \\gamma H \\sin\\beta \\cos\\beta\n$$\n$$\n\\sigma_n = \\gamma H \\cos^2\\beta\n$$\n问题指定的是干坡，因此有效法向应力 $\\sigma_n'$ 等于总法向应力 $\\sigma_n$。土体的可用剪切强度由莫尔-库仑破坏准则描述：\n$$\n\\tau_s = c' + \\sigma_n \\tan\\phi'\n$$\n强度折减法（SRM）涉及找到一个安全系数 $F_s$，用它来除以强度参数，从而使边坡达到极限平衡状态。折减后的强度参数 $c'_r$ 和 $\\phi'_r$ 为：\n$$\nc'_r = \\frac{c'}{F_s}\n$$\n$$\n\\tan\\phi'_r = \\frac{\\tan\\phi'}{F_s}\n$$\n因此，折减后的剪切强度，记为 $t_y(F_s)$，是：\n$$\nt_y(F_s) = \\frac{c'}{F_s} + \\sigma_n \\frac{\\tan\\phi'}{F_s} = \\frac{c' + \\sigma_n \\tan\\phi'}{F_s}\n$$\n问题引入了一个虚拟的弹塑性界面模型来形式化平衡条件。然而，破坏条件简化为驱动剪应力超过可用折减强度的时刻。只有当 $\\tau_\\mathrm{d} \\le t_y(F_s)$ 时，平衡状态才可能存在。临界状态或破坏发生在使平衡无法维持的最小 $F_s$ 值处，记为 $F_s^\\star$。这对应于极限平衡条件 $\\tau_\\mathrm{d} = t_y(F_s^\\star)$。\n\n为了便于数值搜索，我们定义一个稳定裕度函数 $g(F_s)$：\n$$\ng(F_s) = t_y(F_s) - \\tau_\\mathrm{d} = \\frac{c' + \\sigma_n \\tan\\phi'}{F_s} - \\tau_\\mathrm{d}\n$$\n- 如果 $g(F_s) > 0$，边坡在给定的 $F_s$ 下是稳定的。\n- 如果 $g(F_s) < 0$，边坡在给定的 $F_s$ 下是不稳定的。\n- 如果 $g(F_s) = 0$，边坡处于极限平衡状态。\n\n因此，问题简化为求解方程 $g(F_s) = 0$ 的根。解出 $F_s$ 即可得到安全系数的解析解：\n$$\nF_s^\\star = \\frac{c' + \\sigma_n \\tan\\phi'}{\\tau_\\mathrm{d}} = \\frac{c' + \\gamma H \\cos^2\\beta \\tan\\phi'}{\\gamma H \\sin\\beta \\cos\\beta} = \\frac{c'}{\\gamma H \\sin\\beta \\cos\\beta} + \\frac{\\tan\\phi'}{\\tan\\beta}\n$$\n虽然这个解析公式存在并且可以用于验证，但问题要求实现一个特定的数值算法来寻找 $F_s^\\star$。\n\n**2. 算法设计**\n\n任务的核心是为 $g(F_s)=0$ 实现一个求根算法，该算法遵循规定的三阶段过程：自适应区间搜索、二分法细化和最终报告。所有角度必须从度转换为弧度以进行三角计算。\n\n**阶段1：区间搜索**\n目标是找到下界 $F_s^\\mathrm{L}$ 和上界 $F_s^\\mathrm{U}$，使得 $g(F_s^\\mathrm{L}) \\ge 0$ 且 $g(F_s^\\mathrm{U}) < 0$。搜索从 $F_s=1$ 开始。\n\n- **情况1：初始稳定边坡 ($g(1) \\ge 0$)**\n  初始值 $F_s=1$ 作为下界，$F_s^\\mathrm{L} = 1$。我们必须通过迭代增加 $F_s$ 来搜索上界。\n  采用自适应步长规则。步长 $\\Delta F_s$ 应随着 $g(F_s)$ 接近零而减小。一个基于归一化稳定裕度的合适规则是：\n  $$\n  \\Delta F_s = \\alpha \\cdot F_s \\cdot \\frac{g(F_s)}{\\tau_\\mathrm{d}}\n  $$\n  其中 $\\alpha$ 是一个阻尼因子（例如 $\\alpha=0.5$）。为确保稳健性和进展，此步长被限制在规定范围 $[\\Delta F_{s, \\min}, \\Delta F_{s, \\max}]$ 内，给定值为 $[10^{-2}, 2]$。迭代过程为 $F_{s, i+1} = F_{s, i} + \\Delta F_s$，直到 $g(F_{s, i+1}) < 0$。此时，$F_s^\\mathrm{U} = F_{s, i+1}$，区间便已建立。\n\n- **情况2：初始不稳定边坡 ($g(1) < 0$)**\n  初始值 $F_s=1$ 作为上界，$F_s^\\mathrm{U} = 1$。我们必须通过迭代减小 $F_s$ 来搜索下界。如建议所述，一种简单而稳健的方法是重复将 $F_s$ 折半，即 $F_{s, i+1} = F_{s, i} / 2$，直到 $g(F_{s, i+1}) \\ge 0$。此时，$F_s^\\mathrm{L} = F_{s, i+1}$，区间便已建立。\n\n在此阶段，使用最大迭代次数（$10^4$）作为防止无限循环的保障措施。\n\n**阶段2：二分法细化**\n一旦找到区间 $[F_s^\\mathrm{L}, F_s^\\mathrm{U}]$，便应用二分法以高精度细化根 $F_s^\\star$。算法如下：\n1. 计算中点：$F_s^\\mathrm{mid} = (F_s^\\mathrm{L} + F_s^\\mathrm{U}) / 2$。\n2. 评估中点处的稳定裕度 $g(F_s^\\mathrm{mid})$。\n3. 更新区间：\n   - 如果 $g(F_s^\\mathrm{mid}) \\ge 0$，根在区间的上半部分，因此设 $F_s^\\mathrm{L} = F_s^\\mathrm{mid}$。\n   - 如果 $g(F_s^\\mathrm{mid}) < 0$，根在区间的下半部分，因此设 $F_s^\\mathrm{U} = F_s^\\mathrm{mid}$。\n4. 重复步骤1-3，直到区间的宽度 $(F_s^\\mathrm{U} - F_s^\\mathrm{L})$ 小于指定的公差 $10^{-8}$。\n\n**阶段3：最终结果**\n临界安全系数 $F_s^\\star$ 的最终估计值取为最终区间的中点 $(F_s^\\mathrm{L} + F_s^\\mathrm{U}) / 2$。然后将该值按要求格式化以供输出。\n\n这个综合算法确保了根据问题规范，稳健而准确地确定 $F_s^\\star$。", "answer": "```python\nimport numpy as np\n\ndef compute_fs_star(gamma, H, beta_deg, c_prime, phi_prime_deg):\n    \"\"\"\n    Computes the critical strength reduction factor (Fs_star) for an infinite slope.\n\n    The function implements a numerical scheme involving an adaptive search to\n    bracket the solution, followed by bisection to refine it to a high tolerance.\n\n    Args:\n        gamma (float): Unit weight of the soil (kN/m^3).\n        H (float): Characteristic depth/height (m).\n        beta_deg (float): Slope angle (degrees).\n        c_prime (float): Effective cohesion (kPa).\n        phi_prime_deg (float): Effective internal friction angle (degrees).\n\n    Returns:\n        float: The computed critical strength reduction factor, Fs_star.\n    \"\"\"\n    # Numerical parameters and tolerances from the problem statement\n    TOL = 1e-8\n    MAX_ITER_OUTER = 10000\n    MIN_DFs = 0.01\n    MAX_DFs = 2.0\n    # k_t is not needed for the simplified failure condition g(Fs)=0\n\n    # Convert angles from degrees to radians for computation\n    beta_rad = np.deg2rad(beta_deg)\n    phi_rad = np.deg2rad(phi_prime_deg)\n\n    # Calculate driving shear stress (tau_d) and normal stress (sigma_n)\n    tau_d = gamma * H * np.sin(beta_rad) * np.cos(beta_rad)\n    sigma_n = gamma * H * np.cos(beta_rad)**2\n    \n    # Handle the edge case where tau_d is zero or negative (e.g., beta >= 90 deg)\n    # The analytical Fs would be infinite. The numerical search might fail.\n    # For this problem's context, tau_d will be positive.\n    if tau_d = 0:\n        return np.inf # Practically stable for any Fs\n\n    # Define the stability margin function g(Fs)\n    # g(Fs) = t_y(Fs) - tau_d\n    strength_term = c_prime + sigma_n * np.tan(phi_rad)\n    \n    # If the strength term is zero or negative, the slope is unconditionally unstable\n    if strength_term = 0:\n        return 0.0\n        \n    g = lambda Fs: strength_term / Fs - tau_d\n\n    # --- Phase 1: Bracketing Search ---\n    fs_lower = None\n    fs_upper = None\n    \n    fs_current = 1.0\n    margin = g(fs_current)\n\n    if margin >= 0:  # Initially stable case (g(1) >= 0)\n        fs_lower = fs_current\n        # Search for an upper bound by increasing Fs\n        for _ in range(MAX_ITER_OUTER):\n            # Adaptive step size calculation\n            # Proportional to the normalized margin, damped by a factor 0.5\n            # This makes the step larger when far from failure, smaller when close\n            if tau_d > 0:\n                delta_fs_calc = 0.5 * fs_current * (g(fs_current) / tau_d)\n            else: # Should not happen with valid inputs\n                delta_fs_calc = MIN_DFs\n            \n            delta_fs = np.clip(delta_fs_calc, MIN_DFs, MAX_DFs)\n            \n            fs_next = fs_current + delta_fs\n            margin_next = g(fs_next)\n\n            if margin_next  0:\n                fs_upper = fs_next\n                break\n            else:\n                fs_current = fs_next\n        else: # Loop finished without finding an upper bound\n            raise RuntimeError(\"Bracketing failed: could not find an upper bound.\")\n\n    else:  # Initially unstable case (g(1)  0)\n        fs_upper = fs_current\n        # Search for a lower bound by decreasing Fs (halving)\n        for _ in range(MAX_ITER_OUTER):\n            fs_next = fs_current / 2.0\n            margin_next = g(fs_next)\n            \n            if margin_next >= 0:\n                fs_lower = fs_next\n                break\n            else:\n                fs_current = fs_next\n        else: # Loop finished without finding a lower bound\n             raise RuntimeError(\"Bracketing failed: could not find a lower bound.\")\n\n    if fs_lower is None or fs_upper is None:\n        raise RuntimeError(\"Bracketing failed unexpectedly.\")\n\n    # --- Phase 2: Bisection Refinement ---\n    while (fs_upper - fs_lower) > TOL:\n        fs_mid = (fs_lower + fs_upper) / 2.0\n        if fs_mid == fs_lower or fs_mid == fs_upper: # Reached precision limit\n            break\n        \n        margin_mid = g(fs_mid)\n\n        if margin_mid >= 0:\n            fs_lower = fs_mid\n        else:\n            fs_upper = fs_mid\n            \n    # --- Phase 3: Final Result ---\n    fs_star = (fs_lower + fs_upper) / 2.0\n    return fs_star\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print results.\n    \"\"\"\n    # Test cases as defined in the problem statement\n    test_cases = [\n        # Case A (general stable case)\n        {'gamma': 20.0, 'H': 10.0, 'beta_deg': 30.0, 'c_prime': 5.0, 'phi_prime_deg': 30.0},\n        # Case B (initially unstable at Fs=1)\n        {'gamma': 18.0, 'H': 12.0, 'beta_deg': 35.0, 'c_prime': 0.0, 'phi_prime_deg': 28.0},\n        # Case C (stable with larger collapse multiplier)\n        {'gamma': 18.0, 'H': 5.0, 'beta_deg': 25.0, 'c_prime': 2.0, 'phi_prime_deg': 35.0},\n        # Case D (boundary case)\n        {'gamma': 21.0, 'H': 8.0, 'beta_deg': 26.0, 'c_prime': 0.0, 'phi_prime_deg': 26.0},\n    ]\n\n    results = []\n    for case in test_cases:\n        fs_star = compute_fs_star(**case)\n        results.append(fs_star)\n\n    # Format the final output according to the specified format\n    # Comma-separated list, in brackets, with each value rounded to 6 decimal places.\n    print(f\"[{','.join(f'{x:.6f}' for x in results)}]\")\n\nsolve()\n```", "id": "3560694"}, {"introduction": "强度折减法的强大之处在于其广泛的适用性，它不仅能处理重力荷载，还能应用于更复杂的荷载工况。本练习将分析范围扩展至拟静力荷载，这是岩土工程中模拟地震对边坡稳定性影响的常用方法。通过计算边坡在重力与地震联合作用下的安全系数，您将学会如何应用强度折减法来评估更复杂、更贴近实际的工程场景下的边坡稳定性。[@problem_id:3560705]", "problem": "一个土质边坡使用莫尔-库仑破坏准则和强度折减法，在由拟静力加速度系数表示的地震诱发惯性荷载作用下进行分析。目标是将水平和垂直拟静力系数（分别表示为 $k_h$ 和 $k_v$）作为荷载乘子进行耦合，同时通过一个强度折减系数（SRF），表示为 $F_s$，来折减剪切强度，并将破坏映射到一个曲面 $F(F_s,k_h,k_v)=0$。该边坡被建模为一个无限边坡，其破坏面平行于地表，深度为 $z$，因此可以在该平面上进行闭合形式的应力投影。\n\n从基本原理出发：(i) 在重力和拟静力惯性力作用下的体力平衡，以及 (ii) 莫尔-库仑破坏准则。莫尔-库仑剪切强度为 $ \\tau_f = c' + \\sigma_n' \\tan(\\phi') $，其中 $c'$ 是黏聚力，$\\phi'$ 是内摩擦角，$\\sigma_n'$ 是总法向应力（假设为干燥条件，忽略孔隙水压力）。在强度折减法中，折减后的参数为 $c' = c / F_s$ 和 $\\tan(\\phi') = \\tan(\\phi) / F_s$。\n\n对于一个相对于水平面倾角为 $\\beta$、单位厚度和单位宽度、土体单位重量为 $\\gamma$ 的无限边坡，破坏面上的重力分量产生的静态切向剪应力为 $ \\tau_0 = \\gamma z \\sin(\\beta) \\cos(\\beta) $，法向应力为 $ \\sigma_{n0} = \\gamma z \\cos^2(\\beta) $。当施加拟静力惯性荷载时，大小为 $k_h \\gamma z$ 的等效水平惯性体力沿坡面向下作用，大小为 $k_v \\gamma z$ 的竖直惯性体力向上作用。将这些体力分解到平面的切向和法向方向，以获得平面上的总切向应力和法向应力：\n$$\n\\tau(\\beta,k_h,k_v) = \\gamma z \\left[\\sin(\\beta)\\cos(\\beta) + k_h \\cos^2(\\beta) - k_v \\sin(\\beta)\\cos(\\beta)\\right],\n$$\n$$\n\\sigma_n(\\beta,k_h,k_v) = \\gamma z \\left[\\cos^2(\\beta) + k_h \\sin(\\beta)\\cos(\\beta) - k_v \\cos^2(\\beta)\\right].\n$$\n在强度折减下，当折减后的剪切强度等于作用在平面上的剪应力时，发生破坏：\n$$\n\\tau(\\beta,k_h,k_v) = \\frac{c}{F_s} + \\frac{\\sigma_n(\\beta,k_h,k_v)\\tan(\\phi)}{F_s}.\n$$\n通过以下公式定义破坏面\n$$\nF(F_s,k_h,k_v) = F_s - \\frac{c + \\sigma_n(\\beta,k_h,k_v)\\tan(\\phi)}{\\tau(\\beta,k_h,k_v)} = 0,\n$$\n因此，临界强度折减系数为\n$$\nF_{s, \\mathrm{crit}}(k_h,k_v) = \\frac{c + \\sigma_n(\\beta,k_h,k_v)\\tan(\\phi)}{\\tau(\\beta,k_h,k_v)}.\n$$\n所有角度必须以度为单位提供，但在进行三角函数计算时需转换为弧度。所有应力必须以千帕（kPa）为单位计算，这通过将单位重量 $ \\gamma $ 的单位取为 $\\mathrm{kN/m^3}$、深度 $ z $ 的单位取为 $\\mathrm{m}$ 来实现，因此 $ \\gamma z $ 的单位为 $\\mathrm{kN/m^2} = \\mathrm{kPa}$。黏聚力 $ c $ 必须以 $\\mathrm{kPa}$ 为单位提供。最终输出 $F_{s, \\mathrm{crit}}(k_h,k_v)$ 是无量纲的。\n\n实现一个程序，对于一组给定的参数 $(\\gamma,z,\\beta,c,\\phi,k_h,k_v)$，使用上述方程计算 $F_{s, \\mathrm{crit}}(k_h,k_v)$。输入时对 $\\beta$ 和 $\\phi$ 使用度，并在内部转换为弧度。程序必须生成单行输出，包含一个用方括号括起来的逗号分隔列表，其中每个浮点数四舍五入到六位小数。\n\n测试集：\n- 情况 $1$：$ \\gamma=18\\,\\mathrm{kN/m^3} $，$ z=10\\,\\mathrm{m} $，$ \\beta=30^\\circ $，$ c=5\\,\\mathrm{kPa} $，$ \\phi=35^\\circ $，$ k_h=0.0 $，$ k_v=0.0 $。\n- 情况 $2$：$ \\gamma=18\\,\\mathrm{kN/m^3} $，$ z=10\\,\\mathrm{m} $，$ \\beta=30^\\circ $，$ c=5\\,\\mathrm{kPa} $，$ \\phi=35^\\circ $，$ k_h=0.2 $，$ k_v=0.0 $。\n- 情况 $3$：$ \\gamma=18\\,\\mathrm{kN/m^3} $，$ z=10\\,\\mathrm{m} $，$ \\beta=30^\\circ $，$ c=5\\,\\mathrm{kPa} $，$ \\phi=35^\\circ $，$ k_h=0.3 $，$ k_v=0.1 $。\n- 情况 $4$：$ \\gamma=18\\,\\mathrm{kN/m^3} $，$ z=10\\,\\mathrm{m} $，$ \\beta=30^\\circ $，$ c=5\\,\\mathrm{kPa} $，$ \\phi=35^\\circ $，$ k_h=0.25 $，$ k_v=-0.2 $。\n- 情况 $5$：$ \\gamma=20\\,\\mathrm{kN/m^3} $，$ z=8\\,\\mathrm{m} $，$ \\beta=40^\\circ $，$ c=0\\,\\mathrm{kPa} $，$ \\phi=28^\\circ $，$ k_h=0.15 $，$ k_v=0.0 $。\n- 情况 $6$：$ \\gamma=18\\,\\mathrm{kN/m^3} $，$ z=5\\,\\mathrm{m} $，$ \\beta=10^\\circ $，$ c=3\\,\\mathrm{kPa} $，$ \\phi=30^\\circ $，$ k_h=0.4 $，$ k_v=0.3 $。\n\n您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔的结果列表（例如，$ [F_{s1}, F_{s2}, \\dots]$），每个 $F_{si}$ 四舍五入到六位小数。", "solution": "该问题要求计算一个无限边坡在重力和拟静力惯性荷载作用下的临界强度折减系数 $F_{s, \\mathrm{crit}}$。该系数表示一个标量乘子，土体的剪切强度参数（黏聚力 $c$ 和内摩擦角 $\\phi$）必须被折减该乘子倍，才能使边坡达到极限平衡状态。该分析基于莫尔-库仑破坏准则。\n\n问题给出了临界强度折减系数的确定性方程，该方程源于极限平衡条件，即调动的剪应力等于折减后的剪切强度：\n$$\nF_{s, \\mathrm{crit}}(k_h, k_v) = \\frac{c + \\sigma_n(\\beta, k_h, k_v) \\tan(\\phi)}{\\tau(\\beta, k_h, k_v)}\n$$\n为了计算 $F_{s, \\mathrm{crit}}$，我们必须首先计算作用在潜在破坏面上的总法向应力 $\\sigma_n$ 和总切向剪应力 $\\tau$。假设破坏面平行于边坡表面，位于深度 $z$ 处。\n\n输入参数包括土体单位重量 $\\gamma$（单位：$\\mathrm{kN/m^3}$）、破坏面深度 $z$（单位：$\\mathrm{m}$）、边坡角 $\\beta$（单位：度）、土体黏聚力 $c$（单位：$\\mathrm{kPa}$）、土体内摩擦角 $\\phi$（单位：度），以及水平和垂直拟静力加速度系数 $k_h$ 和 $k_v$（无量纲）。\n\n计算的程序步骤如下：\n\n1.  **角度转换**：输入的角度 $\\beta$ 和 $\\phi$ 以度为单位。为了在三角函数中使用，它们必须转换为弧度。\n    $$\n    \\beta_{\\mathrm{rad}} = \\beta_{\\mathrm{deg}} \\cdot \\frac{\\pi}{180}\n    $$\n    $$\n    \\phi_{\\mathrm{rad}} = \\phi_{\\mathrm{deg}} \\cdot \\frac{\\pi}{180}\n    $$\n\n2.  **应力计算**：使用给定的方程计算破坏面上的总切向剪应力 $\\tau$ 和总法向应力 $\\sigma_n$。这些方程考虑了土体自重以及由水平和垂直加速度引起的惯性力的分量。\n    驱动破坏的总切向剪应力由下式给出：\n    $$\n    \\tau(\\beta, k_h, k_v) = \\gamma z \\left[\\sin(\\beta_{\\mathrm{rad}})\\cos(\\beta_{\\mathrm{rad}}) + k_h \\cos^2(\\beta_{\\mathrm{rad}}) - k_v \\sin(\\beta_{\\mathrm{rad}})\\cos(\\beta_{\\mathrm{rad}})\\right]\n    $$\n    为提高计算效率，此表达式可以因式分解为：\n    $$\n    \\tau(\\beta, k_h, k_v) = \\gamma z \\cos(\\beta_{\\mathrm{rad}}) \\left[(1-k_v)\\sin(\\beta_{\\mathrm{rad}}) + k_h\\cos(\\beta_{\\mathrm{rad}})\\right]\n    $$\n    贡献于摩擦阻力的总法向应力由下式给出：\n    $$\n    \\sigma_n(\\beta, k_h, k_v) = \\gamma z \\left[\\cos^2(\\beta_{\\mathrm{rad}}) + k_h \\sin(\\beta_{\\mathrm{rad}})\\cos(\\beta_{\\mathrm{rad}}) - k_v \\cos^2(\\beta_{\\mathrm{rad}})\\right]\n    $$\n    同样，这可以因式分解为：\n    $$\n    \\sigma_n(\\beta, k_h, k_v) = \\gamma z \\cos(\\beta_{\\mathrm{rad}}) \\left[(1-k_v)\\cos(\\beta_{\\mathrm{rad}}) + k_h\\sin(\\beta_{\\mathrm{rad}})\\right]\n    $$\n    正的 $k_v$ 对应向上的惯性力，这会减小法向应力和剪应力的重力分量。负的 $k_v$（向下的惯性力）则会增加它们。\n\n3.  **强度折减系数计算**：在确定 $\\tau$ 和 $\\sigma_n$ 后，将这些值与未折减的强度参数 $c$ 和 $\\tan(\\phi_{\\mathrm{rad}})$ 一起代入主公式，计算临界强度折减系数 $F_{s, \\mathrm{crit}}$。分子 $c + \\sigma_n \\tan(\\phi)$ 代表了平面上的总可用剪切强度，而分母 $\\tau$ 代表总驱动剪应力。它们的比值定义了安全系数，在此公式中，该安全系数在破坏时等同于 $F_{s, \\mathrm{crit}}$。\n\n实现将处理一系列测试用例，对每组给定的参数应用这些步骤。最终结果按规定格式化。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the critical Strength Reduction Factor (SRF) for an infinite slope\n    under pseudo-static seismic loading for a set of test cases.\n    \"\"\"\n\n    # Test Suite: (gamma, z, beta_deg, c, phi_deg, k_h, k_v)\n    # gamma: unit weight (kN/m^3)\n    # z: depth (m)\n    # beta_deg: slope angle (degrees)\n    # c: cohesion (kPa)\n    # phi_deg: friction angle (degrees)\n    # k_h: horizontal pseudo-static coefficient\n    # k_v: vertical pseudo-static coefficient\n    test_cases = [\n        (18.0, 10.0, 30.0, 5.0, 35.0, 0.0, 0.0),\n        (18.0, 10.0, 30.0, 5.0, 35.0, 0.2, 0.0),\n        (18.0, 10.0, 30.0, 5.0, 35.0, 0.3, 0.1),\n        (18.0, 10.0, 30.0, 5.0, 35.0, 0.25, -0.2),\n        (20.0, 8.0, 40.0, 0.0, 28.0, 0.15, 0.0),\n        (18.0, 5.0, 10.0, 3.0, 30.0, 0.4, 0.3)\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        gamma, z, beta_deg, c, phi_deg, k_h, k_v = case\n\n        # Convert angles from degrees to radians\n        beta_rad = np.deg2rad(beta_deg)\n        phi_rad = np.deg2rad(phi_deg)\n\n        # Pre-calculate trigonometric values for efficiency\n        sin_beta = np.sin(beta_rad)\n        cos_beta = np.cos(beta_rad)\n        cos2_beta = cos_beta**2\n        sin_beta_cos_beta = sin_beta * cos_beta\n        tan_phi = np.tan(phi_rad)\n        \n        # Calculate gamma * z\n        gamma_z = gamma * z\n\n        # Calculate total tangential shear stress (tau)\n        tau = gamma_z * (sin_beta_cos_beta + k_h * cos2_beta - k_v * sin_beta_cos_beta)\n\n        # Calculate total normal stress (sigma_n)\n        sigma_n = gamma_z * (cos2_beta + k_h * sin_beta_cos_beta - k_v * cos2_beta)\n        \n        # Guard against non-physical conditions where shear stress is non-positive\n        # or normal stress becomes tensile (negative), although test cases are valid.\n        if tau = 0:\n            # Physically, this implies infinite stability for downslope failure.\n            # Fs_crit would be infinite or undefined.\n            # This case is not expected based on the problem's test suite.\n            Fs_crit = float('inf') \n        elif sigma_n  0:\n            # If normal stress is tensile, the Mohr-Coulomb model is often\n            # considered invalid as it doesn't account for tension cracks.\n            # Assuming frictional resistance is zero if sigma_n is negative.\n            Fs_crit = c / tau\n        else:\n            # Calculate the critical Strength Reduction Factor (Fs_crit)\n            # Fs_crit = (Resisting Forces / Driving Forces)\n            resisting_strength = c + sigma_n * tan_phi\n            Fs_crit = resisting_strength / tau\n        \n        results.append(Fs_crit)\n\n    # Format output as a comma-separated list of strings, each rounded to 6 decimal places.\n    formatted_results = [f\"{res:.6f}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "3560705"}]}