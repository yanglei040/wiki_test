{"hands_on_practices": [{"introduction": "在着手解决复杂的动态问题之前，理解孔隙水压力如何耗散的基本物理原理至关重要。本练习 [@problem_id:3521440] 将引导您从达西定律和质量守恒定律等第一性原理出发，推导出一维孔压扩散方程。通过识别水力扩散系数并计算无量纲排水数 $N_d$，您将学会判断土体在动态荷载下的响应是更接近排水还是不排水状态，这是任何有效应力分析中的关键第一步。", "problem": "一个水平延伸的、完全饱和的砂土层，厚度为 $H=5\\,\\text{m}$，覆盖在一个刚性基底上。该土层受到周期为 $T=0.5\\,\\text{s}$ 的竖向均匀循环剪切荷载作用，其变形在竖直方向上是一维的，并且代表大侧向范围内的平面应变条件。土-流体系统遵循线性孔隙弹性理论。砂的固有渗透率为 $k=5\\times 10^{-12}\\,\\text{m}^{2}$，孔隙流体的动力粘度为 $\\mu=1\\times 10^{-3}\\,\\text{Pa}\\cdot\\text{s}$，表征耦合介质储存能力的 Biot 模量（通常表示为 $M$）为 $M=0.8\\,\\text{GPa}$。假设应变和孔隙水压力梯度均为小量。\n\n从基于有效应力的土动力学分析的基本关系出发，即流体流动的达西定律和流固混合物的质量守恒，再结合通过 Biot 模量将孔隙水压力与体积流体含量联系起来的线性压缩关系，推导孔隙水压力 $p$ 的控制扩散方程，并从中确定作为材料参数的水力扩散系数 $c$。然后，通过对推导出的扩散方程进行量纲分析，将无量纲排水数 $N_{d}$ 定义为一个加载周期内的特征扩散长度与土层厚度之比的平方。根据给定的性质和 $T=0.5\\,\\text{s}$，计算 $c$ 和 $N_{d}$ 的值，并简要判断一个周期内的动力响应更接近排水还是不排水状态。\n\n将 $c$ 和 $N_{d}$ 四舍五入到三位有效数字。将 $c$ 以 $\\text{m}^{2}/\\text{s}$ 为单位表示。将 $N_{d}$ 报告为无量纲数。最终的方框答案中不包含单位。", "solution": "首先对问题进行验证，基于已建立的线性孔隙弹性理论，判定该问题具有科学依据、提法明确且客观。所有必需数据均已提供，且参数在物理上是现实的。因此，我们可以开始求解。\n\n孔隙水压力 $p$ 的控制扩散方程的推导始于三个基本关系：孔隙流体的质量守恒、流体流动的达西定律以及流固混合物的储存关系。\n\n1.  **质量守恒**：对于一维竖向流动，流体质量守恒要求体积流体含量 $\\zeta$ 的变化率与比流量 $q_z$ 的空间梯度相平衡。\n    $$\n    \\frac{\\partial \\zeta}{\\partial t} = -\\frac{\\partial q_z}{\\partial z}\n    $$\n    此处，$t$ 是时间，$z$ 是竖向坐标。\n\n2.  **达西定律**：比流量 $q_z$ 与超孔隙水压力 $p$ 的梯度呈线性关系。该关系由达西定律给出：\n    $$\n    q_z = -\\frac{k}{\\mu} \\frac{\\partial p}{\\partial z}\n    $$\n    其中 $k$ 是砂的固有渗透率，$\\mu$ 是孔隙流体的动力粘度。\n\n3.  **压缩关系（储存定律）**：题目指定了一个通过 Biot 模量 $M$ 将孔隙水压力 $p$ 与体积流体含量 $\\zeta$ 联系起来的线性压缩关系。$\\zeta$ 的变化率与 $p$ 的变化率成正比：\n    $$\n    \\frac{\\partial \\zeta}{\\partial t} = \\frac{1}{M} \\frac{\\partial p}{\\partial t}\n    $$\n    该方程描述了由于流体和固体骨架的可压缩性，多孔介质中流体的储存。\n\n为了推导扩散方程，我们将这三个原理结合起来。首先，将储存定律代入质量守恒方程：\n$$\n\\frac{1}{M} \\frac{\\partial p}{\\partial t} = -\\frac{\\partial q_z}{\\partial z}\n$$\n接下来，将达西定律代入所得方程：\n$$\n\\frac{1}{M} \\frac{\\partial p}{\\partial t} = -\\frac{\\partial}{\\partial z} \\left( -\\frac{k}{\\mu} \\frac{\\partial p}{\\partial z} \\right)\n$$\n假设材料性质（$k$、$\\mu$ 和 $M$）在整个土层中是均匀的，因此在空间上是常数，我们可以简化右侧：\n$$\n\\frac{1}{M} \\frac{\\partial p}{\\partial t} = \\frac{k}{\\mu} \\frac{\\partial^2 p}{\\partial z^2}\n$$\n将其整理成扩散方程的标准形式，我们得到：\n$$\n\\frac{\\partial p}{\\partial t} = \\left(\\frac{kM}{\\mu}\\right) \\frac{\\partial^2 p}{\\partial z^2}\n$$\n这就是孔隙水压力 $p$ 的控制扩散方程。\n\n一维扩散方程的一般形式为 $\\frac{\\partial \\phi}{\\partial t} = c \\frac{\\partial^2 \\phi}{\\partial z^2}$。通过将我们推导的方程与此一般形式进行比较，我们可以确定水力扩散系数 $c$ 为：\n$$\nc = \\frac{kM}{\\mu}\n$$\n我们现在使用给定的参数值计算 $c$：$k=5 \\times 10^{-12}\\,\\text{m}^{2}$，$M=0.8\\,\\text{GPa} = 0.8 \\times 10^9\\,\\text{Pa}$，以及 $\\mu=1 \\times 10^{-3}\\,\\text{Pa}\\cdot\\text{s}$。\n$$\nc = \\frac{(5 \\times 10^{-12}\\,\\text{m}^2) \\times (0.8 \\times 10^9\\,\\text{Pa})}{1 \\times 10^{-3}\\,\\text{Pa}\\cdot\\text{s}} = \\frac{4.0 \\times 10^{-3}}{1 \\times 10^{-3}} \\, \\frac{\\text{m}^2}{\\text{s}} = 4.0 \\, \\frac{\\text{m}^2}{\\text{s}}\n$$\n根据题目要求，四舍五入到三位有效数字，我们得到 $c = 4.00\\,\\text{m}^2/\\text{s}$。\n\n接下来，我们定义并计算无量纲排水数 $N_d$。题目指定 $N_d$ 是一个加载周期内的特征扩散长度与土层厚度之比的平方。\n特征时间是加载周期 $T = 0.5\\,\\text{s}$。\n特征扩散长度 $L_d$ 是在时间 $T$ 内发生显著扩散的距离。从扩散方程的量纲分析可知，$L_d$ 与 $\\sqrt{cT}$ 成正比。\n土层厚度为 $H = 5\\,\\text{m}$。\n因此，排水数 $N_d$ 定义为：\n$$\nN_d = \\left( \\frac{L_d}{H} \\right)^2 = \\left( \\frac{\\sqrt{cT}}{H} \\right)^2 = \\frac{cT}{H^2}\n$$\n代入 $c$、$T$ 和 $H$ 的值：\n$$\nN_d = \\frac{(4.00\\,\\text{m}^2/\\text{s}) \\times (0.5\\,\\text{s})}{(5\\,\\text{m})^2} = \\frac{2.00}{25} = 0.08\n$$\n四舍五入到三位有效数字，$N_d = 0.0800$。\n\n最后，我们使用 $N_d$ 来评估排水条件。排水数 $N_d = \\frac{cT}{H^2}$ 比较了加载的时间尺度 $T$ 与孔隙水压力在土层中扩散的时间尺度 $\\tau_{\\text{diff}} = \\frac{H^2}{c}$。较小的 $N_d$ 值（$N_d \\ll 1$）表示加载速度相对于流体排出所需的时间很快，导致“不排水”响应，其中孔隙水压力会累积。较大的 $N_d$ 值（$N_d \\gg 1$）表示加载速度很慢，足以让孔隙水压力消散，导致“排水”响应。\n我们计算出的值为 $N_d = 0.0800$。由于该值远小于 1，因此土层在一个周期内的动力响应更接近不排水状态而非排水状态。在单个加载周期的持续时间内，孔隙流体没有足够的时间流动并消散所产生的压力。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n4.00  0.0800\n\\end{pmatrix}\n}\n$$", "id": "3521440"}, {"introduction": "建立了控制方程后，下一步是通过数值方法对其进行时域求解。本练习 [@problem_id:3521406] 聚焦于为可代表单个土单元的单自由度（SDOF）系统实现功能强大的广义-$\\alpha$ 时间积分格式。通过编写积分器代码并验证其能量耗散特性，您将亲身体验构成现代计算岩土力学软件核心的算法。", "problem": "考虑一个单自由度（SDOF）振子，它代表了饱和土单元在动力荷载作用下的有效应力骨架响应。其控制方程是牛顿第二定律的有效应力形式，\n$$\nm\\,\\ddot{x}(t) + c\\,\\dot{x}(t) + k\\,x(t) = F_{\\mathrm{eff}}(t),\n$$\n其中 $m$ 是质量，$c$ 是粘性阻尼，$k$ 是土骨架的弹性刚度，$x(t)$ 是位移，而 $F_{\\mathrm{eff}}(t)$ 是根据有效应力原理，由总应力减去孔隙水压力贡献得到的有效外部驱动力。对于与 Terzaghi 有效应力原理一致的一维表示，该驱动力可概念化为\n$$\nF_{\\mathrm{eff}}(t) = F_{\\mathrm{tot}}(t)\\,\\left(1 - r_u(t)\\right),\n$$\n其中 $F_{\\mathrm{tot}}(t)$ 是一个物理上合理的瞬态荷载，$r_u(t)$ 是孔压比，在加载期间从 $0$ 线性增加到预设的最大值。\n\n您需要使用广义α方法在时间上进行离散，并通过预设的无穷远处谱半径来选择参数，以保证二阶精度和受控的高频算法耗散。广义α方法引入了两个参数 $\\alpha_m$ 和 $\\alpha_f$，并使用在 $t_{n+\\alpha_m}$ 处的加权运动学来重新定义在加权时间层 $t_{n+\\alpha_f}$ 处的平衡。离散运动学更新关系属于 Newmark 族，其参数为 $\\gamma$ 和 $\\beta$，\n$$\nx_{n+1} = x_n + \\Delta t\\,v_n + \\Delta t^2\\left(\\tfrac{1}{2} - \\beta\\right)a_n + \\beta\\,\\Delta t^2\\,a_{n+1},\n$$\n$$\nv_{n+1} = v_n + \\Delta t\\left(1 - \\gamma\\right)a_n + \\gamma\\,\\Delta t\\,a_{n+1},\n$$\n并且平衡在广义时间层上被强制满足，\n$$\nm\\,a_{n+\\alpha_m} + c\\,v_{n+\\alpha_f} + k\\,x_{n+\\alpha_f} = F_{n+\\alpha_f},\n$$\n其中\n$$\na_{n+\\alpha_m} = \\left(1 - \\alpha_m\\right)a_{n+1} + \\alpha_m\\,a_n,\\quad\nv_{n+\\alpha_f} = \\left(1 - \\alpha_f\\right)v_{n+1} + \\alpha_f\\,v_n,\\quad\nx_{n+\\alpha_f} = \\left(1 - \\alpha_f\\right)x_{n+1} + \\alpha_f\\,x_n,\n$$\n以及 $F_{n+\\alpha_f} = \\left(1 - \\alpha_f\\right)F_{n+1} + \\alpha_f\\,F_n$。这些参数必须根据无穷远处的谱半径 $\\rho_\\infty$ 计算，以实现二阶精度和无条件稳定性：\n$$\n\\alpha_m = \\frac{2 - \\rho_\\infty}{1 + \\rho_\\infty},\\quad\n\\alpha_f = \\frac{1}{1 + \\rho_\\infty},\\quad\n\\gamma = \\tfrac{1}{2} + \\alpha_m - \\alpha_f,\\quad\n\\beta = \\tfrac{1}{4}\\left(1 + \\alpha_m - \\alpha_f\\right)^2.\n$$\n\n在时间步 $n$ 处的离散机械能为\n$$\nE_n = \\tfrac{1}{2} k\\,x_n^2 + \\tfrac{1}{2} m\\,v_n^2,\n$$\n以焦耳 (Joules) 为单位。为验证算法耗散，您必须计算序列 $\\{E_n\\}$，并在瞬态荷载于已知的截止时间 $t_{\\mathrm{off}}$ 停止后，检查机械能是否对 $n$ 呈非递增关系（允许有可忽略的数值容差），即对于所有 $t_n \\ge t_{\\mathrm{off}}$ 的时间步，均有 $E_{n+1} \\le E_n$。\n\n对所有测试使用以下固定的物理参数：$k = 1\\,\\mathrm{MN/m} = 10^6\\,\\mathrm{N/m}$，$m = 1000\\,\\mathrm{kg}$，$c = 1000\\,\\mathrm{N\\cdot s/m}$，$\\Delta t = 0.005\\,\\mathrm{s}$，以及 $\\rho_\\infty = 0.5$。对于初始条件，使用每个测试用例指定的 $x_0$ 和 $v_0$，并计算 $a_0 = \\left(F_{\\mathrm{eff}}(0) - c\\,v_0 - k\\,x_0\\right)/m$。\n\n实现三个测试用例，组成一个测试套件：\n- 测试1（带有效应力折减的一般瞬态加载）：当 $0 \\le t \\le T_p$ 时 $F_{\\mathrm{tot}}(t) = F_0\\sin\\left(\\pi t / T_p\\right)$，其他情况下 $F_{\\mathrm{tot}}(t) = 0$，其中 $F_0 = 100000\\,\\mathrm{N}$，$T_p = 0.5\\,\\mathrm{s}$。当 $0 \\le t \\le T_p$ 时 $r_u(t) = r_{u,\\max}\\left(t/T_p\\right)$，线性增加到 $r_{u,\\max} = 0.4$，当 $t > T_p$ 时 $r_u(t) = r_{u,\\max}$。使用 $x_0 = 0\\,\\mathrm{m}$ 和 $v_0 = 0\\,\\mathrm{m/s}$。模拟至 $T_{\\mathrm{total}} = 3.0\\,\\mathrm{s}$。截止时间为 $t_{\\mathrm{off}} = T_p$。\n- 测试2（自由振动边界情况）：对所有 $t$，$F_{\\mathrm{tot}}(t) = 0$，$r_u(t) = 0$，$x_0 = 0.01\\,\\mathrm{m}$，$v_0 = 0\\,\\mathrm{m/s}$，模拟至 $T_{\\mathrm{total}} = 3.0\\,\\mathrm{s}$。截止时间为 $t_{\\mathrm{off}} = 0$。\n- 测试3（短时高频瞬态）：当 $0 \\le t \\le T_p$ 时 $F_{\\mathrm{tot}}(t) = F_0\\sin\\left(\\pi t / T_p\\right)$，其他情况下 $F_{\\mathrm{tot}}(t) = 0$，其中 $F_0 = 100000\\,\\mathrm{N}$，$T_p = 0.05\\,\\mathrm{s}$，$r_u(t) = 0$，$x_0 = 0\\,\\mathrm{m}$，$v_0 = 0\\,\\mathrm{m/s}$，模拟至 $T_{\\mathrm{total}} = 1.0\\,\\mathrm{s}$。截止时间为 $t_{\\mathrm{off}} = T_p$。\n\n对于每个测试，计算离散能量序列 $\\{E_n\\}$，并返回一个布尔值，该值指示在使用一个物理上合理的小数值容差标准时，对于所有 $t_n \\ge t_{\\mathrm{off}}$ 的时间步，能量是否为非递增。内部能量以焦耳表示；每个测试的返回结果是一个布尔值。您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，格式为 $[b_1,b_2,b_3]$，其中每个 $b_i$ 为 $\\mathrm{True}$ 或 $\\mathrm{False}$，并且输出行中不允许有空格。", "solution": "用户提供了一个在计算动力学领域中定义明确的问题，具体聚焦于代表土单元响应的单自由度（SDOF）系统的时间积分。该问题要求实现用于时间离散化的广义α方法，并验证该方法的耗散特性。\n\n### 步骤1：提取已知条件\n- **控制方程**: $m\\,\\ddot{x}(t) + c\\,\\dot{x}(t) + k\\,x(t) = F_{\\mathrm{eff}}(t)$\n- **有效力**: $F_{\\mathrm{eff}}(t) = F_{\\mathrm{tot}}(t)\\,\\left(1 - r_u(t)\\right)$\n- **数值方法**: 广义α方法。\n- **运动学更新（Newmark族）**:\n  - $x_{n+1} = x_n + \\Delta t\\,v_n + \\Delta t^2\\left(\\tfrac{1}{2} - \\beta\\right)a_n + \\beta\\,\\Delta t^2\\,a_{n+1}$\n  - $v_{n+1} = v_n + \\Delta t\\left(1 - \\gamma\\right)a_n + \\gamma\\,\\Delta t\\,a_{n+1}$\n- **离散平衡方程**: $m\\,a_{n+\\alpha_m} + c\\,v_{n+\\alpha_f} + k\\,x_{n+\\alpha_f} = F_{n+\\alpha_f}$\n- **加权状态变量**:\n  - $a_{n+\\alpha_m} = \\left(1 - \\alpha_m\\right)a_{n+1} + \\alpha_m\\,a_n$\n  - $v_{n+\\alpha_f} = \\left(1 - \\alpha_f\\right)v_{n+1} + \\alpha_f\\,v_n$\n  - $x_{n+\\alpha_f} = \\left(1 - \\alpha_f\\right)x_{n+1} + \\alpha_f\\,x_n$\n  - $F_{n+\\alpha_f} = \\left(1 - \\alpha_f\\right)F_{n+1} + \\alpha_f\\,F_n$\n- **广义α参数公式**:\n  - $\\alpha_m = \\frac{2 - \\rho_\\infty}{1 + \\rho_\\infty}$\n  - $\\alpha_f = \\frac{1}{1 + \\rho_\\infty}$\n  - $\\gamma = \\tfrac{1}{2} + \\alpha_m - \\alpha_f$\n  - $\\beta = \\tfrac{1}{4}\\left(1 + \\alpha_m - \\alpha_f\\right)^2$\n- **离散机械能**: $E_n = \\tfrac{1}{2} k\\,x_n^2 + \\tfrac{1}{2} m\\,v_n^2$\n- **验证标准**: 对于 $t_n \\ge t_{\\mathrm{off}}$，验证在小的数值容差范围内是否有 $E_{n+1} \\le E_n$。\n- **固定物理参数**:\n  - $k = 10^6\\,\\mathrm{N/m}$\n  - $m = 1000\\,\\mathrm{kg}$\n  - $c = 1000\\,\\mathrm{N\\cdot s/m}$\n  - $\\Delta t = 0.005\\,\\mathrm{s}$\n  - $\\rho_\\infty = 0.5$\n- **初始加速度**: $a_0 = \\left(F_{\\mathrm{eff}}(0) - c\\,v_0 - k\\,x_0\\right)/m$\n- **测试用例1**:\n  - 当 $t \\in [0, 0.5]$ 时，$F_{\\mathrm{tot}}(t) = 100000\\sin\\left(\\pi t / 0.5\\right)$，其他情况下为 $0$。\n  - 当 $t \\in [0, 0.5]$ 时，$r_u(t) = 0.4(t/0.5)$，其他情况下为 $0.4$。\n  - $x_0 = 0\\,\\mathrm{m}$，$v_0 = 0\\,\\mathrm{m/s}$。\n  - $T_{\\mathrm{total}} = 3.0\\,\\mathrm{s}$，$t_{\\mathrm{off}} = 0.5\\,\\mathrm{s}$。\n- **测试用例2**:\n  - $F_{\\mathrm{tot}}(t) = 0$，$r_u(t) = 0$。\n  - $x_0 = 0.01\\,\\mathrm{m}$，$v_0 = 0\\,\\mathrm{m/s}$。\n  - $T_{\\mathrm{total}} = 3.0\\,\\mathrm{s}$，$t_{\\mathrm{off}} = 0\\,\\mathrm{s}$。\n- **测试用例3**:\n  - 当 $t \\in [0, 0.05]$ 时，$F_{\\mathrm{tot}}(t) = 100000\\sin\\left(\\pi t / 0.05\\right)$，其他情况下为 $0$。\n  - $r_u(t) = 0$。\n  - $x_0 = 0\\,\\mathrm{m}$，$v_0 = 0\\,\\mathrm{m/s}$。\n  - $T_{\\mathrm{total}} = 1.0\\,\\mathrm{s}$，$t_{\\mathrm{off}} = 0.05\\,\\mathrm{s}$。\n- **输出格式**: 单行，`[b_1,b_2,b_3]`，其中 $b_i \\in \\{\\mathrm{True}, \\mathrm{False}\\}$，无空格。\n\n### 步骤2：使用提取的已知条件进行验证\n该问题具有科学依据，借鉴了牛顿第二定律、土力学中的 Terzaghi 有效应力原理以及广义α方法，后者是计算力学中一种标准且有详细文档记录的数值积分方案。所有参数、初始条件和激励函数都为每个测试用例明确定义，使得问题自洽且适定。语言客观正式。所提供的数据在量纲上一致，并且对于土动力学问题而言在物理上是合理的。该任务是工程数值方法中的一个标准练习，没有违反任何无效标准。\n\n### 步骤3：结论与行动\n该问题是 **有效的**。将制定并实施一个解决方案。\n\n### 基于原理的解决方案设计\n问题的核心是使用广义α方法在离散时间步上求解单自由度运动方程。这是一种隐式方法，意味着在时间 $t_{n+1}$ 的状态依赖于同一时间步的加速度 $a_{n+1}$。这需要在每一步求解一个关于 $a_{n+1}$ 的方程。\n\n1.  **算法参数计算**：首先，根据给定的无穷远处谱半径 $\\rho_\\infty = 0.5$，使用提供的公式计算广义α方法的参数（$\\alpha_m, \\alpha_f$）和相关的 Newmark 参数（$\\beta, \\gamma$）。这些参数控制算法的精度和数值耗散。对于 $\\rho_\\infty < 1.0$ 的情况，该方法会为高频振荡引入人为阻尼，这在许多应用中是保证稳定性的一个理想特性。\n\n2.  **步进求解器的推导**：离散平衡方程在加权时间层 $t_{n+\\alpha_f}$ 上被强制满足：\n    $$m\\,a_{n+\\alpha_m} + c\\,v_{n+\\alpha_f} + k\\,x_{n+\\alpha_f} = F_{n+\\alpha_f}$$\n    未知数是新时间步的加速度 $a_{n+1}$。所有其他量都可以用来自第 $n$ 步的已知值和 $a_{n+1}$ 来表示。我们将加权状态变量的定义和 Newmark 运动学关系代入平衡方程。\n    Newmark 更新可以写成预测-校正格式。首先计算预测值（用帽子符号 $\\hat{\\cdot}$ 表示）：\n    $$ \\hat{x}_{n+1} = x_n + \\Delta t\\,v_n + \\Delta t^2\\left(\\tfrac{1}{2} - \\beta\\right)a_n $$\n    $$ \\hat{v}_{n+1} = v_n + \\Delta t\\left(1 - \\gamma\\right)a_n $$\n    最后的“校正”步骤使用 $a_{n+1}$ 的解来更新这些值：\n    $$ x_{n+1} = \\hat{x}_{n+1} + \\beta\\,\\Delta t^2\\,a_{n+1} $$\n    $$ v_{n+1} = \\hat{v}_{n+1} + \\gamma\\,\\Delta t\\,a_{n+1} $$\n    将这些关系代入展开的平衡方程，得到一个关于 $a_{n+1}$ 的线性代数方程：\n    $$ C_{eff} \\cdot a_{n+1} = R_{eff} $$\n    有效刚度/质量系数 $C_{eff}$ 和有效残余力 $R_{eff}$，是通过将所有包含 $a_{n+1}$ 的项收集到左边，并将所有其他（已知）项收集到右边来推导的。\n    系数 $C_{eff}$ 是：\n    $$ C_{eff} = m(1 - \\alpha_m) + c(1 - \\alpha_f)\\gamma\\Delta t + k(1 - \\alpha_f)\\beta\\Delta t^2 $$\n    右侧项 $R_{eff}$ 是基于预测状态的残差：\n    $$ R_{eff} = F_{n+\\alpha_f} - \\left( m\\alpha_m a_n + c((1-\\alpha_f)\\hat{v}_{n+1} + \\alpha_f v_n) + k((1-\\alpha_f)\\hat{x}_{n+1} + \\alpha_f x_n)\\right) $$\n    其中 $F_{n+\\alpha_f} = (1-\\alpha_f)F_{\\mathrm{eff}}(t_{n+1}) + \\alpha_f F_{\\mathrm{eff}}(t_n)$。\n    在每个时间步 $n$，我们求解 $a_{n+1} = R_{eff}/C_{eff}$，然后更新 $x_{n+1}$ 和 $v_{n+1}$。\n\n3.  **时间模拟循环**：- 初始化状态向量 $x, v, a$ 和能量向量 $E$。初始加速度 $a_0$ 从 $t=0$ 时的平衡方程计算得出。- 对于从 $n=0$ 到最后一步的每个时间步，执行上述求解器计算以找到 $(x_{n+1}, v_{n+1}, a_{n+1})$。- 在每一步，计算机械能 $E_{n+1} = \\tfrac{1}{2} k x_{n+1}^2 + \\tfrac{1}{2} m v_{n+1}^2$ 并将其存储。\n\n4.  **能量耗散验证**：在给定测试用例的模拟完成后，遍历存储的能量序列 $\\{E_n\\}$。对于所有满足 $t_n = n \\cdot \\Delta t \\ge t_{\\mathrm{off}}$ 的时间索引 $n$，检查条件 $E_{n+1} \\le E_n$ 是否成立。为了考虑浮点不精确性，此检查实现为 $E_{n+1} \\le E_n + \\epsilon$，其中 $\\epsilon$ 是一个小的正容差（例如，$10^{-9}\\,\\mathrm{J}$）。如果在指定范围内的任何 $n$ 违反了此条件，则该测试用例的结果为 `False`；否则为 `True`。对所有三个测试用例重复此过程。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite for the SDOF oscillator problem.\n    \"\"\"\n\n    def run_simulation(case):\n        \"\"\"\n        Runs a single simulation for a given test case using the generalized-alpha method.\n        \"\"\"\n        # --- 1. Unpack parameters and initialize ---\n        k = 1.0e6  # Stiffness (N/m)\n        m = 1000.0   # Mass (kg)\n        c = 1000.0   # Damping (N.s/m)\n        dt = 0.005   # Time step (s)\n        rho_infty = 0.5  # Spectral radius at infinity\n\n        x0 = case['x0']\n        v0 = case['v0']\n        T_total = case['T_total']\n        t_off = case['t_off']\n        force_func = case['force_func']\n        \n        # --- 2. Calculate generalized-alpha and Newmark parameters ---\n        alpha_m = (2.0 - rho_infty) / (1.0 + rho_infty)\n        alpha_f = 1.0 / (1.0 + rho_infty)\n        gamma = 0.5 + alpha_m - alpha_f\n        beta = 0.25 * (1.0 + alpha_m - alpha_f)**2\n\n        # --- 3. Set up simulation arrays ---\n        num_steps = int(round(T_total / dt))\n        t = np.linspace(0, T_total, num_steps + 1)\n        \n        x = np.zeros(num_steps + 1)\n        v = np.zeros(num_steps + 1)\n        a = np.zeros(num_steps + 1)\n        E = np.zeros(num_steps + 1)\n\n        x[0], v[0] = x0, v0\n        F_eff_0 = force_func(0.0)\n        a[0] = (F_eff_0 - c * v[0] - k * x[0]) / m\n        E[0] = 0.5 * k * x[0]**2 + 0.5 * m * v[0]**2\n\n        # --- 4. Time integration loop ---\n        # Pre-calculate effective coefficient (constant for linear system)\n        C_eff = m * (1.0 - alpha_m) + c * (1.0 - alpha_f) * gamma * dt + k * (1.0 - alpha_f) * beta * dt**2\n\n        for n in range(num_steps):\n            # Known state at step n\n            x_n, v_n, a_n = x[n], v[n], a[n]\n            t_n, t_n1 = t[n], t[n+1]\n\n            # Forces at n and n+1\n            F_n = force_func(t_n)\n            F_n1 = force_func(t_n1)\n            F_alpha_f = (1.0 - alpha_f) * F_n1 + alpha_f * F_n\n            \n            # Predictor step (for terms not multiplied by a_{n+1})\n            v_hat_n1 = v_n + (1.0 - gamma) * dt * a_n\n            x_hat_n1 = x_n + dt * v_n + (0.5 - beta) * dt**2 * a_n\n\n            # Form effective right-hand side (residual from predictors)\n            R_eff = F_alpha_f - (m * alpha_m * a_n + \n                                 c * ((1.0 - alpha_f) * v_hat_n1 + alpha_f * v_n) +\n                                 k * ((1.0 - alpha_f) * x_hat_n1 + alpha_f * x_n))\n\n            # Solve for acceleration at n+1\n            a_n1 = R_eff / C_eff\n            a[n+1] = a_n1\n\n            # Corrector step\n            v[n+1] = v_hat_n1 + gamma * dt * a_n1\n            x[n+1] = x_hat_n1 + beta * dt**2 * a_n1\n\n            # Calculate and store energy\n            E[n+1] = 0.5 * k * x[n+1]**2 + 0.5 * m * v[n+1]**2\n\n        # --- 5. Verify energy dissipation ---\n        n_off = int(round(t_off / dt))\n        tolerance = 1e-9  # Small tolerance for floating point comparisons\n\n        for i in range(n_off, num_steps):\n            if E[i+1] > E[i] + tolerance:\n                return False\n        \n        return True\n\n    # --- Test Case Definitions ---\n\n    # Case 1: General transient loading\n    F0_1 = 100000.0\n    Tp_1 = 0.5\n    ru_max_1 = 0.4\n    def force_case1(t):\n        if 0 = t = Tp_1:\n            F_tot = F0_1 * np.sin(np.pi * t / Tp_1)\n            r_u = ru_max_1 * (t / Tp_1)\n            return F_tot * (1.0 - r_u)\n        elif t > Tp_1:\n            return 0.0 * (1.0 - ru_max_1) # F_tot is 0\n        return 0.0\n\n    # Case 2: Free vibration\n    def force_case2(t):\n        return 0.0\n\n    # Case 3: Short transient\n    F0_3 = 100000.0\n    Tp_3 = 0.05\n    def force_case3(t):\n        if 0 = t = Tp_3:\n            return F0_3 * np.sin(np.pi * t / Tp_3)\n        return 0.0\n\n    test_cases = [\n        {'x0': 0.0, 'v0': 0.0, 'T_total': 3.0, 't_off': 0.5, 'force_func': force_case1},\n        {'x0': 0.01, 'v0': 0.0, 'T_total': 3.0, 't_off': 0.0, 'force_func': force_case2},\n        {'x0': 0.0, 'v0': 0.0, 'T_total': 1.0, 't_off': 0.05, 'force_func': force_case3},\n    ]\n\n    results = []\n    for case in test_cases:\n        result = run_simulation(case)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3521406"}, {"introduction": "实际工程问题通常涉及空间上分布的系统，需要使用有限元法（FEM）等方法进行分析。本练习将数值求解的范围扩展到一个完全耦合的多自由度系统 [@problem_id:3521435]，您将在此处理一维孔隙介质（$u$-$p$）系统全局雅可比矩阵的组装。通过构建隐式求解器核心的雅可比矩阵，您将巩固对位移场和孔压场如何在有限元框架中耦合的理解，这是进行高级分析和代码开发的一项关键技能。", "problem": "考虑在有效应力框架下、小应变情况下的一个一维线性多孔弹性（Biot）连续体，其位移场为 $u(x,t)$，孔隙压力场为 $p(x,t)$。总应力由 Terzaghi 有效应力关系给出 $ \\sigma(x,t) = \\sigma'(x,t) - \\alpha p(x,t) $，其中 $ \\sigma'(x,t) = E \\, \\varepsilon(x,t) $，应变 $ \\varepsilon(x,t) = \\partial u / \\partial x $，E 为杨氏模量，$\\alpha$ 为 Biot 系数。动量平衡（包括惯性和可选的 Rayleigh 阻尼）和流体质量平衡由以下基本陈述控制：\n\n- 动量平衡：$ \\rho \\, \\ddot{u} + c_d \\, \\dot{u} - \\frac{\\partial}{\\partial x}\\left( E \\, \\frac{\\partial u}{\\partial x} - \\alpha p \\right) = b_u $，其中 $ \\rho $ 是混合物密度，$ c_d $ 是与速度成正比的唯象阻尼，$ b_u $ 是单位体积上给定的彻体力。\n- 考虑可压缩流体和 Darcy 流的流体质量平衡：$ n \\beta_f \\, \\dot{p} + \\alpha \\, \\dot{\\varepsilon} - \\frac{\\partial}{\\partial x}\\left( \\frac{k}{\\mu} \\, \\frac{\\partial p}{\\partial x} \\right) = b_p $，其中 $ n $ 是孔隙度，$ \\beta_f $ 是流体可压缩性，$ k $ 是固有渗透率，$ \\mu $ 是动力粘度，$ b_p $ 是一个体积源项。\n\n您将使用两个线性有限元在空间上对上述方程进行离散化，作用于总长度为 $L$、横截面积为 $A$ 的均匀杆上，从而在位置 $ x_0 = 0 $、$ x_1 = L/2 $ 和 $ x_2 = L $ 处产生三个节点。每个节点都带有位移 $u$ 和压力 $p$ 自由度。在循环加载情景下，在右端（$ x = L $）施加一个面力 $ T(t) = T_0 \\sin(2 \\pi f t) $，其中 $T_0$ 是指定的振幅，$f$ 是指定的频率。对固体使用 Rayleigh 阻尼，其形式为 $ C = a_R M + b_R K $，其中 $M$ 是一致质量矩阵，$K$ 是弹性刚度矩阵，$ a_R $ 和 $ b_R $ 是 Rayleigh 系数。对于混合物密度，使用 $ \\rho = (1-n) \\rho_s + n \\rho_f $，其中 $ \\rho_s $ 和 $ \\rho_f $ 分别是固体颗粒密度和流体密度。\n\n从时间 $ t_n $ 到时间 $ t_{n+1} = t_n + \\Delta t $ 的单个动态步长的时间积分必须使用 Newmark 族方法（参数为 $ \\beta $ 和 $ \\gamma $）对固体位移进行公式化，并对孔隙压力使用后向欧拉更新：\n- Newmark 运动学给出了 $ \\ddot{u}^{n+1} $ 和 $ \\dot{u}^{n+1} $ 与 $ u^{n+1} $ 的关系，用于雅可比矩阵的系数为 $ a_0 = 1 / (\\beta \\Delta t^2) $ 和 $ a_3 = \\gamma / (\\beta \\Delta t) $。\n- 孔隙压力的后向欧拉法给出 $ \\dot{p}^{n+1} = (p^{n+1} - p^n)/\\Delta t $。\n\n施加以下本质边界条件：固定左端的位移 $ u(x_0) = 0 $，并在两端指定排水孔隙压力 $ p(x_0) = 0 $ 和 $ p(x_2) = 0 $。为时间 $ t_{n+1} $ 的未知量组装残差的全局分块雅可比矩阵，未知量排序为 $ [u^{n+1}, p^{n+1}] $，并考虑 $u$–$p$ 耦合。在通过消除受约束的行和列来施加边界条件后，计算一个无量纲化的雅可比矩阵的谱半径（特征值中的最大绝对值），定义如下。设未知量缩放向量为 $ s_x = [L_0, \\dots, L_0, P_0, \\dots, P_0] $，其中 $ L_0 $ 是一个特征长度，$ P_0 $ 是一个特征压力，分别应用于位移和压力未知量。设残差缩放向量为 $ s_r = [E A / L_0, \\dots, E A / L_0, P_0 / \\Delta t, \\dots, P_0 / \\Delta t] $，分别应用于动量和质量残差。无量纲化的雅可比矩阵 $ J_d $ 定义为 $ J_d = S_r^{-1} J S_x $，其中 $ S_x $ 和 $ S_r $ 是包含 $ s_x $ 和 $ s_r $ 条目的对角矩阵。谱半径则为 $ \\rho(J_d) = \\max_i | \\lambda_i(J_d) | $，是一个无量纲量。\n\n实现上述过程的完整、可运行的程序，该程序：\n- 使用一个一维双单元线性有限元网格，具有均匀的属性和形函数 $ N_1 = 1 - \\xi $，$ N_2 = \\xi $（$ \\xi $ 是局部坐标），$ B_u = [ -1/\\ell_e, 1/\\ell_e ] $ 和 $ B_p = [ -1/\\ell_e, 1/\\ell_e ] $，单元长度 $ \\ell_e = L/2 $。一致单元矩阵为：\n  - 固体刚度 $ K_{uu}^e = (E A / \\ell_e) \\begin{bmatrix} 1  -1 \\\\ -1  1 \\end{bmatrix} $，\n  - 固体质量 $ M^e = ( \\rho A \\ell_e / 6 ) \\begin{bmatrix} 2  1 \\\\ 1  2 \\end{bmatrix} $，\n  - 固体 Rayleigh 阻尼 $ C^e = a_R M^e + b_R K_{uu}^e $，\n  - 从压力到动量的耦合 $ K_{up}^e = (\\alpha A / 2) \\begin{bmatrix} 1  1 \\\\ -1  -1 \\end{bmatrix} $，\n  - 从固体速度到质量平衡的耦合 $ C_{pu}^e = (\\alpha A / 2) \\begin{bmatrix} -1  1 \\\\ -1  1 \\end{bmatrix} $，\n  - 流体扩散 $ K_{pp}^e = ((k/\\mu) A / \\ell_e) \\begin{bmatrix} 1  -1 \\\\ -1  1 \\end{bmatrix} $，\n  - 流体储存 $ S_{pp}^e = ( n \\beta_f A \\ell_e / 6 ) \\begin{bmatrix} 2  1 \\\\ 1  2 \\end{bmatrix} $。\n- 组装全局矩阵，通过消除相关行和列来施加本质边界条件，并形成时间离散的雅可比矩阵块：\n  - $ J_{uu} = K_{uu} + a_0 M + a_3 C $，\n  - $ J_{up} = K_{up} $，\n  - $ J_{pu} = a_3 C_{pu} $，\n  - $ J_{pp} = K_{pp} + (1/\\Delta t) S_{pp} $。\n- 根据上述块构造 $ J $，使用 $ S_x $ 和 $ S_r $ 将其无量纲化为 $ J_d $，并计算 $ \\rho(J_d) $。\n\n使用以下测试套件，每个项目以参数元组 $ (L, A, E, \\alpha, n, \\beta_f, k, \\mu, \\rho_s, \\rho_f, a_R, b_R, \\Delta t, \\gamma, \\beta, L_0, P_0, T_0, f) $ 的形式给出。为保证物理设置的完整性，提供了循环载荷参数 $ T_0 $ 和 $ f $；在此公式中，线性系统的雅可比矩阵与 $ T_0 $ 和 $ f $ 无关。\n\n- 测试案例1（一般中等耦合，中等渗透率）：$ (10, 1, 50 \\times 10^6, 0.8, 0.35, 4.5 \\times 10^{-10}, 10^{-9}, 10^{-3}, 2650, 1000, 0.01, 10^{-4}, 0.1, 0.5, 0.25, 10, 100 \\times 10^3, 100 \\times 10^3, 1) $。\n- 测试案例2（近不排水，极低渗透率）：$ (10, 1, 50 \\times 10^6, 0.8, 0.35, 4.5 \\times 10^{-10}, 10^{-12}, 10^{-3}, 2650, 1000, 0.01, 10^{-4}, 0.1, 0.5, 0.25, 10, 100 \\times 10^3, 100 \\times 10^3, 1) $。\n- 测试案例3（高流体可压缩性，无阻尼，小时间步）：$ (10, 1, 80 \\times 10^6, 1.0, 0.35, 10^{-8}, 10^{-10}, 10^{-3}, 2650, 1000, 0, 0, 0.01, 0.5, 0.25, 10, 100 \\times 10^3, 50 \\times 10^3, 2) $。\n- 测试案例4（备选 Newmark 参数，零循环振幅）：$ (10, 1, 30 \\times 10^6, 0.9, 0.4, 4.5 \\times 10^{-10}, 10^{-10}, 10^{-3}, 2650, 1000, 0.005, 5 \\times 10^{-5}, 0.05, 0.6, 0.3025, 10, 100 \\times 10^3, 0, 0.5) $。\n\n您的程序应生成单行输出，其中包含四个测试案例的谱半径，形式为用方括号括起来的逗号分隔列表（例如，$[r_1,r_2,r_3,r_4]$）。由于指定的无量纲化，谱半径是无量纲的；不要在输出中包含任何物理单位。", "solution": "用户在计算岩土力学领域提供了一个问题，具体涉及使用有限元法对多孔弹性介质进行一维动态分析。问题是为几个测试案例计算一个无量纲化系统雅可比矩阵的谱半径。\n\n### 问题验证\n\n**步骤 1：提取已知条件**\n\n- **控制方程**:\n    1.  动量平衡: $ \\rho \\, \\ddot{u} + c_d \\, \\dot{u} - \\frac{\\partial}{\\partial x}\\left( E \\, \\frac{\\partial u}{\\partial x} - \\alpha p \\right) = b_u $\n    2.  流体质量平衡: $ n \\beta_f \\, \\dot{p} + \\alpha \\, \\dot{\\varepsilon} - \\frac{\\partial}{\\partial x}\\left( \\frac{k}{\\mu} \\, \\frac{\\partial p}{\\partial x} \\right) = b_p $\n- **本构关系和运动学关系**:\n    - 应变: $ \\varepsilon(x,t) = \\partial u / \\partial x $\n    - 有效应力: $ \\sigma(x,t) = \\sigma'(x,t) - \\alpha p(x,t) $, 其中 $ \\sigma'(x,t) = E \\, \\varepsilon(x,t) $\n    - 混合物密度: $ \\rho = (1-n) \\rho_s + n \\rho_f $\n- **离散化**:\n    - 空间: 在长度为 $L$ 的杆上使用两个线性有限元。三个节点位于 $x_0=0, x_1=L/2, x_2=L$。\n    - 形函数: $N_1 = 1 - \\xi$, $N_2 = \\xi$。应变-位移矩阵 $B_u = [-1/\\ell_e, 1/\\ell_e]$。\n    - 时间积分: 位移采用 Newmark 法 ($\\beta, \\gamma$)，压力采用后向欧拉法。\n- **边界条件**:\n    - 位移: $u(x_0) = 0$\n    - 孔隙压力: $p(x_0) = 0$, $p(x_2) = 0$\n- **载荷**: 在 $x=L$ 处施加面力 $T(t) = T_0 \\sin(2 \\pi f t)$。\n- **单元矩阵**:\n    - $ K_{uu}^e = (E A / \\ell_e) \\begin{bmatrix} 1  -1 \\\\ -1  1 \\end{bmatrix} $\n    - $ M^e = ( \\rho A \\ell_e / 6 ) \\begin{bmatrix} 2  1 \\\\ 1  2 \\end{bmatrix} $\n    - $ C^e = a_R M^e + b_R K_{uu}^e $\n    - $ K_{up}^e = (\\alpha A / 2) \\begin{bmatrix} 1  1 \\\\ -1  -1 \\end{bmatrix} $\n    - $ C_{pu}^e = (\\alpha A / 2) \\begin{bmatrix} -1  1 \\\\ -1  1 \\end{bmatrix} $\n    - $ K_{pp}^e = ((k/\\mu) A / \\ell_e) \\begin{bmatrix} 1  -1 \\\\ -1  1 \\end{bmatrix} $\n    - $ S_{pp}^e = ( n \\beta_f A \\ell_e / 6 ) \\begin{bmatrix} 2  1 \\\\ 1  2 \\end{bmatrix} $\n- **系统雅可比矩阵块**:\n    - $ J_{uu} = K_{uu} + a_0 M + a_3 C $, 其中 $ a_0 = 1 / (\\beta \\Delta t^2) $, $ a_3 = \\gamma / (\\beta \\Delta t) $\n    - $ J_{up} = K_{up} $\n    - $ J_{pu} = a_3 C_{pu} $\n    - $ J_{pp} = K_{pp} + (1/\\Delta t) S_{pp} $\n- **无量纲化**:\n    - $ J_d = S_r^{-1} J S_x $\n    - 未知量缩放向量: $ s_x = [L_0, \\dots, L_0, P_0, \\dots, P_0] $\n    - 残差缩放向量: $ s_r = [E A / L_0, \\dots, E A / L_0, P_0 / \\Delta t, \\dots, P_0 / \\Delta t] $\n- **目标量**: 谱半径 $ \\rho(J_d) $。\n- **测试案例**: 提供了四组参数。\n\n**步骤 2：使用提取的已知条件进行验证**\n\n1.  **科学依据**: 该问题基于成熟的 Biot 多孔弹性理论。动量和质量平衡的控制方程是耦合流体流动和固体变形的标准表述。使用有限元进行空间离散化以及使用 Newmark/后向欧拉法进行时间积分是计算力学中的标准、稳健的技术。提供的单元矩阵对于线性单元和指定的控制方程是正确的。Rayleigh 阻尼的公式也是标准做法。所有方面在科学上都是合理的。\n\n2.  **适定性**: 任务是根据明确指定的程序计算矩阵的谱半径。给定输入（材料参数、几何形状、边界条件），全局矩阵和最终的雅可比矩阵是唯一确定的。通过消除行/列来应用边界条件是导致唯一简化矩阵的标准程序。随后的无量纲化和谱半径计算是明确定义的数学运算。因此，该问题是适定的。\n\n3.  **客观性**: 问题陈述完全由定量的、客观的定义和指令组成。没有主观语言。\n\n4.  **缺陷分析**:\n    - **不完整性/矛盾**: 每个测试案例都提供了所有必要的数据，包括材料属性、几何参数、离散化选择、边界条件和时间积分参数。仔细检查控制方程中的符号与提供的单元矩阵和雅可比矩阵定义，可以确认它们的内部一致性。具体来说，与从 $\\int B_u^T \\alpha N_p dV$ 的形式推导相比，$K_{up}^e$ 的定义包含一个负号。此选择导致最终的系统方程为 $M\\ddot{U} + K_{uu}U + K_{up}P = F$，这反过来又导致了所述的雅可比矩阵块 $J_{up} = K_{up}$。因此，该问题是自洽的。\n    - **其他缺陷**: 该问题并非微不足道、不切实际、不适定或不科学。它代表了其领域内一个标准但复杂的数值分析任务。\n\n**步骤 3：结论与行动**\n\n该问题是**有效的**。它具有科学依据，内部一致，适定，并为继续解决问题提供了所有必要的信息。\n\n### 解决方案\n\n解决方案涉及实施指定的有限元程序，为每个给定的测试案例计算无量纲化雅可比矩阵的谱半径。整个过程如下：\n\n1.  **参数初始化**: 对于每个测试案例，定义问题陈述中提供的所有物理和数值参数。\n2.  **单元矩阵公式化**: 根据参数，为一个长度为 $\\ell_e = L/2$ 的线性单元计算七个单元级矩阵（$K_{uu}^e$, $M^e$, $C^e$, $K_{up}^e$, $C_{pu}^e$, $K_{pp}^e$, $S_{pp}^e$）。Rayleigh 阻尼矩阵 $C^e$ 由 $M^e$ 和 $K_{uu}^e$ 构成。\n3.  **全局矩阵组装**: 为三节点、双单元网格组装全局系统矩阵。位移场（$K_{uu}$, $M$, $C$）和压力场（$K_{pp}$, $S_{pp}$）的全局矩阵是 $3 \\times 3$ 的。连接两个场的耦合矩阵（$K_{up}$, $C_{pu}$）也是 $3 \\times 3$ 的。通过遍历两个单元并将其贡献加到全局矩阵的适当条目中来执行组装。\n4.  **雅可比矩阵构建**: 使用组装的全局矩阵和时间积分系数（$a_0$, $a_3$）构建时间离散的雅可比矩阵块（$J_{uu}$, $J_{up}$, $J_{pu}$, $J_{pp}$）。然后将这些块排列成完整的 $6 \\times 6$ 系统雅可比矩阵 $J$。自由度排序为 $[u_0, u_1, u_2, p_0, p_1, p_2]$。\n5.  **边界条件施加**: 本质边界条件 $u_0=0$, $p_0=0$ 和 $p_2=0$ 对应于全局系统中的第 0、3 和 5 个自由度。问题指定通过从雅可比矩阵 $J$ 中消除相应的行和列来施加这些约束。这将系统简化为自由自由度：$[u_1, u_2, p_1]$。得到的简化雅可比矩阵 $J_{reduced}$ 是一个 $3 \\times 3$ 矩阵。\n6.  **无量纲化**: 根据公式 $J_d = S_r^{-1} J_{reduced} S_x$ 对简化雅可比矩阵进行无量纲化。对角缩放矩阵 $S_x$ 和 $S_r$ 由缩放向量 $s_x$ 和 $s_r$ 构成，这些向量基于特征长度 $L_0$、特征压力 $P_0$ 和其他系统参数定义。对于简化的 $3 \\times 3$ 系统，缩放向量为 $s_x = [L_0, L_0, P_0]$ 和 $s_r = [E A / L_0, E A / L_0, P_0 / \\Delta t]$。\n7.  **谱半径计算**: 最后，计算得到的 $3 \\times 3$ 无量纲化雅可比矩阵 $J_d$ 的特征值。谱半径 $\\rho(J_d)$ 是这些特征值中的最大绝对值。\n\n对问题陈述中提供的四个测试案例中的每一个都重复此整个过程。最终输出是四个计算出的谱半径的列表。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to solve the poroelasticity problem for all test cases.\n    \"\"\"\n    \n    # (L, A, E, alpha, n, beta_f, k, mu, rho_s, rho_f, a_R, b_R, dt, gamma, beta, L0, P0, T0, f)\n    test_cases = [\n        (10, 1, 50e6, 0.8, 0.35, 4.5e-10, 1e-9, 1e-3, 2650, 1000, 0.01, 1e-4, 0.1, 0.5, 0.25, 10, 100e3, 100e3, 1),\n        (10, 1, 50e6, 0.8, 0.35, 4.5e-10, 1e-12, 1e-3, 2650, 1000, 0.01, 1e-4, 0.1, 0.5, 0.25, 10, 100e3, 100e3, 1),\n        (10, 1, 80e6, 1.0, 0.35, 1e-8, 1e-10, 1e-3, 2650, 1000, 0, 0, 0.01, 0.5, 0.25, 10, 100e3, 50e3, 2),\n        (10, 1, 30e6, 0.9, 0.4, 4.5e-10, 1e-10, 1e-3, 2650, 1000, 0.005, 5e-5, 0.05, 0.6, 0.3025, 10, 100e3, 0, 0.5),\n    ]\n\n    results = []\n    for params in test_cases:\n        result = compute_spectral_radius(params)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\ndef compute_spectral_radius(params):\n    \"\"\"\n    Computes the spectral radius of the nondimensionalized Jacobian for a single test case.\n    \"\"\"\n    # 1. Unpack parameters and define mesh properties\n    L, A, E, alpha, n, beta_f, k, mu, rho_s, rho_f, a_R, b_R, dt, gamma, beta, L0, P0, _, _ = params\n    \n    num_elements = 2\n    num_nodes = 3\n    ell_e = L / num_elements\n\n    # 2. Calculate derived parameters\n    mixture_density = (1 - n) * rho_s + n * rho_f\n    a0 = 1 / (beta * dt**2)\n    a3 = gamma / (beta * dt)\n\n    # 3. Formulate element matrices\n    K_uu_e = (E * A / ell_e) * np.array([[1., -1.], [-1., 1.]])\n    M_e = (mixture_density * A * ell_e / 6.) * np.array([[2., 1.], [1., 2.]])\n    C_e = a_R * M_e + b_R * K_uu_e\n    K_up_e = (alpha * A / 2.) * np.array([[1., 1.], [-1., -1.]])\n    C_pu_e = (alpha * A / 2.) * np.array([[-1., 1.], [-1., 1.]])\n    K_pp_e = ((k / mu) * A / ell_e) * np.array([[1., -1.], [-1., 1.]])\n    S_pp_e = (n * beta_f * A * ell_e / 6.) * np.array([[2., 1.], [1., 2.]])\n    \n    element_matrices = {\n        \"Kuu\": K_uu_e, \"M\": M_e, \"C\": C_e,\n        \"Kup\": K_up_e, \"Cpu\": C_pu_e,\n        \"Kpp\": K_pp_e, \"Spp\": S_pp_e\n    }\n\n    # 4. Assemble global matrices\n    global_matrices = {key: np.zeros((num_nodes, num_nodes)) for key in element_matrices}\n    \n    element_node_map = [[0, 1], [1, 2]]\n    for nodes in element_node_map:\n        idx = np.ix_(nodes, nodes)\n        for key, mat_e in element_matrices.items():\n            global_matrices[key][idx] += mat_e\n\n    # 5. Form global Jacobian blocks\n    J_uu = global_matrices[\"Kuu\"] + a0 * global_matrices[\"M\"] + a3 * global_matrices[\"C\"]\n    J_up = global_matrices[\"Kup\"]\n    J_pu = a3 * global_matrices[\"Cpu\"]\n    J_pp = global_matrices[\"Kpp\"] + (1 / dt) * global_matrices[\"Spp\"]\n\n    # 6. Form full 6x6 Jacobian matrix\n    J = np.block([\n        [J_uu, J_up],\n        [J_pu, J_pp]\n    ])\n\n    # 7. Apply boundary conditions by eliminating rows and columns\n    # DOFs: [u0, u1, u2, p0, p1, p2] -> indices [0, 1, 2, 3, 4, 5]\n    # BCs: u0=0, p0=0, p2=0 -> constrained DOFs at indices 0, 3, 5\n    # Free DOFs: [u1, u2, p1] -> indices [1, 2, 4]\n    free_dofs = [1, 2, 4]\n    J_reduced = J[np.ix_(free_dofs, free_dofs)]\n    \n    # 8. Define scaling matrices for nondimensionalization\n    # Reduced unknown vector: [u1, u2, p1]\n    # Reduced residual vector corresponds to: mom_eq_node1, mom_eq_node2, mass_eq_node1\n    s_x_vec = np.array([L0, L0, P0])\n    s_r_vec = np.array([E * A / L0, E * A / L0, P0 / dt])\n    \n    S_x = np.diag(s_x_vec)\n    S_r_inv = np.diag(1.0 / s_r_vec)\n\n    # 9. Compute the nondimensional Jacobian\n    J_d = S_r_inv @ J_reduced @ S_x\n\n    # 10. Compute and return the spectral radius\n    eigenvalues = np.linalg.eigvals(J_d)\n    spectral_radius = np.max(np.abs(eigenvalues))\n    \n    return spectral_radius\n\nsolve()\n```", "id": "3521435"}]}