{"hands_on_practices": [{"introduction": "在局部软化模型中，模拟的断裂能耗散会出人意料地取决于网格尺寸。本练习通过一个简单的解析推导，清晰地揭示了这一病态的网格依赖性问题 [@problem_id:3542798]。你将证明，对于一个纯局部模型，当网格细化时，断裂所需的能量会伪地趋近于零，这显然是不符合物理规律的。这项实践是理解为何正则化技术在软化材料模拟中不可或缺的基石。", "problem": "一根长度为 $L$、恒定横截面积为 $A$ 的一维等截面杆，为进行有限元法 (FEM) 分析被离散化为 $N$ 个长度为 $h=L/N$ 的等长单元。该杆件承受准静态、位移控制的拉伸荷载，在达到峰值应力后，非弹性变形局限于一个长度为 $h$ 的单元内，而杆的其余部分则弹性卸载。材料表现出线性弹性行为，直至在应变 $\\varepsilon_{u}$ 时达到峰值应力 $\\sigma_{u}$，随后是线性应变软化，直至在失效应变 $\\varepsilon_{f}(x)$ 时应力降为零，该失效应变通常可能依赖于空间坐标 $x$。耗散能定义为\n$$\nW_{d}=\\int_{0}^{L}\\int_{\\varepsilon_{u}}^{\\varepsilon_{f}(x)}\\sigma(\\varepsilon)\\,d\\varepsilon\\,dx,\n$$\n其中 $\\sigma(\\varepsilon)$ 是软化分支上作为应变 $\\varepsilon$ 函数的单轴应力。假设局部化恰好发生在一个单元中，在长度为 $h$ 的局部化单元之外，各处的 $\\varepsilon_{f}(x)=\\varepsilon_{u}$，并且在局部化单元中，软化分支在 $\\varepsilon_{u}$ 和 $\\varepsilon_{f}(x)$ 之间是严格线性的。\n\n从以上定义以及断裂能 $G_{f}$ 的概念（断裂能被理解为产生单位面积裂纹所需的能量，即单位面积上的牵引-分离法则所做的功）出发，并认识到在裂纹带正则化中，有效局部化宽度取为单元尺寸 $h$，推导以下情况的耗散能 $W_{d}$：\n- 对于纯局部应变软化材料，其中 $\\varepsilon_{f}(x)$ 是一个与 $h$ 无关的材料常数，以及\n- 对于裂纹带正则化材料，其中 $\\varepsilon_{f}(x)$ 的选择应使局部化单元中耗散的能量等于 $G_{f}A$。\n\n在两种情况下，使用上述积分定义显式计算 $W_{d}$，并说明正则化如何实现网格客观的能量耗散。为正则化情况提供一个单一的闭式解析表达式作为最终答案。不需要数值，也不需要四舍五入。以焦耳为单位表示最终能量，但最终方框内的表达式应以不带单位的符号形式写出。", "solution": "首先，我们分析耗散能的定义。问题中给出的积分 $W_{d}=\\int_{0}^{L}\\int_{\\varepsilon_{u}}^{\\varepsilon_{f}(x)}\\sigma(\\varepsilon)\\,d\\varepsilon\\,dx$ 的单位是能量每单位面积 ($J/m^2$)。然而，题目后续要求以焦耳为单位的能量，并提到了 $G_f A$。因此，我们假设 $W_d$ 意指总耗散能，其定义应为对体积的积分：\n$$ W_{d} = \\int_{V} \\left( \\int_{\\varepsilon_{u}}^{\\varepsilon_{f}(\\mathbf{x})} \\sigma(\\varepsilon) \\, d\\varepsilon \\right) dV = \\int_{0}^{L} A \\left( \\int_{\\varepsilon_{u}}^{\\varepsilon_{f}(x)} \\sigma(\\varepsilon) \\, d\\varepsilon \\right) dx $$\n基于此澄清，我们开始推导。\n\n比耗散能，即单位体积的耗散能 $w_d$，是软化过程中应力-应变曲线下的面积。给定一个从 $(\\varepsilon_{u}, \\sigma_{u})$ 到 $(\\varepsilon_{f}, 0)$ 的线性软化分支，这个面积是一个三角形的面积：\n$$ w_d = \\int_{\\varepsilon_{u}}^{\\varepsilon_{f}} \\sigma(\\varepsilon) \\, d\\varepsilon = \\frac{1}{2} (\\varepsilon_f - \\varepsilon_u) \\sigma_u $$\n问题陈述指出，非弹性变形（以及因此产生的能量耗散）局限于一个长度为 $h$ 的单元内。在此单元之外，材料弹性卸载，因此没有能量耗散。这个单一局部化单元的体积是 $V_{loc} = A \\cdot h$。\n整个杆的总耗散能 $W_d$ 是比耗散能乘以其发生的体积：\n$$ W_d = w_d \\cdot V_{loc} = \\left[ \\frac{1}{2} \\sigma_u (\\varepsilon_f - \\varepsilon_u) \\right] A h $$\n这个通用表达式构成了分析两种情况的基础。\n\n**情况1：纯局部应变软化材料**\n在纯局部本构模型中，材料属性被认为是固有的，与离散化无关。因此，失效应变 $\\varepsilon_f$ 是一个恒定的材料参数，我们称之为 $\\varepsilon_{f,m}$。将其代入 $W_d$ 的通用表达式中：\n$$ W_{d, \\text{local}} = \\frac{1}{2} \\sigma_u (\\varepsilon_{f,m} - \\varepsilon_u) A h $$\n这个结果表明，总耗散能与单元尺寸 $h$ 成正比。随着有限元网格的细化，$h \\to 0$，因此 $W_{d, \\text{local}} \\to 0$。这意味着在无限精细的网格下，结构断裂将不需要任何能量，这是一个物理上不真实的、被称为病态网格依赖性的结果。\n\n**情况2：裂纹带正则化材料**\n裂纹带模型通过强制局部化带中耗散的总能量等于一个与网格无关的材料属性来对问题进行正则化。问题指定这个能量是 $G_f A$，其中 $G_f$ 是断裂能（单位裂纹面积的能量）。由于能量耗散只发生在局部化单元中，所以整个杆的总耗散能 $W_d$ 必须等于这个值。\n$$ W_{d, \\text{reg}} = G_f A $$\n根据定义，这就是正则化情况下的耗散能。为了达到这个网格客观的结果，材料参数 $\\varepsilon_f$ 不能再是一个常数。相反，它必须根据单元尺寸 $h$ 进行调整。我们通过将 $W_d$ 的通用表达式与目标正则化能量相等来施加这个条件：\n$$ \\left[ \\frac{1}{2} \\sigma_u (\\varepsilon_f - \\varepsilon_u) \\right] A h = G_f A $$\n我们可以解出作为 $h$ 函数的所需失效应变 $\\varepsilon_f$：\n$$ \\frac{1}{2} \\sigma_u (\\varepsilon_f - \\varepsilon_u) h = G_f $$\n$$ \\varepsilon_f - \\varepsilon_u = \\frac{2 G_f}{\\sigma_u h} $$\n$$ \\varepsilon_f(h) = \\varepsilon_u + \\frac{2 G_f}{\\sigma_u h} $$\n这个关系表明，对于正则化模型，材料的软化模量不是恒定的，而是根据单元尺寸 $h$ 进行调整，以确保断裂功保持不变。\n\n**结论**\n两种情况的比较展示了正则化的效果：\n- 对于局部模型，$W_{d, \\text{local}} = \\frac{1}{2} \\sigma_u (\\varepsilon_{f,m} - \\varepsilon_u) A h$。耗散能依赖于网格尺寸 $h$，并且当 $h \\to 0$ 时趋于零。\n- 对于正则化模型，$W_{d, \\text{reg}} = G_f A$。耗散能是一个恒定的材料属性，与网格尺寸 $h$ 无关。\n\n通过使本构关系（特别是软化行为）依赖于单元尺寸，裂纹带模型确保了断裂过程中消耗的总能量是一个网格客观的量，从而解决了在局部模型中观察到的病态依赖性。\n\n所要求的最终答案是正则化情况下总耗散能的单一闭式解析表达式。根据问题中给出的正则化过程的定义，这个能量是 $G_f A$。", "answer": "$$\n\\boxed{G_f A}\n$$", "id": "3542798"}, {"introduction": "本练习进一步揭示了网格依赖性背后一个更深层次的机制：起决定性作用的“局部化长度”并不仅仅是单元的物理尺寸，而是由其数值积分方案（高斯积分）隐式定义的 [@problem_id:3542841]。通过一个编程任务，你将对比线性单元和二次单元在软化问题中的表现。你会发现，即便是对于相同尺寸的单元，由于积分点数量和位置的不同，其预测的能量耗散也会有显著差异，这突显了对非正则化模型进行修正的必要性。", "problem": "考虑一根长度为 $L$、横截面积为 $A$ 的一维 ($1\\text{D}$) 均质杆。该杆使用有限元 (FE) 法进行离散化，并承受单调轴向拉伸加载。该材料表现出线性弹性行为，直至达到峰值应力，随后发生线性应变软化，应力降至零。本问题的目的是形式化、计算并比较纯局部（非正则化）应变软化本构如何通过局部化坍缩到最小可用数值积分区域而引发网格依赖性，并强调线性和二次单元类型之间的差异。\n\n从以下基础出发：\n- 一维虚功原理：内功密度是应力与应变的乘积在体积上的积分。\n- 在母域 $\\xi \\in [-1,1]$ 上使用高斯-勒让德 (GL) 求积进行有限元中的数值积分。对于两节点线性单元，使用单点 GL 求积，积分点为 $\\xi_1 = 0$，权重为 $w_1 = 2$。对于三节点二次单元，使用两点 GL 求积，积分点为 $\\xi_1 = -1/\\sqrt{3}$、$\\xi_2 = +1/\\sqrt{3}$，权重为 $w_1 = 1$、$w_2 = 1$。\n- 从母域到物理坐标的映射是仿射的，其雅可比行列式为 $J = L_e/2$，其中 $L_e$ 是单元的物理长度。与高斯点 $i$ 相关的物理积分权重为 $w_i J$。\n- 所有计算中，横截面积均为 $A = 1\\,\\text{m}^2$。\n\n本构行为由一个线性弹性分支定义，该分支延伸至应变为 $\\varepsilon_0$ 时的峰值应力 $\\sigma_0$，随后是线性软化，直至应变为 $\\varepsilon_f > \\varepsilon_0$ 时应力降为零：\n- 线性弹性：当 $0 \\le \\varepsilon \\le \\varepsilon_0$ 时，$\\sigma(\\varepsilon) = E\\,\\varepsilon$，其中 $\\varepsilon_0 = \\sigma_0/E$。\n- 线性软化：当 $\\varepsilon_0 \\le \\varepsilon \\le \\varepsilon_f$ 时，$\\sigma(\\varepsilon) = \\sigma_0 \\left( 1 - \\dfrac{\\varepsilon - \\varepsilon_0}{\\varepsilon_f - \\varepsilon_0} \\right)$，其中 $\\sigma(\\varepsilon_f) = 0$。\n\n假设以下局部化场景，这与没有任何正则化的局部应变软化一致：随着杆件被加载，椭圆性的丧失导致应变局部化，并坍缩到网格中的单个高斯点。因此，只有一个高斯点对不可逆软化功有贡献，其空间影响等于该点的物理积分权重 $w_\\star J$。因为有限元求积将单元划分为多个积分区域，最小的积分区域决定了局部化长度。对于线性单元，该区域跨越整个单元（$w_1 J = L_e$），而对于二次单元，每个高斯点跨越单元的一半（$w_i J = L_e/2$）。\n\n将体积软化功密度定义为应力-应变曲线软化分支下的面积，\n$$\ng_{\\text{soft}} = \\int_{\\varepsilon_0}^{\\varepsilon_f} \\sigma(\\varepsilon)\\,d\\varepsilon,\n$$\n并将此局部有限元离散化预测的表观单位面积断裂能定义为\n$$\nG_{\\text{app}} = g_{\\text{soft}} \\cdot l_{\\text{loc}},\n$$\n其中 $l_{\\text{loc}}$ 是局部化长度，等于发生软化坍缩的单个高斯点的物理积分权重 $w_\\star J$（对于线性单元，$l_{\\text{loc}} = L_e$，对于二次单元，$l_{\\text{loc}} = L_e/2$）。量 $G_{\\text{app}}$ 必须以 $\\text{N/m}$ 为单位报告。\n\n您的任务是实现一个程序，为每个测试用例计算：\n- 由线性单元组成的网格的表观单位面积断裂能，$G_{\\text{app}}^{\\text{lin}}$。\n- 由二次单元组成的网格的表观单位面积断裂能，$G_{\\text{app}}^{\\text{quad}}$。\n- 比率 $r = G_{\\text{app}}^{\\text{lin}} / G_{\\text{app}}^{\\text{quad}}$。如果 $G_{\\text{app}}^{\\text{lin}}$ 和 $G_{\\text{app}}^{\\text{quad}}$ 均为零（即没有软化，$\\varepsilon_f \\le \\varepsilon_0$），则定义 $r = 1$。\n\n所有输入必须使用国际单位制（SI 单位）：$E$ 的单位是 $\\text{Pa}$，$\\sigma_0$ 的单位是 $\\text{Pa}$，$\\varepsilon_f$ 是无量纲的，$L_e$ 的单位是 $\\text{m}$。所有 $G_{\\text{app}}$ 的输出必须以 $\\text{N/m}$ 为单位。\n\n使用以下参数值测试套件 $(L_e, E, \\sigma_0, \\varepsilon_f)$：\n- 案例 $1$（一般情况）：$L_e = 0.5\\,\\text{m}$，$E = 3.0 \\times 10^{10}\\,\\text{Pa}$，$\\sigma_0 = 3.0 \\times 10^{7}\\,\\text{Pa}$，$\\varepsilon_f = 0.006$。\n- 案例 $2$（一般情况）：$L_e = 0.25\\,\\text{m}$，$E = 2.0 \\times 10^{10}\\,\\text{Pa}$，$\\sigma_0 = 2.0 \\times 10^{7}\\,\\text{Pa}$，$\\varepsilon_f = 0.003$。\n- 案例 $3$（边界情况，无软化）：$L_e = 1.0\\,\\text{m}$，$E = 4.0 \\times 10^{10}\\,\\text{Pa}$，$\\sigma_0 = 4.0 \\times 10^{7}\\,\\text{Pa}$，$\\varepsilon_f = 0.001$。\n- 案例 $4$（极端情况，单元非常小）：$L_e = 0.001\\,\\text{m}$，$E = 2.5 \\times 10^{10}\\,\\text{Pa}$，$\\sigma_0 = 2.5 \\times 10^{7}\\,\\text{Pa}$，$\\varepsilon_f = 0.005$。\n- 案例 $5$（极端情况，单元非常大）：$L_e = 2.0\\,\\text{m}$，$E = 3.5 \\times 10^{10}\\,\\text{Pa}$，$\\sigma_0 = 2.8 \\times 10^{7}\\,\\text{Pa}$，$\\varepsilon_f = 0.007$。\n\n您的程序应生成单行输出，其中包含每个案例的列表 $[G_{\\text{app}}^{\\text{lin}}, G_{\\text{app}}^{\\text{quad}}, r]$，其中能量的单位为 $\\text{N/m}$，比率为无量纲。将所有五个案例聚合到一个外部列表中，并将其精确地打印为用方括号括起来的逗号分隔列表，例如：\n$[[G_{1}^{\\text{lin}}, G_{1}^{\\text{quad}}, r_1], [G_{2}^{\\text{lin}}, G_{2}^{\\text{quad}}, r_2], \\dots, [G_{5}^{\\text{lin}}, G_{5}^{\\text{quad}}, r_5]]$。", "solution": "解决方案需要计算两种不同有限元类型（2 节点线性单元和 3 节点二次单元）的表观单位面积断裂能 $G_{\\text{app}}$。问题的核心在于理解单元的选择及其数值积分方案如何影响应变局部化过程中计算出的能量耗散。\n\n表观单位面积断裂能定义为：\n$$\nG_{\\text{app}} = g_{\\text{soft}} \\cdot l_{\\text{loc}}\n$$\n其中 $g_{\\text{soft}}$ 是体积软化功密度（单位体积的能量），$l_{\\text{loc}}$ 是局部化长度，这是数值离散化的产物。\n\n首先，我们必须确定体积软化功密度 $g_{\\text{soft}}$。这被定义为应力-应变曲线软化部分的面积，从峰值应力时的应变 $\\varepsilon_0$ 到应力恢复为零时的最终应变 $\\varepsilon_f$。\n$$\ng_{\\text{soft}} = \\int_{\\varepsilon_0}^{\\varepsilon_f} \\sigma(\\varepsilon)\\,d\\varepsilon\n$$\n软化行为被给定为应变的线性函数：\n$$\n\\sigma(\\varepsilon) = \\sigma_0 \\left( 1 - \\dfrac{\\varepsilon - \\varepsilon_0}{\\varepsilon_f - \\varepsilon_0} \\right) \\quad \\text{for} \\quad \\varepsilon_0 \\le \\varepsilon \\le \\varepsilon_f\n$$\n这描述了一条从点 $(\\varepsilon_0, \\sigma_0)$ 到点 $(\\varepsilon_f, 0)$ 的直线。因此，$g_{\\text{soft}}$ 的积分是一个底为 $(\\varepsilon_f - \\varepsilon_0)$、高为 $\\sigma_0$ 的直角三角形的面积。\n$$\ng_{\\text{soft}} = \\frac{1}{2} \\cdot (\\text{base}) \\cdot (\\text{height}) = \\frac{1}{2} \\sigma_0 (\\varepsilon_f - \\varepsilon_0)\n$$\n仅当发生软化时（即 $\\varepsilon_f > \\varepsilon_0$），此计算才有效。峰值应力时的应变 $\\varepsilon_0$ 由弹性属性确定：$\\varepsilon_0 = \\sigma_0 / E$。如果 $\\varepsilon_f \\le \\varepsilon_0$，材料在单调加载下不会进入软化阶段，因此没有软化功产生，即 $g_{\\text{soft}} = 0$。$g_{\\text{soft}}$ 的单位是压强（$\\text{Pa}$ 或 $\\text{N/m}^2$）乘以无量纲应变，结果为 $\\text{N/m}^2$ 或 $\\text{J/m}^3$，即单位体积的能量。\n\n接下来，我们讨论局部化长度 $l_{\\text{loc}}$。问题陈述，应变局部化坍缩到单个高斯点。该高斯点的材料行为被积分所覆盖的物理“体积”（在此一维案例中为长度）对总能量耗散有贡献。该局部化长度由高斯点的物理积分权重给出，即其母单元权重 $w_\\star$ 与映射的雅可比行列式 $J$ 的乘积。\n从长度为 $2$（从 $\\xi=-1$ 到 $\\xi=1$）的母单元到长度为 $L_e$ 的物理单元的仿射映射的雅可比行列式为 $J = L_e/2$。\n\n对于一个 2 节点线性单元，使用位于 $\\xi_1 = 0$、权重为 $w_1 = 2$ 的单个高斯-勒让德积分点。\n线性单元的局部化长度为：\n$$\nl_{\\text{loc}}^{\\text{lin}} = w_1 \\cdot J = 2 \\cdot \\frac{L_e}{2} = L_e\n$$\n这意味着局部化带的宽度等于整个单元的长度。\n\n对于一个 3 节点二次单元，使用两个高斯点：$\\xi_1 = -1/\\sqrt{3}$ 和 $\\xi_2 = +1/\\sqrt{3}$，每个点的权重都为 $w_1 = w_2 = 1$。假设局部化坍缩到其中一个点。\n二次单元的局部化长度基于单个高斯点：\n$$\nl_{\\text{loc}}^{\\text{quad}} = w_i \\cdot J = 1 \\cdot \\frac{L_e}{2} = \\frac{L_e}{2}\n$$\n在此，局部化带的宽度是单元长度的一半。\n\n现在我们可以写出两种单元类型的表观断裂能表达式。单位为 $(\\text{N}/\\text{m}^2) \\cdot \\text{m} = \\text{N}/\\text{m}$，符合要求。\n$$\nG_{\\text{app}}^{\\text{lin}} = g_{\\text{soft}} \\cdot l_{\\text{loc}}^{\\text{lin}} = \\frac{1}{2} \\sigma_0 (\\varepsilon_f - \\varepsilon_0) L_e\n$$\n$$\nG_{\\text{app}}^{\\text{quad}} = g_{\\text{soft}} \\cdot l_{\\text{loc}}^{\\text{quad}} = \\frac{1}{2} \\sigma_0 (\\varepsilon_f - \\varepsilon_0) \\frac{L_e}{2}\n$$\n\n最后，我们计算比率 $r = G_{\\text{app}}^{\\text{lin}} / G_{\\text{app}}^{\\text{quad}}$。\n如果发生软化（$\\varepsilon_f > \\varepsilon_0$），则 $g_{\\text{soft}} > 0$。比率为：\n$$\nr = \\frac{g_{\\text{soft}} \\cdot L_e}{g_{\\text{soft}} \\cdot L_e/2} = 2\n$$\n这表明，对于给定的单元尺寸 $L_e$，线性单元预测的断裂能是二次单元的两倍，这是不同积分方案影响数值局部化长度的直接后果。\n如果没有软化（$\\varepsilon_f \\le \\varepsilon_0$），则 $g_{\\text{soft}} = 0$，导致 $G_{\\text{app}}^{\\text{lin}} = 0$ 和 $G_{\\text{app}}^{\\text{quad}} = 0$。问题规定，在这种情况下，比率定义为 $r=1$。\n\n对于每个测试用例 $(L_e, E, \\sigma_0, \\varepsilon_f)$ 的计算步骤如下：\n$1$. 计算峰值应力时的应变：$\\varepsilon_0 = \\sigma_0 / E$。\n$2$. 检查是否 $\\varepsilon_f > \\varepsilon_0$。\n$3$. 如果为真（发生软化）：\n   a. 计算 $g_{\\text{soft}} = 0.5 \\cdot \\sigma_0 \\cdot (\\varepsilon_f - \\varepsilon_0)$。\n   b. 计算 $G_{\\text{app}}^{\\text{lin}} = g_{\\text{soft}} \\cdot L_e$。\n   c. 计算 $G_{\\text{app}}^{\\text{quad}} = g_{\\text{soft}} \\cdot L_e / 2.0$。\n   d. 比率为 $r = 2.0$。\n$4$. 如果为假（没有软化）：\n   a. $G_{\\text{app}}^{\\text{lin}} = 0.0$。\n   b. $G_{\\text{app}}^{\\text{quad}} = 0.0$。\n   c. 比率为 $r = 1.0$。\n$5$. 以列表 $[G_{\\text{app}}^{\\text{lin}}, G_{\\text{app}}^{\\text{quad}}, r]$ 的形式返回结果。\n此过程适用于所有提供的测试用例。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes apparent fracture energy for linear and quadratic elements\n    to demonstrate mesh dependency in strain-softening materials.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (L_e, E, sigma_0, epsilon_f)\n    # L_e: element length (m)\n    # E: Young's modulus (Pa)\n    # sigma_0: peak stress (Pa)\n    # epsilon_f: final strain (dimensionless)\n    test_cases = [\n        (0.5, 3.0e10, 3.0e7, 0.006),    # Case 1\n        (0.25, 2.0e10, 2.0e7, 0.003),   # Case 2\n        (1.0, 4.0e10, 4.0e7, 0.001),    # Case 3\n        (0.001, 2.5e10, 2.5e7, 0.005),  # Case 4\n        (2.0, 3.5e10, 2.8e7, 0.007)     # Case 5\n    ]\n\n    results = []\n    for case in test_cases:\n        L_e, E, sigma_0, epsilon_f = case\n\n        # Calculate the strain at peak stress\n        epsilon_0 = sigma_0 / E\n\n        # Check if softening occurs\n        if epsilon_f > epsilon_0:\n            # Calculate volumetric softening work density (area of softening triangle)\n            g_soft = 0.5 * sigma_0 * (epsilon_f - epsilon_0)\n\n            # Localization length for linear element is L_e\n            l_loc_lin = L_e\n            # Apparent fracture energy for linear element\n            G_app_lin = g_soft * l_loc_lin\n\n            # Localization length for quadratic element is L_e / 2\n            l_loc_quad = L_e / 2.0\n            # Apparent fracture energy for quadratic element\n            G_app_quad = g_soft * l_loc_quad\n            \n            # The ratio of apparent fracture energies\n            r = 2.0\n        else:\n            # No softening branch is activated\n            G_app_lin = 0.0\n            G_app_quad = 0.0\n            # Per problem statement, ratio is 1 if no softening\n            r = 1.0\n        \n        results.append([G_app_lin, G_app_quad, r])\n\n    # Final print statement in the exact required format.\n    # The default str() representation of a list of lists matches the example.\n    print(results)\n\nsolve()\n```", "id": "3542841"}, {"introduction": "在诊断了问题之后，我们转向实际的解决方案。本练习将指导你应用裂纹带模型的思想，校准一个具体的连续介质损伤模型 [@problem_id:3542867]。你将通过一个解析计算，确定模型中的软化参数，以确保在模拟中材料失效所耗散的能量恰好等于其真实的断裂能 $G_f$。这项实践将理论与工程应用联系起来，展示了如何获得具有网格客观性的、物理上可靠的数值结果。", "problem": "考虑一个土工材料的一维拉伸试验，该材料在有限元法 (FEM) 中由一个长度为 $l_{c}$ 的单常应变单元表示。该材料采用各向同性标量损伤公式建模，其单位体积的亥姆霍兹自由能密度为\n$$\\psi(\\varepsilon,d) = \\tfrac{1}{2}\\,(1-d)\\,E\\,\\varepsilon^{2},$$\n其中 $E$ 是杨氏模量，$\\varepsilon$ 是轴向应变，$d \\in [0,1]$ 是标量损伤变量。等效应变取为轴向应变，因此在单轴拉伸下 $\\kappa = \\varepsilon$。当轴向应力首次达到抗拉强度 $f_{t}$ 时，损伤开始发生，这发生在弹性极限应变处\n$$\\varepsilon_{0}=\\frac{f_{t}}{E}。$$\n超过 $\\varepsilon_{0}$ 后，损伤根据单调指数定律演化\n$$d(\\kappa)=1-\\exp\\!\\left(-\\frac{\\kappa-\\kappa_{0}}{\\beta}\\right)\\quad\\text{for}\\quad \\kappa\\ge\\kappa_{0},$$\n当 $\\kappa\\le\\kappa_{0}$ 时 $d(\\kappa)=0$，其中 $\\kappa_{0}=\\varepsilon_{0}$ 且 $\\beta>0$ 是一个待标定的无量纲模型参数。\n\n在单轴拉伸下，柯西应力为 $\\sigma(\\varepsilon)=(1-d)E\\varepsilon$。假设应变局部化在单个单元内，因此单位裂纹面积耗散的能量（断裂能）等于沿软化分支积分的单位体积功，再乘以特征长度 $l_{c}$。施加断裂能匹配条件\n$$G_{f}=l_{c}\\int_{\\varepsilon_{0}}^{\\infty}\\sigma(\\varepsilon)\\,\\mathrm{d}\\varepsilon.$$\n\n给定 $E=1.0\\times 10^{10}\\,\\mathrm{Pa}$，$f_{t}=2.0\\times 10^{6}\\,\\mathrm{Pa}$，$l_{c}=0.10\\,\\mathrm{m}$ 和 $G_{f}=30\\,\\mathrm{N/m}$，确定 $\\beta$ 的标定值，该值需满足上述断裂能条件并保持网格客观的能量耗散。将最终答案表示为一个无量纲数，并四舍五入至三位有效数字。", "solution": "该问题要求通过裂纹带模型思想校准损伤模型中的软化参数 $\\beta$，以确保能量耗散具有网格客观性。断裂能匹配条件如下：\n$$G_{f} = l_{c} \\int_{\\varepsilon_{0}}^{\\infty} \\sigma(\\varepsilon) \\, \\mathrm{d}\\varepsilon$$\n其中 $G_f$ 是断裂能，$l_c$ 是有限元的特征长度，积分代表了软化过程中单位体积耗散的能量。\n\n柯西应力 $\\sigma$ 定义为 $\\sigma(\\varepsilon) = (1-d)E\\varepsilon$。对于软化阶段 ($\\varepsilon \\ge \\varepsilon_{0}$)，损伤演化定律为：\n$$d(\\varepsilon) = 1 - \\exp\\left(-\\frac{\\varepsilon - \\varepsilon_{0}}{\\beta}\\right)$$\n将此损伤表达式代入应力定义，得到软化分支上的应力-应变关系：\n$$\\sigma(\\varepsilon) = \\left(1 - \\left[1 - \\exp\\left(-\\frac{\\varepsilon-\\varepsilon_{0}}{\\beta}\\right)\\right]\\right) E\\varepsilon$$\n$$\\sigma(\\varepsilon) = E \\varepsilon \\exp\\left(-\\frac{\\varepsilon-\\varepsilon_{0}}{\\beta}\\right)$$\n现在我们将 $\\sigma(\\varepsilon)$ 的表达式代入断裂能积分中：\n$$G_{f} = l_{c} \\int_{\\varepsilon_{0}}^{\\infty} E \\varepsilon \\exp\\left(-\\frac{\\varepsilon-\\varepsilon_{0}}{\\beta}\\right) \\mathrm{d}\\varepsilon$$\n为了求解该积分，我们可以提出常数项并进行变量替换：\n$$G_{f} = l_{c} E \\exp\\left(\\frac{\\varepsilon_{0}}{\\beta}\\right) \\int_{\\varepsilon_{0}}^{\\infty} \\varepsilon \\exp\\left(-\\frac{\\varepsilon}{\\beta}\\right) \\mathrm{d}\\varepsilon$$\n使用分部积分法求解该积分，$\\int u\\,\\mathrm{d}v = uv - \\int v\\,\\mathrm{d}u$。令：\n$u = \\varepsilon \\implies \\mathrm{d}u = \\mathrm{d}\\varepsilon$\n$\\mathrm{d}v = \\exp\\left(-\\frac{\\varepsilon}{\\beta}\\right) \\mathrm{d}\\varepsilon \\implies v = -\\beta \\exp\\left(-\\frac{\\varepsilon}{\\beta}\\right)$\n\n定积分的结果为：\n$$\\int_{\\varepsilon_{0}}^{\\infty} \\varepsilon \\exp\\left(-\\frac{\\varepsilon}{\\beta}\\right) \\mathrm{d}\\varepsilon = \\left[-\\beta\\varepsilon\\exp\\left(-\\frac{\\varepsilon}{\\beta}\\right) - \\beta^{2}\\exp\\left(-\\frac{\\varepsilon}{\\beta}\\right)\\right]_{\\varepsilon_{0}}^{\\infty}$$\n当 $\\varepsilon \\to \\infty$ 时，表达式趋于 $0$。在下限 $\\varepsilon = \\varepsilon_{0}$ 处计算后，积分的值为：\n$$(\\beta\\varepsilon_{0} + \\beta^{2})\\exp\\left(-\\frac{\\varepsilon_{0}}{\\beta}\\right)$$\n将此结果代回 $G_f$ 的方程中：\n$$G_{f} = l_{c} E \\exp\\left(\\frac{\\varepsilon_{0}}{\\beta}\\right) \\left[ (\\beta\\varepsilon_{0} + \\beta^{2})\\exp\\left(-\\frac{\\varepsilon_{0}}{\\beta}\\right) \\right]$$\n指数项相互抵消，得到一个简单的代数关系：\n$$G_{f} = l_{c} E (\\beta\\varepsilon_{0} + \\beta^{2})$$\n问题给定 $\\varepsilon_{0} = f_{t}/E$。将此代入方程中：\n$$G_{f} = l_{c} E \\left(\\beta\\frac{f_{t}}{E} + \\beta^{2}\\right) = l_{c} f_{t} \\beta + l_{c} E \\beta^{2}$$\n这是一个关于 $\\beta$ 的二次方程：\n$$(l_{c} E) \\beta^{2} + (l_{c} f_{t}) \\beta - G_{f} = 0$$\n我们使用二次公式求解 $\\beta$。由于模型要求 $\\beta > 0$，我们必须取正根：\n$$\\beta = \\frac{-l_{c} f_{t} + \\sqrt{(l_{c} f_{t})^{2} + 4 l_{c} E G_{f}}}{2 l_{c} E}$$\n现在，我们代入给定的数值：\n$E = 1.0 \\times 10^{10}\\,\\mathrm{Pa}$\n$f_{t} = 2.0 \\times 10^{6}\\,\\mathrm{Pa}$\n$l_{c} = 0.10\\,\\mathrm{m}$\n$G_{f} = 30\\,\\mathrm{N/m}$\n\n计算各项：\n$a = l_{c} E = (0.10)(1.0 \\times 10^{10}) = 1.0 \\times 10^{9}$\n$b = l_{c} f_{t} = (0.10)(2.0 \\times 10^{6}) = 2.0 \\times 10^{5}$\n$c = -G_{f} = -30$\n\n将这些值代入 $\\beta$ 的表达式中：\n$$\\beta = \\frac{-2.0 \\times 10^{5} + \\sqrt{(2.0 \\times 10^{5})^{2} + 4 (1.0 \\times 10^{9}) (30)}}{2 (1.0 \\times 10^{9})}$$\n$$\\beta = \\frac{-2.0 \\times 10^{5} + \\sqrt{4.0 \\times 10^{10} + 1.2 \\times 10^{11}}}{2.0 \\times 10^{9}}$$\n$$\\beta = \\frac{-2.0 \\times 10^{5} + \\sqrt{1.6 \\times 10^{11}}}{2.0 \\times 10^{9}}$$\n$$\\beta = \\frac{-2.0 \\times 10^{5} + \\sqrt{16 \\times 10^{10}}}{2.0 \\times 10^{9}}$$\n$$\\beta = \\frac{-2.0 \\times 10^{5} + 4.0 \\times 10^{5}}{2.0 \\times 10^{9}}$$\n$$\\beta = \\frac{2.0 \\times 10^{5}}{2.0 \\times 10^{9}} = 1.0 \\times 10^{-4}$$\n问题要求答案四舍五入至三位有效数字。因此，值为 $1.00 \\times 10^{-4}$。", "answer": "$$\\boxed{1.00 \\times 10^{-4}}$$", "id": "3542867"}]}