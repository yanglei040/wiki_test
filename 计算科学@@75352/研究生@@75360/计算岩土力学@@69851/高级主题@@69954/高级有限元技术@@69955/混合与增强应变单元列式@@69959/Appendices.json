{"hands_on_practices": [{"introduction": "为了克服标准位移有限元在模拟近不可压缩材料（如饱和粘土或岩石）时遇到的体积锁定问题，混合和增强应变单元应运而生。此练习通过一个经典的解析计算，来量化锁定现象。通过对一个本应无体积变化的特定变形模式进行分析，您将直接计算并对比标准位移法产生的伪影能量和改进的增强假定应变（EAS）法的结果，从而深刻理解体积锁定的本质及其对数值解的危害。[@problem_id:3543469]", "problem": "考虑一个二维双线性四边形有限元，在平面应变假设下，该单元占据方形区域 $\\{(x,y)\\,|\\,0 \\le x \\le L,\\,0 \\le y \\le L\\}$。材料是各向同性、线性弹性和近乎不可压缩的，由拉梅参数 $\\lambda$ 和 $\\mu$ 以及小应变运动学表征。施加了一个与单元的双线性插值一致的位移场：\n$$u_{x}(x,y) = \\gamma x y,\\qquad u_{y}(x,y) = -\\gamma x y,$$\n其中 $\\gamma$ 是一个常数振幅。该运动学模式具有空间变化的体积应变，其在单元上的积分为零。在这种情况下，纯粹基于位移的格式已知会表现出体积锁定，而混合或增强应变格式则能缓解此问题。\n\n从小时变运动学和线性弹性本构律的基本定义出发，并使用由这些原理推导出的应变能密度定义 $W$，计算以下两种情况的单元级体积内能差 $\\Delta E_{\\mathrm{vol}}$：\n- 标准的基于位移的格式（该格式惩罚逐点的体积应变），以及\n- 通过增强假设应变（EAS）或$\\bar{B}$方法获得的体积缓解（该方法在形成$W$的体积贡献之前，用单元范围内的平均体积应变替换体积应变）。\n\n假设缓解措施仅修改 $W$ 的体积部分，而保持其偏量部分不变。将 $\\Delta E_{\\mathrm{vol}}$ 表示为包含 $\\lambda$、$\\gamma$ 和 $L$ 的单个闭式解析表达式。最终答案中不包含单位。无需进行数值计算或四舍五入。", "solution": "用户希望计算在特定情况下，标准位移格式与混合格式（$\\bar{B}$或EAS）之间的体积内能差 $\\Delta E_{vol}$。\n\n### 第1步：提取已知条件\n- **单元几何**：一个二维双线性四边形有限元，占据方形区域 $\\{(x,y)\\,|\\,0 \\le x \\le L,\\,0 \\le y \\le L\\}$。\n- **物理假设**：平面应变。\n- **材料属性**：各向同性、线性弹性、近乎不可压缩，由拉梅参数 $\\lambda$ 和 $\\mu$ 表征。\n- **运动学**：小应变。\n- **位移场**：$u_{x}(x,y) = \\gamma x y$，$u_{y}(x,y) = -\\gamma x y$，其中 $\\gamma$ 是一个常数。\n- **格式定义**：\n    - **标准位移格式**：惩罚逐点的体积应变。\n    - **缓解格式（EAS/$\\bar{B}$）**：用其单元范围内的平均值替换体积应变。此修改仅适用于应变能密度 $W$ 的体积部分。\n- **待计算量**：两种格式之间的单元级体积内能差 $\\Delta E_{\\mathrm{vol}}$，用 $\\lambda$、$\\gamma$ 和 $L$ 表示。\n\n### 第2步：使用提取的已知条件进行验证\n- **科学依据**：该问题在固体力学和有限元方法理论中有坚实的基础。它解决了近乎不可压缩材料中众所周知的体积锁定现象以及如$\\bar{B}$方法或增强假设应变（EAS）方法等标准缓解技术。所有概念（平面应变、拉梅参数、应变能、双线性单元）在该领域都是标准的。\n- **适定性**：问题是适定的。几何形状、材料行为和运动学场都有明确定义。待计算的量有清晰的说明，并且可以根据给定信息确定唯一解。\n- **客观性**：问题陈述使用精确、客观、正式的语言编写，没有任何主观性或歧义。\n\n### 第3步：结论与行动\n该问题有效。它是计算力学中一个标准的、可解的问题。我将继续进行求解。\n\n***\n\n求解过程首先根据给定的位移场推导应变场。然后，分别计算标准格式和缓解格式的体积应变能。这两种能量之差即为最终答案。\n\n**1. 应变场计算**\n\n小应变张量分量 $\\epsilon_{ij}$ 从给定的位移场 $\\mathbf{u} = (u_x, u_y)$ 导出。对于二维问题，相关分量为：\n$$ \\epsilon_{xx} = \\frac{\\partial u_x}{\\partial x} $$\n$$ \\epsilon_{yy} = \\frac{\\partial u_y}{\\partial y} $$\n$$ \\gamma_{xy} = 2\\epsilon_{xy} = \\frac{\\partial u_x}{\\partial y} + \\frac{\\partial u_y}{\\partial x} $$\n\n代入给定的位移场 $u_{x}(x,y) = \\gamma x y$ 和 $u_{y}(x,y) = -\\gamma x y$：\n$$ \\epsilon_{xx}(x,y) = \\frac{\\partial}{\\partial x}(\\gamma x y) = \\gamma y $$\n$$ \\epsilon_{yy}(x,y) = \\frac{\\partial}{\\partial y}(-\\gamma x y) = -\\gamma x $$\n$$ \\gamma_{xy}(x,y) = \\frac{\\partial}{\\partial y}(\\gamma x y) + \\frac{\\partial}{\\partial x}(-\\gamma x y) = \\gamma x - \\gamma y = \\gamma(x - y) $$\n\n体积应变（或体胀）$\\epsilon_v$ 是应变张量的迹。对于二维平面应变情况，其定义为：\n$$ \\epsilon_v(x,y) = \\epsilon_{xx}(x,y) + \\epsilon_{yy}(x,y) = \\gamma y - \\gamma x = \\gamma(y-x) $$\n这表明体积应变在单元内呈线性变化。\n\n**2. 标准格式下的体积应变能**\n\n对于各向同性的线性弹性材料，应变能密度 $W$ 可以分解为体积部分和偏量部分。在标准格式中，对于近乎不可压缩的材料，体积部分会受到惩罚，其表达式为：\n$$ W_{\\mathrm{vol}} = \\frac{1}{2} \\lambda \\epsilon_v^2 $$\n其中 $\\lambda$ 是拉梅第一参数，对于近乎不可压缩的材料，该值变得非常大，从而惩罚非零的体积应变。\n\n标准格式的总体积内能 $E_{\\mathrm{vol}}^{\\mathrm{std}}$ 是体积应变能密度在单元面积 $A$ 上的积分：\n$$ E_{\\mathrm{vol}}^{\\mathrm{std}} = \\int_A W_{\\mathrm{vol}}(x,y) \\,dA = \\int_0^L \\int_0^L \\frac{1}{2} \\lambda [\\epsilon_v(x,y)]^2 \\,dx\\,dy $$\n代入 $\\epsilon_v(x,y) = \\gamma(y-x)$:\n$$ E_{\\mathrm{vol}}^{\\mathrm{std}} = \\frac{1}{2} \\lambda \\gamma^2 \\int_0^L \\int_0^L (y-x)^2 \\,dx\\,dy $$\n我们计算这个二重积分：\n$$ \\int_0^L \\int_0^L (y-x)^2 \\,dx\\,dy = \\int_0^L \\int_0^L (y^2 - 2xy + x^2) \\,dx\\,dy $$\n首先，对 $x$ 积分：\n$$ \\int_0^L (y^2 - 2xy + x^2) \\,dx = \\left[ y^2x - x^2y + \\frac{x^3}{3} \\right]_0^L = Ly^2 - L^2y + \\frac{L^3}{3} $$\n接下来，将结果对 $y$ 积分：\n$$ \\int_0^L \\left( Ly^2 - L^2y + \\frac{L^3}{3} \\right) \\,dy = \\left[ \\frac{Ly^3}{3} - \\frac{L^2y^2}{2} + \\frac{L^3y}{3} \\right]_0^L = \\frac{L^4}{3} - \\frac{L^4}{2} + \\frac{L^4}{3} = \\frac{2L^4}{3} - \\frac{L^4}{2} = \\frac{L^4}{6} $$\n将此结果代回 $E_{\\mathrm{vol}}^{\\mathrm{std}}$ 的表达式中：\n$$ E_{\\mathrm{vol}}^{\\mathrm{std}} = \\frac{1}{2} \\lambda \\gamma^2 \\left( \\frac{L^4}{6} \\right) = \\frac{\\lambda\\gamma^2L^4}{12} $$\n\n**3. 缓解格式下的体积应变能**\n\nEAS或$\\bar{B}$方法通过在能量计算中用单元范围内的平均体积应变 $\\bar{\\epsilon}_v$ 替换逐点体积应变 $\\epsilon_v$ 来缓解体积锁定。\n$$ \\bar{\\epsilon}_v = \\frac{1}{A} \\int_A \\epsilon_v(x,y) \\,dA $$\n单元的面积为 $A = L \\times L = L^2$。\n$$ \\bar{\\epsilon}_v = \\frac{1}{L^2} \\int_0^L \\int_0^L \\gamma(y-x) \\,dx\\,dy $$\n我们计算这个积分：\n$$ \\int_0^L \\int_0^L \\gamma(y-x) \\,dx\\,dy = \\gamma \\int_0^L \\left[ yx - \\frac{x^2}{2} \\right]_0^L \\,dy = \\gamma \\int_0^L \\left( Ly - \\frac{L^2}{2} \\right) \\,dy $$\n$$ = \\gamma \\left[ \\frac{Ly^2}{2} - \\frac{L^2y}{2} \\right]_0^L = \\gamma \\left( \\frac{L^3}{2} - \\frac{L^3}{2} \\right) = 0 $$\n因此，对于这种特定的变形模式，平均体积应变为零：\n$$ \\bar{\\epsilon}_v = 0 $$\n在缓解格式下，体积应变能密度为 $W_{\\mathrm{vol}}^{\\mathrm{mit}} = \\frac{1}{2} \\lambda \\bar{\\epsilon}_v^2$。由于 $\\bar{\\epsilon}_v = 0$，所以在整个单元内 $W_{\\mathrm{vol}}^{\\mathrm{mit}} = 0$。\n\n缓解格式的总体积内能 $E_{\\mathrm{vol}}^{\\mathrm{mit}}$ 为：\n$$ E_{\\mathrm{vol}}^{\\mathrm{mit}} = \\int_A W_{\\mathrm{vol}}^{\\mathrm{mit}} \\,dA = \\int_A 0 \\,dA = 0 $$\n\n**4. 能量差计算**\n\n问题要求计算标准体积内能与缓解体积内能之间的差值 $\\Delta E_{\\mathrm{vol}}$。\n$$ \\Delta E_{\\mathrm{vol}} = E_{\\mathrm{vol}}^{\\mathrm{std}} - E_{\\mathrm{vol}}^{\\mathrm{mit}} $$\n$$ \\Delta E_{\\mathrm{vol}} = \\frac{\\lambda\\gamma^2L^4}{12} - 0 = \\frac{\\lambda\\gamma^2L^4}{12} $$\n这个结果代表了标准位移格式对一个有效的、零体积变化的变形模式所施加的伪能惩罚，这是体积锁定的一个典型症状。缓解格式正确地为该模式赋予了零能量，从而避免了锁定。", "answer": "$$\\boxed{\\frac{\\lambda\\gamma^{2}L^{4}}{12}}$$", "id": "3543469"}, {"introduction": "增强假定应变（EAS）方法的核心在于向单元内部引入额外的“气泡”位移模式或应变模式，以丰富其运动学表达能力。这些模式必须是纯粹“内部的”，即它们在单元边界上为零，以保证单元间的位移协调性。本练习将指导您亲手构建一个用于标准三维六面体单元的气泡函数，并推导其梯度，从而理解这些函数是如何被设计以精确地增强单元内部行为而不影响其边界响应的。[@problem_id:3543518]", "problem": "考虑一个标准的、在参考域 $\\widehat{\\Omega} = [-1,1]^3$ 上使用等参坐标表示的三线性六面体单元（$Q_1$），其局部坐标为 $(\\xi,\\eta,\\zeta)$。在用于计算岩土力学的混合和增强假设应变（EAS）有限元格式中，通常引入基于位移的“气泡”函数富集来提高性能，同时保持协调性并避免虚假的边界贡献。在参考单元上进行操作，并仅使用以下基本事实：单元层面的虚功原理指出，外部边界虚功项是面力乘以虚位移迹在单元边界上的积分，而函数在边界上的迹决定了它是否对该边界积分有贡献；内部“气泡”函数富集的迹在 $\\partial\\widehat{\\Omega}$上应为零；$L^2$-归一化由函数在 $\\widehat{\\Omega}$ 上的平方积分定义。\n\n您的任务如下。首先，在 $\\widehat{\\Omega}$ 上构造一个标量“气泡”函数富集 $\\widehat{b}(\\xi,\\eta,\\zeta)$，它是一个最低次的非平凡三元多项式，在 $(\\xi,\\eta,\\zeta)$ 中是可分离的，关于每个坐标是偶函数，在开内部严格为正，并且其在 $\\partial\\widehat{\\Omega}$ 上的迹为零。证明您的选择满足这些性质，并计算其梯度 $\\nabla_{\\xi\\eta\\zeta}\\widehat{b}$。然后，利用单元层面的虚功原理和迹的性质，解释为什么附加的模式对单元边界项没有贡献。最后，引入一个正常数 $\\alpha$ 并定义归一化的“气泡”函数 $\\widehat{b}_N(\\xi,\\eta,\\zeta) = \\alpha\\,\\widehat{b}(\\xi,\\eta,\\zeta)$，并确定唯一的正常数 $\\alpha$ 使得\n$$\n\\int_{-1}^{1}\\int_{-1}^{1}\\int_{-1}^{1} \\left(\\widehat{b}_N(\\xi,\\eta,\\zeta)\\right)^2\\,\\mathrm{d}\\xi\\,\\mathrm{d}\\eta\\,\\mathrm{d}\\zeta \\;=\\; 1.\n$$\n将 $\\alpha$ 的最终答案以无单位的闭式精确表达式形式给出。不要四舍五入。", "solution": "该问题陈述经证实具有科学依据、是适定且客观的。这是有限元理论背景下的一个标准问题，具体涉及为增强假设应变（EAS）方法构建富集函数。所有必需信息均已提供，问题没有矛盾或歧义。\n\n按照要求，该问题分四部分进行解答。\n\n首先，我们在参考域 $\\widehat{\\Omega} = [-1,1]^3$ 上构造标量“气泡”函数富集 $\\widehat{b}(\\xi,\\eta,\\zeta)$。该函数必须满足以下几个性质：\n1.  **在 $\\partial\\widehat{\\Omega}$ 上的迹为零**：立方体的边界 $\\partial\\widehat{\\Omega}$ 由平面 $\\xi = \\pm 1$、$\\eta = \\pm 1$ 或 $\\zeta = \\pm 1$ 组成。如果函数在边界上任意一点的取值都为 $0$，则其在边界上的迹为零。\n2.  **在 $(\\xi,\\eta,\\zeta)$ 中可分离**：函数可以写成三个单变量函数的乘积，即 $\\widehat{b}(\\xi,\\eta,\\zeta) = f(\\xi)g(\\eta)h(\\zeta)$。为了使该乘积在 $\\partial\\widehat{\\Omega}$ 上的迹为零，每个分量函数在其定义域的端点处为零即可，即 $f(\\pm 1) = 0$、$g(\\pm 1) = 0$ 和 $h(\\pm 1) = 0$。\n3.  **最低次的非平凡三元多项式**：为了满足 $f(\\pm 1) = 0$，单变量多项式 $f(\\xi)$ 必须在 $\\xi=1$ 和 $\\xi=-1$ 处有根。具有这些根的最低次非平凡多项式是二次多项式，形式为 $c(\\xi-1)(\\xi+1) = c(\\xi^2-1)$，其中 $c$ 是一个非零常数。\n4.  **关于每个坐标为偶函数**：多项式 $\\xi^2-1$ 是 $\\xi$ 的偶函数。为了使 $\\widehat{b}$ 满足此性质，我们选择 $f$、$g$ 和 $h$ 均为偶函数。形式 $c(\\xi^2-1)$ 满足此要求。\n5.  **在开内部严格为正**：域的内部是 $(\\xi,\\eta,\\zeta) \\in (-1,1)^3$。对于 $\\xi \\in (-1,1)$，项 $\\xi^2-1$ 是负的。为确保“气泡”函数在内部为正，我们可以选择单变量函数为 $1-\\xi^2$，它对于 $\\xi \\in (-1,1)$ 是正的。\n\n综合这些要求，在立方体所有面上都为零的最简单的可分离多项式，是在每个坐标区间端点处为零的最简单（二次）多项式的乘积。我们将该函数定义为：\n$$\n\\widehat{b}(\\xi,\\eta,\\zeta) = (1-\\xi^2)(1-\\eta^2)(1-\\zeta^2)\n$$\n该函数是一个6次多项式。如上所述，任何在 $\\partial\\widehat{\\Omega}$ 上迹为零的可分离多项式 $\\widehat{b}=fgh$ 都要求 $f, g, h$ 至少是2次的，这使得 $\\widehat{b}$ 的总次数至少为6。因此，我们的选择代表了满足所有所述条件的最低次多项式。它关于每个坐标都是偶函数，因为每个因子 $(1-x^2)$ 都是偶函数。它在内部严格为正，因为对于在 $(-1,1)$ 内的坐标，每个因子都是严格为正的。\n\n第二，我们计算 $\\widehat{b}(\\xi,\\eta,\\zeta)$ 的梯度。使用微分的乘法法则：\n$$\n\\frac{\\partial\\widehat{b}}{\\partial\\xi} = \\frac{\\partial}{\\partial\\xi}\\left[(1-\\xi^2)(1-\\eta^2)(1-\\zeta^2)\\right] = (-2\\xi)(1-\\eta^2)(1-\\zeta^2)\n$$\n根据对称性，其他偏导数为：\n$$\n\\frac{\\partial\\widehat{b}}{\\partial\\eta} = (-2\\eta)(1-\\xi^2)(1-\\zeta^2)\n$$\n$$\n\\frac{\\partial\\widehat{b}}{\\partial\\zeta} = (-2\\zeta)(1-\\xi^2)(1-\\eta^2)\n$$\n因此，梯度向量为：\n$$\n\\nabla_{\\xi\\eta\\zeta}\\widehat{b} = \\begin{pmatrix} -2\\xi(1-\\eta^2)(1-\\zeta^2) \\\\ -2\\eta(1-\\xi^2)(1-\\zeta^2) \\\\ -2\\zeta(1-\\xi^2)(1-\\eta^2) \\end{pmatrix}\n$$\n\n第三，我们解释为什么这个“气泡”模式对单元边界虚功没有贡献。虚功原理指出，外部面力 $\\mathbf{t}$ 在单元边界 $\\partial\\Omega_e$ 上所做的虚功由积分 $W_{ext}^{bnd} = \\int_{\\partial\\Omega_e} \\mathbf{t}\\cdot\\delta\\mathbf{u}\\,\\mathrm{d}S$ 给出，其中 $\\delta\\mathbf{u}$ 是虚位移场。增强格式增加了一个基于“气泡”函数的内部位移模式，因此虚位移可以写成 $\\delta\\mathbf{u} = \\delta\\mathbf{u}_{std} + \\delta\\mathbf{u}_{bubble}$，其中 $\\delta\\mathbf{u}_{std}$ 是来自节点自由度的标准部分，$\\delta\\mathbf{u}_{bubble}$ 是富集部分。对于向量位移场，一个典型的富集是 $\\delta\\mathbf{u}_{bubble} = \\widehat{b} \\delta\\mathbf{a}$，其中 $\\delta\\mathbf{a}$ 是一个虚系数向量。“气泡”模式对边界虚功的贡献是 $\\int_{\\partial\\Omega_e} \\mathbf{t} \\cdot \\delta\\mathbf{u}_{bubble}\\,\\mathrm{d}S$。等参映射将物理单元边界 $\\partial\\Omega_e$ 关联到参考单元边界 $\\partial\\widehat{\\Omega}$。根据构造，我们的“气泡”函数 $\\widehat{b}$ 在 $\\partial\\widehat{\\Omega}$ 上的迹为零。这意味着对于任何点 $(\\xi,\\eta,\\zeta) \\in \\partial\\widehat{\\Omega}$，都有 $\\widehat{b}(\\xi,\\eta,\\zeta)=0$。因此，虚位移富集 $\\delta\\mathbf{u}_{bubble}$ 在物理单元边界 $\\partial\\Omega_e$ 上恒为零。所以，该积分的计算结果为零：\n$$\n\\int_{\\partial\\Omega_e} \\mathbf{t} \\cdot \\delta\\mathbf{u}_{bubble}\\,\\mathrm{d}S = \\int_{\\partial\\Omega_e} \\mathbf{t} \\cdot \\mathbf{0}\\,\\mathrm{d}S = 0\n$$\n因此，这个附加模式是一个真正的“气泡”或“内部”模式，它增强了单元内部的应变场，但对边界上所做的功没有贡献，从而保持了C0连续性，并且不干扰施加的面力边界条件。\n\n最后，我们确定归一化“气泡”函数 $\\widehat{b}_N(\\xi,\\eta,\\zeta) = \\alpha\\,\\widehat{b}(\\xi,\\eta,\\zeta)$ 的正常数 $\\alpha$，使其在参考单元上的 $L^2$-范数为1。归一化条件是：\n$$\n\\int_{-1}^{1}\\int_{-1}^{1}\\int_{-1}^{1} \\left(\\widehat{b}_N(\\xi,\\eta,\\zeta)\\right)^2\\,\\mathrm{d}\\xi\\,\\mathrm{d}\\eta\\,\\mathrm{d}\\zeta = 1\n$$\n代入 $\\widehat{b}_N$ 和 $\\widehat{b}$ 的表达式：\n$$\n\\alpha^2 \\int_{-1}^{1}\\int_{-1}^{1}\\int_{-1}^{1} \\left[ (1-\\xi^2)(1-\\eta^2)(1-\\zeta^2) \\right]^2\\,\\mathrm{d}\\xi\\,\\mathrm{d}\\eta\\,\\mathrm{d}\\zeta = 1\n$$\n该积分是可分离的：\n$$\n\\alpha^2 \\left(\\int_{-1}^{1} (1-\\xi^2)^2\\,\\mathrm{d}\\xi\\right) \\left(\\int_{-1}^{1} (1-\\eta^2)^2\\,\\mathrm{d}\\eta\\right) \\left(\\int_{-1}^{1} (1-\\zeta^2)^2\\,\\mathrm{d}\\zeta\\right) = 1\n$$\n令 $I = \\int_{-1}^{1} (1-x^2)^2\\,\\mathrm{d}x$。方程变为 $\\alpha^2 I^3 = 1$。我们首先计算 $I$ 的值：\n$$\nI = \\int_{-1}^{1} (1 - 2x^2 + x^4)\\,\\mathrm{d}x\n$$\n由于被积函数是偶函数，我们可以将积分计算为：\n$$\nI = 2 \\int_{0}^{1} (1 - 2x^2 + x^4)\\,\\mathrm{d}x = 2 \\left[ x - \\frac{2}{3}x^3 + \\frac{1}{5}x^5 \\right]_0^1\n$$\n$$\nI = 2 \\left( 1 - \\frac{2}{3} + \\frac{1}{5} \\right) = 2 \\left( \\frac{15-10+3}{15} \\right) = 2 \\left( \\frac{8}{15} \\right) = \\frac{16}{15}\n$$\n现在我们求解 $\\alpha$。因为 $\\alpha$ 必须为正：\n$$\n\\alpha^2 \\left(\\frac{16}{15}\\right)^3 = 1 \\implies \\alpha = \\sqrt{\\left(\\frac{15}{16}\\right)^3} = \\left(\\frac{15}{16}\\right)^{3/2}\n$$\n$$\n\\alpha = \\frac{15^{3/2}}{16^{3/2}} = \\frac{15\\sqrt{15}}{(\\sqrt{16})^3} = \\frac{15\\sqrt{15}}{4^3} = \\frac{15\\sqrt{15}}{64}\n$$\n这就是归一化常数 $\\alpha$ 唯一的正值。", "answer": "$$\\boxed{\\frac{15\\sqrt{15}}{64}}$$", "id": "3543518"}, {"introduction": "虽然增强应变方法能够有效缓解锁定，但若设计不当，也可能引入新的数值不稳定问题，即伪零能模式（spurious zero-energy modes）。一个稳健的单元配方必须确保除了刚体运动外，任何非零变形都会产生正的应变能。本练习将引导您通过对单元级刚度矩阵进行凝聚和特征值分析，来诊断和滤除这些不稳定的伪模式，这是一种在有限元程序开发中用于保证单元稳定性的高级而实用的技术。[@problem_id:3543530]", "problem": "要求您通过对单元级凝聚刚度进行局部特征分析，来分析混合和增强应变有限元格式中的伪零能增强应变模态。从适用于计算岩土力学的基本原理出发：最小势能原理和线性化稳定性概念。考虑一个单一有限元，其围绕平衡态的线性化增量势能可以很好地用一个关于节点位移向量和内部增强应变参数的二次型来近似。令 $u \\in \\mathbb{R}^m$ 表示节点位移向量，令 $a \\in \\mathbb{R}^n$ 表示与增强应变模态（记作 $\\tilde{\\varepsilon}$）相关的内部参数。在线性化条件下，单元能量可以表示为\n$$\n\\Pi(u,a) = \\tfrac{1}{2}\n\\begin{bmatrix}\nu \\\\ a\n\\end{bmatrix}^{\\!\\top}\n\\begin{bmatrix}\nK_{uu}  K_{ua} \\\\\nK_{au}  K_{aa}\n\\end{bmatrix}\n\\begin{bmatrix}\nu \\\\ a\n\\end{bmatrix},\n$$\n其中 $K_{uu} \\in \\mathbb{R}^{m \\times m}$，$K_{ua} \\in \\mathbb{R}^{m \\times n}$，$K_{au} = K_{ua}^\\top \\in \\mathbb{R}^{n \\times m}$，以及 $K_{aa} \\in \\mathbb{R}^{n \\times n}$ 构成一个对称海森矩阵。假设 $K_{aa}$ 是可逆的。对 $a$ 进行静力凝聚，得到关于 $u$ 的凝聚海森矩阵：\n$$\nH = K_{uu} - K_{ua} K_{aa}^{-1} K_{au}.\n$$\n在稳健的混合和增强应变格式中，伪零能 $\\tilde{\\varepsilon}$ 模态在局部表现为凝聚海森矩阵 $H$ 中的近零特征值，而稳定性要求 $H$ 是对称正定（SPD）的。您的任务是：\n\n1. 仅从最小势能原理和二次能量形式的定义出发，推导凝聚海森矩阵 $H$，并解释为何 $H$ 中近零特征值的存在对应于伪零能 $\\tilde{\\varepsilon}$ 模态。基于 $H$ 的正定性，提出一个用于识别和过滤这些模态的数值准则。\n\n2. 实现一个算法，对于给定的单元矩阵集 $(K_{uu}, K_{ua}, K_{aa})$，执行以下步骤：\n   - 使用舒尔补 $H = K_{uu} - K_{ua}K_{aa}^{-1}K_{au}$ 计算凝聚海森矩阵 $H$。\n   - 对 $H$ 进行对称特征分析，以获得特征对 $\\{(\\lambda_i, v_i)\\}$。\n   - 定义一个容差\n     $$\n     \\tau = \\gamma \\cdot \\max\\!\\big(1, \\|H\\|_2\\big)\\cdot \\sqrt{\\epsilon},\n     $$\n     其中 $\\gamma > 0$ 是用户指定的缩放因子，$\\|H\\|_2$ 是谱范数（最大奇异值，对于对称的 $H$ 等于最大绝对特征值），$\\epsilon$ 是双精度浮点运算的机器精度。将任何特征值满足 $|\\lambda_i| \\le \\tau$ 的模态分类为伪模态。\n   - 构建一个滤波器，通过投影到由特征值满足 $\\lambda_i > \\tau$ 的特征向量所张成的子空间上，来移除已识别的伪模态。过滤后的凝聚海森矩阵可以写为\n     $$\n     H_{\\text{filtered}} = Q_+ \\,\\mathrm{diag}(\\lambda_i : \\lambda_i > \\tau)\\, Q_+^\\top,\n     $$\n     其中 $Q_+$ 的列是特征值满足 $\\lambda_i > \\tau$ 的特征向量。\n   - 判断原始 $H$ 在该容差下是否为正定，即检查是否满足 $\\min_i \\lambda_i > \\tau$。\n\n3. 使用以下单元块矩阵的测试套件。每个测试用例都是独立且自包含的，并且所有矩阵在要求时都维度一致且对称。对于所有测试用例，使用 $\\gamma = 10$。\n\n   测试用例1（正常情况，$m=3$, $n=2$）：\n   - $K_{uu} = \\begin{bmatrix}\n   12  2  0 \\\\\n   2  8  1 \\\\\n   0  1  5\n   \\end{bmatrix}$,\n   - $K_{aa} = \\begin{bmatrix}\n   6  1 \\\\\n   1  4\n   \\end{bmatrix}$,\n   - $K_{ua} = \\begin{bmatrix}\n   1  0.2 \\\\\n   0.3  0.1 \\\\\n   0.0  0.5\n   \\end{bmatrix}$。\n\n   测试用例2（由于完全耦合导致的精确奇异，$m=3$, $n=3$）：\n   - $K_{uu}$ 与测试用例1中相同，\n   - 令 $L$ 为 $K_{uu}$ 的下三角Cholesky因子，即 $L L^\\top = K_{uu}$，\n   - $K_{aa} = I_3$,\n   - $K_{ua} = L$。\n\n   测试用例3（近奇异，存在小的正特征值，$m=3$, $n=3$）：\n   - $K_{uu}$ 与测试用例1中相同，\n   - $L$ 如测试用例2中定义，\n   - $K_{aa} = I_3$,\n   - $K_{ua} = 0.99\\, L$。\n\n   测试用例4（不定凝聚海森矩阵，$m=3$, $n=3$）：\n   - $K_{uu}$ 与测试用例1中相同，\n   - $L$ 如测试用例2中定义，\n   - $K_{aa} = I_3$,\n   - $K_{ua} = 1.2\\, L$。\n\n4. 您的程序必须处理上述测试套件，并为每个测试用例生成一个包含以下内容的数据对：\n   - 识别出的伪模态的整数数量（$H$ 的特征值满足 $|\\lambda_i| \\le \\tau$ 的数量），\n   - 一个布尔值，说明 $H$ 在该容差下是否为正定（如果 $\\min_i \\lambda_i > \\tau$ 则为 true，否则为 false）。\n   最终输出必须是单行，包含一个由方括号括起来的逗号分隔的这些数据对的列表，其中每个数据对本身就是一个 $[s, \\text{pd}]$ 形式的列表。例如，格式必须像这样\n   $$\n   [ [s_1, \\text{pd}_1], [s_2, \\text{pd}_2], [s_3, \\text{pd}_3], [s_4, \\text{pd}_4] ].\n   $$\n   本问题不涉及物理单位，也不涉及角度；所有输出都是无单位的。程序必须是完全自包含的，并且不需要用户输入。", "solution": "该问题涉及混合和增强应变有限元格式中稳定性的分析，这是计算岩土力学中的一个核心议题。伪零能模态对应于有限元的非物理变形，这种变形几乎不储存应变能，从而导致数值不稳定性。这些模态通过分析单元凝聚刚度矩阵的特征值来识别。\n\n### 1. 凝聚海森矩阵的推导与解释\n\n推导始于将最小势能原理应用于单个有限元的线性化增量势能 $\\Pi$。该能量以节点位移 $u \\in \\mathbb{R}^m$ 和内部增强应变参数 $a \\in \\mathbb{R}^n$ 的二次型给出：\n$$\n\\Pi(u,a) = \\tfrac{1}{2}\n\\begin{bmatrix}\nu \\\\ a\n\\end{bmatrix}^{\\!\\top}\n\\begin{bmatrix}\nK_{uu}  K_{ua} \\\\\nK_{au}  K_{aa}\n\\end{bmatrix}\n\\begin{bmatrix}\nu \\\\ a\n\\end{bmatrix}\n$$\n展开此表达式，并利用完整海森矩阵是对称的（$K_{au} = K_{ua}^\\top$）这一事实，我们得到：\n$$\n\\Pi(u,a) = \\frac{1}{2} (u^\\top K_{uu} u + u^\\top K_{ua} a + a^\\top K_{au} u + a^\\top K_{aa} a) = \\frac{1}{2} (u^\\top K_{uu} u + 2u^\\top K_{ua} a + a^\\top K_{aa} a)\n$$\n对于给定的节点位移向量 $u$，内部参数 $a$ 会局部平衡到一个使势能 $\\Pi$ 最小化的状态。这个平衡条件可以通过将 $\\Pi$ 相对于 $a$ 的梯度设为零来找到：\n$$\n\\frac{\\partial \\Pi}{\\partial a} = K_{au} u + K_{aa} a = 0\n$$\n问题陈述假设矩阵 $K_{aa}$ 是可逆的。这对增强应变场本身的稳定性至关重要；它确保了对于任何给定的位移集，都存在一组唯一的增强应变参数。求解 $a$ 可得：\n$$\na(u) = -K_{aa}^{-1} K_{au} u\n$$\n该关系表明，内部参数线性依赖于节点位移。将此表达式代回势能泛函 $\\Pi(u,a)$ 中，可以消去内部参数 $a$，得到仅是节点位移 $u$ 的函数的凝聚势能 $\\Pi_{\\text{cond}}(u)$：\n$$\n\\Pi_{\\text{cond}}(u) = \\Pi(u, a(u)) = \\frac{1}{2} \\left[ u^\\top K_{uu} u + 2u^\\top K_{ua} (-K_{aa}^{-1} K_{au} u) + (-K_{aa}^{-1} K_{au} u)^\\top K_{aa} (-K_{aa}^{-1} K_{au} u) \\right]\n$$\n使用恒等式 $(ABC)^\\top = C^\\top B^\\top A^\\top$ 和 $K_{aa}$ 的对称性（这意味着其逆矩阵也是对称的，$(K_{aa}^{-1})^\\top = K_{aa}^{-1}$），第三项可以简化为：\n$$\nu^\\top K_{au}^\\top (K_{aa}^{-1})^\\top K_{aa} K_{aa}^{-1} K_{au} u = u^\\top K_{ua} K_{aa}^{-1} I K_{au} u = u^\\top K_{ua} K_{aa}^{-1} K_{au} u\n$$\n将此代回 $\\Pi_{\\text{cond}}(u)$ 的表达式中：\n$$\n\\Pi_{\\text{cond}}(u) = \\frac{1}{2} \\left[ u^\\top K_{uu} u - 2u^\\top K_{ua} K_{aa}^{-1} K_{au} u + u^\\top K_{ua} K_{aa}^{-1} K_{au} u \\right]\n$$\n$$\n\\Pi_{\\text{cond}}(u) = \\frac{1}{2} \\left[ u^\\top K_{uu} u - u^\\top K_{ua} K_{aa}^{-1} K_{au} u \\right] = \\frac{1}{2} u^\\top (K_{uu} - K_{ua} K_{aa}^{-1} K_{au}) u\n$$\n这是一个二次型 $\\Pi_{\\text{cond}}(u) = \\frac{1}{2} u^\\top H u$，其中矩阵 $H$ 是凝聚海森矩阵，也称为 $K_{aa}$ 在完整系统矩阵中的舒尔补：\n$$\nH = K_{uu} - K_{ua} K_{aa}^{-1} K_{au}\n$$\n该矩阵 $H$ 代表了在对于任何给定位移，内部增强应变模态都已为最小化能量而被优化选择后，有限元相对于其节点自由度的有效刚度。\n\n为了使一个单元稳定，任何非刚体运动的变形都必须储存正的应变能。用凝聚能量形式来说，这意味着对于所有不代表刚体运动的非零位移向量 $u$，$\\Pi_{\\text{cond}}(u) = \\frac{1}{2} u^\\top H u > 0$。如果我们忽略刚体模态（其能量根据定义为零），稳定性要求凝聚海森矩阵 $H$ 是一个对称正定（SPD）矩阵。\n\n伪零能模态是一种非刚体位移模态 $v$，其应变能为零或接近于零。从 $H$ 的谱特性来看，与特征模态 $v_i$ 相关的能量为 $\\frac{1}{2} v_i^\\top H v_i = \\frac{1}{2} \\lambda_i \\|v_i\\|^2$，其中 $(\\lambda_i, v_i)$ 是 $H$ 的一个特征对。因此，一个伪模态对应于一个其特征值 $\\lambda_i$ 为零或接近零的特征向量 $v_i$。这样一个特征值的存在表明凝聚刚度矩阵存在秩亏，这是不稳定的有限元格式的一个标志。\n\n### 2. 伪模态的数值准则\n\n在有限精度算法的数值计算中，本应精确为零的特征值通常会被计算为很小的非零数。因此，需要一个稳健的数值准则来区分具有物理意义的小特征值与那些由数值噪声或格式不稳定性产生的伪特征值。\n\n问题为此提供了一个明确定义的容差 $\\tau$：\n$$\n\\tau = \\gamma \\cdot \\max\\!\\big(1, \\|H\\|_2\\big)\\cdot \\sqrt{\\epsilon}\n$$\n该容差的组成部分是：\n- $\\epsilon$：机器精度（例如，对于双精度，$\\epsilon \\approx 2.22 \\times 10^{-16}$），它为数值准确性设定了一个基本限制。平方根 $\\sqrt{\\epsilon}$ 是合适的，因为特征值与频率和能量的平方有关。\n- $\\|H\\|_2$：$H$ 的谱范数，即其最大绝对特征值 $|\\lambda_{\\max}|$。通过这个范数来缩放容差，使得检查相对于单元中刚度的总体量级。这可以防止一个固定的绝对容差对于一个非常“软”的单元来说过于严格，或者对于一个非常“刚”的单元来说过于宽松。使用 $\\max(1, \\|H\\|_2)$ 为容差提供了一个下限，确保即使 $H$ 本身接近于零矩阵，容差也仍然有意义。\n- $\\gamma$：一个用户定义的缩放因子（给定为10），允许调整准则的严格性。\n\n使用这个容差，我们建立以下数值准则：\n- **伪模态识别**：如果一个特征模态 $(\\lambda_i, v_i)$ 的特征值落在数值噪声阈值内，即 $|\\lambda_i| \\le \\tau$，则将其分类为伪模态。此类模态的数量就是伪模态的计数。\n- **正定性检查**：如果矩阵 $H$ 的最小特征值不仅为正，而且超过了这个数值噪声阈值，那么它就被认为是数值正定的。条件是 $\\min_i \\lambda_i > \\tau$。一个大于零但小于 $\\tau$ 的特征值表明该矩阵充其量是半正定的，并且在数值上是不稳定的。\n\n识别出的伪模态可以通过从其谱分解中重构海森矩阵来滤除，排除与伪模态相关的分量。如果 $H = Q \\Lambda Q^\\top = \\sum_i \\lambda_i v_i v_i^\\top$ 是特征分解，则过滤后的海森矩阵为：\n$$\nH_{\\text{filtered}} = \\sum_{\\lambda_i > \\tau} \\lambda_i v_i v_i^\\top = Q_+ \\,\\mathrm{diag}(\\lambda_i \\mid \\lambda_i > \\tau)\\, Q_+^\\top\n$$\n其中 $Q_+$ 的列是对应于特征值 $\\lambda_i > \\tau$ 的特征向量。此操作将单元刚度投影到稳定子空间上，有效地移除了不稳定的变形模态。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Analyzes spurious modes in mixed/enhanced strain finite element formulations\n    for a given suite of test cases.\n    \"\"\"\n\n    # --- Problem Parameters ---\n    gamma = 10.0\n    machine_eps = np.finfo(float).eps\n\n    # --- Test Suite Definition ---\n\n    # Common K_uu matrix for all test cases\n    K_uu = np.array([\n        [12.0, 2.0, 0.0],\n        [2.0, 8.0, 1.0],\n        [0.0, 1.0, 5.0]\n    ])\n\n    test_cases = []\n\n    # Test Case 1: Happy path\n    test_cases.append({\n        \"K_uu\": K_uu,\n        \"K_aa\": np.array([[6.0, 1.0], [1.0, 4.0]]),\n        \"K_ua\": np.array([[1.0, 0.2], [0.3, 0.1], [0.0, 0.5]])\n    })\n\n    # For cases 2, 3, 4, we need the Cholesky factor of K_uu.\n    # K_uu is symmetric positive definite, so Cholesky decomposition exists.\n    try:\n        L = np.linalg.cholesky(K_uu)\n    except np.linalg.LinAlgError:\n        # This part should not be reached as K_uu is SPD.\n        print(\"Error: K_uu must be positive definite for Cholesky decomposition.\")\n        return\n\n    # Test Case 2: Exact singular condensed Hessian\n    test_cases.append({\n        \"K_uu\": K_uu,\n        \"K_aa\": np.identity(3),\n        \"K_ua\": L\n    })\n\n    # Test Case 3: Near-singular condensed Hessian (small positive eigenvalues)\n    test_cases.append({\n        \"K_uu\": K_uu,\n        \"K_aa\": np.identity(3),\n        \"K_ua\": 0.99 * L\n    })\n\n    # Test Case 4: Indefinite condensed Hessian (negative eigenvalues)\n    test_cases.append({\n        \"K_uu\": K_uu,\n        \"K_aa\": np.identity(3),\n        \"K_ua\": 1.2 * L\n    })\n\n    results = []\n\n    for case in test_cases:\n        k_uu = case[\"K_uu\"]\n        k_ua = case[\"K_ua\"]\n        k_aa = case[\"K_aa\"]\n\n        k_au = k_ua.T\n\n        # Step 1: Compute the condensed Hessian H (Schur complement)\n        try:\n            k_aa_inv = np.linalg.inv(k_aa)\n            H = k_uu - k_ua @ k_aa_inv @ k_au\n        except np.linalg.LinAlgError:\n            results.append([\"Error\", \"Error\"])\n            continue\n\n        # Step 2: Perform symmetric eigenanalysis of H\n        eigenvalues, eigenvectors = np.linalg.eigh(H)\n\n        # Step 3: Define the tolerance tau\n        H_norm_2 = np.max(np.abs(eigenvalues))\n        tau = gamma * np.max([1.0, H_norm_2]) * np.sqrt(machine_eps)\n\n        # Step 4: Classify spurious modes\n        spurious_count = np.sum(np.abs(eigenvalues) = tau)\n\n        # Step 5: Check for positive definiteness under the tolerance\n        min_eigenvalue = eigenvalues[0] if len(eigenvalues) > 0 else 0.0\n        is_pd = min_eigenvalue > tau\n\n        results.append([int(spurious_count), bool(is_pd)])\n\n    # Format the final output string as specified by the problem.\n    # The str() representation of a Python list of lists is the required format.\n    output_str = str(results)\n    print(output_str)\n\nif __name__ == '__main__':\n    solve()\n```", "id": "3543530"}]}