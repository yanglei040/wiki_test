{"hands_on_practices": [{"introduction": "本练习将提供一个计算雅可比矩阵的基础实践。通过一个简单的四节点四边形单元的双线性映射，您将亲身体验如何应用雅可比矩阵的定义，并理解它如何量化从参考正方形到物理单元的局部变换。这项实践是理解有限元分析中单元几何如何被数学描述的第一步。[@problem_id:2216463]", "problem": "在求解偏微分方程的数值方法中，通常使用变换将复杂的物理域映射到一个简单的、结构化的计算域。考虑这样一种变换，它将 $(\\xi, \\eta)$ 坐标系中由 $-1 \\le \\xi \\le 1$ 和 $-1 \\le \\eta \\le 1$ 定义的方形参考域，映射到物理 $(x, y)$ 坐标系中的一个四边形区域。\n\n该变换由以下映射函数给出：\n$$\nx(\\xi, \\eta) = \\frac{1}{4} \\left[ (1-\\xi)(1-\\eta)x_1 + (1+\\xi)(1-\\eta)x_2 + (1+\\xi)(1+\\eta)x_3 + (1-\\xi)(1+\\eta)x_4 \\right]\n$$\n$$\ny(\\xi, \\eta) = \\frac{1}{4} \\left[ (1-\\xi)(1-\\eta)y_1 + (1+\\xi)(1-\\eta)y_2 + (1+\\xi)(1+\\eta)y_3 + (1-\\xi)(1+\\eta)y_4 \\right]\n$$\n其中，对于 $i=1, 2, 3, 4$，$(x_i, y_i)$ 是物理平面中四边形顶点的坐标，它们与参考方形的角点相对应。这些顶点按逆时针方向编号，其坐标如下：\n$P_1 = (x_1, y_1) = (1, 1)$\n$P_2 = (x_2, y_2) = (5, 2)$\n$P_3 = (x_3, y_3) = (4, 5)$\n$P_4 = (x_4, y_4) = (2, 4)$\n\n你的任务是计算该变换的雅可比矩阵 $J = \\frac{\\partial(x,y)}{\\partial(\\xi,\\eta)}$，并在参考方形的中心点，即点 $(\\xi, \\eta) = (0, 0)$ 处进行求值。请将答案表示为一个包含精确有理数（分数）的 2x2 矩阵。", "solution": "给定双线性等参映射\n$$\nx(\\xi,\\eta)=\\frac{1}{4}\\left[(1-\\xi)(1-\\eta)x_{1}+(1+\\xi)(1-\\eta)x_{2}+(1+\\xi)(1+\\eta)x_{3}+(1-\\xi)(1+\\eta)x_{4}\\right],\n$$\n$$\ny(\\xi,\\eta)=\\frac{1}{4}\\left[(1-\\xi)(1-\\eta)y_{1}+(1+\\xi)(1-\\eta)y_{2}+(1+\\xi)(1+\\eta)y_{3}+(1-\\xi)(1+\\eta)y_{4}\\right].\n$$\n雅可比矩阵为 $J=\\partial(x,y)/\\partial(\\xi,\\eta)$，其元素为 $J_{11}=\\partial x/\\partial \\xi$、$J_{12}=\\partial x/\\partial \\eta$、$J_{21}=\\partial y/\\partial \\xi$、$J_{22}=\\partial y/\\partial \\eta$。进行符号微分：\n$$\n\\frac{\\partial x}{\\partial \\xi}=\\frac{1}{4}\\left[-(1-\\eta)x_{1}+(1-\\eta)x_{2}+(1+\\eta)x_{3}-(1+\\eta)x_{4}\\right],\n$$\n$$\n\\frac{\\partial x}{\\partial \\eta}=\\frac{1}{4}\\left[-(1-\\xi)x_{1}-(1+\\xi)x_{2}+(1+\\xi)x_{3}+(1-\\xi)x_{4}\\right],\n$$\n$$\n\\frac{\\partial y}{\\partial \\xi}=\\frac{1}{4}\\left[-(1-\\eta)y_{1}+(1-\\eta)y_{2}+(1+\\eta)y_{3}-(1+\\eta)y_{4}\\right],\n$$\n$$\n\\frac{\\partial y}{\\partial \\eta}=\\frac{1}{4}\\left[-(1-\\xi)y_{1}-(1+\\xi)y_{2}+(1+\\xi)y_{3}+(1-\\xi)y_{4}\\right].\n$$\n在中心点 $(\\xi,\\eta)=(0,0)$ 处，我们有 $(1\\pm \\xi)=(1\\pm \\eta)=1$，因此\n$$\n\\left.\\frac{\\partial x}{\\partial \\xi}\\right|_{(0,0)}=\\frac{1}{4}\\left[-x_{1}+x_{2}+x_{3}-x_{4}\\right],\\quad\n\\left.\\frac{\\partial x}{\\partial \\eta}\\right|_{(0,0)}=\\frac{1}{4}\\left[-x_{1}-x_{2}+x_{3}+x_{4}\\right],\n$$\n$$\n\\left.\\frac{\\partial y}{\\partial \\xi}\\right|_{(0,0)}=\\frac{1}{4}\\left[-y_{1}+y_{2}+y_{3}-y_{4}\\right],\\quad\n\\left.\\frac{\\partial y}{\\partial \\eta}\\right|_{(0,0)}=\\frac{1}{4}\\left[-y_{1}-y_{2}+y_{3}+y_{4}\\right].\n$$\n使用给定的顶点 $P_{1}=(x_{1},y_{1})=(1,1)$，$P_{2}=(5,2)$，$P_{3}=(4,5)$，$P_{4}=(2,4)$，计算\n$$\n\\left.\\frac{\\partial x}{\\partial \\xi}\\right|_{(0,0)}=\\frac{1}{4}(-1+5+4-2)=\\frac{6}{4}=\\frac{3}{2},\\quad\n\\left.\\frac{\\partial x}{\\partial \\eta}\\right|_{(0,0)}=\\frac{1}{4}(-1-5+4+2)=0,\n$$\n$$\n\\left.\\frac{\\partial y}{\\partial \\xi}\\right|_{(0,0)}=\\frac{1}{4}(-1+2+5-4)=\\frac{2}{4}=\\frac{1}{2},\\quad\n\\left.\\frac{\\partial y}{\\partial \\eta}\\right|_{(0,0)}=\\frac{1}{4}(-1-2+5+4)=\\frac{6}{4}=\\frac{3}{2}.\n$$\n因此，在 $(\\xi,\\eta)=(0,0)$ 处的雅可比矩阵为\n$$\nJ(0,0)=\\begin{pmatrix}\n\\frac{3}{2} & 0 \\\\\n\\frac{1}{2} & \\frac{3}{2}\n\\end{pmatrix}.\n$$", "answer": "$$\\boxed{\\begin{pmatrix}\\frac{3}{2} & 0 \\\\ \\frac{1}{2} & \\frac{3}{2}\\end{pmatrix}}$$", "id": "2216463"}, {"introduction": "在基础之上，本问题将探讨更复杂的高阶单元——八节点“机缘”四边形的雅可比矩阵。与简单的双线性情况不同，您会发现雅可比矩阵在单元内部并非恒定。此练习将引导您推导雅可比矩阵并展示其空间变化性，从而揭示了为何像高斯求积这样的数值积分方案需要在多个点上计算雅可比行列式的关键原因。[@problem_id:3511568]", "problem": "考虑一个二维八节点二次 Serendipity 四边形单元的等参映射，该映射从双单位参考域 $(\\xi,\\eta)\\in[-1,1]\\times[-1,1]$ 映射到物理域 $(x,y)$。参考节点位置为四个角点 $(-1,-1)$、$(1,-1)$、$(1,1)$、$(-1,1)$ 和四个边中点 $(0,-1)$、$(1,0)$、$(0,1)$、$(-1,0)$。等参映射定义为 $x(\\xi,\\eta)=\\sum_{i=1}^{8}N_i(\\xi,\\eta)\\,x_i$ 和 $y(\\xi,\\eta)=\\sum_{i=1}^{8}N_i(\\xi,\\eta)\\,y_i$，其中 $N_i(\\xi,\\eta)$ 是标准的二次 Serendipity 形函数，$(x_i,y_i)$ 是物理节点坐标。单元映射的雅可比矩阵为 $\\mathbf{J}_e(\\xi,\\eta)=\\begin{pmatrix}\\partial x/\\partial \\xi & \\partial x/\\partial \\eta \\\\ \\partial y/\\partial \\xi & \\partial y/\\partial \\eta\\end{pmatrix}$。仅从等参映射的定义、在参考节点上满足克罗内克-德尔塔性质的形函数以及有限元法 (FEM) 中雅可比矩阵的定义出发，推导 $\\mathbf{J}_e(\\xi,\\eta)$ 关于 $\\{(x_i,y_i)\\}_{i=1}^{8}$ 和 $\\{N_i(\\xi,\\eta)\\}_{i=1}^{8}$ 导数的显式表达式。然后，使用以下一个扭曲凸单元的物理节点坐标（单位为米），\n$(x_1,y_1)=(0,0)$、$(x_2,y_2)=(4,0)$、$(x_3,y_3)=(4.5,3)$、$(x_4,y_4)=(-0.5,3.5)$、$(x_5,y_5)=(2,0)$、$(x_6,y_6)=(4.25,1.5)$、$(x_7,y_7)=(2,3.25)$、$(x_8,y_8)=(-0.25,1.75)$，\n在标准的 $2\\times 2$ 高斯点坐标 $(\\xi,\\eta)\\in\\{\\pm 1/\\sqrt{3}\\}\\times\\{\\pm 1/\\sqrt{3}\\}$ 处计算 $\\det\\mathbf{J}_e(\\xi,\\eta)$ 的值，以证明 $\\mathbf{J}_e$ 在单元上是变化的，因此在组装单元刚度时必须在每个高斯点进行计算。最后，报告在 $(\\xi,\\eta)=\\left(1/\\sqrt{3},\\,1/\\sqrt{3}\\right)$ 处 $\\det\\mathbf{J}_e$ 的单个数值。最终的行列式以平方米为单位表示，并将答案四舍五入到四位有效数字。", "solution": "从参考域 $(\\xi, \\eta)$ 到物理域 $(x, y)$ 的等参映射由以下公式给出：\n$$x(\\xi,\\eta)=\\sum_{i=1}^{8}N_i(\\xi,\\eta)\\,x_i$$\n$$y(\\xi,\\eta)=\\sum_{i=1}^{8}N_i(\\xi,\\eta)\\,y_i$$\n其中 $N_i(\\xi,\\eta)$ 是八节点 Serendipity 四边形单元的形函数，$(x_i, y_i)$ 是单元节点的物理坐标。\n\n该变换的雅可比矩阵 $\\mathbf{J}_e$ 定义为：\n$$\\mathbf{J}_e(\\xi,\\eta) = \\begin{pmatrix} \\frac{\\partial x}{\\partial \\xi} & \\frac{\\partial x}{\\partial \\eta} \\\\ \\frac{\\partial y}{\\partial \\xi} & \\frac{\\partial y}{\\partial \\eta} \\end{pmatrix}$$\n为了推导 $\\mathbf{J}_e$ 的显式表达式，我们将映射方程对参考坐标 $\\xi$ 和 $\\eta$ 求导。由于对于给定的单元，节点坐标 $x_i$ 和 $y_i$ 是常数，我们得到：\n$$\\frac{\\partial x}{\\partial \\xi} = \\sum_{i=1}^{8} \\frac{\\partial N_i(\\xi,\\eta)}{\\partial \\xi} x_i \\quad , \\quad \\frac{\\partial x}{\\partial \\eta} = \\sum_{i=1}^{8} \\frac{\\partial N_i(\\xi,\\eta)}{\\partial \\eta} x_i$$\n$$\\frac{\\partial y}{\\partial \\xi} = \\sum_{i=1}^{8} \\frac{\\partial N_i(\\xi,\\eta)}{\\partial \\xi} y_i \\quad , \\quad \\frac{\\partial y}{\\partial \\eta} = \\sum_{i=1}^{8} \\frac{\\partial N_i(\\xi,\\eta)}{\\partial \\eta} y_i$$\n这可以写成矩阵形式：\n$$\\mathbf{J}_e(\\xi,\\eta) = \\begin{pmatrix} \\sum_{i=1}^{8} \\frac{\\partial N_i}{\\partial \\xi} x_i & \\sum_{i=1}^{8} \\frac{\\partial N_i}{\\partial \\eta} x_i \\\\ \\sum_{i=1}^{8} \\frac{\\partial N_i}{\\partial \\xi} y_i & \\sum_{i=1}^{8} \\frac{\\partial N_i}{\\partial \\eta} y_i \\end{pmatrix}$$\n这就是按要求用节点坐标和形函数的导数表示的 $\\mathbf{J}_e(\\xi, \\eta)$ 的显式表达式。\n\n对于具有标准节点编号（角点 $1$-$4$，边中点 $5$-$8$，逆时针）的八节点 Serendipity 单元，标准形函数 $N_i(\\xi, \\eta)$ 为：\n对于角节点 $i \\in \\{1,2,3,4\\}$，其局部坐标为 $(\\xi_i, \\eta_i) \\in \\{(\\pm 1, \\pm 1)\\}$：\n$$N_i(\\xi,\\eta) = \\frac{1}{4}(1+\\xi_i\\xi)(1+\\eta_i\\eta)(\\xi_i\\xi+\\eta_i\\eta-1)$$\n对于边 $\\eta = \\pm 1$ 上的边中节点 $i \\in \\{5,7\\}$，其局部坐标为 $(\\xi_i, \\eta_i) = (0, \\eta_i)$:\n$$N_i(\\xi,\\eta) = \\frac{1}{2}(1-\\xi^2)(1+\\eta_i\\eta)$$\n对于边 $\\xi = \\pm 1$ 上的边中节点 $i \\in \\{6,8\\}$，其局部坐标为 $(\\xi_i, \\eta_i) = (\\xi_i, 0)$:\n$$N_i(\\xi,\\eta) = \\frac{1}{2}(1-\\eta^2)(1+\\xi_i\\xi)$$\n\n这些形函数的导数为：\n对于角节点 $i \\in \\{1,2,3,4\\}$：\n$$\\frac{\\partial N_i}{\\partial \\xi} = \\frac{\\xi_i}{4}(1+\\eta_i\\eta)(2\\xi_i\\xi+\\eta_i\\eta) \\quad , \\quad \\frac{\\partial N_i}{\\partial \\eta} = \\frac{\\eta_i}{4}(1+\\xi_i\\xi)(2\\eta_i\\eta+\\xi_i\\xi)$$\n对于边中节点 $i \\in \\{5,7\\}$：\n$$\\frac{\\partial N_i}{\\partial \\xi} = -\\xi(1+\\eta_i\\eta) \\quad , \\quad \\frac{\\partial N_i}{\\partial \\eta} = \\frac{\\eta_i}{2}(1-\\xi^2)$$\n对于边中节点 $i \\in \\{6,8\\}$：\n$$\\frac{\\partial N_i}{\\partial \\xi} = \\frac{\\xi_i}{2}(1-\\eta^2) \\quad , \\quad \\frac{\\partial N_i}{\\partial \\eta} = -\\eta(1+\\xi_i\\xi)$$\n\n我们在高斯点 $(\\xi, \\eta) = (1/\\sqrt{3}, 1/\\sqrt{3})$ 处计算这些导数的值。物理节点坐标以米为单位给出：\n$x = \\{0, 4, 4.5, -0.5, 2, 4.25, 2, -0.25\\}$\n$y = \\{0, 0, 3, 3.5, 0, 1.5, 3.25, 1.75\\}$\n\n我们计算雅可比矩阵的分量：\n$J_{11} = \\frac{\\partial x}{\\partial \\xi} = \\sum_{i=1}^{8} \\frac{\\partial N_i}{\\partial \\xi} x_i = 2.25 + \\frac{\\sqrt{3}}{12}$\n$J_{12} = \\frac{\\partial x}{\\partial \\eta} = \\sum_{i=1}^{8} \\frac{\\partial N_i}{\\partial \\eta} x_i = \\frac{\\sqrt{3}}{12}$\n$J_{21} = \\frac{\\partial y}{\\partial \\xi} = \\sum_{i=1}^{8} \\frac{\\partial N_i}{\\partial \\xi} y_i = -0.125 - \\frac{\\sqrt{3}}{24}$\n$J_{22} = \\frac{\\partial y}{\\partial \\eta} = \\sum_{i=1}^{8} \\frac{\\partial N_i}{\\partial \\eta} y_i = 1.625 - \\frac{\\sqrt{3}}{24}$\n\n因此，在 $(\\xi, \\eta) = (1/\\sqrt{3}, 1/\\sqrt{3})$ 处的雅可比矩阵是：\n$$\\mathbf{J}_e\\left(\\frac{1}{\\sqrt{3}}, \\frac{1}{\\sqrt{3}}\\right) = \\begin{pmatrix} \\frac{9}{4} + \\frac{\\sqrt{3}}{12} & \\frac{\\sqrt{3}}{12} \\\\ -\\frac{1}{8} - \\frac{\\sqrt{3}}{24} & \\frac{13}{8} - \\frac{\\sqrt{3}}{24} \\end{pmatrix}$$\n行列式 $\\det\\mathbf{J}_e = J_{11}J_{22} - J_{12}J_{21}$ 计算如下：\n$$J_{11}J_{22} = \\left(\\frac{9}{4} + \\frac{\\sqrt{3}}{12}\\right)\\left(\\frac{13}{8} - \\frac{\\sqrt{3}}{24}\\right) = \\frac{117}{32} - \\frac{9\\sqrt{3}}{96} + \\frac{13\\sqrt{3}}{96} - \\frac{3}{288} = \\frac{350+4\\sqrt{3}}{96}$$\n$$J_{12}J_{21} = \\left(\\frac{\\sqrt{3}}{12}\\right)\\left(-\\frac{1}{8} - \\frac{\\sqrt{3}}{24}\\right) = -\\frac{\\sqrt{3}}{96} - \\frac{3}{288} = -\\frac{\\sqrt{3}+1}{96}$$\n$$\\det\\mathbf{J}_e = \\frac{350+4\\sqrt{3}}{96} - \\left(-\\frac{\\sqrt{3}+1}{96}\\right) = \\frac{350+4\\sqrt{3}+\\sqrt{3}+1}{96} = \\frac{351+5\\sqrt{3}}{96}$$\n为了证明 $\\mathbf{J}_e$ 在单元上是变化的，我们可以在另一点计算它的值，例如单元中心 $(\\xi, \\eta) = (0,0)$。在该点，形函数的导数大大简化：\n$\\frac{\\partial N_i}{\\partial \\xi}(0,0) = \\{0,0,0,0,0,1/2,0,-1/2\\}$\n$\\frac{\\partial N_i}{\\partial \\eta}(0,0) = \\{0,0,0,0,-1/2,0,1/2,0\\}$\n中心的雅可比矩阵为：\n$J_{11}(0,0) = \\frac{1}{2}x_6 - \\frac{1}{2}x_8 = \\frac{1}{2}(4.25 - (-0.25)) = 2.25$\n$J_{12}(0,0) = \\frac{1}{2}x_7 - \\frac{1}{2}x_5 = \\frac{1}{2}(2-2) = 0$\n$J_{21}(0,0) = \\frac{1}{2}y_6 - \\frac{1}{2}y_8 = \\frac{1}{2}(1.5 - 1.75) = -0.125$\n$J_{22}(0,0) = \\frac{1}{2}y_7 - \\frac{1}{2}y_5 = \\frac{1}{2}(3.25 - 0) = 1.625$\n所以，$\\mathbf{J}_e(0,0) = \\begin{pmatrix} 2.25 & 0 \\\\ -0.125 & 1.625 \\end{pmatrix}$。\n中心的行列式为 $\\det\\mathbf{J}_e(0,0) = (2.25)(1.625) - 0 = 3.65625\\,\\text{m}^2$。\n高斯点处的行列式为 $\\det\\mathbf{J}_e(1/\\sqrt{3}, 1/\\sqrt{3}) = \\frac{351+5\\sqrt{3}}{96} \\approx 3.74646\\,\\text{m}^2$。\n由于 $\\det\\mathbf{J}_e(1/\\sqrt{3}, 1/\\sqrt{3}) \\neq \\det\\mathbf{J}_e(0,0)$，我们证明了雅可比矩阵在单元域上不是常数。对于数值积分，例如组装单元刚度矩阵，必须在每个求积点（高斯点）计算其值。\n\n要求的最终数值是在 $(\\xi,\\eta)=\\left(1/\\sqrt{3},\\,1/\\sqrt{3}\\right)$ 处的 $\\det\\mathbf{J}_e$ 值，四舍五入到四位有效数字。\n$$\\det\\mathbf{J}_e = \\frac{351+5\\sqrt{3}}{96} \\approx \\frac{351+5(1.73205)}{96} = \\frac{351+8.66025}{96} = \\frac{359.66025}{96} \\approx 3.74646$$\n四舍五入到四位有效数字，该值为 $3.746$。单位是平方米。", "answer": "$$\n\\boxed{3.746}\n$$", "id": "3511568"}, {"introduction": "最后的实践将从手动计算过渡到数值研究，从而更深入地洞察雅可比矩阵变异性带来的实际后果。通过一个涉及弯曲映射的编程练习，您将量化雅可比行列式 $\\det J$ 的复杂性如何直接影响数值积分的精度。这个动手实验揭示了为何在处理扭曲或弯曲网格的模拟中，选择合适的求积规则对于获得精确结果至关重要。[@problem_id:3511595]", "problem": "本题要求您研究在与计算岩土力学相关的平面等参映射中，雅可比行列式的变异性对求积误差的影响。请从多重积分中的变量替换和雅可比矩阵的定义入手。考虑一个从参考正方形 $\\hat{\\Omega} = [-1,1]\\times[-1,1]$ 到一个由曲率幅值 $a \\in \\mathbb{R}$ 参数化的弯曲物理单元 $\\Omega$ 的光滑双射映射：\n$$\n\\boldsymbol{x}(\\boldsymbol{\\xi}) = \\begin{bmatrix}\nx(\\xi,\\eta) \\\\\ny(\\xi,\\eta)\n\\end{bmatrix} = \\begin{bmatrix}\n\\xi + \\dfrac{a}{2}(\\xi^2 - 1)\\,\\eta \\\\\n\\eta + \\dfrac{a}{2}\\,\\xi\\,(\\eta^2 - 1)\n\\end{bmatrix}, \\quad \\boldsymbol{\\xi} = \\begin{bmatrix}\\xi\\\\ \\eta\\end{bmatrix} \\in \\hat{\\Omega}.\n$$\n对于非零的 $a$，该构造在保持参考边界的同时扭曲了内部，并对弯曲的几何形状产生了非恒定的雅可比行列式。雅可比矩阵为 $J(\\boldsymbol{\\xi}) = \\dfrac{\\partial \\boldsymbol{x}}{\\partial \\boldsymbol{\\xi}}$，变量替换公式表明，对于一个足够光滑的标量场 $f(\\boldsymbol{x})$，\n$$\n\\int_{\\Omega} f(\\boldsymbol{x})\\, d\\boldsymbol{x} = \\int_{\\hat{\\Omega}} f(\\boldsymbol{x}(\\boldsymbol{\\xi}))\\, \\det J(\\boldsymbol{\\xi}) \\, d\\boldsymbol{\\xi}.\n$$\n\n为了分离 $\\det J(\\boldsymbol{\\xi})$ 在求积误差中的作用，我们考虑常数场 $f(\\boldsymbol{x}) = 1$ 的体积积分，从而\n$$\nI(a) \\equiv \\int_{\\Omega} 1\\, d\\boldsymbol{x} = \\int_{\\hat{\\Omega}} \\det J(\\boldsymbol{\\xi};a) \\, d\\boldsymbol{\\xi}.\n$$\n根据构造，当映射保持为正方形到自身的微分同胚时，$I(a)$ 等于正方形的面积，即 $I(a) = 4$，而 $\\det J(\\boldsymbol{\\xi};a)$ 量化了局部度量畸变。在 $\\hat{\\Omega}$ 上的数值求积采用 $q$ 阶的张量积高斯-勒让德法则，其横坐标为 $\\{\\xi_i\\}_{i=1}^q$、$\\{\\eta_j\\}_{j=1}^q$，权重为 $\\{w_i\\}_{i=1}^q$、$\\{w_j\\}_{j=1}^q$，从而得到近似值\n$\nI_q(a) = \\sum_{i=1}^{q} \\sum_{j=1}^{q} w_i w_j \\, \\det J(\\xi_i,\\eta_j;a).\n$\n由于 $f(\\boldsymbol{x})=1$，任何求积误差都完全源于 $\\det J(\\boldsymbol{\\xi};a)$ 在 $\\hat{\\Omega}$ 上的变异性和光滑性，以及所选的求积阶数 $q$。\n\n您的任务是编写一个完整的程序，该程序：\n- 实现上述映射 $\\boldsymbol{x}(\\boldsymbol{\\xi})$。\n- 推导并计算雅可比矩阵 $J(\\boldsymbol{\\xi})$ 及其行列式 $\\det J(\\boldsymbol{\\xi};a)$。\n- 使用 $q$ 阶张量积高斯-勒让德求积法近似计算 $I(a)$ 以获得 $I_q(a)$。\n- 使用一个通过在 $\\hat{\\Omega}$ 上进行高阶高斯-勒让德张量积求积计算得到的高精度参考值 $I_{\\text{ref}}(a)$，作为误差估计的基准。您必须以足够大的阶数数值构造 $I_{\\text{ref}}(a)$，以使其误差与目标求积阶数的误差相比可以忽略不计。\n- 计算绝对求积误差 $E(a,q) = \\lvert I_q(a) - I_{\\text{ref}}(a)\\rvert$。\n\n您可以使用的基本原理：\n- 多重积分的变量替换公式。\n- 雅可比矩阵及其行列式的定义。\n- 区间 $[-1,1]$ 上的高斯-勒让德求积及其张量积扩展的性质。\n\n设计一个包含曲率幅值和求积阶数的测试套件，以探究 $\\det J$ 的变异性对 $E(a,q)$ 的影响：\n- 曲率幅值 $a \\in \\{0, 0.25, 0.5, 0.9\\}$，涵盖从仿射映射到高度弯曲但非退化的几何形状。\n- 求积阶数 $q \\in \\{1,2,3\\}$，从低精度到中等精度。\n\n对于每对 $(a,q)$，其中 $a$ 按 $[0, 0.25, 0.5, 0.9]$ 的顺序迭代，对于每个 $a$，$q$ 按 $[1,2,3]$ 的顺序迭代，计算 $E(a,q)$。您的程序必须只输出一行结果，该结果是一个由方括号括起来的逗号分隔的浮点数列表，顺序如下：\n$$\n[E(0,1), E(0,2), E(0,3), E(0.25,1), E(0.25,2), E(0.25,3), E(0.5,1), E(0.5,2), E(0.5,3), E(0.9,1), E(0.9,2), E(0.9,3)].\n$$\n\n注意：\n- 由于积分是无量纲的，因此不需要物理单位。\n- 不使用角度。\n- 高阶参考求积必须在您的程序中选择，并在您的解题思路中说明理由，以确保与报告值相比其误差可以忽略不计。", "solution": "首先，我们推导雅可比矩阵 $J(\\boldsymbol{\\xi};a)$ 及其行列式。\n映射函数为：\n$x(\\xi,\\eta) = \\xi + \\frac{a}{2}(\\xi^2 - 1)\\eta$\n$y(\\xi,\\eta) = \\eta + \\frac{a}{2}\\xi(\\eta^2 - 1)$\n\n其偏导数为：\n$\\frac{\\partial x}{\\partial \\xi} = 1 + a\\xi\\eta$\n$\\frac{\\partial x}{\\partial \\eta} = \\frac{a}{2}(\\xi^2 - 1)$\n$\\frac{\\partial y}{\\partial \\xi} = \\frac{a}{2}(\\eta^2 - 1)$\n$\\frac{\\partial y}{\\partial \\eta} = 1 + a\\xi\\eta$\n\n雅可比行列式为：\n$$\n\\det J(\\boldsymbol{\\xi}; a) = \\frac{\\partial x}{\\partial \\xi}\\frac{\\partial y}{\\partial \\eta} - \\frac{\\partial x}{\\partial \\eta}\\frac{\\partial y}{\\partial \\xi} = (1 + a\\xi\\eta)^2 - \\frac{a^2}{4}(\\xi^2 - 1)(\\eta^2 - 1)\n$$\n展开后，$\\det J$ 是一个关于 $\\xi$ 和 $\\eta$ 的四次多项式。然而，对于固定的 $\\eta$，它是 $\\xi$ 的二次多项式；对于固定的 $\\xi$，它是 $\\eta$ 的二次多项式。\n\n一维 $q$ 点高斯-勒让德求积法则能精确积分最高 $2q-1$ 次的多项式。\n要对 $\\det J$ 进行二维积分 $\\int_{-1}^{1} \\int_{-1}^{1} \\det J(\\xi, \\eta) \\,d\\xi \\,d\\eta$，我们可以先对 $\\xi$ 积分。由于被积函数是 $\\xi$ 的二次多项式，当 $2q-1 \\ge 2$ (即 $q \\ge 2$) 时，求积是精确的。积分后的结果是 $\\eta$ 的一个二次多项式。同样，对这个结果关于 $\\eta$ 积分，当 $q \\ge 2$ 时也是精确的。因此，任何阶数 $q \\ge 2$ 的张量积高斯-勒让德求积都将精确计算该积分。\n\n该积分的精确值可以通过解析积分得到，结果为 $I(a) = 4$。因此，参考积分 $I_{\\text{ref}}(a) = 4$。对于 $q=2$ 和 $q=3$，数值积分是精确的，所以 $I_2(a) = 4$ 且 $I_3(a) = 4$。这意味着误差 $E(a,2)$ 和 $E(a,3)$ 在机器精度范围内为零。\n\n接下来，我们计算 $q=1$ 时的近似积分。一阶高斯求积使用单点 $(\\xi, \\eta) = (0,0)$，权重为 $w_1 w_1 = 2 \\times 2 = 4$。\n$$\nI_1(a) = 4 \\cdot \\det J(0,0;a) = 4 \\cdot \\left[ (1 + 0)^2 - \\frac{a^2}{4}(-1)(-1) \\right] = 4 \\left(1 - \\frac{a^2}{4}\\right) = 4 - a^2\n$$\n因此，一阶求积的绝对误差为：\n$$\nE(a,1) = |I_1(a) - I_{\\text{ref}}(a)| = |(4 - a^2) - 4| = a^2\n$$\n\n根据这个分析，我们可以直接计算出所有测试用例的误差：\n- $a=0.0$: $E(0,1)=0^2=0$, $E(0,2)=0$, $E(0,3)=0$\n- $a=0.25$: $E(0.25,1)=0.25^2=0.0625$, $E(0.25,2)=0$, $E(0.25,3)=0$\n- $a=0.5$: $E(0.5,1)=0.5^2=0.25$, $E(0.5,2)=0$, $E(0.5,3)=0$\n- $a=0.9$: $E(0.9,1)=0.9^2=0.81$, $E(0.9,2)=0$, $E(0.9,3)=0$\n\n这些值可以直接用于构建最终的输出列表，答案部分提供的程序是对该解析解的数值验证。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.special import roots_legendre\n\ndef solve():\n    \"\"\"\n    Computes the quadrature error for the integral of the Jacobian determinant\n    of a given isoparametric mapping.\n    \"\"\"\n\n    def det_J(xi, eta, a):\n        \"\"\"\n        Calculates the determinant of the Jacobian matrix for the given mapping.\n        The function is vectorized to accept numpy arrays for xi and eta.\n\n        The Jacobian determinant is det(J) = (1 + a*xi*eta)^2 - (a/2)^2 * (xi^2 - 1) * (eta^2 - 1).\n\n        Args:\n            xi (float or np.ndarray): The reference coordinate(s) in the first direction.\n            eta (float or np.ndarray): The reference coordinate(s) in the second direction.\n            a (float): The curvature amplitude.\n\n        Returns:\n            float or np.ndarray: The value(s) of the Jacobian determinant.\n        \"\"\"\n        term1 = (1 + a * xi * eta)**2\n        term2 = (a / 2)**2 * (xi**2 - 1) * (eta**2 - 1)\n        return term1 - term2\n\n    def compute_integral(a, q):\n        \"\"\"\n        Approximates the integral of det(J) over the reference square [-1,1]x[-1,1]\n        using a q-point tensor-product Gauss-Legendre quadrature rule.\n\n        Args:\n            a (float): The curvature amplitude.\n            q (int): The order of the Gauss-Legendre quadrature.\n\n        Returns:\n            float: The approximate value of the integral.\n        \"\"\"\n        # Get 1D Gauss-Legendre points and weights for the interval [-1, 1]\n        points, weights = roots_legendre(q)\n\n        # Create 2D grids of points and weights for the tensor-product rule\n        xi_grid, eta_grid = np.meshgrid(points, points)\n        w_xi_grid, w_eta_grid = np.meshgrid(weights, weights)\n\n        # Evaluate the integrand (det_J) at all quadrature points simultaneously\n        integrand_values = det_J(xi_grid, eta_grid, a)\n\n        # Compute the integral by summing the weighted integrand values\n        integral = np.sum(w_xi_grid * w_eta_grid * integrand_values)\n        return integral\n\n    # Define the test cases from the problem statement.\n    a_values = [0.0, 0.25, 0.5, 0.9]\n    q_values = [1, 2, 3]\n\n    # Set a high quadrature order for the reference integral.\n    # From analysis, q_ref >= 2 is sufficient for exactness.\n    # A larger value is used to be robust and follow the problem's spirit.\n    q_ref = 20\n\n    results = []\n    # Iterate through each parameter set to compute the errors.\n    for a in a_values:\n        # Compute the \"ground truth\" reference integral for the current 'a'.\n        I_ref = compute_integral(a, q_ref)\n        \n        for q in q_values:\n            # Compute the integral for the current test order 'q'.\n            I_q = compute_integral(a, q)\n            \n            # Calculate the absolute quadrature error and append to the list.\n            error = np.abs(I_q - I_ref)\n            results.append(error)\n            \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3511595"}]}