{"hands_on_practices": [{"introduction": "本练习旨在深入探讨稀疏直接求解器中的一个核心概念：重排序。通过在一个小规模的非结构化网格上，手动模拟自然排序和近似最小度（AMD）排序下的符号Cholesky分解过程，您将直观地理解重排序如何显著减少填充（fill-in）并降低计算成本。这项实践将揭示稀疏矩阵求解背后精巧的图论思想。[@problem_id:3538782]", "problem": "考虑一个来自计算岩土力学中标量扩散问题（例如，稳态渗流）的小型非结构化二维三角形网格。该问题在内部节点上使用线性有限元进行离散化，并应用了狄利克雷（Dirichlet）边界条件，使得组装后的全局刚度矩阵 $K$ 是实对称正定的。假设有 $7$ 个内部节点，标记为 $1$ 到 $7$，其单元连接关系由以下三角形给出：\n- $(1,2,3)$, $(1,3,4)$, $(1,4,5)$, $(1,5,6)$, $(1,6,7)$, $(1,7,2)$。\n假设每个节点只有一个自由度。在标准有限元组装下，$K$ 的对称稀疏模式由节点是否共属于一个单元决定：如果两个节点同时出现在至少一个三角形中，则 $K$ 中对应的非对角线元素在结构上是非零的。\n\n仅使用基本定义（$K$ 的图、用于Cholesky填充的对称消去图模型，以及消去一个节点会引入边以使其当前邻居成为一个团（clique）的思想），执行以下操作：\n\n1) 推导由上述连接关系所隐含的 $K$ 的对称稀疏（邻接）图。然后，在自然排序 $1,2,\\dots,7$ 下，通过依次消去节点 $1$ 到 $7$ 来执行符号Cholesky消去（图填充）。识别所有出现的填充边，并对于每个消去步骤 $j$，确定在消去节点 $j$ 的那一刻，它在尚未被消去的节点中的邻居数量 $l_j$。\n\n2) 通过在演化中的消去图上应用最小度启发式算法，构建一个近似最小度（AMD）排序，并通过选择最小索引的节点来处理并列情况。在此AMD排序下重复符号消去过程，列出引入的填充边，并确定该置换顺序下 $l_j$ 值的序列。\n\n3) 使用基于消去的外积形式的稀疏Cholesky分解的第一性原理运算量估计，证明主要的乘加运算次数与 $\\sum_{j=1}^{7} l_j^2$ 成正比。设 $S_{\\mathrm{nat}}$ 表示自然排序下的此总和，$S_{\\mathrm{amd}}$ 表示AMD排序下的总和。计算精确比值 $S_{\\mathrm{amd}}/S_{\\mathrm{nat}}$ 并将其表示为最简分数。无需四舍五入，也无需报告单位。你的最终答案必须是一个数字。", "solution": "该问题定义明确，具有科学依据，并包含了得出唯一解所需的所有信息。我们首先将问题设置形式化。\n\n内部节点集合为 $V = \\{1, 2, 3, 4, 5, 6, 7\\}$。刚度矩阵 $K$ 的对称稀疏模式由一个无向图 $G = (V, E)$ 表示，其中如果节点 $i$ 和 $j$ 出现在同一个三角形单元中，则存在一条边 $(i, j) \\in E$。给定的单元连接关系为：$(1,2,3)$, $(1,3,4)$, $(1,4,5)$, $(1,5,6)$, $(1,6,7)$ 和 $(1,7,2)$。\n\n首先，我们构建初始邻接图 $G_0 = (V, E_0)$。边是通过取每个三角形内所有节点对形成的：\n- 来自 $(1,2,3)$：边 $(1,2), (1,3), (2,3)$。\n- 来自 $(1,3,4)$：边 $(1,3), (1,4), (3,4)$。\n- 来自 $(1,4,5)$：边 $(1,4), (1,5), (4,5)$。\n- 来自 $(1,5,6)$：边 $(1,5), (1,6), (5,6)$。\n- 来自 $(1,6,7)$：边 $(1,6), (1,7), (6,7)$。\n- 来自 $(1,7,2)$：边 $(1,7), (1,2), (7,2)$。\n\n唯一的边集合 $E_0$ 是 $\\{(1,2), (1,3), (1,4), (1,5), (1,6), (1,7), (2,3), (3,4), (4,5), (5,6), (6,7), (7,2)\\}$。该图是一个轮图 $W_7$，其中节点 $1$ 是中心节点，节点 $2$ 到 $7$ 以环状形成外环。节点的初始度为：\n- $d(1) = 6$\n- $d(2) = d(3) = d(4) = d(5) = d(6) = d(7) = 3$\n\n对于被消去的节点 $j$，$l_j$ 是它在当前消去图中，仅考虑尚未被消去的节点集合时的邻居数量。节点 $j$ 的符号消去会在图中添加填充边，使得 $j$ 的邻居形成一个团（clique）。\n\n**1) 自然排序消去**\n\n自然排序为 $(1, 2, 3, 4, 5, 6, 7)$。我们在 $G_0$ 上执行符号消去。\n\n- **消去节点 $j=1$**：尚未消去的节点为 $\\{1, 2, 3, 4, 5, 6, 7\\}$。节点 $1$ 的邻居为 $\\{2, 3, 4, 5, 6, 7\\}$。因此，$l_1 = 6$。消去节点 $1$ 使其邻居成为一个团。这些邻居形成一个环 $2-3-4-5-6-7-2$。要使其成为一个团（$K_6$），我们必须添加所有的弦。引入的填充边为：$(2,4)$, $(2,5)$, $(2,6)$, $(3,5)$, $(3,6)$, $(3,7)$, $(4,6)$, $(4,7)$, 和 $(5,7)$。共有 $9$ 条填充边。在剩余节点 $\\{2, ..., 7\\}$ 上得到的消去图是一个完全图 $K_6$。\n\n- **消去节点 $j=2$**：尚未消去的节点为 $\\{2, 3, 4, 5, 6, 7\\}$，它们形成一个 $K_6$。节点 $2$ 的邻居为 $\\{3, 4, 5, 6, 7\\}$。因此，$l_2 = 5$。由于这些节点是 $K_6$ 的一部分，它们已经形成一个团（$K_5$）。没有引入新的填充边。\n\n- **消去节点 $j=3$**：尚未消去的节点为 $\\{3, 4, 5, 6, 7\\}$，形成一个 $K_5$。节点 $3$ 的邻居为 $\\{4, 5, 6, 7\\}$。因此，$l_3 = 4$。没有引入填充。\n\n- **消去节点 $j=4$**：尚未消去的节点形成一个 $K_4$。节点 $4$ 的邻居为 $\\{5, 6, 7\\}$。因此，$l_4 = 3$。没有填充。\n\n- **消去节点 $j=5$**：尚未消去的节点形成一个 $K_3$。节点 $5$ 的邻居为 $\\{6, 7\\}$。因此，$l_5 = 2$。没有填充。\n\n- **消去节点 $j=6$**：尚未消去的节点形成一个 $K_2$。节点 $6$ 的唯一邻居是 $\\{7\\}$。因此，$l_6 = 1$。没有填充。\n\n- **消去节点 $j=7$**：节点 $7$ 是最后一个节点。它在尚未消去的节点中没有邻居。因此，$l_7 = 0$。\n\n对于自然排序，邻居计数的序列为 $(l_1, l_2, l_3, l_4, l_5, l_6, l_7) = (6, 5, 4, 3, 2, 1, 0)$。\n\n**2) 近似最小度 (AMD) 排序消去**\n\n我们对演化中的消去图应用最小度启发式算法，选择当前未被消去节点中度最小的节点。通过选择索引最小的节点来打破并列。\n\n- **步骤 1**：在 $G_0$ 中，最小度为 $3$，由节点 $\\{2, 3, 4, 5, 6, 7\\}$ 共享。我们选择节点 $2$。排序中的第一个节点是 $p_1 = 2$。$l_2 = 3$。其邻居是 $\\{1, 3, 7\\}$。向图中添加一条填充边 $(3,7)$。\n\n- **步骤 2**：尚未消去的节点为 $\\{1, 3, 4, 5, 6, 7\\}$。在更新后的图中，度为 $d(1)=5$ 和 $d(3)=d(4)=d(5)=d(6)=d(7)=3$。最小度为 $3$，由 $\\{3, 4, 5, 6, 7\\}$ 共享。我们选择节点 $3$。第二个节点是 $p_2 = 3$。$l_3 = 3$。其邻居是 $\\{1, 4, 7\\}$。添加一条填充边 $(4,7)$。\n\n- **步骤 3**：尚未消去的节点为 $\\{1, 4, 5, 6, 7\\}$。度为 $d(1)=4$ 和 $d(4)=d(5)=d(6)=d(7)=3$。最小度为 $3$，由 $\\{4, 5, 6, 7\\}$ 共享。我们选择节点 $4$。第三个节点是 $p_3 = 4$。$l_4 = 3$。其邻居是 $\\{1, 5, 7\\}$。添加一条填充边 $(5,7)$。\n\n- **步骤 4**：尚未消去的节点为 $\\{1, 5, 6, 7\\}$。在更新后的图中，由于之前的填充，所有这些节点 $\\{1, 5, 6, 7\\}$ 的度现在都是 $3$。我们根据平局规则选择节点 $1$。第四个节点是 $p_4 = 1$。$l_1 = 3$。其邻居 $\\{5, 6, 7\\}$ 已经是一个团（边 $(5,6)$ 和 $(6,7)$ 是原始的，而 $(5,7)$ 是上一步的填充边）。没有引入新的填充。\n\n- **步骤 5**：尚未消去的节点为 $\\{5, 6, 7\\}$，它们形成一个团（$K_3$）。所有节点的度都为 $2$。我们选择节点 $5$。第五个节点是 $p_5 = 5$。$l_5 = 2$。没有新的填充。\n\n- **步骤 6**：尚未消去的节点为 $\\{6, 7\\}$，形成一个 $K_2$。两个节点的度都为 $1$。我们选择节点 $6$。第六个节点是 $p_6 = 6$。$l_6 = 1$。没有新的填充。\n\n- **步骤 7**：最后一个节点是 $p_7 = 7$。$l_7 = 0$。\n\nAMD排序为 $(2, 3, 4, 1, 5, 6, 7)$。引入的填充边是 $(3,7)$, $(4,7)$ 和 $(5,7)$，共 $3$ 条边。在此排序下，每个节点 $j$ 在其被消去时的邻居计数 $l_j$ 分别为：\n$l_1=3$, $l_2=3$, $l_3=3$, $l_4=3$, $l_5=2$, $l_6=1$, $l_7=0$。\n\n**3) 运算量计数与比值**\n\n运算量与 $\\sum_{j=1}^{n} l_j^2$ 成正比的理由来自Cholesky分解的外积形式。在步骤 $j$，算法消去节点 $j$。这对应于对与节点 $j$ 的邻居相关联的子矩阵进行秩-1更新。在填充后的图中，这 $l_j$ 个邻居形成一个团，对应于一个大小为 $l_j \\times l_j$ 的稠密子矩阵。执行此更新所需的浮点运算（乘加）次数与此子矩阵中的元素数量成正比，即 $l_j^2$ 阶。对所有消去步骤求和，得到总运算量与 $\\sum_{j=1}^{n} l_j^2$ 成正比。\n\n现在，我们计算两种排序的总和。\n\n对于自然排序：\n$$S_{\\mathrm{nat}} = \\sum_{j=1}^{7} l_j^2 = 6^2 + 5^2 + 4^2 + 3^2 + 2^2 + 1^2 + 0^2 = 36 + 25 + 16 + 9 + 4 + 1 + 0 = 91$$\n\n对于AMD排序，使用第2部分确定的 $l_j$ 值：\n$$S_{\\mathrm{amd}} = \\sum_{j=1}^{7} l_j^2 = l_1^2 + l_2^2 + l_3^2 + l_4^2 + l_5^2 + l_6^2 + l_7^2$$\n$$S_{\\mathrm{amd}} = 3^2 + 3^2 + 3^2 + 3^2 + 2^2 + 1^2 + 0^2 = 9 + 9 + 9 + 9 + 4 + 1 + 0 = 41$$\n\n比值为：\n$$\\frac{S_{\\mathrm{amd}}}{S_{\\mathrm{nat}}} = \\frac{41}{91}$$\n数字 $41$ 是一个质数。$91$ 的质因数分解是 $7 \\times 13$。由于 $41$ 不能被 $7$ 或 $13$ 整除，该分数是最简分数。", "answer": "$$\\boxed{\\frac{41}{91}}$$", "id": "3538782"}, {"introduction": "在采用迭代法求解大型线性系统时，一个关键的实际问题是：我们何时可以停止迭代？本练习将引导您推导出一个严格的数学关系，用以连接可计算的代数残差范数与物理上有意义的位移误差能量范数。通过这个推导，您将理解预条件子如何影响解的质量评估，并为在工程实践中设定可靠的收敛判据提供理论基础。[@problem_id:3538755]", "problem": "考虑一个有界Lipschitz域上的小应变线性弹性问题，该问题通过有限元方法（FEM）进行离散。在齐次Dirichlet边界条件下，离散平衡可以写为线性系统 $A u = b$，其中 $A \\in \\mathbb{R}^{n \\times n}$ 是对称正定（SPD）刚度矩阵，由线性弹性的标准双线性形式通过虚功原理组装而成；$u \\in \\mathbb{R}^{n}$ 是节点位移向量；$b \\in \\mathbb{R}^{n}$ 是一致载荷向量。令 $u^{\\star}$ 表示系统的精确离散解，$u_{k}$ 是由Krylov求解器（如共轭梯度（CG）方法）产生的迭代解。定义位移误差 $e_{k} = u^{\\star} - u_{k}$ 和代数残差 $r_{k} = b - A u_{k}$。考虑由刚度矩阵诱导的能量范数 $\\|v\\|_{A} = \\sqrt{v^{\\top} A v}$，以及由一个SPD预条件子 $M \\in \\mathbb{R}^{n \\times n}$ 定义的预处理残差范数 $\\|w\\|_{M^{-1}} = \\sqrt{w^{\\top} M^{-1} w}$。假设预条件子与刚度矩阵谱等价，即存在正常数 $\\alpha$ 和 $\\beta$，使得对于所有 $v \\in \\mathbb{R}^{n}$，\n$$\n\\alpha \\, v^{\\top} A v \\leq v^{\\top} M v \\leq \\beta \\, v^{\\top} A v.\n$$\n在实践中，通常使用基于残差范数的停止准则 $\\|r_{k}\\|_{M^{-1}} \\leq \\varepsilon$，而应用驱动的验证则倾向于控制位移误差的能量范数 $\\|e_{k}\\|_{A}$。仅从上述基本定义和事实出发，推导最佳常数 $C$（仅用 $\\alpha$ 和 $\\beta$ 表示），使得不等式\n$$\n\\|e_{k}\\|_{A} \\leq C \\, \\|r_{k}\\|_{M^{-1}}\n$$\n对所有迭代解 $u_{k}$ 和所有右端项 $b$ 均成立。你的最终答案必须是 $C$ 关于 $\\alpha$ 和 $\\beta$ 的单个闭式解析表达式。不需要进行数值计算，也不涉及单位。", "solution": "问题要求推导最佳常数 $C$，使得 $\\|e_{k}\\|_{A} \\leq C \\, \\|r_{k}\\|_{M^{-1}}$ 成立。我们首先验证问题陈述的有效性。\n\n### 步骤1：提取已知条件\n- **线性系统**：$A u = b$，其中 $A$ 是 $\\mathbb{R}^{n \\times n}$ 中的对称正定（SPD）矩阵。\n- **精确解**：$u^{\\star}$，满足 $A u^{\\star} = b$。\n- **迭代解**：$u_{k}$。\n- **位移误差**：$e_{k} = u^{\\star} - u_{k}$。\n- **代数残差**：$r_{k} = b - A u_{k}$。\n- **能量范数**：$\\|v\\|_{A} = \\sqrt{v^{\\top} A v}$。\n- **预条件子**：$M \\in \\mathbb{R}^{n \\times n}$ 是一个SPD矩阵。\n- **预处理残差范数**：$\\|w\\|_{M^{-1}} = \\sqrt{w^{\\top} M^{-1} w}$。注意，由于 $M$ 是SPD矩阵，$M^{-1}$ 也是SPD矩阵，因此该范数是良定义的。\n- **谱等价**：存在正常数 $\\alpha$ 和 $\\beta$，使得对于所有 $v \\in \\mathbb{R}^{n}$，以下不等式成立：\n$$\n\\alpha \\, v^{\\top} A v \\leq v^{\\top} M v \\leq \\beta \\, v^{\\top} A v.\n$$\n\n### 步骤2：使用提取的已知条件进行验证\n该问题具有科学依据，是适定且客观的。这是有限元方法迭代求解器分析中的一个标准问题。给定的信息是自洽的，在数学上是一致的。范数、矩阵和谱等价的定义在数值线性代数和计算力学中是标准的。未发现任何缺陷。\n\n### 步骤3：结论与行动\n问题有效。我们开始求解。\n\n我们寻求满足不等式 $\\|e_{k}\\|_{A} \\leq C \\, \\|r_{k}\\|_{M^{-1}}$ 的最小常数 $C$，该不等式对所有可能的迭代解 $u_k$ 和右端项 $b$ 均成立。处理范数的平方会更方便。该不等式等价于找到最小的 $C^2$，使得 $\\|e_{k}\\|_{A}^2 \\leq C^2 \\, \\|r_{k}\\|_{M^{-1}}^2$。这个常数 $C^2$ 可以表示为在所有可能的非零误差和残差上，范数平方之比的上确界：\n$$\nC^2 = \\sup_{u_k \\neq u^{\\star}} \\frac{\\|e_{k}\\|_{A}^2}{\\|r_{k}\\|_{M^{-1}}^2}\n$$\n首先，我们建立误差 $e_k$ 和残差 $r_k$ 之间的关系。根据它们的定义：\n$$\nr_{k} = b - A u_{k}\n$$\n由于 $b = A u^{\\star}$，我们可以将其代入残差的表达式中：\n$$\nr_{k} = A u^{\\star} - A u_{k} = A (u^{\\star} - u_{k}) = A e_{k}\n$$\n这个基本关系 $r_k = A e_k$ 将残差与误差联系起来。由于刚度矩阵 $A$ 是可逆的（因为它是SPD矩阵），我们也可以写出 $e_k = A^{-1} r_k$。\n\n现在，让我们用残差 $r_k$ 来表示误差的能量范数平方 $\\|e_{k}\\|_{A}^2$：\n$$\n\\|e_{k}\\|_{A}^2 = e_{k}^{\\top} A e_{k} = (A^{-1} r_{k})^{\\top} A (A^{-1} r_{k}) = r_{k}^{\\top} (A^{-1})^{\\top} A A^{-1} r_{k}\n$$\n由于 $A$ 是对称的，其逆矩阵 $A^{-1}$ 也是对称的，所以 $(A^{-1})^{\\top} = A^{-1}$。表达式简化为：\n$$\n\\|e_{k}\\|_{A}^2 = r_{k}^{\\top} A^{-1} A A^{-1} r_{k} = r_{k}^{\\top} A^{-1} r_{k}\n$$\n预处理残差范数的平方由其定义给出：\n$$\n\\|r_{k}\\|_{M^{-1}}^2 = r_{k}^{\\top} M^{-1} r_{k}\n$$\n将这些表达式代入 $C^2$ 的公式中：\n$$\nC^2 = \\sup_{r_{k} \\neq 0} \\frac{r_{k}^{\\top} A^{-1} r_{k}}{r_{k}^{\\top} M^{-1} r_{k}}\n$$\n注意，如果 $u_k \\neq u^{\\star}$，那么 $e_k \\neq 0$，并且由于 $A$ 是可逆的，$r_k = A e_k \\neq 0$。因此，上确界是在所有非零残差向量 $r_k \\in \\mathbb{R}^n$ 上取的。\n\n$C^2$ 的表达式是矩阵 $A^{-1}$ 和 $M^{-1}$ 的广义瑞利商。该商的上确界是广义特征值问题 的最大特征值 $\\lambda_{\\max}$：\n$$\nA^{-1} w = \\lambda M^{-1} w\n$$\n由于 $M^{-1}$ 是SPD矩阵，因此是可逆的，我们可以用 $M$ 左乘：\n$$\nM A^{-1} w = \\lambda w\n$$\n这表明 $C^2$ 是矩阵 $M A^{-1}$ 的最大特征值。我们现在必须将 $M A^{-1}$ 的特征值与给定的谱等价常数 $\\alpha$ 和 $\\beta$ 联系起来。\n\n谱等价条件 $\\alpha \\, v^{\\top} A v \\leq v^{\\top} M v \\leq \\beta \\, v^{\\top} A v$ 等价于表述广义特征值问题 $M v = \\gamma A v$ 的特征值位于区间 $[\\alpha, \\beta]$ 内。让我们来证明这个联系。矩阵对 $(M, A)$ 的特征值 $\\gamma$ 与矩阵 $A^{-1/2} M A^{-1/2}$ 的特征值相同，因为 $Mv = \\gamma Av$ 等价于 $(A^{-1/2}MA^{-1/2})(A^{1/2}v) = \\gamma(A^{1/2}v)$。在给定的不等式中，令 $v = A^{-1/2}x$，可得 $\\alpha x^\\top x \\leq x^\\top (A^{-1/2} M A^{-1/2}) x \\leq \\beta x^\\top x$，根据对称矩阵 $A^{-1/2} M A^{-1/2}$ 的瑞利商原理，这证实了其特征值在 $[\\alpha, \\beta]$ 内。\n\n现在，考虑我们感兴趣的矩阵的特征值问题 $M A^{-1} w = \\lambda w$。我们定义一个新向量 $v = A^{-1} w$。由于 $A$ 是可逆的，任何向量 $v$ 都可以这样表示。将 $w = A v$ 代入特征值方程得到：\n$$\nM A^{-1} (A v) = \\lambda (A v)\n$$\n$$\nM v = \\lambda A v\n$$\n这正是矩阵对 $(M, A)$ 的广义特征值问题。这表明矩阵 $M A^{-1}$ 的特征值 $\\lambda$ 与矩阵对 $(M, A)$ 的广义特征值 $\\gamma$ 完全相同。\n\n因此，$M A^{-1}$ 的特征值包含在区间 $[\\alpha, \\beta]$ 内。因此，$M A^{-1}$ 的最大特征值的上界为 $\\beta$：\n$$\n\\lambda_{\\max}(M A^{-1}) \\leq \\beta\n$$\n这意味着 $C^2 = \\sup_{r_{k} \\neq 0} \\frac{r_{k}^{\\top} A^{-1} r_{k}}{r_{k}^{\\top} M^{-1} r_{k}} = \\lambda_{\\max}(M A^{-1}) \\leq \\beta$。\n\n要成为“最佳”常数，上确界必须是可达的。谱等价的定义意味着，对于任何给定的 $\\alpha, \\beta > 0$，可以构造矩阵 $A$ 和 $M$，使得相关的广义特征值问题 $Mv = \\lambda Av$ 的谱恰好覆盖区间 $[\\alpha, \\beta]$。在这种情况下，最大特征值将恰好是 $\\beta$。因此，$\\lambda_{\\max}(M A^{-1})$ 的最紧上界是 $\\beta$。\n\n我们得出结论，最佳常数 $C^2$ 是 $\\beta$。\n$$\nC^2 = \\beta\n$$\n取平方根得到常数 $C$：\n$$\nC = \\sqrt{\\beta}\n$$\n这个常数保证了对于任何满足给定条件的问题，都有 $\\|e_{k}\\|_{A} \\leq \\sqrt{\\beta} \\, \\|r_{k}\\|_{M^{-1}}$ 成立，并且没有更小的常数能提供同样的普适保证。", "answer": "$$\\boxed{\\sqrt{\\beta}}$$", "id": "3538755"}, {"introduction": "计算岩土力学中的多物理场问题，如孔隙弹性和不可压缩性，通常会导致复杂的鞍点线性系统。本练习探讨了离散化方法的稳定性（由LBB条件保证）与最终代数系统的性质之间的深刻联系。通过分析稳定和不稳定单元对的舒尔补（Schur complement）算子的谱特性，您将理解“棋盘格”压力锁定等数值问题的根源，并认识到为何基于舒尔补的求解策略对于这类问题至关重要。[@problem_id:3538765]", "problem": "在计算地质力学中使用的准不可压缩线性弹性的混合位移-压力格式中，在尺寸为 $h$ 的拟一致网格上的有限元离散化得到如下分块系统\n$$\n\\begin{bmatrix}\nK_h  & B_h^{T} \\\\\nB_h  & -C_h\n\\end{bmatrix}\n\\begin{bmatrix}\n\\boldsymbol{u}_h \\\\\n\\boldsymbol{p}_h\n\\end{bmatrix}\n=\n\\begin{bmatrix}\n\\boldsymbol{f}_h \\\\\n\\boldsymbol{g}_h\n\\end{bmatrix},\n$$\n其中 $K_h$ 是与线性弹性（剪切模量 $\\mu>0$）导出的对称双线性形式 $a(\\boldsymbol{u},\\boldsymbol{v})$ 相关联的刚度矩阵，$B_h$ 表示通过双线性形式 $b(\\boldsymbol{v},q)$ 的离散散度耦合，而 $C_h$ 汇集了来自可压缩性或稳定化的压力项。假设 $a(\\cdot,\\cdot)$ 在离散位移空间 $V_h$ 上是对称正定的，并且 $b(\\cdot,\\cdot)$ 在 $V_h \\times Q_h$ 上是连续的，其中 $Q_h$ 是离散压力空间。离散 Ladyzhenskaya–Babuška–Brezzi (LBB) inf–sup 条件为\n$$\n\\inf_{0 \\neq q_h \\in Q_h} \\sup_{0 \\neq \\boldsymbol{v}_h \\in V_h} \\frac{b(\\boldsymbol{v}_h,q_h)}{\\|\\boldsymbol{v}_h\\|_{V} \\, \\|q_h\\|_{Q}} \\ge \\beta_h,\n$$\n其中范数 $\\|\\cdot\\|_{V}$ 由 $a(\\cdot,\\cdot)$ 导出，而 $\\|\\cdot\\|_{Q}$ 取为压力上的 $L^{2}$ 范数。关于压力的离散 Schur 补为\n$$\nS_h \\coloneqq B_h K_h^{-1} B_h^{T} + C_h.\n$$\n在一族拟一致网格上考虑两种单元对：一种是稳定的选择，满足一个与 $h$ 无关的一致 inf-sup 界 $\\beta_h \\ge \\beta_0 > 0$（例如，Taylor–Hood $P_2$–$P_1$）；另一种是不稳定的等阶选择，没有进行稳定化处理（例如，$P_1$–$P_1$），对其而言当 $h \\to 0$ 时 $\\beta_h \\to 0$。令 $M_p$ 表示压力质量矩阵，它在 $Q_h$ 上导出离散 $L^{2}$ 内积。你需要通过分析这些单元对的 $S_h$ 的谱以及为控制伪压力模式而设计的一致性稳定化 $C_h$ 的效果，将 inf-sup 稳定性与离散代数稳定性联系起来。选择所有正确的陈述。\n\nA. 如果离散 LBB 常数关于 $h$ 一致地满足 $\\beta_h \\ge \\beta_0 > 0$，那么存在与网格无关的常数 $c, C > 0$（可能依赖于材料参数），使得对于所有 $\\boldsymbol{p}_h$，\n$$\nc\\, \\boldsymbol{p}_h^{T} M_p \\boldsymbol{p}_h \\le \\boldsymbol{p}_h^{T} S_h \\boldsymbol{p}_h \\le C\\, \\boldsymbol{p}_h^{T} M_p \\boldsymbol{p}_h,\n$$\n因此 $S_h$ 与 $M_p$ 谱等价。\n\nB. 对于一个没有稳定化的不稳定等阶对，当 $h \\to 0$ 时，最小特征值 $\\lambda_{\\min}(S_h)$ 趋于 $0$，并且相关的特征向量包含振荡的、近似无散度的“棋盘格”压力模式，这些模式与位移是弱耦合的。\n\nC. 如果用一个满足尺度关系 $\\boldsymbol{p}_h^{T} C_h \\boldsymbol{p}_h \\simeq h^{2} \\|\\nabla p_h\\|_{0}^{2}$ 的一致性压力稳定化 $C_h$ 来增强一个不稳定的等阶格式，那么 $S_h$ 在 $M_p$-内积意义下获得一个一致的谱下界，而不会引起其相对于 $M_p$ 的最大特征值出现 $O(h^{-2})$ 的增长。\n\nD. 当用 $M_p^{-1}$ 对 $S_h$ 进行预处理时，即使当 $h \\to 0$ 时 $\\beta_h \\to 0$，共轭梯度（CG）迭代的次数也与网格无关，因为 Krylov 方法对小特征值不敏感。\n\nE. 对于任何离散空间对，$S_h$ 的最小正特征值精确地等于 $\\beta_h^{2}$（最多相差一个固定的乘性材料常数），因此在离散情形下 $\\lambda_{\\min}(S_h) = \\beta_h^{2}$ 作为一个恒等式成立。", "solution": "用户提供了一个关于准不可压缩线性弹性的混合有限元格式的稳定性和代数性质的问题陈述。我的任务是验证该问题，然后对每个选项提供详细的分析。\n\n### 问题验证\n\n**步骤 1：提取已知条件**\n-   有限元离散化产生的控制分块系统是：\n    $$\n    \\begin{bmatrix}\n    K_h  & B_h^{T} \\\\\n    B_h  & -C_h\n    \\end{bmatrix}\n    \\begin{bmatrix}\n    \\boldsymbol{u}_h \\\\\n    \\boldsymbol{p}_h\n    \\end{bmatrix}\n    =\n    \\begin{bmatrix}\n    \\boldsymbol{f}_h \\\\\n    \\boldsymbol{g}_h\n    \\end{bmatrix}\n    $$\n-   $K_h$：刚度矩阵，来自位移空间 $V_h$ 上的对称正定双线性形式 $a(\\cdot,\\cdot)$。剪切模量为 $\\mu > 0$。\n-   $B_h$：离散散度矩阵，来自 $V_h \\times Q_h$ 上的连续双线性形式 $b(\\cdot,\\cdot)$。\n-   $C_h$：压力项矩阵（可压缩性或稳定化）。\n-   离散 Ladyzhenskaya–Babuška–Brezzi (LBB) inf-sup 条件：\n    $$\n    \\inf_{0 \\neq q_h \\in Q_h} \\sup_{0 \\neq \\boldsymbol{v}_h \\in V_h} \\frac{b(\\boldsymbol{v}_h,q_h)}{\\|\\boldsymbol{v}_h\\|_{V} \\, \\|q_h\\|_{Q}} \\ge \\beta_h\n    $$\n    其中 $\\|\\cdot\\|_{V}$ 是由 $a(\\cdot,\\cdot)$ 导出的范数，$\\|\\cdot\\|_{Q}$ 是 $L^{2}$ 范数。\n-   关于压力的离散 Schur 补：$S_h \\coloneqq B_h K_h^{-1} B_h^{T} + C_h$。\n-   在尺寸为 $h$ 的拟一致网格上考虑两种单元类型：\n    1.  一个稳定的单元对，具有一致的 inf-sup 界 $\\beta_h \\ge \\beta_0 > 0$。\n    2.  一个不稳定的等阶单元对，没有稳定化，当 $h \\to 0$ 时 $\\beta_h \\to 0$。\n-   $M_p$：压力质量矩阵，在 $Q_h$ 上导出离散 $L^2$ 内积。\n-   问题是选择所有关于 $S_h$ 的谱和稳定化效果的正确陈述。\n\n**步骤 2：使用提取的已知条件进行验证**\n-   **科学上可靠**：该问题牢固地植根于针对鞍点问题的混合有限元方法的成熟理论中，这是计算力学和偏微分方程数值分析的核心主题。其格式、定义（LBB 条件，Schur 补）和示例（Taylor-Hood，等阶单元）都是标准且正确的。\n-   **适定性**：该问题提供了一个清晰的理论框架，并要求分析其性质。将泛函分析的 LBB 条件与离散 Schur 补的谱性质联系起来的问题是一个定义明確的数学问题。\n-   **客观性**：语言形式化、精确，并使用该领域的标准术语，没有任何主观性。\n\n问题陈述通过了所有验证标准。这是一个来自高等数值分析的标准、有效的问题。\n\n**步骤 3：结论与行动**\n问题有效。我将继续进行解答。\n\n### 推导与选项分析\n\n问题的核心在于离散 LBB 常数 $\\beta_h$ 与 Schur 补 $S_h$ 的谱性质之间的关系，特别是与压力质量矩阵 $M_p$ 的关系。\n\n首先，我们建立关键关系。由 $a(\\cdot,\\cdot)$ 导出的范数 $\\|\\boldsymbol{v}_h\\|_V$ 在代数上对应于 $\\sqrt{\\boldsymbol{v}_h^T K_h \\boldsymbol{v}_h}$。范数 $\\|q_h\\|_Q$ 是 $L^2$ 范数，对应于 $\\sqrt{\\boldsymbol{p}_h^T M_p \\boldsymbol{p}_h}$。双线性形式 $b(\\boldsymbol{v}_h, q_h)$ 对应于 $\\boldsymbol{p}_h^T B_h \\boldsymbol{v}_h$。\n\nLBB 条件可以被证明等价于 $B_h K_h^{-1} B_h^T$ 在 $M_p$-内积下的 Rayleigh 商的一个界。根据离散空间 $V_h$ 上的 Riesz 表示定理，对于任意 $p_h \\in Q_h$，存在唯一的 $\\boldsymbol{w}_{p_h} \\in V_h$ 使得对于所有 $\\boldsymbol{v}_h \\in V_h$ 有 $a(\\boldsymbol{w}_{p_h}, \\boldsymbol{v}_h) = b(\\boldsymbol{v}_h, p_h)$，并且 $\\|\\boldsymbol{w}_{p_h}\\|_V = \\sup_{\\boldsymbol{v}_h \\neq 0} \\frac{b(\\boldsymbol{v}_h, p_h)}{\\|\\boldsymbol{v}_h\\|_V}$。在代数上，这表示为 $K_h \\boldsymbol{w}_{p_h} = B_h^T \\boldsymbol{p}_h$。\n\n对 LBB 条件平方并对 $p_h$ 取下确界，我们得到：\n$$\n\\beta_h^2 \\le \\inf_{p_h \\neq 0} \\frac{\\left( \\sup_{\\boldsymbol{v}_h \\neq 0} \\frac{b(\\boldsymbol{v}_h, p_h)}{\\|\\boldsymbol{v}_h\\|_V} \\right)^2}{\\|p_h\\|_Q^2} = \\inf_{p_h \\neq 0} \\frac{\\|\\boldsymbol{w}_{p_h}\\|_V^2}{\\|p_h\\|_Q^2} = \\inf_{\\boldsymbol{p}_h \\neq 0} \\frac{(B_h^T \\boldsymbol{p}_h)^T K_h^{-1} (B_h^T \\boldsymbol{p}_h)}{\\boldsymbol{p}_h^T M_p \\boldsymbol{p}_h}\n$$\n这个下确界正是广义特征值问题 $(B_h K_h^{-1} B_h^T) \\boldsymbol{p}_h = \\lambda M_p \\boldsymbol{p}_h$ 的最小特征值。所以，$\\lambda_{\\min}(M_p^{-1} B_h K_h^{-1} B_h^T) \\ge \\beta_h^2$。实际上，这里等号成立。\n\n类似地，$b(\\cdot,\\cdot)$ 的连续性，即 $|b(\\boldsymbol{v}_h, q_h)| \\le C_b \\|\\boldsymbol{v}_h\\|_V \\|q_h\\|_Q$ 对于一个与网格无关的常数 $C_b$ 成立，意味着一个上界：\n$$\n\\lambda_{\\max}(M_p^{-1} B_h K_h^{-1} B_h^T) \\le C_b^2\n$$\n矩阵 $C_h$ 假定为半正定的，因为它源于物理上的可压缩性或数值稳定化。\n\n**A. 如果离散 LBB 常数关于 $h$ 一致地满足 $\\beta_h \\ge \\beta_0 > 0$，那么存在与网格无关的常数 $c, C > 0$（可能依赖于材料参数），使得对于所有 $\\boldsymbol{p}_h$, $c\\, \\boldsymbol{p}_h^{T} M_p \\boldsymbol{p}_h \\le \\boldsymbol{p}_h^{T} S_h \\boldsymbol{p}_h \\le C\\, \\boldsymbol{p}_h^{T} M_p \\boldsymbol{p}_h$, 因此 $S_h$ 与 $M_p$ 谱等价。**\n\n对于下界，我们使用推导出的关系和 $C_h$ 的半正定性：\n$$\n\\boldsymbol{p}_h^T S_h \\boldsymbol{p}_h = \\boldsymbol{p}_h^T B_h K_h^{-1} B_h^T \\boldsymbol{p}_h + \\boldsymbol{p}_h^T C_h \\boldsymbol{p}_h \\ge \\boldsymbol{p}_h^T B_h K_h^{-1} B_h^T \\boldsymbol{p}_h\n$$\n除以 $\\boldsymbol{p}_h^T M_p \\boldsymbol{p}_h$ 并取下确界得到：\n$$\n\\inf_{\\boldsymbol{p}_h \\neq 0} \\frac{\\boldsymbol{p}_h^T S_h \\boldsymbol{p}_h}{\\boldsymbol{p}_h^T M_p \\boldsymbol{p}_h} \\ge \\inf_{\\boldsymbol{p}_h \\neq 0} \\frac{\\boldsymbol{p}_h^T B_h K_h^{-1} B_h^T \\boldsymbol{p}_h}{\\boldsymbol{p}_h^T M_p \\boldsymbol{p}_h} \\ge \\beta_h^2 \\ge \\beta_0^2\n$$\n因此，我们可以设 $c = \\beta_0^2 > 0$。\n对于上界：\n$$\n\\frac{\\boldsymbol{p}_h^T S_h \\boldsymbol{p}_h}{\\boldsymbol{p}_h^T M_p \\boldsymbol{p}_h} = \\frac{\\boldsymbol{p}_h^T B_h K_h^{-1} B_h^T \\boldsymbol{p}_h}{\\boldsymbol{p}_h^T M_p \\boldsymbol{p}_h} + \\frac{\\boldsymbol{p}_h^T C_h \\boldsymbol{p}_h}{\\boldsymbol{p}_h^T M_p \\boldsymbol{p}_h}\n$$\n第一项的上界为 $C_b^2$。第二项代表可压缩性或稳定化，对于稳定单元，它被设计成良态的。例如，如果 $C_h = \\frac{1}{\\kappa}M_p$ (其中 $\\kappa$ 为体积模量)，其对比值的贡献就是 $1/\\kappa$。如果 $C_h=0$ (不需要稳定化)，贡献为零。在任何标准情况下，此项都由一个与网格无关的常数（比如 $C_{stab}$）为界。因此，整个表达式的上界为 $C = C_b^2 + C_{stab}$。由于下界和上界都是与网格无关的正数，因此 $S_h$ 与 $M_p$ 谱等价。\n**结论：正确。**\n\n**B. 对于一个没有稳定化的不稳定等阶对，当 $h \\to 0$ 时，最小特征值 $\\lambda_{\\min}(S_h)$ 趋于 $0$，并且相关的特征向量包含振荡的、近似无散度的“棋盘格”压力模式，这些模式与位移是弱耦合的。**\n\n如果单元对不稳定，则当 $h \\to 0$ 时 $\\beta_h \\to 0$。我们假设没有稳定化，所以考虑 $C_h=0$（或者一个不提供稳定性的微小可压缩性项）。那么 $S_h \\approx B_h K_h^{-1} B_h^T$。$M_p^{-1} S_h$ 的最小特征值约为 $\\beta_h^2$，它趋向于 $0$。这意味着当 $h \\to 0$ 时，$S_h$ 在 $M_p$-范数下变得奇异或近奇异。使得 Rayleigh 商 $\\frac{{\\boldsymbol{p}_h^*}^T S_h \\boldsymbol{p}_h^*}{{\\boldsymbol{p}_h^*}^T M_p \\boldsymbol{p}_h^*}$ 很小的模式 $\\boldsymbol{p}_h^*$ 就是伪压力模式。对于像 $P_1-P_1$ 这样的等阶单元，这些模式已知是高度振荡的模式，通常称为“棋盘格”模式。这些模式 $p_h^*$ 位于离散散度算子的近似核空间中，意味着 $B_h^T \\boldsymbol{p}_h^* \\approx \\boldsymbol{0}$。这有两个后果：1) $S_h \\boldsymbol{p}_h^* \\approx \\boldsymbol{0}$，使得 $\\boldsymbol{p}_h^*$ 成为一个特征值接近零的特征向量。2) 系统矩阵第一分块行中的耦合项 $B_h^T \\boldsymbol{p}_h$ 对这些模式很小，意味着它们与位移场 $\\boldsymbol{u}_h$ 是弱耦合的。该陈述准确地描述了这一现象。\n**结论：正确。**\n\n**C. 如果用一个满足尺度关系 $\\boldsymbol{p}_h^{T} C_h \\boldsymbol{p}_h \\simeq h^{2} \\|\\nabla p_h\\|_{0}^{2}$ 的一致性压力稳定化 $C_h$ 来增强一个不稳定的等阶格式，那么 $S_h$ 在 $M_p$-内积意义下获得一个一致的谱下界，而不会引起其相对于 $M_p$ 的最大特征值出现 $O(h^{-2})$ 的增长。**\n\n稳定化的目的是控制在 B 中识别出的伪模式。对于这些振荡模式 $p_h^*$，一个标准结果是它们的梯度很大：$\\|\\nabla p_h^*\\|_{0} \\sim h^{-1} \\|p_h^*\\|_{0}$。对于这类模式，稳定化项提供了控制：\n$$\n\\boldsymbol{p}_h^{*T} C_h \\boldsymbol{p}_h^* \\simeq h^{2} \\|\\nabla p_h^*\\|_{0}^{2} \\sim h^2 (h^{-1} \\|p_h^*\\|_{0})^2 = \\|p_h^*\\|_{0}^2 \\simeq \\boldsymbol{p}_h^{*T} M_p \\boldsymbol{p}_h^*\n$$\n这意味着，对于那些不受 $B_h K_h^{-1} B_h^T$ 控制的模式， $C_h$ 项对 $\\boldsymbol{p}_h^T S_h \\boldsymbol{p}_h$ 的贡献与 $\\boldsymbolp_h^T M_p \\boldsymbol{p}_h$ 是同阶的。这为 $M_p^{-1}S_h$ 的谱恢复了一个一致的下界。\n对于上界，我们考虑 Rayleigh 商 $\\frac{\\boldsymbol{p}_h^T C_h \\boldsymbol{p}_h}{\\boldsymbol{p}_h^T M_p \\boldsymbol{p}_h}$ 的最大值。使用一个离散反不等式，对于任何 $p_h \\in Q_h$ 都有 $\\|\\nabla p_h\\|_0 \\le C_{inv} h^{-1} \\|p_h\\|_0$。\n$$\n\\frac{\\boldsymbol{p}_h^{T} C_h \\boldsymbol{p}_h}{\\boldsymbol{p}_h^{T} M_p \\boldsymbol{p}_h} \\simeq \\frac{h^2 \\|\\nabla p_h\\|_0^2}{\\|p_h\\|_0^2} \\le \\frac{h^2 (C_{inv} h^{-1} \\|p_h\\|_0)^2}{\\|p_h\\|_0^2} = C_{inv}^2\n$$\n稳定化项对 $M_p^{-1}S_h$ 谱的贡献由一个与网格无关的常数为上界。由于 $B_h K_h^{-1} B_h^T$ 部分也是有界的，所以 $M_p^{-1}S_h$ 的最大特征值保持有界。如果稳定化的尺度不正确，例如没有 $h^2$ 因子，就会出现 $O(h^{-2})$ 的增长。该陈述是对一致性稳定化方法的正确描述。\n**结论：正确。**\n\n**D. 当用 $M_p^{-1}$ 对 $S_h$ 进行预处理时，即使当 $h \\to 0$ 时 $\\beta_h \\to 0$，共轭梯度（CG）迭代的次数也与网格无关，因为 Krylov 方法对小特征值不敏感。**\n\n预处理共轭梯度（PCG）方法的收敛速度取决于预处理后矩阵的条件数，即 $\\kappa(P^{-1}A) = \\frac{\\lambda_{\\max}(P^{-1}A)}{\\lambda_{\\min}(P^{-1}A)}$。在这里，$A=S_h$ 且 $P=M_p$。迭代次数大致与 $\\sqrt{\\kappa(M_p^{-1}S_h)}$ 成正比。\n对于不稳定的单元对，$\\beta_h \\to 0$，这意味着 $\\lambda_{\\min}(M_p^{-1}S_h) \\to 0$。最大特征值 $\\lambda_{\\max}(M_p^{-1}S_h)$ 通常是有界的。因此，当 $h \\to 0$ 时，条件数 $\\kappa(M_p^{-1}S_h) \\to \\infty$。恶化的条件数导致 CG 迭代次数增加，因此性能不是网格无关的。“Krylov 方法对小特征值不敏感”的说法是错误的。CG 的收敛性对条件数高度敏感，而条件数直接受最小特征值的影响。\n**结论：不正确。**\n\n**E. 对于任何离散空间对，$S_h$ 的最小正特征值精确地等于 $\\beta_h^{2}$（最多相差一个固定的乘性材料常数），因此在离散情形下 $\\lambda_{\\min}(S_h) = \\beta_h^{2}$ 作为一个恒等式成立。**\n\n这个陈述基于多种原因是不正确的。\n1. 它混淆了标准特征值问题（$S_h \\boldsymbol{p} = \\lambda \\boldsymbol{p}$）和广义特征值问题（$S_h \\boldsymbol{p} = \\gamma M_p \\boldsymbol{p}$）。量 $\\beta_h^2$ 与广义问题的特征值 $\\gamma$ 相关，而不是标准问题的特征值 $\\lambda$。$M_p$ 的特征值随网格尺寸变化（例如，在 $d$ 维中为 $O(h^d)$），因此 $S_h$ 和 $M_p^{-1}S_h$ 的特征值具有不同的缩放性质。$\\lambda_{\\min}(S_h)$ 不是一个无量纲量，而 $\\beta_h^2$ 是。\n2. 成立的恒等式是 $\\beta_h^2 = \\lambda_{\\min}(M_p^{-1}(B_h K_h^{-1} B_h^T))$。该陈述指的是 $S_h = B_h K_h^{-1} B_h^T + C_h$。$C_h$ 项的存在意味着 $\\lambda_{\\min}(M_p^{-1}S_h) \\ge \\beta_h^2$，仅当 $C_h=0$ 时等号成立。\n3. 该陈述声称这对“任何离散空间对”都成立。这太过笼统了。\n声称 $\\lambda_{\\min}(S_h) = \\beta_h^2$ 是一个精确的恒等式，这是对基础理论的根本性误解。\n**结论：不正确。**", "answer": "$$\\boxed{ABC}$$", "id": "3538765"}]}