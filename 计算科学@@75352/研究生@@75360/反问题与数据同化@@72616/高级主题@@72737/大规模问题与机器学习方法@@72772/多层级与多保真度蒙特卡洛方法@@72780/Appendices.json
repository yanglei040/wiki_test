{"hands_on_practices": [{"introduction": "在探索高级方法之前，理解标准方法的局限性至关重要。第一个练习将建立一个基准，计算标准蒙特卡洛估计器达到所需精度水平所需的计算成本。通过这个练习，您将具体地体会到为什么像多水平蒙特卡洛（MLMC）和多保真度蒙特卡洛（MFMC）这样的方差缩减技术是必不可少的。[@problem_id:3405131]", "problem": "考虑一个贝叶斯逆问题，其中未知参数 $U$ 是通过一个适定的似然和先验从数据中推断出来的，从而产生后验分布 $\\pi$。令 $\\varphi(U)$ 为一个平方可积的感兴趣量，并将其后验期望表示为 $\\mu=\\mathbb{E}_{\\pi}[\\varphi(U)]$。您计划使用基于 $N$ 个独立同分布样本 $U^{(i)}\\sim \\pi$ 的单层蒙特卡洛估计器来估计 $\\mu$，即 $\\hat{\\mu}_{N}=\\frac{1}{N}\\sum_{i=1}^{N}\\varphi\\!\\left(U^{(i)}\\right)$。假设如下：\n- 被积函数的后验方差已知为 $\\operatorname{Var}_{\\pi}[\\varphi(U)]=\\sigma^{2}=4$。\n- 在所选分辨率下，正向模型的离散化误差可忽略不计，因此蒙特卡洛估计器相对于 $\\mu$ 实际上是无偏的。\n- 每个样本的单位计算成本为 1，因此总成本等于样本数量 $N$。\n\n仅使用独立平均值的均方误差和方差的定义，确定所需的最小样本量 $N$，以确保均方误差满足 $\\mathbb{E}\\!\\left[(\\hat{\\mu}_{N}-\\mu)^{2}\\right]\\le \\varepsilon^{2}$，其中容差 $\\varepsilon=0.01$。然后在单位成本模型下计算相关的总计算成本。报告最小 $N$（无量纲计数）和成本（单位成本计数），两者均为精确整数，不进行四舍五入。", "solution": "按如下方式验证问题陈述。\n\n**第 1 步：提取已知条件**\n- 待估计的量是后验期望 $\\mu=\\mathbb{E}_{\\pi}[\\varphi(U)]$。\n- 估计器是单层蒙特卡洛估计器 $\\hat{\\mu}_{N}=\\frac{1}{N}\\sum_{i=1}^{N}\\varphi\\!\\left(U^{(i)}\\right)$，其中 $\\{U^{(i)}\\}_{i=1}^{N}$ 是来自后验分布 $\\pi$ 的独立同分布（i.i.d.）样本。\n- 感兴趣量的后验方差给定为 $\\operatorname{Var}_{\\pi}[\\varphi(U)] = \\sigma^{2} = 4$。\n- 假设估计器 $\\hat{\\mu}_{N}$ 相对于 $\\mu$ 是无偏的。\n- 一个样本的计算成本为 $1$，因此总成本为 $N$。\n- 均方误差（MSE）的目标是 $\\mathbb{E}\\!\\left[(\\hat{\\mu}_{N}-\\mu)^{2}\\right]\\le \\varepsilon^{2}$。\n- 容差指定为 $\\varepsilon=0.01$。\n\n**第 2 步：使用提取的已知条件进行验证**\n- **科学依据：** 该问题基于蒙特卡洛估计和误差分析的基本原理，这些是计算统计学和逆问题数值方法中的标准内容。所有概念都已成熟。\n- **适定性：** 该问题提供了所有必要信息，并要求根据明确的标准确定一个唯一可确定的量（最小样本量）。其结构逻辑清晰，导向一个单一、稳定的解。\n- **客观性：** 该问题以精确的数学语言陈述，没有歧义或主观论断。\n\n**第 3 步：结论与行动**\n问题有效。现在将提供完整的解。\n\n估计器 $\\hat{\\mu}_{N}$ 相对于真值 $\\mu$ 的均方误差（MSE）定义为 $\\mathbb{E}\\!\\left[(\\hat{\\mu}_{N}-\\mu)^{2}\\right]$。MSE 可以分解为估计器偏差的平方和方差：\n$$\n\\text{MSE} = \\mathbb{E}\\!\\left[(\\hat{\\mu}_{N}-\\mu)^{2}\\right] = \\left(\\mathbb{E}[\\hat{\\mu}_{N}]-\\mu\\right)^{2} + \\operatorname{Var}(\\hat{\\mu}_{N})\n$$\n\n首先，我们确定估计器的偏差。$\\hat{\\mu}_{N}$ 的期望值为：\n$$\n\\mathbb{E}[\\hat{\\mu}_{N}] = \\mathbb{E}\\left[\\frac{1}{N}\\sum_{i=1}^{N}\\varphi(U^{(i)})\\right]\n$$\n根据期望的线性性质，这变为：\n$$\n\\mathbb{E}[\\hat{\\mu}_{N}] = \\frac{1}{N}\\sum_{i=1}^{N}\\mathbb{E}[\\varphi(U^{(i)})]\n$$\n由于每个样本 $U^{(i)}$ 都从后验分布 $\\pi$ 中抽取，$\\varphi(U^{(i)})$ 的期望是后验均值 $\\mu$：\n$$\n\\mathbb{E}[\\varphi(U^{(i)})] = \\mathbb{E}_{\\pi}[\\varphi(U)] = \\mu \\quad \\text{for all } i \\in \\{1, \\dots, N\\}\n$$\n将此代回，我们得到：\n$$\n\\mathbb{E}[\\hat{\\mu}_{N}] = \\frac{1}{N}\\sum_{i=1}^{N}\\mu = \\frac{1}{N}(N\\mu) = \\mu\n$$\n因此，估计器的偏差为 $\\mathbb{E}[\\hat{\\mu}_{N}]-\\mu = \\mu-\\mu = 0$。这证实了问题陈述中估计器可被视为无偏的说法。\n\n在零偏差的情况下，MSE 等于估计器的方差：\n$$\n\\mathbb{E}\\!\\left[(\\hat{\\mu}_{N}-\\mu)^{2}\\right] = \\operatorname{Var}(\\hat{\\mu}_{N})\n$$\n接下来，我们计算估计器 $\\hat{\\mu}_{N}$ 的方差：\n$$\n\\operatorname{Var}(\\hat{\\mu}_{N}) = \\operatorname{Var}\\left(\\frac{1}{N}\\sum_{i=1}^{N}\\varphi(U^{(i)})\\right)\n$$\n使用性质 $\\operatorname{Var}(aX) = a^{2}\\operatorname{Var}(X)$，我们有：\n$$\n\\operatorname{Var}(\\hat{\\mu}_{N}) = \\frac{1}{N^{2}}\\operatorname{Var}\\left(\\sum_{i=1}^{N}\\varphi(U^{(i)})\\right)\n$$\n由于样本 $U^{(i)}$ 是独立的，随机变量 $\\varphi(U^{(i)})$ 也是独立的。对于独立随机变量之和，和的方差等于方差之和：\n$$\n\\operatorname{Var}\\left(\\sum_{i=1}^{N}\\varphi(U^{(i)})\\right) = \\sum_{i=1}^{N}\\operatorname{Var}(\\varphi(U^{(i)}))\n$$\n由于样本也是同分布的，每一项 $\\varphi(U^{(i)})$ 的方差都相同，等于后验方差 $\\sigma^2$：\n$$\n\\operatorname{Var}(\\varphi(U^{(i)})) = \\operatorname{Var}_{\\pi}[\\varphi(U)] = \\sigma^{2} \\quad \\text{for all } i\n$$\n因此，方差之和为：\n$$\n\\sum_{i=1}^{N}\\operatorname{Var}(\\varphi(U^{(i)})) = \\sum_{i=1}^{N}\\sigma^{2} = N\\sigma^{2}\n$$\n将此结果代回 $\\operatorname{Var}(\\hat{\\mu}_{N})$ 的表达式，得到：\n$$\n\\operatorname{Var}(\\hat{\\mu}_{N}) = \\frac{1}{N^{2}}(N\\sigma^{2}) = \\frac{\\sigma^{2}}{N}\n$$\n问题要求 MSE 不大于 $\\varepsilon^{2}$。我们现在可以将这个条件写为：\n$$\n\\frac{\\sigma^{2}}{N} \\le \\varepsilon^{2}\n$$\n为求得最小样本量 $N$，我们对 $N$ 解这个不等式：\n$$\nN \\ge \\frac{\\sigma^{2}}{\\varepsilon^{2}}\n$$\n问题给出了值 $\\sigma^{2}=4$ 和 $\\varepsilon=0.01$。代入这些值：\n$$\nN \\ge \\frac{4}{(0.01)^{2}} = \\frac{4}{(10^{-2})^{2}} = \\frac{4}{10^{-4}} = 4 \\times 10^{4} = 40000\n$$\n满足此条件的最小整数样本量 $N$ 是 $N=40000$。\n\n问题的第二部分要求计算相关的总计算成本。问题陈述每个样本的成本为 $1$，总成本等于样本数量 $N$。因此，总计算成本也是 $40000$。\n\n两个要求的值是最小样本量 $N$ 和总成本。\n最小样本量：$N = 40000$。\n总计算成本：成本 = $40000$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n40000 & 40000\n\\end{pmatrix}\n}\n$$", "id": "3405131"}, {"introduction": "多水平蒙特卡洛（MLMC）方法的威力在于它能在一系列不同保真度的模型层级上智能地分配计算资源。本练习将深入探讨MLMC方法的核心优化问题：如何确定在每个层级上的最优样本数量，从而在固定的误差容忍度下最小化总计算成本。掌握这一推导过程，您将揭示MLMC方法相比标准蒙特卡洛方法能够实现显著效率提升的根本原因。[@problem_id:3405129]", "problem": "考虑一个构建在几何层级上的多层蒙特卡罗（MLMC）估计量，其层级 $l=0,1,\\dots,L$ 的网格尺寸为 $h_{l}=2^{-l}$。设层级差为 $\\Delta P_{l}=P_{l}-P_{l-1}$，其中 $P_{-1}\\equiv 0$，并假设 $\\Delta P_{l}$ 在不同层级 $l$ 上是相互独立的。假设每个层级差的方差以及每个层级上单个样本的成本满足\n$$\n\\operatorname{Var}[\\Delta P_{l}]=v_{0}\\,2^{-\\beta l},\\qquad C_{l}=c_{0}\\,2^{\\gamma l},\n$$\n其中 $v_{0}$、$c_{0}$ 为固定的正常数，$\\beta>0$、$\\gamma>0$ 为指数，且 $\\beta\\neq\\gamma$。MLMC估计量为\n$$\n\\widehat{P}_{\\mathrm{ML}}=\\sum_{l=0}^{L}\\frac{1}{N_{l}}\\sum_{n=1}^{N_{l}}\\Delta P_{l}^{(n)},\n$$\n其中 $N_{l}\\in\\mathbb{N}$ 表示在层级 $l$ 上抽取的样本数量。\n\n在独立性和有限二阶矩的条件下，估计量的方差为\n$$\n\\operatorname{Var}[\\widehat{P}_{\\mathrm{ML}}]=\\sum_{l=0}^{L}\\frac{\\operatorname{Var}[\\Delta P_{l}]}{N_{l}},\n$$\n总计算功为\n$$\nW=\\sum_{l=0}^{L}N_{l}\\,C_{l}.\n$$\n\n仅从这些定义出发，选择样本数量 $\\{N_{l}\\}_{l=0}^{L}$ 以最小化 $W$，同时满足约束条件 $\\operatorname{Var}[\\widehat{P}_{\\mathrm{ML}}]=\\sigma^{2}$，其中给定目标方差 $\\sigma^{2}>0$。推导最优实值 $N_l$ 作为 $l$、$L$、$v_{0}$、$c_{0}$、$\\beta$、$\\gamma$ 和 $\\sigma^{2}$ 的函数的闭式表达式，并将任何求和都表示为闭式形式。你的最终答案必须是给出 $N_l$ 的、用这些参数表示的单一解析表达式。", "solution": "问题在于，对于一个多层蒙特卡罗（MLMC）估计量，找到能最小化总计算功 $W$ 的样本最优分配 $\\{N_l\\}_{l=0}^{L}$，并满足总方差固定为 $\\sigma^2$ 的约束。这是一个经典的约束优化问题，可以使用拉格朗日乘子法来解决。\n\n首先，我们陈述要最小化的目标函数和约束方程。总计算功由下式给出：\n$$\nW(\\{N_l\\}) = \\sum_{l=0}^{L} N_l C_l = \\sum_{l=0}^{L} N_l c_0 2^{\\gamma l}\n$$\nMLMC估计量方差的约束条件是：\n$$\n\\operatorname{Var}[\\widehat{P}_{\\mathrm{ML}}] = \\sum_{l=0}^{L} \\frac{\\operatorname{Var}[\\Delta P_l]}{N_l} = \\sum_{l=0}^{L} \\frac{v_0 2^{-\\beta l}}{N_l} = \\sigma^2\n$$\n问题要求的是最优的实值 $N_l$，这允许我们使用微分学的方法。我们定义拉格朗日函数 $\\mathcal{L}$，它等于目标函数加上约束函数与一个拉格朗日乘子 $\\lambda$ 的乘积：\n$$\n\\mathcal{L}(\\{N_l\\}, \\lambda) = W + \\lambda \\left( \\sum_{l=0}^{L} \\frac{v_0 2^{-\\beta l}}{N_l} - \\sigma^2 \\right) = \\sum_{l=0}^{L} N_l c_0 2^{\\gamma l} + \\lambda \\left( \\sum_{l=0}^{L} \\frac{v_0 2^{-\\beta l}}{N_l} - \\sigma^2 \\right)\n$$\n为求最小值，我们计算 $\\mathcal{L}$ 关于每个 $N_l$ 的偏导数，并令其为零。对于每个 $l \\in \\{0, 1, \\dots, L\\}$：\n$$\n\\frac{\\partial \\mathcal{L}}{\\partial N_l} = c_0 2^{\\gamma l} - \\lambda \\frac{v_0 2^{-\\beta l}}{N_l^2} = 0\n$$\n解出 $N_l^2$，我们得到：\n$$\nN_l^2 = \\lambda \\frac{v_0 2^{-\\beta l}}{c_0 2^{\\gamma l}} = \\lambda \\frac{v_0}{c_0} 2^{-(\\beta+\\gamma)l}\n$$\n为使 $N_l$ 为正实数，必须有 $\\lambda > 0$。取平方根，得到用未知乘子 $\\lambda$ 表示的最优 $N_l$：\n$$\nN_l = \\sqrt{\\lambda} \\sqrt{\\frac{v_0}{c_0}} 2^{-(\\beta+\\gamma)l/2}\n$$\n下一步是通过将 $N_l$ 的这个表达式代回方差约束方程来确定 $\\sqrt{\\lambda}$ 的值：\n$$\n\\sum_{l=0}^{L} \\frac{v_0 2^{-\\beta l}}{N_l} = \\sigma^2\n$$\n$$\n\\sum_{l=0}^{L} \\frac{v_0 2^{-\\beta l}}{\\sqrt{\\lambda} \\sqrt{\\frac{v_0}{c_0}} 2^{-(\\beta+\\gamma)l/2}} = \\sigma^2\n$$\n我们可以将不依赖于求和指数 $l$ 的项提取出来：\n$$\n\\frac{1}{\\sqrt{\\lambda}} \\sum_{l=0}^{L} \\frac{v_0}{\\sqrt{v_0/c_0}} \\frac{2^{-\\beta l}}{2^{-(\\beta+\\gamma)l/2}} = \\sigma^2\n$$\n$$\n\\frac{\\sqrt{v_0 c_0}}{\\sqrt{\\lambda}} \\sum_{l=0}^{L} 2^{-\\beta l + (\\beta+\\gamma)l/2} = \\sigma^2\n$$\n$$\n\\frac{\\sqrt{v_0 c_0}}{\\sqrt{\\lambda}} \\sum_{l=0}^{L} 2^{(\\gamma-\\beta)l/2} = \\sigma^2\n$$\n这个和是一个有限几何级数。令 $r = 2^{(\\gamma-\\beta)/2}$。该和为 $\\sum_{l=0}^{L} r^l$。由于题目说明 $\\beta \\neq \\gamma$，我们有 $r \\neq 1$。这个和的闭式表达式是：\n$$\nS = \\sum_{l=0}^{L} r^l = \\frac{1 - r^{L+1}}{1 - r} = \\frac{1 - (2^{(\\gamma-\\beta)/2})^{L+1}}{1 - 2^{(\\gamma-\\beta)/2}} = \\frac{1 - 2^{(\\gamma-\\beta)(L+1)/2}}{1 - 2^{(\\gamma-\\beta)/2}}\n$$\n将此代回，我们可以解出 $\\sqrt{\\lambda}$：\n$$\n\\frac{\\sqrt{v_0 c_0}}{\\sqrt{\\lambda}} S = \\sigma^2 \\implies \\sqrt{\\lambda} = \\frac{\\sqrt{v_0 c_0}}{\\sigma^2} S\n$$\n最后，我们将 $\\sqrt{\\lambda}$ 的这个表达式代入我们关于 $N_l$ 的方程中：\n$$\nN_l = \\left( \\frac{\\sqrt{v_0 c_0}}{\\sigma^2} S \\right) \\left( \\sqrt{\\frac{v_0}{c_0}} 2^{-(\\beta+\\gamma)l/2} \\right)\n$$\n$$\nN_l = \\frac{S}{\\sigma^2} \\left( \\sqrt{v_0 c_0} \\sqrt{\\frac{v_0}{c_0}} \\right) 2^{-(\\beta+\\gamma)l/2}\n$$\n项 $\\sqrt{v_0 c_0} \\sqrt{v_0/c_0} = \\sqrt{v_0^2} = v_0$。因此，成本常数 $c_0$ 被消掉，表明最优样本分配与其绝对值无关。\n$$\nN_l = \\frac{v_0 S}{\\sigma^2} 2^{-(\\beta+\\gamma)l/2}\n$$\n代入和 $S$ 的闭式表达式，我们得到层级 $l$ 上最优样本数量的最终答案：\n$$\nN_l = \\frac{v_0}{\\sigma^2} \\left( \\frac{1 - 2^{(\\gamma-\\beta)(L+1)/2}}{1 - 2^{(\\gamma-\\beta)/2}} \\right) 2^{-(\\beta+\\gamma)l/2}\n$$\n这个表达式给出了作为指定参数 $l$、$L$、$v_0$、$\\beta$、$\\gamma$ 和 $\\sigma^2$ 的函数的最优实值 $N_l$。如前所述，它与 $c_0$ 无关。", "answer": "$$ \\boxed{ \\frac{v_{0}}{\\sigma^{2}} \\left( \\frac{1 - 2^{\\frac{(\\gamma-\\beta)(L+1)}{2}}}{1 - 2^{\\frac{\\gamma-\\beta}{2}}} \\right) 2^{-\\frac{(\\beta+\\gamma)l}{2}} } $$", "id": "3405129"}, {"introduction": "理想的MLMC理论通常假设模拟层级之间存在完美的“耦合”，例如通过使用嵌套网格来实现。本练习将探讨一个更贴近实际的场景，其中由于非嵌套网格或不一致的数值方法等实际问题，这种耦合被破坏了。通过量化由此导致的方差增加，您将更深刻地理解层级间相关性在MLMC估计器效率中所扮演的关键角色。[@problem_id:3405128]", "problem": "考虑一个单位区间上的标量椭圆模型的贝叶斯线性化逆问题，其中我们关注的量是线性泛函 $Q(u) = \\int_{0}^{1} u(x) \\, dx$。设使用一个网格宽度为 $h_l = 2^{-l}$，$l \\in \\mathbb{N}$ 的有限元网格层级，并结合多层蒙特卡洛 (MLMC) 方法中的多层控制变量构造。对于第 $l$ 层，其对 $Q(u)$ 的近似值记为 $P_l$，层间差分记为 $\\Delta P_l = P_l - P_{l-1}$。\n\n假设对各层近似采用以下线性化误差模型：\n- 模型误差分量由一个单一主导的潜在标准正态模态 $Z \\sim \\mathcal{N}(0,1)$ 表示，该模态以随网格宽度衰减的振幅线性进入，因此 $P_l = \\theta + s_l Z + \\eta_l$，其中 $\\theta$ 是一个确定性极限，$s_l = C h_l^{q}$（$C > 0$ 且 $q > 0$），而 $\\eta_l$ 用于模拟求积/离散化的不一致性。\n- 在具有一致求积的嵌套网格的理想、完全耦合设置中，所有层级都使用相同的潜在变量 $Z$，并且对所有 $l$，$\\eta_l \\equiv 0$。\n- 在由非嵌套网格或不一致求积引起的耦合破坏设置中，连续层级上的潜在驱动因子仅部分相关，其中 $(Z_l, Z_{l-1})$ 服从联合高斯分布、标准正态，且 $\\operatorname{Corr}(Z_l, Z_{l-1}) = \\rho \\in (0,1)$。求积不一致性由独立的零均值高斯噪声 $\\eta_l \\sim \\mathcal{N}(0,\\tau_l^2)$ 表示，这些噪声在各层级间独立，且独立于 $(Z_l, Z_{l-1})$，其中 $\\tau_l^2 = \\kappa h_l^{r}$，对于某个 $\\kappa > 0$ 和 $r > 0$。\n\n在第 $l=3$ 层上，使用以下与一阶有限元收敛和平滑潜在结构一致的特定、科学上合理的参数进行计算：\n- $h_l = 2^{-l}$，\n- $C = 1$ 且 $q = 1$，\n- $\\kappa = 1$ 且 $r = 2$，\n- $\\rho = 0.7$。\n\n仅使用方差和协方差的概率论核心定义，计算在第 $l=3$ 层上，由耦合破坏导致的层间差分方差相对于理想嵌套情况的乘性增加，即计算\n$$\nR \\;=\\; \\frac{\\operatorname{Var}[\\Delta P_3]_{\\text{broken}}}{\\operatorname{Var}[\\Delta P_3]_{\\text{nested}}}.\n$$\n给出你的最终答案，形式为一个四舍五入到三位有效数字的实数。无需单位。", "solution": "该问题已经过验证，被认为是具有科学依据、适定、客观且内部一致的。它提出了一个在计算科学中用于分析多层蒙特卡洛方法的标准（尽管简化了的）误差模型。所有必需的参数均已提供，任务是直接应用概率论原理。因此，我们可以着手求解。\n\n目标是计算比率 $R$，其定义为在“耦合破坏”设置下第 $l=3$ 层的层间差分方差与在“理想嵌套”设置下该方差的比值。\n$$\nR = \\frac{\\operatorname{Var}[\\Delta P_3]_{\\text{broken}}}{\\operatorname{Var}[\\Delta P_3]_{\\text{nested}}}\n$$\n我们将分别计算分母和分子。分析将针对一般的层级 $l$ 进行，然后在每次推导结束时代入 $l=3$ 的具体参数。\n\n给定的参数是：\n- 网格宽度: $h_l = 2^{-l}$\n- 模型参数: $C=1$, $q=1$, $\\kappa=1$, $r=2$\n- 相关系数: $\\rho = 0.7$\n由此，我们推导出依赖于层级的系数：\n- 振幅: $s_l = C h_l^q = 1 \\cdot (2^{-l})^1 = 2^{-l}$\n- 噪声方差: $\\tau_l^2 = \\kappa h_l^r = 1 \\cdot (2^{-l})^2 = 2^{-2l}$\n\n对于层级 $l=3$，我们需要第 $l=3$ 层和第 $l-1=2$ 层的系数：\n- $s_3 = 2^{-3} = \\frac{1}{8}$\n- $s_2 = 2^{-2} = \\frac{1}{4}$\n- $\\tau_3^2 = 2^{-2 \\cdot 3} = 2^{-6} = \\frac{1}{64}$\n- $\\tau_2^2 = 2^{-2 \\cdot 2} = 2^{-4} = \\frac{1}{16}$\n\n首先，我们分析理想嵌套情况以求得分母 $\\operatorname{Var}[\\Delta P_3]_{\\text{nested}}$。\n在此设置中，第 $l$ 层的近似为 $P_l = \\theta + s_l Z$，其中 $Z \\sim \\mathcal{N}(0,1)$ 是所有层级共有的潜在变量，且不一致性项 $\\eta_l$ 为零。层间差分 $\\Delta P_l = P_l - P_{l-1}$ 为：\n$$\n\\Delta P_l^{\\text{nested}} = (\\theta + s_l Z) - (\\theta + s_{l-1} Z) = (s_l - s_{l-1})Z\n$$\n由于 $E[Z]=0$，该差分的期望为 $E[\\Delta P_l^{\\text{nested}}] = (s_l - s_{l-1})E[Z] = 0$。\n方差由 $\\operatorname{Var}[X] = E[X^2] - (E[X])^2$ 给出。对于零均值变量，这简化为 $\\operatorname{Var}[X] = E[X^2]$。\n$$\n\\operatorname{Var}[\\Delta P_l^{\\text{nested}}] = \\operatorname{Var}[(s_l - s_{l-1})Z] = (s_l - s_{l-1})^2 \\operatorname{Var}[Z]\n$$\n由于 $Z$ 是一个标准正态变量，其方差为 $\\operatorname{Var}[Z] = 1$。\n$$\n\\operatorname{Var}[\\Delta P_l^{\\text{nested}}] = (s_l - s_{l-1})^2\n$$\n对于 $l=3$，我们代入 $s_3$ 和 $s_2$ 的值：\n$$\n\\operatorname{Var}[\\Delta P_3]_{\\text{nested}} = \\left(s_3 - s_2\\right)^2 = \\left(\\frac{1}{8} - \\frac{1}{4}\\right)^2 = \\left(\\frac{1}{8} - \\frac{2}{8}\\right)^2 = \\left(-\\frac{1}{8}\\right)^2 = \\frac{1}{64}\n$$\n\n接下来，我们分析耦合破坏情况以求得分子 $\\operatorname{Var}[\\Delta P_3]_{\\text{broken}}$。\n在此设置中，第 $l$ 层的近似为 $P_l = \\theta + s_l Z_l + \\eta_l$，其中 $(Z_l, Z_{l-1})$ 服从联合高斯分布，具有标准正态边缘分布和相关性 $\\rho$，而 $\\eta_l \\sim \\mathcal{N}(0, \\tau_l^2)$ 是独立的噪声项。层间差分 $\\Delta P_l = P_l - P_{l-1}$ 为：\n$$\n\\Delta P_l^{\\text{broken}} = (\\theta + s_l Z_l + \\eta_l) - (\\theta + s_{l-1} Z_{l-1} + \\eta_{l-1}) = s_l Z_l - s_{l-1} Z_{l-1} + \\eta_l - \\eta_{l-1}\n$$\n变量 $Z_l, Z_{l-1}, \\eta_l, \\eta_{l-1}$ 的均值都为零，因此 $E[\\Delta P_l^{\\text{broken}}] = 0$。\n方差的计算利用了对于独立随机变量 $X$ 和 $Y$，有 $\\operatorname{Var}[X+Y] = \\operatorname{Var}[X] + \\operatorname{Var}[Y]$ 的性质。项 $(s_l Z_l - s_{l-1} Z_{l-1})$ 与 $\\eta_l$ 和 $\\eta_{l-1}$ 独立，并且 $\\eta_l$ 和 $\\eta_{l-1}$ 相互独立。\n$$\n\\operatorname{Var}[\\Delta P_l^{\\text{broken}}] = \\operatorname{Var}[s_l Z_l - s_{l-1} Z_{l-1}] + \\operatorname{Var}[\\eta_l] + \\operatorname{Var}[-\\eta_{l-1}]\n$$\n使用性质 $\\operatorname{Var}[aX - bY] = a^2 \\operatorname{Var}[X] + b^2 \\operatorname{Var}[Y] - 2ab \\operatorname{Cov}[X,Y]$，并注意到 $\\operatorname{Var}[\\eta_l] = \\tau_l^2$ 以及 $\\operatorname{Var}[-\\eta_{l-1}] = (-1)^2 \\operatorname{Var}[\\eta_{l-1}] = \\tau_{l-1}^2$:\n$$\n\\operatorname{Var}[\\Delta P_l^{\\text{broken}}] = (s_l^2 \\operatorname{Var}[Z_l] + s_{l-1}^2 \\operatorname{Var}[Z_{l-1}] - 2s_l s_{l-1} \\operatorname{Cov}[Z_l, Z_{l-1}]) + \\tau_l^2 + \\tau_{l-1}^2\n$$\n鉴于 $Z_l$ 和 $Z_{l-1}$ 是标准正态变量，$\\operatorname{Var}[Z_l] = 1$ 且 $\\operatorname{Var}[Z_{l-1}] = 1$。协方差为 $\\operatorname{Cov}[Z_l, Z_{l-1}] = \\operatorname{Corr}(Z_l, Z_{l-1}) \\sqrt{\\operatorname{Var}[Z_l]\\operatorname{Var}[Z_{l-1}]} = \\rho \\cdot 1 \\cdot 1 = \\rho$。\n将这些代入方差表达式中：\n$$\n\\operatorname{Var}[\\Delta P_l^{\\text{broken}}] = s_l^2 + s_{l-1}^2 - 2 \\rho s_l s_{l-1} + \\tau_l^2 + \\tau_{l-1}^2\n$$\n对于 $l=3$，我们代入具体的参数值：\n- $s_3 = 1/8$, $s_2 = 1/4$\n- $\\tau_3^2 = 1/64$, $\\tau_2^2 = 1/16$\n- $\\rho = 0.7$\n$$\n\\operatorname{Var}[\\Delta P_3]_{\\text{broken}} = \\left(\\frac{1}{8}\\right)^2 + \\left(\\frac{1}{4}\\right)^2 - 2(0.7)\\left(\\frac{1}{8}\\right)\\left(\\frac{1}{4}\\right) + \\frac{1}{64} + \\frac{1}{16}\n$$\n$$\n\\operatorname{Var}[\\Delta P_3]_{\\text{broken}} = \\frac{1}{64} + \\frac{1}{16} - \\frac{1.4}{32} + \\frac{1}{64} + \\frac{1}{16}\n$$\n为简化计算，我们使用公分母 64：\n$$\n\\frac{1}{16} = \\frac{4}{64} \\quad \\text{和} \\quad \\frac{1.4}{32} = \\frac{2.8}{64}\n$$\n$$\n\\operatorname{Var}[\\Delta P_3]_{\\text{broken}} = \\frac{1}{64} + \\frac{4}{64} - \\frac{2.8}{64} + \\frac{1}{64} + \\frac{4}{64} = \\frac{1 + 4 - 2.8 + 1 + 4}{64} = \\frac{10 - 2.8}{64} = \\frac{7.2}{64}\n$$\n最后，我们计算比率 $R$：\n$$\nR = \\frac{\\operatorname{Var}[\\Delta P_3]_{\\text{broken}}}{\\operatorname{Var}[\\Delta P_3]_{\\text{nested}}} = \\frac{7.2/64}{1/64} = 7.2\n$$\n问题要求答案四舍五入到三位有效数字。\n$$\nR = 7.20\n$$\n这个结果量化了由不完全相关和额外噪声源导致的方差膨胀，这是优化 MLMC 估计量时的一个关键考虑因素。", "answer": "$$\n\\boxed{7.20}\n$$", "id": "3405128"}]}