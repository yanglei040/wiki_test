{"hands_on_practices": [{"introduction": "在数据同化中，一个核心挑战是区分误差的来源。虽然新息（观测减预报）统计量是常用的诊断工具，但它们通常混合了模型误差和观测误差的影响。本练习 [@problem_id:3403106] 介绍了一种更直接地检测模型误差的方法，该方法通过检验预报误差本身的时间相关性来实现，其前提是我们可以获得用于验证的“真实”状态。这是一种在系统设计和测试中使用的强大概念工具。", "problem": "考虑一个用于地球物理预测的序贯数据同化（DA）循环中的线性、时不变、离散时间状态空间系统，其中真实系统和观测系统的演化如下：\n$$\nx_{k+1} = M x_k + \\eta_k, \\quad y_k = H x_k + \\varepsilon_k,\n$$\n并有以下假设：\n- $x_k \\in \\mathbb{R}^n$ 是真实状态，$y_k \\in \\mathbb{R}^m$ 是观测，$M$ 和 $H$ 是已知的线性算子。\n- $\\eta_k$ 是模型误差（也称为过程噪声），$\\varepsilon_k$ 是观测误差（也称为观测噪声）。\n- $\\{\\varepsilon_k\\}_{k \\ge 0}$ 是零均值、时间上不相关（独立同分布）的，其协方差为 $R \\succ 0$，并且独立于 $\\{\\eta_k\\}_{k \\ge 0}$ 和初始状态。\n- $\\{\\eta_k\\}_{k \\ge 0}$ 是零均值的，其协方差为 $Q \\succeq 0$；它可能在时间上是相关的，即对于 $\\ell \\ge 1$，$E[\\eta_k \\eta_{k-\\ell}^\\top]$ 未必为零。\n\nDA 系统以循环方式运行。令 $x_k^a$ 表示时间 $k$ 的分析（后验状态估计），单步预报由下式给出：\n$$\nx_{k+1}^f = M x_k^a.\n$$\n定义相对于真实值的预报误差为：\n$$\ne_k^f := x_k - x_k^f,\n$$\n以及新息（观测减预报）为：\n$$\nd_k := y_k - H x_k^f.\n$$\n假设 DA 方案已达到一个统计稳态，其中分析误差近似为零均值，独立于未来的强迫项，并且相对于模型误差的时间尺度，其时间相关性很弱；特别地，你可以假设对于 $\\ell \\ge 1$，$E[e_k^a e_{k-\\ell}^{a\\top}] \\approx 0$，其中 $e_k^a := x_k - x_k^a$。\n\n你能够获取一个高保真的“真实代理”来验证 $e_k^f$（例如，一个孪生试验或一个误差足够小的独立参考，以至于在二阶统计量的目的下可以将其视为 $x_k$）。你的目标是设计一个统计检验，利用从循环 DA 系统收集的 $\\{e_k^f\\}$ 和 $\\{d_k\\}$ 的长时间序列，来区分模型误差的存在与观测误差的存在。\n\n在上述假设下，以下哪种检验策略最能清晰地诊断模型误差（而不是观测误差）？\n\nA. 从预报验证误差的长时间序列中，估计一个或多个整数 $\\ell \\ge 1$ 的滞后-$\\ell$交叉协方差 $E[e_k^f e_{k-\\ell}^{f\\top}]$。对以下假设进行检验：\n$$\nH_0: \\ E[e_k^f e_{k-\\ell}^{f\\top}] = 0 \\ \\text{对于所有检验的 } \\ell \\ge 1\n$$\n相对于备择假设，即至少有一个这样的滞后协方差不为零。拒绝 $H_0$ 表明存在模型误差，而独立的观测误差不会在 $\\ell \\ge 1$ 时导致非零的 $E[e_k^f e_{k-\\ell}^{f\\top}]$。\n\nB. 估计零滞后新息协方差 $E[d_k d_k^\\top]$，并将其与 DA 系统预测的新息协方差进行比较。统计上显著的差异可以明确归因于模型误差，因为观测误差只影响 $d_k$ 的均值而非其协方差。\n\nC. 估计一个或多个整数 $\\ell \\ge 1$ 的滞后新息协方差 $E[d_k d_{k-\\ell}^\\top]$。如果任何一个不为零，则将非零值归因于观测误差的错误指定，因为在线性模型下，模型误差不能引起新息的序列相关性。\n\nD. 比较样本方差 $\\operatorname{tr}(E[e_k^f e_k^{f\\top}])$ 和 $\\operatorname{tr}(E[d_k d_k^\\top])$; 如果后者超过前者超过一个统计上确定的余量，则断定存在模型误差，因为观测误差不能使 $\\operatorname{tr}(E[d_k d_k^\\top])$ 的数值超过 $\\operatorname{tr}(E[e_k^f e_k^{f\\top}])$。\n\n选择唯一最佳选项。", "solution": "用户希望我扮演一名 STEM 教授，来验证并解决一个数据同化领域的问题。\n\n### 步骤1：提取已知条件\n\n问题提供了一个用于真实系统和观测系统的线性、时不变、离散时间状态空间模型：\n- **真实状态演化：** $x_{k+1} = M x_k + \\eta_k$\n- **观测：** $y_k = H x_k + \\varepsilon_k$\n\n变量和算子定义如下：\n- $x_k \\in \\mathbb{R}^n$：时间 $k$ 的真实状态。\n- $y_k \\in \\mathbb{R}^m$：时间 $k$ 的观测。\n- $M$：已知的线性模型算子。\n- $H$：已知的线性观测算子。\n- $\\eta_k$：模型误差（过程噪声）。\n- $\\varepsilon_k$：观测误差（观测噪声）。\n\n统计假设为：\n- $\\{\\varepsilon_k\\}_{k \\ge 0}$ 是零均值（$E[\\varepsilon_k] = 0$）、时间上不相关（对于 $k \\ne j$，$E[\\varepsilon_k \\varepsilon_j^\\top] = 0$）的，其协方差为 $E[\\varepsilon_k \\varepsilon_k^\\top] = R$，其中 $R \\succ 0$（正定）。\n- $\\{\\varepsilon_k\\}_{k \\ge 0}$ 独立于 $\\{\\eta_k\\}_{k \\ge 0}$ 和初始状态。\n- $\\{\\eta_k\\}_{k \\ge 0}$ 是零均值（$E[\\eta_k] = 0$）的，其协方差为 $E[\\eta_k \\eta_k^\\top] = Q$，其中 $Q \\succeq 0$（半正定）。\n- $\\{\\eta_k\\}_{k \\ge 0}$ 可能在时间上是相关的，即对于 $\\ell \\ge 1$，$E[\\eta_k \\eta_{k-\\ell}^\\top]$ 不一定为零。\n\n数据同化（DA）循环定义为：\n- $x_k^a$：时间 $k$ 的分析（后验状态估计）。\n- $x_{k+1}^f = M x_k^a$：单步预报。\n\n定义了以下误差和新息量：\n- 预报误差：$e_k^f := x_k - x_k^f$\n- 新息：$d_k := y_k - H x_k^f$\n- 分析误差：$e_k^a := x_k - x_k^a$\n\n关于 DA 系统在统计稳态下的假设：\n- 分析误差近似为零均值：$E[e_k^a] \\approx 0$。\n- 分析误差独立于未来的强迫项。\n- 分析误差在时间上是弱相关的：对于 $\\ell \\ge 1$，$E[e_k^a e_{k-\\ell}^{a\\top}] \\approx 0$。\n\n目标是设计一个统计检验，利用 $\\{e_k^f\\}$ 和 $\\{d_k\\}$ 的时间序列来区分模型误差的存在与观测误差的存在。\n\n### 步骤2：使用提取的已知条件进行验证\n\n1.  **科学上合理**：该问题位于数据同化领域，这是地球物理科学、工程和统计学的核心学科。状态空间模型、误差的定义以及 DA 循环都是卡尔曼滤波及相关序贯估计算法中使用的标准表示。模型误差和观测误差的概念是该领域的基础。该问题在科学上是合理的。\n2.  **适定性**：问题提供了一套清晰的定义和假设，并要求评估具体的统计策略。其结构旨在基于给定框架的逻辑推导，在选项中找到唯一的最佳答案。问题是适定的。\n3.  **客观性**：问题使用精确的数学语言和已建立的技术术语来表达。没有主观或含糊的陈述。它是完全客观的。\n\n该问题没有任何无效性缺陷。这是一个关于数据同化系统分析的标准理论问题。\n\n### 步骤3：结论与行动\n\n问题陈述是有效的。我将继续进行求解。\n\n### 推导\n\n目标是找到一个能够清晰诊断模型误差（$\\eta_k$，协方差为 $Q$）存在，而非观测误差（$\\varepsilon_k$，协方差为 $R$）存在的统计检验。这需要找到一个对 $Q$ 敏感但对 $R$ 不敏感的统计量，或者反之，以一种明确的方式。让我们推导预报误差和新息的表达式。\n\n**预报误差演化：**\n时间 $k+1$ 的预报误差是：\n$$e_{k+1}^f = x_{k+1} - x_{k+1}^f = (M x_k + \\eta_k) - (M x_k^a) = M (x_k - x_k^a) + \\eta_k$$\n$$e_{k+1}^f = M e_k^a + \\eta_k$$\n这个方程表明，预报误差由两个来源驱动：上一步传播的分析误差（$M e_k^a$）和步骤之间注入的新模型误差（$\\eta_k$）。\n\n**新息：**\n时间 $k$ 的新息是：\n$$d_k = y_k - H x_k^f = (H x_k + \\varepsilon_k) - H x_k^f = H (x_k - x_k^f) + \\varepsilon_k$$\n$$d_k = H e_k^f + \\varepsilon_k$$\n这个方程显示，新息是投影到观测空间的预报误差（$H e_k^f$）加上观测误差（$\\varepsilon_k$）。\n\n现在我们分析每个提议的策略。\n\n### 逐项分析\n\n**A. 估计 $\\ell \\ge 1$ 的滞后-$\\ell$交叉协方差 $E[e_k^f e_{k-\\ell}^{f\\top}]$。**\n\n让我们计算这个协方差。使用推导出的预报误差演化：\n$e_k^f = M e_{k-1}^a + \\eta_{k-1}$\n$e_{k-\\ell}^f = M e_{k-\\ell-1}^a + \\eta_{k-\\ell-1}$\n\n协方差为：\n$$E[e_k^f e_{k-\\ell}^{f\\top}] = E[(M e_{k-1}^a + \\eta_{k-1})(M e_{k-\\ell-1}^a + \\eta_{k-\\ell-1})^\\top]$$\n$$= M E[e_{k-1}^a e_{k-\\ell-1}^{a\\top}] M^\\top + M E[e_{k-1}^a \\eta_{k-\\ell-1}^\\top] + E[\\eta_{k-1} e_{k-\\ell-1}^{a\\top}] M^\\top + E[\\eta_{k-1} \\eta_{k-\\ell-1}^\\top]$$\n\n让我们应用问题中对于 $\\ell \\ge 1$ 的假设：\n1.  $E[e_{k-1}^a e_{k-\\ell-1}^{a\\top}] \\approx 0$：分析误差之间的滞后是 $(k-1) - (k-\\ell-1) = \\ell \\ge 1$。所以分析误差在时间上不相关的假设使得这一项为零。\n2.  $E[\\eta_{k-1} e_{k-\\ell-1}^{a\\top}] = 0$：分析误差 $e_{k-\\ell-1}^a$ 依赖于截至时间 $k-\\ell-1$ 的信息。模型误差 $\\eta_{k-1}$ 是相对于这个分析的未来强迫项。问题陈述分析误差独立于未来强迫项，使得这一项为零。\n3.  $E[\\eta_{k-1} \\eta_{k-\\ell-1}^\\top] = C_\\eta(\\ell)$：这是模型误差的滞后-$\\ell$协方差，可能不为零。\n4.  $M E[e_{k-1}^a \\eta_{k-\\ell-1}^\\top]$：分析误差 $e_{k-1}^a$ 是截至时间 $k-1$ 的所有模型和观测误差历史的函数。由于 $\\ell \\ge 1$，所以 $k-\\ell-1  k-1$，因此 $\\eta_{k-\\ell-1}$ 是一个影响 $e_{k-1}^a$ 的过去模型误差。因此，如果存在模型误差，这一项通常不为零。\n\n所以，如果存在模型误差（$\\{\\eta_k\\} \\neq 0$），我们有：\n$$E[e_k^f e_{k-\\ell}^{f\\top}] \\approx M E[e_{k-1}^a \\eta_{k-\\ell-1}^\\top] + C_\\eta(\\ell)$$\n如果存在模型误差，这个量将不为零（无论是通过直接的时间相关性 $C_\\eta(\\ell)$ 还是通过其对分析误差的影响）。\n\n现在，考虑**没有模型误差**的情况（对所有 $k$ 都有 $\\eta_k = 0$，因此 $Q=0$）。\n预报误差变为 $e_k^f = M e_{k-1}^a$。\n滞后协方差为：\n$$E[e_k^f e_{k-\\ell}^{f\\top}] = E[(M e_{k-1}^a)(M e_{k-\\ell-1}^a)^\\top] = M E[e_{k-1}^a e_{k-\\ell-1}^{a\\top}] M^\\top$$\n使用假设 $E[e_k^a e_{k-\\ell}^{a\\top}] \\approx 0$ 对于 $\\ell \\ge 1$，这个表达式近似为零。\n观测误差（$\\varepsilon_k$）的存在会影响 $e_k^a$，但如果分析误差不相关，它不会在 $e_k^f$ 中产生滞后相关性。\n\n因此，对于 $E[e_k^f e_{k-\\ell}^{f\\top}]$ 的非零估计是模型误差存在的直接指标。在给定的假设下，这个检验清晰地将模型误差的影响与观测误差的影响分离开来。\n\n**结论：正确。**\n\n**B. 估计零滞后新息协方差 $E[d_k d_k^\\top]$。**\n\n新息为 $d_k = H e_k^f + \\varepsilon_k$。其协方差为：\n$$E[d_k d_k^\\top] = E[(H e_k^f + \\varepsilon_k)(H e_k^f + \\varepsilon_k)^\\top]$$\n预报误差 $e_k^f$ 依赖于时间 $k-1$ 及更早的误差，因此它与当前的观测误差 $\\varepsilon_k$ 不相关。因此，$E[e_k^f \\varepsilon_k^\\top] = 0$。\n$$E[d_k d_k^\\top] = H E[e_k^f e_k^{f\\top}] H^\\top + E[\\varepsilon_k \\varepsilon_k^\\top] = H P_k^f H^\\top + R$$\n其中 $P_k^f = E[e_k^f e_k^{f\\top}]$ 是预报误差协方差。\n预报误差协方差演化为 $P_k^f = M P_{k-1}^a M^\\top + Q$。所以，\n$$E[d_k d_k^\\top] = H (M P_{k-1}^a M^\\top + Q) H^\\top + R$$\n这个量同时依赖于 $Q$（模型误差协方差）和 $R$（观测误差协方差）。观测到的新息协方差与 DA 模型预测值之间的差异可能是由于 $Q$、$R$ 的错误指定，或滤波器的其他方面（这会影响 $P_{k-1}^a$）。它不能清晰地区分模型误差的存在与观测误差的存在。此外，该选项的理由“观测误差只影响 $d_k$ 的均值而非其协方差”在事实上是错误的，因为 $R$ 是协方差表达式中的一个明确项。\n\n**结论：不正确。**\n\n**C. 估计 $\\ell \\ge 1$ 的滞后新息协方差 $E[d_k d_{k-\\ell}^\\top]$。**\n\n这是一个著名的检验卡尔曼滤波器最优性的方法。对于一个最优滤波器，新息序列 $\\{d_k\\}$ 是白噪声，所以所有的滞后协方差都为零。如果它们不为零，则滤波器是次优的。次优性可能由任何模型参数的错误引起：$M$、$H$、$Q$ 或 $R$。一个非零的结果表明存在问题，但不能唯一地将原因确定为模型误差与观测误差的错误指定。\n该选项声称“在线性模型下，模型误差不能引起新息的序列相关性”是错误的。一个错误指定的模型误差协方差（$Q$）是导致序列相关（非白噪声）新息的经典原因。因此，这个选项中的推理是有缺陷的。\n\n**结论：不正确。**\n\n**D. 比较样本方差 $\\operatorname{tr}(E[e_k^f e_k^{f\\top}])$ 和 $\\operatorname{tr}(E[d_k d_k^\\top])$。**\n\n这建议比较预报误差协方差的迹 $\\operatorname{tr}(P_k^f)$ 与新息协方差的迹 $\\operatorname{tr}(H P_k^f H^\\top + R)$。\n关系是 $\\operatorname{tr}(E[d_k d_k^\\top]) = \\operatorname{tr}(H P_k^f H^\\top) + \\operatorname{tr}(R)$。\n其声称是，如果 $\\operatorname{tr}(E[d_k d_k^\\top])$ 超过 $\\operatorname{tr}(P_k^f)$，就可以断定模型误差存在，理由是“观测误差不能使 $\\operatorname{tr}(E[d_k d_k^\\top])$ 的数值超过 $\\operatorname{tr}(E[e_k^f e_k^{f\\top}])$”。这个推理是有缺陷的。让我们在一个没有模型误差（$Q=0$）但有观测误差（$R \\succ 0$）的简单场景中测试它。比较的是 $\\operatorname{tr}(H P_k^f H^\\top + R)$ 和 $\\operatorname{tr}(P_k^f)$。在一个简单的情况下，其中 $H=I$（单位矩阵，所以 $m=n$），比较变为 $\\operatorname{tr}(P_k^f + R)$ 与 $\\operatorname{tr}(P_k^f)$。由于 $R \\succ 0$，其迹是严格正的，所以 $\\operatorname{tr}(P_k^f + R)  \\operatorname{tr}(P_k^f)$。根据该选项的逻辑，我们会得出存在模型误差的结论，尽管我们假设了它不存在。这表明该检验从根本上是有缺陷的。观测误差通过 $\\operatorname{tr}(R)$ 项直接增加了新息协方差的迹。\n\n**结论：不正确。**\n\n### 总结\n\n在给定的选项中，只有选项 A 提供了一个诊断检验，在指定的假设下，它对模型误差的存在敏感，但对观测误差的存在不敏感。当模型误差以一种产生时间相关性的方式被注入系统动力学时，预报误差的滞后协方差会变为非零，而时间上不相关的观测误差不会在预报误差中产生这样的特征，前提是滤波器产生的分析误差是序列不相关的。", "answer": "$$\\boxed{A}$$", "id": "3403106"}, {"introduction": "在概念上识别出模型误差之后，下一步是对其进行量化。本练习 [@problem_id:3403101] 聚焦于一个常见的诊断量：分析增量（分析减预报）。我们将看到如何利用这些增量的统计特性，特别是它们的均值和方差，来构建一个简单的无量纲比率，从而将持续的模型偏差与随机观测噪声的影响分离开来。", "problem": "考虑一个由三维变分（3D-Var）方案同化的一维状态变量。设同化循环 $k$ 的分析增量表示为 $\\delta x_{k}$，定义为分析与预报之差。假设在一个平稳状态下，预报模式具有恒定的偏差 $b$（模式误差），而观测则受到零均值、时间上不相关且方差有限的噪声（观测误差）的污染。在线性化和平稳性假设下，将增量建模为\n$$\n\\delta x_{k} = b + \\nu_{k},\n$$\n其中 $\\nu_{k}$ 是一个零均值随机波动，代表观测误差和快速去相关的预报误差的综合效应，满足 $\\mathbb{E}[\\nu_{k}] = 0$ 和 $\\operatorname{Var}[\\nu_{k}] = \\sigma^{2}$，且 $\\nu_{k}$ 在不同的 $k$ 之间是独立的。\n\n从独立同分布随机变量的期望和方差的定义出发，仅使用 $\\delta x_{k}$ 的前两阶矩，构建一个时间平均诊断量，以区分持续的模式偏差和观测噪声。具体来说：\n\n- 从 $n$ 个连续增量中推导出 $\\mathbb{E}[\\delta x_{k}]$ 和 $\\operatorname{Var}[\\delta x_{k}]$ 的无偏估计量。\n- 利用在测量单位变化下的基本不变性（尺度不变性）以及相对于 $|\\mathbb{E}[\\delta x_{k}]|$ 和 $\\operatorname{Var}[\\delta x_{k}]$ 的单调性，仅基于 $\\mathbb{E}[\\delta x_{k}]$ 和 $\\operatorname{Var}[\\delta x_{k}]$ 提出一个单一的无量纲标量诊断量，该诊断量随持续偏差的大小增加而增加，随观测噪声驱动的方差增加而减少。\n- 对在 $n = 10$ 个连续循环中收集到的以下增量时间序列（单位：开尔文）评估此诊断量：\n$$\n\\{\\,\\delta x_{k}\\,\\}_{k=1}^{10} = \\{\\,0.0,\\;0.2,\\;0.4,\\;0.6,\\;0.8,\\;1.0,\\;0.3,\\;0.7,\\;0.5,\\;0.5\\,\\}.\n$$\n\n将最终的诊断比率表示为一个无量纲数，并将答案四舍五入到四位有效数字。", "solution": "在尝试任何解答之前，首先对问题陈述进行验证。\n\n### 步骤 1：提取已知条件\n-   循环 $k$ 的分析增量为 $\\delta x_{k}$。\n-   增量的模型为 $\\delta x_{k} = b + \\nu_{k}$。\n-   $b$ 是一个恒定的模式偏差。\n-   $\\nu_{k}$ 是一个零均值随机波动，满足 $\\mathbb{E}[\\nu_{k}] = 0$。\n-   该波动的方差为 $\\operatorname{Var}[\\nu_{k}] = \\sigma^{2}$。\n-   波动 $\\nu_{k}$ 在不同循环 $k$ 之间是独立的。\n-   任务要求从 $n$ 个增量的样本中推导出 $\\mathbb{E}[\\delta x_{k}]$ 和 $\\operatorname{Var}[\\delta x_{k}]$ 的无偏估计量。\n-   任务要求仅基于 $\\mathbb{E}[\\delta x_{k}]$ 和 $\\operatorname{Var}[\\delta x_{k}]$ 提出一个单一的无量纲标量诊断量。\n-   该诊断量必须是尺度不变的。\n-   该诊断量必须相对于 $|\\mathbb{E}[\\delta x_{k}]|$ 单调递增。\n-   该诊断量必须相对于 $\\operatorname{Var}[\\delta x_{k}]$ 单调递减。\n-   任务要求对给定的 $n=10$ 个增量的时间序列评估此诊断量：$\\{\\,\\delta x_{k}\\,\\}_{k=1}^{10} = \\{\\,0.0,\\;0.2,\\;0.4,\\;0.6,\\;0.8,\\;1.0,\\;0.3,\\;0.7,\\;0.5,\\;0.5\\,\\}$。\n-   最终数值答案必须四舍五入到四位有效数字。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题在科学上和数学上是合理的。模型 $\\delta x_{k} = b + \\nu_{k}$ 是一个恒定信号被加性噪声污染的标准统计表示，这是信号处理和数据同化中的一个基本概念。该问题是适定的，提供了所有必要的定义、数据和约束，以推导和计算出唯一的答案。对诊断量的要求（无量纲、单调行为、尺度不变性）是精确的，并指导构建一个熟悉的统计量，即信噪比。所提供的数值数据在物理上是合理的。该问题不违反任何验证标准。\n\n### 步骤 3：结论与行动\n问题有效。将提供完整的解答。\n\n### 解答推导\n问题要求基于分析增量的时间序列 $\\delta x_k$，提出一个能够区分持续模式偏差 $b$ 和随机波动 $\\nu_k$ 的诊断量。模型由下式给出\n$$\n\\delta x_{k} = b + \\nu_{k}\n$$\n其中 $b$ 是一个常数，$\\nu_k$ 是独立的随机变量，满足 $\\mathbb{E}[\\nu_k] = 0$ 和 $\\operatorname{Var}[\\nu_k] = \\sigma^2$。\n\n首先，我们确定 $\\delta x_k$ 的前两阶矩。\n使用期望算子的线性性质，可以求出 $\\delta x_k$ 的期望：\n$$\n\\mathbb{E}[\\delta x_k] = \\mathbb{E}[b + \\nu_k] = \\mathbb{E}[b] + \\mathbb{E}[\\nu_k]\n$$\n由于 $b$ 是常数，$\\mathbb{E}[b] = b$。已知 $\\mathbb{E}[\\nu_k] = 0$。因此，\n$$\n\\mathbb{E}[\\delta x_k] = b\n$$\n分析增量的期望等于模式偏差。\n\n使用方差算子的性质可以求出 $\\delta x_k$ 的方差。对于常数 $c$，$\\operatorname{Var}[X+c] = \\operatorname{Var}[X]$。因此，\n$$\n\\operatorname{Var}[\\delta x_k] = \\operatorname{Var}[b + \\nu_k] = \\operatorname{Var}[\\nu_k]\n$$\n已知 $\\operatorname{Var}[\\nu_k] = \\sigma^2$。因此，\n$$\n\\operatorname{Var}[\\delta x_k] = \\sigma^2\n$$\n分析增量的方差等于随机波动的方差。\n\n接下来，我们从 $n$ 个增量的样本 $\\{\\delta x_k\\}_{k=1}^n$ 中构建这些矩的无偏估计量。\n均值 $\\mathbb{E}[\\delta x_k] = b$ 的一个无偏估计量是样本均值，记为 $\\hat{b}$：\n$$\n\\hat{b} = \\frac{1}{n} \\sum_{k=1}^{n} \\delta x_k\n$$\n这个估计量是无偏的，因为 $\\mathbb{E}[\\hat{b}] = \\frac{1}{n} \\sum_{k=1}^{n} \\mathbb{E}[\\delta x_k] = \\frac{1}{n} \\sum_{k=1}^{n} b = \\frac{nb}{n} = b$。\n\n当均值从样本中估计时，方差 $\\operatorname{Var}[\\delta x_k] = \\sigma^2$ 的一个无偏估计量是带有贝塞尔校正的样本方差，记为 $\\hat{\\sigma}^2$：\n$$\n\\hat{\\sigma}^2 = \\frac{1}{n-1} \\sum_{k=1}^{n} (\\delta x_k - \\hat{b})^2\n$$\n\n现在，我们提出了一个满足指定属性的诊断量 $D$。\n1.  **无量纲和尺度不变性**：假设 $\\delta x_k$ 的单位按因子 $c  0$ 进行缩放，使得 $\\delta x'_k = c \\cdot \\delta x_k$。矩的变换为 $\\mathbb{E}[\\delta x'_k] = c \\cdot \\mathbb{E}[\\delta x_k]$ 和 $\\operatorname{Var}[\\delta x'_k] = c^2 \\cdot \\operatorname{Var}[\\delta x_k]$。诊断量 $D$ 在此变换下必须是不变的。形式为 $\\frac{(\\mathbb{E}[\\delta x_k])^p}{(\\operatorname{Var}[\\delta x_k])^q}$ 的比率变换为 $\\frac{(c \\cdot \\mathbb{E}[\\delta x_k])^p}{(c^2 \\cdot \\operatorname{Var}[\\delta x_k])^q} = c^{p-2q} \\frac{(\\mathbb{E}[\\delta x_k])^p}{(\\operatorname{Var}[\\delta x_k])^q}$。为了实现不变性，我们需要 $p - 2q = 0$。最简单的非平凡选择是 $p=2, q=1$。\n2.  **单调性**：该诊断量必须随 $|\\mathbb{E}[\\delta x_k]|$ 的增加而增加，并随 $\\operatorname{Var}[\\delta x_k]$ 的增加而减少。\n\n我们将诊断量 $D$ 定义为期望与标准差之比的平方，这等价于期望的平方与方差之比。这通常被称为平方信噪比。\n$$\nD = \\frac{(\\mathbb{E}[\\delta x_k])^2}{\\operatorname{Var}[\\delta x_k]} = \\frac{b^2}{\\sigma^2}\n$$\n该诊断量是无量纲的，因为分子和分母的单位都是 $(\\text{units of } \\delta x_k)^2$。如上文所示，当 $p=2, q=1$ 时，它满足尺度不变性。它显然随着 $|b|=|\\mathbb{E}[\\delta x_k]|$ 的增加而增加，并随着 $\\sigma^2 = \\operatorname{Var}[\\delta x_k]$ 的增加而减少，因此满足所有要求。\n\n为了从数据中计算该诊断量，我们使用估计量 $\\hat{b}$ 和 $\\hat{\\sigma}^2$：\n$$\n\\hat{D} = \\frac{\\hat{b}^2}{\\hat{\\sigma}^2}\n$$\n\n最后，我们对给定的时间序列评估此诊断量：\n$\\{\\,\\delta x_{k}\\,\\}_{k=1}^{10} = \\{\\,0.0,\\;0.2,\\;0.4,\\;0.6,\\;0.8,\\;1.0,\\;0.3,\\;0.7,\\;0.5,\\;0.5\\,\\}$，其中 $n=10$。\n\n首先，我们计算样本均值 $\\hat{b}$：\n$$\n\\sum_{k=1}^{10} \\delta x_k = 0.0 + 0.2 + 0.4 + 0.6 + 0.8 + 1.0 + 0.3 + 0.7 + 0.5 + 0.5 = 5.0\n$$\n$$\n\\hat{b} = \\frac{5.0}{10} = 0.5\n$$\n\n接下来，我们计算与均值的离差平方和：\n$$\n\\sum_{k=1}^{10} (\\delta x_k - \\hat{b})^2 = \\sum_{k=1}^{10} (\\delta x_k - 0.5)^2\n$$\n各项为：\n$(0.0-0.5)^2 = (-0.5)^2 = 0.25$\n$(0.2-0.5)^2 = (-0.3)^2 = 0.09$\n$(0.4-0.5)^2 = (-0.1)^2 = 0.01$\n$(0.6-0.5)^2 = (0.1)^2 = 0.01$\n$(0.8-0.5)^2 = (0.3)^2 = 0.09$\n$(1.0-0.5)^2 = (0.5)^2 = 0.25$\n$(0.3-0.5)^2 = (-0.2)^2 = 0.04$\n$(0.7-0.5)^2 = (0.2)^2 = 0.04$\n$(0.5-0.5)^2 = (0.0)^2 = 0.0$\n$(0.5-0.5)^2 = (0.0)^2 = 0.0$\n\n总和为：\n$$\n\\sum_{k=1}^{10} (\\delta x_k - 0.5)^2 = 0.25 + 0.09 + 0.01 + 0.01 + 0.09 + 0.25 + 0.04 + 0.04 + 0.0 + 0.0 = 0.78\n$$\n\n现在，我们计算无偏样本方差 $\\hat{\\sigma}^2$：\n$$\n\\hat{\\sigma}^2 = \\frac{1}{n-1} \\sum_{k=1}^{10} (\\delta x_k - \\hat{b})^2 = \\frac{0.78}{10-1} = \\frac{0.78}{9}\n$$\n\n最后，我们计算估计的诊断量 $\\hat{D}$：\n$$\n\\hat{D} = \\frac{\\hat{b}^2}{\\hat{\\sigma}^2} = \\frac{(0.5)^2}{0.78/9} = \\frac{0.25}{0.78/9} = \\frac{0.25 \\times 9}{0.78} = \\frac{2.25}{0.78}\n$$\n$$\n\\hat{D} \\approx 2.88461538...\n$$\n四舍五入到四位有效数字，我们得到 $2.885$。", "answer": "$$\\boxed{2.885}$$", "id": "3403101"}, {"introduction": "我们的最终目标不仅是诊断和量化误差，还要主动地对其进行校正。本练习 [@problem_id:3403056] 介绍了一种强大的技术——状态增广，它将模型误差本身（在此例中为一个缓慢变化的偏差）视为状态向量中的一个附加变量。通过这种方式，我们可以利用数据同化机制（如卡尔曼滤波器）来随时间估计和追踪模型误差，从而获得更准确的状态估计。", "problem": "考虑一个标量离散时间线性动力系统，其加性模型误差表现为一个缓慢变化的偏差。潜状态为 $x_k \\in \\mathbb{R}$，加性模型误差偏差为 $b_k \\in \\mathbb{R}$。过程模型和观测模型为\n$$\nx_{k+1} = a\\,x_k + b_k + w_k, \\quad y_k = c\\,x_k + v_k,\n$$\n其中 $a \\in \\mathbb{R}$ 和 $c \\in \\mathbb{R}$ 是已知系数，$w_k$ 是零均值高斯过程噪声，其方差为 $q \\in \\mathbb{R}_{\\ge 0}$，$v_k$ 是零均值高斯观测噪声，其方差为 $r \\in \\mathbb{R}_{0}$。假设 $w_k$ 和 $v_k$ 相互独立且随时间独立。为了能够从数据中估计偏差 $b_k$，将 $b_k$ 建模为随机游走：\n$$\nb_{k+1} = b_k + u_k,\n$$\n其中 $u_k$ 是零均值高斯噪声，其方差为 $s \\in \\mathbb{R}_{\\ge 0}$，且与 $w_k$ 和 $v_k$ 相互独立并随时间独立。\n\n任务：\n- 构建包含 $x_k$ 和 $b_k$ 的增广状态向量 $z_k \\in \\mathbb{R}^2$，并通过指定 $2 \\times 2$ 的状态转移矩阵、$2 \\times 2$ 的过程噪声协方差矩阵和 $1 \\times 2$ 的观测矩阵，推导出相应的增广线性状态转移方程和观测方程。\n- 假设在线性高斯框架下，在时间 $k$ 进行单步数据同化。设增广状态的预报（先验）均值和协方差分别表示为 $\\mathbb{E}[z_k \\mid \\mathcal{F}_{k-1}]$ 和 $P_k^{\\mathrm{f}} \\in \\mathbb{R}^{2 \\times 2}$，其中\n$$\nP_k^{\\mathrm{f}} = \\begin{pmatrix} p_x  p_{xb} \\\\ p_{xb}  p_b \\end{pmatrix},\n$$\n其中 $p_x \\in \\mathbb{R}_{\\ge 0}$，$p_b \\in \\mathbb{R}_{\\ge 0}$，$p_{xb} \\in \\mathbb{R}$。使用线性高斯贝叶斯更新，推导出对应于偏差 $b_k$ 的卡尔曼增益分量，即时间 $k$ 的 $2 \\times 1$ 卡尔曼增益向量的第二个条目，其形式为一个关于 $p_x$、$p_{xb}$、$c$ 和 $r$ 的闭式解析表达式。\n\n你的最终答案必须是这个单一的解析表达式。不要包含单位。不要提供不等式或方程；只提供表达式本身。", "solution": "该问题要求推导增广状态空间系统的卡尔曼增益的一个分量。根据程序规定，第一步是验证问题陈述。\n\n### 问题验证\n\n1.  **提取已知条件：**\n    *   状态方程：$x_{k+1} = a\\,x_k + b_k + w_k$\n    *   观测方程：$y_k = c\\,x_k + v_k$\n    *   偏差动态：$b_{k+1} = b_k + u_k$\n    *   状态和参数：$x_k \\in \\mathbb{R}$，$b_k \\in \\mathbb{R}$，$y_k \\in \\mathbb{R}$，$a \\in \\mathbb{R}$，$c \\in \\mathbb{R}$。\n    *   噪声过程：$w_k \\sim \\mathcal{N}(0, q)$，$v_k \\sim \\mathcal{N}(0, r)$，$u_k \\sim \\mathcal{N}(0, s)$。\n    *   噪声特性：$q \\ge 0$，$r  0$，$s \\ge 0$。所有噪声过程相互独立且随时间独立。\n    *   增广状态的预报（先验）协方差：$P_k^{\\mathrm{f}} = \\begin{pmatrix} p_x  p_{xb} \\\\ p_{xb}  p_b \\end{pmatrix}$。\n\n2.  **使用提取的已知条件进行验证：**\n    *   **科学基础：** 该问题是卡尔曼滤波器在带有增广状态向量的线性系统中的一个标准应用，用于估计缓慢变化的偏差。这是数据同化和控制理论中一种基础且广泛使用的技术。\n    *   **适定性：** 该问题是适定的。它提供了构建增广系统和推导卡尔曼增益所需的所有数学定义和参数值。条件 $r  0$ 确保了新息协方差矩阵是可逆的。\n    *   **客观性：** 该问题以精确、客观的数学语言陈述，没有任何歧义或主观内容。\n\n3.  **结论与行动：** 问题被判定为 **有效**。将推导解答。\n\n### 解答推导\n\n解答过程根据问题陈述分为两部分。首先，我们构建增广状态空间模型。其次，我们计算该增广系统的卡尔曼增益，并提取所需的分量。\n\n**第一部分：增广状态空间模型**\n\n我们通过堆叠潜状态 $x_k$ 和偏差 $b_k$ 来定义增广状态向量 $z_k \\in \\mathbb{R}^2$：\n$$\nz_k = \\begin{pmatrix} x_k \\\\ b_k \\end{pmatrix}\n$$\n$z_k$ 的状态转移动态由给定方程推导得出：\n$$\nx_{k+1} = a x_k + 1 \\cdot b_k + w_k\n$$\n$$\nb_{k+1} = 0 \\cdot x_k + 1 \\cdot b_k + u_k\n$$\n这些可以写成矩阵形式：\n$$\n\\begin{pmatrix} x_{k+1} \\\\ b_{k+1} \\end{pmatrix} = \\begin{pmatrix} a  1 \\\\ 0  1 \\end{pmatrix} \\begin{pmatrix} x_k \\\\ b_k \\end{pmatrix} + \\begin{pmatrix} w_k \\\\ u_k \\end{pmatrix}\n$$\n这对应于增广状态转移方程 $z_{k+1} = F z_k + \\eta_k$，其中状态转移矩阵 $F$ 是\n$$\nF = \\begin{pmatrix} a  1 \\\\ 0  1 \\end{pmatrix}\n$$\n增广过程噪声向量为 $\\eta_k = \\begin{pmatrix} w_k \\\\ u_k \\end{pmatrix}$。\n\n增广过程噪声的协方差矩阵 $Q_{aug}$ 由 $Q_{aug} = \\mathbb{E}[\\eta_k \\eta_k^T]$ 给出。由于 $w_k$ 和 $u_k$ 是独立的且均值为零，它们的互协方差 $\\mathbb{E}[w_k u_k]$ 为 $0$。\n$$\nQ_{aug} = \\mathbb{E}\\left[ \\begin{pmatrix} w_k \\\\ u_k \\end{pmatrix} \\begin{pmatrix} w_k  u_k \\end{pmatrix} \\right] = \\begin{pmatrix} \\mathbb{E}[w_k^2]  \\mathbb{E}[w_k u_k] \\\\ \\mathbb{E}[u_k w_k]  \\mathbb{E}[u_k^2] \\end{pmatrix} = \\begin{pmatrix} q  0 \\\\ 0  s \\end{pmatrix}\n$$\n观测方程为 $y_k = c x_k + v_k$。用增广状态 $z_k$ 表示，即为：\n$$\ny_k = \\begin{pmatrix} c  0 \\end{pmatrix} \\begin{pmatrix} x_k \\\\ b_k \\end{pmatrix} + v_k\n$$\n这对应于增广观测方程 $y_k = H z_k + v_k$，其中观测矩阵 $H$ 是\n$$\nH = \\begin{pmatrix} c  0 \\end{pmatrix}\n$$\n观测噪声是 $v_k$，其方差是一个标量 $R_k = r$。\n\n**第二部分：卡尔曼增益推导**\n\n增广系统的卡尔曼增益 $K_k$ 是一个 $2 \\times 1$ 的向量，由以下公式给出：\n$$\nK_k = P_k^{\\mathrm{f}} H^T (H P_k^{\\mathrm{f}} H^T + R_k)^{-1}\n$$\n我们已知预报（先验）协方差矩阵 $P_k^{\\mathrm{f}}$：\n$$\nP_k^{\\mathrm{f}} = \\begin{pmatrix} p_x  p_{xb} \\\\ p_{xb}  p_b \\end{pmatrix}\n$$\n观测矩阵为 $H = \\begin{pmatrix} c  0 \\end{pmatrix}$，所以其转置 $H^T$ 是：\n$$\nH^T = \\begin{pmatrix} c \\\\ 0 \\end{pmatrix}\n$$\n首先，我们计算项 $P_k^{\\mathrm{f}} H^T$：\n$$\nP_k^{\\mathrm{f}} H^T = \\begin{pmatrix} p_x  p_{xb} \\\\ p_{xb}  p_b \\end{pmatrix} \\begin{pmatrix} c \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} c p_x + 0 \\cdot p_{xb} \\\\ c p_{xb} + 0 \\cdot p_b \\end{pmatrix} = \\begin{pmatrix} c p_x \\\\ c p_{xb} \\end{pmatrix}\n$$\n接下来，我们计算新息协方差项 $H P_k^{\\mathrm{f}} H^T$。由于 $y_k$ 是一个标量，这个项也将是一个标量。\n$$\nH P_k^{\\mathrm{f}} H^T = \\begin{pmatrix} c  0 \\end{pmatrix} \\left( \\begin{pmatrix} p_x  p_{xb} \\\\ p_{xb}  p_b \\end{pmatrix} \\begin{pmatrix} c \\\\ 0 \\end{pmatrix} \\right) = \\begin{pmatrix} c  0 \\end{pmatrix} \\begin{pmatrix} c p_x \\\\ c p_{xb} \\end{pmatrix} = c(c p_x) + 0(c p_{xb}) = c^2 p_x\n$$\n总的新息协方差是 $S_k = H P_k^{\\mathrm{f}} H^T + R_k$。由于 $R_k = r$，我们有：\n$$\nS_k = c^2 p_x + r\n$$\n由于这是一个标量，其逆就是它的倒数：\n$$\n(S_k)^{-1} = \\frac{1}{c^2 p_x + r}\n$$\n分母是严格为正的，因为 $r0$，$p_x \\ge 0$，且 $c^2 \\ge 0$。\n\n最后，我们组合出卡尔曼增益向量 $K_k$：\n$$\nK_k = (P_k^{\\mathrm{f}} H^T) (S_k)^{-1} = \\begin{pmatrix} c p_x \\\\ c p_{xb} \\end{pmatrix} \\frac{1}{c^2 p_x + r} = \\begin{pmatrix} \\frac{c p_x}{c^2 p_x + r} \\\\ \\frac{c p_{xb}}{c^2 p_x + r} \\end{pmatrix}\n$$\n问题要求的是对应于偏差 $b_k$ 的卡尔曼增益分量，也就是向量 $K_k$ 的第二个条目。我们用 $K_k^{(b)}$ 表示这个分量。\n$$\nK_k^{(b)} = \\frac{c p_{xb}}{c^2 p_x + r}\n$$\n这就是以要求的变量 $p_x$、$p_{xb}$、$c$ 和 $r$ 表示的最终解析表达式。", "answer": "$$\\boxed{\\frac{c p_{xb}}{c^{2} p_x + r}}$$", "id": "3403056"}]}