{"hands_on_practices": [{"introduction": "变分资料同化的基础是通过最小化一个成本函数来平衡先验知识与新的观测信息。本练习将通过要求您将成本函数中的项解释为马氏距离（Mahalanobis distances）的平方来巩固这一基本概念 [@problem_id:3389790]。接着，它通过一个简单而具体的计算，演示了调整信息源（即背景场与观测场）的相对权重——这是混合协方差调优的一个关键方面——如何直接影响最终的分析结果。", "problem": "考虑一个混合集合-变分（EnVar）数据同化设置中的线性高斯逆问题。先验状态 $x \\in \\mathbb{R}^{n}$ 被建模为高斯分布，其均值为 $x_{b}$，正定混合背景协方差为 $B_{h}$，该协方差由凸组合 $B_{h} = (1 - \\lambda) B_{\\mathrm{clim}} + \\lambda B_{\\mathrm{ens}}$ (其中 $0  \\lambda  1$) 构成，其中 $B_{\\mathrm{clim}}$ 是气候学协方差，$B_{\\mathrm{ens}}$ 是集合派生的协方差。观测值 $y \\in \\mathbb{R}^{m}$ 由线性观测算子 $H \\in \\mathbb{R}^{m \\times n}$ 给出，并带有加性高斯噪声 $\\epsilon \\sim \\mathcal{N}(0, R)$，其中 $R \\in \\mathbb{R}^{m \\times m}$ 是对称正定矩阵。\n\n从高斯先验和似然的贝叶斯定理出发，并根据由对称正定协方差矩阵 $C$ 导出的马氏距离（Mahalanobis distance）的定义，即映射 $v \\mapsto v^{\\top} C^{-1} v$，论证为何背景协方差 $B_{h}$ 和观测误差协方差 $R$ 定义了在负对数后验中加权先验和数据失配的马氏度量。仔细解释这些度量如何作为相应失配的白化欧几里得范数。\n\n然后，将问题特化为一维情况，其中标量 $x \\in \\mathbb{R}$，标量观测算子 $H = h \\neq 0$，标量混合背景方差 $B_{h} = b  0$，以及标量观测误差方差 $R = r  0$。假设作为协方差建模的一部分，混合背景协方差被均匀缩放为 $\\alpha B_{h}$ (其中 $\\alpha  0$)，同时保持所有其他量不变。\n\n推导后验方差 $a(\\alpha)$ 和卡尔曼增益 $k(\\alpha)$ 作为 $\\alpha$、$b$、$r$ 和 $h$ 的函数的闭式表达式。以包含 $a(\\alpha)$ 和 $k(\\alpha)$ 解析表达式的单行矩阵形式提供您的最终答案。不要代入数值。最终答案必须是以给定符号表示的解析表达式。", "solution": "该问题是有效的，因为它在科学上基于贝叶斯推断和统计估计理论，问题设定良好，信息充分且一致，并且陈述客观。它代表了数据同化领域一个标准的、非平凡的练习。\n\n### 第1部分：马氏度量的论证\n\n该问题设定在线性高斯框架内。状态向量 $x \\in \\mathbb{R}^{n}$ 的先验分布是高斯分布，由 $p(x) = \\mathcal{N}(x_{b}, B_{h})$ 给出。其概率密度函数（PDF）为：\n$$p(x) = \\frac{1}{\\sqrt{(2\\pi)^{n} \\det(B_{h})}} \\exp\\left(-\\frac{1}{2} (x - x_{b})^{\\top} B_{h}^{-1} (x - x_{b})\\right)$$\n其中 $x_{b}$ 是先验（或背景）均值，$B_{h}$ 是对称正定的混合背景协方差矩阵。\n\n观测值 $y \\in \\mathbb{R}^{m}$ 通过线性模型 $y = Hx + \\epsilon$ 与状态 $x$ 相关联，其中 $H \\in \\mathbb{R}^{m \\times n}$ 是观测算子，$\\epsilon$ 是观测噪声，服从均值为零、协方差矩阵为对称正定矩阵 $R$ 的高斯分布，即 $\\epsilon \\sim \\mathcal{N}(0, R)$。这意味着给定状态下观测值的似然 $p(y|x)$ 也是高斯分布，其均值为 $Hx$，协方差为 $R$。其概率密度函数为：\n$$p(y|x) = \\frac{1}{\\sqrt{(2\\pi)^{m} \\det(R)}} \\exp\\left(-\\frac{1}{2} (y - Hx)^{\\top} R^{-1} (y - Hx)\\right)$$\n\n根据 Bayes 定理，给定观测值下状态的后验分布 $p(x|y)$ 与似然和先验的乘积成正比：\n$$p(x|y) \\propto p(y|x) p(x)$$\n代入高斯概率密度函数的表达式，我们得到：\n$$p(x|y) \\propto \\exp\\left(-\\frac{1}{2} (y - Hx)^{\\top} R^{-1} (y - Hx)\\right) \\exp\\left(-\\frac{1}{2} (x - x_{b})^{\\top} B_{h}^{-1} (x - x_{b})\\right)$$\n$$p(x|y) \\propto \\exp\\left(-\\frac{1}{2} \\left[ (x - x_{b})^{\\top} B_{h}^{-1} (x - x_{b}) + (y - Hx)^{\\top} R^{-1} (y - Hx) \\right]\\right)$$\n后验分布也是高斯分布，其众数（最可能的状态）通过最小化后验概率密度函数的负对数来找到。这导出了变分代价函数 $J(x)$：\n$$J(x) = \\frac{1}{2} (x - x_{b})^{\\top} B_{h}^{-1} (x - x_{b}) + \\frac{1}{2} (y - Hx)^{\\top} R^{-1} (y - Hx)$$\n问题将由对称正定协方差矩阵 $C$ 对向量 $v$ 导出的马氏距离定义为 $v^{\\top} C^{-1} v$。让我们识别代价函数 $J(x)$ 中的各项：\n1.  向量 $v_{b} = x - x_{b}$ 代表先验（或背景）失配，即状态估计 $x$ 与先验均值 $x_{b}$ 之间的偏差。\n2.  向量 $v_{o} = y - Hx$ 代表数据（或观测）失配，即模型预测的观测值 $Hx$ 与实际观测值 $y$ 之间的偏差。\n\n代价函数可以写成：\n$$J(x) = \\frac{1}{2} v_{b}^{\\top} B_{h}^{-1} v_{b} + \\frac{1}{2} v_{o}^{\\top} R^{-1} v_{o}$$\n第一项 $(x - x_{b})^{\\top} B_{h}^{-1} (x - x_{b})$ 正是先验失配向量 $v_{b}$ 相对于背景协方差矩阵 $B_{h}$ 的马氏距离。第二项 $(y - Hx)^{\\top} R^{-1} (y - Hx)$ 是数据失配向量 $v_{o}$ 相对于观测误差协方差矩阵 $R$ 的马氏距离。因此，该最小化过程旨在寻找一个状态 $x$，以平衡先验失配和数据失配的马氏距离，这论证了 $B_{h}$ 和 $R$ 定义了在负对数后验中对这些相应失配进行加权的马氏度量。\n\n为了解释这些度量如何充当白化欧几里得范数，我们考虑白化过程。如果一个随机向量的各分量不相关且方差为单位1，则该向量是“白”的，意味着其协方差矩阵是单位矩阵 $I$。对于一个对称正定矩阵 $C$，可以找到一个“平方根”矩阵 $L$，使得 $C = LL^{\\top}$（例如，通过 Cholesky 分解）。其逆矩阵为 $C^{-1} = (L^{\\top})^{-1}L^{-1}$。马氏距离可以重写为：\n$$v^{\\top} C^{-1} v = v^{\\top} (L^{\\top})^{-1}L^{-1} v = (L^{-1}v)^{\\top} (L^{-1}v) = \\|L^{-1}v\\|_{2}^{2}$$\n向量 $w = L^{-1}v$ 是 $v$ 的白化版本。如果 $v$ 是一个协方差为 $C$ 的随机向量，那么 $w$ 的协方差是 $\\text{Cov}(w) = L^{-1}\\text{Cov}(v)(L^{-1})^{\\top} = L^{-1}C(L^{\\top})^{-1} = L^{-1}(LL^{\\top})(L^{\\top})^{-1} = I$。\n因此，马氏距离 $v^{\\top}C^{-1}v$ 是白化向量 $L^{-1}v$ 的欧几里得范数的平方。\n\n将此应用于我们的代价函数：\n- 背景项 $(x-x_{b})^{\\top} B_{h}^{-1} (x-x_{b})$ 是由矩阵 $B_{h}^{-1/2}$ 白化的背景失配 $(x-x_{b})$ 的欧几里得范数的平方。该变换以先验标准差为单位重新缩放失配，从而对高先验不确定性方向上的偏差赋予较小的权重。\n- 观测项 $(y-Hx)^{\\top} R^{-1} (y-Hx)$ 是由矩阵 $R^{-1/2}$ 白化的观测失配 $(y-Hx)$ 的欧几里得范数的平方。该变换以观测误差标准差为单位重新缩放失配，从而对误差较大的观测值中的偏差赋予较小的权重。\n\n### 第2部分：一维缩放情况的推导\n\n现在我们将问题特化到具有以下参数的一维情况：\n- 状态 $x \\in \\mathbb{R}$。\n- 先验均值 $x_{b}$。\n- 先验方差被缩放：$B' = \\alpha B_{h} = \\alpha b$，其中 $\\alpha  0$ 且 $b  0$。\n- 观测算子 $H = h \\in \\mathbb{R}$，其中 $h \\neq 0$。\n- 观测误差方差 $R = r  0$。\n\n该标量线性高斯系统的后验分布也是高斯分布。我们需要求出其方差，记为 $a(\\alpha)$，以及卡尔曼增益，记为 $k(\\alpha)$。\n\n后验方差 $P_{a}$ 的逆的标准公式是先验方差 $B$ 的逆与观测信息 $H^{\\top}R^{-1}H$ 之和：\n$$P_{a}^{-1} = B^{-1} + H^{\\top}R^{-1}H$$\n在我们的特化情况下，$P_{a} = a(\\alpha)$，$B = B' = \\alpha b$，$H = h$，$R = r$。所有量都是标量，因此转置操作是恒等操作。\n$$a(\\alpha)^{-1} = (\\alpha b)^{-1} + h r^{-1} h = \\frac{1}{\\alpha b} + \\frac{h^{2}}{r}$$\n为了求出 $a(\\alpha)$，我们首先合并右侧的各项：\n$$a(\\alpha)^{-1} = \\frac{r + \\alpha b h^{2}}{\\alpha b r}$$\n对两边取倒数，得到后验方差 $a(\\alpha)$ 的表达式：\n$$a(\\alpha) = \\frac{\\alpha b r}{r + \\alpha b h^{2}}$$\n\n接下来，我们推导卡尔曼增益 $K$，在此记为 $k(\\alpha)$。标准公式是：\n$$K = B H^{\\top} (H B H^{\\top} + R)^{-1}$$\n代入我们的特化标量参数：\n$$k(\\alpha) = (\\alpha b) h (h (\\alpha b) h + r)^{-1}$$\n$$k(\\alpha) = \\alpha b h ( \\alpha b h^{2} + r)^{-1}$$\n这给出了卡尔曼增益 $k(\\alpha)$ 的闭式表达式：\n$$k(\\alpha) = \\frac{\\alpha b h}{r + \\alpha b h^{2}}$$\n\n推导出的 $a(\\alpha)$ 和 $k(\\alpha)$ 表达式是给定参数 $\\alpha、b、r、h$ 的函数。", "answer": "$$\\boxed{\\begin{pmatrix} \\frac{\\alpha b r}{r + \\alpha b h^{2}}  \\frac{\\alpha b h}{r + \\alpha b h^{2}} \\end{pmatrix}}$$", "id": "3389790"}, {"introduction": "在大型系统中，当集合成员数量远小于状态维数时，纯集合背景误差协方差矩阵（$B_e$）会存在严重的秩亏问题。本练习旨在挑战您分析此秩亏问题在线性代数层面的后果，并理解两种关键技术——与静态协方差的混合化以及协方差局地化——如何解决这一关键问题 [@problem_id:3389728]。通过解决这个问题，您将明白这些技术是如何确保分析增量不会被虚假地限制在一个低维子空间中的。", "problem": "考虑一个线性高斯数据同化设置，其中状态向量为 $x \\in \\mathbb{R}^{n}$，背景（先验）状态为 $x_{b} \\in \\mathbb{R}^{n}$，线性观测算子为 $H \\in \\mathbb{R}^{p \\times n}$，观测为 $y \\in \\mathbb{R}^{p}$，观测误差协方差 $R \\in \\mathbb{R}^{p \\times p}$ 为对称正定矩阵。给定一个大小为 $m$ 的先验状态集合 $\\{x^{(i)}\\}_{i=1}^{m}$，其集合平均为 $\\bar{x} = \\tfrac{1}{m} \\sum_{i=1}^{m} x^{(i)}$，扰动矩阵 $A \\in \\mathbb{R}^{n \\times m}$ 的列定义为 $A_{:,i} = x^{(i)} - \\bar{x}$。标准的无偏集合协方差估计为 $B_{e} = \\tfrac{1}{m-1} A A^{\\top}$。\n\n假设 $m \\ll n$。分析增量 $\\delta x \\in \\mathbb{R}^{n}$ 定义为加到 $x_{b}$ 上的更新量。您可以假设以下广泛使用的公式：\n- 对于先验协方差 $B$，Kalman 增益（适用于线性高斯模型）为 $K(B) = B H^{\\top} \\left(H B H^{\\top} + R \\right)^{-1}$，相应的线性更新为 $\\delta x = K(B)\\,(y - H x_{b})$。\n- 在集合-变分方法（Ensemble-Variational (EnVar)）中，一种常见的控制变量公式通过将增量写为 $\\delta x = A w$（对于某个 $w \\in \\mathbb{R}^{m}$）并最小化关于 $w$ 的二次代价函数，从而将增量约束在集合子空间内。\n- 在混合协方差中，使用凸组合 $B_{h} = (1-\\beta) B_{s} + \\beta B_{e}$，其中 $0  \\beta  1$，$B_{s} \\in \\mathbb{R}^{n \\times n}$ 是一个对称正定的静态气候协方差。\n- 通过 Schur (Hadamard) 积进行的协方差局地化使用一个对称正定矩阵 $L \\in \\mathbb{R}^{n \\times n}$（例如，具有紧支撑相关的矩阵）来定义 $\\widetilde{B} = L \\circ B$，其中 $(L \\circ B)_{ij} = L_{ij} B_{ij}$。\n\n仅使用线性代数事实和上述定义，分析当 $m \\ll n$ 时 $B_{e}$ 的秩亏及其对分析增量空间的影响。选择所有正确的陈述。\n\nA. $B_e$ 的秩满足 $\\operatorname{rank}(B_{e}) \\le m-1$，等号成立当且仅当 $m$ 个扰动列向量仅存在一个由减去均值引起的线性相关性；因此，对于使用 $B_e$ 的 Kalman 更新，$\\delta x \\in \\operatorname{range}(B_{e}) = \\operatorname{range}(A)$。\n\nB. 在集合-变分控制变量公式 $\\delta x = A w$ 中，即使当 $m \\ll n$ 时，随着 $m$ 的增长，增量也可以探索 $\\mathbb{R}^{n}$ 中的任何方向。\n\nC. 如果 $L$ 是稠密的对称正定矩阵，那么在一般条件下（例如，如果扰动项非零），局地化的协方差 $\\widetilde{B}_{e} = L \\circ B_{e}$ 可以是满秩的，并且使用 $\\widetilde{B}_{e}$ 的 Kalman 更新可以产生不局限于 $\\operatorname{span}(A)$ 的增量。\n\nD. 对于混合协方差 $B_{h} = (1-\\beta) B_{s} + \\beta B_{e}$，其中 $B_{s}$ 是对称正定的，由 $K(B_{h})$ 产生的分析增量不受限于集合子空间，即使没有进行局地化。\n\nE. $B_{e}$ 的零空间是 $\\operatorname{span}(A)$ 的正交补；因此，任何纯基于 $B_{e}$ 的线性更新都会使背景在属于该零空间的方向上保持不变。\n\nF. 对于任何线性 $H$ 和正定 $R$，当观测数量 $p$ 足够大时，使用 $B_{e}$ 的 Kalman 更新可以生成包含与 $\\operatorname{range}(A)$ 正交的分量的分析增量。\n\n选择所有适用的选项：A, B, C, D, E, F。", "solution": "在进行求解之前，先对问题陈述的有效性进行审视。\n\n### 第 1 步：提取已知条件\n- 状态向量: $x \\in \\mathbb{R}^{n}$\n- 背景状态: $x_{b} \\in \\mathbb{R}^{n}$\n- 线性观测算子: $H \\in \\mathbb{R}^{p \\times n}$\n- 观测: $y \\in \\mathbb{R}^{p}$\n- 观测误差协方差: $R \\in \\mathbb{R}^{p \\times p}$，对称正定。\n- 先验状态集合: $\\{x^{(i)}\\}_{i=1}^{m}$\n- 集合平均: $\\bar{x} = \\tfrac{1}{m} \\sum_{i=1}^{m} x^{(i)}$\n- 扰动矩阵: $A \\in \\mathbb{R}^{n \\times m}$，其列为 $A_{:,i} = x^{(i)} - \\bar{x}$\n- 无偏集合协方差估计: $B_{e} = \\tfrac{1}{m-1} A A^{\\top}$\n- 假设: $m \\ll n$\n- 分析增量: $\\delta x \\in \\mathbb{R}^{n}$\n- Kalman 增益: $K(B) = B H^{\\top} \\left(H B H^{\\top} + R \\right)^{-1}$\n- 线性更新: $\\delta x = K(B)\\,(y - H x_{b})$\n- 集合-变分 (EnVar) 增量形式: $\\delta x = A w$，其中 $w \\in \\mathbb{R}^{m}$\n- 混合协方差: $B_{h} = (1-\\beta) B_{s} + \\beta B_{e}$，其中 $0  \\beta  1$，$B_{s} \\in \\mathbb{R}^{n \\times n}$ 为对称正定。\n- 协方差局地化: $\\widetilde{B} = L \\circ B$，其中 $L \\in \\mathbb{R}^{n \\times n}$ 为对称正定，$\\circ$ 为 Schur (Hadamard) 积。\n\n### 第 2 步：使用提取的已知条件进行验证\n该问题陈述在科学上是合理的、适定的和客观的。它基于集合数据同化的标准数学框架，这是反问题、数值天气预报及相关领域的核心课题。所有定义都是标准的且陈述正确。核心前提 $m \\ll n$ 反映了大规模数据同化中的主要操作挑战，这也是驱动所讨论方法（EnVar、混合协方差、局地化）的动机。该问题是自洽的、逻辑一致的，并且不包含任何事实错误、歧义或不切实际的条件。它提出了一个基于线性代数的可验证的概念性挑战。\n\n### 第 3 步：结论和行动\n该问题是**有效的**。将推导解答。\n\n### 推导与分析\n\n问题的核心在于理解集合协方差矩阵 $B_e$ 的性质以及这些性质如何传播到分析增量 $\\delta x$。\n\n集合协方差为 $B_{e} = \\frac{1}{m-1} A A^{\\top}$。矩阵 $A \\in \\mathbb{R}^{n \\times m}$ 的列定义为 $A_{:,i} = x^{(i)} - \\bar{x}$。根据构造，A 的列向量之和为零向量：\n$$ \\sum_{i=1}^{m} A_{:,i} = \\sum_{i=1}^{m} (x^{(i)} - \\bar{x}) = \\left(\\sum_{i=1}^{m} x^{(i)}\\right) - m\\bar{x} = m\\bar{x} - m\\bar{x} = 0 $$\n这表明 $A$ 的列之间存在线性相关性。因此，$A$ 的秩最多为 $m-1$。由于 $m \\ll n$，$A$ 是一个“高瘦”矩阵，其秩受其列数限制。因此，$\\operatorname{rank}(A) \\le m-1$。\n\n$B_e$ 的秩由 $A$ 的秩决定。根据线性代数，对于任何矩阵 $M$，$\\operatorname{range}(M M^{\\top}) = \\operatorname{range}(M)$。矩阵的值域也称为其列空间。因此，$\\operatorname{range}(B_{e}) = \\operatorname{range}\\left(\\frac{1}{m-1} A A^{\\top}\\right) = \\operatorname{range}(A A^{\\top}) = \\operatorname{range}(A)$。子空间 $\\operatorname{range}(A)$ 是集合扰动生成的空间，我们记为 $\\operatorname{span}(A)$。矩阵的秩是其值域的维度。因此，$\\operatorname{rank}(B_{e}) = \\operatorname{dim}(\\operatorname{range}(B_e)) = \\operatorname{dim}(\\operatorname{range}(A)) = \\operatorname{rank}(A)$。综合这些事实，我们得到 $\\operatorname{rank}(B_{e}) \\le m-1$。由于 $m \\ll n$，$B_{e}$ 是严重秩亏的。\n\n分析增量由 $\\delta x = K(B) (y - H x_{b})$ 给出。当使用集合协方差 $B_e$ 时，这变为：\n$$ \\delta x = K(B_e) (y - H x_{b}) = B_{e} H^{\\top} (H B_{e} H^{\\top} + R)^{-1} (y - H x_{b}) $$\n令 $d = H^{\\top} (H B_{e} H^{\\top} + R)^{-1} (y - H x_{b})$。那么 $\\delta x = B_e d$。根据定义，任何形如 $B_e d$ 的向量都在 $B_e$ 的值域中。因此，分析增量 $\\delta x$ 被限制在子空间 $\\operatorname{range}(B_e)$ 内，该子空间与集合子空间 $\\operatorname{span}(A)$ 相同。\n$$ \\delta x \\in \\operatorname{range}(B_e) = \\operatorname{span}(A) $$\n这意味着更新只能在由集合扰动生成的方向上修改背景状态 $x_b$。\n\n### 逐项分析\n\n**A. $B_e$ 的秩满足 $\\operatorname{rank}(B_{e}) \\le m-1$，等号成立当且仅当 $m$ 个扰动列向量仅存在一个由减去均值引起的线性相关性；因此，对于使用 $B_e$ 的 Kalman 更新，$\\delta x \\in \\operatorname{range}(B_{e}) = \\operatorname{range}(A)$。**\n- 第一部分，$\\operatorname{rank}(B_{e}) = \\operatorname{rank}(A) \\le m-1$，如上所述是正确的。如果集合成员在其他方面处于一般位置，使得扰动之间的唯一线性相关性是迫使其和为零的那一个，则等号成立。这是一个正确的描述。\n- 第二部分，陈述纯 $B_e$ 更新的增量 $\\delta x$ 位于 $\\operatorname{range}(B_e)$ 中，而 $\\operatorname{range}(B_e)$ 等于 $\\operatorname{range}(A)$，这在初始推导中也已证明是正确的。增量是通过将矩阵 $B_e$ 应用于另一个向量而形成的。\n- 整个陈述逻辑上是合理的，并且直接源于定义。\n- **结论：正确。**\n\n**B. 在集合-变分控制变量公式 $\\delta x = A w$ 中，即使当 $m \\ll n$ 时，随着 $m$ 的增长，增量也可以探索 $\\mathbb{R}^{n}$ 中的任何方向。**\n- 公式 $\\delta x = A w$ 明确将增量定义为 $A$ 的列的线性组合。这意味着根据构造，$\\delta x$ 是 $\\operatorname{range}(A)$ 的一个元素。\n- 这个子空间的维度是 $\\operatorname{rank}(A) \\le m-1$。\n- 问题陈述 $m \\ll n$。因此，增量可探索的空间维度远小于完整状态空间 $n$ 的维度。\n- 增量被严格限制在一个低维子空间内，不能探索“$\\mathbb{R}^n$ 中的任何方向”。\n- **结论：不正确。**\n\n**C. 如果 $L$ 是稠密的对称正定矩阵，那么在一般条件下（例如，如果扰动项非零），局地化的协方差 $\\widetilde{B}_{e} = L \\circ B_{e}$ 可以是满秩的，并且使用 $\\widetilde{B}_{e}$ 的 Kalman 更新可以产生不局限于 $\\operatorname{span}(A)$ 的增量。**\n- Schur 积定理指出，如果 $M$ 是一个正定矩阵，$N$ 是一个半正定矩阵，那么它们的 Hadamard 积 $M \\circ N$ 是半正定的。此外，如果 $N$ 的所有对角线元素都为正，那么 $M \\circ N$ 是正定的。\n- 这里，$L$ 是正定的。$B_e$ 是半正定的。$B_e$ 的对角线元素是集合方差，$(B_e)_{jj} = \\frac{1}{m-1} \\sum_{i=1}^{m} (A_{j,i})^2$。在一般条件下（即，每个状态分量都存在一定的变异性），这些方差是正的。\n- 因此，$\\widetilde{B}_e = L \\circ B_e$ 是正定的，这意味着它是满秩的，$\\operatorname{rank}(\\widetilde{B}_e) = n$。使用这个局地化协方差的分析增量位于 $\\operatorname{range}(\\widetilde{B}_e) = \\mathbb{R}^n$ 中。它不再被限制在低秩子空间 $\\operatorname{span}(A)$ 内。这是局地化的一个主要动机。\n- **结论：正确。**\n\n**D. 对于混合协方差 $B_{h} = (1-\\beta) B_{s} + \\beta B_{e}$，其中 $B_{s}$ 是对称正定的，由 $K(B_{h})$ 产生的分析增量不受限于集合子空间，即使没有进行局地化。**\n- 混合协方差是 $B_h = (1-\\beta)B_s + \\beta B_e$。\n- 给定 $0  \\beta  1$，矩阵 $(1-\\beta)B_s$ 是对称正定的，因为 $B_s$ 是正定的且 $(1-\\beta) > 0$。\n- 矩阵 $\\beta B_e$ 是对称半正定的，因为 $B_e$ 是半正定的且 $\\beta > 0$。\n- 一个正定矩阵和一个半正定矩阵的和是正定的。因此，$B_h$ 是正定的且满秩，$\\operatorname{rank}(B_h) = n$。\n- 分析增量 $\\delta x$ 位于 $\\operatorname{range}(B_h) = \\mathbb{R}^n$ 中。\n- 因此，增量不受限于集合子空间 $\\operatorname{span}(A)$。\n- **结论：正确。**\n\n**E. $B_{e}$ 的零空间是 $\\operatorname{span}(A)$ 的正交补；因此，任何纯基于 $B_{e}$ 的线性更新都会使背景在属于该零空间的方向上保持不变。**\n- 线性代数基本定理指出，对于任何矩阵 $M$，其转置的零空间是其值域的正交补：$\\operatorname{null}(M^\\top) = (\\operatorname{range}(M))^{\\perp}$。\n- 由于 $B_e$ 是对称的 ($B_e = B_e^\\top$)，我们有 $\\operatorname{null}(B_e) = (\\operatorname{range}(B_e))^{\\perp}$。\n- 如已确立，$\\operatorname{range}(B_e) = \\operatorname{span}(A)$。所以，$\\operatorname{null}(B_e) = (\\operatorname{span}(A))^\\perp$。第一部分是正确的。\n- 一个纯基于 $B_e$ 的更新产生一个增量 $\\delta x \\in \\operatorname{span}(A)$。对于任何向量 $v \\in \\operatorname{null}(B_e)$，我们有 $v \\in (\\operatorname{span}(A))^{\\perp}$，这意味着对于所有 $u \\in \\operatorname{span}(A)$，都有 $v^{\\top} u = 0$。\n- 由于 $\\delta x \\in \\operatorname{span}(A)$，增量在方向 $v$ 上的投影为零：$v^\\top \\delta x = 0$。\n- 这意味着状态在 $B_e$ 零空间内任何方向上的分量都不会被更新。该陈述是正确的。\n- **结论：正确。**\n\n**F. 对于任何线性 $H$ 和正定 $R$，当观测数量 $p$ 足够大时，使用 $B_{e}$ 的 Kalman 更新可以生成包含与 $\\operatorname{range}(A)$ 正交的分量的分析增量。**\n- 如上文详细推导，纯 $B_e$ 更新的分析增量是 $\\delta x = B_e d$，其中 $d$ 是某个向量。这在结构上将 $\\delta x$ 限制在 $\\operatorname{range}(B_e) = \\operatorname{span}(A)$ 内。\n- 根据定义，$\\operatorname{span}(A)$ 中的向量不能有任何与 $\\operatorname{span}(A)$ 正交的非零分量。\n- 这个代数约束是根本性的，不依赖于 $H$、$R$ 的性质或观测空间维度 $p$。\n- 该陈述主张相反的观点，因此是错误的。\n- **结论：不正确。**\n\n正确陈述的总结：A, C, D, E。", "answer": "$$\\boxed{ACDE}$$", "id": "3389728"}, {"introduction": "在混合模型中，静态背景误差协方差（$B_s$）并非随意设定，它通常基于能够施加期望相关结构（如平滑度和长度尺度）的数学算子来构建。这项高级练习将指导您从资料同化中常见的微分算子表示出发，推导出广泛使用的马特恩（Matérn）相关函数 [@problem_id:3389763]。这个练习将协方差模型的抽象概念与其在谱分析中的具体数学基础联系起来，从而让您对协方差建模有更深刻的理解。", "problem": "考虑一个间距为 $h0$ 的一维均匀网格，用于离散化无限直线，并令 $\\Delta_{h}$ 表示标准的二阶离散拉普拉斯算子，其定义为 $(\\Delta_{h} x)_{i} = \\frac{x_{i+1} - 2 x_{i} + x_{i-1}}{h^{2}}$。在一种混合集合-变分 (EnVar) 数据同化方案中，静态背景协方差算子被建模为 $B_{s} = (I - \\ell^{2} \\Delta_{h})^{-p}$，其中 $\\ell  0$ 是一个给定的长度尺度，$p  \\frac{1}{2}$ 是阶数参数。假设平稳性和均匀性，使得协方差仅依赖于网格间距。使用平稳协方差的谱表示和适当的连续统极限，推导出一维情况下当分离距离为 $r \\ge 0$ 时所蕴含的相关函数 $\\rho(r)$，并将其归一化以满足 $\\rho(0) = 1$，最终得到一个以 $\\ell$ 和 $p$ 表示的封闭形式解析表达式。您的推导必须从离散拉普拉斯算子的谱符号以及平稳协方差作为其谱密度逆傅里叶变换的定义开始。您可以假设在极限 $h \\to 0$ 下，离散符号收敛于其连续对应物。请将您的最终答案表示为单个封闭形式的解析表达式。无需进行数值近似。", "solution": "问题陈述被评估为有效。它具有科学依据，形式良好且客观，描述了数据同化和空间统计领域中的一个标准问题。该问题可以通过形式化的数学推导来解决。\n\n目标是推导由静态背景协方差算子 $B_{s} = (I - \\ell^{2} \\Delta_{h})^{-p}$ 所蕴含的一维相关函数 $\\rho(r)$。推导过程将通过考虑该算子的连续统极限，确定其谱密度，然后计算逆傅里叶变换以获得协方差函数。相关函数是协方差函数在零分离处归一化为1的结果。\n\n首先，我们求离散拉普拉斯算子 $\\Delta_h$ 的谱符号。$\\Delta_h$ 作用于离散傅里叶模 $x_j = \\exp(i k j h)$ 的结果由下式给出：\n$$\n(\\Delta_{h} x)_{j} = \\frac{\\exp(ik(j+1)h) - 2 \\exp(ikjh) + \\exp(ik(j-1)h)}{h^{2}} = \\frac{\\exp(ikjh) (\\exp(ikh) - 2 + \\exp(-ikh))}{h^{2}}\n$$\n$$\n= x_j \\frac{2\\cos(kh) - 2}{h^{2}} = x_j \\left( -\\frac{4}{h^{2}} \\sin^2\\left(\\frac{kh}{2}\\right) \\right)\n$$\n因此，$\\Delta_h$ 的谱符号是 $\\hat{\\Delta}_h(k) = -\\frac{4}{h^2} \\sin^2(\\frac{kh}{2})$。在网格间距 $h \\to 0$ 的连续统极限下，我们使用泰勒展开 $\\sin(x) \\approx x$。\n$$\n\\lim_{h \\to 0} \\hat{\\Delta}_h(k) = \\lim_{h \\to 0} -\\frac{4}{h^{2}} \\left(\\frac{kh}{2}\\right)^2 = -k^2\n$$\n这是连续一维拉普拉斯算子 $\\Delta = \\frac{d^2}{dr^2}$ 在傅里叶变换约定 $\\mathcal{F}\\{f(r)\\}(k) = \\int_{-\\infty}^{\\infty} f(r) \\exp(-ikr) dr$ 下的符号。\n\n在此连续统极限下，协方差算子变为 $B_c = (I - \\ell^2 \\Delta)^{-p}$。该算子的符号，即平稳过程的谱密度 $S(k)$，可以通过将微分算子 $\\Delta$ 替换为其符号 $-k^2$ 来获得：\n$$\nS(k) = (1 - \\ell^2(-k^2))^{-p} = (1 + \\ell^2 k^2)^{-p}\n$$\n分离距离为 $r$ 的协方差函数 $C(r)$ 是谱密度的逆傅里叶变换。使用标准的傅里叶变换归一化，我们有：\n$$\nC(r) = \\mathcal{F}^{-1}[S(k)](r) = \\frac{1}{2\\pi} \\int_{-\\infty}^{\\infty} S(k) \\exp(ikr) dk = \\frac{1}{2\\pi} \\int_{-\\infty}^{\\infty} (1 + \\ell^2 k^2)^{-p} \\exp(ikr) dk\n$$\n相关函数 $\\rho(r)$ 定义为协方差函数除以其在 $r=0$ 处的值，即 $\\rho(r) = C(r)/C(0)$。这等价于用谱密度的积分来归一化逆傅里叶变换：\n$$\n\\rho(r) = \\frac{\\int_{-\\infty}^{\\infty} (1 + \\ell^2 k^2)^{-p} \\exp(ikr) dk}{\\int_{-\\infty}^{\\infty} (1 + \\ell^2 k^2)^{-p} dk}\n$$\n我们来分别计算分子和分母的积分，记为 $I_N$ 和 $I_D$。\n\n对于分母 $I_D$：\n$$\nI_D = \\int_{-\\infty}^{\\infty} (1 + \\ell^2 k^2)^{-p} dk\n$$\n我们进行换元，$u = \\ell k$，因此 $dk = du/\\ell$。\n$$\nI_D = \\frac{1}{\\ell} \\int_{-\\infty}^{\\infty} (1 + u^2)^{-p} du = \\frac{2}{\\ell} \\int_{0}^{\\infty} (1 + u^2)^{-p} du\n$$\n这是一个与贝塔函数相关的标准积分。回顾 $\\int_{0}^{\\infty} (1+x^2)^{-m} dx = \\frac{\\sqrt{\\pi}}{2} \\frac{\\Gamma(m-1/2)}{\\Gamma(m)}$，我们设 $m=p$：\n$$\nI_D = \\frac{2}{\\ell} \\left( \\frac{\\sqrt{\\pi} \\Gamma(p - 1/2)}{2 \\Gamma(p)} \\right) = \\frac{\\sqrt{\\pi} \\Gamma(p - 1/2)}{\\ell \\Gamma(p)}\n$$\n这对于 $p  1/2$ 成立，这是题目给出的条件。\n\n对于分子 $I_N$：\n$$\nI_N = \\int_{-\\infty}^{\\infty} (1 + \\ell^2 k^2)^{-p} \\exp(ikr) dk\n$$\n被积函数是关于 $k$ 的偶函数，所以积分是实数，并且等于其傅里叶余弦变换。使用换元 $u=\\ell k$：\n$$\nI_N = \\frac{1}{\\ell} \\int_{-\\infty}^{\\infty} (1 + u^2)^{-p} \\exp(i(r/\\ell)u) du = \\frac{2}{\\ell} \\int_{0}^{\\infty} (1 + u^2)^{-p} \\cos\\left(\\frac{r}{\\ell} u\\right) du\n$$\n我们使用来自 Abramowitz and Stegun (9.6.25) 的该函数的傅里叶余弦变换的标准积分公式：\n$$\n\\int_0^\\infty \\cos(xt) (t^2+z^2)^{-\\nu-1/2} dt = \\frac{\\sqrt{\\pi}}{2^\\nu \\Gamma(\\nu+1/2)} \\left(\\frac{x}{z}\\right)^\\nu K_\\nu(xz)\n$$\n其中 $K_\\nu$ 是第二类修正贝塞尔函数。为了匹配我们的积分，我们设 $t=u$, $x=r/\\ell$, $z=1$，以及指数 $p = \\nu + 1/2$，这意味着 $\\nu = p - 1/2$。条件 $p  1/2$ 确保了 $\\nu  0$。\n积分部分变为：\n$$\n\\int_{0}^{\\infty} (u^2+1)^{-p} \\cos\\left(\\frac{r}{\\ell} u\\right) du = \\frac{\\sqrt{\\pi}}{2^{p-1/2} \\Gamma(p)} \\left(\\frac{r}{\\ell}\\right)^{p-1/2} K_{p-1/2}\\left(\\frac{r}{\\ell}\\right)\n$$\n将此代回 $I_N$ 的表达式中：\n$$\nI_N = \\frac{2}{\\ell} \\left[ \\frac{\\sqrt{\\pi}}{2^{p-1/2} \\Gamma(p)} \\left(\\frac{r}{\\ell}\\right)^{p-1/2} K_{p-1/2}\\left(\\frac{r}{\\ell}\\right) \\right] = \\frac{2^{1-(p-1/2)} \\sqrt{\\pi}}{\\ell \\Gamma(p)} \\left(\\frac{r}{\\ell}\\right)^{p-1/2} K_{p-1/2}\\left(\\frac{r}{\\ell}\\right)\n$$\n$$\nI_N = \\frac{2^{3/2-p} \\sqrt{\\pi}}{\\ell \\Gamma(p)} \\left(\\frac{r}{\\ell}\\right)^{p-1/2} K_{p-1/2}\\left(\\frac{r}{\\ell}\\right)\n$$\n最后，我们计算相关函数 $\\rho(r) = I_N / I_D$：\n$$\n\\rho(r) = \\frac{\\frac{2^{3/2-p} \\sqrt{\\pi}}{\\ell \\Gamma(p)} \\left(\\frac{r}{\\ell}\\right)^{p-1/2} K_{p-1/2}\\left(\\frac{r}{\\ell}\\right)}{\\frac{\\sqrt{\\pi} \\Gamma(p - 1/2)}{\\ell \\Gamma(p)}}\n$$\n$\\frac{\\sqrt{\\pi}}{\\ell \\Gamma(p)}$ 项相互抵消，得到最终表达式：\n$$\n\\rho(r) = \\frac{2^{3/2-p}}{\\Gamma(p - 1/2)} \\left(\\frac{r}{\\ell}\\right)^{p-1/2} K_{p-1/2}\\left(\\frac{r}{\\ell}\\right)\n$$\n这是一维马特恩 (Matérn) 相关函数，其平滑度参数为 $\\nu = p - 1/2$，长度尺度参数为 $\\ell$。归一化确保了 $\\rho(0)=1$，这可以通过使用贝塞尔函数在 $z \\to 0$ 时的极限形式 $K_\\nu(z) \\sim \\frac{\\Gamma(\\nu)}{2} (\\frac{z}{2})^{-\\nu}$ 来验证。", "answer": "$$\\boxed{\\frac{2^{3/2-p}}{\\Gamma(p - \\frac{1}{2})} \\left(\\frac{r}{\\ell}\\right)^{p-\\frac{1}{2}} K_{p-\\frac{1}{2}}\\left(\\frac{r}{\\ell}\\right)}$$", "id": "3389763"}]}