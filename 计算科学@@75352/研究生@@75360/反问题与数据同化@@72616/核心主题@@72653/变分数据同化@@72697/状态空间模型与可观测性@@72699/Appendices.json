{"hands_on_practices": [{"introduction": "这项练习旨在巩固你对可观测性格拉姆矩阵（observability Gramian）这一核心分析工具的理解。你将为一个连续时间系统计算该矩阵，并在此过程中将代表信息累积的积分定义与计算上更方便的代数李雅普诺夫方程（algebraic Lyapunov equation）联系起来。掌握这一技能是严格评估稳定线性系统可观测性的关键。[@problem_id:3421940]", "problem": "考虑一个连续时间线性时不变 (LTI) 状态空间模型，其状态矩阵 $A \\in \\mathbb{R}^{2 \\times 2}$ 和输出矩阵 $C \\in \\mathbb{R}^{1 \\times 2}$ 如下所示：\n$$\nA = \\begin{pmatrix} 0  1 \\\\ -1  -2 \\end{pmatrix}, \\qquad C = \\begin{pmatrix} 1  0 \\end{pmatrix}.\n$$\n从一个稳定的 LTI 系统的无限时域可观测性格拉姆矩阵的定义出发，\n$$\nW_{o} \\equiv \\int_{0}^{\\infty} \\exp(A^{\\top} t)\\, C^{\\top} C \\, \\exp(A t)\\, \\mathrm{d}t,\n$$\n推导一个在矩阵 A 稳定的条件下成立的等价刻画，并用它来计算精确的对称矩阵 $W_{o} \\in \\mathbb{R}^{2 \\times 2}$。然后，通过使用矩阵分析的基本原理检验 $W_{o}$ 的正定性，来判断矩阵对 $(C,A)$ 是否是可观测的。\n\n作为最终报告的量，请提供 $\\det(W_{o})$ 的精确值。不要四舍五入；请报告精确值。最终答案必须是一个实数（无单位）。", "solution": "首先对问题进行验证，以确保其是适定的、科学上合理的，并包含所有必要信息。\n\n## 问题验证\n\n### 步骤 1：提取已知条件\n- 状态矩阵：$A = \\begin{pmatrix} 0  1 \\\\ -1  -2 \\end{pmatrix} \\in \\mathbb{R}^{2 \\times 2}$\n- 输出矩阵：$C = \\begin{pmatrix} 1  0 \\end{pmatrix} \\in \\mathbb{R}^{1 \\times 2}$\n- 稳定 LTI 系统的无限时域可观测性格拉姆矩阵的定义：$W_{o} \\equiv \\int_{0}^{\\infty} \\exp(A^{\\top} t)\\, C^{\\top} C \\, \\exp(A t)\\, \\mathrm{d}t$\n- 任务：\n    1. 推导一个在矩阵 A 稳定的条件下有效的 $W_{o}$ 的等价刻画。\n    2. 使用此刻画计算精确的对称矩阵 $W_o$。\n    3. 通过检验 $W_o$ 的正定性来判断矩阵对 $(C,A)$ 是否可观测。\n    4. 提供 $\\det(W_{o})$ 的精确值。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题在科学上基于线性系统与控制理论。状态空间模型、可观测性以及可观测性格拉姆矩阵等概念都是标准概念。该问题是适定的和客观的。\n\n定义 $W_{o}$ 的积分收敛的一个关键条件是系统矩阵 $A$ 必须是稳定的（或赫尔维茨的），意味着其所有特征值都必须具有负实部。我们必须验证此条件。特征方程为 $\\det(\\lambda I - A) = 0$。\n$$\n\\det\\left(\\begin{pmatrix} \\lambda  0 \\\\ 0  \\lambda \\end{pmatrix} - \\begin{pmatrix} 0  1 \\\\ -1  -2 \\end{pmatrix}\\right) = \\det\\begin{pmatrix} \\lambda  -1 \\\\ 1  \\lambda+2 \\end{pmatrix} = 0\n$$\n$$\n\\lambda(\\lambda+2) - (1)(-1) = \\lambda^2 + 2\\lambda + 1 = (\\lambda+1)^2 = 0\n$$\n特征值为 $\\lambda_{1,2} = -1$，是负实数。由于所有特征值的实部都小于零，矩阵 $A$ 是稳定的。因此，$W_o$ 的积分收敛，该问题是有效的。\n\n## 解答\n\n### $W_o$ 的等价刻画\n对于一个稳定的 LTI 系统，其无限时域可观测性格拉姆矩阵 $W_o$ 是以下连续时间代数李雅普诺夫方程的唯一的、对称的、半正定解：\n$$\nA^{\\top} W_o + W_o A = -C^{\\top} C\n$$\n为了从积分定义推导出此结论，我们从李雅普诺夫方程入手，并证明其解对应于该积分。设对称矩阵 $X$ 是 $A^{\\top} X + X A = -C^{\\top} C$ 的解。我们可以写出：\n$$\n\\int_{0}^{\\infty} \\exp(A^{\\top} t) (A^{\\top} X + X A) \\exp(A t) \\, \\mathrm{d}t = - \\int_{0}^{\\infty} \\exp(A^{\\top} t) C^{\\top} C \\exp(A t) \\, \\mathrm{d}t\n$$\n根据定义，右侧为 $-W_o$。左侧可以看作是一个导数的积分。具体而言，$\\frac{\\mathrm{d}}{\\mathrm{d}t} \\left(\\exp(A^{\\top} t) X \\exp(A t)\\right) = \\exp(A^{\\top} t) (A^{\\top} X + X A) \\exp(A t)$。因此，该积分变为：\n$$\n\\int_{0}^{\\infty} \\frac{\\mathrm{d}}{\\mathrm{d}t} \\left(\\exp(A^{\\top} t) X \\exp(A t)\\right) \\, \\mathrm{d}t = \\left[ \\exp(A^{\\top} t) X \\exp(A t) \\right]_{0}^{\\infty}\n$$\n由于 $A$ 是稳定的，$\\lim_{t \\to \\infty} \\exp(A t) = 0$。该表达式的计算结果为：\n$$\n\\lim_{t \\to \\infty} \\left(\\exp(A^{\\top} t) X \\exp(A t)\\right) - \\exp(A^{\\top} \\cdot 0) X \\exp(A \\cdot 0) = 0 - I X I = -X\n$$\n令两侧相等，我们得到 $-X = -W_o$，这意味着 $X = W_o$。因此，可观测性格拉姆矩阵 $W_o$ 确实是李雅普诺夫方程 $A^{\\top} W_o + W_o A = -C^{\\top} C$ 的解。这就是所要求的等价刻画。\n\n### $W_o$ 的计算\n我们现在求解关于 $W_o$ 的李雅普诺夫方程。首先，我们计算所涉及的矩阵：\n$A^{\\top} = \\begin{pmatrix} 0  -1 \\\\ 1  -2 \\end{pmatrix}$\n$C^{\\top} C = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} \\begin{pmatrix} 1  0 \\end{pmatrix} = \\begin{pmatrix} 1  0 \\\\ 0  0 \\end{pmatrix}$\n设 $W_o = \\begin{pmatrix} w_{11}  w_{12} \\\\ w_{21}  w_{22} \\end{pmatrix}$。由于 $W_o$ 必须是对称的，所以 $w_{12} = w_{21}$。\n李雅普诺夫方程为：\n$$\n\\begin{pmatrix} 0  -1 \\\\ 1  -2 \\end{pmatrix} \\begin{pmatrix} w_{11}  w_{12} \\\\ w_{12}  w_{22} \\end{pmatrix} + \\begin{pmatrix} w_{11}  w_{12} \\\\ w_{12}  w_{22} \\end{pmatrix} \\begin{pmatrix} 0  1 \\\\ -1  -2 \\end{pmatrix} = - \\begin{pmatrix} 1  0 \\\\ 0  0 \\end{pmatrix}\n$$\n进行矩阵乘法：\n$$\n\\begin{pmatrix} -w_{12}  -w_{22} \\\\ w_{11}-2w_{12}  w_{12}-2w_{22} \\end{pmatrix} + \\begin{pmatrix} -w_{12}  w_{11}-2w_{12} \\\\ -w_{22}  w_{12}-2w_{22} \\end{pmatrix} = \\begin{pmatrix} -1  0 \\\\ 0  0 \\end{pmatrix}\n$$\n将左侧的矩阵相加得到：\n$$\n\\begin{pmatrix} -2w_{12}  w_{11}-2w_{12}-w_{22} \\\\ w_{11}-2w_{12}-w_{22}  2w_{12}-4w_{22} \\end{pmatrix} = \\begin{pmatrix} -1  0 \\\\ 0  0 \\end{pmatrix}\n$$\n令对应元素相等，得到一个线性方程组：\n1.  $-2w_{12} = -1$\n2.  $w_{11}-2w_{12}-w_{22} = 0$\n3.  $2w_{12}-4w_{22} = 0$\n\n从方程 (1)，我们得到 $w_{12} = \\frac{1}{2}$。\n将此代入方程 (3)：$2(\\frac{1}{2}) - 4w_{22} = 0 \\implies 1 - 4w_{22} = 0 \\implies w_{22} = \\frac{1}{4}$。\n将 $w_{12}$ 和 $w_{22}$ 代入方程 (2)：$w_{11} - 2(\\frac{1}{2}) - \\frac{1}{4} = 0 \\implies w_{11} - 1 - \\frac{1}{4} = 0 \\implies w_{11} = \\frac{5}{4}$。\n所以，可观测性格拉姆矩阵为：\n$$\nW_o = \\begin{pmatrix} \\frac{5}{4}  \\frac{1}{2} \\\\ \\frac{1}{2}  \\frac{1}{4} \\end{pmatrix}\n$$\n\n### 可观测性检验\n矩阵对 $(C,A)$ 是可观测的当且仅当可观测性格拉姆矩阵 $W_o$ 是正定的。对于一个 $2 \\times 2$ 的对称矩阵，如果其所有顺序主子式均为正（西尔维斯特准则），则其正定性得到确认。\n第一个顺序主子式是左上角的元素：\n$$\nM_1 = w_{11} = \\frac{5}{4} > 0\n$$\n第二个顺序主子式是该矩阵的行列式：\n$$\nM_2 = \\det(W_o) = w_{11}w_{22} - w_{12}^2 = \\left(\\frac{5}{4}\\right)\\left(\\frac{1}{4}\\right) - \\left(\\frac{1}{2}\\right)^2 = \\frac{5}{16} - \\frac{1}{4} = \\frac{5}{16} - \\frac{4}{16} = \\frac{1}{16}\n$$\n由于 $M_2 = \\det(W_o) > 0$ 且 $M_1 > 0$，矩阵 $W_o$ 是正定的。因此，系统 $(C,A)$ 是可观测的。\n\n问题要求 $\\det(W_o)$ 的精确值。如上计算，该值为 $\\frac{1}{16}$。", "answer": "$$\\boxed{\\frac{1}{16}}$$", "id": "3421940"}, {"introduction": "超越简单的状态估计，这项练习探索了一个更复杂的问题：联合估计状态和模型参数，这是数据同化中的一个核心任务。通过构建和分析一个增广系统，这项练习强调了状态可观测性与参数可辨识性之间的关键区别。它将演示即使一个状态完全可观测的系统，也可能因为测量模型的结构而存在不可辨识的参数。[@problem_id:3421916]", "problem": "考虑以下用于反问题和数据同化中通过状态增广进行状态-参数联合估计的线性时不变离散时间状态空间模型。状态根据 $x_{k+1} = A x_k$ 演化，观测为 $y_k = C x_k + C_{\\theta} \\theta$，其中 $x_k \\in \\mathbb{R}^{2}$，$y_k \\in \\mathbb{R}^{2}$，且 $\\theta \\in \\mathbb{R}^{2}$ 是一个常数参数向量。令\n$$\nA = \\begin{pmatrix} 0  1 \\\\ -2  -3 \\end{pmatrix}, \\quad\nC = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix}, \\quad\nC_{\\theta} = b\\, g^{\\top}, \\quad b = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}, \\quad g = \\begin{pmatrix} 1 \\\\ 2 \\end{pmatrix}.\n$$\n你可以假设以下标准定义：对于一个线性时不变系统，如果由 $C$ 和 $A$ 的连续乘积构成的经典可观测性矩阵具有等于状态维数的满列秩，则该对 $(A, C)$ 是可观测的；在用于状态-参数联合估计的增广形式中，时刻 $k$ 的局部线性测量映射关于增广向量 $[\\, x_0^{\\top} \\;\\; \\theta^{\\top} \\,]^{\\top}$ 的雅可比矩阵为 $[\\, C A^{k} \\;\\; C_{\\theta} \\,]$。使用两个连续的观测时刻 $k = 0$ 和 $k = 1$ 进行分析。\n\n1. 从这些定义出发，根据第一性原理论证对于给定的 $(A, C)$，状态是否是可观测的。\n2. 解释为什么 $C_{\\theta}$ 的列是共线的，并阐释其对参数可辨识性的影响。\n3. 通过堆叠 $k = 0$ 和 $k = 1$ 时的两个局部雅可比矩阵来构建增广可观测性矩阵，并使用秩-零度定理来量化其零空间的维度。\n\n最终答案请提供一个等于这个 $4 \\times 4$ 增广可观测性矩阵零空间维度的整数。无需单位。不要四舍五入。", "solution": "该问题要求分析一个离散时间状态空间模型的状态可观测性和参数可辨识性，并最终确定增广可观测性矩阵零空间的维度。\n\n系统由以下方程描述：\n$$x_{k+1} = A x_k$$\n$$y_k = C x_k + C_{\\theta} \\theta$$\n其中状态为 $x_k \\in \\mathbb{R}^2$，观测为 $y_k \\in \\mathbb{R}^2$，参数向量为 $\\theta \\in \\mathbb{R}^2$。矩阵给定如下：\n$$\nA = \\begin{pmatrix} 0  1 \\\\ -2  -3 \\end{pmatrix}, \\quad\nC = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} = I_2, \\quad\nC_{\\theta} = b g^{\\top}, \\quad b = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}, \\quad g = \\begin{pmatrix} 1 \\\\ 2 \\end{pmatrix}.\n$$\n\n首先，我们依次解决问题的三个部分。\n\n1.  **状态动态的可观测性。**\n一个线性时不变系统 $(A, C)$ 被定义为可观测的，如果任何初始状态 $x_0$ 都可以从观测序列 $y_0, y_1, \\dots$ 中唯一确定。根据状态方程，我们有 $x_k = A^k x_0$。假设参数已知（在此子问题中 $\\theta=0$），观测方程变为 $y_k = C x_k = C A^k x_0$。如果两个初始状态 $x_0^{(1)}$ 和 $x_0^{(2)}$ 产生相同的输出序列，则对于所有 $k \\ge 0$，有 $C A^k x_0^{(1)} = C A^k x_0^{(2)}$。这等价于对于所有 $k \\ge 0$，有 $C A^k (x_0^{(1)} - x_0^{(2)}) = 0$。系统是可观测的，当且仅当满足此条件的唯一向量 $\\delta x_0 = x_0^{(1)} - x_0^{(2)}$ 是 $\\delta x_0 = 0$。这要求无限维可观测性矩阵具有平凡零空间。对于一个状态维数为 $n$ 的系统，根据凯莱-哈密顿定理，我们只需要检查前 $n$ 个时间步。因此，经典可观测性矩阵定义为：\n$$ \\mathcal{O} = \\begin{pmatrix} C \\\\ CA \\\\ \\vdots \\\\ CA^{n-1} \\end{pmatrix} $$\n系统是可观测的，当且仅当该矩阵具有满列秩，即 $\\text{rank}(\\mathcal{O}) = n$。\n\n在此问题中，状态维数为 $n=2$。可观测性矩阵为：\n$$ \\mathcal{O} = \\begin{pmatrix} C \\\\ CA \\end{pmatrix} $$\n给定 $C = I_2$，因此 $CA = A$。可观测性矩阵为：\n$$ \\mathcal{O} = \\begin{pmatrix} I_2 \\\\ A \\end{pmatrix} = \\begin{pmatrix} 1  0 \\\\ 0  1 \\\\ 0  1 \\\\ -2  -3 \\end{pmatrix} $$\n这是一个 $4 \\times 2$ 矩阵。要检查其是否满列秩（秩为 $2$），我们必须检查其列是否线性无关。这两个列是 $v_1 = \\begin{pmatrix} 1  0  0  -2 \\end{pmatrix}^{\\top}$ 和 $v_2 = \\begin{pmatrix} 0  1  1  -3 \\end{pmatrix}^{\\top}$。这两个向量不是彼此的标量倍数，因此它们是线性无关的。所以，$\\text{rank}(\\mathcal{O}) = 2$。由于秩等于状态维数，该对 $(A, C)$ 是可观测的。\n\n2.  **对矩阵 $C_{\\theta}$ 及其影响的分析。**\n矩阵 $C_{\\theta}$ 由两个向量 $b$ 和 $g$ 的外积定义：\n$$ C_{\\theta} = b g^{\\top} = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} \\begin{pmatrix} 1  2 \\end{pmatrix} = \\begin{pmatrix} 1 \\times 1  1 \\times 2 \\\\ 1 \\times 1  1 \\times 2 \\end{pmatrix} = \\begin{pmatrix} 1  2 \\\\ 1  2 \\end{pmatrix} $$\n任意两个非零向量的外积都会产生一个秩为1的矩阵。秩为1的矩阵的一个性质是，其所有列都是单个向量（本例中为 $b$）的标量倍数，其所有行都是单个向量（本例中为 $g^{\\top}$）的标量倍数。这里，第一列是 $\\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$，第二列是 $\\begin{pmatrix} 2 \\\\ 2 \\end{pmatrix} = 2 \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$。因此，这些列是共线的。\n\n对参数可辨识性的影响源于参数向量 $\\theta$ 如何影响观测值 $y_k$。观测中与参数相关的部分是 $C_{\\theta} \\theta$：\n$$ C_{\\theta} \\theta = \\begin{pmatrix} 1  2 \\\\ 1  2 \\end{pmatrix} \\begin{pmatrix} \\theta_1 \\\\ \\theta_2 \\end{pmatrix} = \\begin{pmatrix} \\theta_1 + 2\\theta_2 \\\\ \\theta_1 + 2\\theta_2 \\end{pmatrix} = (\\theta_1 + 2\\theta_2) \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} $$\n该表达式表明，参数向量 $\\theta = \\begin{pmatrix} \\theta_1  \\theta_2 \\end{pmatrix}^{\\top}$ 仅通过线性组合 $\\theta_1 + 2\\theta_2 = g^{\\top}\\theta$ 来影响测量值。我们无法区分任何两个满足 $g^{\\top}\\theta^{(1)} = g^{\\top}\\theta^{(2)}$ 的不同参数向量 $\\theta^{(1)}$ 和 $\\theta^{(2)}$。这意味着我们无法单独辨识 $\\theta_1$ 和 $\\theta_2$。任何位于 $C_{\\theta}$ 零空间中（或等价地，与 $g$ 正交）的 $\\theta$ 的变化都是不可观测的。$C_{\\theta}$ 的零空间是一维的，由向量 $\\begin{pmatrix} 2 \\\\ -1 \\end{pmatrix}$ 张成。因此，这些参数是不可辨识的。\n\n3.  **增广可观测性矩阵及其零空间维度。**\n目标是同时估计初始状态 $x_0$ 和参数向量 $\\theta$。增广向量为 $\\begin{pmatrix} x_0^{\\top}  \\theta^{\\top} \\end{pmatrix}^{\\top} \\in \\mathbb{R}^4$。时刻 $k$ 的观测由 $y_k = C A^k x_0 + C_{\\theta} \\theta$ 给出。我们可以将其写成矩阵形式：\n$$ y_k = \\begin{pmatrix} C A^k  C_{\\theta} \\end{pmatrix} \\begin{pmatrix} x_0 \\\\ \\theta \\end{pmatrix} $$\n矩阵 $\\begin{pmatrix} C A^k  C_{\\theta} \\end{pmatrix}$ 是测量函数 $y_k$ 关于增广向量的雅可比矩阵。我们考虑在 $k=0$ 和 $k=1$ 时的两个连续观测。我们堆叠这些观测：\n$$ \\mathcal{Y} = \\begin{pmatrix} y_0 \\\\ y_1 \\end{pmatrix} = \\begin{pmatrix} C A^0  C_{\\theta} \\\\ C A^1  C_{\\theta} \\end{pmatrix} \\begin{pmatrix} x_0 \\\\ \\theta \\end{pmatrix} $$\n增广可观测性矩阵，我们记为 $\\mathcal{O}_{\\text{aug}}$，是连接增广向量与堆叠观测的 $4 \\times 4$ 矩阵：\n$$ \\mathcal{O}_{\\text{aug}} = \\begin{pmatrix} C  C_{\\theta} \\\\ CA  C_{\\theta} \\end{pmatrix} $$\n代入给定的矩阵 $C=I_2$，$A^0=I_2$，$A^1=A$：\n$$ \\mathcal{O}_{\\text{aug}} = \\begin{pmatrix} 1  0  1  2 \\\\ 0  1  1  2 \\\\ 0  1  1  2 \\\\ -2  -3  1  2 \\end{pmatrix} $$\n我们需要求这个矩阵的零空间的维度。根据秩-零度定理，对于一个矩阵 $M \\in \\mathbb{R}^{m \\times n}$，我们有 $\\text{rank}(M) + \\text{dim}(\\text{null}(M)) = n$。这里，$n=4$。所以，$\\text{dim}(\\text{null}(\\mathcal{O}_{\\text{aug}})) = 4 - \\text{rank}(\\mathcal{O}_{\\text{aug}})$。\n\n我们使用高斯消元法计算 $\\mathcal{O}_{\\text{aug}}$ 的秩。注意第2行和第3行是相同的。\n$$ \\mathcal{O}_{\\text{aug}} = \\begin{pmatrix} 1  0  1  2 \\\\ 0  1  1  2 \\\\ 0  1  1  2 \\\\ -2  -3  1  2 \\end{pmatrix} \\xrightarrow{R_3 \\to R_3-R_2} \\begin{pmatrix} 1  0  1  2 \\\\ 0  1  1  2 \\\\ 0  0  0  0 \\\\ -2  -3  1  2 \\end{pmatrix} $$\n$$ \\xrightarrow{R_4 \\to R_4+2R_1} \\begin{pmatrix} 1  0  1  2 \\\\ 0  1  1  2 \\\\ 0  0  0  0 \\\\ 0  -3  3  6 \\end{pmatrix} \\xrightarrow{R_4 \\to R_4+3R_2} \\begin{pmatrix} 1  0  1  2 \\\\ 0  1  1  2 \\\\ 0  0  0  0 \\\\ 0  0  6  12 \\end{pmatrix} $$\n交换第3行和第4行，得到行阶梯形：\n$$ \\begin{pmatrix} 1  0  1  2 \\\\ 0  1  1  2 \\\\ 0  0  6  12 \\\\ 0  0  0  0 \\end{pmatrix} $$\n这个矩阵显然有三个非零行，所以其秩为 $3$。\n$$ \\text{rank}(\\mathcal{O}_{\\text{aug}}) = 3 $$\n应用秩-零度定理：\n$$ \\text{dim}(\\text{null}(\\mathcal{O}_{\\text{aug}})) = 4 - \\text{rank}(\\mathcal{O}_{\\text{aug}}) = 4 - 3 = 1 $$\n零空间的维度是 $1$。这个非平凡零空间反映了增广状态向量缺乏完全可辨识性，这源于第2部分中确定的 $C_{\\theta}$ 的秩亏。具体来说，如果 $x_0=0$ 且 $\\theta$ 位于 $C_\\theta$ 的零空间中，则向量 $\\begin{pmatrix} x_0 \\\\ \\theta \\end{pmatrix}$ 位于零空间中。$C_\\theta$ 的零空间是一维的，因此 $\\mathcal{O}_{\\text{aug}}$ 的零空间也是一维的。", "answer": "$$\\boxed{1}$$", "id": "3421916"}, {"introduction": "在实际应用中，可观测性通常不是一个简单的“是”或“否”的问题，而是一个程度问题。这项练习将引导你从解析理论过渡到数值计算，通过计算在不断增加的时间窗口上的可观测性矩阵的最小奇异值，你将定量地评估一个系统被“多好”地观测，并看到观测性差的模式如何通过这个指标显现出来。[@problem_id:3421917]", "problem": "考虑一个离散时间、线性、时不变的状态空间模型，其状态维度为 $n$，输出维度为 $p$，由方程 $x_{k+1} = A x_k$ 和 $y_k = C x_k$ 定义，其中 $A \\in \\mathbb{R}^{n \\times n}$ 且 $C \\in \\mathbb{R}^{p \\times n}$。时域长度为 $N$ 的有限时域可观测性矩阵定义为如下的垂直堆叠矩阵\n$$\nO_N \\triangleq \\begin{bmatrix}\nC \\\\\nC A \\\\\n\\vdots \\\\\nC A^{N-1}\n\\end{bmatrix} \\in \\mathbb{R}^{(pN) \\times n}.\n$$\n有限时域可观测性格拉姆矩阵（Gramian）是一个对称半正定矩阵\n$$\nW_N \\triangleq O_N^\\top O_N = \\sum_{k=0}^{N-1} (A^k)^\\top C^\\top C A^k \\in \\mathbb{R}^{n \\times n}.\n$$\n对于每个时域长度 $N \\in \\{1,2,\\dots,10\\}$，定义量 $s_{\\min}(N)$ 为可观测性矩阵 $O_N$ 的最小奇异值，这等价于 $s_{\\min}(N) = \\sqrt{\\lambda_{\\min}(W_N)}$，其中 $\\lambda_{\\min}(W_N)$ 表示 $W_N$ 的最小特征值。\n\n您的任务是编写一个程序，针对下方的每个测试案例，计算列表 $\\{s_{\\min}(N)\\}_{N=1}^{10}$ 并对其趋势提供一个简单的解释。该解释必须包含：\n- 一个布尔值，指示在数值容差 $\\tau = 10^{-12}$ 内，序列 $\\{s_{\\min}(N)\\}$ 是否为单调不减的，即对于所有 $N \\in \\{1,2,\\dots,9\\}$，是否满足 $s_{\\min}(N+1) \\ge s_{\\min}(N) - \\tau$。\n- 一个布尔值，指示根据准则 $s_{\\min}(10) > \\epsilon$（其中 $\\epsilon = 10^{-12}$），系统是否在时域长度 $N=10$ 上表现出有效可观测子空间。\n\n程序不得假定除标准矩阵代数之外的任何特定结构，并且必须依赖于上述基本定义。此问题不涉及任何物理单位、角度或百分比。\n\n测试套件：\n- 案例1（理想情况，二维，一个观测性差但可观测的模态）：\n  $$\n  A_1 = \\begin{bmatrix} 0.95  0.0 \\\\ 0.0  0.70 \\end{bmatrix}, \\quad\n  C_1 = \\begin{bmatrix} 10^{-3}  1.0 \\end{bmatrix}.\n  $$\n- 案例2（边界条件，二维，一个耦合极弱的慢模态）：\n  $$\n  A_2 = \\begin{bmatrix} 0.99  0.0 \\\\ 0.0  0.30 \\end{bmatrix}, \\quad\n  C_2 = \\begin{bmatrix} 10^{-8}  1.0 \\end{bmatrix}.\n  $$\n- 案例3（边缘情况，二维，一个严格不可观测的模态）：\n  $$\n  A_3 = \\begin{bmatrix} 0.90  0.0 \\\\ 0.0  0.60 \\end{bmatrix}, \\quad\n  C_3 = \\begin{bmatrix} 0.0  1.0 \\end{bmatrix}.\n  $$\n\n对于每个案例，您的程序必须：\n1. 使用上述定义，为每个 $N \\in \\{1,\\dots,10\\}$ 构建 $W_N$，并计算 $s_{\\min}(N) = \\sqrt{\\lambda_{\\min}(W_N)}$。\n2. 使用指定的容差 $\\tau$ 和 $\\epsilon$ 来确定上述两个布尔值。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。每个元素对应一个测试案例，其本身是一个形式为 $[\\text{values}, \\text{is\\_monotone}, \\text{is\\_observable}]$ 的列表，其中 $\\text{values}$ 是包含 10 个浮点数的列表 $\\{s_{\\min}(N)\\}_{N=1}^{10}$，$\\text{is\\_monotone}$ 是一个布尔值，$\\text{is\\_observable}$ 也是一个布尔值。例如，最终输出必须采用以下形式：\n$$\n[\\,[\\,[v_1,\\dots,v_{10}], \\text{True}, \\text{False}\\,],\\,[\\,[w_1,\\dots,w_{10}], \\text{True}, \\text{True}\\,],\\,[\\,[u_1,\\dots,u_{10}], \\text{True}, \\text{False}\\,]\\,]\n$$\n其中 $v_i$、$w_i$ 和 $u_i$ 是您的程序计算出的实际数值。", "solution": "该问题是有效的，因为其在数学上是良定义的，在线性系统理论中有科学依据，并且为求得唯一解提供了所有必要的数据和条件。\n\n此问题的核心在于评估一个离散时间线性时不变系统的可观测性。可观测性是指通过在一定时间范围内观测系统输出 $y_k$ 来确定其初始状态 $x_0$ 的能力。\n\n该系统由以下方程定义：\n$$\nx_{k+1} = A x_k \\\\\ny_k = C x_k\n$$\n其中 $x_k \\in \\mathbb{R}^n$ 是状态，而 $y_k \\in \\mathbb{R}^p$ 是在时间步 $k$ 的输出。\n\n在长度为 $N$ 的时域内的输出序列与初始状态 $x_0$ 的关系如下：\n$$\nY_N = \\begin{bmatrix} y_0 \\\\ y_1 \\\\ \\vdots \\\\ y_{N-1} \\end{bmatrix} = \\begin{bmatrix} C \\\\ C A \\\\ \\vdots \\\\ C A^{N-1} \\end{bmatrix} x_0 = O_N x_0\n$$\n其中 $O_N \\in \\mathbb{R}^{(pN) \\times n}$ 是时域长度为 $N$ 的可观测性矩阵。\n\n我们需要计算的量 $s_{\\min}(N)$ 是该矩阵 $O_N$ 的最小奇异值。这个值是衡量可观测性的一个关键指标。如果 $s_{\\min}(N) > 0$，则意味着矩阵 $O_N$ 具有满列秩，即从 $x_0$ 到 $Y_N$ 的映射是单射的。换言之，每个不同的初始状态 $x_0$ 都会产生一个唯一的输出序列，因此 $x_0$ 可以被唯一确定。如果 $s_{\\min}(N) = 0$，则存在非零的初始状态，其在时域 $N$ 内产生零输出，使得它们与零状态无法区分。$s_{\\min}(N)$ 的大小量化了可观测性的“程度”；值越大，表明系统越鲁棒可观测。\n\n问题指导我们使用有限时域可观测性格拉姆矩阵 $W_N$ 来计算 $s_{\\min}(N)$：\n$$\nW_N \\triangleq O_N^\\top O_N = \\sum_{k=0}^{N-1} (A^k)^\\top C^\\top C A^k\n$$\n$O_N$ 的奇异值是 $O_N^\\top O_N = W_N$ 特征值的平方根。因此，$O_N$ 的最小奇异值由下式给出：\n$$\ns_{\\min}(N) = \\sqrt{\\lambda_{\\min}(W_N)}\n$$\n其中 $\\lambda_{\\min}(W_N)$ 是格拉姆矩阵 $W_N$ 的最小特征值。\n\n一个高效算法的关键在于格拉姆矩阵的迭代性质。我们可以用 $W_{N-1}$ 来表示 $W_N$：\n$$\nW_N = \\left( \\sum_{k=0}^{N-2} (A^k)^\\top C^\\top C A^k \\right) + (A^{N-1})^\\top C^\\top C A^{N-1} = W_{N-1} + (A^{N-1})^\\top C^\\top C A^{N-1}\n$$\n项 $(A^{N-1})^\\top C^\\top C A^{N-1}$ 是一个对称半正定矩阵。根据外尔（Weyl）特征值不等式，将一个半正定矩阵加到另一个对称矩阵上，不会使其任何特征值减小。因此，$\\lambda_{\\min}(W_N) \\ge \\lambda_{\\min}(W_{N-1})$。由于平方根函数对于非负参数是单调不减的，可得：\n$$\ns_{\\min}(N) = \\sqrt{\\lambda_{\\min}(W_N)} \\ge \\sqrt{\\lambda_{\\min}(W_{N-1})} = s_{\\min}(N-1)\n$$\n这证明了序列 $\\{s_{\\min}(N)\\}$ 理论上是单调不减的。使用一个小的正容差 $\\tau > 0$ 来检查 $s_{\\min}(N+1) \\ge s_{\\min}(N) - \\tau$ 是为了正确地处理由浮点算术误差引起的潜在微小减小。\n\n每个测试案例的算法流程如下：\n1. 将格拉姆矩阵 $W$ 初始化为大小为 $n \\times n$ 的零矩阵，并将矩阵幂 $A^k$ 初始化为单位矩阵（对于 $k=0$）。\n2. 预计算常数矩阵乘积 $C^\\top C$。\n3. 对每个时域长度 $N$ 从 1 到 10 进行循环（这对应于对 $k$ 从 0 到 9 的项求和）。在求和的每次迭代 $k$ 中（对应于时域长度 $N=k+1$）：\n    a. 将下一项 $(A^k)^\\top C^\\top C A^k$ 加到累积的格拉姆矩阵 $W$ 中。\n    b. 计算更新后的对称格拉姆矩阵 $W$ 的特征值。找到最小特征值 $\\lambda_{\\min}$。\n    c. 计算 $s_{\\min}(N) = \\sqrt{\\max(0, \\lambda_{\\min})}$。`max` 函数可以提供数值稳定性，以防因浮点不精确性而产生小的负 $\\lambda_{\\min}$ 值。\n    d. 存储计算出的 $s_{\\min}(N)$。\n    e. 为下一次迭代，将矩阵幂从 $A^k$ 更新为 $A^{k+1}$。\n4. 计算完完整的序列 $\\{s_{\\min}(N)\\}_{N=1}^{10}$ 后，执行两个要求的布尔检查：\n    a. **单调性**：遍历序列以验证对于 $N=1, \\dots, 9$ 是否满足 $s_{\\min}(N+1) \\ge s_{\\min}(N) - \\tau$。\n    b. **可观测性**：检查最终值 $s_{\\min}(10)$ 是否大于阈值 $\\epsilon = 10^{-12}$。\n\n对提供的三个测试案例均执行此过程。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef compute_observability_metrics(A_in, C_in):\n    \"\"\"\n    Computes observability metrics for a given LTI system (A, C).\n\n    Args:\n        A_in (list of lists): The state transition matrix A.\n        C_in (list of lists): The observation matrix C.\n\n    Returns:\n        list: A list containing [s_min_values, is_monotone, is_observable].\n              - s_min_values: A list of the smallest singular values s_min(N) for N=1 to 10.\n              - is_monotone: A boolean indicating if the sequence is nondecreasing.\n              - is_observable: A boolean indicating if the system is effectively observable at N=10.\n    \"\"\"\n    N_max = 10\n    tau = 1e-12\n    epsilon = 1e-12\n\n    A = np.array(A_in, dtype=float)\n    C = np.array(C_in, dtype=float)\n    \n    n = A.shape[0]\n    W = np.zeros((n, n), dtype=float)\n    A_k = np.eye(n, dtype=float)\n    CTC = C.T @ C\n    \n    s_min_values = []\n\n    # Iteratively compute W_N and s_min(N) for N=1 to 10\n    for _ in range(N_max):\n        # The term for the current power of A is (A^k)^T C^T C (A^k)\n        term = A_k.T @ CTC @ A_k\n        W += term  # This gives W_{k+1}\n        \n        # W is symmetric, so eigh is efficient and returns sorted eigenvalues\n        eigenvalues = np.linalg.eigh(W)[0]\n        lambda_min = eigenvalues[0]\n        \n        # Guard against small negative eigenvalues from floating point error\n        s_min = np.sqrt(max(0.0, lambda_min))\n        s_min_values.append(s_min)\n        \n        # Update A^k to A^{k+1} for the next iteration\n        A_k = A @ A_k\n\n    # Check for monotonicity with tolerance tau\n    is_monotone = True\n    for i in range(N_max - 1):\n        if s_min_values[i+1]  s_min_values[i] - tau:\n            is_monotone = False\n            break\n\n    # Check for effective observability at N=10 with threshold epsilon\n    # s_min_values[9] corresponds to N=10\n    is_observable = s_min_values[9] > epsilon\n\n    return [s_min_values, is_monotone, is_observable]\n\ndef solve():\n    \"\"\"\n    Main function to run all test cases and print the final result.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        (\n            [[0.95, 0.0], [0.0, 0.70]],\n            [[1e-3, 1.0]]\n        ),\n        (\n            [[0.99, 0.0], [0.0, 0.30]],\n            [[1e-8, 1.0]]\n        ),\n        (\n            [[0.90, 0.0], [0.0, 0.60]],\n            [[0.0, 1.0]]\n        )\n    ]\n\n    results = []\n    for A, C in test_cases:\n        res = compute_observability_metrics(A, C)\n        results.append(res)\n\n    # Format the output string to match the specified no-space format\n    formatted_results = []\n    for res in results:\n        # res has the form [[values], bool, bool]\n        # Format the list of float values\n        values_str = f\"[{','.join(f'{v:.17g}' for v in res[0])}]\"\n        \n        # Format the entire case result string\n        case_str = f\"[{values_str},{'True' if res[1] else 'False'},{'True' if res[2] else 'False'}]\"\n        formatted_results.append(case_str)\n        \n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "3421917"}]}