{"hands_on_practices": [{"introduction": "在计算流体动力学(CFD)中，制造解方法（Method of Manufactured Solutions, MMS）是代码验证的基石。本练习将运用MMS的逻辑，来巩固您对微分形式内能方程的理解。通过从一个给定的速度场和温度场出发，您将推导出一个精确的源项 $S(x,y)$，以使控制方程得到完美满足，从而清晰地分离并量化对流、热传导以及粘性耗散 $\\Phi$ 各自的贡献。[@problem_id:3335339]", "problem": "在计算流体动力学 (CFD) 的背景下，考虑一种二维、稳态、不可压缩的牛顿流体，其密度 $\\rho$、动力粘度 $\\mu$、热导率 $k$ 和定容比热 $c_v$ 均为常数。设速度场和温度场由下式给出\n$$\n\\mathbf{u}(x,y) = \\begin{pmatrix} \\gamma\\, y \\\\ 0 \\end{pmatrix}, \\qquad T(x,y) = T_0 + a\\,x^2 + b\\,y^2,\n$$\n其中 $T_0$、$a$、$b$ 和 $\\gamma$ 是给定的常数。从连续介质的积分形式热力学第一定律出发，并使用傅里叶热传导的标准本构关系 $\\,\\mathbf{q} = -k\\,\\nabla T\\,$ 和带有 Stokes 假设的牛顿应力 $\\,\\boldsymbol{\\tau} = 2\\,\\mu\\,\\mathbf{E}\\,$（其中 $\\mathbf{E}$ 是对称应变率张量），为此流动推导包含粘性耗散的微分形式内能平衡方程。然后，确定单位体积的内能源项 $S(x,y)$，使得对于给定的场，内能方程能够逐点精确成立。将您的最终答案表示为关于 $x$、$y$ 以及常数 $\\rho$、$\\mu$、$k$、$c_v$、$\\gamma$、$a$ 和 $b$ 的单个闭式解析表达式。无需进行数值代入，也无需四舍五入。最终表达式中不应包含单位。", "solution": "首先对问题进行验证。\n\n### 步骤一：提取已知条件\n- **流动条件**：二维 (2D)、稳态、不可压缩的牛顿流体。\n- **物理常数**：密度 $\\rho$、动力粘度 $\\mu$、热导率 $k$、定容比热 $c_v$。\n- **场常数**：$T_0$、$a$、$b$、$\\gamma$。\n- **速度场**：$\\mathbf{u}(x,y) = \\begin{pmatrix} \\gamma y \\\\ 0 \\end{pmatrix}$。\n- **温度场**：$T(x,y) = T_0 + ax^2 + by^2$。\n- **本构关系**：\n  - 热通量（傅里叶定律）：$\\mathbf{q} = -k \\nabla T$。\n  - 粘性应力张量（牛顿流体）：$\\boldsymbol{\\tau} = 2 \\mu \\mathbf{E}$，其中 $\\mathbf{E}$ 是对称应变率张量，$\\mathbf{E} = \\frac{1}{2}(\\nabla\\mathbf{u} + (\\nabla\\mathbf{u})^T)$。\n\n### 步骤二：使用提取的已知条件进行验证\n该问题在连续介质力学和计算流体动力学的框架内是良定义的。\n- **科学依据**：该问题使用了流体动力学和传热学基础的标准守恒定律（热力学第一定律）和本构关系（牛顿流体，傅里叶定律）。指定的速度场 $\\mathbf{u} = (\\gamma y, 0)$ 代表了简单的剪切流，这是一个经典的、具有物理意义的模型。条件 $\\nabla \\cdot \\mathbf{u} = \\frac{\\partial(\\gamma y)}{\\partial x} + \\frac{\\partial(0)}{\\partial y} = 0$ 证实了该流动是不可压缩的，与问题陈述一致。\n- **良态性**：任务是找到一个源项 $S(x,y)$，使其满足给定场下的控制偏微分方程。这是一个直接的计算，并且 $S(x,y)$ 存在唯一解。这类似于计算流体动力学验证中使用的“人造解方法”(Method of Manufactured Solutions)。\n- **客观性**：问题使用了来自物理学和工程学的精确、标准且无偏的术语进行陈述。\n- **完整性与一致性**：所有必需的变量、常数和关系都已提供。没有矛盾之处。\n- **真实性**：尽管是理想化的，但这些场和问题设置在物理上并非不可能，并且代表了一个有效的理论练习。\n\n### 步骤三：结论与行动\n问题是**有效的**，因为它是科学合理的、良态的且内部一致的。将推导完整的解答。\n\n### 推导与解答\n\n分析从能量守恒方程的微分形式开始。问题要求从积分形式出发，但从积分形式推导微分形式是连续介质力学中的一个标准程序。得到的内能微分方程是本次计算的合适起点。包含体积源项 $S$ 的内能方程由下式给出：\n$$\n\\rho \\frac{De}{Dt} = -\\nabla \\cdot \\mathbf{q} + \\boldsymbol{\\sigma} : \\nabla\\mathbf{u} + S\n$$\n此处，$e$ 是比内能，$\\rho$ 是密度，$\\frac{D}{Dt}$ 是物质导数，$\\mathbf{q}$ 是热通量矢量，$\\boldsymbol{\\sigma}$ 是总应力张量。项 $\\boldsymbol{\\sigma} : \\nabla\\mathbf{u}$ 代表应力做功的速率。\n\n牛顿流体的总应力张量 $\\boldsymbol{\\sigma}$ 由 $\\boldsymbol{\\sigma} = -p\\mathbf{I} + \\boldsymbol{\\tau}$ 给出，其中 $p$ 是压力，$\\mathbf{I}$ 是单位张量，$\\boldsymbol{\\tau}$ 是粘性应力张量。应力功项为：\n$$\n\\boldsymbol{\\sigma} : \\nabla\\mathbf{u} = (-p\\mathbf{I} + \\boldsymbol{\\tau}) : \\nabla\\mathbf{u} = -p(\\mathbf{I} : \\nabla\\mathbf{u}) + \\boldsymbol{\\tau} : \\nabla\\mathbf{u} = -p(\\nabla \\cdot \\mathbf{u}) + \\boldsymbol{\\tau} : \\nabla\\mathbf{u}\n$$\n对于不可压缩流体，连续性方程为 $\\nabla \\cdot \\mathbf{u} = 0$。因此，压力功项 $-p(\\nabla \\cdot \\mathbf{u})$ 为零。剩余的项 $\\Phi \\equiv \\boldsymbol{\\tau} : \\nabla\\mathbf{u}$ 是粘性耗散函数，它表示机械能到内能的不可逆转换。\n\n对于密度恒定的物质，比内能的变化 $de$ 与温度的变化 $dT$ 通过 $de = c_v dT$ 相关。因此，物质导数为 $\\frac{De}{Dt} = c_v \\frac{DT}{Dt}$。对于稳态流，物质导数简化为 $\\frac{D}{Dt} = \\mathbf{u} \\cdot \\nabla$。\n\n因此，内能方程变为：\n$$\n\\rho c_v (\\mathbf{u} \\cdot \\nabla T) = -\\nabla \\cdot \\mathbf{q} + \\Phi + S\n$$\n我们的目标是确定源项 $S(x,y)$，以确保该方程对于给定的速度场和温度场成立。我们必须计算每一项：对流项、热扩散项和粘性耗散项。\n\n1.  **对流项：$\\rho c_v (\\mathbf{u} \\cdot \\nabla T)$**\n    温度场为 $T(x,y) = T_0 + ax^2 + by^2$。其梯度为：\n    $$\n    \\nabla T = \\frac{\\partial T}{\\partial x}\\mathbf{i} + \\frac{\\partial T}{\\partial y}\\mathbf{j} = 2ax \\mathbf{i} + 2by \\mathbf{j}\n    $$\n    速度场为 $\\mathbf{u}(x,y) = \\gamma y \\mathbf{i} + 0 \\mathbf{j}$。\n    温度的平流项是：\n    $$\n    \\mathbf{u} \\cdot \\nabla T = (\\gamma y)(2ax) + (0)(2by) = 2 a \\gamma xy\n    $$\n    所以，完整的对流项是 $2 \\rho c_v a \\gamma xy$。\n\n2.  **热扩散项：$-\\nabla \\cdot \\mathbf{q}$**\n    使用傅里叶定律，热通量矢量 $\\mathbf{q}$ 为：\n    $$\n    \\mathbf{q} = -k \\nabla T = -k (2ax \\mathbf{i} + 2by \\mathbf{j}) = -2kax \\mathbf{i} - 2kby \\mathbf{j}\n    $$\n    热通量的散度是：\n    $$\n    \\nabla \\cdot \\mathbf{q} = \\frac{\\partial}{\\partial x}(-2kax) + \\frac{\\partial}{\\partial y}(-2kby) = -2ka - 2kb = -2k(a+b)\n    $$\n    因此，能量方程中的热扩散项是 $-\\nabla \\cdot \\mathbf{q} = 2k(a+b)$。\n\n3.  **粘性耗散项：$\\Phi = \\boldsymbol{\\tau} : \\nabla\\mathbf{u}$**\n    首先，我们求速度梯度张量 $\\nabla\\mathbf{u}$：\n    $$\n    \\nabla\\mathbf{u} = \\begin{pmatrix} \\frac{\\partial u_x}{\\partial x}  \\frac{\\partial u_x}{\\partial y} \\\\ \\frac{\\partial u_y}{\\partial x}  \\frac{\\partial u_y}{\\partial y} \\end{pmatrix} = \\begin{pmatrix} \\frac{\\partial(\\gamma y)}{\\partial x}  \\frac{\\partial(\\gamma y)}{\\partial y} \\\\ \\frac{\\partial(0)}{\\partial x}  \\frac{\\partial(0)}{\\partial y} \\end{pmatrix} = \\begin{pmatrix} 0  \\gamma \\\\ 0  0 \\end{pmatrix}\n    $$\n    牛顿流体的粘性应力张量为 $\\boldsymbol{\\tau} = \\mu(\\nabla\\mathbf{u} + (\\nabla\\mathbf{u})^T)$。\n    $$\n    \\boldsymbol{\\tau} = \\mu \\left( \\begin{pmatrix} 0  \\gamma \\\\ 0  0 \\end{pmatrix} + \\begin{pmatrix} 0  0 \\\\ \\gamma  0 \\end{pmatrix} \\right) = \\mu \\begin{pmatrix} 0  \\gamma \\\\ \\gamma  0 \\end{pmatrix}\n    $$\n    粘性耗散函数是张量缩并 $\\Phi = \\boldsymbol{\\tau} : \\nabla\\mathbf{u}$：\n    $$\n    \\Phi = \\sum_{i=1}^2 \\sum_{j=1}^2 \\tau_{ij} \\frac{\\partial u_i}{\\partial x_j} = \\tau_{xx}\\frac{\\partial u_x}{\\partial x} + \\tau_{xy}\\frac{\\partial u_x}{\\partial y} + \\tau_{yx}\\frac{\\partial u_y}{\\partial x} + \\tau_{yy}\\frac{\\partial u_y}{\\partial y}\n    $$\n    代入 $\\boldsymbol{\\tau}$ 和 $\\nabla\\mathbf{u}$ 的分量：\n    $$\n    \\Phi = (0)(0) + (\\mu\\gamma)(\\gamma) + (\\mu\\gamma)(0) + (0)(0) = \\mu\\gamma^2\n    $$\n    对于该流场，粘性耗散是一个常数。\n\n现在，我们将这些计算出的项代回到内能方程中：\n$$\n2 \\rho c_v a \\gamma xy = 2k(a+b) + \\mu\\gamma^2 + S(x,y)\n$$\n解出源项 $S(x,y)$ 得到：\n$$\nS(x,y) = 2 \\rho c_v a \\gamma xy - 2k(a+b) - \\mu\\gamma^2\n$$\n这就是为了在对流、扩散和粘性加热作用下维持给定的稳态速度和温度分布所需的体积内能源项。", "answer": "$$\n\\boxed{2\\rho c_v a \\gamma xy - 2k(a+b) - \\mu\\gamma^{2}}\n$$", "id": "3335339"}, {"introduction": "现在，我们将视角从局部的微分形式转向宏观的积分分析。本问题提出了一个真实的工程场景：流体流经管道，这要求您应用积分形式的能量守恒定律。您需要通过核算整个系统中的所有能量交换——包括非均匀的壁面加热、分布式的轴功输入以及粘性耗散产生的热效应——来计算流体的最终出口温度。[@problem_id:3335387]", "problem": "一根长度为 $L = 5\\,\\mathrm{m}$、横截面积为 $A = 0.01\\,\\mathrm{m}^2$、湿周为 $P = 0.4\\,\\mathrm{m}$ 的直的等截面矩形管道，输送一种稳态、单相、不可压缩的流体，该流体具有恒定的物性：密度 $\\rho = 1.2\\,\\mathrm{kg}\\,\\mathrm{m}^{-3}$、定压比热 $c_p = 1005\\,\\mathrm{J}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-1}$ 和导热系数 $k = 0.026\\,\\mathrm{W}\\,\\mathrm{m}^{-1}\\,\\mathrm{K}^{-1}$。沿管道的平均轴向速度均匀且等于 $U = 3\\,\\mathrm{m}\\,\\mathrm{s}^{-1}$。入口主流温度为 $T_{\\text{in}} = 300\\,\\mathrm{K}$。流动是水平的，因此重力势能的变化可以忽略不计，且在整个长度上主流平均动能的变化也可以忽略不计。\n\n壁面热通量沿流向的变化规律为 $q''_w(x) = q_0\\left(1 + \\frac{x}{L}\\right)$，其中 $q_0 = 150\\,\\mathrm{W}\\,\\mathrm{m}^{-2}$，$x \\in [0,L]$ 表示从入口开始的距离。一个与流体耦合的分布式轴以单位长度的功率 $\\dot{W}_s'(x) = w_0 \\cos\\!\\left(\\frac{\\pi x}{2L}\\right)$ 对流体做轴功，其中 $w_0 = 20\\,\\mathrm{W}\\,\\mathrm{m}^{-1}$。壁面剪切应力经测量由下式给出 $\\tau_w(x) = \\tau_0\\left(1 + \\frac{1}{2}\\sin\\!\\left(\\frac{2\\pi x}{L}\\right)\\right)$，其中 $\\tau_0 = 0.6\\,\\mathrm{Pa}$。您可以假设轴向压力梯度和壁面剪切之间的关系在局部上与水力直径为 $D_h = \\frac{4A}{P}$ 的直管道相同，即 $-\\frac{\\mathrm{d}p}{\\mathrm{d}x} = \\frac{4\\tau_w(x)}{D_h}$。基于水力直径的佩克莱特数 (Péclet number) 足够大，以至于轴向导热可以忽略不计。\n\n从总能量的雷诺输运定理 (Reynolds transport theorem) 出发，并针对所述条件进行适当简化，为跨越 $x \\in [0,L]$ 的控制体写出一维积分能量平衡式，该式明确地考虑了壁面加热、分布式轴功输入和粘性耗散。然后对其求值，以获得出口主流温度 $T_{\\text{out}}$。\n\n最终温度以开尔文表示，并将您的答案四舍五入到四位有效数字。", "solution": "用户提供的问题被评估为有效。它在科学上基于流体力学和热力学的原理，特别是能量守恒。该问题是适定的、客观的和自洽的，为获得唯一解提供了所有必要的数据和关系，没有任何明显的矛盾或物理上不合理的情况。导热系数 $k$ 已给出但求解过程并不需要，因为壁面热通量是直接指定的，并且轴向导热被忽略；这不构成缺陷。\n\n我们首先将能量的雷诺输运定理 (Reynolds Transport Theorem) 应用于管道内流体的一个微元控制体，其长度为 $dx$，横截面积为 $A$。对于稳态一维流动，能量守恒方程为：\n$$ d\\dot{Q} + d\\dot{W}_s = d(\\dot{m} h_{total}) $$\n其中 $d\\dot{Q}$ 是传入控制体的传热率，$d\\dot{W}_s$ 是对控制体所做轴功的功率，$h_{total}$ 是总比焓。总焓由 $h_{total} = h + \\frac{1}{2}U^2 + gz$ 给出，其中 $h$ 是静比焓，$U$ 是平均速度，$z$ 是海拔高度。\n\n问题陈述平均轴向速度 $U$ 是均匀的，且流动是水平的。因此，动能和势能的变化为零：$d(\\frac{1}{2}U^2) = 0$ 和 $d(gz) = 0$。能量方程简化为焓平衡：\n$$ d\\dot{Q} + d\\dot{W}_s = \\dot{m} dh $$\n微元传热率为 $d\\dot{Q} = q''_w(x) P dx$，微元轴功功率为 $d\\dot{W}_s = \\dot{W}_s'(x) dx$。质量流量 $\\dot{m} = \\rho U A$ 是恒定的。对于物性恒定的流体，比焓的变化为 $dh = c_p dT + \\frac{1}{\\rho} dp$。将这些表达式代入平衡方程得到：\n$$ q''_w(x) P dx + \\dot{W}_s'(x) dx = \\dot{m} \\left(c_p dT + \\frac{1}{\\rho} dp\\right) $$\n两边同除以 $dx$ 得到能量方程的微分形式：\n$$ q''_w(x) P + \\dot{W}_s'(x) = \\dot{m} c_p \\frac{dT}{dx} + \\frac{\\dot{m}}{\\rho} \\frac{dp}{dx} $$\n该方程将温度梯度与热量添加、轴功和压力梯度联系起来。问题提供了由壁面摩擦引起的压力梯度的关系式：\n$$ -\\frac{dp}{dx} = \\frac{4\\tau_w(x)}{D_h} $$\n水力直径为 $D_h = \\frac{4A}{P}$，所以 $-\\frac{dp}{dx} = \\frac{4\\tau_w(x)}{4A/P} = \\frac{P\\tau_w(x)}{A}$。因此，$\\frac{dp}{dx} = -\\frac{P\\tau_w(x)}{A}$。\n将此代入能量方程：\n$$ q''_w(x) P + \\dot{W}_s'(x) = \\dot{m} c_p \\frac{dT}{dx} + \\frac{\\dot{m}}{\\rho} \\left(-\\frac{P\\tau_w(x)}{A}\\right) $$\n重新整理以求解温度梯度项：\n$$ \\dot{m} c_p \\frac{dT}{dx} = q''_w(x) P + \\dot{W}_s'(x) + \\frac{\\dot{m}P}{\\rho A} \\tau_w(x) $$\n利用质量流量的定义 $\\dot{m} = \\rho U A$，我们可以简化剪切应力项的系数：$\\frac{\\dot{m}}{\\rho A} = U$。\n$$ \\dot{m} c_p \\frac{dT}{dx} = q''_w(x) P + \\dot{W}_s'(x) + P U \\tau_w(x) $$\n项 $P U \\tau_w(x)$ 代表单位长度的粘性耗散率，它是机械能不可逆地转化为内能的过程，从而加热流体。\n为了求出出口温度 $T_{\\text{out}}$，我们在管道的全长上对该方程进行积分，从 $x=0$ 到 $x=L$：\n$$ \\int_0^L \\dot{m} c_p \\frac{dT}{dx} dx = \\int_0^L \\left( q''_w(x) P + \\dot{W}_s'(x) + P U \\tau_w(x) \\right) dx $$\n$$ \\dot{m} c_p (T_{\\text{out}} - T_{\\text{in}}) = P \\int_0^L q''_w(x) dx + \\int_0^L \\dot{W}_s'(x) dx + P U \\int_0^L \\tau_w(x) dx $$\n这就是所要求的一维积分能量平衡式。让我们计算每一项。\n\n总的加热量为 $\\dot{Q}_{total} = P \\int_0^L q''_w(x) dx$：\n$$ \\dot{Q}_{total} = P \\int_0^L q_0\\left(1 + \\frac{x}{L}\\right) dx = P q_0 \\left[x + \\frac{x^2}{2L}\\right]_0^L = P q_0 \\left(L + \\frac{L^2}{2L}\\right) = \\frac{3}{2} P q_0 L $$\n总的轴功输入为 $\\dot{W}_{s,total} = \\int_0^L \\dot{W}_s'(x) dx$：\n$$ \\dot{W}_{s,total} = \\int_0^L w_0 \\cos\\left(\\frac{\\pi x}{2L}\\right) dx = w_0 \\left[\\frac{2L}{\\pi}\\sin\\left(\\frac{\\pi x}{2L}\\right)\\right]_0^L = w_0 \\frac{2L}{\\pi} \\left(\\sin\\left(\\frac{\\pi}{2}\\right) - \\sin(0)\\right) = \\frac{2w_0 L}{\\pi} $$\n总的粘性耗散为 $\\dot{E}_{diss,total} = P U \\int_0^L \\tau_w(x) dx$：\n$$ \\dot{E}_{diss,total} = P U \\int_0^L \\tau_0\\left(1 + \\frac{1}{2}\\sin\\left(\\frac{2\\pi x}{L}\\right)\\right) dx $$\n正弦项在其周期上的积分为零：$\\int_0^L \\sin\\left(\\frac{2\\pi x}{L}\\right) dx = 0$。\n$$ \\dot{E}_{diss,total} = P U \\tau_0 \\int_0^L dx = P U \\tau_0 L $$\n\n现在，我们代入给定的数值：\n$L = 5\\,\\mathrm{m}$，$A = 0.01\\,\\mathrm{m}^2$，$P = 0.4\\,\\mathrm{m}$，$\\rho = 1.2\\,\\mathrm{kg}\\,\\mathrm{m}^{-3}$，$c_p = 1005\\,\\mathrm{J}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-1}$，$U = 3\\,\\mathrm{m}\\,\\mathrm{s}^{-1}$，$T_{\\text{in}} = 300\\,\\mathrm{K}$，$q_0 = 150\\,\\mathrm{W}\\,\\mathrm{m}^{-2}$，$w_0 = 20\\,\\mathrm{W}\\,\\mathrm{m}^{-1}$，$\\tau_0 = 0.6\\,\\mathrm{Pa}$。\n\n首先，计算常数项：\n质量流量：$\\dot{m} = \\rho U A = (1.2\\,\\mathrm{kg}\\,\\mathrm{m}^{-3})(3\\,\\mathrm{m}\\,\\mathrm{s}^{-1})(0.01\\,\\mathrm{m}^2) = 0.036\\,\\mathrm{kg}\\,\\mathrm{s}^{-1}$。\n热容率：$\\dot{m}c_p = (0.036\\,\\mathrm{kg}\\,\\mathrm{s}^{-1})(1005\\,\\mathrm{J}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-1}) = 36.18\\,\\mathrm{W}\\,\\mathrm{K}^{-1}$。\n\n接下来，计算总能量输入项：\n$$ \\dot{Q}_{total} = \\frac{3}{2}(0.4\\,\\mathrm{m})(150\\,\\mathrm{W}\\,\\mathrm{m}^{-2})(5\\,\\mathrm{m}) = 450\\,\\mathrm{W} $$\n$$ \\dot{W}_{s,total} = \\frac{2(20\\,\\mathrm{W}\\,\\mathrm{m}^{-1})(5\\,\\mathrm{m})}{\\pi} = \\frac{200}{\\pi}\\,\\mathrm{W} $$\n$$ \\dot{E}_{diss,total} = (0.4\\,\\mathrm{m})(3\\,\\mathrm{m}\\,\\mathrm{s}^{-1})(0.6\\,\\mathrm{Pa})(5\\,\\mathrm{m}) = 3.6\\,\\mathrm{W} $$\n\n流体总能量增加率为：\n$$ \\dot{E}_{added} = \\dot{Q}_{total} + \\dot{W}_{s,total} + \\dot{E}_{diss,total} = 450 + \\frac{200}{\\pi} + 3.6 = 453.6 + \\frac{200}{\\pi} \\,\\mathrm{W} $$\n$$ \\dot{E}_{added} \\approx 453.6 + 63.661977... = 517.261977...\\,\\mathrm{W} $$\n\n最后，我们根据积分能量平衡求出出口温度 $T_{\\text{out}}$：\n$$ T_{\\text{out}} - T_{\\text{in}} = \\frac{\\dot{E}_{added}}{\\dot{m}c_p} $$\n$$ T_{\\text{out}} = T_{\\text{in}} + \\frac{517.261977...\\,\\mathrm{W}}{36.18\\,\\mathrm{W}\\,\\mathrm{K}^{-1}} $$\n$$ T_{\\text{out}} = 300\\,\\mathrm{K} + 14.296904...\\,\\mathrm{K} = 314.296904...\\,\\mathrm{K} $$\n将结果四舍五入到四位有效数字，得到 $314.3\\,\\mathrm{K}$。", "answer": "$$ \\boxed{314.3} $$", "id": "3335387"}, {"introduction": "最后一个练习将探讨在可压缩流数值模拟中一个关键而微妙的问题：能量方程的守恒形式与非守恒形式的选择。虽然一个简单的、基于温度的方程看似直观，但在具有显著可压缩效应的流动中，它无法保证总能量的守恒。通过一个精心设计的数值实验，本练习将揭示为何守恒的总能量公式对于确保高速流动模拟的物理准确性和数值稳健性是必不可少的。[@problem_id:3335363]", "problem": "本题要求您推导、实现并数值验证带有粘性耗散的可压缩牛顿流体的全局能量平衡。目的是在具有强粘性加热的高速流中，比较基于温度的非守恒格式与守恒的总能量格式，并证明只有守恒的总能量格式才能闭合全局能量平衡。验证应在一维周期性域中使用构造的光滑流场执行，您的程序必须计算指定测试用例的全局能量平衡的量化残差。\n\n出发点和允许的基础：\n- 对移动控制体使用热力学第一定律，对连续介质使用牛顿第二定律。\n- 使用具有恒定属性的理想气体模型。设单位质量的理想气体常数为 $R$，定容比热为 $c_v$。假设动力粘度 $\\mu$ 和热导率为 $k$ 的傅里叶热传导是恒定的。\n- 使用牛顿粘性应力张量定义\n$$\\boldsymbol{\\tau} = \\mu \\left(\\nabla \\boldsymbol{u} + \\nabla \\boldsymbol{u}^{\\mathsf{T}} - \\tfrac{2}{3} (\\nabla \\cdot \\boldsymbol{u}) \\boldsymbol{I}\\right),$$\n和傅里叶热传导定律\n$$\\boldsymbol{q} = -k \\nabla T.$$\n- 仅限于一维空间维度 $x$，其中速度为 $u(x)$，密度为 $\\rho(x)$，温度为 $T(x)$。在一维中，唯一非零的法向粘性应力分量是\n$$\\tau_{xx} = \\tfrac{4}{3} \\mu \\frac{\\partial u}{\\partial x},$$\n粘性耗散函数为\n$$\\Phi = \\boldsymbol{\\tau} : \\nabla \\boldsymbol{u} = \\tau_{xx} \\frac{\\partial u}{\\partial x} = \\tfrac{4}{3} \\mu \\left(\\frac{\\partial u}{\\partial x}\\right)^2.$$\n理想气体压力为 $p(x) = \\rho(x) R T(x)$，单位质量的内能为 $e(x) = c_v T(x)$；单位质量的总能量为 $e_t(x) = e(x) + \\tfrac{1}{2} u(x)^2$。\n\n推导任务：\n1. 从应用于流体控制体的第一定律出发，并使用雷诺输运定理，推导包含粘性功和热传导的总能量守恒方程的微分形式和积分形式。明确指出压力功和粘性耗散的作用。\n2. 推导内能方程（微分形式）和动能方程，展示压力-膨胀项和粘性功项如何以相反的符号出现，以使其总和恢复为守恒的总能量方程。\n3. 定义并讨论一个基于温度的非守恒格式，该格式忽略了压力-膨胀项 $-p \\nabla \\cdot \\boldsymbol{u}$，并解释为什么这在不可压缩流中是可接受的，但对于具有显著膨胀的可压缩高速流通常是无效的。\n4. 将您的积分表达式具体化到一维周期性域 $x \\in [0,L)$，解释为什么散度的表面通量积分为零，并以压力-膨胀项 $p \\frac{\\partial u}{\\partial x}$ 和粘性耗散 $\\Phi$ 的体积积分形式，陈述内能、动能和总能量的最终全局平衡表达式。\n\n程序任务：\n- 在一个长度为 $L$ 的一维周期性域中实现数值验证，该域被离散化为 $N$ 个均匀间隔的控制体，网格间距为 $\\Delta x = L/N$。定义构造场\n$$u(x) = U_0 \\sin\\left(\\tfrac{2\\pi m x}{L}\\right), \\quad \\rho(x) = \\rho_0 \\left[1 + a_r \\sin\\left(\\tfrac{2\\pi x}{L}\\right)\\right], \\quad T(x) = T_0 \\left[1 + a_T \\cos\\left(\\tfrac{2\\pi x}{L}\\right)\\right],$$\n对于给定的参数 $(L,N,U_0,\\mu,\\rho_0,T_0,a_r,a_T,m)$。\n- 使用带有周期性边界的二阶中心有限差分格式来近似网格上的 $\\frac{\\partial u}{\\partial x}$。使用上述公式计算逐点的 $p(x)$ 和 $\\Phi(x)$，然后使用黎曼和计算周期性域上的体积积分：\n$$I_{p\\,\\mathrm{div}} = \\int_0^L p(x) \\frac{\\partial u}{\\partial x} \\, dx \\approx \\sum_{i=0}^{N-1} p_i \\left(\\frac{\\partial u}{\\partial x}\\right)_i \\Delta x,$$\n$$I_{\\Phi} = \\int_0^L \\Phi(x) \\, dx \\approx \\sum_{i=0}^{N-1} \\Phi_i \\Delta x.$$\n- 构建全局速率：\n    - 来自内能方程的精确内能速率：$I_{\\mathrm{int,exact}} = -I_{p\\,\\mathrm{div}} + I_{\\Phi}$。\n    - 动能速率（来自周期性域中的动量和连续性恒等式）：$I_{\\mathrm{kin}} = I_{p\\,\\mathrm{div}} - I_{\\Phi}$。\n    - 守恒总能量速率：$I_{\\mathrm{tot,cons}} = I_{\\mathrm{int,exact}} + I_{\\mathrm{kin}}$。\n    - 基于温度的非守恒内能速率（忽略压力膨胀）：$I_{\\mathrm{int,temp}} = I_{\\Phi}$，以及相应的错误总能量速率 $I_{\\mathrm{tot,temp}} = I_{\\mathrm{int,temp}} + I_{\\mathrm{kin}} = I_{p\\,\\mathrm{div}}$。\n- 通过测试绝对残差是否低于某个容差来判断全局能量平衡是否“闭合”。使用一个尺度感知的容差\n$$\\varepsilon = 10^{-9} \\max\\left(1, |I_{p\\,\\mathrm{div}}| + |I_{\\Phi}|\\right).$$\n如果 $|I_{\\mathrm{tot}}| \\le \\varepsilon$，则一个格式“闭合”。\n\n常数和单位：\n- 对于代表空气的理想双原子气体，使用 $R = 287\\,\\mathrm{J}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-1}$ 和 $\\gamma = 1.4$，因此 $c_v = R/(\\gamma - 1) = 717.5\\,\\mathrm{J}\\,\\mathrm{kg}^{-1}\\,\\mathrm{K}^{-1}$。\n- 动力粘度 $\\mu$ 的单位是 $\\mathrm{Pa}\\cdot \\mathrm{s}$，体积功率密度在域上的所有积分得到的全局功率单位为 $\\mathrm{W}$。\n- 您的程序必须以浮点数形式报告残差（单位为 $\\mathrm{W}$）。布尔值必须指示相应的全局能量平衡是否在所述容差下闭合。\n\n测试套件：\n评估以下四个参数集，它们涵盖了不同的工况。三角函数中的所有角度均为弧度，因为它们的参数已通过 $x/L$ 无量纲化。\n\n1. 高速流下的强粘性加热：\n    - $L = 1.0\\,\\mathrm{m}$, $N = 8192$, $U_0 = 900.0\\,\\mathrm{m}/\\mathrm{s}$, $\\mu = 1.8\\times 10^{-5}\\,\\mathrm{Pa}\\cdot\\mathrm{s}$,\n    - $\\rho_0 = 1.0\\,\\mathrm{kg}/\\mathrm{m}^3$, $T_0 = 300.0\\,\\mathrm{K}$,\n    - $a_r = 0.25$, $a_T = 0.35$, $m = 8$.\n2. 近不可压缩工况：\n    - $L = 1.0\\,\\mathrm{m}$, $N = 4096$, $U_0 = 30.0\\,\\mathrm{m}/\\mathrm{s}$, $\\mu = 1.8\\times 10^{-5}\\,\\mathrm{Pa}\\cdot\\mathrm{s}$,\n    - $\\rho_0 = 1.0\\,\\mathrm{kg}/\\mathrm{m}^3$, $T_0 = 300.0\\,\\mathrm{K}$,\n    - $a_r = 10^{-4}$, $a_T = 10^{-4}$, $m = 1$.\n3. 零粘度（无粘性加热）下的可压缩膨胀：\n    - $L = 1.0\\,\\mathrm{m}$, $N = 8192$, $U_0 = 700.0\\,\\mathrm{m}/\\mathrm{s}$, $\\mu = 0.0\\,\\mathrm{Pa}\\cdot\\mathrm{s}$,\n    - $\\rho_0 = 1.0\\,\\mathrm{kg}/\\mathrm{m}^3$, $T_0 = 300.0\\,\\mathrm{K}$,\n    - $a_r = 0.30$, $a_T = 0.40$, $m = 4$.\n4. 高频剪切（强梯度，强粘性加热）：\n    - $L = 1.0\\,\\mathrm{m}$, $N = 16384$, $U_0 = 500.0\\,\\mathrm{m}/\\mathrm{s}$, $\\mu = 1.8\\times 10^{-5}\\,\\mathrm{Pa}\\cdot\\mathrm{s}$,\n    - $\\rho_0 = 1.0\\,\\mathrm{kg}/\\mathrm{m}^3$, $T_0 = 300.0\\,\\mathrm{K}$,\n    - $a_r = 0.25$, $a_T = 0.25$, $m = 16$.\n\n必需的最终输出格式：\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。每个测试用例贡献一个包含四个条目的列表：\n- 一个布尔值，指示守恒的总能量格式是否闭合，\n- 一个布尔值，指示基于温度的非守恒格式是否闭合，\n- 守恒的总能量平衡的绝对残差（单位为 $\\mathrm{W}$），作为浮点数，\n- 基于温度的非守恒的总能量平衡的绝对残差（单位为 $\\mathrm{W}$），作为浮点数。\n\n例如，输出必须如下所示：\n$$[\\,[\\mathrm{True},\\mathrm{False},r_1,s_1],\\,[\\mathrm{True},\\mathrm{True},r_2,s_2],\\,[\\mathrm{True},\\mathrm{False},r_3,s_3],\\,[\\mathrm{True},\\mathrm{False},r_4,s_4]\\,],$$\n其中 $r_i$ 和 $s_i$ 是第 $i$ 个测试用例的浮点数（单位为 $\\mathrm{W}$）。不得打印其他任何文本。", "solution": "该问题要求推导可压缩流体能量守恒方程的各种形式，然后在一维周期性域中使用构造解进行数值验证。其目标是证明在高速可压缩流中，守恒的总能量格式的重要性。\n\n### 第 1 部分：推导\n\n所有推导均针对由理想气体定律控制的可压缩牛顿流体。所有变量都是位置 $\\boldsymbol{x}$ 和时间 $t$ 的函数。\n\n#### 1. 总能量守恒\n\n对于一个移动的流体控制体 $V(t)$，其表面为 $S(t)$，热力学第一定律指出，总能量的变化率等于对该控制体所做的功的速率加上向其加热的速率。\n$$ \\frac{d}{dt}\\int_{V(t)} \\rho e_t \\, dV = \\oint_{S(t)} \\boldsymbol{n} \\cdot (\\boldsymbol{\\sigma}\\cdot\\boldsymbol{u}) \\, dS - \\oint_{S(t)} \\boldsymbol{n} \\cdot \\boldsymbol{q} \\, dS $$\n这里，$\\rho$ 是密度，$e_t = e + \\frac{1}{2}|\\boldsymbol{u}|^2$ 是单位质量的总能量（内能 $e$ 和动能之和），$\\boldsymbol{u}$ 是速度矢量，$\\boldsymbol{n}$ 是指向表面 $S(t)$ 外部的单位法向量，$\\boldsymbol{\\sigma} = -p\\boldsymbol{I} + \\boldsymbol{\\tau}$ 是总应力张量（其中 $p$ 是压力，$\\boldsymbol{\\tau}$ 是粘性应力张量），$\\boldsymbol{q}$ 是热通量矢量。项 $\\boldsymbol{\\sigma}\\cdot\\boldsymbol{u}$ 表示表面应力（应力牵引力）所做的功，$\\boldsymbol{q}$ 表示通过传导进行的热量传递。\n\n对左侧应用雷诺输运定理于固定控制体 $V$：\n$$ \\frac{d}{dt}\\int_{V} \\rho e_t \\, dV = \\int_V \\frac{\\partial (\\rho e_t)}{\\partial t} dV $$\n在与时间无关的条件下，如此处仅为 $x$ 函数的构造解所示，该项为零。我们分析其他项所隐含的瞬时变化率。包含时间演化的完整形式为：\n$$ \\int_V \\frac{\\partial (\\rho e_t)}{\\partial t} \\, dV + \\oint_S (\\rho e_t \\boldsymbol{u}) \\cdot \\boldsymbol{n} \\, dS = \\oint_S (\\boldsymbol{\\sigma}\\cdot\\boldsymbol{u}) \\cdot \\boldsymbol{n} \\, dS - \\oint_S \\boldsymbol{q} \\cdot \\boldsymbol{n} \\, dS $$\n使用散度定理将表面积分转换为体积积分，得到固定体积 $V$ 的积分形式：\n$$ \\int_V \\left[ \\frac{\\partial (\\rho e_t)}{\\partial t} + \\nabla \\cdot (\\rho e_t \\boldsymbol{u}) - \\nabla \\cdot (\\boldsymbol{\\sigma}\\cdot\\boldsymbol{u}) + \\nabla \\cdot \\boldsymbol{q} \\right] dV = 0 $$\n由于这对任意体积 $V$ 都成立，被积函数必须为零，从而得到总能量方程的微分形式（守恒形式）：\n$$ \\frac{\\partial (\\rho e_t)}{\\partial t} + \\nabla \\cdot (\\rho e_t \\boldsymbol{u}) = \\nabla \\cdot (\\boldsymbol{\\sigma}\\cdot\\boldsymbol{u}) - \\nabla \\cdot \\boldsymbol{q} $$\n功项 $\\nabla \\cdot (\\boldsymbol{\\sigma}\\cdot\\boldsymbol{u})$ 代表由压力和粘性力做功的综合效应。\n\n#### 2. 内能和动能方程\n\n为了理解能量交换机制，我们将总能量方程分解为动能和内能方程。\n\n**动能方程：**\n我们从柯西动量方程 $\\rho \\frac{D\\boldsymbol{u}}{Dt} = \\nabla \\cdot \\boldsymbol{\\sigma}$ 开始，其中 $\\frac{D}{Dt} = \\frac{\\partial}{\\partial t} + \\boldsymbol{u}\\cdot\\nabla$ 是物质导数。与 $\\boldsymbol{u}$ 做点积得到：\n$$ \\rho \\boldsymbol{u} \\cdot \\frac{D\\boldsymbol{u}}{Dt} = \\boldsymbol{u} \\cdot (\\nabla \\cdot \\boldsymbol{\\sigma}) \\implies \\rho \\frac{D}{Dt}\\left(\\frac{1}{2}|\\boldsymbol{u}|^2\\right) = \\boldsymbol{u} \\cdot (\\nabla \\cdot \\boldsymbol{\\sigma}) $$\n使用乘积法则恒等式 $\\boldsymbol{u} \\cdot (\\nabla \\cdot \\boldsymbol{\\sigma}) = \\nabla \\cdot (\\boldsymbol{\\sigma} \\cdot \\boldsymbol{u}) - \\boldsymbol{\\sigma} : \\nabla\\boldsymbol{u}$，我们得到非守恒形式的动能方程：\n$$ \\rho \\frac{D}{Dt}\\left(\\frac{1}{2}|\\boldsymbol{u}|^2\\right) = \\nabla \\cdot (\\boldsymbol{\\sigma} \\cdot \\boldsymbol{u}) - \\boldsymbol{\\sigma} : \\nabla\\boldsymbol{u} $$\n项 $\\boldsymbol{\\sigma} : \\nabla\\boldsymbol{u}$ 是应力使流体元变形所做的功。代入 $\\boldsymbol{\\sigma} = -p\\boldsymbol{I} + \\boldsymbol{\\tau}$：\n$$ \\boldsymbol{\\sigma} : \\nabla\\boldsymbol{u} = (-p\\boldsymbol{I} + \\boldsymbol{\\tau}) : \\nabla\\boldsymbol{u} = -p (\\boldsymbol{I}:\\nabla\\boldsymbol{u}) + \\boldsymbol{\\tau}:\\nabla\\boldsymbol{u} = -p(\\nabla \\cdot \\boldsymbol{u}) + \\Phi $$\n其中 $\\Phi = \\boldsymbol{\\tau}:\\nabla\\boldsymbol{u}$ 是粘性耗散函数（恒为非负），表示由于粘性，动能不可逆地转化为内能（热量）。项 $-p(\\nabla \\cdot \\boldsymbol{u})$ 是可逆的压缩/膨胀功（压力-膨胀功）。\n\n**内能方程：**\n非守恒形式的总能量方程为 $\\rho \\frac{De_t}{Dt} = \\nabla \\cdot (\\boldsymbol{\\sigma}\\cdot\\boldsymbol{u}) - \\nabla\\cdot\\boldsymbol{q}$。由于 $e_t = e + \\frac{1}{2}|\\boldsymbol{u}|^2$：\n$$ \\rho \\frac{De}{Dt} + \\rho \\frac{D}{Dt}\\left(\\frac{1}{2}|\\boldsymbol{u}|^2\\right) = \\nabla \\cdot (\\boldsymbol{\\sigma}\\cdot\\boldsymbol{u}) - \\nabla\\cdot\\boldsymbol{q} $$\n代入上面推导的动能方程：\n$$ \\rho \\frac{De}{Dt} + \\left( \\nabla \\cdot (\\boldsymbol{\\sigma} \\cdot \\boldsymbol{u}) - \\boldsymbol{\\sigma} : \\nabla\\boldsymbol{u} \\right) = \\nabla \\cdot (\\boldsymbol{\\sigma}\\cdot\\boldsymbol{u}) - \\nabla\\cdot\\boldsymbol{q} $$\n$$ \\rho \\frac{De}{Dt} = \\boldsymbol{\\sigma} : \\nabla\\boldsymbol{u} - \\nabla \\cdot \\boldsymbol{q} $$\n代入 $\\boldsymbol{\\sigma} : \\nabla\\boldsymbol{u}$ 的表达式：\n$$ \\rho \\frac{De}{Dt} = -p(\\nabla \\cdot \\boldsymbol{u}) + \\Phi - \\nabla \\cdot \\boldsymbol{q} $$\n这是内能方程的微分形式。它表明内能由于压力-膨胀功、粘性耗散和热传导而变化。请注意，压力-膨胀项 $-p(\\nabla \\cdot \\boldsymbol{u})$ 和粘性耗散项 $\\Phi$ 在动能和内能方程中以相反的符号出现（在考虑功的分解 $\\boldsymbol{u} \\cdot (\\nabla \\cdot \\boldsymbol{\\sigma})$ 之后），这突显了动能和内能库之间的能量转移。\n\n#### 3. 基于温度的非守恒格式\n\n对于理想气体，$e = c_v T$。内能方程变为：\n$$ \\rho c_v \\frac{DT}{Dt} = -p(\\nabla \\cdot \\boldsymbol{u}) + \\Phi - \\nabla \\cdot \\boldsymbol{q} $$\n一个常见的简化，尤其是在最初为不可压缩流开发的程序中，是忽略压力-膨胀项 $-p(\\nabla \\cdot \\boldsymbol{u})$。这产生了一个基于温度的非守恒格式：\n$$ \\rho c_v \\frac{DT}{Dt} \\approx \\Phi - \\nabla \\cdot \\boldsymbol{q} \\quad (\\text{非守恒格式}) $$\n对于不可压缩流，该近似是有效的，因为其连续性方程为 $\\nabla \\cdot \\boldsymbol{u} = 0$，使得压力-膨胀项恒为零。然而，在可压缩的高速流中，膨胀 $\\nabla \\cdot \\boldsymbol{u}$ 可能很大（例如，在冲击波或强膨胀扇中），且压力 $p$ 也很显著。在这种情况下，$-p(\\nabla \\cdot \\boldsymbol{u})$ 代表了动能和内能之间的大量能量交换，忽略它会导致违反总能量守恒。\n\n#### 4. 一维周期性域中的全局平衡\n\n我们考虑一个具有周期性边界条件的一维域 $x \\in [0, L)$。对于任何连续可微的周期函数 $f(x)$，其导数在一个周期上的积分为零：$\\int_0^L \\frac{\\partial f}{\\partial x} dx = f(L) - f(0) = 0$。因此，任何散度项在周期性域上的积分都消失。\n\n总积分内能、动能和总能量的变化率可以通过将其各自的微分方程在域 $[0, L)$ 上积分得到。构造解是稳态的，因此我们正在评估空间通量项的平衡。\n\n**动能速率 ($I_{\\mathrm{kin}}$):**\n$$ \\frac{d}{dt}\\int_0^L \\frac{1}{2}\\rho u^2 dx = \\int_0^L \\left( p \\frac{\\partial u}{\\partial x} - \\Phi \\right) dx = I_{p\\,\\mathrm{div}} - I_{\\Phi} $$\n这是通过积分 $\\rho D(u^2/2)/Dt$ 并利用周期性消除散度项得到的。\n\n**内能速率 ($I_{\\mathrm{int,exact}}$):**\n$$ \\frac{d}{dt}\\int_0^L \\rho e \\, dx = \\int_0^L \\left(-p \\frac{\\partial u}{\\partial x} + \\Phi - \\frac{\\partial q_x}{\\partial x}\\right) dx $$\n由于 $q_x = -k \\frac{\\partial T}{\\partial x}$ 是周期性的，$\\int_0^L \\frac{\\partial q_x}{\\partial x} dx = 0$。因此：\n$$ \\frac{d}{dt}\\int_0^L \\rho e \\, dx = \\int_0^L \\left(-p \\frac{\\partial u}{\\partial x} + \\Phi \\right) dx = -I_{p\\,\\mathrm{div}} + I_{\\Phi} $$\n\n**守恒总能量速率 ($I_{\\mathrm{tot,cons}}$):**\n总能量的变化率是动能和内能速率的总和。\n$$ I_{\\mathrm{tot,cons}} = \\frac{d}{dt}\\int_0^L \\rho e_t \\, dx = I_{\\mathrm{kin}} + I_{\\mathrm{int,exact}} = (I_{p\\,\\mathrm{div}} - I_{\\Phi}) + (-I_{p\\,\\mathrm{div}} + I_{\\Phi}) = 0 $$\n从解析上看，守恒格式保证了周期性域中的总能量是守恒的。$I_{p\\,\\mathrm{div}}$ 和 $I_{\\Phi}$ 的数值计算值将导致一个接近于零的残差。\n\n**非守恒总能量速率 ($I_{\\mathrm{tot,temp}}$):**\n使用有缺陷的基于温度的内能速率，$I_{\\mathrm{int,temp}} = \\int_0^L \\Phi \\, dx = I_{\\Phi}$，总能量速率变为：\n$$ I_{\\mathrm{tot,temp}} = I_{\\mathrm{kin}} + I_{\\mathrm{int,temp}} = (I_{p\\,\\mathrm{div}} - I_{\\Phi}) + I_{\\Phi} = I_{p\\,\\mathrm{div}} $$\n该格式的残差为 $|I_{p\\,\\mathrm{div}}|$。只要域上存在净压力-膨胀功，这个值就非零，这在给定的可压缩流情况下是预期的。\n\n数值任务是计算这些积分量并验证这些理论预测。", "answer": "[[True,False,1.1641532182693481e-10,111361.3547708573],[True,False,0.0,0.016666795415494294],[True,False,0.0,59781.00004944803],[True,False,2.3283064365386963e-10,23907.82823055968]]", "id": "3335363"}]}