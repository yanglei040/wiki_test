{"hands_on_practices": [{"introduction": "在计算流体力学中，为了精确捕捉粘性效应并最大限度地减少数值耗散，空间导数的高阶离散格式至关重要。本练习将指导您完成一个基础而核心的任务：利用泰勒级数展开，在一个均匀网格上为二阶导数 $f''(x)$ 构建一个四阶精度的中心差分格式。掌握这一方法是设计和分析数值格式的基石。[@problem_id:3370259]", "problem": "在计算流体动力学（CFD, Computational Fluid Dynamics）中，空间导数的高阶精度离散对于以最小的数值耗散解析粘性效应至关重要。考虑一个光滑标量场 $f(x)$，例如，它代表一维层流中的一个速度分量。在Navier-Stokes方程粘性项的离散化中，需要逐点二阶导数 $f''(x)$。假设 $f$ 在对称位置 $x-2h$、$x-h$、$x$、$x+h$ 和 $x+2h$ 处被采样，其中 $h>0$ 是均匀的网格间距。\n\n从 $f(x\\pm h)$ 和 $f(x\\pm 2h)$ 关于 $x$ 的泰勒级数展开出发，构造在模板点 $\\{x-2h, x-h, x, x+h, x+2h\\}$ 上采样值的对称线性组合，以得到 $f''(x)$ 的一个四阶精度近似。然后，通过将泰勒级数展开到比所达精度高一阶，计算主截断误差项，并用 $f^{(6)}(x)$ 和 $h$ 明确表示。\n\n您的最终答案必须包含：\n1. 一个单一的闭式解析表达式，给出使用给定模板点计算 $f''(x)$ 的四阶精度有限差分公式。\n2. 一个单一的闭式解析表达式，给出与 $f^{(6)}(x)$ 成正比的主截断误差项。\n\n请提供这两个表达式。不需要进行数值舍入，也不需要单位。", "solution": "用户希望使用一个五点对称模板来推导二阶导数 $f''(x)$ 的四阶精度有限差分近似。\n\n### 第一步：提取已知条件\n- 待微分的函数是一个光滑标量场 $f(x)$。\n- 待近似的导数是二阶导数 $f''(x)$。\n- 点模板是对称的：$\\{x-2h, x-h, x, x+h, x+2h\\}$。\n- $h>0$ 是均匀的网格间距。\n- 所用方法是基于泰勒级数展开，构造模板点上函数值的线性组合。\n- 对 $f''(x)$ 近似的所需精度阶数为四阶，即截断误差为 $O(h^4)$。\n- 最终结果必须包括有限差分公式及其主截断误差项。\n\n### 第二步：使用提取的已知条件进行验证\n该问题具有科学依据，是数值分析领域的一个标准和基本任务，尤其是在计算流体动力学中的应用。该问题是适定的，提供了所有必要信息（模板、所需导数、精度阶数）来唯一确定线性组合的系数和主误差项。语言客观而精确。该问题没有任何科学或逻辑上的缺陷、矛盾或歧义。\n\n### 第三步：结论与行动\n该问题有效。将提供完整解答。\n\n### 有限差分公式和截断误差的推导\n\n我们寻求一个形如下式的 $f''(x)$ 近似：\n$$\nf''(x) \\approx \\frac{c_{-2}f(x-2h) + c_{-1}f(x-h) + c_0f(x) + c_1f(x+h) + c_2f(x+2h)}{k}\n$$\n对于对称模板上的对称近似，我们期望系数也是对称的，即 $c_{-i} = c_i$。此外，对于近似二阶导数，缩放因子 $k$ 通常是 $h^2$。我们将系数定义为 $c_0$、$c_1=c_{-1}$ 和 $c_2=c_{-2}$。该近似，记为 $D_h^2 f(x)$，是：\n$$\nD_h^2 f(x) = \\frac{c_2 f(x-2h) + c_1 f(x-h) + c_0 f(x) + c_1 f(x+h) + c_2 f(x+2h)}{h^2}\n$$\n这可以重写为：\n$$\nD_h^2 f(x) = \\frac{c_2[f(x+2h) + f(x-2h)] + c_1[f(x+h) + f(x-h)] + c_0 f(x)}{h^2}\n$$\n为了确定系数 $c_0$、$c_1$ 和 $c_2$，我们使用 $f(x \\pm h)$ 和 $f(x \\pm 2h)$ 在点 $x$ 附近的泰勒级数展开。由于最终的误差项涉及 $f^{(6)}(x)$，我们必须将展开式进行到足够高的阶数以捕捉此项。$f(x+kh)$ 和 $f(x-kh)$ 的组合可以方便地消去所有奇数阶导数项。\n\n这些和的展开式为：\n$$\nf(x+h) + f(x-h) = 2 \\sum_{n=0}^{\\infty} \\frac{h^{2n}}{(2n)!} f^{(2n)}(x) = 2f(x) + h^2 f''(x) + \\frac{h^4}{12}f^{(4)}(x) + \\frac{h^6}{360}f^{(6)}(x) + O(h^8)\n$$\n$$\nf(x+2h) + f(x-2h) = 2 \\sum_{n=0}^{\\infty} \\frac{(2h)^{2n}}{(2n)!} f^{(2n)}(x) = 2f(x) + 4h^2 f''(x) + \\frac{16h^4}{12}f^{(4)}(x) + \\frac{64h^6}{360}f^{(6)}(x) + O(h^8)\n$$\n简化第二个展开式中的分数：\n$$\nf(x+2h) + f(x-2h) = 2f(x) + 4h^2 f''(x) + \\frac{4h^4}{3}f^{(4)}(x) + \\frac{8h^6}{45}f^{(6)}(x) + O(h^8)\n$$\n现在，将这些展开式代入 $D_h^2 f(x)$ 的表达式中：\n\\begin{align*}\nh^2 D_h^2 f(x) = c_2\\left[2f(x) + 4h^2 f''(x) + \\frac{4}{3}h^4f^{(4)}(x) + \\frac{8}{45}h^6f^{(6)}(x) + \\dots\\right] \\\\\n+ c_1\\left[2f(x) + h^2 f''(x) + \\frac{1}{12}h^4f^{(4)}(x) + \\frac{1}{360}h^6f^{(6)}(x) + \\dots\\right] \\\\\n+ c_0 f(x)\n\\end{align*}\n按 $f(x)$ 的导数对各项进行分组：\n\\begin{align*}\nh^2 D_h^2 f(x) = f(x) [2c_2 + 2c_1 + c_0] \\\\\n+ f''(x) h^2 [4c_2 + c_1] \\\\\n+ f^{(4)}(x) h^4 \\left[\\frac{4}{3}c_2 + \\frac{1}{12}c_1\\right] \\\\\n+ f^{(6)}(x) h^6 \\left[\\frac{8}{45}c_2 + \\frac{1}{360}c_1\\right] \\\\\n+ O(h^8)\n\\end{align*}\n两边除以 $h^2$，我们得到：\n$$\nD_h^2 f(x) = \\frac{f(x)}{h^2}[2c_2+2c_1+c_0] + f''(x)[4c_2+c_1] + f^{(4)}(x)h^2\\left[\\frac{4}{3}c_2+\\frac{1}{12}c_1\\right] + f^{(6)}(x)h^4\\left[\\frac{8}{45}c_2+\\frac{1}{360}c_1\\right] + O(h^6)\n$$\n为了使 $D_h^2 f(x)$ 成为 $f''(x)$ 的四阶精度近似，我们需要满足以下条件：\n$1$. $f(x)$ 的系数必须为 $0$：$2c_2 + 2c_1 + c_0 = 0$。\n$2$. $f''(x)$ 的系数必须为 $1$：$4c_2 + c_1 = 1$。\n$3$. $h^2$ 项（包含 $f^{(4)}(x)$）的系数必须为 $0$，以达到至少四阶的精度：$\\frac{4}{3}c_2 + \\frac{1}{12}c_1 = 0 \\implies 16c_2 + c_1 = 0$。\n\n现在我们得到了一个关于三个未知系数的三元线性方程组：\n\\begin{cases}\n2c_2 + 2c_1 + c_0 = 0 \\\\\n4c_2 + c_1 = 1 \\\\\n16c_2 + c_1 = 0\n\\end{cases}\n由第三个方程，我们有 $c_1 = -16c_2$。\n将其代入第二个方程：$4c_2 + (-16c_2) = 1 \\implies -12c_2 = 1 \\implies c_2 = -\\frac{1}{12}$。\n现在我们可以求出 $c_1$：$c_1 = -16\\left(-\\frac{1}{12}\\right) = \\frac{16}{12} = \\frac{4}{3}$。\n最后，使用第一个方程求出 $c_0$：$c_0 = -2c_2 - 2c_1 = -2\\left(-\\frac{1}{12}\\right) - 2\\left(\\frac{4}{3}\\right) = \\frac{1}{6} - \\frac{8}{3} = \\frac{1}{6} - \\frac{16}{6} = -\\frac{15}{6} = -\\frac{5}{2}$。\n\n这些系数是 $c_2 = -\\frac{1}{12}$，$c_1 = \\frac{4}{3}$，和 $c_0 = -\\frac{5}{2}$。\n$f''(x)$ 的有限差分公式是：\n$$\nf''(x) \\approx \\frac{-\\frac{1}{12}f(x-2h) + \\frac{4}{3}f(x-h) - \\frac{5}{2}f(x) + \\frac{4}{3}f(x+h) - \\frac{1}{12}f(x+2h)}{h^2}\n$$\n为了消除分子中的分数，我们将分子和分母同乘以 $12$：\n$$\nf''(x) \\approx \\frac{-f(x-2h) + 16f(x-h) - 30f(x) + 16f(x+h) - f(x+2h)}{12h^2}\n$$\n\n截断误差 $T$ 由 $T = D_h^2 f(x) - f''(x)$ 给出。利用推导出的系数，$f(x)$、$f''(x)$ 和 $f^{(4)}(x)$ 的相关项被正确设置。主误差项是展开式中第一个非零项，即包含 $f^{(6)}(x)$ 的项：\n$$\nT = f^{(6)}(x)h^4\\left[\\frac{8}{45}c_2 + \\frac{1}{360}c_1\\right] + O(h^6)\n$$\n代入 $c_1$ 和 $c_2$ 的值：\n$$\nT = f^{(6)}(x)h^4\\left[\\frac{8}{45}\\left(-\\frac{1}{12}\\right) + \\frac{1}{360}\\left(\\frac{4}{3}\\right)\\right] + O(h^6)\n$$\n$$\nT = f^{(6)}(x)h^4\\left[-\\frac{8}{540} + \\frac{4}{1080}\\right] = f^{(6)}(x)h^4\\left[-\\frac{16}{1080} + \\frac{4}{1080}\\right] = f^{(6)}(x)h^4\\left(-\\frac{12}{1080}\\right)\n$$\n化简分数 $-\\frac{12}{1080} = -\\frac{1}{90}$。\n因此，主截断误差项是：\n$$\nT = -\\frac{h^4}{90}f^{(6)}(x)\n$$\n该近似确实是四阶精度的，因为误差为 $O(h^4)$。\n\n所需的两个表达式是：\n$1$. $f''(x)$ 的有限差分公式：$\\frac{-f(x-2h) + 16f(x-h) - 30f(x) + 16f(x+h) - f(x+2h)}{12h^2}$\n$2$. 主截断误差项：$-\\frac{h^4}{90}f^{(6)}(x)$", "answer": "$$\\boxed{\\begin{pmatrix} \\frac{-f(x-2h) + 16f(x-h) - 30f(x) + 16f(x+h) - f(x+2h)}{12h^2}  -\\frac{h^4}{90}f^{(6)}(x) \\end{pmatrix}}$$", "id": "3370259"}, {"introduction": "实际的CFD应用常常需要非均匀网格来高效地解析边界层或复杂几何区域内的流动细节。本练习将理论知识推向实际应用，探讨如何在非均匀网格点上推导一阶导数 $u'(x_i)$ 的差分格式。通过这个实践，您将学会如何调整泰勒级数分析方法以适应变化的网格间距，并理解局部截断误差如何依赖于局部的网格尺寸。[@problem_id:3370198]", "problem": "考虑一个光滑标量场 $u(x)$ 和一个非均匀三点模板 $\\{x_{i-1},x_i,x_{i+1}\\}$，其中 $h_- = x_i - x_{i-1}  0$ 且 $h_+ = x_{i+1} - x_i  0$。您将通过匹配关于 $x_i$ 的局部 Taylor 级数展开，推导出一阶导数 $u'(x_i)$ 的三点线性有限差分近似，然后分析其主截断误差。随后，您将把得到的近似应用于壁面法向坐标 $y$ 上的壁面加密网格，并根据局部网格间距 $h(y)$ 预测 $\\partial_y u$ 的误差缩放规律。所有三角函数必须使用弧度制。\n\n推导任务：\n- 从 $u(x_{i-1})$ 和 $u(x_{i+1})$ 关于 $x_i$ 的 Taylor 级数展开出发，并假设函数至少在三阶导数上是光滑的，推导系数 $a$、$b$ 和 $c$，使得\n$u'(x_i) \\approx a\\,u(x_{i-1}) + b\\,u(x_i) + c\\,u(x_{i+1})$\n匹配 Taylor 级数至 $O(h^3)$ 阶项，即该近似对于 $x$ 的常数、线性和二次多项式是精确的。根据此推导，确定主阶截断误差项，并将其表示为一个乘以 $u^{(3)}(x_i)$ 的系数。\n\n应用于壁面加密网格：\n- 考虑壁面法向坐标 $y$ 的一个单调网格映射，形式为\n$$y(\\xi) = L\\,\\frac{e^{\\beta \\xi} - 1}{e^{\\beta} - 1},$$\n其中 $\\xi \\in [0,1]$ 是一个均匀的计算坐标，节点值为 $\\xi_j = j/(N-1)$（$j=0,1,\\dots,N-1$），区域大小 $L0$，拉伸参数 $\\beta0$。对于每个内部节点 $y_i = y(\\xi_i)$，定义 $h_- = y_i - y_{i-1}$ 和 $h_+ = y_{i+1} - y_i$。使用推导出的截断误差，预测近似 $\\partial_y u(y_i)$ 的点误差如何随局部间距缩放。用 $h_-$、$h_+$ 和一个等效局部间距 $h_{\\text{loc}}(y_i)$ 来表达您的预测，您必须根据您的 Taylor 分析，以合理的方式通过 $h_-$ 和 $h_+$ 定义 $h_{\\text{loc}}(y_i)$。\n\n实现要求：\n- 实现一个程序，该程序：\n  1. 对指定的 $(h_-,h_+)$ 对，计算并返回系数 $a$、$b$ 和 $c$。\n  2. 验证您推导出的 $u^{(3)}$ 的主阶截断误差系数，并对于一个选定的光滑函数 $u(y)$，在加密网格上评估观测到的局部误差与预测的主项之比。\n  3. 在加密网格上执行双网格经验收敛性研究，以估计有限差分近似 $\\partial_y u$ 的观测精度阶 $p$。\n\n测试套件和使用的参数：\n- 对所有加密网格使用 $L=1$，并以弧度指定角度。\n- 测试用例 1（非对称模板系数）：$h_- = 0.07$, $h_+ = 0.13$。输出列表 `[a,b,c]`。\n- 测试用例 2（对称模板系数）：$h_- = 0.10$, $h_+ = 0.10$。输出列表 `[a,b,c]`。\n- 测试用例 3（加密网格上的局部误差与主项之比）：选择 $u(y) = \\operatorname{Re}\\{e^{\\lambda y}\\}$，其中 $\\lambda = -3 + \\mathrm{i}\\pi$，因此 $u'(y) = \\operatorname{Re}\\{\\lambda e^{\\lambda y}\\}$ 且 $u^{(3)}(y) = \\operatorname{Re}\\{\\lambda^3 e^{\\lambda y}\\}$。使用 $N = 161$, $\\beta = 4$，并在内部索引 $i=50$ 处求值。使用来自局部 $h_-$ 和 $h_+$ 的系数计算 $u'(y_i)$ 的有限差分近似，然后计算比值\n$$r = \\frac{\\left(a\\,u(y_{i-1}) + b\\,u(y_i) + c\\,u(y_{i+1})\\right) - u'(y_i)}{\\left(\\frac{h_- h_+}{6}\\right)\\,u^{(3)}(y_i)}.$$\n输出浮点数 $r$。\n- 测试用例 4（加密网格上的经验阶）：选择 $u(y) = \\operatorname{Im}\\{e^{\\lambda y}\\}$，其中 $\\lambda = -2 + 3\\mathrm{i}$，因此 $u'(y) = \\operatorname{Im}\\{\\lambda e^{\\lambda y}\\}$。使用 $\\beta = 3$ 和两个网格，$N_1 = 81$ 和 $N_2 = 161$。对于每个网格，计算最大内部点绝对误差\n$$E_N = \\max_{i=1,\\dots,N-2} \\left|a_i\\,u(y_{i-1}) + b_i\\,u(y_i) + c_i\\,u(y_{i+1}) - u'(y_i)\\right|,$$\n其中 $a_i$、$b_i$ 和 $c_i$ 是根据每个内部点的局部 $(h_-^{(i)},h_+^{(i)})$ 计算的。令 $\\Delta \\xi_N = 1/(N-1)$ 并估计经验阶\n$$p = \\frac{\\log\\left(E_{N_2}/E_{N_1}\\right)}{\\log\\left(\\Delta \\xi_{N_2}/\\Delta \\xi_{N_1}\\right)}.$$\n输出浮点数 $p$。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含按测试用例顺序列出的逗号分隔列表，并用方括号括起：`[[a_1,b_1,c_1],[a_2,b_2,c_2],r,p]`。不应打印任何其他文本。", "solution": "用户提供的问题是数值分析领域中一个适定性良好的任务，具体涉及有限差分格式的推导与应用。该问题具有科学依据，内部逻辑一致，并包含了完整求解所需的所有信息。\n\n### 第一部分：有限差分公式及截断误差的推导\n\n我们的目标是，对于非均匀网格上一点 $x_i$，求取其一阶导数 $u'(x_i)$ 的有限差分近似的系数 $a$、$b$ 和 $c$：\n$$u'(x_i) \\approx a\\,u(x_{i-1}) + b\\,u(x_i) + c\\,u(x_{i+1})$$\n模板点为 $\\{x_{i-1}, x_i, x_{i+1}\\}$，网格间距定义为 $h_- = x_i - x_{i-1}  0$ 和 $h_+ = x_{i+1} - x_i  0$。通过匹配 Taylor 级数展开来确定这些系数，以确保该公式对最高为2次的多项式是精确的。\n\n我们从 $u(x_{i-1})$ 和 $u(x_{i+1})$ 在点 $x_i$ 附近的 Taylor 级数展开开始：\n$$u(x_{i-1}) = u(x_i - h_-) = u(x_i) - h_- u'(x_i) + \\frac{h_-^2}{2} u''(x_i) - \\frac{h_-^3}{6} u^{(3)}(x_i) + O(h_-^4)$$\n$$u(x_{i+1}) = u(x_i + h_+) = u(x_i) + h_+ u'(x_i) + \\frac{h_+^2}{2} u''(x_i) + \\frac{h_+^3}{6} u^{(3)}(x_i) + O(h_+^4)$$\n\n将这些展开式代入近似式的右侧 (RHS) 可得：\n$$\\text{RHS} = a\\left( u_i - h_- u'_i + \\frac{h_-^2}{2} u''_i - \\dots \\right) + b u_i + c\\left( u_i + h_+ u'_i + \\frac{h_+^2}{2} u''_i + \\dots \\right)$$\n其中 $u_i = u(x_i)$，$u'_i = u'(x_i)$ 等。按 $u$ 在 $x_i$ 处的各阶导数整理各项：\n$$\\text{RHS} = u_i(a+b+c) + u'_i(-ah_- + ch_+) + u''_i\\left(a\\frac{h_-^2}{2} + c\\frac{h_+^2}{2}\\right) + u^{(3)}_i\\left(-a\\frac{h_-^3}{6} + c\\frac{h_+^3}{6}\\right) + \\dots$$\n\n为使该格式对常数 ($u(x)=k$)、线性函数 ($u(x)=mx+k$) 和二次函数 ($u(x)=qx^2+mx+k$) 精确，RHS 中 $u_i$、$u'_i$ 和 $u''_i$ 的系数必须与 LHS（即 $u'_i$）的系数相匹配。这导出了关于 $a$、$b$ 和 $c$ 的以下线性方程组：\n1. $u_i$ 的系数：$a + b + c = 0$\n2. $u'_i$ 的系数：$-ah_- + ch_+ = 1$\n3. $u''_i$ 的系数：$a h_-^2 + c h_+^2 = 0$\n\n由方程 (3)，我们将 $a$ 表示为 $c$ 的函数：\n$a = -c \\frac{h_+^2}{h_-^2}$\n\n将其代入方程 (2)：\n$- \\left(-c \\frac{h_+^2}{h_-^2}\\right) h_- + c h_+ = 1 \\implies c \\frac{h_+^2}{h_-} + c h_+ = 1$\n$c \\left( \\frac{h_+^2 + h_- h_+}{h_-} \\right) = 1 \\implies c \\frac{h_+(h_+ + h_-)}{h_-} = 1$\n解得 $c$ 为：\n$$c = \\frac{h_-}{h_+(h_+ + h_-)}$$\n\n现在，我们求解 $a$：\n$$a = - \\left( \\frac{h_-}{h_+(h_+ + h_-)} \\right) \\frac{h_+^2}{h_-^2} = -\\frac{h_+}{h_-(h_+ + h_-)}$$\n\n最后，由方程 (1)，我们求解 $b$：\n$$b = -a - c = \\frac{h_+}{h_-(h_+ + h_-)} - \\frac{h_-}{h_+(h_+ + h_-)} = \\frac{h_+^2 - h_-^2}{h_- h_+(h_+ + h_-)} = \\frac{(h_+ - h_-)(h_+ + h_-)}{h_- h_+(h_+ + h_-)}$$\n$$b = \\frac{h_+ - h_-}{h_- h_+}$$\n\n截断误差 $\\tau$ 是有限差分算子与真实微分算子之差。它由 Taylor 展开中未被抵消的第一个非零项给出。此项为包含 $u^{(3)}_i$ 的项：\n$$\\tau = \\left( -a \\frac{h_-^3}{6} + c \\frac{h_+^3}{6} \\right) u^{(3)}_i + O(h^3)$$\n其中 $h$ 是一个特征网格间距，例如 $h = \\max(h_-, h_+)$。代入 $a$ 和 $c$ 的表达式：\n$$\\tau = \\left[ - \\left(-\\frac{h_+}{h_-(h_+ + h_-)}\\right) \\frac{h_-^3}{6} + \\left(\\frac{h_-}{h_+(h_+ + h_-)}\\right) \\frac{h_+^3}{6} \\right] u^{(3)}_i + O(h^3)$$\n$$\\tau = \\left[ \\frac{h_+ h_-^2}{6(h_+ + h_-)} + \\frac{h_- h_+^2}{6(h_+ + h_-)} \\right] u^{(3)}_i + O(h^3)$$\n$$\\tau = \\frac{h_-h_+(h_- + h_+)}{6(h_+ + h_-)} u^{(3)}_i + O(h^3) = \\frac{h_- h_+}{6} u^{(3)}_i + O(h^3)$$\n主阶截断误差为 $\\frac{h_- h_+}{6} u^{(3)}(x_i)$。该格式是二阶精确的，因为误差项与乘积 $h_- h_+$ 成正比，其缩放尺度为 $O(h^2)$。\n\n### 第二部分：应用于壁面加密网格\n\n该问题考虑了一个由从均匀计算坐标 $\\xi \\in [0,1]$ 到物理坐标的映射 $y(\\xi) = L(e^{\\beta \\xi} - 1)/(e^{\\beta} - 1)$ 所定义的加密网格。对于小的计算网格间距 $\\Delta\\xi$，物理间距为：\n$$h_- = y_i - y_{i-1} \\approx y'(\\xi_i) \\Delta\\xi$$\n$$h_+ = y_{i+1} - y_i \\approx y'(\\xi_i) \\Delta\\xi$$\n其中 $y'(\\xi) = dy/d\\xi$。点 $y_i$ 处的主截断误差为 $T_i = \\frac{h_- h_+}{6} u^{(3)}(y_i)$。\n代入 $h_-$ 和 $h_+$ 的近似值：\n$$T_i \\approx \\frac{(y'(\\xi_i)\\Delta\\xi)^2}{6} u^{(3)}(y_i)$$\n问题要求预测误差如何随局部间距 $h_{\\text{loc}}(y_i)$ 缩放。局部物理间距的一个自然定义是算术平均值：\n$$h_{\\text{loc}}(y_i) = \\frac{h_- + h_+}{2}$$\n通过对映射函数进行 Taylor 展开，我们得到 $h_{\\text{loc}}(y_i) = y'(\\xi_i)\\Delta\\xi + O(\\Delta\\xi^3)$。\n由于 $h_-h_+ \\approx h_{\\text{loc}}^2$，截断误差的大小为：\n$$|T_i| \\approx \\frac{h_{\\text{loc}}(y_i)^2}{6} |u^{(3)}(y_i)|$$\n这表明点误差随局部网格间距 $h_{\\text{loc}}$ 呈二次方缩放。因此，该有限差分格式在局部网格间距上是二阶精确的。此外，由于 $h_{\\text{loc}}$ 与 $\\Delta\\xi$ 成正比，整个网格上的最大误差预计将按 $O(\\Delta\\xi^2)$ 缩放，这意味着相对于计算网格间距的经验收敛阶为 $p=2$。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the multi-part finite difference problem.\n    \"\"\"\n\n    def get_coeffs(h_minus, h_plus):\n        \"\"\"\n        Calculates the coefficients a, b, and c for the 3-point\n        non-uniform finite difference approximation of the first derivative.\n        \n        Args:\n            h_minus (float): Grid spacing x_i - x_{i-1}.\n            h_plus (float): Grid spacing x_{i+1} - x_i.\n            \n        Returns:\n            list: A list containing the coefficients [a, b, c].\n        \"\"\"\n        h_sum = h_minus + h_plus\n        a = -h_plus / (h_minus * h_sum)\n        b = (h_plus - h_minus) / (h_minus * h_plus)\n        c = h_minus / (h_plus * h_sum)\n        return [a, b, c]\n\n    # Test Case 1: Asymmetric stencil coefficients\n    h_minus1, h_plus1 = 0.07, 0.13\n    coeffs1 = get_coeffs(h_minus1, h_plus1)\n\n    # Test Case 2: Symmetric stencil coefficients\n    h_minus2, h_plus2 = 0.10, 0.10\n    coeffs2 = get_coeffs(h_minus2, h_plus2)\n\n    # Test Case 3: Local error to leading-term ratio\n    L3, N3, beta3, i3 = 1.0, 161, 4.0, 50\n    lam3 = -3.0 + 1j * np.pi\n\n    def y_map(xi, L, beta):\n        return L * (np.exp(beta * xi) - 1.0) / (np.exp(beta) - 1.0)\n\n    delta_xi3 = 1.0 / (N3 - 1)\n    xi_coords3 = np.array([i3 - 1, i3, i3 + 1]) * delta_xi3\n    y_coords3 = y_map(xi_coords3, L3, beta3)\n    y_im1, y_i, y_ip1 = y_coords3[0], y_coords3[1], y_coords3[2]\n\n    h_minus3 = y_i - y_im1\n    h_plus3 = y_ip1 - y_i\n    coeffs3 = get_coeffs(h_minus3, h_plus3)\n    a3, b3, c3 = coeffs3[0], coeffs3[1], coeffs3[2]\n\n    u_vals = np.real(np.exp(lam3 * np.array([y_im1, y_i, y_ip1])))\n    \n    u_num_prime = a3 * u_vals[0] + b3 * u_vals[1] + c3 * u_vals[2]\n    u_exact_prime = np.real(lam3 * np.exp(lam3 * y_i))\n    u_exact_ppp = np.real(lam3**3 * np.exp(lam3 * y_i))\n\n    observed_error = u_num_prime - u_exact_prime\n    predicted_leading_error = (h_minus3 * h_plus3 / 6.0) * u_exact_ppp\n    \n    r = observed_error / predicted_leading_error\n\n    # Test Case 4: Empirical order of accuracy\n    def compute_max_error(N, beta, L, lam):\n        delta_xi = 1.0 / (N - 1)\n        xi_grid = np.linspace(0, 1, N)\n        y_grid = y_map(xi_grid, L, beta)\n        \n        errors = []\n        for i in range(1, N - 1):\n            y_im1, y_i, y_ip1 = y_grid[i - 1], y_grid[i], y_grid[i + 1]\n            h_minus = y_i - y_im1\n            h_plus = y_ip1 - y_i\n\n            a, b, c = get_coeffs(h_minus, h_plus)\n            \n            u_vals = np.imag(np.exp(lam * np.array([y_im1, y_i, y_ip1])))\n            \n            u_num_prime = a * u_vals[0] + b * u_vals[1] + c * u_vals[2]\n            u_exact_prime = np.imag(lam * np.exp(lam * y_i))\n            \n            errors.append(np.abs(u_num_prime - u_exact_prime))\n        \n        return np.max(errors)\n\n    L4, beta4 = 1.0, 3.0\n    N1, N2 = 81, 161\n    lam4 = -2.0 + 3.0j\n\n    error_N1 = compute_max_error(N1, beta4, L4, lam4)\n    error_N2 = compute_max_error(N2, beta4, L4, lam4)\n\n    delta_xi_N1 = 1.0 / (N1 - 1)\n    delta_xi_N2 = 1.0 / (N2 - 1)\n    \n    p = np.log(error_N2 / error_N1) / np.log(delta_xi_N2 / delta_xi_N1)\n\n    # Assemble final results and print in the required format\n    results = [coeffs1, coeffs2, r, p]\n    \n    # Python's default str() for a list includes brackets and spaces,\n    # which is needed for the requested output format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```", "id": "3370198"}, {"introduction": "理论上的高阶精度依赖于泰勒级数中各项的精确抵消，但这在有限精度的计算机算术中可能无法完美实现。本练习将深入探讨一个微妙但关键的实际问题：预计算的差分系数中的浮点舍入误差如何降低格式的标称精度。通过分析一个高阶格式在系数被舍入后的表现，您将量化这种精度退化现象，从而更深刻地理解理论设计与计算实现之间的差距。[@problem_id:3370218]", "problem": "在计算流体动力学（CFD）中，光滑通量的空间导数通常在均匀网格上使用通过泰勒级数展开设计的有限差分进行近似。考虑一个间距为 $h$ 的一维均匀网格，以及反对称的 $7$ 点中心差分算子\n$$\nD_h f(x_i) \\equiv \\frac{1}{h} \\sum_{k=-3}^{3} a_k f(x_i + k h),\n$$\n其中 $a_0 = 0$ 且对于 $k = 1, 2, 3$ 有 $a_{-k} = - a_k$。标称设计目标是实现对 $f'(x_i)$ 的六阶精度近似，这通过施加由 $f(x_i + k h)$ 关于 $x_i$ 的泰勒展开产生的矩条件来达到。\n\n从泰勒级数展开和反对称约束出发，推导六阶精度所需的矩条件，求解精确的正侧系数 $a_1, a_2, a_3$，然后分析当预计算的正侧系数以四位有效数字存储为 $a_1^{\\mathrm{fp}} = 0.7500$, $a_2^{\\mathrm{fp}} = -0.1500$, 和 $a_3^{\\mathrm{fp}} = 0.01667$ 时（同时保持 $a_{-k}^{\\mathrm{fp}} = - a_k^{\\mathrm{fp}}$），浮点（FP）舍入带来的影响。\n\n使用这些经过浮点舍入的系数，计算由舍入引入的首项伪截断误差中乘以 $h^2 f^{(3)}(x_i)$ 项的系数。也就是说，确定标量 $C$，使得由舍入引起的主导截断误差项的形式为 $C\\, h^2 f^{(3)}(x_i) + \\text{更高阶项}$。将最终的标量 $C$ 表示为标准科学记数法下的纯数。如果需要进行数值舍入，将您的答案舍入到四位有效数字。", "solution": "问题的验证过程如下：\n1.  **提取已知条件**：\n    -   网格：间距为 $h$ 的一维均匀网格。\n    -   算子：反对称的 $7$ 点中心差分算子定义为 $D_h f(x_i) \\equiv \\frac{1}{h} \\sum_{k=-3}^{3} a_k f(x_i + k h)$。\n    -   反对称约束：$a_0 = 0$ 且对于 $k=1, 2, 3$ 有 $a_{-k} = -a_k$。\n    -   设计目标：对一阶导数 $f'(x_i)$ 的六阶精度近似。\n    -   浮点（FP）系数：$a_1^{\\mathrm{fp}} = 0.7500$, $a_2^{\\mathrm{fp}} = -0.1500$, $a_3^{\\mathrm{fp}} = 0.01667$。反对称性 $a_{-k}^{\\mathrm{fp}} = -a_k^{\\mathrm{fp}}$ 得以保持。\n    -   任务：确定在使用浮点舍入系数时，截断误差中 $C\\, h^2 f^{(3)}(x_i)$ 项的标量系数 $C$。\n\n2.  **使用提取的已知条件进行验证**：\n    -   该问题在科学上根植于数值分析领域，特别是在计算流体动力学中有限差分方法的研究。\n    -   问题是适定的，提供了足够的信息和明确的约束来确定系数 $C$ 的唯一值。\n    -   语言客观且数学上精确。\n    -   没有科学或事实上的不健全之处，没有缺失信息，没有矛盾，且设置是现实的。舍入误差是计算中的一个实际问题。\n\n3.  **结论与行动**：问题有效。将提供完整解答。\n\n该方法的核心是通过将每一项 $f(x_i + k h)$ 在点 $x_i$ 附近展开成泰勒级数来分析算子 $D_h f(x_i)$ 的截断误差。泰勒级数展开为：\n$$\nf(x_i + kh) = \\sum_{n=0}^{\\infty} \\frac{(kh)^n}{n!} f^{(n)}(x_i)\n$$\n其中 $f^{(n)}(x_i)$ 是 $f(x)$ 在 $x_i$ 处的 $n$ 阶导数。\n\n将此展开式代入算子 $D_h f(x_i)$ 的定义中：\n$$\nD_h f(x_i) = \\frac{1}{h} \\sum_{k=-3}^{3} a_k \\left( \\sum_{n=0}^{\\infty} \\frac{(kh)^n}{n!} f^{(n)}(x_i) \\right)\n$$\n我们可以交换求和顺序：\n$$\nD_h f(x_i) = \\frac{1}{h} \\sum_{n=0}^{\\infty} \\left( \\sum_{k=-3}^{3} a_k (kh)^n \\right) \\frac{f^{(n)}(x_i)}{n!}\n$$\n这可以简化为：\n$$\nD_h f(x_i) = \\sum_{n=0}^{\\infty} h^{n-1} \\left( \\sum_{k=-3}^{3} k^n a_k \\right) \\frac{f^{(n)}(x_i)}{n!}\n$$\n让我们将系数 $a_k$ 的矩定义为 $M_n = \\sum_{k=-3}^{3} k^n a_k$。该算子可以写成：\n$$\nD_h f(x_i) = \\frac{M_0}{h}f^{(0)}(x_i) + M_1 f^{(1)}(x_i) + \\frac{M_2}{2!} h f^{(2)}(x_i) + \\frac{M_3}{3!} h^2 f^{(3)}(x_i) + \\dots\n$$\n问题指定了反对称约束 $a_0 = 0$ 和 $a_{-k} = -a_k$。让我们在这些约束下分析矩 $M_n$：\n$$\nM_n = \\sum_{k=-3}^{3} k^n a_k = 0^n a_0 + \\sum_{k=1}^{3} (k^n a_k + (-k)^n a_{-k})\n$$\n由于 $a_0 = 0$ 且 $a_{-k} = -a_k$：\n$$\nM_n = \\sum_{k=1}^{3} (k^n a_k - (-k)^n a_k) = \\sum_{k=1}^{3} a_k (k^n - (-1)^n k^n)\n$$\n如果 $n$ 是偶数， $n = 2p$，则 $(-1)^n = 1$，且 $k^n - (-1)^n k^n = k^{2p} - k^{2p} = 0$。因此，对于所有偶数 $n$， $M_n = 0$。\n如果 $n$ 是奇数， $n = 2p+1$，则 $(-1)^n = -1$，且 $k^n - (-1)^n k^n = k^{2p+1} - (-k^{2p+1}) = 2k^{2p+1}$。因此，对于所有奇数 $n  0$， $M_n = 2 \\sum_{k=1}^{3} k^n a_k$。且 $M_0=0$。\n\n将此应用于算子展开式，所有带有偶数阶导数（$f^{(0)}, f^{(2)}, f^{(4)}, \\dots$）的项都会自动消失。\n$$\nD_h f(x_i) = M_1 f^{(1)}(x_i) + \\frac{M_3}{3!} h^2 f^{(3)}(x_i) + \\frac{M_5}{5!} h^4 f^{(5)}(x_i) + \\frac{M_7}{7!} h^6 f^{(7)}(x_i) + \\dots\n$$\n截断误差为 $T.E. = D_h f(x_i) - f'(x_i)$。\n$$\nT.E. = (M_1 - 1)f'(x_i) + \\frac{M_3}{6} h^2 f^{(3)}(x_i) + \\frac{M_5}{120} h^4 f^{(5)}(x_i) + \\frac{M_7}{720} h^6 f^{(7)}(x_i) + O(h^8)\n$$\n为使算子达到六阶精度，误差中 $f'(x_i)$、$h^2 f^{(3)}(x_i)$ 和 $h^4 f^{(5)}(x_i)$ 的系数必须为零。这对精确系数 $a_k$ 施加了以下矩条件：\n1. $M_1 - 1 = 0 \\implies M_1 = 1 \\implies 2(a_1 + 2a_2 + 3a_3) = 1$\n2. $M_3 = 0 \\implies 2(a_1 + 8a_2 + 27a_3) = 0$\n3. $M_5 = 0 \\implies 2(a_1 + 32a_2 + 243a_3) = 0$\n\n解此方程组可得精确系数：$a_1 = \\frac{3}{4}$，$a_2 = -\\frac{3}{20}$，以及 $a_3 = \\frac{1}{60}$。\n作为小数，它们是 $a_1 = 0.75$，$a_2 = -0.15$，以及 $a_3 = 0.01\\overline{6}$。\n\n问题陈述预计算的系数存储为 $a_1^{\\mathrm{fp}} = 0.7500$，$a_2^{\\mathrm{fp}} = -0.1500$，和 $a_3^{\\mathrm{fp}} = 0.01667$。将这些值与精确值比较，我们发现 $a_1^{\\mathrm{fp}}$ 和 $a_2^{\\mathrm{fp}}$ 是精确的，而 $a_3^{\\mathrm{fp}}$ 是 $a_3$ 的舍入版本。\n\n我们被要求找出最终截断误差中 $h^2 f^{(3)}(x_i)$ 项的系数 $C$。这个系数是 $\\frac{M_3^{\\mathrm{fp}}}{6}$，其中 $M_3^{\\mathrm{fp}}$ 是用浮点系数计算出的三阶矩。\n$$\nM_3^{\\mathrm{fp}} = 2 \\sum_{k=1}^{3} k^3 a_k^{\\mathrm{fp}} = 2(1^3 a_1^{\\mathrm{fp}} + 2^3 a_2^{\\mathrm{fp}} + 3^3 a_3^{\\mathrm{fp}})\n$$\n$$\nM_3^{\\mathrm{fp}} = 2(a_1^{\\mathrm{fp}} + 8 a_2^{\\mathrm{fp}} + 27 a_3^{\\mathrm{fp}})\n$$\n代入给定的浮点值：\n$$\nM_3^{\\mathrm{fp}} = 2(0.7500 + 8(-0.1500) + 27(0.01667))\n$$\n$$\nM_3^{\\mathrm{fp}} = 2(0.7500 - 1.2000 + 0.45009)\n$$\n$$\nM_3^{\\mathrm{fp}} = 2(-0.4500 + 0.45009)\n$$\n$$\nM_3^{\\mathrm{fp}} = 2(0.00009) = 0.00018\n$$\n由于 $a_3$ 的舍入，$M_3 = 0$ 的条件被破坏。伪误差项 $C h^2 f^{(3)}(x_i)$ 的系数 $C$ 由下式给出：\n$$\nC = \\frac{M_3^{\\mathrm{fp}}}{3!} = \\frac{M_3^{\\mathrm{fp}}}{6}\n$$\n$$\nC = \\frac{0.00018}{6} = 0.00003\n$$\n问题要求将此标量表示为标准科学记数法，如有必要则舍入到四位有效数字。基于给定的浮点数，结果 $0.00003$ 是精确的。为了用四位有效数字表示它，我们写作：\n$$\nC = 3.000 \\times 10^{-5}\n$$\n这个结果表明，即使只是对最后一个系数进行少量舍入，也会引入一个非零的 $O(h^2)$ 截断误差项，从而将格式的精度阶数从六阶降到二阶。", "answer": "$$\\boxed{3.000 \\times 10^{-5}}$$", "id": "3370218"}]}