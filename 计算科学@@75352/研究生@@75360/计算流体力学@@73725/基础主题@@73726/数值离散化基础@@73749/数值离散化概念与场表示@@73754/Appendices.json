{"hands_on_practices": [{"introduction": "数值离散化是计算流体动力学（CFD）的核心，但它不可避免地会引入误差。本练习旨在通过分析两种最基本的差分格式——中心差分和迎风差分——来揭示这些误差的本质。通过推导数值相速度和振幅阻尼，您将亲手量化数值色散（导致非物理振荡）和数值耗散（导致特征模糊）的效应，这是理解和评判任何数值格式性能的基础。[@problem_id:3350130]", "problem": "考虑一维空间中的常系数线性平流方程 $u_{t} + a\\,u_{x} = 0$，其中 $a>0$，该方程定义在周期性域上。场在均匀网格 $x_{j} = j\\,\\Delta x$ 上表示，节点值为 $u_{j}(t) \\approx u(x_{j}, t)$，时间以步长 $\\Delta t$ 推进。空间导数 $u_{x}$ 可用二阶中心差分 $\\delta_{x}^{c} u_{j} = \\left(u_{j+1} - u_{j-1}\\right)/(2\\,\\Delta x)$ 或（当 $a>0$ 时）一阶迎风差分 $\\delta_{x}^{u} u_{j} = \\left(u_{j} - u_{j-1}\\right)/\\Delta x$ 来近似。由此得到的半离散线方法系统为 $u_{j}'(t) + a\\,\\delta_{x}^{c} u_{j}(t) = 0$ 和 $u_{j}'(t) + a\\,\\delta_{x}^{u} u_{j}(t) = 0$。考虑离散傅里叶模 $u_{j}(t) = \\hat{u}(t)\\,\\exp\\!\\left(i\\,j\\,\\theta\\right)$，其中无量纲波数为 $\\theta = k\\,\\Delta x \\in [0,\\pi]$，$k$ 是连续波数。使用此表示法和离散空间算子的基本定义，推导中心和迎风半离散系统的数值色散关系 $\\omega(\\theta)$，并将其与单步放大因子 $G(\\theta) = \\exp\\!\\left(-i\\,\\omega(\\theta)\\,\\Delta t\\right)$ 联系起来。由此定义数值相速度 $c_{\\text{num}}(\\theta) = \\omega_{R}(\\theta)/k$，其中 $\\omega_{R}$ 是 $\\omega$ 的实部，以及每步振幅衰减因子 $\\left|G(\\theta)\\right|$。对于中心格式，定义相速度误差比 $E_{c}(\\theta) = c_{\\text{num}}(\\theta)/a - 1$。对于迎风格式（$a>0$），定义每步振幅衰减因子 $D_{u}(\\theta) = \\left|G(\\theta)\\right|$。假设 Courant–Friedrichs–Lewy (CFL) 数 $\\nu = a\\,\\Delta t / \\Delta x$ 已给定且等于 $\\nu = 0.3$。在 $\\theta = \\pi/3$ 处评估离散模态，并计算单个标量 $S = E_{c}(\\theta) + D_{u}(\\theta)$。将最终结果表示为一个无量纲数，并四舍五入到六位有效数字。", "solution": "首先根据指定标准对问题进行验证。\n\n**步骤 1：提取已知条件**\n-   控制方程：$u_{t} + a\\,u_{x} = 0$，平流速度 $a>0$，定义在周期性域上。\n-   网格和场的表示：均匀网格 $x_{j} = j\\,\\Delta x$，节点值为 $u_{j}(t) \\approx u(x_{j}, t)$。\n-   时间步长：$\\Delta t$。\n-   用于 $u_{x}$ 的二阶中心差分算子：$\\delta_{x}^{c} u_{j} = \\frac{u_{j+1} - u_{j-1}}{2\\,\\Delta x}$。\n-   用于 $u_{x}$ 的一阶迎风差分算子（$a>0$ 时）：$\\delta_{x}^{u} u_{j} = \\frac{u_{j} - u_{j-1}}{\\Delta x}$。\n-   半离散系统：$u_{j}'(t) + a\\,\\delta_{x}^{c} u_{j}(t) = 0$（中心）和 $u_{j}'(t) + a\\,\\delta_{x}^{u} u_{j}(t) = 0$（迎风）。\n-   离散傅里叶模表示：$u_{j}(t) = \\hat{u}(t)\\,\\exp(i\\,j\\,\\theta)$。\n-   无量纲波数：$\\theta = k\\,\\Delta x \\in [0, \\pi]$，其中 $k$ 是连续波数。\n-   数值色散关系：$\\omega(\\theta)$。\n-   单步放大因子：$G(\\theta) = \\exp(-i\\,\\omega(\\theta)\\,\\Delta t)$。\n-   数值相速度：$c_{\\text{num}}(\\theta) = \\omega_{R}(\\theta)/k$，其中 $\\omega_{R}$ 是 $\\omega$ 的实部。\n-   相速度误差比（中心格式）：$E_{c}(\\theta) = c_{\\text{num}}(\\theta)/a - 1$。\n-   每步振幅衰减因子（迎风格式）：$D_{u}(\\theta) = |G(\\theta)|$。\n-   Courant–Friedrichs–Lewy (CFL) 数：$\\nu = a\\,\\Delta t / \\Delta x = 0.3$。\n-   求值点：$\\theta = \\pi/3$。\n-   目标量：在 $\\theta=\\pi/3$ 处求值的 $S = E_{c}(\\theta) + D_{u}(\\theta)$。\n-   要求输出格式：无量纲数，四舍五入到六位有效数字。\n\n**步骤 2：使用提取的已知条件进行验证**\n-   **科学性：** 该问题是关于线性平流方程有限差分格式的傅里叶分析（或冯·诺依曼分析）的一个标准、基础的练习。所有定义、方程和概念在偏微分方程数值分析和计算流体动力学领域都是标准的。\n-   **适定性：** 问题提供了所有必要的定义、常数和参数，以唯一确定所需的量。解题路径清晰明确。\n-   **客观性：** 问题以精确、客观的数学语言陈述，没有模糊性或主观性陈述。\n-   **完整性与一致性：** 问题设置是自洽且内部一致的。没有信息缺失或相互矛盾。\n\n**步骤 3：结论与行动**\n该问题有效。将提供详细解答。\n\n**量的推导**\n\n我们首先推导所需的量 $E_{c}(\\theta)$ 和 $D_{u}(\\theta)$。\n\n**1. 中心差分格式分析**\n中心格式的半离散方程为：\n$$u_{j}'(t) + a\\,\\delta_{x}^{c} u_{j}(t) = 0$$\n我们将离散傅里叶模 $u_{j}(t) = \\hat{u}(t)\\,\\exp(i\\,j\\,\\theta)$ 代入此方程。时间导数为 $u_{j}'(t) = \\hat{u}'(t)\\,\\exp(i\\,j\\,\\theta)$。空间项变为：\n$$a\\,\\delta_{x}^{c} u_{j}(t) = a\\,\\frac{u_{j+1}(t) - u_{j-1}(t)}{2\\,\\Delta x} = a\\,\\frac{\\hat{u}(t)\\,\\exp(i(j+1)\\theta) - \\hat{u}(t)\\,\\exp(i(j-1)\\theta)}{2\\,\\Delta x}$$\n提取公因式：\n$$a\\,\\delta_{x}^{c} u_{j}(t) = a\\,\\frac{\\hat{u}(t)\\,\\exp(ij\\theta)(\\exp(i\\theta) - \\exp(-i\\theta))}{2\\,\\Delta x}$$\n使用欧拉公式 $\\exp(i\\theta) - \\exp(-i\\theta) = 2i\\sin(\\theta)$，我们得到：\n$$a\\,\\delta_{x}^{c} u_{j}(t) = a\\,\\frac{\\hat{u}(t)\\,\\exp(ij\\theta)(2i\\sin(\\theta))}{2\\,\\Delta x} = i\\,\\frac{a\\sin(\\theta)}{\\Delta x}\\,u_{j}(t)$$\n代回半离散方程：\n$$\\hat{u}'(t)\\,\\exp(ij\\theta) + i\\,\\frac{a\\sin(\\theta)}{\\Delta x}\\,\\hat{u}(t)\\,\\exp(ij\\theta) = 0$$\n两边除以 $\\exp(ij\\theta)$，得到关于模态振幅 $\\hat{u}(t)$ 的常微分方程：\n$$\\hat{u}'(t) = -i\\,\\frac{a\\sin(\\theta)}{\\Delta x}\\,\\hat{u}(t)$$\n对于波状解，我们假设 $\\hat{u}(t) \\propto \\exp(-i\\omega t)$，这意味着 $\\hat{u}'(t) = -i\\omega\\,\\hat{u}(t)$。将其与上式比较，我们确定了中心格式的数值色散关系 $\\omega_{c}(\\theta)$：\n$$\\omega_{c}(\\theta) = \\frac{a\\sin(\\theta)}{\\Delta x}$$\n此色散关系是纯实数的，因此 $\\omega_{R}(\\theta) = \\omega_{c}(\\theta)$。数值相速度定义为 $c_{\\text{num}}(\\theta) = \\omega_{R}(\\theta)/k$。使用关系式 $\\theta = k\\,\\Delta x$，我们有 $k = \\theta/\\Delta x$。\n$$c_{\\text{num},c}(\\theta) = \\frac{\\omega_{c}(\\theta)}{k} = \\frac{a\\sin(\\theta)/\\Delta x}{\\theta/\\Delta x} = a\\,\\frac{\\sin(\\theta)}{\\theta}$$\n于是，相速度误差比 $E_{c}(\\theta)$ 为：\n$$E_{c}(\\theta) = \\frac{c_{\\text{num},c}(\\theta)}{a} - 1 = \\frac{a\\,\\sin(\\theta)/\\theta}{a} - 1 = \\frac{\\sin(\\theta)}{\\theta} - 1$$\n\n**2. 迎风差分格式分析**\n迎风格式（对于 $a>0$）的半离散方程为：\n$$u_{j}'(t) + a\\,\\delta_{x}^{u} u_{j}(t) = 0$$\n我们再次代入傅里叶模 $u_{j}(t) = \\hat{u}(t)\\,\\exp(i\\,j\\,\\theta)$。空间项为：\n$$a\\,\\delta_{x}^{u} u_{j}(t) = a\\,\\frac{u_{j}(t) - u_{j-1}(t)}{\\Delta x} = a\\,\\frac{\\hat{u}(t)\\,\\exp(ij\\theta) - \\hat{u}(t)\\,\\exp(i(j-1)\\theta)}{\\Delta x}$$\n提取公因式：\n$$a\\,\\delta_{x}^{u} u_{j}(t) = a\\,\\frac{\\hat{u}(t)\\,\\exp(ij\\theta)(1 - \\exp(-i\\theta))}{\\Delta x} = \\frac{a}{\\Delta x}\\,(1 - \\exp(-i\\theta))\\,u_{j}(t)$$\n半离散方程变为：\n$$\\hat{u}'(t) = -\\frac{a}{\\Delta x}\\,(1 - \\exp(-i\\theta))\\,\\hat{u}(t)$$\n使用 $1 - \\exp(-i\\theta) = 1 - (\\cos\\theta - i\\sin\\theta) = (1 - \\cos\\theta) + i\\sin\\theta$：\n$$\\hat{u}'(t) = -\\frac{a}{\\Delta x}\\,((1 - \\cos\\theta) + i\\sin\\theta)\\,\\hat{u}(t)$$\n再次与 $\\hat{u}'(t) = -i\\omega_{u}(\\theta)\\,\\hat{u}(t)$ 比较，我们得到迎风格式的数值色散关系 $\\omega_{u}(\\theta)$：\n$$-i\\omega_{u}(\\theta) = -\\frac{a}{\\Delta x}\\,((1 - \\cos\\theta) + i\\sin\\theta)$$\n$$\\omega_{u}(\\theta) = \\frac{a}{i\\Delta x}\\,((1 - \\cos\\theta) + i\\sin\\theta) = \\frac{a}{\\Delta x}\\,(\\sin\\theta - i(1 - \\cos\\theta))$$\n这个关系式是复数，其实部为 $\\omega_{R}(\\theta) = \\frac{a\\sin\\theta}{\\Delta x}$，虚部为 $\\omega_{I}(\\theta) = -\\frac{a(1-\\cos\\theta)}{\\Delta x}$。\n\n单步放大因子为 $G(\\theta) = \\exp(-i\\,\\omega(\\theta)\\,\\Delta t)$。对于迎风格式：\n$$G_{u}(\\theta) = \\exp(-i\\,\\omega_{u}(\\theta)\\,\\Delta t) = \\exp(-i\\,\\left(\\frac{a}{\\Delta x}\\,(\\sin\\theta - i(1 - \\cos\\theta))\\right)\\Delta t)$$\n$$G_{u}(\\theta) = \\exp\\left(-\\frac{ia\\Delta t}{\\Delta x}\\sin\\theta - \\frac{a\\Delta t}{\\Delta x}(1 - \\cos\\theta)\\right)$$\n每步振幅衰减因子是放大因子的模，$D_{u}(\\theta) = |G_{u}(\\theta)|$。\n$$D_{u}(\\theta) = \\left|\\exp\\left(-\\frac{ia\\Delta t}{\\Delta x}\\sin\\theta\\right)\\,\\exp\\left(-\\frac{a\\Delta t}{\\Delta x}(1 - \\cos\\theta)\\right)\\right|$$\n由于对于任意实数 $x$，都有 $|\\exp(-ix)| = 1$，因此模的大小由指数的实部决定：\n$$D_{u}(\\theta) = \\exp\\left(-\\frac{a\\Delta t}{\\Delta x}(1 - \\cos\\theta)\\right)$$\n使用 CFL 数的定义 $\\nu = a\\,\\Delta t/\\Delta x$，我们得到衰减因子的最终表达式：\n$$D_{u}(\\theta) = \\exp(-\\nu(1 - \\cos\\theta))$$\n\n**3. 数值计算**\n我们需要计算当 $\\theta = \\pi/3$ 和 $\\nu = 0.3$ 时，$S = E_{c}(\\theta) + D_{u}(\\theta)$ 的值。\n\n首先，我们计算 $E_{c}(\\pi/3)$：\n$$E_{c}(\\pi/3) = \\frac{\\sin(\\pi/3)}{\\pi/3} - 1 = \\frac{\\sqrt{3}/2}{\\pi/3} - 1 = \\frac{3\\sqrt{3}}{2\\pi} - 1$$\n接着，我们计算 $D_{u}(\\pi/3)$：\n$$D_{u}(\\pi/3) = \\exp(-\\nu(1 - \\cos(\\pi/3))) = \\exp(-0.3(1 - 1/2)) = \\exp(-0.3 \\times 0.5) = \\exp(-0.15)$$\n量 $S$ 是这两个值的和：\n$$S = \\left(\\frac{3\\sqrt{3}}{2\\pi} - 1\\right) + \\exp(-0.15)$$\n我们现在计算数值。\n$$\\frac{3\\sqrt{3}}{2\\pi} \\approx \\frac{3 \\times 1.73205081}{2 \\times 3.14159265} \\approx \\frac{5.19615243}{6.2831853} \\approx 0.82699334$$\n所以，$E_{c}(\\pi/3) \\approx 0.82699334 - 1 = -0.17300666$。\n并且，$\\exp(-0.15) \\approx 0.86070798$。\n将这些值相加：\n$$S \\approx -0.17300666 + 0.86070798 = 0.68770132$$\n四舍五入到六位有效数字，我们得到 $0.687701$。", "answer": "$$\\boxed{0.687701}$$", "id": "3350130"}, {"introduction": "前一个练习表明，简单的线性格式在处理复杂流动时存在固有的局限性。为了在捕捉激波等不连续性的同时保持高阶精度，研究人员开发了加权基本无振荡（WENO）格式等先进的非线性方法。本练习将引导您完成第五阶WENO重构过程的每一步，通过在一个平滑数据集上计算其复杂的非线性权值，揭示其如何在光滑区域恢复为高阶线性格式的智能机制。[@problem_id:3350080]", "problem": "考虑一个一维均匀有限体积网格，其单元中心位于 $x_i$ 位置，单元交界面位于 $x_{i \\pm \\tfrac{1}{2}}$。设 $\\bar{u}_j$ 表示光滑标量场 $u(x)$ 在单元 $j$ 上的单元平均值，即 $\\bar{u}_j = \\frac{1}{\\Delta x} \\int_{x_{j-\\tfrac{1}{2}}}^{x_{j+\\tfrac{1}{2}}} u(x) \\, dx$，其中 $\\Delta x$ 是均匀的单元尺寸。您需要使用 Jiang–Shu 公式中的标准五阶加权基本上无振荡 (WENO) 重构方法，在 $x_{i+\\tfrac{1}{2}}$ 处重构左偏交界面值 $u_{i+\\tfrac{1}{2}}^{-}$。重构从局部二次多项式的定义开始，这些多项式的单元平均值与每个三单元模板上的数据相匹配，并基于不分差分定义光滑度指示因子。使用由线性最优权重和光滑度指示因子构成的非线性权重，其中幂次 $p = 2$，小正参数 $\\epsilon = 10^{-6}$。\n\n给定的单元平均值为\n$\\bar{u}_{i-2} = 1$，$\\bar{u}_{i-1} = 2$，$\\bar{u}_{i} = 3$，$\\bar{u}_{i+1} = 4$ 和 $\\bar{u}_{i+2} = 5$。\n\n推导每个三单元模板上的候选交界面值，计算光滑度指示因子和由此产生的非线性权重，然后计算最终重构的左偏交界面值 $u_{i+\\tfrac{1}{2}}^{-}$。请以精确值的形式给出最终答案，不进行四舍五入，不带单位。", "solution": "该问题要求使用五阶加权基本上无振荡 (WENO) 重构格式，根据给定的单元平均数据计算左偏交界面值 $u_{i+\\tfrac{1}{2}}^{-}$。\n\n### 步骤1：提取给定条件\n- **网格**：一维均匀有限体积网格，单元尺寸为 $\\Delta x$。\n- **单元平均值**：$\\bar{u}_j = \\frac{1}{\\Delta x} \\int_{x_{j-\\tfrac{1}{2}}}^{x_{j+\\tfrac{1}{2}}} u(x) \\, dx$。\n- **给定数据**：$\\bar{u}_{i-2} = 1$，$\\bar{u}_{i-1} = 2$，$\\bar{u}_{i} = 3$，$\\bar{u}_{i+1} = 4$ 和 $\\bar{u}_{i+2} = 5$。\n- **重构方法**：用于左偏交界面值 $u_{i+\\tfrac{1}{2}}^{-}$ 的标准五阶 Jiang-Shu WENO。\n- **重构基础**：三单元模板上的局部二次多项式。\n- **WENO 参数**：幂次 $p = 2$，正则化参数 $\\epsilon = 10^{-6}$。\n\n### 步骤2：使用提取的给定条件进行验证\n该问题具有科学依据，因为 WENO 格式是计算科学中一种标准且成熟的数值方法，尤其在计算流体力学中用于求解双曲守恒律。该问题是适定的，为获得唯一解提供了所有必要的数据和参数。所提供的数据 $\\bar{u}_{j} = j-i+3$ 对应于一个完美线性函数的单元平均值，这是高阶数值格式的经典测试案例。问题陈述客观，不包含任何矛盾或歧义。\n\n### 步骤3：结论与行动\n该问题有效。将提供完整的解答。\n\n### 解题推导\n$u_{i+\\tfrac{1}{2}}^{-}$ 的五阶 WENO 重构基于一个五单元模板，$\\{C_{i-2}, C_{i-1}, C_i, C_{i+1}, C_{i+2}\\}$。该模板被分解为三个较小的三单元模板，每个模板提供一个三阶候选重构。\n这些模板是：\n$S_0 = \\{C_{i-2}, C_{i-1}, C_i\\}$\n$S_1 = \\{C_{i-1}, C_i, C_{i+1}\\}$\n$S_2 = \\{C_i, C_{i+1}, C_{i+2}\\}$\n\n最终的重构值是来自每个模板的候选值的非线性加权平均：\n$$u_{i+\\tfrac{1}{2}}^{-} = \\sum_{k=0}^{2} \\omega_k u_{i+\\tfrac{1}{2}}^{(k)}$$\n\n**1. 候选重构**\n\n对于均匀网格，从单元平均值 $\\bar{u}_j$ 在交界面 $x_{i+\\tfrac{1}{2}}$ 处的三阶重构 $u_{i+\\tfrac{1}{2}}^{(k)}$ 由以下公式给出：\n$$u_{i+\\tfrac{1}{2}}^{(0)} = \\frac{1}{3}\\bar{u}_{i-2} - \\frac{7}{6}\\bar{u}_{i-1} + \\frac{11}{6}\\bar{u}_{i}$$\n$$u_{i+\\tfrac{1}{2}}^{(1)} = -\\frac{1}{6}\\bar{u}_{i-1} + \\frac{5}{6}\\bar{u}_{i} + \\frac{1}{3}\\bar{u}_{i+1}$$\n$$u_{i+\\tfrac{1}{2}}^{(2)} = \\frac{1}{3}\\bar{u}_{i} + \\frac{5}{6}\\bar{u}_{i+1} - \\frac{1}{6}\\bar{u}_{i+2}$$\n\n代入给定的单元平均值 $\\bar{u}_{i-2} = 1$, $\\bar{u}_{i-1} = 2$, $\\bar{u}_{i} = 3$, $\\bar{u}_{i+1} = 4$ 和 $\\bar{u}_{i+2} = 5$：\n$$u_{i+\\tfrac{1}{2}}^{(0)} = \\frac{1}{3}(1) - \\frac{7}{6}(2) + \\frac{11}{6}(3) = \\frac{2}{6} - \\frac{14}{6} + \\frac{33}{6} = \\frac{21}{6} = \\frac{7}{2}$$\n$$u_{i+\\tfrac{1}{2}}^{(1)} = -\\frac{1}{6}(2) + \\frac{5}{6}(3) + \\frac{1}{3}(4) = -\\frac{2}{6} + \\frac{15}{6} + \\frac{8}{6} = \\frac{21}{6} = \\frac{7}{2}$$\n$$u_{i+\\tfrac{1}{2}}^{(2)} = \\frac{1}{3}(3) + \\frac{5}{6}(4) - \\frac{1}{6}(5) = \\frac{6}{6} + \\frac{20}{6} - \\frac{5}{6} = \\frac{21}{6} = \\frac{7}{2}$$\n正如对来自线性函数的数据所预期的那样，所有候选重构都得出了相同的精确值。\n\n**2. 光滑度指示因子**\n\n光滑度指示因子 $IS_k$ 用于衡量函数在每个模板 $S_k$ 上的光滑度。对于五阶 WENO 格式，在 $x_{i+\\tfrac{1}{2}}$ 处重构的标准公式为：\n$$IS_0 = \\frac{13}{12}(\\bar{u}_{i-2} - 2\\bar{u}_{i-1} + \\bar{u}_{i})^2 + \\frac{1}{4}(\\bar{u}_{i-2} - 4\\bar{u}_{i-1} + 3\\bar{u}_{i})^2$$\n$$IS_1 = \\frac{13}{12}(\\bar{u}_{i-1} - 2\\bar{u}_{i} + \\bar{u}_{i+1})^2 + \\frac{1}{4}(\\bar{u}_{i-1} - \\bar{u}_{i+1})^2$$\n$$IS_2 = \\frac{13}{12}(\\bar{u}_{i} - 2\\bar{u}_{i+1} + \\bar{u}_{i+2})^2 + \\frac{1}{4}(3\\bar{u}_{i} - 4\\bar{u}_{i+1} + \\bar{u}_{i+2})^2$$\n\n使用给定数据：\n对于 $IS_0$：\n$\\bar{u}_{i-2} - 2\\bar{u}_{i-1} + \\bar{u}_{i} = 1 - 2(2) + 3 = 0$\n$\\bar{u}_{i-2} - 4\\bar{u}_{i-1} + 3\\bar{u}_{i} = 1 - 4(2) + 3(3) = 2$\n$$IS_0 = \\frac{13}{12}(0)^2 + \\frac{1}{4}(2)^2 = 1$$\n\n对于 $IS_1$：\n$\\bar{u}_{i-1} - 2\\bar{u}_{i} + \\bar{u}_{i+1} = 2 - 2(3) + 4 = 0$\n$\\bar{u}_{i-1} - \\bar{u}_{i+1} = 2 - 4 = -2$\n$$IS_1 = \\frac{13}{12}(0)^2 + \\frac{1}{4}(-2)^2 = 1$$\n\n对于 $IS_2$：\n$\\bar{u}_{i} - 2\\bar{u}_{i+1} + \\bar{u}_{i+2} = 3 - 2(4) + 5 = 0$\n$3\\bar{u}_{i} - 4\\bar{u}_{i+1} + \\bar{u}_{i+2} = 3(3) - 4(4) + 5 = -2$\n$$IS_2 = \\frac{13}{12}(0)^2 + \\frac{1}{4}(-2)^2 = 1$$\n所有光滑度指示因子都等于 $1$。这是因为底层函数是线性的，导致二阶差分项（近似于二阶导数）为零，而一阶导数项贡献一个常数值。\n\n**3. 非线性权重**\n\n非线性权重 $\\omega_k$ 是根据光滑度指示因子 $IS_k$ 和线性最优权重 $C_k$ 计算得出的。五阶 WENO 的线性权重为 $C_0 = 0.1$，$C_1 = 0.6$ 和 $C_2 = 0.3$。\n首先，计算未归一化的权重 $\\alpha_k$：\n$$\\alpha_k = \\frac{C_k}{(IS_k + \\epsilon)^p}$$\n当 $p=2$，$\\epsilon = 10^{-6}$ 且 $IS_0=IS_1=IS_2=1$ 时：\n$$\\alpha_0 = \\frac{0.1}{(1 + 10^{-6})^2}$$\n$$\\alpha_1 = \\frac{0.6}{(1 + 10^{-6})^2}$$\n$$\\alpha_2 = \\frac{0.3}{(1 + 10^{-6})^2}$$\n\n然后，归一化的权重 $\\omega_k$ 为：\n$$\\omega_k = \\frac{\\alpha_k}{\\sum_{j=0}^{2} \\alpha_j}$$\n求和为 $\\sum_{j=0}^{2} \\alpha_j = \\frac{0.1+0.6+0.3}{(1 + 10^{-6})^2} = \\frac{1.0}{(1 + 10^{-6})^2}$。\n$$\\omega_0 = \\frac{\\frac{0.1}{(1 + 10^{-6})^2}}{\\frac{1.0}{(1 + 10^{-6})^2}} = 0.1$$\n$$\\omega_1 = \\frac{\\frac{0.6}{(1 + 10^{-6})^2}}{\\frac{1.0}{(1 + 10^{-6})^2}} = 0.6$$\n$$\\omega_2 = \\frac{\\frac{0.3}{(1 + 10^{-6})^2}}{\\frac{1.0}{(1 + 10^{-6})^2}} = 0.3$$\n对于这种光滑的线性数据，非线性权重 $\\omega_k$ 等于最优线性权重 $C_k$，从而确保该格式达到其最高精度阶。\n\n**4. 最终重构值**\n\n最终的重构值是候选值的加权平均：\n$$u_{i+\\tfrac{1}{2}}^{-} = \\omega_0 u_{i+\\tfrac{1}{2}}^{(0)} + \\omega_1 u_{i+\\tfrac{1}{2}}^{(1)} + \\omega_2 u_{i+\\tfrac{1}{2}}^{(2)}$$\n$$u_{i+\\tfrac{1}{2}}^{-} = (0.1)\\left(\\frac{7}{2}\\right) + (0.6)\\left(\\frac{7}{2}\\right) + (0.3)\\left(\\frac{7}{2}\\right)$$\n$$u_{i+\\tfrac{1}{2}}^{-} = (0.1 + 0.6 + 0.3) \\left(\\frac{7}{2}\\right) = (1.0)\\left(\\frac{7}{2}\\right) = \\frac{7}{2}$$", "answer": "$$\\boxed{\\frac{7}{2}}$$", "id": "3350080"}, {"introduction": "在开发和应用任何数值格式之后，一个至关重要的问题是：我们的计算结果可靠吗？代码验证是确保CFD模拟质量的关键环节。本练习将向您介绍网格收敛性研究的标准方法，这是一种通过在系统加密的网格上比较计算结果来定量评估数值解的准确阶和外推“精确”解的强大技术。掌握此方法是成为一名严谨的计算科学家的必备技能。[@problem_id:3350102]", "problem": "一位研究人员正在验证用于计算中等雷诺数（Reynolds number, Re）下二维圆柱体上的无量纲阻力系数的稳态不可压缩纳维-斯托克斯方程（Navier–Stokes equations）的有限体积法（finite volume method, FVM）解的网格加密效果。网格被均匀加密，使得特征单元尺寸满足 $h_2 = h_1 / r$ 和 $h_3 = h_2 / r$，其中加密比 $r > 1$ 为常数。在三套网格上计算出的阻力系数分别为 $Q_1$、$Q_2$ 和 $Q_3$，且 $Q_1 > Q_2 > Q_3$，这证实了单调收敛性。假设数值解处于渐近收敛范围内，且离散误差满足主阶模型 $Q(h) = Q_{\\infty} + C h^{p}$，其中 $Q_{\\infty}$ 是网格收敛值，$C$ 是一个常数，$p$ 是观测到的精度阶。\n\n给定加密比 $r = 2$ 和数值解 $Q_1 = 1.24520$、$Q_2 = 1.23528$ 和 $Q_3 = 1.23403$，请使用与上述模型和单调收敛性一致的三套网格法，确定观测到的精度阶 $p$ 和网格收敛外推值 $Q_{\\text{ext}}$。\n\n报告 $p$ 值至四位有效数字，$Q_{\\text{ext}}$ 值至六位有效数字。阻力系数是无量纲的；将最终的 $Q_{\\text{ext}}$ 表示为一个无单位的纯数。最终答案只提供两个数字。", "solution": "用户提供了一个来自计算流体动力学领域的关于网格收敛性分析的问题。该问题要求根据在一系列系统加密的网格上进行的三次模拟，确定一个计算量的观测精度阶和网格收敛外推值。\n\n首先，对问题陈述进行验证。\n\n**第一步：提取已知条件**\n- 离散误差模型：$Q(h) = Q_{\\infty} + C h^{p}$，其中 $Q(h)$ 是在特征单元尺寸为 $h$ 的网格上计算出的量，$Q_{\\infty}$ 是当 $h \\to 0$ 时离散方程的精确解，$C$ 是一个常数，$p$ 是精度阶。\n- 网格加密序列：三套网格，其特征单元尺寸分别为 $h_1$、$h_2$ 和 $h_3$。\n- 加密关系：$h_2 = h_1 / r$ 和 $h_3 = h_2 / r = h_1 / r^2$。\n- 加密比：$r = 2$。\n- 计算解：在网格1上为 $Q_1 = 1.24520$，在网格2上为 $Q_2 = 1.23528$，在网格3上为 $Q_3 = 1.23403$。\n- 收敛行为：单调收敛，且 $Q_1 > Q_2 > Q_3$。\n- 目标：确定观测到的精度阶 $p$ 和外推值 $Q_{\\text{ext}}$，后者是 $Q_{\\infty}$ 的一个估计值。\n- 报告精度：$p$ 保留四位有效数字，$Q_{\\text{ext}}$ 保留六位有效数字。\n\n**第二步：使用提取的已知条件进行验证**\n- **科学依据：** 该问题使用了计算科学中验证的标准方法，特别是用于网格加密研究的理查森外推法。误差模型是在渐近收敛范围内进行此分析的一个基本假设。上下文（圆柱体上的阻力）是一个典型问题。该问题在科学上是合理的。\n- **适定性：** 该问题提供了三个数据点（$Q_1, Q_2, Q_3$）和加密比 $r$，这允许确定两个主要未知数 $p$ 和 $Q_{\\infty}$。该系统是完全确定的，并存在唯一解。\n- **客观性：** 该问题使用精确的数值数据和形式化的数学模型进行陈述，没有任何主观或模糊的语言。\n\n**第三步：结论与行动**\n该问题是有效的。将推导解答。\n\n**解答推导**\n分析从三套网格的假设误差模型开始：\n$Q_1 = Q(h_1) = Q_{\\infty} + C h_1^{p}$\n$Q_2 = Q(h_2) = Q_{\\infty} + C h_2^{p} = Q_{\\infty} + C (h_1/r)^{p} = Q_{\\infty} + C \\frac{h_1^{p}}{r^p}$\n$Q_3 = Q(h_3) = Q_{\\infty} + C h_3^{p} = Q_{\\infty} + C (h_2/r)^{p} = Q_{\\infty} + C \\frac{h_1^{p}}{r^{2p}}$\n\n为了确定观测到的精度阶 $p$，我们首先计算连续解之间的差值。\n粗网格和中等网格上解的差值为：\n$$ Q_1 - Q_2 = (Q_{\\infty} + C h_1^{p}) - \\left(Q_{\\infty} + C \\frac{h_1^{p}}{r^p}\\right) = C h_1^{p} \\left(1 - \\frac{1}{r^p}\\right) $$\n中等网格和细网格上解的差值为：\n$$ Q_2 - Q_3 = \\left(Q_{\\infty} + C \\frac{h_1^{p}}{r^p}\\right) - \\left(Q_{\\infty} + C \\frac{h_1^{p}}{r^{2p}}\\right) = C \\frac{h_1^{p}}{r^p} \\left(1 - \\frac{1}{r^p}\\right) $$\n接下来，我们计算这两个差值的比率。这个代数操作消去了未知项 $C$ 和 $h_1$：\n$$ \\frac{Q_1 - Q_2}{Q_2 - Q_3} = \\frac{C h_1^{p} \\left(1 - \\frac{1}{r^p}\\right)}{C \\frac{h_1^{p}}{r^p} \\left(1 - \\frac{1}{r^p}\\right)} = r^p $$\n现在我们可以通过对两边取自然对数来求解 $p$：\n$$ \\ln\\left(\\frac{Q_1 - Q_2}{Q_2 - Q_3}\\right) = \\ln(r^p) = p \\ln(r) $$\n$$ p = \\frac{\\ln\\left(\\frac{Q_1 - Q_2}{Q_2 - Q_3}\\right)}{\\ln(r)} $$\n代入给定的数值：\n$r = 2$\n$Q_1 = 1.24520$\n$Q_2 = 1.23528$\n$Q_3 = 1.23403$\n\n差值为：\n$Q_1 - Q_2 = 1.24520 - 1.23528 = 0.00992$\n$Q_2 - Q_3 = 1.23528 - 1.23403 = 0.00125$\n\n现在，我们计算 $p$：\n$$ p = \\frac{\\ln\\left(\\frac{0.00992}{0.00125}\\right)}{\\ln(2)} = \\frac{\\ln(7.936)}{\\ln(2)} \\approx \\frac{2.071353}{0.693147} \\approx 2.988353 $$\n按要求，四舍五入到四位有效数字，得到 $p = 2.988$。\n\n接下来，我们使用理查森外推法确定外推值 $Q_{\\text{ext}} = Q_{\\infty}$。标准做法是使用最密的两套网格（$h_2$ 和 $h_3$）进行外推，因为它们代表了最准确的解，并且最有可能处于渐近收敛范围内。外推公式由 $Q_2$ 和 $Q_3$ 的方程推导而来：\n$Q_2 = Q_{\\infty} + C h_2^p$\n$Q_3 = Q_{\\infty} + C h_3^p = Q_{\\infty} + C (h_2/r)^p$\n\n根据第一个方程，中等网格上的误差为 $E_2 = Q_2 - Q_{\\infty} = C h_2^p$。\n细网格上的误差为 $E_3 = Q_3 - Q_{\\infty} = C h_3^p$。\n误差之比为 $\\frac{E_2}{E_3} = \\frac{C h_2^p}{C h_3^p} = \\left(\\frac{h_2}{h_3}\\right)^p = r^p$。\n所以，$Q_2 - Q_{\\infty} = r^p (Q_3 - Q_{\\infty})$。\n重新整理以求解 $Q_{\\infty}$：\n$Q_2 - Q_{\\infty} = r^p Q_3 - r^p Q_{\\infty}$\n$Q_{\\infty} (r^p - 1) = r^p Q_3 - Q_2$\n$$ Q_{\\infty} = \\frac{r^p Q_3 - Q_2}{r^p - 1} $$\n这可以重写为更常见且数值上更稳定的形式：\n$$ Q_{\\text{ext}} = Q_{\\infty} = Q_3 + \\frac{Q_3 - Q_2}{r^p - 1} $$\n我们可以直接代入之前计算得到的 $r^p$ 的值，其中 $r^p = \\frac{Q_1 - Q_2}{Q_2 - Q_3} = 7.936$。\n使用给定的 $Q_2$ 和 $Q_3$ 的值：\n$Q_3 - Q_2 = 1.23403 - 1.23528 = -0.00125$\n$$ Q_{\\text{ext}} = 1.23403 + \\frac{-0.00125}{7.936 - 1} = 1.23403 - \\frac{0.00125}{6.936} $$\n$$ Q_{\\text{ext}} \\approx 1.23403 - 0.000180219146... = 1.2338497808... $$\n按要求，四舍五入到六位有效数字，得到 $Q_{\\text{ext}} = 1.23385$。\n\n观测到的精度阶为 $p \\approx 2.988$，网格收敛外推值为 $Q_{\\text{ext}} \\approx 1.23385$。", "answer": "$$ \\boxed{\\begin{pmatrix} 2.988 & 1.23385 \\end{pmatrix}} $$", "id": "3350102"}]}