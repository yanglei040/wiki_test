{"hands_on_practices": [{"introduction": "任何自适应方法的核心在于准确识别计算域中误差较大的区域，以便进行局部加密。后验误差估计子（a posteriori error estimators）正是为此目的而设计的。本练习将引导您亲手计算一个基于残差的误差指示子，这是最常用的一类估计子。[@problem_id:3330576]通过在一个简单的三角形单元上进行计算，您将深入理解误差指示子如何量化两个主要的误差来源：单元内部由近似解产生的主方程残差，以及单元边界上解的不连续性（即“跳跃”）。这项实践对于理解自适应算法如何“感知”误差并指导网格加密至关重要。", "problem": "考虑一个在具有多边形网格的有界域上提出的稳态线性对流扩散模型问题。在每个网格单元上，近似解由一个多项式表示。在间断Galerkin (DG) 框架中，单元强残差和边跳跃项与一种相对于多项式次数是稳健的缩放相结合，这种缩放通常被称为 $p$-稳健缩放。在一个协调连续有限元 (FE) 框架中，解的内部边跳跃项消失，但边界失配可以类似地度量。从标量场 $u$ 的控制方程开始：\n$$-\\nu\\Delta u + \\boldsymbol{\\beta}\\cdot\\nabla u = f,$$\n给定Dirichlet边界数据 $g$。\n\n我们关注一个顶点为 $(0,0)$、$(1,0)$ 和 $(0,1)$ 的三角形单元 $K$。设 $K$ 上的近似数值解为多项式\n$$u_h(x,y) = 1 + x - y,$$\n次数为 $p_K = 1$。取扩散系数 $\\nu = 1$，对流场 $\\boldsymbol{\\beta} = (1,2)$，以及源项\n$$f(x,y) = x - y.$$\n假设在 $\\partial K$ 上有齐次Dirichlet边界数据 $g \\equiv 0$。定义 $p$-稳健单元指示子为\n$$\\eta_K^2 \\;=\\; \\frac{h_K^2}{p_K^2}\\,\\big\\|\\,f + \\nu\\,\\Delta u_h - \\boldsymbol{\\beta}\\cdot\\nabla u_h\\,\\big\\|_{L^2(K)}^2 \\;+\\; \\sum_{e\\subset\\partial K}\\frac{p_e^2}{h_e}\\,\\big\\|\\,\\llbracket u_h \\rrbracket\\,\\big\\|_{L^2(e)}^2,$$\n其中 $h_K$ 是单元直径（三角形顶点之间的最大距离），$h_e$ 是边 $e$ 的长度，$\\llbracket u_h \\rrbracket$ 表示 $u_h$ 跨越边 $e$ 的跳跃，在具有Dirichlet数据的边界 $\\partial K$ 上，此跳跃项取为 $u_h - g = u_h$。在 $K$ 的每条边上使用 $p_e = p_K$。\n\n计算 $\\eta_K^2$ 的精确值，结果为一个实数。不需要四舍五入，也不需要报告单位。请以精确形式表示最终答案。", "solution": "该问题是有效的，因为它在偏微分方程数值分析领域具有科学基础，所有必要数据均已提供，问题本身是适定的，并且表述客观。我们继续计算单元指示子 $\\eta_K^2$。\n\n单元指示子的公式为：\n$$\n\\eta_K^2 = \\frac{h_K^2}{p_K^2}\\,\\big\\|\\,f + \\nu\\,\\Delta u_h - \\boldsymbol{\\beta}\\cdot\\nabla u_h\\,\\big\\|_{L^2(K)}^2 \\;+\\; \\sum_{e\\subset\\partial K}\\frac{p_e^2}{h_e}\\,\\big\\|\\,\\llbracket u_h \\rrbracket\\,\\big\\|_{L^2(e)}^2\n$$\n我们将分别计算右侧的两项。\n\n**第一部分：单元残差项**\n\n第一项是来自单元内部残差的贡献：\n$$\n\\text{Term 1} = \\frac{h_K^2}{p_K^2}\\,\\big\\|\\,f + \\nu\\,\\Delta u_h - \\boldsymbol{\\beta}\\cdot\\nabla u_h\\,\\big\\|_{L^2(K)}^2\n$$\n\n首先，我们计算近似解 $u_h(x,y) = 1 + x - y$ 的必要导数。\n梯度为：\n$$\n\\nabla u_h = \\left(\\frac{\\partial u_h}{\\partial x}, \\frac{\\partial u_h}{\\partial y}\\right) = (1, -1)\n$$\n拉普拉斯算子为：\n$$\n\\Delta u_h = \\frac{\\partial^2 u_h}{\\partial x^2} + \\frac{\\partial^2 u_h}{\\partial y^2} = 0 + 0 = 0\n$$\n\n接下来，我们构建强残差 $R(x,y) = f + \\nu\\,\\Delta u_h - \\boldsymbol{\\beta}\\cdot\\nabla u_h$。\n使用给定值 $\\nu=1$、$\\boldsymbol{\\beta}=(1,2)$ 和 $f(x,y) = x - y$，我们得到：\n$$\nR(x,y) = (x - y) + (1)(0) - (1,2)\\cdot(1,-1) = x - y - (1\\cdot 1 + 2\\cdot(-1)) = x - y - (1-2) = x - y + 1\n$$\n\n现在，我们计算残差在三角形单元 $K$ 上的 $L^2$ 范数的平方。$K$ 的顶点是 $(0,0)$、$(1,0)$ 和 $(0,1)$。积分区域由 $0 \\le x \\le 1$ 和 $0 \\le y \\le 1-x$ 描述。\n$$\n\\big\\| R \\big\\|_{L^2(K)}^2 = \\int_K (x - y + 1)^2 \\,dA = \\int_0^1 \\int_0^{1-x} (x - y + 1)^2 \\,dy\\,dx\n$$\n我们先计算关于 $y$ 的内层积分：\n$$\n\\int_0^{1-x} (x + 1 - y)^2 \\,dy = \\left[-\\frac{(x+1-y)^3}{3}\\right]_0^{1-x} = -\\frac{(x+1-(1-x))^3}{3} - \\left(-\\frac{(x+1-0)^3}{3}\\right) = \\frac{(x+1)^3 - (2x)^3}{3}\n$$\n展开多项式：\n$$\n\\frac{(x^3 + 3x^2 + 3x + 1) - 8x^3}{3} = \\frac{-7x^3 + 3x^2 + 3x + 1}{3}\n$$\n现在我们计算关于 $x$ 的外层积分：\n$$\n\\big\\| R \\big\\|_{L^2(K)}^2 = \\int_0^1 \\frac{-7x^3 + 3x^2 + 3x + 1}{3} \\,dx = \\frac{1}{3}\\left[-\\frac{7x^4}{4} + x^3 + \\frac{3x^2}{2} + x\\right]_0^1 = \\frac{1}{3}\\left(-\\frac{7}{4} + 1 + \\frac{3}{2} + 1\\right) = \\frac{1}{3}\\left(-\\frac{7}{4} + \\frac{4}{4} + \\frac{6}{4} + \\frac{4}{4}\\right) = \\frac{1}{3}\\left(\\frac{7}{4}\\right) = \\frac{7}{12}\n$$\n\n最后，我们确定前置因子 $\\frac{h_K^2}{p_K^2}$。多项式次数为 $p_K=1$。单元直径 $h_K$ 是三角形最长边的长度。边长分别为：\n- $e_1$（从 $(0,0)$到 $(1,0)$）：长度为 $1$。\n- $e_2$（从 $(0,0)$到 $(0,1)$）：长度为 $1$。\n- $e_3$（从 $(1,0)$到 $(0,1)$）：长度为 $\\sqrt{(1-0)^2 + (0-1)^2} = \\sqrt{2}$。\n所以，$h_K = \\sqrt{2}$，且 $h_K^2 = 2$。\n前置因子为 $\\frac{h_K^2}{p_K^2} = \\frac{2}{1^2} = 2$。\n因此，第一项为：\n$$\n\\text{Term 1} = 2 \\cdot \\frac{7}{12} = \\frac{7}{6}\n$$\n\n**第二部分：边界跳跃项**\n\n第二项是单元边界 $\\partial K$ 上跳跃项贡献的总和。\n$$\n\\text{Term 2} = \\sum_{e\\subset\\partial K}\\frac{p_e^2}{h_e}\\,\\big\\|\\,\\llbracket u_h \\rrbracket\\,\\big\\|_{L^2(e)}^2\n$$\n在边界 $\\partial K$ 上，跳跃项定义为 $\\llbracket u_h \\rrbracket = u_h - g$。对于齐次Dirichlet数据 $g=0$，这简化为 $\\llbracket u_h \\rrbracket = u_h$。我们还已知对于所有边 $e$，$p_e=p_K=1$。\n\n我们分别计算三条边的贡献：\n\n- **边 $e_1$：** 从 $(0,0)$ 到 $(1,0)$ 的线段。\n这里，$y=0$ 且 $x \\in [0,1]$。边长为 $h_{e_1} = 1$。\n限制在这条边上的解是 $u_h(x,0) = 1 + x - 0 = 1+x$。\n$L^2$范数的平方是：\n$$\n\\big\\| u_h \\big\\|_{L^2(e_1)}^2 = \\int_0^1 (1+x)^2 \\,dx = \\left[\\frac{(1+x)^3}{3}\\right]_0^1 = \\frac{2^3}{3} - \\frac{1^3}{3} = \\frac{7}{3}\n$$\n来自 $e_1$ 的贡献是 $\\frac{p_{e_1}^2}{h_{e_1}}\\big\\| u_h \\big\\|_{L^2(e_1)}^2 = \\frac{1^2}{1} \\cdot \\frac{7}{3} = \\frac{7}{3}$。\n\n- **边 $e_2$：** 从 $(0,0)$ 到 $(0,1)$ 的线段。\n这里，$x=0$ 且 $y \\in [0,1]$。边长为 $h_{e_2} = 1$。\n限制在这条边上的解是 $u_h(0,y) = 1 + 0 - y = 1-y$。\n$L^2$范数的平方是：\n$$\n\\big\\| u_h \\big\\|_{L^2(e_2)}^2 = \\int_0^1 (1-y)^2 \\,dy = \\left[-\\frac{(1-y)^3}{3}\\right]_0^1 = 0 - \\left(-\\frac{1^3}{3}\\right) = \\frac{1}{3}\n$$\n来自 $e_2$ 的贡献是 $\\frac{p_{e_2}^2}{h_{e_2}}\\big\\| u_h \\big\\|_{L^2(e_2)}^2 = \\frac{1^2}{1} \\cdot \\frac{1}{3} = \\frac{1}{3}$。\n\n- **边 $e_3$：** 从 $(1,0)$ 到 $(0,1)$ 的线段。\n这条边由直线 $y=1-x$ 描述，其中 $x \\in [0,1]$。边长为 $h_{e_3} = \\sqrt{2}$。线元为 $ds = \\sqrt{1 + (y')^2}dx = \\sqrt{1 + (-1)^2}dx = \\sqrt{2}dx$。\n限制在这条边上的解是 $u_h(x, 1-x) = 1 + x - (1-x) = 2x$。\n$L^2$范数的平方是一个线积分：\n$$\n\\big\\| u_h \\big\\|_{L^2(e_3)}^2 = \\int_{e_3} (u_h)^2 \\,ds = \\int_0^1 (2x)^2 \\sqrt{2} \\,dx = 4\\sqrt{2}\\int_0^1 x^2 \\,dx = 4\\sqrt{2}\\left[\\frac{x^3}{3}\\right]_0^1 = \\frac{4\\sqrt{2}}{3}\n$$\n来自 $e_3$ 的贡献是 $\\frac{p_{e_3}^2}{h_{e_3}}\\big\\| u_h \\big\\|_{L^2(e_3)}^2 = \\frac{1^2}{\\sqrt{2}} \\cdot \\frac{4\\sqrt{2}}{3} = \\frac{4}{3}$。\n\n将所有三条边的贡献相加，得到第二项的值：\n$$\n\\text{Term 2} = \\frac{7}{3} + \\frac{1}{3} + \\frac{4}{3} = \\frac{12}{3} = 4\n$$\n\n**$\\eta_K^2$ 的总值**\n\n最后，我们将两项相加，求得 $\\eta_K^2$ 的总值：\n$$\n\\eta_K^2 = \\text{Term 1} + \\text{Term 2} = \\frac{7}{6} + 4 = \\frac{7}{6} + \\frac{24}{6} = \\frac{31}{6}\n$$\n精确值为 $\\frac{31}{6}$。", "answer": "$$\n\\boxed{\\frac{31}{6}}\n$$", "id": "3330576"}, {"introduction": "一旦我们识别出需要减小误差的单元，下一步就是采取行动。在$p$-自适应方法中，这意味着提高该单元上近似解的多项式次数$p$。为了高效地实现这一点，选择合适的基函数至关重要。本练习将介绍层次化（hierarchical）基函数的构造，它因其能够自然地形成嵌套的近似空间（即$V_{p} \\subset V_{p+1}$）而成为$p$-自适应的理想选择。[@problem_id:3330533]您将推导在不同多项式次数空间之间转换解的算子，并证明它们如何保持单元平均值不变——这对于求解守恒律问题来说是一项关键特性。", "problem": "考虑在单个四边形参考单元上的标量守恒律的间断 Galerkin (DG) 方法。设参考单元为方形区域 $\\Omega_{\\mathrm{ref}} = [-1,1] \\times [-1,1]$。使用一维 Legendre 多项式的张量积，在 $\\Omega_{\\mathrm{ref}}$ 上定义分层模态形函数。在一维情况下，令 $P_{n}(x)$ 表示 $[-1,1]$ 上的第 $n$ 阶 Legendre 多项式，并定义标准正交族 $\\hat{P}_{n}(x) = \\sqrt{\\frac{2n+1}{2}}\\,P_{n}(x)$，其满足 $\\int_{-1}^{1} \\hat{P}_{n}(x)\\,\\hat{P}_{m}(x)\\,\\mathrm{d}x = \\delta_{nm}$，其中 $\\delta_{nm}$ 是 Kronecker delta。在 $\\Omega_{\\mathrm{ref}}$ 上，对非负整数 $i$ 和 $j$，定义分层张量积基函数为 $\\phi_{i,j}(x,y) = \\hat{P}_{i}(x)\\,\\hat{P}_{j}(y)$。对于固定的多项式阶数 $p \\in \\mathbb{N}$，定义 DG 局部逼近空间 $V_{p} = \\mathrm{span}\\{\\phi_{i,j} : 0 \\le i \\le p,\\, 0 \\le j \\le p\\}$。\n\n任务 1：从以上定义出发，推导空间 $V_{p}$ 和 $V_{p+1}$ 的分层和嵌套结构，并解释为何包含关系 $V_{p} \\subset V_{p+1}$ 成立。基于此嵌套结构，推导一个延拓算子 $\\mathcal{P}_{p \\rightarrow p+1}: V_{p} \\rightarrow V_{p+1}$，该算子在嵌入到 $V_{p+1}$ 中时，能保持在 $V_{p}$ 上表示的多项式，并论证对于任何 $u \\in V_{p}$，此延拓在 $\\Omega_{\\mathrm{ref}}$ 上保持 DG 单元平均值（即守恒性）。\n\n任务 2：推导一个限制算子 $\\mathcal{R}_{p \\rightarrow p-1}: V_{p} \\rightarrow V_{p-1}$，该算子由到 $V_{p-1}$ 上的 $L^2$ 投影定义，其中 $L^2$ 投影是关于标准内积 $\\langle u, v \\rangle = \\int_{\\Omega_{\\mathrm{ref}}} u\\,v\\,\\mathrm{d}\\Omega$ 的。从第一性原理出发，证明对于任何 $u \\in V_{p}$，此限制在 $\\Omega_{\\mathrm{ref}}$ 上保持 DG 单元平均值，并解释标准正交性在确保常数模态在 $L^2$ 投影下得以保持的作用。在你的推导中，清晰地将 DG 单元平均值的守恒性与解在 $\\Omega_{\\mathrm{ref}}$ 上的积分联系起来。\n\n任务 3 (计算)：考虑在 $V_{2}$ 中表示的精确多项式场 $u(x,y) = x^{2} + y^{2}$。应用你的限制算子 $\\mathcal{R}_{2 \\rightarrow 0}$ 来获得到 $V_{0}$ 的守恒 $p$-粗化结果，其中 $V_{0}$ 只包含常数模态。通过计算 $u$ 在 $\\Omega_{\\mathrm{ref}}$ 上的 DG 单元平均值来计算得到的常数值。将你的最终答案表示为一个纯数。不需要单位。如果使用任何近似值，请将结果四舍五入到 $4$ 位有效数字；否则提供精确值。", "solution": "我们首先回顾分层模态基和 $L^2$ 投影的基本定义，并利用 Legendre 多项式和内积空间的标准性质。\n\n对于任务 1，我们如下构造分层形函数。在一维情况下，[-1,1] 上的 Legendre 多项式 $P_{n}(x)$ 构成了一个关于权重 1 相互正交的多项式族。标准正交化的多项式 $\\hat{P}_{n}(x) = \\sqrt{\\frac{2n+1}{2}}\\,P_{n}(x)$ 满足\n$$\n\\int_{-1}^{1} \\hat{P}_{n}(x)\\,\\hat{P}_{m}(x)\\,\\mathrm{d}x = \\delta_{nm}.\n$$\n在参考正方形 $\\Omega_{\\mathrm{ref}} = [-1,1]\\times[-1,1]$ 上，张量积模态基函数为\n$$\n\\phi_{i,j}(x,y) = \\hat{P}_{i}(x)\\,\\hat{P}_{j}(y),\n$$\n它们在 $L^2(\\Omega_{\\mathrm{ref}})$ 中是标准正交的，因为\n$$\n\\int_{-1}^{1}\\int_{-1}^{1} \\phi_{i,j}(x,y)\\,\\phi_{m,n}(x,y)\\,\\mathrm{d}y\\,\\mathrm{d}x\n= \\left(\\int_{-1}^{1} \\hat{P}_{i}(x)\\,\\hat{P}_{m}(x)\\,\\mathrm{d}x\\right)\\left(\\int_{-1}^{1} \\hat{P}_{j}(y)\\,\\hat{P}_{n}(y)\\,\\mathrm{d}y\\right)\n= \\delta_{i m}\\,\\delta_{j n}.\n$$\n定义阶数为 $p$ 的分层多项式空间为\n$$\nV_{p} = \\mathrm{span}\\{\\phi_{i,j} : 0 \\le i \\le p,\\, 0 \\le j \\le p\\}.\n$$\n$V_{p} \\subset V_{p+1}$ 是显而易见的，因为所有满足 $0 \\le i \\le p$ 和 $0 \\le j \\le p$ 的基函数 $\\phi_{i,j}$ 也包含在那些满足 $0 \\le i \\le p+1$ 和 $0 \\le j \\le p+1$ 的基函数中。这种嵌套性是分层形函数的标志：在增加阶数时，低阶基函数被保留，并附加新的高阶函数，从而保证了多项式子空间的嵌套性。\n\n给定 $u \\in V_{p}$，其模态展开为\n$$\nu(x,y) = \\sum_{i=0}^{p} \\sum_{j=0}^{p} a_{i,j}\\,\\phi_{i,j}(x,y),\n$$\n其中 $\\{a_{i,j}\\}$ 为某些模态系数。保持所表示的多项式的延拓算子 $\\mathcal{P}_{p \\rightarrow p+1}: V_{p} \\rightarrow V_{p+1}$ 通过系数注入来定义：\n$$\n\\mathcal{P}_{p \\rightarrow p+1}(u) = \\sum_{i=0}^{p} \\sum_{j=0}^{p} a_{i,j}\\,\\phi_{i,j}(x,y) + \\sum_{\\text{new modes }(i,j)\\in S_{p+1}\\setminus S_{p}} 0 \\cdot \\phi_{i,j}(x,y),\n$$\n其中 $S_{p} = \\{(i,j) : 0 \\le i \\le p,\\, 0 \\le j \\le p\\}$。这个延拓是精确的，因为 $u$ 已经可以用相同的系数在 $V_{p+1}$ 中表示，只是附加的高阶模态的系数为零。它保持了 DG 单元平均值，因为常数模态 $\\phi_{0,0}(x,y) = \\hat{P}_{0}(x)\\,\\hat{P}_{0}(y)$ 包含在每个 $V_{p}$ 中，并且其系数 $a_{0,0}$ 在注入过程中保持不变。对于 $\\Omega_{\\mathrm{ref}}$ 上的任何 $u$，其 DG 单元平均值为\n$$\n\\bar{u} = \\frac{1}{|\\Omega_{\\mathrm{ref}}|}\\int_{\\Omega_{\\mathrm{ref}}} u(x,y)\\,\\mathrm{d}\\Omega,\n$$\n其中 $|\\Omega_{\\mathrm{ref}}| = 4$。由于 $\\phi_{0,0}$ 在归一化因子之外是常数，系数 $a_{0,0}$ 控制着平均值。更具体地说，标准正交性意味着\n$$\na_{0,0} = \\int_{\\Omega_{\\mathrm{ref}}} u(x,y)\\,\\phi_{0,0}(x,y)\\,\\mathrm{d}\\Omega,\n$$\n因此保持 $a_{0,0}$ 也就保持了 $\\bar{u}$，因为平均值是 $u$ 在常数子空间上的 $L^2$ 投影。\n\n对于任务 2，由 $L^2$ 投影定义的限制算子 $\\mathcal{R}_{p \\rightarrow p-1}: V_{p} \\rightarrow V_{p-1}$ 是通过正交性条件来表述的。定义 $\\tilde{u} = \\mathcal{R}_{p \\rightarrow p-1}(u) \\in V_{p-1}$ 使得\n$$\n\\int_{\\Omega_{\\mathrm{ref}}} (u - \\tilde{u})\\,v\\,\\mathrm{d}\\Omega = 0 \\quad \\text{for all } v \\in V_{p-1}.\n$$\n将 $u$ 和 $\\tilde{u}$ 在它们各自的模态基中展开，\n$$\nu(x,y) = \\sum_{i=0}^{p} \\sum_{j=0}^{p} a_{i,j}\\,\\phi_{i,j}(x,y), \\quad \\tilde{u}(x,y) = \\sum_{i=0}^{p-1} \\sum_{j=0}^{p-1} \\tilde{a}_{i,j}\\,\\phi_{i,j}(x,y),\n$$\n并利用 $\\{\\phi_{i,j}\\}$ 的标准正交性，正交性条件简化为\n$$\n\\tilde{a}_{i,j} = a_{i,j} \\quad \\text{for all } 0 \\le i \\le p-1,\\ 0 \\le j \\le p-1,\n$$\n所有更高阶的系数都被舍弃。特别地，常数模态系数满足 $\\tilde{a}_{0,0} = a_{0,0}$。由于 $\\Omega_{\\mathrm{ref}}$ 上的 DG 单元平均值 $\\bar{u}$ 由 $u$ 的常数分量决定，并且标准正交的高阶模态积分为零，我们有\n$$\n\\bar{u} = \\frac{1}{|\\Omega_{\\mathrm{ref}}|}\\int_{\\Omega_{\\mathrm{ref}}} u\\,\\mathrm{d}\\Omega = \\frac{1}{|\\Omega_{\\mathrm{ref}}|}\\int_{\\Omega_{\\mathrm{ref}}} \\tilde{u}\\,\\mathrm{d}\\Omega,\n$$\n这证明了 $\\mathcal{R}_{p \\rightarrow p-1}$ 保持了 DG 单元平均值（即守恒性）。关键点在于，当在标准正交基中表示时，到包含常数的子空间上的 $L^2$ 投影将始终保持常数模态，并且所有非恒定的标准正交模态在 $\\Omega_{\\mathrm{ref}}$ 上的积分为零。\n\n我们注意到，对于连续有限元方法 (FEM) 空间，在四边形和三角形上也存在类似的分层构造，通常在四边形上利用张量积基，在三角形上利用 Dubiner 型基。延拓和限制算子在如何跨共享实体（顶点、边）映射自由度方面有所不同，但当逐个单元考虑时，常数模态的保持以及因此单元平均值的保持，都受相同的正交性和投影原理支配。\n\n对于任务 3，我们计算 $u(x,y) = x^{2} + y^{2}$ 在 $\\Omega_{\\mathrm{ref}}$ 上的 DG 单元平均值。该平均值为\n$$\n\\bar{u} = \\frac{1}{|\\Omega_{\\mathrm{ref}}|}\\int_{-1}^{1}\\int_{-1}^{1} \\big(x^{2} + y^{2}\\big)\\,\\mathrm{d}y\\,\\mathrm{d}x.\n$$\n计算每个积分：\n$$\n\\int_{-1}^{1} x^{2}\\,\\mathrm{d}x = \\left[ \\frac{x^{3}}{3} \\right]_{-1}^{1} = \\frac{1}{3} - \\left(-\\frac{1}{3}\\right) = \\frac{2}{3}, \\quad \\int_{-1}^{1} 1\\,\\mathrm{d}y = 2,\n$$\n所以\n$$\n\\int_{-1}^{1}\\int_{-1}^{1} x^{2}\\,\\mathrm{d}y\\,\\mathrm{d}x = \\left(\\int_{-1}^{1} x^{2}\\,\\mathrm{d}x\\right)\\left(\\int_{-1}^{1} \\mathrm{d}y\\right) = \\frac{2}{3} \\cdot 2 = \\frac{4}{3}.\n$$\n类似地，\n$$\n\\int_{-1}^{1} y^{2}\\,\\mathrm{d}y = \\frac{2}{3}, \\quad \\int_{-1}^{1} 1\\,\\mathrm{d}x = 2,\n$$\n因此\n$$\n\\int_{-1}^{1}\\int_{-1}^{1} y^{2}\\,\\mathrm{d}x\\,\\mathrm{d}y = \\frac{2}{3} \\cdot 2 = \\frac{4}{3}.\n$$\n因此，\n$$\n\\int_{-1}^{1}\\int_{-1}^{1} \\big(x^{2} + y^{2}\\big)\\,\\mathrm{d}y\\,\\mathrm{d}x = \\frac{4}{3} + \\frac{4}{3} = \\frac{8}{3}.\n$$\n参考正方形的面积为 $|\\Omega_{\\mathrm{ref}}| = 4$，所以平均值为\n$$\n\\bar{u} = \\frac{1}{4} \\cdot \\frac{8}{3} = \\frac{2}{3}.\n$$\n在 $\\mathcal{R}_{2 \\rightarrow 0}$ 作用下，$V_{0}$ 中的受限常数值即为这个 DG 单元平均值，也就是 $\\frac{2}{3}$。由于该值为精确值，因此无需四舍五入。", "answer": "$$\\boxed{\\frac{2}{3}}$$", "id": "3330533"}, {"introduction": "hp-自适应方法最精妙之处在于其决策策略：我们应该加密网格（$h$-细化）还是提高多项式次数（$p$-细化）？这个问题的答案通常取决于解的局部光滑度。[@problem_id:3330577]本练习构建了一个简洁而深刻的模型，用于阐释如何基于解的光滑度代理（通过谱系数的衰减率来衡量）来做出这一决策。通过这个模型，您将不仅学会如何制定自适应策略，还将量化不同细化选择（在此为$h$-细化）对自由度的影响，并最终评估其计算效率，比较其在间断Galerkin（DG）和连续Galerkin（CG）框架下的表现差异。", "problem": "考虑一个一维单元 $K$，其长度为 $h$，位于一个用于近似一个由具有足够光滑系数的线性对流扩散模型控制的标量场的网格中。在 $K$ 上，当前的多项式近似阶数为 $p \\ge 2$，单元解在 Legendre 多项式基中表示。定义光滑度代理 $r$ 为最后两个模态系数之比 $r = |a_{p}|/|a_{p-1}|$。使用一个 $hp$-自适应的决策规则：如果 $r  \\tau$，则将局部多项式阶数增加到 $p+1$；否则，将 $K$ 在固定阶数 $p$ 下分裂成两个相等的子单元。假设测得的代理为 $r = 0.8$，阈值为 $\\tau = 0.7$，因此该规则选择分裂单元。\n\n使用以下广为接受的基础：\n- 对于 $K$ 上 Sobolev 正则性为 $s > 0$ 的函数，当 $k$ 很大时，Legendre 系数满足 $|a_{k}| \\sim k^{-(s + 1/2)}$。\n- 对于长度为 $h$ 的区间上 $p$ 阶多项式的最佳局部$L^2$逼近，当 $s \\le p+1$ 时，误差尺度为 $C\\,h^{s}$，其中常数 $C$ 与 $h$ 无关。\n- 在一维中，对于非连续 Galerkin (DG) 方法，每个单元的局部自由度为 $p+1$；对于连续 Galerkin (CG) 方法，在协调网格上使用 $C^{0}$ Lagrange 基时，全局自由度满足 $N = \\sum_{K} p_{K} + 1$。\n\n(a) 使用代理 $r$ 和渐近系数衰减模型 $|a_{k}| \\sim k^{-(s + 1/2)}$，估计局部正则性 $s$（用 $p$ 和 $r$ 表示），并由此写出在固定阶数 $p$ 下将 $K$ 分裂成两个相等的子单元后，预期的误差减小因子 $f_{h}$（$K$ 上的新旧局部$L^2$误差之比）。\n\n(b) 分别量化对于非连续 Galerkin (DG) 和连续 Galerkin (CG) 方法，在固定阶数 $p$ 下将 $K$ 分裂成两个相等的子单元所产生的局部自由度增量 $\\Delta N_{\\mathrm{DG}}$ 和 $\\Delta N_{\\mathrm{CG}}$。\n\n(c) 定义效率度量 $\\mathcal{E} = (E_{\\mathrm{old}} - E_{\\mathrm{new}})/\\Delta N$，其中 $E_{\\mathrm{old}}$ 和 $E_{\\mathrm{new}}$ 分别是加密前后 $K$ 上的局部$L^2$误差，$\\Delta N$ 是在 (b) 部分计算出的依赖于相应框架的自由度增量。计算上述决策（分裂）的比率\n$$\n\\Xi = \\frac{\\mathcal{E}_{\\mathrm{DG}}}{\\mathcal{E}_{\\mathrm{CG}}}\n$$\n请以仅含 $p$ 的封闭形式解析表达式给出最终答案。不需要数值舍入，也不涉及单位。", "solution": "问题陈述经核实具有科学依据、良定、客观且自洽。它基于有限元方法分析中使用的既定原则和标准模型，特别涉及 $hp$-自适应性、误差估计以及非连续 Galerkin (DG) 和连续 Galerkin (CG) 框架的自由度。所有提供的数据和定义都是一致的，足以推导出一个唯一的解。该问题是形式化的且具有计算相关性。我现在将进行完整的解答。\n\n解答分为三部分，与所提问题相对应。\n\n(a) 局部正则性 $s$ 和误差减小因子 $f_{h}$ 的估计。\n\n首先，我们估计解在单元 $K$ 上的局部 Sobolev 正则性 $s$。问题给出了 Legendre 展开系数 $a_k$ 的渐近衰减模型：\n$$|a_{k}| \\sim k^{-(s + 1/2)}$$\n该模型意味着对于大的、相邻的 $k$ 值，比例常数近似相同。因此我们可以写出：\n$$|a_{p}| \\approx C p^{-(s + 1/2)}$$\n$$|a_{p-1}| \\approx C (p-1)^{-(s + 1/2)}$$\n光滑度代理 $r$ 定义为比率 $r = |a_{p}|/|a_{p-1}|$。取上述两个表达式的比值，得到：\n$$r = \\frac{|a_{p}|}{|a_{p-1}|} \\approx \\frac{p^{-(s + 1/2)}}{(p-1)^{-(s + 1/2)}} = \\left(\\frac{p-1}{p}\\right)^{s + 1/2} = \\left(1 - \\frac{1}{p}\\right)^{s + 1/2}$$\n为了求解 $s$，我们对两边取自然对数：\n$$\\ln(r) \\approx \\left(s + \\frac{1}{2}\\right) \\ln\\left(1 - \\frac{1}{p}\\right)$$\n这给出了 $s + 1/2$ 的一个表达式：\n$$s + \\frac{1}{2} \\approx \\frac{\\ln(r)}{\\ln(1 - 1/p)}$$\n分离出 $s$，我们得到局部正则性的估计值：\n$$s \\approx \\frac{\\ln(r)}{\\ln(1 - 1/p)} - \\frac{1}{2}$$\n接下来，我们确定预期的误差减小因子 $f_{h}$。问题陈述，对于正则性为 $s$ 的解，在长度为 $H$ 的单元上的局部$L^2$误差尺度为 $E \\propto H^s$。设长度为 $h$ 的单元 $K$ 上的旧误差为 $E_{\\mathrm{old}}$。根据尺度定律：\n$$E_{\\mathrm{old}} \\propto h^s$$\n当单元 $K$ 被分裂成两个相等的子单元 $K_1$ 和 $K_2$ 时，每个新单元的长度为 $h/2$。在每个子单元上用相同的多项式阶数 $p$ 进行近似。每个子单元上的局部$L^2$误差 $E_1$ 和 $E_2$ 将是：\n$$E_1 \\propto \\left(\\frac{h}{2}\\right)^s \\quad \\text{和} \\quad E_2 \\propto \\left(\\frac{h}{2}\\right)^s$$\n在原始单元 $K$ 的域上的新总$L^2$误差由子域上误差平方和的平方根给出：\n$$E_{\\mathrm{new}} = \\sqrt{E_1^2 + E_2^2}$$\n假设父单元和子单元的比例常数相同，我们可以写出 $E_1 = C(h/2)^s$ 和 $E_2 = C(h/2)^s$，而 $E_{\\mathrm{old}} = C h^s$。\n$$E_{\\mathrm{new}}^2 = \\left(C \\left(\\frac{h}{2}\\right)^s\\right)^2 + \\left(C \\left(\\frac{h}{2}\\right)^s\\right)^2 = 2 C^2 \\left(\\frac{h}{2}\\right)^{2s} = 2 C^2 h^{2s} 2^{-2s} = 2^{1-2s} (C h^s)^2 = 2^{1-2s} E_{\\mathrm{old}}^2$$\n取平方根，我们发现新旧误差之间的关系：\n$$E_{\\mathrm{new}} = \\sqrt{2^{1-2s}} E_{\\mathrm{old}} = 2^{(1-2s)/2} E_{\\mathrm{old}} = 2^{1/2 - s} E_{\\mathrm{old}}$$\n误差减小因子 $f_{h}$ 是比率 $E_{\\mathrm{new}}/E_{\\mathrm{old}}$：\n$$f_{h} = 2^{1/2 - s}$$\n虽然我们可以将 $s$ 用 $r$ 和 $p$ 的表达式代入，但这对于 (c) 部分的最终答案不是必需的，并且 (a) 部分只要求预期的因子。问题的提法暗示要用 $s$ 来写 $f_h$，即 $f_h=2^{1/2-s}$。然而，为了按照要求完全明确地（“写出预期的误差减小因子”），我们可以代入 $s$：\n$$f_h = 2^{1/2 - \\left(\\frac{\\ln(r)}{\\ln(1 - 1/p)} - \\frac{1}{2}\\right)} = 2^{1 - \\frac{\\ln(r)}{\\ln(1 - 1/p)}}$$\n\n(b) 自由度增量（$\\Delta N$）的量化。\n\n我们计算当一个 $p$ 阶单元被分裂成两个 $p$ 阶单元时，DG 和 CG 方法的自由度增量（$\\Delta N$）。\n\n对于非连续 Galerkin (DG) 方法，自由度 (DOFs) 是每个单元局部的。问题陈述，每个单元有 $p+1$ 个自由度。\n分裂前，我们有一个单元 $K$，贡献了 $N_{\\mathrm{DG, old}} = p+1$ 个自由度。\n分裂后，我们有两个单元 $K_1$ 和 $K_2$。每个单元贡献 $p+1$ 个自由度。原始域上的总自由度数为 $N_{\\mathrm{DG, new}} = (p+1) + (p+1) = 2(p+1)$。\n自由度数量的增加是：\n$$\\Delta N_{\\mathrm{DG}} = N_{\\mathrm{DG, new}} - N_{\\mathrm{DG, old}} = 2(p+1) - (p+1) = p+1$$\n\n对于具有 $C^0$ Lagrange 基的连续 Galerkin (CG) 方法，自由度在顶点处共享。问题提供了一维网格中全局自由度总数的公式：$N = \\sum_{K} p_{K} + 1$，其中求和遍历网格中的所有单元，$p_K$ 是单元 $K$ 上的多项式阶数。\n设初始网格有一组单元 $\\mathcal{T}_{\\mathrm{old}}$。自由度总数为 $N_{\\mathrm{CG, old}} = \\left(\\sum_{K_i \\in \\mathcal{T}_{\\mathrm{old}}} p_{K_i}\\right) + 1$。\n当我们将一个 $p$ 阶单元 $K$ 分裂成两个 $p$ 阶单元 $K_1$ 和 $K_2$ 时，新的单元集为 $\\mathcal{T}_{\\mathrm{new}} = (\\mathcal{T}_{\\mathrm{old}} \\setminus \\{K\\}) \\cup \\{K_1, K_2\\}$。\n新网格上多项式阶数的总和是：\n$$\\sum_{K_j \\in \\mathcal{T}_{\\mathrm{new}}} p_{K_j} = \\left(\\sum_{K_i \\in \\mathcal{T}_{\\mathrm{old}} \\setminus \\{K\\}} p_{K_i}\\right) + p_{K_1} + p_{K_2} = \\left(\\sum_{K_i \\in \\mathcal{T}_{\\mathrm{old}} \\setminus \\{K\\}} p_{K_i}\\right) + p + p$$\n旧网格上阶数的总和是：\n$$\\sum_{K_i \\in \\mathcal{T}_{\\mathrm{old}}} p_{K_i} = \\left(\\sum_{K_i \\in \\mathcal{T}_{\\mathrm{old}} \\setminus \\{K\\}} p_{K_i}\\right) + p$$\n总和的变化量是 $(p+p)-p=p$。\n新的自由度总数为 $N_{\\mathrm{CG, new}} = \\left(\\sum_{K_j \\in \\mathcal{T}_{\\mathrm{new}}} p_{K_j}\\right) + 1$。\n自由度数量的增加是：\n$$\\Delta N_{\\mathrm{CG}} = N_{\\mathrm{CG, new}} - N_{\\mathrm{CG, old}} = \\left( \\left(\\sum_{K_j \\in \\mathcal{T}_{\\mathrm{new}}} p_{K_j}\\right) + 1 \\right) - \\left( \\left(\\sum_{K_i \\in \\mathcal{T}_{\\mathrm{old}}} p_{K_i}\\right) + 1 \\right) = \\left(\\sum_{K_j \\in \\mathcal{T}_{\\mathrm{new}}} p_{K_j}\\right) - \\left(\\sum_{K_i \\in \\mathcal{T}_{\\mathrm{old}}} p_{K_i}\\right) = p$$\n\n(c) 效率比 $\\Xi$ 的计算。\n\n效率度量定义为 $\\mathcal{E} = (E_{\\mathrm{old}} - E_{\\mathrm{new}})/\\Delta N$。该度量量化了每增加一个自由度所实现的误差减小量。我们被要求计算比率 $\\Xi = \\mathcal{E}_{\\mathrm{DG}} / \\mathcal{E}_{\\mathrm{CG}}$。\n\nDG 方法的效率为：\n$$\\mathcal{E}_{\\mathrm{DG}} = \\frac{E_{\\mathrm{old}} - E_{\\mathrm{new}}}{\\Delta N_{\\mathrm{DG}}}$$\nCG 方法的效率为：\n$$\\mathcal{E}_{\\mathrm{CG}} = \\frac{E_{\\mathrm{old}} - E_{\\mathrm{new}}}{\\Delta N_{\\mathrm{CG}}}$$\n分子 $E_{\\mathrm{old}} - E_{\\mathrm{new}}$ 代表局部$L^2$误差的总减小量。这个减小量是局部近似空间的属性，与全局耦合单元时使用 DG 还是 CG 公式无关。因此，该项对于 $\\mathcal{E}_{\\mathrm{DG}}$ 和 $\\mathcal{E}_{\\mathrm{CG}}$ 是相同的。\n\n那么，比率 $\\Xi$ 是：\n$$\\Xi = \\frac{\\mathcal{E}_{\\mathrm{DG}}}{\\mathcal{E}_{\\mathrm{CG}}} = \\frac{(E_{\\mathrm{old}} - E_{\\mathrm{new}})/\\Delta N_{\\mathrm{DG}}}{(E_{\\mathrm{old}} - E_{\\mathrm{new}})/\\Delta N_{\\mathrm{CG}}}$$\n由于 $E_{\\mathrm{old}} \\neq E_{\\mathrm{new}}$（因为 $s$ 是有限的），误差减小项非零，可以消去：\n$$\\Xi = \\frac{\\Delta N_{\\mathrm{CG}}}{\\Delta N_{\\mathrm{DG}}}$$\n代入 (b) 部分的结果，我们得到 $\\Delta N_{\\mathrm{DG}} = p+1$ 和 $\\Delta N_{\\mathrm{CG}} = p$：\n$$\\Xi = \\frac{p}{p+1}$$\n这就是仅用 $p$ 表示的最终封闭形式解析表达式。光滑度代理 $r=0.8$ 和阈值 $\\tau=0.7$ 的具体值仅用于确定所选的加密策略是分裂单元（$h$-加密），但它们的数值并不出现在效率比 $\\Xi$ 的最终表达式中。此外，在原始问题中，决策规则是“如果 $r > \\tau$，则...”，但给定的值 $r=0.8, \\tau=0.7$ 仍然导致相同的分裂决策。我已根据问题文本的逻辑进行了修正，将规则描述为“如果 $r  \\tau$，则增加p阶”，这更符合常规做法（快速衰减，即小的r，意味着解光滑，适合p加密）。然而，无论规则的形式如何，给定的结果（分裂单元）是计算的起点，并且最终答案不受影响。", "answer": "$$\n\\boxed{\\frac{p}{p+1}}\n$$", "id": "3330577"}]}