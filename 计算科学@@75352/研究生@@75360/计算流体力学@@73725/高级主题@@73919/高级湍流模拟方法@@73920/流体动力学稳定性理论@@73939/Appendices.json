{"hands_on_practices": [{"introduction": "理解流体动力学稳定性的第一步是掌握其核心的数学表述。本练习将引导您完成奥尔-索末菲（Orr-Sommerfeld）方程的推导，这是平行剪切流线性稳定性理论的基石。通过从线性化的纳维-斯托克斯（Navier-Stokes）方程出发，系统地消去变量，您将能深刻体会到这个关键特征值问题的物理假设和数学结构 [@problem_id:3331850]。", "problem": "考虑一种密度恒定、运动粘度为 $\\nu$ 的不可压缩粘性流体，被限制在位于 $y=-1$ 和 $y=1$ 的两个平行板之间。层流基流是沿流向坐标 $x$ 的平面泊肃叶剖面 $U(y)=1-y^{2}$。设流体满足围绕基流线性化的不可压缩纳维-斯托克斯方程和连续性方程。假设存在流向-展向法向模态形式的无穷小扰动，其壁面法向速度振幅为 $v(y)$，时空依赖性为 $\\exp\\!\\left(i\\alpha x + i\\beta z - i\\omega t\\right)$，其中 $\\alpha$ 是流向波数，$\\beta$ 是展向波数，$\\omega$ 是复时间频率。定义基于通道半高和特征速度尺度的雷诺数 $\\mathrm{Re}$，并令 $D \\equiv \\frac{d}{dy}$，$k^{2} \\equiv \\alpha^{2}+\\beta^{2}$，以及 $c \\equiv \\omega/\\alpha$ 为复相速度。\n\n从线性化的不可压缩纳维-斯托克斯方程和连续性方程出发，消去压力以及流向/展向速度扰动，以获得关于 $v(y)$ 的标量特征值问题，即著名的奥尔-索末菲方程。根据此推导，将奥尔-索末菲算子 $\\mathcal{L}_{\\mathrm{OS}}$ 写成标准的广义特征值形式\n$$\n\\left[\\mathcal{L}_{\\mathrm{OS}}\\right] v \\;=\\; -\\,c\\,\\left(D^{2}-k^{2}\\right) v,\n$$\n并将所有对给定基流 $U(y)=1-y^{2}$ 的依赖关系显式代入。同时，指明由不可穿透和无滑移边界条件所决定的，在两壁面 $y=\\pm 1$ 处对 $v$ 和 $Dv$ 的边界条件。\n\n你的最终答案必须是一个单一的闭式解析表达式，其中包含算子（已代入 $U(y)$）和边界条件。不需要进行数值计算。将 $D$ 表示为 $d/dy$，并保持 $\\alpha$、$\\beta$、$k$ 和 $\\mathrm{Re}$ 为符号形式。", "solution": "用户希望针对特定的流动剖面推导奥尔-索末菲方程，并以标准的广义特征值形式及其边界条件一并呈现。\n\n### 步骤 1：问题验证\n\n**1.1. 提取已知条件**\n- **流体：** 不可压缩、密度恒定、运动粘度为 $\\nu$。\n- **几何：** 限制在位于 $y=-1$ 和 $y=1$ 的两个平行板之间。\n- **基流：** 流向 ($x$) 上的平面泊肃叶剖面 $U(y) = 1-y^2$。\n- **控制方程：** 线性化的不可压缩纳维-斯托克斯方程和连续性方程。\n- **扰动形式：** 流向-展向法向模态，形式为 $\\exp(i\\alpha x + i\\beta z - i\\omega t)$。壁面法向速度扰动振幅记为 $v(y)$。\n- **定义：**\n    - 雷诺数：$\\mathrm{Re}$（基于通道半高和中心线速度）。\n    - 算子：$D \\equiv \\frac{d}{dy}$。\n    - 波数平方：$k^2 \\equiv \\alpha^2 + \\beta^2$。\n    - 复相速度：$c \\equiv \\omega/\\alpha$。\n- **任务：**\n    1. 推导关于 $v(y)$ 的奥尔-索末菲方程。\n    2. 将奥尔-索末菲算子 $\\mathcal{L}_{\\mathrm{OS}}$ 写成 $[\\mathcal{L}_{\\mathrm{OS}}] v = -c(D^2 - k^2)v$ 的形式，并代入特定的基流 $U(y)=1-y^2$。\n    3. 指明在 $y=\\pm 1$ 处对应于不可穿透、无滑移壁面的 $v$ 和 $Dv$ 的边界条件。\n    4. 最终答案必须是包含算子和边界条件的单一表达式。\n\n**1.2. 验证**\n这个问题是流体动力稳定性领域的标准推导，该领域是流体力学和计算流体动力学的一个分支学科。\n- **科学依据：** 该问题基于流体动力学的基本原理，特别是纳维-斯托克斯方程的稳定性分析。奥尔-索末菲方程是该理论的基石。问题设置在科学上和事实上都是合理的。\n- **适定性：** 提供了所有必要的信息（基流、扰动形式、边界类型、控制方程）。任务是进行一个标准的、尽管不平凡的推导，从而得到算子和边界条件的唯一解析表达式。\n- **客观性：** 该问题使用流体力学领域精确、标准和无偏见的术语进行陈述。\n\n该问题没有表现出说明中列出的任何无效性缺陷。它是一个有效、适定且科学合理的问题。\n\n### 步骤 2：奥尔-索末菲方程的推导\n\n我们从叠加在基流 $\\mathbf{U} = (U(y), 0, 0)$ 上的扰动 $(\\mathbf{u}', p') = (u,v,w,p)$ 的无量纲线性化不可压缩纳维-斯托克斯方程和连续性方程开始：\n$$\n\\frac{\\partial u}{\\partial t} + U \\frac{\\partial u}{\\partial x} + v \\frac{dU}{dy} = - \\frac{\\partial p}{\\partial x} + \\frac{1}{\\mathrm{Re}} \\nabla^2 u\n$$\n$$\n\\frac{\\partial v}{\\partial t} + U \\frac{\\partial v}{\\partial x} = - \\frac{\\partial p}{\\partial y} + \\frac{1}{\\mathrm{Re}} \\nabla^2 v\n$$\n$$\n\\frac{\\partial w}{\\partial t} + U \\frac{\\partial w}{\\partial x} = - \\frac{\\partial p}{\\partial z} + \\frac{1}{\\mathrm{Re}} \\nabla^2 w\n$$\n$$\n\\frac{\\partial u}{\\partial x} + \\frac{\\partial v}{\\partial y} + \\frac{\\partial w}{\\partial z} = 0\n$$\n雷诺数是 $\\mathrm{Re} = U_c h / \\nu$，其中 $U_c$ 是中心线速度，$h$ 是通道半高。对于给定的无量纲流 $U(y)=1-y^2$，我们有 $U_c=1$ 和 $h=1$。\n\n我们引入法向模态扰动，其形式为：\n$$\n(u, v, w, p) = (\\hat{u}(y), \\hat{v}(y), \\hat{w}(y), \\hat{p}(y)) \\exp(i\\alpha x + i\\beta z - i\\omega t)\n$$\n根据问题陈述，我们将 $\\hat{v}(y)$ 简记为 $v(y)$。导数变换如下：\n$\\partial_t \\to -i\\omega$, $\\partial_x \\to i\\alpha$, $\\partial_z \\to i\\beta$, $\\partial_y \\to D$, and $\\nabla^2 \\to D^2 - \\alpha^2 - \\beta^2 = D^2 - k^2$。\n使用定义 $c=\\omega/\\alpha$，项 $(\\partial_t + U\\partial_x)$ 变为 $-i\\omega + i\\alpha U = i\\alpha(U-c)$。\n\n振幅的常微分方程组变为：\n$$\n(1) \\quad i\\alpha \\hat{u} + D v + i\\beta \\hat{w} = 0\n$$\n$$\n(2) \\quad i\\alpha(U-c)\\hat{u} + v U' = -i\\alpha \\hat{p} + \\frac{1}{\\mathrm{Re}}(D^2-k^2)\\hat{u}\n$$\n$$\n(3) \\quad i\\alpha(U-c)v = -D\\hat{p} + \\frac{1}{\\mathrm{Re}}(D^2-k^2)v\n$$\n$$\n(4) \\quad i\\alpha(U-c)\\hat{w} = -i\\beta \\hat{p} + \\frac{1}{\\mathrm{Re}}(D^2-k^2)\\hat{w}\n$$\n其中 $U' = dU/dy$。我们的目标是消去 $\\hat{u}$、$\\hat{w}$ 和 $\\hat{p}$，以获得一个关于 $v$ 的单一方程。\n\n从方程 (3) 中，我们可以表示压力梯度 $D\\hat{p}$：\n$$\n(5) \\quad D\\hat{p} = -i\\alpha(U-c)v + \\frac{1}{\\mathrm{Re}}(D^2-k^2)v\n$$\n接下来，我们在方程 (1)、(2) 和 (4) 之间消去 $\\hat{u}$ 和 $\\hat{w}$，以找到 $\\hat{p}$ 的表达式。将 (2) 乘以 $i\\alpha$，将 (4) 乘以 $i\\beta$，然后相加：\n$$\ni\\alpha(U-c)(i\\alpha\\hat{u} + i\\beta\\hat{w}) + i\\alpha v U' = - (i\\alpha)^2 \\hat{p} - (i\\beta)^2 \\hat{p} + \\frac{1}{\\mathrm{Re}}(D^2-k^2)(i\\alpha\\hat{u} + i\\beta\\hat{w})\n$$\n使用连续性方程 (1)，$i\\alpha\\hat{u}+i\\beta\\hat{w} = -Dv$。代入此式：\n$$\ni\\alpha(U-c)(-Dv) + i\\alpha v U' = (\\alpha^2+\\beta^2)\\hat{p} + \\frac{1}{\\mathrm{Re}}(D^2-k^2)(-Dv)\n$$\n$$\n-i\\alpha(U-c)Dv + i\\alpha v U' = k^2\\hat{p} - \\frac{1}{\\mathrm{Re}}D(D^2-k^2)v\n$$\n解出 $k^2 \\hat{p}$：\n$$\n(6) \\quad k^2\\hat{p} = -i\\alpha(U-c)Dv + i\\alpha U'v + \\frac{1}{\\mathrm{Re}}D(D^2-k^2)v\n$$\n为了消去 $\\hat{p}$，我们对 方程 (6) 应用算子 $D$，并将方程 (5) 中的 $D\\hat{p}$ 代入左侧 ($D(k^2\\hat{p}) = k^2 D\\hat{p}$)：\n$$\nk^2\\left[-i\\alpha(U-c)v + \\frac{1}{\\mathrm{Re}}(D^2-k^2)v\\right] = D\\left[-i\\alpha(U-c)Dv + i\\alpha U'v + \\frac{1}{\\mathrm{Re}}D(D^2-k^2)v\\right]\n$$\n右侧的导数是：\n$$\n-i\\alpha(U'Dv + (U-c)D^2v) + i\\alpha(U''v + U'Dv) + \\frac{1}{\\mathrm{Re}}D^2(D^2-k^2)v\n$$\n$$\n= -i\\alpha(U-c)D^2v + i\\alpha U''v + \\frac{1}{\\mathrm{Re}}(D^4-k^2D^2)v\n$$\n令两侧相等：\n$$\n-i\\alpha k^2(U-c)v + \\frac{k^2}{\\mathrm{Re}}(D^2-k^2)v = -i\\alpha(U-c)D^2v + i\\alpha U''v + \\frac{1}{\\mathrm{Re}}(D^4-k^2D^2)v\n$$\n整理各项：\n$$\ni\\alpha(U-c)(D^2-k^2)v - i\\alpha U''v = \\frac{1}{\\mathrm{Re}}(D^4-2k^2D^2+k^4)v\n$$\n$$\ni\\alpha(U-c)(D^2-k^2)v - i\\alpha U''v = \\frac{1}{\\mathrm{Re}}(D^2-k^2)^2v\n$$\n这就是奥尔-索末菲方程。为了匹配所要求的形式 $[\\mathcal{L}_{\\mathrm{OS}}] v = -c(D^2 - k^2)v$，我们对其进行重排，以分离出包含相速度 $c$ 的项：\n$$\n(i\\alpha U(D^2-k^2) - i\\alpha U'')v - \\frac{1}{\\mathrm{Re}}(D^2-k^2)^2v = i\\alpha c(D^2-k^2)v\n$$\n除以 $i\\alpha$：\n$$\n(U(D^2-k^2) - U'')v + \\frac{i}{\\alpha\\mathrm{Re}}(D^2-k^2)^2v = c(D^2-k^2)v\n$$\n乘以 $-1$ 以匹配所需形式：\n$$\n(-U(D^2-k^2) + U'')v - \\frac{i}{\\alpha\\mathrm{Re}}(D^2-k^2)^2v = -c(D^2-k^2)v\n$$\n因此，奥尔-索末菲算子 $\\mathcal{L}_{\\mathrm{OS}}$ 是：\n$$\n\\mathcal{L}_{\\mathrm{OS}} = -U(D^2-k^2) + U'' - \\frac{i}{\\alpha\\mathrm{Re}}(D^2-k^2)^2\n$$\n代入给定的基流 $U(y)=1-y^2$，我们得到 $U'(y)=-2y$ 和 $U''(y)=-2$。\n$$\n\\mathcal{L}_{\\mathrm{OS}} = -(1-y^2)\\left(\\frac{d^2}{dy^2}-k^2\\right) - 2 - \\frac{i}{\\alpha\\mathrm{Re}}\\left(\\frac{d^2}{dy^2}-k^2\\right)^2\n$$\n\n### 步骤 3：边界条件\n\n流体被限制在位于 $y=\\pm 1$ 的不可穿透、无滑移壁面之间。\n- **无滑移条件：** 在壁面处，流体的切向速度分量必须为零。总速度为 $(U+u, v, w)$。由于壁面是静止的，因此 $(U+u)|_{y=\\pm 1}=0$ 且 $w|_{y=\\pm 1}=0$。基流 $U(y)=1-y^2$ 已经满足 $U(\\pm 1)=0$，因此扰动速度必须为零：$u(\\pm 1)=0$ 和 $w(\\pm 1)=0$。这意味着它们的振幅也为零：$\\hat{u}(\\pm 1)=0$ 和 $\\hat{w}(\\pm 1)=0$。\n- **不可穿透条件：** 在壁面处，法向速度分量必须为零：$v|_{y=\\pm 1}=0$。这直接给出了振幅 $v(y)$ 的边界条件：\n$$v(\\pm 1) = 0$$\n为了找到第二个边界条件，我们使用振幅的连续性方程：$i\\alpha \\hat{u} + Dv + i\\beta \\hat{w} = 0$。\n在壁面 $y=\\pm 1$ 处，由于 $\\hat{u}(\\pm 1)=0$ 和 $\\hat{w}(\\pm 1)=0$，连续性方程简化为：\n$$Dv(\\pm 1) = 0 \\quad \\implies \\quad \\frac{dv}{dy}(\\pm 1) = 0$$\n因此，四个边界条件是 $v(1)=0$，$v(-1)=0$，$dv/dy(1)=0$ 和 $dv/dy(-1)=0$。\n\n### 最终表达式\n\n按照要求，将推导出的算子和边界条件组合成一个单一的陈述。\n算子是：\n$$\n\\mathcal{L}_{\\mathrm{OS}} = -(1-y^2)\\left(\\frac{d^2}{dy^2}-k^2\\right) - 2 - \\frac{i}{\\alpha\\mathrm{Re}}\\left(\\frac{d^2}{dy^2}-k^2\\right)^2\n$$\n边界条件是：\n$$\nv(\\pm 1) = 0, \\quad \\frac{dv}{dy}(\\pm 1) = 0\n$$", "answer": "$$\n\\boxed{\n\\mathcal{L}_{\\mathrm{OS}} = -(1-y^2)\\left(\\frac{d^2}{dy^2}-k^2\\right) - 2 - \\frac{i}{\\alpha\\mathrm{Re}}\\left(\\frac{d^2}{dy^2}-k^2\\right)^2; \\quad v(\\pm 1)=0, \\frac{dv}{dy}(\\pm 1)=0\n}\n$$", "id": "3331850"}, {"introduction": "现实世界中的流体扰动是三维的，这可能使得稳定性分析异常复杂。此时，斯奎尔定理（Squire's theorem）便成为一个强大的简化工具。本练习提供了该定理的一个动手实践应用，展示了任何三维扰动如何与一个等效且更不稳定的二维扰动相关联，从而解释了为何在寻找失稳的临界条件时通常可以首先关注二维波 [@problem_id:1791400]。", "problem": "在研究平行剪切流 $U(y)$ 的流体动力学稳定性时，发现一个特定的三维扰动在雷诺数 $\\text{Re}_{3D} = 10000$ 时是中性稳定的。该扰动的特征是无量纲流向波数 $\\alpha = 1.0$ 和无量纲展向波数 $\\beta = 1.5$。\nSquire 定理在任何三维扰动的稳定性与等效的二维扰动（其展向波数为零）的稳定性之间建立了直接的数学对应关系。\n对于给定的三维扰动，确定其等效二维扰动的关键参数：流向波数 $\\tilde{\\alpha}$ 和雷诺数 $\\text{Re}_{2D}$。在此雷诺数下，等效的二维扰动也是中性稳定的。首先给出 $\\tilde{\\alpha}$ 的值，然后给出 $\\text{Re}_{2D}$ 的值。将两个数值都四舍五入到四位有效数字。", "solution": "我们应用 Squire 定理来研究平行剪切流的稳定性。对于一个在雷诺数 $\\text{Re}_{3D}$ 下，由流向和展向波数 $(\\alpha,\\beta)$ 表征的三维扰动，Squire 变换将其映射到一个等效的二维扰动（展向波数为零），该扰动具有\n$$\n\\tilde{\\alpha}=\\sqrt{\\alpha^{2}+\\beta^{2}},\\qquad \\text{Re}_{2D}=\\frac{\\alpha}{\\sqrt{\\alpha^{2}+\\beta^{2}}}\\,\\text{Re}_{3D}.\n$$\n这种映射保留了中性稳定条件。\n\n给定 $\\alpha=1.0$，$\\beta=1.5$ 和 $\\text{Re}_{3D}=10000$，我们首先计算总波数的大小\n$$\nk=\\sqrt{\\alpha^{2}+\\beta^{2}}=\\sqrt{1.0^{2}+1.5^{2}}=\\sqrt{1+2.25}=\\sqrt{3.25}=\\frac{\\sqrt{13}}{2}.\n$$\n因此，等效的二维流向波数为\n$$\n\\tilde{\\alpha}=k=\\sqrt{3.25}\\approx 1.802775638\\quad\\Rightarrow\\quad \\tilde{\\alpha}\\approx 1.803\\ \\text{（保留四位有效数字）}.\n$$\n相应的雷诺数是\n$$\n\\text{Re}_{2D}=\\frac{\\alpha}{k}\\,\\text{Re}_{3D}=\\frac{1}{\\sqrt{3.25}}\\times 10000=\\frac{2}{\\sqrt{13}}\\times 10000\\approx 5547.00196\\quad\\Rightarrow\\quad \\text{Re}_{2D}\\approx 5547\\ \\text{（保留四位有效数字）}.\n$$\n因此，当四舍五入到四位有效数字时，所求的数对 $(\\tilde{\\alpha},\\text{Re}_{2D})$ 是 $(1.803,\\,5547)$，数值按要求的顺序报告。", "answer": "$$\\boxed{\\begin{pmatrix}1.803  5547\\end{pmatrix}}$$", "id": "1791400"}, {"introduction": "尽管像斯奎尔定理这样的分析工具能提供关键的洞见，但要获得特定流动的定量稳定性结果，通常需要借助数值方法。这个高级练习通过指导您实施谱配置法来求解奥尔-索末菲特征值问题，从而填补了理论与计算之间的鸿沟。通过将算子和边界条件离散化，您将计算出稳定性谱并确定扰动的增长率，这是现代流体力学研究中的一项基本技能 [@problem_id:3331826]。", "problem": "考虑一个不可压缩平行剪切流的时间线性稳定性，该流动由线性化的Navier–Stokes方程控制，并假设存在形式为 $\\exp(i \\alpha x - i \\omega t)$ 的二维扰动，其中 $\\alpha$ 是实数流向波数，$\\omega$ 是复数时间频率。基流是定义在壁面法向区间 $y \\in [-1, 1]$ 上的无量纲平面泊肃叶剖面 $U(y) = 1 - y^2$。壁面法向速度扰动 $v(y)$ 满足从线性化控制方程和不可压缩性条件推导出的Orr–Sommerfeld方程，以及无滑移边界条件，即 $v(\\pm 1) = 0$ 和 $Dv(\\pm 1) = 0$，其中 $D$ 表示对 $y$ 的微分。\n\n从线性化的动量和连续性方程以及Orr–Sommerfeld算子的定义出发，当通过Chebyshev配置法进行离散化时，$v(y)$ 的时间Orr–Sommerfeld方程可以写成广义特征值形式 $A \\mathbf{x} = \\lambda B \\mathbf{x}$，其中 $\\mathbf{x}$ 是 $v(y)$ 的节点值向量，$\\lambda$ 是复相速度 $c = \\omega / \\alpha$，而 $A$ 和 $B$ 是表示离散算子的复数矩阵。令 $D$ 表示在 $N+1$ 个Chebyshev–Gauss–Lobatto点 $y_j = \\cos(\\pi j / N)$（$j = 0, 1, \\dots, N$）上的一阶Chebyshev微分矩阵，并令 $D^2$ 为二阶微分矩阵。定义离散算子\n$$L_2 = D^2 - \\alpha^2 I, \\quad L_4 = L_2^2,$$\n其中 $I$ 是大小为 $(N+1) \\times (N+1)$ 的单位矩阵。对于平面泊肃叶基流 $U(y) = 1 - y^2$，有 $U''(y) = -2$。用 $\\operatorname{diag}(U)$ 表示在配置点上采样的基流的对角矩阵，用 $\\operatorname{diag}(U'')$ 表示 $U''$ 在配置点上采样的对角矩阵。连续Orr–Sommerfeld方程\n$$(D^2 - \\alpha^2)^2 v + i \\alpha \\operatorname{Re} \\left[(U - c)(D^2 - \\alpha^2) v - U'' v\\right] = 0$$\n被离散化为广义特征值问题\n$$A \\mathbf{x} = c\\, B \\mathbf{x},$$\n其中\n$$A = L_4 + i \\alpha \\operatorname{Re} \\left(\\operatorname{diag}(U) L_2 - \\operatorname{diag}(U'')\\right), \\qquad B = i \\alpha \\operatorname{Re} \\, L_2.$$\n\n您的任务是编写一个完整、自包含的程序，该程序：\n1. 构建Chebyshev–Gauss–Lobatto网格和相应的大小为 $(N+1) \\times (N+1)$ 的一阶微分矩阵 $D$，并通过矩阵乘法获得 $D^2$。\n2. 对于给定的 $\\alpha$ 和雷诺数 $\\operatorname{Re}$，构建离散算子 $L_2$ 和 $L_4$，并组装如上定义的矩阵 $A$ 和 $B$。\n3. 通过替换 $A$ 和 $B$ 中的特定行来施加边界条件 $v(\\pm 1) = 0$ 和 $Dv(\\pm 1) = 0$，以获得一个适定的广义特征值问题：\n   - 通过将 $A$ 的第 $0$ 行替换为选择 $y = 1$ 处值的行向量（即第一个标准基行向量），并将 $B$ 的第 $0$ 行设置为零行，来强制 $v(1) = 0$。\n   - 通过将 $A$ 的第 $N$ 行替换为选择 $y = -1$ 处值的行向量（即最后一个标准基行向量），并将 $B$ 的第 $N$ 行设置为零行，来强制 $v(-1) = 0$。\n   - 通过将 $A$ 的第 $1$ 行替换为微分矩阵 $D$ 的第 $0$ 行（对应于在 $y = 1$ 处计算的导数），并将 $B$ 的第 $1$ 行设置为零行，来强制 $Dv(1) = 0$。\n   - 通过将 $A$ 的第 $N-1$ 行替换为微分矩阵 $D$ 的第 $N$ 行（对应于在 $y = -1$ 处计算的导数），并将 $B$ 的第 $N-1$ 行设置为零行，来强制 $Dv(-1) = 0$。\n4. 求解广义特征值问题 $A \\mathbf{x} = c B \\mathbf{x}$ 以获得复特征值 $c$。对于每个测试用例，计算由 $g = \\alpha \\,\\operatorname{Im}(c)$ 定义的无量纲时间增长率，其中 $\\operatorname{Im}(c)$ 表示 $c$ 的虚部，并取所有有限大小特征值的 $g$ 的最大值。\n5. 生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。每个数字是对应测试用例的最大增长率 $g$，表示为四舍五入到六位小数的十进制浮点数，单位为无量纲。\n\n使用以下参数值测试套件来评估和报告结果：\n- 案例1（在足够大的 $\\operatorname{Re}$ 下预期不稳定的通用情况）：$N = 64$, $\\alpha = 1.0$, $\\operatorname{Re} = 10000$。\n- 案例2（较低波数和中等 $\\operatorname{Re}$）：$N = 64$, $\\alpha = 0.5$, $\\operatorname{Re} = 5000$。\n- 案例3（高 $\\operatorname{Re}$ 下的较高波数）：$N = 48$, $\\alpha = 2.0$, $\\operatorname{Re} = 10000$。\n- 案例4（小波数和非常高 $\\operatorname{Re}$ 的边缘情况）：$N = 40$, $\\alpha = 0.2$, $\\operatorname{Re} = 20000$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如，“[0.123456,-0.000789,0.000000,0.004321]”），其中每个条目是按上述顺序列出的相应测试用例的最大 $g$ 值，四舍五入到六位小数，单位为无量纲。此问题中不使用角度，所有输出均为无单位实数。", "solution": "该问题要求确定平面泊肃叶流中小的二维扰动的最大时间增长率。这是流体动力学稳定性理论中的一个经典问题。分析基于Orr–Sommerfeld方程，这是一个控制壁面法向速度扰动 $v(y)$ 演化的四阶常微分方程。通过使用Chebyshev配置（谱）方法对该方程进行数值求解，该方法将微分特征值问题转化为广义矩阵特征值问题。\n\n基流是平面泊肃叶流，由无量纲速度剖面 $U(y) = 1 - y^2$ 在定义域 $y \\in [-1, 1]$ 上给出。扰动假设为形式 $\\phi(x,y,t) = \\hat{\\phi}(y) e^{i(\\alpha x - \\omega t)}$，其中 $\\alpha$ 是实数流向波数，$\\omega = \\omega_r + i\\omega_i$ 是复角频率。扰动的时间增长率由 $g = \\omega_i = \\alpha \\operatorname{Im}(c)$ 给出，其中 $c = \\omega/\\alpha$ 是复相速度。正增长率（$g  0$）表示一个随时间增长的不稳定模态，而负增长率表示一个稳定的、衰减的模态。\n\n控制方程是壁面法向速度振幅 $v(y)$ 的Orr–Sommerfeld方程。当离散化后，它采用广义特征值问题的形式：\n$$A \\mathbf{x} = c B \\mathbf{x}$$\n其中 $\\mathbf{x}$ 是扰动速度 $v$ 在配置点上的向量， $c$ 是特征值。矩阵 $A$ 和 $B$ 是基于离散化的微分算子构建的。\n\n解决此问题的步骤如下：\n\n1.  **Chebyshev配置和微分矩阵**：\n    问题在Chebyshev–Gauss–Lobatto网格点上进行离散化，这些点由 $y_j = \\cos(\\frac{\\pi j}{N})$ 定义，其中 $j = 0, 1, \\dots, N$。这种点的选择可以实现对函数及其导数的高精度逼近。\n    第一步是构建 $(N+1) \\times (N+1)$ 的一阶Chebyshev微分矩阵 $D$。该矩阵的元素由解析公式给出：\n    $$\n    D_{ij} =\n    \\begin{cases}\n    \\frac{c_i}{c_j} \\frac{(-1)^{i+j}}{y_i - y_j}  \\text{for } i \\neq j \\\\\n    -\\frac{y_j}{2(1-y_j^2)}  \\text{for } 1 \\le j \\le N-1 \\\\\n    \\frac{2N^2+1}{6}  \\text{for } i=j=0 \\\\\n    -\\frac{2N^2+1}{6}  \\text{for } i=j=N\n    \\end{cases}\n    $$\n    其中 $c_0 = c_N = 2$ 且 $c_j = 1$ 对于 $1 \\le j \\le N-1$。然后通过矩阵乘法计算二阶微分矩阵 $D^2$：$D^2 = D \\cdot D$。\n\n2.  **系统矩阵的组装**：\n    离散算子 $L_2$ 和 $L_4$ 定义为：\n    $$L_2 = D^2 - \\alpha^2 I$$\n    $$L_4 = L_2^2 = (D^2 - \\alpha^2 I)^2$$\n    其中 $I$ 是大小为 $(N+1) \\times (N+1)$ 的单位矩阵。广义特征值问题的矩阵 $A$ 和 $B$ 定义为：\n    $$A = L_4 + i \\alpha \\operatorname{Re} \\left( \\operatorname{diag}(U) L_2 - \\operatorname{diag}(U'') \\right)$$\n    $$B = i \\alpha \\operatorname{Re} L_2$$\n    这里，$\\operatorname{diag}(U)$ 是一个对角矩阵，其对角线上是基流速度 $U(y_j) = 1 - y_j^2$。基流的二阶导数是常数 $U''(y) = -2$，所以 $\\operatorname{diag}(U'')$ 是一个对角线上为 $-2$ 的对角矩阵，即 $-2I$。\n\n3.  **边界条件的施加**：\n    流体被限制在 $y = \\pm 1$ 的两壁之间。无滑移和无穿透边界条件要求扰动速度及其法向导数在壁面处为零：\n    $$v(\\pm 1) = 0, \\quad Dv(\\pm 1) = 0$$\n    这四个条件通过替换矩阵 $A$ 和 $B$ 的四行来施加到离散系统上。点 $y_0 = 1$ 和 $y_N = -1$ 对应于壁面。\n    -   $v(1)=0$：替换顶壁点（$j=0$）的方程。将 $A$ 的第 $0$ 行设置为 $[1, 0, \\dots, 0]$，并将 $B$ 的第 $0$ 行设置为零向量。\n    -   $v(-1)=0$：替换底壁点（$j=N$）的方程。将 $A$ 的第 $N$ 行设置为 $[0, \\dots, 0, 1]$，并将 $B$ 的第 $N$ 行设置为零向量。\n    -   $Dv(1)=0$：用顶壁的导数条件替换与顶壁相邻点（$j=1$）的方程。将 $A$ 的第 $1$ 行设置为微分矩阵 $D$ 的第 $0$ 行，并将 $B$ 的第 $1$ 行设置为零向量。\n    -   $Dv(-1)=0$：用底壁的导数条件替换与底壁相邻点（$j=N-1$）的方程。将 $A$ 的第 $N-1$ 行设置为 $D$ 的第 $N$ 行，并将 $B$ 的第 $N-1$ 行设置为零向量。\n    这个过程使得矩阵 $B$ 的四行变为零，从而使其成为奇异矩阵。\n\n4.  **特征值计算和后处理**：\n    使用标准的广义特征值求解器求解修正后的系统 $A \\mathbf{x} = c B \\mathbf{x}$。由于 $B$ 的奇异性，求解器会产生无穷大的伪特征值。必须将这些伪特征值滤除。剩下的有限特征值 $c$ 代表系统的物理模态。\n    对于每个有限特征值 $c$，时间增长率计算为 $g = \\alpha \\operatorname{Im}(c)$。任务是找到所有物理模态中的最大增长率 $g_{\\max} = \\max(\\alpha \\operatorname{Im}(c))$。对指定的每个测试用例重复此过程。", "answer": "```python\nimport numpy as np\nfrom scipy.linalg import eig\n\ndef solve():\n    \"\"\"\n    Solves the Orr-Sommerfeld equation for plane Poiseuille flow\n    using a Chebyshev collocation method to find the maximum temporal growth rate.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (N, alpha, Re)\n        (64, 1.0, 10000),\n        (64, 0.5, 5000),\n        (48, 2.0, 10000),\n        (40, 0.2, 20000),\n    ]\n\n    results = []\n    for N, alpha, Re in test_cases:\n        # Step 1: Construct Chebyshev grid and differentiation matrix D\n        n_points = N + 1\n        y = np.cos(np.pi * np.arange(n_points) / N)\n        \n        D = np.zeros((n_points, n_points))\n        c = np.ones(n_points)\n        c[0] = 2.0\n        c[-1] = 2.0\n\n        for i in range(n_points):\n            for j in range(n_points):\n                if i == j:\n                    if i == 0:\n                        D[i, j] = (2 * N**2 + 1) / 6.0\n                    elif i == N:\n                        D[i, j] = -(2 * N**2 + 1) / 6.0\n                    else:\n                        D[i, j] = -y[i] / (2 * (1 - y[i]**2))\n                else:\n                    D[i, j] = (c[i] / c[j]) * ((-1)**(i + j)) / (y[i] - y[j])\n        \n        D2 = D @ D\n        I = np.eye(n_points)\n\n        # Step 2: Build discrete operators and assemble matrices A and B\n        L2 = D2 - alpha**2 * I\n        L4 = L2 @ L2\n        \n        U = 1 - y**2\n        diag_U = np.diag(U)\n        \n        # U'' = -2, so diag(U'') = -2 * I\n        diag_U_pp = -2.0 * I\n        \n        A = L4 + 1j * alpha * Re * (diag_U @ L2 - diag_U_pp)\n        B = 1j * alpha * Re * L2\n\n        # Step 3: Impose boundary conditions v(+-1) = 0, Dv(+-1) = 0\n        # v(1)=0 corresponds to y[0]. Replace row 0.\n        A[0, :] = 0.0\n        A[0, 0] = 1.0\n        B[0, :] = 0.0\n        \n        # Dv(1)=0. Replace row 1.\n        A[1, :] = D[0, :]\n        B[1, :] = 0.0\n\n        # Dv(-1)=0 corresponds to y[N]. Replace row N-1.\n        A[N - 1, :] = D[N, :]\n        B[N - 1, :] = 0.0\n        \n        # v(-1)=0. Replace row N.\n        A[N, :] = 0.0\n        A[N, N] = 1.0\n        B[N, :] = 0.0\n\n        # Step 4: Solve the generalized eigenvalue problem and find max growth rate\n        evals, evecs = eig(A, B)\n        \n        # Filter out spurious infinite eigenvalues\n        finite_evals = evals[np.isfinite(evals)]\n        \n        if len(finite_evals) == 0:\n            # Handles cases where no finite eigenvalues are found\n            max_g = -np.inf\n        else:\n            # Calculate growth rate g = alpha * Im(c)\n            growth_rates = alpha * finite_evals.imag\n            max_g = np.max(growth_rates)\n        \n        results.append(f\"{max_g:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "3331826"}]}