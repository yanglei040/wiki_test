{"hands_on_practices": [{"introduction": "本练习为理解和实现幽灵流体法 (GFM) 奠定了基础。我们将把 GFM 应用于一维泊松方程，这是一个代表许多物理扩散过程的基本模型。你将从第一性原理出发推导离散方程，然后通过一个特殊构造的精确解来验证你的代码。通过这个过程，你将实践计算科学家的基本工作流程：推导、实现和验证。这个问题 [@problem_id:3323634] 旨在揭示 GFM 的精度与其基本假设之间的内在联系，从而清晰地展示其收敛特性。", "problem": "考虑在闭区间 $[0,1]$ 上的一个一维稳态扩散模型，在点 $x=\\alpha\\in (0,1)$ 处存在一个尖锐界面，将区域划分为 $[0,\\alpha)$ 和 $(\\alpha,1]$ 两个子域。控制方程是由均匀介质的扩散通量守恒推导出的标量泊松方程，对于每个 $x\\neq \\alpha$ 写为 $u^{\\prime\\prime}(x)=q(x)$，其中源项为 $q(x)=-\\pi^{2}\\sin(\\pi x)$。解满足狄利克雷边界条件 $u(0)=u_{\\mathrm{exact}}(0)$ 和 $u(1)=u_{\\mathrm{exact}}(1)$。在界面两侧，解及其一阶导数满足指定的跳跃条件 $[u]_{\\alpha}=J$ 和 $[u_{x}]_{\\alpha}=K$，其中 $[g]_{\\alpha}=g(\\alpha^{+})-g(\\alpha^{-})$ 表示函数 $g$ 在 $x=\\alpha$ 处的跳跃。与这些条件一致的一个精确的分段光滑解由下式给出\n$$\nu_{\\mathrm{exact}}(x)=\\sin(\\pi x)+H(x-\\alpha)\\,\\big(J+K\\,(x-\\alpha)\\big),\n$$\n其中 $H$ 是亥维赛德阶跃函数，定义为当 $\\xi0$ 时 $H(\\xi)=0$，当 $\\xi>0$ 时 $H(\\xi)=1$，在 $\\xi=0$ 处的任何取值不影响该问题，因为在下文的测试配置中 $\\alpha$ 不是网格点。\n\n您的任务如下。\n\n1) 从守恒律基础和二阶导数的中心差分近似出发，推导一个在均匀网格上与界面跳跃条件相容的尖锐界面有限差分格式，需使用鬼点法 (Ghost Fluid Method, GFM)（鬼点法 (GFM) 是一种通过在界面两侧构造鬼点值来施加界面条件的技术）。使用均匀网格 $x_{i}=i\\,h$（整数 $i\\in\\{0,1,\\dots,N\\}$，间距 $h=1/N$），并对不跨越界面的节点使用经典的二阶中心差分来逼近 $u^{\\prime\\prime}(x)$。在包含界面点 $x=\\alpha$ 的单元（即唯一的单元 $[x_{k},x_{k+1}]$，满足 $x_{k} \\le \\alpha  x_{k+1}$）处，为跨越界面的模板推导一个经过修正的有限差分格式。", "solution": "此问题经评估有效。该问题在数值分析和计算流体力学领域具有科学依据，特别涉及泊松方程的有限差分法和用于尖锐界面的鬼点法 (GFM)。该问题是适定的，提供了清晰的控制方程、边界条件、界面跳跃条件以及一个用于验证的人工精确解。给定条件完整、内部一致且无歧义，从而保证了唯一的求解路径。任务是客观且可形式化的。\n\n### 1. 尖锐界面离散格式的推导\n\n我们的任务是在区间 $[0,1]$ 上求解一维泊松方程 $u^{\\prime\\prime}(x)=q(x)$，在 $x=\\alpha$ 处存在一个尖锐界面。解 $u(x)$ 及其导数 $u_x(x)$ 在界面处有指定的跳跃 $[u]_{\\alpha}=J$ 和 $[u_x]_{\\alpha}=K$，其中 $[g]_{\\alpha} = g(\\alpha^+) - g(\\alpha^-)$。\n\n我们使用一个包含 $N+1$ 个点 $x_i = i h$（$i=0, 1, \\dots, N$）的均匀网格，网格间距为 $h=1/N$。界面位于 $x=\\alpha$，处于某个网格单元内，即对于唯一的整数 $k$，有 $x_k \\le \\alpha  x_{k+1}$。\n\n对于任何网格节点 $x_i$，如果其标准三点模板 $\\{x_{i-1}, x_i, x_{i+1}\\}$ 不跨越界面，我们使用二阶中心差分近似其二阶导数：\n$$\n\\frac{u_{i-1} - 2u_i + u_{i+1}}{h^2} = q(x_i) = q_i\n$$\n其中 $u_i$ 是 $u(x_i)$ 的数值近似。\n\n以节点 $x_k$ 和 $x_{k+1}$ 为中心的模板跨越了界面。我们采用鬼点法 (Ghost Fluid Method, GFM) 来修正这两个节点处的有限差分方程。GFM 通过在右端项 (RHS) 引入修正项来保持左端项 (LHS) 的标准矩阵模板。这些修正是根据为施加跳跃条件而构造的鬼点值推导出来的。\n\n**在节点 $x_k$ 处的修正：**\n在 $x_k$ 处的模板涉及 $u_{k-1}$、$u_k$ 和 $u_{k+1}$。由于 $x_k  \\alpha$ 且 $x_{k+1} > \\alpha$，相对于 $x_k$，值 $u_{k+1}$ 位于界面的“右侧”。在 GFM 中，我们用一个鬼点值 $u^G_{k+1}$ 来替换 $u_{k+1}$，该鬼点值代表“左侧”解到右侧区域的光滑延拓。设 $u_L(x)$ 为 $x \\le \\alpha$ 的解，$u_R(x)$ 为 $x \\ge \\alpha$ 的解。鬼点值 $u^G_{k+1}$ 应近似于 $u_L(x_{k+1})$。\n\n跳跃条件可用于将 $u_L$ 在区域 $x>\\alpha$ 内的假设光滑延拓与真实解 $u_R(x)$ 联系起来。基于跳跃条件在 $x=\\alpha$ 附近的一阶泰勒展开，我们可以陈述：\n对于 $x > \\alpha$，$u_L(x) \\approx u_R(x) - (J + K(x-\\alpha))$。\n这提供了一种使用 $x_{k+1}$ 处的真实值来定义该点鬼点值的方法：\n$$\nu^G_{k+1} = u_{k+1} - (J + K(x_{k+1}-\\alpha))\n$$\n将此鬼点值代入 $x_k$ 处的中心差分公式：\n$$\n\\frac{u_{k-1} - 2u_k + u^G_{k+1}}{h^2} = q_k\n$$\n$$\n\\frac{u_{k-1} - 2u_k + u_{k+1} - (J + K(x_{k+1}-\\alpha))}{h^2} = q_k\n$$\n重新整理以保持左端项上的标准模板，我们得到节点 $x_k$ 的修正方程：\n$$\n\\frac{u_{k-1} - 2u_k + u_{k+1}}{h^2} = q_k + \\frac{J + K(x_{k+1}-\\alpha)}{h^2}\n$$\n\n**在节点 $x_{k+1}$ 处的修正：**\n类似地，在 $x_{k+1}$ 处的模板涉及 $u_k$、$u_{k+1}$ 和 $u_{k+2}$。值 $u_k$ 位于“左侧”，因此我们用一个鬼点值 $u^G_k$ 来替换它，该鬼点值代表“右侧”解 $u_R(x)$ 到左侧区域的光滑延拓。对称地，我们定义此关系为：\n对于 $x  \\alpha$，$u_R(x) \\approx u_L(x) + (J + K(x-\\alpha))$。\n因此，使用真实值 $u_k$ 定义 $x_k$ 处的鬼点值：\n$$\nu^G_k = u_k + (J + K(x_k-\\alpha))\n$$\n将其代入 $x_{k+1}$ 处的中心差分公式：\n$$\n\\frac{u^G_k - 2u_{k+1} + u_{k+2}}{h^2} = q_{k+1}\n$$\n$$\n\\frac{u_k + (J + K(x_k-\\alpha)) - 2u_{k+1} + u_{k+2}}{h^2} = q_{k+1}\n$$\n节点 $x_{k+1}$ 的修正方程为：\n$$\n\\frac{u_k - 2u_{k+1} + u_{k+2}}{h^2} = q_{k+1} - \\frac{J + K(x_k-\\alpha)}{h^2}\n$$\n这些修正保留了矩阵算子的对称三对角结构，所有变更都并入了右端项向量中。\n\n### 2. 相容性分析与收敛阶\n\n在网格节点 $x_i$ 处的局部截断误差 (LTE) 定义为 $\\tau_i = L_h(u_{\\mathrm{exact}})(x_i) - q(x_i)$，其中 $L_h$ 是有限差分算子。\n\n**远离界面处：** 对于一个模板不跨越 $\\alpha$ 的节点 $x_i$，算子是标准的中心差分。对 $u_{\\mathrm{exact}}(x_i \\pm h)$ 在 $x_i$ 处进行泰勒展开可得：\n$$\n\\tau_i = \\frac{u_{\\mathrm{exact}}(x_{i-1}) - 2u_{\\mathrm{exact}}(x_i) + u_{\\mathrm{exact}}(x_{i+1})}{h^2} - u_{\\mathrm{exact}}''(x_i) = \\frac{h^2}{12}u_{\\mathrm{exact}}^{(4)}(x_i) + O(h^4)\n$$\n因此，远离界面处，LTE 是二阶的，即 $\\tau_i = O(h^2)$。\n\n**邻近界面处：** 该分析关键取决于所给精确解的具体形式：\n$$\nu_{\\mathrm{exact}}(x)=\\sin(\\pi x)+H(x-\\alpha)\\,\\big(J+K\\,(x-\\alpha)\\big)\n$$\n令 $u_L(x) = \\sin(\\pi x)$ 和 $u_R(x) = \\sin(\\pi x) + J + K(x-\\alpha)$。精确解为当 $x\\alpha$ 时 $u_{\\mathrm{exact}}(x) = u_L(x)$，当 $x>\\alpha$ 时 $u_{\\mathrm{exact}}(x) = u_R(x)$。一个关键性质是跳跃分量是线性的，意味着对所有 $x$ 都有 $u_R(x) = u_L(x) + J + K(x-\\alpha)$。此外，$u_L''(x) = u_R''(x) = -\\pi^2\\sin(\\pi x) = q(x)$。\n\n**节点 $x_k$ 处的 LTE：** LTE 由下式给出：\n$$\n\\tau_k = \\left(\\frac{u_{\\mathrm{exact}}(x_{k-1}) - 2u_{\\mathrm{exact}}(x_k) + u_{\\mathrm{exact}}(x_{k+1})}{h^2}\\right) - \\left(q_k + \\frac{J + K(x_{k+1}-\\alpha)}{h^2}\\right)\n$$\n代入 $u_{\\mathrm{exact}}(x_{k-1})=u_L(x_{k-1})$、$u_{\\mathrm{exact}}(x_k)=u_L(x_k)$ 和 $u_{\\mathrm{exact}}(x_{k+1})=u_R(x_{k+1})=u_L(x_{k+1}) + J + K(x_{k+1}-\\alpha)$：\n\\begin{align*}\n\\tau_k = \\frac{u_L(x_{k-1}) - 2u_L(x_k) + \\left(u_L(x_{k+1}) + J + K(x_{k+1}-\\alpha)\\right)}{h^2} - q_k - \\frac{J + K(x_{k+1}-\\alpha)}{h^2} \\\\\n= \\frac{u_L(x_{k-1}) - 2u_L(x_k) + u_L(x_{k+1})}{h^2} - q_k\n\\end{align*}\n由于 $q_k = q(x_k) = u_L''(x_k)$，此表达式即为光滑函数 $u_L(x)$ 在 $x_k$ 处的标准 LTE。因此，$\\tau_k = O(h^2)$。\n\n**节点 $x_{k+1}$ 处的 LTE：** LTE 由下式给出：\n$$\n\\tau_{k+1} = \\left(\\frac{u_{\\mathrm{exact}}(x_k) - 2u_{\\mathrm{exact}}(x_{k+1}) + u_{\\mathrm{exact}}(x_{k+2})}{h^2}\\right) - \\left(q_{k+1} - \\frac{J + K(x_k-\\alpha)}{h^2}\\right)\n$$\n代入 $u_{\\mathrm{exact}}(x_k)=u_L(x_k) = u_R(x_k) - (J + K(x_k-\\alpha))$、$u_{\\mathrm{exact}}(x_{k+1})=u_R(x_{k+1})$ 和 $u_{\\mathrm{exact}}(x_{k+2})=u_R(x_{k+2})$：\n\\begin{align*}\n\\tau_{k+1} = \\frac{\\left(u_R(x_k) - (J+K(x_k-\\alpha))\\right) - 2u_R(x_{k+1}) + u_R(x_{k+2})}{h^2} - q_{k+1} + \\frac{J + K(x_k-\\alpha)}{h^2} \\\\\n= \\frac{u_R(x_k) - 2u_R(x_{k+1}) + u_R(x_{k+2})}{h^2} - q_{k+1}\n\\end{align*}\n由于 $q_{k+1} = q(x_{k+1}) = u_R''(x_{k+1})$，此表达式即为光滑函数 $u_R(x)$ 的标准 LTE，同样为 $O(h^2)$。\n\n**全局收敛阶：**\n在所有内部网格节点处，LTE 均为 $O(h^2)$。一维泊松方程的有限差分算子是稳定的。对于一个稳定的格式，在合适的范数（例如离散 $L^2$ 范数）下，全局误差的阶数与局部截断误差的阶数相同。因此，对于这个特定问题和格式，预期的全局收敛阶为 2。值得注意的是，虽然所用的 GFM 通常被认为是一阶方法，但它在这里达到了二阶精度，因为其对跳跃条件的线性外推与人工解中跳跃分量的线性结构完全匹配。\n\n### 3. 实现与网格加密研究\n\n数值实现包括为 $N-1$ 个内部未知数 $\\mathbf{u}_{\\text{int}}=[u_1, \\dots, u_{N-1}]^T$ 组装并求解一个线性系统 $A\\mathbf{u}_{\\text{int}} = \\mathbf{b}$。\n- 矩阵 $A$ 是标准的 $(N-1) \\times (N-1)$ 对称三对角矩阵，其主对角线元素为 $-2/h^2$，相邻的次对角线和超对角线元素为 $1/h^2$。\n- 大小为 $N-1$ 的右端项向量 $\\mathbf{b}$ 按以下方式构造：\n  1. 初始化 $b_i = q(x_{i+1})$，其中 $i=0, \\dots, N-2$。\n  2. 并入狄利克雷边界条件：从 $b_0$ 中减去 $u_0/h^2$，从 $b_{N-2}$ 中减去 $u_N/h^2$。\n  3. 应用 GFM 修正：\n     - 将 $\\frac{J + K(x_{k+1}-\\alpha)}{h^2}$ 加到 $b_{k-1}$（对应于 $x_k$ 处的方程）。\n     - 从 $b_k$ 中减去 $\\frac{J + K(x_k-\\alpha)}{h^2}$（对应于 $x_{k+1}$ 处的方程）。\n- 使用稀疏线性求解器来高效地求解该系统。\n- 实验收敛阶 (EOC) 是根据在三个加密网格序列上获得的离散 $L^2$ 误差计算得出的。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.sparse import diags\nfrom scipy.sparse.linalg import spsolve\n\ndef u_exact(x, alpha, J, K):\n    \"\"\"\n    Computes the exact solution u_exact(x).\n    The Heaviside function is implemented using a boolean condition, as alpha\n    is never a grid point, so x - alpha is never zero.\n    \"\"\"\n    return np.sin(np.pi * x) + (x > alpha) * (J + K * (x - alpha))\n\ndef q_source(x):\n    \"\"\"\n    Computes the source term q(x).\n    \"\"\"\n    return -np.pi**2 * np.sin(np.pi * x)\n\ndef solve_poisson_gfm(N, alpha, J, K):\n    \"\"\"\n    Solves the 1D Poisson equation with a sharp interface using the Ghost Fluid Method.\n    \n    Args:\n        N (int): Number of intervals in the grid.\n        alpha (float): Interface location.\n        J (float): Jump in the solution u at the interface.\n        K (float): Jump in the derivative u_x at the interface.\n        \n    Returns:\n        float: The discrete L2 error norm of the numerical solution.\n    \"\"\"\n    h = 1.0 / N\n    x = np.linspace(0, 1, N + 1)\n    \n    # Find the index k such that x_k = alpha  x_{k+1}\n    k = int(np.floor(alpha / h))\n    \n    # Exact solution for error calculation\n    u_exact_vals = u_exact(x, alpha, J, K)\n    u0 = u_exact_vals[0]\n    uN = u_exact_vals[-1]\n    \n    # Set up the linear system A * u_interior = b\n    # A is the standard 1D Laplacian matrix (size N-1 x N-1)\n    diagonals = [np.ones(N - 2), -2 * np.ones(N - 1), np.ones(N - 2)]\n    A = diags(diagonals, [-1, 0, 1], shape=(N - 1, N - 1), format='csc')\n    A /= h**2\n    \n    # Construct the right-hand side vector b\n    b = q_source(x[1:-1])\n    \n    # Apply boundary conditions\n    b[0] -= u0 / h**2\n    b[-1] -= uN / h**2\n    \n    # Check if interface modifications are not at the boundaries (guaranteed by test cases)\n    # The GFM modifications apply to equations for nodes k and k+1.\n    # The unknown vector is u_1, ..., u_{N-1}, indexed 0 to N-2.\n    # Equation for u_k is at index k-1.\n    # Equation for u_{k+1} is at index k.\n    \n    if 0  k  N-1:\n        # Modify RHS for equation at node x_k\n        gfm_corr_k = (J + K * (x[k+1] - alpha)) / h**2\n        b[k-1] += gfm_corr_k\n        \n        # Modify RHS for equation at node x_{k+1}\n        gfm_corr_k1 = -(J + K * (x[k] - alpha)) / h**2\n        b[k] += gfm_corr_k1\n        \n    # Solve the sparse linear system\n    u_interior = spsolve(A, b)\n    \n    # Combine with boundary values to get the full numerical solution\n    u_numerical = np.concatenate(([u0], u_interior, [uN]))\n    \n    # Calculate the discrete L2 error norm\n    error_vector = u_numerical - u_exact_vals\n    l2_error = np.sqrt(h * np.sum(error_vector**2))\n    \n    return l2_error\n\ndef run_grid_refinement_study(case_params):\n    \"\"\"\n    Performs a grid refinement study for a given test case.\n    \n    Args:\n        case_params (tuple): A tuple containing (alpha, J, K, N0).\n\n    Returns:\n        float: The average Experimental Order of Convergence (EOC).\n    \"\"\"\n    alpha, J, K, N0 = case_params\n    \n    grid_sizes = [N0, 2 * N0, 4 * N0]\n    errors = []\n    \n    for N in grid_sizes:\n        error = solve_poisson_gfm(N, alpha, J, K)\n        errors.append(error)\n        \n    # Calculate EOC values\n    p1 = np.log2(errors[0] / errors[1])\n    p2 = np.log2(errors[1] / errors[2])\n    \n    avg_eoc = (p1 + p2) / 2.0\n    return avg_eoc\n\ndef solve():\n    \"\"\"\n    Main function to run all test cases and print the results in the specified format.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Format: (alpha, J, K, base_N)\n    test_cases = [\n        (0.37, 0.3, -0.8, 80),   # Case A\n        (0.05, 1.0, 0.5, 80),    # Case B\n        (0.42, 0.0, 0.0, 80),    # Case C\n        (0.95, -0.2, 1.5, 80),   # Case D\n    ]\n\n    results = []\n    for case in test_cases:\n        eoc = run_grid_refinement_study(case)\n        results.append(eoc)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3323634"}, {"introduction": "在构建了基本实现之后，我们现在转向 GFM 应用中的一个关键环节：界面曲率的计算。在涉及表面张力的多相流问题中，压力跳跃量与曲率成正比，因此精确计算曲率至关重要。这个解析练习 [@problem_id:3323621] 将引导你使用傅里叶分析，深入探究正则化和有限差分等数值操作如何引入误差和伪影。这项实践旨在磨练你的解析能力，并帮助你建立起诊断和理解复杂模拟中数值误差来源的深刻直觉。", "problem": "在二维空间中，一个两相不可压缩流的物质界面由图 $y = f(x)$ 描述，其中 $f(x) = A \\sin(k x)$ 且 $A k \\ll 1$。该界面在两个方向上间距均为 $h$ 的均匀笛卡尔网格上，使用水平集函数 $\\phi(x,y) = y - f(x)$ 进行追踪。鬼点流体法（GFM）被用于施加因表面张力而产生的跨界面的急剧压力跳跃。表面张力系数为 $\\gamma$ （单位：$\\mathrm{N} \\cdot \\mathrm{m}^{-1}$），跨界面的压力跳跃由拉普拉斯-杨（Laplace–Young）条件 $[p] = \\gamma \\kappa$ 给出，其中 $\\kappa$ 是界面曲率。\n\n为减少网格引起的混叠，在计算曲率之前，通过与标准差为 $\\sigma$（单位：$\\mathrm{m}$）的各向同性高斯核进行卷积，对水平集场进行正则化。曲率由正则化后的场，通过标准的水平集公式 $\\kappa = \\nabla \\cdot \\left( \\frac{\\nabla \\phi}{|\\nabla \\phi|} \\right)$ 计算得出，其中空间导数在网格上使用二阶中心差分计算。\n\n假设在小斜率体系 $A k \\ll 1$ 下，曲率在主导阶上简化为界面形状在 $x$ 方向的二阶导数。同时假设波数 $k$ 满足 $0  k  \\pi/h$。在这些假设下，进行线性化傅里叶分析，以确定高斯正则化和离散二阶微分的组合如何相对于真实曲率振幅，改变估算曲率的振幅。具体来说，推导比率\n$$\nR(h,\\sigma,k) = \\frac{\\text{估算曲率振幅}}{\\text{真实曲率振幅}} \\, ,\n$$\n的闭式解析表达式，用 $h$、$\\sigma$ 和 $k$ 表示。\n\n你的最终答案必须是 $R(h,\\sigma,k)$ 的一个单一闭式解析表达式。", "solution": "该问题要求在特定的数值处理下，针对正弦界面，推导估算曲率振幅与真实曲率振幅之比 $R(h,\\sigma,k)$。分析将分三个阶段进行：首先，在指定的物理体系下确定真实曲率振幅；其次，确定由高斯正则化和离散微分产生的估算曲率振幅；最后，计算这两个振幅的比率。\n\n**第1步：真实曲率振幅**\n\n物质界面由函数 $y = f(x)$ 描述，其中 $f(x) = A \\sin(k x)$。由 $y=f(x)$ 定义的曲线的精确曲率 $\\kappa$ 由以下公式给出：\n$$\n\\kappa_{true}(x) = \\frac{f''(x)}{\\left(1 + [f'(x)]^2\\right)^{3/2}}\n$$\n这个符号约定与水平集公式 $\\phi(x,y)=f(x)-y$ 一致。然而，问题指定了 $\\phi(x,y) = y-f(x)$。对于此选择，曲率为 $\\kappa = \\nabla \\cdot (\\nabla \\phi / |\\nabla \\phi|)$，其计算结果为：\n$$\n\\kappa_{true}(x) = \\frac{-f''(x)}{\\left(1 + [f'(x)]^2\\right)^{3/2}}\n$$\n$f(x)$ 的导数为：\n$$\nf'(x) = A k \\cos(k x)\n$$\n$$\nf''(x) = -A k^2 \\sin(k x)\n$$\n问题陈述我们在小斜率体系下操作，其中 $A k \\ll 1$。这意味着 $[f'(x)]^2 = (A k \\cos(k x))^2 \\ll 1$。因此，曲率表达式的分母可以在主导阶上近似为 $(1 + [f'(x)]^2)^{3/2} \\approx 1$。\n问题陈述明确指示我们使用此简化：“假设在小斜率体系...下，曲率在主导阶上简化为界面形状在 $x$ 方向的二阶导数。”采用水平集公式的符号，真实曲率近似为：\n$$\n\\kappa_{true}(x) \\approx -f''(x) = -(-A k^2 \\sin(k x)) = A k^2 \\sin(k x)\n$$\n真实曲率的振幅是正弦项的系数，即：\n$$\nK_{true} = A k^2\n$$\n\n**第2步：估算曲率振幅**\n\n估算曲率是从正则化的水平集场 $\\phi_{reg}$ 计算得出的，然后使用离散格式对其进行微分。\n\n首先，我们分析正则化的效果。水平集场 $\\phi(x,y) = y - A \\sin(k x)$ 与标准差为 $\\sigma$ 的二维各向同性高斯核 $G(x,y)$ 进行卷积：\n$$\n\\phi_{reg}(x,y) = (\\phi * G)(x,y)\n$$\n卷积是线性运算。项 $y$ 与归一化高斯核的卷积结果为 $y$。卷积作用于界面形状函数 $f(x) = A \\sin(k x)$。由于 $f(x)$ 仅是 $x$ 的函数，与二维高斯核 $G(x,y) = \\frac{1}{2 \\pi \\sigma^2} \\exp(-\\frac{x^2+y^2}{2\\sigma^2})$ 的卷积实际上简化为与一维高斯核 $G_{1D}(x) = \\frac{1}{\\sqrt{2\\pi}\\sigma} \\exp(-\\frac{x^2}{2\\sigma^2})$ 的卷积。\n在傅里叶空间中，卷积变为乘法。正弦函数 $A \\sin(k x)$ 的傅里叶变换由位于波数 $+k$ 和 $-k$ 处的脉冲组成。一维高斯核的傅里叶变换是 $\\hat{G}_{1D}(k_x) = \\exp(-\\frac{\\sigma^2 k_x^2}{2})$。将此滤波器应用于正弦函数，会将其振幅乘以传递函数在特定波数 $k$ 处的值。\n因此，正则化后的界面形状 $f_{reg}(x)$ 为：\n$$\nf_{reg}(x) = A \\sin(k x) \\cdot \\exp\\left(-\\frac{\\sigma^2 k^2}{2}\\right)\n$$\n正则化后的水平集场为 $\\phi_{reg}(x,y) = y - f_{reg}(x)$。\n\n接下来，我们分析离散微分的效果。问题陈述曲率是使用二阶中心差分计算的，并且在小斜率近似下，这简化为计算界面形状的二阶导数。与真实曲率的近似一致，估算的曲率为 $\\kappa_{est}(x) \\approx -\\delta_x^2[f_{reg}(x)]$，其中 $\\delta_x^2$ 是二阶导数的二阶中心差分算子，定义为：\n$$\n\\delta_x^2[g(x)] = \\frac{g(x+h) - 2g(x) + g(x-h)}{h^2}\n$$\n我们将此算子应用于 $f_{reg}(x) = A \\exp(-\\frac{\\sigma^2 k^2}{2}) \\sin(k x)$。令 $A_{reg} = A \\exp(-\\frac{\\sigma^2 k^2}{2})$。\n$$\n\\delta_x^2[f_{reg}(x)] = A_{reg} \\left( \\frac{\\sin(k(x+h)) - 2\\sin(kx) + \\sin(k(x-h))}{h^2} \\right)\n$$\n使用三角恒等式 $\\sin(\\alpha+\\beta) + \\sin(\\alpha-\\beta) = 2\\sin(\\alpha)\\cos(\\beta)$，我们得到：\n$$\n\\delta_x^2[f_{reg}(x)] = A_{reg} \\left( \\frac{2\\sin(kx)\\cos(kh) - 2\\sin(kx)}{h^2} \\right) = A_{reg} \\sin(kx) \\left( \\frac{2(\\cos(kh)-1)}{h^2} \\right)\n$$\n使用半角恒等式 $\\cos(\\theta) - 1 = -2\\sin^2(\\theta/2)$，表达式变为：\n$$\n\\delta_x^2[f_{reg}(x)] = A_{reg} \\sin(kx) \\left( \\frac{2(-2\\sin^2(kh/2))}{h^2} \\right) = - A_{reg} \\sin(kx) \\left( \\frac{4\\sin^2(kh/2)}{h^2} \\right)\n$$\n估算的曲率为 $\\kappa_{est}(x) \\approx -\\delta_x^2[f_{reg}(x)]$:\n$$\n\\kappa_{est}(x) \\approx - \\left( - A_{reg} \\sin(kx) \\left( \\frac{4\\sin^2(kh/2)}{h^2} \\right) \\right) = A_{reg} \\left( \\frac{4\\sin^2(kh/2)}{h^2} \\right) \\sin(kx)\n$$\n代回 $A_{reg} = A \\exp(-\\frac{\\sigma^2 k^2}{2})$，我们得到：\n$$\n\\kappa_{est}(x) = A \\exp\\left(-\\frac{\\sigma^2 k^2}{2}\\right) \\left( \\frac{4\\sin^2(kh/2)}{h^2} \\right) \\sin(kx)\n$$\n估算曲率的振幅是正弦项的系数：\n$$\nK_{est} = A \\exp\\left(-\\frac{\\sigma^2 k^2}{2}\\right) \\frac{4\\sin^2(kh/2)}{h^2}\n$$\n\n**第3步：振幅之比**\n\n最后，我们计算比率 $R(h, \\sigma, k) = K_{est} / K_{true}$：\n$$\nR(h, \\sigma, k) = \\frac{A \\exp\\left(-\\frac{\\sigma^2 k^2}{2}\\right) \\frac{4\\sin^2(kh/2)}{h^2}}{A k^2}\n$$\n简化表达式：\n$$\nR(h, \\sigma, k) = \\exp\\left(-\\frac{\\sigma^2 k^2}{2}\\right) \\frac{4\\sin^2(kh/2)}{k^2 h^2}\n$$\n通过重新整理分母，可以将其改写为更标准的形式：\n$$\nR(h, \\sigma, k) = \\exp\\left(-\\frac{\\sigma^2 k^2}{2}\\right) \\left(\\frac{2\\sin(kh/2)}{kh}\\right)^2 = \\exp\\left(-\\frac{\\sigma^2 k^2}{2}\\right) \\left(\\frac{\\sin(kh/2)}{kh/2}\\right)^2\n$$\n这个表达式 $R(h, \\sigma, k)$ 代表了高斯正则化（指数项）和二阶中心差分格式（平方的类 sinc 函数项）对波数为 $k$ 的正弦模式计算曲率振幅的综合阻尼效应。", "answer": "$$\\boxed{\\exp\\left(-\\frac{\\sigma^2 k^2}{2}\\right) \\left( \\frac{\\sin\\left(\\frac{kh}{2}\\right)}{\\frac{kh}{2}} \\right)^2}$$", "id": "3323621"}, {"introduction": "最后的这项实践将综合你所学的知识，将 GFM 应用于计算流体动力学中的一个经典问题：不可压缩双流体流动。你将超越标量问题，为欧拉方程所描述的压力-速度耦合系统设计幽灵状态。该练习 [@problem_id:3323627] 的核心是进行一项分析，将 GFM 实现的数值精度与物理不稳定性（瑞利-泰勒不稳定性）的预测直接联系起来。这个综合性问题展示了 GFM 在多物理场环境中的强大功能，并突出了数值方法与其所模拟的物理现象之间至关重要的相互作用。", "problem": "您将为两种不同密度的不可压缩、无粘性流体之间的清晰界面设计并验证一个一维法向的鬼点法（Ghost Fluid Method, GFM）构造，然后分析用于近似GFM中曲率的外推阶数如何影响小振幅界面扰动的瑞利-泰勒（Rayleigh–Taylor）增长率。您的推导和算法必须从第一性原理出发：不可压缩欧拉方程以及在存在表面张力情况下跨物质界面的经典跳跃条件，不得使用任何预先推导的鬼点流体公式。\n\n考虑一个与界面法线对齐的单一平面计算模板。界面局部弯曲，曲率为 $\\kappa$，位于法向坐标 $x = 0$ 处。流体 1 占据 $x \\lt 0$ 区域，密度为 $\\rho_1$；流体 2 占据 $x \\gt 0$ 区域，密度为 $\\rho_2$。法向量从流体 1 指向流体 2。与界面相邻的单元中心分别位于 $x=-h_1$（在流体 1 中）和 $x=+h_2$（在流体 2 中），其中 $h_1 = \\theta \\, \\Delta$ 和 $h_2 = (1-\\theta)\\, \\Delta$，网格间距为 $\\Delta$ 且 $0 \\lt \\theta \\lt 1$。您可以假设在这些距离上，两侧的压力呈局部线性变化。\n\n您的任务是：\n\n1) 从第一性原理设计鬼点状态。从不可压缩欧拉方程和由质量与动量守恒（在有表面张力的情况下）得出的界面跳跃条件开始。使用压力跳跃等于表面张力与曲率之积的动力学条件，以及法向速度连续的运动学条件。由此，为压力及其法向通量推导与不可压缩流投影法中出现的可变系数压力泊松方程相一致的局部界面条件。利用这些界面条件，推导鬼点压力值 $p_2(x=-h_1)$ 和 $p_1(x=+h_2)$ 的显式、闭合形式表达式，用已知的材料参数 $\\rho_1$、$\\rho_2$、$\\sigma$、$\\kappa$，距离 $h_1$、$h_2$，以及已知的单元中心压力 $p_1(x=-h_1)$ 和 $p_2(x=+h_2)$ 来表示。此外，为法向速度设计一个一致的鬼点，以强制实现跨界面的法向速度连续性。您必须在不使用任何捷径公式的情况下推导出这些关系。\n\n2) 人工解验证。考虑界面两侧的局部线性人工压力场，在流体1侧界面压力为未知值 $p_{1,I}$，法向梯度为 $g_1$ 和 $g_2$，使得对于 $x \\le 0$ 有 $p_1(x) = p_{1,I} + g_1 x$，对于 $x \\ge 0$ 有 $p_2(x) = p_{2,I} + g_2 x$，其中 $p_{2,I} = p_{1,I} + \\sigma \\kappa$。施加与可变密度投影算子一致的通量连续性条件，并证明当给定由人工场生成的 $p_1(-h_1)$ 和 $p_2(+h_2)$ 时，您的鬼点状态公式能重现 $x=-h_1$ 和 $x=+h_2$ 处的精确人工鬼点值。对于法向速度，在界面附近使用一个恒定的人工值，并验证您的鬼点构造在这种情况下是精确的。\n\n3) 考虑表面张力的瑞利-泰勒（RT）线性增长及对曲率外推阶数的敏感性。从具有平坦基态和小正弦扰动（波数为 $k$）的线性化、无粘性、不可压缩两相流公式出发，推导连接增长率与物理参数的色散关系。然后，为鬼点法中使用的 $m$ 阶曲率外推误差的影响，提出了一个有原则的模型。假设离散曲率的相对误差形式为 $\\varepsilon_\\kappa \\approx C (k \\Delta)^m$，其中 $C = 1$（最坏情况缩放），并说明这如何在增长率公式中引入一个有效表面张力 $\\sigma_{\\text{eff}} = \\sigma \\left(1 + (k \\Delta)^m\\right)$。使用此模型计算修正后的数值增长率，取物理重力加速度为 $g$，阿特伍德数（Atwood number）为 $A = (\\rho_2 - \\rho_1)/(\\rho_2 + \\rho_1)$。报告实数增长率 $s$（单位为 $\\text{s}^{-1}$），其计算公式为 $s = \\sqrt{\\max\\{0, g k A - (\\sigma_{\\text{eff}}/(\\rho_1+\\rho_2)) k^3\\}}$。\n\n单位：使用国际单位制（SI）。密度单位为 $\\text{kg}/\\text{m}^3$，表面张力单位为 $\\text{N}/\\text{m}$，曲率单位为 $\\text{m}^{-1}$，压力单位为 $\\text{Pa}$，距离单位为 $\\text{m}$，重力加速度 $g$ 单位为 $\\text{m}/\\text{s}^2$，波数 $k$ 单位为 $\\text{m}^{-1}$，网格间距单位为 $\\text{m}$，速度单位为 $\\text{m}/\\text{s}$，增长率 $s$ 单位为 $\\text{s}^{-1}$。增长率表示为四舍五入到六位小数。\n\n测试套件：您的程序必须实现您推导的鬼点状态和RT增长计算，并评估以下四种情况。对于每种情况，程序必须生成人工数据，计算鬼点状态，与人工真值进行核对，并使用敏感性模型计算RT增长率。\n\n- 情况 1 (一般情况)：$\\rho_1 = 1.0$, $\\rho_2 = 2.0$, $\\sigma = 0.02$, $\\kappa = 100.0$, $p_{1,I} = 101325.0$, $g_1 = 1200.0$, $g_2 = (\\rho_2/\\rho_1) g_1$, $\\Delta = 0.005$, $\\theta = 0.3$ 因此 $h_1 = \\theta \\Delta$ 且 $h_2 = (1-\\theta)\\Delta$, 人工法向速度 $u_I = 0.5$ (在界面附近为常数), 重力加速度 $g = 9.81$, 波数 $k = 10.0$, 外推阶数 $m = 1$。\n\n- 情况 2 (零阿特伍德数，稳定)：$\\rho_1 = 1.0$, $\\rho_2 = 1.0$, $\\sigma = 0.02$, $\\kappa = 80.0$, $p_{1,I} = 100000.0$, $g_1 = 500.0$, $g_2 = (\\rho_2/\\rho_1) g_1$, $\\Delta = 0.004$, $\\theta = 0.45$, $u_I = 0.2$, $g = 9.81$, $k = 10.0$, $m = 2$。\n\n- 情况 3 (设计为临界稳定)：$\\rho_1 = 1.0$, $\\rho_2 = 3.0$, $\\kappa = 50.0$, $p_{1,I} = 120000.0$, $g_1 = 1500.0$, $g_2 = (\\rho_2/\\rho_1) g_1$, $\\Delta = 0.005$, $\\theta = 0.2$, $u_I = 0.0$, $g = 9.81$, $k = 20.0$, $m = 2$, 表面张力根据敏感性模型选择，以使增长率恰好为零：\n$$\n\\sigma = \\frac{(\\rho_1+\\rho_2)\\, g \\, A}{k^2 \\left(1 + (k \\Delta)^m\\right)} \\quad \\text{with} \\quad A = \\frac{\\rho_2 - \\rho_1}{\\rho_1 + \\rho_2}.\n$$\n\n- 情况 4 (高阶外推效应)：与情况1相同，但外推阶数为 $m = 3$。为测试不同局部几何形状下的鬼点重构，使用以下参数：$\\kappa = 120.0$, $p_{1,I} = 100800.0$, $g_1 = 1000.0$, $g_2 = (\\rho_2/\\rho_1) g_1$, $\\theta = 0.6$。\n\n人工数据和检查：对于每种情况，生成\n- $p_1(-h_1) = p_{1,I} - g_1 h_1$,\n- $p_2(+h_2) = p_{2,I} + g_2 h_2$ 其中 $p_{2,I} = p_{1,I} + \\sigma \\kappa$,\n- 精确的鬼点值 $p_2(-h_1) = p_{2,I} - g_2 h_1$ 和 $p_1(+h_2) = p_{1,I} + g_1 h_2$,\n- 法向速度 $u_1(-h_1) = u_2(+h_2) = u_I$。\n使用您推导的鬼点状态公式计算数值鬼点值，并以 $10^{-10}$ 的绝对容差与精确的人工值进行核对。对于速度，验证您的鬼点构造对于这个恒定的人工场，在两个鬼点位置上都能精确地得到 $u_I$。\n\n必需的最终输出格式：您的程序应生成单行输出，包含一个逗号分隔的Python列表，其中包含按以下严格顺序排列的十二个条目：\n[ghost_p_ok_case1, ghost_u_ok_case1, s_case1, ghost_p_ok_case2, ghost_u_ok_case2, s_case2, ghost_p_ok_case3, ghost_u_ok_case3, s_case3, ghost_p_ok_case4, ghost_u_ok_case4, s_case4]\n其中每个鬼点标志是布尔值，每个增长率s是浮点数，单位为s^{-1}，四舍五入到六位小数。", "solution": "用户提供了一个关于计算流体动力学的综合性问题，重点是用于清晰界面的鬼点法（GFM）。该问题定义明确，有科学依据，并包含了所有必要的信息。\n\n### 第1部分：从第一性原理设计鬼点状态\n\n我们的任务是推导两种不可压缩、无粘性流体之间清晰界面处的压力和法向速度的鬼点流体状态。\n\n**1.1. 压力鬼点状态**\n\n模型是一维的，界面位于 $x=0$。流体1（密度 $\\rho_1$）在 $x0$ 区域，流体2（密度 $\\rho_2$）在 $x>0$ 区域。我们假设压力剖面为局部线性：\n$p_1(x) = p_{1,I} + g_1 x$ 对于 $x \\le 0$\n$p_2(x) = p_{2,I} + g_2 x$ 对于 $x \\ge 0$\n其中 $p_{1,I}$ 和 $p_{2,I}$ 是界面两侧的压力，$g_1, g_2$ 是恒定的压力梯度。\n\n推导基于界面（$x=0$）处的三个基本条件：\n1.  **动力学条件（压力跳跃）**：压力跳跃由表面张力 $\\sigma$ 和曲率 $\\kappa$ 平衡。法向量从流体1指向流体2。标准惯例是压力在凹侧更高。对于一个凸向流体2的凸起（根据某些约定，曲率 $\\kappa$ 为正），流体1位于凹侧，因此 $p_1 > p_2$。这将意味着 $p_2 - p_1 = -\\sigma\\kappa$。然而，问题陈述中指定 $[p] = p_2 - p_1 = \\sigma\\kappa$。我们遵循这个给定的条件，结合稍后提供的标准瑞利-泰勒色散关系，这意味着对于 $\\kappa$ 有一个内部一致的符号约定。\n    $p_2(0) - p_1(0) = p_{2,I} - p_{1,I} = \\sigma\\kappa$。\n\n2.  **通量连续性**：对于可变密度投影方法，动量方程中压力梯度除以密度的项在法向方向上必须是连续的，以确保界面处的质量守恒。这给出了法向压力通量的条件：\n    $[\\frac{1}{\\rho}\\frac{\\partial p}{\\partial n}] = 0 \\implies \\frac{1}{\\rho_2}\\frac{dp_2}{dx}\\bigg|_{x=0} = \\frac{1}{\\rho_1}\\frac{dp_1}{dx}\\bigg|_{x=0} \\implies \\frac{g_2}{\\rho_2} = \\frac{g_1}{\\rho_1}$。\n\n3.  **与单元中心值的一致性**：线性剖面必须与相邻单元中心已知的压力 $p_1(-h_1)$ 和 $p_2(h_2)$ 相匹配。\n    $p_1(-h_1) = p_{1,I} - g_1 h_1 \\implies p_{1,I} = p_1(-h_1) + g_1 h_1$。\n    $p_2(h_2) = p_{2,I} + g_2 h_2 \\implies p_{2,I} = p_2(h_2) - g_2 h_2$。\n\n我们得到了一个关于四个未知数（$p_{1,I}, p_{2,I}, g_1, g_2$）的四元线性方程组。我们可以求解梯度 $g_1$ 和 $g_2$。首先，将 $p_{1,I}$ 和 $p_{2,I}$ 的表达式代入压力跳跃条件：\n$(p_2(h_2) - g_2 h_2) - (p_1(-h_1) + g_1 h_1) = \\sigma\\kappa$。\n整理得：$p_2(h_2) - p_1(-h_1) - \\sigma\\kappa = g_1 h_1 + g_2 h_2$。\n现在，使用通量连续性条件 $g_2 = (\\rho_2/\\rho_1) g_1$ 来消去 $g_2$：\n$p_2(h_2) - p_1(-h_1) - \\sigma\\kappa = g_1 h_1 + (\\frac{\\rho_2}{\\rho_1}g_1) h_2 = g_1 \\left(h_1 + \\frac{\\rho_2}{\\rho_1} h_2\\right)$。\n解出 $g_1$：\n$$g_1 = \\frac{p_2(h_2) - p_1(-h_1) - \\sigma\\kappa}{h_1 + (\\rho_2/\\rho_1) h_2}$$\n以及 $g_2$：\n$$g_2 = \\frac{\\rho_2}{\\rho_1} g_1 = \\frac{p_2(h_2) - p_1(-h_1) - \\sigma\\kappa}{(\\rho_1/\\rho_2) h_1 + h_2}$$\n\n鬼点压力通过将线性剖面外推到相对的流体域来找到。\n流体1的鬼点压力（在单元中心 $x=-h_1$ 处）是流体2压力场在该位置的值 $p_2(-h_1)$：\n$$p_{2,G} = p_2(-h_1) = p_{2,I} - g_2 h_1 = (p_2(h_2) - g_2 h_2) - g_2 h_1 = p_2(h_2) - g_2(h_1+h_2)$$\n流体2的鬼点压力（在单元中心 $x=h_2$ 处）是流体1压力场在该位置的值 $p_1(h_2)$：\n$$p_{1,G} = p_1(h_2) = p_{1,I} + g_1 h_2 = (p_1(-h_1) + g_1 h_1) + g_1 h_2 = p_1(-h_1) + g_1(h_1+h_2)$$\n这些推导出的表达式是完整且闭合的。\n\n**1.2. 速度鬼点状态**\n\n运动学条件是法向速度的连续性：$u_1(0) = u_2(0) = u_I$。对于连续变量，一个标准且鲁棒的GFM构造是首先估计界面值 $u_I$，然后将此值用于鬼点状态。我们通过对单元中心值 $u_1(-h_1)$ 和 $u_2(h_2)$ 进行线性插值来估计 $u_I$：\n$$u_I = \\frac{h_2 \\, u_1(-h_1) + h_1 \\, u_2(h_2)}{h_1+h_2}$$\n然后通过从界面进行常数外推来定义鬼点值，这仅仅意味着将它们设置为界面值：\n$u_{2,G} = u_2(-h_1) = u_I$\n$u_{1,G} = u_1(h_2) = u_I$\n这确保了任何后续跨界面的插值都将恢复连续值 $u_I$。\n\n### 第2部分：人工解验证\n\n我们使用一个能精确满足底层连续方程的人工解来验证所推导的GFM公式。\n压力场为 $p_1(x) = p_{1,I} + g_1 x$ 和 $p_2(x) = p_{2,I} + g_2 x$，其中 $p_{2,I} = p_{1,I} + \\sigma \\kappa$ 且 $g_2/\\rho_2 = g_1/\\rho_1$。\n我们GFM公式的输入是从此解中生成的单元中心数据：\n$p_{1, \\text{in}} = p_1(-h_1) = p_{1,I} - g_1 h_1$\n$p_{2, \\text{in}} = p_2(h_2) = p_{2,I} + g_2 h_2$\n将这些代入我们推导的 $g_1$ 公式中：\n$g_{1, \\text{GFM}} = \\frac{(p_{2,I} + g_2 h_2) - (p_{1,I} - g_1 h_1) - \\sigma\\kappa}{h_1 + (\\rho_2/\\rho_1) h_2} = \\frac{(p_{2,I}-p_{1,I}) + g_1 h_1 + g_2 h_2 - \\sigma\\kappa}{h_1 + (\\rho_2/\\rho_1) h_2}$\n使用 $p_{2,I}-p_{1,I} = \\sigma\\kappa$ 和 $g_2 = (\\rho_2/\\rho_1)g_1$：\n$g_{1, \\text{GFM}} = \\frac{\\sigma\\kappa + g_1 h_1 + (\\rho_2/\\rho_1)g_1 h_2 - \\sigma\\kappa}{h_1 + (\\rho_2/\\rho_1) h_2} = \\frac{g_1(h_1 + (\\rho_2/\\rho_1) h_2)}{h_1 + (\\rho_2/\\rho_1) h_2} = g_1$。\nGFM过程精确地恢复了人工梯度。因此，$g_{2, \\text{GFM}} = g_2$。\n\n现在我们检查鬼点压力。对于流体1：\n$p_{2,G, \\text{GFM}} = p_{2, \\text{in}} - g_{2, \\text{GFM}}(h_1+h_2) = (p_{2,I} + g_2 h_2) - g_2(h_1+h_2) = p_{2,I} - g_2 h_1$。\n精确的人工值为 $p_2(-h_1) = p_{2,I} + g_2(-h_1) = p_{2,I} - g_2 h_1$。结果是精确的。\n对 $p_{1,G}$ 的检查遵循对称性，同样是精确的。\n\n对于速度，人工场是常数，$u(x) = u_I$。输入为 $u_1(-h_1) = u_I$ 和 $u_2(h_2) = u_I$。\n我们的GFM构造给出的界面速度是：\n$u_{I, \\text{GFM}} = \\frac{h_2 \\, u_I + h_1 \\, u_I}{h_1+h_2} = u_I$。\n鬼点值则为 $u_{1,G} = u_{2,G} = u_I$。这与人工鬼点值完全匹配。\n\n### 第3部分：瑞利-泰勒线性增长分析\n\n对于分离两种无粘性、不可压缩流体的平面界面，包括重力 $g$ 和表面张力 $\\sigma$ 在内的瑞利-泰勒不稳定性的经典色散关系是：\n$$s^2 = \\frac{g k (\\rho_2 - \\rho_1) - \\sigma k^3}{\\rho_1 + \\rho_2}$$\n其中 $k$ 是扰动的波数，$s$ 是增长率。当 $g(\\rho_2-\\rho_1)$ 项为正（重流体在轻流体之上，$\\rho_2>\\rho_1$）且大到足以克服表面张力的稳定效应时，会发生不稳定增长（$s^2 > 0$）。使用阿特伍德数 $A = (\\rho_2-\\rho_1)/(\\rho_2+\\rho_1)$，这变成：\n$$s^2 = g k A - \\frac{\\sigma k^3}{\\rho_1+\\rho_2}$$\n问题假设，从界面位置计算曲率的数值误差引入了一个 $m$ 阶的相对误差，其中 $m$ 是外推方案的阶数：$\\varepsilon_\\kappa = (k\\Delta)^m$。这个误差会传播到压力跳跃条件中，使得数值上表现得好像存在一个有效表面张力 $\\sigma_{\\text{eff}}$：\n$[p]_{\\text{num}} = \\sigma\\kappa_{\\text{num}} = \\sigma\\kappa_{\\text{exact}}(1 + (k\\Delta)^m) \\implies \\sigma_{\\text{eff}} = \\sigma(1 + (k\\Delta)^m)$。\n将此代入色散关系，得到建模的数值增长率 $s_{\\text{num}}$：\n$$s_{\\text{num}}^2 = g k A - \\frac{\\sigma_{\\text{eff}} k^3}{\\rho_1+\\rho_2} = g k A - \\frac{\\sigma(1+(k\\Delta)^m)k^3}{\\rho_1+\\rho_2}$$\n实际增长率为 $s = \\sqrt{\\max(0, s_{\\text{num}}^2)}$。这提供了一个定量模型，用于评估数值离散化误差对系统物理稳定性的影响。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main solver function that orchestrates the execution for all test cases.\n    \"\"\"\n\n    # Test cases defined as dictionaries\n    test_cases = [\n        # Case 1 (general)\n        {\n            \"rho1\": 1.0, \"rho2\": 2.0, \"sigma\": 0.02, \"kappa\": 100.0,\n            \"p1_I\": 101325.0, \"g1\": 1200.0, \"Delta\": 0.005, \"theta\": 0.3,\n            \"u_I\": 0.5, \"g\": 9.81, \"k\": 10.0, \"m\": 1, \"case_id\": 1\n        },\n        # Case 2 (zero Atwood, stabilized)\n        {\n            \"rho1\": 1.0, \"rho2\": 1.0, \"sigma\": 0.02, \"kappa\": 80.0,\n            \"p1_I\": 100000.0, \"g1\": 500.0, \"Delta\": 0.004, \"theta\": 0.45,\n            \"u_I\": 0.2, \"g\": 9.81, \"k\": 10.0, \"m\": 2, \"case_id\": 2\n        },\n        # Case 3 (marginal stability by design)\n        {\n            \"rho1\": 1.0, \"rho2\": 3.0, \"sigma\": None, \"kappa\": 50.0,\n            \"p1_I\": 120000.0, \"g1\": 1500.0, \"Delta\": 0.005, \"theta\": 0.2,\n            \"u_I\": 0.0, \"g\": 9.81, \"k\": 20.0, \"m\": 2, \"case_id\": 3\n        },\n        # Case 4 (higher-order extrapolation effect)\n        {\n            \"rho1\": 1.0, \"rho2\": 2.0, \"sigma\": 0.02, \"kappa\": 120.0,\n            \"p1_I\": 100800.0, \"g1\": 1000.0, \"Delta\": 0.005, \"theta\": 0.6,\n            \"u_I\": 0.5, \"g\": 9.81, \"k\": 10.0, \"m\": 3, \"case_id\": 4\n        }\n    ]\n\n    all_results = []\n    for params in test_cases:\n        result = process_case(params)\n        all_results.extend(result)\n    \n    print(f\"[{','.join(all_results)}]\")\n\n\ndef process_case(params):\n    \"\"\"\n    Processes a single test case, performs all calculations, and returns results.\n    \"\"\"\n    rho1, rho2 = params[\"rho1\"], params[\"rho2\"]\n    sigma, kappa = params[\"sigma\"], params[\"kappa\"]\n    p1_I, g1 = params[\"p1_I\"], params[\"g1\"]\n    Delta, theta = params[\"Delta\"], params[\"theta\"]\n    u_I_manuf = params[\"u_I\"]\n    g_accel, k, m = params[\"g\"], params[\"k\"], params[\"m\"]\n    \n    # Calculate geometric and derived parameters\n    h1 = theta * Delta\n    h2 = (1 - theta) * Delta\n    g2 = (rho2 / rho1) * g1\n    Atwood = (rho2 - rho1) / (rho2 + rho1)\n\n    # Handle Case 3: sigma is calculated for marginal stability\n    if sigma is None:\n        sigma_eff_target = (g_accel * Atwood * (rho1 + rho2)) / (k**2)\n        sigma = sigma_eff_target / (1 + (k * Delta)**m)\n    \n    # --- Part 1: Manufactured Solution Synthesis ---\n    \n    # Synthesize manufactured data at cell centers\n    p2_I = p1_I + sigma * kappa\n    p1_mh1_manuf = p1_I - g1 * h1\n    p2_h2_manuf = p2_I + g2 * h2\n    u1_mh1_manuf = u_I_manuf\n    u2_h2_manuf = u_I_manuf\n\n    # Synthesize exact ghost values\n    p2_ghost_exact = p2_I - g2 * h1\n    p1_ghost_exact = p1_I + g1 * h2\n    u_ghost_exact = u_I_manuf\n\n    # --- Part 2: Ghost State Computation using GFM formulas ---\n\n    # GFM for Pressure\n    g1_gfm = (p2_h2_manuf - p1_mh1_manuf - sigma * kappa) / (h1 + (rho2 / rho1) * h2)\n    g2_gfm = (rho2 / rho1) * g1_gfm\n    \n    p2_ghost_gfm = p2_h2_manuf - g2_gfm * (h1 + h2)\n    p1_ghost_gfm = p1_mh1_manuf + g1_gfm * (h1 + h2)\n\n    # GFM for Velocity\n    u_I_gfm = (h2 * u1_mh1_manuf + h1 * u2_h2_manuf) / (h1 + h2)\n    u_ghost_gfm = u_I_gfm\n\n    # --- Part 3: Verification ---\n    \n    tol = 1e-10\n    ghost_p_ok = np.allclose([p1_ghost_gfm, p2_ghost_gfm], [p1_ghost_exact, p2_ghost_exact], atol=tol)\n    ghost_u_ok = np.allclose([u_ghost_gfm, u_ghost_gfm], [u_ghost_exact, u_ghost_exact], atol=tol)\n    \n    # --- Part 4: Rayleigh-Taylor Growth Rate Calculation ---\n    \n    sigma_eff = sigma * (1 + (k * Delta)**m)\n    s_squared = g_accel * k * Atwood - (sigma_eff * k**3) / (rho1 + rho2)\n    s = np.sqrt(max(0, s_squared))\n    \n    # Format results for final output\n    return [str(ghost_p_ok), str(ghost_u_ok), f\"{s:.6f}\"]\n\nsolve()\n```", "id": "3323627"}]}