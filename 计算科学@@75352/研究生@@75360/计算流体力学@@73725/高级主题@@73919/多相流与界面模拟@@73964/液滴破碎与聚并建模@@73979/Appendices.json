{"hands_on_practices": [{"introduction": "在液滴动力学中，表面张力是主导力量之一，其数值表示的准确性取决于界面曲率 $\\kappa$ 的精确计算。第一个练习将带您深入了解像水平集（Level Set）这样的界面捕捉方法的核心。通过推导一个离散曲率估计器，并分析其在简单界面形状下的截断误差，您将对数值离散化如何引入影响模拟物理过程的误差有一个基本的认识。", "problem": "考虑在使用水平集方法进行液滴破碎和聚并建模时，为计算毛细作用力而进行的界面曲率计算。设界面由一个水平集函数 $\\phi(x,y)$ 隐式表示，曲率由几何恒等式 $\\kappa = \\nabla \\cdot \\left( \\frac{\\nabla \\phi}{|\\nabla \\phi|} \\right)$ 定义，其中 $\\nabla$ 表示空间梯度， $|\\cdot|$ 表示欧几里得范数。在间距为 $\\Delta x = \\Delta y = h$ 的均匀笛卡尔网格上进行计算。\n\n基于该定义，从第一性原理出发，构建一个二阶中心差分离散曲率估计器，步骤如下：使用二阶中心差分计算网格节点 $(i,j)$ 处的离散梯度分量，将 $(i,j)$ 处的归一化梯度构造成离散单位法向量，然后计算该离散单位法向量的中心差分散度作为 $(i,j)$ 处的离散曲率。\n\n现在考虑一个由水平集 $\\phi(x,y) = y - \\varepsilon \\cos(\\alpha x)$ 隐式参数化的二维正弦界面，其中 $\\varepsilon$ 是物理振幅（量纲为长度），$\\alpha$ 是波数（量纲为长度的倒数）。关注位于 $x=0$ 处的波峰，界面通过点 $(x,y)=(0,\\varepsilon)$。假设该界面点是一个网格节点。\n\n利用关于波峰的泰勒展开和上述离散程序，对波峰处的离散曲率进行截断误差分析。引入无量纲参数 $\\tilde{\\varepsilon} \\equiv \\alpha \\varepsilon$ 和 $\\delta \\equiv \\alpha h$，并将无量纲离散曲率展开为 $\\kappa_h / \\alpha = \\tilde{\\varepsilon} + C(\\tilde{\\varepsilon}) \\, \\delta^2 + \\mathcal{O}(\\delta^4)$，其中 $\\kappa_h$ 是通过二阶中心差分程序计算的离散曲率。\n\n推导系数 $C(\\tilde{\\varepsilon})$ 的闭式解析表达式。以 $C(\\tilde{\\varepsilon})$ 的精确解析表达式作为最终答案，不带单位。不需要进行数值取整，最终答案中不应包含任何物理单位。", "solution": "用户希望找到离散曲率计算的截断误差展开式中的系数 $C(\\tilde{\\varepsilon})$。\n该问题是适定的，在计算流体动力学和数值分析方面有科学依据，所有术语都有明确定义。设定是自洽和一致的。该问题是有效的。\n\n首先，我们确定界面波峰处的解析曲率，该点位于 $(x,y)=(0, \\varepsilon)$。水平集函数由 $\\phi(x,y) = y - \\varepsilon \\cos(\\alpha x)$ 给出。曲率定义为 $\\kappa = \\nabla \\cdot \\mathbf{n}$，其中 $\\mathbf{n} = \\frac{\\nabla \\phi}{|\\nabla \\phi|}$。\n\n水平集函数的梯度为：\n$$\n\\nabla \\phi = \\left( \\frac{\\partial \\phi}{\\partial x}, \\frac{\\partial \\phi}{\\partial y} \\right) = (\\alpha \\varepsilon \\sin(\\alpha x), 1)\n$$\n梯度的模为：\n$$\n|\\nabla \\phi| = \\sqrt{(\\alpha \\varepsilon \\sin(\\alpha x))^2 + 1^2} = \\sqrt{1 + \\alpha^2 \\varepsilon^2 \\sin^2(\\alpha x)}\n$$\n单位法向量场 $\\mathbf{n} = (n_x, n_y)$ 为：\n$$\n\\mathbf{n} = \\frac{(\\alpha \\varepsilon \\sin(\\alpha x), 1)}{\\sqrt{1 + \\alpha^2 \\varepsilon^2 \\sin^2(\\alpha x)}}\n$$\n曲率 $\\kappa$ 是 $\\mathbf{n}$ 的散度：\n$$\n\\kappa = \\frac{\\partial n_x}{\\partial x} + \\frac{\\partial n_y}{\\partial y}\n$$\n分量 $n_y$ 不依赖于 $y$，因此 $\\frac{\\partial n_y}{\\partial y} = 0$。我们只需要计算 $\\frac{\\partial n_x}{\\partial x}$。\n$$\n\\frac{\\partial n_x}{\\partial x} = \\frac{\\partial}{\\partial x} \\left( \\frac{\\alpha \\varepsilon \\sin(\\alpha x)}{\\left(1 + \\alpha^2 \\varepsilon^2 \\sin^2(\\alpha x)\\right)^{1/2}} \\right)\n$$\n使用商法则，导数的分子是 $(\\alpha^2 \\varepsilon \\cos(\\alpha x))(1 + \\alpha^2 \\varepsilon^2 \\sin^2(\\alpha x))^{1/2}$，分母涉及 $\\sin(\\alpha x)$ 的高阶项。在波峰处，即 $x=0$，我们有 $\\sin(0)=0$ 和 $\\cos(0)=1$。表达式显著简化为：\n$$\n\\kappa(0) = \\left. \\frac{\\partial n_x}{\\partial x} \\right|_{x=0} = \\frac{(\\alpha^2 \\varepsilon \\cos(0))(1 + 0)^{1/2} - (\\dots) \\sin(0)}{1+0} = \\alpha^2 \\varepsilon\n$$\n无量纲解析曲率为 $\\kappa(0) / \\alpha = \\alpha\\varepsilon = \\tilde{\\varepsilon}$。这证实了问题展开式中的主阶项。\n\n现在，我们将在间距为 h 的均匀网格上遵循离散程序。我们关注的点 $(0, \\varepsilon)$ 是一个网格节点，记为 $(i,j)$。离散曲率为 $\\kappa_h = (\\nabla_h \\cdot \\mathbf{n}_h)_{i,j}$，其中 $\\mathbf{n}_h$ 是离散单位法向量。中心差分散度为：\n$$\n\\kappa_h = \\frac{(n_x)_{i+1,j} - (n_x)_{i-1,j}}{2h} + \\frac{(n_y)_{i,j+1} - (n_y)_{i,j-1}}{2h}\n$$\n这需要 $(i,j)$ 的四个邻近点处的离散法向量 $\\mathbf{n}_h$。离散法向量定义为 $\\mathbf{n}_h = \\frac{\\nabla_h \\phi}{|\\nabla_h \\phi|}$，其中 $\\nabla_h \\phi$ 使用中心差分计算。这意味着我们首先需要计算这些邻近节点处的离散梯度。\n\n我们先计算 y 分量项。在节点 $(i, j+1)=(0, \\varepsilon+h)$ 处，离散梯度分量为：\n$$\n(\\phi_x)_h|_{i,j+1} = \\frac{\\phi(h, \\varepsilon+h) - \\phi(-h, \\varepsilon+h)}{2h} = \\frac{[(\\varepsilon+h)-\\varepsilon\\cos(\\alpha h)] - [(\\varepsilon+h)-\\varepsilon\\cos(-\\alpha h)]}{2h} = 0\n$$\n$$\n(\\phi_y)_h|_{i,j+1} = \\frac{\\phi(0, \\varepsilon+2h) - \\phi(0, \\varepsilon)}{2h} = \\frac{[(\\varepsilon+2h)-\\varepsilon] - [(\\varepsilon)-\\varepsilon]}{2h} = \\frac{2h}{2h} = 1\n$$\n因此，$\\nabla_h \\phi|_{i,j+1}=(0,1)$，这导致 $\\mathbf{n}_h|_{i,j+1}=(0,1)$，所以 $(n_y)_{i,j+1}=1$。\n类似地，在节点 $(i,j-1)=(0, \\varepsilon-h)$ 处，\n$$\n(\\phi_x)_h|_{i,j-1} = 0\n$$\n$$\n(\\phi_y)_h|_{i,j-1} = \\frac{\\phi(0, \\varepsilon) - \\phi(0, \\varepsilon-2h)}{2h} = \\frac{0 - [(\\varepsilon-2h)-\\varepsilon]}{2h} = \\frac{2h}{2h}=1\n$$\n所以，$\\mathbf{n}_h|_{i,j-1}=(0,1)$ 且 $(n_y)_{i,j-1}=1$。对 $\\kappa_h$ 的 y 方向贡献为 $\\frac{1-1}{2h} = 0$。\n\n现在来看 x 分量项。我们需要在 $(i+1,j)=(h,\\varepsilon)$ 和 $(i-1,j)=(-h,\\varepsilon)$ 处的 $\\mathbf{n}_h$。\n我们来求 $(i+1,j)$ 处的离散梯度：\n$$\n(\\phi_x)_h|_{i+1,j} = \\frac{\\phi(2h, \\varepsilon) - \\phi(0, \\varepsilon)}{2h} = \\frac{[\\varepsilon-\\varepsilon\\cos(2\\alpha h)] - 0}{2h} = \\frac{\\varepsilon(1-\\cos(2\\alpha h))}{2h}\n$$\n$$\n(\\phi_y)_h|_{i+1,j} = \\frac{\\phi(h, \\varepsilon+h) - \\phi(h, \\varepsilon-h)}{2h} = \\frac{[(\\varepsilon+h)-\\varepsilon\\cos(\\alpha h)] - [(\\varepsilon-h)-\\varepsilon\\cos(\\alpha h)]}{2h} = \\frac{2h}{2h} = 1\n$$\n根据对称性，在 $(i-1,j)$ 处，$(\\phi_x)_h|_{i-1,j} = -(\\phi_x)_h|_{i+1,j}$ 且 $(\\phi_y)_h|_{i-1,j} = 1$。\n\n令 $G_x = (\\phi_x)_h|_{i+1,j}$。我们对小的 h 使用泰勒级数 $\\cos(z) = 1 - \\frac{z^2}{2!} + \\frac{z^4}{4!} - \\mathcal{O}(z^6)$ 展开 $G_x$：\n$$\n1-\\cos(2\\alpha h) = 1 - \\left(1 - \\frac{(2\\alpha h)^2}{2} + \\frac{(2\\alpha h)^4}{24} - \\dots\\right) = 2\\alpha^2 h^2 - \\frac{2}{3}\\alpha^4 h^4 + \\mathcal{O}(h^6)\n$$\n$$\nG_x = \\frac{\\varepsilon}{2h}\\left(2\\alpha^2 h^2 - \\frac{2}{3}\\alpha^4 h^4 + \\mathcal{O}(h^6)\\right) = \\varepsilon\\alpha^2 h - \\frac{1}{3}\\varepsilon\\alpha^4 h^3 + \\mathcal{O}(h^5)\n$$\n法向分量 $(n_x)_{i+1,j}$ 由下式给出：\n$$\n(n_x)_{i+1,j} = \\frac{G_x}{\\sqrt{G_x^2 + 1^2}} = G_x (1+G_x^2)^{-1/2}\n$$\n使用二项式展开 $(1+z)^{-1/2} = 1 - \\frac{1}{2}z + \\mathcal{O}(z^2)$，其中 $z=G_x^2$：\n$$\n(n_x)_{i+1,j} = G_x \\left(1 - \\frac{1}{2}G_x^2 + \\mathcal{O}(G_x^4)\\right) = G_x - \\frac{1}{2}G_x^3 + \\mathcal{O}(G_x^5)\n$$\n$G_x$ 的主阶项是 $\\mathcal{O}(h)$，所以 $G_x^3$ 是 $\\mathcal{O}(h^3)$。在 $(n_x)_{i+1,j}$ 的展开式中，我们需要保留到 $h^3$ 的项：\n$$\nG_x = \\varepsilon\\alpha^2 h - \\frac{1}{3}\\varepsilon\\alpha^4 h^3 + \\mathcal{O}(h^5)\n$$\n$$\nG_x^3 = \\left(\\varepsilon\\alpha^2 h\\right)^3 + \\mathcal{O}(h^5) = \\varepsilon^3\\alpha^6 h^3 + \\mathcal{O}(h^5)\n$$\n将这些代入 $(n_x)_{i+1,j}$ 的表达式中：\n$$\n(n_x)_{i+1,j} = \\left(\\varepsilon\\alpha^2 h - \\frac{1}{3}\\varepsilon\\alpha^4 h^3\\right) - \\frac{1}{2}\\left(\\varepsilon^3\\alpha^6 h^3\\right) + \\mathcal{O}(h^5)\n$$\n$$\n(n_x)_{i+1,j} = \\varepsilon\\alpha^2 h - \\left(\\frac{1}{3}\\varepsilon\\alpha^4 + \\frac{1}{2}\\varepsilon^3\\alpha^6\\right)h^3 + \\mathcal{O}(h^5)\n$$\n由于对称性，$(\\nabla_h\\phi)|_{i-1,j} = (-G_x, 1)$，所以 $(n_x)_{i-1,j} = \\frac{-G_x}{\\sqrt{G_x^2+1}} = -(n_x)_{i+1,j}$。\n现在我们组合离散曲率 $\\kappa_h$：\n$$\n\\kappa_h = \\frac{(n_x)_{i+1,j} - (-(n_x)_{i+1,j})}{2h} + 0 = \\frac{2(n_x)_{i+1,j}}{2h} = \\frac{(n_x)_{i+1,j}}{h}\n$$\n$$\n\\kappa_h = \\frac{1}{h}\\left[\\varepsilon\\alpha^2 h - \\left(\\frac{1}{3}\\varepsilon\\alpha^4 + \\frac{1}{2}\\varepsilon^3\\alpha^6\\right)h^3 + \\mathcal{O}(h^5)\\right]\n$$\n$$\n\\kappa_h = \\varepsilon\\alpha^2 - \\left(\\frac{1}{3}\\varepsilon\\alpha^4 + \\frac{1}{2}\\varepsilon^3\\alpha^6\\right)h^2 + \\mathcal{O}(h^4)\n$$\n问题要求将无量纲曲率 $\\kappa_h / \\alpha$ 展开为关于 $\\tilde{\\varepsilon} = \\alpha\\varepsilon$ 和 $\\delta = \\alpha h$ 的表达式。\n$$\n\\frac{\\kappa_h}{\\alpha} = \\varepsilon\\alpha - \\frac{1}{\\alpha}\\left(\\frac{1}{3}\\varepsilon\\alpha^4 + \\frac{1}{2}\\varepsilon^3\\alpha^6\\right)h^2 + \\mathcal{O}(h^4)\n$$\n让我们用无量纲变量重写括号内的项：\n$$\n\\frac{1}{3}\\varepsilon\\alpha^4 = \\frac{1}{3}(\\alpha\\varepsilon)\\alpha^3 = \\frac{1}{3}\\tilde{\\varepsilon}\\alpha^3\n$$\n$$\n\\frac{1}{2}\\varepsilon^3\\alpha^6 = \\frac{1}{2}(\\alpha\\varepsilon)^3\\alpha^3 = \\frac{1}{2}\\tilde{\\varepsilon}^3\\alpha^3\n$$\n将此代回 $\\kappa_h/\\alpha$ 的展开式中：\n$$\n\\frac{\\kappa_h}{\\alpha} = \\tilde{\\varepsilon} - \\frac{1}{\\alpha}\\left(\\frac{1}{3}\\tilde{\\varepsilon}\\alpha^3 + \\frac{1}{2}\\tilde{\\varepsilon}^3\\alpha^3\\right)h^2 + \\mathcal{O}(h^4)\n$$\n$$\n\\frac{\\kappa_h}{\\alpha} = \\tilde{\\varepsilon} - \\left(\\frac{1}{3}\\tilde{\\varepsilon}\\alpha^2 + \\frac{1}{2}\\tilde{\\varepsilon}^3\\alpha^2\\right)h^2 + \\mathcal{O}(h^4)\n$$\n现在，代入 $h^2 = \\delta^2/\\alpha^2$：\n$$\n\\frac{\\kappa_h}{\\alpha} = \\tilde{\\varepsilon} - \\left(\\frac{1}{3}\\tilde{\\varepsilon}\\alpha^2 + \\frac{1}{2}\\tilde{\\varepsilon}^3\\alpha^2\\right)\\frac{\\delta^2}{\\alpha^2} + \\mathcal{O}(\\delta^4)\n$$\n$$\n\\frac{\\kappa_h}{\\alpha} = \\tilde{\\varepsilon} - \\left(\\frac{1}{3}\\tilde{\\varepsilon} + \\frac{1}{2}\\tilde{\\varepsilon}^3\\right)\\delta^2 + \\mathcal{O}(\\delta^4)\n$$\n将此与给定形式 $\\kappa_h / \\alpha = \\tilde{\\varepsilon} + C(\\tilde{\\varepsilon}) \\, \\delta^2 + \\mathcal{O}(\\delta^4)$ 进行比较，我们可以确定系数 $C(\\tilde{\\varepsilon})$：\n$$\nC(\\tilde{\\varepsilon}) = -\\left(\\frac{1}{3}\\tilde{\\varepsilon} + \\frac{1}{2}\\tilde{\\varepsilon}^3\\right)\n$$\n这个表达式也可以写成 $-\\frac{\\tilde{\\varepsilon}}{6}(2+3\\tilde{\\varepsilon}^2)$。", "answer": "$$\\boxed{-\\left(\\frac{1}{3}\\tilde{\\varepsilon} + \\frac{1}{2}\\tilde{\\varepsilon}^3\\right)}$$", "id": "3312819"}, {"introduction": "曲率计算中的数值误差并非仅仅是抽象的数学问题；它们在模拟中会产生具体的、往往是不良的后果。本实践探讨了其中最著名的伪影之一：伪电流（spurious currents）。通过对纳维-斯托克斯方程（Navier-Stokes equations）进行标度分析，您将推导出曲率误差与这些非物理速度大小之间的关系，从而深刻理解多相流模拟中的一个关键挑战。", "problem": "考虑一个计算流体动力学（CFD）中的静态球形液滴测试，其中表面张力采用连续表面力（CSF）模型。一个初始半径为 $R$ 的球形液滴悬浮在静止、不可压缩、等温的流体中。界面两侧的密度和粘度相匹配，以消除浮力和粘度差效应。在连续的精确解中，速度场为 $ \\mathbf{u} = \\mathbf{0} $，压力跳跃由拉普拉斯定律确定。在 CSF 公式中，表面张力表现为体积力 $ \\mathbf{f}_{s} = \\sigma \\kappa \\nabla C $，其中 $ \\sigma $ 是表面张力系数，$ \\kappa $ 是平均曲率，$ C $ 是一个平滑的颜色函数，其梯度近似于一个正则化的表面 delta 分布。由于离散化，数值计算出的曲率在界面附近存在误差 $ \\delta \\kappa $。$ C $ 的弥散意味着存在一个数值界面厚度 $ w $，使得在界面带内 $ |\\nabla C| $ 的标度与 $ 1/w $ 相当。假设为低雷诺数条件，因此与粘性效应和毛细效应相比，惯性项可以忽略不计。\n\n仅使用不可压缩的纳维-斯托克斯方程、表面张力的 CSF 表示法以及基于这些的标度分析，推导在该静态液滴测试中，仅由曲率离散化误差驱动的伪速度 $ u_{s} $ 的稳态最大值的领先阶标度。定义无量纲的曲率不平衡度量为 $ \\Delta \\kappa \\equiv w \\, |\\delta \\kappa| $。用 $ \\sigma $、$ \\mu $ 和 $ \\Delta \\kappa $ 表示 $ u_{s} $ 的最终结果，其中 $ \\mu $ 是动力粘度。通过取 $ \\sigma $ 的单位为 N/m，$ \\mu $ 的单位为 Pa·s，以及 $ \\Delta \\kappa $ 为无量纲，用国际单位制（m/s）表示最终速度。请以 $ u_{s} $ 的单个闭式解析表达式形式给出答案，并且在最终的方框表达式中不要包含单位。", "solution": "该问题要求在使用连续表面力（CSF）模型对静态液滴进行数值模拟时，推导最大伪速度 $u_s$ 的领先阶标度。推导将基于在指定条件下对流体动力学控制方程的标度分析。\n\n不可压缩等温流体的基本控制方程是纳维-斯托克斯方程：\n$$ \\rho \\left( \\frac{\\partial \\mathbf{u}}{\\partial t} + \\mathbf{u} \\cdot \\nabla \\mathbf{u} \\right) = -\\nabla p + \\nabla \\cdot \\boldsymbol{\\tau} + \\mathbf{f}_b $$\n其中 $\\rho$ 是流体密度，$\\mathbf{u}$ 是速度场，$p$ 是压力，$\\boldsymbol{\\tau}$ 是粘性应力张量，$\\mathbf{f}_b$ 代表体力。\n\n问题指出了几个简化该方程的条件：\n1.  **稳态**：流动处于稳态，意味着所有时间导数均为零。因此，$\\frac{\\partial \\mathbf{u}}{\\partial t} = \\mathbf{0}$。\n2.  **低雷诺数**：与粘性效应相比，惯性效应可以忽略不计。这使我们可以舍去对流加速度项 $\\rho (\\mathbf{u} \\cdot \\nabla \\mathbf{u})$。\n3.  **粘度恒定的牛顿流体**：流体是具有恒定动力粘度 $\\mu$ 的牛顿流体。应力张量为 $\\boldsymbol{\\tau} = \\mu (\\nabla \\mathbf{u} + (\\nabla \\mathbf{u})^T)$。对于 $\\nabla \\cdot \\mathbf{u} = 0$ 的不可压缩流，应力张量的散度简化为 $\\nabla \\cdot \\boldsymbol{\\tau} = \\mu \\nabla^2 \\mathbf{u}$。\n4.  **CSF模型**：表面张力被建模为体积力 $\\mathbf{f}_b = \\mathbf{f}_s = \\sigma \\kappa \\nabla C$，其中 $\\sigma$ 是表面张力系数，$\\kappa$ 是平均曲率，$C$ 是平滑的颜色函数。在数值模拟中，计算出的曲率包含误差，因此我们用 $\\kappa_{num}$ 表示数值曲率。\n\n在这些条件下，控制方程简化为带表面张力源项的稳态斯托克斯方程：\n$$ \\mathbf{0} = -\\nabla p + \\mu \\nabla^2 \\mathbf{u} + \\sigma \\kappa_{num} \\nabla C $$\n在精确的物理系统中，速度场恒为零（$\\mathbf{u} = \\mathbf{0}$），表面张力完全由静态压力梯度平衡。伪速度 $\\mathbf{u}_s$（在方程中我们将其记为 $\\mathbf{u}$）是由离散化的压力梯度和表面张力之间的数值不平衡完全驱动的非物理流动。\n\n分析由这种不平衡驱动的旋转流动的最直接方法是消除压力项。压力场 $p$ 的出现是为了强制执行不可压缩性约束（$\\nabla \\cdot \\mathbf{u} = 0$），其梯度项 $\\nabla p$ 是一个保守场（其旋度为零）。通过对斯托克斯方程取旋度，我们可以分离出产生涡量并从而驱动流动的非保守力。\n\n对斯托克斯方程应用旋度算子（$\\nabla \\times$）可得：\n$$ \\nabla \\times (\\mathbf{0}) = \\nabla \\times (-\\nabla p + \\mu \\nabla^2 \\mathbf{u} + \\sigma \\kappa_{num} \\nabla C) $$\n$$ \\mathbf{0} = -\\nabla \\times (\\nabla p) + \\mu \\nabla \\times (\\nabla^2 \\mathbf{u}) + \\sigma \\nabla \\times (\\kappa_{num} \\nabla C) $$\n使用矢量恒等式 $\\nabla \\times (\\nabla p) = \\mathbf{0}$ 和 $\\nabla \\times (\\nabla^2 \\mathbf{u}) = \\nabla^2 (\\nabla \\times \\mathbf{u})$，并将涡量定义为 $\\boldsymbol{\\omega} = \\nabla \\times \\mathbf{u}$，方程变为：\n$$ \\mu \\nabla^2 \\boldsymbol{\\omega} = -\\sigma \\nabla \\times (\\kappa_{num} \\nabla C) $$\n这是涡量输运方程。右侧项是涡量的源。我们使用旋度的乘积法则 $\\nabla \\times (f \\mathbf{A}) = f(\\nabla \\times \\mathbf{A}) + (\\nabla f) \\times \\mathbf{A}$ 对其进行分析，其中我们设 $f = \\kappa_{num}$ 和 $\\mathbf{A} = \\nabla C$。\n$$ \\nabla \\times (\\kappa_{num} \\nabla C) = \\kappa_{num} (\\nabla \\times (\\nabla C)) + (\\nabla \\kappa_{num}) \\times (\\nabla C) $$\n因为任意标量场梯度的旋度恒为零，所以 $\\nabla \\times (\\nabla C) = \\mathbf{0}$。涡量源项简化为：\n$$ \\mu \\nabla^2 \\boldsymbol{\\omega} = -\\sigma (\\nabla \\kappa_{num}) \\times (\\nabla C) $$\n该方程揭示了，当且仅当数值曲率的梯度 $\\nabla \\kappa_{num}$ 与颜色函数的梯度 $\\nabla C$ 不平行时，才会产生伪涡量。这种不平行性是数值离散化误差的直接结果。数值曲率是精确曲率与误差项之和：$\\kappa_{num} = \\kappa_{exact} + \\delta \\kappa$。对于球体，$\\kappa_{exact}$ 是一个常数，因此其梯度为零。所以，$\\nabla \\kappa_{num} = \\nabla(\\delta \\kappa)$。方程变为：\n$$ \\mu \\nabla^2 \\boldsymbol{\\omega} = -\\sigma (\\nabla(\\delta \\kappa)) \\times (\\nabla C) $$\n我们现在对该方程进行标度分析，以找出伪速度 $u_s$ 的量级。流动结构（涡）局限于数值界面区域。因此，该流动的特征长度标度 $L$ 是界面厚度 $w$。\n涡量方程中各项的标度关系如下：\n- 伪速度的量级为 $|\\mathbf{u}| \\sim u_s$。\n- 特征长度标度为 $L \\sim w$。\n- 涡量量级：$|\\boldsymbol{\\omega}| = |\\nabla \\times \\mathbf{u}| \\sim \\frac{u_s}{L} \\sim \\frac{u_s}{w}$。\n- 涡量拉普拉斯算子的量级：$|\\nabla^2 \\boldsymbol{\\omega}| \\sim \\frac{|\\boldsymbol{\\omega}|}{L^2} \\sim \\frac{u_s/w}{w^2} = \\frac{u_s}{w^3}$。\n- 左侧项（粘性项）的量级标度为：$|\\mu \\nabla^2 \\boldsymbol{\\omega}| \\sim \\mu \\frac{u_s}{w^3}$。\n\n对于右侧项（涡量源）：\n- 已知颜色函数梯度的量级标度为 $|\\nabla C| \\sim \\frac{1}{w}$。\n- 曲率误差 $\\delta \\kappa$ 在界面长度标度 $w$ 上变化。因此，其梯度的量级标度为 $|\\nabla(\\delta \\kappa)| \\sim \\frac{|\\delta \\kappa|}{w}$。\n- 右侧项的量级标度为：$|-\\sigma (\\nabla(\\delta \\kappa)) \\times (\\nabla C)| \\sim \\sigma |\\nabla(\\delta \\kappa)| |\\nabla C| \\sim \\sigma \\left( \\frac{|\\delta \\kappa|}{w} \\right) \\left( \\frac{1}{w} \\right) = \\frac{\\sigma |\\delta \\kappa|}{w^2}$。\n\n将左侧项和右侧项的标度相等，得到粘性耗散与伪涡量产生之间的平衡：\n$$ \\mu \\frac{u_s}{w^3} \\sim \\frac{\\sigma |\\delta \\kappa|}{w^2} $$\n求解伪速度量级 $u_s$：\n$$ u_s \\sim \\frac{\\sigma}{\\mu} \\frac{w^3 |\\delta \\kappa|}{w^2} = \\frac{\\sigma w |\\delta \\kappa|}{\\mu} $$\n问题将无量纲的曲率不平衡度量定义为 $\\Delta \\kappa \\equiv w |\\delta \\kappa|$。将此定义代入标度关系可得：\n$$ u_s \\sim \\frac{\\sigma}{\\mu} \\Delta \\kappa $$\n这就是推导出的领先阶标度。由于它是一个标度律，因此它取决于一个数量级为1的无量纲常数。问题要求提供单个闭式解析表达式。我们提供最简单的形式，即设此常数为1，这与该现象的标准分析一致。\n$$ u_s = \\frac{\\sigma \\Delta \\kappa}{\\mu} $$\n检查单位：$\\sigma$ 的单位是 N/m 或 kg/s$^2$，$\\mu$ 的单位是 Pa·s 或 kg/(m·s)，$\\Delta \\kappa$ 是无量纲的。比率 $\\frac{\\sigma}{\\mu}$ 的单位是 $\\frac{\\text{kg}/\\text{s}^2}{\\text{kg}/(\\text{m} \\cdot \\text{s})} = \\frac{\\text{m}}{\\text{s}}$，这是一个速度单位，符合要求。", "answer": "$$\\boxed{\\frac{\\sigma \\Delta \\kappa}{\\mu}}$$", "id": "3312875"}, {"introduction": "在理解了曲率误差的来源和后果之后，最后一步是学习如何为了预测的准确性而控制它。本练习将局部数值误差与一个宏观物理结果——液滴破碎的临界韦伯数（Weber number）——联系起来。通过建立一个网格加密准则，您将实践如何确保模拟具有足够的分辨率以做出可靠的物理预测，从而完成从误差分析到实际误差控制的过渡。", "problem": "一个直径为 $D$ 的液滴被置于均匀不可压缩流中，并受到流体动力的作用。当惯性力超过毛细阻力时，可能导致袋状破碎。考虑不可压缩的Navier–Stokes方程，其中表面张力由连续表面力（CSF）模型表示，毛细力密度的作用形式为 $\\mathbf{f}_{\\sigma}=\\sigma \\kappa \\mathbf{n} \\delta_{\\Gamma}$，其中 $\\sigma$ 是表面张力，$\\kappa$ 是平均曲率，$\\mathbf{n}$ 是单位法向量，$\\delta_{\\Gamma}$ 是一个表面delta分布。将韦伯数定义为 $We=\\rho U^{2} D / \\sigma$，其中 $\\rho$ 是密度，$U$ 是特征速度，$D$ 是液滴直径。假设袋状破碎的起始主要由空气动力和毛细阻力之间的平衡决定。\n\n多相流的数值方法必须重建曲率。设重建的曲率 $\\kappa_{\\text{num}}$ 相对于真实曲率 $\\kappa$ 的相对误差为 $\\varepsilon_{\\kappa}$：$\\kappa_{\\text{num}}=(1+\\varepsilon_{\\kappa})\\kappa$。曲率误差取决于网格尺寸 $h$ 和局部曲率半径 $R=1/|\\kappa|$。考虑两种界面捕捉方法：\n- 流体体积法（VOF）：对于良好解析的高度函数曲率，曲率误差模型为 $\\varepsilon_{\\kappa}^{\\text{VOF}}=\\alpha_{\\text{V}} (h/R)^{2}$，其中 $\\alpha_{\\text{V}}>0$ 是一个正常数。\n- 水平集法（LS）：曲率误差模型为 $\\varepsilon_{\\kappa}^{\\text{LS}}=\\alpha_{\\text{L}} (h/R)^{2} - \\beta_{\\text{L}} (W/R)^{2}$，其中 $W=k_{W} h$ 是弥散界面厚度，$\\alpha_{\\text{L}}>0$，$\\beta_{\\text{L}}\\ge 0$，且 $k_{W}\\ge 1$ 表示以单元格数计量的界面厚度。\n\n假设在真实物理过程中（具有精确表面张力）的临界韦伯数为 $We_{\\text{crit,true}}$。使用无量纲化和力平衡的第一性原理，并将曲率误差视为对动量方程中毛细项的有效乘性扰动，推导：\n1) 用 $We_{\\text{crit,true}}$ 和 $\\varepsilon_{\\kappa}$ 表示数值预测的临界韦伯数 $We_{\\text{crit,pred}}$ 的表达式。\n2) 一个后验网格准则，该准则确保预测的临界韦伯数的相对误差满足目标界限，即对于预设容差 $\\tau \\in (0,1)$，有 $|We_{\\text{crit,pred}}-We_{\\text{crit,true}}|/We_{\\text{crit,true}}\\le \\tau$。曲率尺度基于毛细长度 $l_{\\sigma}=\\sqrt{\\sigma/(\\rho a)}$，其中 $a$ 是一个在变形过程中设定曲率尺度的特征加速度。将你的界限表示为关于 $h$（单位为米）的不等式，形式为 $h \\le h_{\\max}$，并用 $\\tau$、$l_{\\sigma}$ 和特定于方法的误差系数表示。使用满足假设模型的 $|\\varepsilon_{\\kappa}|\\le C_{\\text{eff}} (h/l_{\\sigma})^{2}$ 的最小非负系数 $C_{\\text{eff}}$，并报告 $h_{\\max}$（单位为米）。\n\n使用您推导的表达式，编写一个程序，针对下面的测试套件，为每个案例计算：\n- 预测的临界韦伯数 $We_{\\text{crit,pred}}$（无量纲）。\n- 使用毛细长度准则保证容差 $\\tau$ 的最大允许网格尺寸 $h_{\\max}$（单位：米）。\n- 一个通过指示符，如果给定的网格尺寸 $h$ 满足 $h \\le h_{\\max}$ 则为 $1$，否则为 $0$。\n\n所有物理输入必须以国际单位制（SI）解释：米（m）、千克（kg）、秒（s）。不使用角度。所有报告的 $h_{\\max}$ 值必须以米为单位，所有 $We$ 值都是无量纲的。将所有浮点输出四舍五入到六位小数。\n\n测试套件（每行定义一个案例，形式为元组 $(\\text{方法}, We_{\\text{crit,true}}, R, h, \\alpha, \\beta, k_{W}, \\sigma, \\rho, a, \\tau)$）：\n- 案例 A (正常路径, VOF): $(\"VOF\", 12.0, 1.0\\times 10^{-3}, 2.0\\times 10^{-4}, 0.5, 0.0, 1.0, 0.072, 1000.0, 30.0, 0.05)$\n- 案例 B (粗网格, 可能存在负偏差, LS): $(\"LS\", 12.0, 5.0\\times 10^{-4}, 2.5\\times 10^{-4}, 0.2, 0.15, 1.5, 0.072, 1000.0, 200.0, 0.03)$\n- 案例 C (接近零误差, 细网格 VOF): $(\"VOF\", 15.0, 1.5\\times 10^{-3}, 1.5\\times 10^{-5}, 0.5, 0.0, 1.0, 0.072, 1000.0, 5.0, 0.01)$\n- 案例 D (不满足网格准则, LS): $(\"LS\", 12.0, 1.0\\times 10^{-3}, 8.0\\times 10^{-4}, 0.25, 0.05, 2.0, 0.072, 1000.0, 500.0, 0.02)$\n\n最终输出格式：您的程序应生成单行输出，包含一个逗号分隔的案例结果列表，每个案例结果是一个三元素列表，形式为 $[We_{\\text{crit,pred}}, h_{\\max}, \\text{pass}]$，其中浮点数条目四舍五入到六位小数，通过指示符为整数 $0$ 或 $1$。例如：$[[x_{1},y_{1},z_{1}],[x_{2},y_{2},z_{2}],\\dots]$。", "solution": "所述问题具有科学依据、自洽且适定。它提出了一个分析多相流数值方法的标准问题，特别关注曲率估计误差对物理不稳定性预测的影响。曲率误差模型虽然经过简化，但代表了在流体体积法（VOF）和水平集法（LS）中观察到的行为。所有必需的数据和定义均已提供。因此，该问题是有效的，可以构建解决方案。\n\n按照要求，解决方案的推导分为两部分。首先，我们推导预测的临界韦伯数 $We_{\\text{crit,pred}}$ 的表达式。其次，我们推导一个网格加密准则来限制该预测中的数值误差。\n\n**第1部分：预测临界韦伯数 $We_{\\text{crit,pred}}$ 的推导**\n\n液滴破碎的起始由不稳定的惯性力（其尺度为 $F_{\\text{inertial}} \\propto \\rho U^2 D^2$）和稳定的毛细力（其尺度为 $F_{\\text{capillary}} \\propto \\sigma D$）之间的平衡决定。韦伯数 $We = \\rho U^2 D / \\sigma$ 是这两种力的比值。当 $We$ 达到一个临界值 $We_{\\text{crit,true}}$ 时，会发生物理破碎。该临界值是由底层流体动力学决定的一个常数，代表了一个特定的临界力比。\n\n在数值模拟中，毛细力是基于数值估计的曲率 $\\kappa_{\\text{num}}$ 计算的。问题指出，毛细力密度由连续表面力（CSF）模型给出，即 $\\mathbf{f}_{\\sigma}=\\sigma \\kappa \\mathbf{n} \\delta_{\\Gamma}$。因此，该力的数值实现为 $\\mathbf{f}_{\\sigma, \\text{num}}=\\sigma \\kappa_{\\text{num}} \\mathbf{n} \\delta_{\\Gamma}$。\n\n数值曲率通过相对误差 $\\varepsilon_{\\kappa}$ 与真实曲率 $\\kappa$ 相关联：\n$$\n\\kappa_{\\text{num}} = (1 + \\varepsilon_{\\kappa}) \\kappa\n$$\n将此代入数值力的表达式中得到：\n$$\n\\mathbf{f}_{\\sigma, \\text{num}} = \\sigma (1 + \\varepsilon_{\\kappa}) \\kappa \\mathbf{n} \\delta_{\\Gamma} = (1 + \\varepsilon_{\\kappa}) \\mathbf{f}_{\\sigma}\n$$\n这表明数值方法实际上是使用一个修正的或有效的表面张力 $\\sigma_{\\text{eff}}$ 来运作的：\n$$\n\\sigma_{\\text{eff}} = \\sigma (1 + \\varepsilon_{\\kappa})\n$$\n当惯性力与其*计算出的*毛细力之比达到真实的物理临界阈值 $We_{\\text{crit,true}}$ 时，数值模拟将预测破碎。设 $U_{\\text{pred}}$ 是模拟预测破碎时的临界速度。在数值世界中的平衡是：\n$$\n\\frac{\\rho U_{\\text{pred}}^2 D}{\\sigma_{\\text{eff}}} = We_{\\text{crit,true}}\n$$\n根据定义，预测的临界韦伯数是使用*真实的*物理参数表示的：\n$$\nWe_{\\text{crit,pred}} = \\frac{\\rho U_{\\text{pred}}^2 D}{\\sigma}\n$$\n从数值平衡方程中，我们可以写出 $\\rho U_{\\text{pred}}^2 D = We_{\\text{crit,true}} \\cdot \\sigma_{\\text{eff}}$。将此代入 $We_{\\text{crit,pred}}$ 的定义中得到：\n$$\nWe_{\\text{crit,pred}} = \\frac{We_{\\text{crit,true}} \\cdot \\sigma_{\\text{eff}}}{\\sigma} = \\frac{We_{\\text{crit,true}} \\cdot \\sigma(1 + \\varepsilon_{\\kappa})}{\\sigma}\n$$\n这简化为所需的表达式：\n$$\nWe_{\\text{crit,pred}} = We_{\\text{crit,true}} (1 + \\varepsilon_{\\kappa})\n$$\n相对误差 $\\varepsilon_{\\kappa}$ 使用给定的模型计算。对于 VOF 方法，它是：\n$$\n\\varepsilon_{\\kappa} = \\varepsilon_{\\kappa}^{\\text{VOF}} = \\alpha_{\\text{V}} \\left(\\frac{h}{R}\\right)^2\n$$\n对于 LS 方法，它是：\n$$\n\\varepsilon_{\\kappa} = \\varepsilon_{\\kappa}^{\\text{LS}} = \\alpha_{\\text{L}} \\left(\\frac{h}{R}\\right)^2 - \\beta_{\\text{L}} \\left(\\frac{W}{R}\\right)^2 = \\alpha_{\\text{L}} \\left(\\frac{h}{R}\\right)^2 - \\beta_{\\text{L}} \\left(\\frac{k_{W}h}{R}\\right)^2 = (\\alpha_{\\text{L}} - \\beta_{\\text{L}} k_{W}^2) \\left(\\frac{h}{R}\\right)^2\n$$\n\n**第2部分：网格准则的推导**\n\n目标是找到一个关于网格尺寸 $h$ 的条件，以确保预测临界韦伯数的相对误差受容差 $\\tau$ 的限制：\n$$\n\\frac{|We_{\\text{crit,pred}} - We_{\\text{crit,true}}|}{We_{\\text{crit,true}}} \\le \\tau\n$$\n代入第1部分中 $We_{\\text{crit,pred}}$ 的表达式：\n$$\n\\frac{|We_{\\text{crit,true}} (1 + \\varepsilon_{\\kappa}) - We_{\\text{crit,true}}|}{We_{\\text{crit,true}}} \\le \\tau\n$$\n$$\n\\frac{|We_{\\text{crit,true}} \\cdot \\varepsilon_{\\kappa}|}{We_{\\text{crit,true}}} \\le \\tau\n$$\n假设 $We_{\\text{crit,true}} > 0$，这简化为对曲率误差大小的条件：\n$$\n|\\varepsilon_{\\kappa}| \\le \\tau\n$$\n问题要求将网格准则建立在毛细长度 $l_{\\sigma} = \\sqrt{\\sigma/(\\rho a)}$ 作为特征曲率半径的基础上，即 $R = l_{\\sigma}$。我们必须找到最小的非负系数 $C_{\\text{eff}}$，使得 $|\\varepsilon_{\\kappa}| \\le C_{\\text{eff}} (h/l_{\\sigma})^2$ 成立。这通过将 $R=l_{\\sigma}$ 代入误差模型来实现。\n\n对于 VOF：\n$$\n|\\varepsilon_{\\kappa}^{\\text{VOF}}| = \\left|\\alpha_{\\text{V}} \\left(\\frac{h}{l_{\\sigma}}\\right)^2\\right| = \\alpha_{\\text{V}} \\left(\\frac{h}{l_{\\sigma}}\\right)^2 \\quad (\\text{因为 } \\alpha_{\\text{V}} > 0)\n$$\n因此，对于 VOF， $C_{\\text{eff}} = \\alpha_{\\text{V}}$。\n\n对于 LS：\n$$\n|\\varepsilon_{\\kappa}^{\\text{LS}}| = \\left|(\\alpha_{\\text{L}} - \\beta_{\\text{L}} k_{W}^2) \\left(\\frac{h}{l_{\\sigma}}\\right)^2\\right| = |\\alpha_{\\text{L}} - \\beta_{\\L} k_{W}^2| \\left(\\frac{h}{l_{\\sigma}}\\right)^2\n$$\n因此，对于 LS， $C_{\\text{eff}} = |\\alpha_{\\text{L}} - \\beta_{\\L} k_{W}^2|$。\n\n误差约束 $|\\varepsilon_{\\kappa}| \\le \\tau$ 变为：\n$$\nC_{\\text{eff}} \\left(\\frac{h}{l_{\\sigma}}\\right)^2 \\le \\tau\n$$\n如果 $C_{\\text{eff}} > 0$，我们可以解出 $h$：\n$$\nh^2 \\le \\frac{\\tau \\cdot l_{\\sigma}^2}{C_{\\text{eff}}}\n$$\n$$\nh \\le l_{\\sigma} \\sqrt{\\frac{\\tau}{C_{\\text{eff}}}}\n$$\n这给出了最大允许网格尺寸 $h_{\\max}$：\n$$\nh_{\\max} = l_{\\sigma} \\sqrt{\\frac{\\tau}{C_{\\text{eff}}}} = \\sqrt{\\frac{\\sigma}{\\rho a}} \\sqrt{\\frac{\\tau}{C_{\\text{eff}}}}\n$$\n如果 $C_{\\text{eff}} = 0$，对于 $\\tau \\in (0,1)$，不等式 $0 \\le \\tau$ 总是成立，这意味着任何网格尺寸都是可接受的。在这种情况下，$h_{\\max} \\to \\infty$。\n\n**程序计算步骤摘要**\n\n对于每个测试案例：\n1.  识别方法（`VOF` 或 `LS`）并解包参数 $(\\text{方法}, We_{\\text{crit,true}}, R, h, \\alpha, \\beta, k_{W}, \\sigma, \\rho, a, \\tau)$。对于 VOF，$\\alpha = \\alpha_{\\text{V}}$。对于 LS，$\\alpha = \\alpha_{\\text{L}}$ 且 $\\beta = \\beta_{\\text{L}}$。\n2.  计算曲率误差 $\\varepsilon_{\\kappa}$。\n    -   如果 `VOF`：$\\varepsilon_{\\kappa} = \\alpha (h/R)^2$。\n    -   如果 `LS`：$\\varepsilon_{\\kappa} = (\\alpha - \\beta k_{W}^2) (h/R)^2$。\n3.  计算预测的临界韦伯数：$We_{\\text{crit,pred}} = We_{\\text{crit,true}}(1 + \\varepsilon_{\\kappa})$。\n4.  计算毛细长度：$l_{\\sigma} = \\sqrt{\\sigma/(\\rho a)}$。\n5.  计算有效误差系数 $C_{\\text{eff}}$。\n    -   如果 `VOF`：$C_{\\text{eff}} = \\alpha$。\n    -   如果 `LS`：$C_{\\text{eff}} = |\\alpha - \\beta k_{W}^2|$。\n6.  计算最大网格尺寸 $h_{\\max}$。\n    -   如果 $C_{\\text{eff}} > 0$：$h_{\\max} = l_{\\sigma} \\sqrt{\\tau / C_{\\text{eff}}}$。\n    -   如果 $C_{\\text{eff}} = 0$：$h_{\\max} = \\infty$。\n7.  确定通过指示符：如果给定的网格尺寸 $h$ 满足 $h \\le h_{\\max}$，则设为 $1$，否则设为 $0$。\n8.  将结果 $[We_{\\text{crit,pred}}, h_{\\max}, \\text{pass}]$ 格式化，浮点值四舍五入到六位小数。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n# No other libraries are imported.\n\ndef solve():\n    \"\"\"\n    Solves the droplet breakup problem for the given test suite.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (method, We_crit_true, R, h, alpha, beta, k_W, sigma, rho, a, tau)\n        (\"VOF\", 12.0, 1.0e-3, 2.0e-4, 0.5, 0.0, 1.0, 0.072, 1000.0, 30.0, 0.05),\n        (\"LS\", 12.0, 5.0e-4, 2.5e-4, 0.2, 0.15, 1.5, 0.072, 1000.0, 200.0, 0.03),\n        (\"VOF\", 15.0, 1.5e-3, 1.5e-5, 0.5, 0.0, 1.0, 0.072, 1000.0, 5.0, 0.01),\n        (\"LS\", 12.0, 1.0e-3, 8.0e-4, 0.25, 0.05, 2.0, 0.072, 1000.0, 500.0, 0.02)\n    ]\n\n    results = []\n    for case in test_cases:\n        method, we_crit_true, R_val, h_val, alpha, beta, k_w, sigma, rho, a_val, tau = case\n\n        # 1. Calculate the relative curvature error, epsilon_kappa\n        h_over_R = h_val / R_val\n        if method == \"VOF\":\n            # For VOF, epsilon_kappa = alpha_V * (h/R)^2\n            epsilon_kappa = alpha * (h_over_R**2)\n        elif method == \"LS\":\n            # For LS, epsilon_kappa = (alpha_L - beta_L * k_W^2) * (h/R)^2\n            epsilon_kappa = (alpha - beta * k_w**2) * (h_over_R**2)\n        else:\n            raise ValueError(\"Unknown method specified.\")\n\n        # 2. Calculate the predicted critical Weber number, We_crit_pred\n        we_crit_pred = we_crit_true * (1.0 + epsilon_kappa)\n\n        # 3. Calculate the maximum admissible mesh size, h_max\n        # Calculate capillary length, l_sigma\n        l_sigma = np.sqrt(sigma / (rho * a_val))\n        \n        # Calculate the effective error coefficient, C_eff\n        if method == \"VOF\":\n            c_eff = alpha\n        elif method == \"LS\":\n            c_eff = np.abs(alpha - beta * k_w**2)\n        \n        # Calculate h_max, handling the case C_eff = 0\n        if c_eff > 0:\n            h_max = l_sigma * np.sqrt(tau / c_eff)\n        else:\n            # If c_eff is 0, the error is always 0, so any mesh size is permitted.\n            h_max = float('inf')\n\n        # 4. Determine the pass indicator\n        pass_indicator = 1 if h_val = h_max else 0\n        \n        # Store the rounded results for the current case\n        results.append([\n            round(we_crit_pred, 6),\n            round(h_max, 6),\n            pass_indicator\n        ])\n\n    # Final print statement in the exact required format.\n    # The format is a list of lists, represented as a string.\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "3312887"}]}