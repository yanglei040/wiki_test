{"hands_on_practices": [{"introduction": "模拟多相流的核心在于准确且稳定地求解各相的耦合动量方程。本实践旨在解决由强烈的相间阻力引起的数值刚度问题，这是双流体模型中的一个常见挑战。通过实施一个半隐式（IMEX）方案 [@problem_id:3336701]，你将掌握一项基本技术，以确保即使在大时间步长下也能保持数值稳定性，同时验证动量守恒和能量耗散等关键物理性质。", "problem": "考虑计算流体力学 (CFD) 中用于相间动量交换的单单元、一维、双流体模型。两种不混溶的相，即气相和液相，占据的体积分数分别为 $\\alpha \\in (0,1)$（气相）和 $1-\\alpha$（液相）。相密度为常数 $\\rho_{\\mathrm{g}}$ 和 $\\rho_{\\mathrm{l}}$，单位为 $\\mathrm{kg/m^3}$，相速度为 $u_{\\mathrm{g}}(t)$ 和 $u_{\\mathrm{l}}(t)$，单位为 $\\mathrm{m/s}$。相间动量交换通过形式为 $K(\\alpha)\\,(u_{\\mathrm{g}}-u_{\\mathrm{l}})$ 的封闭关系进行建模，其中 $K(\\alpha)$ 的单位为 $\\mathrm{kg/(m^3\\,s)}$，并且是 $\\alpha$ 的一个非负函数。忽略所有其他力和源项。令 $m_{\\mathrm{g}}=\\alpha\\,\\rho_{\\mathrm{g}}$ 和 $m_{\\mathrm{l}}=(1-\\alpha)\\,\\rho_{\\mathrm{l}}$ 表示单位体积的相质量。\n\n从各相的牛顿第二定律和分相动量守恒出发，构建一个在时间步长 $\\Delta t$ 上的一阶时间推进格式。该格式通过隐式-显式 (IMEX) 策略处理刚性的相间交换项：所有非刚性或缺失的项都采用显式处理，而相间动量交换则通过半隐式处理，即使用保证非负性的线性化来计算曳力系数，并隐式处理速度差。使用以下建模选择作为基本基础：\n- 单位体积的相动量方程为 $m_{\\mathrm{g}}\\,\\dfrac{d u_{\\mathrm{g}}}{dt}=-K(\\alpha)\\,\\left(u_{\\mathrm{g}}-u_{\\mathrm{l}}\\right)$ 和 $m_{\\mathrm{l}}\\,\\dfrac{d u_{\\mathrm{l}}}{dt}=+K(\\alpha)\\,\\left(u_{\\mathrm{g}}-u_{\\mathrm{l}}\\right)$，这些方程源于牛顿第二定律以及大小相等、方向相反的牛顿第三定律相间作用力-反作用力对。\n- 半隐式线性化必须在已知状态下计算 $K(\\alpha)$ 以确保 $K^\\star \\ge 0$，从而使得到的离散算子是正定的，并保持相关系数的正性。\n- 双流体能量一致性意味着相间功在内部交换，不产生或破坏总混合物动量，并且对于任何 $\\Delta t>0$，只要 $K^\\star\\ge 0$，单位体积的离散动能 $E=\\dfrac{1}{2}\\left(m_{\\mathrm{g}}\\,u_{\\mathrm{g}}^2+m_{\\mathrm{l}}\\,u_{\\mathrm{l}}^2\\right)$ 必须是非增的。\n\n你的任务：\n1. 根据上述的相动量平衡和 IMEX 设计，推导速度 $u_{\\mathrm{g}}^{n+1}$ 和 $u_{\\mathrm{l}}^{n+1}$ 从已知的 $u_{\\mathrm{g}}^{n}$ 和 $u_{\\mathrm{l}}^{n}$ 在一个时间步长内的耦合更新公式，使用 $K^\\star=K(\\alpha^n)$ 且 $\\alpha^n=\\alpha$。证明该格式守恒混合物动量 $m_{\\mathrm{g}}\\,u_{\\mathrm{g}}+m_{\\mathrm{l}}\\,u_{\\mathrm{l}}$，并且对于任何 $\\Delta t>0$ 和任何非负的 $K^\\star$，单位体积的离散动能不增加。\n2. 实现所推导的更新公式，并为下面的每个测试用例计算 $u_{\\mathrm{g}}^{n+1}$、 $u_{\\mathrm{l}}^{n+1}$（单位 $\\mathrm{m/s}$）和 $E^{n+1}$（单位 $\\mathrm{J/m^3}$）。使用封闭关系 $K(\\alpha)=K_0\\,\\alpha\\,(1-\\alpha)$，其中 $K_0$ 的单位为 $\\mathrm{kg/(m^3\\,s)}$。\n3. 你的程序必须生成单行输出，其中包含一个结果列表，每个测试用例一个结果，每个结果是一个三元组 $\\left[u_{\\mathrm{g}}^{n+1},u_{\\mathrm{l}}^{n+1},E^{n+1}\\right]$。输出必须是这些三元组的逗号分隔列表，并用方括号括起来，例如 $\\left[\\left[u_{\\mathrm{g}}^{(1)},u_{\\mathrm{l}}^{(1)},E^{(1)}\\right],\\left[u_{\\mathrm{g}}^{(2)},u_{\\mathrm{l}}^{(2)},E^{(2)}\\right],\\dots\\right]$。\n4. 在输出中，将所有速度（单位 $\\mathrm{m/s}$）和所有能量（单位 $\\mathrm{J/m^3}$）表示为不带单位的普通十进制数。\n\n测试套件（所有量均使用一致的国际单位制单位）：\n- 测试 A（中等刚度，不对称质量）：$\\rho_{\\mathrm{g}}=5$, $\\rho_{\\mathrm{l}}=1000$, $\\alpha=0.2$, $u_{\\mathrm{g}}^{n}=2$, $u_{\\mathrm{l}}^{n}=0$, $K_0=1\\times 10^{5}$, $\\Delta t=1\\times 10^{-3}$。\n- 测试 B（刚性）：与测试 A 相同，但 $K_0=1\\times 10^{8}$。\n- 测试 C（无耦合）：与测试 A 相同，但 $K_0=0$。\n- 测试 D（近纯气相分数，平衡刚度）：$\\rho_{\\mathrm{g}}=1$, $\\rho_{\\mathrm{l}}=1000$, $\\alpha=0.999$, $u_{\\mathrm{g}}^{n}=10$, $u_{\\mathrm{l}}^{n}=-1$, $K_0=1\\times 10^{6}$, $\\Delta t=1\\times 10^{-3}$。\n- 测试 E（极大时间步长与强耦合）：$\\rho_{\\mathrm{g}}=5$, $\\rho_{\\mathrm{l}}=1000$, $\\alpha=0.2$, $u_{\\mathrm{g}}^{n}=2$, $u_{\\mathrm{l}}^{n}=0$, $K_0=1\\times 10^{6}$, $\\Delta t=5\\times 10^{-1}$。\n\n最终输出格式：\n- 你的程序应生成单行输出，其中包含一个由方括号括起来的、逗号分隔的三元组列表，例如：$\\left[\\left[u_{\\mathrm{g}}^{(A)},u_{\\mathrm{l}}^{(A)},E^{(A)}\\right],\\left[u_{\\mathrm{g}}^{(B)},u_{\\mathrm{l}}^{(B)},E^{(B)}\\right],\\left[u_{\\mathrm{g}}^{(C)},u_{\\mathrm{l}}^{(C)},E^{(C)}\\right],\\left[u_{\\mathrm{g}}^{(D)},u_{\\mathrm{l}}^{(D)},E^{(D)}\\right],\\left[u_{\\mathrm{g}}^{(E)},u_{\\mathrm{l}}^{(E)},E^{(E)}\\right]\\right]$。", "solution": "该问题经验证是自洽的、有科学依据的且适定的。所有提供的数据都一致且足以推导出唯一解。\n\n### 步骤 1：提取已知条件\n- **相 (Phases)：** 气相 (g) 和液相 (l)，不可混溶。\n- **体积分数 (Volume fractions)：** 气相 $\\alpha \\in (0,1)$，液相 $1-\\alpha$。\n- **密度 (Densities)：** 恒定的相密度 $\\rho_{\\mathrm{g}}$ 和 $\\rho_{\\mathrm{l}}$ ($\\mathrm{kg/m^3}$)。\n- **速度 (Velocities)：** 相速度 $u_{\\mathrm{g}}(t)$ 和 $u_{\\mathrm{l}}(t)$ ($\\mathrm{m/s}$)。\n- **单位体积相质量 (Phase masses per unit volume)：** $m_{\\mathrm{g}}=\\alpha\\,\\rho_{\\mathrm{g}}$，$m_{\\mathrm{l}}=(1-\\alpha)\\,\\rho_{\\mathrm{l}}$。\n- **相间动量交换项 (Interphase momentum exchange term)：** $K(\\alpha)\\,(u_{\\mathrm{g}}-u_{\\mathrm{l}})$，其中 $K(\\alpha)$ 单位为 $\\mathrm{kg/(m^3\\,s)}$ 且为非负。\n- **相动量方程（单位体积）(Phase momentum equations (per unit volume))：**\n  - $m_{\\mathrm{g}}\\,\\dfrac{d u_{\\mathrm{g}}}{dt}=-K(\\alpha)\\,\\left(u_{\\mathrm{g}}-u_{\\mathrm{l}}\\right)$\n  - $m_{\\mathrm{l}}\\,\\dfrac{d u_{\\mathrm{l}}}{dt}=+K(\\alpha)\\,\\left(u_{\\mathrm{g}}-u_{\\mathrm{l}}\\right)$\n- **数值格式 (Numerical scheme)：** 一阶，在 $\\Delta t$ 上的时间推进。IMEX 策略，其中非刚性项是显式的（此处无），而刚性相间项是半隐式的。\n- **半隐式处理 (Semi-implicit treatment)：** $K(\\alpha)$ 在已知时间层 $n$ 计算，即 $K^\\star=K(\\alpha^n)$。速度差 $u_{\\mathrm{g}}-u_{\\mathrm{l}}$ 在未来时间层 $n+1$ 计算。\n- **单位体积动能 (Kinetic energy per unit volume)：** $E=\\dfrac{1}{2}\\left(m_{\\mathrm{g}}\\,u_{\\mathrm{g}}^2+m_{\\mathrm{l}}\\,u_{\\mathrm{l}}^2\\right)$。\n- **曳力封闭关系 (Drag closure)：** $K(\\alpha)=K_0\\,\\alpha\\,(1-\\alpha)$。\n- **任务 (Tasks)：**\n  1. 从 $(u_{\\mathrm{g}}^{n}, u_{\\mathrm{l}}^{n})$ 推导 $(u_{\\mathrm{g}}^{n+1}, u_{\\mathrm{l}}^{n+1})$ 的更新公式。\n  2. 证明混合物动量 $m_{\\mathrm{g}}\\,u_{\\mathrm{g}}+m_{\\mathrm{l}}\\,u_{\\mathrm{l}}$ 的守恒性。\n  3. 证明对于任何 $\\Delta t>0$ 和 $K^\\star\\ge 0$，动能 $E$ 非增。\n  4. 实现该格式并为给定的测试用例计算 $(u_{\\mathrm{g}}^{n+1}, u_{\\mathrm{l}}^{n+1}, E^{n+1})$。\n\n### 步骤 2：使用提取的已知条件进行验证\n- **科学依据 (Scientifically Grounded)：** 该问题基于牛顿第二和第三定律应用于双流体模型，这是多相流理论和 CFD 中的一个标准和基础方法。动量守恒、动能和相间曳力的概念是流体动力学的核心。IMEX 格式是处理刚性常微分方程 (ODEs) 的一种成熟的数值技术。该问题在科学上是合理的。\n- **适定性 (Well-Posed)：** 该问题提供了一套完整的常微分方程、初始条件以及关于数值离散化的明确指令。这种设置导致一个可解的线性系统来求解更新后的速度，确保唯一解的存在。所要求的证明是分析数值格式稳定性和守恒性的标准步骤。该问题是适定的。\n- **客观性 (Objective)：** 该问题使用精确的数学和物理术语陈述，没有歧义或主观论断。任务是具体且可量化的。\n\n### 步骤 3：结论与行动\n该问题有效。将提供完整解答。\n\n### 1. IMEX 格式的推导\n我们从给定的相速度 $u_{\\mathrm{g}}(t)$ 和 $u_{\\mathrm{l}}(t)$ 的常微分方程组开始：\n$$m_{\\mathrm{g}}\\,\\dfrac{d u_{\\mathrm{g}}}{dt}=-K(\\alpha)\\,\\left(u_{\\mathrm{g}}-u_{\\mathrm{l}}\\right)$$\n$$m_{\\mathrm{l}}\\,\\dfrac{d u_{\\mathrm{l}}}{dt}=+K(\\alpha)\\,\\left(u_{\\mathrm{g}}-u_{\\mathrm{l}}\\right)$$\n我们使用一阶格式在时间步长 $\\Delta t$ 上对这些方程进行时间离散。令 $u^n$ 表示变量 $u$ 在时间 $t^n$ 的值，$u^{n+1}$ 表示在时间 $t^{n+1}=t^n+\\Delta t$ 的值。时间导数用向前差分近似，即 $\\frac{du}{dt} \\approx \\frac{u^{n+1}-u^n}{\\Delta t}$。\n\n遵循 IMEX 策略，非刚性项（本例中不存在）被显式处理，而刚性相间动量交换项被半隐式处理。这意味着曳力系数 $K(\\alpha)$ 在已知时间层 $n$ 进行计算，记为 $K^\\star=K(\\alpha^n)$，而速度差在未知时间层 $n+1$ 进行计算。离散化后的方程为：\n$$m_{\\mathrm{g}}\\,\\frac{u_{\\mathrm{g}}^{n+1}-u_{\\mathrm{g}}^{n}}{\\Delta t}=-K^\\star\\,\\left(u_{\\mathrm{g}}^{n+1}-u_{\\mathrm{l}}^{n+1}\\right)$$\n$$m_{\\mathrm{l}}\\,\\frac{u_{\\mathrm{l}}^{n+1}-u_{\\mathrm{l}}^{n}}{\\Delta t}=+K^\\star\\,\\left(u_{\\mathrm{g}}^{n+1}-u_{\\mathrm{l}}^{n+1}\\right)$$\n这是关于未知速度 $u_{\\mathrm{g}}^{n+1}$ 和 $u_{\\mathrm{l}}^{n+1}$ 的两个耦合线性方程。我们重新整理它们，将未知数放在左侧：\n$$m_{\\mathrm{g}}\\left(u_{\\mathrm{g}}^{n+1}-u_{\\mathrm{g}}^{n}\\right) + \\Delta t K^\\star\\left(u_{\\mathrm{g}}^{n+1}-u_{\\mathrm{l}}^{n+1}\\right) = 0$$\n$$m_{\\mathrm{l}}\\left(u_{\\mathrm{l}}^{n+1}-u_{\\mathrm{l}}^{n}\\right) - \\Delta t K^\\star\\left(u_{\\mathrm{g}}^{n+1}-u_{\\mathrm{l}}^{n+1}\\right) = 0$$\n这可以写成矩阵形式：\n$$\n\\begin{pmatrix}\nm_{\\mathrm{g}} + \\Delta t K^\\star & -\\Delta t K^\\star \\\\\n-\\Delta t K^\\star & m_{\\mathrm{l}} + \\Delta t K^\\star\n\\end{pmatrix}\n\\begin{pmatrix}\nu_{\\mathrm{g}}^{n+1} \\\\\nu_{\\mathrm{l}}^{n+1}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\nm_{\\mathrm{g}} u_{\\mathrm{g}}^{n} \\\\\nm_{\\mathrm{l}} u_{\\mathrm{l}}^{n}\n\\end{pmatrix}\n$$\n为了解这个 $2 \\times 2$ 系统，我们可以求矩阵的逆。系数矩阵的行列式为：\n$$\\det(A) = (m_{\\mathrm{g}} + \\Delta t K^\\star)(m_{\\mathrm{l}} + \\Delta t K^\\star) - (-\\Delta t K^\\star)^2 = m_{\\mathrm{g}}m_{\\mathrm{l}} + m_{\\mathrm{g}}\\Delta t K^\\star + m_{\\mathrm{l}}\\Delta t K^\\star + (\\Delta t K^\\star)^2 - (\\Delta t K^\\star)^2$$\n$$\\det(A) = m_{\\mathrm{g}}m_{\\mathrm{l}} + \\Delta t K^\\star(m_{\\mathrm{g}} + m_{\\mathrm{l}})$$\n由于 $m_{\\mathrm{g}}, m_{\\mathrm{l}} > 0$，$\\Delta t > 0$ 且 $K^\\star \\ge 0$，行列式严格为正，确保存在唯一解。应用逆矩阵可得更新速度的显式表达式：\n$$\n\\begin{pmatrix}\nu_{\\mathrm{g}}^{n+1} \\\\\nu_{\\mathrm{l}}^{n+1}\n\\end{pmatrix}\n=\n\\frac{1}{m_{\\mathrm{g}}m_{\\mathrm{l}} + \\Delta t K^\\star(m_{\\mathrm{g}} + m_{\\mathrm{l}})}\n\\begin{pmatrix}\nm_{\\mathrm{l}} + \\Delta t K^\\star & \\Delta t K^\\star \\\\\n\\Delta t K^\\star & m_{\\mathrm{g}} + \\Delta t K^\\star\n\\end{pmatrix}\n\\begin{pmatrix}\nm_{\\mathrm{g}} u_{\\mathrm{g}}^{n} \\\\\nm_{\\mathrm{l}} u_{\\mathrm{l}}^{n}\n\\end{pmatrix}\n$$\n展开后得到最终的更新公式：\n$$u_{\\mathrm{g}}^{n+1} = \\frac{(m_{\\mathrm{l}} + \\Delta t K^\\star)m_{\\mathrm{g}} u_{\\mathrm{g}}^{n} + (\\Delta t K^\\star)m_{\\mathrm{l}} u_{\\mathrm{l}}^{n}}{m_{\\mathrm{g}}m_{\\mathrm{l}} + \\Delta t K^\\star(m_{\\mathrm{g}} + m_{\\mathrm{l}})}$$\n$$u_{\\mathrm{l}}^{n+1} = \\frac{(\\Delta t K^\\star)m_{\\mathrm{g}} u_{\\mathrm{g}}^{n} + (m_{\\mathrm{g}} + \\Delta t K^\\star)m_{\\mathrm{l}} u_{\\mathrm{l}}^{n}}{m_{\\mathrm{g}}m_{\\mathrm{l}} + \\Delta t K^\\star(m_{\\mathrm{g}} + m_{\\mathrm{l}})}$$\n\n### 2. 动量守恒证明\n为了证明总混合物动量是守恒的，我们将两个离散化的动量方程相加：\n$$m_{\\mathrm{g}}\\,\\frac{u_{\\mathrm{g}}^{n+1}-u_{\\mathrm{g}}^{n}}{\\Delta t} + m_{\\mathrm{l}}\\,\\frac{u_{\\mathrm{l}}^{n+1}-u_{\\mathrm{l}}^{n}}{\\Delta t} = -K^\\star\\,\\left(u_{\\mathrm{g}}^{n+1}-u_{\\mathrm{l}}^{n+1}\\right) + K^\\star\\,\\left(u_{\\mathrm{g}}^{n+1}-u_{\\mathrm{l}}^{n+1}\\right) = 0$$\n两边乘以 $\\Delta t$ 得到：\n$$m_{\\mathrm{g}}(u_{\\mathrm{g}}^{n+1}-u_{\\mathrm{g}}^{n}) + m_{\\mathrm{l}}(u_{\\mathrm{l}}^{n+1}-u_{\\mathrm{l}}^{n}) = 0$$\n重新整理各项，我们得到：\n$$m_{\\mathrm{g}}u_{\\mathrm{g}}^{n+1} + m_{\\mathrm{l}}u_{\\mathrm{l}}^{n+1} = m_{\\mathrm{g}}u_{\\mathrm{g}}^{n} + m_{\\mathrm{l}}u_{\\mathrm{l}}^{n}$$\n此等式表明，时间 $t^{n+1}$ 的单位体积混合物动量与时间 $t^n$ 的相同。因此，该格式对于混合物动量是守恒的。\n\n### 3. 能量稳定性证明（动能非增）\n单位体积的混合物总动能由 $E = \\frac{1}{2}(m_{\\mathrm{g}}u_{\\mathrm{g}}^2 + m_{\\mathrm{l}}u_{\\mathrm{l}}^2)$ 给出。我们可以将此能量分解为两部分：质心运动的动能和相间相对运动的动能。\n设 $M_{tot} = m_{\\mathrm{g}}+m_{\\mathrm{l}}$ 为单位体积的总质量，$u_c = \\frac{m_{\\mathrm{g}}u_{\\mathrm{g}}+m_{\\mathrm{l}}u_{\\mathrm{l}}}{M_{tot}}$ 为质心速度。总动量为 $M_{tot}u_c$。如上所示，混合物动量守恒，因此 $u_c^{n+1}=u_c^{n}$。\n动能可以表示为：\n$$E = \\frac{1}{2}M_{tot}u_c^2 + \\frac{1}{2}\\mu(\\Delta u)^2$$\n其中 $\\mu = \\frac{m_{\\mathrm{g}}m_{\\mathrm{l}}}{m_{\\mathrm{g}}+m_{\\mathrm{l}}}$ 是单位体积的折合质量，$\\Delta u = u_{\\mathrm{g}}-u_{\\mathrm{l}}$ 是相对速度。\n从 $t^n$ 到 $t^{n+1}$ 的动能变化为：\n$$\\Delta E = E^{n+1} - E^n = \\left(\\frac{1}{2}M_{tot}(u_c^{n+1})^2 + \\frac{1}{2}\\mu(\\Delta u^{n+1})^2\\right) - \\left(\\frac{1}{2}M_{tot}(u_c^{n})^2 + \\frac{1}{2}\\mu(\\Delta u^{n})^2\\right)$$\n由于 $u_c^{n+1}=u_c^{n}$，这简化为：\n$$\\Delta E = \\frac{1}{2}\\mu\\left((\\Delta u^{n+1})^2 - (\\Delta u^{n})^2\\right)$$\n为了计算这个值，我们推导相对速度 $\\Delta u$ 的更新方程。我们将第一个离散动量方程除以 $m_{\\mathrm{g}}$，第二个除以 $m_{\\mathrm{l}}$，然后用第一个减去第二个：\n$$\\frac{u_{\\mathrm{g}}^{n+1}-u_{\\mathrm{g}}^{n}}{\\Delta t} - \\frac{u_{\\mathrm{l}}^{n+1}-u_{\\mathrm{l}}^{n}}{\\Delta t} = -\\frac{K^\\star}{m_{\\mathrm{g}}}(u_{\\mathrm{g}}^{n+1}-u_{\\mathrm{l}}^{n+1}) - \\frac{K^\\star}{m_{\\mathrm{l}}}(u_{\\mathrm{g}}^{n+1}-u_{\\mathrm{l}}^{n+1})$$\n$$\\frac{(u_{\\mathrm{g}}^{n+1}-u_{\\mathrm{l}}^{n+1})-(u_{\\mathrm{g}}^{n}-u_{\\mathrm{l}}^{n})}{\\Delta t} = -K^\\star\\left(\\frac{1}{m_{\\mathrm{g}}}+\\frac{1}{m_{\\mathrm{l}}}\\right)(u_{\\mathrm{g}}^{n+1}-u_{\\mathrm{l}}^{n+1})$$\n使用 $\\Delta u^k = u_{\\mathrm{g}}^{k}-u_{\\mathrm{l}}^{k}$：\n$$\\frac{\\Delta u^{n+1}-\\Delta u^{n}}{\\Delta t} = -K^\\star\\left(\\frac{m_{\\mathrm{g}}+m_{\\mathrm{l}}}{m_{\\mathrm{g}}m_{\\mathrm{l}}}\\right)\\Delta u^{n+1}$$\n$$\\Delta u^{n+1} \\left(1 + \\Delta t K^\\star \\frac{m_{\\mathrm{g}}+m_{\\mathrm{l}}}{m_{\\mathrm{g}}m_{\\mathrm{l}}}\\right) = \\Delta u^n$$\n$$\\Delta u^{n+1} = \\frac{\\Delta u^n}{1 + \\frac{\\Delta t K^\\star}{\\mu}}$$\n令 $\\gamma = \\left(1 + \\frac{\\Delta t K^\\star}{\\mu}\\right)^{-1}$。由于 $\\Delta t > 0$，$K^\\star \\ge 0$ 且 $\\mu > 0$，我们有 $0 < \\gamma \\le 1$。具体来说，如果 $K^\\star=0$，则 $\\gamma=1$；当 $\\Delta t K^\\star \\to \\infty$ 时，$\\gamma \\to 0$。\n现在将 $\\Delta u^{n+1} = \\gamma \\Delta u^n$ 代入 $\\Delta E$ 的表达式：\n$$\\Delta E = \\frac{1}{2}\\mu\\left((\\gamma \\Delta u^{n})^2 - (\\Delta u^{n})^2\\right) = \\frac{1}{2}\\mu(\\Delta u^{n})^2(\\gamma^2-1)$$\n由于 $0 < \\gamma \\le 1$，我们有 $\\gamma^2-1 \\le 0$。同时，$\\mu > 0$ 且 $(\\Delta u^n)^2 \\ge 0$。因此，对于任何 $\\Delta t > 0$ 和 $K^\\star \\ge 0$，$\\Delta E \\le 0$。这证明了离散动能是非增的，确保了格式的数值稳定性。能量仅由相间曳力耗散，这在物理上是正确的。\n\n### 4. 实现细节\nPython 实现将定义一个函数，该函数接收单个测试用例的物理参数作为输入。在该函数内部：\n1. 计算单位体积的相质量 $m_{\\mathrm{g}}$ 和 $m_{\\mathrm{l}}$。\n2. 计算半隐式曳力系数 $K^\\star = K_0 \\alpha (1-\\alpha)$。\n3. 实现推导出的 $u_{\\mathrm{g}}^{n+1}$ 和 $u_{\\mathrm{l}}^{n+1}$ 的显式公式。可以处理 $K_0=0$（因此 $K^\\star=0$）的特殊情况，此时速度保持不变，尽管通用公式是鲁棒的并且能正确处理这种情况。\n4. 计算新的动能 $E^{n+1} = \\frac{1}{2}(m_{\\mathrm{g}}(u_{\\mathrm{g}}^{n+1})^2 + m_{\\mathrm{l}}(u_{\\mathrm{l}}^{n+1})^2)$。\n5. 脚本的主体部分将遍历提供的测试套件，为每个用例调用计算函数，并收集结果。\n6. 最后，它将把收集到的结果格式化为指定的字符串格式 `[[...],[...],...]` 并打印到标准输出。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to solve the two-fluid model problem for all test cases.\n    \"\"\"\n\n    # Test suite (all quantities in coherent SI units):\n    # (rho_g, rho_l, alpha, u_g_n, u_l_n, K0, dt)\n    test_cases = [\n        # Test A: moderate stiffness, asymmetric masses\n        (5.0, 1000.0, 0.2, 2.0, 0.0, 1.0e5, 1.0e-3),\n        # Test B: stiff\n        (5.0, 1000.0, 0.2, 2.0, 0.0, 1.0e8, 1.0e-3),\n        # Test C: no coupling\n        (5.0, 1000.0, 0.2, 2.0, 0.0, 0.0, 1.0e-3),\n        # Test D: near-pure gas fraction, balanced stiffness\n        (1.0, 1000.0, 0.999, 10.0, -1.0, 1.0e6, 1.0e-3),\n        # Test E: very large time step with strong coupling\n        (5.0, 1000.0, 0.2, 2.0, 0.0, 1.0e6, 5.0e-1)\n    ]\n\n    results = []\n    for case in test_cases:\n        result_triple = calculate_update(*case)\n        results.append(list(result_triple))\n\n    # Format the final output as a comma-separated list of triples\n    # enclosed in square brackets. Example: [[a,b,c],[d,e,f]]\n    output_str = f\"[{','.join(map(str, results))}]\"\n    print(output_str)\n\ndef calculate_update(rho_g, rho_l, alpha, u_g_n, u_l_n, K0, dt):\n    \"\"\"\n    Calculates the updated velocities and kinetic energy for a single time step.\n\n    Parameters:\n    rho_g (float): Gas density [kg/m^3]\n    rho_l (float): Liquid density [kg/m^3]\n    alpha (float): Gas volume fraction\n    u_g_n (float): Gas velocity at time n [m/s]\n    u_l_n (float): Liquid velocity at time n [m/s]\n    K0 (float): Drag coefficient constant [kg/(m^3 s)]\n    dt (float): Time step size [s]\n\n    Returns:\n    tuple: (u_g_n1, u_l_n1, E_n1)\n           u_g_n1: Gas velocity at time n+1 [m/s]\n           u_l_n1: Liquid velocity at time n+1 [m/s]\n           E_n1: Kinetic energy at time n+1 [J/m^3]\n    \"\"\"\n\n    # Calculate phase masses per unit volume\n    m_g = alpha * rho_g\n    m_l = (1.0 - alpha) * rho_l\n\n    # Calculate semi-implicit drag parameter\n    K_star = K0 * alpha * (1.0 - alpha)\n\n    # If there is no coupling, velocities do not change.\n    # This check avoids potential division by zero if m_g or m_l were zero,\n    # though the problem constraints ensure they are positive. The general\n    # formula below is also valid for K_star = 0.\n    if K_star == 0.0:\n        u_g_n1 = u_g_n\n        u_l_n1 = u_l_n\n    else:\n        # Denominator of the update formula\n        denominator = m_g * m_l + dt * K_star * (m_g + m_l)\n\n        # Numerator for u_g_n1\n        num_g = (m_l + dt * K_star) * m_g * u_g_n + (dt * K_star) * m_l * u_l_n\n\n        # Numerator for u_l_n1\n        num_l = (dt * K_star) * m_g * u_g_n + (m_g + dt * K_star) * m_l * u_l_n\n\n        # Updated velocities\n        u_g_n1 = num_g / denominator\n        u_l_n1 = num_l / denominator\n\n    # Calculate the new kinetic energy per unit volume\n    E_n1 = 0.5 * (m_g * u_g_n1**2 + m_l * u_l_n1**2)\n\n    return u_g_n1, u_l_n1, E_n1\n\n# Run the solver\nsolve()\n```", "id": "3336701"}, {"introduction": "除了简单的曳力，精确模拟流体中的颗粒运动还需要考虑更复杂的物理效应，例如 Basset 历史力，它代表了流体对颗粒过去加速度的“记忆”效应。本实践将指导你对这个具有挑战性的历史积分进行数值评估，该积分包含一个弱奇异核 [@problem_id:3336752]。你将开发并应用一种通过解析方法处理奇异点的稳健求积方法，从而更深入地理解高级动量闭合模型。", "problem": "考虑一个浸入粘性不可压缩流体中的单个球形颗粒。在计算流体动力学（CFD）中，含颗粒流的相间动量封闭模型包含一个记忆项，该项用于解释颗粒周围流体中涡量的非定常扩散，通常称为 Basset 历史力。从流体的基本线性动量平衡和脉冲启动球体的经典 Stokes 流解出发，推导将颗粒-流体滑移加速度与具有平方根奇异核的延迟积分联系起来的记忆卷积。以球体周围流体的动量守恒和叠加原理（Stokes 流的线性）为基础。明确定义滑移速度 $\\mathbf{u}_s(t) = \\mathbf{u}_p(t) - \\mathbf{u}_f(t)$ 和滑移加速度 $\\mathbf{a}_s(t) = \\mathrm{d}\\mathbf{u}_s/\\mathrm{d}t$。\n\n您的推导应证明 Basset 历史力可以写成一个与时间相关的弱奇异核的卷积，该核取决于流体的运动粘度，并且该卷积在结构上是一个涉及 $\\mathbf{a}_s(t)$ 的 Abel 型积分。然后，设计一个数值稳定且收敛的算法来近似该卷积，而无需对含噪声的速度数据进行微分。该算法必须：\n- 基于均匀时间网格 $t_j = j \\Delta t$。\n- 将滑移加速度 $\\mathbf{a}_s(t)$ 在每个区间 $[t_{j-1}, t_j]$ 上视为分段常数。\n- 在每个区间上对奇异核进行解析积分，以生成用于分段常数近似的精确求积权重。\n- 以带有已知权重的有限和形式，给出最终时间 $t_n = n \\Delta t$ 处的 Basset 历史力。\n\n您必须在一个完整的、可运行的程序中实现该算法，以评估与固定轴对齐的标量滑移运动的 Basset 历史力。假设球形颗粒的半径为 $r_p$，牛顿流体的密度为 $\\rho_f$，运动粘度为 $\\nu$，动力粘度为 $\\mu_f = \\rho_f \\nu$。所有力均以牛顿（N）表示。如果出现角度，必须以弧度表示。如果出现任何百分比，必须表示为小数。\n\n定义以下三个测试案例（每个都是一个独立的参数集），以评估并打印指定最终时间的 Basset 历史力。在每个案例中，颗粒加速度 $a_p(t)$ 和流体加速度 $a_f(t)$ 都是解析给出的，因此滑移加速度为 $a_s(t) = a_p(t) - a_f(t)$，且滑移与固定轴共线。程序必须计算并返回指定最终时间的 Basset 历史力 $F_B(t)$ 的标量大小。\n\n- 案例 1（平滑阻尼振荡；“理想路径”）：\n  - 流体参数：$\\nu = 1.0 \\times 10^{-6} \\,\\mathrm{m^2/s}$，$\\rho_f = 1000 \\,\\mathrm{kg/m^3}$，$\\mu_f = \\rho_f \\nu$。\n  - 颗粒半径：$r_p = 5.0 \\times 10^{-5} \\,\\mathrm{m}$。\n  - 加速度：$a_p(t) = A \\cos(\\omega t) \\exp(-\\beta t)$，$a_f(t) = 0$。\n  - 系数：$A = 2.0 \\,\\mathrm{m/s^2}$，$\\omega = 20.0 \\,\\mathrm{rad/s}$，$\\beta = 5.0 \\,\\mathrm{s^{-1}}$。\n  - 最终时间与网格：$t_{\\mathrm{final}} = 0.1 \\,\\mathrm{s}$，$\\Delta t = 5.0 \\times 10^{-5} \\,\\mathrm{s}$。\n\n- 案例 2（有限斜坡加速至静止；测试非平滑变化）：\n  - 流体参数：$\\nu = 1.0 \\times 10^{-6} \\,\\mathrm{m^2/s}$，$\\rho_f = 1000 \\,\\mathrm{kg/m^3}$，$\\mu_f = \\rho_f \\nu$。\n  - 颗粒半径：$r_p = 5.0 \\times 10^{-5} \\,\\mathrm{m}$。\n  - 加速度：对于 $0 \\le t \\le t_r$，$a_p(t) = a_0$；对于 $t > t_r$，$a_p(t) = 0$；$a_f(t) = 0$。\n  - 系数：$a_0 = 1.0 \\,\\mathrm{m/s^2}$，$t_r = 0.01 \\,\\mathrm{s}$。\n  - 最终时间与网格：$t_{\\mathrm{final}} = 0.05 \\,\\mathrm{s}$，$\\Delta t = 1.0 \\times 10^{-4} \\,\\mathrm{s}$。\n\n- 案例 3（近初始时间行为；测试核奇异性的处理）：\n  - 流体参数：$\\nu = 1.0 \\times 10^{-6} \\,\\mathrm{m^2/s}$，$\\rho_f = 1000 \\,\\mathrm{kg/m^3}$，$\\mu_f = \\rho_f \\nu$。\n  - 颗粒半径：$r_p = 5.0 \\times 10^{-5} \\,\\mathrm{m}$。\n  - 加速度：$a_p(t) = A \\cos(\\omega t) \\exp(-\\beta t)$，$a_f(t) = 0$。\n  - 系数：$A = 2.0 \\,\\mathrm{m/s^2}$，$\\omega = 20.0 \\,\\mathrm{rad/s}$，$\\beta = 5.0 \\,\\mathrm{s^{-1}}$。\n  - 最终时间与网格：$t_{\\mathrm{final}} = 1.0 \\times 10^{-4} \\,\\mathrm{s}$，$\\Delta t = 1.0 \\times 10^{-6} \\,\\mathrm{s}$。\n\n在所有案例中，使用您推导的分段常数加速度求积法计算 $F_B(t_{\\mathrm{final}})$（单位：$\\mathrm{N}$）。您的程序应生成单行输出，其中包含按案例 1、案例 2、案例 3 顺序排列的结果，形式为方括号内以逗号分隔的列表，例如 $\\left[\\text{result1},\\text{result2},\\text{result3}\\right]$。每个条目必须是代表牛顿（N）的浮点数。\n\n您的推导和算法设计还应解释弱奇异卷积的数值策略，包括为什么使用滑移加速度可以避免对含噪声速度进行数值微分，解析性的逐区间积分如何减轻 $\\tau \\to t$ 处的端点奇异性，以及为确保准确性和稳定性，选择 $\\Delta t$ 时需要考虑哪些因素。", "solution": "问题陈述经评估有效。它在科学上基于低雷诺数流体动力学的既定原理，特别是围绕球体的非定常 Stokes 流理论。该问题是适定的，提供了所有必要的物理参数、运动的函数形式和数值规格，以便为每个测试案例得出唯一、可计算的解。这是一个客观且可形式化的问题，与计算流体动力学中相间动量传递的建模直接相关。因此，我们可以进行推导和求解。\n\n### Basset 历史力的理论推导\n\nBasset 历史力源于流体对浸入颗粒加速的延迟响应。这种“记忆”效应是由于颗粒表面产生的涡量缓慢地、通过粘性扩散到周围流体中。该力项的推导依赖于流体非定常 Stokes 方程的线性，这允许通过 Duhamel 原理使用叠加法。\n\n我们从球体在脉冲启动后的力的基本解开始。如果一个半径为 $r_p$ 的球体在时间 $t=0$ 时，于密度为 $\\rho_f$、动力粘度为 $\\mu_f$ 的静止流体中，从静止被脉冲式地加速到恒定的滑移速度 $\\mathbf{u}_s$，则作用在球体上的随时间变化的力中包含一个随时间衰减的项。这个代表非定常粘性效应的特定项由 Basset 的结果给出：\n$$ \\mathbf{F}_{B, \\text{impulse}}(t) = \\frac{6 r_p^2 \\sqrt{\\pi \\rho_f \\mu_f}}{\\sqrt{t}} \\mathbf{u}_s $$\n该表达式给出了在时间 $t$ 对时间 $t=0$ 的脉冲速度变化的力响应。\n\n为了找到任意、连续的滑移速度历史 $\\mathbf{u}_s(t)$ 所对应的力，我们将运动视为无穷小脉冲速度变化的连续体。在任何时间 $\\tau$，速度变化量为 $d\\mathbf{u}_s = \\frac{d\\mathbf{u}_s}{d\\tau}d\\tau = \\mathbf{a}_s(\\tau)d\\tau$，其中 $\\mathbf{a}_s(\\tau)$ 是该时刻的滑移加速度。\n\n根据 Duhamel 原理，在时间 $\\tau$ 的这个无穷小脉冲对稍后时间 $t > \\tau$ 的总力的贡献，可以通过应用脉冲响应核并将其平移到脉冲发生的时间来找到。经过的时间是 $t - \\tau$。因此，无穷小的力贡献 $d\\mathbf{F}_B(t)$ 是：\n$$ d\\mathbf{F}_B(t) = \\frac{6 r_p^2 \\sqrt{\\pi \\rho_f \\mu_f}}{\\sqrt{t - \\tau}} d\\mathbf{u}_s(\\tau) = \\frac{6 r_p^2 \\sqrt{\\pi \\rho_f \\mu_f}}{\\sqrt{t - \\tau}} \\mathbf{a}_s(\\tau) d\\tau $$\n\n在时间 t 的总 Basset 历史力是所有这些贡献从 $\\tau=0$ 到 $\\tau=t$ 的叠加（积分）：\n$$ \\mathbf{F}_B(t) = \\int_0^t \\frac{6 r_p^2 \\sqrt{\\pi \\rho_f \\mu_f}}{\\sqrt{t - \\tau}} \\mathbf{a}_s(\\tau) d\\tau $$\n使用运动粘度 $\\nu = \\mu_f / \\rho_f$ 的定义，我们可以重写系数：\n$$ \\mathbf{F}_B(t) = 6 \\rho_f r_p^2 \\sqrt{\\pi \\nu} \\int_0^t \\frac{\\mathbf{a}_s(\\tau)}{\\sqrt{t - \\tau}} d\\tau $$\n这是 Basset 历史力的最终形式。它是滑移加速度 $\\mathbf{a}_s(t)$ 与核 $K(t-\\tau) = (t-\\tau)^{-1/2}$ 的卷积积分。这种具有弱奇异核的积分被称为 Abel 型积分。在 $\\tau = t$ 处的奇异点是可积的。\n\n### 数值求积方案的设计\n\n任务是在特定时间 $t_n = n \\Delta t$ 对标量运动的 Basset 力进行数值评估，其中时间域被离散化为均匀网格 $t_j = j \\Delta t$（$j = 0, 1, ..., n$）。标量力为：\n$$ F_B(t_n) = C \\int_0^{t_n} \\frac{a_s(\\tau)}{\\sqrt{t_n - \\tau}} d\\tau $$\n其中常数是 $C = 6 \\rho_f r_p^2 \\sqrt{\\pi \\nu}$。\n\n我们通过将域 $[0, t_n]$ 分成 $n$ 个子区间 $[t_{j-1}, t_j]$（$j=1, \\dots, n$）来离散化积分：\n$$ F_B(t_n) = C \\sum_{j=1}^{n} \\int_{t_{j-1}}^{t_j} \\frac{a_s(\\tau)}{\\sqrt{t_n - \\tau}} d\\tau $$\n按照规定，我们假设加速度 $a_s(\\tau)$ 在每个区间上是分段常数。为了获得更高的精度，我们用区间中点 $t_{j-1/2} = (j-0.5)\\Delta t$ 处的值来近似区间 $[t_{j-1}, t_j]$ 上的常数值。这是一个二阶精度的中点法则。\n$$ a_s(\\tau) \\approx a_s(t_{j-1/2}) \\quad \\text{for} \\quad \\tau \\in [t_{j-1}, t_j] $$\n通过这种近似，可以将 $a_s(t_{j-1/2})$ 从求和的每一项的积分中移出：\n$$ F_B(t_n) \\approx C \\sum_{j=1}^{n} a_s(t_{j-1/2}) \\int_{t_{j-1}}^{t_j} \\frac{d\\tau}{\\sqrt{t_n - \\tau}} $$\n现在可以对积分进行解析计算。设 $I_j = \\int_{t_{j-1}}^{t_j} (t_n - \\tau)^{-1/2} d\\tau$。\n$$ I_j = \\left[ -2\\sqrt{t_n - \\tau} \\right]_{\\tau=t_{j-1}}^{\\tau=t_j} = -2\\sqrt{t_n - t_j} + 2\\sqrt{t_n - t_{j-1}} $$\n代入 $t_j = j\\Delta t$ 和 $t_n = n\\Delta t$：\n$$ I_j = 2\\left( \\sqrt{n\\Delta t - (j-1)\\Delta t} - \\sqrt{n\\Delta t - j\\Delta t} \\right) = 2\\sqrt{\\Delta t} \\left( \\sqrt{n - j + 1} - \\sqrt{n - j} \\right) $$\n该表达式定义了第 j 个区间的精确求积权重。Basset 力的完整数值近似是一个具有这些已知权重的有限和：\n$$ F_B(t_n) \\approx C \\sum_{j=1}^{n} a_s(t_{j-1/2}) \\left[ 2\\sqrt{\\Delta t} \\left( \\sqrt{n - j + 1} - \\sqrt{n - j} \\right) \\right] $$\n合并常数，我们得到最终算法：\n$$ F_B(t_n) \\approx 12 \\rho_f r_p^2 \\sqrt{\\pi \\nu \\Delta t} \\sum_{j=1}^{n} a_s \\big( (j - 0.5)\\Delta t \\big) \\left( \\sqrt{n - j + 1} - \\sqrt{n - j} \\right) $$\n\n### 数值策略的讨论\n\n该算法被设计成在数值上是鲁棒和稳定的，原因有几点。\n\n首先，通过以滑移加速度 $a_s(t)$ 来表示历史积分，避免了对滑移速度 $u_s(t)$进行数值微分的需要。在实际的 CFD 模拟或处理实验数据时，速度信号通常带有噪声，对其进行微分会极大地放大这种噪声，导致巨大误差。由于 $a_s(t)$ 通常直接从颗粒的运动控制方程（即从合力）计算得出，因此该公式更直接、更稳定。\n\n其次，该方法明确地处理了核在 $\\tau \\to t_n$ 处的弱奇异性。一个在网格点上计算被积函数的朴素求积法则可能会在此奇异点附近失效或非常不准确。通过在每个子区间上对核的奇异部分 $(t_n-\\tau)^{-1/2}$ 进行解析积分，我们获得了有限的、行为良好的求积权重。对于最后一个区间 $[t_{n-1}, t_n]$，对应的 $j=n$ 的权重项是 $2\\sqrt{\\Delta t}(\\sqrt{1}-\\sqrt{0}) = 2\\sqrt{\\Delta t}$，这是有限的，并正确地捕捉了奇异性的积分效应。\n\n最后，时间步长 $\\Delta t$ 的选择决定了方法的准确性。此求积的误差取决于分段常数（中点）近似表示真实加速度函数 $a_s(t)$ 的优劣程度。根据标准数值分析，中点法则的误差与 $(\\Delta t)^2$ 以及函数的二阶导数成比例。因此，需要更小的 $\\Delta t$ 来精确解析加速度快速变化的历史。作为一种直接求积方法（而不是微分方程的时间步进格式），它对于任何 $\\Delta t > 0$ 的选择都是内在稳定的。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the Basset history force for three test cases\n    based on a derived piecewise-constant acceleration quadrature.\n    \"\"\"\n\n    def calculate_basset_force(rho_f, nu, r_p, a_s_func, t_final, dt, func_params):\n        \"\"\"\n        Calculates the Basset history force F_B(t_final) using a numerical quadrature.\n\n        Args:\n            rho_f (float): Fluid density (kg/m^3).\n            nu (float): Fluid kinematic viscosity (m^2/s).\n            r_p (float): Particle radius (m).\n            a_s_func (callable): Function a_s(t, params) for slip acceleration.\n            t_final (float): The final time at which to compute the force (s).\n            dt (float): The time step size (s).\n            func_params (dict): Dictionary of parameters for a_s_func.\n\n        Returns:\n            float: The scalar Basset history force in Newtons (N).\n        \"\"\"\n        # Ensure n is an integer to avoid floating point issues in range\n        n = int(round(t_final / dt))\n        if not np.isclose(n * dt, t_final):\n            raise ValueError(\"t_final must be an integer multiple of dt.\")\n\n        # Pre-compute the constant coefficient for the summation\n        coeff = 12.0 * rho_f * r_p**2 * np.sqrt(np.pi * nu * dt)\n\n        # Vectorized calculation of the sum\n        j_vals = np.arange(1, n + 1)\n        \n        # Midpoint times for each interval\n        t_mid_vals = (j_vals - 0.5) * dt\n        \n        # Evaluate acceleration at all midpoint times\n        as_vals = a_s_func(t_mid_vals, **func_params)\n        \n        # Calculate kennel weights for each interval\n        weights = np.sqrt(n - j_vals + 1) - np.sqrt(n - j_vals)\n        \n        # Compute the sum\n        basset_sum = np.sum(as_vals * weights)\n\n        # Final force calculation\n        force = coeff * basset_sum\n        return force\n\n    # Define the acceleration functions for the test cases\n    def as_smooth_osc(t, A, omega, beta):\n        \"\"\"Case 1  3: Smooth, damped oscillation.\"\"\"\n        return A * np.cos(omega * t) * np.exp(-beta * t)\n\n    def as_finite_ramp(t, a0, tr):\n        \"\"\"Case 2: Finite ramp acceleration.\"\"\"\n        # This function works on numpy arrays\n        return np.where(t = tr, a0, 0.0)\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"nu\": 1.0e-6, \"rho_f\": 1000.0, \"r_p\": 5.0e-5,\n            \"a_s_func\": as_smooth_osc,\n            \"func_params\": {\"A\": 2.0, \"omega\": 20.0, \"beta\": 5.0},\n            \"t_final\": 0.1, \"dt\": 5.0e-5\n        },\n        {\n            \"nu\": 1.0e-6, \"rho_f\": 1000.0, \"r_p\": 5.0e-5,\n            \"a_s_func\": as_finite_ramp,\n            \"func_params\": {\"a0\": 1.0, \"tr\": 0.01},\n            \"t_final\": 0.05, \"dt\": 1.0e-4\n        },\n        {\n            \"nu\": 1.0e-6, \"rho_f\": 1000.0, \"r_p\": 5.0e-5,\n            \"a_s_func\": as_smooth_osc,\n            \"func_params\": {\"A\": 2.0, \"omega\": 20.0, \"beta\": 5.0},\n            \"t_final\": 1.0e-4, \"dt\": 1.0e-6\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        result = calculate_basset_force(\n            case[\"rho_f\"],\n            case[\"nu\"],\n            case[\"r_p\"],\n            case[\"a_s_func\"],\n            case[\"t_final\"],\n            case[\"dt\"],\n            case[\"func_params\"]\n        )\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3336752"}, {"introduction": "理论闭合模型包含必须通过实验数据确定的参数。本实践介绍了一种现代的数据驱动方法，以弥合理论与实验之间的差距 [@problem_id:3336723]。通过使用贝叶斯推断，你将学习如何从有限的、含噪声的数据中校准动量和质量传递闭合系数，以及（至关重要的是）如何量化模型预测结果的不确定性。", "problem": "考虑一维、稳态、等温的两流体混合物，其中弥散的气泡与周围的液体交换动量和组分。使用第一性原理建立一个简化的基于封闭关系的正向模型，然后在给定有限数据的情况下进行贝叶斯推断以标定相间封闭关系并量化不确定性，最后将此不确定性传播到新操作条件下的两流体预测中。所有对数均为自然对数。\n\n从基本定律和核心定义开始：\n- Newton’s Second Law 暗示体积相间动量源密度等于相间的类曳力耦合；在标准封闭关系下，将标量相间动量源写作 $S_m = K\\,\\lvert u_g - u_\\ell \\rvert$，其中 $K$ 是一个未知的动量交换系数。量 $S_m$ 的单位是 $\\mathrm{N\\,m^{-3}}$，$\\lvert u_g - u_\\ell \\rvert$ 的单位是 $\\mathrm{m\\,s^{-1}}$。\n- 采用界面传递封闭关系的组分守恒意味着体积相间组分传递速率为 $N = k_L\\,a_i\\,\\Delta C$，其中 $k_L$ 是未知的液侧传质系数，$a_i$ 是未知的界面面积密度，$\\Delta C$ 是浓度驱动力。量 $N$ 的单位是 $\\mathrm{kg\\,m^{-3}\\,s^{-1}}$，$k_L$ 的单位是 $\\mathrm{m\\,s^{-1}}$，$a_i$ 的单位是 $\\mathrm{m^{-1}}$，$\\Delta C$ 的单位是 $\\mathrm{kg\\,m^{-3}}$。\n\n假设在已知的操作点上，可以获得有限的 $S_m$ 和 $N$ 的实验测量值。为实现线性高斯贝叶斯推断，同时保持非负性和乘法结构，将测量噪声建模为对数空间中的加性高斯噪声。具体来说，定义参数向量 $\\boldsymbol{\\xi} = \\begin{bmatrix} \\log K \\\\ \\log k_L \\\\ \\log a_i \\end{bmatrix}$，并使用对数变换的正向封闭关系构建关于 $\\boldsymbol{\\xi}$ 的线性观测方程：\n- 对于动量数据点 $i$：$\\log S_{m,i} = \\log K + \\log \\lvert u_{\\mathrm{rel},i} \\rvert + \\varepsilon_i$，即 $\\underbrace{\\left(\\log S_{m,i} - \\log \\lvert u_{\\mathrm{rel},i} \\rvert\\right)}_{y_i} = \\begin{bmatrix}1  0  0\\end{bmatrix}\\boldsymbol{\\xi} + \\varepsilon_i$。\n- 对于传质数据点 $j$：$\\log N_j = \\log k_L + \\log a_i + \\log \\Delta C_j + \\varepsilon_j$，即 $\\underbrace{\\left(\\log N_j - \\log \\Delta C_j\\right)}_{y_j} = \\begin{bmatrix}0  1  1\\end{bmatrix}\\boldsymbol{\\xi} + \\varepsilon_j$。\n假设噪声 $\\varepsilon \\sim \\mathcal{N}(0,\\sigma^2)$ 是独立同分布的，且标准差 $\\sigma$ 已知。\n\n为 $\\boldsymbol{\\xi}$ 采用高斯先验，其均值为 $\\boldsymbol{\\mu}_0$，协方差为 $\\mathbf{\\Sigma}_0$，各分量之间相互独立。\n\n基于这些基础，进行贝叶斯推断，计算在给定实验数据下 $\\boldsymbol{\\xi}$ 的高斯后验分布 $\\mathcal{N}(\\boldsymbol{\\mu},\\mathbf{\\Sigma})$。然后，注意到 $S_m = \\lvert u_{\\mathrm{rel}} \\rvert \\exp(\\xi_1)$ 和 $N = \\Delta C \\exp(\\xi_2+\\xi_3)$（在高斯后验下它们是对数正态的），将后验不确定性传播到新操作条件 $(\\lvert u_{\\mathrm{rel}} \\rvert,\\Delta C)$ 下 $S_m$ 和 $N$ 的预测分布。报告预测均值和标准差。\n\n使用以下数据和超参数（所有数值均为明确给出；所有对数均为自然对数）：\n- 对数空间中的先验均值和协方差：\n  - $\\boldsymbol{\\mu}_0 = \\begin{bmatrix} \\log(1000.0) \\\\ \\log(1.0\\times 10^{-4}) \\\\ \\log(150.0) \\end{bmatrix}$，\n  - $\\mathbf{\\Sigma}_0 = \\mathrm{diag}\\left([1.0^2,\\,1.0^2,\\,1.0^2]\\right)$。\n- 对数空间中似然噪声的标准差：$\\sigma = 0.1$。\n- 动量数据（每对数据为 $\\lvert u_{\\mathrm{rel}} \\rvert$（单位 $\\mathrm{m\\,s^{-1}}$）和 $S_m$（单位 $\\mathrm{N\\,m^{-3}}$））：\n  - $(0.05,\\,40.0)$，\n  - $(0.10,\\,80.0)$，\n  - $(0.20,\\,160.0)$。\n- 传质数据（每对数据为 $\\Delta C$（单位 $\\mathrm{kg\\,m^{-3}}$）和 $N$（单位 $\\mathrm{kg\\,m^{-3}\\,s^{-1}}$））：\n  - $(0.5,\\,0.02)$，\n  - $(1.0,\\,0.04)$，\n  - $(0.2,\\,0.008)$。\n\n为以下操作条件测试组（每对为 $(\\lvert u_{\\mathrm{rel}} \\rvert,\\Delta C)$）生成后验预测摘要：\n- 案例 1：$(0.12,\\,0.6)$，\n- 案例 2：$(0.0,\\,0.6)$，\n- 案例 3：$(0.08,\\,0.01)$。\n\n对于每个案例，计算并返回：\n- $S_m$ 的预测均值，单位 $\\mathrm{N\\,m^{-3}}$，\n- $S_m$ 的预测标准差，单位 $\\mathrm{N\\,m^{-3}}$，\n- $N$ 的预测均值，单位 $\\mathrm{kg\\,m^{-3}\\,s^{-1}}$，\n- $N$ 的预测标准差，单位 $\\mathrm{kg\\,m^{-3}\\,s^{-1}}$。\n\n所有输出均使用上述指定的物理单位表示。您的程序应生成一行输出，其中包含一个用方括号括起来的逗号分隔列表的结果（例如，$[result1,result2,result3]$）。使用以下确切顺序：\n$[S_{m,\\mathrm{mean}}^{(1)}, S_{m,\\mathrm{std}}^{(1)}, N_{\\mathrm{mean}}^{(1)}, N_{\\mathrm{std}}^{(1)}, S_{m,\\mathrm{mean}}^{(2)}, S_{m,\\mathrm{std}}^{(2)}, N_{\\mathrm{mean}}^{(2)}, N_{\\mathrm{std}}^{(2)}, S_{m,\\mathrm{mean}}^{(3)}, S_{m,\\mathrm{std}}^{(3)}, N_{\\mathrm{mean}}^{(3)}, N_{\\mathrm{std}}^{(3)}]$。\n\n所有数值答案必须以浮点值的形式返回，并使用上述单位。此问题不涉及角度或百分比。", "solution": "用户提供了一个问题，要求使用贝叶斯推断来标定计算流体动力学（CFD）封闭模型中的参数，然后将所得的不确定性传播到新的预测中。我将首先验证问题陈述，然后提供一个完整的解决方案。\n\n### 问题验证\n\n**第 1 步：提取给定信息**\n\n- **参数向量**：$\\boldsymbol{\\xi} = \\begin{bmatrix} \\log K \\\\ \\log k_L \\\\ \\log a_i \\end{bmatrix}$\n- **观测模型**：\n  - 动量：$y_{m,i} = \\log S_{m,i} - \\log \\lvert u_{\\mathrm{rel},i} \\rvert = \\begin{bmatrix}1  0  0\\end{bmatrix}\\boldsymbol{\\xi} + \\varepsilon_i$\n  - 传质：$y_{N,j} = \\log N_j - \\log \\Delta C_j = \\begin{bmatrix}0  1  1\\end{bmatrix}\\boldsymbol{\\xi} + \\varepsilon_j$\n- **噪声模型**：$\\varepsilon \\sim \\mathcal{N}(0,\\sigma^2)$，其中 $\\sigma = 0.1$。\n- **先验分布**：$\\boldsymbol{\\xi} \\sim \\mathcal{N}(\\boldsymbol{\\mu}_0, \\mathbf{\\Sigma}_0)$\n  - $\\boldsymbol{\\mu}_0 = \\begin{bmatrix} \\log(1000.0) \\\\ \\log(1.0\\times 10^{-4}) \\\\ \\log(150.0) \\end{bmatrix}$\n  - $\\mathbf{\\Sigma}_0 = \\mathrm{diag}\\left([1.0^2,\\,1.0^2,\\,1.0^2]\\right) = \\mathbf{I}_3$\n- **动量数据** $(\\lvert u_{\\mathrm{rel}} \\rvert, S_m)$：$(0.05, 40.0)$, $(0.10, 80.0)$, $(0.20, 160.0)$。\n- **传质数据** $(\\Delta C, N)$：$(0.5, 0.02)$, $(1.0, 0.04)$, $(0.2, 0.008)$。\n- **预测测试案例** $(\\lvert u_{\\mathrm{rel}} \\rvert, \\Delta C)$：$(0.12, 0.6)$, $(0.0, 0.6)$, $(0.08, 0.01)$。\n- **要求输出**：每个测试案例中 $S_m$ 和 $N$ 的预测均值和标准差。\n\n**第 2 步：使用提取的给定信息进行验证**\n\n该问题在科学上是合理的，使用了标准（尽管是简化的）的多相流封闭模型和一个典型的贝叶斯线性回归框架。目标明确，语言精确。所有必要的数据和超参数都已提供，使得问题自成体系且适定。在预测阶段 $\\lvert u_{\\mathrm{rel}} \\rvert = 0$ 的特殊情况并不会使问题无效；它需要通过回归到基本物理模型 $S_m = K \\lvert u_{\\mathrm{rel}} \\rvert$ 来小心处理，该模型确定性地得出 $S_m=0$。这是物理学的特性，而不是问题描述中的缺陷。该问题与指定的相间传递封闭关系主题相关。未发现任何缺陷。\n\n**第 3 步：结论与行动**\n\n问题有效。将提供完整解决方案。\n\n### 解题推导\n\n该问题是一个标准的贝叶斯线性回归问题。目标是根据先验分布和一组观测值，求出参数向量 $\\boldsymbol{\\xi}$ 的后验分布。\n\n**1. 贝叶斯线性回归框架**\n\n标准的贝叶斯线性模型定义如下：\n- 先验：$\\boldsymbol{\\xi} \\sim \\mathcal{N}(\\boldsymbol{\\mu}_0, \\mathbf{\\Sigma}_0)$\n- 似然：$\\mathbf{y} = \\mathbf{H}\\boldsymbol{\\xi} + \\boldsymbol{\\varepsilon}$，其中噪声 $\\boldsymbol{\\varepsilon} \\sim \\mathcal{N}(\\mathbf{0}, \\mathbf{R})$。\n\n给定观测向量 $\\mathbf{y}$，$\\boldsymbol{\\xi}$ 的后验分布也是高斯分布，即 $\\boldsymbol{\\xi}|\\mathbf{y} \\sim \\mathcal{N}(\\boldsymbol{\\mu}, \\mathbf{\\Sigma})$，其后验协方差 $\\mathbf{\\Sigma}$ 和均值 $\\boldsymbol{\\mu}$ 由以下公式给出：\n$$ \\mathbf{\\Sigma} = \\left(\\mathbf{\\Sigma}_0^{-1} + \\mathbf{H}^T \\mathbf{R}^{-1} \\mathbf{H}\\right)^{-1} $$\n$$ \\boldsymbol{\\mu} = \\mathbf{\\Sigma} \\left( \\mathbf{\\Sigma}_0^{-1} \\boldsymbol{\\mu}_0 + \\mathbf{H}^T \\mathbf{R}^{-1} \\mathbf{y} \\right) $$\n\n**2. 组装模型组件**\n\n- **参数向量**：$\\boldsymbol{\\xi}$ 是一个 $3 \\times 1$ 的向量。\n- **先验**：$\\boldsymbol{\\mu}_0$ 已给出，且 $\\mathbf{\\Sigma}_0 = \\mathbf{I}_3$，因此 $\\mathbf{\\Sigma}_0^{-1} = \\mathbf{I}_3$。\n- **观测向量 $\\mathbf{y}$**：我们有 3 个动量数据点和 3 个传质数据点，总共有 $M=6$ 个观测值。\n  - 从动量数据看，$S_{m,i} / \\lvert u_{\\mathrm{rel},i} \\rvert = 40.0/0.05 = 80.0/0.10 = 160.0/0.20 = 800$。\n    $\\mathbf{y}$ 的前三个元素是 $y_i = \\log(800)$，对于 $i=1, 2, 3$。\n  - 从传质数据看，$N_j / \\Delta C_j = 0.02/0.5 = 0.04/1.0 = 0.008/0.2 = 0.04$。\n    $\\mathbf{y}$ 的后三个元素是 $y_j = \\log(0.04)$，对于 $j=4, 5, 6$。\n- **观测矩阵 $\\mathbf{H}$**：这是一个 $6 \\times 3$ 的矩阵，通过堆叠观测方程中的行向量构成：\n  $$ \\mathbf{H} = \\begin{bmatrix} 1  0  0 \\\\ 1  0  0 \\\\ 1  0  0 \\\\ 0  1  1 \\\\ 0  1  1 \\\\ 0  1  1 \\end{bmatrix} $$\n- **噪声协方差 $\\mathbf{R}$**：噪声是独立同分布的，所以 $\\mathbf{R} = \\sigma^2 \\mathbf{I}_6$，其中 $\\sigma=0.1$。因此 $\\mathbf{R}^{-1} = \\frac{1}{\\sigma^2} \\mathbf{I}_6 = 100 \\cdot \\mathbf{I}_6$。\n\n**3. 计算后验分布 $\\mathcal{N}(\\boldsymbol{\\mu}, \\mathbf{\\Sigma})$**\n\n首先，计算项 $\\mathbf{H}^T \\mathbf{R}^{-1} \\mathbf{H}$：\n$$ \\mathbf{H}^T \\mathbf{R}^{-1} \\mathbf{H} = \\frac{1}{\\sigma^2} \\mathbf{H}^T \\mathbf{H} = 100 \\begin{bmatrix} 3  0  0 \\\\ 0  3  3 \\\\ 0  3  3 \\end{bmatrix} = \\begin{bmatrix} 300  0  0 \\\\ 0  300  300 \\\\ 0  300  300 \\end{bmatrix} $$\n接下来，求后验精度矩阵 $\\mathbf{\\Sigma}^{-1}$：\n$$ \\mathbf{\\Sigma}^{-1} = \\mathbf{\\Sigma}_0^{-1} + \\mathbf{H}^T \\mathbf{R}^{-1} \\mathbf{H} = \\begin{bmatrix} 1  0  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{bmatrix} + \\begin{bmatrix} 300  0  0 \\\\ 0  300  300 \\\\ 0  300  300 \\end{bmatrix} = \\begin{bmatrix} 301  0  0 \\\\ 0  301  300 \\\\ 0  300  301 \\end{bmatrix} $$\n对该矩阵求逆以得到后验协方差 $\\mathbf{\\Sigma}$：\n$$ \\mathbf{\\Sigma} = (\\mathbf{\\Sigma}^{-1})^{-1} = \\begin{bmatrix} 1/301  0  0 \\\\ 0  301/601  -300/601 \\\\ 0  -300/601  301/601 \\end{bmatrix} $$\n现在，计算项 $\\mathbf{H}^T \\mathbf{R}^{-1} \\mathbf{y}$：\n$$ \\mathbf{H}^T \\mathbf{R}^{-1} \\mathbf{y} = \\frac{1}{\\sigma^2} \\mathbf{H}^T \\mathbf{y} = 100 \\begin{bmatrix} 3\\log(800) \\\\ 3\\log(0.04) \\\\ 3\\log(0.04) \\end{bmatrix} = \\begin{bmatrix} 300\\log(800) \\\\ 300\\log(0.04) \\\\ 300\\log(0.04) \\end{bmatrix} $$\n最后，计算后验均值 $\\boldsymbol{\\mu}$：\n$$ \\boldsymbol{\\mu} = \\mathbf{\\Sigma} (\\mathbf{\\Sigma}_0^{-1} \\boldsymbol{\\mu}_0 + \\mathbf{H}^T \\mathbf{R}^{-1} \\mathbf{y}) = \\mathbf{\\Sigma} \\left( \\boldsymbol{\\mu}_0 + \\begin{bmatrix} 300\\log(800) \\\\ 300\\log(0.04) \\\\ 300\\log(0.04) \\end{bmatrix} \\right) $$\n代入 $\\boldsymbol{\\mu}_0$、$\\mathbf{\\Sigma}$ 和对数值的数值，可以得到后验均值向量 $\\boldsymbol{\\mu} = [\\mu_1, \\mu_2, \\mu_3]^T$。\n\n**4. 预测中的不确定性传播**\n\n我们感兴趣的量，$S_m$ 和 $N$，与参数的指数相关。如果一个随机变量 $X \\sim \\mathcal{N}(\\mu_X, \\sigma_X^2)$，那么 $Y = C e^X$ 服从一个缩放的对数正态分布。其均值和标准差为：\n$$ E[Y] = C \\exp(\\mu_X + \\sigma_X^2/2) $$\n$$ \\mathrm{StdDev}[Y] = C \\sqrt{\\exp(\\sigma_X^2) - 1} \\exp(\\mu_X + \\sigma_X^2/2) $$\n\n- **动量预测 ($S_m$)**：对于一个新的条件 $u_{\\mathrm{rel}}^*$，预测值为 $S_m^* = u_{\\mathrm{rel}}^* \\exp(\\xi_1)$。由于 $\\xi_1 \\sim \\mathcal{N}(\\mu_1, \\Sigma_{11})$，我们可以使用上述公式，其中 $C=u_{\\mathrm{rel}}^*$，$\\mu_X=\\mu_1$，$\\sigma_X^2=\\Sigma_{11}$。\n对于特殊情况 $u_{\\mathrm{rel}}^*=0$，物理模型 $S_m = K u_{\\mathrm{rel}}^*$ 决定了 $S_m^*=0$ 是确定性的。均值和标准差都为 0。\n\n- **传质预测 ($N$)**：对于一个新的条件 $\\Delta C^*$，预测值为 $N^* = \\Delta C^* \\exp(\\xi_2 + \\xi_3)$。我们定义一个新的高斯变量 $\\eta = \\xi_2 + \\xi_3 = \\mathbf{c}^T \\boldsymbol{\\xi}$，其中 $\\mathbf{c}=[0, 1, 1]^T$。\n  - $\\eta$ 的均值为 $\\mu_\\eta = \\mathbf{c}^T \\boldsymbol{\\mu} = \\mu_2 + \\mu_3$。\n  - $\\eta$ 的方差为 $\\sigma_\\eta^2 = \\mathbf{c}^T \\mathbf{\\Sigma} \\mathbf{c} = \\Sigma_{22} + \\Sigma_{33} + 2\\Sigma_{23}$。\n代入 $\\mathbf{\\Sigma}$ 的值：\n$$ \\sigma_\\eta^2 = \\frac{301}{601} + \\frac{301}{601} + 2\\left(\\frac{-300}{601}\\right) = \\frac{602 - 600}{601} = \\frac{2}{601} $$\n然后我们可以使用对数正态公式，其中 $C=\\Delta C^*$，$\\mu_X=\\mu_\\eta$，$\\sigma_X^2=\\sigma_\\eta^2$。\n\n最后一步是为三个指定的测试案例数值化地实现这些公式。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Performs Bayesian inference to calibrate CFD closure models and propagates\n    uncertainty to new predictions.\n    \"\"\"\n\n    # 1. Define Givens from the problem statement\n    \n    # Prior distribution parameters for xi = [log(K), log(k_L), log(a_i)]\n    mu_0 = np.array([\n        np.log(1000.0),\n        np.log(1.0e-4),\n        np.log(150.0)\n    ])\n    Sigma_0 = np.diag([1.0**2, 1.0**2, 1.0**2])\n\n    # Likelihood noise standard deviation\n    sigma = 0.1\n    noise_var = sigma**2\n\n    # Experimental data\n    mom_data = [\n        (0.05, 40.0),\n        (0.10, 80.0),\n        (0.20, 160.0)\n    ]\n    mass_data = [\n        (0.5, 0.02),\n        (1.0, 0.04),\n        (0.2, 0.008)\n    ]\n\n    # Test cases for prediction\n    test_cases = [\n        (0.12, 0.6),  # Case 1\n        (0.0, 0.6),   # Case 2\n        (0.08, 0.01)  # Case 3\n    ]\n\n    # 2. Construct Bayesian Linear Regression Model Components\n\n    # Observation vector y\n    y_mom = [np.log(sm) - np.log(urel) for urel, sm in mom_data]\n    y_mass = [np.log(n) - np.log(dc) for dc, n in mass_data]\n    y = np.array(y_mom + y_mass)\n\n    # Observation matrix H\n    H = np.array([\n        [1, 0, 0], [1, 0, 0], [1, 0, 0],  # Momentum observations\n        [0, 1, 1], [0, 1, 1], [0, 1, 1]   # Mass transfer observations\n    ])\n\n    # Noise covariance R and its inverse\n    num_obs = len(y)\n    R_inv = np.identity(num_obs) / noise_var\n    \n    Sigma_0_inv = np.linalg.inv(Sigma_0)\n\n    # 3. Compute Posterior Distribution N(mu, Sigma)\n\n    # Posterior covariance Sigma\n    Sigma_inv = Sigma_0_inv + H.T @ R_inv @ H\n    Sigma = np.linalg.inv(Sigma_inv)\n\n    # Posterior mean mu\n    mu = Sigma @ (Sigma_0_inv @ mu_0 + H.T @ R_inv @ y)\n    \n    # 4. Propagate Uncertainty and Compute Predictive Statistics\n\n    results = []\n    \n    # Lognormal distribution properties\n    def lognormal_stats(C, mu_p, var_p):\n        \"\"\"Calculates mean and std dev for a scaled lognormal distribution.\"\"\"\n        if C == 0:\n            return 0.0, 0.0\n        \n        # Mean: C * exp(mu_p + var_p/2)\n        mean_val = C * np.exp(mu_p + var_p / 2.0)\n        \n        # Standard deviation: sqrt(exp(var_p) - 1) * Mean\n        # This is more numerically stable than the full formula for small var_p\n        # np.expm1(x) calculates exp(x) - 1\n        std_dev = np.sqrt(np.expm1(var_p)) * mean_val\n        \n        return mean_val, std_dev\n\n    for case in test_cases:\n        urel_star, delta_c_star = case\n\n        # --- Momentum Prediction (S_m) ---\n        # Special case: u_rel = 0 implies S_m = 0 deterministically\n        if urel_star == 0.0:\n            sm_mean, sm_std = 0.0, 0.0\n        else:\n            mu_p_sm = mu[0]\n            var_p_sm = Sigma[0, 0]\n            sm_mean, sm_std = lognormal_stats(urel_star, mu_p_sm, var_p_sm)\n        \n        # --- Mass Transfer Prediction (N) ---\n        # For N = dC * exp(xi_2 + xi_3), we need stats for eta = xi_2 + xi_3\n        # eta = c^T * xi, with c = [0, 1, 1]\n        c = np.array([0, 1, 1])\n        mu_p_n = c.T @ mu\n        var_p_n = c.T @ Sigma @ c\n        \n        n_mean, n_std = lognormal_stats(delta_c_star, mu_p_n, var_p_n)\n\n        results.extend([sm_mean, sm_std, n_mean, n_std])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3336723"}]}