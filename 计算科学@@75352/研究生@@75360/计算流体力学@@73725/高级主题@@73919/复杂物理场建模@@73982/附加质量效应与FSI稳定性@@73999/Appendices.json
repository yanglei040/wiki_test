{"hands_on_practices": [{"introduction": "理解流固耦合（FSI）中的稳定性问题，首先要从“附加质量”这一核心概念入手。当一个物体在流体中加速运动时，它必须同时推动周围的流体，这使得物体的惯性表现得比其自身质量更大。本练习将引导你通过第一性原理，为一个在理想流体中平移的二维圆柱体推导其附加质量，从而建立对附加质量物理本质的直观理解 [@problem_id:3288867]。", "problem": "一个半径为 $R$ 的无限长圆柱体，在原本静止、不可压缩、无粘性、密度为常数 $\\rho$ 的流体中，以给定的微小振幅速度 $U(t)$ 平移。假设流动为二维（$2$D）无旋流，速度场为 $\\boldsymbol{u}=\\nabla \\phi$，势函数 $\\phi$ 在圆柱体外部的流体域中满足拉普拉斯方程。在圆柱体表面施加无穿透边界条件，并要求扰动速度在无穷远处衰减至零。利用势流的第一性原理和附加质量的动能定义，通过将流体动能等于 $\\tfrac{1}{2} m_{a}' U^{2}$（其中 $U$ 为常数），推导圆柱体在垂直于其轴线方向平移时，其单位长度附加质量 $m_{a}'$ 的闭式表达式。最终结果仅用符号 $\\rho$ 和 $R$ 表示。\n\n然后，通过对比二维圆柱体与三维（$3$D）球体的定性结果，简要解释为何维度很重要，并阐释当单位长度的结构质量 $m_{s}'$ 与流体附加质量相当或更小时，这对分区耦合中流固耦合（FSI）稳定性的影响。\n\n最终答案只提供 $m_{a}'$ 的符号表达式。请勿在最终答案框中包含单位。", "solution": "首先验证问题，以确保其科学基础可靠、适定且客观。\n\n### 步骤 1：提取已知条件\n-   几何形状：半径为 $R$ 的无限长圆柱体。\n-   流体属性：静止、不可压缩、无粘性、密度为常数 $\\rho$ 的流体。\n-   流动条件：二维（$2$D）无旋流。\n-   速度场：$\\boldsymbol{u}=\\nabla \\phi$，其中 $\\phi$ 是速度势。\n-   控制方程：在圆柱体外部的流体域中，$\\nabla^2 \\phi = 0$。\n-   圆柱体运动：以给定速度 $U(t)$ 平移。为计算附加质量，此速度取为常数 $U$。\n-   边界条件：\n    1.  圆柱体表面（$r=R$）无穿透。\n    2.  扰动速度在无穷远处衰减至零（当 $r \\to \\infty$ 时，$\\boldsymbol{u} \\to 0$）。\n-   任务：通过将单位长度的流体动能等同于 $\\frac{1}{2} m_{a}' U^{2}$，推导单位长度的附加质量 $m_{a}'$。\n-   最终表达式：用符号 $\\rho$ 和 $R$ 表示 $m_{a}'$。\n-   附加任务：简要解释维度的影响以及对流固耦合（FSI）稳定性的启示。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题是势流理论中的一个经典基础练习，势流理论是流体动力学中一个成熟的子领域。所有已知条件都具有科学依据，并描述了一个标准的理想化模型。\n-   **科学基础可靠**：该问题完全依赖于理想流体的势流原理，由拉普拉斯方程控制。这些是流体动力学中核心且无争议的概念。\n-   **适定性**：该问题是适定的。对于给定的几何形状，控制偏微分方程（拉普拉斯方程）与指定的边界条件（无穿透和无穷远处衰减）相结合，确保了速度势 $\\phi$ 存在唯一且稳定的解。\n-   **客观性**：语言精确，使用标准的数学和物理术语，没有任何主观性。\n-   **完整性和一致性**：提供了所有必要信息。没有矛盾之处。使用动能定义附加质量的要求是一种标准且有效的方法。\n-   **其他缺陷**：该问题没有任何列出的缺陷。在其陈述的理想化条件下，这是一个定义明确的理论物理问题，而非隐喻性、不完整或不切实际的问题。\n\n### 步骤 3：结论与行动\n该问题被判定为**有效**。将提供完整解答。\n\n### 求解推导\n\n我们旨在求出圆柱体单位长度的附加质量 $m_a'$。指定的方法是计算单位长度流体的动能 $KE'$，并将其等同于定义 $KE' = \\frac{1}{2} m_a' U^2$。\n\n我们建立一个极坐标系 $(r, \\theta)$，其原点位于圆柱体横截面的中心。圆柱体沿 $x$ 轴以速度 $U$ 平移，这对应于 $\\theta=0$ 的方向。\n\n速度势 $\\phi(r, \\theta)$ 必须在流体域（$r>R$）中满足拉普拉斯方程：\n$$\n\\nabla^2 \\phi = \\frac{1}{r} \\frac{\\partial}{\\partial r} \\left( r \\frac{\\partial \\phi}{\\partial r} \\right) + \\frac{1}{r^2} \\frac{\\partial^2 \\phi}{\\partial \\theta^2} = 0\n$$\n\n边界条件为：\n1.  **圆柱体表面（$r=R$）无穿透：** 流体速度的径向分量 $u_r = \\frac{\\partial \\phi}{\\partial r}$ 必须等于圆柱体表面速度的径向分量。圆柱体的速度矢量为 $\\boldsymbol{U} = U \\hat{\\boldsymbol{i}}$。在极坐标中，$\\hat{\\boldsymbol{i}} = \\cos\\theta \\hat{\\boldsymbol{e}}_r - \\sin\\theta \\hat{\\boldsymbol{e}}_\\theta$。因此，圆柱体在其表面的速度径向分量为 $U \\cos\\theta$。边界条件是：\n    $$\n    \\left. \\frac{\\partial \\phi}{\\partial r} \\right|_{r=R} = U \\cos\\theta\n    $$\n2.  **远场条件（$r \\to \\infty$）：** 流体在无穷远处是静止的，因此扰动速度 $\\boldsymbol{u} = \\nabla\\phi$ 必须为零。\n    $$\n    \\nabla\\phi \\to 0 \\quad \\text{as} \\quad r \\to \\infty\n    $$\n\n通过分离变量法得到的拉普拉斯方程在极坐标下的通解是 $r^{\\pm n} \\cos(n\\theta)$ 和 $r^{\\pm n} \\sin(n\\theta)$ 形式项的叠加。鉴于表面边界条件中存在对 $\\cos\\theta$ 的依赖，我们寻求一个形如 $\\phi(r, \\theta) = f(r) \\cos\\theta$ 的解。将此代入拉普拉斯方程，得到关于 $f(r)$ 的柯西-欧拉方程：\n$$\nr^2 f''(r) + r f'(r) - f(r) = 0\n$$\n$f(r)$ 的通解为 $f(r) = A r + B r^{-1}$。因此，势函数为：\n$$\n\\phi(r, \\theta) = \\left(A r + \\frac{B}{r}\\right) \\cos\\theta\n$$\n现在，我们应用边界条件来确定常数 $A$ 和 $B$。\n速度场为 $\\boldsymbol{u} = \\nabla\\phi = \\frac{\\partial\\phi}{\\partial r}\\hat{\\boldsymbol{e}}_r + \\frac{1}{r}\\frac{\\partial\\phi}{\\partial\\theta}\\hat{\\boldsymbol{e}}_\\theta$。\n$$\n\\boldsymbol{u} = \\left(A - \\frac{B}{r^2}\\right) \\cos\\theta \\, \\hat{\\boldsymbol{e}}_r - \\frac{1}{r}\\left(A r + \\frac{B}{r}\\right) \\sin\\theta \\, \\hat{\\boldsymbol{e}}_\\theta\n$$\n为了使速度在 $r \\to \\infty$ 时为零，常数 $A$ 必须为零。否则，将保留一个均匀流分量。所以，$A=0$。\n势函数简化为 $\\phi(r, \\theta) = \\frac{B}{r} \\cos\\theta$。\n\n在 $r=R$ 处应用无穿透条件：\n$$\n\\left. \\frac{\\partial \\phi}{\\partial r} \\right|_{r=R} = \\left. -\\frac{B}{r^2} \\cos\\theta \\right|_{r=R} = -\\frac{B}{R^2} \\cos\\theta\n$$\n我们将其等同于 $U \\cos\\theta$：\n$$\n-\\frac{B}{R^2} \\cos\\theta = U \\cos\\theta \\quad \\implies \\quad B = -U R^2\n$$\n速度势的最终表达式为：\n$$\n\\phi(r, \\theta) = -U \\frac{R^2}{r} \\cos\\theta\n$$\n接下来，我们计算单位长度流体的动能 $KE'$。\n$$\nKE' = \\frac{1}{2} \\rho \\iint_{\\text{fluid domain}} |\\boldsymbol{u}|^2 \\, dA = \\frac{1}{2} \\rho \\int_0^{2\\pi} \\int_R^\\infty |\\nabla\\phi|^2 \\, r \\, dr \\, d\\theta\n$$\n我们求出速度场大小的平方：\n$$\n|\\nabla\\phi|^2 = \\left(\\frac{\\partial\\phi}{\\partial r}\\right)^2 + \\left(\\frac{1}{r}\\frac{\\partial\\phi}{\\partial\\theta}\\right)^2\n$$\n导数为：\n$$\n\\frac{\\partial\\phi}{\\partial r} = U \\frac{R^2}{r^2} \\cos\\theta \\quad \\text{和} \\quad \\frac{1}{r}\\frac{\\partial\\phi}{\\partial\\theta} = \\frac{1}{r} \\left( U \\frac{R^2}{r} \\sin\\theta \\right) = U \\frac{R^2}{r^2} \\sin\\theta\n$$\n它们的平方和是：\n$$\n|\\nabla\\phi|^2 = \\left(U \\frac{R^2}{r^2}\\right)^2 (\\cos^2\\theta + \\sin^2\\theta) = U^2 \\frac{R^4}{r^4}\n$$\n现在，我们将其代入 $KE'$ 的积分中：\n$$\nKE' = \\frac{1}{2} \\rho \\int_0^{2\\pi} \\int_R^\\infty \\left( U^2 \\frac{R^4}{r^4} \\right) r \\, dr \\, d\\theta = \\frac{1}{2} \\rho U^2 R^4 \\int_0^{2\\pi} d\\theta \\int_R^\\infty r^{-3} \\, dr\n$$\n计算积分：\n$$\n\\int_0^{2\\pi} d\\theta = 2\\pi\n$$\n$$\n\\int_R^\\infty r^{-3} \\, dr = \\left[ -\\frac{1}{2r^2} \\right]_R^\\infty = 0 - \\left(-\\frac{1}{2R^2}\\right) = \\frac{1}{2R^2}\n$$\n将这些结果代回 $KE'$ 的表达式中：\n$$\nKE' = \\frac{1}{2} \\rho U^2 R^4 (2\\pi) \\left(\\frac{1}{2R^2}\\right) = \\frac{1}{2} \\rho U^2 (\\pi R^2)\n$$\n根据附加质量的定义，$KE' = \\frac{1}{2} m_a' U^2$。将两个 $KE'$ 的表达式相等：\n$$\n\\frac{1}{2} m_a' U^2 = \\frac{1}{2} \\rho U^2 (\\pi R^2)\n$$\n这给出了单位长度的附加质量：\n$$\nm_a' = \\rho \\pi R^2\n$$\n这个结果恰好是圆柱体单位长度所排开流体的质量。\n\n### 关于维度和流固耦合稳定性的讨论\n\n1.  **维度对比**：对于二维圆柱体，我们得到 $m_a' = \\rho \\pi R^2$。单位长度排开的流体体积为 $V' = \\pi R^2$，因此 $m_a'$ 等于排开流体的质量。对于半径为 $R$ 的三维球体，类似的推导得出的附加质量为 $m_a = \\frac{1}{2} \\rho \\left(\\frac{4}{3}\\pi R^3\\right)$。附加质量是排开流体质量的一半。这种差异的根本原因是流体可以绕开物体的“空间”不同。在二维情况下，流体被限制在一个平面内绕圆柱体运动。在三维情况下，流体可以从所有方向（上、下、侧向）绕球体流动，这构成了较小的阻碍。这种三维运动中减小的阻抗导致了更小的附加质量系数。\n\n2.  **对流固耦合稳定性的启示**：这种差异对分区流固耦合仿真的数值稳定性有重要影响，尤其是在轻质结构系统中。在分区方案中，流体域和固体域是顺序求解的。当结构密度与流体密度相当或更小时，这种方案的稳定性是出了名的差。这被称为“附加质量不稳定性”。稳定性通常与质量比 $m_s' / m_a'$（对于二维情况）有关。如果结构质量 $m_s'$ 远小于附加质量 $m_a'$，那么在一个时间步计算出的流体力可能会产生一个非常大的、非物理的结构加速度，因为显式耦合没有隐式地考虑必须与结构一起加速的流体的惯性阻力。这会导致数值振荡和发散。\n\n    由于二维圆柱体的附加质量系数（1）大于三维球体（0.5），在其他条件相同的情况下，二维情况的稳定性问题更为严重。密度为 $\\rho_s$ 的结构，其单位长度质量为 $m_s' = \\rho_s \\pi R^2$。质量比为 $m_s' / m_a' = (\\rho_s \\pi R^2) / (\\rho \\pi R^2) = \\rho_s / \\rho$。当 $\\rho_s / \\rho \\approx 1$ 或更小时，系统容易出现不稳定性。二维情况下较大的附加质量收紧了稳定性约束，与等效的三维问题相比，需要更小的时间步长或更鲁棒的（例如，隐式）耦合方案。", "answer": "$$\\boxed{\\rho \\pi R^2}$$", "id": "3288867"}, {"introduction": "在理解了附加质量是什么之后，我们接下来将探讨它在数值模拟中带来的具体影响。附加质量效应是导致分区式 FSI 算法（特别是显式格式）出现数值不稳定性的关键原因。本练习通过一个简化的活塞-管道一维模型，让你能够定量地分析附加质量如何直接影响一个典型显式时间积分格式的稳定性极限，从而将抽象的“附加质量不稳定性”问题变得具体和可量化 [@problem_id:3288890]。", "problem": "考虑一个单自由度流固耦合 (FSI) 系统，该系统由一个质量为 $m_{s}$ 的刚性无摩擦活塞组成，活塞在长度为 $L$、横截面积恒为 $A$ 的刚性直管内沿轴向移动。管道中完全充满密度为 $\\rho$ 的不可压缩、无粘性流体。活塞连接到一个刚度为 $k_{s}$ 的线性弹簧上，该弹簧施加一个与活塞位移 $x(t)$ 成正比的恢复力。假设壁面处无泄漏、无滑移，并将流体运动理想化为均匀的柱塞流，使得流体速度场在空间上是均匀的，且等于活塞的速度。\n\n从牛顿第二定律和动能的定义出发，将流体惯性处理为作用在活塞上的附加质量。然后，考虑使用中心差分格式对得到的整体式质量-弹簧系统进行显式时间积分。通过分析离散时间放大因子并施加有界振荡解的条件，推导出此格式的最大稳定时间步长。\n\n你的任务：\n- 使用第一性原理推导附加质量 $m_{a}$。\n- 推导应用于组合的质量-弹簧系统的显式中心差分格式的最大稳定时间步长 $\\Delta t_{\\max}$。\n\n以千克为单位表示附加质量，以秒为单位表示时间步长。以 $m_{s}$、$\\rho$、$A$、$L$ 和 $k_{s}$ 的封闭形式给出最终答案。不需要进行数值计算，也不应进行四舍五入。", "solution": "首先对问题进行验证，以确保其具有科学依据、是适定的且客观的。\n\n**步骤 1：提取已知条件**\n- 系统：单自由度流固耦合（FSI）系统。\n- 组件：质量为 $m_s$ 的刚性无摩擦活塞；长度为 $L$、横截面积恒为 $A$ 的刚性直管；刚度为 $k_s$ 的线性弹簧。\n- 流体：密度为 $\\rho$ 的不可压缩、无粘性流体完全充满管道。\n- 活塞运动：轴向位移 $x(t)$。\n- 力：弹簧恢复力 $F_s = -k_s x(t)$。\n- 流动条件：无泄漏；“将流体运动理想化为均匀的柱塞流，使得流体速度场在空间上是均匀的，且等于活塞的速度。”\n- 数值方法：显式中心差分时间积分格式。\n- 任务 1：推导附加质量 $m_a$。\n- 任务 2：推导中心差分格式的最大稳定时间步长 $\\Delta t_{\\max}$。\n\n**步骤 2：使用提取的已知条件进行验证**\n该问题是一个标准的、尽管简化了的 FSI 模型。\n- **科学依据**：附加质量、牛顿第二定律以及数值格式的稳定性分析是物理学和计算力学中的基本原理。柱塞流模型，尽管是一种简化，但对于一维不可压缩流来说，是一种有效且常见的理想化处理。\n- **适定性**：问题提供了推导所求量（$m_a$, $\\Delta t_{\\max}$）所需的所有必要参数（$m_s$, $\\rho$, $A$, $L$, $k_s$）。它要求根据所提供的模型得出一个唯一的、确定性的结果。\n- **客观性**：问题以精确、定量的术语陈述，没有主观性语言。指令“将流体运动理想化为均匀的柱塞流”解决了可能由其他物理描述引起的任何歧义（例如，“壁面无滑移”是粘性流的特征，但题目指定流体是无粘性的）。\n\n**步骤 3：结论与行动**\n问题被判定为**有效**。将提供一个完整的、有理有据的解答。\n\n**附加质量（$m_a$）的推导**\n\n附加质量 $m_a$ 是一个用于解释被运动结构加速的流体惯性的概念。它的定义使得流体的动能 $T_{fluid}$ 可以用结构的速度来表示。流体的动能由下式给出：\n$$\nT_{fluid} = \\frac{1}{2} \\int_V \\rho |\\vec{v}|^2 dV\n$$\n其中 $V$ 是流体的体积，$\\vec{v}$ 是流体速度场。\n\n题目指出，流体运动是均匀的柱塞流，这意味着在整个流体体积内速度在空间上是均匀的，并且等于活塞的速度 $\\dot{x}(t)$。设运动方向沿 z 轴，因此 $\\vec{v} = \\dot{x}(t) \\hat{k}$。速度的大小为 $|\\vec{v}| = |\\dot{x}(t)|$。\n管内流体的体积为 $V = A L$。\n将这些代入动能积分：\n$$\nT_{fluid} = \\frac{1}{2} \\int_V \\rho (\\dot{x}(t))^2 dV\n$$\n由于 $\\rho$ 和 $\\dot{x}(t)$ 相对于空间积分是常数，我们可以将它们从积分中提出：\n$$\nT_{fluid} = \\frac{1}{2} \\rho (\\dot{x}(t))^2 \\int_V dV = \\frac{1}{2} \\rho (\\dot{x}(t))^2 (AL)\n$$\n重排此表达式：\n$$\nT_{fluid} = \\frac{1}{2} (\\rho A L) (\\dot{x}(t))^2\n$$\n根据定义，附加质量 $m_a$ 是将流体动能与活塞速度的平方关联起来的系数，其形式为：\n$$\nT_{fluid} = \\frac{1}{2} m_a (\\dot{x}(t))^2\n$$\n比较 $T_{fluid}$ 的两个表达式，我们可以直接确定附加质量：\n$$\nm_a = \\rho A L\n$$\n\n**最大稳定时间步长（$\\Delta t_{\\max}$）的推导**\n\n首先，我们建立组合的活塞-流体系统的运动方程。这是一个整体式系统，其总惯性是活塞的结构质量 $m_s$ 和流体的附加质量 $m_a$ 之和。总有效质量为：\n$$\nm_{eff} = m_s + m_a = m_s + \\rho A L\n$$\n作用在系统上的唯一力是来自弹簧的恢复力 $F_s = -k_s x(t)$。根据牛顿第二定律 $F = ma$：\n$$\nm_{eff} \\ddot{x}(t) + k_s x(t) = 0\n$$\n这是无阻尼简谐振子的方程。系统的固有角频率 $\\omega_n$ 为：\n$$\n\\omega_n = \\sqrt{\\frac{k_s}{m_{eff}}} = \\sqrt{\\frac{k_s}{m_s + \\rho A L}}\n$$\n接下来，我们应用显式中心差分格式进行时间积分。在时间步 $n$ 的加速度 $\\ddot{x}_n$ 近似为：\n$$\n\\ddot{x}_n \\approx \\frac{x_{n+1} - 2x_n + x_{n-1}}{(\\Delta t)^2}\n$$\n其中 $x_n = x(t_n)$ 且 $\\Delta t$ 是时间步长。\n将此近似代入运动方程 $m_{eff} \\ddot{x}_n + k_s x_n = 0$：\n$$\nm_{eff} \\left( \\frac{x_{n+1} - 2x_n + x_{n-1}}{(\\Delta t)^2} \\right) + k_s x_n = 0\n$$\n为了找到 $x_{n+1}$ 的更新规则，我们重排该方程：\n$$\nm_{eff} (x_{n+1} - 2x_n + x_{n-1}) = -k_s x_n (\\Delta t)^2\n$$\n$$\nx_{n+1} - 2x_n + x_{n-1} = -\\frac{k_s}{m_{eff}} (\\Delta t)^2 x_n\n$$\n$$\nx_{n+1} = \\left(2 - \\frac{k_s}{m_{eff}} (\\Delta t)^2 \\right) x_n - x_{n-1}\n$$\n代入 $\\omega_n^2 = k_s/m_{eff}$，递推关系变为：\n$$\nx_{n+1} = (2 - (\\omega_n \\Delta t)^2) x_n - x_{n-1}\n$$\n为了进行稳定性分析，我们假设解的形式为 $x_n = \\lambda^n$。将其代入递推关系，得到放大因子 $\\lambda$ 的特征方程：\n$$\n\\lambda^{n+1} = (2 - (\\omega_n \\Delta t)^2) \\lambda^n - \\lambda^{n-1}\n$$\n两边同除以 $\\lambda^{n-1}$（假设 $\\lambda \\neq 0$）：\n$$\n\\lambda^2 - (2 - (\\omega_n \\Delta t)^2) \\lambda + 1 = 0\n$$\n为使解保持有界（即，为使格式稳定），根 $\\lambda$ 的模必须小于或等于 1，即 $|\\lambda| \\le 1$。对于无阻尼系统，能量应该守恒，这对应于模等于 1 的共轭复数对根，即 $|\\lambda| = 1$。这发生在二次特征方程的判别式为非正数时：\n$$\n\\text{Discriminant} = (2 - (\\omega_n \\Delta t)^2)^2 - 4(1)(1) \\le 0\n$$\n$$\n(2 - (\\omega_n \\Delta t)^2)^2 \\le 4\n$$\n对两边取平方根：\n$$\n|2 - (\\omega_n \\Delta t)^2| \\le 2\n$$\n这个不等式等价于：\n$$\n-2 \\le 2 - (\\omega_n \\Delta t)^2 \\le 2\n$$\n不等式的右侧，$2 - (\\omega_n \\Delta t)^2 \\le 2$，简化为 $-(\\omega_n \\Delta t)^2 \\le 0$，对于实数 $\\omega_n$ 和 $\\Delta t$ 总是成立。\n不等式的左侧给出了稳定性极限：\n$$\n-2 \\le 2 - (\\omega_n \\Delta t)^2\n$$\n$$\n(\\omega_n \\Delta t)^2 \\le 4\n$$\n$$\n\\omega_n \\Delta t \\le 2\n$$\n最大稳定时间步长 $\\Delta t_{\\max}$ 对应于等式成立的情况：\n$$\n\\Delta t_{\\max} = \\frac{2}{\\omega_n}\n$$\n代入 $\\omega_n$ 的表达式：\n$$\n\\Delta t_{\\max} = 2 \\sqrt{\\frac{m_{eff}}{k_s}}\n$$\n最后，代入有效质量的表达式 $m_{eff} = m_s + \\rho A L$：\n$$\n\\Delta t_{\\max} = 2 \\sqrt{\\frac{m_s + \\rho A L}{k_s}}\n$$\n这就是最大稳定时间步长的最终表达式。", "answer": "$$\n\\boxed{m_a = \\rho A L, \\quad \\Delta t_{\\max} = 2 \\sqrt{\\frac{m_s + \\rho A L}{k_s}}}\n$$", "id": "3288890"}, {"introduction": "理论推导为我们提供了对附加质量的深刻理解，但在计算流体动力学（CFD）的实际应用中，物理量是在离散网格上计算的。本练习旨在连接理论与实践，要求你为一个加速运动的球体编写程序，不仅要计算其附加质量，更重要的是分析该数值结果的精度如何随网格分辨率的提高而变化。通过这个过程，你将掌握验证计算结果和评估离散误差的关键技能，这是所有计算科学领域的核心实践 [@problem_id:3288878]。", "problem": "考虑一个密度为常数 $\\rho$ 的不可压缩、无粘性流体，它包围着一个半径为 $R$ 的刚性球体。该球体沿 $z$ 轴以规定的平动加速度 $\\dot{U}$（单位：$\\mathrm{m/s^2}$）进行线性加速。流体运动是无旋的，由一个标量速度势 $\\phi(\\mathbf{x},t)$ 控制，该速度势满足拉普拉斯方程和球体上的无穿透边界条件。此流固耦合（FSI）问题在附加质量效应主导耦合的机制下被考虑，并且由加速度引起的压力场决定了作用在球体上的流体动力。\n\n从基本定律和定义出发：\n- 牛顿第二定律：$F = m a$。\n- 不可压缩流的连续性方程：$\\nabla \\cdot \\mathbf{v} = 0$。\n- 无旋流：$\\mathbf{v} = \\nabla \\phi$ 且在球体外部的流体域中 $\\nabla^2 \\phi = 0$。\n- 线性化非定常伯努利方程：$p = -\\rho \\frac{\\partial \\phi}{\\partial t} + C(t)$（取 $C(t)$ 使得远场压力参考为零）。\n\n通过施加球体表面的法向流体速度等于球体速度的法向分量的边界条件，并通过对球体表面上由压力引起的牵引力进行积分以获得沿 $z$ 轴的净流体动力，推导出球体的精确附加质量 $m_a$。解析附加质量 $m_a$ 由关系式 $F_z = - m_a \\, \\dot{U}$ 定义。\n\n然后，在球体表面的经纬度网格上，使用极角 $\\theta \\in [0,\\pi]$ 和方位角 $\\varphi \\in [0,2\\pi)$ 的中点法则来定义一个离散近似值 $m_a(h)$。设 $N_\\theta$ 和 $N_\\varphi$ 分别表示 $\\theta$ 和 $\\varphi$ 的均匀细分数，其中点为 $\\theta_i = \\left(i + \\frac{1}{2}\\right)\\Delta\\theta$ 和 $\\varphi_j = \\left(j + \\frac{1}{2}\\right)\\Delta\\varphi$，这里 $\\Delta\\theta = \\frac{\\pi}{N_\\theta}$ 且 $\\Delta\\varphi = \\frac{2\\pi}{N_\\varphi}$。使用中点法则来近似压力牵引力投影到 $z$ 轴上的面积分，从而定义 $m_a(h)$，使得 $F_z^{\\text{disc}} = - m_a(h) \\, \\dot{U}$。网格参数 $h$ 必须取为 $h = R \\max(\\Delta\\theta, \\Delta\\varphi)$（单位：$\\mathrm{m}$）。\n\n您的程序必须：\n- 计算解析附加质量 $m_a$（单位：$\\mathrm{kg}$）。\n- 对于每个测试用例，在指定的经纬度网格上使用中点法则计算离散附加质量 $m_a(h)$（单位：$\\mathrm{kg}$）。\n- 计算绝对误差 $e(h) = |m_a(h) - m_a|$。\n- 计算连续细化之间的观测收敛率 $p = \\frac{\\ln(e(h_1)/e(h_2))}{\\ln(h_1/h_2)}$。\n- 生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，顺序为：所有测试用例的离散附加质量，然后是连续用例之间的观测收敛率。\n\n物理单位：\n- $R$ 使用 $\\mathrm{m}$，$\\rho$ 使用 $\\mathrm{kg/m^3}$，$\\dot{U}$ 使用 $\\mathrm{m/s^2}$，所有附加质量均以 $\\mathrm{kg}$ 报告。\n- 角度必须以弧度为单位。\n\n测试套件参数：\n- 球体半径：$R = 0.5 \\ \\mathrm{m}$。\n- 流体密度：$\\rho = 1000 \\ \\mathrm{kg/m^3}$。\n- 球体加速度：$\\dot{U} = 1.0 \\ \\mathrm{m/s^2}$。\n- 网格细化 $(N_\\theta, N_\\varphi)$:\n  1. $(2,4)$\n  2. $(4,8)$\n  3. $(8,16)$\n  4. $(16,32)$\n  5. $(32,64)$\n  6. $(8,64)$\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表的结果（例如，$[m_1,m_2,m_3,m_4,m_5,m_6,p_{12},p_{23},p_{34},p_{45},p_{56}]$），其中每个 $m_i$ 是第 $i$ 个测试用例的离散附加质量（单位：$\\mathrm{kg}$），而 $p_{ij}$ 是第 $i$ 个和第 $j$ 个用例之间的观测收敛率。", "solution": "该问题要求推导在理想流体中加速球体的解析附加质量及其离散近似值，然后通过数值计算离散近似值及其收敛性质。\n\n### 步骤 1：问题验证\n\n问题陈述根据指定标准进行解析和验证。\n\n**逐字提取的已知条件：**\n- 流体：不可压缩、无粘性、密度恒为 $\\rho$。\n- 结构：半径为 $R$ 的刚性球体。\n- 运动：沿 $z$ 轴以规定的平动加速度 $\\dot{U}$ 进行线性加速。\n- 流动模型：无旋流，$\\mathbf{v} = \\nabla \\phi$，$\\nabla^2 \\phi = 0$。\n- 边界条件：在球体表面无穿透。\n- 压力方程：线性化非定常伯努利方程，$p = -\\rho \\frac{\\partial \\phi}{\\partial t} + C(t)$，远场压力参考为零。\n- 附加质量定义：$F_z = - m_a \\, \\dot{U}$。\n- 离散化方案：经纬度网格，面积分采用中点法则。\n- 网格参数：极角 $\\theta \\in [0,\\pi]$ 和方位角 $\\varphi \\in [0,2\\pi)$ 的细分数 $N_\\theta, N_\\varphi$；$\\Delta\\theta = \\frac{\\pi}{N_\\theta}$，$\\Delta\\varphi = \\frac{2\\pi}{N_\\varphi}$。\n- 中点：$\\theta_i = \\left(i + \\frac{1}{2}\\right)\\Delta\\theta$，$\\varphi_j = \\left(j + \\frac{1}{2}\\right)\\Delta\\varphi$。\n- 离散附加质量定义：$F_z^{\\text{disc}} = - m_a(h) \\, \\dot{U}$。\n- 网格尺寸参数：$h = R \\max(\\Delta\\theta, \\Delta\\varphi)$。\n- 误差定义：$e(h) = |m_a(h) - m_a|$。\n- 收敛率定义：$p = \\frac{\\ln(e(h_1)/e(h_2))}{\\ln(h_1/h_2)}$。\n- 物理常数：$R = 0.5 \\ \\mathrm{m}$，$\\rho = 1000 \\ \\mathrm{kg/m^3}$，$\\dot{U} = 1.0 \\ \\mathrm{m/s^2}$。\n- 测试用例 $(N_\\theta, N_\\varphi)$: $(2,4)$、$(4,8)$、$(8,16)$、$(16,32)$、$(32,64)$、$(8,64)$。\n\n**验证结论：**\n该问题是**有效的**。这是一个源于经典流体动力学（势流理论）的、定义明确且具有科学依据的问题。所有参数、方程和条件都已提供，构成了一套独立且一致的要求。数值任务定义清晰，并基于标准方法。\n\n### 步骤 2：解析附加质量 ($m_a$) 的推导\n\n流体运动由一个速度势 $\\phi$ 描述，它必须在球体外部的区域（$r > R$）满足拉普拉斯方程 $\\nabla^2 \\phi = 0$。\n\n边界条件是：\n1.  流体在无穷远处是静止的：当 $r \\to \\infty$ 时，$\\nabla \\phi \\to 0$。\n2.  在球体表面（$r=R$），流体速度的法向分量必须与球体速度的法向分量相匹配。球体的速度是 $\\mathbf{U}(t) = U(t)\\hat{\\mathbf{z}}$。球体的向外法向量在球坐标系中是 $\\hat{\\mathbf{n}} = \\hat{\\mathbf{r}}$。\n    $$ \\frac{\\partial \\phi}{\\partial r} \\bigg|_{r=R} = \\mathbf{U}(t) \\cdot \\hat{\\mathbf{r}} = (U(t)\\hat{\\mathbf{z}}) \\cdot \\hat{\\mathbf{r}} $$\n    在球坐标系中，$\\hat{\\mathbf{z}} = \\cos\\theta \\hat{\\mathbf{r}} - \\sin\\theta \\hat{\\mathbf{\\theta}}$，所以 $\\hat{\\mathbf{z}} \\cdot \\hat{\\mathbf{r}} = \\cos\\theta$。因此，表面边界条件变为：\n    $$ \\frac{\\partial \\phi}{\\partial r} \\bigg|_{r=R} = U(t) \\cos\\theta $$\n拉普拉斯方程在无穷远处正则且具有 $\\cos\\theta$ 依赖性（与勒让德多项式 $P_1(\\cos\\theta)$ 成比例）的通解形式为 $\\phi(r, \\theta, t) = A(t) r^{-2} \\cos\\theta$。应用表面边界条件来确定 $A(t)$：\n$$ \\frac{\\partial}{\\partial r} \\left( A(t) r^{-2} \\cos\\theta \\right) \\bigg|_{r=R} = -2 A(t) R^{-3} \\cos\\theta = U(t) \\cos\\theta $$\n这得出 $A(t) = -\\frac{1}{2}U(t)R^3$。因此，速度势为：\n$$ \\phi(r, \\theta, t) = -\\frac{U(t)R^3}{2r^2}\\cos\\theta $$\n压力场由线性化非定常伯努利方程给出，$p = -\\rho \\frac{\\partial \\phi}{\\partial t}$。我们关心的是由加速度 $\\dot{U} = dU/dt$ 引起的力。\n$$ \\frac{\\partial\\phi}{\\partial t} = -\\frac{\\dot{U}(t)R^3}{2r^2}\\cos\\theta $$\n在球体表面（$r=R$），压力为：\n$$ p_S(\\theta,t) = p(R,\\theta,t) = -\\rho \\left(-\\frac{\\dot{U}(t)R^3}{2R^2}\\cos\\theta\\right) = \\frac{1}{2}\\rho \\dot{U} R \\cos\\theta $$\n作用在球体上的流体动力是压力牵引力 $d\\mathbf{F} = -p_S \\hat{\\mathbf{n}} dS = -p_S \\hat{\\mathbf{r}} dS$ 在整个表面 $S$ 上的积分。我们需要其沿 $z$ 轴的分量 $F_z$：\n$$ F_z = \\int_S d\\mathbf{F} \\cdot \\hat{\\mathbf{z}} = \\int_S (-p_S \\hat{\\mathbf{r}}) \\cdot \\hat{\\mathbf{z}} \\, dS = \\int_S -p_S(\\hat{\\mathbf{r}} \\cdot \\hat{\\mathbf{z}}) \\, dS $$\n其中 $\\hat{\\mathbf{r}} \\cdot \\hat{\\mathbf{z}} = \\cos\\theta$，面积元 $dS = R^2 \\sin\\theta \\, d\\theta \\, d\\varphi$：\n$$ F_z = \\int_{0}^{2\\pi} \\int_{0}^{\\pi} -\\left(\\frac{1}{2}\\rho \\dot{U} R \\cos\\theta\\right)(\\cos\\theta)(R^2 \\sin\\theta \\, d\\theta \\, d\\varphi) $$\n$$ F_z = -\\frac{1}{2}\\rho \\dot{U} R^3 \\int_{0}^{2\\pi}d\\varphi \\int_{0}^{\\pi} \\cos^2\\theta \\sin\\theta \\,d\\theta $$\n积分计算结果为 $\\int_{0}^{2\\pi}d\\varphi = 2\\pi$ 和 $\\int_{0}^{\\pi} \\cos^2\\theta \\sin\\theta \\,d\\theta = \\left[-\\frac{\\cos^3\\theta}{3}\\right]_0^\\pi = \\frac{2}{3}$。\n代入这些结果，得到总力：\n$$ F_z = -\\frac{1}{2}\\rho \\dot{U} R^3 (2\\pi) \\left(\\frac{2}{3}\\right) = -\\left(\\frac{2}{3}\\pi\\rho R^3\\right) \\dot{U} $$\n根据定义 $F_z = -m_a \\dot{U}$，解析附加质量为：\n$$ m_a = \\frac{2}{3}\\pi\\rho R^3 $$\n\n### 步骤 3：离散附加质量 ($m_a(h)$) 的推导\n\n离散附加质量是通过在指定的经纬度网格上使用中点法则近似计算 $F_z$ 的积分来推导的。该积分为：\n$$ F_z = \\int_0^{2\\pi} \\int_0^\\pi g(\\theta, \\varphi) \\, d\\theta \\, d\\varphi, \\quad \\text{其中} \\quad g(\\theta, \\varphi) = -\\frac{1}{2}\\rho \\dot{U} R^3 \\cos^2\\theta \\sin\\theta $$\n中点法则将此积分近似为一个和：\n$$ F_z^{\\text{disc}} = \\sum_{j=0}^{N_\\varphi-1} \\sum_{i=0}^{N_\\theta-1} g(\\theta_i, \\varphi_j) \\Delta\\theta \\Delta\\varphi $$\n其中 $\\theta_i = (i+1/2)\\Delta\\theta$ 且 $\\varphi_j = (j+1/2)\\Delta\\varphi$。由于 $g(\\theta, \\varphi)$ 与 $\\varphi$ 无关，对 $j$ 的求和简化为：\n$$ \\sum_{j=0}^{N_\\varphi-1} g(\\theta_i, \\varphi_j) = N_\\varphi \\, g(\\theta_i) $$\n将此代入 $F_z^{\\text{disc}}$ 的和式中：\n$$ F_z^{\\text{disc}} = \\Delta\\theta \\Delta\\varphi N_\\varphi \\sum_{i=0}^{N_\\theta-1} \\left(-\\frac{1}{2}\\rho \\dot{U} R^3 \\cos^2\\theta_i \\sin\\theta_i\\right) $$\n使用 $\\Delta\\varphi = 2\\pi/N_\\varphi$，项 $\\Delta\\varphi N_\\varphi$ 变为 $2\\pi$。\n$$ F_z^{\\text{disc}} = \\Delta\\theta (2\\pi) \\left(-\\frac{1}{2}\\rho \\dot{U} R^3\\right) \\sum_{i=0}^{N_\\theta-1} \\cos^2\\theta_i \\sin\\theta_i $$\n$$ F_z^{\\text{disc}} = - \\left( \\pi\\rho R^3 \\Delta\\theta \\sum_{i=0}^{N_\\theta-1} \\cos^2\\theta_i \\sin\\theta_i \\right) \\dot{U} $$\n根据定义 $F_z^{\\text{disc}} = -m_a(h)\\dot{U}$，离散附加质量为：\n$$ m_a(h) = \\pi\\rho R^3 \\Delta\\theta \\sum_{i=0}^{N_\\theta-1} \\cos^2\\left(\\left(i+\\frac{1}{2}\\right)\\Delta\\theta\\right) \\sin\\left(\\left(i+\\frac{1}{2}\\right)\\Delta\\theta\\right) $$\n其中 $\\Delta\\theta = \\pi/N_\\theta$。请注意，$m_a(h)$ 仅取决于 $N_\\theta$，而不取决于 $N_\\varphi$。\n\n### 步骤 4：数值计算与收敛性分析\n\n提供的测试用例用于计算不同网格分辨率下的 $m_a(h)$。\n- 使用 $R = 0.5 \\ \\mathrm{m}$ 和 $\\rho = 1000 \\ \\mathrm{kg/m^3}$ 计算解析附加质量 $m_a$：\n  $m_a = \\frac{2}{3}\\pi (1000) (0.5)^3 = \\frac{250}{3}\\pi \\approx 261.79938779 \\ \\mathrm{kg}$。\n- 对每个测试用例 $(N_\\theta, N_\\varphi)$，使用步骤 3 中推导的公式计算离散附加质量 $m_a(h)$。\n- 对每个用例确定网格尺寸 $h = R \\max(\\pi/N_\\theta, 2\\pi/N_\\varphi)$。\n- 计算绝对误差 $e(h) = |m_a(h) - m_a|$。\n- 计算连续细化 $(h_1, e_1)$ 和 $(h_2, e_2)$ 之间的观测收敛率 $p$，公式为 $p = \\ln(e_1/e_2) / \\ln(h_1/h_2)$。对于中点法则，理论误差与 $h^2$ 成正比，因此预期收敛率为 $p=2$。\n\n下面的 Python 程序实现了这些计算，为所有测试用例计算所需的量，并按指定格式输出结果。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the analytic and discrete added mass of a sphere,\n    and analyzes the convergence of the discrete approximation.\n    \"\"\"\n\n    # Physical parameters\n    R = 0.5  # Sphere radius in meters\n    rho = 1000.0  # Fluid density in kg/m^3\n\n    # Test suite parameters: list of (N_theta, N_phi) tuples\n    test_cases = [\n        (2, 4),\n        (4, 8),\n        (8, 16),\n        (16, 32),\n        (32, 64),\n        (8, 64),\n    ]\n\n    # --- Analytic Solution ---\n    # The analytic added mass for a sphere is m_a = (2/3) * pi * rho * R^3.\n    # This is half the mass of the displaced fluid.\n    m_a_analytic = (2.0 / 3.0) * np.pi * rho * R**3\n\n    # --- Numerical Computation ---\n    discrete_masses = []\n    mesh_sizes = []\n\n    for N_theta, N_phi in test_cases:\n        # Calculate mesh spacings\n        delta_theta = np.pi / N_theta\n        \n        # The discrete added mass formula derived from the midpoint rule\n        # only depends on the integration over theta.\n        # m_a(h) = pi * rho * R^3 * sum_{i=0}^{N_theta-1} cos^2(theta_i)sin(theta_i) * delta_theta\n        \n        # Create an array of theta midpoint values\n        i = np.arange(N_theta)\n        theta_mid = (i + 0.5) * delta_theta\n        \n        # Calculate the sum part of the formula\n        integrand_values = (np.cos(theta_mid)**2) * np.sin(theta_mid)\n        integral_approx = np.sum(integrand_values) * delta_theta\n        \n        # Calculate the discrete added mass\n        m_a_h = np.pi * rho * R**3 * integral_approx\n        discrete_masses.append(m_a_h)\n        \n        # Calculate the mesh parameter h\n        delta_phi = 2.0 * np.pi / N_phi\n        h = R * max(delta_theta, delta_phi)\n        mesh_sizes.append(h)\n\n    # --- Error and Convergence Analysis ---\n    errors = np.abs(np.array(discrete_masses) - m_a_analytic)\n    \n    rates = []\n    # Calculate observed convergence rate between successive cases\n    for i in range(len(test_cases) - 1):\n        h1 = mesh_sizes[i]\n        h2 = mesh_sizes[i+1]\n        e1 = errors[i]\n        e2 = errors[i+1]\n        \n        # The rate p is defined as p = log(e1/e2) / log(h1/h2)\n        # Add a small epsilon to the denominator to avoid division by zero\n        # if h1 and h2 happen to be identical (though not in these test cases).\n        rate = np.log(e1 / e2) / np.log(h1 / h2 + 1e-18)\n        rates.append(rate)\n\n    # --- Format and Print Output ---\n    # Combine results into a single list\n    all_results = discrete_masses + rates\n    \n    # Format the list into the required string format\n    output_str = f\"[{','.join(f'{x:.8f}' for x in all_results)}]\"\n    \n    print(output_str)\n\nsolve()\n```", "id": "3288878"}]}