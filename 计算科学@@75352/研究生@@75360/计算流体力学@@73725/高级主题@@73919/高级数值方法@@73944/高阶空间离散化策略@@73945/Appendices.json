{"hands_on_practices": [{"introduction": "在应用高阶数值格式之前，理解其如何从基本原理推导而来是至关重要的。本练习 ([@problem_id:3328996]) 提供了一个构建任意偶数阶中心差分格式的通用方法，通过泰勒级数分析揭示了格式系数与其精度阶数之间的深刻联系。掌握这种推导能力是设计和分析新数值格式的基石。", "problem": "考虑一个在均匀网格 $x_i = x_0 + i h$（间距 $h > 0$）上采样得到的光滑标量场 $f(x)$。在计算流体动力学（CFD）的背景下，高阶中心有限差分被用来高精度地近似空间导数。构建一个用于计算 $x_0$ 处一阶导数的中心有限差分格式，该格式使用对称模板 $\\{x_0 \\pm j h\\}_{j=1}^{m}$ 并达到 $2m$ 阶的形式精度，即它对所有次数最高为 $2m$ 的单项式 $x^p$ 都是精确的。具体来说，用以下公式近似 $f^{\\prime}(x_0)$：\n$$\n\\frac{1}{h} \\sum_{j=1}^{m} a_j \\big(f(x_0 + j h) - f(x_0 - j h)\\big),\n$$\n其中未知系数 $a_j$ 仅依赖于 $m$。\n\n从适用于高阶空间离散化的第一性原理出发，包括泰勒级数展开和均匀网格上的多项式插值，完成以下任务：\n\n- 通过强制对最高次数为 $2m$ 的单项式精确，推导出系数 $a_j$（$j = 1, \\dots, m$）的闭式表达式。\n- 使用相同的基础工具，计算此近似的主截断误差项，其形式为\n$$\nE_{2m+1}(x_0; h) \\,=\\, C_m \\, h^{2m} \\, f^{(2m+1)}(x_0) \\,+\\, \\mathcal{O}\\!\\left(h^{2m+2}\\right),\n$$\n并获得仅依赖于 $m$ 的常数 $C_m$ 的闭式表达式。\n\n答案要求：\n- 你最终的方框答案必须只包含 $C_m$ 的解析表达式。不要包含单位。\n- 不需要数值近似或四舍五入。", "solution": "用户希望找到一个高阶中心有限差分格式的系数和主截断误差。\n\n### 问题验证\n问题陈述是数值分析中的一个标准练习，特别是在推导有限差分公式方面。\n- **给定条件**：一个光滑标量场 $f(x)$，一个均匀网格 $x_i = x_0 + ih$，以及一个形式为 $D_h[f](x_0) = \\frac{1}{h} \\sum_{j=1}^{m} a_j \\big(f(x_0 + j h) - f(x_0 - j h)\\big)$ 的一阶导数 $f'(x_0)$ 的有限差分近似。该格式被要求具有 $2m$ 阶的形式精度。我们需要找到系数 $a_j$ 和主截断误差常数 $C_m$。\n- **验证**：该问题在科学上基于导数的数值近似理论。它提法得当、客观，并且不包含内部矛盾或缺失信息。推导系数和误差常数的要求是标准的。该问题是有效的。\n\n### 方程组和误差项的推导\n我们首先用围绕点 $x_0$ 的泰勒级数展开式来表示有限差分算子。$f(x_0 + \\delta)$ 的泰勒级数由下式给出：\n$$f(x_0 + \\delta) = \\sum_{k=0}^{\\infty} \\frac{f^{(k)}(x_0)}{k!} \\delta^k$$\n让我们考虑项 $f(x_0 + jh) - f(x_0 - jh)$：\n$$f(x_0 + jh) - f(x_0 - jh) = \\sum_{k=0}^{\\infty} \\frac{f^{(k)}(x_0)}{k!} (jh)^k - \\sum_{k=0}^{\\infty} \\frac{f^{(k)}(x_0)}{k!} (-jh)^k$$\n$$= \\sum_{k=0}^{\\infty} \\frac{f^{(k)}(x_0)}{k!} (jh)^k (1 - (-1)^k)$$\n当 $k$ 为奇数时，项 $(1 - (-1)^k)$ 为 $2$，当 $k$ 为偶数时为 $0$。令 $k = 2l+1$。\n$$f(x_0 + jh) - f(x_0 - jh) = \\sum_{l=0}^{\\infty} \\frac{f^{(2l+1)}(x_0)}{(2l+1)!} (jh)^{2l+1} \\cdot 2$$\n将此代入 $f'(x_0)$ 的近似式中：\n$$D_h[f](x_0) = \\frac{1}{h} \\sum_{j=1}^{m} a_j \\left( 2 \\sum_{l=0}^{\\infty} \\frac{f^{(2l+1)}(x_0)}{(2l+1)!} (jh)^{2l+1} \\right)$$\n通过重新排列求和顺序，我们得到：\n$$D_h[f](x_0) = \\sum_{l=0}^{\\infty} \\frac{2 h^{2l} f^{(2l+1)}(x_0)}{(2l+1)!} \\left( \\sum_{j=1}^{m} a_j j^{2l+1} \\right)$$\n为了使该格式以 $2m$ 阶精度近似 $f'(x_0)$，$D_h[f](x_0)$ 的展开式必须与 $f'(x_0)$ 的泰勒级数（即 $f'(x_0)$ 本身）匹配到 $h^{2m-1}$ 阶的项。\n$l=0$ 的项必须等于 $f'(x_0)$：\n$$\\frac{2 h^0 f^{(1)}(x_0)}{1!} \\left( \\sum_{j=1}^{m} a_j j^1 \\right) = f'(x_0) \\implies 2 f'(x_0) \\sum_{j=1}^{m} a_j j = f'(x_0)$$\n这给出了关于系数 $a_j$ 的第一个条件：\n$$\\sum_{j=1}^{m} a_j j = \\frac{1}{2}$$\n为了使格式达到 $2m$ 阶精度，对于 $l=1, 2, \\dots, m-1$，$h^{2l}f^{(2l+1)}(x_0)$ 的系数必须为零。这导致了以下方程组：\n$$\\sum_{j=1}^{m} a_j j^{2l+1} = 0 \\quad \\text{for } l = 1, 2, \\dots, m-1$$\n这给出了一个包含 $m$ 个未知系数 $a_j$ 的 $m$ 个线性方程组。\n\n主截断误差项是级数中在 $l=0$ 之后的第一个非零项，对应于 $l=m$：\n$$E_{2m+1}(x_0; h) = D_h[f](x_0) - f'(x_0) = \\frac{2 h^{2m} f^{(2m+1)}(x_0)}{(2m+1)!} \\left( \\sum_{j=1}^{m} a_j j^{2m+1} \\right) + \\mathcal{O}(h^{2m+2})$$\n通过将其与给定的误差形式 $E_{2m+1}(x_0; h) = C_m h^{2m} f^{(2m+1)}(x_0) + \\mathcal{O}(h^{2m+2})$ 进行比较，我们确定误差常数 $C_m$ 为：\n$$C_m = \\frac{2}{(2m+1)!} \\sum_{j=1}^{m} a_j j^{2m+1}$$\n\n### 系数 $a_j$ 的推导\n为了求解 $a_j$，我们定义 $b_j = j a_j$ 和 $x_j = j^2$。该方程组可以写成：\n$$\\sum_{j=1}^{m} b_j (j^2)^l = \\frac{1}{2} \\delta_{l,0} \\quad \\text{for } l=0, 1, \\dots, m-1$$\n这是一个范德蒙类型的系统。我们可以使用多项式插值逻辑来求解 $b_j$。\n考虑一个多项式 $Q_k(x) = \\prod_{i=1, i\\neq k}^m (x-x_i) = \\prod_{i=1, i\\neq k}^m (x-i^2)$。对于 $j=1, \\dots, m$，$Q_k(x_j)$ 为零，除非 $j=k$。\n$$\\sum_{j=1}^m b_j Q_k(x_j) = b_k Q_k(x_k) = b_k \\prod_{i=1, i\\neq k}^m (k^2-i^2)$$\n另外，通过展开 $Q_k(x) = \\sum_{l=0}^{m-1} q_{k,l} x^l$：\n$$\\sum_{j=1}^m b_j Q_k(x_j) = \\sum_{j=1}^m b_j \\sum_{l=0}^{m-1} q_{k,l} x_j^l = \\sum_{l=0}^{m-1} q_{k,l} \\left( \\sum_{j=1}^m b_j x_j^l \\right) = \\sum_{l=0}^{m-1} q_{k,l} \\left( \\frac{1}{2}\\delta_{l,0} \\right) = \\frac{1}{2}q_{k,0}$$\n常数项是 $q_{k,0} = Q_k(0) = \\prod_{i=1, i\\neq k}^m (-i^2) = (-1)^{m-1} \\frac{(m!)^2}{k^2}$。\n令两个表达式相等，得到：\n$$b_k \\prod_{i=1, i\\neq k}^m (k^2-i^2) = \\frac{1}{2} (-1)^{m-1} \\frac{(m!)^2}{k^2}$$\n左边的乘积项是 $\\prod_{i=1, i\\neq k}^m (k^2-i^2) = \\prod_{i=1, i\\neq k}^m (k-i)(k+i) = \\left( \\prod_{i=1, i\\neq k}^m (k-i) \\right) \\left( \\prod_{i=1, i\\neq k}^m (k+i) \\right)$。\n$\\prod_{i=1, i\\neq k}^m (k-i) = (k-1)! (-1)^{m-k} (m-k)!$。\n$\\prod_{i=1, i\\neq k}^m (k+i) = \\frac{\\prod_{i=1}^m (k+i)}{2k} = \\frac{(m+k)! / k!}{2k}$。\n所以，$b_k (k-1)! (-1)^{m-k} (m-k)! \\frac{(m+k)!}{2k \\cdot k!} = \\frac{1}{2} (-1)^{m-1} \\frac{(m!)^2}{k^2}$。\n$b_k (-1)^{m-k} (m-k)! \\frac{(m+k)!}{2k^2} = \\frac{1}{2} (-1)^{m-1} \\frac{(m!)^2}{k^2}$。\n$b_k = \\frac{(-1)^{m-1}}{(-1)^{m-k}} \\frac{(m!)^2}{(m-k)!(m+k)!} = (-1)^{k-1} \\frac{(m!)^2}{(m-k)!(m+k)!}$。\n因为 $a_j = b_j/j$，我们得到系数的闭式表达式：\n$$a_j = \\frac{(-1)^{j-1}}{j} \\frac{(m!)^2}{(m-j)!(m+j)!}$$\n\n### 误差常数 $C_m$ 的推导\n为了找到 $C_m$，我们需要计算和 $S = \\sum_{j=1}^{m} a_j j^{2m+1}$。\n使用 $b_j = j a_j$ 和 $x_j=j^2$，这个和是 $S = \\sum_{j=1}^{m} b_j (j^2)^m = \\sum_{j=1}^{m} b_j x_j^m$。\n让我们定义一个 $m$ 次的首一多项式 $P(x)$，其根为 $x_j=j^2$（$j=1, \\dots, m$）：\n$$P(x) = \\prod_{j=1}^{m} (x-x_j) = \\prod_{j=1}^{m} (x-j^2) = x^m + c_{m-1}x^{m-1} + \\dots + c_1 x + c_0$$\n根据构造，$P(x_j)=0$ 对所有 $j=1, \\dots, m$ 成立。考虑和 $\\sum_{j=1}^m b_j P(x_j)$，其值为零。\n$$0 = \\sum_{j=1}^{m} b_j P(x_j) = \\sum_{j=1}^{m} b_j \\left(x_j^m + \\sum_{l=0}^{m-1} c_l x_j^l\\right)$$\n$$0 = \\sum_{j=1}^{m} b_j x_j^m + \\sum_{l=0}^{m-1} c_l \\left(\\sum_{j=1}^{m} b_j x_j^l\\right)$$\n第一项是我们想要求的和 $S$。第二项利用 $b_j$ 的条件可以简化：\n$$\\sum_{l=0}^{m-1} c_l \\left(\\frac{1}{2}\\delta_{l,0}\\right) = \\frac{1}{2}c_0$$\n所以，我们有关系式 $0 = S + \\frac{1}{2}c_0$，这意味着 $S = -\\frac{1}{2}c_0$。\n常数 $c_0$ 是多项式 $P(x)$ 在 $x=0$ 处的值：\n$$c_0 = P(0) = \\prod_{j=1}^{m} (0-j^2) = \\prod_{j=1}^{m} (-j^2) = (-1)^m \\prod_{j=1}^{m} j^2 = (-1)^m (m!)^2$$\n因此，和为：\n$$S = \\sum_{j=1}^{m} a_j j^{2m+1} = -\\frac{1}{2} (-1)^m (m!)^2$$\n最后，我们将这个和代回到 $C_m$ 的表达式中：\n$$C_m = \\frac{2}{(2m+1)!} S = \\frac{2}{(2m+1)!} \\left(-\\frac{1}{2} (-1)^m (m!)^2\\right)$$\n$$C_m = -\\frac{(-1)^m (m!)^2}{(2m+1)!} = \\frac{(-1)^{m+1} (m!)^2}{(2m+1)!}$$", "answer": "$$\\boxed{\\frac{(-1)^{m+1} (m!)^2}{(2m+1)!}}$$", "id": "3328996"}, {"introduction": "构建一个高阶格式只是第一步，理解其在求解偏微分方程时的行为也同样重要。本练习 ([@problem_id:3329059]) 通过分析一个特定的四阶中心差分格式，揭示其截断误差如何表现为数值色散。理解色散与耗散等误差特性，对于在计算流体力学中为具体问题选择合适的数值格式至关重要。", "problem": "考虑一维 (1D) 线性平流偏微分方程 (PDE)，形式为 $u_{t} + a\\,u_{x} = 0$，其中平流速度 $a$ 为常数，解 $u(x,t)$ 足够光滑，该方程在间距为 $h$ 的均匀网格 $x_{i} = x_{0} + i h$ 上进行离散。在计算流体动力学 (CFD) 中，一种针对一阶导数 $u_{x}$ 的常见高阶空间离散格式是在网格点 $x_{i}$ 处定义的四阶中心差分算子：\n$$D^{(1)}_{4} u_{i} = \\frac{-u_{i+2} + 8\\,u_{i+1} - 8\\,u_{i-1} + u_{i-2}}{12\\,h}。$$\n从该偏微分方程和局部截断误差 (LTE) 的定义（即，将精确解代入半离散格式后得到的残差）出发，推导半离散格式 $u_{t} + a\\,D^{(1)}_{4} u = 0$ 的 LTE 的主阶表达式，并用 $u$ 在 $x_{i}$ 处的空间导数来表示。然后，使用一种基于修正方程或傅里叶符号分析的原则性方法来表征数值色散和耗散，识别并表示出与此空间离散相关的主色散误差项和主耗散误差项。你的最终答案应按以下顺序报告三项内容：截至 $h^{4}$ 阶的 LTE、主色散误差项和主耗散误差项，每一项都应是一个包含 $a$、$h$ 和 $u$ 对 $x$ 的导数的封闭形式解析表达式。不需要进行数值舍入，最终表达式中不应包含物理单位。", "solution": "该问题已经过验证并被确定为有效。这是一个在计算流体动力学领域内适定的、有科学依据的问题，要求对一个数值格式进行标准分析。\n\n按照问题陈述的要求，分析分三部分进行：首先，推导局部截断误差 (LTE)；其次，推导主色散误差项；第三，识别主耗散误差项。\n\n1.  **局部截断误差 (LTE)**\n\n半离散格式由 $\\frac{\\partial u}{\\partial t} + a\\,D^{(1)}_{4} u = 0$ 给出。在网格点 $x_i$ 处的局部截断误差 $\\tau_i$ 是将连续偏微分方程 $u_t + a\\,u_x = 0$ 的精确解 $u(x,t)$ 代入半离散格式后得到的残差。\n$$ \\tau_i = \\left(\\frac{\\partial u}{\\partial t}\\right)_i + a\\,D^{(1)}_{4} u_i $$\n对于精确解 $u(x,t)$，我们有 $\\left(\\frac{\\partial u}{\\partial t}\\right)_i = -a\\,\\left(\\frac{\\partial u}{\\partial x}\\right)_i$。将此代入 LTE 的表达式，得到：\n$$ \\tau_i = -a\\,\\left(\\frac{\\partial u}{\\partial x}\\right)_i + a\\,D^{(1)}_{4} u_i = a \\left( D^{(1)}_{4} u_i - \\left(\\frac{\\partial u}{\\partial x}\\right)_i \\right) $$\n因此，半离散格式的 LTE 是平流速度 $a$ 乘以空间有限差分算子 $D^{(1)}_{4}$ 的截断误差。为求此截断误差，我们对点 $x_i$ 附近的项 $u_{i \\pm 1}$ 和 $u_{i \\pm 2}$ 进行泰勒级数展开。由于我们预期这是一个四阶格式，因此展开到包含五阶导数的项。令 $u^{(n)} \\equiv \\frac{\\partial^n u}{\\partial x^n}\\big|_{x_i}$。\n$$ u_{i+k} = u(x_i+kh) = u_i + (kh)u^{(1)} + \\frac{(kh)^2}{2!}u^{(2)} + \\frac{(kh)^3}{3!}u^{(3)} + \\frac{(kh)^4}{4!}u^{(4)} + \\frac{(kh)^5}{5!}u^{(5)} + O(h^6) $$\n我们展开四个必要的项：\n$$ u_{i+1} = u_i + h u^{(1)} + \\frac{h^2}{2} u^{(2)} + \\frac{h^3}{6} u^{(3)} + \\frac{h^4}{24} u^{(4)} + \\frac{h^5}{120} u^{(5)} + O(h^6) $$\n$$ u_{i-1} = u_i - h u^{(1)} + \\frac{h^2}{2} u^{(2)} - \\frac{h^3}{6} u^{(3)} + \\frac{h^4}{24} u^{(4)} - \\frac{h^5}{120} u^{(5)} + O(h^6) $$\n$$ u_{i+2} = u_i + 2h u^{(1)} + \\frac{4h^2}{2} u^{(2)} + \\frac{8h^3}{6} u^{(3)} + \\frac{16h^4}{24} u^{(4)} + \\frac{32h^5}{120} u^{(5)} + O(h^6) $$\n$$ u_{i-2} = u_i - 2h u^{(1)} + \\frac{4h^2}{2} u^{(2)} - \\frac{8h^3}{6} u^{(3)} + \\frac{16h^4}{24} u^{(4)} - \\frac{32h^5}{120} u^{(5)} + O(h^6) $$\n现在，我们将这些展开式代入算子 $D^{(1)}_{4} u_{i}$ 的定义中：\n$$ D^{(1)}_{4} u_{i} = \\frac{-u_{i+2} + 8\\,u_{i+1} - 8\\,u_{i-1} + u_{i-2}}{12\\,h} $$\n我们按 $u$ 的导数阶数对分子中的项进行分组：\n-   $u^{(0)}$ 项：$(-1 + 8 - 8 + 1)u_i = 0$。\n-   $u^{(1)}$ 项：$(-2h + 8(h) - 8(-h) + (-2h))u^{(1)} = ( -2 + 8 + 8 - 2 )h u^{(1)} = 12h u^{(1)}$。\n-   $u^{(2)}$ 项：$(-\\frac{4h^2}{2} + 8\\frac{h^2}{2} - 8\\frac{h^2}{2} + \\frac{4h^2}{2})u^{(2)} = ( -2 + 4 - 4 + 2 )h^2 u^{(2)} = 0$。\n-   $u^{(3)}$ 项：$(-\\frac{8h^3}{6} + 8\\frac{h^3}{6} - 8(-\\frac{h^3}{6}) - \\frac{8h^3}{6})u^{(3)} = ( -8 + 8 + 8 - 8 )\\frac{h^3}{6} u^{(3)} = 0$。\n-   $u^{(4)}$ 项：$(-\\frac{16h^4}{24} + 8\\frac{h^4}{24} - 8\\frac{h^4}{24} + \\frac{16h^4}{24})u^{(4)} = ( -16 + 8 - 8 + 16 )\\frac{h^4}{24} u^{(4)} = 0$。\n-   $u^{(5)}$ 项：$(-\\frac{32h^5}{120} + 8\\frac{h^5}{120} - 8(-\\frac{h^5}{120}) - \\frac{32h^5}{120})u^{(5)} = ( -32 + 8 + 8 - 32 )\\frac{h^5}{120} u^{(5)} = -48 \\frac{h^5}{120} u^{(5)} = -\\frac{2}{5} h^5 u^{(5)}$。\n\n将这些结果代回 $D^{(1)}_{4} u_{i}$ 的表达式中：\n$$ D^{(1)}_{4} u_{i} = \\frac{1}{12h} \\left( 12h u^{(1)} - \\frac{2}{5} h^5 u^{(5)} + O(h^7) \\right) = u^{(1)} - \\frac{2}{5 \\cdot 12} h^4 u^{(5)} + O(h^6) $$\n$$ D^{(1)}_{4} u_{i} = \\frac{\\partial u}{\\partial x} - \\frac{1}{30} h^4 \\frac{\\partial^5 u}{\\partial x^5} + O(h^6) $$\n空间算子的截断误差是差值 $D^{(1)}_{4} u_{i} - (\\frac{\\partial u}{\\partial x})_i$，即 $-\\frac{1}{30} h^4 \\frac{\\partial^5 u}{\\partial x^5} + O(h^6)$。\n因此，半离散格式的 LTE 是：\n$$ \\tau_i = a \\left( -\\frac{1}{30} h^4 \\frac{\\partial^5 u}{\\partial x^5} + O(h^6) \\right) = -\\frac{a h^4}{30} \\frac{\\partial^5 u}{\\partial x^5} + O(h^6) $$\nLTE 的主阶项是 $-\\frac{a h^4}{30} \\frac{\\partial^5 u}{\\partial x^5}$。\n\n2.  **色散和耗散误差项**\n\n为识别色散和耗散误差项，我们推导修正方程。修正方程是一个偏微分方程，数值格式对其的求解比对原始偏微分方程更精确。它是通过将离散算子的泰勒展开式代入数值格式得到的。\n$$ \\frac{\\partial u}{\\partial t} + a D^{(1)}_{4} u = 0 \\implies \\frac{\\partial u}{\\partial t} + a \\left( \\frac{\\partial u}{\\partial x} - \\frac{1}{30} h^4 \\frac{\\partial^5 u}{\\partial x^5} + O(h^6) \\right) = 0 $$\n重新整理此方程，使其左侧与原始偏微分方程的形式相匹配，得到：\n$$ \\frac{\\partial u}{\\partial t} + a \\frac{\\partial u}{\\partial x} = \\frac{a h^4}{30} \\frac{\\partial^5 u}{\\partial x^5} + O(h^6) $$\n右侧的项代表数值格式的误差。具有奇数阶空间导数的误差项是色散性的，而具有偶数阶空间导数的误差项是耗散性（或反耗散性）的。\n\n主误差项是 $\\frac{a h^4}{30} \\frac{\\partial^5 u}{\\partial x^5}$。由于空间导数的阶数是 5（一个奇数），这是一个**色散误差项**。\n\n为找到主耗散误差项，我们在误差展开式中寻找最低阶的偶数阶导数项。算子 $D^{(1)}_{4}$ 是一个对称中心差分模板。此类用于近似一阶导数的模板的一个性质是，其泰勒级数展开中的所有偶数阶导数项都会抵消。如我们的推导所示，$u^{(2)}$ 和 $u^{(4)}$ 的系数为零。这种模式对所有更高阶的偶数阶导数（$u^{(6)}, u^{(8)}, \\ldots$）都成立。因此，$D^{(1)}_{4}$ 的截断误差只包含奇数阶导数项：\n$$ D^{(1)}_{4} u - u_x = C_5 h^4 u^{(5)} + C_7 h^6 u^{(7)} + C_9 h^8 u^{(9)} + \\dots $$\n因此，修正方程的右侧将只包含奇数阶空间导数。不存在偶数阶导数项。因为耗散误差与偶数阶导数相关，所以该格式没有固有的数值耗散。\n\n因此，主色散误差项是 $\\frac{a h^4}{30} \\frac{\\partial^5 u}{\\partial x^5}$，而主耗散误差项是 $0$。\n\n所要求的三个表达式是：\n1.  LTE：$-\\frac{a h^4}{30} \\frac{\\partial^5 u}{\\partial x^5}$\n2.  主色散误差项：$\\frac{a h^4}{30} \\frac{\\partial^5 u}{\\partial x^5}$\n3.  主耗散误差项：$0$", "answer": "$$ \\boxed{ \\begin{pmatrix} -\\frac{a h^4}{30} \\frac{\\partial^5 u}{\\partial x^5} & \\frac{a h^4}{30} \\frac{\\partial^5 u}{\\partial x^5} & 0 \\end{pmatrix} } $$", "id": "3329059"}, {"introduction": "高阶精度并非只能通过有限差分法实现；有限体积法 (FVM) 提供了另一条重要的途径。本练习 ([@problem_id:3328997]) 引导您探索这种方法，您将从已知的单元平均值出发，推导一个用于单元内部的三阶多项式分布。这种重构技术是构建高阶 Godunov 型格式的核心，对于精确计算通量和捕捉流动中的不连续性至关重要。", "problem": "考虑一个由一维守恒律控制的光滑标量守恒量 $u(x)$，并使用有限体积法 (FVM) 进行离散。设计算域被划分为一个均匀网格，网格间距为 $\\Delta x$，网格中心为 $x_i$，网格界面为 $x_{i\\pm \\frac{1}{2}} = x_i \\pm \\frac{\\Delta x}{2}$。网格 $i$ 内的网格平均值定义为 $$\\bar{u}_i = \\frac{1}{\\Delta x} \\int_{x_{i-\\frac{1}{2}}}^{x_{i+\\frac{1}{2}}} u(x) \\, dx$$ 假设 $u(x)$ 足够光滑，以至于多项式重构是合适的，并忽略任何非线性限制器。\n\n你的任务是为目标网格 $i$ 推导一个三阶精度的空间重构，方法是拟合一个形式为 $p_i(x) = a_i + b_i (x - x_i) + c_i (x - x_i)^2$ 的二次多项式 $p_i(x)$，使得 $p_i(x)$ 在网格 $i-1$、$i$ 和 $i+1$ 上的网格平均值与给定的值 $\\bar{u}_{i-1}$、$\\bar{u}_i$ 和 $\\bar{u}_{i+1}$ 相匹配。从网格平均值的定义和基本积分恒等式出发，推导系数 $a_i$、$b_i$ 和 $c_i$ 关于 $\\bar{u}_{i-1}$、$\\bar{u}_i$、$\\bar{u}_{i+1}$ 和 $\\Delta x$ 的表达式，然后计算左右界面值 $p_i^{-} = p_i(x_{i-\\frac{1}{2}})$ 和 $p_i^{+} = p_i(x_{i+\\frac{1}{2}})$。\n\n将数对 $\\left(p_i^{-},\\, p_i^{+}\\right)$ 的最终答案表示为关于 $\\bar{u}_{i-1}$、$\\bar{u}_i$、$\\bar{u}_{i+1}$ 和 $\\Delta x$ 的闭式代数表达式。不需要进行舍入。", "solution": "该问题是有效的。这是守恒律数值方法领域中的一个标准的、适定的问题，具体涉及有限体积法 (FVM) 的高阶空间重构。\n\n设网格 $i$ 的二次重构多项式由下式给出\n$$p_i(x) = a_i + b_i (x - x_i) + c_i (x - x_i)^2$$\n其中 $x_i$ 是网格 $i$ 的中心。系数 $a_i$、$b_i$ 和 $c_i$ 是通过强制使 $p_i(x)$ 在网格 $i-1$、$i$ 和 $i+1$ 上的网格平均值分别与已知的网格平均值 $\\bar{u}_{i-1}$、$\\bar{u}_i$ 和 $\\bar{u}_{i+1}$ 相匹配来确定的。这导出一个三方程系统。\n\n在具有均匀网格间距 $\\Delta x$ 的通用网格 $j$ 上，$p_i(x)$ 的网格平均值为\n$$ \\frac{1}{\\Delta x} \\int_{x_j - \\frac{\\Delta x}{2}}^{x_j + \\frac{\\Delta x}{2}} p_i(x) \\, dx = \\bar{u}_j $$\n为了简化积分，我们引入局部无量纲坐标 $\\xi = \\frac{x-x_i}{\\Delta x}$，因此 $x = x_i + \\xi \\Delta x$ 且 $dx = \\Delta x \\, d\\xi$。多项式变为\n$$p_i(x(\\xi)) = a_i + b_i (\\Delta x \\xi) + c_i (\\Delta x \\xi)^2$$\n在网格 $j$ 上的积分是在区间 $\\xi \\in [\\frac{x_j-x_i}{\\Delta x} - \\frac{1}{2}, \\frac{x_j-x_i}{\\Delta x} + \\frac{1}{2}]$ 上进行的。\n\n我们现在将此应用于模板中的三个网格：$j=i$、$j=i-1$ 和 $j=i+1$。\n\n对于网格 $i$ ($j=i$)：\n积分在 $x \\in [x_i - \\frac{\\Delta x}{2}, x_i + \\frac{\\Delta x}{2}]$ 上进行，这对应于 $\\xi \\in [-\\frac{1}{2}, \\frac{1}{2}]$。\n$$ \\bar{u}_i = \\frac{1}{\\Delta x} \\int_{x_i - \\frac{\\Delta x}{2}}^{x_i + \\frac{\\Delta x}{2}} p_i(x) \\, dx = \\int_{-\\frac{1}{2}}^{\\frac{1}{2}} \\left[ a_i + b_i \\Delta x \\xi + c_i (\\Delta x)^2 \\xi^2 \\right] d\\xi $$\n$$ \\bar{u}_i = \\left[ a_i \\xi + \\frac{1}{2} b_i \\Delta x \\xi^2 + \\frac{1}{3} c_i (\\Delta x)^2 \\xi^3 \\right]_{-\\frac{1}{2}}^{\\frac{1}{2}} $$\n$$ \\bar{u}_i = a_i(1) + \\frac{1}{2} b_i \\Delta x (0) + \\frac{1}{3} c_i (\\Delta x)^2 \\left( \\left(\\frac{1}{2}\\right)^3 - \\left(-\\frac{1}{2}\\right)^3 \\right) = a_i + \\frac{c_i (\\Delta x)^2}{12} \\quad (1)$$\n\n对于网格 $i-1$ ($j=i-1$)：\n积分在 $x \\in [x_{i-1} - \\frac{\\Delta x}{2}, x_{i-1} + \\frac{\\Delta x}{2}] = [x_i - \\frac{3\\Delta x}{2}, x_i - \\frac{\\Delta x}{2}]$ 上进行，这对应于 $\\xi \\in [-\\frac{3}{2}, -\\frac{1}{2}]$。\n$$ \\bar{u}_{i-1} = \\int_{-\\frac{3}{2}}^{-\\frac{1}{2}} \\left[ a_i + b_i \\Delta x \\xi + c_i (\\Delta x)^2 \\xi^2 \\right] d\\xi $$\n$$ \\bar{u}_{i-1} = \\left[ a_i \\xi + \\frac{1}{2} b_i \\Delta x \\xi^2 + \\frac{1}{3} c_i (\\Delta x)^2 \\xi^3 \\right]_{-\\frac{3}{2}}^{-\\frac{1}{2}} $$\n$$ \\bar{u}_{i-1} = a_i(1) + \\frac{1}{2} b_i \\Delta x \\left( \\left(-\\frac{1}{2}\\right)^2 - \\left(-\\frac{3}{2}\\right)^2 \\right) + \\frac{1}{3} c_i (\\Delta x)^2 \\left( \\left(-\\frac{1}{2}\\right)^3 - \\left(-\\frac{3}{2}\\right)^3 \\right) $$\n$$ \\bar{u}_{i-1} = a_i - b_i \\Delta x + \\frac{13}{12} c_i (\\Delta x)^2 \\quad (2)$$\n\n对于网格 $i+1$ ($j=i+1$)：\n积分在 $x \\in [x_{i+1} - \\frac{\\Delta x}{2}, x_{i+1} + \\frac{\\Delta x}{2}] = [x_i + \\frac{\\Delta x}{2}, x_i + \\frac{3\\Delta x}{2}]$ 上进行，这对应于 $\\xi \\in [\\frac{1}{2}, \\frac{3}{2}]$。\n$$ \\bar{u}_{i+1} = \\int_{\\frac{1}{2}}^{\\frac{3}{2}} \\left[ a_i + b_i \\Delta x \\xi + c_i (\\Delta x)^2 \\xi^2 \\right] d\\xi $$\n$$ \\bar{u}_{i+1} = a_i + b_i \\Delta x + \\frac{13}{12} c_i (\\Delta x)^2 \\quad (3)$$\n\n我们现在得到一个关于 $a_i, b_i, c_i$ 的三元线性方程组：\n(1) $a_i + \\frac{1}{12} c_i (\\Delta x)^2 = \\bar{u}_i$\n(2) $a_i - b_i \\Delta x + \\frac{13}{12} c_i (\\Delta x)^2 = \\bar{u}_{i-1}$\n(3) $a_i + b_i \\Delta x + \\frac{13}{12} c_i (\\Delta x)^2 = \\bar{u}_{i+1}$\n\n将方程 (3) 减去方程 (2)：\n$$ (\\bar{u}_{i+1} - \\bar{u}_{i-1}) = 2 b_i \\Delta x $$\n$$ b_i = \\frac{\\bar{u}_{i+1} - \\bar{u}_{i-1}}{2 \\Delta x} $$\n\n将方程 (2) 和 (3) 相加：\n$$ \\bar{u}_{i+1} + \\bar{u}_{i-1} = 2a_i + \\frac{13}{6} c_i (\\Delta x)^2 $$\n从方程 (1) 可知 $a_i = \\bar{u}_i - \\frac{1}{12} c_i (\\Delta x)^2$。将其代入相加后的方程：\n$$ \\bar{u}_{i+1} + \\bar{u}_{i-1} = 2\\left(\\bar{u}_i - \\frac{1}{12} c_i (\\Delta x)^2\\right) + \\frac{13}{6} c_i (\\Delta x)^2 $$\n$$ \\bar{u}_{i+1} + \\bar{u}_{i-1} = 2\\bar{u}_i - \\frac{1}{6} c_i (\\Delta x)^2 + \\frac{13}{6} c_i (\\Delta x)^2 $$\n$$ \\bar{u}_{i+1} + \\bar{u}_{i-1} = 2\\bar{u}_i + \\frac{12}{6} c_i (\\Delta x)^2 = 2\\bar{u}_i + 2 c_i (\\Delta x)^2 $$\n求解 $c_i$：\n$$ 2 c_i (\\Delta x)^2 = \\bar{u}_{i+1} - 2\\bar{u}_i + \\bar{u}_{i-1} $$\n$$ c_i = \\frac{\\bar{u}_{i+1} - 2\\bar{u}_i + \\bar{u}_{i-1}}{2 (\\Delta x)^2} $$\n\n最后，我们使用方程 (1) 和 $c_i$ 的表达式来求解 $a_i$：\n$$ a_i = \\bar{u}_i - \\frac{1}{12} c_i (\\Delta x)^2 = \\bar{u}_i - \\frac{1}{12} \\left( \\frac{\\bar{u}_{i+1} - 2\\bar{u}_i + \\bar{u}_{i-1}}{2 (\\Delta x)^2} \\right) (\\Delta x)^2 $$\n$$ a_i = \\bar{u}_i - \\frac{\\bar{u}_{i+1} - 2\\bar{u}_i + \\bar{u}_{i-1}}{24} = \\frac{24\\bar{u}_i - \\bar{u}_{i+1} + 2\\bar{u}_i - \\bar{u}_{i-1}}{24} $$\n$$ a_i = \\frac{-\\bar{u}_{i-1} + 26\\bar{u}_i - \\bar{u}_{i+1}}{24} $$\n\n确定系数后，我们就可以求出界面值。\n左界面值为 $p_i^{-} = p_i(x_{i-\\frac{1}{2}})$。在 $x = x_{i-\\frac{1}{2}} = x_i - \\frac{\\Delta x}{2}$ 处：\n$$ p_i^{-} = a_i - b_i \\frac{\\Delta x}{2} + c_i \\left( \\frac{\\Delta x}{2} \\right)^2 = a_i - \\frac{b_i \\Delta x}{2} + \\frac{c_i (\\Delta x)^2}{4} $$\n右界面值为 $p_i^{+} = p_i(x_{i+\\frac{1}{2}})$。在 $x = x_{i+\\frac{1}{2}} = x_i + \\frac{\\Delta x}{2}$ 处：\n$$ p_i^{+} = a_i + b_i \\frac{\\Delta x}{2} + c_i \\left( \\frac{\\Delta x}{2} \\right)^2 = a_i + \\frac{b_i \\Delta x}{2} + \\frac{c_i (\\Delta x)^2}{4} $$\n\n我们来计算包含 $b_i$ 和 $c_i$ 的项：\n$$ \\frac{b_i \\Delta x}{2} = \\frac{1}{2} \\left( \\frac{\\bar{u}_{i+1} - \\bar{u}_{i-1}}{2 \\Delta x} \\right) \\Delta x = \\frac{\\bar{u}_{i+1} - \\bar{u}_{i-1}}{4} $$\n$$ \\frac{c_i (\\Delta x)^2}{4} = \\frac{1}{4} \\left( \\frac{\\bar{u}_{i+1} - 2\\bar{u}_i + \\bar{u}_{i-1}}{2 (\\Delta x)^2} \\right) (\\Delta x)^2 = \\frac{\\bar{u}_{i+1} - 2\\bar{u}_i + \\bar{u}_{i-1}}{8} $$\n\n将这些项和 $a_i$ 代入 $p_i^{-}$ 的表达式中：\n$$ p_i^{-} = \\frac{-\\bar{u}_{i-1} + 26\\bar{u}_i - \\bar{u}_{i+1}}{24} - \\frac{\\bar{u}_{i+1} - \\bar{u}_{i-1}}{4} + \\frac{\\bar{u}_{i+1} - 2\\bar{u}_i + \\bar{u}_{i-1}}{8} $$\n通分，取公分母为 $24$：\n$$ p_i^{-} = \\frac{1}{24} \\left[ (-\\bar{u}_{i-1} + 26\\bar{u}_i - \\bar{u}_{i+1}) - 6(\\bar{u}_{i+1} - \\bar{u}_{i-1}) + 3(\\bar{u}_{i+1} - 2\\bar{u}_i + \\bar{u}_{i-1}) \\right] $$\n$$ p_i^{-} = \\frac{1}{24} \\left[ (-1+6+3)\\bar{u}_{i-1} + (26-6)\\bar{u}_i + (-1-6+3)\\bar{u}_{i+1} \\right] $$\n$$ p_i^{-} = \\frac{1}{24} \\left[ 8\\bar{u}_{i-1} + 20\\bar{u}_i - 4\\bar{u}_{i+1} \\right] = \\frac{2\\bar{u}_{i-1} + 5\\bar{u}_i - \\bar{u}_{i+1}}{6} $$\n\n类似地，对于 $p_i^{+}$：\n$$ p_i^{+} = \\frac{-\\bar{u}_{i-1} + 26\\bar{u}_i - \\bar{u}_{i+1}}{24} + \\frac{\\bar{u}_{i+1} - \\bar{u}_{i-1}}{4} + \\frac{\\bar{u}_{i+1} - 2\\bar{u}_i + \\bar{u}_{i-1}}{8} $$\n$$ p_i^{+} = \\frac{1}{24} \\left[ (-\\bar{u}_{i-1} + 26\\bar{u}_i - \\bar{u}_{i+1}) + 6(\\bar{u}_{i+1} - \\bar{u}_{i-1}) + 3(\\bar{u}_{i+1} - 2\\bar{u}_i + \\bar{u}_{i-1}) \\right] $$\n$$ p_i^{+} = \\frac{1}{24} \\left[ (-1-6+3)\\bar{u}_{i-1} + (26-6)\\bar{u}_i + (-1+6+3)\\bar{u}_{i+1} \\right] $$\n$$ p_i^{+} = \\frac{1}{24} \\left[ -4\\bar{u}_{i-1} + 20\\bar{u}_i + 8\\bar{u}_{i+1} \\right] = \\frac{-\\bar{u}_{i-1} + 5\\bar{u}_i + 2\\bar{u}_{i+1}}{6} $$\n重构的左右界面值的最终表达式为：\n$$ p_i^{-} = \\frac{1}{6}(2\\bar{u}_{i-1} + 5\\bar{u}_i - \\bar{u}_{i+1}) $$\n$$ p_i^{+} = \\frac{1}{6}(-\\bar{u}_{i-1} + 5\\bar{u}_i + 2\\bar{u}_{i+1}) $$", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{2\\bar{u}_{i-1} + 5\\bar{u}_i - \\bar{u}_{i+1}}{6} & \\frac{-\\bar{u}_{i-1} + 5\\bar{u}_i + 2\\bar{u}_{i+1}}{6}\n\\end{pmatrix}\n}\n$$", "id": "3328997"}]}