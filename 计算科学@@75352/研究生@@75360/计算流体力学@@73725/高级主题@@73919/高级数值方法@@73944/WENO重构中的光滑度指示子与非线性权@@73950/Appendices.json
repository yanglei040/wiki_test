{"hands_on_practices": [{"introduction": "理解WENO重构的第一步是掌握其基本构建模块：候选多项式。此练习将引导您从基本原理出发，推导在均匀网格上WENO-5格式中每个子模板的界面值表达式。通过亲自推导这些作为WENO方法基础的线性组合系数，您将深刻理解该格式如何通过组合多个低阶多项式来构建高阶精度重构。", "problem": "考虑标量守恒律 $u_{t} + f(u)_{x} = 0$，该方程在一个均匀网格上通过有限体积法进行离散。该网格的网格中心为 $x_{j}$，网格界面为 $x_{j\\pm 1/2}$，网格宽度为 $\\Delta x$。令 $\\bar{u}_{j}$ 表示 $u$ 在网格 $I_{j} = [x_{j-1/2}, x_{j+1/2}]$ 上的网格平均值。在五阶加权基本无振荡 (WENO) 重构中，引入了三个二次重构多项式 $p_{k}(x)$，$k \\in \\{0,1,2\\}$，每个多项式定义在一个三网格子模板上：\n- $S_{0} = \\{I_{i-2}, I_{i-1}, I_{i}\\}$,\n- $S_{1} = \\{I_{i-1}, I_{i}, I_{i+1}\\}$,\n- $S_{2} = \\{I_{i}, I_{i+1}, I_{i+2}\\}$.\n\n每个多项式 $p_{k}(x)$ 的次数至多为 2，并在其子模板上满足网格平均值匹配条件：对于 $p_{k}$ 子模板中的每个网格 $I_{j}$，\n$$(1/\\Delta x)\\int_{x_{j-1/2}}^{x_{j+1/2}} p_{k}(x)\\,\\mathrm{d}x \\;=\\; \\bar{u}_{j}.$$\n来自子模板 $k$ 的界面近似值为 $u_{i+1/2}^{(k)} := p_{k}(x_{i+1/2})$。\n\n从网格平均值的有限体积定义和上述要求出发（不使用任何预先制表的 WENO 系数），将每个 $k \\in \\{0,1,2\\}$ 的 $u_{i+1/2}^{(k)}$ 明确地推导为五个相邻网格平均值 $\\{\\bar{u}_{i+m}\\}_{m=-2}^{2}$ 和 $\\Delta x$ 的线性组合。将每个 $u_{i+1/2}^{(k)}$ 清晰地表示为具有有理系数的线性组合。仅使用 $\\{\\bar{u}_{i+m}\\}_{m=-2}^{2}$ 和常数，将您的最终结果表示为单个行矩阵 $\\big(u_{i+1/2}^{(0)},\\,u_{i+1/2}^{(1)},\\,u_{i+1/2}^{(2)}\\big)$。无需四舍五入。最终答案中不包含单位。", "solution": "问题要求从五阶 WENO 格式中使用的三个子模板 $S_0$、$S_1$ 和 $S_2$ 中的每一个推导在网格界面 $x_{i+1/2}$ 处的重构值。重构值用 $u_{i+1/2}^{(k)}$ 表示，$k \\in \\{0, 1, 2\\}$。每个值都是通过在 $x_{i+1/2}$ 处计算一个唯一的二次多项式 $p_k(x)$ 得到的。多项式 $p_k(x)$ 的定义条件是其网格平均值与其对应的三网格模板 $S_k$ 上的给定网格平均值 $\\bar{u}_j$ 相匹配。我们将从第一性原理出发推导这些表达式。\n\n一个关键步骤是为每个模板定义一个局部坐标系，以简化代数运算。对于一个由网格 $I_{j-1}$、$I_j$、$I_{j+1}$ 组成的通用三网格模板，方便的做法是定义一个局部坐标 $\\xi = (x - x_j) / \\Delta x$，其中 $x_j$ 是中间网格的中心。在这个坐标系中，网格中心位于 $\\xi \\in \\{-1, 0, 1\\}$。\n\n设局部坐标系中的二次多项式为 $P(\\xi) = a\\xi^2 + b\\xi + c$。对于以 $x_{j+s}$ 为中心（即在 $\\xi = s$ 处）的网格，其网格平均值条件为：\n$$ \\bar{u}_{j+s} = \\frac{1}{\\Delta x} \\int_{x_{j+s-1/2}}^{x_{j+s+1/2}} p(x) \\,dx $$\n换元为 $\\xi = (x-x_j)/\\Delta x$，我们有 $x = x_j + \\xi \\Delta x$ 和 $dx = \\Delta x d\\xi$。网格 $I_{j+s}$ 的积分限变为 $\\xi = s - 1/2$ 和 $\\xi = s + 1/2$。该条件转换为：\n$$ \\bar{u}_{j+s} = \\int_{s-1/2}^{s+1/2} P(\\xi) \\,d\\xi = \\int_{s-1/2}^{s+1/2} (a\\xi^2 + b\\xi + c) \\,d\\xi $$\n$$ \\bar{u}_{j+s} = \\left[ \\frac{a}{3}\\xi^3 + \\frac{b}{2}\\xi^2 + c\\xi \\right]_{s-1/2}^{s+1/2} $$\n计算反导数在积分限上的值：\n$$ \\bar{u}_{j+s} = \\frac{a}{3}((s+\\tfrac{1}{2})^3 - (s-\\tfrac{1}{2})^3) + \\frac{b}{2}((s+\\tfrac{1}{2})^2 - (s-\\tfrac{1}{2})^2) + c((s+\\tfrac{1}{2}) - (s-\\tfrac{1}{2})) $$\n$$ \\bar{u}_{j+s} = \\frac{a}{3}(3s^2 + \\frac{1}{4}) + \\frac{b}{2}(2s) + c(1) = a(s^2 + \\frac{1}{12}) + bs + c $$\n我们将此通用公式应用于 $s \\in \\{-1, 0, 1\\}$ 的中心三网格模板，对应于网格平均值 $\\bar{u}_{j-1}$、$\\bar{u}_j$ 和 $\\bar{u}_{j+1}$：\n\\begin{align*}\n\\bar{u}_{j-1} = a((-1)^2 + \\tfrac{1}{12}) + b(-1) + c = a(\\tfrac{13}{12}) - b + c \\\\\n\\bar{u}_{j} = a((0)^2 + \\tfrac{1}{12}) + b(0) + c = a(\\tfrac{1}{12}) + c \\\\\n\\bar{u}_{j+1} = a((1)^2 + \\tfrac{1}{12}) + b(1) + c = a(\\tfrac{13}{12}) + b + c\n\\end{align*}\n这构成了关于系数 $a,b,c$ 的一个线性系统。求解该系统可得：\n从第二个方程，我们得到 $c = \\bar{u}_j - a/12$。\n第三个方程减去第一个方程得到 $\\bar{u}_{j+1} - \\bar{u}_{j-1} = 2b$，所以 $b = \\frac{1}{2}(\\bar{u}_{j+1} - \\bar{u}_{j-1})$。\n第一个和第三个方程相加得到 $\\bar{u}_{j-1} + \\bar{u}_{j+1} = 2a(\\frac{13}{12}) + 2c = \\frac{13}{6}a + 2(\\bar{u}_j - a/12) = (\\frac{13}{6}-\\frac{1}{6})a + 2\\bar{u}_j = 2a + 2\\bar{u}_j$。\n这可以简化为 $2a = \\bar{u}_{j-1} - 2\\bar{u}_j + \\bar{u}_{j+1}$，所以 $a = \\frac{1}{2}(\\bar{u}_{j-1} - 2\\bar{u}_j + \\bar{u}_{j+1})$。\n系数为：\n$$ a = \\frac{1}{2}(\\bar{u}_{j-1} - 2\\bar{u}_j + \\bar{u}_{j+1}) $$\n$$ b = \\frac{1}{2}(\\bar{u}_{j+1} - \\bar{u}_{j-1}) $$\n$$ c = \\bar{u}_j - \\frac{1}{24}(\\bar{u}_{j-1} - 2\\bar{u}_j + \\bar{u}_{j+1}) = -\\frac{1}{24}\\bar{u}_{j-1} + \\frac{13}{12}\\bar{u}_j - \\frac{1}{24}\\bar{u}_{j+1} $$\n现在我们将这些通解应用于每个特定的模板 $S_k$ 来求得 $u_{i+1/2}^{(k)}$。\n\n**情况 $k=1$：模板 $S_1 = \\{I_{i-1}, I_i, I_{i+1}\\}$**\n该模板以网格 $I_i$ 为中心。我们设 $j=i$，因此局部坐标为 $\\xi_1 = (x - x_i)/\\Delta x$。网格平均值为 $\\bar{u}_{i-1}$、$\\bar{u}_i$、$\\bar{u}_{i+1}$。多项式 $p_1(x)$ 的系数 $a_1, b_1, c_1$ 可由 $j=i$ 的通用公式直接给出：\n$a_1 = \\frac{1}{2}(\\bar{u}_{i-1} - 2\\bar{u}_i + \\bar{u}_{i+1})$,\n$b_1 = \\frac{1}{2}(\\bar{u}_{i+1} - \\bar{u}_{i-1})$,\n$c_1 = -\\frac{1}{24}\\bar{u}_{i-1} + \\frac{13}{12}\\bar{u}_i - \\frac{1}{24}\\bar{u}_{i+1}$。\n我们在 $x_{i+1/2}$ 处计算多项式的值，这对应于 $\\xi_1 = (x_{i+1/2} - x_i)/\\Delta x = 1/2$。\n$u_{i+1/2}^{(1)} = p_1(x_{i+1/2}) = a_1(\\frac{1}{2})^2 + b_1(\\frac{1}{2}) + c_1 = \\frac{a_1}{4} + \\frac{b_1}{2} + c_1$。\n代入系数的表达式：\n$u_{i+1/2}^{(1)} = \\frac{1}{8}(\\bar{u}_{i-1} - 2\\bar{u}_i + \\bar{u}_{i+1}) + \\frac{1}{4}(\\bar{u}_{i+1} - \\bar{u}_{i-1}) + (-\\frac{1}{24}\\bar{u}_{i-1} + \\frac{13}{12}\\bar{u}_i - \\frac{1}{24}\\bar{u}_{i+1})$。\n合并每个网格平均值的项：\n$\\bar{u}_{i-1}$ 的系数： $\\frac{1}{8} - \\frac{1}{4} - \\frac{1}{24} = \\frac{3-6-1}{24} = -\\frac{4}{24} = -\\frac{1}{6}$。\n$\\bar{u}_{i}$ 的系数： $-\\frac{2}{8} + \\frac{13}{12} = -\\frac{1}{4} + \\frac{13}{12} = \\frac{-3+13}{12} = \\frac{10}{12} = \\frac{5}{6}$。\n$\\bar{u}_{i+1}$ 的系数： $\\frac{1}{8} + \\frac{1}{4} - \\frac{1}{24} = \\frac{3+6-1}{24} = \\frac{8}{24} = \\frac{1}{3}$。\n因此，$u_{i+1/2}^{(1)} = -\\frac{1}{6}\\bar{u}_{i-1} + \\frac{5}{6}\\bar{u}_{i} + \\frac{1}{3}\\bar{u}_{i+1} = \\frac{1}{6}(-\\bar{u}_{i-1} + 5\\bar{u}_{i} + 2\\bar{u}_{i+1})$。\n\n**情况 $k=2$：模板 $S_2 = \\{I_i, I_{i+1}, I_{i+2}\\}$**\n该模板以网格 $I_{i+1}$ 为中心。我们设 $j=i+1$，因此局部坐标为 $\\xi_2 = (x - x_{i+1})/\\Delta x$。网格平均值为 $\\bar{u}_{i}$、$\\bar{u}_{i+1}$、$\\bar{u}_{i+2}$。系数可由 $j=i+1$ 的通用公式给出：\n$a_2 = \\frac{1}{2}(\\bar{u}_{i} - 2\\bar{u}_{i+1} + \\bar{u}_{i+2})$,\n$b_2 = \\frac{1}{2}(\\bar{u}_{i+2} - \\bar{u}_{i})$,\n$c_2 = -\\frac{1}{24}\\bar{u}_{i} + \\frac{13}{12}\\bar{u}_{i+1} - \\frac{1}{24}\\bar{u}_{i+2}$。\n我们在 $x_{i+1/2}$ 处求值，这对应于 $\\xi_2 = (x_{i+1/2} - x_{i+1})/\\Delta x = -1/2$。\n$u_{i+1/2}^{(2)} = p_2(x_{i+1/2}) = a_2(-\\frac{1}{2})^2 + b_2(-\\frac{1}{2}) + c_2 = \\frac{a_2}{4} - \\frac{b_2}{2} + c_2$。\n代入系数的表达式：\n$u_{i+1/2}^{(2)} = \\frac{1}{8}(\\bar{u}_{i} - 2\\bar{u}_{i+1} + \\bar{u}_{i+2}) - \\frac{1}{4}(\\bar{u}_{i+2} - \\bar{u}_{i}) + (-\\frac{1}{24}\\bar{u}_{i} + \\frac{13}{12}\\bar{u}_{i+1} - \\frac{1}{24}\\bar{u}_{i+2})$。\n合并项：\n$\\bar{u}_{i}$ 的系数： $\\frac{1}{8} + \\frac{1}{4} - \\frac{1}{24} = \\frac{3+6-1}{24} = \\frac{8}{24} = \\frac{1}{3}$。\n$\\bar{u}_{i+1}$ 的系数： $-\\frac{2}{8} + \\frac{13}{12} = -\\frac{1}{4} + \\frac{13}{12} = \\frac{-3+13}{12} = \\frac{10}{12} = \\frac{5}{6}$。\n$\\bar{u}_{i+2}$ 的系数： $\\frac{1}{8} - \\frac{1}{4} - \\frac{1}{24} = \\frac{3-6-1}{24} = -\\frac{4}{24} = -\\frac{1}{6}$。\n因此，$u_{i+1/2}^{(2)} = \\frac{1}{3}\\bar{u}_{i} + \\frac{5}{6}\\bar{u}_{i+1} - \\frac{1}{6}\\bar{u}_{i+2} = \\frac{1}{6}(2\\bar{u}_{i} + 5\\bar{u}_{i+1} - \\bar{u}_{i+2})$。\n\n**情况 $k=0$：模板 $S_0 = \\{I_{i-2}, I_{i-1}, I_i\\}$**\n该模板以网格 $I_{i-1}$ 为中心。我们设 $j=i-1$，因此局部坐标为 $\\xi_0 = (x - x_{i-1})/\\Delta x$。网格平均值为 $\\bar{u}_{i-2}$、$\\bar{u}_{i-1}$、$\\bar{u}_{i}$。系数可由 $j=i-1$ 的通用公式给出：\n$a_0 = \\frac{1}{2}(\\bar{u}_{i-2} - 2\\bar{u}_{i-1} + \\bar{u}_{i})$,\n$b_0 = \\frac{1}{2}(\\bar{u}_{i} - \\bar{u}_{i-2})$,\n$c_0 = -\\frac{1}{24}\\bar{u}_{i-2} + \\frac{13}{12}\\bar{u}_{i-1} - \\frac{1}{24}\\bar{u}_{i}$。\n我们在 $x_{i+1/2}$ 处求值，这对应于 $\\xi_0 = (x_{i+1/2} - x_{i-1})/\\Delta x = (i+1/2 - (i-1)) = 3/2$。\n$u_{i+1/2}^{(0)} = p_0(x_{i+1/2}) = a_0(\\frac{3}{2})^2 + b_0(\\frac{3}{2}) + c_0 = \\frac{9}{4}a_0 + \\frac{3}{2}b_0 + c_0$。\n代入系数的表达式：\n$u_{i+1/2}^{(0)} = \\frac{9}{8}(\\bar{u}_{i-2} - 2\\bar{u}_{i-1} + \\bar{u}_{i}) + \\frac{3}{4}(\\bar{u}_{i} - \\bar{u}_{i-2}) + (-\\frac{1}{24}\\bar{u}_{i-2} + \\frac{13}{12}\\bar{u}_{i-1} - \\frac{1}{24}\\bar{u}_{i})$。\n合并项：\n$\\bar{u}_{i-2}$ 的系数： $\\frac{9}{8} - \\frac{3}{4} - \\frac{1}{24} = \\frac{27-18-1}{24} = \\frac{8}{24} = \\frac{1}{3}$。\n$\\bar{u}_{i-1}$ 的系数： $-\\frac{18}{8} + \\frac{13}{12} = -\\frac{9}{4} + \\frac{13}{12} = \\frac{-27+13}{12} = -\\frac{14}{12} = -\\frac{7}{6}$。\n$\\bar{u}_{i}$ 的系数： $\\frac{9}{8} + \\frac{3}{4} - \\frac{1}{24} = \\frac{27+18-1}{24} = \\frac{44}{24} = \\frac{11}{6}$。\n因此，$u_{i+1/2}^{(0)} = \\frac{1}{3}\\bar{u}_{i-2} - \\frac{7}{6}\\bar{u}_{i-1} + \\frac{11}{6}\\bar{u}_{i} = \\frac{1}{6}(2\\bar{u}_{i-2} - 7\\bar{u}_{i-1} + 11\\bar{u}_{i})$。\n\n综上所述，三个界面值为：\n$u_{i+1/2}^{(0)} = \\frac{2\\bar{u}_{i-2} - 7\\bar{u}_{i-1} + 11\\bar{u}_{i}}{6}$\n$u_{i+1/2}^{(1)} = \\frac{-\\bar{u}_{i-1} + 5\\bar{u}_{i} + 2\\bar{u}_{i+1}}{6}$\n$u_{i+1/2}^{(2)} = \\frac{2\\bar{u}_{i} + 5\\bar{u}_{i+1} - \\bar{u}_{i+2}}{6}$", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{1}{6}(2\\bar{u}_{i-2} - 7\\bar{u}_{i-1} + 11\\bar{u}_{i})\n\n\\frac{1}{6}(-\\bar{u}_{i-1} + 5\\bar{u}_{i} + 2\\bar{u}_{i+1})\n\n\\frac{1}{6}(2\\bar{u}_{i} + 5\\bar{u}_{i+1} - \\bar{u}_{i+2})\n\\end{pmatrix}\n}\n$$", "id": "3392156"}, {"introduction": "在掌握了标量WENO重构的原理之后，下一个关键步骤是将其应用于方程组，这是计算流体动力学中的常见情况。此练习要求您处理一个$2 \\times 2$的线性双曲系统，通过特征分解将耦合的系统转化为一组独立的标量特征场，在每个场上独立执行WENO重构，最后再将结果映射回物理空间。这个过程不仅展示了WENO方法在更复杂问题上的应用，也强调了特征分解在处理双曲系统中的核心作用。", "problem": "考虑具有常雅可比矩阵的线性双曲守恒律方程组 $\\,\\partial_{t}\\mathbf{U} + A\\,\\partial_{x}\\mathbf{U} = \\mathbf{0}\\,$\n$$\nA=\\begin{pmatrix}\n2  1\\\\\n1  2\n\\end{pmatrix},\n$$\n该方程组设置在一个均匀的一维网格上，网格中心位于 $\\,x_{j}=j\\,\\Delta x\\,$。令 $\\,\\mathbf{U}=(u,v)^{\\mathsf{T}}\\,$ 表示守恒变量向量，并假设可用的有限体积元平均值为\n$$\nu_{j}=1+j,\\qquad v_{j}=2-j,\n$$\n对于指标 $\\,j\\in\\{-2,-1,0,1,2\\}\\,$。关注 $\\,i=0\\,$ 时的界面 $\\,x_{i+1/2}\\,$。\n\n从线性系统的特征分解和高阶有限体积重构的基本原理出发，按顺序执行以下操作：\n- 构造 $\\,A\\,$ 的左右特征向量矩阵，以形成特征投影 $\\,\\mathbf{w}=L\\,\\mathbf{U}\\,$ 及其逆映射 $\\,\\mathbf{U}=R\\,\\mathbf{w}\\,$, 其中 $\\,L=R^{-1}\\,$。\n- 将给定的单元平均值 $\\,\\mathbf{U}_{j}\\,$ 投影到特征场 $\\,\\mathbf{w}_{j}\\,$。\n- 在每个标量特征场中，使用 Jiang–Shu 格式 (WENO-JS) 进行左偏五阶加权基本无振荡 (WENO) 重构。光滑度指示子和非线性权由五点模板 $\\,\\{j-2,j-1,j,j+1,j+2\\}\\,$ 上的三个子模板计算得出。使用与五阶格式相关的理想权 $\\,d_{0},d_{1},d_{2}\\,$，光滑度指示子幂次 $\\,p=2\\,$，以及 $\\,\\varepsilon=10^{-6}\\,$。\n- 将在 $\\,x_{i+1/2}^{-}\\,$ 处重构的特征状态映射回物理分量 $\\,\\mathbf{U}_{i+1/2}^{-}=R\\,\\mathbf{w}_{i+1/2}^{-}\\,$.\n\n将界面处第一个物理分量的重构左状态 $\\,u_{i+1/2}^{-}\\,$ 报告为单个数字。最终答案无需四舍五入，也不应包含单位。", "solution": "对用户提供的问题进行有效性评估。\n\n### 步骤 1：提取已知条件\n-   **方程组**：线性双曲守恒律方程组，$\\partial_{t}\\mathbf{U} + A\\,\\partial_{x}\\mathbf{U} = \\mathbf{0}$。\n-   **雅可比矩阵**：$A=\\begin{pmatrix} 2  1\\\\ 1  2 \\end{pmatrix}$。\n-   **网格**：均匀一维网格，网格中心位于 $x_{j}=j\\,\\Delta x$。\n-   **状态向量**：$\\mathbf{U}=(u,v)^{\\mathsf{T}}$。\n-   **单元平均值**：对于 $j\\in\\{-2,-1,0,1,2\\}$，单元平均数据为 $u_{j}=1+j$ 和 $v_{j}=2-j$。\n-   **界面**：重构是在 $i=0$ 时的界面 $x_{i+1/2}$ 的左状态，即在 $x_{1/2}^{-}$ 处。\n-   **重构方法**：五阶加权基本无振荡 (WENO) 重构，Jiang–Shu 格式 (WENO-JS)，左偏。\n-   **模板**：使用一个五点模板 $\\{j-2,j-1,j,j+1,j+2\\}$，对于 $i=0$ 对应于 $j \\in \\{-2, -1, 0, 1, 2\\}$ 的数据。\n-   **WENO 参数**：\n    -   五阶格式的理想权：$d_{0}, d_{1}, d_{2}$。\n    -   光滑度指示子幂次：$p=2$。\n    -   正则化参数：$\\varepsilon=10^{-6}$。\n-   **要求输出**：在 $i=0$ 处，重构左状态的第一个物理分量的值 $u_{i+1/2}^{-}$。\n\n### 步骤 2：使用提取的已知条件进行验证\n-   **科学依据**：该问题在双曲守恒律数值方法的理论中有坚实的基础。特征分解和 WENO 重构是计算流体动力学中标准的、经过验证的技术。\n-   **适定性**：该问题是适定的。所有必要信息都已提供，包括控制方程、雅可比矩阵、单元平均数据、特定的重构格式及其所有参数。任务序列是逻辑的，并能导出一个唯一解。\n-   **客观性**：该问题使用精确的数学语言陈述，没有任何主观性或模糊性。\n-   **其他缺陷**：该问题没有表现出任何其他缺陷，如不完整性、矛盾、不可行性或琐碎性。计算虽然详细，但是 WENO 方法的标准应用。\n\n### 步骤 3：结论与行动\n该问题是**有效的**。将提供完整解答。\n\n### 解答\n\n解答过程分四个阶段进行：\n1.  系统矩阵 $A$ 的特征分解。\n2.  将物理单元平均数据 $\\mathbf{U}_j$ 投影到特征场上。\n3.  在每个特征场中进行五阶 WENO 重构，以找到界面处的左状态 $\\mathbf{w}_{i+1/2}^{-}$。\n4.  将重构的特征状态转换回物理变量，以找到 $\\mathbf{U}_{i+1/2}^{-}$ 及其第一个分量 $u_{i+1/2}^{-}$。\n\n**1. 特征分解**\n\n雅可比矩阵为 $A=\\begin{pmatrix} 2  1\\\\ 1  2 \\end{pmatrix}$。我们求其特征值 $(\\lambda)$ 和右特征向量 $(\\mathbf{r})$。\n特征方程为 $\\det(A - \\lambda I) = (2-\\lambda)^{2} - 1 = 0$，解得 $2-\\lambda = \\pm 1$。\n特征值为 $\\lambda_1 = 1$ 和 $\\lambda_2 = 3$。\n\n对于 $\\lambda_1 = 1$: $(A-\\lambda_1 I)\\mathbf{r}_1_ = \\mathbf{0} \\Rightarrow \\begin{pmatrix} 1  1 \\\\ 1  1 \\end{pmatrix}\\mathbf{r}_1 = \\mathbf{0}$。一个对应的右特征向量是 $\\mathbf{r}_1 = (1, -1)^{\\mathsf{T}}$。\n对于 $\\lambda_2 = 3$: $(A-\\lambda_2 I)\\mathbf{r}_2 = \\mathbf{0} \\Rightarrow \\begin{pmatrix} -1  1 \\\\ 1  -1 \\end{pmatrix}\\mathbf{r}_2 = \\mathbf{0}$。一个对应的右特征向量是 $\\mathbf{r}_2 = (1, 1)^{\\mathsf{T}}$。\n\n右特征向量矩阵 $R$ 及其逆矩阵，即左特征向量矩阵 $L=R^{-1}$，为：\n$$\nR = \\begin{pmatrix} 1  1 \\\\ -1  1 \\end{pmatrix}\n$$\n$$\nL = R^{-1} = \\frac{1}{1(1) - 1(-1)} \\begin{pmatrix} 1  -1 \\\\ 1  1 \\end{pmatrix} = \\frac{1}{2} \\begin{pmatrix} 1  -1 \\\\ 1  1 \\end{pmatrix}\n$$\n\n**2. 投影到特征场**\n\n物理单元平均值为 $\\mathbf{U}_j = (u_j, v_j)^{\\mathsf{T}} = (1+j, 2-j)^{\\mathsf{T}}$。我们使用 $\\mathbf{w}_j = L\\mathbf{U}_j$ 将这些值投影到特征场上。\n$$\n\\mathbf{w}_j = \\begin{pmatrix} w_{1,j} \\\\ w_{2,j} \\end{pmatrix} = \\frac{1}{2} \\begin{pmatrix} 1  -1 \\\\ 1  1 \\end{pmatrix} \\begin{pmatrix} 1+j \\\\ 2-j \\end{pmatrix} = \\frac{1}{2} \\begin{pmatrix} (1+j) - (2-j) \\\\ (1+j) + (2-j) \\end{pmatrix} = \\frac{1}{2} \\begin{pmatrix} 2j-1 \\\\ 3 \\end{pmatrix}\n$$\n因此，两个特征场为：\n$w_{1,j} = j - \\frac{1}{2}$\n$w_{2,j} = \\frac{3}{2}$\n\n对于在 $x_{1/2}^{-}$（单元 $i=0$）处的重构，我们使用模板 $j \\in \\{-2, -1, 0, 1, 2\\}$。\n\n**3. WENO-JS 重构**\n\n我们对每个特征场分别进行 WENO 重构。\n\n**场 2 ($w_2$)：**\n单元平均值为 $w_{2,j} = \\frac{3}{2}$（对所有 $j$）。数据是常数。任何合理的重构格式，包括五阶 WENO，都将精确地保持常数状态。因此，界面处的重构值就是该常数本身。\n$$\nw_{2,1/2}^{-} = \\frac{3}{2}\n$$\n\n**场 1 ($w_1$)：**\n单元平均值为 $w_{1,j} = j - \\frac{1}{2}$。该数据是指标 $j$ 的一个线性函数。五阶 WENO 格式被设计用于在光滑区域达到五阶精度，这意味着它可以精确重构最高4次的多项式。由于我们的数据是完全线性的（1次多项式），WENO 格式将产生底层连续函数的确切值。\n\n如果我们假设 $x_j = j \\Delta x$，一个其单元平均值为 $w_{1,j} = j - \\frac{1}{2}$ 的连续函数可以写作 $p(x) = \\frac{x}{\\Delta x} - \\frac{1}{2}$。不失一般性，令 $\\Delta x=1$，则 $x_j=j$ 且 $p(x) = x - \\frac{1}{2}$。界面位于 $x_{1/2} = \\frac{1}{2}$。确切值为 $p(\\frac{1}{2}) = \\frac{1}{2} - \\frac{1}{2} = 0$。\n因此，重构必须得到：\n$$\nw_{1,1/2}^{-} = 0\n$$\n\n为了形式上验证这一点，我们可以检查 WENO-JS 的过程。五阶重构是三个在子模板 $S_0=\\{j-2, j-1, j\\}$、$S_1=\\{j-1, j, j+1\\}$ 和 $S_2=\\{j, j+1, j+2\\}$ 上的三阶重构的加权平均。对于线性数据，这些子模板上的每一个重构也都是精确的。让我们对 $i=0$ 进行验证：\n$\\hat{w}_{1,1/2}^{(0)} = \\frac{1}{3}w_{1,-2} - \\frac{7}{6}w_{1,-1} + \\frac{11}{6}w_{1,0} = \\frac{1}{3}(-2.5) - \\frac{7}{6}(-1.5) + \\frac{11}{6}(-0.5) = \\frac{-5+10.5-5.5}{6} = 0$。\n$\\hat{w}_{1,1/2}^{(1)} = -\\frac{1}{6}w_{1,-1} + \\frac{5}{6}w_{1,0} + \\frac{1}{3}w_{1,1} = -\\frac{1}{6}(-1.5) + \\frac{5}{6}(-0.5) + \\frac{1}{3}(0.5) = \\frac{1.5-2.5+1}{6} = 0$。\n$\\hat{w}_{1,1/2}^{(2)} = \\frac{1}{3}w_{1,0} + \\frac{5}{6}w_{1,1} - \\frac{1}{6}w_{1,2} = \\frac{1}{3}(-0.5) + \\frac{5}{6}(0.5) - \\frac{1}{6}(1.5) = \\frac{-1+2.5-1.5}{6} = 0$。\n由于所有子重构都得到 $0$，它们的加权和也为 $0$。\n\n此外，对于线性数据，Jiang-Shu 光滑度指示子 $\\beta_k$ 都是相等的。对于 $i=0$：\n$\\beta_0 = \\frac{13}{12}(w_{1,-2}-2w_{1,-1}+w_{1,0})^2 + \\frac{1}{4}(w_{1,-2}-4w_{1,-1}+3w_{1,0})^2 = \\frac{13}{12}(0)^2 + \\frac{1}{4}(2)^2=1$。\n$\\beta_1 = \\frac{13}{12}(w_{1,-1}-2w_{1,0}+w_{1,1})^2 + \\frac{1}{4}(w_{1,-1}-4w_{1,0}+3w_{1,1})^2 = \\frac{13}{12}(0)^2 + \\frac{1}{4}(2)^2=1$。\n$\\beta_2 = \\frac{13}{12}(w_{1,0}-2w_{1,1}+w_{1,2})^2 + \\frac{1}{4}(w_{1,0}-4w_{1,1}+3w_{1,2})^2 = \\frac{13}{12}(0)^2 + \\frac{1}{4}(2)^2=1$。\n由于 $\\beta_0=\\beta_1=\\beta_2$，非线性权 $\\omega_k$ 变得与理想线性权 $d_k$ 相等。WENO 重构回归到最优的五阶线性重构，该重构对于线性数据是精确的。\n\n界面处的重构特征状态为 $\\mathbf{w}_{1/2}^{-} = (w_{1,1/2}^{-}, w_{2,1/2}^{-})^{\\mathsf{T}} = (0, \\frac{3}{2})^{\\mathsf{T}}$。\n\n**4. 转换回物理变量**\n\n最后，我们使用 $\\mathbf{U}_{1/2}^{-} = R \\mathbf{w}_{1/2}^{-}$ 将重构的特征状态映射回物理变量。\n$$\n\\mathbf{U}_{1/2}^{-} = \\begin{pmatrix} u_{1/2}^{-} \\\\ v_{1/2}^{-} \\end{pmatrix} = \\begin{pmatrix} 1  1 \\\\ -1  1 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ \\frac{3}{2} \\end{pmatrix} = \\begin{pmatrix} 1(0) + 1(\\frac{3}{2}) \\\\ -1(0) + 1(\\frac{3}{2}) \\end{pmatrix} = \\begin{pmatrix} \\frac{3}{2} \\\\ \\frac{3}{2} \\end{pmatrix}\n$$\n界面 $x_{1/2}$ 处第一个物理分量的重构左状态为 $u_{1/2}^{-} = \\frac{3}{2}$。", "answer": "$$\n\\boxed{1.5}\n$$", "id": "3392151"}, {"introduction": "从理论到稳健的计算实践，需要我们仔细考虑有限精度算术带来的影响。此练习探讨了WENO非线性权值计算中的一个关键数值问题：正则化参数$\\varepsilon$的选择。通过分析在浮点运算中，过小的$\\varepsilon$如何因舍入误差导致非物理的负权值，您将学会设计一种能保证权值凸性和数值稳定性的稳健策略，这对于开发可靠的科学计算程序至关重要。", "problem": "考虑一维标量守恒律 $u_t + f(u)_x = 0$，该守恒律在间距为 $\\Delta x$ 的均匀网格上通过有限体积法进行离散化。为了在单元界面上重构数值通量，使用了一种五阶加权基本无振荡 (WENO) 格式。在每个界面上，三个候选重构 $q_k$ ($k=0,1,2$) 通过凸组合 $q = \\sum_{k=0}^{2} \\omega_k q_k$ 的方式结合起来，其中非线性权 $\\omega_k$ 由未归一化权 $\\alpha_k$ 通过 $\\omega_k = \\alpha_k / \\sum_{j=0}^{2} \\alpha_j$ 计算得出。在精确算术中，光滑度指示子 $\\beta_k$ 是非负的，并且 Jiang–Shu 非线性权由核心公式 $\\alpha_k = d_k / (\\varepsilon + \\beta_k)^p$ 定义，其中 $d_k > 0$ 是线性权，$p \\ge 1$ 是一个固定的整数（通常 $p=2$）。在诸如 WENO-Z 的增强变体中，可能会包含一个形式为 $1 + \\phi \\,\\tau/(\\varepsilon + \\beta_k)$ 的乘法修正（其中 $\\phi \\in [0,1]$ 和 $\\tau \\ge 0$）以提高在临界点处的精度，从而得到广义形式\n$$\n\\alpha_k = d_k \\,\\frac{1 + \\phi \\,\\dfrac{\\tau}{\\varepsilon + \\beta_k}}{(\\varepsilon + \\beta_k)^p}.\n$$\n假设计算在 IEEE 754 双精度浮点算术中执行，单位舍入为 $u \\equiv \\varepsilon_{\\mathrm{mach}} \\approx 2^{-53}$。在实践中，计算出的光滑度指示子 $\\widehat{\\beta}_k$ 会因舍入误差而偏离其精确值，满足 $\\widehat{\\beta}_k = \\beta_k + \\delta_k$，其中 $|\\delta_k| \\lesssim C u \\,S$，对于某个由重构差分决定的局部尺度 $S$。在非常光滑的区域，精确的 $\\beta_k$ 可以小至 $\\mathcal{O}(\\Delta x^2)$ 或在临界点处为零。\n\n要求您分析当参数 $\\varepsilon$ 相对于 $u$ 和局部尺度选择得过小时的失效模式，并提出一种鲁棒的策略，以确保权重保持为凸组合（所有 $\\omega_k \\ge 0$ 且 $\\sum_k \\omega_k = 1$）并且重构保持数值稳定。具体来说：\n\n- 从浮点算术的基本原理和 WENO 权的定义出发，解释当 $\\varepsilon$ 过小时，舍入误差如何产生负权或非凸权。您的解释应明确一个机制，通过该机制，计算出的 $(\\widehat{\\beta}_k + \\varepsilon)$ 可能变为非正数或数值上灾难性地小，并解释为什么这会在上述广义形式中（即使当 $p=2$ 时）产生 $\\alpha_k  0$，或产生破坏归一化中凸性的极端不平衡。\n- 基于此分析，选择在各种网格和解尺度下保证权重凸性和稳定性的最鲁棒策略。\n\n哪个选项最能满足这些要求？\n\nA. 根据局部尺度自适应地选择 $\\varepsilon$ 并强制进行代数正则化：设置 $\\varepsilon = \\max\\!\\big(C_1\\,u\\,S,\\; C_2\\,\\overline{\\beta}\\big)$，其中 $\\overline{\\beta} = \\tfrac{1}{3}\\sum_{j=0}^{2}\\widehat{\\beta}_j$ 且 $C_1, C_2$ 是适中的常数（例如，$C_1 \\in [10,100]$，$C_2 \\in [10^{-2},10^{-1}]$）。将 $\\widehat{\\beta}_k$ 替换为 $\\max(\\widehat{\\beta}_k,0)$ 以消除舍入误差产生的负指示子，使用补偿求和计算归一化项 $\\sum_j \\alpha_j$，并且如果计算出的任何 $\\omega_k$ 因残余舍入而为负，则通过设置 $\\omega_k \\leftarrow \\max(\\omega_k,0)$ 并重新归一化使 $\\sum_k \\omega_k = 1$ 来将其投影到概率单纯形上。\n\nB. 设置 $\\varepsilon = 0$ 以最大化对光滑度的敏感性，并依赖归一化 $\\omega_k = \\alpha_k/\\sum_j \\alpha_j$ 来防止负值的出现。\n\nC. 固定一个与解的量级和网格间距无关的全局微小常数 $\\varepsilon$（例如，$\\varepsilon = 10^{-30}$），以避免对权重产生偏倚，同时保持原有的精度阶。\n\nD. 用线性权替换非线性 WENO 权，即，无论 $\\beta_k$ 如何，都设置 $\\omega_k = d_k$，这样组合总是凸的，并能避免任何由舍入引起的负值。\n\nE. 在归一化之前将每个 $\\alpha_k$ 替换为 $|\\alpha_k|$ 来强制其为正，从而确保 $\\omega_k \\ge 0$，而不修改 $\\varepsilon$ 或 $\\beta_k$。\n\n选择唯一的最佳选项。", "solution": "我们从加权基本无振荡 (WENO) 重构和浮点算术的核心定义开始。在精确算术中，对于五阶 Jiang–Shu WENO，光滑度指示子 $\\beta_k$ 由子模板上离散导数的平方和构成，因此满足 $\\beta_k \\ge 0$。未归一化权 $\\alpha_k$ 满足\n$$\n\\alpha_k = \\frac{d_k}{(\\varepsilon + \\beta_k)^p}, \\quad d_k0,\\; p\\ge 1,\n$$\n归一化权 $\\omega_k = \\alpha_k / \\sum_j \\alpha_j$ 形成一个凸组合，因为 $\\alpha_k0$ 且分母为正。在诸如 WENO-Z 的广义格式中，包含一个乘法修正因子\n$$\nG_k(\\beta_k,\\varepsilon) = 1 + \\phi\\,\\frac{\\tau}{\\varepsilon + \\beta_k}, \\quad \\phi \\in [0,1],\\; \\tau \\ge 0,\n$$\n这会得到\n$$\n\\alpha_k = d_k \\,\\frac{G_k(\\beta_k,\\varepsilon)}{(\\varepsilon + \\beta_k)^p}.\n$$\n在精确算术中，对于 $\\varepsilon0$，我们同样有 $\\alpha_k0$，因为 $G_k(\\beta_k,\\varepsilon)\\ge 1$。\n\n现在我们引入浮点算术的原理。在 IEEE 754 双精度中，任何计算量 $x$ 都表示为 $\\widehat{x} = x(1+\\theta)$，其中 $|\\theta| \\le u \\equiv \\varepsilon_{\\mathrm{mach}} \\approx 2^{-53}$，除非出现严重抵消或次正规数的情况。当一个量是两个几乎相等的数之差时，相对误差可能被放大，如果真值足够小，计算值甚至可能改变符号。光滑度指示子 $\\beta_k$ 是离散导数和有限差分的平方和；然而，它们的计算版本 $\\widehat{\\beta}_k$ 可能带有扰动 $\\delta_k$，其中 $|\\delta_k| \\lesssim C u S$，这里的 $S$ 是一个由 $u$ 及其离散导数的量级决定的局部尺度。在高阶临界点或常数区域，精确的 $\\beta_k$ 可以小至 $\\mathcal{O}(\\Delta x^2)$，有时甚至为零。\n\n如果相对于这些扰动选择的 $\\varepsilon$ 过小，会出现两种失效机制：\n\n1. 灾难性小的分母和极端不平衡。当 $\\varepsilon \\ll u S$ 且 $\\beta_k \\approx 0$ 时，计算出的和 $\\widehat{\\beta}_k + \\varepsilon$ 主要由舍入误差主导，\n$$\n\\widehat{\\beta}_k + \\varepsilon = \\delta_k + \\varepsilon,\n$$\n其中 $|\\delta_k| \\gtrsim u S$。如果 $|\\delta_k| \\gg \\varepsilon$，那么 $(\\widehat{\\beta}_k + \\varepsilon)^{-p}$ 的量级将是 $(u S)^{-p}$，可能非常大，并且 $\\delta_k$ 之间的微小差异可能导致 $\\alpha_k$ 产生数量级的变化。在归一化过程中，\n$$\n\\omega_k = \\frac{\\alpha_k}{\\sum_j \\alpha_j},\n$$\n对 $\\sum_j \\alpha_j$ 的有限精度求值会遭受有效数字损失：某个 $\\alpha_k$ 可能会占主导地位，而较小的 $\\alpha_j$ 可能会下溢或被舍入为零。虽然如果每个 $\\alpha_k  0$，数学上可以保持正性，但在有限精度下的数值计算可能会产生不精确等于1的 $\\omega_k$ 和，甚至在未使用补偿求和且广义公式中的项发生抵消时，会变得略微为负。这会破坏严格的凸性，并可能在间断附近使重构不稳定。\n\n2. 广义修正因子中的符号错误。在具有 $G_k(\\beta_k,\\varepsilon) = 1 + \\phi\\,\\tau/(\\varepsilon + \\beta_k)$ 的广义形式中，考虑计算出的 $\\widehat{\\beta}_k$ 在常数区域由于舍入误差而带有一个小的负扰动，例如，$\\widehat{\\beta}_k = -\\eta$ 且 $\\eta0$ 很小。如果选择的 $\\varepsilon$ 使得 $\\varepsilon  \\eta$，那么\n$$\n\\widehat{\\beta}_k + \\varepsilon = -(\\eta - \\varepsilon)  0.\n$$\n因为 $\\tau \\ge 0$ 且 $\\phi \\in [0,1]$，修正因子变为\n$$\n\\widehat{G}_k = 1 + \\phi\\,\\frac{\\tau}{\\widehat{\\beta}_k + \\varepsilon} = 1 - \\phi\\,\\frac{\\tau}{\\eta - \\varepsilon}.\n$$\n对于足够光滑的流场，$\\tau$ 可能很小但为正。如果 $\\phi\\,\\tau/(\\eta - \\varepsilon)  1$，那么 $\\widehat{G}_k  0$，即使当 $p=2$ 时也会产生负的 $\\alpha_k$，因为当 $p$ 为偶数时分母 $(\\widehat{\\beta}_k + \\varepsilon)^p$ 是正的，但乘法因子 $\\widehat{G}_k$ 是负的。因此，在有限精度下，过小的 $\\varepsilon$ 会通过修正项使广义权变为负值，而归一化后的 $\\omega_k$ 不再是凸的。\n\n一个具体的数值例子阐明了这一机制。假设在双精度下 $u \\approx 10^{-16}$，一个非常光滑的常数状态产生精确的 $\\beta_k = 0$，但由于有限差分公式中的抵消，计算出的 $\\widehat{\\beta}_k = -10^{-32}$，并且我们选择 $\\varepsilon = 10^{-34}$。那么 $\\widehat{\\beta}_k + \\varepsilon = -9 \\times 10^{-33}$。如果 $\\tau = 10^{-30}$ 且 $\\phi=1$，修正因子为\n$$\n\\widehat{G}_k = 1 + \\frac{10^{-30}}{-9 \\times 10^{-33}} \\approx 1 - 111.1 \\approx -110.1,\n$$\n因此 $\\alpha_k = d_k\\,\\widehat{G}_k / (\\widehat{\\beta}_k + \\varepsilon)^2  0$。这在归一化后会产生一个负的 $\\omega_k$，从而导致一个非凸组合。\n\n从这些机制可以看出，鲁棒的策略必须 (i) 防止 $(\\widehat{\\beta}_k + \\varepsilon)$ 相对于局部浮点尺度变得非正或过小，(ii) 减少 $\\alpha_k$ 之间的灾难性不平衡，以及 (iii) 在最后阶段强制实现凸性。\n\n现在我们来评估各个选项：\n\nA. 这个选项提出了一个自适应的 $\\varepsilon$，它随局部浮点扰动尺度 $u S$ 和局部指示子量级 $\\overline{\\beta}$ 进行缩放，即\n$$\n\\varepsilon = \\max\\!\\big(C_1\\,u\\,S,\\; C_2\\,\\overline{\\beta}\\big),\n$$\n其中 $C_1, C_2$ 是适中的常数。这确保了 $\\varepsilon$ 永远不会小于局部舍入尺度 $u S$，因此当 $\\widehat{\\beta}_k$ 接近零或因舍入而略微为负时，$(\\widehat{\\beta}_k + \\varepsilon)$ 保持为正且有界地远离零。随 $\\overline{\\beta}$ 缩放保留了敏感性：在 $\\beta_k$ 较大的区域，$\\varepsilon$ 成比例增长，不会对权重产生偏倚。将 $\\widehat{\\beta}_k \\leftarrow \\max(\\widehat{\\beta}_k,0)$ 进行截断，强制了光滑度指示子的理论非负性，从而阻止了在广义修正因子中产生负分母的机制。使用补偿求和（例如 Kahan 求和）来计算 $\\sum_j \\alpha_j$ 可以减少有效数字的损失，并防止 $\\omega_k$ 违反和为一的约束。最后，通过将任何残余的负 $\\omega_k$ 设置为零并重新归一化使 $\\sum_k \\omega_k=1$，将其投影回概率单纯形，从而保证了凸性。这种局部缩放、代数正则化、数值稳定的求和以及凸投影的组合，解决了两种已识别的失效模式，并为凸性和改进的稳定性提供了有原则的保证。结论：正确。\n\nB. 设置 $\\varepsilon=0$ 消除了防止在 $\\beta_k\\approx 0$ 时除以零的保障措施，并加剧了在临界点处的舍入效应，使得两种机制都变得更糟。仅靠归一化无法阻止广义形式中出现负权，因为当修正因子为负时，$\\alpha_k$ 在归一化之前就可能为负。结论：不正确。\n\nC. 选择一个与解尺度无关的全局微小 $\\varepsilon$ 会使该格式在任何 $\\beta_k$ 与局部舍入尺度 $u S$ 相当或更小的地方变得脆弱。如前所示，$(\\widehat{\\beta}_k+\\varepsilon)$ 可能为负或灾难性地小，导致权重为负或极度不平衡。一个固定的极小 $\\varepsilon$ 不能保证在各种网格和量级下的凸性或稳定性。结论：不正确。\n\nD. 使用线性权 $\\omega_k=d_k$ 确实总是能产生凸组合，但它放弃了抑制间断附近伪振荡的非线性自适应能力。结果通常是振荡的，并且在存在激波时可能不稳定，因为重构退化为一种本质上是线性的高阶格式。这不满足 WENO 意义上的稳定性要求。结论：不正确。\n\nE. 用 $|\\alpha_k|$ 替换 $\\alpha_k$ 强制了正性，但这破坏了权重的数学结构及其渐近精度性质；广义修正因子中的符号信息并非任意的，取绝对值会引入非物理偏差，并可能导致形式阶的损失、伪耗散和不稳定性。此外，若无进一步措施，它也无法解决灾难性的不平衡问题或确保和为一。结论：不正确。\n\n因此，选项A是直接解决浮点失效机制的鲁棒策略，它在实践中保证了凸性和改进的稳定性，同时保留了对光滑度的敏感性。", "answer": "$$\\boxed{A}$$", "id": "3392148"}]}