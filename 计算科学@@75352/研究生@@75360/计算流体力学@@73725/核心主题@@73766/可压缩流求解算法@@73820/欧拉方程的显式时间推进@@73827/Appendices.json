{"hands_on_practices": [{"introduction": "掌握显式时间推进方法的首要前提是保证数值稳定性。本练习将引导你探索制约稳定性的核心要素——Courant-Friedrichs-Lewy (CFL) 条件，它将时间步长 $\\Delta t$、网格尺寸 $\\Delta x$ 与系统中的物理波速紧密联系起来。通过推导一维欧拉方程的特征速度，你将能亲手计算出显式格式所允许的最大时间步长，这是进行任何流体动力学模拟都必须掌握的关键技能。", "problem": "考虑由守恒形式的欧拉方程描述的一维无粘可压缩流，\n$$\\frac{\\partial \\boldsymbol{U}}{\\partial t} + \\frac{\\partial \\boldsymbol{F}(\\boldsymbol{U})}{\\partial x} = \\boldsymbol{0},$$\n其中守恒变量为\n$$\\boldsymbol{U} = \\begin{pmatrix} \\rho \\\\ \\rho u \\\\ E \\end{pmatrix},$$\n通量为\n$$\\boldsymbol{F}(\\boldsymbol{U}) = \\begin{pmatrix} \\rho u \\\\ \\rho u^{2} + p \\\\ u(E + p) \\end{pmatrix}.$$\n假设气体为量热完全气体，具有恒定的比热比 $\\gamma$ 和热力学封闭关系 $p = (\\gamma - 1)\\left(E - \\tfrac{1}{2}\\rho u^{2}\\right)$。在显式时间推进格式中，Courant-Friedrichs-Lewy (CFL) 条件要求时间步长受系统特征速度（通量雅可比矩阵的特征值）的最大绝对值限制。从控制方程和理想气体假设出发，通过线性化和等熵热力学论证，推导一维欧拉系统的相关特征速度，识别声速，并确定在密度为 $\\rho$、速度为 $u$、压力为 $p$、比热比为 $\\gamma$ 的均匀状态下的最大特征速度。\n\n对由 $\\rho = 1.2$ $\\mathrm{kg\\, m^{-3}}$，$u = 50$ $\\mathrm{m\\, s^{-1}}$，$p = 101325$ $\\mathrm{Pa}$ 和 $\\gamma = 1.4$ 定义的状态，计算该最大特征速度的值。最终答案以 $\\mathrm{m\\, s^{-1}}$ 为单位，并四舍五入到四位有效数字。", "solution": "本问题要求推导一维欧拉方程的特征速度，识别声速，确定最大特征速度，并对给定的流动状态进行求值。分析将首先将欧拉方程从其守恒形式转换为非守恒（准线性）形式，以识别通量雅可比矩阵及其特征值。\n\n一维欧拉方程的守恒形式如下：\n$$\n\\frac{\\partial \\boldsymbol{U}}{\\partial t} + \\frac{\\partial \\boldsymbol{F}(\\boldsymbol{U})}{\\partial x} = \\boldsymbol{0}\n$$\n其中守恒变量矢量 $\\boldsymbol{U}$ 和通量矢量 $\\boldsymbol{F}$ 分别为：\n$$\n\\boldsymbol{U} = \\begin{pmatrix} \\rho \\\\ \\rho u \\\\ E \\end{pmatrix}, \\quad \\boldsymbol{F} = \\begin{pmatrix} \\rho u \\\\ \\rho u^2 + p \\\\ u(E + p) \\end{pmatrix}\n$$\n该系统通过量热完全气体的状态方程进行封闭：\n$$\np = (\\gamma - 1)\\left(E - \\frac{1}{2}\\rho u^2\\right)\n$$\n特征速度是通量雅可比矩阵 $\\boldsymbol{A} = \\frac{\\partial \\boldsymbol{F}}{\\partial \\boldsymbol{U}}$ 的特征值。与其直接计算该矩阵，更方便的做法是使用原始变量（如 $\\boldsymbol{W} = (\\rho, u, p)^T$）将系统转换为准线性形式。该系统可写为 $\\frac{\\partial \\boldsymbol{W}}{\\partial t} + \\boldsymbol{A}'(\\boldsymbol{W}) \\frac{\\partial \\boldsymbol{W}}{\\partial x} = \\boldsymbol{0}$，其中 $\\boldsymbol{A}'$ 的特征值与 $\\boldsymbol{A}$ 的特征值相同。\n\n让我们使用乘法法则从守恒形式展开这三个标量方程：\n$1$. 质量守恒：\n$$\n\\frac{\\partial \\rho}{\\partial t} + \\frac{\\partial (\\rho u)}{\\partial x} = 0 \\implies \\frac{\\partial \\rho}{\\partial t} + u \\frac{\\partial \\rho}{\\partial x} + \\rho \\frac{\\partial u}{\\partial x} = 0\n$$\n该方程已经是用原始变量的导数表示的。\n\n$2$. 动量守恒：\n$$\n\\frac{\\partial (\\rho u)}{\\partial t} + \\frac{\\partial (\\rho u^2 + p)}{\\partial x} = 0 \\implies \\rho \\frac{\\partial u}{\\partial t} + u \\frac{\\partial \\rho}{\\partial t} + 2 \\rho u \\frac{\\partial u}{\\partial x} + u^2 \\frac{\\partial \\rho}{\\partial x} + \\frac{\\partial p}{\\partial x} = 0\n$$\n将质量方程中的 $\\frac{\\partial \\rho}{\\partial t}$ 代入：\n$$\n\\rho \\frac{\\partial u}{\\partial t} + u \\left(-u \\frac{\\partial \\rho}{\\partial x} - \\rho \\frac{\\partial u}{\\partial x}\\right) + 2 \\rho u \\frac{\\partial u}{\\partial x} + u^2 \\frac{\\partial \\rho}{\\partial x} + \\frac{\\partial p}{\\partial x} = 0\n$$\n$$\n\\rho \\frac{\\partial u}{\\partial t} - u^2 \\frac{\\partial \\rho}{\\partial x} - \\rho u \\frac{\\partial u}{\\partial x} + 2 \\rho u \\frac{\\partial u}{\\partial x} + u^2 \\frac{\\partial \\rho}{\\partial x} + \\frac{\\partial p}{\\partial x} = 0\n$$\n化简得到非守恒动量方程：\n$$\n\\rho \\frac{\\partial u}{\\partial t} + \\rho u \\frac{\\partial u}{\\partial x} + \\frac{\\partial p}{\\partial x} = 0 \\implies \\frac{\\partial u}{\\partial t} + u \\frac{\\partial u}{\\partial x} + \\frac{1}{\\rho}\\frac{\\partial p}{\\partial x} = 0\n$$\n\n$3$. 能量守恒：\n$$\n\\frac{\\partial E}{\\partial t} + \\frac{\\partial (u(E+p))}{\\partial x} = 0 \\implies \\frac{\\partial E}{\\partial t} + u \\frac{\\partial E}{\\partial x} + (E+p) \\frac{\\partial u}{\\partial x} + u \\frac{\\partial p}{\\partial x} = 0\n$$\n为了用 $(\\rho, u, p)$ 来表示，我们使用 $E = \\frac{p}{\\gamma-1} + \\frac{1}{2}\\rho u^2$。其导数为：\n$$\n\\frac{\\partial E}{\\partial t} = \\frac{1}{\\gamma-1} \\frac{\\partial p}{\\partial t} + \\frac{1}{2} u^2 \\frac{\\partial \\rho}{\\partial t} + \\rho u \\frac{\\partial u}{\\partial t}\n$$\n$$\n\\frac{\\partial E}{\\partial x} = \\frac{1}{\\gamma-1} \\frac{\\partial p}{\\partial x} + \\frac{1}{2} u^2 \\frac{\\partial \\rho}{\\partial x} + \\rho u \\frac{\\partial u}{\\partial x}\n$$\n将这些代入展开的能量方程。这个过程很长，但最终会得到简化后的非守恒能量方程：\n$$\n\\frac{\\partial p}{\\partial t} + u \\frac{\\partial p}{\\partial x} + \\gamma p \\frac{\\partial u}{\\partial x} = 0\n$$\n\n现在我们将非守恒方程组写成矩阵形式 $\\frac{\\partial \\boldsymbol{W}}{\\partial t} + \\boldsymbol{A}' \\frac{\\partial \\boldsymbol{W}}{\\partial x} = \\boldsymbol{0}$，其中 $\\boldsymbol{W} = (\\rho, u, p)^T$：\n$$\n\\begin{pmatrix} \\frac{\\partial \\rho}{\\partial t} \\\\ \\frac{\\partial u}{\\partial t} \\\\ \\frac{\\partial p}{\\partial t} \\end{pmatrix} + \\begin{pmatrix} u  \\rho  0 \\\\ 0  u  \\frac{1}{\\rho} \\\\ 0  \\gamma p  u \\end{pmatrix} \\begin{pmatrix} \\frac{\\partial \\rho}{\\partial x} \\\\ \\frac{\\partial u}{\\partial x} \\\\ \\frac{\\partial p}{\\partial x} \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix}\n$$\n特征速度 $\\lambda$ 是矩阵 $\\boldsymbol{A}' = \\begin{pmatrix} u  \\rho  0 \\\\ 0  u  \\frac{1}{\\rho} \\\\ 0  \\gamma p  u \\end{pmatrix}$ 的特征值。\n特征值通过求解特征方程 $\\det(\\boldsymbol{A}' - \\lambda \\boldsymbol{I}) = 0$ 得到：\n$$\n\\det \\begin{pmatrix} u-\\lambda  \\rho  0 \\\\ 0  u-\\lambda  \\frac{1}{\\rho} \\\\ 0  \\gamma p  u-\\lambda \\end{pmatrix} = (u-\\lambda) \\left[ (u-\\lambda)^2 - (\\gamma p) \\left(\\frac{1}{\\rho}\\right) \\right] = 0\n$$\n这得到 $(u-\\lambda) \\left[ (u-\\lambda)^2 - \\frac{\\gamma p}{\\rho} \\right] = 0$。\n三个特征值，即特征速度，为：\n$$\n\\lambda_1 = u, \\quad \\lambda_2 = u + \\sqrt{\\frac{\\gamma p}{\\rho}}, \\quad \\lambda_3 = u - \\sqrt{\\frac{\\gamma p}{\\rho}}\n$$\n这就完成了问题的第一部分。\n\n接下来，我们识别声速 $c$。根据热力学定义，声速是等熵压缩波或稀疏波的传播速度，由 $c^2 = \\left( \\frac{\\partial p}{\\partial \\rho} \\right)_s$ 给出，其中 $s$ 是比熵。对于经历等熵过程的量热完全气体，有 $p = K\\rho^\\gamma$，其中 $K$ 是一个常数。将压力对密度求导得到：\n$$\n\\left( \\frac{\\partial p}{\\partial \\rho} \\right)_s = \\frac{d}{d\\rho}(K\\rho^\\gamma) = K \\gamma \\rho^{\\gamma-1} = \\gamma \\frac{p}{\\rho^\\gamma} \\rho^{\\gamma-1} = \\frac{\\gamma p}{\\rho}\n$$\n因此，声速为 $c = \\sqrt{\\frac{\\gamma p}{\\rho}}$。\n现在，特征速度可以用流速 $u$ 和声速 $c$ 来表示：\n$$\n\\lambda_1 = u, \\quad \\lambda_2 = u+c, \\quad \\lambda_3 = u-c\n$$\n这些代表了以速度 $u$ 平流的熵/接触间断，以及相对于流体以速度 $\\pm c$ 传播的声波。\n\n显式格式的 Courant-Friedrichs-Lewy (CFL) 条件取决于特征速度的最大绝对值 $\\lambda_{\\text{max\\_mag}} = \\max(|\\lambda_1|, |\\lambda_2|, |\\lambda_3|)$。即：\n$$\n\\lambda_{\\text{max\\_mag}} = \\max(|u|, |u+c|, |u-c|)\n$$\n由于 $c  0$，可以证明最大值是 $|u+c|$ 或 $|u-c|$。表达式 $|u|+c$ 涵盖了这两种可能性。对于任意实数 $u$ 和 $c$，三角不等式表明 $|u+c| \\leq |u|+|c|$ 和 $|u-c| \\leq |u|+|c|$。\n如果 $u \\ge 0$，则 $|u+c| = u+c$。因为 $c0$，所以 $u+c  u = |u|$ 且 $u+c  |u-c|$。\n如果 $u  0$，则 $|u-c| = |-u+c| = |u|+c$。因为 $c0$，所以 $|u|+c|u|$ 且 $|u|+c|u+c|$。\n在所有情况下，最大绝对值由流速的绝对值与声速之和给出：\n$$\n\\lambda_{\\text{max\\_mag}} = |u| + c\n$$\n\n最后，我们对给定状态计算该最大特征速度：$\\rho = 1.2\\,\\mathrm{kg\\,m^{-3}}$，$u = 50\\,\\mathrm{m\\,s^{-1}}$，$p = 101325\\,\\mathrm{Pa}$，以及 $\\gamma = 1.4$。所有单位均为国际单位制（SI）。\n首先，计算声速 $c$：\n$$\nc = \\sqrt{\\frac{\\gamma p}{\\rho}} = \\sqrt{\\frac{(1.4)(101325\\,\\mathrm{Pa})}{1.2\\,\\mathrm{kg\\,m^{-3}}}} = \\sqrt{\\frac{141855}{1.2}}\\,\\mathrm{m\\,s^{-1}} = \\sqrt{118212.5}\\,\\mathrm{m\\,s^{-1}} \\approx 343.8204\\,\\mathrm{m\\,s^{-1}}\n$$\n现在，计算最大特征速度的绝对值：\n$$\n\\lambda_{\\text{max\\_mag}} = |u| + c = |50\\,\\mathrm{m\\,s^{-1}}| + 343.8204\\,\\mathrm{m\\,s^{-1}} = 50\\,\\mathrm{m\\,s^{-1}} + 343.8204\\,\\mathrm{m\\,s^{-1}} = 393.8204\\,\\mathrm{m\\,s^{-1}}\n$$\n将结果四舍五入到四位有效数字，得到 $393.8\\,\\mathrm{m\\,s^{-1}}$。用科学记数法表示为 $3.938 \\times 10^2\\,\\mathrm{m\\,s^{-1}}$。", "answer": "$$\\boxed{3.938 \\times 10^{2}}$$", "id": "3317302"}, {"introduction": "在保证了稳定性的基础上，我们追求数值格式的精度与分辨率。现代高分辨率格式通过在单元界面上构造精确的数值通量来实现这一目标，这些通量通常是对局部黎曼问题解的近似。本练习将带你构建计算流体力学领域最著名、影响最深远的通量格式之一——Roe 近似黎曼求解器。你将实践 Roe 平均、特征分解以及熵修正等核心技术，这些都是解决复杂可压缩流动问题的必备工具。", "problem": "要求您使用 Roe 近似黎曼求解器，为守恒形式的可压缩欧拉方程实现一个一维显式时间推进的基本模块。质量、动量和总能量的控制守恒定律分别为：$$\\frac{\\partial \\rho}{\\partial t} + \\frac{\\partial (\\rho u)}{\\partial x} = 0,\\quad \\frac{\\partial (\\rho u)}{\\partial t} + \\frac{\\partial (\\rho u^2 + p)}{\\partial x} = 0,\\quad \\frac{\\partial (\\rho E)}{\\partial t} + \\frac{\\partial \\left(u(\\rho E + p)\\right)}{\\partial x} = 0,$$ 其中 $\\rho$ 是密度，$\\,u\\,$ 是速度，$\\,p\\,$ 是压力，$\\,E\\,$ 是单位质量的总能量。假设理想气体的比热比为 $\\,\\gamma > 1\\,$，因此状态方程为 $$p = (\\gamma - 1)\\rho\\left(E - \\tfrac{1}{2}u^2\\right).$$ 定义守恒变量向量 $$U = \\begin{bmatrix} \\rho \\\\ \\rho u \\\\ \\rho E \\end{bmatrix},$$ 以及物理通量向量 $$F(U) = \\begin{bmatrix} \\rho u \\\\ \\rho u^2 + p \\\\ u(\\rho E + p) \\end{bmatrix}.$$\n\n您的任务是在一维空间中，为一个位于左状态和右状态之间的界面构建 Roe 数值通量，然后基于 Courant–Friedrichs–Lewy (CFL) 条件计算显式时间步长。您必须从上述基本定义开始，实现以下步骤：\n\n1. 给定左、右原始状态 $(\\rho_L, u_L, p_L)$ 和 $(\\rho_R, u_R, p_R)$，利用理想气体关系式计算相应的守恒变量 $U_L$ 和 $U_R$ 以及物理通量 $F(U_L)$ 和 $F(U_R)$。同时计算总比焓 $$H_L = E_L + \\frac{p_L}{\\rho_L}, \\quad H_R = E_R + \\frac{p_R}{\\rho_R},$$ 其中 $\\,E_L = \\tfrac{p_L}{(\\gamma - 1)\\rho_L} + \\tfrac{1}{2}u_L^2\\,$ 且 $\\,E_R = \\tfrac{p_R}{(\\gamma - 1)\\rho_R} + \\tfrac{1}{2}u_R^2\\,$。\n\n2. 使用密度平方根加权计算 Roe 平均量：$$\\tilde{u} = \\frac{\\sqrt{\\rho_L}u_L + \\sqrt{\\rho_R}u_R}{\\sqrt{\\rho_L} + \\sqrt{\\rho_R}},\\quad \\tilde{H} = \\frac{\\sqrt{\\rho_L}H_L + \\sqrt{\\rho_R}H_R}{\\sqrt{\\rho_L} + \\sqrt{\\rho_R}},$$ 以及 Roe 平均声速 $$\\tilde{a} = \\sqrt{(\\gamma - 1)\\left(\\tilde{H} - \\tfrac{1}{2}\\tilde{u}^2\\right)}.$$ 使用这些 Roe 平均量，构成特征速度 $$\\tilde{\\lambda}_1 = \\tilde{u} - \\tilde{a},\\quad \\tilde{\\lambda}_2 = \\tilde{u},\\quad \\tilde{\\lambda}_3 = \\tilde{u} + \\tilde{a}.$$ 构建关于 Roe 状态线性化后的一维欧拉方程组的相应右特征向量为 $$\\tilde{r}_1 = \\begin{bmatrix} 1 \\\\ \\tilde{u} - \\tilde{a} \\\\ \\tilde{H} - \\tilde{u}\\tilde{a} \\end{bmatrix},\\quad \\tilde{r}_2 = \\begin{bmatrix} 1 \\\\ \\tilde{u} \\\\ \\tfrac{1}{2}\\tilde{u}^2 \\end{bmatrix},\\quad \\tilde{r}_3 = \\begin{bmatrix} 1 \\\\ \\tilde{u} + \\tilde{a} \\\\ \\tilde{H} + \\tilde{u}\\tilde{a} \\end{bmatrix}.$$\n\n3. 将跨越界面的守恒变量跳跃量 $$\\Delta U = U_R - U_L$$ 通过求解以下方程中的波强度 $\\,\\tilde{\\alpha}_k\\,$，分解为特征波：$$\\Delta U = \\sum_{k=1}^{3} \\tilde{\\alpha}_k \\tilde{r}_k.$$ 使用这些波强度和 Roe 平均特征值来组装 Roe 数值通量。为确保在声速点附近的物理可容许性，为每个特征速度实施 Harten 熵修正：对于选定的平滑参数 $\\,\\delta > 0\\,$，将 $\\,|\\tilde{\\lambda}_k|\\,$ 替换为 $$\\phi(\\tilde{\\lambda}_k;\\delta) = \\begin{cases} \\tfrac{1}{2}\\left(\\frac{\\tilde{\\lambda}_k^2}{\\delta} + \\delta\\right),  \\text{if } |\\tilde{\\lambda}_k|  \\delta, \\\\ |\\tilde{\\lambda}_k|,  \\text{otherwise.} \\end{cases}$$ 选择与局部 Roe 平均声速成正比的 $\\,\\delta\\,$，使得 $\\,\\delta\\,$ 的单位是速度。\n\n4. 使用在第3步中构建的分解以及两侧的物理通量，计算界面处的 Roe 数值通量向量 $$\\hat{F}_{i+1/2} \\in \\mathbb{R}^3,$$ 然后，计算显式时间步长 $$\\Delta t = \\text{CFL}\\,\\frac{\\Delta x}{\\max\\left(|\\tilde{\\lambda}_1|, |\\tilde{\\lambda}_2|, |\\tilde{\\lambda}_3|\\right)},$$ 其中 $\\,\\Delta x\\,$ 是界面处的网格间距，$\\,\\text{CFL}\\,$ 是 Courant–Friedrichs–Lewy 数。\n\n所有量必须以国际单位制 (SI) 表示：密度单位为千克/立方米 ($\\text{kg/m}^3$)，速度单位为米/秒 ($\\text{m/s}$)，压力单位为帕斯卡 ($\\text{Pa}$)，通量如下：质量通量单位为 $\\text{kg/(m}^2\\text{s)}$，动量通量单位为 $\\text{N/m}^2$ (等效于帕斯卡)，能量通量单位为 $\\text{W/m}^2$，时间步长单位为秒 ($\\text{s}$)。比热比固定为 $$\\gamma = 1.4.$$\n\n您的程序必须实现上述过程，并评估以下包含五个案例的测试套件，这些案例探索了典型和边界条件：\n\n- 案例1 (亚声速界面)：$(\\rho_L, u_L, p_L) = (1.0, 50.0, 1.0\\times 10^5)$, $(\\rho_R, u_R, p_R) = (0.8, 20.0, 8.0\\times 10^4)$, $\\Delta x = 1.0\\times 10^{-2}$, $\\text{CFL} = 0.5$。\n- 案例2 (跨声速差异)：$(\\rho_L, u_L, p_L) = (1.0, 300.0, 1.0\\times 10^5)$, $(\\rho_R, u_R, p_R) = (0.5, -50.0, 5.0\\times 10^4)$, $\\Delta x = 5.0\\times 10^{-3}$, $\\text{CFL} = 0.8$。\n- 案例3 (Sod 型激波管)：$(\\rho_L, u_L, p_L) = (1.0, 0.0, 1.0\\times 10^5)$, $(\\rho_R, u_R, p_R) = (0.125, 0.0, 1.0\\times 10^4)$, $\\Delta x = 1.0\\times 10^{-2}$, $\\text{CFL} = 0.9$。\n- 案例4 (接触间断)：$(\\rho_L, u_L, p_L) = (1.0, 100.0, 1.0\\times 10^5)$, $(\\rho_R, u_R, p_R) = (0.1, 100.0, 1.0\\times 10^5)$, $\\Delta x = 2.0\\times 10^{-2}$, $\\text{CFL} = 0.6$。\n- 案例5 (近真空、低压)：$(\\rho_L, u_L, p_L) = (0.01, 10.0, 1.0\\times 10^2)$, $(\\rho_R, u_R, p_R) = (0.02, -5.0, 5.0\\times 10^1)$, $\\Delta x = 1.0\\times 10^{-3}$, $\\text{CFL} = 0.5$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，每个测试案例贡献一个形如 $[\\hat{F}_1, \\hat{F}_2, \\hat{F}_3, \\Delta t]$ 的子列表，分别对应质量、动量和能量通量的分量以及显式时间步长。例如，输出必须如下所示 $$\\big[\\,[f_{11}, f_{12}, f_{13}, t_1], [f_{21}, f_{22}, f_{23}, t_2], \\dots, [f_{51}, f_{52}, f_{53}, t_5]\\,\\big].$$", "solution": "该问题是有效的。它描述了计算流体动力学中的一个适定任务，提供了所有必要的定义、方程和数据。我们可以着手推导和实现 Roe 数值通量及相关的显式时间步长。\n\n该过程涉及计算位于左状态（由下标 $L$ 表示）和右状态（由下标 $R$ 表示）之间的界面上的 Roe 数值通量 $\\hat{F}_{i+1/2}$。此通量是求解欧拉方程的有限体积法中的一个关键组成部分。单元 $i$ 的更新将是 $U_i^{n+1} = U_i^n - \\frac{\\Delta t}{\\Delta x}(\\hat{F}_{i+1/2} - \\hat{F}_{i-1/2})$。本问题专注于构建一个基本模块：通量 $\\hat{F}_{i+1/2}$ 和稳定时间步长 $\\Delta t$。我们将遵循问题陈述中概述的步骤。比热比给定为 $\\gamma = 1.4$。\n\n**第1步：状态变量和物理通量**\n\n给定代表密度、速度和压力的原始变量 $(\\rho, u, p)$，我们首先计算守恒变量及相关的热力学量。单位质量的总能量 $E$ 是从理想气体状态方程 $p = (\\gamma - 1)\\rho(E - \\frac{1}{2}u^2)$ 推导出来的。整理得到 $E$：\n$$E = \\frac{p}{(\\gamma - 1)\\rho} + \\frac{1}{2}u^2$$\n然后为左、右两个状态构建守恒变量向量 $U$：\n$$U_L = \\begin{bmatrix} \\rho_L \\\\ \\rho_L u_L \\\\ \\rho_L E_L \\end{bmatrix}, \\quad U_R = \\begin{bmatrix} \\rho_R \\\\ \\rho_R u_R \\\\ \\rho_R E_R \\end{bmatrix}$$\n同样为两个状态计算物理通量向量 $F(U)$，它代表质量、动量和能量的平流输运：\n$$F(U_L) = \\begin{bmatrix} \\rho_L u_L \\\\ \\rho_L u_L^2 + p_L \\\\ u_L(\\rho_L E_L + p_L) \\end{bmatrix}, \\quad F(U_R) = \\begin{bmatrix} \\rho_R u_R \\\\ \\rho_R u_R^2 + p_R \\\\ u_R(\\rho_R E_R + p_R) \\end{bmatrix}$$\n最后，我们计算每个状态的总比焓 $H$，这是 Roe 平均过程中的一个关键量：\n$$H_L = E_L + \\frac{p_L}{\\rho_L}, \\quad H_R = E_R + \\frac{p_R}{\\rho_R}$$\n\n**第2步：Roe 平均状态和特征结构**\n\nRoe 求解器的核心思想是在界面处定义一个平均状态，以线性化黎曼问题。这个平均状态必须满足通量跳跃量等于平均雅可比矩阵乘以守恒变量跳跃量的性质，即 $\\Delta F = \\tilde{A} \\Delta U$。一种基于密度平方根的特定加权方法可以得到这样的平均值。Roe 平均速度 $\\tilde{u}$ 和焓 $\\tilde{H}$ 为：\n$$\\tilde{u} = \\frac{\\sqrt{\\rho_L}u_L + \\sqrt{\\rho_R}u_R}{\\sqrt{\\rho_L} + \\sqrt{\\rho_R}}$$\n$$\\tilde{H} = \\frac{\\sqrt{\\rho_L}H_L + \\sqrt{\\rho_R}H_R}{\\sqrt{\\rho_L} + \\sqrt{\\rho_R}}$$\n由此计算出 Roe 平均声速 $\\tilde{a}$。这个量由焓的定义和理想气体定律得出：\n$$\\tilde{a} = \\sqrt{(\\gamma - 1)\\left(\\tilde{H} - \\frac{1}{2}\\tilde{u}^2\\right)}$$\n对于物理状态，平方根的参数保证为非负。Roe 矩阵 $\\tilde{A}$ 的特征值是线性化系统的特征速度，代表声波和接触波的速度：\n$$\\tilde{\\lambda}_1 = \\tilde{u} - \\tilde{a}, \\quad \\tilde{\\lambda}_2 = \\tilde{u}, \\quad \\tilde{\\lambda}_3 = \\tilde{u} + \\tilde{a}$$\n相应的右特征向量 $\\tilde{r}_k$ 构成了状态空间 $\\mathbb{R}^3$ 的一组基：\n$$\\tilde{r}_1 = \\begin{bmatrix} 1 \\\\ \\tilde{u} - \\tilde{a} \\\\ \\tilde{H} - \\tilde{u}\\tilde{a} \\end{bmatrix}, \\quad \\tilde{r}_2 = \\begin{bmatrix} 1 \\\\ \\tilde{u} \\\\ \\frac{1}{2}\\tilde{u}^2 \\end{bmatrix}, \\quad \\tilde{r}_3 = \\begin{bmatrix} 1 \\\\ \\tilde{u} + \\tilde{a} \\\\ \\tilde{H} + \\tilde{u}\\tilde{a} \\end{bmatrix}$$\n\n**第3步：波分解和熵修正**\n\n现在，将跨界面的守恒变量跳跃量 $\\Delta U = U_R - U_L$ 投影到 Roe 特征向量的基上。这将跳跃量分解为三个特征波，其强度为 $\\tilde{\\alpha}_k$：\n$$\\Delta U = \\sum_{k=1}^{3} \\tilde{\\alpha}_k \\tilde{r}_k$$\n求解这个关于波强度 $\\tilde{\\alpha}_k$ 的 $3 \\times 3$ 线性系统，得到以下表达式。我们定义跳跃量 $\\Delta\\rho = \\rho_R - \\rho_L$、$\\Delta p = p_R - p_L$ 和 $\\Delta(\\rho u) = (\\rho u)_R - (\\rho u)_L$。波强度为：\n$$\\tilde{\\alpha}_2 = \\Delta\\rho - \\frac{\\Delta p}{\\tilde{a}^2}$$\n$$\\tilde{\\alpha}_1 = \\frac{1}{2\\tilde{a}^2}\\left( \\Delta p - \\tilde{a} (\\Delta(\\rho u) - \\tilde{u}\\Delta\\rho) \\right)$$\n$$\\tilde{\\alpha}_3 = \\frac{1}{2\\tilde{a}^2}\\left( \\Delta p + \\tilde{a} (\\Delta(\\rho u) - \\tilde{u}\\Delta\\rho) \\right)$$\n在特征速度穿过零（声速点）的区域，Roe 格式可能会产生非物理的解，例如膨胀激波。为了修正这个问题，应用了熵修正。每个特征值的绝对值 $|\\tilde{\\lambda}_k|$ 被一个平滑函数 $\\phi(\\tilde{\\lambda}_k; \\delta)$ 替代，该函数在声速点附近增加了数值耗散。对于选定的平滑参数 $\\delta  0$：\n$$\\phi(\\tilde{\\lambda}_k;\\delta) = \\begin{cases} \\frac{1}{2}\\left(\\frac{\\tilde{\\lambda}_k^2}{\\delta} + \\delta\\right),  \\text{if } |\\tilde{\\lambda}_k|  \\delta \\\\ |\\tilde{\\lambda}_k|,  \\text{otherwise} \\end{cases}$$\n参数 $\\delta$ 应具有速度的单位。一个常见且合理的选择是，与问题陈述一致，将其设置为与局部声速成正比，即 $\\delta = C \\tilde{a}$，其中 $C$ 是一个小常数。我们将选择 $C = 0.1$。\n\n**第4步：Roe 数值通量和时间步长**\n\nRoe 数值通量的构造方式是左、右物理通量的平均值，加上一个考虑了跨界面波传播的耗散项。耗散项由波强度和特征向量构成，并由（经过熵修正的）特征速度进行调制。\n$$\\hat{F}_{i+1/2} = \\frac{1}{2}\\left(F(U_L) + F(U_R)\\right) - \\frac{1}{2}\\sum_{k=1}^{3} \\phi(\\tilde{\\lambda}_k; \\delta) \\tilde{\\alpha}_k \\tilde{r}_k$$\n这种公式确保了对于超声速流，通量能正确地退化为迎风物理通量；对于静止激波，它能正确地捕捉跳跃条件。\n\n最后，为使显式时间推进格式保持稳定，时间步长 $\\Delta t$ 必须满足 Courant–Friedrichs–Lewy (CFL) 条件。该条件确保最快的物理波在单个时间步内移动的距离不超过一个网格单元 $(\\Delta x)$。界面处的最大波速为 $|\\tilde{u}| + \\tilde{a}$。\n$$\\Delta t = \\text{CFL}\\,\\frac{\\Delta x}{\\max(|\\tilde{\\lambda}_1|, |\\tilde{\\lambda}_2|, |\\tilde{\\lambda}_3|)} = \\text{CFL}\\,\\frac{\\Delta x}{|\\tilde{u}| + \\tilde{a}}$$\n在一维情况下，为保证稳定性，CFL 数必须小于或等于 $1$；测试案例中给定的值是有效的。\n实现将对每个提供的测试案例遵循这四个步骤。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite for the Roe flux calculation.\n    \"\"\"\n\n    # Test cases: (rho_L, u_L, p_L, rho_R, u_R, p_R, dx, cfl)\n    test_cases = [\n        # Case 1 (subsonic interface)\n        (1.0, 50.0, 1.0e5, 0.8, 20.0, 8.0e4, 1.0e-2, 0.5),\n        # Case 2 (transonic disparity)\n        (1.0, 300.0, 1.0e5, 0.5, -50.0, 5.0e4, 5.0e-3, 0.8),\n        # Case 3 (Sod-type shock tube)\n        (1.0, 0.0, 1.0e5, 0.125, 0.0, 1.0e4, 1.0e-2, 0.9),\n        # Case 4 (contact discontinuity)\n        (1.0, 100.0, 1.0e5, 0.1, 100.0, 1.0e5, 2.0e-2, 0.6),\n        # Case 5 (near-vacuum, low pressure)\n        (0.01, 10.0, 1.0e2, 0.02, -5.0, 5.0e1, 1.0e-3, 0.5),\n    ]\n\n    all_results = []\n    for case in test_cases:\n        result = compute_roe_flux_and_dt(*case)\n        all_results.append(result)\n\n    # Format the final output string as per requirements\n    result_strings = []\n    for res in all_results:\n        # Format each number to avoid scientific notation in some cases for consistency\n        formatted_res = [f\"{val:.8e}\" for val in res]\n        result_strings.append(f\"[{','.join(formatted_res)}]\")\n    \n    final_output = f\"[{','.join(result_strings)}]\"\n    # A cleaner representation without scientific notation where possible can be achieved\n    # with a custom formatter, but the problem does not specify number format,\n    # so we will use a consistent scientific notation.\n    # To provide cleaner output, let's reformat again based on magnitude.\n    final_output_list_of_lists = []\n    for res in all_results:\n        final_output_list_of_lists.append(list(res))\n\n    print(str(final_output_list_of_lists).replace(\" \", \"\"))\n\n\ndef compute_roe_flux_and_dt(rho_L, u_L, p_L, rho_R, u_R, p_R, dx, cfl):\n    \"\"\"\n    Computes the Roe numerical flux and CFL time step for the 1D Euler equations.\n\n    Args:\n        rho_L, u_L, p_L: Left state primitive variables (density, velocity, pressure).\n        rho_R, u_R, p_R: Right state primitive variables.\n        dx: Grid spacing.\n        cfl: CFL number.\n\n    Returns:\n        A list containing the 3 components of the Roe flux vector and the time step dt.\n    \"\"\"\n    gamma = 1.4\n\n    # Step 1: Compute conserved variables, fluxes, and enthalpies\n    \n    # Left state\n    E_L = p_L / ((gamma - 1) * rho_L) + 0.5 * u_L**2\n    U_L = np.array([rho_L, rho_L * u_L, rho_L * E_L])\n    F_L = np.array([rho_L * u_L, rho_L * u_L**2 + p_L, u_L * (rho_L * E_L + p_L)])\n    H_L = E_L + p_L / rho_L\n\n    # Right state\n    E_R = p_R / ((gamma - 1) * rho_R) + 0.5 * u_R**2\n    U_R = np.array([rho_R, rho_R * u_R, rho_R * E_R])\n    F_R = np.array([rho_R * u_R, rho_R * u_R**2 + p_R, u_R * (rho_R * E_R + p_R)])\n    H_R = E_R + p_R / rho_R\n\n    # Step 2: Compute Roe-averaged quantities\n    sqrt_rho_L = np.sqrt(rho_L)\n    sqrt_rho_R = np.sqrt(rho_R)\n    \n    u_tilde = (sqrt_rho_L * u_L + sqrt_rho_R * u_R) / (sqrt_rho_L + sqrt_rho_R)\n    H_tilde = (sqrt_rho_L * H_L + sqrt_rho_R * H_R) / (sqrt_rho_L + sqrt_rho_R)\n    a_tilde = np.sqrt((gamma - 1) * (H_tilde - 0.5 * u_tilde**2))\n\n    # Eigenvalues (characteristic speeds)\n    lambda_tilde = np.array([u_tilde - a_tilde, u_tilde, u_tilde + a_tilde])\n\n    # Eigenvectors\n    r_tilde_1 = np.array([1, u_tilde - a_tilde, H_tilde - u_tilde * a_tilde])\n    r_tilde_2 = np.array([1, u_tilde, 0.5 * u_tilde**2])\n    r_tilde_3 = np.array([1, u_tilde + a_tilde, H_tilde + u_tilde * a_tilde])\n    \n    # Step 3: Decompose jump into characteristic waves and apply entropy fix\n    delta_U = U_R - U_L\n    delta_rho = rho_R - rho_L\n    delta_p = p_R - p_L\n    delta_rho_u = U_R[1] - U_L[1]\n\n    # Wave strengths (alpha_tilde)\n    alpha_tilde_2 = delta_rho - delta_p / a_tilde**2\n    term = a_tilde * (delta_rho_u - u_tilde * delta_rho)\n    alpha_tilde_1 = (delta_p - term) / (2 * a_tilde**2)\n    alpha_tilde_3 = (delta_p + term) / (2 * a_tilde**2)\n\n    # Harten's entropy fix\n    # The smoothing parameter delta is chosen to be proportional to the local\n    # Roe-averaged sound speed. A proportionality constant of 0.1 is a common choice.\n    entropy_fix_coeff = 0.1\n    delta = entropy_fix_coeff * a_tilde \n    \n    phi = np.zeros(3)\n    for k in range(3):\n        if abs(lambda_tilde[k])  delta:\n            phi[k] = 0.5 * (lambda_tilde[k]**2 / delta + delta)\n        else:\n            phi[k] = abs(lambda_tilde[k])\n\n    # Step 4: Compute Roe numerical flux and time step\n    \n    # Dissipation term\n    dissipation = (phi[0] * alpha_tilde_1 * r_tilde_1 + \n                   phi[1] * alpha_tilde_2 * r_tilde_2 + \n                   phi[2] * alpha_tilde_3 * r_tilde_3)\n\n    # Roe flux\n    F_hat = 0.5 * (F_L + F_R) - 0.5 * dissipation\n\n    # Time step from CFL condition\n    max_wave_speed = abs(u_tilde) + a_tilde\n    dt = cfl * dx / max_wave_speed\n\n    return [F_hat[0], F_hat[1], F_hat[2], dt]\n\nsolve()\n```", "id": "3317330"}, {"introduction": "当空间离散完成后，我们将得到一个常微分方程组（即“线方法”），求解的最后一步便是沿时间轴进行积分。本练习聚焦于时间推进部分，通过应用一种高阶强稳定守恒龙格-库塔 (SSPRK) 方法，让你亲身体验解向量是如何从一个时间层推进到下一个的。这清晰地揭示了现代数值方法中，时间积分器在整个求解过程中的运作机制。", "problem": "考虑理想气体的一维可压缩欧拉方程，其比热比为 $\\gamma=1.4$，在均匀网格上通过守恒有限体积法进行离散化。在给定单元中，线法半离散系统的形式为 $\\frac{d}{dt}\\boldsymbol{U}(t)=\\boldsymbol{L}(\\boldsymbol{U}(t))$，其中 $\\boldsymbol{U}=[\\rho, \\rho u, E]^{\\mathsf{T}}$ 是守恒变量：密度 $\\rho$、动量 $\\rho u$ 和单位体积总能量 $E$。总能量通过 $E=\\frac{p}{\\gamma-1}+\\frac{1}{2}\\rho u^{2}$ 与原始变量相关联。\n\n在时刻 $t^{n}$，单元内的原始状态为 $\\rho^{n}=1.0\\ \\text{kg}\\,\\text{m}^{-3}$，$u^{n}=100\\ \\text{m}\\,\\text{s}^{-1}$，$p^{n}=1.0\\times 10^{5}\\ \\text{Pa}$。使用这些值来构建守恒状态 $\\boldsymbol{U}^{n}$。已进行高分辨率通量计算，并且对于此单元，在使用具有三阶段和三阶精度的标准三阶强稳定性保持 Runge–Kutta (SSPRK) 方法 (SSPRK(3,3)) 时，已在相关阶段状态下对半离散残差 $\\boldsymbol{L}(\\cdot)$ 进行了数值评估。得到的残差向量（单位为国际单位制单位/秒）如下：\n- 在初始状态 $\\boldsymbol{U}^{n}$ 时：$\\boldsymbol{L}^{n}=\\begin{pmatrix}-0.80\\\\ 95.0\\\\ -1.20\\times 10^{5}\\end{pmatrix}$。\n- 在第一阶段状态（待计算）时：$\\boldsymbol{L}^{(1)}=\\begin{pmatrix}-0.75\\\\ 92.0\\\\ -1.18\\times 10^{5}\\end{pmatrix}$。\n- 在第二阶段状态（待计算）时：$\\boldsymbol{L}^{(2)}=\\begin{pmatrix}-0.79\\\\ 90.5\\\\ -1.16\\times 10^{5}\\end{pmatrix}$。\n\n取时间步长为 $\\Delta t=1.0\\times 10^{-4}\\ \\text{s}$。从基本守恒和线法公式出发，并使用 SSPRK(3,3) 显式时间推进框架，计算此单元的第一阶段、第二阶段和最终更新的守恒状态。然后，报告更新后的密度 $\\rho^{n+1}$。\n\n将您的最终数值答案四舍五入至六位有效数字。以 $\\text{kg}\\,\\text{m}^{-3}$ 为单位表示最终密度。", "solution": "本题要求使用显式时间推进格式，计算一个时间步长后流体单元的更新状态。控制方程为一维可压缩欧拉方程，已通过守恒有限体积法在空间上进行了半离散化。这为每个单元得到一个常微分方程组（ODE），即线法公式：\n$$ \\frac{d}{dt}\\boldsymbol{U}(t) = \\boldsymbol{L}(\\boldsymbol{U}(t)) $$\n此处，$\\boldsymbol{U} = [\\rho, \\rho u, E]^{\\mathsf{T}}$ 是守恒变量向量：密度 $\\rho$、动量 $\\rho u$ 和单位体积总能量 $E$。项 $\\boldsymbol{L}(\\boldsymbol{U}(t))$ 代表半离散空间算子或残差。\n\n首先，我们必须根据给定的原始变量：$\\rho^{n}=1.0\\ \\text{kg}\\,\\text{m}^{-3}$、$u^{n}=100\\ \\text{m}\\,\\text{s}^{-1}$ 和 $p^{n}=1.0\\times 10^{5}\\ \\text{Pa}$ 来计算 $t^n$ 时刻的初始状态向量 $\\boldsymbol{U}^n$。给定的比热比为 $\\gamma=1.4$。\n\n$\\boldsymbol{U}^n$ 的分量为：\n1.  密度：$\\rho^n = 1.0$\n2.  动量：$(\\rho u)^n = \\rho^n u^n = 1.0 \\times 100 = 100.0$\n3.  总能量：$E^n = \\frac{p^n}{\\gamma-1} + \\frac{1}{2}\\rho^n (u^n)^2$。\n代入给定值：\n$$ E^n = \\frac{1.0\\times 10^{5}}{1.4-1} + \\frac{1}{2}(1.0)(100)^2 = \\frac{1.0\\times 10^{5}}{0.4} + \\frac{1}{2}(10000) = 2.5\\times 10^{5} + 5000 = 255000 $$\n因此，初始守恒状态向量为：\n$$ \\boldsymbol{U}^n = \\begin{pmatrix} 1.0 \\\\ 100.0 \\\\ 2.55 \\times 10^5 \\end{pmatrix} $$\n题目指定使用标准三阶强稳定性保持 Runge-Kutta (SSPRK(3,3)) 方法将解从 $\\boldsymbol{U}^n$ 推进到 $\\boldsymbol{U}^{n+1}$。时间步长为 $\\Delta t = 1.0\\times 10^{-4}\\ \\text{s}$。SSPRK(3,3) 格式按三个阶段进行：\n\n阶段 1：\n$$ \\boldsymbol{U}^{(1)} = \\boldsymbol{U}^{n} + \\Delta t \\boldsymbol{L}(\\boldsymbol{U}^{n}) $$\n阶段 2：\n$$ \\boldsymbol{U}^{(2)} = \\frac{3}{4}\\boldsymbol{U}^{n} + \\frac{1}{4}\\left(\\boldsymbol{U}^{(1)} + \\Delta t \\boldsymbol{L}(\\boldsymbol{U}^{(1)})\\right) $$\n阶段 3 (最终更新)：\n$$ \\boldsymbol{U}^{n+1} = \\frac{1}{3}\\boldsymbol{U}^{n} + \\frac{2}{3}\\left(\\boldsymbol{U}^{(2)} + \\Delta t \\boldsymbol{L}(\\boldsymbol{U}^{(2)})\\right) $$\n题目提供了必要的已求值残差向量：\n$$ \\boldsymbol{L}^{n} = \\boldsymbol{L}(\\boldsymbol{U}^{n}) = \\begin{pmatrix}-0.80\\\\ 95.0\\\\ -1.20\\times 10^{5}\\end{pmatrix}, \\quad \\boldsymbol{L}^{(1)} = \\boldsymbol{L}(\\boldsymbol{U}^{(1)}) = \\begin{pmatrix}-0.75\\\\ 92.0\\\\ -1.18\\times 10^{5}\\end{pmatrix}, \\quad \\boldsymbol{L}^{(2)} = \\boldsymbol{L}(\\boldsymbol{U}^{(2)}) = \\begin{pmatrix}-0.79\\\\ 90.5\\\\ -1.16\\times 10^{5}\\end{pmatrix} $$\n\n我们对每个阶段进行计算。\n\n**计算第一阶段状态 $\\boldsymbol{U}^{(1)}$：**\n我们首先计算增量 $\\Delta t \\boldsymbol{L}^n$：\n$$ \\Delta t \\boldsymbol{L}^n = 1.0\\times 10^{-4} \\begin{pmatrix}-0.80\\\\ 95.0\\\\ -1.20\\times 10^{5}\\end{pmatrix} = \\begin{pmatrix}-0.00008\\\\ 0.0095\\\\ -12.0\\end{pmatrix} $$\n现在，我们求 $\\boldsymbol{U}^{(1)}$：\n$$ \\boldsymbol{U}^{(1)} = \\boldsymbol{U}^{n} + \\Delta t \\boldsymbol{L}^n = \\begin{pmatrix} 1.0 \\\\ 100.0 \\\\ 2.55 \\times 10^5 \\end{pmatrix} + \\begin{pmatrix}-0.00008\\\\ 0.0095\\\\ -12.0\\end{pmatrix} = \\begin{pmatrix} 0.99992 \\\\ 100.0095 \\\\ 254988.0 \\end{pmatrix} $$\n\n**计算第二阶段状态 $\\boldsymbol{U}^{(2)}$：**\n首先，我们计算括号内的项：$\\boldsymbol{U}^{(1)} + \\Delta t \\boldsymbol{L}^{(1)}$。\n$$ \\Delta t \\boldsymbol{L}^{(1)} = 1.0\\times 10^{-4} \\begin{pmatrix}-0.75\\\\ 92.0\\\\ -1.18\\times 10^{5}\\end{pmatrix} = \\begin{pmatrix}-0.000075\\\\ 0.0092\\\\ -11.8\\end{pmatrix} $$\n$$ \\boldsymbol{U}^{(1)} + \\Delta t \\boldsymbol{L}^{(1)} = \\begin{pmatrix} 0.99992 \\\\ 100.0095 \\\\ 254988.0 \\end{pmatrix} + \\begin{pmatrix}-0.000075\\\\ 0.0092\\\\ -11.8\\end{pmatrix} = \\begin{pmatrix} 0.999845 \\\\ 100.0187 \\\\ 254976.2 \\end{pmatrix} $$\n现在，我们应用 $\\boldsymbol{U}^{(2)}$ 的系数：\n$$ \\boldsymbol{U}^{(2)} = \\frac{3}{4} \\begin{pmatrix} 1.0 \\\\ 100.0 \\\\ 2.55 \\times 10^5 \\end{pmatrix} + \\frac{1}{4} \\begin{pmatrix} 0.999845 \\\\ 100.0187 \\\\ 254976.2 \\end{pmatrix} $$\n$$ \\boldsymbol{U}^{(2)} = \\begin{pmatrix} 0.75 \\\\ 75.0 \\\\ 191250.0 \\end{pmatrix} + \\begin{pmatrix} 0.24996125 \\\\ 25.004675 \\\\ 63744.05 \\end{pmatrix} = \\begin{pmatrix} 0.99996125 \\\\ 100.004675 \\\\ 254994.05 \\end{pmatrix} $$\n\n**计算最终更新状态 $\\boldsymbol{U}^{n+1}$：**\n与上一阶段类似，我们首先计算项 $\\boldsymbol{U}^{(2)} + \\Delta t \\boldsymbol{L}^{(2)}$。\n$$ \\Delta t \\boldsymbol{L}^{(2)} = 1.0\\times 10^{-4} \\begin{pmatrix}-0.79\\\\ 90.5\\\\ -1.16\\times 10^{5}\\end{pmatrix} = \\begin{pmatrix}-0.000079\\\\ 0.00905\\\\ -11.6\\end{pmatrix} $$\n$$ \\boldsymbol{U}^{(2)} + \\Delta t \\boldsymbol{L}^{(2)} = \\begin{pmatrix} 0.99996125 \\\\ 100.004675 \\\\ 254994.05 \\end{pmatrix} + \\begin{pmatrix}-0.000079\\\\ 0.00905\\\\ -11.6\\end{pmatrix} = \\begin{pmatrix} 0.99988225 \\\\ 100.013725 \\\\ 254982.45 \\end{pmatrix} $$\n最后，我们应用 $\\boldsymbol{U}^{n+1}$ 的系数：\n$$ \\boldsymbol{U}^{n+1} = \\frac{1}{3} \\begin{pmatrix} 1.0 \\\\ 100.0 \\\\ 2.55 \\times 10^5 \\end{pmatrix} + \\frac{2}{3} \\begin{pmatrix} 0.99988225 \\\\ 100.013725 \\\\ 254982.45 \\end{pmatrix} $$\n$$ \\boldsymbol{U}^{n+1} = \\begin{pmatrix} 1/3 \\\\ 100/3 \\\\ 85000.0 \\end{pmatrix} + \\begin{pmatrix} 0.666588166... \\\\ 66.67581666... \\\\ 169988.3 \\end{pmatrix} = \\begin{pmatrix} 0.999921499... \\\\ 100.0091499... \\\\ 254988.3 \\end{pmatrix} $$\n题目特别要求更新后的密度 $\\rho^{n+1}$，它是最终状态向量 $\\boldsymbol{U}^{n+1}$ 的第一个分量。\n$$ \\rho^{n+1} \\approx 0.9999215 $$\n题目要求将此值四舍五入到六位有效数字。前六位有效数字是 $9, 9, 9, 9, 2, 1$。第七位数字是 $5$，需要将最后一位有效数字进位。\n因此，四舍五入后的值为 $0.999922$。", "answer": "$$\\boxed{0.999922}$$", "id": "3317315"}]}