{"hands_on_practices": [{"introduction": "要掌握一种数值格式，从一个简化的模型方程入手往往是最有效的方法。本练习将Steger-Warming通量分裂的思想应用于无粘Burgers方程，这是一个经典的非线性标量守恒律模型。通过这个练习，你可以在没有欧拉方程组矩阵特征分解的复杂性的情况下，直观地理解根据特征速度的符号来分离通量，并将其与信息传播的上游方向联系起来的核心逻辑。[@problem_id:3366264]", "problem": "考虑由无粘伯格斯方程给出的标量非线性双曲守恒律，$u_{t} + f(u)_{x} = 0$，其中 $f(u) = \\tfrac{1}{2} u^{2}$。局部特征速度定义为通量对守恒变量的导数，即 $a(u) \\equiv \\dfrac{d f}{d u}(u)$。Steger–Warming 通量矢量分裂通过将特征速度分解为向右和向左传播的部分，然后分别使用来自左态和右态的相应分裂通量，来构造单元界面处的数值通量。具体来说，界面处的数值通量取为 $f^{+}(u_{L}) + f^{-}(u_{R})$，其中 $f^{\\pm}(u)$ 是特征速度正部和负部的反导数，并进行归一化使得 $f^{+}(0) = 0$ 和 $f^{-}(0) = 0$。\n\n从这些原理和定义出发（不使用任何现成的通量分裂公式），推导无粘伯格斯方程的 $f^{+}(u)$ 和 $f^{-}(u)$ 的显式表达式。然后，对于左态 $u_{L} = 2$ 和右态 $u_{R} = -1$ 的黎曼界面，计算数值通量 $f^{+}(u_{L}) + f^{-}(u_{R})$。\n\n此外，在你的推导过程中，解释对于给定的每个状态，哪一侧（左侧或右侧）为界面提供了迎风信息，并根据特征速度的符号证明你的解释。你最终报告的答案必须是通量的单个数值。不要对答案进行四舍五入。", "solution": "首先对问题陈述进行验证。\n\n**第1步：提取已知条件**\n- 守恒律：$u_{t} + f(u)_{x} = 0$。\n- 通量函数：$f(u) = \\tfrac{1}{2} u^{2}$。\n- 特征速度：$a(u) \\equiv \\dfrac{d f}{d u}(u)$。\n- Steger-Warming 数值通量定义：$F = f^{+}(u_{L}) + f^{-}(u_{R})$。\n- 分裂通量定义：$\\dfrac{d f^{+}}{d u}(u) = a^{+}(u)$，其中 $a^{+}(u)$ 是 $a(u)$ 的正部；以及 $\\dfrac{d f^{-}}{d u}(u) = a^{-}(u)$，其中 $a^{-}(u)$ 是 $a(u)$ 的负部。\n- 归一化条件：$f^{+}(0) = 0$ 和 $f^{-}(0) = 0$。\n- 黎曼问题的界面状态：左态 $u_{L} = 2$ 和右态 $u_{R} = -1$。\n\n**第2步：使用提取的已知条件进行验证**\n该问题具有科学依据，因为无粘伯格斯方程是非线性双曲偏微分方程的一个典型模型，而Steger-Warming通量矢量分裂是计算流体动力学中一种成熟的数值方法。所提供的特征速度定义和分裂通量的构造是标准的且数学上一致的。该问题是适定的，提供了推导唯一数值答案所需的所有必要信息（偏微分方程、通量函数、定义、归一化条件和具体状态）。语言客观而精确。该问题不违反任何指定的无效标准。\n\n**第3步：结论与行动**\n问题有效。将提供完整解答。\n\n解答过程分为三部分：首先，推导分裂通量函数 $f^{+}(u)$ 和 $f^{-}(u)$；其次，对给定状态下迎风贡献的物理解释；第三，计算数值通量。\n\n**第1部分：分裂通量函数的推导**\n\n标量守恒律由 $u_{t} + (f(u))_x = 0$ 给出，通量函数为 $f(u) = \\frac{1}{2}u^2$。\n特征速度 $a(u)$ 是通量函数对守恒变量 $u$ 的导数：\n$$\na(u) = \\frac{d f}{d u} = \\frac{d}{d u} \\left(\\frac{1}{2}u^2\\right) = u\n$$\nSteger-Warming 分裂格式将此速度分解为其正部和负部，分别表示为 $a^{+}(u)$ 和 $a^{-}(u)$。\n$$\na^{+}(u) = \\max(a(u), 0) = \\max(u, 0)\n$$\n$$\na^{-}(u) = \\min(a(u), 0) = \\min(u, 0)\n$$\n可以分段表示为：\n$$\na^{+}(u) = \n\\begin{cases}\n    u  \\text{ if } u > 0 \\\\\n    0  \\text{ if } u \\le 0\n\\end{cases}\n$$\n$$\na^{-}(u) = \n\\begin{cases}\n    0  \\text{ if } u > 0 \\\\\n    u  \\text{ if } u \\le 0\n\\end{cases}\n$$\n分裂通量函数 $f^{+}(u)$ 和 $f^{-}(u)$ 分别是 $a^{+}(u)$ 和 $a^{-}(u)$ 的反导数。我们使用指定的归一化条件 $f^{+}(0) = 0$ 和 $f^{-}(0) = 0$ 来确定积分常数。这等效于执行从 $0$ 到 $u$ 的定积分。\n\n对于 $f^{+}(u)$：\n$$\nf^{+}(u) = \\int_{0}^{u} a^{+}(s) \\, ds\n$$\n如果 $u > 0$，积分路径在 $a^{+}(s) = s$ 的正值上：\n$$\nf^{+}(u) = \\int_{0}^{u} s \\, ds = \\left[ \\frac{1}{2}s^2 \\right]_{0}^{u} = \\frac{1}{2}u^2\n$$\n如果 $u \\le 0$，积分路径在 $a^{+}(s) = 0$ 的非正值上：\n$$\nf^{+}(u) = \\int_{0}^{u} 0 \\, ds = 0\n$$\n结合这些，我们得到正分裂通量的表达式：\n$$\nf^{+}(u) = \n\\begin{cases}\n    \\frac{1}{2}u^2  \\text{ if } u > 0 \\\\\n    0  \\text{ if } u \\le 0\n\\end{cases}\n$$\n对于 $f^{-}(u)$：\n$$\nf^{-}(u) = \\int_{0}^{u} a^{-}(s) \\, ds\n$$\n如果 $u > 0$，积分路径在 $a^{-}(s) = 0$ 的正值上：\n$$\nf^{-}(u) = \\int_{0}^{u} 0 \\, ds = 0\n$$\n如果 $u \\le 0$，积分路径在 $a^{-}(s) = s$ 的非正值上：\n$$\nf^{-}(u) = \\int_{0}^{u} s \\, ds = \\left[ \\frac{1}{2}s^2 \\right]_{0}^{u} = \\frac{1}{2}u^2\n$$\n结合这些，我们得到负分裂通量的表达式：\n$$\nf^{-}(u) = \n\\begin{cases}\n    0  \\text{ if } u > 0 \\\\\n    \\frac{1}{2}u^2  \\text{ if } u \\le 0\n\\end{cases}\n$$\n作为一致性检查，我们验证 $f^{+}(u) + f^{-}(u) = f(u)$。对于 $u > 0$，$f^{+}(u) + f^{-}(u) = \\frac{1}{2}u^2 + 0 = \\frac{1}{2}u^2$。对于 $u \\le 0$，$f^{+}(u) + f^{-}(u) = 0 + \\frac{1}{2}u^2 = \\frac{1}{2}u^2$。该性质对所有 $u \\in \\mathbb{R}$ 均成立。\n\n**第2部分：迎风信息的解释**\n\n特征速度 $a(u)$ 控制信息传播的方向。\n- 如果 $a(u) > 0$，信息从左向右传播。“迎风”方向来自左侧。\n- 如果 $a(u)  0$，信息从右向左传播。“迎风”方向来自右侧。\n\nSteger-Warming 通量 $F = f^{+}(u_{L}) + f^{-}(u_{R})$ 是基于此原理构建的。$f^{+}(u_{L})$ 项与向右传播的波（正速度）相关联，因此使用来自左态 $u_L$ 的信息。$f^{-}(u_{R})$ 项与向左传播的波（负速度）相关联，因此使用来自右态 $u_R$ 的信息。\n\n对于给定的黎曼问题，我们有 $u_L = 2$ 和 $u_R = -1$。\n- 对于左态 $u_L=2$：特征速度为 $a(u_L) = u_L = 2$。由于 $a(u_L) > 0$，源于左态的界面处信息向右传播。因此，左态为向右传播的波提供迎风信息。该分裂方法通过在通量中使用 $f^{+}(u_L)$ 来捕捉这一点。\n- 对于右态 $u_R=-1$：特征速度为 $a(u_R) = u_R = -1$。由于 $a(u_R)  0$，源于右态的界面处信息向左传播。因此，右态为向左传播的波提供迎风信息。该分裂方法通过在通量中使用 $f^{-}(u_R)$ 来捕捉这一点。\n\n在这种特定情况下，来自界面左侧和右侧的特征线都指向界面，这是激波的特征。左态 $u_L$ 和右态 $u_R$ 都为界面提供迎风信息。\n\n**第3部分：数值通量的计算**\n\n界面处的数值通量由 $F = f^{+}(u_{L}) + f^{-}(u_{R})$ 给出。我们将给定值 $u_{L} = 2$ 和 $u_{R} = -1$ 代入推导出的 $f^{+}$ 和 $f^{-}$ 的表达式中。\n\n首先，我们计算 $f^{+}(u_{L}) = f^{+}(2)$。由于 $u_{L} = 2 > 0$，我们使用 $f^{+}$ 公式的相应分支：\n$$\nf^{+}(2) = \\frac{1}{2}(2)^2 = \\frac{1}{2}(4) = 2\n$$\n接下来，我们计算 $f^{-}(u_{R}) = f^{-}(-1)$。由于 $u_{R} = -1 \\le 0$，我们使用 $f^{-}$ 公式的相应分支：\n$$\nf^{-}(-1) = \\frac{1}{2}(-1)^2 = \\frac{1}{2}(1) = \\frac{1}{2}\n$$\n最后，我们将这两个分量相加得到总数值通量：\n$$\nF = f^{+}(2) + f^{-}(-1) = 2 + \\frac{1}{2} = \\frac{5}{2}\n$$\n界面处的数值通量为 $\\frac{5}{2}$。", "answer": "$$\\boxed{\\frac{5}{2}}$$", "id": "3366264"}, {"introduction": "构成Steger-Warming分裂基础的特征值不仅仅是理论上的构造，它们代表了真实的物理波速。本练习揭示了这些波速在计算流体力学中的一个关键实际应用：通过Courant–Friedrichs–Lewy (CFL) 条件来确保显式时间积分格式的数值稳定性。掌握CFL条件的计算是运行任何显式格式模拟所必需的基本技能。[@problem_id:3366259]", "problem": "考虑理想气体的一维可压缩欧拉方程，将采用基于 Steger–Warming 通量矢量分裂的有限体积法进行离散化。一个代表性单元中的守恒状态由密度 $\\,\\rho = 1\\,\\mathrm{kg/m^3}\\,$、速度 $\\,u = 50\\,\\mathrm{m/s}\\,$ 和压力 $\\,p = 10^{5}\\,\\mathrm{Pa}\\,$ 给出。比热比为 $\\,\\gamma = 1.4\\,$。空间网格是均匀的，间距为 $\\,\\Delta x = 0.01\\,\\mathrm{m}\\,$。您将使用显式时间积分器，并寻求一个满足 Courant–Friedrichs–Lewy (CFL) 条件的时间步长，该条件与作为 Steger–Warming 通量分裂基础的特征波速相一致。\n\n从欧拉方程的守恒律形式和理想气体关系式出发，使用一维欧拉系统的适用特征速度界限，确定满足给定 CFL 数 $\\,\\mathrm{CFL} = 0.9\\,$ 的最大稳定时间步长 $\\,\\Delta t\\,$（以秒为单位）。请将您的最终答案以秒为单位表示，并四舍五入到四位有效数字。", "solution": "该问题要求确定在一维欧拉方程的有限体积离散化中，受限于指定的 Courant–Friedrichs–Lewy (CFL) 数的最大稳定时间步长 $\\Delta t$。对于双曲守恒律方程组，显式时间积分格式的稳定性由 CFL 条件决定。对于一维问题，该条件表示为：\n$$ \\mathrm{CFL} = \\frac{S_{\\max} \\Delta t}{\\Delta x} \\le \\mathrm{CFL}_{\\mathrm{limit}} $$\n其中 $\\Delta t$ 是时间步长，$\\Delta x$ 是空间网格间距，而 $S_{\\max}$ 是计算域内的最大信号传播速度。为了找到最大稳定时间步长，我们使用与给定 CFL 数的等式关系：\n$$ \\Delta t = \\mathrm{CFL} \\frac{\\Delta x}{S_{\\max}} $$\n该问题是在一维可压缩欧拉方程的背景下提出的。该系统的特征速度是通量雅可比矩阵的特征值，由 $\\lambda_1 = u - c$、$\\lambda_2 = u$ 和 $\\lambda_3 = u + c$ 给出，其中 $u$ 是流体速度，$c$ 是声速。Steger–Warming 通量矢量分裂方法明确地基于这些特征值的性质。\n\n最大信号速度 $S_{\\max}$ 是这些特征速度绝对值的最大值：\n$$ S_{\\max} = \\max (|\\lambda_1|, |\\lambda_2|, |\\lambda_3|) = \\max (|u-c|, |u|, |u+c|) $$\n由于声速 $c$ 本质上是非负的，该表达式可简化为：\n$$ S_{\\max} = |u| + c $$\n对于理想气体，声速 $c$ 是根据压力 $p$、密度 $\\rho$ 和比热比 $\\gamma$ 使用以下公式计算的：\n$$ c = \\sqrt{\\gamma \\frac{p}{\\rho}} $$\n问题为代表性单元提供了以下数据：\n- 密度: $\\rho = 1\\,\\mathrm{kg/m^3}$\n- 速度: $u = 50\\,\\mathrm{m/s}$\n- 压力: $p = 10^{5}\\,\\mathrm{Pa}$\n- 比热比: $\\gamma = 1.4$\n- 空间网格间距: $\\Delta x = 0.01\\,\\mathrm{m}$\n- 给定的 CFL 数: $\\mathrm{CFL} = 0.9$\n\n首先，我们计算单元内的声速 $c$：\n$$ c = \\sqrt{(1.4) \\frac{10^5\\,\\mathrm{Pa}}{1\\,\\mathrm{kg/m^3}}} = \\sqrt{1.4 \\times 10^5\\,\\mathrm{m^2/s^2}} = \\sqrt{140000}\\,\\mathrm{m/s} \\approx 374.1657\\,\\mathrm{m/s} $$\n接下来，我们使用给定的速度 $u = 50\\,\\mathrm{m/s}$ 来确定最大特征速度 $S_{\\max}$：\n$$ S_{\\max} = |50\\,\\mathrm{m/s}| + 374.1657\\,\\mathrm{m/s} = 50\\,\\mathrm{m/s} + 374.1657\\,\\mathrm{m/s} = 424.1657\\,\\mathrm{m/s} $$\n最后，我们将 $\\mathrm{CFL}$、$\\Delta x$ 和 $S_{\\max}$ 的值代入时间步长 $\\Delta t$ 的方程中：\n$$ \\Delta t = (0.9) \\frac{0.01\\,\\mathrm{m}}{424.1657\\,\\mathrm{m/s}} = \\frac{0.009}{424.1657}\\,\\mathrm{s} \\approx 2.121543 \\times 10^{-5}\\,\\mathrm{s} $$\n问题要求答案四舍五入到四位有效数字。\n$$ \\Delta t \\approx 2.122 \\times 10^{-5}\\,\\mathrm{s} $$\n这是在给定条件下，对欧拉方程进行显式时间积分可以使用的最大稳定时间步长。", "answer": "$$ \\boxed{2.122 \\times 10^{-5}} $$", "id": "3366259"}, {"introduction": "对数值格式的深入理解不仅包括如何使用它，更重要的是要认识到它的固有局限性。Steger-Warming格式的一个著名缺陷是在处理接触间断时会产生过度的数值耗散。本练习引导你通过定义一个“有效耗散系数” $D_{\\mathrm{eff}}$ 来定量分析这一问题，从而能够批判性地评估该格式在特定物理情境下的表现，这是从用户到开发者思维转变的关键一步。[@problem_id:3366237]", "problem": "考虑理想气体的一维可压缩欧拉方程，它是一个守恒律方程组，构成了守恒状态向量 $U = [\\rho, \\rho u, E]^{\\top}$ 的偏微分方程 (PDE) 系统，其中 $\\rho$ 是密度， $u$ 是速度，$E$ 是总能量。其通量为 $F(U) = [\\rho u, \\rho u^2 + p, u(E + p)]^{\\top}$，其中 $p$ 是热力学压力，受理想气体定律 $p = (\\gamma - 1)\\left(E - \\tfrac{1}{2}\\rho u^2\\right)$ 的约束，$\\gamma$ 为比热比。控制方程可写作 $\\partial_t U + \\partial_x F(U) = 0$。这种设定在计算流体动力学 (CFD) 中是经典的。\n\n您的任务是使用 Steger–Warming 通量矢量分裂 (FVS) 方法来分析接触间断的解析情况。在欧拉方程的纯接触间断中，速度 $u$ 和压力 $p$ 在间断两侧是均匀的，而密度 $\\rho$ 是间断的。假设在两个相邻单元之间存在一个黎曼界面，其左状态为 $U_L$，右状态为 $U_R$，且接触间断在给定时间到达此界面。Steger–Warming (FVS) 界面通量是通过根据特征波的方向性分裂通量贡献而形成的，它使用了通量雅可比矩阵 $A(U) = \\partial F/\\partial U$ 的特征分解：\n- 定义 $A(U)$ 的右特征向量矩阵 $R(U)$ 和特征值矩阵 $\\Lambda(U)$，使得 $A(U) = R(U)\\Lambda(U)R(U)^{-1}$，其特征值为 $\\lambda_1 = u - c$，$\\lambda_2 = u$ 和 $\\lambda_3 = u + c$，其中 $c = \\sqrt{\\gamma p/\\rho}$ 是当地声速。\n- 通过 $\\Lambda^+(U) = \\mathrm{diag}(\\max(\\lambda_1,0), \\max(\\lambda_2,0), \\max(\\lambda_3,0))$ 和 $\\Lambda^-(U) = \\mathrm{diag}(\\min(\\lambda_1,0), \\min(\\lambda_2,0), \\min(\\lambda_3,0))$ 定义对角特征值矩阵的正部和负部。\n- 定义分裂通量算子 $A^\\pm(U) = R(U)\\Lambda^\\pm(U)R(U)^{-1}$ 和分裂通量 $F^\\pm(U) = A^\\pm(U)U$。\n- 于是，Steger–Warming 界面通量为 $F_{\\mathrm{SW}}(U_L,U_R) = F^+(U_L) + F^-(U_R)$。\n\n当一个具有均匀 $u$ 和 $p$ 的接触间断到达界面时，穿过界面的精确物理质量通量等于 $f_{\\text{up}} = u\\,\\rho_{\\text{up}}$，其中 $\\rho_{\\text{up}}$ 是迎风密度，即如果 $u > 0$，则 $\\rho_{\\text{up}} = \\rho_L$；如果 $u  0$，则 $\\rho_{\\text{up}} = \\rho_R$。Steger–Warming 通量 $F_{\\mathrm{SW}}$ 通常会引入数值耗散，从而涂抹接触间断。通过在界面处定义离散的菲克关系，来量化质量守恒方程中的数值耗散量，并定义有效扩散系数 $D_{\\mathrm{eff}}$：\n$$\nf_{\\mathrm{SW,\\,mass}} \\;=\\; f_{\\text{up}} \\;-\\; D_{\\mathrm{eff}}\\,\\frac{\\rho_R - \\rho_L}{\\Delta x},\n$$\n其中，$f_{\\mathrm{SW,\\,mass}}$ 是 $F_{\\mathrm{SW}}(U_L,U_R)$ 的质量分量（第一个分量），$\\Delta x$ 是均匀的单元尺寸。求解 $D_{\\mathrm{eff}}$：\n$$\nD_{\\mathrm{eff}} \\;=\\; \\frac{f_{\\text{up}} - f_{\\mathrm{SW,\\,mass}}}{(\\rho_R - \\rho_L)/\\Delta x}.\n$$\n\n本问题中的所有变量都是无量纲的，因此不需要物理单位。问题不涉及角度和百分比。\n\n任务：\n- 从欧拉方程的守恒律形式和基于通量雅可比矩阵特征分解的 Steger–Warming 通量矢量分裂定义出发，编写一个程序，为代表接触间断（$u$ 和 $p$ 相同，$\\rho$ 不同）的一组给定的左右状态，计算单个界面上的 $D_{\\mathrm{eff}}$。\n- 对每个测试用例，使用上述 $D_{\\mathrm{eff}}$ 的定义来量化接触间断的耗散。\n\n测试套件：\n对于每个测试用例，给定 $(\\gamma, u, p, \\rho_L, \\rho_R, \\Delta x)$：\n- 用例 1：$(\\gamma, u, p, \\rho_L, \\rho_R, \\Delta x) = (\\,1.4,\\, 0.5,\\, 1.0,\\, 1.0,\\, 2.0,\\, 1.0\\,)$。\n- 用例 2：$(\\gamma, u, p, \\rho_L, \\rho_R, \\Delta x) = (\\,1.4,\\, -0.5,\\, 1.0,\\, 2.0,\\, 1.0,\\, 1.0\\,)$。\n- 用例 3：$(\\gamma, u, p, \\rho_L, \\rho_R, \\Delta x) = (\\,1.4,\\, 0.0,\\, 1.0,\\, 0.8,\\, 1.2,\\, 0.5\\,)$。\n- 用例 4：$(\\gamma, u, p, \\rho_L, \\rho_R, \\Delta x) = (\\,1.4,\\, 0.5324471805,\\, 1.0,\\, 1.0,\\, 4.0,\\, 1.0\\,)$。\n\n约束和指令：\n- 在每个用例中，将气体视为具有给定 $\\gamma$ 的理想气体。\n- 对于左右两侧，使用 $E = \\dfrac{p}{\\gamma - 1} + \\dfrac{1}{2}\\rho u^2$ 从 $(\\rho, u, p)$ 构建 $U_L$ 和 $U_R$。\n- 严格按照 $F^+(U_L) + F^-(U_R)$ 计算 $F_{\\mathrm{SW}}$，其中 $F^\\pm(U) = R(U)\\Lambda^\\pm(U)R(U)^{-1}U$ 是通过相应侧的欧拉通量雅可比矩阵的特征分解定义的。\n- 计算 $f_{\\text{up}} = u\\,\\rho_{\\text{up}}$，其中如果 $u > 0$，则 $\\rho_{\\text{up}} = \\rho_L$；如果 $u  0$，则 $\\rho_{\\text{up}} = \\rho_R$；如果 $u = 0$，则 $f_{\\text{up}} = 0$。\n- 使用上述表达式计算 $D_{\\mathrm{eff}}$。你可以假设在测试套件中 $\\rho_R \\ne \\rho_L$，因此分母不为零。\n\n最终输出格式：\n- 你的程序应生成单行输出，其中包含四个测试用例的 $D_{\\mathrm{eff}}$ 结果，形式为方括号内以逗号分隔的列表，每个数字都四舍五入到小数点后八位。例如，正确形式的输出行为 $[\\;d_1, d_2, d_3, d_4\\;]$，每个 $d_k$ 都格式化为八位小数。\n- 程序必须是完全自包含的，不接受任何输入，并直接打印结果行。\n\n目标是通过分析接触间断到达界面时的离散通量，系统地评估 Steger–Warming 通量矢量分裂方法如何耗散接触间断，并为指定用例量化数值耗散为 $D_{\\mathrm{eff}}$。", "solution": "该问题要求计算 Steger–Warming 通量矢量分裂 (FVS) 格式应用于一维欧拉方程中的接触间断时的有效数值扩散系数 $D_{\\mathrm{eff}}$。问题设置涉及一个左状态 $U_L$ 和右状态 $U_R$ 之间的界面，其特征是速度 $u$ 和压力 $p$ 均匀，但密度不连续，即 $\\rho_L \\neq \\rho_R$。\n\n有效扩散系数 $D_{\\mathrm{eff}}$ 由以下关系定义：\n$$\nf_{\\mathrm{SW,\\,mass}} \\;=\\; f_{\\text{up}} \\;-\\; D_{\\mathrm{eff}}\\,\\frac{\\rho_R - \\rho_L}{\\Delta x}\n$$\n其中 $f_{\\mathrm{SW,\\,mass}}$ 是 Steger–Warming 界面通量 $F_{\\mathrm{SW}}(U_L, U_R)$ 的质量通量分量，$f_{\\text{up}}$ 是精确的迎风质量通量，$\\Delta x$ 是网格间距。整理得到 $D_{\\mathrm{eff}}$ 的表达式：\n$$\nD_{\\mathrm{eff}} \\;=\\; \\frac{f_{\\text{up}} - f_{\\mathrm{SW,\\,mass}}}{(\\rho_R - \\rho_L)/\\Delta x}\n$$\n主要任务是推导出 $f_{\\mathrm{SW,\\,mass}}$ 的显式表达式，以便于计算。\n\nSteger–Warming 界面通量定义为 $F_{\\mathrm{SW}}(U_L, U_R) = F^+(U_L) + F^-(U_R)$。分裂通量 $F^\\pm(U)$ 由 $F^\\pm(U) = A^\\pm(U) U$ 给出，其中 $A^\\pm(U) = R(U) \\Lambda^\\pm(U) R(U)^{-1}$。此处，$R(U)$ 是通量雅可比矩阵 $A(U) = \\partial F/\\partial U$ 的右特征向量矩阵，$\\Lambda^\\pm(U)$ 是包含 $A(U)$ 特征值正部和负部的对角矩阵。\n\n一种更直接计算 $F^\\pm(U)$ 的方法是利用状态向量 $U$ 在 $A(U)$ 的右特征向量基 $\\{r_1, r_2, r_3\\}$ 上的展开：\n$$\nU = \\sum_{k=1}^{3} \\alpha_k r_k\n$$\n其中系数 $\\alpha_k$ 是向量 $R^{-1}U$ 的分量。应用算子 $A^\\pm(U)$ 可得：\n$$\nF^\\pm(U) = A^\\pm(U) U = \\left(R \\Lambda^\\pm R^{-1}\\right) \\left(\\sum_{k=1}^{3} \\alpha_k r_k\\right) = R \\Lambda^\\pm \\left(\\sum_{k=1}^{3} \\alpha_k (R^{-1}r_k)\\right)\n$$\n由于 $R^{-1}r_k$ 是第 $k$ 个标准基向量 $e_k$，上式可简化为：\n$$\nF^\\pm(U) = R \\left(\\sum_{k=1}^{3} \\alpha_k \\lambda_k^\\pm e_k\\right) = \\sum_{k=1}^{3} \\alpha_k \\lambda_k^\\pm (R e_k) = \\sum_{k=1}^{3} \\alpha_k \\lambda_k^\\pm r_k\n$$\n其中 $\\lambda_k^\\pm$ 是特征值 $\\lambda_k$ 的正部/负部。\n\n对于一维欧拉方程，$A(U)$ 的特征值为 $\\lambda_1 = u - c$，$\\lambda_2 = u$ 和 $\\lambda_3 = u + c$，其中 $c = \\sqrt{\\gamma p/\\rho}$ 是声速。相应的右特征向量 $r_k$（$R$ 的列向量）和特征系数 $\\alpha_k$（$R^{-1}U$ 的分量）是标准结果：\n$$\nr_1 = \\begin{pmatrix} 1 \\\\ u-c \\\\ H-uc \\end{pmatrix}, \\quad r_2 = \\begin{pmatrix} 1 \\\\ u \\\\ u^2/2 \\end{pmatrix}, \\quad r_3 = \\begin{pmatrix} 1 \\\\ u+c \\\\ H+uc \\end{pmatrix}\n$$\n和\n$$\n\\alpha_1 = \\frac{\\rho}{2\\gamma}, \\quad \\alpha_2 = \\rho\\left(\\frac{\\gamma-1}{\\gamma}\\right), \\quad \\alpha_3 = \\frac{\\rho}{2\\gamma}\n$$\n其中 $H = \\frac{E+p}{\\rho} = \\frac{c^2}{\\gamma-1} + \\frac{u^2}{2}$ 是总焓。\n\n我们关心的是质量通量分量，即通量向量的第一个分量。每个右特征向量 $r_k$ 的第一个分量都是 $1$。因此，分裂通量 $F^\\pm(U)$ 的质量分量是：\n$$\n(F^\\pm(U))_1 = \\sum_{k=1}^{3} \\alpha_k \\lambda_k^\\pm (r_k)_1 = \\sum_{k=1}^{3} \\alpha_k \\lambda_k^\\pm\n$$\n代入 $\\alpha_k$ 的表达式：\n$$\n(F^\\pm(U))_1 = \\frac{\\rho}{2\\gamma}\\lambda_1^\\pm + \\rho\\left(\\frac{\\gamma-1}{\\gamma}\\right)\\lambda_2^\\pm + \\frac{\\rho}{2\\gamma}\\lambda_3^\\pm\n$$\n界面上的总 Steger–Warming 质量通量是左状态的正部和右状态的负部之和：\n$$\nf_{\\mathrm{SW,\\,mass}} = (F^+(U_L))_1 + (F^-(U_R))_1\n$$\n其中\n$$\n(F^+(U_L))_1 = \\frac{\\rho_L}{2\\gamma}\\lambda_{1,L}^+ + \\rho_L\\frac{\\gamma-1}{\\gamma}\\lambda_{2,L}^+ + \\frac{\\rho_L}{2\\gamma}\\lambda_{3,L}^+\n$$\n$$\n(F^-(U_R))_1 = \\frac{\\rho_R}{2\\gamma}\\lambda_{1,R}^- + \\rho_R\\frac{\\gamma-1}{\\gamma}\\lambda_{2,R}^- + \\frac{\\rho_R}{2\\gamma}\\lambda_{3,R}^-\n$$\n特征值是为每个状态计算的：$\\lambda_{k,L}$ 使用 $(u, c_L)$ 计算，$\\lambda_{k,R}$ 使用 $(u, c_R)$ 计算，其中 $c_L = \\sqrt{\\gamma p/\\rho_L}$ 和 $c_R = \\sqrt{\\gamma p/\\rho_R}$。分裂特征值为 $\\lambda_k^+ = \\max(\\lambda_k, 0)$ 和 $\\lambda_k^- = \\min(\\lambda_k, 0)$。\n\n精确的迎风质量通量 $f_{\\text{up}}$ 定义为：\n$$\nf_{\\text{up}} =\n\\begin{cases}\nu\\,\\rho_L   \\text{if } u > 0 \\\\\nu\\,\\rho_R   \\text{if } u  0 \\\\\n0   \\text{if } u = 0\n\\end{cases}\n$$\n利用这些表达式，可以通过以下步骤为每个测试用例计算 $D_{\\mathrm{eff}}$：\n1.  对每个状态（L 和 R），计算声速 $c$ 和特征值 $\\lambda_1, \\lambda_2, \\lambda_3$。\n2.  对左状态，计算特征值的正部 $\\lambda_{k,L}^+$ 并计算 $(F^+(U_L))_1$。\n3.  对右状态，计算特征值的负部 $\\lambda_{k,R}^-$ 并计算 $(F^-(U_R))_1$。\n4.  将这些贡献相加得到 $f_{\\mathrm{SW,\\,mass}}$。\n5.  根据 $u$ 的符号计算 $f_{\\text{up}}$。\n6.  将所有值代入 $D_{\\mathrm{eff}}$ 的公式中。\n\n此过程为解决该问题提供了一个完整而系统的方法。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef _calculate_split_flux_mass(rho, u, p, gamma, is_positive_part):\n    \"\"\"\n    Calculates the mass component of the split Euler flux F^+ or F^-.\n\n    This function implements the formula:\n    (F^±)_1 = Σ (α_k * λ_k^±)\n    where α are characteristic coefficients and λ are eigenvalues.\n\n    Args:\n        rho (float): Density.\n        u (float): Velocity.\n        p (float): Pressure.\n        gamma (float): Ratio of specific heats.\n        is_positive_part (bool): If True, computes F^+ component.\n                                 If False, computes F^- component.\n\n    Returns:\n        float: The mass component of the specified split flux.\n    \"\"\"\n    c = np.sqrt(gamma * p / rho)\n\n    # Eigenvalues of the flux Jacobian\n    lambda_1 = u - c\n    lambda_2 = u\n    lambda_3 = u + c\n\n    # Split eigenvalues\n    if is_positive_part:\n        lambda_split_1 = max(lambda_1, 0.0)\n        lambda_split_2 = max(lambda_2, 0.0)\n        lambda_split_3 = max(lambda_3, 0.0)\n    else:  # Negative part\n        lambda_split_1 = min(lambda_1, 0.0)\n        lambda_split_2 = min(lambda_2, 0.0)\n        lambda_split_3 = min(lambda_3, 0.0)\n\n    # Characteristic coefficients for the mass component\n    alpha_1 = rho / (2.0 * gamma)\n    alpha_2 = rho * (gamma - 1.0) / gamma\n    alpha_3 = rho / (2.0 * gamma)\n    \n    # Mass flux component is the sum of (alpha_k * lambda_k^±)\n    flux_mass = (alpha_1 * lambda_split_1 +\n                 alpha_2 * lambda_split_2 +\n                 alpha_3 * lambda_split_3)\n    \n    return flux_mass\n\ndef solve():\n    \"\"\"\n    Computes the effective numerical diffusivity for the Steger-Warming scheme\n    at a contact discontinuity for a given set of test cases.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (gamma, u, p, rho_L, rho_R, delta_x)\n        (1.4, 0.5, 1.0, 1.0, 2.0, 1.0),\n        (1.4, -0.5, 1.0, 2.0, 1.0, 1.0),\n        (1.4, 0.0, 1.0, 0.8, 1.2, 0.5),\n        (1.4, 0.5324471805, 1.0, 1.0, 4.0, 1.0),\n    ]\n\n    results = []\n    for case in test_cases:\n        gamma, u, p, rho_L, rho_R, dx = case\n\n        # 1. Calculate the exact upwind mass flux\n        if u > 0.0:\n            f_up = u * rho_L\n        elif u  0.0:\n            f_up = u * rho_R\n        else:\n            f_up = 0.0\n\n        # 2. Calculate the Steger-Warming mass flux at the interface\n        # F_sw = F^+(U_L) + F^-(U_R)\n        f_sw_mass_p_L = _calculate_split_flux_mass(rho_L, u, p, gamma, is_positive_part=True)\n        f_sw_mass_m_R = _calculate_split_flux_mass(rho_R, u, p, gamma, is_positive_part=False)\n        \n        f_sw_mass = f_sw_mass_p_L + f_sw_mass_m_R\n        \n        # 3. Calculate the effective numerical diffusivity\n        # Denominator is guaranteed to be non-zero by problem constraints.\n        density_gradient = (rho_R - rho_L) / dx\n        D_eff = (f_up - f_sw_mass) / density_gradient\n        \n        results.append(D_eff)\n\n    # Final print statement in the exact required format.\n    formatted_results = [f\"{res:.8f}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "3366237"}]}