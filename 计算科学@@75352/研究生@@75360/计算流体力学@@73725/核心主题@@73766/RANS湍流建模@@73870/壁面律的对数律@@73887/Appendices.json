{"hands_on_practices": [{"introduction": "在应用壁面律之前，我们必须首先掌握近壁区域的“语言”——壁面单位。这项练习将帮助你熟练计算壁面湍流分析的两个基本尺度：摩擦速度 $u_{\\tau}$ 和无量纲壁面距离 $y^+$。理解这些量是如何从基本的流动参数中派生出来的，是后续所有壁面模化和分析工作的基础 [@problem_id:3375922]。", "problem": "考虑在计算流体动力学环境中，空气在光滑平坦壁面上形成的充分发展的湍流边界层。假设通过高保真度近壁评估得知，壁面剪切应力为 $\\tau_{w}=0.5$ Pa，质量密度为 $\\rho=1.2$ kg/m$^{3}$，运动粘度为 $\\nu=1.5\\times 10^{-5}$ m$^{2}$/s，所有这些参数均在相同的热力学状态下。在距离壁面法向距离 $y=1$ mm 处，使用基本定义引入近壁速度尺度和相应的内坐标（或称壁面单位坐标）。从将壁面剪切应力解释为单位面积的动量通量，以及通过平衡粘性扩散与近壁剪切得到的粘性长度尺度的概念出发。给出速度尺度和壁面单位坐标的表达式，然后使用给定参数对它们进行求值。最后，讨论计算出的壁面单位坐标是否位于对数律壁面法则通常在光滑壁面上的高雷诺数湍流边界层中适用的范围内。\n\n将速度尺度以 m/s 为单位表示，壁面单位坐标表示为无量纲数。将两个数值都四舍五入到四位有效数字。", "solution": "该问题是有效的，因为它科学地基于流体动力学原理，特别是湍流边界层理论，问题设定良好，数据充分且一致，并且表述客观。我们可以着手求解。\n\n该问题要求分析湍流边界层的近壁区域。此分析的关键是使用内尺度变换，该方法基于从壁面特性派生出的特征尺度来对变量进行归一化。\n\n首先，我们考虑壁面剪切应力 $\\tau_w$。这个量表示流体施加在壁面上的单位面积切向力。从量纲的角度来看，其单位是力除以面积，在国际单位制基本单位中为 $\\text{kg} \\cdot \\text{m}^{-1} \\cdot \\text{s}^{-2}$。在动量的背景下，$\\tau_w$ 可以被解释为从流体到壁面的单位面积动量传递率（通量）。给定流体密度 $\\rho$，其单位为质量除以体积（$\\text{kg} \\cdot \\text{m}^{-3}$），比值 $\\frac{\\tau_w}{\\rho}$ 的单位是 $(\\text{kg} \\cdot \\text{m}^{-1} \\cdot \\text{s}^{-2}) / (\\text{kg} \\cdot \\text{m}^{-3}) = \\text{m}^2 \\cdot \\text{s}^{-2}$，这对应于速度的平方。这引出了近壁区域特征速度尺度的定义，即摩擦速度 $u_{\\tau}$：\n$$u_{\\tau} = \\sqrt{\\frac{\\tau_w}{\\rho}}$$\n\n接下来，我们建立一个特征长度尺度。在紧邻壁面的区域（粘性子层），动量传递主要由粘性扩散主导。控制该扩散的参数是运动粘度 $\\nu$，单位为 $\\text{m}^2 \\cdot \\text{s}^{-1}$。通过平衡特征速度 $u_{\\tau}$ 和运动粘度 $\\nu$，我们可以构成一个长度尺度。粘性长度尺度 $\\delta_{\\nu}$ 定义为：\n$$\\delta_{\\nu} = \\frac{\\nu}{u_{\\tau}}$$\n这个长度尺度衡量了粘性效应占主导地位区域的厚度。\n\n利用这两个尺度，我们可以定义无量纲变量，也称为内坐标或壁面单位。无量纲法向距离，记为 $y^+$，是物理距离 $y$ 被粘性长度尺度 $\\delta_{\\nu}$ 归一化后的结果。\n$$y^{+} = \\frac{y}{\\delta_{\\nu}} = \\frac{y u_{\\tau}}{\\nu}$$\n问题要求计算速度尺度 $u_{\\tau}$ 和壁面单位坐标 $y^+$。\n\n给定的参数是：\n- 壁面剪切应力，$\\tau_{w} = 0.5 \\text{ Pa} = 0.5 \\text{ kg} \\cdot \\text{m}^{-1} \\cdot \\text{s}^{-2}$\n- 质量密度，$\\rho = 1.2 \\text{ kg} \\cdot \\text{m}^{-3}$\n- 运动粘度，$\\nu = 1.5 \\times 10^{-5} \\text{ m}^2 \\cdot \\text{s}^{-1}$\n- 法向距离， $y = 1 \\text{ mm} = 1 \\times 10^{-3} \\text{ m}$\n\n首先，我们计算摩擦速度 $u_{\\tau}$：\n$$u_{\\tau} = \\sqrt{\\frac{0.5}{1.2}} = \\sqrt{0.41666...} \\approx 0.64549722 \\text{ m/s}$$\n四舍五入到四位有效数字，速度尺度为：\n$$u_{\\tau} \\approx 0.6455 \\text{ m/s}$$\n\n接下来，我们计算无量纲壁面单位坐标 $y^+$：\n$$y^{+} = \\frac{y u_{\\tau}}{\\nu} = \\frac{(1 \\times 10^{-3}) \\times (0.64549722)}{1.5 \\times 10^{-5}}$$\n$$y^{+} = \\frac{0.64549722 \\times 10^{-3}}{1.5 \\times 10^{-5}} = \\frac{0.64549722}{1.5} \\times 10^2 \\approx 43.033148$$\n四舍五入到四位有效数字，壁面单位坐标为：\n$$y^{+} \\approx 43.03$$\n\n最后，我们讨论计算出的 $y^+$ 值是否位于对数律壁面法则适用的区域内。光滑壁面上的高雷诺数湍流边界层的近壁区域通常根据 $y^+$ 的值进行分层：\n1.  **粘性子层 (Viscous Sublayer):** 对于 $y^{+} \\lesssim 5$，粘性应力主导湍流雷诺应力。平均速度剖面是线性的，由 $u^{+} = y^{+}$ 给出，其中 $u^{+}$ 是无量纲速度 $u/u_{\\tau}$。\n2.  **缓冲层 (Buffer Layer):** 对于 $5 \\lesssim y^{+} \\lesssim 30$，粘性应力和湍流应力的大小相当。这是粘性子层和对数区之间的过渡区域。\n3.  **对数区 (Log-Law Region):** 对于 $y^{+} \\gtrsim 30$ （并延伸至总边界层厚度的某个分数，例如 $y/\\delta  0.2$），湍流应力占主导地位。平均速度剖面由对数律描述：\n    $$u^{+} = \\frac{1}{\\kappa} \\ln(y^{+}) + B$$\n    其中 $\\kappa \\approx 0.41$ 是冯·卡门常数（von Kármán constant），$B \\approx 5.0$ 是光滑壁面的积分常数。\n\n我们计算出的值为 $y^{+} \\approx 43.03$。该值大于 $30$，正好位于对数区内。因此，在给定的流动条件下，应用对数律壁面法则来估计指定法向距离 $y = 1$ mm 处的平均速度是物理上一致且恰当的。", "answer": "$$\\boxed{\\begin{pmatrix} 0.6455  43.03 \\end{pmatrix}}$$", "id": "3375922"}, {"introduction": "这项练习将理论与高保真模拟（如大涡模拟，LES）中网格生成的实际挑战联系起来。通过计算将第一个网格点放置在粘性子层内（例如，$y^+=1$）所需的物理网格尺寸，我们可以直观地感受到解析近壁区域的巨大计算成本，这有助于我们理解为何在工程应用中，壁面模型往往是不可或缺的 [@problem_id:3375933]。", "problem": "考虑由恒定平均压力梯度驱动的，密度为 $\\rho$、运动粘度为 $\\nu$ 的不可压缩流体的统计定常、充分发展的湍流槽道流。设壁面剪切应力为 $\\tau_{w}$，摩擦速度定义为 $u_{\\tau}=\\sqrt{\\tau_{w}/\\rho}$。在基于壁面单位的内尺度标度中，粘性长度尺度为 $\\delta_{\\nu}$，壁面单位下的法向坐标为 $y^{+}$。对于壁面解析的大涡模拟（LES），近壁网格间距通常由一个目标 $y^{+}$ 指定，以确保第一个离壁节点位于粘性子层内，并且壁面律的对数律可以在较大的 $y^{+}$ 处得到精确表示。\n\n从上述定义出发，不使用任何经验速度剖面公式，推导与给定的 $y^{+}$ 相对应的物理第一层网格高度 $\\Delta y$ 的表达式。然后，对于 $u_{\\tau}=0.5~\\text{m/s}$，$\\nu=1.0\\times 10^{-5}~\\text{m}^{2}/\\text{s}$ 和目标 $y^{+}=1$，计算 $\\Delta y$。将您的数值答案四舍五入至三位有效数字，并以米为单位表示。最后，（在您的推导中定性地）简要讨论在这些条件下，对于半高为 $h=0.1~\\text{m}$ 的槽道，在解析壁面律对数律预期成立的区域方面，进行壁面解析LES的可行性。", "solution": "壁湍流的典型内尺度标度由壁面剪切应力 $\\tau_{w}$ 和流体属性构建。摩擦速度定义为\n$$\nu_{\\tau} \\equiv \\sqrt{\\frac{\\tau_{w}}{\\rho}}.\n$$\n通过平衡粘性效应和惯性效应，可以构成一个粘性长度尺度，\n$$\n\\delta_{\\nu} \\equiv \\frac{\\nu}{u_{\\tau}}.\n$$\n由该粘性长度尺度无量纲化的壁面法向坐标为\n$$\ny^{+} \\equiv \\frac{y}{\\delta_{\\nu}}.\n$$\n代入 $\\delta_{\\nu}=\\nu/u_{\\tau}$ 得到标准的内坐标定义\n$$\ny^{+} = \\frac{y\\,u_{\\tau}}{\\nu}.\n$$\n给定第一个离壁节点的目标 $y^{+}$，通过对上述方程求解 $y$ 可得到相应的物理第一层网格高度 $\\Delta y$，\n$$\n\\Delta y = y = \\frac{y^{+}\\,\\nu}{u_{\\tau}}.\n$$\n当 $u_{\\tau}=0.5~\\text{m/s}$，$\\nu=1.0\\times 10^{-5}~\\text{m}^{2}/\\text{s}$ 且 $y^{+}=1$ 时，我们计算\n$$\n\\Delta y = \\frac{(1)\\,(1.0\\times 10^{-5}~\\text{m}^{2}/\\text{s})}{0.5~\\text{m/s}} = 2.0\\times 10^{-5}~\\text{m}.\n$$\n以米为单位，四舍五入至三位有效数字，结果仍为 $2.00\\times 10^{-5}~\\text{m}$。\n\n为了评估在半高为 $h=0.1~\\text{m}$ 的槽道中进行壁面解析大涡模拟（LES）的可行性，考虑摩擦雷诺数\n$$\nRe_{\\tau} \\equiv \\frac{u_{\\tau}\\,h}{\\nu} = \\frac{(0.5~\\text{m/s})(0.1~\\text{m})}{1.0\\times 10^{-5}~\\text{m}^{2}/\\text{s}} = 5.0\\times 10^{3}.\n$$\n这是一个高的 $Re_{\\tau}$。第一层网格高度 $\\Delta y=2.0\\times 10^{-5}~\\text{m}$ 相对于 $h=0.1~\\text{m}$ 极小，其比值为\n$$\n\\frac{h}{\\Delta y} = \\frac{0.1~\\text{m}}{2.0\\times 10^{-5}~\\text{m}} = 5.0\\times 10^{3} = Re_{\\tau}.\n$$\n如果在 $y$ 方向使用均匀间距，需要大约 $5.0\\times 10^{3}$ 个网格单元才能达到中心线，这在计算上是不切实际的。即使采用激进的壁面法向拉伸，近壁加密区也必须保持 $\\Delta y^{+}\\approx 1$ 以解析粘性子层，并且网格必须在整个缓冲层和对数律层（通常从 $y^{+}\\gtrsim 30$ 左右开始）保持足够精细，以捕捉与壁面律对数律相关的平均剖面和湍流结构。结合通常以壁面单位表示的流向和展向分辨率要求，在 $Re_{\\tau}\\approx 5.0\\times 10^{3}$ 时，总网格数会变得非常大。因此，虽然计算出的 $\\Delta y$ 很直接，但在这些条件下进行壁面解析LES通常被认为具有挑战性，并且在典型的计算资源下往往是不可行的；对于如此高的 $Re_{\\tau}$ 槽道流，通常采用壁面模化LES或其他替代方法。", "answer": "$$\\boxed{2.00 \\times 10^{-5}}$$", "id": "3375933"}, {"introduction": "虽然依赖于对数律的壁面函数是避免高昂壁面解析成本的实用方案，但它们并非放之四海而皆准。本练习揭示了一个关键的陷阱：在对数律无效的区域（如缓冲层）应用它 [@problem_id:3391066]。通过编写一个简单的数值实验，我们可以量化这种不当应用所导致的壁面剪切应力的显著误差，从而加深对模型适用范围的理解。", "problem": "考虑一个靠近固体壁面的统计定常、充分发展的湍流，使用雷诺平均纳维-斯托克斯 (RANS) 封闭模型进行建模，并对其进行一维壁面法向离散化。第一个单元中心距离壁面为 $y_1$，单元厚度均匀为 $\\Delta y$，因此 $y_1 = \\Delta y/2$。假设流体是牛顿流体，具有恒定的密度 $\\rho$ 和运动粘度 $\\nu$，摩擦速度定义为 $u_\\tau = \\sqrt{\\tau_w/\\rho}$，其中 $\\tau_w$ 是壁面剪切应力。定义内尺度变量 $y^+ = y u_\\tau/\\nu$ 和 $U^+ = U/u_\\tau$，其中 $U$ 是平均流向速度。\n\n作为一个经过充分检验的物理事实，在粘性子层中，平均速度满足 $U^+ \\approx y^+$；在对数层中，平均速度满足 $U^+ \\approx \\frac{1}{\\kappa} \\ln(y^+) + B$，其中 $\\kappa$ 是冯·卡门常数，B 是一个经验截距。许多 RANS 封闭模型中的标准壁面函数在第一个离壁点上施加对数关系，以推断壁面剪切应力。\n\n您的任务是，基于上述定义和事实，通过一个纯粹的数学和算法构造来证明：当使用标准壁面函数（壁面对数律）时，将第一个节点放置在 $y^+ \\approx 5$ 处会引入不一致性，并估计由此导致的 $\\tau_w$ 误差。对每个测试案例，按以下步骤进行：\n\n1. 将 $(\\rho,\\nu,u_\\tau)$ 作为给定常数。对于一个指定的目标 $y_1^+$，构建一个网格，其 $\\Delta y$ 满足 $y_1 = \\Delta y/2$ 且 $y_1^+ = y_1 u_\\tau/\\nu$ 等于该目标值。这意味着 $\\Delta y = 2 y_1$ 且 $y_1 = \\dfrac{y_1^+ \\, \\nu}{u_\\tau}$。\n2. 在 $y_1$ 处生成一个合成的“真实”平均速度 $U$，该速度与以下参考近壁行为一致：\n   - 若 $y_1^+ \\leq 5$，使用粘性子层关系 $U^+ = y^+$，设置 $U = u_\\tau \\, y_1^+$。\n   - 若 $y_1^+ \\geq 30$，使用对数关系 $U^+ = \\dfrac{1}{\\kappa} \\ln(y^+) + B$，设置 $U = u_\\tau \\left(\\dfrac{1}{\\kappa} \\ln(y_1^+) + B\\right)$。\n   - $5  y^+  30$ 之间的过渡区不在本测试套件中使用，因此不需要额外的建模。\n3. 通过在 $y_1$ 处反解对数关系，从 $U$ 估计一个“推断”的摩擦速度 $\\hat{u}_\\tau$，从而模拟标准壁面函数对壁面剪切应力的推断。具体来说，是在以下非线性方程中求解 $\\hat{u}_\\tau$：\n   $$ \\frac{U}{\\hat{u}_\\tau} = \\frac{1}{\\kappa} \\ln\\left(\\frac{y_1 \\hat{u}_\\tau}{\\nu}\\right) + B. $$\n   然后计算推断的壁面剪切应力 $\\hat{\\tau}_w = \\rho \\, \\hat{u}_\\tau^2$。\n4. 计算真实壁面剪切应力 $\\tau_w = \\rho \\, u_\\tau^2$ 和相对误差\n   $$ e = \\frac{\\hat{\\tau}_w - \\tau_w}{\\tau_w}. $$\n   将 $e$ 以小数形式报告。\n\n使用常数 $\\rho = 1000$ (单位 $\\mathrm{kg/m^3}$)，$\\nu = 10^{-6}$ (单位 $\\mathrm{m^2/s}$)，$u_\\tau = 0.2$ (单位 $\\mathrm{m/s}$)，$\\kappa = 0.41$ 和 $B = 5.2$。通过指定 $y_1^+$ 目标值来构建以下四个测试案例：\n- 案例 A（深层粘性子层）：$y_1^+ = 0.5$。\n- 案例 B（靠近粘性层-对数层过渡区）：$y_1^+ = 5$。\n- 案例 C（对数层入口）：$y_1^+ = 30$。\n- 案例 D（深入对数层）：$y_1^+ = 100$。\n\n对于每个案例，执行上述步骤并计算相对误差 $e$（无量纲）。您的程序应产生单行输出，其中包含四个相对误差，形式为方括号括起来的逗号分隔列表，每个值四舍五入到六位小数，例如 \"$[e_A,e_B,e_C,e_D]$\"。不应打印任何其他文本或格式。所有使用物理单位的中间量应与指定单位保持内部一致，壁面剪切应力 $\\tau_w$ 的单位是 $\\mathrm{Pa}$；报告的相对误差 $e$ 是无量纲的，并且必须表示为小数。", "solution": "目标是量化当第一个近壁节点位于 $y^+ \\approx 5$ 处，却施加基于对数律的标准壁面函数来推断壁面剪切应力时所引入的不一致性。我们从近壁湍流的基本定义和经过充分检验的事实出发。\n\n首先，根据壁面剪切应力 $\\tau_w$ 定义摩擦速度 $u_\\tau = \\sqrt{\\tau_w/\\rho}$。通过内尺度 $y^+ = y \\, u_\\tau/\\nu$ 和 $U^+ = U/u_\\tau$ 引入壁面单位。在靠近壁面的统计定常、充分发展的湍流中，平均动量方程在紧邻壁面的区域得以简化，因为与粘性应力相比，雷诺剪切应力可以忽略不计。因此，总应力约等于粘性应力，即 $\\tau \\approx \\mu \\, \\dfrac{dU}{dy}$，其中 $\\mu = \\rho \\nu$ 是动力粘度。对这种近壁行为进行积分，可以得到经过充分检验的粘性子层关系 $U^+ \\approx y^+$（适用于 $y^+ \\lesssim 5$）。\n\n在远离壁面的地方，使用混合长度封闭模型（雷诺平均纳维-斯托克斯建模中一个被广泛接受的基础）的经验和理论论证导出了边界层平衡区中的壁面对数律，$U^+ \\approx \\dfrac{1}{\\kappa}\\ln(y^+) + B$（适用于 $y^+ \\gtrsim 30$），其中 $\\kappa$ 是冯·卡门常数，B 是一个经验截距。这两个经过充分检验的事实构成了许多计算流体力学壁面处理方法的基础。\n\n一个典型的“标准壁面函数”在第一个离壁点上施加对数关系，以便从距离壁面 $y_1$ 处计算出的平均速度 $U$ 来推断 $u_\\tau$（并由此推断 $\\tau_w$）。摩擦速度 $u_\\tau$ 本身控制着内尺度 $y^+$，这意味着在给定 $U$ 和 $y_1$ 的情况下求解 $u_\\tau$ 时存在非线性。如果第一个节点位于粘性子层内，用对数关系替代线性关系会产生不一致性。我们通过比较由一致的近壁关系计算出的“真实”壁面剪切应力与通过反解对数律获得的“推断”壁面剪切应力来量化这种不一致性。\n\n基于这些原理的算法步骤如下：\n\n1. 固定物理常数 $\\rho$、$\\nu$、$\\kappa$、$B$ 和一个表征目标流场的“真实”摩擦速度 $u_\\tau$。真实的壁面剪切应力为 $\\tau_w = \\rho \\, u_\\tau^2$。\n2. 对于每个目标 $y_1^+$，计算网格间距，使得根据具有均匀单元的一维壁面法向离散化，第一个单元中心位于 $y_1 = \\dfrac{y_1^+ \\, \\nu}{u_\\tau}$ 且 $\\Delta y = 2 y_1$。\n3. 通过选择与已知 $u_\\tau$ 一致的适当近壁关系，在 $y_1$ 处生成一个合成的“真实”平均速度 $U$：\n   - 若 $y_1^+ \\leq 5$，使用粘性子层：$U^+ = y_1^+ \\Rightarrow U = u_\\tau \\, y_1^+$。\n   - 若 $y_1^+ \\geq 30$，使用对数律：$U^+ = \\dfrac{1}{\\kappa}\\ln(y_1^+) + B \\Rightarrow U = u_\\tau\\left(\\dfrac{1}{\\kappa}\\ln(y_1^+) + B\\right)$。\n4. 通过求解在 $y_1$ 处施加的对数关系，得到推断的摩擦速度 $\\hat{u}_\\tau$，从而模拟标准壁面函数。需要求解的方程是\n   $$ g(\\hat{u}_\\tau) = \\frac{U}{\\hat{u}_\\tau} - \\left[\\frac{1}{\\kappa} \\ln\\left(\\frac{y_1 \\hat{u}_\\tau}{\\nu}\\right) + B\\right] = 0, $$\n   该方程对于 $\\hat{u}_\\tau  0$ 是良态的，因为第一项随 $\\hat{u}_\\tau$ 增大而减小，第二项呈对数增长，这确保了根的唯一性。可以使用稳健的数值方法，如 Brent 布伦特包围法，在一个宽区间内（例如，在一个小的正下界和一个大的上界之间）找到根，因为对于物理上合理的输入，$g$ 在这样的范围内会表现出符号变化。\n5. 计算推断的壁面剪切应力 $\\hat{\\tau}_w = \\rho \\, \\hat{u}_\\tau^2$ 和相对误差\n   $$ e = \\frac{\\hat{\\tau}_w - \\tau_w}{\\tau_w}. $$\n   这个误差是无量纲的，直接量化了在第一个节点使用对数律所引入的不一致性。\n6. 将此程序应用于旨在探究不同区域的四个测试案例：\n   - $y_1^+ = 0.5$ （深层粘性子层，预计有大的不一致性），\n   - $y_1^+ = 5$ （靠近过渡区，我们感兴趣的案例），\n   - $y_1^+ = 30$ （对数区入口，预计具有一致性），\n   - $y_1^+ = 100$ （深入对数区，预计具有一致性）。\n7. 在指定的单行格式中，将误差 $e$ 报告为一个包含四个小数的列表，每个小数四舍五入到六位小数。\n\n科学解释：对于 $y_1^+ \\leq 5$，真实的 $U^+$ 随 $y^+$ 线性增长，而对数律仅呈对数增长。当使用一个实际上与同一位置的线性律一致的速度来反解对数关系时，为了使观测到的较大的 $U/u_\\tau$ 与对数表达式相协调，推断出的 $\\hat{u}_\\tau$ 相对于真实的 $u_\\tau$ 会减小，导致对 $\\hat{\\tau}_w$ 的大幅低估。相反，对于 $y_1^+ \\geq 30$，如果 $U$ 与对数律一致，反解同一个定律会重现正确的 $u_\\tau$，因此在 $\\tau_w$ 中产生的误差可以忽略不计。这证明了在使用标准壁面函数时，将第一个节点放置得太靠近壁面所带来的不一致性。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import brentq\n\ndef solve():\n    # Physical and model constants (units: rho [kg/m^3], nu [m^2/s], u_tau [m/s])\n    rho = 1000.0\n    nu = 1e-6\n    u_tau_true = 0.2\n    kappa = 0.41\n    B = 5.2\n\n    # Test cases specified by target y1^+ values\n    yplus_targets = [0.5, 5.0, 30.0, 100.0]\n\n    def U_true_at_y1(yplus):\n        \"\"\"\n        Compute synthetic 'true' mean velocity U at y1 for a given yplus = y1^+,\n        using the viscous sublayer relation for yplus = 5 and the log-law for yplus > 5.\n        \"\"\"\n        if yplus = 5.0:\n            # Viscous sublayer: U+ = y+\n            return u_tau_true * yplus\n        else:\n            # Log-law: U+ = (1/kappa) ln(y+) + B\n            return u_tau_true * ((1.0 / kappa) * np.log(yplus) + B)\n\n    def infer_u_tau_from_log(U, y1):\n        \"\"\"\n        Infer friction velocity u_tau by inverting the log-law at y1:\n            U/u = (1/kappa) ln(y1 * u / nu) + B\n        Solve g(u) = 0 with a robust bracket.\n        \"\"\"\n        def g(u):\n            return U / u - ((1.0 / kappa) * np.log(y1 * u / nu) + B)\n\n        # Use a wide bracket to ensure a sign change for physically plausible U, y1\n        lower = 1e-8\n        upper = 1e4\n        # Ensure the function is defined in the bracket\n        return brentq(g, lower, upper, maxiter=200, xtol=1e-12)\n\n    results = []\n    for yplus_target in yplus_targets:\n        # Construct grid: y1 = yplus_target * nu / u_tau_true\n        y1 = yplus_target * nu / u_tau_true\n        # Synthetic \"true\" velocity at y1\n        U = U_true_at_y1(yplus_target)\n        # Inferred friction velocity from standard wall function (log-law)\n        u_tau_inferred = infer_u_tau_from_log(U, y1)\n        # Compute wall shear stresses\n        tau_w_true = rho * (u_tau_true ** 2)\n        tau_w_inferred = rho * (u_tau_inferred ** 2)\n        # Relative error as a decimal number\n        error = (tau_w_inferred - tau_w_true) / tau_w_true\n        results.append(error)\n\n    # Final print statement in the exact required format, rounded to six decimals.\n    print(f\"[{','.join(f'{e:.6f}' for e in results)}]\")\n\nsolve()\n```", "id": "3391066"}]}