{"hands_on_practices": [{"introduction": "在可压缩流动的计算中，固壁边界不仅仅意味着法向速度为零。本练习将引导您从欧拉方程出发，推导并计算曲面壁处一个重要的物理相容性条件。通过分析壁面法向的动量平衡，您将量化壁面曲率如何产生法向压力梯度，这是理解绕流物体压力分布和发展精确壁面模型的关键一步 [@problem_id:3296213]。", "problem": "考虑一个二维、定常、无粘、可压缩流，该流动由欧拉方程控制，并与一个绝热、不可穿透的滑移壁面相邻。设壁面局部由光滑曲线 $y(x)$ 表示，并引入一个局部标准正交标架，其单位切向量为 $\\mathbf{t}$，外单位法向量为 $\\mathbf{n}$，其中坐标 $s$ 是沿壁面的弧长，$n$ 是垂直于壁面向流体内部测量的距离。流速 $\\mathbf{V}$ 分解为 $\\mathbf{V} = V_t \\mathbf{t} + V_n \\mathbf{n}$，滑移、不可穿透条件要求在壁面上 $V_n = 0$。对于比热比为 $\\gamma$、特定气体常数为 $R$ 的理想气体，声速为 $a = \\sqrt{\\gamma R T}$，密度为 $\\rho = p/(R T)$，其中 $p$ 是静压，$T$ 是静温。壁面处的切向流马赫数为 $M_t = V_t/a$。\n\n从投影到法向的无粘动量平衡和沿弯曲流线的运动学出发，推导一个相容性边界条件，该条件用流动和壁面几何形状来表示壁面处法向压力梯度的模 $|\\partial p/\\partial n|$。明确地将 $|\\partial p/\\partial n|$ 与切向速度 $V_t$ 和壁面曲率 $\\kappa_w$ 联系起来，其中有符号曲率定义为 $\\kappa_w = \\mathrm{d}\\theta/\\mathrm{d}s$，$\\theta(s)$ 是切线角；等效地，对于由函数图像 $y(x)$ 给出的壁面，曲率的模为\n$$\n|\\kappa_w(x)| = \\frac{|y''(x)|}{\\left(1 + \\left(y'(x)\\right)^2\\right)^{3/2}}。\n$$\n仅使用无粘定常欧拉方程、牛顿第二定律和理想气体关系式作为基本依据。\n\n算法任务：实现一个程序，对于一组指定的测试用例，使用在给定点 $x_0$ 处求值的 $y'(x)$ 和 $y''(x)$ 的解析表达式，计算壁面处法向压力梯度的模，\n$$\n\\left|\\frac{\\partial p}{\\partial n}\\right| = \\rho \\, V_t^2 \\, |\\kappa_w|,\n$$\n其中 $V_t = M_t \\, a$，$a = \\sqrt{\\gamma R T}$，$\\rho = \\frac{p}{R T}$。所有输出必须以帕斯卡/米（$\\mathrm{Pa/m}$）为单位表示。最终的数值答案必须打印并四舍五入到六位小数。\n\n测试套件：\n- 情况A（正常情况，平坦壁面）：$y(x) = 0$, $y'(x) = 0$, $y''(x) = 0$, $\\gamma = 1.4$, $R = 287$, $p = 100000$ $\\mathrm{Pa}$, $T = 300$ $\\mathrm{K}$, $M_t = 0.5$, $x_0 = 0$。\n- 情况B（通过抛物线的缓和曲率）：$y(x) = \\dfrac{x^2}{2R_c}$, $y'(x) = \\dfrac{x}{R_c}$, $y''(x) = \\dfrac{1}{R_c}$，其中 $R_c = 2.0$ $\\mathrm{m}$，$\\gamma = 1.4$, $R = 287$, $p = 120000$ $\\mathrm{Pa}$, $T = 320$ $\\mathrm{K}$, $M_t = 0.8$, $x_0 = 0$。\n- 情况C（通过圆的跨音速曲率）：$y(x) = \\sqrt{R_c^2 - x^2}$, $y'(x) = -\\dfrac{x}{\\sqrt{R_c^2 - x^2}}$, $y''(x) = -\\dfrac{R_c^2}{\\left(R_c^2 - x^2\\right)^{3/2}}$，其中 $R_c = 1.5$ $\\mathrm{m}$，$\\gamma = 1.4$, $R = 287$, $p = 100000$ $\\mathrm{Pa}$, $T = 300$ $\\mathrm{K}$, $M_t = 1.0$, $x_0 = 0$。\n- 情况D（剧烈曲率和超音速，模拟激波相互作用风险）：$y(x) = \\dfrac{x^2}{2R_c}$, $y'(x) = \\dfrac{x}{R_c}$, $y''(x) = \\dfrac{1}{R_c}$，其中 $R_c = 0.05$ $\\mathrm{m}$，$\\gamma = 1.4$, $R = 287$, $p = 200000$ $\\mathrm{Pa}$, $T = 300$ $\\mathrm{K}$, $M_t = 2.5$, $x_0 = 0$。\n- 情况E（近乎停滞的切向速度）：$y(x) = \\dfrac{x^2}{2R_c}$, $y'(x) = \\dfrac{x}{R_c}$, $y''(x) = \\dfrac{1}{R_c}$，其中 $R_c = 0.2$ $\\mathrm{m}$，$\\gamma = 1.4$, $R = 287$, $p = 100000$ $\\mathrm{Pa}$, $T = 300$ $\\mathrm{K}$, $M_t = 0.01$, $x_0 = 0$。\n\n您的程序应生成单行输出，其中包含情况A到E的结果，按顺序排列，形式为逗号分隔的列表并用方括号括起来，例如 $[r_A,r_B,r_C,r_D,r_E]$，其中每个 $r_\\cdot$ 是计算出的 $|\\partial p/\\partial n|$ 的值，单位为 $\\mathrm{Pa/m}$，并四舍五入到六位小数。", "solution": "问题在于为定常、无粘、可压缩流推导一个固体壁面处的法向压力梯度相容性边界条件，然后实现一个程序来为一组给定的测试用例计算这个梯度。\n\n### 法向压力梯度边界条件的推导\n\n推导始于无粘流体的定常欧拉动量方程，这是流体元的牛顿第二定律的表述：\n$$\n\\rho (\\mathbf{V} \\cdot \\nabla) \\mathbf{V} = - \\nabla p\n$$\n其中 $\\rho$ 是流体密度，$\\mathbf{V}$ 是速度矢量，$p$ 是静压。\n\n为分析弯曲壁面附近的流动，使用自然坐标系 $(s, n)$ 是有利的，其中 $s$ 是沿流线的弧长，$n$ 是垂直于流线的坐标。速度矢量与流线相切，因此 $\\mathbf{V} = V \\mathbf{t}$，其中 $V$ 是流速，$\\mathbf{t}$ 是单位切向量。\n\n加速度项 $(\\mathbf{V} \\cdot \\nabla) \\mathbf{V}$ 可以分解为切向和法向分量。速度矢量的对流导数由下式给出：\n$$\n(\\mathbf{V} \\cdot \\nabla) \\mathbf{V} = V \\frac{\\partial (V \\mathbf{t})}{\\partial s} = V \\left( \\frac{\\partial V}{\\partial s} \\mathbf{t} + V \\frac{\\partial \\mathbf{t}}{\\partial s} \\right)\n$$\n根据微分几何，切向量对弧长的导数与流线曲率 $\\kappa$ 和主单位法向量 $\\mathbf{n}_{cc}$（指向曲率中心）有关：\n$$\n\\frac{\\partial \\mathbf{t}}{\\partial s} = \\kappa \\mathbf{n}_{cc}\n$$\n曲率 $\\kappa$ 是曲率半径 $R_c$ 的倒数，即 $\\kappa = 1/R_c$。将此代入加速度表达式中，得到：\n$$\n(\\mathbf{V} \\cdot \\nabla) \\mathbf{V} = V \\frac{\\partial V}{\\partial s} \\mathbf{t} + \\kappa V^2 \\mathbf{n}_{cc}\n$$\n第一项表示沿流线的速度变化，第二项是使流体质点保持在其弯曲路径上所需的向心加速度。\n\n压力梯度 $\\nabla p$ 也可以在该坐标系中分解。欧拉动量方程变为：\n$$\n\\rho \\left( V \\frac{\\partial V}{\\partial s} \\mathbf{t} + \\kappa V^2 \\mathbf{n}_{cc} \\right) = - \\left( \\frac{\\partial p}{\\partial s} \\mathbf{t} + \\frac{\\partial p}{\\partial n} \\mathbf{n}_{cc} \\right)\n$$\n通过令法向 $\\mathbf{n}_{cc}$ 上的矢量分量相等，我们得到法向动量平衡方程：\n$$\n\\rho \\kappa V^2 = - \\frac{\\partial p}{\\partial n}\n$$\n或\n$$\n\\frac{\\partial p}{\\partial n} = - \\rho \\kappa V^2\n$$\n这个基本关系表明，垂直于流线的压力梯度是平衡其曲率所产生的离心力所必需的。压力在与曲率中心相反的方向上增加。\n\n在固定的、不可穿透的壁面上，流体不能穿过它，因此速度的法向分量为零。对于无粘流，这意味着壁面本身就是一条流线。因此，在壁面上，流速完全是切向的，$V = V_t$，流线曲率等于壁面曲率，$\\kappa = \\kappa_w$。将这些代入法向动量方程，得到：\n$$\n\\left. \\frac{\\partial p}{\\partial n} \\right|_{\\text{wall}} = - \\rho_w \\kappa_w V_{t,w}^2\n$$\n问题要求的是该梯度的模，即 $|\\partial p/\\partial n|$。取绝对值，我们得到：\n$$\n\\left| \\frac{\\partial p}{\\partial n} \\right| = |- \\rho_w \\kappa_w V_{t,w}^2|\n$$\n由于密度 $\\rho$ 和 $V_t^2$ 是非负的，这可以简化为：\n$$\n\\left| \\frac{\\partial p}{\\partial n} \\right| = \\rho_w V_{t,w}^2 |\\kappa_w|\n$$\n这就是所求的相容性边界条件，它将壁面处的法向压力梯度与当地的密度、切向速度和壁面曲率联系起来。\n\n### 算法计算\n\n算法任务是为几个测试用例计算 $|\\partial p/\\partial n|$。问题提供了所有必要的参数和关系。对每个案例的计算过程如下：\n1.  在指定点 $x_0$ 处，使用提供的曲线 $y(x)$ 公式计算壁面曲率的模 $|\\kappa_w|$：\n$$\n|\\kappa_w(x_0)| = \\frac{|y''(x_0)|}{\\left(1 + \\left(y'(x_0)\\right)^2\\right)^{3/2}}\n$$\n2.  使用理想气体定律计算流体密度 $\\rho$：\n$$\n\\rho = \\frac{p}{R T}\n$$\n3.  为理想气体计算声速 $a$：\n$$\na = \\sqrt{\\gamma R T}\n$$\n4.  根据切向马赫数 $M_t$ 确定切向速度 $V_t$：\n$$\nV_t = M_t a\n$$\n5.  最后，将这些值代入推导出的公式中：\n$$\n\\left| \\frac{\\partial p}{\\partial n} \\right| = \\rho V_t^2 |\\kappa_w|\n$$\n\n为了验证，将 $\\rho$、$a$ 和 $V_t$ 的表达式代入最终公式以获得一个简化的表达式是很有启发的：\n$$\n\\left| \\frac{\\partial p}{\\partial n} \\right| = \\left( \\frac{p}{R T} \\right) (M_t \\sqrt{\\gamma R T})^2 |\\kappa_w| = \\frac{p}{R T} M_t^2 (\\gamma R T) |\\kappa_w|\n$$\n$R T$ 项相互抵消，得到一个简洁而优美的关系式：\n$$\n\\left| \\frac{\\partial p}{\\partial n} \\right| = p \\, \\gamma \\, M_t^2 \\, |\\kappa_w|\n$$\n这个简化形式对于检验结果很有用。然而，实现将遵循问题陈述中指定的完整计算链，以展示每个步骤。\n\n该实现将处理提供的测试用例，为每个用例计算 $|\\partial p/\\partial n|$，并按要求格式化结果。所有物理单位均采用国际单位制（SI），因此得到的压力梯度单位为帕斯卡/米（$\\mathrm{Pa/m}$）。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the magnitude of the normal pressure gradient at a wall\n    for several test cases of compressible, inviscid flow.\n    \"\"\"\n\n    # Test cases are defined as tuples with the following structure:\n    # (p, T, Mt, gamma, R, y_prime_at_x0, y_double_prime_at_x0)\n    # where:\n    # p: static pressure (Pa)\n    # T: static temperature (K)\n    # Mt: tangential Mach number\n    # gamma: specific heat ratio\n    # R: specific gas constant (J/(kg*K))\n    # y_prime_at_x0: value of the first derivative of wall shape y(x) at x0\n    # y_double_prime_at_x0: value of the second derivative of wall shape y(x) at x0\n    \n    test_cases = [\n        # Case A: happy path, flat wall\n        (100000, 300, 0.5, 1.4, 287, 0.0, 0.0),\n        # Case B: gentle curvature via parabola (Rc = 2.0 m)\n        (120000, 320, 0.8, 1.4, 287, 0.0, 1.0 / 2.0),\n        # Case C: transonic curvature via circle (Rc = 1.5 m)\n        (100000, 300, 1.0, 1.4, 287, 0.0, -1.5**2 / (1.5**2 - 0.0**2)**1.5), # y'' = -Rc^2 / (Rc^2-x^2)^(3/2)\n        # Case D: severe curvature and supersonic (Rc = 0.05 m)\n        (200000, 300, 2.5, 1.4, 287, 0.0, 1.0 / 0.05),\n        # Case E: near-stagnation tangential velocity (Rc = 0.2 m)\n        (100000, 300, 0.01, 1.4, 287, 0.0, 1.0 / 0.2),\n    ]\n\n    results = []\n\n    def calculate_dpdn(p, T, Mt, gamma, R, y_prime_val, y_double_prime_val):\n        \"\"\"Calculates |dp/dn| for a single case.\"\"\"\n        # 1. Calculate the magnitude of the wall curvature |kappa_w|\n        # |kappa_w(x)| = |y''(x)| / (1 + (y'(x))^2)^(3/2)\n        kappa_mag = np.abs(y_double_prime_val) / (1 + y_prime_val**2)**1.5\n\n        # If curvature is zero, the gradient is zero.\n        if kappa_mag == 0:\n            return 0.0\n\n        # 2. Calculate density rho\n        # rho = p / (R * T)\n        rho = p / (R * T)\n\n        # 3. Calculate speed of sound a\n        # a = sqrt(gamma * R * T)\n        a = np.sqrt(gamma * R * T)\n\n        # 4. Calculate tangential velocity Vt\n        # Vt = Mt * a\n        V_t = Mt * a\n\n        # 5. Calculate the magnitude of the normal pressure gradient\n        # |dp/dn| = rho * Vt^2 * |kappa_w|\n        dpdn_mag = rho * V_t**2 * kappa_mag\n        \n        return dpdn_mag\n\n    for case in test_cases:\n        p, T, Mt, gamma, R, y_prime_val, y_double_prime_val = case\n        result = calculate_dpdn(p, T, Mt, gamma, R, y_prime_val, y_double_prime_val)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    # The results are rounded to six decimal places.\n    print(f\"[{','.join(f'{r:.6f}' for r in results)}]\")\n\nsolve()\n```", "id": "3296213"}, {"introduction": "计算域的出口通常是人为设定的边界，其处理好坏直接影响解的质量。此练习聚焦于设计无反射出口边界条件，这是保证计算稳定性和准确性的核心技术之一。您将通过分析经典的 Orlanski 边界条件，亲手计算当边界对流速度设置不准确时产生的反射波强度，从而深刻理解边界条件失配如何导致虚假反射并可能污染整个流场 [@problem_id:3296236]。", "problem": "您需要实现并分析一个 Orlanski 类型的吸收性出流边界条件，该条件适用于计算流体动力学 (CFD) 框架下均匀可压缩流中的一维小振幅扰动。Orlanski 对流边界条件以用户指定的对流速度的形式，在边界上规定了一个单向平流条件。您的任务是从色散关系中优化此对流速度，并量化失谐对声学反馈造成的影响。\n\n从以下基本基础开始：\n- 速度为 $U$、声速为 $a$ 的均匀平均流中，一维线性化小振幅扰动方程允许平面波解，其色散关系为 $\\omega(k) = k \\, c(k)$，其中 $k$ 是波数，$\\omega$ 是角频率，$c(k)$ 是依赖于分支的相速度。对于均匀流，经过充分检验的事实表明存在三个具有恒定 $c(k)$ 的非色散分支：\n  - 右行声学分支：$\\omega(k) = k(U + a)$。\n  - 左行声学分支：$\\omega(k) = k(U - a)$。\n  - 对流熵或涡量分支：$\\omega(k) = kU$。\n  由于这些分支是非色散的，群速度等于相速度，$c_g = \\mathrm{d}\\omega/\\mathrm{d}k = c$。\n- Orlanski 型对流边界条件在边界 $x = L$ 处施加了一个单向平流条件，形式为 $\\partial \\phi / \\partial t + c_b \\, \\partial \\phi / \\partial x = 0$，其中 $\\phi$ 是任意扰动变量，$c_b$ 是用户指定的边界对流速度。对于一个相对于实验室坐标系以速度 $c$ 真实传播的出射平面波，完美吸收要求 $c_b = c$。任何 $c_b \\neq c$ 的失谐都会产生部分反射。\n\n您必须：\n1. 根据上述色散关系，为指定的分支及参数 $U$ 和 $a$ 确定 $c$。对于右行声学分支，使用 $c = U + a$；对于左行声学分支，使用 $c = U - a$；对于对流熵或涡量分支，使用 $c = U$。\n2. 在 $x = L$ 处，考虑一个右行入射平面波 $\\phi^+(x,t) = A \\exp(\\mathrm{i}(kx - \\omega t))$ 和一个左行反射平面波 $\\phi^-(x,t) = B \\exp(\\mathrm{i}(-kx - \\omega t))$，两者都满足相同的分支色散关系。在 $x=L$ 处施加边界条件 $\\partial \\phi / \\partial t + c_b \\, \\partial \\phi / \\partial x = 0$，以推导用 $c_b$ 和 $c$ 表示的复振幅反射系数 $R = B/A$。然后计算反射幅值 $|R|$。\n3. 通过一个无量纲回路增益 $G$ 来模拟一个简单的标量声学反馈回路，该增益捕捉了除边界反射外的所有耦合和传播效应。定义一个不稳定性指标，如果 $|R| \\cdot G \\ge 1$，则该指标等于 $1$，否则等于 $0$。该指标表示边界反射与回路增益结合时是否足以闭合一个正反馈回路。\n4. 对于下面的每个测试用例，计算并返回 $|R|$ 和不稳定性指标。所有速度都必须以 $\\mathrm{m/s}$ 为单位处理， $|R|$ 是无量纲的，$G$ 也是无量纲的。最终的 $|R|$ 必须四舍五入到六位小数。不稳定性指标必须是整数 $0$ 或 $1$。\n\n使用以下测试套件：\n- 用例 1 (理想情况，为出射声学分支完美调谐)：$U = 100\\,\\mathrm{m/s}$，$a = 340\\,\\mathrm{m/s}$，分支 = 右行声学，通过调谐到色散关系来选择 $c_b$ (即，对于所选分支，取 $c_b = \\mathrm{d}\\omega/\\mathrm{d}k$)，回路增益 $G = 1.25$。\n- 用例 2 (失谐至对流速度，有显著反射和潜在反馈)：$U = 100\\,\\mathrm{m/s}$，$a = 340\\,\\mathrm{m/s}$，分支 = 右行声学，选择 $c_b = U$，回路增益 $G = 1.70$。\n- 用例 3 (朝声速方向过度调谐，有中等程度反射)：$U = 100\\,\\mathrm{m/s}$，$a = 340\\,\\mathrm{m/s}$，分支 = 右行声学，选择 $c_b = U + 0.5\\,a = 270\\,\\mathrm{m/s}$，回路增益 $G = 3.50$。\n- 用例 4 (对流熵或涡量分支，完美调谐)：$U = 150\\,\\mathrm{m/s}$，$a = 350\\,\\mathrm{m/s}$，分支 = 对流熵/涡量，通过调谐到色散关系来选择 $c_b$，回路增益 $G = 5.00$。\n- 用例 5 (边界对流速度极小的边缘情况，接近全反射)：$U = 50\\,\\mathrm{m/s}$，$a = 330\\,\\mathrm{m/s}$，分支 = 右行声学，选择 $c_b = 10\\,\\mathrm{m/s}$，回路增益 $G = 0.98$。\n\n要求的最终输出格式：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表的结果，每个元素对应一个测试用例，并且本身是一个双元素列表 $[|R|, \\mathrm{indicator}]$。反射幅值 $|R|$ 必须四舍五入到六位小数，不稳定性指标必须是如上定义的整数。\n- 例如，打印的行必须看起来像 $[[r_1,i_1],[r_2,i_2],\\ldots]$，除了逗号分隔和括号所必需的之外，没有额外的文本或空格。", "solution": "首先根据所需标准验证问题陈述。\n\n### 步骤 1：提取已知条件\n- **控制物理学**：一维、线性化方程，描述均匀可压缩流中的小振幅扰动。\n- **色散关系**：平面波解具有色散关系 $ \\omega(k) = k \\, c(k) $。对于速度为 $U$、声速为 $a$ 的均匀流，存在三个非色散分支：\n  - 右行声学：$ \\omega(k) = k (U + a) $\n  - 左行声学：$ \\omega(k) = k (U - a) $\n  - 对流熵或涡量：$ \\omega(k) = k U $\n- **群速度**：对于这些分支，群速度等于相速度：$ c_g = \\mathrm{d}\\omega/\\mathrm{d}k = c $。\n- **边界条件**：在边界 $x = L$ 处施加 Orlanski 型对流边界条件：$ \\partial \\phi / \\partial t + c_b \\, \\partial \\phi / \\partial x = 0 $，其中 $c_b$ 是用户指定的对流速度。\n- **波形**：在 $x = L$ 处，总扰动 $\\phi$ 是右行入射波 $ \\phi^+(x,t) = A \\exp( \\mathrm{i} ( k x - \\omega t ) ) $ 和左行反射波 $ \\phi^-(x,t) = B \\exp( \\mathrm{i} ( -k x - \\omega t ) ) $ 的叠加。两个波都满足相同的分支色散关系。\n- **任务 1**：根据给定的分支和参数 $U$ 和 $a$ 确定特征速度 $c$。\n- **任务 2**：推导复振幅反射系数 $R = B/A$ 及其幅值 $|R|$，用 $c_b$ 和 $c$ 表示。\n- **任务 3**：定义一个不稳定性指标。如果 $|R| \\cdot G \\geq 1$，指标为 $1$，否则为 $0$，其中 $G$ 是给定的无量纲回路增益。\n- **任务 4**：为五个测试用例计算 $|R|$（四舍五入到六位小数）和不稳定性指标。\n- **测试用例**：\n  - 用例 1：$U = 100\\,\\mathrm{m/s}$，$a = 340\\,\\mathrm{m/s}$，分支 = 右行声学，$c_b$ 调谐至色散关系，回路增益 $G = 1.25$。\n  - 用例 2：$U = 100\\,\\mathrm{m/s}$，$a = 340\\,\\mathrm{m/s}$，分支 = 右行声学，$c_b = U$，回路增益 $G = 1.70$。\n  - 用例 3：$U = 100\\,\\mathrm{m/s}$，$a = 340\\,\\mathrm{m/s}$，分支 = 右行声学，$c_b = U + 0.5\\,a = 270\\,\\mathrm{m/s}$，回路增益 $G = 3.50$。\n  - 用例 4：$U = 150\\,\\mathrm{m/s}$，$a = 350\\,\\mathrm{m/s}$，分支 = 对流熵/涡量，$c_b$ 调谐至色散关系，回路增益 $G = 5.00$。\n  - 用例 5：$U = 50\\,\\mathrm{m/s}$，$a = 330\\,\\mathrm{m/s}$，分支 = 右行声学，$c_b = 10\\,\\mathrm{m/s}$，回路增益 $G = 0.98$。\n\n### 步骤 2：使用提取的已知条件进行验证\n根据预定义标准对问题进行评估。\n- **有科学依据**：该问题基于波传播和流体动力学的基本原理。线性化可压缩流方程、均匀流的色散关系以及 Orlanski 边界条件是声学和计算流体动力学中标准且成熟的概念。该提法科学上合理，不含伪科学。\n- **适定的**：问题定义清晰。在给定设置下，反射系数的推导是标准的数学物理练习，有唯一解。每个测试用例的所有必要参数和条件都已提供，使得问题自洽，并允许唯一、稳定且有意义的解。\n- **客观的**：问题陈述使用精确、正式且无偏见的语言。不含主观断言或意见。\n\n### 步骤 3：结论与行动\n该问题是**有效的**。这是一个适定的、有科学依据的应用物理问题。现在我将继续进行求解。\n\n### 反射系数幅值的推导\n总扰动 $\\phi(x,t)$ 是入射波和反射波之和：\n$$ \\phi(x,t) = \\phi^+(x,t) + \\phi^-(x,t) = A \\, \\exp( \\mathrm{i} ( k x - \\omega t ) ) + B \\, \\exp( \\mathrm{i} ( -k x - \\omega t ) ) $$\n边界 $x=L$ 处的 Orlanski 边界条件为：\n$$ \\frac{\\partial \\phi}{\\partial t} + c_b \\frac{\\partial \\phi}{\\partial x} = 0 \\quad \\text{在 } x=L \\text{ 处} $$\n我们计算 $\\phi(x,t)$ 的偏导数并在 $x=L$ 处求值：\n$$ \\frac{\\partial \\phi}{\\partial t} \\bigg|_{x=L} = - \\mathrm{i} \\omega A \\, \\exp( \\mathrm{i} ( k L - \\omega t ) ) - \\mathrm{i} \\omega B \\, \\exp( \\mathrm{i} ( -k L - \\omega t ) ) $$\n$$ \\frac{\\partial \\phi}{\\partial x} \\bigg|_{x=L} = \\mathrm{i} k A \\, \\exp( \\mathrm{i} ( k L - \\omega t ) ) - \\mathrm{i} k B \\, \\exp( \\mathrm{i} ( -k L - \\omega t ) ) $$\n将这些代入边界条件方程：\n$$ [-\\mathrm{i} \\omega A e^{\\mathrm{i} kL} - \\mathrm{i} \\omega B e^{-\\mathrm{i} kL}] + c_b [\\mathrm{i} k A e^{\\mathrm{i} kL} - \\mathrm{i} k B e^{-\\mathrm{i} kL}] = 0 $$\n公共因子 $\\exp(-\\mathrm{i}\\omega t)$ 已被消去。现在，我们按振幅 $A$ 和 $B$ 对各项进行分组：\n$$ A e^{\\mathrm{i} kL} (-\\mathrm{i} \\omega + \\mathrm{i} k c_b) + B e^{-\\mathrm{i} kL} (-\\mathrm{i} \\omega - \\mathrm{i} k c_b) = 0 $$\n我们求解反射系数 $R = B/A$：\n$$ B e^{-\\mathrm{i} kL} (-\\mathrm{i} \\omega - \\mathrm{i} k c_b) = - A e^{\\mathrm{i} kL} (-\\mathrm{i} \\omega + \\mathrm{i} k c_b) $$\n$$ \\frac{B}{A} = - \\frac{e^{\\mathrm{i} kL}}{e^{-\\mathrm{i} kL}} \\frac{-\\mathrm{i} \\omega + \\mathrm{i} k c_b}{-\\mathrm{i} \\omega - \\mathrm{i} k c_b} = - e^{2\\mathrm{i} kL} \\frac{\\mathrm{i}(k c_b - \\omega)}{-\\mathrm{i}(k c_b + \\omega)} = e^{2\\mathrm{i} kL} \\frac{k c_b - \\omega}{k c_b + \\omega} $$\n入射波满足色散关系 $\\omega = k c$，其中 $c$ 是特定分支的恒定相速度（和群速度）。将 $\\omega = k c$ 代入 $R$ 的表达式中：\n$$ R = e^{2\\mathrm{i} kL} \\frac{k c_b - k c}{k c_b + k c} = e^{2\\mathrm{i} kL} \\frac{k(c_b - c)}{k(c_b + c)} = e^{2\\mathrm{i} kL} \\frac{c_b - c}{c_b + c} $$\n问题要求反射幅值 $|R|$。由于 $|e^{2\\mathrm{i} kL}| = 1$ 且速度 $c$ 和 $c_b$ 是实数量：\n$$ |R| = \\left| \\frac{c_b - c}{c_b + c} \\right| $$\n这个公式表明，只有当边界对流速度 $c_b$ 与波的传播速度 $c$ 完全匹配时，才能实现完美吸收，即 $|R|=0$。任何不匹配都会导致非零反射。\n\n### 不稳定性判据\n不稳定性指标定义为：如果反射幅值 $|R|$ 和回路增益 $G$ 的乘积大于或等于 $1$，则为 $1$，否则为 $0$。\n$$ \\mathrm{indicator} = \\begin{cases} 1  \\text{if } |R| \\cdot G \\geq 1 \\\\ 0  \\text{if } |R| \\cdot G  1 \\end{cases} $$\n\n### 测试用例分析\n\n**用例 1**：\n- 参数：$U = 100\\,\\mathrm{m/s}$，$a = 340\\,\\mathrm{m/s}$，分支为右行声学，$G = 1.25$。\n- 真实波速 $c = U+a = 100 + 340 = 440\\,\\mathrm{m/s}$。\n- 边界速度 $c_b$ 调谐至色散关系，所以 $c_b = c = 440\\,\\mathrm{m/s}$。\n- 反射幅值：$|R| = \\left| \\frac{440 - 440}{440 + 440} \\right| = \\left| \\frac{0}{880} \\right| = 0.0$。\n- 不稳定性检查：$|R| \\cdot G = 0.0 \\times 1.25 = 0.0$。由于 $0.0  1$，指标为 $0$。\n- 结果：$[0.000000, 0]$。\n\n**用例 2**：\n- 参数：$U = 100\\,\\mathrm{m/s}$，$a = 340\\,\\mathrm{m/s}$，分支为右行声学，$G = 1.70$。\n- 真实波速 $c = U+a = 440\\,\\mathrm{m/s}$。\n- 边界速度失谐至平均流速：$c_b = U = 100\\,\\mathrm{m/s}$。\n- 反射幅值：$|R| = \\left| \\frac{100 - 440}{100 + 440} \\right| = \\left| \\frac{-340}{540} \\right| = \\frac{34}{54} = \\frac{17}{27} \\approx 0.6296296...$。四舍五入到六位小数， $|R| = 0.629630$。\n- 不稳定性检查：$|R| \\cdot G = \\frac{17}{27} \\times 1.70 = \\frac{17}{27} \\times \\frac{17}{10} = \\frac{289}{270} \\approx 1.070 > 1$。指标为 $1$。\n- 结果：$[0.629630, 1]$。\n\n**用例 3**：\n- 参数：$U = 100\\,\\mathrm{m/s}$，$a = 340\\,\\mathrm{m/s}$，分支为右行声学，$G = 3.50$。\n- 真实波速 $c = U+a = 440\\,\\mathrm{m/s}$。\n- 边界速度被过度调谐：$c_b = U + 0.5 a = 100 + 0.5 \\times 340 = 100 + 170 = 270\\,\\mathrm{m/s}$。\n- 反射幅值：$|R| = \\left| \\frac{270 - 440}{270 + 440} \\right| = \\left| \\frac{-170}{710} \\right| = \\frac{17}{71} \\approx 0.2394366...$。四舍五入到六位小数， $|R| = 0.239437$。\n- 不稳定性检查：$|R| \\cdot G = \\frac{17}{71} \\times 3.50 = \\frac{17}{71} \\times \\frac{7}{2} = \\frac{119}{142} \\approx 0.838  1$。指标为 $0$。\n- 结果：$[0.239437, 0]$。\n\n**用例 4**：\n- 参数：$U = 150\\,\\mathrm{m/s}$，$a = 350\\,\\mathrm{m/s}$，分支为对流熵/涡量，$G = 5.00$。\n- 真实波速 $c = U = 150\\,\\mathrm{m/s}$。\n- 边界速度 $c_b$ 调谐至色散关系，所以 $c_b = c = 150\\,\\mathrm{m/s}$。\n- 反射幅值：$|R| = \\left| \\frac{150 - 150}{150 + 150} \\right| = \\left| \\frac{0}{300} \\right| = 0.0$。\n- 不稳定性检查：$|R| \\cdot G = 0.0 \\times 5.00 = 0.0$。由于 $0.0  1$，指标为 $0$。\n- 结果：$[0.000000, 0]$。\n\n**用例 5**：\n- 参数：$U = 50\\,\\mathrm{m/s}$，$a = 330\\,\\mathrm{m/s}$，分支为右行声学，$G = 0.98$。\n- 真实波速 $c = U+a = 50 + 330 = 380\\,\\mathrm{m/s}$。\n- 边界速度被设置为一个极小的值：$c_b = 10\\,\\mathrm{m/s}$。\n- 反射幅值：$|R| = \\left| \\frac{10 - 380}{10 + 380} \\right| = \\left| \\frac{-370}{390} \\right| = \\frac{37}{39} \\approx 0.9487179...$。四舍五入到六位小数， $|R| = 0.948718$。\n- 不稳定性检查：$|R| \\cdot G = \\frac{37}{39} \\times 0.98 = \\frac{37}{39} \\times \\frac{49}{50} = \\frac{1813}{1950} \\approx 0.9297  1$。指标为 $0$。\n- 结果：$[0.948718, 0]$。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n# No other libraries outside the Python standard library are permitted.\n\ndef solve():\n    \"\"\"\n    Computes the reflection magnitude and instability indicator for an\n    Orlanski-type boundary condition across several test cases.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"U\": 100, \"a\": 340, \"branch\": \"right-running acoustic\", \n            \"cb_mode\": \"tuned\", \"G\": 1.25\n        },\n        {\n            \"U\": 100, \"a\": 340, \"branch\": \"right-running acoustic\", \n            \"cb_mode\": (\"fixed\", 100), \"G\": 1.70\n        },\n        {\n            \"U\": 100, \"a\": 340, \"branch\": \"right-running acoustic\", \n            \"cb_mode\": (\"fixed\", 270), \"G\": 3.50\n        },\n        {\n            \"U\": 150, \"a\": 350, \"branch\": \"convected entropy/vorticity\", \n            \"cb_mode\": \"tuned\", \"G\": 5.00\n        },\n        {\n            \"U\": 50, \"a\": 330, \"branch\": \"right-running acoustic\", \n            \"cb_mode\": (\"fixed\", 10), \"G\": 0.98\n        },\n    ]\n\n    results = []\n    for case in test_cases:\n        U = case[\"U\"]\n        a = case[\"a\"]\n        branch = case[\"branch\"]\n        cb_mode = case[\"cb_mode\"]\n        G = case[\"G\"]\n\n        # 1. Determine the true wave speed 'c' from the dispersion relation.\n        c = 0.0\n        if branch == \"right-running acoustic\":\n            c = U + a\n        elif branch == \"left-running acoustic\":\n            c = U - a\n        elif branch == \"convected entropy/vorticity\":\n            c = U\n\n        # Determine the boundary convection speed 'c_b'.\n        c_b = 0.0\n        if cb_mode == \"tuned\":\n            c_b = c\n        elif isinstance(cb_mode, tuple) and cb_mode[0] == \"fixed\":\n            c_b = cb_mode[1]\n\n        # 2. Compute the reflection magnitude |R|.\n        # Formula: |R| = |(c_b - c) / (c_b + c)|\n        # Handle potential division by zero, although not expected with given data.\n        if abs(c_b + c)  1e-9:\n            # This case corresponds to an ill-posed B.C. and implies total reflection.\n            R_mag = 1.0\n        else:\n            R_mag = abs((c_b - c) / (c_b + c))\n        \n        # 3. Compute the instability indicator.\n        # Indicator is 1 if |R|*G >= 1, and 0 otherwise.\n        is_unstable = 1 if R_mag * G >= 1 else 0\n\n        # Store the formatted result for this case.\n        results.append([f\"{R_mag:.6f}\", is_unstable])\n\n    # Final print statement in the exact required format.\n    # Manually construct the string to avoid spaces added by str(list).\n    # e.g., '[[0.000000,0],[0.629630,1],...]'\n    output_strings = [f\"[{r},{i}]\" for r, i in results]\n    print(f\"[{','.join(output_strings)}]\")\n\nsolve()\n```", "id": "3296236"}, {"introduction": "对于大涡模拟（LES）等高保真度仿真，入口边界需要能生成物理上真实的湍流脉动。本高级练习旨在解决一个关键挑战：如何在引入可压缩脉动的同时，避免产生非物理的伪熵波。您将运用特征波理论，设计并实现一个仅注入纯声学（等熵）扰动的入口条件，并通过量化下游流场中的声学能量与非等熵伪影，验证您方法的有效性 [@problem_id:3296254]。", "problem": "考虑一个均匀基态下的一维可压缩流，其平均速度 $U_0$、密度 $\\rho_0$、压力 $p_0$ 和温度 $T_0$ 均为常数。假设一种理想气体，其比热比为 $\\gamma$，气体常数为 $R$，定容比热为 $c_v$，定压比热为 $c_p$，且满足 $c_p - c_v = R$ 和 $\\gamma = c_p/c_v$。围绕基态的小扰动分别用 $u'(x,t)$、$\\rho'(x,t)$、 $p'(x,t)$ 和 $s'(x,t)$ 表示速度、密度、压力和单位质量比熵。当地声速为 $c = \\sqrt{\\gamma p_0/\\rho_0}$。你的任务是为计算域的左边界构建并评估一个用于大涡模拟 (LES) 风格合成脉动的入流边界条件，确保在需要时能引入可压缩声学内容，而不会产生伪熵模态。\n\n仅从质量守恒、动量守恒、熵平流和理想气体定律作为基本出发点，并假设均匀基流周围存在小扰动，按以下步骤用纯数学术语定义一个计算实验：\n\n1.  推导一个关于扰动 $u'(x,t)$、$\\rho'(x,t)$ 和 $s'(x,t)$ 的线性一阶演化系统，该系统由一个与理想气体相符的热力学关系封闭。使用均匀基态 $(U_0,\\rho_0,p_0,T_0)$ 并假设热力学系数为常数。你的推导应清楚说明在线性极限下，$p'(x,t)$ 如何依赖于 $\\rho'(x,t)$ 和 $s'(x,t)$。\n\n2.  使用特征波理论，对于 $0  U_0  c$ 的亚声速入流边界，确定需要指定多少个边界条件。明确定义一个特征变量系统，该系统能将流动解耦为声学模态和熵模态。基于此，精确说明如何设置边界条件以仅注入纯声学内容，以及如何修改它们以引入伪熵内容。\n\n3.  定义一个数值程序，该程序在长度为 $L$ 的一维域上求解在第一步中推导出的线性化方程。指定一个稳定的显式时间推进格式和一个尊重特征的边界条件应用方法。指定一个合成宽带随机信号生成方法，该信号具有可控的均方根 (RMS) 振幅，并遵循 $E(k) \\propto k^{-5/3}$ 湍流能谱，用作声学和熵模态的入流脉动源。时间步长必须满足一个稳定的 Courant–Friedrichs–Lewy (CFL) 条件，例如 $C_{\\text{cfl}}  1$。\n\n4.  设计一个测试套件，包含至少两个不同的数值实验：(a) 一个仅注入声学脉动 (RMS 振幅为 $A_a$) 的基准案例；(b) 一个同时注入声学脉动 (振幅 $A_a$) 和熵脉动 (振幅 $A_s$) 的案例。选择合适的物理参数和模拟设置，包括平均马赫数 $M=U_0/c$。\n\n5.  定义两个无量纲诊断指标，可在下游探针位置 $x_p$ 测量，以量化入流条件的性能：\n    -   **声学内容分数 $F_a$**: 一个从 0 到 1 的值，表示由声学模态承载的总脉动能量的分数。\n    -   **等熵闭合违背比 $R_v$**: 一个非负值，用于量化流场对等熵关系 $p' = c^2 \\rho'$ 的偏离程度。\n    为每个指标提供明确的数学公式。\n\n算法任务：实现第 3 步中描述的数值求解器。使用以下参数运行三个测试用例：\n- 公共参数：$\\gamma=1.4$, $\\rho_0=1.0$, $R=1.0$, $L=10.0$, $N=201$ 个网格点, $T_{\\text{end}}=5.0$, $C_{\\text{cfl}}=0.9$, $x_p=0.8L$, 合成信号中 $K=20$ 个频率模式，范围为 $[0.2, 1.5]$ Hz，声学脉动 RMS 振幅 $A_a=0.05$。\n- 用例 1：$M=0.4$, 熵脉动 RMS 振幅 $A_s=0.0$。\n- 用例 2：$M=0.4$, 熵脉动 RMS 振幅 $A_s=0.05$。\n- 用例 3：$M=0.95$, 熵脉动 RMS 振幅 $A_s=0.0$。\n\n对于每个用例，在模拟的后半部分（$t \\in [T_{\\text{end}}/2, T_{\\text{end}}]$）对探针数据进行时间平均，计算诊断指标 $F_a$ 和 $R_v$。\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，按顺序包含案例 1 的 ($F_a, R_v$)、案例 2 的 ($F_a, R_v$) 和案例 3 的 ($F_a, R_v$) 的值。所有数值必须四舍五入到六位小数。\n例如：$[Fa_1, Rv_1, Fa_2, Rv_2, Fa_3, Rv_3]$。", "solution": "该问题要求对一个一维可压缩流系统进行推导、数值实现和分析，以评估入流边界条件。解决方案分为五个部分：控制方程的推导、用于边界条件的特征分析、合成入流信号的构建、数值方法的设计以及诊断指标的定义。\n\n### 1. 线性化控制方程的推导\n我们从理想气体在光滑流场中的一维欧拉方程开始，包括质量守恒、动量守恒和比熵 $s$ 守恒：\n$$ \\frac{\\partial \\rho}{\\partial t} + \\frac{\\partial (\\rho u)}{\\partial x} = 0 $$\n$$ \\rho \\left( \\frac{\\partial u}{\\partial t} + u \\frac{\\partial u}{\\partial x} \\right) = - \\frac{\\partial p}{\\partial x} $$\n$$ \\frac{\\partial s}{\\partial t} + u \\frac{\\partial s}{\\partial x} = 0 $$\n我们考虑围绕一个均匀基态 $(\\rho_0, U_0, p_0, s_0)$ 的小扰动（用撇号表示），其中所有基态量均为常数。我们将 $\\rho = \\rho_0 + \\rho'$、 $u = U_0 + u'$、 $p = p_0 + p'$ 和 $s = s_0 + s'$ 代入方程，并忽略扰动的二阶及以上项。这得到线性化方程：\n$$ \\frac{\\partial \\rho'}{\\partial t} + U_0 \\frac{\\partial \\rho'}{\\partial x} + \\rho_0 \\frac{\\partial u'}{\\partial x} = 0 $$\n$$ \\rho_0 \\left( \\frac{\\partial u'}{\\partial t} + U_0 \\frac{\\partial u'}{\\partial x} \\right) = - \\frac{\\partial p'}{\\partial x} $$\n$$ \\frac{\\partial s'}{\\partial t} + U_0 \\frac{\\partial s'}{\\partial x} = 0 $$\n为封闭该系统，我们需要一个连接 $p'$ 与其他变量的热力学关系。对于理想气体，状态方程的微分形式为 $dp/p = \\gamma d\\rho/\\rho + ds/c_v$。在线性极限下，这变为：\n$$ \\frac{p'}{p_0} = \\gamma \\frac{\\rho'}{\\rho_0} + \\frac{s'}{c_v} $$\n使用声速定义 $c^2 = \\gamma p_0 / \\rho_0$ 和气体常数关系 $p_0 = \\rho_0 R T_0$ 及 $c_p = \\gamma c_v$，上式可表示为：\n$$ p' = c^2 \\rho' + \\frac{p_0}{c_v}s' = c^2 \\rho' + \\rho_0 (\\gamma - 1) T_0 s' $$\n这使我们能够用 $p'$ 和 $s'$ 表示 $\\rho'$：\n$$ \\rho' = \\frac{p'}{c^2} - \\frac{\\rho_0}{c_p}s' $$\n将此式代入线性化的质量方程，并定义算子 $D_t = \\partial_t + U_0 \\partial_x$，原始变量 $V = [p', u', s']^T$ 的系统变为：\n$$ \\frac{\\partial p'}{\\partial t} + U_0 \\frac{\\partial p'}{\\partial x} + \\rho_0 c^2 \\frac{\\partial u'}{\\partial x} = 0 $$\n$$ \\frac{\\partial u'}{\\partial t} + U_0 \\frac{\\partial u'}{\\partial x} + \\frac{1}{\\rho_0} \\frac{\\partial p'}{\\partial x} = 0 $$\n$$ \\frac{\\partial s'}{\\partial t} + U_0 \\frac{\\partial s'}{\\partial x} = 0 $$\n这是一个形如 $\\partial_t V + A \\partial_x V = 0$ 的一阶线性双曲系统，其中系统矩阵 $A$ 为：\n$$ A = \\begin{pmatrix} U_0  \\rho_0 c^2  0 \\\\ 1/\\rho_0  U_0  0 \\\\ 0  0  U_0 \\end{pmatrix} $$\n\n### 2. 特征分析与边界条件\n系统的行为由矩阵 $A$ 的特征值和特征向量决定。特征值 $\\lambda_i$ 代表特征波速。\n$$ \\det(A - \\lambda I) = (U_0-\\lambda) \\left[ (U_0-\\lambda)^2 - c^2 \\right] = 0 $$\n特征值为 $\\lambda_1 = U_0 - c$、$\\lambda_2 = U_0$ 和 $\\lambda_3 = U_0 + c$。它们分别对应于一个左行声波、一个熵波和一个右行声波。\n\n对于位于 $x=0$ 且满足 $0  U_0  c$ 的亚声速入流边界：\n- $\\lambda_1 = U_0 - c  0$：对应的波从计算域出射。\n- $\\lambda_2 = U_0 > 0$：对应的波向计算域入射。\n- $\\lambda_3 = U_0 + c > 0$：对应的波向计算域入射。\n因此，在亚声速入流边界，有两个入射波和一个出射波，需要指定两个边界条件。\n\n该系统可以通过变换到特征变量 $\\mathcal{C}$ 的基来对角化，这些变量是特征向量的幅值。这些变量根据 $\\partial_t \\mathcal{C}_i + \\lambda_i \\partial_x \\mathcal{C}_i = 0$ 独立演化。对于变量 $V=[p', u', s']^T$，一组合适的特征变量是：\n$$ \\mathcal{C}_1 = \\frac{1}{2} \\left( \\frac{p'}{\\rho_0 c} - u' \\right) \\quad (\\text{左行声学幅值, } \\lambda_1=U_0-c) $$\n$$ \\mathcal{C}_2 = s' \\quad (\\text{熵幅值, } \\lambda_2=U_0) $$\n$$ \\mathcal{C}_3 = \\frac{1}{2} \\left( \\frac{p'}{\\rho_0 c} + u' \\right) \\quad (\\text{右行声学幅值, } \\lambda_3=U_0+c) $$\n在入流边界 $x=0$ 处，我们必须指定入射特征变量的值，即 $\\mathcal{C}_2(0, t)$ 和 $\\mathcal{C}_3(0, t)$。\n- 为了注入纯粹的等熵声学内容，我们将入射熵脉动设为零，即 $\\mathcal{C}_2(0, t) = s'(0, t) = 0$，并为声学内容指定一个随时间变化的信号，即 $\\mathcal{C}_3(0, t) = A_{\\text{acoustic}}(t)$。\n- 为了引入伪熵模态，我们为熵指定一个额外的独立信号，即 $\\mathcal{C}_2(0, t) = A_{\\text{entropy}}(t) \\neq 0$。\n\n在位于 $x=L$ 的亚声速出流边界，有一个入射波（$\\lambda_1  0$）和两个出射波（$\\lambda_2>0, \\lambda_3>0$）。通过将入射特征的幅值设为零，可以实现无反射边界条件：$\\mathcal{C}_1(L,t) = 0$。\n\n### 3. 合成脉动的生成\n入流信号被构建为具有随机相位的正弦波之和，以产生宽带谱：\n$$ f(t) = \\sum_{k=1}^{K} a_k \\sin(2\\pi f_k t + \\phi_k) $$\n频率 $f_k$ 在给定范围 $[f_{\\min}, f_{\\max}]$ 内均匀间隔。相位 $\\phi_k$ 从 $[0, 2\\pi]$ 上的均匀随机分布中选取，并使用固定的种子以保证可复现性。幅值 $a_k$ 被加权以模拟湍流惯性区谱，其中能量随频率变化。一个常见的选择是 $E(f) \\propto f^{-5/3}$，这意味着 $a_k \\propto f_k^{-5/6}$。然后对信号进行归一化，使其均方根 (RMS) 值（由 $\\sqrt{\\frac{1}{2}\\sum_k a_k^2}$ 给出）与指定的目标幅值（声波为 $A_a$，熵波为 $A_s$）相匹配。\n\n### 4. 数值离散化与求解算法\n该问题在均匀空间网格 $x_j = j \\Delta x$（其中 $j=0, \\dots, N-1$ 且 $\\Delta x = L/(N-1)$）上进行数值求解。我们使用一种尊重方程特征性质的方法。\n1.  **变换**：在每个时间步，每个网格点上的物理变量 $V_j = [p'_j, u'_j, s'_j]^T$ 被变换为特征变量 $\\mathcal{C}_j = [\\mathcal{C}_{1,j}, \\mathcal{C}_{2,j}, \\mathcal{C}_{3,j}]^T$。\n2.  **平流**：每个特征变量 $\\mathcal{C}_i$ 根据其平流速度 $\\lambda_i$ 使用一阶迎风格式进行时间推进：\n    $$ \\mathcal{C}_{i,j}^{n+1} = \\mathcal{C}_{i,j}^{n} - \\frac{\\Delta t}{\\Delta x} \\lambda_i (\\mathcal{C}_{i,j}^{n} - \\mathcal{C}_{i,j-1}^{n}) \\quad \\text{若 } \\lambda_i > 0 $$\n    $$ \\mathcal{C}_{i,j}^{n+1} = \\mathcal{C}_{i,j}^{n} - \\frac{\\Delta t}{\\Delta x} \\lambda_i (\\mathcal{C}_{i,j+1}^{n} - \\mathcal{C}_{i,j}^{n}) \\quad \\text{若 } \\lambda_i  0 $$\n    时间步长 $\\Delta t$ 受 Courant–Friedrichs–Lewy (CFL) 条件的限制：$\\Delta t \\le C_{\\text{cfl}} \\Delta x / \\max_i(|\\lambda_i|)$，其中 $C_{\\text{cfl}}  1$。\n3.  **边界条件**：特征变量的边界值按第 2 节所述进行更新。在入流处 ($j=0$)，$\\mathcal{C}_{2,0}$ 和 $\\mathcal{C}_{3,0}$ 被设置为其指定的入流信号值，而 $\\mathcal{C}_{1,0}$ 则从内部点外推得到。在出流处 ($j=N-1$)，$\\mathcal{C}_{1,N-1}$ 被设置为零，而 $\\mathcal{C}_{2,N-1}$ 和 $\\mathcal{C}_{3,N-1}$ 则被外推得到。\n4.  **逆变换**：更新后的特征变量 $\\mathcal{C}_j^{n+1}$ 被变换回物理变量 $V_j^{n+1}$。\n\n### 5. 诊断公式\n在下游探针位置 $x_p$ 处，在一个后期时间窗口内测量两个无量纲诊断量，以排除初始瞬态。\n- **声学内容分数 $F_a$**：该指标衡量声学模态所包含的脉动能量比例。它计算为声学特征变量（$\\mathcal{C}_1, \\mathcal{C}_3$）方差之和与所有特征变量总方差之比：\n  $$ F_a = \\frac{\\text{var}(\\mathcal{C}_1) + \\text{var}(\\mathcal{C}_3)}{\\text{var}(\\mathcal{C}_1) + \\text{var}(\\mathcal{C}_2) + \\text{var}(\\mathcal{C}_3)} $$\n- **等熵闭合违背比 $R_v$**：该指标量化了等熵关系 $p' = c^2 \\rho'$ 被违背的程度。它定义为残差 $r'(t) = p'(t) - c^2 \\rho'(t)$ 的均方根除以压力扰动 $p'(t)$ 的均方根。使用关系式 $\\rho' = p'/c^2 - (\\rho_0/c_p)s'$，残差简化为 $r'(t) = c^2(\\rho_0/c_p)s'(t)$。因此该比值为：\n  $$ R_v = \\frac{\\text{rms}\\left( (c^2 \\rho_0/c_p) s'(t) \\right)}{\\text{rms}(p'(t))} = \\frac{c^2 \\rho_0}{c_p} \\frac{\\text{rms}(s'(t))}{\\text{rms}(p'(t))} $$\n对于纯等熵流，$s'=0$，导致 $F_a=1$ 和 $R_v=0$。熵脉动（$s' \\neq 0$）的存在将导致 $F_a$ 从 1 减小，$R_v$ 从 0 增大。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print results.\n    \"\"\"\n    test_cases = [\n        {'M': 0.4, 'A_s': 0.0, 'label': 'Case 1'},\n        {'M': 0.4, 'A_s': 0.05, 'label': 'Case 2'},\n        {'M': 0.95, 'A_s': 0.0, 'label': 'Case 3'},\n    ]\n\n    results = []\n    for case in test_cases:\n        res_pair = run_simulation(M=case['M'], A_s=case['A_s'])\n        results.extend(res_pair)\n\n    # Final print statement in the exact required format.\n    formatted_results = [f\"{r:.6f}\" for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\ndef generate_signal(times, freqs, phases, rms_target, power_law_exp=-5.0/6.0):\n    \"\"\"\n    Generates a synthetic broadband signal as a sum of sinusoids.\n    \"\"\"\n    if rms_target == 0.0:\n        return np.zeros_like(times)\n    \n    K = len(freqs)\n    \n    # Amplitudes with an inertial-range-like power law weighting\n    amplitudes_unscaled = freqs**power_law_exp\n    \n    # Normalize to achieve the target RMS amplitude\n    current_rms = np.sqrt(0.5 * np.sum(amplitudes_unscaled**2))\n    \n    scaling_factor = rms_target / current_rms if current_rms > 0 else 0.0\n    amplitudes = amplitudes_unscaled * scaling_factor\n    \n    signal = np.zeros_like(times)\n    omegas = 2 * np.pi * freqs\n    \n    # Sum the sinusoidal components\n    for k in range(K):\n        signal += amplitudes[k] * np.sin(omegas[k] * times + phases[k])\n        \n    return signal\n\ndef run_simulation(M, A_s):\n    \"\"\"\n    Executes a single 1D compressible flow simulation case.\n    \"\"\"\n    # 1. Setup constants, grid, and simulation parameters\n    gamma = 1.4\n    rho0 = 1.0\n    R_gas = 1.0\n    p0 = rho0 * R_gas * 1.0  # T0 = 1.0\n    \n    c_sound = np.sqrt(gamma * p0 / rho0)\n    cp = gamma * R_gas / (gamma - 1.0)\n    \n    U0 = M * c_sound\n    \n    L = 10.0\n    N = 201\n    dx = L / (N - 1)\n    \n    tend = 5.0\n    cfl = 0.9\n    \n    lambda1 = U0 - c_sound\n    lambda2 = U0\n    lambda3 = U0 + c_sound\n    lambdas = np.array([lambda1, lambda2, lambda3])\n    \n    dt = cfl * dx / np.max(np.abs(lambdas))\n    n_steps = int(tend / dt)\n    times = np.linspace(0, tend, n_steps + 1)\n    \n    # 2. Prepare inflow signals\n    K_freqs = 20\n    f_min = 0.2\n    f_max = 1.5\n    seed = 12345\n    \n    freqs = np.linspace(f_min, f_max, K_freqs)\n    \n    rng = np.random.default_rng(seed)\n    phases_a = rng.uniform(0, 2 * np.pi, K_freqs)\n    phases_s = rng.uniform(0, 2 * np.pi, K_freqs) # Independent phases for entropy\n    \n    A_a = 0.05\n    signal_C3 = generate_signal(times, freqs, phases_a, A_a)\n    signal_C2 = generate_signal(times, freqs, phases_s, A_s)\n    \n    # 3. Initialize state variables\n    # V = [p', u', s']^T (physical variables)\n    V = np.zeros((3, N))\n    # C = [C1, C2, C3]^T (characteristic variables)\n    C = np.zeros((3, N))\n    \n    probe_idx = int(round(0.8 * L / dx))\n    probe_data = np.zeros((n_steps + 1, 3))\n    \n    # 4. Main time-stepping loop\n    for n in range(n_steps):\n        probe_data[n, :] = V[:, probe_idx]\n\n        # V -> C (physical to characteristic transformation)\n        p_prime, u_prime, s_prime = V[0, :], V[1, :], V[2, :]\n        C[0, :] = 0.5 * (p_prime / (rho0 * c_sound) - u_prime)\n        C[1, :] = s_prime\n        C[2, :] = 0.5 * (p_prime / (rho0 * c_sound) + u_prime)\n\n        C_old = C.copy()\n        \n        # Advance interior points with 1st order upwind on characteristics\n        for j in range(1, N - 1):\n            # Upwind C1 (lambda1  0)\n            C[0, j] = C_old[0, j] - (dt / dx) * lambda1 * (C_old[0, j+1] - C_old[0, j])\n            # Upwind C2 (lambda2 > 0)\n            C[1, j] = C_old[1, j] - (dt / dx) * lambda2 * (C_old[1, j] - C_old[1, j-1])\n            # Upwind C3 (lambda3 > 0)\n            C[2, j] = C_old[2, j] - (dt / dx) * lambda3 * (C_old[2, j] - C_old[2, j-1])\n\n        # Boundary Conditions\n        # Inflow at j=0\n        C[1, 0] = signal_C2[n + 1] # Incoming C2 (entropy)\n        C[2, 0] = signal_C3[n + 1] # Incoming C3 (acoustic)\n        C[0, 0] = C_old[0, 0] - (dt / dx) * lambda1 * (C_old[0, 1] - C_old[0, 0]) # Extrapolate outgoing C1\n        \n        # Outflow at j=N-1\n        C[0, N-1] = 0.0 # Non-reflecting for incoming C1\n        C[1, N-1] = C_old[1, N-1] - (dt/dx) * lambda2 * (C_old[1, N-1] - C_old[1, N-2]) # Extrapolate outgoing C2\n        C[2, N-1] = C_old[2, N-1] - (dt/dx) * lambda3 * (C_old[2, N-1] - C_old[2, N-2]) # Extrapolate outgoing C3\n        \n        # C -> V (characteristic to physical transformation)\n        C1, C2, C3 = C[0, :], C[1, :], C[2, :]\n        V[0, :] = rho0 * c_sound * (C1 + C3) # p'\n        V[1, :] = -C1 + C3                  # u'\n        V[2, :] = C2                        # s'\n        \n    probe_data[n_steps, :] = V[:, probe_idx]\n    \n    # 5. Post-process and calculate diagnostics\n    late_time_start_idx = n_steps // 2\n    \n    p_probe_late = probe_data[late_time_start_idx:, 0]\n    u_probe_late = probe_data[late_time_start_idx:, 1]\n    s_probe_late = probe_data[late_time_start_idx:, 2]\n\n    # Calculate characteristic variables at the probe\n    C1_probe_late = 0.5 * (p_probe_late / (rho0 * c_sound) - u_probe_late)\n    C2_probe_late = s_probe_late\n    C3_probe_late = 0.5 * (p_probe_late / (rho0 * c_sound) + u_probe_late)\n    \n    # Diagnostic Fa: Acoustic-content fraction\n    var_C1 = np.var(C1_probe_late)\n    var_C2 = np.var(C2_probe_late)\n    var_C3 = np.var(C3_probe_late)\n    \n    var_acoustic = var_C1 + var_C3\n    var_total = var_acoustic + var_C2\n    Fa = var_acoustic / var_total if var_total > 1e-12 else 0.0\n        \n    # Diagnostic Rv: Isentropic-closure violation ratio\n    rms_p = np.sqrt(np.mean(p_probe_late**2))\n    rms_s = np.sqrt(np.mean(s_probe_late**2))\n    \n    Rv_num = (c_sound**2 * rho0 / cp) * rms_s\n    Rv = Rv_num / rms_p if rms_p > 1e-12 else 0.0\n\n    return Fa, Rv\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "3296254"}]}