{"hands_on_practices": [{"introduction": "理论学习之后，最好的巩固方式莫过于亲自动手实践。本练习旨在通过一个具体的 $4 \\times 4$ 三对角线性系统，引导你逐步完成托马斯算法（Thomas algorithm），也被称为追赶法（Tridiagonal Matrix Algorithm, TDMA）的完整计算流程。通过手动执行前向消元和后向回代这两个核心步骤，你将对算法的内部运作机制建立起牢固而直观的理解，为后续更复杂的应用打下坚实的基础。 [@problem_id:1030146]", "problem": "考虑如下三对角方程组：\n$$\n\\begin{cases}\n2x_1 - x_2 = 3 \\\\\n-x_1 + 3x_2 - 2x_3 = 1 \\\\\n-\\dfrac{1}{2}x_2 + 4x_3 - x_4 = 0 \\\\\n-\\dfrac{3}{2}x_3 + 5x_4 = 2\n\\end{cases}\n$$\n请使用托马斯算法求解该方程组，并给出 $x_4$ 的值。托马斯算法包含一个用于修正系数的前向扫描和一个从最后一个变量开始计算解的反向回代过程。", "solution": "我们将三对角系统写为 $A\\mathbf{x} = \\mathbf{d}$，其中矩阵 $A$ 的非零对角线如下（使用1-based索引）：\n- 次对角线（下对角线）: $a_i$ (for $i=2, \\dots, n$)\n- 主对角线: $b_i$ (for $i=1, \\dots, n$)\n- 超对角线（上对角线）: $c_i$ (for $i=1, \\dots, n-1$)\n\n托马斯算法通过两个步骤求解该系统：\n\n1. **前向消元**：此步骤通过将原系统 $A\\mathbf{x} = \\mathbf{d}$ 变换为一个等价的上三角系统 $U\\mathbf{x} = \\mathbf{d'}$，其中 $U$ 的主对角线为 $b'_i$，超对角线与 $A$ 相同，均为 $c_i$。我们计算新的主对角线元素 $b'_i$ 和新的右端项 $d'_i$。\n   - 初始化: $b'_1 = b_1$, $d'_1 = d_1$。\n   - 对于 $i = 2, \\dots, n$：\n     - $m_i = a_i / b'_{i-1}$\n     - $b'_i = b_i - m_i \\cdot c_{i-1}$\n     - $d'_i = d_i - m_i \\cdot d'_{i-1}$\n\n2. **反向回代**：从最后一个未知数开始求解上三角系统 $U\\mathbf{x} = \\mathbf{d'}$。\n   - $x_n = d'_n / b'_n$\n   - 对于 $i = n-1, \\dots, 1$：\n     - $x_i = (d'_i - c_i \\cdot x_{i+1}) / b'_i$\n\n根据标准记法，给定方程组的系数为：\n- 主对角线 $b$: $b_1=2, b_2=3, b_3=4, b_4=5$\n- 超对角线 $c$: $c_1=-1, c_2=-2, c_3=-1$\n- 次对角线 $a$: $a_2=-1, a_3=-\\dfrac{1}{2}, a_4=-\\dfrac{3}{2}$\n- 右端向量 $d$: $d_1=3, d_2=1, d_3=0, d_4=2$\n\n**前向消元：**\n\n- 对于 $i=1$：\n  $b'_1 = b_1 = 2$\n  $d'_1 = d_1 = 3$\n\n- 对于 $i=2$：\n  $m_2 = a_2 / b'_1 = (-1) / 2 = -\\dfrac{1}{2}$\n  $b'_2 = b_2 - m_2 \\cdot c_1 = 3 - (-\\dfrac{1}{2})(-1) = 3 - \\dfrac{1}{2} = \\dfrac{5}{2}$\n  $d'_2 = d_2 - m_2 \\cdot d'_1 = 1 - (-\\dfrac{1}{2})(3) = 1 + \\dfrac{3}{2} = \\dfrac{5}{2}$\n\n- 对于 $i=3$：\n  $m_3 = a_3 / b'_2 = (-\\dfrac{1}{2}) / (\\dfrac{5}{2}) = -\\dfrac{1}{5}$\n  $b'_3 = b_3 - m_3 \\cdot c_2 = 4 - (-\\dfrac{1}{5})(-2) = 4 - \\dfrac{2}{5} = \\dfrac{18}{5}$\n  $d'_3 = d_3 - m_3 \\cdot d'_2 = 0 - (-\\dfrac{1}{5})(\\dfrac{5}{2}) = \\dfrac{1}{2}$\n\n- 对于 $i=4$：\n  $m_4 = a_4 / b'_3 = (-\\dfrac{3}{2}) / (\\dfrac{18}{5}) = -\\dfrac{5}{12}$\n  $b'_4 = b_4 - m_4 \\cdot c_3 = 5 - (-\\dfrac{5}{12})(-1) = 5 - \\dfrac{5}{12} = \\dfrac{55}{12}$\n  $d'_4 = d_4 - m_4 \\cdot d'_3 = 2 - (-\\dfrac{5}{12})(\\dfrac{1}{2}) = 2 + \\dfrac{5}{24} = \\dfrac{48}{24} + \\dfrac{5}{24} = \\dfrac{53}{24}$\n\n**反向回代：**\n\n- 对于 $x_4$：\n  $x_4 = d'_4 / b'_4 = (\\dfrac{53}{24}) / (\\dfrac{55}{12}) = \\dfrac{53}{24} \\cdot \\dfrac{12}{55} = \\dfrac{53 \\cdot 12}{24 \\cdot 55} = \\dfrac{53}{2 \\cdot 55} = \\dfrac{53}{110}$\n\n因此，$x_4 = \\dfrac{53}{110}$。", "answer": "$$ \\boxed{\\dfrac{53}{110}} $$", "id": "1030146"}, {"introduction": "理解了托马斯算法的力学原理后，下一个关键问题是：为什么在计算流体动力学（CFD）中我们如此依赖这种专门的算法？本练习将通过一个典型的CFD问题——一维稳态扩散方程的离散化——来回答这个问题。你将通过编程实践，直接对比托马斯算法与通用的LU分解求解器在计算成本和数值精度上的差异，从而深刻体会其 $O(N)$ 线性时间复杂度相对于通用方法 $O(N^3)$ 的巨大优势。 [@problem_id:3383321]", "problem": "考虑一维稳态扩散方程，这是计算流体力学（CFD）中的一个典型模型，其形式为 $-\\dfrac{d^2 u}{dx^2} = f(x)$，定义在单位区间 $[0,1]$ 上，并带有齐次狄利克雷边界条件 $u(0) = 0$ 和 $u(1) = 0$。使用包含 $n$ 个内部节点的均匀网格，网格间距为 $h = \\dfrac{1}{n+1}$，并采用二阶中心差分近似来处理二阶导数，可以得到一个线性系统 $A \\mathbf{u} = \\mathbf{b}$。其中，$A$ 是一个三对角矩阵，其主对角线上的元素为 $2$，次对角线和超对角线上的元素为 $-1$。具体来说，$A \\in \\mathbb{R}^{n \\times n}$ 的次对角线元素为 $a_i = -1$（$i = 2,\\dots,n$），主对角线元素为 $b_i = 2$（$i = 1,\\dots,n$），超对角线元素为 $c_i = -1$（$i = 1,\\dots,n-1$），因此 $A$ 是与此离散化对应的托普利茨（Toeplitz）三对角矩阵。\n\n从数值线性代数的角度来看，在这种情况下，有两种经典方法可以求解 $A \\mathbf{x} = \\mathbf{b}$：\n- Thomas 算法（不进行主元选择的三对角高斯消元法），该算法利用了三对角结构。\n- 基于带部分主元选择的 LU (Lower-Upper) 分解的通用稠密求解器，该方法忽略了稀疏性，将 $A$ 视为一个稠密矩阵。\n\n仅从上述离散化方法出发，实现这两种求解器，并在相同的三对角系统上比较它们的数值精度和计算成本。通过以下方式构造一个合成的右端项以保证已知精确解：对于给定的 $n$，定义精确解向量 $\\mathbf{x}^{\\star} \\in \\mathbb{R}^n$，其分量为 $x_i^{\\star} = \\sin\\!\\left(\\pi \\dfrac{i}{n+1}\\right)$，$i = 1,\\dots,n$。然后设置 $\\mathbf{b} = A \\mathbf{x}^{\\star}$。对于每个求解器，计算：\n- 相对 2-范数误差 $e = \\dfrac{\\lVert \\mathbf{x} - \\mathbf{x}^{\\star} \\rVert_2}{\\lVert \\mathbf{x}^{\\star} \\rVert_2}$，\n- 2-范数残差 $r = \\lVert \\mathbf{b} - A \\mathbf{x} \\rVert_2$。\n\n对于计算成本，按如下方式报告操作计数：\n- 对于 Thomas 算法，使用精确计数 $F_{\\mathrm{T}}(n) = 8n - 7$，该计数将每次加法、减法、乘法和除法都计为一次浮点运算。\n- 对于带部分主元选择的稠密 LU 求解器，使用标准的稠密估算 $F_{\\mathrm{LU}}(n) = \\dfrac{2}{3} n^3 + 2 n^2$，该估算覆盖了分解以及前向和后向代换的成本。\n\n您的实现必须是一个完整的、可运行的程序，该程序：\n- 为每个测试用例根据上述规范构造 $A$ 和 $\\mathbf{b}$，\n- 用两种方法求解该系统，\n- 计算规定的精度指标和成本估算，\n- 以指定格式生成输出。\n\n测试套件：\n- 使用以下内部节点数 $n$ 的集合来测试不同的情况和边界情形：$n \\in \\{\\,1,\\,2,\\,50,\\,400\\,\\}$。\n\n可量化的答案：\n- 对于每个测试用例 $n$，生成一个包含六个浮点数的列表：$[e_{\\mathrm{T}}, e_{\\mathrm{LU}}, r_{\\mathrm{T}}, r_{\\mathrm{LU}}, F_{\\mathrm{T}}(n), F_{\\mathrm{LU}}(n)]$。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的、以逗号分隔的结果列表。列表中的每个项目是对应于一个测试用例（按 $n = 1$、$n = 2$、$n = 50$、$n = 400$ 的顺序）的列表。例如：$[\\,[\\cdots],\\,[\\cdots],\\,[\\cdots],\\,[\\cdots]\\,]$。\n- 所有报告的量都是无量纲实数（无物理单位）。不使用角度，也不要求百分比；任何比率都必须以实数形式提供。", "solution": "所提出的问题是有效的。这是一个适定的、具有科学依据的数值线性代数问题，可直接应用于计算流体力学。所有必要的数据和定义都已提供，没有矛盾或含糊之处。\n\n该问题要求比较两种不同的数值方法，用于求解由一维稳态扩散方程的有限差分离散化产生的线性系统 $A \\mathbf{x} = \\mathbf{b}$。这两种方法是 Thomas 算法（一种用于三对角系统的专门求解器）和基于带部分主元选择的 LU 分解的通用稠密求解器。\n\n控制偏微分方程是单位区间 $x \\in [0, 1]$ 上的一维泊松方程：\n$$\n-\\frac{d^2 u}{dx^2} = f(x)\n$$\n其齐次狄利克雷边界条件为 $u(0)=0$ 和 $u(1)=0$。\n\n引入一个具有 $n$ 个内部节点 $x_i = i h$（$i=1, \\dots, n$）的均匀网格，其中网格间距为 $h = \\frac{1}{n+1}$。边界点为 $x_0 = 0$ 和 $x_{n+1} = 1$。在每个内部节点 $x_i$ 处，使用二阶中心差分来近似二阶导数：\n$$\n\\frac{d^2 u}{dx^2}\\bigg|_{x_i} \\approx \\frac{u(x_{i-1}) - 2u(x_i) + u(x_{i+1})}{h^2} = \\frac{u_{i-1} - 2u_i + u_{i+1}}{h^2}\n$$\n将其代入控制方程，得到一个包含 $n$ 个线性方程的系统：\n$$\n-\\frac{u_{i-1} - 2u_i + u_{i+1}}{h^2} = f(x_i) \\quad \\text{for } i = 1, \\dots, n\n$$\n其中 $u_0 = u(0) = 0$ 且 $u_{n+1} = u(1) = 0$。整理后，我们得到：\n$$\n-u_{i-1} + 2u_i - u_{i+1} = h^2 f(x_i)\n$$\n这可以表示为矩阵系统 $A \\mathbf{u} = \\mathbf{b}$，其中 $\\mathbf{u} = [u_1, u_2, \\dots, u_n]^T$ 是内部节点上的未知值向量，$\\mathbf{b} = h^2 [f(x_1), \\dots, f(x_n)]^T$，而 $A$ 是问题陈述中定义的 $n \\times n$ 三对角矩阵：\n$$\nA = \\begin{pmatrix}\n2  -1    \\\\\n-1  2  -1   \\\\\n \\ddots  \\ddots  \\ddots  \\\\\n  -1  2  -1 \\\\\n   -1  2\n\\end{pmatrix}\n$$\n该矩阵是对称正定的。对于第一行和最后一行，它是严格对角占优的；对于所有其他行，它是弱对角占优的。这些性质对于数值求解器的稳定性至关重要。\n\n问题通过首先定义一个精确解 $\\mathbf{x}^{\\star}$，然后计算 $\\mathbf{b} = A \\mathbf{x}^{\\star}$ 的方式，指定了一个合成的右端向量 $\\mathbf{b}$。精确解的分量为 $x_i^{\\star} = \\sin(\\pi \\frac{i}{n+1})$，$i=1, \\dots, n$。这种方法被称为“制造解法”（Method of Manufactured Solutions），它允许对数值误差进行精确量化。\n\n**方法1：Thomas 算法**\n\nThomas 算法是一种求解三对角方程组的高效专用方法。它是一种高斯消元法的形式，避免了对矩阵中零元素的操作，从而使计算成本为 $O(n)$ 阶。它包括两个阶段：一个前向消元过程和一个后向代换过程。\n\n给定一个三对角系统，其次对角线为 $a_i$（$i=2, \\dots, n$），主对角线为 $d_i$（$i=1, \\dots, n$），超对角线为 $c_i$（$i=1, \\dots, n-1$），以及右端向量 $r_i$：\n$$\na_i x_{i-1} + d_i x_i + c_i x_{i+1} = r_i\n$$\n问题陈述中使用 $b_i$ 表示主对角线，所以我们在这里也使用该表示法（$d_i \\equiv b_i$）：\n1.  **前向消元**：该算法修改超对角线系数 $c_i$ 和右端向量 $r_i$。设修改后的系数为 $c'_i$ 和 $r'_i$。\n    $$\n    c'_1 = \\frac{c_1}{b_1} \\quad ; \\quad r'_1 = \\frac{r_1}{b_1}\n    $$\n    对于 $i = 2, \\dots, n-1$：\n    $$\n    c'_i = \\frac{c_i}{b_i - a_i c'_{i-1}}\n    $$\n    以及对于 $i = 2, \\dots, n$：\n    $$\n    r'_i = \\frac{r_i - a_i r'_{i-1}}{b_i - a_i c'_{i-1}}\n    $$\n2.  **后向代换**：解向量 $\\mathbf{x}$ 按相反顺序计算。\n    $$\n    x_n = r'_n\n    $$\n    对于 $i = n-1, \\dots, 1$：\n    $$\n    x_i = r'_i - c'_i x_{i+1}\n    $$\n由于矩阵 $A$ 是对角占优的，分母 $b_i - a_i c'_{i-1}$ 永远不为零，这保证了该算法是适定的，并且在没有主元选择的情况下是数值稳定的。其计算成本由 $F_{\\mathrm{T}}(n) = 8n - 7$ 个浮点运算给出。\n\n**方法2：带部分主元选择的稠密 LU 分解**\n\n这是一种适用于任何可逆方阵的通用方法。它不利用 $A$ 的三对角结构。该方法首先将矩阵 $A$ 分解为乘积 $PA = LU$，其中 $P$ 是一个置换矩阵（表示为保证数值稳定性而进行的行交换，称为部分主元选择），$L$ 是一个单位下三角矩阵，而 $U$ 是一个上三角矩阵。\n\n系统 $A\\mathbf{x} = \\mathbf{b}$ 被转换为 $PA\\mathbf{x} = P\\mathbf{b}$，进而变为 $LU\\mathbf{x} = P\\mathbf{b}$。该问题通过两步解决：\n1.  **前向代换**：求解下三角系统 $L\\mathbf{y} = P\\mathbf{b}$ 得到 $\\mathbf{y}$。\n2.  **后向代换**：求解上三角系统 $U\\mathbf{x} = \\mathbf{y}$ 得到 $\\mathbf{x}$。\n\n虽然这种方法很稳健，但对于三对角矩阵来说，其计算成本要高得多。成本主要由分解步骤决定，对于一个稠密的 $n \\times n$ 矩阵，其成本为 $O(n^3)$。问题提供了标准成本估算 $F_{\\mathrm{LU}}(n) = \\frac{2}{3}n^3 + 2n^2$。\n\n**比较指标**\n\n对于每个求解器，我们计算两个关键指标：\n1.  **相对 2-范数误差**：$e = \\frac{\\lVert \\mathbf{x} - \\mathbf{x}^{\\star} \\rVert_2}{\\lVert \\mathbf{x}^{\\star} \\rVert_2}$。这个指标衡量计算出的解 $\\mathbf{x}$ 与已知的精确解 $\\mathbf{x}^{\\star}$ 的接近程度。值越小，表示精度越高。\n2.  **2-范数残差**：$r = \\lVert \\mathbf{b} - A \\mathbf{x} \\rVert_2$。这个指标衡量计算出的解 $\\mathbf{x}$ 在多大程度上满足原始方程。小的残差并不总能保证小的误差，特别是对于病态矩阵，但它是求解器性能的一个重要指标。\n\n实现将通过遍历指定的 $n$ 值来进行，为每个 $n$ 构造矩阵 $A$ 以及向量 $\\mathbf{x}^{\\star}$ 和 $\\mathbf{b}$，应用两种求解器，并计算六个指定的量（$e_{\\mathrm{T}}$、$e_{\\mathrm{LU}}$、$r_{\\mathrm{T}}$、$r_{\\mathrm{LU}}$、$F_{\\mathrm{T}}(n)$、$F_{\\mathrm{LU}}(n)$）。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import solve as dense_solve\n\ndef thomas_solver(a, b, c, d):\n    \"\"\"\n    Solves a tridiagonal system Ax = d.\n    'a' is the sub-diagonal (n-1 elements), 'b' is the main diagonal (n elements),\n    'c' is the super-diagonal (n-1 elements), 'd' is the RHS vector (n elements).\n    The problem statement uses 1-based indexing for math notation, but here we\n    use 0-based indexing standard in programming.\n    a: sub-diagonal, a[i] is A[i+1, i]\n    b: main-diagonal, b[i] is A[i, i]\n    c: super-diagonal, c[i] is A[i, i+1]\n    \"\"\"\n    n = len(d)\n    if n == 0:\n        return np.array([])\n    if n == 1:\n        return np.array([d[0] / b[0]])\n\n    # Create modifiable copies of the super-diagonal and RHS vector\n    c_prime = np.zeros(n - 1)\n    d_prime = np.zeros(n)\n    \n    # Forward elimination\n    c_prime[0] = c[0] / b[0]\n    d_prime[0] = d[0] / b[0]\n    \n    for i in range(1, n - 1):\n        denominator = b[i] - a[i - 1] * c_prime[i - 1]\n        c_prime[i] = c[i] / denominator\n        d_prime[i] = (d[i] - a[i - 1] * d_prime[i - 1]) / denominator\n\n    denominator = b[n - 1] - a[n - 2] * c_prime[n - 2]\n    d_prime[n - 1] = (d[n - 1] - a[n - 2] * d_prime[n - 2]) / denominator\n    \n    # Backward substitution\n    x = np.zeros(n)\n    x[n - 1] = d_prime[n - 1]\n    for i in range(n - 2, -1, -1):\n        x[i] = d_prime[i] - c_prime[i] * x[i + 1]\n        \n    return x\n\ndef solve():\n    \"\"\"\n    Main function to run the comparison for the test suite.\n    \"\"\"\n    test_cases = [1, 2, 50, 400]\n    results = []\n\n    for n in test_cases:\n        # Step 1: Construct the linear system A x = b with a known solution x_star\n        \n        # Define the matrix A as a dense matrix for the LU solver and for calculating residuals\n        if n == 1:\n            A = np.array([[2.0]])\n        else:\n            main_diag_vals = np.full(n, 2.0)\n            sub_diag_vals = np.full(n - 1, -1.0)\n            sup_diag_vals = np.full(n - 1, -1.0)\n            A = np.diag(main_diag_vals) + np.diag(sup_diag_vals, k=1) + np.diag(sub_diag_vals, k=-1)\n        \n        # Define the exact solution vector x_star\n        i = np.arange(1, n + 1)\n        x_star = np.sin(np.pi * i / (n + 1))\n        \n        # Compute the right-hand side vector b = A * x_star\n        b = A @ x_star\n        \n        # Step 2: Solve the system using both methods\n        \n        # Method 1: Thomas Algorithm\n        if n > 1:\n            x_T = thomas_solver(sub_diag_vals, main_diag_vals, sup_diag_vals, b)\n        else: # Handle n=1 case for Thomas algorithm\n            x_T = thomas_solver(np.array([]), np.array([2.0]), np.array([]), b)\n\n        # Method 2: Dense LU solver with partial pivoting\n        x_LU = dense_solve(A, b)\n        \n        # Step 3: Compute accuracy metrics and computational costs\n        \n        # Relative 2-norm error\n        norm_x_star = np.linalg.norm(x_star)\n        e_T = np.linalg.norm(x_T - x_star) / norm_x_star\n        e_LU = np.linalg.norm(x_LU - x_star) / norm_x_star\n        \n        # 2-norm residual\n        r_T = np.linalg.norm(b - A @ x_T)\n        r_LU = np.linalg.norm(b - A @ x_LU)\n        \n        # Computational cost estimates\n        F_T = float(8 * n - 7)\n        F_LU = (2.0 / 3.0) * n**3 + 2.0 * n**2\n        \n        # Store the results for this test case\n        results.append([e_T, e_LU, r_T, r_LU, F_T, F_LU])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3383321"}, {"introduction": "一个精确的代数系统求解器并不能保证得到物理上真实可靠的解。本练习将托马斯算法置于更广阔的CFD应用背景中，揭示一个至关重要的区别：求解误差与离散误差。你将分析一个对流占优流动问题，其中中心差分格式会因其内在缺陷（当单元佩克莱数 $Pe \\gt 2$ 时）而产生非物理振荡。这个练习清晰地表明，托马斯算法能够精确地求解所构建的代数方程组，但数值解的非物性根源在于离散格式本身，这是每一位CFD工程师都必须掌握的核心辨析能力。 [@problem_id:3383308]", "problem": "考虑由物性恒定的守恒定律控制的被动标量 $\\,\\phi(x)\\,$ 的稳态一维输运，\n$$ \\frac{d}{dx}\\Big(\\Gamma \\frac{d\\phi}{dx}\\Big) - \\rho v \\frac{d\\phi}{dx} = 0, $$\n在区间 $\\,x \\in [0,L]\\,$ 上，边界条件为狄利克雷边界条件 $\\,\\phi(0)=1\\,$ 和 $\\,\\phi(L)=0\\,$。设区域长度为 $\\,L=1\\,$，并在一个单位横截面积 $\\,A=1\\,$ 的均匀网格上，将其离散为 $\\,N=4\\,$ 个等宽的内部控制体，宽度为 $\\,\\Delta x = L/(N+1)\\,$。在控制体中心有限体积格式中，对控制体表面的对流通量和扩散通量使用中心差分法，以获得关于内部节点值 $\\,\\{\\phi_i\\}_{i=1}^{N}\\,$ 的三对角线性系统。\n\n取恒定的正向流速 $\\,v>0\\,$，常数 $\\,\\Gamma=0.2\\,$ 和 $\\,\\rho v = 4\\,$，因此表面质量通量为 $\\,F=\\rho v\\,$，扩散导率为 $\\,D=\\Gamma/\\Delta x\\,$。将三对角系统组装成系数形式\n$$ a_i\\,\\phi_{i-1} + b_i\\,\\phi_i + c_i\\,\\phi_{i+1} = d_i, \\quad i=1,\\dots,N, $$\n并根据需要将边界值并入右侧项。然后，使用 Thomas 算法精确求解此三对角系统，以获得离散解。在此过程中，明确指出一个通用内部节点的中心差分系数 $\\,a_W\\,$ 和 $\\,a_E\\,$，并判断所得系统矩阵中的非对角元是否满足非奇异 M 矩阵的非正性要求。判断离散解是否在边界值之间是单调的。\n\n内部节点未知数 $\\,\\phi_3\\,$ 的计算值是多少？将您的答案表示为一个无量纲数，并四舍五入到四位有效数字。", "solution": "我们从物性恒定的稳态一维对流-扩散平衡方程开始，\n$$ \\frac{d}{dx}\\Big(\\Gamma \\frac{d\\phi}{dx}\\Big) - \\rho v \\frac{d\\phi}{dx} = 0, $$\n并在区间 $\\,x\\in[0,L]\\,$ 上应用控制体中心有限体积法，其中 $\\,L=1\\,$，有 $\\,N=4\\,$ 个内部单元，等间距 $\\,\\Delta x = L/(N+1) = 1/5 = 0.2\\,$。横截面积为 $\\,A=1\\,$，扩散系数为 $\\,\\Gamma=0.2\\,$，质量通量为 $\\,F=\\rho v = 4\\,$。每个面的扩散导率为\n$$ D \\equiv \\frac{\\Gamma}{\\Delta x} = \\frac{0.2}{0.2} = 1. $$\n\n对每个内部控制体中的对流和扩散均使用中心差分，标准的有限体积平衡方程可以写成典范形式\n$$ a_P\\,\\phi_P = a_W\\,\\phi_W + a_E\\,\\phi_E, $$\n其中对于正向流动方向 $\\,v>0\\,$，内部节点的中心差分系数为\n$$ a_W = D + \\frac{F}{2}, \\qquad a_E = D - \\frac{F}{2}, \\qquad a_P = a_W + a_E. $$\n代入 $\\,D=1\\,$ 和 $\\,F=4\\,$ 得到\n$$ a_W = 3, \\qquad a_E = 1 - \\frac{4}{2} = -1, \\qquad a_P = 3 + (-1) = 2. $$\n\n为揭示矩阵结构，将每个内部方程重新排列为\n$$ a_P\\,\\phi_i - a_W\\,\\phi_{i-1} - a_E\\,\\phi_{i+1} = 0. $$\n在系数矩阵表示法中，对角系数为 $\\,b_i=a_P=2\\,$，次对角线系数为 $\\,a_i=-a_W=-3\\,$，超对角线系数为 $\\,c_i=-a_E=1\\,$。将狄利克雷边界条件 $\\,\\phi_0=1\\,$ 和 $\\,\\phi_5=0\\,$ 并入第一个和最后一个内部方程中，得到\n- 对于 $\\,i=1\\,$：\n$$ b_1\\,\\phi_1 + c_1\\,\\phi_2 = d_1, \\quad \\text{其中} \\quad b_1=2,\\; c_1=1,\\; d_1=a_W\\,\\phi_0=3\\cdot 1=3. $$\n- 对于 $\\,i=2,3\\,$：\n$$ a_i\\,\\phi_{i-1} + b_i\\,\\phi_i + c_i\\,\\phi_{i+1} = d_i, \\quad \\text{其中} \\quad a_i=-3,\\; b_i=2,\\; c_i=1,\\; d_i=0. $$\n- 对于 $\\,i=4\\,$：\n$$ a_4\\,\\phi_3 + b_4\\,\\phi_4 = d_4, \\quad \\text{其中} \\quad a_4=-3,\\; b_4=2,\\; d_4=a_E\\,\\phi_5=(-1)\\cdot 0=0. $$\n\n观察 M 矩阵准则：在组装后的系数矩阵中，非对角元为 $\\,a_i=-a_W=-3\\,$ 和 $\\,c_i=-a_E=1>0\\,$。$\\,c_i\\,$ 的正性违反了非奇异 M 矩阵要求的非对角元非正性。这种违反的发生是因为对于所选参数 $\\,a_E  0\\,$，等效地，单元佩克莱数 $\\,\\text{Pe} = F/D = 4\\,$ 超过了中心差分阈值 $\\,2\\,$。因此，可能会出现非单调的离散解。\n\n我们现在使用 Thomas 算法求解三对角系统。将系统写成标准三对角形式\n$$ a_i \\phi_{i-1} + b_i \\phi_i + c_i \\phi_{i+1} = d_i, \\quad i=1,\\dots,4, $$\n其中\n$$\n\\begin{aligned}\n a_1=0,\\; b_1=2,\\; c_1=1,\\; d_1=3, \\\\\n a_2=-3,\\; b_2=2,\\; c_2=1,\\; d_2=0, \\\\\n a_3=-3,\\; b_3=2,\\; c_3=1,\\; d_3=0, \\\\\n a_4=-3,\\; b_4=2,\\; c_4=0,\\; d_4=0.\n\\end{aligned}\n$$\n\n前向消元步骤。通过以下方式定义修正系数 $\\,\\tilde{c}_i\\,$ 和 $\\,\\tilde{d}_i\\,$\n$$ \\tilde{c}_1 = \\frac{c_1}{b_1}, \\qquad \\tilde{d}_1 = \\frac{d_1}{b_1}, $$\n且对于 $\\,i=2,\\dots,4\\,$，\n$$ \\beta_i = b_i - a_i \\tilde{c}_{i-1}, \\qquad \\tilde{c}_i = \\frac{c_i}{\\beta_i}, \\qquad \\tilde{d}_i = \\frac{d_i - a_i \\tilde{d}_{i-1}}{\\beta_i}. $$\n依次计算：\n- 对于 $\\,i=1\\,$：\n$$ \\tilde{c}_1 = \\frac{1}{2} = \\frac{1}{2}, \\qquad \\tilde{d}_1 = \\frac{3}{2}. $$\n- 对于 $\\,i=2\\,$：\n$$ \\beta_2 = 2 - (-3)\\cdot \\frac{1}{2} = 2 + \\frac{3}{2} = \\frac{7}{2}, \\quad \\tilde{c}_2 = \\frac{1}{\\beta_2} = \\frac{2}{7}, \\quad \\tilde{d}_2 = \\frac{0 - (-3)\\cdot \\frac{3}{2}}{\\frac{7}{2}} = \\frac{\\frac{9}{2}}{\\frac{7}{2}} = \\frac{9}{7}. $$\n- 对于 $\\,i=3\\,$：\n$$ \\beta_3 = 2 - (-3)\\cdot \\frac{2}{7} = 2 + \\frac{6}{7} = \\frac{20}{7}, \\quad \\tilde{c}_3 = \\frac{1}{\\beta_3} = \\frac{7}{20}, \\quad \\tilde{d}_3 = \\frac{0 - (-3)\\cdot \\frac{9}{7}}{\\frac{20}{7}} = \\frac{\\frac{27}{7}}{\\frac{20}{7}} = \\frac{27}{20}. $$\n- 对于 $\\,i=4\\,$：\n$$ \\beta_4 = 2 - (-3)\\cdot \\frac{7}{20} = 2 + \\frac{21}{20} = \\frac{61}{20}, \\quad \\tilde{d}_4 = \\frac{0 - (-3)\\cdot \\frac{27}{20}}{\\frac{61}{20}} = \\frac{\\frac{81}{20}}{\\frac{61}{20}} = \\frac{81}{61}. $$\n\n回代步骤。设\n$$ \\phi_4 = \\tilde{d}_4 = \\frac{81}{61}, $$\n且对于 $\\,i=3,2,1\\,$ 计算\n$$ \\phi_i = \\tilde{d}_i - \\tilde{c}_i \\phi_{i+1}. $$\n因此，\n$$ \\phi_3 = \\tilde{d}_3 - \\tilde{c}_3 \\phi_4 = \\frac{27}{20} - \\frac{7}{20}\\cdot \\frac{81}{61} = \\frac{27}{20} - \\frac{567}{1220} = \\frac{1647 - 567}{1220} = \\frac{1080}{1220} = \\frac{54}{61}. $$\n为完整起见，\n$$ \\phi_2 = \\tilde{d}_2 - \\tilde{c}_2 \\phi_3 = \\frac{9}{7} - \\frac{2}{7}\\cdot \\frac{54}{61} = \\frac{63}{61}, \\qquad \\phi_1 = \\tilde{d}_1 - \\tilde{c}_1 \\phi_2 = \\frac{3}{2} - \\frac{1}{2}\\cdot \\frac{63}{61} = \\frac{60}{61}. $$\n\n计算得到的内部数值分布 $\\,\\{\\phi_i\\}\\,$ 为\n$$ \\phi_1 = \\frac{60}{61}, \\quad \\phi_2 = \\frac{63}{61}, \\quad \\phi_3 = \\frac{54}{61}, \\quad \\phi_4 = \\frac{81}{61}. $$\n这些值相对于边界值 $\\,\\phi(0)=1\\,$ 和 $\\,\\phi(1)=0\\,$ 发生振荡，其中 $\\,\\phi_21\\,$ 和 $\\,\\phi_41\\,$，这表明尽管通过 Thomas 算法精确求解了三对角系统，但离散解是非单调的。这种非单调性与因在 $\\,\\text{Pe}=F/D=42\\,$ 时使用中心差分而导致的正超对角元 $\\,c_i=-a_E=10\\,$ 从而违反非奇异 M 矩阵条件的情况相一致。\n\n最后，所求的节点值为\n$$ \\phi_3 = \\frac{54}{61} \\approx 0.8852459016\\ldots, $$\n四舍五入到四位有效数字后为 $\\,0.8852\\,$，且为无量纲数。", "answer": "$$\\boxed{0.8852}$$", "id": "3383308"}]}