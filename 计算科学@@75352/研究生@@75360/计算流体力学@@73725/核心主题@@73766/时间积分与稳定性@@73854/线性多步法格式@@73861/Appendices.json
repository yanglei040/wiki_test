{"hands_on_practices": [{"introduction": "线性多步法 (Linear Multistep Method, LMM) 的核心在于其系数 $\\alpha_j$ 和 $\\beta_j$ 的选择，这些系数直接决定了方法的精度。本练习将引导你通过泰勒级数展开，为一种特定的显式三步法推导出一组能使其代数阶数最大化的系数。这个过程是设计和理解任何 LMM 的基本功，它揭示了方法的截断误差与其系数之间的深刻联系。[@problem_id:3340816]", "problem": "考虑一个计算流体力学中出现的守恒律的半离散格式，其中空间离散化产生了一个形式为 $y^{\\prime}(t) = f(t,y(t))$ 的自治常微分方程组，其中 $y(t) \\in \\mathbb{R}^{m}$。您希望使用一个写成后向索引形式的 $k=3$ 步的线性多步法将解在时间上推进\n$$\n\\sum_{j=0}^{3} \\alpha_{j}\\, y_{n-j} \\;=\\; h \\sum_{j=0}^{3} \\beta_{j}\\, f_{n-j},\n$$\n其中 $t_{n} = t_{0} + n h$，$y_{n} \\approx y(t_{n})$，$f_{n-j} = f(t_{n-j}, y_{n-j})$，且 $h0$ 是时间步长。给定一个候选的显式3步法，其系数为\n$$\n\\alpha = ( \\alpha_{0}, \\alpha_{1}, \\alpha_{2}, \\alpha_{3} ) = (1,\\,-1,\\,0,\\,0), \\qquad \\beta = ( \\beta_{0}, \\beta_{1}, \\beta_{2}, \\beta_{3} ) = (0,\\,\\beta_{1},\\,\\beta_{2},\\,\\beta_{3}).\n$$\n“显式”指的是 $\\beta_{0} = 0$，因此右侧不依赖于新时间层上的 $f_{n} = f(t_{n},y_{n})$。从局部截断误差的定义和关于 $t_{n}$ 的泰勒展开出发，确定 $\\beta_{1}$、$\\beta_{2}$ 和 $\\beta_{3}$ 以最大化代数阶，然后通过推导局部截断误差的首项来验证所达到的阶。将您最终的 $\\beta_{1}$、$\\beta_{2}$ 和 $\\beta_{3}$ 的值以精确有理数形式表示。不需要四舍五入。最终答案必须是三元组 $(\\beta_{1}, \\beta_{2}, \\beta_{3})$。", "solution": "我们从自治常微分方程 $y^{\\prime}(t) = f(t,y(t))$ 和后向索引形式的线性多步法开始\n$$\n\\sum_{j=0}^{3} \\alpha_{j} y_{n-j} \\;=\\; h \\sum_{j=0}^{3} \\beta_{j} f_{n-j}.\n$$\n使用给定的系数 $\\alpha = (1,-1,0,0)$ 和 $\\beta = (0,\\beta_{1},\\beta_{2},\\beta_{3})$，该格式可写为\n$$\ny_{n} - y_{n-1} \\;=\\; h\\left(\\beta_{1} f_{n-1} + \\beta_{2} f_{n-2} + \\beta_{3} f_{n-3}\\right).\n$$\n为了最大化代数阶，我们将精确解代入，并围绕 $t_{n}$ 进行泰勒级数展开，然后强制等式精确成立。假设 $y(t)$ 足够光滑。使用关于 $t_{n}$ 的泰勒展开，\n$$\ny(t_{n-1}) = y(t_{n} - h) = y(t_{n}) - h y^{\\prime}(t_{n}) + \\frac{h^{2}}{2} y^{\\prime\\prime}(t_{n}) - \\frac{h^{3}}{6} y^{\\prime\\prime\\prime}(t_{n}) + \\frac{h^{4}}{24} y^{(4)}(t_{n}) - \\frac{h^{5}}{120} y^{(5)}(t_{n}) + \\dots,\n$$\n因此\n$$\ny_{n} - y_{n-1} = h y^{\\prime}(t_{n}) - \\frac{h^{2}}{2} y^{\\prime\\prime}(t_{n}) + \\frac{h^{3}}{6} y^{\\prime\\prime\\prime}(t_{n}) - \\frac{h^{4}}{24} y^{(4)}(t_{n}) + \\frac{h^{5}}{120} y^{(5)}(t_{n}) + \\dots.\n$$\n在右侧，我们使用 $f_{n-j} = y^{\\prime}(t_{n-j})$ 并展开\n$$\ny^{\\prime}(t_{n-j}) = y^{\\prime}(t_{n}) - j h\\, y^{\\prime\\prime}(t_{n}) + \\frac{(j h)^{2}}{2} y^{\\prime\\prime\\prime}(t_{n}) - \\frac{(j h)^{3}}{6} y^{(4)}(t_{n}) + \\frac{(j h)^{4}}{24} y^{(5)}(t_{n}) + \\dots.\n$$\n因此，\n$$\n\\begin{aligned}\nh \\sum_{j=1}^{3} \\beta_{j} y^{\\prime}(t_{n-j})\n= h\\Bigg[\\left(\\sum_{j=1}^{3} \\beta_{j}\\right) y^{\\prime}(t_{n})\n- h\\left(\\sum_{j=1}^{3} j \\beta_{j}\\right) y^{\\prime\\prime}(t_{n})\n+ \\frac{h^{2}}{2}\\left(\\sum_{j=1}^{3} j^{2} \\beta_{j}\\right) y^{\\prime\\prime\\prime}(t_{n}) \\\\\n\\qquad\\quad - \\frac{h^{3}}{6}\\left(\\sum_{j=1}^{3} j^{3} \\beta_{j}\\right) y^{(4)}(t_{n})\n+ \\frac{h^{4}}{24}\\left(\\sum_{j=1}^{3} j^{4} \\beta_{j}\\right) y^{(5)}(t_{n})\n+ \\dots \\Bigg].\n\\end{aligned}\n$$\n为达到代数阶 $p$，将右侧从左侧减去得到的残差 $R_{n}$ 的第一个非零项必须是 $h^{p+1}$ 阶的。将 $h$ 的同次幂的系数相等，直到可能达到的最高阶，得到阶条件：\n$$\n\\begin{aligned}\nh\\,y^{\\prime}:\\quad 1 = \\sum_{j=1}^{3} \\beta_{j}, \\\\\nh^{2}\\,y^{\\prime\\prime}:\\quad -\\frac{1}{2} = - \\sum_{j=1}^{3} j \\beta_{j} \\;\\;\\Longrightarrow\\;\\; \\sum_{j=1}^{3} j \\beta_{j} = \\frac{1}{2}, \\\\\nh^{3}\\,y^{\\prime\\prime\\prime}:\\quad \\frac{1}{6} = \\frac{1}{2} \\sum_{j=1}^{3} j^{2} \\beta_{j} \\;\\;\\Longrightarrow\\;\\; \\sum_{j=1}^{3} j^{2} \\beta_{j} = \\frac{1}{3}, \\\\\nh^{4}\\,y^{(4)}:\\quad -\\frac{1}{24} = -\\frac{1}{6} \\sum_{j=1}^{3} j^{3} \\beta_{j} \\;\\;\\Longrightarrow\\;\\; \\sum_{j=1}^{3} j^{3} \\beta_{j} = \\frac{1}{4},\n\\end{aligned}\n$$\n依此类推。对于三个未知数 $\\beta_{1}, \\beta_{2}, \\beta_{3}$，我们最多能满足前三个方程。将它们明确写出，\n$$\n\\begin{cases}\n\\beta_{1} + \\beta_{2} + \\beta_{3} = 1, \\\\\n\\beta_{1} + 2 \\beta_{2} + 3 \\beta_{3} = \\frac{1}{2}, \\\\\n\\beta_{1} + 4 \\beta_{2} + 9 \\beta_{3} = \\frac{1}{3}.\n\\end{cases}\n$$\n将第一个方程从第二个方程中减去，并将第二个方程从第三个方程中减去，得到\n$$\n\\begin{cases}\n\\beta_{2} + 2 \\beta_{3} = -\\frac{1}{2}, \\\\\n2 \\beta_{2} + 6 \\beta_{3} = -\\frac{1}{6}.\n\\end{cases}\n$$\n求解，从第一个方程我们得到 $\\beta_{2} = -\\frac{1}{2} - 2 \\beta_{3}$。代入第二个方程，\n$$\n2\\left(-\\frac{1}{2} - 2 \\beta_{3}\\right) + 6 \\beta_{3} = -\\frac{1}{6}\n\\;\\;\\Longrightarrow\\;\\;\n-1 - 4 \\beta_{3} + 6 \\beta_{3} = -\\frac{1}{6}\n\\;\\;\\Longrightarrow\\;\\;\n2 \\beta_{3} = \\frac{5}{6}\n\\;\\;\\Longrightarrow\\;\\;\n\\beta_{3} = \\frac{5}{12}.\n$$\n然后\n$$\n\\beta_{2} = -\\frac{1}{2} - 2\\cdot \\frac{5}{12} = -\\frac{1}{2} - \\frac{5}{6} = -\\frac{4}{3},\n$$\n最后\n$$\n\\beta_{1} = 1 - \\beta_{2} - \\beta_{3} = 1 - \\left(-\\frac{4}{3}\\right) - \\frac{5}{12} = \\frac{23}{12}.\n$$\n因此，最大化阶的唯一选择是\n$$\n\\beta_{1} = \\frac{23}{12}, \\quad \\beta_{2} = -\\frac{4}{3}, \\quad \\beta_{3} = \\frac{5}{12}.\n$$\n为了验证所达到的阶，我们检查 $h^{4}$ 阶的下一个条件：\n$$\n\\sum_{j=1}^{3} j^{3} \\beta_{j} = 1^{3}\\cdot \\frac{23}{12} + 2^{3}\\cdot \\left(-\\frac{4}{3}\\right) + 3^{3}\\cdot \\frac{5}{12}\n= \\frac{23}{12} - \\frac{128}{12} + \\frac{135}{12} = \\frac{30}{12} = \\frac{5}{2} \\neq \\frac{1}{4}.\n$$\n因此，$h^{4}$ 阶的条件不满足。$h^{4}$ 阶的局部截断误差残差是乘以 $y^{(4)}(t_{n})$ 的系数之差：\n$$\n\\left(-\\frac{1}{24}\\right) - \\left(-\\frac{1}{6}\\cdot \\frac{5}{2}\\right) = -\\frac{1}{24} + \\frac{5}{12} = \\frac{9}{24} = \\frac{3}{8}.\n$$\n因此，局部截断误差为\n$$\n\\tau_{n} = \\frac{3}{8}\\, h^{4}\\, y^{(4)}(t_{n}) + \\mathcal{O}(h^{5}),\n$$\n这证实了代数阶为 $p=3$。最后，零点稳定性成立，因为齐次差分方程 $y_{n} - y_{n-1} = 0$ 有一个单根 $1$ 和在 $0$ 处的附加根（在单位圆盘内），满足根条件，因此该方法使用计算出的系数确实达到了3阶。", "answer": "$$\\boxed{\\begin{pmatrix}\\frac{23}{12}  -\\frac{4}{3}  \\frac{5}{12}\\end{pmatrix}}$$", "id": "3340816"}, {"introduction": "除了精度，稳定性是 LMM 能够用于实际计算的先决条件，而零稳定性是其中最基本的要求。对于为刚性问题设计的隐式方法（如后向差分格式 BDF），在实际应用中使用可变步长是提高效率的关键，但这会给零稳定性带来新的挑战。本练习探讨了步长比率对 BDF2 和 BDF3 方法零稳定性的影响，通过分析特征多项式的根，你将确定保证稳定性的步长比率界限，这对于开发稳健的自适应求解器至关重要。[@problem_id:3340806]", "problem": "计算流体力学 (CFD) 中出现的粘性对流扩散方程，通过线法进行半离散化，会得到一个形如 $y'(t) = g(y(t))$ 的常微分方程刚性系统，其中 $y(t) \\in \\mathbb{R}^{m}$ 且 $g$ 足够光滑。考虑使用 $k$ 阶变步长后向差分公式 (BDF) 对该系统进行积分，其中步长 $\\{h_{n}\\}$ 可变但被充分解析。定义局部步长比为 $r_{n} = h_{n}/h_{n-1}$，并假设在任意步长 $t_{n}$ 处，过去 $k$ 步的步长比为局部常数 $r  0$，从而使得模板的几何结构是固定的。\n\n从线性多步法构造的第一性原理出发——具体来说，即通过过去的 $k$ 个解值 $y_{n}, y_{n-1}, \\dots, y_{n-k}$ 进行 $k$ 次多项式插值，并通过 Lagrange 插值多项式的导数来确定 $t_{n}$ 处的导数——推导变步长 BDF2 和 BDF3 的更新公式，表示为\n$$\\sum_{j=0}^{k} \\alpha_{j}(r)\\, y_{n-j} = h_{n}\\, f_{n},$$\n其中 $f_{n} = g(y_{n})$，系数 $\\alpha_{j}(r)$ 通过时间网格的几何结构依赖于 $r$。使用冻结系数线性多步法的零稳定性根条件——即特征多项式 $\\rho(\\zeta) = \\sum_{j=0}^{k} \\alpha_{j}(r)\\, \\zeta^{k-j}$ 有一个单根 $\\zeta = 1$，且所有其他根都严格位于单位圆盘内部 $|\\zeta|  1$——确定在局部常数比率假设下，保证 BDF2 和 BDF3 零稳定性的 $r$ 的上确界。\n\n然后，分析当这些界限被违反时，该方法引起的齐次误差递推关系中的误差传播。具体而言：\n- 对于 BDF2，求出非平凡根作为 $r$ 的函数的精确表达式，并推导出当 $r = r^{\\star} + \\epsilon$（其中 $\\epsilon  0$ 很小， $r^{\\star}$ 是你推导出的零稳定性界）时，每步误差增长的主阶因子。\n- 对于 BDF3，使用通过除以平凡因子 $(\\zeta - 1)$ 得到的二次因子，来解释当 $r$ 超出其界限时，两个非平凡根的乘积和模如何变化，并解释由此产生的误差放大的定性行为。\n\n用闭合形式表示 BDF2 和 BDF3 的最大允许步长比对作为你的最终答案。不需要四舍五入，最终答案中不包含任何物理单位。", "solution": "该问题要求在局部常数步长比的假设下，推导变步长 BDF2 和 BDF3 方法，确定它们的零稳定性界，并分析当这些界被违反时的误差传播情况。\n\n### 第1部分：通用公式\n\n对于常微分方程 $y'(t) = g(y(t))$，一个线性 $k$ 步法可以写成 $\\sum_{j=0}^{k} \\alpha_{j} y_{n-j} = h_{n} g(y_n)$，其中 $h_n = t_n - t_{n-1}$ 是当前步长。系数 $\\alpha_j$ 取决于时间网格 $t_n, t_{n-1}, \\dots, t_{n-k}$ 的几何结构。\n\n我们假设所涉及的步长具有局部常数步长比 $r = h_i/h_{i-1}$。这意味着 $h_{n-1} = h_n/r$，$h_{n-2} = h_{n-1}/r = h_n/r^2$，通常地，$h_{n-j} = h_n/r^j$。\n相对于 $t_n$ 的时间点是：\n$t_{n-j} = t_n - \\sum_{i=0}^{j-1} h_{n-i}$ 对于 $j \\ge 1$。\n我们定义一个局部无量纲时间坐标 $\\theta = (t-t_n)/h_n$。在此坐标系中，插值节点为 $\\theta_j = (t_{n-j}-t_n)/h_n$。\n$\\theta_0 = 0$\n$\\theta_1 = -h_n/h_n = -1$\n$\\theta_2 = -(h_n+h_{n-1})/h_n = -(1+1/r)$\n对于 $r \\neq 1$，$\\theta_j = -\\sum_{i=0}^{j-1} \\frac{h_{n-i}}{h_n} = -\\sum_{i=0}^{j-1} r^{-i} = -\\frac{1-r^{-j}}{1-r^{-1}}$。对于 $j \\geq 1$，$\\theta_j = -\\frac{r(1-r^{-j})}{r-1}$。\n\n系数 $\\alpha_j$ 是通过要求该方法对次数最高为 $k$ 的多项式精确来确定的。这导出了以下线性方程组：\n$\\sum_{j=0}^{k} \\alpha_j = 0$\n$\\sum_{j=0}^{k} \\alpha_j \\theta_j = 1$\n$\\sum_{j=0}^{k} \\alpha_j \\theta_j^m = 0, \\quad \\text{对于 } m = 2, 3, \\dots, k$。\n\n### 第2部分：BDF2分析 ($k=2$)\n\n对于 BDF2，我们使用节点 $\\theta_0=0$, $\\theta_1=-1$, 和 $\\theta_2 = -(1+1/r) = -(r+1)/r$。关于 $\\alpha_0, \\alpha_1, \\alpha_2$ 的方程组为：\n$\\alpha_0 + \\alpha_1 + \\alpha_2 = 0$\n$\\alpha_1 \\theta_1 + \\alpha_2 \\theta_2 = 1 \\implies -\\alpha_1 - \\alpha_2 \\frac{r+1}{r} = 1$\n$\\alpha_1 \\theta_1^2 + \\alpha_2 \\theta_2^2 = 0 \\implies \\alpha_1 + \\alpha_2 \\left(\\frac{r+1}{r}\\right)^2 = 0$\n\n从第三个方程，$\\alpha_1 = -\\alpha_2 \\frac{(r+1)^2}{r^2}$。将其代入第二个方程：\n$\\alpha_2 \\frac{(r+1)^2}{r^2} - \\alpha_2 \\frac{r+1}{r} = 1 \\implies \\alpha_2 \\frac{(r+1)^2-r(r+1)}{r^2} = 1 \\implies \\alpha_2 \\frac{r+1}{r^2} = 1$。\n这给出 $\\alpha_2 = \\frac{r^2}{r+1}$。\n然后 $\\alpha_1 = -\\frac{r^2}{r+1} \\frac{(r+1)^2}{r^2} = -(r+1)$。\n最后，$\\alpha_0 = -(\\alpha_1+\\alpha_2) = r+1 - \\frac{r^2}{r+1} = \\frac{(r+1)^2-r^2}{r+1} = \\frac{r^2+2r+1-r^2}{r+1} = \\frac{2r+1}{r+1}$。\n\nBDF2 的公式是：\n$$ \\left(\\frac{2r+1}{r+1}\\right) y_n - (r+1) y_{n-1} + \\left(\\frac{r^2}{r+1}\\right) y_{n-2} = h_n f_n $$\n\n特征多项式是 $\\rho_2(\\zeta) = \\sum_{j=0}^{2} \\alpha_j \\zeta^{2-j}$：\n$$ \\rho_2(\\zeta) = \\left(\\frac{2r+1}{r+1}\\right) \\zeta^2 - (r+1) \\zeta + \\frac{r^2}{r+1} $$\n为了保证零稳定性，一个根必须是 $\\zeta_1=1$（单根），所有其他根必须满足 $|\\zeta|1$。\n$\\rho_2(1) = \\frac{2r+1}{r+1} - (r+1) + \\frac{r^2}{r+1} = \\frac{2r+1 - (r+1)^2 + r^2}{r+1} = 0$，所以 $\\zeta_1=1$ 是一个根。\n根的乘积是 $\\zeta_1 \\zeta_2 = \\alpha_2/\\alpha_0 = \\frac{r^2/(r+1)}{(2r+1)/(r+1)} = \\frac{r^2}{2r+1}$。\n由于 $\\zeta_1=1$，非平凡根是 $\\zeta_2(r) = \\frac{r^2}{2r+1}$。\n零稳定性条件 $|\\zeta_2|1$ 要求，对于 $r>0$：\n$r^2  |2r+1| = 2r+1 \\implies r^2 - 2r - 1  0$。\n$r^2-2r-1=0$ 的根是 $r = \\frac{2 \\pm \\sqrt{4-4(-1)}}{2} = 1 \\pm \\sqrt{2}$。由于 $r>0$，不等式在 $0  r  1+\\sqrt{2}$ 时成立。步长比的上确界是 $r^{\\star}_{\\text{BDF2}} = 1+\\sqrt{2}$。在这个值上，$\\zeta_2=1$，所以根 $\\zeta=1$ 是一个二重根，违反了单位圆上根的单根要求。\n\n当 $r = r^{\\star} + \\epsilon$ 且 $\\epsilon>0$ 很小时的误差分析，误差增长由 $\\zeta_2(r)$ 控制。我们将 $\\zeta_2(r)$ 在 $r^{\\star}$ 附近展开：\n$\\zeta_2(r) \\approx \\zeta_2(r^{\\star}) + \\zeta_2'(r^{\\star})(r-r^{\\star})$。\n$\\zeta_2(r^{\\star}) = \\frac{(1+\\sqrt{2})^2}{2(1+\\sqrt{2})+1} = \\frac{1+2\\sqrt{2}+2}{2+2\\sqrt{2}+1} = \\frac{3+2\\sqrt{2}}{3+2\\sqrt{2}} = 1$。\n导数是 $\\zeta_2'(r) = \\frac{d}{dr}\\left(\\frac{r^2}{2r+1}\\right) = \\frac{2r(2r+1)-2r^2}{(2r+1)^2} = \\frac{2r^2+2r}{(2r+1)^2}$。\n在 $r=r^{\\star}=1+\\sqrt{2}$ 处，我们有 $2r^{\\star}+1 = 3+2\\sqrt{2}$ 和 $r^{\\star}+1=2+\\sqrt{2}$。\n$\\zeta_2'(r^{\\star}) = \\frac{2r^{\\star}(r^{\\star}+1)}{(2r^{\\star}+1)^2} = \\frac{2(1+\\sqrt{2})(2+\\sqrt{2})}{(3+2\\sqrt{2})^2} = \\frac{2(2+3\\sqrt{2}+2)}{9+12\\sqrt{2}+8} = \\frac{2(4+3\\sqrt{2})}{17+12\\sqrt{2}}$。\n分母有理化：\n$\\zeta_2'(r^{\\star}) = \\frac{8+6\\sqrt{2}}{17+12\\sqrt{2}} \\cdot \\frac{17-12\\sqrt{2}}{17-12\\sqrt{2}} = \\frac{136-96\\sqrt{2}+102\\sqrt{2}-72(2)}{17^2-(12\\sqrt{2})^2} = \\frac{-8+6\\sqrt{2}}{289-288} = 6\\sqrt{2}-8$。\n每步误差增长因子是 $\\zeta_2(r) \\approx 1+(6\\sqrt{2}-8)\\epsilon$。由于 $6\\sqrt{2} = \\sqrt{72} > \\sqrt{64}=8$，该因子大于 1，导致误差放大。\n\n### 第3部分：BDF3分析 ($k=3$)\n\n对于 BDF3，节点是 $\\theta_0=0, \\theta_1=-1, \\theta_2=-(1+1/r), \\theta_3=-(1+1/r+1/r^2)$。\n系数 $\\alpha_j$ 由 $k=3$ 的通用系统确定。我们可以用同样的方法推导它们，但表达式很复杂。然而，我们只需要它们之间的某些关系。稳定性分析的相关系数是：\n$\\alpha_0 = -\\sum_{j=1}^3 \\frac{1}{\\theta_j} = 1 + \\frac{r}{r+1} + \\frac{r^2}{r^2+r+1}$\n和\n$\\alpha_3 = \\frac{\\theta_1 \\theta_2}{\\theta_3(\\theta_3-\\theta_1)(\\theta_3-\\theta_2)} = \\frac{(-1)(-(r+1)/r)}{(-(r^2+r+1)/r^2)(-(r+1)/r^2)(-1/r^2))} = \\frac{-r^5}{r^2+r+1}$。\n\n特征多项式 $\\rho_3(\\zeta) = \\alpha_0\\zeta^3 + \\alpha_1\\zeta^2 + \\alpha_2\\zeta + \\alpha_3$ 在 $\\zeta=1$ 处有一个根。我们分析二次因子 $Q(\\zeta) = \\rho_3(\\zeta)/(\\zeta-1) = \\alpha_0\\zeta^2 + (\\alpha_0+\\alpha_1)\\zeta + (\\alpha_0+\\alpha_1+\\alpha_2)$。使用 $\\sum\\alpha_j=0$，这可以简化为 $Q(\\zeta) = \\alpha_0\\zeta^2 + (\\alpha_0+\\alpha_1)\\zeta - \\alpha_3$。\n\n当 $Q(\\zeta)$ 的一个根穿过单位圆时，零稳定性丧失。在远离 $\\zeta=\\pm 1$ 的情况下，这发生在共轭复根对 $\\zeta, \\bar{\\zeta}$ 落在单位圆上时，即 $|\\zeta|=1$。这意味着它们的乘积 $\\zeta\\bar{\\zeta}=1$。根据韦达定理，$Q(\\zeta)$ 的根的乘积是 $-\\alpha_3/\\alpha_0$。因此，稳定边界由 $|-\\alpha_3/\\alpha_0|=1$ 确定。由于对于 $r>0$，$\\alpha_0>0$ 且 $\\alpha_3  0$，该条件变为 $\\alpha_0 = -\\alpha_3$。\n$1 + \\frac{r}{r+1} + \\frac{r^2}{r^2+r+1} = \\frac{r^5}{r^2+r+1}$\n$1 + \\frac{r}{r+1} = \\frac{r^5-r^2}{r^2+r+1} = \\frac{r^2(r^3-1)}{r^2+r+1} = \\frac{r^2(r-1)(r^2+r+1)}{r^2+r+1} = r^2(r-1) = r^3-r^2$。\n$\\frac{r+1+r}{r+1} = r^3-r^2 \\implies \\frac{2r+1}{r+1} = r^3-r^2$。\n$2r+1 = (r+1)(r^3-r^2) = r^4-r^3+r^3-r^2 = r^4-r^2$。\n这产生了稳定边界的多项式方程：$r^4-r^2-2r-1=0$。\n这个多项式可以巧妙地分解为：\n$(r^2-r-1)(r^2+r+1) = 0$。\n项 $r^2+r+1$ 没有实根，并且对于所有实数 $r$ 都为正。因此，稳定边界由 $r^2-r-1=0$ 的根给出，即 $r = \\frac{1 \\pm \\sqrt{5}}{2}$。\n由于我们要求 $r>0$，上确界为 $r^{\\star}_{\\text{BDF3}} = \\frac{1+\\sqrt{5}}{2}$，即黄金比例。\n\n当 $r$ 超过这个界限 $r^{\\star}_{\\text{BDF3}}$ 时，量 $|-\\alpha_3/\\alpha_0|$ 变得大于 1。这意味着两个非平凡根的模的乘积 $|\\zeta_2 \\zeta_3|$ 超过 1。假设在边界之外根仍然是共轭复根对（这可以通过检查 $Q(\\zeta)$ 的判别式来确认），那么两个根都必须移动到单位圆外，即 $|\\zeta_2| = |\\zeta_3| > 1$。这导致不稳定的误差传播，其中误差由于根的复数性质而每一步都被放大并带有振荡分量。\n\nBDF3 的更新公式是：\n$$ \\alpha_0(r) y_n + \\alpha_1(r) y_{n-1} + \\alpha_2(r) y_{n-2} + \\alpha_3(r) y_{n-3} = h_n f_n $$\n其中系数由推导出的表达式给出（例如，$\\alpha_1(r) = -(r^2+r+1)$，$\\alpha_2(r)=\\frac{r^2(r^2+r+1)}{r+1}$ 等）。\n\n### 第4部分：最终答案\n\nBDF2 和 BDF3 的最大允许步长比分别推导为 $1+\\sqrt{2}$ 和 $\\frac{1+\\sqrt{5}}{2}$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix} 1+\\sqrt{2}  \\frac{1+\\sqrt{5}}{2} \\end{pmatrix}\n}\n$$", "id": "3340806"}, {"introduction": "将精度和稳定性理论应用于实践，最终目的是构建高效、可靠的求解器。自适应步长控制是实现这一目标的核心技术，它允许算法根据解的局部行为动态调整时间步长。本练习模拟了这一过程，要求你构建一个嵌入式亚当斯-巴什福斯 (Adams-Bashforth, AB) 方法对来估计局部截断误差，并基于此误差推导出一个步长控制器。通过这个练习，你将掌握现代常微分方程 (ODE) 求解器中用于平衡计算成本和求解精度的基本逻辑。[@problem_id:3340831]", "problem": "考虑计算流体动力学中对流扩散偏微分方程的线方法半离散化，得到一个形式为 $\\mathbf{y}'(t)=\\mathbf{f}(t,\\mathbf{y})$ 的常微分方程组，其中 $\\mathbf{y}(t)\\in\\mathbb{R}^{m}$ 且 $\\mathbf{f}:\\mathbb{R}\\times\\mathbb{R}^{m}\\rightarrow\\mathbb{R}^{m}$ 足够光滑。您需要寻找一种 Adams–Bashforth (AB) 类型的显式线性多步法 (LMM)，该方法带有一个用于自适应步长控制的嵌入对。\n\n从精确积分关系 $\\,\\mathbf{y}(t_{n+1})=\\mathbf{y}(t_n)+\\displaystyle\\int_{t_n}^{t_{n+1}}\\mathbf{f}(t,\\mathbf{y}(t))\\,\\mathrm{d}t\\,$ 出发，通过穿过 $k$ 个等距节点 $t_n,t_{n-1},\\dots,t_{n-k+1}$ 的 $k-1$ 次拉格朗日插值多项式来近似 $\\mathbf{f}(t,\\mathbf{y}(t))$，从而构造 $k$ 步 Adams–Bashforth 公式，并将其特化为 $k=4$ 的情况以获得 $\\text{AB}4$ 方法的系数。类似地，构造使用相同函数求值并在 $t_{n+1}$ 处产生一个低阶更新的嵌入式 $\\text{AB}3$ 公式。\n\n将嵌入对的输出定义为 $\\mathbf{y}_{n+1}^{[4]}$ 和 $\\mathbf{y}_{n+1}^{[3]}$，并使用它们的差来构造高阶方法的局部截断误差的渐近一致估计量。为此，假设实现中将 $\\|\\mathbf{y}_{n+1}^{[4]}-\\mathbf{y}_{n+1}^{[3]}\\|$ 乘以一个已知的校准因子，使得得到的标量 $\\text{err}$ 对于 $\\text{AB}4$ 方法（其中 $p=4$）表现为 $C\\,h^{p+1}$。\n\n从第一性原理出发，推导一个步长控制器，该控制器选择的 $h_{\\text{new}}$ 能使下一步的预测局部截断误差与用户指定的容差 $\\text{tol}$ 相匹配，并通过剪裁将乘法安全因子 $s$ 以及增长下限和上限 $\\alpha_{\\min}$ 和 $\\alpha_{\\max}$ 整合到您的控制器中。\n\n最后，对您的控制器使用以下数值数据进行评估：\n- `AB4/AB3` 嵌入对，其中 $p=4$，\n- 当前步长 $h=1.0\\times 10^{-3}$，\n- 容差 $\\text{tol}=1.0\\times 10^{-6}$，\n- 校准后的误差估计 $\\text{err}=3.0\\times 10^{-7}$，\n- 安全因子 $s=0.9$，\n- 增长下限和上限 $\\alpha_{\\min}=0.5$ 和 $\\alpha_{\\max}=1.5$。\n\n以标准科学记数法报告 $h_{\\text{new}}$ 的数值。将您的答案四舍五入到四位有效数字。", "solution": "用户要求推导 Adams-Bashforth 线性多步法 (LMM)，构建相关的自适应步长控制器，并针对一组特定的数值数据评估该控制器。\n\n问题始于常微分方程 (ODE) 系统 $\\mathbf{y}'(t) = \\mathbf{f}(t, \\mathbf{y})$ 在单个时间步长 $t_n$ 到 $t_{n+1}$ 上的解的精确积分表示：\n$$\n\\mathbf{y}(t_{n+1}) = \\mathbf{y}(t_n) + \\int_{t_n}^{t_{n+1}} \\mathbf{f}(t, \\mathbf{y}(t)) \\, \\mathrm{d}t\n$$\n通过用一个多项式 $P(t)$ 来近似被积函数 $\\mathbf{f}(t, \\mathbf{y}(t))$，可以推导出一种 Adams-Bashforth (AB) 类型的显式 LMM。该多项式对 $k$ 个先前计算的函数值 $\\{ (t_n, \\mathbf{f}_n), (t_{n-1}, \\mathbf{f}_{n-1}), \\dots, (t_{n-k+1}, \\mathbf{f}_{n-k+1}) \\}$ 进行插值，其中 $\\mathbf{f}_j \\equiv \\mathbf{f}(t_j, \\mathbf{y}_j)$。得到的数值公式为：\n$$\n\\mathbf{y}_{n+1} = \\mathbf{y}_n + \\int_{t_n}^{t_{n+1}} P(t) \\, \\mathrm{d}t\n$$\n为了方便积分，我们引入一个无量纲时间变量 $s = (t - t_n) / h$，其中 $h$ 是恒定步长。由此可得 $\\mathrm{d}t = h \\, \\mathrm{d}s$。积分区间 $[t_n, t_{n+1}]$ 在变量 $s$ 中转换为 $[0, 1]$。插值节点 $t_{n-j}$ 对应于 $s = -j$，其中 $j = 0, 1, \\dots, k-1$。\n\n$k-1$ 次拉格朗日插值多项式由 $P(t_n+sh) = \\sum_{j=0}^{k-1} L_j(s) \\mathbf{f}_{n-j}$ 给出，其中 $L_j(s)$ 是拉格朗日基多项式：\n$$\nL_j(s) = \\prod_{i=0, i \\neq j}^{k-1} \\frac{s - (-i)}{(-j) - (-i)}\n$$\n将其代入积分并执行积分，得到通用的 $k$ 步 AB 公式：\n$$\n\\mathbf{y}_{n+1} = \\mathbf{y}_n + h \\sum_{j=0}^{k-1} b_j \\mathbf{f}_{n-j}, \\quad \\text{其中} \\quad b_j = \\int_0^1 L_j(s) \\, \\mathrm{d}s\n$$\n对于 4 步 Adams-Bashforth 方法 (AB4, $k=4$)，插值多项式为 3 次，并使用对应于 $s=0, -1, -2, -3$ 的点。系数 $b_j$ 的计算如下：\n$b_0 = \\int_0^1 \\frac{(s+1)(s+2)(s+3)}{(1)(2)(3)} \\, \\mathrm{d}s = \\frac{55}{24}$\n$b_1 = \\int_0^1 \\frac{s(s+2)(s+3)}{(-1)(1)(2)} \\, \\mathrm{d}s = -\\frac{59}{24}$\n$b_2 = \\int_0^1 \\frac{s(s+1)(s+3)}{(-2)(-1)(1)} \\, \\mathrm{d}s = \\frac{37}{24}$\n$b_3 = \\int_0^1 \\frac{s(s+1)(s+2)}{(-3)(-2)(-1)} \\, \\mathrm{d}s = -\\frac{9}{24}$\n这给出了 AB4 公式，记作 $\\mathbf{y}_{n+1}^{[4]}$，其阶数为 $p=4$：\n$$\n\\mathbf{y}_{n+1}^{[4]} = \\mathbf{y}_n + \\frac{h}{24} \\left( 55\\mathbf{f}_n - 59\\mathbf{f}_{n-1} + 37\\mathbf{f}_{n-2} - 9\\mathbf{f}_{n-3} \\right)\n$$\n对于嵌入的 3 步方法 (AB3, $k=3$)，我们使用一个 2 次多项式对对应于 $s=0, -1, -2$ 的点进行插值。此方法的阶数为 $p=3$。该公式记作 $\\mathbf{y}_{n+1}^{[3]}$，为：\n$$\n\\mathbf{y}_{n+1}^{[3]} = \\mathbf{y}_n + \\frac{h}{12} \\left( 23\\mathbf{f}_n - 16\\mathbf{f}_{n-1} + 5\\mathbf{f}_{n-2} \\right)\n$$\n问题要求推导一个步长控制器。一个 $p$ 阶方法的局部截断误差 (LTE) 与 $h^{p+1}$ 成正比。问题指出，对于高阶方法 (AB4, $p=4$)，有一个校准后的误差估计 $\\text{err}$ 可用。该估计根据以下关系进行缩放：\n$$\n\\text{err} \\approx C h^{p+1} = C h^5\n$$\n其中 $C$ 是一个与解的高阶导数相关的常数。我们的目标是确定一个新的步长 $h_{\\text{new}}$，使得下一步的估计误差 $\\text{err}_{\\text{new}}$ 与用户定义的容差 $\\text{tol}$ 相匹配。\n假设对于新的步长，同样的渐近关系成立，我们可以写出：\n$$\n\\text{tol} \\approx \\text{err}_{\\text{new}} \\approx C h_{\\text{new}}^{p+1} = C h_{\\text{new}}^5\n$$\n通过将容差方程与当前误差方程相除，未知的常数 $C$ 被消去：\n$$\n\\frac{\\text{tol}}{\\text{err}} \\approx \\frac{C h_{\\text{new}}^5}{C h^5} = \\left( \\frac{h_{\\text{new}}}{h} \\right)^5\n$$\n求解 $h_{\\text{new}}$ 得到理想的步长：\n$$\nh_{\\text{new}} = h \\left( \\frac{\\text{tol}}{\\text{err}} \\right)^{1/5} = h \\left( \\frac{\\text{tol}}{\\text{err}} \\right)^{1/(p+1)}\n$$\n在实践中，会对此估计值应用一个安全因子 $s  1$ 来创建一个更保守（更小）的步长，从而降低步长失败的可能性。建议的步长变化因子 $\\alpha_{\\text{prop}}$ 为：\n$$\n\\alpha_{\\text{prop}} = s \\left( \\frac{\\text{tol}}{\\text{err}} \\right)^{1/(p+1)}\n$$\n为防止步长的剧烈变化，此因子被限制在 $[\\alpha_{\\min}, \\alpha_{\\max}]$ 范围内。最终的因子 $\\alpha$ 由以下公式确定：\n$$\n\\alpha = \\max(\\alpha_{\\min}, \\min(\\alpha_{\\max}, \\alpha_{\\text{prop}}))\n$$\n然后，新的步长计算为 $h_{\\text{new}} = \\alpha \\cdot h$。\n\n现在，我们使用提供的数值数据来评估这个控制器：\n- 方法类型：AB4/AB3，其中高阶方法的阶数为 $p=4$。\n- 当前步长：$h = 1.0 \\times 10^{-3}$。\n- 期望容差：$\\text{tol} = 1.0 \\times 10^{-6}$。\n- 校准后的误差估计：$\\text{err} = 3.0 \\times 10^{-7}$。\n- 安全因子：$s = 0.9$。\n- 增长下限：$\\alpha_{\\min} = 0.5$。\n- 增长上限：$\\alpha_{\\max} = 1.5$。\n\n首先，我们计算建议的步长变化因子 $\\alpha_{\\text{prop}}$：\n$$\n\\alpha_{\\text{prop}} = s \\left( \\frac{\\text{tol}}{\\text{err}} \\right)^{1/(p+1)} = 0.9 \\left( \\frac{1.0 \\times 10^{-6}}{3.0 \\times 10^{-7}} \\right)^{1/(4+1)} = 0.9 \\left( \\frac{10}{3} \\right)^{1/5}\n$$\n对该表达式进行数值计算：\n$$\n\\alpha_{\\text{prop}} \\approx 0.9 \\times (3.333\\dots)^{0.2} \\approx 0.9 \\times 1.2723651 \\approx 1.1451286\n$$\n接下来，我们应用剪裁限制：\n$$\n\\alpha = \\max(0.5, \\min(1.5, 1.1451286))\n$$\n由于 $0.5  1.1451286  1.5$，$\\alpha_{\\text{prop}}$ 的值在允许范围内，因此 $\\alpha \\approx 1.1451286$。\n\n最后，我们计算新的步长 $h_{\\text{new}}$：\n$$\nh_{\\text{new}} = \\alpha \\cdot h \\approx 1.1451286 \\times (1.0 \\times 10^{-3}) \\approx 1.1451286 \\times 10^{-3}\n$$\n根据要求将结果四舍五入到四位有效数字，得到：\n$$\nh_{\\text{new}} \\approx 1.145 \\times 10^{-3}\n$$", "answer": "$$\n\\boxed{1.145 \\times 10^{-3}}\n$$", "id": "3340831"}]}