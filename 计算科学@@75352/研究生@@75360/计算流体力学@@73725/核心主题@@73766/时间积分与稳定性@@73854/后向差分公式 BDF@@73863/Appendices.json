{"hands_on_practices": [{"introduction": "在我们信任并应用任何数值方法之前，量化其精度是至关重要的第一步。本练习将引导您运用泰勒级数展开，严谨地推导广泛使用的二阶向后差分格式 (BDF2) 的局部截断误差([@problem_id:3293325])。通过这个过程，您将深刻理解数值格式的“阶”是如何与其所逼近解的光滑性联系起来的，这是评估和选择时间积分方案的一项基本功。", "problem": "考虑计算流体力学（CFD）中由线方法产生的不可压缩纳维-斯托克斯方程的半离散格式，该格式导出一个形如 $y'(t) = f(t,y(t))$ 的常微分方程（ODE）组，其中 $y(t)$ 表示离散解变量的向量，$t$ 是时间，$f$ 集合了空间离散算子和源项。设使用均匀时间步长 $h > 0$，且 $t_n = t_0 + n h$。在时间 $t_n$ 应用二阶两步后向差分格式（BDF2）如下\n$$\\frac{3 y_n - 4 y_{n-1} + y_{n-2}}{2 h} = f(t_n, y_n),$$\n其中 $y_k \\approx y(t_k)$。\n\n将归一化局部截断误差 $\\tau_n$ 定义为将精确解 $y(t)$ 代入 BDF2 公式，并将右侧项 $f(t_n,y_n)$ 替换为精确时间导数 $y'(t_n)$ 时产生的残差：\n$$\\tau_n := \\frac{3 y(t_n) - 4 y(t_{n-1}) + y(t_{n-2})}{2 h} - y'(t_n).$$\n\n从 $y(t)$ 关于 $t_n$ 的泰勒级数展开出发，并仅使用上述局部截断误差的基本定义，推导 $\\tau_n$ 的主阶项的显式表达式，并证明 $\\tau_n = O(h^2)$。您的最终答案必须是一个单一的封闭形式解析表达式，给出以 $h$ 和 $y^{(3)}(t_n)$ 表示的 $\\tau_n$ 的主阶项。", "solution": "该问题要求推导两步后向差分格式（BDF2）的归一化局部截断误差 $\\tau_n$ 的主阶项。分析将通过将精确解 $y(t)$ 的泰勒级数展开代入 $\\tau_n$ 的定义来进行。\n\n首先，我们陈述归一化局部截断误差的给定定义：\n$$ \\tau_n := \\frac{3 y(t_n) - 4 y(t_{n-1}) + y(t_{n-2})}{2 h} - y'(t_n) $$\n此处，$y(t)$ 是常微分方程 $y'(t) = f(t, y(t))$ 的精确解。时间点由 $t_k = t_0 + k h$ 定义，这意味着 $t_{n-1} = t_n - h$ 和 $t_{n-2} = t_n - 2h$。\n\n推导的核心是将 $y(t_{n-1})$ 和 $y(t_{n-2})$ 两项在 $t_n$ 点附近进行泰勒级数展开。我们假设解 $y(t)$ 足够光滑，在 $t_n$ 邻域内至少有三阶连续导数。展开式如下：\n\n对于 $y(t_{n-1}) = y(t_n - h)$:\n$$ y(t_{n-1}) = y(t_n) - h y'(t_n) + \\frac{h^2}{2!} y''(t_n) - \\frac{h^3}{3!} y^{(3)}(t_n) + O(h^4) $$\n$$ y(t_{n-1}) = y(t_n) - h y'(t_n) + \\frac{h^2}{2} y''(t_n) - \\frac{h^3}{6} y^{(3)}(t_n) + O(h^4) $$\n\n对于 $y(t_{n-2}) = y(t_n - 2h)$:\n$$ y(t_{n-2}) = y(t_n) - (2h) y'(t_n) + \\frac{(2h)^2}{2!} y''(t_n) - \\frac{(2h)^3}{3!} y^{(3)}(t_n) + O(h^4) $$\n$$ y(t_{n-2}) = y(t_n) - 2h y'(t_n) + \\frac{4h^2}{2} y''(t_n) - \\frac{8h^3}{6} y^{(3)}(t_n) + O(h^4) $$\n$$ y(t_{n-2}) = y(t_n) - 2h y'(t_n) + 2h^2 y''(t_n) - \\frac{4h^3}{3} y^{(3)}(t_n) + O(h^4) $$\n\n现在，我们将这些展开式代入 $\\tau_n$ 表达式的分子中，即 $3 y(t_n) - 4 y(t_{n-1}) + y(t_{n-2})$。\n\n$$ 3 y(t_n) - 4 y(t_{n-1}) + y(t_{n-2}) = 3 y(t_n) $$\n$$ - 4 \\left( y(t_n) - h y'(t_n) + \\frac{h^2}{2} y''(t_n) - \\frac{h^3}{6} y^{(3)}(t_n) + O(h^4) \\right) $$\n$$ + \\left( y(t_n) - 2h y'(t_n) + 2h^2 y''(t_n) - \\frac{4h^3}{3} y^{(3)}(t_n) + O(h^4) \\right) $$\n\n我们根据 $y(t)$ 在 $t_n$ 处的导数阶数来收集各项：\n$y(t_n)$ 的系数：\n$$ 3 - 4 + 1 = 0 $$\n$y'(t_n)$ 的系数：\n$$ -4(-h) + (-2h) = 4h - 2h = 2h $$\n$y''(t_n)$ 的系数：\n$$ -4\\left(\\frac{h^2}{2}\\right) + 2h^2 = -2h^2 + 2h^2 = 0 $$\n$y^{(3)}(t_n)$ 的系数：\n$$ -4\\left(-\\frac{h^3}{6}\\right) - \\frac{4h^3}{3} = \\frac{4h^3}{6} - \\frac{4h^3}{3} = \\frac{2h^3}{3} - \\frac{4h^3}{3} = -\\frac{2h^3}{3} $$\n\n更高阶的项是 $O(h^4)$ 阶的。综合这些结果，分子变为：\n$$ 3 y(t_n) - 4 y(t_{n-1}) + y(t_{n-2}) = (0)y(t_n) + (2h)y'(t_n) + (0)y''(t_n) - \\frac{2h^3}{3}y^{(3)}(t_n) + O(h^4) $$\n$$ = 2h y'(t_n) - \\frac{2h^3}{3} y^{(3)}(t_n) + O(h^4) $$\n\n现在，我们将此结果代回 $\\tau_n$ 的公式中：\n$$ \\tau_n = \\frac{1}{2h} \\left( 2h y'(t_n) - \\frac{2h^3}{3} y^{(3)}(t_n) + O(h^4) \\right) - y'(t_n) $$\n除以 $2h$，我们得到：\n$$ \\tau_n = \\left( y'(t_n) - \\frac{h^2}{3} y^{(3)}(t_n) + O(h^3) \\right) - y'(t_n) $$\n$y'(t_n)$ 项相互抵消：\n$$ \\tau_n = - \\frac{h^2}{3} y^{(3)}(t_n) + O(h^3) $$\n\n这个关于 $\\tau_n$ 的显式表达式表明了两件事。首先，由于主项与 $h^2$ 成正比，局部截断误差是 2 阶的，即 $\\tau_n = O(h^2)$。这与 BDF2 方法是二阶精度格式的性质是一致的。\n\n其次，归一化局部截断误差 $\\tau_n$ 的主阶项由所得级数的第一项给出。这一项就是问题所要求的答案。\n$\\tau_n$ 的主阶项是：\n$$ - \\frac{h^2}{3} y^{(3)}(t_n) $$", "answer": "$$\\boxed{-\\frac{h^2}{3} y^{(3)}(t_n)}$$", "id": "3293325"}, {"introduction": "然而，仅有精度是不够的，尤其是在计算流体力学中，我们面对的往往是“刚性”问题，此时稳定性变得至关重要。本练习探讨绝对稳定性的概念，这是确保数值解在时间推进中不至发散的关键属性，也是 BDF 方法能够高效求解刚性问题的核心优势([@problem_id:3293367])。您将通过分析经典的测试方程，推导 BDF2 的稳定性边界，并由此理解 A-稳定性等重要概念，洞悉其为何能以较大的时间步长稳定地求解扩散或粘性主导的流动问题。", "problem": "在计算流体动力学中，隐式多步时间积分器被广泛用于推进由守恒律的空间离散化产生的半离散系统。考虑带有复参数 $\\lambda \\in \\mathbb{C}$ 的线性测试常微分方程 (ODE) $y' = \\lambda y$，以及称为2阶向后差分格式 (BDF2) 的二阶向后差分格式 (BDF)。线性多步法的绝对稳定性是通过其放大方程来定义的：对于一个固定的无量纲步长参数 $z = h \\lambda$（其中 $h > 0$ 是无量纲时间步长），稳定性要求特征多项式的所有根 $\\xi \\in \\mathbb{C}$ 都满足 $|\\xi| \\le 1$，且任何位于边界 $|\\xi|=1$ 上的根都必须是单根。绝对稳定区域的边界则由 $|\\xi| = 1$ 得到。\n\n从线性多步法的形式和 BDF2 方法的定义系数出发，推导测试问题 $y' = \\lambda y$ 的放大方程，并使用根轨迹法得到复 $z$-平面上稳定性边界曲线的显式参数表达式 $z(\\theta)$，其中 $\\theta \\in [0, 2\\pi)$ 是单位圆 $|\\xi| = 1$ 的参数化。\n\n然后，限制 $\\lambda$ 为负实数（即 $\\lambda \\in \\mathbb{R}$ 且 $\\lambda  0$），并确定当 BDF2 方法应用于 $y' = \\lambda y$ 时，该方法保持绝对稳定性的最大稳定无量纲时间步长 $h$。将你的最终答案表示为：\n- $z(\\theta)$ 的显式公式，以及\n- 对于负实数 $\\lambda$，稳定 $h$ 的上确界。\n\n以无单位的符号形式报告两者。如果需要任何数值四舍五入，将会以有效数字的形式指定；然而，本题不需要四舍五入。", "solution": "用于求解 ODE $y' = f(t,y)$ 的通用 $k$-步线性多步法 (LMM) 可以写成：\n$$ \\sum_{j=0}^{k} \\alpha_j y_{n+j} = h \\sum_{j=0}^{k} \\beta_j f(t_{n+j}, y_{n+j}) $$\n二阶向后差分格式 (BDF2) 对应一个 $2$-步方法 ($k=2$)。它是通过对点 $(t_n, y_n)$、$(t_{n+1}, y_{n+1})$ 和 $(t_{n+2}, y_{n+2})$ 拟合一个二次多项式，并将其在 $t_{n+2}$ 处的导数设为等于 $f(t_{n+2}, y_{n+2})$ 来推导的。这得到以下公式：\n$$ \\frac{3}{2} y_{n+2} - 2 y_{n+1} + \\frac{1}{2} y_n = h f_{n+2} $$\n通过将首项系数 $\\alpha_2$ 归一化为 $1$，我们得到：\n$$ y_{n+2} - \\frac{4}{3} y_{n+1} + \\frac{1}{3} y_n = \\frac{2}{3} h f_{n+2} $$\n从这个形式中，我们确定系数：\n-   $\\alpha_2 = 1$, $\\alpha_1 = -\\frac{4}{3}$, $\\alpha_0 = \\frac{1}{3}$\n-   $\\beta_2 = \\frac{2}{3}$, $\\beta_1 = 0$, $\\beta_0 = 0$\n\nLMM 的稳定性通过将其应用于测试方程 $y'=\\lambda y$ 来分析，对于该方程有 $f(t_{n+j}, y_{n+j}) = \\lambda y_{n+j}$。将此代入通用的 LMM 形式中：\n$$ \\sum_{j=0}^{k} \\alpha_j y_{n+j} = h \\sum_{j=0}^{k} \\beta_j (\\lambda y_{n+j}) $$\n引入无量纲参数 $z = h \\lambda$，我们有：\n$$ \\sum_{j=0}^{k} (\\alpha_j - z \\beta_j) y_{n+j} = 0 $$\n我们寻找形式为 $y_n = \\xi^n$ 的解。代入这个拟设可以得到特征多项式（或放大方程）：\n$$ \\sum_{j=0}^{k} (\\alpha_j - z \\beta_j) \\xi^j = 0 $$\n这可以表示为该方法的第一和第二特征多项式 $\\rho(\\xi) = \\sum \\alpha_j \\xi^j$ 和 $\\sigma(\\xi) = \\sum \\beta_j \\xi^j$ 的形式：\n$$ \\rho(\\xi) - z \\sigma(\\xi) = 0 $$\n对于 BDF2，这些多项式是：\n$$ \\rho(\\xi) = \\xi^2 - \\frac{4}{3} \\xi + \\frac{1}{3} $$\n$$ \\sigma(\\xi) = \\frac{2}{3} \\xi^2 $$\n因此，BDF2 的放大方程为：\n$$ \\left(\\xi^2 - \\frac{4}{3} \\xi + \\frac{1}{3}\\right) - z \\left(\\frac{2}{3} \\xi^2\\right) = 0 $$\n绝对稳定区域是使该方程所有根 $\\xi$ 都满足 $|\\xi| \\le 1$ （且边界上的根为单根）的 $z \\in \\mathbb{C}$ 的集合。该区域的边界是存在至少一个根满足 $|\\xi| = 1$ 的 $z$ 的集合。\n\n**第一部分：稳定性边界 $z(\\theta)$ 的推导**\n\n为了找到稳定性边界，我们对放大方程求解 $z$ 并设 $|\\xi|=1$。\n$$ z = \\frac{\\rho(\\xi)}{\\sigma(\\xi)} = \\frac{\\xi^2 - \\frac{4}{3} \\xi + \\frac{1}{3}}{\\frac{2}{3} \\xi^2} $$\n我们可以简化这个表达式：\n$$ z = \\frac{3}{2} \\left( \\frac{\\xi^2 - \\frac{4}{3} \\xi + \\frac{1}{3}}{\\xi^2} \\right) = \\frac{3}{2} \\left( 1 - \\frac{4}{3\\xi} + \\frac{1}{3\\xi^2} \\right) $$\n稳定性边界通过让 $\\xi$ 在复平面上描绘单位圆来进行参数化，即 $\\xi = \\exp(i\\theta)$，其中 $\\theta \\in [0, 2\\pi)$。将此代入 $z$ 的表达式中：\n$$ z(\\theta) = \\frac{3}{2} \\left( 1 - \\frac{4}{3}\\exp(-i\\theta) + \\frac{1}{3}\\exp(-i2\\theta) \\right) $$\n$$ z(\\theta) = \\frac{3}{2} - 2\\exp(-i\\theta) + \\frac{1}{2}\\exp(-i2\\theta) $$\n这就是稳定性边界的显式参数表达式。\n\n**第二部分：对于负实数 $\\lambda$ 的最大稳定步长**\n\n我们现在限制 $\\lambda \\in \\mathbb{R}$ 且 $\\lambda  0$。由于步长 $h$ 是正的，参数 $z = h\\lambda$ 是一个负实数。我们需要确定对于哪些负实数值 $z$，BDF2 方法是绝对稳定的。这等同于找到位于稳定区域内的负实轴部分。\n\n如果一个方法的绝对稳定区域包含整个开放左半平面 $\\{z \\in \\mathbb{C} \\mid \\text{Re}(z)  0\\}$，则该方法是 A-稳定的。为了对 BDF2 进行检验，我们考察稳定性边界 $z(\\theta)$ 的实部：\n$$ \\text{Re}(z(\\theta)) = \\text{Re}\\left( \\frac{3}{2} - 2\\exp(-i\\theta) + \\frac{1}{2}\\exp(-i2\\theta) \\right) $$\n$$ \\text{Re}(z(\\theta)) = \\frac{3}{2} - 2\\cos(-\\theta) + \\frac{1}{2}\\cos(-2\\theta) = \\frac{3}{2} - 2\\cos(\\theta) + \\frac{1}{2}\\cos(2\\theta) $$\n使用恒等式 $\\cos(2\\theta) = 2\\cos^2(\\theta) - 1$：\n$$ \\text{Re}(z(\\theta)) = \\frac{3}{2} - 2\\cos(\\theta) + \\frac{1}{2}(2\\cos^2(\\theta) - 1) = \\frac{3}{2} - 2\\cos(\\theta) + \\cos^2(\\theta) - \\frac{1}{2} $$\n$$ \\text{Re}(z(\\theta)) = 1 - 2\\cos(\\theta) + \\cos^2(\\theta) = (1 - \\cos(\\theta))^2 $$\n由于 $\\cos(\\theta)$ 是介于 $-1$ 和 $1$ 之间的实数，所以 $(1 - \\cos(\\theta))^2 \\ge 0$。稳定性边界的实部对于所有 $\\theta$ 都是非负的。除了在 $\\theta = 0$（及其 $2k\\pi$ 的倍数）处，$\\cos(0)=1$ 且 $\\text{Re}(z(0)) = 0$，对应于点 $z(0) = 0$ 之外，它都是严格为正的。\n\n这意味着稳定区域的边界完全位于闭合右半平面 $\\text{Re}(z) \\ge 0$ 内。为了确定稳定区域是该边界曲线的内部还是外部，我们测试一个点。对于 $z \\to \\infty$，放大方程 $(1 - \\frac{2}{3}z)\\xi^2 - \\frac{4}{3}\\xi + \\frac{1}{3} = 0$ 近似为 $-\\frac{2}{3}z\\xi^2 \\approx 0$，这给出的根是 $\\xi=0$。由于 $|0|1$，无穷远点是稳定的。因此，绝对稳定区域是边界曲线 $z(\\theta)$ 的外部。\n\n由于边界包含在右半平面内，其外部必然包含整个开放左半平面。因此，BDF2 是 A-稳定的。这意味着对于任何满足 $\\text{Re}(z)  0$ 的 $z$，该方法都是绝对稳定的。\n\n对于 $\\lambda  0$ 的特定情况，只要 $h>0$，参数 $z = h\\lambda$ 总是一个负实数。任何这样的 $z$ 都位于开放左半平面内。因此，BDF2 方法对于任何 $h > 0$ 都是绝对稳定的。\n\n问题要求的是最大稳定无量纲时间步长 $h$。所有稳定步长 $h$ 的集合是 $(0, \\infty)$。这个集合的上确界（最小上界）是无穷大。", "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{3}{2} - 2\\exp(-i\\theta) + \\frac{1}{2}\\exp(-i2\\theta) \\\\ \\infty \\end{pmatrix}}\n$$", "id": "3293367"}, {"introduction": "将理论应用于实践时，算法的标称高阶精度往往是脆弱的，其损失常常源于微妙的实现细节，而非核心公式的缺陷。本练习聚焦于一个常见陷阱：在求解偏微分方程时，对随时间变化的边界条件处理不一致所导致的问题([@problem_id:3293359])。您将分析这种不一致性为何会将一个高阶格式的全局精度降低到一阶，并学习如何构造一个与格式阶数匹配的多项式外推方案来修正边界项，从而恢复算法的全部威力。", "problem": "考虑一维热方程，这是计算流体动力学（CFD）中的一个典型模型，其表达式为 $\\partial u/\\partial t = \\nu\\,\\partial^{2} u/\\partial x^{2}$，定义在空间区间 $[0,1]$ 上，并带有关随时间变化的狄利克雷边界条件 $u(0,t)=g(t)$ 和 $u(1,t)=0$。设空间离散化采用二阶中心有限差分法，有 $N$ 个内部节点，从而得到一个线法半离散系统 $y'(t)=A\\,y(t)+s(t)$，其中 $A\\in\\mathbb{R}^{N\\times N}$ 是离散拉普拉斯算子乘以 $\\nu$，$s(t)$ 是 $g(t)$ 的一个线性函数，用于捕捉 $x=0$ 处的边界强迫项。假设 $g(t)$ 足够光滑，具体而言，在所关心的时间区间上 $g\\in C^{k+1}$。\n\n对于时间积分，考虑一个 $k$ 步反向微分公式（BDF），其时间步长为常数 $\\Delta t>0$，时间层级为 $t_{n}=t_{0}+n\\,\\Delta t$。将 BDF 格式应用于该半离散系统，在 $t_{n+1}$ 处产生一个隐式更新，形式如下：\n$$\n\\sum_{j=0}^{k}\\alpha_{j}\\,y^{n+1-j}=\\Delta t\\,\\left(A\\,y^{n+1}+s^{n+1}\\right),\n$$\n其中 $y^{m}\\approx y(t_{m})$，$s^{m}\\approx s(t_{m})$，系数 $\\alpha_{j}$ 对应于 $k$ 步 BDF。\n\n在许多实现中，右侧随时间变化的边界数据通过使用 $g^{n}\\equiv g(t_{n})$ 而不是 $g^{n+1}\\equiv g(t_{n+1})$ 来设置 $s^{n+1}$，从而进行了不一致的处理。从半离散形式 $y'(t)=A\\,y(t)+s(t)$ 和 BDF 格式的定义出发，分析当 $A$ 是刚性（如扩散问题中）时，这种不一致的处理如何导致全局时间精度的阶数降低。使用 $g(t)$ 在 $t_{n}$ 附近的泰勒展开来确定由 $s^{n}$ 替换 $s^{n+1}$ 引起的主阶缺陷，并论证最终的有效精度阶数。\n\n然后，通过构造一个基于过去在 $t_{n},t_{n-1},\\dots,t_{n-k}$ 处的边界值的 $k$ 次时间多项式外插 $g(t)$，推导一个与 BDF 格式的 $k$ 阶精度相一致的边界数据修正格式。假设时间步长均匀，并通过在归一化时间坐标下使用拉格朗日插值，从第一性原理推导外插权重。最后，对于 $k=3$ 的特定情况，提供修正后边界值 $g^{n+1}$ 的显式外插公式，该公式仅用 $g^{n},g^{n-1},g^{n-2},g^{n-3}$ 表示。\n\n你的最终答案必须是给出 $g^{n+1}$ 以 $g^{n},g^{n-1},g^{n-2},g^{n-3}$ 表示的单一闭式解析表达式。不需要数值舍入，也不包含任何物理单位。", "solution": "该问题被验证为具有科学依据、良态且客观的。它提出了偏微分方程数值分析中的一个标准场景，具体涉及由于边界条件实现不一致导致的时间步进格式的阶数降低问题。任务定义清晰，并可使用已有的数学技术解决。\n\n根据要求，分析过程分为三部分：分析阶数降低，推导修正格式，以及为 $k=3$ 的情况提供显式修正。\n\n### 阶数降低分析\n\n半离散系统由以下常微分方程（ODE）给出：\n$$\ny'(t) = A\\,y(t) + s(t)\n$$\n其中 $y(t) \\in \\mathbb{R}^{N}$ 是节点值的向量，$A$ 是刚性离散算子，$s(t)$ 是由随时间变化的边界条件 $g(t)$ 产生的源项。\n\n一个 $k$ 步反向微分公式（BDF）以 $k$ 阶精度逼近在时间 $t_{n+1}$ 处的导数 $y'(t)$。将 BDF 应用于导数项的局部截断误差（LTE）是 $O(\\Delta t^k)$。该 ODE 的形式上正确的 BDF 格式是：\n$$\n\\sum_{j=0}^{k}\\alpha_{j}\\,y^{n+1-j} = \\Delta t\\,\\beta_{0}(A\\,y^{n+1}+s^{n+1})\n$$\n问题陈述简化了右侧项，实际上将 BDF 系数 $\\beta_0$ 吸收到 $\\alpha_j$ 系数中（即，设置 $\\beta_0 = 1$），这是一种常见的约定。因此，该格式写为：\n$$\n\\sum_{j=0}^{k}\\alpha_{j}\\,y^{n+1-j} = \\Delta t\\,(A\\,y^{n+1}+s^{n+1})\n$$\n左侧是 $\\Delta t \\, y'(t_{n+1})$ 的 BDF 近似。将精确解 $y(t_{n+1-j})$ 代入此表达式，得到：\n$$\n\\sum_{j=0}^{k}\\alpha_{j}\\,y(t_{n+1-j}) = \\Delta t \\, y'(t_{n+1}) + O(\\Delta t^{k+1})\n$$\n使用控制方程 $y'(t_{n+1}) = A\\,y(t_{n+1}) + s(t_{n+1})$，我们得到：\n$$\n\\sum_{j=0}^{k}\\alpha_{j}\\,y(t_{n+1-j}) = \\Delta t \\, (A\\,y(t_{n+1}) + s(t_{n+1})) + O(\\Delta t^{k+1})\n$$\n问题指出使用了一种不一致的实现，其中源项 $s^{n+1} = s(t_{n+1})$ 被替换为 $s^n = s(t_n)$。因此，实现的格式为：\n$$\n\\sum_{j=0}^{k}\\alpha_{j}\\,\\tilde{y}^{n+1-j} = \\Delta t\\,(A\\,\\tilde{y}^{n+1}+s^{n})\n$$\n其中 $\\tilde{y}$ 表示不一致格式的解。局部截断误差 $\\tau_{n+1}$ 是通过将精确解 $y(t)$ 代入所实现的数值格式得到的：\n$$\n\\tau_{n+1} = \\frac{1}{\\Delta t}\\sum_{j=0}^{k}\\alpha_{j}\\,y(t_{n+1-j}) - (A\\,y(t_{n+1})+s(t_{n}))\n$$\n代入 BDF 近似的表达式，我们有：\n$$\n\\tau_{n+1} = \\left( A\\,y(t_{n+1}) + s(t_{n+1}) + O(\\Delta t^k) \\right) - (A\\,y(t_{n+1})+s(t_n))\n$$\n$$\n\\tau_{n+1} = s(t_{n+1}) - s(t_n) + O(\\Delta t^k)\n$$\n假设 $s(t)$ 足够光滑（这是 $g(t) \\in C^{k+1}$ 的一个推论），我们对 $s(t_{n+1})$ 在 $t_n$ 附近进行泰勒展开：\n$$\ns(t_{n+1}) = s(t_n) + \\Delta t \\, s'(t_n) + \\frac{(\\Delta t)^2}{2}s''(t_n) + \\dots\n$$\n因此，主阶缺陷为：\n$$\ns(t_{n+1}) - s(t_n) = \\Delta t \\, s'(t_n) + O(\\Delta t^2)\n$$\n局部截断误差变为：\n$$\n\\tau_{n+1} = \\Delta t \\, s'(t_n) + O(\\Delta t^2) + O(\\Delta t^k)\n$$\n对于任何 $k \\geq 2$ 阶的 BDF 方法，主导误差项是 $\\Delta t \\, s'(t_n)$，即 $O(\\Delta t)$。对于一个稳定的方法，$O(\\Delta t^{p+1})$ 的局部截断误差通常导致 $O(\\Delta t^p)$ 的全局误差。这里，LTE 是 $O(\\Delta t)$，这意味着全局误差是 $O(1)$ 并且方法不收敛。然而，项 $\\Delta t \\, s'(t_n)$ 是一个强迫误差。它对全局误差的贡献是 $O(\\Delta t)$ 阶。因此，无论 BDF 格式的形式阶数 $k$ 是多少，该方法的全局精度都降低到一阶，即 $O(\\Delta t)$。\n\n### 修正格式\n\n为了恢复 BDF 格式的 $k$ 阶精度，源项 $s(t_{n+1})$ 必须以至少 $O(\\Delta t^k)$ 的误差进行近似。由于 $s(t)$ 是 $g(t)$ 的线性函数，这要求近似 $g(t_{n+1})$ 时，其误差不会降低整个格式的精度。一个满足 $g(t_{n+1}) - g^{n+1}_{\\text{approx}} = O(\\Delta t^{k+1})$ 的近似 $g^{n+1}_{\\text{approx}}$ 是足够的，因为这将向 LTE 中引入一个 $O(\\Delta t^{k+1})$ 的项，该项相对于 BDF 内在的 $O(\\Delta t^k)$ 误差是次要的。\n\n我们构造一个 $k$ 次多项式 $P(t)$，它插值于最后 $k+1$ 个已知的边界值：$(t_{n-j}, g^{n-j})$，其中 $j = 0, 1, \\dots, k$。然后通过将该多项式外插到时间 $t_{n+1}$ 来获得修正后的边界值：\n$$\ng^{n+1}_{\\text{corr}} = P(t_{n+1})\n$$\n多项式插值/外插的误差由以下公式给出：\n$$\ng(t) - P(t) = \\frac{g^{(k+1)}(\\xi)}{(k+1)!} \\prod_{j=0}^{k} (t - t_{n-j})\n$$\n其中 $\\xi$ 位于这些点所跨越的时间区间内的某点。在 $t = t_{n+1}$ 处求值：\n$$\ng(t_{n+1}) - P(t_{n+1}) = \\frac{g^{(k+1)}(\\xi)}{(k+1)!} \\prod_{j=0}^{k} (t_{n+1} - t_{n-j})\n$$\n对于固定的时间步长 $\\Delta t$，$t_{m} = t_n + (m-n)\\Delta t$。该乘积变为：\n$$\n\\prod_{j=0}^{k} ((n+1)\\Delta t - (n-j)\\Delta t) = \\prod_{j=0}^{k} (1+j)\\Delta t = (k+1)! (\\Delta t)^{k+1}\n$$\n因此，外插误差为：\n$$\ng(t_{n+1}) - g^{n+1}_{\\text{corr}} = \\frac{g^{(k+1)}(\\xi)}{(k+1)!} (k+1)! (\\Delta t)^{k+1} = g^{(k+1)}(\\xi) (\\Delta t)^{k+1} = O(\\Delta t^{k+1})\n$$\n这个修正足够精确，可以恢复 BDF 格式的形式阶数 $k$。\n\n### k=3 的显式公式\n\n对于 $k=3$，我们需要找到一个通过点 $(t_n, g^n)$、$(t_{n-1}, g^{n-1})$、$(t_{n-2}, g^{n-2})$ 和 $(t_{n-3}, g^{n-3})$ 的 3 次多项式，并在 $t_{n+1}$ 处求值。我们使用拉格朗日插值。定义一个归一化的时间坐标 $\\tau = (t - t_n)/\\Delta t$ 会很方便。插值节点为 $\\tau_j = -j$，其中 $j=0, 1, 2, 3$。我们需要外插到 $\\tau=1$。\n\n拉格朗日基多项式 $L_j(\\tau)$ 由 $L_j(\\tau) = \\prod_{i=0, i\\neq j}^{3} \\frac{\\tau - \\tau_i}{\\tau_j - \\tau_i}$ 给出。外插值为 $g^{n+1} = \\sum_{j=0}^{3} c_j g^{n-j}$，其中系数为 $c_j = L_j(1)$。\n\n我们来计算系数 $c_j$：\n对于 $j=0$（节点 $\\tau_0=0$）：\n$$\nc_0 = L_0(1) = \\frac{1-(-1)}{0-(-1)} \\cdot \\frac{1-(-2)}{0-(-2)} \\cdot \\frac{1-(-3)}{0-(-3)} = \\frac{2}{1} \\cdot \\frac{3}{2} \\cdot \\frac{4}{3} = 4\n$$\n对于 $j=1$（节点 $\\tau_1=-1$）：\n$$\nc_1 = L_1(1) = \\frac{1-0}{-1-0} \\cdot \\frac{1-(-2)}{-1-(-2)} \\cdot \\frac{1-(-3)}{-1-(-3)} = \\frac{1}{-1} \\cdot \\frac{3}{1} \\cdot \\frac{4}{2} = -6\n$$\n对于 $j=2$（节点 $\\tau_2=-2$）：\n$$\nc_2 = L_2(1) = \\frac{1-0}{-2-0} \\cdot \\frac{1-(-1)}{-2-(-1)} \\cdot \\frac{1-(-3)}{-2-(-3)} = \\frac{1}{-2} \\cdot \\frac{2}{-1} \\cdot \\frac{4}{1} = 4\n$$\n对于 $j=3$（节点 $\\tau_3=-3$）：\n$$\nc_3 = L_3(1) = \\frac{1-0}{-3-0} \\cdot \\frac{1-(-1)}{-3-(-1)} \\cdot \\frac{1-(-2)}{-3-(-2)} = \\frac{1}{-3} \\cdot \\frac{2}{-2} \\cdot \\frac{3}{-1} = -1\n$$\n结合这些系数，修正后边界值 $g^{n+1}$ 的显式外插公式为：\n$$\ng^{n+1} = c_0 g^n + c_1 g^{n-1} + c_2 g^{n-2} + c_3 g^{n-3} = 4g^n - 6g^{n-1} + 4g^{n-2} - g^{n-3}\n$$\n该表达式为在三阶 BDF 格式中使用 $g(t_{n+1})$ 提供了必要的 $O(\\Delta t^4)$ 精度估计，从而恢复了该方法的预期精度。", "answer": "$$\n\\boxed{4g^{n} - 6g^{n-1} + 4g^{n-2} - g^{n-3}}\n$$", "id": "3293359"}]}