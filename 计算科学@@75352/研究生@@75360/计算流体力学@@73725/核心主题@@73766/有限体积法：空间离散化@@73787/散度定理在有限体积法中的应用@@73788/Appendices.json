{"hands_on_practices": [{"introduction": "有限体积方法的核心思想是利用散度定理，将控制体内对散度的体积积分转化为跨越其边界的通量面积分。本练习将通过一个具体的三维四面体控制体，引导你亲手实践这一转化过程。你将计算一个给定向量场的数值散度，并将其与精确的单元平均散度进行比较，从而直观地理解数值近似（特别是面积分求积误差）在FVM中的作用。[@problem_id:3291622]", "problem": "考虑计算流体力学 (CFD) 中有限体积法 (FVM) 的一个控制体：四面体 $K$，其顶点为 $\\mathbf{v}_0=(0,0,0)$、$\\mathbf{v}_1=(1,0,0)$、$\\mathbf{v}_2=(0,2,0)$ 和 $\\mathbf{v}_3=(0,0,3)$。设矢量场为 $\\mathbf{F}(\\mathbf{x})=[x^2,xy,y^2]^{\\top}$。通过在 $K$ 上应用散度定理，并对每个三角形面使用单点形心法则（1次精度）来近似每个面通量，从而定义单元 $P$ 处的离散散度：对于每个形心为 $\\mathbf{x}_f^{c}$、外法向面积矢量为 $\\mathbf{a}_f=\\int_{f}\\mathbf{n}\\,\\mathrm{d}S$ 的面 $f$，将 $\\int_{f}\\mathbf{F}\\cdot\\mathbf{n}\\,\\mathrm{d}S$ 近似为 $\\mathbf{F}(\\mathbf{x}_f^{c})\\cdot \\mathbf{a}_f$，并设\n$$\n(\\nabla_h\\cdot \\mathbf{F})_P \\equiv \\frac{1}{|K|}\\sum_{f\\subset \\partial K} \\mathbf{F}(\\mathbf{x}_f^{c})\\cdot \\mathbf{a}_f.\n$$\n对上述四面体 $K$ 精确计算 $(\\nabla_h\\cdot \\mathbf{F})_P$。然后，独立计算精确的单元平均散度 $\\langle \\nabla\\cdot \\mathbf{F} \\rangle_K$ 并进行比较，解释任何差异。将 $(\\nabla_h\\cdot \\mathbf{F})_P$ 的最终数值结果精确表示为一个有理数（无需四舍五入）。不需要单位。", "solution": "我们从散度定理开始，该定理指出，对于足够光滑的矢量场 $\\mathbf{F}$ 和一个边界为 $\\partial K$、单位外法向量为 $\\mathbf{n}$ 的控制体 $K$，\n$$\n\\int_{K} \\nabla\\cdot \\mathbf{F}\\,\\mathrm{d}V \\;=\\; \\int_{\\partial K} \\mathbf{F}\\cdot \\mathbf{n}\\,\\mathrm{d}S.\n$$\n在有限体积法 (FVM) 中，与控制体 $K$ 相关联的单元 $P$ 处的离散散度是通过近似边界通量得到的。在每个三角形面 $f$ 上使用单点形心求积，我们近似\n$$\n\\int_{f} \\mathbf{F}\\cdot \\mathbf{n}\\,\\mathrm{d}S \\;\\approx\\; \\mathbf{F}(\\mathbf{x}_f^{c})\\cdot \\mathbf{a}_f,\n$$\n其中 $\\mathbf{a}_f=\\int_{f}\\mathbf{n}\\,\\mathrm{d}S=\\mathbf{n}_f A_f$ 是面 $f$ 的外法向面积矢量（对于平面是常数），$\\mathbf{x}_f^{c}$ 是面心。因此，\n$$\n(\\nabla_h\\cdot \\mathbf{F})_P \\;=\\; \\frac{1}{|K|}\\sum_{f\\subset \\partial K} \\mathbf{F}(\\mathbf{x}_f^{c})\\cdot \\mathbf{a}_f.\n$$\n\n步骤1：四面体 $K$ 的几何形状。\n设顶点为 $\\mathbf{v}_0=(0,0,0)$、$\\mathbf{v}_1=(1,0,0)$、$\\mathbf{v}_2=(0,2,0)$ 和 $\\mathbf{v}_3=(0,0,3)$。体积为\n$$\n|K| \\;=\\; \\frac{1}{6}\\,\\det\\big[\\mathbf{v}_1-\\mathbf{v}_0,\\;\\mathbf{v}_2-\\mathbf{v}_0,\\;\\mathbf{v}_3-\\mathbf{v}_0\\big]\n\\;=\\; \\frac{1}{6}\\,\\det\\begin{bmatrix}1 & 0 & 0\\\\ 0 & 2 & 0\\\\ 0 & 0 & 3\\end{bmatrix}\n\\;=\\; \\frac{1}{6}\\cdot 6 \\;=\\; 1.\n$$\n\n步骤2：列举面、形心和外法向面积矢量。\n我们取与每个顶点相对的四个三角形面：\n- 面 $f_0$ 与 $\\mathbf{v}_0$ 相对：三角形 $(\\mathbf{v}_1,\\mathbf{v}_2,\\mathbf{v}_3)$。\n- 面 $f_1$ 与 $\\mathbf{v}_1$ 相对：三角形 $(\\mathbf{v}_0,\\mathbf{v}_2,\\mathbf{v}_3)$。\n- 面 $f_2$ 与 $\\mathbf{v}_2$ 相对：三角形 $(\\mathbf{v}_0,\\mathbf{v}_3,\\mathbf{v}_1)$。\n- 面 $f_3$ 与 $\\mathbf{v}_3$ 相对：三角形 $(\\mathbf{v}_0,\\mathbf{v}_1,\\mathbf{v}_2)$。\n\n对于顶点为 $(\\mathbf{a},\\mathbf{b},\\mathbf{c})$ 的面，面积矢量为\n$$\n\\mathbf{a}_{\\text{raw}} \\;=\\; \\frac{1}{2}\\,(\\mathbf{b}-\\mathbf{a})\\times(\\mathbf{c}-\\mathbf{a}),\n$$\n其方向通过确保 $\\mathbf{a}_f\\cdot(\\mathbf{v}_{\\text{opp}}-\\mathbf{x}_f^{c}) > 0$ 来修正为朝外，其中 $\\mathbf{v}_{\\text{opp}}$ 是相对的顶点，$\\mathbf{x}_f^{c}=(\\mathbf{a}+\\mathbf{b}+\\mathbf{c})/3$ 是面心。\n\n计算面心：\n- $f_0$: $\\mathbf{x}_{f_0}^{c}=\\big(\\frac{1}{3},\\frac{2}{3},1\\big)$.\n- $f_1$: $\\mathbf{x}_{f_1}^{c}=\\big(0,\\frac{2}{3},1\\big)$.\n- $f_2$: $\\mathbf{x}_{f_2}^{c}=\\big(\\frac{1}{3},0,1\\big)$.\n- $f_3$: $\\mathbf{x}_{f_3}^{c}=\\big(\\frac{1}{3},\\frac{2}{3},0\\big)$.\n\n计算面积矢量：\n\n对于面 $f_0$，其顶点为 $(\\mathbf{v}_1,\\mathbf{v}_2,\\mathbf{v}_3)$:\n$$\n(\\mathbf{v}_2-\\mathbf{v}_1) = (-1,2,0),\\quad (\\mathbf{v}_3-\\mathbf{v}_1)=(-1,0,3),\n$$\n$$\n(\\mathbf{v}_2-\\mathbf{v}_1)\\times(\\mathbf{v}_3-\\mathbf{v}_1) = (6,3,2),\\quad \\mathbf{a}_{f_0,\\text{raw}}=\\frac{1}{2}(6,3,2)=(3,\\tfrac{3}{2},1).\n$$\n相对顶点为 $\\mathbf{v}_{\\text{opp}}=\\mathbf{v}_0$，面心为 $\\mathbf{x}_{f_0}^{c}=(\\tfrac{1}{3},\\tfrac{2}{3},1)$，\n$$\n\\mathbf{a}_{f_0,\\text{raw}}\\cdot(\\mathbf{v}_0-\\mathbf{x}_{f_0}^{c})=(3,\\tfrac{3}{2},1)\\cdot(-\\tfrac{1}{3},-\\tfrac{2}{3},-1)=-3  0,\n$$\n所以 $\\mathbf{a}_{f_0}=(3,\\tfrac{3}{2},1)$ 已经是朝外的。\n\n对于面 $f_1$，其顶点为 $(\\mathbf{v}_0,\\mathbf{v}_2,\\mathbf{v}_3)$:\n$$\n(\\mathbf{v}_2-\\mathbf{v}_0)=(0,2,0),\\quad (\\mathbf{v}_3-\\mathbf{v}_0)=(0,0,3),\n$$\n$$\n(\\mathbf{v}_2-\\mathbf{v}_0)\\times(\\mathbf{v}_3-\\mathbf{v}_0)=(6,0,0),\\quad \\mathbf{a}_{f_1,\\text{raw}}=(3,0,0).\n$$\n相对顶点为 $\\mathbf{v}_{\\text{opp}}=\\mathbf{v}_1$，面心为 $\\mathbf{x}_{f_1}^{c}=(0,\\tfrac{2}{3},1)$，\n$$\n\\mathbf{a}_{f_1,\\text{raw}}\\cdot(\\mathbf{v}_1-\\mathbf{x}_{f_1}^{c})=(3,0,0)\\cdot(1,-\\tfrac{2}{3},-1)=3 > 0,\n$$\n所以 $\\mathbf{a}_{f_1}=-(3,0,0)=(-3,0,0)$ 是朝外的。\n\n对于面 $f_2$，其顶点为 $(\\mathbf{v}_0,\\mathbf{v}_3,\\mathbf{v}_1)$:\n$$\n(\\mathbf{v}_3-\\mathbf{v}_0)=(0,0,3),\\quad (\\mathbf{v}_1-\\mathbf{v}_0)=(1,0,0),\n$$\n$$\n(\\mathbf{v}_3-\\mathbf{v}_0)\\times(\\mathbf{v}_1-\\mathbf{v}_0)=(0,3,0),\\quad \\mathbf{a}_{f_2,\\text{raw}}=(0,\\tfrac{3}{2},0).\n$$\n相对顶点为 $\\mathbf{v}_{\\text{opp}}=\\mathbf{v}_2$，面心为 $\\mathbf{x}_{f_2}^{c}=(\\tfrac{1}{3},0,1)$，\n$$\n\\mathbf{a}_{f_2,\\text{raw}}\\cdot(\\mathbf{v}_2-\\mathbf{x}_{f_2}^{c})=(0,\\tfrac{3}{2},0)\\cdot(-\\tfrac{1}{3},2,-1)=3 > 0,\n$$\n所以 $\\mathbf{a}_{f_2}=(0,-\\tfrac{3}{2},0)$ 是朝外的。\n\n对于面 $f_3$，其顶点为 $(\\mathbf{v}_0,\\mathbf{v}_1,\\mathbf{v}_2)$:\n$$\n(\\mathbf{v}_1-\\mathbf{v}_0)=(1,0,0),\\quad (\\mathbf{v}_2-\\mathbf{v}_0)=(0,2,0),\n$$\n$$\n(\\mathbf{v}_1-\\mathbf{v}_0)\\times(\\mathbf{v}_2-\\mathbf{v}_0)=(0,0,2),\\quad \\mathbf{a}_{f_3,\\text{raw}}=(0,0,1).\n$$\n相对顶点为 $\\mathbf{v}_{\\text{opp}}=\\mathbf{v}_3$，面心为 $\\mathbf{x}_{f_3}^{c}=(\\tfrac{1}{3},\\tfrac{2}{3},0)$，\n$$\n\\mathbf{a}_{f_3,\\text{raw}}\\cdot(\\mathbf{v}_3-\\mathbf{x}_{f_3}^{c})=(0,0,1)\\cdot(-\\tfrac{1}{3},-\\tfrac{2}{3},3)=3 > 0,\n$$\n所以 $\\mathbf{a}_{f_3}=(0,0,-1)$ 是朝外的。\n\n步骤3：计算面心处的 $\\mathbf{F}$ 值并近似通量。\n矢量场为 $\\mathbf{F}=[x^2,xy,y^2]^{\\top}$。在形心处计算其值：\n\n- 在面 $f_0$ 上, $\\mathbf{x}_{f_0}^{c}=(\\tfrac{1}{3},\\tfrac{2}{3},1)$:\n$$\n\\mathbf{F}(\\mathbf{x}_{f_0}^{c})=\\Big[\\big(\\tfrac{1}{3}\\big)^2,\\;\\tfrac{1}{3}\\cdot \\tfrac{2}{3},\\;\\big(\\tfrac{2}{3}\\big)^2\\Big]=\\Big[\\tfrac{1}{9},\\tfrac{2}{9},\\tfrac{4}{9}\\Big].\n$$\n通量近似：\n$$\n\\mathbf{F}(\\mathbf{x}_{f_0}^{c})\\cdot \\mathbf{a}_{f_0}=\\Big(\\tfrac{1}{9},\\tfrac{2}{9},\\tfrac{4}{9}\\Big)\\cdot \\Big(3,\\tfrac{3}{2},1\\Big)=\\tfrac{3}{9}+\\tfrac{3}{9}+\\tfrac{4}{9}=\\tfrac{10}{9}.\n$$\n\n- 在面 $f_1$ 上, $\\mathbf{x}_{f_1}^{c}=(0,\\tfrac{2}{3},1)$:\n$$\n\\mathbf{F}(\\mathbf{x}_{f_1}^{c})=\\big[0,\\;0,\\;\\tfrac{4}{9}\\big],\n$$\n所以\n$$\n\\mathbf{F}(\\mathbf{x}_{f_1}^{c})\\cdot \\mathbf{a}_{f_1}=\\big(0,0,\\tfrac{4}{9}\\big)\\cdot(-3,0,0)=0.\n$$\n\n- 在面 $f_2$ 上, $\\mathbf{x}_{f_2}^{c}=(\\tfrac{1}{3},0,1)$:\n$$\n\\mathbf{F}(\\mathbf{x}_{f_2}^{c})=\\big[\\tfrac{1}{9},\\;0,\\;0\\big],\n$$\n所以\n$$\n\\mathbf{F}(\\mathbf{x}_{f_2}^{c})\\cdot \\mathbf{a}_{f_2}=\\big(\\tfrac{1}{9},0,0\\big)\\cdot(0,-\\tfrac{3}{2},0)=0.\n$$\n\n- 在面 $f_3$ 上, $\\mathbf{x}_{f_3}^{c}=(\\tfrac{1}{3},\\tfrac{2}{3},0)$:\n$$\n\\mathbf{F}(\\mathbf{x}_{f_3}^{c})=\\Big[\\tfrac{1}{9},\\tfrac{2}{9},\\tfrac{4}{9}\\Big],\n$$\n所以\n$$\n\\mathbf{F}(\\mathbf{x}_{f_3}^{c})\\cdot \\mathbf{a}_{f_3}=\\Big(\\tfrac{1}{9},\\tfrac{2}{9},\\tfrac{4}{9}\\Big)\\cdot(0,0,-1)=-\\tfrac{4}{9}.\n$$\n\n对近似的面通量求和：\n$$\n\\sum_{f}\\mathbf{F}(\\mathbf{x}_{f}^{c})\\cdot \\mathbf{a}_{f}=\\tfrac{10}{9}+0+0-\\tfrac{4}{9}=\\tfrac{6}{9}=\\tfrac{2}{3}.\n$$\n由于 $|K|=1$，我们得到\n$$\n(\\nabla_h\\cdot \\mathbf{F})_P=\\frac{1}{|K|}\\sum_{f}\\mathbf{F}(\\mathbf{x}_{f}^{c})\\cdot \\mathbf{a}_{f}=\\tfrac{2}{3}.\n$$\n\n步骤4：精确的单元平均散度和比较。\n计算解析散度：\n$$\n\\nabla\\cdot \\mathbf{F}=\\frac{\\partial}{\\partial x}(x^2)+\\frac{\\partial}{\\partial y}(xy)+\\frac{\\partial}{\\partial z}(y^2)=2x+x+0=3x.\n$$\n精确的单元平均值为\n$$\n\\langle \\nabla\\cdot \\mathbf{F} \\rangle_K \\;=\\; \\frac{1}{|K|}\\int_{K} 3x\\,\\mathrm{d}V \\;=\\; 3\\,\\bar{x}_K,\n$$\n其中 $\\bar{x}_K$ 是 $x$ 在 $K$ 上的体平均值。对于一个四面体，线性函数的体平均值等于其在形心处的值，而形心是顶点的平均值。因此\n$$\n\\bar{x}_K=\\frac{x_0+x_1+x_2+x_3}{4}=\\frac{0+1+0+0}{4}=\\frac{1}{4},\n$$\n所以\n$$\n\\langle \\nabla\\cdot \\mathbf{F} \\rangle_K=3\\cdot \\frac{1}{4}=\\frac{3}{4}.\n$$\n因此，使用1次面求积的带符号差异为\n$$\n(\\nabla_h\\cdot \\mathbf{F})_P-\\langle \\nabla\\cdot \\mathbf{F} \\rangle_K=\\frac{2}{3}-\\frac{3}{4}=-\\frac{1}{12}.\n$$\n出现非零误差是因为被积函数 $\\mathbf{F}\\cdot \\mathbf{n}$ 在每个平面三角形面上是一个二次多项式，而单点形心法则在三角形上仅能精确积分最高为1次的多项式。一个2次精确的三角形求积法则可以精确地积分每个面通量，从而对于此处的 $\\mathbf{F}$ 和 $K$，离散平均散度和精确平均散度会相等。", "answer": "$$\\boxed{\\tfrac{2}{3}}$$", "id": "3291622"}, {"introduction": "在上一节练习的基础上，我们现在聚焦于通量计算本身——这是FVM离散化中的关键一步。本练习将深入探讨控制体表面通量积分的数值近似精度问题。通过对一个多项式通量场，精确计算其在一个面上的积分，并与高斯-勒让德求积公式得到的结果进行比较，你将能够量化分析数值误差，并理解求积规则的选择如何决定了格式的精度阶。[@problem_id:3291619]", "problem": "考虑一个二维标量 $u$ 的守恒律，其通量密度为 $\\boldsymbol{F}(x,y)$，在一个局部控制体内由 $\\nabla \\cdot \\boldsymbol{F} = 0$ 控制。有限体积法（FVM）利用散度定理将体积平衡转化为面上的积分通量。设控制体为方形单元 $\\Omega_h = [0,h] \\times [0,h]$，其边界 $\\partial \\Omega_h$ 上的单位外法向量为 $\\boldsymbol{n}$。散度定理表明\n$$\n\\int_{\\Omega_h} \\nabla \\cdot \\boldsymbol{F} \\, \\mathrm{d}x\\,\\mathrm{d}y \\;=\\; \\int_{\\partial \\Omega_h} \\boldsymbol{F} \\cdot \\boldsymbol{n} \\, \\mathrm{d}s.\n$$\n在基于面的离散化中，每个面通量通过一维求积进行近似。我们关注右侧面 $\\Gamma_{\\mathrm{R}} = \\{(x,y) \\in \\partial \\Omega_h : x = h, \\; y \\in [0,h]\\}$，其单位外法向量为 $\\boldsymbol{n}_{\\mathrm{R}} = (1,0)$。设通量密度为多项式场\n$$\n\\boldsymbol{F}(x,y) \\;=\\; \\begin{pmatrix} y^{4} + x\\,y^{3} \\\\ x^{4} + x^{3}\\,y \\end{pmatrix}.\n$$\n将精确的右侧面通量定义为\n$$\n\\Phi_{\\mathrm{R}}^{\\mathrm{exact}}(h) \\;=\\; \\int_{0}^{h} \\boldsymbol{F}(h,y)\\cdot \\boldsymbol{n}_{\\mathrm{R}} \\, \\mathrm{d}y \\;=\\; \\int_{0}^{h} \\left(y^{4} + h\\,y^{3}\\right) \\, \\mathrm{d}y.\n$$\n使用参考区间 $\\xi \\in [-1,1]$ 上的两点 Gauss–Legendre 法则来近似右侧面通量，其节点为 $\\xi_{1} = -\\frac{1}{\\sqrt{3}}$、$\\xi_{2} = \\frac{1}{\\sqrt{3}}$，权重为 $w_{1} = w_{2} = 1$。通过 $y(\\xi) = \\frac{h}{2}(1+\\xi)$ 将参考区间映射到物理面，并包含雅可比行列式 $\\frac{\\mathrm{d}y}{\\mathrm{d}\\xi} = \\frac{h}{2}$。求积近似为\n$$\n\\Phi_{\\mathrm{R}}^{\\mathrm{quad}}(h) \\;=\\; \\frac{h}{2} \\sum_{i=1}^{2} w_{i} \\left[\\, y(\\xi_{i})^{4} + h\\,y(\\xi_{i})^{3} \\,\\right].\n$$\n以闭合形式计算 $\\Phi_{\\mathrm{R}}^{\\mathrm{exact}}(h)$ 和 $\\Phi_{\\mathrm{R}}^{\\mathrm{quad}}(h)$，确定当 $h \\to 0$ 时的主阶渐近误差 $E(h) = \\Phi_{\\mathrm{R}}^{\\mathrm{quad}}(h) - \\Phi_{\\mathrm{R}}^{\\mathrm{exact}}(h)$，并评估由 $E(h) = C\\,h^{p} + o(h^{p})$（对于某个常数 $C \\neq 0$）定义的所达到的阶数 $p$。仅提供指数 $p$ 作为最终答案。最终答案是无量纲的，不需要单位。", "solution": "问题陈述经验证具有科学依据、良态且客观。它包含了获得唯一解所需的所有必要信息。向量微积分（散度定理）、数值分析（Gauss-Legendre 求积）和渐近误差分析等概念均为标准概念且陈述正确。不存在不一致或缺陷。\n\n任务是求面通量积分数值近似的精度阶数 $p$。这通过找到当 $h \\to 0$ 时误差 $E(h) = \\Phi_{\\mathrm{R}}^{\\mathrm{quad}}(h) - \\Phi_{\\mathrm{R}}^{\\mathrm{exact}}(h)$ 渐近展开式中的主阶项来确定。该过程包括三个主要步骤：\n1.  通过直接积分计算精确通量 $\\Phi_{\\mathrm{R}}^{\\mathrm{exact}}(h)$。\n2.  使用指定的两点 Gauss-Legendre 求积法则计算近似通量 $\\Phi_{\\mathrm{R}}^{\\mathrm{quad}}(h)$。\n3.  计算误差 $E(h)$ 并从其主阶项中确定指数 $p$。\n\n首先，我们计算精确通量 $\\Phi_{\\mathrm{R}}^{\\mathrm{exact}}(h)$。该积分定义为：\n$$\n\\Phi_{\\mathrm{R}}^{\\mathrm{exact}}(h) = \\int_{0}^{h} \\left(y^{4} + h\\,y^{3}\\right) \\, \\mathrm{d}y\n$$\n这是一个直接的多项式积分：\n$$\n\\Phi_{\\mathrm{R}}^{\\mathrm{exact}}(h) = \\left[ \\frac{y^{5}}{5} + h\\,\\frac{y^{4}}{4} \\right]_{0}^{h} = \\frac{h^{5}}{5} + h\\,\\frac{h^{4}}{4} - 0 = \\frac{h^{5}}{5} + \\frac{h^{5}}{4}\n$$\n使用公分母合并各项得到：\n$$\n\\Phi_{\\mathrm{R}}^{\\mathrm{exact}}(h) = \\left(\\frac{4}{20} + \\frac{5}{20}\\right)h^{5} = \\frac{9}{20}h^{5}\n$$\n\n接下来，我们计算近似通量 $\\Phi_{\\mathrm{R}}^{\\mathrm{quad}}(h)$。求积法则应用于被积函数 $f(y) = y^{4} + h\\,y^{3}$。物理域 $[0,h]$ 中的求积点是通过使用变换 $y(\\xi) = \\frac{h}{2}(1+\\xi)$ 映射参考节点 $\\xi_1 = -\\frac{1}{\\sqrt{3}}$ 和 $\\xi_2 = \\frac{1}{\\sqrt{3}}$ 得到的。\n物理节点是：\n$$\ny_{1} = y(\\xi_{1}) = \\frac{h}{2}\\left(1 - \\frac{1}{\\sqrt{3}}\\right)\n$$\n$$\ny_{2} = y(\\xi_{2}) = \\frac{h}{2}\\left(1 + \\frac{1}{\\sqrt{3}}\\right)\n$$\n求积公式由下式给出：\n$$\n\\Phi_{\\mathrm{R}}^{\\mathrm{quad}}(h) = \\frac{h}{2} \\sum_{i=1}^{2} w_{i} f(y_i) = \\frac{h}{2} \\left[ w_1 \\left(y_1^4 + h y_1^3\\right) + w_2 \\left(y_2^4 + h y_2^3\\right) \\right]\n$$\n当权重 $w_1 = w_2 = 1$ 时，上式简化为：\n$$\n\\Phi_{\\mathrm{R}}^{\\mathrm{quad}}(h) = \\frac{h}{2} \\left[ (y_1^4 + y_2^4) + h(y_1^3 + y_2^3) \\right]\n$$\n我们计算和 $y_1^3 + y_2^3$ 和 $y_1^4 + y_2^4$。令 $a = \\frac{h}{2}$ 和 $b = \\frac{h}{2\\sqrt{3}}$，因此 $y_1 = a-b$ 且 $y_2=a+b$。\n使用二项式展开，$(a-b)^3 + (a+b)^3 = 2a^3 + 6ab^2$。\n$$\ny_1^3 + y_2^3 = 2\\left(\\frac{h}{2}\\right)^3 + 6\\left(\\frac{h}{2}\\right)\\left(\\frac{h}{2\\sqrt{3}}\\right)^2 = 2\\frac{h^3}{8} + 6\\frac{h}{2}\\frac{h^2}{12} = \\frac{h^3}{4} + \\frac{h^3}{4} = \\frac{h^3}{2}\n$$\n类似地，对于四次方，$(a-b)^4 + (a+b)^4 = 2a^4 + 12a^2b^2 + 2b^4$。\n$$\ny_1^4 + y_2^4 = 2\\left(\\frac{h}{2}\\right)^4 + 12\\left(\\frac{h}{2}\\right)^2\\left(\\frac{h}{2\\sqrt{3}}\\right)^2 + 2\\left(\\frac{h}{2\\sqrt{3}}\\right)^4\n$$\n$$\ny_1^4 + y_2^4 = 2\\frac{h^4}{16} + 12\\frac{h^2}{4}\\frac{h^2}{12} + 2\\frac{h^4}{144} = \\frac{h^4}{8} + \\frac{h^4}{4} + \\frac{h^4}{72}\n$$\n$$\ny_1^4 + y_2^4 = h^4\\left(\\frac{9}{72} + \\frac{18}{72} + \\frac{1}{72}\\right) = h^4\\frac{28}{72} = \\frac{7}{18}h^4\n$$\n将这些和代入 $\\Phi_{\\mathrm{R}}^{\\mathrm{quad}}(h)$ 的表达式中：\n$$\n\\Phi_{\\mathrm{R}}^{\\mathrm{quad}}(h) = \\frac{h}{2} \\left[ \\frac{7}{18}h^4 + h\\left(\\frac{h^3}{2}\\right) \\right] = \\frac{h}{2} \\left[ \\frac{7}{18}h^4 + \\frac{9}{18}h^4 \\right] = \\frac{h}{2} \\left( \\frac{16}{18}h^4 \\right) = \\frac{h}{2} \\left( \\frac{8}{9}h^4 \\right) = \\frac{4}{9}h^5\n$$\n\n最后，我们计算误差 $E(h) = \\Phi_{\\mathrm{R}}^{\\mathrm{quad}}(h) - \\Phi_{\\mathrm{R}}^{\\mathrm{exact}}(h)$：\n$$\nE(h) = \\frac{4}{9}h^{5} - \\frac{9}{20}h^{5} = \\left(\\frac{4 \\cdot 20}{9 \\cdot 20} - \\frac{9 \\cdot 9}{20 \\cdot 9}\\right)h^{5} = \\left(\\frac{80 - 81}{180}\\right)h^{5} = -\\frac{1}{180}h^{5}\n$$\n误差的形式为 $E(h) = C h^{p} + o(h^{p})$，其中常数 $C = -\\frac{1}{180}$，高阶项 $o(h^p)$ 为零。指数 $p$ 是误差的阶数。\n通过将我们的结果 $E(h) = -\\frac{1}{180}h^{5}$ 与定义 $E(h) = C h^p + o(h^p)$进行比较，我们确定阶数 $p$ 为 $5$。这与 Gauss-Legendre 求积理论一致，该理论指出 $n$ 点法则能精确积分最高 $2n-1$ 次的多项式。对于 $n=2$，即为 3 次。被积函数在变换到参考区间后是一个 4 次多项式，因此误差项预计不为零，并与 $(2n)$ 阶导数（即 4 阶导数）有关。来自变换 $y(\\xi)$ 和雅可比行列式 $\\frac{dy}{d\\xi}$ 的 $h$ 因子导致了总体的 $h^5$ 依赖性。\n所达到的阶数是 $p=5$。", "answer": "$$\\boxed{5}$$", "id": "3291619"}, {"introduction": "实际的CFD模拟往往采用非理想的、非正交的网格，这给扩散项的精确离散带来了挑战。本练习将带你处理这一高级但常见的问题，即在倾斜的四边形单元上计算扩散通量时引入一个非正交修正项。通过完成这个计算，你将理解为何在非正交网格上需要这种修正，以及它如何帮助我们在复杂几何形状上保持计算的准确性。[@problem_id:3291658]", "problem": "在计算流体动力学的二维有限体积法设置中，考虑一个单一的扭曲四边形控制体，其顶点按逆时针顺序列于 $(0,0)$、$(2,0)$、$(3,1)$ 和 $(0,1)$。令控制体中心 $\\boldsymbol{x}_{P}$ 为多边形的质心。令每个面的中心 $\\boldsymbol{x}_{f}$ 为其两个端点的中点。将每个面上的外向面面积矢量 $\\boldsymbol{S}_{f}$ 定义为一个长度等于面长、垂直于该面且指向控制体外部的矢量。具体来说，对于一条从 $(x_{i},y_{i})$ 到 $(x_{i+1},y_{i+1})$ 的有向边，取其边矢量 $\\boldsymbol{t}_{i}=(x_{i+1}-x_{i},\\,y_{i+1}-y_{i})$，并设置 $\\boldsymbol{S}_{f}=(y_{i+1}-y_{i},\\, -(x_{i+1}-x_{i}))$。对于每个面，通过将主中心 $\\boldsymbol{x}_{P}$ 相对于面中心 $\\boldsymbol{x}_{f}$ 做镜像来定义面另一侧的相邻单元中心，即 $\\boldsymbol{x}_{N} = 2\\,\\boldsymbol{x}_{f} - \\boldsymbol{x}_{P}$，并定义 $\\boldsymbol{d} = \\boldsymbol{x}_{N} - \\boldsymbol{x}_{P}$ 和 $\\boldsymbol{e}_{d} = \\boldsymbol{d}/|\\boldsymbol{d}|$。\n\n假设扩散系数为常数 $\\Gamma = 1$（无量纲），标量场为 $\\phi(x,y) = x^{2} + y^{2}$（无量纲）。使用带有面法向梯度正交修正项的有限体积法 (FVM)，将控制体内的扩散残差近似为所有面上扩散通量贡献的总和：\n$$\nR_{\\mathrm{disc}} \\approx \\sum_{f} \\Gamma \\left[ \\left(\\boldsymbol{S}_{f} \\cdot \\boldsymbol{e}_{d}\\right) \\frac{\\phi_{N} - \\phi_{P}}{|\\boldsymbol{d}|} \\;+\\; \\left(\\boldsymbol{S}_{f} - \\left(\\boldsymbol{S}_{f} \\cdot \\boldsymbol{e}_{d}\\right)\\boldsymbol{e}_{d}\\right) \\cdot \\left(\\nabla \\phi\\right)_{f}^{\\mathrm{avg}} \\right],\n$$\n其中 $\\phi_{P}=\\phi(\\boldsymbol{x}_{P})$，$\\phi_{N}=\\phi(\\boldsymbol{x}_{N})$，且 $\\left(\\nabla \\phi\\right)_{f}^{\\mathrm{avg}}$ 是在 $\\boldsymbol{x}_{P}$ 和 $\\boldsymbol{x}_{N}$ 处求值的精确单元中心梯度的算术平均值。作为对比，在控制体上积分的精确扩散项散度为\n$$\nR_{\\mathrm{exact}} \\;=\\; \\int_{V} \\nabla \\cdot \\left( \\Gamma \\nabla \\phi \\right) \\, \\mathrm{d}V.\n$$\n\n将所有量视为无量纲。计算 $R_{\\mathrm{disc}}$ 的数值。你的最终答案必须是一个实数，无需四舍五入。", "solution": "本题要求计算在给定的四边形控制体和标量场下，离散化的扩散残差 $R_{\\mathrm{disc}}$。该残差的计算公式为控制体所有面贡献的总和：\n$$\nR_{\\mathrm{disc}} = \\sum_{f} \\Gamma \\left[ \\left(\\boldsymbol{S}_{f} \\cdot \\boldsymbol{e}_{d}\\right) \\frac{\\phi_{N} - \\phi_{P}}{|\\boldsymbol{d}|} \\;+\\; \\left(\\boldsymbol{S}_{f} - \\left(\\boldsymbol{S}_{f} \\cdot \\boldsymbol{e}_{d}\\right)\\boldsymbol{e}_{d}\\right) \\cdot \\left(\\nabla \\phi\\right)_{f}^{\\mathrm{avg}} \\right]\n$$\n已知 $\\boldsymbol{e}_d = \\boldsymbol{d}/|\\boldsymbol{d}|$，该表达式可以重写以避免显式计算单位矢量及其相关的平方根，从而简化算术运算：\n$$\nR_{\\mathrm{disc}} = \\sum_{f} \\Gamma \\left[ \\frac{\\phi_{N} - \\phi_{P}}{|\\boldsymbol{d}|^2} (\\boldsymbol{S}_{f} \\cdot \\boldsymbol{d}) \\;+\\; \\left(\\boldsymbol{S}_{f} - \\frac{\\boldsymbol{S}_{f} \\cdot \\boldsymbol{d}}{|\\boldsymbol{d}|^2}\\boldsymbol{d}\\right) \\cdot \\left(\\nabla \\phi\\right)_{f}^{\\mathrm{avg}} \\right]\n$$\n我们已知恒定扩散系数 $\\Gamma = 1$。标量场为 $\\phi(x,y) = x^2 + y^2$，其梯度为 $\\nabla\\phi(x,y) = (2x, 2y)$。\n\n首先，我们确定控制体中心 $\\boldsymbol{x}_P$，即顶点为 $V_1(0,0)$、$V_2(2,0)$、$V_3(3,1)$ 和 $V_4(0,1)$ 的四边形的质心。我们可以通过将该四边形分解为两个三角形 $T_1 = (V_1, V_2, V_3)$ 和 $T_2 = (V_1, V_3, V_4)$，找出它们各自的质心和面积，然后计算加权平均值来求得质心。\n\n顶点为 $(x_1, y_1)$、$(x_2, y_2)$ 和 $(x_3, y_3)$ 的三角形的面积为 $A = \\frac{1}{2}|x_1(y_2-y_3) + x_2(y_3-y_1) + x_3(y_1-y_2)|$。其质心为 $C = \\frac{1}{3}((x_1,y_1)+(x_2,y_2)+(x_3,y_3))$。\n\n对于三角形 $T_1((0,0), (2,0), (3,1))$：\n面积 $A_1 = \\frac{1}{2}|0(0-1) + 2(1-0) + 3(0-0)| = 1$。\n质心 $C_1 = \\frac{1}{3}((0,0)+(2,0)+(3,1)) = (\\frac{5}{3}, \\frac{1}{3})$。\n\n对于三角形 $T_2((0,0), (3,1), (0,1))$：\n面积 $A_2 = \\frac{1}{2}|0(1-1) + 3(1-0) + 0(0-1)| = \\frac{3}{2}$。\n质心 $C_2 = \\frac{1}{3}((0,0)+(3,1)+(0,1)) = (1, \\frac{2}{3})$。\n\n总面积为 $A = A_1+A_2 = 1+\\frac{3}{2} = \\frac{5}{2}$。控制体中心为：\n$\\boldsymbol{x}_P = \\frac{A_1 C_1 + A_2 C_2}{A} = \\frac{1(\\frac{5}{3}, \\frac{1}{3}) + \\frac{3}{2}(1, \\frac{2}{3})}{\\frac{5}{2}} = \\frac{(\\frac{5}{3}+\\frac{3}{2}, \\frac{1}{3}+1)}{\\frac{5}{2}} = \\frac{(\\frac{19}{6}, \\frac{4}{3})}{\\frac{5}{2}} = (\\frac{19}{15}, \\frac{8}{15})$。\n\n接下来，我们在 $\\boldsymbol{x}_P$ 处计算 $\\phi$ 和 $\\nabla\\phi$：\n$\\phi_P = \\phi(\\boldsymbol{x}_P) = (\\frac{19}{15})^2 + (\\frac{8}{15})^2 = \\frac{361+64}{225} = \\frac{425}{225} = \\frac{17}{9}$。\n$\\nabla\\phi(\\boldsymbol{x}_P) = (2 \\cdot \\frac{19}{15}, 2 \\cdot \\frac{8}{15}) = (\\frac{38}{15}, \\frac{16}{15})$。\n\n现在，我们计算来自四个面中每一个面的贡献。\n\n面 1：从 $V_1(0,0)$ 到 $V_2(2,0)$。\n$\\boldsymbol{x}_{f1} = \\frac{1}{2}((0,0)+(2,0)) = (1,0)$。\n$\\boldsymbol{S}_{f1} = (0-0, -(2-0)) = (0, -2)$。\n$\\boldsymbol{x}_{N1} = 2\\boldsymbol{x}_{f1} - \\boldsymbol{x}_P = 2(1,0) - (\\frac{19}{15},\\frac{8}{15}) = (\\frac{11}{15}, -\\frac{8}{15})$。\n$\\phi_{N1} = (\\frac{11}{15})^2 + (-\\frac{8}{15})^2 = \\frac{121+64}{225} = \\frac{185}{225} = \\frac{37}{45}$。\n$\\nabla\\phi(\\boldsymbol{x}_{N1}) = (2 \\cdot \\frac{11}{15}, 2 \\cdot (-\\frac{8}{15})) = (\\frac{22}{15}, -\\frac{16}{15})$。\n$\\boldsymbol{d}_1 = \\boldsymbol{x}_{N1} - \\boldsymbol{x}_P = (\\frac{11}{15}-\\frac{19}{15}, -\\frac{8}{15}-\\frac{8}{15}) = (-\\frac{8}{15}, -\\frac{16}{15})$。\n$|\\boldsymbol{d}_1|^2 = (-\\frac{8}{15})^2 + (-\\frac{16}{15})^2 = \\frac{64+256}{225} = \\frac{320}{225} = \\frac{64}{45}$。\n$\\phi_{N1}-\\phi_P = \\frac{37}{45} - \\frac{17}{9} = \\frac{37-85}{45} = -\\frac{48}{45} = -\\frac{16}{15}$。\n$\\boldsymbol{S}_{f1} \\cdot \\boldsymbol{d}_1 = (0,-2)\\cdot(-\\frac{8}{15}, -\\frac{16}{15}) = \\frac{32}{15}$。\n正交项：$\\frac{\\phi_{N1}-\\phi_P}{|\\boldsymbol{d}_1|^2}(\\boldsymbol{S}_{f1} \\cdot \\boldsymbol{d}_1) = \\frac{-16/15}{64/45}(\\frac{32}{15}) = -\\frac{16}{15}\\frac{45}{64}\\frac{32}{15} = -\\frac{1 \\cdot 3 \\cdot 1}{1 \\cdot 4 \\cdot 1} \\frac{32}{15} = -\\frac{3}{4}\\frac{32}{15} = - \\frac{8}{5}$。\n$(\\nabla \\phi)_{f1}^{\\mathrm{avg}} = \\frac{1}{2}((\\frac{38}{15},\\frac{16}{15})+(\\frac{22}{15},-\\frac{16}{15})) = \\frac{1}{2}(\\frac{60}{15}, 0) = (2,0)$。\n非正交矢量投影：$\\frac{\\boldsymbol{S}_{f1}\\cdot\\boldsymbol{d}_1}{|\\boldsymbol{d}_1|^2}\\boldsymbol{d}_1 = \\frac{32/15}{64/45}(-\\frac{8}{15}, -\\frac{16}{15}) = \\frac{3}{2}(-\\frac{8}{15}, -\\frac{16}{15}) = (-\\frac{4}{5}, -\\frac{8}{5})$。\n非正交矢量：$\\boldsymbol{S}_f - (\\dots) = (0,-2) - (-\\frac{4}{5}, -\\frac{8}{5}) = (\\frac{4}{5}, -\\frac{2}{5})$。\n非正交项：$(\\frac{4}{5}, -\\frac{2}{5}) \\cdot (2,0) = \\frac{8}{5}$。\n来自面 1 的通量贡献：$-\\frac{8}{5} + \\frac{8}{5} = 0$。\n\n面 2：从 $V_2(2,0)$ 到 $V_3(3,1)$。\n$\\boldsymbol{x}_{f2} = \\frac{1}{2}((2,0)+(3,1)) = (\\frac{5}{2},\\frac{1}{2})$。\n$\\boldsymbol{S}_{f2} = (1-0, -(3-2)) = (1, -1)$。\n$\\boldsymbol{x}_{N2} = 2(\\frac{5}{2},\\frac{1}{2}) - (\\frac{19}{15},\\frac{8}{15}) = (5,1) - (\\frac{19}{15},\\frac{8}{15}) = (\\frac{56}{15}, \\frac{7}{15})$。\n$\\phi_{N2} = (\\frac{56}{15})^2+(\\frac{7}{15})^2 = \\frac{3136+49}{225} = \\frac{3185}{225} = \\frac{637}{45}$。\n$\\nabla\\phi(\\boldsymbol{x}_{N2}) = (\\frac{112}{15}, \\frac{14}{15})$。\n$\\boldsymbol{d}_2 = (\\frac{56-19}{15}, \\frac{7-8}{15}) = (\\frac{37}{15}, -\\frac{1}{15})$。\n$|\\boldsymbol{d}_2|^2 = (\\frac{37}{15})^2+(-\\frac{1}{15})^2 = \\frac{1369+1}{225} = \\frac{1370}{225} = \\frac{274}{45}$。\n$\\phi_{N2}-\\phi_P = \\frac{637}{45} - \\frac{17}{9} = \\frac{637-85}{45} = \\frac{552}{45} = \\frac{184}{15}$。\n$\\boldsymbol{S}_{f2} \\cdot \\boldsymbol{d}_2 = (1,-1)\\cdot(\\frac{37}{15}, -\\frac{1}{15}) = \\frac{38}{15}$。\n正交项：$\\frac{184/15}{274/45}(\\frac{38}{15}) = \\frac{184 \\cdot 45 \\cdot 38}{15 \\cdot 274 \\cdot 15} = \\frac{184 \\cdot 3 \\cdot 38}{274 \\cdot 15} = \\frac{3496}{685}$。\n$(\\nabla \\phi)_{f2}^{\\mathrm{avg}} = \\frac{1}{2}((\\frac{38}{15},\\frac{16}{15})+(\\frac{112}{15},\\frac{14}{15})) = \\frac{1}{2}(\\frac{150}{15}, \\frac{30}{15}) = (5,1)$。\n非正交矢量投影：$\\frac{38/15}{274/45}(\\frac{37}{15}, -\\frac{1}{15}) = \\frac{19 \\cdot 3}{137 \\cdot 15}(37,-1) = \\frac{19}{685}(37,-1) = (\\frac{703}{685}, -\\frac{19}{685})$。\n非正交矢量：$(1,-1) - (\\frac{703}{685}, -\\frac{19}{685}) = (-\\frac{18}{685}, -\\frac{666}{685})$。\n非正交项：$(-\\frac{18}{685}, -\\frac{666}{685}) \\cdot (5,1) = \\frac{-90-666}{685} = -\\frac{756}{685}$。\n来自面 2 的通量贡献：$\\frac{3496}{685} - \\frac{756}{685} = \\frac{2740}{685} = 4$。\n\n面 3：从 $V_3(3,1)$ 到 $V_4(0,1)$。\n$\\boldsymbol{x}_{f3} = \\frac{1}{2}((3,1)+(0,1)) = (\\frac{3}{2},1)$。\n$\\boldsymbol{S}_{f3} = (1-1, -(0-3)) = (0, 3)$。\n$\\boldsymbol{x}_{N3} = 2(\\frac{3}{2},1) - (\\frac{19}{15},\\frac{8}{15}) = (3,2) - (\\frac{19}{15},\\frac{8}{15}) = (\\frac{26}{15}, \\frac{22}{15})$。\n$\\phi_{N3} = (\\frac{26}{15})^2+(\\frac{22}{15})^2 = \\frac{676+484}{225} = \\frac{1160}{225} = \\frac{232}{45}$。\n$\\nabla\\phi(\\boldsymbol{x}_{N3}) = (\\frac{52}{15}, \\frac{44}{15})$。\n$\\boldsymbol{d}_3 = (\\frac{26-19}{15}, \\frac{22-8}{15}) = (\\frac{7}{15}, \\frac{14}{15})$。\n$|\\boldsymbol{d}_3|^2 = (\\frac{7}{15})^2+(\\frac{14}{15})^2 = \\frac{49+196}{225} = \\frac{245}{225} = \\frac{49}{45}$。\n$\\phi_{N3}-\\phi_P = \\frac{232}{45} - \\frac{17}{9} = \\frac{232-85}{45} = \\frac{147}{45} = \\frac{49}{15}$。\n$\\boldsymbol{S}_{f3} \\cdot \\boldsymbol{d}_3 = (0,3)\\cdot(\\frac{7}{15}, \\frac{14}{15}) = \\frac{42}{15} = \\frac{14}{5}$。\n正交项：$\\frac{49/15}{49/45}(\\frac{14}{5}) = 3 \\cdot \\frac{14}{5} = \\frac{42}{5}$。\n$(\\nabla \\phi)_{f3}^{\\mathrm{avg}} = \\frac{1}{2}((\\frac{38}{15},\\frac{16}{15})+(\\frac{52}{15},\\frac{44}{15})) = \\frac{1}{2}(\\frac{90}{15}, \\frac{60}{15}) = (3,2)$。\n非正交矢量投影：$\\frac{14/5}{49/45}(\\frac{7}{15}, \\frac{14}{15}) = \\frac{14}{5}\\frac{45}{49}\\frac{1}{15}(7,14) = \\frac{18}{7 \\cdot 15}(7,14) = (\\frac{6}{5}, \\frac{12}{5})$。\n非正交矢量：$(0,3) - (\\frac{6}{5}, \\frac{12}{5}) = (-\\frac{6}{5}, \\frac{3}{5})$。\n非正交项：$(-\\frac{6}{5}, \\frac{3}{5}) \\cdot (3,2) = \\frac{-18+6}{5} = -\\frac{12}{5}$。\n来自面 3 的通量贡献：$\\frac{42}{5} - \\frac{12}{5} = \\frac{30}{5} = 6$。\n\n面 4：从 $V_4(0,1)$ 到 $V_1(0,0)$。\n$\\boldsymbol{x}_{f4} = \\frac{1}{2}((0,1)+(0,0)) = (0, \\frac{1}{2})$。\n$\\boldsymbol{S}_{f4} = (0-1, -(0-0)) = (-1, 0)$。\n$\\boldsymbol{x}_{N4} = 2(0,\\frac{1}{2}) - (\\frac{19}{15},\\frac{8}{15}) = (0,1) - (\\frac{19}{15},\\frac{8}{15}) = (-\\frac{19}{15}, \\frac{7}{15})$。\n$\\phi_{N4} = (-\\frac{19}{15})^2+(\\frac{7}{15})^2 = \\frac{361+49}{225} = \\frac{410}{225} = \\frac{82}{45}$。\n$\\nabla\\phi(\\boldsymbol{x}_{N4}) = (-\\frac{38}{15}, \\frac{14}{15})$。\n$\\boldsymbol{d}_4 = \\boldsymbol{x}_{N4} - \\boldsymbol{x}_P = (-\\frac{19}{15} - \\frac{19}{15}, \\frac{7}{15} - \\frac{8}{15}) = (-\\frac{38}{15}, -\\frac{1}{15})$。\n$|\\boldsymbol{d}_4|^2 = (-\\frac{38}{15})^2+(-\\frac{1}{15})^2 = \\frac{1444+1}{225} = \\frac{1445}{225} = \\frac{289}{45}$。\n$\\phi_{N4}-\\phi_P = \\frac{82}{45} - \\frac{17}{9} = \\frac{82-85}{45} = -\\frac{3}{45} = -\\frac{1}{15}$。\n$\\boldsymbol{S}_{f4} \\cdot \\boldsymbol{d}_4 = (-1,0)\\cdot(-\\frac{38}{15}, -\\frac{1}{15}) = \\frac{38}{15}$。\n正交项：$\\frac{-1/15}{289/45}(\\frac{38}{15}) = -\\frac{1 \\cdot 45 \\cdot 38}{15 \\cdot 289 \\cdot 15} = -\\frac{3 \\cdot 38}{289 \\cdot 15} = -\\frac{38}{1445}$。\n$(\\nabla \\phi)_{f4}^{\\mathrm{avg}} = \\frac{1}{2}((\\frac{38}{15},\\frac{16}{15})+(-\\frac{38}{15},\\frac{14}{15})) = \\frac{1}{2}(0, \\frac{30}{15}) = (0,1)$。\n非正交矢量投影：$\\frac{38/15}{289/45}(-\\frac{38}{15}, -\\frac{1}{15}) = \\frac{38 \\cdot 3}{289 \\cdot 15}(-38,-1) = \\frac{38}{1445}(-38,-1) = (-\\frac{1444}{1445}, -\\frac{38}{1445})$。\n非正交矢量：$(-1,0) - (-\\frac{1444}{1445}, -\\frac{38}{1445}) = (-\\frac{1}{1445}, \\frac{38}{1445})$。\n非正交项：$(-\\frac{1}{1445}, \\frac{38}{1445}) \\cdot (0,1) = \\frac{38}{1445}$。\n来自面 4 的通量贡献：$-\\frac{38}{1445} + \\frac{38}{1445} = 0$。\n\n最后，我们将所有四个面的贡献相加：\n$R_{\\mathrm{disc}} = 0 + 4 + 6 + 0 = 10$。\n\n精确积分为 $R_{\\mathrm{exact}} = \\int_V \\nabla \\cdot (\\Gamma \\nabla \\phi) \\,dV$。对于 $\\Gamma=1$ 和 $\\phi=x^2+y^2$，我们有 $\\nabla\\phi=(2x,2y)$ 和 $\\nabla\\cdot\\nabla\\phi=4$。因此，$R_{\\mathrm{exact}} = \\int_V 4 \\,dV = 4 \\times \\text{Area}(V) = 4 \\times \\frac{5}{2} = 10$。所选的数值格式对于此二次场是精确的，这证实了计算结果。", "answer": "$$\\boxed{10}$$", "id": "3291658"}]}