{"hands_on_practices": [{"introduction": "Weierstrass 定理保证了多项式可以在一个紧区间上一致逼近任意连续函数，但“最佳”逼近的定义取决于我们选择的范数。这个练习旨在探讨两种基本的多项式逼近策略：最小最大值逼近（在 $L^\\infty$ 范数下）和加权最小二乘逼近（在 $L^2$ 范数下）。通过对一个典型的非光滑函数 $f(x)=|x|$ 进行分析 [@problem_id:3428460]，你将亲手计算并比较这两种逼近的误差，从而深刻理解不同范数在谱方法和 DG 方法中的意义和影响。", "problem": "设函数 $f(x)=|x|$ 定义在区间 $[-1,1]$ 上。Weierstrass 逼近定理保证了多项式在一致范数下在 $C([-1,1])$ 中是稠密的，这是支撑采用多项式基的光谱方法和间断 Galerkin (DG) 方法的一个基本事实。考虑两种不同的逼近策略，每种策略都是使用 Chebyshev 多项式进行谱分析的基础：\n\n1. 在次数至多为 $1$ 的多项式空间 $\\mathbb{P}_{1}$ 中的极小化极大（一致范数）逼近，其中误差由一致范数 $\\|g\\|_{\\infty}=\\sup_{x\\in[-1,1]}|g(x)|$ 度量。\n\n2. 到 $\\mathbb{P}_{1}$ 上的带权 $w(x)=(1-x^{2})^{-1/2}$ 的 Chebyshev 加权 Lebesgue $L^{2}$ 投影，即关于内积 $\\langle g,h\\rangle_{w}=\\int_{-1}^{1}g(x)h(x)w(x)\\,dx$ 的正交投影。\n\n任务：\n- 计算精确的极小化极大一致范数误差 $E_{\\infty}=\\inf_{p\\in\\mathbb{P}_{1}}\\|f-p\\|_{\\infty}$ 并确定极小化子 $p^{\\star}\\in\\mathbb{P}_{1}$。\n- 计算精确的 Chebyshev 加权 $L^{2}$ 投影 $P_{1}^{w}f\\in\\mathbb{P}_{1}$ 以及精确的加权 $L^{2}$ 误差 $\\|f-P_{1}^{w}f\\|_{L^{2}_{w}}=\\big(\\int_{-1}^{1}(f-p)^{2}w\\,dx\\big)^{1/2}$。\n- 使用 $f$ 的 Chebyshev 级数，推导 $f$ 的 $N$ 次截断 Chebyshev 级数的一致误差的一个严格上界，该上界通过其 Chebyshev 系数的尾部表示为 $N$ 的函数。以闭合形式明确写出最终的界，并包含常数。\n\n最后，报告比值\n$$\nR=\\frac{E_{\\infty}}{\\|f-P_{1}^{w}f\\|_{L^{2}_{w}}}.\n$$\n的精确解析表达式。最终比值不需四舍五入，也不应使用单位。", "solution": "该问题经评估为科学上合理、良定、客观，并符合所有其他验证标准。因此，该问题是有效的，下面提供了完整的解答。\n\n该问题要求分析在区间 $[-1,1]$ 上对函数 $f(x)=|x|$ 进行的两种不同次数至多为 $1$ 的多项式逼近，并求出截断 Chebyshev 级数误差的一个界。\n\n**第一部分：极小化极大逼近**\n\n我们寻求多项式 $p(x) \\in \\mathbb{P}_1$ 以最小化误差的一致范数 $\\|f-p\\|_{\\infty}$。设 $p(x) = ax+b$。我们希望找到 $a, b \\in \\mathbb{R}$ 来最小化 $E(a,b) = \\sup_{x \\in [-1,1]} ||x| - (ax+b)|$。得到的最小误差为 $E_{\\infty}$。\n\n函数 $f(x)=|x|$ 是对称区间 $[-1,1]$ 上的偶函数。逼近论中的一个已知结果是，在 $[-1,1]$ 上对偶函数的最佳一致逼近多项式 $p^{\\star}(x) \\in \\mathbb{P}_n$ 也是一个偶多项式。对于 $p(x)=ax+b \\in \\mathbb{P}_1$，要使其为偶函数，必须有 $p(-x)=p(x)$，即 $a(-x)+b = ax+b$。这意味着对于所有 $x \\in [-1,1]$ 都有 $-ax=ax$，这要求 $a=0$。因此，最佳逼近必须是一个常数多项式，即 $p^{\\star}(x)=b$。\n\n我们现在需要找到常数 $b$ 以最小化 $\\sup_{x \\in [-1,1]} ||x|-b|$。设误差函数为 $e(x) = |x|-b$。$|e(x)|$ 在 $[-1,1]$ 上的极值将出现在 $e(x)$ 的临界点，即端点 $x=\\pm 1$ 和 $|x|$ 的导数未定义的点 $x=0$。\n在这些点上的误差值为：\n$e(-1) = |-1| - b = 1-b$\n$e(0) = |0| - b = -b$\n$e(1) = |1| - b = 1-b$\n\n根据 Chebyshev 交错点定理，对于一个次数为 $n=0$ 的多项式（一个常数），必须至少有 $n+2=2$ 个点，在这些点上误差达到其最大绝对值且符号交替。对于 $n=1$，即我们最初的搜索空间，我们需要 $3$ 个点。使用我们的三个候选点 $x_0=-1$, $x_1=0$, $x_2=1$，我们寻求满足交错点条件。误差必须满足 $|e(x_0)|=|e(x_1)|=|e(x_2)|=E_{\\infty}$ 并且符号交替，例如，$e(x_0) = -e(x_1) = e(x_2)$。\n我们设 $e(-1) = -e(0)$ 和 $e(1) = -e(0)$。\n第一个条件给出 $1-b = -(-b) = b$，这意味着 $2b=1$，所以 $b=1/2$。\n第二个条件是相同的，也得出 $b=1/2$。\n当 $b=1/2$ 时，多项式为 $p^{\\star}(x) = 1/2$。\n在交错点上的误差为：\n$e(-1) = 1 - 1/2 = 1/2$\n$e(0) = -1/2$\n$e(1) = 1 - 1/2 = 1/2$\n最大误差绝对值为 $E_{\\infty} = 1/2$。我们必须验证对于所有其他 $x \\in [-1,1]$，误差绝对值不超过这个值。对于 $x \\in [-1,1]$，我们有 $0 \\le |x| \\le 1$。因此误差函数 $e(x)=|x|-1/2$ 的范围从 $-1/2$（在 $x=0$ 处）到 $1/2$（在 $x=\\pm 1$ 处）。所以，对于所有 $x \\in [-1,1]$，有 $|e(x)| = ||x|-1/2| \\le 1/2$。\n交错点定理的条件对于 $n=0$ 满足，对于 $n=1$ 也满足（因为 $p^\\star \\in \\mathbb{P}_1$ 并且我们有3个交错点）。\n$\\mathbb{P}_1$ 中的极小化极大逼近多项式是 $p^{\\star}(x) = 1/2$。\n极小化极大一致范数误差是 $E_{\\infty} = 1/2$。\n\n**第二部分：Chebyshev 加权 $L^2$ 投影**\n\n我们寻求函数 $f(x)=|x|$ 到 $\\mathbb{P}_1$ 上关于内积 $\\langle g,h\\rangle_w = \\int_{-1}^1 g(x)h(x)(1-x^2)^{-1/2} dx$ 的正交投影 $P_1^w f$。\n空间 $\\mathbb{P}_1$ 由前两个 Chebyshev 多项式 $T_0(x)=1$ 和 $T_1(x)=x$ 张成，它们构成一个正交基。\n投影由 $P_1^w f(x) = c_0 T_0(x) + c_1 T_1(x)$ 给出，其中系数为\n$c_k = \\frac{\\langle f, T_k \\rangle_w}{\\langle T_k, T_k \\rangle_w}$。\n基函数的范数是众所周知的：\n$\\langle T_0, T_0 \\rangle_w = \\int_{-1}^1 1^2 \\frac{dx}{\\sqrt{1-x^2}} = [\\arcsin x]_{-1}^1 = \\pi$。\n$\\langle T_1, T_1 \\rangle_w = \\int_{-1}^1 x^2 \\frac{dx}{\\sqrt{1-x^2}} = \\pi/2$。\n\n对于 $c_0$：\n$\\langle f, T_0 \\rangle_w = \\int_{-1}^1 |x| \\frac{dx}{\\sqrt{1-x^2}}$。被积函数是偶函数，所以积分等于 $2 \\int_0^1 \\frac{x}{\\sqrt{1-x^2}} dx$。\n使用换元法 $u=1-x^2$, $du=-2xdx$：$2 \\int_1^0 \\frac{-du/2}{\\sqrt{u}} = \\int_0^1 u^{-1/2} du = [2\\sqrt{u}]_0^1 = 2$。\n所以，$c_0 = \\frac{2}{\\pi}$。\n\n对于 $c_1$：\n$\\langle f, T_1 \\rangle_w = \\int_{-1}^1 |x|x \\frac{dx}{\\sqrt{1-x^2}}$。被积函数 $g(x)=\\frac{x|x|}{\\sqrt{1-x^2}}$ 是一个奇函数，因为 $g(-x) = \\frac{(-x)|-x|}{\\sqrt{1-(-x)^2}} = -\\frac{x|x|}{\\sqrt{1-x^2}} = -g(x)$。一个奇函数在对称区间 $[-1,1]$ 上的积分为 $0$。\n所以，$\\langle f, T_1 \\rangle_w = 0$，这给出 $c_1 = 0$。\n\n投影是 $P_1^w f(x) = \\frac{2}{\\pi} T_0(x) + 0 \\cdot T_1(x) = \\frac{2}{\\pi}$。\n\n接下来，我们计算加权 $L^2$ 误差 $\\|f - P_1^w f\\|_{L^2_w}$。\n根据 Hilbert 空间中的勾股定理，对于一个正交投影：\n$\\|f - P_1^w f\\|_{L^2_w}^2 = \\|f\\|_{L^2_w}^2 - \\|P_1^w f\\|_{L^2_w}^2$。\n第一项：\n$\\|f\\|_{L^2_w}^2 = \\int_{-1}^1 |x|^2 \\frac{dx}{\\sqrt{1-x^2}} = \\int_{-1}^1 \\frac{x^2}{\\sqrt{1-x^2}} dx$。这个积分等于 $\\langle T_1, T_1 \\rangle_w$，我们已经知道其值为 $\\pi/2$。\n第二项：\n$\\|P_1^w f\\|_{L^2_w}^2 = \\|\\frac{2}{\\pi} T_0\\|_{L^2_w}^2 = (\\frac{2}{\\pi})^2 \\langle T_0, T_0 \\rangle_w = \\frac{4}{\\pi^2} \\cdot \\pi = \\frac{4}{\\pi}$。\n所以，误差的平方是 $\\|f - P_1^w f\\|_{L^2_w}^2 = \\frac{\\pi}{2} - \\frac{4}{\\pi} = \\frac{\\pi^2 - 8}{2\\pi}$。\n加权 $L^2$ 误差是 $\\|f - P_1^w f\\|_{L^2_w} = \\sqrt{\\frac{\\pi^2 - 8}{2\\pi}}$。\n\n**第三部分：截断 Chebyshev 级数的一致误差界**\n\n$f(x)=|x|$ 的 Chebyshev 级数是 $f(x) = \\sum_{k=0}^\\infty a_k T_k(x)$，其中 $a_k = \\frac{\\langle f, T_k \\rangle_w}{\\langle T_k, T_k \\rangle_w}$。\n我们已经求得 $a_0 = c_0 = 2/\\pi$ 和 $a_1 = c_1 = 0$。由于 $f(x)$ 是偶函数，对于所有奇数 $k$，$a_k=0$。\n对于偶数 $k=2m$ 且 $m \\ge 1$：\n$a_{2m} = \\frac{\\langle f, T_{2m} \\rangle_w}{\\langle T_{2m}, T_{2m} \\rangle_w} = \\frac{1}{\\pi/2} \\int_{-1}^1 \\frac{|x|T_{2m}(x)}{\\sqrt{1-x^2}} dx = \\frac{4}{\\pi} \\int_0^1 \\frac{x T_{2m}(x)}{\\sqrt{1-x^2}} dx$。\n令 $x=\\cos\\theta$, $dx=-\\sin\\theta d\\theta$：\n积分为 $\\int_{\\pi/2}^0 \\frac{\\cos\\theta \\cos(2m\\theta)}{ \\sin\\theta} (-\\sin\\theta d\\theta) = \\int_0^{\\pi/2} \\cos\\theta \\cos(2m\\theta) d\\theta$。\n使用恒等式 $2\\cos A \\cos B = \\cos(A-B)+\\cos(A+B)$：\n$\\frac{1}{2} \\int_0^{\\pi/2} [\\cos((2m-1)\\theta) + \\cos((2m+1)\\theta)] d\\theta = \\frac{1}{2} \\left[ \\frac{\\sin((2m-1)\\theta)}{2m-1} + \\frac{\\sin((2m+1)\\theta)}{2m+1} \\right]_0^{\\pi/2}$\n$= \\frac{1}{2} \\left( \\frac{\\sin(m\\pi-\\pi/2)}{2m-1} + \\frac{\\sin(m\\pi+\\pi/2)}{2m+1} \\right) = \\frac{1}{2} \\left( \\frac{(-1)^{m+1}}{2m-1} + \\frac{(-1)^m}{2m+1} \\right) = \\frac{(-1)^{m+1}}{2} \\left( \\frac{1}{2m-1} - \\frac{1}{2m+1} \\right)$\n$= \\frac{(-1)^{m+1}}{2} \\frac{(2m+1)-(2m-1)}{4m^2-1} = \\frac{(-1)^{m+1}}{4m^2-1}$。\n所以，$\\langle f, T_{2m} \\rangle_w = 2 \\int_0^{\\pi/2} \\cos\\theta \\cos(2m\\theta) d\\theta = 2 \\frac{(-1)^{m+1}}{4m^2-1}$。\n$a_{2m} = \\frac{2(-1)^{m+1}/(4m^2-1)}{\\pi/2} = \\frac{4}{\\pi} \\frac{(-1)^{m+1}}{4m^2-1}$ 对于 $m \\ge 1$。\n\n次数为 $N$ 的截断 Chebyshev 级数是 $S_N f = \\sum_{k=0}^N a_k T_k(x)$。一致误差由系数的尾部项所界定：\n$\\|f - S_N f\\|_{\\infty} = \\|\\sum_{k=N+1}^\\infty a_k T_k(x)\\|_{\\infty} \\le \\sum_{k=N+1}^\\infty |a_k|$，因为 $|T_k(x)|\\le 1$。\n求和是对偶数下标 $2m > N$ 进行的，即 $m > N/2$。第一个整数是 $m_{min} = \\lfloor N/2 \\rfloor + 1$。\n界为 $\\sum_{m=\\lfloor N/2 \\rfloor+1}^\\infty |a_{2m}| = \\sum_{m=\\lfloor N/2 \\rfloor+1}^\\infty \\frac{4}{\\pi} \\frac{1}{4m^2-1}$。\n该和式可以利用 $\\frac{1}{4m^2-1} = \\frac{1}{2}(\\frac{1}{2m-1} - \\frac{1}{2m+1})$ 的伸缩级数性质精确计算：\n$\\sum_{m=M}^\\infty \\frac{1}{4m^2-1} = \\frac{1}{2(2M-1)}$。\n代入 $M = \\lfloor N/2 \\rfloor + 1$，界为 $\\frac{4}{\\pi} \\cdot \\frac{1}{2(2(\\lfloor N/2 \\rfloor + 1) - 1)} = \\frac{2}{\\pi(2\\lfloor N/2 \\rfloor + 1)}$。\n这可以对偶数和奇数 $N$ 分别明确写出：\n如果 $N$ 是偶数，$N=2k$，则界为 $\\frac{2}{\\pi(2k+1)} = \\frac{2}{\\pi(N+1)}$。\n如果 $N$ 是奇数，$N=2k-1$，则界为 $\\frac{2}{\\pi(2(k-1)+1)} = \\frac{2}{\\pi(2k-1)} = \\frac{2}{\\pi N}$。\n一致误差的上界是 $\\frac{2}{\\pi(2\\lfloor N/2 \\rfloor + 1)}$。\n\n**第四部分：最终比值**\n\n最后，我们计算比值 $R = \\frac{E_{\\infty}}{\\|f-P_{1}^{w}f\\|_{L^{2}_{w}}}$。\n使用第一部分和第二部分的结果：\n$E_{\\infty} = 1/2$\n$\\|f-P_{1}^{w}f\\|_{L^{2}_{w}} = \\sqrt{\\frac{\\pi^2 - 8}{2\\pi}}$\n比值为：\n$$R = \\frac{1/2}{\\sqrt{\\frac{\\pi^2 - 8}{2\\pi}}} = \\frac{1}{2} \\sqrt{\\frac{2\\pi}{\\pi^2-8}} = \\sqrt{\\frac{1}{4} \\frac{2\\pi}{\\pi^2-8}} = \\sqrt{\\frac{\\pi}{2(\\pi^2-8)}}$$", "answer": "$$ \\boxed{\\sqrt{\\frac{\\pi}{2(\\pi^{2}-8)}}} $$", "id": "3428460"}, {"introduction": "在实际数值方法中，我们如何将逼近理论转化为具体的误差控制策略？这个练习将理论与间断 Galerkin (DG) 方法的实践联系起来，展示了如何通过网格加密来达到对非光滑函数的预设逼近精度。你将确定网格尺寸 $h$、多项式次数 $p$ 与一致误差 $\\epsilon$ 之间的关系 [@problem_id:3428493]，这清晰地揭示了 $h$-refinement 在处理函数奇异性时的强大能力。", "problem": "令 $f(x) = |x|$ 定义在紧区间 $[-1,1]$ 上。考虑在间断 Galerkin (DG) 方法中使用的分片多项式空间，\n$$\nV_{h}^{p} := \\left\\{ v \\in L^{\\infty}([-1,1]) \\,\\Big|\\, v|_{K} \\in \\mathbb{P}_{p}(K) \\text{ 对于 } [-1,1] \\text{ 的一个单元大小为 } h \\text{ 的均匀剖分中的每个网格单元 } K \\text{ 成立} \\right\\},\n$$\n其中 $\\mathbb{P}_{p}(K)$ 表示在 $K$ 上次数至多为 $p$ 的多项式，而 $h$ 是均匀剖分中每个单元的长度。利用紧集上连续性的基本性质以及 Weierstrass 逼近定理背后的思想，通过适当地选择网格尺寸 $h$ 和局部多项式次数 $p$，构造一个显式的 $v_{h}^{p} \\in V_{h}^{p}$，使其达到一个预定的均匀逼近误差 $\\epsilon > 0$，\n$$\n\\|f - v_{h}^{p}\\|_{L^{\\infty}([-1,1])} \\le \\epsilon,\n$$\n确定使得这种构造可能的最小整数次数 $p$ 以及在该次数下仍能保证误差界的允许的最大均匀单元尺寸 $h$。将你的最终答案表示为关于 $\\epsilon$ 的数对 $(p,h)$。不需要四舍五入，也不涉及物理单位。以单行矩阵的形式提供该数对作为最终答案。", "solution": "用户希望解决以下问题：\n令 $f(x) = |x|$ 定义在紧区间 $[-1,1]$ 上。考虑在间断 Galerkin (DG) 方法中使用的分片多项式空间，\n$$\nV_{h}^{p} := \\left\\{ v \\in L^{\\infty}([-1,1]) \\,\\Big|\\, v|_{K} \\in \\mathbb{P}_{p}(K) \\text{ 对于 } [-1,1] \\text{ 的一个单元大小为 } h \\text{ 的均匀剖分中的每个网格单元 } K \\text{ 成立} \\right\\},\n$$\n其中 $\\mathbb{P}_{p}(K)$ 表示在 $K$ 上次数至多为 $p$ 的多项式，而 $h$ 是均匀剖分中每个单元的长度。利用紧集上连续性的基本性质以及 Weierstrass 逼近定理背后的思想，通过适当地选择网格尺寸 $h$ 和局部多项式次数 $p$，构造一个显式的 $v_{h}^{p} \\in V_{h}^{p}$，使其达到一个预定的均匀逼近误差 $\\epsilon > 0$，\n$$\n\\|f - v_{h}^{p}\\|_{L^{\\infty}([-1,1])} \\le \\epsilon,\n$$\n确定使得这种构造可能的最小整数次数 $p$ 以及在该次数下仍能保证误差界的允许的最大均匀单元尺寸 $h$。将你的最终答案表示为关于 $\\epsilon$ 的数对 $(p,h)$。不需要四舍五入，也不涉及物理单位。以单行矩阵的形式提供该数对作为最终答案。\n\n### 问题验证\n\n1.  **提取已知条件**：\n    -   函数：$f(x) = |x|$ 在区间 $[-1, 1]$ 上。\n    -   逼近空间：$V_{h}^{p}$，由在 $[-1, 1]$ 上单元尺寸为 $h$ 的均匀剖分上的次数至多为 $p$ 的分片多项式组成。\n    -   误差度量：$L^{\\infty}([-1,1])$ 范数，定义为 $\\|g\\|_{L^{\\infty}(I)} = \\sup_{x \\in I} |g(x)|$。\n    -   误差容限：$\\epsilon > 0$。\n    -   目标：构造一个逼近函数 $v_h^p \\in V_h^p$ 使得 $\\|f - v_h^p\\|_{L^{\\infty}([-1,1])} \\le \\epsilon$。\n    -   要求输出：数对 $(p, h)$，其中 $p$ 是使之可能的最小整数次数，$h$ 是在该最小 $p$ 下保证误差界的最大单元尺寸。\n\n2.  **使用提取的已知条件进行验证**：\n    -   **科学基础**：该问题在数值分析和逼近理论领域是公认的。函数 $f(x)=|x|$ 是研究非光滑函数逼近的典型例子。间断 Galerkin 空间 $V_h^p$ 是一种标准构造。对 Weierstrass 逼近定理的引用指向了使用连续性和局部逼近的基本概念。所有概念在数学上都是合理的。\n    -   **适定性和客观性**：该问题以清晰、客观的数学定义陈述。找到“最小”次数 $p$ 和“最大”尺寸 $h$ 的要求定义了一个特定的优化问题，该问题应导致唯一的答案。\n\n3.  **结论**：\n    -   该问题有效。\n\n### 解答\n\n目标是找到最小整数次数 $p$ 和相应的最大网格尺寸 $h$，以确保函数 $f(x)=|x|$ 可以被 $V_h^p$ 中的函数 $v_h^p$ 逼近，且在 $L^{\\infty}$ 范数下的误差不大于 $\\epsilon$。\n\n空间 $V_h^p$ 由在 $[-1,1]$ 均匀剖分的每个单元 $K$ 上为次数至多为 $p$ 的多项式的函数组成。区间的总长度为 2。一个大小为 $h$ 的单元的均匀剖分意味着有 $N=2/h$ 个这样的单元。全局逼近误差是所有单元上局部逼近误差的最大值：\n$$\n\\|f - v_{h}^{p}\\|_{L^{\\infty}([-1,1])} = \\max_{K} \\|f - v_{h}^{p}\\|_{L^{\\infty}(K)}.\n$$\n为了构造最优的 $v_h^p$，我们应该在每个单元 $K$ 上选择多项式为 $f(x)$ 在 $\\mathbb{P}_p(K)$ 中的最佳 $L^{\\infty}$ 逼近。那么，单元 $K$ 上的误差由 $E_{p,K}(f) = \\inf_{q \\in \\mathbb{P}_p(K)} \\|f - q\\|_{L^{\\infty}(K)}$ 给出。\n\n$f(x)=|x|$ 的关键特征是它在 $x=0$ 处的不可微性。在远离原点处，$f(x)$ 是 $x$ 或 $-x$，两者都是 1 次多项式。\n\n我们需要找到使适当构造成为可能的最小整数次数 $p$。我们从测试最低可能的非负整数次数 $p=0$ 开始。\n\n**情况：$p=0$（分片常数逼近）**\n\n对于 $p=0$，空间 $V_h^0$ 由分片常数函数组成。在每个单元 $K$ 上，我们用一个常数 $c_K$ 来逼近 $f(x)$。在 $L^{\\infty}$ 范数下，区间 $K$ 上的函数 $g$ 的最佳常数逼近 $c_K$ 由 $c_K = \\frac{1}{2}(\\sup_{x \\in K} g(x) + \\inf_{x \\in K} g(x))$ 给出。该单元上产生的最小误差是 $E_{0,K}(g) = \\frac{1}{2}(\\sup_{x \\in K} g(x) - \\inf_{x \\in K} g(x))$。\n\n让我们分析 $f(x)=|x|$ 的误差：\n1.  **单元 $K$ 不包含原点 $x=0$**：\n    令 $K = [a, a+h]$ 且 $a>0$。在此单元上，$f(x)=x$。该函数是单调的。\n    误差为 $E_{0,K}(f) = \\frac{1}{2}(f(a+h) - f(a)) = \\frac{1}{2}((a+h) - a) = \\frac{h}{2}$。\n    类似地，对于单元 $K = [-b-h, -b]$ 且 $b>0$，$f(x)=-x$。该函数在 $K$ 上也是单调的。\n    误差为 $E_{0,K}(f) = \\frac{1}{2}(f(-b) - f(-b-h)) = \\frac{1}{2}(b - (b+h)) = \\frac{h}{2}$（误差是一个绝对值）。所以误差是 $|-h/2| = h/2$。\n    对于任何不包含原点的单元，逼近误差恰好是 $h/2$。\n\n2.  **单元 $K$ 包含原点 $x=0$**：\n    $[-1,1]$ 的均匀剖分可以将原点置于两个单元之间的边界点（如果单元数 $N$ 是偶数），或置于一个单元的内部（如果 $N$ 是奇数）。我们必须考虑最坏情况。a) 如果 $K = [0, h]$ 或 $K=[-h, 0]$，分析与情况 1 相同，误差为 $h/2$。b) 如果 $K=[-h/2, h/2]$，函数 $f(x)=|x|$ 不是单调的。在此区间上，$\\inf_{x \\in K} f(x) = f(0) = 0$ 且 $\\sup_{x \\in K} f(x) = f(h/2) = f(-h/2) = h/2$。\n    误差为 $E_{0,K}(f) = \\frac{1}{2}(\\frac{h}{2} - 0) = \\frac{h}{4}$。\n\n因此，所有可能单元上的最大误差是 $\\max(h/2, h/4) = h/2$。\n所以，对于 $p=0$，我们可以构造 $v_h^0$ 使得 $\\|f - v_h^0\\|_{L^{\\infty}([-1,1])} = h/2$。\n要满足条件 $\\|f - v_h^0\\|_{L^{\\infty}([-1,1])} \\le \\epsilon$，我们必须有：\n$$\n\\frac{h}{2} \\le \\epsilon \\implies h \\le 2\\epsilon.\n$$\n这表明对于 $p=0$，只要我们选择 $h \\le 2\\epsilon$，构造就是可能的。由于 $p$ 必须是非负整数，所以 $p=0$ 是可能的最小次数。\n\n问题要求的是这个最小次数下允许的最大均匀单元尺寸 $h$。从不等式 $h \\le 2\\epsilon$ 可知，$h$ 的最大值为 $2\\epsilon$。\n\n这与关于连续性的提示是一致的。函数 $f(x)=|x|$ 是均匀连续的。实际上，它是 Lipschitz 连续的，Lipschitz 常数为 1，即 $||x| - |y|| \\le |x-y|$。在任何长度为 $h$ 的区间上，函数的值域最多为 $h$。对于分片常数逼近，误差受函数值域的限制，而我们更精确的计算得出的误差为 $h/2$。\n\n因此，最小整数次数为 $p=0$，允许的最大单元尺寸为 $h=2\\epsilon$。所要求的数对是 $(p, h) = (0, 2\\epsilon)$。\n\n为了完整性，我们考虑 $p=1$ 的情况。在任何不包含原点的单元 $K$ 上，$f(x)$ 是线性的，因此我们可以设置 $v_h^1|_K = f|_K$，误差为 $0$。在一个包含原点的单元上，比如 $K_0=[-h/2, h/2]$，我们需要找到 $|x|$ 的最佳线性逼近。在对称区间上，偶函数的最佳 $L^\\infty$ 逼近是偶函数，因此最佳线性逼近是一个常数。这在 $K_0$ 上退化为 $p=0$ 的情况，误差为 $h/4$。因此，对于 $p=1$，总误差为 $h/4$。条件 $h/4 \\le \\epsilon$ 意味着 $h \\le 4\\epsilon$。虽然这允许更大的 $h$，但问题要求的是与*最小*次数 $p$ 相关联的结果，即 $p=0$。", "answer": "$$ \\boxed{ \\begin{pmatrix} 0  & 2\\epsilon \\end{pmatrix} } $$", "id": "3428493"}, {"introduction": "虽然多项式能很好地逼近函数本身，但逼近其导数却可能充满陷阱，这是高阶方法必须面对的核心挑战。这个问题揭示了高阶方法中的一个关键不稳定性来源，即当在 DG 方法中计算扩散通量时，解的微小误差是如何被显著放大的。通过推导一个严格的误差上界 [@problem_id:3428487]，你将发现这种误差放大效应如何依赖于多项式次数 $N$ 和网格尺寸 $h$，从而理解高阶逼近中潜在的数值风险。", "problem": "考虑一个标量扩散模型（扩散系数 $\\kappa>0$）的间断 Galerkin 离散化中的单个物理单元 $I=[x_{L},x_{R}]$，其长度为 $h=x_{R}-x_{L}$。令 $\\xi\\in[-1,1]$ 表示参考坐标，参考坐标与物理坐标之间的仿射映射为 $x(\\xi)=x_{c}+\\frac{h}{2}\\,\\xi$，其中 $x_{c}=\\frac{x_{L}+x_{R}}{2}$ 是单元中心。\n\n令 $u\\in C([-1,1])$ 为在参考坐标下表示的精确解。根据 Weierstrass 逼近定理，对于每个整数 $N\\ge 1$，存在一个多项式 $p_{N}\\in\\mathbb{P}_{N}([-1,1])$ 在 $[-1,1]$ 上一致逼近 $u$。在一个基于多项式的间断 Galerkin 方法中，右端面（对应于 $\\xi=1$）的扩散数值通量使用多项式导数的迹；具体来说，基于多项式 $q_{N}\\in\\mathbb{P}_{N}([-1,1])$ 定义端面相容的扩散通量为\n$$\nF[q_{N}]=-\\kappa\\,\\partial_{x}q_{N}\\big|_{x=x_{R}}.\n$$\n假设由于模态混叠、欠积分或舍入效应，计算出的多项式为 $q_{N}=p_{N}+e_{N}$，其中 $e_{N}\\in\\mathbb{P}_{N}([-1,1])$ 满足一致扰动界 $\\|e_{N}\\|_{L^{\\infty}([-1,1])}\\le \\delta$，对于某个 $\\delta>0$。仅由 $e_{N}$ 引起的右端面扩散数值通量的误差为\n$$\n\\Delta F = F[p_{N}+e_{N}]-F[p_{N}]=-\\kappa\\,\\partial_{x}e_{N}\\big|_{x=x_{R}}.\n$$\n\n仅从经过充分检验的事实出发，包括 Weierstrass 逼近定理和 $[-1,1]$ 上多项式的经典反向不等式，并利用 $I$ 上 $\\partial_{x}$ 和 $\\partial_{\\xi}$ 之间的映射关系，确定最小常数 $C(N,h,\\kappa)$，使得端面通量误差满足\n$$\n|\\Delta F|\\le C(N,h,\\kappa)\\,\\delta\n$$\n对所有满足 $\\|e_{N}\\|_{L^{\\infty}([-1,1])}\\le\\delta$ 的扰动 $e_{N}\\in\\mathbb{P}_{N}([-1,1])$ 成立。你的最终答案必须是 $C(N,h,\\kappa)$ 关于 $N$、$h$ 和 $\\kappa$ 的单个闭式解析表达式。", "solution": "该问题要求找到最小常数 $C(N,h,\\kappa)$，该常数在给定多项式逼近的扰动 $e_N$ 的情况下，界定扩散数值通量中的误差 $|\\Delta F|$。该界的形式为 $|\\Delta F| \\le C(N,h,\\kappa)\\delta$，其中 $\\delta$ 是扰动多项式 $e_N$ 的 $L^{\\infty}$ 范数的上界。\n\n首先，我们用给定的量来表示通量误差 $|\\Delta F|$。通量误差的定义是：\n$$\n\\Delta F = -\\kappa\\,\\partial_{x}e_{N}\\big|_{x=x_{R}}\n$$\n因此，该误差的大小为 $|\\Delta F| = \\kappa |\\partial_{x}e_{N}\\big|_{x=x_{R}}|$，因为扩散系数 $\\kappa$ 是正的。\n\n多项式 $e_N$ 被给定为 $\\mathbb{P}_{N}([-1,1])$ 的一个元素，这是参考区间 $[-1,1]$ 上次数至多为 $N$ 的多项式空间。这意味着 $e_N$ 是参考坐标 $\\xi$ 的函数。在通量的表达式中，导数是关于物理坐标 $x$ 的。这意味着 $e_N$ 在物理域 $I=[x_L, x_R]$ 上被视为一个复合函数，即 $e_N(x) = e_N(\\xi(x))$，其中 $\\xi(x)$ 是从物理坐标到参考坐标的反向映射。\n\n给定了从参考坐标 $\\xi$ 到物理坐标 $x$ 的仿射映射：\n$$\nx(\\xi) = x_{c} + \\frac{h}{2}\\xi\n$$\n其中 $x_c = \\frac{x_L+x_R}{2}$ 是单元中心，$h=x_R-x_L$ 是单元长度。\n\n为了找到导数 $\\partial_x$ 和 $\\partial_\\xi$ 之间的关系，我们使用链式法则：\n$$\n\\frac{d}{dx} = \\frac{d\\xi}{dx} \\frac{d}{d\\xi}\n$$\n从映射 $x(\\xi)$，我们可以得到 $\\frac{dx}{d\\xi} = \\frac{h}{2}$。因此，其逆关系为 $\\frac{d\\xi}{dx} = \\frac{2}{h}$。导数算子之间的关系是：\n$$\n\\partial_x = \\frac{2}{h}\\partial_\\xi\n$$\n将此应用于多项式 $e_N$，我们得到 $\\partial_x e_N(\\xi(x)) = \\frac{2}{h}\\frac{d e_N}{d\\xi}(\\xi)$。\n\n通量误差在单元的右端面 $x=x_R$ 处求值。我们需要找到参考单元上对应的坐标 $\\xi$。使用反向映射 $\\xi(x) = \\frac{2}{h}(x-x_c)$：\n$$\n\\xi(x_R) = \\frac{2}{h}\\left(x_R - \\frac{x_L+x_R}{2}\\right) = \\frac{2}{h}\\left(\\frac{2x_R-x_L-x_R}{2}\\right) = \\frac{2}{h}\\left(\\frac{x_R-x_L}{2}\\right) = \\frac{2}{h}\\left(\\frac{h}{2}\\right) = 1\n$$\n所以，右端面 $x=x_R$ 对应于 $\\xi=1$。\n\n现在，我们可以完全用参考单元上的量来表示通量误差的大小：\n$$\n|\\Delta F| = \\kappa \\left|\\left(\\frac{2}{h}\\frac{d e_N}{d\\xi}\\right)\\Big|_{\\xi=1}\\right| = \\frac{2\\kappa}{h} \\left|\\frac{d e_N}{d\\xi}(1)\\right|\n$$\n问题陈述了扰动多项式 $e_N \\in \\mathbb{P}_N([-1,1])$ 满足一致界 $\\|e_N\\|_{L^{\\infty}([-1,1])} \\le \\delta$。我们需要找到最小的常数 $C(N,h,\\kappa)$，使得：\n$$\n|\\Delta F| \\le C(N,h,\\kappa)\\delta\n$$\n代入我们关于 $|\\Delta F|$ 的表达式：\n$$\n\\frac{2\\kappa}{h} \\left|\\frac{d e_N}{d\\xi}(1)\\right| \\le C(N,h,\\kappa)\\delta\n$$\n这个不等式必须对所有满足 $\\|e_N\\|_{L^{\\infty}([-1,1])} \\le \\delta$ 的 $e_N \\in \\mathbb{P}_N([-1,1])$ 都成立。为了找到最小的此类常数 $C(N,h,\\kappa)$，我们必须考虑最坏情况。这对应于在所有容许多项式 $e_N$ 上找到左侧的上确界。\n$$\nC(N,h,\\kappa) = \\sup_{\\substack{e_N \\in \\mathbb{P}_N \\\\ 0  \\|e_N\\|_\\infty \\le \\delta}} \\frac{1}{\\delta} \\left(\\frac{2\\kappa}{h} \\left|e_N'(1)\\right|\\right) = \\frac{2\\kappa}{h} \\sup_{\\substack{e_N \\in \\mathbb{P}_N \\\\ 0  \\|e_N\\|_\\infty \\le \\delta}} \\frac{\\left|e_N'(1)\\right|}{\\delta}\n$$\n因为对于任何这样的 $e_N$，多项式 $\\tilde{e}_N = e_N / \\|e_N\\|_\\infty$ 具有单位范数，并且 $|e_N'(1)|/\\|e_N\\|_\\infty = |\\tilde{e}_N'(1)|$，所以上确界与 $\\delta$ 无关。我们可以通过考虑单位范数的多项式来简化：\n$$\nC(N,h,\\kappa) = \\frac{2\\kappa}{h} \\sup_{\\substack{e_N \\in \\mathbb{P}_N \\\\ \\|e_N\\|_\\infty = 1}} \\left|e_N'(1)\\right|\n$$\n问题现在简化为在区间 $[-1,1]$ 上 $L^\\infty$ 范数为 1 的条件下，找到一个 $N$ 次多项式在该区间端点处导数的最大可能值。这是逼近论中的一个经典结果，属于问题陈述中提到的“经典反向不等式”的范畴。\n\n对于任何多项式 $p \\in \\mathbb{P}_N([-1,1])$，以下锐不等式（称为端点处的 Markov 兄弟不等式，或端点处的 Bernstein 不等式）成立：\n$$\n|p'(\\xi)| \\le N^2 \\|p\\|_{L^\\infty([-1,1])} \\quad \\text{for } \\xi = \\pm 1\n$$\n这个界是锐的，意味着存在一个多项式使得等号成立。极值多项式是第一类 Chebyshev 多项式，$T_N(\\xi) = \\cos(N\\arccos \\xi)$。对于这个多项式，$\\|T_N\\|_{L^\\infty([-1,1])}=1$，其在端点处的导数为 $|T_N'(\\pm 1)| = N^2$。\n\n因此，我们寻求的上确界是：\n$$\n\\sup_{\\substack{e_N \\in \\mathbb{P}_N \\\\ \\|e_N\\|_\\infty = 1}} \\left|e_N'(1)\\right| = N^2\n$$\n将此值代回我们关于 $C(N,h,\\kappa)$ 的表达式中：\n$$\nC(N,h,\\kappa) = \\frac{2\\kappa}{h} \\cdot N^2 = \\frac{2\\kappa N^2}{h}\n$$\n这是使不等式对所有指定的扰动都成立的最小常数，因为它是由一个锐不等式导出的。", "answer": "$$\n\\boxed{\\frac{2\\kappa N^{2}}{h}}\n$$", "id": "3428487"}]}