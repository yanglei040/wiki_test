{"hands_on_practices": [{"introduction": "这个练习是冯·诺伊曼稳定性分析的基础。我们从最简单的情况入手：使用0次多项式（$p=0$）的间断伽辽金（DG）方法。通过这个练习，你会发现，对于这个最简单的设置，复杂的DG框架出人意料地简化为了经典的一阶迎风有限差分格式。这有助于建立直观的理解，并揭示DG方法与传统方法之间的深刻联系，为分析更高阶的格式奠定坚实的基础[@problem_id:3426865]。", "problem": "考虑线性平流方程 $u_{t} + a\\,u_{x} = 0$，其中平流速度 $a  0$ 为常数，定义在一个划分为大小为 $h$ 的均匀单元网格的周期性一维域上。使用多项式次数为 $p=0$（分片常数）的间断伽辽金 (DG) 方法和针对 $a0$ 的迎风数值通量来离散该方程，并将得到的半离散系统写成 $M\\,\\dot{U} = K\\,U$ 的形式，其中 $M$ 是单元质量矩阵，$K$ 是由数值通量诱导的刚度算子。\n\n要求您分析两种常见的修正如何影响半离散算子、其傅里叶符号以及允许的平流显式时间步长：\n- 对角预处理：定义对称预处理算子 $B := M^{-1/2} K M^{-1/2}$。\n- 质量集中：用对角近似 $L$ 替换 $M$，并使用 $L^{-1}K$ 进行演化。\n\n通过考虑形式为 $U_{j}(t) = \\widehat{U}(t)\\,\\exp(i \\kappa j h)$ 的平面波解来进行冯·诺依曼傅里叶分析，其中 $j$ 是单元的索引，$\\kappa$ 是连续波数，$\\theta := \\kappa h \\in [-\\pi, \\pi]$ 是以弧度为单位的无量纲波数。从 DG 弱形式和上述定义出发，推导：\n1. 该 DG 离散下 $M$ 和 $K$ 的显式形式，以及相应的演化算子 $A := M^{-1}K$。\n2. $A$ 的傅里叶符号 $\\lambda(\\theta)$，以及由 $\\lambda(\\theta) = -i\\,a\\,k_{\\mathrm{eff}}(\\theta) + \\text{dissipation}(\\theta)$ 定义的修正波数 $k_{\\mathrm{eff}}(\\theta)$。\n3. $A$ 和 $B$（通过对角预处理得到）的谱之间的关系，以及这对允许的前向欧拉 (FE) 时间步长的影响。\n4. 为保证稳定性，前向欧拉时间步长 $\\Delta t$ 的精确上界，该上界通过要求对所有 $\\theta \\in [-\\pi,\\pi]$，FE 放大因子 $1 + \\Delta t\\,\\lambda(\\theta)$ 保持在 FE 稳定盘内部来获得。\n\n以关于 $h$ 和 $a$ 的单个闭式解析表达式的形式，给出最大允许时间步长 $\\Delta t_{\\max}$ 的最终答案。不需要进行数值代入。清晰地陈述所有中间步骤和假设，并以无单位的形式表示答案。如果出现任何角度量，请明确地将其视为弧度。最终答案必须是单个表达式。", "solution": "该问题要求分析将多项式次数为 $p=0$ 的间断伽辽金 (DG) 方法应用于一维线性平流方程 $u_t + a u_x = 0$ 的情况，其中平流速度 $a$ 是一个正常数。分析内容包括推导半离散算子、进行冯·诺依曼稳定性分析，以及确定前向欧拉法的最大稳定时间步长。\n\n### 步骤 1：半离散系统的推导\n\n在大小均匀 $h = x_{j+1/2} - x_{j-1/2}$ 的网格单元 $I_j = [x_{j-1/2}, x_{j+1/2}]$ 上，DG 弱形式为：从有限维空间 $V_h$ 中找到近似解 $u_h$，使得对于每个测试函数 $v_h \\in V_h$，都有\n$$\n\\int_{I_j} \\frac{\\partial u_h}{\\partial t} v_h \\, dx - \\int_{I_j} a u_h \\frac{\\partial v_h}{\\partial x} \\, dx + \\left[ a u_h^* v_h \\right]_{x_{j-1/2}}^{x_{j+1/2}} = 0\n$$\n其中 $u_h^*$ 是单元交界面上的数值通量。\n\n对于多项式次数为 $p=0$ 的情况，解 $u_h$ 和测试函数 $v_h$ 是分片常数。在单元 $I_j$ 上，我们将解表示为 $u_h(x,t) = U_j(t)$ (当 $x \\in I_j$)。基函数是指示函数 $\\phi_j(x)$，如果 $x \\in I_j$ 则为 1，否则为 0。我们选择测试函数为 $v_h(x) = \\phi_j(x)$。\n\n将这些代入弱形式：\n1.  第一项是 $\\int_{I_j} \\frac{d U_j}{dt} \\cdot 1 \\, dx = \\dot{U}_j \\int_{I_j} dx = h \\dot{U}_j$。\n2.  第二项是 $- \\int_{I_j} a U_j \\frac{\\partial \\phi_j}{\\partial x} \\, dx = 0$，因为在单元 $I_j$ 内部 $\\frac{\\partial \\phi_j}{\\partial x} = 0$。\n3.  第三项表示单元边界处的通量贡献：\n    $$\n    \\left[ a u_h^* v_h \\right]_{x_{j-1/2}}^{x_{j+1/2}} = a u_h^*(x_{j+1/2}, t) v_h(x_{j+1/2}^-) - a u_h^*(x_{j-1/2}, t) v_h(x_{j-1/2}^+)\n    $$\n    由于 $v_h(x_{j+1/2}^-) = \\phi_j(x_{j+1/2}^-) = 1$ 且 $v_h(x_{j-1/2}^+) = \\phi_j(x_{j-1/2}^+) = 1$，此项变为 $a u_h^*(x_{j+1/2}, t) - a u_h^*(x_{j-1/2}, t)$。\n\n问题指定了迎风数值通量。由于 $a  0$，信息从左向右传播。交界面上的迎风通量是来自迎风（左侧）的解的值。\n在交界面 $x_{j+1/2}$ 处，迎风值是 $u_h(x_{j+1/2}^-) = U_j(t)$。\n在交界面 $x_{j-1/2}$ 处，迎风值是 $u_h(x_{j-1/2}^-) = U_{j-1}(t)$。\n因此，数值通量为 $u_h^*(x_{j+1/2}, t) = U_j(t)$ 和 $u_h^*(x_{j-1/2}, t) = U_{j-1}(t)$。\n\n综合这些项，单元 $j$ 的半离散方程为：\n$$\nh \\dot{U}_j + a U_j - a U_{j-1} = 0\n$$\n将其整理为 $M \\dot{U} = K U$ 的形式：\n$$\nh \\dot{U}_j = a U_{j-1} - a U_j\n$$\n左侧对应于质量矩阵算子。质量矩阵 $M$ 的 $(j,k)$ 元是 $M_{jk} = \\int_{\\Omega} \\phi_j \\phi_k \\, dx$。对于 $p=0$，基函数具有不相交的支集，因此当 $j \\neq k$ 时 $M_{jk}=0$。对角元为 $M_{jj} = \\int_{I_j} 1 \\cdot 1 \\, dx = h$。因此，质量矩阵是 $M = hI$，其中 $I$ 是单位矩阵。\n\n右侧对应于刚度算子 $K$。向量 $KU$ 的第 $j$ 行是 $a U_{j-1} - a U_j$。这意味着矩阵 $K$ 的对角元为 $K_{jj} = -a$，次对角元为 $K_{j, j-1} = a$。所有其他元都为零。\n\n演化算子是 $A := M^{-1}K$。由于 $M=hI$，其逆矩阵为 $M^{-1} = \\frac{1}{h}I$。\n$$ A = \\frac{1}{h}K $$\n半离散系统可以写成 $\\dot{U} = A U$，对单元 $j$ 来说即：\n$$ \\dot{U}_j = \\frac{a}{h}(U_{j-1} - U_j) $$\n这与一阶迎风有限差分格式完全相同。\n\n### 步骤 2：傅里叶符号和修正波数\n\n我们通过将平面波解 $U_j(t) = \\widehat{U}(t) \\exp(i\\kappa j h)$ 代入半离散方程来进行冯·诺依曼傅里叶分析，其中 $\\kappa$ 是波数，$\\theta := \\kappa h$ 是无量纲波数。\n$$\n\\frac{d}{dt} \\left( \\widehat{U}(t) e^{i\\kappa j h} \\right) = \\frac{a}{h} \\left( \\widehat{U}(t) e^{i\\kappa (j-1) h} - \\widehat{U}(t) e^{i\\kappa j h} \\right)\n$$\n$$\n\\dot{\\widehat{U}}(t) e^{i\\kappa j h} = \\frac{a}{h} \\widehat{U}(t) e^{i\\kappa j h} \\left( e^{-i\\kappa h} - 1 \\right)\n$$\n两边同除以 $\\widehat{U}(t) e^{i\\kappa j h}$，得到傅里叶振幅的演化方程 $\\dot{\\widehat{U}}(t) = \\lambda(\\theta) \\widehat{U}(t)$。算子 $A$ 的傅里叶符号（特征值）$\\lambda(\\theta)$ 为：\n$$\n\\lambda(\\theta) = \\frac{a}{h} (e^{-i\\theta} - 1)\n$$\n我们使用 $e^{-i\\theta} = \\cos\\theta - i\\sin\\theta$ 将其分为实部和虚部：\n$$\n\\lambda(\\theta) = \\frac{a}{h} (\\cos\\theta - 1 - i\\sin\\theta) = \\frac{a}{h}(\\cos\\theta - 1) - i \\frac{a}{h}\\sin\\theta\n$$\n方程 $u_t+au_x=0$ 的精确解具有纯虚的傅里叶符号 $-ia\\kappa$。数值格式的符号具有代表数值耗散的实部和与数值色散相关的虚部。修正波数 $k_{\\mathrm{eff}}$ 的定义使得 $\\lambda(\\theta)$ 的虚部具有 $-ia k_{\\mathrm{eff}}$ 的形式。\n$$\n-a k_{\\mathrm{eff}}(\\theta) = \\text{Im}[\\lambda(\\theta)] = - \\frac{a}{h} \\sin\\theta\n$$\n解出 $k_{\\mathrm{eff}}$ 可得：\n$$\nk_{\\mathrm{eff}}(\\theta) = \\frac{\\sin\\theta}{h}\n$$\n$\\lambda(\\theta)$ 的实部 $\\text{Re}[\\lambda(\\theta)] = \\frac{a}{h}(\\cos\\theta-1)$ 代表数值耗散。由于 $a0$, $h0$ 且 $\\cos\\theta-1 \\le 0$，实部非正，表明该格式是耗散的。\n\n### 步骤 3：算子修正的分析\n\n问题提到了两种修正：对角预处理和质量集中。\n- **对角预处理**：算子 $B$ 定义为 $B := M^{-1/2} K M^{-1/2}$。对于 $p=0$ 的情况，$M=hI$ 本身就是对角矩阵。所以 $M^{-1/2} = (1/\\sqrt{h})I$。\n$$\nB = \\left( \\frac{1}{\\sqrt{h}}I \\right) K \\left( \\frac{1}{\\sqrt{h}}I \\right) = \\frac{1}{h}K\n$$\n这与原始的演化算子 $A = M^{-1}K = \\frac{1}{h}K$ 相同。因此，对于 $p=0$，$A=B$。一般而言，$A=M^{-1}K$ 通过相似变换 $B = M^{1/2} A M^{-1/2}$ 与对称矩阵 $B$ 相关联，这意味着 $A$ 和 $B$ 具有相同的谱（特征值）。在我们的情况下，由于算子完全相同，这一点是显然成立的。这对前向欧拉时间步长的影响是，稳定性限制（取决于演化算子的谱）对 $A$ 和 $B$ 都是相同的。\n\n- **质量集中**：这涉及用对角近似 $L$ 替换一致质量矩阵 $M$。对于 $p=0$ 的 DG 方法，一致质量矩阵 $M=hI$ 本身就是对角的。因此，任何标准的质量集中程序（例如，行和集中）都会得到 $L=M$。“质量集中”后的算子 $L^{-1}K$ 与 $M^{-1}K=A$ 相同。\n\n总之，对于 $p=0$ 的特定情况，这两种提议的修正都不会改变半离散演化算子 $A$。\n\n### 步骤 4：前向欧拉时间步长限制\n\n对 $\\dot{U} = AU$ 的前向欧拉时间步进格式为 $U^{n+1} = U^n + \\Delta t A U^n$。一个波数为 $\\kappa$ 的模式被放大因子 $G(\\theta) = 1 + \\Delta t \\lambda(\\theta)$ 放大。为保证稳定性，对于任何模式，该放大因子的模都不能超过 1，即对所有 $\\theta \\in [-\\pi, \\pi]$ 都有 $|G(\\theta)| \\le 1$。\n$$\n|1 + \\Delta t \\lambda(\\theta)| \\le 1\n$$\n代入 $\\lambda(\\theta) = \\frac{a}{h}(e^{-i\\theta} - 1)$：\n$$\n\\left|1 + \\frac{a \\Delta t}{h}(e^{-i\\theta} - 1)\\right| \\le 1\n$$\n令 $C = \\frac{a \\Delta t}{h}$ 为库朗数。不等式变为：\n$$\n|1 + C(e^{-i\\theta} - 1)| \\le 1\n$$\n让我们从几何上分析这一点。复数 $z = \\Delta t \\lambda(\\theta) = C(e^{-i\\theta}-1)$ 必须位于前向欧拉稳定域内，该稳定域是复平面上以 -1 为中心、半径为 1 的圆盘。当 $\\theta$ 变化时，$e^{-i\\theta}$ 描绘出单位圆。项 $e^{-i\\theta}-1$ 描绘出以 -1 为中心、半径为 1 的圆。项 $C(e^{-i\\theta}-1)$ 描绘出以 $-C$ 为中心、半径为 $C$ 的圆。为了使这个特征值圆（域 L）被包含在稳定盘（域 S）内，它的最左点必须在 S 的最左点之内。L 的最左点位于 $-2C$。S 的最左点位于 $-2$。条件是 $-2C \\ge -2$，简化为 $C \\le 1$。\n\n或者，我们可以用代数方法进行：\n$$\n| (1 - C + C\\cos\\theta) - i(C\\sin\\theta) |^2 \\le 1\n$$\n$$\n(1 - C + C\\cos\\theta)^2 + (C\\sin\\theta)^2 \\le 1\n$$\n$$\n(1-C)^2 + 2C(1-C)\\cos\\theta + C^2\\cos^2\\theta + C^2\\sin^2\\theta \\le 1\n$$\n$$\n1 - 2C + C^2 + 2C(1-C)\\cos\\theta + C^2 \\le 1\n$$\n$$\n-2C + 2C^2 + 2C(1-C)\\cos\\theta \\le 0\n$$\n由于 $C  0$，我们可以除以 $2C$：\n$$\n-1 + C + (1-C)\\cos\\theta \\le 0\n$$\n$$\n(C-1) - (C-1)\\cos\\theta \\le 0\n$$\n$$\n(C-1)(1-\\cos\\theta) \\le 0\n$$\n由于对于所有实数 $\\theta$，$1-\\cos\\theta \\ge 0$，并且我们要求该不等式对所有 $\\theta$ 都成立，我们必须确保另一个因子是非正的。\n$$ C-1 \\le 0 \\implies C \\le 1 $$\n库朗数必须小于或等于 1。\n$$\n\\frac{a \\Delta t}{h} \\le 1\n$$\n这给出了为保证稳定性所允许的最大时间步长：\n$$\n\\Delta t_{\\max} = \\frac{h}{a}\n$$", "answer": "$$\\boxed{\\frac{h}{a}}$$", "id": "3426865"}, {"introduction": "在掌握了$p=0$的情况后，我们自然地进入下一个层次的复杂性：使用1次多项式（$p=1$）的DG方法。在这个练习中，DG方法的真正特性开始显现，每个单元内的多个自由度导致了一个矩阵值的符号（或称“块符号”）。你将推导出这个$2 \\times 2$符号的特征值，并首次遇到物理模式和非物理（伪）模式的概念，这是理解高阶方法色散和耗散特性的关键一步[@problem_id:3426843]。", "problem": "考虑一维线性平流方程 $u_t + a u_x = 0$，该方程定义在一个周期性区域上，使用单元尺寸为 $h$ 的均匀网格，其中 $a0$ 是一个恒定的平流速度。在每个单元上使用多项式次数为 $p=1$ 的间断伽辽金 (DG) 方法，采用参考单元映射 $x = x_j + \\frac{h}{2}\\,\\xi$ (其中 $\\xi \\in [-1,1]$) 以及局部基 $\\{\\phi_0(\\xi), \\phi_1(\\xi)\\} = \\{1, \\xi\\}$。采用与 $a0$ 相应的迎风数值通量，因此在 $x_{j+1/2}$ 处的数值界面值取自左侧单元的迹。\n\n从弱形式出发，并使用冯·诺依曼 (Fourier) 分析，利用无量纲波数 $\\theta = k h$（$\\theta$ 以弧度为单位），推导此 $p=1$ 格式的半离散 DG 块符号，并获得其作为 $\\theta$ 函数的特征值。将最终答案表示为半离散算子的一对特征值 $\\lambda_{\\pm}(\\theta)$，以 $a$、$h$ 和 $\\theta$ 的封闭形式写出。最终答案中不应出现中间结果或证明。无需四舍五入，最终表达式中不应包含物理单位。", "solution": "用户希望求出应用于一维线性平流方程的间断伽辽金 (DG) 方法的半离散算子的特征值。\n\n### 第 1 步：问题陈述的验证\n\n问题陈述提供了以下信息：\n- **偏微分方程 (PDE)**：一维线性平流方程 $u_t + a u_x = 0$，其中平流速度 $a0$ 为常数。\n- **区域与网格**：一个周期性区域，使用单元尺寸为 $h$ 的均匀网格。\n- **数值方法**：间断伽辽金 (DG) 方法。\n- **多项式次数**：$p=1$。\n- **参考单元**：从参考单元 $\\xi \\in [-1,1]$ 到物理单元 $K_j$ 的映射为 $x = x_j + \\frac{h}{2}\\,\\xi$。单元中心为 $x_j$，边界为 $x_{j \\pm 1/2} = x_j \\pm h/2$。\n- **局部基**：参考单元上的基函数为 $\\{\\phi_0(\\xi), \\phi_1(\\xi)\\} = \\{1, \\xi\\}$。\n- **数值通量**：针对 $a0$ 的迎风通量。界面上的值取自左侧单元的迹。\n- **分析方法**：使用无量纲波数 $\\theta = k h$ 的冯·诺依曼 (Fourier) 分析。\n\n该问题具有科学依据，是偏微分方程数值分析中的一个标准课题。问题定义明确，目标清晰，并提供了足够的信息来推导出唯一的特征值解。其术语和设置在谱方法和间断伽辽金方法领域是标准的。问题是客观的，没有歧义。因此，该问题被认为是有效的。\n\n### 第 2 步：半离散 DG 公式的推导\n\nDG 方法从每个单元 $K_j = [x_j - h/2, x_j + h/2]$ 上的偏微分方程的弱形式出发。我们将偏微分方程乘以一个与解 $u_h$ 属于相同多项式空间的测试函数 $v_h$，然后在 $K_j$ 上积分。\n$$ \\int_{K_j} (u_t + a u_x) v_h \\, dx = 0 $$\n对空间项进行分部积分得到：\n$$ \\int_{K_j} u_t v_h \\, dx + \\left[ a u_h v_h \\right]_{x_{j-1/2}}^{x_{j+1/2}} - \\int_{K_j} a u_h (v_h)_x \\, dx = 0 $$\n离散解 $u_h$ 在单元边界上是不连续的。我们用数值通量 $\\hat{u}$ 来代替边界上的 $u_h$。弱形式变为：\n$$ \\int_{K_j} (u_h)_t v_h \\, dx + a \\hat{u}_{j+1/2} v_h(x_{j+1/2}^-) - a \\hat{u}_{j-1/2} v_h(x_{j-1/2}^+) - \\int_{K_j} a u_h (v_h)_x \\, dx = 0 $$\n问题指定了 $a0$ 时的迎风通量。界面上的值取自迎风（左侧）一侧。\n- 在界面 $x_{j+1/2}$ 处，迎风单元是 $K_j$。因此，$\\hat{u}_{j+1/2} = u_h(x_{j+1/2}^-)$，这是单元 $K_j$ 内解在其右边界的迹。\n- 在界面 $x_{j-1/2}$ 处，迎风单元是 $K_{j-1}$。因此，$\\hat{u}_{j-1/2} = u_h(x_{j-1/2}^-)$，这是单元 $K_{j-1}$ 内解在其右边界的迹。\n\n令 $u_j(x)$ 为单元 $K_j$ 中解的局部多项式表示。单元 $K_j$ 的弱形式为：\n$$ \\int_{K_j} \\frac{\\partial u_j}{\\partial t} v_j \\, dx - \\int_{K_j} a u_j \\frac{\\partial v_j}{\\partial x} \\, dx + a u_j(x_{j+1/2}) v_j(x_{j+1/2}) - a u_{j-1}(x_{j-1/2}) v_j(x_{j-1/2}) = 0 $$\n我们使用映射 $x(\\xi) = x_j + \\frac{h}{2}\\xi$ 将此方程变换到参考单元 $\\xi \\in [-1,1]$ 上。这表示 $dx = \\frac{h}{2}d\\xi$ 且 $\\frac{\\partial}{\\partial x} = \\frac{2}{h}\\frac{\\partial}{\\partial \\xi}$。局部解为 $u_j(\\xi) = u_{j,0}\\phi_0(\\xi) + u_{j,1}\\phi_1(\\xi) = u_{j,0} + u_{j,1}\\xi$。测试函数 $v_j$ 是基函数 $\\phi_0$ 和 $\\phi_1$。\n界面 $x_{j+1/2}$ 对应于单元 $K_j$ 中的 $\\xi=1$。界面 $x_{j-1/2}$ 对应于单元 $K_j$ 中的 $\\xi=-1$，以及单元 $K_{j-1}$ 中的 $\\xi=1$。\n参考单元上的弱形式为：\n$$ \\frac{h}{2} \\int_{-1}^1 \\frac{\\partial u_j}{\\partial t} v_j \\, d\\xi - a \\int_{-1}^1 u_j \\frac{\\partial v_j}{\\partial \\xi} \\, d\\xi + a u_j(\\xi=1) v_j(\\xi=1) - a u_{j-1}(\\xi=1) v_j(\\xi=-1) = 0 $$\n令 $\\mathbf{u}_j(t) = \\begin{pmatrix} u_{j,0}(t) \\\\ u_{j,1}(t) \\end{pmatrix}$。我们用 $v_j = \\phi_0=1$ 和 $v_j = \\phi_1=\\xi$ 进行测试。\n\n对于 $v_j=\\phi_0=1$：\n第一项是 $\\frac{h}{2} \\int_{-1}^1 (\\dot{u}_{j,0} + \\dot{u}_{j,1}\\xi) \\cdot 1 \\, d\\xi = \\frac{h}{2} (2\\dot{u}_{j,0}) = h\\dot{u}_{j,0}$。\n第二项是 $-a \\int_{-1}^1 (u_{j,0}+u_{j,1}\\xi) \\cdot 0 \\, d\\xi = 0$。\n边界项是 $a u_j(1)\\phi_0(1) - a u_{j-1}(1)\\phi_0(-1) = a (u_{j,0}+u_{j,1}) - a (u_{j-1,0}+u_{j-1,1})$。\n关于 $\\dot{u}_{j,0}$ 的方程：\n$$ h\\dot{u}_{j,0} + a(u_{j,0}+u_{j,1}) - a(u_{j-1,0}+u_{j-1,1}) = 0 $$\n$$ \\dot{u}_{j,0} = -\\frac{a}{h}(u_{j,0}+u_{j,1}) + \\frac{a}{h}(u_{j-1,0}+u_{j-1,1}) $$\n\n对于 $v_j=\\phi_1=\\xi$：\n第一项是 $\\frac{h}{2} \\int_{-1}^1 (\\dot{u}_{j,0} + \\dot{u}_{j,1}\\xi)\\xi \\, d\\xi = \\frac{h}{2} (\\frac{2}{3}\\dot{u}_{j,1}) = \\frac{h}{3}\\dot{u}_{j,1}$。\n第二项是 $-a \\int_{-1}^1 (u_{j,0}+u_{j,1}\\xi) \\cdot 1 \\, d\\xi = -a (2u_{j,0})$。\n边界项是 $a u_j(1)\\phi_1(1) - a u_{j-1}(1)\\phi_1(-1) = a (u_{j,0}+u_{j,1})(1) - a (u_{j-1,0}+u_{j-1,1})(-1) = a(u_{j,0}+u_{j,1}) + a(u_{j-1,0}+u_{j-1,1})$。\n关于 $\\dot{u}_{j,1}$ 的方程：\n$$ \\frac{h}{3}\\dot{u}_{j,1} - 2au_{j,0} + a(u_{j,0}+u_{j,1}) + a(u_{j-1,0}+u_{j-1,1}) = 0 $$\n$$ \\frac{h}{3}\\dot{u}_{j,1} = a(u_{j,0}-u_{j,1}) - a(u_{j-1,0}+u_{j-1,1}) $$\n$$ \\dot{u}_{j,1} = \\frac{3a}{h}(u_{j,0}-u_{j,1}) - \\frac{3a}{h}(u_{j-1,0}+u_{j-1,1}) $$\n半离散系统的矩阵形式为 $\\frac{d\\mathbf{u}_j}{dt} = A_0 \\mathbf{u}_j + A_1 \\mathbf{u}_{j-1}$，其中：\n$$ A_0 = \\frac{a}{h} \\begin{pmatrix} -1  -1 \\\\ 3  -3 \\end{pmatrix}, \\quad A_1 = \\frac{a}{h} \\begin{pmatrix} 1  1 \\\\ -3  -3 \\end{pmatrix} $$\n\n### 第 3 步：冯·诺依曼分析与特征值计算\n\n对于冯·诺依曼分析，我们寻找形式为 $\\mathbf{u}_j(t) = \\hat{\\mathbf{u}} e^{\\lambda t} e^{ij\\theta}$ 的解，其中 $\\theta=kh$。将此代入半离散系统可得：\n$$ \\lambda \\hat{\\mathbf{u}} e^{\\lambda t} e^{ij\\theta} = A_0 \\hat{\\mathbf{u}} e^{\\lambda t} e^{ij\\theta} + A_1 \\hat{\\mathbf{u}} e^{\\lambda t} e^{i(j-1)\\theta} $$\n两边同除以 $e^{\\lambda t} e^{ij\\theta}$，得到关于 $\\hat{\\mathbf{u}}$ 的特征值问题：\n$$ \\lambda \\hat{\\mathbf{u}} = (A_0 + e^{-i\\theta} A_1) \\hat{\\mathbf{u}} $$\n矩阵 $S(\\theta) = A_0 + e^{-i\\theta} A_1$ 是半离散算子的块符号。其特征值 $\\lambda(\\theta)$ 即为该矩阵的特征值。\n令 $z = e^{-i\\theta}$。\n$$ S(\\theta) = \\frac{a}{h} \\left[ \\begin{pmatrix} -1  -1 \\\\ 3  -3 \\end{pmatrix} + z \\begin{pmatrix} 1  1 \\\\ -3  -3 \\end{pmatrix} \\right] = \\frac{a}{h} \\begin{pmatrix} z-1  z-1 \\\\ 3-3z  -3-3z \\end{pmatrix} = \\frac{a}{h} \\begin{pmatrix} z-1  z-1 \\\\ -3(z-1)  -3(1+z) \\end{pmatrix} $$\n令 $\\lambda' = \\lambda \\frac{h}{a}$。矩阵 $M' = \\frac{h}{a}S(\\theta)$ 的特征值为 $\\lambda'$。\n$$ M' = \\begin{pmatrix} z-1  z-1 \\\\ -3(z-1)  -3(1+z) \\end{pmatrix} $$\n特征值由特征方程 $\\det(M' - \\lambda' I) = 0$ 求得。\n$$ (z-1-\\lambda')(-3(1+z)-\\lambda') - (z-1)(-3(z-1)) = 0 $$\n$$ (z-1-\\lambda')(-3-3z-\\lambda') + 3(z-1)^2 = 0 $$\n$$ (\\lambda')^2 - \\lambda'(z-1-3-3z) + (z-1)(-3-3z) + 3(z-1)^2 = 0 $$\n$$ (\\lambda')^2 - \\lambda'(-4-2z) -3(z-1)(z+1) + 3(z-1)^2 = 0 $$\n$$ (\\lambda')^2 + (4+2z)\\lambda' -3(z^2-1) + 3(z^2-2z+1) = 0 $$\n$$ (\\lambda')^2 + (4+2z)\\lambda' -3z^2+3 + 3z^2-6z+3 = 0 $$\n$$ (\\lambda')^2 + (4+2z)\\lambda' + (6-6z) = 0 $$\n我们求解这个关于 $\\lambda'$ 的二次方程：\n$$ \\lambda' = \\frac{-(4+2z) \\pm \\sqrt{(4+2z)^2 - 4(6-6z)}}{2} $$\n$$ \\lambda' = \\frac{-4-2z \\pm \\sqrt{16+16z+4z^2 - 24+24z}}{2} $$\n$$ \\lambda' = \\frac{-4-2z \\pm \\sqrt{4z^2+40z-8}}{2} $$\n$$ \\lambda' = -2-z \\pm \\sqrt{z^2+10z-2} $$\n代回 $\\lambda = \\frac{a}{h}\\lambda'$ 和 $z = e^{-i\\theta}$：\n$$ \\lambda_{\\pm}(\\theta) = \\frac{a}{h} \\left( -2-e^{-i\\theta} \\pm \\sqrt{(e^{-i\\theta})^2+10e^{-i\\theta}-2} \\right) $$\n$$ \\lambda_{\\pm}(\\theta) = \\frac{a}{h} \\left( -(2+e^{-i\\theta}) \\pm \\sqrt{e^{-2i\\theta}+10e^{-i\\theta}-2} \\right) $$\n这就是半离散算子的两个特征值的最终封闭形式表达式。", "answer": "$$\\boxed{\\lambda_{\\pm}(\\theta) = \\frac{a}{h} \\left( -(2+e^{-i\\theta}) \\pm \\sqrt{e^{-2i\\theta}+10e^{-i\\theta}-2} \\right)}$$", "id": "3426843"}, {"introduction": "这个练习将理论与实际应用联系起来，是一个综合性的实践。我们不再为每个多项式次数$p$繁琐地推导特征值，而是利用一个已知的谱半径缩放定律。你的任务是将空间离散的特性（由$p$决定的谱半径）与时间积分格式的约束（由显式龙格-库塔方法的稳定性域决定）联系起来，以做出实用的决策，例如在给定的时间步长下选择最大的可用多项式次数$p_{\\max}$[@problem_id:3426857]。", "problem": "考虑线性平流方程 $u_{t} + a\\,u_{x} = 0$，其波速为常数 $a0$，定义在一个周期性区域上，并由单元尺寸为 $h$ 的均匀网格离散。在每个单元内，用 $p$ 次多项式逼近 $u$，并使用标准的节点间断伽辽金 (DG) 方法，该方法具有精确质量和以下数值通量：\n$$\nf^{\\ast} = a\\,\\{u\\} - \\frac{\\alpha\\,a}{2}\\,[u],\n$$\n其中 $\\{u\\}$ 和 $[u]$ 分别表示 $u$ 跨越交界面的平均值和跳跃值，$\\alpha \\in [0,1]$ 是一个在中心通量（$\\alpha=0$）和完全迎风通量（$\\alpha=1$）之间插值的参数。时间积分通过一个固定的显式龙格-库塔方法进行，其绝对稳定区域 $\\mathcal{S}_{\\mathrm{RK}}$ 包含一个以原点为中心、半径为 $r_{\\mathrm{in}}0$ 的最大闭圆盘。\n\n定义 Courant–Friedrichs–Lewy (CFL) 数 $\\nu := a\\,\\Delta t / h$，其中 $\\Delta t$ 是时间步长。令 $\\lambda_{\\mathrm{DG},p}(\\theta)$ 表示 DG 半离散算子的任一特征值（作为通过冯·诺依曼分析得到的无量纲波数 $\\theta \\in [-\\pi,\\pi]$ 的函数），并定义最坏情况下的无量纲谱半径：\n$$\n\\rho_{p} := \\max_{\\theta \\in [-\\pi,\\pi]} \\frac{h}{a}\\,|\\lambda_{\\mathrm{DG},p}(\\theta)|.\n$$\n已知存在一个依赖于通量的常数 $\\kappa(\\alpha) \\geq 1$，使得\n$$\n\\rho_{p} \\leq \\kappa(\\alpha)\\,(2p+1).\n$$\n从绝对稳定区域和冯·诺依曼放大因子的定义出发，推导关于 $\\nu$ 的稳定性要求（用 $r_{\\mathrm{in}}$、$\\kappa(\\alpha)$ 和 $p$ 表示），然后求解最大允许的多项式次数 $p$（记为 $p_{\\max}$），该次数能保证 $\\Delta t\\,\\max_{\\theta}|\\lambda_{\\mathrm{DG},p}(\\theta)|$ 位于 $\\mathcal{S}_{\\mathrm{RK}}$ 内。请将您的最终答案表示为 $p_{\\max}$ 关于 $\\nu$、$r_{\\mathrm{in}}$ 和 $\\kappa(\\alpha)$ 的单个闭式解析表达式。\n\n在您的推导中，从显式龙格-库塔方法的绝对稳定性和线性常系数格式的冯·诺依曼稳定性的基本定义开始。使用修正波数的观点来论证最坏情况谱半径随 $p$ 的缩放关系，但不要在没有明确论证的情况下假定任何最终结果。最后，在概念层面上简要讨论 $\\alpha$ 的选择如何影响 $\\kappa(\\alpha)$，从而影响 $p_{\\max}$ 对通量选择的敏感性。不需要进行数值计算，您应提供精确的解析表达式。不需要单位。", "solution": "该问题要求推导间断伽辽金 (DG) 方法的稳定性条件，并随后确定最大允许的多项式次数 $p_{\\max}$。分析从直线法开始，即先将偏微分方程在空间上离散化，得到一个常微分方程组 (ODEs)，然后再对该方程组进行时间积分。\n\n使用 DG 方法对线性平流方程 $u_{t} + a\\,u_{x} = 0$ 进行半离散化，会得到以下形式的常微分方程组：\n$$\n\\frac{d\\mathbf{u}}{dt} = \\mathbf{L}_{\\mathrm{DG},p} \\mathbf{u}\n$$\n其中 $\\mathbf{u}$ 是表示 $p$ 次多项式逼近的自由度向量，而 $\\mathbf{L}_{\\mathrm{DG},p}$ 是空间离散算子。该算子的特征值记为 $\\lambda_{\\mathrm{DG},p}$，它依赖于多项式次数 $p$ 和无量纲波数 $\\theta$。\n\n时间积分采用显式龙格-库塔 (RK) 方法。全离散格式的稳定性由空间算子的特征值与时间积分器的稳定区域之间的相互作用决定。对于测试方程 $y' = \\lambda y$，如果复数 $z = \\Delta t \\lambda$ 位于方法的绝对稳定区域 $\\mathcal{S}_{\\mathrm{RK}}$ 内，则显式 RK 方法是稳定的。对于该常微分方程组，此条件必须对算子 $\\mathbf{L}_{\\mathrm{DG},p}$ 的所有特征值都成立。因此，为使数值格式稳定，我们要求：\n$$\n\\Delta t \\lambda_{\\mathrm{DG},p}(\\theta) \\in \\mathcal{S}_{\\mathrm{RK}} \\quad \\forall \\theta \\in [-\\pi, \\pi]\n$$\n对于所有与空间离散对应的特征值。\n\n问题指出，稳定区域 $\\mathcal{S}_{\\mathrm{RK}}$ 包含以原点为中心、半径为 $r_{\\mathrm{in}}  0$ 的最大闭圆盘。这意味着任何满足 $|z| \\leq r_{\\mathrm{in}}$ 的复数 $z$ 都保证位于 $\\mathcal{S}_{\\mathrm{RK}}$ 内。这为稳定性提供了一个充分条件：\n$$\n|\\Delta t \\lambda_{\\mathrm{DG},p}(\\theta)| \\leq r_{\\mathrm{in}} \\quad \\forall \\theta \\in [-\\pi, \\pi]\n$$\n为确保该条件对所有特征值和所有波数都成立，我们必须考虑模最大的特征值（即算子的谱半径）：\n$$\n\\Delta t \\cdot \\max_{\\theta \\in [-\\pi,\\pi]} |\\lambda_{\\mathrm{DG},p}(\\theta)| \\leq r_{\\mathrm{in}}\n$$\n\n我们可以用给定的无量纲参数来表示此条件。CFL 数为 $\\nu := a\\,\\Delta t / h$，最坏情况下的无量纲谱半径为 $\\rho_{p} := \\max_{\\theta \\in [-\\pi,\\pi]} \\frac{h}{a}\\,|\\lambda_{\\mathrm{DG},p}(\\theta)|$。\n根据 $\\rho_{p}$ 的定义，我们可以写出：\n$$\n\\max_{\\theta \\in [-\\pi,\\pi]} |\\lambda_{\\mathrm{DG},p}(\\theta)| = \\frac{a}{h} \\rho_{p}\n$$\n将此代入稳定性条件，得到：\n$$\n\\Delta t \\left( \\frac{a}{h} \\rho_{p} \\right) \\leq r_{\\mathrm{in}}\n$$\n整理左侧的项，我们识别出 CFL 数：\n$$\n\\left( \\frac{a \\Delta t}{h} \\right) \\rho_{p} \\leq r_{\\mathrm{in}}\n$$\n$$\n\\nu \\rho_{p} \\leq r_{\\mathrm{in}}\n$$\n这个不等式是一个普适的稳定性要求，它关联了 CFL 数、DG 算子的谱性质以及 RK 方法的稳定区域。\n\n问题为无量纲谱半径提供了一个特定的界：$\\rho_{p} \\leq \\kappa(\\alpha)\\,(2p+1)$，其中 $\\kappa(\\alpha) \\geq 1$ 是一个依赖于数值通量参数 $\\alpha$ 的常数。为保证稳定性，我们可以将这个上界代入我们的稳定性条件，从而得到一个更严格但充分的条件：\n$$\n\\nu \\left( \\kappa(\\alpha)\\,(2p+1) \\right) \\leq r_{\\mathrm{in}}\n$$\n这是关于 $\\nu$ 的显式稳定性要求，用 $r_{\\mathrm{in}}$、$\\kappa(\\alpha)$ 和 $p$ 表示。\n\n最后一步是解这个不等式，求出最大允许的多项式次数 $p$，我们记为 $p_{\\max}$。我们重新整理不等式以分离出 $p$：\n$$\n2p+1 \\leq \\frac{r_{\\mathrm{in}}}{\\nu \\kappa(\\alpha)}\n$$\n$$\n2p \\leq \\frac{r_{\\mathrm{in}}}{\\nu \\kappa(\\alpha)} - 1\n$$\n$$\np \\leq \\frac{1}{2} \\left( \\frac{r_{\\mathrm{in}}}{\\nu \\kappa(\\alpha)} - 1 \\right)\n$$\n由于多项式次数 $p$ 必须是非负整数，满足此条件的 $p$ 的最大整数值可以通过对右侧表达式取底函数（floor function）得到。我们还必须确保结果是一个有效的多项式次数，即非负。底函数恰当地确定了最大整数。\n因此，$p_{\\max}$ 的表达式为：\n$$\np_{\\max} = \\left\\lfloor \\frac{1}{2} \\left( \\frac{r_{\\mathrm{in}}}{\\nu \\kappa(\\alpha)} - 1 \\right) \\right\\rfloor\n$$\n该表达式在参数 $\\nu$、$r_{\\mathrm{in}}$ 和 $\\kappa(\\alpha)$ 使得底函数的自变量为非负的假设下是有效的，从而至少允许 $p=0$。\n\n从概念上讲，通量参数 $\\alpha$ 的选择通过常数 $\\kappa(\\alpha)$ 对稳定性产生显著影响。\n对于 $\\alpha=0$，通量是中心的且非耗散的。$\\mathbf{L}_{\\mathrm{DG},p}$ 的特征值位于虚轴上。在这种情况下，已知 DG 算子的谱半径很大（在某些范数下其缩放尺度为 $O(p^2)$），这意味着 $\\kappa(0)$ 将是 $\\kappa(\\alpha)$ 取值范围内的最大值。对于给定的 CFL 数 $\\nu$，一个大的 $\\kappa(\\alpha)$ 会导致一个小的 $p_{\\max}$，这反映了严格的稳定性约束。\n相反，对于 $\\alpha=1$，通量是完全迎风的，并引入了数值耗散。这种耗散将 $\\mathbf{L}_{\\mathrm{DG},p}$ 的特征值从虚轴移入复平面的开左半平面。这通常会减小谱半径（特征值的最大模）。因此，预计 $\\kappa(1)$ 会小于 $\\kappa(0)$，并且问题中给出的谱半径的 $O(p)$ 缩放尺度更能代表偏向迎风的格式。\n从 $p_{\\max}$ 的表达式中，我们看到它与 $\\kappa(\\alpha)$ 成反比。一个较小的 $\\kappa(\\alpha)$ 值（通过将 $\\alpha$ 增加到接近 1 来实现）在固定的 CFL 数 $\\nu$ 下允许一个更大的 $p_{\\max}$ 值。这揭示了数值方法中的一个基本权衡：增加耗散（通过选择更接近 1 的 $\\alpha$）可以增强稳定性，从而允许使用更高阶的多项式或更大的时间步长，但代价是由于人工扩散而导致精度降低。", "answer": "$$\n\\boxed{\\left\\lfloor \\frac{1}{2} \\left( \\frac{r_{\\mathrm{in}}}{\\nu \\kappa(\\alpha)} - 1 \\right) \\right\\rfloor}\n$$", "id": "3426857"}]}