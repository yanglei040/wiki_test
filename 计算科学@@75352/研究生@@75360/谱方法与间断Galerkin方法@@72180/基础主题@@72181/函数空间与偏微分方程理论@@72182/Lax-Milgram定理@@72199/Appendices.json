{"hands_on_practices": [{"introduction": "第一个实践聚焦于Lax-Milgram定理的基石：矫顽性（coercivity）。通过分析一个标准的反应-扩散双线性形式，你将推导出精确的矫顽性常数，并了解它如何通过庞加莱常数（Poincaré constant）依赖于问题的物理参数和区域的几何形状。该练习旨在培养证明变分问题适定性的基本技能。", "problem": "令 $\\Omega \\subset \\mathbb{R}^{d}$ 是一个有界 Lipschitz 区域，并令 $H^{1}_{0}(\\Omega)$ 表示 Sobolev 空间，该空间中的函数具有平方可积的一阶导数，且在 $\\partial \\Omega$ 上的迹为零。假设 Poincaré 不等式成立，其最优 Poincaré 常数为 $C_{P} > 0$，即对于所有 $u \\in H^{1}_{0}(\\Omega)$，有 $\\|u\\|_{L^{2}(\\Omega)} \\leq C_{P}\\,\\|\\nabla u\\|_{L^{2}(\\Omega)}$。考虑对称双线性形式 $a : H^{1}_{0}(\\Omega) \\times H^{1}_{0}(\\Omega) \\to \\mathbb{R}$，其定义为\n$$\na(u,v) \\;=\\; \\int_{\\Omega} \\nabla u \\cdot \\nabla v \\, dx \\;+\\; c \\int_{\\Omega} u\\,v \\, dx,\n$$\n其中反应系数 $c \\geq 0$ 是一个固定的常数。在线性椭圆偏微分方程 (PDE) 的谱 Galerkin 和间断 Galerkin 方法的适定性背景下，通过 Lax–Milgram 定理，一个基本要求是 $a(\\cdot,\\cdot)$ 相对于 $H^{1}_{0}(\\Omega)$ 上的一个范数是强制的。这里，我们取 $H^1$-范数\n$$\n\\|u\\|_{H^{1}(\\Omega)}^{2} \\;=\\; \\|\\nabla u\\|_{L^{2}(\\Omega)}^{2} \\;+\\; \\|u\\|_{L^{2}(\\Omega)}^{2}.\n$$\n请以闭式形式确定最大的强制性常数 $\\alpha = \\alpha(c, C_{P})$，使得不等式\n$$\na(u,u) \\;\\ge\\; \\alpha \\,\\|u\\|_{H^{1}(\\Omega)}^{2} \\quad \\text{对所有 } u \\in H^{1}_{0}(\\Omega)\n$$\n成立，并纯粹用 $c$ 和 $C_{P}$ 表示。你的最终答案必须是关于 $c$ 和 $C_{P}$ 的单个闭式解析表达式。", "solution": "该问题要求找到双线性形式 $a(\\cdot,\\cdot)$ 关于 $H^{1}$-范数的最大强制性常数 $\\alpha$，该常数是反应系数 $c$ 和 Poincaré 常数 $C_{P}$ 的函数。\n\n问题给出了以下定义：\n双线性形式为 $a(u,v) = \\int_{\\Omega} \\nabla u \\cdot \\nabla v \\, dx + c \\int_{\\Omega} u\\,v \\, dx$，对于 $u, v \\in H^{1}_{0}(\\Omega)$ 和常数 $c \\ge 0$。\n梯度的 $L^2$-范数的平方是 $\\|\\nabla u\\|_{L^{2}(\\Omega)}^{2} = \\int_{\\Omega} |\\nabla u|^{2} \\, dx$。\n$L^2$-范数的平方是 $\\|u\\|_{L^{2}(\\Omega)}^{2} = \\int_{\\Omega} u^{2} \\, dx$。\n因此，双线性形式在 $(u,u)$ 处的值为 $a(u,u) = \\|\\nabla u\\|_{L^{2}(\\Omega)}^{2} + c \\|u\\|_{L^{2}(\\Omega)}^{2}$。\n\n空间 $H^{1}_{0}(\\Omega)$ 上的范数是 $H^{1}$-范数，其平方定义为 $\\|u\\|_{H^{1}(\\Omega)}^{2} = \\|\\nabla u\\|_{L^{2}(\\Omega)}^{2} + \\|u\\|_{L^{2}(\\Omega)}^{2}$。\n\n强制性条件是对于所有 $u \\in H^{1}_{0}(\\Omega)$，有 $a(u,u) \\ge \\alpha \\|u\\|_{H^{1}(\\Omega)}^{2}$。\n\n为了找到 $\\alpha$ 的最大可能值，我们必须求出比率 $\\frac{a(u,u)}{\\|u\\|_{H^{1}(\\Omega)}^{2}}$ 在空间 $H^{1}_{0}(\\Omega)$ 中所有非零函数上的下确界。\n$$\n\\alpha = \\inf_{u \\in H^{1}_{0}(\\Omega) \\setminus \\{0\\}} \\frac{a(u,u)}{\\|u\\|_{H^{1}(\\Omega)}^{2}}\n$$\n代入 $a(u,u)$ 和 $\\|u\\|_{H^{1}(\\Omega)}^{2}$ 的表达式：\n$$\n\\alpha = \\inf_{u \\in H^{1}_{0}(\\Omega) \\setminus \\{0\\}} \\frac{\\|\\nabla u\\|_{L^{2}(\\Omega)}^{2} + c \\|u\\|_{L^{2}(\\Omega)}^{2}}{\\|\\nabla u\\|_{L^{2}(\\Omega)}^{2} + \\|u\\|_{L^{2}(\\Omega)}^{2}}\n$$\n对于任何满足 $u \\not\\equiv 0$ 的 $u \\in H^{1}_{0}(\\Omega)$，必有 $\\|\\nabla u\\|_{L^{2}(\\Omega)} > 0$。如果 $\\|\\nabla u\\|_{L^{2}(\\Omega)} = 0$，则 $u$ 是一个常数函数。由于 $u \\in H^{1}_{0}(\\Omega)$，其在边界 $\\partial\\Omega$ 上的迹为零，这意味着该常数必须为零，所以 $u \\equiv 0$。因此，对于任何非零的 $u$，我们可以将分子和分母同时除以 $\\|\\nabla u\\|_{L^{2}(\\Omega)}^{2}$：\n$$\n\\alpha = \\inf_{u \\in H^{1}_{0}(\\Omega) \\setminus \\{0\\}} \\frac{1 + c \\frac{\\|u\\|_{L^{2}(\\Omega)}^{2}}{\\|\\nabla u\\|_{L^{2}(\\Omega)}^{2}}}{1 + \\frac{\\|u\\|_{L^{2}(\\Omega)}^{2}}{\\|\\nabla u\\|_{L^{2}(\\Omega)}^{2}}}\n$$\n我们定义一个变量 $z = \\frac{\\|u\\|_{L^{2}(\\Omega)}^{2}}{\\|\\nabla u\\|_{L^{2}(\\Omega)}^{2}}$。问题现在简化为求一个关于 $z$ 的函数的下确界，其中 $z$ 的取值范围由空间 $H^{1}_{0}(\\Omega)$ 的性质决定。\n\nPoincaré 不等式为 $\\|u\\|_{L^{2}(\\Omega)} \\le C_{P} \\|\\nabla u\\|_{L^{2}(\\Omega)}$，对所有 $u \\in H^{1}_{0}(\\Omega)$ 成立，其中 $C_{P}$ 是最优常数。将此不等式平方得到 $\\|u\\|_{L^{2}(\\Omega)}^{2} \\le C_{P}^{2} \\|\\nabla u\\|_{L^{2}(\\Omega)}^{2}$，这意味着 $z = \\frac{\\|u\\|_{L^{2}(\\Omega)}^{2}}{\\|\\nabla u\\|_{L^{2}(\\Omega)}^{2}} \\le C_{P}^{2}$。\n对于 $u \\in H^{1}_{0}(\\Omega) \\setminus \\{0\\}$，比率 $z$ 的所有可能值的集合是区间 $[0, C_P^2]$。当 $u$ 是带齐次 Dirichlet 边界条件的负拉普拉斯算子的第一个特征值对应的特征函数时，达到 $z=C_P^2$。通过高度振荡的函数（对应于拉普拉斯算子的大特征值对应的特征函数），可以得到任意接近 $0$ 的 $z$ 值。\n\n因此，我们必须求函数 $f(z) = \\frac{1+cz}{1+z}$ 在区间 $z \\in [0, C_{P}^{2}]$ 上的下确界。为此，我们分析 $f(z)$ 的导数：\n$$\nf'(z) = \\frac{d}{dz}\\left(\\frac{1+cz}{1+z}\\right) = \\frac{c(1+z) - (1+cz)(1)}{(1+z)^{2}} = \\frac{c-1}{(1+z)^{2}}\n$$\n导数的符号取决于 $c$ 的值，并且问题中说明 $c \\ge 0$。我们考虑两种情况。\n\n情况 1：$c \\ge 1$。\n在这种情况下，$c-1 \\ge 0$，所以 $f'(z) \\ge 0$。这意味着 $f(z)$ 在其定义域上是一个非减函数。因此，$f(z)$ 在区间 $[0, C_{P}^{2}]$ 上的下确界在左端点 $z=0$ 处取得。\n$$\n\\alpha = f(0) = \\frac{1+c(0)}{1+0} = 1\n$$\n\n情况 2：$0 \\le c  1$。\n在这种情况下，$c-1  0$，所以 $f'(z)  0$。这意味着 $f(z)$ 在其定义域上是一个严格递减函数。因此，$f(z)$ 在区间 $[0, C_{P}^{2}]$ 上的下确界在右端点 $z=C_{P}^{2}$ 处取得。\n$$\n\\alpha = f(C_{P}^{2}) = \\frac{1+cC_{P}^{2}}{1+C_{P}^{2}}\n$$\n\n我们可以将这两个结果合并成一个单一的解析表达式。\n如果 $c \\ge 1$，则 $c-1 \\ge 0$，这意味着 $cC_P^2 \\ge C_P^2$，所以 $1+cC_P^2 \\ge 1+C_P^2$。这得出 $\\frac{1+cC_{P}^{2}}{1+C_{P}^{2}} \\ge 1$。因此，对于 $c \\ge 1$，结果 $\\alpha=1$ 可以写成 $\\min\\left(1, \\frac{1+cC_P^2}{1+C_P^2}\\right)$。\n如果 $0 \\le c  1$，则 $c-1  0$，这意味着 $cC_P^2  C_P^2$，所以 $1+cC_P^2  1+C_P^2$。这得出 $\\frac{1+cC_{P}^{2}}{1+C_{P}^{2}}  1$。因此，对于 $0 \\le c  1$，结果 $\\alpha=\\frac{1+cC_{P}^{2}}{1+C_{P}^{2}}$ 可以写成 $\\min\\left(1, \\frac{1+cC_P^2}{1+C_P^2}\\right)$。\n\n因此，对于所有 $c \\ge 0$，最大的强制性常数 $\\alpha$ 可以用单一的闭式形式表示为：\n$$\n\\alpha(c, C_{P}) = \\min\\left(1, \\frac{1+cC_{P}^{2}}{1+C_{P}^{2}}\\right)\n$$", "answer": "$$\n\\boxed{\\min\\left(1, \\frac{1+c C_{P}^{2}}{1+C_{P}^{2}}\\right)}\n$$", "id": "3395434"}, {"introduction": "在矫顽性概念的基础上，本练习将带你进入现代间断Galerkin（DG）方法的实践领域。你将看到Lax-Milgram定理的理论要求如何在一个离散设定中得到满足，这需要推导关键的分析工具并确定必要的罚参数。这个实践展示了如何为对称内部罚Galerkin（SIPG）等高级数值格式严格地建立稳定性。", "problem": "考虑在有界 Lipschitz 域 $\\Omega \\subset \\mathbb{R}^{d}$ 上的标量泊松模型问题，带有齐次狄利克雷边界条件。令 $\\mathcal{T}_{h}$ 为 $\\Omega$ 的一个形状正则网格，其单元为 $K$，每个单元 $K$ 都是通过一个仿射映射 $F_{K}$ 从一个固定的参考单元 $\\widehat{K}$ 变换得到的，该映射的雅可比矩阵为 $J_{K}$，行列式为 $|J_{K}|$。用 $h_{K}$ 表示 $K$ 的直径，用 $h_{e}$ 表示一个面（二维中的边，三维中的面）$e \\subset \\partial K$ 的直径。对于固定的多项式次数 $p \\geq 1$，令 $V_{h}$ 为 $\\mathcal{T}_{h}$ 上的分片多项式空间，其元素为标量值函数，总次数最多为 $p$，且无单元间的连续性约束。\n\n您将使用对称内罚伽辽金 (SIPG) 双线性形式 $a_{h}(\\cdot,\\cdot)$，它在 $V_{h} \\times V_{h}$ 上定义为\n$$\na_{h}(u_{h},v_{h}) \\;=\\; \\sum_{K \\in \\mathcal{T}_{h}} \\int_{K} \\nabla u_{h} \\cdot \\nabla v_{h} \\,\\mathrm{d}x \\;-\\; \\sum_{e \\in \\mathcal{E}_{h}} \\int_{e} \\left\\{ \\partial_{n} u_{h} \\right\\} [v_{h}] \\,\\mathrm{d}s \\;-\\; \\sum_{e \\in \\mathcal{E}_{h}} \\int_{e} \\left\\{ \\partial_{n} v_{h} \\right\\} [u_{h}] \\,\\mathrm{d}s \\;+\\; \\sum_{e \\in \\mathcal{E}_{h}} \\int_{e} \\sigma_{e} [u_{h}] [v_{h}] \\,\\mathrm{d}s,\n$$\n其中 $\\mathcal{E}_{h}$ 是所有网格面的集合，$[v_{h}]$ 表示 $v_{h}$ 穿过一个内部面 $e = \\partial K^{+} \\cap \\partial K^{-}$ 的标量跳跃，定义为 $[v_{h}] = v_{h}^{+} - v_{h}^{-}$，而 $\\{\\partial_{n} v_{h}\\}$ 表示法向导数的平均值，$\\{\\partial_{n} v_{h}\\} = \\tfrac{1}{2}\\left(\\nabla v_{h}^{+} \\cdot n^{+} + \\nabla v_{h}^{-} \\cdot n^{-}\\right)$，其中 $n^{\\pm}$ 是 $\\partial K^{\\pm}$ 上的外单位法向量。在边界面上，以与齐次狄利克雷边界条件一致的标准方式解释这些量。罚参数选择为 $\\sigma_{e} = \\gamma \\,\\dfrac{p^{2}}{h_{e}}$，其中 $\\gamma$ 是一个待定的正常数。\n\n从关于仿射映射和参考单元上多项式逼近的基本事实出发，按以下步骤进行：\n\n1) 在每个单元 $K$ 上推导一个局部逆不等式：对于任何限制在 $K$ 上的 $v_{h} \\in V_{h}$，证明一个界，该界用 $\\|v_{h}\\|_{L^{2}(K)}$ 来表示 $\\|\\nabla v_{h}\\|_{L^{2}(K)}$，并明确依赖于多项式次数 $p$ 和单元直径 $h_{K}$。您的推导必须从一个参考单元上的多项式不等式开始，并使用仿射映射 $F_{K}$ 下的缩放以及形状正则性。\n\n2) 使用步骤 1) 的结果以及一个参考单元上的迹不等式，推导一个多项式的离散迹不等式，该不等式对于每个面 $e \\subset \\partial K$ 产生一个形式如下的界\n$$\nh_{e}\\,\\|\\partial_{n} v_{h}\\|_{L^{2}(e)}^{2} \\;\\leq\\; C_{\\mathrm{tr}} \\, p^{2} \\, \\|\\nabla v_{h}\\|_{L^{2}(K)}^{2},\n$$\n其中 $C_{\\mathrm{tr}}$ 仅依赖于网格族的形状正则性和参考单元的常数。\n\n3) 在网格相关范数下证明 $a_{h}(\\cdot,\\cdot)$ 的矫顽性\n$$\n\\|v_{h}\\|_{1,h}^{2} \\;=\\; \\sum_{K \\in \\mathcal{T}_{h}} \\|\\nabla v_{h}\\|_{L^{2}(K)}^{2} \\;+\\; \\sum_{e \\in \\mathcal{E}_{h}} \\frac{p^{2}}{h_{e}} \\,\\|[v_{h}]\\|_{L^{2}(e)}^{2}.\n$$\n具体来说，使用步骤 2) 中的离散迹不等式和面上的杨氏不等式，结合形状正则性，证明存在一种 $\\gamma$ 的选择，使得\n$$\na_{h}(v_{h},v_{h}) \\;\\geq\\; \\frac{1}{2}\\,\\sum_{K \\in \\mathcal{T}_{h}} \\|\\nabla v_{h}\\|_{L^{2}(K)}^{2} \\;+\\; \\frac{1}{2}\\,\\sum_{e \\in \\mathcal{E}_{h}} \\sigma_{e}\\,\\|[v_{h}]\\|_{L^{2}(e)}^{2}\n$$\n对于所有 $v_{h} \\in V_{h}$ 成立。用 $N_{f}$ 表示 $\\mathcal{T}_{h}$ 中每个单元的最大面数。计算最小的可接受下界 $\\gamma_{\\ast}$，它是一个关于 $C_{\\mathrm{tr}}$ 和 $N_{f}$ 的闭式解析表达式，保证上述带有因子 $\\tfrac{1}{2}$ 的矫顽性不等式成立。\n\n4) 简要解释步骤 3) 的矫顽性如何与 $a_{h}(\\cdot,\\cdot)$ 在相同范数下的连续性一起，通过 Lax-Milgram 定理蕴含 SIPG 方法的适定性，但除了 $\\gamma_{\\ast}$ 外，不要陈述或推导任何其他常数。\n\n您的最终答案必须是步骤 3) 中得到的最小 $\\gamma_{\\ast}$ 的单一闭式解析表达式。不需要四舍五入，也不涉及单位。", "solution": "此问题要求逐步推导对称内罚伽辽金 (SIPG) 方法的几个关键不等式，最终证明其矫顽性并确定最小罚参数。最后一步是将这些结果通过 Lax-Milgram 定理与数值方法的适定性联系起来。\n\n**1) 局部逆不等式的推导**\n\n我们首先陈述一个在参考单元 $\\widehat{K}$ 上关于多项式的标准逆不等式。对于任何多项式 $\\widehat{v} \\in P^p(\\widehat{K})$（总次数至多为 $p$ 的多项式空间），存在一个仅依赖于 $\\widehat{K}$ 几何形状的常数 $C_{\\text{inv,ref}}$，使得：\n$$\n\\|\\widehat{\\nabla} \\widehat{v}\\|_{L^2(\\widehat{K})} \\leq C_{\\text{inv,ref}} \\, p^2 \\, \\|\\widehat{v}\\|_{L^2(\\widehat{K})}\n$$\n$p^2$ 的依赖关系是这类不等式在多维空间中的一个已知性质。\n\n令 $v_h$ 为单元 $K \\in \\mathcal{T}_h$ 上次数至多为 $p$ 的多项式。令 $\\widehat{v}$ 为其在参考单元 $\\widehat{K}$ 上通过仿射映射 $x = F_K(\\widehat{x}) = J_K \\widehat{x} + b_K$ 的对应。我们有 $v_h(x) = \\widehat{v}(\\widehat{x})$。我们通过变量替换来关联 $K$ 和 $\\widehat{K}$ 上的范数。\n对于函数本身的 $L^2$-范数，我们有：\n$$\n\\|v_h\\|_{L^2(K)}^2 = \\int_K v_h(x)^2 \\,\\mathrm{d}x = \\int_{\\widehat{K}} \\widehat{v}(\\widehat{x})^2 |J_K| \\,\\mathrm{d}\\widehat{x} = |J_K| \\|\\widehat{v}\\|_{L^2(\\widehat{K})}^2\n$$\n其中 $|J_K|$ 是雅可比矩阵 $J_K$ 的行列式。\n\n对于梯度，链式法则给出 $\\widehat{\\nabla} \\widehat{v} = J_K^T \\nabla v_h$，这意味着 $\\nabla v_h = J_K^{-T} \\widehat{\\nabla} \\widehat{v}$。我们可以如下界定梯度的范数：\n$$\n\\|\\nabla v_h\\|_{L^2(K)}^2 = \\int_K |\\nabla v_h(x)|^2 \\,\\mathrm{d}x = \\int_{\\widehat{K}} |J_K^{-T} \\widehat{\\nabla} \\widehat{v}(\\widehat{x})|^2 |J_K| \\,\\mathrm{d}\\widehat{x}\n$$\n使用矩阵算子范数（谱范数）的定义，我们有 $|J_K^{-T} \\widehat{\\nabla} \\widehat{v}| \\leq \\|J_K^{-T}\\| |\\widehat{\\nabla} \\widehat{v}| = \\|J_K^{-1}\\| |\\widehat{\\nabla} \\widehat{v}|$。\n$$\n\\|\\nabla v_h\\|_{L^2(K)}^2 \\leq \\|J_K^{-1}\\|^2 \\int_{\\widehat{K}} |\\widehat{\\nabla} \\widehat{v}(\\widehat{x})|^2 |J_K| \\,\\mathrm{d}\\widehat{x} = \\|J_K^{-1}\\|^2 |J_K| \\|\\widehat{\\nabla} \\widehat{v}\\|_{L^2(\\widehat{K})}^2\n$$\n现在我们结合这些关系。从参考逆不等式：\n$$\n\\|\\widehat{\\nabla} \\widehat{v}\\|_{L^2(\\widehat{K})}^2 \\leq (C_{\\text{inv,ref}} p^2)^2 \\|\\widehat{v}\\|_{L^2(\\widehat{K})}^2\n$$\n代入缩放后的范数表达式：\n$$\n\\|\\nabla v_h\\|_{L^2(K)}^2 \\leq \\|J_K^{-1}\\|^2 |J_K| (C_{\\text{inv,ref}} p^2)^2 \\left( \\frac{1}{|J_K|} \\|v_h\\|_{L^2(K)}^2 \\right) = \\|J_K^{-1}\\|^2 (C_{\\text{inv,ref}} p^2)^2 \\|v_h\\|_{L^2(K)}^2\n$$\n网格族 $\\mathcal{T}_h$ 是形状正则的。此性质意味着存在一个与 $h_K$ 无关的常数 $C_{\\text{sr}}$，使得 $\\|J_K^{-1}\\| \\leq C_{\\text{sr}} h_K^{-1}$。将此代入不等式中：\n$$\n\\|\\nabla v_h\\|_{L^2(K)}^2 \\leq (C_{\\text{sr}} h_K^{-1})^2 (C_{\\text{inv,ref}} p^2)^2 \\|v_h\\|_{L^2(K)}^2\n$$\n两边取平方根，我们得到所求的局部逆不等式：\n$$\n\\|\\nabla v_h\\|_{L^2(K)} \\leq C_{\\text{inv}} \\frac{p^2}{h_K} \\|v_h\\|_{L^2(K)}\n$$\n其中常数 $C_{\\text{inv}} = C_{\\text{sr}} C_{\\text{inv,ref}}$ 仅依赖于网格的形状正则性和参考单元的几何形状。\n\n**2) 离散迹不等式的推导**\n\n我们的目标是证明一个形如 $h_e \\|\\partial_n v_h\\|_{L^2(e)}^2 \\leq C_{\\text{tr}} p^2 \\|\\nabla v_h\\|_{L^2(K)}^2$ 的不等式。这是一种迹-逆不等式。我们从参考单元 $\\widehat{K}$ 上多项式的一个已知结果出发：对于分量在 $P^{p-1}(\\widehat{K})$ 中的向量值多项式 $\\widehat{w}$，存在一个常数 $C_{\\text{ref,tr-inv}}$，使得\n$$\n\\|\\widehat{w}\\|_{L^2(\\partial \\widehat{K})}^2 \\leq C_{\\text{ref,tr-inv}} p^2 \\|\\widehat{w}\\|_{L^2(\\widehat{K})}^2\n$$\n这个不等式结合了迹定理和参考单元上的逆不等式，其中 $p^2$ 因子是标准的。我们将其应用于 $\\widehat{w} = \\widehat{\\nabla} \\widehat{v}_h$，其分量是次数至多为 $p-1$ 的多项式。\n$$\n\\|\\widehat{\\nabla} \\widehat{v}_h\\|_{L^2(\\widehat{e})}^2 \\leq \\|\\widehat{\\nabla} \\widehat{v}_h\\|_{L^2(\\partial \\widehat{K})}^2 \\leq C_{\\text{ref,tr-inv}} p^2 \\|\\widehat{\\nabla} \\widehat{v}_h\\|_{L^2(\\widehat{K})}^2\n$$\n现在，我们进行缩放论证，从 $\\widehat{K}$ 和 $\\widehat{e}$ 变换到物理单元 $K$ 和面 $e$。我们有 $\\partial_n v_h = \\nabla v_h \\cdot n$。那么 $\\|\\partial_n v_h\\|_{L^2(e)}^2 \\leq \\|\\nabla v_h\\|_{L^2(e)}^2$。我们来界定后者。\n面积分的变换是 $\\int_e |\\nabla v_h|^2 \\mathrm{d}s = \\int_{\\widehat{e}} |J_K^{-T} \\widehat{\\nabla} \\widehat{v}_h|^2 \\frac{\\mathrm{d}s}{\\mathrm{d}\\widehat{s}} \\mathrm{d}\\widehat{s}$。\n面元的缩放关系是 $\\frac{\\mathrm{d}s}{\\mathrm{d}\\widehat{s}} = |J_K| \\|J_K^{-T} \\widehat{n}\\|$，其中 $\\widehat{n}$ 是 $\\widehat{e}$ 的单位法向量。\n形状正则性确保 $|J_K| \\sim h_K^d$, $\\|J_K^{-1}\\| \\sim h_K^{-1}$。因此，$\\frac{\\mathrm{d}s}{\\mathrm{d}\\widehat{s}} \\sim h_K^d h_K^{-1} = h_K^{d-1}$。我们用 $C_{\\text{sr}}$ 表示由形状正则性产生的通用常数。\n$$\n\\|\\nabla v_h\\|_{L^2(e)}^2 \\leq C_{\\text{sr}} h_K^{d-1} \\int_{\\widehat{e}} \\|J_K^{-T}\\|^2 |\\widehat{\\nabla} \\widehat{v}_h|^2 \\mathrm{d}\\widehat{s} \\leq C_{\\text{sr}} h_K^{d-1} h_K^{-2} \\|\\widehat{\\nabla} \\widehat{v}_h\\|_{L^2(\\widehat{e})}^2 = C_{\\text{sr}} h_K^{d-3} \\|\\widehat{\\nabla} \\widehat{v}_h\\|_{L^2(\\widehat{e})}^2\n$$\n现在我们使用参考迹-逆不等式：\n$$\n\\|\\nabla v_h\\|_{L^2(e)}^2 \\leq C_{\\text{sr}} h_K^{d-3} (C_{\\text{ref,tr-inv}} p^2 \\|\\widehat{\\nabla} \\widehat{v}_h\\|_{L^2(\\widehat{K})}^2)\n$$\n最后，我们将剩余的参考范数缩放回物理单元。$\\widehat{\\nabla} \\widehat{v}_h = J_K^T \\nabla v_h$。\n$$\n\\|\\widehat{\\nabla} \\widehat{v}_h\\|_{L^2(\\widehat{K})}^2 = \\int_{\\widehat{K}} |J_K^T \\nabla v_h|^2 \\mathrm{d}\\widehat{x} \\leq \\|J_K^T\\|^2 \\int_{\\widehat{K}} |\\nabla v_h|^2 \\frac{1}{|J_K|} \\mathrm{d}x = \\frac{\\|J_K\\|^2}{|J_K|} \\|\\nabla v_h\\|_{L^2(K)}^2\n$$\n利用形状正则性，$\\|J_K\\| \\sim h_K$ 且 $|J_K| \\sim h_K^d$，所以 $\\frac{\\|J_K\\|^2}{|J_K|} \\leq C_{\\text{sr}} \\frac{h_K^2}{h_K^d} = C_{\\text{sr}} h_K^{2-d}$。\n将其代回：\n$$\n\\|\\nabla v_h\\|_{L^2(e)}^2 \\leq (C_{\\text{sr}} h_K^{d-3}) (C_{\\text{ref,tr-inv}} p^2) (C_{\\text{sr}} h_K^{2-d} \\|\\nabla v_h\\|_{L^2(K)}^2) = C' \\frac{p^2}{h_K} \\|\\nabla v_h\\|_{L^2(K)}^2\n$$\n其中 $C'$ 结合了所有常数。由于网格是形状正则的，$h_e$ 和 $h_K$ 是等价的，即 $h_K \\leq C_{\\text{sr}} h_e$。这给出 $1/h_K \\leq C_{\\text{sr}}/h_e$。因此，我们得到了所求的离散迹不等式：\n$$\nh_e \\|\\partial_n v_h\\|_{L^2(e)}^2 \\leq h_e \\|\\nabla v_h\\|_{L^2(e)}^2 \\leq C_{\\text{tr}} p^2 \\|\\nabla v_h\\|_{L^2(K)}^2\n$$\n其中 $C_{\\text{tr}}$ 是一个依赖于形状正则性和参考单元性质的常数。\n\n**3) 矫顽性的证明及 $\\gamma_\\ast$ 的计算**\n\nSIPG 双线性形式为：\n$$\na_{h}(v_{h},v_{h}) = \\sum_{K \\in \\mathcal{T}_{h}} \\|\\nabla v_{h}\\|_{L^{2}(K)}^{2} - 2\\sum_{e \\in \\mathcal{E}_{h}} \\int_{e} \\left\\{ \\partial_{n} v_{h} \\right\\} [v_{h}] \\,\\mathrm{d}s + \\sum_{e \\in \\mathcal{E}_{h}} \\sigma_{e} \\|[v_{h}]\\|_{L^{2}(e)}^{2}\n$$\n我们关注第二项。根据柯西-施瓦茨不等式和杨氏不等式（对于任何 $\\eta  0$，$2ab \\le \\eta a^2 + \\eta^{-1}b^2$），对每个面 $e$ 我们有：\n$$\n\\left| 2\\int_{e} \\left\\{ \\partial_{n} v_{h} \\right\\} [v_{h}] \\,\\mathrm{d}s \\right| \\leq 2 \\|\\{\\partial_n v_h\\}\\|_{L^2(e)} \\|[v_h]\\|_{L^2(e)} \\leq \\eta_e \\|\\{\\partial_n v_h\\}\\|_{L^2(e)}^2 + \\frac{1}{\\eta_e} \\|[v_h]\\|_{L^2(e)}^2\n$$\n其中 $\\eta_e$ 是一个待选择的正参数。对所有面求和并代入双线性形式中：\n$$\na_h(v_h, v_h) \\geq \\sum_{K} \\|\\nabla v_h\\|_K^2 - \\sum_{e} \\eta_e \\|\\{\\partial_n v_h\\}\\|_e^2 + \\sum_{e} \\left(\\sigma_e - \\frac{1}{\\eta_e}\\right) \\|[v_h]\\|_e^2\n$$\n现在我们界定 $\\sum_e \\eta_e \\|\\{\\partial_n v_h\\}\\|_e^2$ 这一项。对于任何面 $e$，平均算子满足 $\\|\\{\\partial_n v_h\\}\\|_e^2 \\leq \\frac{1}{2}(\\|\\partial_n v_h^+\\|_e^2 + \\|\\partial_n v_h^-\\|_e^2)$，其中 $v_h^\\pm$ 是来自相邻单元 $K^\\pm$ 的迹（对于边界面，其中一项不存在）。\n对共享该面的每个单元应用步骤 2) 的离散迹不等式：\n$$\n\\|\\partial_n v_h^\\pm\\|_e^2 \\le C_{\\text{tr}} \\frac{p^2}{h_e} \\|\\nabla v_h^\\pm\\|_{K^\\pm}^2\n$$\n因此，\n$$\n\\sum_{e \\in \\mathcal{E}_h} \\eta_e \\|\\{\\partial_n v_h\\}\\|_e^2 \\leq \\sum_{e \\in \\mathcal{E}_h} \\eta_e \\frac{1}{2} C_{\\text{tr}} \\frac{p^2}{h_e} \\left( \\|\\nabla v_h^+\\|_{K^+}^2 + \\|\\nabla v_h^-\\|_{K^-}^2 \\right)\n$$\n我们选择 $\\eta_e = \\alpha \\frac{h_e}{p^2}$，其中 $\\alpha  0$ 是一个常数。\n$$\n\\sum_e \\eta_e \\|\\{\\partial_n v_h\\}\\|_e^2 \\leq \\sum_{e \\in \\mathcal{E}_h} \\left(\\alpha \\frac{h_e}{p^2}\\right) \\frac{C_{\\text{tr}} p^2}{2h_e} \\left( \\|\\nabla v_h^+\\|_{K^+}^2 + \\|\\nabla v_h^-\\|_{K^-}^2 \\right) = \\frac{\\alpha C_{\\text{tr}}}{2} \\sum_{e \\in \\mathcal{E}_h} \\left( \\|\\nabla v_h^+\\|_{K^+}^2 + \\|\\nabla v_h^-\\|_{K^-}^2 \\right)\n$$\n将对面上的求和重写为对单元上的求和：每个单元 $K$ 在其每个面的求和中都出现一次。\n$$\n\\sum_{e \\in \\mathcal{E}_h} \\left( \\|\\nabla v_h^+\\|_{K^+}^2 + \\|\\nabla v_h^-\\|_{K^-}^2 \\right) = \\sum_{K \\in \\mathcal{T}_h} N_f(K) \\|\\nabla v_h\\|_K^2 \\leq N_f \\sum_{K \\in \\mathcal{T}_h} \\|\\nabla v_h\\|_K^2\n$$\n其中 $N_f(K)$ 是单元 $K$ 的面数，$N_f = \\max_K N_f(K)$。\n所以，我们得到界：\n$$\n\\sum_e \\eta_e \\|\\{\\partial_n v_h\\}\\|_e^2 \\leq \\frac{\\alpha C_{\\text{tr}} N_f}{2} \\sum_K \\|\\nabla v_h\\|_K^2\n$$\n将此代回 $a_h(v_h, v_h)$ 的不等式中：\n$$\na_h(v_h, v_h) \\geq \\left(1 - \\frac{\\alpha C_{\\text{tr}} N_f}{2}\\right) \\sum_K \\|\\nabla v_h\\|_K^2 + \\sum_e \\left(\\gamma \\frac{p^2}{h_e} - \\frac{p^2}{\\alpha h_e}\\right) \\|[v_h]\\|_e^2\n$$\n我们希望满足目标不等式：$a_h(v_h,v_h) \\geq \\frac{1}{2} \\sum_K \\|\\nabla v_h\\|_K^2 + \\frac{1}{2} \\sum_e \\sigma_e \\|[v_h]\\|_e^2$。\n这要求我们选择的 $\\alpha$ 满足两个条件：\n1) $1 - \\frac{\\alpha C_{\\text{tr}} N_f}{2} \\geq \\frac{1}{2} \\implies \\frac{1}{2} \\geq \\frac{\\alpha C_{\\text{tr}} N_f}{2} \\implies \\alpha \\leq \\frac{1}{C_{\\text{tr}} N_f}$。\n2) $\\gamma \\frac{p^2}{h_e} - \\frac{p^2}{\\alpha h_e} \\geq \\frac{1}{2} \\sigma_e = \\frac{\\gamma}{2}\\frac{p^2}{h_e} \\implies \\gamma - \\frac{1}{\\alpha} \\geq \\frac{\\gamma}{2} \\implies \\frac{\\gamma}{2} \\geq \\frac{1}{\\alpha} \\implies \\gamma \\geq \\frac{2}{\\alpha}$。\n为了找到最小的可接受 $\\gamma$，我们需要选择尽可能大的 $\\alpha$。从条件 1) 可知，最大值为 $\\alpha = \\frac{1}{C_{\\text{tr}} N_f}$。\n将这个最大的 $\\alpha$ 代入条件 2) 得到所需的最小 $\\gamma$：\n$$\n\\gamma \\geq \\frac{2}{1/(C_{\\text{tr}} N_f)} = 2 C_{\\text{tr}} N_f\n$$\n因此，罚参数常数的最小可接受下界为 $\\gamma_\\ast = 2 C_{\\text{tr}} N_f$。\n\n**4) 通过 Lax-Milgram 定理得到的适定性**\n\nLax-Milgram 定理指出，对于一个希尔伯特空间 $H$ 上的变分问题 $a(u,v) = L(v)$ 对所有 $v \\in H$ 成立，如果双线性形式 $a(\\cdot, \\cdot)$ 在 $H$ 上是连续和矫顽的，且线性泛函 $L(\\cdot)$ 在 $H$ 上是连续的，那么该问题存在唯一解 $u \\in H$。\n\n对于 SIPG 方法，希尔伯特空间是 $H = V_h$，赋以网格相关范数 $\\|\\cdot\\|_{1,h}$。双线性形式是 $a_h(\\cdot, \\cdot)$，线性泛函是 $L(v_h) = \\int_{\\Omega} f v_h \\mathrm{d}x$。\n\n在步骤 3) 中，我们证明了对于 $\\gamma \\ge \\gamma_*$，$a_h(\\cdot, \\cdot)$ 是矫顽的。具体来说，我们证明了\n$a_h(v_h, v_h) \\geq \\frac{1}{2} \\sum_K \\|\\nabla v_h\\|_K^2 + \\frac{1}{2} \\sum_e \\sigma_e \\|[v_h]\\|_e^2$。\n使用 $\\sigma_e = \\gamma \\frac{p^2}{h_e}$，这等于\n$a_h(v_h, v_h) \\geq \\frac{1}{2} \\sum_K \\|\\nabla v_h\\|_K^2 + \\frac{\\gamma}{2} \\sum_e \\frac{p^2}{h_e} \\|[v_h]\\|_e^2 \\geq \\min\\left(\\frac{1}{2}, \\frac{\\gamma}{2}\\right) \\|v_h\\|_{1,h}^2$。\n由于 $\\gamma \\ge \\gamma_* = 2C_{\\text{tr}}N_f  0$，矫顽常数 $\\min(\\frac{1}{2}, \\frac{\\gamma}{2})$ 是正的。\n\n$a_h(\\cdot, \\cdot)$ 的连续性，即 $|a_h(u_h, v_h)| \\leq C \\|u_h\\|_{1,h}\\|v_h\\|_{1,h}$ 对于某个 $C  0$ 成立，也可以通过使用柯西-施瓦茨不等式和相同的迹不等式来建立。$a_h$ 定义中的每一项都可被由 $\\|u_h\\|_{1,h}$ 和 $\\|v_h\\|_{1,h}$ 控制的范数乘积所界定。\n\n最后，线性泛函 $L(v_h)$ 的连续性通过柯西-施瓦茨不等式和离散的庞加莱-弗里德里希不等式来证明，后者保证了 $\\|v_h\\|_{L^2(\\Omega)}$ 被 $\\|v_h\\|_{1,h}$ 所界定，这是因为 SIPG 格式弱施加了齐次狄利克雷边界条件。\n\n由于 Lax-Milgram 定理的所有条件都得到满足，因此保证了 SIPG 解 $u_h \\in V_h$ 的存在性和唯一性。", "answer": "$$\\boxed{2 C_{\\mathrm{tr}} N_{f}}$$", "id": "3395438"}, {"introduction": "最后一个实践通过探索Lax-Milgram定理与Riesz表示定理之间的深刻联系，架起了理论与计算之间的桥梁。你将实现一个谱方法，以数值方式验证变分问题的解确实是在由双线性形式定义的能量内积中，右端项泛函的Riesz表示。这项计算练习为理解有限元和谱方法背后的抽象几何结构提供了具体而直观的途径。", "problem": "考虑在实区间 $[-1,1]$ 上的变分问题，其 Hilbert 空间为 $V = H_0^1(-1,1)$，配备了由下式定义的双线性形式 $a(\\cdot,\\cdot)$\n$$\na(u,v) = \\int_{-1}^1 \\left( \\alpha(x)\\, u'(x)\\, v'(x) + \\beta(x)\\, u(x)\\, v(x) \\right)\\, dx,\n$$\n其中 $\\alpha(x)$ 和 $\\beta(x)$ 是给定的实值函数，且对于所有 $x \\in [-1,1]$ 满足 $\\alpha(x) \\ge \\alpha_0  0$ 和 $\\beta(x) \\ge 0$。设 $f \\in V^\\ast$ 是一个有界线性泛函，由函数 $g(x)$ 通过下式指定\n$$\nf(v) = \\int_{-1}^1 g(x)\\, v(x)\\, dx.\n$$\n根据 Lax–Milgram 定理和 Riesz 表示定理，对于对称且强制的双线性形式 $a(\\cdot,\\cdot)$，问题\n$$\na(u,v) = f(v) \\quad \\text{for all } v \\in V\n$$\n的唯一解 $u \\in V$ 可以被视为 $f$ 在能量内积 $a(\\cdot,\\cdot)$ 下的 Riesz 表示，即 $u = R^{-1} f$，其中 $R: V \\to V^\\ast$ 是由 $a(\\cdot,\\cdot)$ 导出的 Riesz 同构。\n\n您的任务是在谱 Galerkin 方法和不连续 Galerkin 方法的框架内，使用以下有限维子空间，对此观点进行数值探究。令 $\\{L_n(x)\\}_{n\\ge 0}$ 表示区间 $[-1,1]$ 上的 Legendre 多项式。定义满足齐次 Dirichlet 边界条件的多项式基为\n$$\n\\phi_n(x) = L_{n+1}(x) - L_{n-1}(x), \\quad n = 1,2,\\dots,N,\n$$\n该基满足 $\\phi_n(\\pm 1) = 0$，并取 $V_N = \\operatorname{span}\\{\\phi_1,\\dots,\\phi_N\\} \\subset V$。您将对双线性形式 $a(\\cdot,\\cdot)$ 和线性泛函 $f(\\cdot)$ 在 $V_N$ 上进行离散化，并构造一个关于 $a(\\cdot,\\cdot)$ 正交的谱基，以检验 Riesz 表示结构。\n\n您可以假定的基础知识：\n- Hilbert 空间、双线性形式和内积的定义。\n- 关于 Hilbert 空间上对称、有界、强制双线性形式的 Lax–Milgram 定理。\n- Riesz 表示定理以及 Riesz 同构的概念。\n\n您必须为每个测试用例实现以下数值步骤：\n1. 组装 Gram 矩阵 $G \\in \\mathbb{R}^{N \\times N}$，其元素为 $G_{ij} = a(\\phi_i,\\phi_j)$。\n2. 组装关于 $H^1$ 内积 $(u,v)_V = \\int_{-1}^1 \\left(u'(x) v'(x) + u(x) v(x)\\right)\\, dx$ 的 Hilbert 空间 Gram 矩阵 $S \\in \\mathbb{R}^{N \\times N}$，其元素为 $S_{ij} = (\\phi_i,\\phi_j)_V$。\n3. 组装载荷向量 $F \\in \\mathbb{R}^N$，其元素为 $F_i = f(\\phi_i) = \\int_{-1}^1 g(x)\\, \\phi_i(x)\\, dx$。\n4. 通过计算一个线性变换 $U \\in \\mathbb{R}^{N \\times N}$ 来构造一个关于 $a(\\cdot,\\cdot)$ 正交的谱基 $\\{\\psi_j\\}_{j=1}^N$，使得\n$$\n\\psi_j = \\sum_{i=1}^N U_{ij}\\, \\phi_i, \\quad \\text{且} \\quad a(\\psi_i,\\psi_j) = \\delta_{ij}。\n$$\n5. 计算以下诊断量：\n   - 能量内积中的正交性误差，\n     $$\n     \\delta = \\|U^\\top G U - I\\|_2,\n     $$\n     其中 $\\|\\cdot\\|_2$ 是谱范数，$I$ 是大小为 $N$ 的单位矩阵。\n   - Riesz 表示系数一致性误差。令 $c^{(1)} \\in \\mathbb{R}^N$ 为离散变分问题 $G c^{(1)} = F$ 在基 $\\{\\phi_i\\}$ 下的解。令 $c^{(2)} = U \\left(U^\\top F\\right)$。报告\n     $$\n     \\varepsilon = \\frac{\\|c^{(1)} - c^{(2)}\\|_2}{\\|c^{(1)}\\|_2}。\n     $$\n   - 能量正交基中的变分残差，\n     $$\n     \\rho = \\|U^\\top (G c^{(1)} - F)\\|_2。\n     $$\n   - 在 $V_N$ 上，关于 $H^1$ 内积范数的双线性形式 $a(\\cdot,\\cdot)$ 的离散强制性常数和连续性常数，估计为矩阵对 $(G,S)$ 的极端广义特征值：\n     $$\n     \\alpha_N = \\min_{\\mathbf{c}\\neq 0} \\frac{\\mathbf{c}^\\top G \\mathbf{c}}{\\mathbf{c}^\\top S \\mathbf{c}}, \\qquad\n     L_N = \\max_{\\mathbf{c}\\neq 0} \\frac{\\mathbf{c}^\\top G \\mathbf{c}}{\\mathbf{c}^\\top S \\mathbf{c}}。\n     $$\n6. 使用足够高阶的 Gauss–Legendre 求积来近似计算 $[-1,1]$ 上的所有积分。所有三角函数必须使用弧度制角度。\n\n测试套件：\n对以下四个测试用例实现上述步骤，每个用例由 $(N,\\alpha(x),\\beta(x),g(x))$ 指定：\n- 案例 A (理想情况): $N=8$, $\\alpha(x) = 1 + \\tfrac{1}{2} x^2$, $\\beta(x) = 1$, $g(x) = \\sin(\\pi x) + x$。\n- 案例 B (小维度；刚度主导): $N=2$, $\\alpha(x) = 1$, $\\beta(x) = 0$, $g(x) = 1 - x^2$。\n- 案例 C (高对比度系数): $N=12$, $\\alpha(x) = 2 + 10 x^2$, $\\beta(x) = 0.1 + 0.5 x^2$, $g(x) = e^{x}$。\n- 案例 D (振荡系数和数据): $N=10$, $\\alpha(x) = 1 + 0.2 \\cos(3\\pi x)$, $\\beta(x) = 0.5$, $g(x) = \\cos(2\\pi x)$。\n\n要求的最终输出格式：\n- 您的程序应生成单行输出，其中包含一个由四个列表组成的逗号分隔列表，每个列表对应一个测试用例，顺序为 A、B、C、D。每个内部列表必须按顺序 $[\\delta,\\varepsilon,\\rho,\\alpha_N,L_N]$ 包含五个浮点数。\n- 例如，打印的字符串必须如下所示\n$$\n\\texttt{[[dA,eA,rA,aA,LA],[dB,eB,rB,aB,LB],[dC,eC,rC,aC,LC],[dD,eD,rD,aD,LD]]}\n$$\n并用实际数值替换。本问题不涉及物理单位，所有角度均为弧度。", "solution": "问题陈述是数值分析领域中一个有效且适定的练习，特别是在使用谱 Galerkin 方法求解椭圆偏微分方程方面。它要求通过数值实现来探究变分问题的解与 Riesz 表示定理之间的联系。所有给定的数据和定义在数学上和科学上都是合理的。我们开始求解。\n\n问题的核心是找到变分方程\n$$\na(u,v) = f(v) \\quad \\text{for all } v \\in V,\n$$\n的解 $u \\in V = H_0^1(-1,1)$ 的一个数值近似解，其中双线性形式 $a(\\cdot,\\cdot)$ 和线性泛函 $f(\\cdot)$ 由下式给出\n$$\na(u,v) = \\int_{-1}^1 \\left( \\alpha(x)\\, u'(x)\\, v'(x) + \\beta(x)\\, u(x)\\, v(x) \\right)\\, dx,\n$$\n$$\nf(v) = \\int_{-1}^1 g(x)\\, v(x)\\, dx.\n$$\n条件 $\\alpha(x) \\ge \\alpha_0  0$ 和 $\\beta(x) \\ge 0$ 确保了 $a(\\cdot,\\cdot)$ 是 $V$ 上的一个对称、强制且有界的双线性形式。强制性可由 $H_0^1(-1,1)$ 上的 Poincaré 不等式得出，这使得 $a(\\cdot,\\cdot)$ 成为一个内积，称为能量内积。解 $u$ 的存在性和唯一性由 Lax–Milgram 定理保证。\n\n我们采用谱 Galerkin 方法，在有限维子空间 $V_N \\subset V$ 中寻找近似解 $u_N$。子空间 $V_N$ 由一组满足齐次 Dirichlet 边界条件的 $N$ 个基函数 $\\{\\phi_n\\}_{n=1}^N$ 张成。所选的基为\n$$\n\\phi_n(x) = L_{n+1}(x) - L_{n-1}(x), \\quad n=1, \\dots, N,\n$$\n其中 $L_k(x)$ 是 $k$ 次 Legendre 多项式。性质 $L_k(\\pm 1) = (\\pm 1)^k$ 确保了对所有 $n \\ge 1$ 都有 $\\phi_n(\\pm 1) = 0$，因此 $V_N \\subset H_0^1(-1,1)$。计算中的一个关键性质是这些基函数导数的简单形式，这可以从 Legendre 多项式的一个标准递推关系得出：\n$$\n\\phi_n'(x) = \\frac{d}{dx}\\left(L_{n+1}(x) - L_{n-1}(x)\\right) = (2n+1)L_n(x).\n$$\n此简化对 $n \\ge 1$ 成立。对于 $n=1$，它依赖于将基函数解释为 $\\phi_1(x) = L_2(x)-L_0(x)$，这与导数公式是一致的。\n\n近似解写为基函数的线性组合，$u_N(x) = \\sum_{j=1}^N c_j \\phi_j(x)$。将此代入变分问题，并选择基函数自身作为测试函数，$v = \\phi_i(x)$ for $i=1,\\dots,N$，我们得到 Galerkin 线性方程组：\n$$\n\\sum_{j=1}^N a(\\phi_j, \\phi_i) c_j = f(\\phi_i), \\quad i=1,\\dots,N.\n$$\n这是一个矩阵系统 $G \\mathbf{c}^{(1)} = F$，其中 $\\mathbf{c}^{(1)} \\in \\mathbb{R}^N$ 是未知系数向量，$G \\in \\mathbb{R}^{N \\times N}$ 是 Gram 矩阵（或刚度矩阵），$F \\in \\mathbb{R}^N$ 是载荷向量。它们的元素由下式给出：\n$$\nG_{ij} = a(\\phi_i, \\phi_j) = \\int_{-1}^1 \\left( \\alpha(x) \\phi_i'(x) \\phi_j'(x) + \\beta(x) \\phi_i(x) \\phi_j(x) \\right) dx,\n$$\n$$\nF_i = f(\\phi_i) = \\int_{-1}^1 g(x) \\phi_i(x) dx.\n$$\n问题对基函数和矩阵元素使用从1开始的索引。在实现中，我们对数组使用从0开始的索引，因此矩阵元素 $(i,j)$ 将对应于基函数 $\\phi_{i+1}$ 和 $\\phi_{j+1}$。\n\n定义 $G$ 和 $F$ 的积分涉及非多项式函数 $\\alpha(x)$、$\\beta(x)$ 和 $g(x)$，并使用 Gauss-Legendre 求积进行数值计算。一个具有 $Q$ 个节点和权重 $\\{w_k, x_k\\}_{k=1}^Q$ 的求积法则将积分近似为 $\\int_{-1}^1 h(x) dx \\approx \\sum_{k=1}^Q h(x_k) w_k$。为确保高精度，节点数 $Q$ 的选择要足够大，例如 $Q  2(N+1)$，以精确处理被积函数的多项式部分。\n\n中心任务是将 $G \\mathbf{c}^{(1)} = F$ 的直接解与 Riesz 表示的观点联系起来。根据 Riesz 表示定理，解 $u$ 是 $V$ 中唯一的元素，满足对所有 $v \\in V$ 都有 $a(u,v) = f(v)$。这意味着 $u$ 是泛函 $f$ 关于能量内积 $a(\\cdot,\\cdot)$ 的 Riesz 表示。为了在数值上验证这一点，我们为 $V_N$ 构造一个关于 $a(\\cdot,\\cdot)$ 正交的基 $\\{\\psi_j\\}_{j=1}^N$。令每个新基函数是旧基函数的线性组合：$\\psi_j = \\sum_{i=1}^N U_{ij} \\phi_i$。正交条件 $a(\\psi_i, \\psi_j) = \\delta_{ij}$ 施加了矩阵条件 $U^\\top G U = I$，其中 $U$ 是基变换矩阵。由于 $G$ 是对称正定的，这样的矩阵 $U$ 可以通过 $G$ 的特征值分解 $G = Q \\Lambda Q^\\top$ 来构造，其中 $Q$ 是正交矩阵，$\\Lambda$ 是具有正特征值的对角矩阵。变换矩阵为 $U = Q \\Lambda^{-1/2}$。\n\n在这个正交基下，解 $u_N$ 可以表示为 $u_N = \\sum_{j=1}^N d_j \\psi_j$。系数 $d_j$ 就是泛函 $f$ 在新基向量上的取值：$d_j = f(\\psi_j)$。以向量形式表示，$\\mathbf{d} = U^\\top F$。为了获得在原始基 $\\{\\phi_i\\}$ 下的系数，我们进行逆变换：$\\mathbf{c}^{(2)} = U \\mathbf{d} = U(U^\\top F)$。在数学上，$G^{-1} = UU^\\top$，因此 $\\mathbf{c}^{(1)} = G^{-1}F$ 和 $\\mathbf{c}^{(2)} = UU^\\top F$ 必须是相同的。数值诊断量评估了这种等价性的保真度。\n\n所需的计算如下：\n1.  **Gram 矩阵和载荷向量**：使用数值求积组装矩阵 $G, S$ 和向量 $F$。$S$ 是标准 $H^1$ 内积的 Gram 矩阵，即 $\\alpha(x)=1, \\beta(x)=1$ 的情况。\n2.  **正交基**：通过 $G$ 的特征分解计算 $U$。\n3.  **诊断量**：\n    - $\\delta = \\|U^\\top G U - I\\|_2$：这衡量了构造正交化变换 $U$ 时的数值误差。它应该接近于机器精度。\n    - $\\varepsilon = \\frac{\\|\\mathbf{c}^{(1)} - \\mathbf{c}^{(2)}\\|_2}{\\|\\mathbf{c}^{(1)}\\|_2}$：这将直接求解线性系统得到的系数向量 $\\mathbf{c}^{(1)} = G^{-1}F$ 与通过 Riesz 表示程序获得的系数向量 $\\mathbf{c}^{(2)} = UU^\\top F$ 进行比较。这展示了两种方法的数值等价性。\n    - $\\rho = \\|U^\\top (G \\mathbf{c}^{(1)} - F)\\|_2$：这是线性系统残差的范数，投影到能量正交基上。由于 $G \\mathbf{c}^{(1)} - F$ 理想情况下为零（在线性求解的数值精度范围内），$\\rho$ 应该非常小。\n    - $\\alpha_N, L_N$：这些是子空间 $V_N$ 上双线性形式 $a(\\cdot,\\cdot)$ 关于 $H^1$ 范数的离散强制性常数和连续性常数。它们通过计算矩阵对 $(G,S)$ 的最小和最大广义特征值得到，对应于 Rayleigh 商 $\\frac{\\mathbf{v}^\\top G \\mathbf{v}}{\\mathbf{v}^\\top S \\mathbf{v}} = \\frac{a(v_N, v_N)}{\\|v_N\\|_{H^1}^2}$ 对 $v_N \\in V_N$ 的极值。这些常数在 Galerkin 方法的先验误差分析中至关重要。", "answer": "```python\nimport numpy as np\nimport scipy.special\nimport scipy.linalg\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print the results.\n    \"\"\"\n\n    def compute_diagnostics(N, alpha_func, beta_func, g_func):\n        \"\"\"\n        Performs the numerical tasks for a single test case.\n        \n        Args:\n            N (int): The dimension of the polynomial subspace.\n            alpha_func (callable): The function alpha(x).\n            beta_func (callable): The function beta(x).\n            g_func (callable): The function g(x).\n            \n        Returns:\n            list: A list of five floats: [delta, epsilon, rho, alpha_N, L_N].\n        \"\"\"\n        # 1. Setup Quadrature\n        # A quadrature rule of degree Q is exact for polynomials of degree 2Q-1.\n        # The highest polynomial degree in integrands is roughly 2*(N+1).\n        # We need 2Q-1 = 2N+2, so Q = N+1.5. A much safer choice is used.\n        Q = 3 * N + 2\n        x_q, w_q = np.polynomial.legendre.leggauss(Q)\n\n        # 2. Evaluate Basis Functions and derivatives at quadrature points\n        L_vals = np.zeros((Q, N + 2))\n        for k in range(N + 2):\n            L_vals[:, k] = scipy.special.eval_legendre(k, x_q)\n\n        PHI = np.zeros((Q, N))\n        DPHI = np.zeros((Q, N))\n        for i in range(N):\n            n = i + 1  # Basis functions are indexed from n=1 to N\n            # phi_n(x) = L_{n+1}(x) - L_{n-1}(x)\n            # For n=1, phi_1(x) = L_2(x) - L_0(x)\n            PHI[:, i] = L_vals[:, n + 1] - L_vals[:, n - 1]\n            \n            # phi'_n(x) = (2n+1)L_n(x)\n            DPHI[:, i] = (2 * n + 1) * L_vals[:, n]\n\n        # Evaluate coefficient functions at quadrature points\n        alpha_vals = alpha_func(x_q)\n        beta_vals = beta_func(x_q)\n        g_vals = g_func(x_q)\n\n        # 3. Assemble G, S, and F using vectorized operations\n        G = DPHI.T @ np.diag(w_q * alpha_vals) @ DPHI + PHI.T @ np.diag(w_q * beta_vals) @ PHI\n        S = DPHI.T @ np.diag(w_q) @ DPHI + PHI.T @ np.diag(w_q) @ PHI\n        F = PHI.T @ (w_q * g_vals)\n\n        # 4. Form the a-orthonormal basis transformation U\n        eigvals_G, eigvecs_G = scipy.linalg.eigh(G)\n        \n        # Guard against non-positive eigenvalues from numerical error\n        if np.any(eigvals_G = 0):\n             eigvals_G[eigvals_G = 0] = np.finfo(float).eps\n\n        Lambda_inv_sqrt = np.diag(1.0 / np.sqrt(eigvals_G))\n        U = eigvecs_G @ Lambda_inv_sqrt\n\n        # 5. Compute diagnostics\n        # Orthonormality defect delta\n        I = np.identity(N)\n        delta = np.linalg.norm((U.T @ G @ U) - I, ord=2)\n\n        # Riesz-representer consistency defect epsilon\n        c1 = scipy.linalg.solve(G, F, assume_a='pos')\n        c2 = U @ (U.T @ F)\n        norm_c1 = np.linalg.norm(c1, ord=2)\n        if norm_c1  1e-15:\n            epsilon = np.linalg.norm(c1 - c2, ord=2)\n        else:\n            epsilon = np.linalg.norm(c1 - c2, ord=2) / norm_c1\n        \n        # Variational residual rho\n        residual = G @ c1 - F\n        rho = np.linalg.norm(U.T @ residual, ord=2)\n\n        # Discrete coercivity and continuity constants alpha_N, L_N\n        gen_eigvals = scipy.linalg.eigh(G, S, eigvals_only=True)\n        alpha_N = gen_eigvals[0]\n        L_N = gen_eigvals[-1]\n\n        return [delta, epsilon, rho, alpha_N, L_N]\n\n    test_cases = [\n        # Case A: N=8, alpha(x)=1+0.5x^2, beta(x)=1, g(x)=sin(pi*x)+x\n        {'N': 8, 'alpha': lambda x: 1 + 0.5 * x**2, 'beta': lambda x: 1.0, 'g': lambda x: np.sin(np.pi * x) + x},\n        # Case B: N=2, alpha(x)=1, beta(x)=0, g(x)=1-x^2\n        {'N': 2, 'alpha': lambda x: 1.0, 'beta': lambda x: 0.0, 'g': lambda x: 1 - x**2},\n        # Case C: N=12, alpha(x)=2+10x^2, beta(x)=0.1+0.5x^2, g(x)=e^x\n        {'N': 12, 'alpha': lambda x: 2 + 10 * x**2, 'beta': lambda x: 0.1 + 0.5 * x**2, 'g': lambda x: np.exp(x)},\n        # Case D: N=10, alpha(x)=1+0.2cos(3pi*x), beta(x)=0.5, g(x)=cos(2pi*x)\n        {'N': 10, 'alpha': lambda x: 1 + 0.2 * np.cos(3 * np.pi * x), 'beta': lambda x: 0.5, 'g': lambda x: np.cos(2 * np.pi * x)}\n    ]\n    \n    results = []\n    for case in test_cases:\n        res = compute_diagnostics(case['N'], case['alpha'], case['beta'], case['g'])\n        results.append(res)\n    \n    # Format the final output string as specified: [[...],[...],...]\n    print(str(results).replace(' ', ''))\n\nsolve()\n```", "id": "3395440"}]}