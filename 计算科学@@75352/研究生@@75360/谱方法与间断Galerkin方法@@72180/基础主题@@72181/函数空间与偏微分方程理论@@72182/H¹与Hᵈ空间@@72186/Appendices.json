{"hands_on_practices": [{"introduction": "理解$H(\\mathrm{div})$和$H(\\mathrm{curl})$空间的精髓，始于认识它们与区域拓扑结构之间深刻的内在联系。本练习旨在通过在一个多连通区域上构造一个非平凡的“调和场”，来揭示这些空间独特的结构。我们将通过这个具体的例子 [@problem_id:3389501] 发现，这些场既不是梯度场也不是旋度场，这正是$H(\\mathrm{div})$和$H(\\mathrm{curl})$空间能够捕捉到的、超出简单向量微积分框架的重要特征。", "problem": "设 $\\Omega \\subset \\mathbb{R}^{3}$ 为一个同轴圆柱环域，在柱坐标 $(r,\\theta,z)$ 中定义为 $\\Omega = \\{(r,\\theta,z): a < r < b, 0 < z < L\\}$。构造一个非零的调和场 $\\mathbf{u}$（即无旋且无散），它不是任何单值标量势的梯度。最后，计算将该场的 $L²$ 范数归一化为 1 所需的乘法常数。", "solution": "我们寻找一个形式为 $\\mathbf{u} = f(r) \\mathbf{e}_\\theta$ 的向量场，并按步骤验证其性质。\n\n1.  **构造场并验证调和性**：在柱坐标系中，对于一个仅有角向分量且该分量仅依赖于 $r$ 的场 $\\mathbf{u} = f(r) \\mathbf{e}_\\theta$，其散度和旋度分别为：\n    $$ \\nabla \\cdot \\mathbf{u} = 0 $$\n    $$ \\nabla \\times \\mathbf{u} = \\frac{1}{r}\\frac{d(r f(r))}{dr} \\mathbf{e}_z $$\n    该场自然无散。为了使其无旋（即成为调和场），我们需要 $\\frac{d(r f(r))}{dr} = 0$。这表明 $r f(r) = C$（一个非零常数）。因此，$f(r) = C/r$。我们选择的基础场是 $\\mathbf{u}_0 = (1/r) \\mathbf{e}_\\theta$。该场在 $\\Omega$ 内是光滑的，且无旋、无散，因此是调和场。\n\n2.  **验证非梯度性质**：为了检验它是否为梯度场，我们计算其在一个封闭环路上的积分，例如在 $z=z₀$ 平面上绕 z 轴的圆周 $C$。路径微元为 $d\\mathbf{l} = r d\\theta \\mathbf{e}_\\theta$。\n    $$ \\oint_C \\mathbf{u}_0 \\cdot d\\mathbf{l} = \\int_0^{2\\pi} \\left(\\frac{1}{r}\\mathbf{e}_\\theta\\right) \\cdot (r d\\theta \\mathbf{e}_\\theta) = \\int_0^{2\\pi} d\\theta = 2\\pi $$\n    由于积分结果非零，根据斯托克斯定理，该场不可能是任何单值标量势的梯度。\n\n3.  **空间归属**：场 $\\mathbf{u}_0$ 及其（为零的）旋度和散度在 $\\Omega$ 上都是平方可积的，因为 $\\int_a^b (1/r)^2 r dr = \\int_a^b 1/r dr = \\ln(b/a)$ 是有限的。因此 $\\mathbf{u}_0 \\in H(\\mathrm{curl},\\Omega) \\cap H(\\mathrm{div},\\Omega)$。\n\n4.  **计算归一化常数**：我们需要找到一个常数 $c$，使得 $\\mathbf{u} = c \\mathbf{u}_0$ 的 $L²$ 范数为 1。我们计算 $\\mathbf{u}_0$ 的 $L²$ 范数平方：\n    $$ \\| \\mathbf{u}_0 \\|^2_{L^2(\\Omega)} = \\int_0^L \\int_0^{2\\pi} \\int_a^b \\left|\\frac{1}{r}\\mathbf{e}_\\theta\\right|^2 \\, r \\, dr \\, d\\theta \\, dz = \\int_0^L dz \\int_0^{2\\pi} d\\theta \\int_a^b \\frac{1}{r} \\, dr $$\n    $$ = (L) \\cdot (2\\pi) \\cdot [\\ln r]_a^b = 2\\pi L \\ln(b/a) $$\n    因此，$\\|c \\mathbf{u}_0 \\|^2 = c^2 (2\\pi L \\ln(b/a)) = 1$。求解 $c$ 得到：\n    $$ c = \\frac{1}{\\sqrt{2\\pi L \\ln(b/a)}} $$\n    最终的归一化常数即为该值。", "answer": "$$\\boxed{\\frac{1}{\\sqrt{2\\pi L \\ln\\left(\\frac{b}{a}\\right)}}}$$", "id": "3389501"}, {"introduction": "在理论探索之后，我们将注意力转向这些空间的实际应用，特别是在偏微分方程的数值解法中。为了确保数值方法的稳定性和收敛性，$H(\\mathrm{div})$和$H(\\mathrm{curl})$空间必须满足特定的兼容性条件，其中最著名的便是“inf-sup”或LBB（Ladyzhenskaya-Babuška-Brezzi）条件。在本练习 [@problem_id:3389502] 中，你将为一个经典的混合有限元配对，从第一性原理出发，推导这个关键的inf-sup常数，从而深入理解保证数值方法稳定性的核心数学机制。", "problem": "考虑在谱方法和间断伽辽金 (DG) 方法中使用的混合有限元配对，该配对作用于二维参考单元 $\\hat{K} = [-1,1]^{2}$。设 $\\hat{V} \\subset H(\\mathrm{div};\\hat{K})$ 为 $\\hat{K}$ 上的最低阶 Raviart–Thomas 空间，由形如 $\\mathbf{v}(x,y) = (a_{1} + b_{1} x, a_{2} + b_{2} y)$ 的矢量场构成，其中 $a_{1}, a_{2}, b_{1}, b_{2} \\in \\mathbb{R}$。设 $\\hat{Q} \\subset L^{2}(\\hat{K})$ 为 $\\hat{K}$ 上的常数空间。定义双线性形式 $b : \\hat{V} \\times \\hat{Q} \\to \\mathbb{R}$ 为\n$$\nb(\\mathbf{v},q) = -\\int_{\\hat{K}} (\\nabla \\cdot \\mathbf{v})\\, q \\, \\mathrm{d}x,\n$$\n并定义范数\n$$\n\\|\\mathbf{v}\\|_{H(\\mathrm{div};\\hat{K})}^{2} = \\|\\mathbf{v}\\|_{0,\\hat{K}}^{2} + \\|\\nabla \\cdot \\mathbf{v}\\|_{0,\\hat{K}}^{2}, \\qquad \\|q\\|_{0,\\hat{K}}^{2} = \\int_{\\hat{K}} q^{2} \\, \\mathrm{d}x.\n$$\n参考单元上相关的 inf-sup 常数为\n$$\n\\beta_{\\hat{K}} = \\inf_{q \\in \\hat{Q} \\setminus \\{0\\}} \\ \\sup_{\\mathbf{v} \\in \\hat{V} \\setminus \\{0\\}} \\ \\frac{|b(\\mathbf{v},q)|}{\\|\\mathbf{v}\\|_{H(\\mathrm{div};\\hat{K})}\\, \\|q\\|_{0,\\hat{K}}}.\n$$\n\n从 $H(\\mathrm{div})$、Raviart–Thomas 空间以及上述双线性形式和范数的定义出发，推导在 $\\hat{K}$ 上配对 $(\\hat{V},\\hat{Q})$ 的 $\\beta_{\\hat{K}}$ 的精确值。您的推导必须从第一性原理出发，通过计算必要的积分并对 $\\hat{V}$ 和 $\\hat{Q}$ 中的自由度优化所得表达式。\n\n计算出 $\\beta_{\\hat{K}}$ 后，从第一性原理简要论证如何获得更高阶 Raviart–Thomas 空间 $\\mathrm{RT}_{k}(\\hat{K})$ 与同一参考单元上次数为 $k$ 的多项式压力配对的 inf-sup 常数的下界，并定性讨论该常数在仿射 Piola 映射下如何变换到一个物理单元 $K$（其雅可比矩阵为 $A$），强调其对多项式次数和由 $A$ 与 $A^{-1}$ 的算子范数量化的网格形状正则性的依赖性（或独立性）。\n\n将最终计算出的 $\\beta_{\\hat{K}}$ 值表示为精确的解析表达式。无需四舍五入。", "solution": "### 第 1 部分：$\\beta_{\\hat{K}}$ 的推导\n\n我们首先计算 inf-sup 常数表达式中的各项。设 $\\mathbf{v} \\in \\hat{V}$ 和 $q \\in \\hat{Q}$ 为任意非零元素。\n$\\mathbf{v}(x,y) = (a_{1} + b_{1} x, a_{2} + b_{2} y)$，其中 $a_1, a_2, b_1, b_2$ 为实系数。\n$q(x,y) = c$，其中 $c \\neq 0$ 为实常数。\n\n$\\mathbf{v}$ 的散度为：\n$$\n\\nabla \\cdot \\mathbf{v} = \\frac{\\partial}{\\partial x}(a_1 + b_1 x) + \\frac{\\partial}{\\partial y}(a_2 + b_2 y) = b_1 + b_2\n$$\n散度在 $\\hat{K}$ 上是常数。参考单元 $\\hat{K}$ 的面积为 $\\mathrm{meas}(\\hat{K}) = 2 \\times 2 = 4$。\n\n现在我们计算商中的各项：\n1.  **双线性形式 $b(\\mathbf{v},q)$**：\n    $$\n    b(\\mathbf{v},q) = -\\int_{\\hat{K}} (\\nabla \\cdot \\mathbf{v}) q \\, \\mathrm{d}x\\mathrm{d}y = -\\int_{[-1,1]^2} (b_1 + b_2) c \\, \\mathrm{d}x\\mathrm{d}y = -c(b_1+b_2) \\cdot \\mathrm{meas}(\\hat{K}) = -4c(b_1+b_2)\n    $$\n    因此， $|b(\\mathbf{v},q)| = 4|c||b_1+b_2|$。\n\n2.  **$q$ 的范数**：\n    $$\n    \\|q\\|_{0,\\hat{K}}^2 = \\int_{\\hat{K}} q^2 \\, \\mathrm{d}x\\mathrm{d}y = \\int_{[-1,1]^2} c^2 \\, \\mathrm{d}x\\mathrm{d}y = c^2 \\cdot \\mathrm{meas}(\\hat{K}) = 4c^2\n    $$\n    因此， $\\|q\\|_{0,\\hat{K}} = 2|c|$。\n\n3.  **$\\mathbf{v}$ 的范数**：\n    $\\|\\mathbf{v}\\|_{H(\\mathrm{div};\\hat{K})}^{2} = \\|\\mathbf{v}\\|_{0,\\hat{K}}^{2} + \\|\\nabla \\cdot \\mathbf{v}\\|_{0,\\hat{K}}^{2}$。\n    首先是散度范数项：\n    $$\n    \\|\\nabla \\cdot \\mathbf{v}\\|_{0,\\hat{K}}^{2} = \\int_{\\hat{K}} (\\nabla \\cdot \\mathbf{v})^2 \\, \\mathrm{d}x\\mathrm{d}y = \\int_{[-1,1]^2} (b_1+b_2)^2 \\, \\mathrm{d}x\\mathrm{d}y = (b_1+b_2)^2 \\cdot \\mathrm{meas}(\\hat{K}) = 4(b_1+b_2)^2\n    $$\n    接下来是 $\\mathbf{v}$ 的 $L^2$-范数：\n    $$\n    \\|\\mathbf{v}\\|_{0,\\hat{K}}^{2} = \\int_{\\hat{K}} |\\mathbf{v}|^2 \\, \\mathrm{d}x\\mathrm{d}y = \\int_{-1}^{1}\\int_{-1}^{1} \\left( (a_1+b_1x)^2 + (a_2+b_2y)^2 \\right) \\, \\mathrm{d}x\\mathrm{d}y\n    $$\n    这两项是可分离的。我们计算第一部分：\n    $$\n    \\int_{-1}^{1}\\int_{-1}^{1} (a_1+b_1x)^2 \\, \\mathrm{d}x\\mathrm{d}y = \\int_{-1}^{1} \\left[ \\int_{-1}^{1} (a_1^2 + 2a_1b_1x + b_1^2x^2) \\, \\mathrm{d}x \\right] \\, \\mathrm{d}y\n    $$\n    内层积分为 $[a_1^2x + a_1b_1x^2 + \\frac{b_1^2}{3}x^3]_{-1}^{1} = (2a_1^2 + \\frac{2}{3}b_1^2)$。\n    外层积分为 $\\int_{-1}^{1} (2a_1^2 + \\frac{2}{3}b_1^2) \\, \\mathrm{d}y = 2(2a_1^2 + \\frac{2}{3}b_1^2) = 4a_1^2 + \\frac{4}{3}b_1^2$。\n    根据对称性，第二项的积分为 $4a_2^2 + \\frac{4}{3}b_2^2$。\n    所以，$\\|\\mathbf{v}\\|_{0,\\hat{K}}^{2} = 4a_1^2 + 4a_2^2 + \\frac{4}{3}b_1^2 + \\frac{4}{3}b_2^2$。\n    将各部分合并，$\\mathbf{v}$ 的完整范数为：\n    $$\n    \\|\\mathbf{v}\\|_{H(\\mathrm{div};\\hat{K})}^{2} = \\left( 4a_1^2 + 4a_2^2 + \\frac{4}{3}b_1^2 + \\frac{4}{3}b_2^2 \\right) + 4(b_1+b_2)^2\n    $$\n\n现在，我们构建商并简化。由于 $q \\neq 0$，则 $c \\neq 0$，它可以从分子和分母中消去：\n$$\n\\frac{|b(\\mathbf{v},q)|}{\\|\\mathbf{v}\\|_{H(\\mathrm{div};\\hat{K})}\\, \\|q\\|_{0,\\hat{K}}} = \\frac{4|c||b_1+b_2|}{\\sqrt{4a_1^2 + 4a_2^2 + \\frac{4}{3}(b_1^2+b_2^2) + 4(b_1+b_2)^2} \\cdot 2|c|} = \\frac{2|b_1+b_2|}{\\sqrt{4a_1^2 + 4a_2^2 + \\frac{4}{3}(b_1^2+b_2^2) + 4(b_1+b_2)^2}}\n$$\n由于 $\\hat{Q}$ 是常数空间，商的表达式与 $q \\in \\hat{Q} \\setminus \\{0\\}$ 的选择无关。因此，对 $q$ 的下确界是平凡的，我们只需要计算对 $\\mathbf{v}$ 的上确界。\n$$\n\\beta_{\\hat{K}} = \\sup_{\\mathbf{v} \\in \\hat{V} \\setminus \\{0\\}} \\frac{2|b_1+b_2|}{\\sqrt{4a_1^2 + 4a_2^2 + \\frac{4}{3}(b_1^2+b_2^2) + 4(b_1+b_2)^2}}\n$$\n为使该分数最大化，我们必须使分母最小化。项 $4a_1^2$ 和 $4a_2^2$ 是非负的，可以通过选择 $a_1=0$ 和 $a_2=0$ 使它们为零。这个选择可以最大化该分数。于是我们有：\n$$\n\\beta_{\\hat{K}} = \\sup_{b_1,b_2 \\text{ not both } 0} \\frac{2|b_1+b_2|}{\\sqrt{\\frac{4}{3}(b_1^2+b_2^2) + 4(b_1+b_2)^2}}\n$$\n让我们最大化这个表达式的平方，记为 $S(b_1,b_2)$：\n$$\nS(b_1,b_2) = \\frac{4(b_1+b_2)^2}{\\frac{4}{3}(b_1^2+b_2^2) + 4(b_1+b_2)^2}\n$$\n这个表达式是关于 $b_1,b_2$ 的 0 次齐次式。我们可以设 $b_2 = \\lambda b_1$ (当 $b_1 \\neq 0$ 时)：\n$$\nS(\\lambda) = \\frac{4(b_1(1+\\lambda))^2}{\\frac{4}{3}(b_1^2 + (\\lambda b_1)^2) + 4(b_1(1+\\lambda))^2} = \\frac{4(1+\\lambda)^2}{\\frac{4}{3}(1+\\lambda^2) + 4(1+\\lambda)^2} = \\frac{(1+\\lambda)^2}{\\frac{1}{3}(1+\\lambda^2) + (1+\\lambda)^2}\n$$\n为最大化 $S(\\lambda)$，我们可以最小化其倒数：\n$$\n\\frac{1}{S(\\lambda)} = \\frac{\\frac{1}{3}(1+\\lambda^2) + (1+\\lambda)^2}{(1+\\lambda)^2} = \\frac{1}{3}\\frac{1+\\lambda^2}{(1+\\lambda)^2} + 1\n$$\n我们需要找到 $g(\\lambda) = \\frac{1+\\lambda^2}{(1+\\lambda)^2}$ 的最小值。其导数为：\n$$\ng'(\\lambda) = \\frac{2\\lambda(1+\\lambda)^2 - (1+\\lambda^2)2(1+\\lambda)}{(1+\\lambda)^4} = \\frac{2\\lambda(1+\\lambda) - 2(1+\\lambda^2)}{(1+\\lambda)^3} = \\frac{2\\lambda+2\\lambda^2-2-2\\lambda^2}{(1+\\lambda)^3} = \\frac{2(\\lambda-1)}{(1+\\lambda)^3}\n$$\n导数在 $\\lambda=1$ 时为零。当 $\\lambda  1$ 时，$g'(\\lambda)0$；当 $\\lambda > 1$ 时，$g'(\\lambda)>0$。因此，$\\lambda=1$ 是一个全局最小值点。\n最小值为 $g(1) = \\frac{1+1^2}{(1+1)^2} = \\frac{2}{4} = \\frac{1}{2}$。\n$1/S(\\lambda)$ 的最小值为 $\\frac{1}{3} \\cdot \\frac{1}{2} + 1 = \\frac{1}{6} + 1 = \\frac{7}{6}$。\n$S$ 的最大值是该值的倒数，即 $\\frac{6}{7}$。\n这是 $\\beta_{\\hat{K}}^2$ 的值。因此，inf-sup 常数为：\n$$\n\\beta_{\\hat{K}} = \\sqrt{\\frac{6}{7}}\n$$\n\n### 第 2 部分：高阶 Raviart–Thomas 空间\n\n配对 $(\\mathrm{RT}_k(\\hat{K}), P_k(\\hat{K}))$ 的 inf-sup 稳定性（其中 $\\mathrm{RT}_k(\\hat{K})$ 是 $k$ 次 Raviart-Thomas 空间，$P_k(\\hat{K})$ 是总次数至多为 $k$ 的多项式空间）可以通过 Fortin 算子来建立。论证的核心是证明对于任何给定的 $q_k \\in P_k(\\hat{K})$，都存在一个 $\\mathbf{v}_k \\in \\mathrm{RT}_k(\\hat{K})$ 满足 LBB 条件。\n\n一个标准的证明构造了一个 Fortin 算子 $\\Pi_k: H(\\mathrm{div};\\hat{K}) \\to \\mathrm{RT}_k(\\hat{K})$，该算子具有以下关键性质：\n1.  **交换图性质**：插值函数的散度是原函数散度在多项式空间上的 $L^2$-投影。也就是说，对于任何 $\\mathbf{v} \\in H(\\mathrm{div};\\hat{K})$：\n    $$\n    \\nabla \\cdot (\\Pi_k \\mathbf{v}) = \\mathcal{P}_k(\\nabla \\cdot \\mathbf{v})\n    $$\n    其中 $\\mathcal{P}_k: L^2(\\hat{K}) \\to P_k(\\hat{K})$ 是 $L^2$-正交投影。\n2.  **连续性**：该算子在 $H(\\mathrm{div};\\hat{K})$ 范数下有界，其界与多项式次数 $k$ 无关：\n    $$\n    \\|\\Pi_k \\mathbf{v}\\|_{H(\\mathrm{div};\\hat{K})} \\leq C_F \\|\\mathbf{v}\\|_{H(\\mathrm{div};\\hat{K})} \\quad \\forall \\mathbf{v} \\in H(\\mathrm{div};\\hat{K})\n    $$\n\n有了这样的算子，我们就可以找到 inf-sup 常数 $\\beta_k$ 的一个下界。对于任何 $q_k \\in P_k(\\hat{K}) \\setminus \\{0\\}$，从 $H(\\mathrm{div};\\hat{K})$ 到 $L^2(\\hat{K})$ 的散度算子的满射性保证了存在一个 $\\mathbf{v} \\in H(\\mathrm{div};\\hat{K})$ 使得 $\\nabla \\cdot \\mathbf{v} = q_k$ 并且 $\\|\\mathbf{v}\\|_{H(\\mathrm{div};\\hat{K})} \\leq C_S \\|q_k\\|_{0,\\hat{K}}$（对于某个常数 $C_S$）。\n\n现在，令 $\\mathbf{v}_k = \\Pi_k \\mathbf{v} \\in \\mathrm{RT}_k(\\hat{K})$。利用交换性质，$\\nabla \\cdot \\mathbf{v}_k = \\mathcal{P}_k(\\nabla \\cdot \\mathbf{v}) = \\mathcal{P}_k(q_k) = q_k$。\n然后我们可以通过选择这个特定的 $\\mathbf{v}_k$ 来为 inf-sup 定义中的上确界找到一个下界：\n$$\n\\sup_{\\mathbf{w}_k \\in \\mathrm{RT}_k \\setminus \\{0\\}} \\frac{|b(\\mathbf{w}_k,q_k)|}{\\|\\mathbf{w}_k\\|_{H(\\mathrm{div})}} \\geq \\frac{|b(\\mathbf{v}_k,q_k)|}{\\|\\mathbf{v}_k\\|_{H(\\mathrm{div})}} = \\frac{|-\\int_{\\hat{K}} (\\nabla \\cdot \\mathbf{v}_k)q_k \\,d\\hat{x}|}{\\|\\Pi_k \\mathbf{v}\\|_{H(\\mathrm{div})}} = \\frac{\\|q_k\\|_{0,\\hat{K}}^2}{\\|\\Pi_k \\mathbf{v}\\|_{H(\\mathrm{div})}}\n$$\n利用 $\\Pi_k$ 的连续性和 $\\mathbf{v}$ 的性质：\n$$\n\\frac{\\|q_k\\|_{0,\\hat{K}}^2}{\\|\\Pi_k \\mathbf{v}\\|_{H(\\mathrm{div})}} \\geq \\frac{\\|q_k\\|_{0,\\hat{K}}^2}{C_F \\|\\mathbf{v}\\|_{H(\\mathrm{div})}} \\geq \\frac{\\|q_k\\|_{0,\\hat{K}}^2}{C_F C_S \\|q_k\\|_{0,\\hat{K}}} = \\frac{1}{C_F C_S} \\|q_k\\|_{0,\\hat{K}}\n$$\n两边同除以 $\\|q_k\\|_{0,\\hat{K}}$ 并对 $q_k$ 取下确界，得到 $\\beta_k \\geq \\frac{1}{C_F C_S}$。由于 $C_F$ 和 $C_S$ 与 $k$ 无关，这就为 inf-sup 常数建立了一个在多项式次数 $k$ 上一致的下界。\n\n### 第 3 部分：到物理单元的变换\n\n设 $F: \\hat{K} \\to K$ 是一个仿射映射 $F(\\hat{x}) = A\\hat{x} + b$，其中 $A \\in \\mathbb{R}^{2 \\times 2}$ 是雅可比矩阵且 $J = \\det(A) > 0$。Piola 变换将函数从参考单元 $\\hat{K}$ 映射到物理单元 $K$。对于矢量函数 $\\hat{\\mathbf{v}} \\in H(\\mathrm{div};\\hat{K})$ 和标量函数 $\\hat{q} \\in L^2(\\hat{K})$，变换如下：\n$$\n\\mathbf{v}(x) = \\frac{1}{J} A \\hat{\\mathbf{v}}(F^{-1}(x)), \\qquad q(x) = \\hat{q}(F^{-1}(x))\n$$\n这种变换的选择保证了双线性形式的不变性：\n$$\nb_K(\\mathbf{v},q) = -\\int_K (\\nabla \\cdot \\mathbf{v}) q \\, \\mathrm{d}x = -\\int_{\\hat{K}} (\\hat{\\nabla} \\cdot \\hat{\\mathbf{v}}) \\hat{q} \\, \\mathrm{d}\\hat{x} = b_{\\hat{K}}(\\hat{\\mathbf{v}},\\hat{q})\n$$\n然而，范数在变换时会带有依赖于 $A$ 的缩放因子。\n$$\n\\|q\\|_{0,K}^2 = J \\|\\hat{q}\\|_{0,\\hat{K}}^2 \\implies \\|q\\|_{0,K} = \\sqrt{J} \\|\\hat{q}\\|_{0,\\hat{K}}\n$$\n$$\n\\|\\mathbf{v}\\|_{H(\\mathrm{div};K)}^2 = \\|\\mathbf{v}\\|_{0,K}^2 + \\|\\nabla \\cdot \\mathbf{v}\\|_{0,K}^2 = \\frac{1}{J}\\int_{\\hat{K}} |A\\hat{\\mathbf{v}}|^2 \\mathrm{d}\\hat{x} + \\frac{1}{J}\\|\\hat{\\nabla} \\cdot \\hat{\\mathbf{v}}\\|_{0,\\hat{K}}^2\n$$\n因此，物理单元 $K$ 上的 inf-sup 常数为：\n$$\n\\beta_K = \\inf_{\\hat{q}} \\sup_{\\hat{\\mathbf{v}}} \\frac{|b_{\\hat{K}}(\\hat{\\mathbf{v}},\\hat{q})|}{\\sqrt{\\frac{1}{J}\\left(\\int_{\\hat{K}} |A\\hat{\\mathbf{v}}|^2 \\mathrm{d}\\hat{x} + \\|\\hat{\\nabla} \\cdot \\hat{\\mathbf{v}}\\|_{0,\\hat{K}}^2\\right)} \\sqrt{J}\\|\\hat{q}\\|_{0,\\hat{K}}} = \\inf_{\\hat{q}} \\sup_{\\hat{\\mathbf{v}}} \\frac{|b_{\\hat{K}}(\\hat{\\mathbf{v}},\\hat{q})|}{\\sqrt{\\int_{\\hat{K}} |A\\hat{\\mathbf{v}}|^2 \\mathrm{d}\\hat{x} + \\|\\hat{\\nabla} \\cdot \\hat{\\mathbf{v}}\\|_{0,\\hat{K}}^2} \\|\\hat{q}\\|_{0,\\hat{K}}}\n$$\n分母中的范数是 $\\hat{V}$ 上的一个新范数，由矩阵 $A$ 加权。\n*   **对多项式次数的依赖性**：如第 2 部分所述，$\\mathrm{RT}_k - P_k$ 族的 inf-sup 常数有一个与 $k$ 无关的下界。\n*   **对网格形状正则性的依赖性**：形状正则性由 $A$ 和 $A^{-1}$ 的算子范数，或等效地由 $A$ 的奇异值来量化。$\\beta_K$ 的值将依赖于 $A$ 的范数和 $A$ 的行列式 $J$。对于一个形状正则的网格族，可以证明 inf-sup 常数 $\\beta_K$ 有一个独立于单元大小 $h_K$ 和单元形状的下界（只要形状不退化）。对于问题中给出的未缩放的 $H(\\mathrm{div})$ 范数，$\\beta_K$ 的确切表达式会显示出对 $A$ 的依赖性，但对于形状正则的网格族，它通常被一个统一的常数从下方界定。", "answer": "$$\n\\boxed{\\sqrt{\\frac{6}{7}}}\n$$", "id": "3389502"}, {"introduction": "掌握了这些空间的理论意义和稳定性要求后，最后的实践环节将聚焦于计算实现的核心：如何构建用于近似计算的基函数。本练习 [@problem_id:3389511] 将指导你在一个标准参考单元上，为$H(\\mathrm{curl})$空间构造一组高阶谱方法基函数。通过分析这些基函数所产生的质量矩阵的结构和稀疏性，你将对谱元法和间断Galerkin方法中基本算子的离散化过程获得具体而深入的认识。", "problem": "考虑参考六面体 $\\hat{K}=[-1,1]^{3}$ 和由平方可积向量场及其平方可积旋度构成的索伯列夫空间 $H(\\operatorname{curl};\\hat{K})$。令 $\\{\\psi_{n}\\}_{n\\ge 0}$ 表示一维勒让德多项式，它们经过缩放以在 $L^{2}(-1,1)$ 上标准正交，即 $\\int_{-1}^{1}\\psi_{m}(\\xi)\\,\\psi_{n}(\\xi)\\,d\\xi=\\delta_{mn}$。通过张量积在 $\\hat{K}$ 上构建一个谱 $H(\\operatorname{curl})$ 协调基，该基可实现六面体上具有可能各向异性的多项式阶数 $p_{x},p_{y},p_{z}\\in\\mathbb{N}$ 的第一族 Nédélec 空间。具体来说，定义按方向的基函数族：\n- $x$方向：$\\boldsymbol{\\Phi}^{(x)}_{i,j,k}(x,y,z)=\\psi_{i}(x)\\,\\psi_{j}(y)\\,\\psi_{k}(z)\\,\\boldsymbol{e}_{x}$，对于 $i=0,\\dots,p_{x}-1$, $j=0,\\dots,p_{y}$, $k=0,\\dots,p_{z}$，\n- $y$方向：$\\boldsymbol{\\Phi}^{(y)}_{i,j,k}(x,y,z)=\\psi_{i}(x)\\,\\psi_{j}(y)\\,\\psi_{k}(z)\\,\\boldsymbol{e}_{y}$，对于 $i=0,\\dots,p_{x}$, $j=0,\\dots,p_{y}-1$, $k=0,\\dots,p_{z}$，\n- $z$方向：$\\boldsymbol{\\Phi}^{(z)}_{i,j,k}(x,y,z)=\\psi_{i}(x)\\,\\psi_{j}(y)\\,\\psi_{k}(z)\\,\\boldsymbol{e}_{z}$，对于 $i=0,\\dots,p_{x}$, $j=0,\\dots,p_{y}$, $k=0,\\dots,p_{z}-1$，\n其中 $\\boldsymbol{e}_{x},\\boldsymbol{e}_{y},\\boldsymbol{e}_{z}$ 是笛卡尔单位向量。\n\n令单元 $H(\\operatorname{curl})$ 质量矩阵 $\\boldsymbol{M}$ 由 $L^{2}$ 内积定义，\n$$\nM_{\\alpha\\beta}=\\int_{\\hat{K}}\\boldsymbol{\\Phi}_{\\alpha}(\\boldsymbol{x})\\cdot \\boldsymbol{\\Phi}_{\\beta}(\\boldsymbol{x})\\,d\\boldsymbol{x},\n$$\n其中全局基函数索引 $\\alpha$ 遍历所有三个按方向的基函数族的并集。仅使用以下基本事实：(i) $H(\\operatorname{curl};\\hat{K})$ 的定义以及上述六面体上第一族 Nédélec 空间的多项式子空间特征，(ii) 一维勒让德基在 $L^{2}(-1,1)$ 中的正交性，以及 (iii) 张量积高斯-勒让德 (GL) 求积在每个坐标方向上对于直至适当次数的多项式的精确性，执行以下步骤：\n- 推导由按方向的基函数族所引出的 $\\boldsymbol{M}$ 的块结构，并将每个块简化为一维质量矩阵的张量积。\n- 利用 $\\{\\psi_{n}\\}$ 的 $L^{2}$ 正交性和张量积 GL 求积的精确性，确定每个块内的稀疏模式。\n\n最后，给出一个关于 $p_{x}$、$p_{y}$ 和 $p_{z}$ 的函数，表示 $\\boldsymbol{M}$ 的非零元精确总数的闭式表达式。你的最终答案必须是单一的解析表达式。不需要四舍五入，也不涉及单位。", "solution": "基函数的全集（我们记为 $\\mathcal{B}$）是三个按方向的基函数族的并集：\n$$\n\\mathcal{B} = \\left\\{\\boldsymbol{\\Phi}^{(x)}_{i,j,k}\\right\\} \\cup \\left\\{\\boldsymbol{\\Phi}^{(y)}_{i,j,k}\\right\\} \\cup \\left\\{\\boldsymbol{\\Phi}^{(z)}_{i,j,k}\\right\\}\n$$\n其索引范围如问题陈述中所指定。单元 $H(\\operatorname{curl})$ 质量矩阵 $\\boldsymbol{M}$ 的元素由这些基函数的 $L^2(\\hat{K})$ 内积给出。设 $\\boldsymbol{\\Phi}_{\\alpha}$ 和 $\\boldsymbol{\\Phi}_{\\beta}$ 是来自 $\\mathcal{B}$ 的两个通用基函数，其中 $\\alpha$ 和 $\\beta$ 是全局索引。对应的矩阵元素为\n$$\nM_{\\alpha\\beta} = \\int_{\\hat{K}}\\boldsymbol{\\Phi}_{\\alpha}(\\boldsymbol{x})\\cdot \\boldsymbol{\\Phi}_{\\beta}(\\boldsymbol{x})\\,d\\boldsymbol{x}\n$$\n\n首先，我们推导 $\\boldsymbol{M}$ 的块结构。基函数被定义为一个标量多项式乘以一个常数笛卡尔单位向量 $\\boldsymbol{e}_d$，其中 $d \\in \\{x,y,z\\}$。让我们考虑两个不同方向基函数的内积，例如 $\\boldsymbol{\\Phi}_{\\alpha} = \\boldsymbol{\\Phi}^{(x)}_{i,j,k}$ 和 $\\boldsymbol{\\Phi}_{\\beta} = \\boldsymbol{\\Phi}^{(y)}_{i',j',k'}$。它们的点积是：\n$$\n\\boldsymbol{\\Phi}^{(x)}_{i,j,k} \\cdot \\boldsymbol{\\Phi}^{(y)}_{i',j',k'} = \\left(\\psi_{i}(x)\\psi_{j}(y)\\psi_{k}(z)\\boldsymbol{e}_{x}\\right) \\cdot \\left(\\psi_{i'}(x)\\psi_{j'}(y)\\psi_{k'}(z)\\boldsymbol{e}_{y}\\right)\n$$\n$$\n= \\left(\\psi_{i}(x)\\psi_{i'}(x)\\psi_{j}(y)\\psi_{j'}(y)\\psi_{k}(z)\\psi_{k'}(z)\\right) (\\boldsymbol{e}_{x} \\cdot \\boldsymbol{e}_{y})\n$$\n由于笛卡尔单位向量是正交的，$\\boldsymbol{e}_{x} \\cdot \\boldsymbol{e}_{y} = 0$。因此，被积函数恒为零，得到的矩阵元素为 $M_{\\alpha\\beta} = 0$。同样的推理适用于 $(\\boldsymbol{e}_{x}, \\boldsymbol{e}_{z})$ 和 $(\\boldsymbol{e}_{y}, \\boldsymbol{e}_{z})$ 对。这表明质量矩阵 $\\boldsymbol{M}$ 是块对角矩阵，只有相同方向的基函数之间存在耦合。\n$$\n\\boldsymbol{M} =\n\\begin{pmatrix}\n\\boldsymbol{M}^{(x)}  \\boldsymbol{0}  \\boldsymbol{0} \\\\\n\\boldsymbol{0}  \\boldsymbol{M}^{(y)}  \\boldsymbol{0} \\\\\n\\boldsymbol{0}  \\boldsymbol{0}  \\boldsymbol{M}^{(z)}\n\\end{pmatrix}\n$$\n其中每个块 $\\boldsymbol{M}^{(d)}$ 对应于 $d$ 方向基函数的内积。\n\n接下来，我们分析每个块的结构，例如 $\\boldsymbol{M}^{(x)}$。该块的基函数是 $\\boldsymbol{\\Phi}^{(x)}_{i,j,k}$ 和 $\\boldsymbol{\\Phi}^{(x)}_{i',j',k'}$。对应的矩阵元素是：\n$$\nM^{(x)}_{(i,j,k), (i',j',k')} = \\int_{\\hat{K}} \\boldsymbol{\\Phi}^{(x)}_{i,j,k} \\cdot \\boldsymbol{\\Phi}^{(x)}_{i',j',k'} \\,d\\boldsymbol{x}\n$$\n$$\n= \\int_{-1}^{1} \\int_{-1}^{1} \\int_{-1}^{1} \\left(\\psi_{i}(x)\\psi_{j}(y)\\psi_{k}(z)\\boldsymbol{e}_{x}\\right) \\cdot \\left(\\psi_{i'}(x)\\psi_{j'}(y)\\psi_{k'}(z)\\boldsymbol{e}_{x}\\right) \\,dx\\,dy\\,dz\n$$\n使用 $\\boldsymbol{e}_{x} \\cdot \\boldsymbol{e}_{x} = 1$ 并应用 Fubini 定理将积分在张量积域 $\\hat{K} = [-1,1]^3$ 上分离，我们得到：\n$$\nM^{(x)}_{(i,j,k), (i',j',k')} = \\left( \\int_{-1}^{1} \\psi_i(x)\\psi_{i'}(x) \\,dx \\right) \\left( \\int_{-1}^{1} \\psi_j(y)\\psi_{j'}(y) \\,dy \\right) \\left( \\int_{-1}^{1} \\psi_k(z)\\psi_{k'}(z) \\,dz \\right)\n$$\n问题陈述说明，一维基函数 $\\{\\psi_n\\}$ 在 $L^2(-1,1)$ 上是标准正交的，这意味着 $\\int_{-1}^{1}\\psi_{m}(\\xi)\\psi_{n}(\\xi)\\,d\\xi = \\delta_{mn}$，其中 $\\delta_{mn}$ 是克罗内克符号。将此性质应用于三个积分中的每一个，得到：\n$$\nM^{(x)}_{(i,j,k), (i',j',k')} = \\delta_{ii'} \\delta_{jj'} \\delta_{kk'}\n$$\n这个结果意味着当且仅当 $(i,j,k) = (i',j',k')$ 时，矩阵元素为 $1$，否则为 $0$。因此，块 $\\boldsymbol{M}^{(x)}$ 是一个单位矩阵。同样的逻辑也适用于 $\\boldsymbol{M}^{(y)}$ 和 $\\boldsymbol{M}^{(z)}$，它们也是单位矩阵。因此，完整的质量矩阵 $\\boldsymbol{M}$ 是一个大的单位矩阵。\n\n由于 $\\boldsymbol{M}$ 是一个单位矩阵，其非零元都在对角线上，值为 $1$。非零元的总数等于基函数的总数，也就是矩阵的维数。我们通过将每个方向族中的函数数量相加来计算这个总数。\n\n$x$ 方向函数的数量 $N_x$：\n索引为 $i \\in \\{0, \\dots, p_x-1\\}$，$j \\in \\{0, \\dots, p_y\\}$，$k \\in \\{0, \\dots, p_z\\}$。选择的数量分别为 $p_x$、$p_y+1$ 和 $p_z+1$。\n$$\nN_x = p_x (p_y+1) (p_z+1)\n$$\n\n$y$ 方向函数的数量 $N_y$：\n索引为 $i \\in \\{0, \\dots, p_x\\}$，$j \\in \\{0, \\dots, p_y-1\\}$，$k \\in \\{0, \\dots, p_z\\}$。选择的数量为 $p_x+1$、$p_y$ 和 $p_z+1$。\n$$\nN_y = (p_x+1) p_y (p_z+1)\n$$\n\n$z$ 方向函数的数量 $N_z$：\n索引为 $i \\in \\{0, \\dots, p_x\\}$，$j \\in \\{0, \\dots, p_y\\}$，$k \\in \\{0, \\dots, p_z-1\\}$。选择的数量为 $p_x+1$、$p_y+1$ 和 $p_z$。\n$$\nN_z = (p_x+1) (p_y+1) p_z\n$$\n\n非零元的总数是和 $N = N_x + N_y + N_z$。我们展开每一项：\n$N_x = p_x(p_y p_z + p_y + p_z + 1) = p_x p_y p_z + p_x p_y + p_x p_z + p_x$\n$N_y = p_y(p_x p_z + p_x + p_z + 1) = p_x p_y p_z + p_x p_y + p_y p_z + p_y$\n$N_z = p_z(p_x p_y + p_x + p_y + 1) = p_x p_y p_z + p_x p_z + p_y p_z + p_z$\n\n将这些表达式相加并合并同类项：\n- $p_x p_y p_z$ 项：$p_x p_y p_z + p_x p_y p_z + p_x p_y p_z = 3p_x p_y p_z$。\n- $p_x p_y$ 项：$p_x p_y + p_x p_y = 2p_x p_y$。\n- $p_x p_z$ 项：$p_x p_z + p_x p_z = 2p_x p_z$。\n- $p_y p_z$ 项：$p_y p_z + p_y p_z = 2p_y p_z$。\n- 线性项：$p_x, p_y, p_z$。\n\n非零元的总数为：\n$$\nN = 3p_x p_y p_z + 2(p_x p_y + p_x p_z + p_y p_z) + p_x + p_y + p_z\n$$\n这是质量矩阵 $\\boldsymbol{M}$ 中非零元总数的最终闭式表达式。", "answer": "$$\n\\boxed{3p_{x}p_{y}p_{z} + 2(p_{x}p_{y} + p_{x}p_{z} + p_{y}p_{z}) + p_{x} + p_{y} + p_{z}}\n$$", "id": "3389511"}]}