{"hands_on_practices": [{"introduction": "本练习旨在探索基函数的选择与微分算子性质之间的内在联系。通过使用勒让德多项式（Legendre polynomials）作为Sturm-Liouville问题的基，我们将看到伽辽金法（Galerkin method）如何自然地揭示算子的谱特性。这个过程将加深我们对试探空间和检验空间概念的理解，并展示如何通过瑞利商（Rayleigh quotient）直接计算与基函数对应的特征值 ([@problem_id:3425419])。", "problem": "考虑区间 $[-1,1]$ 上的一维谱离散化，使用勒让德多项式 $\\{L_n(x)\\}_{n \\ge 0}$，其中 $L_0(x)=1$，$L_1(x)=x$，更高阶的 $L_n(x)$ 定义为在 $[-1,1]$ 上关于单位权重正交的唯一的 $n$ 次多项式。令试验空间为\n$$\nV_N \\;=\\; \\operatorname{span}\\{L_0, L_1, \\dots, L_N\\}.\n$$\n我们研究带有零阶反应项的勒让德-施图姆–刘维尔算子的弱形式：求 $u_N \\in V_N$ 使得\n$$\na(u_N, w) \\;=\\; \\ell(w) \\quad \\text{for all } w \\in W_N,\n$$\n其中双线性形式为\n$$\na(u,w) \\;=\\; \\int_{-1}^{1} (1-x^2)\\, u'(x)\\, w'(x)\\, dx \\;+\\; \\mu \\int_{-1}^{1} u(x)\\, w(x)\\, dx,\n$$\n$\\mu$ 是一个给定的实参数，线性泛函 $\\ell(\\cdot)$ 未指定。要求您：\n- 确定以 $V_N$ 表示的测试空间 $W_N$ 的标准伽辽金选择。\n- 确定 $W_N$ 的一种彼得罗夫–伽辽金 (PG) 选择，该选择是通过对 $V_N$ 进行一次微分并乘以 $(1-x^2)$ 来自然导出的，从而将试验空间与形如 $(1-x^2)\\,\\phi'(x)$（其中 $\\phi \\in V_N$）的测试函数配对。\n- 对于 $W_N$ 的标准伽辽金选择，考虑瑞利商\n$$\nR_p(\\mu) \\;=\\; \\frac{a(L_p, L_p)}{\\displaystyle \\int_{-1}^{1} L_p(x)^2\\, dx},\n$$\n对于固定的整数 $p$ 且 $0 \\le p \\le N$。仅使用勒让德多项式的基本性质和给定的双线性形式，推导 $R_p(\\mu)$ 作为 $p$ 和 $\\mu$ 的函数的封闭形式表达式。\n\n您的最终答案必须是 $R_p(\\mu)$ 的单一封闭形式表达式。不需要数值近似，也不涉及单位。", "solution": "该问题要求三项不同的内容：确定一个标准的伽辽金测试空间，确定一个特定的彼得罗夫-伽辽金测试空间，以及推导一个瑞利商的封闭形式表达式。我们将依次解决这些问题。\n\n首先，我们确定测试空间 $W_N$ 的标准伽辽金选择。伽辽金方法定义的条件是测试空间与试验空间相同。给定试验空间 $V_N = \\operatorname{span}\\{L_0, L_1, \\dots, L_N\\}$，测试空间的标准伽辽金选择是：\n$$\nW_N = V_N = \\operatorname{span}\\{L_0, L_1, \\dots, L_N\\}\n$$\n\n其次，我们确定问题中描述的彼得罗夫-伽辽金 (PG) 测试空间。问题指出，这个空间是“通过对 $V_N$ 进行一次微分并乘以 $(1-x^2)$ 来自然导出的”。这意味着对于任何试验函数 $\\phi \\in V_N$，相应的测试函数的形式为 $(1-x^2)\\phi'(x)$。因此，测试空间 $W_N$ 是所有此类函数的集合：\n$$\nW_N = \\left\\{ (1-x^2)\\phi'(x) \\mid \\phi \\in V_N \\right\\}\n$$\n由于 $V_N$ 是一个线性空间，这个集合也是一个线性空间。具体来说，当 $\\phi$ 遍历 $V_N$ 的基 $\\{L_0, L_1, \\dots, L_N\\}$ 时，空间 $W_N$ 由函数集 $\\{(1-x^2)L_n'(x)\\}_{n=0}^N$ 张成。注意 $L_0(x)=1$，所以 $L_0'(x)=0$，第一个基函数为零。\n$$\nW_N = \\operatorname{span}\\{(1-x^2)L_1'(x), \\dots, (1-x^2)L_N'(x)\\}\n$$\n\n第三，我们推导瑞利商 $R_p(\\mu)$ 的封闭形式表达式，其中 $p$ 是一个固定的整数，满足 $0 \\le p \\le N$。瑞利商定义为：\n$$\nR_p(\\mu) = \\frac{a(L_p, L_p)}{\\displaystyle \\int_{-1}^{1} L_p(x)^2\\, dx}\n$$\n双线性形式 $a(u,w)$ 由下式给出：\n$$\na(u,w) = \\int_{-1}^{1} (1-x^2)\\, u'(x)\\, w'(x)\\, dx + \\mu \\int_{-1}^{1} u(x)\\, w(x)\\, dx\n$$\n将 $u = w = L_p$ 代入双线性形式，我们得到瑞利商的分子：\n$$\na(L_p, L_p) = \\int_{-1}^{1} (1-x^2)\\, (L_p'(x))^2\\, dx + \\mu \\int_{-1}^{1} (L_p(x))^2\\, dx\n$$\n我们需要计算此表达式中的两个积分。\n\n第二个积分是勒让德多项式正交性质的直接应用，该性质表明对于任何整数 $m, n \\ge 0$：\n$$\n\\int_{-1}^{1} L_m(x) L_n(x)\\, dx = \\frac{2}{2n+1} \\delta_{mn}\n$$\n其中 $\\delta_{mn}$ 是克罗内克δ函数。对于 $m=n=p$，这给出：\n$$\n\\int_{-1}^{1} (L_p(x))^2\\, dx = \\frac{2}{2p+1}\n$$\n这也是瑞利商的分母。\n\n现在我们计算第一个积分 $\\int_{-1}^{1} (1-x^2)\\, (L_p'(x))^2\\, dx$。我们使用勒让德多项式的定义微分方程，即勒让德方程：\n$$\n\\frac{d}{dx}\\left[ (1-x^2) \\frac{dy}{dx} \\right] + \\lambda y = 0\n$$\n勒让德多项式 $L_p(x)$ 是该方程在特征值 $\\lambda = p(p+1)$ 下的解。因此，$L_p(x)$ 满足：\n$$\n\\frac{d}{dx}\\left[ (1-x^2) L_p'(x) \\right] + p(p+1)L_p(x) = 0\n$$\n为了计算该积分，我们对 $\\int_{-1}^{1} (1-x^2) L_p'(x) \\cdot L_p'(x) dx$ 应用分部积分法。我们令 $u = (1-x^2)L_p'(x)$ 且 $dv = L_p'(x)dx$，于是 $du = \\frac{d}{dx}((1-x^2)L_p'(x))dx$ 且 $v=L_p(x)$。\n$$\n\\int_{-1}^{1} (1-x^2) (L_p'(x))^2\\, dx = \\left[ L_p(x) (1-x^2) L_p'(x) \\right]_{-1}^{1} - \\int_{-1}^{1} L_p(x) \\frac{d}{dx}\\left( (1-x^2) L_p'(x) \\right) dx\n$$\n边界项 $\\left[ L_p(x) (1-x^2) L_p'(x) \\right]_{-1}^{1}$ 的值为零，因为因子 $(1-x^2)$ 在 $x=1$ 和 $x=-1$ 处均为零。函数 $L_p(x)$ 和 $L_p'(x)$ 在这些点是有限的。因此，积分简化为：\n$$\n\\int_{-1}^{1} (1-x^2) (L_p'(x))^2\\, dx = - \\int_{-1}^{1} L_p(x) \\frac{d}{dx}\\left( (1-x^2) L_p'(x) \\right) dx\n$$\n根据勒让德微分方程，我们代入 $\\frac{d}{dx}\\left( (1-x^2) L_p'(x) \\right) = -p(p+1)L_p(x)$：\n$$\n\\int_{-1}^{1} (1-x^2) (L_p'(x))^2\\, dx = - \\int_{-1}^{1} L_p(x) \\left( -p(p+1)L_p(x) \\right) dx = p(p+1) \\int_{-1}^{1} (L_p(x))^2\\, dx\n$$\n使用正交性结果，我们得到：\n$$\n\\int_{-1}^{1} (1-x^2) (L_p'(x))^2\\, dx = p(p+1) \\left( \\frac{2}{2p+1} \\right)\n$$\n现在我们可以写出分子 $a(L_p, L_p)$ 的完整表达式：\n$$\na(L_p, L_p) = p(p+1) \\left( \\frac{2}{2p+1} \\right) + \\mu \\left( \\frac{2}{2p+1} \\right) = \\left( p(p+1) + \\mu \\right) \\left( \\frac{2}{2p+1} \\right)\n$$\n最后，我们通过将 $a(L_p, L_p)$ 除以分母 $\\int_{-1}^{1} (L_p(x))^2\\, dx = \\frac{2}{2p+1}$ 来计算瑞利商：\n$$\nR_p(\\mu) = \\frac{\\left( p(p+1) + \\mu \\right) \\left( \\frac{2}{2p+1} \\right)}{\\left( \\frac{2}{2p+1} \\right)}\n$$\n项 $\\frac{2}{2p+1}$ 消去，得到最终的封闭形式表达式：\n$$\nR_p(\\mu) = p(p+1) + \\mu\n$$\n该结果对任何整数 $p \\ge 0$ 均有效。对于 $p=0$，$L_0(x)=1$ 且 $L_0'(x)=0$，因此 $a(L_0,L_0) = \\int_{-1}^1 0 dx + \\mu \\int_{-1}^1 1^2 dx = 2\\mu$。分母是 $\\int_{-1}^1 1^2 dx = 2$。$R_0(\\mu) = 2\\mu/2 = \\mu$。我们的公式给出 $0(0+1)+\\mu = \\mu$，这是一致的。\n此表达式表示微分算子 $-\\frac{d}{dx}((1-x^2)\\frac{d}{dx}) + \\mu$ 作用于其特征函数 $L_p(x)$ 时的特征值。", "answer": "$$\n\\boxed{p(p+1) + \\mu}\n$$", "id": "3425419"}, {"introduction": "理论上的伽辽金法依赖于精确积分，但在实际计算中，我们必须使用数值求积（numerical quadrature）。本练习将揭示这种近似所带来的深刻影响。我们将具体研究在高斯-洛巴托（Gauss-Lobatto）求积点上使用节点拉格朗日（Lagrange）基时，如何得到一个对角的“集总”质量矩阵（\"lumped\" mass matrix），以及精确内积与离散内积之间的误差如何被精确地描述为一个秩一修正 ([@problem_id:3425399])。", "problem": "设 $P_n(x)$ 表示在区间 $[-1,1]$ 上的 $n$ 次 Legendre 多项式，其关于连续内积 $\\langle u,v\\rangle := \\int_{-1}^{1} u(x)\\,v(x)\\,dx$ 正交。设 $\\{x_i\\}_{i=0}^{N}$ 为 $[-1,1]$ 上 $N$ 次的 Gauss–Lobatto–Legendre (GLL) 节点，它们是由端点 $x_0=-1$、$x_N=1$ 和 $(1-x^2)P_N'(x)$ 的 $N-1$ 个内部根组成的 $N+1$ 个点。设 $\\{w_i\\}_{i=0}^{N}$ 为相应的 GLL 权重，使得 Gauss–Lobatto–Legendre 求积对于次数至多为 $2N-1$ 的被积函数是精确的，并设 $\\ell_j(x)$ 为由 $\\ell_j(x_i)=\\delta_{ij}$ ($0\\le i,j\\le N$) 定义的 $N$ 次节点 Lagrange 基。\n\n考虑多项式试验空间 $V_N=\\{p:\\deg p\\le N\\}$，并取测试空间也为 $V_N$。将由 Gauss–Lobatto–Legendre 求积导出的离散内积定义为 $\\langle u,v\\rangle_Q := \\sum_{i=0}^{N} w_i\\,u(x_i)\\,v(x_i)$。\n\n仅使用关于 Legendre 多项式和 Gauss–Lobatto–Legendre 求积的基本事实（即 $\\{P_n\\}$ 的正交性和求积对于次数至多为 $2N-1$ 的精确性），完成以下任务：\n\n1) 通过给出 $\\ell_j(x)$ 关于 $\\{x_i\\}_{i=0}^{N}$ 的闭式表达式，来构造 Gauss–Lobatto–Legendre 节点上的节点 Lagrange 基 $\\{\\ell_j\\}_{j=0}^{N}$。\n\n2) 解释为什么在使用离散内积 $\\langle\\cdot,\\cdot\\rangle_Q$ 时，试验空间和测试空间在节点基下由一个对角质量矩阵来识别。然后，通过刻画节点基下连续和离散质量矩阵之间的差异，精确地量化用离散内积 $\\langle\\cdot,\\cdot\\rangle_Q$ 替换连续内积 $\\langle\\cdot,\\cdot\\rangle$ 如何改变试验空间和测试空间之间的关系。特别地，证明此差异仅在 $N$ 次 Legendre 模式上存在支撑，并因此简化为一个由仅依赖于 $N$ 的单个标量系数决定的秩一修正。\n\n设 $\\boldsymbol{p}\\in\\mathbb{R}^{N+1}$ 表示 $N$ 次 Legendre 多项式在 Gauss–Lobatto–Legendre 节点上的采样向量，即 $\\boldsymbol{p}_i := P_N(x_i)$，并设 $\\boldsymbol{W}=\\operatorname{diag}(w_0,\\dots,w_N)$。设 $\\boldsymbol{M}$ 为精确质量矩阵，其元素为 $\\boldsymbol{M}_{ij} = \\int_{-1}^{1} \\ell_i(x)\\,\\ell_j(x)\\,dx$。定义 $\\alpha_N$ 为唯一的标量，使得差值 $\\boldsymbol{M}-\\boldsymbol{W}$ 等于 $\\alpha_N\\,(\\boldsymbol{W}\\boldsymbol{p})(\\boldsymbol{W}\\boldsymbol{p})^{\\top}$。\n\n以 $N$ 的函数形式确定 $\\alpha_N$ 的闭式解。您的最终答案必须是 $\\alpha_N$ 的单个闭式解析表达式。", "solution": "该问题要求完成几个相关的任务。我们将按顺序解决它们。这里，$V_N = \\text{span}\\{\\ell_j(x)\\}_{j=0}^N = \\text{span}\\{P_k(x)\\}_{k=0}^N$ 是次数至多为 $N$ 的多项式空间。\n\n**1. 节点 Lagrange 基**\n\n节点 Lagrange 基多项式 $\\ell_j(x) \\in V_N$ 由属性 $\\ell_j(x_i) = \\delta_{ij}$ 定义，其中 $\\{x_i\\}_{i=0}^N$ 是 Gauss-Lobatto-Legendre (GLL) 节点，$\\delta_{ij}$ 是 Kronecker delta。满足这 $N+1$ 个条件的唯一的次数至多为 $N$ 的多项式由 Lagrange 插值多项式的标准公式给出：\n$$\n\\ell_j(x) = \\prod_{\\substack{k=0 \\\\ k \\neq j}}^{N} \\frac{x-x_k}{x_j-x_k}\n$$\n这是 $\\ell_j(x)$ 关于 GLL 节点的闭式表达式。\n\n**2. 离散质量矩阵及其与连续质量矩阵的关系**\n\n问题要求解释为什么离散内积 $\\langle\\cdot,\\cdot\\rangle_Q$ 在节点基 $\\{\\ell_j\\}_{j=0}^N$ 下通过一个对角质量矩阵来识别试验空间和测试空间。与内积相关联的矩阵称为质量矩阵。离散质量矩阵，我们称之为 $\\boldsymbol{M}_Q$，其元素由基函数的离散内积给出：\n$$\n(\\boldsymbol{M}_Q)_{ij} = \\langle \\ell_i, \\ell_j \\rangle_Q := \\sum_{k=0}^{N} w_k \\ell_i(x_k) \\ell_j(x_k)\n$$\n根据 Lagrange 基的定义，$\\ell_i(x_k) = \\delta_{ik}$ 且 $\\ell_j(x_k) = \\delta_{jk}$。将这些代入求和式中：\n$$\n(\\boldsymbol{M}_Q)_{ij} = \\sum_{k=0}^{N} w_k \\delta_{ik} \\delta_{jk}\n$$\n项 $\\delta_{ik}\\delta_{jk}$ 仅在 $k=i$ 和 $k=j$ 同时成立时非零，这意味着它仅在 $i=j$ 且 $k=i$ 时非零。因此，当 $i=j$ 时，求和式简化为单项；当 $i \\neq j$ 时，为零。\n$$\n(\\boldsymbol{M}_Q)_{ij} = w_i \\delta_{ij}\n$$\n这表明 $\\boldsymbol{M}_Q$ 是一个对角矩阵，其对角线元素是求积权重，即 $(\\boldsymbol{M}_Q)_{ii} = w_i$。这个矩阵正是问题中定义的矩阵 $\\boldsymbol{W} = \\operatorname{diag}(w_0, \\dots, w_N)$。节点基在离散内积下的正交性，即 $\\langle \\ell_i, \\ell_j \\rangle_Q = w_i\\delta_{ij}$，导致了一个对角（或“集总”）质量矩阵。\n\n接下来，我们刻画差异 $\\boldsymbol{M}-\\boldsymbol{W}$。这个差分矩阵的元素由下式给出：\n$$\n(\\boldsymbol{M}-\\boldsymbol{W})_{ij} = \\boldsymbol{M}_{ij} - w_i\\delta_{ij} = \\int_{-1}^{1} \\ell_i(x)\\ell_j(x)\\,dx - \\sum_{k=0}^{N} w_k \\ell_i(x_k)\\ell_j(x_k)\n$$\n这个差异是 GLL 求积法则应用于函数 $\\ell_i(x)\\ell_j(x)$ 时的误差。这个多项式的次数至多为 $N+N=2N$。具有 $N+1$ 个节点的 GLL 求积对于次数至多为 $2N-1$ 的多项式是精确的。因此，非零误差只能出现在次数为 $2N$ 的多项式上。\n\n让我们测试误差矩阵 $\\boldsymbol{E} = \\boldsymbol{M}-\\boldsymbol{W}$ 作用于向量 $\\boldsymbol{v} \\in \\mathbb{R}^{N+1}$ 的效果，该向量表示一个多项式 $v(x) \\in \\mathbb{P}_{N-1}$（次数至多为 $N-1$ 的多项式空间）的节点值。对应的多项式为 $v(x) = \\sum_{j=0}^N v_j \\ell_j(x)$，其中 $v_j = v(x_j)$。矩阵-向量积 $\\boldsymbol{E}\\boldsymbol{v}$ 的第 $i$ 个分量是：\n$$\n(\\boldsymbol{E}\\boldsymbol{v})_i = \\sum_{j=0}^{N} E_{ij}v_j = \\sum_{j=0}^{N} \\left(\\langle \\ell_i, \\ell_j \\rangle - w_i\\delta_{ij}\\right) v_j = \\langle \\ell_i, \\sum_{j=0}^{N} v_j\\ell_j \\rangle - \\sum_{j=0}^{N}w_i\\delta_{ij}v_j = \\langle \\ell_i, v \\rangle - w_iv_i\n$$\n第二项可以写为 $\\langle \\ell_i, v \\rangle_Q$。因此，$(\\boldsymbol{E}\\boldsymbol{v})_i = \\langle \\ell_i, v \\rangle - \\langle \\ell_i, v \\rangle_Q$。这是对多项式 $\\ell_i(x)v(x)$ 的求积误差。这个多项式的次数至多为 $\\deg(\\ell_i) + \\deg(v) \\le N + (N-1) = 2N-1$。由于 GLL 求积对此次数的多项式是精确的，误差为零。\n$$\n(\\boldsymbol{E}\\boldsymbol{v})_i = 0\n$$\n这对所有 $i=0,\\dots,N$ 都成立。因此，对于任何表示 $\\mathbb{P}_{N-1}$ 中多项式的向量 $\\boldsymbol{v}$，都有 $\\boldsymbol{E}\\boldsymbol{v}=\\boldsymbol{0}$。此类向量的空间维数为 $N$。由于 $\\boldsymbol{E}$ 是一个 $(N+1)\\times(N+1)$ 矩阵，其零空间的维数至少为 $N$，这意味着它的秩至多为 $1$。由于求积对 $2N$ 次多项式不精确，误差不恒为零，所以 $\\mathrm{rank}(\\boldsymbol{E})=1$。一个秩一矩阵表示一个其值域为一维子空间的算子，在本例中，这对应于多项式中属于 $\\mathbb{P}_N$ 但不属于 $\\mathbb{P}_{N-1}$ 的分量。这个分量由 Legendre 多项式 $P_N(x)$ 张成。这证实了质量矩阵之间的差异是一个沿着 $N$ 次 Legendre 模式支撑的秩一修正。\n\n**3. $\\alpha_N$ 的确定**\n\n我们从给定的恒等式开始：\n$$\n\\boldsymbol{M} - \\boldsymbol{W} = \\alpha_N (\\boldsymbol{W}\\boldsymbol{p})(\\boldsymbol{W}\\boldsymbol{p})^{\\top}\n$$\n其中 $\\boldsymbol{p}$ 是 $P_N(x)$ 的节点值向量，即 $p_i = P_N(x_i)$。为了求 $\\alpha_N$，我们可以将此矩阵方程投影到向量 $\\boldsymbol{p}$ 上：\n$$\n(\\boldsymbol{M} - \\boldsymbol{W})\\boldsymbol{p} = \\alpha_N (\\boldsymbol{W}\\boldsymbol{p})(\\boldsymbol{W}\\boldsymbol{p})^{\\top}\\boldsymbol{p}\n$$\n首先分析右侧（RHS）。项 $(\\boldsymbol{W}\\boldsymbol{p})^{\\top}\\boldsymbol{p}$ 是一个标量：\n$$\n(\\boldsymbol{W}\\boldsymbol{p})^{\\top}\\boldsymbol{p} = \\sum_{i=0}^N (w_i p_i) p_i = \\sum_{i=0}^N w_i P_N(x_i)^2 = \\langle P_N, P_N \\rangle_Q\n$$\n所以，RHS 是向量 $\\alpha_N \\langle P_N, P_N \\rangle_Q (\\boldsymbol{W}\\boldsymbol{p})$。\n\n现在，我们分析左侧（LHS），$(\\boldsymbol{M} - \\boldsymbol{W})\\boldsymbol{p} = \\boldsymbol{M}\\boldsymbol{p} - \\boldsymbol{W}\\boldsymbol{p}$。$\\boldsymbol{M}\\boldsymbol{p}$ 的第 $i$ 个分量是：\n$$\n(\\boldsymbol{M}\\boldsymbol{p})_i = \\sum_{j=0}^{N} \\boldsymbol{M}_{ij}p_j = \\sum_{j=0}^{N} \\left(\\int_{-1}^{1} \\ell_i(x)\\ell_j(x)\\,dx\\right) P_N(x_j) = \\int_{-1}^{1} \\ell_i(x) \\left(\\sum_{j=0}^{N} P_N(x_j)\\ell_j(x)\\right)\\,dx\n$$\n求和式 $\\sum_{j=0}^{N} P_N(x_j)\\ell_j(x)$ 是 $V_N$ 中在 $N+1$ 个 GLL 节点上插值 $P_N(x)$ 的唯一多项式。由于 $P_N(x)$ 本身就在 $V_N$ 中，这个插值多项式就是 $P_N(x)$。因此：\n$$\n(\\boldsymbol{M}\\boldsymbol{p})_i = \\int_{-1}^{1} \\ell_i(x)P_N(x)\\,dx = \\langle \\ell_i, P_N \\rangle\n$$\n因此 LHS 向量的第 $i$ 个分量是 $\\langle \\ell_i, P_N \\rangle - (\\boldsymbol{W}\\boldsymbol{p})_i = \\langle \\ell_i, P_N \\rangle - w_i p_i$。\n\n令 LHS 和 RHS 的第 $i$ 个分量相等：\n$$\n\\langle \\ell_i, P_N \\rangle - w_i p_i = \\alpha_N \\langle P_N, P_N \\rangle_Q (w_i p_i)\n$$\n为消去基函数 $\\ell_i$，我们乘以 $p_i = P_N(x_i)$ 并对 $i$ 求和：\n$$\n\\sum_{i=0}^N p_i (\\langle \\ell_i, P_N \\rangle - w_i p_i) = \\sum_{i=0}^N p_i \\left( \\alpha_N \\langle P_N, P_N \\rangle_Q (w_i p_i) \\right)\n$$\nLHS 变为：\n$$\n\\sum_{i=0}^N P_N(x_i) \\langle \\ell_i, P_N \\rangle - \\sum_{i=0}^N w_i P_N(x_i)^2 = \\int_{-1}^{1} \\left(\\sum_{i=0}^N P_N(x_i)\\ell_i(x)\\right)P_N(x)\\,dx - \\langle P_N, P_N \\rangle_Q\n$$\n使用 $\\sum_{i=0}^N P_N(x_i)\\ell_i(x) = P_N(x)$，LHS 简化为 $\\langle P_N, P_N \\rangle - \\langle P_N, P_N \\rangle_Q$。\n\nRHS 变为：\n$$\n\\alpha_N \\langle P_N, P_N \\rangle_Q \\sum_{i=0}^N w_i P_N(x_i)^2 = \\alpha_N \\langle P_N, P_N \\rangle_Q \\langle P_N, P_N \\rangle_Q = \\alpha_N \\left( \\langle P_N, P_N \\rangle_Q \\right)^2\n$$\n令简化后的 LHS 和 RHS 相等：\n$$\n\\langle P_N, P_N \\rangle - \\langle P_N, P_N \\rangle_Q = \\alpha_N \\left( \\langle P_N, P_N \\rangle_Q \\right)^2\n$$\n解出 $\\alpha_N$：\n$$\n\\alpha_N = \\frac{\\langle P_N, P_N \\rangle - \\langle P_N, P_N \\rangle_Q}{\\left( \\langle P_N, P_N \\rangle_Q \\right)^2}\n$$\n为了计算这个表达式，我们使用两个基本事实：\n1. Legendre 多项式的正交性给出了连续内积：\n$$\n\\langle P_N, P_N \\rangle = \\int_{-1}^{1} [P_N(x)]^2\\,dx = \\frac{2}{2N+1}\n$$\n2. GLL 求积权重的一个性质是对于所有节点 $i=0, \\dots, N$，都有 $w_i = \\frac{2}{N(N+1)[P_N(x_i)]^2}$。这使我们能够计算离散内积：\n$$\n\\langle P_N, P_N \\rangle_Q = \\sum_{i=0}^{N} w_i [P_N(x_i)]^2 = \\sum_{i=0}^{N} \\frac{2}{N(N+1)[P_N(x_i)]^2} [P_N(x_i)]^2 = \\sum_{i=0}^{N} \\frac{2}{N(N+1)}\n$$\n因为求和中有 $N+1$ 项：\n$$\n\\langle P_N, P_N \\rangle_Q = (N+1) \\frac{2}{N(N+1)} = \\frac{2}{N}\n$$\n将这些结果代入 $\\alpha_N$ 的表达式中：\n$$\n\\alpha_N = \\frac{\\frac{2}{2N+1} - \\frac{2}{N}}{\\left(\\frac{2}{N}\\right)^2} = \\frac{2\\left(\\frac{N - (2N+1)}{N(2N+1)}\\right)}{\\frac{4}{N^2}} = \\frac{2\\left(\\frac{-N-1}{N(2N+1)}\\right)}{\\frac{4}{N^2}}\n$$\n$$\n\\alpha_N = -\\frac{2(N+1)}{N(2N+1)} \\cdot \\frac{N^2}{4} = -\\frac{N(N+1)}{2(2N+1)}\n$$\n这就是 $\\alpha_N$ 的闭式表达式。", "answer": "$$\\boxed{-\\frac{N(N+1)}{2(2N+1)}}$$", "id": "3425399"}, {"introduction": "在复杂几何形状或使用某些特定基函数时，强加狄利克雷（Dirichlet）边界条件可能十分繁琐。本练习介绍了一种强大的弱施加边界条件的技术——尼茨赫方法（Nitsche's method）。你将推导保证系统稳定性（矫顽性）所必需的罚参数的标度律（scaling law），从而阐明必须如何审慎地设计试探与检验空间的相互作用以确保数值格式的稳健性 ([@problem_id:3425415])。", "problem": "考虑在有界 Lipschitz 域 $\\Omega \\subset \\mathbb{R}^{d}$ 上的二阶椭圆边值问题，其边界为 $\\Gamma := \\partial \\Omega$：\n$$\n-\\nabla \\cdot (\\kappa \\nabla u) = f \\quad \\text{in } \\Omega, \n\\qquad\nu = g \\quad \\text{on } \\Gamma,\n$$\n其中 $\\kappa > 0$ 是一个常数扩散系数，$f \\in L^{2}(\\Omega)$，以及 $g \\in H^{1/2}(\\Gamma)$。设 $\\mathcal{T}_{h}$ 是 $\\Omega$ 的一个形状正则、拟一致的网格，其特征网格尺寸为 $h$，并设 $V_{h} \\subset H^{1}(\\Omega)$ 是在 $\\mathcal{T}_{h}$ 上的一个由 $p \\ge 1$ 次的连续分片多项式构成的协调空间（典型的高阶谱元离散化）。测试空间与试探空间相同，即 Galerkin 方法基于 $V_{h} \\times V_{h}$。\n\n构造 Nitsche 方法，该方法使用一个对称、一致的双线性形式和一个带有参数 $\\gamma = \\gamma(h,p,\\kappa) > 0$ 的边界罚项来弱施加 Dirichlet 边界条件。然后，从基本原理（分部积分、Cauchy–Schwarz 不等式、Young 不等式，以及在形状正则网格上的标准多项式反估计/迹估计）出发，推导出一个关于 $h$ 和 $p$ 的充分下界缩放关系，以保证离散双线性形式在 $V_{h}$ 上关于能量范数是矫顽的。将“无过度惩罚”解释为确定在 $h$ 和 $p$ 上的渐近最小缩放关系（在不考虑与 $h$ 和 $p$ 无关的乘法常数的情况下），该缩放关系能确保矫顽性。\n\n请以闭合形式提供渐近最小惩罚缩放 $\\gamma(h,p,\\kappa)$ 作为您的最终答案，忽略任何与 $h$ 和 $p$ 无关的普适乘法常数。最终表达式中不要求进行数值舍入，也不应包含任何单位。最终答案必须是单一的解析表达式。", "solution": "**1. 对称 Nitsche 方法的构造**\n\n我们从问题的强形式开始：$-\\nabla \\cdot (\\kappa \\nabla u) = f$。为了推导弱形式，我们乘以一个测试函数 $v \\in V_h$ 并在域 $\\Omega$ 上积分。\n$$\n- \\int_{\\Omega} v (\\nabla \\cdot (\\kappa \\nabla u)) \\, d\\Omega = \\int_{\\Omega} v f \\, d\\Omega\n$$\n应用分部积分（格林第一恒等式），我们得到：\n$$\n\\int_{\\Omega} \\kappa \\nabla u \\cdot \\nabla v \\, d\\Omega - \\int_{\\Gamma} v (\\kappa \\nabla u \\cdot \\mathbf{n}) \\, d\\Gamma = \\int_{\\Omega} f v \\, d\\Omega\n$$\n其中 $\\mathbf{n}$ 是 $\\Gamma$ 上的外向单位法向量。我们将法向导数 $\\nabla u \\cdot \\mathbf{n}$ 记为 $\\frac{\\partial u}{\\partial \\mathbf{n}}$。\n\n标准的 Galerkin 方法要求试探空间满足 Dirichlet 边界条件。Nitsche 方法弱施加此条件。对称变体被构造成一致且对称的。我们寻求一个离散解 $u_h \\in V_h$，使得对于所有测试函数 $v_h \\in V_h$，以下方程成立：\n$$\nB(u_h, v_h) = F(v_h)\n$$\n双线性形式 $B(u, v)$ 和线性泛函 $F(v)$ 构造如下。我们从分部积分的左侧 $\\int_{\\Omega} \\kappa \\nabla u_h \\cdot \\nabla v_h \\, d\\Omega$ 开始，并减去一些项来施加边界条件。我们减去一个涉及 $u_h$ 法向通量的项，并添加一个涉及 $v_h$ 法向通量的对称对应项。我们还添加一个罚项以确保稳定性。\n得到的对称 Nitsche 格式为：求 $u_h \\in V_h$，使得对于所有 $v_h \\in V_h$：\n$$\n\\int_{\\Omega} \\kappa \\nabla u_h \\cdot \\nabla v_h \\, d\\Omega - \\int_{\\Gamma} \\kappa v_h \\frac{\\partial u_h}{\\partial \\mathbf{n}} \\, d\\Gamma - \\int_{\\Gamma} \\kappa (u_h - g) \\frac{\\partial v_h}{\\partial \\mathbf{n}} \\, d\\Gamma + \\int_{\\Gamma} \\gamma (u_h - g) v_h \\, d\\Gamma = \\int_{\\Omega} f v_h \\, d\\Omega\n$$\n该方法是一致的，因为如果代入精确解 $u$，涉及 $(u-g)$ 的项在 $\\Gamma$ 上消失，方程简化为原始的弱形式。\n\n通过重新整理各项，我们可以确定双线性形式 $B(u_h, v_h)$ 和线性形式 $F(v_h)$：\n$$\nB(u_h, v_h) = \\int_{\\Omega} \\kappa \\nabla u_h \\cdot \\nabla v_h \\, d\\Omega - \\int_{\\Gamma} \\kappa v_h \\frac{\\partial u_h}{\\partial \\mathbf{n}} \\, d\\Gamma - \\int_{\\Gamma} \\kappa u_h \\frac{\\partial v_h}{\\partial \\mathbf{n}} \\, d\\Gamma + \\int_{\\Gamma} \\gamma u_h v_h \\, d\\Gamma\n$$\n$$\nF(v_h) = \\int_{\\Omega} f v_h \\, d\\Omega - \\int_{\\Gamma} \\kappa g \\frac{\\partial v_h}{\\partial \\mathbf{n}} \\, d\\Gamma + \\int_{\\Gamma} \\gamma g v_h \\, d\\Gamma\n$$\n通过观察可知，双线性形式 $B(u_h, v_h)$ 是对称的。\n\n**2. 矫顽性条件的推导**\n\n为确保离散系统解的存在性和唯一性，双线性形式 $B(v_h, v_h)$ 必须在空间 $V_h$ 上是矫顽的。我们对任意函数 $v_h \\in V_h$ 分析 $B(v_h, v_h)$：\n$$\nB(v_h, v_h) = \\int_{\\Omega} \\kappa |\\nabla v_h|^2 \\, d\\Omega - 2\\int_{\\Gamma} \\kappa v_h \\frac{\\partial v_h}{\\partial \\mathbf{n}} \\, d\\Gamma + \\int_{\\Gamma} \\gamma v_h^2 \\, d\\Gamma\n$$\n令 $\\| \\cdot \\|_{0,\\Omega}$ 表示 $L^2(\\Omega)$-范数，$\\| \\cdot \\|_{0,\\Gamma}$ 表示 $L^2(\\Gamma)$-范数。则：\n$$\nB(v_h, v_h) = \\kappa \\|\\nabla v_h\\|_{0,\\Omega}^2 - 2\\kappa \\int_{\\Gamma} v_h \\frac{\\partial v_h}{\\partial \\mathbf{n}} \\, d\\Gamma + \\gamma \\|v_h\\|_{0,\\Gamma}^2\n$$\n第二项必须被控制。我们对积分应用 Cauchy-Schwarz 不等式：\n$$\n\\left| -2\\kappa \\int_{\\Gamma} v_h \\frac{\\partial v_h}{\\partial \\mathbf{n}} \\, d\\Gamma \\right| \\le 2\\kappa \\|v_h\\|_{0,\\Gamma} \\left\\| \\frac{\\partial v_h}{\\partial \\mathbf{n}} \\right\\|_{0,\\Gamma}\n$$\n接下来，我们对任意 $\\epsilon > 0$ 应用 Young 不等式，$2ab \\le \\frac{1}{\\epsilon} a^2 + \\epsilon b^2$：\n$$\n2\\kappa \\|v_h\\|_{0,\\Gamma} \\left\\| \\frac{\\partial v_h}{\\partial \\mathbf{n}} \\right\\|_{0,\\Gamma} \\le \\frac{1}{\\epsilon} \\|v_h\\|_{0,\\Gamma}^2 + \\epsilon \\kappa^2 \\left\\| \\frac{\\partial v_h}{\\partial \\mathbf{n}} \\right\\|_{0,\\Gamma}^2\n$$\n将此界代入 $B(v_h, v_h)$ 的表达式中：\n$$\nB(v_h, v_h) \\ge \\kappa \\|\\nabla v_h\\|_{0,\\Omega}^2 + \\gamma \\|v_h\\|_{0,\\Gamma}^2 - \\frac{1}{\\epsilon} \\|v_h\\|_{0,\\Gamma}^2 - \\epsilon \\kappa^2 \\left\\| \\frac{\\partial v_h}{\\partial \\mathbf{n}} \\right\\|_{0,\\Gamma}^2\n$$\n将各项归类：\n$$\nB(v_h, v_h) \\ge \\kappa \\|\\nabla v_h\\|_{0,\\Omega}^2 - \\epsilon \\kappa^2 \\left\\| \\frac{\\partial v_h}{\\partial \\mathbf{n}} \\right\\|_{0,\\Gamma}^2 + \\left(\\gamma - \\frac{1}{\\epsilon}\\right) \\|v_h\\|_{0,\\Gamma}^2\n$$\n为了继续推导，我们需要对边界上的法向导数范数 $\\left\\| \\frac{\\partial v_h}{\\partial \\mathbf{n}} \\right\\|_{0,\\Gamma}$ 进行界定。由于 $|\\frac{\\partial v_h}{\\partial \\mathbf{n}}| = |\\nabla v_h \\cdot \\mathbf{n}| \\le |\\nabla v_h|$，我们有 $\\left\\| \\frac{\\partial v_h}{\\partial \\mathbf{n}} \\right\\|_{0,\\Gamma} \\le \\|\\nabla v_h\\|_{0,\\Gamma}$。我们现在引用一个标准的多项式迹反不等式，它将函数梯度在单元边界上的范数与其在内部的范数联系起来。对于函数 $v_h \\in V_h$，在尺寸为 $h$ 的形状正则网格上，该不等式为：\n$$\n\\|\\nabla v_h\\|_{0,\\Gamma}^2 = \\sum_{F \\in \\mathcal{F}_h^{\\Gamma}} \\|\\nabla v_h\\|_{0,F}^2 \\le C_{inv} \\frac{p^2}{h} \\sum_{K \\in \\mathcal{T}_h} \\|\\nabla v_h\\|_{0,K}^2 = C_{inv} \\frac{p^2}{h} \\|\\nabla v_h\\|_{0,\\Omega}^2\n$$\n其中 $\\mathcal{F}_h^\\Gamma$ 是边界 $\\Gamma$ 上的面集合，而 $C_{inv}$ 是与 $h$、$p$ 和 $\\kappa$ 无关的常数。缩放因子 $\\frac{p^2}{h}$ 是高阶和谱元方法的特征。\n\n将此不等式代入 $B(v_h, v_h)$ 的界中：\n$$\nB(v_h, v_h) \\ge \\kappa \\|\\nabla v_h\\|_{0,\\Omega}^2 - \\epsilon \\kappa^2 \\left( C_{inv} \\frac{p^2}{h} \\|\\nabla v_h\\|_{0,\\Omega}^2 \\right) + \\left(\\gamma - \\frac{1}{\\epsilon}\\right) \\|v_h\\|_{0,\\Gamma}^2\n$$\n我们收集范数项的系数：\n$$\nB(v_h, v_h) \\ge \\kappa \\left( 1 - \\epsilon \\kappa C_{inv} \\frac{p^2}{h} \\right) \\|\\nabla v_h\\|_{0,\\Omega}^2 + \\left(\\gamma - \\frac{1}{\\epsilon}\\right) \\|v_h\\|_{0,\\Gamma}^2\n$$\n为了保证矫顽性，我们要求两项的系数都为正。这给了我们两个条件：\n1. $1 - \\epsilon \\kappa C_{inv} \\frac{p^2}{h} > 0 \\implies \\epsilon  \\frac{h}{\\kappa C_{inv} p^2}$\n2. $\\gamma - \\frac{1}{\\epsilon} > 0 \\implies \\gamma > \\frac{1}{\\epsilon}$\n\n结合这两个条件，我们必须能够选择 $\\epsilon$ 和 $\\gamma$ 使得：\n$$\n\\gamma > \\frac{1}{\\epsilon} > \\kappa C_{inv} \\frac{p^2}{h}\n$$\n这表明，要使方法具有矫顽性，惩罚参数 $\\gamma$ 的选择必须大于 $\\kappa C_{inv} \\frac{p^2}{h}$。一个充分条件是选择 $\\gamma = \\gamma_0 \\kappa \\frac{p^2}{h}$，其中 $\\gamma_0 > C_{inv}$ 是某个常数。如果这样做，我们总能找到一个满足所需不等式的 $\\epsilon$（例如，在区间 $(\\frac{h}{\\gamma_0 \\kappa p^2}, \\frac{h}{C_{inv} \\kappa p^2})$ 中的任何 $\\epsilon$）。\n\n**3. 渐近最小缩放关系**\n\n推导表明，为保证矫顽性，惩罚参数 $\\gamma$ 的缩放速度必须至少与 $\\kappa \\frac{p^2}{h}$ 一样快。选择比这增长更慢的缩放关系将无法满足任何常数前因子选择下的必要条件。因此，确保矫顽性的惩罚参数 $\\gamma$ 的渐近最小缩放关系（无过度惩罚）与 $\\kappa \\frac{p^2}{h}$ 成正比。问题要求以闭合形式提供此缩放关系，忽略任何与 $h$ 和 $p$ 无关的乘法常数。\n\n因此，缩放的最终表达式为：\n$$\n\\gamma(h, p, \\kappa) \\sim \\kappa \\frac{p^2}{h}\n$$", "answer": "$$\n\\boxed{\\kappa \\frac{p^2}{h}}\n$$", "id": "3425415"}]}