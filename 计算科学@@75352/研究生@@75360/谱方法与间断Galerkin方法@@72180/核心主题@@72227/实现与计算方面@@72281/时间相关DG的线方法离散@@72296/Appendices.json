{"hands_on_practices": [{"introduction": "在时间相关的偏微分方程的求解中，线方法（Method of Lines）的第一步是将空间变量离散化，从而将偏微分方程（PDE）转化为一个常微分方程（ODE）组。这个练习将指导你完成这一基本过程，针对一个双曲守恒律，推导出间断伽辽金（DG）方法的半离散格式。通过这个实践，你将深入理解质量矩阵、体积项以及界面上的数值通量是如何共同构成一个形如 $M\\dot{\\mathbf{u}} = \\mathbf{R}(\\mathbf{u})$ 的ODE系统的，为后续的时间积分奠定基础 [@problem_id:3399419]。", "problem": "考虑定义在有界区间 $\\Omega = [a,b]$ 上的一维守恒律 $u_t + f(u)_x = 0$，其中 $u(x,t)$ 是一个标量，$f(u)$ 是一个光滑通量函数。设 $\\Omega$ 被划分为 $N$ 个不相交的开单元 $K_j = (x_{j-\\frac{1}{2}}, x_{j+\\frac{1}{2}})$（$j = 1,\\dots,N$），界面位于点 $x_{j\\pm\\frac{1}{2}}$。在每个单元 $K_j$ 上，用一个次数最多为 $p$ 的多项式 $u_h(x,t) \\in P^p(K_j)$ 来近似 $u(x,t)$，该多项式在一组选定的局部基 $\\{\\phi_{j,m}(x)\\}_{m=0}^{p}$ 中展开，即 $u_h(x,t) = \\sum_{m=0}^{p} c_{j,m}(t)\\,\\phi_{j,m}(x)$，其中 $\\{c_{j,m}(t)\\}$ 是随时间变化的模态系数。\n\n使用间断Galerkin (DG) 方法和直线法离散，通过将守恒律乘以一个测试函数 $v \\in P^p(K_j)$，在每个单元上进行分部积分，并在界面处用一个依赖于内部迹 $u^-$ 和外部迹 $u^+$ 的相容数值通量 $\\hat{f}(u^-,u^+)$ 来替换物理通量 $f(u)$，从而构建单元上的半离散方程。通过选择局部Lax–Friedrichs形式的数值通量 $\\hat{f}(u^-,u^+) = \\{f(u)\\} - \\frac{\\alpha}{2}[u]$，明确指出界面的跳跃和平均是如何通过数值通量引入的。其中，$\\{f(u)\\} = \\frac{1}{2}\\big(f(u^-)+f(u^+)\\big)$，$[u] = u^+ - u^-$，且 $\\alpha \\ge \\sup_{s \\in [u^-,u^+]}|f'(s)|$ 是波速的局部界。\n\n请详细推导模态系数 $c_{j,m}(t)$ 的半离散常微分方程，该方程应以单元质量矩阵元 $M_{j,mq} = \\int_{K_j} \\phi_{j,m}(x)\\,\\phi_{j,q}(x)\\,\\mathrm{d}x$、包含 $f(u_h)$ 和 $\\partial_x\\phi_{j,q}$ 的体积分项，以及在 $x_{j\\pm\\frac{1}{2}}$ 处通过使用相邻单元迹计算的 $\\{f(u)\\}$ 和 $[u]$ 表示的两个界面贡献项来表达。你的最终答案必须是 $\\dot{c}_{j,m}(t)$ 的一个单一闭式解析表达式，使用指数记法，并包含以平均和跳跃形式写出的数值通量。不需要进行数值计算，除了在界面处使用内部/外部迹外，也无需施加任何边界条件。最终答案不应包含任何单位。", "solution": "用户希望我扮演一位严谨的理工科教授，解决一个关于间断Galerkin (DG) 方法的问题。\n\n首先，我将验证问题陈述。\n\n### 步骤1：提取已知条件\n- **守恒律**：$u_t + f(u)_x = 0$ 于 $\\Omega = [a,b]$。\n- **解的形式**：$u(x,t)$ 是一个标量函数，$f(u)$ 是一个光滑通量函数。\n- **离散化**：区域 $\\Omega$ 被划分为 $N$ 个不相交的开单元 $K_j = (x_{j-\\frac{1}{2}}, x_{j+\\frac{1}{2}})$，其中 $j = 1,\\dots,N$。\n- **近似**：在每个单元 $K_j$ 上，解被一个次数最多为 $p$ 的多项式 $u_h(x,t) \\in P^p(K_j)$ 近似。\n- **基展开**：单元 $K_j$ 上的近似由 $u_h(x,t) = \\sum_{m=0}^{p} c_{j,m}(t)\\,\\phi_{j,m}(x)$ 给出，其中 $\\{\\phi_{j,m}(x)\\}_{m=0}^{p}$ 是 $P^p(K_j)$ 的局部基，$\\{c_{j,m}(t)\\}$ 是随时间变化的模态系数。\n- **DG格式**：将偏微分方程乘以测试函数 $v \\in P^p(K_j)$ 并在每个单元 $K_j$ 上进行分部积分。\n- **数值通量**：界面处的物理通量 $f(u)$ 被一个相容的数值通量 $\\hat{f}(u^-,u^+)$ 所取代，其中 $u^-$ 和 $u^+$ 是界面处的内部和外部迹。\n- **特定的数值通量**：指定了局部Lax–Friedrichs通量：$\\hat{f}(u^-,u^+) = \\{f(u)\\} - \\frac{\\alpha}{2}[u]$。\n- **通量定义**：平均和跳跃算子定义为 $\\{f(u)\\} = \\frac{1}{2}\\big(f(u^-)+f(u^+)\\big)$ 和 $[u] = u^+ - u^-$。\n- **稳定化参数**：$\\alpha \\ge \\sup_{s \\in [u^-,u^+]}|f'(s)|$ 是特征速度的局部界。\n- **矩阵定义**：单元质量矩阵元为 $M_{j,mq} = \\int_{K_j} \\phi_{j,m}(x)\\,\\phi_{j,q}(x)\\,\\mathrm{d}x$。\n\n### 步骤2：使用提取的已知条件进行验证\n- **科学上成立**：该问题描述了双曲守恒律的间断Galerkin (DG) 方法的标准格式，这是现代偏微分方程数值方法的基石。直线法、局域多项式近似、弱形式和数值通量（特别是Lax-Friedrichs通量）的使用都是标准且完善的概念。该问题在科学上是合理的。\n- **良定的**：半离散常微分方程组的推导是一个定义明确的数学过程。该问题提供了唯一地执行此推导所需的所有信息。\n- **客观的**：该问题以精确、客观和标准的数学术语陈述，没有任何主观性或歧义。\n\n根据这些标准，该问题没有任何缺陷。它在科学上是合理的、自洽的且良定的。\n\n### 步骤3：结论与行动\n问题是有效的。我将开始推导解答。\n\n模态系数的半离散常微分方程 (ODE) 的推导始于守恒律 $u_t + f(u)_x = 0$ 在单元 $K_j = (x_{j-\\frac{1}{2}}, x_{j+\\frac{1}{2}})$ 上的弱形式。我们将该偏微分方程乘以一个测试函数 $v_h(x) \\in P^p(K_j)$ 并在单元 $K_j$ 上积分：\n$$ \\int_{K_j} \\frac{\\partial u_h}{\\partial t} v_h(x) \\, \\mathrm{d}x + \\int_{K_j} \\frac{\\partial f(u_h)}{\\partial x} v_h(x) \\, \\mathrm{d}x = 0 $$\n此处，$u_h$ 是解 $u$ 在 $K_j$ 上的多项式近似。\n\n包含通量导数的第二项进行分部积分：\n$$ \\int_{K_j} \\frac{\\partial f(u_h)}{\\partial x} v_h(x) \\, \\mathrm{d}x = \\left[ f(u_h(x,t)) v_h(x) \\right]_{x_{j-\\frac{1}{2}}}^{x_{j+\\frac{1}{2}}} - \\int_{K_j} f(u_h(x,t)) \\frac{\\mathrm{d}v_h(x)}{\\mathrm{d}x} \\, \\mathrm{d}x $$\n边界项计算为：\n$$ \\left[ f(u_h) v_h \\right]_{x_{j-\\frac{1}{2}}}^{x_{j+\\frac{1}{2}}} = f(u_h(x_{j+\\frac{1}{2}}^-,t))v_h(x_{j+\\frac{1}{2}}) - f(u_h(x_{j-\\frac{1}{2}}^+,t))v_h(x_{j-\\frac{1}{2}}) $$\n其中 $u_h(x_{j\\pm\\frac{1}{2}}^\\mp)$ 表示解 $u_h$ 在相应界面上从单元 $K_j$ 内部取到的迹。\n\n将此代回弱形式，得到：\n$$ \\int_{K_j} \\frac{\\partial u_h}{\\partial t} v_h \\, \\mathrm{d}x = \\int_{K_j} f(u_h) \\frac{\\mathrm{d}v_h}{\\mathrm{d}x} \\, \\mathrm{d}x - f(u_h(x_{j+\\frac{1}{2}}^-))v_h(x_{j+\\frac{1}{2}}) + f(u_h(x_{j-\\frac{1}{2}}^+))v_h(x_{j-\\frac{1}{2}}) $$\n在间断Galerkin方法中，间断界面处的单值物理通量被一个数值通量函数 $\\hat{f}(u^-, u^+)$ 所取代，该函数依赖于界面两侧的两个状态。在界面 $x_{j+\\frac{1}{2}}$ 处，左侧状态（来自单元 $K_j$）为 $u_h(x_{j+\\frac{1}{2}}^-)$，右侧状态（来自 $K_{j+1}$）为 $u_h(x_{j+\\frac{1}{2}}^+)$。在界面 $x_{j-\\frac{1}{2}}$ 处，左侧状态（来自 $K_{j-1}$）为 $u_h(x_{j-\\frac{1}{2}}^-)$，右侧状态（来自 $K_j$）为 $u_h(x_{j-\\frac{1}{2}}^+)$。\n弱形式变为：\n$$ \\int_{K_j} \\frac{\\partial u_h}{\\partial t} v_h \\, \\mathrm{d}x = \\int_{K_j} f(u_h) \\frac{\\mathrm{d}v_h}{\\mathrm{d}x} \\, \\mathrm{d}x - \\hat{f}_{j+\\frac{1}{2}}v_h(x_{j+\\frac{1}{2}}) + \\hat{f}_{j-\\frac{1}{2}}v_h(x_{j-\\frac{1}{2}}) $$\n其中 $\\hat{f}_{j+\\frac{1}{2}} = \\hat{f}(u_h(x_{j+\\frac{1}{2}}^-), u_h(x_{j+\\frac{1}{2}}^+))$ 且 $\\hat{f}_{j-\\frac{1}{2}} = \\hat{f}(u_h(x_{j-\\frac{1}{2}}^-), u_h(x_{j-\\frac{1}{2}}^+))$。\n\n为获得系数的常微分方程组，我们代入基展开 $u_h(x,t) = \\sum_{m=0}^{p} c_{j,m}(t)\\,\\phi_{j,m}(x)$ 并选择基函数作为测试函数，即 $v_h(x) = \\phi_{j,q}(x)$（$q=0, \\dots, p$）。\n$$ \\int_{K_j} \\left( \\sum_{m=0}^{p} \\frac{\\mathrm{d}c_{j,m}}{\\mathrm{d}t} \\phi_{j,m}(x) \\right) \\phi_{j,q}(x) \\, \\mathrm{d}x = \\int_{K_j} f(u_h) \\frac{\\mathrm{d}\\phi_{j,q}}{\\mathrm{d}x} \\, \\mathrm{d}x - \\hat{f}_{j+\\frac{1}{2}} \\phi_{j,q}(x_{j+\\frac{1}{2}}) + \\hat{f}_{j-\\frac{1}{2}} \\phi_{j,q}(x_{j-\\frac{1}{2}}) $$\n左侧可以用质量矩阵元 $M_{j,qm} = \\int_{K_j} \\phi_{j,q}(x)\\,\\phi_{j,m}(x)\\,\\mathrm{d}x$ 来表示。由于乘法是可交换的，$M_{j,qm} = M_{j,mq}$。方程变为：\n$$ \\sum_{m=0}^{p} M_{j,qm} \\frac{\\mathrm{d}c_{j,m}}{\\mathrm{d}t} = R_{j,q}(t) $$\n其中 $R_{j,q}(t)$ 是右端项，它依赖于单元 $j$ 及其相邻单元的系数。对于单元 $j$，其矩阵形式为 $\\mathbf{M}_j \\dot{\\mathbf{c}}_j = \\mathbf{R}_j$。\n\n问题要求给出 $\\dot{c}_{j,m}(t)$ 的显式表达式，这需要对质量矩阵求逆：$\\dot{\\mathbf{c}}_j = \\mathbf{M}_j^{-1} \\mathbf{R}_j$。其分量形式为：\n$$ \\frac{\\mathrm{d}c_{j,m}}{\\mathrm{d}t} = \\sum_{q=0}^{p} (M_j^{-1})_{mq} R_{j,q}(t) $$\n现在，我们代入指定的局部Lax-Friedrichs通量：$\\hat{f}(u^-,u^+) = \\{f(u)\\} - \\frac{\\alpha}{2}[u]$。\n在界面 $x_{j+\\frac{1}{2}}$ 处：$\\hat{f}_{j+\\frac{1}{2}} = \\{f(u_h)\\}_{j+\\frac{1}{2}} - \\frac{\\alpha_{j+\\frac{1}{2}}}{2}[u_h]_{j+\\frac{1}{2}}$。在界面 $x_{j-\\frac{1}{2}}$ 处：$\\hat{f}_{j-\\frac{1}{2}} = \\{f(u_h)\\}_{j-\\frac{1}{2}} - \\frac{\\alpha_{j-\\frac{1}{2}}}{2}[u_h]_{j-\\frac{1}{2}}$。\n界面处的跳跃 $[u_h]$ 是 $u_h^+ - u_h^-$，平均 $\\{f(u_h)\\}$ 是 $\\frac{1}{2}(f(u_h^-)+f(u_h^+))$。\n\n结合这些要素，得到模态系数 $c_{j,m}(t)$ 的最终半离散方程：\n$$ \\frac{\\mathrm{d}c_{j,m}}{\\mathrm{d}t} = \\sum_{q=0}^{p} (M_j^{-1})_{mq} \\left[ \\int_{K_j} f(u_h) \\frac{\\mathrm{d}\\phi_{j,q}}{\\mathrm{d}x} \\, \\mathrm{d}x - \\hat{f}_{j+\\frac{1}{2}} \\phi_{j,q}(x_{j+\\frac{1}{2}}) + \\hat{f}_{j-\\frac{1}{2}} \\phi_{j,q}(x_{j-\\frac{1}{2}}) \\right] $$\n代入数值通量的显式形式，即可得到最终表达式。量 $u_h$ 及其迹依赖于单元 $j$ 及其相邻单元的系数 $\\{c_{j,m}(t)\\}$，这使得该常微分方程组是耦合的。", "answer": "$$ \\boxed{ \\dot{c}_{j,m}(t) = \\sum_{q=0}^{p} (M_j^{-1})_{mq} \\left[ \\int_{K_j} f(u_h) \\frac{\\mathrm{d}\\phi_{j,q}}{\\mathrm{d}x} \\, \\mathrm{d}x - \\left( \\{f(u_h)\\}_{j+\\frac{1}{2}} - \\frac{\\alpha_{j+\\frac{1}{2}}}{2}[u_h]_{j+\\frac{1}{2}} \\right) \\phi_{j,q}(x_{j+\\frac{1}{2}}) + \\left( \\{f(u_h)\\}_{j-\\frac{1}{2}} - \\frac{\\alpha_{j-\\frac{1}{2}}}{2}[u_h]_{j-\\frac{1}{2}} \\right) \\phi_{j,q}(x_{j-\\frac{1}{2}}) \\right] } $$", "id": "3399419"}, {"introduction": "建立了半离散ODE系统后，下一步是选择时间积分方法并分析其稳定性。本练习探讨了最简单的情形：将一个显式时间积分方法（如前向欧拉法）应用于一个线性扩散问题的DG离散系统。通过这个实践，你将揭示空间离散算子的特征值与保证数值稳定所需的时间步长之间的关键联系 [@problem_id:3399416]，这是理解显式方法CFL条件本质的重要一步。", "problem": "考虑一维线性扩散方程 $u_{t}=\\nu u_{xx}$，定义在一个周期区间上，使用多项式次数为 $p$ 的对称内罚间断伽辽金 (DG) 方法在均匀网格上进行空间离散。这将得到一个线方法半离散系统 $M \\dot{\\mathbf{u}}(t)=K \\mathbf{u}(t)$，其中质量矩阵 $M$ 是对称正定的，刚度矩阵 $K$ 在罚项足够大时是对称半负定的，以及线性算子 $A=M^{-1}K$。假设采用周期性边界条件，因此 $A$ 的所有特征值均为实数且非正。\n\n设时间积分通过前向欧拉显式龙格-库塔 (RK) 方法进行，其稳定性函数为 $R(z)=1+z$。从线方法公式和稳定性函数的定义出发，完成以下任务：\n\n- 用 $R$ 和 $A$ 表示单步线性放大矩阵 $G$（您必须根据第一性原理对线性常系数右端项的情况证明该表达式）。\n- 仅使用谱半径 $\\rho(A)$ 和 $A$ 的假定谱位置，推导最大时间步长界限 $\\Delta t_{\\max}$，使得所有 DG 模态在单步内不被放大，即最大模态放大因子的模长小于或等于 $1$。您的界限必须是仅用 $\\rho(A)$ 表示的闭式解析表达式。\n\n您的最终答案必须是 $\\Delta t_{\\max}$ 的单一表达式。不需要进行数值舍入。", "solution": "我们从线方法半离散系统 $M \\dot{\\mathbf{u}}(t)=K \\mathbf{u}(t)$ 开始。由于 $M$ 是对称正定的，我们可以将该系统重写为标准线性形式\n$$\n\\dot{\\mathbf{u}}(t) = A \\mathbf{u}(t), \\quad A := M^{-1}K.\n$$\n根据对称内罚离散化和周期性边界条件的假设，当罚项足够大时，$K$ 是对称半负定的，因此 $A$ 通过由 $M^{1/2}$ 诱导的合同变换与一个对称半负定矩阵相似。特别地，$A$ 的所有特征值都是实数且非正。\n\n让我们回顾一下应用于线性测试问题的单步法稳定性函数的基本定义。对于线性右端项 $\\dot{\\mathbf{u}}(t)=A \\mathbf{u}(t)$ 和稳定性函数为 $R(z)$ 的单步时间积分器，数值更新可以写成以下形式\n$$\n\\mathbf{u}^{n+1} = G \\,\\mathbf{u}^{n}, \\quad G = R(\\Delta t\\, A),\n$$\n其中 $R$ 通过其幂级数作用于矩阵参数。这是通过将该方法应用于标量测试方程 $y'=\\lambda y$（得到 $y^{n+1} = R(\\Delta t \\lambda) y^{n}$），然后在线性常系数情况下通过谱映射定理进行推广得出的：对于多项式 $R(z)=\\sum_{k=0}^{s} c_{k} z^{k}$，我们定义 $R(\\Delta t A)=\\sum_{k=0}^{s} c_{k} (\\Delta t)^{k} A^{k}$，这正是将该方法应用于 $\\dot{\\mathbf{u}}=A \\mathbf{u}$ 时的放大矩阵。\n\n专门针对前向欧拉法，其稳定性函数为 $R(z)=1+z$，我们得到\n$$\nG \\;=\\; R(\\Delta t A) \\;=\\; I + \\Delta t\\, A.\n$$\n\n现在我们推导一个步长界限，以保证所有模态在前向欧拉单步中不被放大。设 $\\{\\lambda_{j}\\}$ 表示 $A$ 的特征值。由于 $A$ 的特征值为实数且非正，可写作 $\\lambda_{j}=-r_{j}$，其中 $r_{j}\\ge 0$。作用于一个特征模态，标量放大因子为\n$$\ng(\\lambda_{j}) \\;=\\; R(\\Delta t \\lambda_{j}) \\;=\\; 1 + \\Delta t \\lambda_{j} \\;=\\; 1 - \\Delta t r_{j}.\n$$\n单步不放大要求对所有 $j$ 都有 $|g(\\lambda_{j})|\\le 1$。因为 $g(\\lambda_{j})$ 是实数，条件 $|1 - \\Delta t r_{j}| \\le 1$ 等价于\n$$\n-1 \\le 1 - \\Delta t r_{j} \\le 1 \\;\\;\\Longleftrightarrow\\;\\; 0 \\le \\Delta t r_{j} \\le 2.\n$$\n最严格的约束对应于最大的 $r_{j}$，即 $r_{\\max}=\\max_{j} r_{j} = \\rho(A)$，因为 $\\rho(A)=\\max_{j} |\\lambda_{j}|$ 且 $\\lambda_{j}\\le 0$。因此，\n$$\n\\Delta t \\,\\rho(A) \\le 2 \\;\\;\\Longleftrightarrow\\;\\; \\Delta t \\le \\frac{2}{\\rho(A)}.\n$$\n因此，保证所有 DG 模态在前向欧拉法下不被放大的最大时间步长是以下闭式表达式\n$$\n\\Delta t_{\\max} \\;=\\; \\frac{2}{\\rho(A)}.\n$$\n\n为完整起见，我们注意到所用的两个要素是：(i) 通过多项式稳定性函数为线性常系数系统证明的放大矩阵表示 $G=R(\\Delta t A)$，以及 (ii) $A$ 的谱位置（实数非正谱），它允许将稳定性不等式简化为沿负实轴的标量界限。", "answer": "$$\\boxed{\\dfrac{2}{\\rho(A)}}$$", "id": "3399416"}, {"introduction": "许多物理问题（如对流-扩散方程）涉及不同时间尺度的过程，这会导致ODE系统具有“刚性”（stiffness），使得纯显式方法的效率极低。本练习介绍了一种强大的解决方案：隐式-显式（IMEX）方法。你将应用一个IMEX-Runge-Kutta格式 [@problem_id:3399430]，对刚性项（扩散）进行隐式处理，而对非刚性项（对流）进行显式处理，这是一种在计算流体力学和许多其他领域中处理多尺度问题的常用策略。", "problem": "考虑标量对流-扩散方程 $u_{t} + \\partial_{x} f(u) = \\partial_{x}\\!\\left(\\nu\\, \\partial_{x} u\\right)$，该方程定义在一个一维域上，具有足够光滑的初始和边界数据、常数粘性 $\\nu > 0$ 以及一个光滑的通量函数 $f(u)$。设该域被划分为不重叠的单元，并考虑在每个单元上使用固定次数的多项式空间进行不连续伽辽金 (DG) 空间离散化。设 $\\{\\varphi_{i}\\}$ 表示 DG 空间的基，并将 DG 近似写为 $u_{h}(x,t) = \\sum_{i} U_{i}(t)\\,\\varphi_{i}(x)$，其系数向量为 $U(t)$。\n\n对于对流算子，在单元间边界上使用相容的单调数值通量，并在每个单元内对体积项进行分部积分，以获得 DG 对流残差。对于扩散算子，使用对称内部罚分伽辽金 (SIPG) 双线性形式，并选择足够大的罚参数以保证稳定性。用 $M$ 表示全局 DG 质量矩阵，用 $C(U)$ 表示组装的全局对流残差向量，用 $K_{\\nu}$ 表示组装的用于扩散的全局 SIPG 刚度矩阵，它是关于 $\\nu$ 的线性函数。假设 $\\nu$ 在空间上是常数，因此 $K_{\\nu} = \\nu K$，其中 $K$ 是由网格、罚项和基决定的对称半正定矩阵。\n\n1. 从 DG 线方法的第一性原理出发，推导形式为 $M\\,\\dot{U}(t) = E\\!\\left(U(t)\\right) + I\\!\\left(U(t)\\right)$ 的半离散系统，并识别出对应于显式对流和隐式扩散贡献的 $E(U)$ 和 $I(U)$。\n\n2. 对系统 $M\\,\\dot{U} = E(U) + I(U)$ 应用加法形式的隐式-显式龙格-库塔 (IMEX-RK) 时间离散化，使用二阶、二级的 Ascher–Ruuth–Spiteri 对（通常表示为 ARS$(2,2,2)$），其 Butcher 阵列如下。对于显式部分 $E(U)$，使用\n$$\nA = \\begin{pmatrix}\n0  0 \\\\\n1  0\n\\end{pmatrix},\\quad\nb^{\\top} = \\begin{pmatrix}\n1 - \\gamma  \\gamma\n\\end{pmatrix},\\quad\nc = \\begin{pmatrix}\n0 \\\\\n1\n\\end{pmatrix},\n$$\n对于对角隐式部分 $I(U)$，使用\n$\n\\hat{A} = \\begin{pmatrix}\n\\gamma  0 \\\\\n1 - \\gamma  \\gamma\n\\end{pmatrix},\\ \n\\hat{b}^{\\top} = \\begin{pmatrix}\n1 - \\gamma  \\gamma\n\\end{pmatrix},\\\n\\hat{c} = \\begin{pmatrix}\n\\gamma \\\\\n1\n\\end{pmatrix},\n$\n其中 $\\gamma = 1 - 1/\\sqrt{2}$。推导阶段方程和以质量矩阵形式表示的步进更新，并分离出在每个阶段为求解隐式扩散必须求解的代数系统。\n\n3. 在上述假设下（$\\nu$ 为常数，因此 $K_{\\nu} = \\nu K$，并使用 ARS$(2,2,2)$），识别出每个时间步只分解一次并在两个阶段中重复使用的精确对称正定矩阵。以精确的符号表达式形式给出你的最终答案，用 $M$、$\\Delta t$、$\\gamma$、$\\nu$ 和 $K$ 表示。\n\n你的最终答案必须是单一的闭式解析表达式。不包括单位。不要近似 $\\gamma$；保持其精确值。", "solution": "该问题被评估为有效，因为它是科学上合理的、适定的和客观的。它提出了一个在偏微分方程数值分析中使用不连续伽辽金和 IMEX 方法的标准问题。所有需要的信息都已提供，问题具体且可形式化。\n\n### 第一部分：半离散系统的推导\n\n我们从标量对流-扩散方程 $u_{t} + \\partial_{x} f(u) = \\partial_{x}\\!\\left(\\nu\\, \\partial_{x} u\\right)$ 开始。我们可以将其重写为 $u_{t} = -\\partial_{x} f(u) + \\partial_{x}\\!\\left(\\nu\\, \\partial_{x} u\\right)$。\n\n线方法首先对空间算子进行离散化，以获得关于基函数系数的常微分方程 (ODEs) 系统。设计算域 $\\Omega$ 被划分为单元 $E_k$。不连续伽辽金 (DG) 近似由 $u_{h}(x,t) = \\sum_{j} U_{j}(t)\\,\\varphi_{j}(x)$ 给出，其中 $\\{\\varphi_j\\}$ 是 DG 有限元空间的基，而 $U_j(t)$ 是随时间变化的自由度。\n\n弱形式是通过将偏微分方程乘以来自同一 DG 空间的检验函数 $v_h$ 并在整个域上积分得到的。由于基函数的不连续性，这是在逐个单元的基础上完成的。对于任意检验函数 $v_h = \\varphi_i(x)$ 并对所有单元求和，弱形式为：\n$$\n\\sum_k \\int_{E_k} (\\partial_t u_h) \\varphi_i \\,dx = -\\sum_k \\int_{E_k} (\\partial_x f(u_h)) \\varphi_i \\,dx + \\sum_k \\int_{E_k} \\partial_x(\\nu \\partial_x u_h) \\varphi_i \\,dx\n$$\n\n让我们分析每一项以得到矩阵-向量形式。\n\n1.  **质量矩阵项 (左侧):**\n    代入 $u_h(x,t) = \\sum_{j} U_{j}(t)\\,\\varphi_{j}(x)$，左侧变为：\n    $$\n    \\sum_k \\int_{E_k} \\left(\\sum_j \\dot{U}_j(t) \\varphi_j(x)\\right) \\varphi_i(x) \\,dx = \\sum_j \\left(\\int_{\\Omega} \\varphi_j \\varphi_i \\,dx\\right) \\dot{U}_j(t)\n    $$\n    这里，$\\Omega = \\cup_k E_k$。这些积分构成了全局质量矩阵 $M$ 的元素，其中 $(M)_{ij} = \\int_{\\Omega} \\varphi_i \\varphi_j \\,dx$。因此，左侧是向量 $M\\dot{U}(t)$ 的第 $i$ 个分量。\n\n2.  **对流项 (显式部分):**\n    问题指定对体积项进行分部积分。对流算子 $-\\partial_x f(u)$ 的空间离散化得到向量 $C(U)$。该向量的第 $i$ 个分量由下式得到：\n    $$\n    -\\sum_k \\int_{E_k} (\\partial_x f(u_h)) \\varphi_i \\,dx = \\sum_k \\left( \\int_{E_k} f(u_h) (\\partial_x \\varphi_i) \\,dx - [f(u_h) \\varphi_i]_{\\partial E_k} \\right)\n    $$\n    在单元边界 $\\partial E_k$ 上的项 $f(u_h)$ 被一个相容且单调的数值通量所取代，记为 $\\hat{f}(u_h^-, u_h^+)$，其中 $u_h^-$ 和 $u_h^+$ 分别是解的内部和外部迹。所得到的向量非线性地依赖于系数向量 $U$，这就是问题中所称的“组装的全局对流残差向量”，记为 $C(U)$。该项将进行显式处理，因此我们确定 $E(U) = C(U)$。\n\n3.  **扩散项 (隐式部分):**\n    扩散项是 $\\partial_x(\\nu \\partial_x u)$。其空间离散化被指定使用对称内部罚分伽辽金 (SIPG) 方法。SIPG 公式通常是为负拉普拉斯算子 $-\\partial_x(\\nu \\partial_x u)$ 设计的。构造一个双线性形式 $B_{SIPG}(u_h, v_h)$ 来离散化该算子，从而得到一个全局刚度矩阵 $K_{\\nu}$，其元素由 $(K_\\nu)_{ij} = B_{SIPG}(\\varphi_j, \\varphi_i; \\nu)$ 给出。得到的向量是 $K_{\\nu}U$。由于偏微分方程中的算子是 $+\\partial_x(\\nu \\partial_x u)$（即 SIPG 通常离散化的算子的负号），它对半离散系统的贡献是 $-K_{\\nu}U$。\n    问题指出，对于常数粘性 $\\nu$，我们有 $K_{\\nu} = \\nu K$，其中 $K$ 是一个对称半正定矩阵。因此，扩散贡献是 $-\\nu K U$。这个线性项将进行隐式处理。我们确定 $I(U) = -\\nu K U$。\n\n结合这些部分，半离散常微分方程系统为：\n$$\nM\\dot{U}(t) = C(U) - \\nu K U\n$$\n这符合所要求的形式 $M\\dot{U}(t) = E(U(t)) + I(U(t))$，其中：\n$$\nE(U) = C(U) \\quad \\text{和} \\quad I(U) = -\\nu K U\n$$\n\n### 第二部分：IMEX-RK 时间离散化\n\n我们对系统 $M\\dot{U} = E(U) + I(U)$ 应用加法形式的隐式-显式龙格-库塔 (IMEX-RK) 格式。此类格式的阶段方程的一般形式是：\n$$\nU^{(i)} = U^n + \\Delta t \\sum_{j=1}^{i-1} a_{ij} \\left(M^{-1}E(U^{(j)})\\right) + \\Delta t \\sum_{j=1}^{i} \\hat{a}_{ij} \\left(M^{-1}I(U^{(j)})\\right)\n$$\n其中 $U^n$ 是时间 $t_n$ 时的解，$U^{(i)}$ 是中间阶段值。两边乘以质量矩阵 $M$ 得到问题所要求的形式：\n$$\nM U^{(i)} = M U^n + \\Delta t \\sum_{j=1}^{i-1} a_{ij} E(U^{(j)}) + \\Delta t \\sum_{j=1}^{i} \\hat{a}_{ij} I(U^{(j)})\n$$\n这个方程可以重新整理，以分离出当前阶段 $i$ 的项：\n$$\nM U^{(i)} - \\Delta t \\hat{a}_{ii} I(U^{(i)}) = M U^n + \\Delta t \\sum_{j=1}^{i-1} a_{ij} E(U^{(j)}) + \\Delta t \\sum_{j=1}^{i-1} \\hat{a}_{ij} I(U^{(j)})\n$$\n使用我们确定的 $I(U) = -\\nu K U$，左侧变为：\n$$\nM U^{(i)} - \\Delta t \\hat{a}_{ii} (-\\nu K U^{(i)}) = (M + \\Delta t \\hat{a}_{ii} \\nu K) U^{(i)}\n$$\n这揭示了在每个阶段为求解 $U^{(i)}$ 必须求解的线性系统。\n\n让我们将其应用于特定的 ARS$(2,2,2)$ 格式，其中 $\\gamma = 1 - 1/\\sqrt{2}$。Butcher 阵列由 $A$ (显式) 和 $\\hat{A}$ (隐式) 给出。这是一个二阶段方法 ($i=1,2$)。\n\n**阶段 1 ($i=1$):**\n对于 $j  1$ 的求和为空。第一阶段的方程是：\n$$\n(M + \\Delta t \\hat{a}_{11} \\nu K) U^{(1)} = M U^n\n$$\n从矩阵 $\\hat{A}$ 中，我们有 $\\hat{a}_{11} = \\gamma$。求解 $U^{(1)}$ 的代数系统是：\n$$\n(M + \\Delta t \\gamma \\nu K) U^{(1)} = M U^n\n$$\n\n**阶段 2 ($i=2$):**\n第二阶段的方程是：\n$$\n(M + \\Delta t \\hat{a}_{22} \\nu K) U^{(2)} = M U^n + \\Delta t a_{21} E(U^{(1)}) + \\Delta t \\hat{a}_{21} I(U^{(1)})\n$$\n从矩阵中，我们有 $a_{21}=1$，$\\hat{a}_{21}=1-\\gamma$，以及 $\\hat{a}_{22}=\\gamma$。代入这些值和 $I(U^{(1)}) = -\\nu K U^{(1)}$：\n$$\n(M + \\Delta t \\gamma \\nu K) U^{(2)} = M U^n + \\Delta t E(U^{(1)}) - \\Delta t (1-\\gamma) \\nu K U^{(1)}\n$$\n这是求解 $U^{(2)}$ 的代数系统。请注意，右侧依赖于第一阶段的解 $U^{(1)}$。\n\n**步进更新:**\n在时间 $t_{n+1} = t_n + \\Delta t$ 时的最终解是通过对阶段值进行最终组合来计算的：\n$$\nM U^{n+1} = M U^n + \\Delta t \\sum_{i=1}^{2} b_i E(U^{(i)}) + \\Delta t \\sum_{i=1}^{2} \\hat{b}_i I(U^{(i)})\n$$\n使用给定的向量 $b^T = \\hat{b}^T = (1-\\gamma, \\gamma)$，我们得到：\n$$\nM U^{n+1} = M U^n + \\Delta t \\left( (1-\\gamma)E(U^{(1)}) + \\gamma E(U^{(2)}) \\right) + \\Delta t \\left( (1-\\gamma)I(U^{(1)}) + \\gamma I(U^{(2)}) \\right)\n$$\n代入 $I(U) = -\\nu K U$，更新变为：\n$$\nM U^{n+1} = M U^n + \\Delta t \\left( (1-\\gamma)E(U^{(1)}) + \\gamma E(U^{(2)}) \\right) - \\Delta t \\nu \\left( (1-\\gamma)K U^{(1)} + \\gamma K U^{(2)} \\right)\n$$\n\n### 第三部分：被分解矩阵的识别\n\n在第二部分中，我们推导了在每个阶段为求得阶段向量 $U^{(1)}$ 和 $U^{(2)}$ 必须求解的线性代数系统：\n$$\n\\text{阶段 1: } (M + \\Delta t \\gamma \\nu K) U^{(1)} = \\text{RHS}_1\n$$\n$$\n\\text{阶段 2: } (M + \\Delta t \\gamma \\nu K) U^{(2)} = \\text{RHS}_2\n$$\n该格式是一种单对角隐式龙格-库塔 (SDIRK) 方法，因为隐式 Butcher 表 $\\hat{A}$ 的对角线元素都相等，即 $\\hat{a}_{11} = \\hat{a}_{22} = \\gamma$。这在计算上是有利的，因为待解线性系统左侧的矩阵在两个阶段是相同的。这个矩阵是：\n$$\nL = M + \\Delta t \\gamma \\nu K\n$$\n这个矩阵可以在每个时间步只形成和分解（例如，使用 Cholesky 或 LU 分解）一次。然后，这个分解被重复使用，以求解具有不同右侧项的 $U^{(1)}$ 和 $U^{(2)}$。\n\n我们必须确认该矩阵是对称正定的 (SPD)。\n- **对称性:** DG 质量矩阵 $M$ 是对称的。SIPG 刚度矩阵 $K$ 是对称的。由于 $\\Delta t$、$\\gamma$ 和 $\\nu$ 是标量，矩阵 $\\Delta t \\gamma \\nu K$ 也是对称的。两个对称矩阵之和是对称的，因此 $L$ 是对称的。\n- **正定性:** 设 $x$ 是任何适当维度的非零向量。考虑二次型 $x^T L x$：\n$$\nx^T L x = x^T (M + \\Delta t \\gamma \\nu K) x = x^T M x + \\Delta t \\gamma \\nu (x^T K x)\n$$\n- DG 质量矩阵 $M$ 是对称正定的 (SPD)，所以 $x^T M x > 0$。\n- SIPG 刚度矩阵 $K$ 是对称半正定的 (SPS)，所以 $x^T K x \\ge 0$。\n- 参数都是正的：$\\Delta t > 0$，$\\nu > 0$，并且 $\\gamma = 1 - 1/\\sqrt{2} \\approx 1 - 0.707 > 0$。\n- 因此，项 $\\Delta t \\gamma \\nu (x^T K x)$ 是非负的。\n总和为 $x^T L x = (\\text{正数}) + (\\text{非负数})$，这是严格为正的。\n因此，矩阵 $L = M + \\Delta t \\gamma \\nu K$ 是对称正定的。\n\n每个时间步分解一次的精确对称正定矩阵是 $M + \\Delta t \\gamma \\nu K$。", "answer": "$$\n\\boxed{M + \\Delta t \\gamma \\nu K}\n$$", "id": "3399430"}]}