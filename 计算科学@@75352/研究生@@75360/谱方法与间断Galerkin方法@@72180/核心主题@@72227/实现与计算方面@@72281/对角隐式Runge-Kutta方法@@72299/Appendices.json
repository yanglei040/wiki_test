{"hands_on_practices": [{"introduction": "理解复杂的新方法通常始于将其与熟悉的概念联系起来。本练习将探讨一个由参数 $\\gamma$ 控制的单对角隐式龙格-库塔（SDIRK）方法族。通过考察当 $\\gamma \\to 0$ 时的极限情况，我们将揭示它与一种基本显式方法之间的直接联系，从而为理解隐式格式的结构提供宝贵的直观认识 [@problem_id:3378768]。", "problem": "考虑一个由线性常系数双曲问题的谱方法或间断伽辽金(DG)离散化的傅里叶模态产生的标量半离散常微分方程，该问题具有周期性边界条件：$y^{\\prime}(t) = \\lambda y(t)$，其中 $\\lambda \\in \\mathbb{C}$ 且 $y(0)=y_0$。设 $h>0$ 为时间步长，$z = h \\lambda$。考虑一个两阶段（$2$-stage）的单对角隐式龙格-库塔(SDIRK)方法族，该族由一个对角系数 $\\gamma \\ge 0$ 参数化，其Butcher系数为\n$$\nA = \\begin{pmatrix}\n\\gamma & 0 \\\\\n1-\\gamma & \\gamma\n\\end{pmatrix}, \n\\quad \nb^\\top = \\begin{pmatrix}\n1-\\gamma & \\gamma\n\\end{pmatrix}, \n\\quad \nc = \\begin{pmatrix}\n\\gamma \\\\\n1\n\\end{pmatrix}.\n$$\n对于任何 $\\gamma \\in [0,1]$，该方法族是相容的，并且对于某个特定的 $\\gamma \\in (0,1)$，它包含了经典的二阶SDIRK方法。仅从标准形式的龙格-库塔阶段定义和更新出发，不调用任何给定的专门的稳定性函数公式，执行以下操作：\n\n1) 将该方法应用于 $y^{\\prime}=\\lambda y$，并从第一性原理推导由 $y_{n+1} = R(z;\\gamma)\\, y_n$ 定义的单步放大因子 $R(z;\\gamma)$。\n\n2) 计算当 $\\gamma \\to 0$ 时 $R(z;\\gamma)$ 的逐点极限，并辨识极限方法对应的龙格-库塔特性。\n\n3) 使用 $R(z;\\gamma)$ 关于 $z=0$ 的幂级数展开，评估当 $\\gamma \\to 0$ 时局部截断误差的阶，并根据 $R(z;\\gamma)$ 定性地描述极限绝对稳定区域。\n\n将极限 $R_0(z) := \\lim_{\\gamma\\to 0} R(z;\\gamma)$ 的闭式表达式作为你的最终答案。无需数值取整，无单位。将最终答案表示为关于z的单个解析表达式。", "solution": "按所给问题进行验证。\n\n### 第一步：提取已知条件\n- **常微分方程(ODE):** $y^{\\prime}(t) = \\lambda y(t)$，其中 $\\lambda \\in \\mathbb{C}$ 且初始条件为 $y(0)=y_0$。\n- **离散化参数:** $z = h \\lambda$，其中 $h > 0$ 是时间步长。\n- **数值方法:** 一个由 $\\gamma \\ge 0$ 参数化的两阶段单对角隐式龙格-库塔(SDIRK)方法。\n- **Butcher系数:**\n$$\nA = \\begin{pmatrix}\n\\gamma & 0 \\\\\n1-\\gamma & \\gamma\n\\end{pmatrix},\n\\quad\nb^\\top = \\begin{pmatrix}\n1-\\gamma & \\gamma\n\\end{pmatrix},\n\\quad\nc = \\begin{pmatrix}\n\\gamma \\\\\n1\n\\end{pmatrix}.\n$$\n- **任务1:** 从第一性原理推导单步放大因子 $R(z;\\gamma)$，其中 $y_{n+1} = R(z;\\gamma) y_n$。\n- **任务2:** 计算 $R_0(z) := \\lim_{\\gamma\\to 0} R(z;\\gamma)$ 并辨识对应的龙格-库塔格式。\n- **任务3:** 使用幂级数展开分析 $\\gamma \\to 0$ 时的局部截断误差阶，并描述极限绝对稳定区域。\n\n### 第二步：使用提取的已知条件进行验证\n- **科学依据：** 该问题涉及将龙格-库塔方法应用于标准的Dahlquist测试方程，这是常微分方程数值分析领域中一个基本且完善的流程。该问题在科学上和数学上都是合理的。\n- **适定性：** 问题已明确给出了所有必要的数据（ODE和Butcher表）。各项任务清晰、无歧义，并能导出一个唯一、可推导的结果。\n- **客观性：** 语言是形式化的、数学的，并且不含任何主观或基于观点的内容。\n- **完备性与一致性：** 问题是自洽且一致的。所提供的系数定义了一个有效的龙格-库塔格式。一阶相容性条件 $\\sum_{i} b_i = 1$ 得到满足，因为对于任何 $\\gamma$，都有 $(1-\\gamma) + \\gamma = 1$。\n\n### 第三步：结论与行动\n问题是有效的。将提供解答。\n\n***\n\n解答是通过执行问题陈述中指定的三个任务得出的。\n\n**1) 放大因子 $R(z;\\gamma)$ 的推导**\n\n对于一个自治ODE $y' = f(y)$，一个通用的龙格-库塔方法由其阶段方程和最终更新步骤定义。阶段 $k_i$ 的计算如下：\n$$\nk_i = f\\left(y_n + h \\sum_{j=1}^{s} a_{ij} k_j\\right), \\quad i=1, \\dots, s\n$$\n解的推进方式如下：\n$$\ny_{n+1} = y_n + h \\sum_{i=1}^{s} b_i k_i\n$$\n对于给定的线性ODE，$f(y) = \\lambda y$。阶段方程变为：\n$$\nk_i = \\lambda \\left(y_n + h \\sum_{j=1}^{s} a_{ij} k_j\\right)\n$$\n使用给定的两阶段SDIRK系数，我们可以写出阶段 $k_1$ 和 $k_2$ 的显式方程。\n\n对于第一阶段 ($i=1$):\n$$\nk_1 = \\lambda (y_n + h a_{11} k_1 + h a_{12} k_2) = \\lambda (y_n + h \\gamma k_1)\n$$\n令 $z = h\\lambda$，我们可以解出 $k_1$：\n$$\nk_1 = \\lambda y_n + z \\gamma k_1 \\implies k_1(1 - z\\gamma) = \\lambda y_n \\implies k_1 = \\frac{\\lambda y_n}{1 - z\\gamma}\n$$\n此表达式在 $z\\gamma \\neq 1$ 时有效。\n\n对于第二阶段 ($i=2$):\n$$\nk_2 = \\lambda (y_n + h a_{21} k_1 + h a_{22} k_2) = \\lambda (y_n + h (1-\\gamma) k_1 + h \\gamma k_2)\n$$\n解出 $k_2$：\n$$\nk_2(1 - z\\gamma) = \\lambda y_n + z(1-\\gamma)k_1\n$$\n代入 $k_1$ 的表达式：\n$$\nk_2(1 - z\\gamma) = \\lambda y_n + z(1-\\gamma) \\frac{\\lambda y_n}{1 - z\\gamma} = \\lambda y_n \\left(1 + \\frac{z(1-\\gamma)}{1 - z\\gamma}\\right) = \\lambda y_n \\left(\\frac{1 - z\\gamma + z - z\\gamma}{1 - z\\gamma}\\right)\n$$\n$$\nk_2 = \\frac{\\lambda y_n}{(1-z\\gamma)} \\frac{1 + z(1-2\\gamma)}{1-z\\gamma} = \\lambda y_n \\frac{1+z(1-2\\gamma)}{(1-z\\gamma)^2}\n$$\n现在，我们使用更新公式，其中 $b_1 = 1-\\gamma$ 且 $b_2 = \\gamma$：\n$$\ny_{n+1} = y_n + h ((1-\\gamma)k_1 + \\gamma k_2)\n$$\n放大因子 $R(z;\\gamma)$ 由 $y_{n+1} = R(z;\\gamma) y_n$ 定义。两边同除以 $y_n$ 并代入 $k_1$ 和 $k_2$：\n$$\nR(z;\\gamma) = 1 + \\frac{h}{y_n}((1-\\gamma)k_1 + \\gamma k_2) = 1 + z \\left((1-\\gamma)\\frac{k_1}{\\lambda y_n} + \\gamma\\frac{k_2}{\\lambda y_n}\\right)\n$$\n$$\nR(z;\\gamma) = 1 + z \\left( (1-\\gamma) \\frac{1}{1-z\\gamma} + \\gamma \\frac{1+z(1-2\\gamma)}{(1-z\\gamma)^2} \\right)\n$$\n为了简化，我们找到公分母 $(1-z\\gamma)^2$：\n$$\nR(z;\\gamma) = 1 + \\frac{z}{(1-z\\gamma)^2} \\left[ (1-\\gamma)(1-z\\gamma) + \\gamma(1+z(1-2\\gamma)) \\right]\n$$\n展开方括号中的项：\n$$\n(1 - z\\gamma - \\gamma + z\\gamma^2) + (\\gamma + z\\gamma - 2z\\gamma^2) = 1 - z\\gamma^2\n$$\n将此结果代回 $R(z;\\gamma)$ 的表达式中：\n$$\nR(z;\\gamma) = 1 + \\frac{z(1 - z\\gamma^2)}{(1-z\\gamma)^2} = \\frac{(1-z\\gamma)^2 + z(1-z\\gamma^2)}{(1-z\\gamma)^2}\n$$\n$$\nR(z;\\gamma) = \\frac{1 - 2z\\gamma + z^2\\gamma^2 + z - z^2\\gamma^2}{(1-z\\gamma)^2} = \\frac{1 + z(1-2\\gamma)}{(1-z\\gamma)^2}\n$$\n这就是放大因子的闭式表达式。\n\n**2) $\\gamma \\to 0$ 时的极限及方法辨识**\n\n我们计算当 $\\gamma$ 趋近于 $0$ 时 $R(z;\\gamma)$ 的逐点极限：\n$$\nR_0(z) := \\lim_{\\gamma\\to 0} R(z;\\gamma) = \\lim_{\\gamma\\to 0} \\frac{1 + z(1-2\\gamma)}{(1-z\\gamma)^2}\n$$\n由于该表达式是关于 $\\gamma$ 的有理函数，并且在 $\\gamma=0$ 处连续，因此可以通过直接代入求得极限：\n$$\nR_0(z) = \\frac{1 + z(1-2 \\cdot 0)}{(1-z \\cdot 0)^2} = \\frac{1+z}{1^2} = 1+z\n$$\n放大因子 $R(z) = 1+z$ 对应于前向欧拉法。为了验证，将前向欧拉法应用于 $y' = \\lambda y$ 可得：\n$$\ny_{n+1} = y_n + h f(y_n) = y_n + h (\\lambda y_n) = (1+h\\lambda)y_n = (1+z)y_n\n$$\n因此，极限龙格-库塔方法是前向欧拉法。这也可以通过对Butcher表取 $\\gamma \\to 0$ 的极限来观察：\n$$\nA \\to \\begin{pmatrix} 0 & 0 \\\\ 1 & 0 \\end{pmatrix}, \\quad b^\\top \\to \\begin{pmatrix} 1 & 0 \\end{pmatrix}, \\quad c \\to \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}\n$$\n此表对应于一个方法，其中 $y_{n+1} = y_n + h k_1$，$k_1 = f(y_n)$，这恰好是前向欧拉法。第二阶段被计算但未用于更新（因为 $b_2 \\to 0$）。\n\n**3) 局部截断误差与稳定区域分析**\n\n局部截断误差(LTE)是通过将数值放大因子 $R(z)$ 与精确放大因子 $\\exp(z)$ 进行比较来确定的。如果一个方法的 $R(z) = \\exp(z) + O(z^{p+1})$，则其阶为 $p$。我们对 $R(z;\\gamma)$ 在 $z=0$ 处进行泰勒级数展开：\n$$\nR(z;\\gamma) = \\frac{1 + z(1-2\\gamma)}{(1-z\\gamma)^2} = (1 + z(1-2\\gamma))(1-z\\gamma)^{-2}\n$$\n使用广义二项式级数 $(1-x)^{-2} = 1 + 2x + 3x^2 + O(x^3)$：\n$$\nR(z;\\gamma) = (1 + z(1-2\\gamma))(1 + 2(z\\gamma) + 3(z\\gamma)^2 + O(z^3))\n$$\n$$\nR(z;\\gamma) = 1 + 2z\\gamma + z(1-2\\gamma) + 3z^2\\gamma^2 + 2z^2\\gamma(1-2\\gamma) + O(z^3)\n$$\n$$\nR(z;\\gamma) = 1 + z(2\\gamma + 1 - 2\\gamma) + z^2(3\\gamma^2 + 2\\gamma - 4\\gamma^2) + O(z^3)\n$$\n$$\nR(z;\\gamma) = 1 + z + (2\\gamma - \\gamma^2)z^2 + O(z^3)\n$$\n精确解算子的泰勒级数为 $\\exp(z) = 1 + z + \\frac{1}{2}z^2 + O(z^3)$。\n局部截断误差与 $\\exp(z) - R(z;\\gamma) = \\left(\\frac{1}{2} - (2\\gamma - \\gamma^2)\\right)z^2 + O(z^3)$ 成正比。对于一般的 $\\gamma$，该方法是一阶的 ($p=1$)。\n当 $\\gamma \\to 0$ 时，极限放大因子为 $R_0(z) = 1+z$。与精确因子的比较如下：\n$$\n\\exp(z) - R_0(z) = \\left(1 + z + \\frac{z^2}{2} + \\dots\\right) - (1+z) = \\frac{1}{2}z^2 + O(z^3)\n$$\n主误差项是 $z^2$ 阶的。由于 $z=h\\lambda$，局部截断误差为 $O(h^2)$，这证实了极限方法（前向欧拉法）的阶为 $p=1$。\n\n绝对稳定区域是集合 $S = \\{z \\in \\mathbb{C} : |R(z)| \\le 1\\}$。对于 $\\gamma \\to 0$ 时的极限方法，我们分析 $R_0(z) = 1+z$ 的稳定区域 $S_0$：\n$$\nS_0 = \\{z \\in \\mathbb{C} : |1+z| \\le 1\\}\n$$\n令 $z = x+iy$，其中 $x, y \\in \\mathbb{R}$。条件变为：\n$$\n|1+x+iy| \\le 1 \\implies \\sqrt{(1+x)^2 + y^2} \\le 1 \\implies (1+x)^2 + y^2 \\le 1^2\n$$\n定性地看，这个不等式描述了复平面上的一个闭圆盘。该圆盘以 $z_c = -1+0i$（即$(-1,0)$）为中心，半径为 $1$。这是前向欧拉法的经典稳定区域。它包含实轴上的区间 $[-2, 0]$，但在虚轴上只包含一个点 $z=0$，这使得它不适合用有限时间步长求解无耗散的双曲问题。", "answer": "$$\\boxed{1+z}$$", "id": "3378768"}, {"introduction": "任何时间积分格式的一个关键衡量标准是其精度阶。本练习将引导你亲手推导一个两阶段 SDIRK 方法的稳定性函数。通过将其泰勒级数展开与精确解的指数算子进行比较，我们将确定该方法的精度阶，这是分析数值积分器的一项基本技能 [@problem_id:3378828]。", "problem": "考虑一个通过对周期性区域上的线性双曲守恒律进行间断 Galerkin (DG) 空间离散得到的半离散系统，该系统产生一个形式为 $\\frac{d\\mathbf{y}}{dt}=\\mathbf{L}\\mathbf{y}$ 的自治线性常微分方程(ODE)组，其中 $\\mathbf{L}$ 是一个常数矩阵。一种常见的方法是使用对角隐式龙格-库塔(DIRK)方法对该系统进行时间推进。考虑到谱方法和间断 Galerkin 方法中典型的稳定性和刚性问题，我们考虑以下具有 $2$ 级和单个参数 $\\gamma>0$ 的单对角隐式龙格-库塔($\\text{SDIRK}$)格式：\n$$\n\\begin{array}{c|cc}\n\\gamma & \\gamma & 0 \\\\\n1 & 1-\\gamma & \\gamma \\\\\n\\hline\n& 1-\\gamma & \\gamma\n\\end{array}\n$$\n当此时间积分器应用于线性测试方程 $y'=\\lambda y$ 时，定义无量纲变量 $z=h\\lambda$，其中 $h$ 是时间步长。单步更新的形式为 $y_{n+1}=R(z)y_n$，其中 $R(z)$ 被称为稳定性函数。该方法的精度阶 $p$ 由以下条件表征：$R(z)$ 在 $z=0$ 处的泰勒级数与 $\\exp(z)$ 的泰勒级数相匹配，直到并包含 $z^p$ 阶项，即 $R(z)-\\exp(z)=\\mathcal{O}(z^{p+1})$。\n\n从定义此 $\\text{SDIRK}$ 方法的级方程和更新公式出发，推导测试方程 $y'=\\lambda y$ 的 $R(z)$，将其在 $z=0$ 处展开为泰勒级数，并确定满足 $R(z)-\\exp(z)=\\mathcal{O}(z^{p+1})$ 的最大整数 $p$。将你的最终答案表示为单个整数 $p$。无需四舍五入。", "solution": "来自间断 Galerkin (DG) 离散的半离散系统被线性化为 $\\frac{d\\mathbf{y}}{dt}=\\mathbf{L}\\mathbf{y}$。为独立于空间离散评估时间积分的精度，我们使用线性测试方程 $y'=\\lambda y$，其精确解满足 $y(t+h)=\\exp(h\\lambda)y(t)$。将龙格-库塔方法应用于 $y'=\\lambda y$ 会得到一个有理放大（稳定性）函数 $R(z)$，使得 $y_{n+1}=R(z)y_n$，其中 $z=h\\lambda$。精度阶 $p$ 的特征在于将 $R(z)$ 与 $\\exp(z)$ 匹配至 $\\mathcal{O}(z^{p+1})$。\n\n对于给定的具有 $2$ 级和参数 $\\gamma>0$ 的单对角隐式龙格-库塔($\\text{SDIRK}$)方法，\n$$\n\\begin{array}{c|cc}\n\\gamma & \\gamma & 0 \\\\\n1 & 1-\\gamma & \\gamma \\\\\n\\hline\n& 1-\\gamma & \\gamma\n\\end{array}\n$$\n对于 $y'=\\lambda y$ 且 $z=h\\lambda$，级方程为\n$$\nY_1 = y_n + z\\gamma Y_1,\\qquad\nY_2 = y_n + z\\Big[(1-\\gamma)Y_1 + \\gamma Y_2\\Big],\n$$\n更新式为\n$$\ny_{n+1} = y_n + z\\Big[(1-\\gamma)Y_1 + \\gamma Y_2\\Big].\n$$\n求解线性级方程：\n$$\n(1 - z\\gamma)Y_1 = y_n \\;\\;\\Longrightarrow\\;\\; Y_1 = \\frac{y_n}{1 - z\\gamma}.\n$$\n类似地，\n$$\n(1 - z\\gamma)Y_2 = y_n + z(1-\\gamma)Y_1\n\\;\\;\\Longrightarrow\\;\\;\nY_2 = \\frac{y_n + z(1-\\gamma)Y_1}{1 - z\\gamma}\n= y_n\\frac{1 + z(1-\\gamma)/(1 - z\\gamma)}{1 - z\\gamma}.\n$$\n为方便起见，记 $D := 1 - z\\gamma$。那么\n$$\nY_1 = \\frac{y_n}{D},\\qquad\nY_2 = \\frac{y_n + z(1-\\gamma)y_n/D}{D}\n= y_n\\left(\\frac{1}{D} + \\frac{z(1-\\gamma)}{D^2}\\right)\n= y_n\\frac{D + z(1-\\gamma)}{D^2}.\n$$\n由于 $D + z(1-\\gamma) = 1 - z\\gamma + z(1-\\gamma) = 1 + z(1 - 2\\gamma)$，我们有\n$$\nY_2 = y_n\\frac{1 + z(1 - 2\\gamma)}{D^2}.\n$$\n那么更新式给出\n$$\n\\frac{y_{n+1}}{y_n}\n=\n1 + z\\Bigg[(1-\\gamma)\\frac{1}{D} + \\gamma\\frac{1 + z(1 - 2\\gamma)}{D^2}\\Bigg]\n=: R(z).\n$$\n因此，精确的稳定性函数是有理函数\n$$\nR(z) = 1 + z\\left[\\frac{1-\\gamma}{1 - z\\gamma} + \\gamma\\frac{1 + z(1 - 2\\gamma)}{(1 - z\\gamma)^2}\\right].\n$$\n为了确定阶数，将 $R(z)$ 在 $z=0$ 处展开。使用二项式级数\n$$\n\\frac{1}{1 - z\\gamma} = 1 + z\\gamma + z^2\\gamma^2 + z^3\\gamma^3 + \\mathcal{O}(z^4),\n\\qquad\n\\frac{1}{(1 - z\\gamma)^2} = 1 + 2z\\gamma + 3 z^2\\gamma^2 + \\mathcal{O}(z^3).\n$$\n那么\n$$\n\\frac{1-\\gamma}{1 - z\\gamma}\n=\n(1-\\gamma)\\Big(1 + z\\gamma + z^2\\gamma^2 + \\mathcal{O}(z^3)\\Big)\n=\n(1-\\gamma) + z(1-\\gamma)\\gamma + z^2(1-\\gamma)\\gamma^2 + \\mathcal{O}(z^3).\n$$\n另外，\n$$\n\\gamma\\frac{1 + z(1 - 2\\gamma)}{(1 - z\\gamma)^2}\n=\n\\gamma\\Big(1 + z(1 - 2\\gamma)\\Big)\\Big(1 + 2z\\gamma + 3 z^2\\gamma^2 + \\mathcal{O}(z^3)\\Big).\n$$\n相乘并保留到 $\\mathcal{O}(z^2)$ 阶项，\n$$\n\\gamma\\frac{1 + z(1 - 2\\gamma)}{(1 - z\\gamma)^2}\n=\n\\gamma\\Big[1 + z\\big(2\\gamma + (1 - 2\\gamma)\\big) + z^2\\big(3\\gamma^2 + 2\\gamma(1 - 2\\gamma)\\big) + \\mathcal{O}(z^3)\\Big]\n$$\n$$\n=\n\\gamma\\Big[1 + z + z^2\\big(2\\gamma - \\gamma^2\\big) + \\mathcal{O}(z^3)\\Big]\n=\n\\gamma + z\\gamma + z^2\\big(2\\gamma^2 - \\gamma^3\\big) + \\mathcal{O}(z^3).\n$$\n收集 $R(z)$ 括号内的项，\n$$\n(1-\\gamma)\\frac{1}{1 - z\\gamma} + \\gamma\\frac{1 + z(1 - 2\\gamma)}{(1 - z\\gamma)^2}\n=\n\\underbrace{(1-\\gamma) + \\gamma}_{C_1}\n+\nz\\underbrace{\\big((1-\\gamma)\\gamma + \\gamma\\big)}_{C_2}\n+\nz^2\\underbrace{\\big((1-\\gamma)\\gamma^2 + 2\\gamma^2 - \\gamma^3\\big)}_{C_3}\n+ \\mathcal{O}(z^3).\n$$\n因此 $R(z)$ 的泰勒展开式为\n$$\nR(z) = 1 + zC_1 + z^2C_2 + z^3C_3 + \\mathcal{O}(z^4),\n$$\n系数为\n$$\nC_1 = (1-\\gamma) + \\gamma = 1,\n\\qquad\nC_2 = (1-\\gamma)\\gamma + \\gamma = \\gamma(2 - \\gamma),\n\\qquad\nC_3 = (1-\\gamma)\\gamma^2 + 2\\gamma^2 - \\gamma^3 = 3\\gamma^2 - 2\\gamma^3.\n$$\n为了与 $\\exp(z) = 1 + z + \\frac{z^2}{2} + \\frac{z^3}{6} + \\mathcal{O}(z^4)$ 匹配至 $z^p$ 阶，我们需要\n$$\nC_1 = 1,\\quad C_2 = \\frac{1}{2},\\quad C_3 = \\frac{1}{6},\\;\\ldots\n$$\n第一个条件 $C_1=1$ 对任意 $\\gamma$ 恒成立，证实了一致性。二阶条件要求\n$$\n\\gamma(2 - \\gamma) = \\frac{1}{2}\n\\;\\;\\Longleftrightarrow\\;\\;\n\\gamma^2 - 2\\gamma + \\frac{1}{2} = 0\n\\;\\;\\Longleftrightarrow\\;\\;\n\\gamma = 1 \\pm \\frac{1}{\\sqrt{2}}.\n$$\n在 $\\gamma>0$ 和 $\\gamma1$ 条件下，可接受的单对角隐式选择是\n$$\n\\gamma = 1 - \\frac{1}{\\sqrt{2}}.\n$$\n使用这个选择，检查三阶条件：\n$$\nC_3 = 3\\gamma^2 - 2\\gamma^3 = \\frac{1}{\\sqrt{2}} - \\frac{1}{2} \\;\\neq\\; \\frac{1}{6}.\n$$\n因此三阶条件不能被满足，且满足 $R(z)-\\exp(z)=\\mathcal{O}(z^{p+1})$ 的最大整数 $p$ 是 $p=2$。\n\n因此，通过将 $R(z)$ 的泰勒级数与 $\\exp(z)$ 匹配至 $\\mathcal{O}(z^{p+1})$ 所确定的精度阶为 $p=2$。", "answer": "$$\\boxed{2}$$", "id": "3378828"}, {"introduction": "对于刚性系统，例如由扩散问题的间断伽辽金（DG）离散化产生的系统，并非任何方法都能有效工作。本练习专注于设计一种专为应对此类挑战而定制的方法，通过施加刚性精度和 L-稳定性等关键性质。应用这些约束，你将推导出一个高效的二阶 L-稳定 SDIRK 格式的参数 [@problem_id:3378920]。", "problem": "有界域上线性扩散算子的半离散间断 Galerkin (DG) 空间离散化会产生一个形如 $\\frac{\\mathrm{d} \\boldsymbol{u}}{\\mathrm{d} t} = \\boldsymbol{L}\\boldsymbol{u}$ 的常微分方程，其中，由于扩散通量引起的刚性，$\\boldsymbol{L}$ 的特征值具有较大的负实部。考虑使用一个具有公共对角系数 $\\gamma$ 和刚性精度的两阶段对角单隐式 Runge-Kutta (SDIRK) 方法对此系统进行时间推进，刚性精度意味着最后一个阶段等于步长解，并且权重等于 Runge-Kutta 矩阵的最后一行。\n\n设 Butcher 矩阵为 $\\boldsymbol{A} = \\begin{pmatrix}\\gamma  0 \\\\ a_{21}  \\gamma\\end{pmatrix}$，权重为 $\\boldsymbol{b} = \\begin{pmatrix}b_{1} \\\\ b_{2}\\end{pmatrix}$，满足刚性精度 $\\boldsymbol{b}^{\\top} = \\begin{pmatrix}a_{21}  \\gamma\\end{pmatrix}$，节点 $\\boldsymbol{c} = \\begin{pmatrix}c_{1} \\\\ c_{2}\\end{pmatrix}$ 由 $c_{i} = \\sum_{j} a_{ij}$ 给出。假设该方法恰好为二阶精度。\n\n从标量线性测试方程 $\\frac{\\mathrm{d} u}{\\mathrm{d} t} = \\lambda u$ 出发，通过应用具有刚性精度的两阶段 SDIRK 更新，定义稳定性函数 $R(z)$，其中 $z = h \\lambda$。对刚性系统施加 $L$-稳定性的要求，此处将其视为 $A$-稳定性（区域 $\\{z \\in \\mathbb{C} : \\operatorname{Re}(z) \\le 0\\}$ 包含在稳定性区域 $\\{z : |R(z)| \\le 1\\}$ 中）和 $\\lim_{|z|\\to\\infty} R(z) = 0$ 的组合。此外，要求节点代表步长内的时间点，即 $0 \\le c_{i} \\le 1$。\n\n在上述约束条件下，确定满足刚性精度、二阶精度和 $L$-稳定性的唯一 $\\gamma$ 值。将您的最终答案表示为 $\\gamma$ 的闭式解析表达式。", "solution": "用户想要找到一个对角单隐式 Runge-Kutta (SDIRK) 方法的特定参数。\n\n### 步骤 1：问题验证\n\n**1.1. 提取已知条件**\n-   控制常微分方程 (ODE) 的形式为 $\\frac{\\mathrm{d} \\boldsymbol{u}}{\\mathrm{d} t} = \\boldsymbol{L}\\boldsymbol{u}$。\n-   时间积分方法是一个两阶段 SDIRK 方法。\n-   Butcher 矩阵 $\\boldsymbol{A}$ 的结构为 $\\boldsymbol{A} = \\begin{pmatrix}\\gamma  0 \\\\ a_{21}  \\gamma\\end{pmatrix}$。\n-   该方法具有刚性精度，其定义为权重 $\\boldsymbol{b}$ 等于 Runge-Kutta 矩阵的最后一行。对于一个两阶段方法 ($s=2$)，这意味着 $\\boldsymbol{b}^{\\top} = \\begin{pmatrix}a_{21}  a_{22}\\end{pmatrix}$。根据 $\\boldsymbol{A}$ 的结构，这意为着 $b_1 = a_{21}$ 和 $b_2 = \\gamma$。\n-   节点 $\\boldsymbol{c}$ 由行和条件 $c_i = \\sum_{j} a_{ij}$ 给出。\n-   要求该方法恰好为二阶精度。\n-   稳定性分析在标量线性测试方程 $\\frac{\\mathrm{d} u}{\\mathrm{d} t} = \\lambda u$ 上进行，其中 $z = h \\lambda$。\n-   稳定性要求是 $L$-稳定性，其定义为以下两者的组合：\n    1.  $A$-稳定性：稳定性区域 $\\{z : |R(z)| \\le 1\\}$ 包含复平面的左半部分 $\\{z \\in \\mathbb{C} : \\operatorname{Re}(z) \\le 0\\}$。\n    2.  渐进行为：$\\lim_{|z|\\to\\infty} R(z) = 0$。\n-   节点被约束在时间步长区间内：$0 \\le c_{i} \\le 1$。\n\n**1.2. 使用提取的已知条件进行验证**\n该问题设置在刚性常微分方程数值分析的标准框架内。所有使用的术语（SDIRK、Butcher 表、刚性精度、阶数条件、$L$-稳定性）在该领域都是明确定义和标准的。该问题要求基于一组数学约束找到唯一的参数值。初步检查表明，这些约束很可能是一致的，并足以确定唯一的解。该问题具有科学依据，是适定的、客观的且可形式化的。没有明显违反验证标准的地方。\n\n**1.3. 结论与行动**\n该问题被认为是有效的。将提供一个完整的、有理有据的解答。\n\n### 步骤 2：求解推导\n\n目标是通过施加给定的约束来确定对角系数 $\\gamma$ 的唯一值。\n\n**2.1. 由方法属性得出的代数约束**\n首先，我们将 Runge-Kutta 方法的属性转化为一个关于其系数的代数方程组。\n\n-   **刚性精度**：权重 $\\boldsymbol{b}$ 由 $\\boldsymbol{A}$ 的第二行给出：\n    $b_1 = a_{21}$\n    $b_2 = \\gamma$\n-   **节点**：节点 $c_i$ 是 $\\boldsymbol{A}$ 的行和：\n    $c_1 = a_{11} + a_{12} = \\gamma + 0 = \\gamma$\n    $c_2 = a_{21} + a_{22} = a_{21} + \\gamma$\n\n**2.2. 精度阶数条件**\n为了使 Runge-Kutta 方法达到某一阶精度，其系数必须满足一组称为阶数条件的方程。\n\n-   **一阶条件**：$\\sum_{i=1}^{2} b_i = 1$。\n    代入 $b_1$ 和 $b_2$ 的表达式：\n    $a_{21} + \\gamma = 1$\n    这使我们能够用 $\\gamma$ 表示 $a_{21}$：\n    $a_{21} = 1 - \\gamma$\n    利用这个结果，我们可以找到 $c_2$ 的固定值：\n    $c_2 = a_{21} + \\gamma = (1 - \\gamma) + \\gamma = 1$\n\n-   **二阶条件**：$\\sum_{i=1}^{2} b_i c_i = \\frac{1}{2}$。\n    代入 $b_i$ 和 $c_i$ 的表达式：\n    $b_1 c_1 + b_2 c_2 = \\frac{1}{2}$\n    $(a_{21})(\\gamma) + (\\gamma)(1) = \\frac{1}{2}$\n    现在，代入 $a_{21} = 1 - \\gamma$：\n    $(1 - \\gamma)\\gamma + \\gamma = \\frac{1}{2}$\n    $\\gamma - \\gamma^2 + \\gamma = \\frac{1}{2}$\n    $2\\gamma - \\gamma^2 = \\frac{1}{2}$\n    重新整理得到一个关于 $\\gamma$ 的二次方程：\n    $\\gamma^2 - 2\\gamma + \\frac{1}{2} = 0$\n    乘以 $2$ 得到 $2\\gamma^2 - 4\\gamma + 1 = 0$。\n\n**2.3. 求解 $\\gamma$ 并应用约束**\n我们使用二次公式求解关于 $\\gamma$ 的二次方程：\n$\\gamma = \\frac{-(-4) \\pm \\sqrt{(-4)^2 - 4(2)(1)}}{2(2)} = \\frac{4 \\pm \\sqrt{16-8}}{4} = \\frac{4 \\pm 2\\sqrt{2}}{4}$\n这产生了两个可能的 $\\gamma$ 解：\n$\\gamma_1 = 1 - \\frac{\\sqrt{2}}{2}$\n$\\gamma_2 = 1 + \\frac{\\sqrt{2}}{2}$\n\n接下来，我们应用对节点的约束：$0 \\le c_i \\le 1$。\n我们有 $c_1 = \\gamma$ 和 $c_2 = 1$。\n约束 $0 \\le c_2 \\le 1$ 是满足的，因为 $c_2=1$。\n约束 $0 \\le c_1 \\le 1$ 要求 $0 \\le \\gamma \\le 1$。\n我们检查 $\\gamma$ 的两个解中哪一个满足这个条件：\n-   对于 $\\gamma_1 = 1 - \\frac{\\sqrt{2}}{2} \\approx 1 - 0.7071 = 0.2929$。该值位于区间 $[0, 1]$ 内。\n-   对于 $\\gamma_2 = 1 + \\frac{\\sqrt{2}}{2} \\approx 1 + 0.7071 = 1.7071$。该值不位于区间 $[0, 1]$ 内。\n\n因此，唯一满足二阶精度、刚性精度和节点约束的 $\\gamma$ 值为 $\\gamma = 1 - \\frac{\\sqrt{2}}{2}$。\n\n**2.4. $L$-稳定性的验证**\n最后，我们必须验证这个唯一的 $\\gamma$ 值也能产生一个 $L$-稳定的方法。\n一个 $s$ 阶 SDIRK 方法的稳定性函数 $R(z)$ 由 $R(z) = 1 + z \\boldsymbol{b}^\\top (\\boldsymbol{I} - z\\boldsymbol{A})^{-1} \\boldsymbol{1}$ 给出。对于具有刚性精度的两阶段二阶 SDIRK 方法，可以证明稳定性函数简化为：\n$R(z) = \\frac{1 + z(1-2\\gamma)}{(1-\\gamma z)^2}$\n此处，利用了二阶精度条件 $2\\gamma - \\gamma^2 = \\frac{1}{2}$ 来建立 $R(z)$ 的泰勒级数与 $e^z$ 匹配到 $z^2$ 项的通用形式。\n\n我们对 $\\gamma=1-\\frac{\\sqrt{2}}{2}$ 检验 $L$-稳定性的两个条件：\n\n1.  **渐进行为**：我们需要 $\\lim_{|z|\\to\\infty} R(z) = 0$。\n    $R(z)$ 是一个关于 $z$ 的有理函数。分子的次数是 $1$，分母的次数是 $2$。只要分母多项式的首项系数 $\\gamma^2$ 不为零，当 $|z|\\to\\infty$ 时极限将为 $0$。\n    我们的值是 $\\gamma = 1 - \\frac{\\sqrt{2}}{2} \\ne 0$，所以这个条件满足。\n\n2.  **A-稳定性**：我们需要对所有满足 $\\operatorname{Re}(z) \\le 0$ 的 $z$ 有 $|R(z)| \\le 1$。根据最大模原理，只需在边界上检查，即对于 $z=iy$，其中 $y \\in \\mathbb{R}$。\n    $|R(iy)|^2 = \\frac{|1 + iy(1-2\\gamma)|^2}{|(1 - iy\\gamma)^2|^2} = \\frac{1^2 + (y(1-2\\gamma))^2}{((1 - iy\\gamma)(1+iy\\gamma))^2} = \\frac{1 + y^2(1-2\\gamma)^2}{(1+y^2\\gamma^2)^2}$\n    条件 $|R(iy)|^2 \\le 1$ 变为：\n    $1 + y^2(1-4\\gamma+4\\gamma^2) \\le 1 + 2y^2\\gamma^2 + y^4\\gamma^4$\n    $y^2(1-4\\gamma+4\\gamma^2) \\le 2y^2\\gamma^2 + y^4\\gamma^4$\n    对于 $y \\ne 0$，我们可以除以 $y^2$：\n    $1-4\\gamma+4\\gamma^2 \\le 2\\gamma^2 + y^2\\gamma^4$\n    $2\\gamma^2 - 4\\gamma + 1 \\le y^2\\gamma^4$\n    这个不等式必须对所有 $y \\in \\mathbb{R}$ 成立。由于右侧可以任意接近于 $0$（对于小的 $y$），左侧必须小于或等于 $0$。\n    $2\\gamma^2 - 4\\gamma + 1 \\le 0$\n    二次方程 $2\\gamma^2 - 4\\gamma + 1 = 0$ 的根恰好是 $1 \\pm \\frac{\\sqrt{2}}{2}$。由于抛物线 $p(\\gamma)=2\\gamma^2 - 4\\gamma + 1$ 开口向上，不等式 $p(\\gamma) \\le 0$ 对于在两个根之间的 $\\gamma$ 成立，即 $\\gamma \\in [1 - \\frac{\\sqrt{2}}{2}, 1 + \\frac{\\sqrt{2}}{2}]$。\n    我们选择的值 $\\gamma = 1 - \\frac{\\sqrt{2}}{2}$ 位于该区间的边界上。对于这个值，$2\\gamma^2 - 4\\gamma + 1 = 0$，所以不等式变为 $0 \\le y^2\\gamma^4$，这总是成立的，因为 $y^2 \\ge 0$ 且 $\\gamma \\ne 0$。因此，该方法是 A-稳定的。\n\n由于两个条件都满足，对于 $\\gamma = 1 - \\frac{\\sqrt{2}}{2}$，该方法确实是 $L$-稳定的。\n\n问题陈述中指定的所有条件都由这个唯一的 $\\gamma$ 值满足。", "answer": "$$\\boxed{1 - \\frac{\\sqrt{2}}{2}}$$", "id": "3378920"}]}