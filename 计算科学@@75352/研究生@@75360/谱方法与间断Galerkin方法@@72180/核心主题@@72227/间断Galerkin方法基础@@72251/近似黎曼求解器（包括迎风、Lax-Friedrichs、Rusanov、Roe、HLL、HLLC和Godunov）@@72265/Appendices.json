{"hands_on_practices": [{"introduction": "这项实践将聚焦于戈杜诺夫 (Godunov) 通量，它是所有黎曼求解器中概念上最基础的一种。我们将把它应用于伯格斯 (Burgers) 方程，一个典型的非线性波现象模型。核心任务是确定单元交界面处黎曼问题的精确解——无论是形成激波还是稀疏波——并利用该信息计算物理通量，这为理解更复杂的近似求解器提供了基准。[@problem_id:3364344]", "problem": "考虑在实线上提出的无粘性伯格斯守恒律 $u_t + \\frac{1}{2}(u^2)_x = 0$。在间断伽辽金 (DG) 离散化中，位于 $x=0$ 的界面数值通量取为戈杜诺夫通量，其定义为在黎曼问题的精确熵解的界面状态下计算的物理通量，其中左状态为 $u_L$，右状态为 $u_R$。在界面 $x=0$ 处，左、右迹值分别为 $u_L = 2.3$ 和 $u_R = -1.1$。\n\n从守恒律、朗金-雨贡纽条件、拉克斯熵条件以及针对凸通量的特征线法出发，判断 $u_L$ 和 $u_R$ 之间的黎曼解由激波还是稀疏波构成。如果解是激波，确定其传播速度；如果解是稀疏波，确定在相似变量 $\\xi = x/t$ 下的自相似扇区区间。然后，利用熵解的相应界面状态，计算在 $x=0$ 处的戈杜诺夫通量。\n\n仅报告在 $x=0$ 处的戈杜诺夫通量值作为最终答案。以精确值形式表示最终结果（不要四舍五入）。", "solution": "首先验证问题的科学性、适定性和客观性。\n\n**步骤1：提取已知条件**\n- 守恒律：$u_t + \\frac{1}{2}(u^2)_x = 0$ (无粘性伯格斯方程)。\n- 离散化背景：间断伽辽金 (DG) 方法。\n- 界面位置：$x=0$。\n- 数值通量：戈杜诺夫通量，定义为在黎曼问题的精确熵解的界面状态下计算的物理通量。\n- 左状态：$u_L = 2.3$。\n- 右状态：$u_R = -1.1$。\n\n**步骤2：使用提取的已知条件进行验证**\n- 该问题具有**科学依据**。无粘性伯格斯方程是非线性双曲守恒律的典型模型。黎曼问题、激波、稀疏波、朗金-雨贡纽条件、拉克斯熵条件和戈杜诺夫通量等概念是此类方程理论和数值解法中的基本且公认的原理。\n- 该问题是**适定的**。具有常数初始数据的伯格斯方程的黎曼问题存在唯一、稳定且具有物理意义的熵解。\n- 该问题是**客观的**。所有术语都有数学定义，且提供的数据均为精确数值。\n- 该问题是**完整且一致的**。它提供了确定戈杜诺夫通量所需的所有必要信息（偏微分方程、左右状态、关心的位置）。不存在矛盾。\n\n**结论：** 问题有效。将提供完整解答。\n\n给定的守恒律是无粘性伯格斯方程：\n$$ u_t + \\frac{\\partial}{\\partial x} \\left( \\frac{1}{2} u^2 \\right) = 0 $$\n这是一个形式为 $u_t + f(u)_x = 0$ 的双曲守恒律，其中通量函数为 $f(u) = \\frac{1}{2} u^2$。\n\n该系统的特征速度由通量函数的导数给出：\n$$ c(u) = f'(u) = \\frac{d}{du} \\left( \\frac{1}{2} u^2 \\right) = u $$\n通量的二阶导数为 $f''(u) = 1$。由于对所有 $u$ 都有 $f''(u)  0$，因此该通量是严格凸的。\n\n具有初始数据\n$$ u(x,0) = \\begin{cases} u_L,  x  0 \\\\ u_R,  x > 0 \\end{cases} $$\n的黎曼问题的解取决于 $u_L$ 和 $u_R$ 之间的关系。对于严格凸通量，熵解由以下情况构成：\n1. 如果 $u_L  u_R$，则为激波。\n2. 如果 $u_L \\le u_R$，则为稀疏波。\n\n在本问题中，给定 $u_L = 2.3$ 和 $u_R = -1.1$。由于 $2.3  -1.1$，即 $u_L  u_R$，因此黎曼问题的解是一个激波。\n\n这个激波的速度（记为 $s$）由朗金-雨贡纽条件确定，该条件确保穿过间断面的通量跳跃与守恒量的跳跃相一致：\n$$ s = \\frac{f(u_R) - f(u_L)}{u_R - u_L} $$\n代入通量函数 $f(u) = \\frac{1}{2}u^2$：\n$$ s = \\frac{\\frac{1}{2}u_R^2 - \\frac{1}{2}u_L^2}{u_R - u_L} = \\frac{1}{2} \\frac{(u_R - u_L)(u_R + u_L)}{u_R - u_L} = \\frac{1}{2}(u_L + u_R) $$\n代入给定的 $u_L$ 和 $u_R$ 值：\n$$ s = \\frac{1}{2}(2.3 + (-1.1)) = \\frac{1}{2}(1.2) = 0.6 $$\n为了使激波在物理上是可容许的（即一个“熵解”），它必须满足拉克斯熵条件。对于凸通量，此条件为 $f'(u_L)  s  f'(u_R)$。\n使用 $f'(u) = u$，我们检验是否 $u_L  s  u_R$：\n$$ 2.3  0.6  -1.1 $$\n该不等式成立，因此该激波是一个有效的熵解。\n\n黎曼问题的解是相似变量 $\\xi = x/t$ 的函数。对于激波，解在激波路径 $x=st$ 的两侧是常数：\n$$ u(x,t) = u(\\xi) = \\begin{cases} u_L,  \\text{if } \\xi  s \\\\ u_R,  \\text{if } \\xi > s \\end{cases} $$\n在界面 $x=0$ 处的戈杜诺夫通量定义为在该界面处精确黎曼解的状态下计算的物理通量。该界面对应于相似坐标 $\\xi = x/t = 0/t = 0$。\n\n我们必须确定 $u(\\xi=0)$ 的值。这取决于 $\\xi=0$ 与激波速度 $s=0.6$ 的比较。\n由于 $0  0.6$，我们有 $\\xi  s$。根据激波解的结构，界面处的状态是 $u_L$。\n$$ u(x=0, t) = u_L = 2.3 $$\n戈杜诺夫通量 $f^G(u_L, u_R)$ 是在此界面状态下计算的物理通量 $f(u)$：\n$$ f^G(u_L, u_R) = f(u(x=0, t)) = f(u_L) = f(2.3) $$\n我们现在计算这个值：\n$$ f^G = \\frac{1}{2} (2.3)^2 $$\n$$ (2.3)^2 = 5.29 $$\n$$ f^G = \\frac{1}{2} (5.29) = 2.645 $$\n这就是界面 $x=0$ 处的戈杜诺夫通量值。", "answer": "$$\\boxed{2.645}$$", "id": "3364344"}, {"introduction": "在探究了精确的戈杜诺夫 (Godunov) 求解器之后，我们现在转向一种广泛应用的近似黎曼求解器：鲁萨诺夫 (Rusanov) 通量（或局部拉克斯-弗里德里希斯通量）。这项练习从标量方程转向守恒律方程组——浅水方程。核心挑战是确定保证稳定性所需的最小稳定化参数 $\\alpha$，这涉及到分析系统的特征波速。这项实践揭示了数值格式设计中的一个基本权衡：为保证鲁棒性而增加足够的耗散，与为保持精度而最小化耗散之间的矛盾。[@problem_id:3364336]", "problem": "考虑无底部地形的一维浅水方程，其关于水高 $h$ 和流量 $m = h u$ 的守恒形式写作\n$$\n\\partial_{t} \\begin{pmatrix} h \\\\ m \\end{pmatrix} + \\partial_{x} \\begin{pmatrix} m \\\\ \\dfrac{m^{2}}{h} + \\dfrac{1}{2} g h^{2} \\end{pmatrix} = 0,\n$$\n其中 $u$ 是深度平均速度，$g$ 是重力加速度。在间断 Galerkin (DG) 方法中，界面数值通量采用局部 Lax–Friedrichs (LLF，也称为 Rusanov) 通量，其稳定化参数 $\\alpha$ 必须是跨越界面的最快信号速度的上界。\n\n从该系统的基本双曲特性及其特征结构出发，推导在界面处根据左右状态选择 $\\alpha$ 的最小允许值。然后，对于一个具有左迹状态 $(h_{L}, u_{L})$ 和右迹状态 $(h_{R}, u_{R})$ 的特定界面，其中\n$$\nh_{L} = 2.0,\\quad u_{L} = 1.5,\\quad h_{R} = 0.5,\\quad u_{R} = -0.3,\\quad g = 9.81,\n$$\n数值计算 $\\alpha$。将 $\\alpha$ 的最终值以米/秒表示，并四舍五入到四位有效数字。\n\n最后，根据双曲守恒律和不变区域论证的基本原理，解释在高阶 DG 格式中 $\\alpha$ 的大小如何影响水高 $h$ 的保正性，并阐明选择过小与足够大的 $\\alpha$ 在 Courant–Friedrichs–Lewy (CFL) 约束和数值扩散方面的权衡。您的解释必须是定性的；只需数值计算 $\\alpha$。", "solution": "该问题要求推导和计算一维浅水方程的局部 Lax–Friedrichs (LLF) 稳定化参数 $\\alpha$，然后定性讨论其在间断 Galerkin (DG) 数值格式中的作用。\n\n首先验证问题陈述。\n**第 1 步：提取已知条件**\n-   控制方程：$\\partial_{t} \\begin{pmatrix} h \\\\ m \\end{pmatrix} + \\partial_{x} \\begin{pmatrix} m \\\\ \\dfrac{m^{2}}{h} + \\dfrac{1}{2} g h^{2} \\end{pmatrix} = 0$。\n-   状态向量：$\\mathbf{q} = \\begin{pmatrix} h \\\\ m \\end{pmatrix}$，其中 $h$ 是水高，$m=hu$ 是流量。\n-   通量向量：$\\mathbf{f}(\\mathbf{q}) = \\begin{pmatrix} m \\\\ \\frac{m^{2}}{h} + \\frac{1}{2} g h^{2} \\end{pmatrix}$。\n-   数值通量：局部 Lax–Friedrichs (LLF) 或 Rusanov 通量。\n-   稳定化参数：$\\alpha$，它必须是最快信号速度的上界。\n-   界面状态（左迹和右迹）：\n    -   $h_{L} = 2.0$\n    -   $u_{L} = 1.5$\n    -   $h_{R} = 0.5$\n    -   $u_{R} = -0.3$\n-   常数：$g = 9.81$。\n-   任务：\n    1.  推导根据左右状态选择 $\\alpha$ 的最小允许值。\n    2.  数值计算 $\\alpha$ 并精确到四位有效数字。\n    3.  定性解释 $\\alpha$ 对保正性的影响以及涉及 CFL 约束和数值扩散的权衡。\n\n**第 2 步：使用提取的已知条件进行验证**\n该问题具有科学依据，因为它涉及成熟的浅水方程和标准的数值方法（采用 LLF 通量的 DG）。该问题是适定的，提供了所有必要的数据和明确的目标。语言客观且明确。给定的数值在物理上是合理的。该问题是双曲守恒律数值方法领域的标准练习，并非无足轻重或结构不良。\n\n**第 3 步：结论与行动**\n问题有效。将提供完整解答。\n\n**第 1 部分：LLF 参数 $\\alpha$ 的推导**\n\n浅水方程是形式为 $\\partial_{t}\\mathbf{q} + \\partial_{x}\\mathbf{f}(\\mathbf{q}) = 0$ 的双曲守恒律方程组。该系统的特征速度代表信息传播的速度，由通量雅可比矩阵 $A(\\mathbf{q}) = \\frac{\\partial \\mathbf{f}}{\\partial \\mathbf{q}}$ 的特征值给出。\n\n状态向量为 $\\mathbf{q} = \\begin{pmatrix} h \\\\ m \\end{pmatrix}$，通量向量为 $\\mathbf{f}(\\mathbf{q}) = \\begin{pmatrix} m \\\\ \\frac{m^{2}}{h} + \\frac{1}{2} g h^{2} \\end{pmatrix}$。我们计算通量分量相对于状态变量的偏导数：\n$$\nA(\\mathbf{q}) = \\frac{\\partial \\mathbf{f}}{\\partial \\mathbf{q}} = \\begin{pmatrix} \\frac{\\partial f_1}{\\partial h}  \\frac{\\partial f_1}{\\partial m} \\\\ \\frac{\\partial f_2}{\\partial h}  \\frac{\\partial f_2}{\\partial m} \\end{pmatrix}\n$$\n各分量为：\n-   $\\frac{\\partial f_1}{\\partial h} = \\frac{\\partial m}{\\partial h} = 0$\n-   $\\frac{\\partial f_1}{\\partial m} = \\frac{\\partial m}{\\partial m} = 1$\n-   $\\frac{\\partial f_2}{\\partial h} = \\frac{\\partial}{\\partial h} \\left(\\frac{m^2}{h} + \\frac{1}{2}gh^2\\right) = -\\frac{m^2}{h^2} + gh$。代入 $m=hu$，这变为 $-\\frac{(hu)^2}{h^2} + gh = gh - u^2$。\n-   $\\frac{\\partial f_2}{\\partial m} = \\frac{\\partial}{\\partial m} \\left(\\frac{m^2}{h} + \\frac{1}{2}gh^2\\right) = \\frac{2m}{h}$。代入 $m=hu$，这变为 $\\frac{2hu}{h} = 2u$。\n\n因此，雅可比矩阵为：\n$$\nA(\\mathbf{q}) = \\begin{pmatrix} 0  1 \\\\ gh - u^2  2u \\end{pmatrix}\n$$\n特征值 $\\lambda$ 是特征方程 $\\det(A - \\lambda I) = 0$ 的根：\n$$\n\\det \\begin{pmatrix} -\\lambda  1 \\\\ gh - u^2  2u - \\lambda \\end{pmatrix} = (-\\lambda)(2u - \\lambda) - (1)(gh - u^2) = 0\n$$\n$$\n\\lambda^2 - 2u\\lambda - (gh - u^2) = 0\n$$\n$$\n\\lambda^2 - 2u\\lambda + u^2 - gh = 0\n$$\n$$\n(\\lambda - u)^2 - gh = 0\n$$\n$$\n(\\lambda - u)^2 = gh\n$$\n两边取平方根，得到 $\\lambda - u = \\pm\\sqrt{gh}$。特征值，即特征速度，为：\n$$\n\\lambda_{1,2} = u \\pm \\sqrt{gh}\n$$\n这些代表了在水面上​​传播的重力波的速度。令 $c = \\sqrt{gh}$ 为波速。\n\n在左状态 $\\mathbf{q}_L$ 和右状态 $\\mathbf{q}_R$ 之间的界面上的局部 Lax–Friedrichs（或 Rusanov）数值通量由下式给出：\n$$\n\\mathbf{f}_{LLF}(\\mathbf{q}_L, \\mathbf{q}_R) = \\frac{1}{2} \\left[ \\mathbf{f}(\\mathbf{q}_L) + \\mathbf{f}(\\mathbf{q}_R) \\right] - \\frac{\\alpha}{2} \\left[ \\mathbf{q}_R - \\mathbf{q}_L \\right]\n$$\n参数 $\\alpha$ 是一个引入数值扩散的稳定项。为使数值格式稳定，数值依赖域必须包含物理依赖域。这要求 $\\alpha$ 是从界面传播开的最快信号速度大小的上界。信号速度是在局部状态下计算的特征值。\n\n对于任何给定状态 $(h, u)$，最大绝对特征值为：\n$$\nS(h,u) = \\max(|\\lambda_1|, |\\lambda_2|) = \\max(|u + \\sqrt{gh}|, |u - \\sqrt{gh}|) = |u| + \\sqrt{gh}\n$$\n因为 $\\sqrt{gh} \\ge 0$。\n\n在状态 $(h_L, u_L)$ 和 $(h_R, u_R)$ 之间的界面上，稳定化参数 $\\alpha$ 必须大于或等于从界面任一侧发出的最快可能信号速度。因此，$\\alpha$ 的最小允许选择是左右状态最快信号速度的最大值：\n$$\n\\alpha = \\max(S(h_L, u_L), S(h_R, u_R)) = \\max(|u_L| + \\sqrt{gh_L}, |u_R| + \\sqrt{gh_R})\n$$\n这就是推导出的 $\\alpha$ 的最小允许选择的表达式。\n\n**第 2 部分：$\\alpha$ 的数值计算**\n\n使用给定数据：\n-   $h_{L} = 2.0$, $u_{L} = 1.5$\n-   $h_{R} = 0.5$, $u_{R} = -0.3$\n-   $g = 9.81$\n\n我们计算左状态的最大信号速度 $S_L$：\n$$\nS_L = |u_L| + \\sqrt{gh_L} = |1.5| + \\sqrt{9.81 \\times 2.0} = 1.5 + \\sqrt{19.62}\n$$\n$$\nS_L \\approx 1.5 + 4.4294469 = 5.9294469 \\, \\text{m/s}\n$$\n接下来，我们计算右状态的最大信号速度 $S_R$：\n$$\nS_R = |u_R| + \\sqrt{gh_R} = |-0.3| + \\sqrt{9.81 \\times 0.5} = 0.3 + \\sqrt{4.905}\n$$\n$$\nS_R \\approx 0.3 + 2.2147235 = 2.5147235 \\, \\text{m/s}\n$$\n$\\alpha$ 的最小值为这两个速度的最大值：\n$$\n\\alpha = \\max(S_L, S_R) = \\max(5.9294469, 2.5147235) = 5.9294469\n$$\n将结果四舍五入到四位有效数字，我们得到：\n$$\n\\alpha \\approx 5.929 \\, \\text{m/s}\n$$\n\n**第 3 部分：定性解释**\n\nLLF 参数 $\\alpha$ 的大小对 DG 格式的属性有深远影响，特别是在保正性、稳定性和精度方面。\n\n**对保正性的影响：**\n水高 $h$ 是一个物理上的正量。如果一个数值格式在给定正初始状态的情况下能保证 $h$ 保持为正，则该格式是“保正的”。对于高阶 DG 格式，它将解表示为每个单元内的多项式，确保保正性具有挑战性，因为即使单元平均值保持为正，该多项式也可能在某些点出现下冲并变为负值。这些下冲通常与尖锐梯度或不连续点附近的强烈的、非物理的振荡（Gibbs 现象）有关。\n\nLLF 通量引入了一个与 $\\alpha$ 和解的跳跃成正比的数值扩散项 $-\\frac{\\alpha}{2}(\\mathbf{q}_R - \\mathbf{q}_L)$。该项的作用类似于物理扩散或粘性。较大的 $\\alpha$ 值对应于更强的扩散。这种扩散对解有平滑或涂抹效应，这对于抑制引起下冲的高频振荡至关重要。通过充分抑制这些振荡，足够大的 $\\alpha$ 有助于防止 $h$ 的解降至零以下。本质上，增加的耗散有助于强制执行局部极值递减属性，使格式更鲁棒，更有可能保持 $h$ 的正性。为了使 DG 格式可被证明是保正的，通常需要一个足够大的 $\\alpha$ 以及一个适当严格的时间步长约束。\n\n**在小 $\\alpha$ 与大 $\\alpha$ 之间的权衡：**\n\n选择 $\\alpha$ 的大小涉及到数值扩散（精度）和稳定性（鲁棒性）之间的关键权衡，这也影响了基于 CFL 的时间步长约束。\n\n1.  **选择过小的 $\\alpha$：** 如果选择的 $\\alpha$ 小于上面推导的最小要求值，数值格式将无法考虑所有物理波速。数值依赖域会变得比物理依赖域小，导致违反收敛的基本要求（Courant-Friedrichs-Lewy 条件），从而引发灾难性的不稳定性。解通常会以指数级的误差增长而发散。\n\n2.  **选择最小但足够的 $\\alpha$：** 使用最小允许值 $\\alpha = \\max(|u_L|+\\sqrt{gh_L}, |u_R|+\\sqrt{gh_R})$，恰好提供了确保界面稳定所需的扩散量。这种选择通常能得到 LLF 通量所能达到的最精确结果，因为它最小化了数值涂抹。然而，它为鲁棒性提供的“安全裕度”最小。该格式在激波附近可能仍会表现出显著但有界的振荡，并且在极端情况下可能难以保持正性。\n\n3.  **选择比必要值更大的 $\\alpha$：**\n    -   **缺点（数值扩散和精度）：** 更大的 $\\alpha$ 会增加数值扩散量。这种过度的扩散会涂抹解中的尖锐特征，例如激波前缘和接触不连续面，使它们显得更分散、更不陡峭。这会降低格式的形式精度，特别是对于具有不连续解的问题。解会变得过于模糊。\n    -   **缺点（CFL 约束和成本）：** 对于显式时间步进格式，最大稳定时间步长 $\\Delta t$ 受到 CFL 条件的限制，其形式大致为 $\\Delta t \\le C \\frac{\\Delta x}{\\lambda_{\\text{max, global}}}$。在使用 LLF 通量的格式中，有效最大信号速度由 $\\alpha$ 控制。因此，更大的 $\\alpha$ 会导致更严格的 CFL 条件，迫使使用更小的 $\\Delta t$。这增加了达到给定模拟时间所需的总时间步数，使计算成本更高。\n    -   **优点（鲁棒性）：** 更大 $\\alpha$ 的主要好处是增强了鲁棒性。增加的扩散在抑制数值振荡、防止保正性失效以及在存在非常强激波或复杂波相互作用时稳定计算方面非常有效。\n\n总而言之，这种权衡是鲜明的：一个较小（但足够）的 $\\alpha$ 优先考虑精度和计算效率，但代价是较低的鲁棒性和潜在的保正性问题。一个较大的 $\\alpha$ 优先考虑鲁棒性和稳定性，但代价是精度降低和计算费用增加。$\\alpha$ 的最优选择取决于具体问题以及在这些竞争因素之间期望的平衡。", "answer": "$$\n\\boxed{5.929}\n$$", "id": "3364336"}, {"introduction": "这最后一项实践提升了挑战难度，重点在于实现一种更高级的求解器——Harten-Lax-van Leer-Contact (HLLC) 通量。与鲁萨诺夫 (Rusanov) 通量相比，HLLC 通量通过解析接触波提供了更高的精度。本练习围绕一个实际应用展开：模拟包含“干湿”现象的浅水流动。你将实现一个鲁棒的、保持正性的 HLLC 求解器，这需要对干态条件进行特殊处理并包含回退到更简单的 HLL 通量的机制，从而展示了如何调整复杂的求解器以适应真实的工程和环境问题。[@problem_id:3364315]", "problem": "考虑一维浅水方程，这是一个无源项的双曲守恒律方程组，其守恒变量向量为 $U = [h, q]^\\top$，其中 $h$ 是水深（单位为米），$q = h u$ 是流量（单位为 $\\mathrm{m}^2/\\mathrm{s}$），$u$ 是速度（单位为 $\\mathrm{m}/\\mathrm{s}$）。通量向量 $F(U)$ 定义为 $F(U) = [q, q^2/h + \\tfrac{1}{2} g h^2]^\\top$，其中 $g$ 是重力加速度（单位为 $\\mathrm{m}/\\mathrm{s}^2$）。在谱方法和间断 Galerkin 方法的背景下，使用分片常数基函数的间断 Galerkin 方法（等效于有限体积法），在一个包含两个单元的均匀网格上，并采用周期性边界条件。单元 $i$ 内单元平均值的半离散更新从弱形式导出为\n$$\n\\frac{d}{dt} U_i(t) = -\\frac{1}{\\Delta x} \\left( \\widehat{F}(U_i^-, U_{i+1}^+) - \\widehat{F}(U_{i-1}^-, U_i^+) \\right),\n$$\n其中 $\\Delta x$ 是单元宽度（单位为米），$\\widehat{F}$ 是在每个界面处通过近似 Riemann 求解器得到的一致性数值通量，使用单元边界上的左迹 $U^-$ 和右迹 $U^+$。\n\n您的任务是为浅水方程实现一个能处理干态（dry-state-aware）的 Harten-Lax-van Leer-Contact (HLLC) 近似 Riemann 求解器，并在接近干态的溃坝场景下，与 Lax-Friedrichs (Rusanov) 通量在保持水深 $h$ 正性方面的表现进行比较。请基于以下基本出发点进行推导：\n\n- 如上定义的浅水方程守恒形式及通量 $F(U)$。\n- 波速 $c = \\sqrt{g h}$ 以及由 $u \\pm c$ 近似界定的特征速度。\n- 双曲系统中跨波的 Rankine-Hugoniot 跳跃条件。\n\n您必须推导出一个能处理干态的左右边界波速 $S_L$ 和 $S_R$ 的估计，该估计适用于在近真空状态下的 HLL/HLLC 族求解器，并确保在 $h \\to 0$ 时的稳健性。从经典估计 $S_L = \\min(u_L - c_L, u_R - c_R)$ 和 $S_R = \\max(u_L + c_L, u_R + c_R)$ 出发，其中下标 $L$ 和 $R$ 分别表示左、右状态，且 $c = \\sqrt{g h}$。然后，仅利用上述基本出发点，解析地论证并指定当一侧为干态（$h \\approx 0$）时的一种修正方法，该方法通过扩大波速来维持中间状态的正性；例如，当另一侧为干态时，在湿润侧使用 $S_L = u_{\\mathrm{wet}} - 2 c_{\\mathrm{wet}}$ 和 $S_R = u_{\\mathrm{wet}} + 2 c_{\\mathrm{wet}}$。\n\n接下来，使用 Rankine-Hugoniot 条件推导浅水 HLLC 求解器中的接触（中间）波速 $S_*$，用 $S_L$、$S_R$、$U_L$ 和 $U_R$ 来表示，其中使用了静水“压力”的类比 $p = \\tfrac{1}{2} g h^2$：\n$$\nS_* = \\frac{p_R - p_L + q_L (S_L - u_L) - q_R (S_R - u_R)}{h_L (S_L - u_L) - h_R (S_R - u_R)}.\n$$\n展示如何构造中间状态 $U_{*L} = [h_{*L}, q_{*L}]^\\top$ 和 $U_{*R} = [h_{*R}, q_{*R}]^\\top$：\n$$\nh_{*L} = h_L \\frac{S_L - u_L}{S_L - S_*}, \\quad h_{*R} = h_R \\frac{S_R - u_R}{S_R - S_*}, \\quad q_{*L} = h_{*L} S_*, \\quad q_{*R} = h_{*R} S_*,\n$$\n并指定一种数学上一致的回退机制，即当中间深度 $h_{*L}$ 或 $h_{*R}$ 变为非正值或计算 $S_*$ 的分母退化时，回退到 Harten-Lax-van Leer (HLL) 双波通量，以保持正性。\n\n实现两种数值通量：\n\n1. 能处理干态的 HLLC 通量，它使用上述的 $S_L$、$S_R$ 和 $S_*$，并在必要时回退到 HLL。最终的通量由常规的 HLLC 分情况讨论给出：\n   - 如果 $S_L \\ge 0$，使用 $F(U_L)$。\n   - 如果 $S_R \\le 0$，使用 $F(U_R)$。\n   - 否则，如果 $S_* \\ge 0$，使用 $F(U_L) + S_L (U_{*L} - U_L)$。\n   - 否则，使用 $F(U_R) + S_R (U_{*R} - U_R)$。\n2. Rusanov (Lax-Friedrichs) 通量\n$$\n\\widehat{F}_{\\mathrm{Rus}} = \\frac{1}{2} \\left( F(U_L) + F(U_R) \\right) - \\frac{1}{2} a_{\\max} (U_R - U_L), \\quad a_{\\max} = \\max\\left( |u_L| + c_L, |u_R| + c_R \\right).\n$$\n\n使用前向欧拉时间步进法进行单步时间积分，作用于两个周期性单元。具体来说，对于状态为 $U_0^n$ 和 $U_1^n$ 的单元 $i = 0$ 和 $i = 1$，存在两个界面，一个位于 $U_0$ 和 $U_1$ 之间的 $x_{1/2}$ 处，另一个（由于周期性）位于 $U_1$ 和 $U_0$ 之间的 $x_{3/2}$ 处，其更新公式为\n$$\nU_i^{n+1} = U_i^n - \\frac{\\Delta t}{\\Delta x} \\left( \\widehat{F}_{i+1/2} - \\widehat{F}_{i-1/2} \\right).\n$$\n将重力加速度设为 $g = 9.81$ $\\mathrm{m}/\\mathrm{s}^2$。对于每个测试用例，将单元宽度设为 $\\Delta x = 1$ 米，并根据 Courant-Friedrichs-Lewy (CFL) 条件 $\\Delta t = \\mathrm{CFL} \\cdot \\Delta x / a_{\\max}$ (其中 $\\mathrm{CFL} = 0.9$) 来选择时间步长 $\\Delta t$，这里的 $a_{\\max}$ 是根据所考虑情况的界面状态计算得出的。在所有计算中，将任何小于机器阈值 $\\epsilon$（$\\epsilon = 10^{-12}$ 米）的水深 $h$ 视为干态，并确保数值实现中避免除以零。\n\n测试套件：\n对于每个测试用例，使用给定的溃坝类型状态 $(h_0, u_0; h_1, u_1)$ 来初始化两个周期性单元 $(U_0, U_1)$，其中流量为 $q = h u$。所有水深单位为米，速度单位为 $\\mathrm{m}/\\mathrm{s}$。\n\n- 用例 A (左湿右干): $(h_0 = 1.0, u_0 = 0.0; h_1 = 10^{-12}, u_1 = 0.0)$。\n- 用例 B (左极湿右干): $(h_0 = 10.0, u_0 = 0.0; h_1 = 10^{-12}, u_1 = 0.0)$。\n- 用例 C (左干右湿): $(h_0 = 10^{-12}, u_0 = 0.0; h_1 = 1.0, u_1 = 0.0)$。\n- 用例 D (全干): $(h_0 = 0.0, u_0 = 0.0; h_1 = 0.0, u_1 = 0.0)$。\n- 用例 E (左近干右干): $(h_0 = 10^{-6}, u_0 = 0.0; h_1 = 0.0, u_1 = 0.0)$。\n\n对每个用例，分别使用 HLLC 通量和 Rusanov 通量执行一次前向欧拉更新，并评估两个单元中更新后的水深是否为非负值（大于或等于零）。每个求解器、每个用例使用逻辑结果。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。每个条目对应一个测试用例，且本身应为一个双元素列表 $[b_{\\mathrm{HLLC}}, b_{\\mathrm{Rus}}]$，其中 $b_{\\mathrm{HLLC}}$ 和 $b_{\\mathrm{Rus}}$ 是布尔值，分别表示 HLLC 通量和 Rusanov 通量更新后水深是否保持非负。例如，一个可能的输出可能看起来像 $[[\\mathrm{True},\\mathrm{True}],[\\mathrm{True},\\mathrm{True}],\\dots]$。", "solution": "任务目标是为一维浅水方程实现并比较两种近似 Riemann 求解器——一种能处理干态的 Harten-Lax-van Leer-Contact (HLLC) 通量和一种 Rusanov (Lax-Friedrichs) 通量。比较的重点是在涉及干态或近干态的溃坝场景下，保持水深 $h$ 正性的性质。指定的数值框架是一个双单元、周期性、分片常数间断 Galerkin（等效于有限体积）方法，采用单步前向欧拉时间积分。\n\n### 1. 控制方程\n一维浅水方程的守恒形式由下式给出：\n$$ \\frac{\\partial U}{\\partial t} + \\frac{\\partial F(U)}{\\partial x} = 0 $$\n其中 $U$ 是守恒变量向量，$F(U)$ 是通量向量：\n$$ U = \\begin{pmatrix} h \\\\ q \\end{pmatrix}, \\quad F(U) = \\begin{pmatrix} q \\\\ \\frac{q^2}{h} + \\frac{1}{2}gh^2 \\end{pmatrix} $$\n此处，$h$ 是水深，$q = hu$ 是流量，$u$ 是流体速度，$g$ 是重力加速度，设为 $g=9.81 \\, \\mathrm{m/s^2}$。一个关键量是波速 $c = \\sqrt{gh}$，它决定了系统的特征速度 $\\lambda_{1,2} = u \\pm c$。任何低于阈值 $\\epsilon = 10^{-12} \\, \\mathrm{m}$ 的水深 $h$ 都被视为干态。\n\n### 2. 数值离散化\n采用在两个单元（索引为 $i=0$ 和 $i=1$）上的有限体积法，并施加周期性边界条件。单元宽度为 $\\Delta x = 1 \\, \\mathrm{m}$。单元平均状态 $U_i$ 的半离散更新公式为：\n$$ \\frac{dU_i}{dt} = -\\frac{1}{\\Delta x} \\left( \\widehat{F}_{i+1/2} - \\widehat{F}_{i-1/2} \\right) $$\n其中 $\\widehat{F}_{i+1/2}$ 是单元 $i$ 和单元 $i+1$ 之间界面的数值通量。对于我们的双单元周期性区域，$U_0$ 和 $U_1$ 的更新公式为：\n$$ U_0^{n+1} = U_0^n - \\frac{\\Delta t}{\\Delta x} \\left( \\widehat{F}(U_0^n, U_1^n) - \\widehat{F}(U_1^n, U_0^n) \\right) $$\n$$ U_1^{n+1} = U_1^n - \\frac{\\Delta t}{\\Delta x} \\left( \\widehat{F}(U_1^n, U_0^n) - \\widehat{F}(U_0^n, U_1^n) \\right) $$\n时间积分使用单步前向欧拉方法执行。时间步长 $\\Delta t$ 由 Courant-Friedrichs-Lewy (CFL) 条件确定，CFL 数为 $0.9$：\n$$ \\Delta t = \\mathrm{CFL} \\frac{\\Delta x}{a_{\\max}} $$\n其中 $a_{\\max} = \\max(|u_0| + c_0, |u_1| + c_1)$ 是所有初始状态中的最大信号速度。\n\n### 3. Rusanov (Lax-Friedrichs) 通量\nRusanov 通量是一种简单、稳健但耗散性强的 Riemann 求解器。对于左状态 $U_L$ 和右状态 $U_R$，它定义为：\n$$ \\widehat{F}_{\\mathrm{Rus}}(U_L, U_R) = \\frac{1}{2} \\left( F(U_L) + F(U_R) \\right) - \\frac{1}{2} a_{\\max}^{LR} (U_R - U_L) $$\n其耗散项由界面处的局部最大信号速度 $a_{\\max}^{LR} = \\max(|u_L| + c_L, |u_R| + c_R)$ 控制。虽然稳健，但在极端情况下，如溃坝涌向干涸区域时，其强耗散有时会导致产生非物理的负水深。\n\n### 4. HLLC 近似 Riemann 求解器\nHLLC 求解器是 Harten-Lax-van Leer (HLL) 求解器的扩展。它用三道波来模拟 Riemann 扇——两道外部非线性波和一道中间的接触波。\n\n#### 4.1. 波速估计 ($S_L, S_R$)\nHLL 型求解器的性能关键取决于最左 ($S_L$) 和最右 ($S_R$) 波速的估计。\n- 对于两个湿润状态 ($h_L, h_R \\ge \\epsilon$)，使用基于特征速度的经典估计：\n$$ S_L = \\min(u_L - c_L, u_R - c_R), \\quad S_R = \\max(u_L + c_L, u_R + c_R) $$\n- 对于湿-干界面，Riemann 问题的精确解涉及一个向真空中扩展的稀疏波。该波的头部以 $u_{\\mathrm{wet}}-c_{\\mathrm{wet}}$ 的速度传播，尾部以 $u_{\\mathrm{wet}}+2c_{\\mathrm{wet}}$ 的速度传播。为确保数值波扇能稳健地包含物理波扇并增强正性，题目指定了一种扩大波速估计的修正方法。如果一个状态是湿润的而另一个是干的，则仅使用湿润状态的属性来估计波速：\n$$ S_L = u_{\\mathrm{wet}} - 2 c_{\\mathrm{wet}}, \\quad S_R = u_{\\mathrm{wet}} + 2 c_{\\mathrm{wet}} $$\n这种解析修正在近真空条件下对稳健性至关重要。如果两个状态都是干的，所有速度和波速均为零，导致 $S_L=S_R=0$。\n\n#### 4.2. HLLC 中间状态和接触波速 ($S_*$)\nHLLC 模型引入了两个中间状态 $U_{*L}$ 和 $U_{*R}$，由一个以速度 $S_*$ 移动的接触间断分隔。已知状态 $U_L$ 和 $U_R$ 通过速度为 $S_L$ 和 $S_R$ 的波与这些星号状态相连。对这些波应用 Rankine-Hugoniot 跳跃条件 $F(U_2) - F(U_1) = S(U_2 - U_1)$，可以得到中间状态和接触波速的表达式。\n\n在接触波上，类比的 Euler 方程系统中，速度和压力（对于浅水方程 SWE 是 $p = \\frac{1}{2}gh^2$）是连续的。对于浅水方程，相应的条件是速度 $u$ 和深度 $h$ 的连续性。然而，用于浅水方程的 HLLC Riemann 求解器是通过类比 Euler 方程推导出来的，在 Euler 方程中，压力在接触间断上是连续的。这导致 $p_{*L} = p_{*R}$。星号区域的速度是恒定的，等于接触波速，即 $u_{*L} = u_{*R} = S_*$。\n根据跨越左波的质量守恒跳跃条件 $q_{*L} - q_L = S_L(h_{*L} - h_L)$，并使用 $q_{*L} = h_{*L}S_*$，我们推导出左侧中间状态的深度：\n$$ h_{*L} S_* - h_L u_L = S_L (h_{*L} - h_L) \\implies h_{*L}(S_* - S_L) = h_L(u_L - S_L) \\implies h_{*L} = h_L \\frac{S_L-u_L}{S_L-S_*} $$\n对右波进行类似推导可得 $h_{*R} = h_R \\frac{S_R-u_R}{S_R-S_*}$。流量则为 $q_{*L} = h_{*L}S_*$ 和 $q_{*R} = h_{*R}S_*$。\n\n接触波速 $S_*$ 是通过在接触间断上施加‘压力’ $p = \\frac{1}{2}gh^2$ 的连续性条件 $p_{*L} = p_{*R}$（在用动量跳跃条件表示 $p_{*L}$ 和 $p_{*R}$ 之后）找到的。这得到了题目中给出的公式：\n$$ S_* = \\frac{p_R - p_L + q_L (S_L - u_L) - q_R (S_R - u_R)}{h_L (S_L - u_L) - h_R (S_R - u_R)} $$\n其中 $p_K = \\frac{1}{2}gh_K^2$，$K=L,R$。\n\n#### 4.3. 正性保持与 HLL 回退\n如果波速估计不当，或由于数值误差，$h_{*L}$ 和 $h_{*R}$ 的表达式可能会产生负水深。为了保持正性，求解器必须检查是否 $h_{*L}  0$ 且 $h_{*R}  0$。如果其中任一值为非正，或者 $S_*$ 计算中的分母接近于零，则 HLLC 模型对该 Riemann 问题无效。在这种情况下，有必要回退到更稳健（但更具耗散性）的双波 HLL 求解器。HLL 通量为：\n$$ \\widehat{F}_{\\mathrm{HLL}} = \\frac{S_R F(U_L) - S_L F(U_R) + S_L S_R (U_R - U_L)}{S_R - S_L} $$\n这种回退机制在保证稳健性的同时，在 HLLC 有效的区域保留了其准确性。\n\n#### 4.4. 最终 HLLC 通量\nHLLC 通量的选择基于界面（在 Riemann 问题的坐标系中位于 $x=0$ 处）相对于波扇结构的位置：\n- 如果 $S_L \\ge 0$：界面位于左侧区域。$\\widehat{F}_{\\mathrm{HLLC}} = F(U_L)$。\n- 如果 $S_R \\le 0$：界面位于右侧区域。$\\widehat{F}_{\\mathrm{HLLC}} = F(U_R)$。\n- 如果 $S_L  0 \\le S_*$：界面位于左星号区域。$\\widehat{F}_{\\mathrm{HLLC}} = F(U_L) + S_L(U_{*L} - U_L)$。\n- 如果 $S_*  0  S_R$：界面位于右星号区域。$\\widehat{F}_{\\mathrm{HLLC}} = F(U_R) + S_R(U_{*R} - U_R)$。\n如果触发了到 HLL 的回退，则改用 $\\widehat{F}_{\\mathrm{HLL}}$。\n\n这种结合了能处理干态的波速和稳健回退机制的 HLLC 求解器，使其成为精确并能保持正性地模拟含干底的浅水流的有力候选者。", "answer": "[[True,False],[True,False],[True,False],[True,True],[True,False]]", "id": "3364315"}]}