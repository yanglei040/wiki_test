{"hands_on_practices": [{"introduction": "在数值分析中，抽象的定义通常通过具体的例子得以阐明。第一个实践练习将提升算子的概念具体化，引导您在最简单的设置下（一维单元上的线性多项式）完成其显式构造。通过将Riesz表示定理转化为一个小型、可解的线性系统，本练习旨在揭开其神秘面纱，并为理解其在间断Galerkin (DG) 方法中的作用奠定坚实的基础 [@problem_id:3395997]。", "problem": "考虑一维参考单元 $K=[-1,1]$ 以及 $K$ 上次数至多为 1 的多项式构成的标量有限维近似空间 $V_h=\\mathbb{P}_1(K)$。在间断伽辽金(DG)方法中，边提升算子 $L_F$ 将支集在单个边 $F\\subset \\partial K$ 上的边函数 $g$ 映射为一个体函数 $L_F(g)\\in V_h$。该算子由边界泛函关于 $L^2(K)$ 内积的 Riesz 表示定义：\n$$\n\\int_{K} L_F(g)\\, v \\, dx \\;=\\; \\int_{F} g\\, v \\, ds \\quad \\text{for all } v\\in V_h.\n$$\n假设端点边为 $F=\\{1\\}$，且在该边上 $g=1$。使用标准的 $L^2(K)$ 内积作为 Riesz 映射，并通过求解相关的质量矩阵系统，在 $V_h$ 的基 $\\{\\phi_0(x),\\phi_1(x)\\}=\\{1,x\\}$ 中表示 $L_F(g)$。计算 $L_F(g)$ 作为 $x$ 的函数的显式闭式表达式。\n\n你的最终答案必须是单一的闭式解析表达式。不要在最终答案中提供中间方程。", "solution": "首先验证问题，以确保其具有科学依据、是适定的、客观且完整的。\n\n### 步骤 1：提取已知条件\n- 区域：一维参考单元 $K = [-1, 1]$。\n- 近似空间：$V_h = \\mathbb{P}_1(K)$，次数至多为 1 的多项式空间。\n- $V_h$ 的基：$\\{\\phi_0(x), \\phi_1(x)\\} = \\{1, x\\}$。\n- 边提升算子 $L_F(g) \\in V_h$ 的定义：\n$$ \\int_{K} L_F(g)\\, v \\, dx = \\int_{F} g\\, v \\, ds \\quad \\text{for all } v \\in V_h. $$\n- 特定边：$F = \\{1\\}$。\n- 特定边函数：在 $F$ 上 $g = 1$。\n- Riesz 映射的内积：标准 $L^2(K)$ 内积，$\\langle u, v \\rangle = \\int_K uv \\, dx$。\n- 任务：计算 $L_F(g)$ 作为 $x$ 的函数的显式闭式表达式。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题在数值分析领域，特别是在间断伽辽金(DG)方法中，具有科学依据。通过 Riesz 表示定理来定义提升算子是 DG 方法理论中的一个标准核心概念。该问题是适定的；对于具有给定内积的有限维空间 $V_h$，Riesz 表示定理保证了解 $L_F(g)$ 的存在性和唯一性。问题陈述是客观的，使用了精确的数学术语，没有歧义。所有必要的数据和定义都已提供，并且没有矛盾之处。该问题是应用 DG 提升算子定义的一个标准、可解的练习。\n\n### 步骤 3：结论与行动\n问题有效。将推导解答。\n\n### 解答推导\n目标是找到函数 $L_F(g) \\in V_h = \\mathbb{P}_1(K)$。由于 $L_F(g)$ 是一个次数至多为 1 的多项式，它可以表示为基函数 $\\{\\phi_0(x), \\phi_1(x)\\} = \\{1, x\\}$ 的线性组合。设此表示为：\n$$\nL_F(g)(x) = c_0 \\phi_0(x) + c_1 \\phi_1(x) = c_0 \\cdot 1 + c_1 \\cdot x\n$$\n其中 $c_0$ 和 $c_1$ 是待确定的未知系数。\n\n提升算子的定义方程为：\n$$\n\\int_{K} L_F(g)\\, v \\, dx = \\int_{F} g\\, v \\, ds\n$$\n该方程必须对所有测试函数 $v \\in V_h$ 成立。只需对基函数 $v = \\phi_0(x)$ 和 $v = \\phi_1(x)$ 施加此条件即可。这将得到一个关于两个未知数 $c_0$ 和 $c_1$ 的二元线性方程组。\n\n将 $L_F(g)(x)$ 的表达式代入定义方程，我们得到：\n$$\n\\int_{-1}^{1} (c_0 + c_1 x) \\, v(x) \\, dx = \\int_{\\{1\\}} g(1) \\, v(1) \\, ds\n$$\n在边 $F=\\{1\\}$ 上的积分被解释为点求值，因此 $\\int_{\\{1\\}} f(x) ds = f(1)$。给定在 $F$ 上 $g=1$，方程右侧变为 $g(1)v(1) = 1 \\cdot v(1) = v(1)$。\n\n我们现在对每个基函数进行测试：\n\n情况 1：$v(x) = \\phi_0(x) = 1$。\n方程变为：\n$$\n\\int_{-1}^{1} (c_0 + c_1 x) \\cdot 1 \\, dx = \\phi_0(1) = 1\n$$\n$$\nc_0 \\int_{-1}^{1} 1 \\, dx + c_1 \\int_{-1}^{1} x \\, dx = 1\n$$\n计算积分：\n$$\n\\int_{-1}^{1} 1 \\, dx = [x]_{-1}^{1} = 1 - (-1) = 2\n$$\n$$\n\\int_{-1}^{1} x \\, dx = \\left[\\frac{x^2}{2}\\right]_{-1}^{1} = \\frac{1}{2} - \\frac{1}{2} = 0\n$$\n所以，第一个方程是：\n$$\n2c_0 + 0 \\cdot c_1 = 1\n$$\n\n情况 2：$v(x) = \\phi_1(x) = x$。\n方程变为：\n$$\n\\int_{-1}^{1} (c_0 + c_1 x) \\cdot x \\, dx = \\phi_1(1) = 1\n$$\n$$\nc_0 \\int_{-1}^{1} x \\, dx + c_1 \\int_{-1}^{1} x^2 \\, dx = 1\n$$\n计算积分：\n$$\n\\int_{-1}^{1} x \\, dx = 0\n$$\n$$\n\\int_{-1}^{1} x^2 \\, dx = \\left[\\frac{x^3}{3}\\right]_{-1}^{1} = \\frac{1}{3} - \\left(-\\frac{1}{3}\\right) = \\frac{2}{3}\n$$\n所以，第二个方程是：\n$$\n0 \\cdot c_0 + \\frac{2}{3} c_1 = 1\n$$\n\n我们得到以下关于 $(c_0, c_1)$ 的线性方程组：\n$$\n\\begin{pmatrix}\n\\int_K \\phi_0 \\phi_0 dx  \\int_K \\phi_0 \\phi_1 dx \\\\\n\\int_K \\phi_1 \\phi_0 dx  \\int_K \\phi_1 \\phi_1 dx\n\\end{pmatrix}\n\\begin{pmatrix}\nc_0 \\\\\nc_1\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n\\phi_0(1) \\\\\n\\phi_1(1)\n\\end{pmatrix}\n$$\n代入计算出的值：\n$$\n\\begin{pmatrix}\n2  0 \\\\\n0  \\frac{2}{3}\n\\end{pmatrix}\n\\begin{pmatrix}\nc_0 \\\\\nc_1\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n1 \\\\\n1\n\\end{pmatrix}\n$$\n这就是问题中提到的质量矩阵系统。由于质量矩阵是对角的（因为基函数 $\\{1, x\\}$ 在对称区间 $[-1, 1]$ 上是 $L^2$-正交的），可以直接求得解：\n从第一行：\n$$\n2c_0 = 1 \\implies c_0 = \\frac{1}{2}\n$$\n从第二行：\n$$\n\\frac{2}{3}c_1 = 1 \\implies c_1 = \\frac{3}{2}\n$$\n找到系数后，我们可以构建提升算子作用于边 $F=\\{1\\}$ 上的 $g=1$ 时的显式表达式：\n$$\nL_F(g)(x) = c_0 + c_1 x = \\frac{1}{2} + \\frac{3}{2}x\n$$\n这就是所求的闭式表达式。", "answer": "$$\n\\boxed{\\frac{1}{2} + \\frac{3}{2}x}\n$$", "id": "3395997"}, {"introduction": "在原则上（使用精确积分）知道了如何计算提升算子之后，我们必须面对计算机实现的现实：积分是通过数值求积来近似的。本练习在前一实践的基础上，探讨了多项式基函数选择（模态与节点）和求积规则之间的关键相互作用。它揭示了这些实现上的选择如何影响计算出的提升算子的准确性，这对于编写可靠的DG求解器至关重要 [@problem_id:3396023]。", "problem": "考虑单个参考单元 $K$（例如，张量积区间或正方形）和多项式空间 $[\\mathbb{P}_p(K)]^d$，其中 $\\mathbb{P}_p(K)$ 表示在 $K$ 上总次数至多为 $p$ 的多项式，且 $d \\in \\{1,2,3\\}$。对于二阶问题的内部罚分不连续伽辽金 (DG) 格式，一个典范提升算子 $R_h$ 通过与 $L^2(K)$ 内积相关的 Riesz 表示，将定义在 $\\partial K$ 上的面数据 $\\lambda$ 映射为一个向量场 $R_h(\\lambda) \\in [\\mathbb{P}_p(K)]^d$：对所有 $v \\in [\\mathbb{P}_p(K)]^d$ 成立，\n$$(R_h(\\lambda), v)_{L^2(K)} \\;=\\; \\langle \\lambda, v \\cdot n \\rangle_{L^2(\\partial K)}.$$\n这里 $n$ 是 $\\partial K$ 上的外单位法向量。在实际实现中，$K$ 和 $\\partial K$ 上的内积通过精确积分或求积计算，离散 Riesz 映射依赖于这些选择。\n\n两种常见的实现是：\n- 模态实现：使用一个在精确积分下是 $L^2(K)$-正交的 Legendre 多项式基，因此在精确积分下 $K$ 上的质量矩阵是对角的。\n- 节点实现：使用与 Legendre-Gauss-Lobatto (LGL) 节点相关的节点基，并通过在每个坐标方向上具有 $p+1$ 个点的配置 LGL 求积来计算所有体积和面积分。\n\n可使用的经过充分检验的求积事实：\n- $N$ 点 Gauss-Legendre (GL) 求积在一个区间上对次数高达 $2N-1$ 的多项式是精确的。\n- $(N+1)$ 点 Legendre-Gauss-Lobatto (LGL) 求积在一个区间上对次数高达 $2N-1$ 的多项式是精确的。\n- 张量积法则的精确度由一维精确度的张量積给出。\n\n回答以下多项选择题。选择所有正确的陈述，并从第一性原理出发，明确引用 Riesz 映射的定义和求积精确度来证明你的选择。\n\n关于提升算子的实现和求积精确性，以下哪些陈述是正确的？\n\nA. 使用模态 Legendre 基，并在体积和面上进行精确积分，对于所有 $\\lambda \\in \\mathbb{P}_p(\\partial K)$，计算出的提升算子与面泛函的精确 $L^2(K)$ Riesz 表示一致。\n\nB. 使用模态 Legendre 基，但体积积分和面积分都通过 $(p+1)$ 点 LGL 求积进行近似，所得的提升算子与精确提升算子的差异仅在于每个单元中乘以最高阶 Legendre 模态的系数；对于任何多项式面数据 $\\lambda$，所有较低的模态系数都与精确提升算子相匹配。\n\nC. 使用节点 LGL 基，并在体积和面上使用配置的 $(p+1)$ 点 LGL 求积，计算出的提升算子是关于求积诱导内积 $(\\cdot,\\cdot)_Q$ 的精确 Riesz 表示，而不是精确 $L^2(K)$ 内积的表示，并且其相对于精确 $L^2(K)$ 提升算子的差异仅限于体积和面上多项式次数为 $2p$ 的贡献。\n\nD. 为保证离散提升算子对于所有次数至多为 $p$ 的多项式面数据 $\\lambda$ 都与精确 $L^2(K)$ Riesz 映射一致，对体积积分使用 $(p+1)$ 点 LGL 求积就足够了，而任何每个方向上至少有 $(p+1)$ 个点的面求积都是足够的。\n\nE. 如果在体积和每个面上都使用 $(p+1)$ 点 Gauss-Legendre 求积，那么对于所有 $\\lambda \\in \\mathbb{P}_p(\\partial K)$，模态和节点实现都会产生与精确 $L^2(K)$ Riesz 表示相同的提升系数。", "solution": "用户要求对一个关于不连续伽辽金方法中提升算子的问题进行严谨的验证和解答。\n\n### 问题验证\n\n**步骤1：提取已知条件**\n\n*   **定义域**: 单个参考单元 $K$（例如，张量积区间或正方形）。\n*   **多项式空间**: $[\\mathbb{P}_p(K)]^d$，向量值多项式空间，其中每个分量都是总次数至多为 $p$ 的多项式。维度 $d \\in \\{1,2,3\\}$。\n*   **提升算子**: $R_h$ 将面数据 $\\lambda$ 从 $\\partial K$ 映射到向量场 $R_h(\\lambda) \\in [\\mathbb{P}_p(K)]^d$。\n*   **定义方程 (Riesz 映射)**: 对于所有测试函数 $v \\in [\\mathbb{P}_p(K)]^d$，提升算子 $R_h(\\lambda)$ 满足：\n    $$(R_h(\\lambda), v)_{L^2(K)} = \\langle \\lambda, v \\cdot n \\rangle_{L^2(\\partial K)}$$\n    其中 $n$ 是 $\\partial K$ 上的外单位法向量。\n*   **实现方式**:\n    1.  **模态**: 使用 $L^2(K)$-正交的 Legendre 多项式基。\n    2.  **节点**: 使用与 Legendre-Gauss-Lobatto (LGL) 节点相关的节点基，并使用每个维度 $p+1$ 个点的配置 LGL 求积来计算积分。\n*   **求积法则**:\n    1.  区间上的 $N$ 点 Gauss-Legendre (GL) 求积对次数高达 $2N-1$ 的多项式是精确的。\n    2.  区间上的 $(N+1)$ 点 Legendre-Gauss-Lobatto (LGL) 求積对次数高达 $2N-1$ 的多项式是精确的。\n*   **面数据**: 选项指定 $\\lambda \\in \\mathbb{P}_p(\\partial K)$。\n\n**步骤2：使用提取的已知条件进行验证**\n\n*   **科学依据**: 该问题牢固地植根于谱方法和不连续伽辽金 (DG) 方法的理论，这是数值分析中一个标准且完善的领域。将提升算子定义为 Riesz 映射是典范做法。\n*   **适定性**: 该问题要求基于所提供的定义和事实来评估几个陈述。这是一个定义明确的任务，有一组可确定的正确答案。\n*   **客观性**: 该问题以精确、客观的数学语言陈述，没有主观或含糊的术语。\n*   **完备性和一致性**: 该问题提供了分析这些陈述所需的所有必要定义（提升算子、多项式空间、内积）和事实（求积法则）。不存在内部矛盾。\n\n**步骤3：结论和行动**\n\n问题陈述在科学上是合理的、适定的、客观的且自洽的。它是有效的。我现在将进行解答。\n\n### 推导\n\n问题的核心在于理解何时数值计算出的提升算子 $R_{h,Q}(\\lambda)$ 等于精确的提升算子 $R_h(\\lambda)$。精确提升算子是 $[\\mathbb{P}_p(K)]^d$ 中满足定义方程的唯一元素。\n\n设 $\\{\\phi_i\\}_{i=1}^M$ 是 $[\\mathbb{P}_p(K)]^d$ 的一组基。我们可以将提升算子表示为 $R_h(\\lambda) = \\sum_{j=1}^M r_j \\phi_j$。将此代入定义方程并对每个基函数 $\\phi_i$进行测试，可以得到系数 $r = (r_j)$ 的线性系统：\n$$ \\sum_{j=1}^M \\underbrace{(\\phi_j, \\phi_i)_{L^2(K)}}_{M_{ij}} r_j = \\underbrace{\\langle \\lambda, \\phi_i \\cdot n \\rangle_{L^2(\\partial K)}}_{F_i} \\implies Mr = F $$\n其中 $M$ 是质量矩阵，$F$ 是载荷向量。精确解为 $r = M^{-1}F$。\n\n数值实现用求积法则代替精确积分，从而得到计算出的质量矩阵 $M_Q$ 和计算出的载荷向量 $F_Q$。计算出的系数为 $r_Q = M_Q^{-1} F_Q$。计算出的提升算子 $R_{h,Q}(\\lambda)$ 等于精确提升算子 $R_h(\\lambda)$，当且仅当它们的系数相同，即 $r_Q = r$。这种情况发生当且仅当求积对所有涉及的积分都是精确的，即 $M_Q = M$ 且 $F_Q = F$。\n\n我们来确定求积法则所需的精确度。\n1.  **质量矩阵被积函数**: $M$ 的元素是 $\\phi_j \\cdot \\phi_i$ 在 $K$ 上的积分。由于 $\\phi_i, \\phi_j \\in [\\mathbb{P}_p(K)]^d$，它们的点积是总次数至多为 $p$ 的多项式乘积之和。因此，得到的被积函数的总次数至多为 $p+p=2p$。\n2.  **载荷向量被积函数**: $F$ 的元素是 $\\lambda (v \\cdot n)$ 在 $\\partial K$ 上的积分。问题考虑 $\\lambda \\in \\mathbb{P}_p(\\partial K)$。测试函数的分量是 $\\mathbb{P}_p(K)$ 中多项式的迹，因此它们属于 $\\mathbb{P}_p(\\partial K)$。所以每个面上的被积函数的次数至多为 $p+p=2p$。\n\n因此，为保证对于所有 $\\lambda \\in \\mathbb{P}_p(\\partial K)$ 都有 $R_{h,Q}(\\lambda) = R_h(\\lambda)$，用于质量矩阵的体积求积和用于载荷向量的面求积都必须对次数高达 $2p$ 的多项式精确。\n\n我们来分析所提供的求积法则：\n*   **$(p+1)$ 点 GL 求积**: 在“对次数 $2N-1$ 精确”的法则中令 $N=p+1$，得到精确度为 $2(p+1)-1 = 2p+1$。这足以精确积分次数为 $2p$ 的多项式。\n*   **$(p+1)$ 点 LGL 求积**: 在“对次数 $2N-1$ 精确”的法则中令 $N+1=p+1 \\implies N=p$，得到精确度为 $2p-1$。这**不足以**精确积分次数为 $2p$ 的多项式。\n\n### 逐项分析\n\n**A. 使用模态 Legendre 基，并在体积和面上进行精确积分，对于所有 $\\lambda \\in \\mathbb{P}_p(\\partial K)$，计算出的提升算子与面泛函的精确 $L^2(K)$ Riesz 表示一致。**\n\n该陈述假设使用“精确积分”。这意味着计算出的质量矩阵 $M_Q$ 与精确质量矩阵 $M$ 相同，计算出的载荷向量 $F_Q$ 与精确载荷向量 $F$ 相同。根据定义，$Mr=F$ 系统的解给出了精确 $L^2(K)$ Riesz 表示的系数。由于计算使用了精确的矩阵和向量，结果必须是精确的 Riesz 表示。基的选择（模态 Legendre 基）对于这个结论是偶然的；它对任何基都成立。\n\n**结论：正确。**\n\n**B. 使用模态 Legendre 基，但体积积分和面积分都通过 $(p+1)$ 点 LGL 求积进行近似，所得的提升算子与精确提升算子的差异仅在于每个单元中乘以最高阶 Legendre 模态的系数；对于任何多项式面数据 $\\lambda$，所有较低的模態系数都与精确提升算子相匹配。**\n\n我们使用 $(p+1)$ 点 LGL 求积，它对次数 $2p-1$ 是精确的。\n质量矩阵为 $M_{ij} = (\\phi_j, \\phi_i)_{L^2(K)}$。对于模态 Legendre 基，$M$ 是单位矩阵 ($I$)。计算出的质量矩阵 $(M_Q)_{ij}$ 是通过求积得到的。被积函数 $\\phi_j \\cdot \\phi_i$ 的次数为 $\\deg(\\phi_j) + \\deg(\\phi_i)$。如果 $\\deg(\\phi_j) + \\deg(\\phi_i) \\le 2p-1$，则积分是精确的。如果我们将基划分为次数小于 $p$ 的函数（低阶）和次数等于 $p$ 的函数（高阶），计算出的质量矩阵 $M_Q$ 是块对角矩阵，具体为 $\\begin{pmatrix} I  0 \\\\ 0  M_{hh,Q} \\end{pmatrix}$，其中 $M_{hh,Q}$ 是高阶模态的子矩阵，且不等于单位阵。\n载荷向量为 $F_i = \\langle \\lambda, \\phi_i \\cdot n \\rangle_{L^2(\\partial K)}$。被积函数的次数最高为 $\\deg(\\lambda) + \\deg(\\phi_i)$。假设 $\\lambda \\in \\mathbb{P}_p(\\partial K)$，则次数最高为 $p + \\deg(\\phi_i)$。如果 $p + \\deg(\\phi_i) \\le 2p-1$，即 $\\deg(\\phi_i) \\le p-1$，则积分是精确的。因此，低阶模态的载荷向量分量被精确计算 ($F_{l,Q} = F_l$)，但高阶模态的则不是 ($F_{h,Q} \\neq F_h$)。\n计算出的系数 $r_Q$ 求解 $M_Q r_Q = F_Q$。这可以解耦为 $I r_{l,Q} = F_{l,Q}$ 和 $M_{hh,Q} r_{h,Q} = F_{h,Q}$。从第一个方程可知，$r_{l,Q} = F_{l,Q} = F_l$，这是低阶模态的精确系数。高阶系数 $r_{h,Q}$ 与精确系数不同。\n分析证实，误差仅限于次数为 $p$ 的基函数的系数。然而，陈述声称误差“仅在于乘以**那个**最高阶 Legendre 模态的系数”。这种措辞暗示存在唯一的最高阶模态。这只在一维（$d=1$）情况下成立。对于 $d>1$（例如，在正方形上），空间 $\\mathbb{P}_p(K)$ 包含多个最高次数为 $p$ 的基函数（例如，对于 $p=2$，有 $x^2, xy, y^2$）。因此，对于问题设置中描述的一般情况，该陈述在形式上是不正确的。基于这种不精确性，严谨的评估必须拒绝它。\n\n**结论：不正确。**\n\n**C. 使用节点 LGL 基，并在体积和面上使用配置的 $(p+1)$ 点 LGL 求积，计算出的提升算子是关于求積诱导内积 $(\\cdot,\\cdot)_Q$ 的精确 Riesz 表示，而不是精确 $L^2(K)$ 内积的表示，并且其相对于精确 $L^2(K)$ 提升算子的差异仅限于体积和面上多项式次数为 $2p$ 的贡献。**\n\n计算出的提升算子 $R_{h,Q}(\\lambda)$ 是通过求解 $(R_{h,Q}, v)_Q = \\langle \\lambda, v \\cdot n \\rangle_Q$ 对所有 $v \\in [\\mathbb{P}_p(K)]^d$ 得到的。这正是在赋予了离散内积 $(\\cdot,\\cdot)_Q$ 的空间 $[\\mathbb{P}_p(K)]^d$ 中 Riesz 表示的定义。所以陈述的第一部分根据定义是正确的。\n差异的产生是因为 $(\\cdot,\\cdot)_Q \\neq (\\cdot,\\cdot)_{L^2(K)}$ 且 $\\langle\\cdot,\\cdot\\rangle_Q \\neq \\langle\\cdot,\\cdot\\rangle_{L^2(\\partial K)}$。$(p+1)$ 点 LGL 求积对次数高达 $2p-1$ 的多项式是精确的。质量矩阵和载荷向量的被积函数次数可能高达 $2p$。求积误差泛函对于任何次数 $\\le 2p-1$ 的多项式被积函数都为零。求积不精确的第一个次数是 $2p$。因此，计算解与精确解之间的任何差异的来源都源于求积法则未能精确积分次数为 $2p$ 的多项式。陈述中提到差异“仅限于多项式次数为 $2p$ 的贡献”正确地指出了这个来源。\n\n**结论：正确。**\n\n**D. 为保证离散提升算子对于所有次数至多为 $p$ 的多项式面数据 $\\lambda$ 都与精确 $L^2(K)$ Riesz 映射一致，对体积积分使用 $(p+1)$ 点 LGL 求积就足够了，而任何每个方向上至少有 $(p+1)$ 个点的面求积都是足够的。**\n\n为保证计算出的提升算子与精确算子相同，体积求积和面求积都必须对次数高达 $2p$ 的多项式精确。该陈述提议对体积积分使用 $(p+1)$ 点 LGL 求积。如前所述，该法则仅对次数高达 $2p-1$ 的多项式精确。因此，它不足以精确计算质量矩阵，因为某些元素涉及次数为 $2p$ 的多项式积分。仅凭这一点，该陈述就是错误的。\n\n**结论：不正确。**\n\n**E. 如果在体积和每个面上都使用 $(p+1)$ 点 Gauss-Legendre 求积，那么对于所有 $\\lambda \\in \\mathbb{P}_p(\\partial K)$，模态和节点实现都会产生与精确 $L^2(K)$ Riesz 表示相同的提升系数。**\n\n如前推导，确保计算出的提升算子与精确算子相同，需要求积法则对次数高达 $2p$ 的多项式是精确的。$(p+1)$ 点 Gauss-Legendre (GL) 求积法则对次数高达 $2(p+1)-1 = 2p+1$ 的多项式是精确的。由于 $2p+1 \\ge 2p$，该法则足以精确计算质量矩阵和载荷向量的各项。这意味着 $M_Q = M$ 且 $F_Q = F$。因此，计算出的系数 $r_Q = M_Q^{-1}F_Q$ 将与精确系数 $r=M^{-1}F$ 相同。这个结论与基的选择（模态或节点）无关，因为由这些系数表示的底层函数 $R_h(\\lambda)$ 是唯一的。\n\n**结论：正确。**", "answer": "$$\\boxed{ACE}$$", "id": "3396023"}, {"introduction": "最后，我们探讨一个更高级的应用：提升算子在稳定DG方法中的作用。本练习引入了一个修正的或“滤波的”提升算子，并分析其对不同解模式的影响。通过推导高阶多项式 $p$ 的衰减因子，本练习清晰地、定量地阐释了谱滤波的概念——这是稳定项增强数值格式鲁棒性的一个关键机制 [@problem_id:3396046]。", "problem": "考虑一个一维参考单元 $\\xi \\in [-1,1]$，其上的多项式空间为次数至多为 $p$ 的 $\\mathcal{P}_p([-1,1])$。令 $\\{\\phi_k(\\xi)\\}_{k=0}^{p}$ 表示 $[-1,1]$ 上关于标准 $L^2([-1,1])$ 内积的、基于勒让德多项式的标准正交模态基，即 $\\phi_k(\\xi) = \\sqrt{k + \\tfrac{1}{2}}\\,P_k(\\xi)$，其中 $P_k$ 是第 $k$ 阶勒让德多项式。间断 Galerkin (DG, Discontinuous Galerkin) 提升算子 $\\mathcal{L}_p$ 将支撑在右端点 $\\xi=+1$ 的标量界面跳跃 $j \\in \\mathbb{R}$ 映射为一个内部多项式 $r \\in \\mathcal{P}_p([-1,1])$，该多项式由 Riesz 表示定义为\n$$\n\\int_{-1}^{1} r(\\xi)\\,v(\\xi)\\,d\\xi \\;=\\; j\\,v(1) \\quad \\text{对所有 } v \\in \\mathcal{P}_p([-1,1]) \\text{ 成立}。\n$$\n为对尺寸为 $h>0$ 的物理单元上由稳定化引起的谱滤波进行建模，考虑滤波后的提升 $r_{\\mu} \\in \\mathcal{P}_p([-1,1])$ 作为以下方程的唯一解\n$$\n\\int_{-1}^{1} r_{\\mu}(\\xi)\\,v(\\xi)\\,d\\xi \\;+\\; \\mu\\,\\frac{2}{h}\\,\\int_{-1}^{1} \\frac{d r_{\\mu}}{d\\xi}(\\xi)\\,\\frac{d v}{d\\xi}(\\xi)\\,d\\xi \\;=\\; j\\,v(1) \\quad \\text{对所有 } v \\in \\mathcal{P}_p([-1,1]) \\text{ 成立}，\n$$\n其中 $\\mu>0$ 是一个量纲一致的稳定化参数。使用模态展开 $r_{\\mu}(\\xi) = \\sum_{k=0}^{p} c_k\\,\\phi_k(\\xi)$，将滤波后提升相对于未滤波提升的各模态衰减因子 $A_k$ 定义为滤波后模态振幅与未滤波模态振幅之比。假设在高 $p$ 渐近状态下，刚度贡献由模态对角线主导，并使用经过充分检验的勒让德恒等式 $P_k(1)=1$ 和 $\\int_{-1}^{1} \\big(P_k'(\\xi)\\big)^2\\,d\\xi = k(k+1)$，以获得最高阶模态 $k=p$ 的衰减因子 $A_p$ 的渐近闭式表达式。\n\n从上述定义出发，根据第一性原理推导此表达式，将其渐近 $p$ 标度关系与所引起的谱滤波行为联系起来，并将最终答案以 $A_p$ 关于 $p$、$\\mu$ 和 $h$ 的单个闭式解析表达式的形式给出。最终答案中不要包含中间公式。不需要进行数值近似。", "solution": "首先对问题陈述进行严格的验证程序。\n\n### 步骤1：提取已知条件\n- **定义域和多项式空间**：一个一维参考单元 $\\xi \\in [-1,1]$，其上的多项式空间为次数至多为 $p$ 的 $\\mathcal{P}_p([-1,1])$。\n- **基**：$[-1,1]$ 上关于 $L^2([-1,1])$ 内积的标准正交模态基 $\\{\\phi_k(\\xi)\\}_{k=0}^{p}$，其中 $\\phi_k(\\xi) = \\sqrt{k + \\tfrac{1}{2}}\\,P_k(\\xi)$ 且 $P_k$ 为第 $k$ 阶勒让德多项式。标准正交性意味着 $\\int_{-1}^{1} \\phi_j(\\xi)\\,\\phi_k(\\xi)\\,d\\xi = \\delta_{jk}$。\n- **未滤波的提升算子**：$\\mathcal{L}_p$ 将 $\\xi=+1$ 处的标量跳跃 $j \\in \\mathbb{R}$ 映射到一个多项式 $r \\in \\mathcal{P}_p([-1,1])$，该多项式满足以下变分问题：\n$$ \\int_{-1}^{1} r(\\xi)\\,v(\\xi)\\,d\\xi \\;=\\; j\\,v(1) \\quad \\text{对所有 } v \\in \\mathcal{P}_p([-1,1]) \\text{ 成立} $$\n- **滤波后的提升**：一个多项式 $r_{\\mu} \\in \\mathcal{P}_p([-1,1])$ 是以下稳定化变分问题的解：\n$$ \\int_{-1}^{1} r_{\\mu}(\\xi)\\,v(\\xi)\\,d\\xi \\;+\\; \\mu\\,\\frac{2}{h}\\,\\int_{-1}^{1} \\frac{d r_{\\mu}}{d\\xi}(\\xi)\\,\\frac{d v}{d\\xi}(\\xi)\\,d\\xi \\;=\\; j\\,v(1) \\quad \\text{对所有 } v \\in \\mathcal{P}_p([-1,1]) \\text{ 成立} $$\n- **参数**：稳定化参数 $\\mu > 0$；物理单元尺寸 $h > 0$。\n- **模态展开**：解表示为 $r_{\\mu}(\\xi) = \\sum_{k=0}^{p} c_k\\,\\phi_k(\\xi)$。\n- **定义**：各模态衰减因子 $A_k$ 是滤波后模态振幅与未滤波模态振幅之比。\n- **假设与恒等式**：\n    1.  高 $p$ 渐近状态，其中刚度贡献由模态对角线主导。\n    2.  $P_k(1)=1$。\n    3.  $\\int_{-1}^{1} \\big(P_k'(\\xi)\\big)^2\\,d\\xi = k(k+1)$。\n- **目标**：推导最高阶模态 $k=p$ 的衰减因子 $A_p$ 关于 $p$、$\\mu$ 和 $h$ 的闭式表达式。\n\n### 步骤2：使用提取的已知条件进行验证\n1.  **科学依据**：该问题是在间断 Galerkin (DG) 方法的成熟数学理论框架内提出的，这是一种广泛用于求解偏微分方程的数值技术。提升算子、稳定化项以及使用勒让德多项式的谱（模态）表示等概念在该领域是标准的。所有给出的恒等式都是勒让德多项式的正确性质。该设定在科学和数学上都是合理的。\n2.  **适定性**：未滤波和滤波后提升的定义都是变分问题。其双线性形式是有限维空间 $\\mathcal{P}_p([-1,1])$ 上的内积，而右侧项是连续线性泛函。根据 Riesz 表示定理（或 Lax-Milgram 定理），存在唯一解 $r$ 和 $r_\\mu$。该问题是适定的。\n3.  **客观性**：问题以精确、形式化的数学语言陈述，不含任何主观或模糊的术语。\n4.  **不完整或矛盾的设定**：该问题是自洽的。它提供了推导闭式解所需的所有必要定义、关系以及对角占优的明确假设。不存在任何矛盾。\n5.  **不切实际或不可行**：这是一个数值分析领域的理论问题。其中的参数和函数是抽象的数学对象。在此背景下，该设定是完全可行的。\n6.  **不适定或结构不良**：该问题结构清晰，引导求解者朝向一个特定目标。使用渐近假设是理论分析中的一种标准技术，它不会使问题变得不适定，反而使解析解变得易于处理。\n7.  **伪深刻、琐碎或同义反复**：推导过程需要多步应用泛函分析和正交多项式理论的原理。关于对角占优的简化是一个关键的建模步骤，用以分离出主要的谱效应，而这正是概念性挑战的核心所在。该问题并非无足轻重。\n8.  **超出科学可验证性范围**：该推导是一个数学证明，完全可以验证。\n\n### 步骤3：结论与行动\n该问题是**有效的**。将从第一性原理推导解答。\n\n### 解的推导\n\n目标是求出衰减因子 $A_p$，其定义为滤波后提升的最高阶模态系数 $c_p$ 与未滤波提升的相应系数（我们称之为 $b_p$）之比。我们将推导这些系数的表达式。\n\n**1. 未滤波提升的模态系数**\n将未滤波的提升多项式在标准正交基中展开：$r(\\xi) = \\sum_{k=0}^{p} b_k \\phi_k(\\xi)$。将此式代入其定义的变分方程：\n$$ \\int_{-1}^{1} \\left( \\sum_{k=0}^{p} b_k \\phi_k(\\xi) \\right) v(\\xi) \\,d\\xi = j v(1) $$\n为了求出系数 $b_m$，我们选择测试函数 $v(\\xi) = \\phi_m(\\xi)$，其中 $m \\in \\{0, 1, \\dots, p\\}$。方程变为：\n$$ \\sum_{k=0}^{p} b_k \\int_{-1}^{1} \\phi_k(\\xi) \\phi_m(\\xi) \\,d\\xi = j \\phi_m(1) $$\n根据基的标准正交性，$\\int_{-1}^{1} \\phi_k(\\xi) \\phi_m(\\xi) \\,d\\xi = \\delta_{km}$，其中 $\\delta_{km}$ 是克罗内克 delta。左边的求和简化为 $b_m$。因此，模态系数 $b_m$ 为：\n$$ b_m = j \\phi_m(1) $$\n使用给定的定义，$\\phi_m(1) = \\sqrt{m + \\frac{1}{2}} P_m(1)$。由于 $P_m(1) = 1$，我们有：\n$$ b_m = j \\sqrt{m + \\frac{1}{2}} $$\n\n**2. 滤波后提升的模态系数**\n设滤波后的提升多项式为 $r_\\mu(\\xi) = \\sum_{k=0}^{p} c_k \\phi_k(\\xi)$。将此展开式代入其定义的变分方程：\n$$ \\int_{-1}^{1} \\left(\\sum_{k=0}^{p} c_k \\phi_k\\right) v \\,d\\xi + \\mu \\frac{2}{h} \\int_{-1}^{1} \\left(\\sum_{k=0}^{p} c_k \\frac{d\\phi_k}{d\\xi}\\right) \\frac{dv}{d\\xi} \\,d\\xi = j v(1) $$\n再次，我们用 $v(\\xi) = \\phi_m(\\xi)$ 进行测试：\n$$ \\sum_{k=0}^{p} c_k \\int_{-1}^{1} \\phi_k \\phi_m \\,d\\xi + \\mu \\frac{2}{h} \\sum_{k=0}^{p} c_k \\int_{-1}^{1} \\frac{d\\phi_k}{d\\xi} \\frac{d\\phi_m}{d\\xi} \\,d\\xi = j \\phi_m(1) $$\n令 $M_{mk} = \\int_{-1}^{1} \\phi_k \\phi_m \\,d\\xi$ 为质量矩阵的元素，$S_{mk} = \\int_{-1}^{1} \\frac{d\\phi_k}{d\\xi} \\frac{d\\phi_m}{d\\xi} \\,d\\xi$ 为刚度矩阵的元素。由于标准正交性，$M_{mk} = \\delta_{mk}$。系数 $\\mathbf{c} = (c_0, \\dots, c_p)^T$ 的方程组为：\n$$ \\sum_{k=0}^{p} (\\delta_{mk} + \\mu \\frac{2}{h} S_{mk}) c_k = j \\phi_m(1) $$\n这是一个线性系统 $(I + \\mu \\frac{2}{h} S) \\mathbf{c} = \\mathbf{f}$，其中 $I$ 是单位矩阵，右端向量的分量为 $f_m = j \\phi_m(1) = b_m$。\n\n**3. 渐近假设的应用**\n问题陈述指出，对于高 $p$ 值，刚度矩阵由其对角线主导，即 $S_{mk} \\approx S_{mm} \\delta_{mk}$。在此假设下，该线性系统解耦为一组标量方程：\n$$ (\\delta_{mm} + \\mu \\frac{2}{h} S_{mm}) c_m \\approx j \\phi_m(1) $$\n$$ (1 + \\mu \\frac{2}{h} S_{mm}) c_m \\approx j \\phi_m(1) $$\n求解滤波后的系数 $c_m$：\n$$ c_m \\approx \\frac{j \\phi_m(1)}{1 + \\mu \\frac{2}{h} S_{mm}} $$\n\n**4. 衰减因子的计算**\n衰减因子 $A_k$ 是比值 $c_k/b_k$。使用我们得到的 $b_k$ 和 $c_k$ 的表达式：\n$$ A_k = \\frac{c_k}{b_k} \\approx \\frac{j \\phi_k(1) / (1 + \\mu \\frac{2}{h} S_{kk})}{j \\phi_k(1)} = \\frac{1}{1 + \\mu \\frac{2}{h} S_{kk}} $$\n为求得最终形式，我们必须计算对角刚度项 $S_{kk}$。\n$$ S_{kk} = \\int_{-1}^{1} \\left( \\frac{d\\phi_k}{d\\xi}(\\xi) \\right)^2 d\\xi $$\n使用 $\\phi_k(\\xi) = \\sqrt{k + \\frac{1}{2}} P_k(\\xi)$，其导数为 $\\frac{d\\phi_k}{d\\xi} = \\sqrt{k + \\frac{1}{2}} P_k'(\\xi)$。\n$$ S_{kk} = \\int_{-1}^{1} \\left( \\sqrt{k + \\frac{1}{2}} P_k'(\\xi) \\right)^2 d\\xi = \\left(k + \\frac{1}{2}\\right) \\int_{-1}^{1} (P_k'(\\xi))^2 d\\xi $$\n使用给定的恒等式 $\\int_{-1}^{1} (P_k'(\\xi))^2 d\\xi = k(k+1)$：\n$$ S_{kk} = \\left(k + \\frac{1}{2}\\right) k(k+1) $$\n将 $S_{kk}$ 的这个表达式代入 $A_k$ 的公式中：\n$$ A_k \\approx \\frac{1}{1 + \\mu \\frac{2}{h} \\left(k + \\frac{1}{2}\\right) k(k+1)} $$\n\n**5. $A_p$ 的最终表达式及解释**\n我们需要最高阶模态 $k=p$ 的衰减因子：\n$$ A_p \\approx \\frac{1}{1 + \\mu \\frac{2}{h} \\left(p + \\frac{1}{2}\\right) p(p+1)} $$\n该表达式可以被简化。注意到 $k + \\frac{1}{2} = \\frac{2k+1}{2}$。对于 $k=p$：\n$$ \\mu \\frac{2}{h} \\left(p + \\frac{1}{2}\\right) p(p+1) = \\mu \\frac{2}{h} \\frac{2p+1}{2} p(p+1) = \\frac{\\mu}{h} p(p+1)(2p+1) $$\n因此，$A_p$ 的最终表达式为：\n$$ A_p = \\frac{1}{1 + \\frac{\\mu}{h} p(p+1)(2p+1)} $$\n项 $p(p+1)(2p+1)$ 在 $p$ 很大时渐近标度为 $2p^3$。因此，$A_p \\approx \\frac{h}{2\\mu p^3}$。这个 $O(p^{-3})$ 的标度关系表明，对于高阶模态，衰减因子变得非常小。这种行为是谱滤波的典型特征：包含导数的稳定化项会惩罚解的振荡（高频）分量，从而有效地阻尼提升跳跃的高阶模态。这通过滤除 DG 方法中可能出现的潜在高频不稳定性来增强数值稳定性。", "answer": "$$ \\boxed{\\frac{1}{1 + \\frac{\\mu}{h} p(p+1)(2p+1)}} $$", "id": "3396046"}]}