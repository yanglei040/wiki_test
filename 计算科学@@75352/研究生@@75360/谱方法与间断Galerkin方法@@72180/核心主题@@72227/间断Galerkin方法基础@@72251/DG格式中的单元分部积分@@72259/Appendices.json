{"hands_on_practices": [{"introduction": "动手实践的第一步是掌握离散化过程的核心机制。通过为一维线性平流方程手动构建质量矩阵和刚度矩阵，您将具体理解弱形式、分部积分和数值通量如何协同作用，形成最终的离散系统。这个练习是理解和实现任何间断 Galerkin 方法的基础。[@problem_id:3382909]", "problem": "考虑区间 $[0,1]$ 上的一维线性平流初值问题，\n$$u_{t} + a\\,u_{x} = 0,$$\n其中平流速度 $a>0$ 为常数，且在 $x=0$ 处的流入边界数据设置为零。使用单个谱元 $K=[0,1]$，从参考坐标 $\\xi\\in[-1,1]$ 到物理坐标 $x$ 的仿射映射为 $x(\\xi) = \\frac{1}{2}(1+\\xi)$，因此 $h=1$ 且 $dx = \\frac{1}{2}\\,d\\xi$。采用间断 Galerkin (DG) 方法，参考单元上的正交模态基底如下：\n$$\\phi_{0}(\\xi) = \\frac{1}{\\sqrt{2}},\\qquad \\phi_{1}(\\xi) = \\sqrt{\\frac{3}{2}}\\,\\xi.$$\n设离散解为 $u_{h}(x(\\xi),t) = c_{0}(t)\\,\\phi_{0}(\\xi) + c_{1}(t)\\,\\phi_{1}(\\xi)$，并选择由单元面上 $a \\cdot n$ 的符号决定的迎风数值通量 $\\widehat{u}$。在一维情况下，外单位法向量在 $\\xi=-1$ 处为 $n=-1$，在 $\\xi=+1$ 处为 $n=+1$，因此在左侧面上 $a \\cdot n  0$，在右侧面上 $a \\cdot n > 0$。在 $x=0$（左侧面）处施加流入边界数据 $u_{\\text{in}}=0$，因此该处的通量为 $\\widehat{u}=u_{\\text{in}}=0$。在 $x=1$（右侧面）处取 $\\widehat{u}=u^{-}$，其中 $u^{-}$ 表示内部迹。\n\n从单元上的弱形式出发，在 $K$ 上进行分部积分，推导与双线性形式相关的单元级质量矩阵项 $M_{ij}$ 和平流（刚度）矩阵项 $A_{ij}$\n$$M_{ij} = \\int_{K} \\phi_{i}\\,\\phi_{j}\\,dx,\\qquad\nA_{ij} = -\\int_{K} a\\,\\partial_{x}\\phi_{i}\\,\\phi_{j}\\,dx + \\sum_{f\\subset\\partial K} \\int_{f} a\\,n\\,\\widehat{u}\\,\\phi_{i}\\,ds,$$\n其中 $i,j\\in\\{0,1\\}$，$ds$ 是面上的测度。将最终答案表示为单个行矩阵，包含按以下顺序排列的八个条目：\n$$(M_{00},\\,M_{01},\\,M_{10},\\,M_{11},\\,A_{00},\\,A_{01},\\,A_{10},\\,A_{11}).$$\n无需四舍五入。请以包含 $a$ 的精确代数表达式形式提供答案。", "solution": "用户希望为单个单元上的一维线性平流问题的间断 Galerkin (DG) 离散化求出质量矩阵和刚度矩阵的项。\n\n### 第 1 步：问题验证\n\n**1.1. 提取已知条件**\n-   **偏微分方程(PDE):** $u_{t} + a\\,u_{x} = 0$，在区间 $[0,1]$ 上。\n-   **平流速度:** $a  0$，常数。\n-   **边界条件:** 在 $x=0$ 处的流入边界数据 $u_{\\text{in}} = 0$。\n-   **单元:** 单个谱元 $K=[0,1]$，因此单元尺寸 $h=1$。\n-   **映射:** 从参考坐标 $\\xi \\in [-1,1]$ 到物理坐标 $x \\in [0,1]$ 的仿射映射为 $x(\\xi) = \\frac{1}{2}(1+\\xi)$。\n-   **雅可比:** 微分变换为 $dx = \\frac{1}{2}d\\xi$。导数变换为 $\\partial_x = (\\frac{d\\xi}{dx})\\partial_\\xi = 2\\partial_\\xi$。\n-   **基函数:** 参考单元上的正交模态基底：\n    -   $\\phi_{0}(\\xi) = \\frac{1}{\\sqrt{2}}$\n    -   $\\phi_{1}(\\xi) = \\sqrt{\\frac{3}{2}}\\,\\xi$\n-   **离散解:** $u_{h}(x(\\xi),t) = c_{0}(t)\\,\\phi_{0}(\\xi) + c_{1}(t)\\,\\phi_{1}(\\xi)$。\n-   **数值通量:** 迎风通量 $\\widehat{u}$。\n    -   在左侧面 ($x=0, \\xi=-1$)，外法向量为 $n=-1$。由于 $a0$，因此 $a \\cdot n  0$（流入）。通量为 $\\widehat{u} = u_{\\text{in}} = 0$。\n    -   在右侧面 ($x=1, \\xi=1$)，外法向量为 $n=+1$。由于 $a0$，因此 $a \\cdot n  0$（流出）。通量为 $\\widehat{u} = u^{-}$，其中 $u^{-}$ 是解的内部迹。\n-   **矩阵定义:**\n    -   质量矩阵: $M_{ij} = \\int_{K} \\phi_{i}\\,\\phi_{j}\\,dx$，其中 $i,j \\in \\{0,1\\}$。\n    -   平流矩阵: $A_{ij} = -\\int_{K} a\\,\\partial_{x}\\phi_{i}\\,\\phi_{j}\\,dx + \\sum_{f\\subset\\partial K} \\int_{f} a\\,n\\,\\widehat{u}\\,\\phi_{i}\\,ds$，其中 $i,j \\in \\{0,1\\}$。\n\n**1.2. 验证**\n该问题具有科学依据，是适定的、客观的且自洽的。它描述了 DG 方法领域的一个标准过程。定义和数据是一致的，足以执行所需的计算。该问题被判定为**有效**。\n\n### 第 2 步：矩阵项的计算\n\n**2.1. 质量矩阵 $M_{ij}$**\n\n质量矩阵项由 $M_{ij} = \\int_{K} \\phi_{i}\\,\\phi_{j}\\,dx$ 定义。我们使用 $dx = \\frac{1}{2}d\\xi$ 将积分从物理单元 $K=[0,1]$ 变换到参考单元 $\\xi \\in [-1,1]$。\n$$M_{ij} = \\int_{-1}^{1} \\phi_{i}(\\xi)\\,\\phi_{j}(\\xi)\\,\\frac{1}{2}\\,d\\xi = \\frac{1}{2} \\int_{-1}^{1} \\phi_{i}(\\xi)\\,\\phi_{j}(\\xi)\\,d\\xi$$\n基函数 $\\{\\phi_0, \\phi_1\\}$ 在参考单元上是标准正交的，这意味着 $\\int_{-1}^{1} \\phi_{i}(\\xi)\\phi_{j}(\\xi)d\\xi = \\delta_{ij}$（克罗内克 δ）。\n因此，$M_{ij} = \\frac{1}{2}\\delta_{ij}$。\n\n具体各项为：\n-   $M_{00} = \\frac{1}{2}(1) = \\frac{1}{2}$\n-   $M_{01} = \\frac{1}{2}(0) = 0$\n-   $M_{10} = \\frac{1}{2}(0) = 0$\n-   $M_{11} = \\frac{1}{2}(1) = \\frac{1}{2}$\n\n**2.2. 平流（刚度）矩阵 $A_{ij}$**\n\n平流矩阵项由以下公式给出：\n$$A_{ij} = -\\int_{K} a\\,\\partial_{x}\\phi_{i}\\,\\phi_{j}\\,dx + \\sum_{f\\subset\\partial K} \\int_{f} a\\,n\\,\\widehat{u}\\,\\phi_{i}\\,ds$$\n该表达式由一个体积分部分和一个边界通量部分组成。\n\n**体积分部分：** 让我们将这部分表示为 $V_{ij}$。\n$$V_{ij} = -\\int_{K} a\\,\\partial_{x}\\phi_{i}\\,\\phi_{j}\\,dx$$\n我们使用 $\\partial_x = 2\\partial_\\xi$ 和 $dx = \\frac{1}{2}d\\xi$ 变换到参考单元：\n$$V_{ij} = -\\int_{-1}^{1} a\\,(2\\partial_{\\xi}\\phi_{i})\\,\\phi_{j}\\,\\frac{1}{2}\\,d\\xi = -a\\int_{-1}^{1} (\\partial_{\\xi}\\phi_{i})\\,\\phi_{j}\\,d\\xi$$\n首先，我们求基函数相对于 $\\xi$ 的导数：\n-   $\\partial_{\\xi}\\phi_{0}(\\xi) = \\partial_{\\xi}(\\frac{1}{\\sqrt{2}}) = 0$\n-   $\\partial_{\\xi}\\phi_{1}(\\xi) = \\partial_{\\xi}(\\sqrt{\\frac{3}{2}}\\xi) = \\sqrt{\\frac{3}{2}}$\n\n现在我们计算各项 $V_{ij}$：\n-   $V_{00} = -a\\int_{-1}^{1} (0)\\,\\phi_{0}\\,d\\xi = 0$\n-   $V_{01} = -a\\int_{-1}^{1} (0)\\,\\phi_{1}\\,d\\xi = 0$\n-   $V_{10} = -a\\int_{-1}^{1} (\\partial_{\\xi}\\phi_{1})\\,\\phi_{0}\\,d\\xi = -a\\int_{-1}^{1} \\sqrt{\\frac{3}{2}}\\,\\frac{1}{\\sqrt{2}}\\,d\\xi = -a\\frac{\\sqrt{3}}{2}\\int_{-1}^{1}d\\xi = -a\\frac{\\sqrt{3}}{2}(2) = -a\\sqrt{3}$\n-   $V_{11} = -a\\int_{-1}^{1} (\\partial_{\\xi}\\phi_{1})\\,\\phi_{1}\\,d\\xi = -a\\int_{-1}^{1} \\sqrt{\\frac{3}{2}}\\,\\sqrt{\\frac{3}{2}}\\xi\\,d\\xi = -a\\frac{3}{2}\\int_{-1}^{1}\\xi\\,d\\xi = -a\\frac{3}{2}\\left[\\frac{\\xi^2}{2}\\right]_{-1}^{1} = 0$\n\n**边界通量部分：** 让我们将这部分对矩阵的贡献表示为 $B_{ij}$。该项为 $\\sum_{f\\subset\\partial K} \\int_{f} a\\,n\\,\\widehat{u}\\,\\phi_{i}\\,ds$。尽管 $\\widehat{u}$ 依赖于完整解 $u_h = \\sum_j c_j \\phi_j$，但我们可以通过观察该项如何依赖于每个系数 $c_j$ 来推导出矩阵项 $B_{ij}$。单元 $K=[0,1]$ 的边界由两个面组成：$x=0$ 和 $x=1$。积分变成了在这些点上的求和。\n$$\\sum_{f\\subset\\partial K} \\int_{f} a\\,n\\,\\widehat{u}\\,\\phi_{i}\\,ds = [a\\,n\\,\\widehat{u}\\,\\phi_{i}]_{x=1} + [a\\,n\\,\\widehat{u}\\,\\phi_{i}]_{x=0}$$\n-   在左侧面 ($x=0$, $\\xi=-1$)：$n=-1$，通量为 $\\widehat{u}=u_{\\text{in}}=0$。贡献为 $0$。\n-   在右侧面 ($x=1$, $\\xi=1$)：$n=+1$，通量为 $\\widehat{u}=u^{-} = u_h(1,t)$。贡献为 $a(1)u_h(1,t)\\phi_i(1) = a\\,u_h(1,t)\\phi_i(1)$。\n\n第 $i$ 个方程的总边界项为 $a\\,u_h(1,t)\\phi_i(1)$。代入 $u_h(1,t) = \\sum_j c_j(t)\\phi_j(1)$：\n$$a\\left(\\sum_{j} c_j(t)\\phi_j(1)\\right)\\phi_i(1) = \\sum_{j} c_j(t) [a\\,\\phi_i(1)\\phi_j(1)]$$\n由此，我们确定矩阵贡献为 $B_{ij} = a\\,\\phi_i(1)\\phi_j(1)$。\n我们需要基函数在 $\\xi=1$ 处的值：\n-   $\\phi_0(1) = \\frac{1}{\\sqrt{2}}$\n-   $\\phi_1(1) = \\sqrt{\\frac{3}{2}}$\n\n现在我们计算各项 $B_{ij}$：\n-   $B_{00} = a\\,\\phi_0(1)\\phi_0(1) = a(\\frac{1}{\\sqrt{2}})(\\frac{1}{\\sqrt{2}}) = \\frac{a}{2}$\n-   $B_{01} = a\\,\\phi_0(1)\\phi_1(1) = a(\\frac{1}{\\sqrt{2}})(\\sqrt{\\frac{3}{2}}) = \\frac{a\\sqrt{3}}{2}$\n-   $B_{10} = a\\,\\phi_1(1)\\phi_0(1) = a(\\sqrt{\\frac{3}{2}})(\\frac{1}{\\sqrt{2}}) = \\frac{a\\sqrt{3}}{2}$\n-   $B_{11} = a\\,\\phi_1(1)\\phi_1(1) = a(\\sqrt{\\frac{3}{2}})(\\sqrt{\\frac{3}{2}}) = \\frac{3a}{2}$\n\n**总平流矩阵：** $A_{ij} = V_{ij} + B_{ij}$。\n-   $A_{00} = V_{00} + B_{00} = 0 + \\frac{a}{2} = \\frac{a}{2}$\n-   $A_{01} = V_{01} + B_{01} = 0 + \\frac{a\\sqrt{3}}{2} = \\frac{\\sqrt{3}}{2}a$\n-   $A_{10} = V_{10} + B_{10} = -a\\sqrt{3} + \\frac{a\\sqrt{3}}{2} = -\\frac{a\\sqrt{3}}{2} = -\\frac{\\sqrt{3}}{2}a$\n-   $A_{11} = V_{11} + B_{11} = 0 + \\frac{3a}{2} = \\frac{3}{2}a$\n\n### 第 3 步：最终答案组合\n\n问题要求最终答案为一个单行矩阵，包含按 $(M_{00},\\,M_{01},\\,M_{10},\\,M_{11},\\,A_{00},\\,A_{01},\\,A_{10},\\,A_{11})$ 顺序排列的八个项。\n计算出的值为：\n-   $M_{00} = \\frac{1}{2}$\n-   $M_{01} = 0$\n-   $M_{10} = 0$\n-   $M_{11} = \\frac{1}{2}$\n-   $A_{00} = \\frac{a}{2}$\n-   $A_{01} = \\frac{\\sqrt{3}}{2}a$\n-   $A_{10} = -\\frac{\\sqrt{3}}{2}a$\n-   $A_{11} = \\frac{3}{2}a$\n将这些值组合成最终的行矩阵即可得到解。", "answer": "$$ \\boxed{ \\begin{pmatrix} \\frac{1}{2}  0  0  \\frac{1}{2}  \\frac{a}{2}  \\frac{\\sqrt{3}}{2}a  -\\frac{\\sqrt{3}}{2}a  \\frac{3}{2}a \\end{pmatrix} } $$", "id": "3382909"}, {"introduction": "在实践中，我们通常使用数值求积来计算积分，其精度至关重要。本练习通过一个假设场景，揭示了一个关键原则：使用精度不足的求积法则会破坏该格式的基本性质，例如局部守恒性。通过量化这种不精确性导致的守恒误差，您将更深刻地理解积分精度与模拟物理保真度之间的紧密联系。[@problem_id:3382930]", "problem": "考虑单个参考单元 $\\widehat{K}=[-1,1]$ 上的一维标量守恒律，\n$$\nu_{t} + \\partial_{x} f(u) = 0,\n$$\n其中 $f$ 为光滑通量。在间断伽辽金 (DG) 格式中，弱形式和强形式通过单元上的分部积分相联系。对于光滑函数 $g$ 和检验函数 $\\varphi$，在使用精确积分时，以下恒等式成立：\n$$\n\\int_{-1}^{1} \\varphi'(x)\\, g(x)\\, dx + \\int_{-1}^{1} \\varphi(x)\\, g'(x)\\, dx = \\left[\\varphi(x)\\, g(x)\\right]_{x=-1}^{x=1}\n$$\n该恒等式是局部守恒的基础：选择 $\\varphi(x)=1$ 可得，$u$ 的单元平均值的时间变化率等于穿过单元边界的净通量。\n\n现在，将精确积分替换为一个阶为 $q$（对最高为 $q$ 次的多项式精确）的求积法则，记作线性泛函 $Q[\\cdot]$。定义离散分部积分残差\n$$\n\\mathcal{E}(\\varphi,g) \\equiv Q\\!\\left[\\varphi'(x)\\, g(x)\\right] + Q\\!\\left[\\varphi(x)\\, g'(x)\\right] - \\left[\\varphi(x)\\, g(x)\\right]_{x=-1}^{x=1}.\n$$\n当 $\\mathcal{E}(\\varphi,g)\\neq 0$ 时，离散分部积分失效，并且在所选的求积法则下，强形式和弱形式的 DG 格式在代数上不再等价。\n\n为了具体地量化在积分不足（欠积分）情况下单个单元上局部守恒的损失，请按以下步骤进行。\n\n1. 设 $f(u)=u$（线性平流），因此 $g(x)=u(x)$ 且 $g'(x)=u_{x}(x)$。\n2. 使用强形式体积项 $Q\\!\\left[\\varphi(x)\\, u_{x}(x)\\right]$ 和一个与物理通量相等的一致边界数值通量，因此对于任何满足 $\\varphi(1)=\\varphi(-1)=1$ 的 $\\varphi$，边界贡献为 $\\left[u(x)\\right]_{x=-1}^{x=1}$。\n3. 取 $\\varphi(x)=1$ 并选择一个多项式试探解 $u(x)=x^{5}$，它属于一个次数为 $p=6$ 的 DG 多项式空间（因此下述求积选择满足 $q  2p-1$）。\n4. 使用 $[-1,1]$ 上的三点辛普森求积法则，其定义为 $Q[h] = \\frac{1}{3}(h(-1) + 4h(0) + h(1))$，其精确阶为 $q=3$。\n\n基于以上假设，计算由 $Q[u_{x}] - [u(1)-u(-1)]$ 给出的标量守恒缺陷 $\\mathcal{C}$。你的最终答案应该是一个精确的分数。", "solution": "我们从单元 $\\widehat{K}=[-1,1]$ 上的基本分部积分恒等式开始：\n$$\n\\int_{-1}^{1} \\varphi'(x)\\, g(x)\\, dx + \\int_{-1}^{1} \\varphi(x)\\, g'(x)\\, dx \\;=\\; \\left[\\varphi(x)\\, g(x)\\right]_{x=-1}^{x=1}.\n$$\n在间断伽辽金设置中，当积分被精确计算时，此恒等式确保了弱形式和强形式的等价性。当一个求积法则 $Q[\\cdot]$ 替换每个积分时，其离散对应形式为\n$$\nQ\\!\\left[\\varphi'(x)\\, g(x)\\right] + Q\\!\\left[\\varphi(x)\\, g'(x)\\right] \\;\\stackrel{?}{=}\\; \\left[\\varphi(x)\\, g(x)\\right]_{x=-1}^{x=1}.\n$$\n通常，只要该求积法则对所涉及的多项式被积函数是精确的，等式就成立。否则，一个残差\n$$\n\\mathcal{E}(\\varphi,g) \\equiv Q\\!\\left[\\varphi'(x)\\, g(x)\\right] + Q\\!\\left[\\varphi(x)\\, g'(x)\\right] - \\left[\\varphi(x)\\, g(x)\\right]_{x=-1}^{x=1}\n$$\n用来衡量离散分部积分的失效程度。\n\n通过取 $\\varphi(x)=1$ 可以得到单元的局部守恒。对于使用精确积分的连续问题，我们有\n$$\n\\int_{-1}^{1} 1 \\cdot g'(x)\\, dx = \\left[g(x)\\right]_{x=-1}^{x=1}.\n$$\n在使用求积法则时，强形式体积项变为 $Q[g'(x)]$，产生离散守恒平衡关系\n$$\nQ[g'(x)] \\;\\stackrel{?}{=}\\; \\left[g(x)\\right]_{x=-1}^{x=1}.\n$$\n因此，标量守恒缺陷为\n$$\n\\mathcal{C} \\equiv Q[g'(x)] - \\left[g(x)\\right]_{x=-1}^{x=1}.\n$$\n\n对于指定的数据，我们设 $f(u)=u$，因此 $g(x)=u(x)$ 且 $g'(x)=u_{x}(x)$。我们选择 $\\varphi(x)=1$，多项式次数为 $p=6$，以及 $u(x)=x^{5}$，它位于近似空间 $\\mathbb{P}_{6}$ 中。求积法则是 $[-1,1]$ 上的辛普森法则，\n$$\nQ[h] = \\frac{1}{3}\\,\\big(h(-1) + 4\\,h(0) + h(1)\\big),\n$$\n其精确阶为 $q=3$，严格小于 $p$。\n\n现在我们计算 $\\mathcal{C}$：\n1. 计算 $u_{x}(x)$:\n$$\nu(x) = x^{5} \\quad\\Rightarrow\\quad u_{x}(x) = 5 x^{4}.\n$$\n2. 计算 $u_{x}$ 的求积：\n$$\nQ[u_{x}] = \\frac{1}{3}\\,\\big(u_{x}(-1) + 4\\,u_{x}(0) + u_{x}(1)\\big) = \\frac{1}{3}\\,\\big(5(-1)^{4} + 4\\cdot 5\\, 0^{4} + 5(1)^{4}\\big) = \\frac{1}{3}\\,(5 + 0 + 5) = \\frac{10}{3}.\n$$\n3. 计算 $u$ 的边界差值：\n$$\nu(1) - u(-1) = 1^{5} - (-1)^{5} = 1 - (-1) = 2.\n$$\n4. 构成守恒缺陷：\n$$\n\\mathcal{C} = Q[u_{x}] - \\big(u(1) - u(-1)\\big) = \\frac{10}{3} - 2 = \\frac{4}{3}.\n$$\n\n解释。非零值 $\\mathcal{C}=\\frac{4}{3}$ 定量地展示了，当对于 $u \\in \\mathbb{P}_{6}$ 的强形式中出现的多项式相互作用而言，求积是积分不足的（阶 $q=3$）时，离散分部积分的失效以及随之而来的单元上局部守恒的损失。使用精确积分时，$\\mathcal{C}$ 将为零，因为 $\\int_{-1}^{1} u_{x}\\, dx = u(1) - u(-1)$。在这里，辛普森法则不能精确地积分 $u_{x}=5x^{4}$，所产生的求积误差直接表现为守恒缺陷。", "answer": "$$\\boxed{\\frac{4}{3}}$$", "id": "3382930"}, {"introduction": "真实世界的问题常常涉及复杂的弯曲几何边界，这对数值方法提出了新的挑战。本练习探讨了在表示这些弯曲边界时出现的不一致性，如何破坏分部积分所依赖的守恒律。通过分析由不同几何近似引起的离散不匹配，您将了解到几何守恒律 (GCL) 的重要性，以及在数值上对几何进行精细且一致处理的必要性。[@problem_id:3382891]", "problem": "考虑一个二维空间曲线网格上的谱元间断伽辽金 (DG) 离散化中的一个两单元交界面。这两个单元共享一个内部面，在物理坐标中，该面由光滑曲线 $r(s) = (x(s), y(s))$ 参数化，其中 $s \\in [-1, 1]$，$x(s) = s$ 且 $y(s) = \\gamma s^{2}$，$\\gamma \\in \\mathbb{R}$ 是一个固定的曲率参数。令 $|r'(s)|$ 表示面上的度量因子（物理线元密度），其中 $r'(s) = \\frac{d r}{d s}(s)$。\n\n在 DG 弱形式中，跨共享内部面的单元分部积分 (IBP) 相消依赖于一个度量恒等式，即当在两个相邻单元上以一致的方式计算时，面测度和外法向因子必须完全匹配。假设面上的数值面积分使用区间 $[-1, 1]$ 上的两点高斯-勒让德求积，节点为 $s = \\pm a$，权重为 $w = 1$，其中 $a = 1/\\sqrt{3}$。\n\n假设左侧单元通过将 $|r'(s)|$ 替换为在 $s = -1$、$s = 0$ 和 $s = 1$ 处与 $|r'(s)|$ 相匹配的二次插值多项式 $P(s)$ 来对该面度量进行积分不足计算，而右侧单元使用精确的 $|r'(s)|$。考虑穿过该面的恒定物理通量和恒定的检验函数，因此影响 IBP 相消的唯一因素是度量因子。定义离散失配为\n$$\n\\Delta(\\gamma) = \\sum_{q=1}^{2} w_{q} \\left( P(s_{q}) - |r'(s_{q})| \\right),\n$$\n其中 $(s_{1}, s_{2}) = (-a, a)$ 且 $(w_{1}, w_{2}) = (1, 1)$。从几何定义和两点高斯-勒让德法则出发，计算 $\\Delta(\\gamma)$ 关于 $\\gamma$ 的闭式解析表达式。\n\n最后，提出一种基于几何守恒律 (GCL) 的有原则的修正方法，通过过积分或构造满足跨共享面的度量恒等式的离散度量项，来恢复曲面上的单元分部积分相消。你的最终答案必须是 $\\Delta(\\gamma)$ 的解析表达式，不得进行数值计算或四舍五入。", "solution": "问题陈述被认定为有效。它在科学上植根于偏微分方程数值方法的理论，特别是曲线网格上的间断伽辽金 (DG) 方法。该问题是适定的，提供了推导离散失配 $\\Delta(\\gamma)$ 唯一解所需的所有信息。所用术语在领域内是客观和标准的。因此，有必要提供完整的解答。\n\n解答过程分三步。首先，我们推导精确的面度量因子 $|r'(s)|$ 的解析表达式。其次，我们构造左侧单元使用的二次插值多项式 $P(s)$。第三，我们使用指定的两点高斯-勒让德求积法则计算离散失配 $\\Delta(\\gamma)$。最后，我们讨论几何守恒律 (GCL) 并针对观察到的失配提出修正方法。\n\n**步骤 1：推导精确的度量因子**\n\n共享面由曲线 $r(s) = (x(s), y(s))$ 参数化，其中 $s \\in [-1, 1]$，其具体形式为：\n$$\nx(s) = s\n$$\n$$\ny(s) = \\gamma s^{2}\n$$\n曲线的切向量为 $r'(s) = \\frac{dr}{ds}(s) = (x'(s), y'(s))$。我们计算其导数：\n$$\nx'(s) = \\frac{d}{ds}(s) = 1\n$$\n$$\ny'(s) = \\frac{d}{ds}(\\gamma s^{2}) = 2\\gamma s\n$$\n因此，切向量为 $r'(s) = (1, 2\\gamma s)$。\n\n度量因子代表物理线元密度，是该切向量的模长：\n$$\n|r'(s)| = \\sqrt{(x'(s))^{2} + (y'(s))^{2}} = \\sqrt{1^{2} + (2\\gamma s)^{2}}\n$$\n$$\n|r'(s)| = \\sqrt{1 + 4\\gamma^{2}s^{2}}\n$$\n这就是右侧单元进行面积分时使用的精确度量因子。\n\n**步骤 2：构造二次插值多项式**\n\n左侧单元用一个二次多项式 $P(s) = As^{2} + Bs + C$ 来近似度量因子，该多项式在点 $s = -1$，$s = 0$ 和 $s = 1$ 处对精确度量 $|r'(s)|$ 进行插值。\n\n首先，我们计算在这些插值点上的精确度量值：\n$$\n|r'(-1)| = \\sqrt{1 + 4\\gamma^{2}(-1)^{2}} = \\sqrt{1 + 4\\gamma^{2}}\n$$\n$$\n|r'(0)| = \\sqrt{1 + 4\\gamma^{2}(0)^{2}} = \\sqrt{1} = 1\n$$\n$$\n|r'(1)| = \\sqrt{1 + 4\\gamma^{2}(1)^{2}} = \\sqrt{1 + 4\\gamma^{2}}\n$$\n插值多项式 $P(s)$ 需满足的条件是：\n1.  $P(-1) = A(-1)^{2} + B(-1) + C = A - B + C = \\sqrt{1 + 4\\gamma^{2}}$\n2.  $P(0) = A(0)^{2} + B(0) + C = C = 1$\n3.  $P(1) = A(1)^{2} + B(1) + C = A + B + C = \\sqrt{1 + 4\\gamma^{2}}$\n\n将 $C=1$ 代入第一个和第三个方程得：\n$$\nA - B + 1 = \\sqrt{1 + 4\\gamma^{2}}\n$$\n$$\nA + B + 1 = \\sqrt{1 + 4\\gamma^{2}}\n$$\n第三个方程减去第一个方程得到 $2B = 0$，这意味着 $B=0$。\n将 $B=0$ 和 $C=1$ 代入第三个方程得到 $A + 1 = \\sqrt{1 + 4\\gamma^{2}}$，这意味着 $A = \\sqrt{1 + 4\\gamma^{2}} - 1$。\n\n因此，二次插值多项式为：\n$$\nP(s) = \\left(\\sqrt{1 + 4\\gamma^{2}} - 1\\right)s^{2} + 1\n$$\n\n**步骤 3：计算离散失配 $\\Delta(\\gamma)$**\n\n离散失配由近似度量因子与精确度量因子之差的数值求积定义：\n$$\n\\Delta(\\gamma) = \\sum_{q=1}^{2} w_{q} \\left( P(s_{q}) - |r'(s_{q})| \\right)\n$$\n问题指定了在 $[-1, 1]$ 上的两点高斯-勒让德求积法则，节点为 $s_{1} = -a$ 和 $s_{2} = a$（其中 $a = 1/\\sqrt{3}$），权重为 $w_{1} = w_{2} = 1$。\n\n代入这些值，我们得到：\n$$\n\\Delta(\\gamma) = w_{1}(P(s_{1}) - |r'(s_{1})|) + w_{2}(P(s_{2}) - |r'(s_{2})|)\n$$\n$$\n\\Delta(\\gamma) = 1 \\cdot (P(-a) - |r'(-a)|) + 1 \\cdot (P(a) - |r'(a)|)\n$$\n$P(s)$ 和 $|r'(s)|$ 都是关于 $s$ 的偶函数（它们只依赖于 $s^2$）。因此，$P(-a) = P(a)$ 且 $|r'(-a)| = |r'(a)|$。表达式简化为：\n$$\n\\Delta(\\gamma) = 2 \\left( P(a) - |r'(a)| \\right)\n$$\n我们现在在求积节点 $a = 1/\\sqrt{3}$ 处计算 $P(a)$ 和 $|r'(a)|$ 的值。注意 $a^{2} = (1/\\sqrt{3})^{2} = 1/3$。\n\n首先，在 $s=a$ 处的精确度量为：\n$$\n|r'(a)| = \\sqrt{1 + 4\\gamma^{2}a^{2}} = \\sqrt{1 + 4\\gamma^{2}\\left(\\frac{1}{3}\\right)} = \\sqrt{1 + \\frac{4\\gamma^{2}}{3}}\n$$\n接着，在 $s=a$ 处的近似度量为：\n$$\nP(a) = \\left(\\sqrt{1 + 4\\gamma^{2}} - 1\\right)a^{2} + 1 = \\left(\\sqrt{1 + 4\\gamma^{2}} - 1\\right)\\left(\\frac{1}{3}\\right) + 1\n$$\n$$\nP(a) = \\frac{1}{3}\\sqrt{1 + 4\\gamma^{2}} - \\frac{1}{3} + 1 = \\frac{1}{3}\\sqrt{1 + 4\\gamma^{2}} + \\frac{2}{3}\n$$\n最后，我们将这些代入 $\\Delta(\\gamma)$ 的表达式中：\n$$\n\\Delta(\\gamma) = 2 \\left( \\left( \\frac{1}{3}\\sqrt{1 + 4\\gamma^{2}} + \\frac{2}{3} \\right) - \\sqrt{1 + \\frac{4\\gamma^{2}}{3}} \\right)\n$$\n将因子 2 分配进去，得到失配的最终闭式表达式：\n$$\n\\Delta(\\gamma) = \\frac{2}{3}\\sqrt{1 + 4\\gamma^{2}} + \\frac{4}{3} - 2\\sqrt{1 + \\frac{4\\gamma^{2}}{3}}\n$$\n\n**基于几何守恒律 (GCL) 的有原则的修正方法**\n\n对于 $\\gamma \\neq 0$，$\\Delta(\\gamma)$ 的非零值表示离散格式未能在单元交界面上保持守恒性。这违反了几何守恒律 (GCL)。GCL 要求数值格式能够精确地表示常数状态，对于采用积分形式离散化的守恒律，这转化为一个单元边界上所有离散的“面积加权法向”向量之和必须为零的条件。为了在 DG 方法中实现交界面通量的完全相消，这意味着两个相邻单元为其共享面计算的几何因子（度量项乘以法向量）必须大小相等、方向相反。由于根据定义，法向量已经是大小相等、方向相反的（$\\mathbf{n}_{L} = -\\mathbf{n}_{R}$），这就要求计算出的面测度在每个求积点 $q$ 上都必须相同：$(J_{q}^{f})_{L} = (J_{q}^{f})_{R}$。在我们的问题中，这意味着在求积点上必须有 $P(s_{q}) = |r'(s_{q})|$，而这通常是不成立的。\n\n问题要求提出基于 GCL 的修正方法。两种有原则的方法是：\n\n1.  **足够精确的求积（过积分）**：问题之所以出现，是因为左侧单元使用了几何的近似 $P(s)$，而右侧单元使用了精确的几何 $|r'(s)|$。如果两个单元都使用精确的度量因子 $|r'(s)|$，那么根据构造就不会存在失配。然而，由于 $|r'(s)| = \\sqrt{1+4\\gamma^2 s^2}$ 不是多项式，没有有限阶的高斯法则能精确地对其积分。修正方法是使用足够高阶的求积法则（过积分）在两个单元上将 $|r'(s)|$ 的积分计算到机器精度。通过对面积分的一致且高精度的计算，交界面两侧的离散贡献将相匹配，从而恢复守恒性。\n\n2.  **构造离散度量项**：在高阶方法中，一种更鲁棒和现代的方法是放弃从几何映射中直接计算连续度量因子。取而代之的是，定义离散的度量因子和法向量，它们被专门构造成满足 GCL。这些离散几何项的推导方式使得离散散度定理根据构造而成立。对于两个单元之间的共享面，此过程保证了计算出的面测度根据定义是相同的，例如 $(w_{q} J_q)_{L} = (w_{q} J_q)_{R}$。这强制实现了离散守恒，而与几何映射的阶数或求积法则无关，从而消除了失配的根本原因。这种方法确保了数值方法即使在高度扭曲的高阶曲线网格上也是“自由流保持”的（即，对于均匀流能精确平衡通量）。这是在此类网格上实现 DG 方法的单元分部积分相消的最有原则的方法。\n\n总之，根本的修正方法是强制一致性。要么两个单元都必须使用相同的面对测度的高度精确近似，要么它们必须使用从一开始就设计为满足必要度量恒等式的离散几何项。", "answer": "$$\\boxed{\\frac{4}{3} + \\frac{2}{3}\\sqrt{1 + 4\\gamma^{2}} - 2\\sqrt{1 + \\frac{4\\gamma^{2}}{3}}}$$", "id": "3382891"}]}