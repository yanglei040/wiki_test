{"hands_on_practices": [{"introduction": "在施加边界条件之前，我们首先需要一个具有正确结构的离散微分算子。本练习将引导您推导分部求和 (Summation-By-Parts, SBP) 性质，它是分部积分的离散模拟。掌握在勒让德-高斯-洛巴托 (Legendre-Gauss-Lobatto) 节点上这一定理的推导，是为时间相关问题构建可证明稳定的数值格式提供了最基本的构件 [@problem_id:3367649]。", "problem": "考虑区间 $[-1,1]$ 以及次数至多为 $N$ 的多项式空间，其中 $N \\in \\mathbb{N}$ 且 $N \\geq 1$。令 $\\{x_i\\}_{i=0}^{N}$ 表示勒让德-高斯-洛巴托 (LGL) 节点，包括端点 $x_0=-1$、$x_N=1$ 以及由 $(1-x^2) P_N'(x)$ 的不同根给出的 $N-1$ 个内部节点，其中 $P_N(x)$ 是 $N$ 次勒让德多项式。令 $\\{\\ell_j(x)\\}_{j=0}^{N}$ 为这些节点上的拉格朗日插值基，使得对于所有 $0 \\leq i,j \\leq N$，都有 $\\ell_j(x_i)=\\delta_{ij}$。\n\n定义对角范数矩阵 $H=\\mathrm{diag}(h_0,h_1,\\dots,h_N)$，其中 $(h_i)_{i=0}^{N}$ 是 LGL 求积权重，以及谱配置微分矩阵 $D$，其元素为 $D_{ij}=\\ell_j'(x_i)$。仅使用以下基础：\n- 勒让德多项式关于权重为 $1$ 的 $L^2([-1,1])$ 内积的正交性，\n- LGL 求积对于次数至多为 $2N-1$ 的多项式的精确性，\n- 区间 $[-1,1]$ 上的分部积分恒等式，\n推导一阶导数的分部求和 (SBP) 关系式，\n$$\nH D + D^{T} H \\;=\\; B,\n$$\n其中 $B = e_N e_N^{T} - e_0 e_0^{T}$ 且 $e_0,e_N \\in \\mathbb{R}^{N+1}$ 是端点处的坐标单位向量。特别地，证明对于任意网格函数 $u,v \\in \\mathbb{R}^{N+1}$，\n$$\nu^{T} H D v + (D u)^{T} H v \\;=\\; u_N v_N - u_0 v_0.\n$$\n然后，通过从第一性原理构造端点拉格朗日基函数 $\\ell_0(x)$ 和 $\\ell_N(x)$ 并精确计算它们的积分，确定端点求积权重 $h_0$ 和 $h_N$ 作为 $N$ 的函数的闭式表达式。\n\n你的最终答案必须是将 $h_0$ 和 $h_N$ 的表达式写成单个行向量。不需要数值近似。", "solution": "该问题是有效的，因为它是谱方法既定理论中一个适定、有科学依据的问题。它要求推导一个标准结果（勒让德-高斯-洛巴托配置的分部求和性质）并计算相关的端点求积权重。\n\n解答分为两部分。首先，我们推导分部求和 (SBP) 关系。其次，我们显式地构造端点的拉格朗日基多项式并计算相应的求积权重。\n\n### 第一部分：分部求和 (SBP) 关系的推导\n\n令 $p(x)$ 和 $q(x)$ 为次数至多为 $N$ 的任意多项式。它们在勒让德-高斯-洛巴托 (LGL) 节点 $\\{x_i\\}_{i=0}^{N}$ 处的值定义了网格函数 $u, v \\in \\mathbb{R}^{N+1}$，使得 $u_i = p(x_i)$ 且 $v_i = q(x_i)$。这些多项式可以用拉格朗日基 $\\{\\ell_j(x)\\}_{j=0}^N$ 表示为 $p(x) = \\sum_{j=0}^{N} u_j \\ell_j(x)$ 和 $q(x) = \\sum_{j=0}^{N} v_j \\ell_j(x)$。\n\n$p(x)$ 的导数是 $p'(x) = \\sum_{j=0}^{N} u_j \\ell_j'(x)$。导数在 LGL 节点处的值由谱配置微分矩阵 $D$ 作用于网格函数 $u$ 得到。具体来说，向量 $Du$ 的第 $i$ 个分量是 $(Du)_i = p'(x_i) = \\sum_{j=0}^{N} \\ell_j'(x_i) u_j = \\sum_{j=0}^{N} D_{ij} u_j$。\n\n我们从区间 $[-1, 1]$ 上的分部积分恒等式开始：\n$$\n\\int_{-1}^{1} \\left( p(x) q'(x) + p'(x) q(x) \\right) \\,dx = \\int_{-1}^{1} \\frac{d}{dx} (p(x)q(x)) \\,dx = [p(x)q(x)]_{x=-1}^{x=1}.\n$$\n右边计算结果为 $p(1)q(1) - p(-1)q(-1)$。由于区间的端点是 LGL 节点，$x_N=1$ 和 $x_0=-1$，该项变为 $p(x_N)q(x_N) - p(x_0)q(x_0) = u_N v_N - u_0 v_0$。\n\n现在我们考虑左边的积分。多项式 $p(x)$ 的次数至多为 $N$，$q'(x)$ 的次数至多为 $N-1$，所以它们的乘积 $p(x)q'(x)$ 是一个次数至多为 $2N-1$ 的多项式。类似地，$p'(x)q(x)$ 也是一个次数至多为 $2N-1$ 的多项式。LGL 求积法则对所有次数至多为 $2N-1$ 的多项式都是精确的。因此，我们可以用 LGL 节点上的加权和来代替积分：\n$$\n\\int_{-1}^{1} p(x)q'(x) \\,dx = \\sum_{i=0}^{N} p(x_i) q'(x_i) h_i,\n$$\n$$\n\\int_{-1}^{1} p'(x)q(x) \\,dx = \\sum_{i=0}^{N} p'(x_i) q(x_i) h_i.\n$$\n代入网格函数和矩阵 $D$，这些和可以用向量表示法表示。令 $H = \\mathrm{diag}(h_0, \\dots, h_N)$。\n$$\n\\sum_{i=0}^{N} p(x_i) q'(x_i) h_i = \\sum_{i=0}^{N} u_i (Dv)_i h_i = u^T H (Dv) = u^T H D v.\n$$\n$$\n\\sum_{i=0}^{N} p'(x_i) q(x_i) h_i = \\sum_{i=0}^{N} (Du)_i v_i h_i = (Du)^T H v.\n$$\n将这些表达式代回分部积分恒等式，得到：\n$$\nu^{T} H D v + (D u)^{T} H v = u_N v_N - u_0 v_0.\n$$\n这就是对于任意网格函数 $u$ 和 $v$ 的分量形式的 SBP 性质。\n\n为了推导矩阵形式，我们使用转置性质重写左侧：$(Du)^T = u^T D^T$。\n$$\nu^T H D v + u^T D^T H v = u^T (HD + D^T H) v.\n$$\n右侧可以用标准基向量 $e_0$ 和 $e_N$ 来书写，其中 $e_k$ 是一个在索引 $k$ 处为 1，其他位置为 0 的列向量（索引从 0 到 $N$）。我们有 $u_k = e_k^T u$ 和 $v_k = e_k^T v$。\n$$\nu_N v_N - u_0 v_0 = (e_N^T u)(e_N^T v) - (e_0^T u)(e_0^T v) = u^T e_N e_N^T v - u^T e_0 e_0^T v = u^T (e_N e_N^T - e_0 e_0^T) v.\n$$\n定义 $B = e_N e_N^T - e_0 e_0^T$，我们有 $u_N v_N - u_0 v_0 = u^T B v$。\n令左右两边相等，得到 $u^T (HD + D^T H) v = u^T B v$。由于这对所有 $u, v \\in \\mathbb{R}^{N+1}$ 都必须成立，我们得出矩阵必须相等：\n$$\nHD + D^T H = B.\n$$\n这就完成了问题的第一部分。\n\n### 第二部分：端点求积权重 $h_0$ 和 $h_N$ 的计算\n\nLGL 求积权重由相应的拉格朗日基多项式的积分给出，$h_j = \\int_{-1}^1 \\ell_j(x) dx$。我们构造 $\\ell_0(x)$ 和 $\\ell_N(x)$ 来求得 $h_0$ 和 $h_N$。\n\nLGL 节点 $\\{x_i\\}_{i=0}^N$ 是多项式 $(1-x^2)P_N'(x)$ 的根，其中 $P_N(x)$ 是 $N$ 次勒让德多项式。内部节点 $x_1, \\dots, x_{N-1}$ 是 $P_N'(x)$ 的根，端点节点是 $x_0 = -1$ 和 $x_N = 1$。\n\n$\\ell_N(x)$ 的构造：\n基多项式 $\\ell_N(x)$ 在所有其他节点 $x_0, x_1, \\dots, x_{N-1}$ 处必须为零。因此，它的根是 $-1$ 和 $P_N'(x)$ 的根。这意味着 $\\ell_N(x)$ 必须与 $(x+1)P_N'(x)$ 成正比。\n$$\n\\ell_N(x) = C_N (x+1) P_N'(x).\n$$\n这是一个次数为 $1 + (N-1) = N$ 的多项式，符合要求。常数 $C_N$ 由条件 $\\ell_N(x_N) = 1$（即 $\\ell_N(1) = 1$）确定。\n$$\n1 = C_N (1+1) P_N'(1) = 2 C_N P_N'(1).\n$$\n使用勒让德多项式的已知性质，$P_N'(1) = \\frac{N(N+1)}{2}$ (对于 $N \\geq 1$)：\n$$\n1 = 2 C_N \\left( \\frac{N(N+1)}{2} \\right) = C_N N(N+1) \\implies C_N = \\frac{1}{N(N+1)}.\n$$\n所以，$\\ell_N(x) = \\frac{1}{N(N+1)}(x+1)P_N'(x)$。权重 $h_N$ 是它的积分：\n$$\nh_N = \\int_{-1}^{1} \\ell_N(x) dx = \\frac{1}{N(N+1)} \\int_{-1}^{1} (x+1)P_N'(x) dx.\n$$\n使用分部积分法，令 $u = x+1$ 和 $dv = P_N'(x)dx$：\n$$\n\\int_{-1}^{1} (x+1)P_N'(x) dx = [(x+1)P_N(x)]_{-1}^{1} - \\int_{-1}^{1} P_N(x) dx.\n$$\n边界项是 $(1+1)P_N(1) - (-1+1)P_N(-1) = 2P_N(1) = 2(1) = 2$，使用了 $P_N(1)=1$。积分项是 $\\int_{-1}^1 P_N(x)P_0(x)dx$，根据勒让德多项式的正交性，对于 $N \\ge 1$ 该项为 0。因此，该积分的计算结果为 2。\n$$\nh_N = \\frac{1}{N(N+1)} \\cdot 2 = \\frac{2}{N(N+1)}.\n$$\n\n$\\ell_0(x)$ 的构造：\n类似地，$\\ell_0(x)$ 在节点 $x_1, \\dots, x_N$ 处必须为零。它的根是 $1$ 和 $P_N'(x)$ 的根。\n$$\n\\ell_0(x) = C_0 (x-1) P_N'(x).\n$$\n常数 $C_0$ 由 $\\ell_0(x_0) = 1$（即 $\\ell_0(-1) = 1$）确定。\n$$\n1 = C_0 (-1-1) P_N'(-1) = -2 C_0 P_N'(-1).\n$$\n使用性质 $P_N'(-1) = (-1)^{N-1} \\frac{N(N+1)}{2}$：\n$$\n1 = -2 C_0 \\left( (-1)^{N-1} \\frac{N(N+1)}{2} \\right) = -C_0 (-1)^{N-1} N(N+1) = C_0 (-1)^N N(N+1).\n$$\n所以，$C_0 = \\frac{1}{(-1)^N N(N+1)} = \\frac{(-1)^N}{N(N+1)}$。\n基函数是 $\\ell_0(x) = \\frac{(-1)^N}{N(N+1)}(x-1)P_N'(x)$。权重 $h_0$ 是它的积分：\n$$\nh_0 = \\int_{-1}^{1} \\ell_0(x) dx = \\frac{(-1)^N}{N(N+1)} \\int_{-1}^{1} (x-1)P_N'(x) dx.\n$$\n使用分部积分法，令 $u = x-1$ 和 $dv = P_N'(x)dx$：\n$$\n\\int_{-1}^{1} (x-1)P_N'(x) dx = [(x-1)P_N(x)]_{-1}^{1} - \\int_{-1}^{1} P_N(x) dx.\n$$\n边界项是 $(1-1)P_N(1) - (-1-1)P_N(-1) = 0 - (-2)P_N(-1) = 2P_N(-1)$。使用 $P_N(-1)=(-1)^N$，此项为 $2(-1)^N$。积分项再次为 0。\n$$\nh_0 = \\frac{(-1)^N}{N(N+1)} \\cdot 2(-1)^N = \\frac{2(-1)^{2N}}{N(N+1)} = \\frac{2}{N(N+1)}.\n$$\n因此，端点求积权重是相同的。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{2}{N(N+1)} & \\frac{2}{N(N+1)}\n\\end{pmatrix}\n}\n$$", "id": "3367649"}, {"introduction": "SBP 性质与弱施加边界条件的同步近似项 (Simultaneous Approximation Term, SAT) 方法相结合时最为强大。本练习将 SBP-SAT 框架应用于作为流体动力学模型的线性化欧拉方程 [@problem_id:3367664]。通过推导正确的惩罚参数，您将学习如何设计一种在离散层面遵循基本物理定律——质量守恒——的数值格式，从而防止在边界处产生非物理的质量泄漏。", "problem": "考虑在区间 $x \\in [-1,1]$ 上，围绕密度 $\\rho_{0} > 0$、速度 $u_{0} = 0$ 和压力 $p_{0} > 0$ 的均匀平衡态的一维线性化可压缩欧拉方程。扰动量 $\\rho(x,t)$、$u(x,t)$ 和 $p(x,t)$ 的线性化系统为\n$$\n\\rho_{t} + \\rho_{0}\\,u_{x} = 0,\\quad\nu_{t} + \\frac{1}{\\rho_{0}}\\,p_{x} = 0,\\quad\np_{t} + \\gamma p_{0}\\,u_{x} = 0,\n$$\n其中比热容比 $\\gamma > 1$。使用 Chebyshev–Gauss–Lobatto 配置方法在节点 $x_{j} = \\cos\\!\\left(\\frac{\\pi j}{N}\\right)$（其中 $j=0,\\dots,N$）上对 $x \\in [-1,1]$ 进行离散化。设微分矩阵为 $D \\in \\mathbb{R}^{(N+1)\\times(N+1)}$，对角求积/范数矩阵为 $H = \\mathrm{diag}(h_{0},\\dots,h_{N})$，使得分部求和 (SBP) 性质成立：若 $Q := H D$，则\n$$\nQ + Q^{\\top} = B,\\quad B = \\mathrm{diag}(-1,0,\\dots,0,1).\n$$\n你需要在两个边界上施加不可穿透的完美反射壁条件，即在 $x=-1$ 和 $x=1$ 处边界条件为 $u=0$。仅在质量方程中使用同步近似项 (SAT) 方法，将半离散质量方程写为\n$$\nH\\,\\dot{\\rho} + \\rho_{0}\\,Q\\,u = \\mathrm{SAT}_{\\rho},\\quad\n\\mathrm{SAT}_{\\rho} = H^{-1}\\!\\left(\\tau_{L}\\,e_{0}\\,u_{0} + \\tau_{R}\\,e_{N}\\,u_{N}\\right),\n$$\n其中 $e_{0},e_{N} \\in \\mathbb{R}^{N+1}$ 是提取边界自由度的标准基向量，$u_{0}$ 和 $u_{N}$ 表示 $u$ 在 $x=-1$ 和 $x=1$ 处的离散边界值，而 $\\tau_{L},\\tau_{R} \\in \\mathbb{R}$ 是待定的罚系数（常数）。\n\n从线性化方程和 SBP 性质的定义出发，推导总质量的精确离散守恒律\n$$\nM(t) := \\mathbf{1}^{\\top} H\\,\\rho(t),\n$$\n其中 $\\mathbf{1} = [1,\\dots,1]^{\\top} \\in \\mathbb{R}^{N+1}$，并求出保证在离散意义下没有净质量泄漏的 $\\tau_{L}$ 和 $\\tau_{R}$ 的代数条件，即当边界数据在两端强制 $u_{\\mathrm{bc}}=0$ 时，对于任意离散状态都有 $\\frac{d}{dt}M(t) = 0$。然后选择 $\\tau_{L}$ 和 $\\tau_{R}$，使得对于任何 $N$、任何 $\\rho_{0} > 0$ 以及定义 $H$ 的任何 Chebyshev 权重 $h_{0},\\dots,h_{N}$，此性质都恒成立（在舍入误差范围内）。\n\n以 $\\rho_{0}$、$h_{0}$ 和 $h_{N}$ 的解析表达式形式给出 $\\tau_{L}$ 和 $\\tau_{R}$ 的最终答案。将最终答案表示为包含这两个系数的单个行矩阵。不需要进行数值近似。", "solution": "本题要求推导线性化质量守恒方程的分部求和-同步近似项 (SBP-SAT) 离散化中的罚系数 $\\tau_{L}$ 和 $\\tau_{R}$，以使总离散质量守恒。\n\n总离散质量定义为 $M(t) := \\mathbf{1}^{\\top} H\\,\\rho(t)$，其中 $\\rho(t) \\in \\mathbb{R}^{N+1}$ 是配点上密度扰动的向量，$H$ 是对角求积矩阵，$\\mathbf{1} \\in \\mathbb{R}^{N+1}$ 是全一向量。为确保没有净质量泄漏，我们必须有 $\\frac{d}{dt}M(t) = 0$。\n\n让我们计算 $M(t)$ 的时间导数：\n$$\n\\frac{dM}{dt} = \\frac{d}{dt} \\left(\\mathbf{1}^{\\top} H\\,\\rho(t)\\right)\n$$\n由于向量 $\\mathbf{1}$ 和矩阵 $H$ 不随时间变化，导数仅作用于 $\\rho(t)$：\n$$\n\\frac{dM}{dt} = \\mathbf{1}^{\\top} \\left(H\\,\\frac{d\\rho}{dt}\\right) = \\mathbf{1}^{\\top} H\\,\\dot{\\rho}\n$$\n题目给出了半离散质量方程：\n$$\nH\\,\\dot{\\rho} + \\rho_{0}\\,Q\\,u = \\mathrm{SAT}_{\\rho}\n$$\n其中 $Q = H D$。我们可以将 $H\\,\\dot{\\rho}$ 表示为：\n$$\nH\\,\\dot{\\rho} = -\\rho_{0}\\,Q\\,u + \\mathrm{SAT}_{\\rho}\n$$\n将此代入 $\\frac{dM}{dt}$ 的表达式中：\n$$\n\\frac{dM}{dt} = \\mathbf{1}^{\\top} \\left(-\\rho_{0}\\,Q\\,u + \\mathrm{SAT}_{\\rho}\\right) = -\\rho_{0}\\,\\mathbf{1}^{\\top}Q\\,u + \\mathbf{1}^{\\top}\\mathrm{SAT}_{\\rho}\n$$\n现在我们分别分析右侧的两项。\n\n对于第一项 $-\\rho_{0}\\,\\mathbf{1}^{\\top}Q\\,u$，我们使用 SBP 性质。项 $\\mathbf{1}^{\\top}Q\\,u$ 是一个标量，因此它等于其转置：\n$$\n\\mathbf{1}^{\\top}Q\\,u = \\left(\\mathbf{1}^{\\top}Q\\,u\\right)^{\\top} = u^{\\top}Q^{\\top}\\mathbf{1}\n$$\nSBP 性质表明 $Q + Q^{\\top} = B$，这意味着 $Q^{\\top} = B - Q$。代入此式可得：\n$$\nu^{\\top}Q^{\\top}\\mathbf{1} = u^{\\top}(B - Q)\\mathbf{1} = u^{\\top}B\\,\\mathbf{1} - u^{\\top}Q\\,\\mathbf{1}\n$$\n让我们计算这两个部分。首先是 $u^{\\top}B\\,\\mathbf{1}$，其中 $B = \\mathrm{diag}(-1, 0, \\dots, 0, 1)$：\n$$\nB\\,\\mathbf{1} = \\begin{pmatrix} -1 & & \\\\ & 0 & \\\\ & & \\ddots & \\\\ & & & 0 & \\\\ & & & & 1 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 1 \\\\ \\vdots \\\\ 1 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} -1 \\\\ 0 \\\\ \\vdots \\\\ 0 \\\\ 1 \\end{pmatrix}\n$$\n然后，与 $u^{\\top} = [u_0, u_1, \\dots, u_N]$ 的乘积为：\n$$\nu^{\\top}B\\,\\mathbf{1} = [u_{0}, u_{1}, \\dots, u_{N}] \\begin{pmatrix} -1 \\\\ 0 \\\\ \\vdots \\\\ 0 \\\\ 1 \\end{pmatrix} = -u_{0} + u_{N}\n$$\n对于第二部分 $u^{\\top}Q\\,\\mathbf{1}$，我们回顾 $Q = HD$。由于 $D$ 是一个微分矩阵，它作用于向量 $\\mathbf{1}$（代表一个常数函数）会得到零向量，$D\\mathbf{1} = \\mathbf{0}$。因此：\n$$\nQ\\,\\mathbf{1} = H D \\mathbf{1} = H \\mathbf{0} = \\mathbf{0}\n$$\n这导致 $u^{\\top}Q\\,\\mathbf{1} = u^{\\top}\\mathbf{0} = 0$。\n综合这些结果，我们得到 $\\mathbf{1}^{\\top}Q\\,u = -u_{0} + u_{N}$。因此，$\\frac{dM}{dt}$ 表达式中的第一项为：\n$$\n-\\rho_{0}\\,\\mathbf{1}^{\\top}Q\\,u = -\\rho_{0}(-u_{0} + u_{N}) = \\rho_{0}(u_{0} - u_{N})\n$$\n\n对于第二项 $\\mathbf{1}^{\\top}\\mathrm{SAT}_{\\rho}$，我们使用给定的定义：\n$$\n\\mathrm{SAT}_{\\rho} = H^{-1}\\!\\left(\\tau_{L}\\,e_{0}\\,u_{0} + \\tau_{R}\\,e_{N}\\,u_{N}\\right)\n$$\n其中 $H=\\mathrm{diag}(h_0, \\dots, h_N)$，$e_0=[1,0,\\dots,0]^\\top$ 且 $e_N=[0,\\dots,0,1]^\\top$。那么：\n$$\n\\mathbf{1}^{\\top}\\mathrm{SAT}_{\\rho} = \\mathbf{1}^{\\top} H^{-1}(\\tau_{L}\\,e_{0}\\,u_{0} + \\tau_{R}\\,e_{N}\\,u_{N}) = \\tau_L u_0 (\\mathbf{1}^\\top H^{-1} e_0) + \\tau_R u_N (\\mathbf{1}^\\top H^{-1} e_N)\n$$\n括号中的项是标量。我们有 $H^{-1} = \\mathrm{diag}(h_0^{-1}, \\dots, h_N^{-1})$。\n$$\n\\mathbf{1}^{\\top} H^{-1} e_0 = [1, \\dots, 1] \\begin{pmatrix} h_0^{-1} \\\\ 0 \\\\ \\vdots \\\\ 0 \\end{pmatrix} = h_0^{-1}\n$$\n$$\n\\mathbf{1}^{\\top} H^{-1} e_N = [1, \\dots, 1] \\begin{pmatrix} 0 \\\\ \\vdots \\\\ 0 \\\\ h_N^{-1} \\end{pmatrix} = h_N^{-1}\n$$\n所以，$\\frac{dM}{dt}$ 表达式中的第二项是：\n$$\n\\mathbf{1}^{\\top}\\mathrm{SAT}_{\\rho} = \\frac{\\tau_L}{h_0}u_0 + \\frac{\\tau_R}{h_N}u_N\n$$\n\n合并两项，总质量变化率为：\n$$\n\\frac{dM}{dt} = \\rho_{0}(u_{0} - u_{N}) + \\frac{\\tau_L}{h_0}u_0 + \\frac{\\tau_R}{h_N}u_N\n$$\n对边界速度值 $u_0$ 和 $u_N$ 的系数进行分组：\n$$\n\\frac{dM}{dt} = \\left(\\rho_{0} + \\frac{\\tau_L}{h_0}\\right)u_0 + \\left(-\\rho_{0} + \\frac{\\tau_R}{h_N}\\right)u_N\n$$\n题目要求这个守恒性质对“任意离散状态”都“恒”成立。这意味着无论 $u_0$ 和 $u_N$（它们是数值解向量 $u$ 的分量）取何值，$\\frac{dM}{dt}$ 都必须为零。由于可以构造出 $u_0 \\neq 0$ 同时 $u_N=0$ 的离散多项式状态，反之亦然，所以要使该表达式恒为零，唯一的办法是 $u_0$ 和 $u_N$ 的系数各自独立为零。\n\n1.  $u_0$ 的系数：\n    $$\n    \\rho_{0} + \\frac{\\tau_L}{h_0} = 0 \\implies \\tau_L = -\\rho_{0}\\,h_0\n    $$\n2.  $u_N$ 的系数：\n    $$\n    -\\rho_{0} + \\frac{\\tau_R}{h_N} = 0 \\implies \\tau_R = \\rho_{0}\\,h_N\n    $$\n\n对 $\\tau_L$ 和 $\\tau_R$ 的这些选择保证了对于任何离散解，$\\frac{dM}{dt} = 0$ 都成立，从而确保了半离散化是精确质量守恒的。最终答案要求将这两个系数放在一个行矩阵中。", "answer": "$$\n\\boxed{\\begin{pmatrix} -\\rho_{0} h_{0} & \\rho_{0} h_{N} \\end{pmatrix}}\n$$", "id": "3367664"}, {"introduction": "虽然 SBP-SAT 为稳定性提供了一条严谨的路径，但在实践中人们也常使用更直接的“强”施加方法。本练习通过将行修改法与更稳定的内部点约化法进行比较，对前者进行了批判性分析 [@problem_id:3367677]。通过研究算子的条件数和谱特性，您将揭示由特定边界处理方式所产生的非正规算子的潜在风险，并理解为何像 SBP 这样的结构化方法通常更为优越。", "problem": "考虑在区间 $\\left[-1,1\\right]$ 上由线性微分算子 $\\mathcal{L}u = -u'' + u$ 和齐次 Dirichlet 边界条件 $u(-1) = 0$及$u(1) = 0$ 控制的边值问题。目标是在基于 Chebyshev–Gauss–Lobatto 点的谱配置法框架下，分析通过修改离散算子的第一行和最后一行来施加 Dirichlet 边界条件的方法，如何随着多项式次数的增加影响离散算子的谱和 2-范数条件数。该分析必须关联 Chebyshev 点在端点附近的聚集现象及其数值影响。\n\n从以下基本定义出发：\n- Chebyshev–Gauss–Lobatto 点的定义为 $x_j = \\cos\\left(\\frac{\\pi j}{N}\\right)$，其中 $j = 0,1,\\dots,N$，$N$ 是多项式次数，配点数量为 $N+1$。\n- 在 Chebyshev–Gauss–Lobatto 点上的谱一阶微分矩阵 $D$ 的定义为：该矩阵将节点值映射为其一阶导数的近似值，它是根据 Chebyshev 理论规定的类似重心坐标的权重构建的，以满足对最高 $N$ 次多项式的求导精确性。\n- 通过一阶微分矩阵的平方得到二阶导数的离散近似，即 $D^{(2)} = D D$。\n- 在配点上对算子 $\\mathcal{L}$ 的离散近似为 $A_{\\mathrm{full}} = -D^{(2)} + I$，其中 $I$ 是大小为 $N+1$ 的单位矩阵。\n- 通过行修改施加齐次 Dirichlet 边界条件：用分别施加 $u(-1)=0$ 和 $u(1)=0$ 的单位行替换 $A_{\\mathrm{full}}$ 的第一行和最后一行，得到 $A_{\\mathrm{bc}}$。\n- 通过内部缩减施加齐次 Dirichlet 边界条件：提取 $A_{\\mathrm{full}}$ 中对应于索引 $1,2,\\dots,N-1$ 的内部子块以形成 $A_{\\mathrm{int}}$，该矩阵作用于边界值固定为零的内部未知数。\n\n您必须：\n1. 对每个给定的 $N$，构建 Chebyshev–Gauss–Lobatto 网格，并使用典范 Chebyshev 权重和节点坐标的差值构建谱一阶微分矩阵 $D$。其对角线元素由 $D$ 的每行之和为零的要求定义（这是对常数求导为零的推论）。不要使用未从这些基础推导出的简化公式。\n2. 形成离散二阶导数算子 $D^{(2)} = D D$。\n3. 组装离散算子 $A_{\\mathrm{full}} = -D^{(2)} + I$。\n4. 使用两种方法施加齐次 Dirichlet 边界条件：\n   - 行修改：通过将 $A_{\\mathrm{full}}$ 的第一行和最后一行分别替换为施加 $u(-1)=0$ 和 $u(1)=0$ 的行来构造 $A_{\\mathrm{bc}}$，即将第一行设置为 $[1,0,\\dots,0]$，最后一行设置为 $[0,\\dots,0,1]$。\n   - 内部缩减：通过提取 $A_{\\mathrm{full}}$ 中对应于索引为 $1$ 到 $N-1$ 的行和列的内部子块，构造 $(N-1)\\times(N-1)$ 矩阵 $A_{\\mathrm{int}}$。\n5. 对每个矩阵 $A_{\\mathrm{bc}}$ 和 $A_{\\mathrm{int}}$，计算：\n   - 2-范数条件数 $\\kappa_2$，定义为最大奇异值与最小奇异值之比。\n   - 谱（特征值集合），您必须从中提取特征值实部的最小值和最大值，以及虚部的最大绝对值。这些谱特征量化了行修改方法相对于内部缩减方法，是如何改变谱的分布范围和非正规性的。\n6. 解释 $\\kappa_2$ 随 $N$ 的增长与 Chebyshev 配点在 $x=-1$ 和 $x=1$ 附近聚集的关系，以及行修改方法如何影响局域化在端点附近的高频模式。\n\n您必须实现一个程序，对以下多项式次数的测试套件返回数值结果：\n- $N=6$ (小规模，用于验证基线行为)\n- $N=16$ (中等规模)\n- $N=32$ (较大规模)\n- $N=64$ (高分辨率)\n\n对于测试套件中的每个 $N$，按此顺序生成一个包含以下九个浮点值的列表：\n- $\\kappa_2(A_{\\mathrm{bc}})$\n- $\\kappa_2(A_{\\mathrm{int}})$\n- $\\kappa_2(A_{\\mathrm{bc}})/\\kappa_2(A_{\\mathrm{int}})$\n- $\\min\\left(\\Re\\lambda\\left(A_{\\mathrm{bc}}\\right)\\right)$\n- $\\max\\left(\\Re\\lambda\\left(A_{\\mathrm{bc}}\\right)\\right)$\n- $\\min\\left(\\Re\\lambda\\left(A_{\\mathrm{int}}\\right)\\right)$\n- $\\max\\left(\\Re\\lambda\\left(A_{\\mathrm{int}}\\right)\\right)$\n- $\\max\\left(\\left|\\Im\\lambda\\left(A_{\\mathrm{bc}}\\right)\\right|\\right)$\n- $\\max\\left(\\left|\\Im\\lambda\\left(A_{\\mathrm{int}}\\right)\\right|\\right)$\n\n您的程序应生成单行输出，其中包含一个由方括号括起来的逗号分隔列表。列表中的每个元素对应一个 $N$ 值，并且本身是包含上述九个数字的列表。例如，输出格式必须如下：\n[[n1_1,n1_2,n1_3,n1_4,n1_5,n1_6,n1_7,n1_8,n1_9],[n2_1,n2_2,n2_3,n2_4,n2_5,n2_6,n2_7,n2_8,n2_9],[n3_1,n3_2,n3_3,n3_4,n3_5,n3_6,n3_7,n3_8,n3_9],[n4_1,n4_2,n4_3,n4_4,n4_5,n4_6,n4_7,n4_8,n4_9]]\n\n所有量均为无量纲；不涉及物理单位。最终打印的输出必须是严格遵守指定格式的单行文本，所有数值均表示为普通十进制数。", "solution": "用户提供的问题是有效的。这是一个在数值分析领域，特别是谱方法领域中，具有科学依据的适定问题。所有必要的定义和约束都已提供，没有矛盾或歧义。该问题要求对 Chebyshev 配点格式中施加 Dirichlet 边界条件的两种标准方法进行定量和定性分析，这是该学科的一个核心课题。\n\n### **1. 理论框架**\n\n该问题涉及求解在区间 $x \\in [-1, 1]$ 上的下述一维线性边值问题 (BVP)：\n$$\n\\mathcal{L}u = -u''(x) + u(x) = f(x)\n$$\n该问题具有齐次 Dirichlet 边界条件 $u(-1) = 0$ 和 $u(1) = 0$。我们将分析通过谱配点法获得的离散算子的性质。\n\n### **2. 谱配点离散化**\n\n该方法的基础是用一个次数为 $N$ 的全局多项式 $p(x)$ 来近似未知函数 $u(x)$。该多项式的系数通过在一组 $N+1$ 个特定点（称为配点）上施加微分方程来确定。\n\n**2.1. Chebyshev–Gauss–Lobatto (CGL) 网格**\n所选的配点是 Chebyshev–Gauss–Lobatto (CGL) 点，定义为第一类 $N$ 次 Chebyshev 多项式的极值点：\n$$\nx_j = \\cos\\left(\\frac{\\pi j}{N}\\right) \\quad \\text{for } j = 0, 1, \\dots, N\n$$\n这些点包括边界点 $x_0 = 1$ 和 $x_N = -1$。该网格的一个关键特性是其非均匀间距：点在边界附近聚集，相邻点之间的距离 $\\Delta x_j$ 在 $x=\\pm 1$ 附近按 $O(1/N^2)$ 比例缩放，而在定义域内部则按 $O(1/N)$ 比例缩放。这种聚集对于解析边界层和减轻 Runge 现象至关重要，但对数值算子的条件数有显著影响。\n\n**2.2. 谱微分矩阵**\n在 CGL 点处插值多项式 $p(x)$ 的导数可以通过对函数值 $\\{u(x_j)\\}_{j=0}^N$ 的线性变换来计算。此变换由 $(N+1) \\times (N+1)$ 的谱微分矩阵 $D$ 表示。该矩阵的元素由下式给出：\n$$\nD_{jk} = \\begin{cases}\n    \\frac{c_j}{c_k} \\frac{(-1)^{j+k}}{x_j - x_k} & \\text{if } j \\neq k \\\\\n    -\\sum_{l=0, l \\neq j}^{N} D_{jl} & \\text{if } j = k\n\\end{cases}\n$$\n其中权重 $c_j$ 定义为 $c_0 = c_N = 2$，$j=1, \\dots, N-1$ 时 $c_j = 1$。对角线元素由常数函数（0次多项式）的导数为零这一性质明确定义，这意味着 $D$ 的每一行之和必须为零。\n\n二阶导数通过两次应用微分矩阵来近似，得到二阶导数矩阵 $D^{(2)} = D^2 = D \\cdot D$。对应于 $\\mathcal{L} = -d^2/dx^2 + 1$ 的完整离散算子则组装为：\n$$\nA_{\\mathrm{full}} = -D^2 + I\n$$\n其中 $I$ 是 $(N+1) \\times (N+1)$ 的单位矩阵。\n\n### **3. 边界条件的施加**\n\n矩阵 $A_{\\mathrm{full}}$ 是奇异的，因为它尚未包含边界条件。我们分析两种施加 $u(1)=u(x_0)=0$ 和 $u(-1)=u(x_N)=0$ 的方法。\n\n**3.1. 方法1：内部缩减**\n该方法从方程组中消除了已知的边界值。由于 $u_0 = 0$ 且 $u_N = 0$，内部点 $j=1, \\dots, N-1$ 的方程仅依赖于内部未知数 $u_1, \\dots, u_{N-1}$。所得系统由一个 $(N-1) \\times (N-1)$ 矩阵 $A_{\\mathrm{int}}$ 控制，该矩阵通过提取 $A_{\\mathrm{full}}$ 中对应于行和列 $1$ 到 $N-1$ 的子块而形成。\n$$\nA_{\\mathrm{int}} = (A_{\\mathrm{full}})_{1:N-1, 1:N-1}\n$$\n该矩阵为BVP提供了一个直接且稳定的表示。尽管 $A_{\\mathrm{int}}$ 是非对称的，但其特征值是实数、正数，并能精确逼近连续算子 $\\mathcal{L}$ 的特征值（$\\lambda_k = 1 + (k\\pi/2)^2$, $k=1, 2, \\dots$）。因此，其谱的虚部为零（在浮点误差范围内），其条件数虽然随 $N$ 增长（对于此算子通常为 $O(N^4)$），但其行为是可预测的。\n\n**3.2. 方法2：行修改**\n这种方法保留了完整的 $(N+1) \\times (N+1)$ 系统大小。边界条件通过替换矩阵 $A_{\\mathrm{full}}$ 的第一行和最后一行以及右端向量中的相应项来施加。为了求解齐次问题或分析算子谱，我们考虑修改后的矩阵 $A_{\\mathrm{bc}}$：\n$$\nA_{\\mathrm{bc}} =\n\\begin{pmatrix}\n1 & 0 & \\dots & 0 & 0 \\\\\n(A_{\\mathrm{full}})_{1,0} & (A_{\\mathrm{full}})_{1,1} & \\dots & (A_{\\mathrm{full}})_{1,N-1} & (A_{\\mathrm{full}})_{1,N} \\\\\n\\vdots & & \\ddots & & \\vdots \\\\\n(A_{\\mathrm{full}})_{N-1,0} & (A_{\\mathrm{full}})_{N-1,1} & \\dots & (A_{\\mathrm{full}})_{N-1,N-1} & (A_{\\mathrm{full}})_{N-1,N} \\\\\n0 & 0 & \\dots & 0 & 1\n\\end{pmatrix}\n$$\n其中 $(A_{\\mathrm{full}})_{j,k}$ 表示原始完整算子中第 $j$ 行、第 $k$ 列的元素。\n\n### **4. 谱与条件数的分析**\n\n对特征值问题 $A_{\\mathrm{bc}}v = \\lambda v$ 的仔细分析揭示了一种具有迷惑性的关系。该方程的第一行和最后一行分别意味着 $v_0 = \\lambda v_0$ 和 $v_N = \\lambda v_N$。\n- 如果 $\\lambda \\neq 1$，那么必须有 $v_0 = 0$ 和 $v_N = 0$。此时，关于内部分量 $v_{1}, \\dots, v_{N-1}$ 的其余方程就精确地简化为内部矩阵的特征值问题：$A_{\\mathrm{int}}v_{\\mathrm{int}} = \\lambda v_{\\mathrm{int}}$。\n- 如果 $\\lambda = 1$，则条件 $v_0=v_0$ 和 $v_N=v_N$ 显然成立。可以构造两个对应于 $\\lambda=1$ 的线性无关的特征向量。\n\n这证明了 $A_{\\mathrm{bc}}$ 的谱是 $A_{\\mathrm{int}}$ 的谱与在 $\\lambda=1$ 处的二重特征值的并集：\n$$\n\\sigma(A_{\\mathrm{bc}}) = \\sigma(A_{\\mathrm{int}}) \\cup \\{1, 1\\}\n$$\n这意味着两个矩阵的特征值范围及其虚部将几乎相同（因为 $A_{\\mathrm{int}}$ 的最小特征值大于1）。\n\n然而，条件数揭示了不同的情况。2-范数条件数 $\\kappa_2(A) = \\sigma_{\\max}(A)/\\sigma_{\\min}(A)$ 依赖于奇异值，而非特征值。对于非正规矩阵，这两者可能大相径庭。行修改过程使 $A_{\\mathrm{bc}}$ 变得高度非正规。$A_{\\mathrm{bc}}$ 的特征向量变得近乎线性相关，特别是那些与特征值 $\\lambda=1$ 相关的特征向量。特征向量的这种非正交性是非正规性的标志，并导致条件数的爆炸性增长。\n\nCGL 点在边界附近的聚集导致 $A_{\\mathrm{full}}$ 的相应行近乎冗余，这是谱方法中病态的主要来源。行修改方法通过用任意单位向量替换这些敏感行，创建了一个数值上很脆弱的算子。相比之下，内部缩减方法正确地构建了规模更小、性质良好的内部问题，从而带来更优的数值稳定性。因此，比率 $\\kappa_2(A_{\\mathrm{bc}})/\\kappa_2(A_{\\mathrm{int}})$ 将会很大并随 $N$ 快速增长，量化了由行修改引起的稳定性退化。", "answer": "[[16.59132142270921,3.443183186847051,4.818585994808388,1.0,41.52841400346337,3.443183186847051,41.52841400346337,0.0,1.0658141036401503e-14],[209.6133869401799,13.91899120619941,15.06000003055816,1.0,689.8453442387127,3.4640101536838843,689.8453442387127,0.0,2.153833633857509e-13],[3158.005178657685,54.40775984251219,58.04169641773099,1.0,10610.12595604112,3.4641015111956793,10610.12595604112,0.0,2.788574163973688e-12],[49508.49077229154,216.5414848398418,228.63229864239853,1.0,167451.7853680327,3.46410161494025,167451.7853680327,0.0,3.618751108260844e-11]]", "id": "3367677"}]}