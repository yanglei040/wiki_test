{"hands_on_practices": [{"introduction": "本节的第一个实践是奠定理论基础。我们将从第一性原理出发，推导ADM形式中的哈密顿约束和动量约束。随后，通过将这些约束方程应用于最简单的时空——闵可夫斯基时空，我们将验证这个平凡解确实满足约束，从而建立对这些方程正确性的信心。这项练习将加深您对完整的四维爱因斯坦方程与3+1初值问题表述之间联系的理解。[@problem_id:3463150]", "problem": "考虑广义相对论的 Arnowitt-Deser-Misner (ADM) $3+1$ 分解，其中时空被切分为由延展函数 $ \\alpha $、移位矢量 $ \\beta^{i} $、诱导空间度规 $ \\gamma_{ij} $ 和外在曲率 $ K_{ij} $ 表征的空间超曲面 $\\Sigma_{t}$。在真空中，初始数据 $(\\gamma_{ij}, K_{ij})$ 必须满足由爱因斯坦场方程 $ G_{\\mu\\nu} = 8\\pi T_{\\mu\\nu} $（其中 $ T_{\\mu\\nu} = 0 $）所蕴含的约束条件。\n\n从 $3+1$ 分解的基本定义以及爱因斯坦张量沿着 $\\Sigma_{t}$ 的单位法向量 $ n^{\\mu} $ 和 $\\Sigma_{t}$ 上的切向方向的投影出发，利用高斯-科达齐关系推导真空哈密顿约束和动量约束，并用空间里奇标量 $ R $、外在曲率 $ K_{ij} $ 以及与 $ \\gamma_{ij} $ 相容的空间协变导数 $ D_{i} $ 来表示它们。然后，对由 $ \\alpha = 1 $、$ \\beta^{i} = 0 $、$ \\gamma_{ij} = \\delta_{ij} $ 和 $ K_{ij} = 0 $ 在 $ \\mathbb{R}^{3} $ 上指定的闵可夫斯基初始数据，评估这些约束。\n\n将最终结果以单行矩阵的形式给出，其第一个条目是哈密顿约束，接下来的三个条目是动量约束的分量。答案需精确表达，不得四舍五入，不带单位。", "solution": "该问题要求从第一性原理出发，推导真空中的 Arnowitt-Deser-Misner (ADM) 约束方程，然后对一组对应于闵可夫斯基时空的特定初始数据评估这些约束。\n\n作为先决条件，我们首先对问题陈述进行验证。\n\n### 步骤 1：提取已知条件\n- **框架**：时空到空间超曲面 $\\Sigma_t$ 的 ADM $3+1$ 分解。\n- **物理量**：延展函数 $\\alpha$，移位矢量 $\\beta^i$，$\\Sigma_t$ 上的空间度规 $\\gamma_{ij}$，以及 $\\Sigma_t$ 的外在曲率 $K_{ij}$。\n- **物理背景**：真空时空，其中爱因斯坦场方程为 $G_{\\mu\\nu} = 0$。\n- **初始数据**：在给定超曲面上的一对 $(\\gamma_{ij}, K_{ij})$，必须满足约束方程。\n- **推导任务**：使用 $3+1$ 分解的定义、爱因斯坦张量 $G_{\\mu\\nu}$ 的投影以及高斯-科达齐关系来推导哈密顿约束和动量约束方程。\n- **评估任务**：对闵可夫斯基初始数据进行约束评估：$\\alpha=1$, $\\beta^i=0$, $\\gamma_{ij}=\\delta_{ij}$, $K_{ij}=0$。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题定义明确且科学上合理。\n- **科学基础**：ADM 形式、爱因斯坦场方程和高斯-科达齐关系是广义相对论和数值相对论中的基本概念。该问题构成了该领域一个标准的、基本的推导。\n- **适定性**：该推导是一个标准的教科书练习，具有唯一的结果。评估是针对一个特定的、明确定义的案例（闵可夫斯基时空），同样会产生唯一的结果。\n- **客观性**：问题以精确的数学和物理语言陈述，没有歧义或主观因素。\n- **完整性**：推导所需的所有必要定义和起点均已提供，或由标准广义相对论的背景所隐含定义。用于评估的数据是完整的。\n\n### 步骤 3：结论与行动\n该问题被判定为**有效**。将按如下方式提供解答。\n\n### ADM 约束方程的推导\n\nADM 约束是通过将爱因斯坦场方程 $G_{\\mu\\nu} = 0$ 投影到垂直于和切向于空间超曲面 $\\Sigma_t$ 的方向上得到的。$\\Sigma_t$ 的单位法向量记为 $n^\\mu$。\n\n**1. 哈密顿约束**\n\n哈密顿约束来自于爱因斯坦张量完全垂直于超曲面的投影：$G_{\\mu\\nu}n^\\mu n^\\nu = 0$。\n爱因斯坦张量定义为 $G_{\\mu\\nu} = R_{\\mu\\nu} - \\frac{1}{2}g_{\\mu\\nu}R^{(4)}$，其中 $R_{\\mu\\nu}$ 是四维里奇张量，$R^{(4)}$ 是四维里奇标量。使用 $n^\\mu$ 投影此方程，并注意到对于单位法向量 $g_{\\mu\\nu}n^\\mu n^\\nu = -1$（采用 $(-,+,+,+)$ 号差），我们得到：\n$$\nG_{\\mu\\nu}n^\\mu n^\\nu = R_{\\mu\\nu}n^\\mu n^\\nu - \\frac{1}{2}g_{\\mu\\nu}n^\\mu n^\\nu R^{(4)} = R_{\\mu\\nu}n^\\mu n^\\nu + \\frac{1}{2}R^{(4)}\n$$\n为了继续推导，我们引用一个联系四维和三维里奇标量的恒等式，该恒等式本身是高斯方程的一个推论。高斯方程将超曲面的黎曼张量 $R_{ijkl}$ 与四维黎曼张量 $R^{(4)}_{\\alpha\\beta\\gamma\\delta}$ 的投影联系起来：\n$$\nR_{ijkl} = \\gamma_i^\\alpha \\gamma_j^\\beta \\gamma_k^\\gamma \\gamma_l^\\delta R^{(4)}_{\\alpha\\beta\\gamma\\delta} + K_{ik}K_{jl} - K_{il}K_{jk}\n$$\n其中 $\\gamma_i^\\alpha$ 是到超曲面上的投影算子。对此方程进行缩并，并将其与四维里奇张量的各种投影相联系，可得到基本恒等式：\n$$\nR = R^{(4)} + 2 R_{\\mu\\nu}n^\\mu n^\\nu + K_{ij}K^{ij} - K^2\n$$\n其中 $R$ 是空间度规 $\\gamma_{ij}$ 的里奇标量，$K_{ij}$ 是外在曲率，$K = \\gamma^{ij}K_{ij}$ 是其迹。\n从此恒等式中，我们可以表达出 $R_{\\mu\\nu}n^\\mu n^\\nu$ 项：\n$$\n2R_{\\mu\\nu}n^\\mu n^\\nu = R - R^{(4)} - K_{ij}K^{ij} + K^2\n$$\n将此代入 $2G_{\\mu\\nu}n^\\mu n^\\nu = 2R_{\\mu\\nu}n^\\mu n^\\nu + R^{(4)}$ 的表达式中，得到：\n$$\n2G_{\\mu\\nu}n^\\mu n^\\nu = (R - R^{(4)} - K_{ij}K^{ij} + K^2) + R^{(4)} = R + K^2 - K_{ij}K^{ij}\n$$\n真空爱因斯坦方程 $G_{\\mu\\nu}=0$ 意味着 $G_{\\mu\\nu}n^\\mu n^\\nu = 0$。因此，我们得到哈密顿约束方程：\n$$\n\\mathcal{H} \\equiv R + K^2 - K_{ij}K^{ij} = 0\n$$\n\n**2. 动量约束**\n\n动量约束来自于爱因斯坦张量的混合投影，即切向和法向于超曲面：$G_{\\mu\\nu}\\gamma^{i\\mu}n^\\nu = 0$，其中 $\\gamma^{i\\mu}$ 代表与 $\\Sigma_t$ 相切的基向量。\n由于 $n^\\mu$ 与超曲面中的任何向量 $\\gamma^{i\\mu}$ 正交，所以 $g_{\\mu\\nu}\\gamma^{i\\mu}n^\\nu = 0$。因此，爱因斯坦方程的投影简化为：\n$$\nG_{\\mu\\nu}\\gamma^{i\\mu}n^\\nu = R_{\\mu\\nu}\\gamma^{i\\mu}n^\\nu = 0\n$$\n为将其与三维量联系起来，我们使用科达齐方程：\n$$\nD_j K_{ik} - D_k K_{ij} = R^{(4)}_{\\alpha\\beta\\gamma\\delta}n^\\alpha \\gamma_i^\\beta \\gamma_j^\\gamma \\gamma_k^\\delta\n$$\n其中 $D_i$ 是与空间度规 $\\gamma_{ij}$ 相容的协变导数。用 $\\gamma^{jk}$ 对该方程进行缩并，得到：\n$$\n\\gamma^{jk}(D_j K_{ik} - D_k K_{ij}) = \\gamma^{jk} R^{(4)}_{\\alpha\\beta\\gamma\\delta} n^\\alpha \\gamma_i^\\beta \\gamma_j^\\gamma \\gamma_k^\\delta = R^{(4)}_{\\alpha\\beta} n^\\alpha \\gamma_i^\\beta = R_{\\mu\\nu} n^\\mu \\gamma^{i\\nu}\n$$\n左侧可以使用 $D_{j}$ 与 $\\gamma_{ij}$ 相容（即 $D_j \\gamma^{ik}=0$）这一事实进行简化：\n$$\n\\gamma^{jk}(D_j K_{ik} - D_k K_{ij}) = D_j(\\gamma^{jk}K_{ik}) - D_k(\\gamma^{jk}K_{ij})\n$$\n注意到 $K^{ji} = \\gamma^{jk}\\gamma^{il}K_{kl}$ 并且 $K_{ij}$ 是对称的：\n$$\nD_j K^{ji} - D_k K^{ki} = D_j K^{ij} - D_i K\n$$\n这里，我们在第一项中将哑指标 $k$ 重标记为 $j$，提升了指标 $i$，并在第二项中使用了迹的定义 $K = \\gamma^{ki}K_{ki}$，该项变为 $D_i K$。因此，科达齐关系意味着：\n$$\nD_j K^{ij} - \\gamma^{ij} D_j K = R_{\\mu\\nu} n^\\mu \\gamma^{i\\nu}\n$$\n引入逆变形式 $D^i = \\gamma^{ij}D_j$，动量约束 $R_{\\mu\\nu}\\gamma^{i\\mu}n^\\nu = 0$ 变为：\n$$\n\\mathcal{M}^i \\equiv D_j K^{ij} - D^i K = 0\n$$\n这是一组三个方程，每个分量 $i \\in \\{1, 2, 3\\}$ 对应一个方程。\n\n### 对闵可夫斯基初始数据的评估\n\n我们现在使用笛卡尔坐标系下闵可夫斯基时空的初始数据，来评估哈密顿约束 $\\mathcal{H} = R + K^2 - K_{ij}K^{ij}$ 和动量约束 $\\mathcal{M}^i = D_j K^{ij} - D^i K$ 的表达式：\n- 空间度规：$\\gamma_{ij} = \\delta_{ij}$（$\\mathbb{R}^3$ 上的欧几里得度规）。\n- 外在曲率：$K_{ij} = 0$。\n\n**1. 哈密顿约束评估**\n我们评估 $\\mathcal{H}$ 中的每一项：\n- **外在曲率项**：由于 $K_{ij} = 0$，其迹为 $K = \\gamma^{ij}K_{ij} = \\delta^{ij}(0) = 0$。二次项为 $K_{ij}K^{ij} = \\delta^{ik}\\delta^{jl}K_{ij}K_{kl} = \\delta^{ik}\\delta^{jl}(0)(0) = 0$。因此，$K^2 - K_{ij}K^{ij} = 0^2 - 0 = 0$。\n- **空间曲率项**：里奇标量 $R$ 是为度规 $\\gamma_{ij} = \\delta_{ij}$ 计算的。克里斯托费尔符号 $\\Gamma^k_{ij}$ 由 $\\Gamma^k_{ij} = \\frac{1}{2}\\gamma^{kl}(\\partial_i\\gamma_{jl} + \\partial_j\\gamma_{il} - \\partial_l\\gamma_{ij})$ 给出。由于 $\\delta_{ij}$ 是常数，其所有偏导数都为零，这意味着 $\\Gamma^k_{ij} = 0$。黎曼曲率张量分量 $R^i_{jkl}$ 依赖于克里斯托费尔符号的导数，所以 $R^i_{jkl}=0$。因此，里奇张量 $R_{jk} = R^i_{jik} = 0$ 和里奇标量 $R = \\gamma^{jk}R_{jk} = \\delta^{jk}(0) = 0$。\n\n将这些结果代入哈密顿约束表达式：\n$$\n\\mathcal{H} = R + K^2 - K_{ij}K^{ij} = 0 + 0 - 0 = 0\n$$\n\n**2. 动量约束评估**\n我们评估 $\\mathcal{M}^i$ 中的每一项：\n- 由于 $K_{ij} = 0$，我们也有 $K^{ij} = \\gamma^{ik}\\gamma^{jl}K_{kl} = 0$ 和 $K = 0$。\n- 动量约束表达式变为 $\\mathcal{M}^i = D_j (0) - D^i (0)$。\n- 零张量（或常数标量）的协变导数为零。因此，$D_j K^{ij} = 0$ 且 $D^i K = 0$。\n\n将这些结果代入每个分量 $i$ 的动量约束表达式：\n$$\n\\mathcal{M}^i = 0 - 0 = 0\n$$\n\n评估表明，对于给定的闵可夫斯基初始数据，哈密顿约束表达式的计算结果为 $0$，动量约束表达式的所有三个分量的计算结果也为 $0$。这证实了平直时空是爱因斯坦方程的一个有效真空解，正如所预期的那样。评估的结果是一组四个数字。", "answer": "$$ \\boxed{\\begin{pmatrix} 0  0  0  0 \\end{pmatrix}} $$", "id": "3463150"}, {"introduction": "解析地求解ADM方程通常是不可能的，因此数值方法至关重要。这项练习将引导您迈出数值求解的关键第一步：将演化方程中的一个核心项进行离散化。您将推导递减函数 $\\alpha$ 的二阶协变导数 $D_i D_j \\alpha$ 的有限差分近似格式，这是数值相对论代码中一个常见且非平凡的项，并分析其截断误差。[@problem_id:3463131]", "problem": "在广义相对论的Arnowitt–Deser–Misner (ADM) 3+1分解中，外在曲率的演化涉及延展函数$\\alpha$的空间二次协变导数，记为$D_{i}D_{j}\\alpha$，其中$D_{i}$是与空间度规$\\gamma_{ij}$相容的协变导数。考虑一个均匀的笛卡尔坐标网格，在每个坐标方向$x^{1},x^{2},x^{3}$上的间距均为$h$。设$\\alpha(\\mathbf{x})$是在网格点$\\mathbf{x}_{\\mathbf{n}}=\\mathbf{x}_{0}+n_{1}h\\,\\mathbf{e}_{1}+n_{2}h\\,\\mathbf{e}_{2}+n_{3}h\\,\\mathbf{e}_{3}$上采样的一个光滑标量场，其中$\\mathbf{n}=(n_{1},n_{2},n_{3})$是整数多重指标，$\\mathbf{e}_{i}$是单位坐标基向量。假设与$\\gamma_{ij}$相关的克里斯托费尔符号$\\Gamma^{k}{}_{ij}(\\mathbf{x})$在每个网格点上都是已知的，并在离散化中被视为逐点系数。\n\n从基本定义（i）对于标量，$D_{i}\\alpha=\\partial_{i}\\alpha$ 且 $D_{i}D_{j}\\alpha=\\partial_{i}\\partial_{j}\\alpha-\\Gamma^{k}{}_{ij}\\partial_{k}\\alpha$，以及（ii）光滑场在笛卡尔网格上的泰勒定理出发，推导一个在均匀网格上近似$\\mathbf{x}_{\\mathbf{n}}$处$D_{i}D_{j}\\alpha$的二阶精度中心有限差分格式。你的差分格式必须用$\\alpha_{\\mathbf{n}\\pm\\mathbf{e}_{i}}$、$\\alpha_{\\mathbf{n}\\pm\\mathbf{e}_{i}\\pm\\mathbf{e}_{j}}$、网格间距$h$、克罗内克δ符号$\\delta_{ij}$以及克里斯托费尔符号$\\Gamma^{k}{}_{ij}(\\mathbf{x}_{\\mathbf{n}})$显式表示。然后，计算在$\\mathbf{x}_{\\mathbf{n}}$处的主阶截断误差，用$h$和在$\\mathbf{x}_{\\mathbf{n}}$处计算的$\\alpha$的空间导数表示，并清楚地指明其对$i=j$或$i\\neq j$的依赖关系。\n\n将你的最终答案表示为封闭形式的解析表达式。不要提供任何数值近似，也不要包含单位。如果得出多个最终表达式，请使用$\\LaTeX$的$\\texttt{pmatrix}$环境将它们表示为单行矩阵的条目。爱因斯坦求和约定仅对重复指标$k$使用，$i$和$j$是固定的。", "solution": "题目陈述待验证。\n\n### 第1步：提取已知条件\n- **框架**：广义相对论的Arnowitt–Deser–Misner (ADM) 3+1分解。\n- **研究对象**：$D_{i}D_{j}\\alpha$，延展函数$\\alpha$的空间二次协变导数。$D_i$是与空间度规$\\gamma_{ij}$相容的协变导数。\n- **网格**：在$x^1, x^2, x^3$方向上间距为$h$的均匀笛卡尔坐标网格。\n- **场采样**：在网格点$\\mathbf{x}_{\\mathbf{n}}=\\mathbf{x}_{0}+n_{1}h\\,\\mathbf{e}_{1}+n_{2}h\\,\\mathbf{e}_{2}+n_{3}h\\,\\mathbf{e}_{3}$上采样的光滑标量场$\\alpha(\\mathbf{x})$。\n- **系数**：克里斯托费尔符号$\\Gamma^{k}{}_{ij}(\\mathbf{x})$在每个网格点上都是已知的。\n- **定义 (i)**：对于标量$\\alpha$，$D_{i}\\alpha=\\partial_{i}\\alpha$。\n- **定义 (ii)**：二次协变导数为$D_{i}D_{j}\\alpha=\\partial_{i}\\partial_{j}\\alpha-\\Gamma^{k}{}_{ij}\\partial_{k}\\alpha$。对指标$k$使用爱因斯坦求和约定。\n- **工具**：泰勒定理。\n- **任务1**：推导在$\\mathbf{x}_{\\mathbf{n}}$处$D_{i}D_{j}\\alpha$的二阶精度中心有限差分格式。\n- **任务2**：计算在$\\mathbf{x}_{\\mathbf{n}}$处的主阶截断误差。\n- **输出要求**：差分格式必须用邻近网格点上的$\\alpha$（例如，$\\alpha_{\\mathbf{n}\\pm\\mathbf{e}_{i}}$, $\\alpha_{\\mathbf{n}\\pm\\mathbf{e}_{i}\\pm\\mathbf{e}_{j}}$）、$h$、$\\delta_{ij}$和$\\Gamma^{k}{}_{ij}(\\mathbf{x}_{\\mathbf{n}})$显式表示。截断误差分析必须区分$i=j$和$i\\neq j$两种情况。\n\n### 第2步：使用提取的已知条件进行验证\n- **科学依据**：该问题正确定位于广义相对论的ADM形式体系内，并使用了标量场协变导数的标准定义。有限差分法是物理学中偏微分方程数值解的基石。该问题在科学和数学上是合理的。\n- **适定性**：该问题是适定的。它要求在给定清晰的起点和一组约束条件的情况下，推导一个标准的数值近似及其误差项。所有必要信息都已提供。预期会有一个唯一且有意义的解。\n- **客观性**：该问题以精确、客观和技术性的语言陈述，不含任何主观或非科学内容。\n\n### 第3步：结论与行动\n该问题是**有效的**。这是一个将数值方法应用于广义相对论的标准、适定的练习。将推导解答。\n\n### 解答推导\n\n目标是寻找在网格点$\\mathbf{x}_{\\mathbf{n}}$处$D_{i}D_{j}\\alpha$的二阶精度有限差分近似。控制方程为：\n$$\nD_{i}D_{j}\\alpha = \\partial_{i}\\partial_{j}\\alpha - \\Gamma^{k}{}_{ij}\\partial_{k}\\alpha\n$$\n这将通过为偏导数项$\\partial_{k}\\alpha$和$\\partial_{i}\\partial_{j}\\alpha$推导二阶精度中心有限差分格式来完成。我们将$\\alpha(\\mathbf{x}_{\\mathbf{n}})$记为$\\alpha_{\\mathbf{n}}$，将$\\alpha(\\mathbf{x}_{\\mathbf{n}} \\pm h\\mathbf{e}_{i})$记为$\\alpha_{\\mathbf{n}\\pm\\mathbf{e}_{i}}$，等等。除非另有说明，$\\alpha$的所有导数和克里斯托费尔符号$\\Gamma^{k}{}_{ij}$都在点$\\mathbf{x}_{\\mathbf{n}}$处计算。\n\n**1. 一阶导数$\\partial_{k}\\alpha$的有限差分近似**\n\n使用泰勒定理，我们将$\\alpha$在$\\mathbf{x}_{\\mathbf{n}}$点沿第$k$个坐标方向展开：\n$$\n\\alpha_{\\mathbf{n}+\\mathbf{e}_k} = \\alpha_{\\mathbf{n}} + h\\partial_k\\alpha + \\frac{h^2}{2!}\\partial_k^2\\alpha + \\frac{h^3}{3!}\\partial_k^3\\alpha + O(h^4)\n$$\n$$\n\\alpha_{\\mathbf{n}-\\mathbf{e}_k} = \\alpha_{\\mathbf{n}} - h\\partial_k\\alpha + \\frac{h^2}{2!}\\partial_k^2\\alpha - \\frac{h^3}{3!}\\partial_k^3\\alpha + O(h^4)\n$$\n将第二个展开式从第一个展开式中减去，并求解$\\partial_k\\alpha$，得到中心差分公式：\n$$\n\\alpha_{\\mathbf{n}+\\mathbf{e}_k} - \\alpha_{\\mathbf{n}-\\mathbf{e}_k} = 2h\\partial_k\\alpha + \\frac{h^3}{3}\\partial_k^3\\alpha + O(h^5)\n$$\n$$\n\\partial_k\\alpha = \\frac{\\alpha_{\\mathbf{n}+\\mathbf{e}_k} - \\alpha_{\\mathbf{n}-\\mathbf{e}_k}}{2h} - \\frac{h^2}{6}\\partial_k^3\\alpha + O(h^4)\n$$\n因此，二阶精度的差分格式为：\n$$\n(FD[\\partial_{k}\\alpha])_{\\mathbf{n}} = \\frac{\\alpha_{\\mathbf{n}+\\mathbf{e}_k} - \\alpha_{\\mathbf{n}-\\mathbf{e}_k}}{2h}\n$$\n该近似的主阶截断误差为$-\\frac{h^2}{6}\\partial_k^3\\alpha$。\n\n**2. 二阶导数$\\partial_{i}\\partial_{j}\\alpha$的有限差分近似**\n\n我们必须考虑两种独立情况：对角项（$i=j$）和非对角项（$i \\neq j$）。\n\n**情况A：对角项（$i=j$）**\n\n我们寻求$\\partial_i^2\\alpha$的近似。将$\\alpha_{\\mathbf{n}+\\mathbf{e}_i}$和$\\alpha_{\\mathbf-n}-\\mathbf{e}_i$的泰勒展开式相加：\n$$\n\\alpha_{\\mathbf{n}+\\mathbf{e}_i} + \\alpha_{\\mathbf{n}-\\mathbf{e}_i} = 2\\alpha_{\\mathbf{n}} + h^2\\partial_i^2\\alpha + \\frac{h^4}{12}\\partial_i^4\\alpha + O(h^6)\n$$\n求解$\\partial_i^2\\alpha$：\n$$\n\\partial_i^2\\alpha = \\frac{\\alpha_{\\mathbf{n}+\\mathbf{e}_i} - 2\\alpha_{\\mathbf{n}} + \\alpha_{\\mathbf{n}-\\mathbf{e}_i}}{h^2} - \\frac{h^2}{12}\\partial_i^4\\alpha + O(h^4)\n$$\n二阶非混合偏导数的二阶精度差分格式为：\n$$\n(FD[\\partial_{i}^{2}\\alpha])_{\\mathbf{n}} = \\frac{\\alpha_{\\mathbf{n}+\\mathbf{e}_i} - 2\\alpha_{\\mathbf{n}} + \\alpha_{\\mathbf{n}-\\mathbf{e}_i}}{h^2}\n$$\n主阶截断误差为$-\\frac{h^2}{12}\\partial_i^4\\alpha$。\n\n**情况B：非对角项（$i \\neq j$）**\n\n我们寻求混合偏导数$\\partial_i\\partial_j\\alpha$的近似。我们使用涉及点$\\mathbf{x}_{\\mathbf{n}} \\pm h\\mathbf{e}_i \\pm h\\mathbf{e}_j$的二维泰勒展开：\n$$\n\\alpha(\\mathbf{x}_{\\mathbf{n}}+h_i\\mathbf{e}_i+h_j\\mathbf{e}_j) = \\sum_{p=0}^{\\infty} \\frac{1}{p!} (h_i\\partial_i + h_j\\partial_j)^p \\alpha\n$$\n设$h_i = sh$和$h_j=th$，其中$s,t\\in\\{-1,1\\}$，我们构造如下组合：\n$$\n\\alpha_{\\mathbf{n}+\\mathbf{e}_i+\\mathbf{e}_j} - \\alpha_{\\mathbf{n}+\\mathbf{e}_i-\\mathbf{e}_j} - \\alpha_{\\mathbf{n}-\\mathbf{e}_i+\\mathbf{e}_j} + \\alpha_{\\mathbf{n}-\\mathbf{e}_i-\\mathbf{e}_j}\n$$\n按$h$的幂次展开：\n- $O(1)$阶：$\\alpha_{\\mathbf{n}}-\\alpha_{\\mathbf{n}}-\\alpha_{\\mathbf{n}}+\\alpha_{\\mathbf{n}} = 0$。\n- $O(h)$阶：$h[(\\partial_i+\\partial_j) - (\\partial_i-\\partial_j) - (-\\partial_i+\\partial_j) + (-\\partial_i-\\partial_j)]\\alpha = 0$。\n- $O(h^2)$阶：$\\frac{h^2}{2}[(\\partial_i+\\partial_j)^2 - (\\partial_i-\\partial_j)^2 - (-\\partial_i+\\partial_j)^2 + (-\\partial_i-\\partial_j)^2]\\alpha = \\frac{h^2}{2}[8\\partial_i\\partial_j]\\alpha = 4h^2\\partial_i\\partial_j\\alpha$。\n- $O(h^3)$阶：由于对称性，所有项都抵消了。\n- $O(h^4)$阶：$\\frac{h^4}{24}[(\\partial_i+\\partial_j)^4 - (\\partial_i-\\partial_j)^4 - (-\\partial_i+\\partial_j)^4 + (-\\partial_i-\\partial_j)^4]\\alpha = \\frac{h^4}{24}[16(\\partial_i^3\\partial_j+\\partial_i\\partial_j^3)]\\alpha = \\frac{2h^4}{3}(\\partial_i^3\\partial_j + \\partial_i\\partial_j^3)\\alpha$。\n因此我们有：\n$$\n\\alpha_{\\mathbf{n}+\\mathbf{e}_i+\\mathbf{e}_j} - \\dots + \\alpha_{\\mathbf{n}-\\mathbf{e}_i-\\mathbf{e}_j} = 4h^2\\partial_i\\partial_j\\alpha + \\frac{2h^4}{3}(\\partial_i^3\\partial_j + \\partial_i\\partial_j^3)\\alpha + O(h^6)\n$$\n求解$\\partial_i\\partial_j\\alpha$：\n$$\n\\partial_i\\partial_j\\alpha = \\frac{\\alpha_{\\mathbf{n}+\\mathbf{e}_i+\\mathbf{e}_j} - \\alpha_{\\mathbf{n}+\\mathbf{e}_i-\\mathbf{e}_j} - \\alpha_{\\mathbf{n}-\\mathbf{e}_i+\\mathbf{e}_j} + \\alpha_{\\mathbf{n}-\\mathbf{e}_i-\\mathbf{e}_j}}{4h^2} - \\frac{h^2}{6}(\\partial_i^3\\partial_j + \\partial_i\\partial_j^3)\\alpha + O(h^4)\n$$\n混合偏导数的二阶精度差分格式为：\n$$\n(FD[\\partial_{i}\\partial_{j}\\alpha])_{\\mathbf{n}} = \\frac{\\alpha_{\\mathbf{n}+\\mathbf{e}_i+\\mathbf{e}_j} - \\alpha_{\\mathbf{n}+\\mathbf{e}_i-\\mathbf{e}_j} - \\alpha_{\\mathbf{n}-\\mathbf{e}_i+\\mathbf{e}_j} + \\alpha_{\\mathbf{n}-\\mathbf{e}_i-\\mathbf{e}_j}}{4h^2}\n$$\n主阶截断误差为$-\\frac{h^2}{6}(\\partial_i^3\\partial_j + \\partial_i\\partial_j^3)\\alpha$。\n\n**3. 组合$D_i D_j \\alpha$的完整差分格式**\n\n我们使用克罗内克δ符号$\\delta_{ij}$来组合这些差分格式，以创建一个对$i=j$和$i \\neq j$都有效的单一表达式。$D_{i}D_{j}\\alpha$的有限差分近似，记为$(D_iD_j\\alpha)_{\\mathbf{n}}^{FD}$，是：\n$$\n(D_iD_j\\alpha)_{\\mathbf{n}}^{FD} = (FD[\\partial_i\\partial_j\\alpha])_{\\mathbf{n}} - \\Gamma^k{}_{ij}(\\mathbf{x}_{\\mathbf{n}}) (FD[\\partial_k\\alpha])_{\\mathbf{n}}\n$$\n代入推导出的差分格式，得到差分格式的最终表达式：\n$$\n(D_iD_j\\alpha)_{\\mathbf{n}}^{FD} = \\delta_{ij} \\frac{\\alpha_{\\mathbf{n}+\\mathbf{e}_i} - 2\\alpha_{\\mathbf{n}} + \\alpha_{\\mathbf{n}-\\mathbf{e}_i}}{h^2} + (1-\\delta_{ij}) \\frac{\\alpha_{\\mathbf{n}+\\mathbf{e}_i+\\mathbf{e}_j} - \\alpha_{\\mathbf{n}+\\mathbf{e}_i-\\mathbf{e}_j} - \\alpha_{\\mathbf{n}-\\mathbf{e}_i+\\mathbf{e}_j} + \\alpha_{\\mathbf{n}-\\mathbf{e}_i-\\mathbf{e}_j}}{4h^2} - \\Gamma^k{}_{ij} \\frac{\\alpha_{\\mathbf{n}+\\mathbf{e}_k} - \\alpha_{\\mathbf{n}-\\mathbf{e}_k}}{2h}\n$$\n这就是所要求的二阶精度中心有限差分格式。对重复指标$k$进行了隐式求和。\n\n**4. 主阶截断误差的推导**\n\n截断误差$\\mathcal{T}_{ij}$是精确导数与其有限差分近似之间的差值，即$\\mathcal{T}_{ij} = D_iD_j\\alpha - (D_iD_j\\alpha)_{\\mathbf{n}}^{FD}$。该误差的主阶项为$O(h^2)$。\n$$\n\\mathcal{T}_{ij} = (\\partial_i\\partial_j\\alpha - (FD[\\partial_i\\partial_j\\alpha])_{\\mathbf{n}}) - \\Gamma^k{}_{ij} (\\partial_k\\alpha - (FD[\\partial_k\\alpha])_{\\mathbf{n}})\n$$\n我们代入先前推导的主阶误差项：\n$$\n\\mathcal{T}_{ij} \\approx (\\text{来自}\\partial_i\\partial_j\\text{的误差}) - \\Gamma^k{}_{ij}(\\text{来自}\\partial_k\\text{的误差})\n$$\n对于$i=j$：\n$$\n\\mathcal{T}_{ii} \\approx \\left(-\\frac{h^2}{12}\\partial_i^4\\alpha\\right) - \\Gamma^k{}_{ii}\\left(-\\frac{h^2}{6}\\partial_k^3\\alpha\\right) = \\frac{h^2}{12}(2\\Gamma^k{}_{ii}\\partial_k^3\\alpha - \\partial_i^4\\alpha)\n$$\n（不对$i$求和，但对$k$的求和是隐式的）。\n\n对于$i \\neq j$：\n$$\n\\mathcal{T}_{ij} \\approx \\left(-\\frac{h^2}{6}(\\partial_i^3\\partial_j\\alpha + \\partial_i\\partial_j^3\\alpha)\\right) - \\Gamma^k{}_{ij}\\left(-\\frac{h^2}{6}\\partial_k^3\\alpha\\right) = \\frac{h^2}{6}(\\Gamma^k{}_{ij}\\partial_k^3\\alpha - \\partial_i^3\\partial_j\\alpha - \\partial_i\\partial_j^3\\alpha)\n$$\n（对$k$的求和是隐式的）。\n\n这两个表达式给出了主阶截断误差，其量级为$O(h^2)$。我们可以将它们组合成一个单一的表达式作为最终答案。\n最终答案是统一的差分格式和统一的主阶截断误差表达式。让我们将差分格式表示为$(D_iD_j\\alpha)^{FD}_{\\mathbf{n}}$，将主阶截断误差表示为$\\mathcal{T}_{ij}$。", "answer": "$$ \\boxed{ \\begin{pmatrix} \\delta_{ij} \\frac{\\alpha_{\\mathbf{n}+\\mathbf{e}_i} - 2\\alpha_{\\mathbf{n}} + \\alpha_{\\mathbf{n}-\\mathbf{e}_i}}{h^2} + (1-\\delta_{ij}) \\frac{\\alpha_{\\mathbf{n}+\\mathbf{e}_i+\\mathbf{e}_j} - \\alpha_{\\mathbf{n}+\\mathbf{e}_i-\\mathbf{e}_j} - \\alpha_{\\mathbf{n}-\\mathbf{e}_i+\\mathbf{e}_j} + \\alpha_{\\mathbf{n}-\\mathbf{e}_i-\\mathbf{e}_j}}{4h^2} - \\Gamma^k{}_{ij} \\frac{\\alpha_{\\mathbf{n}+\\mathbf{e}_k} - \\alpha_{\\mathbf{n}-\\mathbf{e}_k}}{2h}  \\delta_{ij}\\frac{h^2}{12}(2\\Gamma^k{}_{ii}\\partial_k^3\\alpha - \\partial_i^4\\alpha) + (1-\\delta_{ij})\\frac{h^2}{6}(\\Gamma^k{}_{ij}\\partial_k^3\\alpha - \\partial_i^3\\partial_j\\alpha - \\partial_i\\partial_j^3\\alpha) \\end{pmatrix} } $$", "id": "3463131"}, {"introduction": "标准的ADM方程组在数值求解时存在与约束违背相关的稳定性问题。最后一个实践提供了一个简化的编码练习，让您亲身体验这一现象。通过比较一个简化的ADM演化模型和一个更稳定的BSSN演化模型，您将定量地测量约束在前一个模型中如何失控增长，而在后一个模型中如何被有效地传播消除，从而揭示现代重构方案的实际重要性。[@problem_id:3463146]", "problem": "考虑一个一维平面-对称的爱因斯坦-克莱因-戈尔登系统，该系统采用 Arnowitt–Deser–Misner (ADM) 3+1 分解，并具有与 Baumgarte–Shapiro–Shibata–Nakamura (BSSN) 形式相同的规范条件。使用固定的切片和移位，具体来说是单位延展函数和零移位矢量，即 $\\alpha = 1$ 和 $\\beta^i = 0$。在几何单位制中进行计算，其中 $G = c = 1$，因此所有量都是无量纲的。标量场是一个最小耦合的无质量场，具有标准的应力-能量张量。我们专注于在相同规范下，ADM 和 BSSN 的简化线性化模型中约束违背的传播。\n\n基本基础：\n- 爱因斯坦场方程 $G_{ab} = 8\\pi T_{ab}$，其中 $T_{ab}$ 是无质量标量场 $\\phi$ 的应力-能量张量，3+1 分裂产生 ADM 演化方程和约束。\n- ADM 中的哈密顿约束 $\\mathcal{H}$ 和动量约束 $\\mathcal{M}^i$ 的定义，以及由 BSSN 变量重新定义和约束的附加双曲耦合导致的约束传播的质的差异。\n- 标量场在弯曲时空中服从克莱因-戈尔登方程。在围绕闵可夫斯基时空的弱场线性化区域，且 $\\alpha=1$、$\\beta^i=0$ 的情况下，标量场动力学可以近似为一维波动方程。\n\n设置和推导目标：\n1. 定义 3+1 分裂和约束。空间度规为 $g_{ij}$，外在曲率为 $K_{ij}$，哈密顿约束为 $\\mathcal{H} \\equiv R + K^2 - K_{ij}K^{ij} - 16\\pi \\rho$，动量约束为 $\\mathcal{M}^i \\equiv D_j(K^{ij} - g^{ij}K) - 8\\pi S^i$，其中 $R$ 是 $g_{ij}$ 的里奇标量，$D_j$ 是与 $g_{ij}$ 相关的协变导数，$K \\equiv g^{ij}K_{ij}$，$\\rho$ 是能量密度，$S^i$ 是动量密度，两者都由正交观测者测量。在一维空间且具有平面对称性的情况下，只有 $x$ 分量非平凡，我们记为 $\\mathcal{M} \\equiv \\mathcal{M}^x$。\n2. 在相同规范 $\\alpha=1$、$\\beta^i=0$ 下，对弱场极限中的标量场动力学进行建模。在此区域，忽略一阶反作用，标量场演化简化为一维波动方程 $\\partial_t^2 \\phi = \\partial_x^2 \\phi$，其正则共轭动量为 $\\pi \\equiv \\partial_t \\phi$。\n3. 构建代表一个入射局域脉冲的初始数据。设 $\\phi(x,0) = A \\exp\\left(-\\frac{(x-x_0)^2}{2\\sigma^2}\\right)$ 和 $\\pi(x,0) = -\\partial_x \\phi(x,0)$，这样初始标量场主要是向右移动的。\n4. 使用标量场初始数据以及弱场极限中能量和动量密度的定义，将 $t=0$ 时的约束违背初始化为 $\\mathcal{H}(x,0) = -16\\pi \\rho(x,0)$ 和 $\\mathcal{M}(x,0) = -8\\pi S(x,0)$，其中 $\\rho(x,0) = \\frac{1}{2}\\left(\\pi(x,0)^2 + (\\partial_x \\phi(x,0))^2\\right)$ 且 $S(x,0) = \\pi(x,0)\\,\\partial_x \\phi(x,0)$。\n5. 在相同规范下推导简化的、线性化的约束传播模型：\n   - 对于 ADM，线性化的约束传播表现出零速模式。在一个仅包含人工粘性以表示网格尺度耗散的最小数值模型中，取\n     $$\\partial_t \\mathcal{H} = \\nu\\,\\partial_x^2 \\mathcal{H},\\quad \\partial_t \\mathcal{M} = \\nu\\,\\partial_x^2 \\mathcal{M},$$\n     其中 $\\nu  0$ 是一个模拟数值耗散的小扩散系数。\n   - 对于 BSSN，重新排列的变量引起了约束的双曲传播。在一个具有相同人工粘性的最小线性化模型中，取\n     $$\\partial_t \\mathcal{H} = \\partial_x \\mathcal{M} + \\nu\\,\\partial_x^2 \\mathcal{H},\\quad \\partial_t \\mathcal{M} = \\partial_x \\mathcal{H} + \\nu\\,\\partial_x^2 \\mathcal{M}。$$\n   这些模型共享相同的规范和耗散，但区别在于约束是否具有双曲输运耦合。\n6. 在周期性区域 $x \\in [0,L]$（其中 $L=1$）上对标量场和约束进行数值演化。使用一个包含 $N$ 个点的均匀网格，网格间距为 $\\Delta x = L/N$，并采用显式四阶龙格-库塔方法，时间步长为 $\\Delta t = \\lambda\\,\\Delta x$，其中 $0  \\lambda \\leq 1$ 是库朗因子。演化至最终时间 $T=0.5$。\n7. 对于每种形式（ADM 和 BSSN），计算归一化的哈密顿约束增长因子，\n   $$G_{\\mathcal{H}} \\equiv \\frac{\\|\\mathcal{H}(\\cdot,T)\\|_2}{\\|\\mathcal{H}(\\cdot,0)\\|_2},$$\n   其中 $\\|\\cdot\\|_2$ 表示离散 $L^2$ 范数，定义为 $\\|u\\|_2 = \\sqrt{\\Delta x \\sum_j u_j^2}$。通过比率比较约束增长：\n   $$R \\equiv \\frac{G_{\\mathcal{H}}^{\\text{ADM}}}{G_{\\mathcal{H}}^{\\text{BSSN}}}。$$\n   在所选单位下，所有量都是无量纲的。\n\n算法要求：\n- 对空间导数 $\\partial_x$ 和 $\\partial_x^2$ 使用二阶中心有限差分，并采用周期性边界条件。\n- 对所有情况使用单一的人工粘性系数 $\\nu = 10^{-4}$。\n- 并行演化标量场系统 $\\partial_t \\phi = \\pi$、$\\partial_t \\pi = \\partial_x^2 \\phi$ 和约束，尽管约束模型仅依赖于其自身的场。\n- 通过使用 $\\Delta t = \\lambda\\,\\Delta x$ 且 $\\lambda \\leq 1$ 来确保数值稳定性。\n\n测试套件：\n提供以下四个测试用例，每个用例指定为 $(A,N,\\lambda)$，其中 $L=1$, $\\sigma = 0.05$, $x_0 = 0.3$, $T=0.5$, 且 $\\nu = 10^{-4}$：\n- 用例 1 (理想情况): $(A=10^{-2}, N=512, \\lambda=0.5)$。\n- 用例 2 (接近库朗边界): $(A=10^{-2}, N=256, \\lambda=0.9)$。\n- 用例 3 (低振幅): $(A=10^{-4}, N=512, \\lambda=0.5)$。\n- 用例 4 (粗网格): $(A=10^{-2}, N=128, \\lambda=0.6)$。\n\n要求的最终输出格式：\n您的程序应生成单行输出，包含一个用方括号括起来的逗号分隔列表（例如，“[result1,result2,result3,result4]”）。对于每个测试用例，输出上面定义的标量浮点数 $R$，采用默认的浮点打印方式进行四舍五入。输出中不出现角度或物理单位，因为在指定的几何单位制下所有量都是无量纲的。", "solution": "用户提供的问题经评估有效。它在科学上基于数值相对论的原理，特别是爱因斯坦方程的 ADM 和 BSSN 形式。该问题是适定的，提供了一套完整的初边值问题，包含所有必要的参数和数值规范。语言客观，设置可以形式化为计算任务。没有矛盾、歧义或依赖于伪科学。该问题提出了一个简化但概念上合理的模型，用以研究现代数值相对论形式的一个关键特征——约束违背的行为。\n\n此处提供一个详细的解决方案，遵循指定的算法设计。\n\n### 1. 初始状态和问题设置\n\n问题定义在一维周期性区域 $x \\in [0, L]$ 上，其中 $L=1$。基本变量在一个包含 $N$ 个点的均匀网格上进行演化，记为 $x_j=j \\Delta x$，$j=0, 1, \\dots, N-1$，其中网格间距为 $\\Delta x = L/N$。\n\n系统的初始状态由一个无质量标量场 $\\phi$ 决定。$\\phi$ 的初始轮廓是一个高斯脉冲：\n$$\n\\phi(x,0) = A \\exp\\left(-\\frac{(x-x_0)^2}{2\\sigma^2}\\right)\n$$\n问题指定初始数据应代表一个主要向右移动的脉冲。这通过将标量场的时间导数，即其共轭动量 $\\pi \\equiv \\partial_t \\phi$，设置为 $\\pi(x,0) = -\\partial_x \\phi(x,0)$ 来实现。其解析导数为：\n$$\n\\partial_x \\phi(x,0) = A \\exp\\left(-\\frac{(x-x_0)^2}{2\\sigma^2}\\right) \\left(-\\frac{x-x_0}{\\sigma^2}\\right) = -\\frac{x-x_0}{\\sigma^2} \\phi(x,0)\n$$\n因此，初始共轭动量为：\n$$\n\\pi(x,0) = \\frac{x-x_0}{\\sigma^2} \\phi(x,0)\n$$\n在弱场极限中，由正交观测者（其延展函数为 $\\alpha=1$，移位矢量为 $\\beta^i=0$）测量的能量密度 $\\rho$ 和动量密度 $S$ 由以下公式给出：\n$$\n\\rho(x,0) = \\frac{1}{2}\\left(\\pi(x,0)^2 + (\\partial_x \\phi(x,0))^2\\right)\n$$\n$$\nS(x,0) = \\pi(x,0) \\partial_x \\phi(x,0)\n$$\n问题陈述，时空度规和外在曲率的初始构型被选择为使得 ADM 约束的几何部分为零。违背完全由物质场引起。因此，初始约束值为：\n$$\n\\mathcal{H}(x,0) = -16\\pi \\rho(x,0) = -8\\pi \\left(\\pi(x,0)^2 + (\\partial_x \\phi(x,0))^2\\right)\n$$\n$$\n\\mathcal{M}(x,0) = -8\\pi S(x,0) = -8\\pi \\pi(x,0) \\partial_x \\phi(x,0)\n$$\n根据我们对 $\\pi(x,0) = -\\partial_x \\phi(x,0)$ 的选择，这些简化为：\n$$\n\\rho(x,0) = (\\partial_x \\phi(x,0))^2 \\quad \\text{和} \\quad S(x,0) = -(\\partial_x \\phi(x,0))^2\n$$\n$$\n\\mathcal{H}(x,0) = -16\\pi (\\partial_x \\phi(x,0))^2 \\quad \\text{和} \\quad \\mathcal{M}(x,0) = 8\\pi (\\partial_x \\phi(x,0))^2\n$$\n\n### 2. 演化方程\n\n我们求解三个独立的偏微分方程组。\n\n**a) 标量场：** 标量场根据一维波动方程演化，写成一阶系统：\n$$\n\\partial_t \\phi = \\pi\n$$\n$$\n\\partial_t \\pi = \\partial_x^2 \\phi\n$$\n\n**b) 简化的 ADM 约束传播：** ADM 约束作为两个解耦的扩散（热）方程演化，其中 $\\nu$ 代表模拟数值耗散的人工粘性系数。\n$$\n\\partial_t \\mathcal{H}^{\\text{ADM}} = \\nu\\,\\partial_x^2 \\mathcal{H}^{\\text{ADM}}\n$$\n$$\n\\partial_t \\mathcal{M}^{\\text{ADM}} = \\nu\\,\\partial_x^2 \\mathcal{M}^{\\text{ADM}}\n$$\n该模型捕捉了这样一个事实：在标准 ADM 形式中，约束违背不会传播，其增长由局部项和数值耗散控制。\n\n**c) 简化的 BSSN 约束传播：** BSSN 模型引入了双曲项，耦合了哈密顿约束和动量约束。这导致了约束传播，这是改善数值模拟稳定性的一个关键特性。\n$$\n\\partial_t \\mathcal{H}^{\\text{BSSN}} = \\partial_x \\mathcal{M}^{\\text{BSSN}} + \\nu\\,\\partial_x^2 \\mathcal{H}^{\\text{BSSN}}\n$$\n$$\n\\partial_t \\mathcal{M}^{\\text{BSSN}} = \\partial_x \\mathcal{H}^{\\text{BSSN}} + \\nu\\,\\partial_x^2 \\mathcal{M}^{\\text{BSSN}}\n$$\n两个约束系统都从相同的初始数据开始：$\\mathcal{H}^{\\text{ADM}}(x,0) = \\mathcal{H}^{\\text{BSSN}}(x,0) = \\mathcal{H}(x,0)$ 和 $\\mathcal{M}^{\\text{ADM}}(x,0) = \\mathcal{M}^{\\text{BSSN}}(x,0) = \\mathcal{M}(x,0)$。\n\n### 3. 数值方法\n\n**a) 空间离散化：** 我们在网格 $x_j$ 上对空间导数使用二阶中心有限差分。对于一个通用场 $u_j = u(x_j)$，其导数近似为：\n$$\n(\\partial_x u)_j \\approx \\frac{u_{j+1} - u_{j-1}}{2\\Delta x}\n$$\n$$\n(\\partial_x^2 u)_j \\approx \\frac{u_{j+1} - 2u_j + u_{j-1}}{(\\Delta x)^2}\n$$\n施加周期性边界条件，意味着索引是对 $N$ 取模计算的。例如，$u_{N} = u_0$ 和 $u_{-1} = u_{N-1}$。\n\n**b) 时间积分：** 通过空间离散化得到的常微分方程组使用显式四阶龙格-库塔 (RK4) 方法进行时间演化。对于形如 $\\frac{d\\mathbf{y}}{dt} = \\mathbf{F}(t, \\mathbf{y})$ 的方程，从 $t_n$ 到 $t_{n+1} = t_n + \\Delta t$ 的单个时间步计算如下：\n$$\n\\mathbf{k}_1 = \\Delta t \\, \\mathbf{F}(t_n, \\mathbf{y}_n)\n$$\n$$\n\\mathbf{k}_2 = \\Delta t \\, \\mathbf{F}(t_n + \\frac{\\Delta t}{2}, \\mathbf{y}_n + \\frac{\\mathbf{k}_1}{2})\n$$\n$$\n\\mathbf{k}_3 = \\Delta t \\, \\mathbf{F}(t_n + \\frac{\\Delta t}{2}, \\mathbf{y}_n + \\frac{\\mathbf{k}_2}{2})\n$$\n$$\n\\mathbf{k}_4 = \\Delta t \\, \\mathbf{F}(t_n + \\Delta t, \\mathbf{y}_n + \\mathbf{k}_3)\n$$\n$$\n\\mathbf{y}_{n+1} = \\mathbf{y}_n + \\frac{1}{6}(\\mathbf{k}_1 + 2\\mathbf{k}_2 + 2\\mathbf{k}_3 + \\mathbf{k}_4)\n$$\n此过程独立应用于标量场 $(\\phi, \\pi)$、ADM 约束 $(\\mathcal{H}^{\\text{ADM}}, \\mathcal{M}^{\\text{ADM}})$ 和 BSSN 约束 $(\\mathcal{H}^{\\text{BSSN}}, \\mathcal{M}^{\\text{BSSN}})$ 的状态向量。时间步长为 $\\Delta t = \\lambda \\Delta x$，库朗因子 $\\lambda \\leq 1$ 以确保系统双曲部分的数值稳定性。总步数为 $N_{steps} = \\text{int}(T/\\Delta t)$。\n\n### 4. 分析与比较\n\n在将系统演化到最终时间 $T=0.5$ 后，我们量化哈密顿约束违背的增长。首先，我们计算网格上场 $u$ 的离散 $L^2$ 范数：\n$$\n\\|u\\|_2 = \\sqrt{\\Delta x \\sum_{j=0}^{N-1} u_j^2}\n$$\n每种形式中哈密顿约束的归一化增长因子定义为：\n$$\nG_{\\mathcal{H}}^{\\text{ADM}} = \\frac{\\|\\mathcal{H}^{\\text{ADM}}(\\cdot, T)\\|_2}{\\|\\mathcal{H}(\\cdot, 0)\\|_2} \\quad \\text{和} \\quad G_{\\mathcal{H}}^{\\text{BSSN}} = \\frac{\\|\\mathcal{H}^{\\text{BSSN}}(\\cdot, T)\\|_2}{\\|\\mathcal{H}(\\cdot, 0)\\|_2}\n$$\n用于比较的最终度量是这些增长因子的比率：\n$$\nR = \\frac{G_{\\mathcal{H}}^{\\text{ADM}}}{G_{\\mathcal{H}}^{\\text{BSSN}}}\n$$\n$R > 1$ 的值表明，在指定条件下，ADM 形式比 BSSN 形式表现出更大的约束增长，这突显了类 BSSN 双曲系统优越的约束控制行为。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the ratio of Hamiltonian constraint growth in ADM vs. BSSN\n    formulations for a series of test cases.\n    \"\"\"\n    test_cases = [\n        # (A, N, lambda)\n        (10**-2, 512, 0.5),  # Case 1\n        (10**-2, 256, 0.9),  # Case 2\n        (10**-4, 512, 0.5),  # Case 3\n        (10**-2, 128, 0.6),  # Case 4\n    ]\n\n    L = 1.0\n    sigma = 0.05\n    x0 = 0.3\n    T = 0.5\n    nu = 10**-4\n\n    results = []\n\n    for A, N, lam in test_cases:\n        # 1. Grid and Simulation Parameters\n        dx = L / N\n        dt = lam * dx\n        num_steps = int(T / dt)\n        x = np.linspace(0, L, N, endpoint=False)\n\n        # 2. Finite Difference Helper Functions (2nd Order Central, Periodic)\n        def deriv1(u, dx_val):\n            \"\"\"Computes the first derivative.\"\"\"\n            u_p1 = np.roll(u, -1)\n            u_m1 = np.roll(u, 1)\n            return (u_p1 - u_m1) / (2 * dx_val)\n\n        def deriv2(u, dx_val):\n            \"\"\"Computes the second derivative.\"\"\"\n            u_p1 = np.roll(u, -1)\n            u_m1 = np.roll(u, 1)\n            return (u_p1 - 2 * u + u_m1) / (dx_val**2)\n\n        # 3. Initial Conditions\n        # Scalar field and its spatial derivative\n        phi_0 = A * np.exp(-((x - x0) ** 2) / (2 * sigma**2))\n        dphi_dx_0 = deriv1(phi_0, dx) # Use numerical derivative for consistency\n\n        # Conjugate momentum for a right-moving pulse\n        pi_0 = -dphi_dx_0\n\n        # Energy and momentum densities (weak-field limit)\n        # Note: The problem defines S(x,0) = pi * dphi_dx, and pi = -dphi_dx\n        rho_0 = 0.5 * (pi_0**2 + dphi_dx_0**2)\n        S_0 = pi_0 * dphi_dx_0\n\n        # Initial constraint violations\n        H_0 = 8 * np.pi * rho_0\n        M_0 = 8 * np.pi * S_0\n\n        # 4. Set up state vectors for evolution\n        # Scalar field\n        phi, pi = np.copy(phi_0), np.copy(pi_0)\n        # ADM constraints\n        H_adm, M_adm = np.copy(H_0), np.copy(M_0)\n        # BSSN constraints\n        H_bssn, M_bssn = np.copy(H_0), np.copy(M_0)\n\n        # 5. RHS functions for RK4\n        def rhs_scalar(phi_vec, pi_vec, dx_val):\n            dphi_dt = pi_vec\n            dpi_dt = deriv2(phi_vec, dx_val)\n            return dphi_dt, dpi_dt\n\n        def rhs_adm(H_vec, M_vec, dx_val, nu_val):\n            dH_dt = nu_val * deriv2(H_vec, dx_val)\n            dM_dt = nu_val * deriv2(M_vec, dx_val)\n            return dH_dt, dM_dt\n\n        def rhs_bssn(H_vec, M_vec, dx_val, nu_val):\n            dH_dt = deriv1(M_vec, dx_val) + nu_val * deriv2(H_vec, dx_val)\n            dM_dt = deriv1(H_vec, dx_val) + nu_val * deriv2(M_vec, dx_val)\n            return dH_dt, dM_dt\n            \n        # 6. RK4 Time Evolution Loop\n        for _ in range(num_steps):\n            # --- Scalar Field Step ---\n            k1_phi, k1_pi = rhs_scalar(phi, pi, dx)\n            k2_phi, k2_pi = rhs_scalar(phi + 0.5 * dt * k1_phi, pi + 0.5 * dt * k1_pi, dx)\n            k3_phi, k3_pi = rhs_scalar(phi + 0.5 * dt * k2_phi, pi + 0.5 * dt * k2_pi, dx)\n            k4_phi, k4_pi = rhs_scalar(phi + dt * k3_phi, pi + dt * k3_pi, dx)\n            phi += (dt / 6.0) * (k1_phi + 2*k2_phi + 2*k3_phi + k4_phi)\n            pi += (dt / 6.0) * (k1_pi + 2*k2_pi + 2*k3_pi + k4_pi)\n\n            # --- ADM Step ---\n            k1_H, k1_M = rhs_adm(H_adm, M_adm, dx, nu)\n            k2_H, k2_M = rhs_adm(H_adm + 0.5 * dt * k1_H, M_adm + 0.5 * dt * k1_M, dx, nu)\n            k3_H, k3_M = rhs_adm(H_adm + 0.5 * dt * k2_H, M_adm + 0.5 * dt * k2_M, dx, nu)\n            k4_H, k4_M = rhs_adm(H_adm + dt * k3_H, M_adm + dt * k3_M, dx, nu)\n            H_adm += (dt / 6.0) * (k1_H + 2*k2_H + 2*k3_H + k4_H)\n            M_adm += (dt / 6.0) * (k1_M + 2*k2_M + 2*k3_M + k4_M)\n\n            # --- BSSN Step ---\n            k1_H, k1_M = rhs_bssn(H_bssn, M_bssn, dx, nu)\n            k2_H, k2_M = rhs_bssn(H_bssn + 0.5 * dt * k1_H, M_bssn + 0.5 * dt * k1_M, dx, nu)\n            k3_H, k3_M = rhs_bssn(H_bssn + 0.5 * dt * k2_H, M_bssn + 0.5 * dt * k2_M, dx, nu)\n            k4_H, k4_M = rhs_bssn(H_bssn + dt * k3_H, M_bssn + dt * k3_M, dx, nu)\n            H_bssn += (dt / 6.0) * (k1_H + 2*k2_H + 2*k3_H + k4_H)\n            M_bssn += (dt / 6.0) * (k1_M + 2*k2_M + 2*k3_M + k4_M)\n\n        # 7. Analysis and Calculation of R\n        def l2_norm(u, dx_val):\n            return np.sqrt(dx_val * np.sum(u**2))\n\n        norm_H0 = l2_norm(H_0, dx)\n        norm_H_adm_T = l2_norm(H_adm, dx)\n        norm_H_bssn_T = l2_norm(H_bssn, dx)\n\n        # Avoid division by zero if initial norm is zero\n        if norm_H0 == 0:\n            result = 1.0 if norm_H_adm_T == norm_H_bssn_T else np.inf\n        else:\n            G_adm = norm_H_adm_T / norm_H0\n            G_bssn = norm_H_bssn_T / norm_H0\n            # Avoid division by zero if BSSN constraint decays to zero\n            result = G_adm / G_bssn if G_bssn > 0 else np.inf\n\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3463146"}]}