{"hands_on_practices": [{"introduction": "数值模拟在离散网格上表示连续的场和算子。本练习将引导您完成关键的第一步：为空间导数构建一个高阶精确的近似，这对于最大限度地减少 BSSN 方程长期演化中的数值误差至关重要。通过推导一个四阶中心差分格式并计算其截断误差，您将深入了解有限差分法的基础 [@problem_id:3489794]。", "problem": "在数值相对论的 Baumgarte-Shapiro-Shibata-Nakamura (BSSN) 形式体系中，收缩共形连接函数用 $\\tilde{\\Gamma}^{i}$ 表示。考虑在均匀笛卡尔网格上计算散度 $\\partial_{i}\\tilde{\\Gamma}^{i}$，其中每个坐标方向的间距为 $h$，网格点位于 $x_{m}=m h$、$y_{n}=n h$ 和 $z_{p}=p h$ 处，其中 $m,n,p$ 为整数。\n\n从网格点周围的泰勒展开出发，推导在网格点 $(m,n,p)$ 处 $\\partial_{i}\\tilde{\\Gamma}^{i}$ 的一个四阶精度中心有限差分近似，该近似用邻近网格点上的 $\\tilde{\\Gamma}^{i}$ 值表示。您必须直接根据泰勒展开来证明其精度阶数，并以符号形式指出其主阶截断误差项。\n\n然后，针对给定的光滑测试场\n- $\\tilde{\\Gamma}^{x}(x,y,z)=\\sin(x)\\,\\cos(y)\\,\\exp(z)$,\n- $\\tilde{\\Gamma}^{y}(x,y,z)=\\cos(x)\\,\\sin(y)\\,\\exp(z)$,\n- $\\tilde{\\Gamma}^{z}(x,y,z)=\\exp(x+y)\\,\\cos(z)$,\n\n计算您的四阶中心有限差分近似在物理点 $(x,y,z)=(0,0,0)$ 处对 $\\partial_{i}\\tilde{\\Gamma}^{i}$ 的主阶截断误差。将您的最终答案表示为仅含 $h$ 的单个闭式解析表达式。不需要进行数值舍入，也不需要单位。", "solution": "本问题要求推导收缩共形连接函数散度 $\\partial_{i}\\tilde{\\Gamma}^{i}$ 的一个四阶精度中心有限差分近似，并针对一个特定的测试场计算其主阶截断误差。在三维笛卡尔坐标系中，散度为 $\\partial_{i}\\tilde{\\Gamma}^{i} = \\partial_{x}\\tilde{\\Gamma}^{x} + \\partial_{y}\\tilde{\\Gamma}^{y} + \\partial_{z}\\tilde{\\Gamma}^{z}$。由于微分和有限差分算子的线性性质，我们可以推导单个偏导数（例如 $\\partial_x f(x)$）的差分格式，然后将其应用于散度中的每一项。\n\n我们来推导在网格点 $x$ 处一个通用光滑函数 $f(x)$ 的一阶导数的四阶精度中心有限差分近似。我们使用一个涉及点 $x \\pm h$ 和 $x \\pm 2h$ 的五点差分格式。近似值 $D_x f$ 可以写成这些点上函数值的线性组合：\n$$D_x f = \\frac{c_{-2}f(x-2h) + c_{-1}f(x-h) + c_0 f(x) + c_1 f(x+h) + c_2 f(x+2h)}{h}$$\n我们使用 $f$ 在 $x$ 点的泰勒级数展开：\n$$ f(x+kh) = f(x) + (kh)f'(x) + \\frac{(kh)^2}{2!}f''(x) + \\frac{(kh)^3}{3!}f'''(x) + \\frac{(kh)^4}{4!}f^{(4)}(x) + \\frac{(kh)^5}{5!}f^{(5)}(x) + \\mathcal{O}(h^6) $$\n对于一阶导数的中心差分格式，差分格式必须是反对称的，因此 $c_{-k} = -c_k$，且中心点系数必须为零，即 $c_0=0$。该近似具有以下形式：\n$$ D_x f = \\frac{c_1(f(x+h) - f(x-h)) + c_2(f(x+2h) - f(x-2h))}{h} $$\n我们来展开这些差分项：\n$$ f(x+h) - f(x-h) = 2h f'(x) + \\frac{2h^3}{6}f'''(x) + \\frac{2h^5}{120}f^{(5)}(x) + \\mathcal{O}(h^7) $$\n$$ f(x+2h) - f(x-2h) = 4h f'(x) + \\frac{16h^3}{6}f'''(x) + \\frac{64h^5}{120}f^{(5)}(x) + \\mathcal{O}(h^7) $$\n将这些代入 $D_x f$ 的表达式中：\n$$ D_x f = \\frac{c_1}{h}\\left(2h f' + \\frac{h^3}{3}f''' + \\frac{h^5}{60}f^{(5)}\\right) + \\frac{c_2}{h}\\left(4h f' + \\frac{8h^3}{3}f''' + \\frac{8h^5}{15}f^{(5)}\\right) + \\mathcal{O}(h^6) $$\n$$ D_x f = (2c_1 + 4c_2)f'(x) + \\left(\\frac{c_1}{3} + \\frac{8c_2}{3}\\right)h^2f'''(x) + \\left(\\frac{c_1}{60} + \\frac{8c_2}{15}\\right)h^4f^{(5)}(x) + \\mathcal{O}(h^6) $$\n为了得到 $f'(x)$ 的近似， $f'(x)$ 的系数必须为 $1$。为了达到四阶精度，$h^2f'''(x)$ 项的系数必须为零。这给了我们一个关于 $c_1$ 和 $c_2$ 的二元线性方程组：\n$1$. $2c_1 + 4c_2 = 1$\n$2$. $\\frac{c_1}{3} + \\frac{8c_2}{3} = 0 \\implies c_1 + 8c_2 = 0 \\implies c_1 = -8c_2$\n\n将 $c_1 = -8c_2$ 代入第一个方程：\n$$ 2(-8c_2) + 4c_2 = 1 \\implies -16c_2 + 4c_2 = 1 \\implies -12c_2 = 1 \\implies c_2 = -\\frac{1}{12} $$\n于是，$c_1 = -8(-\\frac{1}{12}) = \\frac{8}{12} = \\frac{2}{3}$。\n\n因此，$\\partial_x$ 的有限差分算子是：\n$$ D_x f = \\frac{2}{3h}(f(x+h) - f(x-h)) - \\frac{1}{12h}(f(x+2h) - f(x-2h)) $$\n$$ D_x f = \\frac{8(f(x+h) - f(x-h)) - (f(x+2h) - f(x-2h))}{12h} $$\n$$ D_x f = \\frac{-f(x+2h) + 8f(x+h) - 8f(x-h) + f(x-2h)}{12h} $$\n主阶截断误差项由展开式中的 $h^4f^{(5)}(x)$ 项给出。使用求得的 $c_1$ 和 $c_2$ 的值：\n$$ \\text{Error Term} = \\left(\\frac{c_1}{60} + \\frac{8c_2}{15}\\right)h^4f^{(5)}(x) = \\left(\\frac{2/3}{60} + \\frac{8(-1/12)}{15}\\right)h^4f^{(5)}(x) $$\n$$ = \\left(\\frac{2}{180} - \\frac{8}{180}\\right)h^4f^{(5)}(x) = \\left(\\frac{1}{90} - \\frac{4}{90}\\right)h^4f^{(5)}(x) = -\\frac{3}{90}h^4f^{(5)}(x) = -\\frac{1}{30}h^4f^{(5)}(x) $$\n所以，算子 $D_x$ 的截断误差为 $T_x = D_x f - \\partial_x f = -\\frac{1}{30}h^4 \\partial_x^5 f + \\mathcal{O}(h^6)$。\n\n在网格点 $(m,n,p)$ 处 $\\partial_{i}\\tilde{\\Gamma}^{i}$ 的四阶有限差分近似是每个偏导数的差分格式之和：\n$$ \\mathcal{D}(\\tilde{\\Gamma})|_{(m,n,p)} = \\frac{-\\tilde{\\Gamma}^x_{m+2,n,p} + 8\\tilde{\\Gamma}^x_{m+1,n,p} - 8\\tilde{\\Gamma}^x_{m-1,n,p} + \\tilde{\\Gamma}^x_{m-2,n,p}}{12h} $$\n$$ + \\frac{-\\tilde{\\Gamma}^y_{m,n+2,p} + 8\\tilde{\\Gamma}^y_{m,n+1,p} - 8\\tilde{\\Gamma}^y_{m,n-1,p} + \\tilde{\\Gamma}^y_{m,n-2,p}}{12h} $$\n$$ + \\frac{-\\tilde{\\Gamma}^z_{m,n,p+2} + 8\\tilde{\\Gamma}^z_{m,n,p+1} - 8\\tilde{\\Gamma}^z_{m,n,p-1} + \\tilde{\\Gamma}^z_{m,n,p-2}}{12h} $$\n主阶截断误差 $T = \\mathcal{D}(\\tilde{\\Gamma}) - \\partial_i \\tilde{\\Gamma}^i$ 是各个主阶误差之和：\n$$ T_{LO} = -\\frac{h^4}{30}\\partial_x^5 \\tilde{\\Gamma}^x - \\frac{h^4}{30}\\partial_y^5 \\tilde{\\Gamma}^y - \\frac{h^4}{30}\\partial_z^5 \\tilde{\\Gamma}^z = -\\frac{h^4}{30}\\left(\\partial_x^5 \\tilde{\\Gamma}^x + \\partial_y^5 \\tilde{\\Gamma}^y + \\partial_z^5 \\tilde{\\Gamma}^z\\right) $$\n\n现在，我们针对给定的光滑测试场，在 $(x,y,z)=(0,0,0)$ 处计算误差。\n其分量为：\n- $\\tilde{\\Gamma}^{x}(x,y,z)=\\sin(x)\\,\\cos(y)\\,\\exp(z)$\n- $\\tilde{\\Gamma}^{y}(x,y,z)=\\cos(x)\\,\\sin(y)\\,\\exp(z)$\n- $\\tilde{\\Gamma}^{z}(x,y,z)=\\exp(x+y)\\,\\cos(z)$\n\n我们需要计算五阶偏导数并在 $(0,0,0)$ 处求值。\n\n对于 $\\tilde{\\Gamma}^x$：\n$$ \\partial_x^5 \\tilde{\\Gamma}^x = \\partial_x^5(\\sin(x)\\,\\cos(y)\\,\\exp(z)) = \\cos(y)\\,\\exp(z)\\,\\frac{d^5}{dx^5}(\\sin(x)) $$\n$\\sin(x)$ 的导数依次为 $\\cos(x)$、$-\\sin(x)$、$-\\cos(x)$、$\\sin(x)$、$\\cos(x)$。所以，$\\frac{d^5}{dx^5}(\\sin(x)) = \\cos(x)$。\n$$ \\partial_x^5 \\tilde{\\Gamma}^x = \\cos(x)\\,\\cos(y)\\,\\exp(z) $$\n在 $(0,0,0)$ 处：$\\partial_x^5 \\tilde{\\Gamma}^x|_{(0,0,0)} = \\cos(0)\\,\\cos(0)\\,\\exp(0) = 1 \\cdot 1 \\cdot 1 = 1$。\n\n对于 $\\tilde{\\Gamma}^y$：\n$$ \\partial_y^5 \\tilde{\\Gamma}^y = \\partial_y^5(\\cos(x)\\,\\sin(y)\\,\\exp(z)) = \\cos(x)\\,\\exp(z)\\,\\frac{d^5}{dy^5}(\\sin(y)) $$\n类似地，$\\frac{d^5}{dy^5}(\\sin(y)) = \\cos(y)$。\n$$ \\partial_y^5 \\tilde{\\Gamma}^y = \\cos(x)\\,\\cos(y)\\,\\exp(z) $$\n在 $(0,0,0)$ 处：$\\partial_y^5 \\tilde{\\Gamma}^y|_{(0,0,0)} = \\cos(0)\\,\\cos(0)\\,\\exp(0) = 1 \\cdot 1 \\cdot 1 = 1$。\n\n对于 $\\tilde{\\Gamma}^z$：\n$$ \\partial_z^5 \\tilde{\\Gamma}^z = \\partial_z^5(\\exp(x+y)\\,\\cos(z)) = \\exp(x+y)\\,\\frac{d^5}{dz^5}(\\cos(z)) $$\n$\\cos(z)$ 的导数依次为 $-\\sin(z)$、$-\\cos(z)$、$\\sin(z)$、$\\cos(z)$、$-\\sin(z)$。所以，$\\frac{d^5}{dz^5}(\\cos(z)) = -\\sin(z)$。\n$$ \\partial_z^5 \\tilde{\\Gamma}^z = -\\exp(x+y)\\,\\sin(z) $$\n在 $(0,0,0)$ 处：$\\partial_z^5 \\tilde{\\Gamma}^z|_{(0,0,0)} = -\\exp(0)\\,\\sin(0) = -1 \\cdot 0 = 0$。\n\n最后，我们将这些值代入在 $(0,0,0)$ 处的主阶截断误差表达式中：\n$$ T_{LO}|_{(0,0,0)} = -\\frac{h^4}{30}\\left(\\partial_x^5 \\tilde{\\Gamma}^x|_{(0,0,0)} + \\partial_y^5 \\tilde{\\Gamma}^y|_{(0,0,0)} + \\partial_z^5 \\tilde{\\Gamma}^z|_{(0,0,0)}\\right) $$\n$$ T_{LO}|_{(0,0,0)} = -\\frac{h^4}{30}(1 + 1 + 0) = -\\frac{2h^4}{30} = -\\frac{h^4}{15} $$\n主阶截断误差为 $-\\frac{h^4}{15}$。", "answer": "$$\\boxed{-\\frac{h^4}{15}}$$", "id": "3489794"}, {"introduction": "一个有效的数值模拟必须是稳定的。本练习深入探讨了稳定性分析的核心，通过推导线性化 BSSN 系统的特征速度，来确定显式演化格式所允许的最大时间步长（CFL 条件）。理解物理模式和规范模式如何共同决定这一极限，是设计和运行稳健的数值相对论模拟的一项关键技能 [@problem_id:3489827]。", "problem": "考虑数值相对论中的 Baumgarte-Shapiro-Shibata-Nakamura (BSSN) 形式的 Einstein 方程，该方程在一维空间中围绕 Minkowski 时空进行线性化，背景直观标量为 $\\alpha = 1$，移位矢量为 $\\beta^{i} = 0$，空间度规为 $\\gamma_{ij} = \\delta_{ij}$，外曲率为 $K_{ij} = 0$。采用 $1+\\log$ 选择的 Bona-Massó 切片，即 $f(\\alpha) = 2/\\alpha$，因此直观标量的规范条件为 $\\partial_{t}\\alpha = -2 \\alpha K$。对于移位矢量，使用其标准两方程形式的双曲 Gamma-driver 条件，\n$$\n\\partial_{t}\\beta^{i} = B^{i}, \\qquad \\partial_{t}B^{i} = \\partial_{t}\\tilde{\\Gamma}^{i} - \\eta B^{i},\n$$\n其中阻尼参数 $\\eta \\ge 0$ 为常数，$\\tilde{\\Gamma}^{i}$ 是 BSSN 的收缩共形连接函数。在确定特征速度时，只考虑主部（最高空间导数阶），并忽略低阶和阻尼的贡献。\n\n你将使用直线法演化该线性化系统，其中空间导数 $\\partial_{x}$ 采用二阶中心有限差分近似，时间积分器采用经典的四阶显式 Runge–Kutta (RK4)。对于波数为 $k$ 的傅里叶模式，空间有限差分算子 $\\partial_{x}$ 的符号为\n$$\n\\lambda_{D}(k) = \\frac{i\\sin(k\\Delta x)}{\\Delta x}.\n$$\n\n基于这些前提：\n- 推导具有上述规范条件的线性化 BSSN 系统的最大特征速度 $v_{\\max}$。\n- 将 RK4 稳定性函数应用于具有纯虚数特征值的半离散系统，确定最大的值 $C$，使得形式为 $\\Delta t \\le C\\,\\Delta x$ 的 Courant–Friedrichs–Lewy (CFL) 条件能确保所有傅里eyer模式的线性稳定性。\n\n将你对 $C$ 的最终答案表示为单个精确的无量纲常数。不需要进行四舍五入。", "solution": "### 推导最大特征速度 ($v_{\\max}$)\n为了找到特征速度，我们分析了具有给定规范条件的线性化 BSSN 方程的主部。这涉及到检查理论中不同分区的解耦波动方程。\n\n**1. 直观标量分区 (规范):**\n直观标量 $\\alpha$ 和外曲率的迹 $K$ 由给定的 Bona-Massó 切片条件和 BSSN 中 K 的演化方程决定。\n切片条件为 $\\partial_{t}\\alpha = -2\\alpha K$。在 $\\alpha=1$ 和 $K=0$ 附近线性化，我们得到：\n$$\n\\partial_{t}(\\delta\\alpha) = -2K\n$$\nBSSN 中 K 的演化方程的主部是 $\\partial_{t}K = -\\nabla^{2}\\alpha$。在平直背景附近线性化，这变为：\n$$\n\\partial_{t}K = -\\nabla^{2}(\\delta\\alpha)\n$$\n在一维空间中，$\\nabla^{2} = \\partial_{x}^{2}$。将第一个方程对时间求导，并与第二个方程结合，得到：\n$$\n\\partial_{t}^{2}(\\delta\\alpha) = -2\\partial_{t}K = -2(-\\partial_{x}^{2}(\\delta\\alpha)) = 2\\partial_{x}^{2}(\\delta\\alpha)\n$$\n这是一个波动方程 $\\partial_{t}^{2}u - v^{2}\\partial_{x}^{2}u = 0$，其传播速度为 $v_{\\alpha} = \\sqrt{2}$。\n\n**2. 物理引力波分区:**\n物理自由度包含在度规的共形、无迹部分 $\\tilde{\\gamma}_{ij}$ 和外曲率 $\\tilde{A}_{ij}$ 中。它们的 BSSN 方程，经线性化并取主部后为：\n$$\n\\partial_{t}\\tilde{\\gamma}_{ij} = -2\\tilde{A}_{ij}\n$$\n$$\n\\partial_t \\tilde{A}_{ij} \\approx [\\tilde{R}_{ij}]^{TF}\n$$\n其中 $\\tilde{R}_{ij}$ 是共形度规 $\\tilde{\\gamma}_{ij}$ 的 Ricci 张量，TF 表示无迹部分。对于小微扰，$\\tilde{R}_{ij} \\approx -\\frac{1}{2}\\nabla^{2}\\tilde{\\gamma}_{ij}$。$\\tilde{\\gamma}_{ij}$ 的无迹条件（$\\det(\\tilde{\\gamma}_{ij})=1$，线性化为 $\\delta^{ij}\\tilde{\\gamma}_{ij}=0$）确保了 $\\nabla^{2}(\\delta^{ij}\\tilde{\\gamma}_{ij})=0$，因此 $\\nabla^{2}\\tilde{\\gamma}_{ij}$ 的无迹部分就是该算子本身。合并方程：\n$$\n\\partial_{t}^{2}\\tilde{\\gamma}_{ij} = -2\\partial_{t}\\tilde{A}_{ij} \\approx -2\\left(-\\frac{1}{2}\\partial_{x}^{2}\\tilde{\\gamma}_{ij}\\right) = \\partial_{x}^{2}\\tilde{\\gamma}_{ij}\n$$\n这是一个传播速度为 $v_{\\gamma} = 1$ 的波动方程。这对应于引力波的速度，在我们的单位制中即为光速 $c=1$。\n\n**3. 移位矢量分区 (规范):**\n移位矢量 $\\beta^{i}$ 和辅助变量 $B^{i}$ 由双曲 Gamma-driver 条件决定。忽略阻尼（$\\eta=0$），我们有：\n$$\n\\partial_{t}\\beta^{i} = B^{i}\n$$\n$$\n\\partial_{t}B^{i} = \\partial_{t}\\tilde{\\Gamma}^{i}\n$$\n合并这些方程得到关于 $\\beta^{i}$ 的波动方程：$\\partial_{t}^{2}\\beta^{i} = \\partial_{t}\\tilde{\\Gamma}^{i}$。我们需要 $\\partial_{t}\\tilde{\\Gamma}^{i}$ 的主部。量 $\\tilde{\\Gamma}^{i}$ 不是一个独立的场，而是从其他场中导出的。它的时间演化由它所依赖的场的演化决定。\n$$\n\\partial_t \\tilde{\\Gamma}^i = -\\partial_j(\\partial_t \\tilde{\\gamma}^{ij})\n$$\n逆共形度规 $\\tilde{\\gamma}^{ij}$ 的时间导数，经过线性化后，同时包含来自 $\\tilde{A}_{ij}$ 和移位矢量导数的项：\n$$\n\\partial_t \\tilde{\\gamma}^{ij} \\approx 2\\tilde{A}^{ij} - (\\partial^i\\beta^j + \\partial^j\\beta^i - \\frac{2}{3}\\delta^{ij}\\partial_k\\beta^k)\n$$\n因此，$\\partial_t \\tilde{\\Gamma}^i$ 的完整表达式为\n$$\n\\partial_t \\tilde{\\Gamma}^i \\approx -2\\partial_j\\tilde{A}^{ij} + \\partial_j\\partial^j\\beta^i + \\partial_j\\partial^i\\beta^j - \\frac{2}{3}\\partial^i(\\partial_k\\beta^k)\n$$\n主部由最高阶空间导数决定。涉及 $\\beta^i$ 的项是二阶的，而含 $\\tilde{A}^{ij}$ 的项是一阶的。因此，我们只保留 $\\beta^i$ 的二阶导数。在一维情况下 ($i=x$)：\n$$\n\\partial_t \\tilde{\\Gamma}^x \\approx \\partial_x^2\\beta^x + \\partial_x^2\\beta^x - \\frac{2}{3}\\partial_x^2\\beta^x = \\frac{4}{3}\\partial_x^2\\beta^x\n$$\n将此代入 $\\beta^x$ 的波动方程中：\n$$\n\\partial_t^2\\beta^x = \\frac{4}{3}\\partial_x^2\\beta^x\n$$\n这给出了移位规范模式的传播速度 $v_{\\beta} = \\sqrt{4/3} = 2/\\sqrt{3}$。\n\n**最大特征速度:**\n系统的特征速度为 $v=0, \\pm 1, \\pm\\sqrt{2}, \\pm 2/\\sqrt{3}$。最大绝对值为：\n$$\nv_{\\max} = \\max\\left(1, \\sqrt{2}, \\frac{2}{\\sqrt{3}}\\right) = \\max(1, 1.414..., 1.154...) = \\sqrt{2}\n$$\n\n### CFL 常数 ($C$) 的确定\n数值格式的稳定性由 Courant–Friedrichs–Lewy (CFL) 条件确定。对于直线法，我们分析半离散化空间算子的特征值。\n\n形如 $\\partial_t \\mathbf{u} + \\mathbf{A} \\partial_x \\mathbf{u} = 0$ 的双曲系统的特征速度由 $\\mathbf{A}$ 的特征值给出。经过空间傅里叶变换后，系统变为 $\\partial_t \\hat{\\mathbf{u}}(k) = -ik\\mathbf{A}\\hat{\\mathbf{u}}(k)$，其特征值为纯虚数 $-ikv_j$。即使对于二阶波动方程 $\\partial_t^2 u - v^2 \\partial_x^2 u=0$，当写成关于时间的一阶系统时，算子的特征值也为 $\\pm ikv$。\n\n问题指定了 $\\partial_x$ 的二阶中心有限差分算子，其符号为 $\\lambda_D(k) = \\frac{i\\sin(k\\Delta x)}{\\Delta x}$。对于以速度 $v$ 传播的波，半离散算子的特征值为 $\\lambda(k) = v \\lambda_D(k) = v \\frac{i\\sin(k\\Delta x)}{\\Delta x}$。这些特征值是纯虚数。\n\n对于 RK4 时间积分器，稳定性条件是 $z = \\lambda(k)\\Delta t$ 对于所有特征值 $\\lambda(k)$ 都必须位于 RK4 稳定域内。对于纯虚数 $z=i\\omega$，RK4 稳定域由 $|R(i\\omega)| \\le 1$ 定义，其中 $R(z) = 1 + z + \\frac{z^2}{2!} + \\frac{z^3}{3!} + \\frac{z^4}{4!}$ 是稳定性函数。\n$$\n|R(i\\omega)|^2 = \\left|1+i\\omega - \\frac{\\omega^2}{2} - i\\frac{\\omega^3}{6} + \\frac{\\omega^4}{24}\\right|^2 = \\left(1-\\frac{\\omega^2}{2}+\\frac{\\omega^4}{24}\\right)^2 + \\left(\\omega-\\frac{\\omega^3}{6}\\right)^2\n$$\n展开此式可得：\n$$\n|R(i\\omega)|^2 = 1 - \\frac{\\omega^6}{72} + \\frac{\\omega^8}{576}\n$$\n稳定性条件 $1 - \\frac{\\omega^6}{72} + \\frac{\\omega^8}{576} \\le 1$ 可简化为 $\\omega^6(\\frac{\\omega^2}{576} - \\frac{1}{72}) \\le 0$。由于 $\\omega^6 \\ge 0$，这要求：\n$$\n\\frac{\\omega^2}{576} \\le \\frac{1}{72} \\implies \\omega^2 \\le \\frac{576}{72} = 8\n$$\n因此，虚轴上的稳定区间为 $|\\omega| \\le \\sqrt{8} = 2\\sqrt{2}$。\n\nCFL 条件必须在最坏情况下成立，即对应于最大速度 $v_{\\max}$ 和使算子符号的模最大化的波数 $k$。\n我们需要对于所有 $k$ 和所有特征速度 $v$，都有 $|z| = |\\lambda(k)\\Delta t| \\le 2\\sqrt{2}$。\n$$\n\\left|v \\frac{i\\sin(k\\Delta x)}{\\Delta x} \\Delta t\\right| \\le 2\\sqrt{2}\n$$\n为确保对所有模式都稳定，我们必须使用 $|v|$ 和 $|\\sin(k\\Delta x)|$ 的最大值：\n$$\n\\max|v| = v_{\\max} = \\sqrt{2}\n$$\n$$\n\\max_k |\\sin(k\\Delta x)| = 1\n$$\n该条件变为：\n$$\n\\frac{v_{\\max}}{\\Delta x}\\Delta t \\le 2\\sqrt{2}\n$$\n对 $\\Delta t$ 进行整理，我们得到 CFL 条件：\n$$\n\\Delta t \\le \\frac{2\\sqrt{2}}{v_{\\max}}\\Delta x\n$$\n问题将 CFL 条件定义为 $\\Delta t \\le C \\Delta x$，因此常数 $C$ 为：\n$$\nC = \\frac{2\\sqrt{2}}{v_{\\max}} = \\frac{2\\sqrt{2}}{\\sqrt{2}} = 2\n$$\nCFL 常数的最大值为 2。", "answer": "$$\\boxed{2}$$", "id": "3489827"}, {"introduction": "BSSN 形式体系的一个关键优势在于其对约束的动态管理。这个动手编程实验分离了其中一种“约束阻尼”机制，让您可以模拟演化方程中的特定项如何主动将约束违例驱动为零。这项实践提供了切实的洞察，揭示了 BSSN 系统在模拟强引力场现象方面如此稳健和成功的原因 [@problem_id:3489765]。", "problem": "您需要实现一个受控数值实验，以分离 Baumgarte-Shapiro-Shibata-Nakamura (BSSN) 形式体系中共形联络函数驱动项的影响。BSSN 共形联络函数定义为 $\\tilde{\\Gamma}^{i} \\equiv -\\tilde{\\gamma}^{jk}\\tilde{\\Gamma}^{i}{}_{jk}$，其中 $\\tilde{\\gamma}_{ij}$ 是共形度规，相关的共形联络约束为 $\\mathcal{G}^{i} \\equiv \\tilde{\\Gamma}^{i} - \\partial_{j}\\tilde{\\gamma}^{ij}$. 实验目标是通过冻结除 $\\tilde{\\Gamma}^{i}$ 之外的所有变量，并在一维空间中演化一个包含驱动项和最小耗散项的简化方程，然后测量约束 $\\mathcal{G}^{i}$ 的衰减（或增长）率，从而分离出驱动项的影响。\n\n基本背景：\n- Baumgarte-Shapiro-Shibata-Nakamura (BSSN) 形式体系引入了共形变量，包括共形度规 $\\tilde{\\gamma}_{ij}$ 和共形联络函数 $\\tilde{\\Gamma}^{i}$，以及约束 $\\mathcal{G}^{i} \\equiv \\tilde{\\Gamma}^{i} - \\partial_{j}\\tilde{\\gamma}^{ij}$.\n- 在移动矢量驱动范式中，可以设计源项来阻尼约束 $\\mathcal{G}^{i}$.\n- 可以通过冻结共形度规 $\\tilde{\\gamma}_{ij}$，使得 $\\partial_{j}\\tilde{\\gamma}^{ij}$ 在时间上为常数，并且在 $\\tilde{\\Gamma}^{i}$ 的演化中只包含驱动项和耗散项，来构建一个简化的一维实验。\n\n待实现的实验设计：\n1. 冻结共形度规和除共形联络函数分量 $\\tilde{\\Gamma}^{x}$ 之外的所有变量，使得 $\\partial_{j}\\tilde{\\gamma}^{ij}$ 不随时间变化。定义 $\\bar{\\Gamma}^{x} \\equiv \\partial_{j}\\tilde{\\gamma}^{xj}$（在本实验中是一个固定的空间函数），并将共形联络约束定义为 $\\mathcal{G}^{x} \\equiv \\tilde{\\Gamma}^{x} - \\bar{\\Gamma}^{x}$.\n2. 仅演化包含驱动项和耗散项的 $\\tilde{\\Gamma}^{x}$ 的简化方程：\n   $$\\partial_{t}\\tilde{\\Gamma}^{x} = -\\kappa\\left(\\tilde{\\Gamma}^{x} - \\bar{\\Gamma}^{x}\\right) + \\sigma\\,\\partial_{x}^{2}\\tilde{\\Gamma}^{x},$$\n   其中 $\\kappa \\ge 0$ 是驱动项系数，$\\sigma \\ge 0$ 代表耗散平滑。在冻结假设下，这会导出约束的演化\n   $$\\partial_{t}\\mathcal{G}^{x} = -\\kappa\\,\\mathcal{G}^{x} + \\sigma\\,\\partial_{x}^{2}\\mathcal{G}^{x}.$$\n3. 在长度为 $L$ 的周期性区域上进行计算，该区域被离散为 $N$ 个点，空间坐标为 $x_{j}$，间距为 $\\Delta x = L/N$. 采用周期性边界条件。本问题中没有物理单位；所有量均为无量纲量。\n4. 将约束初始化为单个傅里叶模式：\n   $$\\mathcal{G}^{x}(x,0) = A\\,\\sin(k x), \\quad k = \\frac{2\\pi m}{L},$$\n   其中 $m$ 是一个非负整数。对于本实验，不失一般性地可将固定背景 $\\bar{\\Gamma}^{x}$ 设为零，这意味着 $\\tilde{\\Gamma}^{x}(x,0) = \\mathcal{G}^{x}(x,0)$，并且由于冻结，此后 $\\bar{\\Gamma}^{x} = 0$.\n5. 使用显式四阶龙格-库塔方法进行时间演化，并对周期性网格上的 $\\partial_{x}^{2}$ 使用二阶中心有限差分近似，来演化约束 $\\mathcal{G}^{x}$.\n\n测量方案：\n- 在每个时间步，通过在周期区间上利用正交关系将 $\\mathcal{G}^{x}(x,t)$ 投影到 $\\sin(kx)$ 上，计算模式振幅 $a(t)$：\n  $$a(t) = \\frac{2}{L} \\int_{0}^{L} \\mathcal{G}^{x}(x,t)\\,\\sin(kx)\\,dx,$$\n  该积分在网格上通过黎曼和近似。\n- 通过对整个模拟时间区间内的 $\\ln|a(t)|$ 与 $t$ 进行线性最小二乘拟合来估计衰减率 $r$，并为每个测试案例报告 $r \\equiv -\\frac{d}{dt}\\ln|a(t)|$（浮点数）。如果振幅增长，则测得的 $r$ 将为负。\n\n时间步进细节：\n- 使用显式四阶龙格-库塔格式，时间步长为 $\\Delta t$，总时间为 $T$.\n- 空间导数 $\\partial_{x}^{2}$ 必须通过二阶有限差分格式进行离散化：\n  $$\\left.\\partial_{x}^{2}\\mathcal{G}^{x}\\right|_{j} \\approx \\frac{\\mathcal{G}^{x}_{j+1} - 2\\,\\mathcal{G}^{x}_{j} + \\mathcal{G}^{x}_{j-1}}{\\Delta x^{2}},$$\n  指数采用周期性回绕。\n\n测试套件：\n实现以下 $4$ 个参数集，以在一系列机制下测试驱动项和阻尼。对于每种情况，您必须严格使用所提供的参数。\n\n- 情况 $1$（一般情况，驱动项和扩散均激活）：\n  - $L = 2\\pi$\n  - $N = 128$\n  - $\\kappa = 0.1$\n  - $\\sigma = 0.05$\n  - $m = 3$\n  - $A = 0.2$\n  - $\\Delta t = 10^{-3}$\n  - $T = 5.0$\n- 情况 $2$（仅驱动项，无扩散）：\n  - $L = 2\\pi$\n  - $N = 128$\n  - $\\kappa = 0.2$\n  - $\\sigma = 0.0$\n  - $m = 5$\n  - $A = 0.2$\n  - $\\Delta t = 10^{-3}$\n  - $T = 5.0$\n- 情况 $3$（仅扩散，无驱动项）：\n  - $L = 2\\pi$\n  - $N = 128$\n  - $\\kappa = 0.0$\n  - $\\sigma = 0.05$\n  - $m = 6$\n  - $A = 0.2$\n  - $\\Delta t = 10^{-3}$\n  - $T = 2.0$\n- 情况 $4$（负驱动项导致增长的竞争效应）：\n  - $L = 2\\pi$\n  - $N = 128$\n  - $\\kappa = -0.05$\n  - $\\sigma = 0.005$\n  - $m = 1$\n  - $A = 0.2$\n  - $\\Delta t = 10^{-3}$\n  - $T = 2.0$\n\n最终输出格式：\n- 您的程序应生成单行输出，包含上述案例测得的衰减率，形式为一个用方括号括起来的逗号分隔列表，例如 $\\left[ r_{1}, r_{2}, r_{3}, r_{4} \\right]$，其中每个 $r_{i}$ 是一个浮点数。", "solution": "问题陈述已经过验证，被认为是具有科学依据、适定且内容完备的。它描述了一个受控数值实验，用于研究一个简化的一维反应扩散方程，该方程可作为理解数值相对论中 BSSN 形式体系各组成部分的玩具模型。参数、初始条件和数值方法都得到了明确的规定，从而能够得出一个唯一且有意义的解。\n\n实验的核心是求解共形联络约束分量 $\\mathcal{G}^{x}(x,t)$ 的偏微分方程 (PDE)：\n$$\n\\partial_{t}\\mathcal{G}^{x} = -\\kappa\\,\\mathcal{G}^{x} + \\sigma\\,\\partial_{x}^{2}\\mathcal{G}^{x}\n$$\n在一个周期性空间区域 $x \\in [0, L]$ 上。参数 $\\kappa$ 和 $\\sigma$ 分别代表驱动项系数和耗散系数。初始条件是单个傅里叶正弦模式：\n$$\n\\mathcal{G}^{x}(x,0) = A\\,\\sin(kx), \\quad \\text{其中} \\quad k = \\frac{2\\pi m}{L}\n$$\n其中 $m$ 是某个整数模数。\n\n该偏微分方程是线性的，并且初始条件 $\\sin(kx)$ 是空间算子 $\\partial_{x}^{2}$ 的一个特征函数。具体来说，$\\partial_{x}^{2}\\sin(kx) = -k^2\\sin(kx)$。因此，我们可以寻求形如 $\\mathcal{G}^{x}(x,t) = a(t)\\sin(kx)$ 的解。将此代入偏微分方程，得到关于随时间变化的振幅 $a(t)$ 的常微分方程 (ODE)：\n$$\n\\frac{da(t)}{dt}\\sin(kx) = -\\kappa\\,a(t)\\sin(kx) + \\sigma\\,(-k^2 a(t)\\sin(kx))\n$$\n$$\n\\frac{da(t)}{dt} = -(\\kappa + \\sigma k^2)a(t)\n$$\n这个常微分方程的解是一个指数衰减或增长：\n$$\na(t) = a(0) e^{-(\\kappa + \\sigma k^2)t}\n$$\n其中 $a(0) = A$。绝对振幅的对数随时间线性变化：\n$$\n\\ln|a(t)| = \\ln|A| - (\\kappa + \\sigma k^2)t\n$$\n因此，理论衰减率 $r$（定义为 $r \\equiv -\\frac{d}{dt}\\ln|a(t)|$）是一个常数，由下式给出：\n$$\nr = \\kappa + \\sigma k^2\n$$\n该数值实验旨在通过模拟该偏微分方程并拟合得到的振幅数据来恢复此速率。\n\n数值实现过程如下：\n$1$. 将长度为 $L$ 的连续空间区域离散化为一个包含 $N$ 个点 $x_j = j \\Delta x$（$j = 0, 1, \\dots, N-1$）的网格，网格间距为 $\\Delta x = L/N$。函数 $\\mathcal{G}^x(x,t)$ 由每个网格点上的值数组 $\\mathcal{G}^x_j(t)$ 表示。\n\n$2$. 空间导数 $\\partial_{x}^{2}$ 使用二阶中心有限差分格式进行近似。由于周期性边界条件，端点的邻居会回绕。网格点 $j$ 处的离散拉普拉斯算子为：\n$$\n\\left.\\partial_{x}^{2}\\mathcal{G}^{x}\\right|_{j} \\approx \\frac{\\mathcal{G}^{x}_{j+1} - 2\\,\\mathcal{G}^{x}_{j} + \\mathcal{G}^{x}_{j-1}}{\\Delta x^{2}}\n$$\n其中索引对 $N$ 取模。\n\n$3$. 得到的耦合常微分方程组（每个网格点一个方程）使用显式四阶龙格-库塔 (RK4) 方法以固定时间步长 $\\Delta t$ 进行时间演化。对于给定的状态向量 $\\mathbf{G}(t) = \\{\\mathcal{G}^x_j(t)\\}$，常微分方程组的右端项是 $\\mathbf{F}(\\mathbf{G}) = -\\kappa \\mathbf{G} + \\sigma \\nabla^2 \\mathbf{G}$，其中 $\\nabla^2$ 是离散拉普拉斯算子。从时间 $t_n$ 到 $t_{n+1} = t_n + \\Delta t$ 的 RK4 更新为：\n$$\n\\begin{aligned}\n\\mathbf{k}_1 = \\mathbf{F}(\\mathbf{G}(t_n)) \\\\\n\\mathbf{k}_2 = \\mathbf{F}(\\mathbf{G}(t_n) + \\frac{\\Delta t}{2}\\mathbf{k}_1) \\\\\n\\mathbf{k}_3 = \\mathbf{F}(\\mathbf{G}(t_n) + \\frac{\\Delta t}{2}\\mathbf{k}_2) \\\\\n\\mathbf{k}_4 = \\mathbf{F}(\\mathbf{G}(t_n) + \\Delta t\\,\\mathbf{k}_3) \\\\\n\\mathbf{G}(t_{n+1}) = \\mathbf{G}(t_n) + \\frac{\\Delta t}{6}(\\mathbf{k}_1 + 2\\mathbf{k}_2 + 2\\mathbf{k}_3 + \\mathbf{k}_4)\n\\end{aligned}\n$$\n\n$4$. 在每个时间步 $t$，通过数值计算相应傅里叶系数的积分，从数值解 $\\mathcal{G}^x_j(t)$ 中提取模式 $\\sin(kx)$ 的振幅 $a(t)$：\n$$\na(t) = \\frac{2}{L} \\int_{0}^{L} \\mathcal{G}^{x}(x,t)\\,\\sin(kx)\\,dx\n$$\n该积分通过离散网格点上的黎曼和来近似：\n$$\na(t) \\approx \\frac{2}{L} \\sum_{j=0}^{N-1} \\mathcal{G}^x_j(t)\\,\\sin(kx_j)\\,\\Delta x = \\frac{2}{N} \\sum_{j=0}^{N-1} \\mathcal{G}^x_j(t)\\,\\sin(kx_j)\n$$\n\n$5$. 在总时间 $T$ 的模拟完成后，收集一组数据点 $(t_n, \\ln|a(t_n)|)$。对这些数据进行线性最小二乘拟合，以找到最佳拟合直线 $y(t) = p_1 t + p_0$。斜率 $p_1$ 是导数 $\\frac{d}{dt}\\ln|a(t)|$ 的数值估计。然后，衰减率 $r$ 计算为 $r = -p_1$。对提供的 $4$ 个测试案例中的每一个重复此过程。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the reduced BSSN constraint evolution equation for four test cases\n    and reports the measured decay rates.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1: general, driver and diffusion active\n        {'L': 2 * np.pi, 'N': 128, 'kappa': 0.1, 'sigma': 0.05, 'm': 3,\n         'A': 0.2, 'dt': 1e-3, 'T': 5.0},\n        # Case 2: driver only, no diffusion\n        {'L': 2 * np.pi, 'N': 128, 'kappa': 0.2, 'sigma': 0.0, 'm': 5,\n         'A': 0.2, 'dt': 1e-3, 'T': 5.0},\n        # Case 3: diffusion only, no driver\n        {'L': 2 * np.pi, 'N': 128, 'kappa': 0.0, 'sigma': 0.05, 'm': 6,\n         'A': 0.2, 'dt': 1e-3, 'T': 2.0},\n        # Case 4: competing effects with negative driver causing growth\n        {'L': 2 * np.pi, 'N': 128, 'kappa': -0.05, 'sigma': 0.005, 'm': 1,\n         'A': 0.2, 'dt': 1e-3, 'T': 2.0},\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        # Extract parameters\n        L = case['L']\n        N = case['N']\n        kappa = case['kappa']\n        sigma = case['sigma']\n        m = case['m']\n        A = case['A']\n        dt = case['dt']\n        T = case['T']\n\n        # Setup spatial grid\n        dx = L / N\n        x = np.linspace(0, L, N, endpoint=False)\n        \n        # Wavenumber\n        k = (2 * np.pi * m) / L\n\n        # Initial condition\n        G_x = A * np.sin(k * x)\n\n        def rhs(G, kappa_val, sigma_val, dx_val):\n            \"\"\"\n            Computes the right-hand side of the PDE: dG/dt = -kappa*G + sigma*d^2G/dx^2\n            \"\"\"\n            # 2nd-order finite difference for Laplacian with periodic boundaries\n            laplacian_G = (np.roll(G, -1) - 2 * G + np.roll(G, 1)) / (dx_val**2)\n            return -kappa_val * G + sigma_val * laplacian_G\n\n        times = []\n        amplitudes = []\n\n        t = 0.0\n        num_steps = int(round(T / dt))\n\n        for step in range(num_steps + 1):\n            # Measurement protocol: Compute mode amplitude a(t)\n            # a(t) = (2/L) * integral(G(x,t) * sin(kx) dx)\n            # Approximated by Riemann sum: (2/L) * sum(G * sin(kx) * dx)\n            # which simplifies to (2/N) * sum(G * sin(kx)) since dx = L/N\n            amplitude = (2.0 / N) * np.sum(G_x * np.sin(k * x))\n            \n            # Store data for linear regression, avoiding log(0)\n            if np.abs(amplitude) > 1e-15:\n                times.append(t)\n                amplitudes.append(amplitude)\n\n            if step == num_steps:\n                break\n\n            # Time evolution: 4th-order Runge-Kutta\n            k1 = rhs(G_x, kappa, sigma, dx)\n            k2 = rhs(G_x + 0.5 * dt * k1, kappa, sigma, dx)\n            k3 = rhs(G_x + 0.5 * dt * k2, kappa, sigma, dx)\n            k4 = rhs(G_x + dt * k3, kappa, sigma, dx)\n            G_x += (dt / 6.0) * (k1 + 2 * k2 + 2 * k3 + k4)\n            \n            t += dt\n\n        # Convert lists to numpy arrays for calculation\n        times = np.array(times)\n        amplitudes = np.array(amplitudes)\n\n        # Measurement protocol: Estimate decay rate r\n        # Fit ln|a(t)| versus t to a line: y = p1*t + p0\n        log_abs_amplitudes = np.log(np.abs(amplitudes))\n        \n        # polyfit returns [slope, intercept] for degree 1\n        coeffs = np.polyfit(times, log_abs_amplitudes, 1)\n        slope = coeffs[0]\n        \n        # Decay rate r is defined as r = -d/dt(ln|a(t)|)\n        r = -slope\n        results.append(r)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3489765"}]}