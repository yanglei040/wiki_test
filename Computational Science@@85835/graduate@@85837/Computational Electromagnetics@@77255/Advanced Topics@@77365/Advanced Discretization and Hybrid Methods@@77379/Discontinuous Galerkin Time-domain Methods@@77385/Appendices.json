{"hands_on_practices": [{"introduction": "The efficiency of any Discontinuous Galerkin Time-Domain (DGTD) method is deeply rooted in the properties of its elemental matrices, particularly the mass matrix. This exercise provides a foundational walkthrough of how to engineer these properties by carefully selecting the polynomial basis functions. By constructing an orthonormal modal basis on a reference tetrahedron, you will practice a core skill in DGTD code development and see firsthand how this choice simplifies the mass matrix for affine elements [@problem_id:3300621].", "problem": "Consider the semi-discrete formulation of Maxwell’s equations in a Discontinuous Galerkin (DG) method, specifically the Discontinuous Galerkin Time-Domain (DGTD) scheme on a single tetrahedral element. The semi-discrete system for the electric field involves a local mass matrix defined by the volume inner product of basis functions. Let the reference tetrahedron be $\\widehat{T} = \\{(r,s,t) \\in \\mathbb{R}^{3} : r \\ge 0,\\ s \\ge 0,\\ t \\ge 0,\\ r+s+t \\le 1\\}$, and let $K$ be a physical tetrahedral element obtained from $\\widehat{T}$ by an affine map.\n\nYour tasks are as follows:\n\n1) Define a modal polynomial basis $\\{\\widehat{\\psi}_{\\ell m n}\\}_{\\ell+m+n \\le p}$ on $\\widehat{T}$ up to total degree $p$, that is orthonormal with respect to the $L^{2}$ inner product on $\\widehat{T}$. Use collapsed coordinates and Jacobi polynomials to express a general basis element $\\widehat{\\psi}_{\\ell m n}(r,s,t)$, and include normalization through a constant $N_{\\ell m n}$ so that\n$$\n\\int_{\\widehat{T}} \\widehat{\\psi}_{\\ell m n}(r,s,t)\\,\\widehat{\\psi}_{\\ell' m' n'}(r,s,t)\\,\\mathrm{d}V = \\delta_{\\ell\\ell'}\\,\\delta_{m m'}\\,\\delta_{n n'}.\n$$\nGive the symbolic form of $\\widehat{\\psi}_{\\ell m n}$ in terms of Jacobi polynomials and explicitly state how the normalization constant $N_{\\ell m n}$ is chosen to enforce orthonormality.\n\n2) Let the physical tetrahedron $K$ have vertices $(0,0,0)$, $(2,0,0)$, $(0,3,0)$, $(0,0,4)$. Consider the affine map $\\Phi : \\widehat{T} \\to K$ given by $(x,y,z) = (2r,\\,3s,\\,4t)$, and define the pulled-back modal basis on $K$ by $\\psi_{\\ell m n}(x,y,z) = \\widehat{\\psi}_{\\ell m n}(r,s,t)$ with $(r,s,t) = \\Phi^{-1}(x,y,z)$. For the volume mass matrix\n$$\nM_{\\alpha\\beta} = \\int_{K} \\psi_{\\alpha}(x,y,z)\\,\\psi_{\\beta}(x,y,z)\\,\\mathrm{d}V,\n$$\ncompute representative entries $M_{(0,0,0),(0,0,0)}$ and $M_{(1,0,0),(0,0,0)}$ under exact integration.\n\n3) State precise conditions on a tetrahedral volume quadrature rule under which the discrete mass matrix computed by quadrature remains diagonal when using the orthonormal modal basis up to degree $p$, assuming an affine mapping. Express your conditions in terms of the required polynomial exactness degree of the quadrature relative to $p$, and justify why these conditions guarantee diagonalization.\n\n4) Provide the value of $M_{(0,0,0),(0,0,0)}$ for the physical element $K$ as a single real number. No rounding is required, and no units are necessary.", "solution": "The user has provided a multi-part problem concerning the Discontinuous Galerkin Time-Domain (DGTD) method on a tetrahedral element. The problem is scientifically grounded, well-posed, and objective. It is a standard exercise in the field of computational electromagnetics and numerical methods for partial differential equations. The problem is valid.\n\n**1) Orthonormal Modal Basis on the Reference Tetrahedron**\n\nThe first task is to define an orthonormal polynomial basis on the reference tetrahedron $\\widehat{T} = \\{(r,s,t) \\in \\mathbb{R}^{3} : r \\ge 0,\\ s \\ge 0,\\ t \\ge 0,\\ r+s+t \\le 1\\}$. A standard approach is to construct an orthogonal basis using collapsed coordinates and Jacobi polynomials, and then normalize it.\n\nWe define a set of collapsed coordinates $(\\xi_1, \\xi_2, \\xi_3) \\in [-1,1]^3$ from the Cartesian coordinates $(r,s,t) \\in \\widehat{T}$:\n$$\n\\xi_1 = 2\\frac{r}{1-s-t}-1, \\quad \\xi_2 = 2\\frac{s}{1-t}-1, \\quad \\xi_3 = 2t-1.\n$$\nAn orthogonal (but not yet orthonormal) modal basis $\\{\\widehat{\\phi}_{\\ell m n}\\}_{\\ell+m+n \\le p}$ on $\\widehat{T}$ for total polynomial degree up to $p$ is constructed as a product of Jacobi polynomials $P_k^{(\\alpha,\\beta)}$ with these coordinates:\n$$\n\\widehat{\\phi}_{\\ell m n}(r,s,t) = P_{\\ell}^{(0,0)}(\\xi_1) (1-s-t)^{\\ell} \\cdot P_{m}^{(2\\ell+1,0)}(\\xi_2) (1-t)^{m} \\cdot P_{n}^{(2\\ell+2m+2,0)}(\\xi_3).\n$$\nThe factors involving $(1-s-t)$ and $(1-t)$ are introduced to make the three components of the product orthogonal with respect to the standard volume measure on $\\widehat{T}$.\n\nTo find the normalization constant, we compute the squared $L^2$-norm of these basis functions, $h_{\\ell m n}^2 = \\int_{\\widehat{T}} |\\widehat{\\phi}_{\\ell m n}(r,s,t)|^2\\,\\mathrm{d}V$. This integral can be evaluated by a sequence of 1D integrations using the change of variables to $(\\xi_1, \\xi_2, \\xi_3)$. The volume element transforms as $\\mathrm{d}V = \\mathrm{d}r\\,\\mathrm{d}s\\,\\mathrm{d}t = \\frac{(1-t)^2(1-s-t)}{8}\\,\\mathrm{d}\\xi_1\\,\\mathrm{d}\\xi_2\\,\\mathrm{d}\\xi_3$. The integral separates due to the structure of the basis functions and the properties of Jacobi polynomials. The squared norm is found to be:\n$$\nh_{\\ell m n}^2 = \\int_{\\widehat{T}} |\\widehat{\\phi}_{\\ell m n}|^2\\,\\mathrm{d}V = \\frac{1}{(2\\ell+1) \\cdot 2(m+\\ell+1) \\cdot (2n+2\\ell+2m+3)}.\n$$\nThe orthonormal basis $\\{\\widehat{\\psi}_{\\ell m n}\\}$ is then obtained by normalizing $\\{\\widehat{\\phi}_{\\ell m n}\\}$:\n$$\n\\widehat{\\psi}_{\\ell m n} = \\frac{1}{h_{\\ell m n}} \\widehat{\\phi}_{\\ell m n} = N_{\\ell m n} \\widehat{\\phi}_{\\ell m n}.\n$$\nThe normalization constant $N_{\\ell m n}$ is therefore the reciprocal of $h_{\\ell m n}$:\n$$\nN_{\\ell m n} = \\sqrt{(2\\ell+1) \\cdot 2(m+\\ell+1) \\cdot (2n+2\\ell+2m+3)}.\n$$\nThe final expression for the orthonormal basis function is:\n$$\n\\widehat{\\psi}_{\\ell m n}(r,s,t) = N_{\\ell m n} \\cdot P_{\\ell}^{(0,0)}\\left(2\\frac{r}{1-s-t}-1\\right) (1-s-t)^{\\ell} \\cdot P_{m}^{(2\\ell+1,0)}\\left(2\\frac{s}{1-t}-1\\right) (1-t)^{m} \\cdot P_{n}^{(2\\ell+2m+2,0)}(2t-1).\n$$\nThis basis satisfies the required condition $\\int_{\\widehat{T}} \\widehat{\\psi}_{\\ell m n}\\,\\widehat{\\psi}_{\\ell' m' n'}\\,\\mathrm{d}V = \\delta_{\\ell\\ell'}\\,\\delta_{m m'}\\,\\delta_{n n'}$.\n\n**2) Mass Matrix Entries for a Physical Element**\n\nThe mass matrix on the physical element $K$ is given by $M_{\\alpha\\beta} = \\int_{K} \\psi_{\\alpha}\\psi_{\\beta}\\,\\mathrm{d}V$, where $\\alpha=(\\ell,m,n)$ and $\\beta=(\\ell',m',n')$. The basis functions on $K$ are defined by pulling back the reference basis, $\\psi_{\\alpha}(x,y,z) = \\widehat{\\psi}_{\\alpha}(\\Phi^{-1}(x,y,z))$.\n\nThe affine map is $\\Phi: (r,s,t) \\mapsto (x,y,z) = (2r, 3s, 4t)$. The Jacobian matrix of this transformation is constant:\n$$\nJ = \\begin{pmatrix} \\frac{\\partial x}{\\partial r} & \\frac{\\partial x}{\\partial s} & \\frac{\\partial x}{\\partial t} \\\\ \\frac{\\partial y}{\\partial r} & \\frac{\\partial y}{\\partial s} & \\frac{\\partial y}{\\partial t} \\\\ \\frac{\\partial z}{\\partial r} & \\frac{\\partial z}{\\partial s} & \\frac{\\partial z}{\\partial t} \\end{pmatrix} = \\begin{pmatrix} 2 & 0 & 0 \\\\ 0 & 3 & 0 \\\\ 0 & 0 & 4 \\end{pmatrix}.\n$$\nThe determinant of the Jacobian is $|J| = 2 \\cdot 3 \\cdot 4 = 24$.\nUsing the change of variables formula for integration, the mass matrix entry is:\n$$\nM_{\\alpha\\beta} = \\int_{K} \\psi_{\\alpha}(\\mathbf{x})\\psi_{\\beta}(\\mathbf{x})\\,\\mathrm{d}\\mathbf{x} = \\int_{\\widehat{T}} \\widehat{\\psi}_{\\alpha}(\\mathbf{r})\\widehat{\\psi}_{\\beta}(\\mathbf{r})\\,|J|\\,\\mathrm{d}\\mathbf{r} = |J| \\int_{\\widehat{T}} \\widehat{\\psi}_{\\alpha}(\\mathbf{r})\\widehat{\\psi}_{\\beta}(\\mathbf{r})\\,\\mathrm{d}\\mathbf{r}.\n$$\nDue to the orthonormality of the basis $\\{\\widehat{\\psi}_{\\alpha}\\}$ on $\\widehat{T}$, the integral is simply the Kronecker delta $\\delta_{\\alpha\\beta}$:\n$$\nM_{\\alpha\\beta} = |J|\\,\\delta_{\\alpha\\beta} = 24\\,\\delta_{\\ell\\ell'}\\,\\delta_{mm'}\\,\\delta_{nn'}.\n$$\nThis shows that for an affine mapping, the mass matrix is diagonal, with each diagonal entry equal to the constant Jacobian determinant $|J|$.\n\nWe can now compute the requested entries:\n- For $\\alpha = \\beta = (0,0,0)$:\n$$M_{(0,0,0),(0,0,0)} = 24\\,\\delta_{00}\\,\\delta_{00}\\,\\delta_{00} = 24 \\cdot 1 \\cdot 1 \\cdot 1 = 24.$$\n- For $\\alpha = (1,0,0)$ and $\\beta = (0,0,0)$:\n$$M_{(1,0,0),(0,0,0)} = 24\\,\\delta_{10}\\,\\delta_{00}\\,\\delta_{00} = 24 \\cdot 0 \\cdot 1 \\cdot 1 = 0.$$\n\n**3) Condition for Diagonal Quadrature-Based Mass Matrix**\n\nThe discrete mass matrix $M^h$ is assembled using a numerical quadrature rule on the physical element $K$. Its entries are $M^h_{\\alpha\\beta} = \\sum_{q=1}^{N_q} w_q \\psi_{\\alpha}(x_q)\\psi_{\\beta}(x_q)$, where $(x_q, w_q)$ are the quadrature points and weights on $K$.\n\nTo analyze this, we transform the quadrature to the reference element $\\widehat{T}$. Let $(\\widehat{x}_q, \\widehat{w}_q)$ be the quadrature rule on $\\widehat{T}$. For an affine map $\\Phi$, the corresponding rule on $K$ is $x_q = \\Phi(\\widehat{x}_q)$ and $w_q = |J|\\widehat{w}_q$. The discrete mass matrix entry becomes:\n$$\nM^h_{\\alpha\\beta} = \\sum_{q=1}^{N_q} (|J|\\widehat{w}_q) \\widehat{\\psi}_{\\alpha}(\\widehat{x}_q)\\widehat{\\psi}_{\\beta}(\\widehat{x}_q) = |J| \\sum_{q=1}^{N_q} \\widehat{w}_q \\widehat{\\psi}_{\\alpha}(\\widehat{x}_q)\\widehat{\\psi}_{\\beta}(\\widehat{x}_q).\n$$\nFor this matrix to be diagonal, we require $M^h_{\\alpha\\beta} = C \\delta_{\\alpha\\beta}$ for some constant $C$. Comparing with the exact mass matrix $M_{\\alpha\\beta} = |J|\\delta_{\\alpha\\beta}$, we see that we must have:\n$$\n\\sum_{q=1}^{N_q} \\widehat{w}_q \\widehat{\\psi}_{\\alpha}(\\widehat{x}_q)\\widehat{\\psi}_{\\beta}(\\widehat{x}_q) = \\int_{\\widehat{T}} \\widehat{\\psi}_{\\alpha}(\\mathbf{r})\\widehat{\\psi}_{\\beta}(\\mathbf{r})\\,\\mathrm{d}\\mathbf{r} = \\delta_{\\alpha\\beta}.\n$$\nThis means the quadrature rule on the reference element must exactly integrate the product of any two basis functions $\\widehat{\\psi}_{\\alpha}$ and $\\widehat{\\psi}_{\\beta}$ up to degree $p$.\n\nThe basis function $\\widehat{\\psi}_{\\alpha} = \\widehat{\\psi}_{\\ell m n}$ is a polynomial of total degree $\\ell+m+n$. Since $\\ell+m+n \\le p$, the degree of $\\widehat{\\psi}_{\\alpha}$ is at most $p$. The product $\\widehat{\\psi}_{\\alpha}\\widehat{\\psi}_{\\beta}$ is therefore a polynomial of degree at most $p+p=2p$.\n\nThus, the condition for the quadrature to preserve the diagonality of the mass matrix is that the quadrature rule on the reference tetrahedron must be exact for all polynomials of total degree up to $2p$. For an affine map, the constant Jacobian determinant does not increase the required polynomial degree.\n\n**4) Value of $M_{(0,0,0),(0,0,0)}$**\n\nAs computed in part 2, the value for this mass matrix entry is:\n$$\nM_{(0,0,0),(0,0,0)} = 24.\n$$\nThis can also be verified directly. The basis function $\\widehat{\\psi}_{000}$ is a constant. From Part 1, $N_{000} = \\sqrt{(1) \\cdot 2(1) \\cdot (3)} = \\sqrt{6}$. Since $P_0=1$, $\\widehat{\\phi}_{000}=1$, so $\\widehat{\\psi}_{000} = \\sqrt{6}$. Thus, $\\psi_{000}(x,y,z) = \\sqrt{6}$ on $K$. The entry is:\n$$M_{(0,0,0),(0,0,0)} = \\int_K (\\sqrt{6})^2\\,\\mathrm{d}V = 6 \\int_K \\mathrm{d}V = 6 \\cdot \\text{Volume}(K).$$\nThe volume of the tetrahedron $K$ with vertices $(0,0,0)$, $(2,0,0)$, $(0,3,0)$, $(0,0,4)$ is\n$$\\text{Volume}(K) = \\frac{1}{6} \\left| \\det \\begin{pmatrix} 2 & 0 & 0 \\\\ 0 & 3 & 0 \\\\ 0 & 0 & 4 \\end{pmatrix} \\right| = \\frac{24}{6} = 4.$$\nTherefore, $M_{(0,0,0),(0,0,0)} = 6 \\cdot 4 = 24$.", "answer": "$$\\boxed{24}$$", "id": "3300621"}, {"introduction": "Having explored the construction of an orthonormal basis, we now investigate its practical consequences for the 'time-domain' aspect of DGTD. The structure of the mass matrix directly dictates the computational cost of advancing the solution in time with an explicit scheme. This practice will challenge you to analyze the profound impact of a diagonal versus a full mass matrix on algorithmic efficiency, solidifying the 'why' behind the design choices made in the previous exercise [@problem_id:3300605].", "problem": "In Discontinuous Galerkin time-domain (DGTD) discretizations of source-free Maxwell curl equations in a lossless, homogeneous dielectric, one starts from the continuous equations\n$$\n\\frac{\\partial \\mathbf{D}}{\\partial t} = \\nabla \\times \\mathbf{H}, \\qquad \\frac{\\partial \\mathbf{B}}{\\partial t} = - \\nabla \\times \\mathbf{E},\n$$\nwith constitutive relations $\\mathbf{D} = \\varepsilon \\mathbf{E}$ and $\\mathbf{B} = \\mu \\mathbf{H}$, where $\\varepsilon > 0$ and $\\mu > 0$. On a mesh of non-overlapping elements $K_e$, the discontinuous Galerkin weak form uses an elementwise test space and numerical fluxes on interfaces. After choosing a polynomial basis $\\{\\phi_i\\}_{i=1}^{N_p}$ on each element $K_e$ to expand the field components and integrating by parts elementwise, the semi-discrete system on each element takes the form\n$$\n\\mathbf{M}_e \\frac{d \\mathbf{U}_e}{d t} = \\mathbf{R}_e(\\{\\mathbf{U}_{e'}\\}),\n$$\nwhere $\\mathbf{U}_e \\in \\mathbb{R}^{N_{\\text{fld}} N_p}$ collects the coefficients of the field components on $K_e$ for $N_{\\text{fld}}$ field components, $\\mathbf{M}_e$ is the element mass matrix defined by the $L^2$ inner product of basis functions over $K_e$, and $\\mathbf{R}_e$ includes both volume differentiation and numerical flux surface terms involving neighboring element traces $\\{\\mathbf{U}_{e'}\\}$. An explicit Runge–Kutta time integrator updates via repeated evaluations of $\\mathbf{M}_e^{-1}\\mathbf{R}_e$ on each element.\n\nConsider two choices of elementwise bases: (i) a non-orthonormal nodal basis, leading to a full (dense) $\\mathbf{M}_e$, and (ii) an orthonormal modal basis with respect to the $L^2$ inner product on a reference element $\\hat{K}$, mapped to $K_e$ by an affine mapping with constant Jacobian determinant $J_e > 0$. Assume exact quadrature sufficient to integrate all polynomial products arising in $\\mathbf{M}_e$ and in the volume terms. Let $N_p$ denote the number of scalar basis functions per element for a given polynomial order $p$, and consider a uniform mesh with affine elements so that all $J_e$ are constants per element.\n\nSelect all statements that are correct regarding the effect of diagonal versus full element mass matrices on the efficiency and stability of explicit time stepping, and the role of orthonormal modal bases:\n\nA. With a strictly orthonormal modal basis on $\\hat{K}$ and exact quadrature, the element mass matrix on $K_e$ is diagonal up to the constant scaling by $J_e$, i.e., $\\mathbf{M}_e = J_e \\mathbf{I}$ for scalar fields (and block-diagonal with identical diagonal blocks for multiple field components). Consequently, each explicit stage requires only componentwise scalings by $J_e^{-1}$ to apply $\\mathbf{M}_e^{-1}$ locally.\n\nB. Using a full (dense) element mass matrix in an explicit DGTD scheme reduces the global Courant–Friedrichs–Lewy (CFL) time step restriction compared to a diagonal mass matrix because the dense inverse $\\mathbf{M}_e^{-1}$ damps high-frequency modal content and thereby enlarges the stability region effectively.\n\nC. For affine elements in $3$ dimensions with polynomial order $p$ and $N_p$ unknowns per scalar field per element, the per-stage cost to apply $\\mathbf{M}_e^{-1}$ scales as $\\mathcal{O}(N_p)$ for a diagonal mass (orthonormal modal basis) and as $\\mathcal{O}(N_p^2)$ when applying a precomputed dense inverse for a full mass matrix, neglecting memory hierarchy effects.\n\nD. Orthonormality of a modal basis with respect to the $L^2$ inner product can be achieved only on tensor-product hexahedra; on simplices, any reasonable polynomial basis produces an element mass matrix that is at least block-dense, so $\\mathbf{M}_e$ cannot be diagonalized by a fixed modal choice.\n\nE. The primary benefit of diagonal element mass matrices in DGTD is that they eliminate the need to evaluate numerical fluxes on element interfaces, making the update entirely local within each element at every explicit stage.\n\nChoose all that apply and justify your selection by reasoning from the elementwise weak form, the definition of the mass matrix, and the structure of explicit Runge–Kutta updates, without assuming any unstated algorithmic shortcuts.", "solution": "This problem tests the understanding of how basis function choice impacts the structure of the mass matrix and the efficiency of explicit time-stepping schemes in DGTD. We will analyze each statement.\n\n**Analysis of the Mass Matrix**\nThe element mass matrix $\\mathbf{M}_e$ for a scalar field is given by entries $(M_e)_{ij} = \\int_{K_e} \\phi_i(\\mathbf{x}) \\phi_j(\\mathbf{x}) \\, dV$. Using an affine map $\\mathcal{F}_e$ from a reference element $\\hat{K}$ to the physical element $K_e$, this integral transforms to:\n$$\n(M_e)_{ij} = \\int_{\\hat{K}} \\hat{\\phi}_i(\\hat{\\mathbf{x}}) \\hat{\\phi}_j(\\hat{\\mathbf{x}}) J_e \\, d\\hat{V} = J_e \\int_{\\hat{K}} \\hat{\\phi}_i(\\hat{\\mathbf{x}}) \\hat{\\phi}_j(\\hat{\\mathbf{x}}) \\, d\\hat{V}\n$$\nwhere $J_e$ is the constant Jacobian determinant and $\\{\\hat{\\phi}_i\\}$ is the basis on the reference element. If $\\{\\hat{\\phi}_i\\}$ is orthonormal, then $\\int_{\\hat{K}} \\hat{\\phi}_i \\hat{\\phi}_j \\, d\\hat{V} = \\delta_{ij}$. Thus, $(M_e)_{ij} = J_e \\delta_{ij}$, meaning $\\mathbf{M}_e = J_e \\mathbf{I}$. The inverse is trivial: $\\mathbf{M}_e^{-1} = J_e^{-1} \\mathbf{I}$.\n\n**Evaluation of Statements:**\n\n**A. Correct.** As shown above, using an orthonormal basis on the reference element with an affine map results in a mass matrix that is a scaled identity matrix, $\\mathbf{M}_e = J_e \\mathbf{I}$. For vector fields where each component uses this basis, the full mass matrix is block-diagonal, with each block being $J_e \\mathbf{I}$. Applying the inverse $\\mathbf{M}_e^{-1}$ is therefore a simple scaling of the right-hand side vector by $J_e^{-1}$, which is a computationally cheap component-wise operation.\n\n**B. Incorrect.** The choice of mass matrix affects the spectrum of the semi-discrete operator $\\mathbf{M}_e^{-1}\\mathbf{R}_e$, which in turn determines the CFL limit. While the exact stability limit differs between a full (consistent) and a diagonal (lumped) mass matrix, a full matrix does not generally provide a significant advantage for explicit schemes. In fact, the main motivation for diagonal mass matrices is to avoid the high cost of inverting a dense matrix at every stage, not to manipulate the CFL limit. The statement's reasoning is flawed and its phrasing (\"reduces the... restriction\") is ambiguous and likely incorrect.\n\n**C. Correct.** An explicit time-stepping stage requires applying $\\mathbf{M}_e^{-1}$ to the residual vector.\n- For a diagonal mass matrix of size $N_p \\times N_p$, this is a vector scaling, which takes $\\mathcal{O}(N_p)$ operations.\n- For a full (dense) mass matrix, applying its precomputed inverse involves a matrix-vector multiplication, which takes $\\mathcal{O}(N_p^2)$ operations.\nThe statement correctly identifies these scaling complexities.\n\n**D. Incorrect.** This statement is false. While tensor-product bases on hexahedra are straightforward to orthogonalize, orthonormal polynomial bases can be, and have been, constructed for simplicial elements (triangles and tetrahedra). Examples include bases derived from Gram-Schmidt orthogonalization or specialized constructions like Dubiner polynomials. Therefore, it is entirely possible to obtain a diagonal mass matrix on simplices with a suitable choice of a modal basis.\n\n**E. Incorrect.** This statement confuses the roles of the mass matrix and the numerical flux. The mass matrix arises from the time-derivative term ($\\partial \\mathbf{U}/\\partial t$) and relates the time derivative of the coefficients to the spatial operator. The numerical fluxes are a key component of the spatial operator ($\\mathbf{R}_e$) and are essential for communication between elements. A diagonal mass matrix simplifies the time-stepping update, but it does not eliminate the need for fluxes. The calculation of $\\mathbf{R}_e$ still requires data from neighboring elements.\n\nTherefore, the only correct statements are A and C.", "answer": "$$\\boxed{AC}$$", "id": "3300605"}, {"introduction": "While affine elements are useful for understanding fundamentals, real-world simulations must often accommodate curved geometries. This practice moves beyond simple mappings to tackle isoparametric elements, which introduce spatially-varying geometric factors. You will derive the necessary transformation metrics and assemble matrix entries on a curved hexahedron, gaining essential experience with the covariant Piola transform and the impact of metric tensors on the DGTD formulation [@problem_id:3300567].", "problem": "Consider three-dimensional source-free Maxwell’s equations written in their curl form as fundamental laws, together with the standard discontinuous Galerkin (DG) time-domain (TD) semi-discrete formulation that yields elemental volume mass and curl-curl stiffness bilinear forms. Let the computational element be a single curved hexahedron obtained by an isoparametric mapping from the reference cube $[\\xi,\\eta,\\zeta] \\in [-1,1]^3$ to physical coordinates $[x,y,z] \\in \\mathbb{R}^3$ defined by\n$$\nx(\\xi,\\eta,\\zeta) = a\\,\\xi + \\alpha\\,\\xi\\,\\eta,\\quad\ny(\\xi,\\eta,\\zeta) = b\\,\\eta,\\quad\nz(\\xi,\\eta,\\zeta) = c\\,\\zeta,\n$$\nwhere $a>0$, $b>0$, $c>0$, and $0<\\alpha<a$ ensure the mapping is orientation-preserving and nonsingular on the reference domain. The elemental volume mass bilinear form for the electric field is\n$$\nM(\\boldsymbol{u}_x,\\boldsymbol{v}_x) = \\int_{K_x} \\boldsymbol{u}_x \\cdot \\boldsymbol{v}_x \\,\\mathrm{d}x,\n$$\nand the elemental curl-curl stiffness bilinear form is\n$$\nK(\\boldsymbol{u}_x,\\boldsymbol{v}_x) = \\int_{K_x} \\left(\\nabla_x \\times \\boldsymbol{u}_x\\right) \\cdot \\left(\\nabla_x \\times \\boldsymbol{v}_x\\right)\\,\\mathrm{d}x,\n$$\nwhere subscript $x$ denotes physical-space fields. In order to assemble these in a discontinuous Galerkin time-domain method for computational electromagnetics, one must transform the integrals to the reference element and use the covariant Piola mapping for $H(\\mathrm{curl})$-conforming vector fields. Starting from Maxwell’s curl laws, the change-of-variables formula for integrals, and the requirement that tangential traces be preserved under the mapping, derive the geometric factors required for the transformation, including the Jacobian matrix $\\boldsymbol{J} = \\frac{\\partial(x,y,z)}{\\partial(\\xi,\\eta,\\zeta)}$, its determinant $\\det\\boldsymbol{J}$, and the metric coefficients that enter $M$ and $K$.\n\nThen, using the derived geometric factors, assemble the following two elemental volume contributions on the curved hexahedron:\n1. The mass entry with both trial and test reference fields chosen as $\\boldsymbol{u}_{\\xi}(\\xi,\\eta,\\zeta) = \\boldsymbol{v}_{\\xi}(\\xi,\\eta,\\zeta) = [1,\\,0,\\,0]^{\\top}$.\n2. The curl-curl stiffness entry with both trial and test reference fields chosen as $\\boldsymbol{u}_{\\xi}(\\xi,\\eta,\\zeta) = \\boldsymbol{v}_{\\xi}(\\xi,\\eta,\\zeta) = [0,\\,\\xi,\\,0]^{\\top}$.\n\nFinally, compute the exact ratio\n$$\nR \\equiv \\frac{M\\big(\\boldsymbol{u}_x,\\boldsymbol{v}_x\\big)}{K\\big(\\boldsymbol{u}_x,\\boldsymbol{v}_x\\big)}\n$$\nfor these choices, expressed in terms of the mapping parameters $a$, $b$, $c$, and $\\alpha$. No numerical evaluation is required. Express your final answer in $\\mathrm{m}^2$. Do not round; report the exact closed-form expression.", "solution": "To solve this problem, we must transform the mass and stiffness bilinear forms from the physical, curved element $K_x$ to the reference cube $K_\\xi = [-1,1]^3$. This requires calculating the geometric factors from the isoparametric map and applying the appropriate Piola transformation.\n\n**Step 1: Geometric Factors and Transformations**\nThe mapping is $\\boldsymbol{x}(\\boldsymbol{\\xi}) = [a\\xi + \\alpha\\xi\\eta, b\\eta, c\\zeta]^{\\top}$.\nThe Jacobian matrix $\\boldsymbol{J}$ and its determinant $\\det\\boldsymbol{J}$ are:\n$$\n\\boldsymbol{J} = \\frac{\\partial(x,y,z)}{\\partial(\\xi,\\eta,\\zeta)} = \\begin{pmatrix}\na + \\alpha\\eta & \\alpha\\xi & 0 \\\\\n0 & b & 0 \\\\\n0 & 0 & c\n\\end{pmatrix} \\quad \\implies \\quad \\det\\boldsymbol{J} = bc(a+\\alpha\\eta)\n$$\nFor $H(\\mathrm{curl})$-conforming fields, the covariant Piola transform relates the physical field $\\boldsymbol{u}_x$ and reference field $\\boldsymbol{u}_\\xi$ via $\\boldsymbol{u}_x = (\\boldsymbol{J}^{-T}) \\boldsymbol{u}_\\xi$. The curls are related by $\\nabla_x \\times \\boldsymbol{u}_x = \\frac{1}{\\det\\boldsymbol{J}} \\boldsymbol{J} (\\nabla_\\xi \\times \\boldsymbol{u}_\\xi)$. The bilinear forms transform as:\n$$\nM(\\boldsymbol{u}_x, \\boldsymbol{v}_x) = \\int_{K_\\xi} \\left( (\\boldsymbol{J}^{-T}) \\boldsymbol{u}_\\xi \\right) \\cdot \\left( (\\boldsymbol{J}^{-T}) \\boldsymbol{v}_\\xi \\right) \\det\\boldsymbol{J} \\, \\mathrm{d}\\xi = \\int_{K_\\xi} \\boldsymbol{u}_\\xi^{\\top} (\\boldsymbol{J}^{\\top}\\boldsymbol{J})^{-1} \\boldsymbol{v}_\\xi \\, \\det\\boldsymbol{J} \\, \\mathrm{d}\\xi\n$$\n$$\nK(\\boldsymbol{u}_x, \\boldsymbol{v}_x) = \\int_{K_\\xi} \\frac{1}{\\det\\boldsymbol{J}} (\\nabla_\\xi \\times \\boldsymbol{u}_\\xi)^{\\top} (\\boldsymbol{J}^{\\top}\\boldsymbol{J}) (\\nabla_\\xi \\times \\boldsymbol{v}_\\xi) \\, \\mathrm{d}\\xi\n$$\n\n**Step 2: Calculation of the Mass Entry**\nWe are given the reference field $\\boldsymbol{u}_\\xi = \\boldsymbol{v}_\\xi = [1, 0, 0]^{\\top}$. We need the integrand $\\boldsymbol{u}_\\xi^{\\top} (\\boldsymbol{J}^{\\top}\\boldsymbol{J})^{-1} \\boldsymbol{u}_\\xi \\, \\det\\boldsymbol{J}$.\nFirst, we find the first column of $\\boldsymbol{J}^{-1}$:\n$$\n\\boldsymbol{J}^{-1} = \\frac{1}{bc(a+\\alpha\\eta)} \\begin{pmatrix} bc & -\\alpha\\xi c & 0 \\\\ 0 & c(a+\\alpha\\eta) & 0 \\\\ 0 & 0 & b(a+\\alpha\\eta) \\end{pmatrix}^{\\top} = \\frac{1}{b(a+\\alpha\\eta)} \\begin{pmatrix} b \\\\ -\\alpha\\xi \\\\ 0 \\end{pmatrix} \\quad \\text{(1st column)}\n$$\nThe transformed physical field is $\\boldsymbol{u}_x = (\\boldsymbol{J}^{-T})\\boldsymbol{u}_\\xi = \\frac{1}{b(a+\\alpha\\eta)}[b, -\\alpha\\xi, 0]^{\\top}$.\nThe dot product is $\\boldsymbol{u}_x \\cdot \\boldsymbol{u}_x = \\frac{b^2 + \\alpha^2\\xi^2}{b^2(a+\\alpha\\eta)^2}$.\nThe mass integral is:\n$$\nM = \\int_{K_\\xi} (\\boldsymbol{u}_x \\cdot \\boldsymbol{u}_x) \\det\\boldsymbol{J} \\, \\mathrm{d}\\xi = \\int_{-1}^1\\int_{-1}^1\\int_{-1}^1 \\frac{b^2 + \\alpha^2\\xi^2}{b^2(a+\\alpha\\eta)^2} \\cdot bc(a+\\alpha\\eta) \\, \\mathrm{d}\\xi\\mathrm{d}\\eta\\mathrm{d}\\zeta\n$$\n$$\nM = \\frac{c}{b} \\int_{-1}^1\\int_{-1}^1\\int_{-1}^1 \\frac{b^2 + \\alpha^2\\xi^2}{a+\\alpha\\eta} \\, \\mathrm{d}\\xi\\mathrm{d}\\eta\\mathrm{d}\\zeta = \\frac{c}{b} \\left(\\int_{-1}^1 \\mathrm{d}\\zeta\\right) \\left(\\int_{-1}^1 (b^2+\\alpha^2\\xi^2) \\mathrm{d}\\xi\\right) \\left(\\int_{-1}^1 \\frac{\\mathrm{d}\\eta}{a+\\alpha\\eta}\\right)\n$$\nEvaluating each integral:\n$$\nM = \\frac{c}{b} \\cdot (2) \\cdot \\left[b^2\\xi + \\frac{\\alpha^2\\xi^3}{3}\\right]_{-1}^1 \\cdot \\left[\\frac{1}{\\alpha}\\ln(a+\\alpha\\eta)\\right]_{-1}^1 = \\frac{2c}{b} \\left(2b^2 + \\frac{2\\alpha^2}{3}\\right) \\frac{1}{\\alpha}\\ln\\left(\\frac{a+\\alpha}{a-\\alpha}\\right)\n$$\n$$\nM = \\frac{4c}{b\\alpha} \\left(b^2 + \\frac{\\alpha^2}{3}\\right) \\ln\\left(\\frac{a+\\alpha}{a-\\alpha}\\right)\n$$\n\n**Step 3: Calculation of the Stiffness Entry**\nWe are given the reference field $\\boldsymbol{u}_\\xi = \\boldsymbol{v}_\\xi = [0, \\xi, 0]^{\\top}$. Its curl is:\n$$\n\\nabla_\\xi \\times \\boldsymbol{u}_\\xi = \\det \\begin{pmatrix} \\boldsymbol{\\hat{\\xi}} & \\boldsymbol{\\hat{\\eta}} & \\boldsymbol{\\hat{\\zeta}} \\\\ \\partial_\\xi & \\partial_\\eta & \\partial_\\zeta \\\\ 0 & \\xi & 0 \\end{pmatrix} = [0, 0, 1]^{\\top}\n$$\nThe integrand for the stiffness form is $\\frac{1}{\\det\\boldsymbol{J}} (\\nabla_\\xi \\times \\boldsymbol{u}_\\xi)^{\\top} (\\boldsymbol{J}^{\\top}\\boldsymbol{J}) (\\nabla_\\xi \\times \\boldsymbol{u}_\\xi)$. This requires the $(3,3)$ entry of the metric tensor $\\boldsymbol{G} = \\boldsymbol{J}^{\\top}\\boldsymbol{J}$, which is $G_{33} = c^2$.\nThe integrand is $\\frac{G_{33}}{\\det\\boldsymbol{J}} = \\frac{c^2}{bc(a+\\alpha\\eta)} = \\frac{c}{b(a+\\alpha\\eta)}$.\nThe stiffness integral is:\n$$\nK = \\int_{-1}^1\\int_{-1}^1\\int_{-1}^1 \\frac{c}{b(a+\\alpha\\eta)} \\, \\mathrm{d}\\xi\\mathrm{d}\\eta\\mathrm{d}\\zeta = \\frac{c}{b} \\left(\\int_{-1}^1 \\mathrm{d}\\xi\\right) \\left(\\int_{-1}^1 \\mathrm{d}\\zeta\\right) \\left(\\int_{-1}^1 \\frac{\\mathrm{d}\\eta}{a+\\alpha\\eta}\\right)\n$$\n$$\nK = \\frac{c}{b} \\cdot (2) \\cdot (2) \\cdot \\frac{1}{\\alpha}\\ln\\left(\\frac{a+\\alpha}{a-\\alpha}\\right) = \\frac{4c}{b\\alpha} \\ln\\left(\\frac{a+\\alpha}{a-\\alpha}\\right)\n$$\n\n**Step 4: Computation of the Ratio**\nThe final ratio is:\n$$\nR = \\frac{M}{K} = \\frac{\\frac{4c}{b\\alpha} \\left(b^2 + \\frac{\\alpha^2}{3}\\right) \\ln\\left(\\frac{a+\\alpha}{a-\\alpha}\\right)}{\\frac{4c}{b\\alpha} \\ln\\left(\\frac{a+\\alpha}{a-\\alpha}\\right)} = b^2 + \\frac{\\alpha^2}{3}\n$$\nThe units are consistent, as $b$ has units of length and $\\alpha$ is a ratio of lengths times length, so it also has units of length. The result is in $\\text{m}^2$.", "answer": "$$\\boxed{b^2 + \\frac{\\alpha^2}{3}}$$", "id": "3300567"}]}