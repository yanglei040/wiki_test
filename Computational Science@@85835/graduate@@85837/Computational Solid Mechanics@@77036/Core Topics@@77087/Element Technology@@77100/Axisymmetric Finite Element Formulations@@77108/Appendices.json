{"hands_on_practices": [{"introduction": "The journey into axisymmetric formulations begins with a deep dive into its unique kinematics. A crucial component that differentiates this analysis from 2D planar problems is the hoop strain, $\\varepsilon_{\\theta\\theta}$. This exercise challenges you to derive the expression for hoop strain from fundamental continuum mechanics principles and then confront the apparent singularity at the axis of symmetry, $r=0$, a classic problem in axisymmetric finite element analysis [@problem_id:3545424].", "problem": "Consider an isoparametric axisymmetric quadrilateral finite element in cylindrical coordinates with radial coordinate $r$ and axial coordinate $z$. The displacement field is axisymmetric (no dependence on the circumferential angle), and the small-strain tensor is assumed valid. The discrete kinematic interpolation within the element is\n$$\nu_r(r,z) = \\sum_{i=1}^{n} N_i(r,z)\\,u_{ri},\\qquad\nu_z(r,z) = \\sum_{i=1}^{n} N_i(r,z)\\,u_{zi},\n$$\nwhere $N_i$ are the shape functions, $u_{ri}$ and $u_{zi}$ are the nodal radial and axial displacement degrees of freedom, and $n$ is the number of nodes. Let $(r_g,z_g)$ denote a Gauss point in the physical element with radius $r_g \\ge 0$.\n\nStarting from the definition of the small-strain tensor in cylindrical coordinates and the axisymmetric kinematic assumptions, derive the hoop (circumferential) strain component $\\varepsilon_{\\theta\\theta}$ at the Gauss point $(r_g,z_g)$ in terms of $N_i$, $u_{ri}$, and $r_g$. Carefully justify each step using fundamental continuum kinematics in cylindrical coordinates and the provided displacement interpolation. Then, discuss how to handle the apparent $1/r$ singularity in $\\varepsilon_{\\theta\\theta}$ as $r_g \\to 0$ to obtain a finite, well-defined limit at the axis, and derive the corresponding limiting expression in terms of $N_i$ and their derivatives with respect to $r$.\n\nProvide your final answer as a single symbolic expression for $\\varepsilon_{\\theta\\theta}$ at a general Gauss point with $r_g>0$. Since the final answer is symbolic, no rounding is required. Strain is dimensionless; do not include units in the final answer.", "solution": "**Problem Validation**\n\n**Step 1: Extract Givens**\n- Coordinate System: Cylindrical coordinates with radial coordinate $r$ and axial coordinate $z$.\n- Element Type: Isoparametric axisymmetric quadrilateral finite element.\n- Kinematic Assumption: The displacement field is axisymmetric, with no dependence on the circumferential angle.\n- Strain Assumption: The small-strain tensor is valid.\n- Discrete Kinematic Interpolation:\n  $$u_r(r,z) = \\sum_{i=1}^{n} N_i(r,z)\\,u_{ri}$$\n  $$u_z(r,z) = \\sum_{i=1}^{n} N_i(r,z)\\,u_{zi}$$\n- Definitions: $N_i$ are the shape functions, $u_{ri}$ and $u_{zi}$ are the nodal radial and axial displacement degrees of freedom, $n$ is the number of nodes.\n- Evaluation Point: A Gauss point $(r_g, z_g)$ in the physical element with radius $r_g \\ge 0$.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem statement is evaluated based on the established criteria.\n- **Scientifically Grounded**: The problem is firmly rooted in the classical theory of continuum mechanics and the finite element method, specifically for axisymmetric analysis. The concepts of strain-displacement relations in cylindrical coordinates and isoparametric interpolation are standard and rigorously defined in computational solid mechanics.\n- **Well-Posed**: The problem is well-posed. It asks for the derivation of a specific quantity (hoop strain) based on a complete set of provided definitions and assumptions. The second part of the question, regarding the singularity at the axis of symmetry, is a standard and well-understood topic in axisymmetric formulations, for which a unique and meaningful limiting value exists.\n- **Objective**: The problem is stated in precise, objective, and quantitative terms. All terms are standard within the field and free of ambiguity or subjective interpretation.\n\nThe problem does not exhibit any of the flaws listed for invalidity. It is scientifically sound, formally structured, complete, and poses a meaningful question within its specified domain.\n\n**Step 3: Verdict and Action**\nThe problem is valid. A complete, reasoned solution will be provided.\n\n**Solution Derivation**\n\nThe objective is to derive the expression for the hoop (circumferential) strain component, $\\varepsilon_{\\theta\\theta}$, at a Gauss point $(r_g, z_g)$, and to analyze its behavior as the radial coordinate approaches zero.\n\nFirst, we recall the small-strain tensor components in a cylindrical coordinate system $(r, \\theta, z)$. The displacement vector is $\\mathbf{u} = u_r(r,z) \\mathbf{e}_r + u_z(r,z) \\mathbf{e}_z$, where the axisymmetric assumption implies that the displacements do not depend on the circumferential coordinate $\\theta$, and the circumferential displacement component $u_\\theta$ is zero. The strain-displacement relations are given by:\n$$ \\varepsilon_{rr} = \\frac{\\partial u_r}{\\partial r} $$\n$$ \\varepsilon_{zz} = \\frac{\\partial u_z}{\\partial z} $$\n$$ \\varepsilon_{\\theta\\theta} = \\frac{1}{r}\\frac{\\partial u_\\theta}{\\partial \\theta} + \\frac{u_r}{r} $$\n$$ \\varepsilon_{rz} = \\gamma_{rz} = \\frac{1}{2}\\left( \\frac{\\partial u_r}{\\partial z} + \\frac{\\partial u_z}{\\partial r} \\right) $$\nThe other shear strain components, $\\varepsilon_{r\\theta}$ and $\\varepsilon_{z\\theta}$, are zero due to the axisymmetric assumption ($u_\\theta=0$ and $\\partial/\\partial\\theta=0$).\n\nWe are interested in the hoop strain, $\\varepsilon_{\\theta\\theta}$. The general expression is $\\varepsilon_{\\theta\\theta} = \\frac{1}{r}\\frac{\\partial u_\\theta}{\\partial \\theta} + \\frac{u_r}{r}$. Applying the axisymmetric assumption, the circumferential displacement $u_\\theta$ is zero. Consequently, its derivative with respect to $\\theta$ is also zero. This simplifies the expression for the hoop strain to:\n$$ \\varepsilon_{\\theta\\theta} = \\frac{u_r}{r} $$\nThis equation expresses a fundamental kinematic relationship in axisymmetric problems: the hoop strain at a point is equal to the radial displacement at that point divided by its radial coordinate.\n\nNext, we introduce the finite element discretization for the radial displacement $u_r$. As given in the problem statement, the displacement within an element is interpolated from the nodal displacements using shape functions $N_i$:\n$$ u_r(r,z) = \\sum_{i=1}^{n} N_i(r,z)\\,u_{ri} $$\nwhere $n$ is the number of nodes in the element, $u_{ri}$ are the nodal values of the radial displacement, and $N_i(r,z)$ are the shape functions.\n\nTo find the hoop strain at the specified Gauss point $(r_g, z_g)$, we substitute the interpolated displacement field into the kinematic relation for $\\varepsilon_{\\theta\\theta}$ and evaluate the expression at this point. Assuming $r_g > 0$, we have:\n$$ \\varepsilon_{\\theta\\theta}(r_g, z_g) = \\frac{u_r(r_g, z_g)}{r_g} $$\nSubstituting the expression for $u_r(r_g, z_g)$:\n$$ \\varepsilon_{\\theta\\theta}(r_g, z_g) = \\frac{1}{r_g} \\left( \\sum_{i=1}^{n} N_i(r_g, z_g)\\,u_{ri} \\right) $$\nThis is the expression for the hoop strain at a general point $(r_g, z_g)$ with a non-zero radius.\n\nNow, we address the second part of the problem: the behavior as $r_g \\to 0$. The expression $\\varepsilon_{\\theta\\theta} = u_r/r$ has an apparent singularity at $r=0$. However, physical continuity requires that a point on the axis of revolution ($r=0$) cannot have a non-zero radial displacement, as this would create a void or material self-penetration. Therefore, a physical constraint exists:\n$$ u_r(0, z) = 0 \\quad \\text{for all } z $$\nIn the context of the finite element model, this means for any element that has nodes on the axis of symmetry, the radial displacement degrees of freedom $u_{ri}$ for those specific nodes $i$ must be constrained to zero. With this constraint, the interpolated radial displacement $u_r(r,z)$ approaches zero as $r \\to 0$.\n\nThus, the limit of $\\varepsilon_{\\theta\\theta}$ as $r \\to 0$ becomes an indeterminate form of the type $0/0$:\n$$ \\lim_{r \\to 0} \\varepsilon_{\\theta\\theta}(r, z) = \\lim_{r \\to 0} \\frac{u_r(r, z)}{r} $$\nWe can evaluate this limit using L'Hôpital's rule, by differentiating the numerator and the denominator with respect to $r$:\n$$ \\lim_{r \\to 0} \\frac{u_r(r, z)}{r} = \\lim_{r \\to 0} \\frac{\\frac{\\partial u_r}{\\partial r}(r,z)}{\\frac{\\partial r}{\\partial r}} = \\lim_{r \\to 0} \\frac{\\partial u_r}{\\partial r}(r,z) = \\frac{\\partial u_r}{\\partial r}\\bigg|_{r=0} $$\nFrom the strain-displacement relations, we recognize that $\\frac{\\partial u_r}{\\partial r}$ is the radial strain component, $\\varepsilon_{rr}$. Therefore, at the axis of symmetry, the hoop strain is equal to the radial strain:\n$$ \\varepsilon_{\\theta\\theta}(0, z) = \\varepsilon_{rr}(0, z) $$\nThis is a required condition for strain compatibility at the axis of symmetry.\n\nTo find the limiting expression in terms of the finite element quantities, we first compute the derivative of the interpolated displacement field with respect to $r$:\n$$ \\frac{\\partial u_r}{\\partial r}(r,z) = \\frac{\\partial}{\\partial r} \\left( \\sum_{i=1}^{n} N_i(r,z)\\,u_{ri} \\right) = \\sum_{i=1}^{n} \\frac{\\partial N_i}{\\partial r}(r,z)\\,u_{ri} $$\nEvaluating this expression at a point on the axis of symmetry, $(0, z_g)$, gives the limiting value of the hoop strain:\n$$ \\lim_{r_g \\to 0} \\varepsilon_{\\theta\\theta}(r_g, z_g) = \\left( \\sum_{i=1}^{n} \\frac{\\partial N_i}{\\partial r}(r,z)\\,u_{ri} \\right)\\bigg|_{(r=0, z=z_g)} = \\sum_{i=1}^{n} \\frac{\\partial N_i}{\\partial r}(0, z_g)\\,u_{ri} $$\nThis expression is finite and well-defined, resolving the apparent singularity. For practical computation at a Gauss point located exactly on the axis, this latter formula is used. For any Gauss point with $r_g > 0$, the former expression is used.\n\nThe problem asks for the single symbolic expression for $\\varepsilon_{\\theta\\theta}$ at a general Gauss point with $r_g > 0$. This corresponds to the first part of our derivation.", "answer": "$$\n\\boxed{\\frac{1}{r_g} \\sum_{i=1}^{n} N_i(r_g, z_g)\\,u_{ri}}\n$$", "id": "3545424"}, {"introduction": "Once the theoretical foundations are in place, the focus shifts to robust implementation and verification. The patch test is an essential rite of passage for any finite element, confirming its ability to reproduce exact solutions for simple, constant-strain states. This hands-on practice guides you through designing and implementing a \"ring patch test\" to verify that your axisymmetric element correctly captures a state of constant hydrostatic stress, a crucial benchmark for its accuracy [@problem_id:3502235].", "problem": "You are to design and implement a ring patch test program for an axisymmetric bilinear quadrilateral element within the Finite Element Method (FEM), starting from first principles of small-strain kinematics and isotropic linear elasticity. The objective is to enforce a constant hydrostatic stress state where the radial, circumferential, and axial normal stresses are equal, and the shear stress is zero. Specifically, the target state is a constant stress field satisfying $\\sigma_{rr}=\\sigma_{\\theta\\theta}=\\sigma_{zz}=c$ and $\\sigma_{rz}=0$, and to verify that the axisymmetric formulation correctly reproduces the non-zero circumferential strain $\\epsilon_{\\theta\\theta}=u_r/r$ under linear displacement fields $u_r(r)$ and $u_z(z)$.\n\nUsing the small-strain axisymmetric framework, proceed from the definitions of strains and equilibrium without shortcuts. The displacement field must be chosen as linear in radius and axial coordinates, with $u_r(r)=\\alpha\\,r$ and $u_z(z)=\\alpha\\,z$, where $\\alpha$ is to be derived such that the resulting stress state is the specified constant $c$ in Pascals. Derive $\\alpha$ explicitly from the isotropic linear elasticity (Hooke’s law) relation for a hydrostatic stress state, expressed through the bulk modulus and the volumetric strain, ensuring $\\sigma_{rr}=\\sigma_{\\theta\\theta}=\\sigma_{zz}=c$ and $\\sigma_{rz}=0$.\n\nImplement the axisymmetric strain-displacement mapping for a single bilinear quadrilateral ring element with nodes at the inner radius $a$ and outer radius $b$, spanning axial coordinates from $z=0$ to $z=H$. The element’s four nodes are ordered as $(a,0)$, $(b,0)$, $(b,H)$, $(a,H)$. Use the standard isoparametric bilinear shape functions over the natural coordinate domain $(\\xi,\\eta)\\in[-1,1]\\times[-1,1]$ and compute the strain components at Gauss points using a $2\\times 2$ Gaussian quadrature with Gauss points at $\\xi,\\eta=\\pm 1/\\sqrt{3}$.\n\nFrom first principles:\n- Use the small-strain axisymmetric definitions to compute the strains $\\epsilon_{rr}$, $\\epsilon_{zz}$, $\\epsilon_{\\theta\\theta}$, and $\\gamma_{rz}$ from the nodal displacements via the strain-displacement matrix that includes the $1/r$ contribution for the circumferential strain, where $\\epsilon_{\\theta\\theta}=u_r/r$.\n- Use the isotropic linear elastic constitutive law to compute the corresponding stresses $\\sigma_{rr}$, $\\sigma_{zz}$, $\\sigma_{\\theta\\theta}$, and $\\sigma_{rz}$ from the strain components, expressed using Lamé parameters or equivalently elasticity modulus and Poisson’s ratio, derived from Hooke’s law without inserting pre-known element formulas.\n\nVerification criteria at each Gauss point must include:\n- $\\sigma_{rr}$, $\\sigma_{\\theta\\theta}$, and $\\sigma_{zz}$ each equal to $c$ within a numerical tolerance.\n- $\\sigma_{rz}$ equal to $0$ within a numerical tolerance.\n- $\\epsilon_{\\theta\\theta}$ equal to the scalar $\\alpha$ within a numerical tolerance.\n- $\\gamma_{rz}$ equal to $0$ within a numerical tolerance.\n\nUse the following test suite of parameter sets to evaluate your implementation. Radii and heights must be in meters, moduli in Pascals, and the target stress $c$ in Pascals. In each case, derive $\\alpha$ and apply the displacement field to the element nodes, then compute strains and stresses at all four Gauss points:\n1. $E=100{,}000{,}000$ Pa, $\\nu=0.25$, $a=0.5$ m, $b=1.0$ m, $H=1.0$ m, $c=1{,}200{,}000$ Pa.\n2. $E=10{,}000{,}000$ Pa, $\\nu=0.499$, $a=0.5$ m, $b=1.0$ m, $H=1.0$ m, $c=50{,}000$ Pa.\n3. $E=200{,}000{,}000$ Pa, $\\nu=0.30$, $a=0.9$ m, $b=1.0$ m, $H=0.2$ m, $c=200{,}000$ Pa.\n4. $E=50{,}000{,}000$ Pa, $\\nu=0.33$, $a=0.01$ m, $b=0.21$ m, $H=0.3$ m, $c=100{,}000$ Pa.\n5. $E=150{,}000{,}000$ Pa, $\\nu=0.27$, $a=0.4$ m, $b=0.8$ m, $H=0.5$ m, $c=-100{,}000$ Pa.\n\nYour program must:\n- Compute the strain and stress components at each Gauss point.\n- Verify the stated conditions at all Gauss points for each test case with tolerances defined as follows:\n  - For stresses, an absolute tolerance of $\\tau_\\sigma = 10^{-9}\\cdot\\max(1,|c|)$.\n  - For strains, an absolute tolerance of $\\tau_\\epsilon = 10^{-9}\\cdot\\max(1,|\\alpha|)$.\n- Produce a single line of output containing the pass/fail results for the five test cases as a comma-separated list of boolean values enclosed in square brackets, for example, `[True,False,...]`.\n\nAll physical quantities must be handled in the stated units, and angles do not appear in this problem. The final outputs are booleans and therefore unitless. The derivation and implementation must start from the fundamental definitions of small-strain axisymmetric kinematics and isotropic linear elasticity and must include the circumferential strain contribution $\\epsilon_{\\theta\\theta}=u_r/r$ in the element kinematics.", "solution": "The problem statement is a valid, well-posed verification task within the domain of computational solid mechanics. It requires the implementation of a patch test for a 4-node bilinear axisymmetric element to confirm its ability to reproduce a constant hydrostatic stress state. All necessary physical and geometric parameters, as well as verification criteria, are provided. The problem is scientifically sound and algorithmically formalizable.\n\nThe solution proceeds in three main stages:\n1.  Derivation of the kinematic constant $\\alpha$ required to achieve the target hydrostatic stress state.\n2.  Formulation of the axisymmetric bilinear quadrilateral element, including strain-displacement and constitutive relations from first principles.\n3.  Algorithmic implementation of the patch test, evaluating strains and stresses at Gauss quadrature points and comparing them against the theoretical values.\n\n**1. Derivation of the Kinematic Constant $\\alpha$**\n\nThe problem prescribes a linear displacement field, $u_r(r) = \\alpha r$ and $u_z(z) = \\alpha z$. The constant $\\alpha$ must be determined such that this displacement field yields the target hydrostatic stress state: $\\sigma_{rr} = \\sigma_{\\theta\\theta} = \\sigma_{zz} = c$ and $\\sigma_{rz} = 0$.\n\nFirst, we compute the strain components from the given displacement field using the small-strain axisymmetric kinematic relations:\nThe strain components are defined as:\n$\\epsilon_{rr} = \\frac{\\partial u_r}{\\partial r}$\n$\\epsilon_{zz} = \\frac{\\partial u_z}{\\partial z}$\n$\\epsilon_{\\theta\\theta} = \\frac{u_r}{r}$\n$\\gamma_{rz} = \\frac{\\partial u_r}{\\partial z} + \\frac{\\partial u_z}{\\partial r}$\n\nSubstituting the prescribed displacement field:\n$\\epsilon_{rr} = \\frac{\\partial (\\alpha r)}{\\partial r} = \\alpha$\n$\\epsilon_{zz} = \\frac{\\partial (\\alpha z)}{\\partial z} = \\alpha$\n$\\epsilon_{\\theta\\theta} = \\frac{\\alpha r}{r} = \\alpha$\n$\\gamma_{rz} = \\frac{\\partial (\\alpha r)}{\\partial z} + \\frac{\\partial (\\alpha z)}{\\partial r} = 0 + 0 = 0$\n\nThis displacement field thus corresponds to a constant strain state where the three normal strains are equal to $\\alpha$ and the shear strain is zero. The volumetric strain, $\\epsilon_v$, is the sum of the normal strains:\n$\\epsilon_v = \\epsilon_{rr} + \\epsilon_{zz} + \\epsilon_{\\theta\\theta} = \\alpha + \\alpha + \\alpha = 3\\alpha$\n\nThe stress state is hydrostatic, with mean stress $p$:\n$p = \\frac{\\sigma_{rr} + \\sigma_{zz} + \\sigma_{\\theta\\theta}}{3} = \\frac{c + c + c}{3} = c$\n\nFor an isotropic linear elastic material, the mean stress is related to the volumetric strain via the bulk modulus, $K$:\n$p = K \\epsilon_v$\n\nThe bulk modulus $K$ is related to Young's modulus $E$ and Poisson's ratio $\\nu$ by:\n$K = \\frac{E}{3(1 - 2\\nu)}$\n\nSubstituting the expressions for $p$, $\\epsilon_v$, and $K$:\n$c = \\left(\\frac{E}{3(1 - 2\\nu)}\\right) (3\\alpha)$\n$c = \\frac{E\\alpha}{1 - 2\\nu}$\n\nSolving for the unknown constant $\\alpha$ gives the required relation:\n$\\alpha = c \\frac{1 - 2\\nu}{E}$\n\nThis derivation confirms that the prescribed displacement field is indeed the correct one to produce the target hydrostatic stress state in an isotropic linear elastic material.\n\n**2. Axisymmetric Finite Element Formulation**\n\nThe patch test is performed on a single 4-node bilinear isoparametric element.\nThe element nodes are ordered counter-clockwise: $1: (a, 0)$, $2: (b, 0)$, $3: (b, H)$, $4: (a, H)$.\n\nThe displacement field $\\{u_r(r, z), u_z(r, z)\\}$ within the element is interpolated from the nodal displacements $\\mathbf{d} = [u_{r1}, u_{z1}, u_{r2}, u_{z2}, u_{r3}, u_{z3}, u_{r4}, u_{z4}]^T$ using bilinear shape functions $N_i(\\xi, \\eta)$ in the natural coordinate system $(\\xi, \\eta) \\in [-1, 1] \\times [-1, 1]$:\n$u_r(\\xi, \\eta) = \\sum_{i=1}^{4} N_i(\\xi, \\eta) u_{ri}$\n$u_z(\\xi, \\eta) = \\sum_{i=1}^{4} N_i(\\xi, \\eta) u_{zi}$\nwhere $N_1 = \\frac{1}{4}(1-\\xi)(1-\\eta)$, $N_2 = \\frac{1}{4}(1+\\xi)(1-\\eta)$, $N_3 = \\frac{1}{4}(1+\\xi)(1+\\eta)$, $N_4 = \\frac{1}{4}(1-\\xi)(1+\\eta)$.\n\nThe nodal displacements are determined by evaluating the theoretical displacement field at the nodes:\n$u_{r1} = \\alpha a, u_{z1} = 0$; $u_{r2} = \\alpha b, u_{z2} = 0$; $u_{r3} = \\alpha b, u_{z3} = \\alpha H$; $u_{r4} = \\alpha a, u_{z4} = \\alpha H$.\n\nTo calculate strains, we need derivatives of the displacements with respect to the global coordinates $(r, z)$, which are obtained via the chain rule:\n$$\n\\begin{Bmatrix} \\frac{\\partial f}{\\partial r} \\\\ \\frac{\\partial f}{\\partial z} \\end{Bmatrix} = \\mathbf{J}^{-1} \\begin{Bmatrix} \\frac{\\partial f}{\\partial \\xi} \\\\ \\frac{\\partial f}{\\partial \\eta} \\end{Bmatrix}\n$$\nwhere $\\mathbf{J}$ is the Jacobian matrix of the coordinate mapping $r(\\xi, \\eta) = \\sum N_i r_i$ and $z(\\xi, \\eta) = \\sum N_i z_i$:\n$$\n\\mathbf{J} = \\begin{bmatrix} \\frac{\\partial r}{\\partial \\xi} & \\frac{\\partial z}{\\partial \\xi} \\\\ \\frac{\\partial r}{\\partial \\eta} & \\frac{\\partial z}{\\partial \\eta} \\end{bmatrix} = \\begin{bmatrix} \\sum \\frac{\\partial N_i}{\\partial \\xi} r_i & \\sum \\frac{\\partial N_i}{\\partial \\xi} z_i \\\\ \\sum \\frac{\\partial N_i}{\\partial \\eta} r_i & \\sum \\frac{\\partial N_i}{\\partial \\eta} z_i \\end{bmatrix}\n$$\nThe axisymmetric strain vector $\\boldsymbol{\\epsilon} = [\\epsilon_{rr}, \\epsilon_{zz}, \\epsilon_{\\theta\\theta}, \\gamma_{rz}]^T$ relates to the nodal displacements via the strain-displacement matrix $\\mathbf{B}$: $\\boldsymbol{\\epsilon} = \\mathbf{B}\\mathbf{d}$. The matrix $\\mathbf{B}$ is constructed from derivatives of the shape functions and the radial position $r$:\n$$\n\\mathbf{B} = [\\mathbf{B}_1, \\mathbf{B}_2, \\mathbf{B}_3, \\mathbf{B}_4], \\quad \\text{where} \\quad \\mathbf{B}_i = \\begin{bmatrix}\n\\frac{\\partial N_i}{\\partial r} & 0 \\\\\n0 & \\frac{\\partial N_i}{\\partial z} \\\\\n\\frac{N_i}{r} & 0 \\\\\n\\frac{\\partial N_i}{\\partial z} & \\frac{\\partial N_i}{\\partial r}\n\\end{bmatrix}\n$$\nNote the term $N_i/r$ in the third row, which is unique to the axisymmetric formulation and arises from the circumferential strain $\\epsilon_{\\theta\\theta} = u_r/r$. This term makes the $\\mathbf{B}$ matrix explicitly dependent on the radial coordinate $r$.\n\nThe stresses $\\boldsymbol{\\sigma} = [\\sigma_{rr}, \\sigma_{zz}, \\sigma_{\\theta\\theta}, \\sigma_{rz}]^T$ are computed from the strains using the isotropic linear elastic constitutive matrix $\\mathbf{D}$. From the generalized Hooke's Law, $\\sigma_{ij} = 2G\\epsilon_{ij} + \\lambda \\epsilon_{kk}\\delta_{ij}$ (where $\\lambda$ and $G$ are Lamé parameters), we can derive the constitutive matrix for the axisymmetric case:\n$$\n\\boldsymbol{\\sigma} = \\mathbf{D} \\boldsymbol{\\epsilon}\n$$\n$$\n\\mathbf{D} = \\frac{E}{(1+\\nu)(1-2\\nu)} \\begin{bmatrix}\n1-\\nu & \\nu & \\nu & 0 \\\\\n\\nu & 1-\\nu & \\nu & 0 \\\\\n\\nu & \\nu & 1-\\nu & 0 \\\\\n0 & 0 & 0 & \\frac{1-2\\nu}{2}\n\\end{bmatrix}\n$$\n\n**3. Algorithmic Verification Procedure**\n\nThe patch test confirms that the numerical formulation correctly reproduces the theoretical solution. The procedure involves evaluating strains and stresses at the $2 \\times 2$ Gauss quadrature points within the element and checking them against the expected constant values.\n\nFor each test case defined by $\\{E, \\nu, a, b, H, c\\}$:\n1.  Calculate the theoretical kinematic constant $\\alpha = c(1-2\\nu)/E$.\n2.  Determine the nodal displacements $\\mathbf{d}$ for the element with corners at $(a,0), (b,0), (b,H), (a,H)$.\n3.  Define the Gauss quadrature points $(\\xi_g, \\eta_g)$ at $\\xi_g, \\eta_g = \\pm 1/\\sqrt{3}$.\n4.  For each Gauss point:\n    a. Evaluate the shape functions $N_i$ and their derivatives with respect to natural coordinates, $\\partial N_i/\\partial \\xi$ and $\\partial N_i/\\partial \\eta$.\n    b. Compute the Jacobian matrix $\\mathbf{J}$ and its inverse $\\mathbf{J}^{-1}$ at the Gauss point.\n    c. Use $\\mathbf{J}^{-1}$ to find the shape function derivatives with respect to global coordinates, $\\partial N_i/\\partial r$ and $\\partial N_i/\\partial z$.\n    d. Determine the global radial coordinate $r_g$ of the Gauss point.\n    e. Assemble the strain-displacement matrix $\\mathbf{B}$ using the values at $(r_g, z_g)$.\n    f. Compute the strain vector at the Gauss point: $\\boldsymbol{\\epsilon}_g = \\mathbf{B}(r_g, z_g) \\mathbf{d}$.\n    g. Compute the stress vector at the Gauss point: $\\boldsymbol{\\sigma}_g = \\mathbf{D} \\boldsymbol{\\epsilon}_g$.\n5.  Verify the computed values against the theoretical solution:\n    - $\\sigma_{rr,g}, \\sigma_{zz,g}, \\sigma_{\\theta\\theta,g}$ must equal $c$ within tolerance $\\tau_\\sigma = 10^{-9} \\cdot \\max(1, |c|)$.\n    - $\\sigma_{rz,g}$ must equal $0$ within tolerance $\\tau_\\sigma$.\n    - $\\epsilon_{\\theta\\theta,g}$ must equal $\\alpha$ within tolerance $\\tau_\\epsilon = 10^{-9} \\cdot \\max(1, |\\alpha|)$.\n    - $\\gamma_{rz,g}$ must equal $0$ within tolerance $\\tau_\\epsilon$.\n6.  If all checks pass for all four Gauss points, the patch test for that test case is successful.\n\nSince the prescribed displacement field is linear in $r$ and $z$, and a bilinear element can perfectly represent any function of the form $f(r,z) = c_1 + c_2 r + c_3 z + c_4 rz$ on a rectangular domain, the interpolated displacement field within the element will exactly match the theoretical field. Consequently, the numerically computed strains and stresses should match the theoretical constant values to within machine precision. The test is therefore expected to pass for all provided cases.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef run_patch_test(E, nu, a, b, H, c):\n    \"\"\"\n    Performs a ring patch test for a single axisymmetric bilinear element.\n\n    Args:\n        E (float): Young's modulus in Pascals.\n        nu (float): Poisson's ratio.\n        a (float): Inner radius in meters.\n        b (float): Outer radius in meters.\n        H (float): Element height in meters.\n        c (float): Target hydrostatic stress in Pascals.\n\n    Returns:\n        bool: True if the test passes, False otherwise.\n    \"\"\"\n\n    # 1. Derive theoretical kinematic constant alpha\n    # For a hydrostatic stress state, c = E*alpha / (1 - 2*nu)\n    if abs(1 - 2 * nu) < 1e-15:\n        # For nu=0.5, a finite stress c requires infinite volumetric strain, unless c=0.\n        # This parameter set is not expected. But handle gracefully.\n        alpha = 0.0 if c == 0.0 else float('inf')\n    else:\n        alpha = c * (1 - 2 * nu) / E\n\n    # 2. Define element geometry and nodal displacements\n    # Nodal coordinates: Node 1 to 4, counter-clockwise\n    node_coords = np.array([\n        [a, 0.],  # Node 1\n        [b, 0.],  # Node 2\n        [b, H],   # Node 3\n        [a, H]    # Node 4\n    ])\n\n    # Nodal displacements from u_r = alpha*r, u_z = alpha*z\n    # DOF vector: [u_r1, u_z1, u_r2, u_z2, u_r3, u_z3, u_r4, u_z4]\n    dof_vals = np.array([\n        alpha * a, 0.,          # Node 1\n        alpha * b, 0.,          # Node 2\n        alpha * b, alpha * H,   # Node 3\n        alpha * a, alpha * H    # Node 4\n    ])\n\n    # 3. Define constitutive matrix D for axisymmetric case\n    factor = E / ((1 + nu) * (1 - 2 * nu))\n    D_matrix = factor * np.array([\n        [1 - nu, nu,     nu,     0],\n        [nu,     1 - nu, nu,     0],\n        [nu,     nu,     1 - nu, 0],\n        [0,      0,      0,      (1 - 2 * nu) / 2]\n    ])\n\n    # 4. Gauss quadrature points for 2x2 scheme\n    gp_val = 1 / np.sqrt(3)\n    gauss_points = [\n        (-gp_val, -gp_val), (gp_val, -gp_val),\n        (gp_val, gp_val),   (-gp_val, gp_val)\n    ]\n\n    # Verification tolerances\n    tol_stress = 1e-9 * max(1, abs(c))\n    tol_strain = 1e-9 * max(1, abs(alpha))\n\n    # 5. Loop over Gauss points to compute strains and stresses\n    for xi, eta in gauss_points:\n        # Shape functions N at (xi, eta)\n        N_vec = 0.25 * np.array([\n            (1 - xi) * (1 - eta),\n            (1 + xi) * (1 - eta),\n            (1 + xi) * (1 + eta),\n            (1 - xi) * (1 + eta)\n        ])\n\n        # Derivatives of shape functions w.r.t. natural coordinates (xi, eta)\n        grad_N_nat = 0.25 * np.array([\n            [-(1 - eta),  (1 - eta),  (1 + eta), -(1 + eta)],  # dN/dxi\n            [-(1 - xi),  -(1 + xi),   (1 + xi),   (1 - xi)]   # dN/deta\n        ])\n\n        # Jacobian matrix J = d(r,z)/d(xi,eta)\n        J_matrix = grad_N_nat @ node_coords\n        \n        if abs(np.linalg.det(J_matrix)) < 1e-15:\n            return False  # Degenerate element\n\n        J_inv = np.linalg.inv(J_matrix)\n\n        # Derivatives of shape functions w.r.t. global coordinates (r, z)\n        grad_N_glob = J_inv @ grad_N_nat\n\n        # Coordinates (r, z) of the Gauss point\n        r_gp, z_gp = N_vec @ node_coords\n\n        # Construct strain-displacement matrix B for axisymmetric element\n        B_matrix = np.zeros((4, 8))\n        for i in range(4):\n            dNi_dr = grad_N_glob[0, i]\n            dNi_dz = grad_N_glob[1, i]\n            Ni = N_vec[i]\n            \n            # Strain components [eps_rr, eps_zz, eps_thetatheta, gamma_rz]\n            B_matrix[0, 2 * i] = dNi_dr\n            B_matrix[1, 2 * i + 1] = dNi_dz\n            B_matrix[2, 2 * i] = Ni / r_gp\n            B_matrix[3, 2 * i] = dNi_dz\n            B_matrix[3, 2 * i + 1] = dNi_dr\n\n        # Calculate strain and stress vectors at the Gauss point\n        epsilon = B_matrix @ dof_vals\n        sigma = D_matrix @ epsilon\n\n        # 6. Verification checks\n        # Stresses: sig_rr, sig_zz, sig_thetatheta should be c; sig_rz should be 0.\n        if not np.allclose(sigma[:3], c, atol=tol_stress, rtol=0):\n            return False\n        if not np.allclose(sigma[3], 0, atol=tol_stress, rtol=0):\n            return False\n        \n        # Strains: eps_thetatheta should be alpha; gamma_rz should be 0.\n        if not np.allclose(epsilon[2], alpha, atol=tol_strain, rtol=0):\n            return False\n        if not np.allclose(epsilon[3], 0, atol=tol_strain, rtol=0):\n            return False\n\n    return True\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print results.\n    \"\"\"\n    test_cases = [\n        # (E, nu, a, b, H, c)\n        (100_000_000, 0.25, 0.5, 1.0, 1.0, 1_200_000),\n        (10_000_000, 0.499, 0.5, 1.0, 1.0, 50_000),\n        (200_000_000, 0.30, 0.9, 1.0, 0.2, 200_000),\n        (50_000_000, 0.33, 0.01, 0.21, 0.3, 100_000),\n        (150_000_000, 0.27, 0.4, 0.8, 0.5, -100_000),\n    ]\n\n    results = []\n    for case in test_cases:\n        result = run_patch_test(*case)\n        results.append(str(result))\n\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "3502235"}, {"introduction": "The presence of the $1/r$ term in the hoop strain formulation, while kinematically necessary, introduces significant numerical challenges as elements approach the axis of symmetry. This advanced practice explores the practical consequences, guiding you to investigate the numerical conditioning of the stiffness matrix for different meshing strategies near the axis. By comparing wedge-like and offset meshes, you will gain insight into the sources of ill-conditioning and explore techniques to ensure numerical stability in your models [@problem_id:3545417].", "problem": "You are asked to implement and compare two axisymmetric meridian mesh topologies adjacent to the axis in the context of computational solid mechanics, and to quantify numerical conditioning of the assembled stiffness matrix as the minimum radius approaches the axis. The derivation must start from first principles and use a consistent axisymmetric formulation for four-node bilinear isoparametric quadrilateral elements. The comparison should consider wedge-like meshes (with nodes lying on the axis) and rectangular meshes (offset by a strictly positive minimum radius). You must also implement a mapping strategy to avoid collapse in the hoop strain terms when the radius is very small.\n\nThe fundamental base that must be used includes the following, without providing any shortcut formulas:\n- Newton's laws of motion for continua and the principle of virtual work relating internal virtual work to external virtual work.\n- Small-strain kinematics in axisymmetry, where displacements are functions of the meridian coordinates and independent of the circumferential coordinate, and the hoop strain is defined consistently with axisymmetry.\n- Isotropic linear elasticity (Hooke's law) in three dimensions specialized to axisymmetric conditions, introducing the Lamé parameters from the Young's modulus and Poisson's ratio.\n- Isoparametric mapping for quadrilateral elements, Jacobian transformation between parent and physical coordinates, and Gaussian quadrature for numerical integration.\n\nYour program must:\n1. Construct two-element meridian meshes in the $r$-$z$ plane with the same axial extent. Each element is a four-node bilinear quadrilateral. One mesh is wedge-like adjacent to the axis, with the left column of nodes having $r=0$. The other is rectangular and offset from the axis so that the left column has $r=r_{\\min}>0$.\n2. Assemble the global axisymmetric stiffness matrix using a consistent bilinear isoparametric element formulation. The strain-displacement matrix must include radial, axial, hoop, and shear components; the constitutive relation must be for isotropic three-dimensional linear elasticity under axisymmetric conditions; and the integration weight must include the radius as required by axisymmetry. The integration must use $2\\times 2$ Gaussian quadrature in the parent coordinates.\n3. Impose essential boundary conditions to eliminate rigid-body modes and enforce axis regularity. For the wedge-like mesh, enforce $u_r=0$ at nodes on the axis $r=0$ and fix one axial displacement to anchor the solution. For the rectangular mesh, fix both displacement components at one corner node to remove rigid-body translations.\n4. Compute the condition number of the reduced stiffness matrix (after applying boundary conditions by elimination of constrained degrees of freedom) for each test case using the $2$-norm definition, and return the results as unitless floating-point numbers.\n5. Implement two mapping strategies for evaluating the radius in the hoop strain and the axisymmetric integration weight: a standard isoparametric radius computation and a safeguarded radius floor mapping, where the effective radius used in these terms is $r_{\\text{eff}}=\\max(r,r_{\\text{floor}})$ with a prescribed $r_{\\text{floor}}>0$.\n\nMaterial and geometric data (use these values):\n- Young's modulus $E$ in pascals is $E=210\\times 10^{9}$.\n- Poisson's ratio $\\nu$ is $\\nu=0.3$.\n- Radial element width $h_r$ in meters is $h_r=1.0$.\n- Axial element height $h_z$ in meters is $h_z=1.0$.\nThese quantities are used to construct the finite element model, but the final reported condition numbers are unitless. Ensure that any intermediate quantities are treated consistently, and note that the condition number is independent of the overall scaling by $E$.\n\nDefine the meridian mesh for both topologies as follows:\n- The mesh has two elements stacked in the axial direction, sharing a middle row of nodes. Nodes form a $2$-column by $3$-row grid. For the wedge-like mesh, the left column radii are $r=0$ and the right column radii are $r=h_r$. For the rectangular mesh, the left column radii are $r=r_{\\min}$ and the right column radii are $r=r_{\\min}+h_r$. The axial coordinates of the rows are $z=0$, $z=h_z$, $z=2h_z$.\n- Elements are defined by the node indices in counterclockwise order: bottom-left, bottom-right, top-right, top-left.\n\nBoundary conditions:\n- Wedge-like mesh: enforce $u_r=0$ at every node with $r=0$ and fix $u_z=0$ at the bottom-left node.\n- Rectangular mesh: fix both $u_r=0$ and $u_z=0$ at the bottom-left node.\nThese are sufficient to remove rigid-body modes needed for a well-posed stiffness matrix in this comparison and to enforce axis regularity in the wedge-like case.\n\nTest suite:\n- Case $1$: rectangular mesh with $r_{\\min}=10^{-6}\\ \\text{m}$, standard mapping with $r_{\\text{floor}}=0$.\n- Case $2$: rectangular mesh with $r_{\\min}=10^{-3}\\ \\text{m}$, standard mapping with $r_{\\text{floor}}=0$.\n- Case $3$: rectangular mesh with $r_{\\min}=10^{-1}\\ \\text{m}$, standard mapping with $r_{\\text{floor}}=0$.\n- Case $4$: wedge-like mesh with geometric $r_{\\min}=0\\ \\text{m}$, standard mapping with $r_{\\text{floor}}=0$.\n- Case $5$: rectangular mesh with $r_{\\min}=10^{-6}\\ \\text{m}$, floor mapping with $r_{\\text{floor}}=10^{-3}\\ \\text{m}$.\n- Case $6$: wedge-like mesh with geometric $r_{\\min}=0\\ \\text{m}$, floor mapping with $r_{\\text{floor}}=10^{-3}\\ \\text{m}$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[result_1,result_2,result_3]$). Each $result_i$ must be the floating-point condition number of the reduced stiffness matrix for the corresponding test case. No other text should be printed. The values are unitless floats.\n\nThe problem requires scientific realism and derivation from first principles. You must ensure that your implementation is consistent with the axisymmetric formulation and that it addresses the numerical behavior near the axis. In addition to computing the condition numbers for the test suite, your solution should propose mapping strategies to avoid collapse and justify their physical and numerical meaning based on the foundational laws and definitions specified above.", "solution": "The problem is validated as scientifically grounded, well-posed, and objective. It represents a standard investigation in computational solid mechanics concerning numerical conditioning in axisymmetric finite element analysis. All necessary data and conditions are provided, and there are no contradictions or ambiguities.\n\nThe solution is derived from the principle of virtual work, which states that for a body in equilibrium, the virtual work done by internal stresses equals the virtual work done by external forces for any kinematically admissible virtual displacement. For a continuum, this is expressed as:\n$$\n\\delta W_{\\text{int}} = \\int_V \\delta\\boldsymbol{\\epsilon}^T \\boldsymbol{\\sigma} \\, dV = \\delta W_{\\text{ext}}\n$$\nIn an axisymmetric setting, the volume element is $dV = 2\\pi r \\, dA$, where $A$ is the area in the $r$-$z$ meridian plane. The displacement field is purely a function of meridian coordinates $(r, z)$, i.e., $\\mathbf{u}(r, z) = [u_r(r, z), u_z(r, z)]^T$.\n\nUnder the assumption of small strains, the strain components are given by the vector $\\boldsymbol{\\epsilon} = [\\epsilon_r, \\epsilon_z, \\epsilon_\\theta, \\gamma_{rz}]^T$, where:\n$$\n\\epsilon_r = \\frac{\\partial u_r}{\\partial r}, \\quad \\epsilon_z = \\frac{\\partial u_z}{\\partial z}, \\quad \\epsilon_\\theta = \\frac{u_r}{r}, \\quad \\gamma_{rz} = \\frac{\\partial u_r}{\\partial z} + \\frac{\\partial u_z}{\\partial r}\n$$\nThe hoop strain $\\epsilon_\\theta$ is a unique feature of axisymmetry and becomes a source of numerical difficulty as the radius $r$ approaches zero.\n\nThe material is assumed to be isotropic and linearly elastic, governed by Hooke's law, $\\boldsymbol{\\sigma} = \\mathbf{C} \\boldsymbol{\\epsilon}$, where $\\boldsymbol{\\sigma} = [\\sigma_r, \\sigma_z, \\sigma_\\theta, \\tau_{rz}]^T$ is the stress vector. The constitutive matrix $\\mathbf{C}$ for an isotropic material under axisymmetric conditions is:\n$$\n\\mathbf{C} = \\frac{E}{(1+\\nu)(1-2\\nu)}\n\\begin{pmatrix}\n1-\\nu & \\nu & \\nu & 0 \\\\\n\\nu & 1-\\nu & \\nu & 0 \\\\\n\\nu & \\nu & 1-\\nu & 0 \\\\\n0 & 0 & 0 & \\frac{1-2\\nu}{2}\n\\end{pmatrix}\n$$\nwhere $E$ is Young's modulus and $\\nu$ is Poisson's ratio.\n\nWe employ the four-node bilinear isoparametric quadrilateral element. The geometry and displacement fields within an element are interpolated from nodal values using shape functions $N_i(\\xi, \\eta)$ in a parent coordinate system $(\\xi, \\eta) \\in [-1, 1] \\times [-1, 1]$:\n$$\nr(\\xi, \\eta) = \\sum_{i=1}^{4} N_i(\\xi, \\eta) r_i, \\quad z(\\xi, \\eta) = \\sum_{i=1}^{4} N_i(\\xi, \\eta) z_i\n$$\n$$\nu_r(\\xi, \\eta) = \\sum_{i=1}^{4} N_i(\\xi, \\eta) u_{ri}, \\quad u_z(\\xi, \\eta) = \\sum_{i=1}^{4} N_i(\\xi, \\eta) u_{zi}\n$$\nLetting $\\mathbf{d}^e$ be the vector of an element's $8$ nodal displacements, we can write the displacement field as $\\mathbf{u} = \\mathbf{N}\\mathbf{d}^e$ and the strain field as $\\boldsymbol{\\epsilon} = \\mathbf{B}\\mathbf{d}^e$. The strain-displacement matrix $\\mathbf{B}$ is derived from the strain definitions and the isoparametric interpolation. For a node $i$, its contribution to $\\mathbf{B}$ is a $4 \\times 2$ submatrix $\\mathbf{B}_i$:\n$$\n\\mathbf{B}_i(\\xi, \\eta) = \\begin{pmatrix}\n\\frac{\\partial N_i}{\\partial r} & 0 \\\\\n0 & \\frac{\\partial N_i}{\\partial z} \\\\\n\\frac{N_i}{r} & 0 \\\\\n\\frac{\\partial N_i}{\\partial z} & \\frac{\\partial N_i}{\\partial r}\n\\end{pmatrix}\n$$\nThe spatial derivatives of shape functions are found using the Jacobian matrix of the coordinate transformation, $\\mathbf{J}$, where $\\left[\\frac{\\partial N_i}{\\partial r}, \\frac{\\partial N_i}{\\partial z}\\right]^T = \\mathbf{J}^{-T} \\left[\\frac{\\partial N_i}{\\partial \\xi}, \\frac{\\partial N_i}{\\partial \\eta}\\right]^T$.\n\nSubstituting the finite element approximations into the principle of virtual work yields the discrete system $\\mathbf{K}\\mathbf{d} = \\mathbf{F}_{\\text{ext}}$, where the global stiffness matrix $\\mathbf{K}$ is assembled from element stiffness matrices $\\mathbf{k}^e$:\n$$\n\\mathbf{k}^e = \\int_{A_e} \\mathbf{B}^T \\mathbf{C} \\mathbf{B} \\, (2\\pi r) \\, dA = \\int_{-1}^{1}\\int_{-1}^{1} \\mathbf{B}^T(\\xi, \\eta) \\mathbf{C} \\mathbf{B}(\\xi, \\eta) \\, (2\\pi r(\\xi, \\eta)) \\, \\det(\\mathbf{J}) \\, d\\xi \\, d\\eta\n$$\nThis integral is evaluated numerically using $2 \\times 2$ Gaussian quadrature.\n\nThe numerical challenge arises from the $1/r$ term in the hoop strain component of the $\\mathbf{B}$ matrix. As an element approaches the axis of symmetry ($r \\to 0$), this term can become very large. In the integral for $\\mathbf{k}^e$, this large term is multiplied by the integration weight factor $r$, which becomes very small. The product of a very large term and a very small term, $\\mathbf{B}^T \\mathbf{C} \\mathbf{B} \\cdot r$, can lead to a stiffness matrix with a wide range of coefficient magnitudes. This results in a high condition number, indicating numerical sensitivity and potential for large errors in the solution.\n\nTo investigate this, two strategies for evaluating the radius $r$ at the Gauss points are implemented:\n1.  **Standard Isoparametric Mapping**: The radius $r_g = r(\\xi_g, \\eta_g)$ evaluated at a Gauss point is used directly. For cases near the axis, $r_g$ can be very small, leading to the ill-conditioning described. This is equivalent to setting a radius floor of $r_{\\text{floor}} = 0$.\n2.  **Safeguarded Floor Mapping**: A minimum effective radius, $r_{\\text{floor}} > 0$, is introduced. The effective radius used in both the hoop strain term ($1/r$) and the integration weight ($2\\pi r$) is $r_{\\text{eff}} = \\max(r_g, r_{\\text{floor}})$. This strategy prevents the $1/r$ term from becoming singular and ensures the element retains a minimum \"volume\" contribution to the stiffness, thereby regularizing the matrix and improving its condition. Physically, it models a thin tubular element instead of a zero-radius line, which can be a more stable idealization.\n\nThe global stiffness matrix is assembled from the two elements. Essential boundary conditions are then applied by eliminating the rows and columns corresponding to the constrained degrees of freedom. For the wedge-like mesh, the axisymmetry condition requires $u_r = 0$ for all nodes on the axis ($r=0$). For the rectangular mesh, which models a thick cylinder with a small inner radius, rigid body motion is removed by fixing a single node. The condition number of the resulting reduced stiffness matrix is then computed using the $2$-norm. This procedure is repeated for each test case to quantify the effect of mesh topology and radius mapping on numerical stability.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef get_constitutive_matrix(E, nu):\n    \"\"\"\n    Computes the axisymmetric constitutive matrix for an isotropic material.\n    \"\"\"\n    C = np.zeros((4, 4))\n    factor = E / ((1.0 + nu) * (1.0 - 2.0 * nu))\n    \n    C[0, 0] = factor * (1.0 - nu)\n    C[0, 1] = factor * nu\n    C[0, 2] = factor * nu\n    \n    C[1, 0] = factor * nu\n    C[1, 1] = factor * (1.0 - nu)\n    C[1, 2] = factor * nu\n    \n    C[2, 0] = factor * nu\n    C[2, 1] = factor * nu\n    C[2, 2] = factor * (1.0 - nu)\n    \n    C[3, 3] = factor * (1.0 - 2.0 * nu) / 2.0\n    \n    return C\n\ndef get_shape_functions(xi, eta):\n    \"\"\"\n    Computes shape functions and their derivatives for a 4-node quad element.\n    \"\"\"\n    N = 0.25 * np.array([\n        (1.0 - xi) * (1.0 - eta),\n        (1.0 + xi) * (1.0 - eta),\n        (1.0 + xi) * (1.0 + eta),\n        (1.0 - xi) * (1.0 + eta)\n    ])\n    \n    dN_dxi = 0.25 * np.array([\n        -(1.0 - eta),\n        (1.0 - eta),\n        (1.0 + eta),\n        -(1.0 + eta)\n    ])\n    \n    dN_deta = 0.25 * np.array([\n        -(1.0 - xi),\n        -(1.0 + xi),\n        (1.0 + xi),\n        (1.0 - xi)\n    ])\n    \n    return N, dN_dxi, dN_deta\n\ndef get_element_stiffness(node_coords, C, r_floor):\n    \"\"\"\n    Computes the stiffness matrix for a single 4-node axisymmetric element.\n    \"\"\"\n    k_e = np.zeros((8, 8))\n    gauss_points = [-1.0 / np.sqrt(3.0), 1.0 / np.sqrt(3.0)]\n    gauss_weights = [1.0, 1.0]\n\n    for i, xi in enumerate(gauss_points):\n        for j, eta in enumerate(gauss_points):\n            N, dN_dxi, dN_deta = get_shape_functions(xi, eta)\n            \n            # Jacobian matrix\n            J = np.zeros((2, 2))\n            J[0, 0] = np.dot(dN_dxi, node_coords[:, 0])  # dr/dxi\n            J[0, 1] = np.dot(dN_dxi, node_coords[:, 1])  # dz/dxi\n            J[1, 0] = np.dot(dN_deta, node_coords[:, 0]) # dr/deta\n            J[1, 1] = np.dot(dN_deta, node_coords[:, 1]) # dz/deta\n            \n            det_J = np.linalg.det(J)\n            inv_J = np.linalg.inv(J)\n            \n            # Derivatives of shape functions w.r.t. physical coordinates (r, z)\n            dN_d_phys = inv_J @ np.array([dN_dxi, dN_deta])\n            dN_dr = dN_d_phys[0, :]\n            dN_dz = dN_d_phys[1, :]\n            \n            # Radius at the Gauss point\n            r_gp = np.dot(N, node_coords[:, 0])\n            \n            # Apply safeguarded radius floor mapping\n            r_eff = max(r_gp, r_floor)\n            \n            # Strain-displacement matrix B\n            B = np.zeros((4, 8))\n            for k in range(4):\n                B[0, 2*k]     = dN_dr[k]\n                B[1, 2*k+1]   = dN_dz[k]\n                if r_eff > 1e-15:  # Avoid division by zero\n                    B[2, 2*k] = N[k] / r_eff\n                B[3, 2*k]     = dN_dz[k]\n                B[3, 2*k+1]   = dN_dr[k]\n            \n            # Integrate to get stiffness matrix contribution\n            weight = gauss_weights[i] * gauss_weights[j]\n            k_e += (B.T @ C @ B) * (2.0 * np.pi * r_eff) * det_J * weight\n            \n    return k_e\n\ndef run_analysis(mesh_type, r_min, r_floor):\n    \"\"\"\n    Performs the full analysis for one test case.\n    \"\"\"\n    # 1. Define material and geometric properties\n    E = 210e9\n    nu = 0.3\n    h_r = 1.0\n    h_z = 1.0\n    C = get_constitutive_matrix(E, nu)\n\n    # 2. Define node coordinates based on mesh type\n    r_geom = 0.0 if mesh_type == 'wedge' else r_min\n    \n    nodes = np.array([\n        [r_geom, 0.0],\n        [r_geom + h_r, 0.0],\n        [r_geom, h_z],\n        [r_geom + h_r, h_z],\n        [r_geom, 2.0 * h_z],\n        [r_geom + h_r, 2.0 * h_z]\n    ])\n    num_nodes = 6\n    num_dofs = 2 * num_nodes\n\n    # 3. Define elements and DOF maps for assembly\n    # Connectivity [bottom-left, bottom-right, top-right, top-left]\n    elements = [[0, 1, 3, 2], [2, 3, 5, 4]]\n    # Maps local element DOFs to global DOFs\n    dof_maps = [\n        np.array([0, 1, 2, 3, 6, 7, 4, 5]),\n        np.array([4, 5, 6, 7, 10, 11, 8, 9])\n    ]\n\n    # 4. Assemble global stiffness matrix K\n    K = np.zeros((num_dofs, num_dofs))\n    for i, elem_node_indices in enumerate(elements):\n        elem_coords = nodes[elem_node_indices]\n        k_e = get_element_stiffness(elem_coords, C, r_floor)\n        \n        ix_map = dof_maps[i]\n        K[np.ix_(ix_map, ix_map)] += k_e\n\n    # 5. Apply Boundary Conditions by elimination\n    if mesh_type == 'wedge':\n        # ur=0 at r=0 (nodes 0, 2, 4 -> DOFs 0, 4, 8)\n        # uz=0 at node 0 (DOF 1) to remove rigid body motion\n        constrained_dofs = [0, 1, 4, 8]\n    else: # rectangular\n        # ur=0, uz=0 at node 0 (DOFs 0, 1) to remove rigid body motion\n        constrained_dofs = [0, 1]\n    \n    all_dofs = np.arange(num_dofs)\n    free_dofs = np.setdiff1d(all_dofs, constrained_dofs)\n    K_reduced = K[np.ix_(free_dofs, free_dofs)]\n    \n    # 6. Compute and return the 2-norm condition number\n    condition_number = np.linalg.cond(K_reduced, p=2)\n    return condition_number\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print results.\n    \"\"\"\n    test_cases = [\n        {'type': 'rectangular', 'r_min': 1e-6, 'r_floor': 0.0},\n        {'type': 'rectangular', 'r_min': 1e-3, 'r_floor': 0.0},\n        {'type': 'rectangular', 'r_min': 1e-1, 'r_floor': 0.0},\n        {'type': 'wedge', 'r_min': 0.0, 'r_floor': 0.0},\n        {'type': 'rectangular', 'r_min': 1e-6, 'r_floor': 1e-3},\n        {'type': 'wedge', 'r_min': 0.0, 'r_floor': 1e-3},\n    ]\n\n    results = []\n    for case in test_cases:\n        result = run_analysis(\n            mesh_type=case['type'],\n            r_min=case['r_min'],\n            r_floor=case['r_floor']\n        )\n        results.append(result)\n\n    print(f\"[{','.join(f'{r:.7e}' for r in results)}]\")\n\nsolve()\n```", "id": "3545417"}]}