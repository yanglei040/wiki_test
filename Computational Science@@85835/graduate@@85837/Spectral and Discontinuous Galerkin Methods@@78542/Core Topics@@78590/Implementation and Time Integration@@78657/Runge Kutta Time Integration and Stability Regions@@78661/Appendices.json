{"hands_on_practices": [{"introduction": "To ensure a numerical simulation is stable, the time step $\\Delta t$ must be chosen so that all eigenvalues of the spatial discretization, when scaled by $\\Delta t$, lie within the stability region of the time integrator. This first exercise provides a foundational walkthrough of this principle using an idealized scenario. By discretizing the advection equation with a Fourier spectral method, we obtain a set of purely imaginary eigenvalues, simplifying the stability analysis to the intersection of the spectrum with the imaginary axis of the Runge-Kutta stability region [@problem_id:3413513].", "problem": "Consider the linear advection Partial Differential Equation (PDE) $u_{t} + a\\,u_{x} = 0$ on a periodic domain of length $L$, where $a \\neq 0$ is a real constant. The spatial discretization uses a Fourier spectral collocation method on $N$ equispaced grid points, with grid spacing $h = L/N$. Time integration is performed by a $3$-stage, third-order explicit Runge–Kutta method. Let the Courant number be defined by $C = |a|\\,\\Delta t / h$, where $\\Delta t$ is the time step.\n\nStarting from first principles of Fourier analysis and Runge–Kutta stability:\n\n1) Using the Fourier series representation of periodic functions and orthogonality of Fourier modes, derive the semi-discrete evolution for each Fourier mode and identify the associated eigenvalues $\\lambda_{k}$ in terms of the wavenumber $k$ and the advection speed $a$.\n\n2) For a general explicit Runge–Kutta method of order $3$, when applied to the linear test equation $y'(t) = \\lambda\\,y(t)$, derive the method’s stability function $R(z)$, where $z = \\lambda\\,\\Delta t$, using only the order conditions up to order $3$.\n\n3) Specialize to purely imaginary arguments $z = \\mathrm{i}\\,y$ with real $y$. Determine the largest nonnegative $y_{\\max}$ such that $|R(\\mathrm{i}\\,y)| \\le 1$ for all $|y| \\le y_{\\max}$.\n\n4) For the Fourier spectral collocation discretization on $N$ points over a periodic domain of length $L$, the resolvable wavenumbers are $k_{n} = \\frac{2\\pi n}{L}$ with $n \\in \\{-\\frac{N}{2},\\ldots,\\frac{N}{2}\\}$ (interpreted appropriately if $N$ is odd), so that the largest resolvable magnitude is $|k|_{\\max} = \\pi/h$. Using this fact together with your result from parts $1)$–$3)$, determine the exact closed-form expression for the maximum admissible Courant number $C_{\\max}$ guaranteeing linear stability for all resolvable Fourier modes when the $3$-stage, third-order explicit Runge–Kutta method is used. Express your final answer as a single closed-form expression with no units.", "solution": "We proceed step by step, beginning with Fourier analysis of the spatial discretization and then deriving the time-stepping stability constraint.\n\nStep 1: Semi-discrete evolution and eigenvalues. On a periodic domain of length $L$, expand $u(x,t)$ in a Fourier series $u(x,t) = \\sum_{n} \\hat{u}_{n}(t)\\,\\exp(\\mathrm{i}\\,k_{n} x)$, where $k_{n} = \\frac{2\\pi n}{L}$ and $n \\in \\mathbb{Z}$. For the Fourier spectral collocation method, spatial differentiation acts modewise as $u_{x}(x,t) \\mapsto \\sum_{n} (\\mathrm{i}\\,k_{n})\\,\\hat{u}_{n}(t)\\,\\exp(\\mathrm{i}\\,k_{n}x)$. Substituting into the PDE $u_{t} + a\\,u_{x} = 0$ and equating coefficients for each mode yields\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}t}\\,\\hat{u}_{n}(t) \\;=\\; -\\,a\\,(\\mathrm{i}\\,k_{n})\\,\\hat{u}_{n}(t) \\;=\\; \\lambda_{n}\\,\\hat{u}_{n}(t),\n$$\nso the semi-discrete operator is diagonal in Fourier space with eigenvalues\n$$\n\\lambda_{n} \\;=\\; -\\,\\mathrm{i}\\,a\\,k_{n}.\n$$\nThus, each Fourier mode satisfies the scalar linear ordinary differential equation $\\hat{u}_{n}'(t) = \\lambda_{n}\\,\\hat{u}_{n}(t)$ with purely imaginary $\\lambda_{n}$ when $a$ is real.\n\nStep 2: Stability function of a third-order, three-stage explicit Runge–Kutta method. Consider applying an explicit Runge–Kutta method to the linear test equation $y'(t) = \\lambda\\,y(t)$. The one-step map satisfies $y^{n+1} = R(z)\\,y^{n}$ with $z = \\lambda\\,\\Delta t$, where $R(z)$ is a polynomial whose coefficients are determined by the method. For a method of order $3$, the order conditions enforce that $R(z)$ matches the Taylor expansion of $\\exp(z)$ up to and including terms of order $z^{3}$. Because a $3$-stage explicit Runge–Kutta method has a stability function that is a polynomial of degree at most $3$, these conditions fix $R(z)$ uniquely as the third-degree Taylor polynomial of $\\exp(z)$:\n$$\nR(z) \\;=\\; 1 \\;+\\; z \\;+\\; \\frac{z^{2}}{2} \\;+\\; \\frac{z^{3}}{6}.\n$$\n\nStep 3: Imaginary-axis stability extent. Set $z = \\mathrm{i}\\,y$ with $y \\in \\mathbb{R}$. Then\n$$\nR(\\mathrm{i}\\,y) \\;=\\; 1 \\;+\\; \\mathrm{i}\\,y \\;-\\; \\frac{y^{2}}{2} \\;-\\; \\mathrm{i}\\,\\frac{y^{3}}{6}.\n$$\nThe real and imaginary parts are $\\Re R(\\mathrm{i}\\,y) = 1 - \\frac{y^{2}}{2}$ and $\\Im R(\\mathrm{i}\\,y) = y - \\frac{y^{3}}{6}$. Therefore,\n$$\n\\bigl|R(\\mathrm{i}\\,y)\\bigr|^{2} \\;=\\; \\left(1 - \\frac{y^{2}}{2}\\right)^{2} \\;+\\; \\left(y - \\frac{y^{3}}{6}\\right)^{2}\n\\;=\\; 1 \\;-\\; \\frac{y^{4}}{12} \\;+\\; \\frac{y^{6}}{36}.\n$$\nThe stability condition $\\bigl|R(\\mathrm{i}\\,y)\\bigr| \\leq 1$ is equivalent to\n$$\n1 \\;-\\; \\frac{y^{4}}{12} \\;+\\; \\frac{y^{6}}{36} \\;\\leq\\; 1\n\\;\\;\\Longleftrightarrow\\;\\;\n-\\frac{y^{4}}{12} \\;+\\; \\frac{y^{6}}{36} \\;\\leq\\; 0\n\\;\\;\\Longleftrightarrow\\;\\;\ny^{4}\\left(\\frac{y^{2}}{36} - \\frac{1}{12}\\right) \\;\\leq\\; 0.\n$$\nSince $y^{4} \\geq 0$, the inequality reduces to $\\frac{y^{2}}{36} - \\frac{1}{12} \\leq 0$, i.e.,\n$$\ny^{2} \\;\\leq\\; 3.\n$$\nThus, the largest nonnegative extent on the imaginary axis for which $\\bigl|R(\\mathrm{i}\\,y)\\bigr| \\leq 1$ is\n$$\ny_{\\max} \\;=\\; \\sqrt{3}.\n$$\n\nStep 4: Maximum admissible Courant number. On an $N$-point periodic Fourier grid over length $L$, the resolvable wavenumbers are $k_{n} = \\frac{2\\pi n}{L}$ with maximum magnitude $|k|_{\\max} = \\frac{\\pi N}{L} = \\frac{\\pi}{h}$. For a mode with wavenumber $k$, the argument of the stability function is $z = \\lambda\\,\\Delta t = -\\,\\mathrm{i}\\,a\\,k\\,\\Delta t$, so $|z| = |a|\\,|k|\\,\\Delta t$. To ensure stability for all resolvable modes, require\n$$\n|a|\\,|k|\\,\\Delta t \\;\\leq\\; y_{\\max} \\;=\\; \\sqrt{3}\n\\quad\\text{for all}\\quad |k| \\leq \\frac{\\pi}{h}.\n$$\nThe most restrictive case is $|k| = \\frac{\\pi}{h}$, giving $|a|\\,\\Delta t\\,\\frac{\\pi}{h} \\leq \\sqrt{3}$. In terms of the Courant number $C = |a|\\,\\Delta t / h$, this condition is\n$$\n\\pi\\,C \\;\\leq\\; \\sqrt{3},\n$$\nso the maximum admissible Courant number is\n$$\nC_{\\max} \\;=\\; \\frac{\\sqrt{3}}{\\pi}.\n$$\nThis value guarantees that every resolvable Fourier mode lies within the imaginary-axis extent of the stability region of the $3$-stage, third-order explicit Runge–Kutta method.", "answer": "$$\\boxed{\\frac{\\sqrt{3}}{\\pi}}$$", "id": "3413513"}, {"introduction": "While spectral methods provide a clean, non-dissipative picture, most practical discretization schemes like the Discontinuous Galerkin (DG) method introduce numerical dissipation. This means the operator's eigenvalues acquire negative real parts, and their locus in the complex plane is no longer a simple line. This practice explores the spectrum of a simple DG scheme for the advection equation, revealing how the eigenvalues form a circle in the left-half complex plane and forcing us to consider the full two-dimensional shape of an explicit Runge-Kutta method's stability region [@problem_id:3413528].", "problem": "Consider the one-dimensional linear advection equation $u_{t} + a\\,u_{x} = 0$ with constant advection speed $a > 0$ on a periodic domain partitioned into a uniform mesh of cells of width $h$. Discretize in space using the Discontinuous Galerkin (DG) method with polynomial degree $p=0$ (piecewise constant basis) and the upwind numerical flux. Denote by $u_{j}(t)$ the cell average in cell $j$. \n\n1. Starting from the DG weak form with test functions equal to $1$ and using the upwind numerical flux consistent with $a>0$, derive the semi-discrete evolution equation for $u_{j}(t)$ on the uniform mesh, and then perform a Fourier (von Neumann) analysis with the ansatz $u_{j}(t) = \\hat{u}(t)\\,\\exp(\\mathrm{i} j \\theta)$, where $\\theta \\in [-\\pi,\\pi]$ is the nondimensional wavenumber measured in radians. From this, obtain the semi-discrete dispersion relation $\\lambda(\\theta)$ defined by $\\hat{u}'(t) = \\lambda(\\theta)\\,\\hat{u}(t)$.\n\n2. Identify the worst-case Fourier mode $\\theta_{\\star}$ for explicit time integration stability by analyzing the location of $\\Delta t\\,\\lambda(\\theta)$ in the complex plane. Justify that this mode controls the maximum stable time step on this mesh for the explicit methods considered below.\n\n3. For each of the following explicit Runge–Kutta (RK) methods applied to the linear test problem $y'=\\lambda y$, derive the linear stability function $R(z)$, where $z = \\lambda\\,\\Delta t$:\n   - Two-stage, second-order explicit trapezoidal rule (commonly referred to as RK2).\n   - Three-stage, third-order Strong Stability Preserving Runge–Kutta method (SSPRK(3,3)).\n   - Four-stage, fourth-order classical Runge–Kutta method (RK4).\n   For each method, determine the largest $r>0$ such that the entire closed interval $[-r,0]$ on the real axis is contained in the method’s stability region $\\{z \\in \\mathbb{C} : |R(z)| \\le 1\\}$.\n\n4. With $a=1$ and $h=1$, use the dispersion relation from part 1, the worst-case mode from part 2, and the real-axis stability extents from part 3 to determine the maximum stable time step $\\Delta t_{\\max}$ for RK2 and RK4. Finally, compute the ratio \n$$\n\\kappa \\equiv \\frac{\\Delta t_{\\max}^{\\mathrm{RK4}}}{\\Delta t_{\\max}^{\\mathrm{RK2}}}.\n$$\nReport the value of $\\kappa$ rounded to four significant figures.\n\nYour final answer must be the single numerical value of $\\kappa$ only.", "solution": "The problem requires a multi-step analysis involving the Discontinuous Galerkin (DG) discretization of the linear advection equation, Fourier stability analysis, and the properties of explicit Runge-Kutta (RK) methods. We will proceed by addressing each of the four parts of the problem statement sequentially.\n\n### Part 1: Semi-discrete Equation and Dispersion Relation\n\nThe one-dimensional linear advection equation is given by $u_t + a u_x = 0$ with constant speed $a > 0$. We discretize in space using the DG method on a uniform mesh of cell width $h$. The cells are denoted by $K_j = [x_{j-1/2}, x_{j+1/2}]$. We use a polynomial basis of degree $p=0$, which means the solution is approximated as a piecewise constant function, $u_h(x,t) = u_j(t)$ for $x \\in K_j$.\n\nThe DG weak formulation for cell $K_j$ is obtained by multiplying the PDE by a test function $v_h$ from the same approximation space and integrating over the cell:\n$$ \\int_{K_j} (u_t) v_h \\,dx + \\int_{K_j} (a u_x) v_h \\,dx = 0 $$\nIntegrating the second term by parts gives:\n$$ \\int_{K_j} (u_t) v_h \\,dx - \\int_{K_j} a u (v_h)_x \\,dx + [a u v_h]_{x_{j-1/2}}^{x_{j+1/2}} = 0 $$\nThe term $[a u v_h]$ is replaced by a numerical flux function $\\widehat{auv_h}$:\n$$ \\int_{K_j} (u_t) v_h \\,dx - \\int_{K_j} a u_h (v_h)_x \\,dx + \\widehat{auv_h}(x_{j+1/2}) - \\widehat{auv_h}(x_{j-1/2}) = 0 $$\nFor $p=0$, we choose the test function $v_h$ to be the characteristic function on cell $K_j$, i.e., $v_h(x) = 1$ for $x \\in K_j$ and $0$ otherwise. With this choice, $u_h(x,t) = u_j(t)$ and $(v_h)_x = 0$ inside the cell $K_j$. The weak form simplifies to:\n$$ \\int_{K_j} \\frac{d u_j}{dt} \\cdot 1 \\,dx - 0 + a\\hat{u}_h(x_{j+1/2})v_h(x_{j+1/2}^-) - a\\hat{u}_h(x_{j-1/2})v_h(x_{j-1/2}^+) = 0 $$\nHere, $\\hat{u}_h$ is the numerical flux for $u$. Since $v_h=1$ on $K_j$, we have $v_h(x_{j+1/2}^-) = 1$ and $v_h(x_{j-1/2}^+) = 1$. The integral of the time derivative is $h \\frac{du_j}{dt}$. The semi-discrete equation becomes:\n$$ h \\frac{du_j}{dt} + a \\left( \\hat{u}_h(x_{j+1/2}) - \\hat{u}_h(x_{j-1/2}) \\right) = 0 $$\nThe problem specifies an upwind numerical flux. Since $a>0$, the characteristic information propagates from left to right. Therefore, the upwind value at any interface is the value from the left side.\nAt interface $x_{j+1/2}$, the value from the left is $u_j$ and from the right is $u_{j+1}$. The upwind flux is $\\hat{u}_h(x_{j+1/2}) = u_j$.\nAt interface $x_{j-1/2}$, the value from the left is $u_{j-1}$ and from the right is $u_j$. The upwind flux is $\\hat{u}_h(x_{j-1/2}) = u_{j-1}$.\nSubstituting these fluxes into the semi-discrete equation gives:\n$$ h \\frac{du_j}{dt} + a (u_j - u_{j-1}) = 0 \\implies \\frac{du_j}{dt} = -\\frac{a}{h}(u_j - u_{j-1}) $$\nTo perform Fourier analysis, we use the ansatz $u_j(t) = \\hat{u}(t) \\exp(\\mathrm{i} j \\theta)$, where $\\theta = k h$ is the nondimensional wavenumber and $k$ is the wavenumber. Substituting this into the semi-discrete equation:\n$$ \\frac{d}{dt} \\left( \\hat{u}(t) \\exp(\\mathrm{i} j \\theta) \\right) = -\\frac{a}{h} \\left( \\hat{u}(t) \\exp(\\mathrm{i} j \\theta) - \\hat{u}(t) \\exp(\\mathrm{i} (j-1) \\theta) \\right) $$\n$$ \\exp(\\mathrm{i} j \\theta) \\frac{d\\hat{u}}{dt} = -\\frac{a}{h} \\hat{u}(t) \\exp(\\mathrm{i} j \\theta) (1 - \\exp(-\\mathrm{i} \\theta)) $$\nDividing by $\\exp(\\mathrm{i} j \\theta)$, we obtain the ODE for the Fourier mode amplitude $\\hat{u}(t)$:\n$$ \\frac{d\\hat{u}}{dt} = -\\frac{a}{h} (1 - \\exp(-\\mathrm{i} \\theta)) \\hat{u}(t) $$\nThis equation is of the form $\\hat{u}'(t) = \\lambda(\\theta)\\hat{u}(t)$. The semi-discrete dispersion relation, or symbol, is therefore:\n$$ \\lambda(\\theta) = -\\frac{a}{h}(1 - \\exp(-\\mathrm{i} \\theta)) = -\\frac{a}{h}(1 - \\cos\\theta + \\mathrm{i}\\sin\\theta) $$\n\n### Part 2: Worst-Case Fourier Mode for Stability\n\nFor explicit time integration, the stability of the method depends on the location of the values $z = \\Delta t \\lambda(\\theta)$ in the complex plane for all $\\theta \\in [-\\pi, \\pi]$. Let us analyze the locus of the eigenvalues $\\lambda(\\theta)$. Let $\\nu = a/h$.\n$$ \\lambda(\\theta) = -\\nu(1 - \\cos\\theta) - \\mathrm{i}\\nu\\sin\\theta $$\nLet $\\lambda = x+\\mathrm{i}y$. Then $x = -\\nu(1-\\cos\\theta)$ and $y = -\\nu\\sin\\theta$. We can write $\\cos\\theta = 1+x/\\nu$ and $\\sin\\theta = -y/\\nu$. Using the identity $\\cos^2\\theta + \\sin^2\\theta = 1$:\n$$ \\left(1 + \\frac{x}{\\nu}\\right)^{2} + \\left(-\\frac{y}{\\nu}\\right)^{2} = 1 \\implies (x+\\nu)^2 + y^2 = \\nu^2 $$\nThis is the equation of a circle in the complex plane centered at $(-\\nu, 0) = (-a/h, 0)$ with radius $\\nu = a/h$. This circle passes through the origin (for $\\theta=0$) and extends to $-2a/h$ on the negative real axis (for $\\theta=\\pi$).\nFor stability of an explicit RK method, the set $\\{ \\Delta t \\lambda(\\theta) \\mid \\theta \\in [-\\pi, \\pi] \\}$ must be contained within the method's stability region $S = \\{ z \\in \\mathbb{C} : |R(z)| \\le 1 \\}$. The set of scaled eigenvalues is also a circle, centered at $-\\Delta t a/h$ with radius $\\Delta t a/h$.\nThe stability regions of standard explicit RK methods (like RK2 and RK4) contain an interval on the negative real axis, $[-r, 0]$. As $\\Delta t$ increases, the circle of scaled eigenvalues expands. The point on this circle that is most likely to leave the stability region first is the point furthest from the origin, which is $\\Delta t \\lambda(\\pi) = -2a\\Delta t/h$. This point lies on the negative real axis. Therefore, the stability is limited by the condition that this point remains in the stability region, i.e., $-2a\\Delta t/h \\ge -r$. This implies the time-step restriction is dictated by the real-axis extent of the stability region. The Fourier mode that corresponds to this limiting eigenvalue is $\\theta_{\\star} = \\pi$. This is the highest frequency mode representable on the grid and it controls the maximum stable time step.\n\n### Part 3: Runge-Kutta Stability Functions and Real-Axis Extents\n\nThe stability function $R(z)$ for an RK method applied to $y'=\\lambda y$ is defined by $y_{n+1} = R(\\lambda\\Delta t) y_n = R(z) y_n$. The stability region is $\\{z \\in \\mathbb{C} : |R(z)| \\le 1\\}$. We seek the largest $r > 0$ such that $[-r, 0]$ is contained in the stability region.\n\n1.  **RK2 (Explicit Trapezoidal Rule):** The method is:\n    $k_1 = \\lambda y_n$\n    $k_2 = \\lambda(y_n + \\Delta t k_1) = \\lambda(y_n + \\Delta t \\lambda y_n) = \\lambda y_n(1+z)$\n    $y_{n+1} = y_n + \\frac{\\Delta t}{2}(k_1 + k_2) = y_n + \\frac{z}{2\\lambda}(\\lambda y_n + \\lambda y_n(1+z)) = y_n(1 + \\frac{z}{2}(1 + 1+z)) = y_n(1+z+\\frac{z^2}{2})$.\n    So, $R_{\\text{RK2}}(z) = 1+z+\\frac{z^2}{2}$. For real-axis stability, we examine $z=-x$ for $x \\ge 0$: $|1-x+\\frac{x^2}{2}| \\le 1$. This is equivalent to $-1 \\le 1-x+\\frac{x^2}{2} \\le 1$.\n    -   $1-x+\\frac{x^2}{2} \\le 1 \\implies \\frac{x^2}{2}-x \\le 0 \\implies x(\\frac{x}{2}-1) \\le 0$. For $x \\ge 0$, this holds if $\\frac{x}{2}-1 \\le 0$, which is $x \\le 2$.\n    -   $-1 \\le 1-x+\\frac{x^2}{2} \\implies 0 \\le 2-x+\\frac{x^2}{2} \\implies 0 \\le x^2-2x+4$. The discriminant is $(-2)^2-4(1)(4) = -12  0$, so the quadratic is always positive.\n    The real stability interval is $[-2, 0]$, so $r_{\\text{RK2}} = 2$.\n\n2.  **SSPRK(3,3):** Its stability function is the Taylor polynomial of $e^z$ of degree $3$.\n    $R_{\\text{SSPRK3}}(z) = 1+z+\\frac{z^2}{2}+\\frac{z^3}{6}$. For real-axis stability, we analyze $|1-x+\\frac{x^2}{2}-\\frac{x^3}{6}| \\le 1$ for $x \\ge 0$.\n    -   $1-x+\\frac{x^2}{2}-\\frac{x^3}{6} \\le 1 \\implies -x+\\frac{x^2}{2}-\\frac{x^3}{6} \\le 0 \\implies x(1-\\frac{x}{2}+\\frac{x^2}{6}) \\ge 0$. The quadratic $1-\\frac{x}{2}+\\frac{x^2}{6}$ has discriminant $(-\\frac{1}{2})^2 - 4(\\frac{1}{6})(1) = \\frac{1}{4}-\\frac{2}{3}  0$. It is always positive, so this inequality holds for all $x \\ge 0$.\n    -   $-1 \\le 1-x+\\frac{x^2}{2}-\\frac{x^3}{6} \\implies 0 \\le 2-x+\\frac{x^2}{2}-\\frac{x^3}{6}$. We must find the smallest positive root of $x^3 - 3x^2 + 6x - 12 = 0$. Numerical calculation gives this root as $x \\approx 2.5127$.\n    The real stability interval is approximately $[-2.5127, 0]$, so $r_{\\text{SSPRK3}} \\approx 2.5127$.\n\n3.  **RK4 (Classical):** The stability function is the Taylor polynomial of $e^z$ of degree $4$.\n    $R_{\\text{RK4}}(z) = 1+z+\\frac{z^2}{2}+\\frac{z^3}{6}+\\frac{z^4}{24}$. For real-axis stability, we analyze $|1-x+\\frac{x^2}{2}-\\frac{x^3}{6}+\\frac{x^4}{24}| \\le 1$ for $x \\ge 0$.\n    -   $1-x+\\frac{x^2}{2}-\\frac{x^3}{6}+\\frac{x^4}{24} \\le 1 \\implies x(-1+\\frac{x}{2}-\\frac{x^2}{6}+\\frac{x^3}{24}) \\le 0$. For $x \\ge 0$, we need to solve $-1+\\frac{x}{2}-\\frac{x^2}{6}+\\frac{x^3}{24} \\le 0$, or $x^3 - 4x^2 + 12x - 24 \\le 0$. The root of this polynomial is found numerically to be $x \\approx 2.78528$. The polynomial is non-positive for $x \\in [0, 2.78528]$.\n    -   The other inequality, $-1 \\le 1-x+\\ldots$, holds for all $x \\ge 0$.\n    The real stability interval is approximately $[-2.78528, 0]$, so $r_{\\text{RK4}} \\approx 2.78528$.\n\n### Part 4: Maximum Stable Time Step and Ratio $\\kappa$\n\nWe are given $a=1$ and $h=1$. The stability-limiting eigenvalue from Part 2 is $\\lambda_\\star = \\lambda(\\pi) = -2a/h = -2(1)/1 = -2$. The stability condition requires the scaled eigenvalue, $z = \\Delta t \\lambda_\\star = -2\\Delta t$, to lie within the real stability interval $[-r, 0]$ of the respective RK method.\n$$ -r \\le -2\\Delta t \\le 0 $$\nThis implies $2\\Delta t \\le r$, or $\\Delta t \\le r/2$. The maximum stable time step is therefore $\\Delta t_{\\max} = r/2$.\n\nFor RK2, we found $r_{\\text{RK2}} = 2$.\n$$ \\Delta t_{\\max}^{\\text{RK2}} = \\frac{r_{\\text{RK2}}}{2} = \\frac{2}{2} = 1 $$\n\nFor RK4, we found $r_{\\text{RK4}} \\approx 2.78528$.\n$$ \\Delta t_{\\max}^{\\text{RK4}} = \\frac{r_{\\text{RK4}}}{2} \\approx \\frac{2.78528}{2} = 1.39264 $$\n\nThe problem asks for the ratio $\\kappa$:\n$$ \\kappa \\equiv \\frac{\\Delta t_{\\max}^{\\mathrm{RK4}}}{\\Delta t_{\\max}^{\\mathrm{RK2}}} = \\frac{r_{\\text{RK4}}/2}{r_{\\text{RK2}}/2} = \\frac{r_{\\text{RK4}}}{r_{\\text{RK2}}} $$\n$$ \\kappa \\approx \\frac{2.78528}{2} = 1.39264 $$\nRounding to four significant figures, we get $\\kappa \\approx 1.393$.", "answer": "$$\\boxed{1.393}$$", "id": "3413528"}, {"introduction": "Explicit time integration schemes often face a severe limitation when dealing with \"stiff\" systems, such as those arising from the viscous terms in a Discontinuous Galerkin discretization of the Navier-Stokes equations. The eigenvalues associated with these terms are large and negative, forcing explicit methods to take prohibitively small time steps. This hands-on exercise introduces implicit Runge-Kutta methods as a powerful solution, guiding you through the derivation and verification of the superior stability properties, such as $A$-stability and $L$-stability, that make them suitable for efficiently handling stiffness [@problem_id:3413532].", "problem": "You are tasked to write a complete, self-contained program that constructs and analyzes the stability properties of singly diagonally implicit Runge–Kutta methods with an explicit first stage (Explicit First Stage Singly Diagonally Implicit Runge–Kutta (ESDIRK)) and compares them with a standard two-stage Singly Diagonally Implicit Runge–Kutta (SDIRK) method. The analysis must be performed in the context of time integration for stiff viscous terms arising from Discontinuous Galerkin (DG) discretizations of the Navier–Stokes equations.\n\nThe foundational base you must start from is the Dahlquist test problem and the basic definition of a Runge–Kutta method applied to a linear ordinary differential equation. Specifically:\n\n- Consider the Dahlquist test equation $y'(t) = \\lambda y(t)$, where $\\lambda \\in \\mathbb{C}$ and $\\operatorname{Re}(\\lambda) \\le 0$ for stable dissipative operators. If a time step of size $\\Delta t$ is taken, define $z = \\lambda \\Delta t$.\n- A Runge–Kutta method is defined by its Butcher tableau $(\\mathbf{A}, \\mathbf{b}, \\mathbf{c})$, with $\\mathbf{A} \\in \\mathbb{R}^{s \\times s}$, $\\mathbf{b} \\in \\mathbb{R}^{s}$, and $\\mathbf{c} \\in \\mathbb{R}^{s}$, where $s$ is the number of stages. For an implicit method, the internal stages satisfy linear systems when applied to the Dahlquist test equation.\n- The discrete growth factor mapping $y^{n} \\mapsto y^{n+1}$ on the Dahlquist test equation defines the stability function $R(z)$ through $y^{n+1} = R(z) y^{n}$. For an $s$-stage Runge–Kutta method (explicit or implicit) applied to the Dahlquist test equation, $R(z)$ can be derived as a rational function depending on $\\mathbf{A}$ and $\\mathbf{b}$ through the resolvent of $(\\mathbf{I} - z \\mathbf{A})$, where $\\mathbf{I}$ is the $s \\times s$ identity matrix.\n\nYou must implement the following tasks:\n\n1. Construct the stability function $R(z)$ for two methods:\n   - An $s=2$ ESDIRK method that reduces to the implicit trapezoidal rule with an explicit first stage. Use the coefficients $\\mathbf{A} = \\begin{bmatrix} 0  0 \\\\ \\frac{1}{2}  \\frac{1}{2} \\end{bmatrix}$, $\\mathbf{b} = \\begin{bmatrix} \\frac{1}{2}  \\frac{1}{2} \\end{bmatrix}$, and $\\mathbf{c} = \\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix}$. This method is known to be algebraically stable and $A$-stable. From first principles, derive the corresponding $R(z)$ by applying the method to $y'(t) = \\lambda y(t)$.\n   - A classic $s=2$ SDIRK method with stiff accuracy that is $L$-stable. Use $\\gamma = 1 - \\frac{1}{\\sqrt{2}}$ and coefficients $\\mathbf{A} = \\begin{bmatrix} \\gamma  0 \\\\ 1 - \\gamma  \\gamma \\end{bmatrix}$, $\\mathbf{b} = \\begin{bmatrix} 1 - \\gamma  \\gamma \\end{bmatrix}$, and $\\mathbf{c} = \\begin{bmatrix} \\gamma \\\\ 1 \\end{bmatrix}$. From first principles, derive the corresponding $R(z)$.\n\n   In both cases, you must construct $R(z)$ directly via the matrix resolvent form and not by quoting known formulas. Your program must evaluate $R(z)$ numerically for complex $z$.\n\n2. Verify $A$-stability or $L$-stability numerically:\n   - For the ESDIRK implicit trapezoidal method, verify $A$-stability by sampling values $z = \\mathrm{i} \\omega$ along the imaginary axis for $\\omega$ uniformly in the interval $[-100, 100]$ and reporting whether $\\max_{\\omega} |R(\\mathrm{i} \\omega)| \\le 1$ within a small numerical tolerance.\n   - For the stiffly accurate $s=2$ SDIRK method, verify $L$-stability numerically by evaluating $|R(z)|$ at a large negative real value, for example $z = -10^{6}$, and reporting whether $|R(-10^{6})|$ is sufficiently small (you must use a tolerance that is numerically meaningful, such as $10^{-6}$).\n\n3. Map the largest negative viscous eigenvalues from a Discontinuous Galerkin discretization of the viscous operator in the Navier–Stokes equations to the stability argument $z$:\n   - Consider the one-dimensional domain length $L$ partitioned into $N$ elements of uniform size $h = L/N$ with polynomial degree $p$ per element. The symmetric interior penalty discretization yields a stiffness scaling whose largest negative eigenvalue magnitude can be conservatively estimated by\n     $$ \\lambda_{\\max}^{\\text{neg}} \\approx - \\nu \\, \\alpha_{\\mathrm{DG}} \\, \\frac{(p+1)^2}{h^2}, $$\n     where $\\nu$ is the kinematic viscosity and $\\alpha_{\\mathrm{DG}}$ is a dimensionless constant capturing trace and inverse inequality bounds of the Discontinuous Galerkin operator. For this problem, use the conservative value $\\alpha_{\\mathrm{DG}} = 4$. This scaling is consistent with the well-tested facts of interior penalty stabilization and inverse inequalities in polynomial approximation on elements.\n   - For given parameters $(\\nu, L, N, p, \\Delta t)$, compute $z = \\lambda_{\\max}^{\\text{neg}} \\Delta t$ and evaluate whether each method is stable at that $z$ by checking $|R(z)| \\le 1$.\n\n4. Use the following test suite to generate quantifiable outputs:\n   - Test 1 (ESDIRK $A$-stability verification): Imaginary-axis sampling with $100$ points in $\\omega \\in [-100, 100]$. Output a boolean indicating whether $\\max |R(\\mathrm{i} \\omega)| \\le 1$.\n   - Test 2 (SDIRK $L$-stability verification): Evaluate $|R(-10^{6})|$ and output a boolean indicating whether it is less than $10^{-6}$.\n   - Test 3 (DG viscous mapping, moderate stiffness): Parameters $(\\nu, L, N, p, \\Delta t) = (10^{-2}, 1, 8, 3, 10^{-3})$. Compute $z$ and output two booleans indicating stability for the ESDIRK method and the SDIRK method.\n   - Test 4 (DG viscous mapping, severe stiffness): Parameters $(\\nu, L, N, p, \\Delta t) = (0.5, 1, 128, 9, 10^{-4})$. Compute $z$ and output two booleans indicating stability for the ESDIRK method and the SDIRK method.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. The list must be ordered as:\n- $[$result for Test 1, result for Test 2, result for Test 3 with ESDIRK, result for Test 3 with SDIRK, result for Test 4 with ESDIRK, result for Test 4 with SDIRK$]$.\n\nAll outputs must be booleans. There are no physical units required in the output as the quantities are nondimensionalized through $z = \\lambda \\Delta t$; however, if you annotate any intermediate quantities, express $\\Delta t$ in seconds and $L$ and $h$ in meters to remain internally consistent. Angles are not involved. Percentages must not be used anywhere; if any fractional quantities appear in your derivation or code, they must be represented as decimals or fractions without the percentage sign.", "solution": "The problem as stated is valid. It is scientifically grounded in the principles of numerical analysis for ordinary differential equations, specifically the stability theory of Runge–Kutta methods. The problem is well-posed, with all necessary data and definitions provided for a unique and verifiable solution. The parameters and context, related to Discontinuous Galerkin methods for the Navier–Stokes equations, are realistic and standard in computational fluid dynamics. I will now proceed with the solution.\n\nThe stability of a numerical time integration scheme is analyzed by applying it to the Dahlquist test equation, $y'(t) = \\lambda y(t)$, where $\\lambda$ is a complex number with $\\operatorname{Re}(\\lambda) \\le 0$. The application of a Runge–Kutta (RK) method with a time step $\\Delta t$ results in a discrete map $y^{n+1} = R(z) y^n$, where $z = \\lambda \\Delta t$ is the dimensionless stability argument and $R(z)$ is the stability function. A method is stable for a given $z$ if $|R(z)| \\le 1$.\n\nFor an $s$-stage RK method defined by its Butcher tableau $(\\mathbf{A}, \\mathbf{b}, \\mathbf{c})$, the internal stage values $\\mathbf{Y} \\in \\mathbb{C}^s$ for the Dahlquist equation satisfy the linear system:\n$$\n\\mathbf{Y} = y^n \\mathbf{1} + z \\mathbf{A} \\mathbf{Y}\n$$\nwhere $\\mathbf{1}$ is the $s$-dimensional vector of ones. Rearranging yields $(\\mathbf{I} - z \\mathbf{A})\\mathbf{Y} = y^n \\mathbf{1}$, which can be solved for the stage vector $\\mathbf{Y} = y^n (\\mathbf{I} - z \\mathbf{A})^{-1} \\mathbf{1}$.\n\nThe numerical solution is updated via $y^{n+1} = y^n + \\Delta t \\sum_{i=1}^s b_i k_i$, where the stage derivatives are $k_i = \\lambda Y_i$. In vector form, this is $y^{n+1} = y^n + z \\mathbf{b}^T \\mathbf{Y}$. Substituting the expression for $\\mathbf{Y}$ gives:\n$$\ny^{n+1} = y^n + z \\mathbf{b}^T (y^n (\\mathbf{I} - z \\mathbf{A})^{-1} \\mathbf{1}) = \\left( 1 + z \\mathbf{b}^T (\\mathbf{I} - z \\mathbf{A})^{-1} \\mathbf{1} \\right) y^n\n$$\nThus, the stability function is given by the general expression:\n$$\nR(z) = 1 + z \\mathbf{b}^T (\\mathbf{I} - z \\mathbf{A})^{-1} \\mathbf{1}\n$$\nWe will now derive $R(z)$ for the two specified methods using this formula.\n\n**1. ESDIRK Implicit Trapezoidal Method ($s=2$)**\nThe coefficients are given by $\\mathbf{A} = \\begin{bmatrix} 0  0 \\\\ 1/2  1/2 \\end{bmatrix}$ and $\\mathbf{b}^T = [1/2, 1/2]$.\nFirst, we construct the matrix $(\\mathbf{I} - z \\mathbf{A})$:\n$$\n\\mathbf{I} - z \\mathbf{A} = \\begin{bmatrix} 1  0 \\\\ 0  1 \\end{bmatrix} - z \\begin{bmatrix} 0  0 \\\\ 1/2  1/2 \\end{bmatrix} = \\begin{bmatrix} 1  0 \\\\ -z/2  1 - z/2 \\end{bmatrix}\n$$\nThe inverse of this $2 \\times 2$ matrix is:\n$$\n(\\mathbf{I} - z \\mathbf{A})^{-1} = \\frac{1}{1(1-z/2) - 0} \\begin{bmatrix} 1 - z/2  0 \\\\ z/2  1 \\end{bmatrix} = \\begin{bmatrix} 1  0 \\\\ z/(2(1-z/2))  1/(1-z/2) \\end{bmatrix}\n$$\nNow, we compute the product $(\\mathbf{I} - z \\mathbf{A})^{-1} \\mathbf{1}$:\n$$\n(\\mathbf{I} - z \\mathbf{A})^{-1} \\mathbf{1} = \\begin{bmatrix} 1  0 \\\\ z/(2(1-z/2))  1/(1-z/2) \\end{bmatrix} \\begin{bmatrix} 1 \\\\ 1 \\end{bmatrix} = \\begin{bmatrix} 1 \\\\ \\frac{z/2 + 1}{1-z/2} \\end{bmatrix}\n$$\nNext, we compute the term $z \\mathbf{b}^T (\\mathbf{I} - z \\mathbf{A})^{-1} \\mathbf{1}$:\n$$\nz \\begin{bmatrix} 1/2  1/2 \\end{bmatrix} \\begin{bmatrix} 1 \\\\ \\frac{1+z/2}{1-z/2} \\end{bmatrix} = z \\left( \\frac{1}{2} + \\frac{1}{2} \\frac{1+z/2}{1-z/2} \\right) = \\frac{z}{2} \\left( \\frac{1-z/2 + 1+z/2}{1-z/2} \\right) = \\frac{z}{2} \\left( \\frac{2}{1-z/2} \\right) = \\frac{z}{1-z/2}\n$$\nFinally, the stability function is:\n$$\nR_1(z) = 1 + \\frac{z}{1-z/2} = \\frac{1-z/2 + z}{1-z/2} = \\frac{1+z/2}{1-z/2}\n$$\nThis is the stability function of the classical trapezoidal rule. It is known to be $A$-stable, meaning its stability region includes the entire left-half of the complex plane, $\\{z \\in \\mathbb{C} \\mid \\operatorname{Re}(z) \\le 0\\}$. For any $z = \\mathrm{i}\\omega$ on the imaginary axis, $|R_1(\\mathrm{i}\\omega)| = |(1+\\mathrm{i}\\omega/2)/(1-\\mathrm{i}\\omega/2)| = 1$.\n\n**2. Stiffly Accurate SDIRK Method ($s=2$)**\nThe coefficients are given by $\\gamma = 1 - 1/\\sqrt{2}$, $\\mathbf{A} = \\begin{bmatrix} \\gamma  0 \\\\ 1-\\gamma  \\gamma \\end{bmatrix}$, and $\\mathbf{b}^T = [1-\\gamma, \\gamma]$.\nThe matrix $(\\mathbf{I} - z \\mathbf{A})$ is:\n$$\n\\mathbf{I} - z \\mathbf{A} = \\begin{bmatrix} 1  0 \\\\ 0  1 \\end{bmatrix} - z \\begin{bmatrix} \\gamma  0 \\\\ 1-\\gamma  \\gamma \\end{bmatrix} = \\begin{bmatrix} 1-z\\gamma  0 \\\\ -z(1-\\gamma)  1-z\\gamma \\end{bmatrix}\n$$\nIts determinant is $(1-z\\gamma)^2$. The inverse is:\n$$\n(\\mathbf{I} - z \\mathbf{A})^{-1} = \\frac{1}{(1-z\\gamma)^2} \\begin{bmatrix} 1-z\\gamma  0 \\\\ z(1-\\gamma)  1-z\\gamma \\end{bmatrix} = \\begin{bmatrix} \\frac{1}{1-z\\gamma}  0 \\\\ \\frac{z(1-\\gamma)}{(1-z\\gamma)^2}  \\frac{1}{1-z\\gamma} \\end{bmatrix}\n$$\nWe compute the term $z \\mathbf{b}^T (\\mathbf{I} - z \\mathbf{A})^{-1} \\mathbf{1}$:\n$$\n\\mathbf{b}^T (\\mathbf{I} - z \\mathbf{A})^{-1} \\mathbf{1} = \\begin{bmatrix} 1-\\gamma  \\gamma \\end{bmatrix} \\begin{bmatrix} \\frac{1}{1-z\\gamma} \\\\ \\frac{z(1-\\gamma)}{(1-z\\gamma)^2} + \\frac{1}{1-z\\gamma} \\end{bmatrix} = \\frac{1-\\gamma}{1-z\\gamma} + \\frac{\\gamma(z(1-\\gamma)+1-z\\gamma)}{(1-z\\gamma)^2}\n$$\n$$\n= \\frac{(1-\\gamma)(1-z\\gamma) + \\gamma(1+z-2z\\gamma)}{(1-z\\gamma)^2} = \\frac{(1-\\gamma -z\\gamma + z\\gamma^2) + (\\gamma + z\\gamma - 2z\\gamma^2)}{(1-z\\gamma)^2} = \\frac{1 - z\\gamma^2}{(1-z\\gamma)^2}\n$$\nThe stability function is:\n$$\nR_2(z) = 1 + z \\left( \\frac{1-z\\gamma^2}{(1-z\\gamma)^2} \\right) = \\frac{(1-z\\gamma)^2 + z(1-z\\gamma^2)}{(1-z\\gamma)^2} = \\frac{1-2z\\gamma+z^2\\gamma^2+z-z^2\\gamma^2}{(1-z\\gamma)^2} = \\frac{1+z(1-2\\gamma)}{(1-z\\gamma)^2}\n$$\nThis method is $L$-stable, which means it is $A$-stable and additionally $\\lim_{|z|\\to\\infty, \\operatorname{Re}(z)0} |R_2(z)| = 0$. This is evident from the form of $R_2(z)$, which behaves as $O(1/z)$ for large $|z|$.\n\n**3. Discontinuous Galerkin (DG) Viscous Eigenvalue Mapping**\nThe largest negative eigenvalue of the DG viscous operator is estimated as $\\lambda_{\\max}^{\\text{neg}} \\approx - \\nu \\, \\alpha_{\\mathrm{DG}} \\, \\frac{(p+1)^2}{h^2}$. Given that $\\nu > 0$, $\\alpha_{\\mathrm{DG}} > 0$, and $h > 0$, this eigenvalue is always a negative real number. Consequently, the stability parameter $z = \\lambda_{\\max}^{\\text{neg}} \\Delta t$ is also a negative real number for any positive time step $\\Delta t$.\nSince both the ESDIRK and SDIRK methods are $A$-stable, their stability regions contain the entire negative real axis. Therefore, for any $z$ derived from the DG eigenvalue estimate, we expect both methods to be stable, i.e., $|R(z)| \\le 1$.\n\n**4. Numerical Validation Plan**\n- **Test 1 (ESDIRK $A$-stability):** We will sample $z=\\mathrm{i}\\omega$ for $100$ values of $\\omega \\in [-100, 100]$, compute $|R_1(\\mathrm{i}\\omega)|$, and verify that the maximum value is less than or equal to $1$, allowing for a small numerical tolerance.\n- **Test 2 (SDIRK $L$-stability):** We will evaluate $|R_2(z)|$ at a large negative real number, $z=-10^6$, and verify that the result is smaller than the specified tolerance of $10^{-6}$.\n- **Test 3  4 (DG Stability):** For each set of parameters $(\\nu, L, N, p, \\Delta t)$, we will compute $h=L/N$, $\\lambda_{\\max}^{\\text{neg}}$, and $z = \\lambda_{\\max}^{\\text{neg}} \\Delta t$. We will then evaluate $|R_1(z)|$ and $|R_2(z)|$ and check if both are less than or equal to $1$.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Constructs and analyzes the stability functions for an ESDIRK and an SDIRK\n    Runge-Kutta method, then applies the analysis to a DG context.\n    \"\"\"\n\n    # --- Part 1: Define Stability Functions ---\n\n    def r_esdirk(z: complex) - complex:\n        \"\"\"\n        Stability function for the s=2 ESDIRK implicit trapezoidal method.\n        R(z) = (1 + z/2) / (1 - z/2).\n        \"\"\"\n        return (1.0 + 0.5 * z) / (1.0 - 0.5 * z)\n\n    def r_sdirk(z: complex) - complex:\n        \"\"\"\n        Stability function for the s=2 stiffly accurate L-stable SDIRK method.\n        R(z) = (1 + z(1-2*gamma)) / (1 - z*gamma)^2.\n        \"\"\"\n        gamma = 1.0 - 1.0 / np.sqrt(2.0)\n        numerator = 1.0 + z * (1.0 - 2.0 * gamma)\n        denominator = (1.0 - z * gamma)**2\n        return numerator / denominator\n\n    results = []\n\n    # --- Part 2: Perform Numerical Tests ---\n\n    # Test 1: ESDIRK A-stability verification\n    # Sample along the imaginary axis and check if |R(i*omega)| = 1.\n    omega_vals = np.linspace(-100.0, 100.0, 100)\n    z_vals_test1 = 1j * omega_vals\n    r_abs_vals_test1 = np.abs(r_esdirk(z_vals_test1))\n    # Use a small tolerance for floating point comparison with the analytical value of 1.\n    is_a_stable_esdirk = np.max(r_abs_vals_test1) = 1.0 + 1e-9\n    results.append(is_a_stable_esdirk)\n\n    # Test 2: SDIRK L-stability verification\n    # Check if |R(z)| - 0 for large negative real z.\n    z_test2 = -1.0e6\n    r_abs_test2 = np.abs(r_sdirk(z_test2))\n    is_l_stable_sdirk = r_abs_test2  1.0e-6\n    results.append(is_l_stable_sdirk)\n\n    def compute_dg_z(nu, L, N, p, dt):\n        \"\"\"\n        Computes the stability parameter z from DG discretization parameters.\n        \"\"\"\n        alpha_dg = 4.0\n        h = L / N\n        lambda_max_neg = -nu * alpha_dg * ((p + 1.0)**2) / (h**2)\n        z = lambda_max_neg * dt\n        return z\n\n    # Test 3: DG viscous mapping, moderate stiffness\n    params_test3 = {'nu': 1.0e-2, 'L': 1.0, 'N': 8, 'p': 3, 'dt': 1.0e-3}\n    z_test3 = compute_dg_z(**params_test3)\n    esdirk_stable_test3 = np.abs(r_esdirk(z_test3)) = 1.0\n    sdirk_stable_test3 = np.abs(r_sdirk(z_test3)) = 1.0\n    results.extend([esdirk_stable_test3, sdirk_stable_test3])\n\n    # Test 4: DG viscous mapping, severe stiffness\n    params_test4 = {'nu': 0.5, 'L': 1.0, 'N': 128, 'p': 9, 'dt': 1.0e-4}\n    z_test4 = compute_dg_z(**params_test4)\n    esdirk_stable_test4 = np.abs(r_esdirk(z_test4)) = 1.0\n    sdirk_stable_test4 = np.abs(r_sdirk(z_test4)) = 1.0\n    results.extend([esdirk_stable_test4, sdirk_stable_test4])\n\n    # --- Part 3: Format and Print Output ---\n    # Convert booleans to strings (\"True\" or \"False\") and join with commas.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3413532"}]}