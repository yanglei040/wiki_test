{"hands_on_practices": [{"introduction": "The foundation of the spectral Galerkin method is the translation of continuous differential operators from a weak formulation into discrete matrix operators. This first practice focuses on constructing these fundamental building blocks. You will implement the core components of the method, including the calculation of Gauss-Lobatto-Legendre nodes and weights, the construction of the nodal differentiation matrix $D$, and the assembly of the discrete mass $M$ and stiffness $K$ matrices [@problem_id:3418566]. This exercise provides the essential \"nuts and bolts\" required for building more complex spectral solvers.", "problem": "Consider the reference interval $[-1,1]$ and the spectral Galerkin method with the Lagrange interpolating nodal basis at the Gauss–Lobatto–Legendre nodes. Let the polynomial degree be $N=4$, so that there are $N+1=5$ nodal points. The fundamental base for this construction is the variational formulation of the one-dimensional Poisson operator and the definition of Lagrange nodal basis functions. Specifically, for a function $v$ represented at the nodal points, the discrete mass matrix $M$ approximates $\\int_{-1}^{1} \\ell_i(x)\\,\\ell_j(x)\\,dx$ and the discrete stiffness matrix $K$ approximates $\\int_{-1}^{1} \\ell_i'(x)\\,\\ell_j'(x)\\,dx$, where $\\ell_i$ are the Lagrange basis polynomials associated with the Gauss–Lobatto–Legendre nodes. The discrete energy norm is defined by $\\|v\\|_K=\\sqrt{v^\\top K v}$.\n\nYour task is to write a complete program that:\n- Computes the Gauss–Lobatto–Legendre nodes on $[-1,1]$ for $N=4$ (including endpoints), and their associated quadrature weights, using the properties of Legendre polynomials and their derivatives.\n- Constructs the Lagrange nodal differentiation matrix $D$ at these nodes by consistent use of barycentric weights for the Lagrange basis, ensuring that $D$ is the matrix representation of differentiation of the nodal interpolant.\n- Assembles the mass matrix $M$ and stiffness matrix $K$ on $[-1,1]$ based on the Gauss–Lobatto–Legendre quadrature rule and the above basis.\n- Computes the discrete energy norm $\\|v\\|_K=\\sqrt{v^\\top K v}$ for each specified nodal vector $v$.\n\nYou must use only mathematically sound procedures and properties of Legendre polynomials, Lagrange interpolation, and Gauss–Lobatto–Legendre quadrature consistent with the spectral Galerkin framework. Angles are not involved, and no physical units are required.\n\nTest Suite:\nUse $N=4$ and the resulting $N+1=5$ nodes. Evaluate the discrete energy norm for the following nodal vectors $v$ (each of length $5$), where $x$ denotes the nodal locations in ascending order:\n1. $v^{(1)}=\\mathbf{1}$ (the constant function sampled at the nodes).\n2. $v^{(2)}=x$ (the linear function sampled at the nodes).\n3. $v^{(3)}=x^2$ (the quadratic function sampled at the nodes).\n4. $v^{(4)}=P_4(x)$ (the Legendre polynomial of degree $4$ evaluated at the nodes).\n5. $v^{(5)}=[\\,0.1,\\,-0.5,\\,0.3,\\,-0.1,\\,0.7\\,]$ (a custom vector, not derived from a single polynomial).\n\nFinal Output Format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[r_1,r_2,r_3,r_4,r_5]$), where each $r_i$ is the computed discrete energy norm for the corresponding test case $v^{(i)}$ as a floating-point number.", "solution": "The problem requires the computation of the discrete energy norm for several nodal vectors using a spectral Galerkin method on the reference interval $[-1, 1]$. The method is defined by a polynomial degree $N=4$, a Lagrange basis on the Gauss–Lobatto–Legendre (GLL) nodes, and a quadrature-based assembly of the mass and stiffness matrices.\n\nThe solution proceeds in four stages:\n1.  Computation of the Gauss-Lobatto-Legendre nodes and quadrature weights.\n2.  Construction of the nodal differentiation matrix.\n3.  Assembly of the discrete mass and stiffness matrices.\n4.  Calculation of the discrete energy norm for the specified test vectors.\n\n### 1. Gauss–Lobatto–Legendre (GLL) Nodes and Weights\n\nFor a polynomial degree $N$, the $N+1$ GLL nodes, denoted as $x_j$ for $j=0, \\dots, N$, are the roots of the polynomial $(1-x^2)P_N'(x)$, where $P_N(x)$ is the Legendre polynomial of degree $N$. The set includes the endpoints $x_0 = -1$ and $x_{N} = 1$. The interior nodes are the roots of $P_N'(x) = 0$.\n\nFor $N=4$, we need the Legendre polynomial $P_4(x)$ and its derivative. The Legendre polynomials can be generated by the recurrence relation $(n+1)P_{n+1}(x) = (2n+1)xP_n(x) - nP_{n-1}(x)$, with $P_0(x)=1$ and $P_1(x)=x$. For $N=4$, this yields:\n$$P_4(x) = \\frac{1}{8}(35x^4 - 30x^2 + 3)$$\nThe derivative is:\n$$P_4'(x) = \\frac{1}{8}(140x^3 - 60x) = \\frac{5}{2}x(7x^2 - 3)$$\nThe roots of $P_4'(x)=0$ are $x=0$ and $x=\\pm\\sqrt{3/7}$. Including the endpoints, the five GLL nodes for $N=4$ in ascending order are:\n$$x = \\{x_0, x_1, x_2, x_3, x_4\\} = \\left\\{-1, -\\sqrt{\\frac{3}{7}}, 0, \\sqrt{\\frac{3}{7}}, 1\\right\\}$$\nNumerically, these are approximately $\\{-1, -0.65465, 0, 0.65465, 1\\}$.\n\nThe corresponding GLL quadrature weights $w_j$ are given by the formula:\n$$w_j = \\frac{2}{N(N+1)[P_N(x_j)]^2}$$\nFor $N=4$, we have $N(N+1)=20$. We evaluate $P_4(x)$ at each node $x_j$:\n-   $P_4(\\pm 1) = 1$\n-   $P_4(\\pm\\sqrt{3/7}) = \\frac{1}{8}(35(\\frac{3}{7})^2 - 30(\\frac{3}{7}) + 3) = -3/7$\n-   $P_4(0) = 3/8$\n\nSubstituting these into the weight formula:\n-   $w_0 = w_4 = \\frac{2}{20 \\cdot 1^2} = \\frac{1}{10}$\n-   $w_1 = w_3 = \\frac{2}{20 \\cdot (-3/7)^2} = \\frac{2}{20 \\cdot 9/49} = \\frac{49}{90}$\n-   $w_2 = \\frac{2}{20 \\cdot (3/8)^2} = \\frac{2}{20 \\cdot 9/64} = \\frac{32}{45}$\n\nThe sum of these weights is $\\frac{1}{10} + \\frac{49}{90} + \\frac{32}{45} + \\frac{49}{90} + \\frac{1}{10} = \\frac{9+49+64+49+9}{90} = \\frac{180}{90}=2$, which correctly equals $\\int_{-1}^{1} 1 \\, dx$.\n\n### 2. Nodal Differentiation Matrix\n\nThe problem employs a Lagrange nodal basis $\\{\\ell_j(x)\\}_{j=0}^N$, where $\\ell_j(x)$ is the unique polynomial of degree $N$ such that $\\ell_j(x_k) = \\delta_{jk}$. An arbitrary polynomial interpolant $v_N(x)$ of nodal values $v_j$ is given by $v_N(x) = \\sum_{j=0}^N v_j \\ell_j(x)$.\nThe entries of the $(N+1) \\times (N+1)$ differentiation matrix $D$ are defined by $D_{ij} = \\ell_j'(x_i)$. This matrix maps the vector of nodal function values to the vector of nodal derivative values: $(v_N')_{i} = \\sum_{j=0}^{N} D_{ij} v_j$.\n\nFor the GLL nodes, the entries of $D$ can be computed efficiently using the following standard formulas:\n$$D_{ij} = \\frac{P_N(x_i)}{P_N(x_j)(x_i - x_j)} \\quad \\text{for } i \\neq j$$\n$$D_{ii} = 0 \\quad \\text{for } i=1, \\dots, N-1$$\n$$D_{00} = -\\frac{N(N+1)}{4} \\quad \\text{and} \\quad D_{NN} = \\frac{N(N+1)}{4}$$\nFor $N=4$, $D_{00} = -5$ and $D_{44} = 5$, while $D_{11}=D_{22}=D_{33}=0$. The off-diagonal entries are calculated using the node locations and the values of $P_4(x_j)$ derived above.\n\n### 3. Mass and Stiffness Matrices\n\nIn the spectral Galerkin method, the mass matrix $M$ and stiffness matrix $K$ entries are given by integrals:\n$$M_{ij} = \\int_{-1}^{1} \\ell_i(x)\\ell_j(x)\\,dx, \\quad K_{ij} = \\int_{-1}^{1} \\ell_i'(x)\\ell_j'(x)\\,dx$$\nThese integrals are evaluated numerically using the GLL quadrature rule, $\\int_{-1}^{1} f(x)\\,dx \\approx \\sum_{k=0}^{N} f(x_k)w_k$.\n\nFor the mass matrix, this gives:\n$$M_{ij} \\approx \\sum_{k=0}^N \\ell_i(x_k)\\ell_j(x_k) w_k = \\sum_{k=0}^N \\delta_{ik}\\delta_{jk} w_k = \\delta_{ij} w_i$$\nThis results in a diagonal, or \"lumped,\" mass matrix $M = \\text{diag}(w_0, w_1, \\dots, w_N)$. The GLL quadrature for $M_{ij}$ is an approximation because the integrand $\\ell_i(x)\\ell_j(x)$ is a polynomial of degree up to $2N=8$, while the quadrature is exact only for polynomials of degree up to $2N-1=7$.\n\nFor the stiffness matrix, the quadrature gives:\n$$K_{ij} = \\int_{-1}^{1} \\ell_i'(x)\\ell_j'(x)\\,dx \\approx \\sum_{k=0}^N \\ell_i'(x_k)\\ell_j'(x_k) w_k$$\nThe integrand $\\ell_i'(x)\\ell_j'(x)$ is a polynomial of degree up to $2(N-1)=6$. Since $6 \\leq 2N-1=7$, the GLL quadrature is exact. Using the definition of the differentiation matrix, $\\ell_j'(x_k) = D_{kj}$, the stiffness matrix entries are:\n$$K_{ij} = \\sum_{k=0}^N D_{ki} D_{kj} w_k$$\nIn matrix form, this is expressed compactly as $K = D^T M D$.\n\n### 4. Discrete Energy Norm Calculation\n\nThe discrete energy norm of a nodal vector $v$ is $\\|v\\|_K = \\sqrt{v^T K v}$. Using the matrix formulation for $K$, this is:\n$$\\|v\\|_K = \\sqrt{v^T (D^T M D) v} = \\sqrt{(Dv)^T M (Dv)}$$\nLet $v' = Dv$ be the vector of derivative values at the nodes. The squared norm becomes $(v')^T M v' = \\sum_{k=0}^N (v'_k)^2 w_k$. This is the GLL quadrature approximation of the continuous energy norm integrated-by-parts form, $\\int_{-1}^{1} (v_N'(x))^2 dx$.\n\nFor the specified test vectors, we calculate this norm.\n1.  $v^{(1)}$ represents $f(x)=1$. The exact derivative is $0$. $D v^{(1)}$ will be a zero vector (up to machine precision), so $\\|v^{(1)}\\|_K = 0$.\n2.  $v^{(2)}$ represents $f(x)=x$. The exact derivative is $1$. $D v^{(2)}$ will be a vector of ones. The quadrature is exact for the integrand $(1)^2=1$. Thus, $\\|v^{(2)}\\|_K^2 = \\int_{-1}^1 1^2 dx = 2$, so $\\|v^{(2)}\\|_K = \\sqrt{2}$.\n3.  $v^{(3)}$ represents $f(x)=x^2$. The exact derivative is $2x$. The quadrature is exact for the integrand $(2x)^2=4x^2$. Thus, $\\|v^{(3)}\\|_K^2 = \\int_{-1}^1 4x^2 dx = 4[x^3/3]_{-1}^1 = 8/3$, so $\\|v^{(3)}\\|_K = \\sqrt{8/3}$.\n4.  $v^{(4)}$ represents $f(x)=P_4(x)$. The derivative is $P_4'(x)$. The quadrature is exact for $(P_4'(x))^2$, a polynomial of degree $6$. Thus, $\\|v^{(4)}\\|_K^2 = \\int_{-1}^1 (P_4'(x))^2 dx = 20$, so $\\|v^{(4)}\\|_K = \\sqrt{20}$.\n5.  $v^{(5)}$ is a generic vector, for which the norm is computed numerically without a simple analytical a priori value.\n\nThe implementation will follow these steps to construct the matrices and compute the norms.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.special import legendre\n\ndef solve():\n    \"\"\"\n    Computes the discrete energy norm ||v||_K for a spectral Galerkin method\n    with N=4 on Gauss-Lobatto-Legendre nodes.\n    \"\"\"\n    N = 4\n    N_plus_1 = N + 1\n\n    # Step 1: Compute Gauss-Lobatto-Legendre nodes and weights for N=4\n    \n    # The interior GLL nodes are the roots of the derivative of the N-th Legendre polynomial, P_N'(x).\n    # We use scipy.special.legendre to get the polynomial P_N(x)\n    # and its derivative to find the roots robustly.\n    P_N = legendre(N)\n    P_N_prime = P_N.deriv()\n    \n    # Find the roots of P_N'(x) to get the interior nodes.\n    interior_nodes = np.roots(P_N_prime)\n    \n    # Combine with endpoints and sort to get all GLL nodes.\n    nodes = np.concatenate(([-1.0], np.sort(interior_nodes), [1.0]))\n\n    # The GLL quadrature weights are given by w_j = 2 / (N*(N+1)*[P_N(x_j)]^2)\n    P_N_at_nodes = P_N(nodes)\n    weights = 2.0 / (N * N_plus_1 * P_N_at_nodes**2)\n\n    # Step 2: Construct the Lagrange nodal differentiation matrix D\n    D = np.zeros((N_plus_1, N_plus_1))\n    \n    # Off-diagonal entries\n    for i in range(N_plus_1):\n        for j in range(N_plus_1):\n            if i != j:\n                D[i, j] = P_N_at_nodes[i] / (P_N_at_nodes[j] * (nodes[i] - nodes[j]))\n\n    # Diagonal entries\n    D[0, 0] = -N * N_plus_1 / 4.0\n    D[N, N] = N * N_plus_1 / 4.0\n    # Interior diagonal entries are already 0 from initialization.\n\n    # Step 3: Assemble Mass M and Stiffness K matrices\n    # The mass matrix M is the lumped mass matrix, diagonal with quadrature weights.\n    M = np.diag(weights)\n    \n    # The stiffness matrix K is assembled using GLL quadrature, which is exact.\n    # K = D^T * M * D\n    K = D.T @ M @ D\n\n    # Step 4: Define test vectors and compute discrete energy norm\n    test_cases = [\n        # Case 1: v^(1) = 1 (constant function)\n        np.ones(N_plus_1),\n        # Case 2: v^(2) = x (linear function)\n        nodes,\n        # Case 3: v^(3) = x^2 (quadratic function)\n        nodes**2,\n        # Case 4: v^(4) = P_4(x) (Legendre polynomial of degree 4)\n        P_N_at_nodes,\n        # Case 5: v^(5) (custom vector)\n        np.array([0.1, -0.5, 0.3, -0.1, 0.7]),\n    ]\n\n    results = []\n    for v in test_cases:\n        # The discrete energy norm is sqrt(v^T * K * v)\n        # Add a small epsilon for cases where the result is zero to avoid sqrt(-ve) from precision errors.\n        energy_norm_sq = v.T @ K @ v\n        if abs(energy_norm_sq) < 1e-15:\n            energy_norm_sq = 0.0\n        energy_norm = np.sqrt(energy_norm_sq)\n        results.append(energy_norm)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.10f}' for r in results)}]\")\n\nsolve()\n```", "id": "3418566"}, {"introduction": "With the ability to construct the core matrix operators, we can now apply them to solve a canonical boundary value problem. This exercise tackles the one-dimensional Poisson equation, a fundamental model for many physical phenomena. The practice not only involves assembling and solving the linear system but also demonstrates one of the most powerful features of spectral methods [@problem_id:3418627]. You will see how the method can yield the exact analytical solution, a direct consequence of the solution's smoothness and the properties of the polynomial approximation space.", "problem": "Consider the one-dimensional Poisson problem on the interval $[-1,1]$: find $u$ such that $-u''=1$ in $(-1,1)$ with homogeneous Dirichlet boundary conditions $u(-1)=0$ and $u(1)=0$. Using the spectral Galerkin framework, start from the weak formulation and construct a conforming spectral element discretization with two equal-length elements $[-1,0]$ and $[0,1]$. On each element, use a polynomial approximation space of degree $N=3$ spanned by Lagrange basis functions at the Legendre-Gauss-Lobatto (LGL) nodes, where the LGL nodes are the element endpoints together with the interior nodes given by the zeros of the derivative of the Legendre polynomial of degree $N$ on the reference element. Use the standard affine isoparametric mapping from the reference element $[-1,1]$ to each physical element, and evaluate all element integrals using LGL quadrature of the same order as the nodal set.\n\nFrom the weak formulation and the Galerkin principle, explain why the discrete spectral element solution coincides with the exact solution in this setting. Then, using the explicit positions of the LGL nodes for $N=3$, map these nodes to the physical coordinates of the two elements, assemble the global set of distinct Gauss-Lobatto points across $[-1,1]$, and compute the nodal values of the discrete solution at these points. Report the nodal solution values as a single row matrix, ordered by increasing physical coordinate from $x=-1$ to $x=1$. No rounding is permitted; provide exact values.", "solution": "The problem asks for an explanation of why the spectral element solution to a specific one-dimensional Poisson problem is exact, and for the computation of the nodal values of this solution.\n\nFirst, we validate the problem statement. The problem defines a standard one-dimensional Poisson equation $-u''=1$ on the interval $[-1,1]$ with homogeneous Dirichlet boundary conditions $u(-1)=0$ and $u(1)=0$. It specifies a conforming spectral element method with two elements, polynomial degree $N=3$, Lagrange basis functions on Legendre-Gauss-Lobatto (LGL) nodes, and LGL quadrature for integral evaluation. All components are well-defined within the theory of spectral methods. The problem is scientifically grounded, well-posed, objective, self-contained, and consistent. It is a valid problem.\n\nWe begin by finding the exact analytical solution to the boundary value problem. Integrating the equation $-u''=1$ twice with respect to $x$ yields:\n$u'(x) = -x + C_1$\n$u(x) = -\\frac{1}{2}x^2 + C_1 x + C_2$\nThe constants of integration $C_1$ and $C_2$ are determined by the boundary conditions:\n$u(-1) = -\\frac{1}{2} - C_1 + C_2 = 0$\n$u(1) = -\\frac{1}{2} + C_1 + C_2 = 0$\nAdding these two equations gives $-1 + 2C_2 = 0$, which implies $C_2 = \\frac{1}{2}$. Subtracting the first equation from the second gives $2C_1 = 0$, which implies $C_1 = 0$. Thus, the exact solution is:\n$$u(x) = \\frac{1}{2}(1-x^2)$$\nThis exact solution is a polynomial of degree $2$.\n\nNext, we establish the weak formulation. Let the solution space be $V = H_0^1(-1,1) = \\{v \\in H^1(-1,1) | v(-1)=v(1)=0\\}$. We multiply the PDE by a test function $v \\in V$ and integrate over the domain $[-1,1]$:\n$$-\\int_{-1}^{1} u''(x)v(x) dx = \\int_{-1}^{1} 1 \\cdot v(x) dx$$\nApplying integration by parts to the left-hand side and using the fact that $v(-1)=v(1)=0$:\n$$\\int_{-1}^{1} u'(x)v'(x) dx - [u'(x)v(x)]_{-1}^{1} = \\int_{-1}^{1} v(x) dx$$\n$$\\int_{-1}^{1} u'(x)v'(x) dx = \\int_{-1}^{1} v(x) dx$$\nThe weak formulation is to find $u \\in V$ such that $a(u,v) = f(v)$ for all $v \\in V$, where the bilinear form $a(u,v)$ and linear functional $f(v)$ are:\n$$a(u,v) = \\int_{-1}^{1} u'(x)v'(x) dx \\quad \\text{and} \\quad f(v) = \\int_{-1}^{1} v(x) dx$$\nIn the spectral element method, we define a finite-dimensional approximation space $V_N \\subset V$. The domain $[-1,1]$ is partitioned into two elements, $\\Omega_1 = [-1,0]$ and $\\Omega_2 = [0,1]$. The approximation space is defined as:\n$$V_N = \\{v_N \\in C^0([-1,1]) \\cap V \\mid v_N|_{\\Omega_e} \\in \\mathbb{P}_N(\\Omega_e) \\text{ for } e=1,2\\}$$\nwhere $\\mathbb{P}_N$ is the space of polynomials of degree at most $N$. In this problem, $N=3$. The Galerkin problem is to find a discrete solution $u_N \\in V_N$ such that:\n$$a(u_N, v_N) = f(v_N) \\quad \\text{for all } v_N \\in V_N$$\nThe problem states that all integrals are evaluated using LGL quadrature based on the $N=3$ LGL nodal set. This introduces numerical integration, leading to a discrete system $a_N(u_N, v_N) = f_N(v_N)$, where $a_N$ and $f_N$ represent the forms with their integrals replaced by the quadrature sum. An LGL quadrature rule with $N+1$ points (degree $N$) is exact for polynomials of degree up to $2N-1$. For $N=3$, the quadrature is exact for polynomials of degree up to $2(3)-1=5$.\n\nThe discrete spectral element solution coincides with the exact solution for two key reasons:\n1. The exact solution $u(x) = \\frac{1}{2}(1-x^2)$ is a polynomial of degree $2$. The approximation space $V_N$ for $N=3$ consists of continuous piecewise polynomials of degree up to $3$. Since the global exact solution is a single polynomial of degree $2$, it is trivially a member of this space, i.e., $u(x) \\in V_N$.\n2. The numerical quadrature used is exact for the integrals involved. For any test function $v_N \\in V_N$, $v_N$ is a piecewise polynomial of degree at most $3$.\n   - The integrand in the bilinear form $a(u,v_N)$ is $u'(x)v'_N(x)$. Since $u(x)$ is degree $2$, $u'(x)=-x$ is degree $1$. Since $v_N(x)$ is degree $3$ on each element, $v'_N(x)$ is degree $2$. The product $u'(x)v'_N(x)$ is a polynomial of degree $1+2=3$ on each element.\n   - The integrand in the linear functional $f(v_N)$ is $1 \\cdot v_N(x)$, which is a polynomial of degree $3$ on each element.\nSince both integrands are polynomials of degree $3$, and $3 \\le 5$, the $N=3$ LGL quadrature computes these integrals exactly. Therefore, $a_N(u, v_N) = a(u, v_N)$ and $f_N(v_N) = f(v_N)$ for all $v_N \\in V_N$.\nThe exact solution $u$ satisfies $a(u,v) = f(v)$ for all $v \\in V$, and thus for all $v_N \\in V_N$. As the quadrature is exact, it follows that $a_N(u, v_N) = f_N(v_N)$. This means the exact solution $u$ satisfies the discrete system of equations. Since the discrete system for this problem has a unique solution, the computed discrete solution $u_N$ must be identical to the exact solution $u$.\n\nNow we compute the nodal values. First, we find the LGL nodes for $N=3$ on the reference element $\\hat{\\Omega}=[-1,1]$. The interior nodes are the zeros of the derivative of the Legendre polynomial $P_3(\\xi) = \\frac{1}{2}(5\\xi^3 - 3\\xi)$. The derivative is $P'_3(\\xi) = \\frac{3}{2}(5\\xi^2 - 1)$. The zeros are given by $5\\xi^2 - 1 = 0$, so $\\xi = \\pm 1/\\sqrt{5}$. Including the endpoints, the LGL nodes are:\n$$\\xi_0 = -1, \\quad \\xi_1 = -\\frac{1}{\\sqrt{5}}, \\quad \\xi_2 = \\frac{1}{\\sqrt{5}}, \\quad \\xi_3 = 1$$\nNext, we map these nodes to the physical elements $\\Omega_1 = [-1,0]$ and $\\Omega_2 = [0,1]$.\nFor $\\Omega_1 = [-1,0]$, the mapping is $x(\\xi) = \\frac{\\xi-1}{2}$. The nodes are:\n$x_0^1 = -1$, $x_1^1 = \\frac{-1/\\sqrt{5}-1}{2} = -\\frac{1}{2}(1+\\frac{1}{\\sqrt{5}})$, $x_2^1 = \\frac{1/\\sqrt{5}-1}{2} = -\\frac{1}{2}(1-\\frac{1}{\\sqrt{5}})$, $x_3^1 = 0$.\nFor $\\Omega_2 = [0,1]$, the mapping is $x(\\xi) = \\frac{\\xi+1}{2}$. The nodes are:\n$x_0^2 = 0$, $x_1^2 = \\frac{-1/\\sqrt{5}+1}{2} = \\frac{1}{2}(1-\\frac{1}{\\sqrt{5}})$, $x_2^2 = \\frac{1/\\sqrt{5}+1}{2} = \\frac{1}{2}(1+\\frac{1}{\\sqrt{5}})$, $x_3^2 = 1$.\nThe global set of distinct nodes, ordered from $x=-1$ to $x=1$, is:\n$$X_0 = -1$$\n$$X_1 = -\\frac{1}{2}(1+\\frac{1}{\\sqrt{5}})$$\n$$X_2 = -\\frac{1}{2}(1-\\frac{1}{\\sqrt{5}})$$\n$$X_3 = 0$$\n$$X_4 = \\frac{1}{2}(1-\\frac{1}{\\sqrt{5}})$$\n$$X_5 = \\frac{1}{2}(1+\\frac{1}{\\sqrt{5}})$$\n$$X_6 = 1$$\nSince the discrete solution $u_N$ is identical to the exact solution $u(x)=\\frac{1}{2}(1-x^2)$, the nodal values are found by evaluating $u(x)$ at these global node locations.\n$u(X_0) = u(-1) = \\frac{1}{2}(1 - (-1)^2) = 0$.\n$u(X_1) = u(-\\frac{1}{2}(1+\\frac{1}{\\sqrt{5}})) = \\frac{1}{2}\\left(1 - \\frac{1}{4}(1+\\frac{1}{\\sqrt{5}})^2\\right) = \\frac{1}{2}\\left(1 - \\frac{1}{4}(1+\\frac{2}{\\sqrt{5}}+\\frac{1}{5})\\right) = \\frac{1}{2}\\left(1 - \\frac{1}{4}(\\frac{6}{5}+\\frac{2}{\\sqrt{5}})\\right) = \\frac{1}{2}\\left(1 - \\frac{3}{10} - \\frac{1}{2\\sqrt{5}}\\right) = \\frac{1}{2}(\\frac{7}{10} - \\frac{\\sqrt{5}}{10}) = \\frac{7-\\sqrt{5}}{20}$.\n$u(X_2) = u(-\\frac{1}{2}(1-\\frac{1}{\\sqrt{5}})) = \\frac{1}{2}\\left(1 - \\frac{1}{4}(1-\\frac{1}{\\sqrt{5}})^2\\right) = \\frac{1}{2}\\left(1 - \\frac{1}{4}(1-\\frac{2}{\\sqrt{5}}+\\frac{1}{5})\\right) = \\frac{1}{2}\\left(1 - \\frac{1}{4}(\\frac{6}{5}-\\frac{2}{\\sqrt{5}})\\right) = \\frac{1}{2}\\left(1 - \\frac{3}{10} + \\frac{1}{2\\sqrt{5}}\\right) = \\frac{1}{2}(\\frac{7}{10} + \\frac{\\sqrt{5}}{10}) = \\frac{7+\\sqrt{5}}{20}$.\n$u(X_3) = u(0) = \\frac{1}{2}(1 - 0^2) = \\frac{1}{2}$.\nDue to the symmetry of the exact solution $u(x)=u(-x)$ and the symmetric distribution of nodes, we have:\n$u(X_4) = u(-X_2) = u(X_2) = \\frac{7+\\sqrt{5}}{20}$.\n$u(X_5) = u(-X_1) = u(X_1) = \\frac{7-\\sqrt{5}}{20}$.\n$u(X_6) = u(1) = \\frac{1}{2}(1 - 1^2) = 0$.\nThe nodal solution values, ordered by increasing coordinate, are:\n$\\{0, \\frac{7-\\sqrt{5}}{20}, \\frac{7+\\sqrt{5}}{20}, \\frac{1}{2}, \\frac{7+\\sqrt{5}}{20}, \\frac{7-\\sqrt{5}}{20}, 0\\}$.", "answer": "$$\\boxed{\\begin{pmatrix} 0 & \\frac{7-\\sqrt{5}}{20} & \\frac{7+\\sqrt{5}}{20} & \\frac{1}{2} & \\frac{7+\\sqrt{5}}{20} & \\frac{7-\\sqrt{5}}{20} & 0 \\end{pmatrix}}$$", "id": "3418627"}, {"introduction": "While linear problems provide excellent insight, many phenomena in science and engineering are inherently nonlinear. This practice shifts our focus to the challenges and techniques required for handling nonlinear terms, using the quadratic nonlinearity $u^2$ as a model. A naive evaluation of such terms in physical space can introduce aliasing errors, which corrupt the solution. This theoretical exercise guides you through the analysis of aliasing and the derivation of the necessary conditions to eliminate it, leading to the famous \"3/2 rule\" for de-aliasing [@problem_id:3418568].", "problem": "Consider the standard Spectral Galerkin method for the one-dimensional interval with two canonical approximation spaces.\n\n1. Polynomial space on a bounded interval:\nLet $\\mathcal{P}_{N}$ denote the space of polynomials of degree at most $N$ on the interval $[-1,1]$ with the standard Lebesgue weight. Let $\\{L_{k}(x)\\}_{k=0}^{N}$ be an $L^{2}([-1,1])$-orthonormal basis for $\\mathcal{P}_{N}$, such as suitably normalized Legendre polynomials. Define the $L^{2}$ projection onto $\\mathcal{P}_{N}$ by\n$$\nP_{N}f = \\sum_{k=0}^{N} \\left( \\int_{-1}^{1} f(x)\\, L_{k}(x)\\, \\mathrm{d}x \\right) L_{k}(x).\n$$\nAssume $u \\in \\mathcal{P}_{N}$. You wish to compute $P_{N}(u^{2})$ exactly using Gauss–Legendre quadrature with $Q$ points. Use the well-tested fact that Gauss–Legendre quadrature with $Q$ points is exact for all polynomials of degree at most $2Q-1$. Determine, in terms of $N$, the minimal quadrature point count $Q_{\\min}$ required so that $P_{N}(u^{2})$ is computed exactly.\n\n2. Trigonometric polynomial space on a periodic interval:\nLet $\\mathcal{T}_{N}$ denote the space of trigonometric polynomials with wavenumbers $|k| \\leq N$ on the interval $[-\\pi,\\pi]$, so $\\dim(\\mathcal{T}_{N}) = 2N+1$. Represent $u \\in \\mathcal{T}_{N}$ on an equispaced grid of $M_{0} = 2N+1$ points and evaluate the quadratic nonlinearity in a pseudo-spectral manner by transforming to physical space, multiplying pointwise, and transforming back. To eliminate aliasing and obtain the exact $L^{2}$ projection of $u^{2}$ onto $\\mathcal{T}_{N}$, you zero-pad to $M$ points before transforming, perform the nonlinear operation at this resolution, then project back onto the wavenumber band $|k|\\leq N$.\n\nUse the core definition of the discrete Fourier transform convolution: the Fourier coefficients of the product on an $M$-point grid correspond to a circular convolution modulo $M$. Derive, in terms of $N$, the minimal padding factor\n$$\ns(N) = \\frac{M}{M_{0}}\n$$\nrequired to ensure that the $L^{2}$ projection of $u^{2}$ back to $\\mathcal{T}_{N}$ is exact (i.e., alias-free).\n\nAnswer specification:\n- Express the final answer as two closed-form expressions in $N$, one for $Q_{\\min}$ and one for $s(N)$.\n- Provide your final answer as a two-entry row matrix.", "solution": "This problem consists of two independent parts concerning the exact computation of a quadratic nonlinearity, $u^2$, within the framework of spectral methods. The first part addresses polynomial approximation spaces, while the second part deals with trigonometric polynomial spaces.\n\n### Part 1: Polynomial Space and Gauss Quadrature\n\nThe goal is to find the minimum number of quadrature points, $Q_{\\min}$, required for a Gauss-Legendre quadrature rule to exactly compute the $L^2$ projection of $u^2$ onto the polynomial space $\\mathcal{P}_N$, where $u \\in \\mathcal{P}_N$.\n\nThe $L^2$ projection of a function $f$ onto $\\mathcal{P}_N$ is given by\n$$\nP_{N}f = \\sum_{k=0}^{N} \\hat{f}_k L_{k}(x)\n$$\nwhere $\\{L_k(x)\\}_{k=0}^N$ is an $L^2([-1,1])$-orthonormal basis for $\\mathcal{P}_N$, and the coefficients $\\hat{f}_k$ are computed via the inner product:\n$$\n\\hat{f}_k = \\int_{-1}^{1} f(x) L_k(x) \\, \\mathrm{d}x\n$$\nIn this problem, the function to be projected is $f(x) = u^2(x)$, where $u \\in \\mathcal{P}_N$. Therefore, we need to compute the integrals\n$$\n\\widehat{(u^2)}_k = \\int_{-1}^{1} u^2(x) L_k(x) \\, \\mathrm{d}x \\quad \\text{for } k=0, 1, \\dots, N.\n$$\nTo compute these integrals exactly using Gauss-Legendre quadrature, we must determine the maximum possible polynomial degree of the integrand, $u^2(x) L_k(x)$.\n\n1.  The function $u(x)$ is a polynomial of degree at most $N$, i.e., $u \\in \\mathcal{P}_N$.\n2.  The square of $u(x)$, which is $u^2(x)$, is therefore a polynomial of degree at most $2N$.\n3.  The basis functions $L_k(x)$ are polynomials of degree $k$. Since we need to compute coefficients for $k$ up to $N$, the basis function with the highest degree involved is $L_N(x)$, which has degree $N$.\n4.  The integrand is the product $u^2(x) L_k(x)$. The degree of this product is the sum of the degrees of its factors. The maximum degree occurs when both $u^2(x)$ and $L_k(x)$ have their maximum possible degrees. This happens for $k=N$ and for a $u(x)$ that is of degree exactly $N$.\n    $$\n    \\text{deg}(u^2(x) L_k(x)) \\le \\text{deg}(u^2(x)) + \\text{deg}(L_k(x)) \\le 2N + k\n    $$\n    The maximum degree across all integrands (for $k = 0, \\dots, N$) is\n    $$\n    \\max_{k \\in \\{0, \\dots, N\\}} \\text{deg}(u^2(x) L_k(x)) = 2N + N = 3N.\n    $$\n\nThe problem states that Gauss-Legendre quadrature with $Q$ points is exact for all polynomials of degree at most $2Q-1$. To ensure that all required integral coefficients are computed exactly, the quadrature rule must be exact for the highest-degree polynomial we might encounter. Thus, we require:\n$$\n2Q - 1 \\ge 3N\n$$\nSolving this inequality for $Q$ gives:\n$$\n2Q \\ge 3N + 1\n$$\n$$\nQ \\ge \\frac{3N+1}{2}\n$$\nSince the number of quadrature points $Q$ must be an integer, we need the smallest integer value of $Q$ that satisfies this condition. This is given by the ceiling function:\n$$\nQ_{\\min} = \\left\\lceil \\frac{3N+1}{2} \\right\\rceil\n$$\n\n### Part 2: Trigonometric Polynomial Space and De-aliasing\n\nThe goal is to find the minimal padding factor $s(N) = M/M_0$ required to exactly compute the $L^2$ projection of $u^2$ onto the trigonometric polynomial space $\\mathcal{T}_N$, where $u \\in \\mathcal{T}_N$. This is achieved by eliminating aliasing error in a pseudo-spectral calculation.\n\nA function $u(x) \\in \\mathcal{T}_N$ is a trigonometric polynomial with wavenumbers in the range $|k| \\le N$. It can be written as a Fourier series:\n$$\nu(x) = \\sum_{k=-N}^{N} \\hat{u}_k e^{ikx}\n$$\nThe product of two such functions, $u^2(x) = u(x) \\cdot u(x)$, is:\n$$\nu^2(x) = \\left(\\sum_{j=-N}^{N} \\hat{u}_j e^{ijx}\\right) \\left(\\sum_{l=-N}^{N} \\hat{u}_l e^{ilx}\\right) = \\sum_{j=-N}^{N} \\sum_{l=-N}^{N} \\hat{u}_j \\hat{u}_l e^{i(j+l)x}\n$$\nThe resulting wavenumbers are of the form $k' = j+l$, where $j, l \\in \\{-N, \\dots, N\\}$. The range of these wavenumbers is from $(-N)+(-N)=-2N$ to $N+N=2N$. Thus, $u^2(x)$ is a trigonometric polynomial in the space $\\mathcal{T}_{2N}$, having non-zero Fourier coefficients $\\widehat{(u^2)}_{k'}$ only for $|k'| \\le 2N$.\n\nThe pseudo-spectral method computes the product in physical space using values on a grid of $M$ points. The Fourier coefficients of this pointwise product are obtained via the Discrete Fourier Transform (DFT). The DFT convolution theorem implies that the computed coefficients, let's call them $\\tilde{c}_k$, are subject to aliasing:\n$$\n\\tilde{c}_k = \\sum_{p=-\\infty}^{\\infty} \\widehat{(u^2)}_{k+pM}\n$$\nWe want to compute the $L^2$ projection of $u^2$ onto $\\mathcal{T}_N$, which means we want to find the exact Fourier coefficients $\\widehat{(u^2)}_k$ for the target wavenumbers $|k| \\le N$. To do this without aliasing error, we must have $\\tilde{c}_k = \\widehat{(u^2)}_k$ for all $|k| \\le N$. This requires the summation over $p \\neq 0$ to be zero for this range of $k$:\n$$\n\\sum_{p \\in \\mathbb{Z} \\setminus \\{0\\}} \\widehat{(u^2)}_{k+pM} = 0 \\quad \\text{for } |k| \\le N\n$$\nThis condition will be met if each term in the sum is zero. Since the true coefficients $\\widehat{(u^2)}_{k'}$ are non-zero only for $|k'| \\le 2N$, we must ensure that the aliased indices $k+pM$ fall outside this range for all $|k| \\le N$ and for all non-zero integers $p$.\nThat is, we require $|k+pM| > 2N$ for all $|k| \\le N$ and $p \\in \\mathbb{Z} \\setminus \\{0\\}$.\n\nLet's check the most restrictive cases, which are for $p = \\pm 1$.\n\nCase $p=1$: We need $|k+M| > 2N$ for all $|k| \\le N$. Since $M$ (the number of grid points) must be positive, $k+M$ is minimized when $k$ is minimized, i.e., $k=-N$. The condition becomes:\n$$\n-N + M > 2N \\implies M > 3N\n$$\n\nCase $p=-1$: We need $|k-M| > 2N$ for all $|k| \\le N$. Since $M$ will be significantly larger than $N$, $k-M$ will be negative. The absolute value $|k-M| = M-k$ is minimized when $k$ is maximized ($k=N$). To ensure the condition holds for all $|k| \\le N$, we must check the \"worst\" case, where $|k-M|$ is smallest. This occurs for $k=N$. The condition becomes:\n$$\n|N-M| > 2N \\implies M-N > 2N \\implies M > 3N\n$$\nBoth cases yield the same condition, $M > 3N$. For $|p| \\ge 2$, the constraint on $M$ becomes less strict (e.g., for $p=2$, we'd need $M > (3/2)N$), so $M > 3N$ is the definitive requirement.\n\nThe minimal integer number of grid points $M$ that satisfies $M > 3N$ is $M = 3N+1$.\n\nThe problem defines the initial number of grid points as $M_0 = 2N+1$ and asks for the minimal padding factor $s(N) = M/M_0$. Using our result for the minimal $M$:\n$$\ns(N) = \\frac{3N+1}{2N+1}\n$$\nThis is the well-known \"3/2 rule\" for de-aliasing quadratic nonlinearities, as $s(N) \\to 3/2$ for large $N$.\n\nThe two final expressions are $Q_{\\min}(N)$ and $s(N)$.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\left\\lceil \\frac{3N+1}{2} \\right\\rceil & \\frac{3N+1}{2N+1}\n\\end{pmatrix}\n}\n$$", "id": "3418568"}]}