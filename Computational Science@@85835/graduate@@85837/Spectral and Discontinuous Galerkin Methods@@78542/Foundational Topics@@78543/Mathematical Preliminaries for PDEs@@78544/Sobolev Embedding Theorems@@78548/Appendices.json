{"hands_on_practices": [{"introduction": "Understanding Sobolev embeddings begins with grasping the direct link between a function's differentiability in an average sense and its pointwise continuity. This practice guides you through a foundational proof for the one-dimensional embedding of $H^1$ into the space of Hölder continuous functions. By deriving the sharp constant from first principles [@problem_id:3414907], you will gain a concrete appreciation for how a function's total squared gradient controls its local oscillations.", "problem": "Let $\\Omega = (0,1)$ and consider the Sobolev space $H^{1}(\\Omega)$ and the Hölder space $C^{0,\\alpha}(\\Omega)$ with exponent $\\alpha \\in (0,1)$. For a function $f \\in C^{0,\\alpha}(\\Omega)$, define the Hölder seminorm\n$$\n[f]_{C^{0,\\alpha}(\\Omega)} := \\sup_{\\substack{x,y \\in \\Omega\\\\ x \\neq y}} \\frac{|f(x) - f(y)|}{|x-y|^{\\alpha}}.\n$$\nIn the context of spectral methods and Discontinuous Galerkin (DG) methods, sharp embedding constants control pointwise oscillation in terms of square-integrable gradients and directly influence a priori error estimates. Assume only the fundamental properties of functions in $H^{1}(\\Omega)$, the Fundamental Theorem of Calculus, and classical inequalities. Using integral representations valid for $H^{1}(\\Omega)$ functions and first principles reasoning, determine the smallest constant $C_{\\ast}$ such that the inequality\n$$\n[f]_{C^{0,1/2}(\\Omega)} \\leq C_{\\ast} \\,\\|f'\\|_{L^{2}(\\Omega)}\n$$\nholds for all $f \\in H^{1}(\\Omega)$. Then, briefly compare your explicit one-dimensional constant with the scaling predicted by the general $n$-dimensional Morrey-type estimate for $W^{1,p}(\\Omega)$ with $pn$, specialized to $n=1$, $p=2$, on a unit interval, but report only the value of $C_{\\ast}$ as your final answer. No rounding is required, and no physical units are involved. Provide the exact value of $C_{\\ast}$.", "solution": "The problem requires finding the smallest constant $C_{\\ast}$, known as the sharp constant, for the embedding of the Sobolev space $H^{1}(\\Omega)$ into the Hölder space $C^{0,1/2}(\\Omega)$ on the domain $\\Omega = (0,1)$. The inequality in question is:\n$$\n[f]_{C^{0,1/2}(\\Omega)} \\leq C_{\\ast} \\,\\|f'\\|_{L^{2}(\\Omega)}\n$$\nfor all functions $f \\in H^{1}(\\Omega)$, where $f'$ denotes the weak derivative of $f$. The Hölder seminorm is defined as:\n$$\n[f]_{C^{0,1/2}(\\Omega)} := \\sup_{\\substack{x,y \\in \\Omega\\\\ x \\neq y}} \\frac{|f(x) - f(y)|}{|x-y|^{1/2}}\n$$\nand the norm in $L^{2}(\\Omega)$ is $\\|f'\\|_{L^{2}(\\Omega)} = \\left(\\int_{0}^{1} |f'(t)|^2 \\, dt\\right)^{1/2}$.\n\nThe sharp constant $C_{\\ast}$ is the supremum of the ratio of the left-hand side to the right-hand side over all admissible functions:\n$$\nC_{\\ast} = \\sup_{f \\in H^{1}(\\Omega), f' \\not\\equiv 0} \\frac{[f]_{C^{0,1/2}(\\Omega)}}{\\|f'\\|_{L^{2}(\\Omega)}}\n$$\nWe will determine $C_{\\ast}$ in two steps: first, by finding an upper bound for the constant, and second, by showing this bound is attained or can be approached arbitrarily closely.\n\nStep 1: Deriving an upper bound for $C_{\\ast}$.\n\nLet $f \\in H^{1}(\\Omega)$. Functions in $H^{1}$ on a one-dimensional interval are absolutely continuous. Therefore, for any two points $x, y \\in \\Omega$, we can use the Fundamental Theorem of Calculus to write:\n$$\nf(x) - f(y) = \\int_{y}^{x} f'(t) \\, dt\n$$\nWithout loss of generality, let $x  y$. Taking the absolute value, we have:\n$$\n|f(x) - f(y)| = \\left| \\int_{y}^{x} f'(t) \\, dt \\right| = \\left| \\int_{y}^{x} 1 \\cdot f'(t) \\, dt \\right|\n$$\nWe apply the Cauchy-Schwarz inequality for integrals to the expression on the right-hand side:\n$$\n\\left| \\int_{y}^{x} 1 \\cdot f'(t) \\, dt \\right| \\leq \\left( \\int_{y}^{x} 1^2 \\, dt \\right)^{1/2} \\left( \\int_{y}^{x} |f'(t)|^2 \\, dt \\right)^{1/2}\n$$\nThis simplifies to:\n$$\n|f(x) - f(y)| \\leq (x-y)^{1/2} \\left( \\int_{y}^{x} |f'(t)|^2 \\, dt \\right)^{1/2}\n$$\nDividing by $|x-y|^{1/2} = (x-y)^{1/2}$ (since $x \\neq y$), we obtain:\n$$\n\\frac{|f(x) - f(y)|}{|x-y|^{1/2}} \\leq \\left( \\int_{y}^{x} |f'(t)|^2 \\, dt \\right)^{1/2}\n$$\nThe integral over the subinterval $[y, x]$ is bounded by the integral over the entire domain $\\Omega = (0,1)$:\n$$\n\\left( \\int_{y}^{x} |f'(t)|^2 \\, dt \\right)^{1/2} \\leq \\left( \\int_{0}^{1} |f'(t)|^2 \\, dt \\right)^{1/2} = \\|f'\\|_{L^{2}(\\Omega)}\n$$\nCombining these inequalities, we have for any pair $x, y \\in \\Omega$ with $x \\neq y$:\n$$\n\\frac{|f(x) - f(y)|}{|x-y|^{1/2}} \\leq \\|f'\\|_{L^{2}(\\Omega)}\n$$\nSince this holds for all such pairs, we can take the supremum over all $x, y \\in \\Omega$ with $x \\neq y$:\n$$\n\\sup_{\\substack{x,y \\in \\Omega\\\\ x \\neq y}} \\frac{|f(x) - f(y)|}{|x-y|^{1/2}} \\leq \\|f'\\|_{L^{2}(\\Omega)}\n$$\nThis is equivalent to $[f]_{C^{0,1/2}(\\Omega)} \\leq 1 \\cdot \\|f'\\|_{L^{2}(\\Omega)}$. This inequality demonstrates that the constant $C_{\\ast}$ must be less than or equal to $1$, i.e., $C_{\\ast} \\leq 1$.\n\nStep 2: Showing the bound is sharp.\n\nTo prove that $C_{\\ast} = 1$, we must show that $C_{\\ast} \\ge 1$. We can do this by constructing a sequence of functions $f_k \\in H^1(\\Omega)$ for which the ratio $\\frac{[f_k]_{C^{0,1/2}(\\Omega)}}{\\|f_k'\\|_{L^2(\\Omega)}}$ approaches $1$, or by finding a single function for which the ratio is exactly $1$.\n\nLet's choose an arbitrary subinterval $(a,b) \\subset \\Omega = (0,1)$, with $0  a  b  1$. Consider a function $f \\in H^{1}(\\Omega)$ whose weak derivative $f'(t)$ is the characteristic function of this interval:\n$$\nf'(t) = \\chi_{(a,b)}(t) = \\begin{cases} 1  \\text{if } t \\in (a,b) \\\\ 0  \\text{otherwise} \\end{cases}\n$$\nThe function $f'$ is in $L^{2}(\\Omega)$. An antiderivative is $f(x) = \\int_0^x f'(t)\\,dt$, which is a continuous, piecewise linear function, and thus is in $H^1(\\Omega)$.\n\nLet's compute the $L^{2}$-norm of $f'$:\n$$\n\\|f'\\|_{L^{2}(\\Omega)}^2 = \\int_{0}^{1} |f'(t)|^2 \\, dt = \\int_{a}^{b} 1^2 \\, dt = b-a\n$$\nTherefore, $\\|f'\\|_{L^{2}(\\Omega)} = \\sqrt{b-a}$.\n\nNow, let's compute the Hölder seminorm $[f]_{C^{0,1/2}(\\Omega)}$. For any $x, y \\in \\Omega$ with $xy$:\n$$\n\\frac{|f(x)-f(y)|}{|x-y|^{1/2}} = \\frac{|\\int_y^x f'(t)\\,dt|}{|x-y|^{1/2}} = \\frac{\\int_y^x \\chi_{(a,b)}(t)\\,dt}{\\sqrt{x-y}} = \\frac{\\text{length}((y,x) \\cap (a,b))}{\\sqrt{x-y}}\n$$\nFrom Step 1, we know this quantity is bounded by $(\\int_y^x |f'(t)|^2 dt)^{1/2} = \\sqrt{\\text{length}((y,x) \\cap (a,b))}$. Let $L_{int} = \\text{length}((y,x))$ and $L_{cap} = \\text{length}((y,x) \\cap (a,b))$. The quantity is $L_{cap}/\\sqrt{L_{int}}$.\n\nLet's evaluate this for the specific choice of $x=b$ and $y=a$. We have:\n$$\n\\frac{|f(b)-f(a)|}{|b-a|^{1/2}} = \\frac{\\int_a^b 1 \\, dt}{\\sqrt{b-a}} = \\frac{b-a}{\\sqrt{b-a}} = \\sqrt{b-a}\n$$\nTo find the seminorm, we need the supremum over all pairs. Let's analyze the function $g(x,y) = \\frac{\\text{length}((y,x) \\cap (a,b))}{\\sqrt{x-y}}$.\nIf we choose the interval $(y,x)$ to be exactly $(a,b)$, we've shown the value is $\\sqrt{b-a}$.\nIf we choose an interval $(y,x)$ that is a subset of $(a,b)$, then $\\text{length}((y,x) \\cap (a,b)) = x-y$. The value is $\\frac{x-y}{\\sqrt{x-y}} = \\sqrt{x-y}$, which is maximized when $x-y$ is as large as possible, i.e., $x-y \\to b-a$.\nIf we choose an interval $(y,x)$ that contains $(a,b)$, then $\\text{length}((y,x) \\cap (a,b)) = b-a$. The value is $\\frac{b-a}{\\sqrt{x-y}}$. This is maximized when $x-y$ is minimized, i.e., when $(y,x)$ is just $(a,b)$, making the value $\\frac{b-a}{\\sqrt{b-a}} = \\sqrt{b-a}$.\nA more formal argument confirms that the supremum is indeed $\\sqrt{b-a}$.\nSo, for this function $f$, we have $[f]_{C^{0,1/2}(\\Omega)} = \\sqrt{b-a}$.\n\nNow we can compute the ratio for this specific function:\n$$\n\\frac{[f]_{C^{0,1/2}(\\Omega)}}{\\|f'\\|_{L^{2}(\\Omega)}} = \\frac{\\sqrt{b-a}}{\\sqrt{b-a}} = 1\n$$\nSince we have found a non-trivial function $f \\in H^{1}(\\Omega)$ for which the ratio is exactly $1$, the supremum over all such functions must be at least $1$. Thus, $C_{\\ast} \\ge 1$.\n\nCombining our two findings, $C_{\\ast} \\leq 1$ and $C_{\\ast} \\ge 1$, we conclude that the sharp constant is exactly $1$.\n\nThe problem also asks for a brief comparison with the general $n$-dimensional Morrey-type estimate for $W^{1,p}(\\Omega)$, specialized to our case. For $W^{1,p}(\\Omega)$ with $pn$, the embedding is into $C^{0,\\alpha}(\\overline{\\Omega})$ with $\\alpha = 1 - n/p$. For our problem, the space is $H^1(\\Omega) = W^{1,2}(\\Omega)$ and the domain is one-dimensional, so $n=1$ and $p=2$. The condition $pn$ is satisfied as $2  1$. The predicted Hölder exponent is $\\alpha = 1 - 1/2 = 1/2$, which matches the problem statement. The direct derivation using the Fundamental Theorem of Calculus and the Cauchy-Schwarz inequality, as performed in Step 1, is the standard method for proving the one-dimensional case of Morrey's inequality. This method directly yields the constant $C=1$. Our finding in Step 2 that this constant is sharp demonstrates that, for this specific case ($n=1, p=2, \\Omega=(0,1)$), the simplest proof technique for the general theorem happens to yield the optimal constant.\n\nThe final answer required is the value of $C_\\ast$.", "answer": "$$\\boxed{1}$$", "id": "3414907"}, {"introduction": "Sobolev embeddings are a cornerstone in the analysis of spectral methods, providing the essential tool to control the pointwise maximum of a function by its Sobolev norm. This hands-on coding exercise [@problem_id:3414954] allows you to numerically explore the embedding $H^s(\\mathbb{T}^n) \\hookrightarrow L^\\infty(\\mathbb{T}^n)$ for functions defined by finite Fourier series. You will implement the computation of norms and verify the embedding constant, gaining practical insight into why smoothness, specifically $s \\gt n/2$, is critical for boundedness.", "problem": "Consider the periodic torus $\\mathbb{T}^n$ identified with the cube $[0,2\\pi]^n$ with periodic boundary conditions and angles measured in radians. Let $u_N:\\mathbb{T}^n\\to\\mathbb{C}$ be a spectral approximation represented by a finite Fourier series\n$$\nu_N(x)=\\sum_{k\\in I\\subset\\mathbb{Z}^n}\\hat{u}_k\\,e^{i\\,k\\cdot x},\n$$\nwhere $I$ is a finite index set of multi-indices $k=(k_1,\\dots,k_n)\\in\\mathbb{Z}^n$, $x=(x_1,\\dots,x_n)\\in\\mathbb{T}^n$, and the coefficients $\\hat{u}_k\\in\\mathbb{C}$ are the normalized Fourier coefficients associated with the exponential basis $e^{i\\,k\\cdot x}$. In the context of spectral and discontinuous Galerkin (DG) methods, bounds in the uniform (essential supremum) norm are used to control nonlinear fluxes and aliasing, and the Sobolev embedding theorem supplies the necessary estimates when $s\\tfrac{n}{2}$.\n\nFrom first principles, use the definition of the Sobolev space $H^s(\\mathbb{T}^n)$ and the Cauchy–Schwarz inequality to connect the $H^s$ norm of $u_N$ to a uniform (essential supremum) bound. Specifically:\n\n- The Sobolev norm $\\|u_N\\|_{H^s(\\mathbb{T}^n)}$ is defined via the Fourier coefficients $\\hat{u}_k$.\n- The uniform bound $\\|u_N\\|_{L^\\infty(\\mathbb{T}^n)}$ must be obtained numerically by evaluating $u_N$ on a uniform grid over $\\mathbb{T}^n$ and taking the maximum absolute value. The grid resolution must be high enough to capture the supremum; for one spatial dimension use $M=4096$ grid points per dimension and for two spatial dimensions use $M=512$ grid points per dimension.\n- An embedding-based bound is obtained by applying the Cauchy–Schwarz inequality with a weight $(1+|k|^2)^{s}$, where $|k|$ denotes the Euclidean norm in $\\mathbb{R}^n$. This yields a bound with a constant that can be approximated by truncating the full index lattice to $|k_i|\\leq K_{\\max}$ for each component $i\\in\\{1,\\dots,n\\}$.\n\nYour task is to (i) compute $\\|u_N\\|_{H^s(\\mathbb{T}^n)}$ from the given finite set of Fourier coefficients, (ii) compute a numerical approximation of $\\|u_N\\|_{L^\\infty(\\mathbb{T}^n)}$ by sampling on a uniform grid, (iii) compute an embedding-based bound $\\|u_N\\|_{L^\\infty(\\mathbb{T}^n)}\\leq C_{s,n}(K_{\\max})\\|u_N\\|_{H^s(\\mathbb{T}^n)}$ where\n$$\nC_{s,n}(K_{\\max})=\\left(\\sum_{k\\in\\mathbb{Z}^n,\\;|k_i|\\leq K_{\\max}}\\frac{1}{(1+|k|^2)^s}\\right)^{1/2},\n$$\nand (iv) verify the inequality numerically for each test case. Additionally, compute the exact index-set bound using only the finite index set $I$,\n$$\nC_{s,n}(I)=\\left(\\sum_{k\\in I}\\frac{1}{(1+|k|^2)^s}\\right)^{1/2},\n$$\nand verify $\\|u_N\\|_{L^\\infty(\\mathbb{T}^n)}\\leq C_{s,n}(I)\\|u_N\\|_{H^s(\\mathbb{T}^n)}$.\n\nAdopt the following fundamental base:\n- The Fourier representation on $\\mathbb{T}^n$, the normalized Fourier coefficients, and the Euclidean norm $|k|$.\n- The definition of Sobolev spaces via Fourier coefficients on $\\mathbb{T}^n$, namely $H^s(\\mathbb{T}^n)$ defined by square-summability of $(1+|k|^2)^s|\\hat{u}_k|^2$.\n- The Cauchy–Schwarz inequality in $\\ell^2$ applied to sequences indexed by $k\\in\\mathbb{Z}^n$.\n\nYou must implement a program that, for each test case, outputs:\n- The Sobolev norm $\\|u_N\\|_{H^s(\\mathbb{T}^n)}$ as a floating-point number.\n- The numerically computed uniform norm $\\|u_N\\|_{L^\\infty(\\mathbb{T}^n)}$ as a floating-point number.\n- The truncated-lattice embedding bound $B_{\\text{trunc}}=C_{s,n}(K_{\\max})\\,\\|u_N\\|_{H^s(\\mathbb{T}^n)}$ as a floating-point number.\n- A boolean indicating whether $\\|u_N\\|_{L^\\infty(\\mathbb{T}^n)}\\leq B_{\\text{trunc}}$ holds numerically.\n- The finite-index-set bound $B_{I}=C_{s,n}(I)\\,\\|u_N\\|_{H^s(\\mathbb{T}^n)}$ as a floating-point number.\n- A boolean indicating whether $\\|u_N\\|_{L^\\infty(\\mathbb{T}^n)}\\leq B_{I}$ holds numerically.\n\nUse the following test suite of parameter values, which covers cases $s\\tfrac{n}{2}$, the boundary $s=\\tfrac{n}{2}$, and $s\\tfrac{n}{2}$, and both one and two dimensions:\n- Test case $1$: $n=1$, $s=1.0$, $K_{\\max}=64$, index set $I=\\{k\\in\\mathbb{Z}:k\\in\\{-2,-1,1,2\\}\\}$ with coefficients $\\hat{u}_{-2}=\\hat{u}_{2}=0.25$, $\\hat{u}_{-1}=\\hat{u}_{1}=0.5$.\n- Test case $2$: $n=2$, $s=1.2$, $K_{\\max}=32$, index set $I=\\{(-2,0),(-1,0),(0,-1),(0,1),(1,0),(1,1),(-1,-1),(2,0)\\}$ with coefficients $\\hat{u}_{-2,0}=\\hat{u}_{2,0}=0.05$, $\\hat{u}_{-1,0}=\\hat{u}_{1,0}=0.3$, $\\hat{u}_{0,-1}=\\hat{u}_{0,1}=0.2$, $\\hat{u}_{1,1}=\\hat{u}_{-1,-1}=0.1$.\n- Test case $3$: $n=1$, $s=0.5$, $K_{\\max}=64$, index set $I=\\{(-10),(-3),(-1),(1),(3),(10)\\}$ with coefficients $\\hat{u}_{-10}=\\hat{u}_{10}=0.02$, $\\hat{u}_{-3}=\\hat{u}_{3}=0.1$, $\\hat{u}_{-1}=\\hat{u}_{1}=0.7$.\n- Test case $4$: $n=2$, $s=0.4$, $K_{\\max}=32$, index set $I=\\{(-5,0),(-1,-2),(0,-5),(0,5),(1,2),(5,0)\\}$ with coefficients $\\hat{u}_{-5,0}=\\hat{u}_{5,0}=0.05$, $\\hat{u}_{0,-5}=\\hat{u}_{0,5}=0.05$, $\\hat{u}_{1,2}=\\hat{u}_{-1,-2}=0.03$.\n\nFor each case, the program must:\n- Compute $\\|u_N\\|_{H^s(\\mathbb{T}^n)}=\\left(\\sum_{k\\in I}(1+|k|^2)^s\\,|\\hat{u}_k|^2\\right)^{1/2}$.\n- Compute $\\|u_N\\|_{L^\\infty(\\mathbb{T}^n)}$ by sampling $u_N$ on a uniform grid with $M$ points per dimension (use $M=4096$ for $n=1$ and $M=512$ for $n=2$) and taking the maximum of $|u_N(x)|$ over the grid.\n- Compute $C_{s,n}(K_{\\max})$ by summing over the truncated lattice $\\{k\\in\\mathbb{Z}^n:\\ |k_i|\\leq K_{\\max}\\}$.\n- Compute $C_{s,n}(I)$ by summing only over the given index set $I$.\n\nYour program should produce a single line of output containing the results as a comma-separated list of lists enclosed in square brackets (for example, $[\\,[r_{11},r_{12},\\dots],\\,[r_{21},r_{22},\\dots]\\,]$), where each inner list corresponds to one test case and contains exactly six entries in the following order: $\\|u_N\\|_{H^s}$ (float), $\\|u_N\\|_{L^\\infty}$ (float), $B_{\\text{trunc}}$ (float), inequality-holds with $B_{\\text{trunc}}$ (boolean), $B_{I}$ (float), inequality-holds with $B_{I}$ (boolean).", "solution": "The problem requires a numerical investigation of the Sobolev embedding theorem for finite Fourier series on the $n$-dimensional torus, $\\mathbb{T}^n$. We are given a function $u_N(x)$ defined by its truncated Fourier series:\n$$\nu_N(x) = \\sum_{k \\in I \\subset \\mathbb{Z}^n} \\hat{u}_k \\, e^{i k \\cdot x}\n$$\nwhere $I$ is a finite set of integer multi-indices, and $\\hat{u}_k$ are the corresponding complex Fourier coefficients. The goal is to compute several quantities related to the Sobolev embedding $H^s(\\mathbb{T}^n) \\hookrightarrow L^\\infty(\\mathbb{T}^n)$ and numerically verify the associated inequalities.\n\nThe core of the task relies on the definitions of the Sobolev $H^s$ norm and the uniform $L^\\infty$ norm, and the application of the Cauchy-Schwarz inequality.\n\n**1. Norm Definitions**\n\nThe Sobolev space $H^s(\\mathbb{T}^n)$ for a real number $s$ consists of functions on the torus whose derivatives up to order $s$ are square-integrable. For a function $u(x) = \\sum_{k \\in \\mathbb{Z}^n} \\hat{u}_k e^{i k \\cdot x}$, the $H^s$ norm is defined via its Fourier coefficients as:\n$$\n\\|u\\|_{H^s(\\mathbb{T}^n)}^2 = \\sum_{k \\in \\mathbb{Z}^n} (1 + |k|^2)^s |\\hat{u}_k|^2\n$$\nwhere $|k| = \\sqrt{k_1^2 + \\dots + k_n^2}$ is the Euclidean norm of the multi-index $k$. This definition weights higher-frequency modes (large $|k|$) more heavily, capturing the function's smoothness. For our finite Fourier series $u_N(x)$, the sum is restricted to the finite index set $I$:\n$$\n\\|u_N\\|_{H^s(\\mathbb{T}^n)} = \\left(\\sum_{k \\in I} (1 + |k|^2)^s |\\hat{u}_k|^2\\right)^{1/2}\n$$\n\nThe uniform norm, or $L^\\infty$ norm, measures the function's maximum magnitude:\n$$\n\\|u_N\\|_{L^\\infty(\\mathbb{T}^n)} = \\sup_{x \\in \\mathbb{T}^n} |u_N(x)|\n$$\nNumerically, this value is approximated by evaluating $|u_N(x)|$ on a fine, uniform grid of $M^n$ points on the torus $\\mathbb{T}^n \\cong [0, 2\\pi]^n$ and finding the maximum value.\n\n**2. Sobolev Embedding and the Cauchy-Schwarz Inequality**\n\nThe Sobolev embedding theorem states that for $s  n/2$, the space $H^s(\\mathbb{T}^n)$ is continuously embedded in the space of continuous functions, which implies the existence of a constant $C$ such that $\\|u\\|_{L^\\infty} \\leq C \\|u\\|_{H^s}$ for all $u \\in H^s(\\mathbb{T}^n)$. We can derive a specific instance of this inequality for our function $u_N$ directly from the Cauchy-Schwarz inequality.\n\nConsider the expression for $u_N(x)$. We can rewrite the sum as:\n$$\nu_N(x) = \\sum_{k \\in I} \\left( (1+|k|^2)^{s/2} \\hat{u}_k \\right) \\cdot \\left( \\frac{e^{i k \\cdot x}}{(1+|k|^2)^{s/2}} \\right)\n$$\nApplying the Cauchy-Schwarz inequality to this sum (viewed as an inner product in the sequence space $\\ell^2(I)$) gives:\n$$\n|u_N(x)|^2 \\leq \\left( \\sum_{k \\in I} \\left| (1+|k|^2)^{s/2} \\hat{u}_k \\right|^2 \\right) \\cdot \\left( \\sum_{k \\in I} \\left| \\frac{e^{i k \\cdot x}}{(1+|k|^2)^{s/2}} \\right|^2 \\right)\n$$\nRecognizing the terms, we simplify this to:\n$$\n|u_N(x)|^2 \\leq \\left( \\sum_{k \\in I} (1+|k|^2)^s |\\hat{u}_k|^2 \\right) \\cdot \\left( \\sum_{k \\in I} \\frac{1}{(1+|k|^2)^s} \\right)\n$$\nThe first term on the right is exactly $\\|u_N\\|_{H^s(\\mathbb{T}^n)}^2$. Since the right-hand side is independent of $x$, this inequality holds for the supremum of the left-hand side over all $x$. Taking the square root of both sides, we obtain:\n$$\n\\|u_N\\|_{L^\\infty(\\mathbb{T}^n)} \\leq C_{s,n}(I) \\, \\|u_N\\|_{H^s(\\mathbb{T}^n)}\n$$\nwhere the constant $C_{s,n}(I)$ is given by:\n$$\nC_{s,n}(I) = \\left( \\sum_{k \\in I} \\frac{1}{(1+|k|^2)^s} \\right)^{1/2}\n$$\nThis inequality is an algebraic consequence of the definitions and must hold for any finite Fourier series $u_N$. This gives the bound $B_I = C_{s,n}(I) \\|u_N\\|_{H^s(\\mathbb{T}^n)}$.\n\nThe problem also introduces a second constant, $C_{s,n}(K_{\\max})$, calculated by summing over a larger, regular lattice of modes:\n$$\nC_{s,n}(K_{\\max}) = \\left(\\sum_{k \\in \\mathbb{Z}^n, \\, |k_i| \\leq K_{\\max}} \\frac{1}{(1+|k|^2)^s} \\right)^{1/2}\n$$\nThis constant approximates the true embedding constant $C_{s,n}(\\infty)$, whose defining series converges only if $2s  n$, i.e., $s  n/2$. Since the index set $I$ for each test case is a subset of the lattice defined by $K_{\\max}$, it follows that $C_{s,n}(I) \\leq C_{s,n}(K_{\\max})$. Consequently, the bound $B_{\\text{trunc}} = C_{s,n}(K_{\\max}) \\|u_N\\|_{H^s(\\mathbb{T}^n)}$ is looser than $B_I$ but must also hold.\n\n**3. Computational Procedure**\n\nFor each test case, we perform the following calculations:\n1.  **Compute $\\|u_N\\|_{H^s}$**: Directly evaluate the sum $\\left(\\sum_{k \\in I} (1+|k|^2)^s |\\hat{u}_k|^2\\right)^{1/2}$ using the provided index set $I$ and coefficients $\\hat{u}_k$.\n2.  **Compute $\\|u_N\\|_{L^\\infty}$**: Construct a uniform grid on $[0, 2\\pi]^n$ with $M$ points per dimension ($M=4096$ for $n=1$, $M=512$ for $n=2$). Evaluate the complex-valued function $u_N(x)$ at each grid point. A vectorized computation is used for efficiency, where for each mode $k \\in I$, the term $\\hat{u}_k e^{i k \\cdot x}$ is computed for all grid points $x$ simultaneously. The results are summed over all modes. The $L^\\infty$ norm is then approximated by the maximum absolute value, $\\max_x |u_N(x)|$, over the grid.\n3.  **Compute $C_{s,n}(K_{\\max})$ and $B_{\\text{trunc}}$**: Generate all integer vectors $k \\in \\mathbb{Z}^n$ such that $|k_i| \\leq K_{\\max}$ for all components $i=1,\\dots,n$. Compute the sum defining $C_{s,n}(K_{\\max})^2$, take the square root, and multiply by $\\|u_N\\|_{H^s}$ to get $B_{\\text{trunc}}$.\n4.  **Compute $C_{s,n}(I)$ and $B_I$**: Compute the sum defining $C_{s,n}(I)^2$ over the given sparse index set $I$, take the square root, and multiply by $\\|u_N\\|_{H^s}$ to get $B_I$.\n5.  **Verify Inequalities**: Check if the numerically computed $\\|u_N\\|_{L^\\infty}$ is less than or equal to the computed bounds $B_{\\text{trunc}}$ and $B_I$.\n\nThe test cases are chosen to explore scenarios where the embedding theorem holds ($s  n/2$, cases 1 and 2), is at the critical boundary ($s=n/2$, case 3), and fails ($s  n/2$, case 4). For all cases, because $u_N$ has a finite number of modes, it is infinitely differentiable and thus bounded. The derived algebraic inequalities involving $C_{s,n}(I)$ and $C_{s,n}(K_{\\max})$ are expected to hold regardless of the values of $s$ and $n$.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes Sobolev and uniform norms for finite Fourier series on the torus\n    and verifies the Sobolev embedding inequality numerically.\n    \"\"\"\n    test_cases = [\n        {\n            \"n\": 1, \"s\": 1.0, \"K_max\": 64, \"M\": 4096,\n            \"coeffs\": {(-2,): 0.25, (-1,): 0.5, (1,): 0.5, (2,): 0.25}\n        },\n        {\n            \"n\": 2, \"s\": 1.2, \"K_max\": 32, \"M\": 512,\n            \"coeffs\": {\n                (-2, 0): 0.05, (-1, 0): 0.3, (0, -1): 0.2, (0, 1): 0.2,\n                (1, 0): 0.3, (1, 1): 0.1, (-1, -1): 0.1, (2, 0): 0.05\n            }\n        },\n        {\n            \"n\": 1, \"s\": 0.5, \"K_max\": 64, \"M\": 4096,\n            \"coeffs\": {\n                (-10,): 0.02, (-3,): 0.1, (-1,): 0.7,\n                (1,): 0.7, (3,): 0.1, (10,): 0.02\n            }\n        },\n        {\n            \"n\": 2, \"s\": 0.4, \"K_max\": 32, \"M\": 512,\n            \"coeffs\": {\n                (-5, 0): 0.05, (-1, -2): 0.03, (0, -5): 0.05,\n                (0, 5): 0.05, (1, 2): 0.03, (5, 0): 0.05\n            }\n        },\n    ]\n\n    results = []\n\n    for case in test_cases:\n        n, s, K_max, M, coeffs = case['n'], case['s'], case['K_max'], case['M'], case['coeffs']\n        \n        I = np.array(list(coeffs.keys()))  # Shape (|I|, n)\n        u_hats = np.array(list(coeffs.values()))  # Shape (|I|,)\n\n        # 1. Compute ||u_N||_{H^s}\n        k_norms_sq = np.sum(I**2, axis=1)\n        h_s_norm_sq_terms = (1 + k_norms_sq)**s * np.abs(u_hats)**2\n        h_s_norm = np.sqrt(np.sum(h_s_norm_sq_terms))\n\n        # 2. Compute ||u_N||_{L^infty} numerically\n        grid_coords_1d = [np.linspace(0, 2 * np.pi, M, endpoint=False) for _ in range(n)]\n        \n        # Vectorized evaluation of u_N on the grid\n        if n == 1:\n            pos_vectors = grid_coords_1d[0][:, np.newaxis]  # Shape (M, 1)\n        else:  # n == 2\n            grid_mesh = np.meshgrid(*grid_coords_1d, indexing='ij')\n            pos_vectors = np.stack(grid_mesh, axis=-1)  # Shape (M, M, n)\n            \n        k_dot_x = np.tensordot(I, pos_vectors, axes=([-1], [-1])) # Shape (|I|, M,...)\n        u_hats_reshaped = u_hats.reshape(u_hats.shape + (1,) * n)\n        u_N_grid = np.sum(u_hats_reshaped * np.exp(1j * k_dot_x), axis=0)\n        l_inf_norm = np.max(np.abs(u_N_grid))\n\n        # 3. Compute C_{s,n}(K_max) and the truncated bound B_trunc\n        if n == 1:\n            k_range = np.arange(-K_max, K_max + 1)\n            k_grid = k_range.reshape(-1, 1)\n        else: # n == 2\n            k_range = np.arange(-K_max, K_max + 1)\n            k_mesh = np.meshgrid(k_range, k_range, indexing='ij')\n            k_grid = np.stack(k_mesh, axis=-1).reshape(-1, 2)\n        \n        k_grid_norms_sq = np.sum(k_grid**2, axis=1)\n        c_trunc_sq_sum = np.sum(1.0 / (1 + k_grid_norms_sq)**s)\n        c_trunc = np.sqrt(c_trunc_sq_sum)\n        b_trunc = c_trunc * h_s_norm\n        ineq_trunc_holds = l_inf_norm = b_trunc\n\n        # 4. Compute C_{s,n}(I) and the exact index-set bound B_I\n        c_I_sq_sum = np.sum(1.0 / (1 + k_norms_sq)**s)\n        c_I = np.sqrt(c_I_sq_sum)\n        b_I = c_I * h_s_norm\n        ineq_I_holds = l_inf_norm = b_I\n\n        results.append([\n            float(h_s_norm), float(l_inf_norm),\n            float(b_trunc), bool(ineq_trunc_holds),\n            float(b_I), bool(ineq_I_holds)\n        ])\n\n    # Format the output as a list of lists.\n    output_str_parts = []\n    for res_list in results:\n        res_str = (\n            f\"[{res_list[0]},{res_list[1]},{res_list[2]},\"\n            f\"{str(res_list[3]).lower()},{res_list[4]},{str(res_list[5]).lower()}]\"\n        )\n        output_str_parts.append(res_str)\n        \n    print(f\"[{','.join(output_str_parts)}]\")\n\nsolve()\n```", "id": "3414954"}, {"introduction": "The power of Sobolev theorems lies in their ability to provide uniform bounds, but these bounds often rely on geometric assumptions about the domain or mesh. This practice [@problem_id:3414934] explores a critical limitation of standard isotropic trace inequalities—a type of embedding for boundary values—in the context of Discontinuous Galerkin methods. By analyzing simple functions on a sequence of increasingly anisotropic elements, you will demonstrate from first principles why these standard estimates fail, motivating the need for more advanced anisotropic analysis.", "problem": "Consider a family of discontinuous Galerkin meshes comprised of axis-aligned rectangles. Let a single element be the rectangle $K = [0,h_x] \\times [0,h_y]$, where $h_x  0$ and $h_y  0$ are the side lengths in the $x$ and $y$ directions. Let the trace operator map a function $v \\in H^1(K)$ (Sobolev space of square-integrable functions with square-integrable weak gradient) to its boundary values on $\\partial K$, and consider the standard isotropic trace control that would be used on shape-regular families: for an element size parameter $h := \\max\\{h_x, h_y\\}$, a canonical isotropic bound aims to control the boundary norm by a bulk norm via\n$$\n\\| v \\|_{L^2(\\partial K)}^2 \\leq C \\left( h^{-1} \\| v \\|_{L^2(K)}^2 + h \\| \\nabla v \\|_{L^2(K)}^2 \\right),\n$$\nwith a constant $C$ that is uniform over the mesh sequence. In discontinuous Galerkin interior penalty formulations, the jump term across an interior face $F$ of length $\\ell_F$ for a piecewise function $u$ is penalized by a term of the form\n$$\n\\int_F \\frac{\\sigma}{h_F} [u]^2 \\, ds,\n$$\nwhere $[u]$ is the trace jump, $\\sigma  0$ is a fixed penalty parameter, and $h_F$ is an isotropic face size chosen consistently with $h$ on the adjacent elements, often taken as $h_F = h$. These isotropic controls are known to be stable when the mesh is shape-regular (uniformly bounded aspect ratio), but may fail as anisotropy grows.\n\nYour task is to construct and analyze a mesh sequence with growing anisotropy and demonstrate numerically that isotropic trace-type controls cannot uniformly bound the boundary or jump terms. Proceed from the following fundamental base: the definition of $L^2$ norms on domains and boundaries, the definition of weak gradient norms, and the structure of discontinuous Galerkin interior penalty jump terms. Do not use pre-packaged anisotropic inequalities; derive all expressions from first principles using the exact integrals of simple representative functions.\n\nDefine, for any rectangle $K = [0,h_x] \\times [0,h_y]$ and $h = \\max\\{h_x,h_y\\}$, the ratio\n$$\nR(v; K) := \\frac{\\| v \\|_{L^2(\\partial K)}^2}{h^{-1} \\| v \\|_{L^2(K)}^2 + h \\| \\nabla v \\|_{L^2(K)}^2},\n$$\nfor the three test functions\n- $v(x,y) = 1$,\n- $v(x,y) = x$,\n- $v(x,y) = y$.\nThese functions probe different directional behaviors relative to anisotropy.\n\nAlso define a two-element discontinuous Galerkin configuration comprised of two adjacent rectangles $K^-$ and $K^+$ that share a single vertical interior face $F$ of length $h_y$, with both rectangles equal to $[0,h_x] \\times [0,h_y]$ and $[h_x,2h_x] \\times [0,h_y]$. Consider the piecewise constant function $u$ such that $u|_{K^-} = -1$ and $u|_{K^+} = 1$, the penalty parameter $\\sigma = 1$, and an isotropic face size $h_F = h := \\max\\{h_x,h_y\\}$. Define the isotropic jump-to-bulk control ratio\n$$\nQ(h_x, h_y) := \\frac{\\int_F \\frac{\\sigma}{h_F} [u]^2 \\, ds}{h^{-1} \\left( \\| u \\|_{L^2(K^-)}^2 + \\| u \\|_{L^2(K^+)}^2 \\right) + h \\left( \\| \\nabla u \\|_{L^2(K^-)}^2 + \\| \\nabla u \\|_{L^2(K^+)}^2 \\right)}.\n$$\nThis ratio quantifies the extent to which the isotropic bulk control fails to uniformly bound the jump term as anisotropy grows.\n\nUsing only the definitions of $L^2$ and boundary integrals and the fact that the weak gradients of the given test functions are classical gradients, write a program that computes the ratios $R(v;K)$ and $Q(h_x,h_y)$ exactly for specified element sizes. Your program must evaluate the following test suite that exercises different behaviors:\n\n- Anisotropic sequence with growing aspect ratio, defined by $h_x(n) = 2^{-n}$ and $h_y(n) = 2^{-2n}$, for $n \\in \\{1,3,5\\}$. For each $n$, compute the maximum\n$$\nM(n) := \\max\\left\\{ R(1;K_n), R(x;K_n), R(y;K_n) \\right\\},\n$$\nwhere $K_n = [0,h_x(n)] \\times [0,h_y(n)]$, and also compute\n$$\nQ(n) := Q\\left(h_x(n), h_y(n)\\right).\n$$\n\n- A shape-regular (isotropic) comparison case with $h_x = h_y = 2^{-3}$. Compute\n$$\nM_{\\mathrm{iso}} := \\max\\left\\{ R(1;K_{\\mathrm{iso}}), R(x;K_{\\mathrm{iso}}), R(y;K_{\\mathrm{iso}}) \\right\\},\n$$\nwhere $K_{\\mathrm{iso}} = [0,2^{-3}] \\times [0,2^{-3}]$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets: specifically,\n$$\n\\left[ M(1), M(3), M(5), M_{\\mathrm{iso}}, Q(1), Q(3), Q(5) \\right].\n$$\nAll outputs must be real numbers (floats). No physical units are involved. Angles are not present. Express all quantities as dimensionless floats. Ensure your program is self-contained, requires no input, and uses only the libraries specified in the execution environment.", "solution": "The problem is valid. It is a well-posed and scientifically grounded exercise in the analysis of numerical methods, specifically demonstrating the failure of isotropic trace inequalities on anisotropic meshes from first principles.\n\nThe task is to compute two ratios, $R(v;K)$ and $Q(h_x, h_y)$, for a series of rectangular elements with growing anisotropy, and for a shape-regular comparison case. We will derive the analytical expressions for these ratios by computing the required integrals from their definitions.\n\nLet the rectangular element be $K = [0, h_x] \\times [0, h_y]$, with $h_x  0$ and $h_y  0$. The isotropic size parameter is $h := \\max\\{h_x, h_y\\}$. The ratio $R(v;K)$ is defined as:\n$$\nR(v; K) := \\frac{\\| v \\|_{L^2(\\partial K)}^2}{h^{-1} \\| v \\|_{L^2(K)}^2 + h \\| \\nabla v \\|_{L^2(K)}^2}\n$$\nThe norms are defined as:\n- $\\| v \\|_{L^2(K)}^2 = \\int_K v^2 \\, dA = \\int_0^{h_y} \\int_0^{h_x} v(x,y)^2 \\, dx \\, dy$\n- $\\| \\nabla v \\|_{L^2(K)}^2 = \\int_K |\\nabla v|^2 \\, dA = \\int_0^{h_y} \\int_0^{h_x} \\left( (\\partial_x v)^2 + (\\partial_y v)^2 \\right) \\, dx \\, dy$\n- $\\| v \\|_{L^2(\\partial K)}^2 = \\int_{\\partial K} v^2 \\, ds$, which is the sum of integrals over the four sides of the rectangle.\n\nWe evaluate these terms for the three specified test functions.\n\n**Case 1: $v(x,y) = 1$**\n\nThe gradient is $\\nabla v = (0, 0)$.\nThe squared $L^2(K)$ norm is:\n$$\n\\| v \\|_{L^2(K)}^2 = \\int_0^{h_y} \\int_0^{h_x} 1^2 \\, dx \\, dy = h_x h_y\n$$\nThe squared $L^2(K)$ norm of the gradient is:\n$$\n\\| \\nabla v \\|_{L^2(K)}^2 = \\int_0^{h_y} \\int_0^{h_x} (0^2 + 0^2) \\, dx \\, dy = 0\n$$\nThe squared $L^2(\\partial K)$ norm is the integral of $1^2$ over the boundary, which is the perimeter of the rectangle:\n$$\n\\| v \\|_{L^2(\\partial K)}^2 = \\int_{\\partial K} 1^2 \\, ds = 2(h_x + h_y)\n$$\nSubstituting these into the definition of $R$:\n$$\nR(1; K) = \\frac{2(h_x + h_y)}{h^{-1} (h_x h_y) + h (0)} = \\frac{2h(h_x + h_y)}{h_x h_y} = 2h \\left( \\frac{1}{h_y} + \\frac{1}{h_x} \\right)\n$$\n\n**Case 2: $v(x,y) = x$**\n\nThe gradient is $\\nabla v = (1, 0)$.\nThe squared $L^2(K)$ norm is:\n$$\n\\| v \\|_{L^2(K)}^2 = \\int_0^{h_y} \\int_0^{h_x} x^2 \\, dx \\, dy = h_y \\left[ \\frac{x^3}{3} \\right]_0^{h_x} = \\frac{h_x^3 h_y}{3}\n$$\nThe squared $L^2(K)$ norm of the gradient is:\n$$\n\\| \\nabla v \\|_{L^2(K)}^2 = \\int_0^{h_y} \\int_0^{h_x} (1^2 + 0^2) \\, dx \\, dy = h_x h_y\n$$\nThe squared $L^2(\\partial K)$ norm is the sum of integrals over the four sides:\n- Bottom edge ($y=0$, $x \\in [0, h_x]$): $\\int_0^{h_x} x^2 \\, dx = \\frac{h_x^3}{3}$\n- Top edge ($y=h_y$, $x \\in [0, h_x]$): $\\int_0^{h_x} x^2 \\, dx = \\frac{h_x^3}{3}$\n- Left edge ($x=0$, $y \\in [0, h_y]$): $\\int_0^{h_y} 0^2 \\, dy = 0$\n- Right edge ($x=h_x$, $y \\in [0, h_y]$): $\\int_0^{h_y} h_x^2 \\, dy = h_x^2 h_y$\nThe sum is $\\| v \\|_{L^2(\\partial K)}^2 = \\frac{2h_x^3}{3} + h_x^2 h_y$.\nSubstituting these into the definition of $R$:\n$$\nR(x; K) = \\frac{\\frac{2h_x^3}{3} + h_x^2 h_y}{h^{-1} \\left(\\frac{h_x^3 h_y}{3}\\right) + h (h_x h_y)} = \\frac{h_x^2(\\frac{2h_x}{3} + h_y)}{h_x h_y (\\frac{h^{-1} h_x^2}{3} + h)} = \\frac{h_x (\\frac{2h_x}{3} + h_y)}{h_y (\\frac{h^{-1} h_x^2}{3} + h)}\n$$\n\n**Case 3: $v(x,y) = y$**\n\nBy symmetry with the case $v(x,y)=x$, we can swap $h_x$ and $h_y$. The gradient is $\\nabla v = (0, 1)$.\n- $\\| v \\|_{L^2(K)}^2 = \\frac{h_x h_y^3}{3}$\n- $\\| \\nabla v \\|_{L^2(K)}^2 = h_x h_y$\n- $\\| v \\|_{L^2(\\partial K)}^2 = h_x h_y^2 + \\frac{2h_y^3}{3}$\nSubstituting these into the definition of $R$:\n$$\nR(y; K) = \\frac{h_x h_y^2 + \\frac{2h_y^3}{3}}{h^{-1} \\left(\\frac{h_x h_y^3}{3}\\right) + h (h_x h_y)} = \\frac{h_y^2(h_x + \\frac{2h_y}{3})}{h_x h_y (\\frac{h^{-1} h_y^2}{3} + h)} = \\frac{h_y (h_x + \\frac{2h_y}{3})}{h_x (\\frac{h^{-1} h_y^2}{3} + h)}\n$$\n\n**Derivation of the ratio $Q(h_x, h_y)$**\n\nThe configuration consists of two elements, $K^- = [0,h_x] \\times [0,h_y]$ and $K^+ = [h_x,2h_x] \\times [0,h_y]$, sharing a vertical interior face $F = \\{h_x\\} \\times [0,h_y]$ of length $\\ell_F=h_y$. The piecewise function is $u|_{K^-} = -1$ and $u|_{K^+} = 1$. The jump across the face is $[u] = u|_{K^+} - u|_{K^-} = 1 - (-1) = 2$. The penalty parameter is $\\sigma=1$ and the isotropic face size is $h_F = h = \\max\\{h_x,h_y\\}$.\nThe ratio $Q$ is defined as:\n$$\nQ(h_x, h_y) := \\frac{\\int_F \\frac{\\sigma}{h_F} [u]^2 \\, ds}{h^{-1} \\left( \\| u \\|_{L^2(K^-)}^2 + \\| u \\|_{L^2(K^+)}^2 \\right) + h \\left( \\| \\nabla u \\|_{L^2(K^-)}^2 + \\| \\nabla u \\|_{L^2(K^+)}^2 \\right)}\n$$\nThe numerator is:\n$$\n\\int_F \\frac{\\sigma}{h_F} [u]^2 \\, ds = \\frac{1}{h} \\cdot 2^2 \\int_0^{h_y} \\, ds = \\frac{4}{h} h_y\n$$\nFor the denominator, we compute the norms. Since $u$ is piecewise constant, its weak gradient is zero within each element, so $\\| \\nabla u \\|_{L^2(K^-)}^2 = 0$ and $\\| \\nabla u \\|_{L^2(K^+)}^2 = 0$.\nThe $L^2$ norms are:\n$$\n\\| u \\|_{L^2(K^-)}^2 = \\int_{K^-} (-1)^2 \\, dA = \\text{Area}(K^-) = h_x h_y\n$$\n$$\n\\| u \\|_{L^2(K^+)}^2 = \\int_{K^+} (1)^2 \\, dA = \\text{Area}(K^+) = h_x h_y\n$$\nThe denominator is therefore:\n$$\nh^{-1} (h_x h_y + h_x h_y) + h(0+0) = \\frac{2h_x h_y}{h}\n$$\nThe ratio $Q$ is:\n$$\nQ(h_x, h_y) = \\frac{\\frac{4h_y}{h}}{\\frac{2h_x h_y}{h}} = \\frac{4h_y}{2h_x h_y} = \\frac{2}{h_x}\n$$\nThis result demonstrates that the ratio $Q$ is independent of $h_y$ and blows up as $h_x \\to 0$.\n\n**Numerical Evaluation**\n\nWe now apply these formulas to the specified test cases.\n\n_Anisotropic sequence_: $h_x(n) = 2^{-n}$ and $h_y(n) = 2^{-2n}$ for $n \\in \\{1, 3, 5\\}$.\nFor $n \\ge 1$, we have $2n  n$, so $2^{-2n}  2^{-n}$, which means $h_y  h_x$. Thus, $h = \\max\\{h_x, h_y\\} = h_x$. The aspect ratio is $h_x/h_y = 2^n$, which grows with $n$.\nWe use $h=h_x$ in the formulas for $R$:\n- $R(1; K_n) = \\frac{2h_x(h_x + h_y)}{h_x h_y} = \\frac{2(h_x+h_y)}{h_y} = 2(\\frac{h_x}{h_y}+1) = 2(2^n+1)$.\n- $R(x; K_n) = \\frac{h_x (\\frac{2h_x}{3} + h_y)}{h_y (\\frac{h_x^{-1} h_x^2}{3} + h_x)} = \\frac{h_x (\\frac{2h_x}{3} + h_y)}{h_y (\\frac{h_x}{3} + h_x)} = \\frac{h_x(\\frac{2h_x}{3} + h_y)}{h_y(\\frac{4h_x}{3})} = \\frac{2h_x+3h_y}{4h_y} = \\frac{1}{2}\\frac{h_x}{h_y} + \\frac{3}{4} = \\frac{1}{2}2^n + \\frac{3}{4} = 2^{n-1}+0.75$.\n- $R(y; K_n) = \\frac{h_y(h_x + \\frac{2}{3}h_y)}{h_x^2 + h_y^2/3}$.\n$R(1; K_n) = 2^{n+1}+2$ and $R(x; K_n) = 2^{n-1}+0.75$. For $n \\ge 1$, $R(1; K_n)$ is larger. $R(y; K_n)$ approaches $0$ as $n \\to \\infty$. Thus, $M(n) = \\max\\{R(1;K_n), R(x;K_n), R(y;K_n)\\} = 2(2^n+1)$.\n- For $n=1$: $M(1) = 2(2^1+1) = 6$.\n- For $n=3$: $M(3) = 2(2^3+1) = 18$.\n- For $n=5$: $M(5) = 2(2^5+1) = 66$.\n\nFor $Q(n)$, we have $Q(n) = 2/h_x(n) = 2/2^{-n} = 2^{n+1}$.\n- For $n=1$: $Q(1) = 2^{1+1} = 4$.\n- For $n=3$: $Q(3) = 2^{3+1} = 16$.\n- For $n=5$: $Q(5) = 2^{5+1} = 64$.\n\n_Isotropic case_: $h_x = h_y = 2^{-3}$. Here $h=h_x=h_y$. Let's call this size $H$.\n- $R(1; K_{\\mathrm{iso}}) = \\frac{2H(H+H)}{H \\cdot H} = \\frac{4H^2}{H^2} = 4$.\n- $R(x; K_{\\mathrm{iso}}) = \\frac{H(\\frac{2H}{3} + H)}{H(\\frac{H^{-1}H^2}{3} + H)} = \\frac{H(5H/3)}{H(4H/3)} = \\frac{5}{4} = 1.25$.\n- $R(y; K_{\\mathrm{iso}}) = R(x; K_{\\mathrm{iso}}) = 1.25$ by symmetry.\nTherefore, $M_{\\mathrm{iso}} = \\max\\{4, 1.25, 1.25\\} = 4$.\n\nThe final list of results is $[M(1), M(3), M(5), M_{\\mathrm{iso}}, Q(1), Q(3), Q(5)]$.\n- $M(1) = 6.0$\n- $M(3) = 18.0$\n- $M(5) = 66.0$\n- $M_{\\mathrm{iso}} = 4.0$\n- $Q(1) = 4.0$\n- $Q(3) = 16.0$\n- $Q(5) = 64.0$\nThese values clearly demonstrate that the ratios $R$ and $Q$ are not uniformly bounded for the anisotropic mesh sequence, confirming the failure of the isotropic control.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef calculate_R(v_type, hx, hy):\n    \"\"\"\n    Computes the ratio R(v; K) for a given test function type and element dimensions.\n\n    R(v; K) = ||v||^2_L2(dK) / (h^-1 ||v||^2_L2(K) + h ||grad v||^2_L2(K))\n    \"\"\"\n    if not (hx  0 and hy  0):\n        # This case should not be reached with the problem's inputs\n        raise ValueError(\"Element dimensions hx and hy must be positive.\")\n        \n    h = max(hx, hy)\n\n    if v_type == '1':\n        # v(x,y) = 1\n        # Numerator: ||v||^2_L2(dK) = Perimeter = 2*(hx+hy)\n        num = 2.0 * (hx + hy)\n        # Denominator:\n        # ||v||^2_L2(K) = hx*hy\n        # ||grad v||^2_L2(K) = 0\n        den = (1.0 / h) * (hx * hy)\n        if den == 0.0: return np.inf\n        return num / den\n\n    elif v_type == 'x':\n        # v(x,y) = x\n        # Numerator: ||v||^2_L2(dK) = integral of x^2 over boundary\n        num = (2.0/3.0) * hx**3 + hx**2 * hy\n        # Denominator:\n        # ||v||^2_L2(K) = integral of x^2 over K = hx^3 * hy / 3\n        v_norm_sq = (hx**3 * hy) / 3.0\n        # ||grad v||^2_L2(K) = integral of 1^2 over K = hx*hy\n        grad_v_norm_sq = hx * hy\n        den = (1.0 / h) * v_norm_sq + h * grad_v_norm_sq\n        if den == 0.0: return np.inf\n        return num / den\n\n    elif v_type == 'y':\n        # v(x,y) = y\n        # Numerator: ||v||^2_L2(dK) = integral of y^2 over boundary\n        num = hx * hy**2 + (2.0/3.0) * hy**3\n        # Denominator:\n        # ||v||^2_L2(K) = integral of y^2 over K = hx * hy^3 / 3\n        v_norm_sq = (hx * hy**3) / 3.0\n        # ||grad v||^2_L2(K) = integral of 1^2 over K = hx*hy\n        grad_v_norm_sq = hx * hy\n        den = (1.0 / h) * v_norm_sq + h * grad_v_norm_sq\n        if den == 0.0: return np.inf\n        return num / den\n\n    else:\n        raise ValueError(\"Invalid v_type specified. Must be '1', 'x', or 'y'.\")\n\ndef calculate_Q(hx, hy):\n    \"\"\"\n    Computes the ratio Q(hx, hy) for given element dimensions.\n    Based on the analytical derivation, Q(hx, hy) = 2/hx.\n    \"\"\"\n    if hx == 0.0: return np.inf\n    return 2.0 / hx\n\ndef solve():\n    \"\"\"\n    Main function to compute and print the results for the problem.\n    \"\"\"\n    \n    # Define test cases from the problem statement.\n    test_n = [1, 3, 5]\n    \n    m_anisotropic_results = []\n    q_anisotropic_results = []\n\n    # Anisotropic sequence calculation\n    for n in test_n:\n        hx = 2.0**(-n)\n        hy = 2.0**(-2*n)\n\n        # Calculate M(n)\n        r_1 = calculate_R('1', hx, hy)\n        r_x = calculate_R('x', hx, hy)\n        r_y = calculate_R('y', hx, hy)\n        m_n = max(r_1, r_x, r_y)\n        m_anisotropic_results.append(m_n)\n\n        # Calculate Q(n)\n        q_n = calculate_Q(hx, hy)\n        q_anisotropic_results.append(q_n)\n\n    # Isotropic comparison case calculation\n    hx_iso = 2.0**(-3)\n    hy_iso = 2.0**(-3)\n    \n    r_1_iso = calculate_R('1', hx_iso, hy_iso)\n    r_x_iso = calculate_R('x', hx_iso, hy_iso)\n    r_y_iso = calculate_R('y', hx_iso, hy_iso)\n    m_iso = max(r_1_iso, r_x_iso, r_y_iso)\n\n    # Assemble the final list in the required order\n    # [ M(1), M(3), M(5), M_iso, Q(1), Q(3), Q(5) ]\n    final_results = [\n        m_anisotropic_results[0],\n        m_anisotropic_results[1],\n        m_anisotropic_results[2],\n        m_iso,\n        q_anisotropic_results[0],\n        q_anisotropic_results[1],\n        q_anisotropic_results[2],\n    ]\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, final_results))}]\")\n\nsolve()\n```", "id": "3414934"}]}