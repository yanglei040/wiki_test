{"hands_on_practices": [{"introduction": "The Bauer-Fike theorem provides an upper bound on eigenvalue perturbation, and a natural first question is how \"tight\" this bound is. For normal matrices, the eigenvector matrix $V$ can be chosen as unitary, resulting in an ideal condition number $\\kappa_2(V) = 1$. This exercise [@problem_id:3585033] demonstrates that even in this best-case scenario, the bound is sharp, as you will construct a perturbation where the eigenvalue shift exactly matches the perturbation's norm, confirming the theorem is not just a loose inequality.", "problem": "Let $n \\geq 2$ and let $A \\in \\mathbb{C}^{n \\times n}$ be a normal matrix, so there exists a unitary matrix $U \\in \\mathbb{C}^{n \\times n}$ and a diagonal matrix $\\Lambda = \\operatorname{diag}(\\lambda_{1},\\ldots,\\lambda_{n})$ such that $A = U \\Lambda U^{*}$. Fix an index $k \\in \\{1,\\ldots,n\\}$ and a real scalar $t > 0$. Construct a perturbation $E \\in \\mathbb{C}^{n \\times n}$ that is rank one and aligned with the $k$-th eigenvector of $A$ so that the spectral norm satisfies $\\|E\\|_{2} = t$, and verify from first principles that the spectrum of $A + E$ is obtained by shifting exactly one eigenvalue of $A$ by a real amount of magnitude $t$ while leaving the remaining eigenvalues unchanged. Conclude that the radius prescribed by the Bauer-Fike theorem for $A$ (the “Bauer-Fike radius” when $A$ is normal) is achieved exactly by an eigenvalue shift for your construction.\n\nProvide the exact value of the achieved shift magnitude as a closed-form expression in terms of $t$. No numerical rounding is required, and no units are involved.", "solution": "Let $A \\in \\mathbb{C}^{n \\times n}$ be a normal matrix with $n \\geq 2$. By the spectral theorem for normal matrices, there exists a unitary matrix $U \\in \\mathbb{C}^{n \\times n}$ and a diagonal matrix $\\Lambda = \\operatorname{diag}(\\lambda_{1},\\ldots,\\lambda_{n})$ such that $A = U \\Lambda U^{*}$. The columns of $U$, denoted by $u_1, u_2, \\ldots, u_n$, form an orthonormal basis of eigenvectors for $A$. That is, $A u_j = \\lambda_j u_j$ for each $j \\in \\{1,\\ldots,n\\}$, and the orthonormality condition is $u_i^* u_j = \\delta_{ij}$, where $\\delta_{ij}$ is the Kronecker delta.\n\nThe problem requires the construction of a rank-one perturbation $E \\in \\mathbb{C}^{n \\times n}$ that is \"aligned with the $k$-th eigenvector of $A$\" for a fixed index $k \\in \\{1,\\ldots,n\\}$, such that its spectral norm is $\\|E\\|_{2} = t$ for a given real scalar $t > 0$.\n\nWe construct the matrix $E$. The $k$-th eigenvector of $A$ is $u_k$. A rank-one matrix that is aligned with $u_k$ can be constructed as an outer product involving $u_k$. A simple choice is of the form $E = \\alpha u_k u_k^*$ for some scalar $\\alpha \\in \\mathbb{C}$.\n\nWe verify the properties of this constructed matrix $E$:\n1.  **Rank**: Since $u_k$ is a non-zero vector, the matrix $E = \\alpha u_k u_k^*$ has rank one, provided $\\alpha \\neq 0$.\n2.  **Spectral Norm**: We must satisfy the condition $\\|E\\|_2 = t$. The spectral norm of $E$ is given by\n    $$ \\|E\\|_2 = \\|\\alpha u_k u_k^*\\|_2 = |\\alpha| \\|u_k u_k^*\\|_2 $$\n    The matrix $P_k = u_k u_k^*$ is the orthogonal projector onto the subspace spanned by $u_k$. Since $u_k$ is a unit vector ($u_k^* u_k = 1$), $P_k$ is a Hermitian and idempotent matrix ($P_k^2 = P_k$), so its largest singular value is $1$. Thus, $\\|P_k\\|_2 = 1$.\n    Therefore, we have $\\|E\\|_2 = |\\alpha|$. The condition $\\|E\\|_2 = t$ implies $|\\alpha| = t$. As we are given $t>0$, we can choose $\\alpha = t$.\n    Thus, we define the perturbation matrix as $E = t u_k u_k^*$. This matrix is rank one and satisfies $\\|E\\|_2 = t$.\n\nNext, we must verify the effect of this perturbation on the spectrum of $A$. Let the perturbed matrix be $A' = A + E = A + t u_k u_k^*$. We find the eigenvalues of $A'$ by testing its action on the eigenvectors of $A$.\n\nFor any eigenvector $u_j$ of $A$ with $j \\neq k$:\n$$ A' u_j = (A + t u_k u_k^*) u_j = A u_j + t u_k (u_k^* u_j) $$\nSince the set $\\{u_1, \\ldots, u_n\\}$ is orthonormal, $u_k^* u_j = 0$ for $j \\neq k$. Consequently:\n$$ A' u_j = A u_j = \\lambda_j u_j $$\nThis shows that for each $j \\in \\{1,\\ldots,n\\} \\setminus \\{k\\}$, $\\lambda_j$ is an eigenvalue of $A'$, with the same corresponding eigenvector $u_j$.\n\nNow, we consider the eigenvector $u_k$:\n$$ A' u_k = (A + t u_k u_k^*) u_k = A u_k + t u_k (u_k^* u_k) $$\nSince $u_k$ is a unit vector, $u_k^* u_k = 1$. The expression simplifies to:\n$$ A' u_k = A u_k + t u_k = \\lambda_k u_k + t u_k = (\\lambda_k + t) u_k $$\nThis shows that $(\\lambda_k + t)$ is an eigenvalue of $A'$, with $u_k$ as the corresponding eigenvector.\n\nIn summary, the spectrum of the perturbed matrix $A+E$ is precisely\n$$ \\sigma(A+E) = \\{\\lambda_1, \\ldots, \\lambda_{k-1}, \\lambda_k + t, \\lambda_{k+1}, \\ldots, \\lambda_n\\} $$\nExactly one eigenvalue, $\\lambda_k$, has been shifted by a real amount $t$. The magnitude of this shift is $|t|=t$.\n\nFinally, we relate this to the Bauer-Fike theorem. For a normal matrix $A$, the eigenvector matrix $V$ can be chosen as unitary, so $\\kappa_2(V) = 1$. The theorem simplifies to: for any eigenvalue $\\mu$ of $A+E$, $\\min_j |\\lambda_j - \\mu| \\le \\|E\\|_2$.\nIn our case, $\\|E\\|_2 = t$. Our construction yields a new eigenvalue $\\mu' = \\lambda_k + t$. The distance from this new eigenvalue to the original spectrum is $\\min_j |\\lambda_j - \\mu'| = |\\lambda_k - (\\lambda_k+t)| = |-t| = t$. This distance is exactly equal to the upper bound $t = \\|E\\|_2$. Thus, the bound is sharp.\n\nThe problem asks for the exact value of the achieved shift magnitude. The shift is $(\\lambda_k + t) - \\lambda_k = t$. Since $t>0$, the magnitude is $t$.", "answer": "$$\n\\boxed{t}\n$$", "id": "3585033"}, {"introduction": "Having explored the well-behaved nature of normal matrices, we now turn to the opposite extreme: highly non-normal matrices. The Bauer-Fike theorem warns that an ill-conditioned eigenbasis, where $\\kappa_2(V) \\gg 1$, can dramatically amplify the effect of perturbations on eigenvalues. This practice guides you to construct a matrix with an arbitrarily large $\\kappa_2(V)$ and design an adversarial perturbation that exploits this sensitivity, showing firsthand how the theoretical factor $\\kappa_2(V)$ manifests as real, and often extreme, eigenvalue instability [@problem_id:3585013].", "problem": "Let $\\epsilon \\in (0,1)$ and define the invertible matrix $V_{\\epsilon} \\in \\mathbb{R}^{2 \\times 2}$ and the diagonal matrix $D \\in \\mathbb{R}^{2 \\times 2}$ by\n$$\nV_{\\epsilon} \\;=\\; \\begin{pmatrix} 1 & 1 \\\\ 0 & \\epsilon \\end{pmatrix}, \n\\qquad\nD \\;=\\; \\begin{pmatrix} 0 & 0 \\\\ 0 & 1 \\end{pmatrix}.\n$$\nSet $A_{\\epsilon} \\,=\\, V_{\\epsilon} D V_{\\epsilon}^{-1} \\in \\mathbb{R}^{2 \\times 2}$. Consider the operator $2$-norm $\\|\\cdot\\|_{2}$ and the $2$-norm condition number $\\kappa_{2}(V_{\\epsilon}) \\,=\\, \\|V_{\\epsilon}\\|_{2}\\,\\|V_{\\epsilon}^{-1}\\|_{2}$. Let $v_{1} \\in \\mathbb{R}^{2}$ and $w_{1} \\in \\mathbb{R}^{2}$ be, respectively, a right and a left eigenvector of $A_{\\epsilon}$ associated with the eigenvalue $0$, chosen so that $w_{1}^{\\top} v_{1} = 1$. For $\\delta > 0$, define the rank-one perturbation\n$$\nE_{\\epsilon,\\delta} \\;=\\; \\delta \\,\\frac{w_{1}}{\\|w_{1}\\|_{2}} \\left(\\frac{v_{1}}{\\|v_{1}\\|_{2}}\\right)^{\\!\\top}.\n$$\nLet $\\widehat{\\lambda}_{\\epsilon}(\\delta)$ denote the eigenvalue of $A_{\\epsilon} + E_{\\epsilon,\\delta}$ that converges to $0$ as $\\delta \\to 0^{+}$.\n\nYour tasks are:\n- Starting from the definitions of diagonalizability, normality, left and right eigenvectors, and the matrix $2$-norm, verify that $A_{\\epsilon}$ is diagonalizable and non-normal, identify $v_{1}$ and $w_{1}$ explicitly, and show that $\\|E_{\\epsilon,\\delta}\\|_{2}=\\delta$.\n- Compute $\\kappa_{2}(V_{\\epsilon})$ in terms of $\\epsilon$ from first principles, using singular values.\n- Using only foundational principles of eigenvalue perturbation for diagonalizable matrices, determine the leading-order behavior of $\\widehat{\\lambda}_{\\epsilon}(\\delta)$ as $\\delta \\to 0^{+}$ and express the ratio\n$$\nR(\\epsilon,\\delta) \\;=\\; \\frac{|\\widehat{\\lambda}_{\\epsilon}(\\delta)|}{\\kappa_{2}(V_{\\epsilon})\\,\\|E_{\\epsilon,\\delta}\\|_{2}}\n$$\nin a form suitable for taking limits.\n- Evaluate the iterated limit\n$$\nc \\;=\\; \\lim_{\\epsilon \\to 0^{+}} \\;\\lim_{\\delta \\to 0^{+}} \\; R(\\epsilon,\\delta).\n$$\n\nReport the value of $c$. No intermediate inequalities are to be reported as the final answer. No units are involved. No rounding is required; give the exact value.", "solution": "The problem statement requires a multi-step analysis of the non-normal matrix $A_{\\epsilon} = V_{\\epsilon} D V_{\\epsilon}^{-1}$.\n\n**1. Analyze $A_{\\epsilon}$, Eigenvectors, and Perturbation Norm**\nFirst, we compute $V_{\\epsilon}^{-1}$ and then $A_{\\epsilon}$.\nGiven $V_{\\epsilon} = \\begin{pmatrix} 1 & 1 \\\\ 0 & \\epsilon \\end{pmatrix}$, its inverse is $V_{\\epsilon}^{-1} = \\begin{pmatrix} 1 & -1/\\epsilon \\\\ 0 & 1/\\epsilon \\end{pmatrix}$.\nThe matrix $A_{\\epsilon}$ is:\n$$ A_{\\epsilon} = V_{\\epsilon} D V_{\\epsilon}^{-1} = \\begin{pmatrix} 1 & 1 \\\\ 0 & \\epsilon \\end{pmatrix} \\begin{pmatrix} 0 & 0 \\\\ 0 & 1 \\end{pmatrix} \\begin{pmatrix} 1 & -1/\\epsilon \\\\ 0 & 1/\\epsilon \\end{pmatrix} = \\begin{pmatrix} 0 & 1/\\epsilon \\\\ 0 & 1 \\end{pmatrix} $$\nBy construction, $A_{\\epsilon}$ is diagonalizable with eigenvalues $\\lambda_1=0$ and $\\lambda_2=1$. A matrix is normal if it commutes with its transpose, $A_{\\epsilon}A_{\\epsilon}^{\\top} = A_{\\epsilon}^{\\top}A_{\\epsilon}$. We find $A_{\\epsilon}A_{\\epsilon}^{\\top} = \\begin{pmatrix} 1/\\epsilon^2 & 1/\\epsilon \\\\ 1/\\epsilon & 1 \\end{pmatrix}$ and $A_{\\epsilon}^{\\top}A_{\\epsilon} = \\begin{pmatrix} 0 & 0 \\\\ 0 & 1/\\epsilon^2 + 1 \\end{pmatrix}$, so $A_{\\epsilon}$ is non-normal.\n\nThe right eigenvector $v_1$ for $\\lambda_1=0$ is the first column of $V_{\\epsilon}$, $v_1 = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$. The left eigenvector $w_1$ for $\\lambda_1=0$ is the transpose of the first row of $V_{\\epsilon}^{-1}$, $w_1 = \\begin{pmatrix} 1 \\\\ -1/\\epsilon \\end{pmatrix}$. The normalization $w_1^{\\top}v_1 = 1$ is satisfied.\n\nThe perturbation $E_{\\epsilon,\\delta} = \\delta \\, u v^{\\top}$ where $u$ and $v$ are unit vectors. Its spectral norm is $\\|E_{\\epsilon,\\delta}\\|_{2} = \\delta \\|u\\|_2 \\|v\\|_2 = \\delta$.\n\n**2. Compute Condition Number $\\kappa_2(V_{\\epsilon})$**\nWe compute the singular values of $V_{\\epsilon}$ from the eigenvalues of $V_{\\epsilon}^{\\top}V_{\\epsilon} = \\begin{pmatrix} 1 & 1 \\\\ 1 & 1+\\epsilon^2 \\end{pmatrix}$. The characteristic equation is $\\lambda^2 - (2+\\epsilon^2)\\lambda + \\epsilon^2 = 0$, which gives eigenvalues $\\lambda = \\frac{1}{2}(2+\\epsilon^2 \\pm \\sqrt{4+\\epsilon^4})$. The singular values are $\\sigma = \\sqrt{\\lambda}$.\nThe condition number is $\\kappa_2(V_{\\epsilon}) = \\sigma_{\\max}/\\sigma_{\\min} = \\sqrt{\\lambda_{\\max}/\\lambda_{\\min}}$.\n$$ \\kappa_2(V_{\\epsilon})^2 = \\frac{2+\\epsilon^2 + \\sqrt{4+\\epsilon^4}}{2+\\epsilon^2 - \\sqrt{4+\\epsilon^4}} = \\frac{(2+\\epsilon^2 + \\sqrt{4+\\epsilon^4})^2}{4\\epsilon^2} $$\n$$ \\kappa_2(V_{\\epsilon}) = \\frac{2+\\epsilon^2 + \\sqrt{4+\\epsilon^4}}{2\\epsilon} $$\n\n**3. Determine Perturbed Eigenvalue and Ratio**\nFor a simple eigenvalue $\\lambda_1$, the first-order perturbation is $\\Delta\\lambda_1 = \\frac{w_1^{\\top}E_{\\epsilon,\\delta}v_1}{w_1^{\\top}v_1}$. With the given form of $E_{\\epsilon,\\delta}$ and normalization $w_1^{\\top}v_1=1$, this result is exact:\n$$ \\widehat{\\lambda}_{\\epsilon}(\\delta) = \\lambda_1 + \\Delta\\lambda_1 = 0 + w_1^{\\top} \\left( \\delta \\frac{w_1}{\\|w_1\\|_2} \\frac{v_1^{\\top}}{\\|v_1\\|_2} \\right) v_1 = \\delta \\frac{\\|w_1\\|_2^2 \\|v_1\\|_2^2}{\\|w_1\\|_2\\|v_1\\|_2} = \\delta \\|w_1\\|_2 \\|v_1\\|_2 $$\nWe have $\\|v_1\\|_2 = 1$ and $\\|w_1\\|_2 = \\sqrt{1+1/\\epsilon^2} = \\frac{\\sqrt{1+\\epsilon^2}}{\\epsilon}$.\nThus, $\\widehat{\\lambda}_{\\epsilon}(\\delta) = \\frac{\\delta\\sqrt{1+\\epsilon^2}}{\\epsilon}$. The ratio $R(\\epsilon,\\delta)$ is:\n$$ R(\\epsilon,\\delta) = \\frac{|\\widehat{\\lambda}_{\\epsilon}(\\delta)|}{\\kappa_{2}(V_{\\epsilon})\\,\\|E_{\\epsilon,\\delta}\\|_{2}} = \\frac{\\frac{\\delta\\sqrt{1+\\epsilon^2}}{\\epsilon}}{\\left(\\frac{2+\\epsilon^2 + \\sqrt{4+\\epsilon^4}}{2\\epsilon}\\right)\\delta} = \\frac{2\\sqrt{1+\\epsilon^2}}{2+\\epsilon^2 + \\sqrt{4+\\epsilon^4}} $$\nThis expression is independent of $\\delta$.\n\n**4. Evaluate the Limit**\nThe iterated limit simplifies to a single limit:\n$$ c = \\lim_{\\epsilon \\to 0^{+}} \\lim_{\\delta \\to 0^{+}} R(\\epsilon,\\delta) = \\lim_{\\epsilon \\to 0^{+}} \\frac{2\\sqrt{1+\\epsilon^2}}{2+\\epsilon^2 + \\sqrt{4+\\epsilon^4}} $$\nEvaluating at $\\epsilon=0$:\n$$ c = \\frac{2\\sqrt{1+0}}{2+0 + \\sqrt{4+0}} = \\frac{2}{2+2} = \\frac{1}{2} $$\nThe final value is $1/2$.", "answer": "$$\\boxed{\\frac{1}{2}}$$", "id": "3585013"}, {"introduction": "While theoretical bounds provide worst-case guarantees, computational experiments offer deeper intuition into how these bounds behave in practice. This problem [@problem_id:3585060] bridges theory and application by tasking you with designing a numerical experiment to test the limits of the Bauer-Fike theorem. You will write a program to construct matrices with varying degrees of non-normality, compute the theoretical bounds, and then algorithmically search for adversarial perturbations that produce the largest possible eigenvalue shifts, offering a powerful, hands-on verification of the theorem.", "problem": "You are to implement a complete program that constructs, analyzes, and verifies eigenvalue perturbation behavior for diagonalizable matrices using the concept commonly known as the Bauer-Fike radius. All mathematical objects must be treated in purely mathematical terms with explicit definitions. The fundamental base for the derivation and algorithm must start from the following principles and definitions: the definition of a diagonalizable matrix, the spectral (two) norm, the two-norm condition number, and the Singular Value Decomposition (SVD) of a matrix. You must not rely on any unproven shortcut formulas beyond these definitions, and your program must compute all quantities exactly as specified.\n\nDefinitions and tasks:\n1. A square matrix $A \\in \\mathbb{R}^{3 \\times 3}$ is diagonalizable if there exists an invertible matrix $V \\in \\mathbb{R}^{3 \\times 3}$ and a diagonal matrix $\\Lambda \\in \\mathbb{R}^{3 \\times 3}$ such that $A = V \\Lambda V^{-1}$. The diagonal entries of $\\Lambda$ are the eigenvalues of $A$.\n2. The spectral two norm of a matrix $M \\in \\mathbb{R}^{n \\times n}$ is defined as $\\lVert M \\rVert_2 = \\sigma_{\\max}(M)$, where $\\sigma_{\\max}(M)$ is the largest singular value of $M$ and singular values are the nonnegative square roots of the eigenvalues of $M^\\top M$. Use the Singular Value Decomposition (SVD) to compute singular values.\n3. The two-norm condition number of an invertible matrix $V$ is defined as $\\kappa_2(V) = \\lVert V \\rVert_2 \\, \\lVert V^{-1} \\rVert_2$. Equivalently, if $\\sigma_{\\max}(V)$ and $\\sigma_{\\min}(V)$ denote the largest and smallest singular values of $V$, then $\\kappa_2(V) = \\sigma_{\\max}(V)/\\sigma_{\\min}(V)$.\n4. Given a perturbation matrix $E \\in \\mathbb{R}^{3 \\times 3}$ and its spectral two norm $\\lVert E \\rVert_2$, define the Bauer-Fike radius for $V$ and $\\lVert E \\rVert_2$ to be $r_{\\mathrm{BF}}(V, \\lVert E \\rVert_2) \\coloneqq \\kappa_2(V) \\, \\lVert E \\rVert_2$. This quantity is traditionally used to bound possible eigenvalue displacements of $A$ under the perturbation $E$.\n5. For a diagonalizable $A = V \\Lambda V^{-1}$ and a diagonal matrix $\\Delta = \\mathrm{diag}(\\delta_1,\\delta_2,\\delta_3)$, consider the structured perturbation $E = V \\Delta V^{-1}$. In this case one has $A + E = V (\\Lambda + \\Delta) V^{-1}$, so the eigenvalues of $A + E$ are exactly shifted by the diagonal entries of $\\Delta$. For a given $V$ and a chosen diagonal direction $d = (d_1, d_2, d_3)$ with $\\max_i |d_i| = 1$, set $E(d,\\alpha) = V \\,\\mathrm{diag}(\\alpha d_1, \\alpha d_2, \\alpha d_3)\\, V^{-1}$ and scale $\\alpha$ so that $\\lVert E(d,\\alpha) \\rVert_2$ equals the prescribed value. This constructs an adversarial perturbation aligned with a chosen diagonal direction.\n\nYour program must:\n- Construct three diagonalizable matrices $A \\in \\mathbb{R}^{3 \\times 3}$ with specified spectra and deliberately designed diagonalizers $V$ to explore different regimes of the two-norm condition number. You must build $V$ through a fixed-angle rotation in the $x\\text{-}z$ plane followed by anisotropic diagonal scaling to induce large $\\kappa_2(V)$, moderate $\\kappa_2(V)$, and, in a baseline case, $\\kappa_2(V) = 1$ by using an orthogonal diagonalizer. The rotation angle must be specified in radians.\n- For each case, compute $A = V \\Lambda V^{-1}$ for the specified spectrum, compute $\\kappa_2(V)$ from the SVD of $V$, and compute $r_{\\mathrm{BF}}(V, \\lVert E \\rVert_2)$ for the given $\\lVert E \\rVert_2$.\n- Implement a search over diagonal directions $d$ satisfying $\\max_i |d_i| = 1$ to find an adversarial direction that minimizes the quantity $\\lVert V \\,\\mathrm{diag}(d)\\, V^{-1} \\rVert_2$. For the selected direction, scale $\\alpha$ so that $\\lVert E(d,\\alpha) \\rVert_2$ matches the prescribed value, form $E(d,\\alpha)$, and compute the eigenvalues of $A$ and $A + E(d,\\alpha)$. Quantify the maximal eigenvalue displacement observed as $s = \\max_j \\min_i \\left| \\lambda_j(A+E) - \\lambda_i(A) \\right|$ (pair each perturbed eigenvalue with the closest original eigenvalue in absolute value and take the maximum of these minimal distances).\n- Return, for each case, the ratio $s / r_{\\mathrm{BF}}(V, \\lVert E \\rVert_2)$ as a floating-point number. This ratio quantifies how close the adversarial perturbation comes to the Bauer-Fike radius.\n\nAngle unit specification: all rotation angles must be expressed in radians.\n\nTest suite:\n- Case 1 (large $\\kappa_2(V)$):\n  - Spectrum: $\\{\\lambda_1, \\lambda_2, \\lambda_3\\} = \\{1.0, -2.0, 4.0\\}$, so $\\Lambda = \\mathrm{diag}(1.0, -2.0, 4.0)$.\n  - Rotation angle: $\\theta = \\pi/4$ (in radians). Use the $y$-axis rotation matrix:\n    $$\n    W(\\theta) = \\begin{bmatrix}\n    \\cos\\theta & 0 & \\sin\\theta \\\\\n    0 & 1 & 0 \\\\\n    -\\sin\\theta & 0 & \\cos\\theta\n    \\end{bmatrix}.\n    $$\n  - Diagonal scaling: $\\Sigma = \\mathrm{diag}(1, s, s^2)$ with $s = 10^{-2}$.\n  - Diagonalizer: $V = \\Sigma \\, W(\\theta)^\\top$.\n  - Prescribed spectral norm of perturbation: $\\lVert E \\rVert_2 = \\varepsilon = 10^{-2}$.\n- Case 2 (moderate $\\kappa_2(V)$):\n  - Spectrum: $\\{\\lambda_1, \\lambda_2, \\lambda_3\\} = \\{0.5, -1.5, 3.0\\}$, so $\\Lambda = \\mathrm{diag}(0.5, -1.5, 3.0)$.\n  - Rotation angle: $\\theta = \\pi/4$ (in radians).\n  - Diagonal scaling: $\\Sigma = \\mathrm{diag}(1, s, s^2)$ with $s = 0.3$.\n  - Diagonalizer: $V = \\Sigma \\, W(\\theta)^\\top$.\n  - Prescribed spectral norm of perturbation: $\\lVert E \\rVert_2 = \\varepsilon = 5 \\times 10^{-3}$.\n- Case 3 (baseline orthogonal diagonalizer, $\\kappa_2(V) = 1$):\n  - Spectrum: $\\{\\lambda_1, \\lambda_2, \\lambda_3\\} = \\{2.0, 0.0, -1.0\\}$, so $\\Lambda = \\mathrm{diag}(2.0, 0.0, -1.0)$.\n  - Diagonalizer: $V = I_3$, the $3 \\times 3$ identity matrix, so no rotation is applied.\n  - Prescribed spectral norm of perturbation: $\\lVert E \\rVert_2 = \\varepsilon = 10^{-3}$.\n\nAlgorithmic requirements:\n- For each case, compute $\\kappa_2(V)$ via the SVD of $V$ using the ratio $\\sigma_{\\max}(V)/\\sigma_{\\min}(V)$.\n- Compute $r_{\\mathrm{BF}}(V, \\varepsilon) = \\kappa_2(V)\\,\\varepsilon$.\n- Search over diagonal directions $d$ satisfying $\\max_i |d_i| = 1$, including a deterministic set of canonical patterns and a randomized set with a fixed seed, to approximately minimize $\\lVert V \\,\\mathrm{diag}(d)\\, V^{-1} \\rVert_2$.\n- For the minimizing $d$, set $\\alpha = \\varepsilon / \\lVert V \\,\\mathrm{diag}(d)\\, V^{-1} \\rVert_2$ to enforce $\\lVert E(d,\\alpha) \\rVert_2 = \\varepsilon$, construct $E(d,\\alpha)$, compute the eigenvalues of $A$ and $A + E(d,\\alpha)$, and calculate $s$.\n- Output a single line with a comma-separated list enclosed in square brackets containing the three ratios $s / r_{\\mathrm{BF}}(V, \\varepsilon)$ for the three cases, in the order of Case 1, Case 2, Case 3, respectively. Each item must be a floating-point number.\n\nYour program must produce exactly one line of output in the format: \"[r1,r2,r3]\".", "solution": "The user has provided a valid problem statement.\n\nThe problem requires a computational investigation into the sharpness of the Bauer-Fike theorem for diagonalizable matrices. Specifically, we are to construct three matrices with varying conditioning of their eigenvector matrices, apply a structured adversarial perturbation, and compare the resulting maximal eigenvalue displacement to the theoretical upper bound provided by the Bauer-Fike radius.\n\nThe theoretical foundation of this problem rests on several key concepts in numerical linear algebra. Let $A \\in \\mathbb{R}^{n \\times n}$ be a diagonalizable matrix. By definition, there exists an invertible matrix $V$ and a diagonal matrix $\\Lambda$ such that:\n$$ A = V \\Lambda V^{-1} $$\nThe columns of $V$ are the eigenvectors of $A$, and the diagonal entries of $\\Lambda$, denoted $\\lambda_1, \\lambda_2, \\ldots, \\lambda_n$, are the corresponding eigenvalues.\n\nWhen $A$ is perturbed by another matrix $E$, the resulting matrix is $A+E$. The Bauer-Fike theorem provides a bound on how much the eigenvalues of $A$ can shift. It states that for any eigenvalue $\\mu$ of $A+E$, there exists an eigenvalue $\\lambda_i$ of $A$ such that:\n$$ |\\mu - \\lambda_i| \\le \\kappa_2(V) \\lVert E \\rVert_2 $$\nHere, $\\lVert E \\rVert_2$ is the spectral norm (or 2-norm) of $E$, defined as the largest singular value of $E$, $\\sigma_{\\max}(E)$. The quantity $\\kappa_2(V)$ is the 2-norm condition number of the eigenvector matrix $V$, defined as:\n$$ \\kappa_2(V) = \\lVert V \\rVert_2 \\lVert V^{-1} \\rVert_2 = \\frac{\\sigma_{\\max}(V)}{\\sigma_{\\min}(V)} $$\nwhere $\\sigma_{\\max}(V)$ and $\\sigma_{\\min}(V)$ are the largest and smallest singular values of $V$, respectively. The product $\\kappa_2(V) \\lVert E \\rVert_2$ is defined in the problem as the Bauer-Fike radius, $r_{\\mathrm{BF}}(V, \\lVert E \\rVert_2)$.\n\nThe problem investigates a special class of structured perturbations of the form $E = V \\Delta V^{-1}$, where $\\Delta = \\mathrm{diag}(\\delta_1, \\delta_2, \\ldots, \\delta_n)$ is a diagonal matrix. For such a perturbation, the perturbed matrix is:\n$$ A + E = V \\Lambda V^{-1} + V \\Delta V^{-1} = V (\\Lambda + \\Delta) V^{-1} $$\nThis shows that $A+E$ has the same eigenvector matrix $V$ as $A$, and its eigenvalues are $\\mu_j = \\lambda_j + \\delta_j$. The problem asks to construct $E$ with a prescribed spectral norm, $\\lVert E \\rVert_2 = \\varepsilon$. We define the perturbation direction via a diagonal matrix $\\mathrm{diag}(d)$, where $d=(d_1, d_2, d_3)$ and $\\max_i |d_i|=1$. The full perturbation is then scaled by a factor $\\alpha$, so $\\Delta = \\alpha \\, \\mathrm{diag}(d)$. The perturbation matrix is $E(d, \\alpha) = V \\, (\\alpha \\, \\mathrm{diag}(d)) \\, V^{-1} = \\alpha (V \\, \\mathrm{diag}(d) \\, V^{-1})$.\nTo enforce $\\lVert E(d, \\alpha) \\rVert_2 = \\varepsilon$, we must have:\n$$ |\\alpha| \\lVert V \\, \\mathrm{diag}(d) \\, V^{-1} \\rVert_2 = \\varepsilon $$\nWe choose a positive $\\alpha$, so $\\alpha = \\varepsilon / \\lVert V \\, \\mathrm{diag}(d) \\, V^{-1} \\rVert_2$.\n\nFor this structured perturbation, the maximal eigenvalue displacement is measured by $s = \\max_j \\min_i |\\mu_j - \\lambda_i|$. Since $\\mu_j = \\lambda_j + \\alpha d_j$, and assuming $\\alpha$ is sufficiently small, the closest original eigenvalue to $\\mu_j$ is $\\lambda_j$ itself. The distance is $|\\mu_j - \\lambda_j| = |\\alpha d_j|$. The maximal displacement is then:\n$$ s = \\max_j |\\alpha d_j| = \\alpha \\max_j|d_j| = \\alpha $$\nThe last equality holds because we chose $d$ such that $\\max_j|d_j|=1$.\n\nThe final quantity of interest is the ratio of the observed maximal displacement $s$ to the Bauer-Fike bound $r_{\\mathrm{BF}}$:\n$$ \\frac{s}{r_{\\mathrm{BF}}} = \\frac{\\alpha}{\\kappa_2(V) \\varepsilon} = \\frac{\\varepsilon / \\lVert V \\, \\mathrm{diag}(d) \\, V^{-1} \\rVert_2}{\\kappa_2(V) \\varepsilon} = \\frac{1}{\\kappa_2(V) \\lVert V \\, \\mathrm{diag}(d) \\, V^{-1} \\rVert_2} $$\nThe problem requires finding an adversarial direction $d$ by performing a search to minimize the quantity $\\lVert V \\, \\mathrm{diag}(d) \\, V^{-1} \\rVert_2$. This choice of $d$ will maximize the ratio $s/r_{\\mathrm{BF}}$, thereby creating a perturbation that comes as close as possible to saturating the Bauer-Fike bound for this structured class.\n\nThe computational procedure for each test case is as follows:\n1.  **Construct Matrices**: Based on the provided spectrum $\\Lambda$ and parameters for the diagonalizer $V$ (rotation angle $\\theta$, scaling parameter $s$), construct $V$ and then $A = V \\Lambda V^{-1}$. For Case 3, $V$ is given directly as the identity matrix $I_3$.\n2.  **Compute Condition Number and Bound**: Calculate the singular values of $V$ to find $\\kappa_2(V) = \\sigma_{\\max}(V) / \\sigma_{\\min}(V)$. Use the given perturbation norm $\\varepsilon$ to compute the Bauer-Fike radius $r_{\\mathrm{BF}} = \\kappa_2(V) \\varepsilon$.\n3.  **Find Adversarial Direction**: Numerically search for a direction vector $d$ with $\\max_i |d_i|=1$ that approximately minimizes $\\lVert V \\, \\mathrm{diag}(d) \\, V^{-1} \\rVert_2$. The search space is sampled using a combination of deterministic vectors (face centers and vertices of the unit cube) and a set of random vectors, ensuring a thorough exploration.\n4.  **Construct Perturbation**: Using the optimal direction $d^*$ found in the previous step, calculate the scaling factor $\\alpha = \\varepsilon / \\lVert V \\, \\mathrm{diag}(d^*) \\, V^{-1} \\rVert_2$. The perturbation matrix is then $E = V \\, \\mathrm{diag}(\\alpha d^*) \\, V^{-1}$.\n5.  **Calculate Displacement and Ratio**: Compute the eigenvalues of $A$ and $A+E$. The maximal displacement $s = \\max_j \\min_i |\\lambda_j(A+E) - \\lambda_i(A)|$ is found by pairing each perturbed eigenvalue with the closest original one. Finally, the ratio $s / r_{\\mathrm{BF}}$ is computed.\n\nThis procedure will be applied to all three specified test cases, which are designed to explore regimes of high condition number, moderate condition number, and the ideal orthogonal case ($\\kappa_2(V)=1$).", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Implements the full analysis for the three test cases as specified in the problem.\n    \"\"\"\n\n    test_cases = [\n        # Case 1 (large kappa_2(V))\n        {\n            \"lambdas\": [1.0, -2.0, 4.0],\n            \"theta\": np.pi / 4,\n            \"s_scale\": 1e-2,\n            \"epsilon\": 1e-2,\n            \"v_is_identity\": False\n        },\n        # Case 2 (moderate kappa_2(V))\n        {\n            \"lambdas\": [0.5, -1.5, 3.0],\n            \"theta\": np.pi / 4,\n            \"s_scale\": 0.3,\n            \"epsilon\": 5e-3,\n            \"v_is_identity\": False\n        },\n        # Case 3 (baseline, kappa_2(V)=1)\n        {\n            \"lambdas\": [2.0, 0.0, -1.0],\n            \"theta\": 0.0, # Not used, but for completeness\n            \"s_scale\": 1.0, # Not used\n            \"epsilon\": 1e-3,\n            \"v_is_identity\": True\n        }\n    ]\n\n    results = []\n    \n    # Generate candidate directions 'd' for the search\n    # Deterministic candidates: face centers and vertices of the unit cube\n    det_candidates = []\n    # Face centers\n    for i in range(3):\n        for sign in [-1, 1]:\n            d = np.zeros(3)\n            d[i] = sign\n            det_candidates.append(d)\n    # Vertices\n    for i in [-1, 1]:\n        for j in [-1, 1]:\n            for k in [-1, 1]:\n                det_candidates.append(np.array([i, j, k], dtype=float))\n    \n    # Random candidates\n    rng = np.random.default_rng(seed=42)\n    rand_candidates = rng.uniform(-1, 1, size=(1000, 3))\n    max_abs = np.max(np.abs(rand_candidates), axis=1, keepdims=True)\n    rand_candidates /= max_abs\n    \n    all_candidates_d = np.unique(np.vstack(det_candidates + list(rand_candidates)), axis=0)\n\n    for case in test_cases:\n        Lambda = np.diag(case[\"lambdas\"])\n        epsilon = case[\"epsilon\"]\n\n        # Step 1: Construct Matrices\n        if case[\"v_is_identity\"]:\n            V = np.identity(3)\n        else:\n            theta = case[\"theta\"]\n            s_param = case[\"s_scale\"]\n            W_theta = np.array([\n                [np.cos(theta),  0, np.sin(theta)],\n                [0,              1, 0            ],\n                [-np.sin(theta), 0, np.cos(theta)]\n            ])\n            Sigma = np.diag([1, s_param, s_param**2])\n            V = Sigma @ W_theta.T\n        \n        A = V @ Lambda @ np.linalg.inv(V)\n\n        # Step 2: Compute Condition Number and Bound\n        singular_values_V = np.linalg.svd(V, compute_uv=False)\n        kappa_2_V = singular_values_V[0] / singular_values_V[-1]\n        r_bf = kappa_2_V * epsilon\n\n        # Step 3: Find Adversarial Direction\n        V_inv = np.linalg.inv(V)\n        min_norm_M_d = np.inf\n        best_d = None\n\n        for d in all_candidates_d:\n            M_d = V @ np.diag(d) @ V_inv\n            norm_M_d = np.linalg.norm(M_d, 2)\n            if norm_M_d < min_norm_M_d:\n                min_norm_M_d = norm_M_d\n                best_d = d\n        \n        # Step 4: Construct Perturbation\n        alpha = epsilon / min_norm_M_d\n        Delta = np.diag(alpha * best_d)\n        E = V @ Delta @ V_inv\n        \n        # Verify norm of E\n        # norm_E = np.linalg.norm(E, 2)\n        # assert np.isclose(norm_E, epsilon)\n\n        A_plus_E = A + E\n\n        # Step 5: Calculate Displacement and Ratio\n        # Eigenvalues of A are known, but we recompute for robustness.\n        # They may not be sorted, so we sort them.\n        eigvals_A = np.sort(np.linalg.eigvals(A).real)\n        eigvals_A_plus_E = np.sort(np.linalg.eigvals(A_plus_E).real)\n        \n        # Calculate s = max_j min_i |lambda_j(A+E) - lambda_i(A)|\n        dist_matrix = np.abs(eigvals_A_plus_E[:, np.newaxis] - eigvals_A[np.newaxis, :])\n        min_dists = np.min(dist_matrix, axis=1)\n        s = np.max(min_dists)\n\n        # In this specific structured perturbation, s should be ~alpha.\n        # We use the rigorously computed s as per problem statement.\n        \n        ratio = s / r_bf\n        results.append(ratio)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3585060"}]}