{"hands_on_practices": [{"introduction": "Mastering linear elasticity begins with a solid understanding of the constitutive law that links stress and strain. While Hooke's law can be expressed elegantly using fourth-order tensors, its physical meaning is most clearly revealed in simple loading scenarios. This exercise [@problem_id:3607902] provides practice in this fundamental translation, requiring you to derive the strain response in a classic uniaxial stress test, thereby connecting the abstract isotropic compliance tensor directly to the experimentally measurable parameters of Young’s modulus ($E$) and Poisson’s ratio ($\\nu$).", "problem": "In computational geophysics, laboratory uniaxial loading is used to calibrate elastic parameters for Earth materials that are modeled as homogeneous, isotropic, and linearly elastic at small strain. Consider an infinite, homogeneous, isotropic, linearly elastic solid under a uniform, static Cauchy stress state given by $\\boldsymbol{\\sigma}(\\boldsymbol{x}) = \\sigma_{0}\\,\\boldsymbol{e}_{1}\\otimes\\boldsymbol{e}_{1}$, where $\\sigma_{0}$ is a constant scalar and $\\{\\boldsymbol{e}_{1},\\boldsymbol{e}_{2},\\boldsymbol{e}_{3}\\}$ is an orthonormal basis. Assume infinitesimal kinematics, so the small-strain tensor $\\boldsymbol{\\varepsilon}$ is linearly related to $\\boldsymbol{\\sigma}$ through an isotropic fourth-order compliance tensor characterized solely by Young’s modulus $E$ and Poisson’s ratio $\\nu$. \n\nStarting from the definitions of small strain and Cauchy stress, the linearity of the constitutive map, and the rotational invariance of an isotropic fourth-order tensor, derive the explicit $3\\times 3$ component matrix of the strain tensor $\\boldsymbol{\\varepsilon}$ in the basis $\\{\\boldsymbol{e}_{1},\\boldsymbol{e}_{2},\\boldsymbol{e}_{3}\\}$ for the given uniaxial stress. Express your final result entirely in terms of $\\sigma_{0}$, $E$, and $\\nu$. Present the final answer as the full $3\\times 3$ matrix. No numerical rounding is required, and no units should be included in the final matrix.", "solution": "The setting is static and spatially uniform, so equilibrium introduces no spatial gradients in the fields for this computation. We adopt infinitesimal kinematics, so the small-strain tensor $\\boldsymbol{\\varepsilon}$ is linearly related to the Cauchy stress tensor $\\boldsymbol{\\sigma}$ via a fourth-order compliance tensor $\\mathsf{S}$:\n$$\n\\boldsymbol{\\varepsilon} \\;=\\; \\mathsf{S} : \\boldsymbol{\\sigma},\n$$\nwhere $:$ denotes double contraction. For an isotropic material, rotational invariance constrains any linear fourth-order tensor mapping symmetric second-order tensors to symmetric second-order tensors to have the form\n$$\n\\mathsf{S} \\;=\\; \\alpha\\,\\mathsf{I}_{4}^{\\mathrm{s}} + \\beta\\,\\boldsymbol{I}\\otimes\\boldsymbol{I},\n$$\nwhere $\\mathsf{I}_{4}^{\\mathrm{s}}$ is the symmetric fourth-order identity with components $\\left(\\mathsf{I}_{4}^{\\mathrm{s}}\\right)_{ijkl} = \\tfrac{1}{2}\\left(\\delta_{ik}\\delta_{jl} + \\delta_{il}\\delta_{jk}\\right)$, $\\boldsymbol{I}$ is the second-order identity with components $I_{ij}=\\delta_{ij}$, and $\\alpha,\\beta$ are scalars determined by the material parameters. It is convenient to recast this representation using volumetric and deviatoric projectors. Define the volumetric projector $\\mathsf{J} = \\tfrac{1}{3}\\,\\boldsymbol{I}\\otimes\\boldsymbol{I}$ and the deviatoric projector $\\mathsf{K} = \\mathsf{I}_{4}^{\\mathrm{s}} - \\mathsf{J}$. For isotropic linear elasticity, the compliance admits the standard decomposition\n$$\n\\mathsf{S} \\;=\\; \\frac{1}{2G}\\,\\mathsf{K} \\;+\\; \\frac{1}{9K_{\\mathrm{b}}}\\,\\mathsf{J},\n$$\nwhere $G$ is the shear modulus and $K_{\\mathrm{b}}$ is the bulk modulus. Acting on any symmetric tensor $\\boldsymbol{A}$, these projectors yield $\\mathsf{K}:\\boldsymbol{A} = \\boldsymbol{A} - \\tfrac{1}{3}\\operatorname{tr}(\\boldsymbol{A})\\,\\boldsymbol{I}$ (the deviatoric part) and $\\mathsf{J}:\\boldsymbol{A} = \\tfrac{1}{3}\\operatorname{tr}(\\boldsymbol{A})\\,\\boldsymbol{I}$ (the spherical part). Hence, for stress,\n$$\n\\boldsymbol{\\varepsilon} \\;=\\; \\frac{1}{2G}\\left(\\boldsymbol{\\sigma} - \\frac{1}{3}\\operatorname{tr}(\\boldsymbol{\\sigma})\\,\\boldsymbol{I}\\right) \\;+\\; \\frac{1}{9K_{\\mathrm{b}}}\\,\\operatorname{tr}(\\boldsymbol{\\sigma})\\,\\boldsymbol{I}.\n$$\nTo express this in terms of Young’s modulus $E$ and Poisson’s ratio $\\nu$, we use the well-tested relations\n$$\nG \\;=\\; \\frac{E}{2(1+\\nu)}, \\qquad K_{\\mathrm{b}} \\;=\\; \\frac{E}{3(1-2\\nu)}.\n$$\nTherefore,\n$$\n\\frac{1}{2G} \\;=\\; \\frac{1+\\nu}{E}, \\qquad \\frac{1}{9K_{\\mathrm{b}}} \\;=\\; \\frac{1-2\\nu}{3E}.\n$$\nSubstituting these into the compliance decomposition and combining the spherical terms yields\n$$\n\\boldsymbol{\\varepsilon} \\;=\\; \\frac{1+\\nu}{E}\\,\\boldsymbol{\\sigma} \\;-\\; \\frac{\\nu}{E}\\,\\operatorname{tr}(\\boldsymbol{\\sigma})\\,\\boldsymbol{I}.\n$$\nIndeed,\n$$\n\\frac{1+\\nu}{E}\\left(-\\frac{1}{3}\\operatorname{tr}(\\boldsymbol{\\sigma})\\,\\boldsymbol{I}\\right) \\;+\\; \\frac{1-2\\nu}{3E}\\operatorname{tr}(\\boldsymbol{\\sigma})\\,\\boldsymbol{I} \\;=\\; -\\frac{\\nu}{E}\\operatorname{tr}(\\boldsymbol{\\sigma})\\,\\boldsymbol{I}.\n$$\n\nNow apply the given uniaxial stress state $\\boldsymbol{\\sigma} = \\sigma_{0}\\,\\boldsymbol{e}_{1}\\otimes\\boldsymbol{e}_{1}$, for which $\\operatorname{tr}(\\boldsymbol{\\sigma}) = \\sigma_{0}$. Substitution gives\n$$\n\\boldsymbol{\\varepsilon} \\;=\\; \\frac{1+\\nu}{E}\\,\\sigma_{0}\\,\\boldsymbol{e}_{1}\\otimes\\boldsymbol{e}_{1} \\;-\\; \\frac{\\nu}{E}\\,\\sigma_{0}\\,\\boldsymbol{I}.\n$$\nIn the basis $\\{\\boldsymbol{e}_{1},\\boldsymbol{e}_{2},\\boldsymbol{e}_{3}\\}$, the identity tensor is the diagonal matrix with entries $\\left(1,1,1\\right)$ and $\\boldsymbol{e}_{1}\\otimes\\boldsymbol{e}_{1}$ is the diagonal matrix with entries $\\left(1,0,0\\right)$ along the diagonal. Therefore,\n$$\n\\boldsymbol{\\varepsilon} \\;=\\; \\begin{pmatrix}\n\\dfrac{1+\\nu}{E}\\sigma_{0} - \\dfrac{\\nu}{E}\\sigma_{0} & 0 & 0 \\\\\n0 & - \\dfrac{\\nu}{E}\\sigma_{0} & 0 \\\\\n0 & 0 & - \\dfrac{\\nu}{E}\\sigma_{0}\n\\end{pmatrix}\n\\;=\\;\n\\begin{pmatrix}\n\\dfrac{\\sigma_{0}}{E} & 0 & 0 \\\\\n0 & - \\dfrac{\\nu\\,\\sigma_{0}}{E} & 0 \\\\\n0 & 0 & - \\dfrac{\\nu\\,\\sigma_{0}}{E}\n\\end{pmatrix}.\n$$\nThis shows that the longitudinal normal strain is $\\varepsilon_{11} = \\sigma_{0}/E$ and the lateral normal strains are $\\varepsilon_{22} = \\varepsilon_{33} = -\\nu\\,\\sigma_{0}/E$, with all shear components equal to $0$, consistent with the definitions of Young’s modulus and Poisson’s ratio in uniaxial loading.", "answer": "$$\\boxed{\\begin{pmatrix}\\dfrac{\\sigma_{0}}{E} & 0 & 0 \\\\[6pt] 0 & -\\dfrac{\\nu\\,\\sigma_{0}}{E} & 0 \\\\[6pt] 0 & 0 & -\\dfrac{\\nu\\,\\sigma_{0}}{E}\\end{pmatrix}}$$", "id": "3607902"}, {"introduction": "Geophysical systems are inherently three-dimensional, but computational models often rely on 2D simplifications to remain tractable. This practice [@problem_id:3607937] delves into the two most common assumptions—plane stress and plane strain—by deriving their respective constitutive laws from the full 3D theory. By then comparing these idealized models to a more general case with partial out-of-plane constraints, you will develop a quantitative understanding of the modeling errors involved, a critical skill for any computational geophysicist who must justify their modeling choices.", "problem": "Consider a homogeneous, isotropic, linearly elastic solid occupying a geologic cross-section in the $x$–$y$ plane, with small deformations and static equilibrium (no body forces). You will derive reductions of three-dimensional linear elasticity to two-dimensional assumptions and then quantify the modeling error incurred when those assumptions are used to approximate out-of-plane response in the presence of out-of-plane constraints.\n\nStarting from the principles of linear momentum balance in the absence of body forces, the definition of small strain, and the form of isotropic linear elastic response (Hooke’s law) in three dimensions, carry out the following:\n\n1) Derive the reduced two-dimensional constitutive relations for plane stress (assume $\\sigma_{zz} = 0$) and for plane strain (assume $\\varepsilon_{zz} = 0$) in terms of the in-plane stress and strain components and the material parameters (Young’s modulus $E$ and Poisson’s ratio $\\nu$). Your derivation must be from first principles only.\n\n2) Model an out-of-plane constraint that reacts linearly to out-of-plane strain using an effective stiffness per unit area $K$ (units of pressure) that enforces a constitutive closure of the form $\\sigma_{zz} + K \\, \\varepsilon_{zz} = 0$. Use this closure together with three-dimensional isotropic linear elasticity to eliminate $\\varepsilon_{zz}$ and $\\sigma_{zz}$ in favor of the in-plane strains $\\varepsilon_{xx}$ and $\\varepsilon_{yy}$ for a spatially homogeneous strain state. Express $\\varepsilon_{zz}$ and $\\sigma_{zz}$ as functions of $E$, $\\nu$, $K$, and the in-plane strain trace $\\varepsilon_{xx} + \\varepsilon_{yy}$.\n\n3) Define the following modeling errors for a given in-plane homogeneous strain state:\n- Plane-stress model errors: $\\Delta \\sigma_{zz}^{\\mathrm{ps}} = \\sigma_{zz}^{\\mathrm{ps}} - \\sigma_{zz}^{\\mathrm{true}}$ and $\\Delta \\varepsilon_{zz}^{\\mathrm{ps}} = \\varepsilon_{zz}^{\\mathrm{ps}} - \\varepsilon_{zz}^{\\mathrm{true}}$.\n- Plane-strain model errors: $\\Delta \\sigma_{zz}^{\\mathrm{pe}} = \\sigma_{zz}^{\\mathrm{pe}} - \\sigma_{zz}^{\\mathrm{true}}$ and $\\Delta \\varepsilon_{zz}^{\\mathrm{pe}} = \\varepsilon_{zz}^{\\mathrm{pe}} - \\varepsilon_{zz}^{\\mathrm{true}}$.\n\nHere, $(\\cdot)^{\\mathrm{true}}$ denotes the solution obtained with the out-of-plane constraint $\\sigma_{zz} + K \\, \\varepsilon_{zz} = 0$, $(\\cdot)^{\\mathrm{ps}}$ denotes the plane-stress assumption, and $(\\cdot)^{\\mathrm{pe}}$ denotes the plane-strain assumption.\n\n4) Implement a program that computes the four error quantities above for the following test suite of parameter sets. Each parameter set is given as a tuple $(E, \\nu, \\varepsilon_{xx}, \\varepsilon_{yy}, \\gamma_{xy}, K)$, with $E$ and $K$ expressed in gigapascal (GPa), and strains dimensionless:\n- Test $1$ (free out-of-plane, boundary case where plane stress is exact): $(50, \\, 0.25, \\, 1\\times 10^{-4}, \\, 2\\times 10^{-4}, \\, 5\\times 10^{-5}, \\, 0)$.\n- Test $2$ (very stiff out-of-plane, near plane strain): $(70, \\, 0.33, \\, 1\\times 10^{-5}, \\, 3\\times 10^{-5}, \\, 0, \\, 10^{5})$.\n- Test $3$ (zero in-plane volumetric strain, boundary case where both are exact): $(25, \\, 0.20, \\, 1\\times 10^{-4}, \\, -1\\times 10^{-4}, \\, 1\\times 10^{-5}, \\, 10)$.\n- Test $4$ (moderate partial constraint): $(40, \\, 0.30, \\, 2\\times 10^{-4}, \\, 1\\times 10^{-4}, \\, 2\\times 10^{-5}, \\, 40)$.\n\nYour program must:\n- Convert $E$ and $K$ from gigapascal (GPa) to pascal (Pa) using $1 \\, \\mathrm{GPa} = 10^{9} \\, \\mathrm{Pa}$.\n- Use only the in-plane strain trace $\\varepsilon_{xx} + \\varepsilon_{yy}$ to compute $\\varepsilon_{zz}$ and $\\sigma_{zz}$ for the homogeneous state, as all other in-plane components do not influence $\\sigma_{zz}$ or $\\varepsilon_{zz}$ in isotropic linear elasticity under the stated assumptions.\n- Express the stress errors $\\Delta \\sigma_{zz}^{\\mathrm{ps}}$ and $\\Delta \\sigma_{zz}^{\\mathrm{pe}}$ in megapascal (MPa), and express the strain errors $\\Delta \\varepsilon_{zz}^{\\mathrm{ps}}$ and $\\Delta \\varepsilon_{zz}^{\\mathrm{pe}}$ as dimensionless numbers.\n- Round each reported number to six digits after the decimal point.\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. For each test case, append the four values in the following order:\n$[ \\Delta \\sigma_{zz}^{\\mathrm{ps}} \\, (\\mathrm{MPa}), \\, \\Delta \\varepsilon_{zz}^{\\mathrm{ps}}, \\, \\Delta \\sigma_{zz}^{\\mathrm{pe}} \\, (\\mathrm{MPa}), \\, \\Delta \\varepsilon_{zz}^{\\mathrm{pe}} ]$,\nso that the final line contains $4 \\times 4 = 16$ numbers, corresponding to the four test cases in the order listed above. For example, the output should look like $[r_{1}, r_{2}, \\dots, r_{16}]$ where each $r_{i}$ is a float rounded as specified.", "solution": "The problem statement is assessed to be valid. It is scientifically grounded in the principles of linear elasticity, well-posed, objective, and internally consistent. All necessary data and definitions for a unique solution are provided. The problem constitutes a substantive exercise in continuum mechanics, requiring derivation from fundamental principles and subsequent numerical application.\n\nThe solution proceeds by first deriving the necessary constitutive relations for the two-dimensional idealizations (plane stress and plane strain) and for the specified out-of-plane constraint model, which represents the true behavior. Subsequently, the error metrics are formulated and then calculated for the provided test cases.\n\nThe starting point for all derivations is the three-dimensional Hooke's law for a homogeneous, isotropic, linearly elastic material, which relates the strain tensor components $\\varepsilon_{ij}$ to the stress tensor components $\\sigma_{ij}$ using Young's modulus $E$ and Poisson's ratio $\\nu$. The relevant strain-stress equations are:\n$$ \\varepsilon_{xx} = \\frac{1}{E} [ \\sigma_{xx} - \\nu (\\sigma_{yy} + \\sigma_{zz}) ] $$\n$$ \\varepsilon_{yy} = \\frac{1}{E} [ \\sigma_{yy} - \\nu (\\sigma_{xx} + \\sigma_{zz}) ] $$\n$$ \\varepsilon_{zz} = \\frac{1}{E} [ \\sigma_{zz} - \\nu (\\sigma_{xx} + \\sigma_{yy}) ] $$\nThe shear strain $\\gamma_{xy} = 2\\varepsilon_{xy}$ is related to the shear stress $\\sigma_{xy}$ by $\\sigma_{xy} = G \\gamma_{xy}$, where $G = \\frac{E}{2(1+\\nu)}$ is the shear modulus. For an isotropic material, the normal stress components are uncoupled from the shear strain components. Thus, $\\sigma_{zz}$ and $\\varepsilon_{zz}$ are independent of $\\gamma_{xy}$.\n\nAn alternative and often more direct formulation uses the Lamé parameters, $\\lambda = \\frac{E\\nu}{(1+\\nu)(1-2\\nu)}$ and $\\mu=G$. The stress-strain relations are given by $\\sigma_{ij} = \\lambda \\varepsilon_v \\delta_{ij} + 2\\mu \\varepsilon_{ij}$, where $\\varepsilon_v = \\varepsilon_{xx} + \\varepsilon_{yy} + \\varepsilon_{zz}$ is the volumetric strain and $\\delta_{ij}$ is the Kronecker delta.\n\n**1. Derivation of 2D Constitutive Relations**\n\n**Plane Stress:** The plane stress assumption is $\\sigma_{zz} = \\sigma_{xz} = \\sigma_{yz} = 0$. We are concerned with the out-of-plane normal components. The assumption is $\\sigma_{zz} = 0$. Substituting this into the 3D Hooke's law for $\\varepsilon_{zz}$ yields:\n$$ \\varepsilon_{zz} = -\\frac{\\nu}{E}(\\sigma_{xx} + \\sigma_{yy}) $$\nTo find the constitutive relation between in-plane stresses and strains, we first solve the in-plane strain equations for the stresses under the condition $\\sigma_{zz}=0$:\n$$ \\varepsilon_{xx} = \\frac{1}{E} (\\sigma_{xx} - \\nu \\sigma_{yy}) $$\n$$ \\varepsilon_{yy} = \\frac{1}{E} (\\sigma_{yy} - \\nu \\sigma_{xx}) $$\nSolving this system of linear equations for $\\sigma_{xx}$ and $\\sigma_{yy}$ yields the plane stress constitutive law:\n$$ \\sigma_{xx} = \\frac{E}{1-\\nu^2}(\\varepsilon_{xx} + \\nu\\varepsilon_{yy}) $$\n$$ \\sigma_{yy} = \\frac{E}{1-\\nu^2}(\\varepsilon_{yy} + \\nu\\varepsilon_{xx}) $$\nTo determine the out-of-plane strain $\\varepsilon_{zz}^{\\mathrm{ps}}$ for a given in-plane strain state $(\\varepsilon_{xx}, \\varepsilon_{yy})$, we sum the two equations above to find the in-plane stress sum:\n$$ \\sigma_{xx} + \\sigma_{yy} = \\frac{E}{1-\\nu^2}( (1+\\nu)\\varepsilon_{xx} + (1+\\nu)\\varepsilon_{yy} ) = \\frac{E}{1-\\nu}(\\varepsilon_{xx} + \\varepsilon_{yy}) $$\nSubstituting this into the expression for $\\varepsilon_{zz}$ gives the out-of-plane normal strain under the plane stress assumption:\n$$ \\varepsilon_{zz}^{\\mathrm{ps}} = -\\frac{\\nu}{E} \\left( \\frac{E}{1-\\nu}(\\varepsilon_{xx} + \\varepsilon_{yy}) \\right) = -\\frac{\\nu}{1-\\nu}(\\varepsilon_{xx} + \\varepsilon_{yy}) $$\n\n**Plane Strain:** The plane strain assumption is $\\varepsilon_{zz} = \\varepsilon_{xz} = \\varepsilon_{yz} = 0$. The condition is $\\varepsilon_{zz} = 0$. This implies that there can be a non-zero stress $\\sigma_{zz}$ required to hold the strain at zero. From the 3D Hooke's law for $\\varepsilon_{zz}$:\n$$ 0 = \\frac{1}{E} [ \\sigma_{zz} - \\nu (\\sigma_{xx} + \\sigma_{yy}) ] \\implies \\sigma_{zz} = \\nu (\\sigma_{xx} + \\sigma_{yy}) $$\nThis shows $\\sigma_{zz}$ is generally non-zero. To find the plane strain constitutive law, we use the formulation with Lamé parameters, which is more direct. With $\\varepsilon_{zz}=0$, the volumetric strain is $\\varepsilon_v = \\varepsilon_{xx} + \\varepsilon_{yy}$. The stresses are:\n$$ \\sigma_{xx} = \\lambda(\\varepsilon_{xx} + \\varepsilon_{yy}) + 2\\mu\\varepsilon_{xx} $$\n$$ \\sigma_{yy} = \\lambda(\\varepsilon_{xx} + \\varepsilon_{yy}) + 2\\mu\\varepsilon_{yy} $$\nSubstituting the expressions for $\\lambda$ and $\\mu$ in terms of $E$ and $\\nu$ gives the relations:\n$$ \\sigma_{xx} = \\frac{E}{(1+\\nu)(1-2\\nu)}[(1-\\nu)\\varepsilon_{xx} + \\nu\\varepsilon_{yy}] $$\n$$ \\sigma_{yy} = \\frac{E}{(1+\\nu)(1-2\\nu)}[(1-\\nu)\\varepsilon_{yy} + \\nu\\varepsilon_{xx}] $$\nThe out-of-plane stress $\\sigma_{zz}^{\\mathrm{pe}}$ is found from the relation $\\sigma_{zz} = \\lambda \\varepsilon_v$:\n$$ \\sigma_{zz}^{\\mathrm{pe}} = \\frac{E\\nu}{(1+\\nu)(1-2\\nu)}(\\varepsilon_{xx} + \\varepsilon_{yy}) $$\n\n**2. Derivation for Out-of-Plane Constraint Model**\n\nThis model, which we denote with superscript $(\\cdot)^{\\mathrm{true}}$, is defined by the constraint $\\sigma_{zz} + K \\varepsilon_{zz} = 0$, where $K$ is an effective stiffness.\nWe use this constraint along with the 3D stress-strain law for $\\sigma_{zz}$:\n$$ \\sigma_{zz} = \\lambda(\\varepsilon_{xx} + \\varepsilon_{yy} + \\varepsilon_{zz}) + 2\\mu\\varepsilon_{zz} $$\nSubstitute $\\sigma_{zz} = -K\\varepsilon_{zz}$:\n$$ -K\\varepsilon_{zz} = \\lambda(\\varepsilon_{xx} + \\varepsilon_{yy}) + (\\lambda+2\\mu)\\varepsilon_{zz} $$\nWe solve for $\\varepsilon_{zz}$:\n$$ -(\\lambda(\\varepsilon_{xx} + \\varepsilon_{yy})) = (K + \\lambda + 2\\mu)\\varepsilon_{zz} $$\n$$ \\varepsilon_{zz}^{\\mathrm{true}} = -\\frac{\\lambda}{K + \\lambda+2\\mu}(\\varepsilon_{xx} + \\varepsilon_{yy}) $$\nTo express this in terms of $E$, $\\nu$, and $K$, we substitute $\\lambda = \\frac{E\\nu}{(1+\\nu)(1-2\\nu)}$ and $\\lambda+2\\mu = \\frac{E(1-\\nu)}{(1+\\nu)(1-2\\nu)}$:\n$$ \\varepsilon_{zz}^{\\mathrm{true}} = -\\frac{\\frac{E\\nu}{(1+\\nu)(1-2\\nu)}}{K + \\frac{E(1-\\nu)}{(1+\\nu)(1-2\\nu)}}(\\varepsilon_{xx} + \\varepsilon_{yy}) $$\nMultiplying numerator and denominator by $(1+\\nu)(1-2\\nu)$ simplifies this to:\n$$ \\varepsilon_{zz}^{\\mathrm{true}} = -\\frac{E\\nu}{K(1+\\nu)(1-2\\nu) + E(1-\\nu)}(\\varepsilon_{xx} + \\varepsilon_{yy}) $$\nThe corresponding out-of-plane stress is found from the constraint:\n$$ \\sigma_{zz}^{\\mathrm{true}} = -K\\varepsilon_{zz}^{\\mathrm{true}} = \\frac{KE\\nu}{K(1+\\nu)(1-2\\nu) + E(1-\\nu)}(\\varepsilon_{xx} + \\varepsilon_{yy}) $$\n\n**3. Modeling Error Calculation**\n\nWe now have all the necessary expressions. Let $\\varepsilon_{trace} = \\varepsilon_{xx} + \\varepsilon_{yy}$.\nThe out-of-plane quantities for the three models are:\n**True Model:**\n$$ \\sigma_{zz}^{\\mathrm{true}} = \\frac{KE\\nu}{K(1+\\nu)(1-2\\nu) + E(1-\\nu)} \\varepsilon_{trace} $$\n$$ \\varepsilon_{zz}^{\\mathrm{true}} = -\\frac{E\\nu}{K(1+\\nu)(1-2\\nu) + E(1-\\nu)} \\varepsilon_{trace} $$\n**Plane Stress Model:**\n$$ \\sigma_{zz}^{\\mathrm{ps}} = 0 $$\n$$ \\varepsilon_{zz}^{\\mathrm{ps}} = -\\frac{\\nu}{1-\\nu} \\varepsilon_{trace} $$\n**Plane Strain Model:**\n$$ \\sigma_{zz}^{\\mathrm{pe}} = \\frac{E\\nu}{(1+\\nu)(1-2\\nu)} \\varepsilon_{trace} $$\n$$ \\varepsilon_{zz}^{\\mathrm{pe}} = 0 $$\n\nThe modeling errors are computed as follows:\n- $\\Delta \\sigma_{zz}^{\\mathrm{ps}} = \\sigma_{zz}^{\\mathrm{ps}} - \\sigma_{zz}^{\\mathrm{true}} = -\\sigma_{zz}^{\\mathrm{true}}$\n- $\\Delta \\varepsilon_{zz}^{\\mathrm{ps}} = \\varepsilon_{zz}^{\\mathrm{ps}} - \\varepsilon_{zz}^{\\mathrm{true}}$\n- $\\Delta \\sigma_{zz}^{\\mathrm{pe}} = \\sigma_{zz}^{\\mathrm{pe}} - \\sigma_{zz}^{\\mathrm{true}}$\n- $\\Delta \\varepsilon_{zz}^{\\mathrm{pe}} = \\varepsilon_{zz}^{\\mathrm{pe}} - \\varepsilon_{zz}^{\\mathrm{true}} = -\\varepsilon_{zz}^{\\mathrm{true}}$\n\nThese formulae will be implemented to compute the errors for the specified test cases. The material parameters $E$ and $K$ are converted from GPa to Pa ($1\\,\\mathrm{GPa} = 10^9\\,\\mathrm{Pa}$), and the resulting stress errors are converted to MPa ($1\\,\\mathrm{MPa} = 10^6\\,\\mathrm{Pa}$) for reporting.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes modeling errors for plane stress and plane strain assumptions\n    relative to a more general out-of-plane constraint model in linear elasticity.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each tuple is (E, nu, eps_xx, eps_yy, gam_xy, K)\n    # E and K are in GPa, strains are dimensionless.\n    test_cases = [\n        (50.0, 0.25, 1e-4, 2e-4, 5e-5, 0.0),      # Test 1: Plane stress case\n        (70.0, 0.33, 1e-5, 3e-5, 0.0, 1e5),       # Test 2: Near plane strain case\n        (25.0, 0.20, 1e-4, -1e-4, 1e-5, 10.0),    # Test 3: Zero in-plane volumetric strain\n        (40.0, 0.30, 2e-4, 1e-4, 2e-5, 40.0),     # Test 4: Moderate constraint\n    ]\n\n    all_results = []\n    \n    # Conversion factors\n    GPA_TO_PA = 1e9\n    PA_TO_MPA = 1e-6\n\n    for case in test_cases:\n        E_gpa, nu, eps_xx, eps_yy, _, K_gpa = case\n        \n        # Convert units from GPa to Pa\n        E = E_gpa * GPA_TO_PA\n        K = K_gpa * GPA_TO_PA\n        \n        # In-plane strain trace\n        eps_trace = eps_xx + eps_yy\n\n        # --- Calculate quantities for the \"true\" model ---\n        # Denominator for the true model expressions\n        denom_true = K * (1 + nu) * (1 - 2 * nu) + E * (1 - nu)\n        \n        # Handle cases where denominator might be zero, though not expected here\n        if np.isclose(denom_true, 0):\n            # This would correspond to unphysical material properties\n            eps_zz_true = 0.0\n        else:\n            eps_zz_true = - (E * nu * eps_trace) / denom_true\n        \n        sig_zz_true = -K * eps_zz_true\n\n        # --- Calculate quantities for the plane stress (ps) model ---\n        sig_zz_ps = 0.0\n        if np.isclose(1 - nu, 0): # nu = 1, unphysical\n            eps_zz_ps = 0.0\n        else:\n            eps_zz_ps = -nu / (1 - nu) * eps_trace\n\n        # --- Calculate quantities for the plane strain (pe) model ---\n        eps_zz_pe = 0.0\n        denom_pe = (1 + nu) * (1 - 2 * nu)\n        if np.isclose(denom_pe, 0): # nu = -1 or nu = 0.5, unphysical\n            sig_zz_pe = 0.0\n        else:\n            sig_zz_pe = (E * nu * eps_trace) / denom_pe\n            \n        # --- Calculate the four error quantities ---\n        # Plane-stress model errors\n        delta_sigma_zz_ps = (sig_zz_ps - sig_zz_true) * PA_TO_MPA # in MPa\n        delta_epsilon_zz_ps = eps_zz_ps - eps_zz_true           # dimensionless\n\n        # Plane-strain model errors\n        delta_sigma_zz_pe = (sig_zz_pe - sig_zz_true) * PA_TO_MPA # in MPa\n        delta_epsilon_zz_pe = eps_zz_pe - eps_zz_true           # dimensionless\n        \n        # Append results for the current test case\n        all_results.extend([delta_sigma_zz_ps, delta_epsilon_zz_ps, delta_sigma_zz_pe, delta_epsilon_zz_pe])\n\n    # Format results to six decimal places as required by the problem\n    formatted_results = [f\"{r:.6f}\" for r in all_results]\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "3607937"}, {"introduction": "While forward modeling predicts the physical response to a given set of causes, much of computational geophysics is dedicated to the inverse problem: inferring unknown causes or properties from observed data. This advanced exercise [@problem_id:3607889] introduces one of the most powerful and efficient techniques for this task—the adjoint-state method. You will derive the adjoint system for a 1D elastic problem from first principles and use it to compute the gradient of a data misfit functional, taking the first step in a gradient-based inversion to find the body force that best explains a set of displacement observations.", "problem": "You are tasked with deriving, discretizing, and implementing the adjoint-state method for minimizing the data misfit in static, linear isotropic elasticity in one spatial dimension. Begin from first principles valid in computational geophysics for linear elasticity and the balance of linear momentum. The aim is to minimize the data misfit functional subject to the governing Partial Differential Equation (PDE) constraint, and to implement one gradient descent update of the distributed body force field using the adjoint gradient. All outputs must be expressed in the International System of Units (SI).\n\nFundamental base and governing equations:\n- The balance of linear momentum (static case, no inertia) states that the divergence of the stress plus the body force equals zero: $$\\nabla \\cdot \\sigma(u) + f = 0.$$\n- For isotropic linear elasticity, Hooke's law relates stress and strain. In general dimension, $$\\sigma = \\lambda (\\nabla \\cdot u) I + 2 \\mu \\varepsilon(u),$$ where $$\\varepsilon(u) = \\frac{1}{2}\\left( \\nabla u + (\\nabla u)^{\\top} \\right),$$ the Lamé parameters are $$\\lambda$$ and $$\\mu,$$ and $$I$$ is the identity tensor.\n- In one spatial dimension with scalar displacement $$u(x),$$ this reduces to $$\\sigma(u) = (\\lambda + 2 \\mu) \\frac{du}{dx},$$ so the PDE becomes $$\\frac{d}{dx}\\left( (\\lambda + 2 \\mu) \\frac{du}{dx} \\right) + f(x) = 0.$$\n- Assume spatially uniform parameters $$\\lambda$$ and $$\\mu,$$ and homogeneous Dirichlet boundary conditions $$u(0) = 0$$ and $$u(L) = 0$$ on a domain of length $$L.$$\n\nObjective:\n- The misfit is $$\\Phi(u) = \\frac{1}{2} \\| W(u - d) \\|^2,$$ where $$W$$ is a diagonal weighting operator that selects observed locations and $$d$$ are observed displacements. The norm is the standard Euclidean norm. The weighting means $$W^{\\top} W$$ equals the diagonal matrix of squared weights.\n- Treat the body force $$f(x)$$ as the control variable to be updated by one gradient descent step using the adjoint-state method. The state variable is $$u(x),$$ constrained by the PDE.\n\nAdjoint-state derivation requirements:\n- Formulate the Lagrangian $$\\mathcal{L}(u, f, p) = \\Phi(u) + \\langle p, \\mathcal{A} u + f \\rangle,$$ where $$\\mathcal{A} u = \\nabla \\cdot \\sigma(u)$$ and $$p(x)$$ is the adjoint variable (Lagrange multiplier), with inner product $$\\langle \\cdot, \\cdot \\rangle$$ being the standard $$L^2$$ inner product.\n- Derive the adjoint equation by stationarity with respect to $$u$$ and explain why the adjoint operator equals the forward operator (self-adjointness under homogeneous Dirichlet boundary conditions).\n- Derive the gradient of $$\\Phi$$ with respect to $$f$$ using the Lagrangian and show its explicit expression in terms of the adjoint field.\n\nDiscretization requirements:\n- Discretize the domain $$[0, L]$$ into $$N$$ interior points with uniform spacing $$h = \\frac{L}{N + 1},$$ enforcing homogeneous Dirichlet boundary conditions at the boundaries.\n- Use second-order central finite differences to discretize the operator $$\\mathcal{A} u = (\\lambda + 2 \\mu) \\frac{d^2 u}{dx^2},$$ resulting in a tridiagonal matrix $A \\in \\mathbb{R}^{N \\times N}$ with $A = \\frac{\\lambda + 2 \\mu}{h^2} \\operatorname{tridiag}(1, -2, 1)$.\n- Given a discrete force $f \\in \\mathbb{R}^N$, solve the forward state by $A u = - f$. Let the discrete weights be $w_i \\ge 0$ and define $W^{\\top} W$ as $\\operatorname{diag}(w_i^2)$. If an index is not observed, set $w_i = 0$ and $d_i = 0$.\n- Derive and implement the adjoint system $A p = - W^{\\top} W (u - d)$, and the gradient $\\nabla_f \\Phi = p$.\n- Perform one gradient descent update $f_{\\text{new}} = f - \\alpha p$ for a given step size $\\alpha > 0$, then compute the updated misfit $\\Phi(u_{\\text{new}}) = \\frac{1}{2} \\sum_{i=1}^N w_i^2 (u_{\\text{new}, i} - d_i)^2$.\n\nPhysical units:\n- $$L$$ must be in meters (m).\n- $$\\lambda$$ and $$\\mu$$ must be in Pascals (Pa).\n- $$f$$ must be in Newton per cubic meter (N/m^3).\n- $$u$$ must be in meters (m).\n- The final misfit $$\\Phi(u)$$ must be reported in square meters (m^2) and printed as a floating-point number. Angles are not used; percentages are not used.\n\nTest suite and program output format:\n- Implement the following three test cases, each producing one floating-point misfit value after a single gradient descent update. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[result1,result2,result3]\").\n\nTest Case 1 (general case):\n- $$L = 1.0 \\text{ m}, \\quad N = 50.$$\n- $$\\lambda = 1.5 \\times 10^9 \\text{ Pa}, \\quad \\mu = 8.0 \\times 10^8 \\text{ Pa}.$$\n- True force $f_{\\text{true}}(x) = A \\exp\\left( - \\frac{(x - x_0)^2}{2 \\sigma^2} \\right)$ with $A = 1.0 \\times 10^6 \\text{ N/m}^3, \\quad x_0 = 0.5 \\text{ m}, \\quad \\sigma = 0.1 \\text{ m}$.\n- Observed indices $$\\{10, 25, 40\\}$$ with weights $w_i = 1$. Elsewhere $w_i = 0$.\n- Data $d_i$ equals the forward displacement at those observed indices generated from $f_{\\text{true}}$. Initial force $f = 0$.\n- Step size $\\alpha = 1.0 \\times 10^{-4}$.\n\nTest Case 2 (boundary-dominant observation, stiff medium):\n- $$L = 1.0 \\text{ m}, \\quad N = 50.$$\n- $$\\lambda = 3.0 \\times 10^{10} \\text{ Pa}, \\quad \\mu = 2.0 \\times 10^{10} \\text{ Pa}.$$\n- True force $f_{\\text{true}}(x) = A \\exp\\left( - \\frac{(x - x_0)^2}{2 \\sigma^2} \\right)$ with $A = 5.0 \\times 10^6 \\text{ N/m}^3, \\quad x_0 = 0.2 \\text{ m}, \\quad \\sigma = 0.08 \\text{ m}$.\n- Observed index $$\\{1\\}$$ with weight $w_1 = 1$. Elsewhere $w_i = 0$.\n- Data $d_i$ equals the forward displacement at the observed index generated from $f_{\\text{true}}$. Initial force $f = 0$.\n- Step size $\\alpha = 5.0 \\times 10^{-5}$.\n\nTest Case 3 (low shear modulus, multiple observations):\n- $$L = 1.0 \\text{ m}, \\quad N = 50.$$\n- $$\\lambda = 1.0 \\times 10^9 \\text{ Pa}, \\quad \\mu = 1.0 \\times 10^7 \\text{ Pa}.$$\n- True force $f_{\\text{true}}(x) = A \\exp\\left( - \\frac{(x - x_0)^2}{2 \\sigma^2} \\right)$ with $A = 2.0 \\times 10^6 \\text{ N/m}^3, \\quad x_0 = 0.8 \\text{ m}, \\quad \\sigma = 0.05 \\text{ m}$.\n- Observed indices $$\\{15, 35\\}$$ with weights $w_i = 1$. Elsewhere $w_i = 0$.\n- Data $d_i$ equals the forward displacement at those observed indices generated from $f_{\\text{true}}$. Initial force $f = 0$.\n- Step size $\\alpha = 1.0 \\times 10^{-4}$.\n\nSpecification:\n- Your program must build the discrete operator $A$, generate the synthetic data $d$ per test case, solve the forward problem for the initial $f$, solve the adjoint equation, perform one gradient descent update for $f$, solve the forward problem for the updated $f$, compute the final misfit $\\Phi(u_{\\text{new}})$, and output the three misfit values in a list format \"[result1,result2,result3]\".", "solution": "The problem requires the derivation and implementation of the adjoint-state method to perform one gradient descent update for an inverse problem in one-dimensional static linear elasticity. The goal is to minimize a data misfit functional by updating the distributed body force field $f(x)$.\n\nThe analysis begins with the continuous formulation, based on the provided governing equations and objective function. We formulate a Lagrangian to incorporate the PDE constraint into the minimization problem.\n\n**1. Continuous Formulation and Adjoint-State Derivation**\n\nThe forward problem is governed by the PDE for the displacement $u(x)$ on the domain $[0, L]$:\n$$ \\mathcal{A} u + f = 0 \\quad \\text{with} \\quad u(0) = u(L) = 0 $$\nwhere the operator $\\mathcal{A}$ for constant Lamé parameters $\\lambda$ and $\\mu$ is defined as:\n$$ \\mathcal{A} u = \\frac{d}{dx}\\left( (\\lambda + 2 \\mu) \\frac{du}{dx} \\right) = (\\lambda + 2 \\mu) \\frac{d^2u}{dx^2} $$\nThe objective is to minimize the misfit functional $\\Phi(u)$:\n$$ \\Phi(u) = \\frac{1}{2} \\| W(u - d) \\|^2 $$\nwhere $d$ represents the observed displacement data and $W$ is a weighting operator. The notation $\\| \\cdot \\|$ represents the standard Euclidean norm, which in the continuous context corresponds to the $L^2$ norm, so $\\Phi(u) = \\frac{1}{2} \\int_0^L (W(u-d))^2 dx$. We treat the body force $f(x)$ as the control variable.\n\nTo solve this constrained optimization problem, we introduce the Lagrangian $\\mathcal{L}$, with $p(x)$ as the adjoint variable (a Lagrange multiplier field):\n$$ \\mathcal{L}(u, f, p) = \\Phi(u) + \\langle p, \\mathcal{A} u + f \\rangle $$\nThe inner product $\\langle a, b \\rangle$ is the $L^2$ inner product, $\\int_0^L a(x) b(x) dx$. The optimality conditions are found by setting the partial Fréchet derivatives of $\\mathcal{L}$ with respect to each variable to zero.\n\n**Derivation of the Adjoint Equation:**\nWe require the derivative of $\\mathcal{L}$ with respect to the state variable $u$ to be zero. Let's find the variation of $\\mathcal{L}$ with respect to a change $\\delta u$ in $u$:\n$$ \\delta_u \\mathcal{L} = \\frac{d}{d\\epsilon} \\mathcal{L}(u + \\epsilon \\delta u, f, p) \\Big|_{\\epsilon=0} = 0 $$\nThe variation of the misfit term is:\n$$ \\frac{d}{d\\epsilon} \\left( \\frac{1}{2} \\langle W(u + \\epsilon \\delta u - d), W(u + \\epsilon \\delta u - d) \\rangle \\right) \\Big|_{\\epsilon=0} = \\langle W^{\\top}W(u-d), \\delta u \\rangle $$\nThe variation of the constraint term is:\n$$ \\frac{d}{d\\epsilon} \\left( \\langle p, \\mathcal{A}(u + \\epsilon \\delta u) + f \\rangle \\right) \\Big|_{\\epsilon=0} = \\langle p, \\mathcal{A} \\delta u \\rangle $$\nThus, the stationarity condition for $u$ is:\n$$ \\delta_u \\mathcal{L} = \\langle W^{\\top}W(u-d), \\delta u \\rangle + \\langle p, \\mathcal{A} \\delta u \\rangle = 0 $$\nTo make this expression independent of $\\delta u$, we use integration by parts on the second term. The operator $\\mathcal{A}$ has an associated adjoint operator $\\mathcal{A}^*$ defined by $\\langle p, \\mathcal{A} \\delta u \\rangle = \\langle \\mathcal{A}^* p, \\delta u \\rangle$.\n$$ \\langle p, \\mathcal{A} \\delta u \\rangle = \\int_0^L p \\left( (\\lambda + 2\\mu) \\frac{d^2(\\delta u)}{dx^2} \\right) dx $$\nIntegrating by parts twice:\n$$ (\\lambda + 2\\mu) \\int_0^L p \\frac{d^2(\\delta u)}{dx^2} dx = (\\lambda + 2\\mu) \\left[ p \\frac{d(\\delta u)}{dx} \\right]_0^L - (\\lambda + 2\\mu) \\int_0^L \\frac{dp}{dx} \\frac{d(\\delta u)}{dx} dx $$\n$$ = (\\lambda + 2\\mu) \\left[ p \\frac{d(\\delta u)}{dx} - \\frac{dp}{dx} \\delta u \\right]_0^L + (\\lambda + 2\\mu) \\int_0^L \\frac{d^2p}{dx^2} \\delta u \\, dx $$\nThe boundary conditions for the forward problem are homogeneous Dirichlet, $u(0)=u(L)=0$. The variation $\\delta u$ must respect these constraints, so $\\delta u(0) = \\delta u(L) = 0$. For the boundary terms to vanish, we choose homogeneous Dirichlet boundary conditions for the adjoint variable as well, $p(0)=p(L)=0$. This leads to:\n$$ \\langle p, \\mathcal{A} \\delta u \\rangle = \\int_0^L \\left( (\\lambda + 2\\mu) \\frac{d^2p}{dx^2} \\right) \\delta u \\, dx = \\langle \\mathcal{A} p, \\delta u \\rangle $$\nThis demonstrates that the operator $\\mathcal{A}$ is self-adjoint ($\\mathcal{A}^* = \\mathcal{A}$) under these boundary conditions. The stationarity condition becomes:\n$$ \\langle W^{\\top}W(u-d) + \\mathcal{A} p, \\delta u \\rangle = 0 $$\nSince this must hold for all admissible variations $\\delta u$, the term in the inner product must be zero. This gives the **adjoint equation**:\n$$ \\mathcal{A} p + W^{\\top}W(u-d) = 0 \\quad \\text{with} \\quad p(0) = p(L) = 0 $$\n\n**Derivation of the Gradient:**\nThe gradient of the misfit $\\Phi$ with respect to the control variable $f$ is found by taking the total derivative of $\\Phi$ with respect to $f$. The adjoint method simplifies this by noting that $d\\Phi/df = d\\mathcal{L}/df$. The total derivative of $\\mathcal{L}$ with respect to $f$ is:\n$$ \\frac{d\\mathcal{L}}{df} = \\frac{\\partial \\mathcal{L}}{\\partial f} + \\frac{\\partial \\mathcal{L}}{\\partial u} \\frac{du}{df} $$\nBy construction, the adjoint variable $p$ is chosen such that the stationarity condition $\\delta_u \\mathcal{L} = 0$ is satisfied. This implies that the Fréchet derivative $\\partial \\mathcal{L}/\\partial u = 0$. Therefore, the second term vanishes, and the gradient calculation is simplified to the partial derivative:\n$$ \\nabla_f \\Phi = \\frac{d\\mathcal{L}}{df} = \\frac{\\partial \\mathcal{L}}{\\partial f} $$\nFrom the definition of $\\mathcal{L}(u, f, p) = \\Phi(u) + \\langle p, \\mathcal{A} u \\rangle + \\langle p, f \\rangle$, the only term explicitly dependent on $f$ is $\\langle p, f \\rangle$. The variation with respect to $f$ is:\n$$ \\delta_f \\mathcal{L} = \\langle p, \\delta f \\rangle $$\nThis implies that the gradient of the functional with respect to the control variable $f$ is simply the adjoint field $p$.\n$$ \\nabla_f \\Phi = p $$\n\n**2. Discrete Formulation and Algorithm**\n\nWe discretize the domain $[0, L]$ using $N$ interior points $x_i = i h$ for $i=1, \\dots, N$, with uniform spacing $h = L/(N+1)$. The functions $u(x)$, $f(x)$, and $p(x)$ become vectors $u, f, p \\in \\mathbb{R}^N$.\n\nThe second derivative operator is approximated using a second-order central finite difference scheme:\n$$ \\frac{d^2u}{dx^2}\\Big|_{x_i} \\approx \\frac{u_{i-1} - 2u_i + u_{i+1}}{h^2} $$\nWith homogeneous Dirichlet boundary conditions $u_0 = u_{N+1} = 0$, the operator $\\mathcal{A}$ is discretized into a symmetric, tridiagonal matrix $A \\in \\mathbb{R}^{N \\times N}$:\n$$ A = \\frac{\\lambda + 2 \\mu}{h^2} \\operatorname{tridiag}(1, -2, 1) $$\nThe discrete systems of equations are:\n- **Forward Problem:** $A u = -f$\n- **Adjoint Problem:** $A^{\\top} p = -W^{\\top}W(u-d)$. Since $A$ is symmetric, $A^{\\top}=A$, so $A p = -W^{\\top}W(u-d)$.\n\nThe discrete misfit functional is:\n$$ \\Phi(u) = \\frac{1}{2} (u-d)^{\\top} W^{\\top}W (u-d) = \\frac{1}{2} \\sum_{i=1}^N w_i^2 (u_i - d_i)^2 $$\nwhere $W^{\\top}W$ is a diagonal matrix with entries $w_i^2$. The discrete gradient is given by the discrete adjoint field:\n- **Gradient:** $\\nabla_f \\Phi = p$\n\nThe algorithm for one gradient descent update is as follows:\n1.  **Setup:** Define grid parameters ($L$, $N$), material properties ($\\lambda$, $\\mu$), and algorithm parameters ($\\alpha$). Construct the discrete operator matrix $A$.\n2.  **Generate Synthetic Data:**\n    a. Define the true force field $f_{\\text{true}}$ on the discrete grid.\n    b. Solve the forward problem $A u_{\\text{true}} = -f_{\\text{true}}$ to get the true displacement $u_{\\text{true}}$.\n    c. Construct the data vector $d$ and weight vector $w$. For observed indices $i_{obs}$, set $d_{i_{obs}} = u_{\\text{true}, i_{obs}}$ and $w_{i_{obs}} = 1$. For all other indices, set $d_i=0$ and $w_i=0$.\n3.  **Gradient Calculation (Adjoint Method):**\n    a. Set an initial guess for the force, $f_0 = 0$.\n    b. Solve the forward problem for the current guess: $A u_0 = -f_0$. (Here, $u_0 = 0$).\n    c. Calculate the data residual $(u_0 - d)$.\n    d. Define the adjoint source term: $s_p = -W^{\\top}W(u_0 - d)$. In implementation, this is an element-wise product $-w^2 \\odot (u_0 - d)$.\n    e. Solve the adjoint problem for the adjoint field $p$: $A p = s_p$.\n4.  **Gradient Descent Update:**\n    a. The gradient is $\\nabla_f \\Phi = p$.\n    b. Update the force field: $f_{\\text{new}} = f_0 - \\alpha p$.\n5.  **Evaluate New Misfit:**\n    a. Solve the forward problem with the updated force: $A u_{\\text{new}} = -f_{\\text{new}}$.\n    b. Compute the new misfit value: $\\Phi(u_{\\text{new}}) = \\frac{1}{2} \\sum_{i=1}^N w_i^2 (u_{\\text{new}, i} - d_i)^2$.\n\nThis procedure is applied to each test case to obtain the required final misfit values.", "answer": "```python\nimport numpy as np\nfrom scipy.sparse import diags\nfrom scipy.sparse.linalg import spsolve\n\ndef run_one_case(L : float, N : int, lam : float, mu : float, f_true_params : tuple, obs_indices : list, alpha : float):\n    \"\"\"\n    Solves one test case of the 1D elastic inverse problem.\n\n    Args:\n        L (float): Length of the domain in meters.\n        N (int): Number of interior grid points.\n        lam (float): First Lamé parameter in Pascals.\n        mu (float): Second Lamé parameter (shear modulus) in Pascals.\n        f_true_params (tuple): Parameters (A, x0, sigma) for the true Gaussian force.\n        obs_indices (list): List of 1-based indices for observation points.\n        alpha (float): Step size for gradient descent.\n\n    Returns:\n        float: The misfit value after one gradient descent update.\n    \"\"\"\n    # 1. Discretization and Grid Setup\n    # h: grid spacing, x: grid point locations\n    h = L / (N + 1)\n    x = np.linspace(h, L - h, N)  # Grid points from x_1 to x_N\n\n    # 2. Construct the discrete operator A\n    # A = (lam + 2*mu)/h^2 * tridiag(1, -2, 1)\n    const = (lam + 2 * mu) / (h**2)\n    main_diag = -2.0 * np.ones(N)\n    off_diag = np.ones(N - 1)\n    # Use Compressed Sparse Column format for efficient solving\n    A_mat = const * diags([off_diag, main_diag, off_diag], [-1, 0, 1], format='csc')\n\n    # 3. Generate true force field and synthetic data\n    A_f_true, x0_f_true, sigma_f_true = f_true_params\n    f_true = A_f_true * np.exp(-(x - x0_f_true)**2 / (2 * sigma_f_true**2))\n    \n    # Solve forward problem for true displacement to get synthetic data\n    u_true = spsolve(A_mat, -f_true)\n    \n    # Create data vector d and weight vector w\n    d = np.zeros(N)\n    w = np.zeros(N)\n    # Convert 1-based indices from problem to 0-based for numpy arrays\n    obs_indices_0based = [i - 1 for i in obs_indices]\n    for i in obs_indices_0based:\n        if 0 <= i < N:\n            d[i] = u_true[i]\n            w[i] = 1.0\n\n    # 4. Adjoint-State Method and Gradient Descent\n    # Initial guess for the force is a zero vector\n    f_initial = np.zeros(N)\n\n    # Solve forward problem for the initial guess. For f_initial=0, u_initial is also 0.\n    u_initial = spsolve(A_mat, -f_initial)\n\n    # Calculate residual and the right-hand side for the adjoint equation\n    residual = u_initial - d\n    # W^T * W is a diagonal matrix with w_i^2 on the diagonal.\n    # Multiplication by this matrix is equivalent to an element-wise product.\n    WTW_residual = (w**2) * residual\n    adjoint_rhs = -WTW_residual\n\n    # Solve the adjoint equation: A^T p = -W^T W (u - d)\n    # Since A is symmetric, A^T = A.\n    p = spsolve(A_mat, adjoint_rhs)\n    \n    # The gradient of the misfit with respect to f is the adjoint field p\n    gradient = p\n    \n    # Perform one gradient descent step to update the force field\n    f_new = f_initial - alpha * gradient\n    \n    # 5. Compute the new state and misfit\n    # Solve the forward problem with the updated force field\n    u_new = spsolve(A_mat, -f_new)\n    \n    # Compute the final misfit value, which should be in units of m^2\n    final_misfit = 0.5 * np.sum((w * (u_new - d))**2)\n    \n    return final_misfit\n\ndef solve():\n    \"\"\"\n    Main function to run all test cases and print results.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"L\": 1.0, \"N\": 50, \"lam\": 1.5e9, \"mu\": 8.0e8,\n            \"f_true_params\": (1.0e6, 0.5, 0.1),\n            \"obs_indices\": [10, 25, 40],\n            \"alpha\": 1.0e-4\n        },\n        {\n            \"L\": 1.0, \"N\": 50, \"lam\": 3.0e10, \"mu\": 2.0e10,\n            \"f_true_params\": (5.0e6, 0.2, 0.08),\n            \"obs_indices\": [1],\n            \"alpha\": 5.0e-5\n        },\n        {\n            \"L\": 1.0, \"N\": 50, \"lam\": 1.0e9, \"mu\": 1.0e7,\n            \"f_true_params\": (2.0e6, 0.8, 0.05),\n            \"obs_indices\": [15, 35],\n            \"alpha\": 1.0e-4\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        result = run_one_case(\n            case[\"L\"], case[\"N\"], case[\"lam\"], case[\"mu\"],\n            case[\"f_true_params\"], case[\"obs_indices\"], case[\"alpha\"]\n        )\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3607889"}]}