{"hands_on_practices": [{"introduction": "This first exercise focuses on the foundational concept of isoparametric interpolation. Before we can compute complex quantities like stress or strain, we must first understand how a continuous field, such as displacement, is represented within an element using only its nodal values. This practice [@problem_id:3553756] will solidify your understanding of shape functions ($N_i$) for both bilinear (Q4) and quadratic (Q8) elements, demonstrating how to calculate displacements at any point inside the element's natural coordinate system.", "problem": "Consider an isoparametric quadrilateral finite element in a plane-strain soil domain analyzed by the Finite Element Method (FEM). In the natural coordinate system $(\\xi,\\eta)$ with $\\xi,\\eta \\in [-1,1]$, adopt the standard node locations for the four-node bilinear quadrilateral (Q4) and the eight-node serendipity quadrilateral (Q8) elements:\n- Corners: node $1:(-1,-1)$, node $2:(1,-1)$, node $3:(1,1)$, node $4:(-1,1)$.\n- Midside nodes for Q8: node $5:(0,-1)$, node $6:(1,0)$, node $7:(0,1)$, node $8:(-1,0)$.\nThe displacement field is interpolated from nodal degrees of freedom via the standard isoparametric approach. Let the nodal displacement components $(u_{x,i},u_{y,i})$ be prescribed in millimeters as follows:\n- Node $1$: $u_{x,1} = 2.10$, $u_{y,1} = -1.88$.\n- Node $2$: $u_{x,2} = 2.40$, $u_{y,2} = -0.68$.\n- Node $3$: $u_{x,3} = 2.30$, $u_{y,3} = -0.08$.\n- Node $4$: $u_{x,4} = 1.40$, $u_{y,4} = -0.88$.\n- Node $5$: $u_{x,5} = 2.15$, $u_{y,5} = -1.33$.\n- Node $6$: $u_{x,6} = 2.40$, $u_{y,6} = -0.45$.\n- Node $7$: $u_{x,7} = 1.75$, $u_{y,7} = -0.53$.\n- Node $8$: $u_{x,8} = 1.80$, $u_{y,8} = -1.45$.\nAt the evaluation point $(\\xi,\\eta) = (0.25,-0.5)$:\n- Using the defining properties of Lagrange interpolation and the isoparametric concept, first determine the shape functions $N_i(\\xi,\\eta)$ for the Q4 and Q8 elements at the given point.\n- Then compute the interpolated displacement components $u_x(\\xi,\\eta)$ and $u_y(\\xi,\\eta)$ using the Q4 and Q8 interpolations, respectively.\nProvide the final numerical values of the four quantities $u_x^{\\mathrm{Q4}}$, $u_y^{\\mathrm{Q4}}$, $u_x^{\\mathrm{Q8}}$, $u_y^{\\mathrm{Q8}}$, rounded to five significant figures, and express the displacements in millimeters. Report the four values in the order $(u_x^{\\mathrm{Q4}}, u_y^{\\mathrm{Q4}}, u_x^{\\mathrm{Q8}}, u_y^{\\mathrm{Q8}})$.", "solution": "The isoparametric finite element interpolation for a field variable is built from Lagrange shape functions defined over the natural square domain with nodes specified. For a quadrilateral element, the displacement vector field $\\mathbf{u}(\\xi,\\eta)$ is interpolated as a convex combination of nodal values via shape functions that satisfy the Kronecker-delta property $N_i(\\xi_j,\\eta_j) = \\delta_{ij}$ and the partition of unity $\\sum_i N_i(\\xi,\\eta) = 1$. We use these foundational properties to construct and evaluate $N_i(\\xi,\\eta)$ and then to interpolate the displacement components.\n\nFor the four-node bilinear quadrilateral (Q4), the Lagrange basis on each parametric coordinate is linear, and the tensor-product construction yields\n$$\nN_1(\\xi,\\eta) = \\frac{1}{4}(1-\\xi)(1-\\eta), \\quad\nN_2(\\xi,\\eta) = \\frac{1}{4}(1+\\xi)(1-\\eta), \\quad\nN_3(\\xi,\\eta) = \\frac{1}{4}(1+\\xi)(1+\\eta), \\quad\nN_4(\\xi,\\eta) = \\frac{1}{4}(1-\\xi)(1+\\eta).\n$$\nEvaluate these at $(\\xi,\\eta) = (0.25,-0.5)$:\n$$\n1-\\xi = 0.75, \\quad 1+\\xi = 1.25, \\quad 1-\\eta = 1.5, \\quad 1+\\eta = 0.5,\n$$\nthus\n$$\nN_1 = \\frac{1}{4}(0.75)(1.5) = 0.28125, \\quad\nN_2 = \\frac{1}{4}(1.25)(1.5) = 0.46875, \\quad\nN_3 = \\frac{1}{4}(1.25)(0.5) = 0.15625, \\quad\nN_4 = \\frac{1}{4}(0.75)(0.5) = 0.09375,\n$$\nand $\\sum_{i=1}^{4} N_i = 1.0$ as required.\n\nThe interpolated displacement components for Q4 follow from the isoparametric interpolation:\n$$\nu_x^{\\mathrm{Q4}}(\\xi,\\eta) = \\sum_{i=1}^{4} N_i(\\xi,\\eta)\\,u_{x,i}, \\quad\nu_y^{\\mathrm{Q4}}(\\xi,\\eta) = \\sum_{i=1}^{4} N_i(\\xi,\\eta)\\,u_{y,i}.\n$$\nCompute $u_x^{\\mathrm{Q4}}$:\n$$\nu_x^{\\mathrm{Q4}} = (0.28125)(2.10) + (0.46875)(2.40) + (0.15625)(2.30) + (0.09375)(1.40).\n$$\nTerm-by-term:\n$$\n(0.28125)(2.10) = 0.590625, \\quad\n(0.46875)(2.40) = 1.125, \\quad\n(0.15625)(2.30) = 0.359375, \\quad\n(0.09375)(1.40) = 0.13125,\n$$\nhence\n$$\nu_x^{\\mathrm{Q4}} = 0.590625 + 1.125 + 0.359375 + 0.13125 = 2.20625.\n$$\nCompute $u_y^{\\mathrm{Q4}}$:\n$$\nu_y^{\\mathrm{Q4}} = (0.28125)(-1.88) + (0.46875)(-0.68) + (0.15625)(-0.08) + (0.09375)(-0.88).\n$$\nTerm-by-term:\n$$\n(0.28125)(-1.88) = -0.52875, \\quad\n(0.46875)(-0.68) = -0.31875, \\quad\n(0.15625)(-0.08) = -0.0125, \\quad\n(0.09375)(-0.88) = -0.0825,\n$$\nhence\n$$\nu_y^{\\mathrm{Q4}} = -0.52875 - 0.31875 - 0.0125 - 0.0825 = -0.9425.\n$$\n\nFor the eight-node serendipity quadrilateral (Q8), the corner node shape functions are constructed to be quadratic in $\\xi$ and $\\eta$ while preserving nodal interpolation and partition of unity; the midside shape functions vanish off their corresponding edges and reproduce edgewise quadratic variation. A standard set is:\n$$\nN_1(\\xi,\\eta) = \\frac{1}{4}(1-\\xi)(1-\\eta)(-\\,\\xi - \\eta - 1), \\quad\nN_2(\\xi,\\eta) = \\frac{1}{4}(1+\\xi)(1-\\eta)(\\xi - \\eta - 1),\n$$\n$$\nN_3(\\xi,\\eta) = \\frac{1}{4}(1+\\xi)(1+\\eta)(\\xi + \\eta - 1), \\quad\nN_4(\\xi,\\eta) = \\frac{1}{4}(1-\\xi)(1+\\eta)(-\\,\\xi + \\eta - 1),\n$$\n$$\nN_5(\\xi,\\eta) = \\frac{1}{2}(1-\\xi^{2})(1-\\eta), \\quad\nN_6(\\xi,\\eta) = \\frac{1}{2}(1+\\xi)(1-\\eta^{2}),\n$$\n$$\nN_7(\\xi,\\eta) = \\frac{1}{2}(1-\\xi^{2})(1+\\eta), \\quad\nN_8(\\xi,\\eta) = \\frac{1}{2}(1-\\xi)(1-\\eta^{2}).\n$$\nEvaluate at $(\\xi,\\eta) = (0.25,-0.5)$:\nFirst compute auxiliary quantities:\n$$\n1-\\xi = 0.75, \\quad 1+\\xi = 1.25, \\quad 1-\\eta = 1.5, \\quad 1+\\eta = 0.5,\n$$\n$$\n\\xi^{2} = 0.0625, \\quad \\eta^{2} = 0.25, \\quad 1-\\xi^{2} = 0.9375, \\quad 1-\\eta^{2} = 0.75,\n$$\nand\n$$\n-\\,\\xi - \\eta - 1 = -0.25 + 0.5 - 1 = -0.75, \\quad\n\\xi - \\eta - 1 = 0.25 + 0.5 - 1 = -0.25,\n$$\n$$\n\\xi + \\eta - 1 = 0.25 - 0.5 - 1 = -1.25, \\quad\n-\\,\\xi + \\eta - 1 = -0.25 - 0.5 - 1 = -1.75.\n$$\nTherefore\n$$\nN_1 = \\frac{1}{4}(0.75)(1.5)(-0.75) = -0.2109375, \\quad\nN_2 = \\frac{1}{4}(1.25)(1.5)(-0.25) = -0.1171875,\n$$\n$$\nN_3 = \\frac{1}{4}(1.25)(0.5)(-1.25) = -0.1953125, \\quad\nN_4 = \\frac{1}{4}(0.75)(0.5)(-1.75) = -0.1640625,\n$$\n$$\nN_5 = \\frac{1}{2}(0.9375)(1.5) = 0.703125, \\quad\nN_6 = \\frac{1}{2}(1.25)(0.75) = 0.46875,\n$$\n$$\nN_7 = \\frac{1}{2}(0.9375)(0.5) = 0.234375, \\quad\nN_8 = \\frac{1}{2}(0.75)(0.75) = 0.28125,\n$$\nand $\\sum_{i=1}^{8} N_i = 1.0$.\n\nInterpolate the displacement components:\n$$\nu_x^{\\mathrm{Q8}}(\\xi,\\eta) = \\sum_{i=1}^{8} N_i(\\xi,\\eta)\\,u_{x,i}, \\quad\nu_y^{\\mathrm{Q8}}(\\xi,\\eta) = \\sum_{i=1}^{8} N_i(\\xi,\\eta)\\,u_{y,i}.\n$$\nCompute $u_x^{\\mathrm{Q8}}$ term-by-term:\n$$\n(-0.2109375)(2.10) = -0.44296875, \\quad\n(-0.1171875)(2.40) = -0.28125, \\quad\n(-0.1953125)(2.30) = -0.44921875, \\quad\n(-0.1640625)(1.40) = -0.2296875,\n$$\n$$\n(0.703125)(2.15) = 1.51171875, \\quad\n(0.46875)(2.40) = 1.125, \\quad\n(0.234375)(1.75) = 0.41015625, \\quad\n(0.28125)(1.80) = 0.50625,\n$$\nsumming gives\n$$\nu_x^{\\mathrm{Q8}} = \\big(-0.44296875 - 0.28125 - 0.44921875 - 0.2296875\\big) + \\big(1.51171875 + 1.125 + 0.41015625 + 0.50625\\big) = 2.15.\n$$\nCompute $u_y^{\\mathrm{Q8}}$ term-by-term:\n$$\n(-0.2109375)(-1.88) = 0.3965625, \\quad\n(-0.1171875)(-0.68) = 0.0796875, \\quad\n(-0.1953125)(-0.08) = 0.015625, \\quad\n(-0.1640625)(-0.88) = 0.144375,\n$$\n$$\n(0.703125)(-1.33) = -0.93515625, \\quad\n(0.46875)(-0.45) = -0.2109375, \\quad\n(0.234375)(-0.53) = -0.12421875, \\quad\n(0.28125)(-1.45) = -0.4078125,\n$$\nsumming gives\n$$\nu_y^{\\mathrm{Q8}} = \\big(0.3965625 + 0.0796875 + 0.015625 + 0.144375\\big) + \\big(-0.93515625 - 0.2109375 - 0.12421875 - 0.4078125\\big) = -1.041875.\n$$\n\nFinally, round each value to five significant figures and express in millimeters:\n$$\nu_x^{\\mathrm{Q4}} = 2.20625 \\to 2.2063, \\quad\nu_y^{\\mathrm{Q4}} = -0.9425 \\to -0.94250,\n$$\n$$\nu_x^{\\mathrm{Q8}} = 2.15 \\to 2.1500, \\quad\nu_y^{\\mathrm{Q8}} = -1.041875 \\to -1.0419.\n$$\nReport the four values in the order $(u_x^{\\mathrm{Q4}}, u_y^{\\mathrm{Q4}}, u_x^{\\mathrm{Q8}}, u_y^{\\mathrm{Q8}})$.", "answer": "$$\\boxed{\\begin{pmatrix}2.2063  -0.94250  2.1500  -1.0419\\end{pmatrix}}$$", "id": "3553756"}, {"introduction": "Building upon the concept of interpolation, our next practice delves into the core of finite element analysis: the construction of the element stiffness matrix, $K_e$. This matrix links nodal forces to nodal displacements and is fundamental to solving for the system's response to loads. In this exercise [@problem_id:3553827], you will compute a component of the stiffness matrix for a simple rectangular Q4 element, gaining hands-on experience with the strain-displacement matrix ($B$), the material constitutive matrix ($D$), and the indispensable technique of Gauss quadrature for numerical integration.", "problem": "A four-node bilinear quadrilateral element ($\\text{Q4}$) in the Finite Element Method (FEM) is used to model plane strain linear elasticity for a soil layer. The element has nodal coordinates (in meters) $ (x_1,y_1)=(0,0)$, $(x_2,y_2)=(2,0)$, $(x_3,y_3)=(2,1)$, $(x_4,y_4)=(0,1)$, with constant thickness $t=1\\,\\text{m}$. The soil is homogeneous and isotropic with Young’s modulus $E=60\\,\\text{MPa}$ and Poisson’s ratio $\\nu=0.25$. Use $2\\times 2$ Gauss integration (standard Gauss points at $\\xi,\\eta=\\pm 1/\\sqrt{3}$, each with unit weight) over the parent domain $(\\xi,\\eta)\\in[-1,1]\\times[-1,1]$.\n\nStarting from the definition of the element stiffness matrix\n$$\nK_{e}=\\int_{-1}^{1}\\int_{-1}^{1} B(\\xi,\\eta)^{\\top}\\, D \\, B(\\xi,\\eta)\\, t \\, \\det J(\\xi,\\eta)\\, \\mathrm{d}\\xi\\,\\mathrm{d}\\eta,\n$$\nwhere $B$ is the strain–displacement matrix for the $\\text{Q4}$ element, $D$ is the plane strain isotropic constitutive matrix, and $J$ is the Jacobian of the isoparametric mapping, perform the $2\\times 2$ Gauss quadrature to assemble $K_e$ for this element.\n\nAssume the canonical degree-of-freedom ordering $\\{u_1, v_1, u_2, v_2, u_3, v_3, u_4, v_4\\}$, where $u_i$ and $v_i$ are the nodal displacements in the $x$ and $y$ directions, respectively. After computing the stiffness matrix, report the single entry $K_{11}$ (the $(1,1)$ entry corresponding to $u_1$ coupling to $u_1$). Express your final numerical answer in $\\text{N}/\\text{m}$ and round your answer to four significant figures.", "solution": "The stiffness matrix $K_e$ for a single element is given by the integral over the parent element domain $(\\xi, \\eta) \\in [-1,1]\\times[-1,1]$:\n$$\nK_{e}=\\int_{-1}^{1}\\int_{-1}^{1} B(\\xi,\\eta)^{\\top}\\, D \\, B(\\xi,\\eta)\\, t \\, \\det J(\\xi,\\eta)\\, \\mathrm{d}\\xi\\,\\mathrm{d}\\eta\n$$\nThis integral is to be evaluated numerically using $2 \\times 2$ Gauss quadrature. The formula for numerical integration is:\n$$\nK_{e} \\approx t \\sum_{k=1}^{4} B(\\xi_k,\\eta_k)^{\\top}\\, D \\, B(\\xi_k,\\eta_k) \\, \\det J(\\xi_k,\\eta_k)\\, W_k\n$$\nwhere the four Gauss points are $(\\xi_k, \\eta_k)$ for $k \\in \\{1,2,3,4\\}$ at coordinates $(\\pm a, \\pm a)$ with $a=1/\\sqrt{3}$, and the weights are $W_k=1$ for all points. The element thickness is given as $t=1\\,\\text{m}$.\n\nWe are asked to find the specific entry $K_{11}$, which corresponds to the degree of freedom $u_1$ (the $x$-displacement of node $1$). This entry is given by:\n$$\nK_{11} \\approx t \\sum_{k=1}^{4} \\left( B(\\xi_k,\\eta_k)^{\\top}\\, D \\, B(\\xi_k,\\eta_k) \\right)_{11} \\det J(\\xi_k,\\eta_k)\n$$\n\nThe calculation proceeds in several steps:\n1.  **Isoparametric Mapping and Jacobian:**\nThe shape functions for the $4$-node bilinear quadrilateral element are:\n$N_1(\\xi, \\eta) = \\frac{1}{4}(1-\\xi)(1-\\eta)$\n$N_2(\\xi, \\eta) = \\frac{1}{4}(1+\\xi)(1-\\eta)$\n$N_3(\\xi, \\eta) = \\frac{1}{4}(1+\\xi)(1+\\eta)$\n$N_4(\\xi, \\eta) = \\frac{1}{4}(1-\\xi)(1+\\eta)$\n\nThe global coordinates $(x,y)$ are mapped from the parent coordinates $(\\xi,\\eta)$ using these shape functions and the nodal coordinates $(x_1,y_1)=(0,0)$, $(x_2,y_2)=(2,0)$, $(x_3,y_3)=(2,1)$, and $(x_4,y_4)=(0,1)$:\n$x(\\xi, \\eta) = \\sum_{i=1}^{4} N_i(\\xi, \\eta) x_i = 0 \\cdot N_1 + 2 \\cdot N_2 + 2 \\cdot N_3 + 0 \\cdot N_4 = \\frac{2}{4}(1+\\xi)(1-\\eta) + \\frac{2}{4}(1+\\xi)(1+\\eta) = \\frac{1}{2}(1+\\xi)[(1-\\eta)+(1+\\eta)] = 1+\\xi$\n$y(\\xi, \\eta) = \\sum_{i=1}^{4} N_i(\\xi, \\eta) y_i = 0 \\cdot N_1 + 0 \\cdot N_2 + 1 \\cdot N_3 + 1 \\cdot N_4 = \\frac{1}{4}(1+\\xi)(1+\\eta) + \\frac{1}{4}(1-\\xi)(1+\\eta) = \\frac{1}{4}(1+\\eta)[(1+\\xi)+(1-\\xi)] = \\frac{1}{2}(1+\\eta)$\n\nThe Jacobian matrix $J$ of this transformation is:\n$$\nJ = \\begin{pmatrix} \\frac{\\partial x}{\\partial \\xi}  \\frac{\\partial x}{\\partial \\eta} \\\\ \\frac{\\partial y}{\\partial \\xi}  \\frac{\\partial y}{\\partial \\eta} \\end{pmatrix} = \\begin{pmatrix} 1  0 \\\\ 0  \\frac{1}{2} \\end{pmatrix}\n$$\nThe Jacobian is constant over the element. Its determinant is $\\det J = (1)(\\frac{1}{2}) - (0)(0) = \\frac{1}{2}$. The inverse Jacobian is $J^{-1} = \\begin{pmatrix} 1  0 \\\\ 0  2 \\end{pmatrix}$.\n\n2.  **Constitutive Matrix $D$:**\nFor plane strain, the isotropic constitutive matrix is:\n$$\nD = \\frac{E}{(1+\\nu)(1-2\\nu)} \\begin{pmatrix} 1-\\nu  \\nu  0 \\\\ \\nu  1-\\nu  0 \\\\ 0  0  \\frac{1-2\\nu}{2} \\end{pmatrix}\n$$\nGiven $E=60\\,\\text{MPa} = 60 \\times 10^6\\,\\text{Pa}$ and $\\nu=0.25$:\nThe prefactor is $\\frac{60 \\times 10^6}{(1+0.25)(1-2 \\cdot 0.25)} = \\frac{60 \\times 10^6}{(1.25)(0.5)} = 96 \\times 10^6\\,\\text{Pa}$.\n$$\nD = 96 \\times 10^6 \\begin{pmatrix} 0.75  0.25  0 \\\\ 0.25  0.75  0 \\\\ 0  0  0.25 \\end{pmatrix} = \\begin{pmatrix} 72 \\times 10^6  24 \\times 10^6  0 \\\\ 24 \\times 10^6  72 \\times 10^6  0 \\\\ 0  0  24 \\times 10^6 \\end{pmatrix} \\,\\text{Pa}\n$$\nSo, $D_{11} = 72 \\times 10^6\\,\\text{Pa}$ and $D_{33} = 24 \\times 10^6\\,\\text{Pa}$.\n\n3.  **Strain-Displacement Matrix $B$:**\nThe strain vector $\\boldsymbol{\\epsilon} = \\{\\epsilon_{xx}, \\epsilon_{yy}, \\gamma_{xy}\\}^T$ is related to the nodal displacement vector $\\boldsymbol{d}$ by $\\boldsymbol{\\epsilon} = B\\boldsymbol{d}$. The matrix $B$ is composed of blocks $B_i$:\n$B_i = \\begin{pmatrix} \\frac{\\partial N_i}{\\partial x}  0 \\\\ 0  \\frac{\\partial N_i}{\\partial y} \\\\ \\frac{\\partial N_i}{\\partial y}  \\frac{\\partial N_i}{\\partial x} \\end{pmatrix}$.\nThe term $(B^\\top D B)_{11}$ corresponds to the coupling of $u_1$, so we only need the first column of the full $B$ matrix. This column corresponds to $B_1$'s first column. Let's call the first column of the full $B$ matrix $\\mathbf{b}_1$.\n$\\mathbf{b}_1 = \\begin{Bmatrix} \\frac{\\partial N_1}{\\partial x} \\\\ 0 \\\\ \\frac{\\partial N_1}{\\partial y} \\end{Bmatrix}$.\nThe spatial derivatives of $N_1$ are found using the inverse Jacobian:\n$\\begin{Bmatrix} \\frac{\\partial N_1}{\\partial x} \\\\ \\frac{\\partial N_1}{\\partial y} \\end{Bmatrix} = J^{-1} \\begin{Bmatrix} \\frac{\\partial N_1}{\\partial \\xi} \\\\ \\frac{\\partial N_1}{\\partial \\eta} \\end{Bmatrix} = \\begin{pmatrix} 1  0 \\\\ 0  2 \\end{pmatrix} \\begin{Bmatrix} \\frac{1}{4}(\\eta-1) \\\\ \\frac{1}{4}(\\xi-1) \\end{Bmatrix} = \\begin{Bmatrix} \\frac{1}{4}(\\eta-1) \\\\ \\frac{1}{2}(\\xi-1) \\end{Bmatrix}$.\n\nThe $(1,1)$ component of the integrand matrix is $\\mathbf{b}_1^\\top D \\mathbf{b}_1$:\n$$\n\\mathbf{b}_1^\\top D \\mathbf{b}_1 = \\begin{pmatrix} \\frac{\\partial N_1}{\\partial x}  0  \\frac{\\partial N_1}{\\partial y} \\end{pmatrix} D \\begin{pmatrix} \\frac{\\partial N_1}{\\partial x} \\\\ 0 \\\\ \\frac{\\partial N_1}{\\partial y} \\end{pmatrix} = D_{11} \\left(\\frac{\\partial N_1}{\\partial x}\\right)^2 + D_{33} \\left(\\frac{\\partial N_1}{\\partial y}\\right)^2\n$$\nSubstituting the derivatives:\n$$\n\\mathbf{b}_1^\\top D \\mathbf{b}_1 = D_{11} \\left(\\frac{\\eta-1}{4}\\right)^2 + D_{33} \\left(\\frac{\\xi-1}{2}\\right)^2 = \\frac{(\\eta-1)^2}{16}D_{11} + \\frac{(\\xi-1)^2}{4}D_{33}\n$$\n\n4.  **Numerical Integration:**\nWe sum this expression over the four Gauss points $(\\xi_k, \\eta_k) = (\\pm a, \\pm a)$ where $a=1/\\sqrt{3}$.\n$$\n\\sum_{k=1}^{4} \\mathbf{b}_1^\\top D \\mathbf{b}_1 = \\sum_{k=1}^{4} \\left( \\frac{(\\eta_k-1)^2}{16}D_{11} + \\frac{(\\xi_k-1)^2}{4}D_{33} \\right) = \\frac{D_{11}}{16}\\sum_{k=1}^{4}(\\eta_k-1)^2 + \\frac{D_{33}}{4}\\sum_{k=1}^{4}(\\xi_k-1)^2\n$$\nLet's evaluate the sums. Due to symmetry:\n$\\sum_{k=1}^{4}(\\eta_k-1)^2 = (-a-1)^2 + (-a-1)^2 + (a-1)^2 + (a-1)^2 = 2(a+1)^2+2(a-1)^2 = 2(a^2+2a+1) + 2(a^2-2a+1) = 4(a^2+1)$.\nWith $a^2 = (1/\\sqrt{3})^2 = 1/3$, the sum is $4(1/3+1) = 4(4/3) = 16/3$.\nThe sum $\\sum(\\xi_k-1)^2$ is also $16/3$.\nSubstituting these sums back:\n$$\n\\sum_{k=1}^{4} \\mathbf{b}_1^\\top D \\mathbf{b}_1 = \\frac{D_{11}}{16}\\left(\\frac{16}{3}\\right) + \\frac{D_{33}}{4}\\left(\\frac{16}{3}\\right) = \\frac{D_{11}}{3} + \\frac{4D_{33}}{3}\n$$\nPlugging in the values for $D_{11}$ and $D_{33}$:\n$$\n\\sum_{k=1}^{4} \\mathbf{b}_1^\\top D \\mathbf{b}_1 = \\frac{72 \\times 10^6}{3} + \\frac{4 \\times (24 \\times 10^6)}{3} = \\frac{(72 + 96) \\times 10^6}{3} = \\frac{168 \\times 10^6}{3} = 56 \\times 10^6\\,\\text{Pa}\n$$\n\n5.  **Final Calculation of $K_{11}$:**\nFinally, we assemble $K_{11}$:\n$$\nK_{11} \\approx t \\cdot \\det J \\cdot \\sum_{k=1}^{4} (\\mathbf{b}_1^\\top D \\mathbf{b}_1)(\\xi_k, \\eta_k) W_k\n$$\nWith $t=1\\,\\text{m}$, $\\det J = 1/2$, and all $W_k=1$:\n$$\nK_{11} = (1) \\cdot \\left(\\frac{1}{2}\\right) \\cdot (56 \\times 10^6) = 28 \\times 10^6\\,\\text{N/m}\n$$\nThe calculation is exact because $2 \\times 2$ Gauss quadrature integrates polynomials of degree up to $3$ exactly, and our integrand is of degree $2$. The result is $K_{11} = 28,000,000\\,\\text{N/m}$.\nThe problem requests the answer rounded to four significant figures. This is $2.800 \\times 10^7\\,\\text{N/m}$.", "answer": "$$\n\\boxed{2.800 \\times 10^7}\n$$", "id": "3553827"}, {"introduction": "In practice, the accuracy of a finite element solution is highly dependent on the quality of the mesh, specifically the shape of its elements. This final exercise explores the critical issue of element distortion and provides quantitative tools to assess it. By analyzing a geometrically distorted Q4 element [@problem_id:3553815], you will learn to compute quality metrics derived from the Jacobian of the isoparametric map, gaining insight into how poor element shapes can degrade solution accuracy and why meshing is both an art and a science.", "problem": "In plane strain computational geomechanics, consider a single isoparametric four-node quadrilateral (Q4) element with nodes ordered counterclockwise and physical coordinates given by\n- Node $1$: $(x_{1},y_{1}) = (0,0)$,\n- Node $2$: $(x_{2},y_{2}) = (3.2,0.1)$,\n- Node $3$: $(x_{3},y_{3}) = (2.8,2.5)$,\n- Node $4$: $(x_{4},y_{4}) = (-0.3,1.8)$.\nThe isoparametric mapping from the parent coordinates $(\\xi,\\eta)\\in[-1,1]^{2}$ uses the standard bilinear shape functions $N_{i}(\\xi,\\eta)$ of the four-node quadrilateral (Q4), and the Jacobian matrix is defined by\n$$\nJ(\\xi,\\eta) \\equiv\n\\begin{bmatrix}\n\\frac{\\partial x}{\\partial \\xi}  \\frac{\\partial x}{\\partial \\eta} \\\\\n\\frac{\\partial y}{\\partial \\xi}  \\frac{\\partial y}{\\partial \\eta}\n\\end{bmatrix},\n\\quad\nx(\\xi,\\eta) = \\sum_{i=1}^{4} N_{i}(\\xi,\\eta)\\,x_{i},\\quad\ny(\\xi,\\eta) = \\sum_{i=1}^{4} N_{i}(\\xi,\\eta)\\,y_{i}.\n$$\nUse the standard $2\\times 2$ Gauss grid with $(\\xi,\\eta)\\in\\{(\\pm g,\\pm g)\\}$, where $g\\equiv 1/\\sqrt{3}$. Define the Jacobian-based quality metric over the Gauss grid as\n$$\nq_{J} \\equiv \\frac{\\min\\limits_{(\\xi,\\eta)} \\det J(\\xi,\\eta)}{\\max\\limits_{(\\xi,\\eta)} \\det J(\\xi,\\eta)}.\n$$\nTo predict the distortion-induced amplification of stiffness computation error, use the strain-displacement scaling implied by the mapping. Specifically, define the scalar field\n$$\nT(\\xi,\\eta) \\equiv \\|J^{-1}(\\xi,\\eta)\\|_{F}^{2}\\,\\det J(\\xi,\\eta) \\;=\\; \\operatorname{tr}\\!\\big(J(\\xi,\\eta)^{-T}J(\\xi,\\eta)^{-1}\\big)\\,\\det J(\\xi,\\eta),\n$$\nand take the amplification factor as the Gauss-grid ratio\n$$\nA \\equiv \\frac{\\max\\limits_{(\\xi,\\eta)} T(\\xi,\\eta)}{\\min\\limits_{(\\xi,\\eta)} T(\\xi,\\eta)}.\n$$\nCompute $q_{J}$ and $A$ for the given element. Report the final answer as the pair $(q_{J},A)$, rounded to four significant figures. Express both numbers as dimensionless values without units.", "solution": "The core of the problem is the isoparametric mapping from the parent element, a square domain defined by $(\\xi, \\eta) \\in [-1, 1]^2$, to the physical element in the $(x, y)$ plane. The mapping is given by:\n$$\nx(\\xi, \\eta) = \\sum_{i=1}^{4} N_i(\\xi, \\eta) x_i, \\quad y(\\xi, \\eta) = \\sum_{i=1}^{4} N_i(\\xi, \\eta) y_i\n$$\nwhere $(x_i, y_i)$ are the coordinates of the four nodes, and $N_i(\\xi, \\eta)$ are the bilinear shape functions for the Q4 element:\n$$\n\\begin{aligned}\nN_1(\\xi, \\eta) = \\frac{1}{4}(1-\\xi)(1-\\eta) \\\\\nN_2(\\xi, \\eta) = \\frac{1}{4}(1+\\xi)(1-\\eta) \\\\\nN_3(\\xi, \\eta) = \\frac{1}{4}(1+\\xi)(1+\\eta) \\\\\nN_4(\\xi, \\eta) = \\frac{1}{4}(1-\\xi)(1+\\eta)\n\\end{aligned}\n$$\nThe Jacobian matrix of this transformation is defined as:\n$$\nJ(\\xi, \\eta) = \\begin{bmatrix} \\frac{\\partial x}{\\partial \\xi}  \\frac{\\partial x}{\\partial \\eta} \\\\ \\frac{\\partial y}{\\partial \\xi}  \\frac{\\partial y}{\\partial \\eta} \\end{bmatrix} = \\begin{bmatrix} J_{11}  J_{12} \\\\ J_{21}  J_{22} \\end{bmatrix}\n$$\nThe components of the Jacobian are found by differentiating the mapping equations:\n$$\n\\frac{\\partial x}{\\partial \\xi} = \\sum_{i=1}^{4} \\frac{\\partial N_i}{\\partial \\xi} x_i, \\quad \\frac{\\partial x}{\\partial \\eta} = \\sum_{i=1}^{4} \\frac{\\partial N_i}{\\partial \\eta} x_i, \\quad \\text{etc.}\n$$\nThe derivatives of the shape functions are:\n$$\n\\begin{aligned}\n\\frac{\\partial N_1}{\\partial \\xi} = -\\frac{1}{4}(1-\\eta), \\quad \\frac{\\partial N_2}{\\partial \\xi} = \\frac{1}{4}(1-\\eta), \\quad \\frac{\\partial N_3}{\\partial \\xi} = \\frac{1}{4}(1+\\eta), \\quad \\frac{\\partial N_4}{\\partial \\xi} = -\\frac{1}{4}(1+\\eta) \\\\\n\\frac{\\partial N_1}{\\partial \\eta} = -\\frac{1}{4}(1-\\xi), \\quad \\frac{\\partial N_2}{\\partial \\eta} = -\\frac{1}{4}(1+\\xi), \\quad \\frac{\\partial N_3}{\\partial \\eta} = \\frac{1}{4}(1+\\xi), \\quad \\frac{\\partial N_4}{\\partial \\eta} = \\frac{1}{4}(1-\\xi)\n\\end{aligned}\n$$\nUsing the nodal coordinates $(x_1,y_1)=(0,0)$, $(x_2,y_2)=(3.2,0.1)$, $(x_3,y_3)=(2.8,2.5)$, and $(x_4,y_4)=(-0.3,1.8)$, we can compute the Jacobian components:\n$$\n\\begin{aligned}\nJ_{11} = \\frac{\\partial x}{\\partial \\xi} = \\frac{1}{4} [-(1-\\eta)x_1 + (1-\\eta)x_2 + (1+\\eta)x_3 - (1+\\eta)x_4] \\\\\n= \\frac{1}{4} [ (1-\\eta)(x_2 - x_1) + (1+\\eta)(x_3 - x_4) ] \\\\\n= \\frac{1}{4} [ (1-\\eta)(3.2 - 0) + (1+\\eta)(2.8 - (-0.3)) ] = \\frac{1}{4}[3.2(1-\\eta) + 3.1(1+\\eta)] = \\frac{1}{4}(6.3 - 0.1\\eta) \\\\\nJ_{21} = \\frac{\\partial y}{\\partial \\xi} = \\frac{1}{4} [ (1-\\eta)(y_2 - y_1) + (1+\\eta)(y_3 - y_4) ] \\\\\n= \\frac{1}{4} [ (1-\\eta)(0.1 - 0) + (1+\\eta)(2.5 - 1.8) ] = \\frac{1}{4}[0.1(1-\\eta) + 0.7(1+\\eta)] = \\frac{1}{4}(0.8 + 0.6\\eta) \\\\\nJ_{12} = \\frac{\\partial x}{\\partial \\eta} = \\frac{1}{4} [ -(1-\\xi)x_1 - (1+\\xi)x_2 + (1+\\xi)x_3 + (1-\\xi)x_4 ] \\\\\n= \\frac{1}{4} [ (1-\\xi)(x_4 - x_1) + (1+\\xi)(x_3 - x_2) ] \\\\\n= \\frac{1}{4} [ (1-\\xi)(-0.3 - 0) + (1+\\xi)(2.8 - 3.2) ] = \\frac{1}{4}[-0.3(1-\\xi) - 0.4(1+\\xi)] = \\frac{1}{4}(-0.7 - 0.1\\xi) \\\\\nJ_{22} = \\frac{\\partial y}{\\partial \\eta} = \\frac{1}{4} [ (1-\\xi)(y_4 - y_1) + (1+\\xi)(y_3 - y_2) ] \\\\\n= \\frac{1}{4} [ (1-\\xi)(1.8 - 0) + (1+\\xi)(2.5 - 0.1) ] = \\frac{1}{4}[1.8(1-\\xi) + 2.4(1+\\xi)] = \\frac{1}{4}(4.2 + 0.6\\xi)\n\\end{aligned}\n$$\nThe determinant of the Jacobian is $\\det J = J_{11}J_{22} - J_{12}J_{21}$.\n$$\n\\begin{aligned}\n\\det J(\\xi, \\eta) = \\frac{1}{16} [ (6.3 - 0.1\\eta)(4.2 + 0.6\\xi) - (-0.7 - 0.1\\xi)(0.8 + 0.6\\eta) ] \\\\\n= \\frac{1}{16} [ (26.46 + 3.78\\xi - 0.42\\eta - 0.06\\xi\\eta) - (-0.56 - 0.42\\eta - 0.08\\xi - 0.06\\xi\\eta) ] \\\\\n= \\frac{1}{16} [ 26.46 + 3.78\\xi - 0.42\\eta - 0.06\\xi\\eta + 0.56 + 0.42\\eta + 0.08\\xi + 0.06\\xi\\eta ] \\\\\n= \\frac{1}{16} (27.02 + 3.86\\xi)\n\\end{aligned}\n$$\nThe quality metrics are evaluated on the $2 \\times 2$ Gauss grid, where the points are $(\\xi, \\eta) \\in \\{ (\\pm g, \\pm g) \\}$ with $g = 1/\\sqrt{3}$.\nSince $\\det J$ depends only on $\\xi$, there are two distinct values for the determinant on this grid:\n$$\n\\det J(\\xi=g) = \\frac{1}{16}(27.02 + 3.86g) = \\frac{1}{16}(27.02 + 3.86/\\sqrt{3}) \\approx 1.82803\n$$\n$$\n\\det J(\\xi=-g) = \\frac{1}{16}(27.02 - 3.86g) = \\frac{1}{16}(27.02 - 3.86/\\sqrt{3}) \\approx 1.54946\n$$\nThe Jacobian quality metric $q_J$ is the ratio of the minimum to the maximum of these values:\n$$\nq_J = \\frac{\\min \\det J}{\\max \\det J} = \\frac{1.54946...}{1.82803...} \\approx 0.84761\n$$\nNext, we compute the amplification factor $A$. This requires the scalar field $T(\\xi, \\eta) = \\operatorname{tr}(J^{-T}J^{-1}) \\det J$. As stated in the problem description, this is equivalent to $\\|J^{-1}\\|_F^2 \\det J$. For a $2 \\times 2$ matrix $J$, this simplifies to:\n$$\nT(\\xi, \\eta) = \\frac{\\|J\\|_F^2}{\\det J} = \\frac{J_{11}^2 + J_{12}^2 + J_{21}^2 + J_{22}^2}{\\det J}\n$$\nFirst, we compute the Frobenius norm squared, $\\|J\\|_F^2$:\n$$\n\\begin{aligned}\n\\|J\\|_F^2 = \\frac{1}{16} \\left[ (6.3-0.1\\eta)^2 + (-0.7-0.1\\xi)^2 + (0.8+0.6\\eta)^2 + (4.2+0.6\\xi)^2 \\right] \\\\\n= \\frac{1}{16} [ (39.69 - 1.26\\eta + 0.01\\eta^2) + (0.49 + 0.14\\xi + 0.01\\xi^2) \\\\\n \\qquad + (0.64 + 0.96\\eta + 0.36\\eta^2) + (17.64 + 5.04\\xi + 0.36\\xi^2) ] \\\\\n= \\frac{1}{16} [ 58.46 + 5.18\\xi - 0.30\\eta + 0.37\\xi^2 + 0.37\\eta^2 ]\n\\end{aligned}\n$$\nAt the Gauss points, $\\xi^2 = g^2 = 1/3$ and $\\eta^2 = g^2 = 1/3$. Thus $\\xi^2+\\eta^2 = 2/3$.\n$$\n\\|J\\|_F^2 = \\frac{1}{16} [ 58.46 + 5.18\\xi - 0.30\\eta + 0.37(2/3) ] = \\frac{1}{16} [ 58.70666... + 5.18\\xi - 0.30\\eta ]\n$$\nNow we compute $T = \\|J\\|_F^2 / \\det J$ at the four Gauss points:\n$$\nT(\\xi, \\eta) = \\frac{58.70666... + 5.18\\xi - 0.30\\eta}{27.02 + 3.86\\xi}\n$$\nLet's evaluate $T$ at each point, with $g = 1/\\sqrt{3}$:\n1.  GP1: $(\\xi, \\eta) = (g, g)$.\n    $T_1 = \\frac{58.70666... + 5.18g - 0.30g}{27.02 + 3.86g} = \\frac{58.70666... + 4.88g}{27.02 + 3.86g} \\approx 2.10348$\n2.  GP2: $(\\xi, \\eta) = (-g, g)$.\n    $T_2 = \\frac{58.70666... - 5.18g - 0.30g}{27.02 - 3.86g} = \\frac{58.70666... - 5.48g}{27.02 - 3.86g} \\approx 2.24039$\n3.  GP3: $(\\xi, \\eta) = (-g, -g)$.\n    $T_3 = \\frac{58.70666... - 5.18g + 0.30g}{27.02 - 3.86g} = \\frac{58.70666... - 4.88g}{27.02 - 3.86g} \\approx 2.25438$\n4.  GP4: $(\\xi, \\eta) = (g, -g)$.\n    $T_4 = \\frac{58.70666... + 5.18g + 0.30g}{27.02 + 3.86g} = \\frac{58.70666... + 5.48g}{27.02 + 3.86g} \\approx 2.11532$\n\nThe minimum and maximum values of $T$ on the Gauss grid are:\n$$\nT_{\\min} = T_1 \\approx 2.10348, \\quad T_{\\max} = T_3 \\approx 2.25438\n$$\nThe amplification factor $A$ is their ratio:\n$$\nA = \\frac{T_{\\max}}{T_{\\min}} = \\frac{2.25438...}{2.10348...} \\approx 1.07174\n$$\nRounding the final results to four significant figures as requested:\n$q_J \\approx 0.8476$\n$A \\approx 1.072$\n\nThe final answer is the pair $(q_J, A)$.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.8476  1.072\n\\end{pmatrix}\n}\n$$", "id": "3553815"}]}