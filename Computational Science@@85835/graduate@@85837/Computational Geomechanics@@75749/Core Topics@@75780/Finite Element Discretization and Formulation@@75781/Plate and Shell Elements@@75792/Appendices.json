{"hands_on_practices": [{"introduction": "The formulation of finite elements for thin plates presents a unique challenge due to the requirement of $C^1$ continuity, which arises because the strain energy depends on second derivatives of the transverse displacement. This exercise builds the necessary theoretical machinery from the ground up, starting with the one-dimensional case of an Euler-Bernoulli beam to construct Hermite cubic shape functions. By extending this concept to two dimensions via a tensor-product approach, you will deduce the essential degrees of freedom for a conforming rectangular Kirchhoff-Love plate element [@problem_id:3551396].", "problem": "Consider a small-deflection Euler–Bernoulli beam and a thin plate modeled under the Kirchhoff–Love assumptions, both within the Finite Element Method (FEM) framework in computational geomechanics. \n\nPart A (beam): Let a single straight $2$-node Euler–Bernoulli beam element of length $L$ be parameterized by the parent coordinate $\\xi \\in [-1,1]$ via the isoparametric mapping $x = x_{c} + \\frac{L}{2}\\,\\xi$, where $x_{c}$ is the element center. The kinematic assumption relates the cross-section rotation to slope, $\\theta = \\frac{\\mathrm{d}w}{\\mathrm{d}x}$, where $w(x)$ is the transverse displacement. Seek a cubic Hermite interpolation for $w(\\xi)$ of the form\n$$\nw(\\xi) = N_{1}(\\xi)\\,w_{1} + N_{2}(\\xi)\\,L\\,\\theta_{1} + N_{3}(\\xi)\\,w_{2} + N_{4}(\\xi)\\,L\\,\\theta_{2},\n$$\nwith nodal degrees of freedom $w_{1}$, $\\theta_{1}$ at $\\xi=-1$ and $w_{2}$, $\\theta_{2}$ at $\\xi=+1$. Enforce the interpolation conditions for $C^{1}$ continuity in the physical coordinate $x$: exact nodal values $w(-1)=w_{1}$, $w(1)=w_{2}$ and exact nodal slopes $\\left.\\frac{\\mathrm{d}w}{\\mathrm{d}x}\\right|_{\\xi=-1}=\\theta_{1}$, $\\left.\\frac{\\mathrm{d}w}{\\mathrm{d}x}\\right|_{\\xi=1}=\\theta_{2}$, taking into account the chain rule $\\frac{\\mathrm{d}}{\\mathrm{d}x}=\\frac{2}{L}\\frac{\\mathrm{d}}{\\mathrm{d}\\xi}$. Starting from these principles, construct the cubic Hermite shape functions $N_{1}(\\xi)$, $N_{2}(\\xi)$, $N_{3}(\\xi)$, and $N_{4}(\\xi)$ as explicit polynomials in $\\xi$.\n\nPart B (plate): For a rectangular thin plate element under Kirchhoff–Love theory, the bending strains depend on second derivatives of the transverse displacement field $w(x,y)$, specifically $\\kappa_{xx} = -\\frac{\\partial^{2} w}{\\partial x^{2}}$, $\\kappa_{yy} = -\\frac{\\partial^{2} w}{\\partial y^{2}}$, and $\\kappa_{xy} = -2\\,\\frac{\\partial^{2} w}{\\partial x \\partial y}$. To achieve $C^{1}$ continuity across inter-element boundaries, the displacement $w$ and its first derivatives must be continuous along shared edges. Using a tensor-product rationale consistent with the Hermite cubic construction in Part A, deduce the minimal nodal parameter set required at each corner node of a $4$-node rectangular plate element to ensure $C^{1}$ continuity and bicubic completeness, and state the number of degrees of freedom per node.\n\nExpress your final answer as the row matrix of the four shape functions $N_{1}(\\xi)$, $N_{2}(\\xi)$, $N_{3}(\\xi)$, $N_{4}(\\xi)$ followed by the number of degrees of freedom per node for the plate element. No rounding is needed.", "solution": "This problem consists of two parts. Part A requires the explicit construction of cubic Hermite shape functions for a 2-node Euler-Bernoulli beam element. Part B requires the deduction of the nodal degrees of freedom for a $C^{1}$-continuous rectangular Kirchhoff-Love plate element.\n\n### Part A: Beam Element Shape Functions\n\nThe transverse displacement field $w(\\xi)$ is interpolated using four cubic Hermite shape functions $N_{i}(\\xi)$ over the parent domain $\\xi \\in [-1, 1]$. The interpolation is given as:\n$$w(\\xi) = N_{1}(\\xi)w_{1} + N_{2}(\\xi)L\\theta_{1} + N_{3}(\\xi)w_{2} + N_{4}(\\xi)L\\theta_{2}$$\nwhere $\\{w_{1}, \\theta_{1}\\}$ are the displacement and rotation at node $1$ ($\\xi=-1$) and $\\{w_{2}, \\theta_{2}\\}$ are the displacement and rotation at node $2$ ($\\xi=1$). The length of the element is $L$.\n\nThe problem states the enforcement of four conditions corresponding to the nodal degrees of freedom:\n1.  $w(-1) = w_{1}$\n2.  $w(1) = w_{2}$\n3.  $\\left.\\frac{\\mathrm{d}w}{\\mathrm{d}x}\\right|_{\\xi=-1} = \\theta_{1}$\n4.  $\\left.\\frac{\\mathrm{d}w}{\\mathrm{d}x}\\right|_{\\xi=1} = \\theta_{2}$\n\nThe relationship between derivatives in the physical coordinate $x$ and the parent coordinate $\\xi$ is given by the chain rule and the isoparametric mapping $x = x_{c} + \\frac{L}{2}\\xi$:\n$$\\frac{\\mathrm{d}}{\\mathrm{d}x} = \\frac{\\mathrm{d}\\xi}{\\mathrm{d}x} \\frac{\\mathrm{d}}{\\mathrm{d}\\xi} = \\frac{2}{L} \\frac{\\mathrm{d}}{\\mathrm{d}\\xi}$$\nApplying this, the slope conditions become:\n3. $\\frac{2}{L} \\left.\\frac{\\mathrm{d}w}{\\mathrm{d}\\xi}\\right|_{\\xi=-1} = \\theta_{1}$\n4. $\\frac{2}{L} \\left.\\frac{\\mathrm{d}w}{\\mathrm{d}\\xi}\\right|_{\\xi=1} = \\theta_{2}$\n\nBy substituting the interpolation expression for $w(\\xi)$ into these four conditions and requiring them to hold for arbitrary nodal values $\\{w_{1}, \\theta_{1}, w_{2}, \\theta_{2}\\}$, we obtain the conditions that each shape function $N_{i}(\\xi)$ must satisfy. Each $N_{i}(\\xi)$ is a cubic polynomial of the form $a\\xi^3+b\\xi^2+c\\xi+d$.\n\n**For $N_1(\\xi)$:**\nThis function is associated with $w_{1}$. Setting $w_{1}=1$ and all other DOFs to zero gives $w(\\xi)=N_1(\\xi)$.\n1.  $N_{1}(-1) = 1$\n2.  $N_{1}(1) = 0$\n3.  $\\frac{2}{L}\\left.\\frac{\\mathrm{d}N_{1}}{\\mathrm{d}\\xi}\\right|_{\\xi=-1}=0 \\implies N_{1}'(-1)=0$\n4.  $\\frac{2}{L}\\left.\\frac{\\mathrm{d}N_{1}}{\\mathrm{d}\\xi}\\right|_{\\xi=1}=0 \\implies N_{1}'(1)=0$\n\n**For $N_2(\\xi)$:**\nThis function is associated with $L\\theta_{1}$. Setting $L\\theta_{1}=1$ (i.e., $\\theta_1=1/L$) and all other DOFs to zero gives $w(\\xi)=N_2(\\xi)$.\n1.  $N_{2}(-1) = 0$\n2.  $N_{2}(1) = 0$\n3.  $\\frac{2}{L}\\left.\\frac{\\mathrm{d}N_{2}}{\\mathrm{d}\\xi}\\right|_{\\xi=-1} = \\frac{1}{L} \\implies N_{2}'(-1) = \\frac{1}{2}$\n4.  $\\frac{2}{L}\\left.\\frac{\\mathrm{d}N_{2}}{\\mathrm{d}\\xi}\\right|_{\\xi=1} = 0 \\implies N_{2}'(1) = 0$\n\n**For $N_3(\\xi)$:**\nThis function is associated with $w_{2}$.\n1.  $N_{3}(-1) = 0$\n2.  $N_{3}(1) = 1$\n3.  $N_{3}'(-1) = 0$\n4.  $N_{3}'(1) = 0$\n\n**For $N_4(\\xi)$:**\nThis function is associated with $L\\theta_{2}$.\n1.  $N_{4}(-1) = 0$\n2.  $N_{4}(1) = 0$\n3.  $N_{4}'(-1) = 0$\n4.  $\\frac{2}{L}\\left.\\frac{\\mathrm{d}N_{4}}{\\mathrm{d}\\xi}\\right|_{\\xi=1} = \\frac{1}{L} \\implies N_{4}'(1) = \\frac{1}{2}$\n\nWe now solve for the polynomial coefficients for each shape function.\nLet $N(\\xi) = a\\xi^{3} + b\\xi^{2} + c\\xi + d$. Then $N'(\\xi) = 3a\\xi^{2} + 2b\\xi + c$.\n\n**Derivation of $N_{1}(\\xi)$:** The conditions yield the system:\n1.  $-a + b - c + d = 1$\n2.  $a + b + c + d = 0$\n3.  $3a - 2b + c = 0$\n4.  $3a + 2b + c = 0$\nFrom (3) and (4), $4b=0 \\implies b=0$, which gives $c=-3a$. From (1) and (2), $2b+2d=1 \\implies d=1/2$, and $2a+2c=-1$. Substituting $c=-3a$ yields $2a-6a=-1 \\implies -4a=-1 \\implies a=1/4$. Thus, $c=-3/4$.\nSo, $N_{1}(\\xi) = \\frac{1}{4}\\xi^{3} - \\frac{3}{4}\\xi + \\frac{1}{2}$.\n\n**Derivation of $N_{3}(\\xi)$:** From the conditions, we can observe that $N_{3}(\\xi)$ is related to $N_{1}(\\xi)$ by the transformation $\\xi \\to -\\xi$. Thus, $N_{3}(\\xi) = N_{1}(-\\xi)$.\n$N_{3}(\\xi) = \\frac{1}{4}(-\\xi)^{3} - \\frac{3}{4}(-\\xi) + \\frac{1}{2} = -\\frac{1}{4}\\xi^{3} + \\frac{3}{4}\\xi + \\frac{1}{2}$.\n\n**Derivation of $N_{2}(\\xi)$:** The conditions yield the system:\n1.  $-a + b - c + d = 0$\n2.  $a + b + c + d = 0$\n3.  $3a - 2b + c = 1/2$\n4.  $3a + 2b + c = 0$\nFrom (1) and (2), $b+d=0 \\implies d=-b$ and $a+c=0 \\implies c=-a$. Substituting into (3) and (4):\n3. $3a-2b-a = 1/2 \\implies 2a-2b=1/2$\n4. $3a+2b-a = 0 \\implies 2a+2b=0 \\implies a=-b$.\nSubstituting $a=-b$ into $2a-2b=1/2$ gives $2(-b)-2b=1/2 \\implies -4b=1/2 \\implies b=-1/8$. Then $a=1/8$, $c=-1/8$, and $d=1/8$.\nSo, $N_{2}(\\xi) = \\frac{1}{8}\\xi^{3} - \\frac{1}{8}\\xi^{2} - \\frac{1}{8}\\xi + \\frac{1}{8}$.\n\n**Derivation of $N_{4}(\\xi)$:** The conditions on $N_{4}(\\xi)$ can be related to those on $N_{2}(\\xi)$. Let $g(\\xi) = -N_{2}(-\\xi)$. Then $g(-1) = -N_{2}(1) = 0$, $g(1) = -N_{2}(-1) = 0$. The derivative is $g'(\\xi) = -(-1)N_{2}'(-\\xi) = N_{2}'(-\\xi)$. So $g'(-1) = N_{2}'(1) = 0$ and $g'(1) = N_{2}'(-1) = 1/2$. These are precisely the conditions for $N_{4}(\\xi)$. Thus, $N_{4}(\\xi) = -N_{2}(-\\xi)$.\n$N_{4}(\\xi) = -(\\frac{1}{8}(-\\xi)^{3} - \\frac{1}{8}(-\\xi)^{2} - \\frac{1}{8}(-\\xi) + \\frac{1}{8}) = -(-\\frac{1}{8}\\xi^{3} - \\frac{1}{8}\\xi^{2} + \\frac{1}{8}\\xi + \\frac{1}{8}) = \\frac{1}{8}\\xi^{3} + \\frac{1}{8}\\xi^{2} - \\frac{1}{8}\\xi - \\frac{1}{8}$.\n\nThe four shape functions as explicit polynomials in $\\xi$ are:\n$N_{1}(\\xi) = \\frac{1}{4}\\xi^3 - \\frac{3}{4}\\xi + \\frac{1}{2}$\n$N_{2}(\\xi) = \\frac{1}{8}\\xi^3 - \\frac{1}{8}\\xi^2 - \\frac{1}{8}\\xi + \\frac{1}{8}$\n$N_{3}(\\xi) = -\\frac{1}{4}\\xi^3 + \\frac{3}{4}\\xi + \\frac{1}{2}$\n$N_{4}(\\xi) = \\frac{1}{8}\\xi^3 + \\frac{1}{8}\\xi^2 - \\frac{1}{8}\\xi - \\frac{1}{8}$\n\n### Part B: Plate Element Degrees of Freedom\n\nFor a thin plate governed by Kirchhoff-Love theory, the strain energy involves second derivatives of the transverse displacement $w(x, y)$. To formulate a conforming (or $C^{1}$-continuous) finite element, both the displacement $w$ and its normal derivative $\\frac{\\partial w}{\\partial n}$ must be continuous across inter-element boundaries. For a rectangular element with sides parallel to the $x$ and $y$ axes, this implies that $w$, $\\frac{\\partial w}{\\partial x}$, and $\\frac{\\partial w}{\\partial y}$ must be continuous across element edges.\n\nThe problem suggests a tensor-product construction based on the 1D Hermite cubics from Part A. The 1D interpolation guarantees continuity of value and first derivative at the nodes. Extending this to 2D via a tensor product results in a bicubic polynomial space for $w(x, y)$, which can be expressed in parent coordinates $(\\xi, \\eta)$ as:\n$$w(\\xi, \\eta) = \\sum_{i=0}^{3} \\sum_{j=0}^{3} c_{ij} \\xi^{i} \\eta^{j}$$\nThis polynomial has $16$ coefficients, so the element must have a total of $16$ degrees of freedom (DOFs). For a $4$-node rectangular element, this requires $16/4 = 4$ DOFs per node.\n\nWe must deduce the specific set of nodal parameters (DOFs) that ensures $C^{1}$ continuity. Let's analyze the continuity along an edge, for example, an edge where $\\eta = \\text{constant}$.\n1.  **Continuity of $w$**: Along this edge, $w$ is a cubic polynomial in $\\xi$. A cubic polynomial is uniquely determined by four parameters. To ensure its continuity is solely dependent on the two nodes on that edge, we can specify the value $w$ and the tangential slope $\\frac{\\partial w}{\\partial \\xi}$ at each of the two nodes. This accounts for $2+2=4$ parameters. So, $w$ and $\\frac{\\partial w}{\\partial x}$ (which is proportional to $\\frac{\\partial w}{\\partial \\xi}$) must be nodal DOFs.\n2.  **Continuity of the normal derivative $\\frac{\\partial w}{\\partial \\eta}$**: Along the same edge, $\\frac{\\partial w}{\\partial \\eta}$ is also a cubic polynomial in $\\xi$. To define it uniquely by the DOFs of the two nodes on the edge, we can again specify its value and its tangential derivative at each node. The required parameters are $\\frac{\\partial w}{\\partial \\eta}$ and $\\frac{\\partial}{\\partial \\xi}(\\frac{\\partial w}{\\partial \\eta}) = \\frac{\\partial^{2} w}{\\partial \\xi \\partial \\eta}$ at each of the two nodes.\n\nCombining the requirements from analyzing edges parallel to both axes, the minimal set of nodal parameters at each corner node to ensure full $C^{1}$ continuity of a bicubic field is:\n1.  The displacement: $w$\n2.  The slope about the $y$-axis: $\\frac{\\partial w}{\\partial x}$\n3.  The slope about the $x$-axis: $\\frac{\\partial w}{\\partial y}$\n4.  The mixed partial derivative (twist): $\\frac{\\partial^{2} w}{\\partial x \\partial y}$\n\nThis set comprises four parameters. Thus, the number of degrees of freedom per node is $4$. This set allows for unique definition of the cubic variation of both $w$ and its normal derivative along any edge, based only on the parameters at the edge's two endpoints, thereby guaranteeing inter-element $C^{1}$ continuity.\n\nThe number of degrees of freedom per node for the plate element is $4$.", "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{1}{2} - \\frac{3}{4}\\xi + \\frac{1}{4}\\xi^3 & \\frac{1}{8} - \\frac{1}{8}\\xi - \\frac{1}{8}\\xi^2 + \\frac{1}{8}\\xi^3 & \\frac{1}{2} + \\frac{3}{4}\\xi - \\frac{1}{4}\\xi^3 & -\\frac{1}{8} - \\frac{1}{8}\\xi + \\frac{1}{8}\\xi^2 + \\frac{1}{8}\\xi^3 & 4 \\end{pmatrix}}\n$$", "id": "3551396"}, {"introduction": "A crucial step in finite element development is verification, ensuring that the formulation correctly represents fundamental physical behaviors. The patch test is the gold standard for this process, confirming that an element can exactly reproduce a state of constant strain, even on a distorted mesh. This practice challenges you to design the precise displacement and rotation fields for both membrane and bending patch tests for a Reissner-Mindlin shell, connecting the abstract kinematic assumptions to concrete stress resultants [@problem_id:3551339].", "problem": "Consider a single four-node isoparametric bilinear quadrilateral shell element embedded in a distorted physical domain. The element’s nodal coordinates in the global Cartesian physical space are given by the convex quadrilateral with vertices at $(0,0)$, $(2,0.2)$, $(1.8,1.0)$, and $(0.1,0.9)$. The shell is homogeneous, isotropic, linearly elastic, and obeys small-strain, small-rotation kinematics. Let the shell thickness be $t$, the Young’s modulus be $E$, the Poisson’s ratio be $\\nu$, and the transverse shear correction factor be $k_{s}$. Assume a Reissner–Mindlin kinematic description with midsurface in-plane displacements $u(x,y)$ and $v(x,y)$, transverse displacement $w(x,y)$, and independent rotations $\\beta_{x}(x,y)$ and $\\beta_{y}(x,y)$ about the $y$- and $x$-axes, respectively. Work entirely in the physical coordinates $(x,y)$.\n\nYour goal is to design exact displacement and rotation fields that serve as membrane and bending patch tests for this distorted element and to derive the corresponding constant stress resultants. Proceed as follows.\n\n1. Membrane patch test:\n   - Specify explicit fields $u(x,y)$, $v(x,y)$, $w(x,y)$, $\\beta_{x}(x,y)$, $\\beta_{y}(x,y)$ that produce constant in-plane membrane strains $\\varepsilon_{x}^{0}$, $\\varepsilon_{y}^{0}$, and $\\gamma_{xy}^{0}$ everywhere in the element, with zero bending curvatures and zero transverse shear strains. Your fields must be parameterized by the target constants $\\varepsilon_{x}^{0}$, $\\varepsilon_{y}^{0}$, and $\\gamma_{xy}^{0}$ and must remain exact irrespective of the bilinear mapping distortion.\n   - Using three-dimensional small-strain linear elasticity reduced to plane stress in the midsurface and through-thickness integration, derive the constant membrane force resultants $N_{x}$, $N_{y}$, and $N_{xy}$ associated with your fields in terms of $E$, $\\nu$, $t$, and the target constants.\n\n2. Bending patch test:\n   - Specify explicit fields $u(x,y)$, $v(x,y)$, $w(x,y)$, $\\beta_{x}(x,y)$, $\\beta_{y}(x,y)$ that produce constant bending curvatures $\\kappa_{x}^{0}$, $\\kappa_{y}^{0}$, and $\\kappa_{xy}^{0}$ everywhere in the element, with zero midsurface membrane strains and zero transverse shear strains. Your fields must be parameterized by the target constants $\\kappa_{x}^{0}$, $\\kappa_{y}^{0}$, and $\\kappa_{xy}^{0}$ and must remain exact irrespective of the bilinear mapping distortion.\n   - Starting from the same fundamental kinematics, plane stress elasticity, and through-thickness integration, derive the constant bending moment resultants $M_{x}$, $M_{y}$, and $M_{xy}$ associated with your fields in terms of $E$, $\\nu$, and $t$ and the target constants.\n\nAssume the standard small-strain measures for the midsurface membrane strains $\\varepsilon_{x}^{0}$, $\\varepsilon_{y}^{0}$, and the engineering shear $\\gamma_{xy}^{0}$, the Reissner–Mindlin transverse shear strains $\\gamma_{xz}$ and $\\gamma_{yz}$, and the engineering bending curvatures $\\kappa_{x}$, $\\kappa_{y}$, and $\\kappa_{xy}$. You may treat the transverse shear resultants as zero for the bending patch by construction. Express the final result as a single analytic expression for the row vector $[N_{x},\\,N_{y},\\,N_{xy},\\,M_{x},\\,M_{y},\\,M_{xy}]$ in terms of $E$, $\\nu$, $t$, and the six target constants. No numerical values are required.\n\nRound-off is not required. Do not include units in your final boxed answer; all symbols must be clearly defined in your derivation. Angles are to be considered in radians where applicable.", "solution": "The problem statement is a valid, well-posed, and scientifically grounded exercise in the theory of computational shell mechanics. It requests the design of analytical displacement and rotation fields for membrane and bending patch tests of a four-node quadrilateral shell element and the derivation of the corresponding constant stress resultants. The provided nodal coordinates serve only to establish that the element is geometrically distorted; the derivation must be general and independent of these specific coordinates.\n\nWe begin by defining the fundamental kinematic and constitutive relations for a linearly elastic, isotropic Reissner–Mindlin shell undergoing small strains and rotations.\n\nThe degrees of freedom are the midsurface displacements $u(x,y)$, $v(x,y)$, $w(x,y)$ and the independent rotations of the midsurface normal, $\\beta_{x}(x,y)$ and $\\beta_{y}(x,y)$. As per the problem statement, $\\beta_{x}$ is the rotation about the $y$-axis, and $\\beta_{y}$ is the rotation about the $x$-axis.\n\nThe standard small-strain kinematic relations are:\nMidsurface membrane strains (engineering):\n$$ \\varepsilon_{x} = \\frac{\\partial u}{\\partial x}, \\quad \\varepsilon_{y} = \\frac{\\partial v}{\\partial y}, \\quad \\gamma_{xy} = \\frac{\\partial u}{\\partial y} + \\frac{\\partial v}{\\partial x} $$\nBending curvatures (engineering):\nThe problem text provides potentially non-standard definitions. To ensure a physically meaningful and general solution for constant curvature states, we adopt the standard engineering definitions derived from the gradients of the rotation fields. With $\\beta_y$ as the rotation about the $x$-axis and $\\beta_x$ as the rotation about the $y$-axis, the curvatures are:\n$$ \\kappa_{x} = \\frac{\\partial \\beta_{y}}{\\partial x}, \\quad \\kappa_{y} = \\frac{\\partial \\beta_{x}}{\\partial y}, \\quad \\kappa_{xy} = \\frac{\\partial \\beta_{y}}{\\partial y} + \\frac{\\partial \\beta_{x}}{\\partial x} $$\nTransverse shear strains (engineering):\n$$ \\gamma_{xz} = \\frac{\\partial w}{\\partial x} + \\beta_{y}, \\quad \\gamma_{yz} = \\frac{\\partial w}{\\partial y} + \\beta_{x} $$\nThe stress resultants (forces and moments per unit length) are related to the strains and curvatures through the plane stress constitutive relations, integrated through the shell thickness $t$. For a homogeneous, isotropic material with Young's modulus $E$ and Poisson's ratio $\\nu$:\n\nThe membrane force resultants are:\n$$\n\\begin{pmatrix} N_{x} \\\\ N_{y} \\\\ N_{xy} \\end{pmatrix} = \\frac{E t}{1-\\nu^2} \\begin{pmatrix} 1 & \\nu & 0 \\\\ \\nu & 1 & 0 \\\\ 0 & 0 & \\frac{1-\\nu}{2} \\end{pmatrix} \\begin{pmatrix} \\varepsilon_{x} \\\\ \\varepsilon_{y} \\\\ \\gamma_{xy} \\end{pmatrix}\n$$\nThe bending moment resultants are:\n$$\n\\begin{pmatrix} M_{x} \\\\ M_{y} \\\\ M_{xy} \\end{pmatrix} = \\frac{E t^3}{12(1-\\nu^2)} \\begin{pmatrix} 1 & \\nu & 0 \\\\ \\nu & 1 & 0 \\\\ 0 & 0 & \\frac{1-\\nu}{2} \\end{pmatrix} \\begin{pmatrix} \\kappa_{x} \\\\ \\kappa_{y} \\\\ \\kappa_{xy} \\end{pmatrix}\n$$\nThe problem can be solved by considering the membrane and bending patch tests separately and then combining the results by linear superposition.\n\n**1. Membrane Patch Test**\n\nThe goal is to find fields that produce a state of constant membrane strain, $(\\varepsilon_{x}, \\varepsilon_{y}, \\gamma_{xy}) = (\\varepsilon_{x}^{0}, \\varepsilon_{y}^{0}, \\gamma_{xy}^{0})$, with zero bending curvatures and zero transverse shear strains.\n\nTo achieve constant membrane strains, we integrate the strain-displacement relations:\n$\\frac{\\partial u}{\\partial x} = \\varepsilon_{x}^{0} \\implies u(x,y) = \\varepsilon_{x}^{0}x + f(y)$\n$\\frac{\\partial v}{\\partial y} = \\varepsilon_{y}^{0} \\implies v(x,y) = \\varepsilon_{y}^{0}y + g(x)$\nSubstituting into the shear strain definition:\n$\\gamma_{xy}^{0} = \\frac{\\partial u}{\\partial y} + \\frac{\\partial v}{\\partial x} = f'(y) + g'(x)$\nFor this to hold for all $(x,y)$, $f'(y)$ and $g'(x)$ must be constants. A symmetric choice is $f'(y) = g'(x) = \\frac{\\gamma_{xy}^{0}}{2}$.\nIntegrating these gives $f(y) = \\frac{\\gamma_{xy}^{0}}{2}y + C_1$ and $g(x) = \\frac{\\gamma_{xy}^{0}}{2}x + C_2$.\nThe constants of integration can be expressed in terms of rigid-body motion parameters: in-plane translations $u_r, v_r$ and a rotation $\\omega_r$ about the $z$-axis.\n$u(x,y) = \\varepsilon_{x}^{0}x + \\frac{\\gamma_{xy}^{0}}{2}y + u_r - \\omega_r y$\n$v(x,y) = \\frac{\\gamma_{xy}^{0}}{2}x + \\varepsilon_{y}^{0}y + v_r + \\omega_r x$\n\nTo ensure zero bending curvatures, the gradients of the rotation fields must be zero. This implies $\\beta_x$ and $\\beta_y$ must be constants, which correspond to rigid-body tilts. Let $\\beta_x = \\beta_{xr}$ and $\\beta_y = \\beta_{yr}$.\n\nTo ensure zero transverse shear strains:\n$\\gamma_{xz} = \\frac{\\partial w}{\\partial x} + \\beta_y = 0 \\implies \\frac{\\partial w}{\\partial x} = -\\beta_{yr}$\n$\\gamma_{yz} = \\frac{\\partial w}{\\partial y} + \\beta_x = 0 \\implies \\frac{\\partial w}{\\partial y} = -\\beta_{xr}$\nIntegrating these yields the transverse displacement field:\n$w(x,y) = - \\beta_{yr} x - \\beta_{xr} y + w_r$, where $w_r$ is a rigid-body translation.\n\nThe complete fields for the membrane patch test are linear in $x$ and $y$. Any non-degenerate four-node isoparametric element can exactly represent linear fields. Thus, this state can be exactly reproduced. The rigid-body motion parameters $(u_r, v_r, w_r, \\omega_r, \\beta_{xr}, \\beta_{yr})$ do not induce any stresses or strains.\n\nThe membrane force resultants are found by substituting the constant strains into the constitutive relation:\n$N_{x} = \\frac{E t}{1-\\nu^2}(\\varepsilon_{x}^{0} + \\nu \\varepsilon_{y}^{0})$\n$N_{y} = \\frac{E t}{1-\\nu^2}(\\nu \\varepsilon_{x}^{0} + \\varepsilon_{y}^{0})$\n$N_{xy} = \\frac{E t}{1-\\nu^2} \\frac{1-\\nu}{2} \\gamma_{xy}^{0} = \\frac{E t}{2(1+\\nu)} \\gamma_{xy}^{0}$\nSince curvatures are zero, $M_x = M_y = M_{xy} = 0$.\n\n**2. Bending Patch Test**\n\nThe goal is to find fields producing a state of constant bending curvature, $(\\kappa_{x}, \\kappa_{y}, \\kappa_{xy}) = (\\kappa_{x}^{0}, \\kappa_{y}^{0}, \\kappa_{xy}^{0})$, with zero membrane and transverse shear strains.\n\nTo achieve constant curvatures, we integrate the curvature-rotation relations:\n$\\frac{\\partial \\beta_{y}}{\\partial x} = \\kappa_{x}^{0} \\implies \\beta_y(x,y) = \\kappa_{x}^{0}x + f(y)$\n$\\frac{\\partial \\beta_{x}}{\\partial y} = \\kappa_{y}^{0} \\implies \\beta_x(x,y) = \\kappa_{y}^{0}y + g(x)$\nSubstituting into the twist curvature definition:\n$\\kappa_{xy}^{0} = \\frac{\\partial \\beta_{y}}{\\partial y} + \\frac{\\partial \\beta_{x}}{\\partial x} = f'(y) + g'(x)$\nA symmetric choice is $f'(y) = g'(x) = \\frac{\\kappa_{xy}^{0}}{2}$. Integrating and including rigid-body tilt constants $\\beta_{xr}, \\beta_{yr}$:\n$\\beta_x(x,y) = \\frac{\\kappa_{xy}^{0}}{2}x + \\kappa_{y}^{0}y + \\beta_{xr}$\n$\\beta_y(x,y) = \\kappa_{x}^{0}x + \\frac{\\kappa_{xy}^{0}}{2}y + \\beta_{yr}$\n\nTo ensure zero membrane strains, the in-plane displacements must represent a rigid-body motion:\n$u(x,y) = u_r - \\omega_r y$\n$v(x,y) = v_r + \\omega_r x$\n\nTo ensure zero transverse shear strains, we integrate $\\frac{\\partial w}{\\partial x} = -\\beta_y$ and $\\frac{\\partial w}{\\partial y} = -\\beta_x$:\n$\\frac{\\partial w}{\\partial x} = -(\\kappa_{x}^{0}x + \\frac{\\kappa_{xy}^{0}}{2}y + \\beta_{yr})$\n$\\frac{\\partial w}{\\partial y} = -(\\frac{\\kappa_{xy}^{0}}{2}x + \\kappa_{y}^{0}y + \\beta_{xr})$\nIntegrating the first equation with respect to $x$ gives:\n$w(x,y) = -\\frac{\\kappa_{x}^{0}}{2}x^2 - \\frac{\\kappa_{xy}^{0}}{2}xy - \\beta_{yr}x + h(y)$\nDifferentiating with respect to $y$ and equating to the second condition:\n$\\frac{\\partial w}{\\partial y} = -\\frac{\\kappa_{xy}^{0}}{2}x + h'(y) = -\\frac{\\kappa_{xy}^{0}}{2}x - \\kappa_{y}^{0}y - \\beta_{xr}$\n$h'(y) = -\\kappa_{y}^{0}y - \\beta_{xr} \\implies h(y) = -\\frac{\\kappa_{y}^{0}}{2}y^2 - \\beta_{xr}y + w_r$.\nThe required transverse displacement field is quadratic:\n$w(x,y) = -\\frac{1}{2}(\\kappa_{x}^{0}x^2 + \\kappa_{y}^{0}y^2 + \\kappa_{xy}^{0}xy) - \\beta_{yr}x - \\beta_{xr}y + w_r$\n\nThe bending moment resultants are found by substituting the constant curvatures into the constitutive relation:\n$M_{x} = \\frac{E t^3}{12(1-\\nu^2)}(\\kappa_{x}^{0} + \\nu \\kappa_{y}^{0})$\n$M_{y} = \\frac{E t^3}{12(1-\\nu^2)}(\\nu \\kappa_{x}^{0} + \\kappa_{y}^{0})$\n$M_{xy} = \\frac{E t^3}{12(1-\\nu^2)} \\frac{1-\\nu}{2} \\kappa_{xy}^{0} = \\frac{E t^3}{24(1+\\nu)} \\kappa_{xy}^{0}$\nSince membrane strains are zero, $N_x = N_y = N_{xy} = 0$.\n\n**Combined Resultants**\nDue to the linearity of the underlying theory, a general state of constant membrane strain and constant bending curvature can be achieved by superposing the displacement and rotation fields derived in the two tests. The resulting stress resultants are the sum of the resultants from each test. The problem asks for the single row vector of resultants in terms of the six target constants $\\varepsilon_{x}^{0}, \\varepsilon_{y}^{0}, \\gamma_{xy}^{0}, \\kappa_{x}^{0}, \\kappa_{y}^{0}, \\kappa_{xy}^{0}$.\n\nCombining the results, we have:\n$N_{x} = \\frac{Et}{1-\\nu^2}(\\varepsilon_{x}^{0} + \\nu\\varepsilon_{y}^{0})$\n$N_{y} = \\frac{Et}{1-\\nu^2}(\\nu\\varepsilon_{x}^{0} + \\varepsilon_{y}^{0})$\n$N_{xy} = \\frac{Et}{2(1+\\nu)}\\gamma_{xy}^{0}$\n$M_{x} = \\frac{Et^3}{12(1-\\nu^2)}(\\kappa_{x}^{0} + \\nu\\kappa_{y}^{0})$\n$M_{y} = \\frac{Et^3}{12(1-\\nu^2)}(\\nu\\kappa_{x}^{0} + \\kappa_{y}^{0})$\n$M_{xy} = \\frac{Et^3}{24(1+\\nu)}\\kappa_{xy}^{0}$\n\nThese expressions constitute the analytical solution that a correctly formulated finite element implementation should reproduce to pass the patch test. The constants associated with rigid-body motions do not contribute to strains or stresses and therefore do not appear in the final expressions for the resultants.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{Et}{1-\\nu^2}(\\varepsilon_{x}^{0} + \\nu\\varepsilon_{y}^{0}) & \\frac{Et}{1-\\nu^2}(\\nu\\varepsilon_{x}^{0} + \\varepsilon_{y}^{0}) & \\frac{Et}{2(1+\\nu)}\\gamma_{xy}^{0} & \\frac{Et^3}{12(1-\\nu^2)}(\\kappa_{x}^{0} + \\nu\\kappa_{y}^{0}) & \\frac{Et^3}{12(1-\\nu^2)}(\\nu\\kappa_{x}^{0} + \\kappa_{y}^{0}) & \\frac{Et^3}{24(1+\\nu)}\\kappa_{xy}^{0}\n\\end{pmatrix}\n}\n$$", "id": "3551339"}, {"introduction": "While the patch test verifies basic consistency, it does not guarantee robust performance in all scenarios, and Reissner-Mindlin elements are famously susceptible to \"shear locking\" in the thin-plate limit. This numerical exercise guides you through designing and implementing a benchmark to diagnose this pathology by comparing a standard element formulation against one using selective reduced integration (SRI). This practice provides direct insight into why specific numerical techniques are essential for developing reliable and accurate shell elements [@problem_id:3551332].", "problem": "You are asked to design and implement a self-contained numerical benchmark that exposes shear locking in Reissner–Mindlin plate elements for soil-like materials by driving the effective shear stiffness to zero while resting on a soft Winkler foundation. Starting from the principle of virtual work, discretize the governing equations for a clamped, uniformly loaded square plate using bilinear quadrilateral elements and compare two element families whose only difference is the treatment of the transverse shear terms: full Gauss integration versus selective reduced integration. Quantify the locking by the ratio of central deflection between the two formulations over a sweep of shear-modulus scaling parameters and mesh densities.\n\nThe fundamental starting point must be the following. The Reissner–Mindlin plate kinematics assume a transverse displacement field $w(x,y)$ and independent rotations $\\theta_x(x,y)$ and $\\theta_y(x,y)$. The curvature strains are $\\kappa_x = \\partial \\theta_x / \\partial x$, $\\kappa_y = \\partial \\theta_y / \\partial y$, and $\\kappa_{xy} = \\partial \\theta_x / \\partial y + \\partial \\theta_y / \\partial x$. The transverse shear strains are $\\gamma_{xz} = \\theta_x + \\partial w / \\partial x$ and $\\gamma_{yz} = \\theta_y + \\partial w / \\partial y$. The strain energy density is a sum of bending and shear contributions, and the potential of a Winkler foundation with stiffness $k$ adds a local penalty on $w$. The virtual work statement equates the internal virtual work to the external virtual work from a uniform load $q$.\n\nYou must discretize this problem using bilinear quadrilateral ($\\mathrm{Q}4$) isoparametric elements on a structured mesh over a square domain of side length $L$. Use a clamped boundary condition ($w=\\theta_x=\\theta_y=0$) on all edges. Construct the element bending stiffness by integrating the curvature terms with the exact same quadrature across all formulations. Construct the element shear stiffness in two different ways:\n- Formulation A (Full): integrate the shear energy with a standard $2\\times 2$ Gauss rule.\n- Formulation B (Selective Reduced Integration, SRI): integrate the shear energy with a single Gauss point at the element center.\n\nKeep the bending stiffness unchanged between A and B so that only the shear treatment differs.\n\nTo model soil-like behavior, introduce a scalar factor $\\alpha \\in (0,1]$ that scales the effective shear modulus as $G_{\\mathrm{eff}} = \\alpha \\, G_0$, where $G_0$ is the shear modulus computed from Young’s modulus $E$ and Poisson’s ratio $\\nu$ through $G_0 = E / (2(1+\\nu))$. The bending stiffness must remain tied to $E$ and $\\nu$ without scaling, while the shear stiffness uses $G_{\\mathrm{eff}}$. This separation mimics a material with bending rigidity controlled by $E$ and $\\nu$ but with independently tunable transverse shear softness, which is a standard device in Reissner–Mindlin benchmarking.\n\nStart from the virtual work principle and the standard isoparametric finite element method to derive your element matrices. Do not use any shortcut formulas for Mindlin elements. Carry the Winkler foundation contribution by adding a consistent $w$–$w$ stiffness term at the element level. Assemble the global system, apply clamped boundary conditions on all boundary nodes, and solve the linear system to obtain nodal values of $w$, $\\theta_x$, and $\\theta_y$.\n\nUse the following physically plausible and self-consistent parameters and units, and keep them fixed for all test cases unless explicitly varied:\n- Geometry: square plate with side length $L = 1\\,\\mathrm{m}$ and thickness $t = 0.01\\,\\mathrm{m}$.\n- Material for bending: Young’s modulus $E = 30\\times 10^9\\,\\mathrm{Pa}$ and Poisson’s ratio $\\nu = 0.3$.\n- Shear correction factor: $\\kappa_s = 5/6$ applied to the shear stiffness.\n- Uniform transverse load: $q = 1000\\,\\mathrm{N/m^2}$, applied over the entire plate.\n- Winkler foundation: stiffness $k = 1000\\,\\mathrm{N/m^3}$ (soft foundation).\n- Angle quantities are not directly requested; there is no angle unit to report.\n- All displacements that appear internally must be in $\\mathrm{m}$, loads in $\\mathrm{N/m^2}$, stiffnesses in appropriate SI units as consistent above.\n\nDefine the locking indicator for each test case as the ratio\n$$\nR = \\frac{w_{\\mathrm{center}}^{\\mathrm{Full}}}{w_{\\mathrm{center}}^{\\mathrm{SRI}}},\n$$\nwhere $w_{\\mathrm{center}}^{\\mathrm{Full}}$ and $w_{\\mathrm{center}}^{\\mathrm{SRI}}$ are the computed transverse displacements at the geometric center of the plate for Formulations A and B, respectively. Interpret $R<1$ as an underprediction due to shear locking in the fully integrated shear formulation relative to the selective reduced integration formulation.\n\nYour program must implement the above and evaluate the following test suite of parameter combinations, chosen to exercise a normal case, a near-shear-free limit, and mesh sensitivity under a soft Winkler foundation:\n- Case $1$: $(\\alpha, n_x, n_y) = (1.0, 4, 4)$.\n- Case $2$: $(\\alpha, n_x, n_y) = (10^{-3}, 4, 4)$.\n- Case $3$: $(\\alpha, n_x, n_y) = (10^{-6}, 4, 4)$.\n- Case $4$: $(\\alpha, n_x, n_y) = (1.0, 2, 2)$.\n- Case $5$: $(\\alpha, n_x, n_y) = (10^{-6}, 2, 2)$.\n- Case $6$: $(\\alpha, n_x, n_y) = (10^{-6}, 8, 8)$.\n\nHere, $n_x$ and $n_y$ are the number of elements in the $x$ and $y$ directions, respectively. For each case, compute the single scalar $R$ as defined above. The final output from your program must be a single line containing all six $R$ values as a comma-separated list enclosed in square brackets, for example, $[r_1,r_2,r_3,r_4,r_5,r_6]$. Each $r_i$ is a floating-point number without units. No other text must be printed.\n\nNote: All mathematical symbols and numbers inside this statement are given in the International System of Units (SI), and any requested outputs are dimensionless ratios, so no unit conversion is required for the final results.", "solution": "### Principle-Based Derivation and Solution Methodology\n\nThe solution is derived from the principle of virtual work, which states that for a body in equilibrium, the internal virtual work equals the external virtual work for any kinematically admissible virtual displacement. For the given system, this is expressed as:\n$$\n\\delta U_b + \\delta U_s + \\delta U_w = \\delta W_{ext}\n$$\nwhere $\\delta U_b$ is the virtual work of bending, $\\delta U_s$ is the virtual work of transverse shear, $\\delta U_w$ is the virtual work done on the Winkler foundation, and $\\delta W_{ext}$ is the virtual work of the external load.\n\nThe individual terms are:\n$$\n\\delta U_b = \\int_A \\delta\\boldsymbol{\\kappa}^T \\mathbf{M} \\, dA \\quad , \\quad \\delta U_s = \\int_A \\delta\\boldsymbol{\\gamma}^T \\mathbf{Q} \\, dA \\quad , \\quad \\delta U_w = \\int_A \\delta w \\, (k w) \\, dA \\quad , \\quad \\delta W_{ext} = \\int_A \\delta w \\, q \\, dA\n$$\nHere, $\\boldsymbol{\\kappa} = [\\kappa_x, \\kappa_y, \\kappa_{xy}]^T$ is the vector of curvatures, $\\boldsymbol{\\gamma} = [\\gamma_{xz}, \\gamma_{yz}]^T$ is the vector of transverse shear strains, $\\mathbf{M}$ is the vector of bending moments, $\\mathbf{Q}$ is the vector of shear forces, $k$ is the Winkler stiffness, and $q$ is the distributed load.\n\nThe constitutive relations for an isotropic material are $\\mathbf{M} = \\mathbf{C}_b \\boldsymbol{\\kappa}$ and $\\mathbf{Q} = \\mathbf{C}_s \\boldsymbol{\\gamma}$.\nThe bending rigidity matrix $\\mathbf{C}_b$ is:\n$$\n\\mathbf{C}_b = \\frac{E t^3}{12(1-\\nu^2)} \\begin{pmatrix} 1 & \\nu & 0 \\\\ \\nu & 1 & 0 \\\\ 0 & 0 & \\frac{1-\\nu}{2} \\end{pmatrix}\n$$\nThe shear rigidity matrix $\\mathbf{C}_s$ is:\n$$\n\\mathbf{C}_s = \\kappa_s G_{\\mathrm{eff}} t \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix} = \\kappa_s \\left( \\alpha \\frac{E}{2(1+\\nu)} \\right) t \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix}\n$$\nThe factor $\\alpha$ directly scales the shear stiffness, allowing the simulation of thin-plate behavior (where shear locking is prominent) as $\\alpha \\to 0$.\n\nWe discretize the domain using bilinear quadrilateral ($\\mathrm{Q}4$) elements. Within each element, the displacement and rotation fields are interpolated from the nodal degrees of freedom $\\mathbf{d}^e = [w_1, \\theta_{x1}, \\theta_{y1}, \\dots, w_4, \\theta_{x4}, \\theta_{y4}]^T$ using isoparametric shape functions $N_i(\\xi, \\eta)$:\n$$\nw(\\xi, \\eta) = \\sum_{i=1}^{4} N_i w_i \\quad , \\quad \\theta_x(\\xi, \\eta) = \\sum_{i=1}^{4} N_i \\theta_{xi} \\quad , \\quad \\theta_y(\\xi, \\eta) = \\sum_{i=1}^{4} N_i \\theta_{yi}\n$$\nwhere $(\\xi, \\eta)$ are the natural coordinates of the element. The shape function for node $i$ is $N_i(\\xi, \\eta) = \\frac{1}{4}(1+\\xi_i \\xi)(1+\\eta_i \\eta)$.\n\nThe strain fields are related to the nodal DOFs through strain-displacement matrices, $\\mathbf{B}_b$ and $\\mathbf{B}_s$:\n$$\n\\boldsymbol{\\kappa} = \\mathbf{B}_b \\mathbf{d}^e \\quad , \\quad \\boldsymbol{\\gamma} = \\mathbf{B}_s \\mathbf{d}^e\n$$\nAnd the transverse displacement is interpolated as $w = \\mathbf{N}_w \\mathbf{d}^e$. The matrices $\\mathbf{B}_b$ and $\\mathbf{B}_s$ contain spatial derivatives of the shape functions. These derivatives are computed with respect to the global coordinates $(x,y)$ using the Jacobian of the isoparametric mapping.\n\nSubstituting the discretized fields into the principle of virtual work yields the element-level system of equations. For an arbitrary virtual displacement $(\\delta \\mathbf{d}^e)^T$, we obtain the element stiffness matrix $\\mathbf{k}^e$ and force vector $\\mathbf{f}^e$:\n$$\n(\\mathbf{k}_b^e + \\mathbf{k}_s^e + \\mathbf{k}_w^e) \\mathbf{d}^e = \\mathbf{f}^e\n$$\nThe individual element stiffness matrices are computed by numerical integration over the element domain $A^e$:\n$$\n\\mathbf{k}_b^e = \\int_{A^e} \\mathbf{B}_b^T \\mathbf{C}_b \\mathbf{B}_b \\,dA = \\int_{-1}^{1}\\int_{-1}^{1} \\mathbf{B}_b^T \\mathbf{C}_b \\mathbf{B}_b \\det(\\mathbf{J}) \\,d\\xi d\\eta\n$$\n$$\n\\mathbf{k}_s^e = \\int_{A^e} \\mathbf{B}_s^T \\mathbf{C}_s \\mathbf{B}_s \\,dA = \\int_{-1}^{1}\\int_{-1}^{1} \\mathbf{B}_s^T \\mathbf{C}_s \\mathbf{B}_s \\det(\\mathbf{J}) \\,d\\xi d\\eta\n$$\n$$\n\\mathbf{k}_w^e = \\int_{A^e} k \\mathbf{N}_w^T \\mathbf{N}_w \\,dA = \\int_{-1}^{1}\\int_{-1}^{1} k \\mathbf{N}_w^T \\mathbf{N}_w \\det(\\mathbf{J}) \\,d\\xi d\\eta\n$$\nThe element force vector is:\n$$\n\\mathbf{f}^e = \\int_{A^e} q \\mathbf{N}_w^T \\,dA = \\int_{-1}^{1}\\int_{-1}^{1} q \\mathbf{N}_w^T \\det(\\mathbf{J}) \\,d\\xi d\\eta\n$$\nThe core of the benchmark lies in the numerical quadrature used for $\\mathbf{k}_s^e$. For both formulations, $\\mathbf{k}_b^e$, $\\mathbf{k}_w^e$, and $\\mathbf{f}^e$ are computed with a standard $2\\times 2$ Gauss quadrature rule.\n- **Formulation A (Full Integration)**: $\\mathbf{k}_s^e$ is computed using a $2\\times 2$ Gauss quadrature rule. This rule over-constrains the element in the thin-plate limit, leading to shear locking.\n- **Formulation B (Selective Reduced Integration - SRI)**: $\\mathbf{k}_s^e$ is computed using a single Gauss point ($1\\times 1$ rule) at the element center ($\\xi=0, \\eta=0$). This softens the shear response and alleviates locking.\n\nThe element matrices and vectors are assembled into a global system of linear equations $\\mathbf{K}\\mathbf{d} = \\mathbf{F}$. Clamped boundary conditions ($w=\\theta_x=\\theta_y=0$) are enforced for all nodes on the plate's perimeter by eliminating the corresponding rows and columns from the global system. The resulting reduced system is solved for the unknown nodal displacements and rotations $\\mathbf{d}$.\n\nFinally, the transverse displacement $w_{\\mathrm{center}}$ at the geometric center of the plate is identified. Since all specified meshes ($2\\times 2$, $4\\times 4$, $8\\times 8$) have an even number of elements, the plate's center coincides with a node. The locking indicator $R$ is computed for each test case by running the simulation for both Formulation A and Formulation B and taking the ratio of the central deflections, $R = w_{\\mathrm{center}}^{\\mathrm{Full}} / w_{\\mathrm{center}}^{\\mathrm{SRI}}$. A value of $R < 1$ indicates the presence of shear locking in the fully integrated element, as its artificially high stiffness results in a smaller predicted displacement.\n\n```python\nimport numpy as np\nfrom scipy import linalg\n\ndef solve():\n    \"\"\"\n    Main solver function to execute the benchmark for Reissner-Mindlin plates.\n    It iterates through a set of predefined test cases, computes the locking\n    indicator for each, and prints the results in the specified format.\n    \"\"\"\n\n    # Define physical and geometric parameters as per the problem statement.\n    L = 1.0  # m\n    t = 0.01  # m\n    E = 30e9  # Pa\n    nu = 0.3  # Poisson's ratio\n    kappa_s = 5.0 / 6.0  # Shear correction factor\n    q_load = 1000.0  # N/m^2\n    k_winkler = 1000.0  # N/m^3\n\n    params = {\n        'L': L, 't': t, 'E': E, 'nu': nu, 'kappa_s': kappa_s, \n        'q': q_load, 'k': k_winkler\n    }\n\n    # Test cases: (alpha, nx, ny)\n    test_cases = [\n        (1.0, 4, 4),\n        (1e-3, 4, 4),\n        (1e-6, 4, 4),\n        (1.0, 2, 2),\n        (1e-6, 2, 2),\n        (1e-6, 8, 8),\n    ]\n\n    results = []\n    for alpha, nx, ny in test_cases:\n        # Run simulation for Formulation A (Full Integration)\n        w_center_full = run_fem_analysis(nx, ny, alpha, 'full', params)\n        # Run simulation for Formulation B (Selective Reduced Integration)\n        w_center_sri = run_fem_analysis(nx, ny, alpha, 'sri', params)\n\n        if w_center_sri == 0:\n            locking_ratio = np.nan # Avoid division by zero\n        else:\n            # Ratios of displacements are the same regardless of sign convention.\n            locking_ratio = w_center_full / w_center_sri\n        results.append(locking_ratio)\n\n    print(f\"[{','.join(f'{r:.6f}' for r in results)}]\")\n\n\ndef run_fem_analysis(nx, ny, alpha, shear_integration_rule, params):\n    \"\"\"\n    Performs a single Finite Element Analysis for a given mesh, alpha, and integration rule.\n    \n    Args:\n        nx (int): Number of elements in the x-direction.\n        ny (int): Number of elements in the y-direction.\n        alpha (float): Scaling factor for the effective shear modulus.\n        shear_integration_rule (str): 'full' for 2x2 or 'sri' for 1x1 Gauss quadrature.\n        params (dict): Dictionary of physical and geometric parameters.\n    \n    Returns:\n        float: The transverse displacement 'w' at the center of the plate.\n    \"\"\"\n    # Unpack parameters\n    L, t, E, nu, kappa_s, q, k_winkler = params['L'], params['t'], params['E'], params['nu'], params['kappa_s'], params['q'], params['k']\n\n    # --- Mesh Generation ---\n    num_nodes_x = nx + 1\n    num_nodes_y = ny + 1\n    num_nodes = num_nodes_x * num_nodes_y\n    num_dofs = 3 * num_nodes\n    hx, hy = L / nx, L / ny\n\n    node_coords = np.zeros((num_nodes, 2))\n    for i in range(num_nodes_y):\n        for j in range(num_nodes_x):\n            node_idx = i * num_nodes_x + j\n            node_coords[node_idx] = [j * hx, i * hy]\n\n    elements = np.zeros((nx * ny, 4), dtype=int)\n    for i in range(ny):\n        for j in range(nx):\n            el_idx = i * nx + j\n            n1 = i * num_nodes_x + j\n            n2 = i * num_nodes_x + j + 1\n            n3 = (i + 1) * num_nodes_x + j + 1\n            n4 = (i + 1) * num_nodes_x + j\n            elements[el_idx] = [n1, n2, n3, n4]\n\n    # --- Constitutive Matrices ---\n    C_b = (E * t**3) / (12 * (1 - nu**2)) * np.array([\n        [1, nu, 0],\n        [nu, 1, 0],\n        [0, 0, (1 - nu) / 2]\n    ])\n    G_eff = alpha * E / (2 * (1 + nu))\n    C_s = kappa_s * G_eff * t * np.identity(2)\n\n    # --- Gauss Quadrature Points and Weights ---\n    gauss_pts_1d = { 1: [(0.0, 2.0)], 2: [(-1/np.sqrt(3), 1.0), (1/np.sqrt(3), 1.0)] }\n\n    # --- FEM Assembly ---\n    K_global = np.zeros((num_dofs, num_dofs))\n    F_global = np.zeros(num_dofs)\n\n    xi_eta_nodes = np.array([[-1, -1], [1, -1], [1, 1], [-1, 1]])\n\n    for el_nodes in elements:\n        k_elem = np.zeros((12, 12))\n        f_elem = np.zeros(12)\n        det_J = hx * hy / 4.0\n\n        def shape_functions(xi, eta):\n            N = 0.25 * (1 + xi_eta_nodes[:, 0] * xi) * (1 + xi_eta_nodes[:, 1] * eta)\n            dNdxi = 0.25 * xi_eta_nodes[:, 0] * (1 + xi_eta_nodes[:, 1] * eta)\n            dNdeta = 0.25 * xi_eta_nodes[:, 1] * (1 + xi_eta_nodes[:, 0] * xi)\n            return N, dNdxi, dNdeta\n\n        # --- Bending, Winkler, and Force contributions (always 2x2 integration) ---\n        for xi_gp, w_xi in gauss_pts_1d[2]:\n            for eta_gp, w_eta in gauss_pts_1d[2]:\n                N, dNdxi, dNdeta = shape_functions(xi_gp, eta_gp)\n                dNdx = dNdxi * (2.0 / hx)\n                dNdy = dNdeta * (2.0 / hy)\n                \n                B_b = np.zeros((3, 12))\n                N_w = np.zeros((1, 12))\n                for i in range(4):\n                    B_b[0, 3 * i + 1] = dNdx[i]\n                    B_b[1, 3 * i + 2] = dNdy[i]\n                    B_b[2, 3 * i + 1] = dNdy[i]\n                    B_b[2, 3 * i + 2] = dNdx[i]\n                    N_w[0, 3 * i] = N[i]\n\n                weight = det_J * w_xi * w_eta\n                k_elem += (B_b.T @ C_b @ B_b) * weight\n                k_elem += (k_winkler * N_w.T @ N_w) * weight\n                for i in range(4):\n                    f_elem[3 * i] += N[i] * q * weight\n        \n        # --- Shear contribution (full or SRI) ---\n        n_gp_shear = 2 if shear_integration_rule == 'full' else 1\n        for xi_gp, w_xi in gauss_pts_1d[n_gp_shear]:\n            for eta_gp, w_eta in gauss_pts_1d[n_gp_shear]:\n                N, dNdxi, dNdeta = shape_functions(xi_gp, eta_gp)\n                dNdx = dNdxi * (2.0 / hx)\n                dNdy = dNdeta * (2.0 / hy)\n                \n                B_s = np.zeros((2, 12))\n                for i in range(4):\n                    B_s[0, 3 * i] = dNdx[i]\n                    B_s[0, 3 * i + 1] = N[i]\n                    B_s[1, 3 * i] = dNdy[i]\n                    B_s[1, 3 * i + 2] = N[i]\n                \n                k_elem += B_s.T @ C_s @ B_s * det_J * w_xi * w_eta\n\n        # Assemble into global matrices\n        dof_map = np.array([3*n for n in el_nodes]).reshape(-1,1) + np.arange(3)\n        dof_map = dof_map.flatten()\n        K_global[np.ix_(dof_map, dof_map)] += k_elem\n        F_global[dof_map] += f_elem\n\n    # --- Apply Boundary Conditions (Clamped) ---\n    boundary_nodes = []\n    for i in range(num_nodes_y):\n        for j in range(num_nodes_x):\n            if i == 0 or i == num_nodes_y - 1 or j == 0 or j == num_nodes_x - 1:\n                boundary_nodes.append(i * num_nodes_x + j)\n    \n    boundary_dofs = []\n    for node_idx in boundary_nodes:\n        boundary_dofs.extend([3 * node_idx, 3 * node_idx + 1, 3 * node_idx + 2])\n    \n    all_dofs = np.arange(num_dofs)\n    free_dofs = np.setdiff1d(all_dofs, boundary_dofs)\n\n    K_reduced = K_global[np.ix_(free_dofs, free_dofs)]\n    F_reduced = F_global[free_dofs]\n\n    # --- Solve System and Extract Result ---\n    try:\n        sol_reduced = linalg.solve(K_reduced, F_reduced)\n    except linalg.LinAlgError:\n        return np.nan\n\n    d_global = np.zeros(num_dofs)\n    d_global[free_dofs] = sol_reduced\n    \n    center_node_idx_x = nx // 2\n    center_node_idx_y = ny // 2\n    center_node_global_idx = center_node_idx_y * num_nodes_x + center_node_idx_x\n    center_w_dof_idx = 3 * center_node_global_idx\n    \n    w_center = d_global[center_w_dof_idx]\n    \n    return w_center\n\nif __name__ == '__main__':\n    solve()\n```", "answer": "[1.000000,0.966956,0.010166,1.000000,0.001083,0.038440]", "id": "3551332"}]}