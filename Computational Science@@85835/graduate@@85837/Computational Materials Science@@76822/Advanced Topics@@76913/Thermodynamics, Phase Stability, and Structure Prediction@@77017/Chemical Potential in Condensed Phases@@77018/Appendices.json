{"hands_on_practices": [{"introduction": "To build a solid foundation, we begin by connecting the abstract definition of chemical potential, $\\mu_i$, to a concrete physical model. This practice involves applying the definition $\\mu_i = (\\partial G / \\partial N_i)_{T,P,N_{j\\neq i}}$ to the Gibbs free energy expression for a binary ideal solution [@problem_id:3436843]. By performing this derivation and a subsequent numerical calculation, you will gain direct insight into how the chemical potential reflects not only the energy of the pure components but also the crucial contribution of configurational entropy that drives mixing.", "problem": "Consider a binary substitutional ideal solution of components $A$ and $B$ at temperature $T$ and pressure $P$. The macroscopic Gibbs free energy of the mixture is given by\n$$\nG(T,P,N_A,N_B) = \\sum_{i\\in\\{A,B\\}} N_i\\,\\mu_i^{0}(T,P) + R T \\sum_{i\\in\\{A,B\\}} N_i \\ln x_i,\n$$\nwhere $N_i$ is the number of moles of component $i$, $\\mu_i^{0}(T,P)$ is the chemical potential of the pure component $i$ at the same $T$ and $P$, $R$ is the universal gas constant, and $x_i = N_i/(N_A+N_B)$ is the mole fraction. Using the fundamental definition of chemical potential as the partial derivative of the Gibbs free energy with respect to the mole number at fixed $T$, $P$, and the amounts of all other components, derive the analytical expression for the chemical potentials $\\mu_A(T,P,x_A)$ and $\\mu_B(T,P,x_B)$ for this mixture.\n\nThen, for the specific state $T=1200\\,\\text{K}$ and $P=1\\,\\text{bar}$, with pure-component chemical potentials $\\mu_A^{0}(T,P) = -37.20\\,\\text{kJ}\\,\\text{mol}^{-1}$ and $\\mu_B^{0}(T,P) = -41.50\\,\\text{kJ}\\,\\text{mol}^{-1}$, and composition $x_A = 0.25$ and $x_B = 0.75$, compute the numerical values of $\\mu_A$ and $\\mu_B$.\n\nFinally, explain the physical meaning of the composition dependence in the derived expression for $\\mu_i$. In your explanation, connect the composition dependence to a fundamental thermodynamic origin appropriate for condensed phases.\n\nUse $R = 8.314462618\\,\\text{J}\\,\\text{mol}^{-1}\\,\\text{K}^{-1}$ in your calculation. Express the final numerical chemical potentials in $\\text{kJ}\\,\\text{mol}^{-1}$ and round your answers to four significant figures.", "solution": "The problem is well-posed, scientifically grounded, and provides all necessary information for a complete solution. It requires the derivation of chemical potentials for an ideal binary solution, a numerical calculation for a specific state, and an explanation of the physical origin of the composition-dependent term.\n\nThe analysis proceeds in three parts as requested.\n\nPart 1: Derivation of the chemical potential expressions.\n\nThe chemical potential of component $i$ in a mixture is defined as the partial molar Gibbs free energy. For component $A$, this is given by:\n$$\n\\mu_A = \\left(\\frac{\\partial G}{\\partial N_A}\\right)_{T,P,N_B}\n$$\nThe Gibbs free energy of the binary ideal solution is provided as:\n$$\nG(T,P,N_A,N_B) = N_A\\,\\mu_A^{0}(T,P) + N_B\\,\\mu_B^{0}(T,P) + R T (N_A \\ln x_A + N_B \\ln x_B)\n$$\nwhere $x_A = \\frac{N_A}{N_A+N_B}$ and $x_B = \\frac{N_B}{N_A+N_B}$.\n\nTo perform the partial differentiation, it is advantageous to express the logarithmic terms solely as functions of the mole numbers $N_A$ and $N_B$:\n$$\n\\ln x_A = \\ln\\left(\\frac{N_A}{N_A+N_B}\\right) = \\ln N_A - \\ln(N_A+N_B)\n$$\n$$\n\\ln x_B = \\ln\\left(\\frac{N_B}{N_A+N_B}\\right) = \\ln N_B - \\ln(N_A+N_B)\n$$\nSubstituting these into the expression for $G$:\n$$\nG = N_A\\mu_A^0 + N_B\\mu_B^0 + R T \\left[ N_A(\\ln N_A - \\ln(N_A+N_B)) + N_B(\\ln N_B - \\ln(N_A+N_B)) \\right]\n$$\nThis can be simplified to:\n$$\nG = N_A\\mu_A^0 + N_B\\mu_B^0 + R T \\left[ N_A\\ln N_A + N_B\\ln N_B - (N_A+N_B)\\ln(N_A+N_B) \\right]\n$$\nNow, we compute the partial derivative of $G$ with respect to $N_A$, holding $T$, $P$, and $N_B$ constant.\n$$\n\\mu_A = \\frac{\\partial}{\\partial N_A} \\left( N_A\\mu_A^0 + N_B\\mu_B^0 + R T \\left[ N_A\\ln N_A + N_B\\ln N_B - (N_A+N_B)\\ln(N_A+N_B) \\right] \\right)\n$$\nWe differentiate term by term:\n\\begin{enumerate}\n    \\item $\\frac{\\partial}{\\partial N_A}(N_A\\mu_A^0) = \\mu_A^0$ (since $\\mu_A^0$ is a function of $T$ and $P$ only, which are held constant).\n    \\item $\\frac{\\partial}{\\partial N_A}(N_B\\mu_B^0) = 0$.\n    \\item $\\frac{\\partial}{\\partial N_A}(R T [N_A\\ln N_A]) = R T \\left( 1 \\cdot \\ln N_A + N_A \\cdot \\frac{1}{N_A} \\right) = R T (\\ln N_A + 1)$.\n    \\item $\\frac{\\partial}{\\partial N_A}(R T [N_B\\ln N_B]) = 0$.\n    \\item $\\frac{\\partial}{\\partial N_A}( - R T [(N_A+N_B)\\ln(N_A+N_B)] )$. Using the product rule $d(uv) = u'v + uv'$ with $u=N_A+N_B$ and $v=\\ln(N_A+N_B)$:\n    $$\n    -R T \\left[ \\frac{\\partial(N_A+N_B)}{\\partial N_A} \\ln(N_A+N_B) + (N_A+N_B) \\frac{\\partial(\\ln(N_A+N_B))}{\\partial N_A} \\right]\n    $$\n    $$\n    = -R T \\left[ 1 \\cdot \\ln(N_A+N_B) + (N_A+N_B) \\cdot \\frac{1}{N_A+N_B} \\cdot \\frac{\\partial(N_A+N_B)}{\\partial N_A} \\right]\n    $$\n    $$\n    = -R T \\left[ \\ln(N_A+N_B) + 1 \\right]\n    $$\n\\end{enumerate}\nCombining all terms:\n$$\n\\mu_A = \\mu_A^0 + R T (\\ln N_A + 1) - R T (\\ln(N_A+N_B) + 1)\n$$\n$$\n\\mu_A = \\mu_A^0 + R T [\\ln N_A - \\ln(N_A+N_B)]\n$$\n$$\n\\mu_A = \\mu_A^0 + R T \\ln\\left(\\frac{N_A}{N_A+N_B}\\right)\n$$\nThis simplifies to the final analytical expression for $\\mu_A$:\n$$\n\\mu_A(T,P,x_A) = \\mu_A^{0}(T,P) + R T \\ln x_A\n$$\nDue to the symmetry of the Gibbs free energy expression with respect to components $A$ and $B$, the derivation for $\\mu_B$ is analogous:\n$$\n\\mu_B(T,P,x_B) = \\mu_B^{0}(T,P) + R T \\ln x_B\n$$\n\nPart 2: Numerical calculation of the chemical potentials.\n\nThe given parameters are:\n$$\nT=1200\\,\\text{K}\n$$\n$$\nP=1\\,\\text{bar}\n$$\n$$\n\\mu_A^{0} = -37.20\\,\\text{kJ}\\,\\text{mol}^{-1}\n$$\n$$\n\\mu_B^{0} = -41.50\\,\\text{kJ}\\,\\text{mol}^{-1}\n$$\n$$\nx_A = 0.25\n$$\n$$\nx_B = 0.75\n$$\n$$\nR = 8.314462618\\,\\text{J}\\,\\text{mol}^{-1}\\,\\text{K}^{-1}\n$$\nFirst, we calculate the term $R T$ and convert its units to $\\text{kJ}\\,\\text{mol}^{-1}$:\n$$\nR T = (8.314462618\\,\\text{J}\\,\\text{mol}^{-1}\\,\\text{K}^{-1}) \\times (1200\\,\\text{K}) = 9977.3551416\\,\\text{J}\\,\\text{mol}^{-1}\n$$\n$$\nR T \\approx 9.9774\\,\\text{kJ}\\,\\text{mol}^{-1}\n$$\nNow, we calculate $\\mu_A$:\n$$\n\\mu_A = \\mu_A^0 + R T \\ln x_A = -37.20\\,\\text{kJ}\\,\\text{mol}^{-1} + (9.977355... \\,\\text{kJ}\\,\\text{mol}^{-1}) \\times \\ln(0.25)\n$$\n$$\n\\ln(0.25) \\approx -1.386294\n$$\n$$\n\\mu_A \\approx -37.20\\,\\text{kJ}\\,\\text{mol}^{-1} + (9.977355...) \\times (-1.386294)\\,\\text{kJ}\\,\\text{mol}^{-1}\n$$\n$$\n\\mu_A \\approx -37.20 - 13.8298\\,\\text{kJ}\\,\\text{mol}^{-1} = -51.0298\\,\\text{kJ}\\,\\text{mol}^{-1}\n$$\nRounding to four significant figures, $\\mu_A = -51.03\\,\\text{kJ}\\,\\text{mol}^{-1}$.\n\nNext, we calculate $\\mu_B$:\n$$\n\\mu_B = \\mu_B^0 + R T \\ln x_B = -41.50\\,\\text{kJ}\\,\\text{mol}^{-1} + (9.977355... \\,\\text{kJ}\\,\\text{mol}^{-1}) \\times \\ln(0.75)\n$$\n$$\n\\ln(0.75) \\approx -0.287682\n$$\n$$\n\\mu_B \\approx -41.50\\,\\text{kJ}\\,\\text{mol}^{-1} + (9.977355...) \\times (-0.287682)\\,\\text{kJ}\\,\\text{mol}^{-1}\n$$\n$$\n\\mu_B \\approx -41.50 - 2.8698\\,\\text{kJ}\\,\\text{mol}^{-1} = -44.3698\\,\\text{kJ}\\,\\text{mol}^{-1}\n$$\nRounding to four significant figures, $\\mu_B = -44.37\\,\\text{kJ}\\,\\text{mol}^{-1}$.\n\nPart 3: Physical meaning of the composition dependence.\n\nThe composition dependence in the expression $\\mu_i = \\mu_i^0 + R T \\ln x_i$ is entirely contained in the term $R T \\ln x_i$. This term represents the change in chemical potential of species $i$ due to its mixing with other components. Its fundamental thermodynamic origin is entropic.\n\nThe problem states that the system is an ideal solution. A defining characteristic of an ideal solution is that the enthalpy of mixing is zero, $\\Delta H_{\\text{mix}} = 0$. This implies that the interactions between unlike atoms ($A-B$) are energetically equivalent to the average of the interactions between like atoms ($A-A$ and $B-B$).\n\nThe Gibbs free energy of mixing is given by $\\Delta G_{\\text{mix}} = \\Delta H_{\\text{mix}} - T \\Delta S_{\\text{mix}}$. For an ideal solution, this simplifies to:\n$$\n\\Delta G_{\\text{mix}} = - T \\Delta S_{\\text{mix}}\n$$\nFrom the given expression for the total Gibbs free energy $G$, the Gibbs energy of mixing is:\n$$\n\\Delta G_{\\text{mix}} = G - \\sum_{i} N_i \\mu_i^0 = R T \\sum_{i} N_i \\ln x_i\n$$\nBy comparing these two expressions for $\\Delta G_{\\text{mix}}$, we identify the entropy of mixing as:\n$$\n\\Delta S_{\\text{mix}} = -R \\sum_{i} N_i \\ln x_i\n$$\nThis entropy is the **configurational entropy** (or combinatorial entropy), which arises from the multiplicity of spatial arrangements of the different components on the underlying lattice or structure of the condensed phase. According to the Boltzmann entropy formula, $S = k_B \\ln \\Omega$, where $\\Omega$ is the number of accessible microstates. For a binary substitutional crystal with $N_A$ atoms of type $A$ and $N_B$ atoms of type $B$ on a total of $N = N_A+N_B$ lattice sites, the number of distinct configurations is given by the binomial coefficient $\\Omega = \\frac{N!}{N_A! N_B!}$. Using Stirling's approximation for large numbers of atoms and converting from a particle basis (with $k_B$) to a molar basis (with $R$), one can derive the macroscopic expression $\\Delta S_{\\text{mix}} = -R \\sum N_i \\ln x_i$.\n\nTherefore, the term $R T \\ln x_i$ in the chemical potential represents the contribution of this configurational entropy to the partial molar Gibbs free energy. Because the mole fraction $x_i$ is always less than $1$ in a mixture, the term $\\ln x_i$ is always negative. This means mixing lowers the chemical potential of each component relative to its pure state ($\\mu_i  \\mu_i^0$). This reduction in Gibbs free energy, driven by the increase in entropy, is the fundamental thermodynamic driving force for the spontaneous mixing of components in an ideal solution.", "answer": "$$\\boxed{\\begin{pmatrix} -51.03  -44.37 \\end{pmatrix}}$$", "id": "3436843"}, {"introduction": "While ideal solutions provide a useful starting point, real materials exhibit non-ideal interactions, and their thermodynamic properties are subject to rigorous self-consistency rules. This exercise introduces one of the most important of these rules: the Gibbs-Duhem relation, which for a binary mixture at constant $T$ and $P$ constrains the composition derivatives of the chemical potentials via $x_A d\\mu_A + x_B d\\mu_B = 0$ [@problem_id:3436883]. Through a coding-based task, you will learn to numerically evaluate this relation to test whether chemical potential data, such as that derived from a non-ideal regular solution model or from a simulation, is thermodynamically consistent.", "problem": "You are given two component chemical potentials $\\,\\mu_A(x,T)\\,$ and $\\,\\mu_B(x,T)\\,$ for a binary condensed phase at fixed pressure, as functions of the mole fraction $\\,x \\in (0,1)\\,$ of species $A$ and absolute temperature $\\,T\\,$ in kelvin. The theoretical consistency condition that follows from equilibrium thermodynamics is that, at fixed $\\,T\\,$ and pressure, the composition-weighted sum of composition-derivatives of the component chemical potentials must vanish. Define the residual function\n$$ r(x;T) \\equiv x\\,\\frac{\\partial \\mu_A(x,T)}{\\partial x} + \\left(1-x\\right)\\,\\frac{\\partial \\mu_B(x,T)}{\\partial x}, $$\nevaluated at fixed $\\,T\\,$ and pressure. Perfect thermodynamic consistency implies $\\,r(x;T)=0\\,$ for all $\\,x\\in(0,1)\\,$.\n\nYou will test thermodynamic consistency numerically for the following explicit, scientifically plausible, molar Gibbs free energy-based model that produces $\\,\\mu_A(x,T)\\,$ and $\\,\\mu_B(x,T)\\,$. Let the universal gas constant be $\\,R = 8.314462618\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}\\,$. Let the per-mole reference (pure-component) chemical potentials be affine in temperature,\n$$ \\mu_A^0(T) = a_A + b_A T,\\quad \\mu_B^0(T) = a_B + b_B T, $$\nwith constants $\\,a_A = -50000\\,\\mathrm{J\\,mol^{-1}},\\; b_A = 12\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}},\\; a_B = -52000\\,\\mathrm{J\\,mol^{-1}},\\; b_B = 9\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}\\,.$ Let the regular-solution interaction parameter be affine in temperature,\n$$ W(T) = W_0 + W_1 T, $$\nwith $\\,W_0 = 16000\\,\\mathrm{J\\,mol^{-1}}\\,$ and $\\,W_1 = -3\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}\\,$. The molar Gibbs free energy per mole of mixture is\n$$ g(x,T) = x\\,\\mu_A^0(T) + (1-x)\\,\\mu_B^0(T) + R T\\left[x\\ln x + (1-x)\\ln(1-x)\\right] + W(T)\\,x(1-x). $$\nFrom this $\\,g(x,T)\\,$, the component chemical potentials are\n$$ \\mu_A(x,T) = \\mu_A^0(T) + R T \\ln x + W(T)\\,(1-x)^2, $$\n$$ \\mu_B(x,T) = \\mu_B^0(T) + R T \\ln(1-x) + W(T)\\,x^2. $$\n\nYour task is to compute, for each specified test case, the maximum absolute residual\n$$ R_{\\max}(T;\\mathcal{X}) \\equiv \\max_{x \\in \\mathcal{X}} \\left| r(x;T) \\right|, $$\nover a provided discrete set $\\,\\mathcal{X}\\subset(0,1)\\,$, expressed in $\\,\\mathrm{J\\,mol^{-1}}\\,$. Use exact analytic derivatives where available; if you choose numerical differentiation, ensure it is sufficiently accurate to achieve the requested rounding.\n\nTest suite (four cases), each producing one scalar $\\,R_{\\max}\\,$:\n- Case 1 (baseline consistent model): $\\,T = 1000\\,\\mathrm{K}\\,,$ $\\,\\mathcal{X} = \\{ x_k \\}_{k=0}^{200}\\,$ with $\\,x_k = 0.01 + k\\,h\\,$ and $\\,h = 0.98/200\\,.$ Use $\\,\\mu_A(x,T)\\,$ and $\\,\\mu_B(x,T)\\,$ as defined above.\n- Case 2 (deterministic perturbed second component): $\\,T = 1000\\,\\mathrm{K}\\,,$ same $\\,\\mathcal{X}\\,$ as Case 1. Use $\\,\\mu_A(x,T)\\,$ as above and replace $\\,\\mu_B(x,T)\\,$ by\n$$ \\mu_B^{\\mathrm{pert}}(x,T) = \\mu_B(x,T) + \\varepsilon\\,R T \\sin\\!\\left(200\\pi x\\right), $$\nwith $\\,\\varepsilon = 10^{-3}\\,.$\n- Case 3 (interaction-parameter mismatch on coarse grid): $\\,T = 1000\\,\\mathrm{K}\\,,$ with $\\,\\mathcal{X} = \\{0.1,\\,0.9\\}\\,.$ Use $\\,\\mu_A(x,T)\\,$ as above but replace the interaction parameter only in $\\,\\mu_B(x,T)\\,$ by $\\,\\widetilde{W}(T) = W(T) + \\Delta W\\,$ with $\\,\\Delta W = 500\\,\\mathrm{J\\,mol^{-1}}\\,$, i.e.,\n$$ \\mu_B^{\\mathrm{mis}}(x,T) = \\mu_B^0(T) + R T \\ln(1-x) + \\widetilde{W}(T)\\,x^2. $$\n- Case 4 (near-pure edge-resolution check): $\\,T = 650\\,\\mathrm{K}\\,,$ with\n$$ \\mathcal{X} = \\{10^{-6},\\,10^{-4},\\,10^{-3},\\,10^{-2},\\,0.05,\\,0.5,\\,0.95,\\,0.99,\\,0.999,\\,0.9999,\\,0.999999\\}. $$\n\nUnits and output:\n- Report each $\\,R_{\\max}\\,$ in $\\,\\mathrm{J\\,mol^{-1}}\\,$, rounded to six decimal places.\n- Your program should produce a single line of output containing the results for Cases $\\,1\\,$–$\\,4\\,$ as a comma-separated list enclosed in square brackets, for example $\\,\\left[\\text{res}_1,\\text{res}_2,\\text{res}_3,\\text{res}_4\\right]\\,$, where each entry is a decimal number rounded to six decimal places with standard rounding.\n\nYour program must be a complete, runnable implementation that performs these computations with the exact constants and definitions given here and outputs the list in the specified format. No user input is required or permitted. Angle units do not apply. Express all final numerical results in $\\,\\mathrm{J\\,mol^{-1}}\\,$ as specified.", "solution": "The problem requires the numerical validation of the thermodynamic consistency of chemical potential models for a binary mixture. The fundamental principle being tested is the Gibbs-Duhem relation, which, for a binary system at constant temperature $T$ and pressure $P$, states that the chemical potentials of the two components, $\\mu_A$ and $\\mu_B$, are not independent. Their composition derivatives are related by:\n$$ x \\, d\\mu_A + (1-x) \\, d\\mu_B = 0 $$\nwhere $x$ is the mole fraction of component $A$. Since pressure is fixed, the total differentials $d\\mu_A$ and $d\\mu_B$ depend only on the change in composition $dx$. This leads to the condition:\n$$ x\\,\\frac{\\partial \\mu_A}{\\partial x} + \\left(1-x\\right)\\,\\frac{\\partial \\mu_B}{\\partial x} = 0 $$\nwhere the partial derivatives are evaluated at constant $T$ and $P$.\n\nThe problem defines a residual function $r(x;T)$ to quantify any deviation from this condition:\n$$ r(x;T) \\equiv x\\,\\frac{\\partial \\mu_A(x,T)}{\\partial x} + \\left(1-x\\right)\\,\\frac{\\partial \\mu_B(x,T)}{\\partial x} $$\nFor a thermodynamically self-consistent model, $r(x;T)$ must be identically zero for all $x \\in (0,1)$. The task is to compute the maximum absolute value of this residual, $R_{\\max}(T;\\mathcal{X}) = \\max_{x \\in \\mathcal{X}} |r(x;T)|$, for four distinct cases over specified discrete sets of mole fractions $\\mathcal{X}$.\n\nTo ensure accuracy, as recommended by the problem statement, we will use exact analytical derivatives of the given chemical potential functions.\n\nThe universal gas constant is $R = 8.314462618\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$. The reference chemical potentials and the regular-solution interaction parameter are given as functions of temperature $T$:\n$$ \\mu_A^0(T) = a_A + b_A T, \\quad \\text{with } a_A = -50000\\,\\mathrm{J\\,mol^{-1}}, b_A = 12\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}} $$\n$$ \\mu_B^0(T) = a_B + b_B T, \\quad \\text{with } a_B = -52000\\,\\mathrm{J\\,mol^{-1}}, b_B = 9\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}} $$\n$$ W(T) = W_0 + W_1 T, \\quad \\text{with } W_0 = 16000\\,\\mathrm{J\\,mol^{-1}}, W_1 = -3\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}} $$\n\n**Case 1: Baseline Consistent Model**\nThe chemical potentials are given by the standard regular solution model:\n$$ \\mu_A(x,T) = \\mu_A^0(T) + R T \\ln x + W(T)\\,(1-x)^2 $$\n$$ \\mu_B(x,T) = \\mu_B^0(T) + R T \\ln(1-x) + W(T)\\,x^2 $$\nThe partial derivatives with respect to $x$ at constant $T$ are:\n$$ \\frac{\\partial \\mu_A}{\\partial x} = \\frac{RT}{x} - 2W(T)(1-x) $$\n$$ \\frac{\\partial \\mu_B}{\\partial x} = -\\frac{RT}{1-x} + 2W(T)x $$\nSubstituting these into the residual function definition:\n$$ r(x;T) = x \\left( \\frac{RT}{x} - 2W(T)(1-x) \\right) + (1-x) \\left( -\\frac{RT}{1-x} + 2W(T)x \\right) $$\n$$ r(x;T) = \\left( RT - 2xW(T)(1-x) \\right) + \\left( -RT + 2xW(T)(1-x) \\right) = 0 $$\nAnalytically, the residual is zero for all $x \\in (0,1)$. Numerically, the computation should yield a value on the order of machine floating-point precision, which for practical purposes is zero. Thus, for Case 1, we expect $R_{\\max} \\approx 0$.\n\n**Case 2: Deterministic Perturbed Second Component**\nHere, $\\mu_A$ is unchanged, but $\\mu_B$ is perturbed:\n$$ \\mu_B^{\\mathrm{pert}}(x,T) = \\mu_B(x,T) + \\varepsilon\\,R T \\sin\\!\\left(200\\pi x\\right) $$\nwith $\\varepsilon = 10^{-3}$. The derivative of the perturbation term is $\\frac{\\partial}{\\partial x}(\\varepsilon R T \\sin(200\\pi x)) = 200\\pi \\varepsilon R T \\cos(200\\pi x)$. The residual function becomes:\n$$ r_{\\mathrm{pert}}(x;T) = \\left( x \\frac{\\partial \\mu_A}{\\partial x} + (1-x)\\frac{\\partial \\mu_B}{\\partial x} \\right) + (1-x) \\left( 200\\pi \\varepsilon R T \\cos(200\\pi x) \\right) $$\nThe first term is the residual from the baseline model, which is zero. Therefore:\n$$ r_{\\mathrm{pert}}(x;T) = (1-x) \\left( 200\\pi \\varepsilon R T \\cos(200\\pi x) \\right) $$\nThis expression is evaluated for each $x$ in the given set $\\mathcal{X}$ to find the maximum absolute value.\n\n**Case 3: Interaction-parameter Mismatch**\nIn this case, $\\mu_A$ is from the baseline model, but $\\mu_B$ is constructed with a mismatched interaction parameter $\\widetilde{W}(T) = W(T) + \\Delta W$, where $\\Delta W = 500\\,\\mathrm{J\\,mol^{-1}}$:\n$$ \\mu_B^{\\mathrm{mis}}(x,T) = \\mu_B^0(T) + R T \\ln(1-x) + \\widetilde{W}(T)\\,x^2 $$\nThe derivative is $\\frac{\\partial \\mu_B^{\\mathrm{mis}}}{\\partial x} = -\\frac{RT}{1-x} + 2\\widetilde{W}(T)x$. The residual is:\n$$ r_{\\mathrm{mis}}(x;T) = x\\frac{\\partial \\mu_A}{\\partial x} + (1-x)\\frac{\\partial \\mu_B^{\\mathrm{mis}}}{\\partial x} $$\n$$ r_{\\mathrm{mis}}(x;T) = x \\left(\\frac{RT}{x} - 2W(T)(1-x) \\right) + (1-x) \\left(-\\frac{RT}{1-x} + 2\\widetilde{W}(T)x \\right) $$\n$$ r_{\\mathrm{mis}}(x;T) = \\left(RT - 2xW(T)(1-x)\\right) + \\left(-RT + 2x(1-x)\\widetilde{W}(T)\\right) $$\n$$ r_{\\mathrm{mis}}(x;T) = 2x(1-x)(\\widetilde{W}(T) - W(T)) = 2x(1-x)\\Delta W $$\nThis is evaluated for $x \\in \\{0.1, 0.9\\}$ to find $R_{\\max}$.\n\n**Case 4: Near-pure Edge-resolution Check**\nThis case uses the same thermodynamically consistent baseline model as in Case 1, but at a different temperature ($T=650\\,\\mathrm{K}$) and on a grid $\\mathcal{X}$ that includes points very close to the pure component limits ($x=0$ and $x=1$). As in Case 1, the analytical residual is $r(x;T)=0$. The purpose is to check the numerical stability of the calculation under these more challenging conditions. Due to the high precision of standard floating-point arithmetic, the result is again expected to be effectively zero.\n\nThe solution is implemented by creating a function for each case that calculates the maximum absolute residual based on these derived analytical expressions. The final results are collected and formatted as specified.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes thermodynamic consistency residuals for a binary solution model.\n    \"\"\"\n    # Define physical constants and model parameters\n    R = 8.314462618  # J/mol/K\n    a_A = -50000.0   # J/mol\n    b_A = 12.0       # J/mol/K\n    a_B = -52000.0   # J/mol\n    b_B = 9.0        # J/mol/K\n    W_0 = 16000.0    # J/mol\n    W_1 = -3.0       # J/mol/K\n\n    def W(T):\n        \"\"\"Calculates the interaction parameter W at temperature T.\"\"\"\n        return W_0 + W_1 * T\n\n    # --- Case 1: Baseline Consistent Model ---\n    def calculate_case1():\n        \"\"\"\n        Calculates R_max for the baseline model.\n        Analytically, the residual is zero. This calculation confirms it numerically.\n        \"\"\"\n        T = 1000.0  # K\n        h = 0.98 / 200.0\n        X = np.linspace(0.01, 0.99, 201)\n        \n        Wt = W(T)\n        residuals = []\n        for x in X:\n            # r(x,T) = x * (RT/x - 2W(1-x)) + (1-x) * (-RT/(1-x) + 2Wx)\n            # which simplifies to:\n            # (RT - 2xW(1-x)) + (-RT + 2xW(1-x)) = 0\n            term1 = R * T - 2 * x * Wt * (1 - x)\n            term2 = -R * T + 2 * x * (1 - x) * Wt\n            r_val = term1 + term2\n            residuals.append(np.abs(r_val))\n        return max(residuals)\n\n    # --- Case 2: Deterministic Perturbed Second Component ---\n    def calculate_case2():\n        \"\"\"\n        Calculates R_max for the model with a perturbed chemical potential for component B.\n        \"\"\"\n        T = 1000.0  # K\n        epsilon = 1e-3\n        h = 0.98 / 200.0\n        X = np.linspace(0.01, 0.99, 201)\n\n        residuals = []\n        # Analytical residual: r(x,T) = (1-x) * epsilon * R * T * (200*pi) * cos(200*pi*x)\n        const_factor = epsilon * R * T * 200 * np.pi\n        for x in X:\n            r_val = (1 - x) * const_factor * np.cos(200 * np.pi * x)\n            residuals.append(np.abs(r_val))\n        return max(residuals)\n\n    # --- Case 3: Interaction-parameter Mismatch ---\n    def calculate_case3():\n        \"\"\"\n        Calculates R_max for the model with a mismatched interaction parameter in component B.\n        \"\"\"\n        X = np.array([0.1, 0.9])\n        delta_W = 500.0  # J/mol\n        \n        residuals = []\n        # Analytical residual: r(x,T) = 2 * x * (1-x) * delta_W\n        for x in X:\n            r_val = 2 * x * (1 - x) * delta_W\n            residuals.append(np.abs(r_val))\n        return max(residuals)\n\n    # --- Case 4: Near-pure Edge-resolution Check ---\n    def calculate_case4():\n        \"\"\"\n        Calculates R_max for the baseline model at extreme compositions.\n        Similar to Case 1, the analytical residual is zero.\n        \"\"\"\n        T = 650.0  # K\n        X = np.array([1e-6, 1e-4, 1e-3, 1e-2, 0.05, 0.5, 0.95, 0.99, 0.999, 0.9999, 0.999999])\n        \n        Wt = W(T)\n        residuals = []\n        for x in X:\n            # r(x,T) = 0 analytically.\n            term1 = R * T - 2 * x * Wt * (1 - x)\n            term2 = -R * T + 2 * x * (1 - x) * Wt\n            r_val = term1 + term2\n            residuals.append(np.abs(r_val))\n        return max(residuals)\n\n    # Calculate results for all cases\n    results = [\n        calculate_case1(),\n        calculate_case2(),\n        calculate_case3(),\n        calculate_case4()\n    ]\n\n    # Format the results as per the problem specification and print\n    formatted_results = [f\"{res:.6f}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "3436883"}, {"introduction": "Beyond simply verifying thermodynamic consistency, the Gibbs-Duhem relation is a powerful predictive tool for constructing and refining thermodynamic models. In this advanced hands-on practice, you will implement a numerical Gibbs-Duhem integration scheme [@problem_id:3436871]. This powerful technique allows you to predict the chemical potential of one component across the entire composition range, using only the known behavior of the other component and a single trusted data point, a method frequently used to ensure the integrity of thermodynamic databases.", "problem": "A binary condensed-phase mixture of components $A$ and $B$ at constant temperature $T$ and pressure $p$ is considered. The chemical potential of component $i$ is defined as the partial molar Gibbs free energy, $\\mu_i = \\left(\\partial G / \\partial n_i\\right)_{T,p,n_{j\\neq i}}$, and the excess chemical potential is defined by $\\mu_i^{\\mathrm{ex}} = \\mu_i - \\mu_i^{\\mathrm{id}}$. The activity coefficient $\\gamma_i$ is linked to the excess chemical potential through the relation $\\mu_i^{\\mathrm{ex}} = R T \\ln \\gamma_i$, where $R$ is the ideal gas constant and $T$ is the absolute temperature. At constant temperature and pressure, the Gibbs–Duhem equation implies the constraint $\\sum_i x_i \\, d \\mu_i = 0$, which leads, for a binary mixture, to a relation between the activity coefficients, $x_A \\, d \\ln \\gamma_A + x_B \\, d \\ln \\gamma_B = 0$, where $x_A$ and $x_B$ are the mole fractions of components $A$ and $B$.\n\nStarting from these foundational definitions, develop a numerical Gibbs–Duhem integration scheme to propagate activity coefficients across composition from a single anchor point using direct simulation estimates of the excess chemical potential for one component. Specifically, given direct simulation estimates of $\\mu_A^{\\mathrm{ex}}(x_A)$ on a discrete composition grid, use numerical differentiation to obtain $d \\ln \\gamma_A / d x_A$ and then integrate to reconstruct $\\ln \\gamma_A(x_A)$ across the grid from an anchor value at $x_A = x_0$. Use the Gibbs–Duhem constraint to obtain $d \\ln \\gamma_B / d x_A$ and integrate from an anchor to reconstruct $\\ln \\gamma_B(x_A)$. Convert these reconstructed activity coefficients to excess chemical potentials $\\mu_i^{\\mathrm{ex}}(x_A)$ and compare against the provided direct simulation estimates for both components.\n\nAdopt the following constants: $R = 8.31446261815324 \\ \\mathrm{J \\, mol^{-1} \\, K^{-1}}$ and $T = 298.15 \\ \\mathrm{K}$. All chemical potentials must be expressed in $\\mathrm{J \\, mol^{-1}}$.\n\nTest Suite:\n- System $\\mathrm{S1}$ (ideal mixture, happy path):\n  - Composition grid for $x_A$: $[0.1,0.2,0.3,0.4,0.5,0.6,0.7,0.8,0.9]$.\n  - Direct simulation $\\mu_A^{\\mathrm{ex}}$: $[0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0]$.\n  - Direct simulation $\\mu_B^{\\mathrm{ex}}$: $[0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0]$.\n  - Anchor composition $x_0 = 0.5$.\n- System $\\mathrm{S2}$ (symmetric nonideal, moderate interactions):\n  - Composition grid for $x_A$: $[0.1,0.2,0.3,0.4,0.5,0.6,0.7,0.8,0.9]$.\n  - Direct simulation $\\mu_A^{\\mathrm{ex}}$ in $\\mathrm{J \\, mol^{-1}}$: $[3011.932790964,2379.798748416,1822.033416756,1338.636795984,929.6088861,594.949687104,334.659198996,148.737421776,37.184355444]$.\n  - Direct simulation $\\mu_B^{\\mathrm{ex}}$ in $\\mathrm{J \\, mol^{-1}}$: $[37.184355444,148.737421776,334.659198996,594.949687104,929.6088861,1338.636795984,1822.033416756,2379.798748416,3011.932790964]$.\n  - Anchor composition $x_0 = 0.5$.\n- System $\\mathrm{S3}$ (asymmetric nonideal, strong and sign-changing interactions; edge-case coverage near composition extremes):\n  - Composition grid for $x_A$: $[0.1,0.2,0.3,0.4,0.5,0.6,0.7,0.8,0.9]$.\n  - Direct simulation $\\mu_A^{\\mathrm{ex}}$ in $\\mathrm{J \\, mol^{-1}}$: $[3815.1148685544,2538.4519983104,1579.0956278552,892.424530656,433.81748018,158.6532498944,22.3106132664,-19.8316562368,-12.394785148]$.\n  - Direct simulation $\\mu_B^{\\mathrm{ex}}$ in $\\mathrm{J \\, mol^{-1}}$: $[84.2845390064,307.3906716704,624.6971714592,991.58281184,1363.42636628,1695.6066082464,1943.5023112064,2062.4922486272,2007.955193976]$.\n  - Anchor composition $x_0 = 0.5$.\n\nAlgorithmic Requirements:\n1. Convert the provided direct simulation $\\mu_A^{\\mathrm{ex}}(x_A)$ to $\\ln \\gamma_A(x_A)$ using $\\ln \\gamma_A = \\mu_A^{\\mathrm{ex}} / (R T)$.\n2. Compute $d \\ln \\gamma_A / d x_A$ on the grid using second-order accurate finite differences (central differences for interior points and one-sided second-order differences at the boundaries).\n3. Numerically integrate $d \\ln \\gamma_A / d x_A$ from the anchor $x_0$ to reconstruct $\\ln \\gamma_A(x_A)$ across the grid using the trapezoidal rule.\n4. Use the Gibbs–Duhem constraint to obtain $d \\ln \\gamma_B / d x_A = - \\left(x_A / x_B\\right) \\, d \\ln \\gamma_A / d x_A$, where $x_B = 1 - x_A$.\n5. Numerically integrate $d \\ln \\gamma_B / d x_A$ from the anchor value $\\ln \\gamma_B(x_0) = \\mu_B^{\\mathrm{ex}}(x_0) / (R T)$ using the trapezoidal rule to reconstruct $\\ln \\gamma_B(x_A)$.\n6. Convert the reconstructed $\\ln \\gamma_i(x_A)$ back to $\\mu_i^{\\mathrm{ex}}(x_A)$ using $\\mu_i^{\\mathrm{ex}} = R T \\ln \\gamma_i$.\n7. Compute the root-mean-square error for each component and each system as a float in $\\mathrm{J \\, mol^{-1}}$: $\\mathrm{RMSE}_i = \\sqrt{\\frac{1}{N}\\sum_{j=1}^{N}\\left(\\mu_{i,\\mathrm{pred}}^{\\mathrm{ex}}(x_{A,j}) - \\mu_{i,\\mathrm{dir}}^{\\mathrm{ex}}(x_{A,j})\\right)^2}$.\n\nFinal Output Format:\nYour program should produce a single line of output containing the six root-mean-square errors, ordered as $[\\mathrm{RMSE}_{A,\\mathrm{S1}},\\mathrm{RMSE}_{B,\\mathrm{S1}},\\mathrm{RMSE}_{A,\\mathrm{S2}},\\mathrm{RMSE}_{B,\\mathrm{S2}},\\mathrm{RMSE}_{A,\\mathrm{S3}},\\mathrm{RMSE}_{B,\\mathrm{S3}}]$. The list must be printed exactly as a Python-style list of floats enclosed in square brackets. All values must be in $\\mathrm{J \\, mol^{-1}}$.", "solution": "The problem requires the development and validation of a numerical scheme for Gibbs-Duhem integration in a binary mixture. This procedure is fundamental in computational thermodynamics for ensuring consistency between chemical potentials of different components, which are often calculated independently in molecular simulations. The task is to take direct simulation estimates of the excess chemical potential for one component, $\\mu_A^{\\mathrm{ex}}$, on a discrete composition grid, and use them to predict the excess chemical potentials for both components, $\\mu_A^{\\mathrm{ex}}$ and $\\mu_B^{\\mathrm{ex}}$, across the same grid. The accuracy of this reconstruction is then evaluated against the direct simulation data for both components.\n\nThe theoretical basis for this procedure is the Gibbs-Duhem equation, which at constant temperature $T$ and pressure $p$ for a binary mixture of components $A$ and $B$ is given by:\n$$ n_A d\\mu_A + n_B d\\mu_B = 0 $$\nwhere $n_i$ is the number of moles of component $i$ and $\\mu_i$ is its chemical potential. Dividing by the total moles $n_A + n_B$ and using the definition of mole fraction $x_i = n_i / (n_A + n_B)$, this becomes $x_A d\\mu_A + x_B d\\mu_B = 0$. The chemical potential is related to the activity coefficient, $\\gamma_i$, via the excess chemical potential, $\\mu_i^{\\mathrm{ex}} = \\mu_i - \\mu_i^{\\mathrm{id}} = R T \\ln \\gamma_i$, where $R$ is the ideal gas constant. Differentiating this expression gives $d\\mu_i = R T d\\ln\\gamma_i$, since the ideal part of the chemical potential satisfies its own Gibbs-Duhem-like relation. Substituting this into the mole-fraction form of the Gibbs-Duhem equation yields the relation between activity coefficients:\n$$ x_A d\\ln\\gamma_A + x_B d\\ln\\gamma_B = 0 $$\nThis equation is a differential constraint that links the compositional dependence of the two activity coefficients. It can be rearranged to express the derivative of one in terms of the other. Considering the mole fraction $x_A$ as the independent variable, and since $x_B = 1-x_A$ implies $dx_B = -dx_A$, we can write a total differential as $d f = (\\partial f / \\partial x_A) dx_A$. The Gibbs-Duhem equation then becomes:\n$$ x_A \\frac{d\\ln\\gamma_A}{dx_A} + x_B \\frac{d\\ln\\gamma_B}{dx_A} = 0 $$\nThis leads to the core relation for our integration scheme:\n$$ \\frac{d\\ln\\gamma_B}{dx_A} = -\\frac{x_A}{x_B} \\frac{d\\ln\\gamma_A}{dx_A} = -\\frac{x_A}{1-x_A} \\frac{d\\ln\\gamma_A}{dx_A} $$\nThis equation allows us to determine the compositional dependence of $\\gamma_B$ if the dependence of $\\gamma_A$ is known.\n\nThe specified algorithmic procedure is a direct implementation of this principle, with an added self-consistency check for component $A$.\n\nStep 1: Convert direct simulation data to activity coefficient logarithms.\nGiven the discrete data for the excess chemical potential of component $A$, $\\mu_{A,\\mathrm{dir}}^{\\mathrm{ex}}(x_{A,j})$, we compute the corresponding logarithm of the activity coefficient at each grid point $x_{A,j}$ using the definition:\n$$ \\ln\\gamma_{A,\\mathrm{dir}}(x_{A,j}) = \\frac{\\mu_{A,\\mathrm{dir}}^{\\mathrm{ex}}(x_{A,j})}{RT} $$\n\nStep 2: Numerically differentiate $\\ln \\gamma_A$.\nTo use the Gibbs-Duhem relation, we require the derivative $d\\ln\\gamma_A/dx_A$. Since we have data on a discrete grid, we must approximate this derivative using finite differences. To maintain a good level of accuracy, $2^{nd}$-order schemes are used. For interior points $j$ of a uniform grid with spacing $h = x_{A,j+1} - x_{A,j}$, the $2^{nd}$-order central difference formula is used:\n$$ \\left(\\frac{d\\ln\\gamma_A}{dx_A}\\right)_j \\approx \\frac{\\ln\\gamma_A(x_{A,j+1}) - \\ln\\gamma_A(x_{A,j-1})}{2h} $$\nFor the boundary points, $2^{nd}$-order one-sided formulas are required. At the first point ($j=0$):\n$$ \\left(\\frac{d\\ln\\gamma_A}{dx_A}\\right)_0 \\approx \\frac{-3\\ln\\gamma_A(x_{A,0}) + 4\\ln\\gamma_A(x_{A,1}) - \\ln\\gamma_A(x_{A,2})}{2h} $$\nAt the last point ($j=N-1$):\n$$ \\left(\\frac{d\\ln\\gamma_A}{dx_A}\\right)_{N-1} \\approx \\frac{3\\ln\\gamma_A(x_{A,N-1}) - 4\\ln\\gamma_A(x_{A,N-2}) + \\ln\\gamma_A(x_{A,N-3})}{2h} $$\n\nStep 3: Reconstruct $\\ln\\gamma_A$ via numerical integration.\nThis step serves as a self-consistency check on the numerical differentiation-integration cycle. We integrate the derivative computed in Step 2 to reconstruct the function $\\ln\\gamma_A$. Any indefinite integral has an unknown constant of integration. This constant is fixed by choosing an \"anchor\" point, $x_0$, where the value of the function is assumed to be known accurately from the direct simulation data, i.e., $\\ln\\gamma_A(x_0) = \\mu_{A,\\mathrm{dir}}^{\\mathrm{ex}}(x_0)/(RT)$. The reconstructed function is then:\n$$ \\ln\\gamma_{A,\\mathrm{recon}}(x_A) = \\ln\\gamma_{A,\\mathrm{dir}}(x_0) + \\int_{x_0}^{x_A} \\left(\\frac{d\\ln\\gamma_A}{dx_A'}\\right)_{\\mathrm{num}} dx_A' $$\nThe integration is performed numerically using the trapezoidal rule, which approximates the integral of a function $f(x)$ over an interval $[a,b]$ as $(b-a)(f(a)+f(b))/2$. For a cumulative integral from $x_0$ to $x_j$, we sum the areas of the trapezoids for each subinterval.\n\nStep 4: Compute the derivative for component $B$.\nUsing the derivative of $\\ln\\gamma_A$ from Step 2, we apply the Gibbs-Duhem constraint to find the derivative for $\\ln\\gamma_B$ at each grid point $x_{A,j}$:\n$$ \\left(\\frac{d\\ln\\gamma_B}{dx_A}\\right)_j = -\\frac{x_{A,j}}{1-x_{A,j}} \\left(\\frac{d\\ln\\gamma_A}{dx_A}\\right)_j $$\n\nStep 5: Reconstruct $\\ln\\gamma_B$ via numerical integration.\nThis step is analogous to Step 3, but now we are genuinely predicting a property of component $B$ from component $A$'s data. The anchor value is taken from the direct simulation data for component $B$ at the anchor composition, $\\ln\\gamma_B(x_0) = \\mu_{B,\\mathrm{dir}}^{\\mathrm{ex}}(x_0)/(RT)$. The reconstructed function is:\n$$ \\ln\\gamma_{B,\\mathrm{recon}}(x_A) = \\ln\\gamma_{B,\\mathrm{dir}}(x_0) + \\int_{x_0}^{x_A} \\left(\\frac{d\\ln\\gamma_B}{dx_A'}\\right)_{\\mathrm{num}} dx_A' $$\nThe integration is again performed using the trapezoidal rule.\n\nStep 6: Convert reconstructed logarithms back to excess chemical potentials.\nThe reconstructed logarithmic activity coefficients are converted back to excess chemical potentials for comparison with the original simulation data:\n$$ \\mu_{i,\\mathrm{recon}}^{\\mathrm{ex}}(x_A) = RT \\ln\\gamma_{i,\\mathrm{recon}}(x_A) \\quad \\text{for } i \\in \\{A, B\\} $$\n\nStep 7: Quantify the error.\nThe Root-Mean-Square Error (RMSE) is calculated to quantify the discrepancy between the reconstructed potentials and the direct simulation data. For each component $i$, the RMSE is:\n$$ \\mathrm{RMSE}_i = \\sqrt{\\frac{1}{N} \\sum_{j=1}^{N} \\left( \\mu_{i,\\mathrm{recon}}^{\\mathrm{ex}}(x_{A,j}) - \\mu_{i,\\mathrm{dir}}^{\\mathrm{ex}}(x_{A,j}) \\right)^2} $$\nwhere $N$ is the number of points in the composition grid. This metric provides a single value representing the average error of the Gibbs-Duhem integration procedure for each component and system. The resulting implementation will compute these RMSE values for the three test systems provided.", "answer": "```python\nimport numpy as np\nfrom scipy import integrate\n\ndef solve():\n    \"\"\"\n    Main function to run the Gibbs-Duhem integration analysis on all test cases.\n    \"\"\"\n\n    # Define constants\n    R = 8.31446261815324  # J mol^-1 K^-1\n    T = 298.15            # K\n    RT = R * T\n\n    def process_system(x_A, mu_A_dir, mu_B_dir, x0):\n        \"\"\"\n        Performs the 7-step Gibbs-Duhem integration and error analysis for a single system.\n        \n        Args:\n            x_A (np.ndarray): Array of mole fractions for component A.\n            mu_A_dir (np.ndarray): Array of direct simulation excess chemical potentials for A.\n            mu_B_dir (np.ndarray): Array of direct simulation excess chemical potentials for B.\n            x0 (float): The anchor compostion.\n\n        Returns:\n            tuple: A tuple containing (RMSE_A, RMSE_B).\n        \"\"\"\n        # Ensure inputs are numpy arrays\n        x_A = np.array(x_A, dtype=float)\n        mu_A_dir = np.array(mu_A_dir, dtype=float)\n        mu_B_dir = np.array(mu_B_dir, dtype=float)\n\n        # Step 1: Convert direct simulation mu_A_ex to ln(gamma_A).\n        ln_gamma_A_dir = mu_A_dir / RT\n\n        # Step 2: Compute d(ln(gamma_A))/dx_A using second-order finite differences.\n        # The grid is uniform, so we can calculate a single spacing h.\n        h = x_A[1] - x_A[0]\n        d_ln_gamma_A_dx_A = np.gradient(ln_gamma_A_dir, h, edge_order=2)\n\n        # Find the index of the anchor composition\n        anchor_idx = np.where(x_A == x0)[0][0]\n\n        # Step 3: Numerically integrate d(ln_gamma_A)/dx_A to reconstruct ln(gamma_A).\n        ln_gamma_A_anchor = ln_gamma_A_dir[anchor_idx]\n        # Use cumulative_trapezoid to get integral from the start of the grid\n        integral_A_from_start = integrate.cumulative_trapezoid(d_ln_gamma_A_dx_A, x_A, initial=0)\n        # Adjust so the integral is relative to the anchor point\n        integral_A_from_anchor = integral_A_from_start - integral_A_from_start[anchor_idx]\n        ln_gamma_A_recon = ln_gamma_A_anchor + integral_A_from_anchor\n\n        # Step 4: Use Gibbs-Duhem to get d(ln(gamma_B))/dx_A.\n        x_B = 1.0 - x_A\n        # Handle potential division by zero if x_B is ever zero, though not in test cases\n        with np.errstate(divide='ignore', invalid='ignore'):\n            d_ln_gamma_B_dx_A = -(x_A / x_B) * d_ln_gamma_A_dx_A\n        # Replace NaN or Inf if they occurred, although not expected for the given grids\n        d_ln_gamma_B_dx_A[~np.isfinite(d_ln_gamma_B_dx_A)] = 0\n\n        # Step 5: Numerically integrate d(ln_gamma_B)/dx_A to reconstruct ln(gamma_B).\n        ln_gamma_B_dir = mu_B_dir / RT\n        ln_gamma_B_anchor = ln_gamma_B_dir[anchor_idx]\n        integral_B_from_start = integrate.cumulative_trapezoid(d_ln_gamma_B_dx_A, x_A, initial=0)\n        integral_B_from_anchor = integral_B_from_start - integral_B_from_start[anchor_idx]\n        ln_gamma_B_recon = ln_gamma_B_anchor + integral_B_from_anchor\n        \n        # Step 6: Convert reconstructed ln(gamma) back to mu_ex.\n        mu_A_recon = RT * ln_gamma_A_recon\n        mu_B_recon = RT * ln_gamma_B_recon\n\n        # Step 7: Compute RMSE for each component.\n        rmse_A = np.sqrt(np.mean((mu_A_recon - mu_A_dir)**2))\n        rmse_B = np.sqrt(np.mean((mu_B_recon - mu_B_dir)**2))\n\n        return rmse_A, rmse_B\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # System S1\n        {\n            \"x_A\": [0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9],\n            \"mu_A_dir\": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],\n            \"mu_B_dir\": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],\n            \"x0\": 0.5\n        },\n        # System S2\n        {\n            \"x_A\": [0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9],\n            \"mu_A_dir\": [3011.932790964, 2379.798748416, 1822.033416756, 1338.636795984, 929.6088861, 594.949687104, 334.659198996, 148.737421776, 37.184355444],\n            \"mu_B_dir\": [37.184355444, 148.737421776, 334.659198996, 594.949687104, 929.6088861, 1338.636795984, 1822.033416756, 2379.798748416, 3011.932790964],\n            \"x0\": 0.5\n        },\n        # System S3\n        {\n            \"x_A\": [0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9],\n            \"mu_A_dir\": [3815.1148685544, 2538.4519983104, 1579.0956278552, 892.424530656, 433.81748018, 158.6532498944, 22.3106132664, -19.8316562368, -12.394785148],\n            \"mu_B_dir\": [84.2845390064, 307.3906716704, 624.6971714592, 991.58281184, 1363.42636628, 1695.6066082464, 1943.5023112064, 2062.4922486272, 2007.955193976],\n            \"x0\": 0.5\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        rmse_A, rmse_B = process_system(case[\"x_A\"], case[\"mu_A_dir\"], case[\"mu_B_dir\"], case[\"x0\"])\n        results.append(rmse_A)\n        results.append(rmse_B)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3436871"}]}