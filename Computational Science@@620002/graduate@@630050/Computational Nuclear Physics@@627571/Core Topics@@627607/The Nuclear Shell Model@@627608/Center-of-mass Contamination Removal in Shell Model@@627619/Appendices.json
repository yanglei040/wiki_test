{"hands_on_practices": [{"introduction": "A core challenge in the nuclear shell model is ensuring that calculated observables are free from artifacts of the model space, such as spurious center-of-mass (CM) motion. This exercise provides a fundamental diagnosis of the problem, focusing on the operators used to calculate physical quantities like electromagnetic transition rates. By explicitly deriving the commutation relations between standard multipole operators and the total momentum operator [@problem_id:3548888], you will see precisely why these operators are not translationally invariant and can therefore induce unphysical mixing between a nucleus's internal structure and its overall motion.", "problem": "Consider an interacting system of $A$ nucleons described in a shell-model basis built from harmonic-oscillator single-particle states. Let $\\mathbf{r}_{i}$ and $\\mathbf{p}_{i}$ be the canonical position and momentum operators of nucleon $i$ with $i \\in \\{1,\\dots,A\\}$, obeying $[r_{i,\\alpha},p_{j,\\beta}] = i\\hbar\\,\\delta_{ij}\\,\\delta_{\\alpha\\beta}$ and $[r_{i,\\alpha},r_{j,\\beta}] = [p_{i,\\alpha},p_{j,\\beta}] = 0$ for Cartesian components $\\alpha,\\beta \\in \\{x,y,z\\}$. The total momentum is $\\mathbf{P} \\equiv \\sum_{i=1}^{A}\\mathbf{p}_{i}$ and the center-of-mass (COM) coordinate is $\\mathbf{R}_{\\mathrm{cm}} \\equiv \\frac{1}{A}\\sum_{i=1}^{A}\\mathbf{r}_{i}$. A general operator $\\hat{O}$ is said to be translationally invariant if it is invariant under uniform spatial translations generated by $\\mathbf{P}$.\n1. Starting from the unitary translation operator $U(\\mathbf{a}) \\equiv \\exp\\!\\left(-\\frac{i}{\\hbar}\\,\\mathbf{a}\\cdot\\mathbf{P}\\right)$ and its action on operators in the Heisenberg picture, derive a necessary and sufficient criterion for translational invariance of $\\hat{O}$ in terms of its commutator with $\\mathbf{P}$. Your derivation must not assume the result and should use only the canonical commutation relations and the Baker–Campbell–Hausdorff formula.\n2. Many shell-model codes implement the electric quadrupole ($E2$) operator in the long-wavelength limit as a rank-2 Cartesian tensor\n$$Q_{\\alpha\\beta} \\equiv \\sum_{i=1}^{A} e_{i}\\left(3\\,r_{i,\\alpha}r_{i,\\beta} - r_{i}^{2}\\,\\delta_{\\alpha\\beta}\\right),$$\nwhere $e_{i}$ are effective charges and $r_{i}^{2} \\equiv \\mathbf{r}_{i}\\cdot\\mathbf{r}_{i}$. Compute the commutator $[Q_{\\alpha\\beta},P_{\\gamma}]$ explicitly in terms of $\\mathbf{r}_{i}$, displaying all index contractions.\n3. Many shell-model codes implement the magnetic dipole ($M1$) operator in the long-wavelength limit as a vector operator\n$$\\mathbf{T}(M1) \\equiv \\mu_{N}\\sum_{i=1}^{A}\\left(g_{\\ell}^{(i)}\\,\\mathbf{\\ell}_{i} + g_{s}^{(i)}\\,\\mathbf{s}_{i}\\right),$$\nwhere $\\mu_{N}$ is the nuclear magneton, $g_{\\ell}^{(i)}$ and $g_{s}^{(i)}$ are orbital and spin $g$-factors, $\\mathbf{s}_{i}$ acts in intrinsic spin space and commutes with all $\\mathbf{r}_{j}$ and $\\mathbf{p}_{j}$, and $\\mathbf{\\ell}_{i} \\equiv \\mathbf{r}_{i}\\times\\mathbf{p}_{i}$ has components $\\ell_{i,\\alpha} \\equiv \\epsilon_{\\alpha\\beta\\gamma} r_{i,\\beta}p_{i,\\gamma}$ with the Levi-Civita symbol $\\epsilon_{\\alpha\\beta\\gamma}$. Compute the mixed commutator $[T(M1)_{\\alpha},P_{\\delta}]$ explicitly and determine which parts (orbital versus spin) are translationally invariant.\n4. Using the criterion from part 1, explain why the “intrinsic” replacements $\\mathbf{r}_{i}\\mapsto \\boldsymbol{\\xi}_{i}\\equiv \\mathbf{r}_{i}-\\mathbf{R}_{\\mathrm{cm}}$ and $\\mathbf{p}_{i}\\mapsto \\boldsymbol{\\pi}_{i}\\equiv \\mathbf{p}_{i}-\\mathbf{P}/A$ remove spurious Center-of-Mass contamination for multipole operators constructed from coordinates and momenta; explicitly state the commutators $[\\xi_{i,\\alpha},P_{\\beta}]$ and $[\\pi_{i,\\alpha},P_{\\beta}]$.\nProvide as your final answer only the pair of expressions for the commutators from parts 2 and 3, in Cartesian-index notation, as a row matrix $\\big([Q_{\\alpha\\beta},P_{\\gamma}] \\;\\; [T(M1)_{\\alpha},P_{\\delta}]\\big)$. No numerical evaluation is required; keep all quantities symbolic. The final answer should be a single closed-form analytic expression; do not include any units in the final boxed expression.", "solution": "The problem is validated as scientifically grounded, well-posed, and objective. It addresses a fundamental issue in nuclear shell-model calculations. We can proceed with a full solution.\n\n**1. Criterion for Translational Invariance**\n\nAn operator $\\hat{O}$ is translationally invariant if it is unchanged by a spatial translation. The unitary operator for a translation by a vector $\\mathbf{a}$ is given as $U(\\mathbf{a}) \\equiv \\exp\\!\\left(-\\frac{i}{\\hbar}\\,\\mathbf{a}\\cdot\\mathbf{P}\\right)$. Under this transformation, an operator $\\hat{O}$ transforms to $\\hat{O}' = U(\\mathbf{a})^\\dagger \\hat{O} U(\\mathbf{a})$. The condition for invariance is $\\hat{O}' = \\hat{O}$, which implies $U(\\mathbf{a})^\\dagger \\hat{O} U(\\mathbf{a}) = \\hat{O}$. As $U(\\mathbf{a})$ is unitary, this is equivalent to the condition that $\\hat{O}$ commutes with $U(\\mathbf{a})$, i.e., $[\\hat{O}, U(\\mathbf{a})] = 0$.\n\nTo find a more fundamental criterion, we consider the transformation using the Baker–Campbell–Hausdorff (BCH) expansion for an operator similarity transformation, $e^X Y e^{-X} = Y + [X,Y] + \\frac{1}{2!}[X,[X,Y]] + \\dots$.\nIn our case, the transformation is $U(\\mathbf{a})^\\dagger \\hat{O} U(\\mathbf{a}) = e^{\\frac{i}{\\hbar}\\mathbf{a}\\cdot\\mathbf{P}} \\hat{O} e^{-\\frac{i}{\\hbar}\\mathbf{a}\\cdot\\mathbf{P}}$.\nLet $X = \\frac{i}{\\hbar}\\mathbf{a}\\cdot\\mathbf{P}$ and $Y = \\hat{O}$. The transformed operator is:\n$$ \\hat{O}' = \\hat{O} + \\left[\\frac{i}{\\hbar}\\mathbf{a}\\cdot\\mathbf{P}, \\hat{O}\\right] + \\frac{1}{2!}\\left[\\frac{i}{\\hbar}\\mathbf{a}\\cdot\\mathbf{P}, \\left[\\frac{i}{\\hbar}\\mathbf{a}\\cdot\\mathbf{P}, \\hat{O}\\right]\\right] + \\dots $$\n$$ \\hat{O}' = \\hat{O} - \\frac{i}{\\hbar}[\\hat{O}, \\mathbf{a}\\cdot\\mathbf{P}] - \\frac{1}{2\\hbar^2}[\\mathbf{a}\\cdot\\mathbf{P}, [\\hat{O}, \\mathbf{a}\\cdot\\mathbf{P}]] + \\dots $$\nFor $\\hat{O}$ to be translationally invariant, we must have $\\hat{O}'=\\hat{O}$ for any arbitrary translation vector $\\mathbf{a}$. This requires all terms beyond the first in the expansion to vanish. The vanishing of the first-order term is a sufficient condition for all higher-order terms to vanish as well.\nThe first-order term is $[\\hat{O}, \\mathbf{a}\\cdot\\mathbf{P}] = \\left[\\hat{O}, \\sum_{\\gamma} a_\\gamma P_\\gamma\\right] = \\sum_{\\gamma} a_\\gamma [\\hat{O}, P_\\gamma]$.\nFor this to be zero for any arbitrary vector $\\mathbf{a}$, the coefficient of each component $a_\\gamma$ must be zero. This leads to the necessary and sufficient condition:\n$$ [\\hat{O}, P_\\gamma] = 0 \\quad \\text{for all } \\gamma \\in \\{x,y,z\\}. $$\nIn vector notation, the criterion is $[\\hat{O}, \\mathbf{P}] = 0$.\n\n**2. Commutator for the E2 Operator**\n\nThe electric quadrupole operator is given by $Q_{\\alpha\\beta} \\equiv \\sum_{i=1}^{A} e_{i}\\left(3\\,r_{i,\\alpha}r_{i,\\beta} - r_{i}^{2}\\,\\delta_{\\alpha\\beta}\\right)$, and the total momentum is $P_{\\gamma} = \\sum_{j=1}^{A} p_{j,\\gamma}$. We compute the commutator $[Q_{\\alpha\\beta},P_{\\gamma}]$.\n$$ [Q_{\\alpha\\beta}, P_{\\gamma}] = \\left[\\sum_{i=1}^{A} e_{i}\\left(3\\,r_{i,\\alpha}r_{i,\\beta} - r_{i}^{2}\\,\\delta_{\\alpha\\beta}\\right), \\sum_{j=1}^{A} p_{j,\\gamma}\\right] $$\nUsing the linearity of the commutator and the fact that operators for different particles commute if they are of the same type (r-r or p-p), the commutator simplifies:\n$$ [Q_{\\alpha\\beta}, P_{\\gamma}] = \\sum_{i=1}^{A} \\sum_{j=1}^{A} e_i [3r_{i,\\alpha}r_{i,\\beta} - r_{i}^{2}\\delta_{\\alpha\\beta}, p_{j,\\gamma}] $$\nWe use the fundamental commutation relation $[r_{k,\\mu}, p_{l,\\nu}] = i\\hbar \\delta_{kl}\\delta_{\\mu\\nu}$ and the identity $[AB, C] = A[B,C] + [A,C]B$.\nFirst, we find the commutator of the term $r_{i,\\alpha}r_{i,\\beta}$ with $p_{j,\\gamma}$:\n$$ [r_{i,\\alpha}r_{i,\\beta}, p_{j,\\gamma}] = r_{i,\\alpha}[r_{i,\\beta}, p_{j,\\gamma}] + [r_{i,\\alpha}, p_{j,\\gamma}]r_{i,\\beta} = r_{i,\\alpha}(i\\hbar\\delta_{ij}\\delta_{\\beta\\gamma}) + (i\\hbar\\delta_{ij}\\delta_{\\alpha\\gamma})r_{i,\\beta} = i\\hbar\\delta_{ij}(r_{i,\\alpha}\\delta_{\\beta\\gamma} + r_{i,\\beta}\\delta_{\\alpha\\gamma}) $$\nNext, for the term $r_i^2 = \\sum_{\\mu} r_{i,\\mu}r_{i,\\mu}$:\n$$ [r_i^2, p_{j,\\gamma}] = \\sum_{\\mu} [r_{i,\\mu}r_{i,\\mu}, p_{j,\\gamma}] = \\sum_{\\mu} (r_{i,\\mu}[r_{i,\\mu}, p_{j,\\gamma}] + [r_{i,\\mu}, p_{j,\\gamma}]r_{i,\\mu}) $$\n$$ = \\sum_{\\mu} (r_{i,\\mu}(i\\hbar\\delta_{ij}\\delta_{\\mu\\gamma}) + (i\\hbar\\delta_{ij}\\delta_{\\mu\\gamma})r_{i,\\mu}) = 2i\\hbar\\delta_{ij} \\sum_{\\mu} r_{i,\\mu}\\delta_{\\mu\\gamma} = 2i\\hbar\\delta_{ij}r_{i,\\gamma} $$\nCombining these results:\n$$ [3r_{i,\\alpha}r_{i,\\beta} - r_{i}^{2}\\delta_{\\alpha\\beta}, p_{j,\\gamma}] = 3 i\\hbar\\delta_{ij}(r_{i,\\alpha}\\delta_{\\beta\\gamma} + r_{i,\\beta}\\delta_{\\alpha\\gamma}) - (2i\\hbar\\delta_{ij}r_{i,\\gamma})\\delta_{\\alpha\\beta} $$\n$$ = i\\hbar\\delta_{ij}[3(r_{i,\\alpha}\\delta_{\\beta\\gamma} + r_{i,\\beta}\\delta_{\\alpha\\gamma}) - 2\\delta_{\\alpha\\beta}r_{i,\\gamma}] $$\nSubstituting this back into the full commutator and summing over $i$ and $j$, the Kronecker delta $\\delta_{ij}$ collapses the sum over $j$:\n$$ [Q_{\\alpha\\beta}, P_{\\gamma}] = \\sum_{i=1}^{A} e_i \\left( i\\hbar [3(r_{i,\\alpha}\\delta_{\\beta\\gamma} + r_{i,\\beta}\\delta_{\\alpha\\gamma}) - 2\\delta_{\\alpha\\beta}r_{i,\\gamma}] \\right) $$\n$$ [Q_{\\alpha\\beta}, P_{\\gamma}] = i\\hbar \\sum_{i=1}^{A} e_i (3(r_{i,\\alpha}\\delta_{\\beta\\gamma} + r_{i,\\beta}\\delta_{\\alpha\\gamma}) - 2r_{i,\\gamma}\\delta_{\\alpha\\beta}) $$\nSince this commutator is non-zero, the operator $Q_{\\alpha\\beta}$ is not translationally invariant.\n\n**3. Commutator for the M1 Operator**\n\nThe magnetic dipole operator is $\\mathbf{T}(M1) \\equiv \\mu_{N}\\sum_{i=1}^{A}\\left(g_{\\ell}^{(i)}\\,\\mathbf{\\ell}_{i} + g_{s}^{(i)}\\,\\mathbf{s}_{i}\\right)$. We compute the commutator of its $\\alpha$-component with the $\\delta$-component of the total momentum, $[T(M1)_{\\alpha}, P_{\\delta}]$.\n$$ [T(M1)_{\\alpha}, P_{\\delta}] = \\mu_N \\sum_{i=1}^A \\sum_{j=1}^A [g_{\\ell}^{(i)}\\ell_{i,\\alpha} + g_s^{(i)}s_{i,\\alpha}, p_{j,\\delta}] $$\nWe can analyze the orbital and spin parts separately.\nFor the spin part, we are given that spin operators commute with all spatial and momentum operators, i.e., $[s_{i,\\alpha}, p_{j,\\delta}] = 0$. Consequently, the commutator involving the spin g-factor terms is zero:\n$$ \\mu_N \\sum_{i,j} g_s^{(i)} [s_{i,\\alpha}, p_{j,\\delta}] = 0 $$\nThus, the spin part of the $M1$ operator is translationally invariant.\nFor the orbital part, we need to compute $[\\ell_{i,\\alpha}, p_{j,\\delta}]$. The orbital angular momentum component is $\\ell_{i,\\alpha} = \\sum_{\\mu,\\nu}\\epsilon_{\\alpha\\mu\\nu} r_{i,\\mu} p_{i,\\nu}$.\n$$ [\\ell_{i,\\alpha}, p_{j,\\delta}] = \\sum_{\\mu,\\nu}\\epsilon_{\\alpha\\mu\\nu} [r_{i,\\mu} p_{i,\\nu}, p_{j,\\delta}] = \\sum_{\\mu,\\nu}\\epsilon_{\\alpha\\mu\\nu} (r_{i,\\mu}[p_{i,\\nu}, p_{j,\\delta}] + [r_{i,\\mu}, p_{j,\\delta}]p_{i,\\nu}) $$\nThe first term vanishes because momentum operators commute, $[p_{i,\\nu}, p_{j,\\delta}] = 0$.\n$$ [\\ell_{i,\\alpha}, p_{j,\\delta}] = \\sum_{\\mu,\\nu}\\epsilon_{\\alpha\\mu\\nu} (i\\hbar\\delta_{ij}\\delta_{\\mu\\delta}) p_{i,\\nu} = i\\hbar\\delta_{ij} \\sum_{\\mu,\\nu}\\epsilon_{\\alpha\\mu\\nu}\\delta_{\\mu\\delta}p_{i,\\nu} = i\\hbar\\delta_{ij} \\sum_{\\nu}\\epsilon_{\\alpha\\delta\\nu} p_{i,\\nu} $$\nNow, we compute the full commutator for the orbital part:\n$$ \\mu_N \\sum_{i,j} g_{\\ell}^{(i)} [\\ell_{i,\\alpha}, p_{j,\\delta}] = \\mu_N \\sum_{i,j} g_{\\ell}^{(i)} \\left( i\\hbar\\delta_{ij} \\sum_{\\nu}\\epsilon_{\\alpha\\delta\\nu} p_{i,\\nu} \\right) $$\nSumming over $j$ using $\\delta_{ij}$:\n$$ = i\\hbar\\mu_N \\sum_{i=1}^A g_{\\ell}^{(i)} \\sum_{\\nu}\\epsilon_{\\alpha\\delta\\nu} p_{i,\\nu} $$\nLetting the dummy index be $\\sigma$, the final commutator is:\n$$ [T(M1)_{\\alpha}, P_{\\delta}] = i\\hbar\\mu_N \\sum_{i=1}^{A} g_{\\ell}^{(i)} \\epsilon_{\\alpha\\delta\\sigma} p_{i,\\sigma} $$\nThe orbital part of the $M1$ operator is generally not translationally invariant.\n\n**4. Intrinsic Coordinates and Momenta**\n\nSpurious center-of-mass contamination can be removed by constructing operators from intrinsic coordinates $\\boldsymbol{\\xi}_i \\equiv \\mathbf{r}_i - \\mathbf{R}_{\\mathrm{cm}}$ and intrinsic momenta $\\boldsymbol{\\pi}_i \\equiv \\mathbf{p}_i - \\mathbf{P}/A$. According to the criterion from part 1, an operator is translationally invariant if it commutes with the total momentum $\\mathbf{P}$. If we can show that the building blocks $\\boldsymbol{\\xi}_i$ and $\\boldsymbol{\\pi}_i$ commute with $\\mathbf{P}$, then any operator constructed purely from these intrinsic variables will also commute with $\\mathbf{P}$ and thus be free of COM contamination.\n\nLet's compute the commutator $[\\xi_{i,\\alpha}, P_\\beta]$:\n$$ [\\xi_{i,\\alpha}, P_\\beta] = \\left[r_{i,\\alpha} - \\frac{1}{A}\\sum_{j=1}^A r_{j,\\alpha}, \\sum_{k=1}^A p_{k,\\beta}\\right] $$\n$$ = \\sum_{k=1}^A [r_{i,\\alpha}, p_{k,\\beta}] - \\frac{1}{A}\\sum_{j=1}^A\\sum_{k=1}^A [r_{j,\\alpha}, p_{k,\\beta}] $$\n$$ = \\sum_{k=1}^A i\\hbar\\delta_{ik}\\delta_{\\alpha\\beta} - \\frac{1}{A}\\sum_{j=1}^A\\sum_{k=1}^A i\\hbar\\delta_{jk}\\delta_{\\alpha\\beta} $$\n$$ = i\\hbar\\delta_{\\alpha\\beta} - \\frac{i\\hbar\\delta_{\\alpha\\beta}}{A}\\sum_{j=1}^A 1 = i\\hbar\\delta_{\\alpha\\beta} - \\frac{i\\hbar\\delta_{\\alpha\\beta}}{A}A = 0 $$\nSo, $[\\xi_{i,\\alpha}, P_\\beta] = 0$.\n\nNext, let's compute the commutator $[\\pi_{i,\\alpha}, P_\\beta]$:\n$$ [\\pi_{i,\\alpha}, P_\\beta] = \\left[p_{i,\\alpha} - \\frac{1}{A}\\sum_{j=1}^A p_{j,\\alpha}, \\sum_{k=1}^A p_{k,\\beta}\\right] $$\n$$ = \\sum_{k=1}^A [p_{i,\\alpha}, p_{k,\\beta}] - \\frac{1}{A}\\sum_{j=1}^A\\sum_{k=1}^A [p_{j,\\alpha}, p_{k,\\beta}] $$\nSince momentum operators commute with each other, $[p_{\\mu}, p_{\\nu}] = 0$, both terms are zero.\n$$ [\\pi_{i,\\alpha}, P_\\beta] = 0 - 0 = 0 $$\nSince both $\\boldsymbol{\\xi}_i$ and $\\boldsymbol{\\pi}_i$ commute with the total momentum $\\mathbf{P}$, any operator constructed from them (e.g., an intrinsic quadrupole operator $\\sum_i e_i (3\\xi_{i,\\alpha}\\xi_{i,\\beta} - \\xi_i^2\\delta_{\\alpha\\beta})$ or an intrinsic angular momentum $\\boldsymbol{\\xi}_i \\times \\boldsymbol{\\pi}_i$) will also commute with $\\mathbf{P}$. This guarantees that such operators are translationally invariant and do not induce spurious transitions involving the center-of-mass motion.", "answer": "$$ \\boxed{ \\begin{pmatrix} i\\hbar \\sum_{i=1}^{A} e_i \\left(3(r_{i,\\alpha}\\delta_{\\beta\\gamma} + r_{i,\\beta}\\delta_{\\alpha\\gamma}) - 2r_{i,\\gamma}\\delta_{\\alpha\\beta}\\right) & i\\hbar\\mu_N \\sum_{i=1}^{A} g_{\\ell}^{(i)} \\epsilon_{\\alpha\\delta\\sigma} p_{i,\\sigma} \\end{pmatrix} } $$", "id": "3548888"}, {"introduction": "Having established that spurious CM effects can be introduced by our operators, we now explore a common method for actively suppressing them during a calculation. This practice introduces the Lawson method, which adds a penalty term to the Hamiltonian to energetically separate spurious states from physical ones. You will implement a stability test within a simplified two-level model [@problem_id:3548901], allowing you to computationally investigate how the strength of the Lawson term and the choice of basis frequency impact the removal of CM contamination and build intuition for its practical application.", "problem": "You are asked to design and implement a computational stability test for the removal of center-of-mass (COM) contamination in a truncated harmonic-oscillator shell-model space using a two-level surrogate. The test must vary the harmonic-oscillator frequency parameter and the Lawson penalty independently, and quantify the residual COM excitation in the computed ground state. Your program should output a numerical diagnostic for a given test suite of parameter triples.\n\nStart from the following fundamental base. For a translationally invariant system of identical nucleons, the total Hamiltonian can be separated into intrinsic and center-of-mass parts. In a harmonic-oscillator basis of frequency parameter $\\,\\hbar\\Omega\\,$, the center-of-mass Hamiltonian has eigenvalues\n$$\nE_{\\text{cm}}(n) \\;=\\; \\left(n + \\tfrac{3}{2}\\right)\\,\\hbar\\Omega,\\quad n\\in\\{0,1,2,\\dots\\}.\n$$\nIn truncated many-body spaces, residual coupling between intrinsic and center-of-mass sectors can contaminate the low-lying spectrum. The Lawson prescription adds a penalty term proportional to the operator $\\,H_{\\text{cm}} - \\tfrac{3}{2}\\hbar\\Omega\\,$ with a nonnegative dimensionless strength $\\,\\beta\\,$, shifting spurious center-of-mass excitations upwards without altering the exact $\\,n=0\\,$ sector in the complete space.\n\nTo capture this physics in a minimal, universally solvable setting, adopt a two-state surrogate in which a single intrinsic ground configuration is coupled to $\\,n=0\\,$ and $\\,n=1\\,$ center-of-mass sectors. In the ordered basis $\\,\\{|{\\rm c}0\\rangle, |{\\rm c}1\\rangle\\}\\,$ with $\\,|{\\rm c}0\\rangle \\equiv |{\\rm int}\\rangle\\otimes|n=0\\rangle\\,$ and $\\,|{\\rm c}1\\rangle \\equiv |{\\rm int}\\rangle\\otimes|n=1\\rangle\\,$, define the truncated-space effective Hamiltonian\n$$\nH'(\\hbar\\Omega,\\beta,\\epsilon)\n\\;=\\;\n\\begin{bmatrix}\n\\tfrac{3}{2}\\hbar\\Omega & \\epsilon \\\\\n\\epsilon & \\left(\\tfrac{5}{2}+\\beta\\right)\\hbar\\Omega\n\\end{bmatrix},\n$$\nwhere $\\,\\epsilon\\ge 0\\,$ (in $\\,$MeV$\\,)$ is a small, real coupling that parameterizes the residual mixing between the $\\,n=0\\,$ and $\\,n=1\\,$ center-of-mass sectors induced by basis truncation. The exact intrinsic energy is an overall constant shift and can be set to zero without loss of generality. The center-of-mass Hamiltonian in this basis is\n$$\nH_{\\text{cm}}(\\hbar\\Omega)\n\\;=\\;\n\\begin{bmatrix}\n\\tfrac{3}{2}\\hbar\\Omega & 0 \\\\\n0 & \\tfrac{5}{2}\\hbar\\Omega\n\\end{bmatrix}.\n$$\n\nFor each parameter triple $\\,(\\hbar\\Omega,\\beta,\\epsilon)\\,$, define the ground state of $\\,H'(\\hbar\\Omega,\\beta,\\epsilon)\\,$ as the normalized eigenvector associated with the smallest eigenvalue, and compute the diagnostic\n$$\n\\delta_{\\text{cm}}(\\hbar\\Omega,\\beta,\\epsilon)\n\\;=\\;\n\\langle H_{\\text{cm}}(\\hbar\\Omega)\\rangle_{\\text{gs}}\n\\;-\\;\n\\tfrac{3}{2}\\hbar\\Omega,\n$$\nexpressed in $\\,\\text{MeV}\\,$. This quantity vanishes when the state is purely $\\,n=0\\,$ in the center-of-mass sector and is positive when there is admixture of $\\,n\\ge 1\\,$ spurious components. Your stability test consists of varying $\\,\\hbar\\Omega\\,$ and $\\,\\beta\\,$ independently at fixed $\\,\\epsilon\\,$ and interpreting the parametric behavior of $\\,\\delta_{\\text{cm}}\\,$ as evidence for or against satisfactory decoupling. Satisfactory decoupling is indicated when $\\,\\delta_{\\text{cm}}\\,$ remains small and insensitive to variations of $\\,\\hbar\\Omega\\,$ across a physically reasonable range once $\\,\\beta\\,$ is large enough.\n\nImplement a program that, for a given set of $\\,(\\hbar\\Omega,\\beta,\\epsilon)\\,$ values, constructs $\\,H'(\\hbar\\Omega,\\beta,\\epsilon)\\,$, obtains its ground state, evaluates $\\,\\langle H_{\\text{cm}}(\\hbar\\Omega)\\rangle_{\\text{gs}}\\,$, and reports $\\,\\delta_{\\text{cm}}(\\hbar\\Omega,\\beta,\\epsilon)\\,$ in $\\,\\text{MeV}\\,$.\n\nUse the following test suite of parameter triples, each given as $\\,(\\hbar\\Omega\\,\\text{in MeV},\\,\\beta\\,\\text{dimensionless},\\,\\epsilon\\,\\text{in MeV})\\,$:\n- Case $\\,1\\,$: $\\,(\\,20,\\,5,\\,0.5\\,)\\,$.\n- Case $\\,2\\,$: $\\,(\\,20,\\,0,\\,0.5\\,)\\,$.\n- Case $\\,3\\,$: $\\,(\\,5,\\,0,\\,0.5\\,)\\,$.\n- Case $\\,4\\,$: $\\,(\\,5,\\,50,\\,0.5\\,)\\,$.\n- Case $\\,5\\,$: $\\,(\\,15,\\,0,\\,0\\,)\\,$.\n- Case $\\,6\\,$: $\\,(\\,1,\\,0,\\,0.5\\,)\\,$.\n\nRequirements:\n- All energies must be treated and reported in $\\,\\text{MeV}\\,$.\n- Compute $\\,\\delta_{\\text{cm}}(\\hbar\\Omega,\\beta,\\epsilon)\\,$ for each case and round each result to exactly $\\,6\\,$ decimal places.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, ordered by the cases above, for example, $\\,\\texttt{[x\\_1,x\\_2,\\dots,x\\_6]}\\,$ where each $\\,x_i\\,$ is a floating-point number in $\\,\\text{MeV}\\,$ rounded to $\\,6\\,$ decimals.\n\nNo user input is to be read. All data must be hard-coded. The algorithm must rely only on linear algebra and the definitions given here, without introducing additional phenomenological parameters beyond $\\,\\hbar\\Omega\\,$, $\\,\\beta\\,$, and $\\,\\epsilon\\,$.", "solution": "The problem requires the calculation of a diagnostic quantity, $\\delta_{\\text{cm}}$, which measures the degree of center-of-mass (COM) contamination in the ground state of a simplified $2$-level nuclear shell-model problem. The problem is well-posed and scientifically grounded, providing all necessary definitions and data for a unique solution.\n\nThe system is described by a $2 \\times 2$ effective Hamiltonian, $H'(\\hbar\\Omega,\\beta,\\epsilon)$, within the basis $\\{|{\\rm c}0\\rangle, |{\\rm c}1\\rangle\\}$, where $|{\\rm c}0\\rangle$ represents the intrinsic ground state coupled to the $n=0$ COM state, and $|{\\rm c}1\\rangle$ represents the same intrinsic state coupled to the spurious $n=1$ COM state. The Hamiltonian is given by:\n$$\nH'(\\hbar\\Omega,\\beta,\\epsilon)\n\\;=\\;\n\\begin{bmatrix}\n\\frac{3}{2}\\hbar\\Omega & \\epsilon \\\\\n\\epsilon & \\left(\\frac{5}{2}+\\beta\\right)\\hbar\\Omega\n\\end{bmatrix}\n$$\nHere, $\\hbar\\Omega$ is the harmonic oscillator energy, $\\beta$ is the dimensionless strength of the Lawson penalty term, and $\\epsilon$ is the truncation-induced coupling between the two basis states.\n\nThe ground state, $|\\psi_{\\text{gs}}\\rangle$, is the normalized eigenvector of $H'$ corresponding to its lower eigenvalue. We can express this state as a superposition of the basis states:\n$$\n|\\psi_{\\text{gs}}\\rangle \\;=\\; c_0 |{\\rm c}0\\rangle + c_1 |{\\rm c}1\\rangle, \\quad \\text{with} \\quad |c_0|^2 + |c_1|^2 = 1.\n$$\nThe diagnostic $\\delta_{\\text{cm}}$ is defined as the expectation value of the COM Hamiltonian, $H_{\\text{cm}}$, in the ground state, shifted by the ground-state COM energy $\\frac{3}{2}\\hbar\\Omega$:\n$$\n\\delta_{\\text{cm}}(\\hbar\\Omega,\\beta,\\epsilon) \\;=\\; \\langle \\psi_{\\text{gs}}| H_{\\text{cm}}(\\hbar\\Omega) |\\psi_{\\text{gs}}\\rangle - \\frac{3}{2}\\hbar\\Omega\n$$\nThe COM Hamiltonian in this basis is diagonal:\n$$\nH_{\\text{cm}}(\\hbar\\Omega) \\;=\\; \\begin{bmatrix} \\frac{3}{2}\\hbar\\Omega & 0 \\\\ 0 & \\frac{5}{2}\\hbar\\Omega \\end{bmatrix}\n$$\nSubstituting $|\\psi_{\\text{gs}}\\rangle$ and $H_{\\text{cm}}$ into the definition of $\\delta_{\\text{cm}}$ yields:\n$$\n\\langle H_{\\text{cm}} \\rangle_{\\text{gs}} \\;=\\; |c_0|^2 \\left(\\frac{3}{2}\\hbar\\Omega\\right) + |c_1|^2 \\left(\\frac{5}{2}\\hbar\\Omega\\right)\n$$\nUsing the normalization condition $|c_0|^2 = 1 - |c_1|^2$, we get:\n$$\n\\langle H_{\\text{cm}} \\rangle_{\\text{gs}} \\;=\\; (1 - |c_1|^2) \\left(\\frac{3}{2}\\hbar\\Omega\\right) + |c_1|^2 \\left(\\frac{5}{2}\\hbar\\Omega\\right) \\;=\\; \\frac{3}{2}\\hbar\\Omega + |c_1|^2\\left(\\frac{5}{2}\\hbar\\Omega - \\frac{3}{2}\\hbar\\Omega\\right) \\;=\\; \\frac{3}{2}\\hbar\\Omega + |c_1|^2\\hbar\\Omega\n$$\nThus, the diagnostic simplifies to a direct measure of the spurious component's probability amplitude, scaled by $\\hbar\\Omega$:\n$$\n\\delta_{\\text{cm}} \\;=\\; \\left(\\frac{3}{2}\\hbar\\Omega + |c_1|^2\\hbar\\Omega\\right) - \\frac{3}{2}\\hbar\\Omega \\;=\\; |c_1|^2\\hbar\\Omega\n$$\nOur task reduces to finding $|c_1|^2$ for the ground state of $H'$. The components of the eigenvector of a $2 \\times 2$ real symmetric matrix can be found by parameterizing the state with a mixing angle $\\theta$:\n$$\n|\\psi_{\\text{gs}}\\rangle \\;=\\; \\cos\\theta |{\\rm c}0\\rangle + \\sin\\theta |{\\rm c}1\\rangle\n$$\nIn this representation, $|c_1|^2 = \\sin^2\\theta$. The ground state corresponds to the angle $\\theta$ that minimizes the energy expectation value $E(\\theta) = \\langle\\psi|H'|\\psi\\rangle$:\n$$\nE(\\theta) \\;=\\; \\cos^2\\theta \\left(\\frac{3}{2}\\hbar\\Omega\\right) + \\sin^2\\theta \\left(\\frac{5}{2}+\\beta\\right)\\hbar\\Omega + 2\\epsilon\\sin\\theta\\cos\\theta\n$$\nThe value of $\\theta$ for the ground state is determined by standard $2$-level system quantum mechanics. The fraction of the spurious component in the ground state, $\\sin^2\\theta$, is given by:\n$$\n|c_1|^2 = \\sin^2\\theta = \\frac{1}{2}\\left(1 - \\frac{\\Delta E}{\\sqrt{(\\Delta E)^2 + (2\\epsilon)^2}}\\right)\n$$\nwhere $\\Delta E$ is the difference in the diagonal matrix elements of $H'$:\n$$\n\\Delta E = \\left(\\frac{5}{2}+\\beta\\right)\\hbar\\Omega - \\frac{3}{2}\\hbar\\Omega = (1+\\beta)\\hbar\\Omega\n$$\nSince $\\hbar\\Omega > 0$ and $\\beta \\ge 0$, $\\Delta E$ is non-negative. Substituting $\\Delta E$ back into the expression for $|c_1|^2$:\n$$\n|c_1|^2 = \\frac{1}{2}\\left(1 - \\frac{(1+\\beta)\\hbar\\Omega}{\\sqrt{((1+\\beta)\\hbar\\Omega)^2 + 4\\epsilon^2}}\\right)\n$$\nFinally, we obtain the analytical formula for the diagnostic $\\delta_{\\text{cm}}$:\n$$\n\\delta_{\\text{cm}}(\\hbar\\Omega,\\beta,\\epsilon) \\;=\\; \\frac{\\hbar\\Omega}{2} \\left( 1 - \\frac{(1+\\beta)\\hbar\\Omega}{\\sqrt{(1+\\beta)^2(\\hbar\\Omega)^2 + 4\\epsilon^2}} \\right)\n$$\nThis formula can be directly implemented to compute the required values for the given test suite. For the special case where the coupling $\\epsilon=0$, the Hamiltonian $H'$ is already diagonal. The ground state is pure $|{\\rm c}0\\rangle$, so $|c_1|^2=0$ and $\\delta_{\\text{cm}}=0$. The formula correctly reproduces this limit.\n\nThe algorithm is as follows:\n$1$. For each parameter triple $(\\hbar\\Omega, \\beta, \\epsilon)$ from the test suite:\n$2$. Calculate the numerator term $N = (1+\\beta)\\hbar\\Omega$.\n$3$. Calculate the denominator term $D = \\sqrt{N^2 + 4\\epsilon^2}$.\n$4$. Compute $\\delta_{\\text{cm}} = \\frac{\\hbar\\Omega}{2} (1 - \\frac{N}{D})$.\n$5$. Round the result to $6$ decimal places.\n\nThe final program will apply this procedure to each test case and format the output as specified.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the center-of-mass contamination diagnostic for a two-level model\n    of a nuclear shell-model calculation.\n    \"\"\"\n\n    # Test suite of parameter triples: (hbar_omega in MeV, beta dimensionless, epsilon in MeV)\n    test_cases = [\n        (20.0, 5.0, 0.5),   # Case 1\n        (20.0, 0.0, 0.5),   # Case 2\n        (5.0, 0.0, 0.5),    # Case 3\n        (5.0, 50.0, 0.5),   # Case 4\n        (15.0, 0.0, 0.0),   # Case 5\n        (1.0, 0.0, 0.5),    # Case 6\n    ]\n\n    results = []\n    for hw, beta, eps in test_cases:\n        # The analytical formula for the diagnostic delta_cm is derived in the solution.\n        # delta_cm = (hw / 2) * (1 - ((1 + beta) * hw) / sqrt(((1 + beta) * hw)^2 + 4 * eps^2))\n\n        # Numerator of the fraction inside the parenthesis\n        num = (1.0 + beta) * hw\n        \n        # Denominator of the fraction\n        # Use np.sqrt for numerical stability and correctness.\n        den_squared = num**2 + 4.0 * eps**2\n        \n        # Ensure we don't take the square root of a negative number, though physically impossible here.\n        if den_squared  0:\n            # This case should not be reached with the given constraints.\n            # It is included for robustness.\n            delta_cm = float('nan') \n        else:\n            den = np.sqrt(den_squared)\n            \n            # Avoid division by zero if denominator is zero. This happens only if num=0 and eps=0.\n            # In our cases, hw > 0 so num > 0 if beta >= 0.\n            # If eps is 0, den=num, so fraction is 1 and delta_cm is 0.\n            if den == 0:\n                delta_cm = 0.0\n            else:\n                delta_cm = (hw / 2.0) * (1.0 - num / den)\n        \n        results.append(delta_cm)\n\n    # Format the results to exactly 6 decimal places and join into the required string format.\n    formatted_results = [f\"{res:.6f}\" for res in results]\n    \n    # Print the final output in the format [x_1,x_2,...,x_6]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n\n```", "id": "3548901"}, {"introduction": "Even with suppression techniques, a crucial final step in any shell-model calculation is to identify and filter out any states with residual CM contamination from the final spectrum. This computational practice guides you through the design of a robust post-processing algorithm to achieve this. By synthesizing information from the energy expectation value $\\langle H_{\\text{cm}} \\rangle$ and wavefunction overlaps [@problem_id:3548911], you will develop a practical tool for assigning a CM quantum number to each calculated state and purifying the spectrum, a necessary skill for producing physically meaningful theoretical predictions.", "problem": "You are given a computational task in the context of nuclear shell-model calculations performed in a harmonic-oscillator basis. In such calculations, the many-body wave functions may contain spuriosities from motion of the center of mass. You must design and implement an algorithm to approximately label each computed many-body state by a center-of-mass excitation quantum number $N_{\\text{cm}}$ using only expectation values of the center-of-mass Hamiltonian and overlaps with $b_{\\text{cm}}^\\dagger$-excited configurations, and then filter a spectrum accordingly.\n\nFundamental base:\n- The center-of-mass Hamiltonian $H_{\\text{cm}}$ for a system of $A$ nucleons in a harmonic trapping potential of frequency $\\Omega$ is the Hamiltonian of a three-dimensional harmonic oscillator in the center-of-mass coordinate $\\mathbf{R}_{\\text{cm}}$, with mass $A m$, and can be expressed as $H_{\\text{cm}} = \\frac{\\mathbf{P}_{\\text{cm}}^2}{2 A m} + \\frac{1}{2} A m \\Omega^2 \\mathbf{R}_{\\text{cm}}^2$.\n- Ladder operators $b_{\\text{cm}}$ and $b_{\\text{cm}}^\\dagger$ for the center-of-mass degree of freedom satisfy the commutator $[b_{\\text{cm}}, b_{\\text{cm}}^\\dagger] = 1$ and define a number operator $N_{\\text{cm}} = b_{\\text{cm}}^\\dagger b_{\\text{cm}}$.\n- The evenly spaced harmonic-oscillator spectrum follows from these, with energy separation $\\hbar \\Omega$ between adjacent $N_{\\text{cm}}$ manifolds.\n\nTask:\n- For each state, you are provided:\n  - The harmonic-oscillator scale $\\hbar\\Omega$ (in MeV).\n  - The intrinsic energy $E_{\\text{intr}}$ (in MeV).\n  - The expectation value $\\langle H_{\\text{cm}} \\rangle$ (in MeV).\n  - The squared overlap $s_1$ with a one-phonon center-of-mass excitation generated by $b_{\\text{cm}}^\\dagger$.\n  - The squared overlap $s_2$ with a two-phonon center-of-mass excitation generated by $(b_{\\text{cm}}^\\dagger)^2$.\n- Assume that, within the truncated information available, the approximate probabilities for $N_{\\text{cm}} \\in \\{0,1,2\\}$ satisfy $p_0 \\approx 1 - s_1 - s_2$, $p_1 \\approx s_1$, $p_2 \\approx s_2$, after enforcing a probability interpretation. If $s_1 + s_2  1$, you must renormalize $s_1$ and $s_2$ by a common factor so that $s_1 + s_2 = 1$, and then set $p_0 = 0$.\n- Starting from the above fundamentals, derive an algorithm that:\n  1. Uses $\\langle H_{\\text{cm}} \\rangle$ and $\\hbar\\Omega$ to construct an energy-based candidate integer label for $N_{\\text{cm}}$, by comparing $\\langle H_{\\text{cm}} \\rangle$ to the discrete ladder values implied by the harmonic-oscillator spacing.\n  2. Uses the overlaps $s_1$ and $s_2$ (after enforcing a probability interpretation) to construct an overlap-based candidate integer label for $N_{\\text{cm}}$ by selecting the most probable $N_{\\text{cm}} \\in \\{0,1,2\\}$.\n  3. Resolves discrepancies between the two candidates using a tolerance window parameter $\\epsilon$ (dimensionless), specified per test case, which defines an acceptance window of half-width $\\epsilon \\,\\hbar\\Omega$ around the ladder energies. If $\\langle H_{\\text{cm}} \\rangle$ lies within the window of the energy-based candidate, prefer the energy-based label; otherwise, prefer the overlap-based label. In case of a tie in the overlap-based decision or ambiguity, break ties by choosing the integer $N_{\\text{cm}}$ minimizing the distance to the energy-based real-valued estimate.\n  4. Estimates $p_0$ and filters the spectrum by retaining only those states for which the final label is $N_{\\text{cm}} = 0$ and $p_0 \\ge p_{0,\\min}$, where $p_{0,\\min}$ is a threshold specified per test case.\n- Output, for each test case, the list of intrinsic energies of the retained states.\n\nNumerical and unit requirements:\n- All energies ($\\hbar\\Omega$, $E_{\\text{intr}}$, $\\langle H_{\\text{cm}} \\rangle$) are provided and must be treated in MeV. Your final reported intrinsic energies must be in MeV.\n- You must round the reported intrinsic energies to three decimal places when printing.\n- Angles are not used.\n- Probabilities must be treated as decimals between $0$ and $1$.\n\nTest suite:\nImplement your algorithm on the following test suite. Each test case specifies $\\hbar\\Omega$ (in MeV), the window parameter $\\epsilon$ (dimensionless), the minimum acceptable $p_0$ threshold $p_{0,\\min}$, and a list of states with tuples $(E_{\\text{intr}}, \\langle H_{\\text{cm}} \\rangle, s_1, s_2)$, all energies in MeV.\n\n- Test case $1$:\n  - $\\hbar\\Omega = 16$.\n  - $\\epsilon = 0.2$.\n  - $p_{0,\\min} = 0.6$.\n  - States:\n    - $(E_{\\text{intr}}, \\langle H_{\\text{cm}} \\rangle, s_1, s_2) = (0.6, 24.1, 0.03, 0.01)$.\n    - $(E_{\\text{intr}}, \\langle H_{\\text{cm}} \\rangle, s_1, s_2) = (2.1, 40.2, 0.85, 0.05)$.\n    - $(E_{\\text{intr}}, \\langle H_{\\text{cm}} \\rangle, s_1, s_2) = (1.5, 33.0, 0.45, 0.10)$.\n- Test case $2$:\n  - $\\hbar\\Omega = 20$.\n  - $\\epsilon = 0.1$.\n  - $p_{0,\\min} = 0.7$.\n  - States:\n    - $(E_{\\text{intr}}, \\langle H_{\\text{cm}} \\rangle, s_1, s_2) = (0.8, 31.0, 0.20, 0.02)$.\n    - $(E_{\\text{intr}}, \\langle H_{\\text{cm}} \\rangle, s_1, s_2) = (1.1, 50.5, 0.60, 0.10)$.\n    - $(E_{\\text{intr}}, \\langle H_{\\text{cm}} \\rangle, s_1, s_2) = (1.3, 40.0, 0.35, 0.20)$.\n- Test case $3$:\n  - $\\hbar\\Omega = 12$.\n  - $\\epsilon = 0.15$.\n  - $p_{0,\\min} = 0.5$.\n  - States:\n    - $(E_{\\text{intr}}, \\langle H_{\\text{cm}} \\rangle, s_1, s_2) = (2.5, 30.0, 0.70, 0.50)$.\n    - $(E_{\\text{intr}}, \\langle H_{\\text{cm}} \\rangle, s_1, s_2) = (0.4, 18.4, 0.12, 0.03)$.\n    - $(E_{\\text{intr}}, \\langle H_{\\text{cm}} \\rangle, s_1, s_2) = (1.9, 24.0, 0.40, 0.10)$.\n- Test case $4$:\n  - $\\hbar\\Omega = 10$.\n  - $\\epsilon = 0.25$.\n  - $p_{0,\\min} = 0.8$.\n  - States:\n    - $(E_{\\text{intr}}, \\langle H_{\\text{cm}} \\rangle, s_1, s_2) = (0.9, 17.0, 0.15, 0.00)$.\n    - $(E_{\\text{intr}}, \\langle H_{\\text{cm}} \\rangle, s_1, s_2) = (0.7, 15.0, 0.18, 0.02)$.\n    - $(E_{\\text{intr}}, \\langle H_{\\text{cm}} \\rangle, s_1, s_2) = (2.2, 35.0, 0.30, 0.55)$.\n\nRequired final output format:\n- Your program should produce a single line of output containing the results as a comma-separated list of lists, each inner list containing the retained intrinsic energies for one test case, rounded to three decimals and expressed in MeV, for example: $[[x_{11},x_{12}], [x_{21}], [\\,], [x_{41},x_{42},x_{43}]]$.\n- No other text may be printed.\n- Your program must be a complete, runnable program and must not require any external input. All constants and data are specified above and must be embedded in the code.", "solution": "The problem requires the design and implementation of an algorithm to filter a set of calculated nuclear states from a shell-model calculation. The goal is to retain only those states that are predominantly in the center-of-mass (CM) ground state, i.e., free of spurious CM excitation. This is a common and critical procedure in nuclear structure theory, as calculations performed in a truncated basis, such as the harmonic oscillator basis, can artificially mix the intrinsic structure of the nucleus with the motion of its center of mass.\n\nThe algorithm will assign an integer CM excitation quantum number $N_{\\text{cm}}$ to each state and then filter based on this label and the state's purity. The assignment process synthesizes information from two sources: the expectation value of the CM Hamiltonian, $\\langle H_{\\text{cm}} \\rangle$, and the squared overlaps, $s_1$ and $s_2$, with states containing one or two quanta of CM excitation.\n\n**Theoretical Foundation**\n\nThe center-of-mass Hamiltonian for a system of $A$ nucleons in a harmonic oscillator potential is given as $H_{\\text{cm}} = \\frac{\\mathbf{P}_{\\text{cm}}^2}{2 A m} + \\frac{1}{2} A m \\Omega^2 \\mathbf{R}_{\\text{cm}}^2$. This is the Hamiltonian for a three-dimensional isotropic harmonic oscillator. Its energy eigenvalues are quantized and are given by:\n$$\nE_{N_{\\text{cm}}} = \\left(N_{\\text{cm}} + \\frac{3}{2}\\right) \\hbar\\Omega\n$$\nwhere $N_{\\text{cm}} = 0, 1, 2, \\dots$ is the principal quantum number for the CM motion and $\\hbar\\Omega$ is the energy spacing of the oscillator. The term $\\frac{3}{2}\\hbar\\Omega$ represents the zero-point energy of the 3D oscillator.\n\nA calculated many-body state $|\\Psi\\rangle$ from a shell-model calculation in a truncated basis is generally not an eigenstate of $N_{\\text{cm}}$. It can be expressed as a superposition of components with different CM quantum numbers:\n$$\n|\\Psi\\rangle = \\sum_{N_{\\text{cm}}=0}^{\\infty} c_{N_{\\text{cm}}} |\\phi_{\\text{intr}}; N_{\\text{cm}}\\rangle\n$$\nHere, $|\\phi_{\\text{intr}}; N_{\\text{cm}}\\rangle$ denotes a state with a specific intrinsic structure $\\phi_{\\text{intr}}$ and a CM excitation of $N_{\\text{cm}}$. The probability of the state having a CM excitation $N_{\\text{cm}}$ is $p_{N_{\\text{cm}}} = |c_{N_{\\text{cm}}}|^2$. The expectation value of the CM Hamiltonian is the weighted average of the energy eigenvalues:\n$$\n\\langle H_{\\text{cm}} \\rangle = \\langle \\Psi | H_{\\text{cm}} | \\Psi \\rangle = \\sum_{N_{\\text{cm}}=0}^{\\infty} p_{N_{\\text{cm}}} E_{N_{\\text{cm}}} = \\sum_{N_{\\text{cm}}=0}^{\\infty} p_{N_{\\text{cm}}} \\left(N_{\\text{cm}} + \\frac{3}{2}\\right) \\hbar\\Omega\n$$\nThis can be rewritten in terms of the expectation value of the CM number operator, $\\langle N_{\\text{cm}} \\rangle = \\sum p_{N_{\\text{cm}}} N_{\\text{cm}}$:\n$$\n\\langle H_{\\text{cm}} \\rangle = \\left(\\langle N_{\\text{cm}} \\rangle + \\frac{3}{2}\\right) \\hbar\\Omega\n$$\n\n**Algorithmic Procedure**\n\nThe algorithm processes each state through a sequence of steps to determine its final CM label, $N_{\\text{cm, final}}$, and then applies a filter.\n\n**1. Probability Estimation**\nThe problem provides limited information about the wave function composition through the squared overlaps $s_1$ and $s_2$. We are instructed to use these to approximate the probabilities $p_0$, $p_1$, and $p_2$, truncating the expansion at $N_{\\text{cm}}=2$. The probabilities $\\{p_0, p_1, p_2\\}$ must sum to $1$.\n- If $s_1 + s_2 \\le 1$, we assume these overlaps directly approximate the probabilities for excited components, and the remaining probability corresponds to the ground state:\n  $p_1 = s_1$, $p_2 = s_2$, and $p_0 = 1 - s_1 - s_2$.\n- If $s_1 + s_2  1$, the overlaps violate a simple probability interpretation (perhaps due to non-orthogonality of the basis states used to compute them). The problem prescribes a renormalization procedure:\n  $p_0 = 0$, $p_1 = \\frac{s_1}{s_1+s_2}$, and $p_2 = \\frac{s_2}{s_1+s_2}$. This assumes the state has no $N_{\\text{cm}}=0$ component and distributes the total probability between the $N_{\\text{cm}}=1$ and $N_{\\text{cm}}=2$ components.\n\n**2. Energy-Based Candidate Label ($N_{\\text{cm, E}}$)**\nFrom the energy expectation value relation, we can derive a continuous, or real-valued, estimate for the average CM quantum number:\n$$\n\\langle N_{\\text{cm}} \\rangle_{\\text{real}} = \\frac{\\langle H_{\\text{cm}} \\rangle}{\\hbar\\Omega} - \\frac{3}{2}\n$$\nThe most intuitive integer candidate for the state's dominant CM character, based on its energy, is the integer closest to this real-valued estimate. This gives the energy-based label:\n$$\nN_{\\text{cm, E}} = \\text{round}\\left( \\langle N_{\\text{cm}} \\rangle_{\\text{real}} \\right)\n$$\nwhere $\\text{round}(\\cdot)$ denotes rounding to the nearest integer.\n\n**3. Overlap-Based Candidate Label ($N_{\\text{cm, S}}$)**\nThis label is determined by identifying the most probable CM component among $\\{0, 1, 2\\}$ using the probabilities estimated in Step 1.\n$$\nN_{\\text{cm, S}} = \\underset{i \\in \\{0, 1, 2\\}}{\\arg\\max} \\, p_i\n$$\nIn case of a tie (i.e., multiple components share the same maximum probability), the ambiguity is resolved by selecting the label $i$ which is closest to the real-valued estimate $\\langle N_{\\text{cm}} \\rangle_{\\text{real}}$.\n\n**4. Discrepancy Resolution and Final Label**\nThe two candidate labels, $N_{\\text{cm, E}}$ and $N_{\\text{cm, S}}$, may differ. A decision rule is required. The energy-based label $N_{\\text{cm, E}}$ is considered reliable if the measured energy $\\langle H_{\\text{cm}} \\rangle$ is consistent with the ideal quantized energy for that label, $E_{N_{\\text{cm, E}}} = (N_{\\text{cm, E}} + 3/2)\\hbar\\Omega$. This consistency is tested against a tolerance window of half-width $\\Delta E = \\epsilon \\hbar\\Omega$, where $\\epsilon$ is a given dimensionless parameter.\n- If $|\\langle H_{\\text{cm}} \\rangle - E_{N_{\\text{cm, E}}}| \\le \\Delta E$, the energy information is deemed trustworthy, and we set the final label $N_{\\text{cm, final}} = N_{\\text{cm, E}}$.\n- Otherwise, the energy expectation value is too far from any single quantized level, suggesting a strongly mixed state where the peak of the probability distribution (probed by the overlaps) is a more reliable indicator. We therefore set $N_{\\text{cm, final}} = N_{\\text{cm, S}}$.\n\n**5. Filtering**\nThe final step is to apply the filter to the spectrum. A state is considered \"non-spurious\" or \"clean\" if its assigned CM label is $0$ and its CM ground state component is sufficiently large. A state with intrinsic energy $E_{\\text{intr}}$ is retained if and only if both of the following conditions are met:\n1. $N_{\\text{cm, final}} = 0$\n2. $p_0 \\ge p_{0, \\min}$\nwhere $p_{0,\\min}$ is a specified minimum threshold for the $N_{\\text{cm}}=0$ probability.\n\nThis comprehensive procedure allows for a robust, automated classification and filtering of states, effectively cleaning the theoretical spectrum of spurious center-of-mass motion.", "answer": "```python\nimport numpy as np\nimport math\n\ndef solve():\n    \"\"\"\n    Solves the center-of-mass contamination removal problem for a given test suite.\n    \"\"\"\n    test_cases = [\n        {\n            \"hbar_omega\": 16.0,\n            \"epsilon\": 0.2,\n            \"p0_min\": 0.6,\n            \"states\": [\n                (0.6, 24.1, 0.03, 0.01),\n                (2.1, 40.2, 0.85, 0.05),\n                (1.5, 33.0, 0.45, 0.10),\n            ],\n        },\n        {\n            \"hbar_omega\": 20.0,\n            \"epsilon\": 0.1,\n            \"p0_min\": 0.7,\n            \"states\": [\n                (0.8, 31.0, 0.20, 0.02),\n                (1.1, 50.5, 0.60, 0.10),\n                (1.3, 40.0, 0.35, 0.20),\n            ],\n        },\n        {\n            \"hbar_omega\": 12.0,\n            \"epsilon\": 0.15,\n            \"p0_min\": 0.5,\n            \"states\": [\n                (2.5, 30.0, 0.70, 0.50),\n                (0.4, 18.4, 0.12, 0.03),\n                (1.9, 24.0, 0.40, 0.10),\n            ],\n        },\n        {\n            \"hbar_omega\": 10.0,\n            \"epsilon\": 0.25,\n            \"p0_min\": 0.8,\n            \"states\": [\n                (0.9, 17.0, 0.15, 0.00),\n                (0.7, 15.0, 0.18, 0.02),\n                (2.2, 35.0, 0.30, 0.55),\n            ],\n        },\n    ]\n\n    all_results = []\n    \n    for case in test_cases:\n        hbar_omega = case[\"hbar_omega\"]\n        epsilon = case[\"epsilon\"]\n        p0_min = case[\"p0_min\"]\n        \n        retained_energies = []\n        \n        for state_data in case[\"states\"]:\n            e_intr, h_cm_exp, s1_in, s2_in = state_data\n            \n            # 1. Process Probabilities\n            p0, p1, p2 = 0.0, 0.0, 0.0\n            if s1_in + s2_in > 1.0:\n                norm = s1_in + s2_in\n                p0 = 0.0\n                p1 = s1_in / norm\n                p2 = s2_in / norm\n            else:\n                p0 = 1.0 - s1_in - s2_in\n                p1 = s1_in\n                p2 = s2_in\n            \n            probs = [p0, p1, p2]\n\n            # 2. Calculate Candidate Labels\n            # Energy-based label\n            n_cm_real = (h_cm_exp / hbar_omega) - 1.5\n            n_cm_e = int(np.round(n_cm_real))\n            \n            # Overlap-based label\n            max_prob = -1.0\n            for p in probs:\n                if p > max_prob:\n                    max_prob = p\n            \n            candidate_indices = [i for i, p in enumerate(probs) if math.isclose(p, max_prob)]\n            \n            if len(candidate_indices) == 1:\n                n_cm_s = candidate_indices[0]\n            else:\n                # Tie-breaking rule\n                n_cm_s = min(candidate_indices, key=lambda i: abs(i - n_cm_real))\n\n            # 3. Resolve Discrepancy and Get Final Label\n            e_ideal = (n_cm_e + 1.5) * hbar_omega\n            delta_e = epsilon * hbar_omega\n            \n            n_cm_final = 0\n            if abs(h_cm_exp - e_ideal) = delta_e:\n                n_cm_final = n_cm_e\n            else:\n                n_cm_final = n_cm_s\n                \n            # 4. Filter\n            if n_cm_final == 0 and p0 >= p0_min:\n                retained_energies.append(e_intr)\n                \n        all_results.append(retained_energies)\n\n    # Format the final output string\n    formatted_results = []\n    for res_list in all_results:\n        if not res_list:\n            formatted_results.append('[]')\n        else:\n            # Format numbers to three decimal places\n            formatted_numbers = [f'{x:.3f}' for x in res_list]\n            formatted_results.append(f'[{\",\".join(formatted_numbers)}]')\n            \n    final_output_string = f\"[{','.join(formatted_results)}]\"\n    print(final_output_string)\n\nsolve()\n```", "id": "3548911"}]}