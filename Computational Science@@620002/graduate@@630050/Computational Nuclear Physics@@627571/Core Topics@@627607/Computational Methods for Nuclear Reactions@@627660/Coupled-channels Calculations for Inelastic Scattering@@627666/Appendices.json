{"hands_on_practices": [{"introduction": "Before solving any complex system of equations, we must first understand its structure. In coupled-channels theory, this means identifying which quantum states can \"talk\" to each other through the nuclear interaction. This exercise ([@problem_id:3553022]) is a foundational practice in applying the conservation of total angular momentum and parity to determine the allowed reaction pathways, a critical skill for setting up any realistic scattering calculation.", "problem": "In the coupled-channels (CC) description of inelastic nuclear scattering, channels are labeled by the projectile orbital angular momentum $l$, the projectile intrinsic spin $s$, the target spin $I$, and the total angular momentum $J$ obtained by angular momentum coupling. Consider a spin-$\\frac{1}{2}$ projectile scattering from a spherical even-even target nucleus that has a ground state with $I_{i}=0^{+}$ and a first excited state with $I_{f}=2^{+}$. Assume the dominant incoming orbital angular momentum is $l_{i}=2$. The inelastic excitation of the target $0^{+} \\rightarrow 2^{+}$ is driven by a quadrupole coupling of tensor rank $L=2$ in the interaction, which is rotationally invariant and parity conserving.\n\nStarting only from the following foundational principles:\n- Total angular momentum $J$ and its projection are conserved by a rotationally invariant interaction.\n- Angular momenta add according to the triangle rule: when coupling $j_{1}$ and $j_{2}$, the resultant $j$ satisfies $|j_{1}-j_{2}| \\leq j \\leq j_{1}+j_{2}$ in integer steps.\n- For a parity-conserving coupling of spherical tensor rank $L$, the spatial part contains the spherical harmonic $Y_{L}(\\hat{r})$ of parity $(-1)^{L}$, which implies that the relative-motion orbital angular momentum $l$ can change according to $|l_{i}-L| \\leq l_{f} \\leq l_{i}+L$ and the overall parity selection is enforced.\n\nDetermine the complete set of total angular momenta $J$ that give nonzero inelastic couplings between the elastic channel with $(I_{i}=0^{+},\\, l_{i}=2,\\, s=\\frac{1}{2})$ and the inelastic channel with $(I_{f}=2^{+},\\, l_{f},\\, s=\\frac{1}{2})$ driven by the $L=2$ interaction, under the requirement that $J$ is conserved across the transition. Express your final answer as a row matrix listing the allowed $J$ values in ascending order using the `pmatrix` environment. No rounding is required.", "solution": "The user wants to find the set of total angular momenta $J$ for which a nonzero inelastic coupling exists between specified initial and final channels in a nuclear scattering reaction. The problem is deemed valid as it is a well-posed, scientifically grounded application of quantum mechanical angular momentum coupling rules.\n\nThe core principle for solving this problem is the conservation of total angular momentum $J$. A rotationally invariant interaction, as specified, conserves the total angular momentum and its projection. This means that a nonzero coupling between an initial (elastic) channel and a final (inelastic) channel can only occur if the total angular momentum $J$ can be formed from the constituent angular momenta in *both* the initial and final channels. Therefore, our task is to find the set of possible $J$ values for the initial channel and the set of possible $J$ values for all allowed final channels, and then find the intersection of these two sets.\n\nLet's denote the projectile orbital angular momentum by $l$, projectile intrinsic spin by $s$, and the target spin by $I$. The total angular momentum is $\\vec{J} = \\vec{l} + \\vec{s} + \\vec{I}$. Angular momenta add according to the triangle rule: for $\\vec{j} = \\vec{j}_1 + \\vec{j}_2$, the possible values of the magnitude $j$ are $|j_1 - j_2|, |j_1 - j_2| + 1, \\dots, j_1 + j_2$.\n\n**Step 1: Determine the set of possible total angular momenta $J$ for the initial (elastic) channel.**\n\nThe initial channel is defined by the quantum numbers:\n- Target spin: $I_{i}=0$\n- Projectile orbital angular momentum: $l_{i}=2$\n- Projectile spin: $s=\\frac{1}{2}$\n\nWe need to find the possible values of $J$ resulting from the coupling $\\vec{J} = \\vec{I}_i + \\vec{l}_i + \\vec{s}$.\nSince $I_i=0$, the coupling simplifies to $\\vec{J} = \\vec{l}_i + \\vec{s}$.\nUsing the triangle rule for angular momentum addition with $l_i=2$ and $s=\\frac{1}{2}$:\n$$|l_i - s| \\leq J \\leq l_i + s$$\n$$|2 - \\frac{1}{2}| \\leq J \\leq 2 + \\frac{1}{2}$$\n$$\\frac{3}{2} \\leq J \\leq \\frac{5}{2}$$\nThe possible values for $J$ are half-integer values in this range, which are $J=\\frac{3}{2}$ and $J=\\frac{5}{2}$. Let's denote this set as $J_{\\text{initial}} = \\{\\frac{3}{2}, \\frac{5}{2}\\}$.\n\n**Step 2: Determine the allowed final channel configurations.**\n\nThe final (inelastic) channel is defined by:\n- Target spin: $I_{f}=2$\n- Projectile spin: $s=\\frac{1}{2}$\n- Projectile orbital angular momentum: $l_f$ (to be determined)\n\nThe possible values for the final orbital angular momentum, $l_f$, are constrained by two selection rules originating from the properties of the interaction potential.\n\nFirst, the interaction is a quadrupole coupling of tensor rank $L=2$. This imposes a triangle rule on the change in orbital angular momentum:\n$$|l_i - L| \\leq l_f \\leq l_i + L$$\nSubstituting $l_i=2$ and $L=2$:\n$$|2 - 2| \\leq l_f \\leq 2 + 2$$\n$$0 \\leq l_f \\leq 4$$\nThus, the possible values for $l_f$ are $l_f \\in \\{0, 1, 2, 3, 4\\}$.\n\nSecond, the interaction is parity-conserving. This means the total parity of the final state must be the same as the total parity of the initial state. The parity of a channel state is given by $\\Pi = \\pi_{\\text{target}} \\times (-1)^{l}$, where $\\pi_{\\text{target}}$ is the intrinsic parity of the target state. We assume the projectile has a definite, positive intrinsic parity which does not change.\n\n- Initial state parity: The initial target state is $0^{+}$, so its parity is positive ($\\pi(I_i)=+1$). The orbital angular momentum is $l_i=2$.\n$$\\Pi_i = \\pi(0^{+}) \\times (-1)^{l_i} = (+1) \\times (-1)^{2} = +1$$\n- Final state parity: The final target state is $2^{+}$, so its parity is also positive ($\\pi(I_f)=+1$).\n$$\\Pi_f = \\pi(2^{+}) \\times (-1)^{l_f} = (+1) \\times (-1)^{l_f} = (-1)^{l_f}$$\n\nFor a parity-conserving interaction, we must have $\\Pi_i = \\Pi_f$:\n$$+1 = (-1)^{l_f}$$\nThis equation is satisfied only if $l_f$ is an even integer. Combining this with the condition $l_f \\in \\{0, 1, 2, 3, 4\\}$, the allowed values for the final orbital angular momentum are $l_f \\in \\{0, 2, 4\\}$.\n\n**Step 3: Determine the set of possible total angular momenta $J$ for the allowed final channels.**\n\nWe must find all possible $J$ values that can be formed by coupling $\\vec{J} = \\vec{I}_f + \\vec{l}_f + \\vec{s}$ for each allowed value of $l_f$.\nThe total set of final-channel $J$ values, $J_{\\text{final}}$, will be the union of the sets generated by each $l_f$.\n\n- **Case 1: $l_f=0$**\n  The coupling is $\\vec{J} = \\vec{I}_f + \\vec{s}$, with $I_f=2$ and $s=\\frac{1}{2}$.\n  $$|2 - \\frac{1}{2}| \\leq J \\leq 2 + \\frac{1}{2} \\implies \\frac{3}{2} \\leq J \\leq \\frac{5}{2}$$\n  Possible $J$ values are $J \\in \\{\\frac{3}{2}, \\frac{5}{2}\\}$.\n\n- **Case 2: $l_f=2$**\n  The coupling is $\\vec{J} = \\vec{I}_f + \\vec{l}_f + \\vec{s}$, with $I_f=2$, $l_f=2$, and $s=\\frac{1}{2}$. It is convenient to first couple $\\vec{K} = \\vec{I}_f + \\vec{l}_f$ and then $\\vec{J} = \\vec{K} + \\vec{s}$.\n  For $\\vec{K} = \\vec{2} + \\vec{2}$, the possible values are $K \\in \\{0, 1, 2, 3, 4\\}$.\n  Now, for each $K$, we couple with $s=\\frac{1}{2}$:\n  - $K=0, s=\\frac{1}{2} \\implies J = \\frac{1}{2}$\n  - $K=1, s=\\frac{1}{2} \\implies J = \\{\\frac{1}{2}, \\frac{3}{2}\\}$\n  - $K=2, s=\\frac{1}{2} \\implies J = \\{\\frac{3}{2}, \\frac{5}{2}\\}$\n  - $K=3, s=\\frac{1}{2} \\implies J = \\{\\frac{5}{2}, \\frac{7}{2}\\}$\n  - $K=4, s=\\frac{1}{2} \\implies J = \\{\\frac{7}{2}, \\frac{9}{2}\\}$\n  The union of these possibilities for $l_f=2$ is $J \\in \\{\\frac{1}{2}, \\frac{3}{2}, \\frac{5}{2}, \\frac{7}{2}, \\frac{9}{2}\\}$.\n\n- **Case 3: $l_f=4$**\n  The coupling is $\\vec{J} = \\vec{I}_f + \\vec{l}_f + \\vec{s}$, with $I_f=2$, $l_f=4$, and $s=\\frac{1}{2}$. Again, couple $\\vec{K} = \\vec{I}_f + \\vec{l}_f$.\n  For $\\vec{K} = \\vec{2} + \\vec{4}$, the possible values are $K \\in \\{2, 3, 4, 5, 6\\}$.\n  Now, for each $K$, we couple with $s=\\frac{1}{2}$:\n  - $K=2, s=\\frac{1}{2} \\implies J = \\{\\frac{3}{2}, \\frac{5}{2}\\}$\n  - $K=3, s=\\frac{1}{2} \\implies J = \\{\\frac{5}{2}, \\frac{7}{2}\\}$\n  - $K=4, s=\\frac{1}{2} \\implies J = \\{\\frac{7}{2}, \\frac{9}{2}\\}$\n  - $K=5, s=\\frac{1}{2} \\implies J = \\{\\frac{9}{2}, \\frac{11}{2}\\}$\n  - $K=6, s=\\frac{1}{2} \\implies J = \\{\\frac{11}{2}, \\frac{13}{2}\\}$\n  The union of these possibilities for $l_f=4$ is $J \\in \\{\\frac{3}{2}, \\frac{5}{2}, \\frac{7}{2}, \\frac{9}{2}, \\frac{11}{2}, \\frac{13}{2}\\}$.\n\nThe complete set of possible $J$ values for the final channels is the union of the sets from all three cases:\n$$J_{\\text{final}} = \\{\\frac{3}{2}, \\frac{5}{2}\\} \\cup \\{\\frac{1}{2}, \\frac{3}{2}, \\frac{5}{2}, \\frac{7}{2}, \\frac{9}{2}\\} \\cup \\{\\frac{3}{2}, \\frac{5}{2}, \\frac{7}{2}, \\frac{9}{2}, \\frac{11}{2}, \\frac{13}{2}\\}$$\n$$J_{\\text{final}} = \\{\\frac{1}{2}, \\frac{3}{2}, \\frac{5}{2}, \\frac{7}{2}, \\frac{9}{2}, \\frac{11}{2}, \\frac{13}{2}\\}$$\n\n**Step 4: Find the set of total angular momenta $J$ that allow for a nonzero coupling.**\n\nAs established, a nonzero coupling exists only for values of $J$ that are common to both the initial and final channel configurations. This corresponds to the intersection of the sets $J_{\\text{initial}}$ and $J_{\\text{final}}$.\n$$J_{\\text{allowed}} = J_{\\text{initial}} \\cap J_{\\text{final}}$$\n$$J_{\\text{allowed}} = \\{\\frac{3}{2}, \\frac{5}{2}\\} \\cap \\{\\frac{1}{2}, \\frac{3}{2}, \\frac{5}{2}, \\frac{7}{2}, \\frac{9}{2}, \\frac{11}{2}, \\frac{13}{2}\\}$$\nThe common elements are $\\frac{3}{2}$ and $\\frac{5}{2}$.\n$$J_{\\text{allowed}} = \\{\\frac{3}{2}, \\frac{5}{2}\\}$$\n\nTherefore, the complete set of total angular momenta $J$ that give nonzero inelastic couplings between the given channels is $\\{\\frac{3}{2}, \\frac{5}{2}\\}$.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{3}{2}  \\frac{5}{2}\n\\end{pmatrix}\n}\n$$", "id": "3553022"}, {"introduction": "Moving from theory to practice, this exercise ([@problem_id:3552990]) challenges you to build a numerical solver for the coupled-channels equations from scratch. By implementing both a straightforward finite-difference method and a more sophisticated spectral element method for a simplified model, you will directly experience the trade-offs between different algorithms. This hands-on coding task is central to computational physics, turning abstract differential equations into concrete, predictive power.", "problem": "Consider radial coupled-channels inelastic scattering in the s-wave sector, modeled by a two-channel radial Schrödinger equation in units where $\\hbar^2/(2\\mu)=1$. The coupled equation for the channel vector $u(r) = \\begin{pmatrix} u_1(r) \\\\ u_2(r) \\end{pmatrix}$ is\n$$\n- \\frac{d^2}{dr^2} u(r) + V(r)\\,u(r) = k^2\\,u(r),\n$$\nwith an energy parameter $k$ satisfying $k  0$. Let the matrix potential be a square well of radius $a  0$,\n$$\nV(r) = \\begin{cases}\nV_0\\,\\mathbb{I} + w\\,\\sigma_x,  0 \\le r  a,\\\\\n0,  r \\ge a,\n\\end{cases}\n$$\nwhere $\\sigma_x = \\begin{pmatrix}0  1\\\\ 1  0\\end{pmatrix}$, $\\mathbb{I}$ is the identity matrix, $V_0$ is a real constant (well depth, can be negative), and $w$ is a real constant (coupling strength). In the diagonal basis that diagonalizes $\\sigma_x$, the system decouples inside the well into two scalar s-wave equations\n$$\n- \\frac{d^2}{dr^2} u_{\\pm}(r) + V_{\\pm}\\,u_{\\pm}(r) = k^2\\,u_{\\pm}(r), \\quad V_{\\pm} = V_0 \\pm w,\n$$\nwith regular boundary conditions at the origin, namely $u_{\\pm}(0) = 0$ and $u_{\\pm}'(0) = 1$ (a convenient normalization that fixes the scale of the regular solution). Outside the well, for $r \\ge a$, the potential is zero and each channel obeys the free s-wave equation. For each decoupled channel, define $q_{\\pm}^2 = k^2 - V_{\\pm}$, and take $q_{\\pm}  0$ (scattering in the interior).\n\nFundamental base for the derivation:\n- The radial s-wave Schrödinger equation and its boundary conditions at the origin ($u(0)=0$; regular solution behaves as $u(r)\\sim r$ near $r=0$).\n- For $r \\ge a$ (where $V(r)=0$), the exterior s-wave solution is a linear combination of free solutions, from which the phase shift $\\delta$ can be extracted by matching the interior solution at $r=a$ using the logarithmic derivative $L(a) = u'(a)/u(a)$.\n- The scattering matrix (also called the scattering operator) $S$ for two channels is unitary and, in the basis that diagonalizes the interior coupling, equals $\\mathrm{diag}(e^{2 i \\delta_+}, e^{2 i \\delta_-})$; transforming back to the original channel basis by the orthogonal matrix $U$ that diagonalizes $V(r)$ inside the well produces off-diagonal elements that represent inelastic scattering amplitudes.\n\nTasks:\n1. Starting from the above, derive the phase shift formula in terms of the interior logarithmic derivative for a single s-wave channel at energy $k$: specifically, for $r=a$, express $\\delta$ as a function of $k$, $a$, and $L(a)=u'(a)/u(a)$. All angles must be in radians.\n2. Implement two numerical discretization methods to compute $L_{\\pm}(a)$ for the decoupled scalar equations with constant interior potentials $V_{\\pm}$:\n   - A spectral element collocation method on $[0,a]$ using piecewise Lagrange polynomials at Chebyshev-Gauss-Lobatto nodes. Partition $[0,a]$ into $M$ elements of equal size. On each element, use polynomial degree $p$ with Chebyshev-Gauss-Lobatto nodes and assemble global first- and second-derivative operators with $C^0$ continuity by averaging interface-node contributions. Enforce the boundary conditions $u(0)=0$ and $u'(0)=1$ by replacing two rows in the global algebraic system. Solve the collocation system for $u(r)$ and estimate the logarithmic derivative at $r=a$ using the assembled global first-derivative operator.\n   - A finite-difference marching scheme on a uniform grid with $N_{\\text{steps}}$ steps, spacing $h=a/N_{\\text{steps}}$, using the second-order recurrence derived from the discretized equation $u''(r) + q^2 u(r)=0$ and the initial conditions $u(0)=0$ and $u(h)\\approx h$ consistent with $u'(0)=1$. Estimate $u'(a)$ using a second-order one-sided derivative formula and compute $L(a)$.\n3. From the two phase shifts $\\delta_{\\pm}$, construct the $2\\times 2$ scattering matrix in the original channel basis where the interior coupling is $V_0\\,\\mathbb{I}+w\\,\\sigma_x$. Use the unitary orthogonal matrix $U$ that diagonalizes $\\sigma_x$ to transform $\\mathrm{diag}(e^{2 i \\delta_+}, e^{2 i \\delta_-})$ back to the original basis. Extract the magnitude of the off-diagonal element $\\lvert S_{12} \\rvert$ as a measure of inelastic mixing.\n4. For each test case below, compute the absolute error in $\\lvert S_{12} \\rvert$ for both methods by comparing against the exact analytic reference obtained by solving the constant-potential interior equation exactly. Then compute the ratio $\\text{error}_{\\text{SE}}/\\text{error}_{\\text{FD}}$, where $\\text{SE}$ denotes spectral element and $\\text{FD}$ denotes finite difference. The final outputs are dimensionless floats.\n\nPhase shift extraction rule:\n- Let $u(r)$ be the interior regular solution up to $r=a$, and let $L(a)=u'(a)/u(a)$. The exterior free s-wave solution at the same energy is equivalent to a sine with phase shift. Derive and use the relation $\\delta = \\arctan\\!\\left(\\frac{k}{L(a)}\\right) - k\\,a$.\n\nExact reference for validation:\n- For constant interior $q0$, the exact interior regular solution with $u(0)=0$, $u'(0)=1$ is $u(r) = \\frac{1}{q}\\sin(q r)$. Hence $L_{\\text{exact}}(a) = \\frac{u'(a)}{u(a)} = q\\,\\cot(q a)$, and the exact phase shift is $\\delta_{\\text{exact}} = \\arctan\\!\\left(\\frac{k}{q\\,\\cot(q a)}\\right) - k\\,a$.\n\nConstructing the coupled-channels scattering matrix:\n- Use the orthogonal matrix $U = \\frac{1}{\\sqrt{2}}\\begin{pmatrix}1  1\\\\ 1  -1\\end{pmatrix}$, so that in the original basis $S = U \\,\\mathrm{diag}(e^{2 i \\delta_+}, e^{2 i \\delta_-})\\, U^{\\top}$.\n\nTest suite and required outputs:\n- Use the following scientifically consistent test cases with all angles in radians and no physical units needed beyond the dimensionless system above. Each test case is a tuple $(a, k, V_0, w, M, p, N_{\\text{steps}})$:\n  1. $(2.0, 2.0, -5.0, 1.0, 4, 6, 20)$\n  2. $(2.0, 2.0, -5.0, 1.0, 1, 3, 2)$\n  3. $(2.0, 2.0, -5.0, 1.0, 8, 8, 56)$\n  4. $(1.5, 2.0, -1.0, 0.615, 4, 6, 20)$\n- For each case, compute the ratio $\\text{error}_{\\text{SE}}/\\text{error}_{\\text{FD}}$ in $\\lvert S_{12} \\rvert$, where the error is the absolute difference from the exact $\\lvert S_{12} \\rvert$ obtained via the analytic interior solution. The final output must be a single line containing a comma-separated list of these four ratios enclosed in square brackets, for example, $[r_1,r_2,r_3,r_4]$.\n\nYour program must be a complete, runnable Python script that implements the spectral element collocation method (with Chebyshev-Gauss-Lobatto nodes and global assembly with $C^0$ continuity by averaging interface-node contributions) and the finite-difference marching scheme as described, constructs the coupled-channels scattering matrix from the computed phase shifts, evaluates the exact reference, and prints the final ratios for the test suite in the exact format specified above. All angles must be handled in radians, and all outputs are dimensionless floats.", "solution": "The problem requires the calculation of an inelastic scattering matrix element, $\\lvert S_{12} \\rvert$, for a two-channel system described by a radial Schrödinger equation with a square-well potential. The calculation is to be performed using two distinct numerical methods—a finite-difference (FD) scheme and a spectral element (SE) method—and the results compared against an exact analytical solution to determine the ratio of their absolute errors.\n\nThe governing equation for the two-channel wave function vector $u(r) = \\begin{pmatrix} u_1(r) \\\\ u_2(r) \\end{pmatrix}$ is:\n$$\n- \\frac{d^2}{dr^2} u(r) + V(r)\\,u(r) = k^2\\,u(r)\n$$\nThe potential $V(r)$ is a matrix potential defined over $r \\in [0, \\infty)$. Inside a radius $a$, the potential is $V(r) = V_0\\,\\mathbb{I} + w\\,\\sigma_x$ for $0 \\le r  a$, and zero otherwise. The matrix $\\sigma_x = \\begin{pmatrix}0  1\\\\ 1  0\\end{pmatrix}$ couples the channels. By transforming to the basis that diagonalizes $\\sigma_x$ using the orthogonal matrix $U = \\frac{1}{\\sqrt{2}}\\begin{pmatrix}1  1\\\\ 1  -1\\end{pmatrix}$, the system decouples into two independent scalar Schrödinger equations for the eigen-wavefunctions $u_{\\pm}(r)$:\n$$\n- \\frac{d^2}{dr^2} u_{\\pm}(r) + V_{\\pm}\\,u_{\\pm}(r) = k^2\\,u_{\\pm}(r), \\quad\\text{for } 0 \\le r  a\n$$\nThe corresponding scalar potentials are the eigenvalues of the potential matrix, $V_{\\pm} = V_0 \\pm w$. The problem specifies scattering states, so we define an interior wave number $q_{\\pm} = \\sqrt{k^2 - V_{\\pm}}$ which is real and positive. The equations for $r  a$ become:\n$$\n\\frac{d^2}{dr^2} u_{\\pm}(r) + q_{\\pm}^2 u_{\\pm}(r) = 0\n$$\nThe solution must be regular at the origin, which for the s-wave ($l=0$) case implies $u_{\\pm}(0)=0$. The problem specifies a normalization $u_{\\pm}'(0)=1$.\n\nThe solution involves several steps: computing the logarithmic derivative $L_{\\pm}(a) = u_{\\pm}'(a)/u_{\\pm}(a)$ for each channel, extracting the phase shifts $\\delta_{\\pm}$, constructing the scattering matrix $S$, and finally calculating the desired error ratio.\n\n### Step 1: Phase Shift and Scattering Matrix\nFor each decoupled channel ($\\pm$), the solution for $r \\ge a$ is a free spherical wave, $u_{\\text{ext}}(r) \\propto \\sin(kr + \\delta)$. The phase shift $\\delta$ is determined by matching the interior and exterior solutions at the boundary $r=a$ via the logarithmic derivative. As given in the problem, the phase shift $\\delta$ can be calculated from the logarithmic derivative $L(a)$ at the matching radius $a$ using the formula:\n$$\n\\delta = \\arctan\\left(\\frac{k}{L(a)}\\right) - k\\,a\n$$\nOnce the two phase shifts, $\\delta_+$ and $\\delta_-$, are found, the scattering matrix in the diagonal basis is $S_{\\text{diag}} = \\mathrm{diag}(e^{2i\\delta_+}, e^{2i\\delta_-})$. We transform back to the original channel basis using the matrix $U$:\n$$\nS = U S_{\\text{diag}} U^{\\top} = \\frac{1}{2}\\begin{pmatrix}1  1\\\\ 1  -1\\end{pmatrix} \\begin{pmatrix}e^{2i\\delta_+}  0\\\\ 0  e^{2i\\delta_-}\\end{pmatrix} \\begin{pmatrix}1  1\\\\ 1  -1\\end{pmatrix} = \\frac{1}{2}\\begin{pmatrix}e^{2i\\delta_+} + e^{2i\\delta_-}  e^{2i\\delta_+} - e^{2i\\delta_-}\\\\ e^{2i\\delta_+} - e^{2i\\delta_-}  e^{2i\\delta_+} + e^{2i\\delta_-}\\end{pmatrix}\n$$\nThe off-diagonal element $S_{12}$ represents the inelastic scattering amplitude. Its magnitude is:\n$$\n\\lvert S_{12} \\rvert = \\left\\lvert \\frac{e^{2i\\delta_+} - e^{2i\\delta_-}}{2} \\right\\rvert = \\lvert \\sin(\\delta_+ - \\delta_-) \\rvert\n$$\nThis simplified formula will be used for all calculations of $\\lvert S_{12} \\rvert$.\n\n### Step 2: Exact Analytical Solution (Reference)\nFor the constant potential $V_{\\pm}$, the exact solution to $u_{\\pm}''(r) + q_{\\pm}^2 u_{\\pm}(r) = 0$ with boundary conditions $u_{\\pm}(0)=0$ and $u_{\\pm}'(0)=1$ is:\n$$\nu_{\\pm}(r) = \\frac{1}{q_{\\pm}}\\sin(q_{\\pm} r)\n$$\nThe corresponding first derivative is $u_{\\pm}'(r) = \\cos(q_{\\pm} r)$. The exact logarithmic derivative at $r=a$ is:\n$$\nL_{\\text{exact},\\pm}(a) = \\frac{u_{\\pm}'(a)}{u_{\\pm}(a)} = q_{\\pm}\\cot(q_{\\pm} a)\n$$\nUsing this, we compute the exact phase shifts $\\delta_{\\text{exact},\\pm}$ and the exact value $\\lvert S_{12, \\text{exact}} \\rvert = \\lvert\\sin(\\delta_{\\text{exact},+} - \\delta_{\\text{exact},-})\\rvert$.\n\n### Step 3: Finite-Difference Method (FD)\nThe FD method solves $u''(r) = -q^2 u(r)$ on a uniform grid $r_i = i \\cdot h$ for $i=0, \\dots, N_{\\text{steps}}$, where $h=a/N_{\\text{steps}}$. We use a second-order central difference approximation for the second derivative:\n$$\n\\frac{u_{i+1} - 2u_i + u_{i-1}}{h^2} = -q^2 u_i\n$$\nThis yields the marching recurrence relation:\n$$\nu_{i+1} = (2 - (qh)^2)u_i - u_{i-1}\n$$\nThe initial conditions are set as $u_0 = u(0) = 0$ and $u_1 = u(h) \\approx h u'(0) = h$. The recurrence is applied for $i=1, \\dots, N_{\\text{steps}}-1$ to find the solution up to $u_{N_{\\text{steps}}}=u(a)$.\nThe derivative at $r=a$ is estimated using a one-sided, second-order finite-difference formula:\n$$\nu'(a) = u'(r_{N_{\\text{steps}}}) \\approx \\frac{3u_{N_{\\text{steps}}} - 4u_{N_{\\text{steps}}-1} + u_{N_{\\text{steps}}-2}}{2h}\n$$\nFrom $u(a)$ and $u'(a)$, we compute $L_{\\text{FD}}(a)$ and subsequently $\\delta_{\\text{FD}}$ and $\\lvert S_{12, \\text{FD}} \\rvert$.\n\n### Step 4: Spectral Element Method (SE)\nThe SE method provides a high-order approximation. The domain $[0, a]$ is partitioned into $M$ elements, each of size $h_{\\text{el}} = a/M$. Within each element $[z_m, z_{m+1}]$, the solution is approximated by a polynomial of degree $p$ on a set of Chebyshev-Gauss-Lobatto (CGL) nodes.\nThe CGL nodes on the reference interval $\\xi \\in [-1, 1]$ are $\\xi_j = \\cos(j\\pi/p)$ for $j=0, \\dots, p$. These are mapped to each physical element. The total number of unique global nodes is $M \\cdot p + 1$.\n\nThe core of the method is the construction of global differentiation matrices $\\mathbf{D}^{(1)}$ and $\\mathbf{D}^{(2)}$ that act on the vector of function values at the global nodes. These are assembled from element-level differentiation matrices. For a reference element, the standard Chebyshev differentiation matrix $\\mathbf{D}_{\\text{cheb}}$ is computed. For a physical element, this is scaled by the Jacobian of the transformation: $\\mathbf{D}_{\\text{el}}^{(1)} = (2/h_{\\text{el}})\\mathbf{D}_{\\text{cheb}}$ and $\\mathbf{D}_{\\text{el}}^{(2)} = (2/h_{\\text{el}})^2\\mathbf{D}_{\\text{cheb}}^2$.\n\nGlobal matrices are assembled by summing the contributions from each element (direct stiffness summation). As specified, $C^0$ continuity is enforced by averaging the contributions at the interface nodes. This is achieved by summing all element matrix contributions into the global matrices and then dividing the rows corresponding to interface nodes (nodes shared by two elements) by $2$.\n\nThe differential equation $-u'' - q^2 u = 0$ is transformed into a global algebraic system:\n$$\n(-\\mathbf{D}^{(2)} - q^2\\mathbf{I})\\mathbf{u} = \\mathbf{0}\n$$\nwhere $\\mathbf{u}$ is the vector of unknown function values at the global nodes. This system is modified to incorporate the boundary conditions:\n1. $u(0)=0$: The first equation (row $0$) is replaced by $u_0 = 0$.\n2. $u'(0)=1$: The second equation (row $1$) is replaced by the derivative condition, $\\sum_j \\mathbf{D}^{(1)}_{0j} u_j = 1$.\n\nThe resulting linear system $\\mathbf{A}\\mathbf{u} = \\mathbf{b}$ is solved for $\\mathbf{u}$. The logarithmic derivative is then computed using the solution vector and the global first-derivative operator:\n$$\nL_{\\text{SE}}(a) = \\frac{u'(a)}{u(a)} = \\frac{(\\mathbf{D}^{(1)}\\mathbf{u})_{N_{\\text{glob}}-1}}{u_{N_{\\text{glob}}-1}}\n$$\nFrom this, we compute $\\delta_{\\text{SE}}$ and $\\lvert S_{12, \\text{SE}} \\rvert$.\n\n### Step 5: Final Calculation\nFor each test case, we compute the physical parameters $q_{\\pm}$ and then calculate $\\lvert S_{12} \\rvert$ using the exact, FD, and SE methods. The absolute errors are found:\n$$\n\\text{error}_{\\text{SE}} = \\lvert \\lvert S_{12, \\text{SE}} \\rvert - \\lvert S_{12, \\text{exact}} \\rvert \\rvert\n$$\n$$\n\\text{error}_{\\text{FD}} = \\lvert \\lvert S_{12, \\text{FD}} \\rvert - \\lvert S_{12, \\text{exact}} \\rvert \\rvert\n$$\nFinally, the required ratio $\\text{error}_{\\text{SE}} / \\text{error}_{\\text{FD}}$ is computed.", "answer": "```python\nimport numpy as np\nfrom scipy import linalg\n\ndef chebyshev_diff_matrices(p):\n    \"\"\"\n    Computes the Chebyshev differentiation matrices D1 and D2 on CGL nodes.\n    \n    Args:\n        p (int): Polynomial degree.\n        \n    Returns:\n        tuple: (D1, D2, nodes) where D1 is the first-derivative matrix,\n               D2 is the second-derivative matrix, and nodes are the CGL nodes.\n    \"\"\"\n    if p == 0:\n        return np.array([[0.]]), np.array([[0.]]), np.array([0.])\n    \n    nodes = np.cos(np.pi * np.arange(p + 1) / p)\n    D1 = np.zeros((p + 1, p + 1))\n    c = np.ones(p + 1)\n    c[0] = 2.\n    c[p] = 2.\n    \n    for i in range(p + 1):\n        for j in range(p + 1):\n            if i == j:\n                if i == 0:\n                    D1[i, j] = (2 * p**2 + 1) / 6.\n                elif i == p:\n                    D1[i, j] = -(2 * p**2 + 1) / 6.\n                else:\n                    D1[i, j] = -nodes[j] / (2 * (1 - nodes[j]**2))\n            else:\n                D1[i, j] = (c[i] / c[j]) * ((-1)**(i + j)) / (nodes[i] - nodes[j])\n                \n    D2 = np.dot(D1, D1)\n    return D1, D2, nodes\n\ndef get_phase_shift(k, a, L):\n    \"\"\"\n    Calculates the phase shift from the logarithmic derivative.\n    delta = arctan(k/L(a)) - k*a\n    \"\"\"\n    # handle k/L singularity\n    if np.isclose(L, 0):\n        # Taking principal value_ assuming k  0\n        return (np.pi / 2) * np.sign(k) - k * a\n    return np.arctan(k / L) - k * a\n\ndef calculate_s12_mag(delta_plus, delta_minus):\n    \"\"\"\n    Calculates the magnitude of the off-diagonal S-matrix element.\n    |S12| = |sin(delta_plus - delta_minus)|\n    \"\"\"\n    return np.abs(np.sin(delta_plus - delta_minus))\n\ndef solve_channel(params, M, p, N_steps):\n    \"\"\"\n    Solves for one channel using all three methods: Exact, FD, SE.\n    \"\"\"\n    q, k, a = params['q'], params['k'], params['a']\n    \n    # 1. Exact Analytical Method\n    qa = q * a\n    if np.isclose(np.sin(qa), 0):\n        L_exact = 1e30  # Effectively infinite for u(a)=0\n    else:\n        L_exact = q * np.cos(qa) / np.sin(qa)\n    delta_exact = get_phase_shift(k, a, L_exact)\n\n    # 2. Finite-Difference Method\n    h = a / N_steps\n    u_fd = np.zeros(N_steps + 1)\n    if N_steps  0:\n        u_fd[1] = h  # u(h) approx h*u'(0)\n    \n    if N_steps  1:\n        C = 2.0 - (q * h)**2\n        for i in range(1, N_steps):\n            u_fd[i+1] = C * u_fd[i] - u_fd[i-1]\n    \n        u_prime_a = (3 * u_fd[N_steps] - 4 * u_fd[N_steps-1] + u_fd[N_steps-2]) / (2 * h)\n        \n        if np.isclose(u_fd[N_steps], 0):\n            L_fd = 1e30\n        else:\n            L_fd = u_prime_a / u_fd[N_steps]\n    else: # Cannot use 3-point formula, result will be poor.\n        L_fd = np.nan\n\n    delta_fd = get_phase_shift(k, a, L_fd) if not np.isnan(L_fd) else np.nan\n\n    # 3. Spectral Element Method\n    D_cheb, D2_cheb, _ = chebyshev_diff_matrices(p)\n    \n    N_glob = M * p + 1\n    D1_glob = np.zeros((N_glob, N_glob))\n    D2_glob = np.zeros((N_glob, N_glob))\n    h_elem = a / M\n    \n    # Assembly via direct stiffness summation\n    for m in range(M):\n        D1_elem = (2 / h_elem) * D_cheb\n        D2_elem = (2 / h_elem)**2 * D2_cheb\n        g_idx = np.arange(m*p, m*p + p + 1)\n        D1_glob[np.ix_(g_idx, g_idx)] += D1_elem\n        D2_glob[np.ix_(g_idx, g_idx)] += D2_elem\n    \n    # Average contributions at element interfaces\n    for m in range(1, M):\n        interface_idx = m * p\n        D1_glob[interface_idx, :] /= 2.0\n        D2_glob[interface_idx, :] /= 2.0\n    \n    A = -D2_glob - (q**2) * np.identity(N_glob)\n    b = np.zeros(N_glob)\n    \n    # Enforce boundary conditions u(0)=0, u'(0)=1\n    A[0, :] = 0.0\n    A[0, 0] = 1.0\n    b[0] = 0.0\n    \n    # Replace eq at node 1 with u'(0)=1. D1_glob[0,:] is the operator for u'(0).\n    A[1, :] = D1_glob[0, :]\n    b[1] = 1.0\n    \n    try:\n        u_se = linalg.solve(A, b, assume_a='gen')\n        u_a = u_se[-1]\n        u_prime_a = D1_glob[-1, :] @ u_se\n        \n        if np.isclose(u_a, 0):\n            L_se = 1e30\n        else:\n            L_se = u_prime_a / u_a\n        \n        delta_se = get_phase_shift(k, a, L_se)\n    except linalg.LinAlgError:\n        delta_se = np.nan\n\n    return delta_exact, delta_fd, delta_se\n\ndef run_case(a, k, V0, w, M, p, N_steps):\n    \"\"\"\n    Runs a single test case and computes the error ratio.\n    \"\"\"\n    V_plus = V0 + w\n    V_minus = V0 - w\n    q_plus_sq = k**2 - V_plus\n    q_minus_sq = k**2 - V_minus\n\n    if q_plus_sq = 0 or q_minus_sq = 0:\n        return np.nan\n\n    q_plus = np.sqrt(q_plus_sq)\n    q_minus = np.sqrt(q_minus_sq)\n\n    params_plus = {'q': q_plus, 'k': k, 'a': a}\n    params_minus = {'q': q_minus, 'k': k, 'a': a}\n    \n    delta_exact_p, delta_fd_p, delta_se_p = solve_channel(params_plus, M, p, N_steps)\n    delta_exact_m, delta_fd_m, delta_se_m = solve_channel(params_minus, M, p, N_steps)\n    \n    # Check for failures in numerical methods\n    if any(np.isnan([delta_fd_p, delta_se_p, delta_fd_m, delta_se_m])):\n        return np.nan\n\n    S12_exact = calculate_s12_mag(delta_exact_p, delta_exact_m)\n    S12_fd = calculate_s12_mag(delta_fd_p, delta_fd_m)\n    S12_se = calculate_s12_mag(delta_se_p, delta_se_m)\n    \n    error_fd = np.abs(S12_fd - S12_exact)\n    error_se = np.abs(S12_se - S12_exact)\n    \n    if np.isclose(error_fd, 0):\n        return np.inf if not np.isclose(error_se, 0) else 1.0\n    \n    return error_se / error_fd\n\ndef solve():\n    \"\"\"\n    Main function to run test suite and print results.\n    \"\"\"\n    test_cases = [\n        # (a, k, V0, w, M, p, N_steps)\n        (2.0, 2.0, -5.0, 1.0, 4, 6, 20),\n        (2.0, 2.0, -5.0, 1.0, 1, 3, 2),\n        (2.0, 2.0, -5.0, 1.0, 8, 8, 56),\n        (1.5, 2.0, -1.0, 0.615, 4, 6, 20)\n    ]\n\n    results = []\n    for case in test_cases:\n        ratio = run_case(*case)\n        results.append(str(ratio))\n\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "3552990"}, {"introduction": "Numerical solvers are not one-size-fits-all; choosing the right tool for the job is a key skill for a computational physicist. This problem ([@problem_id:3552988]) explores the practical consequences of this choice by comparing two workhorse algorithms: direct integration and the R-matrix method. You will analyze why one method might fail catastrophically where another succeeds, particularly when dealing with the subtleties of strongly coupled, energetically closed channels.", "problem": "Consider inelastic scattering described by a set of coupled radial Schrödinger equations for channel wavefunctions $u_{c}(r)$, with channel index $c = 1, \\dots, N_{\\text{ch}}$, reduced mass $\\mu$, and total center-of-mass energy $E$. The coupled-channels equations take the form\n$$\n\\frac{d^{2}}{dr^{2}} u_{c}(r) + \\left[k_{c}^{2} - \\frac{\\ell_{c}(\\ell_{c}+1)}{r^{2}} - \\frac{2\\mu}{\\hbar^{2}} V_{cc}(r)\\right] u_{c}(r) - \\sum_{c' \\neq c} \\frac{2\\mu}{\\hbar^{2}} V_{cc'}(r) u_{c'}(r) = 0,\n$$\nwhere $k_{c}^{2} = \\frac{2\\mu}{\\hbar^{2}}(E - \\epsilon_{c})$ and $\\epsilon_{c}$ is the intrinsic excitation energy of channel $c$. A channel is open if $k_{c}^{2}  0$ and closed if $k_{c}^{2}  0$, in which case define $\\kappa_{c} = \\sqrt{-k_{c}^{2}}$. The couplings $V_{cc'}(r)$ include a short-ranged nuclear part of range $R_{0}$ and a long-ranged Coulomb interaction between charges $Z_{p}e$ and $Z_{t}e$. Assume that inelastic nuclear couplings $V_{cc'}^{\\text{(nucl)}}(r)$ vanish for $r \\gtrsim R_{0}$, while Coulomb couplings are known analytically in the exterior and decay as multipoles with $r$.\n\nTwo numerical strategies are available to compute the scattering $S$-matrix:\n- Direct outward integration of a first-order system (e.g., the log-derivative matrix $Y(r)$) from a small $r$ near the origin to a matching radius $a$, at which the solution is matched to known asymptotic forms in each open and closed channel.\n- An inward-outward $R$-matrix matching approach on a channel radius $a$, in which the interior problem on $0 \\le r \\le a$ is solved once with a Bloch surface term, yielding an $R$-matrix $R(a;E)$, which is then matched to exterior analytic solutions (Coulomb and centrifugal functions) and used to compute the $S$-matrix. The same interior solution can be reused for multiple energies with the same Hamiltonian.\n\nFrom first principles, recall that for a closed channel the two independent local solutions behave as $\\exp(+\\kappa_{c} r)$ and $\\exp(-\\kappa_{c} r)$, and roundoff contamination of the growing solution can be exponentially amplified over propagation distance. Also recall that in the exterior region the open-channel asymptotics are oscillatory Coulomb functions with known analytic forms, and that the numerical cost of coupled propagation per step typically scales with a matrix operation in the channel space.\n\nYou are tasked to choose between the two methods for a calculation with $N_{\\text{ch}}$ channels containing multiple open and closed channels, a matching radius $a$ chosen such that $a \\gtrsim R_{0}$, and a grid of $M$ energies spanning a few mega-electronvolts for fixed optical and coupling potentials. Which of the following statements correctly identify regimes of numerical stability and computational efficiency for each method?\n\nA. Direct outward integration of the log-derivative matrix to $r = a$ is numerically stable and efficient when all channels are open or only weakly closed such that $\\kappa_{\\max} a \\lesssim 1$, the couplings are smooth and short-ranged, and only $\\mathcal{O}(1)$ energies are required. It tends to become ill-conditioned at low energies with many strongly closed channels for which $\\kappa_{\\max} a \\gg 1$, because roundoff-induced admixtures of $\\exp(+\\kappa r)$ can dominate before reaching $r = a$.\n\nB. The inward-outward $R$-matrix approach is especially efficient when $M \\gg 1$ energies are needed for a fixed Hamiltonian, because the interior linear algebra can be performed once to obtain an energy-independent representation of the surface response. It remains numerically stable in the presence of many closed channels provided the channel radius $a$ encompasses the range of significant couplings; choosing $a$ too small, so that appreciable couplings persist beyond $a$, degrades accuracy and stability.\n\nC. In the presence of a long-range Coulomb potential, matching at a finite channel radius $a$ is intrinsically ill-posed, so $R$-matrix matching should be avoided in favor of integrating outward to $r \\to \\infty$ to obtain the $S$-matrix without explicit matching.\n\nD. For the $R$-matrix approach, making the channel radius $a$ as small as possible always improves stability and accuracy by minimizing the interior volume and the size of the basis, irrespective of the radial extent of the couplings.\n\nE. If the optical potential has a strong absorptive (imaginary) component, the $R$-matrix method cannot be formulated because it requires a Hermitian interior Hamiltonian; therefore, direct outward integration is the only viable approach.\n\nSelect all statements that are correct under the stated physical and numerical conditions. Provide your answer by listing the letters of all correct options.", "solution": "The problem asks to evaluate several statements regarding the numerical stability and computational efficiency of two methods for solving coupled-channels Schrödinger equations in the context of nuclear scattering: direct outward integration and the R-matrix method. The physical system involves both short-range nuclear and long-range Coulomb interactions, with multiple open and closed channels.\n\nThe coupled-channels equations are given by:\n$$\n\\frac{d^{2}}{dr^{2}} u_{c}(r) + \\left[k_{c}^{2} - \\frac{\\ell_{c}(\\ell_{c}+1)}{r^{2}} - \\frac{2\\mu}{\\hbar^{2}} V_{cc}(r)\\right] u_{c}(r) - \\sum_{c' \\neq c} \\frac{2\\mu}{\\hbar^{2}} V_{cc'}(r) u_{c'}(r) = 0\n$$\nHere, $k_{c}^{2} = \\frac{2\\mu}{\\hbar^{2}}(E - \\epsilon_{c})$. For a closed channel, $k_{c}^{2}  0$, and the solutions have an asymptotic behavior that is a linear combination of $\\exp(-\\kappa_{c} r)$ and $\\exp(+\\kappa_{c} r)$, where $\\kappa_{c} = \\sqrt{-k_{c}^{2}}$. The physical solution must be asymptotically proportional to the decaying exponential $\\exp(-\\kappa_{c} r)$.\n\nLet's analyze each statement based on these principles.\n\n**Statement A Analysis:**\n\nThis statement concerns the direct outward integration method (a \"shooting\" method), for example, propagating the log-derivative matrix $Y(r)$. Such methods start with a known boundary condition at or near $r=0$ (e.g., $u_c(r) \\sim r^{\\ell_c+1}$) and integrate outwards to a matching radius $r=a$.\n\nIn closed channels, the numerical solution will inevitably contain a small admixture of the unphysical, exponentially growing solution $\\exp(+\\kappa_{c} r)$ due to finite floating-point precision. During the integration over a distance $a$, this component's magnitude relative to the physical solution $\\exp(-\\kappa_{c} r)$ grows by a factor of approximately $\\exp(2\\kappa_{c} a)$. If $\\kappa_{c} a \\gg 1$, this growth can be so large that the unphysical solution completely dominates the numerical result, leading to a loss of precision and numerical instability. This phenomenon is often termed \"stiffness\". The condition $\\kappa_{\\max} a \\lesssim 1$ ensures that this exponential amplification is kept under control, so the method is stable. If all channels are open ($k_c^2  0$), the solutions are oscillatory, and this exponential instability does not occur.\n\nFor efficiency, direct integration must be repeated for each energy $E$. If only a few energies are needed (i.e., $M = \\mathcal{O}(1)$), the total computational cost is manageable. The statement accurately captures these trade-offs: the method is efficient for a small number of energies and stable when channels are open or only weakly closed. It correctly identifies the source of ill-conditioning—the exponential amplification of unphysical solutions in strongly closed channels, which is exacerbated at low energies where $k_c^2$ can be large and negative.\n\nTherefore, the statement is a correct description of the properties of direct outward integration methods.\n\n**Verdict for A: Correct**\n\n**Statement B Analysis:**\n\nThis statement describes the R-matrix method. This method divides the problem into an interior region ($0 \\le r \\le a$) and an exterior region ($r  a$). A 'one-time' computationally intensive task is performed for the interior region, and the results are used to efficiently calculate scattering properties at many energies.\n\nThe efficiency arises because, in many formulations of the R-matrix method (e.g., basis set methods), the interior Hamiltonian (on the interval $[0, a]$ with specific boundary conditions) is energy-independent for an energy-independent potential. Its properties (e.g., eigenvalues and eigenvectors) can be computed once. The energy-dependent R-matrix $R(E)$, which connects the value of the wavefunction to its derivative on the boundary $r=a$, can then be constructed for any energy $E$ via an analytic formula (a sum over poles). This makes the calculation for a large number of energies, $M \\gg 1$, extremely efficient after the initial setup cost.\n\nFor stability, the R-matrix method avoids the long-range propagation that plagues direct integration methods in the presence of strongly closed channels. The interior problem is solved on a fixed, finite domain, which is a boundary value problem, inherently more stable than a shooting method over a long, stiff range.\n\nThe choice of the channel radius $a$ is crucial. The R-matrix formalism relies on the assumption that the interactions in the exterior region ($r  a$) are known and simple enough to have analytic or easily computable solutions. In this problem, the strong nuclear couplings $V_{cc'}^{\\text{(nucl)}}$ are assumed to vanish for $r \\gtrsim R_0$. Thus, $a$ must be chosen such that $a \\gtrsim R_0$ to ensure that only the known long-range Coulomb and centrifugal potentials remain in the exterior. If $a$ is chosen too small, significant unknown or complex nuclear couplings would persist beyond $a$, invalidating the assumptions about the exterior region and leading to large errors in accuracy.\n\nThus, this statement correctly outlines the main advantages of the R-matrix method concerning efficiency and stability, and correctly identifies the constraint on the channel radius $a$.\n\n**Verdict for B: Correct**\n\n**Statement C Analysis:**\n\nThis statement claims that the presence of a long-range Coulomb potential makes matching at a finite radius $a$ ill-posed. This is incorrect. R-matrix theory is specifically designed to handle such situations. The method's core idea is to match an interior numerical solution to a known exterior solution at a boundary $r=a$. When a Coulomb potential is present, the exterior solutions are not free-particle plane waves, but are the regular and irregular Coulomb wave functions, $F_{\\ell}(\\eta, kr)$ and $G_{\\ell}(\\eta, kr)$. These are well-known functions.\n\nThe matching procedure involves solving a system of linear equations to connect the interior R-matrix to the asymptotic S-matrix via the known properties of the exterior solutions (the Coulomb functions). This procedure is well-defined and is a standard component of nuclear reaction codes based on R-matrix theory.\n\nFurthermore, the suggestion to \"integrate outward to $r \\to \\infty$\" is computationally impossible. Any direct integration method must also stop at a finite, but large, radius and match to asymptotic forms to extract the S-matrix. In the presence of a Coulomb potential, these asymptotic forms are precisely the Coulomb wave functions. So, both methods fundamentally rely on matching to known analytic solutions at some finite radius. The R-matrix method simply formalizes this partitioning at a radius $a$ that is computationally convenient and physically justified (i.e., beyond the range of nuclear forces).\n\n**Verdict for C: Incorrect**\n\n**Statement D Analysis:**\n\nThis statement asserts that making the channel radius $a$ as small as possible is always better. This is false and contradicts the correct reasoning in statement B. As established, the channel radius $a$ must be chosen large enough to encompass the region of short-range nuclear interactions ($a \\gtrsim R_0$). If $a$ is chosen too small, the couplings $V_{cc'}(r)$ for $c \\neq c'$ are non-negligible in the exterior region $r  a$. This violates the fundamental assumption of the R-matrix method that the exterior equations are simple and uncoupled (or have a known, simple coupling form). Matching to solutions that do not account for these exterior couplings will result in significant systematic errors, thus degrading accuracy. The statement's claim that this improves accuracy \"irrespective of the radial extent of the couplings\" is fundamentally wrong.\n\n**Verdict for D: Incorrect**\n\n**Statement E Analysis:**\n\nThis statement claims that the R-matrix method requires a Hermitian interior Hamiltonian and thus cannot be used with a complex absorptive optical potential. This is an oversimplification that applies only to the original Wigner-Eisenbud formulation of R-matrix theory. Modern R-matrix methods are not restricted to Hermitian Hamiltonians.\n\nThe R-matrix itself can be defined more generally as the operator (or matrix in channel space) that connects the wavefunction to its derivative at the boundary, without reference to a basis of eigenstates of a Hermitian operator. For a non-Hermitian Hamiltonian (e.g., with a complex optical potential), the R-matrix becomes a complex, non-Hermitian matrix. It can be calculated, for instance, by propagating a solution matrix or log-derivative matrix from $r=0$ to $r=a$ (a \"propagating R-matrix\" method), a procedure that works perfectly well for complex potentials. Alternatively, basis set methods can be used, which involve diagonalizing a complex symmetric (non-Hermitian) matrix.\n\nTherefore, the R-matrix method is perfectly capable of handling complex optical potentials, and it is a standard tool for such problems. The conclusion that direct integration is the \"only viable approach\" is false.\n\n**Verdict for E: Incorrect**\n\n**Summary:**\n\nStatements A and B correctly describe the domains of applicability, numerical stability, and efficiency considerations for direct integration and R-matrix methods, respectively. Statements C, D, and E contain fundamental misconceptions about these numerical techniques, particularly concerning the handling of long-range potentials, the choice of the channel radius, and the applicability to non-Hermitian systems.", "answer": "AB", "id": "3552988"}]}