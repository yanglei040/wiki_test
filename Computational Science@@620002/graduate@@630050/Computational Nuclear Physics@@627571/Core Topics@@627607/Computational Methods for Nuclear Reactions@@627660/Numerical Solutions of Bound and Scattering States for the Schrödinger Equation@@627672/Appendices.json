{"hands_on_practices": [{"introduction": "A powerful strategy for solving the Schrödinger equation numerically is to divide the problem domain based on the range of the potential. This exercise focuses on the crucial interface between the interior region, where the nuclear interaction is active, and the exterior region, where the particle is effectively free. You will derive the analytical condition for smoothly matching the interior and exterior wave functions using the logarithmic derivative, a cornerstone of shooting and R-matrix methods used to find both bound states and scattering phase shifts. [@problem_id:3577805]", "problem": "Consider a nucleon of reduced mass $\\mu$ moving in a spherically symmetric, short-range nuclear potential $V(r)$ such that $V(r)$ is negligible beyond a finite radius $R$. The radial Schrödinger equation for the partial wave with orbital angular momentum $l$ is\n$$\n-\\frac{\\hbar^{2}}{2\\mu}\\frac{d^{2}u_{l}(r)}{dr^{2}}+\\left[V(r)+\\frac{\\hbar^{2}l(l+1)}{2\\mu r^{2}}\\right]u_{l}(r)=E\\,u_{l}(r),\n$$\nwith the regular boundary behavior near the origin $r\\to 0$ given by $u_{l}(r)\\propto r^{l+1}$ and the physical scattering behavior at large radii $r\\to\\infty$ given by an outgoing distorted wave with phase shift $\\delta_{l}(E)$ for energy $E=\\frac{\\hbar^{2}k^{2}}{2\\mu}0$. For $r\\ge R$ where $V(r)\\approx 0$, the exterior solution can be represented as a real standing-wave combination of spherical Bessel functions $j_{l}(kr)$ and $n_{l}(kr)$ consistent with a phase shift $\\delta_{l}(E)$.\n\nYou are to design an interior–exterior matching procedure in which:\n- An interior solution $u_{l}^{\\text{(in)}}(r)$ is obtained by numerical outward integration starting from a small radius $r_{\\epsilon}\\ll R$ using the regular boundary behavior, and\n- An exterior solution $u_{l}^{\\text{(out)}}(r)$ is obtained by numerical inward integration starting from a large radius $r_{\\infty}\\gg R$ using the asymptotic scattering representation.\n\nAt a chosen matching radius $r_{m}\\ge R$, impose that the global physical solution be $C^{1}$ (continuously differentiable) by equating the logarithmic derivative $L(r)\\equiv u_{l}'(r)/u_{l}(r)$ of the inward and outward integrations at $r=r_{m}$. Starting from the radial Schrödinger equation and the large-$r$ scattering form of the solution in terms of $j_{l}$ and $n_{l}$, derive the explicit analytic expression for the exterior-side logarithmic derivative $L(r_{m})$ in terms of $k$, $l$, $\\delta_{l}$, and the functions $j_{l}$, $n_{l}$ and their derivatives evaluated at $kr_{m}$. Your final answer must be a single closed-form analytic expression for $L(r_{m})$; do not introduce numerical values. Express all mathematical quantities in standard mathematical notation, and state the result that is to be matched to the interior computation. No rounding is required and no units should be reported in the final expression.", "solution": "The problem statement has been validated and is found to be scientifically grounded, well-posed, objective, and complete. It describes a standard procedure in computational quantum scattering theory. We may therefore proceed with the derivation.\n\nThe goal is to find the analytical expression for the logarithmic derivative, $L(r_m) \\equiv u_l'(r_m) / u_l(r_m)$, of the exterior radial wave function, $u_l^{\\text{(out)}}(r)$, at a matching radius $r=r_m$. The exterior region is defined by $r \\ge R$, where the nuclear potential $V(r)$ is assumed to be zero. The matching radius $r_m$ is in this region, i.e., $r_m \\ge R$.\n\nIn the exterior region, with $V(r)=0$, the radial Schrödinger equation is:\n$$\n-\\frac{\\hbar^{2}}{2\\mu}\\frac{d^{2}u_{l}(r)}{dr^{2}}+\\frac{\\hbar^{2}l(l+1)}{2\\mu r^{2}}u_{l}(r)=E\\,u_{l}(r)\n$$\nGiven the energy of the scattering state, $E=\\frac{\\hbar^{2}k^{2}}{2\\mu}$, we substitute this into the equation:\n$$\n-\\frac{\\hbar^{2}}{2\\mu}\\frac{d^{2}u_{l}(r)}{dr^{2}}+\\frac{\\hbar^{2}l(l+1)}{2\\mu r^{2}}u_{l}(r)=\\frac{\\hbar^{2}k^{2}}{2\\mu}u_{l}(r)\n$$\nMultiplying through by $-\\frac{2\\mu}{\\hbar^{2}}$ and rearranging terms, we obtain the standard form of the spherical Bessel differential equation:\n$$\n\\frac{d^{2}u_{l}(r)}{dr^{2}} + \\left[k^{2} - \\frac{l(l+1)}{r^{2}}\\right]u_{l}(r) = 0\n$$\nThe general solution to this equation is a linear combination of the spherical Bessel function of the first kind, $j_l(kr)$, and the spherical Bessel function of the second kind (or Neumann function), $n_l(kr)$:\n$$\nu_{l}(r) = A j_{l}(kr) + B n_{l}(kr)\n$$\nwhere $A$ and $B$ are constants.\n\nThe problem states that for large $r$, the solution should represent a scattered wave with a phase shift $\\delta_l(E)$. The asymptotic behavior of the radial wave function is given by:\n$$\nu_{l}(r) \\xrightarrow{r\\to\\infty} C \\sin\\left(kr - \\frac{l\\pi}{2} + \\delta_l\\right)\n$$\nTo match this behavior, we must choose the constants $A$ and $B$ appropriately. We use the known asymptotic forms of the spherical Bessel functions for large argument $\\rho = kr$:\n$$\nj_{l}(\\rho) \\xrightarrow{\\rho\\to\\infty} \\frac{1}{\\rho}\\sin\\left(\\rho - \\frac{l\\pi}{2}\\right)\n$$\n$$\nn_{l}(\\rho) \\xrightarrow{\\rho\\to\\infty} -\\frac{1}{\\rho}\\cos\\left(\\rho - \\frac{l\\pi}{2}\\right)\n$$\nA conventional and convenient choice for the exterior solution $u_l^{\\text{(out)}}(r)$ that incorporates the phase shift $\\delta_l$ is a real standing-wave form:\n$$\nu_{l}^{\\text{(out)}}(r) = C_0 \\left[\\cos(\\delta_l) j_l(kr) - \\sin(\\delta_l) n_l(kr)\\right]\n$$\nwhere $C_0$ is an arbitrary normalization constant. Let us verify its asymptotic form. Substituting the asymptotic expressions for $j_l$ and $n_l$:\n$$\nu_{l}^{\\text{(out)}}(r) \\xrightarrow{r\\to\\infty} C_0 \\left[\\cos(\\delta_l) \\frac{\\sin(kr - \\frac{l\\pi}{2})}{kr} - \\sin(\\delta_l) \\left(-\\frac{\\cos(kr - \\frac{l\\pi}{2})}{kr}\\right)\\right]\n$$\n$$\nu_{l}^{\\text{(out)}}(r) \\xrightarrow{r\\to\\infty} \\frac{C_0}{kr} \\left[\\cos(\\delta_l)\\sin\\left(kr - \\frac{l\\pi}{2}\\right) + \\sin(\\delta_l)\\cos\\left(kr - \\frac{l\\pi}{2}\\right)\\right]\n$$\nUsing the trigonometric identity for the sine of a sum, $\\sin(\\alpha+\\beta) = \\sin\\alpha\\cos\\beta + \\cos\\alpha\\sin\\beta$, we get:\n$$\nu_{l}^{\\text{(out)}}(r) \\xrightarrow{r\\to\\infty} \\frac{C_0}{kr} \\sin\\left(kr - \\frac{l\\pi}{2} + \\delta_l\\right)\n$$\nThis matches the required asymptotic behavior. Thus, we adopt this form for the exterior solution valid for all $r \\ge R$.\n\nThe logarithmic derivative is defined as $L(r) = \\frac{u_l'(r)}{u_l(r)}$, where the prime denotes differentiation with respect to $r$. First, we compute the derivative of $u_l^{\\text{(out)}}(r)$:\n$$\nu_{l}^{\\text{(out)}\\prime}(r) = \\frac{d}{dr} \\left( C_0 \\left[\\cos(\\delta_l) j_l(kr) - \\sin(\\delta_l) n_l(kr)\\right] \\right)\n$$\nUsing the chain rule, $\\frac{d}{dr}f(kr) = k \\frac{df(x)}{dx}\\big|_{x=kr}$, we get:\n$$\nu_{l}^{\\text{(out)}\\prime}(r) = C_0 \\left[\\cos(\\delta_l) \\left(k j_l'(kr)\\right) - \\sin(\\delta_l) \\left(k n_l'(kr)\\right)\\right]\n$$\nHere, $j_l'(\\rho)$ and $n_l'(\\rho)$ denote the derivatives of the spherical Bessel functions with respect to their argument $\\rho$.\n$$\nu_{l}^{\\text{(out)}\\prime}(r) = k C_0 \\left[\\cos(\\delta_l) j_l'(kr) - \\sin(\\delta_l) n_l'(kr)\\right]\n$$\nNow we can form the logarithmic derivative by taking the ratio of $u_{l}^{\\text{(out)}\\prime}(r)$ to $u_{l}^{\\text{(out)}}(r)$. The normalization constant $C_0$ cancels out:\n$$\nL(r) = \\frac{k C_0 \\left[\\cos(\\delta_l) j_l'(kr) - \\sin(\\delta_l) n_l'(kr)\\right]}{C_0 \\left[\\cos(\\delta_l) j_l(kr) - \\sin(\\delta_l) n_l(kr)\\right]}\n$$\n$$\nL(r) = k \\frac{\\cos(\\delta_l) j_l'(kr) - \\sin(\\delta_l) n_l'(kr)}{\\cos(\\delta_l) j_l(kr) - \\sin(\\delta_l) n_l(kr)}\n$$\nThe problem asks for this expression evaluated at the matching radius $r_m$. Substituting $r=r_m$:\n$$\nL(r_m) = k \\frac{\\cos(\\delta_l) j_l'(kr_m) - \\sin(\\delta_l) n_l'(kr_m)}{\\cos(\\delta_l) j_l(kr_m) - \\sin(\\delta_l) n_l(kr_m)}\n$$\nThis is the explicit analytic expression for the logarithmic derivative of the exterior solution at the matching point $r_m$. It is expressed in terms of the wave number $k$, the orbital angular momentum quantum number $l$ (as an index), the phase shift $\\delta_l$, and the spherical Bessel functions $j_l, n_l$ and their derivatives with respect to their arguments, evaluated at $kr_m$. This quantity is what must be matched to the logarithmic derivative of the numerically-integrated interior solution to enforce $C^1$ continuity and determine the phase shift.", "answer": "$$\n\\boxed{k \\frac{\\cos(\\delta_l) j_l'(kr_m) - \\sin(\\delta_l) n_l'(kr_m)}{\\cos(\\delta_l) j_l(kr_m) - \\sin(\\delta_l) n_l(kr_m)}}\n$$", "id": "3577805"}, {"introduction": "While coordinate-space methods are intuitive, momentum-space formulations based on integral equations are often more powerful for describing scattering phenomena. This approach, however, introduces a distinct numerical challenge: handling the singularities that appear in the free propagator for positive energies. This practice guides you through taming these singularities by applying the Sokhotski-Plemelj theorem and implementing a stable numerical method to compute the resulting Cauchy principal value integrals, a vital skill for modern computational nuclear physics. [@problem_id:3577750]", "problem": "Consider the time-independent Schrödinger equation for two-body scattering in three spatial dimensions under the momentum-space, $s$-wave reduction. In this representation, the free resolvent for a positive scattering energy $E$ appears in kernels of the form $R(E \\pm i0^+) = (E - \\hat{T} \\pm i0^+)^{-1}$, where $\\hat{T}$ is the kinetic-energy operator. When reduced to a one-dimensional integral over the relative momentum magnitude $q$, one encounters integrals of the type\n$$\nI(E) = \\int_{0}^{\\Lambda} \\mathrm{d}q \\, \\frac{q^2 \\, f(q)}{E - \\frac{q^2}{2\\mu} + i0^+},\n$$\nwhere $\\mu$ is the reduced mass, $\\Lambda$ is a finite ultraviolet momentum cutoff, and $f(q)$ is a sufficiently smooth test function that encodes the angular-average of the interaction and possibly other factors. The $i0^+$ prescription encodes the outgoing-wave boundary condition and leads to a distributional evaluation at the on-shell momentum. You must explain how a Cauchy principal value arises in the numerical treatment of such integrals starting from fundamental distributional limits that define the resolvent, and design a robust numerical method that separates the Cauchy principal value from the delta-function contribution to ensure accuracy for scattering energies in the continuum.\n\nStarting from fundamental definitions of distributions and well-tested facts about limits of complex resolvents applied to smooth test functions, derive a numerically stable decomposition for $I(E)$ when $E  0$ that:\n- cleanly separates a real Cauchy principal value integral from an imaginary contribution localized at the on-shell momentum $q_0$ defined implicitly by $E = \\frac{q_0^2}{2\\mu}$, and\n- yields a well-conditioned real integral suitable for high-accuracy quadrature on $[0,\\Lambda]$.\n\nThen, implement your derived method in code by specializing to the test function\n$$\nf(q) = \\exp\\!\\big(-\\alpha \\, q^2\\big),\n$$\nwith a fixed parameter $\\alpha  0$. Use a stable subtract-and-add strategy that removes the pole of the real part of the integrand at $q=q_0$ by adding and subtracting a constant constructed from $f(q_0)$, and evaluate any resulting non-singular real integral numerically with high accuracy. Any term you identify as integrable in closed form should be evaluated analytically, not numerically.\n\nAdopt natural units with reduced Planck's constant and the speed of light set to unity, that is, $\\hbar = c = 1$. Measure all momenta in $\\mathrm{fm}^{-1}$, mass in $\\mathrm{fm}^{-1}$, and energy in $\\mathrm{fm}^{-1}$. Under these conventions, the integral $I(E)$ has units of $\\mathrm{fm}^{-2}$. For numerical evaluation, round all reported real and imaginary parts of $I(E)$ to $8$ decimal places and report them in $\\mathrm{fm}^{-2}$.\n\nYour program must implement the method for the following test suite of parameter values that probe diverse regimes:\n- Common parameters for all cases: reduced mass $\\mu = 2.385\\,\\mathrm{fm}^{-1}$, cutoff $\\Lambda = 5.0\\,\\mathrm{fm}^{-1}$, and Gaussian parameter $\\alpha = 0.3\\,\\mathrm{fm}^2$.\n- Case A (scattering energy well inside the cutoff shell): choose an on-shell momentum $q_0 = 2.0\\,\\mathrm{fm}^{-1}$, and set $E = \\frac{q_0^2}{2\\mu}$.\n- Case B (low-energy scattering near threshold): choose $q_0 = 0.1\\,\\mathrm{fm}^{-1}$, and set $E = \\frac{q_0^2}{2\\mu}$.\n- Case C (on-shell momentum close to the cutoff from below): choose $q_0 = 0.99\\,\\Lambda$, and set $E = \\frac{q_0^2}{2\\mu}$.\n- Case D (no on-shell momentum inside the cutoff): choose $q_0 = 6.0\\,\\mathrm{fm}^{-1}$, and set $E = \\frac{q_0^2}{2\\mu}$.\n\nFor each case, compute $I(E)$ as a complex number, and report the real part (the Cauchy principal value) and the imaginary part (the on-shell delta-function contribution), both in $\\mathrm{fm}^{-2}$. The final output must be a single line containing a list of pairs, where each pair is a two-element list $[ \\text{Re}(I), \\text{Im}(I) ]$ rounded to $8$ decimal places. For example, the overall format must be\n$[ [r_1,i_1],[r_2,i_2],[r_3,i_3],[r_4,i_4] ]$\nwith no spaces in the output. Angles are not involved in this problem, so no angle units are needed.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets as described above, for the four cases listed in the test suite, in the order A, B, C, D. No user input is permitted; all constants and parameters must be defined in the code.", "solution": "The problem requires the evaluation of a complex integral that is frequently encountered in the momentum-space formulation of quantum scattering theory. The integral is given by\n$$\nI(E) = \\int_{0}^{\\Lambda} \\mathrm{d}q \\, \\frac{q^2 \\, f(q)}{E - \\frac{q^2}{2\\mu} + i0^+},\n$$\nwhere $E  0$ is the scattering energy, $\\mu$ is the reduced mass, $\\Lambda$ is a momentum cutoff, and $f(q)$ is a smooth function. The term $+i0^+$ indicates a specific limit that is crucial for defining the integral and enforcing physical boundary conditions (outgoing spherical waves).\n\nOur first step is to analyze the structure of the integrand's denominator. We can rewrite it in terms of the on-shell momentum $q_0 = \\sqrt{2\\mu E}$, which is the magnitude of the relative momentum for which the kinetic energy equals the total energy $E$.\n$$\nE - \\frac{q^2}{2\\mu} = \\frac{q_0^2}{2\\mu} - \\frac{q^2}{2\\mu} = -\\frac{1}{2\\mu} (q^2 - q_0^2).\n$$\nSubstituting this into the integral, we get\n$$\nI(E) = \\int_{0}^{\\Lambda} \\mathrm{d}q \\, \\frac{q^2 \\, f(q)}{-\\frac{1}{2\\mu} (q^2 - q_0^2) + i0^+} = -2\\mu \\int_{0}^{\\Lambda} \\mathrm{d}q \\, \\frac{q^2 \\, f(q)}{q^2 - q_0^2 - i(2\\mu \\cdot 0^+)}.\n$$\nThe term $i(2\\mu \\cdot 0^+)$ is simply another infinitesimal, which we can denote as $i\\epsilon$. The integral becomes\n$$\nI(E) = -2\\mu \\lim_{\\epsilon \\to 0^+} \\int_{0}^{\\Lambda} \\mathrm{d}q \\, \\frac{q^2 \\, f(q)}{q^2 - q_0^2 - i\\epsilon}.\n$$\nTo evaluate this integral, we employ the Sokhotski-Plemelj theorem, which provides a formula for the limit of such distributions:\n$$\n\\lim_{\\epsilon \\to 0^+} \\frac{1}{x \\pm i\\epsilon} = \\mathcal{P}\\left(\\frac{1}{x}\\right) \\mp i\\pi \\delta(x),\n$$\nwhere $\\mathcal{P}$ denotes the Cauchy Principal Value and $\\delta(x)$ is the Dirac delta function. In our case, the variable in the denominator is a function of the integration variable, $g(q) = q^2 - q_0^2$. Applying the theorem yields\n$$\n\\frac{1}{q^2 - q_0^2 - i\\epsilon} \\xrightarrow{\\epsilon\\to0^+} \\mathcal{P}\\left(\\frac{1}{q^2 - q_0^2}\\right) + i\\pi \\delta(q^2 - q_0^2).\n$$\nThe integral $I(E)$ thus separates into a real part (from the principal value) and an imaginary part (from the delta function):\n$$\nI(E) = -2\\mu \\left[ \\mathcal{P} \\int_{0}^{\\Lambda} \\mathrm{d}q \\, \\frac{q^2 \\, f(q)}{q^2 - q_0^2} + i\\pi \\int_{0}^{\\Lambda} \\mathrm{d}q \\, q^2 \\, f(q) \\, \\delta(q^2 - q_0^2) \\right].\n$$\nThis decomposition is valid if the singularity at $q=q_0$ lies within the integration interval, i.e., $0  q_0  \\Lambda$. If $q_0 \\ge \\Lambda$, the denominator never vanishes in $[0, \\Lambda]$, the $i0^+$ term is irrelevant, the integral is purely real, and the principal value is not needed.\n\nLet's analyze the two parts for the case $0  q_0  \\Lambda$.\n\n**Imaginary Part:**\nThe imaginary part involves an integral with a delta function of a function, $\\delta(q^2 - q_0^2)$. We use the identity $\\delta(g(x)) = \\sum_i \\frac{\\delta(x-x_i)}{|g'(x_i)|}$, where $x_i$ are the simple roots of $g(x)$. Here, $g(q) = q^2 - q_0^2$ has roots $q = \\pm q_0$. The derivative is $g'(q) = 2q$, so $|g'(\\pm q_0)| = 2q_0$. Therefore,\n$$\n\\delta(q^2 - q_0^2) = \\frac{1}{2q_0} [\\delta(q - q_0) + \\delta(q + q_0)].\n$$\nSince the integration domain is $[0, \\Lambda]$ and $q_0  0$, only the $\\delta(q - q_0)$ term contributes. The imaginary part of $I(E)$ is\n$$\n\\mathrm{Im}[I(E)] = -2\\mu\\pi \\int_{0}^{\\Lambda} \\mathrm{d}q \\, q^2 \\, f(q) \\, \\frac{1}{2q_0} \\delta(q - q_0) = - \\frac{\\mu\\pi}{q_0} [q^2 f(q)]_{q=q_0} = -\\mu\\pi q_0 f(q_0).\n$$\nWith the specified test function $f(q) = \\exp(-\\alpha q^2)$, this becomes\n$$\n\\mathrm{Im}[I(E)] = -\\mu\\pi q_0 \\exp(-\\alpha q_0^2).\n$$\n\n**Real Part:**\nThe real part of $I(E)$ is the principal value integral:\n$$\n\\mathrm{Re}[I(E)] = -2\\mu \\, \\mathcal{P} \\int_{0}^{\\Lambda} \\mathrm{d}q \\, \\frac{q^2 \\, f(q)}{q^2 - q_0^2}.\n$$\nDirect numerical evaluation of such an integral is unstable due to the singularity. We use the subtract-and-add technique. Let $h(q) = q^2 f(q)$. We rewrite the integral as:\n$$\n\\mathcal{P} \\int_{0}^{\\Lambda} \\frac{h(q)}{q^2 - q_0^2} \\mathrm{d}q = \\int_{0}^{\\Lambda} \\frac{h(q) - h(q_0)}{q^2 - q_0^2} \\mathrm{d}q + \\mathcal{P} \\int_{0}^{\\Lambda} \\frac{h(q_0)}{q^2 - q_0^2} \\mathrm{d}q.\n$$\nThe first term is a regular integral, as the numerator $h(q) - h(q_0)$ vanishes at $q=q_0$, canceling the singularity in the denominator. The integrand approaches the well-defined limit $\\frac{h'(q_0)}{2q_0}$ as $q \\to q_0$. This integral can be computed accurately using standard numerical quadrature.\n\nThe second term can be evaluated analytically:\n$$\n\\mathcal{P} \\int_{0}^{\\Lambda} \\frac{h(q_0)}{q^2 - q_0^2} \\mathrm{d}q = h(q_0) \\, \\mathcal{P} \\int_{0}^{\\Lambda} \\frac{\\mathrm{d}q}{(q-q_0)(q+q_0)}.\n$$\nUsing partial fraction decomposition, $\\frac{1}{(q-q_0)(q+q_0)} = \\frac{1}{2q_0}\\left(\\frac{1}{q-q_0} - \\frac{1}{q+q_0}\\right)$, we get\n$$\n\\frac{h(q_0)}{2q_0} \\left( \\mathcal{P}\\int_{0}^{\\Lambda} \\frac{\\mathrm{d}q}{q-q_0} - \\int_{0}^{\\Lambda} \\frac{\\mathrm{d}q}{q+q_0} \\right) = \\frac{h(q_0)}{2q_0} \\left( [\\ln|q-q_0|]_0^\\Lambda - [\\ln(q+q_0)]_0^\\Lambda \\right)\n$$\n$$\n= \\frac{h(q_0)}{2q_0} \\left( (\\ln|\\Lambda-q_0|-\\ln|-q_0|) - (\\ln(\\Lambda+q_0)-\\ln(q_0)) \\right) = \\frac{h(q_0)}{2q_0} \\ln\\left(\\frac{\\Lambda-q_0}{\\Lambda+q_0}\\right).\n$$\nSubstituting $h(q_0) = q_0^2 f(q_0)$, the analytical part of the integral becomes $\\frac{q_0 f(q_0)}{2} \\ln\\left(\\frac{\\Lambda-q_0}{\\Lambda+q_0}\\right)$.\n\nCombining everything, the real part is:\n$$\n\\mathrm{Re}[I(E)] = -2\\mu \\left[ \\int_{0}^{\\Lambda} \\mathrm{d}q \\, \\frac{q^2 f(q) - q_0^2 f(q_0)}{q^2 - q_0^2} + \\frac{q_0 f(q_0)}{2} \\ln\\left(\\frac{\\Lambda-q_0}{\\Lambda+q_0}\\right) \\right].\n$$\nUsing $f(q) = \\exp(-\\alpha q^2)$, this is\n$$\n\\mathrm{Re}[I(E)] = -2\\mu \\int_{0}^{\\Lambda} \\mathrm{d}q \\, \\frac{q^2 e^{-\\alpha q^2} - q_0^2 e^{-\\alpha q_0^2}}{q^2 - q_0^2} - \\mu q_0 e^{-\\alpha q_0^2} \\ln\\left(\\frac{\\Lambda-q_0}{\\Lambda+q_0}\\right).\n$$\nThis formula is valid for $0  q_0  \\Lambda$. For the numerical evaluation of the regularized integral, the value of the integrand at $q=q_0$ is given by the limit $\\frac{d(q^2 f(q))}{d(q^2)}|_{q=q_0} = [f(q) + q f'(q)/2]_ {q=q_0^2}$, which evaluates to $(1-\\alpha q_0^2) e^{-\\alpha q_0^2}$.\n\n**Case $q_0 \\ge \\Lambda$:**\nIn this case, the pole at $q=q_0$ is outside the integration interval $[0, \\Lambda]$. The denominator $E - q^2/(2\\mu)$ is never zero. The $i0^+$ prescription is not needed, and the integral is purely real.\n$$\nI(E) = \\mathrm{Re}[I(E)] = \\int_{0}^{\\Lambda} \\mathrm{d}q \\, \\frac{q^2 f(q)}{E - q^2/(2\\mu)} = -2\\mu \\int_{0}^{\\Lambda} \\mathrm{d}q \\, \\frac{q^2 e^{-\\alpha q^2}}{q^2 - q_0^2}.\n$$\n$$\n\\mathrm{Im}[I(E)] = 0.\n$$\nThe integral for $\\mathrm{Re}[I(E)]$ is non-singular and can be directly computed using numerical quadrature.\n\nSummary of implementation strategy:\n- For each test case, determine if $q_0  \\Lambda$.\n- If $q_0  \\Lambda$:\n    1. Calculate $\\mathrm{Im}[I(E)]$ using the analytical formula $-\\mu\\pi q_0 \\exp(-\\alpha q_0^2)$.\n    2. Calculate the analytical part of $\\mathrm{Re}[I(E)]$.\n    3. Numerically integrate the regularized integrand to find the numerical part of $\\mathrm{Re}[I(E)]$.\n    4. Sum the two parts for the total $\\mathrm{Re}[I(E)]$.\n- If $q_0 \\ge \\Lambda$:\n    1. Set $\\mathrm{Im}[I(E)] = 0$.\n    2. Numerically integrate the non-singular expression for $\\mathrm{Re}[I(E)]$.\n- Round the final real and imaginary parts to 8 decimal places.", "answer": "```python\nimport numpy as np\nfrom scipy import integrate\n\ndef solve():\n    \"\"\"\n    Solves for the complex integral I(E) for four different scattering energies.\n    \"\"\"\n\n    # Common parameters as specified in the problem statement.\n    # All quantities are in appropriate powers of fm.\n    MU = 2.385  # Reduced mass in fm^-1\n    LAMBDA = 5.0  # Momentum cutoff in fm^-1\n    ALPHA = 0.3  # Gaussian parameter in fm^2\n\n    # Test cases defined by the on-shell momentum q_0 in fm^-1\n    test_q0 = [\n        2.0,                  # Case A\n        0.1,                  # Case B\n        0.99 * LAMBDA,        # Case C\n        6.0                   # Case D\n    ]\n\n    results = []\n    for q0 in test_q0:\n        # The test function f(q) = exp(-alpha * q^2)\n        f = lambda q: np.exp(-ALPHA * q**2)\n\n        # Handle the two main scenarios: pole inside or outside the integration domain.\n        if 0  q0  LAMBDA:\n            # --- Case 1: Pole is inside the integration interval [0, LAMBDA] ---\n\n            # Imaginary part from the delta-function contribution\n            im_I = -MU * np.pi * q0 * f(q0)\n\n            # Real part is split into a numerically evaluated integral and an analytical term.\n            \n            # 1. Integrand for the numerically evaluated part.\n            # This is the regularized integrand for the principal value.\n            def integrand_re_pv(q):\n                # To avoid 0/0, we handle q -> q0 using L'Hopital's rule, \n                # which results in the derivative of h(x)=x*f(sqrt(x)) w.r.t x=q^2.\n                # d/dx[x*exp(-alpha*x)] = (1 - alpha*x)*exp(-alpha*x)\n                if np.isclose(q, q0):\n                    return (1 - ALPHA * q0**2) * f(q0)\n                else:\n                    numerator = q**2 * f(q) - q0**2 * f(q0)\n                    denominator = q**2 - q0**2\n                    return numerator / denominator\n\n            # The integral is over [0, LAMBDA].\n            # scipy.integrate.quad is used for high-accuracy numerical integration.\n            numerical_part, _ = integrate.quad(integrand_re_pv, 0, LAMBDA)\n            \n            # 2. The analytical part of the principal value integral.\n            # Note that log((L-q0)/(L+q0)) is negative since L  q0.\n            analytical_part = (q0 * f(q0) / 2.0) * np.log((LAMBDA - q0) / (LAMBDA + q0))\n\n            # Total real part of I(E)\n            re_I = -2.0 * MU * (numerical_part + analytical_part)\n\n        else: # q0 = LAMBDA or q0 = 0\n            # --- Case 2: Pole is outside the integration interval ---\n            # The integral is purely real and non-singular.\n            \n            im_I = 0.0\n\n            # The integrand for the real part.\n            # E = q0^2 / (2*mu) = E - q^2/(2*mu) = -(q^2 - q0^2)/(2*mu)\n            # The denominator q^2 - q0^2 is never zero for q in [0, LAMBDA].\n            def integrand_re_no_pole(q):\n                return (q**2 * f(q)) / (q**2 - q0**2)\n\n            integral_val, _ = integrate.quad(integrand_re_no_pole, 0, LAMBDA)\n            re_I = -2.0 * MU * integral_val\n\n        # Round results to 8 decimal places as required.\n        results.append([round(re_I, 8), round(im_I, 8)])\n    \n    # Format the final output string exactly as specified.\n    output_str = \"[\" + \",\".join([f\"[{r},{i}]\" for r, i in results]) + \"]\"\n    print(output_str)\n\nsolve()\n```", "id": "3577750"}]}