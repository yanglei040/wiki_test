{"hands_on_practices": [{"introduction": "The cornerstone of quasiparticle theory in fermionic superfluids is the energy gap, $\\Delta$, which emerges from pairing correlations. This practice takes you back to first principles, guiding you through the derivation of the celebrated Bardeen–Cooper–Schrieffer (BCS) gap equation for a simplified, yet powerful, separable pairing interaction [@problem_id:3585386]. By solving this equation analytically, you will gain direct insight into how the gap arises non-perturbatively from the interplay between interaction strength and the density of states at the Fermi level.", "problem": "Consider uniform neutron matter at zero temperature described by a mean-field Bardeen–Cooper–Schrieffer (BCS) pairing with a separable interaction. The many-body Hamiltonian is\n$$\nH \\;=\\; \\sum_{k,\\sigma} \\xi_{k} \\, c^{\\dagger}_{k\\sigma} c_{k\\sigma} \\;+\\; \\sum_{k,k'} V_{kk'} \\, c^{\\dagger}_{k\\uparrow} c^{\\dagger}_{-k\\downarrow} c_{-k'\\downarrow} c_{k'\\uparrow},\n$$\nwhere $\\xi_{k} \\equiv \\varepsilon_{k} - \\mu$ is the single-particle energy measured from the chemical potential $\\mu$, and $V_{kk'}$ is the pairing interaction. Assume a separable, attractive $s$-wave pairing interaction $V_{kk'}=-G$ that is nonzero only for single-particle states with $|\\xi_{k}| \\le \\omega_{c}$, where $\\omega_{c}$ is a physically motivated energy cutoff around the Fermi surface arising from either a finite-range interaction or a computational truncation of the model space. Work within the standard BCS mean-field decoupling where the quasiparticle excitation energy is $E_{k} = \\sqrt{\\xi_{k}^{2} + \\Delta^{2}}$, the coherence factors satisfy $u_{k}^{2} = \\frac{1}{2}\\left(1 + \\frac{\\xi_{k}}{E_{k}}\\right)$, $v_{k}^{2} = \\frac{1}{2}\\left(1 - \\frac{\\xi_{k}}{E_{k}}\\right)$, and $u_{k} v_{k} = \\frac{\\Delta}{2 E_{k}}$, and the gap order parameter is defined by $\\Delta_{k} \\equiv -\\sum_{k'} V_{kk'} \\langle c_{-k'\\downarrow} c_{k'\\uparrow} \\rangle$. Under these assumptions:\n\n- Derive the zero-temperature gap equation from first principles and show that the gap is momentum independent, $\\Delta_{k} \\equiv \\Delta$, given the separable $V_{kk'}=-G$ and the symmetric cutoff $|\\xi_{k}| \\le \\omega_{c}$.\n- In the continuum limit, replace the momentum sum by an integral over energy using the density of states per spin $N(\\xi)$ and adopt the computationally common approximation $N(\\xi)\\approx N(0)$ constant within the cutoff. Solve the resulting integral equation exactly to obtain a closed-form analytic expression for the constant gap $\\Delta$ in terms of $G$, $N(0)$, and $\\omega_{c}$, without invoking any weak-coupling approximation.\n- To quantify sensitivity to the density of states near the Fermi level, define the logarithmic sensitivity $S \\equiv \\frac{\\partial \\ln \\Delta}{\\partial \\ln N(0)}$ and express $S$ in closed form in terms of $G$ and $N(0)$. Explain briefly, based on your expression, how the sensitivity behaves in the weak-coupling limit while keeping the analytic expression exact.\n\nExpress your final answers as analytic expressions. No numerical evaluation or rounding is required.", "solution": "The problem statement is a standard exercise in Bardeen–Cooper–Schrieffer (BCS) theory and will be validated before proceeding to a solution.\n\n### Step 1: Extract Givens\n- **System**: Uniform neutron matter at zero temperature ($T=0$).\n- **Model**: Mean-field BCS pairing with a separable interaction.\n- **Hamiltonian**: $H = \\sum_{k,\\sigma} \\xi_{k} c^{\\dagger}_{k\\sigma} c_{k\\sigma} + \\sum_{k,k'} V_{kk'} c^{\\dagger}_{k\\uparrow} c^{\\dagger}_{-k\\downarrow} c_{-k'\\downarrow} c_{k'\\uparrow}$.\n- **Single-particle energy**: $\\xi_{k} \\equiv \\varepsilon_{k} - \\mu$, measured from the chemical potential $\\mu$.\n- **Pairing interaction**: $V_{kk'} = -G$ for $|\\xi_{k}| \\le \\omega_{c}$ and $|\\xi_{k'}| \\le \\omega_{c}$, and $V_{kk'} = 0$ otherwise. $G > 0$ for an attractive interaction. $\\omega_c$ is an energy cutoff.\n- **BCS mean-field quantities**:\n    - Quasiparticle energy: $E_{k} = \\sqrt{\\xi_{k}^{2} + \\Delta^{2}}$.\n    - Coherence factors: $u_{k}^{2} = \\frac{1}{2}\\left(1 + \\frac{\\xi_{k}}{E_{k}}\\right)$, $v_{k}^{2} = \\frac{1}{2}\\left(1 - \\frac{\\xi_{k}}{E_{k}}\\right)$, and $u_{k} v_{k} = \\frac{\\Delta}{2 E_{k}}$.\n    - Gap order parameter definition: $\\Delta_{k} \\equiv -\\sum_{k'} V_{kk'} \\langle c_{-k'\\downarrow} c_{k'\\uparrow} \\rangle$.\n- **Approximations**:\n    - Continuum limit: $\\sum_{k} \\to \\int d\\xi N(\\xi)$, where $N(\\xi)$ is the density of states per spin.\n    - Constant density of states: $N(\\xi) \\approx N(0)$ for $|\\xi| \\le \\omega_c$.\n- **Definitions**:\n    - Logarithmic sensitivity: $S \\equiv \\frac{\\partial \\ln \\Delta}{\\partial \\ln N(0)}$.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientifically Grounded**: The problem is a cornerstone application of BCS theory, a well-established and fundamental theory in condensed matter and nuclear physics. The Hamiltonian, definitions, and assumptions (separable potential, constant density of states) are standard textbook models used to describe superconductivity and superfluidity.\n- **Well-Posed**: The problem is clearly structured and asks for specific derivations and expressions based on the provided framework. The assumptions lead to a unique, solvable model.\n- **Objective**: The problem is stated in precise mathematical and physical terms, free of ambiguity or subjective claims.\n\nThe problem does not exhibit any of the invalidity flaws:\n1. It is scientifically and factually sound.\n2. It is a formalizable problem central to the topic of quasiparticle excitations.\n3. The setup is complete and consistent for the task at hand.\n4. The requested conditions are standard approximations in many-body physics, not physically impossible.\n5. The structure is clear and leads to a unique solution for the quantities requested.\n6. The problem is a non-trivial derivation that requires understanding of fundamental BCS theory concepts.\n7. The results are verifiable within the framework of theoretical physics.\n\n### Step 3: Verdict and Action\nThe problem is valid. A complete solution will be provided.\n\n### Solution\n\nThe solution is presented in three parts as requested by the problem statement.\n\n**Part 1: Derivation of the Zero-Temperature Gap Equation**\n\nWe begin with the definition of the momentum-dependent gap parameter $\\Delta_{k}$ at zero temperature:\n$$\n\\Delta_{k} \\equiv -\\sum_{k'} V_{kk'} \\langle c_{-k'\\downarrow} c_{k'\\uparrow} \\rangle\n$$\nIn the BCS ground state, which is the vacuum of quasiparticles, the expectation value of the pair operator is given by the product of the Bogoliubov coherence factors, $\\langle c_{-k'\\downarrow} c_{k'\\uparrow} \\rangle = u_{k'} v_{k'}$. The problem provides the identity $u_{k'} v_{k'} = \\frac{\\Delta_{k'}}{2 E_{k'}}$, where $E_{k'} = \\sqrt{\\xi_{k'}^{2} + \\Delta_{k'}^{2}}$ is the quasiparticle energy. Substituting this into the definition of $\\Delta_{k}$ yields a self-consistency equation for the gap:\n$$\n\\Delta_{k} = -\\sum_{k'} V_{kk'} \\frac{\\Delta_{k'}}{2 E_{k'}} = -\\sum_{k'} V_{kk'} \\frac{\\Delta_{k'}}{2 \\sqrt{\\xi_{k'}^{2} + \\Delta_{k'}^{2}}}\n$$\nNow, we introduce the specified separable pairing interaction: $V_{kk'} = -G$ (a positive constant for attraction) if and only if the single-particle states $k$ and $k'$ both lie within an energy shell $\\omega_{c}$ around the Fermi surface, i.e., $|\\xi_{k}| \\le \\omega_{c}$ and $|\\xi_{k'}| \\le \\omega_{c}$. If either state is outside this shell, $V_{kk'} = 0$.\n\nLet's analyze the equation for $\\Delta_k$. If $|\\xi_k| > \\omega_c$, then $V_{kk'} = 0$ for all $k'$, which immediately implies $\\Delta_k = 0$.\nIf $|\\xi_k| \\le \\omega_c$, the interaction is $V_{kk'} = -G$ for all $k'$ such that $|\\xi_{k'}| \\le \\omega_c$, and $0$ otherwise. The equation becomes:\n$$\n\\Delta_{k} = - \\sum_{k' \\text{ s.t. } |\\xi_{k'}| \\le \\omega_{c}} (-G) \\frac{\\Delta_{k'}}{2 \\sqrt{\\xi_{k'}^{2} + \\Delta_{k'}^{2}}} = G \\sum_{k' \\text{ s.t. } |\\xi_{k'}| \\le \\omega_{c}} \\frac{\\Delta_{k'}}{2 \\sqrt{\\xi_{k'}^{2} + \\Delta_{k'}^{2}}}\n$$\nObserve that the right-hand side of this equation is independent of the momentum $k$. This forces the left-hand side, $\\Delta_k$, to also be a constant for all $k$ within the interaction window $|\\xi_k| \\le \\omega_c$. Let's denote this constant gap by $\\Delta$.\nSince we've established $\\Delta_k = \\Delta$ for $|\\xi_k| \\le \\omega_c$ and $\\Delta_k = 0$ for $|\\xi_k| > \\omega_c$, we can substitute $\\Delta_{k'} = \\Delta$ inside the summation, as the sum is restricted to the region where the gap is constant. This yields:\n$$\n\\Delta = G \\sum_{k' \\text{ s.t. } |\\xi_{k'}| \\le \\omega_{c}} \\frac{\\Delta}{2 \\sqrt{\\xi_{k'}^{2} + \\Delta^{2}}}\n$$\nAssuming a non-trivial superconducting/superfluid state exists ($\\Delta \\neq 0$), we can divide both sides by $\\Delta$ to obtain the zero-temperature gap equation:\n$$\n1 = G \\sum_{k' \\text{ s.t. } |\\xi_{k'}| \\le \\omega_{c}} \\frac{1}{2 \\sqrt{\\xi_{k'}^{2} + \\Delta^{2}}}\n$$\nThis derivation confirms that for the given separable interaction, the gap is indeed independent of momentum, $\\Delta_k \\equiv \\Delta$, within the active energy window.\n\n**Part 2: Analytic Solution for the Gap $\\Delta$**\n\nTo solve the gap equation, we move to the continuum limit by replacing the summation over discrete momentum states with an integral over single-particle energies. The prescription is $\\sum_{k'} \\to \\int d\\xi' N(\\xi')$, where $N(\\xi')$ is the density of states per spin. The sum is restricted to the energy interval $[-\\omega_c, \\omega_c]$.\n$$\n1 = G \\int_{-\\omega_c}^{\\omega_c} N(\\xi') \\frac{1}{2 \\sqrt{\\xi'^{2} + \\Delta^{2}}} d\\xi'\n$$\nThe problem specifies using the approximation that the density of states is constant within this window, $N(\\xi') \\approx N(0)$.\n$$\n1 = G N(0) \\int_{-\\omega_c}^{\\omega_c} \\frac{1}{2 \\sqrt{\\xi'^{2} + \\Delta^{2}}} d\\xi'\n$$\nThe integrand is an even function of $\\xi'$, so we can write the integral as:\n$$\n1 = \\frac{G N(0)}{2} \\cdot 2 \\int_{0}^{\\omega_c} \\frac{1}{\\sqrt{\\xi'^{2} + \\Delta^{2}}} d\\xi' = G N(0) \\int_{0}^{\\omega_c} \\frac{1}{\\sqrt{\\xi'^{2} + \\Delta^{2}}} d\\xi'\n$$\nThis is a standard integral:\n$$\n\\int \\frac{dx}{\\sqrt{x^2+a^2}} = \\arcsinh\\left(\\frac{x}{a}\\right) + C\n$$\nEvaluating the definite integral, we get:\n$$\n\\int_{0}^{\\omega_c} \\frac{d\\xi'}{\\sqrt{\\xi'^{2} + \\Delta^{2}}} = \\left[ \\arcsinh\\left(\\frac{\\xi'}{\\Delta}\\right) \\right]_{0}^{\\omega_c} = \\arcsinh\\left(\\frac{\\omega_c}{\\Delta}\\right) - \\arcsinh(0) = \\arcsinh\\left(\\frac{\\omega_c}{\\Delta}\\right)\n$$\nSubstituting this result back into the gap equation yields:\n$$\n1 = G N(0) \\arcsinh\\left(\\frac{\\omega_c}{\\Delta}\\right)\n$$\nSolving for $\\Delta$ gives the desired closed-form analytic expression:\n$$\n\\arcsinh\\left(\\frac{\\omega_c}{\\Delta}\\right) = \\frac{1}{G N(0)} \\implies \\frac{\\omega_c}{\\Delta} = \\sinh\\left(\\frac{1}{G N(0)}\\right)\n$$\n$$\n\\Delta = \\frac{\\omega_{c}}{\\sinh\\left(\\frac{1}{G N(0)}\\right)}\n$$\n\n**Part 3: Logarithmic Sensitivity $S$**\n\nThe logarithmic sensitivity of the gap $\\Delta$ with respect to the density of states at the Fermi level $N(0)$ is defined as $S \\equiv \\frac{\\partial \\ln \\Delta}{\\partial \\ln N(0)}$. To compute this, we first take the natural logarithm of our expression for $\\Delta$:\n$$\n\\ln \\Delta = \\ln \\omega_c - \\ln\\left[\\sinh\\left(\\frac{1}{G N(0)}\\right)\\right]\n$$\nNow we differentiate $\\ln \\Delta$ with respect to $\\ln N(0)$. Using the chain rule, $S = \\frac{\\partial(\\ln \\Delta)}{\\partial N(0)} \\frac{\\partial N(0)}{\\partial(\\ln N(0))}$. Since $\\frac{\\partial \\ln N(0)}{\\partial N(0)} = \\frac{1}{N(0)}$, the second term is simply $N(0)$.\nLet's compute the first term, $\\frac{\\partial(\\ln \\Delta)}{\\partial N(0)}$:\n$$\n\\frac{\\partial}{\\partial N(0)} (\\ln \\Delta) = 0 - \\frac{1}{\\sinh\\left(\\frac{1}{G N(0)}\\right)} \\cdot \\frac{\\partial}{\\partial N(0)}\\left[\\sinh\\left(\\frac{1}{G N(0)}\\right)\\right]\n$$\n$$\n= -\\frac{1}{\\sinh\\left(\\frac{1}{G N(0)}\\right)} \\cdot \\cosh\\left(\\frac{1}{G N(0)}\\right) \\cdot \\left(-\\frac{1}{G (N(0))^2}\\right)\n$$\n$$\n= \\frac{1}{G (N(0))^2} \\coth\\left(\\frac{1}{G N(0)}\\right)\n$$\nFinally, we compute $S$:\n$$\nS = \\left[\\frac{1}{G (N(0))^2} \\coth\\left(\\frac{1}{G N(0)}\\right)\\right] \\cdot N(0)\n$$\n$$\nS = \\frac{1}{G N(0)} \\coth\\left(\\frac{1}{G N(0)}\\right)\n$$\nThis is the exact, closed-form expression for the sensitivity $S$.\n\nTo analyze the behavior in the weak-coupling limit, we consider the case where the dimensionless product $G N(0) \\ll 1$. In this limit, the argument of the hyperbolic cotangent, $x = \\frac{1}{G N(0)}$, becomes very large ($x \\gg 1$). The asymptotic behavior of $\\coth(x)$ for large $x$ is:\n$$\n\\coth(x) = \\frac{e^{x} + e^{-x}}{e^{x} - e^{-x}} = \\frac{1+e^{-2x}}{1-e^{-2x}} \\approx 1 \\quad \\text{for } x \\to \\infty\n$$\nTherefore, in the weak-coupling limit, the sensitivity $S$ approaches:\n$$\nS \\approx \\frac{1}{G N(0)}\n$$\nThis result shows that as the coupling becomes weaker, the sensitivity $S$ becomes very large. This implies that the pairing gap $\\Delta$ is extremely sensitive to variations in the density of states $N(0)$ at the Fermi level. This high sensitivity is a direct consequence of the non-perturbative nature of the gap, $\\Delta \\propto \\exp\\left(-\\frac{1}{G N(0)}\\right)$, which is characteristic of the BCS mechanism. A small change in the input parameter $N(0)$ leads to a proportionally much larger change in the resulting gap.", "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{\\omega_{c}}{\\sinh\\left(\\frac{1}{G N(0)}\\right)} & \\frac{1}{G N(0)} \\coth\\left(\\frac{1}{G N(0)}\\right) \\end{pmatrix}}\n$$", "id": "3585386"}, {"introduction": "Quasiparticles are born from the Bogoliubov transformation, a canonical transformation that must preserve the fermionic nature of the underlying operators. This fundamental requirement imposes strict orthonormality and completeness relations on the transformation matrices $U$ and $V$. This hands-on practice [@problem_id:3585416] challenges you to first derive these critical matrix identities from first principles and then to validate them numerically by implementing a Hartree-Fock-Bogoliubov (HFB) solver, providing a crucial bridge between abstract formalism and computational verification.", "problem": "Consider a finite set of fermionic single-particle states that define a discretized harmonic oscillator basis of size $N$. Let $\\mathbf{a} = (a_0,\\dots,a_{N-1})^T$ denote the vector of fermionic annihilation operators and $\\mathbf{a}^\\dagger$ the corresponding vector of creation operators, satisfying the canonical anti-commutation relations $\\{a_i,a_j^\\dagger\\} = \\delta_{ij}$, $\\{a_i,a_j\\} = 0$, and $\\{a_i^\\dagger,a_j^\\dagger\\} = 0$. Define a quasiparticle basis via a Bogoliubov transformation\n$$\n\\boldsymbol{\\gamma} = U^\\dagger \\mathbf{a} + V^\\dagger \\mathbf{a}^\\dagger,\n$$\nwhere $U$ and $V$ are $N\\times N$ complex matrices and $\\boldsymbol{\\gamma} = (\\gamma_0,\\dots,\\gamma_{N-1})^T$ are quasiparticle annihilation operators satisfying $\\{\\gamma_k,\\gamma_l^\\dagger\\} = \\delta_{kl}$, $\\{\\gamma_k,\\gamma_l\\} = 0$, and $\\{\\gamma_k^\\dagger,\\gamma_l^\\dagger\\} = 0$. Starting from these canonical anti-commutation relations and the definition of the Bogoliubov transformation, derive the completeness and orthonormality relations\n$$\nU^\\dagger U + V^\\dagger V = \\mathbb{1}, \\quad U^T V + V^T U = 0.\n$$\nYour derivation must clearly identify all algebraic steps from the canonical anti-commutation relations to these matrix identities.\n\nFor numerical validation, construct a Hartree-Fock-Bogoliubov (HFB) quasiparticle Hamiltonian in a discretized harmonic oscillator basis with energy spacing parameter $\\hbar\\omega$ (in Mega electronvolts (MeV)). Let the single-particle Hamiltonian be diagonal with energies $E_i = \\hbar\\omega\\,(i+1/2)$ for $i=0,1,\\dots,N-1$. Choose a chemical potential $\\lambda$ midway between two consecutive single-particle energies to avoid degeneracy. Define a real, symmetric pairing field matrix $\\Delta$ with elements\n$$\n\\Delta_{ij} = g \\exp\\left(-\\frac{(i-j)^2}{2\\sigma^2}\\right),\n$$\nwhere $g$ (in MeV) is the pairing strength and $\\sigma$ is a dimensionless range parameter. Using this, form the Bogoliubov-de Gennes (BdG) Hamiltonian\n$$\n\\mathcal{H} = \\begin{pmatrix}\nh - \\lambda\\,\\mathbb{1} & \\Delta \\\\\n\\Delta & -(h - \\lambda\\,\\mathbb{1})\n\\end{pmatrix},\n$$\nwhere $h = \\mathrm{diag}(E_0,\\dots,E_{N-1})$. Diagonalize $\\mathcal{H}$ to obtain $N$ positive-energy eigenvectors. Each positive-energy eigenvector has the form $\\Psi_k = (u_k, v_k)^T$ with $u_k, v_k \\in \\mathbb{C}^N$. Assemble the matrices $U=[u_0,\\dots,u_{N-1}]$ and $V=[v_0,\\dots,v_{N-1}]$ from these columns, and compute the two validation errors\n$$\n\\varepsilon_1 = \\left\\|U^\\dagger U + V^\\dagger V - \\mathbb{1}\\right\\|_F, \\quad \\varepsilon_2 = \\left\\|U^T V + V^T U\\right\\|_F,\n$$\nwhere $\\|\\cdot\\|_F$ denotes the Frobenius norm. Because these errors are dimensionless, no physical unit specification is required for their values.\n\nStress-test the relations under truncation by artificially removing one quasiparticle column from $U$ and $V$ (i.e., dropping the last positive-energy eigenvector) and recompute the same errors with this truncated set, which should generally violate the relations. Also, examine sensitivity to the harmonic oscillator basis size and pairing strength.\n\nImplement the derivation and numerical validation in a single program that, without any user input, evaluates the following test suite of parameters:\n- Case 1 (general case): $N=8$, $\\hbar\\omega=8.0$ MeV, $g=1.5$ MeV, $\\sigma=1.5$, full positive-energy set.\n- Case 2 (weak pairing limit): $N=8$, $\\hbar\\omega=8.0$ MeV, $g=10^{-6}$ MeV, $\\sigma=1.5$, full positive-energy set.\n- Case 3 (strong pairing): $N=8$, $\\hbar\\omega=8.0$ MeV, $g=6.0$ MeV, $\\sigma=1.5$, full positive-energy set.\n- Case 4 (truncation stress-test): $N=8$, $\\hbar\\omega=8.0$ MeV, $g=1.5$ MeV, $\\sigma=1.5$, drop the last positive-energy eigenvector column from $U$ and $V$.\n- Case 5 (small basis): $N=4$, $\\hbar\\omega=8.0$ MeV, $g=1.5$ MeV, $\\sigma=1.0$, full positive-energy set.\n\nFor each case, compute and return the pair $(\\varepsilon_1,\\varepsilon_2)$ as floating-point numbers. Your program should produce a single line of output containing the ten results in order, as a comma-separated list enclosed in square brackets, i.e.,\n$[\\varepsilon_{1}^{(1)},\\varepsilon_{2}^{(1)},\\varepsilon_{1}^{(2)},\\varepsilon_{2}^{(2)},\\varepsilon_{1}^{(3)},\\varepsilon_{2}^{(3)},\\varepsilon_{1}^{(4)},\\varepsilon_{2}^{(4)},\\varepsilon_{1}^{(5)},\\varepsilon_{2}^{(5)}]$.", "solution": "The problem statement is first validated against the required criteria.\n\n### Step 1: Extract Givens\n- **Definitions**:\n  - Fermionic annihilation and creation operators: $\\mathbf{a} = (a_0, \\dots, a_{N-1})^T$, $\\mathbf{a}^\\dagger$.\n  - Quasiparticle annihilation and creation operators: $\\boldsymbol{\\gamma} = (\\gamma_0, \\dots, \\gamma_{N-1})^T$, $\\boldsymbol{\\gamma}^\\dagger$.\n  - Bogoliubov transformation: $\\boldsymbol{\\gamma} = U^\\dagger \\mathbf{a} + V^\\dagger \\mathbf{a}^\\dagger$, where $U, V$ are $N \\times N$ complex matrices.\n  - Single-particle Hamiltonian: $h = \\mathrm{diag}(E_0, \\dots, E_{N-1})$ with $E_i = \\hbar\\omega(i+1/2)$.\n  - Pairing field matrix: $\\Delta_{ij} = g \\exp(-\\frac{(i-j)^2}{2\\sigma^2})$.\n  - Bogoliubov-de Gennes (BdG) Hamiltonian: $\\mathcal{H} = \\begin{pmatrix} h - \\lambda\\,\\mathbb{1} & \\Delta \\\\ \\Delta & -(h - \\lambda\\,\\mathbb{1}) \\end{pmatrix}$.\n  - HFB eigenvectors: $\\Psi_k = (u_k, v_k)^T$ for positive energies, forming matrices $U=[u_0, \\dots, u_{N-1}]$ and $V=[v_0, \\dots, v_{N-1}]$.\n  - Validation errors: $\\varepsilon_1 = \\|U^\\dagger U + V^\\dagger V - \\mathbb{1}\\|_F$ and $\\varepsilon_2 = \\|U^T V + V^T U\\|_F$.\n- **Canonical Anti-commutation Relations (CARs)**:\n  - For fermions: $\\{a_i, a_j^\\dagger\\} = \\delta_{ij}$, $\\{a_i, a_j\\} = 0$, $\\{a_i^\\dagger, a_j^\\dagger\\} = 0$.\n  - For quasiparticles: $\\{\\gamma_k, \\gamma_l^\\dagger\\} = \\delta_{kl}$, $\\{\\gamma_k, \\gamma_l\\} = 0$, $\\{\\gamma_k^\\dagger, \\gamma_l^\\dagger\\} = 0$.\n- **Numerical Test Cases**:\n  1. $N=8$, $\\hbar\\omega=8.0$ MeV, $g=1.5$ MeV, $\\sigma=1.5$, full set.\n  2. $N=8$, $\\hbar\\omega=8.0$ MeV, $g=10^{-6}$ MeV, $\\sigma=1.5$, full set.\n  3. $N=8$, $\\hbar\\omega=8.0$ MeV, $g=6.0$ MeV, $\\sigma=1.5$, full set.\n  4. $N=8$, $\\hbar\\omega=8.0$ MeV, $g=1.5$ MeV, $\\sigma=1.5$, truncated set.\n  5. $N=4$, $\\hbar\\omega=8.0$ MeV, $g=1.5$ MeV, $\\sigma=1.0$, full set.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is evaluated against the validation criteria:\n- **Scientifically Grounded**: The problem is rooted in the standard Hartree-Fock-Bogoliubov (HFB) theory, a cornerstone of quantum many-body physics, particularly in nuclear structure theory. The Bogoliubov transformation, BdG Hamiltonian, and the associated matrix relations are all standard and well-established concepts.\n- **Well-Posed**: The problem is specified in complete detail. The analytical part poses a standard derivation. The numerical part provides all necessary parameters ($N, \\hbar\\omega, g, \\sigma$), explicit forms for all matrices ($h, \\Delta, \\mathcal{H}$), and a clear procedure for obtaining the quantities of interest ($U, V$ from eigenvectors) and the validation errors ($\\varepsilon_1, \\varepsilon_2$). The choice of chemical potential $\\lambda$ is specified unambiguously.\n- **Objective**: The problem is stated using precise, objective mathematical and physical terminology. There are no subjective or opinion-based statements. The qualitative comment regarding the expected outcome of truncation (\"should generally violate the relations\") is an auxiliary remark and does not invalidate the explicit and objective computational task.\n- **No other flaws**: The problem does not violate any other validation criteria. It is formalizable, relevant to the specified topic, internally consistent, physically plausible within the HFB model framework, and non-trivial.\n\n### Step 3: Verdict and Action\nThe problem is **valid**. A full solution is warranted.\n\n### Analytical Derivation\nThe goal is to derive the matrix identities $U^\\dagger U + V^\\dagger V = \\mathbb{1}$ and $U^T V + V^T U = 0$ from the fermionic nature of both the original particles and the quasiparticles.\n\nThe Bogoliubov transformation is given in component form as:\n$$\n\\gamma_k = \\sum_{i=0}^{N-1} (U_{ik}^* a_i + V_{ik}^* a_i^\\dagger)\n$$\nThe adjoint operator is:\n$$\n\\gamma_k^\\dagger = \\left( \\sum_{i=0}^{N-1} (U_{ik}^* a_i + V_{ik}^* a_i^\\dagger) \\right)^\\dagger = \\sum_{i=0}^{N-1} (a_i^\\dagger U_{ik} + a_i V_{ik})\n$$\nThe original operators $a_i$ and the quasiparticle operators $\\gamma_k$ are both fermionic and thus obey the canonical anti-commutation relations (CARs).\nFor the original fermions: $\\{a_i, a_j^\\dagger\\} = \\delta_{ij}$, and $\\{a_i, a_j\\} = \\{a_i^\\dagger, a_j^\\dagger\\} = 0$.\nFor the quasiparticles: $\\{\\gamma_k, \\gamma_l^\\dagger\\} = \\delta_{kl}$, and $\\{\\gamma_k, \\gamma_l\\} = \\{\\gamma_k^\\dagger, \\gamma_l^\\dagger\\} = 0$.\n\n**1. Derivation of $U^\\dagger U + V^\\dagger V = \\mathbb{1}$**\nWe compute the anti-commutator $\\{\\gamma_k, \\gamma_l^\\dagger\\}$ and impose the fermionic condition.\n$$\n\\{\\gamma_k, \\gamma_l^\\dagger\\} = \\left\\{ \\sum_i (U_{ik}^* a_i + V_{ik}^* a_i^\\dagger), \\sum_j (a_j^\\dagger U_{jl} + a_j V_{jl}) \\right\\}\n$$\nUsing the bilinearity of the anti-commutator:\n$$\n\\{\\gamma_k, \\gamma_l^\\dagger\\} = \\sum_{i,j} \\left( U_{ik}^* U_{jl} \\{a_i, a_j^\\dagger\\} + U_{ik}^* V_{jl} \\{a_i, a_j\\} + V_{ik}^* U_{jl} \\{a_i^\\dagger, a_j^\\dagger\\} + V_{ik}^* V_{jl} \\{a_i^\\dagger, a_j\\} \\right)\n$$\nSubstituting the CARs for the $a_i$ operators:\n$$\n\\{\\gamma_k, \\gamma_l^\\dagger\\} = \\sum_{i,j} \\left( U_{ik}^* U_{jl} (\\delta_{ij}) + U_{ik}^* V_{jl} (0) + V_{ik}^* U_{jl} (0) + V_{ik}^* V_{jl} (\\delta_{ij}) \\right)\n$$\nThe sums over $j$ collapse due to the Kronecker delta $\\delta_{ij}$:\n$$\n\\{\\gamma_k, \\gamma_l^\\dagger\\} = \\sum_i (U_{ik}^* U_{il} + V_{ik}^* V_{il})\n$$\nThe first term is $\\sum_i (U^\\dagger)_{ki} U_{il} = (U^\\dagger U)_{kl}$, and the second term is $\\sum_i (V^\\dagger)_{ki} V_{il} = (V^\\dagger V)_{kl}$. Therefore:\n$$\n\\{\\gamma_k, \\gamma_l^\\dagger\\} = (U^\\dagger U)_{kl} + (V^\\dagger V)_{kl} = (U^\\dagger U + V^\\dagger V)_{kl}\n$$\nImposing the quasiparticle CAR $\\{\\gamma_k, \\gamma_l^\\dagger\\} = \\delta_{kl}$ gives $(U^\\dagger U + V^\\dagger V)_{kl} = \\delta_{kl}$. In matrix form, this is the first required identity:\n$$\nU^\\dagger U + V^\\dagger V = \\mathbb{1}\n$$\n\n**2. Derivation of $U^T V + V^T U = 0$**\nWe now compute the anti-commutator $\\{\\gamma_k, \\gamma_l\\}$.\n$$\n\\{\\gamma_k, \\gamma_l\\} = \\left\\{ \\sum_i (U_{ik}^* a_i + V_{ik}^* a_i^\\dagger), \\sum_j (U_{jl}^* a_j + V_{jl}^* a_j^\\dagger) \\right\\}\n$$\nExpanding using bilinearity:\n$$\n\\{\\gamma_k, \\gamma_l\\} = \\sum_{i,j} \\left( U_{ik}^* U_{jl}^* \\{a_i, a_j\\} + U_{ik}^* V_{jl}^* \\{a_i, a_j^\\dagger\\} + V_{ik}^* U_{jl}^* \\{a_i^\\dagger, a_j\\} + V_{ik}^* V_{jl}^* \\{a_i^\\dagger, a_j^\\dagger\\} \\right)\n$$\nSubstituting the CARs for the $a_i$ operators:\n$$\n\\{\\gamma_k, \\gamma_l\\} = \\sum_{i,j} \\left( U_{ik}^* U_{jl}^* (0) + U_{ik}^* V_{jl}^* (\\delta_{ij}) + V_{ik}^* U_{jl}^* (\\delta_{ij}) + V_{ik}^* V_{jl}^* (0) \\right)\n$$\nCollapsing the sums over $j$:\n$$\n\\{\\gamma_k, \\gamma_l\\} = \\sum_i (U_{ik}^* V_{il}^* + V_{ik}^* U_{il}^*)\n$$\nImposing the quasiparticle CAR $\\{\\gamma_k, \\gamma_l\\} = 0$, we get $\\sum_i (U_{ik}^* V_{il}^* + V_{ik}^* U_{il}^*) = 0$. Taking the complex conjugate of this equation yields:\n$$\n\\sum_i (U_{ik} V_{il} + V_{ik} U_{il}) = 0\n$$\nThe first term is $\\sum_i (U^T)_{ki} V_{il} = (U^T V)_{kl}$, and the second term is $\\sum_i (V^T)_{ki} U_{il} = (V^T U)_{kl}$. Thus:\n$$\n(U^T V)_{kl} + (V^T U)_{kl} = 0\n$$\nThis must hold for all $k,l$, which gives the second required matrix identity:\n$$\nU^T V + V^T U = 0\n$$\n\n### Numerical Validation Algorithm\nThe numerical part involves constructing and diagonalizing the BdG Hamiltonian for several parameter sets to validate these relations.\n\n1.  **Construct Matrices**: For each test case with parameters $N$, $\\hbar\\omega$, $g$, and $\\sigma$:\n    *   The single-particle energies are $E_i = \\hbar\\omega(i+1/2)$ for $i=0, \\dots, N-1$. These form the diagonal of the single-particle Hamiltonian $h$.\n    *   The chemical potential $\\lambda$ is set midway between the single-particle levels with indices $\\lfloor N/2 \\rfloor-1$ and $\\lfloor N/2 \\rfloor$ to avoid degeneracies at the Fermi surface.\n    *   The pairing matrix $\\Delta$ is constructed using its definition $\\Delta_{ij} = g \\exp(-\\frac{(i-j)^2}{2\\sigma^2})$.\n    *   The $2N \\times 2N$ BdG Hamiltonian $\\mathcal{H}$ is assembled as specified.\n     Since $h$ and $\\Delta$ are real and symmetric, $\\mathcal{H}$ is a real symmetric matrix.\n\n2.  **Diagonalization**: The matrix $\\mathcal{H}$ is diagonalized using a standard numerical algorithm for Hermitian matrices (e.g., `numpy.linalg.eigh`). This yields $2N$ real eigenvalues and a corresponding orthonormal basis of $2N$ real eigenvectors. The eigenvalues appear in pairs $\\pm E_k$. We select the $N$ eigenvectors corresponding to the $N$ positive eigenvalues.\n\n3.  **Form U and V**: Each of the $N$ selected eigenvectors $\\Psi_k$ is a $2N$-dimensional vector. The upper $N$ components form a column vector $u_k$, and the lower $N$ components form a column vector $v_k$. The matrices $U$ and $V$ are constructed by arranging these $N$ vectors $u_k$ and $v_k$ as columns, respectively: $U = [u_0, u_1, \\dots, u_{N-1}]$ and $V = [v_0, v_1, \\dots, v_{N-1}]$.\n\n4.  **Handle Truncation**: For the truncation test case, the last column is dropped from both $U$ and $V$, resulting in matrices of size $N \\times (N-1)$.\n\n5.  **Compute Errors**: The two validation errors, $\\varepsilon_1$ and $\\varepsilon_2$, are computed using the Frobenius norm.\n    *   $\\varepsilon_1 = \\|U^\\dagger U + V^\\dagger V - \\mathbb{1}_K\\|_F$\n    *   $\\varepsilon_2 = \\|U^T V + V^T U\\|_F$\n    where $K$ is the number of quasiparticle states (columns in $U$ and $V$), which is $N$ for the full set and $N-1$ for the truncated set. Since the eigenvectors are real, $U^\\dagger = U^T$ and $V^\\dagger = V^T$.\n\nThis procedure is applied to each of the five test cases, and the resulting pairs $(\\varepsilon_1, \\varepsilon_2)$ are collected.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the HFB validation for the specified test suite.\n    \"\"\"\n\n    test_cases = [\n        # Case 1: General case\n        {'N': 8, 'hbar_omega': 8.0, 'g': 1.5, 'sigma': 1.5, 'truncate': False},\n        # Case 2: Weak pairing limit\n        {'N': 8, 'hbar_omega': 8.0, 'g': 1e-6, 'sigma': 1.5, 'truncate': False},\n        # Case 3: Strong pairing\n        {'N': 8, 'hbar_omega': 8.0, 'g': 6.0, 'sigma': 1.5, 'truncate': False},\n        # Case 4: Truncation stress-test\n        {'N': 8, 'hbar_omega': 8.0, 'g': 1.5, 'sigma': 1.5, 'truncate': True},\n        # Case 5: Small basis\n        {'N': 4, 'hbar_omega': 8.0, 'g': 1.5, 'sigma': 1.0, 'truncate': False},\n    ]\n\n    results = []\n    for params in test_cases:\n        eps1, eps2 = run_hfb_validation(**params)\n        results.extend([eps1, eps2])\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\ndef run_hfb_validation(N, hbar_omega, g, sigma, truncate):\n    \"\"\"\n    Performs the HFB calculation and computes validation errors for a given set of parameters.\n\n    Args:\n        N (int): Basis size.\n        hbar_omega (float): Harmonic oscillator energy spacing (MeV).\n        g (float): Pairing strength (MeV).\n        sigma (float): Dimensionless range parameter for pairing.\n        truncate (bool): If True, drop the highest energy quasiparticle state.\n\n    Returns:\n        tuple[float, float]: The validation errors (eps1, eps2).\n    \"\"\"\n    # 1. Construct single-particle Hamiltonian h and chemical potential lambda\n    sp_energies = hbar_omega * (np.arange(N) + 0.5)\n    h = np.diag(sp_energies)\n    \n    # Choose lambda midway between the two central single-particle levels to avoid degeneracy\n    mid_idx = N // 2\n    lambda_chem = (sp_energies[mid_idx - 1] + sp_energies[mid_idx]) / 2.0\n    \n    # 2. Construct the pairing field matrix Delta\n    indices = np.arange(N)\n    i_minus_j_sq = (indices[:, None] - indices[None, :])**2\n    Delta = g * np.exp(-i_minus_j_sq / (2.0 * sigma**2))\n    \n    # 3. Construct the Bogoliubov-de Gennes (BdG) Hamiltonian H\n    h_prime = h - lambda_chem * np.eye(N)\n    H_bdg = np.block([\n        [h_prime, Delta],\n        [Delta, -h_prime]\n    ])\n    \n    # 4. Diagonalize H_bdg to get eigenvalues and eigenvectors\n    # H_bdg is real and symmetric, so its eigenvectors can be chosen to be real.\n    # np.linalg.eigh sorts eigenvalues in ascending order.\n    eigenvalues, eigenvectors = np.linalg.eigh(H_bdg)\n    \n    # The N positive-energy eigenvectors are the last N columns of the eigenvector matrix.\n    positive_energy_eigenvectors = eigenvectors[:, N:]\n    \n    # 5. Assemble U and V matrices from the eigenvectors\n    U = positive_energy_eigenvectors[:N, :]\n    V = positive_energy_eigenvectors[N:, :]\n    \n    # 6. Apply truncation if requested\n    if truncate:\n        # Drop the last column (corresponding to the highest quasiparticle energy)\n        U = U[:, :-1]\n        V = V[:, :-1]\n        \n    # 7. Compute the validation errors\n    num_qp_states = U.shape[1]\n    identity_K = np.eye(num_qp_states)\n    \n    # Since H_bdg is real-symmetric, U and V are real matrices.\n    # U.conj().T becomes U.T\n    \n    # Error 1: Check U^T U + V^T V = I\n    err1_matrix = U.T @ U + V.T @ V - identity_K\n    eps1 = np.linalg.norm(err1_matrix, 'fro')\n    \n    # Error 2: Check U^T V + V^T U = 0\n    err2_matrix = U.T @ V + V.T @ U\n    eps2 = np.linalg.norm(err2_matrix, 'fro')\n\n    return eps1, eps2\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "3585416"}, {"introduction": "The HFB ground state serves as a vacuum for creating excitations, which are often collective in nature. The Quasiparticle Random Phase Approximation (QRPA) provides the theoretical framework for describing these collective modes, such as vibrations, as correlated two-quasiparticle states. In this computational practice [@problem_id:3585349], you will dissect the origins of nuclear collectivity by building and solving the QRPA equations, selectively activating different channels of the residual interaction to see precisely how they generate iconic spectral features like the low-lying collective state and the giant resonance.", "problem": "Consider the linear response of an even–even nucleus within the Quasiparticle Random Phase Approximation (QRPA), derived from time-dependent Hartree–Fock–Bogoliubov theory. The fundamental base is the Bogoliubov transformation, which defines quasiparticles from particles and holes, and the linearization of the equation of motion for small-amplitude oscillations. The response in a given multipolarity is governed by a matrix equation in the quasiparticle basis, where residual interactions couple two-quasiparticle configurations via particle–hole and particle–particle/hole–hole channels. The Quasiparticle Random Phase Approximation (QRPA) can be cast into a symplectic eigenvalue problem with a metric structure that ensures excitation energies come in pairs of opposite sign under stability. In a simplified but scientifically consistent separable model for an isoscalar quadrupole response, the residual interaction is represented by rank-one forms in each channel, controlled by coupling strengths and structure factors that encode transition amplitudes. The goal is to quantify, by direct computation, how selectively turning off the particle–particle/hole–hole channel versus the particle–hole channel affects the lowest quadrupole state and the giant quadrupole resonance.\n\nStarting from the following base:\n- The two–quasiparticle energies are collected in the diagonal matrix built from the list $\\boldsymbol{\\epsilon}$, where each element is a positive energy in megaelectronvolts (MeV).\n- The residual interaction couples these configurations via a separable isoscalar quadrupole operator with dimensionless amplitudes $\\mathbf{q}$, producing rank-one updates in both the particle–hole and particle–particle/hole–hole channels, controlled by real coupling strengths $\\kappa_{\\mathrm{ph}}$ and $\\kappa_{\\mathrm{pp}}$ (in MeV).\n- The QRPA matrix has the canonical block form with matrices $A$ and $B$ that embody diagonal two–quasiparticle energies plus residual-interaction-induced couplings; the symplectic metric selects physical excitation energies as the positive eigenvalues.\n\nYou must:\n1. Construct, for each test case, the QRPA symplectic matrix using a separable ansatz in which the particle–hole channel and particle–particle/hole–hole channel can be independently toggled on or off. Treat the structure factors in both channels as proportional to the given $\\mathbf{q}$, with the particle–hole and particle–particle/hole–hole channels contributing additively to the $A$ block and with opposite sign in the $B$ block, consistent with their distinct commutation structure in QRPA.\n2. Solve the symplectic eigenproblem using the metric transformation that converts it to a standard eigenvalue problem. From the spectrum of eigenvalues, extract the positive eigenvalues as excitation energies in MeV.\n3. Report, for each test case, two quantities: the lowest positive QRPA energy (interpreted as the low-lying $2^{+}$ state) and the largest positive QRPA energy (interpreted as the giant quadrupole resonance energy).\n4. Express all energies in MeV and round to three decimal places.\n5. Produce the final output as a single line containing the results for all test cases, formatted as a comma-separated Python-style list of lists, where each inner list contains the two floats for that test case (for example, $[[e_{1,\\min},e_{1,\\max}],[e_{2,\\min},e_{2,\\max}],\\dots]$).\n\nTest suite parameters:\n- Use $N=5$ two–quasiparticle configurations in all cases, with\n  $\\boldsymbol{\\epsilon} = [\\,1.8,\\,2.4,\\,3.0,\\,6.5,\\,10.0\\,]$ MeV and\n  $\\mathbf{q} = [\\,1.0,\\,0.85,\\,0.70,\\,0.40,\\,0.20\\,]$ (dimensionless).\n- Four test cases are defined to probe the impact of channels:\n  1. Case A (happy path, both channels on): $\\kappa_{\\mathrm{ph}} = 0.150$ MeV, $\\kappa_{\\mathrm{pp}} = 0.080$ MeV, particle–hole channel on, particle–particle/hole–hole channel on.\n  2. Case B (particle–particle/hole–hole off): $\\kappa_{\\mathrm{ph}} = 0.150$ MeV, $\\kappa_{\\mathrm{pp}} = 0.080$ MeV, particle–hole channel on, particle–particle/hole–hole channel off.\n  3. Case C (particle–hole off): $\\kappa_{\\mathrm{ph}} = 0.150$ MeV, $\\kappa_{\\mathrm{pp}} = 0.080$ MeV, particle–hole channel off, particle–particle/hole–hole channel on.\n  4. Case D (both channels off, diagonal limit): $\\kappa_{\\mathrm{ph}} = 0.150$ MeV, $\\kappa_{\\mathrm{pp}} = 0.080$ MeV, particle–hole channel off, particle–particle/hole–hole channel off.\n\nAlgorithmic requirements:\n- Let $N$ be the length of $\\boldsymbol{\\epsilon}$ and $\\mathbf{q}$. Construct the $N \\times N$ diagonal matrix $E = \\mathrm{diag}(\\boldsymbol{\\epsilon})$.\n- Build $A$ and $B$ as follows, using rank-one updates with $\\mathbf{q}$:\n  - If the particle–hole channel is on, add $\\kappa_{\\mathrm{ph}} \\, \\mathbf{q}\\,\\mathbf{q}^{\\mathrm{T}}$ to $A$ and $\\kappa_{\\mathrm{ph}} \\, \\mathbf{q}\\,\\mathbf{q}^{\\mathrm{T}}$ to $B$.\n  - If the particle–particle/hole–hole channel is on, add $\\kappa_{\\mathrm{pp}} \\, \\mathbf{q}\\,\\mathbf{q}^{\\mathrm{T}}$ to $A$ and subtract $\\kappa_{\\mathrm{pp}} \\, \\mathbf{q}\\,\\mathbf{q}^{\\mathrm{T}}$ from $B$.\n  - Always include $E$ additively in $A$.\n- Form the $2N \\times 2N$ QRPA matrix $\\mathcal{M} = \\begin{pmatrix} A & B \\\\ -B & -A \\end{pmatrix}$ and the metric $\\mathcal{S} = \\mathrm{diag}(\\underbrace{1,\\dots,1}_{N},\\underbrace{-1,\\dots,-1}_{N})$. Solve the standard eigenproblem $\\mathcal{H}\\,\\mathbf{z} = \\omega\\,\\mathbf{z}$ for $\\mathcal{H} = \\mathcal{S}\\,\\mathcal{M}$, and select the positive eigenvalues $\\omega$.\n- Sort the positive eigenvalues ascending. The smallest of these is the low-lying $2^{+}$ energy, and the largest is the giant quadrupole resonance energy.\n\nPhysical units:\n- Energies must be reported in megaelectronvolts (MeV). Round to three decimal places.\n\nFinal output format specification:\n- Your program should produce a single line of output containing the results as a comma-separated list of lists, enclosed in square brackets, where each inner list contains the two floating-point numbers $[E_{2^{+}}, E_{\\mathrm{GQR}}]$ for one test case, both in MeV and rounded to three decimal places (for example, $[[1.234,12.345],[\\dots,\\dots],[\\dots,\\dots],[\\dots,\\dots]]$).", "solution": "The derivation begins from the quasiparticle formulation of the nuclear many-body problem. In Hartree–Fock–Bogoliubov theory, the Bogoliubov transformation defines quasiparticle creation and annihilation operators that diagonalize the mean-field plus pairing Hamiltonian, yielding two–quasiparticle configurations with energies collected in the set $\\boldsymbol{\\epsilon}$, represented by the diagonal matrix $E = \\mathrm{diag}(\\boldsymbol{\\epsilon})$ with $E_{ii} = \\epsilon_{i} > 0$. Small-amplitude oscillations around the ground state are obtained by linearizing the time-dependent Hartree–Fock–Bogoliubov equations, resulting in the Quasiparticle Random Phase Approximation (QRPA). In QRPA, the excitation operators are linear combinations of two–quasiparticle creation and annihilation operators with amplitudes $\\mathbf{X}$ and $\\mathbf{Y}$, and the equations of motion take the canonical matrix form\n$$\n\\begin{pmatrix}\nA & B \\\\\n-B & -A\n\\end{pmatrix}\n\\begin{pmatrix}\n\\mathbf{X} \\\\\n\\mathbf{Y}\n\\end{pmatrix}\n= \\omega\n\\begin{pmatrix}\n\\mathbf{X} \\\\\n-\\mathbf{Y}\n\\end{pmatrix},\n$$\nwhere $\\omega$ are the excitation energies. The matrices $A$ and $B$ encode the diagonal two–quasiparticle energies and the effects of the residual interactions. For an isoscalar quadrupole response modeled by separable interactions, the residual interaction can be written schematically as a sum of a particle–hole term and a particle–particle/hole–hole term. When these are represented as rank-one operators in a given multipole channel, each channel contributes outer products of structure factors to $A$ and $B$, scaled by channel-specific coupling strengths.\n\nIn our separable ansatz, we assign the dimensionless quadrupole amplitudes $\\mathbf{q}$ to represent the coupling strength of each two–quasiparticle configuration to the quadrupole operator. The particle–hole channel contributes coherently to both $A$ and $B$ with the same sign, while the particle–particle/hole–hole channel adds to $A$ but contributes with opposite sign to $B$. This sign difference is consistent with the commutation structure of the QRPA equations and reflects the distinct ways particle–hole and particle–particle/hole–hole operators couple the forward and backward amplitudes. Thus, for coupling strengths $\\kappa_{\\mathrm{ph}}$ and $\\kappa_{\\mathrm{pp}}$ (both in megaelectronvolts), the simplified separable contributions are chosen as\n$$\nA = E + \\left(\\kappa_{\\mathrm{ph}} \\,\\mathbf{q}\\,\\mathbf{q}^{\\mathrm{T}} \\right) \\mathbb{1}_{\\mathrm{ph\\,on}} + \\left(\\kappa_{\\mathrm{pp}} \\,\\mathbf{q}\\,\\mathbf{q}^{\\mathrm{T}} \\right) \\mathbb{1}_{\\mathrm{pp\\,on}},\n$$\n$$\nB = \\left(\\kappa_{\\mathrm{ph}} \\,\\mathbf{q}\\,\\mathbf{q}^{\\mathrm{T}} \\right) \\mathbb{1}_{\\mathrm{ph\\,on}} - \\left(\\kappa_{\\mathrm{pp}} \\,\\mathbf{q}\\,\\mathbf{q}^{\\mathrm{T}} \\right) \\mathbb{1}_{\\mathrm{pp\\,on}},\n$$\nwhere $\\mathbb{1}_{\\mathrm{ph\\,on}}$ is one if the particle–hole channel is on and zero otherwise, and $\\mathbb{1}_{\\mathrm{pp\\,on}}$ is one if the particle–particle/hole–hole channel is on and zero otherwise. The outer product $\\mathbf{q}\\,\\mathbf{q}^{\\mathrm{T}}$ is a rank-one $N \\times N$ matrix that produces coherent coupling among all two–quasiparticle configurations. The choice to use the same structure factors in both channels is a practical modeling assumption that keeps the computation self-contained while remaining physically plausible for an isoscalar quadrupole response.\n\nTo solve for the excitation energies, we convert the QRPA equation into a standard eigenvalue problem. Define the metric matrix\n$$\n\\mathcal{S} = \\mathrm{diag}(\\underbrace{1,\\dots,1}_{N},\\underbrace{-1,\\dots,-1}_{N}),\n$$\nand the QRPA block matrix\n$$\n\\mathcal{M} = \\begin{pmatrix}\nA & B \\\\\n- B & - A\n\\end{pmatrix}.\n$$\nMultiplying the QRPA equation on the left by $\\mathcal{S}$ yields\n$$\n\\mathcal{S}\\,\\mathcal{M}\\,\\mathbf{Z} = \\omega\\,\\mathbf{Z},\n$$\nwhere $\\mathbf{Z}$ stacks the amplitudes $\\mathbf{X}$ and $\\mathbf{Y}$. The matrix\n$$\n\\mathcal{H} \\equiv \\mathcal{S}\\,\\mathcal{M} = \\begin{pmatrix}\nA & B \\\\\nB & A\n\\end{pmatrix}\n$$\nhas a symmetric block structure in this simplified setting. Under stability (which we ensure by using modest coupling strengths), the eigenvalues of $\\mathcal{H}$ come in $\\pm \\omega$ pairs, and the physical excitation energies are the positive eigenvalues $\\omega>0$. The collection of positive eigenvalues comprises the QRPA spectrum for the chosen multipolarity, and we identify the lowest positive eigenvalue as the low-lying $2^{+}$ energy and the largest positive eigenvalue as the giant quadrupole resonance (GQR) energy.\n\nAlgorithmic steps implemented in the program:\n1. For each test case, construct the diagonal matrix $E = \\mathrm{diag}(\\boldsymbol{\\epsilon})$ from the given two–quasiparticle energies $\\boldsymbol{\\epsilon}$ in megaelectronvolts, and form the rank-one matrix $\\mathbf{q}\\,\\mathbf{q}^{\\mathrm{T}}$ from the given amplitudes $\\mathbf{q}$.\n2. Build $A$ and $B$ using the toggled channel contributions:\n   - If the particle–hole channel is on, add $\\kappa_{\\mathrm{ph}}\\,\\mathbf{q}\\,\\mathbf{q}^{\\mathrm{T}}$ to $A$ and to $B$.\n   - If the particle–particle/hole–hole channel is on, add $\\kappa_{\\mathrm{pp}}\\,\\mathbf{q}\\,\\mathbf{q}^{\\mathrm{T}}$ to $A$ and subtract $\\kappa_{\\mathrm{pp}}\\,\\mathbf{q}\\,\\mathbf{q}^{\\mathrm{T}}$ from $B$.\n   - Always include $E$ in $A$.\n3. Form the $2N \\times 2N$ matrix $\\mathcal{H} = \\begin{pmatrix} A & B \\\\ B & A \\end{pmatrix}$ by applying the metric transformation $\\mathcal{H} = \\mathcal{S}\\,\\mathcal{M}$.\n4. Compute all eigenvalues of $\\mathcal{H}$ and select those with positive real part (nonnegative within a small numerical tolerance) as the QRPA excitation energies in megaelectronvolts. Sort them ascending, extract the smallest and largest values as $E_{2^{+}}$ and $E_{\\mathrm{GQR}}$, respectively.\n5. Round $E_{2^{+}}$ and $E_{\\mathrm{GQR}}$ to three decimal places for reporting.\n\nThe test suite contains four cases with $N=5$, $\\boldsymbol{\\epsilon} = [\\,1.8,\\,2.4,\\,3.0,\\,6.5,\\,10.0\\,]$ MeV, and $\\mathbf{q} = [\\,1.0,\\,0.85,\\,0.70,\\,0.40,\\,0.20\\,]$. Cases toggle channels to isolate their impact:\n- Case A includes both channels with $\\kappa_{\\mathrm{ph}} = 0.150$ MeV and $\\kappa_{\\mathrm{pp}} = 0.080$ MeV, expected to yield collective mixing that lowers the lowest state and pushes the GQR higher relative to the diagonal limit.\n- Case B turns off the particle–particle/hole–hole channel, isolating the particle–hole contribution; the lowest state typically remains lowered, but the balance of coherence differs, altering both ends of the spectrum compared to Case A.\n- Case C turns off the particle–hole channel, leaving only the particle–particle/hole–hole channel; the sign difference in the $B$ block tends to modify collectivity differently, resulting in distinctive shifts.\n- Case D turns off both channels, giving a diagonal limit where the QRPA positive energies coincide with the two–quasiparticle energies $\\boldsymbol{\\epsilon}$, so the low-lying energy is the minimum of $\\boldsymbol{\\epsilon}$ and the GQR is the maximum of $\\boldsymbol{\\epsilon}$.\n\nThe program implements the above steps and prints a single line containing a list of four inner lists, one per test case, each inner list containing $[E_{2^{+}}, E_{\\mathrm{GQR}}]$ in megaelectronvolts and rounded to three decimals, in the specified format.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef qrpa_spectrum(eps, q, k_ph, k_pp, ph_on=True, pp_on=True, tol=1e-8):\n    \"\"\"\n    Compute QRPA positive excitation energies (in MeV) for a separable model\n    with toggled particle-hole (ph) and particle-particle/hole-hole (pp/hh) channels.\n\n    Parameters:\n    - eps: array-like, two-quasiparticle energies (MeV), length N\n    - q: array-like, dimensionless quadrupole amplitudes, length N\n    - k_ph: float, coupling strength for particle-hole channel (MeV)\n    - k_pp: float, coupling strength for particle-particle/hole-hole channel (MeV)\n    - ph_on: bool, toggle particle-hole residual interaction\n    - pp_on: bool, toggle particle-particle/hole-hole residual interaction\n    - tol: float, numerical tolerance for selecting positive eigenvalues\n\n    Returns:\n    - pos_eigs_sorted: numpy array of positive eigenvalues (MeV), sorted ascending\n    \"\"\"\n    eps = np.asarray(eps, dtype=float)\n    q = np.asarray(q, dtype=float)\n    N = eps.size\n\n    # Diagonal two-quasiparticle energies matrix\n    E = np.diag(eps)\n\n    # Rank-one separable form\n    QQ = np.outer(q, q)\n\n    # Build A and B according to toggles and sign structure\n    A = E.copy()\n    B = np.zeros((N, N), dtype=float)\n\n    if ph_on:\n        A += k_ph * QQ\n        B += k_ph * QQ\n    if pp_on:\n        A += k_pp * QQ\n        B -= k_pp * QQ\n\n    # Construct H = S M = [[A, B], [B, A]]\n    H = np.block([[A, B],\n                  [B, A]])\n\n    # Compute eigenvalues\n    evals = np.linalg.eigvals(H)\n\n    # Keep positive real parts (discard tiny imaginary residuals)\n    # Use real parts and filter by > tol\n    evals_real = np.real(evals)\n    pos_eigs = evals_real[evals_real > tol]\n\n    # Sort ascending\n    pos_eigs_sorted = np.sort(pos_eigs)\n    return pos_eigs_sorted\n\ndef compute_case(eps, q, k_ph, k_pp, ph_on, pp_on):\n    \"\"\"\n    Compute [E_2plus, E_GQR] for one case, rounded to 3 decimals.\n    \"\"\"\n    pos_eigs = qrpa_spectrum(eps, q, k_ph, k_pp, ph_on, pp_on)\n    # Low-lying 2+ energy: smallest positive eigenvalue\n    E2 = float(pos_eigs[0])\n    # Giant quadrupole resonance energy: largest positive eigenvalue\n    EGQR = float(pos_eigs[-1])\n    # Round to 3 decimals\n    E2_r = round(E2, 3)\n    EGQR_r = round(EGQR, 3)\n    return [E2_r, EGQR_r]\n\ndef solve():\n    # Define the test cases from the problem statement.\n    eps = [1.8, 2.4, 3.0, 6.5, 10.0]  # MeV\n    q = [1.0, 0.85, 0.70, 0.40, 0.20]  # dimensionless\n    k_ph = 0.150  # MeV\n    k_pp = 0.080  # MeV\n\n    test_cases = [\n        # Case A: both channels on\n        {\"eps\": eps, \"q\": q, \"k_ph\": k_ph, \"k_pp\": k_pp, \"ph_on\": True,  \"pp_on\": True},\n        # Case B: pp/hh off\n        {\"eps\": eps, \"q\": q, \"k_ph\": k_ph, \"k_pp\": k_pp, \"ph_on\": True,  \"pp_on\": False},\n        # Case C: ph off\n        {\"eps\": eps, \"q\": q, \"k_ph\": k_ph, \"k_pp\": k_pp, \"ph_on\": False, \"pp_on\": True},\n        # Case D: both channels off (diagonal limit)\n        {\"eps\": eps, \"q\": q, \"k_ph\": k_ph, \"k_pp\": k_pp, \"ph_on\": False, \"pp_on\": False},\n    ]\n\n    results = []\n    for case in test_cases:\n        result = compute_case(\n            case[\"eps\"], case[\"q\"], case[\"k_ph\"], case[\"k_pp\"],\n            case[\"ph_on\"], case[\"pp_on\"]\n        )\n        results.append(result)\n\n    # Format as single-line Python-style list of lists, with floats rounded to 3 decimals.\n    # Ensure exact required format.\n    inner_strs = []\n    for pair in results:\n        inner_strs.append(f\"[{pair[0]},{pair[1]}]\")\n    print(f\"[{','.join(inner_strs)}]\")\n\nsolve()\n```", "id": "3585349"}]}