{"hands_on_practices": [{"introduction": "To build a solid foundation, we begin with a 'pencil-and-paper' exercise that dissects the Strutinsky method using a simplified, schematic model. By calculating the shell correction for an equidistant spectrum, you will gain direct insight into how the smoothing procedure isolates the oscillating part of the energy from the smooth, liquid-drop-like background [@problem_id:3593400]. This practice also demonstrates a key success of the method: its ability to correctly yield a vanishing shell correction for systems with high symmetry, such as the harmonic oscillator.", "problem": "Consider a mean-field model in computational nuclear physics where the single-particle spectrum is a schematic set of equally spaced levels given by $\\,\\epsilon_{i} = i\\,\\hbar\\omega\\,$ for $\\,i = 1, 2, \\dots\\,$, with a constant degeneracy $\\,g\\,$ per level. Assume a closed shell occupies exactly $\\,M\\,$ levels, so that the particle number is $\\,N = g\\,M\\,$. The Strutinsky shell correction method defines the shell correction energy as $\\,\\delta E = E - \\tilde{E}\\,$, where $\\,E\\,$ is the discrete sum of occupied single-particle energies and $\\,\\tilde{E}\\,$ is the corresponding smoothed energy obtained by replacing the discrete level density with a Strutinsky-smoothed level density. Use the following physically realistic setting:\n- The smoothing kernel is a Gaussian with width $\\,\\gamma\\,$ and a curvature-correction polynomial of even order $\\,p \\geq 2\\,$, chosen such that polynomials up to degree at least $\\,2\\,$ in energy are preserved by smoothing.\n- The smoothing width satisfies $\\,\\gamma/(\\hbar\\omega) \\gg 1\\,$, so that oscillatory contributions of period $\\,\\hbar\\omega\\,$ are exponentially suppressed and the smoothed level density tends to a constant plateau on the energy scale of interest.\n\nUnder these assumptions, derive from first principles the closed-form expression for the shell correction $\\,\\delta E\\,$ for this schematic spectrum. Then, analyze qualitatively and quantitatively why, under exact harmonic-oscillator symmetry with single-particle energies $\\,\\epsilon_{i}^{\\mathrm{HO}} = (i + \\tfrac{1}{2})\\,\\hbar\\omega\\,$ for $\\,i = 0, 1, \\dots\\,$, the shell correction $\\,\\delta E\\,$ for a closed shell tends to vanish within the Strutinsky framework when $\\,\\gamma/(\\hbar\\omega) \\gg 1\\,$ and the curvature-correction order is sufficient to preserve the polynomial average. Finally, compare the resulting shell correction $\\,\\delta E\\,$ in the schematic equidistant case to the smoothed energy $\\,\\tilde{E}\\,$ you have obtained.\n\nExpress your final results as dimensionless quantities by reporting the pair $\\,\\delta E/(g\\,\\hbar\\omega)\\,$ and $\\,\\tilde{E}/(g\\,\\hbar\\omega)\\,$ as a single two-entry row matrix. Do not substitute numerical values. No rounding is required.", "solution": "The problem asks for the derivation of the Strutinsky shell correction energy, $\\delta E$, for a schematic model of equally spaced nuclear single-particle levels. Additionally, it requires an analysis of why this correction tends to zero for the harmonic oscillator potential and a comparison of the schematic model's shell correction $\\delta E$ with its smoothed energy $\\tilde{E}$.\n\nFirst, we address the schematic model where single-particle energies are given by $\\epsilon_{i} = i\\,\\hbar\\omega\\,$ for $\\,i = 1, 2, \\dots\\,$, with a constant degeneracy $g$ for each level. A closed shell is formed by filling the lowest $M$ levels completely.\n\nThe total number of particles is $N = gM$.\n\nThe total discrete energy $E$ is the sum of the energies of all occupied single-particle states:\n$$\nE = \\sum_{i=1}^{M} g\\,\\epsilon_{i} = g \\sum_{i=1}^{M} i\\,\\hbar\\omega\n$$\nUsing the formula for the sum of the first $M$ integers, $\\sum_{i=1}^{M} i = \\frac{M(M+1)}{2}$, we get:\n$$\nE = g\\,\\hbar\\omega\\,\\frac{M(M+1)}{2}\n$$\n\nNext, we determine the smoothed energy $\\tilde{E}$. This requires the smoothed level density, $\\tilde{g}(\\epsilon)$. The discrete level density is a series of delta functions: $g_{\\text{discrete}}(\\epsilon) = g \\sum_{i=1}^{\\infty} \\delta(\\epsilon - i\\,\\hbar\\omega)$. The Strutinsky smoothing procedure, in the limit where the smoothing width $\\gamma$ is much larger than the level spacing $\\hbar\\omega$ ($\\gamma/(\\hbar\\omega) \\gg 1$), averages this discrete distribution. For uniformly spaced levels, the average number of levels up to an energy $\\epsilon$ is $\\epsilon/(\\hbar\\omega)$. With a degeneracy of $g$, the average number of states is $\\tilde{N}(\\epsilon) = g\\epsilon/(\\hbar\\omega)$. The smoothed level density is the derivative of this with respect to energy:\n$$\n\\tilde{g}(\\epsilon) = \\frac{d\\tilde{N}(\\epsilon)}{d\\epsilon} = \\frac{g}{\\hbar\\omega}\n$$\nThis is a constant, i.e., a polynomial of degree $0$. The problem states that the smoothing procedure preserves polynomials up to degree at least $2$, so this choice for $\\tilde{g}(\\epsilon)$ is consistent.\n\nThe smoothed energy $\\tilde{E}$ is calculated by integrating $\\epsilon\\,\\tilde{g}(\\epsilon)$ up to a smoothed Fermi energy, which we denote by $\\lambda$. This Fermi energy $\\lambda$ is determined by conserving the particle number $N$:\n$$\nN = \\int_{0}^{\\lambda} \\tilde{g}(\\epsilon)\\,d\\epsilon = \\int_{0}^{\\lambda} \\frac{g}{\\hbar\\omega}\\,d\\epsilon = \\frac{g}{\\hbar\\omega}\\,\\lambda\n$$\nSince $N=gM$, we find the smoothed Fermi energy to be:\n$$\n\\lambda = M\\,\\hbar\\omega\n$$\nNow we can compute the smoothed energy $\\tilde{E}$:\n$$\n\\tilde{E} = \\int_{0}^{\\lambda} \\epsilon\\,\\tilde{g}(\\epsilon)\\,d\\epsilon = \\int_{0}^{M\\,\\hbar\\omega} \\epsilon\\,\\frac{g}{\\hbar\\omega}\\,d\\epsilon = \\frac{g}{\\hbar\\omega} \\left[ \\frac{\\epsilon^2}{2} \\right]_{0}^{M\\,\\hbar\\omega}\n$$\n$$\n\\tilde{E} = \\frac{g}{\\hbar\\omega} \\frac{(M\\,\\hbar\\omega)^2}{2} = \\frac{g\\,\\hbar\\omega\\,M^2}{2}\n$$\nThe shell correction energy $\\delta E$ is defined as the difference between the discrete and smoothed energies:\n$$\n\\delta E = E - \\tilde{E} = g\\,\\hbar\\omega\\,\\frac{M(M+1)}{2} - \\frac{g\\,\\hbar\\omega\\,M^2}{2}\n$$\n$$\n\\delta E = \\frac{g\\,\\hbar\\omega}{2} (M^2 + M - M^2) = \\frac{g\\,\\hbar\\omega\\,M}{2}\n$$\n\nSecond, we analyze the case of the three-dimensional isotropic harmonic oscillator (HO), with single-particle energies $\\epsilon_i^{\\mathrm{HO}} = (i + \\tfrac{3}{2})\\hbar\\omega$ (using a common convention) or $\\epsilon_i^{\\mathrm{HO}} = (i + \\tfrac{1}{2})\\hbar\\omega$ as given, for $i=0, 1, 2, \\dots$. The latter corresponds to a one-dimensional HO, but the argument holds for any dimension. Let's use the given energies $\\epsilon_i^{\\mathrm{HO}} = (i + \\tfrac{1}{2})\\hbar\\omega$. The degeneracy of level $i$ in a 3D HO is $g_i = (i+1)(i+2)$. The Strutinsky method is designed to separate the total single-particle energy into a smoothly varying part $\\tilde{E}$, identified with the liquid drop model energy, and an oscillating part $\\delta E$, the shell correction.\nThe average number of states up to quantum number $I$ is $\\tilde{N}(I) = \\sum_{i=0}^I g_i = \\sum_{i=0}^I (i+1)(i+2) = \\frac{(I+1)(I+2)(I+3)}{3}$. Expressing $I$ in terms of energy $\\epsilon$, $I \\approx \\epsilon/(\\hbar\\omega)$, we see that $\\tilde{N}(\\epsilon)$ is a cubic polynomial in $\\epsilon$. Consequently, the smoothed level density $\\tilde{g}(\\epsilon) = d\\tilde{N}(\\epsilon)/d\\epsilon$ is a quadratic polynomial in $\\epsilon$. The problem specifies that the smoothing procedure is constructed to preserve polynomials up to at least degree $2$.\nDue to the high degree of symmetry of the HO potential, the exact sum of single-particle energies $E = \\sum g_i \\epsilon_i$ at shell closures is not an oscillating function of particle number but rather a smooth polynomial function. The smoothed energy $\\tilde{E}$ is, by construction of the Strutinsky method, the best possible smooth polynomial approximation to $E$. Since $E$ itself is already a smooth polynomial for closed shells matching the degree that $\\tilde{E}$ is designed to capture, the method yields $\\tilde{E} \\approx E$. Therefore, the shell correction $\\delta E = E - \\tilde{E}$ must be close to zero for closed shells in a pure harmonic oscillator potential. This vanishing is a key test and feature of the Strutinsky method, confirming that it correctly isolates non-smooth, oscillating contributions to the energy.\n\nFinally, we compare the shell correction $\\delta E$ to the smoothed energy $\\tilde{E}$ for the original schematic model. We found:\n$$\n\\delta E = \\frac{g\\,\\hbar\\omega\\,M}{2}\n$$\n$$\n\\tilde{E} = \\frac{g\\,\\hbar\\omega\\,M^2}{2}\n$$\nThe ratio of the shell correction to the smoothed energy is:\n$$\n\\frac{\\delta E}{\\tilde{E}} = \\frac{g\\,\\hbar\\omega\\,M/2}{g\\,\\hbar\\omega\\,M^2/2} = \\frac{1}{M}\n$$\nFor any reasonably heavy nucleus, the number of filled shells $M$ is large, so the shell correction energy $\\delta E$ is a small fraction of the total smoothed energy $\\tilde{E}$. This is consistent with the physical picture where shell effects are a relatively small, albeit crucial, modulation on top of the bulk energy described by the liquid drop model.\n\nThe problem requests the final results for the schematic model as a pair of dimensionless quantities, $\\delta E/(g\\,\\hbar\\omega)$ and $\\tilde{E}/(g\\,\\hbar\\omega)$.\n$$\n\\frac{\\delta E}{g\\,\\hbar\\omega} = \\frac{g\\,\\hbar\\omega\\,M/2}{g\\,\\hbar\\omega} = \\frac{M}{2}\n$$\n$$\n\\frac{\\tilde{E}}{g\\,\\hbar\\omega} = \\frac{g\\,\\hbar\\omega\\,M^2/2}{g\\,\\hbar\\omega} = \\frac{M^2}{2}\n$$\nThese two results are to be provided in a two-entry row matrix.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{M}{2}  \\frac{M^2}{2}\n\\end{pmatrix}\n}\n$$", "id": "3593400"}, {"introduction": "A key test of any physical model's robustness is its behavior under changes in the coordinate system. This practice challenges you to prove a fundamental property of the Strutinsky shell correction: its proper covariance under an affine transformation of the energy scale, meaning a shift and a rescaling [@problem_id:3593345]. Successfully completing this derivation demonstrates that the shell correction is independent of the arbitrary choice of energy zero-point and only scales with the energy unit, confirming its physical soundness.", "problem": "You are implementing the Strutinsky shell correction method in a computational nuclear physics code for a finite single-particle spectrum. Let the discrete single-particle energies be $\\{\\epsilon_{i}\\}_{i=1}^{\\infty}$, and let the lowest $N$ levels be occupied, where $N \\in \\mathbb{N}$. Adopt the standard Strutinsky smoothing with Gaussian folding and curvature correction of order $M \\in \\mathbb{N}$, characterized by a kernel $K_{M}(x)$ and smoothing width $\\gamma  0$, such that the smoothed level density is\n$$\ng_{\\text{sm}}(\\epsilon;\\gamma,M) \\equiv \\sum_{i=1}^{\\infty} \\frac{1}{\\gamma}\\,K_{M}\\!\\left(\\frac{\\epsilon-\\epsilon_{i}}{\\gamma}\\right).\n$$\nAssume the following fundamental properties of the kernel hold: (i) normalization $\\int_{-\\infty}^{\\infty} K_{M}(x)\\,dx = 1$, (ii) evenness $K_{M}(-x)=K_{M}(x)$, (iii) moment-cancellation up to order $2M$ that enforces the Strutinsky curvature correction, and (iv) the scale-invariance structure $K_{M}$ depends on $\\epsilon$ only through $(\\epsilon-\\epsilon_{i})/\\gamma$. Define the smoothed particle number for a chemical potential $\\lambda$ by\n$$\n\\mathcal{N}(\\lambda;\\gamma,M) \\equiv \\int_{-\\infty}^{\\lambda} g_{\\text{sm}}(\\epsilon;\\gamma,M)\\,d\\epsilon,\n$$\nand let $\\lambda(\\gamma)$ be fixed by the particle-number condition $\\mathcal{N}(\\lambda(\\gamma);\\gamma,M)=N$. Define the smoothed energy\n$$\nE_{\\text{sm}}(\\gamma) \\equiv \\int_{-\\infty}^{\\lambda(\\gamma)} \\epsilon\\, g_{\\text{sm}}(\\epsilon;\\gamma,M)\\, d\\epsilon,\n$$\nand the Strutinsky shell correction energy\n$$\nE_{\\text{shell}}(\\gamma) \\equiv \\sum_{i=1}^{N} \\epsilon_{i} - E_{\\text{sm}}(\\gamma).\n$$\nNow consider an affine transformation of the single-particle energy scale,\n$$\n\\epsilon \\mapsto \\epsilon' \\equiv a\\,\\epsilon + b,\n$$\nwith $a0$ and $b \\in \\mathbb{R}$. Construct the primed spectrum $\\{\\epsilon_{i}'\\}$ with the same occupancies, and define the primed smoothed level density $g_{\\text{sm}}'(\\epsilon';\\gamma',M)$ using the same kernel $K_{M}$ but with a rescaled smoothing width $\\gamma' \\equiv a\\,\\gamma$. Define $\\lambda'(\\gamma')$ by the primed particle-number condition and the corresponding primed smoothed energy $E_{\\text{sm}}'(\\gamma')$ and shell correction $E_{\\text{shell}}'(\\gamma')$ analogously to the unprimed definitions.\n\nStarting from these definitions and the stated kernel properties alone, and without assuming any additional specific form of $K_{M}$, derive a closed-form expression for\n$$\n\\Delta(a,b,\\gamma) \\equiv E_{\\text{shell}}'(\\gamma') - a\\, E_{\\text{shell}}(\\gamma),\n$$\nand simplify it as far as possible. Your final answer must be a single real-valued constant or a single analytic expression. No numerical evaluation is required. State your final answer as an explicit expression for $\\Delta(a,b,\\gamma)$. Do not include units.", "solution": "The problem is to derive a closed-form expression for $\\Delta(a,b,\\gamma) \\equiv E_{\\text{shell}}'(\\gamma') - a\\, E_{\\text{shell}}(\\gamma)$.\n\nFirst, we write out the definitions for the shell correction energies. The unprimed shell correction is given by\n$$\nE_{\\text{shell}}(\\gamma) \\equiv \\sum_{i=1}^{N} \\epsilon_{i} - E_{\\text{sm}}(\\gamma).\n$$\nThe primed shell correction is defined analogously for the primed spectrum $\\{\\epsilon_i' = a\\epsilon_i + b\\}$ and primed smoothing width $\\gamma' = a\\gamma$:\n$$\nE_{\\text{shell}}'(\\gamma') \\equiv \\sum_{i=1}^{N} \\epsilon_{i}' - E_{\\text{sm}}'(\\gamma').\n$$\nNow, substitute these definitions into the expression for $\\Delta(a,b,\\gamma)$:\n$$\n\\Delta(a,b,\\gamma) = \\left( \\sum_{i=1}^{N} \\epsilon_{i}' - E_{\\text{sm}}'(\\gamma') \\right) - a \\left( \\sum_{i=1}^{N} \\epsilon_{i} - E_{\\text{sm}}(\\gamma) \\right).\n$$\nLet's analyze the sum over the discrete primed energies. Using the affine transformation $\\epsilon_i' = a\\epsilon_i + b$:\n$$\n\\sum_{i=1}^{N} \\epsilon_{i}' = \\sum_{i=1}^{N} (a\\epsilon_{i} + b) = a \\left( \\sum_{i=1}^{N} \\epsilon_{i} \\right) + \\sum_{i=1}^{N} b = a \\sum_{i=1}^{N} \\epsilon_{i} + N b.\n$$\nSubstituting this into the expression for $\\Delta(a,b,\\gamma)$:\n$$\n\\Delta(a,b,\\gamma) = \\left( a \\sum_{i=1}^{N} \\epsilon_{i} + N b - E_{\\text{sm}}'(\\gamma') \\right) - a \\sum_{i=1}^{N} \\epsilon_{i} + a E_{\\text{sm}}(\\gamma).\n$$\nThe terms involving the sum over discrete energies cancel out:\n$$\n\\Delta(a,b,\\gamma) = N b - E_{\\text{sm}}'(\\gamma') + a E_{\\text{sm}}(\\gamma).\n$$\nTo proceed, we must find a relationship between the primed smoothed energy $E_{\\text{sm}}'(\\gamma')$ and the unprimed one $E_{\\text{sm}}(\\gamma)$. This requires us to first relate the primed and unprimed smoothed level densities, $g_{\\text{sm}}'$ and $g_{\\text{sm}}$.\n\nThe primed smoothed level density is defined as:\n$$\ng_{\\text{sm}}'(\\epsilon';\\gamma',M) = \\sum_{i=1}^{\\infty} \\frac{1}{\\gamma'}\\,K_{M}\\!\\left(\\frac{\\epsilon'-\\epsilon_{i}'}{\\gamma'}\\right).\n$$\nSubstitute $\\gamma' = a\\gamma$ and $\\epsilon_i' = a\\epsilon_i + b$:\n$$\ng_{\\text{sm}}'(\\epsilon'; a\\gamma, M) = \\sum_{i=1}^{\\infty} \\frac{1}{a\\gamma}\\,K_{M}\\!\\left(\\frac{\\epsilon' - (a\\epsilon_{i} + b)}{a\\gamma}\\right).\n$$\nLet's evaluate this at an energy $\\epsilon'$ corresponding to an original energy $\\epsilon$ under the transformation, i.e., $\\epsilon' = a\\epsilon + b$.\n$$\ng_{\\text{sm}}'(a\\epsilon+b; a\\gamma, M) = \\sum_{i=1}^{\\infty} \\frac{1}{a\\gamma}\\,K_{M}\\!\\left(\\frac{(a\\epsilon+b) - (a\\epsilon_{i} + b)}{a\\gamma}\\right) = \\sum_{i=1}^{\\infty} \\frac{1}{a\\gamma}\\,K_{M}\\!\\left(\\frac{a(\\epsilon - \\epsilon_{i})}{a\\gamma}\\right).\n$$\nThis simplifies to:\n$$\ng_{\\text{sm}}'(a\\epsilon+b; a\\gamma, M) = \\frac{1}{a} \\sum_{i=1}^{\\infty} \\frac{1}{\\gamma}\\,K_{M}\\!\\left(\\frac{\\epsilon - \\epsilon_{i}}{\\gamma}\\right) = \\frac{1}{a} g_{\\text{sm}}(\\epsilon;\\gamma,M).\n$$\nThis gives the key relationship between the level densities: $g_{\\text{sm}}'(a\\epsilon+b) = \\frac{1}{a} g_{\\text{sm}}(\\epsilon)$.\n\nNext, we relate the primed and unprimed chemical potentials, $\\lambda'(\\gamma')$ and $\\lambda(\\gamma)$, using the particle-number condition. The unprimed condition is $\\mathcal{N}(\\lambda(\\gamma);\\gamma,M) = N$, where\n$$\n\\mathcal{N}(\\lambda) = \\int_{-\\infty}^{\\lambda} g_{\\text{sm}}(\\epsilon;\\gamma,M)\\,d\\epsilon.\n$$\nThe primed condition is $\\mathcal{N}'(\\lambda'(\\gamma');\\gamma',M) = N$, where\n$$\n\\mathcal{N}'(\\lambda') = \\int_{-\\infty}^{\\lambda'} g_{\\text{sm}}'(\\epsilon';\\gamma',M)\\,d\\epsilon'.\n$$\nLet's transform the integral for $\\mathcal{N}'(\\lambda')$ using the change of variables $\\epsilon' = a\\epsilon + b$. This implies $d\\epsilon' = a\\,d\\epsilon$, since $a$ is a constant. The lower integration limit remains $-\\infty$ (as $a0$), and the upper limit $\\lambda'$ corresponds to $\\epsilon = (\\lambda' - b)/a$.\n$$\n\\mathcal{N}'(\\lambda') = \\int_{-\\infty}^{(\\lambda'-b)/a} g_{\\text{sm}}'(a\\epsilon+b; a\\gamma, M) \\, (a\\,d\\epsilon).\n$$\nUsing the relationship $g_{\\text{sm}}'(a\\epsilon+b) = \\frac{1}{a} g_{\\text{sm}}(\\epsilon)$, we get:\n$$\n\\mathcal{N}'(\\lambda') = \\int_{-\\infty}^{(\\lambda'-b)/a} \\left(\\frac{1}{a} g_{\\text{sm}}(\\epsilon;\\gamma,M)\\right) (a\\,d\\epsilon) = \\int_{-\\infty}^{(\\lambda'-b)/a} g_{\\text{sm}}(\\epsilon;\\gamma,M)\\,d\\epsilon = \\mathcal{N}\\left(\\frac{\\lambda'-b}{a}\\right).\n$$\nThe particle number conditions are $\\mathcal{N}'(\\lambda'(\\gamma'))=N$ and $\\mathcal{N}(\\lambda(\\gamma))=N$. Therefore, we have $\\mathcal{N}(\\frac{\\lambda'(\\gamma')-b}{a}) = N$. Assuming the smoothed particle number $\\mathcal{N}$ is a strictly increasing function of its argument (which it is, as $g_{\\text{sm}}$ is non-negative), we can equate the arguments:\n$$\n\\frac{\\lambda'(\\gamma')-b}{a} = \\lambda(\\gamma) \\implies \\lambda'(\\gamma') = a\\,\\lambda(\\gamma) + b.\n$$\nThe chemical potential transforms under the same affine map as the energy levels.\n\nFinally, we can relate the smoothed energies. The primed smoothed energy is:\n$$\nE_{\\text{sm}}'(\\gamma') = \\int_{-\\infty}^{\\lambda'(\\gamma')} \\epsilon'\\, g_{\\text{sm}}'(\\epsilon';\\gamma',M)\\, d\\epsilon'.\n$$\nWe apply the same change of variables, $\\epsilon' = a\\epsilon + b$, so $d\\epsilon' = a\\,d\\epsilon$. The upper limit of integration $\\lambda'(\\gamma')$ becomes $\\lambda(\\gamma)$ in the $\\epsilon$ coordinate system.\n$$\nE_{\\text{sm}}'(\\gamma') = \\int_{-\\infty}^{\\lambda(\\gamma)} (a\\epsilon+b) \\, g_{\\text{sm}}'(a\\epsilon+b; a\\gamma, M) \\, (a\\,d\\epsilon).\n$$\nSubstituting $g_{\\text{sm}}'(a\\epsilon+b) = \\frac{1}{a} g_{\\text{sm}}(\\epsilon)$:\n$$\nE_{\\text{sm}}'(\\gamma') = \\int_{-\\infty}^{\\lambda(\\gamma)} (a\\epsilon+b) \\left(\\frac{1}{a} g_{\\text{sm}}(\\epsilon;\\gamma,M)\\right) (a\\,d\\epsilon) = \\int_{-\\infty}^{\\lambda(\\gamma)} (a\\epsilon+b) \\, g_{\\text{sm}}(\\epsilon;\\gamma,M) \\, d\\epsilon.\n$$\nWe can split this integral into two parts:\n$$\nE_{\\text{sm}}'(\\gamma') = a \\int_{-\\infty}^{\\lambda(\\gamma)} \\epsilon \\, g_{\\text{sm}}(\\epsilon;\\gamma,M) \\, d\\epsilon + b \\int_{-\\infty}^{\\lambda(\\gamma)} g_{\\text{sm}}(\\epsilon;\\gamma,M) \\, d\\epsilon.\n$$\nThe first integral is the definition of the unprimed smoothed energy, $E_{\\text{sm}}(\\gamma)$. The second integral is the definition of the unprimed smoothed particle number, $\\mathcal{N}(\\lambda(\\gamma);\\gamma,M)$, which is constrained to be $N$.\nThus, we obtain the relationship:\n$$\nE_{\\text{sm}}'(\\gamma') = a\\,E_{\\text{sm}}(\\gamma) + bN.\n$$\nNow we substitute this result back into our expression for $\\Delta(a,b,\\gamma)$:\n$$\n\\Delta(a,b,\\gamma) = N b - E_{\\text{sm}}'(\\gamma') + a E_{\\text{sm}}(\\gamma) = N b - (a\\,E_{\\text{sm}}(\\gamma) + bN) + a E_{\\text{sm}}(\\gamma).\n$$\nSimplifying the expression reveals that all terms cancel:\n$$\n\\Delta(a,b,\\gamma) = N b - a\\,E_{\\text{sm}}(\\gamma) - bN + a E_{\\text{sm}}(\\gamma) = 0.\n$$\nThe result is independent of $a$, $b$, $\\gamma$, $N$, and the specific form of the kernel $K_M$, provided the stated properties hold. This implies that the shell correction energy transforms covariantly, $E_{\\text{shell}}'(\\gamma') = a\\,E_{\\text{shell}}(\\gamma)$.", "answer": "$$\n\\boxed{0}\n$$", "id": "3593345"}, {"introduction": "Moving from pure theory to computational practice, we now address the practical limits of the Strutinsky method. The validity of the smoothing procedure hinges on the single-particle spectrum being dense enough relative to the smoothing width $\\gamma$; this condition can fail for light nuclei [@problem_id:3593409]. This coding exercise guides you to implement a numerical test to determine the minimum number of energy levels required to achieve a reliable 'Strutinsky plateau,' providing a quantitative tool to assess the method's applicability.", "problem": "You are to write a complete, runnable program that determines, from first principles, when Strutinsky smoothing fails for light nuclei due to sparse single-particle spectra. Use the following construction rooted in the Strutinsky shell correction method.\n\nFundamental base and definitions. The Strutinsky smoothing of the single-particle level density uses a folding kernel that is the product of a Gaussian of width $\\gamma$ and a curvature-correction polynomial of order $p$. In the standard formulation, the kernel is\n$$\nf_p(x) \\equiv \\frac{1}{\\sqrt{\\pi}} e^{-x^2} L_p^{1/2}(x^2),\n$$\nwhere $L_p^{1/2}$ is the associated Laguerre polynomial of order $p$ and index $1/2$, and $x$ is the energy deviation in units of $\\gamma$. The curvature correction guarantees that the continuous moments of $f_p(x)$ up to order $2p$ reproduce the required constraints,\n$$\n\\int_{-\\infty}^{\\infty} x^m f_p(x)\\,dx =\n\\begin{cases}\n1,  m=0, \\\\\n0,  m=2,4,\\dots,2p, \\\\\n\\text{finite},  \\text{otherwise},\n\\end{cases}\n$$\nensuring that smooth polynomial trends up to degree $2p$ are removed while preserving normalization. In a calculation with discrete levels of constant spacing, the continuous integral is approximated by a discrete sum (a Riemann sum) over levels $E_i$ with spacing $d$ and a Fermi energy set to $E_F=0$ without loss of generality. Introducing the dimensionless spacing $s \\equiv d/\\gamma$ and the grid points $x_i \\equiv i s$ for $i \\in \\mathbb{Z}$, a symmetric $2M+1$-point discrete moment is\n$$\nS_m^{(M)}(s,p) \\equiv s \\sum_{i=-M}^{M} x_i^m f_p(x_i).\n$$\nFor a numerically reliable Strutinsky plateau, the discrete moments must approximate the exact moment constraints to within a given absolute tolerance $\\tau0$. Define the maximal moment error as\n$$\n\\varepsilon_{\\max}(M;s,p) \\equiv \\max\\big\\{ \\, |S_0^{(M)}(s,p)-1|, \\, |S_2^{(M)}(s,p)|, \\, |S_4^{(M)}(s,p)|, \\dots, |S_{2p}^{(M)}(s,p)| \\, \\big\\}.\n$$\nWe say that the minimal symmetric level count $N_{\\min}$ required for a reliable $\\gamma$-plateau is the smallest odd integer $N_{\\min}=2M_{\\min}+1$ such that $\\varepsilon_{\\max}(M_{\\min};s,p) \\le \\tau$.\n\nFinite-spectrum constraint for light nuclei. Light nuclei have few bound single-particle levels around the Fermi energy due to the finite potential well. Model this limitation by specifying two nonnegative energy cutoffs $E_{\\text{left}}$ and $E_{\\text{right}}$ (in megaelectronvolts, MeV), which denote the available energy range to the left and right of the Fermi energy, respectively. With level spacing $d$ (in MeV), the maximal number of levels symmetrically accessible on each side is\n$$\nM_{\\text{left}} \\equiv \\left\\lfloor \\frac{E_{\\text{left}}}{d} \\right\\rfloor, \\quad\nM_{\\text{right}} \\equiv \\left\\lfloor \\frac{E_{\\text{right}}}{d} \\right\\rfloor.\n$$\nA symmetric $2M+1$ point sum requires $M \\le \\min(M_{\\text{left}}, M_{\\text{right}})$. If no $M$ up to this limit yields $\\varepsilon_{\\max}(M;s,p) \\le \\tau$, then the $\\gamma$-plateau is deemed unreliable under the given conditions due to sparse spectra or coarse sampling, and you must report failure.\n\nComputation task. For each test case below, compute $N_{\\min}$ as defined above, using:\n- single-particle level spacing $d$ in MeV,\n- smoothing width $\\gamma$ in MeV,\n- curvature-correction order $p$ (a nonnegative integer),\n- absolute tolerance $\\tau$ (dimensionless),\n- available energy ranges $E_{\\text{left}}$ and $E_{\\text{right}}$ in MeV.\n\nNumerical details to observe:\n- Use the exact analytic form of $f_p(x)$ above with the associated Laguerre polynomial $L_p^{1/2}$.\n- Use the discrete symmetric sum over $i=-M,\\dots,M$ with $x_i = i\\, (d/\\gamma)$.\n- Determine the smallest $M$ satisfying the tolerance across all even moments up to $2p$ as specified.\n- Enforce the finite-spectrum constraint using $M \\le \\min(\\lfloor E_{\\text{left}}/d \\rfloor, \\lfloor E_{\\text{right}}/d \\rfloor)$; if no $M$ up to this limit works, declare failure.\n- Report failure by outputting $-1$ for that test case.\n- The output $N_{\\min}$ is a pure count and therefore unitless.\n\nTest suite. Use the following four parameter sets to exercise different regimes:\n1. Happy path with dense spectrum:\n   - $d=0.25$ MeV, $\\gamma=1.2$ MeV, $p=6$, $\\tau=5 \\times 10^{-3}$, $E_{\\text{left}}=20$ MeV, $E_{\\text{right}}=20$ MeV.\n2. Edge-limited light nucleus:\n   - $d=0.8$ MeV, $\\gamma=1.2$ MeV, $p=6$, $\\tau=5 \\times 10^{-3}$, $E_{\\text{left}}=4$ MeV, $E_{\\text{right}}=6$ MeV.\n3. Coarse sampling with small $\\gamma$:\n   - $d=1.0$ MeV, $\\gamma=0.6$ MeV, $p=8$, $\\tau=10^{-2}$, $E_{\\text{left}}=6$ MeV, $E_{\\text{right}}=6$ MeV.\n4. High curvature-correction order:\n   - $d=0.3$ MeV, $\\gamma=1.2$ MeV, $p=10$, $\\tau=5 \\times 10^{-3}$, $E_{\\text{left}}=8$ MeV, $E_{\\text{right}}=8$ MeV.\n\nFinal output format. Your program should produce a single line of output containing the four results as a comma-separated list enclosed in square brackets (e.g., \"[n1,n2,n3,n4]\"), where each $n_k$ is the integer $N_{\\min}$ for test case $k$, or $-1$ if no reliable $\\gamma$-plateau is possible under the stated constraints. No additional text should be printed. All angles are irrelevant; all energies must be treated in megaelectronvolts (MeV), but the final result is unitless and must be integers as specified.", "solution": "The problem requires the development of a numerical algorithm to determine the minimal number of single-particle levels, $N_{\\min}$, required to obtain a reliable Strutinsky energy correction, subject to physical constraints on the available energy spectrum in light nuclei. The problem is well-posed, scientifically grounded in the principles of computational nuclear physics, and provides all necessary definitions and parameters for a unique, verifiable solution.\n\nThe core of the Strutinsky shell correction method is the smoothing of the discrete single-particle energy level density, $g(E) = \\sum_i \\delta(E-E_i)$, to obtain a smooth level density $\\tilde{g}(E)$. This is achieved by folding the discrete density with a kernel function. The problem defines this kernel as:\n$$\nf_p(x) = \\frac{1}{\\sqrt{\\pi}} e^{-x^2} L_p^{1/2}(x^2)\n$$\nHere, $x = (E-E')/\\gamma$ is the dimensionless energy difference from a central energy $E'$, measured in units of the smoothing width $\\gamma$. The function $L_p^{1/2}$ is the associated Laguerre polynomial of order $p$ and index $1/2$. The inclusion of this polynomial serves as a curvature correction, ensuring that the smoothed reconstruction of any polynomial level density up to degree $2p$ is exact. This property is mathematically guaranteed by the moment constraints on the kernel function:\n$$\n\\int_{-\\infty}^{\\infty} x^m f_p(x)\\,dx =\n\\begin{cases}\n1,  \\text{for } m=0 \\\\\n0,  \\text{for } m=2, 4, \\dots, 2p\n\\end{cases}\n$$\nThe $m=0$ constraint ensures normalization (conservation of particle number), while the constraints for $m0$ ensure the removal of smooth polynomial trends.\n\nIn a numerical calculation, the continuous energy spectrum is replaced by a discrete set of levels $E_i$. For simplicity, the problem models the spectrum as an infinite ladder of uniformly spaced levels with spacing $d$. The Fermi energy is set to $E_F=0$. The continuous integral for the moments is then replaced by a discrete Riemann sum. The problem defines the discrete symmetric moment of order $m$ as:\n$$\nS_m^{(M)}(s,p) = s \\sum_{i=-M}^{M} x_i^m f_p(x_i)\n$$\nwhere $s = d/\\gamma$ is the dimensionless level spacing, and $x_i = i s$ are the discrete, dimensionless energy points. The sum runs over a symmetric set of $2M+1$ levels around the Fermi energy.\n\nA reliable numerical smoothing, known as a Strutinsky plateau, is achieved when the discrete moments $S_m^{(M)}$ are sufficiently close to their ideal continuous values. The problem quantifies this by defining a maximal moment error, $\\varepsilon_{\\max}$, as the largest absolute deviation among all relevant even moments:\n$$\n\\varepsilon_{\\max}(M;s,p) = \\max\\big\\{ \\, |S_0^{(M)}(s,p)-1|, \\, |S_2^{(M)}(s,p)|, \\dots, |S_{2p}^{(M)}(s,p)| \\, \\big\\}\n$$\nThe condition for reliability is that this error must be less than or equal to a prescribed absolute tolerance $\\tau$, i.e., $\\varepsilon_{\\max}(M;s,p) \\le \\tau$. The minimal number of levels required, $N_{\\min}$, is defined as $2M_{\\min}+1$, where $M_{\\min}$ is the smallest non-negative integer $M$ that satisfies this tolerance condition.\n\nA crucial physical constraint, particularly relevant for light nuclei, is the finite depth of the nuclear potential well. This means there is only a finite number of bound single-particle levels. The problem models this by introducing energy cutoffs $E_{\\text{left}}$ and $E_{\\text{right}}$, which limit the range of available levels around the Fermi energy. The maximum number of levels available on the left and right sides of $E_F=0$ are, respectively:\n$$\nM_{\\text{left}} = \\left\\lfloor \\frac{E_{\\text{left}}}{d} \\right\\rfloor, \\quad M_{\\text{right}} = \\left\\lfloor \\frac{E_{\\text{right}}}{d} \\right\\rfloor\n$$\nSince the discrete summation must be symmetric, the effective maximum value for the summation index $M$ is limited by the smaller of these two counts. Let $M_{\\text{max}} = \\min(M_{\\text{left}}, M_{\\text{right}})$. The search for $M_{\\min}$ is thus restricted to the integer range $0 \\le M \\le M_{\\text{max}}$. If the tolerance condition $\\varepsilon_{\\max} \\le \\tau$ cannot be met for any $M$ in this range, it signifies a failure to form a reliable plateau, and the result for that case is reported as $-1$.\n\nThe algorithmic solution proceeds as follows for each test case:\n1.  Read the input parameters: level spacing $d$, smoothing width $\\gamma$, curvature-correction order $p$, tolerance $\\tau$, and energy cutoffs $E_{\\text{left}}$ and $E_{\\text{right}}$.\n2.  Compute the dimensionless spacing $s = d/\\gamma$.\n3.  Compute the maximum allowed summation index $M_{\\text{max}} = \\min(\\lfloor E_{\\text{left}}/d \\rfloor, \\lfloor E_{\\text{right}}/d \\rfloor)$.\n4.  Initialize a search for the minimal qualifying index, $M_{\\min}$. Iterate with $M$ starting from $0$ up to and including $M_{\\text{max}}$.\n5.  For each value of $M$:\n    a.  Compute the set of discrete even moments $\\{ S_m^{(M)} \\}_{m=0,2,\\dots,2p}$. The summation can be optimized by exploiting the symmetry of the kernel, $f_p(x)=f_p(-x)$, and the form of the powers $x_i^m$. For even $m  0$, the sum becomes $S_{m}^{(M)} = 2s \\sum_{i=1}^{M} (is)^m f_p(is)$, and for $m=0$, $S_{0}^{(M)} = s(f_p(0) + 2\\sum_{i=1}^M f_p(is))$. The function $f_p(x)$ is evaluated using its definition, requiring the computation of the associated Laguerre polynomial $L_p^{1/2}(x^2)$.\n    b.  Calculate the maximal moment error $\\varepsilon_{\\max}(M;s,p)$.\n    c.  If $\\varepsilon_{\\max} \\le \\tau$, the current value of $M$ is $M_{\\min}$. Calculate $N_{\\min} = 2M_{\\min}+1$, record this result, and terminate the search for this test case.\n6.  If the loop completes without finding any $M$ that satisfies the tolerance, record the result as $-1$.\n7.  After processing all test cases, format the collected results into the specified output string. This systematic procedure correctly implements all requirements of the problem.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.special import eval_genlaguerre\n\ndef solve():\n    \"\"\"\n    Computes the minimal number of levels for a reliable Strutinsky plateau\n    for a series of test cases, considering finite-spectrum constraints.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (d, gamma, p, tau, E_left, E_right)\n        (0.25, 1.2, 6, 5e-3, 20.0, 20.0),  # Happy path\n        (0.8, 1.2, 6, 5e-3, 4.0, 6.0),    # Edge-limited\n        (1.0, 0.6, 8, 1e-2, 6.0, 6.0),    # Coarse sampling\n        (0.3, 1.2, 10, 5e-3, 8.0, 8.0),   # High curvature-correction\n    ]\n\n    results = []\n    for case in test_cases:\n        result = calculate_n_min(*case)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\ndef f_p(x, p):\n    \"\"\"\n    Calculates the Strutinsky smoothing kernel f_p(x).\n    f_p(x) = (1/sqrt(pi)) * exp(-x^2) * L_p^{1/2}(x^2)\n    \"\"\"\n    x_sq = x**2\n    laguerre_poly = eval_genlaguerre(p, 0.5, x_sq)\n    return (1.0 / np.sqrt(np.pi)) * np.exp(-x_sq) * laguerre_poly\n\ndef calculate_n_min(d, gamma, p, tau, e_left, e_right):\n    \"\"\"\n    Calculates N_min for a single test case.\n    Returns N_min or -1 on failure.\n    \"\"\"\n    s = d / gamma\n    m_left = np.floor(e_left / d)\n    m_right = np.floor(e_right / d)\n    m_max = int(min(m_left, m_right))\n\n    # Moments to check are m = 0, 2, 4, ..., 2p\n    moment_orders = list(range(0, 2 * p + 1, 2))\n\n    for M in range(m_max + 1):\n        errors = []\n\n        # Optimization by pre-calculating values for sum from i=1 to M\n        if M > 0:\n            i_vals = np.arange(1, M + 1)\n            x_vals = i_vals * s\n            f_vals = f_p(x_vals, p)\n        \n        # --- Calculate moment S_0 ---\n        f0 = f_p(0, p)\n        # S_0 = s * (f_p(0) + 2 * sum_{i=1 to M} f_p(i*s))\n        if M > 0:\n          sum_f = np.sum(f_vals)\n          s0 = s * (f0 + 2 * sum_f)\n        else: # M=0 case\n          s0 = s * f0\n        errors.append(abs(s0 - 1.0))\n\n        # --- Calculate moments S_m for m > 0 ---\n        for m in moment_orders[1:]:\n            # S_m = 2s * sum_{i=1 to M} (i*s)^m * f_p(i*s)\n            if M > 0:\n                sm = 2 * s * np.sum((x_vals**m) * f_vals)\n            else: # M=0 case\n                sm = 0.0\n            errors.append(abs(sm))\n\n        max_error = max(errors) if errors else 0.0\n\n        if max_error = tau:\n            return 2 * M + 1\n\n    # If loop finishes without finding a suitable M\n    return -1\n\nsolve()\n```", "id": "3593409"}]}