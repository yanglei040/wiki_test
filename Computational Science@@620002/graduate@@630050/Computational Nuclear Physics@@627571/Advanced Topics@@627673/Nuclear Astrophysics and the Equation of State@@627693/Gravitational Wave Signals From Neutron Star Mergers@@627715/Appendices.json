{"hands_on_practices": [{"introduction": "Before we can dive into the rich physics encoded in gravitational waves from neutron star mergers, we must first understand the fundamental mechanism of their generation. This practice builds that essential foundation, guiding you from the linearized Einstein field equations to the celebrated quadrupole formula for gravitational radiation. By deriving this cornerstone result and applying it to a hypothetical binary system, you will gain a tangible sense of the signal's properties and the incredible instrumental sensitivity required for its detection [@problem_id:3562196].", "problem": "Consider an isolated, slowly moving, spatially compact source in linearized General Relativity (GR) under the Lorenz gauge condition. In the radiation (far) zone, the metric perturbation is treated in the transverse-traceless (TT) gauge. Starting from the retarded Green’s function solution of the linearized Einstein field equations and energy-momentum conservation for a nonrelativistic source, derive the leading-order far-zone expression connecting the TT metric perturbation to the second time derivative of the trace-free mass quadrupole moment evaluated at the retarded time. Clearly define the mass quadrupole moment and the TT projection used.\n\nThen specialize to a quasi-circular equal-mass neutron-star binary with component gravitational masses $m_{1}=m_{2}=1.4\\,M_{\\odot}$. Assume a circular orbit, negligible spin and tidal effects at the quoted frequency, and an optimally oriented source-detector geometry (face-on with respect to the orbital angular momentum). Let the observed gravitational-wave frequency be $f=100\\,\\mathrm{Hz}$, so that the orbital angular frequency satisfies $\\Omega=\\pi f$. Work in geometric units $G=c=1$ throughout. Express the leading-order gravitational-wave strain amplitude in terms of the chirp mass $M_{c}$, the frequency $f$, and the luminosity distance $D$, and then estimate the numerical value of the instantaneous dimensionless strain amplitude for a source at $D=100\\,\\mathrm{Mpc}$.\n\nUse the following numerical conversions consistent with $G=c=1$:\n- $M_{\\odot} = 4.92549095\\times 10^{-6}\\,\\mathrm{s}$,\n- $1\\,\\mathrm{Mpc} = 1.02927125\\times 10^{14}\\,\\mathrm{s}$.\n\nRound your final answer to three significant figures and express it as a dimensionless number (no units).", "solution": "The user wants me to solve a two-part problem concerning gravitational waves in linearized General Relativity. First, I must derive the quadrupole formula. Second, I must apply it to a specific binary neutron star system to compute the gravitational-wave strain amplitude.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n-   **Part 1 (Derivation):**\n    -   Source: Isolated, slowly moving, spatially compact.\n    -   Framework: Linearized General Relativity.\n    -   Gauge: Lorenz gauge ($\\partial_{\\mu}\\bar{h}^{\\mu\\nu}=0$) for the field equations, transverse-traceless (TT) gauge for the far-zone metric perturbation.\n    -   Starting point: Retarded Green's function solution of the linearized Einstein field equations.\n    -   Assumption: Nonrelativistic source with energy-momentum conservation.\n    -   Goal: Derive the expression connecting TT metric perturbation ($h_{ij}^{TT}$) to the second time derivative of the trace-free mass quadrupole moment ($Q_{ij}$) at retarded time.\n\n-   **Part 2 (Application):**\n    -   System: Quasi-circular equal-mass neutron-star binary.\n    -   Component masses: $m_{1} = m_{2} = 1.4\\,M_{\\odot}$.\n    -   Orbit: Circular.\n    -   Assumptions: Negligible spin and tidal effects.\n    -   Geometry: Optimally oriented source-detector (face-on).\n    -   Observed gravitational-wave frequency: $f = 100\\,\\mathrm{Hz}$.\n    -   Orbital angular frequency: $\\Omega = \\pi f$.\n    -   Units: Geometric units ($G=c=1$).\n    -   Luminosity distance: $D = 100\\,\\mathrm{Mpc}$.\n    -   Numerical conversions: $M_{\\odot} = 4.92549095\\times 10^{-6}\\,\\mathrm{s}$, $1\\,\\mathrm{Mpc} = 1.02927125\\times 10^{14}\\,\\mathrm{s}$.\n    -   Final Output: Numerical value of the instantaneous dimensionless strain amplitude, rounded to three significant figures.\n\n**Step 2: Validate Using Extracted Givens**\n1.  **Scientifically Grounded:** The problem is based entirely on the well-established theory of linearized General Relativity and its application to gravitational wave generation from binary systems. The derivation of the quadrupole formula is a cornerstone of gravitational wave theory.\n2.  **Well-Posed:** The problem provides a clear path from fundamental equations to a specific application. All necessary physical parameters, assumptions, and numerical constants are provided. The questions are specific and lead to a unique, meaningful answer.\n3.  **Objective:** The language is formal and precise, with no subjective or ambiguous statements.\n4.  **Self-Contained and Consistent:** The relationship $\\Omega = \\pi f$ is consistent with the fact that the dominant gravitational wave frequency ($f$) from a circular binary is twice the orbital frequency ($f_{orb}$), since $\\Omega = 2\\pi f_{orb}$, which implies $f = 2f_{orb} = \\Omega/\\pi$. The given masses, distance, and frequency are astrophysically plausible for a binary neutron star system in the inspiral phase.\n\n**Step 3: Verdict and Action**\nThe problem is valid. It is a standard, well-posed problem in theoretical astrophysics. I will proceed with the detailed solution.\n\n### Part 1: Derivation of the Quadrupole Formula\n\nWe begin with the linearized Einstein Field Equations in the Lorenz gauge ($\\partial_\\mu \\bar{h}^{\\mu\\nu} = 0$), expressed in geometric units ($G=c=1$):\n$$ \\Box \\bar{h}_{\\mu\\nu} = -16\\pi T_{\\mu\\nu} $$\nwhere $\\Box = -\\partial_t^2 + \\nabla^2$ is the d'Alembert operator, $T_{\\mu\\nu}$ is the energy-momentum tensor of the source, and $\\bar{h}_{\\mu\\nu} = h_{\\mu\\nu} - \\frac{1}{2}\\eta_{\\mu\\nu}h$ is the trace-reversed metric perturbation.\n\nThe solution to this wave equation can be found using the retarded Green's function:\n$$ \\bar{h}_{\\mu\\nu}(t, \\mathbf{x}) = 4 \\int \\frac{T_{\\mu\\nu}(t - |\\mathbf{x}-\\mathbf{x'}|, \\mathbf{x'})}{|\\mathbf{x}-\\mathbf{x'}|} d^3x' $$\nWe consider a detector in the far zone, where its distance $r=|\\mathbf{x}|$ from the source is much larger than the source's size, $|\\mathbf{x'}|$. We can make the following approximations:\n1.  $|\\mathbf{x}-\\mathbf{x'}| \\approx r$ in the denominator.\n2.  $|\\mathbf{x}-\\mathbf{x'}| = \\sqrt{r^2 - 2\\mathbf{x}\\cdot\\mathbf{x'} + r'^2} \\approx r\\sqrt{1-2\\frac{\\mathbf{x}\\cdot\\mathbf{x'}}{r^2}} \\approx r - \\hat{n}\\cdot\\mathbf{x'}$ in the time argument, where $\\hat{n} = \\mathbf{x}/r$ is the direction of observation.\n3.  For a slowly moving source (velocities $v \\ll 1$), changes in the source occur over timescales much longer than the light-crossing time of the source. Thus, we can neglect the term $\\hat{n}\\cdot\\mathbf{x'}$ in the time argument, simplifying it to the retarded time $t_r = t - r$.\n\nWith these approximations, the spatial components of the metric perturbation become:\n$$ \\bar{h}_{ij}(t, \\mathbf{x}) \\approx \\frac{4}{r} \\int T_{ij}(t_r, \\mathbf{x'}) d^3x' $$\nWe need to relate the integral of the stress tensor $T_{ij}$ to the mass distribution. This is achieved using the conservation of energy-momentum, $\\partial_\\mu T^{\\mu\\nu} = 0$. For a non-relativistic source, we use the identity:\n$$ \\frac{d^2}{dt^2} \\int T^{00} x^i x^j d^3x' = 2 \\int T^{ij} d^3x' $$\nIn the non-relativistic limit, the energy density $T^{00}$ is dominated by the mass density $\\rho$. Let's define the second moment of the mass distribution (the mass quadrupole moment tensor) as:\n$$ I_{ij}(t) = \\int \\rho(t, \\mathbf{x'}) x'_i x'_j d^3x' $$\nThen, $\\int T_{ij}(t_r) d^3x' \\approx \\frac{1}{2} \\ddot{I}_{ij}(t_r)$, where the double dot denotes the second time derivative. Substituting this into the expression for $\\bar{h}_{ij}$ gives:\n$$ \\bar{h}_{ij}(t, \\mathbf{x}) \\approx \\frac{2}{r} \\ddot{I}_{ij}(t_r) $$\nThe physically observable gravitational wave strain is the transverse-traceless (TT) part of the metric perturbation, $h_{ij}^{TT}$. The TT projection is achieved using the operator $\\Lambda_{ij,kl}(\\hat{n}) = P_{ik}P_{jl} - \\frac{1}{2}P_{ij}P_{kl}$, where $P_{ij} = \\delta_{ij} - n_i n_j$ is the projector onto the plane transverse to the direction of propagation $\\hat{n}$. The TT part of any tensor is transverse ($n^i A_{ij}^{TT} = 0$) and traceless ($A_{ii}^{TT} = 0$).\n\nThe TT part of the metric perturbation is given by $h_{ij}^{TT} = \\Lambda_{ij,kl}(\\hat{n}) h_{kl}$. In the far zone radiation gauge, $h_{ij} = \\bar{h}_{ij}$ up to gauge transformations that do not affect the physical strain. Thus, we project $\\bar{h}_{ij}$:\n$$ h_{ij}^{TT}(t, \\mathbf{x}) = \\frac{2}{r} \\Lambda_{ij,kl}(\\hat{n})\\ddot{I}_{kl}(t_r) $$\nThe problem asks for the relationship with the *trace-free* mass quadrupole moment, defined as:\n$$ Q_{ij}(t) = \\int \\rho(t, \\mathbf{x'}) \\left(x'_i x'_j - \\frac{1}{3}\\delta_{ij}|\\mathbf{x'}|^2\\right) d^3x' = I_{ij} - \\frac{1}{3}\\delta_{ij}I_{kk} $$\nOne can show that $\\Lambda_{ij,kl}\\ddot{I}_{kl} = \\Lambda_{ij,kl}\\ddot{Q}_{kl}$, because the projector $\\Lambda_{ij,kl}$ annihilates any trace part. Therefore, the expression can be written in terms of $\\ddot{Q}_{kl}$. Adopting the luminosity distance $D$ for $r$, we arrive at the desired expression:\n$$ h_{ij}^{TT}(t, \\mathbf{x}) = \\frac{2}{D} \\Lambda_{ij,kl}(\\hat{n}) \\ddot{Q}_{kl}(t-D) $$\nThis expression connects the TT metric perturbation to the second time derivative of the trace-free mass quadrupole moment, evaluated at the retarded time.\n\n### Part 2: Application to a Binary Neutron Star System\n\nWe now specialize to the given binary system. For a quasi-circular orbit in the $x$-$y$ plane with orbital angular frequency $\\Omega$, the positions of the two equal masses $m_1=m_2=m=1.4\\,M_{\\odot}$ relative to the center of mass are $\\mathbf{x}_1 = (R/2)(\\cos(\\Omega t), \\sin(\\Omega t), 0)$ and $\\mathbf{x}_2 = -\\mathbf{x}_1$. The total separation is $R$.\nThe mass quadrupole moment is $I_{ij} = \\sum_a m_a x_{a,i} x_{a,j} = m(x_{1,i}x_{1,j} + x_{2,i}x_{2,j}) = 2m x_{1,i}x_{1,j}$.\nA more convenient form uses the reduced mass $\\mu = m_1 m_2 / (m_1+m_2) = m/2 = 0.7\\,M_{\\odot}$ and the relative separation vector $\\mathbf{R} = \\mathbf{x}_1 - \\mathbf{x}_2 = (R\\cos(\\Omega t), R\\sin(\\Omega t), 0)$. Then $I_{ij} = \\mu R_i R_j$.\n$$ I_{ij}(t) = \\mu R^2 \\begin{pmatrix} \\cos^2(\\Omega t)  \\cos(\\Omega t)\\sin(\\Omega t)  0 \\\\ \\cos(\\Omega t)\\sin(\\Omega t)  \\sin^2(\\Omega t)  0 \\\\ 0  0  0 \\end{pmatrix} $$\nThe second time derivative is:\n$$ \\ddot{I}_{ij}(t) = 2\\mu R^2 \\Omega^2 \\begin{pmatrix} -\\cos(2\\Omega t)  -\\sin(2\\Omega t) \\\\ -\\sin(2\\Omega t)  \\cos(2\\Omega t) \\end{pmatrix} $$\nThis tensor is already trace-free, so $\\ddot{Q}_{ij} = \\ddot{I}_{ij}$.\nFor a face-on orientation, the observer is along the $z$-axis, so $\\hat{n}=(0,0,1)$. The projection tensor $P_{ij}$ is the identity on the $x-y$ plane. As $\\ddot{I}_{ij}$ is already transverse and traceless in this plane, the TT projection does not change it: $\\ddot{I}_{ij}^{TT} = \\ddot{I}_{ij}$.\nHence, $h_{ij}^{TT} = \\frac{2}{D}\\ddot{I}_{ij}$. The two gravitational wave polarizations are:\n$$ h_+(t_r) = h_{11}^{TT} = -\\frac{4\\mu R^2\\Omega^2}{D} \\cos(2\\Omega t_r) $$\n$$ h_\\times(t_r) = h_{12}^{TT} = -\\frac{4\\mu R^2\\Omega^2}{D} \\sin(2\\Omega t_r) $$\nThe instantaneous strain amplitude $h_0$ is the amplitude of these oscillations:\n$$ h_0 = \\frac{4\\mu R^2\\Omega^2}{D} $$\nWe use Kepler's third law in geometric units, $M = \\Omega^2 R^3$, where $M=m_1+m_2$ is the total mass. This gives $R^2 = (M/\\Omega^2)^{2/3}$.\n$$ h_0 = \\frac{4\\mu}{D} \\left(\\frac{M}{\\Omega^2}\\right)^{2/3} \\Omega^2 = \\frac{4\\mu M^{2/3}\\Omega^{2/3}}{D} $$\nThe gravitational wave frequency is $f=2f_{orb}$. The orbital angular frequency is $\\Omega=2\\pi f_{orb}$. Thus $\\Omega = \\pi f$, as given. We substitute this into the amplitude expression:\n$$ h_0 = \\frac{4\\mu M^{2/3}(\\pi f)^{2/3}}{D} $$\nTo express this in terms of the chirp mass $M_c = \\mu^{3/5}M^{2/5}$, we note that $\\mu M^{2/3} = (\\mu^{3/5}M^{2/5})^{5/3} = M_c^{5/3}$.\nSubstituting this gives the final expression for the strain amplitude:\n$$ h_0 = \\frac{4 M_c^{5/3}(\\pi f)^{2/3}}{D} = \\frac{4 M_c}{D}(\\pi f M_c)^{2/3} $$\n\n### Numerical Calculation\n\nWe are given:\n-   $m_1=m_2=1.4\\,M_{\\odot}$\n-   $f=100\\,\\mathrm{Hz} = 100\\,\\mathrm{s}^{-1}$\n-   $D=100\\,\\mathrm{Mpc}$\n-   $G=c=1$ conversions: $M_{\\odot} = 4.92549095\\times 10^{-6}\\,\\mathrm{s}$ and $1\\,\\mathrm{Mpc} = 1.02927125\\times 10^{14}\\,\\mathrm{s}$.\n\nFirst, calculate the chirp mass $M_c$:\nFor equal masses $m_1=m_2=m$, $M_c = \\frac{(m^2)^{3/5}}{(2m)^{1/5}} = m \\cdot 2^{-1/5}$.\n$ M_c = (1.4\\,M_\\odot) \\cdot 2^{-1/5} \\approx 1.21873\\,M_\\odot $\n\nConvert $M_c$ and $D$ to units of seconds:\n$ M_c = 1.21873 \\times (4.92549095\\times 10^{-6}\\,\\mathrm{s}) = 6.00280 \\times 10^{-6}\\,\\mathrm{s} $\n$ D = 100 \\times (1.02927125\\times 10^{14}\\,\\mathrm{s}) = 1.02927125 \\times 10^{16}\\,\\mathrm{s} $\n\nNow we calculate the dimensionless term $(\\pi f M_c)$:\n$ \\pi f M_c = \\pi \\times (100\\,\\mathrm{s}^{-1}) \\times (6.00280 \\times 10^{-6}\\,\\mathrm{s}) \\approx 0.00188584 $\n\nNext, we compute the strain amplitude $h_0$:\n$$ h_0 = \\frac{4 M_c}{D}(\\pi f M_c)^{2/3} $$\n$$ h_0 = \\frac{4 \\times (6.00280 \\times 10^{-6})}{1.02927125 \\times 10^{16}} \\times (0.00188584)^{2/3} $$\n$$ h_0 = (2.33281 \\times 10^{-21}) \\times (0.0152636) $$\n$$ h_0 = 3.5610 \\times 10^{-23} $$\nRounding to three significant figures, the instantaneous strain amplitude is $3.56 \\times 10^{-23}$.", "answer": "$$\\boxed{3.56 \\times 10^{-23}}$$", "id": "3562196"}, {"introduction": "With a grasp of how gravitational waves are generated, a critical next step in experimental science is to forecast how well we can measure their properties. This practice introduces the Fisher information matrix formalism, a powerful and widely used tool for estimating the precision of parameter measurements from a given signal and detector. By implementing a simplified, parameterized test of General Relativity's prediction for tidal effects, you will learn how to connect theoretical waveform models to the practical constraints achievable with detectors of varying sensitivity [@problem_id:3562194].", "problem": "You are asked to implement a simplified, parameterized test of General Relativity (GR) for tidal dynamics in binary neutron star inspirals, using a frequency-domain waveform model and the Fisher information approximation under stationary Gaussian noise. Your goal is to introduce a fractional deviation parameter in the leading tidal phase term at the fifth Post-Newtonian (PN) order and compute projected constraints on that deviation with current detector sensitivities approximated by analytic Power Spectral Density (PSD) models.\n\nStart from the following fundamental base and core definitions, without using any specialized shortcuts not derivable from these:\n\n- The signal-to-noise ratio (SNR) in matched filtering is given by the noise-weighted inner product, with squared SNR\n$$\\rho^2 = 4 \\int_{f_{\\mathrm{low}}}^{f_{\\mathrm{high}}} \\frac{|h(f)|^2}{S_n(f)} \\, df,$$\nwhere $h(f)$ is the frequency-domain strain and $S_n(f)$ is the one-sided noise Power Spectral Density (PSD). The integral is in units of $\\mathrm{Hz}$, and $f$ is in $\\mathrm{Hz}$.\n\n- In the stationary phase approximation for the inspiral, the leading-order amplitude is taken as\n$$|h(f)| = A f^{-7/6},$$\nwhere $A$ is a constant amplitude scale set by the source distance and orientation. You must treat $A$ as a free normalization that is chosen such that a target squared SNR $\\rho^2$ is achieved in the given frequency band and PSD.\n\n- The phase can be split into point-particle and tidal parts. Introduce a fractional deviation parameter $\\delta$ multiplying the General Relativity (GR) tidal phase term:\n$$\\Psi(f) = \\Psi_{\\mathrm{PP}}(f) + \\left(1+\\delta\\right)\\Psi_{\\mathrm{tidal}}(f).$$\nAssume the leading-order tidal term at $5\\mathrm{PN}$ in the phase can be written as\n$$\\Psi_{\\mathrm{tidal}}(f) = -\\frac{39}{2}\\,\\tilde{\\Lambda}\\,v^{10}, \\quad v = (\\pi M f)^{1/3},$$\nwhere $\\tilde{\\Lambda}$ is the dimensionless binary tidal deformability (treated as an input parameter), and $M$ is the total mass in geometric units with $G=c=1$. You must convert mass from solar masses to seconds to make $M$ compatible with $f$ in $\\mathrm{Hz}$ via $M = (G M_{\\odot}/c^3) \\times (m_1 + m_2)$, where $m_1$ and $m_2$ are the component masses in solar masses. Use $G=6.67430\\times 10^{-11}\\,\\mathrm{m}^3\\,\\mathrm{kg}^{-1}\\,\\mathrm{s}^{-2}$, $c=2.99792458\\times 10^8\\,\\mathrm{m/s}$, and $M_{\\odot}=1.98847\\times 10^{30}\\,\\mathrm{kg}$.\n\n- In the large SNR limit, the variance of an estimator for a parameter $\\theta$ is approximately the inverse of the Fisher information matrix element $\\Gamma_{\\theta\\theta}$:\n$$\\sigma_{\\theta}^{2} \\approx \\left(\\Gamma_{\\theta\\theta}\\right)^{-1}, \\quad \\Gamma_{\\theta\\theta} = 4\\int_{f_{\\mathrm{low}}}^{f_{\\mathrm{high}}} \\frac{\\left|\\partial h(f)/\\partial \\theta\\right|^2}{S_n(f)}\\,df.$$\nApply this to $\\theta=\\delta$. Because $\\delta$ appears only in the phase, and to leading order $\\partial h/\\partial \\delta = i\\,h(f)\\,\\Psi_{\\mathrm{tidal}}(f)$, you must show that\n$$\\Gamma_{\\delta\\delta} = 4 \\int_{f_{\\mathrm{low}}}^{f_{\\mathrm{high}}} \\frac{|h(f)|^2\\,\\Psi_{\\mathrm{tidal}}(f)^2}{S_n(f)}\\,df.$$\n\n- Use the SNR normalization to eliminate the unknown amplitude $A$. Define\n$$w(f) \\equiv \\frac{f^{-7/3}}{S_n(f)}, \\quad I_0 \\equiv \\int_{f_{\\mathrm{low}}}^{f_{\\mathrm{high}}} w(f)\\,df, \\quad I_2 \\equiv \\int_{f_{\\mathrm{low}}}^{f_{\\mathrm{high}}} w(f)\\,\\Psi_{\\mathrm{tidal}}(f)^2\\,df.$$\nImpose that the target SNR $\\rho$ is achieved, which fixes $A^2 = \\rho^2/[4 I_0]$, and hence\n$$\\Gamma_{\\delta\\delta} = \\rho^2 \\frac{I_2}{I_0}, \\quad \\sigma_{\\delta} = \\left(\\Gamma_{\\delta\\delta}\\right)^{-1/2} = \\left(\\rho^2 \\frac{I_2}{I_0}\\right)^{-1/2}.$$\n\n- Set the upper cutoff frequency as the minimum of a contact frequency and a sampling ceiling. Use the Newtonian contact frequency for two neutron stars of radii $R_1$ and $R_2$:\n$$f_{\\mathrm{contact}} = \\frac{1}{\\pi}\\sqrt{\\frac{G\\,(m_1+m_2)M_{\\odot}}{(R_1+R_2)^3}},$$\nwith $R_1$ and $R_2$ in $\\mathrm{m}$, and $f_{\\mathrm{high}} = \\min\\left(f_{\\mathrm{contact}}, f_{\\mathrm{ceiling}}\\right)$. Use $f_{\\mathrm{ceiling}} = 2048\\,\\mathrm{Hz}$. The lower cutoff is $f_{\\mathrm{low}}$ in $\\mathrm{Hz}$, provided as input. If $f_{\\mathrm{high}} \\le f_{\\mathrm{low}}$, return a not-a-number for the corresponding test case.\n\n- Use three analytic PSD models to represent current detector sensitivity in a simplified manner (choose by a string identifier):\n    - aLIGO-like power-law blend: \n    $$S_{\\mathrm{pl}}(f) = \\left(\\frac{f_0}{f}\\right)^4 + 2 + \\left(\\frac{f}{f_0}\\right)^2,$$\n      with $f_0 = 100\\,\\mathrm{Hz}$.\n    - Flat noise:\n    $$S_{\\mathrm{flat}}(f) = 1.$$\n    - Low-frequency dominated:\n    $$S_{\\mathrm{lf}}(f) = \\left(\\frac{f_0}{f}\\right)^6 + 1,$$\n      with $f_0 = 100\\,\\mathrm{Hz}$.\n\nYour task:\n\n- Implement a program that, for each test case described below, computes $\\sigma_{\\delta}$ as above, using numerical integration over $f$ in $\\mathrm{Hz}$.\n\n- Units: All frequencies must be in $\\mathrm{Hz}$, masses in solar masses must be converted to seconds for phase calculations using $M = (G M_{\\odot}/c^3)(m_1+m_2)$, and radii must be provided in $\\mathrm{km}$ and converted to $\\mathrm{m}$ for the contact frequency. The final answers $\\sigma_{\\delta}$ are unitless and must be returned as decimal floats.\n\n- Angle units are not used.\n\n- The value of $\\delta$ itself must not be assumed or used; you are computing the projected constraint under the null hypothesis that $\\delta=0$.\n\nTest suite:\n\nProvide results for the following five test cases, expressed as a comma-separated list in a single line, enclosed in square brackets. Each test case is a tuple $(m_1, m_2, \\tilde{\\Lambda}, R_1, R_2, f_{\\mathrm{low}}, \\rho, \\mathrm{PSD})$, where masses are in solar masses, radii are in $\\mathrm{km}$, $f_{\\mathrm{low}}$ and $\\rho$ are in $\\mathrm{Hz}$ and unitless respectively, and $\\mathrm{PSD}\\in\\{\\text{\"pl\"},\\text{\"flat\"},\\text{\"lf\"}\\}$ selects the model.\n\n- Case $1$ (happy path): $(1.35, 1.35, 400.0, 12.0, 12.0, 20.0, 30.0, \\text{\"pl\"})$.\n- Case $2$ (lower SNR edge): $(1.35, 1.35, 400.0, 12.0, 12.0, 20.0, 10.0, \\text{\"pl\"})$.\n- Case $3$ (stiffer equation of state, larger $\\tilde{\\Lambda}$): $(1.40, 1.40, 800.0, 13.0, 13.0, 20.0, 30.0, \\text{\"pl\"})$.\n- Case $4$ (softer equation of state, smaller $\\tilde{\\Lambda}$): $(1.35, 1.35, 100.0, 11.0, 11.0, 20.0, 30.0, \\text{\"pl\"})$.\n- Case $5$ (higher low-frequency cutoff, alternate PSD): $(1.30, 1.50, 400.0, 12.0, 12.0, 50.0, 30.0, \\text{\"lf\"})$.\n\nFinal output format:\n\nYour program should produce a single line of output containing the results for the five test cases as a comma-separated list enclosed in square brackets (for example, $[\\mathrm{result}_1,\\mathrm{result}_2,\\mathrm{result}_3,\\mathrm{result}_4,\\mathrm{result}_5]$). Each result must be a decimal floating-point number representing $\\sigma_{\\delta}$ (unitless).", "solution": "The objective is to compute the projected $1$-$\\sigma$ uncertainty, denoted $\\sigma_{\\delta}$, for a parameter $\\delta$ that quantifies a fractional deviation from General Relativity (GR) in the tidal phase of a binary neutron star inspiral gravitational wave signal. The calculation is performed within the Fisher information matrix formalism, assuming stationary Gaussian noise.\n\nThe analysis begins with two fundamental expressions from matched filter theory. The squared signal-to-noise ratio ($\\mathrm{SNR}$) $\\rho^2$ is given by the noise-weighted inner product:\n$$\n\\rho^2 = 4 \\int_{f_{\\mathrm{low}}}^{f_{\\mathrm{high}}} \\frac{|h(f)|^2}{S_n(f)} \\, df\n$$\nwhere $h(f)$ is the frequency-domain gravitational waveform, $S_n(f)$ is the one-sided power spectral density (PSD) of the detector noise, and the integration is over the sensitive frequency band $[f_{\\mathrm{low}}, f_{\\mathrm{high}}]$. In the large $\\mathrm{SNR}$ limit, the variance $\\sigma_{\\theta}^2$ of an unbiased estimator for a waveform parameter $\\theta$ is approximated by the inverse of the corresponding diagonal element of the Fisher information matrix, $\\Gamma_{\\theta\\theta}$:\n$$\n\\sigma_{\\theta}^{2} \\approx \\left(\\Gamma_{\\theta\\theta}\\right)^{-1}, \\quad \\text{where} \\quad \\Gamma_{\\theta\\theta} = 4\\int_{f_{\\mathrm{low}}}^{f_{\\mathrm{high}}} \\frac{\\left|\\frac{\\partial h(f)}{\\partial \\theta}\\right|^2}{S_n(f)}\\,df\n$$\n\nThe problem specifies a simplified frequency-domain waveform model where the amplitude is $|h(f)| = A f^{-7/6}$, with $A$ being an unknown amplitude constant. The phase is modeled as $\\Psi(f) = \\Psi_{\\mathrm{PP}}(f) + (1+\\delta)\\Psi_{\\mathrm{tidal}}(f)$, where $\\Psi_{\\mathrm{PP}}$ is the point-particle phase contribution and $\\Psi_{\\mathrm{tidal}}$ is the tidal contribution. The parameter of interest is the deviation $\\delta$.\n\nWe must first derive the expression for $\\Gamma_{\\delta\\delta}$. The waveform can be written as $h(f) = |h(f)|e^{i\\Psi(f)}$. Differentiating with respect to $\\delta$ affects only the phase:\n$$\n\\frac{\\partial h(f)}{\\partial \\delta} = |h(f)| \\frac{\\partial}{\\partial \\delta} \\left( e^{i\\Psi(f)} \\right) = |h(f)| e^{i\\Psi(f)} \\left( i \\frac{\\partial \\Psi(f)}{\\partial \\delta} \\right)\n$$\nFrom the definition of $\\Psi(f)$, we have $\\frac{\\partial \\Psi(f)}{\\partial \\delta} = \\Psi_{\\mathrm{tidal}}(f)$. Substituting this back gives:\n$$\n\\frac{\\partial h(f)}{\\partial \\delta} = i |h(f)| e^{i\\Psi(f)} \\Psi_{\\mathrm{tidal}}(f) = i h(f) \\Psi_{\\mathrm{tidal}}(f)\n$$\nThe squared magnitude is therefore:\n$$\n\\left|\\frac{\\partial h(f)}{\\partial \\delta}\\right|^2 = |i h(f) \\Psi_{\\mathrm{tidal}}(f)|^2 = |i|^2 |h(f)|^2 |\\Psi_{\\mathrm{tidal}}(f)|^2 = |h(f)|^2 \\Psi_{\\mathrm{tidal}}(f)^2\n$$\nsince $\\Psi_{\\mathrm{tidal}}(f)$ is a real-valued function. Inserting this into the formula for the Fisher matrix element yields the required expression:\n$$\n\\Gamma_{\\delta\\delta} = 4 \\int_{f_{\\mathrm{low}}}^{f_{\\mathrm{high}}} \\frac{|h(f)|^2 \\Psi_{\\mathrm{tidal}}(f)^2}{S_n(f)}\\,df\n$$\n\nThe unknown amplitude $A$ is eliminated by fixing the total $\\mathrm{SNR}$ to a target value $\\rho$. We substitute $|h(f)| = A f^{-7/6}$ into the equations for $\\rho^2$ and $\\Gamma_{\\delta\\delta}$. Let us define the weighted function $w(f) \\equiv \\frac{f^{-7/3}}{S_n(f)}$. Then:\n$$\n\\rho^2 = 4 A^2 \\int_{f_{\\mathrm{low}}}^{f_{\\mathrm{high}}} \\frac{f^{-7/3}}{S_n(f)} df = 4 A^2 \\int_{f_{\\mathrm{low}}}^{f_{\\mathrm{high}}} w(f) df \\equiv 4 A^2 I_0\n$$\n$$\n\\Gamma_{\\delta\\delta} = 4 A^2 \\int_{f_{\\mathrm{low}}}^{f_{\\mathrm{high}}} \\frac{f^{-7/3} \\Psi_{\\mathrm{tidal}}(f)^2}{S_n(f)} df = 4 A^2 \\int_{f_{\\mathrm{low}}}^{f_{\\mathrm{high}}} w(f) \\Psi_{\\mathrm{tidal}}(f)^2 df \\equiv 4 A^2 I_2\n$$\nFrom the expression for $\\rho^2$, we solve for the constant term $4A^2 = \\rho^2 / I_0$. Substituting this into the expression for $\\Gamma_{\\delta\\delta}$ gives:\n$$\n\\Gamma_{\\delta\\delta} = \\left(\\frac{\\rho^2}{I_0}\\right) I_2 = \\rho^2 \\frac{I_2}{I_0}\n$$\nThe projected uncertainty $\\sigma_{\\delta}$ is then:\n$$\n\\sigma_{\\delta} = (\\Gamma_{\\delta\\delta})^{-1/2} = \\left(\\rho^2 \\frac{I_2}{I_0}\\right)^{-1/2} = \\frac{1}{\\rho} \\sqrt{\\frac{I_0}{I_2}}\n$$\nThis final expression is independent of the source amplitude $A$ and depends only on the target $\\mathrm{SNR}$ $\\rho$, the noise curve $S_n(f)$, and the waveform's phase and frequency evolution.\n\nThe specific form of the leading-order tidal phase at $5\\mathrm{PN}$ is given as:\n$$\n\\Psi_{\\mathrm{tidal}}(f) = -\\frac{39}{2}\\,\\tilde{\\Lambda}\\,v^{10}, \\quad \\text{with} \\quad v = (\\pi M f)^{1/3}\n$$\nHere, $\\tilde{\\Lambda}$ is the dimensionless binary tidal deformability and $M$ is the total mass in geometric units (seconds). The total mass $M$ is obtained from the component masses $m_1$ and $m_2$ (in solar masses, $M_{\\odot}$) using the conversion factor $M_{\\text{s/Msun}} = G M_{\\odot}/c^3$, such that $M = (m_1+m_2) \\times M_{\\text{s/Msun}}$. Using the provided constants $G=6.67430\\times 10^{-11}\\,\\mathrm{m}^3\\,\\mathrm{kg}^{-1}\\,\\mathrm{s}^{-2}$, $c=2.99792458\\times 10^8\\,\\mathrm{m/s}$, and $M_{\\odot}=1.98847\\times 10^{30}\\,\\mathrm{kg}$, the conversion factor is approximately $4.92549 \\times 10^{-6}\\,\\mathrm{s}/M_{\\odot}$. Combining these, $\\Psi_{\\mathrm{tidal}}(f)$ can be written as:\n$$\n\\Psi_{\\mathrm{tidal}}(f) = -\\frac{39}{2}\\,\\tilde{\\Lambda}\\,(\\pi M f)^{10/3}\n$$\n\nThe frequency range of integration $[f_{\\mathrm{low}}, f_{\\mathrm{high}}]$ is determined by the detector's low-frequency sensitivity limit, $f_{\\mathrm{low}}$, and an upper cutoff, $f_{\\mathrm{high}} = \\min(f_{\\mathrm{contact}}, f_{\\mathrm{ceiling}})$. The ceiling is fixed at $f_{\\mathrm{ceiling}} = 2048\\,\\mathrm{Hz}$. The contact frequency is approximated by the Newtonian orbital frequency at contact:\n$$\nf_{\\mathrm{contact}} = \\frac{1}{\\pi}\\sqrt{\\frac{G(m_1+m_2)M_{\\odot}}{(R_1+R_2)^3}}\n$$\nwhere radii $R_1, R_2$ must be in meters.\n\nThe computation of $\\sigma_{\\delta}$ thus reduces to the numerical evaluation of two integrals, $I_0$ and $I_2$, over the frequency range $[f_{\\mathrm{low}}, f_{\\mathrm{high}}]$. The integrands depend on the chosen PSD model, $S_n(f)$, which are given as analytic functions:\n\\begin{itemize}\n    \\item `pl`: $S_{\\mathrm{pl}}(f) = (f_0/f)^4 + 2 + (f/f_0)^2$ with $f_0=100\\,\\mathrm{Hz}$\n    \\item `flat`: $S_{\\mathrm{flat}}(f) = 1$\n    \\item `lf`: $S_{\\mathrm{lf}}(f) = (f_0/f)^6 + 1$ with $f_0=100\\,\\mathrm{Hz}$\n\\end{itemize}\nThe integrals $I_0$ and $I_2$ can be expressed as:\n$$\nI_0 = \\int_{f_{\\mathrm{low}}}^{f_{\\mathrm{high}}} \\frac{f^{-7/3}}{S_n(f)} df\n$$\n$$\nI_2 = \\int_{f_{\\mathrm{low}}}^{f_{\\mathrm{high}}} \\frac{f^{-7/3}}{S_n(f)} \\left(-\\frac{39}{2}\\,\\tilde{\\Lambda}\\,(\\pi M f)^{10/3}\\right)^2 df = \\left(\\frac{39}{2}\\tilde{\\Lambda}\\right)^2 (\\pi M)^{20/3} \\int_{f_{\\mathrm{low}}}^{f_{\\mathrm{high}}} \\frac{f^{13/3}}{S_n(f)} df\n$$\nThis factorization is numerically advantageous. The algorithm will compute these integrals for each test case and combine them to find $\\sigma_{\\delta}$.", "answer": "```python\nimport numpy as np\nfrom scipy import integrate\n\ndef solve():\n    \"\"\"\n    Computes the projected 1-sigma uncertainty (sigma_delta) on a fractional GR\n    deviation parameter for tidal dynamics in binary neutron star inspirals.\n    \"\"\"\n    \n    # Define physical constants\n    G = 6.67430e-11  # m^3 kg^-1 s^-2\n    C = 2.99792458e8  # m/s\n    M_SOLAR = 1.98847e30  # kg\n    \n    # Conversion factor from solar mass to seconds\n    M_SOLAR_IN_S = (G * M_SOLAR) / (C**3)\n    \n    # Test cases: (m1, m2, Lambda_tilde, R1_km, R2_km, f_low, rho, psd_model_str)\n    # m_i in M_solar, R_i in km, f_low in Hz\n    test_cases = [\n        (1.35, 1.35, 400.0, 12.0, 12.0, 20.0, 30.0, \"pl\"),\n        (1.35, 1.35, 400.0, 12.0, 12.0, 20.0, 10.0, \"pl\"),\n        (1.40, 1.40, 800.0, 13.0, 13.0, 20.0, 30.0, \"pl\"),\n        (1.35, 1.35, 100.0, 11.0, 11.0, 20.0, 30.0, \"pl\"),\n        (1.30, 1.50, 400.0, 12.0, 12.0, 50.0, 30.0, \"lf\"),\n    ]\n\n    results = []\n\n    for case in test_cases:\n        m1, m2, Lambda_tilde, R1_km, R2_km, f_low, rho, psd_model = case\n        \n        # 1. Calculate case-specific parameters\n        m_total_solar = m1 + m2\n        M_geom = m_total_solar * M_SOLAR_IN_S  # Total mass in seconds\n\n        R1_m = R1_km * 1000.0\n        R2_m = R2_km * 1000.0\n        \n        # 2. Determine integration frequency limits\n        f_ceiling = 2048.0\n        \n        # Calculate contact frequency in Hz (all units in SI)\n        f_contact_num = G * m_total_solar * M_SOLAR\n        f_contact_den = (R1_m + R2_m)**3\n        f_contact = (1.0 / np.pi) * np.sqrt(f_contact_num / f_contact_den)\n        \n        f_high = min(f_contact, f_ceiling)\n        \n        # Handle invalid frequency range\n        if f_high = f_low:\n            results.append(np.nan)\n            continue\n            \n        # 3. Define Power Spectral Density (PSD) function\n        f0 = 100.0\n        if psd_model == \"pl\":\n            Sn = lambda f: (f0 / f)**4 + 2.0 + (f / f0)**2\n        elif psd_model == \"flat\":\n            Sn = lambda f: 1.0\n        elif psd_model == \"lf\":\n            Sn = lambda f: (f0 / f)**6 + 1.0\n        else:\n            raise ValueError(f\"Invalid PSD model: {psd_model}\")\n\n        # 4. Define integrands for I0 and I2\n        # Integrand for I0 = integral(f**(-7/3) / S_n(f) df)\n        integrand0 = lambda f: f**(-7.0/3.0) / Sn(f)\n        \n        # Integrand for the frequency-dependent part of I2\n        # I2 = const_factor * integral(f**(13/3) / S_n(f) df)\n        integrand_for_I2 = lambda f: f**(13.0/3.0) / Sn(f)\n        \n        # 5. Perform numerical integration\n        # Set a higher limit for subdivisions for better accuracy\n        integration_opts = {'limit': 200}\n        I0, _ = integrate.quad(integrand0, f_low, f_high, **integration_opts)\n        integral_part_of_I2, _ = integrate.quad(integrand_for_I2, f_low, f_high, **integration_opts)\n        \n        # 6. Assemble I2 and calculate sigma_delta\n        # I2 = (39/2 * Lambda_tilde)^2 * (pi*M)^(20/3) * integral_part_of_I2\n        tidal_const_factor = ((39.0 / 2.0 * Lambda_tilde)**2 * \n                              (np.pi * M_geom)**(20.0 / 3.0))\n        I2 = tidal_const_factor * integral_part_of_I2\n\n        if I2 = 0 or I0 = 0:\n            sigma_delta = np.inf\n        else:\n            # sigma_delta = (1/rho) * sqrt(I0/I2)\n            Gamma_deltadelta = rho**2 * (I2 / I0)\n            sigma_delta = 1.0 / np.sqrt(Gamma_deltadelta)\n            \n        results.append(sigma_delta)\n        \n    # Final print statement in the exact required format\n    print(f\"[{','.join(f'{r:.15g}' for r in results)}]\")\n\nsolve()\n```", "id": "3562194"}, {"introduction": "Extracting new physics from gravitational-wave data often means deciding which of several competing theories best explains our observations. This practice moves from forecasting to the heart of data analysis: statistical inference and model selection. You will construct a simplified but conceptually powerful Bayesian framework to compare a model including tidal effects against a simpler point-particle model. By computing the Bayes factor, you will learn the quantitative basis for claiming a \"detection\" of a physical effect and understand how the required signal strength depends on our prior knowledge of the parameters [@problem_id:3562203].", "problem": "Consider a simplified, first-principles model comparison for gravitational-wave inspiral data from a binary neutron star system, focusing on whether tidal effects are supported by the data. Work entirely in a whitened, two-dimensional sufficient-statistics space constructed from orthonormal templates. Let the data vector be $s = (x, y)$, where $x$ is the matched-filter projection onto a point-particle template and $y$ is the matched-filter projection onto a leading-order tidal correction template. Assume zero-mean Gaussian detector noise with unit variance per component, independent across $x$ and $y$. Under both models, the point-particle amplitude parameter $a$ enters linearly in the $x$-direction, and under the tidal model an additional tidal parameter $\\lambda$ enters linearly in the $y$-direction. Adopt zero-mean Gaussian priors $a \\sim \\mathcal{N}(0, \\sigma_a^2)$ and $\\lambda \\sim \\mathcal{N}(0, \\sigma_\\lambda^2)$ that reflect realistic astrophysical and nuclear equation-of-state uncertainties over the effective projections in this whitened basis. The point-particle model excludes the tidal parameter (equivalently, fixes $\\lambda$ to $0$ a priori). The tidal model includes both $a$ and $\\lambda$ with the specified priors. Assume that $x$ and $y$ are sufficient statistics so that likelihoods factorize over these components given the parameters. You must do the following: \n- Starting from the assumptions above, derive the Bayesian evidence for each model by integrating the Gaussian likelihood over the Gaussian priors, and construct the Bayes factor in favor of the tidal model over the point-particle model as a function of $y$ and $\\sigma_\\lambda$. \n- Define the signal-to-noise ratio (SNR) for the tidal effect as the absolute value of $y$ in this whitened basis, which is dimensionless. Using a decision threshold Bayes factor $B_0 = 100$ (interpreted as “decisive” support), derive an explicit expression for the minimal tidal SNR $y_\\star(\\sigma_\\lambda)$ required so that the Bayes factor in favor of the tidal model is at least $B_0$. Express $y_\\star$ as a positive real number without units. \n- Implement a program that, for a set of test cases, computes: \n    $1)$ the Bayes factor for given $(\\sigma_\\lambda, y)$, and \n    $2)$ the threshold tidal SNR $y_\\star$ for the same $\\sigma_\\lambda$ at $B_0 = 100$. \nUse the following test suite (each tuple is $(\\sigma_\\lambda, y)$): \n- Test $1$: $(1.0, 0.0)$, \n- Test $2$: $(1.5, 3.0)$, \n- Test $3$: $(3.0, 6.0)$. \nYour program must compute six floating-point outputs: the three Bayes factors for the tests above followed by the three corresponding SNR thresholds $y_\\star$ (one for each $\\sigma_\\lambda$ from the same list), in that order. All six outputs must be rounded to six decimal places and printed on a single line as a comma-separated list enclosed in square brackets, for example, $[r_1,r_2,r_3,r_4,r_5,r_6]$. All quantities are dimensionless; do not include any physical units or percentage signs. Angles are not used and need not be reported in radians or degrees.", "solution": "The problem requires the derivation and computation of the Bayesian evidence for two competing models of a gravitational wave signal from a binary neutron star merger, the construction of the Bayes factor, and the determination of a detection threshold for tidal effects.\n\n### Model Definitions and Bayesian Framework\n\nLet the observed data vector in the whitened sufficient-statistics space be $s=(x, y)$. The detector noise is assumed to be zero-mean Gaussian with unit variance and independent in each component. We compare two models: the point-particle model ($\\mathcal{M}_P$) and the tidal model ($\\mathcal{M}_T$).\n\nThe likelihood, which is the probability of the data given the model parameters, follows from the noise model. If the true signal is $\\mu(\\theta)$, where $\\theta$ represents the model parameters, then the data $s = \\mu(\\theta) + n$, where $n \\sim \\mathcal{N}(0, I_2)$ is the noise vector and $I_2$ is the $2 \\times 2$ identity matrix. Thus, the likelihood is $p(s|\\theta, \\mathcal{M}) = \\mathcal{N}(s|\\mu(\\theta), I_2)$. Given the independence of the components, this factorizes into $p(x, y | \\theta, \\mathcal{M}) = p(x|\\theta, \\mathcal{M}) p(y|\\theta, \\mathcal{M})$.\n\n**Model 1: Point-Particle ($\\mathcal{M}_P$)**\nUnder this model, the signal has no tidal component, so the mean signal is $\\mu_P = (a, 0)$. The parameter is $a$, the point-particle amplitude. The likelihood is:\n$$p(x, y | a, \\mathcal{M}_P) = \\mathcal{N}(x|a, 1) \\mathcal{N}(y|0, 1) = \\frac{1}{2\\pi} \\exp\\left(-\\frac{(x-a)^2}{2} - \\frac{y^2}{2}\\right)$$\nThe prior on the parameter $a$ is given as a zero-mean Gaussian: $p(a|\\mathcal{M}_P) = \\mathcal{N}(a|0, \\sigma_a^2)$.\n\n**Model 2: Tidal ($\\mathcal{M}_T$)**\nUnder this model, a tidal component is present. The mean signal is $\\mu_T = (a, \\lambda)$, where $\\lambda$ is the tidal parameter. The parameters are $\\theta = \\{a, \\lambda\\}$. The likelihood is:\n$$p(x, y | a, \\lambda, \\mathcal{M}_T) = \\mathcal{N}(x|a, 1) \\mathcal{N}(y|\\lambda, 1) = \\frac{1}{2\\pi} \\exp\\left(-\\frac{(x-a)^2}{2} - \\frac{(y-\\lambda)^2}{2}\\right)$$\nThe priors on the parameters are independent zero-mean Gaussians: $p(a|\\mathcal{M}_T) = \\mathcal{N}(a|0, \\sigma_a^2)$ and $p(\\lambda|\\mathcal{M}_T) = \\mathcal{N}(\\lambda|0, \\sigma_\\lambda^2)$.\n\n### Derivation of the Bayesian Evidence\n\nThe Bayesian evidence for a model $\\mathcal{M}$, denoted $\\mathcal{Z}_{\\mathcal{M}}$, is the probability of the data given the model, integrated over all possible parameter values weighted by their prior probabilities:\n$$\\mathcal{Z}_{\\mathcal{M}} = p(s|\\mathcal{M}) = \\int p(s|\\theta, \\mathcal{M}) p(\\theta|\\mathcal{M}) d\\theta$$\n\n**Evidence for $\\mathcal{M}_P$:**\nThe evidence for the point-particle model, $\\mathcal{Z}_P$, is:\n$$\\mathcal{Z}_P = \\int_{-\\infty}^{\\infty} p(x, y | a, \\mathcal{M}_P) p(a|\\mathcal{M}_P) da$$\nSubstituting the expressions for the likelihood and prior:\n$$\\mathcal{Z}_P = \\int \\left(\\frac{1}{\\sqrt{2\\pi}} e^{-\\frac{(x-a)^2}{2}}\\right) \\left(\\frac{1}{\\sqrt{2\\pi}} e^{-\\frac{y^2}{2}}\\right) \\left(\\frac{1}{\\sqrt{2\\pi}\\sigma_a} e^{-\\frac{a^2}{2\\sigma_a^2}}\\right) da$$\nThe term involving $y$ is constant with respect to the integration variable $a$ and can be factored out:\n$$\\mathcal{Z}_P = \\left(\\frac{1}{\\sqrt{2\\pi}} e^{-\\frac{y^2}{2}}\\right) \\int \\left(\\frac{1}{\\sqrt{2\\pi}} e^{-\\frac{(x-a)^2}{2}}\\right) \\left(\\frac{1}{\\sqrt{2\\pi}\\sigma_a} e^{-\\frac{a^2}{2\\sigma_a^2}}\\right) da$$\nThe remaining integral is the marginal likelihood for $x$, $p(x|\\mathcal{M}_P)$. This is a standard result for a Gaussian likelihood integrated over a Gaussian prior. The integral of $\\mathcal{N}(x|a, \\sigma_L^2)$ with prior $\\mathcal{N}(a|\\mu_P, \\sigma_P^2)$ yields a marginal likelihood for $x$ of $\\mathcal{N}(x|\\mu_P, \\sigma_L^2+\\sigma_P^2)$. In our case, $\\sigma_L^2=1$, $\\mu_P=0$, and $\\sigma_P^2=\\sigma_a^2$. Thus, the integral evaluates to:\n$$p(x|\\mathcal{M}_P) = \\frac{1}{\\sqrt{2\\pi(1+\\sigma_a^2)}} \\exp\\left(-\\frac{x^2}{2(1+\\sigma_a^2)}\\right)$$\nCombining this with the factored-out $y$ term, the total evidence for $\\mathcal{M}_P$ is:\n$$\\mathcal{Z}_P = \\frac{1}{\\sqrt{2\\pi(1+\\sigma_a^2)}} \\exp\\left(-\\frac{x^2}{2(1+\\sigma_a^2)}\\right) \\cdot \\frac{1}{\\sqrt{2\\pi}} \\exp\\left(-\\frac{y^2}{2}\\right)$$\n\n**Evidence for $\\mathcal{M}_T$:**\nThe evidence for the tidal model, $\\mathcal{Z}_T$, involves integrating over both $a$ and $\\lambda$:\n$$\\mathcal{Z}_T = \\iint p(x, y | a, \\lambda, \\mathcal{M}_T) p(a|\\mathcal{M}_T) p(\\lambda|\\mathcal{M}_T) da d\\lambda$$\nDue to the factorization of the likelihood and the independence of the priors, the integral separates:\n$$\\mathcal{Z}_T = \\left( \\int p(x|a) p(a) da \\right) \\left( \\int p(y|\\lambda) p(\\lambda) d\\lambda \\right)$$\nThe integral over $a$ is identical to the one computed for $\\mathcal{Z}_P$. The integral over $\\lambda$ is analogous: we have a likelihood $\\mathcal{N}(y|\\lambda, 1)$ and a prior $\\mathcal{N}(\\lambda|0, \\sigma_\\lambda^2)$. The result is:\n$$p(y|\\mathcal{M}_T) = \\frac{1}{\\sqrt{2\\pi(1+\\sigma_\\lambda^2)}} \\exp\\left(-\\frac{y^2}{2(1+\\sigma_\\lambda^2)}\\right)$$\nTherefore, the total evidence for $\\mathcal{M}_T$ is the product of the two marginal likelihoods:\n$$\\mathcal{Z}_T = \\frac{1}{\\sqrt{2\\pi(1+\\sigma_a^2)}} \\exp\\left(-\\frac{x^2}{2(1+\\sigma_a^2)}\\right) \\cdot \\frac{1}{\\sqrt{2\\pi(1+\\sigma_\\lambda^2)}} \\exp\\left(-\\frac{y^2}{2(1+\\sigma_\\lambda^2)}\\right)$$\n\n### Derivation of the Bayes Factor\n\nThe Bayes factor $B_{TP}$ in favor of the tidal model $\\mathcal{M}_T$ over the point-particle model $\\mathcal{M}_P$ is the ratio of their evidences:\n$$B_{TP} = \\frac{\\mathcal{Z}_T}{\\mathcal{Z}_P}$$\nSubstituting the expressions for $\\mathcal{Z}_T$ and $\\mathcal{Z}_P$:\n$$B_{TP} = \\frac{\\frac{1}{\\sqrt{2\\pi(1+\\sigma_a^2)}} e^{-\\frac{x^2}{2(1+\\sigma_a^2)}} \\cdot \\frac{1}{\\sqrt{2\\pi(1+\\sigma_\\lambda^2)}} e^{-\\frac{y^2}{2(1+\\sigma_\\lambda^2)}}}{\\frac{1}{\\sqrt{2\\pi(1+\\sigma_a^2)}} e^{-\\frac{x^2}{2(1+\\sigma_a^2)}} \\cdot \\frac{1}{\\sqrt{2\\pi}} e^{-\\frac{y^2}{2}}}$$\nThe terms involving $x$ and $\\sigma_a$ cancel completely, demonstrating that the evidence for or against the tidal parameter depends only on the data component $y$ and the prior width $\\sigma_\\lambda$.\n$$B_{TP} = \\frac{\\frac{1}{\\sqrt{1+\\sigma_\\lambda^2}} \\exp\\left(-\\frac{y^2}{2(1+\\sigma_\\lambda^2)}\\right)}{\\exp\\left(-\\frac{y^2}{2}\\right)}$$\nSimplifying the expression by combining the exponentials:\n$$B_{TP} = \\frac{1}{\\sqrt{1+\\sigma_\\lambda^2}} \\exp\\left(\\frac{y^2}{2} - \\frac{y^2}{2(1+\\sigma_\\lambda^2)}\\right)$$\n$$B_{TP} = \\frac{1}{\\sqrt{1+\\sigma_\\lambda^2}} \\exp\\left(\\frac{y^2}{2} \\left(1 - \\frac{1}{1+\\sigma_\\lambda^2}\\right)\\right)$$\n$$B_{TP} = \\frac{1}{\\sqrt{1+\\sigma_\\lambda^2}} \\exp\\left(\\frac{y^2}{2} \\left(\\frac{1+\\sigma_\\lambda^2 - 1}{1+\\sigma_\\lambda^2}\\right)\\right)$$\nThis yields the final expression for the Bayes factor as a function of $y$ and $\\sigma_\\lambda$:\n$$B_{TP}(y, \\sigma_\\lambda) = \\frac{1}{\\sqrt{1+\\sigma_\\lambda^2}} \\exp\\left( \\frac{y^2 \\sigma_\\lambda^2}{2(1+\\sigma_\\lambda^2)} \\right)$$\n\n### Derivation of the Threshold Tidal SNR $y_\\star$\n\nThe tidal signal-to-noise ratio (SNR) is defined as $|y|$. We need to find the minimal SNR, denoted $y_\\star$, for which the Bayes factor reaches a threshold of $B_0 = 100$. Since $B_{TP}$ depends on $y^2$, we can solve for $y_\\star  0$.\nWe set $B_{TP}(y_\\star, \\sigma_\\lambda) = B_0$:\n$$100 = \\frac{1}{\\sqrt{1+\\sigma_\\lambda^2}} \\exp\\left( \\frac{y_\\star^2 \\sigma_\\lambda^2}{2(1+\\sigma_\\lambda^2)} \\right)$$\nTo solve for $y_\\star$, we first isolate the exponential term and then take the natural logarithm:\n$$100 \\sqrt{1+\\sigma_\\lambda^2} = \\exp\\left( \\frac{y_\\star^2 \\sigma_\\lambda^2}{2(1+\\sigma_\\lambda^2)} \\right)$$\n$$\\ln\\left(100 \\sqrt{1+\\sigma_\\lambda^2}\\right) = \\frac{y_\\star^2 \\sigma_\\lambda^2}{2(1+\\sigma_\\lambda^2)}$$\nNow, we solve for $y_\\star^2$:\n$$y_\\star^2 = \\frac{2(1+\\sigma_\\lambda^2)}{\\sigma_\\lambda^2} \\ln\\left(100 (1+\\sigma_\\lambda^2)^{1/2}\\right)$$\nThe expression can also be written using properties of logarithms:\n$$y_\\star^2 = \\frac{2(1+\\sigma_\\lambda^2)}{\\sigma_\\lambda^2} \\left[ \\ln(100) + \\frac{1}{2}\\ln(1+\\sigma_\\lambda^2) \\right]$$\nTaking the positive square root gives the final expression for the threshold SNR, $y_\\star$:\n$$y_\\star(\\sigma_\\lambda) = \\sqrt{\\frac{2(1+\\sigma_\\lambda^2)}{\\sigma_\\lambda^2} \\left[ \\ln(100) + \\frac{1}{2}\\ln(1+\\sigma_\\lambda^2) \\right]}$$\nThis expression and the one for the Bayes factor will be implemented to compute the required values.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the Bayes factor and threshold SNR for tidal effects in a\n    simplified gravitational wave data analysis problem.\n    \"\"\"\n    # Define the test cases from the problem statement as tuples of (sigma_lambda, y).\n    test_cases = [\n        (1.0, 0.0),\n        (1.5, 3.0),\n        (3.0, 6.0),\n    ]\n\n    B_0 = 100.0  # The decision threshold for the Bayes factor.\n    \n    bayes_factor_results = []\n    snr_threshold_results = []\n\n    # Calculate Bayes factors for each test case\n    for sigma_lambda, y in test_cases:\n        # The derived formula for the Bayes factor B_TP in favor of the tidal model\n        # B_TP = (1 / sqrt(1 + sigma_lambda^2)) * exp((y^2 * sigma_lambda^2) / (2 * (1 + sigma_lambda^2)))\n        \n        one_plus_sl_sq = 1.0 + sigma_lambda**2\n        ockham_factor = 1.0 / np.sqrt(one_plus_sl_sq)\n        \n        exponent = (y**2 * sigma_lambda**2) / (2.0 * one_plus_sl_sq)\n        \n        bayes_factor = ockham_factor * np.exp(exponent)\n        bayes_factor_results.append(bayes_factor)\n\n    # Calculate SNR thresholds for each unique sigma_lambda\n    # The unique values of sigma_lambda are the first elements of the test_cases tuples\n    sigma_lambda_values = [case[0] for case in test_cases]\n    \n    for sigma_lambda in sigma_lambda_values:\n        # The derived formula for the threshold SNR y_star\n        # y_star^2 = (2 * (1 + sigma_lambda^2) / sigma_lambda^2) * ln(B_0 * sqrt(1 + sigma_lambda^2))\n        \n        one_plus_sl_sq = 1.0 + sigma_lambda**2\n        \n        # log argument: B_0 * sqrt(1 + sigma_lambda^2)\n        log_arg = B_0 * np.sqrt(one_plus_sl_sq)\n        \n        # Prefactor: 2 * (1 + sigma_lambda^2) / sigma_lambda^2\n        prefactor = 2.0 * one_plus_sl_sq / (sigma_lambda**2)\n        \n        y_star_squared = prefactor * np.log(log_arg)\n        \n        y_star = np.sqrt(y_star_squared)\n        snr_threshold_results.append(y_star)\n\n    # Combine the results in the required order: [B1, B2, B3, y_star1, y_star2, y_star3]\n    all_results = bayes_factor_results + snr_threshold_results\n\n    # Format the final output as a comma-separated list of floats rounded to six decimal places,\n    # enclosed in square brackets.\n    output_str = f\"[{','.join(['{:.6f}'.format(r) for r in all_results])}]\"\n    \n    print(output_str)\n\nsolve()\n```", "id": "3562203"}]}