{"hands_on_practices": [{"introduction": "The first step in any configuration interaction calculation is to define the many-body Hilbert space. This exercise provides fundamental practice in constructing a basis for a light nucleus within the No-Core Shell Model, a leading ab-initio CI method. By working through the definitions of the harmonic oscillator basis and the $N_{\\max}$ truncation, you will develop the essential skill of enumerating many-body states and determining the dimensionality of the model space, which dictates the computational scale of the problem [@problem_id:3597229].", "problem": "Consider the No-Core Shell Model (NCSM) for the nucleus $^{6}\\text{Li}$ using a three-dimensional harmonic oscillator single-particle basis characterized by the energy scale $\\hbar\\Omega=20\\,\\text{MeV}$. In the NCSM, the many-body model space is truncated by the excitation quantum number $N_{\\max}$, which limits the total number of harmonic oscillator quanta above the lowest-energy Slater determinant configuration. The $^{6}\\text{Li}$ nucleus has $A=6$ nucleons with $Z=3$ protons and $N=3$ neutrons. The harmonic oscillator major shells are labeled by the principal quantum number $N=2n+\\ell$, where $n$ is the radial quantum number and $\\ell$ is the orbital angular momentum, and each single-particle state is further specified by the total angular momentum $j=\\ell\\pm\\frac{1}{2}$ and its projection $m$. \n\nStarting only from the definitions of the harmonic oscillator basis and the NCSM $N_{\\max}$ truncation, do the following:\n- Identify the lowest-energy configuration for $A=6$ nucleons in the harmonic oscillator basis and compute the corresponding total number of harmonic oscillator quanta $N_{0}$.\n- Using the definition of the NCSM truncation, determine all allowed even-parity many-body excitation values $N\\hbar\\Omega$ (i.e., all allowed values of the total number of excitation quanta relative to $N_{0}$) for $A=6$ with $N_{\\max}=4$.\n- In the $M$-scheme (basis of Slater determinants labeled by the projection $M$ of the total angular momentum), compute the many-body basis dimension for $^{6}\\text{Li}$ at the $0\\hbar\\Omega$ sector for total $M=1$. Treat protons and neutrons as distinguishable species occupying identical single-particle spaces and assume the $0s$ shell is completely filled in the lowest-energy configuration. \n\nExpress the final dimension as a single integer. No rounding is required. No physical units are required for the final answer.", "solution": "The problem asks for a multi-step analysis of the nucleus $^{6}\\text{Li}$ within the No-Core Shell Model (NCSM) framework. The analysis involves identifying the ground state configuration, determining allowed excitation energies under a specific truncation, and calculating a many-body basis dimension.\n\n### Part 1: Lowest-Energy Configuration and $N_0$\n\nThe single-particle basis is composed of states of a three-dimensional harmonic oscillator (HO). These states are organized into major shells labeled by the principal quantum number $N=2n+\\ell$, where $n$ is the radial quantum number and $\\ell$ is the orbital angular momentum. The energy of a nucleon in a state with principal quantum number $N$ is proportional to $N$. To find the lowest-energy configuration for an $A$-nucleon system, we fill these HO shells in order of increasing $N$, respecting the Pauli exclusion principle for protons and neutrons separately.\n\nThe HO shells and their degeneracies are:\n- $N=0$: $\\ell=0$ ($s$-shell). This is the $0s_{1/2}$ subshell with degeneracy $2j+1 = 2$.\n- $N=1$: $\\ell=1$ ($p$-shell). This shell contains the $0p_{3/2}$ (degeneracy $4$) and $0p_{1/2}$ (degeneracy $2$) subshells, for a total degeneracy of $6$.\n- $N=2$: $\\ell=0, 2$ ($sd$-shell), and so on.\n\nThe nucleus $^{6}\\text{Li}$ consists of $A=6$ nucleons: $Z=3$ protons and $N=3$ neutrons.\nTo construct the lowest-energy configuration, we place the nucleons in the lowest available energy shells.\n- **Protons ($Z=3$):** Two protons fill the $N=0$ shell ($0s_{1/2}$). The third proton must occupy a state in the next available shell, which is the $N=1$ shell ($p$-shell).\n- **Neutrons ($N=3$):** Similarly, two neutrons fill the $N=0$ shell ($0s_{1/2}$), and the third neutron occupies a state in the $N=1$ shell.\n\nThe total number of HO quanta for this configuration, denoted $N_0$, is the sum of the principal quantum numbers $N$ of all occupied single-particle states.\nFor the protons: $N_{0,p} = (2 \\times 0) + (1 \\times 1) = 1$.\nFor the neutrons: $N_{0,n} = (2 \\times 0) + (1 \\times 1) = 1$.\nThe total number of quanta for the lowest-energy configuration is the sum for protons and neutrons:\n$$N_0 = N_{0,p} + N_{0,n} = 1 + 1 = 2$$\n\n### Part 2: Allowed Even-Parity Excitation Values\n\nThe NCSM model space is truncated by $N_{\\max}$, which is the maximum number of HO excitation quanta allowed above the lowest-energy configuration. The number of excitation quanta for a given configuration with total quanta $N_{\\text{tot}}$ is $\\Delta N = N_{\\text{tot}} - N_0$. The truncation is given by $\\Delta N \\le N_{\\max}$.\nIn this problem, $N_0=2$ and $N_{\\max}=4$. Thus, the allowed values for $\\Delta N$ are $0, 1, 2, 3, 4$. The corresponding total quanta for allowed configurations are $N_{\\text{tot}} = N_0 + \\Delta N$, which gives $N_{\\text{tot}} \\in \\{2, 3, 4, 5, 6\\}$.\n\nThe parity of a many-body state is given by the product of the parities of the occupied single-particle states, $\\prod_{i=1}^{A} (-1)^{\\ell_i} = (-1)^{\\sum_{i=1}^{A} \\ell_i}$. The total number of quanta is $N_{\\text{tot}} = \\sum_{i=1}^{A} N_i = \\sum_{i=1}^{A} (2n_i + \\ell_i) = 2\\sum_{i=1}^{A} n_i + \\sum_{i=1}^{A} \\ell_i$. Since $2\\sum n_i$ is always even, the parity of $N_{\\text{tot}}$ is the same as the parity of $\\sum \\ell_i$. Therefore, the parity of a configuration is given by $(-1)^{N_{\\text{tot}}}$.\n\nThe problem asks for even-parity states, which means $(-1)^{N_{\\text{tot}}} = +1$. This requires $N_{\\text{tot}}$ to be an even integer. From the set of allowed total quanta $\\{2, 3, 4, 5, 6\\}$, we select the even values: $\\{2, 4, 6\\}$.\n\nThe corresponding excitation quanta $\\Delta N = N_{\\text{tot}} - N_0$ are:\n- For $N_{\\text{tot}}=2$, $\\Delta N = 2 - 2 = 0$.\n- For $N_{\\text{tot}}=4$, $\\Delta N = 4 - 2 = 2$.\n- For $N_{\\text{tot}}=6$, $\\Delta N = 6 - 2 = 4$.\n\nThe allowed even-parity many-body excitation values, expressed as $N\\hbar\\Omega$ where $N$ is the number of excitation quanta, are $0\\hbar\\Omega$, $2\\hbar\\Omega$, and $4\\hbar\\Omega$, with the given energy scale $\\hbar\\Omega=20\\,\\text{MeV}$.\n\n### Part 3: Many-Body Basis Dimension at $0\\hbar\\Omega$ for $M=1$\n\nThis task requires calculating the dimension of the many-body basis in the $0\\hbar\\Omega$ sector for a total angular momentum projection of $M=1$. The $0\\hbar\\Omega$ sector corresponds to $\\Delta N=0$, which is the lowest-energy configuration identified in Part 1.\n\nThe configuration is:\n- Protons: two in the $0s$ shell, one in the $0p$ shell. This can be written as $(0s)^2(0p)^1$.\n- Neutrons: two in the $0s$ shell, one in the $0p$ shell. This is also a $(0s)^2(0p)^1$ configuration.\nThe problem states that the $0s$ shell is completely filled. A filled $0s_{1/2}$ subshell contains two nucleons with projections $m_j=+1/2$ and $m_j=-1/2$. The total angular momentum projection from a filled subshell is always zero. Therefore, the two protons in the $0s$ shell contribute $M_p(0s)=0$ to the total projection, and the two neutrons in the $0s$ shell contribute $M_n(0s)=0$.\n\nThe total projection $M$ is determined solely by the two valence nucleons: one proton in the $0p$ shell and one neutron in the $0p$ shell. Let their individual projections be $m_{jp}$ and $m_{jn}$, respectively. The total projection is $M = m_{jp} + m_{jn}$. We need to find the number of ways to form a state with $M=1$.\n\nThe single-particle states in the $0p$ shell ($N=1, \\ell=1$) are split into two subshells, $j=\\ell \\pm 1/2$:\n- $0p_{3/2}$ ($j=3/2$): has states with $m_j \\in \\{-3/2, -1/2, +1/2, +3/2\\}$.\n- $0p_{1/2}$ ($j=1/2$): has states with $m_j \\in \\{-1/2, +1/2\\}$.\n\nLet's count the number of available single-particle states for a valence nucleon in the $p$-shell, categorized by their $m_j$ value. Let $d(m_j)$ be this number.\n- For $m_j = +3/2$: $1$ state (from $0p_{3/2}$).\n- For $m_j = +1/2$: $2$ states (one from $0p_{3/2}$ and one from $0p_{1/2}$).\n- For $m_j = -1/2$: $2$ states (one from $0p_{3/2}$ and one from $0p_{1/2}$).\n- For $m_j = -3/2$: $1$ state (from $0p_{3/2}$).\nThe total is $1+2+2+1=6$ states, as expected for the $p$-shell.\n\nSince protons and neutrons are distinguishable, the total number of many-body states with $M=1$ is the sum of products of the number of ways to choose the proton state and the neutron state for all combinations $(m_{jp}, m_{jn})$ that sum to $1$.\n$$ \\text{Dimension}(M=1) = \\sum_{m_{jp}, m_{jn} \\text{ where } m_{jp}+m_{jn}=1} d_p(m_{jp}) \\times d_n(m_{jn}) $$\nThe degeneracies $d_p$ and $d_n$ are identical to $d$ calculated above.\n\nWe list the combinations of $(m_{jp}, m_{jn})$ that sum to $M=1$:\n1.  $(m_{jp}, m_{jn}) = (+3/2, -1/2)$: The number of such states is $d_p(+3/2) \\times d_n(-1/2) = 1 \\times 2 = 2$.\n2.  $(m_{jp}, m_{jn}) = (+1/2, +1/2)$: The number of such states is $d_p(+1/2) \\times d_n(+1/2) = 2 \\times 2 = 4$.\n3.  $(m_{jp}, m_{jn}) = (-1/2, +3/2)$: The number of such states is $d_p(-1/2) \\times d_n(+3/2) = 2 \\times 1 = 2$.\n\nThe total dimension is the sum of these contributions:\n$$ \\text{Dimension}(M=1) = 2 + 4 + 2 = 8 $$\nThus, there are $8$ many-body basis states (Slater determinants) for $^{6}\\text{Li}$ in the $0\\hbar\\Omega$ sector with total angular momentum projection $M=1$.", "answer": "$$\\boxed{8}$$", "id": "3597229"}, {"introduction": "The size of the Hamiltonian matrix in CI calculations can become astronomically large, making its storage a significant bottleneck. This practice explores the immense practical benefit of exploiting symmetries, such as total angular momentum $J$ and isospin $T$, to reduce memory requirements for two-body matrix elements. By quantitatively comparing a symmetry-aware ($JT$-coupled) storage scheme with a more naive projection-based ($M$-scheme) approach, you will appreciate why symmetry adaptation is not just an elegant theoretical concept but a computational necessity [@problem_id:3597201].", "problem": "Consider a Configuration Interaction (CI) calculation in the nuclear shell model restricted to the $pf$-shell, assuming isospin symmetry and a rotationally invariant, isospin-symmetric two-body interaction. The $pf$-shell contains four orbital types labeled by their total single-particle angular momentum $j$: $0f_{7/2}$ with $j=\\frac{7}{2}$, $1p_{3/2}$ with $j=\\frac{3}{2}$, $0f_{5/2}$ with $j=\\frac{5}{2}$, and $1p_{1/2}$ with $j=\\frac{1}{2}$. Denote these orbitals by indices $a \\in \\{1,2,3,4\\}$ with $j_{1}=\\frac{7}{2}$, $j_{2}=\\frac{3}{2}$, $j_{3}=\\frac{5}{2}$, $j_{4}=\\frac{1}{2}$.\n\nYou will compute the memory needed to store antisymmetrized Two-Body Matrix Elements (TBMEs) in two different storage schemes:\n\n1. A total-angular-momentum and total-isospin coupled scheme (the $JT$-coupled scheme), where TBMEs are stored by blocks labeled by total two-body angular momentum $J$ and total isospin $T$. Within each $(J,T)$ block, the basis is formed by antisymmetrized two-body orbit pairs $(ab)$ with $a \\leq b$, where allowed $J$ values satisfy the standard $jj$-coupling triangle rule. For identical orbit pairs ($a=b$), impose the Pauli principle selection rules for half-integer $j$: for isotriplet states ($T=1$), only even $J$ values are allowed; for isosinglet states ($T=0$), only odd $J$ values are allowed. Exploit Hermiticity to store only the upper triangle of each real symmetric $(J,T)$ block.\n\n2. An uncoupled magnetic-projection scheme (the $M$-scheme), where TBMEs are stored separately for each projection $M$ of $J$ and each projection $T_{z}$ of $T$, without exploiting rotational or isospin reduction beyond projection conservation. Assume that for each $(J,T)$ block in the coupled scheme, one stores a distinct projection-resolved block for each $(M,T_{z})$, i.e., a multiplicity of $(2J+1)(2T+1)$ blocks, each with the same upper-triangle size as the corresponding $(J,T)$ block, consistent with the Wigner–Eckart theorem and the conservation of projections.\n\nUse double-precision floating point numbers for storage, with $8$ bytes per stored TBME. Let $n_{JT}(J,T)$ denote the number of allowed antisymmetrized orbit pairs $(ab)$ at given $(J,T)$, and let $N_{JT}(J,T) = \\frac{n_{JT}(J,T)\\left(n_{JT}(J,T)+1\\right)}{2}$ denote the number of independent real numbers stored in the upper triangle for that $(J,T)$ block. The total memory in the $JT$-coupled scheme is then $8 \\sum_{J,T} N_{JT}(J,T)$ bytes, while the total memory in the projection-resolved $M$-scheme is $8 \\sum_{J,T} (2J+1)(2T+1) N_{JT}(J,T)$ bytes.\n\nTasks:\n- Enumerate all antisymmetrized orbit pairs $(ab)$ with $a \\leq b$ in the $pf$-shell.\n- For each $(ab)$, determine the allowed total angular momenta $J$ using the triangle rule $|j_{a}-j_{b}| \\leq J \\leq j_{a}+j_{b}$. Apply the Pauli selection rules for $a=b$: even $J$ for $T=1$ and odd $J$ for $T=0$.\n- For each $J$ and $T \\in \\{0,1\\}$, count $n_{JT}(J,T)$, form $N_{JT}(J,T)$, and compute both total memory sums.\n- Finally, report the ratio $R$ of $M$-scheme memory to $JT$-coupled memory,\n$$\nR \\equiv \\frac{\\sum_{J,T} (2J+1)(2T+1) N_{JT}(J,T)}{\\sum_{J,T} N_{JT}(J,T)}.\n$$\n\nRound your final ratio $R$ to four significant figures. The final answer must be a single real number without units in the box.", "solution": "The configuration interaction storage problem can be derived from symmetry and combinatorics of two-body states in the $pf$-shell under rotational and isospin symmetry.\n\nFundamental base:\n- Rotational invariance implies two-body states can be classified by total angular momentum $J$; the allowed $J$ values for two single-particle states $j_{a}$ and $j_{b}$ follow the triangle rule $|j_{a}-j_{b}| \\leq J \\leq j_{a}+j_{b}$.\n- Isospin symmetry implies classification by total isospin $T \\in \\{0,1\\}$ for two nucleons with isospin $\\frac{1}{2}$.\n- The Pauli principle for identical fermions in $jj$-coupling and half-integer $j$ imposes selection rules for $a=b$: for $T=1$, only even $J$ values are allowed; for $T=0$, only odd $J$ values are allowed.\n- Hermiticity and time-reversal invariance allow storage of only the upper triangle of real symmetric matrices per $(J,T)$ block.\n\nStep 1: Enumerate orbit indices and $j$ values.\nWe label the $pf$-shell orbits by\n$$\nj_{1}=\\frac{7}{2}, \\quad j_{2}=\\frac{3}{2}, \\quad j_{3}=\\frac{5}{2}, \\quad j_{4}=\\frac{1}{2}.\n$$\nAll distinct antisymmetrized two-body orbit pairs $(ab)$ with $a \\leq b$ are\n$$\n(1,1),\\ (2,2),\\ (3,3),\\ (4,4),\\ (1,2),\\ (1,3),\\ (1,4),\\ (2,3),\\ (2,4),\\ (3,4).\n$$\n\nStep 2: Determine allowed $J$ sets per pair.\nFor $a=b$, apply the Pauli selection rules by $T$:\n- For $(1,1)$ with $j=\\frac{7}{2}$: $J \\in \\{0,1,2,3,4,5,6,7\\}$; allowed by $T$ are even $J$ for $T=1$ and odd $J$ for $T=0$,\n$$\nT=1: J \\in \\{0,2,4,6\\}, \\quad T=0: J \\in \\{1,3,5,7\\}.\n$$\n- For $(2,2)$ with $j=\\frac{3}{2}$: $J \\in \\{0,1,2,3\\}$; thus\n$$\nT=1: J \\in \\{0,2\\}, \\quad T=0: J \\in \\{1,3\\}.\n$$\n- For $(3,3)$ with $j=\\frac{5}{2}$: $J \\in \\{0,1,2,3,4,5\\}$; thus\n$$\nT=1: J \\in \\{0,2,4\\}, \\quad T=0: J \\in \\{1,3,5\\}.\n$$\n- For $(4,4)$ with $j=\\frac{1}{2}$: $J \\in \\{0,1\\}$; thus\n$$\nT=1: J \\in \\{0\\}, \\quad T=0: J \\in \\{1\\}.\n$$\n\nFor $a \\neq b$, the allowed $J$ are the full triangle sets, independent of $T$:\n- $(1,3)$: $|7/2-5/2|=1$ to $7/2+5/2=6$ gives $J \\in \\{1,2,3,4,5,6\\}$.\n- $(1,2)$: $|7/2-3/2|=2$ to $5$ gives $J \\in \\{2,3,4,5\\}$.\n- $(1,4)$: $|7/2-1/2|=3$ to $4$ gives $J \\in \\{3,4\\}$.\n- $(2,3)$: $|3/2-5/2|=1$ to $4$ gives $J \\in \\{1,2,3,4\\}$.\n- $(2,4)$: $|3/2-1/2|=1$ to $2$ gives $J \\in \\{1,2\\}$.\n- $(3,4)$: $|5/2-1/2|=2$ to $3$ gives $J \\in \\{2,3\\}$.\n\nStep 3: Count $n_{JT}(J,T)$, the number of allowed $(ab)$ pairs for given $J$ and $T$.\nWe tabulate by $J=0,1,2,3,4,5,6,7$, and for each $T \\in \\{0,1\\}$:\n\nFor $T=1$:\n- $J=0$: contributions from $(1,1),(2,2),(3,3),(4,4)$, so $n_{JT}(0,1)=4$.\n- $J=1$: from different-orbit pairs $(1,3),(2,3),(2,4)$, so $n_{JT}(1,1)=3$.\n- $J=2$: from same-orbit $(1,1),(2,2),(3,3)$ and different-orbit $(1,3),(1,2),(2,3),(2,4),(3,4)$, yielding $n_{JT}(2,1)=8$.\n- $J=3$: from different-orbit $(1,3),(1,2),(1,4),(2,3),(3,4)$, so $n_{JT}(3,1)=5$.\n- $J=4$: from same-orbit $(1,1),(3,3)$ and different-orbit $(1,3),(1,2),(1,4),(2,3)$, giving $n_{JT}(4,1)=6$.\n- $J=5$: from different-orbit $(1,3),(1,2)$, so $n_{JT}(5,1)=2$.\n- $J=6$: from same-orbit $(1,1)$ and different-orbit $(1,3)$, so $n_{JT}(6,1)=2$.\n- $J=7$: none for $T=1$, so $n_{JT}(7,1)=0$.\n\nFor $T=0$:\n- $J=0$: none, so $n_{JT}(0,0)=0$.\n- $J=1$: from same-orbit $(1,1),(2,2),(3,3),(4,4)$ and different-orbit $(1,3),(2,3),(2,4)$, giving $n_{JT}(1,0)=7$.\n- $J=2$: from different-orbit $(1,3),(1,2),(2,3),(2,4),(3,4)$, so $n_{JT}(2,0)=5$.\n- $J=3$: from same-orbit $(1,1),(2,2),(3,3)$ and different-orbit $(1,3),(1,2),(1,4),(2,3),(3,4)$, yielding $n_{JT}(3,0)=8$.\n- $J=4$: from different-orbit $(1,3),(1,2),(1,4),(2,3)$, so $n_{JT(4,0)}=4$.\n- $J=5$: from same-orbit $(1,1),(3,3)$ and different-orbit $(1,3),(1,2)$, giving $n_{JT}(5,0)=4$.\n- $J=6$: from different-orbit $(1,3)$ only, so $n_{JT}(6,0)=1$.\n- $J=7$: from same-orbit $(1,1)$ only, so $n_{JT}(7,0)=1$.\n\nAs a consistency check, the total counts of pair–$J$ combinations satisfy\n$$\n\\sum_{J} n_{JT}(J,1)=30, \\quad \\sum_{J} n_{JT}(J,0)=30,\n$$\nmatching the sum of allowed $J$ values across all $10$ pairs for each $T$ sector.\n\nStep 4: Compute $N_{JT}(J,T) = \\frac{n_{JT}(J,T)\\left(n_{JT}(J,T)+1\\right)}{2}$, the number of independent real numbers per $(J,T)$ block, and sum.\n\nFor $T=1$:\n- $J=0$: $n=4 \\Rightarrow N=\\frac{4 \\times 5}{2}=10$.\n- $J=1$: $n=3 \\Rightarrow N=\\frac{3 \\times 4}{2}=6$.\n- $J=2$: $n=8 \\Rightarrow N=\\frac{8 \\times 9}{2}=36$.\n- $J=3$: $n=5 \\Rightarrow N=\\frac{5 \\times 6}{2}=15$.\n- $J=4$: $n=6 \\Rightarrow N=\\frac{6 \\times 7}{2}=21$.\n- $J=5$: $n=2 \\Rightarrow N=\\frac{2 \\times 3}{2}=3$.\n- $J=6$: $n=2 \\Rightarrow N=3$.\n- $J=7$: $n=0 \\Rightarrow N=0$.\nSum over $J$: \n$$\n\\sum_{J} N_{JT}(J,1) = 10+6+36+15+21+3+3 = 94.\n$$\n\nFor $T=0$:\n- $J=0$: $n=0 \\Rightarrow N=0$.\n- $J=1$: $n=7 \\Rightarrow N=\\frac{7 \\times 8}{2}=28$.\n- $J=2$: $n=5 \\Rightarrow N=15$.\n- $J=3$: $n=8 \\Rightarrow N=36$.\n- $J=4$: $n=4 \\Rightarrow N=10$.\n- $J=5$: $n=4 \\Rightarrow N=10$.\n- $J=6$: $n=1 \\Rightarrow N=1$.\n- $J=7$: $n=1 \\Rightarrow N=1$.\nSum over $J$:\n$$\n\\sum_{J} N_{JT}(J,0) = 28+15+36+10+10+1+1 = 101.\n$$\n\nTotal independent TBMEs in the $JT$-coupled scheme:\n$$\nN_{\\mathrm{JT,tot}} = \\sum_{J,T} N_{JT}(J,T) = 94 + 101 = 195.\n$$\nTotal memory in bytes:\n$$\nM_{\\mathrm{JT}} = 8 \\times N_{\\mathrm{JT,tot}} = 8 \\times 195 = 1560 \\text{ bytes}.\n$$\n\nStep 5: Compute the projection-resolved $M$-scheme memory assuming separate storage for each projection $(M,T_{z})$ per $(J,T)$ block. For each $(J,T)$, the multiplicity is $(2J+1)(2T+1)$; thus the total number of stored numbers is\n$$\nN_{\\mathrm{M,tot}} = \\sum_{J,T} (2J+1)(2T+1)\\, N_{JT}(J,T).\n$$\nWe evaluate this sum by $T$ sector.\n\nFor $T=1$ (where $2T+1=3$):\n- $J=0$: $(2J+1)(2T+1) = 1 \\times 3 = 3$, $N=10 \\Rightarrow 30$.\n- $J=1$: $3 \\times 3 = 9$, $N=6 \\Rightarrow 54$.\n- $J=2$: $5 \\times 3 = 15$, $N=36 \\Rightarrow 540$.\n- $J=3$: $7 \\times 3 = 21$, $N=15 \\Rightarrow 315$.\n- $J=4$: $9 \\times 3 = 27$, $N=21 \\Rightarrow 567$.\n- $J=5$: $11 \\times 3 = 33$, $N=3 \\Rightarrow 99$.\n- $J=6$: $13 \\times 3 = 39$, $N=3 \\Rightarrow 117$.\n- $J=7$: $N=0 \\Rightarrow 0$.\nSum:\n$$\n\\sum_{J} (2J+1)(2T+1) N_{JT}(J,1) = 30+54+540+315+567+99+117 = 1722.\n$$\n\nFor $T=0$ (where $2T+1=1$):\n- $J=1$: $(2J+1)=3$, $N=28 \\Rightarrow 84$.\n- $J=2$: $5$, $N=15 \\Rightarrow 75$.\n- $J=3$: $7$, $N=36 \\Rightarrow 252$.\n- $J=4$: $9$, $N=10 \\Rightarrow 90$.\n- $J=5$: $11$, $N=10 \\Rightarrow 110$.\n- $J=6$: $13$, $N=1 \\Rightarrow 13$.\n- $J=7$: $15$, $N=1 \\Rightarrow 15$.\nSum:\n$$\n\\sum_{J} (2J+1)(2T+1) N_{JT}(J,0) = 84+75+252+90+110+13+15 = 639.\n$$\n\nTherefore,\n$$\nN_{\\mathrm{M,tot}} = 1722 + 639 = 2361, \\quad M_{\\mathrm{M}} = 8 \\times 2361 = 18888 \\text{ bytes}.\n$$\n\nStep 6: Compute and report the ratio of $M$-scheme to $JT$-coupled memory,\n$$\nR = \\frac{M_{\\mathrm{M}}}{M_{\\mathrm{JT}}} = \\frac{8 \\times 2361}{8 \\times 195} = \\frac{2361}{195}.\n$$\nWe simplify numerically:\n$$\n195 \\times 12 = 2340, \\quad 2361 - 2340 = 21, \\quad \\frac{21}{195} = 0.107692\\ldots,\n$$\nhence\n$$\nR = 12.107692\\ldots.\n$$\nRounded to four significant figures,\n$$\nR \\approx 12.11.\n$$\n\nThis ratio quantifies the symmetry reduction advantage of the $JT$-coupled storage relative to storing projection-resolved $M$-scheme elements under the stated assumptions.", "answer": "$$\\boxed{12.11}$$", "id": "3597201"}, {"introduction": "Modern large-scale CI codes often compute the action of the Hamiltonian on a basis state \"on-the-fly\" to avoid storing the full matrix. This exercise delves into the core algorithm for this procedure, connecting the abstract formalism of second quantization to a concrete computational implementation. You will learn how to represent many-body states using bitstrings and derive the rules for calculating the crucial fermionic sign that arises when applying creation and annihilation operators, a fundamental task in programming any CI solver [@problem_id:3597211].", "problem": "You are working within the configuration interaction approach for computational nuclear physics using a fixed $M$-scheme basis. Consider two distinguishable fermion species, protons and neutrons, each occupying a finite set of single-particle orbitals labeled by nonnegative integers in ascending order. A many-body basis state is a Slater determinant constructed by applying creation operators, ordered by increasing single-particle index, onto the vacuum. The canonical anticommutation relations hold for all creation and annihilation operators, both within and across species. You will adopt the following explicit conventions, which you must use throughout:\n\n- Bitstring encoding: Represent the proton sector by a nonnegative integer $B_p$ and the neutron sector by a nonnegative integer $B_n$. The least significant bit corresponds to single-particle index $0$, and bit $i$ indicates occupancy of orbital $i$. For example, setting bits at indices $\\{1,3,5\\}$ yields $B_p=2^1+2^3+2^5$.\n- Global mode ordering: All proton modes come before all neutron modes in the global ordering of fermionic modes. Equivalently, in the canonical product that defines a Slater determinant, all proton creation operators appear to the left of all neutron creation operators.\n- Operator application ordering: An operator string written as a product from left to right $O_L \\cdots O_2 O_1$ is applied right-to-left to a basis state, i.e., $O_1$ acts first.\n- One-body operator: $a_p^\\dagger a_q$ in a given species acts by annihilating at index $q$ then creating at index $p$.\n- Two-body operator: $a_p^\\dagger a_r^\\dagger a_s a_q$ in a given species acts by annihilating at indices $q$ and $s$, then creating at $r$ and $p$, respecting the explicit left-to-right order of operators. For proton-neutron mixed operators, use the same ordering, with proton creation/annihilation denoted by $a^\\dagger, a$ and neutron creation/annihilation by $b^\\dagger, b$.\n\nStarting from the fundamental base of the fermionic canonical anticommutation relations and the definition of a Slater determinant as an ordered product of creation operators, derive an algorithm that computes the fermionic sign for valid one-body and two-body excitations in constant time per operator using only:\n\n- Bit manipulations on the occupation integers $B_p$ and $B_n$.\n- Population counts of subsets of bits below a given index.\n\nYour derivation must explain why the fermionic sign produced by $a_q$ on a determinant equals $(-1)^{N_{\\mathrm{cross}} + N_{<q}}$, where $N_{<q}$ is the number of occupied orbitals with index less than $q$ in the relevant species, and $N_{\\mathrm{cross}}$ counts occupied modes in all globally earlier species (with the above ordering, neutrons acquire a cross term $N_{\\mathrm{cross}}$ equal to the current number of occupied protons, while protons have $N_{\\mathrm{cross}}=0$). Similarly, explain the corresponding rule for $a_p^\\dagger$ on the intermediate state after prior operators in the string have acted. Show that invalid actions (annihilating an unoccupied orbital or creating into an already occupied orbital) yield zero amplitude.\n\nThen implement the algorithm to evaluate amplitudes for the test suite below, where each amplitude is the integer in $\\{-1,0,1\\}$ equal to the product of the fermionic sign factors if and only if the action is valid; otherwise it is $0$.\n\nUse the following fixed single-particle dimensions: there are $8$ proton orbitals and $8$ neutron orbitals, indexed $0$ through $7$ in each species. All test cases share the same initial determinant with proton occupation indices $\\{1,3,5\\}$ and neutron occupation indices $\\{0,2,6\\}$, i.e., $B_p=2^1+2^3+2^5=42$ and $B_n=2^0+2^2+2^6=69$.\n\nFor each test case, the operator string is given left-to-right. Your program must apply it right-to-left and compute the resulting amplitude as described.\n\nTest suite (each bullet is one case, in this order):\n\n- Case $1$ (proton one-body, valid): $a_4^\\dagger a_3$.\n- Case $2$ (proton one-body, invalid annihilation): $a_5^\\dagger a_0$.\n- Case $3$ (proton one-body, invalid creation): $a_3^\\dagger a_1$.\n- Case $4$ (neutron one-body, valid with cross-species sign): $b_5^\\dagger b_2$.\n- Case $5$ (proton two-body within species): $a_6^\\dagger a_4^\\dagger a_5 a_3$.\n- Case $6$ (neutron two-body within species, with cross-species sign at each neutron operator): $b_7^\\dagger b_1^\\dagger b_2 b_6$.\n- Case $7$ (proton-neutron mixed two-body): $a_4^\\dagger b_5^\\dagger b_2 a_1$.\n- Case $8$ (proton two-body, invalid repeated annihilation): $a_6^\\dagger a_4^\\dagger a_2 a_2$.\n- Case $9$ (neutron one-body, boundary indices): $b_7^\\dagger b_0$.\n\nFinal output format: Your program should produce a single line of output containing the amplitudes for Cases $1$ through $9$ as a comma-separated list enclosed in square brackets, for example, $[x_1,x_2,\\dots,x_9]$, where each $x_i$ is an integer in $\\{-1,0,1\\}$. No spaces are permitted. Angles are not used in this problem. No physical units are involved. All numeric answers must be provided exactly as integers in the prescribed list format.", "solution": "The problem is valid as it is scientifically grounded in the principles of quantum many-body theory, specifically the configuration interaction method using a second-quantized formalism. It is well-posed, with all necessary definitions, initial conditions, and constraints provided, leading to a unique, verifiable solution. The language is objective and formal.\n\nThe core of the problem is to derive and implement an algorithm for calculating the amplitude (sign factor or zero) of one- and two-body fermionic operators acting on a Slater determinant. The state is represented by bitstrings, and the algorithm must rely on bitwise manipulations.\n\n### 1. State Representation and Operator Conventions\n\nA many-body basis state is a Slater determinant formed by applying creation operators to the vacuum state $|0\\rangle$. The problem specifies a global ordering where all proton modes precede all neutron modes. Within each species (protons or neutrons), creation operators are ordered by increasing single-particle index. A state with $N_p$ protons in orbitals $\\{p_1, \\dots, p_{N_p}\\}$ and $N_n$ neutrons in orbitals $\\{n_1, \\dots, n_{N_n}\\}$ is defined as:\n$$ |\\Psi\\rangle = (a_{p_1}^\\dagger a_{p_2}^\\dagger \\cdots a_{p_{N_p}}^\\dagger) (b_{n_1}^\\dagger b_{n_2}^\\dagger \\cdots b_{n_{N_n}}^\\dagger) |0\\rangle $$\nwhere $p_1 < p_2 < \\dots < p_{N_p}$ and $n_1 < n_2 < \\dots < n_{N_n}$. The operators $a^\\dagger/a$ and $b^\\dagger/b$ are for protons and neutrons, respectively.\n\nThe fundamental rules governing these operators are the canonical anticommutation relations (CARs). For operators of the same species (let's use a generic symbol $c$):\n$$ \\{c_i, c_j\\} = 0, \\quad \\{c_i^\\dagger, c_j^\\dagger\\} = 0, \\quad \\{c_i, c_j^\\dagger\\} = \\delta_{ij} $$\nFor operators of different species (protons and neutrons), all operators anticommute:\n$$ \\{a_i, b_j\\} = \\{a_i^\\dagger, b_j\\} = \\{a_i, b_j^\\dagger\\} = \\{a_i^\\dagger, b_j^\\dagger\\} = 0 $$\nThe bitstring encoding represents the occupation of single-particle orbitals. An integer $B$ has bit $i$ set if orbital $i$ is occupied. For example, $B_p = \\sum_{k \\in \\text{occupied protons}} 2^k$.\n\n### 2. Derivation for Annihilation Operator $c_q$\n\nAn operator string is applied right-to-left. Let's analyze the action of a single annihilation operator $c_q$ on the state $|\\Psi\\rangle$.\n\n**Case I: Proton Annihilation ($a_q$)**\nThe operator $a_q$ acts on $|\\Psi\\rangle = (\\prod_{i} a_{p_i}^\\dagger) (\\prod_{j} b_{n_j}^\\dagger) |0\\rangle$. Since $a_q$ anticommutes with all $b^\\dagger_j$, it can be moved past the neutron operator product without any sign change. The problem reduces to its action on the proton part of the state:\n$$ a_q |\\Psi\\rangle = (a_q a_{p_1}^\\dagger \\cdots a_{p_{N_p}}^\\dagger) (\\prod_{j} b_{n_j}^\\dagger) |0\\rangle $$\nIf orbital $q$ is not in the set of occupied proton orbitals $\\{p_k\\}$, then $a_q$ anticommutes with all $a_{p_k}^\\dagger$. It moves to the right until it acts on the vacuum, $a_q|0\\rangle = 0$. The resulting state is the null vector, so the amplitude is $0$.\n\nIf orbital $q$ is occupied, say $q=p_k$ for some $k \\in \\{1,\\dots,N_p\\}$, we must move $a_q$ past the creation operators $a_{p_1}^\\dagger, \\dots, a_{p_{k-1}}^\\dagger$. This requires $k-1$ anticommutations, each introducing a factor of $-1$.\n$$ a_q a_{p_1}^\\dagger \\cdots a_{p_{k-1}}^\\dagger a_{p_k}^\\dagger \\cdots |0\\rangle = (-1)^{k-1} a_{p_1}^\\dagger \\cdots a_{p_{k-1}}^\\dagger (a_q a_{p_k}^\\dagger) \\cdots |0\\rangle $$\nUsing $\\{a_q, a_{p_k}^\\dagger\\}=1$ (since $q=p_k$), we have $a_q a_q^\\dagger = 1 - a_q^\\dagger a_q$. The term $a_q^\\dagger a_q$ will annihilate the subsequent state as $q$ is no longer an occupied orbital. Therefore, $a_q a_q^\\dagger$ effectively acts as $1$. The resulting sign is $(-1)^{k-1}$. The value $k-1$ is precisely the number of occupied proton orbitals with an index less than $q$. We denote this $N_{<q}^{(p)}$. The problem statement gives the sign rule $(-1)^{N_{\\mathrm{cross}} + N_{<q}}$. For protons, the global ordering implies $N_{\\mathrm{cross}}=0$, so the sign is $(-1)^{N_{<q}^{(p)}}$, which matches our derivation.\n\n**Case II: Neutron Annihilation ($b_q$)**\nThe operator $b_q$ must first be moved past the entire product of $N_p$ proton creation operators. This yields a sign of $(-1)^{N_p}$:\n$$ b_q |\\Psi\\rangle = (-1)^{N_p} (\\prod_{i} a_{p_i}^\\dagger) (b_q \\prod_{j} b_{n_j}^\\dagger) |0\\rangle $$\nThe action of $b_q$ on the neutron part of the state proceeds as in Case I, yielding an additional sign of $(-1)^{N_{<q}^{(n)}}$, where $N_{<q}^{(n)}$ is the number of occupied neutron orbitals with an index less than $q$. The total sign is the product $(-1)^{N_p} (-1)^{N_{<q}^{(n)}} = (-1)^{N_p + N_{<q}^{(n)}}$. This matches the formula with $N_{\\mathrm{cross}} = N_p$, the number of occupied protons.\n\n### 3. Derivation for Creation Operator $c_p^\\dagger$\n\nA creation operator $c_p^\\dagger$ acts on an intermediate state $|\\Psi'\\rangle$ that is the result of any preceding annihilations.\n\nIf orbital $p$ is already occupied in $|\\Psi'\\rangle$, applying $c_p^\\dagger$ results in a state containing $c_p^\\dagger c_p^\\dagger$. Due to the CAR $\\{c_p^\\dagger, c_p^\\dagger\\} = 2(c_p^\\dagger)^2 = 0$, the resulting state is the null vector, and the amplitude is $0$.\n\nIf orbital $p$ is unoccupied, the action is valid. The new state $c_p^\\dagger |\\Psi'\\rangle$ must be reordered to maintain the canonical form (creation operators sorted by index). To do this, $c_p^\\dagger$ must be moved past all creation operators of the same species in $|\\Psi'\\rangle$ that have an index less than $p$. The number of such swaps is $N_{<p}$, the number of occupied orbitals of that species with index less than $p$. This gives a sign factor of $(-1)^{N_{<p}}$.\n\nSimilar to the annihilation case, for a neutron creation operator $b_p^\\dagger$, it must also be permuted past all $N'_p$ proton creation operators present in the state $|\\Psi'\\rangle$, yielding an additional factor of $(-1)^{N'_p}$. The total sign is $(-1)^{N'_p + N_{<p}^{(n)}}$. Note that $N'_p$ is the number of protons in the intermediate state $|\\Psi'\\rangle$, which might differ from the initial number if proton operators have already acted.\n\n### 4. Application to Composite Operators\n\nA one-body operator $a_p^\\dagger a_q$ or a two-body operator $a_p^\\dagger a_r^\\dagger a_s a_q$ is a string of elementary operators. According to the problem, the string is applied from right to left. The total amplitude is the product of the amplitudes from each elementary operation. If any step is invalid (annihilating an empty orbital or creating into an occupied one), the final amplitude is $0$.\n\nFor example, for $a_p^\\dagger a_r^\\dagger a_s a_q |\\Psi\\rangle$:\n1.  Apply $a_q$ to $|\\Psi\\rangle$. If invalid, amplitude is $0$. Otherwise, get sign $S_1$ and state $|\\Psi_1\\rangle$.\n2.  Apply $a_s$ to $|\\Psi_1\\rangle$. If invalid, amplitude is $0$. Otherwise, get sign $S_2$ and state $|\\Psi_2\\rangle$.\n3.  Apply $a_r^\\dagger$ to $|\\Psi_2\\rangle$. If invalid, amplitude is $0$. Otherwise, get sign $S_3$ and state $|\\Psi_3\\rangle$. Note that the signs for neutron operators depend on the number of protons in $|\\Psi_2\\rangle$.\n4.  Apply $a_p^\\dagger$ to $|\\Psi_3\\rangle$. If invalid, amplitude is $0$. Otherwise, get sign $S_4$ and final state $|\\Psi_4\\rangle$.\nThe total amplitude is the product $S_1 S_2 S_3 S_4$.\n\n### 5. Algorithmic Implementation\n\nThe derived rules translate directly into an efficient algorithm using bitwise operations on the occupation integers $B_p$ and $B_n$.\n\n-   **Check Occupancy**: Orbital $k$ is occupied in state $B$ if `(B >> k) & 1 == 1`.\n-   **Count Occupied Orbitals ($N_{<k}$)**: The number of occupied orbitals with index less than $k$ in state $B$ is the population count (number of set bits) of the integer formed by the low-order bits of $B$. This is calculated as `(B & ((1 << k) - 1)).bit_count()`.\n-   **Annihilation at $q$ on state $B$**:\n    1.  Check if orbital $q$ is occupied. If not, amplitude is $0$.\n    2.  Calculate the sign exponent. For protons, it's $N_{<q}^{(p)}$. For neutrons, it's $N_p + N_{<q}^{(n)}$, where $N_p$ is the population count of the current proton state $B_p$.\n    3.  Update state: $B' = B \\oplus (1 \\ll q)$.\n-   **Creation at $p$ on state $B$**:\n    1.  Check if orbital $p$ is occupied. If yes, amplitude is $0$.\n    2.  Calculate the sign exponent using the same rules on the current state $B$.\n    3.  Update state: $B' = B \\oplus (1 \\ll p)$.\n\nThis algorithm evaluates each elementary operator action in constant time (assuming a hardware `popcount` instruction, standard on modern CPUs and available in Python $\\ge 3.10$ as `int.bit_count()`), as requested.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the fermionic amplitudes for a series of one- and two-body operators\n    acting on a specified initial nuclear state.\n    \"\"\"\n    # Initial state from the problem description\n    # Proton occupation {1,3,5}: B_p = 2^1 + 2^3 + 2^5 = 42\n    # Neutron occupation {0,2,6}: B_n = 2^0 + 2^2 + 2^6 = 69\n    bp_initial = 42\n    bn_initial = 69\n\n    # Test cases defined as lists of elementary operations.\n    # Each operation is a tuple: (species, type, index)\n    # species: 'p' (proton) or 'n' (neutron)\n    # type: 'a' (annihilate) or 'c' (create)\n    # index: orbital index (integer)\n    # The order of operations in each list corresponds to the right-to-left\n    # application of the operator string.\n    test_cases = [\n        # Case 1: a_4^† a_3\n        [('p', 'a', 3), ('p', 'c', 4)],\n        # Case 2: a_5^† a_0\n        [('p', 'a', 0), ('p', 'c', 5)],\n        # Case 3: a_3^† a_1\n        [('p', 'a', 1), ('p', 'c', 3)],\n        # Case 4: b_5^† b_2\n        [('n', 'a', 2), ('n', 'c', 5)],\n        # Case 5: a_6^† a_4^† a_5 a_3\n        [('p', 'a', 3), ('p', 'a', 5), ('p', 'c', 4), ('p', 'c', 6)],\n        # Case 6: b_7^† b_1^† b_2 b_6\n        [('n', 'a', 6), ('n', 'a', 2), ('n', 'c', 1), ('n', 'c', 7)],\n        # Case 7: a_4^† b_5^† b_2 a_1\n        [('p', 'a', 1), ('n', 'a', 2), ('n', 'c', 5), ('p', 'c', 4)],\n        # Case 8: a_6^† a_4^† a_2 a_2\n        [('p', 'a', 2), ('p', 'a', 2), ('p', 'c', 4), ('p', 'c', 6)],\n        # Case 9: b_7^† b_0\n        [('n', 'a', 0), ('n', 'c', 7)],\n    ]\n\n    results = []\n\n    def popcount_lt(b, idx):\n        \"\"\"\n        Counts the number of set bits in integer b for indices less than idx.\n        This corresponds to the term N_{<k} in the sign calculation.\n        \"\"\"\n        if idx == 0:\n            return 0\n        mask = (1 << idx) - 1\n        return (b & mask).bit_count()\n\n    for ops in test_cases:\n        bp_current = bp_initial\n        bn_current = bn_initial\n        amplitude = 1\n\n        for species, op_type, index in ops:\n            if amplitude == 0:\n                break\n            \n            cross_term_exp = 0\n            if species == 'p':\n                state_to_act_on = bp_current\n            else:  # species == 'n'\n                state_to_act_on = bn_current\n                # The cross-term is the current number of protons\n                cross_term_exp = bp_current.bit_count()\n\n            is_occupied = (state_to_act_on >> index) & 1\n\n            if op_type == 'a':  # Annihilation\n                if not is_occupied:\n                    amplitude = 0\n                    continue\n                \n                local_exp = popcount_lt(state_to_act_on, index)\n                exponent = local_exp + cross_term_exp\n                if exponent % 2 != 0:\n                    amplitude *= -1\n                \n                # Update state by flipping the bit\n                if species == 'p':\n                    bp_current ^= (1 << index)\n                else:\n                    bn_current ^= (1 << index)\n\n            else:  # op_type == 'c', Creation\n                if is_occupied:\n                    amplitude = 0\n                    continue\n\n                local_exp = popcount_lt(state_to_act_on, index)\n                exponent = local_exp + cross_term_exp\n                if exponent % 2 != 0:\n                    amplitude *= -1\n                \n                # Update state by flipping the bit\n                if species == 'p':\n                    bp_current ^= (1 << index)\n                else:\n                    bn_current ^= (1 << index)\n\n        results.append(amplitude)\n\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3597211"}]}