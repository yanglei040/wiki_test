{"hands_on_practices": [{"introduction": "This practice focuses on the transfer matrix method, an exact and powerful technique for calculating transmission probabilities through potentials composed of piecewise-constant segments. By deriving the method from the fundamental principles of the Schrödinger equation and wavefunction continuity, you will gain a deep, operational understanding of how wave mechanics is applied at interfaces. This skill is foundational for modeling a wide range of quantum systems, from semiconductor heterostructures to nuclear potential models [@problem_id:3575889].", "problem": "Consider a non-relativistic particle of mass $m$ incident from the left on a one-dimensional, piecewise-constant potential $V(x)$ composed of a finite sequence of layers, each with constant potential value and finite width, embedded between semi-infinite constant-potential leads to the left and to the right. Your goal is to compute the transmission probability through the structure using the transfer matrix method, starting from the time-independent Schrödinger equation. You must derive, implement, and use the method without resorting to any pre-tabulated formulas.\n\nStart from the time-independent Schrödinger equation for a particle of mass $m$ and energy $E$ in one spatial dimension,\n$$\n-\\frac{\\hbar^2}{2m}\\frac{d^2\\psi(x)}{dx^2} + V(x)\\psi(x) = E \\psi(x),\n$$\nand the requirement that both the wavefunction $\\psi(x)$ and its spatial derivative $d\\psi(x)/dx$ are continuous at each interface of the piecewise-constant potential. In each region where the potential is constant, the general solution is a superposition of right- and left-propagating plane waves when $E$ is above the local potential, and decaying or growing exponentials when $E$ is below the local potential. From these facts alone, derive a layer-by-layer linear representation that connects the right/left amplitudes in the left lead to those in the right lead. Use this representation to obtain the transmission amplitude for an incident wave from the left and then the transmission probability. Assume that the particle mass $m$ is constant across all regions. You must justify each step of your derivation from the above base principles only.\n\nAdopt the following physically consistent unit convention common in computational nuclear physics:\n- Energies must be in mega-electronvolts (MeV).\n- Lengths must be in femtometers (fm).\n- Masses must be in mega-electronvolts per speed-of-light squared (MeV/c$^2$).\n- Use the constant $\\hbar c = 197.3269804$ MeV·fm.\n- In each homogeneous region with constant potential $V$, define the complex wave number\n$$\nk = \\frac{\\sqrt{2mc^2(E - V)}}{\\hbar c},\n$$\nwhere the square root is taken on the complex plane so that for $E<V$ one obtains a purely imaginary $k = i\\kappa$ with real $\\kappa>0$. The transmission probability you must output is a real, dimensionless number between $0$ and $1$ (inclusive).\n\nAlgorithmic requirements:\n- Construct a transfer representation that composes, in the correct physical order, the interface matching conditions and the free propagation within each layer of finite width.\n- Ensure numerical stability for evanescent waves by using complex arithmetic for amplitudes and wave numbers.\n- Assume that in all test cases below, $E>V_{\\text{left lead}}$ and $E>V_{\\text{right lead}}$, so that the asymptotic wave numbers in both leads are real and positive.\n- If any intermediate region happens to satisfy $E=V$ within numerical precision (which would yield $k=0$), your implementation must handle the limit in a way that avoids division by zero. A practical approach is to regularize wave numbers whose magnitude is below a small threshold to a small non-zero complex value.\n\nTest suite:\nFor each test case, compute the transmission probability and output it as a decimal float. All constants and parameters are given explicitly. The semi-infinite leads are modeled as constant potentials $V_{\\mathrm{L}}$ (left) and $V_{\\mathrm{R}}$ (right). The internal layered structure is given as an ordered list of $(V_j, L_j)$ pairs, with $V_j$ in MeV and $L_j$ in fm, for $j=1,\\dots,N$.\n\nUse the particle mass $m = 938.2720813$ MeV/c$^2$ and $\\hbar c = 197.3269804$ MeV·fm for all test cases.\n\n- Test case A (single sub-barrier rectangular barrier):\n  - $E = 10.0$ MeV,\n  - $V_{\\mathrm{L}} = 0.0$ MeV, $V_{\\mathrm{R}} = 0.0$ MeV,\n  - Layers: $\\big[(V_1,L_1)\\big] = \\big[(20.0,\\,5.0)\\big]$.\n\n- Test case B (single over-barrier rectangular barrier):\n  - $E = 30.0$ MeV,\n  - $V_{\\mathrm{L}} = 0.0$ MeV, $V_{\\mathrm{R}} = 0.0$ MeV,\n  - Layers: $\\big[(V_1,L_1)\\big] = \\big[(20.0,\\,5.0)\\big]$.\n\n- Test case C (double barrier with central well near resonance conditions):\n  - $E = 5.0$ MeV,\n  - $V_{\\mathrm{L}} = 0.0$ MeV, $V_{\\mathrm{R}} = 0.0$ MeV,\n  - Layers: $\\big[(V_1,L_1),(V_2,L_2),(V_3,L_3)\\big] = \\big[(25.0,\\,2.0),\\,(0.0,\\,6.4),\\,(25.0,\\,2.0)\\big]$.\n\n- Test case D (no barrier sanity check):\n  - $E = 10.0$ MeV,\n  - $V_{\\mathrm{L}} = 0.0$ MeV, $V_{\\mathrm{R}} = 0.0$ MeV,\n  - Layers: empty list $\\big[\\,\\big]$ (no internal layers).\n\nFinal output format:\nYour program must compute the transmission probability for each test case and produce a single line of output containing the four results as a comma-separated list enclosed in square brackets, with each float formatted to exactly eight digits after the decimal point, for example, $\\big[\\text{resultA},\\text{resultB},\\text{resultC},\\text{resultD}\\big]$. The results are unitless probabilities in the closed interval $[0,1]$ represented in decimal form (no scientific notation). No other text should be printed.", "solution": "The problem requires the calculation of the transmission probability for a quantum particle through a one-dimensional, piecewise-constant potential structure. The method to be used is the transfer matrix formalism, derived from the first principles of quantum mechanics, namely the time-independent Schrödinger equation and the continuity of the wavefunction and its first derivative.\n\nLet us begin by analyzing a single homogeneous region $j$ with constant potential $V_j$. The one-dimensional time-independent Schrödinger equation is\n$$\n-\\frac{\\hbar^2}{2m}\\frac{d^2\\psi(x)}{dx^2} + V_j\\psi(x) = E \\psi(x)\n$$\nThis can be rewritten as\n$$\n\\frac{d^2\\psi(x)}{dx^2} + k_j^2\\psi(x) = 0\n$$\nwhere $k_j$ is the complex wave number defined as\n$$\nk_j = \\frac{\\sqrt{2mc^2(E - V_j)}}{\\hbar c}\n$$\nThe use of the complex square root ensures that for the case of a potential barrier where the energy $E$ is less than the potential $V_j$, the wave number becomes purely imaginary, $k_j = i\\kappa_j$, with a real, positive decay constant $\\kappa_j = \\frac{\\sqrt{2mc^2(V_j - E)}}{\\hbar c}$.\n\nThe state of the particle at any point $x$ can be fully described by a two-component vector containing the wavefunction $\\psi(x)$ and its spatial derivative $\\psi'(x)$:\n$$\n\\vec{\\Psi}(x) = \\begin{pmatrix} \\psi(x) \\\\ \\psi'(x) \\end{pmatrix}\n$$\nThe general solution to the Schrödinger equation in region $j$ can be expressed as a linear combination of two independent solutions. A convenient basis is $\\{\\cos(k_j(x-x_{\\text{ref}})), \\sin(k_j(x-x_{\\text{ref}}))\\}$. Let's set the reference position $x_{\\text{ref}}$ to be the left boundary of the region, say $x_{j-1}$.\n$$\n\\psi(x) = C_1 \\cos(k_j(x-x_{j-1})) + C_2 \\sin(k_j(x-x_{j-1}))\n$$\nThe derivative is\n$$\n\\psi'(x) = k_j(-C_1 \\sin(k_j(x-x_{j-1})) + C_2 \\cos(k_j(x-x_{j-1})))\n$$\nAt the left boundary $x=x_{j-1}$, we have $\\psi(x_{j-1}) = C_1$ and $\\psi'(x_{j-1}) = k_j C_2$. This allows us to express the coefficients $C_1$ and $C_2$ in terms of the state vector at $x_{j-1}$. Substituting these back, we can find the state vector at any other point $x$ within the region in terms of the state vector at $x_{j-1}$. For a layer of width $L_j = x_j - x_{j-1}$, the state vector at the right boundary $x_j$ is related to the state vector at the left boundary $x_{j-1}$ by a linear transformation:\n$$\n\\vec{\\Psi}(x_j) = P_j(L_j) \\vec{\\Psi}(x_{j-1})\n$$\nThe matrix $P_j(L_j)$ is the propagation matrix for the layer:\n$$\nP_j(L_j) = \\begin{pmatrix} \\cos(k_j L_j) & \\frac{1}{k_j}\\sin(k_j L_j) \\\\ -k_j\\sin(k_j L_j) & \\cos(k_j L_j) \\end{pmatrix}\n$$\nThis form remains valid for both propagating ($E > V_j$, real $k_j$) and evanescent ($E < V_j$, imaginary $k_j$) waves through the properties of complex trigonometric functions, e.g., $\\cos(i\\kappa_j L_j) = \\cosh(\\kappa_j L_j)$ and $\\sin(i\\kappa_j L_j)/ (i\\kappa_j) = \\sinh(\\kappa_j L_j)/\\kappa_j$.\n\nNotably, in the special case where $E=V_j$, the wave number $k_j$ is zero. The propagation matrix must be evaluated in the limit $k_j \\to 0$:\n$$\n\\lim_{k_j \\to 0} P_j(L_j) = \\begin{pmatrix} 1 & L_j \\\\ 0 & 1 \\end{pmatrix}\n$$\nThis avoids any division by zero and correctly describes free particle propagation when the kinetic energy is zero.\n\nThe complete potential structure consists of a sequence of $N$ layers, from $j=1$ to $j=N$, between a semi-infinite left lead (region $0$) and a semi-infinite right lead (region $N+1$). Let the interfaces be at positions $x_0, x_1, \\dots, x_N$. The total width of the structure is $x_N - x_0 = \\sum_{j=1}^N L_j$.\nAt each interface $x_j$ between two adjacent regions, the boundary conditions require that both $\\psi(x)$ and $\\psi'(x)$ be continuous. This means the state vector $\\vec{\\Psi}(x)$ is continuous across all interfaces.\nTherefore, the state vector at the final boundary $x_N$ can be related to the state vector at the initial boundary $x_0$ by successive application of the propagation matrices for each layer:\n$$\n\\vec{\\Psi}(x_N) = P_N(L_N) \\vec{\\Psi}(x_{N-1}) = P_N(L_N) P_{N-1}(L_{N-1}) \\vec{\\Psi}(x_{N-2}) = \\dots\n$$\n$$\n\\vec{\\Psi}(x_N) = \\left( \\prod_{j=N}^{1} P_j(L_j) \\right) \\vec{\\Psi}(x_0)\n$$\nLet us define the total propagation matrix for the entire structure as $M_{total} = P_N(L_N) P_{N-1}(L_{N-1}) \\cdots P_1(L_1)$. Then,\n$$\n\\vec{\\Psi}(x_N) = M_{total} \\vec{\\Psi}(x_0)\n$$\nIf there are no internal layers ($N=0$), $M_{total}$ is the $2 \\times 2$ identity matrix.\n\nNext, we relate the state vector $\\vec{\\Psi}(x)$ at the boundaries to the amplitudes of incident, reflected, and transmitted plane waves in the leads. In a lead region (e.g., the left lead, region $0$) with wave number $k_L$, the wavefunction is a superposition of a right-propagating (incident) wave and a left-propagating (reflected) wave:\n$$\n\\psi_L(x) = A_L e^{ik_L(x - x_0)} + B_L e^{-ik_L(x - x_0)}\n$$\nAt the boundary $x=x_0$, the state vector is:\n$$\n\\vec{\\Psi}(x_0) = \\begin{pmatrix} \\psi_L(x_0) \\\\ \\psi'_L(x_0) \\end{pmatrix} = \\begin{pmatrix} A_L + B_L \\\\ ik_L(A_L - B_L) \\end{pmatrix} = \\begin{pmatrix} 1 & 1 \\\\ ik_L & -ik_L \\end{pmatrix} \\begin{pmatrix} A_L \\\\ B_L \\end{pmatrix} = S_{k_L} \\begin{pmatrix} A_L \\\\ B_L \\end{pmatrix}\n$$\nSimilarly, in the right lead (region $N+1$) with wave number $k_R$, the wavefunction is:\n$$\n\\psi_R(x) = A_R e^{ik_R(x - x_N)} + B_R e^{-ik_R(x - x_N)}\n$$\nThe state vector at the boundary $x=x_N$ is:\n$$\n\\vec{\\Psi}(x_N) = S_{k_R} \\begin{pmatrix} A_R \\\\ B_R \\end{pmatrix}\n$$\nThe matrix $S_k$ has an inverse $S_k^{-1} = \\frac{1}{2}\\begin{pmatrix} 1 & 1/(ik) \\\\ 1 & -1/(ik) \\end{pmatrix}$.\n\nCombining these relations, we can establish a connection between the amplitude coefficients in the left and right leads:\n$$\nS_{k_R} \\begin{pmatrix} A_R \\\\ B_R \\end{pmatrix} = \\vec{\\Psi}(x_N) = M_{total} \\vec{\\Psi}(x_0) = M_{total} S_{k_L} \\begin{pmatrix} A_L \\\\ B_L \\end{pmatrix}\n$$\nThis yields the scattering matrix relation. However, the transfer matrix formalism relates the amplitudes on one side to the other. To obtain the transfer matrix $\\mathcal{M}$ which satisfies $\\begin{pmatrix} A_L \\\\ B_L \\end{pmatrix} = \\mathcal{M} \\begin{pmatrix} A_R \\\\ B_R \\end{pmatrix}$, we rearrange the equation:\n$$\n\\begin{pmatrix} A_L \\\\ B_L \\end{pmatrix} = S_{k_L}^{-1} M_{total}^{-1} S_{k_R} \\begin{pmatrix} A_R \\\\ B_R \\end{pmatrix}\n$$\nSo, the amplitude transfer matrix is $\\mathcal{M} = S_{k_L}^{-1} M_{total}^{-1} S_{k_R}$.\nThe determinant of each propagation matrix $P_j$ is $\\det(P_j) = \\cos^2(k_jL_j) - (-k_j\\sin(k_jL_j))(\\frac{1}{k_j}\\sin(k_jL_j)) = 1$. Consequently, $\\det(M_{total})=1$, and its inverse is simple: if $M_{total} = \\begin{pmatrix} m_{11} & m_{12} \\\\ m_{21} & m_{22} \\end{pmatrix}$, then $M_{total}^{-1} = \\begin{pmatrix} m_{22} & -m_{12} \\\\ -m_{21} & m_{11} \\end{pmatrix}$.\n\nTo find the transmission probability, we consider a particle incident from the left. This physical situation corresponds to setting the amplitude of the incoming wave from the right lead to zero, i.e., $B_R=0$. We can set the amplitude of the incident wave from the left to unity, $A_L=1$, without loss of generality.\nThe transfer matrix equation becomes:\n$$\n\\begin{pmatrix} 1 \\\\ B_L \\end{pmatrix} = \\mathcal{M} \\begin{pmatrix} A_R \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} \\mathcal{M}_{11} A_R \\\\ \\mathcal{M}_{21} A_R \\end{pmatrix}\n$$\nFrom the first row, we find the transmission amplitude $t \\equiv A_R = 1/\\mathcal{M}_{11}$.\nThe transmission probability $T$ is the ratio of the transmitted probability current density to the incident probability current density. The current density is $J = \\frac{\\hbar}{2mi}(\\psi^*\\psi' - \\psi(\\psi')^*)$. For a plane wave $\\psi(x)=Ae^{ikx}$ with real $k$, $J = |A|^2 \\frac{\\hbar k}{m}$.\n$$\nT = \\frac{J_{trans}}{J_{inc}} = \\frac{|A_R|^2 (\\hbar k_R/m)}{|A_L|^2 (\\hbar k_L/m)} = \\frac{k_R}{k_L}|t|^2\n$$\nSubstituting $t = 1/\\mathcal{M}_{11}$ gives the final expression for the transmission probability:\n$$\nT = \\frac{k_R}{k_L} \\frac{1}{|\\mathcal{M}_{11}|^2}\n$$\nThe problem states that $E>V_L$ and $E>V_R$, so $k_L$ and $k_R$ are always real and positive. The term $\\mathcal{M}_{11}$ can be calculated by performing the matrix multiplication $\\mathcal{M} = S_{k_L}^{-1} M_{total}^{-1} S_{k_R}$, which yields:\n$$\n\\mathcal{M}_{11} = \\frac{1}{2} \\left( m_{22} - i k_R m_{12} + i \\frac{m_{21}}{k_L} + \\frac{k_R}{k_L} m_{11} \\right)\n$$\nThis completes the derivation. The algorithm is to first compute the total propagation matrix $M_{total}$ by multiplying the matrices for each layer, then use its elements to compute $\\mathcal{M}_{11}$, and finally compute the transmission probability $T$.", "answer": "```python\nimport numpy as np\nimport cmath\n\ndef solve():\n    \"\"\"\n    Solves for the transmission probability using the transfer matrix method.\n    \"\"\"\n    # Physical constants\n    HBARC = 197.3269804  # MeV·fm\n    M_PARTICLE = 938.2720813  # MeV\n    \n    # Pre-calculated constant for wave number calculation\n    K_SQR_COEFF = 2 * M_PARTICLE / (HBARC**2)\n\n    # Test cases from the problem statement\n    test_cases = [\n        # Test case A\n        {\n            \"E\": 10.0, \"V_L\": 0.0, \"V_R\": 0.0,\n            \"layers\": [(20.0, 5.0)]\n        },\n        # Test case B\n        {\n            \"E\": 30.0, \"V_L\": 0.0, \"V_R\": 0.0,\n            \"layers\": [(20.0, 5.0)]\n        },\n        # Test case C\n        {\n            \"E\": 5.0, \"V_L\": 0.0, \"V_R\": 0.0,\n            \"layers\": [(25.0, 2.0), (0.0, 6.4), (25.0, 2.0)]\n        },\n        # Test case D\n        {\n            \"E\": 10.0, \"V_L\": 0.0, \"V_R\": 0.0,\n            \"layers\": []\n        }\n    ]\n\n    results = []\n\n    def get_transmission(E, V_L, layers, V_R):\n        \"\"\"\n        Calculates the transmission probability for a single potential configuration.\n        \"\"\"\n        # Threshold for handling k=0 case\n        k_epsilon = 1e-9\n\n        # Calculate wave numbers for leads\n        k_L = cmath.sqrt(K_SQR_COEFF * (E - V_L))\n        k_R = cmath.sqrt(K_SQR_COEFF * (E - V_R))\n\n        # Initialize total propagation matrix as identity\n        M_total = np.identity(2, dtype=complex)\n\n        # The structure is V_L | layer_1 | ... | layer_N | V_R\n        # The total propagation matrix M_total is P_N * P_{N-1} * ... * P_1\n        # We build it by iterating through layers and right-multiplying.\n        \n        # We build the product M_total = P_N * ... * P_1.\n        # This can be done by iterating from j=1 to N and M_new = P_j * M_old.\n        # However, the standard definition is M_total relates psi(x_N) to psi(x_0).\n        # psi(x_N) = P_N * ... * P_1 * psi(x_0).\n        # We can compute this product by iterating from N down to 1.\n        # M = I; for j=N..1: M = M @ P_j\n        # Or, M = I; for j=1..N: M = P_j @ M. This yield P_N @ ... @ P_1.\n        \n        # Let's iterate layers from left to right as given.\n        # Total matrix M = P_N * P_{N-1} * ... * P_1\n        # Loop j=1...N: compute P_j, then M_total = P_j @ M_total\n        for V_j, L_j in layers:\n            # Calculate wave number k_j in the layer\n            k_j = cmath.sqrt(K_SQR_COEFF * (E - V_j))\n\n            # Form the propagation matrix P_j for the layer\n            if abs(k_j) < k_epsilon:\n                # Limit case for k -> 0\n                P_j = np.array([[1.0, L_j],\n                                [0.0, 1.0]], dtype=complex)\n            else:\n                cos_kl = cmath.cos(k_j * L_j)\n                sin_kl = cmath.sin(k_j * L_j)\n                P_j = np.array([[cos_kl, sin_kl / k_j],\n                                [-k_j * sin_kl, cos_kl]], dtype=complex)\n            \n            # The total matrix relates the final state to the initial state\n            # Psi(x_N) = M_total * Psi(x_0)\n            # M_total = P_N * ... * P_1\n            # If M starts as I, then M = P_1, then M = P_2 * M = P_2 * P_1, etc.\n            M_total = P_j @ M_total\n\n        # Extract elements of the total propagation matrix M_total\n        m11, m12 = M_total[0, 0], M_total[0, 1]\n        m21, m22 = M_total[1, 0], M_total[1, 1]\n\n        # Calculate the 1,1 element of the amplitude transfer matrix M_script\n        # M_script_11 = 0.5 * (m22 - 1j*k_R*m12 + 1j*m21/k_L + (k_R/k_L)*m11)\n        # Note that det(M_total) = 1, so M_total_inv has elements (m22, -m12, -m21, m11).\n        # The derivation in the solution uses M_total_inv.\n        # So we use m22, -m12, -m21, m11 from an M_total to compute M_script.\n        # M_script_11 = 0.5 * ( (m22) + (m21)/(1j*k_L) + (-m12)*1j*k_R + (-m11/ (1j*k_L))*1j*k_R)\n        # Let's use the simplified expression from the text which is correct:\n        # M_script_11 = 0.5 * ( m_inv_11 + m_inv_21/(1j*k_L) + m_inv_12*1j*k_R + (m_inv_22/(1j*k_L))*1j*k_R)\n        # where m_inv are elements of M^-1.\n        # m_inv_11 = m22, m_inv_12 = -m12, m_inv_21 = -m21, m_inv_22 = m11.\n        # M_script_11 = 0.5 * ( m22 + (-m21)/(1j*k_L) + (-m12)*1j*k_R + (m11/(1j*k_L))*1j*k_R )\n        # M_script_11 = 0.5 * ( m22 + 1j*m21/k_L - 1j*k_R*m12 + m11*k_R/k_L )\n        # This matches the solution text.\n        \n        M_script_11 = 0.5 * (m22 + 1j * m21 / k_L - 1j * k_R * m12 + m11 * k_R / k_L)\n\n        # Transmission probability T = (k_R/k_L) / |M_script_11|^2\n        # Since k_L, k_R are real as per problem statement E>V_L, E>V_R\n        T = (k_R.real / k_L.real) / abs(M_script_11)**2\n        return T\n\n    for case in test_cases:\n        T = get_transmission(case[\"E\"], case[\"V_L\"], case[\"layers\"], case[\"V_R\"])\n        results.append(T)\n\n    # Format the final output string\n    output_str = f\"[{','.join([f'{r:.8f}' for r in results])}]\"\n    print(output_str)\n\nsolve()\n```", "id": "3575889"}, {"introduction": "While exact methods are invaluable, many realistic potentials are smooth and do not have analytical solutions, necessitating the use of approximations. This exercise introduces the Wentzel–Kramers–Brillouin (WKB) approximation, a cornerstone of semiclassical physics, and challenges you to assess its validity by comparing its predictions to a numerically exact solution. By investigating how the approximation's accuracy changes with energy and barrier shape, you will develop critical insight into the physical conditions that underpin the semiclassical limit [@problem_id:3575931].", "problem": "Consider a one-dimensional nuclear scattering problem governed by the time-independent Schrödinger equation,\n$$\n-\\frac{(\\hbar c)^2}{2mc^2}\\,\\frac{d^2\\psi(x)}{dx^2} + V(x)\\,\\psi(x) = E\\,\\psi(x),\n$$\nwith a localized barrier described by a Pöschl–Teller-like potential,\n$$\nV(x) = \\frac{V_0}{\\cosh^2\\!\\left(\\frac{x}{a}\\right)} = V_0\\,\\operatorname{sech}^2\\!\\left(\\frac{x}{a}\\right),\n$$\nwhere $V_0$ is the barrier height, $a$ is the barrier width parameter, and $\\operatorname{sech}(u) = 1/\\cosh(u)$. Assume energies $E$ strictly below the barrier top, $0 < E < V_0$, so that quantum tunneling occurs. Use natural units with speed of light $c=1$, and the conversion constant $\\hbar c = 197.3269804\\,\\text{MeV}\\,\\text{fm}$. Let the mass be the nucleon rest energy $mc^2 = 939.565\\,\\text{MeV}$.\n\nYour task is to compute, for specified parameter sets $(V_0, a, E)$, the transmission probability $T(E)$ through the barrier in two ways:\n\n1. The numerically exact transmission probability $T_{\\text{exact}}(E)$ obtained by solving the Schrödinger equation with scattering boundary conditions consistent with an incoming plane wave from $x\\to -\\infty$ and an outgoing transmitted wave toward $x\\to +\\infty$. Use a large but finite domain $[-L, L]$ with $L = 12 a$ to approximate the asymptotic regions where $V(x) \\approx 0$, and enforce asymptotic plane-wave boundary conditions. Compute the transmission using a method that is strictly derived from the Schrödinger equation and its asymptotic solutions, and that does not rely on fitting parameters or empirical formulas.\n\n2. The semiclassical Wentzel–Kramers–Brillouin (WKB) approximation $T_{\\text{WKB}}(E)$ based on the under-barrier action integral between the classical turning points $x_1 < 0 < x_2$ defined by $V(x_i) = E$. For the potential above, the turning points satisfy $\\cosh^2\\!\\left(\\frac{x_i}{a}\\right) = \\frac{V_0}{E}$, so they can be expressed in terms of the inverse hyperbolic cosine. Implement the action integral numerically and use it to estimate the tunneling probability in the classically forbidden region only.\n\nAll quantities must be treated in the units specified: energies in $\\text{MeV}$, lengths in $\\text{fm}$. The transmission probabilities are dimensionless and must be returned as decimal fractions.\n\nDesign your algorithms from first principles. Start from the Schrödinger equation and the definition of scattering states, and build the numerical procedures needed to obtain $T_{\\text{exact}}(E)$ and $T_{\\text{WKB}}(E)$ without introducing any shortcut formulas in the problem statement. Ensure scientific realism by checking that $E < V_0$ and choosing $L$ such that $V(\\pm L)$ is negligible relative to $V_0$.\n\nImplement your solution as a complete, runnable program that produces the results for the following test suite of parameter values, selected to probe different regimes including a \"happy path,\" near-barrier-top behavior (where semiclassical approximations can break down), and thin-barrier edge cases:\n\n- Test case $1$: $V_0 = 25\\,\\text{MeV}$, $a = 5\\,\\text{fm}$, $E = 5\\,\\text{MeV}$.\n- Test case $2$: $V_0 = 25\\,\\text{MeV}$, $a = 1\\,\\text{fm}$, $E = 24.75\\,\\text{MeV}$.\n- Test case $3$: $V_0 = 25\\,\\text{MeV}$, $a = 0.8\\,\\text{fm}$, $E = 12.5\\,\\text{MeV}$.\n- Test case $4$: $V_0 = 25\\,\\text{MeV}$, $a = 0.5\\,\\text{fm}$, $E = 20\\,\\text{MeV}$.\n\nFor each test case, compute and return the list $[T_{\\text{exact}}(E), T_{\\text{WKB}}(E), \\Delta(E)]$, where $\\Delta(E)$ is the relative error defined by\n$$\n\\Delta(E) = \\frac{\\left|T_{\\text{WKB}}(E) - T_{\\text{exact}}(E)\\right|}{T_{\\text{exact}}(E)}.\n$$\n\nFinal output format: Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element is itself a comma-separated list with the three floats for a test case, for example, \n$$\n\\text{[ [}T_{\\text{exact},1}\\text{,}T_{\\text{WKB},1}\\text{,}\\Delta_1\\text{], [}T_{\\text{exact},2}\\text{,}T_{\\text{WKB},2}\\text{,}\\Delta_2\\text{], \\ldots ]}\n$$\nAll numeric entries must be returned as Python floats. No units should be printed in the final output since the transmission probabilities and relative errors are dimensionless decimal fractions.", "solution": "The problem requires the computation of the transmission probability $T(E)$ for a particle encountering a one-dimensional Pöschl–Teller potential barrier. We must compute this quantity using two distinct methods: a numerically exact solution of the time-independent Schrödinger equation (TISE) and the semiclassical Wentzel–Kramers–Brillouin (WKB) approximation.\n\nThe governing equation is the TISE:\n$$\n-\\frac{(\\hbar c)^2}{2mc^2}\\,\\frac{d^2\\psi(x)}{dx^2} + V(x)\\,\\psi(x) = E\\,\\psi(x)\n$$\nThe potential barrier is given by:\n$$\nV(x) = V_0\\,\\operatorname{sech}^2\\!\\left(\\frac{x}{a}\\right)\n$$\nWe are given the constants $\\hbar c = 197.3269804\\,\\text{MeV}\\,\\text{fm}$ and the nucleon rest energy $mc^2 = 939.565\\,\\text{MeV}$. The TISE can be rearranged as:\n$$\n\\frac{d^2\\psi(x)}{dx^2} = -\\frac{2mc^2(E - V(x))}{(\\hbar c)^2}\\,\\psi(x)\n$$\nThe term $\\frac{(\\hbar c)^2}{2(mc^2)}$ is a constant with units of $\\text{MeV}\\,\\text{fm}^2$, which we denote as $\\mathcal{C} = \\frac{(\\hbar c)^2}{2(mc^2)} \\approx 20.7212\\,\\text{MeV}\\,\\text{fm}^2$. The equation becomes:\n$$\n\\frac{d^2\\psi(x)}{dx^2} = -\\frac{E - V(x)}{\\mathcal{C}}\\,\\psi(x)\n$$\nIn the asymptotic regions where $x \\to \\pm\\infty$, the potential $V(x) \\to 0$. The solutions to the TISE are plane waves $\\psi(x) \\propto e^{\\pm i k_0 x}$, where $k_0 = \\sqrt{E/\\mathcal{C}}$ is the wave number.\n\nFor a scattering problem with a particle incident from the left ($x \\to -\\infty$), the asymptotic form of the wavefunction is:\n$$\n\\psi(x) = \\begin{cases} A e^{i k_0 x} + B e^{-i k_0 x} & x \\to -\\infty \\\\ C e^{i k_0 x} & x \\to +\\infty \\end{cases}\n$$\nHere, $A$ is the amplitude of the incoming wave, $B$ is the amplitude of the reflected wave, and $C$ is the amplitude of the transmitted wave. By definition, the transmission probability is $T = \\frac{|C|^2}{|A|^2}$.\n\n### 1. Numerically Exact Transmission Probability $T_{\\text{exact}}(E)$\n\nTo find $T_{\\text{exact}}(E)$, we solve the TISE numerically. The problem specifies a finite domain $[-L, L]$ with $L=12a$, which is large enough that $V(\\pm L) \\approx 0$. We can therefore apply the asymptotic boundary conditions at $x = \\pm L$.\n\nWe employ a numerical integration method, which can be viewed as a form of the \"shooting method\". We start at the right boundary $x=L$ and integrate the TISE backward to $x=-L$.\nAt the right boundary $x=L$, we assume a purely transmitted wave. Without loss of generality, we can set its amplitude $C=1$. Thus, the boundary conditions at $x=L$ are:\n$$\n\\psi(L) = e^{i k_0 L} \\quad \\text{and} \\quad \\psi'(L) = i k_0 e^{i k_0 L}\n$$\nTo perform the numerical integration, we convert the second-order TISE into a system of two first-order ordinary differential equations (ODEs). Let a state vector be $\\mathbf{y}(x) = [\\psi(x), \\psi'(x)]^T$. The system is:\n$$\n\\frac{d\\mathbf{y}}{dx} = \\frac{d}{dx} \\begin{pmatrix} \\psi(x) \\\\ \\psi'(x) \\end{pmatrix} = \\begin{pmatrix} \\psi'(x) \\\\ -\\frac{E - V(x)}{\\mathcal{C}}\\,\\psi(x) \\end{pmatrix}\n$$\nWe integrate this system from the initial point $x=L$ with the initial condition $\\mathbf{y}(L) = [e^{i k_0 L}, i k_0 e^{i k_0 L}]^T$ backward to $x=-L$. This yields the numerical solution $\\mathbf{y}_{num}(-L) = [\\psi_{num}(-L), \\psi'_{num}(-L)]^T$.\n\nAt $x=-L$, the wavefunction must match the general asymptotic form for the left region:\n$$\n\\psi_{num}(-L) = A e^{-i k_0 L} + B e^{i k_0 L}\n$$\n$$\n\\psi'_{num}(-L) = i k_0 ( A e^{-i k_0 L} - B e^{i k_0 L} )\n$$\nThis is a system of two linear equations in the two unknown complex amplitudes $A$ and $B$. We are interested in $A$. We can solve for $A$ by adding the first equation to $\\frac{1}{ik_0}$ times the second equation:\n$$\n\\psi_{num}(-L) + \\frac{\\psi'_{num}(-L)}{i k_0} = 2A e^{-i k_0 L}\n$$\nThis gives the amplitude of the incident wave:\n$$\nA = \\frac{1}{2} \\left( \\psi_{num}(-L) - \\frac{i}{k_0} \\psi'_{num}(-L) \\right) e^{i k_0 L}\n$$\nSince we began by assuming the transmitted amplitude $C=1$, the transmission probability is:\n$$\nT_{\\text{exact}}(E) = \\frac{|C|^2}{|A|^2} = \\frac{1}{|A|^2}\n$$\nThis procedure will be implemented using a numerical ODE solver.\n\n### 2. Semiclassical WKB Approximation $T_{\\text{WKB}}(E)$\n\nThe WKB approximation provides a semiclassical estimate for the tunneling probability. For energies $E < V_0$, the region under the barrier is classically forbidden. The transmission probability in this approximation is given by:\n$$\nT_{\\text{WKB}}(E) \\approx e^{-2\\gamma}\n$$\nwhere $\\gamma$ is the Gamow factor, defined by the integral of the magnitude of the (imaginary) wave number over the classically forbidden region $[x_1, x_2]$:\n$$\n\\gamma = \\int_{x_1}^{x_2} \\sqrt{\\frac{2mc^2(V(x) - E)}{(\\hbar c)^2}}\\,dx = \\int_{x_1}^{x_2} \\sqrt{\\frac{V(x) - E}{\\mathcal{C}}}\\,dx\n$$\nThe classical turning points, $x_1$ and $x_2$, are the locations where the particle's kinetic energy would be zero, i.e., $V(x) = E$. For the Pöschl–Teller potential:\n$$\nV_0\\,\\operatorname{sech}^2\\!\\left(\\frac{x_i}{a}\\right) = E \\implies \\cosh^2\\!\\left(\\frac{x_i}{a}\\right) = \\frac{V_0}{E}\n$$\nSolving for $x_i$ gives the symmetric turning points:\n$$\nx_{1,2} = \\mp a\\,\\operatorname{arccosh}\\left(\\sqrt{\\frac{V_0}{E}}\\right)\n$$\nThe problem requires that the action integral for $\\gamma$ be computed numerically. We will define the integrand function $f(x) = \\sqrt{(V(x) - E)/\\mathcal{C}}$ and use a numerical quadrature routine to evaluate $\\gamma = \\int_{x_1}^{x_2} f(x) dx$. The WKB transmission probability is then calculated from $T_{\\text{WKB}} = e^{-2\\gamma}$.\n\n### 3. Relative Error\n\nFinally, for each parameter set, the relative error $\\Delta(E)$ of the WKB approximation with respect to the numerically exact result is calculated as:\n$$\n\\Delta(E) = \\frac{\\left|T_{\\text{WKB}}(E) - T_{\\text{exact}}(E)\\right|}{T_{\\text{exact}}(E)}\n$$\n\nThese steps constitute a complete first-principles-based numerical framework for solving the problem as stated. The algorithms will be implemented in Python using the `numpy` and `scipy` libraries for numerical calculations.", "answer": "```python\nimport numpy as np\nfrom scipy.integrate import solve_ivp, quad\nfrom typing import List, Tuple\n\ndef solve():\n    \"\"\"\n    Computes the transmission probability through a Pöschl-Teller barrier\n    using a numerically exact method and the WKB approximation.\n    \"\"\"\n    # Physical constants and parameters\n    HBARC = 197.3269804  # MeV fm\n    M_NUCLEON_C2 = 939.565  # MeV\n    # Pre-calculated constant hbar^2 / (2m) = (hbar*c)^2 / (2*m*c^2)\n    HBARC2_OVER_2M = HBARC**2 / (2 * M_NUCLEON_C2)\n\n    # Test cases: (V0 in MeV, a in fm, E in MeV)\n    test_cases = [\n        (25.0, 5.0, 5.0),\n        (25.0, 1.0, 24.75),\n        (25.0, 0.8, 12.5),\n        (25.0, 0.5, 20.0),\n    ]\n\n    # Helper function for the potential\n    def V_pt(x: float, V0: float, a: float) -> float:\n        \"\"\"Pöschl-Teller potential.\"\"\"\n        return V0 / np.cosh(x / a)**2\n\n    results = []\n    for V0, a, E in test_cases:\n        # --- 1. Numerically Exact Transmission Probability T_exact ---\n        \n        # Wave number in the asymptotic region (x -> +/- infinity)\n        k0 = np.sqrt(E / HBARC2_OVER_2M)\n        \n        # Integration domain [-L, L]\n        L = 12.0 * a\n        \n        # Define the system of 1st order ODEs for the Schrödinger equation\n        # y = [psi, d(psi)/dx]\n        def schrodinger_ode(t: float, y: np.ndarray) -> np.ndarray:\n            psi, dpsi_dx = y\n            d2psi_dx2 = -(E - V_pt(t, V0, a)) * psi / HBARC2_OVER_2M\n            return np.array([dpsi_dx, d2psi_dx2], dtype=np.complex128)\n            \n        # Initial conditions at x = L (right boundary), assuming purely transmitted wave C*exp(i*k0*x) with C=1\n        psi_L = np.exp(1j * k0 * L)\n        dpsi_dx_L = 1j * k0 * np.exp(1j * k0 * L)\n        y_L = np.array([psi_L, dpsi_dx_L], dtype=np.complex128)\n        \n        # Numerically integrate backwards from L to -L\n        # Using a high-precision solver (DOP853) is beneficial for oscillatory solutions.\n        # Set dense_output=True to get solution at specific points if needed, here just the end is fine.\n        sol = solve_ivp(\n            schrodinger_ode,\n            [L, -L],\n            y_L,\n            method='DOP853',\n            atol=1e-12, # Absolute tolerance\n            rtol=1e-12) # Relative tolerance\n            \n        # Extract solution at x = -L\n        psi_minus_L, dpsi_dx_minus_L = sol.y[:, -1]\n        \n        # At x = -L, the solution is a superposition of incoming (A) and reflected (B) waves:\n        # psi(-L) = A*exp(-i*k0*L) + B*exp(i*k0*L)\n        # psi'(-L) = i*k0*(A*exp(-i*k0*L) - B*exp(i*k0*L))\n        # From these, solve for the incoming amplitude A\n        A_inv_term1 = psi_minus_L\n        A_inv_term2 = dpsi_dx_minus_L / (1j * k0)\n        A = 0.5 * (A_inv_term1 + A_inv_term2) * np.exp(1j * k0 * L)\n        \n        # Transmission probability T = |C|^2 / |A|^2. Since we set C=1, T = 1/|A|^2.\n        T_exact = 1.0 / np.abs(A)**2 if np.abs(A) > 1e-15 else 0.0\n\n        # --- 2. WKB Approximation T_wkb ---\n        \n        T_wkb = 0.0\n        # WKB approximation is valid for E < V0\n        if E < V0:\n            # Classical turning points V(x) = E\n            x2 = a * np.arccosh(np.sqrt(V0 / E))\n            x1 = -x2\n            \n            # Integrand for the Gamow factor gamma\n            def wkb_integrand(x: float) -> float:\n                return np.sqrt((V_pt(x, V0, a) - E) / HBARC2_OVER_2M)\n                \n            # Numerically integrate to find gamma\n            gamma, _ = quad(wkb_integrand, x1, x2, epsabs=1e-12, epsrel=1e-12)\n            \n            # WKB transmission probability\n            T_wkb = np.exp(-2.0 * gamma)\n        \n        # --- 3. Relative Error ---\n        \n        delta = np.abs(T_wkb - T_exact) / T_exact if T_exact > 0 else 0.0\n        \n        results.append([T_exact, T_wkb, delta])\n\n    # Format the final output as a string representing a list of lists.\n    # e.g., [[val1, val2, val3], [val4, val5, val6]]\n    output_str = \"[\" + \", \".join([f\"[{r[0]},{r[1]},{r[2]}]\" for r in results]) + \"]\"\n    print(output_str)\n\nsolve()\n\n```", "id": "3575931"}, {"introduction": "This final practice synthesizes the preceding concepts by applying the WKB approximation to a real-world nuclear phenomenon: alpha decay. You will construct a model based on Gamow's theory of tunneling, connecting the abstract penetration probability to the measurable half-life of a nucleus. Furthermore, this exercise introduces a crucial technique from modern computational science—Monte Carlo simulation—to propagate uncertainties in the nuclear potential to the final predicted half-life, providing a realistic estimate of the model's predictive power [@problem_id:3575895].", "problem": "You will implement a computational model for alpha decay that computes the decay half-life as a product of an intrinsic preformation factor and a quantum mechanical barrier penetration factor, with uncertainties in the effective interaction propagated to the observable via Monte Carlo sampling. The modeling assumptions and numerical tasks are grounded in the time-independent Schrödinger equation and the semiclassical Wentzel–Kramers–Brillouin (WKB) approximation.\n\nStarting point and modeling assumptions:\n- The time-independent Schrödinger equation for the radial motion of an alpha particle in the field of the daughter nucleus with reduced mass $\\mu$ is the fundamental base. In the semiclassical Wentzel–Brillouin–Kramers (WKB) approximation, the barrier tunneling probability through a one-dimensional effective potential barrier is obtained from the action integral across the classically forbidden region defined by the turning points where the potential equals the kinetic energy.\n- Model the total potential as $V(r) = V_{\\mathrm{N}}(r) + V_{\\mathrm{C}}(r)$ with zero orbital angular momentum. The nuclear term is a Woods–Saxon form $V_{\\mathrm{N}}(r) = -V_{0}/\\left(1+\\exp\\!\\left(\\frac{r-R}{a}\\right)\\right)$ with radius $R = r_{0} A_{\\mathrm{d}}^{1/3}$; the Coulomb term is that of a uniformly charged sphere of radius $R_{\\mathrm{C}} = r_{0\\mathrm{C}} A_{\\mathrm{d}}^{1/3}$, i.e., $V_{\\mathrm{C}}(r)= Z_{\\mathrm{d}} Z_{\\alpha} e^{2}/r$ for $r \\ge R_{\\mathrm{C}}$ and $V_{\\mathrm{C}}(r)= Z_{\\mathrm{d}} Z_{\\alpha} e^{2}\\,(3-(r/R_{\\mathrm{C}})^{2})/(2 R_{\\mathrm{C}})$ for $r<R_{\\mathrm{C}}$, where $Z_{\\alpha}=2$.\n- The barrier penetration factor $P$ is to be computed from the WKB action integral across the classically forbidden region bounded by the inner and outer turning points $r_{1}$ and $r_{2}$, defined by $V(r_{1})=Q$ and $V(r_{2})=Q$, where $Q$ is the alpha decay $Q$-value (energy release) in $\\mathrm{MeV}$.\n- The decay constant is modeled as $\\lambda = P_{\\alpha} \\,\\nu \\, P$, where $P_{\\alpha}$ is a preformation factor, $\\nu$ is an assault frequency estimating the rate of impacts on the barrier from the internal motion, and $P$ is the barrier penetration factor. The half-life is $T_{1/2} = \\ln 2 / \\lambda$.\n- Use an assault frequency estimate $\\nu = \\frac{v}{2 R} \\, c$ with $v=\\sqrt{2 Q/\\mu}$ the internal speed and $c$ the speed of light in $\\mathrm{fm/s}$. Here $R=r_{0}A_{\\mathrm{d}}^{1/3}$ is the nuclear radius as above.\n- Use natural units for the WKB integral with $\\hbar c$ converting length and energy consistently.\n\nConstants to use:\n- $\\hbar c = 197.3269804\\,\\mathrm{MeV\\cdot fm}$.\n- $e^{2} = 1.439964\\,\\mathrm{MeV\\cdot fm}$.\n- $c = 2.99792458\\times 10^{23}\\,\\mathrm{fm/s}$.\n- Atomic mass unit energy $m_{u} c^{2} = 931.49410242\\,\\mathrm{MeV}$.\n- Alpha particle rest energy $m_{\\alpha} c^{2} = 3727.379378\\,\\mathrm{MeV}$.\n- Natural logarithm of two $\\ln 2$.\n\nReduced mass:\n- Use $\\mu c^2 = \\frac{(m_{\\alpha} c^2) (m_{\\mathrm{d}} c^2)}{m_{\\alpha}c^2+m_{\\mathrm{d}}c^2}$ with $m_{\\mathrm{d}} c^2 \\approx A_{\\mathrm{d}} m_{u} c^2$, where all terms are energies in $\\mathrm{MeV}$.\n\nUncertainty propagation by Monte Carlo:\n- Treat the potential parameters as Gaussian random variables: $r_{0}\\sim \\mathcal{N}(\\bar r_{0}, \\sigma_{r_{0}})$, $a\\sim \\mathcal{N}(\\bar a, \\sigma_{a})$, $V_{0}\\sim \\mathcal{N}(\\bar V_{0}, \\sigma_{V_{0}})$, $r_{0\\mathrm{C}}\\sim \\mathcal{N}(\\bar r_{0\\mathrm{C}}, \\sigma_{r_{0\\mathrm{C}}})$, independently. Truncate draws to positive values for physical realism. The preformation factor $P_{\\alpha}$ and the $Q$-value are treated as deterministic inputs for each case.\n- For each test case, run a Monte Carlo with $N = 400$ samples and random seed set to a fixed integer for reproducibility. For each sample, compute $P$ by numerically finding turning points and integrating the WKB action, compute $\\nu$, then compute $T_{1/2}$ in seconds and finally $y=\\log_{10}(T_{1/2}/\\mathrm{s})$. Aggregate the $N$ values into a sample mean and sample standard deviation.\n\nNumerical requirements:\n- Locate the two turning points $r_{1}<r_{2}$ as roots of $V(r)-Q=0$ on an interval $[r_{\\min}, r_{\\max}]$ with $r_{\\min} = 10^{-3}\\,\\mathrm{fm}$ and $r_{\\max}=200\\,\\mathrm{fm}$ by scanning for sign changes on a grid and refining with a robust root finder. If a sample fails to produce two turning points on this interval, discard that sample from the aggregation for that case.\n- Evaluate the WKB action integral $K = \\frac{1}{\\hbar c}\\int_{r_{1}}^{r_{2}}\\sqrt{2\\mu c^2\\left(V(r)-Q\\right)}\\,dr$ numerically with sufficient absolute accuracy to stably resolve $\\log_{10}T_{1/2}$ to three decimals. Use $P=\\exp(-2K)$ to the extent needed, but compute $\\log_{10}T_{1/2}$ in logarithmic form to avoid underflow or overflow.\n- Compute $\\nu$ via $v/c=\\sqrt{2Q/(\\mu c^2)}$, $\\nu = \\frac{v/c}{2R}\\,c$ with $R=r_{0}A_{\\mathrm{d}}^{1/3}$.\n\nTest suite:\nProvide results for the following three physical cases. Each case is specified as a tuple $(Z_{\\mathrm{d}}, A_{\\mathrm{d}}, Q, P_{\\alpha}, \\bar r_{0}, \\sigma_{r_{0}}, \\bar a, \\sigma_{a}, \\bar V_{0}, \\sigma_{V_{0}}, \\bar r_{0\\mathrm{C}}, \\sigma_{r_{0\\mathrm{C}}})$, with energies in $\\mathrm{MeV}$ and lengths in $\\mathrm{fm}$:\n- Case $1$ (heavy, long-lived): $(90, 234, 4.270, 0.20, 1.20, 0.05, 0.62, 0.05, 120.0, 5.0, 1.20, 0.02)$.\n- Case $2$ (near doubly-magic daughter, short-lived): $(82, 208, 8.954, 0.30, 1.20, 0.05, 0.62, 0.05, 120.0, 5.0, 1.20, 0.02)$.\n- Case $3$ (heavy, very long-lived): $(88, 228, 4.082, 0.15, 1.20, 0.05, 0.62, 0.05, 120.0, 5.0, 1.20, 0.02)$.\n\nAngle units:\n- Not applicable.\n\nPhysical units:\n- The final half-life must be computed in $\\mathrm{s}$ and reported as $y=\\log_{10}(T_{1/2}/\\mathrm{s})$, which is dimensionless. All inputs are in $\\mathrm{MeV}$ and $\\mathrm{fm}$ as specified above.\n\nProgram requirements:\n- Implement the above model and Monte Carlo procedure for each test case, with $N=400$ samples per case and a fixed random seed for reproducibility.\n- For each case, output two floats: the Monte Carlo sample mean and sample standard deviation of $y=\\log_{10}(T_{1/2}/\\mathrm{s})$, each rounded to three decimals.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, ordered as $[\\mu_{1},\\sigma_{1},\\mu_{2},\\sigma_{2},\\mu_{3},\\sigma_{3}]$, where $\\mu_{i}$ and $\\sigma_{i}$ are the mean and standard deviation for case $i$ rounded to three decimals.", "solution": "The problem requires the implementation of a computational model to calculate the alpha decay half-life, $T_{1/2}$, and its uncertainty. The model is based on the semiclassical Wentzel–Kramers–Brillouin (WKB) approximation for quantum tunneling. The uncertainty in the nuclear potential parameters is propagated to the final observable, $\\log_{10}(T_{1/2}/\\mathrm{s})$, using a Monte Carlo simulation.\n\nThe solution is structured as follows: First, we define the physical model, including the potential, the decay rate, and the half-life. Second, we detail the numerical methodology for implementing this model, including root-finding for turning points and numerical integration for the WKB action. Finally, we describe the Monte Carlo procedure for uncertainty quantification.\n\n**1. Physical Model**\n\nThe alpha decay process is modeled as the quantum tunneling of a preformed alpha particle through the potential barrier created by the daughter nucleus.\n\n**1.1. The Potential Barrier**\nThe potential energy $V(r)$ of the alpha particle at a distance $r$ from the center of the daughter nucleus is the sum of the attractive nuclear potential $V_{\\mathrm{N}}(r)$ and the repulsive electrostatic Coulomb potential $V_{\\mathrm{C}}(r)$. We consider only spherically symmetric potentials (zero orbital angular momentum).\n$$V(r) = V_{\\mathrm{N}}(r) + V_{\\mathrm{C}}(r)$$\nThe nuclear potential is modeled by a Woods-Saxon form:\n$$V_{\\mathrm{N}}(r) = -\\frac{V_0}{1 + \\exp\\left(\\frac{r - R}{a}\\right)}$$\nwhere $V_0$ is the potential depth, $a$ is the diffuseness parameter, and $R$ is the nuclear radius, given by $R = r_0 A_{\\mathrm{d}}^{1/3}$, with $r_0$ being the radius parameter and $A_{\\mathrm{d}}$ the mass number of the daughter nucleus.\n\nThe Coulomb potential is that of a uniformly charged sphere of radius $R_{\\mathrm{C}} = r_{0\\mathrm{C}} A_{\\mathrm{d}}^{1/3}$. It has two forms depending on whether the alpha particle is inside or outside the daughter nucleus's charge distribution:\n$$V_{\\mathrm{C}}(r) = \\begin{cases} \\frac{Z_{\\mathrm{d}} Z_{\\alpha} e^2}{2 R_{\\mathrm{C}}} \\left(3 - \\frac{r^2}{R_{\\mathrm{C}}^2}\\right) & \\text{for } r < R_{\\mathrm{C}} \\\\ \\frac{Z_{\\mathrm{d}} Z_{\\alpha} e^2}{r} & \\text{for } r \\ge R_{\\mathrm{C}} \\end{cases}$$\nHere, $Z_{\\mathrm{d}}$ and $Z_{\\alpha}=2$ are the atomic numbers of the daughter nucleus and the alpha particle, respectively, and $e^2$ is the squared elementary charge in units of $\\mathrm{MeV}\\cdot\\mathrm{fm}$.\n\n**1.2. Barrier Penetration and WKB Approximation**\nThe alpha particle is assumed to have a well-defined energy, the decay $Q$-value. The classically forbidden region is where the potential energy $V(r)$ exceeds the total energy $Q$. This region is bounded by two turning points, $r_1$ and $r_2$, defined by the equation $V(r) = Q$.\n\nAccording to the WKB approximation, the probability $P$ of tunneling through this barrier is given by:\n$$P = \\exp(-2K)$$\nwhere $K$ is the Gamow factor, an action integral over the classically forbidden region:\n$$K = \\frac{1}{\\hbar c} \\int_{r_1}^{r_2} \\sqrt{2\\mu c^2 \\left(V(r) - Q\\right)} \\, dr$$\nIn this expression, $\\mu$ is the reduced mass of the alpha-daughter system, $\\hbar c$ is the reduced Planck constant times the speed of light, and the term $\\mu c^2$ represents the reduced mass in energy units ($\\mathrm{MeV}$). The reduced mass is calculated as:\n$$\\mu c^2 = \\frac{(m_{\\alpha}c^2)(m_{\\mathrm{d}}c^2)}{m_{\\alpha}c^2 + m_{\\mathrm{d}}c^2}$$\nwhere $m_{\\alpha}c^2$ is the alpha particle rest energy and $m_{\\mathrm{d}}c^2 \\approx A_{\\mathrm{d}} m_u c^2$ is the approximate rest energy of the daughter nucleus, with $m_u c^2$ being the atomic mass unit energy equivalent.\n\n**1.3. Decay Constant and Half-Life**\nThe decay constant $\\lambda$ is modeled as the product of three factors:\n$$\\lambda = P_{\\alpha} \\nu P$$\nwhere $P_{\\alpha}$ is the preformation factor (the probability that an alpha particle is formed within the parent nucleus), $\\nu$ is the assault frequency (the rate at which the alpha particle strikes the potential barrier), and $P$ is the tunneling probability.\n\nThe assault frequency $\\nu$ is estimated from a simple classical picture of the alpha particle moving inside the nucleus:\n$$\\nu = \\frac{v_{\\text{ratio}}}{2R} c$$\nwhere $c$ is the speed of light, $R = r_0 A_{\\mathrm{d}}^{1/3}$ is the nuclear radius, and $v_{\\text{ratio}} = v_{\\text{internal}}/c$ is the internal velocity of the alpha particle as a fraction of the speed of light. This velocity is estimated from its kinetic energy, which is assumed to be $Q$ inside the potential well:\n$$v_{\\text{ratio}} = \\sqrt{\\frac{2Q}{\\mu c^2}}$$\nThe half-life $T_{1/2}$ is related to the decay constant by:\n$$T_{1/2} = \\frac{\\ln 2}{\\lambda} = \\frac{\\ln 2}{P_{\\alpha} \\nu \\exp(-2K)}$$\nTo avoid numerical underflow with the very small values of $P$, we work with the logarithm of the half-life. The target quantity is $y = \\log_{10}(T_{1/2}/\\mathrm{s})$, which can be calculated as:\n$$y = \\log_{10}(T_{1/2}) = \\frac{\\ln(T_{1/2})}{\\ln 10} = \\frac{1}{\\ln 10} \\left[ \\ln(\\ln 2) - \\ln(P_{\\alpha}) - \\ln(\\nu) + 2K \\right]$$\nThe units of $\\nu$ are calculated as $\\mathrm{s}^{-1}$ from the input constants, so $T_{1/2}$ is naturally obtained in seconds.\n\n**2. Numerical Implementation and Monte Carlo Simulation**\n\nThe model parameters for the potential ($V_0, a, r_0, r_{0\\mathrm{C}}$) are not known precisely. Their uncertainties are modeled by treating them as independent Gaussian random variables. A Monte Carlo simulation is used to propagate these uncertainties to the final half-life.\n\nFor each of the $N=400$ Monte Carlo samples per test case:\n1.  **Parameter Sampling**: Draw values for $V_0$, $a$, $r_0$, and $r_{0\\mathrm{C}}$ from their specified normal distributions $\\mathcal{N}(\\bar{x}, \\sigma_x)$. Any non-positive draws are discarded and resampled to ensure physical plausibility.\n2.  **Turning Point Calculation**: For the sampled potential, numerically find the roots of the equation $f(r) = V(r) - Q = 0$ within the interval $[10^{-3}, 200]\\,\\mathrm{fm}$. This is done by first scanning the interval to find brackets where the function changes sign, then using a robust root-finding algorithm (Brent's method) to pinpoint the roots $r_1$ and $r_2$. If exactly two turning points are not found, the sample is invalid and discarded.\n3.  **WKB Integral Evaluation**: Numerically compute the integral for the Gamow factor $K$ between the found turning points $r_1$ and $r_2$. A high-quality adaptive quadrature routine is used for this purpose to ensure accuracy.\n4.  **Half-Life Calculation**: Using the calculated $K$ and sampled parameters, compute the assault frequency $\\nu$ and then the value of $y = \\log_{10}(T_{1/2}/\\mathrm{s})$ using the logarithmic formula.\n5.  **Data Aggregation**: Store the resulting $y$ value for the valid sample.\n\nAfter all $N$ samples are processed, the sample mean and sample standard deviation (with Bessel's correction) of the collected $y$ values are computed. These two statistics summarize the predicted value and the propagated uncertainty for the logarithm of the half-life. This entire procedure is repeated for each of the three test cases specified. A fixed random seed ensures the reproducibility of the results.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import brentq\nfrom scipy.integrate import quad\n\ndef solve():\n    \"\"\"\n    Main function to run the alpha decay simulation for the specified test cases.\n    \"\"\"\n    # Define physical constants as per the problem statement\n    HBARC = 197.3269804  # MeV*fm\n    E2 = 1.439964        # MeV*fm\n    C_LIGHT = 2.99792458e23  # fm/s\n    M_U_C2 = 931.49410242 # MeV\n    M_ALPHA_C2 = 3727.379378 # MeV\n    Z_ALPHA = 2.0\n    LN2 = np.log(2.0)\n    LN10 = np.log(10.0)\n\n    # Monte Carlo simulation parameters\n    N_SAMPLES = 400\n    RANDOM_SEED = 12345\n    \n    # Root finding parameters\n    R_MIN, R_MAX = 1e-3, 200.0\n    GRID_POINTS = 2000\n\n    # Define the test cases from the problem statement.\n    # (Zd, Ad, Q, Pa, r0_mean, r0_std, a_mean, a_std, V0_mean, V0_std, r0C_mean, r0C_std)\n    test_cases = [\n        (90.0, 234.0, 4.270, 0.20, 1.20, 0.05, 0.62, 0.05, 120.0, 5.0, 1.20, 0.02),\n        (82.0, 208.0, 8.954, 0.30, 1.20, 0.05, 0.62, 0.05, 120.0, 5.0, 1.20, 0.02),\n        (88.0, 228.0, 4.082, 0.15, 1.20, 0.05, 0.62, 0.05, 120.0, 5.0, 1.20, 0.02),\n    ]\n\n    # Initialize random number generator for reproducibility\n    rng = np.random.default_rng(RANDOM_SEED)\n\n    def draw_positive_normal(mean, std):\n        \"\"\"Draws from a normal distribution, ensuring the result is positive.\"\"\"\n        while True:\n            val = rng.normal(mean, std)\n            if val > 0:\n                return val\n\n    def potential_V(r, V0, a, Ad, Zd, r0, r0C):\n        \"\"\"Calculates the total potential V(r) = V_N(r) + V_C(r).\"\"\"\n        # Nuclear potential (Woods-Saxon)\n        R = r0 * Ad**(1/3.0)\n        Vn = -V0 / (1.0 + np.exp((r - R) / a))\n\n        # Coulomb potential (uniformly charged sphere)\n        Rc = r0C * Ad**(1/3.0)\n        Vc = np.where(r >= Rc,\n                      (Zd * Z_ALPHA * E2) / r,\n                      (Zd * Z_ALPHA * E2) / (2.0 * Rc) * (3.0 - (r/Rc)**2))\n        \n        return Vn + Vc\n\n    def run_case(case_params):\n        \"\"\"Runs the Monte Carlo simulation for a single case.\"\"\"\n        Zd, Ad, Q, Pa, r0_m, r0_s, a_m, a_s, V0_m, V0_s, r0C_m, r0C_s = case_params\n\n        m_d_c2 = Ad * M_U_C2\n        mu_c2 = (M_ALPHA_C2 * m_d_c2) / (M_ALPHA_C2 + m_d_c2)\n\n        y_values = []\n        r_grid = np.linspace(R_MIN, R_MAX, GRID_POINTS)\n\n        for _ in range(N_SAMPLES):\n            # 1. Sample parameters\n            r0_sample = draw_positive_normal(r0_m, r0_s)\n            a_sample = draw_positive_normal(a_m, a_s)\n            V0_sample = draw_positive_normal(V0_m, V0_s)\n            r0C_sample = draw_positive_normal(r0C_m, r0C_s)\n\n            # 2. Find turning points\n            def root_func(r):\n                return potential_V(r, V0_sample, a_sample, Ad, Zd, r0_sample, r0C_sample) - Q\n\n            y_grid = root_func(r_grid)\n            \n            brackets = []\n            for i in range(len(y_grid) - 1):\n                if np.sign(y_grid[i]) != np.sign(y_grid[i+1]):\n                    brackets.append((r_grid[i], r_grid[i+1]))\n\n            if len(brackets) != 2:\n                continue # Discard sample as per requirement\n\n            try:\n                r1 = brentq(root_func, brackets[0][0], brackets[0][1])\n                r2 = brentq(root_func, brackets[1][0], brackets[1][1])\n            except (RuntimeError, ValueError):\n                continue # brentq failed, discard sample\n\n            # 3. WKB integral\n            def wkb_integrand(r):\n                val = 2.0 * mu_c2 * (potential_V(r, V0_sample, a_sample, Ad, Zd, r0_sample, r0C_sample) - Q)\n                # Handle potential floating point inaccuracies near roots\n                return np.sqrt(val) if val > 0 else 0.0\n\n            K, _ = quad(wkb_integrand, r1, r2)\n            K /= HBARC\n\n            # 4. Calculate half-life\n            v_ratio = np.sqrt(2.0 * Q / mu_c2)\n            R_sample = r0_sample * Ad**(1/3.0)\n            nu = (v_ratio * C_LIGHT) / (2.0 * R_sample)\n\n            # Calculate log10(T_1/2) using the logarithmic form to avoid underflow\n            log_T_half_life = (np.log(LN2) - np.log(Pa) - np.log(nu) + 2.0 * K) / LN10\n            y_values.append(log_T_half_life)\n        \n        # 5. Aggregate results\n        if not y_values:\n            # This should not happen with the given parameters but is a safeguard.\n            return 0.0, 0.0\n\n        mean_y = np.mean(y_values)\n        std_y = np.std(y_values, ddof=1) if len(y_values) > 1 else 0.0\n        \n        return mean_y, std_y\n\n    all_results = []\n    for case in test_cases:\n        mean_y, std_y = run_case(case)\n        all_results.extend([mean_y, std_y])\n    \n    # Format the final output string as required.\n    formatted_results = [f\"{x:.3f}\" for x in all_results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "3575895"}]}