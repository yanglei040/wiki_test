{"hands_on_practices": [{"introduction": "One of the most fundamental requirements for a reliable many-body theory is size-consistency, which guarantees that the calculated energy of two non-interacting systems is simply the sum of their individual energies. While this may seem obvious, many approximate methods fail this crucial test. This exercise demonstrates why the specific, diagrammatically-motivated structure of the CCSD(T) correction is so vital by asking you to explore a hypothetical, simpler perturbative correction that violates this principle [@problem_id:3580079]. By quantifying the error on a non-interacting dimer, you will gain a deeper appreciation for the linked-cluster theorem, which underpins the validity of coupled-cluster theory.", "problem": "Consider two identical, noninteracting nuclear fragments, labeled $A$ and $B$, with Hamiltonians $H_{A}$ and $H_{B}$, respectively, so that the total Hamiltonian is $H = H_{A} + H_{B}$. Each fragment is well described at the level of Coupled-Cluster Singles and Doubles (CCSD) and possesses a dominant triples-excitation channel that can be treated perturbatively. Let $|\\Phi_{0,X}\\rangle$ denote the CCSD reference for fragment $X \\in \\{A,B\\}$, and let the dominant triples intermediate state be $|\\tau_{X}\\rangle$ with excitation energy gap $\\Delta$ such that $E_{\\tau_{X}} - E_{0,X} = \\Delta$, where $E_{0,X}$ is the CCSD zero-order energy of fragment $X$. Assume the magnitude of the effective triples coupling matrix element (generated by dressing the two-nucleon interaction within CCSD) between $|\\Phi_{0,X}\\rangle$ and $|\\tau_{X}\\rangle$ is a real constant $g$, i.e., $|\\langle \\Phi_{0,X} | W^{(3)}_{X} | \\tau_{X} \\rangle| = g$, where $W^{(3)}_{X}$ is the effective triples vertex operator for fragment $X$.\n\nStarting from Rayleigh–Schrödinger perturbation theory (RS-PT), the second-order energy correction due to triples for a single fragment $X$ can be written in the standard form using the intermediate-state sum. In a scientifically consistent and size-consistent construction, the dimer correction for noninteracting $A$ and $B$ must equal the sum of the monomer corrections.\n\nNow deliberately define a Rayleigh–Schrödinger style triples correction that violates the linked-cluster theorem and hence size-consistency by using a fragment-local projection and denominator assignment that counts any configuration with a triples excitation on fragment $A$, a triples excitation on fragment $B$, and the simultaneous presence of a triples excitation on both fragments as “triples-level” intermediates for the dimer. Specifically, define a wrong projection operator\n$$\nP_{3}^{\\mathrm{wrong}} \\equiv P_{3}^{A} \\otimes I^{B} \\;+\\; I^{A} \\otimes P_{3}^{B} \\;+\\; P_{3}^{A} \\otimes P_{3}^{B},\n$$\nand, in addition, assign the same single-fragment energy denominator $\\Delta$ to all three classes, rather than using the additive denominator $\\Delta + \\Delta$ for the simultaneous excitation. Treat the effective dimer triples vertex as the direct sum of fragment vertices so that, for each counted intermediate, the magnitude of the coupling is $g$.\n\nUsing Rayleigh–Schrödinger perturbation theory as the fundamental base, and the above intentionally flawed construction, derive the analytic value of the ratio\n$$\nR \\equiv \\frac{E_{AB}^{(T,\\mathrm{RS,wrong})}}{2\\,E_{A}^{(T,\\mathrm{RS})}},\n$$\nwhere $E_{AB}^{(T,\\mathrm{RS,wrong})}$ is the wrong second-order triples correction for the noninteracting dimer and $E_{A}^{(T,\\mathrm{RS})}$ is the correct second-order triples correction for a single fragment $A$ under the same single-channel assumptions. You may assume the fragments are identical, so the parameters $g$ and $\\Delta$ are the same for $A$ and $B$, and that the monomer correction is given by the single-channel RS-PT expression. Express your final answer for $R$ as a single exact number with no units. No rounding is required.", "solution": "The problem statement describes a valid theoretical exercise in quantum many-body physics. It is scientifically grounded in the principles of Rayleigh–Schrödinger perturbation theory (RS-PT) and coupled-cluster theory, objective in its language, and well-posed, providing a complete set of (intentionally flawed) rules from which a unique, meaningful answer can be derived. The purpose of the problem is to quantify the error introduced by violating the linked-cluster theorem, which ensures size-consistency in many-body calculations. This is a standard pedagogical tool to illustrate the importance of diagrammatic techniques in modern physics. Therefore, the problem is valid, and a solution will be provided.\n\nThe primary task is to compute the ratio $R \\equiv \\frac{E_{AB}^{(T,\\mathrm{RS,wrong})}}{2\\,E_{A}^{(T,\\mathrm{RS})}}$. This requires the calculation of two quantities: the correct second-order triples correction for a single fragment, $E_{A}^{(T,\\mathrm{RS})}$, and the incorrect second-order triples correction for the noninteracting dimer, $E_{AB}^{(T,\\mathrm{RS,wrong})}$.\n\nFirst, we determine the correct second-order triples correction for a single fragment $A$, denoted $E_{A}^{(T,\\mathrm{RS})}$. The general formula for the second-order energy correction in RS-PT is:\n$$\nE^{(2)} = \\sum_{k \\neq 0} \\frac{|\\langle \\Psi_0 | V | \\Psi_k \\rangle|^2}{E_0 - E_k}\n$$\nFor fragment $A$, the reference state is $|\\Psi_0\\rangle = |\\Phi_{0,A}\\rangle$ with energy $E_0 = E_{0,A}$. The perturbation is the effective triples vertex operator $V = W_A^{(3)}$. The problem states that there is a single dominant triples intermediate state $|\\Psi_k\\rangle = |\\tau_A\\rangle$ with energy $E_k = E_{\\tau_A}$. The energy gap is given as $E_{\\tau_A} - E_{0,A} = \\Delta$, which implies the energy denominator is $E_{0,A} - E_{\\tau_A} = -\\Delta$. The magnitude of the coupling matrix element is given as $|\\langle \\Phi_{0,A} | W_A^{(3)} | \\tau_A \\rangle| = g$.\n\nSubstituting these given values into the RS-PT formula, the sum over states collapses to a single term:\n$$\nE_{A}^{(T,\\mathrm{RS})} = \\frac{|\\langle \\Phi_{0,A} | W_A^{(3)} | \\tau_A \\rangle|^2}{E_{0,A} - E_{\\tau_A}} = \\frac{g^2}{-\\Delta} = -\\frac{g^2}{\\Delta}\n$$\nThis is the standard expression for the second-order perturbative triples correction under the single-channel approximation.\n\nNext, we calculate the incorrect second-order triples correction for the dimer $AB$, denoted $E_{AB}^{(T,\\mathrm{RS,wrong})}$. We must strictly follow the flawed prescription provided. The reference state for the noninteracting dimer is the product state $|\\Phi_{0,AB}\\rangle = |\\Phi_{0,A}\\rangle \\otimes |\\Phi_{0,B}\\rangle$. The perturbation operator for the dimer is the sum of the fragment operators, $W_{AB}^{(3)} = W_A^{(3)} \\otimes I^B + I^A \\otimes W_B^{(3)}$.\n\nThe flawed calculation proceeds in three steps as defined by the problem:\n1.  **Intermediate States**: The intermediate states are defined by the projection operator $P_{3}^{\\mathrm{wrong}} \\equiv P_{3}^{A} \\otimes I^{B} \\;+\\; I^{A} \\otimes P_{3}^{B} \\;+\\; P_{3}^{A} \\otimes P_{3}^{B}$. With the single-state projector $P_3^X = |\\tau_X\\rangle \\langle \\tau_X|$, the \"counted intermediates\" are:\n    *   $|\\Psi_1\\rangle = |\\tau_A\\rangle \\otimes |\\Phi_{0,B}\\rangle$ (triples on fragment $A$ only)\n    *   $|\\Psi_2\\rangle = |\\Phi_{0,A}\\rangle \\otimes |\\tau_B\\rangle$ (triples on fragment $B$ only)\n    *   $|\\Psi_3\\rangle = |\\tau_A\\rangle \\otimes |\\tau_B\\rangle$ (simultaneous triples on both fragments, an unlinked excitation)\n\n2.  **Energy Denominators**: The problem explicitly states to \"assign the same single-fragment energy denominator $\\Delta$ to all three classes.\" This means the denominator term in the RS-PT formula, $E_0 - E_k$, is artificially set to $-\\Delta$ for all three intermediate states $|\\Psi_1\\rangle$, $|\\Psi_2\\rangle$, and $|\\Psi_3\\rangle$.\n\n3.  **Coupling Matrix Elements**: The problem instructs that \"for each counted intermediate, the magnitude of the coupling is $g$.\" This means we are to assume $|\\langle \\Phi_{0,AB} | W_{AB}^{(3)} | \\Psi_k \\rangle| = g$ for $k=1, 2, 3$. This is a crucial artificial rule, particularly for $|\\Psi_3\\rangle$, as the true matrix element would be zero due to orthogonality, thereby correctly eliminating the unlinked diagram.\n\nFollowing this flawed recipe, we construct the total wrong energy correction by summing the contributions from the three specified intermediate states:\n$$\nE_{AB}^{(T,\\mathrm{RS,wrong})} = \\frac{|\\text{coupling to } \\Psi_1|^2}{\\text{wrong denom}_1} + \\frac{|\\text{coupling to } \\Psi_2|^2}{\\text{wrong denom}_2} + \\frac{|\\text{coupling to } \\Psi_3|^2}{\\text{wrong denom}_3}\n$$\nSubstituting the prescribed values for the numerators and denominators:\n$$\nE_{AB}^{(T,\\mathrm{RS,wrong})} = \\frac{g^2}{-\\Delta} + \\frac{g^2}{-\\Delta} + \\frac{g^2}{-\\Delta} = 3 \\left( -\\frac{g^2}{\\Delta} \\right)\n$$\nBy inspection, we can see that $E_{AB}^{(T,\\mathrm{RS,wrong})} = 3 \\, E_{A}^{(T,\\mathrm{RS})}$. This result violates size-consistency, as the correct energy for the noninteracting dimer should be the sum of the monomer energies, $E_{AB}^{(T,\\mathrm{correct})} = E_{A}^{(T,\\mathrm{RS})} + E_{B}^{(T,\\mathrm{RS})} = 2 \\, E_{A}^{(T,\\mathrm{RS})}$ (since fragments $A$ and $B$ are identical).\n\nFinally, we compute the required ratio $R$:\n$$\nR \\equiv \\frac{E_{AB}^{(T,\\mathrm{RS,wrong})}}{2\\,E_{A}^{(T,\\mathrm{RS})}}\n$$\nSubstituting our derived expressions:\n$$\nR = \\frac{3 \\left(-\\frac{g^2}{\\Delta}\\right)}{2 \\left(-\\frac{g^2}{\\Delta}\\right)}\n$$\nThe term $-\\frac{g^2}{\\Delta}$ cancels from the numerator and the denominator, yielding the final numerical value.\n$$\nR = \\frac{3}{2}\n$$", "answer": "$$\\boxed{\\frac{3}{2}}$$", "id": "3580079"}, {"introduction": "The '(T)' in CCSD(T) stands for a perturbative correction, and like all methods based on perturbation theory, its validity rests on a key assumption: that the energy separation between the reference state and the excited states it interacts with is large compared to the strength of that interaction. In many realistic nuclear systems, this assumption breaks down due to near-degeneracies between occupied and virtual orbitals. This practice provides a direct, hands-on calculation to explore this very scenario [@problem_id:3580146]. By computing the energy denominator for a near-degenerate case, you will see how this condition can lead to numerical instability and diagnose a potential failure of the perturbative approach.", "problem": "Consider a closed-shell reference described by canonical Hartree–Fock (HF) orbitals for a medium-mass nucleus. You will analyze the perturbative triples correction on top of coupled-cluster with singles and doubles (CCSD) using Rayleigh–Schrödinger many-body perturbation theory (RS-MBPT) with the standard Møller–Plesset partitioning of the Hamiltonian into a one-body Fock operator plus a residual interaction. Let $i,j,k$ denote occupied orbitals and $a,b,c$ denote virtual orbitals, all distinct. The canonical orbital energies (in MeV) are:\n- Occupied: $\\varepsilon_{i} = -11.2$, $\\varepsilon_{j} = -6.7$, $\\varepsilon_{k} = -3.9$,\n- Virtual (near-degenerate case): $\\varepsilon_{a} = -7.4$, $\\varepsilon_{b} = -7.2$, $\\varepsilon_{c} = -7.1$.\n\nA reduced, single-channel model for the perturbative triples energy is adopted in which all connected, antisymmetrized, and permutation-summed numerator contributions for the triple $(i,j,k) \\rightarrow (a,b,c)$ are collected into one effective scalar $M_{ijk}^{abc}$ with units of $\\text{MeV}^2$, and all other triples contributions vanish. For this channel, you are given $M_{ijk}^{abc} = 0.135$ $\\text{MeV}^2$. Work in a canonical basis in which the Fock operator is diagonal.\n\nStarting from RS-MBPT definitions for energy corrections with a non-interacting reference and using only basic properties of canonical orbitals and antisymmetry under particle–hole index permutations (do not assume any pre-quoted “final formula”), do the following:\n1. Derive the form of the non-interacting energy denominator for the triple excitation $(i,j,k) \\rightarrow (a,b,c)$ in terms of the canonical orbital energies and evaluate its numerical value for the near-degenerate case above.\n2. Identify the symmetry factor arising from independent permutations of the three hole indices and the three particle indices for a single distinct triple channel in a canonical basis, and use it to write the single-channel perturbative triples energy in terms of $M_{ijk}^{abc}$ and your evaluated denominator.\n3. Evaluate the resulting single-channel perturbative triples correction $E^{(T)}$ numerically.\n\nFor context in assessing numerical stability (no additional calculation beyond evaluation of the denominator is required), consider a “reference” virtual set with $\\varepsilon_{a'} = -2.0$, $\\varepsilon_{b'} = -1.2$, $\\varepsilon_{c'} = -0.6$ while keeping the same occupied set. Compute the corresponding denominator for this reference set and briefly comment, based on magnitudes of the denominators, on the numerical stability of $E^{(T)}$ in the near-degenerate case versus the reference case. Your reported final answer must be the numerical value of $E^{(T)}$ for the near-degenerate case. Round your answer to four significant figures and express the energy in MeV.", "solution": "The problem is validated as scientifically grounded, well-posed, and objective. It is set within the standard theoretical framework of many-body perturbation theory as applied to coupled-cluster methods in computational physics. All necessary data are provided, and the problem structure leads to a unique solution.\n\nThe solution proceeds in three parts as requested by the problem statement.\n\n1. Derivation and Evaluation of the Energy Denominator\n\nIn Rayleigh–Schrödinger many-body perturbation theory (RS-MBPT) with a Møller–Plesset partitioning, the unperturbed Hamiltonian, $H_0$, is the Fock operator $F$, and the perturbation, $V$, is the residual two-body interaction. The Hartree–Fock ground state, $|\\Phi_0\\rangle$, is an eigenstate of $H_0$ with eigenvalue $E_0^{(0)}$, which is the sum of the orbital energies of all occupied orbitals.\n$$E_0^{(0)} = \\sum_{l \\in \\text{occ}} \\varepsilon_l$$\nThe basis of canonical orbitals is chosen such that the Fock operator is diagonal: $F | \\phi_p \\rangle = \\varepsilon_p | \\phi_p \\rangle$.\nAn unperturbed triply excited determinant, $|\\Phi_{ijk}^{abc}\\rangle$, is formed by promoting three electrons from occupied orbitals $i,j,k$ to virtual orbitals $a,b,c$. This state is also an eigenstate of $H_0$ with eigenvalue $E_{ijk}^{abc,(0)}$. Its energy is the ground state energy plus the cost of removing the electrons from the occupied orbitals and placing them into virtual orbitals.\n$$E_{ijk}^{abc,(0)} = E_0^{(0)} - \\varepsilon_i - \\varepsilon_j - \\varepsilon_k + \\varepsilon_a + \\varepsilon_b + \\varepsilon_c$$\nThe energy denominator for a perturbative contribution involving the intermediate state $|\\Phi_{ijk}^{abc}\\rangle$ is the difference between the unperturbed energies of the ground state and the excited state.\n$$D_{ijk}^{abc} = E_0^{(0)} - E_{ijk}^{abc,(0)} = E_0^{(0)} - (E_0^{(0)} - \\varepsilon_i - \\varepsilon_j - \\varepsilon_k + \\varepsilon_a + \\varepsilon_b + \\varepsilon_c)$$\nThis simplifies to:\n$$D_{ijk}^{abc} = \\varepsilon_i + \\varepsilon_j + \\varepsilon_k - \\varepsilon_a - \\varepsilon_b - \\varepsilon_c$$\nUsing the provided orbital energies for the near-degenerate case:\n$\\varepsilon_i = -11.2$ MeV, $\\varepsilon_j = -6.7$ MeV, $\\varepsilon_k = -3.9$ MeV,\n$\\varepsilon_a = -7.4$ MeV, $\\varepsilon_b = -7.2$ MeV, $\\varepsilon_c = -7.1$ MeV.\nThe numerical value of the denominator is:\n$$D_{ijk}^{abc} = (-11.2) + (-6.7) + (-3.9) - ((-7.4) + (-7.2) + (-7.1)) \\text{ MeV}$$\n$$D_{ijk}^{abc} = -21.8 - (-21.7) \\text{ MeV} = -0.1 \\text{ MeV}$$\n\nFor the context question, we compute the denominator for the \"reference\" virtual set with $\\varepsilon_{a'} = -2.0$ MeV, $\\varepsilon_{b'} = -1.2$ MeV, and $\\varepsilon_{c'} = -0.6$ MeV, keeping the occupied energies the same.\n$$D_{ijk}^{a'b'c'} = \\varepsilon_i + \\varepsilon_j + \\varepsilon_k - \\varepsilon_{a'} - \\varepsilon_{b'} - \\varepsilon_{c'}$$\n$$D_{ijk}^{a'b'c'} = -21.8 - ((-2.0) + (-1.2) + (-0.6)) \\text{ MeV}$$\n$$D_{ijk}^{a'b'c'} = -21.8 - (-3.8) \\text{ MeV} = -18.0 \\text{ MeV}$$\nThe magnitude of the denominator in the near-degenerate case ($|D_{ijk}^{abc}| = 0.1$ MeV) is drastically smaller than in the reference case ($|D_{ijk}^{a'b'c'}| = 18.0$ MeV). Since the perturbative energy correction $E^{(T)}$ is inversely proportional to this denominator, the near-degenerate case will yield a much larger energy correction. This indicates a potential failure of the perturbative approach, as the small energy separation between the ground and excited states violates the assumption of a small perturbation. The result is numerically unstable because minute variations in the nearly degenerate orbital energies would cause large fluctuations in the calculated energy correction.\n\n2. Symmetry Factor and Energy Expression\n\nThe total perturbative triples energy correction, $E^{(T)}$, is obtained by summing contributions from all distinct triple excitation channels. To avoid overcounting identical contributions in a general summation over all indices, a symmetry factor is introduced. For a triple excitation involving three distinct hole indices ($i,j,k$) and three distinct particle indices ($a,b,c$), there are $3!$ permutations of the hole indices and $3!$ permutations of the particle indices. Since these are independent, there are $3! \\times 3! = 6 \\times 6 = 36$ ways to label a diagram with a specific set of six orbitals, all corresponding to the same physical channel.\n\nWhen the energy expression is written as a sum over all indices $i,j,k,a,b,c$, a symmetry factor of $S = \\frac{1}{3! \\times 3!} = \\frac{1}{36}$ is required to correctly count each distinct channel's contribution once. The general formula takes the form:\n$$E^{(T)}_{\\text{total}} = \\frac{1}{36} \\sum_{i,j,k,a,b,c} \\frac{N(i,j,k,a,b,c)}{D(i,j,k,a,b,c)}$$\nwhere $N(i,j,k,a,b,c)$ is the fundamental numerator contribution for a specific set of labeled indices.\n\nThe problem states that only a single channel contributes to the energy, and it provides an \"effective scalar $M_{ijk}^{abc}$\" which represents the \"permutation-summed numerator contributions\". This implies that $M_{ijk}^{abc}$ is the sum of the fundamental numerator over all permutations for the given channel:\n$$M_{ijk}^{abc} = \\sum_{P \\in S_3} \\sum_{Q \\in S_3} N(P(i,j,k), Q(a,b,c))$$\nwhere $P$ and $Q$ are permutation operators acting on the hole and particle indices, respectively. The energy contribution from this single channel is found by restricting the total energy sum to only the permutations of the given indices:\n$$E^{(T)} = \\frac{1}{36} \\sum_{P \\in S_3} \\sum_{Q \\in S_3} \\frac{N(P(i,j,k), Q(a,b,c))}{D(P(i,j,k), Q(a,b,c))}$$\nSince we are using a canonical basis with distinct orbital energies, the denominator $D_{ijk}^{abc}$ is invariant under any permutation of the hole indices among themselves or the particle indices among themselves. Thus, we can factor it out of the summation:\n$$E^{(T)} = \\frac{1}{36 D_{ijk}^{abc}} \\sum_{P \\in S_3} \\sum_{Q \\in S_3} N(P(i,j,k), Q(a,b,c))$$\nSubstituting the given definition of $M_{ijk}^{abc}$, the expression for the single-channel perturbative triples energy correction is:\n$$E^{(T)} = \\frac{1}{36} \\frac{M_{ijk}^{abc}}{D_{ijk}^{abc}}$$\n\n3. Numerical Evaluation of the Triples Correction\n\nUsing the provided value $M_{ijk}^{abc} = 0.135 \\text{ MeV}^2$ and the calculated denominator $D_{ijk}^{abc} = -0.1$ MeV, we evaluate the energy correction $E^{(T)}$:\n$$E^{(T)} = \\frac{1}{36} \\frac{0.135 \\text{ MeV}^2}{-0.1 \\text{ MeV}}$$\n$$E^{(T)} = \\frac{1}{36} \\times (-1.35 \\text{ MeV})$$\n$$E^{(T)} = -0.0375 \\text{ MeV}$$\nThe problem asks for the answer to be rounded to four significant figures.\n$$E^{(T)} = -0.03750 \\text{ MeV}$$\nThis is the numerical value for the single-channel perturbative triples correction.", "answer": "$$\\boxed{-0.03750}$$", "id": "3580146"}, {"introduction": "Beyond theoretical correctness and applicability, the feasibility of a computational method hinges on its efficiency. The perturbative triples correction is notoriously expensive, scaling steeply with system size. Fortunately, for systems possessing fundamental symmetries, such as the rotational invariance of spherical nuclei, we can redesign algorithms to dramatically reduce costs. This exercise moves from theory to implementation, tasking you with a quantitative comparison between a generic brute-force approach (the $m$-scheme) and a sophisticated method that exploits angular momentum conservation (the $J$-coupled scheme) [@problem_id:3580110]. By counting the degrees of freedom in both representations, you will directly quantify the immense computational savings that make modern nuclear structure calculations possible.", "problem": "You are tasked with designing a computational plan for the perturbative triples correction $E^{(T)}$ in the Coupled-Cluster with Singles and Doubles method (CCSD), specialized to a spherical, $J$-coupled representation appropriate for closed-shell nuclei. The objective is to quantify the algorithmic savings in memory and floating-point operations (flops) achieved by using reduced matrix elements with angular-momentum recoupling via Wigner $6j$ and $9j$ symbols, when compared to a traditional magnetic quantum number ($m$-scheme) implementation. The nucleus of interest is ${}^{24}\\text{O}$, which has a neutron closed subshell structure in the $sd$ shell.\n\nStarting from first principles, use the following foundational bases:\n\n- The Wigner–Eckart theorem states that matrix elements of spherical tensor operators factorize into a reduced matrix element and a geometric part given by Clebsch–Gordan coefficients. In symbols, the theorem asserts that\n$$\n\\langle j_a m_a | T^{(k)}_q | j_b m_b \\rangle = \\frac{\\langle j_a \\| T^{(k)} \\| j_b \\rangle}{\\sqrt{2j_a+1}} \\, C^{j_a m_a}_{j_b m_b, k q},\n$$\nwhere $C^{j_a m_a}_{j_b m_b, k q}$ is a Clebsch–Gordan coefficient.\n- For two-body operators and two-particle states, recoupling identities via Wigner $6j$ and $9j$ symbols allow replacement of explicit $(m)$-sums by analytic factors subject to triangle constraints and selection rules. In a scalar closed-shell ground state with total angular momentum $J=0$, coupled two-body amplitudes obey $J_{\\mathrm{holes}} = J_{\\mathrm{particles}}$ in the reduced form.\n- For identical fermions occupying the same single-particle orbit with total angular momentum $j$ (that is, same $n\\ell j$ labels), the allowed coupled two-body total angular momenta $J$ are the even integers from $0$ to $2j-1$. For two distinct orbits with angular momenta $j_1$ and $j_2$, the allowed $J$ satisfy triangle conditions $J \\in \\{|j_1 - j_2|, |j_1 - j_2| + 1, \\dots, j_1 + j_2\\}$, and $J$ is an integer for half-integer $j_1$ and $j_2$.\n\nDefine the memory and flop models as follows:\n\n- In the $m$-scheme, consider the unique antisymmetrized doubles tensor $t_{ij}^{ab}$ with $i  j$ and $a  b$, where $i,j$ refer to hole states and $a,b$ refer to particle states. If the total number of hole single-particle states is $N_h$ and the total number of particle single-particle states is $N_p$, the number of unique tensor entries is\n$$\nN_{\\mathrm{m}} = \\binom{N_h}{2} \\binom{N_p}{2}.\n$$\nAssume each stored number is an $8$-byte floating-point value, so memory in bytes is $M_{\\mathrm{m}} = 8 N_{\\mathrm{m}}$. For the flop model, assume a base of $2$ floating-point operations per contribution to the $E^{(T)}$ accumulation, so\n$$\nF_{\\mathrm{m}} = 2 N_{\\mathrm{m}}.\n$$\n- In the $J$-coupled scheme, index reduced doubles amplitudes by unordered pairs of hole orbits and unordered pairs of particle orbits, each labeled by their angular momenta $j$, together with the common coupled two-body total angular momentum $J$ that satisfies the triangle rules for both pairs and the scalar selection $J_{\\mathrm{holes}} = J_{\\mathrm{particles}}$. Let $N_{\\mathrm{J}}$ be the total number of such reduced channels, obtained by summing the sizes of the intersections of allowed $J$-sets for each pair combination. The memory in bytes is\n$$\nM_{\\mathrm{J}} = 8 N_{\\mathrm{J}} + B_{\\mathrm{ang}} N_{\\mathrm{J}},\n$$\nwhere $B_{\\mathrm{ang}}$ is a per-channel byte overhead representing precomputed Wigner $6j$/$9j$ tables and related geometric coefficients. The flop model is\n$$\nF_{\\mathrm{J}} = (2 + C_{\\mathrm{ang}}) N_{\\mathrm{J}},\n$$\nwhere $C_{\\mathrm{ang}}$ is a per-channel angular recoupling overhead in floating-point operations.\n\nYou must compute and report the savings ratios\n$$\nS_M = \\frac{M_{\\mathrm{m}}}{M_{\\mathrm{J}}}, \\qquad S_F = \\frac{F_{\\mathrm{m}}}{F_{\\mathrm{J}}},\n$$\nfor each test case. These ratios are dimensionless.\n\nAngular-momentum channel counting rules:\n\n- Represent each single-particle orbit by a label and its total angular momentum $j$ (a half-integer). The degeneracy of each orbit is $g = 2j + 1$.\n- The total number of hole single-particle states is $N_h = \\sum_{\\text{hole orbits}} g$, and similarly $N_p = \\sum_{\\text{particle orbits}} g$.\n- For an unordered pair of identical orbits with angular momentum $j$ (that is, the pair consists of the same orbit label twice), the allowed $J$-set is $\\{0, 2, 4, \\dots, 2j-1\\}$.\n- For an unordered pair of distinct orbits with angular momenta $j_1$ and $j_2$, the allowed $J$-set is $\\{|j_1 - j_2|, |j_1 - j_2| + 1, \\dots, j_1 + j_2\\}$.\n- The $J$-channels that contribute to reduced doubles amplitudes are the intersections of the allowed $J$-sets of the hole pair and the particle pair.\n\nImplement the above counting exactly and produce the required savings ratios for the following test suite that models neutron configurations for ${}^{24}\\text{O}$ in realistic shells:\n\n- Test case $1$ (baseline $sd$-shell particles):\n    - Hole orbits: $\\{ (0\\text{d}_{5/2}, j = 5/2), (1\\text{s}_{1/2}, j = 1/2) \\}$.\n    - Particle orbits: $\\{ (0\\text{d}_{3/2}, j = 3/2) \\}$.\n    - Angular overhead parameters: $B_{\\mathrm{ang}} = 64$ bytes per channel, $C_{\\mathrm{ang}} = 12$ flops per channel.\n- Test case $2$ (add $pf$-shell $0f_{7/2}$ particles):\n    - Hole orbits: $\\{ (0\\text{d}_{5/2}, j = 5/2), (1\\text{s}_{1/2}, j = 1/2) \\}$.\n    - Particle orbits: $\\{ (0\\text{d}_{3/2}, j = 3/2), (0\\text{f}_{7/2}, j = 7/2) \\}$.\n    - Angular overhead parameters: $B_{\\mathrm{ang}} = 128$ bytes per channel, $C_{\\mathrm{ang}} = 16$ flops per channel.\n- Test case $3$ (extended particles including $1p_{3/2}$ distinct from $0d_{3/2}$):\n    - Hole orbits: $\\{ (0\\text{d}_{5/2}, j = 5/2), (1\\text{s}_{1/2}, j = 1/2) \\}$.\n    - Particle orbits: $\\{ (0\\text{d}_{3/2}, j = 3/2), (0\\text{f}_{7/2}, j = 7/2), (1\\text{p}_{3/2}, j = 3/2) \\}$, where $0\\text{d}_{3/2}$ and $1\\text{p}_{3/2}$ are distinct orbits with the same $j$.\n    - Angular overhead parameters: $B_{\\mathrm{ang}} = 0$ bytes per channel, $C_{\\mathrm{ang}} = 0$ flops per channel.\n\nYour program should compute the savings ratios $S_M^{(1)}, S_F^{(1)}, S_M^{(2)}, S_F^{(2)}, S_M^{(3)}, S_F^{(3)}$ for each test case and produce a single line of output containing the results as a comma-separated list enclosed in square brackets in the order\n$$\n[S_M^{(1)}, S_F^{(1)}, S_M^{(2)}, S_F^{(2)}, S_M^{(3)}, S_F^{(3)}].\n$$\nAll numbers must be printed as floating-point values. No external input is allowed, and no physical units are required since all outputs are dimensionless ratios.", "solution": "The problem requires a quantitative comparison of the computational cost, in terms of memory and floating-point operations (flops), for calculating the perturbative triples correction, $E^{(T)}$, in a coupled-cluster calculation. The comparison is between a standard implementation using magnetic quantum numbers (the $m$-scheme) and an implementation leveraging angular momentum theory (the $J$-coupled scheme). The goal is to compute the savings ratios, $S_M$ and $S_F$, for three specified test cases relevant to nuclear structure calculations of oxygen-$^{24}\\mathrm{O}$.\n\nThe analysis proceeds in two parts. First, we define the cost models for each scheme based on the provided problem statement. Second, we apply these models to each test case by performing a detailed enumeration of states and channels.\n\n### 1. Cost Model: $m$-Scheme\n\nIn the $m$-scheme, single-particle states are indexed by a full set of quantum numbers, including the magnetic quantum number $m$. A single-particle orbit with total angular momentum $j$ is thus a collection of $g = 2j+1$ degenerate single-particle states.\n\nThe total number of hole states, $N_h$, and particle states, $N_p$, are found by summing the degeneracies of the respective orbits:\n$$\nN_h = \\sum_{i \\in \\text{hole orbits}} (2j_i+1)\n$$\n$$\nN_p = \\sum_{a \\in \\text{particle orbits}} (2j_a+1)\n$$\n\nThe doubles amplitudes, which are the primary objects stored and manipulated, are antisymmetric tensors $t_{ij}^{ab}$. To count the number of unique elements, we consider unordered pairs of holes and unordered pairs of particles. The total number of such unique elements, $N_{\\mathrm{m}}$, is given by the product of binomial coefficients:\n$$\nN_{\\mathrm{m}} = \\binom{N_h}{2} \\binom{N_p}{2}\n$$\n\nThe memory cost, $M_{\\mathrm{m}}$, is modeled as the total number of elements times the size of a floating-point number, specified as $8$ bytes. The flop cost, $F_{\\mathrm{m}}$, is modeled as a base of $2$ floating-point operations per tensor element contribution.\n$$\nM_{\\mathrm{m}} = 8 N_{\\mathrm{m}}\n$$\n$$\nF_{\\mathrm{m}} = 2 N_{\\mathrm{m}}\n$$\n\n### 2. Cost Model: $J$-Coupled Scheme\n\nIn the $J$-coupled scheme, states are grouped by their total angular momentum $J$. This exploits the rotational symmetry of the nuclear Hamiltonian, significantly reducing the number of independent quantities to be stored. The number of independent quantities, $N_{\\mathrm{J}}$, is the number of reduced two-body channels. A channel is defined by a pair of hole orbits, a pair of particle orbits, and a common coupled total angular momentum $J$.\n\nThe calculation of $N_{\\mathrm{J}}$ requires enumerating all valid channels:\n1.  Enumerate all unordered pairs of hole orbits, $\\{h_1, h_2\\}$. For each pair, determine the set of allowed coupled total angular momenta, $J_{\\mathrm{holes}}$. The rules are:\n    - If $h_1$ and $h_2$ are the same orbit (with angular momentum $j_h$): $J_{\\mathrm{holes}} = \\{0, 2, 4, \\dots, 2j_h-1\\}$ due to the Pauli exclusion principle for identical fermions.\n    - If $h_1$ and $h_2$ are distinct orbits (with angular momenta $j_{h1}, j_{h2}$): $J_{\\mathrm{holes}} = \\{|j_{h1}-j_{h2}|, |j_{h1}-j_{h2}|+1, \\dots, j_{h1}+j_{h2}\\}$ from standard angular momentum coupling rules.\n\n2.  Enumerate all unordered pairs of particle orbits, $\\{p_1, p_2\\}$. For each pair, determine the set of allowed coupled total angular momenta, $J_{\\mathrm{particles}}$, using the same rules as for holes.\n\n3.  The total number of channels, $N_{\\mathrm{J}}$, is the sum of the number of common $J$ values over all combinations of hole pairs and particle pairs. For each (hole pair, particle pair) combination, the number of contributing channels is the size of the intersection of their respective $J$ sets: $|\\,J_{\\mathrm{holes}}(\\{h_1, h_2\\}) \\cap J_{\\mathrm{particles}}(\\{p_1, p_2\\})\\,|\n$$\nN_{\\mathrm{J}} = \\sum_{\\substack{\\text{hole pairs} \\\\ \\{h_1, h_2\\}}} \\sum_{\\substack{\\text{particle pairs} \\\\ \\{p_1, p_2\\}}} |\\,J_{\\mathrm{holes}}(\\{h_1, h_2\\}) \\cap J_{\\mathrm{particles}}(\\{p_1, p_2\\})\\,|\n$$\n\nThe memory and flop costs now include overheads for storing and using precomputed angular momentum recoupling coefficients (Wigner symbols).\n$$\nM_{\\mathrm{J}} = (8 + B_{\\mathrm{ang}}) N_{\\mathrm{J}}\n$$\n$$\nF_{\\mathrm{J}} = (2 + C_{\\mathrm{ang}}) N_{\\mathrm{J}}\n$$\nwhere $B_{\\mathrm{ang}}$ and $C_{\\mathrm{ang}}$ are the given per-channel overheads.\n\nThe logic described above can be implemented in a program to solve for the savings ratios.\n\n```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nimport math\nfrom itertools import combinations_with_replacement\n\ndef get_j_set(orbit1, orbit2):\n    \"\"\"\n    Calculates the set of allowed coupled angular momenta J for a pair of orbits.\n    Each orbit is a tuple (label, j_value).\n    \"\"\"\n    label1, j1 = orbit1\n    label2, j2 = orbit2\n\n    if label1 == label2:  # Identical orbits\n        # Allowed J are even integers from 0 to 2j-1\n        # Since 2*j is always an odd integer, 2*j-1 is an even integer\n        max_j_val = int(2 * j1 - 1)\n        return set(range(0, max_j_val + 1, 2))\n    else:  # Distinct orbits\n        # Allowed J Follow triangle rule: |j1-j2| = J = j1+j2\n        # j1, j2 are half-integers, so j1-j2 and j1+j2 are integers.\n        min_j_val = int(abs(j1 - j2))\n        max_j_val = int(j1 + j2)\n        return set(range(min_j_val, max_j_val + 1))\n\ndef solve():\n    \"\"\"\n    Computes memory and flop savings ratios for m-scheme vs J-coupled scheme\n    in nuclear coupled-cluster calculations.\n    \"\"\"\n    # Define test cases as (hole_orbits, particle_orbits, B_ang, C_ang)\n    # Orbits are defined as (label, j_value)\n    test_cases = [\n        # Case 1\n        (\n            [('0d5/2', 5/2), ('1s1/2', 1/2)],\n            [('0d3/2', 3/2)],\n            64,\n            12\n        ),\n        # Case 2\n        (\n            [('0d5/2', 5/2), ('1s1/2', 1/2)],\n            [('0d3/2', 3/2), ('0f7/2', 7/2)],\n            128,\n            16\n        ),\n        # Case 3\n        (\n            [('0d5/2', 5/2), ('1s1/2', 1/2)],\n            [('0d3/2', 3/2), ('0f7/2', 7/2), ('1p3/2', 3/2)],\n            0,\n            0\n        )\n    ]\n\n    results = []\n\n    for case in test_cases:\n        hole_orbits, particle_orbits, B_ang, C_ang = case\n\n        # --- M-scheme calculation ---\n        N_h = sum(2 * j + 1 for _, j in hole_orbits)\n        N_p = sum(2 * j + 1 for _, j in particle_orbits)\n\n        if N_h  2 or N_p  2:\n            N_m = 0\n        else:\n            N_m = math.comb(int(N_h), 2) * math.comb(int(N_p), 2)\n\n        M_m = 8 * N_m\n        F_m = 2 * N_m\n\n        # --- J-coupled scheme calculation ---\n        hole_pairs = list(combinations_with_replacement(hole_orbits, 2))\n        particle_pairs = list(combinations_with_replacement(particle_orbits, 2))\n\n        N_J = 0\n        for h_pair in hole_pairs:\n            j_set_holes = get_j_set(h_pair[0], h_pair[1])\n            for p_pair in particle_pairs:\n                j_set_particles = get_j_set(p_pair[0], p_pair[1])\n                \n                # Count channels from the intersection of J sets\n                N_J += len(j_set_holes.intersection(j_set_particles))\n\n        M_J = (8 + B_ang) * N_J\n        F_J = (2 + C_ang) * N_J\n\n        # --- Savings Ratios ---\n        S_M = M_m / M_J if M_J > 0 else 0.0\n        S_F = F_m / F_J if F_J > 0 else 0.0\n        \n        results.extend([S_M, S_F])\n    \n    return f\"[{','.join(map(str, results))}]\"\n\n# The result is generated by running the code.\n# print(solve())\n```", "answer": "[4.666666666666667,6.0,8.361968325791855,15.794871794871794,129.23076923076923,129.23076923076923]", "id": "3580110"}]}