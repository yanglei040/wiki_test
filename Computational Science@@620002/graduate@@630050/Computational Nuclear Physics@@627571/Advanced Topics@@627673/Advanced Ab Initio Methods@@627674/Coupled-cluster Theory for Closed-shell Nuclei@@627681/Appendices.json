{"hands_on_practices": [{"introduction": "To truly grasp the power and limitations of an approximation, there is no substitute for comparing it against an exact result. This first practice [@problem_id:3554004] provides a hands-on opportunity to do just that within a simplified but powerful pairing model. By implementing both an exact diagonalization and a linearized coupled-cluster doubles approximation, you will develop a concrete understanding of how the cluster operator $\\hat{T}_2$ captures strong pairing correlations and learn to identify physical regimes where this approximation falters, signaling the necessity of including more complex triple excitations.", "problem": "You are to design and analyze a closed-shell pairing model to contrast the performance of Coupled-Cluster with Singles and Doubles (CCSD) against an exact solution in the seniority-zero subspace. Starting from the time-independent Schrödinger equation and second-quantized operators, build a computational model to quantify how double excitations in CCSD capture pairing correlations and identify regimes where connected triple excitations become essential.\n\nFundamental base:\n- The time-independent Schrödinger equation is $$H |\\Psi\\rangle = E |\\Psi\\rangle$$.\n- In second quantization for time-reversed single-particle states, the reduced pairing Hamiltonian is\n$$\nH = \\sum_{i=0}^{M-1} \\epsilon_i \\left( n_{i\\uparrow} + n_{i\\downarrow} \\right) - G \\sum_{i,j=0}^{M-1} P_i^\\dagger P_j,\n$$\nwhere $P_i^\\dagger = a_{i\\uparrow}^\\dagger a_{i\\downarrow}^\\dagger$ creates a pair in level $i$, $n_{i\\sigma} = a_{i\\sigma}^\\dagger a_{i\\sigma}$, $G > 0$ is the attractive pairing strength, and $\\epsilon_i$ are single-particle energies. A closed-shell reference determinant $|\\Phi_0\\rangle$ fills $N$ pair levels ($N$ pairs) among $M$ doubly degenerate levels.\n\nModel and exact solution specification:\n- Restrict to the seniority-zero subspace spanned by basis states with pair occupancies $n_i \\in \\{0,1\\}$ and $\\sum_i n_i = N$. In this subspace, the off-diagonal matrix elements of the pairing term connect configurations that differ by moving one pair from an occupied level $j$ to an unoccupied level $i$, with amplitude $-G$. The diagonal matrix element of the pairing term for any basis configuration is $-G N$, and the one-body diagonal contribution is $2 \\sum_{i} \\epsilon_i n_i$.\n- Construct the Hamiltonian matrix $H$ in this seniority-zero basis, and find the exact ground-state energy $E_{\\text{exact}}$ by diagonalizing $H$.\n\nCoupled-cluster doubles analysis:\n- Consider CCSD truncated to doubles in the seniority-zero space, i.e., only pair excitations are included. The cluster operator is\n$$\nT_2 = \\sum_{i \\in \\text{occ}} \\sum_{a \\in \\text{virt}} t_{i a} \\, P_a^\\dagger P_i,\n$$\nwith occupied indices $i$ labeling pair levels filled in $|\\Phi_0\\rangle$ and virtual indices $a$ labeling unfilled levels.\n- Derive the linearized doubles amplitude $t_{ia}$ by projecting the similarity-transformed Schrödinger equation onto $\\langle \\Phi_0 | P_i^\\dagger P_a$ and retaining leading-order terms consistent with many-body perturbation theory for a two-body Hamiltonian. Use the fact that the energy denominator for moving a time-reversed pair from level $i$ to $a$ is $2(\\epsilon_i - \\epsilon_a)$, and the corresponding two-body matrix element for pair scattering $i \\to a$ is $-G$.\n- Using these amplitudes, derive the leading-order correlation energy from the doubles cluster operator as the linked contribution\n$$\nE_{\\text{corr}}^{(2)} = \\sum_{i \\in \\text{occ}} \\sum_{a \\in \\text{virt}} (-G) \\, t_{ia},\n$$\nand the approximate CCSD doubles energy\n$$\nE_{\\text{CCSD,\\,doubles}} = E_{\\text{ref}} + E_{\\text{corr}}^{(2)},\n$$\nwhere $E_{\\text{ref}}$ is the expectation value of $H$ in the closed-shell reference $|\\Phi_0\\rangle$.\n\nTriples necessity indicator:\n- Define the total correlation energy as $E_{\\text{corr}}^{\\text{exact}} = E_{\\text{exact}} - E_{\\text{ref}}$ and the doubles-only error as $\\Delta_d = E_{\\text{exact}} - E_{\\text{CCSD,\\,doubles}}$.\n- Quantify where connected triple excitations become essential via the dimensionless ratio\n$$\nR = \\frac{|\\Delta_d|}{|E_{\\text{corr}}^{\\text{exact}}|}.\n$$\nAdopt the criterion that when $R \\ge 0.3$ and $N \\ge 3$ (at least three pairs are present), connected triple excitations are essential for quantitative accuracy.\n\nAlgorithmic tasks to implement:\n1. Generate the seniority-zero basis of dimension $\\binom{M}{N}$ as all subsets of $N$ occupied levels among $M$.\n2. Build the Hamiltonian matrix using the rules above and diagonalize to obtain $E_{\\text{exact}}$.\n3. Compute $E_{\\text{ref}}$ for the closed-shell configuration that fills the $N$ lowest single-particle levels.\n4. Derive and compute the linearized doubles amplitudes $t_{ia}$ and $E_{\\text{CCSD,\\,doubles}}$.\n5. Compute $R$ and the triples necessity flag as a boolean.\n\nSingle-particle spectrum:\n- Use equally spaced single-particle energies $\\epsilon_i = d \\left( i - \\frac{M - 1}{2} \\right)$ for $i = 0, 1, \\dots, M - 1$ to avoid degeneracies across the Fermi surface.\n\nUnits and output:\n- All energies must be expressed in megaelectronvolts (MeV) and printed as floating-point numbers rounded to six decimal places.\n- Your program must produce a single line of output containing the results as a comma-separated list enclosed in square brackets. Each element of this list corresponds to a test case and must itself be a list in the form $[E_{\\text{exact}}, E_{\\text{CCSD,\\,doubles}}, R, \\text{flag}]$, with the first three entries floats (MeV for the first two, dimensionless for $R$) and the last entry a boolean.\n\nTest suite:\n- Case A (happy path): $M = 4$, $N = 2$, $d = 1.0 \\, \\text{MeV}$, $G = 0.2 \\, \\text{MeV}$.\n- Case B (onset of triples relevance): $M = 6$, $N = 3$, $d = 1.0 \\, \\text{MeV}$, $G = 0.4 \\, \\text{MeV}$.\n- Case C (strong pairing, dense spectrum): $M = 6$, $N = 3$, $d = 0.2 \\, \\text{MeV}$, $G = 0.8 \\, \\text{MeV}$.\n- Case D (larger system): $M = 8$, $N = 4$, $d = 1.0 \\, \\text{MeV}$, $G = 0.3 \\, \\text{MeV}$.\n\nFinal output format:\n- Your program should produce a single line of output containing the results for all cases as a comma-separated list enclosed in square brackets, with each case formatted as $[E_{\\text{exact}},E_{\\text{CCSD,\\,doubles}},R,\\text{flag}]$ using exactly six decimal places for floats and no spaces (e.g., [[-12.345678,-12.000123,0.123456,True],[...],...]).", "solution": "The problem requires the design and implementation of a computational model to compare an exact many-body solution with the widely-used Coupled-Cluster Singles and Doubles (CCSD) approximation for a closed-shell nuclear pairing problem. The goal is to quantify the regimes where the CCSD approximation, truncated to only include double excitations ($T_2$), is insufficient, thereby indicating the necessity of including connected triple excitations ($T_3$). The entire analysis is performed within the seniority-zero subspace, where all nucleons are paired.\n\nThe foundation of the model is the reduced pairing Hamiltonian, expressed in the language of second quantization for a system of $N$ pairs distributed among $M$ doubly-degenerate single-particle levels:\n$$\nH = \\sum_{i=0}^{M-1} \\epsilon_i \\left( n_{i\\uparrow} + n_{i\\downarrow} \\right) - G \\sum_{i,j=0}^{M-1} P_i^\\dagger P_j\n$$\nHere, $\\epsilon_i$ represents the energy of the $i$-th single-particle level, and $n_{i\\sigma} = a_{i\\sigma}^\\dagger a_{i\\sigma}$ is the number operator for a fermion with spin $\\sigma$ in level $i$. The pairs are created by the operator $P_i^\\dagger = a_{i\\uparrow}^\\dagger a_{i\\downarrow}^\\dagger$, which places two fermions with opposite spins into the time-reversed states of level $i$. The term $-G \\sum_{i,j} P_i^\\dagger P_j$ with a pairing strength $G > 0$ describes an attractive interaction that scatters pairs between any two levels $i$ and $j$. The single-particle spectrum is defined as $\\epsilon_i = d \\left( i - \\frac{M - 1}{2} \\right)$ for levels $i = 0, 1, \\dots, M-1$, ensuring no degeneracies.\n\nThe analysis proceeds in three stages: first, constructing the exact solution by diagonalizing the Hamiltonian in the relevant subspace; second, deriving and computing the CCSD approximation; and third, comparing the two to quantify the importance of higher-order correlations.\n\n1.  **Exact Solution via Direct Diagonalization**\n\nThe seniority-zero subspace is the Hilbert space spanned by all states containing $N$ pairs and no unpaired particles. A basis for this space can be constructed by choosing $N$ levels to be occupied by pairs from the $M$ available levels. Each basis state $|\\Psi_k\\rangle$ is uniquely defined by a set of $N$ occupied level indices, $\\text{occ}_k = \\{i_1, i_2, \\dots, i_N\\}$. The dimension of this basis is $\\binom{M}{N}$.\n\nTo find the exact ground-state energy $E_{\\text{exact}}$, we construct the Hamiltonian matrix $\\mathbf{H}$ in this basis and find its lowest eigenvalue. The matrix elements $H_{kl} = \\langle \\Psi_k | H | \\Psi_l \\rangle$ are determined by the rules given in the problem statement, which are consistent with the action of the Hamiltonian $H$:\n\n-   **Diagonal Elements ($k=l$):** The expectation value of $H$ in a basis state $|\\Psi_k\\rangle$ is the sum of the one-body and two-body contributions. The one-body term contributes $2\\epsilon_i$ for each occupied pair level $i$. The two-body pairing term, under the specified model, contributes a constant value of $-GN$ to the diagonal for any seniority-zero configuration.\n    $$\n    H_{kk} = \\left( 2 \\sum_{i \\in \\text{occ}_k} \\epsilon_i \\right) - G N\n    $$\n\n-   **Off-Diagonal Elements ($k \\ne l$):** The pairing interaction $P_i^\\dagger P_j$ annihilates a pair at level $j$ and creates one at level $i$. Therefore, it connects basis states that differ by the move of a single pair. If basis state $|\\Psi_k\\rangle$ has an occupied level $j$ that is unoccupied in $|\\Psi_l\\rangle$, and an unoccupied level $i$ that is occupied in $|\\Psi_l\\rangle$, with all other levels having identical occupancy, then the matrix element is:\n    $$\n    H_{kl} = -G\n    $$\n    If the states $|\\Psi_k\\rangle$ and $|\\Psi_l\\rangle$ differ by more than one-pair hop or are identical, the off-diagonal element is $0$.\n\nOnce the Hermitian matrix $\\mathbf{H}$ is constructed, its eigenvalues are found by numerical diagonalization. The lowest eigenvalue corresponds to the exact ground-state energy, $E_{\\text{exact}}$, of the system within this model space.\n\n2.  **Coupled-Cluster Doubles Approximation**\n\nCoupled-Cluster theory approximates the exact wavefunction $|\\Psi\\rangle$ by applying an exponential cluster operator to a reference state, typically the Hartree-Fock determinant. Here, the reference state $|\\Phi_0\\rangle$ is the closed-shell configuration where the $N$ pairs occupy the $N$ levels with the lowest single-particle energies, i.e., levels $i=0, \\dots, N-1$. The remaining $M-N$ levels are virtual (unoccupied).\n\nThe energy of this reference state is its expectation value:\n$$\nE_{\\text{ref}} = \\langle \\Phi_0 | H | \\Phi_0 \\rangle = \\left( 2 \\sum_{i=0}^{N-1} \\epsilon_i \\right) - G N\n$$\nThe CCSD approximation used here is restricted to double excitations of pairs, described by the cluster operator $T_2 = \\sum_{i \\in \\text{occ}} \\sum_{a \\in \\text{virt}} t_{ia} P_a^\\dagger P_i$, which excites a pair from an occupied level $i$ to a virtual level $a$. The amplitudes $t_{ia}$ are determined by solving the projected Schrödinger equation. We are instructed to use the linearized, second-order perturbation theory (MP2) limit. The amplitude equation is obtained by projecting the similarity-transformed Schrödinger equation $e^{-T} H e^{T} |\\Phi_0\\rangle = E |\\Phi_0\\rangle$ onto a doubly excited state $\\langle \\Phi_{ia} | = \\langle \\Phi_0 | P_i^\\dagger P_a$. Keeping only terms linear in $T_2$ yields:\n$$\n\\langle \\Phi_{ia} | H + [H, T_2] | \\Phi_0 \\rangle = 0\n$$\nWith $H = H_0 + V$, where $H_0$ is the one-body part, and using the fact that $[V, T_2]$ contributes at higher orders, this simplifies to $\\langle \\Phi_{ia} | V | \\Phi_0 \\rangle + \\langle \\Phi_{ia} | [H_0, T_2] | \\Phi_0 \\rangle = 0$. The commutator gives the unperturbed energy difference between the excited state and the reference state. The energy of the reference state is $E_0^{(0)} = 2 \\sum_{j \\in \\text{occ}} \\epsilon_j$, while the energy of $|\\Phi_{ia}\\rangle$ is $E_{ia}^{(0)} = E_0^{(0)} - 2\\epsilon_i + 2\\epsilon_a$. The energy denominator is thus $E_0^{(0)} - E_{ia}^{(0)} = 2(\\epsilon_i - \\epsilon_a)$. The interaction vertex is $\\langle \\Phi_{ia} | V | \\Phi_0 \\rangle = \\langle \\Phi_{ia} | (-G \\sum_{k,l} P_k^\\dagger P_l) | \\Phi_0 \\rangle = -G$. The amplitude equation becomes:\n$$\n(2\\epsilon_i - 2\\epsilon_a)t_{ia} - G = 0 \\implies t_{ia} = \\frac{G}{2(\\epsilon_i - \\epsilon_a)}\n$$\nWith these amplitudes, the leading-order (second-order) correlation energy is given by the standard linked-diagram expression, which matches the problem's specification:\n$$\nE_{\\text{corr}}^{(2)} = \\sum_{i \\in \\text{occ}} \\sum_{a \\in \\text{virt}} \\langle \\Phi_{ia} | V | \\Phi_0 \\rangle t_{ia} = \\sum_{i=0}^{N-1} \\sum_{a=N}^{M-1} (-G) t_{ia} = \\sum_{i=0}^{N-1} \\sum_{a=N}^{M-1} \\frac{-G^2}{2(\\epsilon_i - \\epsilon_a)}\n$$\nThe total energy in this approximation is the sum of the reference energy and this correlation energy:\n$$\nE_{\\text{CCSD,\\,doubles}} = E_{\\text{ref}} + E_{\\text{corr}}^{(2)}\n$$\n\n3.  **Indicator for Triple Excitations**\n\nThe accuracy of the doubles-only approximation is assessed by comparing it to the exact result. The exact correlation energy is $E_{\\text{corr}}^{\\text{exact}} = E_{\\text{exact}} - E_{\\text{ref}}$. The error of the CCSD doubles approximation is $\\Delta_d = E_{\\text{exact}} - E_{\\text{CCSD,\\,doubles}}$. The dimensionless ratio $R$ quantifies what fraction of the correlation energy is missed by the $T_2$-only model:\n$$\nR = \\frac{|\\Delta_d|}{|E_{\\text{corr}}^{\\text{exact}}|}\n$$\nA value of $R$ close to $0$ implies CCSD is highly accurate, while a large value indicates significant missing correlations. Connected triple excitations, which involve simultaneously moving three pairs, are impossible for systems with fewer than three pairs ($N < 3$). The criterion for triples being essential is thus set as $R \\ge 0.3$ and $N \\ge 3$. This condition flags situations where strong correlations require a more sophisticated many-body treatment than CCSD.\n\n4.  **Algorithmic Implementation**\n\nThe algorithm proceeds as follows for each test case $(M, N, d, G)$:\n1.  Compute the single-particle energies $\\epsilon_i$.\n2.  Generate all $\\binom{M}{N}$ basis states (combinations of $N$ occupied levels from $M$).\n3.  Construct the $\\binom{M}{N} \\times \\binom{M}{N}$ Hamiltonian matrix $\\mathbf{H}$ according to the rules for its elements.\n4.  Diagonalize $\\mathbf{H}$ and extract its lowest eigenvalue, $E_{\\text{exact}}$.\n5.  Calculate $E_{\\text{ref}}$ for the reference state occupying levels $0, \\dots, N-1$.\n6.  Calculate the second-order correlation energy $E_{\\text{corr}}^{(2)}$ by summing over all single pair-hole excitations from the reference state.\n7.  Compute $E_{\\text{CCSD,\\,doubles}} = E_{\\text{ref}} + E_{\\text{corr}}^{(2)}$.\n8.  Calculate the ratio $R$ and determine the boolean flag for triples necessity.\n9.  Store and format the results $[E_{\\text{exact}}, E_{\\text{CCSD,\\,doubles}}, R, \\text{flag}]$ as required.\nThis procedure is applied to all test cases to generate the final output.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom itertools import combinations\nimport sys\n\ndef solve():\n    \"\"\"\n    Solves the nuclear pairing model problem for a given set of test cases.\n\n    This function iterates through predefined test cases, each specifying the number\n    of levels (M), number of pairs (N), level spacing (d), and pairing strength (G).\n    For each case, it:\n    1. Sets up the seniority-zero basis and the pairing Hamiltonian.\n    2. Diagonalizes the Hamiltonian to find the exact ground-state energy.\n    3. Calculates the approximate ground-state energy using linearized\n       Coupled-Cluster with Doubles (approximated as MP2).\n    4. Computes an indicator (R) to assess the need for triple excitations.\n    5. Formats and collects the results as specified.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (M, N, d, G)\n        (4, 2, 1.0, 0.2), # Case A\n        (6, 3, 1.0, 0.4), # Case B\n        (6, 3, 0.2, 0.8), # Case C\n        (8, 4, 1.0, 0.3), # Case D\n    ]\n\n    all_results = []\n    for M, N, d, G in test_cases:\n        # 1. Generate seniority-zero basis and single-particle energies\n        spe = d * (np.arange(M) - (M - 1) / 2.0)\n        \n        basis_configs = list(combinations(range(M), N))\n        num_basis_states = len(basis_configs)\n        \n        # Create a mapping from configuration tuple to matrix index for fast lookups\n        config_to_idx = {config: i for i, config in enumerate(basis_configs)}\n\n        # 2. Build the Hamiltonian matrix\n        H_mat = np.zeros((num_basis_states, num_basis_states))\n\n        for i in range(num_basis_states):\n            config_i = basis_configs[i]\n            # Diagonal elements\n            one_body_E = 2.0 * np.sum(spe[list(config_i)])\n            two_body_E_diag = -G * N\n            H_mat[i, i] = one_body_E + two_body_E_diag\n\n            # Off-diagonal elements\n            for j in range(i + 1, num_basis_states):\n                config_j = basis_configs[j]\n                \n                # States are connected if they differ by moving one pair.\n                # The symmetric difference of an 'i->a' hop will contain {i, a}.\n                diff = set(config_i).symmetric_difference(set(config_j))\n                if len(diff) == 2:\n                    H_mat[i, j] = -G\n                    H_mat[j, i] = -G\n\n        # Diagonalize H to obtain exact ground-state energy\n        eigenvalues = np.linalg.eigh(H_mat)[0]\n        E_exact = eigenvalues[0]\n\n        # 3. Compute reference and CCSD (doubles) energy\n        occ_indices_ref = np.arange(N)\n        virt_indices_ref = np.arange(N, M)\n        \n        # Reference energy E_ref\n        E_ref_one_body = 2.0 * np.sum(spe[occ_indices_ref])\n        E_ref = E_ref_one_body - G * N\n\n        # Second-order correlation energy from linearized doubles amplitudes\n        E_corr_2 = 0.0\n        for i in occ_indices_ref:\n            for a in virt_indices_ref:\n                # Linearized amplitude t_ia = -V_ia00 / (E_0 - E_ia)\n                # where V_ia00 = -G and E_0 - E_ia = 2*(epsilon_i - epsilon_a)\n                energy_denom = 2.0 * (spe[i] - spe[a])\n                if np.abs(energy_denom) < 1e-12: # Avoid division by zero\n                    continue\n                t_ia = -G / energy_denom\n                # Contribution to energy: sum_{ia} V_00ia * t_ia = sum_{ia} (-G) * t_ia\n                E_corr_2 += (-G) * t_ia\n        \n        E_ccsd_doubles = E_ref + E_corr_2\n\n        # 4. Compute R and the triples necessity flag\n        E_corr_exact = E_exact - E_ref\n        \n        delta_d = E_exact - E_ccsd_doubles\n        \n        if np.abs(E_corr_exact) < 1e-12:\n            R = 0.0\n        else:\n            R = np.abs(delta_d) / np.abs(E_corr_exact)\n            \n        flag = (R >= 0.3 and N >= 3)\n        \n        # Collect results for this case\n        all_results.append([E_exact, E_ccsd_doubles, R, flag])\n        \n    # Final print statement in the exact required format.\n    # We build the string manually to avoid spaces and control formatting.\n    # Note: str(True) is 'True', str(False) is 'False', as required.\n    case_strings = [\n        f\"[{res[0]:.6f},{res[1]:.6f},{res[2]:.6f},{str(res[3])}]\"\n        for res in all_results\n    ]\n    \n    print(f\"[{','.join(case_strings)}]\")\n\nsolve()\n```", "id": "3554004"}, {"introduction": "Building on the foundational understanding of coupled-cluster approximations, this exercise [@problem_id:3554029] bridges the gap to modern nuclear structure calculations. You will work with a schematic Hamiltonian that incorporates key features of realistic nuclear forces, including a normal-ordered two-body contribution from a three-nucleon (3N) interaction derived from chiral effective field theory. The goal is to implement a simplified CCSD calculation and analyze the critical concept of model space convergence by studying how the results change with respect to the harmonic oscillator basis cutoff, $e_{\\text{max}}$, and the energy cutoff for the 3N interaction, $E_{3\\max}$.", "problem": "Consider a closed-shell reference Slater determinant built from a harmonic oscillator single-particle basis and a normal-ordered Hamiltonian comprising chiral two-nucleon and three-nucleon interactions in the normal-ordered two-body approximation. Work in a simplified seniority-zero subspace where only time-reversed pair excitations are retained, and assume a single fully occupied pair orbital at harmonic oscillator quantum number $e_{i} = 0$ (the $0s$ shell, corresponding to $2n+\\ell = 0$). Use second quantization and the coupled-cluster ansatz with singles and doubles operators to derive the amplitude equations appropriate to this closed-shell, pair-truncated limit. Begin from the following fundamental base:\n- The normal-ordered Hamiltonian with respect to the closed-shell reference $|\\Phi\\rangle$,\n$$\n\\hat{H} = \\hat{H}_{0} + \\hat{V}_{2\\mathrm{N}} + \\hat{W}_{3\\mathrm{N}}^{\\mathrm{NO2B}},\n$$\nwhere $\\hat{H}_{0}$ is the one-body harmonic oscillator term, $\\hat{V}_{2\\mathrm{N}}$ is the two-body interaction, and $\\hat{W}_{3\\mathrm{N}}^{\\mathrm{NO2B}}$ is the normal-ordered two-body part of the chiral three-nucleon force with respect to $|\\Phi\\rangle$.\n- The coupled-cluster ansatz $|\\Psi\\rangle = e^{\\hat{T}}|\\Phi\\rangle$ with $\\hat{T} = \\hat{T}_{1} + \\hat{T}_{2}$ and the similarity-transformed Hamiltonian $\\bar{H} = e^{-\\hat{T}} \\hat{H} e^{\\hat{T}}$.\n- The projected amplitude equations for a closed-shell system, obtained by requiring that the similarity-transformed Hamiltonian has no components outside the reference, namely $\\langle \\Phi | \\bar{H} | \\Phi \\rangle = E$ and $\\langle \\Phi_{\\mu} | \\bar{H} | \\Phi \\rangle = 0$ for all excited determinants $|\\Phi_{\\mu}\\rangle$.\n\nIn the seniority-zero truncation keep only pair excitations generated by $\\hat{P}_{p}^{\\dagger} = \\sum_{m>0} a_{p m}^{\\dagger} a_{p \\bar{m}}^{\\dagger}$ and their Hermitian conjugates, where $p$ labels a harmonic oscillator major shell $e_{p} = 2n+\\ell$, and $m,\\bar{m}$ denote time-reversed magnetic substates. Model the interaction content as follows to focus on the sensitivity to truncations and to keep the problem computationally tractable:\n- Use harmonic oscillator single-particle energies\n$$\n\\varepsilon(e) = \\left(e + \\tfrac{3}{2}\\right)\\hbar\\omega,\n$$\nwith $\\hbar\\omega$ specified below.\n- Use a schematic, channel-diagonal two-body pair-transfer interaction that couples only the occupied pair orbital $i$ to unoccupied pair orbitals $a$,\n$$\n\\hat{V}_{2\\mathrm{N}}^{(\\mathrm{pair})} = - G_{2} \\sum_{a} \\left( \\hat{P}_{a}^{\\dagger} \\hat{P}_{i} + \\hat{P}_{i}^{\\dagger} \\hat{P}_{a} \\right),\n$$\nmodulated by harmonic-oscillator form factors $f(e) = \\exp(- e / e_{s})$ as $G_{2} \\to G_{2} f(e_{i}) f(e_{a})$ for each $a$.\n- Include a normal-ordered two-body contribution from the chiral three-nucleon interaction as a density-dependent shift of the pair-transfer strength, $G_{2} \\to G_{2} + G_{3}\\,\\alpha(E_{3\\max}; e_{i}, e_{a})$, where the truncation parameter $E_{3\\max}$ enforces the harmonic oscillator three-body cutoff selection,\n$$\n\\alpha(E_{3\\max}; e_{i}, e_{a}) =\n\\begin{cases}\n1, & 2 e_{i} + e_{a} \\le E_{3\\max},\\\\\n0, & \\text{otherwise}.\n\\end{cases}\n$$\n\nAssume a single fully occupied pair orbital at $e_{i} = 0$ and let the coupled-cluster cluster operator be restricted to doubles in the seniority-zero space, $\\hat{T} = \\sum_{a} t_{a}\\, \\hat{P}_{a}^{\\dagger} \\hat{P}_{i}$. Under this restriction and using the algebra of pair operators in a space with pair degeneracy equal to $1$ per major shell, the Baker–Campbell–Hausdorff expansion truncates exactly at first order when acting on the reference, because $\\hat{T}^{2}|\\Phi\\rangle = 0$. Derive from first principles the projected amplitude equations $\\langle \\Phi_{i}^{a} | \\bar{H} | \\Phi \\rangle = 0$, where $|\\Phi_{i}^{a}\\rangle = \\hat{P}_{a}^{\\dagger} \\hat{P}_{i} |\\Phi\\rangle$, and show that in this limit the coupled-cluster singles and doubles (CCSD) equations reduce to a set of decoupled linear equations for the pair amplitudes $t_{a}$,\n$$\n0 = V_{i a} + \\Delta_{i a}\\, t_{a},\n$$\nwith\n$$\nV_{i a} = -\\big(G_{2} + G_{3}\\,\\alpha(E_{3\\max}; e_{i}, e_{a})\\big)\\, f(e_{i}) f(e_{a}),\n$$\n$$\n\\Delta_{i a} = 2\\big(\\varepsilon(e_{a}) - \\varepsilon(e_{i})\\big).\n$$\nExplain why the singles amplitudes vanish in this closed-shell, canonical basis and why the doubles equations linearize under the stated truncations. Then obtain the correlation energy in terms of the amplitudes,\n$$\nE_{\\mathrm{corr}} = \\sum_{a} V_{i a}\\, t_{a} = - \\sum_{a} \\frac{V_{i a}^{2}}{\\Delta_{i a}}.\n$$\n\nNumerically implement the above in a program that, for a given harmonic oscillator truncation $e_{\\max}$ and three-body truncation $E_{3\\max}$, includes all unoccupied major shells $e_{a} = 1, 2, \\dots, e_{\\max}$ and computes the CCSD correlation energy in mega-electron-volts. Use the following constants:\n- $\\hbar\\omega = 20\\,\\text{MeV}$,\n- $e_{i} = 0$,\n- $G_{2} = 5.0\\,\\text{MeV}$,\n- $G_{3} = 1.5\\,\\text{MeV}$,\n- $e_{s} = 3.0$.\n\nAll energies must be expressed in $\\text{MeV}$ and reported as floating-point numbers rounded to $6$ decimal places.\n\nTest Suite:\n- Case A (edge case, no virtual space): $e_{\\max} = 0$, $E_{3\\max} = 0$.\n- Case B (small space, full three-body within space): $e_{\\max} = 2$, $E_{3\\max} = 2$.\n- Case C (larger space, limited three-body): $e_{\\max} = 4$, $E_{3\\max} = 2$.\n- Case D (even larger space, moderate three-body): $e_{\\max} = 6$, $E_{3\\max} = 4$.\n- Case E (same space as D, effectively untruncated three-body): $e_{\\max} = 6$, $E_{3\\max} = 100$.\n\nYour task is to write a complete, runnable program that computes $E_{\\mathrm{corr}}$ for each case and outputs a single line containing the results as a comma-separated list enclosed in square brackets, for example, [$x_{A},x_{B},x_{C},x_{D},x_{E}$], where each $x_{X}$ is the correlation energy for the corresponding case as a floating-point number in $\\text{MeV}$ rounded to $6$ decimal places. No other text should be printed.", "solution": "The problem statement has been validated and is deemed sound. It is scientifically grounded in the principles of quantum many-body theory, specifically coupled-cluster theory applied to a schematic model of a closed-shell nucleus. The problem is well-posed, self-contained, and all terms, constants, and objectives are defined unambiguously. The simplifications introduced, such as the seniority-zero truncation and the specific form of the interaction, are recognized as standard techniques in theoretical physics for isolating specific physical effects and ensuring tractability. Therefore, a complete solution will be provided.\n\nThe objective is to derive the coupled-cluster singles and doubles (CCSD) amplitude equations and correlation energy for a highly simplified seniority-zero model of a closed-shell nucleus, and then to implement this model numerically.\n\n**1. Derivation of the Amplitude Equations**\n\nThe coupled-cluster (CC) ground state energy, $E$, and amplitudes are found by solving the projected Schrödinger equation:\n$$\n\\langle \\Phi | \\bar{H} | \\Phi \\rangle = E\n$$\n$$\n\\langle \\Phi_{\\mu} | \\bar{H} | \\Phi \\rangle = 0\n$$\nwhere $|\\Phi\\rangle$ is the reference Slater determinant, $|\\Phi_{\\mu}\\rangle$ are excited determinants, and $\\bar{H} = e^{-\\hat{T}} \\hat{H} e^{\\hat{T}}$ is the similarity-transformed Hamiltonian. The cluster operator $\\hat{T}$ is given by $\\hat{T} = \\hat{T}_{1} + \\hat{T}_{2} + \\dots$.\n\nIn this problem, the cluster operator is restricted to pair-doubles excitations within the seniority-zero subspace. With a single occupied pair orbital, $i$, corresponding to the harmonic oscillator shell $e_i=0$, the cluster operator is:\n$$\n\\hat{T} = \\hat{T}_{2} = \\sum_{a} t_{a}\\, \\hat{P}_{a}^{\\dagger} \\hat{P}_{i}\n$$\nHere, $t_a$ are the unknown amplitudes for exciting a pair from the occupied shell $i$ to an unoccupied shell $a$. The operator $\\hat{P}_{a}^{\\dagger}$ creates a pair in shell $a$, and $\\hat{P}_{i}$ annihilates a pair in shell $i$. Since the reference state $|\\Phi\\rangle$ contains only one pair in shell $i$, any application of $\\hat{P}_{i}$ twice, such as in $\\hat{T}^2$, will yield zero when acting on $|\\Phi\\rangle$. Specifically, $\\hat{T}^2 |\\Phi\\rangle = (\\sum_b t_b \\hat{P}_b^\\dagger \\hat{P}_i) (\\sum_a t_a \\hat{P}_a^\\dagger \\hat{P}_i) |\\Phi\\rangle = 0$ because $\\hat{P}_i |\\Phi\\rangle$ produces the vacuum state, which is then annihilated by the second $\\hat{P}_i$.\n\nThe amplitude equations for the doubles amplitudes $t_a$ are obtained by projecting onto the corresponding two-particle, two-hole (2p2h) states, $|\\Phi_{i}^{a}\\rangle = \\hat{P}_{a}^{\\dagger} \\hat{P}_{i} |\\Phi\\rangle$:\n$$\n\\langle \\Phi_{i}^{a} | \\bar{H} | \\Phi \\rangle = 0\n$$\nWe expand $\\bar{H}$ using the Baker-Campbell-Hausdorff (BCH) formula:\n$$\n\\bar{H} = \\hat{H} + [\\hat{H}, \\hat{T}] + \\frac{1}{2!} [[\\hat{H}, \\hat{T}], \\hat{T}] + \\dots\n$$\nThe projected equation becomes:\n$$\n\\langle \\Phi_{i}^{a} | \\hat{H} + [\\hat{H}, \\hat{T}] + \\frac{1}{2!} [[\\hat{H}, \\hat{T}], \\hat{T}] + \\dots | \\Phi \\rangle = 0\n$$\nWe analyze the key terms. The Hamiltonian is $\\hat{H} = \\hat{H}_0 + \\hat{V}$, where $\\hat{V} = \\hat{V}_{2\\mathrm{N}}^{(\\mathrm{pair})} + \\hat{W}_{3\\mathrm{N}}^{\\mathrm{NO2B}}$.\n\n*   **Term 1: $\\langle \\Phi_{i}^{a} | \\hat{H} | \\Phi \\rangle$**\n    The one-body term $\\hat{H}_0$ is diagonal in the harmonic oscillator basis, so $\\langle \\Phi_{i}^{a} | \\hat{H}_0 | \\Phi \\rangle = 0$ as it connects states of different particle-hole character. The two-body term gives the interaction matrix element between the reference and the 2p2h state. By definition in the problem, this is $V_{ia}$:\n    $$\n    \\langle \\Phi_{i}^{a} | \\hat{V} | \\Phi \\rangle = V_{i a} = -\\big(G_{2} + G_{3}\\,\\alpha(E_{3\\max}; e_{i}, e_{a})\\big)\\, f(e_{i}) f(e_{a})\n    $$\n\n*   **Term 2: $\\langle \\Phi_{i}^{a} | [\\hat{H}, \\hat{T}] | \\Phi \\rangle$**\n    We split the commutator: $[\\hat{H}, \\hat{T}] = [\\hat{H}_0, \\hat{T}] + [\\hat{V}, \\hat{T}]$.\n    *   The commutator with $\\hat{H}_0$:\n        $$\n        [\\hat{H}_0, \\hat{T}] = \\sum_b t_b [\\hat{H}_0, \\hat{P}_b^\\dagger \\hat{P}_i] = \\sum_b t_b \\big(2\\varepsilon(e_b) - 2\\varepsilon(e_i)\\big) \\hat{P}_b^\\dagger \\hat{P}_i = \\sum_b t_b \\Delta_{ib} \\hat{P}_b^\\dagger \\hat{P}_i\n        $$\n        Projecting this onto $\\langle \\Phi_{i}^{a} |$ and applying to $|\\Phi\\rangle$ yields $\\sum_b t_b \\Delta_{ib} \\langle \\Phi_i^a | \\Phi_i^b \\rangle$. Assuming orthogonality of the basis states, $\\langle \\Phi_i^a | \\Phi_i^b \\rangle \\propto \\delta_{ab}$, this term becomes $\\Delta_{ia} t_a$.\n    *   The commutator with $\\hat{V}$: The structure of the interaction $\\hat{V}$ is such that it only connects the reference state $|\\Phi\\rangle$ to 2p2h states $|\\Phi_i^a\\rangle$ and vice-versa. It does not contain matrix elements that connect two different 2p2h states, or a 2p2h state to a 4p4h state. The term $\\langle \\Phi_{i}^{a} | [\\hat{V}, \\hat{T}] | \\Phi \\rangle$ would require such connections, which are absent in this model. For instance, a term like $\\langle \\Phi_{i}^{a} | \\hat{V} \\hat{T} | \\Phi \\rangle = \\sum_b t_b \\langle \\Phi_{i}^{a} | \\hat{V} | \\Phi_{i}^{b} \\rangle$ requires a matrix element of $\\hat{V}$ between two 2p2h states, which is zero for the given interaction. Therefore, $\\langle \\Phi_{i}^{a} | [\\hat{V}, \\hat{T}] | \\Phi \\rangle = 0$.\n\n*   **Higher-Order Terms**\n    All higher-order commutators in the BCH expansion, such as $[[\\hat{H}, \\hat{T}], \\hat{T}]$, involve more complex operator structures. When projected, they depend on interaction vertices that are absent from the schematic interaction $\\hat{V}$. For example, the term $\\frac{1}{2}\\langle \\Phi_{i}^{a} | [[\\hat{H}_0, \\hat{T}], \\hat{T}] | \\Phi \\rangle$ vanishes because the inner commutator $[\\hat{H}_0, \\hat{T}]$ is proportional to $\\hat{T}$, and $[\\hat{T}, \\hat{T}]=0$. All other terms that are non-linear in the amplitudes $t_a$ are zero due to the specific structure of $\\hat{V}$.\n\nCombining the non-vanishing terms, we obtain a set of decoupled linear equations:\n$$\nV_{ia} + \\Delta_{ia} t_a = 0\n$$\n\n**2. Justification of Simplifications**\n\n*   **Vanishing Singles Amplitudes ($\\hat{T}_1 = 0$):** The singles amplitude equation is driven by the matrix element $\\langle \\Phi_i^a | \\hat{H} | \\Phi \\rangle$, where $|\\Phi_i^a\\rangle$ is a 1p1h state. For a closed-shell reference state built from a canonical basis (like the Hartree-Fock basis), this matrix element is zero by the Brillouin theorem. In our case, the harmonic oscillator basis is used, and $\\langle \\Phi_i^a | \\hat{H}_0 | \\Phi \\rangle=0$ because these are eigenstates. The interaction $\\hat{V}$ is a pure pair-transfer operator and cannot connect the reference to a 1p1h state, so $\\langle \\Phi_i^a | \\hat{V} | \\Phi \\rangle=0$. Since the source term for the singles equation is zero, and all other terms are proportional to the singles amplitudes themselves, the solution is $\\hat{T}_1 = 0$.\n\n*   **Linearization of Doubles Equations:** As shown in the derivation, the linearization is a direct consequence of the schematic interaction $\\hat{V}$. Standard CCSD equations contain quadratic and cubic terms in the amplitudes, arising from diagrams where the interaction vertex connects particle-particle, hole-hole, or particle-hole lines. The given interaction $\\hat{V}$ only has vertices that connect two hole lines to two particle lines. This eliminates all diagrams responsible for non-linear terms and for coupling between different amplitudes $t_a$, reducing the CCSD equations to the simple linear form derived, which is equivalent to second-order Møller-Plesset perturbation theory (MP2).\n\n**3. Derivation of the Correlation Energy**\n\nThe correlation energy $E_{\\mathrm{corr}}$ is the difference between the CC energy $E = \\langle \\Phi | \\bar{H} | \\Phi \\rangle$ and the reference energy $E_{\\mathrm{ref}} = \\langle \\Phi | \\hat{H} | \\Phi \\rangle$.\n$$\nE_{\\mathrm{corr}} = \\langle \\Phi | e^{-\\hat{T}} \\hat{H} e^{\\hat{T}} | \\Phi \\rangle - \\langle \\Phi | \\hat{H} | \\Phi \\rangle\n$$\nBecause $\\langle \\Phi | \\hat{T} = 0$, we can write $\\langle \\Phi | e^{-\\hat{T}} = \\langle \\Phi |$. Also, since $\\hat{T}=\\hat{T}_2$ and $\\hat{T}_1=0$,\n$$\nE_{\\mathrm{corr}} = \\langle \\Phi | \\hat{H} e^{\\hat{T}_2} | \\Phi \\rangle - \\langle \\Phi | \\hat{H} | \\Phi \\rangle = \\langle \\Phi | \\hat{H} (1 + \\hat{T}_2) | \\Phi \\rangle - \\langle \\Phi | \\hat{H} | \\Phi \\rangle\n= \\langle \\Phi | \\hat{H} \\hat{T}_2 | \\Phi \\rangle\n$$\nSplitting $\\hat{H} = \\hat{H}_0 + \\hat{V}$:\n$$\nE_{\\mathrm{corr}} = \\langle \\Phi | \\hat{H}_0 \\hat{T}_2 | \\Phi \\rangle + \\langle \\Phi | \\hat{V} \\hat{T}_2 | \\Phi \\rangle\n$$\nThe first term is zero because $\\hat{T}_2|\\Phi\\rangle$ is a linear combination of 2p2h states, which are orthogonal to the reference $|\\Phi\\rangle$ upon which $\\hat{H}_0$ acts as a scalar. The second term gives:\n$$\nE_{\\mathrm{corr}} = \\langle \\Phi | \\hat{V} \\sum_{a} t_{a} \\hat{P}_{a}^{\\dagger} \\hat{P}_{i} | \\Phi \\rangle = \\sum_{a} t_{a} \\langle \\Phi | \\hat{V} | \\Phi_{i}^{a} \\rangle\n$$\nThe matrix element is $\\langle \\Phi_i^a | \\hat{V} | \\Phi \\rangle^* = V_{ia}^*$. Since $V_{ia}$ is real, this is just $V_{ia}$.\n$$\nE_{\\mathrm{corr}} = \\sum_{a} V_{ia} t_{a}\n$$\nSubstituting the solution for the amplitude, $t_a = -V_{ia} / \\Delta_{ia}$:\n$$\nE_{\\mathrm{corr}} = \\sum_{a} V_{ia} \\left(-\\frac{V_{ia}}{\\Delta_{ia}}\\right) = - \\sum_{a} \\frac{V_{ia}^2}{\\Delta_{ia}}\n$$\n\n**4. Numerical Implementation**\n\nThe numerical task is to calculate $E_{\\mathrm{corr}}$ by summing the contributions from all unoccupied pair orbitals $a$ within a given model space defined by $e_{\\max}$. The sum runs over shells with principal quantum number $e_a = 1, 2, \\dots, e_{\\max}$. For each $e_a$, we compute $V_{ia}$ and $\\Delta_{ia}$ using the provided formulas and constants, calculate the energy contribution, and add it to the total sum.\nThe constants are $\\hbar\\omega = 20\\,\\text{MeV}$, $e_{i} = 0$, $G_{2} = 5.0\\,\\text{MeV}$, $G_{3} = 1.5\\,\\text{MeV}$, and $e_{s} = 3.0$. The formulas are:\n*   $\\varepsilon(e) = (e + 1.5)\\hbar\\omega$\n*   $\\alpha(E_{3\\max}; e_{i}, e_{a}) = 1$ if $2 e_{i} + e_{a} \\le E_{3\\max}$, and $0$ otherwise. With $e_i=0$, this simplifies to $e_a \\le E_{3\\max}$.\n*   $f(e) = \\exp(-e / e_s)$\n*   $V_{i a} = -\\big(G_{2} + G_{3}\\,\\alpha(E_{3\\max}; 0, e_{a})\\big)\\, f(0) f(e_{a})$\n*   $\\Delta_{i a} = 2(\\varepsilon(e_{a}) - \\varepsilon(0))$\n\nThe code will iterate through the test cases, apply these formulas in a loop over $e_a$, and report the final summed correlation energy for each case, rounded to $6$ decimal places.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the CCSD (MP2-equivalent) correlation energy for a schematic\n    nuclear model based on a set of test cases.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (e_max, E_3max)\n        (0, 0),    # Case A\n        (2, 2),    # Case B\n        (4, 2),    # Case C\n        (6, 4),    # Case D\n        (6, 100),  # Case E\n    ]\n\n    # Model constants\n    hbar_omega = 20.0  # MeV\n    e_i = 0\n    G2 = 5.0         # MeV\n    G3 = 1.5         # MeV\n    es = 3.0\n\n    # ---------- Helper Functions based on the derived formulas ----------\n    \n    def get_epsilon(e):\n        \"\"\"Calculates harmonic oscillator single-particle energy.\"\"\"\n        return (e + 1.5) * hbar_omega\n\n    def get_form_factor(e):\n        \"\"\"Calculates the harmonic-oscillator form factor.\"\"\"\n        return np.exp(-e / es)\n\n    def get_alpha(E3max, ei, ea):\n        \"\"\"Calculates the three-body truncation factor.\"\"\"\n        if (2 * ei + ea) <= E3max:\n            return 1.0\n        return 0.0\n\n    results = []\n    # --------- Main loop over test cases -----------\n    for e_max, E_3max in test_cases:\n        # Handle the edge case with no virtual space\n        if e_max == 0:\n            results.append(0.0)\n            continue\n\n        correlation_energy = 0.0\n        \n        # Properties of the occupied shell 'i'\n        eps_i = get_epsilon(e_i)\n        f_i = get_form_factor(e_i) # This is always 1.0 since e_i=0\n\n        # Sum over all unoccupied shells 'a' up to e_max\n        for e_a in range(1, e_max + 1):\n            # Calculate the two-body interaction matrix element V_ia\n            alpha = get_alpha(E_3max, e_i, e_a)\n            f_a = get_form_factor(e_a)\n            V_ia = -(G2 + G3 * alpha) * f_i * f_a\n\n            # Calculate the energy denominator Delta_ia\n            eps_a = get_epsilon(e_a)\n            Delta_ia = 2 * (eps_a - eps_i)\n\n            # Add the contribution to the correlation energy\n            # E_corr = - sum(V_ia^2 / Delta_ia)\n            if Delta_ia != 0:\n                correlation_energy -= (V_ia**2) / Delta_ia\n\n        results.append(correlation_energy)\n\n    # Format the results to 6 decimal places and print in the specified format.\n    formatted_results = [\"{:.6f}\".format(r) for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\n# Run the solver.\nsolve()\n```", "id": "3554029"}, {"introduction": "The final step in bridging theory and practice involves confronting the finite resources of even the most powerful supercomputers. Before launching a complex simulation, a computational scientist must estimate its memory and runtime demands to assess feasibility. This practice [@problem_id:3554058] focuses on this essential skill by having you perform a 'back-of-the-envelope' analysis of the computational scaling of a CCSD calculation, from the memory required to store the doubles amplitudes $t_{ij}^{ab}$ to the floating-point operations needed for the dominant tensor contractions. This exercise will highlight the computational bottlenecks of the method and motivate the advanced strategies, such as symmetry exploitation and on-the-fly calculation, that are essential for state-of-the-art nuclear theory.", "problem": "Consider a closed-shell nucleus treated with Coupled-Cluster Singles and Doubles (CCSD). The reference state is a Slater determinant with $n_h$ occupied single-particle orbitals (holes) and $n_p$ unoccupied single-particle orbitals (particles) in an $m$-scheme basis. The cluster operator is $T = T_1 + T_2$, with singles amplitudes $t_i^{a}$ and doubles amplitudes $t_{ij}^{ab}$, where $i,j \\in \\{1,\\dots,n_h\\}$ and $a,b \\in \\{1,\\dots,n_p\\}$. Assume double-precision storage uses $8$ bytes per floating-point number.\n\nYou are given $n_h = 40$ and $n_p = 400$. A computing node has a memory budget $M_{\\text{max}} = 48\\,\\mathrm{GB}$ and a sustained compute rate $R = 1.0\\times 10^{12}\\,\\mathrm{FLOP/s}$ (floating-point operations per second), with a wall-time budget per CCSD iteration of $\\tau_{\\text{max}} = 120\\,\\mathrm{s}$.\n\nStarting from fundamental definitions, estimate:\n- The memory required to store $t_i^{a}$ and $t_{ij}^{ab}$.\n- The memory required to store representative two-body matrix element blocks in the particle-hole normal-ordered form, such as $v_{ij}^{ab}$ and $v_{ab}^{cd}$, in an $m$-scheme without exploiting angular-momentum coupling.\n- The leading-order floating-point operation counts for representative CCSD doubles updates, such as\n$$t_{ij}^{ab} \\leftarrow \\sum_{cd} v_{ab}^{cd}\\, t_{ij}^{cd} \\quad\\text{and}\\quad t_{ij}^{ab} \\leftarrow \\sum_{kl} v_{kl}^{ij}\\, t_{kl}^{ab},$$\nby counting tensor contraction index ranges and multiply-add operations.\n\nThen, decide which strategy is viable under the given resource constraints, and justify whether techniques such as blocking, spin-isospin factorization, and angular-momentum coupling in a total angular-momentum ($J$-scheme) are necessary. Choose the option that most accurately states the memory and floating-point operation estimates and proposes a scientifically sound strategy to fit within the resource constraints.\n\nOptions:\n- A. Store all four-index two-body matrix elements $v_{pq}^{rs}$ in the $m$-scheme and keep $t_1$ and $t_2$ in memory. The memory required is approximately $n_p^4 \\times 8$ bytes for $v_{ab}^{cd}$ alone, i.e., about $204.8\\,\\mathrm{GB}$, plus approximately $2.05\\,\\mathrm{GB}$ for $t_{ij}^{ab}$ and negligible for $t_i^a$. The leading doubles update $\\sum_{cd} v_{ab}^{cd} t_{ij}^{cd}$ costs $\\mathcal{O}(n_h^2 n_p^4)$, here about $8.19\\times 10^{13}$ FLOP per iteration. This fits both memory and time budgets without needing additional strategies.\n- B. Store only $t_1$, $t_2$, and particle-hole blocks such as $v_{ij}^{ab}$, while streaming or factorizing pure particle-particle blocks (e.g., $v_{ab}^{cd}$) on-the-fly. The memory for $t_{ij}^{ab}$ is $n_h^2 n_p^2 \\times 8 \\approx 2.05\\,\\mathrm{GB}$, and for $v_{ij}^{ab}$ is also $n_h^2 n_p^2 \\times 8 \\approx 2.05\\,\\mathrm{GB}$; $t_i^a$ is $n_h n_p \\times 8 \\approx 0.13\\,\\mathrm{MB}$. The leading doubles updates scale as $\\mathcal{O}(n_h^2 n_p^4)$, here about $8.19\\times 10^{13}$ FLOP, and $\\mathcal{O}(n_h^4 n_p^2)$, here about $8.19\\times 10^{11}$ FLOP, per iteration. Under the given $R$ and $\\tau_{\\max}$, this is viable, especially with blocking over $(c,d)$, spin-isospin factorization into proton-proton, neutron-neutron, and proton-neutron channels, and optional $J$-scheme angular-momentum coupling to further reduce memory and communication.\n- C. The dominant computational cost is $\\mathcal{O}(n_h^4 n_p^2)$ from $\\sum_{kl} v_{kl}^{ij} t_{kl}^{ab}$, which here is about $8.19\\times 10^{12}$ FLOP per iteration, and the $\\mathcal{O}(n_h^2 n_p^4)$ term is subleading. Storing $t_2$ and $v_{ij}^{ab}$ requires roughly $4.10\\,\\mathrm{GB}$, and storing $v_{ab}^{cd}$ is unnecessary and negligible for performance. Blocking is optional; spin-isospin factorization and $J$-scheme coupling are not needed under the given constraints.\n- D. Angular-momentum coupling to a total angular-momentum ($J$-scheme) necessarily increases memory because channel fragmentation creates many small blocks. Therefore, one should store all $v_{ab}^{cd}$ in the $m$-scheme, which is about $204.8\\,\\mathrm{GB}$, while $t_2$ is about $2.05\\,\\mathrm{GB}$; the overall approach remains within the $48\\,\\mathrm{GB}$ memory budget due to paging and is preferable to blocking or factorization.\n\nSelect the correct option.", "solution": "The problem asks for an estimation of memory and computational requirements for a Coupled-Cluster Singles and Doubles (CCSD) calculation for a closed-shell nucleus and an evaluation of a viable computational strategy given specific hardware constraints.\n\n### Step 1: Problem Validation\n\nThe problem provides a set of well-defined parameters and operational constraints for a standard computational physics problem.\n**Givens:**\n- Method: Coupled-Cluster Singles and Doubles (CCSD).\n- Basis: $m$-scheme without explicit use of angular-momentum coupling for initial estimation.\n- Hole states: $n_h = 40$.\n- Particle states: $n_p = 400$.\n- Storage: $8$ bytes per double-precision number.\n- Tensors: $t_i^{a}$ (singles amplitudes), $t_{ij}^{ab}$ (doubles amplitudes), $v_{ij}^{ab}$ and $v_{ab}^{cd}$ (two-body matrix elements).\n- Resource constraints:\n  - Max memory: $M_{\\max} = 48\\,\\mathrm{GB} = 48 \\times 10^9$ bytes.\n  - Compute rate: $R = 1.0 \\times 10^{12}\\,\\mathrm{FLOP/s}$.\n  - Max time per iteration: $\\tau_{\\max} = 120\\,\\mathrm{s}$.\n- Representative doubles update terms:\n  1. $\\sum_{cd} v_{ab}^{cd}\\, t_{ij}^{cd}$\n  2. $\\sum_{kl} v_{kl}^{ij}\\, t_{kl}^{ab}$\n\n**Validation:**\nThe problem is scientifically grounded in established principles of many-body computational nuclear physics. The parameters are specific and realistic, forming a well-posed problem. The language is objective and technical. No flaws according to the validation checklist are detected. The problem is valid.\n\n### Step 2: Derivations and Estimations\n\nWe will now perform the estimations asked for in the problem statement. For scaling estimates, we consider the full tensor dimensions, as is common practice and as implied by the structure of the options. We note that the two-body vertex $v$ and the doubles amplitudes $t_2$ possess symmetries ($v_{pq}^{rs} = -v_{qp}^{rs} = -v_{pq}^{sr}$, $t_{ij}^{ab} = -t_{ji}^{ab} = -t_{ij}^{ba}$), which would reduce storage by a constant factor (e.g., approximately $1/4$ for $t_{ij}^{ab}$ and $v_{ij}^{ab}$, and $1/8$ for $v_{ab}^{cd}$). However, for order-of-magnitude analysis and comparison with the options, we use the full tensor sizes.\n\n**Memory Requirements:**\n\n1.  **Singles amplitudes ($t_1$): $t_i^a$**\n    The number of elements is $n_h \\times n_p$.\n    Memory for $t_1 = n_h \\times n_p \\times 8\\,\\text{bytes} = 40 \\times 400 \\times 8 = 16,000 \\times 8 = 128,000\\,\\text{bytes} = 0.128\\,\\mathrm{MB}$. This is negligible.\n\n2.  **Doubles amplitudes ($t_2$): $t_{ij}^{ab}$**\n    The number of elements is $n_h \\times n_h \\times n_p \\times n_p = n_h^2 n_p^2$.\n    Memory for $t_2 = n_h^2 \\times n_p^2 \\times 8\\,\\text{bytes} = 40^2 \\times 400^2 \\times 8 = 1600 \\times 160000 \\times 8 = 2.56 \\times 10^8 \\times 8 = 2.048 \\times 10^9\\,\\text{bytes}$.\n    Since $1\\,\\mathrm{GB} = 10^9\\,\\text{bytes}$, this is $2.048\\,\\mathrm{GB}$.\n\n3.  **Two-body matrix elements (hole-hole-particle-particle): $v_{ij}^{ab}$**\n    This tensor has the same dimensions as $t_2$.\n    Memory for $v_{ij}^{ab} = n_h^2 \\times n_p^2 \\times 8\\,\\text{bytes} = 2.048\\,\\mathrm{GB}$.\n\n4.  **Two-body matrix elements (particle-particle-particle-particle): $v_{ab}^{cd}$**\n    The number of elements is $n_p \\times n_p \\times n_p \\times n_p = n_p^4$.\n    Memory for $v_{ab}^{cd} = n_p^4 \\times 8\\,\\text{bytes} = 400^4 \\times 8 = (2.56 \\times 10^{10}) \\times 8 = 2.048 \\times 10^{11}\\,\\text{bytes} = 204.8\\,\\mathrm{GB}$.\n\n**Floating-Point Operation (FLOP) Counts:**\n\nA multiply-add operation is counted as $2$ FLOPs (one multiplication, one addition).\n\n1.  **Term 1: $t_{ij}^{ab} \\leftarrow \\sum_{cd} v_{ab}^{cd}\\, t_{ij}^{cd}$**\n    This operation must be performed for each element of the $t_{ij}^{ab}$ tensor. The sum runs over indices $c$ and $d$, each ranging over $n_p$ values.\n    FLOP count = (number of $i,j,a,b$) $\\times$ (number of $c,d$) $\\times$ ($2$ FLOPs per multiply-add)\n    FLOPs $\\approx (n_h^2 n_p^2) \\times (n_p^2) \\times 2 = 2\\, n_h^2 n_p^4$.\n    FLOPs $\\approx 2 \\times 40^2 \\times 400^4 = 2 \\times 1600 \\times 2.56 \\times 10^{10} = 8.192 \\times 10^{13}$ FLOPs.\n    This is the computationally most expensive standard term in CCSD, scaling as $\\mathcal{O}(n_h^2 n_p^4)$.\n\n2.  **Term 2: $t_{ij}^{ab} \\leftarrow \\sum_{kl} v_{kl}^{ij}\\, t_{kl}^{ab}$**\n    This operation also runs over all elements of $t_{ij}^{ab}$. The sum is over indices $k$ and $l$, each ranging over $n_h$ values.\n    FLOP count = (number of $i,j,a,b$) $\\times$ (number of $k,l$) $\\times$ ($2$ FLOPs per multiply-add)\n    FLOPs $\\approx (n_h^2 n_p^2) \\times (n_h^2) \\times 2 = 2\\, n_h^4 n_p^2$.\n    FLOPs $\\approx 2 \\times 40^4 \\times 400^2 = 2 \\times (2.56 \\times 10^6) \\times (1.6 \\times 10^5) = 8.192 \\times 10^{11}$ FLOPs.\n    This term scales as $\\mathcal{O}(n_h^4 n_p^2)$.\n\n**Resource Feasibility Analysis:**\n\n-   **Memory:** The node has $M_{\\max} = 48\\,\\mathrm{GB}$. Storing the $v_{ab}^{cd}$ tensor requires $204.8\\,\\mathrm{GB}$, which is impossible. Therefore, any viable strategy cannot store this tensor in memory. It must be computed on-the-fly, streamed from disk, or constructed from a factorized form (e.g., Cholesky decomposition), where only small chunks are held in memory at any time. Storing $t_1$, $t_2$, and other smaller tensors like $v_{ij}^{ab}$ is feasible: $0.000128\\,\\mathrm{GB} + 2.048\\,\\mathrm{GB} + 2.048\\,\\mathrm{GB} \\approx 4.1\\,\\mathrm{GB}$, which is well within the $48\\,\\mathrm{GB}$ budget.\n\n-   **Compute Time:** The maximum number of FLOPs allowed per iteration is $R \\times \\tau_{\\max} = (1.0 \\times 10^{12}\\,\\mathrm{FLOP/s}) \\times 120\\,\\mathrm{s} = 1.2 \\times 10^{14}$ FLOPs.\n    -   The leading term requires $8.192 \\times 10^{13}$ FLOPs, taking $81.92\\,\\mathrm{s}$ on the given hardware.\n    -   The second term requires $8.192 \\times 10^{11}$ FLOPs, taking $0.82\\,\\mathrm{s}$.\n    The total time for an iteration is the sum of times for all terms. The leading $\\mathcal{O}(n_h^2 n_p^4)$ term dominates the cost. While it consumes a large portion of the time budget ($81.92\\,\\mathrm{s}$ out of $120\\,\\mathrm{s}$), the calculation is technically feasible. However, this leaves little margin for other computational terms, communication overhead, and I/O. Therefore, techniques to reduce the computational prefactor are highly desirable for stable and efficient performance. Such techniques include blocking/tiling for data locality, and exploiting physical symmetries (spin-isospin factorization, angular momentum coupling) to reduce the effective dimensions of the tensors.\n\n### Step 3: Option-by-Option Analysis\n\n**Option A:** This option correctly estimates the memory for $v_{ab}^{cd}$ as $204.8\\,\\mathrm{GB}$ and the flops for the $\\mathcal{O}(n_h^2 n_p^4)$ term as $8.19 \\times 10^{13}$. However, it incorrectly claims that this \"fits both memory and time budgets\". The memory requirement of $204.8\\,\\mathrm{GB}$ vastly exceeds the $48\\,\\mathrm{GB}$ available on the node.\n- **Verdict:** **Incorrect**.\n\n**Option B:** This option proposes a viable strategy: store the amplitudes and smaller matrix element blocks ($v_{ij}^{ab}$) in memory, while computing the largest block ($v_{ab}^{cd}$) on-the-fly or streaming it. It correctly estimates memory for $t_1$ ($\\approx 0.13\\,\\mathrm{MB}$), $t_2$ ($\\approx 2.05\\,\\mathrm{GB}$), and $v_{ij}^{ab}$ ($\\approx 2.05\\,\\mathrm{GB}$). It correctly estimates the FLOP counts for the $\\mathcal{O}(n_h^2 n_p^4)$ term ($\\approx 8.19 \\times 10^{13}$) and the $\\mathcal{O}(n_h^4 n_p^2)$ term ($\\approx 8.19 \\times 10^{11}$). It correctly concludes this is viable under the given constraints and correctly identifies blocking, spin-isospin factorization, and $J$-scheme coupling as standard and beneficial advanced strategies.\n- **Verdict:** **Correct**.\n\n**Option C:** This option incorrectly states that the $\\mathcal{O}(n_h^4 n_p^2)$ term is the dominant computational cost. As calculated, the $\\mathcal{O}(n_h^2 n_p^4)$ term is larger by two orders of magnitude ($10^{13}$ vs. $10^{11}$). The numerical value given for the $\\mathcal{O}(n_h^4 n_p^2)$ cost is also wrong ($8.19 \\times 10^{12}$ instead of the correct $8.19 \\times 10^{11}$). While its memory estimate for $t_2$ and $v_{ij}^{ab}$ is correct ($\\approx 4.10\\,\\mathrm{GB}$), its main premise about computational cost is fundamentally flawed.\n- **Verdict:** **Incorrect**.\n\n**Option D:** This option makes the fundamentally incorrect claim that angular-momentum coupling ($J$-scheme) *increases* memory. The purpose and result of using such symmetries is a dramatic *reduction* in memory and computational cost by block-diagonalizing the tensors. The subsequent recommendation to store the $204.8\\,\\mathrm{GB}$ tensor $v_{ab}^{cd}$ by relying on memory paging is computationally unsound. Heavy reliance on virtual memory for large, non-local data access patterns (as found in tensor contractions) leads to performance collapse (thrashing) and would grossly violate the time budget.\n- **Verdict:** **Incorrect**.", "answer": "$$\\boxed{B}$$", "id": "3554058"}]}