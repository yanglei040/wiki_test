{"hands_on_practices": [{"introduction": "The foundation of any No-Core Shell Model (NCSM) calculation is the construction of a finite many-body basis from an infinite set of single-particle states. This exercise explores the process of building this basis for a simple two-nucleon system by applying combinatorial principles to count the number of allowed states in both the computationally convenient M-scheme and the physically intuitive J-coupled scheme. This practice provides a concrete understanding of the structure and scale of the NCSM model space and the relationship between these fundamental coupling schemes. [@problem_id:3604989]", "problem": "In the No-Core Shell Model (NCSM), the many-body basis is constructed from single-nucleon states of the three-dimensional Harmonic Oscillator (HO). The HO single-particle states are labeled by the major-shell quantum number $N$, orbital angular momentum $l$, its projection $m_{l}$, intrinsic spin $s=\\frac{1}{2}$ with projection $m_{s}=\\pm\\frac{1}{2}$, and, when using a total-angular-momentum-coupled basis, the single-particle total angular momentum $j$ arising from coupling $l$ and $s$. The $N$-scheme truncation used in the NCSM restricts the sum of single-particle HO quanta above the lowest configuration via $N_{\\text{tot}} \\leq N_{\\max}$, and parity is given by $(-1)^{N_{\\text{tot}}}$. In the proton-neutron formalism, protons and neutrons are treated as distinguishable species, and antisymmetry is enforced within each species.\n\nConsider an $A=2$ system consisting of $Z=1$ proton and $N=1$ neutron, in the HO basis truncated by $N_{\\max}=2$, including all center-of-mass excitations in the truncated space. Focus on the positive-parity sector, i.e., configurations satisfying $N_{p}+N_{n}$ even and $N_{p}+N_{n} \\leq 2$, and fix the total angular momentum projection to $M = 0$ and the isospin projection implicitly to $M_{T}=0$ by choosing exactly one proton and one neutron.\n\nThe M-scheme basis is defined by the set of uncoupled Slater determinants of single-particle states labeled by $(N, l, m_{l}, m_{s})$ for the proton and neutron, with the constraint that the sum of projections $m_{l,p} + m_{s,p} + m_{l,n} + m_{s,n} = M$. The $J$-coupled basis is defined by states in which the single-particle $l$ and $s$ are coupled to $j$ for each nucleon, and then the two single-particle angular momenta are coupled to a total angular momentum $J$; a pair $(j_{p}, j_{n})$ contributes a single coupled channel to $J=0$ if and only if $j_{p} = j_{n}$.\n\nUsing only these definitions and properties of the HO spectrum (that for a fixed $N$, allowed $l$ satisfy $N = 2n + l$ with $n \\in \\mathbb{N}_{0}$, and $m_{l}$ runs over $-l, -l+1, \\dots, l$), do the following:\n- Enumerate all allowed single-particle states up to $N=2$ and count the M-scheme basis dimension $D_{M}$ for the specified subspace (one proton, one neutron; $N_{p}+N_{n}$ even and $\\leq 2$; $M=0$).\n- Enumerate the corresponding single-particle $j$-orbit labels $(n,l,j)$ up to $N=2$ and count the $J$-coupled basis dimension $D_{J}$ for total $J=0$ under the same $N_{p}+N_{n}$ and parity constraints.\n\nExpress your final answer as the exact ratio $D_{M}/D_{J}$. No rounding is required. The answer is unitless.", "solution": "The problem asks for the ratio of the M-scheme basis dimension, $D_{M}$, to the J-coupled basis dimension, $D_{J}$, for a specific subspace of the two-nucleon system (one proton, one neutron). The subspace is defined by the constraints: total harmonic oscillator (HO) quanta $N_{p}+N_{n} \\leq 2$, positive parity ($N_{p}+N_{n}$ is even), and total angular momentum projection $M=0$. The J-coupled basis is further restricted to states with total angular momentum $J=0$.\n\nFirst, we must list the available single-particle (s.p.) states for a nucleon in a 3D HO potential up to major shell $N=2$. A s.p. state is described by the quantum numbers $(N, l, m_{l}, m_{s})$, where $N$ is the principal quantum number, $l$ is the orbital angular momentum, $m_{l}$ is its projection, and $m_{s} = \\pm\\frac{1}{2}$ is the spin projection. The allowed values for $l$ for a given $N$ are $l = N, N-2, \\dots, 1 \\text{ or } 0$.\n\nThe s.p. states are:\n1.  For $N=0$: $l=0$. This gives $m_{l}=0$. With $m_{s}=\\pm\\frac{1}{2}$, we have two s.p. states: $(0,0,0, \\frac{1}{2})$ and $(0,0,0, -\\frac{1}{2})$.\n2.  For $N=1$: $l=1$. This gives $m_{l}=-1, 0, 1$. With $m_{s}=\\pm\\frac{1}{2}$, we have $3 \\times 2 = 6$ s.p. states.\n3.  For $N=2$: $l=0, 2$.\n    - For $l=0$, $m_{l}=0$, $m_{s}=\\pm\\frac{1}{2}$. This gives $2$ states.\n    - For $l=2$, $m_{l}=-2, -1, 0, 1, 2$, $m_{s}=\\pm\\frac{1}{2}$. This gives $5 \\times 2 = 10$ states.\n    - In total for $N=2$, there are $2+10=12$ s.p. states.\n\nThe two-nucleon system is composed of one proton (p) and one neutron (n). The allowed configurations for the pair $(N_{p}, N_{n})$ must satisfy $N_{p}+N_{n} \\leq 2$ and be of positive parity, meaning $N_{p}+N_{n}$ is even. The possible combinations are:\n- $N_{p}+N_{n}=0$: This implies $(N_{p}, N_{n}) = (0,0)$.\n- $N_{p}+N_{n}=2$: This implies $(N_{p}, N_{n})$ can be $(2,0)$, $(0,2)$, or $(1,1)$.\n\nWe will now calculate the M-scheme dimension $D_{M}$ and J-coupled dimension $D_{J}$ by considering these configurations.\n\nCalculation of the M-scheme Dimension, $D_{M}$\nThe M-scheme basis is constructed from pairs of s.p. states, one for the proton $|\\psi_{p}\\rangle = |N_{p}, l_{p}, m_{l,p}, m_{s,p}\\rangle$ and one for the neutron $|\\psi_{n}\\rangle = |N_{n}, l_{n}, m_{l,n}, m_{s,n}\\rangle$. We must count the number of such pairs that satisfy the problem's constraints, including $M = m_{l,p} + m_{s,p} + m_{l,n} + m_{s,n} = 0$. Let $m_{j} = m_{l}+m_{s}$ be the total projection for a single nucleon. The condition is $m_{j,p} + m_{j,n} = 0$.\n\n1.  Configuration $(N_{p}, N_{n}) = (0,0)$:\n    - For a nucleon with $N=0$, $l=0$, $m_{l}=0$. The possible s.p. states are $(0,0,0,\\frac{1}{2})$ and $(0,0,0,-\\frac{1}{2})$, with $m_{j}=\\frac{1}{2}$ and $m_{j}=-\\frac{1}{2}$ respectively.\n    - To satisfy $m_{j,p} + m_{j,n} = 0$, we need $(m_{j,p}, m_{j,n})$ to be $(\\frac{1}{2}, -\\frac{1}{2})$ or $(-\\frac{1}{2}, \\frac{1}{2})$.\n    - This gives two M-scheme states: $|0,0,0,\\frac{1}{2}\\rangle_{p} |0,0,0,-\\frac{1}{2}\\rangle_{n}$ and $|0,0,0,-\\frac{1}{2}\\rangle_{p} |0,0,0,\\frac{1}{2}\\rangle_{n}$.\n    - Contribution to $D_{M}$: $2$.\n\n2.  Configuration $(N_{p}, N_{n}) = (2,0)$:\n    - The proton is in an $N_{p}=2$ state, and the neutron is in an $N_{n}=0$ state.\n    - The neutron s.p. states have $m_{j,n} = \\pm\\frac{1}{2}$.\n    - We first count the number of proton $N_{p}=2$ s.p. states for a given $m_{j,p}$.\n    - For $m_{j,p} = \\frac{1}{2}$: states are $(2,0,0,\\frac{1}{2})$, $(2,2,0,\\frac{1}{2})$, and $(2,2,1,-\\frac{1}{2})$. A total of $3$ states.\n    - For $m_{j,p} = -\\frac{1}{2}$: states are $(2,0,0,-\\frac{1}{2})$, $(2,2,0,-\\frac{1}{2})$, and $(2,2,-1,\\frac{1}{2})$. A total of $3$ states.\n    - If the neutron has $m_{j,n}=-\\frac{1}{2}$, the proton must have $m_{j,p}=\\frac{1}{2}$. This gives $1 \\times 3 = 3$ states.\n    - If the neutron has $m_{j,n}=\\frac{1}{2}$, the proton must have $m_{j,p}=-\\frac{1}{2}$. This gives $1 \\times 3 = 3$ states.\n    - Contribution to $D_{M}$: $3+3=6$.\n\n3.  Configuration $(N_{p}, N_{n}) = (0,2)$:\n    - This case is symmetric to the previous one, with proton and neutron roles exchanged. The counting is identical.\n    - Contribution to $D_{M}$: $6$.\n\n4.  Configuration $(N_{p}, N_{n}) = (1,1)$:\n    - Both proton and neutron are in $N=1$ s.p. states. For $N=1$, we have $l=1$.\n    - We count the number of s.p. states for each possible value of $m_{j} = m_{l}+m_{s}$.\n    - $m_{j}=\\frac{3}{2}$: State is $(1,1,1,\\frac{1}{2})$. Number of states $N(m_j=\\frac{3}{2})=1$.\n    - $m_{j}=\\frac{1}{2}$: States are $(1,1,0,\\frac{1}{2})$ and $(1,1,1,-\\frac{1}{2})$. $N(m_j=\\frac{1}{2})=2$.\n    - $m_{j}=-\\frac{1}{2}$: States are $(1,1,0,-\\frac{1}{2})$ and $(1,1,-1,\\frac{1}{2})$. $N(m_j=-\\frac{1}{2})=2$.\n    - $m_{j}=-\\frac{3}{2}$: State is $(1,1,-1,-\\frac{1}{2})$. $N(m_j=-\\frac{3}{2})=1$.\n    - The number of two-particle states with $m_{j,p}+m_{j,n}=0$ is $\\sum_{m_{j}} N_{p}(m_{j}) N_{n}(-m_{j})$.\n    - Contribution: $N_{p}(\\frac{3}{2})N_{n}(-\\frac{3}{2}) + N_{p}(\\frac{1}{2})N_{n}(-\\frac{1}{2}) + N_{p}(-\\frac{1}{2})N_{n}(\\frac{1}{2}) + N_{p}(-\\frac{3}{2})N_{n}(\\frac{3}{2})$\n    - $= (1 \\times 1) + (2 \\times 2) + (2 \\times 2) + (1 \\times 1) = 1 + 4 + 4 + 1 = 10$.\n    - Contribution to $D_{M}$: $10$.\n\nTotal M-scheme dimension: $D_{M} = 2$ (for $N_{\\text{tot}}=0$) + $6$ (for (2,0)) + $6$ (for (0,2)) + $10$ (for (1,1)) = $24$.\n\nCalculation of the J-coupled Dimension, $D_{J}$\nThe J-coupled basis is constructed from pairs of s.p. orbitals, labeled by $(n,l,j)$, where $N=2n+l$. We are counting states with total angular momentum $J=0$. The problem states that for a proton-neutron system, a pair of s.p. states $(j_{p}, j_{n})$ contributes a single channel to $J=0$ if and only if $j_{p}=j_{n}$.\n\nFirst, we list the s.p. $j$-orbitals up to $N=2$:\n- $N=0$: $n=0, l=0 \\implies j=\\frac{1}{2}$. Orbital: $0s_{1/2}$.\n- $N=1$: $n=0, l=1 \\implies j=\\frac{1}{2}, \\frac{3}{2}$. Orbitals: $0p_{1/2}, 0p_{3/2}$.\n- $N=2$: $n=1, l=0 \\implies j=\\frac{1}{2}$ (orbital $1s_{1/2}$); $n=0, l=2 \\implies j=\\frac{3}{2}, \\frac{5}{2}$ (orbitals $0d_{3/2}, 0d_{5/2}$).\n\nWe now count the pairs of orbitals $((n_{p}, l_{p}, j_{p}), (n_{n}, l_{n}, j_{n}))$ that give $J=0$ for each allowed configuration $(N_{p}, N_{n})$.\n\n1.  Configuration $(N_{p}, N_{n}) = (0,0)$:\n    - Proton orbital must be $0s_{1/2}$ ($N_{p}=0, j_{p}=\\frac{1}{2}$).\n    - Neutron orbital must be $0s_{1/2}$ ($N_{n}=0, j_{n}=\\frac{1}{2}$).\n    - Since $j_{p}=j_{n}=\\frac{1}{2}$, this pair forms one $J=0$ state.\n    - Contribution to $D_{J}$: $1$.\n\n2.  Configuration $(N_{p}, N_{n}) = (2,0)$:\n    - Proton is in an $N_{p}=2$ orbital: $1s_{1/2}$ ($j_{p}=\\frac{1}{2}$), $0d_{3/2}$ ($j_{p}=\\frac{3}{2}$), or $0d_{5/2}$ ($j_{p}=\\frac{5}{2}$).\n    - Neutron is in an $N_{n}=0$ orbital: $0s_{1/2}$ ($j_{n}=\\frac{1}{2}$).\n    - The condition $j_{p}=j_{n}$ requires $j_{p}=\\frac{1}{2}$. The only $N=2$ orbital with $j=\\frac{1}{2}$ is $1s_{1/2}$.\n    - The pair of orbitals is (proton: $1s_{1/2}$, neutron: $0s_{1/2}$). This forms one $J=0$ state.\n    - Contribution to $D_{J}$: $1$.\n\n3.  Configuration $(N_{p}, N_{n}) = (0,2)$:\n    - This is symmetric to the previous case. Proton is in $0s_{1/2}$ ($j_{p}=\\frac{1}{2}$). Neutron must be in the $N=2$ orbital with $j_{n}=\\frac{1}{2}$, which is $1s_{1/2}$.\n    - The pair of orbitals is (proton: $0s_{1/2}$, neutron: $1s_{1/2}$). This forms one $J=0$ state.\n    - Contribution to $D_{J}$: $1$.\n\n4.  Configuration $(N_{p}, N_{n}) = (1,1)$:\n    - Both proton and neutron are in $N=1$ orbitals.\n    - Possible orbitals are $0p_{1/2}$ ($j=\\frac{1}{2}$) and $0p_{3/2}$ ($j=\\frac{3}{2}$).\n    - The condition $j_{p}=j_{n}$ can be satisfied in two ways:\n        - $j_{p}=j_{n}=\\frac{1}{2}$: The pair is (proton: $0p_{1/2}$, neutron: $0p_{1/2}$). This forms one $J=0$ state.\n        - $j_{p}=j_{n}=\\frac{3}{2}$: The pair is (proton: $0p_{3/2}$, neutron: $0p_{3/2}$). This forms one $J=0$ state.\n    - Contribution to $D_{J}$: $1+1=2$.\n\nTotal J-coupled dimension for $J=0$: $D_{J} = 1$ (for $N_{\\text{tot}}=0$) + $1$ (for (2,0)) + $1$ (for (0,2)) + $2$ (for (1,1)) = $5$.\n\nFinal Ratio\nThe problem asks for the ratio $D_{M}/D_{J}$.\n$D_{M} = 24$\n$D_{J} = 5$\nThe ratio is $\\frac{D_{M}}{D_{J}} = \\frac{24}{5}$.", "answer": "$$\\boxed{\\frac{24}{5}}$$", "id": "3604989"}, {"introduction": "Since NCSM calculations are performed in a truncated model space (the $P$-space), the effects of the excluded high-energy states (the $Q$-space) must be incorporated into an effective Hamiltonian. This problem demonstrates the core principle of this renormalization using the Lee-Suzuki method in a simplified two-state system, where you will derive an effective interaction that exactly reproduces an eigenvalue of the full problem. By working through this toy model, you will gain a fundamental understanding of how effective interactions are constructed to make calculations in a smaller, feasible space capture the essential physics of the full system. [@problem_id:3605061]", "problem": "In the no-core shell model (NCSM), consider a two-nucleon subsystem restricted to relative $s$-wave harmonic-oscillator (HO) basis states. Let the full space be spanned by the two lowest HO quanta states $\\{|N=0\\rangle, |N=2\\rangle\\}$, and let the model space projector be $P = |0\\rangle\\langle 0|$, with the complement $Q = |2\\rangle\\langle 2|$. The intrinsic two-body Hamiltonian is $H = T_{\\mathrm{rel}} + V_{NN}$, with the following nonvanishing matrix elements in this truncated basis (assume time-reversal symmetry and Hermiticity so that $H_{02} = H_{20}$):\n\n- Kinetic-energy matrix elements: $T_{00} = 10\\,\\mathrm{MeV}$ and $T_{22} = 30\\,\\mathrm{MeV}$.\n- Bare interaction matrix elements: $V_{00} = -12\\,\\mathrm{MeV}$, $V_{22} = -5\\,\\mathrm{MeV}$, and $V_{02} = V_{20} = -8\\,\\mathrm{MeV}$.\n\nThus $H_{00} = T_{00} + V_{00}$, $H_{22} = T_{22} + V_{22}$, and $H_{02} = V_{02}$.\n\nApply the Lee–Suzuki method to construct an energy-independent effective interaction in the model space $P$ that reproduces in $P$ the exact deuteron bound-state energy of the full $2\\times 2$ problem. Starting from the projection-operator formalism and the decoupling condition, derive the one-dimensional $P$-space effective Hamiltonian and determine the scalar effective two-body interaction matrix element in $P$,\n$$\nV_{\\mathrm{eff}}^{(P)} \\equiv \\langle 0|V_{\\mathrm{eff}}|0\\rangle,\n$$\nsuch that the $P$-space Hamiltonian $H_{\\mathrm{eff}}^{(P)} = T_{00} + V_{\\mathrm{eff}}^{(P)}$ has the exact deuteron energy of the full problem as its eigenvalue. Express your final answer in $\\mathrm{MeV}$ as a closed-form analytic expression (no rounding).", "solution": "The problem is scientifically grounded, well-posed, and contains all necessary information to derive a unique solution. It is a standard problem in the application of effective interaction theory in nuclear physics. Therefore, the problem is valid.\n\nThe problem describes a two-nucleon system within a truncated harmonic-oscillator basis, spanned by the states $|N=0\\rangle$ and $|N=2\\rangle$, which we denote as $|0\\rangle$ and $|2\\rangle$ for simplicity. The full space is of dimension two. The model space, or $P$-space, is the one-dimensional space spanned by the $|0\\rangle$ state, defined by the projector $P = |0\\rangle\\langle 0|$. The excluded space, or $Q$-space, is spanned by the $|2\\rangle$ state, with the projector $Q = |2\\rangle\\langle 2|$.\n\nThe full Hamiltonian $H = T_{\\mathrm{rel}} + V_{NN}$ can be represented as a $2 \\times 2$ matrix in the $\\{|0\\rangle, |2\\rangle\\}$ basis. The matrix elements are given by:\n$H_{00} = \\langle 0|H|0\\rangle = T_{00} + V_{00}$\n$H_{22} = \\langle 2|H|2\\rangle = T_{22} + V_{22}$\n$H_{02} = \\langle 0|H|2\\rangle = V_{02}$\n$H_{20} = \\langle 2|H|0\\rangle = V_{20}$\n\nUsing the provided numerical values:\n$T_{00} = 10\\,\\mathrm{MeV}$\n$T_{22} = 30\\,\\mathrm{MeV}$\n$V_{00} = -12\\,\\mathrm{MeV}$\n$V_{22} = -5\\,\\mathrm{MeV}$\n$V_{02} = V_{20} = -8\\,\\mathrm{MeV}$\n\nWe can construct the matrix elements of the full Hamiltonian $H$:\n$H_{00} = 10 + (-12) = -2\\,\\mathrm{MeV}$\n$H_{22} = 30 + (-5) = 25\\,\\mathrm{MeV}$\n$H_{02} = H_{20} = -8\\,\\mathrm{MeV}$\n\nSo, the Hamiltonian matrix is:\n$$\nH = \\begin{pmatrix} H_{00} & H_{02} \\\\ H_{20} & H_{22} \\end{pmatrix} = \\begin{pmatrix} -2 & -8 \\\\ -8 & 25 \\end{pmatrix} \\, \\mathrm{MeV}\n$$\n\nThe goal is to find an effective interaction in the $P$-space that reproduces one of the exact eigenvalues of the full Hamiltonian $H$. Specifically, we are interested in the deuteron bound-state energy, which corresponds to the lowest (most negative) eigenvalue of $H$. To find the eigenvalues, we solve the characteristic equation $\\det(H - E I) = 0$:\n$$\n\\begin{vmatrix} -2 - E & -8 \\\\ -8 & 25 - E \\end{vmatrix} = 0\n$$\n$$\n(-2 - E)(25 - E) - (-8)(-8) = 0\n$$\n$$\n-50 + 2E - 25E + E^2 - 64 = 0\n$$\n$$\nE^2 - 23E - 114 = 0\n$$\nUsing the quadratic formula, $E = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}$:\n$$\nE = \\frac{23 \\pm \\sqrt{(-23)^2 - 4(1)(-114)}}{2} = \\frac{23 \\pm \\sqrt{529 + 456}}{2} = \\frac{23 \\pm \\sqrt{985}}{2}\n$$\nThe two eigenvalues are $E_+ = \\frac{23 + \\sqrt{985}}{2}$ and $E_- = \\frac{23 - \\sqrt{985}}{2}$. The deuteron bound-state energy, which we denote as $E_d$, must be the lower eigenvalue:\n$$\nE_d = \\frac{23 - \\sqrt{985}}{2} \\, \\mathrm{MeV}\n$$\n\nThe problem asks for the effective interaction matrix element $V_{\\mathrm{eff}}^{(P)}$ in the $P$-space. The $P$-space effective Hamiltonian is defined in the problem as $H_{\\mathrm{eff}}^{(P)} = T_{00} + V_{\\mathrm{eff}}^{(P)}$. The core requirement of the Lee-Suzuki method, and effective interaction theories in general, is that the eigenvalues of the effective Hamiltonian within the model space are a subset of the eigenvalues of the original full Hamiltonian. In this case, $H_{\\mathrm{eff}}^{(P)}$ must have $E_d$ as its eigenvalue.\n\nThe model space $P$ is one-dimensional, spanned by $|0\\rangle$. Therefore, the effective Hamiltonian $H_{\\mathrm{eff}}^{(P)}$ is a $1 \\times 1$ matrix, which is a scalar. The eigenvalue of a scalar is the scalar itself. Thus, we must have:\n$$\nH_{\\mathrm{eff}}^{(P)} = E_d\n$$\nBy substituting the problem's definition of $H_{\\mathrm{eff}}^{(P)}$, we get the following relation:\n$$\nT_{00} + V_{\\mathrm{eff}}^{(P)} = E_d\n$$\nFrom this, we can directly solve for the desired effective interaction matrix element, $V_{\\mathrm{eff}}^{(P)}$:\n$$\nV_{\\mathrm{eff}}^{(P)} = E_d - T_{00}\n$$\nNow, we substitute the values for $E_d$ and $T_{00}$:\n$$\nV_{\\mathrm{eff}}^{(P)} = \\left(\\frac{23 - \\sqrt{985}}{2}\\right) - 10\n$$\nTo obtain a single fractional expression, we find a common denominator:\n$$\nV_{\\mathrm{eff}}^{(P)} = \\frac{23 - \\sqrt{985}}{2} - \\frac{20}{2} = \\frac{23 - \\sqrt{985} - 20}{2}\n$$\n$$\nV_{\\mathrm{eff}}^{(P)} = \\frac{3 - \\sqrt{985}}{2}\n$$\nThis is the closed-form analytic expression for the effective interaction matrix element in MeV. This result is fully consistent with the Feshbach-Bloch-Horowitz projection formalism, from which the Lee-Suzuki method is derived. The effective Hamiltonian matrix element is $H_{\\mathrm{eff}} = H_{00} + H_{02} \\frac{1}{E_d - H_{22}} H_{20}$. The effective interaction part is $V_{\\mathrm{eff}}^{(P)} = V_{00} + V_{02} \\frac{1}{E_d - H_{22}} V_{20}$. The expression $E_d - T_{00}$ is algebraically equivalent to this more detailed form, as shown by the identity $E_d = H_{00} + \\frac{|H_{02}|^2}{E_d-H_{22}}$, which is the solved characteristic equation.\n\nThe final answer is the value determined for $V_{\\mathrm{eff}}^{(P)}$.", "answer": "$$\n\\boxed{\\frac{3 - \\sqrt{985}}{2}}\n$$", "id": "3605061"}, {"introduction": "The feasibility of large-scale NCSM calculations is ultimately dictated by the computational resources required to store and diagonalize the Hamiltonian matrix. This exercise models the computational cost of a realistic calculation by connecting the physics—such as basis dimension and interaction sparsity—to computer science concepts like sparse matrix storage and memory bandwidth. This practice provides essential insight into the practical challenges of computational nuclear physics, highlighting why performance analysis is critical for pushing the frontiers of ab initio theory. [@problem_id:3605024]", "problem": "Consider the No-Core Shell Model (NCSM) formulation for an $A=10$ system in a three-dimensional harmonic oscillator single-particle basis truncated by the total excitation quanta $N_{\\max}=8$, working in the magnetic quantum number projection scheme (M-scheme) at fixed total $M=0$. In the M-scheme, the Hamiltonian in second quantization is a sum of one-body and two-body terms acting on antisymmetrized Slater determinants; for realistic nuclear interactions dominated by two-body operators, the Hamiltonian matrix in the many-body basis is extremely sparse because each row only connects to configurations differing by at most two single-particle occupancies, subject to the $N_{\\max}$ truncation and angular-momentum coupling constraints.\n\nAssume the following empirically representative model characteristics for the largest $M=0$ block at $A=10$ and $N_{\\max}=8$:\n- The dimension of the many-body M-scheme basis is $D=8.0 \\times 10^{7}$.\n- The average number of nonzero matrix elements per row is $\\kappa=1.3 \\times 10^{3}$, reflecting connectivity from two-body excitations consistent with the truncation and good quantum numbers.\n- The Hamiltonian is stored in Compressed Sparse Row (CSR) format with $8$-byte floating-point values, $4$-byte column indices, and $8$-byte row pointers. Two working Lanczos vectors of length $D$ (each stored in $8$-byte floating-point) are resident in memory during diagonalization.\n- The diagonalization uses the Lanczos algorithm, with $N_{\\mathrm{it}}=300$ iterations to converge the targeted low-lying spectrum. Each iteration is dominated by one sparse matrix-vector multiplication (SpMV). Model the SpMV memory traffic using a bandwidth-bound roofline: count $b_{\\mathrm{nz}}=20$ bytes of memory traffic per nonzero (value, index, and the corresponding element of the input vector), and an additional $16D$ bytes per iteration for reading and writing the output vector.\n- The Hamiltonian construction is performed on-the-fly and written out to CSR, requiring $b_{\\mathrm{build}}=32$ bytes of sustained memory traffic per nonzero over $N_{\\mathrm{pass}}=20$ streaming passes (including indexing, sorting, and finalization).\n- The sustained aggregate memory bandwidth of the computing system for this workload is $B = 2.0 \\times 10^{11}$ bytes per second.\n- Account for auxiliary data structures and runtime overhead by multiplying the memory footprint by a factor $\\delta=1.05$.\n\nStarting from these foundational principles—two-body sparsity in the M-scheme, CSR storage characteristics, and a bandwidth-dominated SpMV and build model—derive expressions and evaluate:\n1. The total memory footprint required to store the Hamiltonian in CSR together with two Lanczos working vectors and overhead.\n2. The total wall-clock time to construct the Hamiltonian and then perform $N_{\\mathrm{it}}$ Lanczos iterations.\n\nExpress the memory in terabytes (where $1\\,\\mathrm{TB} = 10^{12}$ bytes) and the time in hours. Round both final numerical results to three significant figures. Your final answer must be two numbers corresponding to memory and time, respectively, arranged as a single row matrix. Do not include units in the boxed final answer.", "solution": "The problem is deemed valid as it is scientifically grounded in the principles of computational nuclear physics, is well-posed with sufficient and consistent data, and is expressed in objective, formal language. The provided parameters are realistic for a large-scale No-Core Shell Model (NCSM) calculation. We can therefore proceed with a quantitative solution.\n\nThe task is to compute two quantities: the total memory footprint of the calculation and the total wall-clock time required for the Hamiltonian construction and diagonalization phases.\n\n**1. Total Memory Footprint Calculation**\n\nThe total memory footprint, $M_{\\mathrm{total}}$, is the sum of the memory required for the Hamiltonian matrix, $M_{H}$, and the two Lanczos working vectors, $M_{\\mathrm{vec}}$, multiplied by an overhead factor $\\delta$.\n\n$$M_{\\mathrm{total}} = \\delta (M_{H} + M_{\\mathrm{vec}})$$\n\nFirst, we determine the number of non-zero elements ($N_{\\mathrm{nz}}$) in the Hamiltonian matrix. Given the matrix dimension $D = 8.0 \\times 10^{7}$ and the average number of non-zero elements per row $\\kappa = 1.3 \\times 10^{3}$:\n\n$$N_{\\mathrm{nz}} = D \\kappa = (8.0 \\times 10^{7}) \\times (1.3 \\times 10^{3}) = 1.04 \\times 10^{11}$$\n\nNext, we calculate the memory required to store the Hamiltonian in Compressed Sparse Row (CSR) format, $M_{H}$. The CSR format consists of three arrays: one for the non-zero values (floating-point numbers of $8$ bytes each), one for the column indices ($4$-byte integers), and one for the row pointers ($8$-byte integers). The row pointer array has $D+1$ elements.\n\n$$M_{H} = N_{\\mathrm{nz}} \\times (\\text{size}_{\\text{value}} + \\text{size}_{\\text{index}}) + (D+1) \\times \\text{size}_{\\text{pointer}}$$\n$$M_{H} = (1.04 \\times 10^{11}) \\times (8\\,\\text{bytes} + 4\\,\\text{bytes}) + (8.0 \\times 10^{7} + 1) \\times 8\\,\\text{bytes}$$\n$$M_{H} = (1.04 \\times 10^{11}) \\times 12 + (8.0 \\times 10^{7} + 1) \\times 8$$\n$$M_{H} = 1.248 \\times 10^{12} + 6.4 \\times 10^{8} + 8 \\approx 1.24864 \\times 10^{12}\\,\\text{bytes}$$\n\nThe memory for the two Lanczos working vectors, $M_{\\mathrm{vec}}$, each of length $D$ with $8$-byte floating-point elements, is:\n\n$$M_{\\mathrm{vec}} = 2 \\times D \\times \\text{size}_{\\text{value}} = 2 \\times (8.0 \\times 10^{7}) \\times 8\\,\\text{bytes} = 1.28 \\times 10^{9}\\,\\text{bytes}$$\n\nThe raw memory footprint is the sum $M_{H} + M_{\\mathrm{vec}}$:\n\n$$M_{\\mathrm{raw}} = M_{H} + M_{\\mathrm{vec}} \\approx 1.24864 \\times 10^{12} + 1.28 \\times 10^{9} = 1.24992 \\times 10^{12}\\,\\text{bytes}$$\n\nApplying the overhead factor $\\delta = 1.05$:\n\n$$M_{\\mathrm{total}} = \\delta \\times M_{\\mathrm{raw}} = 1.05 \\times (1.24992 \\times 10^{12}) \\approx 1.312416 \\times 10^{12}\\,\\text{bytes}$$\n\nTo express this in terabytes (TB), where $1\\,\\text{TB} = 10^{12}$ bytes:\n\n$$M_{\\mathrm{TB}} = \\frac{M_{\\mathrm{total}}}{10^{12}} \\approx 1.312416\\,\\text{TB}$$\n\nRounding to three significant figures, the memory footprint is $1.31\\,\\text{TB}$.\n\n**2. Total Wall-Clock Time Calculation**\n\nThe total wall-clock time, $T_{\\mathrm{total}}$, is the sum of the time for Hamiltonian construction, $T_{\\mathrm{build}}$, and the time for Lanczos diagonalization, $T_{\\mathrm{diag}}$.\n\n$$T_{\\mathrm{total}} = T_{\\mathrm{build}} + T_{\\mathrm{diag}}$$\n\nBoth phases are assumed to be limited by the memory bandwidth $B = 2.0 \\times 10^{11}$ bytes/s. The time for each phase is the total memory traffic divided by this bandwidth.\n\nFirst, we calculate the construction time, $T_{\\mathrm{build}}$. The total memory traffic for construction, $V_{\\mathrm{build}}$, is determined by the traffic per non-zero element, $b_{\\mathrm{build}} = 32$ bytes, the total number of non-zeros, $N_{\\mathrm{nz}}$, and the number of streaming passes, $N_{\\mathrm{pass}} = 20$.\n\n$$V_{\\mathrm{build}} = N_{\\mathrm{nz}} \\times b_{\\mathrm{build}} \\times N_{\\mathrm{pass}} = (1.04 \\times 10^{11}) \\times 32 \\times 20 = 6.656 \\times 10^{13}\\,\\text{bytes}$$\n$$T_{\\mathrm{build}} = \\frac{V_{\\mathrm{build}}}{B} = \\frac{6.656 \\times 10^{13}\\,\\text{bytes}}{2.0 \\times 10^{11}\\,\\text{bytes/s}} = 332.8\\,\\text{s}$$\n\nNext, we calculate the diagonalization time, $T_{\\mathrm{diag}}$. This is determined by the time for a single Lanczos iteration multiplied by the number of iterations, $N_{\\mathrm{it}} = 300$. The memory traffic per iteration, $V_{\\mathrm{iter}}$, consists of two parts: traffic associated with the non-zero elements and traffic for the input/output vectors.\n\nThe problem specifies the traffic per non-zero element to be $b_{\\mathrm{nz}} = 20$ bytes, and the additional traffic for reading and writing the output vector to be $16 D$ bytes.\n\n$$V_{\\mathrm{iter}} = N_{\\mathrm{nz}} \\times b_{\\mathrm{nz}} + 16 \\times D$$\n$$V_{\\mathrm{iter}} = (1.04 \\times 10^{11}) \\times 20 + 16 \\times (8.0 \\times 10^{7})$$\n$$V_{\\mathrm{iter}} = 2.08 \\times 10^{12} + 1.28 \\times 10^{9} = 2.08128 \\times 10^{12}\\,\\text{bytes}$$\n\nThe total memory traffic for diagonalization, $V_{\\mathrm{diag}}$, over $N_{\\mathrm{it}}$ iterations is:\n\n$$V_{\\mathrm{diag}} = N_{\\mathrm{it}} \\times V_{\\mathrm{iter}} = 300 \\times (2.08128 \\times 10^{12}) = 6.24384 \\times 10^{14}\\,\\text{bytes}$$\n\nThe diagonalization time is then:\n\n$$T_{\\mathrm{diag}} = \\frac{V_{\\mathrm{diag}}}{B} = \\frac{6.24384 \\times 10^{14}\\,\\text{bytes}}{2.0 \\times 10^{11}\\,\\text{bytes/s}} = 3121.92\\,\\text{s}$$\n\nThe total time in seconds is:\n\n$$T_{\\mathrm{total}} = T_{\\mathrm{build}} + T_{\\mathrm{diag}} = 332.8\\,\\text{s} + 3121.92\\,\\text{s} = 3454.72\\,\\text{s}$$\n\nTo express this in hours, we divide by $3600\\,\\text{s/hr}$:\n\n$$T_{\\mathrm{hours}} = \\frac{T_{\\mathrm{total}}}{3600} = \\frac{3454.72}{3600} \\approx 0.959644\\,\\text{hr}$$\n\nRounding to three significant figures, the total wall-clock time is $0.960\\,\\text{hr}$.\n\nIn summary, the calculated memory footprint is $1.31\\,\\text{TB}$ and the total wall-clock time is $0.960$ hours.", "answer": "$$\\boxed{\\begin{pmatrix} 1.31 & 0.960 \\end{pmatrix}}$$", "id": "3605024"}]}