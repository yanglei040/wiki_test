{"hands_on_practices": [{"introduction": "Understanding the overall distribution of transition strength is as crucial as calculating a single matrix element. This exercise introduces the powerful Lanczos method to compute moments of the Fermi strength distribution, such as its centroid and width [@problem_id:3546731]. By implementing this algorithm, you will gain hands-on experience with a workhorse of computational physics and computationally verify the fundamental Fermi sum rule, which constrains the total strength $m_0$ to the neutron excess $N-Z$.", "problem": "You are to implement a complete numerical procedure to compute Fermi transition strength moments using the Lanczos strength-function method in a simplified, computationally tractable model, and to test a model-independent sum rule. The physical observable of interest is the Fermi strength function for charge-exchange transitions from a nuclear many-body ground state under the action of the Fermi operator, and its energy-weighted moments. Your task is to work in a finite-dimensional basis in which the excitation subspace is represented by orthonormal basis states labeled by single-particle energy differences, and to use a Lanczos tridiagonalization to approximate the strength distribution and its low-order moments. All energies must be treated and reported in mega-electron volts (MeV).\n\nFundamental base:\n- The Fermi operator for charge-exchange transitions can be written as $F_{-} = \\sum_{i=1}^{A} \\tau_{i}^{-}$, where $A$ is the nucleon number and $\\tau_{i}^{-}$ is the isospin-lowering operator acting on nucleon $i$. In an independent-particle description that restricts to neutron-to-proton transitions, the action of $F_{-}$ on the ground state $|0\\rangle$ produces a superposition of one-particle-one-hole excitations with amplitudes determined by occupancy, which we encode as a nonnegative weight for each accessible excitation.\n- The non-energy-weighted sum rule for Fermi transitions in this restricted channel is given by the norm squared of $F_{-}|0\\rangle$, which equals the neutron excess $N - Z$ when no proton-to-neutron transitions are allowed in the model space, where $N$ is the neutron number and $Z$ is the proton number. In our discrete computational model, this norm is computed as the sum of nonnegative integer weights associated with each accessible transition.\n- The strength function for an operator $F$ is $S(\\omega) = \\sum_{n} \\left|\\langle n|F|0\\rangle\\right|^{2} \\delta\\!\\left(\\omega - (E_{n}-E_{0})\\right)$, where $\\{|n\\rangle\\}$ is a complete set of excited eigenstates of the Hamiltonian $H$ with excitation energies $E_{n}-E_{0} \\ge 0$. Its moments are $m_{k} = \\int \\omega^{k} S(\\omega)\\, d\\omega$. In a finite-dimensional representation with discrete excitation energies, these moments reduce to finite sums.\n- The Lanczos strength-function method constructs an orthonormal basis via Lanczos tridiagonalization of the Hamiltonian $H$ starting from the normalized pivot vector $|v_{0}\\rangle = \\frac{F|0\\rangle}{\\|F|0\\rangle\\|}$, yielding a symmetric tridiagonal matrix $T_{L}$ of dimension $L \\times L$ after $L$ iterations (or fewer if convergence is reached sooner). The eigenvalues and the first components of the normalized eigenvectors of $T_{L}$ define a Gaussian quadrature approximation to the spectral distribution associated with $H$ and $|v_{0}\\rangle$, which provides approximations to the energy-weighted moments $m_{k}$.\n\nComputational setup:\n- Represent the excitation Hamiltonian in the restricted transition subspace by a diagonal matrix $H = \\mathrm{diag}(\\Delta_{1}, \\Delta_{2}, \\ldots, \\Delta_{K})$, where $\\Delta_{j} \\ge 0$ are excitation energies in MeV. The vector $|b\\rangle \\equiv F_{-}|0\\rangle$ is represented in the same basis by its components $b_{j} = \\sqrt{w_{j}}$, where $w_{j} \\in \\mathbb{N}_{0}$ are nonnegative integer weights that encode how many indistinguishable neutron-to-proton transitions contribute at energy $\\Delta_{j}$. The non-energy-weighted sum (zeroth moment) is $m_{0} = \\langle b|b\\rangle = \\sum_{j=1}^{K} w_{j}$.\n- Perform $L$ iterations of Lanczos tridiagonalization starting from $|v_{0}\\rangle = \\frac{|b\\rangle}{\\sqrt{m_{0}}}$ when $m_{0} > 0$; if $m_{0} = 0$, skip Lanczos and define the centroid and width to be zero as specified below. Form the tridiagonal matrix $T_{L}$ with diagonal elements $\\alpha_{\\ell}$ and off-diagonal elements $\\beta_{\\ell}$ for $\\ell = 0, 1, \\ldots$, in the usual three-term recurrence, with early termination if a new Lanczos vector has norm below a small threshold. Use the eigenvalues and the first components of the normalized eigenvectors of $T_{L}$ to construct a Gaussian quadrature approximation that yields approximations to the first two energy-weighted moments $m_{1}$ and $m_{2}$, and therefore the centroid and width of the strength distribution.\n- Define the centroid as $E_{\\mathrm{c}} = \\frac{m_{1}}{m_{0}}$ (in MeV) and the standard deviation (width) as $\\sigma = \\sqrt{\\frac{m_{2}}{m_{0}} - \\left(\\frac{m_{1}}{m_{0}}\\right)^{2}}$ (in MeV) when $m_{0} > 0$. When $m_{0} = 0$, set $E_{\\mathrm{c}} = 0$ and $\\sigma = 0$ by convention.\n\nTasks:\n- For each test case below, construct $H$ and $|b\\rangle$ from the provided $\\{\\Delta_{j}\\}$ and $\\{w_{j}\\}$, compute the exact zeroth moment $m_{0} = \\sum_{j=1}^{K} w_{j}$, and verify the restricted-channel Fermi sum rule $m_{0} = N - Z$ within a numerical tolerance of $|\\cdot| < 10^{-12}$. Then, using $L$ Lanczos iterations as specified for the case, compute the centroid $E_{\\mathrm{c}}$ and width $\\sigma$ in MeV using the Gaussian quadrature implied by the Lanczos tridiagonalization. If $m_{0} = 0$, set both $E_{\\mathrm{c}}$ and $\\sigma$ to zero without running Lanczos.\n- All energies must be expressed in mega-electron volts (MeV). The final outputs for $E_{\\mathrm{c}}$ and $\\sigma$ must be real-valued floating-point numbers in MeV.\n\nTest suite:\nProvide results for the following parameter sets. For each case, numbers are given in their natural units, with energies in MeV.\n- Case 1: $\\Delta = [1.0, 3.0, 7.0]$, $w = [1, 1, 1]$, $N = 7, Z = 4, L = 3$.\n- Case 2: $\\Delta = [2.0, 5.0]$, $w = [1, 1]$, $N = 8, Z = 6, L = 2$.\n- Case 3: $\\Delta = [10.0]$, $w = [4]$, $N = 12, Z = 8, L = 5$.\n- Case 4: $\\Delta = [1.0, 2.0]$, $w = [0, 0]$, $N = 5, Z = 5, L = 2$.\n- Case 5: $\\Delta = [1.0, 4.0, 9.0, 16.0]$, $w = [2, 1, 3, 2]$, $N = 13, Z = 5, L = 1$.\n\nRequired final output format:\n- Your program must produce a single line of output containing a list of per-case results, each result itself being a list of three entries: the first is a boolean indicating whether the equality $m_{0} = N - Z$ holds within the stated tolerance, the second is the centroid $E_{\\mathrm{c}}$ in MeV as a floating-point number, and the third is the width $\\sigma$ in MeV as a floating-point number. The line should be a comma-separated list enclosed in square brackets, for example, $[\\,\\mathrm{case}_{1},\\mathrm{case}_{2},\\ldots\\,]$, where each $\\mathrm{case}_{i}$ is of the form $[\\,\\mathrm{boolean}, E_{\\mathrm{c}}, \\sigma\\,]$.", "solution": "We begin with the Fermi charge-exchange operator $F_{-} = \\sum_{i=1}^{A} \\tau_{i}^{-}$ acting on the nuclear ground state $|0\\rangle$. In an independent-particle picture restricted to neutron-to-proton ($n \\rightarrow p$) transitions within a given model space, the action of $F_{-}$ produces a coherent superposition of one-particle-one-hole excitations. The associated strength function is $S(\\omega) = \\sum_{n} \\left|\\langle n|F_{-}|0\\rangle\\right|^{2} \\delta\\!\\left(\\omega - (E_{n}-E_{0})\\right)$, with energy moments $m_{k} = \\int \\omega^{k} S(\\omega)\\, d\\omega$. The zeroth moment $m_{0}$ is the norm squared of $F_{-}|0\\rangle$, $m_{0} = \\langle 0|F_{+} F_{-}|0\\rangle$, which, under the stated restriction of no $p \\rightarrow n$ transitions, equals the neutron excess $N - Z$ as a well-known model-independent Fermi sum rule.\n\nTo pass from a general many-body treatment to a computationally manageable representation, we encode the strength distribution in an orthonormal basis $\\{|j\\rangle\\}_{j=1}^{K}$ of accessible excitations where the Hamiltonian $H$ is diagonal, $H = \\mathrm{diag}(\\Delta_{1}, \\ldots, \\Delta_{K})$, with $\\Delta_{j} \\ge 0$ the excitation energies in mega-electron volts (MeV). The vector $|b\\rangle \\equiv F_{-}|0\\rangle$ has components $b_{j} = \\sqrt{w_{j}}$ with nonnegative integer weights $w_{j} \\in \\mathbb{N}_{0}$. In this representation, the strength function is $S(\\omega) = \\sum_{j=1}^{K} w_{j} \\, \\delta(\\omega - \\Delta_{j})$, and the low-order moments are finite sums: $m_{0} = \\sum_{j=1}^{K} w_{j}$, $m_{1} = \\sum_{j=1}^{K} w_{j} \\Delta_{j}$, and $m_{2} = \\sum_{j=1}^{K} w_{j} \\Delta_{j}^{2}$. The centroid and width are defined by $E_{\\mathrm{c}} = \\frac{m_{1}}{m_{0}}$ and $\\sigma = \\sqrt{\\frac{m_{2}}{m_{0}} - \\left(\\frac{m_{1}}{m_{0}}\\right)^{2}}$ when $m_{0} > 0$, and by convention $E_{\\mathrm{c}} = 0$ and $\\sigma = 0$ when $m_{0} = 0$.\n\nThe Lanczos strength-function method provides an efficient way to approximate the spectral distribution associated with $(H, |b\\rangle)$ without diagonalizing the full Hamiltonian. One constructs the normalized pivot vector $|v_{0}\\rangle = \\frac{|b\\rangle}{\\|b\\|}$ with $\\|b\\| = \\sqrt{m_{0}}$, and applies the three-term Lanczos recurrence\n$|w_{\\ell}\\rangle = H|v_{\\ell}\\rangle - \\beta_{\\ell} |v_{\\ell-1}\\rangle$, $\\alpha_{\\ell} = \\langle v_{\\ell}|w_{\\ell}\\rangle$, $|w_{\\ell}\\rangle \\leftarrow |w_{\\ell}\\rangle - \\alpha_{\\ell} |v_{\\ell}\\rangle$, $\\beta_{\\ell+1} = \\|\\,|w_{\\ell}\\rangle\\,\\|$, and $|v_{\\ell+1}\\rangle = \\frac{|w_{\\ell}\\rangle}{\\beta_{\\ell+1}}$,\nwith initialization $|v_{-1}\\rangle \\equiv 0$, $\\beta_{0} \\equiv 0$. After $L$ iterations (or earlier if $\\beta_{\\ell+1}$ vanishes within a small tolerance), one obtains a symmetric tridiagonal matrix $T_{L}$ with diagonal entries $\\alpha_{0}, \\ldots, \\alpha_{L-1}$ and off-diagonal entries $\\beta_{1}, \\ldots, \\beta_{L-1}$. The spectral theorem ensures that the pair $(H, |v_{0}\\rangle)$ induces a positive measure on the real line (the spectral measure of $H$ with respect to $|v_{0}\\rangle$). Gaussian quadrature theory then states that the eigenvalues $\\{\\lambda_{j}\\}_{j=1}^{L}$ of $T_{L}$, together with the squared first components $\\{w_{j}^{(\\mathrm{GQ})}\\}_{j=1}^{L}$ of the normalized eigenvectors of $T_{L}$, define a quadrature rule that is exact for the first $2L$ moments of the spectral measure in the ideal arithmetic and exact Krylov subspace setting. Consequently, approximate moments follow as $m_{k} \\approx m_{0} \\sum_{j=1}^{L} w_{j}^{(\\mathrm{GQ})} \\lambda_{j}^{k}$ for $k = 1, 2$, from which the centroid and width are obtained.\n\nAlgorithmic design:\n- Input: the lists of excitation energies $\\{\\Delta_{j}\\}_{j=1}^{K}$ in MeV, weights $\\{w_{j}\\}_{j=1}^{K}$, the pair $(N, Z)$, and the Lanczos iteration count $L$.\n- Compute $m_{0} = \\sum_{j=1}^{K} w_{j}$ and verify the Fermi sum rule by checking $|m_{0} - (N - Z)| < 10^{-12}$, a tight tolerance that is suitable since our $m_{0}$ is evaluated exactly from integer weights.\n- If $m_{0} = 0$, return $(\\mathrm{True}, 0.0, 0.0)$ because the restricted-channel sum rule holds trivially and the strength distribution is empty.\n- Else, form the normalized pivot $|v_{0}\\rangle = \\frac{|b\\rangle}{\\sqrt{m_{0}}}$ with $b_{j} = \\sqrt{w_{j}}$, and perform up to $L$ Lanczos iterations, with early termination if a new Lanczos vector norm falls below a small threshold (e.g., $10^{-14}$). In our diagonal-$H$ representation, matrix-vector products are $H|x\\rangle$ with $(H x)_{j} = \\Delta_{j} x_{j}$.\n- Assemble the tridiagonal matrix $T_{L}$ and solve its symmetric eigenproblem to obtain $\\{\\lambda_{j}\\}$ and $\\{u_{j}\\}$, where $u_{j}$ is the $j$-th normalized eigenvector. The Gaussian quadrature weights are $w_{j}^{(\\mathrm{GQ})} = \\left(u_{j}\\right)_{1}^{2}$, where $\\left(u_{j}\\right)_{1}$ denotes the first component of $u_{j}$ in the Lanczos basis. Compute $m_{1} \\approx m_{0} \\sum_{j} w_{j}^{(\\mathrm{GQ})} \\lambda_{j}$ and $m_{2} \\approx m_{0} \\sum_{j} w_{j}^{(\\mathrm{GQ})} \\lambda_{j}^{2}$, then compute $E_{\\mathrm{c}}$ and $\\sigma$ as above. Notably, for $L = 1$, the centroid $E_{\\mathrm{c}}$ is already exact because $\\alpha_{0} = \\langle v_{0}|H|v_{0}\\rangle = \\frac{\\langle b|H|b\\rangle}{\\langle b|b\\rangle} = \\frac{m_{1}}{m_{0}}$, while the width is generally underestimated.\n- Numerical stability: we include full reorthogonalization of the new Lanczos vector against all previous Lanczos vectors to mitigate loss of orthogonality in finite precision, although in our diagonal representation the three-term recurrence is typically sufficient.\n\nApplication to the test suite:\n- Case $1$ with $\\Delta = [\\,1.0, 3.0, 7.0\\,]$, $w = [\\,1, 1, 1\\,]$, $N - Z = 3$, and $L = 3$ yields exact centroid and width because the Krylov subspace spans the full space; the outputs are the boolean $\\mathrm{True}$, the centroid in MeV, and the width in MeV.\n- Case $2$ with $\\Delta = [\\,2.0, 5.0\\,]$, $w = [\\,1, 1\\,]$, $N - Z = 2$, and $L = 2$ also spans the full space; exact centroid and width follow.\n- Case $3$ with $\\Delta = [\\,10.0\\,]$, $w = [\\,4\\,]$, $N - Z = 4$, and $L = 5$ truncates to one dimension immediately; the centroid is $10.0$ MeV and the width is $0.0$ MeV.\n- Case $4$ with $\\Delta = [\\,1.0, 2.0\\,]$, $w = [\\,0, 0\\,]$, $N - Z = 0$, has no strength; by convention, the centroid and width are both $0.0$ MeV, and the sum-rule check is $\\mathrm{True}$.\n- Case $5$ with $\\Delta = [\\,1.0, 4.0, 9.0, 16.0\\,]$, $w = [\\,2, 1, 3, 2\\,]$, $N - Z = 8$, and $L = 1$ demonstrates that with a single Lanczos iteration the centroid is exact while the width collapses to $0.0$ MeV, illustrating the Gaussian quadrature truncation effect.\n\nThe program implements these steps and prints a single line containing a list of per-case results $[\\,\\mathrm{boolean}, E_{\\mathrm{c}}, \\sigma\\,]$, where $E_{\\mathrm{c}}$ and $\\sigma$ are in mega-electron volts (MeV).", "answer": "```python\nimport numpy as np\n\ndef lanczos_tridiagonal(diag_energies, v0, max_iters, tol=1e-14, reorth=True):\n    \"\"\"\n    Perform Lanczos tridiagonalization for a diagonal Hamiltonian H=diag(diag_energies).\n    Args:\n        diag_energies: numpy array of shape (K,), energies Δ_j (MeV).\n        v0: initial normalized vector of shape (K,).\n        max_iters: maximum Lanczos iterations L.\n        tol: threshold for early termination if beta becomes too small.\n        reorth: if True, perform full reorthogonalization against previous vectors.\n    Returns:\n        alphas: list of diagonal entries of T\n        betas: list of off-diagonal entries of T (length len(alphas)-1)\n        V: list of Lanczos vectors (each numpy array)\n    \"\"\"\n    K = diag_energies.shape[0]\n    assert v0.shape == (K,)\n    # Normalize v0 just in case\n    nrm = np.linalg.norm(v0)\n    if nrm == 0.0:\n        return [], [], []\n    v0 = v0 / nrm\n\n    V = []\n    alphas = []\n    betas = []\n\n    v_prev = np.zeros_like(v0)\n    v = v0.copy()\n\n    for it in range(max_iters):\n        # w = H v\n        w = diag_energies * v\n        alpha = float(np.dot(v, w))\n        w = w - alpha * v\n        if it > 0:\n            w = w - betas[-1] * v_prev\n\n        if reorth and len(V) > 0:\n            # Full reorthogonalization against all previous Lanczos vectors\n            for vk in V:\n                coeff = float(np.dot(vk, w))\n                w -= coeff * vk\n\n        beta = float(np.linalg.norm(w))\n        V.append(v.copy())\n        alphas.append(alpha)\n        if beta < tol:\n            break\n        betas.append(beta)\n        v_prev = v\n        v = w / beta\n\n    return alphas, betas, V\n\ndef gauss_quadrature_moments_from_tridiagonal(alphas, betas, m0):\n    \"\"\"\n    Given tridiagonal parameters, compute approximate moments m1 and m2 using Gauss quadrature.\n    Args:\n        alphas: list of diagonal entries of T\n        betas: list of off-diagonal entries of T\n        m0: zeroth moment (norm squared of b)\n    Returns:\n        m1_approx, m2_approx\n    \"\"\"\n    n = len(alphas)\n    if n == 0 or m0 == 0.0:\n        return 0.0, 0.0\n    # Build symmetric tridiagonal T\n    T = np.zeros((n, n), dtype=float)\n    for i in range(n):\n        T[i, i] = alphas[i]\n    for i in range(n - 1):\n        T[i, i + 1] = betas[i]\n        T[i + 1, i] = betas[i]\n    # Eigen-decomposition\n    evals, evecs = np.linalg.eigh(T)\n    # Weights are squares of first row components of eigenvectors (component index 0)\n    weights = (evecs[0, :] ** 2).astype(float)\n    # Approximate moments\n    m1 = m0 * float(np.dot(weights, evals))\n    m2 = m0 * float(np.dot(weights, evals**2))\n    return m1, m2\n\ndef compute_case(energies, weights, N, Z, L):\n    \"\"\"\n    Compute sum-rule verification, centroid, and width for one case.\n    Args:\n        energies: list or array of Δ_j (MeV)\n        weights: list or array of w_j (nonnegative integers)\n        N, Z: neutron and proton numbers (integers)\n        L: number of Lanczos iterations (integer)\n    Returns:\n        (bool_sumrule_ok, centroid_MeV, width_MeV)\n    \"\"\"\n    energies = np.array(energies, dtype=float)\n    weights = np.array(weights, dtype=float)\n    # Build b vector with components sqrt(w_j)\n    b = np.sqrt(weights)\n    m0 = float(np.dot(b, b))  # sum of weights\n    sumrule_target = float(N - Z)\n    sumrule_ok = abs(m0 - sumrule_target) < 1e-12\n\n    if m0 == 0.0:\n        # No strength in the restricted channel\n        return [sumrule_ok, 0.0, 0.0]\n\n    # Normalized pivot\n    v0 = b / np.sqrt(m0)\n    # Lanczos\n    alphas, betas, _ = lanczos_tridiagonal(energies, v0, max_iters=int(L), tol=1e-14, reorth=True)\n    # If no steps returned (should not happen with m0>0), fall back to exact moments\n    if len(alphas) == 0:\n        m1 = float(np.dot(weights, energies))\n        m2 = float(np.dot(weights, energies**2))\n    else:\n        m1, m2 = gauss_quadrature_moments_from_tridiagonal(alphas, betas, m0)\n\n    # Centroid and width\n    centroid = m1 / m0\n    variance = m2 / m0 - centroid**2\n    # Numerical safeguard for tiny negative due to roundoff\n    if variance < 0 and variance > -1e-12:\n        variance = 0.0\n    width = float(np.sqrt(variance)) if variance >= 0 else float('nan')\n\n    return [sumrule_ok, float(centroid), float(width)]\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each case: (energies Δ_j in MeV, weights w_j, N, Z, L)\n    test_cases = [\n        ([1.0, 3.0, 7.0], [1, 1, 1], 7, 4, 3),\n        ([2.0, 5.0], [1, 1], 8, 6, 2),\n        ([10.0], [4], 12, 8, 5),\n        ([1.0, 2.0], [0, 0], 5, 5, 2),\n        ([1.0, 4.0, 9.0, 16.0], [2, 1, 3, 2], 13, 5, 1),\n    ]\n\n    results = []\n    for energies, weights, N, Z, L in test_cases:\n        result = compute_case(energies, weights, N, Z, L)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "3546731"}, {"introduction": "While the ideal Fermi matrix element $M_F$ is fixed by isospin symmetry, real-world interactions break this symmetry and modify its value. This practice illuminates the primary mechanism behind these corrections—isospin mixing—by modeling it within a simple and exactly solvable two-level quantum system [@problem_id:3546691]. You will contrast the exact solution with the widely used linear-response approximation, developing a quantitative intuition for how isospin impurities reduce the transition strength and learning to identify the limits of perturbation theory.", "problem": "You are tasked with developing a computational model to quantify how an isospin-breaking one-body potential modifies the Fermi matrix element in a minimal, yet physically consistent, many-body isospin framework. Consider a nucleus with isospin-symmetric dynamics that, in the absence of isospin-breaking, has a well-defined isobaric analog state (IAS) with total isospin $T = 1$ and projection $T_z$. Let the Fermi transition operator be $\\hat{T}^+ = \\sum_i \\tau_i^+$, where $\\tau_i^+$ raises the isospin of nucleon $i$. Introduce an isospin-breaking one-body potential of the form $\\Delta V = \\sum_{i=1}^N v_i \\tau_i^z$, where $v_i$ are strengths with units of energy. Assume that the strong-interaction part of the Hamiltonian is isospin symmetric and produces two relevant states in the $T_z=0$ subspace: a $T=1$, $T_z=0$ state with energy $E_1$ and a nearby $T=0$, $T_z=0$ state with energy $E_0$. The potential $\\Delta V$ connects these two states through an isovector coupling.\n\nStarting from standard isospin algebra and many-body quantum mechanics, derive a reduced two-level Hamiltonian description in the $\\{\\,|T=1,T_z=0\\rangle,\\,|T=0,T_z=0\\rangle\\,\\}$ basis with an off-diagonal coupling that is linear in the combined strength $G = \\sum_i w_i v_i$, where $w_i$ are known dimensionless structure coefficients encoding the single-particle density overlaps relevant to the isovector coupling. Let the off-diagonal coupling be proportional to $G$ with a dimensionless proportionality constant $\\kappa$, and define the energy spacing $\\Delta E = E_0 - E_1 > 0$. By diagonalizing this two-level Hamiltonian, derive the mixing angle $\\theta(G)$ that quantifies the admixture of $|T=0,T_z=0\\rangle$ into the physical final state $|f\\rangle$ for $T_z=0$. Then, using the definition of the Fermi transition operator, express the Fermi matrix element $M_F(G) = \\langle f|\\hat{T}^+|i\\rangle$ for the transition from the initial pure IAS $|i\\rangle = |T = 1, T_z = -1\\rangle$ to the mixed final state $|f\\rangle$ in terms of the mixing angle, using standard angular-momentum coupling rules for isospin.\n\nDefine the linear-response approximation to the mixing angle, $\\theta_{\\mathrm{lin}}(G)$, as obtained from first-order perturbation theory in the isospin-breaking coupling. Your computational task is to implement a program that, for a family of scaled isospin-breaking strengths $v_i(s) = s\\,u_i$ with a dimensionless direction vector $u_i$, scans the amplitude $s$ and identifies the boundary amplitude $s_c$ (in $\\mathrm{MeV}$) where the deviation of the exact mixing angle from its linear approximation first exceeds a specified relative tolerance $\\varepsilon$ according to the criterion\n$$\n\\left|\\frac{\\theta\\big(G(s)\\big)}{\\theta_{\\mathrm{lin}}\\big(G(s)\\big)} - 1\\right| \\ge \\varepsilon,\n$$\nwith the understanding that if $G(s) = 0$ for all $s$ then no mixing occurs and the boundary amplitude should be reported as $0.0$ in $\\mathrm{MeV}$. Angles must be treated in radians.\n\nImplement the above as a complete, runnable program that:\n- Accepts no input and uses the test suite below.\n- For each test case, computes $G(s) = \\sum_i w_i v_i(s) = s \\sum_i w_i u_i$, then determines $s_c$ by scanning $s$ in the interval $[0, s_{\\max}]$ and identifying the smallest $s$ where the criterion is satisfied. If the criterion is not satisfied anywhere in $[0, s_{\\max}]$, report $s_c = s_{\\max}$. If $G(s)$ is identically zero, report $s_c = 0.0$.\n- Produces a single line of output with the boundary amplitudes for all test cases as a comma-separated list in square brackets. Express each amplitude in $\\mathrm{MeV}$, rounded to six decimal places.\n\nUse the following test suite:\n- Case A (general regime): $N=4$, $\\Delta E = 2.0\\,\\mathrm{MeV}$, $\\kappa = 0.8$, $w_i = [1.0, 0.8, 1.2, 0.9]$, $u_i = [1.0, 1.0, 1.0, 1.0]$, $s_{\\max} = 2.0\\,\\mathrm{MeV}$, $\\varepsilon = 0.05$.\n- Case B (near-degenerate states): $N=4$, $\\Delta E = 0.2\\,\\mathrm{MeV}$, $\\kappa = 0.5$, $w_i = [1.0, 0.8, 1.2, 0.9]$, $u_i = [1.0, 1.0, 1.0, 1.0]$, $s_{\\max} = 2.0\\,\\mathrm{MeV}$, $\\varepsilon = 0.05$.\n- Case C (balanced couplings, zero net isovector strength): $N=4$, $\\Delta E = 3.0\\,\\mathrm{MeV}$, $\\kappa = 0.6$, $w_i = [1.0, 1.0, -1.0, -1.0]$, $u_i = [1.0, 1.0, 1.0, 1.0]$, $s_{\\max} = 2.0\\,\\mathrm{MeV}$, $\\varepsilon = 0.05$.\n- Case D (mixed-sign structure): $N=4$, $\\Delta E = 5.0\\,\\mathrm{MeV}$, $\\kappa = 1.0$, $w_i = [1.0, -0.4, 0.3, 0.1]$, $u_i = [2.0, 0.5, -1.0, 1.5]$, $s_{\\max} = 5.0\\,\\mathrm{MeV}$, $\\varepsilon = 0.05$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[r_1,r_2,r_3,r_4]$), where each $r_k$ is the boundary amplitude $s_c$ for the corresponding test case in $\\mathrm{MeV}$, rounded to six decimal places.", "solution": "The user-provided problem has been analyzed and is determined to be **valid**. It is a self-contained, scientifically grounded, and well-posed problem in computational nuclear physics that can be solved using standard principles of quantum mechanics.\n\n### Theoretical Derivation\n\nThe problem requires us to analyze a two-level quantum system subject to a mixing interaction. The system is described in a basis of two isospin states in the $T_z=0$ subspace: $|1\\rangle \\equiv |T=1, T_z=0\\rangle$ and $|0\\rangle \\equiv |T=0, T_z=0\\rangle$.\n\n**1. The Two-Level Hamiltonian**\n\nThe total Hamiltonian is $H = H_0 + \\Delta V$. The isospin-symmetric part $H_0$ is diagonal in the chosen basis, with eigenvalues $E_1$ for $|1\\rangle$ and $E_0$ for $|0\\rangle$. The isospin-breaking potential is $\\Delta V = \\sum_i v_i \\tau_i^z$. Due to the properties of the $\\tau^z$ operator (specifically, the Wigner-Eckart theorem for a rank-1 tensor operator), its diagonal matrix elements in the $T_z=0$ subspace are zero: $\\langle 1|\\Delta V|1\\rangle = \\langle 0|\\Delta V|0\\rangle = 0$.\n\nThe off-diagonal matrix element is given as $\\langle 0|\\Delta V|1\\rangle = \\kappa G$, where $G = \\sum_i w_i v_i$ is the combined strength of the isospin-breaking potential. Since $\\Delta V$ is Hermitian, $\\langle 1|\\Delta V|0\\rangle = (\\kappa G)^*$. Assuming all parameters are real, this is also $\\kappa G$.\n\nThe Hamiltonian in the $\\{|1\\rangle, |0\\rangle\\}$ basis is:\n$$\nH = \\begin{pmatrix} E_1 & \\kappa G \\\\ \\kappa G & E_0 \\end{pmatrix}\n$$\nIt is convenient to shift the energy origin to the average energy $(E_1+E_0)/2$ and use the energy spacing $\\Delta E = E_0 - E_1 > 0$. The effective Hamiltonian becomes:\n$$\nH = \\begin{pmatrix} -\\Delta E/2 & \\kappa G \\\\ \\kappa G & \\Delta E/2 \\end{pmatrix}\n$$\n\n**2. Exact Mixing Angle $\\theta(G)$**\n\nWe diagonalize this Hamiltonian to find the mixed eigenstates. The physical final state $|f\\rangle$ is the one that evolves from the unperturbed state $|1\\rangle$, which is the lower-energy state of the pair. The lower-energy eigenstate of $H$ can be written as:\n$$\n|f\\rangle = \\cos\\theta |1\\rangle + \\sin\\theta |0\\rangle\n$$\nThe tangent of the mixing angle $\\theta$ is the ratio of the coefficients, which can be found from the eigenvector equation. A standard result for a two-level system gives:\n$$\n\\tan(\\theta) = \\frac{\\lambda_- - H_{11}}{H_{12}} = \\frac{-\\sqrt{(\\Delta E/2)^2 + (\\kappa G)^2} - (-\\Delta E/2)}{\\kappa G} = \\frac{\\Delta E/2 - \\sqrt{(\\Delta E/2)^2 + (\\kappa G)^2}}{\\kappa G}\n$$\nThis expression is numerically unstable for small $G$. Multiplying the numerator and denominator by the conjugate of the numerator yields a stable form:\n$$\n\\tan(\\theta) = \\frac{(\\kappa G)^2}{(\\kappa G) \\left( \\Delta E/2 + \\sqrt{(\\Delta E/2)^2 + (\\kappa G)^2} \\right)} = \\frac{\\kappa G}{\\Delta E/2 + \\sqrt{(\\Delta E/2)^2 + (\\kappa G)^2}}\n$$\nThe mixing angle $\\theta$ is explicitly given in radians by:\n$$\n\\theta(G) = \\arctan\\left( \\frac{\\kappa G}{\\Delta E/2 + \\sqrt{(\\Delta E/2)^2 + (\\kappa G)^2}} \\right)\n$$\n\n**3. Linear-Response Approximation $\\theta_{\\mathrm{lin}}(G)$**\n\nThe linear-response approximation is obtained from first-order perturbation theory. The perturbed state is:\n$$\n|f\\rangle \\approx |1\\rangle + \\frac{\\langle 0 | \\Delta V | 1 \\rangle}{E_1 - E_0} |0\\rangle = |1\\rangle + \\frac{\\kappa G}{-\\Delta E} |0\\rangle\n$$\nIn the small-angle approximation, $|f\\rangle \\approx |1\\rangle + \\theta |0\\rangle$. Comparing these forms, we identify the linear approximation to the mixing angle as the admixture coefficient:\n$$\n\\theta_{\\mathrm{lin}}(G) = -\\frac{\\kappa G}{\\Delta E}\n$$\nThe problem seeks a deviation based on a ratio, so the sign difference between the exact and linear definitions of the angle is not crucial, as the criterion uses an absolute value. However, to maintain consistency, we define our angles to be of the same sign. From the expression for $\\tan(\\theta)$, we see that for small $G$, $\\tan(\\theta) \\approx \\frac{\\kappa G}{\\Delta E/2 + \\Delta E/2} = \\frac{\\kappa G}{\\Delta E}$. Since $\\theta \\approx \\tan(\\theta)$ for small angles, this naturally leads to $\\theta_{\\mathrm{lin}}(G) = \\frac{\\kappa G}{\\Delta E}$. We will adopt this form.\n\n**4. The Computational Task**\n\nThe goal is to find the smallest amplitude $s_c > 0$ for the scaled potential $v_i(s) = s u_i$ where the criterion\n$$\n\\left|\\frac{\\theta\\big(G(s)\\big)}{\\theta_{\\mathrm{lin}}\\big(G(s)\\big)} - 1\\right| \\ge \\varepsilon\n$$\nis met. Here, $G(s) = s \\sum_i w_i u_i$. Let $C_G = \\sum_i w_i u_i$.\n\nThe function describing the relative deviation is:\n$$\nD(s) = \\left| \\frac{\\arctan\\left( \\frac{\\kappa s C_G}{\\Delta E/2 + \\sqrt{(\\Delta E/2)^2 + (\\kappa s C_G)^2}} \\right)}{\\kappa s C_G / \\Delta E} - 1 \\right|\n$$\nThis function $D(s)$ is monotonically increasing for $s \\ge 0$. We must find the value $s_c \\in [0, s_{\\max}]$ such that $D(s_c) = \\varepsilon$. This is a root-finding problem for the function $f(s) = D(s) - \\varepsilon = 0$.\n\n**5. Numerical Algorithm**\n\nGiven the monotonic nature of $D(s)$, the bisection method is an efficient and robust algorithm for finding $s_c$.\n1.  For each test case, calculate the structural constant $C_G = \\sum_i w_i u_i$.\n2.  If $C_G = 0$, then $G(s)=0$ for all $s$. No mixing occurs. The deviation is always $0$. As specified, $s_c=0.0$.\n3.  Evaluate the deviation at the maximum amplitude, $D(s_{\\max})$. If $D(s_{\\max}) < \\varepsilon$, the criterion is never met in the interval, so we report $s_c = s_{\\max}$.\n4.  Otherwise, a unique root $s_c$ exists in $(0, s_{\\max})$. We use a bisection search on the interval $[0, s_{\\max}]$ to find the value of $s$ where $D(s)=\\varepsilon$. The search proceeds by repeatedly narrowing the interval $[L, R]$ until its width is below a desired precision, yielding the value of $s_c$.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the boundary amplitude s_c for a set of test cases based on a \n    two-level quantum mechanical model of isospin mixing.\n    \"\"\"\n\n    class TestCase:\n        \"\"\"A helper class to hold test case parameters for clarity.\"\"\"\n        def __init__(self, N, Delta_E, kappa, w, u, s_max, epsilon):\n            self.N = N\n            self.Delta_E = Delta_E  # MeV\n            self.kappa = kappa\n            self.w = np.array(w)\n            self.u = np.array(u)\n            self.s_max = s_max      # MeV\n            self.epsilon = epsilon\n            # C_G is the combined dimensionless structure factor\n            self.C_G = np.sum(self.w * self.u)\n\n    def calculate_deviation(s, case):\n        \"\"\"\n        Calculates the relative deviation of the exact mixing angle from its\n        linear approximation for a given amplitude s.\n        \n        The deviation is defined as |theta_exact/theta_lin - 1|.\n        \"\"\"\n        # If amplitude is zero, G is zero, and there is no mixing/deviation.\n        if s == 0.0:\n            return 0.0\n\n        # The combined isospin-breaking strength G(s)\n        G = s * case.C_G\n        \n        # If G is zero (due to C_G being zero), there is no mixing.\n        if G == 0.0:\n            return 0.0\n\n        # Linear-response approximation for the mixing angle (in radians)\n        theta_lin = case.kappa * G / case.Delta_E\n\n        # Exact mixing angle (in radians) derived from diagonalizing the 2x2 Hamiltonian.\n        # tan(theta) = (kappa*G) / (sqrt((DeltaE/2)^2 + (kappa*G)^2) + DeltaE/2)\n        # This form is numerically stable for small G.\n        kappa_G = case.kappa * G\n        arg_tan = kappa_G / (np.sqrt((case.Delta_E / 2.0)**2 + kappa_G**2) + case.Delta_E / 2.0)\n        theta_exact = np.arctan(arg_tan)\n\n        # For G != 0, theta_lin is also non-zero, so the division is safe.\n        deviation = np.abs(theta_exact / theta_lin - 1.0)\n        \n        return deviation\n\n    def find_boundary_amplitude(case):\n        \"\"\"\n        Finds the boundary amplitude s_c for a given test case using bisection search.\n        \"\"\"\n        # Special case: If the net isovector strength G(s) is identically zero,\n        # there is no isospin mixing, and s_c is defined as 0.0.\n        if case.C_G == 0.0:\n            return 0.0\n\n        # Check if the criterion is met at the maximum amplitude s_max.\n        # If not, the boundary is s_max itself.\n        dev_at_s_max = calculate_deviation(case.s_max, case)\n        if dev_at_s_max < case.epsilon:\n            return case.s_max\n\n        # Use bisection method to find s_c where deviation(s_c) = epsilon.\n        # We are finding the root of f(s) = calculate_deviation(s) - epsilon.\n        low = 0.0\n        high = case.s_max\n        \n        # 100 iterations are more than sufficient for double precision convergence.\n        for _ in range(100):\n            mid = (low + high) / 2.0\n            # If the interval is too small to bisect further, stop.\n            if mid == low or mid == high:\n                break\n            \n            # The deviation function is monotonic, so we can guide the search.\n            if calculate_deviation(mid, case) < case.epsilon:\n                # The deviation is still too small, so s_c must be larger.\n                low = mid\n            else:\n                # The deviation has exceeded epsilon, s_c is at or below mid.\n                high = mid\n                \n        # The root is at `high` (or `low`, they are very close).\n        return high\n\n    # Define the test cases from the problem statement.\n    test_cases_data = [\n        # Case A: General regime\n        {'N': 4, 'Delta_E': 2.0, 'kappa': 0.8, 'w': [1.0, 0.8, 1.2, 0.9], 'u': [1.0, 1.0, 1.0, 1.0], 's_max': 2.0, 'epsilon': 0.05},\n        # Case B: Near-degenerate states\n        {'N': 4, 'Delta_E': 0.2, 'kappa': 0.5, 'w': [1.0, 0.8, 1.2, 0.9], 'u': [1.0, 1.0, 1.0, 1.0], 's_max': 2.0, 'epsilon': 0.05},\n        # Case C: Balanced couplings, zero net isovector strength\n        {'N': 4, 'Delta_E': 3.0, 'kappa': 0.6, 'w': [1.0, 1.0, -1.0, -1.0], 'u': [1.0, 1.0, 1.0, 1.0], 's_max': 2.0, 'epsilon': 0.05},\n        # Case D: Mixed-sign structure\n        {'N': 4, 'Delta_E': 5.0, 'kappa': 1.0, 'w': [1.0, -0.4, 0.3, 0.1], 'u': [2.0, 0.5, -1.0, 1.5], 's_max': 5.0, 'epsilon': 0.05},\n    ]\n\n    test_cases = [TestCase(**data) for data in test_cases_data]\n    \n    results = []\n    for case in test_cases:\n        s_c = find_boundary_amplitude(case)\n        # Format the result to six decimal places.\n        results.append(f\"{s_c:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "3546691"}, {"introduction": "No-Core Shell Model (NCSM) calculations are at the forefront of *ab initio* nuclear theory, but their reliance on a finite harmonic oscillator basis introduces a significant computational artifact. This exercise confronts the critical challenge of center-of-mass (CM) contamination, where unphysical CM motion mixes with the intrinsic nuclear structure [@problem_id:3546717]. By building a simplified two-nucleon model, you will directly observe how this spurious mixing violates isospin symmetry, reduces the Fermi matrix element, and test the effectiveness of standard remedies like the Lawson term.", "problem": "You are asked to derive, implement, and test a computational model that quantifies how the breaking of center-of-mass factorization impacts the Fermi matrix element in the No-Core Shell Model (NCSM), and to assess the effectiveness of remedies based on the center-of-mass Hamiltonian constraint and Lawson-term penalization. The objective is to compute the deviation of the Fermi matrix element due to center-of-mass contamination and demonstrate how different remedies restore the expected value.\n\nBegin from the following foundational base and definitions:\n\n- In a harmonic oscillator representation for a two-nucleon system with equal masses, the total Hamiltonian separates into intrinsic and center-of-mass parts when translational invariance holds. Let $x_1$ and $x_2$ denote the particle coordinates in one spatial dimension, with the center-of-mass coordinate $X = \\frac{x_1 + x_2}{2}$ and the relative coordinate $x = x_1 - x_2$. For equal masses $m$ and angular frequency $\\omega$, the center-of-mass mass is $M = 2m$ and the reduced mass is $\\mu = \\frac{m}{2}$.\n- The center-of-mass Hamiltonian is $H_{\\mathrm{cm}} = \\frac{P^2}{2M} + \\frac{1}{2} M \\omega^2 X^2$, and the intrinsic Hamiltonian is $H_{\\mathrm{int}} = \\frac{p^2}{2\\mu} + \\frac{1}{2} \\mu \\omega^2 x^2$, where $P$ and $p$ are the respective conjugate momenta.\n- The Fermi matrix element $M_F$ is defined by the sum of isospin-raising operators acting on all nucleons, $F = \\sum_{i=1}^A \\tau_i^+$, and connects isobaric analog states. For a two-nucleon system in a pure isospin triplet $T=1$ with projection change $\\Delta M_T = +1$, the ideal value is $M_F = \\sqrt{2}$ if the spatial parts of the initial and final states are identical and center-of-mass factorization holds.\n- Breaking center-of-mass factorization can be modeled by adding a weak coupling between $X$ and $x$ to the Hamiltonian, which correlates center-of-mass and intrinsic motions. Introduce a coupling $H_{\\mathrm{coup}} = \\alpha X x$ with a small real parameter $\\alpha$. The total Hamiltonian to diagonalize is $H = H_{\\mathrm{cm}} + H_{\\mathrm{int}} + H_{\\mathrm{coup}}$.\n- Remedies include constraining the center-of-mass state to the $n_{\\mathrm{cm}} = 0$ subspace (a hard constraint emulating $H_{\\mathrm{cm}}$ minimization) or adding a Lawson term, which penalizes center-of-mass excitations by $H \\mapsto H + \\beta H_{\\mathrm{cm}}$, with $\\beta > 0$.\n\nRepresentation and computational setup:\n\n- Work in units where $\\hbar = 1$, $m = 1$, and $\\omega = 1$. Energies are thus in units of $\\hbar\\omega$.\n- Use a product basis of harmonic oscillator eigenstates for center-of-mass and relative motion, $\\{|N\\rangle_{\\mathrm{cm}} \\otimes |n\\rangle_{\\mathrm{rel}}\\}$, where $N = 0,\\dots,N_{\\mathrm{cm}}^{\\max}$ and $n = 0,\\dots,N_{\\mathrm{rel}}^{\\max}$. The uncoupled Hamiltonian has eigenvalues $E_{N,n} = \\omega \\left(N + \\tfrac{1}{2}\\right) + \\omega \\left(n + \\tfrac{1}{2}\\right)$.\n- The position operators in one dimension have matrix elements in the harmonic oscillator basis given by $X = x_{\\mathrm{cm}} \\left(\\sqrt{N+1} |N\\rangle \\langle N+1| + \\sqrt{N} |N\\rangle \\langle N-1|\\right)$ and $x = x_{\\mathrm{rel}} \\left(\\sqrt{n+1} |n\\rangle \\langle n+1| + \\sqrt{n} |n\\rangle \\langle n-1|\\right)$, with $x_{\\mathrm{cm}} = \\sqrt{\\frac{1}{2 M \\omega}}$ and $x_{\\mathrm{rel}} = \\sqrt{\\frac{1}{2 \\mu \\omega}}$. In these units, $M = 2$, $\\mu = \\tfrac{1}{2}$, thus $x_{\\mathrm{cm}} = \\tfrac{1}{2}$ and $x_{\\mathrm{rel}} = 1$.\n- The coupling $H_{\\mathrm{coup}} = \\alpha X x$ thus connects states with $(N,n) \\to (N\\pm 1, n \\pm 1)$.\n\nIsospin structure and evaluation of $M_F$:\n\n- Consider three isospin sectors labeled by spatial states associated with $|pp\\rangle$, $|pn\\rangle$, and $|np\\rangle$. Construct the initial isospin-symmetric state $|i\\rangle = \\frac{1}{\\sqrt{2}}\\left(|pn\\rangle + |np\\rangle\\right)$ with respective spatial parts $\\phi_{pn}(X,x)$ and $\\phi_{np}(X,x)$, and the final state $|f\\rangle = |pp\\rangle$ with spatial part $\\phi_{pp}(X,x)$.\n- The Fermi operator $F$ acts only on the isospin part, mapping $|pn\\rangle \\mapsto |pp\\rangle$ and $|np\\rangle \\mapsto |pp\\rangle$. The reduced Fermi matrix element thus becomes\n$$\nM_F = \\frac{1}{\\sqrt{2}} \\left( \\langle \\phi_{pp} | \\phi_{pn} \\rangle + \\langle \\phi_{pp} | \\phi_{np} \\rangle \\right),\n$$\nwhere each inner product is computed over the product basis of center-of-mass and relative harmonic oscillator states.\n- Center-of-mass contamination is quantified by the expectation value $\\langle H_{\\mathrm{cm}} \\rangle$ in each sector’s ground state; in the ideal factorized case it equals $\\tfrac{1}{2}$ in these units.\n\nComputational tasks:\n\n1. For each isospin sector ($pp$, $pn$, $np$), build $H = H_{\\mathrm{cm}} + H_{\\mathrm{int}} + H_{\\mathrm{coup}} + \\beta H_{\\mathrm{cm}}$ with the specified $(\\alpha,\\beta)$ and sector-specific center-of-mass truncations $N_{\\mathrm{cm}}^{\\max}$ and a common relative truncation $N_{\\mathrm{rel}}^{\\max}$.\n2. Diagonalize $H$ to obtain the normalized ground-state spatial vector $\\phi_{\\mathrm{sector}}$ in the sector’s product basis. Embed each sector’s ground state into a common “superspace” basis determined by $N_{\\mathrm{cm}}^{\\sup} = \\max\\{N_{\\mathrm{cm},pp}^{\\max}, N_{\\mathrm{cm},pn}^{\\max}, N_{\\mathrm{cm},np}^{\\max}\\}$ and the common $N_{\\mathrm{rel}}^{\\max}$ by zero-padding missing components.\n3. Compute $M_F$ by the formula above using the embedded states, and compute the average center-of-mass contamination defined as the arithmetic mean of $\\langle H_{\\mathrm{cm}} \\rangle$ in the $pp$, $pn$, and $np$ sectors.\n4. Express energies in units of $\\hbar\\omega$ and the Fermi matrix element as a dimensionless number.\n\nTest suite:\n\nImplement the following five test cases, each specified by the tuple $\\{N_{\\mathrm{cm},pp}^{\\max}, N_{\\mathrm{cm},pn}^{\\max}, N_{\\mathrm{cm},np}^{\\max}, N_{\\mathrm{rel}}^{\\max}, \\alpha, \\beta\\}$:\n\n- Case 1 (ideal factorization baseline): $\\{3,3,3,6,0.0,0.0\\}$.\n- Case 2 (broken factorization via coupling and mismatched truncations): $\\{1,1,2,6,0.2,0.0\\}$.\n- Case 3 (hard $H_{\\mathrm{cm}}$ constraint remedy, center-of-mass frozen): $\\{0,0,0,6,0.2,0.0\\}$.\n- Case 4 (Lawson-term remedy): $\\{3,3,3,6,0.2,5.0\\}$.\n- Case 5 (strong coupling, mismatched truncations): $\\{1,2,3,6,0.5,0.0\\}$.\n\nRequired outputs and format:\n\n- For each case, compute two floats: the Fermi matrix element $M_F$ and the average center-of-mass energy $\\overline{\\langle H_{\\mathrm{cm}} \\rangle}$ across the three sectors, both in the units specified above.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order\n$$\n[M_F^{(1)}, \\overline{\\langle H_{\\mathrm{cm}} \\rangle}^{(1)}, M_F^{(2)}, \\overline{\\langle H_{\\mathrm{cm}} \\rangle}^{(2)}, \\dots, M_F^{(5)}, \\overline{\\langle H_{\\mathrm{cm}} \\rangle}^{(5)}].\n$$\n\nAngles are not used in this problem. No percentages are used; all computations are performed in the specified units with outputs as decimal floats.", "solution": "The problem asks for a computational analysis of center-of-mass (CM) factorization breaking in a simplified two-nucleon system and the effectiveness of common remedies. This is a quintessential problem in the No-Core Shell Model (NCSM), where wavefunctions are constructed in a basis of harmonic oscillator (HO) states. Unless handled carefully, the finite truncation of this basis breaks the translational invariance of the nuclear Hamiltonian, leading to spurious mixing of the intrinsic motion of nucleons with the motion of their center-of-mass. This contamination affects the calculation of observables, including the Fermi matrix element $M_F$ for beta decay, which should be protected by isospin symmetry. We will construct the Hamiltonian matrix for the system, diagonalize it to find the ground state wavefunctions, and then compute the Fermi matrix element $M_F$ and the expectation value of the CM Hamiltonian, $\\langle H_{\\mathrm{cm}} \\rangle$, to quantify the contamination and the success of the remedies.\n\n**1. Theoretical Framework: Hamiltonian and Basis States**\n\nWe model a two-nucleon system in one dimension using a harmonic oscillator basis. The units are set such that $\\hbar = 1$, the nucleon mass $m = 1$, and the oscillator frequency $\\omega = 1$. Consequently, the center-of-mass mass is $M = 2m = 2$ and the reduced mass is $\\mu = m/2 = 1/2$.\n\nThe total Hamiltonian $H$ is a sum of four components: the intrinsic Hamiltonian $H_{\\mathrm{int}}$, the center-of-mass Hamiltonian $H_{\\mathrm{cm}}$, a coupling term $H_{\\mathrm{coup}}$ modeling the factorization breaking, and a Lawson penalty term $H_{\\mathrm{Lawson}}$ used as a remedy.\n$$\nH = H_{\\mathrm{int}} + H_{\\mathrm{cm}} + H_{\\mathrm{coup}} + H_{\\mathrm{Lawson}}\n$$\nSubstituting the given definitions, this becomes:\n$$\nH = H_{\\mathrm{int}} + (1+\\beta) H_{\\mathrm{cm}} + \\alpha X x\n$$\nwhere $\\alpha$ is the coupling strength parameter and $\\beta$ is the Lawson penalty parameter.\n\nThe problem is solved within a truncated product basis of HO eigenstates for the relative ($n$) and CM ($N$) motion: $\\{|N\\rangle_{\\mathrm{cm}} \\otimes |n\\rangle_{\\mathrm{rel}}\\}$, which we denote as $|N, n\\rangle$. The basis is truncated at maximum quantum numbers $N_{\\mathrm{cm}}^{\\max}$ and $N_{\\mathrm{rel}}^{\\max}$.\n\n**2. Matrix Representation of the Hamiltonian**\n\nWe construct the matrix representation of $H$ in the $|N, n\\rangle$ basis. A pair of indices $(N, n)$ can be mapped to a single matrix index $k$.\n\n- **Intrinsic and Center-of-Mass Hamiltonians ($H_{\\mathrm{int}}, H_{\\mathrm{cm}}$):** These operators are diagonal in the chosen basis. Their eigenvalues in the specified units ($\\omega=1$) are $E_{\\mathrm{int}} = n + \\frac{1}{2}$ and $E_{\\mathrm{cm}} = N + \\frac{1}{2}$. Their matrix elements are:\n$$\n\\langle N', n' | H_{\\mathrm{int}} | N, n \\rangle = \\left(n + \\frac{1}{2}\\right) \\delta_{N'N} \\delta_{n'n}\n$$\n$$\n\\langle N', n' | (1+\\beta) H_{\\mathrm{cm}} | N, n \\rangle = (1+\\beta)\\left(N + \\frac{1}{2}\\right) \\delta_{N'N} \\delta_{n'n}\n$$\n\n- **Coupling Hamiltonian ($H_{\\mathrm{coup}}$):** The term $H_{\\mathrm{coup}} = \\alpha X x$ is off-diagonal. The matrix elements of the position operators $X$ and $x$ are given by:\n$$\n\\langle K' | \\hat{O} | K \\rangle = \\sqrt{\\frac{\\hbar}{2m_O\\omega}} \\left( \\sqrt{K+1} \\delta_{K', K+1} + \\sqrt{K} \\delta_{K', K-1} \\right)\n$$\nwhere $\\hat{O}$ is the position operator with associated mass $m_O$. For the CM operator $X$, the mass is $M=2$, and for the relative operator $x$, the mass is $\\mu=1/2$. In our units, this gives prefactors $x_{\\mathrm{cm}} = \\sqrt{1/(2 \\cdot 2 \\cdot 1)} = 1/2$ and $x_{\\mathrm{rel}} = \\sqrt{1/(2 \\cdot 1/2 \\cdot 1)} = 1$. The matrix element for the coupling term is:\n$$\n\\langle N', n' | H_{\\mathrm{coup}} | N, n \\rangle = \\alpha \\langle N' | X | N \\rangle \\langle n' | x | n \\rangle\n$$\nThis element is non-zero only when $N' = N \\pm 1$ and $n' = n \\pm 1$. The specific values are, for instance:\n$$\n\\langle N+1, n+1 | H_{\\mathrm{coup}} | N, n \\rangle = \\alpha \\left(\\frac{1}{2}\\sqrt{N+1}\\right) \\left(1\\cdot\\sqrt{n+1}\\right) = \\frac{\\alpha}{2}\\sqrt{(N+1)(n+1)}\n$$\nThe other non-zero elements connecting $|N,n\\rangle$ to $|N\\pm 1, n \\pm 1\\rangle$ are derived similarly. The total Hamiltonian matrix is the sum of these component matrices.\n\n**3. Calculation of Ground States and Observables**\n\nFor each isospin sector ($pp$, $pn$, $np$), the corresponding Hamiltonian matrix $H_{\\mathrm{sector}}$ is constructed using the sector-specific truncation $N_{\\mathrm{cm, sector}}^{\\max}$ and the common $N_{\\mathrm{rel}}^{\\max}$. The matrix is then numerically diagonalized to find its eigenvalues and eigenvectors. The ground state, $\\phi_{\\mathrm{sector}}$, is the eigenvector corresponding to the lowest eigenvalue.\n\n- **Center-of-Mass Contamination:** The degree of CM contamination in a state $\\phi_{\\mathrm{sector}} = \\sum_{N,n} c_{N,n} |N,n\\rangle$ is quantified by the expectation value $\\langle H_{\\mathrm{cm}} \\rangle_{\\mathrm{sector}}$. Since the $H_{\\mathrm{cm}}$ operator is diagonal in our basis, this calculation is straightforward:\n$$\n\\langle H_{\\mathrm{cm}} \\rangle_{\\mathrm{sector}} = \\langle \\phi_{\\mathrm{sector}} | H_{\\mathrm{cm}} | \\phi_{\\mathrm{sector}} \\rangle = \\sum_{N,n} |c_{N,n}|^2 \\left(N + \\frac{1}{2}\\right)\n$$\nThe problem requires the arithmetic mean across the three sectors, $\\overline{\\langle H_{\\mathrm{cm}} \\rangle} = \\frac{1}{3} \\sum_{\\mathrm{sector} \\in \\{pp,pn,np\\}} \\langle H_{\\mathrm{cm}} \\rangle_{\\mathrm{sector}}$. In the ideal, uncoupled case, the ground state is $|0,0\\rangle$, for which $\\langle H_{\\mathrm{cm}} \\rangle = 1/2$. Deviations from $1/2$ indicate contamination.\n\n- **Fermi Matrix Element ($M_F$):** The Fermi matrix element is given by $M_F = \\frac{1}{\\sqrt{2}} ( \\langle \\phi_{pp} | \\phi_{pn} \\rangle + \\langle \\phi_{pp} | \\phi_{np} \\rangle )$. A complication arises because the ground states $\\phi_{pp}$, $\\phi_{pn}$, and $\\phi_{np}$ may be computed in bases with different CM truncations ($N_{\\mathrm{cm, pp}}^{\\max}$, $N_{\\mathrm{cm, pn}}^{\\max}$, $N_{\\mathrm{cm, np}}^{\\max}$). To compute the required overlaps, these state vectors must first be embedded into a common, larger basis, or \"superspace.\" This superspace is defined by the maximum of the individual CM truncations, $N_{\\mathrm{cm}}^{\\sup} = \\max_{\\mathrm{sector}}\\{N_{\\mathrm{cm, sector}}^{\\max}\\}$, and the common relative truncation, $N_{\\mathrm{rel}}^{\\max}$. A state vector from a smaller basis is embedded by padding it with zeros for the basis states that exist in the superspace but not in the original, smaller space. After embedding, all state vectors have the same dimension, and their overlap can be computed as a simple vector dot product. In the ideal case where all states are simply $|0,0\\rangle$, the overlaps are both $1$, yielding $M_F = \\frac{1}{\\sqrt{2}}(1+1) = \\sqrt{2}$. Deviations from $\\sqrt{2}$ indicate a loss of isospin symmetry, often due to CM artifacts.\n\n**4. Computational Workflow**\n\nThe overall algorithm proceeds as follows for each of the five test cases:\n1.  Define the parameters for the case: $\\{N_{\\mathrm{cm},pp}^{\\max}, N_{\\mathrm{cm},pn}^{\\max}, N_{\\mathrm{cm},np}^{\\max}, N_{\\mathrm{rel}}^{\\max}, \\alpha, \\beta\\}$.\n2.  Determine the dimensions of the common superspace: $N_{\\mathrm{cm}}^{\\sup} = \\max(N_{\\mathrm{cm},pp}^{\\max}, N_{\\mathrm{cm},pn}^{\\max}, N_{\\mathrm{cm},np}^{\\max})$.\n3.  For each isospin sector ($pp$, $pn$, $np$):\n    a. Construct the Hamiltonian matrix $H_{\\mathrm{sector}}$ of size $(N_{\\mathrm{cm, sector}}^{\\max}+1)(N_{\\mathrm{rel}}^{\\max}+1) \\times (N_{\\mathrm{cm, sector}}^{\\max}+1)(N_{\\mathrm{rel}}^{\\max}+1)$ using the matrix elements derived above.\n    b. Diagonalize $H_{\\mathrm{sector}}$ to obtain the ground state eigenvector $\\phi_{\\mathrm{sector}}$ and its corresponding eigenvalue.\n    c. Calculate $\\langle H_{\\mathrm{cm}} \\rangle_{\\mathrm{sector}}$ using the components of $\\phi_{\\mathrm{sector}}$.\n    d. Embed $\\phi_{\\mathrm{sector}}$ into the superspace basis by zero-padding, yielding $\\phi_{\\mathrm{sector}}^{\\mathrm{sup}}$.\n4.  Compute the Fermi matrix element using the embedded vectors: $M_F = \\frac{1}{\\sqrt{2}} ( \\langle \\phi_{pp}^{\\mathrm{sup}} | \\phi_{pn}^{\\mathrm{sup}} \\rangle + \\langle \\phi_{pp}^{\\mathrm{sup}} | \\phi_{np}^{\\mathrm{sup}} \\rangle )$.\n5.  Compute the average CM energy: $\\overline{\\langle H_{\\mathrm{cm}} \\rangle} = \\frac{1}{3}(\\langle H_{\\mathrm{cm}} \\rangle_{pp} + \\langle H_{\\mathrm{cm}} \\rangle_{pn} + \\langle H_{\\mathrm{cm}} \\rangle_{np})$.\n6.  Store the pair of results $(M_F, \\overline{\\langle H_{\\mathrm{cm}} \\rangle})$ for the current test case.\nThis procedure is repeated for all test cases to generate the final list of results.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom numpy.linalg import eigh\n\ndef calculate_ground_state_properties(N_cm_max, N_rel_max, alpha, beta):\n    \"\"\"\n    Constructs and diagonalizes the Hamiltonian for a given sector.\n\n    Args:\n        N_cm_max (int): Maximum CM quantum number.\n        N_rel_max (int): Maximum relative quantum number.\n        alpha (float): Coupling strength.\n        beta (float): Lawson term parameter.\n\n    Returns:\n        tuple: A tuple containing:\n            - gs_vector (np.ndarray): The ground state eigenvector.\n            - h_cm_exp (float): The expectation value of H_cm in the ground state.\n    \"\"\"\n    dim_cm = N_cm_max + 1\n    dim_rel = N_rel_max + 1\n    dim = dim_cm * dim_rel\n    H = np.zeros((dim, dim))\n\n    # Define prefactors for position operators in specified units\n    x_cm = 0.5\n    x_rel = 1.0\n\n    # Build the Hamiltonian matrix\n    for N in range(dim_cm):\n        for n in range(dim_rel):\n            k = N * dim_rel + n\n\n            # Diagonal part: (1+beta)*H_cm + H_int\n            diag_val = (1.0 + beta) * (N + 0.5) + (n + 0.5)\n            H[k, k] = diag_val\n\n            # Off-diagonal part: alpha * X * x\n            if alpha != 0.0:\n                # Four possible connections: (N+/-1, n+/-1)\n                # Connection to (N+1, n+1)\n                if N + 1 < dim_cm and n + 1 < dim_rel:\n                    N_p, n_p = N + 1, n + 1\n                    k_p = N_p * dim_rel + n_p\n                    val = alpha * (x_cm * np.sqrt(N + 1)) * (x_rel * np.sqrt(n + 1))\n                    H[k, k_p] = val\n                    H[k_p, k] = val\n                \n                # Connection to (N+1, n-1)\n                if N + 1 < dim_cm and n - 1 >= 0:\n                    N_p, n_p = N + 1, n - 1\n                    k_p = N_p * dim_rel + n_p\n                    val = alpha * (x_cm * np.sqrt(N + 1)) * (x_rel * np.sqrt(n))\n                    H[k, k_p] = val\n                    H[k_p, k] = val\n\n                # Connection to (N-1, n+1) - handled implicitly by symmetric filling\n                # Connection to (N-1, n-1) - handled implicitly by symmetric filling\n\n    # Diagonalize the Hermitian matrix\n    eigenvalues, eigenvectors = eigh(H)\n    \n    # Ground state is the eigenvector for the lowest eigenvalue\n    gs_vector = eigenvectors[:, 0]\n    \n    # Calculate expectation value of H_cm\n    h_cm_exp = 0.0\n    for N in range(dim_cm):\n        for n in range(dim_rel):\n            k = N * dim_rel + n\n            coeff_sq = gs_vector[k]**2\n            h_cm_exp += coeff_sq * (N + 0.5)\n            \n    return gs_vector, h_cm_exp\n\ndef solve():\n    \"\"\"\n    Main solver function that iterates through test cases and computes the required observables.\n    \"\"\"\n    test_cases = [\n        # (N_cm_pp_max, N_cm_pn_max, N_cm_np_max, N_rel_max, alpha, beta)\n        (3, 3, 3, 6, 0.0, 0.0),  # Case 1\n        (1, 1, 2, 6, 0.2, 0.0),  # Case 2\n        (0, 0, 0, 6, 0.2, 0.0),  # Case 3\n        (3, 3, 3, 6, 0.2, 5.0),  # Case 4\n        (1, 2, 3, 6, 0.5, 0.0),  # Case 5\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        N_cm_pp_max, N_cm_pn_max, N_cm_np_max, N_rel_max, alpha, beta = case\n        \n        # Determine superspace dimensions\n        N_cm_sup = max(N_cm_pp_max, N_cm_pn_max, N_cm_np_max)\n        dim_rel_common = N_rel_max + 1\n        dim_sup = (N_cm_sup + 1) * dim_rel_common\n        \n        sector_params = {\n            'pp': N_cm_pp_max,\n            'pn': N_cm_pn_max,\n            'np': N_cm_np_max\n        }\n        \n        ground_states = {}\n        h_cm_expectations = {}\n        \n        for sector, N_cm_max in sector_params.items():\n            gs_vec, h_cm_exp = calculate_ground_state_properties(N_cm_max, N_rel_max, alpha, beta)\n            h_cm_expectations[sector] = h_cm_exp\n            \n            # Embed the ground state vector into the superspace\n            gs_sup = np.zeros(dim_sup)\n            dim_sec_cm = N_cm_max + 1\n            for N in range(dim_sec_cm):\n                start_idx_sec = N * dim_rel_common\n                end_idx_sec = start_idx_sec + dim_rel_common\n                \n                start_idx_sup = N * dim_rel_common\n                end_idx_sup = start_idx_sup + dim_rel_common\n                \n                gs_sup[start_idx_sup:end_idx_sup] = gs_vec[start_idx_sec:end_idx_sec]\n            \n            ground_states[sector] = gs_sup\n\n        # Calculate Fermi Matrix Element M_F\n        overlap_pp_pn = np.dot(ground_states['pp'], ground_states['pn'])\n        overlap_pp_np = np.dot(ground_states['pp'], ground_states['np'])\n        M_F = (1.0 / np.sqrt(2.0)) * (overlap_pp_pn + overlap_pp_np)\n        \n        # Calculate average H_cm expectation value\n        avg_h_cm = np.mean(list(h_cm_expectations.values()))\n\n        results.extend([M_F, avg_h_cm])\n\n    # Format the final output string as specified\n    output_str = f\"[{','.join(f'{x:.8f}' for x in results)}]\"\n    print(output_str)\n\nsolve()\n```", "id": "3546717"}]}