{"hands_on_practices": [{"introduction": "To solve nuclear physics problems on a quantum computer, we must first translate the language of fermions into the language of qubits. This exercise [@problem_id:3611049] provides hands-on practice with the Jordan-Wigner transformation, a cornerstone technique for this mapping. By explicitly constructing the Pauli-string representation of a fundamental two-body interaction term, you will gain a concrete understanding of how fermionic operators are realized as multi-qubit operations and how their algebraic properties are preserved.", "problem": "In computational nuclear physics, a Variational Quantum Eigensolver (VQE) seeks to minimize the expectation value of a mapped second-quantized Hamiltonian, which includes two-body normal-ordered terms of the form $a_{p}^{\\dagger} a_{q}^{\\dagger} a_{r} a_{s}$. Consider a shell-model Hamiltonian term with four distinct single-particle orbitals indexed by integers $s<r<q<p$. Adopt the Jordan–Wigner mapping that sends fermionic ladder operators to spin operators via $a_{j} \\mapsto \\left(\\prod_{t=0}^{j-1} Z_{t}\\right) \\sigma^{-}_{j}$ and $a_{j}^{\\dagger} \\mapsto \\left(\\prod_{t=0}^{j-1} Z_{t}\\right) \\sigma^{+}_{j}$, where $\\sigma^{\\pm}_{j} \\equiv \\left(X_{j} \\mp i Y_{j}\\right)/2$ and $X_{j}, Y_{j}, Z_{j}$ are Pauli operators on qubit $j$. Define the mapped number operator $\\tilde{n}_{k}$ for orbital $k$ as the Jordan–Wigner image of $n_{k}\\equiv a_{k}^{\\dagger} a_{k}$, and denote by $\\tilde{O}$ the Jordan–Wigner image of $O \\equiv a_{p}^{\\dagger} a_{q}^{\\dagger} a_{r} a_{s}$.\n\nStarting from the canonical anticommutation relations and the given Jordan–Wigner mapping, first construct an explicit Pauli-operator expression for $\\tilde{O}$ in terms of $X_{j}$, $Y_{j}$, and $Z_{j}$, simplifying the parity strings using the ordering $s<r<q<p$. Then, evaluate the commutator $[\\tilde{n}_{k}, \\tilde{O}]$ for an arbitrary integer $k$. Express your final answer as a single closed-form analytic expression in terms of Kronecker deltas and $\\tilde{O}$. No numerical evaluation is required, and no rounding is needed. The final answer must be a single analytic expression.", "solution": "The problem asks for two main results: first, the explicit Pauli-operator expression for the Jordan–Wigner (JW) image $\\tilde{O}$ of the fermionic operator $O \\equiv a_{p}^{\\dagger} a_{q}^{\\dagger} a_{r} a_{s}$, and second, the commutator $[\\tilde{n}_{k}, \\tilde{O}]$, where $\\tilde{n}_{k}$ is the JW image of the number operator $n_{k} \\equiv a_{k}^{\\dagger} a_{k}$. The integer indices for the single-particle orbitals are given to be distinct and ordered as $s<r<q<p$.\n\nFirst, we perform the problem validation.\n\n### Step 1: Extract Givens\n-   Operator to be mapped: $O \\equiv a_{p}^{\\dagger} a_{q}^{\\dagger} a_{r} a_{s}$.\n-   Number operator: $n_{k} \\equiv a_{k}^{\\dagger} a_{k}$.\n-   Orbital index ordering: $s<r<q<p$, where $s, r, q, p$ are distinct integers.\n-   Jordan–Wigner mapping:\n    -   $a_{j} \\mapsto \\tilde{a}_{j} = \\left(\\prod_{t=0}^{j-1} Z_{t}\\right) \\sigma^{-}_{j}$\n    -   $a_{j}^{\\dagger} \\mapsto \\tilde{a}_{j}^{\\dagger} = \\left(\\prod_{t=0}^{j-1} Z_{t}\\right) \\sigma^{+}_{j}$\n-   Pauli operator definitions: $\\sigma^{\\pm}_{j} \\equiv \\frac{1}{2}(X_{j} \\mp i Y_{j})$.\n-   Target quantities:\n    1.  Explicit Pauli-operator expression for $\\tilde{O} \\equiv \\widetilde{a_{p}^{\\dagger} a_{q}^{\\dagger} a_{r} a_{s}}$.\n    2.  The commutator $[\\tilde{n}_{k}, \\tilde{O}]$ for an arbitrary integer $k$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically grounded, drawing upon standard principles of second quantization and the Jordan–Wigner transformation used in quantum simulation. It is well-posed, with all necessary definitions and constraints provided, leading to a unique analytical solution. The language is objective and unambiguous. No scientific, logical, or structural flaws are present.\n\n### Step 3: Verdict and Action\nThe problem is valid. We proceed with the solution.\n\n#### Part 1: Pauli-Operator Expression for $\\tilde{O}$\n\nThe Jordan–Wigner transformation maps the product of fermionic operators to the product of their corresponding Pauli operator images. Thus, $\\tilde{O} = \\tilde{a}_{p}^{\\dagger} \\tilde{a}_{q}^{\\dagger} \\tilde{a}_{r} \\tilde{a}_{s}$. We construct this product step-by-step.\nLet $P_j = \\prod_{t=0}^{j-1} Z_t$ be the parity string for qubit $j$. The mapped operators are:\n$\\tilde{a}_{j}^{\\dagger} = P_j \\sigma_j^{+}$ and $\\tilde{a}_{j} = P_j \\sigma_j^{-}$.\n\nThe full expression for $\\tilde{O}$ is:\n$$\n\\tilde{O} = (P_p \\sigma_p^{+}) (P_q \\sigma_q^{+}) (P_r \\sigma_r^{-}) (P_s \\sigma_s^{-})\n$$\nPauli operators on different sites commute, e.g., $[Z_t, \\sigma_j^{\\pm}] = 0$ for $t \\neq j$. However, we must be careful when commuting an operator on site $j$ through a parity string $P_k$ where $k>j$, as $P_k$ contains $Z_j$. Specifically, $\\sigma_j^{\\pm}$ anti-commutes with $Z_j$.\n\nLet's combine the operators from right to left (or left to right, being consistent).\nLet's start by commuting the operators to group the parity strings and the local spin operators.\nAn operator $\\sigma_j^{\\pm}$ commutes with any $P_k$ where $k < j$, since $P_k$ does not contain operators on site $j$. Given the ordering $s<r<q<p$, we can safely write:\n$$\n\\tilde{O} = P_p P_q P_r P_s \\sigma_p^{+} \\sigma_q^{+} \\sigma_r^{-} \\sigma_s^{-}\n$$\nWe now simplify the product of parity strings by using the property $Z_t^2 = I$.\nThe total Z-string is $P_{total} = (\\prod_{t=0}^{p-1} Z_t) (\\prod_{t=0}^{q-1} Z_t) (\\prod_{t=0}^{r-1} Z_t) (\\prod_{t=0}^{s-1} Z_t)$.\nWe count the occurrences of each $Z_t$:\n-   For $0 \\le t < s$, $Z_t$ appears in all four products ($P_p, P_q, P_r, P_s$), so the term is $Z_t^4 = I$.\n-   For $s \\le t < r$, $Z_t$ appears in three products ($P_p, P_q, P_r$), so the term is $Z_t^3 = Z_t$.\n-   For $r \\le t < q$, $Z_t$ appears in two products ($P_p, P_q$), so the term is $Z_t^2 = I$.\n-   For $q \\le t < p$, $Z_t$ appears in one product ($P_p$), so the term is $Z_t^1 = Z_t$.\n\nThe simplified total parity string is:\n$$\nP_{total} = \\left(\\prod_{t=s}^{r-1} Z_t\\right) \\left(\\prod_{t=q}^{p-1} Z_t\\right)\n$$\nThe full operator $\\tilde{O}$ is the product of this Z-string and the local spin operators. Using the definition $\\sigma^{\\pm}_{j} = \\frac{1}{2}(X_{j} \\mp i Y_{j})$:\n$$\n\\tilde{O} = \\left[ \\left(\\prod_{t=s}^{r-1} Z_t\\right) \\left(\\prod_{t=q}^{p-1} Z_t\\right) \\right] \\left( \\frac{X_p - iY_p}{2} \\right) \\left( \\frac{X_q - iY_q}{2} \\right) \\left( \\frac{X_r + iY_r}{2} \\right) \\left( \\frac{X_s + iY_s}{2} \\right)\n$$\nThis simplifies to:\n$$\n\\tilde{O} = \\frac{1}{16} \\left(\\prod_{t=q}^{p-1} Z_t \\prod_{u=s}^{r-1} Z_u \\right) (X_p - iY_p)(X_q - iY_q)(X_r + iY_r)(X_s + iY_s)\n$$\nThis is the explicit Pauli-operator expression for $\\tilde{O}$.\n\n#### Part 2: Commutator $[\\tilde{n}_{k}, \\tilde{O}]$\n\nThe Jordan-Wigner transformation is an algebra isomorphism. This means that for any two fermionic operators $A$ and $B$, the commutator of their images is the image of their commutator: $[\\tilde{A}, \\tilde{B}] = \\widetilde{[A, B]}$. This property allows us to compute the commutator in the simpler fermionic algebra and then map the result.\n\nFirst, we identify the operator $n_k = a_k^\\dagger a_k$. We need to compute $[n_k, O] = [a_k^\\dagger a_k, a_p^\\dagger a_q^\\dagger a_r a_s]$.\nWe use the Leibniz rule for commutators: $[AB, C] = A[B, C] + [A, C]B$.\n$$\n[n_k, O] = a_k^\\dagger [a_k, O] + [a_k^\\dagger, O] a_k\n$$\nWe need to evaluate the commutators $[a_k, O]$ and $[a_k^\\dagger, O]$ using the canonical anticommutation relations (CAR): $\\{a_i, a_j^\\dagger\\} = \\delta_{ij}$ and $\\{a_i, a_j\\} = \\{a_i^\\dagger, a_j^\\dagger\\} = 0$. From these, we derive $a_i a_j = -a_j a_i$ for $i \\neq j$ and $a_i a_j^\\dagger = \\delta_{ij} - a_j^\\dagger a_i$.\n\n1.  Compute $[a_k, O] = [a_k, a_p^\\dagger a_q^\\dagger a_r a_s]$. We anticommute $a_k$ from left to right.\n    $[a_k, a_p^\\dagger a_q^\\dagger a_r a_s] = \\{a_k, a_p^\\dagger\\}a_q^\\dagger a_r a_s - a_p^\\dagger\\{a_k, a_q^\\dagger\\}a_r a_s + a_p^\\dagger a_q^\\dagger \\{a_k, a_r\\}a_s - a_p^\\dagger a_q^\\dagger a_r\\{a_k, a_s\\}$.\n    Since $\\{a_k, a_r\\} = 0$ for any $k, r$, the last two terms vanish.\n    $$\n    [a_k, O] = \\delta_{kp} a_q^\\dagger a_r a_s - \\delta_{kq} a_p^\\dagger a_r a_s\n    $$\n    Due to the anticommutation of fermionic operators, we can write $a_p^\\dagger a_q^\\dagger = -a_q^\\dagger a_p^\\dagger$. The expression above is correct.\n\n2.  Compute $[a_k^\\dagger, O] = [a_k^\\dagger, a_p^\\dagger a_q^\\dagger a_r a_s]$. We anticommute $a_k^\\dagger$ from left to right.\n    $[a_k^\\dagger, a_p^\\dagger a_q^\\dagger a_r a_s] = \\{a_k^\\dagger, a_p^\\dagger\\}a_q^\\dagger a_r a_s - a_p^\\dagger\\{a_k^\\dagger, a_q^\\dagger\\}a_r a_s + a_p^\\dagger a_q^\\dagger \\{a_k^\\dagger, a_r\\}a_s - a_p^\\dagger a_q^\\dagger a_r\\{a_k^\\dagger, a_s\\}$.\n    Since $\\{a_k^\\dagger, a_p^\\dagger\\} = 0$ and $\\{a_k^\\dagger, a_q^\\dagger\\} = 0$, the first two terms vanish.\n    $$\n    [a_k^\\dagger, O] = a_p^\\dagger a_q^\\dagger (\\delta_{kr} a_s) - a_p^\\dagger a_q^\\dagger a_r (\\delta_{ks}) = \\delta_{kr} a_p^\\dagger a_q^\\dagger a_s - \\delta_{ks} a_p^\\dagger a_q^\\dagger a_r\n    $$\n\n3.  Substitute these results back into the expression for $[n_k, O]$:\n    $$\n    [n_k, O] = a_k^\\dagger(\\delta_{kp} a_q^\\dagger a_r a_s - \\delta_{kq} a_p^\\dagger a_r a_s) + (\\delta_{kr} a_p^\\dagger a_q^\\dagger a_s - \\delta_{ks} a_p^\\dagger a_q^\\dagger a_r)a_k\n    $$\n    We analyze this expression based on the value of $k$. Since $p,q,r,s$ are distinct, only one Kronecker delta can be non-zero at a time.\n\n    -   Case $k=p$: $\\delta_{kp}=1$, others are $0$.\n        $[n_p, O] = a_p^\\dagger(a_q^\\dagger a_r a_s) = a_p^\\dagger a_q^\\dagger a_r a_s = O$.\n    -   Case $k=q$: $\\delta_{kq}=1$, others are $0$.\n        $[n_q, O] = a_q^\\dagger(-a_p^\\dagger a_r a_s) = -a_q^\\dagger a_p^\\dagger a_r a_s$. Since $\\{a_q^\\dagger, a_p^\\dagger\\}=0$, we have $a_q^\\dagger a_p^\\dagger = -a_p^\\dagger a_q^\\dagger$.\n        $[n_q, O] = a_p^\\dagger a_q^\\dagger a_r a_s = O$.\n    -   Case $k=r$: $\\delta_{kr}=1$, others are $0$.\n        $[n_r, O] = (a_p^\\dagger a_q^\\dagger a_s) a_r$. Since $\\{a_s, a_r\\}=0$ and $s \\neq r$, we have $a_s a_r = -a_r a_s$.\n        $[n_r, O] = -a_p^\\dagger a_q^\\dagger a_r a_s = -O$.\n    -   Case $k=s$: $\\delta_{ks}=1$, others are $0$.\n        $[n_s, O] = (-a_p^\\dagger a_q^\\dagger a_r) a_s = -a_p^\\dagger a_q^\\dagger a_r a_s = -O$.\n    -   Case $k \\notin \\{p, q, r, s\\}$: All deltas are $0$.\n        $[n_k, O] = 0$.\n\nCombining these cases into a single expression using Kronecker deltas gives:\n$$\n[n_k, O] = (\\delta_{kp} + \\delta_{kq} - \\delta_{kr} - \\delta_{ks}) O\n$$\nThis expression elegantly summarizes the result. A creation operator ($a_p^\\dagger$ or $a_q^\\dagger$) adds a particle to the state, so the number of particles on that orbital increases by one if the operator acts on the vacuum. The term $a_r a_s$ annihilates particles. The operator $O$ represents the scattering of two particles from orbitals $s, r$ to orbitals $p, q$. Consequently, the number of particles increases by $1$ in orbitals $p$ and $q$, and decreases by $1$ in orbitals $r$ and $s$. The signs reflect this: $[n_k, O] = O$ means $n_k O - O n_k = O$, so $n_k O = O(n_k+1)$, indicating the number count is increased by one. Similarly $[n_k, O] = -O$ implies $n_k O = O(n_k-1)$, a decrease by one.\n\nFinally, applying the JW isomorphism to this result:\n$$\n[\\tilde{n}_{k}, \\tilde{O}] = \\widetilde{[n_k, O]} = (\\delta_{kp} + \\delta_{kq} - \\delta_{kr} - \\delta_{ks}) \\tilde{O}\n$$\nThis gives the final answer in the required closed-form analytic expression.", "answer": "$$\n\\boxed{(\\delta_{kp} + \\delta_{kq} - \\delta_{kr} - \\delta_{ks})\\tilde{O}}\n$$", "id": "3611049"}, {"introduction": "A key challenge in variational methods is determining how close the calculated energy is to the true ground-state energy. This practice [@problem_id:3611129] introduces a powerful theoretical tool for this task, allowing you to derive an upper bound on the energy error from a measurable quantity: the energy variance $\\sigma_{E}^{2}$. Mastering this derivation provides a rigorous way to certify the quality of your VQE results, transforming a \"black box\" energy value into a scientifically credible estimate with a confidence interval.", "problem": "Consider a self-adjoint nuclear many-body Hamiltonian $H$ acting on a finite-dimensional truncated configuration space with discrete spectrum $\\{E_{n}\\}_{n \\ge 0}$, ordered as $E_{0} < E_{1} \\le E_{2} \\le \\cdots$. In a Variational Quantum Eigensolver (VQE) calculation, a normalized parameterized state $|\\psi\\rangle$ is prepared, with measured energy expectation $E \\equiv \\langle \\psi|H|\\psi\\rangle$ and energy variance $\\sigma_{E}^{2} \\equiv \\langle \\psi|(H - E)^{2}|\\psi\\rangle > 0$. Let the ground-state energy error be $\\delta E \\equiv E - E_{0} \\ge 0$, and denote the spectral gap by $\\Delta \\equiv E_{1} - E_{0} > 0$.\n\nStarting only from the definitions of $E$, $\\sigma_{E}^{2}$, and $\\Delta$, along with the spectral theorem and basic operator inequalities, derive an a posteriori upper bound for $\\delta E$ in closed form that depends on $\\Delta$ and $\\sigma_{E}^{2}$ alone. Your derivation must not assume any unproven formula for this bound; it should begin at the level of the spectral decomposition of $H$ and reason about the action of $(H - E_{0})$ and $(H - E_{0})^{2}$ on the ground-state complement.\n\nThen, in a realistic nuclear VQE scenario, suppose the following independently certified quantities are available: a measured energy variance $\\sigma_{E}^{2} = 0.090$ MeV$^{2}$ and a rigorous lower bound on the spectral gap $\\Delta_{\\min} = 1.20$ MeV (e.g., inferred from a conservative excited-state calculation or experimental constraints within the same model space). Using your closed-form expression with $\\Delta$ replaced by $\\Delta_{\\min}$, compute the resulting numerical upper bound on the absolute ground-state energy error $\\delta E$. Verify the applicability conditions required by your bound. Round your final numerical bound to four significant figures. Express the final energy error bound in MeV.", "solution": "The problem asks for two parts: first, to derive a closed-form upper bound for the ground-state energy error $\\delta E$ in a variational calculation, based on the energy variance $\\sigma_{E}^{2}$ and the spectral gap $\\Delta$; second, to apply this bound to a numerical scenario in nuclear VQE.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n-   $H$: A self-adjoint nuclear many-body Hamiltonian.\n-   $\\{E_{n}\\}_{n \\ge 0}$: Discrete spectrum of $H$, ordered as $E_{0} < E_{1} \\le E_{2} \\le \\cdots$.\n-   $|\\psi\\rangle$: A normalized parameterized state.\n-   $E \\equiv \\langle \\psi|H|\\psi\\rangle$: Measured energy expectation value.\n-   $\\sigma_{E}^{2} \\equiv \\langle \\psi|(H - E)^{2}|\\psi\\rangle > 0$: Energy variance.\n-   $\\delta E \\equiv E - E_{0} \\ge 0$: Ground-state energy error.\n-   $\\Delta \\equiv E_{1} - E_{0} > 0$: Spectral gap.\n-   Numerical values for the second part: $\\sigma_{E}^{2} = 0.090 \\text{ MeV}^{2}$, and a rigorous lower bound on the gap, $\\Delta_{\\min} = 1.20 \\text{ MeV}$.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is scientifically grounded, well-posed, and objective. It presents a standard task in quantum mechanics and numerical analysis: deriving and applying an a posteriori error bound for a variational method. The derivation is constrained to start from first principles (spectral theorem, basic operator inequalities), which is a standard pedagogical approach. The givens are self-contained and consistent. The problem does not violate any fundamental principles; on the contrary, it is based directly upon them. The use of VQE in computational nuclear physics is a current and relevant research area. All terms are standard and clearly defined.\n\n**Step 3: Verdict and Action**\nThe problem is **valid**. A full solution will be provided.\n\n### Derivation of the Upper Bound\n\nThe derivation begins by considering the properties of the Hamiltonian $H$ relative to its two lowest-lying energy eigenstates. Let $|n\\rangle$ be the orthonormal eigenstate corresponding to the eigenvalue $E_n$, such that $H|n\\rangle = E_n|n\\rangle$. The spectral gap is $\\Delta = E_1 - E_0 > 0$.\n\nConsider the operator $(H - E_1)(H - E_0)$. According to the spectral theorem, its eigenvalues are $(E_n - E_1)(E_n - E_0)$ for $n \\ge 0$. Let us examine the sign of these eigenvalues:\n-   For $n=0$: $(E_0 - E_1)(E_0 - E_0) = (-\\Delta)(0) = 0$.\n-   For $n=1$: $(E_1 - E_1)(E_1 - E_0) = (0)(\\Delta) = 0$.\n-   For $n \\ge 2$: $E_n \\ge E_1 > E_0$. Thus, $(E_n - E_1) \\ge 0$ and $(E_n - E_0) > 0$. The product is non-negative.\n\nSince all eigenvalues of the self-adjoint operator $(H - E_1)(H - E_0)$ are non-negative, it is a positive semidefinite operator. Therefore, its expectation value in any state $|\\psi\\rangle$ must be non-negative:\n$$\n\\langle\\psi|(H - E_1)(H - E_0)|\\psi\\rangle \\ge 0\n$$\n\nWe now expand this expectation value.\n$$\n(H - E_1)(H - E_0) = H^2 - (E_0 + E_1)H + E_0 E_1\n$$\nThe expectation value is:\n$$\n\\langle\\psi|H^2|\\psi\\rangle - (E_0 + E_1)\\langle\\psi|H|\\psi\\rangle + E_0 E_1 \\ge 0\n$$\n\nWe use the definitions of the energy expectation $E$ and variance $\\sigma_E^2$:\n-   $E = \\langle\\psi|H|\\psi\\rangle$\n-   $\\sigma_E^2 = \\langle\\psi|(H-E)^2|\\psi\\rangle = \\langle\\psi|H^2 - 2EH + E^2|\\psi\\rangle = \\langle H^2 \\rangle - 2E\\langle H \\rangle + E^2 = \\langle H^2 \\rangle - E^2$.\nSo, $\\langle H^2 \\rangle = \\sigma_E^2 + E^2$.\n\nSubstituting these into the inequality gives:\n$$\n(\\sigma_E^2 + E^2) - (E_0 + E_1)E + E_0 E_1 \\ge 0\n$$\nWe rearrange the terms to factor the expression in terms of $E$:\n$$\n\\sigma_E^2 + E^2 - E_0 E - E_1 E + E_0 E_1 \\ge 0\n$$\n$$\n\\sigma_E^2 + E(E - E_0) - E_1(E - E_0) \\ge 0\n$$\n$$\n\\sigma_E^2 + (E - E_0)(E - E_1) \\ge 0\n$$\nThis is the celebrated Temple-Kato inequality. Now, we express it in terms of the ground-state energy error $\\delta E = E - E_0$ and the spectral gap $\\Delta = E_1 - E_0$.\nNote that $E - E_1 = (E - E_0) - (E_1 - E_0) = \\delta E - \\Delta$.\nSubstituting these into the inequality yields:\n$$\n\\sigma_E^2 + \\delta E (\\delta E - \\Delta) \\ge 0\n$$\n$$\n\\delta E^2 - \\Delta \\cdot \\delta E + \\sigma_E^2 \\ge 0\n$$\nThis is a quadratic inequality for $\\delta E$. The roots of the corresponding equation $\\delta E^2 - \\Delta \\cdot \\delta E + \\sigma_E^2 = 0$ are given by the quadratic formula:\n$$\n\\delta E = \\frac{\\Delta \\pm \\sqrt{\\Delta^2 - 4\\sigma_E^2}}{2}\n$$\nThe quadratic is an upward-opening parabola, so the inequality holds when $\\delta E$ is outside the interval between the roots. Let the roots be $r_1 \\le r_2$. Then the inequality implies $\\delta E \\le r_1$ or $\\delta E \\ge r_2$.\n\nTo obtain a useful upper bound, we must select the appropriate branch. In a VQE context, the state $|\\psi\\rangle$ is intended to be an approximation of the ground state $|0\\rangle$. This implies that its energy $E$ should be closer to $E_0$ than to $E_1$. A standard condition to ensure this is to require that $E$ has not passed the midpoint of the spectral gap, i.e., $E < \\frac{E_0+E_1}{2}$. This translates to:\n$$\nE - E_0 < \\frac{E_0+E_1}{2} - E_0 \\implies \\delta E < \\frac{E_1-E_0}{2} = \\frac{\\Delta}{2}\n$$\nThe two roots are $r_1 = \\frac{\\Delta}{2} - \\frac{1}{2}\\sqrt{\\Delta^2 - 4\\sigma_E^2}$ and $r_2 = \\frac{\\Delta}{2} + \\frac{1}{2}\\sqrt{\\Delta^2 - 4\\sigma_E^2}$. They are symmetric around $\\frac{\\Delta}{2}$. Since $\\delta E < \\frac{\\Delta}{2}$, it cannot satisfy $\\delta E \\ge r_2$. Thus, it must satisfy $\\delta E \\le r_1$.\n\nThe final closed-form upper bound is:\n$$\n\\delta E \\le \\frac{\\Delta - \\sqrt{\\Delta^2 - 4\\sigma_E^2}}{2}\n$$\nThe applicability of this bound depends on two conditions:\n1.  The quantity under the square root must be non-negative: $\\Delta^2 - 4\\sigma_E^2 \\ge 0$. This means the energy variance must be sufficiently small compared to the gap.\n2.  The variational energy $E$ must be low enough to justify choosing the smaller root, e.g., $E < (E_0+E_1)/2$.\n\n### Numerical Application\n\nWe are given:\n-   $\\sigma_E^2 = 0.090 \\text{ MeV}^2$\n-   $\\Delta_{min} = 1.20 \\text{ MeV}$, which is a lower bound for the true gap, $\\Delta \\ge \\Delta_{min}$.\n\nTo obtain a rigorous upper bound for $\\delta E$, we must use $\\Delta_{min}$ in the formula. We need to check how the bound behaves as a function of $\\Delta$. Let $f(\\Delta) = \\frac{\\Delta - \\sqrt{\\Delta^2 - 4\\sigma_E^2}}{2}$. Its derivative is:\n$$\nf'(\\Delta) = \\frac{1}{2} \\left(1 - \\frac{2\\Delta}{2\\sqrt{\\Delta^2 - 4\\sigma_E^2}}\\right) = \\frac{1}{2} \\left(1 - \\frac{\\Delta}{\\sqrt{\\Delta^2 - 4\\sigma_E^2}}\\right)\n$$\nSince $\\Delta = \\sqrt{\\Delta^2} > \\sqrt{\\Delta^2 - 4\\sigma_E^2}$ (for $\\sigma_E^2 > 0$), the fraction is greater than $1$, which makes $f'(\\Delta) < 0$. The function is monotonically decreasing.\nTherefore, using $\\Delta_{min} \\le \\Delta$ will yield a larger, more conservative upper bound:\n$$\n\\delta E \\le f(\\Delta) \\le f(\\Delta_{min}) = \\frac{\\Delta_{min} - \\sqrt{\\Delta_{min}^2 - 4\\sigma_E^2}}{2}\n$$\n\nNow, we verify the applicability conditions with the given numerical values.\n1.  Check for real roots:\n    $$\n    \\Delta_{min}^2 - 4\\sigma_E^2 = (1.20 \\text{ MeV})^2 - 4(0.090 \\text{ MeV}^2) = 1.44 \\text{ MeV}^2 - 0.36 \\text{ MeV}^2 = 1.08 \\text{ MeV}^2\n    $$\n    Since $1.08 > 0$, the condition is satisfied, and the bound is well-defined.\n2.  The second condition, $E < (E_0+E_1)/2$, cannot be directly verified without knowing $E$, $E_0$, and $E_1$. However, in the context of certifying a VQE result, this is a standard and necessary assumption for this type of bound to be meaningful.\n\nWe proceed with the calculation of the numerical bound:\n$$\n\\delta E \\le \\frac{1.20 \\text{ MeV} - \\sqrt{1.08 \\text{ MeV}^2}}{2}\n$$\n$$\n\\delta E \\le \\frac{1.20 - \\sqrt{1.08}}{2} \\text{ MeV}\n$$\n$$\n\\delta E \\le \\frac{1.20 - 1.03923048...}{2} \\text{ MeV}\n$$\n$$\n\\delta E \\le \\frac{0.16076951...}{2} \\text{ MeV}\n$$\n$$\n\\delta E \\le 0.08038475... \\text{ MeV}\n$$\nRounding the result to four significant figures, we get an upper bound on the absolute ground-state energy error.\n\n$$\n\\delta E \\le 0.08038 \\text{ MeV}\n$$", "answer": "$$\\boxed{0.08038}$$", "id": "3611129"}, {"introduction": "The performance of a VQE algorithm on real hardware is critically dependent on the choice of classical optimizer and its resilience to noise. This exercise [@problem_id:3611032] places you in the role of an experimentalist, tasked with selecting the most robust optimization strategy in the face of both shot noise and temporally correlated device noise. By analyzing the trade-offs between different methods, you will develop a deeper appreciation for how an optimizer’s sampling pattern interacts with the noise characteristics of a quantum device to determine the success of the entire computation.", "problem": "You are designing a Variational Quantum Eigensolver (VQE) for a small-$A$ nuclear system, specifically the deuteron ($A=2$), using a hardware-efficient ansatz with $d$ real parameters collected in $\\boldsymbol{\\theta}\\in\\mathbb{R}^d$. The objective function is the parametric ground-state energy $E(\\boldsymbol{\\theta})=\\langle \\psi(\\boldsymbol{\\theta})|\\hat{H}|\\psi(\\boldsymbol{\\theta})\\rangle$ for a realistic low-energy nuclear Hamiltonian $\\hat{H}$. Assume that near the optimum $\\boldsymbol{\\theta}^{\\star}$ the landscape is locally strongly convex with Hessian eigenvalues bounded in the interval $[m,L]$, where $m>0$ and $L>m$. The experiment runs on a noisy quantum device. Each energy evaluation returns an estimator $\\widehat{E}(\\boldsymbol{\\theta})=E(\\boldsymbol{\\theta})+\\epsilon$, where the error $\\epsilon$ has two contributions:\n- a shot-noise term modeled as approximately Gaussian with variance $\\sigma_{s}^2/N$, where $N$ is the number of shots allocated to that energy evaluation and $\\sigma_{s}^2=\\mathrm{Var}_{\\psi(\\boldsymbol{\\theta})}(\\hat{H})$ is the intrinsic energy variance at $\\boldsymbol{\\theta}$,\n- a device-noise term $\\eta(t)$ that can be modeled as a zero-mean, stationary process with variance $\\sigma_{d}^2$ and correlation function $C(\\Delta t)=\\sigma_{d}^2 e^{-|\\Delta t|/\\tau_c}$, where $\\tau_c$ is a correlation time and $t$ is the wall-clock time of the evaluation.\n\nAssume the following realistic values for a deuteron VQE in a small basis:\n- parameter dimension $d=12$,\n- Hessian bounds $m=0.5\\,\\mathrm{MeV}/\\mathrm{rad}^2$ and $L=5\\,\\mathrm{MeV}/\\mathrm{rad}^2$ (condition number $\\kappa=L/m=10$),\n- per-iteration shot budget $S_{\\mathrm{tot}}=4\\times 10^4$,\n- intrinsic variance upper bound $\\sigma_{s}^2\\leq (1\\,\\mathrm{MeV})^2$ throughout the local basin,\n- device-noise variance $\\sigma_{d}^2=(0.05\\,\\mathrm{MeV})^2$ and correlation time $\\tau_c=1\\,\\mathrm{s}$,\n- the wall-clock time per single energy evaluation is approximately $t_{\\mathrm{eval}}=0.05\\,\\mathrm{s}$ (dominated by circuit programming and sampling overhead, while measurement sampling within a single evaluation is fast enough to be considered synchronous),\n- when two energy evaluations are executed back-to-back within a time window of width $\\Delta t\\ll \\tau_c$, the device-noise components are highly correlated, with correlation coefficient $\\rho\\simeq e^{-\\Delta t/\\tau_c}$.\n\nYou are to decide among three classical optimizers:\n- Limited-memory Broyden-Fletcher-Goldfarb-Shanno (L-BFGS) using parameter-shift gradients and a backtracking Armijo-Wolfe line-search,\n- Simultaneous Perturbation Stochastic Approximation (SPSA) with two-point random perturbations of radius $c>0$, decaying step sizes $a_k$, decaying perturbation radii $c_k$, and Polyak-Ruppert iterate averaging,\n- Covariance Matrix Adaptation Evolution Strategy (CMA-ES) with rank-$\\mu$ update and a moderate population size $\\lambda$ chosen by the heuristic $\\lambda=4+\\lfloor 3\\log d\\rfloor$, without explicit resampling unless justified by your analysis.\n\nAll methods must operate under the fixed per-iteration shot budget $S_{\\mathrm{tot}}$. You may assume that for SPSA the two energy evaluations per iteration are executed back-to-back within a window $\\Delta t\\simeq 2 t_{\\mathrm{eval}}$, while for CMA-ES the $\\lambda$ evaluations are distributed over the iteration with separations of order $t_{\\mathrm{eval}}$ to $10\\,t_{\\mathrm{eval}}$. For L-BFGS, assume parameter-shift gradients require $2$ energy evaluations per parameter per iteration, and the line-search requires, on average, an additional $4$ energy evaluations per iteration; all gradient-pair evaluations for a given parameter are executed back-to-back.\n\nStarting from the definitions above and standard facts about stochastic approximation and quasi-Newton methods, reason which optimizer is expected to yield the most noise-robust convergence to a neighborhood of $\\boldsymbol{\\theta}^{\\star}$ of radius commensurate with the noise floor within a fixed wall-clock budget, and justify your choice by deriving the relevant signal-to-noise trade-offs that arise from the noise model, the per-iteration shot allocation, and the curvature information $[m,L]$. In your justification, explicitly analyze how the correlated device noise affects the variance of pairwise difference estimators and how the per-iteration shot allocation interacts with the optimizer’s sampling pattern.\n\nWhich option do you choose?\n\nA. L-BFGS with parameter-shift gradients and backtracking Armijo-Wolfe line-search, because quasi-Newton curvature acceleration dominates noise effects; the pairwise gradient evaluations sufficiently cancel device noise, and line-search reliably refines steps under stochastic noise.\n\nB. SPSA with two-point symmetric perturbations, decaying gain sequences, and Polyak-Ruppert iterate averaging, because back-to-back measurements exploit common-mode device-noise cancellation in the difference estimator while using only $2$ evaluations per iteration concentrates shots, improving gradient signal-to-noise ratio and ensuring stochastic-approximation convergence in the strongly convex basin.\n\nC. CMA-ES with $\\lambda=4+\\lfloor 3\\log d\\rfloor$ and no resampling, because rank-based selection is invariant to monotone noise distortions and the population-based search averages away device noise across candidates, yielding robust progress in low dimensions.\n\nD. CMA-ES with the same $\\lambda$ but with resampling the top $\\mu$ candidates $r=3$ times each to reduce measurement noise, because resampling eliminates misranking even when device noise dominates, and the larger evaluation count per iteration remains compatible with the fixed shot budget.", "solution": "The problem requires a comparative analysis of three optimization algorithms—L-BFGS, SPSA, and CMA-ES—for a Variational Quantum Eigensolver (VQE) experiment under a realistic noise model and a fixed computational budget. The goal is to determine which optimizer is most robust and efficient for finding the ground state of the deuteron.\n\nFirst, I will formalize the noise model and analyze its impact on finite-difference measurements, which are the basis for gradient estimation in L-BFGS and SPSA.\n\nAn energy evaluation at wall-clock time $t$ with $N$ shots yields a noisy estimate $\\widehat{E}(\\boldsymbol{\\theta}) = E(\\boldsymbol{\\theta}) + \\epsilon_s + \\eta(t)$. The total noise variance for a single measurement is $\\mathrm{Var}(\\widehat{E}) = \\mathrm{Var}(\\epsilon_s) + \\mathrm{Var}(\\eta(t)) = \\sigma_s^2/N + \\sigma_d^2$.\n\nOptimizers often use a two-point finite difference to estimate a gradient or a change in energy: $\\Delta \\widehat{E} = \\widehat{E}_1 - \\widehat{E}_2$, where the evaluations are separated by a time interval $\\Delta t = |t_1 - t_2|$. The variance of this difference is:\n$$ \\mathrm{Var}(\\Delta \\widehat{E}) = \\mathrm{Var}(\\widehat{E}_1) + \\mathrm{Var}(\\widehat{E}_2) - 2\\mathrm{Cov}(\\widehat{E}_1, \\widehat{E}_2) $$\nThe shot noise $\\epsilon_s$ is independent for different evaluations. The device noise $\\eta(t)$ is correlated over time. Assuming the shots for each evaluation are allocated equally ($N_1 = N_2 = N$), the variance becomes:\n$$ \\mathrm{Var}(\\Delta \\widehat{E}) = \\left(\\frac{\\sigma_s^2}{N} + \\sigma_d^2\\right) + \\left(\\frac{\\sigma_s^2}{N} + \\sigma_d^2\\right) - 2\\mathrm{Cov}(\\eta(t_1), \\eta(t_2)) $$\nUsing the given correlation function $C(\\Delta t) = \\mathrm{Cov}(\\eta(t_1), \\eta(t_2)) = \\sigma_d^2 e^{-|\\Delta t|/\\tau_c}$:\n$$ \\mathrm{Var}(\\Delta \\widehat{E}) = \\frac{2\\sigma_s^2}{N} + 2\\sigma_d^2 - 2\\sigma_d^2 e^{-\\Delta t/\\tau_c} = \\frac{2\\sigma_s^2}{N} + 2\\sigma_d^2(1 - e^{-\\Delta t/\\tau_c}) $$\nThis equation is central to the analysis. It shows two key effects:\n1.  **Shot Noise**: The contribution from shot noise, $2\\sigma_s^2/N$, can be reduced by increasing the number of shots $N$ per evaluation.\n2.  **Device Noise**: The contribution from device noise, $2\\sigma_d^2(1 - e^{-\\Delta t/\\tau_c})$, can be reduced by performing the two measurements very close together in time, i.e., making $\\Delta t \\ll \\tau_c$. This effect is known as common-mode noise rejection.\n\nNow, let's analyze each optimizer in the context of the given parameters: $d=12$, $S_{\\mathrm{tot}}=4\\times 10^4$, $\\sigma_s^2 \\le (1\\,\\mathrm{MeV})^2$, $\\sigma_d^2=(0.05\\,\\mathrm{MeV})^2 = 0.0025\\,\\mathrm{MeV}^2$, $\\tau_c=1\\,\\mathrm{s}$, and $t_{\\mathrm{eval}}=0.05\\,\\mathrm{s}$.\n\n**1. L-BFGS (Limited-memory Broyden-Fletcher-Goldfarb-Shanno)**\n*   **Evaluations per iteration**: To compute the gradient via parameter-shift (equivalent to central differences here), $2d = 2 \\times 12 = 24$ evaluations are needed. An additional $4$ evaluations are assumed for the line search, totaling $N_{\\mathrm{eval}} = 28$.\n*   **Shots per evaluation**: The shot budget is spread thin: $N = S_{\\mathrm{tot}} / N_{\\mathrm{eval}} = 40000 / 28 \\approx 1428$.\n*   **Noise Analysis**: The gradient component for parameter $\\theta_j$ is estimated from a pair of evaluations. These are executed back-to-back, so we can assume $\\Delta t \\approx 2t_{\\mathrm{eval}} = 0.1\\,\\mathrm{s}$. The correlation factor is $e^{-\\Delta t/\\tau_c} = e^{-0.1/1} \\approx 0.905$.\n    The variance of the energy difference for a gradient component is:\n    $$ \\mathrm{Var}(\\Delta \\widehat{E})_{\\text{L-BFGS}} \\approx \\frac{2(1)^2}{1428} + 2(0.0025)(1 - 0.905) \\approx 0.00140 + 0.005(0.095) \\approx 0.00188\\,\\mathrm{MeV}^2 $$\n    The shot noise term ($0.00140$) is dominant. The low number of shots per evaluation leads to a noisy gradient. Furthermore, quasi-Newton methods like L-BFGS are notoriously sensitive to noise in the gradient, as it corrupts the approximation of the Hessian inverse. The backtracking line search is also unreliable with stochastic function evaluations, as the Armijo-Wolfe conditions can be met or missed due to statistical fluctuations.\n\n**2. SPSA (Simultaneous Perturbation Stochastic Approximation)**\n*   **Evaluations per iteration**: SPSA is highly efficient, requiring only $N_{\\mathrm{eval}} = 2$ evaluations per iteration, regardless of dimension $d$.\n*   **Shots per evaluation**: This allows for a massive concentration of the shot budget: $N = S_{\\mathrm{tot}} / N_{\\mathrm{eval}} = 40000 / 2 = 20000$.\n*   **Noise Analysis**: The two evaluations are performed back-to-back, with $\\Delta t \\approx 2t_{\\mathrm{eval}} = 0.1\\,\\mathrm{s}$, same as the L-BFGS pairs. The correlation factor is again $e^{-0.1} \\approx 0.905$.\n    The variance of the energy difference is:\n    $$ \\mathrm{Var}(\\Delta \\widehat{E})_{\\text{SPSA}} \\approx \\frac{2(1)^2}{20000} + 2(0.0025)(1 - 0.905) \\approx 0.00010 + 0.00048 \\approx 0.00058\\,\\mathrm{MeV}^2 $$\n    Both noise terms are substantially suppressed. The shot noise is reduced by more than an order of magnitude compared to L-BFGS due to the high shot count. The correlated device noise is effectively cancelled due to the back-to-back measurements. This results in a much higher signal-to-noise ratio for the gradient estimate. As a stochastic approximation algorithm with decaying step sizes and Polyak-Ruppert averaging, SPSA is designed from the ground up to converge in the presence of zero-mean noise. Its primary weakness, lack of curvature information, is less critical than robustness to noise in this scenario.\n\n**3. CMA-ES (Covariance Matrix Adaptation Evolution Strategy)**\n*   **Evaluations per iteration**: The population size is $\\lambda = 4 + \\lfloor 3\\log d\\rfloor = 4 + \\lfloor 3\\log 12\\rfloor = 4 + 7 = 11$. So, $N_{\\mathrm{eval}} = 11$.\n*   **Shots per evaluation**: $N = S_{\\mathrm{tot}} / N_{\\mathrm{eval}} = 40000 / 11 \\approx 3636$.\n*   **Noise Analysis**: The problem states that evaluations are distributed over time, with separations on the order of $t_{\\mathrm{eval}}$ to $10\\,t_{\\mathrm{eval}}$ ($0.05\\,\\mathrm{s}$ to $0.5\\,\\mathrm{s}$). This means the device noise between different members of the population is largely uncorrelated. The noise affecting each candidate's fitness is therefore approximately independent. The variance of a single energy evaluation is:\n    $$ \\mathrm{Var}(\\widehat{E})_{\\text{CMA-ES}} \\approx \\frac{(1)^2}{3636} + 0.0025 \\approx 0.000275 + 0.0025 = 0.002775\\,\\mathrm{MeV}^2 $$\n    The noise standard deviation is $\\sigma_{\\epsilon} = \\sqrt{0.002775} \\approx 0.053\\,\\mathrm{MeV}$. The dominant term is the device noise $\\sigma_d^2$, which is not being cancelled. The core mechanism of CMA-ES is to rank candidates by their fitness. If the noise level $\\sigma_{\\epsilon}$ is comparable to the typical energy differences between candidates, the ranking will be corrupted, leading to incorrect updates of the search distribution's mean and covariance matrix. This can severely hinder or stall convergence.\n\n**Conclusion**\nSPSA presents the most compelling strategy. It is the only method that simultaneously and effectively mitigates both shot noise (by concentrating the shot budget) and correlated device noise (by exploiting common-mode rejection with back-to-back measurements). This leads to the highest quality gradient information per iteration. L-BFGS is too demanding in its number of function calls, making it susceptible to shot noise, and its internal mechanics are not robust to noise. CMA-ES fails to exploit the correlated nature of the device noise, making its ranking procedure unreliable.\n\n**Evaluating the Options:**\n\n*   **A. L-BFGS**: This option is incorrect. It wrongly claims that quasi-Newton acceleration will dominate noise effects and that the line-search is reliable. In high-noise environments, the opposite is true: noise dominates the algorithm's stability.\n*   **B. SPSA**: This option correctly identifies the two crucial advantages of SPSA in this scenario. It highlights the common-mode device noise cancellation from back-to-back measurements and the improved signal-to-noise ratio from concentrating the shot budget. It also correctly refers to the theoretical underpinnings of stochastic approximation for ensuring convergence. This aligns perfectly with the derivation.\n*   **C. CMA-ES**: This option is incorrect. It misinterprets the robustness properties of CMA-ES. The claim that a population-based search \"averages away\" device noise is false in this context; rather, the uncancelled noise corrupts the ranking that is central to the algorithm's update rule.\n*   **D. CMA-ES with resampling**: This option proposes a patch for CMA-ES's noise vulnerability but ignores the cost. Resampling requires more evaluations, which thins the shot budget per evaluation, potentially increasing the shot noise on the initial ranking more than the resampling helps. It does not solve the fundamental problem that CMA-ES is not exploiting the temporal correlation of the device noise, a benefit SPSA gets \"for free\". Therefore, it is not the optimal strategy.\n\nThe most robust and effective optimizer for the specified problem is SPSA.", "answer": "$$\\boxed{B}$$", "id": "3611032"}]}