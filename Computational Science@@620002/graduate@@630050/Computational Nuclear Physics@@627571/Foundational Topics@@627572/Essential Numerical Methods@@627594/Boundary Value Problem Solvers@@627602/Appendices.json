{"hands_on_practices": [{"introduction": "Our exploration of hands-on techniques begins with the foundational Finite Difference Method (FDM), often the first tool applied to a boundary value problem. This exercise goes beyond simple implementation to analyze the method's numerical stability by deriving the condition number of the discretized system. Understanding how numerical error is amplified as the grid becomes finer is a crucial first step in becoming a proficient computational physicist [@problem_id:3545166].", "problem": "In computational nuclear physics, boundary value problem solvers are often applied to the steady-state one-dimensional ($1\\text{D}$) neutron diffusion model on a slab, where transport and absorption are reduced to diffusion with prescribed vacuum boundaries. Consider the canonical scalar elliptic boundary value problem on the interval $[0,1]$,\n$$\n-u''(x) = f(x), \\quad x \\in [0,1], \\quad u(0) = 0, \\quad u(1) = 0,\n$$\nas the leading-order diffusion operator that appears in such solvers. Discretize the interval with $n$ interior points at $x_i = i h$ for $i = 1,2,\\dots,n$ and grid spacing $h = \\frac{1}{n+1}$, and use the standard second-order central finite difference (Finite Difference (FD)) scheme to obtain the linear system $A \\boldsymbol{u} = \\boldsymbol{f}$, where $A \\in \\mathbb{R}^{n \\times n}$ is the stiffness matrix. The matrix $A$ is symmetric positive definite (Symmetric Positive Definite (SPD)) and tridiagonal Toeplitz with entries\n$$\nA_{ii} = \\frac{2}{h^{2}}, \\quad A_{i,i+1} = A_{i+1,i} = -\\frac{1}{h^{2}}, \\quad i = 1,2,\\dots,n-1.\n$$\nStarting from the definition of the matrix $2$-norm condition number $\\kappa_{2}(A) = \\|A\\|_{2} \\,\\|A^{-1}\\|_{2}$ and the discrete eigenvalue problem $A \\boldsymbol{v} = \\lambda \\boldsymbol{v}$ subject to the homogeneous Dirichlet boundary encoding $\\boldsymbol{v}_0 = \\boldsymbol{v}_{n+1} = \\boldsymbol{0}$, derive the spectrum of $A$ and use it to obtain a closed-form expression for $\\kappa_{2}(A)$ as a function of $n$. Using asymptotic analysis in the limit $h \\to 0$ (equivalently $n \\to \\infty$), justify from first principles that $\\kappa_{2}(A)$ exhibits $O(h^{-2})$ growth and determine the leading-order constant multiplying $h^{-2}$. Express your final answer as a single closed-form analytic expression for $\\kappa_{2}(A)$ in terms of $n$. No rounding is required; the condition number is dimensionless and should be reported without units.", "solution": "The problem is subjected to validation.\n\n### Step 1: Extract Givens\n-   **Equation:** $-u''(x) = f(x)$\n-   **Domain:** $x \\in [0,1]$\n-   **Boundary Conditions:** $u(0) = 0$, $u(1) = 0$\n-   **Discretization:** $n$ interior points $x_i = i h$ for $i = 1,2,\\dots,n$\n-   **Grid Spacing:** $h = \\frac{1}{n+1}$\n-   **Scheme:** Second-order central finite difference\n-   **Linear System:** $A \\boldsymbol{u} = \\boldsymbol{f}$\n-   **Matrix Properties:** $A \\in \\mathbb{R}^{n \\times n}$ is symmetric positive definite (SPD) and tridiagonal Toeplitz.\n-   **Matrix Entries:** $A_{ii} = \\frac{2}{h^{2}}$, $A_{i,i+1} = A_{i+1,i} = -\\frac{1}{h^{2}}$ for $i = 1,2,\\dots,n-1$.\n-   **Definition:** $\\kappa_{2}(A) = \\|A\\|_{2} \\,\\|A^{-1}\\|_{2}$\n-   **Eigenvalue Problem:** $A \\boldsymbol{v} = \\lambda \\boldsymbol{v}$ with $\\boldsymbol{v}_0 = \\boldsymbol{v}_{n+1} = 0$.\n-   **Task 1:** Derive the spectrum of $A$ and obtain a closed-form expression for $\\kappa_{2}(A)$ as a function of $n$.\n-   **Task 2:** Perform asymptotic analysis for $h \\to 0$ ($n \\to \\infty$) to show $\\kappa_{2}(A)$ has $O(h^{-2})$ growth and find the leading-order constant.\n-   **Final Answer Format:** A single closed-form analytic expression for $\\kappa_{2}(A)$ in terms of $n$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically grounded, well-posed, and objective. It describes the standard finite difference discretization of the one-dimensional Poisson equation, a canonical problem in numerical analysis and a fundamental model in computational physics, including neutron diffusion. All mathematical definitions and properties are stated correctly and consistently. The problem is self-contained, providing all necessary information to derive the solution. There are no contradictions, ambiguities, or scientifically unsound premises.\n\n### Step 3: Verdict and Action\nThe problem is valid. The solution process will now proceed.\n\nThe matrix $A$ is symmetric positive definite (SPD). For any SPD matrix, the matrix $2$-norm, $\\|A\\|_2$, is its largest eigenvalue ($\\lambda_{\\text{max}}$), and the $2$-norm of its inverse, $\\|A^{-1}\\|_2$, is the reciprocal of its smallest eigenvalue ($\\lambda_{\\text{min}}$). The condition number $\\kappa_2(A)$ is therefore given by the ratio of the maximum to the minimum eigenvalue:\n$$\n\\kappa_2(A) = \\|A\\|_2 \\|A^{-1}\\|_2 = \\frac{\\lambda_{\\text{max}}(A)}{\\lambda_{\\text{min}}(A)}\n$$\nTo find $\\kappa_2(A)$, we must first determine the spectrum (the set of all eigenvalues) of the matrix $A$. The eigenvalue problem is $A \\boldsymbol{v} = \\lambda \\boldsymbol{v}$, where $\\boldsymbol{v}$ is an eigenvector and $\\lambda$ is its corresponding eigenvalue.\n\nThe matrix $A$ is given by $A = \\frac{1}{h^2} T$, where $T$ is the tridiagonal Toeplitz matrix:\n$$\nT = \\begin{pmatrix}\n2  -1  0  \\cdots  0 \\\\\n-1  2  -1  \\cdots  0 \\\\\n0  \\ddots  \\ddots  \\ddots  \\vdots \\\\\n\\vdots   -1  2  -1 \\\\\n0  \\cdots  0  -1  2\n\\end{pmatrix} \\in \\mathbb{R}^{n \\times n}\n$$\nThe eigenvalue problem $A \\boldsymbol{v} = \\lambda \\boldsymbol{v}$ can be written as $T\\boldsymbol{v} = (\\lambda h^2) \\boldsymbol{v}$. Let $\\mu = \\lambda h^2$ be an eigenvalue of $T$. The $i$-th component of this equation is:\n$$\n-v_{i-1} + 2v_i - v_{i+1} = \\mu v_i, \\quad i = 1, 2, \\dots, n\n$$\nWe rearrange this into a homogeneous second-order linear difference equation:\n$$\n-v_{i-1} + (2-\\mu)v_i - v_{i+1} = 0\n$$\nThe problem states that the discretization includes the homogeneous Dirichlet boundary conditions, which are encoded as $v_0 = 0$ and $v_{n+1} = 0$. We seek a non-trivial solution for the eigenvector components $v_i$. We use the ansatz $v_i = z^i$ for some complex number $z$. Substituting this into the difference equation yields:\n$$\n-z^{i-1} + (2-\\mu)z^i - z^{i+1} = 0\n$$\nDividing by $z^{i-1}$ (assuming $z \\neq 0$), we obtain the characteristic equation:\n$$\n-1 + (2-\\mu)z - z^2 = 0 \\quad \\implies \\quad z^2 - (2-\\mu)z + 1 = 0\n$$\nThe roots of this quadratic equation are $z_{1,2} = \\frac{(2-\\mu) \\pm \\sqrt{(2-\\mu)^2-4}}{2}$. Since the product of the roots is $z_1 z_2 = 1$, we can denote them by $z$ and $z^{-1}$. Let us set $z = e^{i\\theta}$ for some $\\theta$. The general solution for $v_i$ is a linear combination of the two forms:\n$$\nv_i = C_1 z^i + C_2 z^{-i}\n$$\nApplying the boundary condition $v_0 = 0$:\n$$\nv_0 = C_1 z^0 + C_2 z^{-0} = C_1 + C_2 = 0 \\implies C_2 = -C_1\n$$\nThis simplifies the solution to $v_i = C_1(z^i - z^{-i})$. If we set $z = e^{i\\theta}$, this becomes:\n$$\nv_i = C_1(e^{i\\theta i} - e^{-i\\theta i}) = 2i C_1 \\sin(i\\theta)\n$$\nLet a new constant $C = 2i C_1$. Then the form of the eigenvector components is $v_i = C \\sin(i\\theta)$.\nNow, we apply the second boundary condition, $v_{n+1}=0$:\n$$\nv_{n+1} = C \\sin((n+1)\\theta) = 0\n$$\nFor a non-trivial eigenvector, $C \\neq 0$, so we must have $\\sin((n+1)\\theta) = 0$. This implies $(n+1)\\theta = k\\pi$ for an integer $k$. Thus, the possible values for $\\theta$ are:\n$$\n\\theta_k = \\frac{k\\pi}{n+1}, \\quad k = 1, 2, \\dots, n\n$$\nThe values $k=0$ and $k=n+1$ yield trivial eigenvectors ($v_i=0$ for all $i$), and other integer values of $k$ lead to eigenvectors that are equivalent (up to a sign) to those for $k \\in \\{1, \\dots, n\\}$. So, we have $n$ distinct eigenvectors, whose components are given by:\n$$\n(v_k)_i = \\sin\\left(\\frac{ik\\pi}{n+1}\\right), \\quad i=1, \\dots, n \\quad \\text{for each } k=1, \\dots, n\n$$\nNow we find the eigenvalues $\\mu_k$ corresponding to each eigenvector $v_k$. From the characteristic equation, we have $2-\\mu = z + z^{-1}$. With $z = e^{i\\theta_k}$, this becomes:\n$$\n2-\\mu_k = e^{i\\theta_k} + e^{-i\\theta_k} = 2\\cos(\\theta_k)\n$$\nSolving for $\\mu_k$:\n$$\n\\mu_k = 2 - 2\\cos(\\theta_k) = 4\\sin^2\\left(\\frac{\\theta_k}{2}\\right)\n$$\nSubstituting $\\theta_k = \\frac{k\\pi}{n+1}$:\n$$\n\\mu_k = 4\\sin^2\\left(\\frac{k\\pi}{2(n+1)}\\right), \\quad k = 1, 2, \\dots, n\n$$\nThese are the eigenvalues of the matrix $T$. The eigenvalues $\\lambda_k$ of the original matrix $A = \\frac{1}{h^2}T$ are:\n$$\n\\lambda_k = \\frac{\\mu_k}{h^2} = \\frac{4}{h^2}\\sin^2\\left(\\frac{k\\pi}{2(n+1)}\\right), \\quad k = 1, 2, \\dots, n\n$$\nThe sine function is monotonically increasing on the interval $[0, \\frac{\\pi}{2}]$. The argument $\\frac{k\\pi}{2(n+1)}$ is in this range for all $k \\in \\{1, \\dots, n\\}$, since $\\frac{n\\pi}{2(n+1)}  \\frac{\\pi}{2}$.\nThe minimum eigenvalue $\\lambda_{\\text{min}}$ occurs at $k=1$:\n$$\n\\lambda_{\\text{min}} = \\lambda_1 = \\frac{4}{h^2}\\sin^2\\left(\\frac{\\pi}{2(n+1)}\\right)\n$$\nThe maximum eigenvalue $\\lambda_{\\text{max}}$ occurs at $k=n$:\n$$\n\\lambda_{\\text{max}} = \\lambda_n = \\frac{4}{h^2}\\sin^2\\left(\\frac{n\\pi}{2(n+1)}\\right)\n$$\nNow, we can compute the condition number:\n$$\n\\kappa_2(A) = \\frac{\\lambda_{\\text{max}}}{\\lambda_{\\text{min}}} = \\frac{\\frac{4}{h^2}\\sin^2\\left(\\frac{n\\pi}{2(n+1)}\\right)}{\\frac{4}{h^2}\\sin^2\\left(\\frac{\\pi}{2(n+1)}\\right)} = \\frac{\\sin^2\\left(\\frac{n\\pi}{2(n+1)}\\right)}{\\sin^2\\left(\\frac{\\pi}{2(n+1)}\\right)}\n$$\nUsing the identity $\\sin(x) = \\cos(\\frac{\\pi}{2}-x)$, we can rewrite the numerator:\n$$\n\\sin\\left(\\frac{n\\pi}{2(n+1)}\\right) = \\sin\\left(\\frac{(n+1-1)\\pi}{2(n+1)}\\right) = \\sin\\left(\\frac{\\pi}{2} - \\frac{\\pi}{2(n+1)}\\right) = \\cos\\left(\\frac{\\pi}{2(n+1)}\\right)\n$$\nSubstituting this back into the expression for $\\kappa_2(A)$:\n$$\n\\kappa_2(A) = \\frac{\\cos^2\\left(\\frac{\\pi}{2(n+1)}\\right)}{\\sin^2\\left(\\frac{\\pi}{2(n+1)}\\right)} = \\cot^2\\left(\\frac{\\pi}{2(n+1)}\\right)\n$$\nThis is the closed-form expression for $\\kappa_2(A)$ as a function of $n$.\n\nFor the asymptotic analysis as $h \\to 0$ (which implies $n \\to \\infty$), we consider the argument of the cotangent function, $x = \\frac{\\pi}{2(n+1)}$. As $n \\to \\infty$, $x \\to 0$. We use the small-angle approximation for the cotangent function, which can be derived from the Taylor series of sine and cosine:\n$\\sin(x) = x - O(x^3)$ and $\\cos(x) = 1 - O(x^2)$.\n$$\n\\cot(x) = \\frac{\\cos(x)}{\\sin(x)} \\approx \\frac{1}{x} \\quad \\text{for } x \\ll 1\n$$\nTherefore, for large $n$:\n$$\n\\kappa_2(A) = \\cot^2(x) \\approx \\left(\\frac{1}{x}\\right)^2 = \\frac{1}{x^2} = \\frac{1}{\\left(\\frac{\\pi}{2(n+1)}\\right)^2} = \\frac{4(n+1)^2}{\\pi^2}\n$$\nGiven the definition $h = \\frac{1}{n+1}$, we can express this in terms of $h$:\n$$\n\\kappa_2(A) \\approx \\frac{4(1/h)^2}{\\pi^2} = \\frac{4}{\\pi^2 h^2} = \\frac{4}{\\pi^2} h^{-2}\n$$\nThis justifies from first principles that $\\kappa_2(A)$ exhibits $O(h^{-2})$ growth, and the leading-order constant multiplying $h^{-2}$ is $\\frac{4}{\\pi^2}$. The problem asks for the single closed-form expression for $\\kappa_2(A)$ in terms of $n$, which was derived prior to the asymptotic analysis.", "answer": "$$\n\\boxed{\\cot^2\\left(\\frac{\\pi}{2(n+1)}\\right)}\n$$", "id": "3545166"}, {"introduction": "Building on our understanding of discretization, we now turn to the more powerful and flexible Finite Element Method (FEM), which is exceptionally well-suited for problems with varying material properties, such as in neutron diffusion. This practice provides a concrete, first-principles guide to constructing the essential components of an FEM solver: deriving the weak form and assembling the system matrices for a variable-coefficient problem. Mastering this process is key to applying FEM to a wide range of realistic physics scenarios [@problem_id:3545228].", "problem": "Consider the nondimensional, one-dimensional, steady-state, one-group neutron diffusion boundary value problem on the interval $[0,1]$:\n$$\n-\\frac{d}{dx}\\!\\left(p(x)\\,\\frac{du}{dx}\\right) + q(x)\\,u(x) = s(x),\n$$\nwith Dirichlet boundary conditions $u(0)=\\alpha$ and $u(1)=\\beta$. Here $p(x)$ models the spatially varying diffusion coefficient, $q(x)$ models the spatially varying macroscopic absorption, and $s(x)$ is a volumetric neutron source. Work in nondimensional units.\n\nTasks:\n- Starting from the strong form, derive the weak form using the standard variational framework for second-order linear elliptic operators. Clearly identify the bilinear form and the linear functional and specify the associated function spaces. Define any acronyms on first use (e.g., Finite Element Method (FEM), Partial Differential Equation (PDE)).\n- Introduce a lifting function $l(x)$ that enforces the Dirichlet boundary data, write $u = w + l$ with $w \\in H_0^1(0,1)$, and show how the right-hand side is modified in the weak form.\n- For the FEM with continuous, piecewise-linear shape functions on a generic element $e = [x_i,x_{i+1}]$ of length $h_i = x_{i+1}-x_i$, derive, from first principles, the element stiffness matrix and element load vector in terms of $p(x)$, $q(x)$, $s(x)$, and the lifting $l(x)$:\n  - Express $K^{(e)}_{ab}$ for $a,b \\in \\{i,i+1\\}$ as integrals involving $p(x)$, $q(x)$, and the element shape functions and their derivatives.\n  - Express $f^{(e)}_{a}$ for $a \\in \\{i,i+1\\}$ as integrals involving $s(x)$, $p(x)$, $q(x)$, $l(x)$, and the element shape functions and their derivatives.\n- Specialize to the case\n$$\np(x) = 1 + x,\\qquad q(x) = x,\\qquad s(x) = 1 + x^2,\n$$\nwith Dirichlet data $\\alpha = 0.2$ and $\\beta = 0.6$. Choose the linear lifting $l(x) = \\alpha + (\\beta-\\alpha)\\,x$. Use a uniform mesh with $2$ linear finite elements and nodes at $x_0=0$, $x_1=0.5$, $x_2=1$. Assemble the global system for the single interior unknown and compute the finite element approximation $u_h(x_1)$ exactly.\n\nAnswer form:\n- Provide your final answer as the single scalar value of $u_h(0.5)$.\n- Express the final answer as an exact rational number. Do not include units.", "solution": "We begin from the steady-state one-group neutron diffusion Partial Differential Equation (PDE):\n$$\n-\\frac{d}{dx}\\!\\left(p(x)\\,\\frac{du}{dx}\\right) + q(x)\\,u(x) = s(x)\\quad \\text{in } (0,1),\n$$\nwith Dirichlet boundary conditions $u(0)=\\alpha$ and $u(1)=\\beta$. We seek a weak (variational) formulation on the Sobolev space $H^1(0,1)$ with trial functions satisfying the boundary conditions. Let $V := H_0^1(0,1)$ and let test functions $v \\in V$. Multiply the PDE by $v$ and integrate by parts the diffusion term:\n$$\n\\int_0^1 p(x)\\,u'(x)\\,v'(x)\\,dx + \\int_0^1 q(x)\\,u(x)\\,v(x)\\,dx = \\int_0^1 s(x)\\,v(x)\\,dx,\n$$\nwhere the boundary term vanishes because $v(0)=v(1)=0$. Define the bilinear form\n$$\na(u,v) := \\int_0^1 p(x)\\,u'(x)\\,v'(x)\\,dx + \\int_0^1 q(x)\\,u(x)\\,v(x)\\,dx,\n$$\nand the linear functional\n$$\n\\ell(v) := \\int_0^1 s(x)\\,v(x)\\,dx.\n$$\nThe weak problem is: find $u \\in H^1(0,1)$ with $u(0)=\\alpha$, $u(1)=\\beta$ such that\n$$\na(u,v) = \\ell(v)\\quad \\forall v \\in V.\n$$\n\nTo impose Dirichlet boundary data via a lifting function, choose $l \\in H^1(0,1)$ with $l(0)=\\alpha$ and $l(1)=\\beta$, and write $u = w + l$, where $w \\in V$. Substituting into the weak form gives\n$$\na(w+l,v) = \\ell(v)\\quad \\forall v \\in V,\n$$\nhence\n$$\na(w,v) = \\ell(v) - a(l,v) = \\int_0^1 s(x)\\,v(x)\\,dx - \\int_0^1 p(x)\\,l'(x)\\,v'(x)\\,dx - \\int_0^1 q(x)\\,l(x)\\,v(x)\\,dx.\n$$\nThus, the lifting modifies only the right-hand side as\n$$\nf(v) := \\int_0^1 s(x)\\,v(x)\\,dx - \\int_0^1 p(x)\\,l'(x)\\,v'(x)\\,dx - \\int_0^1 q(x)\\,l(x)\\,v(x)\\,dx,\n$$\nwhile the bilinear form $a(\\cdot,\\cdot)$ on $V$ remains unchanged.\n\nFor the Finite Element Method (FEM), consider an element $e=[x_i,x_{i+1}]$ with length $h_i = x_{i+1}-x_i$. Let $\\{N_i,N_{i+1}\\}$ be the element’s linear shape functions, with $N_i(x_i)=1$, $N_i(x_{i+1})=0$, $N_{i+1}(x_i)=0$, $N_{i+1}(x_{i+1})=1$, and $N_i' = -1/h_i$, $N_{i+1}' = 1/h_i$. The element stiffness matrix entries are derived directly from the bilinear form:\n$$\nK^{(e)}_{ab} = \\int_{x_i}^{x_{i+1}} p(x)\\,N_a'(x)\\,N_b'(x)\\,dx + \\int_{x_i}^{x_{i+1}} q(x)\\,N_a(x)\\,N_b(x)\\,dx,\\quad a,b\\in\\{i,i+1\\}.\n$$\nThe element load vector entries, using the lifted right-hand side, are\n$$\nf^{(e)}_{a} = \\int_{x_i}^{x_{i+1}} s(x)\\,N_a(x)\\,dx - \\int_{x_i}^{x_{i+1}} p(x)\\,l'(x)\\,N_a'(x)\\,dx - \\int_{x_i}^{x_{i+1}} q(x)\\,l(x)\\,N_a(x)\\,dx,\\quad a\\in\\{i,i+1\\}.\n$$\nGlobal assembly follows from standard finite element procedures by summing contributions from adjacent elements to shared global degrees of freedom.\n\nNow specialize to\n$$\np(x)=1+x,\\quad q(x)=x,\\quad s(x)=1+x^2,\n$$\nwith Dirichlet data $\\alpha=0.2$ and $\\beta=0.6$. Choose the linear lifting\n$$\nl(x) = \\alpha + (\\beta-\\alpha)\\,x = 0.2 + 0.4\\,x,\n$$\nso $l'(x)=0.4$. Use the uniform mesh with $2$ elements and nodes $x_0=0$, $x_1=0.5$, $x_2=1$. The discrete unknown is the single interior degree of freedom $w_1 \\approx w(x_1)$ associated with the global hat basis function $\\phi_1$. The global stiffness for $w_1$ is\n$$\nK_{11} = \\int_0^1 p(x)\\,(\\phi_1'(x))^2\\,dx + \\int_0^1 q(x)\\,(\\phi_1(x))^2\\,dx.\n$$\nOn $[0,0.5]$, $\\phi_1(x)=2x$ and $\\phi_1'(x)=2$. On $[0.5,1]$, $\\phi_1(x)=2(1-x)$ and $\\phi_1'(x)=-2$.\n\nCompute the diffusion part:\n$$\n\\int_0^{0.5} (1+x)\\,(2)^2 dx = 4\\int_0^{0.5} (1+x)\\,dx = 4\\left(\\frac{5}{8}\\right)=\\frac{5}{2},\n$$\n$$\n\\int_{0.5}^{1} (1+x)\\,( -2)^2 dx = 4\\int_{0.5}^{1} (1+x)\\,dx = 4\\left(\\frac{7}{8}\\right)=\\frac{7}{2}.\n$$\nThus the diffusion contribution sums to $\\frac{5}{2}+\\frac{7}{2}=6$.\n\nCompute the absorption part:\n$$\n\\int_0^{0.5} x\\,(2x)^2\\,dx = \\int_0^{0.5} 4x^3\\,dx = \\left[x^4\\right]_0^{0.5} = \\frac{1}{16},\n$$\n$$\n\\int_{0.5}^{1} x\\,[2(1-x)]^2\\,dx = \\int_{0.5}^{1} 4x(1-2x+x^2)\\,dx = \\frac{5}{48}.\n$$\nThus the absorption contribution is $\\frac{1}{16}+\\frac{5}{48}=\\frac{1}{6}$. Therefore\n$$\nK_{11} = 6 + \\frac{1}{6} = \\frac{37}{6}.\n$$\n\nNext compute the lifted right-hand side for the single test function $\\phi_1$:\n$$\nf_1 = \\int_0^1 s(x)\\,\\phi_1(x)\\,dx - \\int_0^1 p(x)\\,l'(x)\\,\\phi_1'(x)\\,dx - \\int_0^1 q(x)\\,l(x)\\,\\phi_1(x)\\,dx.\n$$\nCompute each term piecewise.\n\nSource term:\nOn $[0,0.5]$, $(1+x^2)\\,(2x) = 2x + 2x^3$ gives\n$$\n\\int_0^{0.5} (2x + 2x^3)\\,dx = \\left[x^2 + \\frac{x^4}{2}\\right]_0^{0.5} = \\frac{1}{4}+\\frac{1}{32} = \\frac{9}{32}.\n$$\nOn $[0.5,1]$, $(1+x^2)\\,2(1-x) = 2 - 2x + 2x^2 - 2x^3$ gives\n$$\n\\int_{0.5}^{1} (2 - 2x + 2x^2 - 2x^3)\\,dx = \\left[2x - x^2 + \\frac{2}{3}x^3 - \\frac{1}{2}x^4\\right]_{0.5}^{1} = \\frac{35}{96}.\n$$\nThus\n$$\n\\int_0^1 s(x)\\,\\phi_1(x)\\,dx = \\frac{9}{32} + \\frac{35}{96} = \\frac{31}{48}.\n$$\n\nLifting–diffusion coupling term:\nSince $l'(x)=0.4=\\frac{2}{5}$ and $\\phi_1'$ is constant on each subinterval,\n$$\n\\int_0^1 p(x)\\,l'(x)\\,\\phi_1'(x)\\,dx = \\frac{2}{5}\\left[2\\int_0^{0.5}(1+x)\\,dx - 2\\int_{0.5}^{1}(1+x)\\,dx\\right]\n= \\frac{2}{5}\\left[2\\cdot\\frac{5}{8} - 2\\cdot\\frac{7}{8}\\right] = -\\frac{1}{5}.\n$$\n\nLifting–absorption coupling term:\nOn $[0,0.5]$, $x\\,l(x)\\,\\phi_1(x) = x\\,(0.2+0.4x)\\,(2x) = 0.4 x^2 + 0.8 x^3$, hence\n$$\n\\int_0^{0.5} \\left(0.4 x^2 + 0.8 x^3\\right)\\,dx = \\frac{1}{60} + \\frac{1}{80} = \\frac{7}{240}.\n$$\nOn $[0.5,1]$, $x\\,l(x)\\,\\phi_1(x) = x\\,(0.2+0.4x)\\,2(1-x) = 0.4 x + 0.4 x^2 - 0.8 x^3$, hence\n$$\n\\int_{0.5}^{1} \\left(0.4 x + 0.4 x^2 - 0.8 x^3\\right)\\,dx \n= \\left[\\frac{1}{5}x^2 + \\frac{2}{15}x^3 - \\frac{1}{5}x^4\\right]_{0.5}^{1} = \\frac{19}{240}.\n$$\nTherefore\n$$\n\\int_0^1 q(x)\\,l(x)\\,\\phi_1(x)\\,dx = \\frac{7}{240} + \\frac{19}{240} = \\frac{13}{120}.\n$$\n\nCollecting the terms,\n$$\nf_1 = \\frac{31}{48} - \\left(-\\frac{1}{5}\\right) - \\frac{13}{120} = \\frac{31}{48} + \\frac{1}{5} - \\frac{13}{120} = \\frac{59}{80}.\n$$\n\nThe discrete equation for the single unknown $w_1$ is\n$$\nK_{11}\\,w_1 = f_1 \\quad \\Longrightarrow \\quad w_1 = \\frac{f_1}{K_{11}} = \\frac{\\frac{59}{80}}{\\frac{37}{6}} = \\frac{177}{1480}.\n$$\nRecover $u_h$ at the interior node by adding the lifting:\n$$\nu_h(0.5) = w_1 + l(0.5) = \\frac{177}{1480} + \\left(0.2 + 0.4\\cdot 0.5\\right) = \\frac{177}{1480} + \\frac{2}{5} = \\frac{177}{1480} + \\frac{592}{1480} = \\frac{769}{1480}.\n$$\nThis is the exact rational value of the finite element approximation at $x=0.5$ with the specified data.", "answer": "$$\\boxed{\\frac{769}{1480}}$$", "id": "3545228"}, {"introduction": "A robust numerical solver is only as good as the physical model and boundary conditions it is given. This final practice moves from the mechanics of the solver to the physics of the problem setup, a critical and often overlooked step. You will develop an algorithm that automatically selects the correct asymptotic boundary condition and estimates the required computational domain based on the fundamental physical parameters of a two-body system, such as energy and charge [@problem_id:3545155].", "problem": "You are to construct a complete, runnable program that, for a two-body radial Schrödinger boundary value problem in computational nuclear physics, automatically selects the appropriate large-radius boundary condition and estimates the radial domain size. The physical context is the radial equation for a spherically symmetric two-body problem, where the reduced radial wave function $u(r)$ satisfies\n$$\nu''(r) + \\left[k^2 - \\frac{2\\mu}{\\hbar^2}V(r) - \\frac{l(l+1)}{r^2}\\right]u(r) = 0,\n$$\nwith reduced mass $\\mu$, orbital angular momentum quantum number $l$, and center-of-mass energy $E$. The effective potential is $V_{\\mathrm{eff}}(r) = V(r) + \\hbar^2 l(l+1)/(2\\mu r^2)$. For nuclear interactions, the short-range nuclear potential $V(r)$ vanishes for sufficiently large $r$, and, for charged projectiles, a Coulomb tail $V_C(r) = Z e^2/r$ persists, where $Z$ is the product of the projectile and target charges in elementary charge units. The asymptotic form of the solution determines the boundary condition class: free-wave, Coulomb-wave, or absorbing.\n\nYour task is to implement a boundary-condition selector that, from $(Z,l,E)$, decides among:\n- free-wave asymptotics (encode as integer $0$),\n- Coulomb-wave asymptotics (encode as integer $1$),\n- absorbing boundary condition (encode as integer $2$).\n\nThe selection must be derived from first principles as follows.\n\nStart from the radial Schrödinger equation and the definition of the effective potential. Use the physical requirement that the asymptotic region is one in which the residual potential contribution is small compared to the kinetic or binding scale. Concretely, impose the potential smallness criterion at large $r$:\n$$\n\\left|\\frac{Z e^2}{r}\\right| \\le \\varepsilon |E|,\\quad \\frac{\\hbar^2 l(l+1)}{2\\mu r^2} \\le \\varepsilon |E|,\n$$\nwhere $\\varepsilon$ is a small, fixed dimensionless threshold. This threshold defines an asymptotic radius $r_{\\mathrm{asym}}$ beyond which the solution behaves approximately as a free or Coulomb solution. The sign of $E$ distinguishes scattering-like $(E0)$ from bound-like $(E\\le 0)$ asymptotics. Use the de Broglie wavenumber $k$ for $E0$ and the decay constant $\\kappa$ for $E\\le 0$, where\n$$\nk = \\frac{\\sqrt{2 \\mu E}}{\\hbar c},\\qquad \\kappa = \\frac{\\sqrt{2 \\mu |E|}}{\\hbar c}.\n$$\nHere $c$ is the speed of light, and we use a mixed unit convention in which energies are in megaelectronvolts and lengths in femtometers with $c=1$ and $\\hbar c$ as given below. To ensure that the numerical boundary condition is imposed where outgoing or incoming character is well resolved, require an additional buffer of a fixed number of wavelengths for $E0$:\n$$\nr_k = N_{\\lambda}\\times \\frac{2\\pi}{k}.\n$$\n\nYour program must implement and justify the following decision logic from these principles:\n- If $E \\le 0$: select free-wave asymptotics if $Z = 0$ or Coulomb-wave asymptotics if $Z \\ne 0$. Estimate $r_{\\max}$ as the maximum of the asymptotic radius set by the potential smallness criterion and the decay distance required to reduce the amplitude by a tolerance $\\tau$:\n$$\nr_{\\max} = \\max\\left(r_{\\mathrm{asym}}, \\frac{\\ln(1/\\tau)}{\\kappa}\\right).\n$$\n- If $E  0$: compute $r_{\\mathrm{asym}}$ from the above smallness criterion and the wavelength buffer $r_k$. Form a preliminary estimate\n$$\nr_{\\max}^{\\mathrm{pre}} = \\max\\left(r_{\\mathrm{asym}}, r_k\\right).\n$$\nIf $r_{\\max}^{\\mathrm{pre}} \\le r_{\\mathrm{cap}}$, select free-wave if $Z=0$ or Coulomb-wave if $Z \\ne 0$, and set $r_{\\max} = r_{\\max}^{\\mathrm{pre}}$. If $r_{\\max}^{\\mathrm{pre}}  r_{\\mathrm{cap}}$, select absorbing boundary condition and set $r_{\\max} = r_{\\mathrm{cap}}$.\n\nUse the following fixed constants and design parameters, all expressed in the specified units:\n- Reduced mass $\\mu = 469.459\\ \\mathrm{MeV}$ (taking $c=1$).\n- $\\hbar c = 197.3269804\\ \\mathrm{MeV\\ fm}$.\n- Coulomb constant $e^2 = 1.439964\\ \\mathrm{MeV\\ fm}$.\n- Potential smallness threshold $\\varepsilon = 0.05$.\n- Wavelength buffer $N_{\\lambda} = 3$.\n- Bound-state tail tolerance $\\tau = 10^{-6}$ (dimensionless).\n- Maximum practical domain $r_{\\mathrm{cap}} = 60\\ \\mathrm{fm}$.\n\nYour program must implement the above logic without using any prepackaged nuclear physics libraries. It must output, for each test case, a two-element list consisting of:\n- the selected boundary-condition code as an integer, and\n- the estimated $r_{\\max}$ as a float.\n\nAll $r_{\\max}$ must be expressed in femtometers and rounded to three decimals. The test suite you must evaluate is the following list of parameter tuples $(Z,l,E)$, with $E$ in megaelectronvolts and $l$ an integer:\n- $(0,0,10.0)$,\n- $(1,0,5.0)$,\n- $(40,0,5.0)$,\n- $(0,2,10.0)$,\n- $(0,0,-2.0)$,\n- $(1,1,-0.5)$,\n- $(0,0,1.0\\times 10^{-4})$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each result itself is a two-element list in the order described above (for example, $[[0,12.345],[1,67.890]]$). No additional text should be printed.", "solution": "The user-provided problem statement has been analyzed and is deemed valid. It is scientifically grounded in the principles of quantum mechanics, specifically the two-body Schrödinger equation, and constitutes a well-posed computational physics problem. All necessary constants, parameters, and logical steps are provided, and there are no internal contradictions or ambiguities that would prevent a unique solution for the given test cases.\n\nThe objective is to create an algorithm that determines the appropriate boundary condition and the necessary radial domain size, $r_{\\max}$, for solving the two-body radial Schrödinger equation in nuclear physics. The inputs are the product of charges $Z$, the orbital angular momentum quantum number $l$, and the center-of-mass energy $E$.\n\nThe governing equation for the reduced radial wave function $u(r)$ is:\n$$\nu''(r) + \\left[k^2 - \\frac{2\\mu}{\\hbar^2}V(r) - \\frac{l(l+1)}{r^2}\\right]u(r) = 0\n$$\nHere, $\\mu$ is the reduced mass, and the term $\\frac{\\hbar^2 l(l+1)}{2\\mu r^2}$ is the centrifugal potential. The nuclear potential $V(r)$ is short-ranged. For charged particles ($Z \\neq 0$), a long-range Coulomb potential $V_C(r) = Z e^2/r$ must also be considered. The choice of boundary condition and the size of the integration domain, $r_{\\max}$, depend on the behavior of the solution at large $r$, where the nuclear potential has vanished.\n\nThe core logic of the algorithm is rooted in physical principles and is implemented through a series of computational steps. The decision process first divides based on the sign of the energy $E$.\n\n1.  **Energy Sign and Asymptotic Behavior**:\n    -   If $E > 0$, the state is a scattering state. The wave function $u(r)$ is oscillatory in the asymptotic region. Its behavior is dictated by the de Broglie wavenumber $k = \\frac{\\sqrt{2(\\mu c^2) E}}{\\hbar c}$.\n    -   If $E \\le 0$, the state is a bound or quasi-bound state. A physically acceptable solution must decay exponentially at large distances. This decay is governed by the decay constant $\\kappa = \\frac{\\sqrt{2(\\mu c^2) |E|}}{\\hbar c}$.\n\n2.  **Asymptotic Radius ($r_{\\mathrm{asym}}$)**:\n    The numerical boundary condition should be applied in a region where the long-range potentials (Coulomb and centrifugal) are negligible compared to the system's energy scale $|E|$. This defines an asymptotic radius $r_{\\mathrm{asym}}$. The problem specifies a quantitative criterion:\n    $$\n    \\left|\\frac{Z e^2}{r}\\right| \\le \\varepsilon |E| \\quad \\text{and} \\quad \\frac{\\hbar^2 l(l+1)}{2\\mu r^2} \\le \\varepsilon |E|\n    $$\n    where $\\varepsilon$ is a small dimensionless threshold. Solving these inequalities for $r$ yields two minimum radii:\n    -   From the Coulomb term: $r \\ge \\frac{|Z| e^2}{\\varepsilon |E|} =: r_C$. This radius is $0$ if $Z=0$.\n    -   From the centrifugal term: $r \\ge \\sqrt{\\frac{\\hbar^2 l(l+1)}{2\\mu \\varepsilon |E|}} = \\sqrt{\\frac{(\\hbar c)^2 l(l+1)}{2(\\mu c^2) \\varepsilon |E|}} =: r_L$. This radius is $0$ if $l=0$.\n    The asymptotic region begins where both conditions are satisfied, so we must take the maximum of these two values: $r_{\\mathrm{asym}} = \\max(r_C, r_L)$.\n\n3.  **Boundary Condition Selection and $r_{\\max}$ Estimation**:\n    The algorithm proceeds based on the sign of $E$.\n\n    **Case 1: Bound-like States ($E \\le 0$)**\n    -   **Boundary Condition**: The asymptotic solution is determined by the longest-range potential. If $Z=0$, the potential vanishes completely at large $r$, leading to a free-particle exponential decay (free-wave asymptotics, code $0$). If $Z \\neq 0$, the Coulomb potential persists, leading to a decaying Whittaker function (Coulomb-wave asymptotics, code $1$).\n    -   **Domain Size ($r_{\\max}$)**: Two physical constraints determine $r_{\\max}$:\n        1.  The radius must be in the asymptotic region, $r \\ge r_{\\mathrm{asym}}$.\n        2.  The wave function's amplitude, which decays as $e^{-\\kappa r}$, must be computationally negligible. We demand its magnitude be less than a tolerance $\\tau$: $e^{-\\kappa r} \\le \\tau$, which implies $r \\ge \\frac{\\ln(1/\\tau)}{\\kappa}$. Let's denote this decay radius as $r_{\\tau}$.\n        To satisfy both constraints, $r_{\\max}$ is chosen as the maximum of these two radii: $r_{\\max} = \\max(r_{\\mathrm{asym}}, r_{\\tau})$.\n\n    **Case 2: Scattering States ($E > 0$)**\n    -   **Preliminary Domain Size ($r_{\\max}^{\\mathrm{pre}}$)**: Similar to the bound-state case, we have two constraints:\n        1.  The radius must be in the asymptotic region, $r \\ge r_{\\mathrm{asym}}$.\n        2.  To properly impose an oscillating boundary condition, the domain must span several wavelengths. The wavelength is $\\lambda = 2\\pi/k$. A buffer of $N_{\\lambda}$ wavelengths is required, giving a radius $r_k = N_{\\lambda} \\times \\frac{2\\pi}{k}$.\n        The preliminary estimate for the domain size is $r_{\\max}^{\\mathrm{pre}} = \\max(r_{\\mathrm{asym}}, r_k)$.\n    -   **Final Selection based on Practical Limit ($r_{\\mathrm{cap}}$)**: For very low energies, $k$ is small, and the required $r_{\\max}^{\\mathrm{pre}}$ can become computationally prohibitive. A practical maximum domain $r_{\\mathrm{cap}}$ is introduced.\n        -   If $r_{\\max}^{\\mathrm{pre}} \\le r_{\\mathrm{cap}}$: The calculation is feasible. The boundary condition is chosen based on $Z$ (free-wave for $Z=0$, code $0$; Coulomb-wave for $Z \\ne 0$, code $1$), and the domain size is set to $r_{\\max} = r_{\\max}^{\\mathrm{pre}}$.\n        -   If $r_{\\max}^{\\mathrm{pre}}  r_{\\mathrm{cap}}$: The required domain is too large. A different numerical technique is needed. We switch to an absorbing boundary condition (code $2$) and truncate the domain at the practical limit, $r_{\\max} = r_{\\mathrm{cap}}$.\n\n4.  **Constants and Parameters**:\n    The implementation will use the following fixed values:\n    -   $\\mu c^2 = 469.459\\ \\mathrm{MeV}$\n    -   $\\hbar c = 197.3269804\\ \\mathrm{MeV\\ fm}$\n    -   $e^2 = 1.439964\\ \\mathrm{MeV\\ fm}$\n    -   $\\varepsilon = 0.05$\n    -   $N_{\\lambda} = 3$\n    -   $\\tau = 10^{-6}$\n    -   $r_{\\mathrm{cap}} = 60\\ \\mathrm{fm}$\n\nThis detailed, principle-based logic will now be implemented to process the specified test cases.\n```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Selects a boundary condition and estimates the radial domain size for a\n    two-body Schrödinger boundary value problem.\n    \"\"\"\n    # Define physical constants and design parameters\n    MU_C2 = 469.459  # Reduced mass equivalent in MeV\n    HBAR_C = 197.3269804  # h-bar * c in MeV fm\n    E2 = 1.439964  # Coulomb constant e^2 in MeV fm\n    EPSILON = 0.05  # Potential smallness threshold (dimensionless)\n    N_LAMBDA = 3.0  # Wavelength buffer multiplier\n    TAU = 1e-6  # Bound-state tail tolerance (dimensionless)\n    R_CAP = 60.0  # Maximum practical domain in fm\n\n    # Test cases: tuples of (Z, l, E)\n    # Z: product of charges (dimensionless integer)\n    # l: orbital angular momentum (dimensionless integer)\n    # E: center-of-mass energy (MeV)\n    test_cases = [\n        (0, 0, 10.0),\n        (1, 0, 5.0),\n        (40, 0, 5.0),\n        (0, 2, 10.0),\n        (0, 0, -2.0),\n        (1, 1, -0.5),\n        (0, 0, 1.0e-4),\n    ]\n\n    results = []\n    for case in test_cases:\n        Z, l, E = case\n        bc_code = 0\n        r_max = 0.0\n\n        if E = 0:\n            # Bound-like state logic (E = 0)\n            abs_E = abs(E)\n            \n            # Note: For E=0, abs_E=0, leading to division by zero.\n            # The problem's test cases avoid E=0.\n            # A production-grade code would need special handling for this case.\n            if abs_E == 0:\n                # E=0 represents a special threshold case not fully defined by the given logic.\n                # For this problem, we can assume E is never exactly 0 based on test cases.\n                # Here we could assign a sentinel value or raise an error.\n                # Since E=0 isn't tested, we proceed.\n                pass\n\n            # Calculate the asymptotic radius r_asym\n            # r_C from the Coulomb potential criterion\n            r_C = 0.0\n            if Z != 0:\n                r_C = abs(Z) * E2 / (EPSILON * abs_E)\n            \n            # r_L from the centrifugal potential criterion\n            r_L = 0.0\n            if l  0:\n                r_L = np.sqrt((HBAR_C**2 * l * (l + 1)) / (2 * MU_C2 * EPSILON * abs_E))\n\n            r_asym = max(r_C, r_L)\n\n            # Calculate the decay radius r_tau\n            kappa = np.sqrt(2 * MU_C2 * abs_E) / HBAR_C\n            r_tau = np.log(1.0 / TAU) / kappa\n\n            # r_max is the larger of the two required radii\n            r_max = max(r_asym, r_tau)\n\n            # Select boundary condition code\n            bc_code = 1 if Z != 0 else 0\n\n        else:  # E  0\n            # Scattering state logic (E  0)\n            \n            # Calculate the asymptotic radius r_asym\n            # r_C from the Coulomb potential criterion\n            r_C = 0.0\n            if Z != 0:\n                r_C = abs(Z) * E2 / (EPSILON * E)\n            \n            # r_L from the centrifugal potential criterion\n            r_L = 0.0\n            if l  0:\n                r_L = np.sqrt((HBAR_C**2 * l * (l + 1)) / (2 * MU_C2 * EPSILON * E))\n            \n            r_asym = max(r_C, r_L)\n\n            # Calculate the wavelength buffer radius r_k\n            k = np.sqrt(2 * MU_C2 * E) / HBAR_C\n            r_k = N_LAMBDA * 2 * np.pi / k\n            \n            r_max_pre = max(r_asym, r_k)\n\n            # Compare with the practical domain cap\n            if r_max_pre = R_CAP:\n                r_max = r_max_pre\n                bc_code = 1 if Z != 0 else 0\n            else:\n                r_max = R_CAP\n                bc_code = 2  # Absorbing boundary condition\n\n        results.append([bc_code, round(r_max, 3)])\n\n    # Format the output string exactly as required without extra spaces\n    formatted_results = [f\"[{res[0]},{res[1]:.3f}]\" for res in results]\n    output_string = f\"[{','.join(formatted_results)}]\"\n    # This function would normally print the output string.\n    # For this exercise, the string is returned to be placed in the answer tag.\n    return output_string\n\n# The problem asks for the output, which is generated by running the code.\n# print(solve())\n```", "answer": "`[[0,38.384],[1,54.283],[2,60.000],[0,38.384],[0,62.868],[1,125.736],[2,60.000]]`", "id": "3545155"}]}