{"hands_on_practices": [{"introduction": "A primary goal of microwave reflectometry is to pinpoint the location of specific density layers within a plasma. The precision of this measurement, however, is not infinite and is fundamentally limited by the properties of the microwave signal used for probing. This first practice will guide you through a first-principles derivation to connect the range resolution, $\\Delta r$, to the swept-frequency bandwidth, $B$, of the reflectometer, grounding the diagnostic technique in the fundamental time-bandwidth uncertainty principle of signal processing [@problem_id:3709454].", "problem": "Consider one-dimensional ordinary-mode (O-mode) microwave reflectometry in a cold, magnetized plasma with radial coordinate $r$, where the electron density profile $n_{e}(r)$ produces a local electron plasma frequency $\\omega_{\\mathrm{pe}}(r) = \\sqrt{n_{e}(r) e^{2}/(\\epsilon_{0} m_{e})}$. For O-mode propagation normal to the cutoff layer, the cold-plasma dispersion relation is $k^{2} c^{2} = \\omega^{2} - \\omega_{\\mathrm{pe}}^{2}(r)$, and the group velocity is $v_{g}(\\omega,r) = \\partial \\omega / \\partial k$. A frequency-modulated continuous-wave (FMCW) reflectometer launches a linear chirp $s(t)$ whose instantaneous frequency sweeps monotonically over a total bandwidth $B$ around some center frequency over a duration $T$. The received field is a delayed version of the transmitted field due to two-way propagation to the local cutoff and back. Assume:\n\n- The geometrical optics limit is valid and the reflection occurs at the local cutoff layer where $\\omega = \\omega_{\\mathrm{pe}}(r_{\\mathrm{c}})$.\n- Over the small radial interval of interest near the cutoff, the group velocity can be approximated by a constant $v_{g} \\approx c/n_{g}$, where $n_{g}$ is the local group index evaluated at the cutoff layer.\n- The matched-filter (or dechirp-plus-spectral-estimation) processing can be modeled as an integration over the signal’s instantaneous frequency content across the swept bandwidth $B$.\n\nStarting from the dispersion relation for O-mode and the definition of group velocity, and using first principles of Fourier analysis of finite-band signals, derive a closed-form analytic expression for the minimum resolvable radial separation $\\Delta r$ between two proximate cutoff layers in terms of the chirp bandwidth $B$, the speed of light $c$, and the group index $n_{g}$. Your derivation must justify the time-delay resolution from the signal’s finite bandwidth without invoking any pre-known radar shortcut formulas. State clearly any intermediate relations you use, and present the final $\\Delta r$ as a single analytic expression involving $B$, $c$, and $n_{g}$. No numerical evaluation is required. Express your final result as an analytic expression only.", "solution": "The problem asks for the minimum resolvable radial separation, $\\Delta r$, between two proximate cutoff layers in a plasma using O-mode microwave reflectometry. The derivation is to be based on first principles of wave propagation and Fourier analysis, given a set of physical models and assumptions.\n\nThe fundamental relationship connecting the radial distance to the measurement is the time-of-flight of the microwave signal. The signal propagates from an antenna, reflects at a cutoff layer, and returns to the antenna. The total round-trip time delay, $\\tau$, for a reflection at a radial position $r_c$ is given by the integral of the reciprocal of the group velocity, $v_g$, over the two-way path:\n$$\n\\tau(r_c) = 2 \\int_{r_{\\text{antenna}}}^{r_c} \\frac{dr}{v_g(r)}\n$$\nThe problem states that we can make a significant simplification: for the small radial interval of interest, the group velocity can be approximated as a constant, $v_g \\approx c/n_g$, where $c$ is the speed of light in vacuum and $n_g$ is a constant local group index. Under this assumption, the propagation medium is effectively non-dispersive, and the round-trip delay to a layer at position $r$ (measuring from the antenna, $r_{\\text{antenna}}=0$) is simply:\n$$\n\\tau(r) = \\frac{2r}{v_g} = \\frac{2r}{c/n_g} = \\frac{2 n_g r}{c}\n$$\nNow, consider two distinct, proximate cutoff layers located at radial positions $r_1$ and $r_2$. Let the separation between these layers be $\\Delta r = r_2 - r_1$. The round-trip time delays for signals reflecting from these two layers will be $\\tau_1 = 2 n_g r_1 / c$ and $\\tau_2 = 2 n_g r_2 / c$, respectively. The difference in the time delays is:\n$$\n\\Delta \\tau = \\tau_2 - \\tau_1 = \\frac{2 n_g r_2}{c} - \\frac{2 n_g r_1}{c} = \\frac{2 n_g (r_2 - r_1)}{c} = \\frac{2 n_g \\Delta r}{c}\n$$\nFrom this relationship, we can express the radial separation $\\Delta r$ in terms of the time delay difference $\\Delta \\tau$:\n$$\n\\Delta r = \\frac{c \\Delta \\tau}{2 n_g}\n$$\nThe problem is now reduced to finding the minimum resolvable time delay, $\\Delta \\tau_{\\mathrm{min}}$. This minimum time resolution is determined by the properties of the probing signal, specifically its bandwidth, $B$. The derivation must stem from first principles of Fourier analysis, as requested.\n\nA fundamental principle of signal processing, derived from the properties of the Fourier transform, is that the ability to resolve features in the time domain is inversely proportional to the signal's bandwidth in the frequency domain. To formalize this, let us consider an idealized signal whose spectral content is uniformly distributed over a bandwidth $B$ (in units of Hz) and is zero elsewhere. Such a signal has a rectangular frequency spectrum. For a baseband signal, the spectrum $S(f)$ can be written as:\n$$\nS(f) = \\begin{cases} 1  |f| \\leq B/2 \\\\ 0  |f|  B/2 \\end{cases}\n$$\nThe corresponding time-domain signal, $s(t)$, is given by the inverse Fourier transform of $S(f)$:\n$$\ns(t) = \\int_{-\\infty}^{\\infty} S(f) \\exp(i 2 \\pi f t) df = \\int_{-B/2}^{B/2} \\exp(i 2 \\pi f t) df\n$$\nEvaluating the integral gives:\n$$\ns(t) = \\left[ \\frac{\\exp(i 2 \\pi f t)}{i 2 \\pi t} \\right]_{-B/2}^{B/2} = \\frac{\\exp(i \\pi B t) - \\exp(-i \\pi B t)}{i 2 \\pi t} = \\frac{2i \\sin(\\pi B t)}{i 2 \\pi t} = B \\frac{\\sin(\\pi B t)}{\\pi B t}\n$$\nThis function is known as the sinc function. The temporal shape of the shortest possible pulse that can be formed from a bandwidth $B$ is a sinc pulse.\n\nTo determine the minimum resolvable time separation between two reflected pulses, we apply the Rayleigh criterion. This criterion states that two identical pulses are just resolved when the peak of one pulse coincides with the first zero (minimum) of the other. The main peak of the pulse $s(t) \\propto \\sin(\\pi B t)/(\\pi B t)$ occurs at $t=0$. The first zero occurs when the argument of the sine function is equal to $\\pm \\pi$. So, $\\pi B t = \\pm \\pi$, which yields $t = \\pm 1/B$. Therefore, the temporal distance from the peak of the sinc pulse to its first null is $1/B$.\n\nAccording to the Rayleigh criterion, two such pulses separated by a time delay $\\Delta \\tau$ are minimally resolvable if this separation is equal to the distance from the peak to the first null. Thus, the minimum resolvable time delay is:\n$$\n\\Delta \\tau_{\\mathrm{min}} = \\frac{1}{B}\n$$\nThis result, $\\Delta \\tau_{\\mathrm{min}} B = 1$, is a manifestation of the time-bandwidth uncertainty principle.\n\nFinally, we substitute this expression for the minimum resolvable time delay back into our equation for the radial separation. The minimum resolvable radial separation, $\\Delta r$, is thereby found to be:\n$$\n\\Delta r = \\frac{c \\Delta \\tau_{\\mathrm{min}}}{2 n_g} = \\frac{c}{2 n_g B}\n$$\nThis expression provides the sought-after relationship for the spatial resolution of the reflectometer in terms of the signal bandwidth $B$, the speed of light $c$, and the effective group index $n_g$ of the plasma medium, derived from first principles as required.", "answer": "$$\\boxed{\\frac{c}{2 n_{g} B}}$$", "id": "3709454"}, {"introduction": "While our first exercise established the limit on resolving distinct layers, a full density profile reconstruction relies on accurately interpreting the phase of the wave reflected from a continuous density gradient. This practice moves beyond simple ray-tracing to explore the wave mechanics of reflection by contrasting the Wentzel–Kramers–Brillouin (WKB) approximation with a rigorous full-wave treatment [@problem_id:3709516]. By solving the wave equation exactly near the cutoff using Airy functions, you will discover a crucial phase shift of $\\pi/2$ that simple models miss, highlighting the necessity of wave-based analysis for quantitative measurements.", "problem": "A one-dimensional, normally incident ordinary mode (O-mode) microwave reflectometer probes a magnetized plasma with a monotonically increasing electron density profile along the coordinate $x$, where $x=0$ denotes the cutoff location for an angular frequency $\\omega$. Treat the plasma as cold and collisionless so that the transverse electric field $E(x)$ obeys the scalar wave equation derived from Maxwell’s equations in a cold plasma: \n$$\\frac{d^{2}E}{dx^{2}} + k^{2}(x)\\,E = 0,$$\nwith \n$$k^{2}(x) = \\frac{\\omega^{2}}{c^{2}}\\left(1 - \\frac{\\omega_{p}^{2}(x)}{\\omega^{2}}\\right),\\quad \\omega_{p}^{2}(x) = \\frac{n_{e}(x)e^{2}}{\\varepsilon_{0} m_{e}},$$\nwhere $c$ is the speed of light, $e$ is the elementary charge, $\\varepsilon_{0}$ is the vacuum permittivity, and $m_{e}$ is the electron mass. Assume that near the cutoff, the plasma frequency squared is locally linear,\n$$\\omega_{p}^{2}(x) \\approx \\omega^{2} + \\frac{\\omega^{2}}{L_{n}}\\,x,$$\nwith a constant density scale length $L_{n}0$, so that the turning point is at $x=0$ and the oscillatory region is $x0$.\n\nDefine the forward and backward Wentzel–Kramers–Brillouin (WKB) waves in the oscillatory region by\n$$E_{\\text{WKB}}(x) \\propto \\frac{1}{\\sqrt{k(x)}}\\left[A_{i}\\,\\exp\\!\\left(i\\int_{x}^{0}\\!k(s)\\,ds\\right) + A_{r}\\,\\exp\\!\\left(-i\\int_{x}^{0}\\!k(s)\\,ds\\right)\\right],$$\nwith no additional constant phase offsets included in the exponential phases. The complex reflection coefficient is defined as $R \\equiv A_{r}/A_{i}$. \n\nUsing only fundamental wave propagation principles and asymptotic matching near a single turning point:\n- Derive the leading-order WKB prediction for the reflection coefficient $R_{\\text{WKB}}$ under the assumption of a real-valued, lossless turning point that imposes unit reflectivity without any turning-point phase offset.\n- Independently, perform a full-wave analysis by reducing the local wave equation near $x=0$ to the Airy equation via an appropriate rescaling, enforce the physical condition of decay for $x0$, and use the large negative-argument asymptotics to match to the oscillatory WKB form for $x0$. Extract the corresponding full-wave reflection coefficient $R_{\\text{Airy}}$ in the same normalization of phases as above.\n- For a moderate gradient (finite $L_{n}$), quantify the discrepancy between the two approaches by computing the amplitude difference $\\Delta|R| \\equiv |R_{\\text{Airy}}| - |R_{\\text{WKB}}|$ and the phase difference $\\Delta\\phi \\equiv \\arg(R_{\\text{Airy}}) - \\arg(R_{\\text{WKB}})$.\n\nExpress your final answer as a two-component row vector $\\big[\\Delta|R|,\\ \\Delta\\phi\\big]$, where $\\Delta|R|$ is dimensionless and $\\Delta\\phi$ is in radians. No rounding is required; provide an exact result.", "solution": "The problem statement has been validated and is deemed a valid, self-contained, and scientifically grounded problem in wave physics. Although there exists a minor notational ambiguity in the descriptive text regarding \"forward\" and \"backward\" waves, the mathematical definitions provided are explicit and sufficient to proceed to a unique solution. We will adhere strictly to the provided mathematical definitions.\n\nThe problem asks for a comparison between a simplified Wentzel–Kramers–Brillouin (WKB) model of reflection and a full-wave analysis using the Airy equation. The goal is to compute the difference in the amplitude and phase of the reflection coefficient derived from these two methods.\n\nFirst, we clarify the notation for the reflection coefficient. The problem defines the WKB solution in the oscillatory region ($x0$) as:\n$$E_{\\text{WKB}}(x) \\propto \\frac{1}{\\sqrt{k(x)}}\\left[A_{i}\\,\\exp\\!\\left(i\\int_{x}^{0}\\!k(s)\\,ds\\right) + A_{r}\\,\\exp\\!\\left(-i\\int_{x}^{0}\\!k(s)\\,ds\\right)\\right]$$\nTo determine which term corresponds to the incident wave and which to the reflected wave, we analyze the direction of phase propagation. Assuming a time-dependence of $\\exp(-i\\omega t)$, the total phase for each term is:\n1.  Term with $A_{i}$: The phase is $\\phi_{i}(x,t) = \\int_{x}^{0} k(s)\\,ds - \\omega t$. The phase velocity is $v_{p} = -\\frac{\\partial \\phi_{i}/\\partial t}{\\partial \\phi_{i}/\\partial x} = -\\frac{-\\omega}{-k(x)} = -\\frac{\\omega}{k(x)}$. Since $k(x)0$ for $x0$, $v_{p}0$. This wave propagates in the $-x$ direction, away from the cutoff at $x=0$, and is therefore the **reflected wave**.\n2.  Term with $A_{r}$: The phase is $\\phi_{r}(x,t) = -\\int_{x}^{0} k(s)\\,ds - \\omega t$. The phase velocity is $v_{p} = -\\frac{\\partial \\phi_{r}/\\partial t}{\\partial \\phi_{r}/\\partial x} = -\\frac{-\\omega}{k(x)} = \\frac{\\omega}{k(x)}$. Since $k(x)0$ for $x0$, $v_{p}0$. This wave propagates in the $+x$ direction, toward the cutoff at $x=0$, and is therefore the **incident wave**.\n\nThus, $A_{i}$ is the complex amplitude of the reflected wave and $A_{r}$ is the complex amplitude of the incident wave. The reflection coefficient is defined as $R \\equiv A_{r}/A_{i}$. This is the ratio of the incident amplitude to the reflected amplitude, which is the reciprocal of the standard definition of a reflection coefficient. We will proceed using the problem's explicit definition.\n\n**Part 1: WKB Prediction ($R_{\\text{WKB}}$)**\n\nThe problem specifies a simplified WKB model characterized by \"unit reflectivity without any turning-point phase offset.\"\n- \"Unit reflectivity\" implies that the magnitude of the incident and reflected wave amplitudes are equal. In standard terms, $|A_{\\text{reflected}}|/|A_{\\text{incident}}| = 1$. In the problem's notation, this is $|A_{i}|/|A_{r}| = 1$, which implies $|R_{\\text{WKB}}| = |A_{r}/A_{i}| = 1$.\n- \"Without any turning-point phase offset\" is interpreted to mean that the reflection process introduces no phase shift between the incident and reflected waves. In the standard definition, this would mean $\\arg(A_{\\text{reflected}}/A_{\\text{incident}}) = 0$. In the problem's notation, this means $\\arg(A_{i}/A_{r}) = 0$, so $\\arg(R_{\\text{WKB}}^{-1}) = 0$. This implies $\\arg(R_{\\text{WKB}}) = 0$.\n\nCombining these two assumptions, we have:\n$$R_{\\text{WKB}} = |R_{\\text{WKB}}|\\exp(i \\arg(R_{\\text{WKB}})) = 1 \\cdot \\exp(i \\cdot 0) = 1$$\nTherefore, $|R_{\\text{WKB}}| = 1$ and $\\arg(R_{\\text{WKB}}) = 0$.\n\n**Part 2: Full-Wave Analysis ($R_{\\text{Airy}}$)**\n\nWe now perform a full-wave analysis near the cutoff $x=0$. The wave equation is given by $\\frac{d^{2}E}{dx^{2}} + k^{2}(x)\\,E = 0$. Near $x=0$, the squared wavenumber $k^{2}(x)$ is approximated using the given linear profile for $\\omega_{p}^{2}(x)$:\n$$k^{2}(x) = \\frac{\\omega^{2}}{c^{2}}\\left(1 - \\frac{\\omega_{p}^{2}(x)}{\\omega^{2}}\\right) \\approx \\frac{\\omega^{2}}{c^{2}}\\left(1 - \\frac{\\omega^{2} + \\frac{\\omega^{2}}{L_{n}}x}{\\omega^{2}}\\right) = \\frac{\\omega^{2}}{c^{2}}\\left(1 - 1 - \\frac{x}{L_{n}}\\right) = -\\frac{\\omega^{2}}{c^{2}L_{n}}x$$\nThe wave equation becomes:\n$$\\frac{d^{2}E}{dx^{2}} - \\left(\\frac{\\omega^{2}}{c^{2}L_{n}}\\right)x E = 0$$\nThis is a form of the Airy equation. To reduce it to the standard form, $y''(z) - z y(z) = 0$, we introduce a change of variable $z = \\alpha x$. The derivatives transform as $\\frac{d}{dx} = \\alpha\\frac{d}{dz}$ and $\\frac{d^{2}}{dx^{2}} = \\alpha^{2}\\frac{d^{2}}{dz^{2}}$. Substituting into the wave equation gives:\n$$\\alpha^{2}\\frac{d^{2}E}{dz^{2}} - \\left(\\frac{\\omega^{2}}{c^{2}L_{n}}\\right)\\frac{z}{\\alpha} E = 0 \\implies \\frac{d^{2}E}{dz^{2}} - \\left(\\frac{\\omega^{2}}{\\alpha^{3}c^{2}L_{n}}\\right)z E = 0$$\nWe require the coefficient of the $zE$ term to be $1$, so $\\frac{\\omega^{2}}{\\alpha^{3}c^{2}L_{n}} = 1$, which yields the scaling factor:\n$$\\alpha = \\left(\\frac{\\omega^{2}}{c^{2}L_{n}}\\right)^{1/3}$$\nThe general solution to the Airy equation is a linear combination of the Airy functions of the first and second kind, $Ai(z)$ and $Bi(z)$. For $x0$, we have $z0$. The physical condition is that the wave must decay in the evanescent region ($x0$). Since $Ai(z)$ decays exponentially for $z \\to \\infty$ while $Bi(z)$ grows exponentially, the physical solution must be proportional to $Ai(z)$.\n$$E(x) = C \\cdot Ai(z) = C \\cdot Ai\\left( \\left(\\frac{\\omega^{2}}{c^{2}L_{n}}\\right)^{1/3} x \\right)$$\nTo find the reflection coefficient, we match the asymptotic form of this solution for large negative argument ($z \\to -\\infty$, which corresponds to $x0$) to the WKB form. The asymptotic expansion of $Ai(z)$ for $z0$ is:\n$$Ai(z) \\sim \\frac{1}{\\sqrt{\\pi}(-z)^{1/4}} \\sin\\left(\\frac{2}{3}(-z)^{3/2} + \\frac{\\pi}{4}\\right)$$\nWe now express the argument of the sine function in terms of the WKB phase integral $\\Phi(x) = \\int_{x}^{0} k(s)\\,ds$. For $x0$, $k(s) = \\sqrt{-\\frac{\\omega^{2}}{c^{2}L_{n}}s} = \\alpha^{3/2}\\sqrt{-s}$.\n$$\\Phi(x) = \\int_{x}^{0} \\alpha^{3/2}\\sqrt{-s}\\,ds = \\alpha^{3/2} \\left[-\\frac{2}{3}(-s)^{3/2}\\right]_{x}^{0} = \\frac{2}{3}\\alpha^{3/2}(-x)^{3/2} = \\frac{2}{3}(-\\alpha x)^{3/2} = \\frac{2}{3}(-z)^{3/2}$$\nThe amplitude factor in the WKB solution, $1/\\sqrt{k(x)}$, can be related to $z$ as well: $\\sqrt{k(x)} = (\\alpha^{3/2}\\sqrt{-x})^{1/2} = \\alpha^{3/4}(-x)^{1/4} = \\alpha^{1/2}(-\\alpha x)^{1/4} = \\alpha^{1/2}(-z)^{1/4}$. Thus, $1/\\sqrt{k(x)} \\propto 1/(-z)^{1/4}$. The amplitude dependence matches.\nWe now rewrite the sine function using complex exponentials to match the WKB form:\n$$\\sin\\left(\\Phi(x) + \\frac{\\pi}{4}\\right) = \\frac{1}{2i}\\left[\\exp\\left(i\\Phi(x) + i\\frac{\\pi}{4}\\right) - \\exp\\left(-i\\Phi(x) - i\\frac{\\pi}{4}\\right)\\right]$$\n$$= \\frac{1}{2i}\\left[e^{i\\pi/4}\\exp(i\\Phi(x)) - e^{-i\\pi/4}\\exp(-i\\Phi(x))\\right]$$\nSo, the asymptotic solution for $E(x)$ is proportional to:\n$$E(x) \\propto \\frac{1}{\\sqrt{k(x)}} \\left[ e^{i\\pi/4}\\exp\\left(i\\int_{x}^{0}k(s)ds\\right) - e^{-i\\pi/4}\\exp\\left(-i\\int_{x}^{0}k(s)ds\\right) \\right]$$\nWe match this with the problem's WKB form:\n$$E_{\\text{WKB}}(x) \\propto \\frac{1}{\\sqrt{k(x)}}\\left[A_{i}\\exp\\left(i\\int_{x}^{0}k(s)ds\\right) + A_{r}\\exp\\left(-i\\int_{x}^{0}k(s)ds\\right) \\right]$$\nBy comparing the coefficients of the corresponding exponential terms, we find:\n$$A_{i} \\propto e^{i\\pi/4}$$\n$$A_{r} \\propto -e^{-i\\pi/4}$$\nThe full-wave reflection coefficient, $R_{\\text{Airy}}$, is the ratio $A_{r}/A_{i}$:\n$$R_{\\text{Airy}} = \\frac{-e^{-i\\pi/4}}{e^{i\\pi/4}} = -e^{-i\\pi/2} = -(-\\cos(\\pi/2) - i\\sin(\\pi/2)) = -(-i) = i$$\nSo, from the full-wave analysis, we have $R_{\\text{Airy}} = i$. Its magnitude and phase are:\n$$|R_{\\text{Airy}}| = |i| = 1$$\n$$\\arg(R_{\\text{Airy}}) = \\arg(i) = \\frac{\\pi}{2}$$\nThis result shows that reflection from a linear density profile introduces a phase shift of $\\pi/2$ in the standard reflection coefficient, which corresponds to a phase of $\\pi/2$ for the unusually defined coefficient $R$.\n\n**Part 3: Quantify the Discrepancy**\n\nFinally, we compute the requested differences between the full-wave (Airy) and simplified WKB results.\nThe amplitude difference is:\n$$\\Delta|R| = |R_{\\text{Airy}}| - |R_{\\text{WKB}}| = 1 - 1 = 0$$\nThe phase difference is:\n$$\\Delta\\phi = \\arg(R_{\\text{Airy}}) - \\arg(R_{\\text{WKB}}) = \\frac{\\pi}{2} - 0 = \\frac{\\pi}{2}$$\nThe discrepancy lies entirely in the phase. The simplified WKB model fails to capture the $\\pi/2$ phase shift that occurs upon reflection from the continuous potential barrier, a well-known result from WKB connection formulas.\n\nThe final answer is expressed as the two-component row vector $[\\Delta|R|, \\Delta\\phi]$.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0  \\frac{\\pi}{2}\n\\end{pmatrix}\n}\n$$", "id": "3709516"}, {"introduction": "We now synthesize our understanding of wave cutoffs and reflection within a realistic plasma environment. In a magnetic confinement device such as a tokamak, both the electron density and the magnetic field vary in space, which can make the relationship between a launched microwave frequency and its reflection location surprisingly complex. This capstone exercise challenges you to derive the extraordinary mode (X-mode) cutoff conditions from first principles and then implement a numerical algorithm to map launch frequencies to all possible cutoff radii in a model tokamak plasma [@problem_id:3709550]. This practice bridges theory and computation, compelling you to confront and solve real-world challenges, such as the non-monotonic cutoff frequency profiles that can render the inversion from frequency to radius a multi-valued problem.", "problem": "You are given a magnetized, toroidally confined plasma and asked to compute the mapping from launched microwave frequency to the radial location(s) of the extraordinary mode (X-mode) cutoff(s) for perpendicular incidence, and to reason from first principles about how a spatially varying electron cyclotron angular frequency introduces non-monotonic behavior in this mapping. The task must be formalized in terms of the cold-plasma wave propagation and executed as a complete, runnable program.\n\nThe plasma, geometry, and profiles are specified as follows:\n- The minor radius is $a = 0.6$ in meters.\n- The major radius is $R_0 = 1.7$ in meters.\n- The toroidal magnetic field magnitude profile is $B(r) = B_0 \\, \\dfrac{R_0}{R_0 + r}$ with $B_0 = 5.0$ in Tesla and $r \\in [0,a]$ in meters.\n- The electron number density profile is $n_e(r) = n_{\\text{edge}} + \\left(n_0 - n_{\\text{edge}}\\right) \\left(1 - \\left(\\dfrac{r}{a}\\right)^2\\right)^{\\alpha}$ with $n_0 = 2.0 \\times 10^{20}$ in $\\text{m}^{-3}$, $n_{\\text{edge}} = 0.2 \\times 10^{20}$ in $\\text{m}^{-3}$, and $\\alpha = 1.5$.\n\nAll waves are launched and propagate strictly perpendicular to the magnetic field. The analysis must begin from Maxwell's equations in a linear medium, together with the cold-plasma dielectric response of a magnetized electron fluid. Define and use the electron plasma angular frequency $\\omega_{pe}(r) = \\sqrt{\\dfrac{n_e(r) e^2}{\\varepsilon_0 m_e}}$ and the electron cyclotron angular frequency $\\omega_{ce}(r) = \\dfrac{e B(r)}{m_e}$, where $e$ is the elementary charge, $m_e$ is the electron mass, and $\\varepsilon_0$ is the vacuum permittivity. You must derive, from these fundamentals and the appropriate extraordinary mode dispersion for perpendicular propagation, the condition that determines the radial cutoff location(s) for a given launched angular frequency $\\omega = 2\\pi f$. Then, using the derived condition, compute the mapping $f \\mapsto r_c(f)$, where $r_c(f)$ denotes the set of radii at which the X-mode undergoes cutoff. If multiple branches or multiple solutions exist, you must include all cutoff radii.\n\nYour derivation must not rely on pre-given final formulas for the extraordinary mode cutoff. Derive the dispersion and cutoff condition from first principles. You are required to explicitly identify how the spatial variation of $\\omega_{ce}(r)$ can produce non-monotonic behavior in the mapping $f \\mapsto r_c(f)$, including the conditions under which the mapping may lose monotonicity or yield ambiguous inversion.\n\nConstants to use (in SI units) are: $e = 1.602176634 \\times 10^{-19}$ in Coulombs, $m_e = 9.1093837015 \\times 10^{-31}$ in kilograms, and $\\varepsilon_0 = 8.8541878128 \\times 10^{-12}$ in Farads per meter.\n\nImplement an algorithm that, for each specified frequency, searches $r \\in [0,a]$ to find all radii where the X-mode cutoff condition is met. Numerical root finding is acceptable and must be robust to cases with zero, one, or multiple solutions. Express all returned cutoff radii in meters and round them to four decimal places.\n\nTest suite:\n- Frequencies (in Hertz): $f \\in \\{40 \\times 10^{9},\\, 55 \\times 10^{9},\\, 80 \\times 10^{9},\\, 150 \\times 10^{9},\\, 220 \\times 10^{9}\\}$.\n- These test cases are chosen to include: a low-frequency case where cutoff may require high density, a near-boundary case where the lower extraordinary branch can exhibit non-monotonic behavior with frequency, a borderline case for the upper extraordinary branch density requirement, and higher-frequency cases where the lower extraordinary branch dominates.\n\nYour program must produce a single line of output containing the results as a comma-separated list enclosed in square brackets. Each element corresponds to one test frequency (in the order given above) and must be a list of the cutoff radii in meters (rounded to four decimal places) for that frequency, combining all X-mode branches present and sorted in ascending order. For example, an output of the correct format has the shape $[[r_{1,1}, r_{1,2}, \\dots],[r_{2,1},\\dots],\\dots]$. If no cutoff exists for a given frequency, output an empty list for that frequency. The final output units for radii must be meters, rounded to four decimal places.", "solution": "The problem is assessed to be valid as it is scientifically grounded in cold plasma physics, well-posed with all necessary parameters defined, and objective in its formulation. It represents a standard, albeit non-trivial, problem in the study of wave propagation in magnetized plasmas.\n\n### Derivation from First Principles\n\nThe analysis begins with Maxwell's equations for a linear, source-free medium, assuming a harmonic time dependence of the form $e^{-i\\omega t}$ for all fields. The wave equation for the electric field $\\mathbf{E}$ in a plasma is derived as:\n$$\n\\nabla \\times (\\nabla \\times \\mathbf{E}) = \\frac{\\omega^2}{c^2} \\mathbf{K} \\cdot \\mathbf{E}\n$$\nwhere $\\omega$ is the wave angular frequency, $c$ is the speed of light in vacuum, and $\\mathbf{K}$ is the relative dielectric tensor of the plasma. Assuming a plane wave solution of the form $\\mathbf{E} \\propto e^{i\\mathbf{k} \\cdot \\mathbf{r}}$, where $\\mathbf{k}$ is the wave vector, the wave equation becomes an algebraic equation:\n$$\n\\mathbf{k} \\times (\\mathbf{k} \\times \\mathbf{E}) + \\frac{\\omega^2}{c^2} \\mathbf{K} \\cdot \\mathbf{E} = 0\n$$\nIntroducing the refractive index $N = kc/\\omega$, this simplifies to:\n$$\n\\left( \\mathbf{K} - N^2 \\mathbf{I} + N^2 \\frac{\\mathbf{k}\\mathbf{k}}{k^2} \\right) \\cdot \\mathbf{E} = 0\n$$\nFor a non-trivial solution for $\\mathbf{E}$ to exist, the determinant of the matrix must be zero. This condition yields the dispersion relation for waves in the plasma.\n\nThe dielectric tensor $\\mathbf{K}$ for a cold, magnetized plasma with the background magnetic field $\\mathbf{B}$ aligned with the z-axis is given by:\n$$\n\\mathbf{K} = \\begin{pmatrix} S  -iD  0 \\\\ iD  S  0 \\\\ 0  0  P \\end{pmatrix}\n$$\nThe components $S$, $D$, and $P$ are the Stix parameters, defined in terms of the electron plasma frequency $\\omega_{pe}(r) = \\sqrt{n_e(r) e^2 / (\\varepsilon_0 m_e)}$ and the electron cyclotron frequency $\\omega_{ce}(r) = e B(r) / m_e$:\n$$\nS = 1 - \\frac{\\omega_{pe}^2}{\\omega^2 - \\omega_{ce}^2} \\quad, \\quad D = \\frac{\\omega_{ce}\\omega_{pe}^2}{\\omega(\\omega^2 - \\omega_{ce}^2)} \\quad, \\quad P = 1 - \\frac{\\omega_{pe}^2}{\\omega^2}\n$$\nThe problem specifies propagation strictly perpendicular to the magnetic field. We can set $\\mathbf{k}$ along the x-axis, i.e., $\\mathbf{k} = k\\mathbf{\\hat{x}}$. The wave equation's determinant condition splits into two independent modes. One is the Ordinary (O-mode) with dispersion $N^2 = P$, which is not of interest here. The other is the Extraordinary (X-mode), with the dispersion relation:\n$$\nN_X^2 = \\frac{S^2 - D^2}{S}\n$$\nA wave cutoff is defined as the location where the refractive index $N$ becomes zero, causing the wave to be reflected. For the X-mode, $N_X^2 = 0$ implies that the numerator $S^2-D^2$ must be zero (assuming $S \\neq 0$, which corresponds to a resonance).\nFactoring the numerator as $(S-D)(S+D) = 0$, we obtain two distinct cutoff conditions:\n1.  $S+D = 0 \\implies 1 - \\frac{\\omega_{pe}^2}{\\omega(\\omega + \\omega_{ce})} = 0$\n2.  $S-D = 0 \\implies 1 - \\frac{\\omega_{pe}^2}{\\omega(\\omega - \\omega_{ce})} = 0$\n\nFor a given launched wave frequency $\\omega$, a cutoff occurs at a radial location $r_c$ where one of these conditions is met. Rearranging these equations gives the cutoff conditions in terms of the plasma parameters at the cutoff radius $r_c$:\n1.  **Right-hand (R) cutoff:** $\\omega^2 + \\omega \\omega_{ce}(r_c) - \\omega_{pe}^2(r_c) = 0$. This corresponds to the launched frequency $\\omega$ being equal to the local \"right-hand\" cutoff frequency $\\omega_R(r_c) = \\frac{1}{2}\\left(-\\omega_{ce}(r_c) + \\sqrt{\\omega_{ce}(r_c)^2 + 4\\omega_{pe}^2(r_c)}\\right)$.\n2.  **Left-hand (L) cutoff:** $\\omega^2 - \\omega \\omega_{ce}(r_c) - \\omega_{pe}^2(r_c) = 0$. This corresponds to $\\omega$ being equal to the local \"left-hand\" cutoff frequency $\\omega_L(r_c) = \\frac{1}{2}\\left(\\omega_{ce}(r_c) + \\sqrt{\\omega_{ce}(r_c)^2 + 4\\omega_{pe}^2(r_c)}\\right)$.\n\n### Analysis of Non-Monotonicity\n\nThe problem requires an explanation of how the mapping from frequency to cutoff radius, $f \\mapsto r_c(f)$, can become non-monotonic. This behavior is determined by the spatial profiles of the cutoff frequencies $\\omega_L(r)$ and $\\omega_R(r)$.\n\nThe key plasma parameters, magnetic field $B(r)$ and electron density $n_e(r)$, are both monotonically decreasing functions of the minor radius $r$ for $r \\in [0, a]$. Consequently, their corresponding characteristic frequencies, $\\omega_{ce}(r)$ and $\\omega_{pe}(r)$, are also monotonically decreasing with $r$.\n\nThe left-hand cutoff frequency, $\\omega_L(r)$, is a sum of terms that are all monotonically decreasing with $r$, and is therefore itself a monotonically decreasing function. Thus, for any given launched frequency $\\omega$ within the range of $\\omega_L(r)$, there will be exactly one cutoff radius $r_c$ from this branch.\n\nThe right-hand cutoff frequency, $\\omega_R(r)$, involves a difference. Its derivative with respect to $r$ is:\n$$\n\\frac{d\\omega_R}{dr} = \\frac{1}{2} \\left( -\\frac{d\\omega_{ce}}{dr} + \\frac{\\omega_{ce}\\frac{d\\omega_{ce}}{dr} + 2\\frac{d(\\omega_{pe}^2)}{dr}}{\\sqrt{\\omega_{ce}^2 + 4\\omega_{pe}^2}} \\right)\n$$\nSince $\\frac{d\\omega_{ce}}{dr}  0$ and $\\frac{d(\\omega_{pe}^2)}{dr}  0$, the term $-\\frac{d\\omega_{ce}}{dr}$ is positive, while the fractional term is negative. The sign of $\\frac{d\\omega_R}{dr}$ depends on the competition between these two terms. The positive term arises from the decay of the magnetic field, while the negative term is driven by the decay of both density and magnetic field. This competition can cause the $\\omega_R(r)$ profile to be non-monotonic; it may have a local maximum. If a launched frequency $\\omega$ is below this maximum but above the value at the boundaries ($r=0$ or $r=a$), there can be two distinct radial locations where $\\omega = \\omega_R(r)$, leading to two cutoff points. This makes the inversion $f \\mapsto r_c(f)$ ambiguous for the R-branch, which is a critical feature for reflectometry diagnostics aiming to measure the density profile.\n\n### Algorithm Design\n\nTo compute the mapping $f \\mapsto r_c(f)$, we must find the roots of the two cutoff condition equations for each given frequency $f$:\n$$G_R(r, \\omega) = \\omega^2 + \\omega \\omega_{ce}(r) - \\omega_{pe}^2(r) = 0$$\n$$G_L(r, \\omega) = \\omega^2 - \\omega \\omega_{ce}(r) - \\omega_{pe}^2(r) = 0$$\nwhere $\\omega = 2\\pi f$.\n\nThe algorithm is as follows:\n1.  For each input frequency $f_{test}$, calculate the corresponding angular frequency $\\omega$.\n2.  To find all roots robustly in the domain $r \\in [0, a]$, we discretize this interval into a large number of subintervals.\n3.  For each subinterval, we check for a sign change in both $G_R(r, \\omega)$ and $G_L(r, \\omega)$.\n4.  If a sign change is detected within a subinterval $[r_i, r_{i+1}]$, a numerical root-finding algorithm (e.g., Brent's method) is employed on that interval to find the precise root.\n5.  All roots found for both $G_R$ and $G_L$ are collected.\n6.  The collected list of roots is sorted in ascending order and rounded to the specified precision. This yields the set of all cutoff radii for the given frequency.\nThis procedure is repeated for all test frequencies.", "answer": "```python\nimport numpy as np\nfrom scipy import optimize\nfrom scipy.constants import e, m_e, epsilon_0, pi\n\ndef solve():\n    \"\"\"\n    Computes the extraordinary mode (X-mode) cutoff radii for given microwave\n    frequencies in a model tokamak plasma.\n    \"\"\"\n    \n    # Define plasma and geometry parameters from the problem statement\n    a = 0.6  # Minor radius in meters\n    R0 = 1.7  # Major radius in meters\n    B0 = 5.0  # Magnetic field on-axis in Tesla\n    n0 = 2.0e20  # Central electron density in m^-3\n    n_edge = 0.2e20  # Edge electron density in m^-3\n    alpha = 1.5  # Density profile shape parameter\n\n    # Define the test frequencies in Hertz\n    test_cases = [40e9, 55e9, 80e9, 150e9, 220e9]\n    \n    # Pre-calculate physical constant ratios for efficiency\n    e_over_me = e / m_e\n    e2_over_eps0_me = e**2 / (epsilon_0 * m_e)\n\n    def B_field(r):\n        \"\"\"Calculates the toroidal magnetic field strength at minor radius r.\"\"\"\n        return B0 * R0 / (R0 + r)\n\n    def n_electron(r):\n        \"\"\"Calculates the electron number density at minor radius r.\"\"\"\n        # This vectorized version handles both scalar and array inputs for r\n        # and correctly handles r  a by clipping the base of the power.\n        term_base = 1 - (np.asanyarray(r) / a)**2\n        if isinstance(term_base, np.ndarray):\n            term_base[term_base  0] = 0\n        elif term_base  0:\n            term_base = 0\n            \n        return n_edge + (n0 - n_edge) * term_base**alpha\n\n    def omega_ce(r):\n        \"\"\"Calculates the electron cyclotron angular frequency.\"\"\"\n        return e_over_me * B_field(r)\n\n    def omega_pe_sq(r):\n        \"\"\"Calculates the square of the electron plasma angular frequency.\"\"\"\n        return e2_over_eps0_me * n_electron(r)\n\n    # --- Cutoff condition functions G(r) = 0 ---\n    # G_R corresponds to the Right-hand cutoff: w^2 + w*w_ce - w_pe^2 = 0\n    def G_R(r, omega):\n        return omega**2 + omega * omega_ce(r) - omega_pe_sq(r)\n\n    # G_L corresponds to the Left-hand cutoff: w^2 - w*w_ce - w_pe^2 = 0\n    def G_L(r, omega):\n        return omega**2 - omega * omega_ce(r) - omega_pe_sq(r)\n\n    def find_all_roots(func, omega, r_min=0., r_max=a, num_points=10000):\n        \"\"\"\n        Finds all roots of `func(r, omega) = 0` in the interval [r_min, r_max].\n        \"\"\"\n        r_grid = np.linspace(r_min, r_max, num_points)\n        f_vals = func(r_grid, omega)\n        \n        roots = []\n        for i in range(num_points - 1):\n            # A root exists if the function crosses the axis\n            if np.sign(f_vals[i]) != np.sign(f_vals[i+1]):\n                try:\n                    root = optimize.brentq(func, r_grid[i], r_grid[i+1], args=(omega,))\n                    roots.append(root)\n                except ValueError:\n                    # This should not be reached due to the np.sign check,\n                    # but serves as a safeguard.\n                    pass\n        \n        # Check if a root is exactly at a grid point (can be missed by sign change)\n        # We only need to check at the start of intervals, as the end is the next start\n        if np.isclose(f_vals[0], 0):\n            roots.append(r_grid[0])\n        # And finally check the last point of the domain\n        if np.isclose(f_vals[-1], 0):\n            roots.append(r_grid[-1])\n\n        # Return a sorted list of unique roots\n        return sorted(list(set(roots)))\n\n    results = []\n    for f_hz in test_cases:\n        omega_val = 2 * pi * f_hz\n        \n        # Find roots for both L and R cutoff branches\n        roots_R_branch = find_all_roots(G_R, omega_val)\n        roots_L_branch = find_all_roots(G_L, omega_val)\n        \n        all_roots = sorted(roots_R_branch + roots_L_branch)\n        \n        # Round roots to four decimal places as required\n        rounded_roots = [round(r, 4) for r in all_roots]\n        \n        results.append(rounded_roots)\n\n    # Format the final output string to exactly match the problem specification\n    # e.g., [[r1.1,r1.2],[r2.1],[],...]\n    inner_parts = []\n    for r_list in results:\n        inner_parts.append(f\"[{','.join(map(str, r_list))}]\")\n    final_output = f\"[{','.join(inner_parts)}]\"\n    \n    print(final_output)\n\nsolve()\n```", "id": "3709550"}]}