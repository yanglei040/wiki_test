{"hands_on_practices": [{"introduction": "The energy principle is a powerful variational tool, but its predictive power relies on testing only physically admissible plasma displacements. This first exercise focuses on the fundamental constraints imposed by ideal Magnetohydrodynamics (MHD), forcing us to derive the relationship between the plasma displacement $\\boldsymbol{\\xi}$ and the magnetic field perturbation $\\delta\\mathbf{B}$ from the frozen-in law. By applying these rules and the proper boundary conditions in a simple slab geometry [@problem_id:3721115], you will see how these constraints are critical for correctly evaluating plasma stability and avoiding unphysical, zero-energy solutions.", "problem": "Consider a static, uniform equilibrium plasma confined in a slab of thickness $a$ along the $x$-direction, with large periodic extent in the $y$ and $z$ directions. The equilibrium magnetic field is $\\mathbf{B} = B_{0}\\,\\hat{\\mathbf{z}}$, the mass density is $\\rho$ (constant), and the equilibrium pressure is $p$ (constant). The plasma is bounded at $x=0$ and $x=a$ by perfectly conducting, rigid walls.\n\nStarting from the induction equation of Maxwell's equations and the ideal Ohm's law of Magnetohydrodynamics (MHD), formulate the constraints that any admissible linear Lagrangian displacement field $\\boldsymbol{\\xi}(\\mathbf{r})$ must satisfy so as not to violate the frozen-in condition of ideal MHD. In particular, derive the relation between the magnetic perturbation $\\delta \\mathbf{B}$ and $\\boldsymbol{\\xi}$ and identify the boundary constraint at a perfectly conducting fixed wall.\n\nThen, restrict attention to a class of trial displacements of the form $\\boldsymbol{\\xi}(\\mathbf{r}) = \\hat{\\mathbf{x}}\\,f(x)$, independent of $y$ and $z$, and use the ideal MHD energy principle to write the second-order potential energy change functional $\\delta W$ appropriate to this uniform equilibrium. Impose the physically justified constraints you derived to exclude unphysical trial displacements that would violate frozen-in flux conservation or the wall condition.\n\nWith these constraints, minimize $\\delta W$ over functions $f(x)$ subject to the normalization\n$$\nI \\equiv \\int_{0}^{a} \\rho\\,|f(x)|^{2}\\,dx\n$$\ndefined per unit area in the $y$–$z$ plane. Compute the constrained minimum of the normalized potential energy change, $\\delta W_{\\min}/I$, for this class of displacements. As a check on the impact of the constraints, briefly show what the unconstrained minimization would erroneously predict if one were to allow a constant $f(x)$ and treat $\\delta \\mathbf{B}$ as independent of $\\boldsymbol{\\xi}$.\n\nExpress your final normalized minimum $\\delta W_{\\min}/I$ in $\\mathrm{s}^{-2}$. No rounding is required. Do not include any additional numerical data beyond the given symbols $B_{0}$, $\\mu_{0}$, $\\gamma$, $p$, $\\rho$, and $a$.", "solution": "The problem is first subjected to a rigorous validation process.\n\n**Step 1: Extract Givens**\n- **Equilibrium**: Static, uniform plasma.\n- **Geometry**: Slab of thickness $a$ along the $x$-direction, bounded by walls at $x=0$ and $x=a$. Periodic in $y$ and $z$ directions.\n- **Equilibrium Fields and Parameters**:\n    - Magnetic field: $\\mathbf{B} = \\mathbf{B}_0 = B_{0}\\,\\hat{\\mathbf{z}}$.\n    - Mass density: $\\rho$ (constant).\n    - Pressure: $p$ (constant).\n- **Boundaries**: Perfectly conducting, rigid walls at $x=0$ and $x=a$.\n- **Physics**: Ideal Magnetohydrodynamics (MHD), specifically the induction equation and ideal Ohm's law.\n- **Perturbation**:\n    - Lagrangian displacement field: $\\boldsymbol{\\xi}(\\mathbf{r})$.\n    - Specific trial displacement: $\\boldsymbol{\\xi}(\\mathbf{r}) = \\hat{\\mathbf{x}}\\,f(x)$.\n- **Normalization**:\n    $$I \\equiv \\int_{0}^{a} \\rho\\,|f(x)|^{2}\\,dx$$\n- **Task**:\n    1. Derive the relation between magnetic perturbation $\\delta \\mathbf{B}$ and $\\boldsymbol{\\xi}$.\n    2. Identify the boundary constraint at a perfectly conducting fixed wall.\n    3. Write the potential energy change functional $\\delta W$ for the given trial displacement.\n    4. Minimize the normalized potential energy change, $\\delta W/I$, under the derived constraints.\n    5. Compare with an \"unconstrained\" minimization.\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientifically Grounded**: The problem is a standard exercise in ideal MHD stability theory, based on fundamental principles of plasma physics and electromagnetism. The setup, while simplified (a uniform slab), is a valid and common model for studying wave propagation and stability (e.g., magnetosonic waves).\n- **Well-Posed**: The problem is well-posed. It involves the minimization of a well-defined functional (the potential energy) over a space of functions subject to clear physical boundary conditions, which leads to a unique and stable solution (the lowest eigenmode).\n- **Objective**: The problem is stated using precise, objective, and standard terminology from plasma physics. There are no subjective or ambiguous statements.\n- **Completeness and Consistency**: All necessary information ($\\mathbf{B}_0$, $\\rho$, $p$, geometry, boundary conditions) is provided. There are no contradictions in the setup.\n\n**Step 3: Verdict and Action**\nThe problem is valid. It is a scientifically sound, well-posed, and objective problem in theoretical plasma physics. I will now proceed with the solution.\n\nThe ideal MHD model is governed by a set of fluid and Maxwell's equations. For this problem, the key relations are the induction equation and the ideal Ohm's law.\n\nFirst, we derive the relationship between the first-order magnetic field perturbation, $\\delta\\mathbf{B}$, and the Lagrangian displacement vector, $\\boldsymbol{\\xi}$. The induction equation is\n$$\n\\frac{\\partial \\mathbf{B}}{\\partial t} = -\\nabla \\times \\mathbf{E}\n$$\nThe ideal Ohm's law states that in the plasma frame, the electric field is zero. In the lab frame, this gives\n$$\n\\mathbf{E} + \\mathbf{v} \\times \\mathbf{B} = 0 \\implies \\mathbf{E} = -\\mathbf{v} \\times \\mathbf{B}\n$$\nWe linearize these equations for small perturbations about a static ($\\mathbf{v}_0=0$) equilibrium: $\\mathbf{B} = \\mathbf{B}_0 + \\delta\\mathbf{B}$, $\\mathbf{v} = \\delta\\mathbf{v} = \\frac{\\partial\\boldsymbol{\\xi}}{\\partial t}$, and $\\mathbf{E} = \\delta\\mathbf{E}$. The linearized induction equation becomes\n$$\n\\frac{\\partial (\\mathbf{B}_0 + \\delta\\mathbf{B})}{\\partial t} = -\\nabla \\times \\delta\\mathbf{E}\n$$\nSince $\\mathbf{B}_0$ is constant in time, this is $\\frac{\\partial \\delta\\mathbf{B}}{\\partial t} = -\\nabla \\times \\delta\\mathbf{E}$. The linearized Ohm's law is $\\delta\\mathbf{E} = -\\frac{\\partial\\boldsymbol{\\xi}}{\\partial t} \\times \\mathbf{B}_0$. Substituting this into the induction equation yields\n$$\n\\frac{\\partial \\delta\\mathbf{B}}{\\partial t} = -\\nabla \\times \\left(-\\frac{\\partial\\boldsymbol{\\xi}}{\\partial t} \\times \\mathbf{B}_0\\right) = \\nabla \\times \\left(\\frac{\\partial\\boldsymbol{\\xi}}{\\partial t} \\times \\mathbf{B}_0\\right)\n$$\nSince $\\mathbf{B}_0$ is spatially uniform and constant in time, we can interchange the time derivative and the curl operator:\n$$\n\\frac{\\partial \\delta\\mathbf{B}}{\\partial t} = \\frac{\\partial}{\\partial t} \\left(\\nabla \\times (\\boldsymbol{\\xi} \\times \\mathbf{B}_0)\\right)\n$$\nIntegrating with respect to time from an unperturbed state ($\\boldsymbol{\\xi}=0, \\delta\\mathbf{B}=0$) gives the fundamental relation for the frozen-in magnetic flux:\n$$\n\\delta \\mathbf{B} = \\nabla \\times (\\boldsymbol{\\xi} \\times \\mathbf{B}_0)\n$$\nNext, we identify the constraints at the perfectly conducting, rigid walls at $x=0$ and $x=a$.\n1.  **Rigid wall**: A rigid wall is impenetrable, so the component of the plasma displacement normal to the wall must be zero. Let $\\hat{\\mathbf{n}}$ be the unit normal to the wall. This gives the constraint $\\boldsymbol{\\xi} \\cdot \\hat{\\mathbf{n}} = 0$ at the wall.\n2.  **Perfectly conducting wall**: The tangential component of the electric field must be zero at the surface of a perfect conductor. From Ohm's law, $\\mathbf{E}_t = (-\\mathbf{v} \\times \\mathbf{B})_t = 0$. Additionally, magnetic flux cannot penetrate a perfect conductor. This means the normal component of the total magnetic field at the wall must vanish for all time: $(\\mathbf{B}_0 + \\delta\\mathbf{B}) \\cdot \\hat{\\mathbf{n}} = 0$. In our equilibrium, $\\mathbf{B}_0 = B_0 \\hat{\\mathbf{z}}$ and the wall normals are $\\hat{\\mathbf{n}} = \\pm\\hat{\\mathbf{x}}$. Thus, $\\mathbf{B}_0 \\cdot \\hat{\\mathbf{n}} = 0$. The condition simplifies to $\\delta\\mathbf{B} \\cdot \\hat{\\mathbf{n}} = 0$ at the wall.\n\nNow we specialize to the given uniform equilibrium and the trial displacement $\\boldsymbol{\\xi}(\\mathbf{r}) = \\hat{\\mathbf{x}}\\,f(x)$.\nThe potential energy change functional for ideal MHD, $\\delta W$, for an equilibrium with constant pressure $p$ and uniform magnetic field $\\mathbf{B}_0$ (implying zero equilibrium current $\\mathbf{j}_0 = \\frac{1}{\\mu_0}\\nabla\\times\\mathbf{B}_0=0$ and zero pressure gradient $\\nabla p=0$), simplifies to\n$$\n\\delta W = \\frac{1}{2}\\int_V \\left( \\frac{|\\delta\\mathbf{B}|^2}{\\mu_0} + \\gamma p |\\nabla \\cdot \\boldsymbol{\\xi}|^2 \\right) dV\n$$\nwhere $\\gamma$ is the ratio of specific heats. We calculate the terms for our specific $\\boldsymbol{\\xi}$:\n- Divergence of displacement: $\\nabla \\cdot \\boldsymbol{\\xi} = \\frac{\\partial \\xi_x}{\\partial x} = \\frac{d f(x)}{dx} = f'(x)$.\n- Perturbed magnetic field:\n$$\n\\boldsymbol{\\xi} \\times \\mathbf{B}_0 = (f(x)\\,\\hat{\\mathbf{x}}) \\times (B_0\\,\\hat{\\mathbf{z}}) = f(x)B_0(\\hat{\\mathbf{x}}\\times\\hat{\\mathbf{z}}) = -f(x)B_0\\,\\hat{\\mathbf{y}}\n$$\n$$\n\\delta\\mathbf{B} = \\nabla \\times (-f(x)B_0\\,\\hat{\\mathbf{y}}) = - \\frac{\\partial}{\\partial x}(-f(x)B_0) \\hat{\\mathbf{z}} = B_0 f'(x) \\hat{\\mathbf{z}}\n$$\nNow, substitute these into the expression for $\\delta W$. The problem asks for the result per unit area in the $y$-$z$ plane, so we integrate over $x$ from $0$ to $a$ and assume the integral over $y$ and $z$ gives a factor of $1$.\n$$\n\\delta W = \\frac{1}{2} \\int_0^a \\left( \\frac{(B_0 f'(x))^2}{\\mu_0} + \\gamma p (f'(x))^2 \\right) dx = \\frac{1}{2} \\left( \\frac{B_0^2}{\\mu_0} + \\gamma p \\right) \\int_0^a (f'(x))^2 dx\n$$\nThe constraints on $f(x)$ are:\n1.  $\\boldsymbol{\\xi} \\cdot \\hat{\\mathbf{n}} = 0$: At $x=0$ and $x=a$, the normal is $\\hat{\\mathbf{n}}=\\hat{\\mathbf{x}}$, so $\\xi_x = f(x)$ must be zero. This gives the boundary conditions $f(0)=0$ and $f(a)=0$.\n2.  $\\delta\\mathbf{B} \\cdot \\hat{\\mathbf{n}} = 0$: Here $\\delta\\mathbf{B} = B_0 f'(x)\\,\\hat{\\mathbf{z}}$, so $\\delta\\mathbf{B}\\cdot\\hat{\\mathbf{x}} = 0$ everywhere automatically. This constraint is trivially satisfied for this displacement class.\n\nWe need to minimize $\\delta W/I$ subject to $f(0)=0$ and $f(a)=0$. The quantity to minimize is the Rayleigh quotient:\n$$\n\\frac{\\delta W}{I} = \\frac{\\frac{1}{2} \\left( \\frac{B_0^2}{\\mu_0} + \\gamma p \\right) \\int_0^a (f'(x))^2 dx}{\\rho \\int_0^a (f(x))^2 dx} = \\frac{1}{2\\rho} \\left( \\frac{B_0^2}{\\mu_0} + \\gamma p \\right) \\frac{\\int_0^a (f'(x))^2 dx}{\\int_0^a (f(x))^2 dx}\n$$\nThis is a standard problem in the calculus of variations. The minimum value of the quotient $\\int (f')^2 dx / \\int f^2 dx$ subject to $f(0)=f(a)=0$ is given by the lowest eigenvalue of the Sturm-Liouville problem $f''(x) + k^2 f(x) = 0$ with these boundary conditions. The solutions are $f(x) = A\\sin(kx)+C\\cos(kx)$.\n$f(0)=0 \\implies C=0$.\n$f(a)=0 \\implies A\\sin(ka)=0$. For a non-trivial solution ($A \\neq 0$), we require $ka = n\\pi$ for an integer $n \\geq 1$.\nThe lowest non-zero value of $k$ corresponds to $n=1$, so $k=\\pi/a$. The minimizing function is $f(x) = A\\sin(\\pi x/a)$. The minimum value of the quotient (the lowest eigenvalue $k^2$) is $(\\pi/a)^2$.\nThus, the minimum value of $\\delta W/I$ is:\n$$\n\\frac{\\delta W_{\\min}}{I} = \\frac{1}{2\\rho} \\left( \\frac{B_0^2}{\\mu_0} + \\gamma p \\right) \\left(\\frac{\\pi}{a}\\right)^2 = \\frac{\\pi^2}{2a^2\\rho} \\left( \\gamma p + \\frac{B_0^2}{\\mu_0} \\right)\n$$\nThis quantity has units of (pressure/density) $\\times$ (length)$^{-2}$, which is $((\\text{m}^2/\\text{s}^2))/\\text{m}^2 = \\text{s}^{-2}$, as required. Note that this quantity is physically related to the square of the lowest stable oscillation frequency, $\\omega^2 = 2 \\delta W_{\\min}/I$.\n\nFinally, we consider the \"unconstrained\" minimization. The problem suggests to \"allow a constant $f(x)$ and treat $\\delta \\mathbf{B}$ as independent of $\\boldsymbol{\\xi}$\". This means we discard two key physical constraints: (1) the boundary condition $f(0)=f(a)=0$, and (2) the frozen-in law $\\delta\\mathbf{B}=\\nabla\\times(\\boldsymbol{\\xi}\\times\\mathbf{B}_0)$.\nThe functional to minimize is $\\delta W = \\frac{1}{2} \\int_0^a \\left( \\frac{|\\delta\\mathbf{B}|^2}{\\mu_0} + \\gamma p (f'(x))^2 \\right) dx$.\nIf we are allowed to choose $f(x)$ to be a constant, say $f(x)=c_0$, then $f'(x)=0$. The term involving $\\gamma p$ vanishes.\nIf we treat $\\delta\\mathbf{B}$ as an independent trial function, its contribution to $\\delta W$ is minimized by choosing $\\delta\\mathbf{B}=0$.\nUnder these unphysical assumptions, the minimum potential energy is $\\delta W_{\\min}=0$.\nFor a non-trivial displacement $f(x)=c_0\\neq 0$, the normalization is $I = \\int_0^a \\rho c_0^2 dx = \\rho c_0^2 a > 0$.\nThe erroneous prediction for the normalized minimum energy would be $\\delta W_{\\min}/I = 0$. This result is incorrect because the trial function $f(x)=c_0$ violates the physical boundary condition that the displacement must vanish at the rigid walls. Discarding this constraint allows for a trivial energy state corresponding to a rigid translation of the plasma slab, which costs no energy in an infinite system but is not a valid perturbation in a bounded domain.", "answer": "$$\n\\boxed{\\frac{\\pi^{2}}{2 a^{2} \\rho} \\left( \\gamma p + \\frac{B_{0}^{2}}{\\mu_{0}} \\right)}\n$$", "id": "3721115"}, {"introduction": "With the foundational rules established, we now apply the energy principle to a canonical problem in plasma stability: the external kink mode in a cylindrical plasma. This practice requires you to calculate the change in magnetic energy in the vacuum region surrounding the plasma, a crucial component of the total potential energy $\\delta W$. By solving for the perturbed vacuum field and performing the energy integral [@problem_id:3721145], you will quantify the stabilizing effect of a conducting wall and understand its crucial role in fusion device design.", "problem": "Consider an infinitely long, straight, cylindrical plasma of radius $a$ embedded in vacuum. The plasma carries a uniform axial current density that produces an azimuthal equilibrium magnetic field $B_{\\theta 0}(r)$, which is linear in $r$ inside the plasma and decays as $1/r$ in the vacuum: $B_{\\theta 0}(r) = B_{a}\\, r/a$ for $0 \\le r \\le a$ and $B_{\\theta 0}(r) = B_{a}\\, a/r$ for $r \\ge a$, where $B_{a} \\equiv B_{\\theta 0}(a)$. A perfectly conducting cylindrical wall is located at radius $b > a$.\n\nWithin the framework of ideal Magnetohydrodynamics (MHD), use the magnetostatic form of Maxwell’s equations and the ideal flux-freezing constraint to determine the vacuum magnetic field perturbation associated with an $m=1$ kink displacement that rigidly shifts the plasma boundary. Specifically, consider a single-helicity perturbation with no axial variation (i.e., axial wave number $k=0$), with the plasma boundary displaced by $\\xi_{r}(a,\\theta) = \\xi_{0}\\cos\\theta$, where $\\xi_{0}$ is a constant real amplitude. Assume the vacuum magnetic perturbation can be represented by a two-dimensional scalar flux function $\\psi(r,\\theta)$ that satisfies the Laplace equation in the vacuum region $a < r < b$, and impose the physically appropriate boundary conditions that follow from flux freezing at $r=a$ and perfect conductivity at $r=b$.\n\nStarting from fundamental laws (Maxwell’s equations and ideal MHD constraints) and without invoking any pre-derived stability formulas, compute the contribution of the vacuum magnetic field energy to the potential energy variation $\\delta W$ for this $m=1$ kink, expressed per unit axial length. Provide the final expression for the vacuum contribution $\\delta W_{\\text{vac}}$ per unit axial length in terms of $a$, $b$, $B_{a}$, $\\mu_{0}$, and $\\xi_{0}$, where $\\mu_{0}$ is the vacuum permeability. Then briefly describe how this contribution depends on the wall radius $b$.\n\nExpress the final answer for $\\delta W_{\\text{vac}}$ per unit axial length in Joules per meter. No numerical evaluation is required.", "solution": "The user wants to compute the contribution of the vacuum magnetic field energy to the potential energy variation, $\\delta W_{\\text{vac}}$, for an $m=1, k=0$ kink displacement of a cylindrical plasma.\n\n### Step 1: Extract Givens\n-   Plasma: Infinitely long, straight, cylindrical, radius $a$.\n-   Plasma current: Uniform axial current density.\n-   Equilibrium magnetic field: Azimuthal field $B_{\\theta 0}(r)$.\n    -   Inside plasma ($0 \\le r \\le a$): $B_{\\theta 0}(r) = B_{a} \\frac{r}{a}$.\n    -   In vacuum ($r \\ge a$): $B_{\\theta 0}(r) = B_{a} \\frac{a}{r}$.\n    -   $B_{a} \\equiv B_{\\theta 0}(a)$ is the field strength at the plasma edge.\n-   Boundary: Perfectly conducting cylindrical wall at radius $b > a$.\n-   Framework: Ideal Magnetohydrodynamics (MHD).\n-   Perturbation: A rigid $m=1$ kink displacement with no axial variation ($k=0$).\n    -   Plasma boundary displacement: $\\xi_{r}(a,\\theta) = \\xi_{0}\\cos\\theta$.\n    -   $\\xi_{0}$ is a constant real amplitude.\n-   Vacuum perturbation: The perturbed magnetic field, $\\mathbf{B}_1$, can be represented by a scalar flux function $\\psi(r, \\theta)$ that satisfies the Laplace equation, $\\nabla^2\\psi = 0$, in the vacuum region $a < r < b$.\n-   Task:\n    1.  Compute the vacuum contribution to the potential energy variation, $\\delta W_{\\text{vac}}$, per unit axial length.\n    2.  Express the result in terms of $a$, $b$, $B_{a}$, $\\mu_{0}$, and $\\xi_{0}$, where $\\mu_{0}$ is the vacuum permeability.\n    3.  Describe the dependence of $\\delta W_{\\text{vac}}$ on the wall radius $b$.\n\n### Step 2: Validate Using Extracted Givens\n1.  **Scientifically Grounded:** The problem describes a Z-pinch configuration, a fundamental model in plasma physics used for studying MHD stability. The equilibrium field profile is consistent with a uniform current density inside the plasma. The use of ideal MHD, flux-freezing, and a conducting wall are standard and appropriate for analyzing the stability of such a configuration. The perturbation described is the classic $m=1$ external kink mode. The problem is firmly grounded in established plasma physics principles.\n2.  **Well-Posed:** The problem provides a complete set of physical conditions and boundary constraints (plasma-vacuum interface, conducting wall) necessary to uniquely determine the vacuum magnetic field perturbation. The goal of calculating the vacuum energy contribution is a well-defined task within MHD stability theory.\n3.  **Objective:** The problem is stated using precise, standard terminology from plasma physics and mathematics. There are no subjective or opinion-based statements.\n4.  **Other Flaws:** The problem is not non-formalizable, incomplete, contradictory, unrealistic, ill-posed, trivial, or outside scientific verifiability. It is a canonical calculation in MHD theory.\n\n### Step 3: Verdict and Action\nThe problem is valid. I will proceed to the solution.\n\nThe potential energy variation in the vacuum region, $\\delta W_{\\text{vac}}$, per unit axial length is given by the integral of the perturbed magnetic field energy density over the vacuum volume, per unit length.\n$$\n\\delta W_{\\text{vac}} = \\frac{1}{2\\mu_0} \\int_{0}^{2\\pi} \\int_{a}^{b} |\\mathbf{B}_1|^2 r \\, dr \\, d\\theta\n$$\nHere, $\\mathbf{B}_1$ is the first-order perturbation to the magnetic field in the vacuum region $a < r < b$. Since there are no currents in the vacuum, Ampere's law gives $\\nabla \\times \\mathbf{B}_1 = 0$. This, combined with $\\nabla \\cdot \\mathbf{B}_1 = 0$, allows us to describe $\\mathbf{B}_1$ using a scalar potential. The problem specifies using a flux function $\\psi(r, \\theta)$, which is appropriate for a two-dimensional problem ($k=0$). The magnetic field perturbation is related to $\\psi$ by:\n$$\n\\mathbf{B}_1 = \\nabla \\times (\\psi \\hat{\\mathbf{z}}) = \\frac{1}{r}\\frac{\\partial \\psi}{\\partial \\theta} \\hat{\\mathbf{r}} - \\frac{\\partial \\psi}{\\partial r} \\hat{\\mathbf{\\theta}}\n$$\nThe condition $\\nabla \\times \\mathbf{B}_1 = 0$ implies that $\\psi$ must satisfy Laplace's equation in the vacuum region:\n$$\n\\nabla^2 \\psi = \\frac{1}{r}\\frac{\\partial}{\\partial r}\\left(r\\frac{\\partial \\psi}{\\partial r}\\right) + \\frac{1}{r^2}\\frac{\\partial^2 \\psi}{\\partial \\theta^2} = 0\n$$\nWe must solve this equation subject to two boundary conditions.\n\nFirst, at the perfectly conducting wall at $r=b$, the magnetic field must be tangential. The equilibrium field $\\mathbf{B}_0$ is already tangential. Therefore, the normal component of the perturbed field, $B_{1r}$, must vanish at the wall.\n$$\nB_{1r}(b, \\theta) = \\frac{1}{b} \\left( \\frac{\\partial \\psi}{\\partial \\theta} \\right)_{r=b} = 0\n$$\nThis implies that $\\psi(b, \\theta)$ must be independent of $\\theta$. Since the absolute value of a potential is arbitrary, we can set this constant value to zero for simplicity:\n$$\n\\psi(b, \\theta) = 0\n$$\nSecond, at the perturbed plasma-vacuum interface, the ideal MHD flux-freezing constraint requires the total magnetic field to be tangential to the surface. Let the perturbed surface be $r_p(\\theta) = a + \\xi_r(a, \\theta) = a + \\xi_{0}\\cos\\theta$. A normal vector to this surface is $\\mathbf{n} = \\nabla(r - r_p) = \\hat{\\mathbf{r}} - \\frac{1}{r}\\frac{\\partial r_p}{\\partial\\theta}\\hat{\\mathbf{\\theta}} = \\hat{\\mathbf{r}} + \\frac{\\xi_0}{r}\\sin\\theta \\hat{\\mathbf{\\theta}}$. The condition is $\\mathbf{B} \\cdot \\mathbf{n} = 0$ at $r=r_p$. The total field is $\\mathbf{B} = \\mathbf{B}_0 + \\mathbf{B}_1$. We linearize the condition.\n$$\n(\\mathbf{B}_0(r_p) + \\mathbf{B}_1(r_p)) \\cdot \\mathbf{n}(r_p) = 0\n$$\nTo first order in $\\xi_0$ and $\\mathbf{B}_1$:\n$$\nB_{1r}(a, \\theta) + \\frac{B_a \\xi_0}{a} \\sin\\theta = 0 \\implies B_{1r}(a, \\theta) = -\\frac{B_a \\xi_0}{a} \\sin\\theta\n$$\nWe express this in terms of $\\psi$:\n$$\n\\frac{1}{a} \\left(\\frac{\\partial \\psi}{\\partial \\theta}\\right)_{r=a} = -\\frac{B_a \\xi_0}{a} \\sin\\theta \\implies \\frac{\\partial \\psi}{\\partial \\theta}(a, \\theta) = -B_a \\xi_0 \\sin\\theta\n$$\nIntegrating with respect to $\\theta$ gives the boundary condition for $\\psi$ at $r=a$:\n$$\n\\psi(a, \\theta) = B_a \\xi_0 \\cos\\theta\n$$\nThe problem is reduced to solving Laplace's equation for an $m=1$ mode. The general solution with $\\cos\\theta$ dependence is of the form $\\psi(r, \\theta) = R(r)\\cos\\theta$. Substituting into Laplace's equation yields the Euler equation $r^2 R'' + rR' - R = 0$, which has the general solution $R(r) = C_1 r + C_2 r^{-1}$. Thus,\n$$\n\\psi(r, \\theta) = (C_1 r + C_2 r^{-1}) \\cos\\theta\n$$\nApplying the boundary conditions to find the constants $C_1$ and $C_2$:\nAt $r=b$: $\\psi(b, \\theta) = (C_1 b + C_2 b^{-1})\\cos\\theta = 0 \\implies C_1 b + C_2 b^{-1} = 0 \\implies C_2 = -C_1 b^2$.\nAt $r=a$: $\\psi(a, \\theta) = (C_1 a + C_2 a^{-1})\\cos\\theta = B_a\\xi_0\\cos\\theta \\implies C_1 a + C_2 a^{-1} = B_a\\xi_0$.\nSubstituting $C_2$ into the second equation:\n$C_1 a - (C_1 b^2) a^{-1} = B_a\\xi_0 \\implies C_1 (a - b^2/a) = B_a\\xi_0 \\implies C_1 \\frac{a^2-b^2}{a} = B_a\\xi_0$.\n$$\nC_1 = \\frac{a B_a \\xi_0}{a^2 - b^2}, \\quad C_2 = -b^2 C_1 = -\\frac{a b^2 B_a \\xi_0}{a^2 - b^2}\n$$\nThe flux function is:\n$$\n\\psi(r, \\theta) = \\frac{a B_a \\xi_0}{a^2 - b^2} \\left( r - \\frac{b^2}{r} \\right) \\cos\\theta\n$$\nNext, we find the perturbed magnetic field components:\n$$\nB_{1r}(r, \\theta) = \\frac{1}{r}\\frac{\\partial \\psi}{\\partial \\theta} = \\frac{1}{r} \\frac{a B_a \\xi_0}{a^2 - b^2} \\left( r - \\frac{b^2}{r} \\right) (-\\sin\\theta) = \\frac{a B_a \\xi_0}{b^2 - a^2} \\left( 1 - \\frac{b^2}{r^2} \\right) \\sin\\theta\n$$\n$$\nB_{1\\theta}(r, \\theta) = -\\frac{\\partial \\psi}{\\partial r} = -\\frac{a B_a \\xi_0}{a^2 - b^2} \\left( 1 + \\frac{b^2}{r^2} \\right) \\cos\\theta = \\frac{a B_a \\xi_0}{b^2 - a^2} \\left( 1 + \\frac{b^2}{r^2} \\right) \\cos\\theta\n$$\nNow we compute the energy integral for $\\delta W_{\\text{vac}}$.\n$$\n|\\mathbf{B}_1|^2 = B_{1r}^2 + B_{1\\theta}^2 = \\left( \\frac{a B_a \\xi_0}{b^2 - a^2} \\right)^2 \\left[ \\left( 1 - \\frac{b^2}{r^2} \\right)^2 \\sin^2\\theta + \\left( 1 + \\frac{b^2}{r^2} \\right)^2 \\cos^2\\theta \\right]\n$$\nThe integral over $\\theta$ simplifies:\n$\\int_0^{2\\pi} |\\mathbf{B}_1|^2 d\\theta = \\pi \\left( \\frac{a B_a \\xi_0}{b^2 - a^2} \\right)^2 \\left[ \\left( 1 - \\frac{b^2}{r^2} \\right)^2 + \\left( 1 + \\frac{b^2}{r^2} \\right)^2 \\right] = \\pi \\left( \\frac{a B_a \\xi_0}{b^2 - a^2} \\right)^2 2\\left(1 + \\frac{b^4}{r^4}\\right)$.\nSo, $\\delta W_{\\text{vac}} = \\frac{1}{2\\mu_0} \\int_a^b \\pi \\left( \\frac{a B_a \\xi_0}{b^2 - a^2} \\right)^2 2\\left(1 + \\frac{b^4}{r^4}\\right) r \\, dr$.\n$$\n\\delta W_{\\text{vac}} = \\frac{\\pi}{\\mu_0} \\left( \\frac{a B_a \\xi_0}{b^2 - a^2} \\right)^2 \\int_a^b \\left(r + \\frac{b^4}{r^3}\\right) dr\n$$\nThe remaining integral over $r$ is:\n$\\int_a^b \\left(r + b^4 r^{-3}\\right) dr = \\left[ \\frac{r^2}{2} - \\frac{b^4}{2r^2} \\right]_a^b = \\frac{b^4-a^4}{2a^2} = \\frac{(b^2-a^2)(b^2+a^2)}{2a^2}$.\nSubstituting this back into the expression for $\\delta W_{\\text{vac}}$:\n$$\n\\delta W_{\\text{vac}} = \\frac{\\pi}{\\mu_0} \\frac{a^2 B_a^2 \\xi_0^2}{(b^2 - a^2)^2} \\frac{(b^2-a^2)(b^2+a^2)}{2a^2}\n$$\n$$\n\\delta W_{\\text{vac}} = \\frac{\\pi B_a^2 \\xi_0^2}{2\\mu_0} \\frac{b^2+a^2}{b^2-a^2}\n$$\nThis is the vacuum energy contribution per unit axial length.\n\nThe dependence on the wall radius $b$ is contained in the factor $\\frac{b^2+a^2}{b^2-a^2}$. This can be rewritten as $1 + \\frac{2a^2}{b^2-a^2}$. Since $b>a$, this term is always positive. The vacuum energy contribution $\\delta W_{\\text{vac}}$ is therefore always positive, meaning the vacuum field acts to stabilize this perturbation.\n-   As the wall approaches the plasma ($b \\to a^+$), the term $\\frac{2a^2}{b^2-a^2} \\to \\infty$. Thus, $\\delta W_{\\text{vac}} \\to \\infty$. This indicates a very strong stabilizing effect from a close-fitting wall.\n-   As the wall is moved to infinity ($b \\to \\infty$), the term $\\frac{2a^2}{b^2-a^2} \\to 0$. In this case, $\\delta W_{\\text{vac}}$ approaches its minimum value: $\\delta W_{\\text{vac}}(b \\to \\infty) = \\frac{\\pi B_a^2 \\xi_0^2}{2\\mu_0}$.\nIn summary, $\\delta W_{\\text{vac}}$ is a monotonically decreasing function of the wall radius $b$ for $b>a$. The stabilizing effect of the conducting wall is strongest when it is close to the plasma and weakest when it is far away.", "answer": "$$\n\\boxed{\\frac{\\pi B_{a}^{2} \\xi_{0}^{2}}{2 \\mu_{0}} \\frac{b^{2}+a^{2}}{b^{2}-a^{2}}}\n$$", "id": "3721145"}, {"introduction": "While analytical solutions are invaluable, many real-world stability problems require numerical methods. This final practice introduces the powerful Rayleigh–Ritz method, which transforms the minimization of the $\\delta W$ functional into a matrix eigenvalue problem that can be solved computationally. You will implement a solver using a polynomial basis to find the stability eigenvalue for a cylindrical kink mode [@problem_id:3721123], and validate your code's predictions against the renowned Kruskal–Shafranov stability criterion.", "problem": "You are asked to implement, from first principles, a Rayleigh–Ritz solver that computes the smallest eigenvalue of an ideal magnetohydrodynamics (MHD) energy functional for the $m=1$ kink mode in a straight, periodic, cylindrical plasma column of radius $a$ with magnetic fields $B_{\\theta}(r)=\\mu\\,r$ and $B_{z}=\\text{constant}$. The goal is to numerically approximate the infimum of the Rayleigh quotient $\\lambda[\\xi]$ associated with the potential energy functional $\\delta W[\\xi]$, and to validate the numerical result against the analytic cylindrical kink threshold. You must produce a single, complete, runnable program that implements the numerical method and prints its results in the prescribed format.\n\nStart from the ideal Magnetohydrodynamics (MHD) energy principle, which states that for small, divergence-free displacements $\\boldsymbol{\\xi}$, the second variation of the potential energy $\\delta W$ determines stability: a mode is ideally stable if $\\delta W[\\boldsymbol{\\xi}] \\ge 0$ for all admissible $\\boldsymbol{\\xi}$ and ideally unstable if there exists an admissible $\\boldsymbol{\\xi}$ such that $\\delta W[\\boldsymbol{\\xi}] &lt; 0$. In cylindrical geometry for a low pressure (cold plasma) column and incompressible perturbations with Fourier dependence $\\exp\\{i(m\\theta + kz)\\}$, the dominant line-bending contribution to $\\delta W$ can be captured in a reduced one-dimensional functional of the radial displacement $\\xi(r)$ for the $m=1$ kink mode under a thin-vacuum-wall approximation. In this reduced model, the energy functional is\n$$\n\\delta W[\\xi] \\;=\\; \\int_{0}^{a} r \\,\\mathrm{d}r \\left[ B_{z}^{2}\\,\\left|\\frac{\\mathrm{d}\\xi}{\\mathrm{d}r}\\right|^{2} \\;+\\; k^{2} B_{z}^{2}\\,|\\xi|^{2} \\right] \\;-\\; \\frac{B_{\\theta}(a)^{2}}{a^{2}} \\int_{0}^{a} r \\,|\\xi|^{2}\\,\\mathrm{d}r,\n$$\nwhich is valid for $m=1$ and the stated equilibrium, and where the negative term represents the destabilizing contribution of the external (vacuum) magnetic energy linked to the azimuthal field. For $B_{\\theta}(r) = \\mu\\, r$, one has $\\frac{B_{\\theta}(a)}{a} = \\mu$. The associated Rayleigh quotient, used to define the generalized eigenvalue problem, is\n$$\n\\lambda[\\xi] \\;=\\; \\frac{\\delta W[\\xi]}{\\displaystyle \\int_{0}^{a} r\\,|\\xi|^{2}\\,\\mathrm{d}r}.\n$$\nThe analytic cylindrical kink threshold for $m=1$ can be written as the Kruskal–Shafranov condition, here expressed for a periodic cylinder of axial wavenumber $k$,\n$$\nk\\,B_{z} \\;\\gtrless\\; \\frac{B_{\\theta}(a)}{a} \\quad\\Longleftrightarrow\\quad k^{2} B_{z}^{2} \\;\\gtrless\\; \\left(\\frac{B_{\\theta}(a)}{a}\\right)^{2},\n$$\nso that the reduced-model prediction for the marginal stability point corresponds to $\\lambda_{\\text{analytic}} = k^{2} B_{z}^{2} - \\mu^{2} = 0$.\n\nImplement the Rayleigh–Ritz method with a polynomial basis $\\{\\phi_{n}(r)\\}_{n=0}^{N-1}$ defined by $\\phi_{n}(r) = r^{n}$, which respects regularity at $r=0$. In this basis, assemble the symmetric stiffness matrix $W$ and mass matrix $M$:\n$$\nW_{ij} \\;=\\; \\int_{0}^{a} r\\,\\mathrm{d}r\\left[ B_{z}^{2} \\,\\frac{\\mathrm{d}\\phi_{i}}{\\mathrm{d}r} \\,\\frac{\\mathrm{d}\\phi_{j}}{\\mathrm{d}r} \\;+\\; \\left(k^{2} B_{z}^{2} - \\mu^{2}\\right)\\,\\phi_{i}\\,\\phi_{j} \\right], \\qquad\nM_{ij} \\;=\\; \\int_{0}^{a} r\\,\\phi_{i}\\,\\phi_{j}\\,\\mathrm{d}r,\n$$\nand solve the generalized symmetric definite eigenvalue problem\n$$\nW\\,\\boldsymbol{c} \\;=\\; \\lambda\\, M\\,\\boldsymbol{c},\n$$\nto obtain the smallest eigenvalue $\\lambda_{\\min}$, which approximates $\\inf_{\\xi}\\lambda[\\xi]$ by restricting $\\xi$ to the span of the chosen basis. In this reduced model, the constant basis function $\\phi_{0}(r)=1$ yields a Rayleigh quotient equal to $\\lambda_{\\text{analytic}} = k^{2}B_{z}^{2} - \\mu^{2}$, so the Rayleigh–Ritz approximation should reproduce the analytic threshold exactly when the basis includes $\\phi_{0}$.\n\nNumerical integration of the matrix elements can be done in closed form for $\\phi_{n}(r) = r^{n}$:\n$$\nM_{ij} \\;=\\; \\int_{0}^{a} r^{i+j+1}\\,\\mathrm{d}r \\;=\\; \\frac{a^{i+j+2}}{i+j+2},\n$$\n$$\nW_{ij} \\;=\\; B_{z}^{2}\\,i\\,j\\,\\int_{0}^{a} r^{i+j-1}\\,\\mathrm{d}r \\;+\\; \\left(k^{2} B_{z}^{2} - \\mu^{2}\\right)\\,M_{ij} \\;=\\; B_{z}^{2}\\,i\\,j\\,\\frac{a^{i+j}}{i+j} \\;+\\; \\left(k^{2} B_{z}^{2} - \\mu^{2}\\right)\\,\\frac{a^{i+j+2}}{i+j+2},\n$$\nwith the understanding that the derivative term vanishes when $i=0$ or $j=0$ due to the factors $i$ and $j$.\n\nYour program must:\n- Implement the Rayleigh–Ritz method as defined above.\n- For each provided test case, compute the smallest eigenvalue $\\lambda_{\\min}$ and compare it to the analytic prediction $\\lambda_{\\text{analytic}} = k^{2} B_{z}^{2} - \\mu^{2}$ by checking whether the sign classification (stable if $\\lambda_{\\min} > 0$, unstable if $\\lambda_{\\min} < 0$, marginal if $|\\lambda_{\\min}|$ is within a numerical tolerance) matches the analytic classification derived from the Kruskal–Shafranov condition.\n- Express $\\lambda_{\\min}$ numerically as a float in the unit $\\mathrm{T}^{2}\\cdot \\mathrm{m}^{-2}$ (Tesla squared per meter squared).\n- Use a numerical tolerance of $10^{-8}$ for classifying a value as marginally zero.\n\nTest Suite:\nUse the following test cases, each specified as a tuple $(a, B_{z}, k, \\mu, N)$ with $a$ in meters, $B_{z}$ in Tesla, $k$ in inverse meters, $\\mu$ in Tesla per meter, and $N$ the number of basis functions:\n1. $(1.0,\\, 1.0,\\, 1.0,\\, 0.8,\\, 6)$.\n2. $(0.5,\\, 1.5,\\, 2.0,\\, 3.0,\\, 5)$.\n3. $(1.0,\\, 0.5,\\, 0.5,\\, 0.4,\\, 8)$.\n4. $(2.0,\\, 0.8,\\, 0.25,\\, 0.1,\\, 4)$.\n\nFinal Output Format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where for each test case you output the smallest eigenvalue followed by a boolean indicating whether the numerical sign classification matches the analytic kink threshold classification. Concretely, the output must be of the form\n$[\\lambda_{1},\\,\\texttt{match}_{1},\\,\\lambda_{2},\\,\\texttt{match}_{2},\\,\\lambda_{3},\\,\\texttt{match}_{3},\\,\\lambda_{4},\\,\\texttt{match}_{4}]$,\nwith all $\\lambda_{i}$ in $\\mathrm{T}^{2}\\cdot \\mathrm{m}^{-2}$.", "solution": "We begin from the ideal Magnetohydrodynamics (MHD) energy principle, which states that plasma stability in the ideal limit is determined by the sign of the second variation of the potential energy $\\delta W[\\boldsymbol{\\xi}]$ under dynamically accessible perturbations $\\boldsymbol{\\xi}$. For an incompressible displacement field satisfying $\\nabla\\cdot \\boldsymbol{\\xi} = 0$ in a low-pressure plasma where pressure effects are negligible, the dominant contribution to $\\delta W$ arises from magnetic line bending and the interaction with the external vacuum.\n\nIn cylindrical geometry with equilibrium magnetic field $\\boldsymbol{B}(r)=B_{z}\\,\\hat{\\boldsymbol{z}} + B_{\\theta}(r)\\,\\hat{\\boldsymbol{\\theta}}$ and non-rotating low-pressure equilibrium, consider Fourier perturbations with azimuthal mode number $m$ and axial wavenumber $k$, i.e. $\\boldsymbol{\\xi}(r,\\theta,z) = \\xi_{r}(r)\\,\\hat{\\boldsymbol{r}}\\,\\exp\\{i(m\\theta + kz)\\}$ for the dominant radial component near the $m=1$ kink. For $m=1$, the mode resembles a rigid lateral shift of the column. In the cold plasma limit and for incompressible displacements, the ideal MHD energy principle yields the magnetic energy change dominated by line bending,\n$$\n\\delta W_{\\text{bend}} \\sim \\frac{1}{2\\mu_{0}} \\int \\mathrm{d}V\\, \\left|\\boldsymbol{B}\\cdot\\nabla\\boldsymbol{\\xi}_{\\perp}\\right|^{2},\n$$\nwith $\\boldsymbol{\\xi}_{\\perp}$ the transverse displacement. For the stated Fourier dependence and the given equilibrium, the longitudinal derivative along field lines contributes a term proportional to $k^{2}B_{z}^{2}|\\xi|^{2}$, and radial shear contributes $B_{z}^{2}|\\mathrm{d}\\xi/\\mathrm{d}r|^{2}$. In addition, the external vacuum magnetic field perturbs in response to the edge displacement, providing a destabilizing contribution that, in a thin-vacuum-wall approximation, can be represented as an effective negative term proportional to the squared edge azimuthal field $B_{\\theta}(a)^{2}$ times the squared edge displacement. Under the $m=1$ rigid-displacement approximation, the edge displacement is representative of the interior displacement amplitude, so the vacuum contribution can be modeled as a uniform negative term proportional to $\\int r|\\xi|^{2}\\,\\mathrm{d}r$. Collecting these pieces, we arrive at the reduced one-dimensional energy functional for the $m=1$ mode,\n$$\n\\delta W[\\xi] \\;=\\; \\int_{0}^{a} r \\,\\mathrm{d}r \\left[ B_{z}^{2}\\,\\left|\\frac{\\mathrm{d}\\xi}{\\mathrm{d}r}\\right|^{2} \\;+\\; k^{2} B_{z}^{2}\\,|\\xi|^{2} \\right] \\;-\\; \\frac{B_{\\theta}(a)^{2}}{a^{2}} \\int_{0}^{a} r \\,|\\xi|^{2}\\,\\mathrm{d}r.\n$$\nFor the equilibrium $B_{\\theta}(r) = \\mu\\,r$, we have $\\frac{B_{\\theta}(a)}{a}= \\mu$, with $\\mu$ carrying the unit of Tesla per meter. This model captures the essential dependence of the kink stability threshold on the axial field strength and the edge azimuthal field as per the Kruskal–Shafranov condition.\n\nTo compute the smallest value of the Rayleigh quotient\n$$\n\\lambda[\\xi] \\;=\\; \\frac{\\delta W[\\xi]}{\\displaystyle \\int_{0}^{a} r\\,|\\xi|^{2}\\,\\mathrm{d}r},\n$$\nwe use the Rayleigh–Ritz method, which reduces the infinite-dimensional minimization to a generalized matrix eigenvalue problem via a finite basis. Choose the polynomial basis $\\phi_{n}(r)=r^{n}$ for $n=0,1,\\dots,N-1$. This basis is regular at $r=0$ and includes the physically relevant rigid-displacement component via $\\phi_{0}(r)=1$.\n\nWith this basis, the Rayleigh quotient restricted to the span of $\\{\\phi_{n}\\}$ is equivalent to the smallest eigenvalue of the generalized symmetric definite eigenproblem\n$$\nW\\,\\boldsymbol{c} \\;=\\; \\lambda\\, M\\,\\boldsymbol{c},\n$$\nwhere the stiffness matrix $W$ and mass matrix $M$ have entries\n$$\nM_{ij} \\;=\\; \\int_{0}^{a} r\\,\\phi_{i}\\,\\phi_{j}\\,\\mathrm{d}r \\;=\\; \\int_{0}^{a} r^{i+j+1}\\,\\mathrm{d}r \\;=\\; \\frac{a^{i+j+2}}{i+j+2},\n$$\n$$\nW_{ij} \\;=\\; \\int_{0}^{a} r\\,\\left[ B_{z}^{2} \\,\\frac{\\mathrm{d}\\phi_{i}}{\\mathrm{d}r} \\,\\frac{\\mathrm{d}\\phi_{j}}{\\mathrm{d}r} \\;+\\; \\left(k^{2} B_{z}^{2} - \\mu^{2}\\right)\\,\\phi_{i}\\,\\phi_{j} \\right] \\mathrm{d}r \\;=\\; B_{z}^{2}\\,i\\,j\\,\\frac{a^{i+j}}{i+j} \\;+\\; \\left(k^{2} B_{z}^{2} - \\mu^{2}\\right)\\,\\frac{a^{i+j+2}}{i+j+2},\n$$\nwith the understanding that the derivative contribution vanishes for $i=0$ or $j=0$ because of the prefactor $i\\,j$. The integrals are exact and yield symmetric, real matrices. The matrix $M$ is positive definite for the chosen basis, and $W$ is symmetric, so the generalized eigenvalues are real and can be computed using a robust solver for symmetric definite pairs.\n\nThe smallest eigenvalue $\\lambda_{\\min}$ obtained from this generalized eigenproblem approximates the infimum of the Rayleigh quotient over the function space spanned by the basis. Since the basis includes $\\phi_{0}$, the Rayleigh quotient evaluated on $\\phi_{0}$ is exactly\n$$\n\\lambda[\\phi_{0}] \\;=\\; \\frac{\\left(k^{2} B_{z}^{2} - \\mu^{2}\\right) \\int_{0}^{a} r\\,\\mathrm{d}r}{\\int_{0}^{a} r\\,\\mathrm{d}r} \\;=\\; k^{2} B_{z}^{2} - \\mu^{2},\n$$\nbecause the derivative term vanishes for a constant function. Therefore, the Rayleigh–Ritz method reproduces the analytic prediction for the reduced model’s marginal stability point exactly when $\\phi_{0}$ is present. This gives a direct numerical validation of the cylindrical kink threshold tied to the Kruskal–Shafranov condition, expressed here in terms of $k$, $B_{z}$, and $B_{\\theta}(a)/a=\\mu$.\n\nAlgorithmic steps:\n1. For each test case $(a, B_{z}, k, \\mu, N)$, build the matrices $W$ and $M$ using the closed-form integrals above for basis size $N$.\n2. Solve $W\\,\\boldsymbol{c} = \\lambda\\, M\\,\\boldsymbol{c}$ for $\\lambda$ using a generalized eigenvalue solver that preserves symmetry (for example, a function specialized to symmetric definite problems).\n3. Extract the smallest eigenvalue $\\lambda_{\\min}$ and classify it as stable if $\\lambda_{\\min} > \\varepsilon$, unstable if $\\lambda_{\\min} < -\\varepsilon$, or marginal if $|\\lambda_{\\min}| \\le \\varepsilon$, where $\\varepsilon$ is a small tolerance (use $\\varepsilon=10^{-8}$).\n4. Compute the analytic classification from the sign of $\\lambda_{\\text{analytic}} = k^{2} B_{z}^{2} - \\mu^{2}$ using the same tolerance.\n5. Report for each case the numerical $\\lambda_{\\min}$ (in $\\mathrm{T}^{2}\\cdot \\mathrm{m}^{-2}$) and a boolean indicating whether the numerical classification matches the analytic classification.\n\nThe test suite includes four cases that probe:\n- A general stable regime with $\\lambda_{\\text{analytic}} > 0$.\n- A marginal regime with $\\lambda_{\\text{analytic}} = 0$.\n- An unstable regime with $\\lambda_{\\text{analytic}} < 0$.\n- A case with different $a$ and smaller basis size to check robustness of the method.\n\nThe final program assembles and solves the generalized eigenproblems for each test case and prints a single list aggregating the smallest eigenvalue and the validation boolean for each case, as specified.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import eigh\n\ndef assemble_matrices(N, a, Bz, k, mu):\n    \"\"\"\n    Assemble stiffness matrix W and mass matrix M for the Rayleigh–Ritz method\n    using polynomial basis phi_n(r) = r^n, n=0..N-1.\n\n    W_ij = Bz^2 * i * j * a^(i+j) / (i + j) + (k^2 * Bz^2 - mu^2) * a^(i+j+2) / (i + j + 2)\n    M_ij = a^(i+j+2) / (i + j + 2)\n    with the convention that the derivative contribution vanishes for i=0 or j=0.\n    \"\"\"\n    W = np.zeros((N, N), dtype=float)\n    M = np.zeros((N, N), dtype=float)\n    for i in range(N):\n        for j in range(N):\n            # Mass matrix element\n            denom_m = i + j + 2\n            M_ij = (a ** (i + j + 2)) / denom_m\n            M[i, j] = M_ij\n            # Stiffness matrix element\n            # Derivative term\n            deriv_term = 0.0\n            if i > 0 and j > 0:\n                denom_w = i + j\n                deriv_term = (Bz ** 2) * i * j * (a ** (i + j)) / denom_w\n            W[i, j] = deriv_term + (k ** 2 * Bz ** 2 - mu ** 2) * M_ij\n    return W, M\n\ndef smallest_generalized_eigenvalue(W, M):\n    \"\"\"\n    Solve the generalized symmetric definite eigenproblem W x = lambda M x\n    and return the smallest eigenvalue.\n    \"\"\"\n    # eigh solves for symmetric (Hermitian) matrices and supports generalized problems.\n    # We request only eigenvalues for efficiency and sort ascending.\n    evals = eigh(W, M, eigvals_only=True)\n    # eigh returns sorted eigenvalues in ascending order by default for Hermitian problems\n    lam_min = float(evals[0])\n    return lam_min\n\ndef classify(value, tol=1e-8):\n    \"\"\"\n    Classify a float value with tolerance:\n    +1 for positive (> tol), -1 for negative ( -tol), 0 for near-zero (abs = tol).\n    \"\"\"\n    if value > tol:\n        return 1\n    elif value  -tol:\n        return -1\n    else:\n        return 0\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each case: (a [m], Bz [T], k [1/m], mu [T/m], N [basis size])\n    test_cases = [\n        (1.0, 1.0, 1.0, 0.8, 6),    # Stable: k^2 Bz^2 - mu^2 = 1 - 0.64 = 0.36\n        (0.5, 1.5, 2.0, 3.0, 5),    # Marginal: k^2 Bz^2 - mu^2 = 4*2.25 - 9 = 0\n        (1.0, 0.5, 0.5, 0.4, 8),    # Unstable: k^2 Bz^2 - mu^2 = 0.0625 - 0.16 = -0.0975\n        (2.0, 0.8, 0.25, 0.1, 4),   # Stable: k^2 Bz^2 - mu^2 = 0.04 - 0.01 = 0.03\n    ]\n\n    results = []\n    tol = 1e-8\n    for a, Bz, k, mu, N in test_cases:\n        W, M = assemble_matrices(N, a, Bz, k, mu)\n        lam_min = smallest_generalized_eigenvalue(W, M)\n        # Analytic prediction from reduced model: lambda_analytic = k^2 Bz^2 - mu^2\n        lam_analytic = k**2 * Bz**2 - mu**2\n        # Compare sign classifications with tolerance\n        cls_num = classify(lam_min, tol=tol)\n        cls_ana = classify(lam_analytic, tol=tol)\n        match = (cls_num == cls_ana)\n        results.append(lam_min)\n        results.append(match)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3721123"}]}