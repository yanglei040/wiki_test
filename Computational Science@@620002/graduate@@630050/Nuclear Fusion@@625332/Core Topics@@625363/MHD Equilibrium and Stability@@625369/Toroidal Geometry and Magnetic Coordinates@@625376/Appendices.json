{"hands_on_practices": [{"introduction": "The safety factor, $q$, is a cornerstone of tokamak physics, quantifying the pitch of magnetic field lines and playing a critical role in plasma stability. This exercise provides hands-on practice in computing $q$ from its fundamental definition, reinforcing its physical meaning as the ratio of toroidal to poloidal transits. By performing explicit line integrals on a given magnetic flux surface, you will connect the abstract concept of $q$ to the concrete geometry and magnetic field structure of a tokamak [@problem_id:3723432].", "problem": "Consider an axisymmetric tokamak of large aspect ratio with circular, concentric magnetic flux surfaces. Let the flux surface at minor radius $r$ be parameterized by the poloidal angle $\\theta$ and the toroidal angle $\\phi$ in cylindrical coordinates $(R,\\phi,Z)$ by\n$$R(\\theta) = R_{0} + r\\cos\\theta,\\quad Z(\\theta) = r\\sin\\theta,$$\nwith angles measured in radians. The magnetic field $\\mathbf{B}(R,Z)$ is composed of a toroidal component produced by the toroidal field coils and a poloidal component generated by a prescribed poloidal flux function. Specifically:\n- The toroidal component is consistent with a set of circular toroidal field coils and is given by\n$$\\mathbf{B}_{\\phi}(R) = \\frac{B_{0} R_{0}}{R}\\,\\mathbf{e}_{\\phi},$$\nwhere $\\mathbf{e}_{\\phi}$ is the unit vector in the toroidal direction and $B_{0}$ is the toroidal magnetic field at the magnetic axis $R=R_{0}$.\n- The poloidal component is defined via the axisymmetric poloidal flux function $\\psi(r)$ by\n$$\\mathbf{B}_{\\text{pol}} = \\frac{1}{R}\\,\\nabla\\psi(r)\\times \\mathbf{e}_{\\phi}.$$\n\nUse the fundamental definition that the safety factor $q(\\psi)$ is the number of toroidal turns made by a magnetic field line per poloidal circuit. To compute $q(\\psi)$ at a given flux surface, evaluate the poloidal and toroidal line integrals along the field line on that surface. Then, verify consistency of your result with the toroidal field coil geometry encoded in $\\mathbf{B}_{\\phi}(R)$.\n\nData for computation:\n- Major radius $R_{0} = 2.8\\ \\mathrm{m}$.\n- Minor radius of the surface $r = 0.40\\ \\mathrm{m}$.\n- Plasma minor radius $a = 0.60\\ \\mathrm{m}$.\n- Toroidal field on axis $B_{0} = 4.5\\ \\mathrm{T}$.\n- Poloidal flux function $\\psi(r) = \\psi_{0}\\,(r/a)^{2}$ with $\\psi_{0} = 0.50\\ \\mathrm{Wb}$ understood as poloidal flux per radian.\n\nCompute the safety factor $q(\\psi)$ at the flux surface $r = 0.40\\ \\mathrm{m}$ by explicitly performing the requisite poloidal and toroidal line integrals along the field line on that surface. Confirm in your derivation that the toroidal field coil geometry implies $R B_{\\phi}$ is constant on the surface. Express your final answer as a dimensionless number. Round your answer to four significant figures.", "solution": "The safety factor $q$ is defined as the number of toroidal transits a magnetic field line makes for each poloidal transit. For a continuous field, this is expressed as the differential ratio of the angular displacements $d\\phi/d\\theta$ along a field line, averaged over the flux surface. The field line trajectory is given by the relation $\\frac{d\\ell_p}{B_p} = \\frac{d\\ell_\\phi}{B_\\phi}$, where $d\\ell_p=r\\,d\\theta$ and $d\\ell_\\phi=R\\,d\\phi$ are the differential path lengths in the poloidal and toroidal directions, respectively.\n\nThis gives the local pitch of the field line:\n$$\n\\frac{d\\phi}{d\\theta} = \\frac{r B_\\phi}{R B_p}\n$$\nThe safety factor $q(r)$ on the flux surface at minor radius $r$ is the average of this quantity over one poloidal circuit:\n$$\nq(r) = \\frac{1}{2\\pi} \\int_0^{2\\pi} \\frac{r B_\\phi}{R B_p} \\, d\\theta\n$$\nWe are given the toroidal field component $B_\\phi = \\frac{B_0 R_0}{R}$. This form confirms the geometric property that $R B_\\phi = B_0 R_0$ is a constant, as expected for a vacuum toroidal field generated by external coils.\nThe poloidal field component $B_p$ is derived from the poloidal flux function $\\psi(r)$:\n$$\n\\mathbf{B}_{\\text{pol}} = \\frac{1}{R} \\nabla\\psi \\times \\mathbf{e}_{\\phi} = \\frac{1}{R} \\frac{d\\psi}{dr} \\mathbf{e}_r \\times \\mathbf{e}_{\\phi} = \\frac{1}{R} \\frac{d\\psi}{dr} \\mathbf{e}_\\theta\n$$\nSo, its magnitude is $B_p = \\frac{1}{R}\\frac{d\\psi}{dr}$. For $\\psi(r) = \\psi_0 (r/a)^2$, the derivative is $\\frac{d\\psi}{dr} = \\frac{2\\psi_0 r}{a^2}$.\n\nSubstituting these into the expression for $q(r)$:\n$$\nq(r) = \\frac{1}{2\\pi} \\int_0^{2\\pi} \\frac{r \\left(\\frac{B_0 R_0}{R}\\right)}{R \\left(\\frac{1}{R}\\frac{2\\psi_0 r}{a^2}\\right)} \\, d\\theta = \\frac{1}{2\\pi} \\int_0^{2\\pi} \\frac{r B_0 R_0 a^2}{2 \\psi_0 r R} \\, d\\theta = \\frac{B_0 R_0 a^2}{2 \\psi_0} \\frac{1}{2\\pi} \\int_0^{2\\pi} \\frac{d\\theta}{R}\n$$\nWith $R = R_0 + r\\cos\\theta$, the integral is a standard one:\n$$\n\\int_0^{2\\pi} \\frac{d\\theta}{R_0 + r\\cos\\theta} = \\frac{2\\pi}{\\sqrt{R_0^2 - r^2}}\n$$\nThus, the safety factor is:\n$$\nq(r) = \\frac{B_0 R_0 a^2}{2 \\psi_0} \\frac{1}{\\sqrt{R_0^2 - r^2}}\n$$\nNow, we substitute the given numerical values:\n- $R_0 = 2.8$ m\n- $r = 0.40$ m\n- $a = 0.60$ m\n- $B_0 = 4.5$ T\n- $\\psi_0 = 0.50$ Wb/rad\n\n$$\nq(0.40) = \\frac{(4.5\\,\\mathrm{T})(2.8\\,\\mathrm{m})(0.60\\,\\mathrm{m})^2}{2(0.50\\,\\mathrm{Wb/rad})} \\frac{1}{\\sqrt{(2.8\\,\\mathrm{m})^2 - (0.40\\,\\mathrm{m})^2}}\n$$\n$$\nq(0.40) = \\frac{4.5 \\times 2.8 \\times 0.36}{1.0} \\frac{1}{\\sqrt{7.84 - 0.16}} = 4.536 \\frac{1}{\\sqrt{7.68}} \\approx 4.536 \\times \\frac{1}{2.77128} \\approx 1.63683\n$$\nRounding to four significant figures, the safety factor at the specified surface is $1.637$.", "answer": "$$\\boxed{1.637}$$", "id": "3723432"}, {"introduction": "While direct calculation is illuminating, advanced theoretical and computational work in fusion plasma physics relies on specialized coordinate systems that simplify the complex toroidal geometry. Boozer coordinates are a prime example, chosen to yield a simple representation of the magnetic field. This exercise challenges you to derive the expression for the Boozer coordinate Jacobian, a key step that reveals the deep connection between the magnetic field strength and the volume element in this elegant system [@problem_id:3723461].", "problem": "Consider a toroidally confined plasma with nested magnetic flux surfaces labeled by a scalar flux function $\\psi$, and angular coordinates $(\\theta,\\zeta)$ that parametrize each surface. Assume a time-independent magnetic field $\\mathbf{B}$ that is tangent to the flux surfaces, so that $\\mathbf{B}\\cdot\\nabla\\psi=0$. Let $(\\psi,\\theta,\\zeta)$ be Boozer magnetic coordinates, defined such that the magnetic field has straight field lines characterized by the rotational transform $\\iota(\\psi)$ (constant on each surface), and the covariant components of the magnetic field depend only on $\\psi$, namely\n$$\n\\mathbf{B} = I(\\psi)\\,\\nabla\\theta + G(\\psi)\\,\\nabla\\zeta,\n$$\nwith $I(\\psi)$ and $G(\\psi)$ flux functions. Define the Boozer Jacobian $J_{\\text{Boozer}}$ of the coordinate transformation $\\mathbf{r}(\\psi,\\theta,\\zeta)$ by\n$$\nJ_{\\text{Boozer}} \\equiv \\left(\\nabla\\psi\\cdot\\nabla\\theta\\times\\nabla\\zeta\\right)^{-1}.\n$$\nStarting from the straight-field-line condition and basic differential geometry identities for curvilinear coordinates, derive $J_{\\text{Boozer}}$ in terms of $B\\equiv|\\mathbf{B}|$, $I(\\psi)$, $G(\\psi)$, and $\\iota(\\psi)$. Then, discuss how a change of flux normalization $\\psi\\mapsto\\psi' = F(\\psi)$ with $F'(\\psi)>0$ affects $J_{\\text{Boozer}}$ and the combination $G(\\psi)+\\iota(\\psi) I(\\psi)$ that appears in your expression.\n\nYour final answer must be a single closed-form analytic expression for $J_{\\text{Boozer}}(\\psi,\\theta,\\zeta)$ in terms of $B$, $I(\\psi)$, $G(\\psi)$, and $\\iota(\\psi)$. No numerical evaluation is required, and no units should be included in the final answer. If you introduce any intermediate constants or functions, eliminate them from the final expression so that the answer involves only $B$, $I(\\psi)$, $G(\\psi)$, and $\\iota(\\psi)$.", "solution": "To derive the Boozer coordinate Jacobian, $J_{\\text{Boozer}}$, we start from the fundamental properties of this coordinate system. In Boozer coordinates $(\\psi, \\theta, \\zeta)$, the magnetic field $\\mathbf{B}$ has both a covariant representation,\n$$\n\\mathbf{B} = I(\\psi)\\,\\nabla\\theta + G(\\psi)\\,\\nabla\\zeta,\n$$\nand a contravariant representation,\n$$\n\\mathbf{B} = B^\\psi\\,\\frac{\\partial\\mathbf{r}}{\\partial\\psi} + B^\\theta\\,\\frac{\\partial\\mathbf{r}}{\\partial\\theta} + B^\\zeta\\,\\frac{\\partial\\mathbf{r}}{\\partial\\zeta}.\n$$\nSince field lines lie on flux surfaces, $B^\\psi = \\mathbf{B}\\cdot\\nabla\\psi = 0$.\n\nThe magnitude squared of the magnetic field, $B^2 = |\\mathbf{B}|^2$, can be found by taking the dot product of the covariant representation with $\\mathbf{B}$:\n$$\nB^2 = \\mathbf{B} \\cdot \\mathbf{B} = \\mathbf{B} \\cdot \\left( I(\\psi)\\,\\nabla\\theta + G(\\psi)\\,\\nabla\\zeta \\right) = I(\\psi) (\\mathbf{B} \\cdot \\nabla\\theta) + G(\\psi) (\\mathbf{B} \\cdot \\nabla\\zeta)\n$$\nRecognizing that $\\mathbf{B}\\cdot\\nabla\\theta = B^\\theta$ and $\\mathbf{B}\\cdot\\nabla\\zeta = B^\\zeta$, we have:\n$$\nB^2 = I(\\psi) B^\\theta + G(\\psi) B^\\zeta\n$$\nA key feature of straight-field-line coordinates is that the ratio of the contravariant components is equal to the rotational transform, $\\iota(\\psi)$:\n$$\n\\frac{B^\\theta}{B^\\zeta} = \\iota(\\psi) \\implies B^\\theta = \\iota(\\psi) B^\\zeta\n$$\nSubstituting this into the expression for $B^2$:\n$$\nB^2 = I(\\psi) \\left( \\iota(\\psi) B^\\zeta \\right) + G(\\psi) B^\\zeta = \\left( G(\\psi) + \\iota(\\psi) I(\\psi) \\right) B^\\zeta\n$$\nNext, we use the fact that the magnetic field is divergence-free, $\\nabla\\cdot\\mathbf{B}=0$. In general curvilinear coordinates, this condition is written as $\\frac{\\partial}{\\partial x^i} (\\sqrt{g} B^i) = 0$, where $\\sqrt{g}$ is the Jacobian. In our notation, $J_{\\text{Boozer}} = \\sqrt{g}$. With $B^\\psi=0$ and $\\iota=\\iota(\\psi)$, the condition becomes:\n$$\n\\frac{\\partial}{\\partial\\theta} (J_{\\text{Boozer}} B^\\theta) + \\frac{\\partial}{\\partial\\zeta} (J_{\\text{Boozer}} B^\\zeta) = 0 \\implies \\iota(\\psi)\\frac{\\partial}{\\partial\\theta} (J_{\\text{Boozer}} B^\\zeta) + \\frac{\\partial}{\\partial\\zeta} (J_{\\text{Boozer}} B^\\zeta) = 0\n$$\nBoozer coordinates are specifically constructed so that this equation is satisfied by making the product $J_{\\text{Boozer}} B^\\zeta$ independent of both $\\theta$ and $\\zeta$, i.e., it is a flux function. The value of this flux function is fixed by the normalization of the flux coordinate $\\psi$. With the standard Boozer normalization, where $2\\pi\\psi$ is the toroidal magnetic flux, it can be shown that this flux function is unity:\n$$\nJ_{\\text{Boozer}} B^\\zeta = 1\n$$\nThis is a defining property of standard Boozer coordinates. Now we can combine our results. From the expression for $B^2$, we solve for $B^\\zeta$:\n$$\nB^\\zeta = \\frac{B^2}{G(\\psi) + \\iota(\\psi) I(\\psi)}\n$$\nSubstituting this into the normalization condition $J_{\\text{Boozer}} B^\\zeta = 1$:\n$$\nJ_{\\text{Boozer}} \\left( \\frac{B^2}{G(\\psi) + \\iota(\\psi) I(\\psi)} \\right) = 1\n$$\nSolving for the Jacobian gives the desired result:\n$$\nJ_{\\text{Boozer}} = \\frac{G(\\psi) + \\iota(\\psi) I(\\psi)}{B^2}\n$$\nThis expression reveals that the Jacobian in Boozer coordinates is inversely proportional to the magnetic field strength squared. Since $B$ varies on a flux surface, so must the Jacobian.\n\nRegarding the flux normalization change $\\psi \\mapsto \\psi' = F(\\psi)$, the Jacobian transforms as $J' = J/F'(\\psi)$. The combination $G+\\iota I$ is a physical quantity associated with the currents flowing on a given surface, and its value on that surface is invariant under re-labeling. Therefore, the quantity $G+\\iota I$ itself remains unchanged at any point in space, while the formula for the Jacobian must be adjusted to account for the new normalization convention (specifically, $J'B^\\zeta = 1/F'(\\psi)$), maintaining overall consistency.", "answer": "$$\n\\boxed{\\frac{G(\\psi) + \\iota(\\psi) I(\\psi)}{B^{2}}}\n$$", "id": "3723461"}, {"introduction": "The choice between different magnetic coordinate systems, such as Boozer and Hamada coordinates, is not merely a theoretical preference but has profound practical implications for numerical modeling. This computational exercise puts theory into practice, asking you to implement a numerical criterion to determine which coordinate system is more advantageous for calculating surface averages. By comparing the 'uniformity' of an integrand in each system, you will gain insight into how coordinate choice directly impacts the efficiency and accuracy of numerical codes used in fusion research [@problem_id:3723408].", "problem": "Consider a single nested magnetic flux surface in a toroidal confinement device used for nuclear fusion. Let the surface be labeled by the toroidal magnetic flux $\\psi$ and parameterized by straight-field-line angles $(\\theta,\\zeta)$, where $\\theta \\in [0,2\\pi)$ is the poloidal angle and $\\zeta \\in [0,2\\pi)$ is the toroidal angle, both measured in radians. The magnetic field magnitude on the surface is represented by a truncated Fourier series\n$$\nB(\\theta,\\zeta) = B_0 \\left[ 1 + \\epsilon \\cos(m\\,\\theta - n\\,\\zeta) \\right],\n$$\nwith $B_0$ in Tesla, integer mode numbers $m$ and $n$, and a dimensionless amplitude $\\epsilon$ satisfying $0 \\le \\epsilon < 1$ to ensure $B(\\theta,\\zeta) > 0$. Assume ideal Magnetohydrodynamics (MHD) equilibrium and the existence of straight-field-line magnetic coordinates.\n\nTwo widely used magnetic coordinate systems are Boozer coordinates and Hamada coordinates. In Boozer coordinates, a well-tested property is that $B^2 J$ is a flux function, where $J$ is the Jacobian of the transformation $(\\psi,\\theta,\\zeta) \\mapsto (x,y,z)$ and a flux function depends only on $\\psi$. In Hamada coordinates, a well-tested property is that $J$ itself is a flux function. On a single flux surface, any flux function may be treated as a constant with respect to $(\\theta,\\zeta)$ and absorbed into normalization. Therefore, for the purposes of numerical quadrature on a single surface, one may model the angle dependence of the Jacobian as\n- Hamada: $J_{\\mathrm{H}}(\\theta,\\zeta) \\propto 1$,\n- Boozer: $J_{\\mathrm{B}}(\\theta,\\zeta) \\propto \\dfrac{1}{B(\\theta,\\zeta)^2}$,\nup to multiplicative constants that do not affect uniformity metrics.\n\nLet $f(\\theta,\\zeta)$ be a target integrand to be averaged over the surface. The flux-surface average in any coordinate system is proportional to\n$$\n\\langle f \\rangle \\propto \\int_0^{2\\pi}\\int_0^{2\\pi} f(\\theta,\\zeta)\\, J(\\theta,\\zeta)\\, d\\theta\\, d\\zeta.\n$$\nIn practical numerical field-line tracing and quadrature, simple uniform sampling of $(\\theta,\\zeta)$ is often used, so the uniformity of the effective integrand $g(\\theta,\\zeta) = f(\\theta,\\zeta)\\,J(\\theta,\\zeta)$ directly influences discretization error. A principled, coordinate-agnostic preference criterion is to choose the coordinate system that minimizes the coefficient of variation of $g$, defined for discrete samples $\\{g_k\\}_{k=1}^K$ by\n$$\n\\mathrm{CV}(g) = \\frac{\\sqrt{\\mathrm{Var}(g)}}{\\mathbb{E}[g]}.\n$$\nHere, $\\mathbb{E}[g]$ and $\\mathrm{Var}(g)$ denote the sample mean and sample variance over a uniform grid in $(\\theta,\\zeta)$.\n\nYour task is to implement this preference criterion and decide, for each test case, whether Boozer coordinates are preferred to Hamada coordinates under the choice $f(\\theta,\\zeta) = B(\\theta,\\zeta)^p$ for a given exponent $p$. Specifically:\n\n1. For each test case, construct $B(\\theta,\\zeta)$ on a uniform grid of $N \\times N$ points with $N = 512$, covering $\\theta \\in [0,2\\pi)$ and $\\zeta \\in [0,2\\pi)$ in radians.\n2. Define $f(\\theta,\\zeta) = B(\\theta,\\zeta)^p$ with the given $p$ (dimensionless).\n3. Form $g_{\\mathrm{H}}(\\theta,\\zeta) = f(\\theta,\\zeta)\\,J_{\\mathrm{H}}(\\theta,\\zeta)$ with $J_{\\mathrm{H}}(\\theta,\\zeta) = 1$ and $g_{\\mathrm{B}}(\\theta,\\zeta) = f(\\theta,\\zeta)\\,J_{\\mathrm{B}}(\\theta,\\zeta)$ with $J_{\\mathrm{B}}(\\theta,\\zeta) = \\dfrac{1}{B(\\theta,\\zeta)^2}$. The multiplicative normalization constants are irrelevant because the coefficient of variation is scale-invariant.\n4. Compute $\\mathrm{CV}(g_{\\mathrm{B}})$ and $\\mathrm{CV}(g_{\\mathrm{H}})$ as floats.\n5. Decide that Boozer coordinates are preferred if and only if $\\mathrm{CV}(g_{\\mathrm{B}}) < \\mathrm{CV}(g_{\\mathrm{H}})$.\n\nProvide the results for the following test suite of parameter values, chosen to exercise different regimes:\n- Test $1$ (happy path for $p=2$): $B_0 = 5$ Tesla, $\\epsilon = 0.1$, $m = 1$, $n = 1$, $p = 2$.\n- Test $2$ (boundary case of no variation): $B_0 = 5$ Tesla, $\\epsilon = 0$, $m = 1$, $n = 1$, $p = 1$.\n- Test $3$ (preference for Hamada with uniform integrand): $B_0 = 3$ Tesla, $\\epsilon = 0.25$, $m = 2$, $n = 3$, $p = 0$.\n- Test $4$ (nontrivial comparison): $B_0 = 2$ Tesla, $\\epsilon = 0.3$, $m = 3$, $n = 1$, $p = 1$.\n- Test $5$ (strong but positive variation): $B_0 = 4$ Tesla, $\\epsilon = 0.9$, $m = 1$, $n = 2$, $p = 2$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[result_1,result_2,\\dots,result_5]$), where each entry is a boolean indicating whether Boozer coordinates are preferred for the corresponding test, according to the criterion above. Angles must be treated in radians throughout. No external input is required, and no physical units should appear in the output.", "solution": "The problem requires a determination of the preferred magnetic coordinate system between Boozer and Hamada coordinates for the purpose of numerical integration over a toroidal magnetic flux surface. The criterion for this preference is based on minimizing the numerical error associated with uniform grid sampling by selecting the coordinate system that yields a more uniform effective integrand. The uniformity is quantified by the coefficient of variation, $\\mathrm{CV}$.\n\nThe magnetic field magnitude, $B$, on the flux surface is given as a function of the poloidal angle $\\theta$ and toroidal angle $\\zeta$:\n$$B(\\theta,\\zeta) = B_0 \\left[ 1 + \\epsilon \\cos(m\\,\\theta - n\\,\\zeta) \\right]$$\nHere, $B_0$ is a base magnetic field strength, $\\epsilon$ is the dimensionless amplitude of the magnetic field modulation, and $m$ and $n$ are integer mode numbers. The constraint $0 \\le \\epsilon < 1$ ensures that $B(\\theta,\\zeta) > 0$.\n\nThe target function for the surface average is specified as $f(\\theta,\\zeta) = B(\\theta,\\zeta)^p$, where $p$ is a real exponent.\n\nThe flux-surface average of any function $f$ is proportional to the integral of the effective integrand, $g(\\theta,\\zeta) = f(\\theta,\\zeta)\\,J(\\theta,\\zeta)$, over the angular domain $\\theta, \\zeta \\in [0, 2\\pi)$. The term $J(\\theta,\\zeta)$ is the Jacobian of the coordinate transformation. The problem provides the angle-dependent behavior of the Jacobians for the two systems on a single flux surface:\n- In Hamada coordinates, the Jacobian $J_{\\mathrm{H}}$ is constant with respect to $\\theta$ and $\\zeta$. We may take $J_{\\mathrm{H}}(\\theta,\\zeta) \\propto 1$.\n- In Boozer coordinates, the product $B^2 J_{\\mathrm{B}}$ is constant. Therefore, the Jacobian must vary as $J_{\\mathrm{B}}(\\theta,\\zeta) \\propto \\frac{1}{B(\\theta,\\zeta)^2}$.\n\nUsing these forms, we define the effective integrands for each system, up to an irrelevant constant of proportionality:\n- For Hamada coordinates: $g_{\\mathrm{H}}(\\theta,\\zeta) = f(\\theta,\\zeta) \\cdot J_{\\mathrm{H}} = B(\\theta,\\zeta)^p \\cdot 1 = B(\\theta,\\zeta)^p$.\n- For Boozer coordinates: $g_{\\mathrm{B}}(\\theta,\\zeta) = f(\\theta,\\zeta) \\cdot J_{\\mathrm{B}} = B(\\theta,\\zeta)^p \\cdot \\frac{1}{B(\\theta,\\zeta)^2} = B(\\theta,\\zeta)^{p-2}$.\n\nThe preference criterion is to choose the coordinate system with the smaller coefficient of variation, $\\mathrm{CV}$, for its effective integrand. The $\\mathrm{CV}$ for a set of samples is defined as the ratio of the standard deviation to the mean. Since this metric is scale-invariant, the constants of proportionality associated with $B_0$ and the Jacobians do not affect the comparison. Boozer coordinates are preferred if and only if the inequality $\\mathrm{CV}(g_{\\mathrm{B}}) < \\mathrm{CV}(g_{\\mathrm{H}})$ holds true.\n\nTo implement this criterion, we perform a numerical evaluation. The continuous domain $(\\theta, \\zeta) \\in [0, 2\\pi) \\times [0, 2\\pi)$ is discretized into a uniform grid of $N \\times N$ points, with $N = 512$. The grid points are given by $(\\theta_i, \\zeta_j)$ where $\\theta_i = \\frac{2\\pi i}{N}$ and $\\zeta_j = \\frac{2\\pi j}{N}$ for $i, j \\in \\{0, 1, \\dots, N-1\\}$.\n\nFor each test case defined by the parameters $(B_0, \\epsilon, m, n, p)$, the following steps are executed:\n1.  The magnetic field values $B_{ij} = B(\\theta_i, \\zeta_j)$ are computed for all points on the grid.\n2.  The corresponding values for the effective integrands are calculated: $g_{\\mathrm{H}, ij} = (B_{ij})^p$ and $g_{\\mathrm{B}, ij} = (B_{ij})^{p-2}$.\n3.  The coefficient of variation is computed for each set of values. For a generic set of $K=N^2$ grid values $\\{g_k\\}$, the sample mean $\\mathbb{E}[g]$ and sample variance $\\mathrm{Var}(g)$ are:\n    $$\\mathbb{E}[g] = \\frac{1}{K} \\sum_{k=1}^K g_k$$\n    $$\\mathrm{Var}(g) = \\frac{1}{K} \\sum_{k=1}^K (g_k - \\mathbb{E}[g])^2$$\n    The coefficient of variation is then $\\mathrm{CV}(g) = \\frac{\\sqrt{\\mathrm{Var}(g)}}{\\mathbb{E}[g]}$.\n4.  The final decision is made by evaluating the boolean expression $\\mathrm{CV}(g_{\\mathrm{B}}) < \\mathrm{CV}(g_{\\mathrm{H}})$.\n\nThis procedure is applied to each of the five specified test cases. Notably, certain parameter choices lead to analytically trivial outcomes. If $p=2$, then $g_{\\mathrm{B}} \\propto B^0 = 1$, which is perfectly uniform. Its variance and $\\mathrm{CV}$ are zero. Unless $\\epsilon=0$, $g_{\\mathrm{H}} \\propto B^2$ will be non-uniform, so $\\mathrm{CV}(g_{\\mathrm{H}}) > 0$. In this case, Boozer coordinates are always preferred. Conversely, if $p=0$, $g_{\\mathrm{H}} \\propto B^0 = 1$ is uniform, so $\\mathrm{CV}(g_{\\mathrm{H}}) = 0$, while $g_{\\mathrm{B}} \\propto B^{-2}$ is non-uniform (for $\\epsilon>0$), making Hamada coordinates preferable. If $\\epsilon=0$, the magnetic field is constant, $B=B_0$, making both $g_{\\mathrm{H}}$ and $g_{\\mathrm{B}}$ constant. Their $\\mathrm{CV}$s are both zero, and the condition $\\mathrm{CV}(g_{\\mathrm{B}}) < \\mathrm{CV}(g_{\\mathrm{H}})$ evaluates to $0 < 0$, which is false.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem of choosing between Boozer and Hamada coordinates based on\n    the uniformity of an effective integrand for a series of test cases.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each tuple is (B0, epsilon, m, n, p).\n    test_cases = [\n        (5.0, 0.1, 1, 1, 2.0),\n        (5.0, 0.0, 1, 1, 1.0),\n        (3.0, 0.25, 2, 3, 0.0),\n        (2.0, 0.3, 3, 1, 1.0),\n        (4.0, 0.9, 1, 2, 2.0),\n    ]\n\n    results = []\n    N = 512\n\n    # Create the angular grids for theta and zeta.\n    # The grid covers [0, 2*pi) as specified.\n    angles = np.linspace(0, 2 * np.pi, N, endpoint=False)\n    theta_grid, zeta_grid = np.meshgrid(angles, angles, indexing='ij')\n\n    for b0, epsilon, m, n, p in test_cases:\n        # Calculate the magnetic field B(theta, zeta) on the grid.\n        # B = B_0 * [1 + epsilon * cos(m*theta - n*zeta)]\n        B_grid = b0 * (1 + epsilon * np.cos(m * theta_grid - n * zeta_grid))\n\n        # Form the effective integrands g_H and g_B.\n        # g_H is proportional to B^p\n        # g_B is proportional to B^(p-2)\n        g_H = np.power(B_grid, p)\n        g_B = np.power(B_grid, p - 2)\n\n        # Calculate the coefficient of variation (CV) for each integrand.\n        # CV(g) = std(g) / mean(g).\n        # We use the population standard deviation (numpy.std default, ddof=0),\n        # as the grid represents the entire population of discrete points.\n        \n        # Denominators (means) are guaranteed to be positive since B > 0.\n        mean_g_H = np.mean(g_H)\n        std_g_H = np.std(g_H)\n        cv_H = std_g_H / mean_g_H\n\n        mean_g_B = np.mean(g_B)\n        std_g_B = np.std(g_B)\n        cv_B = std_g_B / mean_g_B\n\n        # Decide if Boozer coordinates are preferred.\n        # The criterion is CV(g_B)  CV(g_H).\n        is_boozer_preferred = cv_B  cv_H\n        results.append(is_boozer_preferred)\n\n    # Final print statement in the exact required format.\n    # The results list contains booleans, which need to be converted to lowercase strings.\n    print(f\"[{','.join(map(str, results))}]\".lower())\n\nsolve()\n```", "id": "3723408"}]}