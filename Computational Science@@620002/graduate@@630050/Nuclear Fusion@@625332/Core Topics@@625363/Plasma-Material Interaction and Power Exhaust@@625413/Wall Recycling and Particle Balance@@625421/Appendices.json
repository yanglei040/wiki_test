{"hands_on_practices": [{"introduction": "Connecting abstract models to experimental reality is a cornerstone of plasma physics. This exercise guides you through the process of inferring the local recycling coefficient, $R$, by synthesizing data from common plasma diagnostics. By combining Langmuir probe measurements of plasma density and temperature with optical measurements of neutral particle emission, you will apply fundamental concepts like the Bohm sheath criterion and collisional-radiative modeling to determine a key parameter governing plasma-wall interactions [@problem_id:3725456].", "problem": "A deuterium plasma in a diverted configuration exhibits strong interaction with the solid target. A steady-state, one-dimensional normal coordinate $x$ is defined pointing from the target surface into the plasma. A Langmuir probe embedded flush with the target measures the local electron density $n_e$ and electron temperature $T_e$ at the sheath entrance. An absolutely calibrated optical system measures the Balmer-alpha (D$\\alpha$) line emission, providing the line-integrated, $4\\pi$-solid-angle brightness $B_{4\\pi}$ along a viewing chord of length $L$ normal to the target, and the spatial profile along this chord is approximately uniform. The collisional-radiative ionizations-per-photon coefficient (SXB) for deuterium at the measured plasma conditions is known from a validated model.\n\nAssume a singly ionized deuterium plasma, quasi-neutrality at the sheath entrance, ion temperature negligible compared to $T_e$, and that the dominant local source of ions within the chord is ionization of recycled neutrals. The Bohm sheath criterion gives the ion sound speed $c_s \\approx \\sqrt{\\frac{T_{e,J}}{m_D}}$, where $T_{e,J}$ is the electron thermal energy in Joules and $m_D$ is the deuterium ion mass. The local recycling coefficient $R$ is defined as the ratio of the area-integrated ionization source over the chord to the incident ion flux density to the target at steady state.\n\nGiven the following measured and model parameters:\n- $n_e = 5.0 \\times 10^{18}\\ \\mathrm{m}^{-3}$,\n- $T_e = 10\\ \\mathrm{eV}$,\n- $B_{4\\pi} = 4.0 \\times 10^{21}\\ \\mathrm{photons}\\ \\mathrm{m}^{-2}\\ \\mathrm{s}^{-1}$,\n- $L = 0.02\\ \\mathrm{m}$,\n- $\\mathrm{SXB}(T_e,n_e) = 25$,\n- $e = 1.602 \\times 10^{-19}\\ \\mathrm{C}$ (elementary charge),\n- Note: The electron thermal energy in Joules, $T_{e,J}$, is obtained from the temperature in eV, $T_e$, using the conversion $1\\ \\mathrm{eV} = 1.602 \\times 10^{-19}\\ \\mathrm{J}$.\n- $m_D = 3.344 \\times 10^{-27}\\ \\mathrm{kg}$,\n\ninfer the local recycling coefficient $R$ by combining the measured ion flux density and the neutral ionization source estimated from the D$\\alpha$ emission and the SXB coefficient. Express the final recycling coefficient as a dimensionless number. Round your answer to three significant figures.", "solution": "The problem is validated as scientifically sound, well-posed, objective, and containing all necessary information for a unique solution. The scenario and parameters described are standard in the field of plasma-wall interaction physics, specifically in the study of tokamak divertors. We may therefore proceed with the solution.\n\nThe local recycling coefficient, $R$, is defined as the ratio of the area-integrated ionization source over the chord to the incident ion flux density to the target. For a steady-state, one-dimensional system with a uniform profile along the coordinate normal to the target, this is expressed as:\n$$R = \\frac{S_{\\text{ion}} \\cdot L}{\\Gamma_{\\text{ion}}}$$\nwhere $S_{\\text{ion}}$ is the volumetric ionization rate in units of particles per cubic meter per second ($\\mathrm{m}^{-3}\\mathrm{s}^{-1}$), $L$ is the length of the observation chord, and $\\Gamma_{\\text{ion}}$ is the incident ion flux density at the target surface in units of particles per square meter per second ($\\mathrm{m}^{-2}\\mathrm{s}^{-1}$).\n\nWe will first derive the expression for the numerator, the column-integrated ionization source rate, $S_{\\text{ion}} \\cdot L$. The measurement provides the line-integrated, $4\\pi$-solid-angle brightness $B_{4\\pi}$ (in $\\mathrm{photons}\\ \\mathrm{m}^{-2}\\ \\mathrm{s}^{-1}$). For a uniform emission profile along the chord of length $L$, $B_{4\\pi}$ is related to the local volumetric emissivity $\\epsilon_{D\\alpha}$ (in $\\mathrm{photons}\\ \\mathrm{m}^{-3}\\ \\mathrm{s}^{-1}$) by:\n$$B_{4\\pi} = \\epsilon_{D\\alpha} \\cdot L$$\nThe problem provides the collisional-radiative ionizations-per-photon coefficient, $\\mathrm{SXB}(T_e, n_e)$. This coefficient is defined as the number of ionization events per emitted D$\\alpha$ photon:\n$$\\mathrm{SXB} = \\frac{S_{\\text{ion}}}{\\epsilon_{D\\alpha}}$$\nWe can express the volumetric ionization source, $S_{\\text{ion}}$, in terms of $\\mathrm{SXB}$ and $\\epsilon_{D\\alpha}$:\n$$S_{\\text{ion}} = \\mathrm{SXB} \\cdot \\epsilon_{D\\alpha}$$\nSubstituting $\\epsilon_{D\\alpha} = \\frac{B_{4\\pi}}{L}$, we get:\n$$S_{\\text{ion}} = \\mathrm{SXB} \\cdot \\frac{B_{4\\pi}}{L}$$\nThe numerator for the recycling coefficient $R$ is therefore:\n$$S_{\\text{ion}} \\cdot L = \\left(\\mathrm{SXB} \\cdot \\frac{B_{4\\pi}}{L}\\right) \\cdot L = \\mathrm{SXB} \\cdot B_{4\\pi}$$\n\nNext, we derive the expression for the denominator, the incident ion flux density $\\Gamma_{\\text{ion}}$. The problem states that ions enter the sheath at the ion sound speed, $c_s$, as described by the Bohm sheath criterion. The flux density is the product of the ion density at the sheath entrance, $n_i$, and this velocity:\n$$\\Gamma_{\\text{ion}} = n_i \\cdot c_s$$\nIt is assumed that the plasma is quasi-neutral at the sheath entrance, meaning the ion density is equal to the measured electron density, $n_i = n_e$. The ion sound speed for a deuterium plasma with negligible ion temperature ($T_i \\ll T_e$) is given as:\n$$c_s \\approx \\sqrt{\\frac{T_{e,J}}{m_D}}$$\nwhere $T_{e,J}$ is the electron thermal energy in Joules. The problem gives the temperature in electron-volts (eV), so we must first convert it to Joules. The ion flux density to the target is thus:\n$$\\Gamma_{\\text{ion}} = n_e \\sqrt{\\frac{T_{e,J}}{m_D}}$$\n\nCombining the expressions for the numerator and the denominator, we arrive at the final symbolic expression for the recycling coefficient $R$:\n$$R = \\frac{\\mathrm{SXB} \\cdot B_{4\\pi}}{n_e \\sqrt{\\frac{T_{e,J}}{m_D}}}$$\n\nWe now substitute the given numerical values:\n- $n_e = 5.0 \\times 10^{18}\\ \\mathrm{m}^{-3}$\n- $T_e = 10\\ \\mathrm{eV}$\n- $B_{4\\pi} = 4.0 \\times 10^{21}\\ \\mathrm{photons}\\ \\mathrm{m}^{-2}\\ \\mathrm{s}^{-1}$\n- $\\mathrm{SXB} = 25$\n- $m_D = 3.344 \\times 10^{-27}\\ \\mathrm{kg}$\n\nFirst, we calculate the denominator terms. We convert the electron temperature to thermal energy in Joules:\n$$T_{e,J} = 10\\ \\mathrm{eV} \\times (1.602 \\times 10^{-19}\\ \\mathrm{J/eV}) = 1.602 \\times 10^{-18}\\ \\mathrm{J}$$\nThe ion sound speed $c_s$ is:\n$$c_s = \\sqrt{\\frac{1.602 \\times 10^{-18}\\ \\mathrm{J}}{3.344 \\times 10^{-27}\\ \\mathrm{kg}}} \\approx \\sqrt{4.79067 \\times 10^{8}\\ \\frac{\\mathrm{m}^2}{\\mathrm{s}^2}} \\approx 2.1888 \\times 10^4\\ \\frac{\\mathrm{m}}{\\mathrm{s}}$$\nThe incident ion flux density $\\Gamma_{\\text{ion}}$ is:\n$$\\Gamma_{\\text{ion}} = (5.0 \\times 10^{18}\\ \\mathrm{m}^{-3}) \\cdot (2.1888 \\times 10^4\\ \\mathrm{m/s}) \\approx 1.0944 \\times 10^{23}\\ \\mathrm{m}^{-2}\\mathrm{s}^{-1}$$\nNext, we calculate the numerator, the column-integrated ionization rate:\n$$S_{\\text{ion}} \\cdot L = \\mathrm{SXB} \\cdot B_{4\\pi} = 25 \\cdot (4.0 \\times 10^{21}\\ \\mathrm{m}^{-2}\\mathrm{s}^{-1}) = 1.0 \\times 10^{23}\\ \\mathrm{m}^{-2}\\mathrm{s}^{-1}$$\nFinally, we compute the recycling coefficient $R$:\n$$R = \\frac{1.0 \\times 10^{23}\\ \\mathrm{m}^{-2}\\mathrm{s}^{-1}}{1.0944 \\times 10^{23}\\ \\mathrm{m}^{-2}\\mathrm{s}^{-1}} \\approx 0.91374$$\nRounding the result to three significant figures as requested, we obtain the value for the recycling coefficient.", "answer": "$$\\boxed{0.914}$$", "id": "3725456"}, {"introduction": "After determining the recycling coefficient, the next step is to understand its impact on global plasma behavior. This practice uses a simplified zero-dimensional (0D) model to reveal the profound connection between wall recycling and the effective particle confinement time, $\\tau_{p}$. By performing a perturbative analysis, you will analytically derive how sensitive $\\tau_{p}$ is to small changes in $R$, uncovering a critical feedback mechanism that underlies the challenges of density control in high-recycling fusion plasmas [@problem_id:3725495].", "problem": "Consider a deuterium tokamak plasma described by a Zero-Dimensional (0D) particle balance for the core density $n(t)$ and core volume $V$. Assume that the gross ion outflow to the wall is proportional to the core density with a characteristic, recycling-independent particle loss time $\\tau_{0}$, so the gross wall loss rate is $L_{\\text{gross}} = n/\\tau_{0}$. A fraction $R \\in [0,1)$ of the particle flux to the wall is recycled and returns to the plasma boundary as neutrals. Of those recycled neutrals, a fraction $\\eta \\in [0,1]$ is promptly ionized and assimilated into the core, providing a source $S_{\\text{rec}} = \\eta R L_{\\text{gross}}$. Define the effective particle confinement time $\\tau_{p}(R)$ operationally as the ratio of core density to the net particle loss rate from the core, that is, $n/\\tau_{p} \\equiv L_{\\text{net}} = L_{\\text{gross}} - S_{\\text{rec}}$.\n\nStarting from these definitions and without invoking any shortcut formulas, perform a perturbative analysis of the sensitivity of $\\tau_{p}$ to small changes in the recycling coefficient $R$. Specifically:\n\n1. Derive an explicit expression for $\\tau_{p}(R)$ in terms of $\\tau_{0}$, $\\eta$, and $R$.\n2. Compute the derivative $d\\tau_{p}/dR$.\n3. State the sign of $d\\tau_{p}/dR$ and interpret its magnitude in the context of operational density control near a given operating point $R$.\n\nProvide the analytical expression for $d\\tau_{p}/dR$. Express the time dimension in seconds. No numerical evaluation is required.", "solution": "The problem is validated as scientifically grounded, well-posed, objective, and self-contained. The provided definitions are standard in the field of plasma-wall interactions and fusion research, forming a valid basis for a formal derivation.\n\nThe task is to perform a perturbative analysis of the effective particle confinement time $\\tau_{p}$ with respect to the recycling coefficient $R$. This involves three steps: deriving an expression for $\\tau_{p}(R)$, computing its derivative $d\\tau_{p}/dR$, and interpreting the result.\n\nFirst, we derive the expression for $\\tau_{p}(R)$. The effective particle confinement time $\\tau_{p}$ is defined operationally by the net particle loss rate from the core, $L_{\\text{net}}$:\n$$\n\\frac{n}{\\tau_{p}} \\equiv L_{\\text{net}}\n$$\nwhere $n$ is the core plasma density. The net loss rate is the difference between the gross loss rate to the wall, $L_{\\text{gross}}$, and the source of particles from recycling, $S_{\\text{rec}}$:\n$$\nL_{\\text{net}} = L_{\\text{gross}} - S_{\\text{rec}}\n$$\nSubstituting this into the definition for $\\tau_{p}$ gives:\n$$\n\\frac{n}{\\tau_{p}} = L_{\\text{gross}} - S_{\\text{rec}}\n$$\nThe problem provides expressions for $L_{\\text{gross}}$ and $S_{\\text{rec}}$. The gross loss rate is given as:\n$$\nL_{\\text{gross}} = \\frac{n}{\\tau_{0}}\n$$\nwhere $\\tau_{0}$ is the characteristic particle loss time in the absence of recycling. The recycled source is a fraction $\\eta$ of the recycled particle flux, which itself is a fraction $R$ of the gross outflow:\n$$\nS_{\\text{rec}} = \\eta R L_{\\text{gross}}\n$$\nSubstituting the expression for $L_{\\text{gross}}$ into the equation for $S_{\\text{rec}}$ yields:\n$$\nS_{\\text{rec}} = \\eta R \\frac{n}{\\tau_{0}}\n$$\nNow we substitute the expressions for $L_{\\text{gross}}$ and $S_{\\text{rec}}$ into the equation for the net loss rate:\n$$\n\\frac{n}{\\tau_{p}} = \\frac{n}{\\tau_{0}} - \\eta R \\frac{n}{\\tau_{0}}\n$$\nThe core density $n$ is a common factor on the right-hand side, so we can write:\n$$\n\\frac{n}{\\tau_{p}} = \\frac{n}{\\tau_{0}} (1 - \\eta R)\n$$\nSince $n$ is the core density, we can assume $n > 0$. Therefore, we can divide both sides by $n$:\n$$\n\\frac{1}{\\tau_{p}} = \\frac{1}{\\tau_{0}} (1 - \\eta R)\n$$\nInverting this equation gives the explicit expression for $\\tau_{p}$ as a function of $R$:\n$$\n\\tau_{p}(R) = \\frac{\\tau_{0}}{1 - \\eta R}\n$$\nThis completes the first part of the problem. It is notable that a physical solution requires $\\tau_{p}(R) > 0$. Given that $\\tau_{0} > 0$, this requires the denominator to be positive. The problem specifies $R \\in [0,1)$ and $\\eta \\in [0,1]$, which guarantees that $\\eta R < 1$, so $1-\\eta R > 0$.\n\nSecond, we compute the derivative of $\\tau_{p}(R)$ with respect to $R$. We differentiate the expression for $\\tau_{p}(R)$ using the chain rule or the quotient rule. Let's rewrite the expression using a negative exponent:\n$$\n\\tau_{p}(R) = \\tau_{0} (1 - \\eta R)^{-1}\n$$\nThe derivative is:\n$$\n\\frac{d\\tau_{p}}{dR} = \\frac{d}{dR} \\left[ \\tau_{0} (1 - \\eta R)^{-1} \\right]\n$$\nApplying the chain rule, where the outer function is $u^{-1}$ and the inner function is $u(R) = 1 - \\eta R$:\n$$\n\\frac{d\\tau_{p}}{dR} = \\tau_{0} \\cdot \\left[ (-1)(1 - \\eta R)^{-2} \\right] \\cdot \\frac{d}{dR}(1 - \\eta R)\n$$\nThe derivative of the inner function is:\n$$\n\\frac{d}{dR}(1 - \\eta R) = -\\eta\n$$\nSubstituting this back, we get:\n$$\n\\frac{d\\tau_{p}}{dR} = \\tau_{0} \\cdot \\left[ - (1 - \\eta R)^{-2} \\right] \\cdot (-\\eta)\n$$\n$$\n\\frac{d\\tau_{p}}{dR} = \\frac{\\eta \\tau_{0}}{(1 - \\eta R)^{2}}\n$$\nThis is the analytical expression for the sensitivity of the effective particle confinement time to changes in the recycling coefficient. The physical dimension of this expression is time, as $\\eta$ and $R$ are dimensionless, and $\\tau_0$ has units of time. If $\\tau_0$ is measured in seconds, then $d\\tau_p/dR$ is also in seconds.\n\nThird, we analyze the sign and magnitude of this derivative.\nThe sign of $d\\tau_{p}/dR$ is determined by the signs of the parameters in the expression. We are given:\n- $\\tau_{0} > 0$, as it is a characteristic time.\n- $\\eta \\in [0,1]$, so $\\eta \\ge 0$.\n- The denominator, $(1 - \\eta R)^{2}$, is a squared term and thus is always non-negative. Since $\\eta R < 1$, the term $(1 - \\eta R)$ is non-zero, so $(1 - \\eta R)^{2} > 0$.\n\nTherefore, the derivative $d\\tau_{p}/dR$ is non-negative. If we assume $\\eta > 0$ (i.e., some recycled neutrals are ionized and fuel the core), then $d\\tau_{p}/dR > 0$. The positive sign signifies that $\\tau_{p}$ is a monotonically increasing function of $R$. This is physically intuitive: increasing the recycling coefficient means more particles are returned to the plasma, which reduces the net loss rate and thus increases the effective particle confinement time.\n\nThe magnitude of the derivative, $\\frac{\\eta \\tau_{0}}{(1 - \\eta R)^{2}}$, provides critical insight into plasma density control. The key feature is the $(1 - \\eta R)^{2}$ term in the denominator. As the operating point approaches a high-recycling regime, where the product $\\eta R$ approaches $1$, the denominator becomes very small. This causes the derivative $d\\tau_{p}/dR$ to become very large. In an operational context, this implies that in a high-recycling plasma, the effective particle confinement time becomes extremely sensitive to small fluctuations in the recycling coefficient $R$. A minuscule change in wall conditions (e.g., surface temperature or saturation) could slightly alter $R$ and trigger a large, potentially uncontrolled, increase in $\\tau_{p}$, leading to a rapid and significant rise in plasma density. This high sensitivity makes density control challenging in high-recycling regimes. The derived expression quantifies this feedback mechanism.", "answer": "$$\n\\boxed{\\frac{\\eta \\tau_{0}}{(1 - \\eta R)^{2}}}\n$$", "id": "3725495"}, {"introduction": "This final practice completes our understanding by modeling the physical origin of the recycling coefficient itself, treating it not as a given constant but as a dynamic property of the wall material. You will construct a model from first principles that describes how the near-surface hydrogen concentration evolves under competing processes of implantation, thermal desorption, and sputtering. This advanced exercise bridges plasma physics with materials science and requires the use of numerical methods to solve for the steady-state wall conditions and the resulting recycling coefficient, $R_{\\ast}$ [@problem_id:3725459].", "problem": "Consider a plasma-facing wall in a magnetic confinement fusion device. Hydrogen from the plasma impinges on the wall with incident flux $\\Gamma_{\\mathrm{in}}$ (in $\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$). A fraction of the incident hydrogen is promptly returned to the plasma; this fraction is the wall recycling coefficient $R$, which depends on the near-surface hydrogen occupancy due to implantation. The remaining hydrogen can fill near-surface trap sites up to a finite capacity per unit area $C_{\\mathrm{H}}$ (in $\\mathrm{m}^{-2}$). Let the fraction of occupied trap sites be $\\theta \\in [0,1]$. Hydrogen implantation modifies both the recycling coefficient and sputtering yields.\n\nUse the following physically motivated model, starting from particle balance and conservation principles for the near-surface trapped hydrogen:\n- The trapped hydrogen areal density is $N_{\\mathrm{H}} = C_{\\mathrm{H}}\\,\\theta$.\n- The prompt recycling coefficient depends on occupancy as $R(\\theta) = \\min\\left(\\max\\left(R_{0} + a\\,\\theta,\\,0\\right),\\,1\\right)$, where $R_{0}$ and $a$ are dimensionless parameters.\n- The rate at which incident hydrogen fills trap sites is the incident flux multiplied by the non-recycled fraction and the fraction of available sites, i.e., $\\Gamma_{\\mathrm{in}}\\left(1 - R(\\theta)\\right)\\left(1 - \\theta\\right)$.\n- Trapped hydrogen is removed by two processes:\n  1. Thermal de-trapping (desorption) at rate $k_{\\mathrm{des}}\\,N_{\\mathrm{H}}$, where $k_{\\mathrm{des}}$ (in $\\mathrm{s}^{-1}$) is the desorption rate constant.\n  2. Sputter removal of hydrogen at rate $\\Gamma_{\\mathrm{in}}\\,Y_{\\mathrm{H}}(\\theta)$, where the hydrogen sputter yield is $Y_{\\mathrm{H}}(\\theta) = Y_{\\mathrm{H0}}\\,\\theta$ (dimensionless), with $Y_{\\mathrm{H0}}$ a constant. This form reflects that hydrogen can only be sputtered if present in the near-surface layer.\n\nAdditionally, the base material sputter yield may depend on hydrogen occupancy as $Y_{\\mathrm{M}}(\\theta) = Y_{\\mathrm{M0}}\\left(1 - b\\,\\theta\\right)$, where $Y_{\\mathrm{M0}}$ and $b$ are dimensionless. Although $Y_{\\mathrm{M}}(\\theta)$ does not directly enter the trapped hydrogen balance in this simplified active-layer model, it provides the physically consistent context that the wallâ€™s composition influences erosion.\n\nStarting from the conservation of near-surface trapped hydrogen, derive the ordinary differential equation for $\\theta(t)$ from first principles and obtain the steady-state occupancy $\\theta_{\\ast}$ that satisfies the balance of inflow and outflow to the trap population. Then compute the steady-state recycling coefficient $R_{\\ast} = R(\\theta_{\\ast})$.\n\nImplementation requirements:\n- You must formulate the dynamic equation for $\\theta(t)$ from $dN_{\\mathrm{H}}/dt$ using the above processes and then reduce it to an equation for $d\\theta/dt$.\n- You must solve for the steady-state $\\theta_{\\ast}$ by finding the root of the steady-state balance equation in the interval $\\theta \\in [0,1]$.\n- Use a robust numerical method for root finding that guarantees a solution in $\\theta \\in [0,1]$ whenever $\\Gamma_{\\mathrm{in}} > 0$, $R_{0} < 1$, $k_{\\mathrm{des}} \\ge 0$, and $Y_{\\mathrm{H0}} \\ge 0$.\n\nUnits and output:\n- $\\Gamma_{\\mathrm{in}}$ must be treated in $\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$, $C_{\\mathrm{H}}$ in $\\mathrm{m}^{-2}$, $k_{\\mathrm{des}}$ in $\\mathrm{s}^{-1}$, and $R_{\\ast}$ is dimensionless.\n- Your program must compute $R_{\\ast}$ for each test case and output them as floating-point numbers rounded to $6$ decimal places.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, e.g., $\\left[\\texttt{0.812345,0.700000,0.912345,0.623456}\\right]$.\n\nTest suite:\nProvide results for the following parameter sets, each specified as $(\\Gamma_{\\mathrm{in}}, R_0, a, C_{\\mathrm{H}}, k_{\\mathrm{des}}, Y_{\\mathrm{H0}}, Y_{\\mathrm{M0}}, b)$:\n1. Happy path with moderate flux and moderate desorption: $\\left(5\\times 10^{21},\\,0.6,\\,0.3,\\,1\\times 10^{22},\\,0.2,\\,0.05,\\,0.01,\\,0.5\\right)$.\n2. Low-flux boundary where desorption dominates: $\\left(1\\times 10^{19},\\,0.7,\\,0.2,\\,1\\times 10^{22},\\,1.0,\\,0.05,\\,0.01,\\,0.5\\right)$.\n3. High-flux saturation tendency: $\\left(1\\times 10^{23},\\,0.5,\\,0.4,\\,1\\times 10^{22},\\,0.05,\\,0.02,\\,0.01,\\,0.5\\right)$.\n4. Strong desorption edge case: $\\left(1\\times 10^{22},\\,0.65,\\,0.25,\\,5\\times 10^{21},\\,5.0,\\,0.08,\\,0.01,\\,0.5\\right)$.\n\nYour program must return the list of $R_{\\ast}$ values for these four cases in the exact final output format specified above, with each value rounded to $6$ decimal places and dimensionless.", "solution": "The problem requires the determination of the steady-state wall recycling coefficient, $R_{\\ast}$, for hydrogen in a magnetic confinement fusion device. This is achieved by analyzing the particle balance for hydrogen trapped in the near-surface layer of a plasma-facing wall. The solution proceeds in three steps: first, deriving the ordinary differential equation (ODE) for the fractional occupancy of trap sites, $\\theta(t)$, from first principles; second, solving for the steady-state occupancy, $\\theta_{\\ast}$, by setting the time derivative to zero; and third, calculating $R_{\\ast}$ from $\\theta_{\\ast}$.\n\n**1. Derivation of the Governing Equation for Trapped Hydrogen Occupancy**\n\nThe fundamental principle is the conservation of particles. The rate of change of the areal density of trapped hydrogen, $N_{\\mathrm{H}}$ (in units of $\\mathrm{m}^{-2}$), is equal to the sum of all source rates minus the sum of all sink rates.\n\n$$\n\\frac{dN_{\\mathrm{H}}}{dt} = (\\text{Source Rate}) - (\\text{Sink Rate})\n$$\n\nThe givens from the problem statement define these rates:\n- The sole source of trapped hydrogen is the fraction of the incident flux, $\\Gamma_{\\mathrm{in}}$, that is not immediately recycled and finds an available trap site. The rate is given as $\\Gamma_{\\mathrm{in}}\\left(1 - R(\\theta)\\right)\\left(1 - \\theta\\right)$.\n- There are two sinks (removal processes) for trapped hydrogen:\n  1. Thermal de-trapping (desorption), with a rate given by $k_{\\mathrm{des}}\\,N_{\\mathrm{H}}$, where $k_{\\mathrm{des}}$ is the desorption rate constant.\n  2. Sputter removal by the incident plasma flux, with a rate given by $\\Gamma_{\\mathrm{in}}\\,Y_{\\mathrm{H}}(\\theta)$, where $Y_{\\mathrm{H}}(\\theta)$ is the hydrogen sputter yield.\n\nCombining these terms, the particle balance equation for $N_{\\mathrm{H}}$ is:\n$$\n\\frac{dN_{\\mathrm{H}}}{dt} = \\Gamma_{\\mathrm{in}}\\left(1 - R(\\theta)\\right)\\left(1 - \\theta\\right) - k_{\\mathrm{des}}\\,N_{\\mathrm{H}} - \\Gamma_{\\mathrm{in}}\\,Y_{\\mathrm{H}}(\\theta)\n$$\n\nThe problem defines the trapped hydrogen density $N_{\\mathrm{H}}$ in terms of the fractional occupancy $\\theta$ and the total trap site capacity per unit area $C_{\\mathrm{H}}$ as $N_{\\mathrm{H}} = C_{\\mathrm{H}}\\,\\theta$. Since $C_{\\mathrm{H}}$ is a constant, we can write the time derivative as $\\frac{dN_{\\mathrm{H}}}{dt} = C_{\\mathrm{H}}\\frac{d\\theta}{dt}$. Substituting this and the given expressions for $N_{\\mathrm{H}}$ and $Y_{\\mathrm{H}}(\\theta) = Y_{\\mathrm{H0}}\\,\\theta$ into the balance equation yields:\n$$\nC_{\\mathrm{H}}\\frac{d\\theta}{dt} = \\Gamma_{\\mathrm{in}}\\left(1 - R(\\theta)\\right)\\left(1 - \\theta\\right) - k_{\\mathrm{des}}\\,(C_{\\mathrm{H}}\\,\\theta) - \\Gamma_{\\mathrm{in}}\\,(Y_{\\mathrm{H0}}\\,\\theta)\n$$\n\nThis is the ODE governing the evolution of the trap site occupancy $\\theta(t)$. The recycling coefficient $R(\\theta)$ is defined as $R(\\theta) = \\min\\left(\\max\\left(R_{0} + a\\,\\theta,\\,0\\right),\\,1\\right)$ to ensure it remains within the physical bounds of $[0, 1]$.\n\n**2. Steady-State Solution**\n\nThe steady state is achieved when the system reaches equilibrium, meaning the occupancy $\\theta$ no longer changes with time. This corresponds to the condition $\\frac{d\\theta}{dt} = 0$. Let $\\theta_{\\ast}$ be the steady-state fractional occupancy. Setting the time derivative to zero in the ODE gives the steady-state balance equation:\n$$\n0 = \\Gamma_{\\mathrm{in}}\\left(1 - R(\\theta_{\\ast})\\right)\\left(1 - \\theta_{\\ast}\\right) - k_{\\mathrm{des}}\\,C_{\\mathrm{H}}\\,\\theta_{\\ast} - \\Gamma_{\\mathrm{in}}\\,Y_{\\mathrm{H0}}\\,\\theta_{\\ast}\n$$\n\nTo find $\\theta_{\\ast}$, we must solve this non-linear algebraic equation for $\\theta_{\\ast}$ in the physically valid interval $[0, 1]$. We can define a function $f(\\theta)$ whose root is the desired steady-state occupancy $\\theta_{\\ast}$:\n$$\nf(\\theta) = \\Gamma_{\\mathrm{in}}\\left(1 - R(\\theta)\\right)\\left(1 - \\theta\\right) - k_{\\mathrm{des}}\\,C_{\\mathrm{H}}\\,\\theta - \\Gamma_{\\mathrm{in}}\\,Y_{\\mathrm{H0}}\\,\\theta\n$$\n\nWe need to solve $f(\\theta_{\\ast}) = 0$.\n\n**3. Numerical Method and Final Calculation**\n\nDue to the non-linearity introduced by $R(\\theta)$ and the product terms, an analytical solution can be complex. A robust numerical root-finding algorithm is the most suitable approach. We will use a bracketing method, such as Brent's method, which is guaranteed to find a root if one exists within a specified interval $[a, b]$ and if $f(a)$ and $f(b)$ have opposite signs.\n\nLet us evaluate $f(\\theta)$ at the boundaries of the physical domain $\\theta \\in [0, 1]$:\n- At $\\theta = 0$:\n  $R(0) = \\min(\\max(R_0, 0), 1) = R_0$ (since the problem constraints imply $0 \\le R_0 < 1$).\n  $f(0) = \\Gamma_{\\mathrm{in}}(1 - R_0)(1 - 0) - 0 - 0 = \\Gamma_{\\mathrm{in}}(1 - R_0)$. Given $\\Gamma_{\\mathrm{in}} > 0$ and $R_0 < 1$, we have $f(0) > 0$.\n- At $\\theta = 1$:\n  The term $\\Gamma_{\\mathrm{in}}(1 - R(1))(1 - 1)$ is zero.\n  $f(1) = 0 - k_{\\mathrm{des}}C_{\\mathrm{H}}(1) - \\Gamma_{\\mathrm{in}}Y_{\\mathrm{H0}}(1) = -k_{\\mathrm{des}}C_{\\mathrm{H}} - \\Gamma_{\\mathrm{in}}Y_{\\mathrm{H0}}$. Given that all parameters are non-negative, $f(1) \\le 0$.\n\nSince $f(\\theta)$ is a continuous function on $[0, 1]$ with $f(0) > 0$ and $f(1) \\le 0$, the Intermediate Value Theorem guarantees the existence of at least one root $\\theta_{\\ast} \\in [0, 1]$. Furthermore, the trapping term (first term of $f(\\theta)$) is a non-increasing function of $\\theta$, while the removal terms (second and third terms) are non-decreasing functions of $\\theta$. Therefore, $f(\\theta)$ is a monotonically decreasing function, ensuring the root $\\theta_{\\ast}$ is unique. This makes Brent's method on the interval $[0, 1]$ a robust and ideal choice for finding $\\theta_{\\ast}$.\n\nOnce the numerical solver finds $\\theta_{\\ast}$, the steady-state recycling coefficient $R_{\\ast}$ is computed using its definition:\n$$\nR_{\\ast} = R(\\theta_{\\ast}) = \\min\\left(\\max\\left(R_{0} + a\\,\\theta_{\\ast},\\,0\\right),\\,1\\right)\n$$\n\nThe implementation will apply this procedure to each test case provided. It will define the function $f(\\theta)$, use `scipy.optimize.brentq` to find its root $\\theta_{\\ast}$ in $[0, 1]$, and then calculate the corresponding $R_{\\ast}$. The final results are rounded to $6$ decimal places.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import brentq\n\ndef solve():\n    \"\"\"\n    Solves for the steady-state recycling coefficient for a series of test cases\n    based on a particle balance model for trapped hydrogen in a plasma-facing wall.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    # Each tuple contains: (Gamma_in, R0, a, C_H, k_des, Y_H0, Y_M0, b)\n    test_cases = [\n        (5e21, 0.6, 0.3, 1e22, 0.2, 0.05, 0.01, 0.5),\n        (1e19, 0.7, 0.2, 1e22, 1.0, 0.05, 0.01, 0.5),\n        (1e23, 0.5, 0.4, 1e22, 0.05, 0.02, 0.01, 0.5),\n        (1e22, 0.65, 0.25, 5e21, 5.0, 0.08, 0.01, 0.5)\n    ]\n\n    results = []\n\n    for case in test_cases:\n        Gamma_in, R0, a, C_H, k_des, Y_H0, Y_M0, b = case\n\n        def steady_state_balance_func(theta, G_in, R_0, a_param, C_H_cap, k_d, Y_H_0):\n            \"\"\"\n            This function represents the steady-state particle balance equation, f(theta) = 0.\n            The root of this function is the steady-state occupancy theta_star.\n            f(theta) = (trapping rate) - (desorption rate) - (sputtering rate)\n            \"\"\"\n            # Calculate the recycling coefficient R(theta), ensuring it stays within [0, 1].\n            R_theta = min(max(R_0 + a_param * theta, 0.0), 1.0)\n            \n            # Source term: Rate of trapping into available sites\n            source_trapping = G_in * (1.0 - R_theta) * (1.0 - theta)\n            \n            # Sink term 1: Rate of thermal de-trapping (desorption)\n            sink_desorption = C_H_cap * k_d * theta\n            \n            # Sink term 2: Rate of sputter removal of trapped hydrogen\n            # The hydrogen sputter yield is Y_H(theta) = Y_H0 * theta.\n            sink_sputtering = G_in * Y_H_0 * theta\n            \n            return source_trapping - sink_desorption - sink_sputtering\n\n        # The physical domain for theta is [0, 1].\n        # We solve for theta_star in this interval.\n        # As derived in the solution, f(0) >= 0 and f(1) <= 0,\n        # so a root is guaranteed in [0, 1].\n        \n        # Check if the root is at the boundaries to handle edge cases gracefully,\n        # although brentq would typically handle them.\n        f_at_0 = steady_state_balance_func(0.0, Gamma_in, R0, a, C_H, k_des, Y_H0)\n        if np.isclose(f_at_0, 0.0):\n            theta_star = 0.0\n        else:\n            f_at_1 = steady_state_balance_func(1.0, Gamma_in, R0, a, C_H, k_des, Y_H0)\n            if np.isclose(f_at_1, 0.0):\n                theta_star = 1.0\n            else:\n                # Use Brent's method for robust root finding.\n                theta_star = brentq(\n                    steady_state_balance_func, \n                    0.0, \n                    1.0, \n                    args=(Gamma_in, R0, a, C_H, k_des, Y_H0)\n                )\n\n        # Calculate the final steady-state recycling coefficient R_star\n        R_star = min(max(R0 + a * theta_star, 0.0), 1.0)\n        \n        results.append(round(R_star, 6))\n\n    # Final print statement in the exact required format.\n    # The format is a string representation of a list of floats.\n    print(f\"[{','.join(f'{r:.6f}' for r in results)}]\")\n\nsolve()\n```", "id": "3725459"}]}