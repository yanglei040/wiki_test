{"hands_on_practices": [{"introduction": "A deep understanding of any distribution function begins with its mathematical properties. This first exercise provides a guided walkthrough of the fundamental calculations needed to properly normalize the Maxwell-Boltzmann distribution, ensuring it represents a valid probability density. You will then use this normalized form to derive some of its most important moments, which are directly related to macroscopic physical properties like the average particle speed [@problem_id:3725147]. Mastering these Gaussian integrals is a core skill for any physicist working with statistical mechanics.", "problem": "Consider a nonrelativistic, fully ionized, single-ion-species fusion plasma in thermodynamic equilibrium at temperature $T$. The ions have mass $m_i$ and number density $n$, and their one-particle velocity distribution is isotropic. In the canonical ensemble, the probability density in velocity space is proportional to the Boltzmann factor built from the kinetic energy $\\varepsilon(\\mathbf{v}) = \\tfrac{1}{2} m_i v^2$, where $v = |\\mathbf{v}|$. Thus, the velocity-space distribution can be written in the form $f(\\mathbf{v}) = A \\exp(-\\alpha v^2)$ with constants $A$ and $\\alpha$ determined by $m_i$ and $T$ via first principles.\n\nTasks:\n1. Starting from the one-dimensional Gaussian integral and first principles, evaluate the three-dimensional integral $I(\\alpha) = \\int_{\\mathbb{R}^3} \\exp(-\\alpha v^2) \\, d^3\\!v$ for $\\alpha > 0$.\n2. Using the canonical Boltzmann factor and the result of part 1, determine $\\alpha$ and the normalization factor $A$ by imposing $\\int_{\\mathbb{R}^3} f(\\mathbf{v}) \\, d^3\\!v = n$. Explicitly verify that this normalization holds.\n3. With the properly normalized $f(\\mathbf{v})$, compute the moments $\\langle v \\rangle$ and $\\langle v^3 \\rangle$, defined by $\\langle v^p \\rangle = \\frac{1}{n} \\int_{\\mathbb{R}^3} v^p f(\\mathbf{v}) \\, d^3\\!v$ for $p=1$ and $p=3$. Then, form the ratio $R = \\langle v^3 \\rangle / \\langle v \\rangle$ and simplify it to a closed-form expression in terms of $k_B$, $T$, and $m_i$, where $k_B$ is the Boltzmann constant.\n\nExpress the final answer for $R$ as a single closed-form analytic expression. No numerical substitution or rounding is required.", "solution": "The problem statement is first validated to ensure it is scientifically grounded, well-posed, and objective.\n\n### Step 1: Extract Givens\n-   Plasma conditions: nonrelativistic, fully ionized, single-ion-species, in thermodynamic equilibrium.\n-   Temperature: $T$.\n-   Ion properties: mass $m_i$, number density $n$.\n-   Velocity distribution: $f(\\mathbf{v})$ is isotropic.\n-   Ensemble: canonical.\n-   Kinetic energy: $\\varepsilon(\\mathbf{v}) = \\frac{1}{2} m_i v^2$, where $v = |\\mathbf{v}|$.\n-   Form of the velocity distribution: $f(\\mathbf{v}) = A \\exp(-\\alpha v^2)$.\n-   Task $1$: Evaluate $I(\\alpha) = \\int_{\\mathbb{R}^3} \\exp(-\\alpha v^2) \\, d^3\\!v$ for $\\alpha > 0$.\n-   Task $2$: Determine $\\alpha$ and $A$ using the Boltzmann factor and the normalization condition $\\int_{\\mathbb{R}^3} f(\\mathbf{v}) \\, d^3\\!v = n$.\n-   Task $3$: Compute the moments $\\langle v \\rangle$ and $\\langle v^3 \\rangle$ as defined by $\\langle v^p \\rangle = \\frac{1}{n} \\int_{\\mathbb{R}^3} v^p f(\\mathbf{v}) \\, d^3\\!v$ and find the ratio $R = \\langle v^3 \\rangle / \\langle v \\rangle$.\n\n### Step 2: Validate Using Extracted Givens\n-   **Scientifically Grounded**: The problem describes the Maxwell-Boltzmann distribution for a classical gas of ions, which is a fundamental concept in statistical mechanics and plasma physics. All premises are based on established scientific principles. The problem is scientifically sound.\n-   **Well-Posed**: The problem is structured as a sequence of well-defined mathematical tasks. The given information, combined with first principles of statistical mechanics, is sufficient to determine a unique solution for the requested ratio $R$.\n-   **Objective**: The problem is stated in precise, quantitative, and unbiased language. It is free of any subjective or opinion-based claims.\n-   **Completeness and Consistency**: The problem provides all necessary information and definitions. It is internally consistent and does not contain contradictory constraints.\n-   **Realism and Feasibility**: The physical model of a thermalized, classical plasma is a standard and realistic approximation used in fusion research and astrophysics. The calculations are feasible.\n-   **Other Flaws**: The problem is not trivial, pseudo-profound, ill-structured, or unverifiable.\n\n### Step 3: Verdict and Action\nThe problem is **valid**. A full solution will be provided.\n\n### Solution Derivation\n\nThe problem is solved by executing the three tasks in sequence.\n\n**Task 1: Evaluation of the 3D Gaussian Integral**\n\nWe are asked to evaluate the integral $I(\\alpha) = \\int_{\\mathbb{R}^3} \\exp(-\\alpha v^2) \\, d^3\\!v$.\nIn Cartesian coordinates, the velocity vector is $\\mathbf{v} = (v_x, v_y, v_z)$, its squared magnitude is $v^2 = v_x^2 + v_y^2 + v_z^2$, and the volume element is $d^3\\!v = dv_x dv_y dv_z$. The integral can be separated into a product of three identical one-dimensional integrals:\n$$I(\\alpha) = \\int_{-\\infty}^{\\infty} \\int_{-\\infty}^{\\infty} \\int_{-\\infty}^{\\infty} \\exp(-\\alpha(v_x^2 + v_y^2 + v_z^2)) \\, dv_x dv_y dv_z$$\n$$I(\\alpha) = \\left( \\int_{-\\infty}^{\\infty} \\exp(-\\alpha u^2) \\, du \\right)^3$$\nTo evaluate the one-dimensional integral, we use the standard Gaussian integral result $\\int_{-\\infty}^{\\infty} \\exp(-x^2) \\, dx = \\sqrt{\\pi}$. Let $x = \\sqrt{\\alpha} u$, so $dx = \\sqrt{\\alpha} \\, du$, or $du = dx/\\sqrt{\\alpha}$. The limits of integration remain unchanged.\n$$\\int_{-\\infty}^{\\infty} \\exp(-\\alpha u^2) \\, du = \\int_{-\\infty}^{\\infty} \\exp(-x^2) \\, \\frac{dx}{\\sqrt{\\alpha}} = \\frac{1}{\\sqrt{\\alpha}} \\int_{-\\infty}^{\\infty} \\exp(-x^2) \\, dx = \\sqrt{\\frac{\\pi}{\\alpha}}$$\nSubstituting this back into the expression for $I(\\alpha)$:\n$$I(\\alpha) = \\left( \\sqrt{\\frac{\\pi}{\\alpha}} \\right)^3 = \\left(\\frac{\\pi}{\\alpha}\\right)^{3/2}$$\n\n**Task 2: Determination of $\\alpha$ and $A$**\n\nThe probability density for a particle in a canonical ensemble at temperature $T$ is proportional to the Boltzmann factor, $\\exp(-\\varepsilon / (k_B T))$, where $\\varepsilon$ is the particle's energy and $k_B$ is the Boltzmann constant. For an ion with kinetic energy $\\varepsilon(\\mathbf{v}) = \\frac{1}{2} m_i v^2$, the factor is $\\exp\\left(-\\frac{m_i v^2}{2 k_B T}\\right)$.\nThe problem states the velocity distribution has the form $f(\\mathbf{v}) = A \\exp(-\\alpha v^2)$. By comparing the exponents, we directly identify the parameter $\\alpha$:\n$$\\alpha = \\frac{m_i}{2 k_B T}$$\nNext, we determine the normalization constant $A$ using the condition that the integral of the distribution function over all velocity space yields the total number density $n$:\n$$\\int_{\\mathbb{R}^3} f(\\mathbf{v}) \\, d^3\\!v = n$$\nSubstituting the form of $f(\\mathbf{v})$:\n$$\\int_{\\mathbb{R}^3} A \\exp(-\\alpha v^2) \\, d^3\\!v = A \\int_{\\mathbb{R}^3} \\exp(-\\alpha v^2) \\, d^3\\!v = n$$\nThe integral is precisely $I(\\alpha)$ which we found in Task $1$.\n$$A \\cdot I(\\alpha) = A \\left(\\frac{\\pi}{\\alpha}\\right)^{3/2} = n$$\nSolving for $A$:\n$$A = n \\left(\\frac{\\alpha}{\\pi}\\right)^{3/2}$$\nSubstituting the expression for $\\alpha$:\n$$A = n \\left(\\frac{m_i}{2 \\pi k_B T}\\right)^{3/2}$$\nThe fully specified velocity distribution function, known as the Maxwell-Boltzmann distribution, is:\n$$f(\\mathbf{v}) = n \\left(\\frac{m_i}{2 \\pi k_B T}\\right)^{3/2} \\exp\\left(-\\frac{m_i v^2}{2 k_B T}\\right)$$\nThe normalization is verified by construction: $\\int f(\\mathbf{v}) d^3v = A \\cdot I(\\alpha) = n (\\alpha/\\pi)^{3/2} \\cdot (\\pi/\\alpha)^{3/2} = n$.\n\n**Task 3: Computation of Moments and a Ratio $R$**\n\nWe need to compute the moments $\\langle v \\rangle$ and $\\langle v^3 \\rangle$ using the definition $\\langle v^p \\rangle = \\frac{1}{n} \\int_{\\mathbb{R}^3} v^p f(\\mathbf{v}) \\, d^3\\!v$.\nSubstituting the normalized distribution function:\n$$\\langle v^p \\rangle = \\frac{1}{n} \\int_{\\mathbb{R}^3} v^p \\left( n \\left(\\frac{\\alpha}{\\pi}\\right)^{3/2} \\exp(-\\alpha v^2) \\right) \\, d^3\\!v = \\left(\\frac{\\alpha}{\\pi}\\right)^{3/2} \\int_{\\mathbb{R}^3} v^p \\exp(-\\alpha v^2) \\, d^3\\!v$$\nSince the integrand depends only on the speed $v = |\\mathbf{v}|$, it is advantageous to switch to spherical coordinates in velocity space. The volume element becomes $d^3\\!v = v^2 \\sin\\theta \\, dv \\, d\\theta \\, d\\phi$. The integration over the angles $\\theta$ and $\\phi$ yields a factor of $4\\pi$.\n$$\\int_{\\mathbb{R}^3} v^p \\exp(-\\alpha v^2) \\, d^3\\!v = \\int_0^{2\\pi} d\\phi \\int_0^{\\pi} \\sin\\theta \\, d\\theta \\int_0^{\\infty} v^p \\exp(-\\alpha v^2) v^2 \\, dv = 4\\pi \\int_0^{\\infty} v^{p+2} \\exp(-\\alpha v^2) \\, dv$$\nSo the moment is:\n$$\\langle v^p \\rangle = \\left(\\frac{\\alpha}{\\pi}\\right)^{3/2} 4\\pi \\int_0^{\\infty} v^{p+2} \\exp(-\\alpha v^2) \\, dv = 4\\pi \\frac{\\alpha^{3/2}}{\\pi^{3/2}} \\int_0^{\\infty} v^{p+2} \\exp(-\\alpha v^2) \\, dv = \\frac{4\\alpha^{3/2}}{\\sqrt{\\pi}} \\int_0^{\\infty} v^{p+2} \\exp(-\\alpha v^2) \\, dv$$\nWe evaluate this for $p=1$ and $p=3$. We use the standard integral formula $\\int_0^\\infty x^k \\exp(-ax^2)dx$, which can be related to the Gamma function.\nFor $\\langle v \\rangle$, we have $p=1$, so we need the integral with $v^{1+2}=v^3$:\n$$\\int_0^{\\infty} v^3 \\exp(-\\alpha v^2) \\, dv$$\nLet $x = \\alpha v^2$, so $v^2 = x/\\alpha$ and $2\\alpha v \\, dv = dx$, or $dv = dx / (2\\alpha v)$. Then $v^3 dv = v^2(v dv) = (x/\\alpha) (dx/(2\\alpha)) = x/(2\\alpha^2) dx$.\n$$\\int_0^{\\infty} \\frac{x}{2\\alpha^2} \\exp(-x) \\, dx = \\frac{1}{2\\alpha^2} \\int_0^{\\infty} x \\exp(-x) \\, dx = \\frac{\\Gamma(2)}{2\\alpha^2} = \\frac{1!}{2\\alpha^2} = \\frac{1}{2\\alpha^2}$$\nThus,\n$$\\langle v \\rangle = \\frac{4\\alpha^{3/2}}{\\sqrt{\\pi}} \\left(\\frac{1}{2\\alpha^2}\\right) = \\frac{2}{\\sqrt{\\pi}} \\alpha^{-1/2} = \\frac{2}{\\sqrt{\\pi}} \\left(\\frac{m_i}{2 k_B T}\\right)^{-1/2} = \\sqrt{\\frac{8 k_B T}{\\pi m_i}}$$\nFor $\\langle v^3 \\rangle$, we have $p=3$, so we need the integral with $v^{3+2}=v^5$:\n$$\\int_0^{\\infty} v^5 \\exp(-\\alpha v^2) \\, dv$$\nUsing the same substitution, $v^5 dv = v^4 (v dv) = (x/\\alpha)^2 (dx/(2\\alpha)) = x^2/(2\\alpha^3) dx$.\n$$\\int_0^{\\infty} \\frac{x^2}{2\\alpha^3} \\exp(-x) \\, dx = \\frac{1}{2\\alpha^3} \\int_0^{\\infty} x^2 \\exp(-x) \\, dx = \\frac{\\Gamma(3)}{2\\alpha^3} = \\frac{2!}{2\\alpha^3} = \\frac{1}{\\alpha^3}$$\nThus,\n$$\\langle v^3 \\rangle = \\frac{4\\alpha^{3/2}}{\\sqrt{\\pi}} \\left(\\frac{1}{\\alpha^3}\\right) = \\frac{4}{\\sqrt{\\pi}} \\alpha^{-3/2}$$\nNow we form the ratio $R = \\langle v^3 \\rangle / \\langle v \\rangle$:\n$$R = \\frac{\\langle v^3 \\rangle}{\\langle v \\rangle} = \\frac{\\frac{4}{\\sqrt{\\pi}} \\alpha^{-3/2}}{\\frac{2}{\\sqrt{\\pi}} \\alpha^{-1/2}}$$\nThe factors of $\\sqrt{\\pi}$ cancel.\n$$R = \\frac{4}{2} \\frac{\\alpha^{-3/2}}{\\alpha^{-1/2}} = 2 \\alpha^{-3/2 - (-1/2)} = 2 \\alpha^{-1}$$\nThis is a remarkably simple expression. Finally, we substitute the definition of $\\alpha$:\n$$R = 2 \\left(\\frac{m_i}{2 k_B T}\\right)^{-1} = 2 \\left(\\frac{2 k_B T}{m_i}\\right) = \\frac{4 k_B T}{m_i}$$\nThis expression gives the ratio in terms of the fundamental constants and parameters as required.", "answer": "$$\\boxed{\\frac{4 k_B T}{m_i}}$$", "id": "3725147"}, {"introduction": "While the Maxwell-Boltzmann distribution is a cornerstone of kinetic theory, it is fundamentally a classical approximation that is valid only when quantum mechanical effects are negligible. This practice explores the boundary between the classical and quantum regimes by having you derive and calculate the thermal de Broglie wavelength, $\\lambda_{\\mathrm{th}}$. By evaluating the degeneracy parameter $g \\equiv n \\lambda_{\\mathrm{th}}^{3}$ for a realistic fusion plasma, you will perform a concrete check on whether the ions can be treated as distinct classical particles or if their wave-like nature must be considered [@problem_id:3725143].", "problem": "In a fully ionized deuterium–tritium plasma typical of magnetic-confinement fusion, determine whether the ion populations can be described by Maxwell–Boltzmann (MB) statistics by deriving and evaluating the appropriate quantum-classical crossover parameter. Start from the classical translational partition function for a single nonrelativistic particle of mass $m$ at temperature $T$, constructed by integrating the Boltzmann factor over momentum space with quantum phase-space cells of volume $h^{3}$, where $h$ is Planck’s constant. Define the thermal de Broglie wavelength $\\lambda_{\\mathrm{th}}$ so that the one-particle partition function takes the form $Z_{1}=V/\\lambda_{\\mathrm{th}}^{3}$, and use this to obtain the classicality criterion in terms of the number density $n$.\n\nThen, for singly charged deuterium and tritium ions at temperature $T=10\\ \\mathrm{keV}$, compute $\\lambda_{\\mathrm{th}}$ for each ion species using the ion rest masses given below, and evaluate the degeneracy parameter $g \\equiv n\\,\\lambda_{\\mathrm{th}}^{3}$ at a representative core plasma density $n=1.0\\times 10^{20}\\ \\mathrm{m}^{-3}$. Based on your derivation, explain why $g \\ll 1$ implies the validity of MB statistics for the ions. Use the following constants:\n- Planck’s constant $h=6.62607015\\times 10^{-34}\\ \\mathrm{J\\cdot s}$,\n- Elementary charge $e=1.602176634\\times 10^{-19}\\ \\mathrm{C}$ (so that $1\\ \\mathrm{eV}=e\\ \\mathrm{J}$),\n- Deuteron mass $m_{\\mathrm{D}}=3.343583719\\times 10^{-27}\\ \\mathrm{kg}$,\n- Triton mass $m_{\\mathrm{T}}=5.0073567446\\times 10^{-27}\\ \\mathrm{kg}$.\n\nTreat ions as nonrelativistic and neglect quantum statistics of electrons. Express intermediate wavelengths in meters. For the final reported result, provide the numerical value of the larger of the two ion degeneracy parameters $g=n\\,\\lambda_{\\mathrm{th}}^{3}$ (i.e., for the ion species with the larger $\\lambda_{\\mathrm{th}}$). Round this final reported value to four significant figures and express it as a pure number (dimensionless).", "solution": "The problem is first validated against the required criteria.\n\n### Step 1: Extract Givens\n- **Plasma Composition**: Fully ionized deuterium–tritium plasma.\n- **Physical Context**: Magnetic-confinement fusion.\n- **Task**: Determine if ion populations can be described by Maxwell–Boltzmann (MB) statistics.\n- **Methodology**: Derive and evaluate a quantum-classical crossover parameter.\n- **Starting Point**: The classical translational partition function for a single nonrelativistic particle of mass $m$ at temperature $T$, constructed by integrating the Boltzmann factor over momentum space with quantum phase-space cells of volume $h^{3}$.\n- **Definition 1**: Thermal de Broglie wavelength $\\lambda_{\\mathrm{th}}$ is defined such that the one-particle partition function has the form $Z_{1}=V/\\lambda_{\\mathrm{th}}^{3}$.\n- **Objective 1**: Obtain the classicality criterion in terms of the number density $n$.\n- **Calculation Parameters**:\n  - Ion species: Singly charged deuterium and tritium.\n  - Temperature: $T=10\\ \\mathrm{keV}$.\n  - Number density: $n=1.0\\times 10^{20}\\ \\mathrm{m}^{-3}$.\n- **Definition 2**: Degeneracy parameter $g \\equiv n\\,\\lambda_{\\mathrm{th}}^{3}$.\n- **Objective 2**: Compute $\\lambda_{\\mathrm{th}}$ for each ion species.\n- **Objective 3**: Evaluate the degeneracy parameter $g$ at the given density $n$.\n- **Objective 4**: Explain why $g \\ll 1$ implies the validity of MB statistics.\n- **Constants**:\n  - Planck’s constant: $h=6.62607015\\times 10^{-34}\\ \\mathrm{J\\cdot s}$.\n  - Elementary charge: $e=1.602176634\\times 10^{-19}\\ \\mathrm{C}$.\n  - Deuteron mass: $m_{\\mathrm{D}}=3.343583719\\times 10^{-27}\\ \\mathrm{kg}$.\n  - Triton mass: $m_{\\mathrm{T}}=5.0073567446\\times 10^{-27}\\ \\mathrm{kg}$.\n- **Assumptions**: Ions are nonrelativistic; neglect quantum statistics of electrons.\n- **Final Result Specification**: Provide the numerical value of the larger of the two ion degeneracy parameters, rounded to four significant figures.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientific Grounding**: The problem is well-grounded in standard statistical mechanics and plasma physics. The concepts of the partition function, thermal de Broglie wavelength, and the degeneracy parameter are fundamental tools for assessing quantum effects in a many-body system. The physical context (fusion plasma) and the provided parameters ($T$, $n$, ion masses) are realistic.\n- **Well-Posedness**: The problem is well-posed. It provides all necessary information, definitions, and constants to perform the required derivation and calculations. The objectives are clear, and the path to the solution is logically structured. A unique, meaningful solution exists.\n- **Objectivity**: The problem is stated in precise, objective, and scientific language, free of any subjective or ambiguous terms.\n- **Completeness and Consistency**: The problem is self-contained. The provided constants and parameters are sufficient. The anachronistic but common practice in plasma physics of specifying temperature in units of energy (electronvolts) is implicitly defined via the elementary charge $e$, where the thermal energy is $k_B T = 10\\ \\mathrm{keV}$. This is a standard convention and does not render the problem incomplete. There are no internal contradictions.\n\n### Step 3: Verdict and Action\nThe problem is **valid** as it is scientifically sound, well-posed, and complete. We may proceed to the solution.\n\n### Derivation of the Classicality Criterion\nThe classical translational partition function, $Z_1$, for a single nonrelativistic particle of mass $m$ in a volume $V$ at temperature $T$ is given by the integral over all possible positions and momenta. To account for the quantization of phase space, this integral is divided by $h^3$, where $h$ is Planck's constant.\nThe energy of a nonrelativistic particle is purely kinetic, $E=p^{2}/(2m)$. The partition function is:\n$$ Z_1 = \\frac{1}{h^3} \\int \\exp\\left(-\\frac{E}{k_B T}\\right) d^3x d^3p = \\frac{1}{h^3} \\int d^3x \\int d^3p \\, \\exp\\left(-\\frac{p^2}{2mk_B T}\\right) $$\nThe integral over the spatial coordinates $d^3x$ yields the volume $V$.\n$$ Z_1 = \\frac{V}{h^3} \\int_{-\\infty}^{\\infty} \\int_{-\\infty}^{\\infty} \\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{p_x^2 + p_y^2 + p_z^2}{2mk_B T}\\right) dp_x dp_y dp_z $$\nThis is a product of three identical Gaussian integrals of the form $\\int_{-\\infty}^{\\infty} \\exp(-ax^2) dx = \\sqrt{\\pi/a}$. With $a = 1/(2mk_B T)$, each integral yields $\\sqrt{2\\pi mk_B T}$.\n$$ Z_1 = \\frac{V}{h^3} \\left(\\sqrt{2\\pi mk_B T}\\right)^3 = \\frac{V}{h^3} (2\\pi mk_B T)^{3/2} $$\nThe problem defines the thermal de Broglie wavelength, $\\lambda_{\\mathrm{th}}$, via the relation $Z_1 = V/\\lambda_{\\mathrm{th}}^3$. Equating the two expressions for $Z_1$:\n$$ \\frac{V}{\\lambda_{\\mathrm{th}}^3} = \\frac{V (2\\pi mk_B T)^{3/2}}{h^3} $$\nSolving for $\\lambda_{\\mathrm{th}}$ gives:\n$$ \\lambda_{\\mathrm{th}} = \\frac{h}{\\sqrt{2\\pi mk_B T}} $$\nThis wavelength, $\\lambda_{\\mathrm{th}}$, represents the characteristic de Broglie wavelength of a particle in a thermal ensemble at temperature $T$.\n\nMaxwell-Boltzmann statistics are applicable when the quantum nature of particles can be ignored. This occurs when the particles are, on average, far enough apart that their quantum wave packets do not significantly overlap. The average volume per particle in a system with number density $n$ is $1/n$. The characteristic interparticle separation distance is thus $d \\sim n^{-1/3}$. Quantum effects become non-negligible when $\\lambda_{\\mathrm{th}}$ becomes comparable to or larger than $d$. Therefore, the classical (non-quantum) regime, where MB statistics are valid, corresponds to the condition:\n$$ \\lambda_{\\mathrm{th}} \\ll n^{-1/3} $$\nCubing both sides gives $\\lambda_{\\mathrm{th}}^3 \\ll 1/n$, which can be rearranged to define the classicality criterion:\n$$ n \\lambda_{\\mathrm{th}}^3 \\ll 1 $$\nThe quantity $g \\equiv n \\lambda_{\\mathrm{th}}^3$ is the degeneracy parameter. The condition $g \\ll 1$ signifies that the system is non-degenerate or \"classical,\" and thus its constituent particles can be described by Maxwell-Boltzmann statistics.\n\n### Numerical Evaluation for Deuterium-Tritium Plasma\nFirst, we convert the given temperature into thermal energy in SI units.\n$$ k_B T = 10\\ \\mathrm{keV} = 10 \\times 10^3 \\ \\mathrm{eV} = 10^4 \\times (1.602176634\\times 10^{-19}\\ \\mathrm{J}) = 1.602176634\\times 10^{-15}\\ \\mathrm{J} $$\nNow we compute the thermal de Broglie wavelength for both deuteron and triton ions using the formula $\\lambda_{\\mathrm{th}} = h/\\sqrt{2\\pi m k_B T}$.\n\nFor a deuteron ($D^{+}$):\n$m_{\\mathrm{D}}=3.343583719\\times 10^{-27}\\ \\mathrm{kg}$.\n$$ \\lambda_{\\mathrm{th, D}} = \\frac{6.62607015\\times 10^{-34}\\ \\mathrm{J\\cdot s}}{\\sqrt{2\\pi (3.343583719\\times 10^{-27}\\ \\mathrm{kg})(1.602176634\\times 10^{-15}\\ \\mathrm{J})}} $$\n$$ \\lambda_{\\mathrm{th, D}} = \\frac{6.62607015\\times 10^{-34}}{\\sqrt{3.3644919 \\times 10^{-41}}} \\ \\mathrm{m} = \\frac{6.62607015\\times 10^{-34}}{5.8004240\\times 10^{-21}}\\ \\mathrm{m} $$\n$$ \\lambda_{\\mathrm{th, D}} \\approx 1.1423447\\times 10^{-13}\\ \\mathrm{m} $$\n\nFor a triton ($T^{+}$):\n$m_{\\mathrm{T}}=5.0073567446\\times 10^{-27}\\ \\mathrm{kg}$.\n$$ \\lambda_{\\mathrm{th, T}} = \\frac{6.62607015\\times 10^{-34}\\ \\mathrm{J\\cdot s}}{\\sqrt{2\\pi (5.0073567446\\times 10^{-27}\\ \\mathrm{kg})(1.602176634\\times 10^{-15}\\ \\mathrm{J})}} $$\n$$ \\lambda_{\\mathrm{th, T}} = \\frac{6.62607015\\times 10^{-34}}{\\sqrt{5.0388610 \\times 10^{-41}}} \\ \\mathrm{m} = \\frac{6.62607015\\times 10^{-34}}{7.1009584\\times 10^{-21}}\\ \\mathrm{m} $$\n$$ \\lambda_{\\mathrm{th, T}} \\approx 9.331323\\times 10^{-14}\\ \\mathrm{m} $$\n\nThe problem asks for the larger of the two ion degeneracy parameters. Since $g = n \\lambda_{\\mathrm{th}}^3$ and $\\lambda_{\\mathrm{th}} \\propto m^{-1/2}$, the lighter particle (the deuteron) will have the larger $\\lambda_{\\mathrm{th}}$ and consequently the larger degeneracy parameter $g$.\n\nWe calculate $g_{\\mathrm{D}}$ for the deuteron using $n=1.0\\times 10^{20}\\ \\mathrm{m}^{-3}$.\n$$ g_{\\mathrm{D}} = n \\lambda_{\\mathrm{th, D}}^3 = (1.0\\times 10^{20}\\ \\mathrm{m}^{-3}) \\times (1.1423447\\times 10^{-13}\\ \\mathrm{m})^3 $$\n$$ g_{\\mathrm{D}} = (1.0\\times 10^{20}) \\times (1.490793 \\times 10^{-39})\\ \\mathrm{m^3 \\cdot m^{-3}} $$\n$$ g_{\\mathrm{D}} \\approx 1.490793 \\times 10^{-19} $$\nThe value of $g_{\\mathrm{D}}$ is extremely small, $g_{\\mathrm{D}} \\ll 1$. This confirms that the classicality condition is overwhelmingly satisfied. Therefore, the deuterium and tritium ion populations in the fusion plasma can be accurately described by Maxwell-Boltzmann statistics.\n\nRounding the result to four significant figures gives $1.491 \\times 10^{-19}$.", "answer": "$$\n\\boxed{1.491 \\times 10^{-19}}\n$$", "id": "3725143"}, {"introduction": "This final practice bridges the gap between abstract theory and modern computational methods. Many powerful simulation techniques, such as the Particle-In-Cell (PIC) method, rely on correctly initializing millions of simulated particles according to a given velocity distribution. This exercise [@problem_id:3725144] provides hands-on experience in designing a Monte Carlo algorithm to generate a population of particles with a drifting Maxwellian velocity distribution, and then verifying the statistical properties of your sample against analytical theory. This is a critical and practical skill for anyone involved in computational plasma physics.", "problem": "Design and implement a complete Monte Carlo (MC) algorithm to sample three-dimensional particle velocities from a thermal equilibrium (Maxwell-Boltzmann) distribution for use in Particle-In-Cell (PIC) simulations, and verify that the sampled statistical moments agree with the analytically derived values from the canonical ensemble. The setting is nuclear fusion plasmas and must be expressed in the Standard International (SI) unit system.\n\nBegin from the following foundations and core definitions only, without presupposing or citing any final target formulas:\n- The canonical ensemble with Hamiltonian $H = \\sum_{i=1}^{3} \\dfrac{p_i^2}{2 m}$ for a single particle of mass $m$, where $p_i$ are the momentum components.\n- The Boltzmann factor for the canonical ensemble, $\\exp\\!\\left(- H / (k_{\\mathrm{B}} T)\\right)$, where $k_{\\mathrm{B}}$ is the Boltzmann constant and $T$ is the absolute temperature.\n- The definition of velocity as $v_i = p_i / m$, and Galilean shift by a uniform drift velocity $\\boldsymbol{u}$ to model a drifting equilibrium.\n- The definition of number density $n$ and kinetic energy density $\\mathcal{E} = \\dfrac{1}{2} m n \\,\\mathbb{E}\\!\\left[\\lVert \\boldsymbol{v} \\rVert^2\\right]$.\n- The Gaussian limit theorem as justification for generating normal random variates.\n- The statistical definitions of sample mean, unbiased sample variance, and the standard error of the mean.\n\nYour tasks are:\n1. From the canonical-ensemble base, derive the sampling distribution for the three Cartesian velocity components of a particle in thermal equilibrium at temperature $T$ with uniform drift $\\boldsymbol{u}$, and specify an algorithm to generate MC samples of $\\boldsymbol{v} \\in \\mathbb{R}^3$. Your algorithm must be implementable using independent standard normal variates and affine transformations only. Express all symbolic results using $m$, $T$, $k_{\\mathrm{B}}$, and $\\boldsymbol{u}$.\n2. Derive analytic expressions, in closed form, for the following equilibrium moments in terms of $m$, $T$, $k_{\\mathrm{B}}$, and $\\boldsymbol{u}$:\n   - The mean velocity vector $\\mathbb{E}[\\boldsymbol{v}]$.\n   - The per-component variance $\\mathrm{Var}(v_i)$.\n   - The mean squared speed $\\mathbb{E}\\!\\left[\\lVert \\boldsymbol{v} \\rVert^2\\right]$.\n   - The variance of the squared speed, $\\mathrm{Var}\\!\\left(\\lVert \\boldsymbol{v} \\rVert^2\\right)$, needed to quantify the sampling uncertainty of the Monte Carlo estimator of $\\mathbb{E}\\!\\left[\\lVert \\boldsymbol{v} \\rVert^2\\right]$.\n   - The kinetic energy density $\\mathcal{E}$.\n3. Implement a program that:\n   - Generates $N$ independent and identically distributed samples $\\{\\boldsymbol{v}^{(j)}\\}_{j=1}^N$ from the derived distribution for each test case below, using a pseudorandom number generator with a fixed seed to ensure reproducibility.\n   - Computes the empirical mean vector $\\widehat{\\boldsymbol{v}} = \\dfrac{1}{N} \\sum_{j=1}^N \\boldsymbol{v}^{(j)}$.\n   - Computes the unbiased per-component sample variance $\\widehat{\\sigma}_i^2 = \\dfrac{1}{N-1} \\sum_{j=1}^N \\left(v_i^{(j)} - \\widehat{v}_i\\right)^2$ for $i \\in \\{x,y,z\\}$.\n   - Computes the empirical mean squared speed $\\widehat{S}_2 = \\dfrac{1}{N} \\sum_{j=1}^N \\lVert \\boldsymbol{v}^{(j)} \\rVert^2$.\n   - Computes the empirical kinetic energy density $\\widehat{\\mathcal{E}} = \\dfrac{1}{2} m n \\widehat{S}_2$.\n   - Quantifies agreement using standardized discrepancies (z-scores) based on the sampling distributions you derive:\n     - For each component $i$, test $\\left|\\widehat{v}_i - u_i\\right| \\leq z_{\\star} \\sqrt{\\mathrm{Var}(v_i)/N}$.\n     - For each component $i$, test $\\left|\\widehat{\\sigma}_i^2 - \\mathrm{Var}(v_i)\\right| \\leq z_{\\star} \\,\\sqrt{\\mathrm{Var}(\\widehat{\\sigma}_i^2)}$ using the exact variance of the unbiased sample variance for a normal distribution.\n     - Test $\\left|\\widehat{S}_2 - \\mathbb{E}\\!\\left[\\lVert \\boldsymbol{v} \\rVert^2\\right]\\right| \\leq z_{\\star} \\sqrt{\\mathrm{Var}\\!\\left(\\lVert \\boldsymbol{v} \\rVert^2\\right)/N}$.\n     - Test $\\left|\\widehat{\\mathcal{E}} - \\mathcal{E}\\right| \\leq z_{\\star} \\,\\sqrt{\\mathrm{Var}\\!\\left(\\widehat{\\mathcal{E}}\\right)}$ using propagation from $\\mathrm{Var}\\!\\left(\\lVert \\boldsymbol{v} \\rVert^2\\right)$.\n   - Use the standardized threshold $z_{\\star} = 5$.\n   - All velocities must be in $\\mathrm{m/s}$, masses in $\\mathrm{kg}$, temperatures in electron-volts converted to joules via $1\\,\\mathrm{eV} = 1.602176634 \\times 10^{-19}\\,\\mathrm{J}$, number density in $\\mathrm{m^{-3}}$, energy density in $\\mathrm{J/m^3}$.\n   - Set the pseudorandom seed to $s = 123456789$.\n4. For each test case, produce a list of four booleans indicating whether each of the four checks passed, in the following fixed order:\n   - Mean vector check.\n   - Per-component variance check (all three components must pass).\n   - Mean squared speed check.\n   - Kinetic energy density check.\n   Aggregate all test-case results into a single list of lists.\n\nTest Suite:\n- Test case A (electrons, zero drift, moderate temperature):\n  - Species mass $m = 9.1093837015 \\times 10^{-31}\\,\\mathrm{kg}$.\n  - Temperature $T = 100\\,\\mathrm{eV}$.\n  - Number density $n = 1.0 \\times 10^{19}\\,\\mathrm{m^{-3}}$.\n  - Drift $\\boldsymbol{u} = (0,0,0)\\,\\mathrm{m/s}$.\n  - Samples $N = 200000$.\n- Test case B (deuterons, finite drift, high temperature):\n  - Species mass $m = 3.343583719 \\times 10^{-27}\\,\\mathrm{kg}$.\n  - Temperature $T = 10000\\,\\mathrm{eV}$.\n  - Number density $n = 1.0 \\times 10^{20}\\,\\mathrm{m^{-3}}$.\n  - Drift $\\boldsymbol{u} = (10^{5},0,0)\\,\\mathrm{m/s}$.\n  - Samples $N = 200000$.\n- Test case C (tritons, zero drift, low temperature):\n  - Species mass $m = 5.007356665 \\times 10^{-27}\\,\\mathrm{kg}$.\n  - Temperature $T = 1\\,\\mathrm{eV}$.\n  - Number density $n = 5.0 \\times 10^{20}\\,\\mathrm{m^{-3}}$.\n  - Drift $\\boldsymbol{u} = (0,0,0)\\,\\mathrm{m/s}$.\n  - Samples $N = 200000$.\n- Test case D (electrons, multi-axis drift, higher temperature):\n  - Species mass $m = 9.1093837015 \\times 10^{-31}\\,\\mathrm{kg}$.\n  - Temperature $T = 1000\\,\\mathrm{eV}$.\n  - Number density $n = 1.0 \\times 10^{19}\\,\\mathrm{m^{-3}}$.\n  - Drift $\\boldsymbol{u} = (2.0 \\times 10^{6}, -2.0 \\times 10^{6}, 1.0 \\times 10^{6})\\,\\mathrm{m/s}$.\n  - Samples $N = 200000$.\n\nFinal Output Format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each entry corresponds to a test case and is itself a list of four booleans in the order specified above. For example, a valid output structure is $[ [b_{A1}, b_{A2}, b_{A3}, b_{A4}], [b_{B1}, b_{B2}, b_{B3}, b_{B4}], [b_{C1}, b_{C2}, b_{C3}, b_{C4}], [b_{D1}, b_{D2}, b_{D3}, b_{D4}] ]$, where each $b_{\\cdot}$ is either $\\mathrm{True}$ or $\\mathrm{False}$.", "solution": "The problem requires the derivation and implementation of a Monte Carlo sampling algorithm for a Maxwell-Boltzmann velocity distribution, followed by statistical verification of the sampled moments against their analytically derived counterparts.\n\n### 1. Derivation of the Sampling Algorithm\n\nThe problem starts from the canonical ensemble for a single particle with mass $m$ and Hamiltonian $H = \\sum_{i=1}^{3} p_i^2 / (2m)$, where $\\boldsymbol{p} = (p_x, p_y, p_z)$ is the particle's momentum. The probability of finding the particle in a microstate with momentum $\\boldsymbol{p}$ is proportional to the Boltzmann factor, $f(\\boldsymbol{p}) \\propto \\exp(-H / (k_{\\mathrm{B}} T))$. Here, $k_{\\mathrm{B}}$ is the Boltzmann constant and $T$ is the absolute temperature. The energy scale $k_{\\mathrm{B}} T$ is given in terms of a temperature in electron-volts, $T_{\\text{eV}}$, which is converted to Joules, so we replace $k_{\\mathrm{B}} T$ with $T_{\\text{J}} = T_{\\text{eV}} \\times e$, where $e$ is the elementary charge.\n\nSubstituting the Hamiltonian, the probability density function (PDF) for the momentum vector $\\boldsymbol{p}$ is:\n$$\nf(\\boldsymbol{p}) \\propto \\exp\\left(-\\frac{p_x^2 + p_y^2 + p_z^2}{2m (k_{\\mathrm{B}} T)}\\right) = \\exp\\left(-\\frac{p_x^2}{2m k_{\\mathrm{B}} T}\\right) \\exp\\left(-\\frac{p_y^2}{2m k_{\\mathrm{B}} T}\\right) \\exp\\left(-\\frac{p_z^2}{2m k_{\\mathrm{B}} T}\\right)\n$$\nThis shows that the momentum components $p_x$, $p_y$, and $p_z$ are statistically independent. The PDF for each component $p_i$ is of the form $f(p_i) \\propto \\exp(-p_i^2 / (2\\sigma_p^2))$, which is a Gaussian (normal) distribution with mean $0$ and variance $\\sigma_p^2 = m k_{\\mathrm{B}} T$.\n\nThe velocity components $v_i$ are related to the momentum components by $v_i = p_i / m$. Since $p_i$ is a normally distributed random variable, $v_i$ is also normally distributed. The mean of $v_i$ is $\\mathbb{E}[v_i] = \\mathbb{E}[p_i/m] = 0/m = 0$. The variance of $v_i$ is $\\mathrm{Var}(v_i) = \\mathrm{Var}(p_i/m) = \\mathrm{Var}(p_i)/m^2 = (m k_{\\mathrm{B}} T)/m^2 = k_{\\mathrm{B}} T / m$. Let us define this variance as $\\sigma_v^2 \\equiv k_{\\mathrm{B}} T / m$.\n\nThis describes the thermal velocity distribution in the particle's rest frame. To account for a bulk fluid motion, we perform a Galilean shift by a uniform drift velocity $\\boldsymbol{u} = (u_x, u_y, u_z)$. The velocity $\\boldsymbol{v}$ in the laboratory frame is the sum of the thermal velocity $\\boldsymbol{v}'$ and the drift velocity $\\boldsymbol{u}$: $\\boldsymbol{v} = \\boldsymbol{v}' + \\boldsymbol{u}$.\nThe components of the laboratory-frame velocity are $v_i = v_i' + u_i$. Since $v_i' \\sim \\mathcal{N}(0, \\sigma_v^2)$, each component $v_i$ follows a normal distribution:\n$$\nv_i \\sim \\mathcal{N}(u_i, \\sigma_v^2) = \\mathcal{N}\\left(u_i, \\frac{k_{\\mathrm{B}} T}{m}\\right)\n$$\nTo generate samples from this distribution, we can use an affine transformation of standard normal variates. Let $Z_i \\sim \\mathcal{N}(0,1)$ be three independent standard normal random variables. We can generate each velocity component $v_i$ as:\n$$\nv_i = u_i + \\sqrt{\\frac{k_{\\mathrm{B}} T}{m}} Z_i\n$$\nThis provides the complete algorithm for sampling a velocity vector $\\boldsymbol{v}$:\n1. Calculate the thermal speed parameter (standard deviation of thermal velocity components), $v_{\\text{th}} = \\sqrt{k_{\\mathrm{B}} T / m}$.\n2. Generate three independent random numbers $Z_x, Z_y, Z_z$ from the standard normal distribution $\\mathcal{N}(0,1)$.\n3. Construct the velocity vector $\\boldsymbol{v} = (v_x, v_y, v_z)$ as:\n   $v_x = u_x + v_{\\text{th}} Z_x$\n   $v_y = u_y + v_{\\text{th}} Z_y$\n   $v_z = u_z + v_{\\text{th}} Z_z$\n\n### 2. Derivation of Analytical Moments\n\nWe derive the required analytical moments for verification. Let $\\sigma^2 = k_{\\mathrm{B}} T / m$. The velocity components are $v_i \\sim \\mathcal{N}(u_i, \\sigma^2)$ and are independent.\n\n- **Mean velocity vector $\\mathbb{E}[\\boldsymbol{v}]$**:\nThe expectation of each component is $\\mathbb{E}[v_i] = u_i$. Therefore, the mean velocity vector is simply the drift velocity:\n$$\n\\mathbb{E}[\\boldsymbol{v}] = \\boldsymbol{u}\n$$\n\n- **Per-component variance $\\mathrm{Var}(v_i)$**:\nThe variance of each component is by definition the variance of the normal distribution from which it is drawn:\n$$\n\\mathrm{Var}(v_i) = \\sigma^2 = \\frac{k_{\\mathrm{B}} T}{m} \\quad \\text{for } i \\in \\{x,y,z\\}\n$$\n\n- **Mean squared speed $\\mathbb{E}\\!\\left[\\lVert \\boldsymbol{v} \\rVert^2\\right]$**:\nThe squared speed is $\\lVert \\boldsymbol{v} \\rVert^2 = v_x^2 + v_y^2 + v_z^2$. By linearity of expectation, $\\mathbb{E}[\\lVert \\boldsymbol{v} \\rVert^2] = \\sum_{i=x,y,z} \\mathbb{E}[v_i^2]$.\nUsing the relation $\\mathbb{E}[X^2] = \\mathrm{Var}(X) + (\\mathbb{E}[X])^2$, we have $\\mathbb{E}[v_i^2] = \\mathrm{Var}(v_i) + (\\mathbb{E}[v_i])^2 = \\sigma^2 + u_i^2$.\nSumming over the components:\n$$\n\\mathbb{E}[\\lVert \\boldsymbol{v} \\rVert^2] = (\\sigma^2 + u_x^2) + (\\sigma^2 + u_y^2) + (\\sigma^2 + u_z^2) = 3\\sigma^2 + \\lVert \\boldsymbol{u} \\rVert^2 = 3\\frac{k_{\\mathrm{B}} T}{m} + \\lVert \\boldsymbol{u} \\rVert^2\n$$\n\n- **Kinetic energy density $\\mathcal{E}$**:\nUsing its definition $\\mathcal{E} = \\frac{1}{2} m n \\,\\mathbb{E}\\!\\left[\\lVert \\boldsymbol{v} \\rVert^2\\right]$, we substitute the above result:\n$$\n\\mathcal{E} = \\frac{1}{2} m n \\left(3\\frac{k_{\\mathrm{B}} T}{m} + \\lVert \\boldsymbol{u} \\rVert^2\\right) = \\frac{3}{2} n k_{\\mathrm{B}} T + \\frac{1}{2} m n \\lVert \\boldsymbol{u} \\rVert^2\n$$\n\n- **Variance of the squared speed $\\mathrm{Var}\\!\\left(\\lVert \\boldsymbol{v} \\rVert^2\\right)$**:\nLet $S_2 = \\lVert \\boldsymbol{v} \\rVert^2 = \\sum_i v_i^2$. We need $\\mathrm{Var}(S_2)$. Since the components $v_i$ are independent, the variance of their sum is the sum of their variances: $\\mathrm{Var}(S_2) = \\sum_i \\mathrm{Var}(v_i^2)$.\nWe need $\\mathrm{Var}(v_i^2) = \\mathbb{E}[v_i^4] - (\\mathbb{E}[v_i^2])^2$.\nFor a normal variable $X \\sim \\mathcal{N}(\\mu, \\sigma^2)$, the central moments are $\\mathbb{E}[(X-\\mu)^2] = \\sigma^2$ and $\\mathbb{E}[(X-\\mu)^4] = 3\\sigma^4$.\nWe expand $v_i = u_i + v_i'$, where $v_i' \\sim \\mathcal{N}(0, \\sigma^2)$.\n$\\mathbb{E}[v_i^4] = \\mathbb{E}[(u_i + v_i')^4] = u_i^4 + 6u_i^2\\mathbb{E}[(v_i')^2] + \\mathbb{E}[(v_i')^4] = u_i^4 + 6u_i^2\\sigma^2 + 3\\sigma^4$.\nWe already know $\\mathbb{E}[v_i^2] = u_i^2 + \\sigma^2$.\nSo, $\\mathrm{Var}(v_i^2) = (u_i^4 + 6u_i^2\\sigma^2 + 3\\sigma^4) - (u_i^2 + \\sigma^2)^2 = (u_i^4 + 6u_i^2\\sigma^2 + 3\\sigma^4) - (u_i^4 + 2u_i^2\\sigma^2 + \\sigma^4) = 4u_i^2\\sigma^2 + 2\\sigma^4$.\nSumming over $i=x,y,z$:\n$$\n\\mathrm{Var}(\\lVert \\boldsymbol{v} \\rVert^2) = \\sum_i (4u_i^2\\sigma^2 + 2\\sigma^4) = 4\\sigma^2 \\sum_i u_i^2 + \\sum_i 2\\sigma^4 = 4\\sigma^2 \\lVert \\boldsymbol{u} \\rVert^2 + 6\\sigma^4\n$$\nSubstituting $\\sigma^2 = k_{\\mathrm{B}} T / m$:\n$$\n\\mathrm{Var}(\\lVert \\boldsymbol{v} \\rVert^2) = 4\\frac{k_{\\mathrm{B}} T}{m} \\lVert \\boldsymbol{u} \\rVert^2 + 6\\left(\\frac{k_{\\mathrm{B}} T}{m}\\right)^2\n$$\n\n### 3. Statistical Verification\n\nThe Monte Carlo simulation generates a sample of $N$ velocities $\\{\\boldsymbol{v}^{(j)}\\}_{j=1}^N$. We compute empirical estimates of the moments and test if they fall within a statistically expected range of the analytical values. The tests are based on the Central Limit Theorem, forming z-scores with a threshold of $z_{\\star} = 5$.\n\n1.  **Mean Velocity**: The empirical mean is $\\widehat{v}_i = \\frac{1}{N}\\sum_j v_i^{(j)}$. The standard error of the mean is $\\sqrt{\\mathrm{Var}(v_i)/N}$. The test for each component is $|\\widehat{v}_i - u_i| \\le z_{\\star} \\sqrt{\\mathrm{Var}(v_i)/N}$.\n\n2.  **Per-component Variance**: The unbiased sample variance is $\\widehat{\\sigma}_i^2 = \\frac{1}{N-1}\\sum_j (v_i^{(j)} - \\widehat{v}_i)^2$. For samples from a normal distribution $\\mathcal{N}(\\mu, \\sigma^2)$, the variance of the sample variance is $\\mathrm{Var}(\\widehat{\\sigma}_i^2) = \\frac{2(\\mathrm{Var}(v_i))^2}{N-1}$. The test is $|\\widehat{\\sigma}_i^2 - \\mathrm{Var}(v_i)| \\le z_{\\star} \\sqrt{2(\\mathrm{Var}(v_i))^2 / (N-1)}$.\n\n3.  **Mean Squared Speed**: The empirical mean is $\\widehat{S}_2 = \\frac{1}{N}\\sum_j \\lVert \\boldsymbol{v}^{(j)} \\rVert^2$. The standard error of this mean is $\\sqrt{\\mathrm{Var}(\\lVert \\boldsymbol{v} \\rVert^2)/N}$. The test is $|\\widehat{S}_2 - \\mathbb{E}[\\lVert \\boldsymbol{v} \\rVert^2]| \\le z_{\\star} \\sqrt{\\mathrm{Var}(\\lVert \\boldsymbol{v} \\rVert^2)/N}$.\n\n4.  **Kinetic Energy Density**: The empirical estimate is $\\widehat{\\mathcal{E}} = \\frac{1}{2} m n \\widehat{S}_2$. Being a linear scaling of $\\widehat{S}_2$, its test is equivalent to that for the mean squared speed. The variance of the estimator is $\\mathrm{Var}(\\widehat{\\mathcal{E}}) = \\mathrm{Var}(\\frac{1}{2} m n \\widehat{S}_2) = (\\frac{1}{2} m n)^2 \\mathrm{Var}(\\widehat{S}_2) = (\\frac{1}{2} m n)^2 \\frac{\\mathrm{Var}(\\lVert \\boldsymbol{v} \\rVert^2)}{N}$. The test $|\\widehat{\\mathcal{E}} - \\mathcal{E}| \\le z_{\\star}\\sqrt{\\mathrm{Var}(\\widehat{\\mathcal{E}})}$ simplifies to the test for $\\widehat{S}_2$.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the particle velocity sampling and verification problem.\n    \"\"\"\n    # Define constants\n    E_CHARGE = 1.602176634e-19  # Elementary charge in Coulombs\n    SEED = 123456789\n    Z_STAR = 5.0\n\n    # Define the test cases from the problem statement\n    test_cases = [\n        {\n            \"name\": \"A\",\n            \"m\": 9.1093837015e-31,  # Electron mass (kg)\n            \"T_eV\": 100.0,\n            \"n\": 1.0e19,\n            \"u\": np.array([0.0, 0.0, 0.0]),\n            \"N\": 200000\n        },\n        {\n            \"name\": \"B\",\n            \"m\": 3.343583719e-27,   # Deuteron mass (kg)\n            \"T_eV\": 10000.0,\n            \"n\": 1.0e20,\n            \"u\": np.array([1.0e5, 0.0, 0.0]),\n            \"N\": 200000\n        },\n        {\n            \"name\": \"C\",\n            \"m\": 5.007356665e-27,   # Triton mass (kg)\n            \"T_eV\": 1.0,\n            \"n\": 5.0e20,\n            \"u\": np.array([0.0, 0.0, 0.0]),\n            \"N\": 200000\n        },\n        {\n            \"name\": \"D\",\n            \"m\": 9.1093837015e-31,  # Electron mass (kg)\n            \"T_eV\": 1000.0,\n            \"n\": 1.0e19,\n            \"u\": np.array([2.0e6, -2.0e6, 1.0e6]),\n            \"N\": 200000\n        }\n    ]\n\n    # Initialize a pseudorandom number generator with a fixed seed\n    rng = np.random.default_rng(SEED)\n    \n    results = []\n\n    for case in test_cases:\n        m, T_eV, n, u, N = case[\"m\"], case[\"T_eV\"], case[\"n\"], case[\"u\"], case[\"N\"]\n\n        # --- 1. Analytical Moment Calculations ---\n        k_B_T = T_eV * E_CHARGE\n        \n        # Per-component variance\n        var_v_analytic = k_B_T / m\n        \n        # Mean velocity vector (is just u)\n        mean_v_analytic = u\n        \n        # Mean squared speed\n        u_sq_norm = np.sum(u**2)\n        mean_sq_speed_analytic = 3 * var_v_analytic + u_sq_norm\n        \n        # Variance of squared speed\n        var_sq_speed_analytic = 4 * var_v_analytic * u_sq_norm + 6 * var_v_analytic**2\n        \n        # Kinetic energy density\n        energy_density_analytic = 0.5 * m * n * mean_sq_speed_analytic\n\n        # --- 2. Monte Carlo Sampling ---\n        v_th = np.sqrt(var_v_analytic)\n        thermal_velocities = v_th * rng.standard_normal(size=(N, 3))\n        velocities = u + thermal_velocities\n\n        # --- 3. Empirical Moment Calculations ---\n        # Empirical mean vector\n        mean_v_empirical = np.mean(velocities, axis=0)\n        \n        # Empirical per-component variance (unbiased)\n        var_v_empirical = np.var(velocities, axis=0, ddof=1)\n        \n        # Empirical mean squared speed\n        sq_speeds = np.sum(velocities**2, axis=1)\n        mean_sq_speed_empirical = np.mean(sq_speeds)\n\n        # Empirical kinetic energy density\n        energy_density_empirical = 0.5 * m * n * mean_sq_speed_empirical\n\n        # --- 4. Statistical Verification Checks ---\n        \n        # Check 1: Mean vector\n        std_err_mean_v = np.sqrt(var_v_analytic / N)\n        # Avoid division by zero if std_err is zero (e.g., T=0)\n        z_scores_mean = np.zeros(3)\n        if std_err_mean_v > 0:\n            z_scores_mean = np.abs(mean_v_empirical - mean_v_analytic) / std_err_mean_v\n        check_mean_vector = np.all(z_scores_mean = Z_STAR)\n\n        # Check 2: Per-component variance\n        var_of_sample_var = 2 * var_v_analytic**2 / (N - 1)\n        std_err_var_v = np.sqrt(var_of_sample_var)\n        z_scores_var = np.zeros(3)\n        if std_err_var_v > 0:\n             z_scores_var = np.abs(var_v_empirical - var_v_analytic) / std_err_var_v\n        check_variance = np.all(z_scores_var = Z_STAR)\n\n        # Check 3: Mean squared speed\n        std_err_mean_sq_speed = np.sqrt(var_sq_speed_analytic / N)\n        z_score_sq_speed = 0.0\n        if std_err_mean_sq_speed > 0:\n            z_score_sq_speed = np.abs(mean_sq_speed_empirical - mean_sq_speed_analytic) / std_err_mean_sq_speed\n        check_mean_sq_speed = z_score_sq_speed = Z_STAR\n        \n        # Check 4: Kinetic energy density\n        var_of_E_hat = (0.5 * m * n)**2 * var_sq_speed_analytic / N\n        std_err_E = np.sqrt(var_of_E_hat)\n        z_score_E = 0.0\n        if std_err_E > 0:\n            z_score_E = np.abs(energy_density_empirical - energy_density_analytic) / std_err_E\n        check_energy_density = z_score_E = Z_STAR\n        \n        results.append([\n            check_mean_vector,\n            check_variance,\n            check_mean_sq_speed,\n            check_energy_density\n        ])\n\n    # Final print statement in the exact required format.\n    # The format [ [b1, b2, ...], [b1, b2, ...] ] requires spaces after commas.\n    # The str() representation of a list of lists matches this format.\n    print(results)\n\nsolve()\n```", "id": "3725144"}]}