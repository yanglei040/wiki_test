{"hands_on_practices": [{"introduction": "Understanding the ionization state of a plasma begins with its thermodynamic roots. This first practice grounds your understanding by guiding you through the derivation of the Saha equation from the fundamental condition of chemical equilibrium for a simple, single-stage ionization process. By applying this derived principle to calculate the ionization fraction of deuterium, a primary fuel for fusion reactors, you will connect foundational statistical mechanics directly to a practical problem in fusion science [@problem_id:3705104].", "problem": "A spatially uniform, quasi-neutral deuterium plasma in local thermodynamic equilibrium (LTE) at temperature $T$ consists of neutral deuterium atoms $D^{0}$, singly ionized deuterons $D^{+}$, and electrons $e^{-}$. Assume nonrelativistic, nondegenerate, ideal gases for all species, and neglect excited bound states, continuum lowering, and any degeneracies beyond electronic spin. Treat the internal partition functions in the ground-state approximation with neutral deuterium electronic degeneracy $g_{0} = 2$, deuteron internal degeneracy $g_{1} = 1$, and electron spin degeneracy $g_{e} = 2$. The first ionization energy of deuterium is $\\chi = 13.6\\,\\mathrm{eV}$ (numerically equal to hydrogen to within the precision needed here). The plasma is quasi-neutral, so $n_{D^{+}} = n_{e}$. \n\nStarting from the condition of chemical equilibrium and the ideal-gas expressions for chemical potentials expressed through single-particle translational partition functions, derive the equilibrium relation between the number densities $n_{e}$, $n_{D^{+}}$, and $n_{D^{0}}$, and from it obtain the ionized fraction\n$$\nx \\equiv \\frac{n_{D^{+}}}{n_{D^{0}} + n_{D^{+}}}\n$$\nin terms of $T$ and a given $n_{e}$. Then evaluate $x$ for $T$ such that $k_{B} T = 1\\,\\mathrm{eV}$ and $n_{e} = 10^{20}\\,\\mathrm{m}^{-3}$. Use the following constants for numerical evaluation: Planck constant $h = 6.62607015 \\times 10^{-34}\\,\\mathrm{J\\,s}$, Boltzmann constant $k_{B} = 1.380649 \\times 10^{-23}\\,\\mathrm{J\\,K}^{-1}$, electron mass $m_{e} = 9.1093837015 \\times 10^{-31}\\,\\mathrm{kg}$, and $1\\,\\mathrm{eV} = 1.602176634 \\times 10^{-19}\\,\\mathrm{J}$. \n\nRound your ionization fraction to four significant figures and express it as a pure decimal (no units). Briefly justify, using the scaling of your derived expression, why the ionization fraction approaches unity for $T$ such that $k_{B} T \\sim 10\\,\\mathrm{eV}$ at the same $n_{e}$.", "solution": "The problem is valid as it represents a standard and well-posed problem in statistical mechanics and plasma physics, based on established scientific principles. All necessary information and constants are provided, and there are no internal contradictions or scientifically unsound premises.\n\nThe ionization of neutral deuterium $D^0$ into a deuteron $D^+$ and an electron $e^-$ is described by the reaction:\n$$\nD^0 \\rightleftharpoons D^+ + e^-\n$$\nIn local thermodynamic equilibrium (LTE), the chemical potentials of the species are related by the condition of chemical equilibrium:\n$$\n\\mu_{D^0} = \\mu_{D^+} + \\mu_{e}\n$$\nWe will use the indices $0$, $1$, and $e$ to denote $D^0$, $D^+$, and $e^-$, respectively, so $\\mu_0 = \\mu_1 + \\mu_e$.\n\nFor a nonrelativistic, nondegenerate ideal gas, the chemical potential of a species $i$ with number density $n_i$, mass $m_i$, and ground-state degeneracy $g_i$ at temperature $T$ is given by:\n$$\n\\mu_i = -k_B T \\ln\\left( \\frac{Z_i^{\\text{trans}} Z_i^{\\text{int}}}{N_i} \\right) + E_i^{\\text{rest}}\n$$\nwhere $N_i$ is the number of particles in volume $V$ ($n_i=N_i/V$), $E_i^{\\text{rest}}$ is the rest energy, $Z_i^{\\text{int}}$ is the internal partition function (approximated by $g_i$), and $Z_i^{\\text{trans}}$ is the single-particle translational partition function:\n$$\nZ_i^{\\text{trans}} = V \\left( \\frac{2\\pi m_i k_B T}{h^2} \\right)^{3/2}\n$$\nSubstituting $Z_i^{\\text{trans}}$ and $Z_i^{\\text{int}}=g_i$ into the expression for $\\mu_i$, we get:\n$$\n\\mu_i = -k_B T \\ln\\left[ \\frac{g_i}{n_i} \\left( \\frac{2\\pi m_i k_B T}{h^2} \\right)^{3/2} \\right] + E_i^{\\text{rest}}\n$$\nApplying this to the species in the reaction:\n$$\n\\mu_0 = -k_B T \\ln\\left[ \\frac{g_0}{n_0} \\left( \\frac{2\\pi m_0 k_B T}{h^2} \\right)^{3/2} \\right] + m_0 c^2\n$$\n$$\n\\mu_1 = -k_B T \\ln\\left[ \\frac{g_1}{n_1} \\left( \\frac{2\\pi m_1 k_B T}{h^2} \\right)^{3/2} \\right] + m_1 c^2\n$$\n$$\n\\mu_e = -k_B T \\ln\\left[ \\frac{g_e}{n_e} \\left( \\frac{2\\pi m_e k_B T}{h^2} \\right)^{3/2} \\right] + m_e c^2\n$$\nThe rest energies are related by the ionization energy $\\chi$. The rest mass of the neutral atom $m_0$ is the sum of the masses of its constituents minus the binding energy: $m_0 c^2 = m_1 c^2 + m_e c^2 - \\chi$.\nSo, $m_0 c^2 - m_1 c^2 - m_e c^2 = -\\chi$.\n\nSubstituting the chemical potentials into the equilibrium condition $\\mu_0 = \\mu_1 + \\mu_e$ and rearranging gives:\n$$\nm_0 c^2 - m_1 c^2 - m_e c^2 = k_B T \\left( \\ln\\left[\\dots\\right]_0 - \\ln\\left[\\dots\\right]_1 - \\ln\\left[\\dots\\right]_e \\right)\n$$\n$$\n-\\chi = k_B T \\ln\\left[ \\frac{\\frac{g_0}{n_0}\\left(\\dots m_0 \\dots\\right)^{3/2}}{\\frac{g_1}{n_1}\\left(\\dots m_1 \\dots\\right)^{3/2} \\cdot \\frac{g_e}{n_e}\\left(\\dots m_e \\dots\\right)^{3/2}} \\right]\n$$\n$$\n-\\frac{\\chi}{k_B T} = \\ln \\left[ \\frac{n_1 n_e}{n_0} \\frac{g_0}{g_1 g_e} \\left(\\frac{m_0}{m_1 m_e}\\right)^{3/2} \\left(\\frac{h^2}{2\\pi k_B T}\\right)^{3/2} \\right]\n$$\nWe use the excellent approximation $m_0 \\approx m_1$. The mass term becomes $(\\frac{m_1}{m_1 m_e})^{3/2} = m_e^{-3/2}$.\n$$\n\\exp\\left(-\\frac{\\chi}{k_B T}\\right) = \\frac{n_1 n_e}{n_0} \\frac{g_0}{g_1 g_e} \\left( \\frac{h^2}{2\\pi m_e k_B T} \\right)^{3/2}\n$$\nRearranging yields the Saha ionization equation:\n$$\n\\frac{n_1 n_e}{n_0} = \\frac{g_1 g_e}{g_0} \\left( \\frac{2\\pi m_e k_B T}{h^2} \\right)^{3/2} \\exp\\left(-\\frac{\\chi}{k_B T}\\right)\n$$\nUsing the provided degeneracies, $g_0=2$, $g_1=1$, and $g_e=2$, the degeneracy factor is $\\frac{g_1 g_e}{g_0} = \\frac{1 \\cdot 2}{2} = 1$. The equilibrium relation is:\n$$\n\\frac{n_1 n_e}{n_0} = \\left( \\frac{2\\pi m_e k_B T}{h^2} \\right)^{3/2} \\exp\\left(-\\frac{\\chi}{k_B T}\\right)\n$$\nThe problem specifies quasi-neutrality, $n_{D^+} = n_e$, which means $n_1 = n_e$. The ionized fraction is defined as $x \\equiv \\frac{n_1}{n_0 + n_1}$. From this definition, we can write $n_0 = n_1 \\frac{1-x}{x}$. Substituting these relations into the Saha equation:\n$$\n\\frac{n_1 \\cdot n_1}{n_1 \\frac{1-x}{x}} = \\frac{n_1 x}{1-x} = \\left( \\frac{2\\pi m_e k_B T}{h^2} \\right)^{3/2} \\exp\\left(-\\frac{\\chi}{k_B T}\\right)\n$$\nSince $n_1=n_e$, we have:\n$$\n\\frac{n_e x}{1-x} = \\left( \\frac{2\\pi m_e k_B T}{h^2} \\right)^{3/2} \\exp\\left(-\\frac{\\chi}{k_B T}\\right) \\equiv S(T)\n$$\nWe solve for $x$:\n$$\nx n_e = (1-x) S(T) \\implies x(n_e + S(T)) = S(T) \\implies x = \\frac{S(T)}{n_e + S(T)} = \\frac{1}{1 + n_e/S(T)}\n$$\nThis gives the ionized fraction $x$ in terms of $T$ and $n_e$:\n$$\nx = \\left[ 1 + n_e \\left( \\frac{h^2}{2\\pi m_e k_B T} \\right)^{3/2} \\exp\\left(\\frac{\\chi}{k_B T}\\right) \\right]^{-1}\n$$\nNow, we evaluate $x$ for the given conditions: $k_B T = 1\\,\\mathrm{eV}$ and $n_e = 10^{20}\\,\\mathrm{m}^{-3}$. The ionization energy is $\\chi = 13.6\\,\\mathrm{eV}$.\nFirst, we convert $k_B T$ to Joules: $k_B T = 1\\,\\mathrm{eV} \\times (1.602176634 \\times 10^{-19}\\,\\mathrm{J/eV}) = 1.602176634 \\times 10^{-19}\\,\\mathrm{J}$.\nThe exponential argument is $\\chi/(k_B T) = 13.6\\,\\mathrm{eV} / 1\\,\\mathrm{eV} = 13.6$.\nLet's calculate the term often called the quantum concentration, $n_Q$:\n$$\nn_Q = \\left( \\frac{2\\pi m_e k_B T}{h^2} \\right)^{3/2}\n$$\nUsing the provided constants:\n$m_e = 9.1093837015 \\times 10^{-31}\\,\\mathrm{kg}$\n$h = 6.62607015 \\times 10^{-34}\\,\\mathrm{J\\,s}$\n$$\n\\frac{2\\pi m_e k_B T}{h^2} = \\frac{2\\pi (9.10938... \\times 10^{-31}\\,\\mathrm{kg})(1.60217... \\times 10^{-19}\\,\\mathrm{J})}{(6.62607... \\times 10^{-34}\\,\\mathrm{J\\,s})^2} \\approx 2.090226 \\times 10^{18}\\,\\mathrm{m}^{-2}\n$$\n$$\nn_Q \\approx (2.090226 \\times 10^{18}\\,\\mathrm{m}^{-2})^{3/2} \\approx 3.02425 \\times 10^{27}\\,\\mathrm{m}^{-3}\n$$\nNow we can compute $S(T) = n_Q \\exp(-\\chi/k_B T)$:\n$$\nS(T) \\approx (3.02425 \\times 10^{27}\\,\\mathrm{m}^{-3}) \\exp(-13.6) \\approx (3.02425 \\times 10^{27}\\,\\mathrm{m}^{-3}) (1.23735 \\times 10^{-6})\n$$\n$$\nS(T) \\approx 3.74198 \\times 10^{21}\\,\\mathrm{m}^{-3}\n$$\nFinally, we calculate the ionization fraction $x$:\n$$\nx = \\frac{S(T)}{n_e + S(T)} = \\frac{3.74198 \\times 10^{21}\\,\\mathrm{m}^{-3}}{10^{20}\\,\\mathrm{m}^{-3} + 3.74198 \\times 10^{21}\\,\\mathrm{m}^{-3}} = \\frac{3.74198 \\times 10^{21}}{0.1 \\times 10^{21} + 3.74198 \\times 10^{21}}\n$$\n$$\nx = \\frac{3.74198}{3.84198} \\approx 0.973971...\n$$\nRounding to four significant figures, we get $x \\approx 0.9740$.\n\nTo justify why the ionization fraction $x$ approaches unity for $k_B T \\sim 10\\,\\mathrm{eV}$ at the same $n_e$, we analyze the expression $x = (1 + n_e/S(T))^{-1}$. For $x \\to 1$, the ratio $n_e/S(T)$ must approach $0$, which means $S(T)$ must become much larger than the constant $n_e$. The temperature dependence of $S(T)$ is given by:\n$$\nS(T) \\propto T^{3/2} \\exp\\left(-\\frac{\\chi}{k_B T}\\right)\n$$\nBoth the power-law term $T^{3/2}$ and the exponential term $\\exp(-\\chi/k_B T)$ are strongly increasing functions of temperature. When we increase $k_B T$ from $1\\,\\mathrm{eV}$ to $10\\,\\mathrm{eV}$ (a factor of $10$), the $T^{3/2}$ term increases by a factor of $10^{3/2} \\approx 31.6$. The exponential term changes from $\\exp(-13.6/1) = \\exp(-13.6) \\approx 1.24 \\times 10^{-6}$ to $\\exp(-13.6/10) = \\exp(-1.36) \\approx 0.257$. The exponential factor increases by a factor of about $2 \\times 10^5$.\nThis combined large increase in $S(T)$ makes it vastly larger than $n_e = 10^{20}\\,\\mathrm{m}^{-3}$. As a result, the ratio $n_e/S(T)$ becomes very close to zero, and consequently $x = (1 + n_e/S(T))^{-1}$ approaches $1$. The plasma becomes almost fully ionized.", "answer": "$$\n\\boxed{0.9740}\n$$", "id": "3705104"}, {"introduction": "The simplest application of the Saha equation often approximates atoms as simple two-level systems (neutral ground state and ion). This exercise moves beyond that initial model to explore a crucial physical refinement: the role of excited electronic states. By incorporating contributions from excited states into the atomic partition function, you will quantify their impact on the calculated ionization balance, gaining a deeper appreciation for how the internal structure of atoms influences macroscopic plasma properties [@problem_id:3705161].", "problem": "A spatially uniform, isothermal, quasi-neutral deuterium plasma in collisional thermal equilibrium contains only neutral deuterium atoms and singly ionized deuterium ions, with electrons treated as an ideal Maxwell-Boltzmann gas. The temperature is $T$ such that $k_B T$ equals $T$ when energies are expressed in electronvolts (i.e., $T$ in this problem denotes $k_B T$ in $\\mathrm{eV}$), and the electron number density $n_e$ is externally fixed by constraints of the larger fusion system. Assume ideal-gas behavior for all species and thermodynamic equilibrium for the reaction $\\mathrm{D} \\rightleftharpoons \\mathrm{D}^{+} + e^{-}$.\n\nUsing only fundamental equilibrium thermodynamics, ideal-gas statistical mechanics with internal partition functions, and well-tested atomic data, derive the equilibrium ionization balance relation for the ratio $n_{\\mathrm{D}^{+}}/n_{\\mathrm{D}}$ in terms of $T$, $n_e$, and the internal partition functions of the neutral atom and the ion. Treat the internal partition function of $\\mathrm{D}^{+}$ as unity. For the neutral deuterium atom, take the ground-state degeneracy $g_1 = 2$ and include excited-state contributions from the $n=2$ and $n=3$ manifolds only, with degeneracies $g_n = 2 n^2$ and excitation energies above the ground state $\\Delta E_2 = 10.20\\,\\mathrm{eV}$ and $\\Delta E_3 = 12.09\\,\\mathrm{eV}$. The first ionization energy is $\\chi = 13.60\\,\\mathrm{eV}$. The electron has spin degeneracy factor $2$. You may assume that higher-$n$ states are suppressed by plasma microfields at the stated density so that truncating the neutral internal partition function at $n=3$ is adequate.\n\nLet $x \\equiv n_{\\mathrm{D}^{+}}/(n_{\\mathrm{D}}+n_{\\mathrm{D}^{+}})$ be the ionization fraction for a pure deuterium system so that quasi-neutrality implies $n_e = n_{\\mathrm{D}^{+}}$. Express $x$ in terms of $T$, $n_e$, and the internal partition functions, and then evaluate numerically the ratio $R \\equiv x_{\\text{exc}}/x_{\\text{ground}}$, where $x_{\\text{ground}}$ is computed with the neutral partition function restricted to the ground state only, and $x_{\\text{exc}}$ is computed including the $n=2$ and $n=3$ excited-state contributions as specified.\n\nUse $T = 2.00\\,\\mathrm{eV}$ and $n_e = 1.00 \\times 10^{25}\\,\\mathrm{m}^{-3}$. Physical constants: electron mass $m_e = 9.1093837015 \\times 10^{-31}\\,\\mathrm{kg}$, Planck constant $h = 6.62607015 \\times 10^{-34}\\,\\mathrm{J\\,s}$, Boltzmann constant $k_B = 1.380649 \\times 10^{-23}\\,\\mathrm{J\\,K}^{-1}$, elementary charge $e = 1.602176634 \\times 10^{-19}\\,\\mathrm{C}$, vacuum permittivity $\\epsilon_0 = 8.8541878128 \\times 10^{-12}\\,\\mathrm{F\\,m}^{-1}$. Express the final ratio $R$ as a dimensionless decimal and round your answer to four significant figures.", "solution": "The problem is found to be valid as it is scientifically grounded in equilibrium statistical mechanics, well-posed with a complete and consistent set of data, and objective in its formulation. It represents a standard application of the Saha ionization equation in plasma physics.\n\nThe problem asks for the derivation of the ionization balance relation for the reaction $\\mathrm{D} \\rightleftharpoons \\mathrm{D}^{+} + e^{-}$. In thermodynamic equilibrium, the chemical potentials are related by $\\mu_{\\mathrm{D}} = \\mu_{\\mathrm{D}^{+}} + \\mu_{e}$. Using the standard expression for chemical potential and following a derivation similar to that in the previous problem, we arrive at the Saha ionization equation:\n$$\n\\frac{n_{\\mathrm{D}^{+}} n_e}{n_{\\mathrm{D}}} = 2 \\frac{Z_{\\mathrm{D}^{+}}}{Z_{\\mathrm{D}}(T)} \\left(\\frac{2\\pi m_e k_B T_K}{h^2}\\right)^{3/2} \\exp\\left(-\\frac{\\chi}{k_B T_K}\\right)\n$$\nwhere $Z_{\\mathrm{D}}$ and $Z_{\\mathrm{D}^{+}}$ are the internal partition functions, $T_K$ is the temperature in Kelvin, and the factor of 2 is the electron spin degeneracy $Z_e$. The problem specifies that temperature $T$ and energies $\\chi, \\Delta E$ are given in units of electronvolts ($\\mathrm{eV}$). We can express $k_B T_K = eT_{\\text{eV}}$ and the ratio $\\chi/k_B T_K$ becomes $\\chi_{\\text{eV}}/T_{\\text{eV}}$. The ionization balance relation for the ratio $n_{\\mathrm{D}^{+}}/n_{\\mathrm{D}}$ is:\n$$\n\\frac{n_{\\mathrm{D}^{+}}}{n_{\\mathrm{D}}} = \\frac{1}{n_e} \\left[ 2 \\frac{Z_{\\mathrm{D}^{+}}}{Z_{\\mathrm{D}}(T)} \\left(\\frac{2\\pi m_e e T}{h^2}\\right)^{3/2} \\exp\\left(-\\frac{\\chi}{T}\\right) \\right]\n$$\nwhere $T$ and $\\chi$ are the values in eV.\n\nThe problem defines the ionization fraction $x \\equiv n_{\\mathrm{D}^{+}}/(n_{\\mathrm{D}}+n_{\\mathrm{D}^{+}})$ for a pure deuterium system, where quasi-neutrality implies $n_e = n_{\\mathrm{D}^{+}}$. To calculate $x$ for the given $n_e$, we assume it corresponds to this pure system, so we set $n_{\\mathrm{D}^{+}} = n_e$. The Saha equation then determines the neutral density $n_{\\mathrm{D}}$ for this state.\nThe ionization ratio can be written as $n_{\\mathrm{D}^{+}}/n_{\\mathrm{D}} = Y/Z_{\\mathrm{D}}(T)$, where $Y$ is a dimensionless quantity that combines the plasma conditions and atomic constants, but is independent of the neutral atom's internal structure:\n$$\nY \\equiv \\frac{2 Z_{\\mathrm{D}^{+}}}{n_e} \\left(\\frac{2\\pi m_e e T}{h^2}\\right)^{3/2} \\exp\\left(-\\frac{\\chi}{T}\\right)\n$$\nThe ionization fraction $x$ can be expressed in terms of this ratio:\n$$\nx = \\frac{n_{\\mathrm{D}^{+}}/n_{\\mathrm{D}}}{1+n_{\\mathrm{D}^{+}}/n_{\\mathrm{D}}} = \\frac{Y/Z_{\\mathrm{D}}(T)}{1+Y/Z_{\\mathrm{D}}(T)} = \\frac{Y}{Z_{\\mathrm{D}}(T)+Y}\n$$\nThe problem requires calculating the ratio $R \\equiv x_{\\text{exc}}/x_{\\text{ground}}$.\nFor $x_{\\text{ground}}$, the neutral partition function includes only the ground state: $Z_{\\mathrm{D, ground}} = g_1 = 2$.\n$$\nx_{\\text{ground}} = \\frac{Y}{Z_{\\mathrm{D, ground}}+Y} = \\frac{Y}{2+Y}\n$$\nFor $x_{\\text{exc}}$, the partition function includes excited states up to $n=3$:\n$$\nZ_{\\mathrm{D, exc}}(T) = g_1 e^{-\\Delta E_1/T} + g_2 e^{-\\Delta E_2/T} + g_3 e^{-\\Delta E_3/T}\n$$\nGiven $g_n=2n^2$, we have $g_1=2$, $g_2=8$, $g_3=18$. With $\\Delta E_1=0$:\n$$\nZ_{\\mathrm{D, exc}}(T) = 2 + 8 \\exp(-\\Delta E_2/T) + 18 \\exp(-\\Delta E_3/T)\n$$\n$$\nx_{\\text{exc}} = \\frac{Y}{Z_{\\mathrm{D, exc}}(T)+Y}\n$$\nThe ratio $R$ is therefore:\n$$\nR = \\frac{x_{\\text{exc}}}{x_{\\text{ground}}} = \\frac{Y/(Z_{\\mathrm{D, exc}}+Y)}{Y/(Z_{\\mathrm{D, ground}}+Y)} = \\frac{Z_{\\mathrm{D, ground}}+Y}{Z_{\\mathrm{D, exc}}+Y}\n$$\n\nNow, we perform the numerical calculation using the provided data:\n$T = 2.00\\,\\mathrm{eV}$, $n_e = 1.00 \\times 10^{25}\\,\\mathrm{m}^{-3}$, $\\chi = 13.60\\,\\mathrm{eV}$, $\\Delta E_2 = 10.20\\,\\mathrm{eV}$, $\\Delta E_3 = 12.09\\,\\mathrm{eV}$.\n$m_e = 9.1093837 \\times 10^{-31}\\,\\mathrm{kg}$, $h = 6.62607015 \\times 10^{-34}\\,\\mathrm{J\\,s}$, $e = 1.602176634 \\times 10^{-19}\\,\\mathrm{C}$, $Z_{\\mathrm{D}^{+}} = 1$.\n\nFirst, calculate the dimensionless quantity $Y$:\n$$\nY = \\frac{2 \\times 1}{1.00 \\times 10^{25}} \\left(\\frac{2\\pi (9.1093837 \\times 10^{-31}) (1.602176634 \\times 10^{-19}) (2.00)}{(6.62607015 \\times 10^{-34})^2}\\right)^{3/2} \\exp\\left(-\\frac{13.60}{2.00}\\right)\n$$\nCalculate the term corresponding to the quantum concentration:\n$$\n\\left(\\frac{2\\pi m_e e T}{h^2}\\right)^{3/2} = (4.176214 \\times 10^{18})^{3/2} \\mathrm{m}^{-3} = 8.55393 \\times 10^{27} \\mathrm{m}^{-3}\n$$\nCalculate the exponential term:\n$$\n\\exp(-13.60/2.00) = \\exp(-6.80) = 1.11391 \\times 10^{-3}\n$$\nNow assemble $Y$:\n$$\nY = \\frac{2}{1.00 \\times 10^{25}} \\times (8.55393 \\times 10^{27}) \\times (1.11391 \\times 10^{-3}) = 1.90591\n$$\nNext, calculate the partition functions:\n$Z_{\\mathrm{D, ground}} = 2$.\n$$\nZ_{\\mathrm{D, exc}} = 2 + 8 \\exp\\left(-\\frac{10.20}{2.00}\\right) + 18 \\exp\\left(-\\frac{12.09}{2.00}\\right)\n$$\n$$\nZ_{\\mathrm{D, exc}} = 2 + 8 \\exp(-5.1) + 18 \\exp(-6.045)\n$$\n$$\nZ_{\\mathrm{D, exc}} = 2 + 8(0.00609675) + 18(0.00236987) = 2 + 0.048774 + 0.042658 = 2.091432\n$$\nFinally, compute the ratio $R$:\n$$\nR = \\frac{Z_{\\mathrm{D, ground}}+Y}{Z_{\\mathrm{D, exc}}+Y} = \\frac{2 + 1.90591}{2.091432 + 1.90591} = \\frac{3.90591}{3.997342}\n$$\n$$\nR = 0.977127\n$$\nRounding to four significant figures, we get $0.9771$.", "answer": "$$\\boxed{0.9771}$$", "id": "3705161"}, {"introduction": "Real-world plasmas, both in fusion devices and astrophysical environments, are composed of elements that can exist in multiple ionization states simultaneously. This final practice advances from single-reaction calculations to the computational modeling of a complex system. You will develop a program to solve a set of coupled Saha equations to determine the complete charge-state distribution of a carbon impurity, a task that mirrors the methods used to analyze plasma spectroscopy and impurity transport in fusion research [@problem_id:3705162].", "problem": "You are asked to write a complete, runnable program that computes the equilibrium charge-state distribution for carbon in a non-degenerate, ideal plasma in local thermodynamic equilibrium, using only first principles from statistical mechanics and chemical equilibrium. The plasma is characterized by a given temperature $T$ and electron number density $n_e$. The target is the vector of ion fractions $f_{Z,q}$ for carbon with nuclear charge $Z=6$ and charge states $q=0,1,2,3,4,5,6$, where $f_{Z,q}$ is the fraction of carbon nuclei in charge state $q$ and $\\sum_{q=0}^{6} f_{Z,q} = 1$. You must not assume any pre-existing shortcut formulae; instead, your program must follow a principled derivation starting from core definitions.\n\nAssumptions and foundational base:\n- The plasma is in thermal and chemical equilibrium, dilute, non-degenerate, and well described by Maxwell–Boltzmann statistics at temperature $T$.\n- Ionization–recombination balance is governed by equality of chemical potentials at equilibrium for the reaction $C^{q} \\rightleftharpoons C^{q+1} + e^-$ for each $q \\in \\{0,\\dots,5\\}$.\n- For each species $s$ in the non-relativistic ideal gas limit, the chemical potential is the standard result from the canonical partition function expressed through the number density $n_s$, translational partition function via the thermal de Broglie wavelength, and the internal partition function.\n- The internal partition function for each carbon charge state is approximated by its ground-state contribution $U_q \\approx 1$ for all $q \\in \\{0,\\dots,6\\}$, and the electron spin degeneracy contributes a factor of $2$. This approximation isolates the dependence on $T$ and $n_e$ while remaining scientifically plausible across the test conditions of this problem.\n- The successive ionization energies for carbon are physical inputs taken as constants and must be used exactly as given below.\n\nData and constants:\n- Successive ionization energies $\\chi_q$ for $q \\in \\{0,\\dots,5\\}$, in electronvolts (eV): $\\chi_0 = 11.2603$, $\\chi_1 = 24.383$, $\\chi_2 = 47.8878$, $\\chi_3 = 64.4939$, $\\chi_4 = 392.0905$, $\\chi_5 = 489.993$.\n- Electron mass $m_e = 9.1093837015\\times 10^{-31}\\ \\mathrm{kg}$.\n- Boltzmann constant $k_{\\mathrm{B}} = 1.380649\\times 10^{-23}\\ \\mathrm{J/K}$.\n- Planck constant $h = 6.62607015\\times 10^{-34}\\ \\mathrm{J\\,s}$.\n- Electronvolt to joule conversion: $1\\ \\mathrm{eV} = 1.602176634\\times 10^{-19}\\ \\mathrm{J}$.\n\nYour program must:\n1. Starting from the chemical equilibrium condition $\\mu_q = \\mu_{q+1} + \\mu_e$ and the ideal, non-degenerate expressions for chemical potentials in terms of number densities and partition functions, derive the recurrence for the ratio $r_q = n_{q+1}/n_q$ for $q \\in \\{0,\\dots,5\\}$ as a function of $T$, $n_e$, $m_e$, $k_{\\mathrm{B}}$, $h$, $U_q$, $U_{q+1}$, and $\\chi_q$. Do not assume any shortcut formula; compute the thermal de Broglie wavelength from first principles and enforce detailed balance including the ionization energy $\\chi_q$.\n2. Compute all seven relative populations $\\{n_q\\}_{q=0}^{6}$ in terms of $r_q$ and a single multiplicative constant, then normalize to obtain fractions $f_{Z,q} = n_q / \\sum_{j=0}^{6} n_j$.\n3. Implement numerically stable logic to handle extreme parameter values without overflow or underflow. A recommended approach is to work in logarithms for intermediate products and shift by the maximum log before exponentiation.\n4. Round each fraction $f_{Z,q}$ to $6$ decimal places for output.\n\nUnits and input specification:\n- Temperature $T$ must be interpreted in kelvin ($\\mathrm{K}$).\n- Electron density $n_e$ must be interpreted in $\\mathrm{m}^{-3}$.\n- Ionization energies are provided in electronvolts and must be converted to joules before use.\n- The output fractions $f_{Z,q}$ are dimensionless.\n\nTest suite:\nYour program must compute results for the following five cases, in order:\n- Case $1$: $T = 5000\\ \\mathrm{K}$, $n_e = 10^{20}\\ \\mathrm{m}^{-3}$.\n- Case $2$: $T = 10^{6}\\ \\mathrm{K}$, $n_e = 10^{10}\\ \\mathrm{m}^{-3}$.\n- Case $3$: $T = 2\\times 10^{5}\\ \\mathrm{K}$, $n_e = 10^{28}\\ \\mathrm{m}^{-3}$.\n- Case $4$: $T = 10^{7}\\ \\mathrm{K}$, $n_e = 10^{20}\\ \\mathrm{m}^{-3}$.\n- Case $5$: $T = 3\\times 10^{4}\\ \\mathrm{K}$, $n_e = 10^{16}\\ \\mathrm{m}^{-3}$.\n\nRequired final output format:\n- Your program should produce a single line of output containing a list of results, one per test case, where each result is a list of seven floats $[f_{Z,0}, f_{Z,1}, f_{Z,2}, f_{Z,3}, f_{Z,4}, f_{Z,5}, f_{Z,6}]$ rounded to $6$ decimal places. The entire output must be a single line with comma-separated values and no spaces, for example: $[[0.1,0.2,0.3,0.4,0.0,0.0,0.0],[\\dots],\\dots]$.", "solution": "The problem is assessed to be valid. It is a well-posed, scientifically grounded problem in statistical plasma physics that is self-contained and free of contradictions. The provided data and constants are physically accurate, and the required derivation from first principles is a standard and rigorous procedure in statistical mechanics.\n\nThe objective is to compute the equilibrium charge-state distribution of carbon ions in a plasma at a given temperature $T$ and electron number density $n_e$. This distribution is described by the fractions $f_{Z,q}$ for each charge state $q \\in \\{0, 1, \\dots, 6\\}$, where $Z=6$ for carbon.\n\nThe foundation of the solution lies in the principle of chemical equilibrium for the ionization-recombination reactions occurring in the plasma. For each adjacent pair of ionization states, the reaction is:\n$$ C^q \\rightleftharpoons C^{q+1} + e^- $$\nIn local thermodynamic equilibrium (LTE), the chemical potentials of the reactants and products are balanced:\n$$ \\mu_q = \\mu_{q+1} + \\mu_e $$\nwhere $\\mu_q$, $\\mu_e$, and $\\mu_{q+1}$ are the chemical potentials of the carbon ion of charge $q$, the electron, and the carbon ion of charge $q+1$, respectively.\n\nFor a non-degenerate, non-relativistic ideal gas, the chemical potential of a species $s$ is given by:\n$$ \\mu_s = k_{\\mathrm{B}} T \\ln\\left(\\frac{n_s}{U_s} \\Lambda_s^3\\right) + E_s^{\\text{ground}} $$\nHere, $k_{\\mathrm{B}}$ is the Boltzmann constant, $T$ is the temperature, $n_s$ is the number density, $U_s$ is the internal partition function, $E_s^{\\text{ground}}$ is the ground-state energy, and $\\Lambda_s$ is the thermal de Broglie wavelength:\n$$ \\Lambda_s = \\frac{h}{\\sqrt{2 \\pi m_s k_{\\mathrm{B}} T}} $$\nwhere $h$ is the Planck constant and $m_s$ is the mass of the species.\n\nApplying this formula to each participant in the reaction and using the equilibrium condition leads to the Saha ionization equation:\n$$ \\frac{n_{q+1} n_e}{n_q} = \\frac{2 U_{q+1}}{U_q} \\left( \\frac{2 \\pi m_e k_{\\mathrm{B}} T}{h^2} \\right)^{3/2} \\exp\\left(-\\frac{\\chi_q}{k_{\\mathrm{B}} T}\\right) $$\nHere, the factor of 2 comes from the electron spin degeneracy ($U_e=2$), and we have used the approximation that the ion masses are nearly equal ($m_q \\approx m_{q+1}$) and thus their thermal wavelengths cancel. Using the problem's approximation $U_{q+1}/U_q \\approx 1$ and solving for the ratio $r_q = n_{q+1}/n_q$, we get the recurrence relation:\n$$ r_q = \\frac{2}{n_e} \\left( \\frac{2 \\pi m_e k_{\\mathrm{B}} T}{h^2} \\right)^{3/2} \\exp\\left(-\\frac{\\chi_q}{k_{\\mathrm{B}} T}\\right) \\quad \\text{for } q \\in \\{0, \\dots, 5\\} $$\nThe ionization energies $\\chi_q$ must be converted from electronvolts to joules.\n\nWith the ratios $r_q$ computed, we can find the relative populations of all charge states. Let $P_q$ be the population of state $q$ relative to the neutral state $q=0$. We set $P_0 = 1$.\n$$ P_0 = 1 $$\n$$ P_1 = r_0 P_0 = r_0 $$\n$$ P_2 = r_1 P_1 = r_1 r_0 $$\n$$ P_q = \\prod_{j=0}^{q-1} r_j \\quad \\text{for } q \\in \\{1, \\dots, 6\\} $$\nThe fraction $f_{Z,q}$ of ions in state $q$ is then the relative population $P_q$ divided by the sum of all relative populations:\n$$ f_{Z,q} = \\frac{P_q}{\\sum_{j=0}^{6} P_j} $$\nTo ensure numerical stability against overflow and underflow from the products and exponentials, computations are performed in the logarithmic domain. Let $L_q = \\ln(P_q)$. The recurrence becomes:\n$$ L_0 = 0 $$\n$$ L_q = L_{q-1} + \\ln(r_{q-1}) \\quad \\text{for } q \\in \\{1, \\dots, 6\\} $$\nwhere $\\ln(r_q) = \\ln(2) - \\ln(n_e) + \\frac{3}{2}\\ln\\left(\\frac{2 \\pi m_e k_{\\mathrm{B}} T}{h^2}\\right) - \\frac{\\chi_q}{k_{\\mathrm{B}} T}$.\nThe fractions are computed using a standard stable softmax approach. Let $L_{\\max} = \\max_{j}\\{L_j\\}$.\n$$ f_{Z,q} = \\frac{\\exp(L_q)}{\\sum_{j=0}^{6} \\exp(L_j)} = \\frac{\\exp(L_q - L_{\\max})}{\\sum_{j=0}^{6} \\exp(L_j - L_{\\max})} $$\nThis procedure guarantees that the arguments to the exponential function are non-positive, preventing overflow, and that at least one term in the sum is $1$, preventing underflow of the entire sum. Final fractions are rounded to $6$ decimal places as required.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the equilibrium charge-state distribution for carbon in a plasma\n    using the Saha ionization equation derived from first principles.\n    \"\"\"\n\n    # Define physical constants in SI units.\n    M_E = 9.1093837015e-31  # Electron mass (kg)\n    K_B = 1.380649e-23      # Boltzmann constant (J/K)\n    H = 6.62607015e-34       # Planck constant (J*s)\n    EV_TO_J = 1.602176634e-19 # Conversion factor from eV to Joules\n\n    # Successive ionization energies for carbon in eV.\n    # chi_q is the energy to go from state q to q+1.\n    chi_ev = np.array([\n        11.2603,    # C^0 -> C^1\n        24.383,     # C^1 -> C^2\n        47.8878,    # C^2 -> C^3\n        64.4939,    # C^3 -> C^4\n        392.0905,   # C^4 -> C^5\n        489.993     # C^5 -> C^6\n    ])\n\n    # Convert ionization energies to Joules.\n    chi_j = chi_ev * EV_TO_J\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        (5000, 1e20),      # Case 1: T in K, n_e in m^-3\n        (1e6, 1e10),       # Case 2\n        (2e5, 1e28),       # Case 3\n        (1e7, 1e20),       # Case 4\n        (3e4, 1e16)        # Case 5\n    ]\n\n    all_results = []\n\n    # Pre-calculate the constant part of the thermal factor's logarithm.\n    log_thermal_const = np.log(2) + 1.5 * (\n        np.log(2 * np.pi * M_E * K_B / (H**2))\n    )\n\n    for T, n_e in test_cases:\n        # Vector of log-ratios log(n_{q+1}/n_q).\n        log_r = np.zeros(6)\n\n        # Calculate the temperature-dependent part of the log-saha_factor.\n        log_saha_factor = log_thermal_const + 1.5 * np.log(T) - np.log(n_e)\n\n        # Boltzmann factor exponent.\n        boltzmann_exp = -chi_j / (K_B * T)\n        \n        # Calculate log of each ratio r_q.\n        log_r = log_saha_factor + boltzmann_exp\n\n        # Calculate log of relative populations log(P_q) where P_q = n_q / n_0.\n        # log_P[0] = log(P_0) = log(1) = 0.\n        log_P = np.zeros(7)\n        for q in range(6):\n            log_P[q + 1] = log_P[q] + log_r[q]\n        \n        # Normalize for numerical stability (softmax technique).\n        # Shift by max log-population to prevent overflow/underflow.\n        log_P_max = np.max(log_P)\n        norm_log_P = log_P - log_P_max\n        \n        # Exponentiate to get relative populations.\n        relative_populations = np.exp(norm_log_P)\n        \n        # Calculate the sum for normalization.\n        sum_populations = np.sum(relative_populations)\n        \n        # Compute the final fractions.\n        fractions = relative_populations / sum_populations\n        \n        # Round each fraction to 6 decimal places.\n        rounded_fractions = [round(f, 6) for f in fractions]\n        \n        # Format the result as a string without spaces inside the list.\n        case_str = f\"[{','.join(map(str, rounded_fractions))}]\"\n        all_results.append(case_str)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(all_results)}]\")\n\nsolve()\n```", "id": "3705162"}]}