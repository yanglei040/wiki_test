{"hands_on_practices": [{"introduction": "The first step in designing a quench protection system is to understand the urgency of the threat. When a section of a high-temperature superconductor (HTS) quenches, it rapidly heats up due to Joule heating from its own transport current. This exercise [@problem_id:3716143] guides you through a first-principles calculation using the adiabatic hotspot model to determine the maximum allowable time to detect a quench before the conductor's temperature exceeds a critical safety limit. Mastering this calculation provides a fundamental understanding of the time constraints that govern the entire protection strategy.", "problem": "In a nuclear fusion magnet employing High-Temperature Superconductors (HTS), a Rare Earth Barium Copper Oxide (REBCO) coated conductor is operated at an initial temperature $T_0=20\\,\\mathrm{K}$. During a quench event, a local normal zone forms and, prior to protective action, the hotspot region is assumed to be adiabatic and uniformly heated by Joule dissipation. Take the volumetric heat capacity to be constant and equal to $c(T)=3.5\\times 10^6\\,\\mathrm{J/m^3/K}$ and the effective normal-state electrical resistivity to be constant and equal to $\\rho(T)=2\\times 10^{-8}\\,\\Omega\\,\\mathrm{m}$ over the temperature range of interest. The engineering current density in the conductor is $J=150\\,\\mathrm{A/mm^2}$ and is maintained constant over the detection delay. Using only first-principles energy balance and the adiabatic assumption, determine the maximum allowable detection delay $\\Delta t_{\\mathrm{max}}$ such that the hotspot temperature remains below $T_{\\mathrm{hs}}=120\\,\\mathrm{K}$. Express your answer in $\\mathrm{s}$ and round to four significant figures.", "solution": "The problem statement is first subjected to a rigorous validation process.\n\n### Step 1: Extract Givens\n- Initial temperature: $T_0=20\\,\\mathrm{K}$\n- Maximum allowable hotspot temperature: $T_{\\mathrm{hs}}=120\\,\\mathrm{K}$\n- Volumetric heat capacity (constant): $c(T)=c=3.5\\times 10^6\\,\\mathrm{J/m^3/K}$\n- Effective normal-state electrical resistivity (constant): $\\rho(T)=\\rho=2\\times 10^{-8}\\,\\Omega\\,\\mathrm{m}$\n- Engineering current density (constant): $J=150\\,\\mathrm{A/mm^2}$\n- Primary assumptions: The hotspot region is adiabatic, uniformly heated, and the only heat source is Joule dissipation.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is evaluated against the established criteria for validity.\n\n- **Scientifically Grounded**: The problem is based on the fundamental principles of thermodynamics and electromagnetism, specifically the energy balance equation and Joule's law of heating. The context of a quench in a high-temperature superconducting (HTS) magnet for nuclear fusion is scientifically relevant and realistic. The physical quantities provided, such as temperatures, current density, resistivity, and heat capacity, are of plausible orders of magnitude for REBCO HTS conductors under such conditions, although the assumption of them being constant is a simplification commonly used for first-order approximations.\n- **Well-Posed**: The problem provides a clear initial state ($T_0$), a final state ($T_{\\mathrm{hs}}$), and the physical laws governing the transition (adiabatic Joule heating). It asks for a single, uniquely determined quantity, the maximum allowable time ($\\Delta t_{\\mathrm{max}}$). The problem is self-contained and provides all necessary information for a solution under the given assumptions.\n- **Objective**: The problem is stated in precise, quantitative terms, free from ambiguity, subjectivity, or opinion.\n\n### Step 3: Verdict and Action\nThe problem is scientifically grounded, well-posed, and objective. It contains no contradictions, missing information, or violations of physical principles under the specified simplifying assumptions. Therefore, the problem is deemed **valid**. A solution will be derived.\n\nThe physical principle governing the temperature rise in the hotspot is the first law of thermodynamics applied to an adiabatic system. For a unit volume of the conductor, the rate of change of its internal energy is equal to the rate at which heat is generated within it. The internal energy change rate per unit volume is given by $c \\frac{dT}{dt}$, where $c$ is the volumetric heat capacity and $T$ is the temperature. The heat generation rate per unit volume (power density) from Joule heating is given by $q''' = \\rho J^2$, where $\\rho$ is the electrical resistivity and $J$ is the current density.\n\nEquating these two rates gives the governing differential equation for the temperature $T$ as a function of time $t$:\n$$c \\frac{dT}{dt} = \\rho J^2$$\nThis is a first-order ordinary differential equation. To find the total time required for the temperature to rise from its initial value $T_0$ to the maximum allowed hotspot temperature $T_{\\mathrm{hs}}$, we can separate variables and integrate.\n$$c \\, dT = \\rho J^2 \\, dt$$\nThe integration is performed over the time interval from $t=0$ to $t=\\Delta t_{\\mathrm{max}}$ and the corresponding temperature interval from $T=T_0$ to $T=T_{\\mathrm{hs}}$:\n$$\\int_{T_0}^{T_{\\mathrm{hs}}} c \\, dT = \\int_{0}^{\\Delta t_{\\mathrm{max}}} \\rho J^2 \\, dt$$\nThe problem states that the volumetric heat capacity $c$, the resistivity $\\rho$, and the current density $J$ are all constant over the process. Therefore, they can be taken outside the integrals:\n$$c \\int_{T_0}^{T_{\\mathrm{hs}}} dT = \\rho J^2 \\int_{0}^{\\Delta t_{\\mathrm{max}}} dt$$\nPerforming the integration yields:\n$$c [T]_{T_0}^{T_{\\mathrm{hs}}} = \\rho J^2 [t]_{0}^{\\Delta t_{\\mathrm{max}}}$$\n$$c (T_{\\mathrm{hs}} - T_0) = \\rho J^2 (\\Delta t_{\\mathrm{max}} - 0)$$\nWe are asked to find the maximum allowable detection delay, $\\Delta t_{\\mathrm{max}}$. Solving for $\\Delta t_{\\mathrm{max}}$ gives the symbolic expression:\n$$\\Delta t_{\\mathrm{max}} = \\frac{c(T_{\\mathrm{hs}} - T_0)}{\\rho J^2}$$\nBefore substituting the numerical values, we must ensure all quantities are in a consistent set of units (SI units).\nThe given values are:\n- $c = 3.5\\times 10^6\\,\\mathrm{J/m^3/K}$\n- $\\rho = 2\\times 10^{-8}\\,\\Omega\\,\\mathrm{m}$\n- $T_0 = 20\\,\\mathrm{K}$\n- $T_{\\mathrm{hs}} = 120\\,\\mathrm{K}$\n- $J = 150\\,\\mathrm{A/mm^2}$\n\nThe current density $J$ must be converted from $\\mathrm{A/mm^2}$ to $\\mathrm{A/m^2}$:\n$$1\\,\\mathrm{mm} = 10^{-3}\\,\\mathrm{m} \\implies 1\\,\\mathrm{mm^2} = (10^{-3}\\,\\mathrm{m})^2 = 10^{-6}\\,\\mathrm{m^2}$$\n$$J = 150\\,\\frac{\\mathrm{A}}{\\mathrm{mm^2}} = 150\\,\\frac{\\mathrm{A}}{10^{-6}\\,\\mathrm{m^2}} = 150 \\times 10^6\\,\\frac{\\mathrm{A}}{\\mathrm{m^2}} = 1.5 \\times 10^8\\,\\mathrm{A/m^2}$$\nNow, we can substitute the numerical values into the expression for $\\Delta t_{\\mathrm{max}}$:\n$$\\Delta t_{\\mathrm{max}} = \\frac{(3.5\\times 10^6\\,\\mathrm{J/m^3/K})(120\\,\\mathrm{K} - 20\\,\\mathrm{K})}{(2\\times 10^{-8}\\,\\Omega\\,\\mathrm{m})(1.5 \\times 10^8\\,\\mathrm{A/m^2})^2}$$\nFirst, calculate the temperature difference and the square of the current density:\n$$T_{\\mathrm{hs}} - T_0 = 100\\,\\mathrm{K}$$\n$$J^2 = (1.5 \\times 10^8)^2\\,\\mathrm{A^2/m^4} = 2.25 \\times 10^{16}\\,\\mathrm{A^2/m^4}$$\nNext, calculate the numerator and the denominator:\nNumerator:\n$$c(T_{\\mathrm{hs}} - T_0) = (3.5\\times 10^6) \\times 100 = 3.5 \\times 10^8\\,\\mathrm{J/m^3}$$\nDenominator:\n$$\\rho J^2 = (2\\times 10^{-8}) \\times (2.25 \\times 10^{16}) = 4.5 \\times 10^8\\,\\mathrm{W/m^3}$$\nNote that the unit of the denominator is $\\Omega \\cdot \\mathrm{m} \\cdot (\\mathrm{A/m^2})^2 = \\Omega \\cdot \\mathrm{A}^2/\\mathrm{m}^3 = \\mathrm{W/m^3}$, which is power density, as expected.\nFinally, calculate the ratio:\n$$\\Delta t_{\\mathrm{max}} = \\frac{3.5 \\times 10^8\\,\\mathrm{J/m^3}}{4.5 \\times 10^8\\,\\mathrm{W/m^3}} = \\frac{3.5}{4.5}\\,\\mathrm{s} = \\frac{7}{9}\\,\\mathrm{s}$$\nAs a decimal, this is approximately $0.77777...\\,\\mathrm{s}$. The problem requires the answer to be rounded to four significant figures.\n$$\\Delta t_{\\mathrm{max}} \\approx 0.7778\\,\\mathrm{s}$$\nThis value represents the maximum time that can pass between the initiation of the quench and the activation of a protective system before the conductor's hotspot temperature exceeds the specified safety limit of $120\\,\\mathrm{K}$.", "answer": "$$\\boxed{0.7778}$$", "id": "3716143"}, {"introduction": "A reliable quench detection system must not only be fast but also robust, capable of distinguishing a true quench from spurious signals common in a fusion environment. During plasma disruptions, rapid current changes induce large inductive voltages that can be mistaken for a resistive quench signal, potentially causing a false trigger. This advanced practice [@problem_id:3716117] challenges you to design a detection threshold that balances sensitivity with robustness, ensuring the system ignores transient noise while reliably capturing the signature of a minimal quench event.", "problem": "A High Temperature Superconducting (HTS) toroidal field coil in a nuclear fusion device is monitored for quench using differential voltage taps across two geometrically symmetric half-segments forming a bridge intended to cancel inductive voltage during plasma transients. The two half-segments have nominal inductance $L_{\\text{leg}}$ but a fabrication mismatch yields a relative inductance asymmetry $\\epsilon$, so that the residual inductance driving imbalance is $\\Delta L = \\epsilon L_{\\text{leg}}$. During a plasma disruption, the transport current $I(t)$ in the coil experiences a rapid ramp characterized by a bounded time derivative approximated as a rectangular pulse of amplitude $D$ and duration $\\Delta t$. The detection electronics apply a first-order low-pass filter of time constant $\\tau$ to the differential signal and then compare it against a constant threshold $V_{\\text{th}}$.\n\nAssume the following physically realistic parameters:\n- Segment inductance $L_{\\text{leg}} = 6.0 \\times 10^{-3}\\ \\mathrm{H}$ and relative asymmetry $\\epsilon = 8.0 \\times 10^{-3}$, so $\\Delta L = \\epsilon L_{\\text{leg}}$.\n- Disruption-induced current ramp approximated by a rectangular $dI/dt$ pulse with amplitude $D = 1.5 \\times 10^{6}\\ \\mathrm{A/s}$ and duration $\\Delta t = 3.0 \\times 10^{-3}\\ \\mathrm{s}$.\n- Detection chain modeled as a first-order low-pass with time constant $\\tau = 1.0 \\times 10^{-2}\\ \\mathrm{s}$.\n- Minimum quench signature: a normal zone of length $\\ell_{q,\\min} = 3.0 \\times 10^{-2}\\ \\mathrm{m}$ appears at operating current $I_{0} = 3.0 \\times 10^{4}\\ \\mathrm{A}$. The effective normal-state resistance per unit length of the conductor stack is $r_{n} = 4.0 \\times 10^{-2}\\ \\Omega/\\mathrm{m}$, yielding a resistive voltage $V_{R,\\min} = I_{0} r_{n} \\ell_{q,\\min}$ that persists for times long compared to $\\tau$.\n- To ensure robustness under transient imbalance, require a safety margin factor $m = 1.25$ multiplying the maximum filtered inductive imbalance when setting $V_{\\text{th}}$.\n\nStarting from Faraday’s law of induction and the linear time-invariant response of a first-order low-pass filter to a rectangular input, compute the maximum inductive voltage across the differential segment during the disruption transient, propagate it through the filter to obtain the peak filtered imbalance, and then determine the smallest constant threshold $V_{\\text{th}}$ that simultaneously avoids false triggers under the disruption and guarantees detection of the specified minimal resistive quench. Round your final numeric threshold to four significant figures and express your answer in volts.", "solution": "The problem requires the determination of the smallest constant threshold voltage, $V_{\\text{th}}$, for a quench detection system in a High Temperature Superconducting (HTS) coil. This threshold must satisfy two competing requirements: it must be high enough to avoid false triggers caused by inductive voltage imbalances during fast current transients (like a plasma disruption), and low enough to guarantee the detection of a minimal quench event.\n\nFirst, we validate the problem statement.\n\n**Step 1: Extract Givens**\n- Segment inductance: $L_{\\text{leg}} = 6.0 \\times 10^{-3}\\ \\mathrm{H}$\n- Relative inductance asymmetry: $\\epsilon = 8.0 \\times 10^{-3}$\n- Residual inductance imbalance: $\\Delta L = \\epsilon L_{\\text{leg}}$\n- Disruption-induced current ramp amplitude: $D = 1.5 \\times 10^{6}\\ \\mathrm{A/s}$\n- Disruption-induced current ramp duration: $\\Delta t = 3.0 \\times 10^{-3}\\ \\mathrm{s}$\n- Detection filter time constant: $\\tau = 1.0 \\times 10^{-2}\\ \\mathrm{s}$\n- Minimum quench length: $\\ell_{q,\\min} = 3.0 \\times 10^{-2}\\ \\mathrm{m}$\n- Operating current: $I_{0} = 3.0 \\times 10^{4}\\ \\mathrm{A}$\n- Normal-state resistance per unit length: $r_{n} = 4.0 \\times 10^{-2}\\ \\Omega/\\mathrm{m}$\n- Minimum resistive voltage: $V_{R,\\min} = I_{0} r_{n} \\ell_{q,\\min}$\n- Safety margin factor: $m = 1.25$\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is scientifically grounded in the principles of electromagnetism (Faraday's law) and linear time-invariant (LTI) system theory (first-order filter response). The scenario of quench detection in superconducting magnets using a balanced bridge and the issue of inductive imbalance during transients is a standard engineering problem in applied superconductivity for fusion devices. The problem is well-posed, providing all necessary parameters and a clear objective. The language is objective and unambiguous. The given values are physically plausible for a large-scale HTS magnet system. The problem does not violate any of the invalidity criteria.\n\n**Step 3: Verdict and Action**\nThe problem is deemed valid. A full solution will be provided.\n\nThe solution proceeds by defining the two constraints on $V_{\\text{th}}$ and finding the minimum value that satisfies both.\n\n**Constraint 1: Avoidance of False Triggers**\nDuring a plasma disruption, the rapid change in current, $\\frac{dI}{dt}$, induces a spurious voltage across the differential bridge due to the inductance mismatch, $\\Delta L$. According to Faraday's law of induction, this voltage is:\n$$V_{\\text{ind}}(t) = \\Delta L \\frac{dI}{dt}(t)$$\nThe problem approximates $\\frac{dI}{dt}(t)$ as a rectangular pulse of amplitude $D$ and duration $\\Delta t$. Therefore, the inductive input voltage to the filter is also a rectangular pulse:\n$$V_{\\text{ind}}(t) = \\begin{cases} V_{\\text{pulse}} & \\text{for } 0 \\le t \\le \\Delta t \\\\ 0 & \\text{otherwise} \\end{cases}$$\nwhere the pulse amplitude $V_{\\text{pulse}}$ is:\n$$V_{\\text{pulse}} = \\Delta L \\cdot D = (\\epsilon L_{\\text{leg}}) D$$\nFirst, we calculate the numerical value of $\\Delta L$:\n$$\\Delta L = (8.0 \\times 10^{-3}) \\cdot (6.0 \\times 10^{-3}\\ \\mathrm{H}) = 4.8 \\times 10^{-5}\\ \\mathrm{H}$$\nThen, we calculate the amplitude of the inductive voltage pulse:\n$$V_{\\text{pulse}} = (4.8 \\times 10^{-5}\\ \\mathrm{H}) \\cdot (1.5 \\times 10^{6}\\ \\mathrm{A/s}) = 72\\ \\mathrm{V}$$\nThis voltage pulse, $V_{\\text{ind}}(t)$, is passed through a first-order low-pass filter with time constant $\\tau$. The output voltage of the filter, $V_{\\text{filt}}(t)$, in response to the input pulse (assuming $V_{\\text{filt}}(0)=0$) is:\n$$V_{\\text{filt}}(t) = V_{\\text{pulse}} (1 - \\exp(-t/\\tau)) \\quad \\text{for } 0 \\le t \\le \\Delta t$$\nThe output voltage will be maximum at the end of the pulse, at $t = \\Delta t$. This peak filtered voltage, $V_{\\text{filt,peak}}$, is:\n$$V_{\\text{filt,peak}} = V_{\\text{pulse}} (1 - \\exp(-\\Delta t/\\tau))$$\nSubstituting the given values:\n$$V_{\\text{filt,peak}} = 72 \\cdot (1 - \\exp(-(3.0 \\times 10^{-3}) / (1.0 \\times 10^{-2}))) = 72 \\cdot (1 - \\exp(-0.3))\\ \\mathrm{V}$$\nTo prevent a false trigger, the detection threshold $V_{\\text{th}}$ must be greater than this peak spurious signal, including a safety margin $m$.\n$$V_{\\text{th}} \\ge m \\cdot V_{\\text{filt,peak}}$$\n\n**Constraint 2: Guaranteed Detection of a Minimal Quench**\nA minimal quench event creates a resistive voltage, $V_{R,\\min}$, given by:\n$$V_{R,\\min} = I_{0} r_{n} \\ell_{q,\\min}$$\nSubstituting the given values:\n$$V_{R,\\min} = (3.0 \\times 10^{4}\\ \\mathrm{A}) \\cdot (4.0 \\times 10^{-2}\\ \\Omega/\\mathrm{m}) \\cdot (3.0 \\times 10^{-2}\\ \\mathrm{m}) = 36\\ \\mathrm{V}$$\nThe problem states that this voltage \"persists for times long compared to $\\tau$\". This implies that the quench voltage acts as a step input to the filter. For a step input of amplitude $V_{R,\\min}$, the filtered output will asymptotically approach $V_{R,\\min}$. To guarantee detection, the threshold $V_{\\text{th}}$ must be less than or equal to the signal level produced by the minimal quench. Since the signal will eventually reach $V_{R,\\min}$, the condition for guaranteed detection is:\n$$V_{\\text{th}} \\le V_{R,\\min}$$\n\n**Determining the Threshold Voltage $V_{\\text{th}}$**\nWe have a valid range for the threshold:\n$$m \\cdot V_{\\text{filt,peak}} \\le V_{\\text{th}} \\le V_{R,\\min}$$\nThe problem asks for the smallest possible constant threshold. This corresponds to the lower bound of the valid range:\n$$V_{\\text{th}} = m \\cdot V_{\\text{filt,peak}} = m \\cdot V_{\\text{pulse}} (1 - \\exp(-\\Delta t/\\tau))$$\nWe must first verify that a solution exists by checking if $m \\cdot V_{\\text{filt,peak}} \\le V_{R,\\min}$.\nLet's calculate the numerical value for the lower bound:\n$$V_{\\text{th}} = 1.25 \\cdot (72\\ \\mathrm{V}) \\cdot (1 - \\exp(-0.3))$$\n$$V_{\\text{th}} = 90 \\cdot (1 - \\exp(-0.3))\\ \\mathrm{V}$$\nUsing a calculator, $1 - \\exp(-0.3) \\approx 0.25918178$.\n$$V_{\\text{th}} \\approx 90 \\cdot 0.25918178 \\approx 23.32636\\ \\mathrm{V}$$\nThe consistency check is $23.32636\\ \\mathrm{V} \\le 36\\ \\mathrm{V}$, which is true. Therefore, a valid threshold exists.\n\nThe smallest threshold is the calculated value, $V_{\\text{th}} \\approx 23.32636\\ \\mathrm{V}$. The problem requires rounding the final answer to four significant figures.\n$$V_{\\text{th}} \\approx 23.33\\ \\mathrm{V}$$\nThis value satisfies both conditions: it is high enough to be $1.25$ times the peak inductive noise, and it is low enough to be triggered by the $36\\ \\mathrm{V}$ signal from a minimal quench.", "answer": "$$\\boxed{23.33}$$", "id": "3716117"}, {"introduction": "Beyond simply detecting a quench, localizing its origin within a large magnet is crucial for efficient protection and component assessment. By instrumenting the coil with multiple voltage taps, we can transform the localization challenge into a data-driven inverse problem. In this hands-on coding practice [@problem_id:3716128], you will develop and apply a non-negative least squares (NNLS) algorithm to analyze time-series data and pinpoint the resistive segment, gaining practical experience in the signal processing techniques that underpin advanced quench management systems.", "problem": "A series High-Temperature Superconductor (HTS) coil for nuclear fusion applications is segmented by voltage taps so that the tap-to-tap voltage across each segment can be measured over time. Under the assumption of uniform transport current through all series segments, and negligible inter-segment coupling beyond self-inductance, each segment obeys the lumped circuit relation derived from Ohm’s law and Faraday’s law: for segment index $i \\in \\{0,1,\\dots,N-1\\}$ at time sample index $k \\in \\{0,1,\\dots,K-1\\}$, the measured voltage $v_{i,k}$ can be modeled as\n$$\nv_{i,k} = L_i \\,\\frac{dI}{dt}\\Big|_{k} + r_i \\, I_k + \\epsilon_{i,k},\n$$\nwhere $L_i$ is the segment self-inductance, $I_k$ is the transport current, $\\frac{dI}{dt}\\big|_{k}$ is the current ramp rate, $r_i \\ge 0$ is the effective resistive contribution of segment $i$ due to a normal (non-superconducting) zone, and $\\epsilon_{i,k}$ is measurement noise. Over a short window, it is reasonable to assume $r_i$ is time-invariant while $I_k$ and $\\frac{dI}{dt}\\big|_{k}$ vary with $k$ according to the power supply. A quench is declared in any segment $i$ for which the estimated resistance $\\hat{r}_i$ exceeds a decision threshold $\\tau$ in $\\mathrm{ohm}$.\n\nFormulate the inverse problem to estimate the vector of segment resistances $\\mathbf{r} = [r_0,\\dots,r_{N-1}]^\\top$ from measured voltages by removing inductive contributions and solving for $r_i$ in a statistically consistent manner based on well-tested laws and definitions. Then implement a program that:\n- Computes a non-negative least squares estimate for each segment $i$ using stacked time samples, consistent with physical non-negativity $r_i \\ge 0$.\n- Declares quench segments as those indices $i$ where $\\hat{r}_i \\ge \\tau$.\n- Produces the list of zero-based quench indices for each test case.\n\nAll quantities carry the following units: $v_{i,k}$ in $\\mathrm{V}$, $L_i$ in $\\mathrm{H}$, $I_k$ in $\\mathrm{A}$, $\\frac{dI}{dt}\\big|_{k}$ in $\\mathrm{A/s}$, and $r_i$ in $\\mathrm{ohm}$. The decision threshold $\\tau$ must be interpreted in $\\mathrm{ohm}$. No angles are involved.\n\nYou are given a test suite comprising three cases. For each case, use the provided parameters exactly, and return the list of indices of segments declared quenched. The index convention is zero-based. The final output must be a single line containing the three results as a comma-separated list enclosed in square brackets, with each result itself being a comma-separated list enclosed in square brackets. For example, a valid output format is $[[x_1,x_2],[y_1],[z_1,z_2,z_3]]$ with no spaces.\n\nTest Suite:\n- Case A (happy path, single quench, monotonic current, positive ramp):\n    - Number of segments: $N = 6$.\n    - Segment inductances: $\\mathbf{L} = [\\,0.00005,\\,0.00005,\\,0.00005,\\,0.00005,\\,0.00005,\\,0.00005\\,]$ in $\\mathrm{H}$.\n    - Time samples: $K = 6$.\n    - Currents: $\\mathbf{I} = [\\,200,\\,220,\\,240,\\,260,\\,280,\\,300\\,]$ in $\\mathrm{A}$.\n    - Ramp rates: $\\frac{d\\mathbf{I}}{dt} = [\\,100,\\,100,\\,100,\\,100,\\,100,\\,100\\,]$ in $\\mathrm{A/s}$.\n    - Measured segment voltages (rows are segments $i=0,\\dots,5$, columns are time samples $k=0,\\dots,5$), in $\\mathrm{V}$:\n      $$\n      \\begin{aligned}\n      &\\mathbf{V}_{0,:} = [\\,0.005,\\,0.005,\\,0.005,\\,0.005,\\,0.005,\\,0.005\\,],\\\\\n      &\\mathbf{V}_{1,:} = [\\,0.005,\\,0.005,\\,0.005,\\,0.005,\\,0.005,\\,0.005\\,],\\\\\n      &\\mathbf{V}_{2,:} = [\\,2.405,\\,2.645,\\,2.885,\\,3.125,\\,3.365,\\,3.605\\,],\\\\\n      &\\mathbf{V}_{3,:} = [\\,0.005,\\,0.005,\\,0.005,\\,0.005,\\,0.005,\\,0.005\\,],\\\\\n      &\\mathbf{V}_{4,:} = [\\,0.005,\\,0.005,\\,0.005,\\,0.005,\\,0.005,\\,0.005\\,],\\\\\n      &\\mathbf{V}_{5,:} = [\\,0.005,\\,0.005,\\,0.005,\\,0.005,\\,0.005,\\,0.005\\,].\n      \\end{aligned}\n      $$\n    - Decision threshold: $\\tau = 0.001$ in $\\mathrm{ohm}$.\n\n- Case B (boundary condition, includes zero current samples, small resistance quench):\n    - Number of segments: $N = 6$.\n    - Segment inductances: $\\mathbf{L} = [\\,0.00005,\\,0.00005,\\,0.00005,\\,0.00005,\\,0.00005,\\,0.00005\\,]$ in $\\mathrm{H}$.\n    - Time samples: $K = 6$.\n    - Currents: $\\mathbf{I} = [\\,0,\\,50,\\,100,\\,150,\\,200,\\,250\\,]$ in $\\mathrm{A}$.\n    - Ramp rates: $\\frac{d\\mathbf{I}}{dt} = [\\,80,\\,80,\\,80,\\,80,\\,80,\\,80\\,]$ in $\\mathrm{A/s}$.\n    - Measured segment voltages, in $\\mathrm{V}$:\n      $$\n      \\begin{aligned}\n      &\\mathbf{V}_{0,:} = [\\,0.004,\\,0.254,\\,0.504,\\,0.754,\\,1.004,\\,1.254\\,],\\\\\n      &\\mathbf{V}_{1,:} = [\\,0.004,\\,0.004,\\,0.004,\\,0.004,\\,0.004,\\,0.004\\,],\\\\\n      &\\mathbf{V}_{2,:} = [\\,0.004,\\,0.004,\\,0.004,\\,0.004,\\,0.004,\\,0.004\\,],\\\\\n      &\\mathbf{V}_{3,:} = [\\,0.004,\\,0.004,\\,0.004,\\,0.004,\\,0.004,\\,0.004\\,],\\\\\n      &\\mathbf{V}_{4,:} = [\\,0.004,\\,0.004,\\,0.004,\\,0.004,\\,0.004,\\,0.004\\,],\\\\\n      &\\mathbf{V}_{5,:} = [\\,0.004,\\,0.004,\\,0.004,\\,0.004,\\,0.004,\\,0.004\\,].\n      \\end{aligned}\n      $$\n    - Decision threshold: $\\tau = 0.001$ in $\\mathrm{ohm}$.\n\n- Case C (edge case, multiple quench segments, decreasing current, negative ramp):\n    - Number of segments: $N = 6$.\n    - Segment inductances: $\\mathbf{L} = [\\,0.00003,\\,0.00003,\\,0.00003,\\,0.00003,\\,0.00003,\\,0.00003\\,]$ in $\\mathrm{H}$.\n    - Time samples: $K = 6$.\n    - Currents: $\\mathbf{I} = [\\,300,\\,280,\\,260,\\,240,\\,220,\\,200\\,]$ in $\\mathrm{A}$.\n    - Ramp rates: $\\frac{d\\mathbf{I}}{dt} = [\\,-80,\\,-80,\\,-80,\\,-80,\\,-80,\\,-80\\,]$ in $\\mathrm{A/s}$.\n    - Measured segment voltages, in $\\mathrm{V}$:\n      $$\n      \\begin{aligned}\n      &\\mathbf{V}_{0,:} = [\\,2.0976,\\,1.9576,\\,1.8176,\\,1.6776,\\,1.5376,\\,1.3976\\,],\\\\\n      &\\mathbf{V}_{1,:} = [\\,-0.0024,\\,-0.0024,\\,-0.0024,\\,-0.0024,\\,-0.0024,\\,-0.0024\\,],\\\\\n      &\\mathbf{V}_{2,:} = [\\,1.1976,\\,1.1176,\\,1.0376,\\,0.9576,\\,0.8776,\\,0.7976\\,],\\\\\n      &\\mathbf{V}_{3,:} = [\\,-0.0024,\\,-0.0024,\\,-0.0024,\\,-0.0024,\\,-0.0024,\\,-0.0024\\,],\\\\\n      &\\mathbf{V}_{4,:} = [\\,1.7976,\\,1.6776,\\,1.5576,\\,1.4376,\\,1.3176,\\,1.1976\\,],\\\\\n      &\\mathbf{V}_{5,:} = [\\,-0.0024,\\,-0.0024,\\,-0.0024,\\,-0.0024,\\,-0.0024,\\,-0.0024\\,].\n      \\end{aligned}\n      $$\n    - Decision threshold: $\\tau = 0.001$ in $\\mathrm{ohm}$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets and with no spaces, where each element is the zero-based index list of quench segments for the corresponding test case, for example $[[i\\_1,i\\_2],[j\\_1],[k\\_1,k\\_2]]$.", "solution": "The problem requires the estimation of segment resistances, $\\mathbf{r} = [r_0, \\dots, r_{N-1}]^\\top$, in a series-connected High-Temperature Superconductor (HTS) coil to detect quench events. A quench corresponds to a segment transitioning from a superconducting state (zero resistance) to a normal, resistive state.\n\nThe physical model for the voltage $v_{i,k}$ across segment $i$ at time sample $k$ is given by the lumped-parameter circuit equation:\n$$\nv_{i,k} = L_i \\,\\frac{dI}{dt}\\Big|_{k} + r_i \\, I_k + \\epsilon_{i,k}\n$$\nHere, $v_{i,k}$ is the measured voltage, $L_i$ is the segment's self-inductance, $I_k$ is the transport current, $\\frac{dI}{dt}\\big|_{k}$ is the current's rate of change, $r_i$ is the time-invariant resistance to be estimated, and $\\epsilon_{i,k}$ represents measurement noise. The resistance $r_i$ is physically constrained to be non-negative, i.e., $r_i \\ge 0$.\n\nTo formulate the inverse problem for estimating $r_i$, we can treat all terms not involving $r_i$ as known quantities. The inductive voltage component, $v_{\\text{ind}, i, k} = L_i \\frac{dI}{dt}\\big|_{k}$, can be calculated directly from the provided data. By subtracting this component from the measured voltage $v_{i,k}$, we define a \"corrected voltage,\" $v'_{i,k}$, which isolates the resistive contribution and noise:\n$$\nv'_{i,k} := v_{i,k} - L_i \\,\\frac{dI}{dt}\\Big|_{k} = r_i \\, I_k + \\epsilon_{i,k}\n$$\nThis equation represents a simple linear relationship between the corrected voltage $v'_{i,k}$ and the current $I_k$, with the resistance $r_i$ as the unknown coefficient. For each segment $i$, we have a system of $K$ such linear equations, one for each time sample $k \\in \\{0, 1, \\dots, K-1\\}$. This system can be expressed in matrix form. Let $\\mathbf{v}'_i$ be the $K \\times 1$ column vector of corrected voltages for segment $i$, $\\mathbf{I}$ be the $K \\times 1$ column vector of currents, and $\\boldsymbol{\\epsilon}_i$ be the $K \\times 1$ column vector of noise terms:\n$$\n\\mathbf{v}'_i = \\begin{bmatrix} v'_{i,0} \\\\ v'_{i,1} \\\\ \\vdots \\\\ v'_{i,K-1} \\end{bmatrix}, \\quad\n\\mathbf{I} = \\begin{bmatrix} I_0 \\\\ I_1 \\\\ \\vdots \\\\ I_{K-1} \\end{bmatrix}, \\quad\n\\boldsymbol{\\epsilon}_i = \\begin{bmatrix} \\epsilon_{i,0} \\\\ \\epsilon_{i,1} \\\\ \\vdots \\\\ \\epsilon_{i,K-1} \\end{bmatrix}\n$$\nThe system of equations for segment $i$ becomes:\n$$\n\\mathbf{v}'_i = \\mathbf{I} r_i + \\boldsymbol{\\epsilon}_i\n$$\nThis is an overdetermined system of linear equations for the scalar unknown $r_i$. A statistically robust method for estimating $r_i$ is the method of least squares, which seeks the value $\\hat{r}_i$ that minimizes the sum of the squared residuals (noise terms). Incorporating the physical constraint $r_i \\ge 0$, we formulate this as a Non-Negative Least Squares (NNLS) problem:\n$$\n\\hat{r}_i = \\arg\\min_{r_i \\ge 0} \\sum_{k=0}^{K-1} \\left( v'_{i,k} - r_i I_k \\right)^2 = \\arg\\min_{r_i \\ge 0} \\|\\mathbf{v}'_i - \\mathbf{I} r_i \\|_2^2\n$$\nThis is a standard convex optimization problem, which guarantees a unique solution. The problem can be solved efficiently using established numerical algorithms, such as the one available in the `scipy.optimize.nnls` function.\n\nThe overall algorithm for quench detection is as follows:\nFor each test case:\n1.  Initialize an empty list to store the indices of quenched segments.\n2.  Iterate through each segment $i$ from $0$ to $N-1$.\n3.  For each segment $i$, construct the vector of corrected voltages, $\\mathbf{v}'_i$, by computing $\\mathbf{v}_{i,:} - L_i \\frac{d\\mathbf{I}}{dt}$, where $\\mathbf{v}_{i,:}$ is the vector of measured voltages for segment $i$, $L_i$ is its inductance, and $\\frac{d\\mathbf{I}}{dt}$ is the vector of current ramp rates.\n4.  Set up the NNLS problem where the matrix $\\mathbf{A}$ is the column vector of currents $\\mathbf{I}$, and the vector $\\mathbf{b}$ is the corrected voltage vector $\\mathbf{v}'_i$.\n5.  Solve for the non-negative resistance estimate $\\hat{r}_i$ using an NNLS solver.\n6.  Compare the estimate $\\hat{r}_i$ to the decision threshold $\\tau$. If $\\hat{r}_i \\ge \\tau$, the segment is declared to have quenched, and its index $i$ is recorded.\n7.  After processing all segments, the list of recorded indices constitutes the result for the test case.\n\nThis procedure is applied to each of the three test cases provided. The final output is an aggregation of the results from each case, formatted as specified.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import nnls\n\ndef solve():\n    \"\"\"\n    Solves the quench detection problem for the provided test suite.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case A\n        {\n            \"N\": 6,\n            \"L\": np.array([0.00005, 0.00005, 0.00005, 0.00005, 0.00005, 0.00005]),\n            \"I\": np.array([200, 220, 240, 260, 280, 300]),\n            \"dIdt\": np.array([100, 100, 100, 100, 100, 100]),\n            \"V\": np.array([\n                [0.005, 0.005, 0.005, 0.005, 0.005, 0.005],\n                [0.005, 0.005, 0.005, 0.005, 0.005, 0.005],\n                [2.405, 2.645, 2.885, 3.125, 3.365, 3.605],\n                [0.005, 0.005, 0.005, 0.005, 0.005, 0.005],\n                [0.005, 0.005, 0.005, 0.005, 0.005, 0.005],\n                [0.005, 0.005, 0.005, 0.005, 0.005, 0.005],\n            ]),\n            \"tau\": 0.001\n        },\n        # Case B\n        {\n            \"N\": 6,\n            \"L\": np.array([0.00005, 0.00005, 0.00005, 0.00005, 0.00005, 0.00005]),\n            \"I\": np.array([0, 50, 100, 150, 200, 250]),\n            \"dIdt\": np.array([80, 80, 80, 80, 80, 80]),\n            \"V\": np.array([\n                [0.004, 0.254, 0.504, 0.754, 1.004, 1.254],\n                [0.004, 0.004, 0.004, 0.004, 0.004, 0.004],\n                [0.004, 0.004, 0.004, 0.004, 0.004, 0.004],\n                [0.004, 0.004, 0.004, 0.004, 0.004, 0.004],\n                [0.004, 0.004, 0.004, 0.004, 0.004, 0.004],\n                [0.004, 0.004, 0.004, 0.004, 0.004, 0.004],\n            ]),\n            \"tau\": 0.001\n        },\n        # Case C\n        {\n            \"N\": 6,\n            \"L\": np.array([0.00003, 0.00003, 0.00003, 0.00003, 0.00003, 0.00003]),\n            \"I\": np.array([300, 280, 260, 240, 220, 200]),\n            \"dIdt\": np.array([-80, -80, -80, -80, -80, -80]),\n            \"V\": np.array([\n                [2.0976, 1.9576, 1.8176, 1.6776, 1.5376, 1.3976],\n                [-0.0024, -0.0024, -0.0024, -0.0024, -0.0024, -0.0024],\n                [1.1976, 1.1176, 1.0376, 0.9576, 0.8776, 0.7976],\n                [-0.0024, -0.0024, -0.0024, -0.0024, -0.0024, -0.0024],\n                [1.7976, 1.6776, 1.5576, 1.4376, 1.3176, 1.1976],\n                [-0.0024, -0.0024, -0.0024, -0.0024, -0.0024, -0.0024],\n            ]),\n            \"tau\": 0.001\n        }\n    ]\n\n    all_results = []\n    for case_data in test_cases:\n        N = case_data[\"N\"]\n        L_vec = case_data[\"L\"]\n        I_vec = case_data[\"I\"]\n        dIdt_vec = case_data[\"dIdt\"]\n        V_mat = case_data[\"V\"]\n        tau = case_data[\"tau\"]\n\n        quenched_indices = []\n        for i in range(N):\n            L_i = L_vec[i]\n            v_i_k = V_mat[i, :]\n\n            # Calculate the corrected voltages by subtracting the inductive component.\n            # v'_i,k = v_i,k - L_i * (dI/dt)_k\n            v_inductive = L_i * dIdt_vec\n            v_corrected = v_i_k - v_inductive\n\n            # Formulate the Non-Negative Least Squares (NNLS) problem.\n            # We are solving the system v_corrected = r_i * I for r_i >= 0.\n            # In nnls(A, b), A is the matrix of coefficients and b is the observation vector.\n            # A becomes the current vector, reshaped to a column vector (Kx1 matrix).\n            # b becomes the corrected voltage vector.\n            A = I_vec.reshape(-1, 1)\n            b = v_corrected\n\n            # Solve for the resistance r_i. nnls returns the solution and the residual norm.\n            # The solution, r_hat_i, is a 1-element array containing the resistance value.\n            r_hat_i_array, _ = nnls(A, b)\n            r_hat_i = r_hat_i_array[0]\n\n            # Check if the estimated resistance exceeds the quench threshold.\n            if r_hat_i >= tau:\n                quenched_indices.append(i)\n        \n        all_results.append(quenched_indices)\n\n    # Format the final output string to match the required format: [[...],[...],[...]]\n    # str() adds spaces, so we remove them.\n    output_str = str(all_results).replace(\" \", \"\")\n    print(output_str)\n\nsolve()\n```", "id": "3716128"}]}