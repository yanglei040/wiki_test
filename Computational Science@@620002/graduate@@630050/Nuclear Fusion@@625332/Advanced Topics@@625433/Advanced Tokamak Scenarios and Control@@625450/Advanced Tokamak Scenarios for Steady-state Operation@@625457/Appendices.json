{"hands_on_practices": [{"introduction": "A primary goal of advanced tokamak scenarios is to achieve superior energy confinement, quantified by the energy confinement time $\\tau_E$. This is often accomplished by creating an Internal Transport Barrier (ITB), a region in the plasma core with dramatically reduced turbulent transport. This practice [@problem_id:3690572] provides a first-principles look at how modifying the thermal diffusivity profile to form an ITB directly enhances global confinement compared to a standard H-mode.", "problem": "A tokamak plasma operating in steady state can be modeled, to leading order, by one-dimensional radial transport in the minor radius $r \\in [0,a]$ with cylindrical symmetry. The energy confinement time $\\tau_{E}$ is defined by $\\tau_{E} = W/P_{\\mathrm{loss}}$ in steady state, where $W$ is the total thermal energy content and $P_{\\mathrm{loss}}$ equals the total input power $P_{\\mathrm{in}}$ under stationary conditions. Assume the plasma has uniform total number density $n$ and a single common temperature $T(r)$ for electrons and ions such that the total energy density is $w(r) = 3 n k_{B} T(r)$, where $k_{B}$ is Boltzmannâ€™s constant. The steady-state energy transport is dominated by conduction with an effective thermal diffusivity $\\chi(r)$, so that the energy (heat) flux is $\\boldsymbol{q}(r) = - C \\, \\chi(r) \\, \\nabla T(r)$, where $C = 3 n k_{B}$, and the heating is represented by a uniform volumetric source $S$ (units of $\\mathrm{W/m^{3}}$). The steady-state energy balance reduces to\n$$\n\\nabla \\cdot \\left( \\chi(r) \\, \\nabla T(r) \\right) = - \\frac{S}{C},\n$$\nwith boundary conditions $T'(0) = 0$ (regularity at the axis) and $T(a) = 0$ (defining the reference edge temperature).\n\nConsider two scenarios:\n- A standard High-confinement mode (H-mode) with uniform $\\chi(r) = \\chi_{H}$.\n- A reversed-shear scenario with an Internal Transport Barrier (ITB), modeled as a piecewise-constant $\\chi(r)$: $\\chi(r) = \\chi_{1}$ for $0 \\le r \\le r_{b}$ and $\\chi(r) = \\chi_{2}$ for $r_{b} \\le r \\le a$, with continuity of $T(r)$ and of the conductive heat flux across $r=r_{b}$.\n\nStarting only from the definitions and equations above (do not assume or quote any pre-derived confinement scalings), derive the expressions for $\\tau_{E}$ in both scenarios and compute the ratio $\\tau_{E}^{\\mathrm{(ITB)}} / \\tau_{E}^{\\mathrm{(H)}}$ for the following scientifically plausible parameters:\n- Minor radius $a = 0.60$ $\\mathrm{m}$,\n- Barrier radius $r_{b} = 0.35$ $\\mathrm{m}$,\n- Uniform H-mode diffusivity $\\chi_{H} = 0.80$ $\\mathrm{m^{2}/s}$,\n- Core-region diffusivity $\\chi_{1} = 0.20$ $\\mathrm{m^{2}/s}$,\n- Outer-region diffusivity $\\chi_{2} = 0.80$ $\\mathrm{m^{2}/s}$.\n\nAssume the torus major radius $R$ is finite but large enough that the cylindrical approximation for the minor-radius conduction and volume integrations is adequate, neglect radiation and convective losses, and take $S$ as uniform across the cross-section. Express the requested ratio as a pure number (no units) and round your answer to four significant figures.", "solution": "The starting point is the steady-state energy balance with conduction:\n$$\n\\nabla \\cdot \\left( \\chi(r) \\, \\nabla T(r) \\right) = - \\frac{S}{C}, \\quad C = 3 n k_{B}.\n$$\nIn a cylindrical approximation for the minor radius with azimuthal symmetry, the radial form is\n$$\n\\frac{1}{r} \\frac{\\mathrm{d}}{\\mathrm{d} r} \\left( r \\, \\chi(r) \\, \\frac{\\mathrm{d} T}{\\mathrm{d} r} \\right) = - \\frac{S}{C},\n$$\nwith boundary conditions $T'(0)=0$ (regularity at $r=0$) and $T(a)=0$ (reference edge temperature). The total thermal energy content is\n$$\nW = \\int w(r) \\, \\mathrm{d}V = \\int C \\, T(r) \\, \\mathrm{d}V,\n$$\nand the total input power for uniform $S$ is\n$$\nP_{\\mathrm{in}} = \\int S \\, \\mathrm{d}V = S \\, V,\n$$\nwhere the torus volume is $V = 2 \\pi^{2} R a^{2}$. Using the symmetry, the volume integral separates into the major-radius circumference $2 \\pi R$ times the cross-section integral. One finds\n$$\nW = C \\cdot 4 \\pi^{2} R \\int_{0}^{a} T(r) \\, r \\, \\mathrm{d} r, \\quad P_{\\mathrm{in}} = S \\cdot 2 \\pi^{2} R a^{2}.\n$$\nTherefore, the energy confinement time is\n$$\n\\tau_{E} = \\frac{W}{P_{\\mathrm{in}}} = \\frac{2 C}{a^{2} S} \\int_{0}^{a} T(r) \\, r \\, \\mathrm{d} r,\n$$\nwhich is independent of the major radius $R$ for uniform $S$.\n\nStandard H-mode (uniform $\\chi$):\n\nSet $\\chi(r) = \\chi_{H}$ constant. The steady equation becomes\n$$\n\\frac{1}{r} \\frac{\\mathrm{d}}{\\mathrm{d} r} \\left( r \\, \\chi_{H} \\, \\frac{\\mathrm{d} T}{\\mathrm{d} r} \\right) = - \\frac{S}{C}.\n$$\nDefine $f(r) \\equiv r \\, \\chi_{H} \\, \\frac{\\mathrm{d} T}{\\mathrm{d} r}$. Then\n$$\n\\frac{\\mathrm{d} f}{\\mathrm{d} r} = - r \\frac{S}{C} \\quad \\Rightarrow \\quad f(r) = - \\frac{S}{2 C} r^{2} + A,\n$$\nand the regularity at $r=0$ requires $f(0)=0 \\Rightarrow A=0$. Thus\n$$\n\\frac{\\mathrm{d} T}{\\mathrm{d} r} = - \\frac{S}{2 C \\chi_{H}} r \\quad \\Rightarrow \\quad T(r) = T_{0} - \\frac{S}{4 C \\chi_{H}} r^{2}.\n$$\nThe boundary condition $T(a) = 0$ yields $T_{0} = \\frac{S}{4 C \\chi_{H}} a^{2}$, so\n$$\nT(r) = \\frac{S}{4 C \\chi_{H}} \\left( a^{2} - r^{2} \\right).\n$$\nCompute the cross-section integral:\n$$\n\\int_{0}^{a} T(r) \\, r \\, \\mathrm{d} r = \\frac{S}{4 C \\chi_{H}} \\int_{0}^{a} \\left( a^{2} r - r^{3} \\right) \\mathrm{d} r = \\frac{S}{4 C \\chi_{H}} \\left( \\frac{a^{4}}{2} - \\frac{a^{4}}{4} \\right) = \\frac{S a^{4}}{16 C \\chi_{H}}.\n$$\nHence\n$$\n\\tau_{E}^{\\mathrm{(H)}} = \\frac{2 C}{a^{2} S} \\cdot \\frac{S a^{4}}{16 C \\chi_{H}} = \\frac{a^{2}}{8 \\chi_{H}}.\n$$\n\nReversed shear with Internal Transport Barrier (piecewise $\\chi$):\n\nLet\n$$\n\\chi(r) = \n\\begin{cases}\n\\chi_{1},  0 \\le r \\le r_{b}, \\\\\n\\chi_{2},  r_{b} \\le r \\le a,\n\\end{cases}\n$$\nwith continuity of $T(r)$ and of the flux $r \\chi(r) T'(r)$ at $r=r_{b}$. In each region, the same integration steps apply.\n\nInner region $0 \\le r \\le r_{b}$:\n$$\n\\frac{1}{r} \\frac{\\mathrm{d}}{\\mathrm{d} r} \\left( r \\, \\chi_{1} \\, \\frac{\\mathrm{d} T}{\\mathrm{d} r} \\right) = - \\frac{S}{C} \\quad \\Rightarrow \\quad r \\chi_{1} \\frac{\\mathrm{d} T}{\\mathrm{d} r} = - \\frac{S}{2 C} r^{2}.\n$$\nThus\n$$\n\\frac{\\mathrm{d} T}{\\mathrm{d} r} = - \\frac{S}{2 C \\chi_{1}} r \\quad \\Rightarrow \\quad T_{1}(r) = T_{c} - \\frac{S}{4 C \\chi_{1}} r^{2},\n$$\nwith $T_{c}$ the central temperature to be determined.\n\nOuter region $r_{b} \\le r \\le a$:\n$$\n\\frac{1}{r} \\frac{\\mathrm{d}}{\\mathrm{d} r} \\left( r \\, \\chi_{2} \\, \\frac{\\mathrm{d} T}{\\mathrm{d} r} \\right) = - \\frac{S}{C} \\quad \\Rightarrow \\quad r \\chi_{2} \\frac{\\mathrm{d} T}{\\mathrm{d} r} = - \\frac{S}{2 C} r^{2} + A_{2}.\n$$\nFlux continuity at $r=r_{b}$ requires\n$$\nr_{b} \\chi_{1} T_{1}'(r_{b}) = r_{b} \\chi_{2} T_{2}'(r_{b}),\n$$\nand since $r \\chi T' = - \\frac{S}{2 C} r^{2}$ in the inner region, this implies $A_{2}=0$. Therefore\n$$\n\\frac{\\mathrm{d} T}{\\mathrm{d} r} = - \\frac{S}{2 C \\chi_{2}} r \\quad \\Rightarrow \\quad T_{2}(r) = T_{b} - \\frac{S}{4 C \\chi_{2}} \\left( r^{2} - r_{b}^{2} \\right),\n$$\nwhere $T_{b} = T_{2}(r_{b}) = T_{1}(r_{b})$ ensures temperature continuity. The edge boundary condition $T(a)=0$ gives\n$$\nT_{b} = \\frac{S}{4 C \\chi_{2}} \\left( a^{2} - r_{b}^{2} \\right),\n$$\nand matching at $r_{b}$ determines $T_{c}$:\n$$\nT_{c} - \\frac{S}{4 C \\chi_{1}} r_{b}^{2} = \\frac{S}{4 C \\chi_{2}} \\left( a^{2} - r_{b}^{2} \\right) \\quad \\Rightarrow \\quad T_{c} = \\frac{S}{4 C} \\left( \\frac{r_{b}^{2}}{\\chi_{1}} + \\frac{a^{2} - r_{b}^{2}}{\\chi_{2}} \\right).\n$$\n\nThe confinement time requires the integral\n$$\nI \\equiv \\int_{0}^{a} T(r) \\, r \\, \\mathrm{d} r = \\int_{0}^{r_{b}} T_{1}(r) \\, r \\, \\mathrm{d} r + \\int_{r_{b}}^{a} T_{2}(r) \\, r \\, \\mathrm{d} r.\n$$\nCompute $I_{1}$:\n$$\nI_{1} = \\int_{0}^{r_{b}} \\left( T_{c} - \\frac{S}{4 C \\chi_{1}} r^{2} \\right) r \\, \\mathrm{d} r = T_{c} \\frac{r_{b}^{2}}{2} - \\frac{S}{4 C \\chi_{1}} \\frac{r_{b}^{4}}{4}.\n$$\nSubstitute $T_{c}$:\n$$\nI_{1} = \\frac{S}{4 C} \\left[ \\left( \\frac{r_{b}^{2}}{\\chi_{1}} + \\frac{a^{2} - r_{b}^{2}}{\\chi_{2}} \\right) \\frac{r_{b}^{2}}{2} - \\frac{r_{b}^{4}}{4 \\chi_{1}} \\right]\n= \\frac{S}{4 C} \\left( \\frac{r_{b}^{4}}{4 \\chi_{1}} + \\frac{a^{2} r_{b}^{2} - r_{b}^{4}}{2 \\chi_{2}} \\right).\n$$\nCompute $I_{2}$. Using $T_{b} = \\frac{S}{4 C \\chi_{2}} \\left( a^{2} - r_{b}^{2} \\right)$, one may rewrite $T_{2}(r)$ as\n$$\nT_{2}(r) = \\frac{S a^{2}}{4 C \\chi_{2}} - \\frac{S}{4 C \\chi_{2}} r^{2},\n$$\nso\n$$\nI_{2} = \\int_{r_{b}}^{a} \\left( \\frac{S a^{2}}{4 C \\chi_{2}} - \\frac{S}{4 C \\chi_{2}} r^{2} \\right) r \\, \\mathrm{d} r\n= \\frac{S}{4 C \\chi_{2}} \\left[ \\frac{a^{2}}{2} \\left( a^{2} - r_{b}^{2} \\right) - \\frac{1}{4} \\left( a^{4} - r_{b}^{4} \\right) \\right]\n= \\frac{S}{4 C \\chi_{2}} \\left( \\frac{a^{4}}{4} - \\frac{a^{2} r_{b}^{2}}{2} + \\frac{r_{b}^{4}}{4} \\right).\n$$\nSumming $I = I_{1} + I_{2}$ gives the compact result\n$$\nI = \\frac{S}{4 C} \\left( \\frac{r_{b}^{4}}{4 \\chi_{1}} + \\frac{a^{4} - r_{b}^{4}}{4 \\chi_{2}} \\right) = \\frac{S}{16 C} \\left( \\frac{r_{b}^{4}}{\\chi_{1}} + \\frac{a^{4} - r_{b}^{4}}{\\chi_{2}} \\right).\n$$\nTherefore,\n$$\n\\tau_{E}^{\\mathrm{(ITB)}} = \\frac{2 C}{a^{2} S} \\, I = \\frac{1}{8 a^{2}} \\left( \\frac{r_{b}^{4}}{\\chi_{1}} + \\frac{a^{4} - r_{b}^{4}}{\\chi_{2}} \\right).\n$$\n\nThe ratio is then\n$$\n\\frac{\\tau_{E}^{\\mathrm{(ITB)}}}{\\tau_{E}^{\\mathrm{(H)}}} = \\frac{ \\frac{1}{8 a^{2}} \\left( \\frac{r_{b}^{4}}{\\chi_{1}} + \\frac{a^{4} - r_{b}^{4}}{\\chi_{2}} \\right) }{ \\frac{a^{2}}{8 \\chi_{H}} } = \\frac{\\chi_{H}}{a^{4}} \\left( \\frac{r_{b}^{4}}{\\chi_{1}} + \\frac{a^{4} - r_{b}^{4}}{\\chi_{2}} \\right).\n$$\n\nInsert the numerical values:\n$$\na = 0.60, \\quad r_{b} = 0.35, \\quad \\chi_{H} = 0.80, \\quad \\chi_{1} = 0.20, \\quad \\chi_{2} = 0.80,\n$$\nall in $\\mathrm{m}$ or $\\mathrm{m^{2}/s}$ as appropriate. Compute the required powers:\n$$\na^{2} = 0.36, \\quad a^{4} = 0.1296, \\quad r_{b}^{2} = 0.1225, \\quad r_{b}^{4} = 0.01500625.\n$$\nEvaluate the bracket:\n$$\n\\frac{r_{b}^{4}}{\\chi_{1}} + \\frac{a^{4} - r_{b}^{4}}{\\chi_{2}} = \\frac{0.01500625}{0.20} + \\frac{0.1296 - 0.01500625}{0.80} = 0.07503125 + 0.1432421875 = 0.2182734375.\n$$\nThus\n$$\n\\frac{\\tau_{E}^{\\mathrm{(ITB)}}}{\\tau_{E}^{\\mathrm{(H)}}} = \\frac{0.80}{0.1296} \\times 0.2182734375 = 6.172839506 \\times 0.2182734375 \\approx 1.3473669.\n$$\nRounded to four significant figures, the ratio is $1.347$. This dimensionless number directly quantifies the confinement enhancement expected from the reversed-shear Internal Transport Barrier scenario relative to the standard High-confinement mode under the stated assumptions.", "answer": "$$\\boxed{1.347}$$", "id": "3690572"}, {"introduction": "The very same pressure gradients that provide enhanced confinement in advanced scenarios can unfortunately drive magnetohydrodynamic (MHD) instabilities, such as the Neoclassical Tearing Mode (NTM). For true steady-state operation, these performance-degrading modes must be actively suppressed. This exercise [@problem_id:3690615] delves into the physics of NTM control, challenging you to calculate the required power and alignment precision of an Electron Cyclotron Current Drive (ECCD) system to stabilize a dangerous island.", "problem": "Consider an advanced tokamak equilibrium supporting a Neoclassical Tearing Mode (NTM) with poloidal/toroidal mode numbers $m/n = 3/2$ localized at the rational surface $r/a = 0.6$, where $a$ is the minor radius. The island half-width is denoted by $w$, and the operational scenario requires reducing $w$ below the critical half-width $w_{\\text{crit}}$ to ensure steady-state avoidance of NTM growth. Electron Cyclotron Current Drive (ECCD) is applied near the rational surface to provide a stabilizing helical current localized at the island O-point. The ECCD deposition has a Gaussian radial profile and is subject to radial misalignment $\\Delta r$ relative to the rational surface. \n\nStarting from resistive magnetohydrodynamics and the definition of the modified Rutherford equation that balances the classical tearing drive, the neoclassical bootstrap current drive, and the externally driven current, derive the stabilization condition at $w = w_{\\text{crit}}$ requiring that the externally driven current density exceeds the destabilizing terms so that $\\mathrm{d}w/\\mathrm{d}t  0$. Use this condition to obtain the threshold externally driven current, and then connect it to ECCD power via the current-drive efficiency. The Gaussian radial alignment factor is defined by $F(\\Delta r) = \\exp\\!\\left[-(\\Delta r/\\sigma)^{2}\\right]$, where $\\sigma$ is the $1/e$ deposition width.\n\nAssume the following scientifically realistic parameters are known for the discharge:\n- Critical half-width $w_{\\text{crit}} = 3.0 \\times 10^{-2}\\ \\text{m}$.\n- Polarization-current shielding half-width $w_{\\text{pol}} = 1.2 \\times 10^{-2}\\ \\text{m}$.\n- Classical tearing stability index $\\Delta' = 0.80\\ \\text{m}^{-1}$.\n- Dimensionless bootstrap drive coefficient $C_{\\text{bs}} = 0.60$.\n- Current-drive coupling coefficient $C_{\\text{CD}} = 2.0 \\times 10^{-5}\\ \\text{A}^{-1}$.\n- Electron Cyclotron Current Drive (ECCD) efficiency $\\eta_{\\text{CD}} = 1.0 \\times 10^{4}\\ \\text{A}\\ \\text{MW}^{-1}$.\n- Deposition width $\\sigma = 1.5 \\times 10^{-2}\\ \\text{m}$.\n- Available ECCD power budget $P_{\\text{avail}} = 5.0\\ \\text{MW}$.\n\nTasks:\n1. Using the stabilization condition at $w = w_{\\text{crit}}$ with perfect O-point phasing and zero radial misalignment, $\\Delta r = 0$, calculate the minimum ECCD power $P_{\\text{ECCD,min}}$ required to ensure $\\mathrm{d}w/\\mathrm{d}t  0$ at $w = w_{\\text{crit}}$.\n2. With the fixed available power $P_{\\text{avail}}$, calculate the maximum allowable radial misalignment $\\Delta r_{\\max}$ such that stabilization at $w = w_{\\text{crit}}$ is still achieved, i.e., $\\mathrm{d}w/\\mathrm{d}t  0$ at $w = w_{\\text{crit}}$.\n\nExpress $P_{\\text{ECCD,min}}$ in $\\text{MW}$ and $\\Delta r_{\\max}$ in $\\text{m}$. Round both numerical results to three significant figures. Provide your final answer as a single two-entry row matrix.", "solution": "The physical basis is the resistive magnetohydrodynamics description of magnetic island evolution, where the tearing instability is governed by the balance of the classical tearing drive, the neoclassical bootstrap drive associated with the pressure-gradient-induced current deficit inside the island, and externally driven current that can replace the missing bootstrap current when deposited at the island O-point. This balance is captured by the modified Rutherford equation. At leading order, the island half-width evolution can be written in a form that separates drives and counter-drives,\n$$\n\\frac{\\tau_{R}}{r_{s}} \\frac{\\mathrm{d} w}{\\mathrm{d} t}\n=\n\\underbrace{\\Delta'}_{\\text{classical tearing}}\n+\n\\underbrace{\\frac{C_{\\text{bs}}}{w}\\left(1 - \\frac{w_{\\text{pol}}^{2}}{w^{2}}\\right)}_{\\text{bootstrap drive}}\n-\n\\underbrace{\\frac{C_{\\text{CD}}}{w}\\,I_{\\text{CD}}\\,F(\\Delta r)}_{\\text{ECCD counter-drive}}.\n$$\nHere, $\\tau_{R}$ is the resistive time, $r_{s}$ is the rational surface radius, $\\Delta'$ is the classical tearing stability index, $C_{\\text{bs}}$ is a dimensionless bootstrap drive coefficient, $w_{\\text{pol}}$ is the polarization shielding scale that weakens the bootstrap drive for small islands, $C_{\\text{CD}}$ is a coupling coefficient (with units $\\text{A}^{-1}$) quantifying how externally driven current $I_{\\text{CD}}$ couples to the island chain, and $F(\\Delta r)$ is the alignment factor describing the reduction in effective drive due to radial misalignment.\n\nStabilization requires $\\mathrm{d}w/\\mathrm{d}t  0$ at the operating point $w = w_{\\text{crit}}$. Since the prefactor $\\tau_{R}/r_{s}  0$, this is equivalent to the requirement that the bracketed sum of drives and counter-drives be negative at $w = w_{\\text{crit}}$,\n$$\n\\Delta' + \\frac{C_{\\text{bs}}}{w_{\\text{crit}}}\\left(1 - \\frac{w_{\\text{pol}}^{2}}{w_{\\text{crit}}^{2}}\\right)\n-\n\\frac{C_{\\text{CD}}}{w_{\\text{crit}}}\\,I_{\\text{CD}}\\,F(\\Delta r)  0.\n$$\nSolving this inequality for the threshold externally driven current gives the minimum current needed for stabilization at $w_{\\text{crit}}$ for a given alignment $F(\\Delta r)$,\n$$\nI_{\\text{CD,min}}(w_{\\text{crit}}, \\Delta r)\n=\n\\frac{\nw_{\\text{crit}} \\Delta' + C_{\\text{bs}}\\left(1 - \\frac{w_{\\text{pol}}^{2}}{w_{\\text{crit}}^{2}}\\right)\n}{\nC_{\\text{CD}}\\,F(\\Delta r)\n}.\n$$\nElectron Cyclotron Current Drive (ECCD) relates injected power $P_{\\text{ECCD}}$ to driven current via the efficiency $\\eta_{\\text{CD}}$,\n$$\nI_{\\text{CD}} = \\eta_{\\text{CD}}\\,P_{\\text{ECCD}}.\n$$\nTherefore, the minimum ECCD power at perfect alignment ($\\Delta r = 0 \\Rightarrow F(0)=1$) is\n$$\nP_{\\text{ECCD,min}}\n=\n\\frac{I_{\\text{CD,min}}(w_{\\text{crit}}, 0)}{\\eta_{\\text{CD}}}\n=\n\\frac{\nw_{\\text{crit}} \\Delta' + C_{\\text{bs}}\\left(1 - \\frac{w_{\\text{pol}}^{2}}{w_{\\text{crit}}^{2}}\\right)\n}{\nC_{\\text{CD}}\\,\\eta_{\\text{CD}}\n}.\n$$\n\nFor a finite power budget $P_{\\text{avail}}$, the stabilization condition can be re-expressed as a bound on the alignment factor,\n$$\n\\eta_{\\text{CD}}\\,P_{\\text{avail}}\\,F(\\Delta r) \\ge I_{\\text{CD,min}}(w_{\\text{crit}}, 0),\n$$\nso\n$$\nF(\\Delta r) \\ge \\frac{I_{\\text{CD,min}}(w_{\\text{crit}}, 0)}{\\eta_{\\text{CD}}\\,P_{\\text{avail}}}.\n$$\nWith the Gaussian profile $F(\\Delta r) = \\exp\\!\\left[-(\\Delta r/\\sigma)^{2}\\right]$, we solve for the allowable $\\Delta r$:\n$$\n\\exp\\!\\left[-\\left(\\frac{\\Delta r}{\\sigma}\\right)^{2}\\right]\n\\ge\n\\frac{I_{\\text{CD,min}}(w_{\\text{crit}}, 0)}{\\eta_{\\text{CD}}\\,P_{\\text{avail}}},\n\\quad\\Rightarrow\\quad\n\\left(\\frac{\\Delta r}{\\sigma}\\right)^{2}\n\\le\n\\ln\\!\\left(\n\\frac{\\eta_{\\text{CD}}\\,P_{\\text{avail}}}{I_{\\text{CD,min}}(w_{\\text{crit}}, 0)}\n\\right).\n$$\nThus the maximum allowable radial misalignment is\n$$\n\\Delta r_{\\max}\n=\n\\sigma\\,\n\\sqrt{\n\\ln\\!\\left(\n\\frac{\\eta_{\\text{CD}}\\,P_{\\text{avail}}}{I_{\\text{CD,min}}(w_{\\text{crit}}, 0)}\n\\right)\n}.\n$$\n\nNow substitute the given parameters to obtain the numerical values.\n\nStep 1: Compute $I_{\\text{CD,min}}(w_{\\text{crit}}, 0)$.\n- $w_{\\text{crit}} \\Delta' = (3.0 \\times 10^{-2}) \\times 0.80 = 2.4 \\times 10^{-2}$.\n- $\\displaystyle \\frac{w_{\\text{pol}}^{2}}{w_{\\text{crit}}^{2}} = \\left(\\frac{1.2 \\times 10^{-2}}{3.0 \\times 10^{-2}}\\right)^{2} = 0.16$.\n- $1 - \\dfrac{w_{\\text{pol}}^{2}}{w_{\\text{crit}}^{2}} = 0.84$.\n- $C_{\\text{bs}}\\left(1 - \\dfrac{w_{\\text{pol}}^{2}}{w_{\\text{crit}}^{2}}\\right) = 0.60 \\times 0.84 = 0.504$.\n- Numerator: $w_{\\text{crit}} \\Delta' + C_{\\text{bs}}\\left(1 - \\dfrac{w_{\\text{pol}}^{2}}{w_{\\text{crit}}^{2}}\\right) = 0.024 + 0.504 = 0.528$.\n- Divide by $C_{\\text{CD}}$: $I_{\\text{CD,min}}(w_{\\text{crit}}, 0) = \\dfrac{0.528}{2.0 \\times 10^{-5}} = 2.64 \\times 10^{4}\\ \\text{A}$.\n\nStep 2: Minimum ECCD power at perfect alignment:\n$$\nP_{\\text{ECCD,min}} = \\frac{I_{\\text{CD,min}}}{\\eta_{\\text{CD}}}\n= \\frac{2.64 \\times 10^{4}\\ \\text{A}}{1.0 \\times 10^{4}\\ \\text{A}\\ \\text{MW}^{-1}}\n= 2.64\\ \\text{MW}.\n$$\n\nStep 3: Maximum allowable radial misalignment with $P_{\\text{avail}} = 5.0\\ \\text{MW}$:\n- Ratio inside the logarithm:\n$$\n\\frac{\\eta_{\\text{CD}}\\,P_{\\text{avail}}}{I_{\\text{CD,min}}(w_{\\text{crit}}, 0)}\n=\n\\frac{(1.0 \\times 10^{4}) \\times 5.0}{2.64 \\times 10^{4}}\n=\n\\frac{5.0 \\times 10^{4}}{2.64 \\times 10^{4}}\n\\approx 1.8939.\n$$\n- Logarithm:\n$$\n\\ln(1.8939) \\approx 0.639.\n$$\n- Square root factor:\n$$\n\\sqrt{0.639} \\approx 0.799.\n$$\n- Misalignment:\n$$\n\\Delta r_{\\max} = \\sigma \\times 0.799 = (1.5 \\times 10^{-2}) \\times 0.799 \\approx 1.20 \\times 10^{-2}\\ \\text{m}.\n$$\n\nRounding both results to three significant figures and expressing in the requested units gives:\n- $P_{\\text{ECCD,min}} = 2.64\\ \\text{MW}$,\n- $\\Delta r_{\\max} = 0.0120\\ \\text{m}$.\n\nProvide the final answer as a two-entry row matrix.", "answer": "$$\\boxed{\\begin{pmatrix}2.64  0.0120\\end{pmatrix}}$$", "id": "3690615"}, {"introduction": "Sustaining a high-performance plasma in steady state presents a formidable engineering challenge: managing the immense heat flux to the vessel walls. A leading strategy is to intentionally inject impurities into the plasma edge to radiate a significant fraction of the power away before it reaches material surfaces. This practice [@problem_id:3690607] models this critical trade-off, asking you to calculate the required impurity seeding rate to achieve a target radiated power fraction while ensuring the core plasma purity remains within acceptable limits.", "problem": "You are tasked with writing a complete, runnable program that computes the required impurity seeding rate to achieve a specified target radiated power fraction while maintaining a constraint on the effective ion charge. The intended physical context is advanced tokamak scenarios for steady-state operation, and the derivation must be based on first principles and well-tested formulas.\n\nThe plasma is partitioned into a core region and an edge radiation region. Assume a single impurity species with a fixed effective squared charge, and that a fraction of the impurity inventory is retained in the core. The following definitions and principles are to be used as the foundational base:\n\n- Quasi-neutrality and main ion dominance: in the core, assume the main ion density is approximately equal to the electron density, and the impurity fraction is small.\n- Effective ion charge ($Z_{\\text{eff}}$): define $Z_{\\text{eff}}$ as $Z_{\\text{eff}} = \\frac{\\sum_j n_j Z_j^2}{n_e}$, where $n_j$ and $Z_j$ are the number density and charge of ion species $j$, and $n_e$ is the electron density. For a single impurity species with effective squared charge $Z_{\\text{bar}}^2$ and core impurity number density $n_{\\text{imp,core}} = r_{\\text{core}} n_{\\text{imp}}$, approximate $Z_{\\text{eff,core}} \\approx 1 + \\frac{r_{\\text{core}} n_{\\text{imp}}}{n_{e,\\text{core}}} Z_{\\text{bar}}^2$.\n- Bremsstrahlung radiation: use the well-tested approximate electron-ion bremsstrahlung power density formula $P'_{\\text{brem}} = C_{\\text{brem}} Z_{\\text{eff}} n_e^2 \\sqrt{T_e}$, where $C_{\\text{brem}} = 1.69 \\times 10^{-38}$ in $\\text{W}\\cdot\\text{m}^3\\cdot\\text{eV}^{-1/2}$ when $n_e$ is in $\\text{m}^{-3}$ and $T_e$ is in $\\text{eV}$. For the core, define $A_{\\text{core}} = C_{\\text{brem}} n_{e,\\text{core}}^2 \\sqrt{T_{e,\\text{core}}}$ in $\\text{W/m}^3$ and $B_{\\text{core}} = A_{\\text{core}} V_{\\text{core}}$ in $\\text{W}$ as the baseline bremsstrahlung without impurities. With impurities, the core bremsstrahlung becomes $P_{\\text{brem,core}} = B_{\\text{core}} \\left(1 + \\frac{r_{\\text{core}} n_{\\text{imp}}}{n_{e,\\text{core}}} Z_{\\text{bar}}^2\\right)$.\n- Line radiation: model edge (and scrape-off layer) radiative losses by an effective coronal line radiation term $P_{\\text{line}} = n_{e,\\text{line}} n_{\\text{imp}} L_{\\text{line}}(T_{\\text{line}}) V_{\\text{line}}$, where $L_{\\text{line}}$ is an effective cooling coefficient in units of $\\text{W}\\cdot\\text{m}^3$, $n_{e,\\text{line}}$ is the characteristic edge electron density, $T_{\\text{line}}$ is the characteristic edge temperature at which $L_{\\text{line}}$ is evaluated, and $V_{\\text{line}}$ is the effective edge radiation volume.\n- Steady-state global power fraction: define the target radiated power fraction $f_{\\text{rad}}$ by $f_{\\text{rad}} = \\frac{P_{\\text{rad}}}{P_{\\text{in}}}$, where $P_{\\text{rad}} = P_{\\text{brem,core}} + P_{\\text{line}}$ and $P_{\\text{in}}$ is the total input power.\n\nLet $n_{\\text{imp}}$ denote the spatially averaged impurity number density over the total plasma volume $V_{\\text{tot}}$. In steady state, model the impurity particle balance as $n_{\\text{imp}} = \\frac{Q_{\\text{imp}} \\tau_p}{V_{\\text{tot}}}$, where $Q_{\\text{imp}}$ is the global impurity seeding rate in particles per second, and $\\tau_p$ is the effective impurity confinement time in seconds.\n\nYour program must implement the following computations:\n\n1. Given parameters for a test case, compute the core baseline bremsstrahlung $B_{\\text{core}} = C_{\\text{brem}} n_{e,\\text{core}}^2 \\sqrt{T_{e,\\text{core}}} V_{\\text{core}}$.\n2. Compute the impurity density needed to achieve the target radiated fraction by solving from\n   $$f_{\\text{rad}} P_{\\text{in}} = B_{\\text{core}} + n_{\\text{imp}} \\left[B_{\\text{core}} \\left(\\frac{r_{\\text{core}} Z_{\\text{bar}}^2}{n_{e,\\text{core}}}\\right) + n_{e,\\text{line}} L_{\\text{line}} V_{\\text{line}}\\right].$$\n   Isolate $n_{\\text{imp}}$ to obtain\n   $$n_{\\text{imp}} = \\frac{f_{\\text{rad}} P_{\\text{in}} - B_{\\text{core}}}{B_{\\text{core}} \\left(\\frac{r_{\\text{core}} Z_{\\text{bar}}^2}{n_{e,\\text{core}}}\\right) + n_{e,\\text{line}} L_{\\text{line}} V_{\\text{line}}}.$$\n3. Enforce physical feasibility:\n   - If $f_{\\text{rad}} P_{\\text{in}} - B_{\\text{core}} \\le 0$, then set $Q_{\\text{imp}} = 0$ because no impurity seeding is needed.\n   - Impose the core effective ion charge constraint $Z_{\\text{eff,core}} \\le Z_{\\text{eff},\\max}$, which translates to a maximum impurity density\n     $$n_{\\text{imp},\\max} = \\frac{n_{e,\\text{core}} \\left(Z_{\\text{eff},\\max} - 1\\right)}{r_{\\text{core}} Z_{\\text{bar}}^2}.$$\n     If the required $n_{\\text{imp}}$ exceeds $n_{\\text{imp},\\max}$, the target is infeasible; in that case return $-1$.\n4. If feasible, compute the required impurity seeding rate\n   $$Q_{\\text{imp}} = \\frac{n_{\\text{imp}} V_{\\text{tot}}}{\\tau_p}.$$\n\nAll quantities involving physical units must be handled consistently:\n\n- Electron densities $n_{e,\\text{core}}$ and $n_{e,\\text{line}}$ in $\\text{m}^{-3}$.\n- Temperatures $T_{e,\\text{core}}$ and $T_\\text{line}$ in $\\text{eV}$.\n- Volumes $V_\\text{core}$, $V_\\text{line}$, and $V_\\text{tot}$ in $\\text{m}^3$.\n- Input power $P_\\text{in}$ in $\\text{W}$.\n- Impurity confinement time $\\tau_p$ in $\\text{s}$.\n- Effective cooling coefficient $L_\\text{line}$ in $\\text{W}\\cdot\\text{m}^3$.\n- The final output $Q_\\text{imp}$ must be reported in particles per second $(\\text{s}^{-1})$.\n\nUse the following well-chosen test suite that covers a general feasible case, an infeasible case due to a violation of the $Z_\\text{eff}$ constraint, a second feasible case with a different impurity, and a boundary case where no seeding is needed:\n\n- Test case 1 (feasible, neon-dominated edge radiation):\n  - $n_{e,\\text{core}} = 8.0\\times 10^{19}$, $T_{e,\\text{core}} = 8000$, $V_\\text{core} = 110$.\n  - $n_{e,\\text{line}} = 3.0\\times 10^{19}$, $L_\\text{line} = 3.0\\times 10^{-33}$, $V_\\text{line} = 60$.\n  - $Z_\\text{bar}^2 = 100$, $r_\\text{core} = 0.05$, $Z_{\\text{eff},\\max} = 2.5$.\n  - $P_\\text{in} = 6.0\\times 10^{7}$, $f_\\text{rad} = 0.7$.\n  - $\\tau_p = 0.3$, $V_\\text{tot} = 170$.\n- Test case 2 (infeasible due to $Z_\\text{eff}$ constraint, neon with higher core retention):\n  - Same as Test case 1, but $r_\\text{core} = 0.20$.\n- Test case 3 (feasible, argon-dominated edge radiation):\n  - $n_{e,\\text{core}} = 8.0\\times 10^{19}$, $T_{e,\\text{core}} = 8000$, $V_\\text{core} = 110$.\n  - $n_{e,\\text{line}} = 3.0\\times 10^{19}$, $L_\\text{line} = 5.0\\times 10^{-32}$, $V_\\text{line} = 60$.\n  - $Z_\\text{bar}^2 = 324$, $r_\\text{core} = 0.03$, $Z_{\\text{eff},\\max} = 2.5$.\n  - $P_\\text{in} = 6.0\\times 10^{7}$, $f_\\text{rad} = 0.7$.\n  - $\\tau_p = 0.5$, $V_\\text{tot} = 170$.\n- Test case 4 (boundary case, target below baseline bremsstrahlung):\n  - Same as Test case 1, but $f_\\text{rad} = 0.01$.\n\nYour program should produce a single line of output containing the results for the test suite as a comma-separated list enclosed in square brackets, in units of $\\text{s}^{-1}$ for the seeding rates. For infeasible cases, output $-1$. For cases where no seeding is needed, output $0$. For example: \"[result1,result2,result3,result4]\".", "solution": "The problem as stated is scientifically grounded, well-posed, and self-contained, presenting a valid computational task based on a simplified but standard model of plasma behavior in a tokamak. We shall therefore proceed with a complete solution.\n\nThe core of the problem is to determine the necessary impurity seeding rate, $Q_\\text{imp}$, to achieve a desired radiated power fraction, $f_\\text{rad}$, subject to a constraint on the core plasma purity, represented by the effective ion charge $Z_\\text{eff,core}$. The solution is derived from steady-state power and particle balance equations.\n\nFirst, we define the total power balance. The total radiated power, $P_\\text{rad}$, is the sum of core bremsstrahlung radiation, $P_\\text{brem,core}$, and edge line radiation, $P_\\text{line}$. This total must equal a target fraction, $f_\\text{rad}$, of the input heating power, $P_\\text{in}$.\n$$f_\\text{rad} P_\\text{in} = P_\\text{rad} = P_\\text{brem,core} + P_\\text{line}$$\nThe core bremsstrahlung power is dependent on the core plasma parameters and the concentration of impurities in the core. It is given by $P_\\text{brem,core} = B_\\text{core} Z_\\text{eff,core}$, where $B_\\text{core}$ is the baseline bremsstrahlung from a pure ($Z_\\text{eff}=1$) hydrogenic plasma.\n$$B_\\text{core} = C_\\text{brem} n_{e,\\text{core}}^2 \\sqrt{T_{e,\\text{core}}} V_\\text{core}$$\nHere, $C_\\text{brem}$ is the bremsstrahlung constant, $1.69 \\times 10^{-38} \\, \\text{W}\\cdot\\text{m}^3\\cdot\\text{eV}^{-1/2}$, $n_{e,\\text{core}}$ is the core electron density, $T_{e,\\text{core}}$ is the core electron temperature, and $V_\\text{core}$ is the core volume. The core effective ion charge, $Z_\\text{eff,core}$, for a single impurity species is approximated as:\n$$Z_\\text{eff,core} \\approx 1 + \\dfrac{r_\\text{core} n_\\text{imp}}{n_{e,\\text{core}}} Z_\\text{bar}^2$$\nwhere $n_\\text{imp}$ is the volume-averaged impurity density, $r_\\text{core}$ is the fraction of total impurities retained in the core, and $Z_\\text{bar}^2$ is the effective squared charge of the impurity ions. Combining these, the core bremsstrahlung power is:\n$$P_\\text{brem,core} = B_\\text{core} \\left(1 + \\dfrac{r_\\text{core} n_\\text{imp}}{n_{e,\\text{core}}} Z_\\text{bar}^2\\right)$$\nThe edge line radiation power is modeled as:\n$$P_\\text{line} = n_{e,\\text{line}} n_\\text{imp} L_\\text{line} V_\\text{line}$$\nwhere $n_{e,\\text{line}}$, $L_\\text{line}$, and $V_\\text{line}$ are the characteristic electron density, cooling coefficient, and volume for the edge radiating region.\n\nSubstituting the expressions for $P_\\text{brem,core}$ and $P_\\text{line}$ into the power balance equation allows us to solve for the required impurity density, $n_\\text{imp}$.\n$$f_\\text{rad} P_\\text{in} = B_\\text{core} + B_\\text{core} \\left(\\dfrac{r_\\text{core} n_\\text{imp}}{n_{e,\\text{core}}} Z_\\text{bar}^2\\right) + n_{e,\\text{line}} n_\\text{imp} L_\\text{line} V_\\text{line}$$\nLet $\\Delta P = f_\\text{rad} P_\\text{in} - B_\\text{core}$ be the additional power that must be radiated by the impurities. Collecting terms proportional to $n_\\text{imp}$:\n$$\\Delta P = n_\\text{imp} \\left[ B_\\text{core} \\left(\\dfrac{r_\\text{core} Z_\\text{bar}^2}{n_{e,\\text{core}}}\\right) + n_{e,\\text{line}} L_\\text{line} V_\\text{line} \\right]$$\nSolving for $n_\\text{imp}$ yields:\n$$n_\\text{imp} = \\dfrac{f_\\text{rad} P_\\text{in} - B_\\text{core}}{B_\\text{core} \\left(\\dfrac{r_\\text{core} Z_\\text{bar}^2}{n_{e,\\text{core}}}\\right) + n_{e,\\text{line}} L_\\text{line} V_\\text{line}}$$\nThis equation is valid only if the numerator is positive, i.e., $f_\\text{rad} P_\\text{in}  B_\\text{core}$. If $f_\\text{rad} P_\\text{in} \\le B_\\text{core}$, the baseline bremsstrahlung already meets or exceeds the target radiated power, so no impurity seeding is required, and we must set $Q_\\text{imp} = 0$.\n\nNext, we must enforce the plasma purity constraint, $Z_\\text{eff,core} \\le Z_{\\text{eff},\\max}$. This sets an upper limit on the permissible impurity density.\n$$1 + \\dfrac{r_\\text{core} n_\\text{imp}}{n_{e,\\text{core}}} Z_\\text{bar}^2 \\le Z_{\\text{eff},\\max}$$\nSolving for $n_\\text{imp}$ gives the maximum allowed density:\n$$n_{\\text{imp},\\max} = \\dfrac{n_{e,\\text{core}} \\left(Z_{\\text{eff},\\max} - 1\\right)}{r_\\text{core} Z_\\text{bar}^2}$$\nIf the required density $n_\\text{imp}$ for achieving the target $f_\\text{rad}$ exceeds this limit, i.e., $n_\\text{imp}  n_{\\text{imp},\\max}$, the target is infeasible under the specified constraints. In this case, the result is specified as $-1$.\n\nFinally, if the scenario is feasible ($0  n_\\text{imp} \\le n_{\\text{imp},\\max}$), we can calculate the required impurity seeding rate, $Q_\\text{imp}$, from the steady-state particle balance:\n$$n_\\text{imp} = \\dfrac{Q_\\text{imp} \\tau_p}{V_\\text{tot}}$$\nwhere $\\tau_p$ is the impurity confinement time and $V_\\text{tot}$ is the total plasma volume. The required seeding rate is therefore:\n$$Q_\\text{imp} = \\dfrac{n_\\text{imp} V_\\text{tot}}{\\tau_p}$$\nThe computational algorithm will implement these steps for each provided test case.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to solve for impurity seeding rates for the given test cases.\n    \"\"\"\n\n    # Define the constant C_brem\n    C_brem = 1.69e-38  # W*m^3*eV^(-1/2)\n\n    # List of test cases, each defined by a dictionary of parameters.\n    test_cases = [\n        # Test case 1 (feasible, neon-dominated edge radiation)\n        {\n            \"n_e_core\": 8.0e19, \"T_e_core\": 8000, \"V_core\": 110,\n            \"n_e_line\": 3.0e19, \"L_line\": 3.0e-33, \"V_line\": 60,\n            \"Z_bar_sq\": 100, \"r_core\": 0.05, \"Z_eff_max\": 2.5,\n            \"P_in\": 6.0e7, \"f_rad\": 0.7,\n            \"tau_p\": 0.3, \"V_tot\": 170\n        },\n        # Test case 2 (infeasible due to Z_eff constraint, neon with higher core retention)\n        {\n            \"n_e_core\": 8.0e19, \"T_e_core\": 8000, \"V_core\": 110,\n            \"n_e_line\": 3.0e19, \"L_line\": 3.0e-33, \"V_line\": 60,\n            \"Z_bar_sq\": 100, \"r_core\": 0.20, \"Z_eff_max\": 2.5,\n            \"P_in\": 6.0e7, \"f_rad\": 0.7,\n            \"tau_p\": 0.3, \"V_tot\": 170\n        },\n        # Test case 3 (feasible, argon-dominated edge radiation)\n        {\n            \"n_e_core\": 8.0e19, \"T_e_core\": 8000, \"V_core\": 110,\n            \"n_e_line\": 3.0e19, \"L_line\": 5.0e-32, \"V_line\": 60,\n            \"Z_bar_sq\": 324, \"r_core\": 0.03, \"Z_eff_max\": 2.5,\n            \"P_in\": 6.0e7, \"f_rad\": 0.7,\n            \"tau_p\": 0.5, \"V_tot\": 170\n        },\n        # Test case 4 (boundary case, target below baseline bremsstrahlung)\n        {\n            \"n_e_core\": 8.0e19, \"T_e_core\": 8000, \"V_core\": 110,\n            \"n_e_line\": 3.0e19, \"L_line\": 3.0e-33, \"V_line\": 60,\n            \"Z_bar_sq\": 100, \"r_core\": 0.05, \"Z_eff_max\": 2.5,\n            \"P_in\": 6.0e7, \"f_rad\": 0.01,\n            \"tau_p\": 0.3, \"V_tot\": 170\n        },\n    ]\n\n    def calculate_seeding_rate(params, const_c_brem):\n        \"\"\"\n        Calculates the required impurity seeding rate for a single test case.\n        \"\"\"\n        # Step 1: Compute core baseline bremsstrahlung B_core\n        B_core = const_c_brem * params[\"n_e_core\"]**2 * np.sqrt(params[\"T_e_core\"]) * params[\"V_core\"]\n\n        # Calculate the required power to be radiated by impurities\n        P_rad_target = params[\"f_rad\"] * params[\"P_in\"]\n        delta_P = P_rad_target - B_core\n        \n        # Step 3a: Check if any impurity seeding is needed\n        if delta_P = 0:\n            return 0\n\n        # Step 2: Calculate required impurity density n_imp\n        # Denominator of the n_imp expression\n        brem_per_imp = B_core * (params[\"r_core\"] * params[\"Z_bar_sq\"] / params[\"n_e_core\"])\n        line_per_imp = params[\"n_e_line\"] * params[\"L_line\"] * params[\"V_line\"]\n        denominator = brem_per_imp + line_per_imp\n        \n        # Avoid division by zero, although physically unlikely with the given models\n        if denominator == 0:\n            return -1 # Infeasible if impurities have no radiative effect\n\n        n_imp_required = delta_P / denominator\n\n        # Step 3b: Impose the core effective ion charge constraint Z_eff,core = Z_eff,max\n        # which translates to a maximum impurity density n_imp,max\n        # Avoid division by zero if r_core or Z_bar_sq are zero\n        max_imp_denom = params[\"r_core\"] * params[\"Z_bar_sq\"]\n        if max_imp_denom == 0:\n            # If impurities don't affect Z_eff, the constraint is always met\n            n_imp_max = float('inf')\n        else:\n            n_imp_max = (params[\"n_e_core\"] * (params[\"Z_eff_max\"] - 1.0)) / max_imp_denom\n\n        if n_imp_required  n_imp_max:\n            return -1 # Infeasible if it violates the Z_eff constraint\n\n        # Step 4: Compute the required impurity seeding rate Q_imp\n        Q_imp = (n_imp_required * params[\"V_tot\"]) / params[\"tau_p\"]\n        \n        return Q_imp\n    \n    results = []\n    for case_params in test_cases:\n        result = calculate_seeding_rate(case_params, C_brem)\n        # Format -1 and 0 as integers for clarity in the output.\n        if isinstance(result, int) or result == 0:\n            results.append(int(result))\n        else:\n            results.append(result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3690607"}]}