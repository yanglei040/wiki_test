{"hands_on_practices": [{"introduction": "The sawtooth oscillation, driven by the $m=n=1$ internal kink mode, is one of the most fundamental magnetohydrodynamic (MHD) instabilities in a tokamak core. While often benign, it can act as a seed for more dangerous instabilities, making its analysis a crucial starting point for understanding disruption precursors. This practice guides you through the foundational physics of this mode, from deriving the ideal MHD instability criterion based on the safety factor profile to estimating the crash timescale using a resistive reconnection model [@problem_id:3708729]. Mastering this connection between ideal stability and resistive dynamics is essential for interpreting plasma behavior near the magnetic axis.", "problem": "Consider a large-aspect-ratio, circular-cross-section tokamak of major radius $R_0$ and minor radius $a$, with a monotonic safety factor profile $q(r)$ such that $q(0)=q_0$ and $q(r_1)=1$ at the radius $r_1$. Assume an equilibrium with dominant toroidal magnetic field $B_{\\phi}$ and poloidal magnetic field $B_{\\theta}(r)$ related to the safety factor by $q(r)=r B_{\\phi}/\\left(R_0 B_{\\theta}(r)\\right)$. The pressure profile $p(r)$ is smooth, and the equilibrium is in the low-plasma-beta limit so that magnetic field line bending dominates compressibility. Using the ideal magnetohydrodynamic (MHD) energy principle, take a helical trial displacement localized at the $q=1$ surface of the form $\\boldsymbol{\\xi}(r,\\theta,\\phi)=\\xi(r)\\,\\hat{\\boldsymbol{e}}_{r}\\,\\cos(\\theta-\\phi)$ with poloidal mode number $m=1$ and toroidal mode number $n=1$, and with $\\xi(r)$ strongly peaked around $r=r_1$. Starting from the ideal MHD energy principle and consistently applying the large-aspect-ratio ordering, derive the condition under which the change in potential energy $\\delta W$ for this $m=n=1$ internal kink perturbation becomes negative. State the resulting sawtooth crash criterion in terms of $q_0$ and the local properties at $r=r_1$, explicitly identifying the physical mechanism that sets the sign of $\\delta W$.\n\nNext, estimate the reconnection time in resistive magnetohydrodynamics (MHD) for the sawtooth crash, modeling the reconnection as a Sweet–Parker-type process at the $q=1$ rational surface. Use the reconnecting magnetic field to be the poloidal field at $r=r_1$, $B_{\\theta}(r_1)$, and take the characteristic current-sheet length to be the poloidal circumference $L=2\\pi r_1$. Define the Alfvén speed based on the reconnecting field as $v_{A\\theta}=B_{\\theta}(r_1)/\\sqrt{\\mu_0 \\rho}$, with mass density $\\rho=n_i m_i$. The reconnection time may be expressed in terms of the Alfvén time $\\tau_A=L/v_{A\\theta}$ and the Lundquist number $S=\\mu_0 L v_{A\\theta}/\\eta$, where $\\eta$ is the resistivity. For the following typical tokamak parameters:\n- $R_0=1.7 \\ \\mathrm{m}$,\n- $a=0.6 \\ \\mathrm{m}$,\n- $r_1=0.30 \\ \\mathrm{m}$,\n- $B_{\\phi}=3.0 \\ \\mathrm{T}$,\n- $q(r_1)=1$,\n- ion number density $n_i=5.0\\times 10^{19} \\ \\mathrm{m}^{-3}$,\n- ion mass $m_i=2 m_p$ with proton mass $m_p=1.6726\\times 10^{-27} \\ \\mathrm{kg}$,\n- magnetic permeability $\\mu_0=4\\pi\\times 10^{-7} \\ \\mathrm{H/m}$,\n- resistivity $\\eta=1.0\\times 10^{-6} \\ \\Omega \\cdot \\mathrm{m}$,\ncompute the reconnection time $t_{\\mathrm{rec}}$ using Sweet–Parker scaling and express the final numerical answer in millisecond (ms). Round your answer to three significant figures. The final answer must be a single real-valued number.", "solution": "The problem presents two distinct parts: first, a derivation of the ideal magnetohydrodynamic (MHD) instability criterion for the $m=n=1$ internal kink mode, which triggers the sawtooth crash; and second, a calculation of the reconnection time during the crash phase using the resistive MHD model of Sweet and Parker. The problem is scientifically grounded, well-posed, and all necessary parameters are provided for a complete solution.\n\n**Part 1: Ideal MHD Instability Criterion for the Sawtooth Crash**\n\nThe stability of the plasma against an ideal MHD perturbation $\\boldsymbol{\\xi}$ is determined by the sign of the change in potential energy, $\\delta W$. The system is unstable if a physically permissible displacement exists for which $\\delta W  0$. The general expression for $\\delta W$ is:\n$$ \\delta W = \\frac{1}{2} \\int \\left[ \\frac{|\\delta \\boldsymbol{B}|^2}{\\mu_0} - \\boldsymbol{J}_0 \\cdot (\\boldsymbol{\\xi} \\times \\delta \\boldsymbol{B}) + (\\boldsymbol{\\xi} \\cdot \\nabla p_0) (\\nabla \\cdot \\boldsymbol{\\xi}) + \\gamma p_0 (\\nabla \\cdot \\boldsymbol{\\xi})^2 \\right] dV $$\nwhere $\\delta \\boldsymbol{B} = \\nabla \\times (\\boldsymbol{\\xi} \\times \\boldsymbol{B}_0)$, and subscript $0$ denotes equilibrium quantities.\n\nFor a helical perturbation of the form $\\boldsymbol{\\xi} \\propto \\exp(i(m\\theta - n\\phi))$, the perturbed magnetic field contains a parallel wavevector component $k_{||} \\propto (m - nq(r))$. The dominant contribution to $\\delta W$ typically comes from the field line bending term, $|\\delta \\boldsymbol{B}|^2$, which scales as $k_{||}^2$. For the $m=n=1$ internal kink mode, this term is minimized at the rational surface $r=r_1$ where $q(r_1)=1$, making $k_{||}=0$. This allows for a large-amplitude perturbation with a relatively small energy cost.\n\nTo derive the instability criterion, we analyze $\\delta W$ for the specified trial function $\\boldsymbol{\\xi}(r,\\theta,\\phi)=\\xi(r)\\,\\hat{\\boldsymbol{e}}_{r}\\,\\cos(\\theta-\\phi)$, localized at the $q=1$ surface. In the large-aspect-ratio, circular-cross-section approximation, the analysis of $\\delta W$ shows that the energy change can be split into a contribution from the core region ($r  r_1$) and the outer region ($r  r_1$). The plasma in the outer region is stable to this mode, so any displacement there would cost a large amount of energy. Thus, the ideal mode is confined to the region $r \\le r_1$, and the displacement is taken to be zero for $rr_1$.\n\nWithin the core ($r  r_1$), the displacement that minimizes the energy is a quasi-rigid, \"top-hat\" motion of the entire plasma column, meaning $\\xi(r)$ is approximately constant for $r  r_1$ and drops sharply to zero at $r=r_1$. For such a displacement, $\\delta W$ consists of two main competing terms:\n1.  A stabilizing magnetic energy term, which is positive and depends on the deviation of the safety factor from unity within the core. This term is proportional to an integral over the volume $r  r_1$ of $(1-1/q)^2$.\n2.  A destabilizing pressure gradient term, which is negative (since $dp/dr  0$) and arises from the release of thermal energy as the plasma core shifts and expands into a region of weaker toroidal magnetic field.\n\nThe instability occurs when the destabilizing pressure term overcomes the stabilizing magnetic term. A key observation is that the stabilizing term is highly sensitive to the shape of the $q$-profile. If $q(0)=q_0$ is very close to $1$, then $q(r)$ remains close to $1$ throughout the core region $rr_1$. This makes the stabilizing integral $\\int_0^{r_1} (1-1/q)^2 r^3 dr$ extremely small. In this situation, any finite pressure gradient inside the $q=1$ surface is sufficient to make the total $\\delta W$ negative. Therefore, while the full condition (known as the Bussac criterion) involves a detailed balance depending on the pressure and current profiles, the practical criterion for instability in a realistic tokamak with finite pressure is that the safety factor on the magnetic axis, $q_0$, drops below unity.\n\nThe physical mechanism that sets the sign of $\\delta W$ is the competition between the stabilizing magnetic field line bending energy and the destabilizing potential energy available from the plasma pressure gradient in the toroidal geometry. The condition for the sawtooth crash trigger is thus $\\delta W  0$, which practically reduces to the criterion $q_0 \\lesssim 1$.\n\n**Part 2: Reconnection Time Calculation**\n\nThe sawtooth crash itself involves magnetic reconnection at the $q=1$ surface, a process governed by resistive MHD. We model this using the Sweet–Parker theory. The reconnection time $t_{\\mathrm{rec}}$ is given by the geometric mean of the resistive diffusion time $\\tau_R = \\mu_0 L^2 / \\eta$ and the Alfvén time $\\tau_A = L/v_{A\\theta}$. An equivalent expression for the reconnection time is $t_{\\mathrm{rec}} = \\tau_A \\sqrt{S}$, where $S$ is the Lundquist number. We are given the definitions $\\tau_A = L/v_{A\\theta}$ and $S = \\mu_0 L v_{A\\theta}/\\eta$, confirming that $t_{\\mathrm{rec}} = \\tau_A \\sqrt{S}$.\n\nFirst, we calculate the required physical quantities from the given parameters.\nThe characteristic length of the current sheet is the poloidal circumference at $r=r_1$:\n$$ L = 2\\pi r_1 = 2\\pi(0.30 \\ \\mathrm{m}) = 0.6\\pi \\ \\mathrm{m} $$\nThe reconnecting magnetic field is the poloidal field $B_{\\theta}(r_1)$. From the definition of the safety factor, $q(r)=r B_{\\phi}/\\left(R_0 B_{\\theta}(r)\\right)$, and with $q(r_1)=1$:\n$$ B_{\\theta}(r_1) = \\frac{r_1 B_{\\phi}}{R_0} = \\frac{(0.30 \\ \\mathrm{m})(3.0 \\ \\mathrm{T})}{1.7 \\ \\mathrm{m}} = \\frac{0.9}{1.7} \\ \\mathrm{T} $$\nThe plasma mass density $\\rho$ is given by $\\rho=n_i m_i$:\n$$ \\rho = (5.0 \\times 10^{19} \\ \\mathrm{m}^{-3}) \\times (2 \\times 1.6726 \\times 10^{-27} \\ \\mathrm{kg}) = 1.6726 \\times 10^{-7} \\ \\mathrm{kg \\cdot m^{-3}} $$\nThe Alfvén speed based on the reconnecting field, $v_{A\\theta}$, is:\n$$ v_{A\\theta} = \\frac{B_{\\theta}(r_1)}{\\sqrt{\\mu_0 \\rho}} = \\frac{0.9/1.7 \\ \\mathrm{T}}{\\sqrt{(4\\pi \\times 10^{-7} \\ \\mathrm{H/m})(1.6726 \\times 10^{-7} \\ \\mathrm{kg/m^3})}} \\approx 1.1548 \\times 10^6 \\ \\mathrm{m/s} $$\nThe Alfvén time $\\tau_A$ is:\n$$ \\tau_A = \\frac{L}{v_{A\\theta}} = \\frac{0.6\\pi \\ \\mathrm{m}}{1.1548 \\times 10^6 \\ \\mathrm{m/s}} \\approx 1.6323 \\times 10^{-6} \\ \\mathrm{s} $$\nThe Lundquist number $S$ is:\n$$ S = \\frac{\\mu_0 L v_{A\\theta}}{\\eta} = \\frac{(4\\pi \\times 10^{-7} \\ \\mathrm{H/m})(0.6\\pi \\ \\mathrm{m})(1.1548 \\times 10^6 \\ \\mathrm{m/s})}{1.0 \\times 10^{-6} \\ \\Omega \\cdot \\mathrm{m}} \\approx 2.7334 \\times 10^6 $$\nFinally, we compute the Sweet–Parker reconnection time $t_{\\mathrm{rec}}$:\n$$ t_{\\mathrm{rec}} = \\tau_A \\sqrt{S} = (1.6323 \\times 10^{-6} \\ \\mathrm{s}) \\sqrt{2.7334 \\times 10^6} \\approx 2.6989 \\times 10^{-3} \\ \\mathrm{s} $$\nConverting to milliseconds and rounding to three significant figures, we get:\n$$ t_{\\mathrm{rec}} \\approx 2.70 \\ \\mathrm{ms} $$", "answer": "$$\\boxed{2.70}$$", "id": "3708729"}, {"introduction": "Major disruptions often arise from a cascade of events, where a smaller instability triggers a larger, more destructive one. A classic example is the seeding of a Neoclassical Tearing Mode (NTM) by a sawtooth crash, a process that can lead to significant confinement degradation and ultimately a disruption. This exercise provides a hands-on opportunity to model this critical coupling mechanism using a reduced analytical framework [@problem_id:3708752]. By calculating the stability of the internal kink mode and the resulting seed island it generates at the $q=2$ surface, you will develop a quantitative understanding of how events in the plasma core can impact stability in the outer confinement region.", "problem": "Consider a large-aspect-ratio, circular tokamak with major radius $R$, minor radius $a$, and constant toroidal magnetic field $B_t$. The safety factor profile is measured and well-fit near the magnetic axis by a polynomial in the normalized minor radius $x = r/a$:\n$$\nq(r) = q_0 + c_2 x^2 + c_4 x^4,\n$$\nwhere $q_0$, $c_2$, and $c_4$ are nonnegative constants, and $r \\in [0,a]$. The magnetic shear is defined as\n$$\ns(r) = \\frac{r}{q(r)} \\frac{dq}{dr}.\n$$\nFor the polynomial model above, compute $\\frac{dq}{dr}$ and $s(r)$ explicitly in terms of $x$, $q_0$, $c_2$, $c_4$, and $a$. The poloidal magnetic field for a large-aspect-ratio tokamak is approximated by\n$$\nB_\\theta(r) = \\frac{r B_t}{R q(r)}.\n$$\n\nWe wish to assess susceptibility to sawtooth-triggered neoclassical tearing mode (NTM) seeding when the on-axis safety factor is slightly above unity. In a reduced analytic forecast model, we define the following steps:\n\n1. Hypothesize a small safety-factor decrement $\\delta_q  0$ due to slow current diffusion between sawtooth events and define the prospective $q=1$ surface radius $r_1$ as the solution in $[0,a]$ of\n$$\nq(r) - \\delta_q = 1.\n$$\nIn terms of $x=r/a$, let $y = x^2$. Then $r_1$ exists if and only if the equation\n$$\nc_4 y^2 + c_2 y - D = 0, \\quad \\text{where} \\quad D = 1 + \\delta_q - q_0,\n$$\nhas a solution $y$ with $0 \\le y \\le 1$. If $c_4 = 0$, the equation reduces to $c_2 y - D = 0$. If $D \\le 0$ or the computed $y$ is not in $[0,1]$, then no prospective $q=1$ surface forms under the hypothesized decrement. In that case, define the internal kink marginality as stable by setting the marginality index to $1$ and the seed island width to $0$.\n\n2. If $r_1$ exists, evaluate the magnetic shear at $r_1$,\n$$\ns_1 = s(r_1),\n$$\nand define an effective poloidal beta inside the $q=1$ core using a global poloidal field scale and a core volume scaling:\n$$\n\\beta_{p,\\mathrm{eff}} = \\left( \\frac{2 \\mu_0 p_0}{B_\\theta(a)^2} \\right) \\left( \\frac{r_1}{a} \\right)^2,\n$$\nwhere $\\mu_0$ is the magnetic permeability of free space and $p_0$ is the central pressure. Using an energy-principle-inspired reduced model, define the internal kink marginality index as\n$$\n\\mathcal{M} = 1 - \\frac{\\beta_{p,\\mathrm{eff}}}{\\frac{1}{2} s_1^2}.\n$$\nHere, $\\mathcal{M} \\approx 0$ indicates marginality, $\\mathcal{M}  0$ indicates instability under the hypothesized decrement, and $\\mathcal{M}  0$ indicates stability.\n\n3. For NTM seeding, focus on the $m/n = 2/1$ rational surface (that is, the $q=2$ surface). Define $r_s$ as any solution in $[0,a]$ of\n$$\nq(r_s) = 2.\n$$\nIn terms of $y = x^2$, this is\n$$\nc_4 y^2 + c_2 y + (q_0 - 2) = 0,\n$$\nwith $y \\in [0,1]$. If there is no such $r_s$, set the seed island width to $0$.\n\n4. If both $r_1$ and $r_s$ exist, define a reduced coupling model for the sawtooth-seeded initial island half-width at the $q=2$ surface:\n$$\nw_{\\mathrm{seed}} = C \\, \\frac{r_1^2}{R} \\, \\frac{B_\\theta(r_1)}{B_\\theta(r_s)} \\, \\frac{1}{\\sqrt{s(r_s)}},\n$$\nwhere $C$ is a dimensionless coupling constant set to $C = 10$ to represent finite-$m$ coupling efficiency from the core crash to the outer rational surface in a large-aspect-ratio device. This model is dimensionally consistent and scales seed size with the core displacement scale $r_1$, the field-line pitch ratio, and local shear at the $q=2$ surface.\n\nUsing the above definitions, implement a program that, for each test case, computes:\n- The internal kink marginality index $\\mathcal{M}$ (dimensionless).\n- The associated seed island width $w_{\\mathrm{seed}}$ at the $q=2$ surface in meters.\n\nExpress $w_{\\mathrm{seed}}$ in meters and round both outputs to six decimal places.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element is the pair for one test case in the form $[\\mathcal{M}, w_{\\mathrm{seed}}]$. For example, the output format must be:\n$$\n[\\,[\\mathcal{M}_1, w_{\\mathrm{seed},1}], [\\mathcal{M}_2, w_{\\mathrm{seed},2}], \\dots ]\n$$\n\nTest Suite:\nUse the following parameter sets, each defined by $(R, a, B_t, p_0, q_0, c_2, c_4, \\delta_q)$ with $R$ in meters, $a$ in meters, $B_t$ in tesla, $p_0$ in pascals, and $\\delta_q$ dimensionless:\n- Case 1: $(3.0, 1.0, 5.0, 1.2 \\times 10^5, 1.03, 0.9, 0.4, 0.04)$\n- Case 2: $(2.8, 0.9, 5.3, 1.8 \\times 10^5, 1.01, 1.1, 0.6, 0.02)$\n- Case 3 (no $q=1$ crossing under the decrement): $(3.2, 1.1, 4.8, 1.0 \\times 10^5, 1.10, 0.7, 0.3, 0.05)$\n- Case 4 (no $q=2$ surface in the profile): $(2.7, 0.95, 5.5, 1.5 \\times 10^5, 1.02, 0.5, 0.1, 0.03)$\n\nYour program must:\n- Implement the above reduced model consistently.\n- Use the magnetic permeability of free space $\\mu_0 = 4 \\pi \\times 10^{-7} \\, \\mathrm{N \\, A^{-2}}$.\n- Return $[\\mathcal{M}, w_{\\mathrm{seed}}]$ for each case, rounding to six decimal places.\n- Print a single line containing a list of these pairs for all test cases in the exact format described above.", "solution": "The problem is subjected to validation before a solution is attempted.\n\n### Step 1: Extract Givens\n\n**Constants and Variables:**\n- Major radius: $R$ (m)\n- Minor radius: $a$ (m)\n- Toroidal magnetic field: $B_t$ (T)\n- Central pressure: $p_0$ (Pa)\n- Safety factor on-axis: $q_0$ (dimensionless)\n- Safety factor profile coefficients: $c_2, c_4$ (dimensionless)\n- Safety-factor decrement: $\\delta_q$ (dimensionless)\n- Normalized minor radius: $x = r/a$, where $r \\in [0, a]$ is the minor radius coordinate.\n- Magnetic permeability of free space: $\\mu_0 = 4 \\pi \\times 10^{-7} \\, \\mathrm{N \\, A^{-2}}$\n- Dimensionless coupling constant: $C=10$\n\n**Model Definitions:**\n1.  **Safety factor profile:** $q(r) = q_0 + c_2 x^2 + c_4 x^4$\n2.  **Magnetic shear:** $s(r) = \\frac{r}{q(r)} \\frac{dq}{dr}$\n3.  **Poloidal magnetic field (large-aspect-ratio):** $B_\\theta(r) = \\frac{r B_t}{R q(r)}$\n4.  **Prospective $q=1$ surface radius ($r_1$):** Defined as the solution to $q(r_1) - \\delta_q = 1$. This is equivalent to solving $c_4 y^2 + c_2 y - D = 0$ for $y = (r_1/a)^2$, where $D = 1 + \\delta_q - q_0$.\n    -   **Condition:** A valid $r_1$ exists if and only if a solution $y$ exists in the range $[0, 1]$.\n    -   **No-$r_1$ case:** If $D \\le 0$ or the computed $y \\notin [0,1]$, the marginality index is set to $\\mathcal{M}=1$ and the seed island width to $w_{\\mathrm{seed}}=0$.\n5.  **Magnetic shear at $r_1$:** $s_1 = s(r_1)$\n6.  **Effective poloidal beta:** $\\beta_{p,\\mathrm{eff}} = \\left( \\frac{2 \\mu_0 p_0}{B_\\theta(a)^2} \\right) \\left( \\frac{r_1}{a} \\right)^2$\n7.  **Internal kink marginality index:** $\\mathcal{M} = 1 - \\frac{\\beta_{p,\\mathrm{eff}}}{\\frac{1}{2} s_1^2}$\n8.  **$q=2$ surface radius ($r_s$):** Defined as any solution to $q(r_s) = 2$ within $[0,a]$. This is equivalent to solving $c_4 y^2 + c_2 y + (q_0 - 2) = 0$ for $y=(r_s/a)^2 \\in [0,1]$.\n    -   **No-$r_s$ case:** If no such $r_s$ exists, set $w_{\\mathrm{seed}}=0$.\n9.  **Seed island width:** $w_{\\mathrm{seed}} = C \\, \\frac{r_1^2}{R} \\, \\frac{B_\\theta(r_1)}{B_\\theta(r_s)} \\, \\frac{1}{\\sqrt{s(r_s)}}$ (if both $r_1$ and $r_s$ exist).\n\n**Test Suite:**\n- Case 1: $(R, a, B_t, p_0, q_0, c_2, c_4, \\delta_q) = (3.0, 1.0, 5.0, 1.2 \\times 10^5, 1.03, 0.9, 0.4, 0.04)$\n- Case 2: $(2.8, 0.9, 5.3, 1.8 \\times 10^5, 1.01, 1.1, 0.6, 0.02)$\n- Case 3: $(3.2, 1.1, 4.8, 1.0 \\times 10^5, 1.10, 0.7, 0.3, 0.05)$\n- Case 4: $(2.7, 0.95, 5.5, 1.5 \\times 10^5, 1.02, 0.5, 0.1, 0.03)$\n\n**Outputs:**\n- For each case, compute the internal kink marginality index $\\mathcal{M}$ and the seed island width $w_{\\mathrm{seed}}$ (in meters).\n- Round both outputs to six decimal places.\n- The final output is a single line: `[[M1,w1],[M2,w2],...]`\n\n### Step 2: Validate Using Extracted Givens\n\n1.  **Scientifically Grounded:** The problem is set in the context of tokamak plasma stability, a well-established subfield of nuclear fusion research. The concepts used—safety factor ($q$), magnetic shear ($s$), poloidal beta ($\\beta_p$), neoclassical tearing modes (NTMs), and sawteeth—are standard. The equations provided constitute a \"reduced analytic forecast model,\" which is a common approach in physics to capture essential dynamics with simplified, yet physically motivated, formulas. The polynomial form for $q(r)$ near the axis and the large-aspect-ratio approximation for $B_\\theta(r)$ are standard textbook material. The model for $\\mathcal{M}$ is described as \"energy-principle-inspired,\" and the model for $w_{\\mathrm{seed}}$ includes physically relevant scaling with core displacement ($r_1^2/R$), field line pitch ratio ($B_\\theta(r_1)/B_\\theta(r_s)$), and local magnetic shear ($s(r_s)$). The problem is scientifically sound within its stated scope as a reduced model.\n\n2.  **Well-Posed:** The problem provides a complete, step-by-step algorithm for computing the outputs. It explicitly defines all variables and relationships. Crucially, it provides clear instructions for handling all contingencies, such as the non-existence of the $q=1$ or $q=2$ surfaces. The conditions for the existence of these surfaces are unambiguously defined through the solvability of quadratic equations within a specific physical domain ($y \\in [0,1]$). This structure ensures that a unique and meaningful solution can be computed for any valid set of input parameters.\n\n3.  **Objective:** The problem statement uses precise, quantitative, and objective language. There are no subjective claims or opinions. The purpose of the model as a \"reduced analytic forecast model\" is an objective characterization.\n\n4.  **Other Flaws:** The problem is self-contained, with all necessary data and constants provided. The parameters in the test cases are physically plausible for tokamak experiments. There are no contradictions, circular reasoning, or ambiguities.\n\n### Step 3: Verdict and Action\n\nThe problem statement is **valid**. It is scientifically grounded, well-posed, objective, and complete. I will now proceed with the solution.\n\n### Solution Derivations and Algorithm\n\nFirst, we derive the explicit expressions required for the calculation. Given the safety factor profile in terms of $x=r/a$:\n$$\nq(x) = q_0 + c_2 x^2 + c_4 x^4\n$$\nThe derivative with respect to $r$ is found using the chain rule, $\\frac{dq}{dr} = \\frac{dq}{dx} \\frac{dx}{dr}$:\n$$\n\\frac{dq}{dx} = 2 c_2 x + 4 c_4 x^3\n$$\n$$\n\\frac{dx}{dr} = \\frac{1}{a}\n$$\nThus,\n$$\n\\frac{dq}{dr} = \\frac{1}{a} (2 c_2 x + 4 c_4 x^3)\n$$\nThe magnetic shear $s(r)$ is then:\n$$\ns(r) = \\frac{r}{q(r)} \\frac{dq}{dr} = \\frac{ax}{q(x)} \\frac{1}{a}(2 c_2 x + 4 c_4 x^3) = \\frac{2 c_2 x^2 + 4 c_4 x^4}{q_0 + c_2 x^2 + c_4 x^4}\n$$\nThe algorithm for each test case proceeds as follows:\n\n1.  **Initialize:** Set the marginality index $\\mathcal{M} = 1.0$ and seed width $w_{\\mathrm{seed}} = 0.0$. These are the default values if the prospective $q=1$ surface does not form.\n\n2.  **Find the prospective $q=1$ surface ($r_1$):**\n    a. Calculate $D = 1 + \\delta_q - q_0$.\n    b. If $D \\le 0$, the $q=1$ surface does not form. The algorithm terminates for this case, retaining the default outputs.\n    c. If $D  0$, solve for $y_1 = (r_1/a)^2$ from the equation $c_4 y^2 + c_2 y - D = 0$. Since $c_2, c_4 \\ge 0$ and we require a physical solution $y_1 \\ge 0$, the correct root is $y_1 = \\frac{-c_2 + \\sqrt{c_2^2 + 4c_4 D}}{2c_4}$ for $c_4  0$, and $y_1 = D/c_2$ for $c_4=0$.\n    d. If a positive solution $y_1$ exists and $y_1 \\in [0,1]$, then a valid $r_1$ exists. We proceed to the next steps. Otherwise, we retain the default outputs.\n\n3.  **Calculate the marginality index ($\\mathcal{M}$):**\n    a. The shear at $r_1$ is $s_1 = s(r_1)$. Using $x_1^2 = y_1$ and $q(r_1) = 1+\\delta_q$, the shear expression simplifies to $s_1 = \\frac{2c_2 y_1 + 4c_4 y_1^2}{1+\\delta_q}$.\n    b. The safety factor at the plasma edge ($r=a$, $x=1$) is $q(a) = q_0 + c_2 + c_4$.\n    c. The poloidal field at the edge is $B_\\theta(a) = \\frac{a B_t}{R q(a)}$.\n    d. The effective poloidal beta is $\\beta_{p,\\mathrm{eff}} = \\left( \\frac{2 \\mu_0 p_0}{B_\\theta(a)^2} \\right) y_1$.\n    e. The marginality index is $\\mathcal{M} = 1 - \\frac{\\beta_{p,\\mathrm{eff}}}{0.5 s_1^2}$. This value overwrites the default $\\mathcal{M}=1.0$.\n\n4.  **Find the $q=2$ surface ($r_s$):**\n    a. Solve for $y_s = (r_s/a)^2$ from the equation $c_4 y^2 + c_2 y + (q_0 - 2) = 0$. For a physical solution to exist ($y_s0$), we must have $q_0-2  0$. The correct root is $y_s = \\frac{-c_2 + \\sqrt{c_2^2 - 4c_4(q_0-2)}}{2c_4}$ for $c_40$, and $y_s = (2-q_0)/c_2$ for $c_4=0$.\n    b. Check if a solution exists and $y_s \\in [0,1]$. If not, $w_{\\mathrm{seed}}$ remains $0.0$.\n\n5.  **Calculate the seed island width ($w_{\\mathrm{seed}}$):**\n    a. This step is performed only if valid $r_1$ and $r_s$ were found.\n    b. The ratio of poloidal fields is $\\frac{B_\\theta(r_1)}{B_\\theta(r_s)} = \\frac{r_1 q(r_s)}{r_s q(r_1)} = \\frac{a \\sqrt{y_1} \\cdot 2}{a \\sqrt{y_s} (1+\\delta_q)} = \\frac{2 \\sqrt{y_1}}{\\sqrt{y_s} (1+\\delta_q)}$.\n    c. The shear at $r_s$ is $s(r_s) = \\frac{2c_2 y_s + 4c_4 y_s^2}{q(r_s)} = \\frac{2c_2 y_s + 4c_4 y_s^2}{2} = c_2 y_s + 2c_4 y_s^2$.\n    d. The seed width is calculated as $w_{\\mathrm{seed}} = C \\frac{r_1^2}{R} \\frac{B_\\theta(r_1)}{B_\\theta(r_s)} \\frac{1}{\\sqrt{s(r_s)}} = 10 \\frac{a^2 y_1}{R} \\frac{2\\sqrt{y_1}}{\\sqrt{y_s}(1+\\delta_q)} \\frac{1}{\\sqrt{c_2 y_s + 2c_4 y_s^2}}$. This value overwrites the default $w_{\\mathrm{seed}}=0.0$.\n\n6.  **Finalize:** The computed values of $\\mathcal{M}$ and $w_{\\mathrm{seed}}$ are rounded to six decimal places.\n\nThis procedure is implemented for each test case provided.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the internal kink marginality and NTM seed island width\n    for a series of tokamak scenarios based on a reduced model.\n    \"\"\"\n    \n    # Magnetic permeability of free space (N/A^2 or H/m)\n    MU_0 = 4 * np.pi * 1e-7\n    \n    # Coupling constant from the model\n    C_COUPLING = 10.0\n\n    test_cases = [\n        # (R, a, B_t, p0, q0, c2, c4, delta_q)\n        (3.0, 1.0, 5.0, 1.2e5, 1.03, 0.9, 0.4, 0.04),\n        (2.8, 0.9, 5.3, 1.8e5, 1.01, 1.1, 0.6, 0.02),\n        (3.2, 1.1, 4.8, 1.0e5, 1.10, 0.7, 0.3, 0.05),\n        (2.7, 0.95, 5.5, 1.5e5, 1.02, 0.5, 0.1, 0.03),\n    ]\n\n    results = []\n\n    for case in test_cases:\n        R, a, B_t, p0, q0, c2, c4, delta_q = case\n        \n        # Default values for a stable case or if no q=1 surface forms\n        M_index = 1.0\n        w_seed = 0.0\n\n        # --- Step 1  2: Find r1 and compute Marginality Index M ---\n        D = 1.0 + delta_q - q0\n        \n        r1_exists = False\n        y1 = -1.0 # Normalized radius squared (r1/a)^2\n\n        if D > 0:\n            if c4 == 0:\n                if c2 > 0:\n                    y1 = D / c2\n            else: # c4 > 0\n                discriminant = c2**2 + 4 * c4 * D\n                y1 = (-c2 + np.sqrt(discriminant)) / (2 * c4)\n            \n            if 0 = y1 = 1:\n                r1_exists = True\n\n        if r1_exists:\n            # Calculate Marginality Index M\n            q_at_r1 = 1.0 + delta_q\n            s1 = (2 * c2 * y1 + 4 * c4 * y1**2) / q_at_r1\n            \n            q_at_a = q0 + c2 + c4\n            B_theta_a = (a * B_t) / (R * q_at_a)\n            \n            beta_p_eff = (2 * MU_0 * p0 / (B_theta_a**2)) * y1\n            \n            # Avoid division by zero, although s1 > 0 if r1 is not on axis.\n            if s1 > 1e-9:\n                M_index = 1.0 - beta_p_eff / (0.5 * s1**2)\n\n            # --- Step 3  4: Find rs and compute seed island width w_seed ---\n            rs_exists = False\n            ys = -1.0 # Normalized radius squared (rs/a)^2\n            const_term = q0 - 2.0\n\n            if c4 == 0:\n                if c2 > 0 and const_term  0:\n                    ys = -const_term / c2\n            else: # c4 > 0\n                if const_term  0:\n                    discriminant = c2**2 - 4 * c4 * const_term\n                    if discriminant >= 0:\n                        ys = (-c2 + np.sqrt(discriminant)) / (2 * c4)\n\n            if 0 = ys = 1:\n                rs_exists = True\n\n            if rs_exists:\n                # Calculate shear at q=2 surface, s(rs)\n                # q(rs) = 2\n                s_at_rs = (2 * c2 * ys + 4 * c4 * ys**2) / 2.0\n                \n                if s_at_rs > 0:\n                    r1_sq = a**2 * y1\n                    \n                    # B_theta ratio term: B_theta(r1) / B_theta(rs)\n                    # = (r1 * q(rs)) / (rs * q(r1))\n                    # = (sqrt(y1)*a * 2) / (sqrt(ys)*a * (1+delta_q))\n                    B_theta_ratio = (2.0 * np.sqrt(y1)) / (np.sqrt(ys) * (1 + delta_q))\n                    \n                    w_seed = C_COUPLING * (r1_sq / R) * B_theta_ratio / np.sqrt(s_at_rs)\n\n        results.append([round(M_index, 6), round(w_seed, 6)])\n    \n    # Format the final output string exactly as required\n    inner_parts = [f\"[{m},{w}]\" for m, w in results]\n    print(f\"[[{','.join(inner_parts)}]]\")\n\nsolve()\n```", "id": "3708752"}, {"introduction": "Beyond purely magnetic instabilities, disruptions can be triggered by a thermal collapse when radiative losses overwhelm the plasma heating. This \"radiative collapse\" is often caused by the accumulation of impurities in the plasma core, which radiate energy much more efficiently than the primary hydrogenic fuel. This computational practice challenges you to quantify this risk by integrating impurity radiation models with plasma profiles to calculate the total radiated power [@problem_id:3708706]. This exercise simulates a key task in disruption prediction: determining the critical impurity concentration and temperature range where a thermal quench becomes inevitable.", "problem": "A program must compute, from first principles of energy balance and collisional-radiative cooling, whether core impurity radiation can reach a level that precipitates thermal collapse in a toroidal magnetic confinement device. Consider a circular cross-section torus of major radius $R_0$ and minor radius $a$, with cylindrical symmetry. The toroidal volume element for a thin annulus at minor radius $r$ is $dV = 4 \\pi^2 R_0 r \\, dr$. The objective is to calculate the core radiated power due to a specified impurity species from the impurity radiation function $L_Z(T)$, and to determine the range of core temperatures where this core radiation exceeds a specified fraction of the input heating power.\n\nUse the following physics base:\n- The energy balance is $dW/dt = P_{\\text{in}} - P_{\\text{loss}}$, where $P_{\\text{loss}}$ includes radiation. A sufficient condition for imminent thermal collapse in the core is $P_{\\text{rad, core}} \\ge \\beta P_{\\text{in}}$, where $\\beta$ is a prescribed fraction, $P_{\\text{in}}$ is total heating power (assumed constant), and $P_{\\text{rad, core}}$ is the impurity core radiated power.\n- The local radiated power density due to an impurity species $Z$ is $p_{\\text{rad}}(r) = n_e(r)\\, n_Z(r)\\, L_Z\\!\\left(T_e(r)\\right)$, with $n_e$ the electron density, $n_Z$ the impurity density, and $L_Z(T)$ the impurity radiation function (cooling-rate coefficient) in $\\text{W}\\cdot\\text{m}^3$ under coronal equilibrium.\n- The core region is defined as $r \\in [0, r_c]$ with $r_c = \\gamma a$, where $\\gamma$ is a given fraction of the minor radius. The core radiated power is $P_{\\text{rad, core}}(T_0) = \\displaystyle \\int_0^{r_c} n_e(r)\\, n_Z(r)\\, L_Z\\!\\left(T_e(r)\\right)\\, 4 \\pi^2 R_0 r \\, dr$, evaluated for a given central temperature $T_0$.\n\nProfiles and units:\n- Electron density profile: $n_e(r) = n_0 \\left[1 - \\left(\\dfrac{r}{a}\\right)^2\\right]^{s_n}$, with $n_0$ in $\\text{m}^{-3}$ and $s_n \\ge 0$ dimensionless.\n- Impurity fraction profile: $f_Z(r) = f_{Z,\\text{edge}} + \\left(f_{Z,0} - f_{Z,\\text{edge}}\\right) \\left[1 - \\left(\\dfrac{r}{a}\\right)^{p_f}\\right]$, with $f_{Z,0}$ and $f_{Z,\\text{edge}}$ dimensionless; impurity density is $n_Z(r) = f_Z(r)\\, n_e(r)$.\n- Electron temperature profile: $T_e(r) = T_{\\text{edge}} + \\left(T_0 - T_{\\text{edge}}\\right) \\left[1 - \\left(\\dfrac{r}{a}\\right)^{\\alpha_T}\\right]$, with $T$ in $\\text{keV}$. The radiation function $L_Z$ is evaluated at $T_e$ converted to $\\text{eV}$ via $T[\\text{eV}] = 1000\\, T[\\text{keV}]$.\n- Collapse criterion: $P_{\\text{rad, core}}(T_0) \\ge \\beta P_{\\text{in}}$.\n- Required output units: report $T$ values in $\\text{keV}$ and powers in $\\text{MW}$.\n\nImpurity radiation functions $L_Z(T)$ to be used (plausible analytic approximations in $\\text{W}\\cdot\\text{m}^3$ with $T$ in $\\text{eV}$):\n- Neon ($Z=\\text{Ne}$): $L_{\\text{Ne}}(T) = 3.0\\times 10^{-31} \\left(\\dfrac{T}{150.0}\\right)^{0.2} \\exp\\!\\left(-\\dfrac{T}{250.0}\\right) + 1.0\\times 10^{-32} \\left(\\dfrac{T}{1000.0}\\right)^{0.5} \\exp\\!\\left(-\\dfrac{T}{5000.0}\\right)$.\n- Argon ($Z=\\text{Ar}$): $L_{\\text{Ar}}(T) = 1.5\\times 10^{-31} \\left(\\dfrac{T}{1500.0}\\right)^{0.4} \\exp\\!\\left(-\\dfrac{T}{2200.0}\\right) + 3.0\\times 10^{-32} \\left(\\dfrac{T}{6000.0}\\right)^{0.5} \\exp\\!\\left(-\\dfrac{T}{8000.0}\\right)$.\n\nAlgorithmic task:\nFor each test case, scan the central temperature $T_0$ over a specified interval $[T_{\\min}, T_{\\max}]$ with $N_T$ evenly spaced samples. For each $T_0$, compute $P_{\\text{rad, core}}(T_0)$; determine:\n- The temperature $T_{\\text{pk}}$ at which $P_{\\text{rad, core}}$ attains its maximum over the scan, and the corresponding peak core radiated power $P_{\\text{pk}}$.\n- The interval of $T_0$ values for which the collapse criterion holds, summarized by the smallest and largest $T_0$ in the scan that satisfy $P_{\\text{rad, core}}(T_0) \\ge \\beta P_{\\text{in}}$. If no $T_0$ satisfies the criterion, report $T_{\\min}^{\\text{collapse}} = 0.0$ and $T_{\\max}^{\\text{collapse}} = 0.0$.\n\nTest suite:\nProvide the following four test cases, each defined by a tuple of parameters $(\\text{species}, R_0, a, n_0, s_n, f_{Z,0}, f_{Z,\\text{edge}}, p_f, T_{\\text{edge}}, \\alpha_T, \\gamma, P_{\\text{in}}, \\beta, T_{\\min}, T_{\\max}, N_T)$ with units as specified above:\n- Case $1$ (happy path, Neon, medium device and doping): $(\\text{\"Ne\"},\\, 1.7,\\, 0.5,\\, 8.0\\times 10^{19},\\, 1.0,\\, 5.0\\times 10^{-3},\\, 2.0\\times 10^{-3},\\, 1.0,\\, 0.1,\\, 2.0,\\, 0.3,\\, 8.0\\times 10^{6},\\, 0.3,\\, 0.5,\\, 5.0,\\, 120)$.\n- Case $2$ (high heating, Argon, low doping, likely no collapse): $(\\text{\"Ar\"},\\, 1.7,\\, 0.5,\\, 8.0\\times 10^{19},\\, 1.0,\\, 1.0\\times 10^{-3},\\, 5.0\\times 10^{-4},\\, 1.0,\\, 0.5,\\, 2.0,\\, 0.3,\\, 2.5\\times 10^{7},\\, 0.3,\\, 1.0,\\, 10.0,\\, 120)$.\n- Case $3$ (strong Neon doping, lower heating, collapse-prone): $(\\text{\"Ne\"},\\, 1.7,\\, 0.5,\\, 8.0\\times 10^{19},\\, 1.0,\\, 1.0\\times 10^{-2},\\, 5.0\\times 10^{-3},\\, 1.0,\\, 0.1,\\, 2.0,\\, 0.3,\\, 6.0\\times 10^{6},\\, 0.3,\\, 0.3,\\, 3.0,\\, 120)$.\n- Case $4$ (smaller device, Argon, moderate doping, modest heating): $(\\text{\"Ar\"},\\, 1.0,\\, 0.4,\\, 6.0\\times 10^{19},\\, 1.0,\\, 3.0\\times 10^{-3},\\, 1.0\\times 10^{-3},\\, 1.0,\\, 0.2,\\, 2.0,\\, 0.3,\\, 5.0\\times 10^{6},\\, 0.3,\\, 0.5,\\, 5.0,\\, 120)$.\n\nFinal output format:\nYour program should produce a single line of output containing a list of four sublists, one per test case, each sublist in the form $[T_{\\text{pk}}, P_{\\text{pk}}, T_{\\min}^{\\text{collapse}}, T_{\\max}^{\\text{collapse}}]$ where $T_{\\text{pk}}$, $T_{\\min}^{\\text{collapse}}$, and $T_{\\max}^{\\text{collapse}}$ are in $\\text{keV}$ and $P_{\\text{pk}}$ is in $\\text{MW}$. The single line must be a comma-separated list enclosed in square brackets, with numeric values rounded in the printed output to six decimal places, for example $[[0.750000,1.234567,0.300000,1.200000],[\\dots]]$.", "solution": "The problem is valid as it is scientifically grounded in established principles of plasma physics, is mathematically well-posed, and provides a complete and consistent set of data and definitions. The task is to compute the radiated power from impurities in the core of a toroidal fusion plasma and to assess the risk of a thermal collapse based on this radiation.\n\nThe core of the problem is the calculation of the total radiated power from a specified impurity species within the plasma core, defined as the region $r \\in [0, r_c]$, where $r_c = \\gamma a$. The total core radiated power, $P_{\\text{rad, core}}$, as a function of the central electron temperature $T_0$, is given by the volume integral of the local radiated power density, $p_{\\text{rad}}(r)$.\n\nThe local radiated power density is given by:\n$$p_{\\text{rad}}(r) = n_e(r) \\, n_Z(r) \\, L_Z(T_e(r))$$\nwhere $n_e(r)$ is the electron density profile, $n_Z(r)$ is the impurity density profile, and $L_Z(T_e(r))$ is the impurity radiation function (cooling-rate coefficient) evaluated at the local electron temperature $T_e(r)$. The temperature must be in units of $\\text{eV}$ for the $L_Z$ function, while the profile is defined in $\\text{keV}$, requiring a conversion $T[\\text{eV}] = 1000 \\cdot T[\\text{keV}]$.\n\nThe impurity density $n_Z(r)$ is related to the electron density $n_e(r)$ through the impurity fraction profile $f_Z(r)$:\n$$n_Z(r) = f_Z(r) \\, n_e(r)$$\nSubstituting this into the power density expression gives:\n$$p_{\\text{rad}}(r) = n_e(r)^2 \\, f_Z(r) \\, L_Z(T_e(r))$$\n\nThe total power is found by integrating this power density over the core volume. Using the provided toroidal volume element for a thin annulus, $dV = 4 \\pi^2 R_0 r \\, dr$, the integral for the core radiated power becomes:\n$$P_{\\text{rad, core}}(T_0) = \\int_0^{r_c} p_{\\text{rad}}(r) \\, dV = \\int_0^{r_c} n_e(r)^2 \\, f_Z(r) \\, L_Z(T_e(r)) \\, 4 \\pi^2 R_0 r \\, dr$$\n\nThe profiles for electron density $n_e(r)$, impurity fraction $f_Z(r)$, and electron temperature $T_e(r)$ are given as follows:\n1.  Electron density profile:\n    $$n_e(r) = n_0 \\left[1 - \\left(\\frac{r}{a}\\right)^2\\right]^{s_n}$$\n2.  Impurity fraction profile:\n    $$f_Z(r) = f_{Z,\\text{edge}} + (f_{Z,0} - f_{Z,\\text{edge}}) \\left[1 - \\left(\\frac{r}{a}\\right)^{p_f}\\right]$$\n3.  Electron temperature profile (dependent on the central temperature $T_0$):\n    $$T_e(r) = T_{\\text{edge}} + (T_0 - T_{\\text{edge}}) \\left[1 - \\left(\\frac{r}{a}\\right)^{\\alpha_T}\\right]$$\n\nThe analytic forms for the impurity radiation functions $L_Z(T)$ for Neon ($Z=\\text{Ne}$) and Argon ($Z=\\text{Ar}$) are also provided, with temperature $T$ in $\\text{eV}$.\n\nThe analytical solution to the integral for $P_{\\text{rad, core}}(T_0)$ is not feasible due to the complexity of the integrand, which involves products of powers and exponential functions of radially-dependent terms. Therefore, a numerical approach is required.\n\nThe algorithmic procedure is as follows:\n1.  Define a discrete set of central temperatures $T_0$ to be evaluated, spanning the interval $[T_{\\min}, T_{\\max}]$ with $N_T$ points. This is achieved using a linear spacing: $T_{0,i} = T_{\\min} + i \\cdot \\frac{T_{\\max} - T_{\\min}}{N_T - 1}$ for $i=0, 1, \\dots, N_T-1$.\n2.  For each value of $T_{0,i}$ in the scan:\n    a.  Construct the full integrand function, $I(r, T_{0,i}) = n_e(r)^2 \\, f_Z(r) \\, L_Z(1000 \\cdot T_e(r, T_{0,i})) \\, 4 \\pi^2 R_0 r$.\n    b.  Numerically integrate $I(r, T_{0,i})$ with respect to the minor radius $r$ from $0$ to the core radius $r_c = \\gamma a$. A robust numerical quadrature method, such as the one provided by `scipy.integrate.quad`, is suitable for this task. The result of this integration is $P_{\\text{rad, core}}(T_{0,i})$ in units of Watts, provided all input parameters are in SI units.\n3.  After computing the array of $P_{\\text{rad, core}}$ values for all $T_0$ in the scan, analyze the results:\n    a.  Find the maximum value of the core radiated power, $P_{\\text{pk}} = \\max(P_{\\text{rad, core}}(T_{0,i}))$. The corresponding central temperature is $T_{\\text{pk}}$. The power unit must be converted from W to MW ($1 \\, \\text{MW} = 10^6 \\, \\text{W}$).\n    b.  Determine the thermal collapse condition. A collapse is considered imminent if $P_{\\text{rad, core}}(T_0) \\ge \\beta P_{\\text{in}}$. The threshold power $P_{\\text{threshold}} = \\beta P_{\\text{in}}$ is a constant for a given test case.\n    c.  Identify all temperatures $T_0$ in the scan that satisfy this collapse criterion. The required output is the minimum and maximum such temperatures, denoted $T_{\\min}^{\\text{collapse}}$ and $T_{\\max}^{\\text{collapse}}$. If no temperature in the scan satisfies the condition, both values are reported as $0.0 \\, \\text{keV}$.\n\nThis procedure is systematically applied to each test case provided in the problem statement. The final output is a formatted list summarizing the results ($T_{\\text{pk}}$, $P_{\\text{pk}}$, $T_{\\min}^{\\text{collapse}}$, $T_{\\max}^{\\text{collapse}}$) for each case.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import quad\n\ndef solve():\n    \"\"\"\n    Computes core impurity radiation and assesses thermal collapse risk in a tokamak.\n    \"\"\"\n\n    # Test cases defined by the tuple:\n    # (species, R0, a, n0, sn, f_Z0, f_Z_edge, pf, T_edge, alpha_T, gamma, P_in, beta, T_min, T_max, N_T)\n    test_cases = [\n        (\"Ne\", 1.7, 0.5, 8.0e19, 1.0, 5.0e-3, 2.0e-3, 1.0, 0.1, 2.0, 0.3, 8.0e6, 0.3, 0.5, 5.0, 120),\n        (\"Ar\", 1.7, 0.5, 8.0e19, 1.0, 1.0e-3, 5.0e-4, 1.0, 0.5, 2.0, 0.3, 2.5e7, 0.3, 1.0, 10.0, 120),\n        (\"Ne\", 1.7, 0.5, 8.0e19, 1.0, 1.0e-2, 5.0e-3, 1.0, 0.1, 2.0, 0.3, 6.0e6, 0.3, 0.3, 3.0, 120),\n        (\"Ar\", 1.0, 0.4, 6.0e19, 1.0, 3.0e-3, 1.0e-3, 1.0, 0.2, 2.0, 0.3, 5.0e6, 0.3, 0.5, 5.0, 120),\n    ]\n\n    # Impurity radiation functions L_Z(T) in W.m^3, with T in eV.\n    def L_Ne(T_ev):\n        # A simple check to prevent math domain errors for T_ev = 0\n        if T_ev = 0:\n            return 0.0\n        term1 = 3.0e-31 * (T_ev / 150.0)**0.2 * np.exp(-T_ev / 250.0)\n        term2 = 1.0e-32 * (T_ev / 1000.0)**0.5 * np.exp(-T_ev / 5000.0)\n        return term1 + term2\n\n    def L_Ar(T_ev):\n        # A simple check to prevent math domain errors for T_ev = 0\n        if T_ev = 0:\n            return 0.0\n        term1 = 1.5e-31 * (T_ev / 1500.0)**0.4 * np.exp(-T_ev / 2200.0)\n        term2 = 3.0e-32 * (T_ev / 6000.0)**0.5 * np.exp(-T_ev / 8000.0)\n        return term1 + term2\n\n    L_Z_funcs = {\"Ne\": L_Ne, \"Ar\": L_Ar}\n    \n    all_results = []\n    \n    for case in test_cases:\n        species, R0, a, n0, sn, f_Z0, f_Z_edge, pf, T_edge, alpha_T, gamma, P_in, beta, T_min, T_max, N_T = case\n        \n        l_z_func = L_Z_funcs[species]\n        r_c = gamma * a\n        \n        # Define profile functions based on problem statement\n        def n_e(r):\n            return n0 * (1 - (r / a)**2)**sn\n\n        def f_z(r):\n            return f_Z_edge + (f_Z0 - f_Z_edge) * (1 - (r / a)**pf)\n\n        def T_e_kev(r, T0_kev):\n            return T_edge + (T0_kev - T_edge) * (1 - (r / a)**alpha_T)\n\n        # Define the integrand for numerical integration\n        def integrand(r, T0_kev):\n            t_e_val_kev = T_e_kev(r, T0_kev)\n            \n            # Radiation function expects temperature in eV\n            t_e_val_ev = 1000.0 * t_e_val_kev\n            \n            # The radiation functions L_Z are defined piecewise implicitly\n            if t_e_val_ev = 0:\n                l_z_val = 0.0\n            else:\n                l_z_val = l_z_func(t_e_val_ev)\n            \n            n_e_val = n_e(r)\n            f_z_val = f_z(r)\n            \n            # Power density p_rad = n_e^2 * f_Z * L_Z\n            p_rad = n_e_val**2 * f_z_val * l_z_val\n            \n            # Power in a volume element dV = 4 * pi^2 * R0 * r * dr\n            return p_rad * 4 * np.pi**2 * R0 * r\n\n        # Scan over the central temperature T0\n        T0_scan = np.linspace(T_min, T_max, N_T)\n        P_rad_core_scan = []\n\n        for T0 in T0_scan:\n            power_watts, _ = quad(integrand, 0, r_c, args=(T0,))\n            P_rad_core_scan.append(power_watts)\n        \n        P_rad_core_scan = np.array(P_rad_core_scan)\n        \n        # Analyze results\n        # Find peak radiated power and corresponding temperature\n        P_pk_watts = np.max(P_rad_core_scan)\n        P_pk_mw = P_pk_watts / 1e6\n        T_pk = T0_scan[np.argmax(P_rad_core_scan)]\n        \n        # Determine collapse interval\n        P_threshold_watts = beta * P_in\n        collapse_indices = np.where(P_rad_core_scan >= P_threshold_watts)[0]\n        \n        if len(collapse_indices) > 0:\n            T_min_collapse = T0_scan[collapse_indices[0]]\n            T_max_collapse = T0_scan[collapse_indices[-1]]\n        else:\n            T_min_collapse = 0.0\n            T_max_collapse = 0.0\n            \n        all_results.append([T_pk, P_pk_mw, T_min_collapse, T_max_collapse])\n\n    # Format output string\n    result_str = \",\".join(\n        f\"[{r[0]:.6f},{r[1]:.6f},{r[2]:.6f},{r[3]:.6f}]\" for r in all_results\n    )\n    \n    # Final print statement in the exact required format.\n    print(f\"[{result_str}]\")\n\nsolve()\n\n```", "id": "3708706"}]}