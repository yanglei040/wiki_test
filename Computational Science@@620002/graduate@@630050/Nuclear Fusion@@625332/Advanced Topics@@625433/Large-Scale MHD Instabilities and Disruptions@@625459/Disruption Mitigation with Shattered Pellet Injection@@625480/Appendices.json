{"hands_on_practices": [{"introduction": "The effectiveness of Shattered Pellet Injection (SPI) begins with the physical process of shattering. This exercise uses the fundamental principles of momentum and energy conservation to characterize the initial velocity distribution of the resulting fragment cloud [@problem_id:3694990]. By deriving the mean and variance of the fragment velocities, you will build a foundational understanding of the initial conditions that govern how the dispersed material subsequently interacts with the tokamak plasma.", "problem": "A deuterium pellet used for Shattered Pellet Injection (SPI) in disruption mitigation in a tokamak travels with speed $v$ along the normal to a rigid, anchored shatter plate. The pellet has mass $m$ and breaks into a very large number $N$ of fragments upon impact. Assume the following idealizations grounded in first principles:\n\n- Conservation of linear momentum applies to the pellet–plate–fragment system. Because the shatter plate is rigid and anchored, it can absorb net momentum, so the ensemble of fragments does not need to carry the incident momentum.\n- Define the fragmentation efficiency $\\eta \\in (0,1)$ as the fraction of the incident pellet kinetic energy that ends up as translational kinetic energy of the fragments; the remainder is dissipated into plate deformation, thermal energy, and internal fragment excitation.\n- The fragment velocities are isotropically dispersed and can be modeled as independent, identically distributed random vectors with zero ensemble mean and equal variance $\\sigma^{2}$ in each Cartesian component. Let the incident direction be the $+x$ axis.\n\nStarting only from conservation of linear momentum, the definition of kinetic energy, and the stated modeling assumptions, derive analytic expressions for the mean and the variance of the $x$-component of the fragment velocity distribution. Provide your final answer as a row matrix with two entries, $\\big[$mean, variance$\\big]$. Express the mean in $\\mathrm{m/s}$ and the variance in $(\\mathrm{m/s})^{2}$. No numerical values are required; give your answer in closed form in terms of $v$ and $\\eta$.", "solution": "The problem is validated as self-contained, consistent, and scientifically grounded. The assumptions, while some are redundant (e.g., isotropy implies zero mean and equal component variances), are not contradictory and allow for a unique solution. We will proceed to derive the mean and variance of the $x$-component of the fragment velocity distribution.\n\nLet the velocity of a fragment be the random vector $\\vec{v} = (v_x, v_y, v_z)$. The problem states that the fragment velocities are isotropically dispersed. This means the probability distribution function (PDF) for the velocity, denoted $f(\\vec{v})$, is a function only of the speed $|\\vec{v}|$. That is, $f(\\vec{v}) = g(|\\vec{v}|) = g(\\sqrt{v_x^2 + v_y^2 + v_z^2})$ for some function $g$.\n\nFirst, we derive the mean of the $x$-component of the fragment velocity, denoted $\\langle v_x \\rangle$. This is the expectation value of $v_x$ over the distribution $f(\\vec{v})$.\n$$ \\langle v_x \\rangle = \\iiint_{\\mathbb{R}^3} v_x f(\\vec{v}) \\,dv_x \\,dv_y \\,dv_z $$\nSubstituting the isotropic form of the PDF:\n$$ \\langle v_x \\rangle = \\int_{-\\infty}^{\\infty} \\int_{-\\infty}^{\\infty} \\int_{-\\infty}^{\\infty} v_x \\, g(\\sqrt{v_x^2 + v_y^2 + v_z^2}) \\,dv_x \\,dv_y \\,dv_z $$\nFor any fixed values of $v_y$ and $v_z$, the integrand, as a function of $v_x$, is an odd function because $v_x$ is an odd function and $g(\\sqrt{v_x^2 + \\text{const}})$ is an even function of $v_x$. The integral of an odd function over a symmetric domain $(-\\infty, \\infty)$ is zero. Therefore:\n$$ \\langle v_x \\rangle = 0 $$\nThis result is consistent with the explicitly stated assumption of a \"zero ensemble mean\" for the velocity vector, as $\\langle \\vec{v} \\rangle = \\vec{0}$ implies $\\langle v_x \\rangle = 0$.\n\nNext, we derive the variance of the $x$-component of the fragment velocity, denoted $\\sigma_x^2$. The variance is defined as:\n$$ \\sigma_x^2 = \\langle (v_x - \\langle v_x \\rangle)^2 \\rangle $$\nSince we have shown that $\\langle v_x \\rangle = 0$, the variance simplifies to the mean of the squared velocity component:\n$$ \\sigma_x^2 = \\langle v_x^2 \\rangle $$\nThe isotropy of the velocity distribution also implies symmetry among the Cartesian components. The mean squared values must be equal:\n$$ \\langle v_x^2 \\rangle = \\langle v_y^2 \\rangle = \\langle v_z^2 \\rangle $$\nThis is also given as an explicit assumption in the problem statement. The mean squared speed of the fragments is the sum of the mean squared components:\n$$ \\langle |\\vec{v}|^2 \\rangle = \\langle v_x^2 + v_y^2 + v_z^2 \\rangle = \\langle v_x^2 \\rangle + \\langle v_y^2 \\rangle + \\langle v_z^2 \\rangle = 3 \\langle v_x^2 \\rangle $$\nSubstituting $\\sigma_x^2 = \\langle v_x^2 \\rangle$, we get:\n$$ \\langle |\\vec{v}|^2 \\rangle = 3\\sigma_x^2 $$\nNow we use the information about energy conversion. The incident kinetic energy of the pellet of mass $m$ and speed $v$ is:\n$$ K_{in} = \\frac{1}{2} m v^2 $$\nThe fragmentation efficiency $\\eta$ is the fraction of this energy that is converted into the translational kinetic energy of the fragments, $K_f$:\n$$ K_f = \\eta K_{in} = \\frac{1}{2} \\eta m v^2 $$\nThe total kinetic energy of the fragments can also be expressed as the sum of the kinetic energies of the individual fragments. Since the fragments are described as independent and identically distributed, we can express the total kinetic energy in terms of the ensemble average of the squared speed, $\\langle |\\vec{v}|^2 \\rangle$. The total mass of all fragments is $m$. The total kinetic energy is the mass-weighted average of the kinetic energy, which, for a system of i.i.d. particles, simplifies to:\n$$ K_f = \\frac{1}{2} m \\langle |\\vec{v}|^2 \\rangle $$\nBy equating the two expressions for $K_f$:\n$$ \\frac{1}{2} m \\langle |\\vec{v}|^2 \\rangle = \\frac{1}{2} \\eta m v^2 $$\nThis yields an expression for the mean squared speed of the fragments:\n$$ \\langle |\\vec{v}|^2 \\rangle = \\eta v^2 $$\nFinally, we substitute this result into our earlier equation relating $\\langle |\\vec{v}|^2 \\rangle$ to the variance $\\sigma_x^2$:\n$$ 3\\sigma_x^2 = \\eta v^2 $$\nSolving for the variance of the $x$-component, we find:\n$$ \\sigma_x^2 = \\frac{\\eta v^2}{3} $$\nThus, we have derived the mean and variance of the $x$-component of the fragment velocity distribution using only the stated assumptions. The mean is $0 \\, \\mathrm{m/s}$ and the variance is $\\frac{\\eta v^2}{3} \\, (\\mathrm{m/s})^2$.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0 & \\frac{\\eta v^2}{3}\n\\end{pmatrix}\n}\n$$", "id": "3694990"}, {"introduction": "While SPI is designed to disperse material widely, a critical failure mode is incomplete shattering, which can produce large, high-momentum fragments. This practice delves into a crucial risk assessment, tasking you with modeling the journey of such a fragment through the plasma and calculating the potential for localized wall damage upon impact [@problem_id:3695062]. By applying an energy-limited ablation model, you will quantify the fragment's survival and estimate the intense, localized heat flux that poses a significant threat to plasma-facing components.", "problem": "A spherical fragment produced by incomplete shattering during Shattered Pellet Injection (SPI) into a tokamak is suspected to remain relatively intact and penetrate deeply. Consider a single neon fragment (solid) of initial radius $r_0$, density $\\rho$, traveling ballistically from the outer midplane toward the inner wall with speed $v_0$. The plasma-facing edge region presents an approximately uniform electron energy flux to the fragment surface of magnitude $\\Phi_e$ over its transit. Assume energy-limited ablation: the ablation power equals the electron energy absorbed at the fragment surface and the specific energy required to ablate neon is $H_{\\mathrm{eff}}$ (including heating and latent effects). Treat the fragment as a sphere of instantaneous radius $r(t)$, neglect fragment deceleration and magnetic forces (the fragment is neutral and ballistic), and neglect variation of $\\Phi_e$ along the path for this estimate.\n\nUsing first principles (energy conservation at the ablation front and geometric relations for a sphere), determine whether the fragment survives to the inner wall, and if so, estimate the maximum instantaneous localized wall heat flux upon impact, assuming all residual kinetic energy is thermalized over the fragment’s projected contact area $A_c$ and during an interaction time $\\delta t$ set by traversal of a near-surface deceleration layer of thickness $d$ at speed $v_0$. Take $A_c = \\pi r_{\\mathrm{res}}^2$ and $\\delta t = d / v_0$, where $r_{\\mathrm{res}}$ is the residual fragment radius at the inner wall. Express the final answer in $\\mathrm{MW/m^2}$ and round to three significant figures.\n\nUse the following parameters, which are representative of disruption mitigation experiments:\n- Initial fragment radius: $r_0 = 4.0 \\,\\mathrm{mm}$.\n- Neon density (solid): $\\rho = 1{,}440 \\,\\mathrm{kg/m^3}$.\n- Effective specific ablation energy: $H_{\\mathrm{eff}} = 1.2 \\times 10^{6} \\,\\mathrm{J/kg}$.\n- Electron energy flux to fragment surface: $\\Phi_e = 1.0 \\times 10^{9} \\,\\mathrm{W/m^2}$.\n- Ballistic speed: $v_0 = 350 \\,\\mathrm{m/s}$.\n- Outer-to-inner wall path length: $L = 1.10 \\,\\mathrm{m}$.\n- Near-surface deceleration layer thickness: $d = 3.0 \\,\\mathrm{mm}$.\n\nScientific realism conditions: the fragment is neutral, so it is not tied to magnetic field lines; the ablation is energy-limited by $\\Phi_e$; the plasma parameters are assumed uniform over $L$ for this estimate; the wall contact area is taken as the fragment’s instantaneous projected area; and the heat flux is the kinetic-energy thermalization per unit area per unit time.\n\nCompute the maximum instantaneous localized wall heat flux as a single real number in $\\mathrm{MW/m^2}$, rounded to three significant figures.", "solution": "The solution proceeds by first determining the ablation rate of the spherical neon fragment, then calculating its size upon reaching the inner wall, and finally computing the localized heat flux from the impact's kinetic energy deposition.\n\nThe fundamental principle is energy conservation at the fragment's surface. The power absorbed from the plasma electron flux, $P_{\\mathrm{abs}}$, is equal to the power consumed by the ablation process, $P_{\\mathrm{ablate}}$.\n\nThe absorbed power is the product of the electron energy flux $\\Phi_e$ and the fragment's surface area, $4\\pi r(t)^2$:\n$$P_{\\mathrm{abs}} = \\Phi_e \\cdot (4\\pi r(t)^2)$$\n\nThe ablation power is the rate of mass loss, $|\\frac{dm}{dt}|$, multiplied by the effective specific ablation energy, $H_{\\mathrm{eff}}$. The mass $m(t)$ of the spherical fragment is $m(t) = \\rho \\frac{4}{3}\\pi r(t)^3$. The rate of change of mass is:\n$$\\frac{dm}{dt} = \\frac{d}{dt}\\left(\\rho \\frac{4}{3}\\pi r(t)^3\\right) = \\rho \\cdot 4\\pi r(t)^2 \\frac{dr}{dt}$$\nSince the radius is decreasing, $\\frac{dr}{dt}$ is negative, and the mass loss rate $|\\frac{dm}{dt}| = -\\frac{dm}{dt}$.\nThus, the ablation power is:\n$$P_{\\mathrm{ablate}} = \\left|\\frac{dm}{dt}\\right| H_{\\mathrm{eff}} = -\\rho H_{\\mathrm{eff}} \\cdot 4\\pi r(t)^2 \\frac{dr}{dt}$$\n\nEquating the absorbed and ablation powers:\n$$\\Phi_e \\cdot 4\\pi r(t)^2 = -\\rho H_{\\mathrm{eff}} \\cdot 4\\pi r(t)^2 \\frac{dr}{dt}$$\nThis simplifies to a first-order ordinary differential equation for the radius $r(t)$:\n$$\\frac{dr}{dt} = -\\frac{\\Phi_e}{\\rho H_{\\mathrm{eff}}}$$\nThe rate of change of the radius is constant. We can integrate this equation from time $t=0$ (at radius $r_0$) to a later time $t$:\n$$\\int_{r_0}^{r(t)} dr' = \\int_{0}^{t} -\\frac{\\Phi_e}{\\rho H_{\\mathrm{eff}}} dt'$$\n$$r(t) - r_0 = -\\frac{\\Phi_e t}{\\rho H_{\\mathrm{eff}}}$$\nThe radius as a function of time is:\n$$r(t) = r_0 - \\frac{\\Phi_e}{\\rho H_{\\mathrm{eff}}} t$$\n\nThe fragment travels at a constant ballistic speed $v_0$ over a path length $L$. The transit time, $t_{\\mathrm{transit}}$, is:\n$$t_{\\mathrm{transit}} = \\frac{L}{v_0}$$\nSubstituting the given values:\n$$t_{\\mathrm{transit}} = \\frac{1.10 \\,\\mathrm{m}}{350 \\,\\mathrm{m/s}} \\approx 3.14286 \\times 10^{-3} \\,\\mathrm{s}$$\n\nThe residual radius of the fragment upon reaching the inner wall, $r_{\\mathrm{res}}$, is $r(t_{\\mathrm{transit}})$:\n$$r_{\\mathrm{res}} = r_0 - \\frac{\\Phi_e L}{\\rho H_{\\mathrm{eff}} v_0}$$\nLet's first calculate the ablated radius, a positive quantity $\\Delta r = r_0 - r_{\\mathrm{res}}$:\n$$\\Delta r = \\frac{\\Phi_e L}{\\rho H_{\\mathrm{eff}} v_0} = \\frac{(1.0 \\times 10^9 \\,\\mathrm{W/m^2}) (1.10 \\,\\mathrm{m})}{(1440 \\,\\mathrm{kg/m^3}) (1.2 \\times 10^6 \\,\\mathrm{J/kg}) (350 \\,\\mathrm{m/s})} \\approx 1.8188 \\times 10^{-3} \\,\\mathrm{m}$$\nThis is equivalent to $1.8188 \\,\\mathrm{mm}$. The initial radius is $r_0 = 4.0 \\,\\mathrm{mm}$.\nThe residual radius is:\n$$r_{\\mathrm{res}} = 4.0 \\,\\mathrm{mm} - 1.8188 \\,\\mathrm{mm} = 2.1812 \\,\\mathrm{mm} = 2.1812 \\times 10^{-3} \\,\\mathrm{m}$$\nSince $r_{\\mathrm{res}} > 0$, the fragment survives its transit and impacts the inner wall.\n\nThe maximum instantaneous localized wall heat flux, $q_{\\mathrm{wall}}$, is defined as the residual kinetic energy, $KE_{\\mathrm{res}}$, deposited over the contact area $A_c$ during the interaction time $\\delta t$:\n$$q_{\\mathrm{wall}} = \\frac{KE_{\\mathrm{res}}}{A_c \\delta t}$$\nThe residual kinetic energy is $KE_{\\mathrm{res}} = \\frac{1}{2} m_{\\mathrm{res}} v_0^2$, where $m_{\\mathrm{res}} = \\rho \\frac{4}{3}\\pi r_{\\mathrm{res}}^3$.\n$$KE_{\\mathrm{res}} = \\frac{1}{2}\\left(\\rho \\frac{4}{3}\\pi r_{\\mathrm{res}}^3\\right) v_0^2 = \\frac{2}{3} \\pi \\rho v_0^2 r_{\\mathrm{res}}^3$$\nThe problem defines the contact area as $A_c = \\pi r_{\\mathrm{res}}^2$ and the interaction time as $\\delta t = d/v_0$. Substituting these into the expression for $q_{\\mathrm{wall}}$:\n$$q_{\\mathrm{wall}} = \\frac{\\frac{2}{3} \\pi \\rho v_0^2 r_{\\mathrm{res}}^3}{(\\pi r_{\\mathrm{res}}^2) (d/v_0)}$$\nSimplifying the expression algebraically:\n$$q_{\\mathrm{wall}} = \\frac{2 \\pi \\rho v_0^2 r_{\\mathrm{res}}^3}{3} \\frac{v_0}{\\pi d r_{\\mathrm{res}}^2} = \\frac{2 \\rho v_0^3 r_{\\mathrm{res}}}{3d}$$\nNow, we substitute the numerical values into this final expression. All values must be in SI base units.\n- $\\rho = 1440 \\,\\mathrm{kg/m^3}$\n- $v_0 = 350 \\,\\mathrm{m/s}$\n- $r_{\\mathrm{res}} \\approx 2.1812 \\times 10^{-3} \\,\\mathrm{m}$\n- $d = 3.0 \\,\\mathrm{mm} = 3.0 \\times 10^{-3} \\,\\mathrm{m}$\n\n$$q_{\\mathrm{wall}} = \\frac{2 \\cdot (1440 \\,\\mathrm{kg/m^3}) \\cdot (350 \\,\\mathrm{m/s})^3 \\cdot (2.1812 \\times 10^{-3} \\,\\mathrm{m})}{3 \\cdot (3.0 \\times 10^{-3} \\,\\mathrm{m})}$$\n$$q_{\\mathrm{wall}} = \\frac{2 \\cdot 1440 \\cdot 42875000 \\cdot (2.1812 \\times 10^{-3})}{9.0 \\times 10^{-3}} \\,\\mathrm{W/m^2}$$\n$$q_{\\mathrm{wall}} \\approx \\frac{2.685 \\times 10^{8}}{9.0 \\times 10^{-3}} \\,\\mathrm{W/m^2} \\approx 2.983 \\times 10^{10} \\,\\mathrm{W/m^2}$$\nThe problem requires the answer in megawatts per square meter ($\\mathrm{MW/m^2}$). Since $1 \\,\\mathrm{MW} = 10^6 \\,\\mathrm{W}$:\n$$q_{\\mathrm{wall}} \\approx \\frac{2.983 \\times 10^{10}}{10^6} \\,\\mathrm{MW/m^2} = 2.983 \\times 10^4 \\,\\mathrm{MW/m^2}$$\nRounding to three significant figures, the result is $2.98 \\times 10^4 \\,\\mathrm{MW/m^2}$.\n\nRecomputing with higher precision to ensure rounding accuracy:\n$r_{\\mathrm{res}} = 0.004 - \\frac{1.1 \\times 10^9}{1440 \\times 1.2 \\times 10^6 \\times 350} = \\frac{1}{250} - \\frac{11}{6048} = \\frac{1649}{756000} \\approx 2.1812169 \\times 10^{-3} \\,\\mathrm{m}$.\n$q_{\\mathrm{wall}} = \\frac{2 \\cdot 1440 \\cdot 350^3}{3 \\cdot 0.003} \\left(\\frac{1649}{756000}\\right) = (1.372 \\times 10^{13}) \\left(\\frac{1649}{756000}\\right) \\approx 2.9926 \\times 10^{10} \\,\\mathrm{W/m^2}$.\nIn $\\mathrm{MW/m^2}$, this is $29926 \\,\\mathrm{MW/m^2}$.\nRounding to three significant figures gives $29900 \\,\\mathrm{MW/m^2}$, which is $2.99 \\times 10^4 \\,\\mathrm{MW/m^2}$.", "answer": "$$\\boxed{2.99 \\times 10^4}$$", "id": "3695062"}, {"introduction": "Moving from the behavior of individual fragments to the performance of the entire mitigation system, this final practice is an exercise in engineering design. You will implement a zero-dimensional (0D) model to estimate the total impurity mass required to mitigate a disruption in a large-scale device like ITER [@problem_id:3695067]. This involves balancing the dual requirements of radiating away the plasma's thermal energy and raising the electron density to suppress runaway electron formation, providing a direct insight into the trade-offs involved in designing a functional disruption mitigation system.", "problem": "Implement a zero-dimensional (0D) disruption mitigation model for impurity shattered pellet injection (SPI) in the International Thermonuclear Experimental Reactor (ITER). The goal is to compute the minimum injected impurity mass that simultaneously satisfies a target radiated energy fraction during the thermal quench and a target post-thermal-quench free-electron density, and to compare this model-based mass to a simple current-device linear scaling of injected mass with thermal energy.\n\nAssumptions and foundational principles that must be used:\n- Use first-principles energy accounting and optically thin plasma radiation. Model the total plasma thermal energy as $W_{\\text{th}}$ under the simplifying assumption $T_{\\text{e},0} \\approx T_{\\text{i},0} \\equiv T_0$ and singly charged main ions, so that quasineutrality implies $n_{\\text{i},0} \\approx n_{\\text{e},0}$. A consistent approximation is therefore\n$$\nW_{\\text{th}} \\approx 3\\, n_{\\text{e},0}\\, T_0\\, V,\n$$\nwhere $T_0$ is in joules.\n- The target radiated energy is $E_{\\text{rad,target}} = f_{\\text{rad}}\\, W_{\\text{th}}$, with $f_{\\text{rad}} \\in (0,1)$.\n- The optically thin impurity line radiation power density is $P_{\\text{rad}}/V = n_{\\text{e}}\\, n_z \\, \\overline{L}_z$, using an effective, quench-averaged cooling coefficient $\\overline{L}_z$ with units of watts-meter-cubed.\n- Use a single assimilation efficiency $0 \\le \\eta \\le 1$ for injected material into the radiating, current-carrying plasma volume, so that the assimilated impurity particle number is $\\eta\\, N_{\\text{inj}}$.\n- Adopt a single effective ionization degree for the impurity during the relevant phase, $\\overline{Z}_{\\text{ion}}$, so that free-electron density contributed by impurities is $\\Delta n_{\\text{e}} \\approx \\eta\\, N_{\\text{inj}} \\, \\overline{Z}_{\\text{ion}}/V$.\n- Assume a characteristic thermal-quench time $ \\tau_{\\text{TQ}}$ over which radiation acts with a representative electron density $n_{\\text{e,avg}}$ appropriate to the mitigation target.\n\nRequired derivation targets, from the above base only (do not use any pre-baked engineering correlations not stated above):\n- From $P_{\\text{rad}} = n_{\\text{e}}\\, n_z \\, \\overline{L}_z \\, V$ and the assimilation model, derive a radiative constraint on $N_{\\text{inj}}$ by equating the time-integrated radiated energy to $E_{\\text{rad,target}}$. Your final expression must be in terms of $f_{\\text{rad}}$, $W_{\\text{th}}$, $\\eta$, $\\overline{L}_z$, $n_{\\text{e,avg}}$, and $\\tau_{\\text{TQ}}$.\n- From the free-electron density requirement $n_{\\text{e,post}} \\ge n_{\\text{e},0} + \\Delta n_{\\text{e}}$, derive a density constraint on $N_{\\text{inj}}$ in terms of $n_{\\text{e,post}}$, $n_{\\text{e},0}$, $V$, $\\eta$, and $\\overline{Z}_{\\text{ion}}$.\n- The required injected particle number is the maximum of the radiative and density requirements. Convert this to a mass using the impurity atomic mass $m_{\\text{atom}}$.\n\nComparison to current-device scaling:\n- Define a simple current-device linear scaling for required mass, $M_{\\text{scaled}}$, by normalizing to a reference dataset characterized by $(W_{\\text{ref}}, M_{\\text{ref}}, f_{\\text{rad,ref}})$:\n$$\nM_{\\text{scaled}} = M_{\\text{ref}} \\times \\frac{W_{\\text{th}}}{W_{\\text{ref}}} \\times \\frac{f_{\\text{rad}}}{f_{\\text{rad,ref}}}.\n$$\n- Compute the dimensionless ratio $r \\equiv M_{\\text{model}}/M_{\\text{scaled}}$.\n\nImplementation instructions:\n- Implement a program that, for each test case in the suite below, computes $W_{\\text{th}}$ in joules using $T_0$ given in electron-volts via the conversion $1\\,\\text{eV} = e\\,\\text{J}$, where $e = 1.602176634\\times 10^{-19}\\,\\text{J/eV}$. Then compute:\n    - $M_{\\text{model}}$ in grams, from the maximum of the radiative and density constraints.\n    - $M_{\\text{scaled}}$ in grams, from the reference scaling.\n    - $r = M_{\\text{model}}/M_{\\text{scaled}}$.\n- For numerical evaluation, use $n_{\\text{e,avg}} = n_{\\text{e,post}}$.\n\nUnits and output requirements:\n- Express $M_{\\text{model}}$ in grams, $M_{\\text{scaled}}$ in grams, and $r$ as a dimensionless float. Round all outputs to three significant figures.\n- Your program should produce a single line of output containing the results for all test cases as a comma-separated list enclosed in square brackets, where each test case result is a list of three floats in the order $[M_{\\text{model}}\\ \\text{(g)}, M_{\\text{scaled}}\\ \\text{(g)}, r]$.\n\nTest suite (each case is a tuple of parameters in the order: impurity mass $m_{\\text{atom}}$ (kg), effective ionization $\\overline{Z}_{\\text{ion}}$ (dimensionless), $\\overline{L}_z$ (W m$^3$), assimilation $\\eta$ (dimensionless), initial electron density $n_{\\text{e},0}$ (m$^{-3}$), initial temperature $T_0$ (eV), volume $V$ (m$^3$), target radiated fraction $f_{\\text{rad}}$ (dimensionless), post-quench density target $n_{\\text{e,post}}$ (m$^{-3}$), thermal quench time $\\tau_{\\text{TQ}}$ (s), reference $W_{\\text{ref}}$ (J), reference $M_{\\text{ref}}$ (g), reference $f_{\\text{rad,ref}}$ (dimensionless)):\n- Case A (Neon-like, ITER baseline):\n    - $m_{\\text{atom}} = 3.321\\times 10^{-26}$,\n    - $\\overline{Z}_{\\text{ion}} = 8$,\n    - $\\overline{L}_z = 1.0\\times 10^{-32}$,\n    - $\\eta = 0.3$,\n    - $n_{\\text{e},0} = 8.0\\times 10^{19}$,\n    - $T_0 = 1.2000\\times 10^{4}$,\n    - $V = 830$,\n    - $f_{\\text{rad}} = 0.9$,\n    - $n_{\\text{e,post}} = 5.0\\times 10^{20}$,\n    - $\\tau_{\\text{TQ}} = 3.0\\times 10^{-3}$,\n    - $W_{\\text{ref}} = 2.0\\times 10^{6}$,\n    - $M_{\\text{ref}} = 20.0$,\n    - $f_{\\text{rad,ref}} = 0.8$.\n- Case B (Argon-like, moderate mitigation, radiation-dominated):\n    - $m_{\\text{atom}} = 6.6335\\times 10^{-26}$,\n    - $\\overline{Z}_{\\text{ion}} = 10$,\n    - $\\overline{L}_z = 3.0\\times 10^{-32}$,\n    - $\\eta = 0.3$,\n    - $n_{\\text{e},0} = 8.0\\times 10^{19}$,\n    - $T_0 = 1.0000\\times 10^{4}$,\n    - $V = 830$,\n    - $f_{\\text{rad}} = 0.7$,\n    - $n_{\\text{e,post}} = 1.0\\times 10^{20}$,\n    - $\\tau_{\\text{TQ}} = 5.0\\times 10^{-3}$,\n    - $W_{\\text{ref}} = 1.5\\times 10^{6}$,\n    - $M_{\\text{ref}} = 15.0$,\n    - $f_{\\text{rad,ref}} = 0.8$.\n- Case C (Neon-like, density-dominated with high $n_{\\text{e,post}}$ and lower assimilation):\n    - $m_{\\text{atom}} = 3.321\\times 10^{-26}$,\n    - $\\overline{Z}_{\\text{ion}} = 8$,\n    - $\\overline{L}_z = 1.0\\times 10^{-32}$,\n    - $\\eta = 0.2$,\n    - $n_{\\text{e},0} = 6.0\\times 10^{19}$,\n    - $T_0 = 1.5000\\times 10^{4}$,\n    - $V = 830$,\n    - $f_{\\text{rad}} = 0.6$,\n    - $n_{\\text{e,post}} = 1.5\\times 10^{21}$,\n    - $\\tau_{\\text{TQ}} = 2.0\\times 10^{-3}$,\n    - $W_{\\text{ref}} = 2.0\\times 10^{6}$,\n    - $M_{\\text{ref}} = 20.0$,\n    - $f_{\\text{rad,ref}} = 0.8$.\n\nAngle units do not apply. There are no percentages in the output. Ensure that the final printed line strictly matches the required format: a single list containing one sub-list per test case, in the order described, with each float rounded to three significant figures and with $M_{\\text{model}}$ and $M_{\\text{scaled}}$ in grams.", "solution": "The solution proceeds as follows:\nFirst, we establish the fundamental quantity of initial plasma thermal energy, $W_{\\text{th}}$.\nSecond, we derive the two constraints on the number of injected impurity atoms, $N_{\\text{inj}}$: one from the requirement to radiate a target fraction of the thermal energy (the radiative constraint), and one from the requirement to raise the plasma free-electron density to a target value (the density constraint).\nThird, we determine the minimum required $N_{\\text{inj}}$ that satisfies both constraints and convert this to the model-predicted mass, $M_{\\text{model}}$.\nFourth, we calculate the mass predicted by the simple linear scaling law, $M_{\\text{scaled}}$.\nFinally, we compute the ratio $r = M_{\\text{model}} / M_{\\text{scaled}}$.\n\n**1. Plasma Thermal Energy**\nThe problem defines the initial plasma thermal energy, $W_{\\text{th}}$, under the assumption of equal electron and ion temperatures ($T_{\\text{e},0} \\approx T_{\\text{i},0} \\equiv T_0$) and quasineutrality with singly charged main ions ($n_{\\text{i},0} \\approx n_{\\text{e},0}$). The total kinetic energy is the sum of electron and ion energies:\n$$ W_{\\text{th}} = \\frac{3}{2} N_{\\text{e}} k_B T_{\\text{e},0} + \\frac{3}{2} N_{\\text{i}} k_B T_{\\text{i},0} $$\nwhere $N_{\\text{e}} = n_{\\text{e},0} V$ and $N_{\\text{i}} = n_{\\text{i},0} V$ are the total number of electrons and ions, respectively, in the plasma volume $V$. Given the assumptions, this simplifies to:\n$$ W_{\\text{th}} \\approx \\frac{3}{2} (n_{\\text{e},0}V) k_B T_0 + \\frac{3}{2} (n_{\\text{e},0}V) k_B T_0 = 3 n_{\\text{e},0} V (k_B T_0) $$\nThe problem provides $T_0$ in units of electron-volts ($\\text{eV}$) and specifies the formula $W_{\\text{th}} \\approx 3 n_{\\text{e},0} T_0 V$, where $T_0$ is in Joules. This is consistent if we treat $T_0$ in the formula as the temperature in energy units. Therefore, the temperature in $\\text{eV}$ must be converted to Joules using the elementary charge $e$:\n$$ T_0 \\, [\\text{J}] = T_0 \\, [\\text{eV}] \\times e $$\nwhere $e \\approx 1.602176634 \\times 10^{-19} \\, \\text{J/eV}$.\nThe final expression for thermal energy is:\n$$ W_{\\text{th}} = 3 \\, n_{\\text{e},0} \\, (T_0[\\text{eV}] \\times e) \\, V $$\n\n**2. Radiative Constraint on Injected Particle Number**\nThe goal is to radiate a target energy $E_{\\text{rad,target}} = f_{\\text{rad}} W_{\\text{th}}$ over the thermal quench-time $\\tau_{\\text{TQ}}$. The radiated power is from optically thin line radiation by the injected impurities. The power density is given as $P_{\\text{rad}}/V = n_{\\text{e}} n_z \\overline{L}_z$, where $n_z$ is the impurity density and $\\overline{L}_z$ is the effective cooling coefficient.\nThe number of assimilated impurity atoms is $\\eta N_{\\text{inj}}$, where $\\eta$ is the assimilation efficiency. The impurity density is thus $n_z = \\eta N_{\\text{inj}} / V$.\nThe total radiated power is:\n$$ P_{\\text{rad}} = n_{\\text{e}} \\left( \\frac{\\eta N_{\\text{inj}}}{V} \\right) \\overline{L}_z V = n_{\\text{e}} \\, \\eta \\, N_{\\text{inj}} \\, \\overline{L}_z $$\nAssuming this power is constant over $\\tau_{\\text{TQ}}$ and using a representative average electron density $n_{\\text{e,avg}}$, the total radiated energy is $E_{\\text{rad}} = P_{\\text{rad}} \\times \\tau_{\\text{TQ}}$. Setting this equal to the target radiated energy:\n$$ f_{\\text{rad}} W_{\\text{th}} = (n_{\\text{e,avg}} \\, \\eta \\, N_{\\text{inj,rad}} \\, \\overline{L}_z) \\, \\tau_{\\text{TQ}} $$\nThe problem specifies to use $n_{\\text{e,avg}} = n_{\\text{e,post}}$. Solving for the required number of injected particles to meet the radiative constraint, $N_{\\text{inj,rad}}$, we get:\n$$ N_{\\text{inj,rad}} = \\frac{f_{\\text{rad}} W_{\\text{th}}}{\\eta \\, n_{\\text{e,post}} \\, \\overline{L}_z \\, \\tau_{\\text{TQ}}} $$\n\n**3. Density Constraint on Injected Particle Number**\nThe second constraint is to achieve a target post-quench free-electron density, $n_{\\text{e,post}}$. The final electron density is the sum of the initial density $n_{\\text{e},0}$ and the electrons contributed by the ionized impurities, $\\Delta n_{\\text{e}}$. The minimum requirement is:\n$$ n_{\\text{e,post}} = n_{\\text{e},0} + \\Delta n_{\\text{e}} $$\nThe electron density increase from the impurities is given by $\\Delta n_{\\text{e}} = \\eta N_{\\text{inj}} \\overline{Z}_{\\text{ion}} / V$, where $\\overline{Z}_{\\text{ion}}$ is the effective ionization state of the impurity. Substituting this into the density balance equation:\n$$ n_{\\text{e,post}} - n_{\\text{e},0} = \\frac{\\eta N_{\\text{inj,dens}} \\overline{Z}_{\\text{ion}}}{V} $$\nSolving for the number of injected particles required to meet the density constraint, $N_{\\text{inj,dens}}$, gives:\n$$ N_{\\text{inj,dens}} = \\frac{(n_{\\text{e,post}} - n_{\\text{e},0}) V}{\\eta \\overline{Z}_{\\text{ion}}} $$\nThis value is only physically meaningful if $n_{\\text{e,post}} > n_{\\text{e},0}$, which holds for all test cases.\n\n**4. Model-Based Injected Mass, $M_{\\text{model}}$**\nTo satisfy both the radiative and density requirements simultaneously, the number of injected particles, $N_{\\text{inj}}$, must be sufficient for the more demanding of the two constraints. Therefore, we must take the maximum of the two derived values:\n$$ N_{\\text{inj}} = \\max(N_{\\text{inj,rad}}, N_{\\text{inj,dens}}) $$\nThe model-predicted mass, $M_{\\text{model}}$, is the total number of injected particles multiplied by the atomic mass of the impurity species, $m_{\\text{atom}}$. The result is converted from kilograms to grams.\n$$ M_{\\text{model}} \\, [\\text{g}] = (N_{\\text{inj}} \\times m_{\\text{atom}} \\, [\\text{kg}]) \\times 1000 $$\n\n**5. Scaled Injected Mass, $M_{\\text{scaled}}$, and Ratio $r$**\nThe problem defines a simple linear scaling law for comparison, based on a reference machine or dataset:\n$$ M_{\\text{scaled}} = M_{\\text{ref}} \\times \\frac{W_{\\text{th}}}{W_{\\text{ref}}} \\times \\frac{f_{\\text{rad}}}{f_{\\text{rad,ref}}} $$\nwhere ($W_{\\text{ref}}$, $M_{\\text{ref}}$, $f_{\\text{rad,ref}}$) are the thermal energy, injected mass, and radiated fraction for the reference case.\nFinally, the dimensionless ratio $r$ is computed as:\n$$ r = \\frac{M_{\\text{model}}}{M_{\\text{scaled}}} $$\n\nThe implementation will carry out these calculations for each test case, round the final values of $M_{\\text{model}}$, $M_{\\text{scaled}}$, and $r$ to three significant figures, and present them in the specified format.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nimport math\n\ndef solve():\n    \"\"\"\n    Computes a 0D model for shattered pellet injection in ITER,\n    compares it to a linear scaling, and formats the output.\n    \"\"\"\n\n    # Elementary charge in J/eV\n    e_charge = 1.602176634e-19\n\n    # Test suite from the problem statement\n    test_cases = [\n        # Case A (Neon-like, ITER baseline)\n        {\n            \"m_atom\": 3.321e-26,       # kg\n            \"Z_ion\": 8,                # dimensionless\n            \"L_z\": 1.0e-32,            # W m^3\n            \"eta\": 0.3,                # dimensionless\n            \"n_e0\": 8.0e19,            # m^-3\n            \"T0\": 1.2000e4,            # eV\n            \"V\": 830,                  # m^3\n            \"f_rad\": 0.9,              # dimensionless\n            \"n_epost\": 5.0e20,         # m^-3\n            \"tau_TQ\": 3.0e-3,          # s\n            \"W_ref\": 2.0e6,            # J\n            \"M_ref\": 20.0,             # g\n            \"f_rad_ref\": 0.8,          # dimensionless\n        },\n        # Case B (Argon-like, moderate mitigation, radiation-dominated)\n        {\n            \"m_atom\": 6.6335e-26,      # kg\n            \"Z_ion\": 10,               # dimensionless\n            \"L_z\": 3.0e-32,            # W m^3\n            \"eta\": 0.3,                # dimensionless\n            \"n_e0\": 8.0e19,            # m^-3\n            \"T0\": 1.0000e4,            # eV\n            \"V\": 830,                  # m^3\n            \"f_rad\": 0.7,              # dimensionless\n            \"n_epost\": 1.0e20,         # m^-3\n            \"tau_TQ\": 5.0e-3,          # s\n            \"W_ref\": 1.5e6,            # J\n            \"M_ref\": 15.0,             # g\n            \"f_rad_ref\": 0.8,          # dimensionless\n        },\n        # Case C (Neon-like, density-dominated with high n_epost and lower assimilation)\n        {\n            \"m_atom\": 3.321e-26,       # kg\n            \"Z_ion\": 8,                # dimensionless\n            \"L_z\": 1.0e-32,            # W m^3\n            \"eta\": 0.2,                # dimensionless\n            \"n_e0\": 6.0e19,            # m^-3\n            \"T0\": 1.5000e4,            # eV\n            \"V\": 830,                  # m^3\n            \"f_rad\": 0.6,              # dimensionless\n            \"n_epost\": 1.5e21,         # m^-3\n            \"tau_TQ\": 2.0e-3,          # s\n            \"W_ref\": 2.0e6,            # J\n            \"M_ref\": 20.0,             # g\n            \"f_rad_ref\": 0.8,          # dimensionless\n        }\n    ]\n\n    def round_to_sf(x, sf):\n        \"\"\"Rounds a number x to sf significant figures.\"\"\"\n        if x == 0:\n            return 0.0\n        return round(x, sf - 1 - int(math.floor(math.log10(abs(x)))))\n\n    all_results = []\n    \n    for case in test_cases:\n        # Step 1: Calculate plasma thermal energy in Joules\n        T0_J = case[\"T0\"] * e_charge\n        W_th = 3 * case[\"n_e0\"] * T0_J * case[\"V\"]\n\n        # Step 2: Calculate the number of particles for the radiative constraint\n        N_inj_rad_denom = case[\"eta\"] * case[\"n_epost\"] * case[\"L_z\"] * case[\"tau_TQ\"]\n        N_inj_rad = (case[\"f_rad\"] * W_th) / N_inj_rad_denom\n\n        # Step 3: Calculate the number of particles for the density constraint\n        delta_n_e = case[\"n_epost\"] - case[\"n_e0\"]\n        if delta_n_e > 0:\n             N_inj_dens = (delta_n_e * case[\"V\"]) / (case[\"eta\"] * case[\"Z_ion\"])\n        else:\n            N_inj_dens = 0\n\n        # Step 4: Determine the required number of particles and the model mass\n        N_inj = max(N_inj_rad, N_inj_dens)\n        M_model_kg = N_inj * case[\"m_atom\"]\n        M_model_g = M_model_kg * 1000\n\n        # Step 5: Calculate the mass from the simple scaling law\n        M_scaled_g = case[\"M_ref\"] * (W_th / case[\"W_ref\"]) * (case[\"f_rad\"] / case[\"f_rad_ref\"])\n\n        # Step 6: Calculate the ratio\n        r = M_model_g / M_scaled_g\n\n        # Round results to three significant figures\n        M_model_rounded = round_to_sf(M_model_g, 3)\n        M_scaled_rounded = round_to_sf(M_scaled_g, 3)\n        r_rounded = round_to_sf(r, 3)\n\n        all_results.append([M_model_rounded, M_scaled_rounded, r_rounded])\n\n    # Format the final output string as requested\n    # e.g., [[val,val,val],[val,val,val]]\n    result_strings = [f\"[{res[0]},{res[1]},{res[2]}]\" for res in all_results]\n    print(f\"[{','.join(result_strings)}]\")\n\nsolve()\n```", "id": "3695067"}]}