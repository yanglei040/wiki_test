{"hands_on_practices": [{"introduction": "At the heart of any particle transport simulation lies the question: how far does a particle travel before its next interaction? This distance, the free path length, is not a fixed value but a random variable governed by the probabilistic nature of particle-matter interactions. This exercise guides you through the fundamental Monte Carlo technique of inverse transform sampling to generate these random path lengths, a cornerstone for building any particle transport simulation from first principles [@problem_id:3533651].", "problem": "A charged particle traversing a homogeneous calorimeter material undergoes stochastic interactions that can be modeled as a one-dimensional Poisson process in path length. Let the material have microscopic cross section $\\sigma$ in $\\mathrm{cm}^2$ and number density $n$ in $\\mathrm{cm}^{-3}$. The macroscopic interaction coefficient is $\\mu = n \\sigma$ in $\\mathrm{cm}^{-1}$, and the mean free path is $\\lambda = 1/\\mu$ in $\\mathrm{cm}$. In a Monte Carlo (MC) simulation of calorimeter showers, the free path length to the next interaction is a random variable governed by the exponential survival probability implied by the Poisson process.\n\nStarting from the above physical model and fundamental definitions, derive the sampling procedure for the free path length using inverse transform sampling for the exponential distribution parameterized by the mean free path $\\lambda$. You must then implement a program that, for each test case specified below, computes the mean free path $\\lambda$ and generates two free path lengths using provided uniform variates $u \\in (0,1)$ according to the inverse transform sampling method. All lengths must be expressed in centimeters.\n\nYour program must process the following test suite, where each test case is given as $(n,\\sigma,u_1,u_2)$ with $n$ in $\\mathrm{cm}^{-3}$, $\\sigma$ in $\\mathrm{cm}^2$, and $u_1,u_2$ unitless:\n- Test Case 1 (general case): $n = 5 \\times 10^{22}$, $\\sigma = 2 \\times 10^{-24}$, $u_1 = 0.2$, $u_2 = 0.8$.\n- Test Case 2 (rare long step edge case): $n = 1 \\times 10^{23}$, $\\sigma = 1 \\times 10^{-23}$, $u_1 = 1 \\times 10^{-12}$, $u_2 = 0.5$.\n- Test Case 3 (near-unity $u$ precision edge case): $n = 1 \\times 10^{23}$, $\\sigma = 1 \\times 10^{-26}$, $u_1 = 0.999999$, $u_2 = 0.999$.\n- Test Case 4 (short mean free path case): $n = 8 \\times 10^{22}$, $\\sigma = 3 \\times 10^{-23}$, $u_1 = 0.1$, $u_2 = 0.5$.\n\nFor each test case, compute:\n1. The mean free path $\\lambda$ in $\\mathrm{cm}$.\n2. Two sampled free path lengths $\\ell_1$ and $\\ell_2$ in $\\mathrm{cm}$ using inverse transform sampling with $u_1$ and $u_2$ respectively.\n\nOutput Specification:\n- Round every numerical result to six decimal places.\n- Your program should produce a single line of output containing the concatenated results for all test cases, in order, as a comma-separated list enclosed in square brackets. The order is, for each test case: $[\\lambda, \\ell_1, \\ell_2]$, concatenated across the four test cases. For example: $[\\lambda_1,\\ell_{1,1},\\ell_{1,2},\\lambda_2,\\ell_{2,1},\\ell_{2,2},\\ldots]$.", "solution": "The user wants to solve a physics problem.\nThe user wants me to do the following:\n1.  **Validate the problem**: Check if the problem is scientifically sound, well-posed, objective, and complete.\n2.  **Derive the solution**: If valid, derive the mathematical formula for sampling the free path length.\n3.  **Implement the solution**: Write a Python program to compute the results for given test cases.\n\n### Problem Validation\n\nI will start by validating the problem statement as per the instructions.\n\n#### Step 1: Extract Givens\n\n*   **Physical Model**: Particle interactions are modeled as a one-dimensional Poisson process in path length.\n*   **Definitions**:\n    *   Microscopic cross section: $\\sigma$ in $\\mathrm{cm}^2$.\n    *   Number density of target particles: $n$ in $\\mathrm{cm}^{-3}$.\n    *   Macroscopic interaction coefficient (or linear attenuation coefficient): $\\mu = n \\sigma$ in $\\mathrm{cm}^{-1}$.\n    *   Mean free path: $\\lambda = 1/\\mu$ in $\\mathrm{cm}$.\n*   **Task**: Derive the sampling procedure for the free path length, $\\ell$, using inverse transform sampling.\n*   **Random Variates**: Uniform random numbers $u \\in (0,1)$ are provided.\n*   **Test Cases** (given as $(n, \\sigma, u_1, u_2)$):\n    1.  Test Case 1: $(5 \\times 10^{22} \\, \\mathrm{cm}^{-3}, 2 \\times 10^{-24} \\, \\mathrm{cm}^2, 0.2, 0.8)$\n    2.  Test Case 2: $(1 \\times 10^{23} \\, \\mathrm{cm}^{-3}, 1 \\times 10^{-23} \\, \\mathrm{cm}^2, 1 \\times 10^{-12}, 0.5)$\n    3.  Test Case 3: $(1 \\times 10^{23} \\, \\mathrm{cm}^{-3}, 1 \\times 10^{-26} \\, \\mathrm{cm}^2, 0.999999, 0.999)$\n    4.  Test Case 4: $(8 \\times 10^{22} \\, \\mathrm{cm}^{-3}, 3 \\times 10^{-23} \\, \\mathrm{cm}^2, 0.1, 0.5)$\n*   **Output Requirements**:\n    *   For each test case, compute $\\lambda$, $\\ell_1$, and $\\ell_2$.\n    *   Round all results to six decimal places.\n    *   Produce a single line of output: $[\\lambda_1,\\ell_{1,1},\\ell_{1,2},\\lambda_2,\\ell_{2,1},\\ell_{2,2},\\ldots]$.\n\n#### Step 2: Validate Using Extracted Givens\n\n*   **Scientifically Grounded (Critical)**: The problem is fundamentally sound. The description of particle interaction probability using a constant macroscopic cross section ($\\mu$) is a standard physical model. This leads directly to a Poisson process for the number of interactions over a given path length and, consequently, an exponential distribution for the free path length between interactions. The relation $\\mu = n \\sigma$ is a definitional identity in material science and particle physics. The inverse transform sampling method is a standard and mathematically rigorous technique in Monte Carlo methods. All premises are well-established in physics and computational science.\n*   **Well-Posed**: The problem is well-posed. It provides all necessary information (physical model, definitions, input data) to uniquely determine the required outputs. The derivation of the sampling formula and its application to the given test cases lead to a single, deterministic set of results.\n*   **Objective (Critical)**: The problem is stated in precise, objective, and quantitative terms. There are no subjective elements or ambiguities. The terms are clearly defined, and the required calculations are specified without bias.\n\nThe problem does not exhibit any of the flaws listed in the validation criteria. The data values are physically plausible for condensed matter and radiation interactions. The edge cases for the uniform variates ($u$ close to $0$ and $u$ close to $1$) are well-chosen to test the numerical behavior of the sampling formula at its limits, which is a hallmark of a well-designed computational problem.\n\n#### Step 3: Verdict and Action\n\nThe problem is **valid**. I will now proceed to the solution.\n\n### Derivation and Solution\n\nThe problem requires the derivation of a sampling method for the free path length, $\\ell$, of a particle in a homogeneous medium. The underlying physical model is a Poisson process governing the interactions.\n\n$1$. **Probability Distribution of Free Path Length**\nThe macroscopic interaction coefficient, $\\mu$, represents the constant probability per unit path length for a particle to interact. For a particle that has traveled a distance $x$, the probability of it interacting in the next infinitesimal interval $dx$ is $\\mu dx$. The probability of it *not* interacting in this interval is $1 - \\mu dx$.\n\nThe probability $P(x)$ that a particle travels at least a distance $x$ without an interaction (the survival probability) can be found by considering the path as a series of infinitesimal steps. The probability of surviving to $x+dx$ is the product of the probability of surviving to $x$ and the probability of not interacting in $dx$:\n$$ P(x+dx) = P(x) (1 - \\mu dx) $$\nRearranging gives:\n$$ \\frac{P(x+dx) - P(x)}{dx} = - \\mu P(x) $$\nTaking the limit as $dx \\to 0$, we get the differential equation:\n$$ \\frac{dP(x)}{dx} = - \\mu P(x) $$\nWith the boundary condition that the survival probability at distance $0$ is $1$ (i.e., $P(0)=1$), the solution to this equation is the exponential decay function:\n$$ P(x) = e^{-\\mu x} $$\nThis function is also known as the survival function, $S(x)$.\n\nThe random variable of interest is the path length $\\ell$ to the *first* interaction. The cumulative distribution function (CDF), $F(\\ell)$, gives the probability that the interaction occurs at a path length less than or equal to $\\ell$. This is equivalent to $1$ minus the probability of surviving beyond length $\\ell$:\n$$ F(\\ell) = 1 - S(\\ell) = 1 - e^{-\\mu \\ell} $$\nThe probability density function (PDF), $p(\\ell)$, is the derivative of the CDF:\n$$ p(\\ell) = \\frac{dF(\\ell)}{d\\ell} = \\mu e^{-\\mu \\ell}, \\quad \\text{for } \\ell \\ge 0 $$\nThis is the exponential distribution with rate parameter $\\mu$. The mean of this distribution is indeed $1/\\mu$, which is consistent with the definition of the mean free path, $\\lambda$.\n\n$2$. **Inverse Transform Sampling**\nThe inverse transform sampling method is a procedure to generate random samples from any probability distribution for which the inverse of its CDF is known. The method works by generating a random number $u$ from a standard uniform distribution on the interval $(0, 1)$ and then computing the sample $\\ell$ as:\n$$ \\ell = F^{-1}(u) $$\nwhere $F^{-1}$ is the inverse of the CDF.\n\nTo find $F^{-1}$, we set $F(\\ell) = u$ and solve for $\\ell$:\n$$ u = 1 - e^{-\\mu \\ell} $$\n$$ e^{-\\mu \\ell} = 1 - u $$\nTaking the natural logarithm of both sides:\n$$ \\ln(e^{-\\mu \\ell}) = \\ln(1 - u) $$\n$$ -\\mu \\ell = \\ln(1 - u) $$\n$$ \\ell = -\\frac{1}{\\mu} \\ln(1 - u) $$\nSince the mean free path is defined as $\\lambda = 1/\\mu$, the sampling formula becomes:\n$$ \\ell = -\\lambda \\ln(1 - u) $$\nA common and equivalent simplification is based on the property that if $u$ is a random variable uniformly distributed on $(0, 1)$, then the random variable $u' = 1 - u$ is also uniformly distributed on $(0, 1)$. Therefore, we can substitute $u$ for $1 - u$ in the formula, yielding the more direct expression:\n$$ \\ell = -\\lambda \\ln(u) $$\nThis form is widely used in Monte Carlo simulations for its simplicity and direct connection to the survival function ($S(\\ell) = u$). We will use this form for the computations.\n\n$3$. **Computational Algorithm**\nFor each test case given by the tuple $(n, \\sigma, u_1, u_2)$:\na. Calculate the macroscopic interaction coefficient: $\\mu = n \\sigma$.\nb. Calculate the mean free path: $\\lambda = 1/\\mu$.\nc. Sample the first free path length using $u_1$: $\\ell_1 = -\\lambda \\ln(u_1)$.\nd. Sample the second free path length using $u_2$: $\\ell_2 = -\\lambda \\ln(u_2)$.\ne. Round $\\lambda$, $\\ell_1$, and $\\ell_2$ to six decimal places and store the results.\n\nThis procedure will be applied to all four test cases to generate the final output string.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the mean free path and samples free path lengths for a set of\n    test cases based on the inverse transform sampling method for an\n    exponential distribution.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (n, sigma, u1, u2)\n    # n: number density in cm^-3\n    # sigma: microscopic cross section in cm^2\n    # u1, u2: uniform random variates in (0,1)\n    test_cases = [\n        (5e22, 2e-24, 0.2, 0.8),\n        (1e23, 1e-23, 1e-12, 0.5),\n        (1e23, 1e-26, 0.999999, 0.999),\n        (8e22, 3e-23, 0.1, 0.5),\n    ]\n\n    results = []\n    \n    # Process each test case\n    for case in test_cases:\n        n, sigma, u1, u2 = case\n        \n        # 1. Calculate the macroscopic interaction coefficient (mu)\n        mu = n * sigma\n        \n        # 2. Calculate the mean free path (lambda)\n        lambda_val = 1.0 / mu\n        \n        # 3. Sample two free path lengths (l1, l2) using inverse transform sampling\n        # The formula is l = -lambda * ln(u)\n        l1 = -lambda_val * np.log(u1)\n        l2 = -lambda_val * np.log(u2)\n        \n        # Append the rounded results to the list\n        # The output format requires 6 decimal places.\n        results.append(f\"{lambda_val:.6f}\")\n        results.append(f\"{l1:.6f}\")\n        results.append(f\"{l2:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "3533651"}, {"introduction": "As a high-energy particle traverses a material, its path is not perfectly straight. It undergoes countless small-angle deflections from Coulomb scattering off atomic nuclei, a process that is responsible for the lateral spread of a particle shower. In this practice, you will derive the connection between the microscopic angular deflections and the macroscopic lateral displacement and apply a standard physics parameterization to quantify this effect, a key step in accurately simulating a calorimeter's spatial response [@problem_id:3533635].", "problem": "An ultra-relativistic electron of energy $E=5\\,\\mathrm{GeV}$ enters a homogeneous lead electromagnetic calorimeter. The material radiation length is $X_0=0.56\\,\\mathrm{cm}$. In a computational model of the calorimeter response, the electron’s angular deflections due to multiple Coulomb scattering are approximated by a Gaussian process consistent with Molière theory, and the characteristic root-mean-square (RMS) projected scattering angle at depth $x$ is described by the well-tested Highland parameterization with its standard logarithmic correction. Assume $x=1\\,\\mathrm{cm}$, neglect energy loss over this step, take the speed parameter to be $\\beta \\approx 1$, and use $p \\approx E/c$ for the momentum.\n\nStarting from the modeling premise that small-angle multiple scattering can be treated as angular diffusion and that lateral displacement arises from the path integral of the instantaneous angle, derive an expression for the lateral RMS displacement $y_{\\mathrm{rms}}$ at depth $x$ in terms of $x$ and the RMS projected scattering angle $\\theta_0(x)$, and then evaluate it at $x=1\\,\\mathrm{cm}$. Compute the numerical value of $\\theta_0$ at $x=1\\,\\mathrm{cm}$ using the Highland parameterization and your $y_{\\mathrm{rms}}$ using the derived relation. Round your answers to four significant figures. Express $\\theta_0$ in radians and $y_{\\mathrm{rms}}$ in centimeters.", "solution": "The problem statement is scientifically grounded, well-posed, and objective. It is based on established principles of particle interactions with matter, specifically multiple Coulomb scattering. All necessary data and well-defined physical approximations are provided, allowing for a unique and meaningful solution. We therefore proceed with the solution.\n\nThe task is divided into two parts: first, a derivation of the root-mean-square (RMS) lateral displacement $y_{\\mathrm{rms}}$ in terms of the depth $x$ and the RMS projected scattering angle $\\theta_0(x)$; second, a numerical evaluation of both $\\theta_0(x)$ and $y_{\\mathrm{rms}}(x)$ at the specified depth.\n\nPart 1: Derivation of the RMS Lateral Displacement, $y_{\\mathrm{rms}}(x)$\n\nWe consider a particle initially traveling along an axis, which we'll denote as the longitudinal direction. The problem uses $x$ as the symbol for depth, so we will follow this convention. The lateral displacement in a transverse plane (e.g., the $y$-plane) at a depth $x$ is denoted $y(x)$. In the small-angle approximation, which is appropriate for multiple Coulomb scattering of high-energy particles, the lateral displacement is the path integral of the projected angle, $\\theta_y(x')$, with respect to the initial direction:\n$$ y(x) = \\int_0^x \\theta_y(x') dx' $$\nwhere $x'$ is the integration variable representing depth.\n\nThe RMS displacement, $y_{\\mathrm{rms}}$, is defined as the square root of the expectation value (or ensemble average, denoted by $\\langle \\dots \\rangle$) of the squared displacement $y(x)^2$:\n$$ y_{\\mathrm{rms}}^2(x) = \\langle y(x)^2 \\rangle = \\left\\langle \\left( \\int_0^x \\theta_y(x') dx' \\right)^2 \\right\\rangle $$\nBy writing the squared integral as a double integral and moving the expectation operator inside, we obtain:\n$$ \\langle y(x)^2 \\rangle = \\int_0^x dx' \\int_0^x dx'' \\langle \\theta_y(x') \\theta_y(x'') \\rangle $$\nThe term $\\langle \\theta_y(x') \\theta_y(x'') \\rangle$ represents the correlation of the projected angle at two different depths. The problem premises that scattering is treated as angular diffusion, which is a Markov process. This means that angular deflections over non-overlapping path segments are statistically independent. Let us assume $x' \\le x''$. The angle at depth $x''$ is the sum of the angle at depth $x'$ and the subsequent angular deflection accumulated between $x'$ and $x''$, i.e., $\\theta_y(x'') = \\theta_y(x') + \\Delta\\theta_y(x', x'')$. The correlation function then becomes:\n$$ \\langle \\theta_y(x') \\theta_y(x'') \\rangle = \\langle \\theta_y(x') (\\theta_y(x') + \\Delta\\theta_y(x', x'')) \\rangle = \\langle \\theta_y(x')^2 \\rangle + \\langle \\theta_y(x') \\Delta\\theta_y(x', x'') \\rangle $$\nBecause the scattering process is Markovian, the angular increment $\\Delta\\theta_y(x', x'')$ is independent of the angle $\\theta_y(x')$. Also, the mean angle is zero, $\\langle \\theta_y(x') \\rangle = \\langle \\Delta\\theta_y(x', x'') \\rangle = 0$. Therefore, the cross-term vanishes: $\\langle \\theta_y(x') \\Delta\\theta_y(x', x'') \\rangle = \\langle \\theta_y(x') \\rangle \\langle \\Delta\\theta_y(x', x'') \\rangle = 0$.\nThis simplifies the correlation function for $x' \\le x''$ to the variance of the angle at the shallower depth $x'$:\n$$ \\langle \\theta_y(x') \\theta_y(x'') \\rangle = \\langle \\theta_y(x')^2 \\rangle $$\nMore generally, for any two depths $x'$ and $x''$, the correlation is given by the variance at the lesser of the two depths:\n$$ \\langle \\theta_y(x') \\theta_y(x'') \\rangle = \\langle \\theta_y(\\min(x', x''))^2 \\rangle $$\nFor the purpose of deriving the functional form, we use the basic model of multiple scattering (neglecting energy loss, as instructed) where the variance of the projected angle grows linearly with depth, i.e., $\\langle \\theta_y(x')^2 \\rangle \\propto x'$. We are given that $\\theta_0(x)$ is the RMS angle at depth $x$, so $\\theta_0(x)^2 = \\langle \\theta_y(x)^2 \\rangle$. This allows us to express the variance at an intermediate depth $x'$ in terms of the variance at the final depth $x$:\n$$ \\langle \\theta_y(x')^2 \\rangle = \\theta_0(x')^2 \\approx \\frac{x'}{x} \\theta_0(x)^2 $$\nSubstituting this into the integral for $\\langle y(x)^2 \\rangle$:\n$$ \\langle y(x)^2 \\rangle = \\int_0^x dx' \\int_0^x dx'' \\frac{\\min(x', x'')}{x} \\theta_0(x)^2 $$\nThe integral over the square domain $[0,x] \\times [0,x]$ can be simplified by exploiting the symmetry of the integrand. It is equal to twice the integral over the triangular region where $x' \\le x''$:\n$$ \\langle y(x)^2 \\rangle = 2 \\int_0^x dx'' \\int_0^{x''} dx' \\frac{x'}{x} \\theta_0(x)^2 $$\nWe perform the inner integration with respect to $x'$:\n$$ \\int_0^{x''} \\frac{x'}{x} \\theta_0(x)^2 dx' = \\frac{\\theta_0(x)^2}{x} \\left[ \\frac{x'^2}{2} \\right]_0^{x''} = \\frac{\\theta_0(x)^2}{2x} (x'')^2 $$\nNext, we perform the outer integration with respect to $x''$:\n$$ \\langle y(x)^2 \\rangle = 2 \\int_0^x \\frac{\\theta_0(x)^2}{2x} (x'')^2 dx'' = \\frac{\\theta_0(x)^2}{x} \\int_0^x (x'')^2 dx'' = \\frac{\\theta_0(x)^2}{x} \\left[ \\frac{(x'')^3}{3} \\right]_0^x = \\frac{\\theta_0(x)^2}{x} \\frac{x^3}{3} = \\frac{1}{3} x^2 \\theta_0(x)^2 $$\nTaking the square root yields the final expression for the RMS lateral displacement:\n$$ y_{\\mathrm{rms}}(x) = \\sqrt{\\frac{1}{3} x^2 \\theta_0(x)^2} = \\frac{x \\theta_0(x)}{\\sqrt{3}} $$\n\nPart 2: Numerical Evaluation\n\nWe now compute the numerical values for $\\theta_0(x)$ and $y_{\\mathrm{rms}}(x)$ at $x = 1\\,\\mathrm{cm}$. The Highland parameterization for the RMS projected scattering angle is:\n$$ \\theta_0 = \\frac{13.6\\,\\mathrm{MeV}}{\\beta c p} z \\sqrt{\\frac{x}{X_0}} \\left[ 1 + 0.038 \\ln\\left(\\frac{x}{X_0}\\right) \\right] $$\nThe given parameters are:\n- Particle: electron ($z=1$).\n- Energy: $E = 5\\,\\mathrm{GeV} = 5000\\,\\mathrm{MeV}$.\n- Approximations: $\\beta \\approx 1$ and $pc \\approx E = 5000\\,\\mathrm{MeV}$.\n- Depth: $x = 1\\,\\mathrm{cm}$.\n- Radiation length: $X_0 = 0.56\\,\\mathrm{cm}$.\n\nFirst, we calculate the ratio $x/X_0$:\n$$ \\frac{x}{X_0} = \\frac{1\\,\\mathrm{cm}}{0.56\\,\\mathrm{cm}} = \\frac{1}{0.56} \\approx 1.785714 $$\nSubstituting the values into the formula for $\\theta_0$:\n$$ \\theta_0 \\approx \\frac{13.6\\,\\mathrm{MeV}}{5000\\,\\mathrm{MeV}} (1) \\sqrt{\\frac{1}{0.56}} \\left[ 1 + 0.038 \\ln\\left(\\frac{1}{0.56}\\right) \\right] $$\n$$ \\theta_0 \\approx 0.00272 \\times \\sqrt{1.785714...} \\times [1 + 0.038 \\ln(1.785714...)] $$\n$$ \\theta_0 \\approx 0.00272 \\times 1.336306... \\times [1 + 0.038 \\times (0.579818...)] $$\n$$ \\theta_0 \\approx 0.00363475... \\times [1 + 0.022033...] $$\n$$ \\theta_0 \\approx 0.00363475... \\times 1.022033... \\approx 0.00371483\\,\\mathrm{rad} $$\nRounding to four significant figures, we find the RMS projected angle:\n$$ \\theta_0(x=1\\,\\mathrm{cm}) \\approx 0.003715\\,\\mathrm{rad} $$\nNext, we use our derived expression to compute the RMS lateral displacement $y_{\\mathrm{rms}}$ at $x = 1\\,\\mathrm{cm}$, using the unrounded value of $\\theta_0$ for better precision:\n$$ y_{\\mathrm{rms}}(1\\,\\mathrm{cm}) = \\frac{(1\\,\\mathrm{cm}) \\times \\theta_0(1\\,\\mathrm{cm})}{\\sqrt{3}} \\approx \\frac{1 \\times 0.00371483...}{\\sqrt{3}} $$\n$$ y_{\\mathrm{rms}}(1\\,\\mathrm{cm}) \\approx \\frac{0.00371483...}{1.7320508...}\\,\\mathrm{cm} \\approx 0.00214476\\,\\mathrm{cm} $$\nRounding to four significant figures, we find the RMS lateral displacement:\n$$ y_{\\mathrm{rms}}(x=1\\,\\mathrm{cm}) \\approx 0.002145\\,\\mathrm{cm} $$", "answer": "$$\\boxed{\\begin{pmatrix} 0.003715 & 0.002145 \\end{pmatrix}}$$", "id": "3533635"}, {"introduction": "A simulation of energy deposition is incomplete without modeling how that energy is measured and the inherent limitations of the process. In many calorimeters, the deposited energy creates scintillation light, which is then converted into a measurable number of photoelectrons, a process governed by Poisson statistics. This exercise demonstrates how to derive the fundamental stochastic limit to energy resolution from these statistical fluctuations, directly linking microscopic detector physics to a key macroscopic performance metric of the calorimeter [@problem_id:3533695].", "problem": "In a fast simulation of a sampling calorimeter used in High-Energy Physics (HEP), the response to an incident hadronic or electromagnetic shower is modeled by converting scintillation light into an energy estimate via a photoelectron count. Consider an idealized lead–scintillator sampling calorimeter in which a fraction $f_s$ of the total shower energy $E$ is deposited in the scintillator layers. The measurement chain is assumed linear: the scintillator produces an average of $N_{pe}$ photoelectrons per $\\mathrm{GeV}$ of energy actually deposited in the scintillator, and the energy estimator is constructed from the total counted photoelectrons so as to be unbiased. Assume that the only source of fluctuation is photoelectron counting statistics, which follows a Poisson process. All other resolution contributions (e.g., sampling inhomogeneities, upstream leakage, constant term from calibration and nonuniformity, and electronic noise) are negligible.\n\nStarting from the definitions of Poisson statistics and linear response, derive the fractional energy resolution due solely to photostatistical fluctuations. Using this, define the stochastic coefficient $a$ as the dimensionless prefactor governing the $E^{-1/2}$ scaling of the fractional resolution in the canonical parameterization used in calorimeter simulation, with $E$ expressed in $\\mathrm{GeV}$. Then, for a lead–scintillator calorimeter characterized by $f_s = 0.3$ and $N_{pe} = 2000/\\mathrm{GeV}$, compute $a$ and predict the fractional resolution $\\sigma_E/E$ at $E = 50\\,\\mathrm{GeV}$, under the above assumptions. \n\nRound your answers to four significant figures. Express both $a$ and $\\sigma_E/E$ as dimensionless decimals.", "solution": "The problem asks for the derivation of the stochastic coefficient and the fractional energy resolution for an idealized sampling calorimeter, given a set of parameters. The first step, as per the protocol, is to validate the problem statement.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n- The system is an idealized lead–scintillator sampling calorimeter.\n- $f_s$: fraction of the total shower energy $E$ deposited in the scintillator layers.\n- $E$: total shower energy.\n- The measurement chain is linear.\n- $N_{pe}$: average number of photoelectrons produced per $\\mathrm{GeV}$ of energy deposited in the scintillator.\n- The energy estimator is unbiased.\n- Fluctuations are due solely to photoelectron counting statistics, which follow a Poisson process.\n- All other resolution contributions are negligible.\n- The stochastic coefficient $a$ is the dimensionless prefactor for the $E^{-1/2}$ scaling of the fractional resolution, with $E$ in $\\mathrm{GeV}$.\n- For a specific case: $f_s = 0.3$.\n- For a specific case: $N_{pe} = 2000/\\mathrm{GeV}$.\n- The fractional resolution $\\sigma_E/E$ is to be computed at $E = 50\\,\\mathrm{GeV}$.\n- Final numerical answers must be rounded to four significant figures and expressed as dimensionless decimals.\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientifically Grounded:** The problem uses a standard, simplified model for calorimeter resolution. The assumption of Poisson statistics for photoelectron production is a cornerstone of scintillation detector physics. The parameterization of energy resolution with a stochastic term scaling as $E^{-1/2}$ is canonical in high-energy and nuclear physics. The problem is fundamentally sound.\n- **Well-Posed:** All necessary variables ($f_s, N_{pe}$) and conditions (Poisson statistics, linear and unbiased estimator) are provided to derive a unique solution for the requested quantities ($a$ and $\\sigma_E/E$).\n- **Objective:** The problem is stated using precise, technical language common to the field of particle physics instrumentation, with no subjective or ambiguous terms.\n\n**Step 3: Verdict and Action**\nThe problem is scientifically grounded, well-posed, objective, and contains no identifiable flaws. It is therefore deemed **valid**. The solution will now be derived.\n\n### Derivation and Solution\n\nLet $E$ be the total incident energy of a particle. The energy deposited in the active scintillator layers, $E_{\\text{scint}}$, is a fraction $f_s$ of the total energy:\n$$\nE_{\\text{scint}} = f_s E\n$$\nThe scintillator produces photoelectrons with a yield of $N_{pe}$ per unit of energy deposited within it. The mean number of photoelectrons, $\\langle n \\rangle$, for a given shower is therefore:\n$$\n\\langle n \\rangle = N_{pe} E_{\\text{scint}} = N_{pe} f_s E\n$$\nThe problem states that photoelectron production follows a Poisson process. A fundamental property of the Poisson distribution is that its variance is equal to its mean. Thus, the variance of the number of photoelectrons, $\\sigma_n^2$, is:\n$$\n\\sigma_n^2 = \\langle n \\rangle = N_{pe} f_s E\n$$\nThe standard deviation of the photoelectron count is the square root of the variance:\n$$\n\\sigma_n = \\sqrt{N_{pe} f_s E}\n$$\nThe energy estimator, $\\hat{E}$, is constructed from the measured number of photoelectrons, $n$. It is specified to be linear and unbiased. Let the estimator have the form $\\hat{E} = C \\cdot n$, where $C$ is a calibration constant. The unbiased condition requires that the expectation value of the estimator equals the true energy, $\\langle \\hat{E} \\rangle = E$.\n$$\n\\langle \\hat{E} \\rangle = \\langle C \\cdot n \\rangle = C \\langle n \\rangle\n$$\nSubstituting the expression for $\\langle n \\rangle$:\n$$\n\\langle \\hat{E} \\rangle = C (N_{pe} f_s E)\n$$\nFor this to be unbiased, we must have $C (N_{pe} f_s E) = E$, which gives the calibration constant as:\n$$\nC = \\frac{1}{N_{pe} f_s}\n$$\nThe estimator for the total energy is thus $\\hat{E} = \\frac{n}{N_{pe} f_s}$. The uncertainty in the energy measurement, $\\sigma_E$, is the standard deviation of this estimator. The variance $\\sigma_E^2$ is found using standard error propagation:\n$$\n\\sigma_E^2 = \\text{Var}(\\hat{E}) = \\text{Var}\\left(\\frac{n}{N_{pe} f_s}\\right) = \\left(\\frac{1}{N_{pe} f_s}\\right)^2 \\text{Var}(n) = \\frac{\\sigma_n^2}{(N_{pe} f_s)^2}\n$$\nSubstituting $\\sigma_n^2 = N_{pe} f_s E$:\n$$\n\\sigma_E^2 = \\frac{N_{pe} f_s E}{(N_{pe} f_s)^2} = \\frac{E}{N_{pe} f_s}\n$$\nThe energy resolution is $\\sigma_E = \\sqrt{\\frac{E}{N_{pe} f_s}}$. The fractional energy resolution is $\\frac{\\sigma_E}{E}$:\n$$\n\\frac{\\sigma_E}{E} = \\frac{1}{E} \\sqrt{\\frac{E}{N_{pe} f_s}} = \\sqrt{\\frac{E}{E^2 N_{pe} f_s}} = \\frac{1}{\\sqrt{E \\cdot N_{pe} f_s}}\n$$\nThis expression demonstrates the $E^{-1/2}$ scaling characteristic of the stochastic term. The canonical parameterization is given as $\\frac{\\sigma_E}{E} = \\frac{a}{\\sqrt{E}}$, where $E$ is expressed in $\\mathrm{GeV}$ and $a$ is a dimensionless coefficient. To make this comparison rigorous, let $E_{\\text{GeV}}$ be the numerical value of the energy in $\\mathrm{GeV}$ and $\\mathcal{N}_{pe}$ be the numerical value of $N_{pe}$ in units of $(\\mathrm{GeV})^{-1}$. Our derived equation is:\n$$\n\\frac{\\sigma_E}{E} = \\frac{1}{\\sqrt{E_{\\text{GeV}} \\cdot \\mathcal{N}_{pe} \\cdot f_s}} = \\frac{1}{\\sqrt{\\mathcal{N}_{pe} f_s}} \\frac{1}{\\sqrt{E_{\\text{GeV}}}}\n$$\nBy comparing this to $\\frac{\\sigma_E}{E} = \\frac{a}{\\sqrt{E_{\\text{GeV}}}}$, we can identify the stochastic coefficient $a$:\n$$\na = \\frac{1}{\\sqrt{\\mathcal{N}_{pe} f_s}}\n$$\nUsing the provided values, $\\mathcal{N}_{pe} = 2000$ and $f_s = 0.3$:\n$$\na = \\frac{1}{\\sqrt{2000 \\times 0.3}} = \\frac{1}{\\sqrt{600}} = \\frac{1}{10\\sqrt{6}} \\approx 0.0408248\n$$\nRounding to four significant figures, the stochastic coefficient is $a = 0.04082$. The units of $a$ are implicitly $\\sqrt{\\mathrm{GeV}}$, but the problem asks for the dimensionless prefactor, which is this numerical value.\n\nNext, we compute the fractional resolution $\\frac{\\sigma_E}{E}$ at an energy of $E = 50\\,\\mathrm{GeV}$. We use the derived formula with $E_{\\text{GeV}} = 50$:\n$$\n\\frac{\\sigma_E}{E} = \\frac{a}{\\sqrt{E_{\\text{GeV}}}} = \\frac{0.0408248...}{\\sqrt{50}}\n$$\nAlternatively, using the full expression:\n$$\n\\frac{\\sigma_E}{E} = \\frac{1}{\\sqrt{E_{\\text{GeV}} \\cdot \\mathcal{N}_{pe} \\cdot f_s}} = \\frac{1}{\\sqrt{50 \\times 2000 \\times 0.3}} = \\frac{1}{\\sqrt{30000}} = \\frac{1}{100\\sqrt{3}} \\approx 0.0057735\n$$\nRounding to four significant figures, the fractional resolution at $50\\,\\mathrm{GeV}$ is $\\frac{\\sigma_E}{E} = 0.005774$.\n\nThe two requested values are the stochastic coefficient $a$ and the fractional resolution $\\frac{\\sigma_E}{E}$ at $E=50\\,\\mathrm{GeV}$.", "answer": "$$\\boxed{\\begin{pmatrix} 0.04082 & 0.005774 \\end{pmatrix}}$$", "id": "3533695"}]}