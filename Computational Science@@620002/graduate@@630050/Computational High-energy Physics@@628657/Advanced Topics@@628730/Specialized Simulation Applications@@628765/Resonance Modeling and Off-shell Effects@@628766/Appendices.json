{"hands_on_practices": [{"introduction": "The Narrow Width Approximation (NWA) is a cornerstone of particle phenomenology, allowing complex calculations to be simplified by treating unstable particles as if they were produced on-shell. This exercise provides a hands-on derivation of the NWA's mathematical foundation by directly integrating the relativistic Breit-Wigner line shape [@problem_id:3531465]. By calculating the leading-order correction that arises from the physical constraint of positive invariant mass, you will gain a quantitative understanding of the approximation's accuracy and its limitations.", "problem": "Consider a scalar unstable resonance produced in a high-energy scattering process, modeled by the causal propagator of a scalar field, whose squared magnitude near the resonance peak is given by the relativistic Breit–Wigner shape,\n$$\n|D(s)|^{2} \\equiv \\frac{1}{(s - M^{2})^{2} + M^{2}\\Gamma^{2}} \\, ,\n$$\nwhere $M$ is the pole mass and $\\Gamma$ is the total decay width. In the Narrow Width Approximation (NWA), defined as the limit $\\Gamma/M \\to 0$, total cross sections or decay rates are often computed by integrating over the invariant mass squared $s$ with a slowly varying factor $f(s)$ that encodes the remaining dynamics and phase space. In this approximation, one replaces $f(s)$ by $f(M^{2})$ and extracts a universal normalization factor from the $s$-integral of the Breit–Wigner.\n\nStarting from the causal propagator and standard real analysis, perform the following steps:\n1. Using only the properties of the relativistic Breit–Wigner and the definition of the NWA, show how the $s$-integral over the resonance factor is controlled by the region near $s = M^{2}$.\n2. Evaluate the integral of the resonance factor over the physically allowed domain $s \\in [0,\\infty)$,\n$$\nI_{0}^{\\infty} \\equiv \\int_{0}^{\\infty} \\mathrm{d}s \\, \\frac{1}{(s - M^{2})^{2} + M^{2}\\Gamma^{2}} \\, ,\n$$\nand compare it to the idealized integral over the entire real line,\n$$\nI_{-\\infty}^{\\infty} \\equiv \\int_{-\\infty}^{\\infty} \\mathrm{d}s \\, \\frac{1}{(s - M^{2})^{2} + M^{2}\\Gamma^{2}} \\, .\n$$\n3. In the limit $\\Gamma/M \\ll 1$, derive the leading fractional correction\n$$\n\\delta \\equiv \\frac{I_{0}^{\\infty} - I_{-\\infty}^{\\infty}}{I_{-\\infty}^{\\infty}}\n$$\nthat arises purely from the physical lower bound $s \\geq 0$ (i.e., from omitting the unphysical region $s < 0$), and express it as a closed-form analytic expression to leading order in $\\Gamma/M$.\n\nProvide your final answer as an analytic expression for $\\delta$ in terms of $M$ and $\\Gamma$. No numerical evaluation is required, and no units should be included in the final expression.", "solution": "We begin by recalling the origin of the relativistic Breit–Wigner in the causal propagator of an unstable scalar particle. The scalar propagator as a function of the invariant mass squared $s$ is\n$$\nD(s) \\sim \\frac{1}{s - M^{2} + i M \\Gamma} \\, ,\n$$\nso the resonance factor that enters cross sections through $|D(s)|^{2}$ is\n$$\n|D(s)|^{2} = \\frac{1}{(s - M^{2})^{2} + M^{2}\\Gamma^{2}} \\, .\n$$\nIn the Narrow Width Approximation (NWA), defined by $\\Gamma/M \\to 0$, the integrand is sharply peaked at $s = M^{2}$ with a width controlled by $M \\Gamma$. Therefore, when integrating against a slowly varying function $f(s)$, one approximates $f(s) \\approx f(M^{2})$ over the narrow region that dominantly contributes to the integral. This reduces the calculation to a universal normalization integral of the Breit–Wigner.\n\nWe now evaluate the two relevant integrals. First, consider the integral over the full real line:\n$$\nI_{-\\infty}^{\\infty} \\equiv \\int_{-\\infty}^{\\infty} \\mathrm{d}s \\, \\frac{1}{(s - M^{2})^{2} + M^{2}\\Gamma^{2}} \\, .\n$$\nPerform the change of variables\n$$\nu \\equiv \\frac{s - M^{2}}{M \\Gamma} \\quad \\Rightarrow \\quad s = M^{2} + M \\Gamma \\, u \\,, \\quad \\mathrm{d}s = M \\Gamma \\, \\mathrm{d}u \\, .\n$$\nThe denominator becomes\n$$\n(s - M^{2})^{2} + M^{2}\\Gamma^{2} = (M \\Gamma)^{2}(u^{2} + 1) \\, ,\n$$\nso the integral is\n$$\nI_{-\\infty}^{\\infty} = \\int_{-\\infty}^{\\infty} \\frac{M \\Gamma \\, \\mathrm{d}u}{(M \\Gamma)^{2}(u^{2} + 1)} = \\frac{1}{M \\Gamma} \\int_{-\\infty}^{\\infty} \\frac{\\mathrm{d}u}{u^{2} + 1} = \\frac{1}{M \\Gamma} \\left[ \\arctan(u) \\right]_{-\\infty}^{\\infty} = \\frac{1}{M \\Gamma} \\left( \\frac{\\pi}{2} - \\left( - \\frac{\\pi}{2} \\right) \\right) = \\frac{\\pi}{M \\Gamma} \\, .\n$$\n\nNext, consider the physically allowed domain $s \\in [0,\\infty)$:\n$$\nI_{0}^{\\infty} \\equiv \\int_{0}^{\\infty} \\mathrm{d}s \\, \\frac{1}{(s - M^{2})^{2} + M^{2}\\Gamma^{2}} \\, .\n$$\nUsing the same change of variables, the lower limit $s = 0$ maps to\n$$\nu_{0} = \\frac{0 - M^{2}}{M \\Gamma} = - \\frac{M}{\\Gamma} \\, ,\n$$\nand the upper limit $s \\to \\infty$ maps to $u \\to \\infty$. Therefore,\n$$\nI_{0}^{\\infty} = \\frac{1}{M \\Gamma} \\int_{u_{0}}^{\\infty} \\frac{\\mathrm{d}u}{u^{2} + 1} = \\frac{1}{M \\Gamma} \\left[ \\arctan(u) \\right]_{u_{0}}^{\\infty} = \\frac{1}{M \\Gamma} \\left( \\frac{\\pi}{2} - \\arctan\\!\\left( - \\frac{M}{\\Gamma} \\right) \\right) = \\frac{1}{M \\Gamma} \\left( \\frac{\\pi}{2} + \\arctan\\!\\left( \\frac{M}{\\Gamma} \\right) \\right) \\, .\n$$\n\nWe now compute the fractional correction\n$$\n\\delta \\equiv \\frac{I_{0}^{\\infty} - I_{-\\infty}^{\\infty}}{I_{-\\infty}^{\\infty}} = \\frac{ \\frac{1}{M \\Gamma} \\left( \\frac{\\pi}{2} + \\arctan\\!\\left( \\frac{M}{\\Gamma} \\right) \\right) - \\frac{\\pi}{M \\Gamma} }{ \\frac{\\pi}{M \\Gamma} } = \\frac{ \\frac{\\pi}{2} + \\arctan\\!\\left( \\frac{M}{\\Gamma} \\right) - \\pi }{ \\pi } \\, .\n$$\nThus,\n$$\n\\delta = \\frac{ \\arctan\\!\\left( \\frac{M}{\\Gamma} \\right) - \\frac{\\pi}{2} }{ \\pi } = - \\frac{ \\frac{\\pi}{2} - \\arctan\\!\\left( \\frac{M}{\\Gamma} \\right) }{ \\pi } \\, .\n$$\n\nTo extract the leading behavior as $\\Gamma/M \\ll 1$, we use the standard asymptotic expansion for the inverse tangent at large argument $x$,\n$$\n\\arctan(x) = \\frac{\\pi}{2} - \\frac{1}{x} + \\frac{1}{3 x^{3}} - \\frac{1}{5 x^{5}} + \\cdots \\quad \\text{for} \\quad x \\to \\infty \\, .\n$$\nSetting $x = M/\\Gamma$, we find\n$$\n\\frac{\\pi}{2} - \\arctan\\!\\left( \\frac{M}{\\Gamma} \\right) = \\frac{\\Gamma}{M} - \\frac{1}{3} \\left( \\frac{\\Gamma}{M} \\right)^{3} + \\mathcal{O}\\!\\left( \\left( \\frac{\\Gamma}{M} \\right)^{5} \\right) \\, .\n$$\nSubstituting into $\\delta$ gives the leading fractional correction,\n$$\n\\delta = - \\frac{1}{\\pi} \\left( \\frac{\\Gamma}{M} - \\frac{1}{3} \\left( \\frac{\\Gamma}{M} \\right)^{3} + \\cdots \\right) \\, .\n$$\nTo leading order in $\\Gamma/M$, this is\n$$\n\\delta \\simeq - \\frac{\\Gamma}{\\pi M} \\, .\n$$\n\nThis negative correction reflects the fact that integrating only over $s \\geq 0$ omits the (unphysical but mathematically present) contribution from $s < 0$ in the idealized real-line integral, thereby reducing the normalization relative to the full-line result. In the NWA limit, this effect is suppressed linearly by $\\Gamma/M$ and vanishes as $\\Gamma/M \\to 0$, consistent with the dominance of the near-resonance region.", "answer": "$$\\boxed{-\\frac{\\Gamma}{\\pi M}}$$", "id": "3531465"}, {"introduction": "In reality, resonant processes do not occur in isolation; they interfere with non-resonant continuum or 'background' processes. This practice explores this crucial phenomenon by modeling a simple yet powerful scenario where a Breit-Wigner amplitude is coherently added to a constant background [@problem_id:3531483]. Deriving the interference term reveals how this mixing can distort the symmetric resonance peak into an asymmetric Fano-like profile, a signature seen across many areas of physics and a vital concept for interpreting experimental data.", "problem": "Consider an elastic, spin-averaged, single-channel scattering process in high-energy physics near an isolated $s$-channel resonance. In a toy model that captures off-shell effects and interference between a resonant pole and a smooth non-resonant continuum, the scalar amplitude is modeled as\n$$\nA(s) \\;=\\; \\frac{c}{M^{2} - s - i\\,M\\,\\Gamma} \\;+\\; b\\,\\exp(i\\,\\phi),\n$$\nwhere $c$, $b$, and $\\phi$ are real constants, $M$ is the resonance mass, $\\Gamma$ is its constant total width, and $s$ is the usual Mandelstam invariant. The measurable rate is proportional to $|A(s)|^{2}$ by coherent addition of amplitudes. Assume $M>0$, $\\Gamma>0$, $b\\ge 0$, and that $\\phi$ is an angle expressed in radians.\n\nStarting from the coherent addition of amplitudes and the definition of a complex modulus, derive the explicit interference contribution to $|A(s)|^{2}$, i.e., the term linear in both $c$ and $b$. Then, by introducing the dimensionless off-shell variable $\\varepsilon \\equiv (s - M^{2})/(M\\,\\Gamma)$, analyze the parity of the interference term under $\\varepsilon \\mapsto -\\varepsilon$ and deduce necessary and sufficient conditions on $b$, $c$, and $\\phi$ for the line shape to be asymmetric about $s = M^{2}$ (Fano-like skewing rather than a purely symmetric distortion). Express your final result for the interference term as a closed-form analytic expression in terms of $s$, $M$, $\\Gamma$, $c$, $b$, and $\\phi$.", "solution": "The total scattering amplitude $A(s)$ is the coherent sum of a resonant amplitude, $A_{res}(s)$, and a non-resonant background amplitude, $A_{bg}(s)$.\n$$\nA(s) = A_{res}(s) + A_{bg}(s)\n$$\nwhere\n$$\nA_{res}(s) = \\frac{c}{M^{2} - s - i\\,M\\,\\Gamma}\n$$\nand\n$$\nA_{bg}(s) = b\\,\\exp(i\\,\\phi)\n$$\nThe measurable rate is proportional to the squared modulus of the total amplitude, $|A(s)|^{2}$. We expand this quantity:\n$$\n|A(s)|^{2} = \\left( A_{res}(s) + A_{bg}(s) \\right) \\left( A_{res}(s) + A_{bg}(s) \\right)^{*} = \\left( A_{res}(s) + A_{bg}(s) \\right) \\left( A_{res}^{*}(s) + A_{bg}^{*}(s) \\right)\n$$\n$$\n|A(s)|^{2} = |A_{res}(s)|^{2} + |A_{bg}(s)|^{2} + A_{res}(s)A_{bg}^{*}(s) + A_{res}^{*}(s)A_{bg}(s)\n$$\nThe first two terms represent the incoherent sum of the rates from the resonance and the background individually. The last two terms represent the quantum mechanical interference between the two processes. The problem asks for the interference contribution, which we denote as $I(s)$:\n$$\nI(s) = A_{res}(s)A_{bg}^{*}(s) + A_{res}^{*}(s)A_{bg}(s)\n$$\nUsing the property that for any complex number $z$, $z + z^{*} = 2\\,\\text{Re}(z)$, the interference term can be written as:\n$$\nI(s) = 2\\,\\text{Re}\\left( A_{res}(s)A_{bg}^{*}(s) \\right)\n$$\nTo calculate this, we first find the product $A_{res}(s)A_{bg}^{*}(s)$. The complex conjugate of the background amplitude is $A_{bg}^{*}(s) = b\\,\\exp(-i\\,\\phi)$.\n$$\nA_{res}(s)A_{bg}^{*}(s) = \\left( \\frac{c}{M^{2} - s - i\\,M\\,\\Gamma} \\right) \\left( b\\,\\exp(-i\\,\\phi) \\right)\n$$\nTo simplify the real part extraction, we multiply the numerator and denominator of the resonant term by its complex conjugate, $M^{2} - s + i\\,M\\,\\Gamma$:\n$$\nA_{res}(s) = \\frac{c(M^{2} - s + i\\,M\\,\\Gamma)}{(M^{2} - s - i\\,M\\,\\Gamma)(M^{2} - s + i\\,M\\,\\Gamma)} = \\frac{c(M^{2} - s + i\\,M\\,\\Gamma)}{(M^{2}-s)^{2} + (M\\,\\Gamma)^{2}}\n$$\nNow, the product becomes:\n$$\nA_{res}(s)A_{bg}^{*}(s) = \\frac{cb}{(M^{2}-s)^{2} + (M\\,\\Gamma)^{2}} \\left( M^{2} - s + i\\,M\\,\\Gamma \\right) \\left( \\cos\\phi - i\\,\\sin\\phi \\right)\n$$\nWe expand the product of the complex terms in the numerator:\n$$\n(M^{2} - s + i\\,M\\,\\Gamma)(\\cos\\phi - i\\,\\sin\\phi) = (M^{2}-s)\\cos\\phi - i(M^{2}-s)\\sin\\phi + iM\\Gamma\\cos\\phi - i^{2}M\\Gamma\\sin\\phi\n$$\n$$\n= \\left[ (M^{2}-s)\\cos\\phi + M\\Gamma\\sin\\phi \\right] + i\\left[ M\\Gamma\\cos\\phi - (M^{2}-s)\\sin\\phi \\right]\n$$\nThe real part of $A_{res}(s)A_{bg}^{*}(s)$ is therefore:\n$$\n\\text{Re}\\left( A_{res}(s)A_{bg}^{*}(s) \\right) = \\frac{cb \\left( (M^{2}-s)\\cos\\phi + M\\Gamma\\sin\\phi \\right)}{(M^{2}-s)^{2} + (M\\Gamma)^{2}}\n$$\nThe total interference term, linear in both $c$ and $b$, is $2$ times this quantity:\n$$\nI(s) = \\frac{2cb \\left( (M^{2}-s)\\cos\\phi + M\\Gamma\\sin\\phi \\right)}{(M^{2}-s)^{2} + (M\\Gamma)^{2}}\n$$\nThis is the closed-form expression for the interference term.\n\nNext, we analyze the parity of this term. We introduce the dimensionless variable $\\varepsilon = \\frac{s - M^{2}}{M\\,\\Gamma}$, which implies $s - M^{2} = \\varepsilon M \\Gamma$ and $M^{2} - s = -\\varepsilon M \\Gamma$. We substitute this into the expression for $I(s)$ to obtain $I(\\varepsilon)$:\n- Denominator: $(M^{2}-s)^{2} + (M\\,\\Gamma)^{2} = (-\\varepsilon M \\Gamma)^{2} + (M\\,\\Gamma)^{2} = (M\\Gamma)^{2}(\\varepsilon^{2} + 1)$.\n- Numerator: $2cb \\left( (-\\varepsilon M \\Gamma)\\cos\\phi + M\\Gamma\\sin\\phi \\right) = 2cb M\\Gamma \\left( \\sin\\phi - \\varepsilon\\cos\\phi \\right)$.\nSo, the interference term as a function of $\\varepsilon$ is:\n$$\nI(\\varepsilon) = \\frac{2cb M\\Gamma (\\sin\\phi - \\varepsilon\\cos\\phi)}{(M\\Gamma)^{2}(\\varepsilon^{2} + 1)} = \\frac{2cb}{M\\Gamma} \\frac{\\sin\\phi - \\varepsilon\\cos\\phi}{1+\\varepsilon^{2}}\n$$\nWe can separate this into an even part (symmetric about $\\varepsilon=0$) and an odd part (antisymmetric about $\\varepsilon=0$):\n$$\nI(\\varepsilon) = \\underbrace{\\frac{2cb\\sin\\phi}{M\\Gamma(1+\\varepsilon^{2})}}_{\\text{Even part}} + \\underbrace{\\left(-\\frac{2cb\\cos\\phi}{M\\Gamma}\\frac{\\varepsilon}{1+\\varepsilon^{2}}\\right)}_{\\text{Odd part}}\n$$\nThe line shape of the rate is determined by $|A(s)|^{2}$. Let's examine the parity of all contributions to $|A(s)|^{2}$ in terms of $\\varepsilon$:\n$$\n|A_{res}(\\varepsilon)|^{2} = \\left| \\frac{c}{-\\varepsilon M\\Gamma - iM\\Gamma} \\right|^{2} = \\frac{c^{2}}{(M\\Gamma)^{2}(\\varepsilon^{2}+1)} \\quad (\\text{Even})\n$$\n$$\n|A_{bg}(\\varepsilon)|^{2} = |b\\,\\exp(i\\phi)|^{2} = b^{2} \\quad (\\text{Even})\n$$\nThe total rate is $|A(\\varepsilon)|^{2} = |A_{res}(\\varepsilon)|^{2} + |A_{bg}(\\varepsilon)|^{2} + I(\\varepsilon)$. Since the non-interfering terms are purely even functions of $\\varepsilon$, any asymmetry in the line shape about the resonance peak ($s=M^{2}$, or $\\varepsilon=0$) must arise from the odd part of the interference term $I(\\varepsilon)$.\n\nThe line shape is asymmetric if and only if the odd part of $I(\\varepsilon)$ is non-zero. The odd part is $-\\frac{2cb\\cos\\phi}{M\\Gamma}\\frac{\\varepsilon}{1+\\varepsilon^{2}}$. For this term to be non-zero for any $\\varepsilon \\neq 0$, its coefficient must be non-zero:\n$$\n\\frac{2cb\\cos\\phi}{M\\Gamma} \\neq 0\n$$\nGiven the initial constraints $M>0$ and $\\Gamma>0$, this condition simplifies to:\n$$\nc \\neq 0 \\quad \\text{and} \\quad b \\neq 0 \\quad \\text{and} \\quad \\cos\\phi \\neq 0\n$$\nSince the problem states $b \\ge 0$, the condition $b \\neq 0$ becomes $b > 0$. The condition $\\cos\\phi \\neq 0$ means that the phase $\\phi$ cannot be an odd multiple of $\\pi/2$, i.e., $\\phi \\neq \\frac{(2n+1)\\pi}{2}$ for any integer $n$.\nThese are the necessary and sufficient conditions for the line shape to be asymmetric (Fano-like). If $c=0$, there is no resonance. If $b=0$, there is no interference. If $\\cos\\phi=0$, the background is purely out-of-phase with the real part of the resonance denominator, resulting in a symmetric distortion rather than a skewing.", "answer": "$$\n\\boxed{\\frac{2cb \\bigl( (M^{2}-s)\\cos\\phi + M\\Gamma\\sin\\phi \\bigr)}{(M^{2}-s)^{2} + (M\\Gamma)^{2}}}\n$$", "id": "3531483"}, {"introduction": "Moving beyond the simple Breit-Wigner model, a more realistic description of a resonance must account for the fact that its decay width is not a constant but depends on the available energy. This computational practice guides you through implementing an energy-dependent width, incorporating the fundamental physical effects of two-body phase space and the centrifugal barrier for a decay with orbital angular momentum $L$ [@problem_id:3531427]. By numerically generating and comparing the resulting line shapes, you will develop a powerful intuition for how these principles dynamically shape a resonance's appearance, particularly near its production threshold.", "problem": "You are tasked with modeling resonance line shapes using an energy-dependent width based on fundamental two-body phase space and angular momentum barrier considerations. The objective is to implement a computational model for a relativistic resonance with invariant mass squared $s$ that decays to two identical final-state particles of mass $m_f$, with orbital angular momentum $L$. The energy-dependent width must follow the scaling $p^{2L+1}(s)/s$, where $p(s)$ is the magnitude of the three-momentum of either daughter in the resonance rest frame.\n\nStarting from first principles relevant to computational high-energy physics, use the following foundational facts:\n\n- The relativistic dispersion relation for a resonance implies a propagator whose imaginary part is determined by decay processes through the optical theorem, leading to a width that depends on phase space and interaction dynamics.\n- For a two-body decay of a parent with invariant mass $\\sqrt{s}$ into two identical particles of mass $m_f$, the Lorentz-invariant two-body phase space density scales as $p(s)/\\sqrt{s}$.\n- Near threshold, the centrifugal barrier suppresses partial waves of orbital angular momentum $L$, yielding an amplitude scaling factor proportional to $p^L(s)$; therefore the decay rate acquires a factor proportional to $p^{2L}(s)$.\n\nFrom these, build the energy-dependent width model:\n1. The magnitude of the three-momentum in the resonance rest frame is given by\n$$\np(s) = \\frac{\\sqrt{\\lambda\\!\\left(s,m_f^2,m_f^2\\right)}}{2\\sqrt{s}},\n$$\nwhere the Källén function is $\\lambda(a,b,c) = a^2 + b^2 + c^2 - 2ab - 2ac - 2bc$.\n2. The two-body threshold is $s_{\\mathrm{thr}} = (2 m_f)^2$. The width must vanish for $s \\le s_{\\mathrm{thr}}$.\n3. The energy-dependent width normalized to the on-shell width satisfies\n$$\n\\Gamma_L(s) = \n\\begin{cases}\n\\Gamma_0 \\left(\\dfrac{p(s)}{p(m_R^2)}\\right)^{2L+1} \\left(\\dfrac{m_R^2}{s}\\right), & s > s_{\\mathrm{thr}} \\\\\n0, & s \\le s_{\\mathrm{thr}}\n\\end{cases}\n$$\nwhere $m_R$ is the resonance mass, $\\Gamma_0$ is the width at $s=m_R^2$, and $p(m_R^2)$ is the on-shell momentum.\n4. The resonance amplitude (line shape) is modeled by the relativistic Breit–Wigner propagator\n$$\nA_L(s) = \\frac{1}{m_R^2 - s - i\\, m_R\\, \\Gamma_L(s)},\n$$\nand the corresponding intensity is\n$$\nS_L(s) = \\left|A_L(s)\\right|^2.\n$$\n\nImplement a program that computes $S_L(s)$ for $L=0$, $L=1$, and $L=2$ at specified test values of $s$, using the following parameters:\n- Resonance mass $m_R = 1.02$ GeV.\n- On-shell width $\\Gamma_0 = 0.05$ GeV.\n- Final-state mass $m_f = 0.495$ GeV (identical particles).\n- Threshold $s_{\\mathrm{thr}} = (2 m_f)^2$ in $\\mathrm{GeV}^2$.\n- All energies must be in $\\mathrm{GeV}$ and all invariant masses squared in $\\mathrm{GeV}^2$; intensities $S_L(s)$ are dimensionless.\n\nUse the following test suite of invariant mass-squared values $s$ (in $\\mathrm{GeV}^2$), which probes behavior at and near threshold, below threshold, slightly above threshold, and around the resonance:\n- $s_0 = s_{\\mathrm{thr}} \\times 0.99$,\n- $s_1 = s_{\\mathrm{thr}}$,\n- $s_2 = s_{\\mathrm{thr}} \\times 1.01$,\n- $s_3 = m_R^2$,\n- $s_4 = s_{\\mathrm{thr}} \\times 1.05$,\n- $s_5 = s_{\\mathrm{thr}} \\times 1.10$.\n\nYour program must:\n- Compute $S_L(s)$ for each $s$ in the test suite and for each $L \\in \\{0,1,2\\}$ following the definitions above.\n- Use the rule that $\\Gamma_L(s)=0$ for $s \\le s_{\\mathrm{thr}}$ and $p(s)=0$ there.\n- Produce the final output as a single line containing a comma-separated list enclosed in square brackets, with the intensities ordered as $[S_{L=0}(s_0), S_{L=1}(s_0), S_{L=2}(s_0), S_{L=0}(s_1), S_{L=1}(s_1), S_{L=2}(s_1), \\dots ]$.\n- Express each float rounded to six decimal places.", "solution": "The problem presents a valid and well-posed scenario in computational high-energy physics. All provided parameters, formulas, and conditions are scientifically sound, free of contradictions, and sufficient for deriving a unique numerical solution. The model described—a relativistic Breit-Wigner resonance with an energy-dependent width accounting for phase space and centrifugal barrier effects—is a standard and fundamental construct in particle physics phenomenology.\n\nThe objective is to compute the resonance intensity, $S_L(s)$, for a particle of mass $m_R$ and on-shell width $\\Gamma_0$ decaying into two identical particles of mass $m_f$. The intensity is a function of the invariant mass squared of the system, $s$, and the orbital angular momentum of the decay, $L$.\n\nThe calculation proceeds through a sequence of well-defined steps based on the provided theoretical framework.\n\nFirst, we define the fundamental kinematic quantities. The magnitude of the three-momentum, $p(s)$, of either final-state particle in the resonance rest frame is given by:\n$$\np(s) = \\frac{\\sqrt{\\lambda(s, m_f^2, m_f^2)}}{2\\sqrt{s}}\n$$\nwhere $\\lambda(a, b, c) = a^2 + b^2 + c^2 - 2ab - 2ac - 2bc$ is the Källén kinematic function. For the case of two identical final-state particles, this simplifies to $\\lambda(s, m_f^2, m_f^2) = s(s - 4m_f^2)$. The decay is only kinematically possible above the threshold $s_{\\mathrm{thr}} = (2m_f)^2 = 4m_f^2$. For $s \\le s_{\\mathrm{thr}}$, the momentum $p(s)$ is zero.\n\nSecond, we model the energy-dependent width, $\\Gamma_L(s)$. This quantity reflects how the decay probability changes as the resonance is produced \"off-shell\" (i.e., when $\\sqrt{s} \\neq m_R$). The model incorporates two key physical effects: the available phase space for the decay, and the centrifugal barrier that suppresses decays with non-zero angular momentum, especially near the threshold. The prescribed model for the width is:\n$$\n\\Gamma_L(s) = \n\\begin{cases}\n\\Gamma_0 \\left(\\dfrac{p(s)}{p(m_R^2)}\\right)^{2L+1} \\left(\\dfrac{m_R^2}{s}\\right), & s > s_{\\mathrm{thr}} \\\\\n0, & s \\le s_{\\mathrm{thr}}\n\\end{cases}\n$$\nHere, $\\Gamma_0$ is the nominal width measured at the resonance peak ($s=m_R^2$), and $p(m_R^2)$ is the on-shell momentum, which serves as a normalization constant. The term $(p(s))^{2L+1}$ combines the phase space factor ($p(s)$) and the centrifugal barrier factor ($p(s)^{2L}$). The factor $(m_R^2/s)$ is a conventional choice for parameterizing the remaining off-shell dependency.\n\nThird, we use the relativistic Breit-Wigner formula to describe the resonance amplitude, $A_L(s)$. This formula models the behavior of an unstable particle's propagator:\n$$\nA_L(s) = \\frac{1}{m_R^2 - s - i m_R \\Gamma_L(s)}\n$$\nThe denominator's real part, $m_R^2 - s$, describes the propagation of a stable particle, while the imaginary part, $-i m_R \\Gamma_L(s)$, accounts for the decay, giving the propagator a finite lifetime in accordance with the optical theorem.\n\nFinally, the observable intensity of the resonance signal, $S_L(s)$, is proportional to the squared magnitude of the amplitude:\n$$\nS_L(s) = |A_L(s)|^2 = \\left| \\frac{1}{m_R^2 - s - i m_R \\Gamma_L(s)} \\right|^2 = \\frac{1}{(m_R^2 - s)^2 + (m_R \\Gamma_L(s))^2}\n$$\n\nThe computational algorithm is implemented as follows:\n1.  Define the input physical constants: resonance mass $m_R = 1.02 \\, \\mathrm{GeV}$, on-shell width $\\Gamma_0 = 0.05 \\, \\mathrm{GeV}$, and final-state particle mass $m_f = 0.495 \\, \\mathrm{GeV}$.\n2.  Pre-compute derived constants: $m_R^2$, $m_f^2$, the threshold $s_{\\mathrm{thr}} = 4m_f^2$, and the on-shell momentum $p_0 \\equiv p(m_R^2)$.\n3.  Define the set of test points for the invariant mass squared, $s$, as specified in the problem statement.\n4.  For each test point $s$ and for each required angular momentum $L \\in \\{0, 1, 2\\}$, perform the following calculations:\n    a. Calculate the off-shell momentum $p(s)$, enforcing the condition $p(s) = 0$ for $s \\le s_{\\mathrm{thr}}$.\n    b. Calculate the energy-dependent width $\\Gamma_L(s)$ using its piecewise definition.\n    c. Substitute these values into the expression for the intensity $S_L(s)$ to obtain the result.\n5.  Collect the results in the specified order and format them to six decimal places.\n\nFor the special case where $s \\le s_{\\mathrm{thr}}$, we have $\\Gamma_L(s) = 0$. The intensity calculation simplifies to:\n$$\nS_L(s) = \\frac{1}{(m_R^2 - s)^2} \\quad (\\text{for } s \\le s_{\\mathrm{thr}})\n$$\nThis result is independent of the angular momentum $L$.\n\nFor the on-shell case, $s = m_R^2$, we have $p(m_R^2) = p_0$. The width formula gives $\\Gamma_L(m_R^2) = \\Gamma_0$. The intensity becomes:\n$$\nS_L(m_R^2) = \\frac{1}{(m_R^2 - m_R^2)^2 + (m_R \\Gamma_0)^2} = \\frac{1}{(m_R \\Gamma_0)^2}\n$$\nThis result is also independent of $L$ and corresponds to the maximum height of the resonance peak in this model. The program implements this logic to generate the required output.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes resonance intensities S_L(s) using a relativistic Breit-Wigner\n    model with an energy-dependent width.\n    \"\"\"\n    \n    # ------------------\n    # 1. Define Constants  Parameters\n    # ------------------\n    # All energies are in GeV, and invariant masses squared are in GeV^2.\n    mR = 1.02  # Resonance mass\n    Gamma0 = 0.05  # On-shell width\n    mf = 0.495  # Final-state particle mass\n\n    # Derived constants\n    mR_sq = mR**2\n    mf_sq = mf**2\n    s_thr = (2 * mf)**2\n\n    # ------------------\n    # 2. Define Helper Functions\n    # ------------------\n\n    def get_momentum(s, s_threshold, mf_squared):\n        \"\"\"\n        Calculates the three-momentum p(s) in the resonance rest frame.\n        p(s) = 0 for s = s_thr.\n        \"\"\"\n        if s = s_threshold:\n            return 0.0\n        \n        # Simplified Källén function: lambda(s, m^2, m^2) = s * (s - 4*m^2)\n        # s_thr = 4*m^2\n        kallen_lambda = s * (s - s_threshold)\n        \n        # Check for numerical precision issues near threshold\n        if kallen_lambda  0:\n            return 0.0\n            \n        return np.sqrt(kallen_lambda) / (2 * np.sqrt(s))\n\n    def get_energy_dependent_width(s, L, p_s_val, p_on_shell, s_threshold):\n        \"\"\"\n        Calculates the energy-dependent width Gamma_L(s).\n        \"\"\"\n        if s = s_threshold or p_on_shell == 0:\n            return 0.0\n        \n        ratio_p = p_s_val / p_on_shell\n        ratio_s = mR_sq / s\n        \n        return Gamma0 * (ratio_p**(2 * L + 1)) * ratio_s\n\n    def get_intensity(s, L, p_s_val, p_on_shell, s_threshold):\n        \"\"\"\n        Calculates the intensity S_L(s) = |A_L(s)|^2.\n        \"\"\"\n        gamma_l_s = get_energy_dependent_width(s, L, p_s_val, p_on_shell, s_threshold)\n        \n        real_part_denom = mR_sq - s\n        imag_part_denom = -mR * gamma_l_s\n        \n        denominator_sq = real_part_denom**2 + imag_part_denom**2\n        \n        # Avoid division by zero, although it's unlikely with this model\n        if denominator_sq == 0:\n            return float('inf')\n            \n        return 1.0 / denominator_sq\n\n    # ------------------\n    # 3. Pre-computation\n    # ------------------\n    \n    # Calculate on-shell momentum for normalization\n    p_on_shell = get_momentum(mR_sq, s_thr, mf_sq)\n\n    # ------------------\n    # 4. Generate Test Cases and Compute Results\n    # ------------------\n    \n    # Define the test suite for s in GeV^2\n    s_test_suite = [\n        s_thr * 0.99,  # s0\n        s_thr,         # s1\n        s_thr * 1.01,  # s2\n        mR_sq,         # s3\n        s_thr * 1.05,  # s4\n        s_thr * 1.10   # s5\n    ]\n    \n    L_values = [0, 1, 2]\n    \n    results = []\n    \n    for s_val in s_test_suite:\n        # Calculate momentum once for the current s value\n        p_current = get_momentum(s_val, s_thr, mf_sq)\n        for L_val in L_values:\n            intensity = get_intensity(s_val, L_val, p_current, p_on_shell, s_thr)\n            # Round to six decimal places as required\n            results.append(f\"{intensity:.6f}\")\n\n    # ------------------\n    # 5. Final Output\n    # ------------------\n    \n    # Format the final output as a single-line comma-separated list\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "3531427"}]}