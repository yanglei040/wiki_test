{"hands_on_practices": [{"introduction": "To truly understand the Standard Model, we must begin with its mathematical foundation: the gauge symmetry groups. This first practice focuses on constructing the Lie algebra generators for the $SU(2)$ and $SU(3)$ groups, which govern the electroweak and strong interactions, respectively. By numerically computing these generators and their structure constants from first principles, you will gain a concrete understanding of the algebraic rules that dictate the behavior of gauge bosons and their self-interactions [@problem_id:3537670].", "problem": "You are asked to construct the Lie algebra generators and structure constants for the Special Unitary group ($SU$) gauge factors that appear in the Standard Model of particle physics, specifically $SU(2)$ for the Electroweak (EW) sector and $SU(3)$ for Quantum Chromodynamics (QCD), and to verify numerically their defining properties in the fundamental representation. Work in the physics convention where the Lie algebra generators are Hermitian matrices. The fundamental base you may assume includes the following well-tested facts and definitions:\n\n- The Special Unitary group $SU(N)$ is the group of $N \\times N$ unitary matrices with determinant $1$.\n- Its Lie algebra is spanned by Hermitian, traceless generators $T^a$ obeying the commutation relations $$[T^a, T^b] = i f^{abc} T^c,$$ where $f^{abc}$ are the real structure constants of the algebra and the repeated index is summed.\n- The generators can be normalized to satisfy $$\\mathrm{Tr}(T^a T^b) = \\tfrac{1}{2}\\,\\delta^{ab},$$ where $\\mathrm{Tr}$ denotes the matrix trace and $\\delta^{ab}$ is the Kronecker delta.\n\nYour program must:\n- Construct the fundamental-representation generators $\\{T^a\\}$ for $SU(2)$ and $SU(3)$ using standard matrix bases (Pauli and Gell-Mann matrices), scaled so that the above trace normalization is satisfied.\n- Compute the structure constants $f^{abc}$ directly from the commutation relations and the trace inner product, without using any pre-tabulated values.\n- Verify the commutation relations by reconstructing the commutator $[T^a, T^b]$ from the computed $f^{abc}$ and comparing to the direct matrix commutator, and verify the trace normalization for selected pairs.\n\nNumerical comparisons must use the Frobenius norm and a tolerance of $\\epsilon = 10^{-12}$.\n\nDefine the Frobenius norm of a matrix $A$ as $$\\|A\\|_F = \\sqrt{\\sum_{ij} |A_{ij}|^2}.$$\n\nTest Suite:\nImplement and evaluate the following five test cases to produce boolean outputs, each being true if the stated condition holds within the tolerance $\\epsilon$ and false otherwise.\n\n- Test case $1$: Group $SU(2)$, commutation verification for indices $(a,b) = (1,2)$. Check that $$\\left\\|[T^1, T^2] - i \\sum_{c=1}^{3} f^{12c} T^c \\right\\|_F < \\epsilon.$$\n- Test case $2$: Group $SU(3)$, commutation verification for indices $(a,b) = (1,2)$. Check that $$\\left\\|[T^1, T^2] - i \\sum_{c=1}^{8} f^{12c} T^c \\right\\|_F < \\epsilon.$$\n- Test case $3$: Group $SU(2)$, edge-case commutator for identical indices $(a,b) = (1,1)$. Check that $$\\left\\|[T^1, T^1]\\right\\|_F < \\epsilon.$$\n- Test case $4$: Group $SU(3)$, trace normalization for $(a,b) = (4,4)$. Check that $$\\left|\\mathrm{Tr}(T^4 T^4) - \\tfrac{1}{2}\\right| < \\epsilon.$$\n- Test case $5$: Group $SU(3)$, trace normalization for $(a,b) = (4,5)$. Check that $$\\left|\\mathrm{Tr}(T^4 T^5) - 0\\right| < \\epsilon.$$\n\nFinal Output Format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[result_1,result_2,result_3,result_4,result_5]$), where each entry is a boolean for the corresponding test case. No physical units or angles are involved in this problem.", "solution": "The problem statement has been validated and is found to be scientifically grounded, well-posed, objective, and self-contained. It presents a standard computational exercise in particle physics concerning the Lie algebra of the $SU(N)$ gauge groups relevant to the Standard Model. All definitions, conventions, and requirements are stated clearly and are consistent with established theory. Therefore, a solution can be provided.\n\nThe task is to construct the Lie algebra generators $T^a$ for the groups $SU(2)$ and $SU(3)$ in the fundamental representation, compute the corresponding structure constants $f^{abc}$, and numerically verify their defining properties. The generators are required to be Hermitian and traceless, satisfying the commutation relations $[T^a, T^b] = i f^{abc} T^c$ and the normalization condition $\\mathrm{Tr}(T^a T^b) = \\frac{1}{2}\\delta^{ab}$.\n\nFirst, we construct the generators. The Lie algebra of $SU(N)$, denoted $\\mathfrak{su}(N)$, has dimension $N^2-1$. The generators are constructed from a standard basis of Hermitian, traceless matrices, which are then scaled to meet the required normalization.\n\nFor $SU(2)$, the algebra $\\mathfrak{su}(2)$ is $3$-dimensional. A standard basis is given by the Pauli matrices, $\\sigma^a$:\n$$\n\\sigma^1 = \\begin{pmatrix} 0 & 1 \\\\ 1 & 0 \\end{pmatrix}, \\quad\n\\sigma^2 = \\begin{pmatrix} 0 & -i \\\\ i & 0 \\end{pmatrix}, \\quad\n\\sigma^3 = \\begin{pmatrix} 1 & 0 \\\\ 0 & -1 \\end{pmatrix}\n$$\nThe Pauli matrices satisfy the relation $\\mathrm{Tr}(\\sigma^a \\sigma^b) = 2\\delta^{ab}$. To satisfy the required normalization $\\mathrm{Tr}(T^a T^b) = \\frac{1}{2}\\delta^{ab}$, we define the generators $T^a$ as $T^a = k\\sigma^a$. The trace condition becomes $\\mathrm{Tr}((k\\sigma^a)(k\\sigma^b)) = k^2 \\mathrm{Tr}(\\sigma^a\\sigma^b) = k^2(2\\delta^{ab})$. Setting this equal to $\\frac{1}{2}\\delta^{ab}$ gives $2k^2 = \\frac{1}{2}$, which yields a scaling factor of $k = \\frac{1}{2}$. Thus, the generators for $SU(2)$ are $T^a = \\frac{1}{2}\\sigma^a$.\n\nFor $SU(3)$, the algebra $\\mathfrak{su}(3)$ is $8$-dimensional. A standard basis is provided by the Gell-Mann matrices, $\\lambda^a$:\n$$\n\\lambda^1 = \\begin{pmatrix} 0 & 1 & 0 \\\\ 1 & 0 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix}, \\quad\n\\lambda^2 = \\begin{pmatrix} 0 & -i & 0 \\\\ i & 0 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix}, \\quad\n\\lambda^3 = \\begin{pmatrix} 1 & 0 & 0 \\\\ 0 & -1 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix}\n$$\n$$\n\\lambda^4 = \\begin{pmatrix} 0 & 0 & 1 \\\\ 0 & 0 & 0 \\\\ 1 & 0 & 0 \\end{pmatrix}, \\quad\n\\lambda^5 = \\begin{pmatrix} 0 & 0 & -i \\\\ 0 & 0 & 0 \\\\ i & 0 & 0 \\end{pmatrix}, \\quad\n\\lambda^6 = \\begin{pmatrix} 0 & 0 & 0 \\\\ 0 & 0 & 1 \\\\ 0 & 1 & 0 \\end{pmatrix}\n$$\n$$\n\\lambda^7 = \\begin{pmatrix} 0 & 0 & 0 \\\\ 0 & 0 & -i \\\\ 0 & i & 0 \\end{pmatrix}, \\quad\n\\lambda^8 = \\frac{1}{\\sqrt{3}}\\begin{pmatrix} 1 & 0 & 0 \\\\ 0 & 1 & 0 \\\\ 0 & 0 & -2 \\end{pmatrix}\n$$\nThese matrices also satisfy the relation $\\mathrm{Tr}(\\lambda^a \\lambda^b) = 2\\delta^{ab}$. By the same logic as for $SU(2)$, the correctly normalized generators for $SU(3)$ are $T^a = \\frac{1}{2}\\lambda^a$.\n\nNext, we devise a method to compute the structure constants $f^{abc}$ directly from the generators. Starting with the commutation relation $[T^a, T^b] = i f^{abc} T^c$ (summation over $c$ is implied), we can isolate a specific structure constant, say $f^{abk}$, by exploiting the orthonormality of the generators. We multiply both sides by $T^k$ and take the trace:\n$$\n\\mathrm{Tr}([T^a, T^b] T^k) = \\mathrm{Tr}(i f^{abc} T^c T^k) = i \\sum_c f^{abc} \\mathrm{Tr}(T^c T^k)\n$$\nUsing the normalization $\\mathrm{Tr}(T^c T^k) = \\frac{1}{2}\\delta^{ck}$:\n$$\n\\mathrm{Tr}([T^a, T^b] T^k) = i \\sum_c f^{abc} (\\tfrac{1}{2}\\delta^{ck}) = i \\tfrac{1}{2} f^{abk}\n$$\nSolving for $f^{abk}$ yields:\n$$\nf^{abk} = \\frac{2}{i} \\mathrm{Tr}([T^a, T^b] T^k) = -2i \\, \\mathrm{Tr}([T^a, T^b] T^k)\n$$\nSince the generators $T^a$ are Hermitian, the commutator $[T^a, T^b]$ is anti-Hermitian. The trace of an anti-Hermitian matrix multiplied by a Hermitian matrix is purely imaginary. Therefore, the multiplication by $-2i$ results in real-valued structure constants $f^{abc}$, as required. This formula allows for the direct computation of all structure constants by iterating through all indices $a$, $b$, and $c$.\n\nThe final step is to perform the numerical verifications specified in the test suite. This involves implementing the described constructions and calculations in code.\nA function is created to generate the properties of $SU(N)$ for $N=2$ and $N=3$. This function first constructs the scaled generator matrices $\\{T^a\\}$. Then, it iterates through all index combinations to compute the structure constant tensor $f^{abc}$ using the derived formula.\n\nThe five test cases are then evaluated:\n1.  For $SU(2)$ and indices $(a,b)=(1,2)$, we compute the difference matrix $D = [T^1, T^2] - i \\sum_{c=1}^{3} f^{12c} T^c$ and verify that its Frobenius norm $\\|D\\|_F$ is less than the tolerance $\\epsilon = 10^{-12}$. The Frobenius norm is defined as $\\|A\\|_F = \\sqrt{\\sum_{i,j} |A_{ij}|^2}$.\n2.  The same verification is performed for $SU(3)$ with indices $(a,b)=(1,2)$, where the sum now runs from $c=1$ to $8$.\n3.  For $SU(2)$ and $(a,b)=(1,1)$, we verify that the commutator $[T^1, T^1]$ is numerically the zero matrix by checking if $\\|[T^1, T^1]\\|_F < \\epsilon$.\n4.  For $SU(3)$ and $(a,b)=(4,4)$, we test the trace normalization by verifying that $|\\mathrm{Tr}(T^4 T^4) - \\frac{1}{2}| < \\epsilon$.\n5.  For $SU(3)$ and $(a,b)=(4,5)$, we test the trace orthogonality by verifying that $|\\mathrm{Tr}(T^4 T^5) - 0| < \\epsilon$.\n\nThe implementation utilizes `numpy` for complex matrix algebra. Indices from the problem statement are 1-based and are converted to 0-based for array access in the code.", "answer": "```python\nimport numpy as np\n\ndef get_su_n_properties(N, cache):\n    \"\"\"\n    Constructs generators and structure constants for SU(N).\n    Results are cached to avoid recomputation.\n    \"\"\"\n    if N in cache:\n        return cache[N]\n\n    if N == 2:\n        dim = 3\n        # Pauli matrices\n        s1 = np.array([[0, 1], [1, 0]], dtype=complex)\n        s2 = np.array([[0, -1j], [1j, 0]], dtype=complex)\n        s3 = np.array([[1, 0], [0, -1]], dtype=complex)\n        # Scale to satisfy Tr(T^a T^b) = 0.5 * delta_ab\n        generators = [0.5 * s1, 0.5 * s2, 0.5 * s3]\n    elif N == 3:\n        dim = 8\n        # Gell-Mann matrices\n        l1 = np.array([[0, 1, 0], [1, 0, 0], [0, 0, 0]], dtype=complex)\n        l2 = np.array([[0, -1j, 0], [1j, 0, 0], [0, 0, 0]], dtype=complex)\n        l3 = np.array([[1, 0, 0], [0, -1, 0], [0, 0, 0]], dtype=complex)\n        l4 = np.array([[0, 0, 1], [0, 0, 0], [1, 0, 0]], dtype=complex)\n        l5 = np.array([[0, 0, -1j], [0, 0, 0], [1j, 0, 0]], dtype=complex)\n        l6 = np.array([[0, 0, 0], [0, 0, 1], [0, 1, 0]], dtype=complex)\n        l7 = np.array([[0, 0, 0], [0, 0, -1j], [0, 1j, 0]], dtype=complex)\n        l8 = np.array([[1, 0, 0], [0, 1, 0], [0, 0, -2]], dtype=complex) / np.sqrt(3)\n        gell_mann_matrices = [l1, l2, l3, l4, l5, l6, l7, l8]\n        # Scale to satisfy Tr(T^a T^b) = 0.5 * delta_ab\n        generators = [0.5 * lm for lm in gell_mann_matrices]\n    else:\n        raise NotImplementedError(\"Only SU(2) and SU(3) are supported.\")\n\n    # Compute structure constants f^abc = -2i * Tr([T^a, T^b] T^c)\n    f_abc = np.zeros((dim, dim, dim), dtype=float)\n    for a in range(dim):\n        for b in range(dim):\n            # Commutator [T^a, T^b]\n            comm = generators[a] @ generators[b] - generators[b] @ generators[a]\n            if np.linalg.norm(comm) > 1e-15:  # Avoid computation for zero commutators\n                for c in range(dim):\n                    # The result of the trace is purely imaginary\n                    val = -2j * np.trace(comm @ generators[c])\n                    # Structure constants are real\n                    f_abc[a, b, c] = np.real(val)\n\n    result = {\n        \"N\": N,\n        \"dim\": dim,\n        \"generators\": generators,\n        \"structure_constants\": f_abc,\n    }\n    cache[N] = result\n    return result\n\ndef solve():\n    \"\"\"\n    Main function to construct SU(N) properties and run verification tests.\n    \"\"\"\n    epsilon = 1e-12\n    su_n_cache = {}\n    results = []\n\n    # Test case 1: SU(2), commutation verification for (a,b) = (1,2)\n    su2 = get_su_n_properties(2, su_n_cache)\n    T = su2[\"generators\"]\n    f = su2[\"structure_constants\"]\n    a, b = 1 - 1, 2 - 1  # 0-based indices\n    lhs1 = T[a] @ T[b] - T[b] @ T[a]\n    rhs1_sum_term = np.zeros((2, 2), dtype=complex)\n    for c in range(su2[\"dim\"]):\n        rhs1_sum_term += f[a, b, c] * T[c]\n    rhs1 = 1j * rhs1_sum_term\n    norm1 = np.linalg.norm(lhs1 - rhs1, 'fro')\n    results.append(norm1  epsilon)\n    \n    # Test case 2: SU(3), commutation verification for (a,b) = (1,2)\n    su3 = get_su_n_properties(3, su_n_cache)\n    T = su3[\"generators\"]\n    f = su3[\"structure_constants\"]\n    a, b = 1 - 1, 2 - 1  # 0-based indices\n    lhs2 = T[a] @ T[b] - T[b] @ T[a]\n    rhs2_sum_term = np.zeros((3, 3), dtype=complex)\n    for c in range(su3[\"dim\"]):\n        rhs2_sum_term += f[a, b, c] * T[c]\n    rhs2 = 1j * rhs2_sum_term\n    norm2 = np.linalg.norm(lhs2 - rhs2, 'fro')\n    results.append(norm2  epsilon)\n\n    # Test case 3: SU(2), edge-case commutator for (a,b) = (1,1)\n    T = su2[\"generators\"]\n    a = 1 - 1  # 0-based index\n    comm3 = T[a] @ T[a] - T[a] @ T[a]\n    norm3 = np.linalg.norm(comm3, 'fro')\n    results.append(norm3  epsilon)\n\n    # Test case 4: SU(3), trace normalization for (a,b) = (4,4)\n    T = su3[\"generators\"]\n    a, b = 4 - 1, 4 - 1  # 0-based indices\n    trace4 = np.trace(T[a] @ T[b])\n    results.append(np.abs(trace4 - 0.5)  epsilon)\n    \n    # Test case 5: SU(3), trace normalization for (a,b) = (4,5)\n    T = su3[\"generators\"]\n    a, b = 4 - 1, 5 - 1  # 0-based indices\n    trace5 = np.trace(T[a] @ T[b])\n    results.append(np.abs(trace5 - 0.0)  epsilon)\n\n    # Format and print the final output as a list of booleans.\n    print(f\"[{','.join(map(lambda x: str(x).lower(), results))}]\")\n\nsolve()\n\n```", "id": "3537670"}, {"introduction": "Having established the algebraic structure of the gauge groups, we now explore the central pillar of the electroweak theory: spontaneous symmetry breaking. The Higgs mechanism mixes the neutral gauge fields of the $SU(2)_L \\times U(1)_Y$ symmetry, giving rise to the massive $Z$ boson and the massless photon. This exercise asks you to computationally verify this mixing and show that the emergent photon field couples to fermions exactly as predicted by the principle of electric charge conservation, providing a powerful check on our understanding of electroweak unification [@problem_id:3537662].", "problem": "You are to write a complete, runnable program that numerically verifies the electromagnetic couplings of fermions in the electroweak sector of the Standard Model after spontaneous symmetry breaking. Use the following context and foundational definitions only. The Standard Model gauge group is $\\mathrm{SU}(2)_L \\times \\mathrm{U}(1)_Y$ with gauge fields $W_\\mu^a$ for $\\mathrm{SU}(2)_L$ and $B_\\mu$ for $\\mathrm{U}(1)_Y$, and gauge couplings $g$ and $g'$, respectively. The covariant derivative acting on a fermion field $\\psi$ in a representation characterized by weak isospin generators $T^a$ and hypercharge $Y$ is\n$$\nD_\\mu \\psi = \\left(\\partial_\\mu - i\\,g\\,T^a W_\\mu^a - i\\,g'\\,\\frac{Y}{2} B_\\mu\\right)\\psi.\n$$\nElectroweak symmetry breaking is triggered by a Higgs doublet with hypercharge $Y_H=+1$, yielding a non-zero vacuum expectation value that defines a neutral gauge-boson mass matrix and a massless photon field $A_\\mu$ as a specific linear combination of $W_\\mu^3$ and $B_\\mu$. The unbroken electromagnetic symmetry is generated by the operator $Q = T_3 + \\frac{Y}{2}$, where $T_3$ is the third component of weak isospin. The elementary electromagnetic coupling $e$ is the coupling of the unbroken $\\mathrm{U}(1)_{\\mathrm{em}}$ gauge symmetry that results from the mixing.\n\nTask: Starting strictly from the covariant derivative above, the Higgs doublet quantum numbers, and the definition of the electromagnetic generator $Q$, derive the photon field $A_\\mu$ and its fermion coupling. Then, compute numerically for a given tuple $(g, g', T_3, Y)$ the coefficient multiplying $A_\\mu$ in the interaction term extracted from $D_\\mu$, and check that it equals $e \\, Q$ to within a small numerical tolerance. You must not assume any shortcut formulas; your derivation must follow from the stated foundational base. The test should return a boolean for each case indicating whether the numerical equality holds within the tolerance.\n\nAll quantities here are dimensionless, so no physical units are required. Angles, if used internally, should be treated as radian measures.\n\nImplement the check for the following test suite of parameters, representing different fermion chiralities and boundary coupling limits. Each test case is a tuple $(g, g', T_3, Y)$ where $T_3$ and $Y$ are the quantum numbers of the fermion state under $\\mathrm{SU}(2)_L$ and $\\mathrm{U}(1)_Y$, respectively:\n\n- Case $1$: $(0.65, 0.36, -\\frac{1}{2}, -1)$\n- Case $2$: $(0.65, 0.36, +\\frac{1}{2}, -1)$\n- Case $3$: $(0.65, 0.36, 0, -2)$\n- Case $4$: $(0.65, 0.36, +\\frac{1}{2}, +\\frac{1}{3})$\n- Case $5$: $(0.65, 0.36, -\\frac{1}{2}, +\\frac{1}{3})$\n- Case $6$: $(0.65, 0.36, 0, +\\frac{4}{3})$\n- Case $7$: $(0.65, 0.36, 0, -\\frac{2}{3})$\n- Case $8$: $(0.65, 0.0, 0, -2)$\n- Case $9$: $(0.0, 0.36, +\\frac{1}{2}, +\\frac{1}{3})$\n- Case $10$: $(1.0, 1.0, -\\frac{1}{2}, -1)$\n- Case $11$: $(1.0, 1.0, 0, -\\frac{2}{3})$\n\nFor each case, compute the numerical coefficient of $A_\\mu$ from the covariant derivative and compare it to $e Q$ using an absolute tolerance of $\\varepsilon = 10^{-12}$. The result for each case should be a boolean indicating whether the equality holds within the tolerance.\n\nFinal output format: Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets with no spaces, for example, \"[true,false,true]\".", "solution": "The Standard Model electroweak sector is based on the gauge group $\\mathrm{SU}(2)_L \\times \\mathrm{U}(1)_Y$ with gauge fields $W_\\mu^a$ and $B_\\mu$ and couplings $g$ and $g'$. For a fermion field $\\psi$ with weak isospin generators $T^a$ and hypercharge $Y$, the covariant derivative is\n$$\nD_\\mu \\psi = \\left(\\partial_\\mu - i\\,g\\,T^a W_\\mu^a - i\\,g'\\,\\frac{Y}{2} B_\\mu\\right)\\psi.\n$$\nElectroweak symmetry breaking proceeds by introducing a complex Higgs doublet $\\Phi$ transforming as $(\\mathbf{2}, Y_H=+1)$, with vacuum expectation value (VEV) oriented in the lower component,\n$$\n\\langle \\Phi \\rangle = \\frac{1}{\\sqrt{2}} \\begin{pmatrix} 0 \\\\ v \\end{pmatrix},\n$$\nwhere $v$ is real and non-zero. The kinetic term for the Higgs field,\n$$\n\\mathcal{L}_{\\mathrm{H,kin}} = (D_\\mu \\Phi)^\\dagger (D^\\mu \\Phi),\n$$\ngenerates mass terms for the gauge bosons through the VEV. The neutral gauge bosons $(W_\\mu^3, B_\\mu)$ acquire a mass matrix from this term. Using the covariant derivative on the Higgs,\n$$\nD_\\mu \\Phi = \\left(\\partial_\\mu - i\\,g\\,\\frac{\\sigma^a}{2} W_\\mu^a - i\\,g'\\,\\frac{Y_H}{2}\\,B_\\mu\\right)\\Phi,\n$$\nand substituting the VEV, only the neutral directions contribute, giving a mass term whose matrix form is proportional to\n$$\n\\mathcal{L}_{\\mathrm{mass,neutral}} \\propto \\begin{pmatrix} W_\\mu^3  B_\\mu \\end{pmatrix}\n\\begin{pmatrix} g^2  - g g' \\\\ - g g'  g'^2 \\end{pmatrix}\n\\begin{pmatrix} W^{3\\mu} \\\\ B^\\mu \\end{pmatrix}.\n$$\nThe squared mass matrix is\n$$\nM^2 = \\frac{v^2}{4}\n\\begin{pmatrix} g^2  - g g' \\\\ - g g'  g'^2 \\end{pmatrix}\n$$\nThis matrix has eigenvalues\n$$\n\\lambda_0 = 0, \\quad \\lambda_Z = \\frac{v^2}{4}\\left(g^2 + g'^2\\right),\n$$\nwith corresponding orthonormal eigenvectors\n$$\n\\vec{v}_A \\propto \\begin{pmatrix} s_W \\\\ c_W \\end{pmatrix}, \\quad\n\\vec{v}_Z \\propto \\begin{pmatrix} c_W \\\\ - s_W \\end{pmatrix},\n$$\ndefined by the Weinberg angle $\\theta_W$ satisfying\n$$\ns_W \\equiv \\sin\\theta_W = \\frac{g'}{\\sqrt{g^2 + g'^2}}, \\qquad\nc_W \\equiv \\cos\\theta_W = \\frac{g}{\\sqrt{g^2 + g'^2}}.\n$$\nThus, the massless photon and massive $Z_\\mu$ fields are\n$$\nA_\\mu = s_W\\,W_\\mu^3 + c_W\\,B_\\mu, \\qquad\nZ_\\mu = c_W\\,W_\\mu^3 - s_W\\,B_\\mu.\n$$\nTo find the coupling of a fermion to $A_\\mu$, extract the terms in the covariant derivative linear in $W_\\mu^3$ and $B_\\mu$,\n$$\n\\mathcal{L}_{\\mathrm{int,neutral}} = - i \\left[g\\,T_3\\,W_\\mu^3 + g'\\,\\frac{Y}{2}\\,B_\\mu\\right]\\bar{\\psi}\\gamma^\\mu\\psi,\n$$\nand substitute $W_\\mu^3$ and $B_\\mu$ in terms of $A_\\mu$ and $Z_\\mu$. The coefficient of $A_\\mu$ is\n$$\n\\kappa_A = g\\,T_3\\,s_W + g'\\,\\frac{Y}{2}\\,c_W.\n$$\nUsing\n$$\ne \\equiv g\\,s_W = g'\\,c_W,\n$$\nwhich follows directly from the orthonormality and definitions of $s_W$ and $c_W$, we obtain\n$$\n\\kappa_A = e\\left(T_3 + \\frac{Y}{2}\\right) = e\\,Q.\n$$\nTherefore, the photon couples to a fermion with strength equal to the elementary coupling $e$ times its electric charge $Q$.\n\nAlgorithmic implementation proceeds as follows:\n- For each test case $(g, g', T_3, Y)$, compute\n$$\ns_W = \\frac{g'}{\\sqrt{g^2 + g'^2}}, \\qquad c_W = \\frac{g}{\\sqrt{g^2 + g'^2}},\n$$\nwith the understanding that if $g = g' = 0$ the couplings vanish and the check is trivially satisfied by defining $s_W = 0$ and $c_W = 0$.\n- Compute\n$$\ne_g = g\\,s_W, \\qquad e_{g'} = g'\\,c_W,\n$$\nand use a numerically stable choice for $e$, for instance the average $e = \\frac{1}{2}(e_g + e_{g'})$, although analytically $e_g=e_{g'}$.\n- Compute the fermion’s electric charge\n$$\nQ = T_3 + \\frac{Y}{2}.\n$$\n- Compute the photon coupling extracted from the covariant derivative\n$$\n\\kappa_A = g\\,T_3\\,s_W + g'\\,\\frac{Y}{2}\\,c_W.\n$$\n- Compare $|\\kappa_A - e\\,Q|$ to the tolerance $\\varepsilon = 10^{-12}$ to produce a boolean result for each case.\n\nWe apply this procedure to the provided test suite:\n- Cases $1$–$7$ use $g = 0.65$ and $g' = 0.36$ with fermion quantum numbers for left-handed leptons and quarks and right-handed singlets: $(T_3,Y) \\in \\{(-\\frac{1}{2},-1),(\\frac{1}{2},-1),(0,-2),(\\frac{1}{2},\\frac{1}{3}),(-\\frac{1}{2},\\frac{1}{3}),(0,\\frac{4}{3}),(0,-\\frac{2}{3})\\}$.\n- Case $8$ sets $g' = 0$ and $g = 0.65$ for $(T_3,Y)=(0,-2)$, yielding $s_W=0$, $c_W=1$, $e=0$, and $\\kappa_A=0$, consistent with $e Q=0$.\n- Case $9$ sets $g = 0$ and $g' = 0.36$ for $(T_3,Y)=(\\frac{1}{2},\\frac{1}{3})$, yielding $s_W=1$, $c_W=0$, $e=0$, and $\\kappa_A=0$, again consistent with $e Q=0$.\n- Cases $10$–$11$ use symmetric couplings $g=g'=1.0$ for $(T_3,Y)=(-\\frac{1}{2},-1)$ and $(0,-\\frac{2}{3})$.\n\nFor all cases, the derived equality $\\kappa_A = e\\,Q$ holds, so each check should return a boolean value of true within the stated numerical tolerance. The program will aggregate these into a single bracketed, comma-separated list with no spaces.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef photon_coupling_matches(g: float, gp: float, T3: float, Y: float, tol: float = 1e-12) -> bool:\n    \"\"\"\n    Check numerically that the photon field A_mu couples to a fermion with strength e*Q\n    after electroweak symmetry breaking, given (g, g', T3, Y).\n\n    Parameters:\n    - g: SU(2)_L coupling\n    - gp: U(1)_Y coupling\n    - T3: third component of weak isospin for the fermion state\n    - Y: hypercharge of the fermion state\n    - tol: numerical tolerance for equality\n\n    Returns:\n    - True if |kappa_A - e*Q|  tol, False otherwise.\n    \"\"\"\n    # Handle the degenerate case g=gp=0 to avoid division by zero.\n    denom = np.sqrt(g*g + gp*gp)\n    if denom == 0.0:\n        # No electroweak interactions; both sides are zero by construction.\n        sW = 0.0\n        cW = 0.0\n    else:\n        sW = gp / denom\n        cW = g / denom\n\n    # Electric charge Q = T3 + Y/2\n    Q = T3 + 0.5 * Y\n\n    # Photon coupling coefficient extracted from the covariant derivative\n    kappa_A = g * T3 * sW + gp * (0.5 * Y) * cW\n\n    # Elementary electric coupling e. Analytically e = g*sW = gp*cW; use average for numerical symmetry.\n    e_from_g = g * sW\n    e_from_gp = gp * cW\n    e = 0.5 * (e_from_g + e_from_gp)\n\n    # Compare with tolerance\n    return abs(kappa_A - e * Q)  tol\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each tuple is (g, g', T3, Y).\n    test_cases = [\n        (0.65, 0.36, -0.5, -1.0),     # Case 1: left-handed electron component\n        (0.65, 0.36, +0.5, -1.0),     # Case 2: left-handed neutrino component\n        (0.65, 0.36, 0.0, -2.0),      # Case 3: right-handed electron\n        (0.65, 0.36, +0.5, +1.0/3.0), # Case 4: left-handed up quark\n        (0.65, 0.36, -0.5, +1.0/3.0), # Case 5: left-handed down quark\n        (0.65, 0.36, 0.0, +4.0/3.0),  # Case 6: right-handed up quark\n        (0.65, 0.36, 0.0, -2.0/3.0),  # Case 7: right-handed down quark\n        (0.65, 0.0,  0.0, -2.0),      # Case 8: boundary g'=0\n        (0.0,  0.36, +0.5, +1.0/3.0), # Case 9: boundary g=0\n        (1.0,  1.0,  -0.5, -1.0),     # Case 10: equal couplings, left-handed electron component\n        (1.0,  1.0,  0.0,  -2.0/3.0), # Case 11: equal couplings, right-handed down quark\n    ]\n\n    results = []\n    for g, gp, T3, Y in test_cases:\n        result = photon_coupling_matches(g, gp, T3, Y, tol=1e-12)\n        results.append(result)\n\n    # Final print statement in the exact required format: no spaces.\n    print(f\"[{','.join(map(lambda x: str(x).lower(), results))}]\")\n\nsolve()\n```", "id": "3537662"}, {"introduction": "Our final practice synthesizes these concepts to build a comprehensive model of mass generation in the full three-generation Standard Model. The same Higgs vacuum expectation value that gives mass to the $W$ and $Z$ bosons also endows fermions with mass through their Yukawa couplings. This exercise guides you through automating the derivation of the mass matrices for both gauge bosons and fermions, and then performing the necessary diagonalizations to extract the physical CKM and PMNS flavor mixing matrices, which are essential for describing phenomena like quark mixing and neutrino oscillations [@problem_id:3537729].", "problem": "Design and implement a program that, starting from the symmetry structure and interaction content of the Standard Model of particle physics, automates the extraction of mass matrices and physical mixing matrices after electroweak symmetry breaking. The objective is to computationally realize the following chain of reasoning:\n1. Use the gauge symmetry structure of the Standard Model with gauge group $\\mathrm{SU}(2)_L \\times \\mathrm{U}(1)_Y$ and the presence of a complex scalar Higgs doublet to determine how gauge bosons acquire masses after spontaneous symmetry breaking.\n2. Use the general complex Yukawa sector of the Standard Model with three generations to determine how fermions acquire masses after the Higgs field develops a vacuum expectation value.\n3. For general complex Yukawa coupling matrices, perform the appropriate biunitary diagonalizations to obtain fermion mass eigenvalues and the physical flavor mixing matrices in the quark and lepton sectors: the Cabibbo–Kobayashi–Maskawa (CKM) matrix and the Pontecorvo–Maki–Nakagawa–Sakata (PMNS) matrix.\n\nYour program must implement the following, using only linear algebra operations and definitions grounded in the Lagrangian:\n- Starting from the gauge-invariant kinetic term of the Higgs doublet and the covariant derivative, derive the gauge boson mass terms after the Higgs doublet acquires a vacuum expectation value, and compute the massive eigenstates and their masses. You must compute the mass of the charged weak boson $W^\\pm$ and the neutral weak boson $Z$, and verify the tree-level electroweak relation that follows from the underlying symmetry breaking pattern.\n- Starting from the general Yukawa sector with three generations for up-type quarks, down-type quarks, charged leptons, and neutrinos (treated here as Dirac fermions), derive the fermion mass matrices after electroweak symmetry breaking, and perform biunitary diagonalization for each sector to obtain mass eigenvalues and left-handed unitary transformations. Use these left-handed transformations to construct the CKM and PMNS matrices.\n- Quantitatively test unitarity of the CKM and PMNS matrices, and compute a rephasing-invariant measure of $\\mathcal{CP}$ violation (the Jarlskog invariant) for each.\n\nPhysical and mathematical constraints you must respect for this task:\n- Use a Higgs vacuum expectation value $v$ in $\\mathrm{GeV}$, gauge couplings $g$ and $g'$ as dimensionless parameters, and Yukawa matrices as dimensionless $3 \\times 3$ complex matrices. The resulting gauge boson masses must be expressed in $\\mathrm{GeV}$.\n- The Higgs field is a complex $\\mathrm{SU}(2)_L$ doublet with weak hypercharge $Y = 1$. The covariant derivative acting on the Higgs doublet is $D_\\mu = \\partial_\\mu - i g T^a W_\\mu^a - i g' (Y/2) B_\\mu$, where $T^a$ are the $\\mathrm{SU}(2)$ generators in the fundamental representation and $B_\\mu$ is the $\\mathrm{U}(1)_Y$ gauge boson.\n- The Yukawa sector contains the most general complex $3 \\times 3$ coupling matrices that are consistent with gauge invariance.\n- Perform all diagonalizations numerically. The left-handed unitary matrices needed for flavor mixing should be taken from a biunitary diagonalization of each Yukawa matrix.\n\nDefinitions required for algorithm design:\n- Let $Y_u$, $Y_d$, $Y_e$, and $Y_\\nu$ denote the $3 \\times 3$ complex Yukawa matrices, and let $v$ denote the Higgs vacuum expectation value. After electroweak symmetry breaking, the fermion mass matrices are proportional to the Yukawa matrices, and a biunitary diagonalization of each Yukawa matrix yields the left-handed unitary matrices that define observable flavor mixing. The CKM matrix is defined as $V_\\mathrm{CKM} = U_{u,L}^\\dagger U_{d,L}$ and the PMNS matrix as $U_\\mathrm{PMNS} = U_{e,L}^\\dagger U_{\\nu,L}$, where $U_{f,L}$ denotes the left-handed unitary factor from the biunitary diagonalization of the Yukawa matrix for fermion type $f$.\n- The Jarlskog invariant can be computed from any set of indices as the imaginary part of a quartet of matrix elements of the mixing matrix, for example $J = \\mathrm{Im}\\!\\left(V_{11} V_{22} V_{12}^\\ast V_{21}^\\ast\\right)$ for the quark sector, and analogously for the lepton sector. This quantity is invariant under rephasing of fermion fields.\n- Define the weak mixing angle by $\\cos\\theta_W = g / \\sqrt{g^2 + g'^2}$. The tree-level electroweak relation implied by the symmetry breaking pattern is encoded by the ratio $\\rho \\equiv m_W / \\left(m_Z \\cos\\theta_W\\right)$.\n\nNumerical and output requirements:\n- For each test case below, compute:\n  1. The masses $m_W$ and $m_Z$ in $\\mathrm{GeV}$, rounded to three decimals.\n  2. A boolean indicating whether the tree-level relation $\\rho = 1$ holds within an absolute tolerance of $10^{-12}$.\n  3. A boolean indicating whether $V_\\mathrm{CKM}$ is unitary within tolerance $10^{-12}$, quantified by the Frobenius norm $\\left\\|V^\\dagger V - \\mathbb{1}\\right\\|_F$.\n  4. A boolean indicating whether $U_\\mathrm{PMNS}$ is unitary within tolerance $10^{-12}$.\n  5. The Jarlskog invariant for the CKM matrix and the PMNS matrix, each rounded to ten decimals.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each entry corresponds to one test case and is itself a list in the following order: $[m_W, m_Z, \\text{rho\\_ok}, \\text{ckm\\_unitary}, \\text{pmns\\_unitary}, J_\\mathrm{CKM}, J_\\mathrm{PMNS}]$.\n- All angles, if any are used internally, must be in radians. All reported masses must be in $\\mathrm{GeV}$.\n\nTest suite:\nProvide results for the following three test cases. Each test case is a tuple $(v, g, g', Y_u, Y_d, Y_e, Y_\\nu)$.\n\n- Test case A (general complex Yukawas, typical electroweak-scale parameters):\n  - $v = 246.0\\ \\mathrm{GeV}$, $g = 0.65$, $g' = 0.36$.\n  - $Y_u = \\begin{pmatrix}\n  1.20\\times 10^{-5}  3.10\\times 10^{-3}(1+0.5 i)  -1.50\\times 10^{-2} i \\\\\n  2.50\\times 10^{-5}(1-0.3 i)  7.50\\times 10^{-3}  1.20\\times 10^{-2}(1+0.2 i) \\\\\n  1.10\\times 10^{-4}  -2.20\\times 10^{-2}(1-0.4 i)  9.50\\times 10^{-1}\n  \\end{pmatrix}$.\n  - $Y_d = \\begin{pmatrix}\n  1.00\\times 10^{-5}  2.00\\times 10^{-4}(1-0.2 i)  -3.00\\times 10^{-4} i \\\\\n  4.00\\times 10^{-5}(1+0.1 i)  6.00\\times 10^{-4}  3.50\\times 10^{-3}(1-0.1 i) \\\\\n  2.00\\times 10^{-4}  -5.00\\times 10^{-3}(1+0.3 i)  2.50\\times 10^{-2}\n  \\end{pmatrix}$.\n  - $Y_e = \\begin{pmatrix}\n  3.00\\times 10^{-6}(1+0.1 i)  1.00\\times 10^{-5}  -2.00\\times 10^{-5} i \\\\\n  2.00\\times 10^{-6}(1-0.2 i)  6.00\\times 10^{-4}  1.00\\times 10^{-3}(1+0.3 i) \\\\\n  1.00\\times 10^{-5}  -2.00\\times 10^{-3}(1-0.1 i)  1.02\\times 10^{-2}\n  \\end{pmatrix}$.\n  - $Y_\\nu = \\begin{pmatrix}\n  1.00\\times 10^{-8}  2.00\\times 10^{-8}(1+0.4 i)  -1.00\\times 10^{-8} i \\\\\n  3.00\\times 10^{-8}(1-0.5 i)  5.00\\times 10^{-8}  2.00\\times 10^{-7}(1+0.1 i) \\\\\n  1.00\\times 10^{-7}  -4.00\\times 10^{-7}(1-0.2 i)  1.00\\times 10^{-6}\n  \\end{pmatrix}$.\n\n- Test case B (boundary case with vanishing hypercharge coupling and diagonal real Yukawas):\n  - $v = 246.0\\ \\mathrm{GeV}$, $g = 0.70$, $g' = 0.0$.\n  - $Y_u = \\mathrm{diag}(1.30\\times 10^{-5}, 6.30\\times 10^{-3}, 9.90\\times 10^{-1})$.\n  - $Y_d = \\mathrm{diag}(2.50\\times 10^{-5}, 5.00\\times 10^{-4}, 2.00\\times 10^{-2})$.\n  - $Y_e = \\mathrm{diag}(2.80\\times 10^{-6}, 5.90\\times 10^{-4}, 1.00\\times 10^{-2})$.\n  - $Y_\\nu = \\mathrm{diag}(1.00\\times 10^{-8}, 2.00\\times 10^{-8}, 3.00\\times 10^{-8})$.\n\n- Test case C (numerical stability with near-degeneracies and small complex off-diagonals):\n  - $v = 100.0\\ \\mathrm{GeV}$, $g = 0.50$, $g' = 0.50$.\n  - $Y_u = \\begin{pmatrix}\n  1.000000\\times 10^{-1}  1.00\\times 10^{-5}(1+0.2 i)  -2.00\\times 10^{-5} i \\\\\n  1.00\\times 10^{-5}(1-0.3 i)  1.000002\\times 10^{-1}  3.00\\times 10^{-5}(1+0.1 i) \\\\\n  2.00\\times 10^{-5}  -1.00\\times 10^{-5}(1-0.4 i)  5.00\\times 10^{-1}\n  \\end{pmatrix}$.\n  - $Y_d = \\begin{pmatrix}\n  2.00\\times 10^{-2}  5.00\\times 10^{-6}(1-0.2 i)  0 \\\\\n  5.00\\times 10^{-6}(1+0.3 i)  2.000010\\times 10^{-2}  1.00\\times 10^{-5}(1-0.1 i) \\\\\n  0  2.00\\times 10^{-5}(1+0.2 i)  1.00\\times 10^{-1}\n  \\end{pmatrix}$.\n  - $Y_e = \\mathrm{diag}(3.00\\times 10^{-4}, 6.00\\times 10^{-3}, 1.00\\times 10^{-2})$.\n  - $Y_\\nu = \\begin{pmatrix}\n  1.00\\times 10^{-5}  2.00\\times 10^{-5}(1+0.5 i)  -3.00\\times 10^{-6} i \\\\\n  2.00\\times 10^{-5}(1-0.1 i)  3.00\\times 10^{-5}  1.00\\times 10^{-5}(1+0.2 i) \\\\\n  -1.00\\times 10^{-5} i  2.00\\times 10^{-5}(1-0.3 i)  4.00\\times 10^{-5}\n  \\end{pmatrix}$.\n\nFinal output format:\n- Your program must output a single line containing a list of three entries (one per test case). Each entry must be a list in the exact order:\n  - $m_W$ in $\\mathrm{GeV}$ rounded to three decimals,\n  - $m_Z$ in $\\mathrm{GeV}$ rounded to three decimals,\n  - $\\text{rho\\_ok}$ as a boolean,\n  - $\\text{ckm\\_unitary}$ as a boolean,\n  - $\\text{pmns\\_unitary}$ as a boolean,\n  - $J_\\mathrm{CKM}$ rounded to ten decimals,\n  - $J_\\mathrm{PMNS}$ rounded to ten decimals.\nFor example, the final printed line should resemble:\n[[mW_A,mZ_A,true,true,true,Jckm_A,Jpmns_A],[mW_B,mZ_B,true,true,true,Jckm_B,Jpmns_B],[mW_C,mZ_C,true,true,true,Jckm_C,Jpmns_C]]", "solution": "The problem requires the design and implementation of an algorithm to compute gauge boson masses, fermion mixing matrices (CKM and PMNS), and associated physical quantities starting from the fundamental parameters of the Standard Model Lagrangian. The process follows the consequences of electroweak symmetry breaking.\n\n**1. Gauge Boson Mass Generation**\n\nThe masses of the gauge bosons arise from the kinetic term of the Higgs doublet, $\\mathcal{L}_{\\text{Higgs, kin}} = (D_\\mu \\Phi)^\\dagger (D^\\mu \\Phi)$, when the Higgs field $\\Phi$ acquires a non-zero vacuum expectation value (VEV). The Higgs field is an $\\mathrm{SU}(2)_L$ doublet with weak hypercharge $Y = 1$. Its covariant derivative is given by:\n$$\nD_\\mu = \\partial_\\mu - i g T^a W_\\mu^a - i g' (Y/2) B_\\mu\n$$\nwhere $g$ and $g'$ are the gauge couplings for $\\mathrm{SU}(2)_L$ and $\\mathrm{U}(1)_Y$ respectively, $W_\\mu^a$ (with $a=1,2,3$) are the $\\mathrm{SU}(2)_L$ gauge fields, $B_\\mu$ is the $\\mathrm{U}(1)_Y$ gauge field, and $T^a = \\sigma^a/2$ are the $\\mathrm{SU}(2)$ generators (with $\\sigma^a$ being the Pauli matrices).\n\nAfter spontaneous symmetry breaking, the Higgs field acquires a VEV, which can be written in the unitary gauge as:\n$$\n\\langle \\Phi \\rangle = \\frac{1}{\\sqrt{2}} \\begin{pmatrix} 0 \\\\ v \\end{pmatrix}\n$$\nwhere $v$ is the Higgs VEV, given as a parameter in units of $\\mathrm{GeV}$. Substituting this into the Higgs kinetic term, the derivative part $\\partial_\\mu \\langle \\Phi \\rangle$ vanishes since the VEV is constant. The term becomes:\n$$\n\\mathcal{L}_{\\text{mass}} = \\left| \\left( - i g \\frac{\\sigma^a}{2} W_\\mu^a - i g' \\frac{1}{2} B_\\mu \\right) \\frac{1}{\\sqrt{2}} \\begin{pmatrix} 0 \\\\ v \\end{pmatrix} \\right|^2\n$$\nEvaluating the matrix-vector product gives:\n$$\n\\left( g \\frac{\\sigma^a}{2} W_\\mu^a + g' \\frac{1}{2} B_\\mu \\right) \\begin{pmatrix} 0 \\\\ v \\end{pmatrix} = \\frac{v}{2} \\begin{pmatrix} g(W_\\mu^1 - iW_\\mu^2) \\\\ -g W_\\mu^3 + g' B_\\mu \\end{pmatrix}\n$$\nDefining the charged weak boson fields as $W_\\mu^\\pm = \\frac{1}{\\sqrt{2}}(W_\\mu^1 \\mp iW_\\mu^2)$, the expression simplifies to:\n$$\n\\frac{v}{2} \\begin{pmatrix} g \\sqrt{2} W_\\mu^+ \\\\ -g W_\\mu^3 + g' B_\\mu \\end{pmatrix}\n$$\nSubstituting this back into the Lagrangian term and taking the squared norm gives:\n$$\n\\mathcal{L}_{\\text{mass}} = \\frac{1}{2} \\frac{v^2}{4} \\left( 2g^2 W_\\mu^+ W^{\\mu-} + (-g W_\\mu^3 + g' B_\\mu)^2 \\right) = \\frac{g^2v^2}{4} W_\\mu^+ W^{\\mu-} + \\frac{v^2}{8} (g W_\\mu^3 - g' B_\\mu)^2\n$$\nFrom this expression, we identify the mass terms. The mass term for a complex vector field $W^\\pm$ is $m_W^2 W_\\mu^+ W^{\\mu-}$, which implies the squared mass of the $W$ boson is $m_W^2 = \\frac{g^2v^2}{4}$, so the mass is:\n$$\nm_W = \\frac{g v}{2}\n$$\nThe neutral gauge bosons $W_\\mu^3$ and $B_\\mu$ mix. Their mass term can be written in matrix form as $\\frac{1}{2} \\begin{pmatrix} W_\\mu^3  B_\\mu \\end{pmatrix} M^2 \\begin{pmatrix} W^{\\mu 3} \\\\ B^\\mu \\end{pmatrix}$, where the squared-mass matrix is:\n$$\nM^2 = \\frac{v^2}{4} \\begin{pmatrix} g^2  -gg' \\\\ -gg'  g'^2 \\end{pmatrix}\n$$\nThe eigenvalues of this matrix are the squared masses of the physical neutral bosons. The characteristic equation $\\det(M^2 - \\lambda \\mathbb{1}) = 0$ yields eigenvalues $\\lambda_1 = 0$ and $\\lambda_2 = \\frac{v^2}{4}(g^2+g'^2)$. The massless eigenstate is the photon ($A_\\mu$), and the massive one is the $Z$ boson, with mass:\n$$\nm_Z = \\frac{v \\sqrt{g^2+g'^2}}{2}\n$$\nThe weak mixing angle $\\theta_W$ is defined by $\\cos\\theta_W = g/\\sqrt{g^2+g'^2}$. The $\\rho$ parameter, $\\rho = m_W/(m_Z \\cos\\theta_W)$, is a key prediction. Substituting our results:\n$$\n\\rho = \\frac{g v/2}{(v\\sqrt{g^2+g'^2}/2) \\cdot (g/\\sqrt{g^2+g'^2})} = \\frac{g}{g} = 1\n$$\nThis relation $\\rho = 1$ is a direct consequence of the Higgs mechanism with a single scalar doublet and must hold at tree level.\n\n**2. Fermion Mass Generation and Mixing Matrix Derivation**\n\nFermion masses originate from the Yukawa sector of the Lagrangian. For three generations, the Yukawa couplings are described by general $3 \\times 3$ complex matrices $Y_f$ for each fermion type $f \\in \\{u, d, e, \\nu\\}$. The Yukawa Lagrangian contains terms like $- Y_d^{ij} \\bar{Q}_L^i \\Phi d_R^j + \\text{h.c.}$, where $Q_L$ is a left-handed quark doublet. When $\\Phi$ gets its VEV $\\langle\\Phi\\rangle = (0, v/\\sqrt{2})^T$, the neutral component couples to down-type quarks, generating a mass matrix $M_d = \\frac{v}{\\sqrt{2}} Y_d$. Similar mechanisms with $\\Phi$ or its conjugate $\\tilde{\\Phi}$ give mass matrices for all fermion types:\n$$\nM_f = \\frac{v}{\\sqrt{2}} Y_f\n$$\nThese mass matrices are, in general, not Hermitian. To find the physical mass eigenstates (which have definite masses), we must diagonalize $M_f$ using a biunitary transformation, equivalent to a Singular Value Decomposition (SVD):\n$$\nM_f = U_{f,L} \\Sigma_f U_{f,R}^\\dagger\n$$\nHere, $U_{f,L}$ and $U_{f,R}$ are unitary matrices that rotate the left- and right-handed flavor-eigenstate fields into mass-eigenstate fields, respectively. $\\Sigma_f$ is a diagonal matrix of real, non-negative mass eigenvalues. The unitary matrices $U_{f,L}$ are obtained directly from the SVD of the Yukawa matrices $Y_f$.\n\nThe weak charged-current interaction couples left-handed flavor eigenstates (e.g., $\\bar{u}'_L \\gamma^\\mu d'_L$). Expressing these in the mass basis ($\\psi'_L = U_{\\psi,L} \\psi_L$) reveals a mixing matrix in the interaction term:\n$$\n\\bar{u}'_L \\gamma^\\mu d'_L = (\\bar{u}_L U_{u,L}^\\dagger) \\gamma^\\mu (U_{d,L} d_L) = \\bar{u}_L \\gamma^\\mu (U_{u,L}^\\dagger U_{d,L}) d_L\n$$\nThe Cabibbo-Kobayashi-Maskawa (CKM) matrix is therefore $V_{\\text{CKM}} = U_{u,L}^\\dagger U_{d,L}$.\nSimilarly, in the lepton sector, the problem defines the Pontecorvo-Maki-Nakagawa-Sakata (PMNS) matrix as $U_{\\text{PMNS}} = U_{e,L}^\\dagger U_{\\nu,L}$.\n\n**3. Unitarity and $\\mathcal{CP}$ Violation**\n\nThe CKM and PMNS matrices, being products of unitary matrices, must themselves be unitary ($V^\\dagger V = \\mathbb{1}$). This is a fundamental consistency check. We quantify this by computing the Frobenius norm of the deviation from identity, $\\left\\|V^\\dagger V - \\mathbb{1}\\right\\|_F$, and checking if it is close to zero within a specified tolerance.\n\nIf the mixing matrix contains a complex phase that cannot be absorbed by rephasing the fermion fields, it leads to $\\mathcal{CP}$ violation. A rephasing-invariant measure of this is the Jarlskog invariant, $J$. For a $3 \\times 3$ unitary matrix $V$, it can be computed as:\n$$\nJ = \\mathrm{Im}\\!\\left(V_{11} V_{22} V_{12}^\\ast V_{21}^\\ast\\right)\n$$\nA non-zero value of $J$ indicates the presence of $\\mathcal{CP}$ violation in the corresponding sector. For the provided test cases with diagonal Yukawa matrices, the left-handed unitary matrices are identities, leading to an identity mixing matrix and a Jarlskog invariant of $0$.\n\nThe algorithm implemented will first compute $m_W$ and $m_Z$ from $v, g, g'$. Then, for each fermion sector, it will perform an SVD on the Yukawa matrix $Y_f$ to obtain $U_{f,L}$. These are combined to construct $V_{\\text{CKM}}$ and $U_{\\text{PMNS}}$. Finally, the unitarity and Jarlskog invariants are computed for these mixing matrices.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes gauge boson masses, fermion mixing matrices (CKM, PMNS),\n    and related physical quantities from Standard Model parameters.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    test_cases_data = [\n        # Test Case A\n        {\n            \"v\": 246.0, \"g\": 0.65, \"g_prime\": 0.36,\n            \"Yu\": np.array([\n                [1.20e-5, 3.10e-3*(1+0.5j), -1.50e-2j],\n                [2.50e-5*(1-0.3j), 7.50e-3, 1.20e-2*(1+0.2j)],\n                [1.10e-4, -2.20e-2*(1-0.4j), 9.50e-1]\n            ], dtype=complex),\n            \"Yd\": np.array([\n                [1.00e-5, 2.00e-4*(1-0.2j), -3.00e-4j],\n                [4.00e-5*(1+0.1j), 6.00e-4, 3.50e-3*(1-0.1j)],\n                [2.00e-4, -5.00e-3*(1+0.3j), 2.50e-2]\n            ], dtype=complex),\n            \"Ye\": np.array([\n                [3.00e-6*(1+0.1j), 1.00e-5, -2.00e-5j],\n                [2.00e-6*(1-0.2j), 6.00e-4, 1.00e-3*(1+0.3j)],\n                [1.00e-5, -2.00e-3*(1-0.1j), 1.02e-2]\n            ], dtype=complex),\n            \"Ynu\": np.array([\n                [1.00e-8, 2.00e-8*(1+0.4j), -1.00e-8j],\n                [3.00e-8*(1-0.5j), 5.00e-8, 2.00e-7*(1+0.1j)],\n                [1.00e-7, -4.00e-7*(1-0.2j), 1.00e-6]\n            ], dtype=complex)\n        },\n        # Test Case B\n        {\n            \"v\": 246.0, \"g\": 0.70, \"g_prime\": 0.0,\n            \"Yu\": np.diag([1.30e-5, 6.30e-3, 9.90e-1]).astype(complex),\n            \"Yd\": np.diag([2.50e-5, 5.00e-4, 2.00e-2]).astype(complex),\n            \"Ye\": np.diag([2.80e-6, 5.90e-4, 1.00e-2]).astype(complex),\n            \"Ynu\": np.diag([1.00e-8, 2.00e-8, 3.00e-8]).astype(complex)\n        },\n        # Test Case C\n        {\n            \"v\": 100.0, \"g\": 0.50, \"g_prime\": 0.50,\n            \"Yu\": np.array([\n                [1.000000e-1, 1.00e-5*(1+0.2j), -2.00e-5j],\n                [1.00e-5*(1-0.3j), 1.000002e-1, 3.00e-5*(1+0.1j)],\n                [2.00e-5, -1.00e-5*(1-0.4j), 5.00e-1]\n            ], dtype=complex),\n            \"Yd\": np.array([\n                [2.00e-2, 5.00e-6*(1-0.2j), 0],\n                [5.00e-6*(1+0.3j), 2.000010e-2, 1.00e-5*(1-0.1j)],\n                [0, 2.00e-5*(1+0.2j), 1.00e-1]\n            ], dtype=complex),\n            \"Ye\": np.diag([3.00e-4, 6.00e-3, 1.00e-2]).astype(complex),\n            \"Ynu\": np.array([\n                [1.00e-5, 2.00e-5*(1+0.5j), -3.00e-6j],\n                [2.00e-5*(1-0.1j), 3.00e-5, 1.00e-5*(1+0.2j)],\n                [-1.00e-5j, 2.00e-5*(1-0.3j), 4.00e-5]\n            ], dtype=complex)\n        }\n    ]\n\n    results = []\n    \n    for case in test_cases_data:\n        v = case[\"v\"]\n        g = case[\"g\"]\n        gp = case[\"g_prime\"]\n        Yu = case[\"Yu\"]\n        Yd = case[\"Yd\"]\n        Ye = case[\"Ye\"]\n        Ynu = case[\"Ynu\"]\n        \n        # 1. Gauge boson masses\n        m_W = g * v / 2.0\n        m_Z = np.sqrt(g**2 + gp**2) * v / 2.0\n\n        # 2. Rho parameter check\n        denominator_g_sq_gp_sq = g**2 + gp**2\n        if denominator_g_sq_gp_sq > 1e-15:\n            cos_theta_W = g / np.sqrt(denominator_g_sq_gp_sq)\n            if abs(m_Z * cos_theta_W) > 1e-15:\n                rho = m_W / (m_Z * cos_theta_W)\n            else: # Caters for g=0, where m_W=0 and cos_theta_W=0\n                rho = 1.0 # Relation holds by algebraic inspection\n        else: # g=g'=0\n            rho = 1.0 # m_W=m_Z=0, relation holds trivially\n\n        rho_ok = np.abs(rho - 1.0)  1e-12\n\n        # 3. SVD of Yukawa matrices to get left-handed unitary matrices\n        # The U matrix from numpy.linalg.svd is U_L\n        UuL, _, _ = np.linalg.svd(Yu)\n        UdL, _, _ = np.linalg.svd(Yd)\n        UeL, _, _ = np.linalg.svd(Ye)\n        UnuL, _, _ = np.linalg.svd(Ynu)\n        \n        # 4. Construct CKM and PMNS matrices\n        V_CKM = UuL.conj().T @ UdL\n        U_PMNS = UeL.conj().T @ UnuL\n        \n        # 5. Unitarity check using Frobenius norm\n        identity = np.identity(3, dtype=complex)\n        ckm_unitarity_dev = np.linalg.norm(V_CKM.conj().T @ V_CKM - identity, 'fro')\n        pmns_unitarity_dev = np.linalg.norm(U_PMNS.conj().T @ U_PMNS - identity, 'fro')\n        \n        ckm_unitary = ckm_unitarity_dev  1e-12\n        pmns_unitary = pmns_unitarity_dev  1e-12\n\n        # 6. Jarlskog invariant calculation\n        J_CKM = np.imag(V_CKM[0,0] * V_CKM[1,1] * V_CKM[0,1].conj() * V_CKM[1,0].conj())\n        J_PMNS = np.imag(U_PMNS[0,0] * U_PMNS[1,1] * U_PMNS[0,1].conj() * U_PMNS[1,0].conj())\n        \n        # 7. Collect and format results for the current case\n        case_result = [\n            round(m_W, 3),\n            round(m_Z, 3),\n            rho_ok,\n            ckm_unitary,\n            pmns_unitary,\n            round(J_CKM, 10),\n            round(J_PMNS, 10)\n        ]\n        results.append(case_result)\n\n    # Final print statement in the exact required format.\n    formatted_results = []\n    for res in results:\n        s = f\"[{res[0]},{res[1]},{str(res[2]).lower()},{str(res[3]).lower()},{str(res[4]).lower()},{res[5]},{res[6]}]\"\n        formatted_results.append(s)\n    \n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "3537729"}]}