{"hands_on_practices": [{"introduction": "Multi-step methods like the Adams-Bashforth family are fundamental tools in computational astrophysics, but their coefficients can seem arbitrary. This exercise demystifies these methods by guiding you through their derivation from first principles. By integrating a Lagrange interpolating polynomial that passes through previous solution points, you will see precisely how the update formula for the fourth-order Adams-Bashforth (AB4) method is constructed [@problem_id:3523827]. This practice reinforces the connection between polynomial approximation and numerical integration, which lies at the heart of many ODE solvers.", "problem": "In computational astrophysics, time-domain integration of nonrelativistic test-particle trajectories in a smooth galactic potential is often performed with multi-step integrators when the force evaluation is expensive but the solution is sufficiently smooth. Consider the ordinary differential equation (ODE) $y'(t) = f(t,y(t))$ with a constant time step $h > 0$, and a linear multistep explicit Adams-Bashforth (AB) method of step number $4$, which computes $y_{n+1}$ from past right-hand side samples $f_{n-j} = f(t_{n-j}, y_{n-j})$ for $j \\in \\{0,1,2,3\\}$.\n\nStarting from the fundamental integral representation $y(t_{n+1}) = y(t_n) + \\int_{t_n}^{t_{n+1}} f(\\tau, y(\\tau)) \\, d\\tau$, approximate $f(\\tau, y(\\tau))$ over the interval $[t_n, t_{n+1}]$ by the unique degree-$3$ Lagrange interpolating polynomial through the four equally spaced nodes $\\{t_n, t_{n-1}, t_{n-2}, t_{n-3}\\}$ and the corresponding data $\\{f_n, f_{n-1}, f_{n-2}, f_{n-3}\\}$. Use the affine change of variables $s = (\\tau - t_n)/h$ so that $\\tau \\in [t_n, t_{n+1}]$ maps to $s \\in [0,1]$, and the nodes map to $\\{0, -1, -2, -3\\}$.\n\nBy integrating the Lagrange basis polynomials $L_j(s)$ for $j \\in \\{0,1,2,3\\}$ over $s \\in [0,1]$, derive the explicit Adams-Bashforth $4$-step update\n$$\ny_{n+1} = y_n + h \\sum_{j=0}^{3} b_j \\, f_{n-j},\n$$\nand compute the coefficients $b_0$, $b_1$, $b_2$, and $b_3$. Verify, by direct construction and integration of the Lagrange polynomials, that these coefficients match the classical values produced by Lagrange integration.\n\nExpress your final coefficients as exact rational numbers, ordered as $\\{b_0, b_1, b_2, b_3\\}$. No rounding is required, and no physical units are to be reported in the final answer.", "solution": "The problem requires the derivation of the coefficients for the 4-step explicit Adams-Bashforth (AB4) method for solving an ordinary differential equation (ODE) of the form $y'(t) = f(t, y(t))$.\n\nThe derivation begins with the fundamental theorem of calculus, which provides an exact expression for the update from $y(t_n)$ to $y(t_{n+1})$ over a time step $h = t_{n+1} - t_n$:\n$$y(t_{n+1}) = y(t_n) + \\int_{t_n}^{t_{n+1}} f(\\tau, y(\\tau)) \\, d\\tau$$\nThe Adams-Bashforth method approximates the integral by replacing the function $f(\\tau, y(\\tau))$ with an interpolating polynomial. For the 4-step method, we use a polynomial of degree $3$ that passes through the four most recent data points: $(t_n, f_n)$, $(t_{n-1}, f_{n-1})$, $(t_{n-2}, f_{n-2})$, and $(t_{n-3}, f_{n-3})$, where $f_k = f(t_k, y_k)$. This polynomial, denoted $P_3(\\tau)$, is the unique Lagrange interpolating polynomial for these points.\n\nThe numerical approximation for $y_{n+1}$ is then given by:\n$$y_{n+1} = y_n + \\int_{t_n}^{t_{n+1}} P_3(\\tau) \\, d\\tau$$\nTo facilitate the integration, we introduce the affine change of variables $s = (\\tau - t_n)/h$. This implies $d\\tau = h \\, ds$. The integration interval for $\\tau$, which is $[t_n, t_{n+1}]$, maps to the interval $[0, 1]$ for $s$. The interpolation nodes in the new coordinate system are:\n- $t_n \\rightarrow s = (t_n - t_n)/h = 0$\n- $t_{n-1} = t_n - h \\rightarrow s = ((t_n - h) - t_n)/h = -1$\n- $t_{n-2} = t_n - 2h \\rightarrow s = ((t_n - 2h) - t_n)/h = -2$\n- $t_{n-3} = t_n - 3h \\rightarrow s = ((t_n - 3h) - t_n)/h = -3$\n\nThe Lagrange interpolating polynomial, now a function of $s$, is expressed as a linear combination of the function values $f_{n-j}$ and the corresponding Lagrange basis polynomials $L_j(s)$:\n$$P_3(s) = f_n L_0(s) + f_{n-1} L_1(s) + f_{n-2} L_2(s) + f_{n-3} L_3(s)$$\nHere, $L_j(s)$ are the basis polynomials corresponding to the nodes $\\{s_0, s_1, s_2, s_3\\} = \\{0, -1, -2, -3\\}$. The integral becomes:\n$$\\int_{t_n}^{t_{n+1}} P_3(\\tau) \\, d\\tau = \\int_0^1 P_3(s) \\, h \\, ds = h \\int_0^1 \\left(\\sum_{j=0}^{3} f_{n-j} L_j(s)\\right) \\, ds = h \\sum_{j=0}^{3} f_{n-j} \\left( \\int_0^1 L_j(s) \\, ds \\right)$$\nThe AB4 update rule is given in the form $y_{n+1} = y_n + h \\sum_{j=0}^{3} b_j f_{n-j}$. By comparing these two expressions, we can identify the coefficients $b_j$ as the definite integrals of the Lagrange basis polynomials:\n$$b_j = \\int_0^1 L_j(s) \\, ds$$\nWe now construct and integrate each basis polynomial. The general form of a Lagrange basis polynomial is $L_k(s) = \\prod_{i \\neq k} \\frac{s - s_i}{s_k - s_i}$.\n\n1.  **Coefficient $b_0$ (associated with $f_n$ and node $s_0=0$):**\n    $L_0(s) = \\frac{(s - (-1))(s - (-2))(s - (-3))}{(0 - (-1))(0 - (-2))(0 - (-3))} = \\frac{(s+1)(s+2)(s+3)}{6} = \\frac{1}{6}(s^3 + 6s^2 + 11s + 6)$.\n    $b_0 = \\int_0^1 L_0(s) \\, ds = \\frac{1}{6} \\int_0^1 (s^3 + 6s^2 + 11s + 6) \\, ds = \\frac{1}{6} \\left[ \\frac{s^4}{4} + 2s^3 + \\frac{11s^2}{2} + 6s \\right]_0^1$.\n    $b_0 = \\frac{1}{6} \\left(\\frac{1}{4} + 2 + \\frac{11}{2} + 6 - 0 \\right) = \\frac{1}{6} \\left(\\frac{1}{4} + \\frac{8}{4} + \\frac{22}{4} + \\frac{24}{4}\\right) = \\frac{1}{6}\\left(\\frac{55}{4}\\right) = \\frac{55}{24}$.\n\n2.  **Coefficient $b_1$ (associated with $f_{n-1}$ and node $s_1=-1$):**\n    $L_1(s) = \\frac{(s-0)(s-(-2))(s-(-3))}{(-1-0)(-1-(-2))(-1-(-3))} = \\frac{s(s+2)(s+3)}{(-1)(1)(2)} = -\\frac{1}{2}(s^3 + 5s^2 + 6s)$.\n    $b_1 = \\int_0^1 L_1(s) \\, ds = -\\frac{1}{2} \\int_0^1 (s^3 + 5s^2 + 6s) \\, ds = -\\frac{1}{2} \\left[ \\frac{s^4}{4} + \\frac{5s^3}{3} + 3s^2 \\right]_0^1$.\n    $b_1 = -\\frac{1}{2} \\left(\\frac{1}{4} + \\frac{5}{3} + 3 \\right) = -\\frac{1}{2} \\left(\\frac{3}{12} + \\frac{20}{12} + \\frac{36}{12}\\right) = -\\frac{1}{2}\\left(\\frac{59}{12}\\right) = -\\frac{59}{24}$.\n\n3.  **Coefficient $b_2$ (associated with $f_{n-2}$ and node $s_2=-2$):**\n    $L_2(s) = \\frac{(s-0)(s-(-1))(s-(-3))}{(-2-0)(-2-(-1))(-2-(-3))} = \\frac{s(s+1)(s+3)}{(-2)(-1)(1)} = \\frac{1}{2}(s^3 + 4s^2 + 3s)$.\n    $b_2 = \\int_0^1 L_2(s) \\, ds = \\frac{1}{2} \\int_0^1 (s^3 + 4s^2 + 3s) \\, ds = \\frac{1}{2} \\left[ \\frac{s^4}{4} + \\frac{4s^3}{3} + \\frac{3s^2}{2} \\right]_0^1$.\n    $b_2 = \\frac{1}{2} \\left(\\frac{1}{4} + \\frac{4}{3} + \\frac{3}{2} \\right) = \\frac{1}{2} \\left(\\frac{3}{12} + \\frac{16}{12} + \\frac{18}{12}\\right) = \\frac{1}{2}\\left(\\frac{37}{12}\\right) = \\frac{37}{24}$.\n\n4.  **Coefficient $b_3$ (associated with $f_{n-3}$ and node $s_3=-3$):**\n    $L_3(s) = \\frac{(s-0)(s-(-1))(s-(-2))}{(-3-0)(-3-(-1))(-3-(-2))} = \\frac{s(s+1)(s+2)}{(-3)(-2)(-1)} = -\\frac{1}{6}(s^3 + 3s^2 + 2s)$.\n    $b_3 = \\int_0^1 L_3(s) \\, ds = -\\frac{1}{6} \\int_0^1 (s^3 + 3s^2 + 2s) \\, ds = -\\frac{1}{6} \\left[ \\frac{s^4}{4} + s^3 + s^2 \\right]_0^1$.\n    $b_3 = -\\frac{1}{6} \\left(\\frac{1}{4} + 1 + 1 \\right) = -\\frac{1}{6} \\left(\\frac{1}{4} + \\frac{8}{4}\\right) = -\\frac{1}{6}\\left(\\frac{9}{4}\\right) = -\\frac{9}{24}$.\n\nThe set of coefficients $\\{b_0, b_1, b_2, b_3\\}$ for the 4-step Adams-Bashforth method are thus rigorously derived as exact rational numbers.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{55}{24} & -\\frac{59}{24} & \\frac{37}{24} & -\\frac{9}{24}\n\\end{pmatrix}\n}\n$$", "id": "3523827"}, {"introduction": "While a numerical method may be formally accurate, its practical utility is governed by its stability. This is especially true for explicit methods, which can become unstable if the time step is too large relative to the intrinsic timescales of the problem. This exercise explores this critical concept by analyzing the stability of the AB4 method for the standard test equation $y'=\\lambda y$, a prototype for linear damping phenomena common in stellar astrophysics [@problem_id:3523781]. Determining the stability boundary provides a quantitative understanding of the maximum allowable time step, a crucial skill for designing robust and reliable simulations.", "problem": "An astrophysical mode amplitude $y(t)$ undergoing linear radiative damping in a stratified stellar envelope obeys the scalar Ordinary Differential Equation (ODE) $y'(t)=-\\Lambda\\,y(t)$, where $\\Lambda>0$ is a constant decay rate determined by microphysics. Introducing $\\lambda=-\\Lambda0$ recasts the continuous evolution into the linear test equation $y'(t)=\\lambda\\,y(t)$ with real negative $\\lambda$, a standard base used to assess the absolute stability of linear multistep methods. Consider the four-step explicit Adams-Bashforth method (AB4) applied to this test equation with a fixed step size $h>0$. Using the linear multistep stability framework that analyzes amplification factors $\\,\\xi\\,$ obtained from the characteristic relation associated with $\\,y_n=\\xi^n\\,$, derive the parametric stability boundary for AB4 by eliminating $\\,\\xi\\,$ on the unit circle $|\\xi|=1$ in favor of the dimensionless product $z=h\\,\\lambda$. Then, compute the intersection of this boundary with the negative real axis and report the corresponding value of $h\\,\\lambda$ as an exact algebraic number. Finally, interpret physically what this intersection implies for the maximum allowable magnitude of the time step $h$ in terms of $|\\lambda|$ for stable integration of decaying astrophysical modes. Your final reported value must be the single exact algebraic value of the negative-real-axis intersection $h\\,\\lambda$. No units are required because $h\\,\\lambda$ is dimensionless. No rounding is required.", "solution": "The problem requires an analysis of the absolute stability of the four-step explicit Adams-Bashforth (AB4) method when applied to the linear test equation $y'(t) = \\lambda y(t)$, where $\\lambda  0$ is a real constant. The goal is to find the intersection of the method's stability boundary with the negative real axis in the complex plane of $z = h\\lambda$, where $h$ is the time step.\n\nFirst, we state the formula for the four-step Adams-Bashforth method. For a first-order ODE of the form $y'(t) = f(t, y(t))$, the AB4 method computes the solution at step $n+1$ using information from four previous steps:\n$$y_{n+1} = y_n + \\frac{h}{24} \\left( 55 f_n - 59 f_{n-1} + 37 f_{n-2} - 9 f_{n-3} \\right)$$\nwhere $y_k$ is the numerical approximation of $y(t_k)$ and $f_k = f(t_k, y_k)$.\n\nWe apply this method to the linear test equation $y'(t) = \\lambda y(t)$, for which $f(t, y) = \\lambda y$, and thus $f_k = \\lambda y_k$. Substituting this into the AB4 formula yields a linear difference equation:\n$$y_{n+1} = y_n + \\frac{h \\lambda}{24} \\left( 55 y_n - 59 y_{n-1} + 37 y_{n-2} - 9 y_{n-3} \\right)$$\n\nTo analyze the stability of this difference equation, we seek solutions of the form $y_n = \\xi^n$, where $\\xi$ is the amplification factor. A stable numerical solution requires that $|\\xi| \\le 1$. Substituting $y_k = \\xi^k$ for $k \\in \\{n+1, n, n-1, n-2, n-3\\}$ into the equation gives:\n$$\\xi^{n+1} = \\xi^n + \\frac{h \\lambda}{24} \\left( 55 \\xi^n - 59 \\xi^{n-1} + 37 \\xi^{n-2} - 9 \\xi^{n-3} \\right)$$\nDividing by $\\xi^{n-3}$ (assuming $\\xi \\neq 0$) yields the characteristic equation for $\\xi$:\n$$\\xi^4 = \\xi^3 + \\frac{h \\lambda}{24} \\left( 55 \\xi^3 - 59 \\xi^2 + 37 \\xi - 9 \\right)$$\nLet $z = h\\lambda$, the dimensionless product of the step size and the decay rate parameter. The characteristic equation becomes:\n$$\\xi^4 - \\xi^3 = z \\left( \\frac{55 \\xi^3 - 59 \\xi^2 + 37 \\xi - 9}{24} \\right)$$\nThis equation is of the form $\\rho(\\xi) = z \\sigma(\\xi)$, where $\\rho(\\xi) = \\xi^4 - \\xi^3$ and $\\sigma(\\xi) = \\frac{1}{24}(55 \\xi^3 - 59 \\xi^2 + 37 \\xi - 9)$ are the first and second characteristic polynomials of the method, respectively.\n\nThe boundary of the region of absolute stability is the locus of points $z$ in the complex plane for which the characteristic equation has a root $\\xi$ with modulus $|\\xi|=1$. We can express this boundary parametrically by letting $\\xi = e^{i\\theta}$ for $\\theta \\in [0, 2\\pi)$ and solving for $z$:\n$$z(\\theta) = \\frac{\\rho(e^{i\\theta})}{\\sigma(e^{i\\theta})} = \\frac{24( (e^{i\\theta})^4 - (e^{i\\theta})^3 )}{55(e^{i\\theta})^3 - 59(e^{i\\theta})^2 + 37(e^{i\\theta}) - 9}$$\nThe problem asks for the intersection of this boundary with the negative real axis. This intersection occurs for a value of $\\xi$ on the unit circle that makes $z$ real and negative. The real values on the unit circle are $\\xi = 1$ and $\\xi = -1$.\nFirst, consider $\\xi = 1$:\n$$z = \\frac{24(1^4 - 1^3)}{55(1)^3 - 59(1)^2 + 37(1) - 9} = \\frac{24(0)}{55-59+37-9} = \\frac{0}{24} = 0$$\nThis corresponds to the trivial intersection at the origin, which represents the limit of $h \\to 0$.\n\nNext, consider $\\xi = -1$. This value corresponds to $\\theta = \\pi$ and typically defines the leftmost point of the stability interval on the real axis for explicit methods. We substitute $\\xi = -1$ into the expression for $z$:\n$$z = \\frac{24((-1)^4 - (-1)^3)}{55(-1)^3 - 59(-1)^2 + 37(-1) - 9}$$\nWe compute the numerator and denominator separately.\nNumerator:\n$$24(1 - (-1)) = 24(2) = 48$$\nDenominator:\n$$55(-1) - 59(1) + 37(-1) - 9 = -55 - 59 - 37 - 9 = -160$$\nThus, the value of $z$ at this intersection is:\n$$z = \\frac{48}{-160}$$\nTo simplify this fraction, we find the greatest common divisor of $48$ and $160$. Both are divisible by $16$: $48 = 3 \\times 16$ and $160 = 10 \\times 16$.\n$$z = -\\frac{3 \\times 16}{10 \\times 16} = -\\frac{3}{10}$$\nThis is the value of $h\\lambda$ at the intersection of the AB4 stability boundary with the negative real axis.\n\nFor physical interpretation, the original ODE $y'(t) = -\\Lambda y(t)$ describes a physical quantity that decays exponentially, since $\\Lambda > 0$. The analysis was performed on the test equation $y'(t) = \\lambda y(t)$ with $\\lambda = -\\Lambda  0$. The stability of the numerical method requires that the dimensionless step size $z = h\\lambda$ lies within the region of absolute stability. For this problem, the stability interval on the negative real axis is $[-3/10, 0]$. Therefore, we must have:\n$$h\\lambda \\ge -3/10$$\nSubstituting $\\lambda = -\\Lambda = -|\\lambda|$:\n$$-h|\\lambda| \\ge -3/10$$\nMultiplying by $-1$ and reversing the inequality sign gives the condition on the step size $h$:\n$$h|\\lambda| \\le \\frac{3}{10} \\implies h \\le \\frac{3}{10|\\lambda|} = \\frac{0.3}{|\\lambda|} = \\frac{0.3}{\\Lambda}$$\nThis means that for the AB4 method to stably integrate a decaying mode with rate $\\Lambda$, the time step $h$ must be chosen to be smaller than a critical value determined by the decay rate itself. The calculated value $h\\lambda = -3/10$ defines this stability limit. If the step size is too large (i.e., $h > 0.3/\\Lambda$), the numerical solution will exhibit unphysical, divergent oscillations, a hallmark of numerical instability. The final answer required by the problem is the specific numerical value of this intersection point.", "answer": "$$\\boxed{-\\frac{3}{10}}$$", "id": "3523781"}, {"introduction": "Theoretical analysis provides insight, but practical implementation reveals the true performance of numerical algorithms. This hands-on coding exercise moves from theory to practice by tasking you with implementing and comparing the explicit AB4 method against an implicit Adams-Moulton (AM4) method in a predictor-corrector framework [@problem_id:3523834]. By applying these solvers to a damped harmonic oscillator—a model for processes like stellar pulsation—you will directly observe the superior stability and accuracy of the predictor-corrector scheme, especially for problems with different timescales, and gain an appreciation for the trade-offs that inform the choice of integrator in real-world astrophysical codes.", "problem": "Consider the linear, damped harmonic oscillator from astrophysical fluid dynamics, where a single mode of a stellar envelope experiences strong radiative damping. The governing equation, derived from Newton’s second law with linear drag and Hooke’s law, is the second-order ordinary differential equation (ODE) $$x''(t) + 2\\zeta\\omega\\,x'(t) + \\omega^2 x(t) = 0,$$ where $x(t)$ is the displacement in meters, $\\omega$ is the undamped natural angular frequency in $\\mathrm{s}^{-1}$, and $\\zeta$ is the dimensionless damping ratio. For the overdamped regime, assume $ \\zeta  1 $. Convert this to a first-order system for numerical integration by defining the velocity $v(t) = x'(t)$, so that $$\\frac{d}{dt}\\begin{bmatrix}x(t) \\\\ v(t)\\end{bmatrix} = \\begin{bmatrix} v(t) \\\\ -2\\zeta\\omega\\,v(t) - \\omega^2 x(t)\\end{bmatrix}.$$ Use the initial conditions $x(0) = 1$ (in meters) and $v(0) = 0$ (in meters per second). \n\nImplement two fixed-step, multi-step methods for the initial value problem:\n- the fourth-order Adams–Bashforth method (AB4), and \n- the fourth-order Adams–Moulton method (AM4) applied in a single predictor–corrector pass, using AB4 as the predictor and AM4 as one corrector iteration.\n\nTo start the multi-step methods, use a single-step fourth-order Runge–Kutta method to generate the first $3$ steps required to seed both AB4 and AM4. For the AM4 method, perform exactly one corrector iteration per step. Use a constant time step $h$ (in seconds) and integrate to a fixed final time $T$ (in seconds). For each parameter set, compute the absolute global error in the position $x(T)$ (in meters) by comparing the numerical $x(T)$ with the exact analytical solution for the overdamped case, and then compute the error ratio $$R = \\frac{\\mathrm{err}_{\\mathrm{AB4}}}{\\mathrm{err}_{\\mathrm{AM4}}},$$ which is dimensionless.\n\nThe analytical solution for the overdamped case ($\\zeta  1$) is characterized by the distinct real roots $$r_{1,2} = -\\zeta\\omega \\pm \\omega\\sqrt{\\zeta^2 - 1},$$ leading to the closed-form solution $$x(t) = C_1 e^{r_1 t} + C_2 e^{r_2 t},$$ where the constants $C_1$ and $C_2$ are determined from $x(0)$ and $v(0)$.\n\nYour program must implement both AB4 and AM4 (with a single corrector) on the system above, evaluate the exact solution at $t=T$ for each parameter set, compute the error ratio $R$, and produce the results for the following test suite:\n\n- Test case $1$ (happy path): $\\omega = 25\\,\\mathrm{s}^{-1}$, $\\zeta = 1.1$, $T = 2\\,\\mathrm{s}$, $h = 0.02\\,\\mathrm{s}$.\n- Test case $2$ (near explicit stability boundary): $\\omega = 25\\,\\mathrm{s}^{-1}$, $\\zeta = 1.1$, $T = 2\\,\\mathrm{s}$, $h = 0.05\\,\\mathrm{s}$.\n- Test case $3$ (mildly stiffer mode): $\\omega = 35\\,\\mathrm{s}^{-1}$, $\\zeta = 1.05$, $T = 2\\,\\mathrm{s}$, $h = 0.05\\,\\mathrm{s}$.\n- Test case $4$ (small-step baseline): $\\omega = 25\\,\\mathrm{s}^{-1}$, $\\zeta = 1.1$, $T = 2\\,\\mathrm{s}$, $h = 0.005\\,\\mathrm{s}$.\n\nFor each test case, the output must be the single float $R$ computed as above. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., `[r_1,r_2,r_3,r_4]`). The four outputs are dimensionless numbers (ratios), so no physical units need to be attached to the printed values. Ensure that your implementation is self-contained and uses no external inputs.", "solution": "The user has provided a valid, well-posed, and scientifically grounded problem statement in computational astrophysics. The problem is to solve the second-order linear ODE for a damped harmonic oscillator using two different fourth-order multi-step numerical methods and compare their accuracy against the exact analytical solution.\n\nThe governing equation is:\n$$x''(t) + 2\\zeta\\omega\\,x'(t) + \\omega^2 x(t) = 0$$\nwith initial conditions $x(0) = 1$ and $x'(0) = 0$. The problem specifies the overdamped case, where the damping ratio $\\zeta > 1$.\n\nFirst, we convert the second-order ODE into a system of two first-order ODEs. Let the state vector be $\\mathbf{y}(t) = [x(t), v(t)]^T$, where $v(t) = x'(t)$ is the velocity. The system is then given by:\n$$ \\frac{d\\mathbf{y}}{dt} = \\frac{d}{dt}\\begin{bmatrix}x \\\\ v\\end{bmatrix} = \\begin{bmatrix} v \\\\ -2\\zeta\\omega v - \\omega^2 x \\end{bmatrix} = F(t, \\mathbf{y}) $$\nThe initial condition for the system is $\\mathbf{y}(0) = [1, 0]^T$.\n\nNext, we derive the exact analytical solution for this initial value problem, which serves as the ground truth for error calculation. The characteristic equation of the ODE is $r^2 + 2\\zeta\\omega r + \\omega^2 = 0$. For the overdamped case ($\\zeta > 1$), the roots are distinct and real:\n$$r_{1,2} = -\\zeta\\omega \\pm \\omega\\sqrt{\\zeta^2 - 1}$$\nThe general solution is of the form $x(t) = C_1 e^{r_1 t} + C_2 e^{r_2 t}$. The coefficients $C_1$ and $C_2$ are determined by the initial conditions $x(0) = 1$ and $v(0) = x'(0) = 0$.\nApplying the conditions:\n$$x(0) = C_1 + C_2 = 1$$\n$$v(0) = C_1 r_1 + C_2 r_2 = 0$$\nSolving this linear system for $C_1$ and $C_2$ yields:\n$$C_1 = \\frac{-r_2}{r_1 - r_2} \\quad \\text{and} \\quad C_2 = \\frac{r_1}{r_1 - r_2}$$\nSubstituting the expressions for $r_1$ and $r_2$, we can write the full analytical solution for $x(t)$, which will be used to compute the exact value at the final time $T$.\n\nThe core of the problem is to implement and compare two numerical methods. Since both the Adams-Bashforth (AB4) and Adams-Moulton (AM4) methods are multi-step, they require several historical data points to start. The problem specifies using the fourth-order Runge-Kutta (RK4) method to generate the first three steps (i.e., solutions at $t_1, t_2, t_3$) from the initial condition at $t_0=0$.\n\nThe fourth-order Runge-Kutta (RK4) method for a step from $t_n$ to $t_{n+1}=t_n+h$ is given by:\n$$\\mathbf{y}_{n+1} = \\mathbf{y}_n + \\frac{h}{6}(\\mathbf{k}_1 + 2\\mathbf{k}_2 + 2\\mathbf{k}_3 + \\mathbf{k}_4)$$\nwhere\n$$ \\begin{aligned}\n\\mathbf{k}_1 = F(t_n, \\mathbf{y}_n) \\\\\n\\mathbf{k}_2 = F(t_n + h/2, \\mathbf{y}_n + h/2 \\cdot \\mathbf{k}_1) \\\\\n\\mathbf{k}_3 = F(t_n + h/2, \\mathbf{y}_n + h/2 \\cdot \\mathbf{k}_2) \\\\\n\\mathbf{k}_4 = F(t_n + h, \\mathbf{y}_n + h \\cdot \\mathbf{k}_3)\n\\end{aligned} $$\nThis single-step method is applied three times to find $\\mathbf{y}_1, \\mathbf{y}_2, \\mathbf{y}_3$, providing the necessary history $\\mathbf{y}_0, \\mathbf{y}_1, \\mathbf{y}_2, \\mathbf{y}_3$ and their corresponding derivatives $F_0, F_1, F_2, F_3$.\n\nThe first multi-step method is the explicit fourth-order Adams-Bashforth (AB4) method. The update rule is:\n$$\\mathbf{y}_{n+1} = \\mathbf{y}_n + \\frac{h}{24} (55 F_n - 59 F_{n-1} + 37 F_{n-2} - 9 F_{n-3})$$\nwhere $F_k = F(t_k, \\mathbf{y}_k)$. This formula is used for all subsequent steps $n \\ge 3$.\n\nThe second method is a predictor-corrector scheme using AB4 as the predictor and the implicit fourth-order Adams-Moulton (AM4) method as the corrector. This is a PECE (Predict-Evaluate-Correct-Evaluate) scheme with a single correction pass.\n1.  **Predict (P):** An initial guess for $\\mathbf{y}_{n+1}$ is computed using the explicit AB4 method. Let's call this $\\mathbf{y}^*_{n+1}$.\n    $$\\mathbf{y}^*_{n+1} = \\mathbf{y}_n + \\frac{h}{24} (55 F_n - 59 F_{n-1} + 37 F_{n-2} - 9 F_{n-3})$$\n2.  **Evaluate (E):** The derivative is evaluated at this predicted state.\n    $$F^*_{n+1} = F(t_{n+1}, \\mathbf{y}^*_{n+1})$$\n3.  **Correct (C):** The final value for the step, $\\mathbf{y}_{n+1}$, is computed using the implicit AM4 formula, with the predicted derivative $F^*_{n+1}$ on the right-hand side.\n    $$\\mathbf{y}_{n+1} = \\mathbf{y}_n + \\frac{h}{24} (9 F^*_{n+1} + 19 F_n - 5 F_{n-1} + F_{n-2})$$\nThe derivative for the next step's history, $F_{n+1}$, is then computed using the corrected state: $F_{n+1} = F(t_{n+1}, \\mathbf{y}_{n+1})$.\n\nFor each test case, the procedure is as follows:\n1.  Set the parameters $\\omega, \\zeta, T, h$.\n2.  Solve the IVP from $t=0$ to $t=T$ using the AB4 method to find the numerical solution $x_{\\mathrm{AB4}}(T)$.\n3.  Solve the IVP again from $t=0$ to $t=T$ using the AM4 predictor-corrector method to find $x_{\\mathrm{AM4}}(T)$.\n4.  Calculate the exact solution $x_{\\mathrm{exact}}(T)$ using the derived analytical formula.\n5.  Compute the absolute global error for each method at $t=T$:\n    $$\\mathrm{err}_{\\mathrm{AB4}} = |x_{\\mathrm{AB4}}(T) - x_{\\mathrm{exact}}(T)|$$\n    $$\\mathrm{err}_{\\mathrm{AM4}} = |x_{\\mathrm{AM4}}(T) - x_{\\mathrm{exact}}(T)|$$\n6.  Finally, compute the error ratio $R$:\n    $$R = \\frac{\\mathrm{err}_{\\mathrm{AB4}}}{\\mathrm{err}_{\\mathrm{AM4}}}$$\nThe implementation will perform these steps for all specified parameter sets and report the resulting ratios. The AM4-PC method is generally more accurate and has better stability properties than the purely explicit AB4 method, which is expected to be reflected in the error ratio $R$, especially for larger step sizes approaching the stability limit of the AB4 method.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the damped harmonic oscillator ODE using AB4 and AM4-PC methods,\n    and computes the ratio of their global errors.\n    \"\"\"\n\n    test_cases = [\n        # (omega, zeta, T, h)\n        (25.0, 1.1, 2.0, 0.02),\n        (25.0, 1.1, 2.0, 0.05),\n        (35.0, 1.05, 2.0, 0.05),\n        (25.0, 1.1, 2.0, 0.005),\n    ]\n\n    def analytical_solution(t, omega, zeta):\n        \"\"\"\n        Calculates the exact analytical solution for the overdamped harmonic oscillator.\n        x(0) = 1, v(0) = 0.\n        \"\"\"\n        # Calculate roots of the characteristic equation\n        sqrt_term = np.sqrt(zeta**2 - 1)\n        r1 = -zeta * omega + omega * sqrt_term\n        r2 = -zeta * omega - omega * sqrt_term\n        \n        # Calculate coefficients C1 and C2 from initial conditions\n        # C1 = -r2 / (r1 - r2)\n        # C2 = r1 / (r1 - r2)\n        # x(t) = C1*exp(r1*t) + C2*exp(r2*t)\n        # This can be written as:\n        x_t = (1 / (r1 - r2)) * (-r2 * np.exp(r1 * t) + r1 * np.exp(r2 * t))\n        return x_t\n\n    def ode_f(t, y, omega, zeta):\n        \"\"\"\n        Defines the first-order system for the ODE.\n        y = [x, v]\n        \"\"\"\n        x, v = y\n        dxdt = v\n        dvdt = -2 * zeta * omega * v - omega**2 * x\n        return np.array([dxdt, dvdt], dtype=np.float64)\n\n    def rk4_step(f, t, y, h, **f_kwargs):\n        \"\"\"\n        Performs a single step of the fourth-order Runge-Kutta method.\n        \"\"\"\n        k1 = f(t, y, **f_kwargs)\n        k2 = f(t + 0.5 * h, y + 0.5 * h * k1, **f_kwargs)\n        k3 = f(t + 0.5 * h, y + 0.5 * h * k2, **f_kwargs)\n        k4 = f(t + h, y + h * k3, **f_kwargs)\n        return y + (h / 6.0) * (k1 + 2 * k2 + 2 * k3 + k4)\n\n    def solve_ode_multistep(omega, zeta, T, h, method):\n        \"\"\"\n        Solves the ODE using a specified multi-step method (AB4 or AM4-PC).\n        \"\"\"\n        num_steps = int(round(T / h))\n        t = np.linspace(0, T, num_steps + 1)\n        \n        y = np.zeros((num_steps + 1, 2), dtype=np.float64)\n        y[0] = [1.0, 0.0]  # Initial conditions x(0)=1, v(0)=0\n\n        f_kwargs = {'omega': omega, 'zeta': zeta}\n\n        # Startup phase: Use RK4 to generate the first 3 steps\n        for n in range(3):\n            y[n+1] = rk4_step(ode_f, t[n], y[n], h, **f_kwargs)\n            \n        f_vals = np.zeros_like(y)\n        for i in range(4):\n            f_vals[i] = ode_f(t[i], y[i], **f_kwargs)\n\n        # Multi-step phase\n        for n in range(3, num_steps):\n            f_n, f_n_m1, f_n_m2, f_n_m3 = f_vals[n], f_vals[n-1], f_vals[n-2], f_vals[n-3]\n\n            # Predictor step (AB4)\n            y_pred = y[n] + (h / 24.0) * (55.0 * f_n - 59.0 * f_n_m1 + 37.0 * f_n_m2 - 9.0 * f_n_m3)\n            \n            if method == 'AB4':\n                y[n+1] = y_pred\n            elif method == 'AM4_PC':\n                # Evaluate step\n                f_pred = ode_f(t[n+1], y_pred, **f_kwargs)\n                # Corrector step (AM4)\n                y_corr = y[n] + (h / 24.0) * (9.0 * f_pred + 19.0 * f_n - 5.0 * f_n_m1 + f_vals[n-2])\n                y[n+1] = y_corr\n            else:\n                raise ValueError(\"Unknown method specified.\")\n            \n            # Final evaluation for next step's history\n            f_vals[n+1] = ode_f(t[n+1], y[n+1], **f_kwargs)\n            \n        return y[-1, 0] # Return the final position x(T)\n\n    results = []\n    for case in test_cases:\n        omega, zeta, T, h = case\n        \n        # Calculate numerical solutions\n        x_ab4 = solve_ode_multistep(omega, zeta, T, h, 'AB4')\n        x_am4 = solve_ode_multistep(omega, zeta, T, h, 'AM4_PC')\n        \n        # Calculate exact solution\n        x_exact = analytical_solution(T, omega, zeta)\n        \n        # Calculate errors\n        err_ab4 = abs(x_ab4 - x_exact)\n        err_am4 = abs(x_am4 - x_exact)\n        \n        # Calculate error ratio\n        if err_am4 == 0:\n            # This case is unlikely but would imply infinite ratio if err_ab4  0\n            ratio = np.inf if err_ab4  0 else 1.0\n        else:\n            ratio = err_ab4 / err_am4\n        \n        results.append(ratio)\n    \n    print(f\"[{','.join(f'{r:.10f}' for r in results)}]\")\n\nsolve()\n```", "id": "3523834"}]}