{"hands_on_practices": [{"introduction": "The ultimate goal of performing an LU decomposition on a matrix $A$ is to efficiently solve the linear system $Ax = b$. The decomposition transforms this single, computationally intensive problem into two much simpler ones: solving $Ly = b$ and then $Ux = y$. This first exercise [@problem_id:3507995] focuses on this final stage, allowing you to master the mechanics of forward and backward substitution, the cornerstones of solving systems with triangular matrices.", "problem": "Consider a plane-parallel, self-gravitating slab in the Newtonian limit, where the gravitational potential $\\Phi$ obeys the Poisson equation $ \\nabla^{2} \\Phi = 4 \\pi G \\rho $. On a one-dimensional, uniformly spaced grid with Dirichlet boundary conditions, a second-order centered finite-difference discretization of the Laplacian produces a linear system $A x = b$ for the interior nodal values of the nondimensionalized potential $x$, where nondimensionalization has been applied using characteristic scales so that $x$ is dimensionless. A direct solve proceeds by computing the Lower-Upper (LU) decomposition $A = L U$, followed by triangular solves.\n\nYou are given the factorization of the discrete operator and the corresponding source vector as\n$$\nL = \\begin{pmatrix}\n1 & 0 & 0 \\\\\n2 & 1 & 0 \\\\\n-1 & 3 & 1\n\\end{pmatrix}, \\quad\nU = \\begin{pmatrix}\n4 & 2 & 0 \\\\\n0 & -3 & 1 \\\\\n0 & 0 & 5\n\\end{pmatrix}, \\quad\nb = \\begin{pmatrix}\n3 \\\\ 0 \\\\ 7\n\\end{pmatrix}.\n$$\nUsing forward substitution to solve $L y = b$ and backward substitution to solve $U x = y$, determine the vector $x$ corresponding to the discrete potential at the three interior nodes. Express $x$ exactly in fractional form; no rounding is required. The components of $x$ are dimensionless due to the chosen nondimensionalization.", "solution": "The problem is well-posed and scientifically grounded. It presents a standard numerical linear algebra problem arising from the finite-difference discretization of the Poisson equation, a fundamental equation in physics. The givens consist of the Lower-Upper ($ L U $) decomposition of the system matrix $ A $ and the source vector $ b $. The task is to solve the linear system $ A x = b $ for the unknown vector $ x $.\n\nThe solution strategy involves two steps, leveraging the provided $ L U $ factorization. The original system $ A x = b $ is rewritten as $ L U x = b $. We introduce an intermediate vector $ y $ defined as $ y = U x $. This decouples the problem into two simpler systems involving triangular matrices:\n$1$. A lower-triangular system $ L y = b $, which is solved for $ y $ using forward substitution.\n$2$. An upper-triangular system $ U x = y $, which is solved for $ x $ using backward substitution.\n\nThe components of the vectors $x$, $y$, and $b$ are denoted by subscripts, e.g., $x = \\beginpmatrix} x_1 \\\\ x_2 \\\\ x_3 \\end{pmatrix}$.\n\n**Step 1: Solve $ L y = b $ using Forward Substitution**\n\nThe first system is given by:\n$$\n\\begin{pmatrix}\n1 & 0 & 0 \\\\\n2 & 1 & 0 \\\\\n-1 & 3 & 1\n\\end{pmatrix}\n\\begin{pmatrix}\ny_1 \\\\\ny_2 \\\\\ny_3\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n3 \\\\\n0 \\\\\n7\n\\end{pmatrix}\n$$\n\nThis matrix equation corresponds to the following system of linear equations:\n$1) \\quad 1 \\cdot y_1 = 3$\n$2) \\quad 2 \\cdot y_1 + 1 \\cdot y_2 = 0$\n$3) \\quad -1 \\cdot y_1 + 3 \\cdot y_2 + 1 \\cdot y_3 = 7$\n\nWe solve for the components of $y$ sequentially from $y_1$ to $y_3$.\n\nFrom equation ($1$):\n$$\ny_1 = 3\n$$\n\nSubstitute the value of $y_1$ into equation ($2$):\n$$\n2(3) + y_2 = 0 \\implies 6 + y_2 = 0 \\implies y_2 = -6\n$$\n\nSubstitute the values of $y_1$ and $y_2$ into equation ($3$):\n$$\n-1(3) + 3(-6) + y_3 = 7 \\implies -3 - 18 + y_3 = 7 \\implies -21 + y_3 = 7 \\implies y_3 = 28\n$$\n\nThus, the intermediate vector is $ y = \\begin{pmatrix} 3 \\\\ -6 \\\\ 28 \\end{pmatrix} $.\n\n**Step 2: Solve $ U x = y $ using Backward Substitution**\n\nThe second system is given by:\n$$\n\\begin{pmatrix}\n4 & 2 & 0 \\\\\n0 & -3 & 1 \\\\\n0 & 0 & 5\n\\end{pmatrix}\n\\begin{pmatrix}\nx_1 \\\\\nx_2 \\\\\nx_3\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n3 \\\\\n-6 \\\\\n28\n\\end{pmatrix}\n$$\n\nThis matrix equation corresponds to the following system of linear equations:\n$1) \\quad 4 \\cdot x_1 + 2 \\cdot x_2 = 3$\n$2) \\quad -3 \\cdot x_2 + 1 \\cdot x_3 = -6$\n$3) \\quad 5 \\cdot x_3 = 28$\n\nWe solve for the components of $x$ sequentially in reverse order, from $x_3$ to $x_1$.\n\nFrom equation ($3$):\n$$\n5 x_3 = 28 \\implies x_3 = \\frac{28}{5}\n$$\n\nSubstitute the value of $x_3$ into equation ($2$):\n$$\n-3 x_2 + \\frac{28}{5} = -6\n$$\n$$\n-3 x_2 = -6 - \\frac{28}{5} = -\\frac{30}{5} - \\frac{28}{5} = -\\frac{58}{5}\n$$\n$$\nx_2 = \\frac{-58}{5} \\cdot \\left(-\\frac{1}{3}\\right) = \\frac{58}{15}\n$$\n\nSubstitute the value of $x_2$ into equation ($1$):\n$$\n4 x_1 + 2 \\left(\\frac{58}{15}\\right) = 3\n$$\n$$\n4 x_1 + \\frac{116}{15} = 3\n$$\n$$\n4 x_1 = 3 - \\frac{116}{15} = \\frac{45}{15} - \\frac{116}{15} = -\\frac{71}{15}\n$$\n$$\nx_1 = -\\frac{71}{15} \\cdot \\frac{1}{4} = -\\frac{71}{60}\n$$\n\nThe solution vector, representing the discrete potential at the interior nodes, is therefore:\n$$\nx = \\begin{pmatrix}\nx_1 \\\\\nx_2 \\\\\nx_3\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n-\\frac{71}{60} \\\\\n\\frac{58}{15} \\\\\n\\frac{28}{5}\n\\end{pmatrix}\n$$", "answer": "$$\n\\boxed{\\begin{pmatrix} -\\frac{71}{60} \\\\ \\frac{58}{15} \\\\ \\frac{28}{5} \\end{pmatrix}}\n$$", "id": "3507995"}, {"introduction": "Having practiced solving a system once the $L$ and $U$ factors are known, we now turn to the central task of finding the factors themselves. This exercise [@problem_id:3507926] guides you through the process of decomposing a matrix $A$ into its lower-triangular ($L$) and upper-triangular ($U$) components. By working through this example, you will gain a concrete understanding of how Gaussian elimination systematically produces the $LU$ factorization for a well-behaved matrix.", "problem": "In modeling the self-gravitating equilibrium of a stratified astrophysical disk, one solves the Poisson equation for the gravitational potential, $\\nabla^{2} \\Phi = 4 \\pi G \\rho$, where $G$ is the gravitational constant and $\\rho$ is the mass density. A standard finite-difference discretization on a locally uniform mesh leads to a sparse linear system $A \\mathbf{x} = \\mathbf{b}$ for correction coefficients $\\mathbf{x}$ to the potential. In a nonlinear solve using a Newton method with local block updates, consider a three-point subproblem extracted from the Jacobian that yields the $3 \\times 3$ coefficient matrix\n$$\nA = \\begin{pmatrix}\n2 & 1 & 1 \\\\\n4 & -6 & 0 \\\\\n-2 & 7 & 2\n\\end{pmatrix}.\n$$\nDirect methods are employed on such small blocks to provide robust local updates and preconditioners. Starting from the principles of Gaussian elimination, perform a Lower-Upper (LU) factorization of $A$ using the Doolittle convention (unit diagonal in the lower-triangular factor) without pivoting to obtain matrices $L$ and $U$ such that $A = L U$. Use your factorization to deduce a scalar diagnostic of the block’s invertibility: the determinant of $A$. Report the determinant as your final answer. If you choose to approximate, round your final number to four significant figures. Otherwise, provide the exact value. No physical units are required for the determinant.", "solution": "The problem is assessed as valid. It is scientifically grounded in the context of computational astrophysics and numerical linear algebra, is well-posed with sufficient and consistent information, and is expressed in objective, formal language. We may proceed with the solution.\n\nThe task is to perform an LU factorization of the given $3 \\times 3$ matrix $A$, and then use this factorization to compute its determinant. The specified factorization is of the Doolittle form, where $A = L U$, with $L$ being a lower-triangular matrix with a unit diagonal and $U$ being an upper-triangular matrix.\n\nThe given matrix is:\n$$\nA = \\begin{pmatrix}\n2 & 1 & 1 \\\\\n4 & -6 & 0 \\\\\n-2 & 7 & 2\n\\end{pmatrix}\n$$\n\nWe are seeking matrices $L$ and $U$ of the form:\n$$\nL = \\begin{pmatrix}\n1 & 0 & 0 \\\\\nl_{21} & 1 & 0 \\\\\nl_{31} & l_{32} & 1\n\\end{pmatrix}, \\quad\nU = \\begin{pmatrix}\nu_{11} & u_{12} & u_{13} \\\\\n0 & u_{22} & u_{23} \\\\\n0 & 0 & u_{33}\n\\end{pmatrix}\n$$\n\nThe factorization $A=LU$ can be written out as:\n$$\n\\begin{pmatrix}\n2 & 1 & 1 \\\\\n4 & -6 & 0 \\\\\n-2 & 7 & 2\n\\end{pmatrix} = \\begin{pmatrix}\n1 & 0 & 0 \\\\\nl_{21} & 1 & 0 \\\\\nl_{31} & l_{32} & 1\n\\end{pmatrix} \\begin{pmatrix}\nu_{11} & u_{12} & u_{13} \\\\\n0 & u_{22} & u_{23} \\\\\n0 & 0 & u_{33}\n\\end{pmatrix}\n$$\n\nExpanding the matrix product on the right side yields:\n$$\nLU = \\begin{pmatrix}\nu_{11} & u_{12} & u_{13} \\\\\nl_{21}u_{11} & l_{21}u_{12} + u_{22} & l_{21}u_{13} + u_{23} \\\\\nl_{31}u_{11} & l_{31}u_{12} + l_{32}u_{22} & l_{31}u_{13} + l_{32}u_{23} + u_{33}\n\\end{pmatrix}\n$$\n\nWe can determine the unknown entries of $L$ and $U$ by equating the elements of this product with the corresponding elements of matrix $A$. This process is equivalent to performing Gaussian elimination on $A$ to obtain $U$.\n\n1.  From the first row of $A=LU$:\n    $u_{11} = a_{11} = 2$\n    $u_{12} = a_{12} = 1$\n    $u_{13} = a_{13} = 1$\n\n2.  From the first column of $A=LU$:\n    $l_{21}u_{11} = a_{21} \\implies l_{21}(2) = 4 \\implies l_{21} = 2$\n    $l_{31}u_{11} = a_{31} \\implies l_{31}(2) = -2 \\implies l_{31} = -1$\n\n3.  From the second row of $A=LU$:\n    $l_{21}u_{12} + u_{22} = a_{22} \\implies (2)(1) + u_{22} = -6 \\implies u_{22} = -6 - 2 = -8$\n    $l_{21}u_{13} + u_{23} = a_{23} \\implies (2)(1) + u_{23} = 0 \\implies u_{23} = -2$\n\n4.  From the second column of $A=LU$:\n    $l_{31}u_{12} + l_{32}u_{22} = a_{32} \\implies (-1)(1) + l_{32}(-8) = 7 \\implies -1 - 8l_{32} = 7 \\implies -8l_{32} = 8 \\implies l_{32} = -1$\n\n5.  From the third row of $A=LU$:\n    $l_{31}u_{13} + l_{32}u_{23} + u_{33} = a_{33} \\implies (-1)(1) + (-1)(-2) + u_{33} = 2 \\implies -1 + 2 + u_{33} = 2 \\implies 1 + u_{33} = 2 \\implies u_{33} = 1$\n\nHaving found all the unknown elements, we can construct the matrices $L$ and $U$:\n$$\nL = \\begin{pmatrix}\n1 & 0 & 0 \\\\\n2 & 1 & 0 \\\\\n-1 & -1 & 1\n\\end{pmatrix}, \\quad\nU = \\begin{pmatrix}\n2 & 1 & 1 \\\\\n0 & -8 & -2 \\\\\n0 & 0 & 1\n\\end{pmatrix}\n$$\nThe problem requires using this factorization to find the determinant of $A$. A fundamental property of determinants is that for any two square matrices $B$ and $C$ of the same size, $\\det(BC) = \\det(B)\\det(C)$. Applying this to our factorization $A=LU$:\n$$\n\\det(A) = \\det(L U) = \\det(L) \\det(U)\n$$\nThe determinant of a triangular matrix is the product of its diagonal entries.\nFor the matrix $L$:\n$$\n\\det(L) = l_{11} \\cdot l_{22} \\cdot l_{33} = 1 \\cdot 1 \\cdot 1 = 1\n$$\nThis is a general property of the Doolittle decomposition, where $\\det(L)$ is always $1$.\nFor the matrix $U$:\n$$\n\\det(U) = u_{11} \\cdot u_{22} \\cdot u_{33} = (2)(-8)(1) = -16\n$$\nTherefore, the determinant of $A$ is:\n$$\n\\det(A) = \\det(L) \\det(U) = 1 \\cdot (-16) = -16\n$$\nThe determinant is a non-zero scalar, $\\det(A) = -16 \\neq 0$, which confirms that the matrix $A$ is invertible. This is consistent with the fact that an LU decomposition without pivoting was successfully performed, which requires all leading principal minors of $A$ to be non-zero.\nThe leading principal minors are:\n$M_1 = 2$\n$M_2 = \\det \\begin{pmatrix} 2 & 1 \\\\ 4 & -6 \\end{pmatrix} = (2)(-6) - (1)(4) = -12 - 4 = -16$\n$M_3 = \\det(A) = -16$\nAll are non-zero, validating the procedure. The requested scalar diagnostic is the determinant.", "answer": "$$\n\\boxed{-16}\n$$", "id": "3507926"}, {"introduction": "In an ideal world, Gaussian elimination proceeds without issue. However, in practice, the algorithm can fail if a zero appears in a pivot position, halting the process. This final exercise [@problem_id:3507917] demonstrates this critical scenario and introduces the standard solution: pivoting. You will see firsthand how reordering the equations—mathematically represented by a permutation matrix $P$—enables the decomposition to proceed, leading to the robust and universally applicable $PA = LU$ factorization.", "problem": "In models of self-gravitating fluids in computational astrophysics, the gravitational potential $\\Phi$ obeys the Poisson equation $\\nabla^{2}\\Phi = 4 \\pi G \\rho$, where $G$ is the gravitational constant and $\\rho$ is the mass density. A standard second-order finite-difference discretization on a one-dimensional mesh with mixed boundary conditions produces a sparse linear system $A \\boldsymbol{\\Phi} = \\boldsymbol{b}$, where $A$ encodes local couplings of $\\Phi$ between adjacent mesh points. In practice, the discrete system is often solved by direct factorization using Lower-Upper (LU) decomposition, $A = L U$, with $L$ lower-triangular and unit-diagonal and $U$ upper-triangular.\n\nConsider a local $3 \\times 3$ block extracted from such a discretization after a particular variable ordering that places a boundary-conditioned row first. The resulting concrete coefficient matrix is\n$$\nA = \\begin{pmatrix}\n0 & -1 & 2 \\\\\n1 & 3 & -1 \\\\\n2 & -1 & 3\n\\end{pmatrix}.\n$$\nThis matrix is nonsingular but has a zero in the pivot position $(1,1)$, so a naive attempt to compute $A = L U$ without pivoting fails immediately due to a zero pivot. However, reordering equations by a specific permutation can recover a valid factorization.\n\nTasks:\n- Starting from the definition of LU decomposition and the structure of Gaussian elimination, explain precisely why attempting $A = L U$ without any row permutations fails for the given $A$.\n- Construct the permutation matrix $P$ that swaps the first and second rows, and form $P A$ explicitly. Then carry out Gaussian elimination on $P A$ to produce a unit-diagonal lower-triangular matrix $L$ and an upper-triangular matrix $U$ satisfying $P A = L U$.\n- Using only properties of triangular matrices established during factorization, compute the product of the diagonal entries of $U$.\n\nProvide as your final answer the product of the diagonal entries of $U$ as a single real number. No rounding is necessary.", "solution": "The problem is well-posed and scientifically grounded in the field of numerical linear algebra, specifically concerning direct methods for solving linear systems. The matrix provided serves as a canonical example for illustrating the necessity of pivoting in LU decomposition. We will proceed with the solution by addressing each task sequentially.\n\nThe first task is to explain why the LU decomposition of the given matrix $A$ without row permutations fails. The LU decomposition seeks to find a unit-diagonal lower-triangular matrix $L$ and an upper-triangular matrix $U$ such that $A = LU$.\nLet the given matrix be\n$$\nA = \\begin{pmatrix}\n0 & -1 & 2 \\\\\n1 & 3 & -1 \\\\\n2 & -1 & 3\n\\end{pmatrix}\n$$\nAnd let the general forms of $L$ and $U$ for a $3 \\times 3$ system be\n$$\nL = \\begin{pmatrix}\n1 & 0 & 0 \\\\\nl_{21} & 1 & 0 \\\\\nl_{31} & l_{32} & 1\n\\end{pmatrix}, \\quad U = \\begin{pmatrix}\nu_{11} & u_{12} & u_{13} \\\\\n0 & u_{22} & u_{23} \\\\\n0 & 0 & u_{33}\n\\end{pmatrix}\n$$\nThe product $LU$ is\n$$\nLU = \\begin{pmatrix}\nu_{11} & u_{12} & u_{13} \\\\\nl_{21}u_{11} & l_{21}u_{12} + u_{22} & l_{21}u_{13} + u_{23} \\\\\nl_{31}u_{11} & l_{31}u_{12} + l_{32}u_{22} & l_{31}u_{13} + l_{32}u_{23} + u_{33}\n\\end{pmatrix}\n$$\nEquating the elements of $A$ and $LU$ row by row or column by column allows us to solve for the unknown entries of $L$ and $U$. From the first column of $A = LU$:\n$a_{11} = u_{11}$\n$a_{21} = l_{21}u_{11}$\n$a_{31} = l_{31}u_{11}$\n\nFor the given matrix $A$, we have $a_{11} = 0$, $a_{21} = 1$, and $a_{31} = 2$.\nSubstituting $a_{11} = 0$ into the first equation gives $u_{11} = 0$.\nSubstituting this result into the second equation gives $a_{21} = 1 = l_{21} \\cdot 0$. This implies $1=0$, which is a contradiction.\nIn the context of Gaussian elimination, the first pivot element is $a_{11} = 0$. To create zeros in the first column below the pivot, one would compute the multipliers $m_{21} = \\frac{a_{21}}{a_{11}}$ and $m_{31} = \\frac{a_{31}}{a_{11}}$. For the given matrix, this would require computing $m_{21} = \\frac{1}{0}$, which is an undefined division-by-zero operation. Thus, the process fails.\n\nThe second task is to apply a row permutation to enable the factorization. We construct the permutation matrix $P$ that swaps the first and second rows. This matrix is obtained by swapping the first and second rows of the $3 \\times 3$ identity matrix:\n$$\nP = \\begin{pmatrix}\n0 & 1 & 0 \\\\\n1 & 0 & 0 \\\\\n0 & 0 & 1\n\\end{pmatrix}\n$$\nNext, we compute the product $PA$:\n$$\nPA = \\begin{pmatrix}\n0 & 1 & 0 \\\\\n1 & 0 & 0 \\\\\n0 & 0 & 1\n\\end{pmatrix}\n\\begin{pmatrix}\n0 & -1 & 2 \\\\\n1 & 3 & -1 \\\\\n2 & -1 & 3\n\\end{pmatrix} = \\begin{pmatrix}\n1 & 3 & -1 \\\\\n0 & -1 & 2 \\\\\n2 & -1 & 3\n\\end{pmatrix}\n$$\nNow we perform Gaussian elimination on $A' = PA$ to find $L$ and $U$ such that $PA=LU$.\nThe initial matrix is $A^{(0)} = PA = \\begin{pmatrix}\n1 & 3 & -1 \\\\\n0 & -1 & 2 \\\\\n2 & -1 & 3\n\\end{pmatrix}$.\nThe first pivot is $a'_{11} = 1$.\nThe entry $a'_{21}$ is already $0$, so the multiplier $l_{21} = \\frac{a'_{21}}{a'_{11}} = \\frac{0}{1} = 0$. Row $2$ remains unchanged.\nTo eliminate $a'_{31} = 2$, we compute the multiplier $l_{31} = \\frac{a'_{31}}{a'_{11}} = \\frac{2}{1} = 2$. We perform the row operation $R_3 \\leftarrow R_3 - 2R_1$:\n$$\n(2, -1, 3) - 2 \\cdot (1, 3, -1) = (2-2, -1-6, 3-(-2)) = (0, -7, 5)\n$$\nThe matrix after the first step of elimination is:\n$$\nA^{(1)} = \\begin{pmatrix}\n1 & 3 & -1 \\\\\n0 & -1 & 2 \\\\\n0 & -7 & 5\n\\end{pmatrix}\n$$\nThe second pivot is $a^{(1)}_{22} = -1$.\nTo eliminate the entry $a^{(1)}_{32} = -7$ below the pivot, we compute the multiplier $l_{32} = \\frac{a^{(1)}_{32}}{a^{(1)}_{22}} = \\frac{-7}{-1} = 7$. We perform the row operation $R_3 \\leftarrow R_3 - 7R_2$:\n$$\n(0, -7, 5) - 7 \\cdot (0, -1, 2) = (0, -7-(-7), 5-14) = (0, 0, -9)\n$$\nThe elimination process is now complete. The resulting upper-triangular matrix is $U$:\n$$\nU = \\begin{pmatrix}\n1 & 3 & -1 \\\\\n0 & -1 & 2 \\\\\n0 & 0 & -9\n\\end{pmatrix}\n$$\nThe unit-diagonal lower-triangular matrix $L$ is constructed with the multipliers we calculated:\n$$\nL = \\begin{pmatrix}\n1 & 0 & 0 \\\\\nl_{21} & 1 & 0 \\\\\nl_{31} & l_{32} & 1\n\\end{pmatrix} = \\begin{pmatrix}\n1 & 0 & 0 \\\\\n0 & 1 & 0 \\\\\n2 & 7 & 1\n\\end{pmatrix}\n$$\nThe third task is to compute the product of the diagonal entries of $U$. The diagonal entries of $U$ are $u_{11} = 1$, $u_{22} = -1$, and $u_{33} = -9$. The product is:\n$$\n\\text{Product} = u_{11} \\cdot u_{22} \\cdot u_{33} = (1) \\cdot (-1) \\cdot (-9) = 9\n$$\nThis product is also equal to the determinant of $U$, $\\det(U)$. From the relation $PA=LU$, we have $\\det(P)\\det(A)=\\det(L)\\det(U)$. Since $\\det(P)=-1$ (for a single row swap) and $\\det(L)=1$ (for a unit-triangular matrix), we have $-\\det(A) = \\det(U)$. The determinant of the original matrix $A$ is $0 - (-1)(3 - (-2)) + 2(-1-6) = 5 - 14 = -9$. Therefore, $\\det(U) = -(-9) = 9$, which confirms our result.", "answer": "$$\n\\boxed{9}\n$$", "id": "3507917"}]}