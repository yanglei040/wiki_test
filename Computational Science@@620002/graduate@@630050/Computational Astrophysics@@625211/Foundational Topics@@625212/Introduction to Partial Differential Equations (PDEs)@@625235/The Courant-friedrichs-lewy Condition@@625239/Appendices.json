{"hands_on_practices": [{"introduction": "The Courant-Friedrichs-Lewy (CFL) condition is not merely a numerical recipe but is rooted in the fundamental principle of causality for hyperbolic equations. This first exercise guides you through the foundational derivation of the CFL condition by connecting the physical domain of dependence to the numerical stencil of a finite-volume scheme. By completing this practice [@problem_id:3442602], you will solidify your understanding of why the CFL condition is a necessary prerequisite for numerical stability and convergence.", "problem": "Consider a one-dimensional hyperbolic conservation law $u_{t} + f(u)_{x} = 0$ discretized on a uniform grid of spacing $\\Delta x = 0.01$ using a shock-capturing scheme that is second-order Total Variation Diminishing (TVD). Let the explicit time integrator be second-order TVD Runge–Kutta, and assume the maximum characteristic wavespeed satisfies $|a| = \\max |f^{\\prime}(u)| = 3$. The Courant–Friedrichs–Lewy (CFL) condition for stability and preservation of the TVD property constrains the Courant number $\\lambda$ defined by $\\lambda = |a|\\,\\Delta t / \\Delta x$, and you are asked to enforce $\\lambda \\le 0.9$ to maintain a safety margin within the TVD stability regime.\n\nDerive the CFL restriction from the domain-of-dependence principle for hyperbolic equations and shock-capturing finite-volume discretizations, and compute the largest time step $\\Delta t$ that satisfies the stated CFL constraint. Provide the final numerical value of $\\Delta t$ as a single real number. No rounding is needed.", "solution": "The problem is validated as well-posed, scientifically grounded, and containing all necessary information for a unique solution.\n\nThe problem asks for two things: first, to derive the Courant–Friedrichs–Lewy (CFL) condition from the domain-of-dependence principle, and second, to calculate the largest permissible time step $\\Delta t$ given the constraints.\n\nFirst, we address the derivation.\nThe governing equation is a one-dimensional hyperbolic conservation law, given by $u_{t} + f(u)_{x} = 0$. By applying the chain rule to the flux term $f(u)_{x}$, we can write the equation in its quasilinear form: $u_{t} + f^{\\prime}(u) u_{x} = 0$. The term $a(u) = f^{\\prime}(u)$ is the local characteristic wave speed, which describes the speed at which information propagates in the system. The equation $u_{t} + a(u) u_{x} = 0$ implies that the solution $u$ is constant along the characteristic curves in the $x-t$ plane, which are defined by the ordinary differential equation $\\frac{dx}{dt} = a(u)$.\n\nThe Courant–Friedrichs–Lewy (CFL) condition is a necessary condition for the stability of explicit numerical schemes for solving hyperbolic partial differential equations. It can be derived by comparing the physical domain of dependence of the PDE's solution with the numerical domain of dependence of the finite difference or finite volume scheme.\n\nConsider a point $(x_j, t^{n+1})$ on our computational grid, where $x_j$ is a spatial grid point and $t^{n+1} = t^n + \\Delta t$ is the time at the next step. The exact solution at this point, $u(x_j, t^{n+1})$, depends on the data at the previous time $t^n$ within a certain spatial interval. This interval is the physical domain of dependence. Information propagates with a finite speed, the maximum of which is given by $|a|_{\\max} = \\max_u |f^{\\prime}(u)|$. For a wave to reach the point $x_j$ at time $t^{n+1}$, it must have originated at time $t^n$ from a point $x_0$ such that the travel time is $\\Delta t$. The distance traveled is $|x_j - x_0| \\le |a|_{\\max} \\Delta t$. Therefore, the physical domain of dependence for the point $(x_j, t^{n+1})$ is the interval $[x_j - |a|_{\\max} \\Delta t, x_j + |a|_{\\max} \\Delta t]$ on the line $t=t^n$.\n\nNow, let's consider the numerical scheme. A shock-capturing scheme, such as a finite-volume scheme, computes the updated value $u_j^{n+1}$ in cell $j$ using the values from neighboring cells at time $t^n$. For a typical second-order TVD scheme, the numerical stencil to compute $u_j^{n+1}$ involves, at a minimum, the cells $j-1$, $j$, and $j+1$. The set of grid points at time $t^n$ that influences the computation of $u_j^{n+1}$ is the numerical domain of dependence. For a standard three-point stencil centered at $j$, this domain covers the spatial interval $[x_{j-1}, x_{j+1}]$, which, on a uniform grid with spacing $\\Delta x$, corresponds to the interval $[x_j - \\Delta x, x_j + \\Delta x]$.\n\nThe fundamental principle of the CFL condition is that for the numerical scheme to have any chance of yielding a convergent solution, its numerical domain of dependence must contain the physical domain of dependence of the PDE. If this condition is violated, the numerical scheme would be unable to access all the physical information necessary to correctly calculate the state at the next time step, leading to instability.\n\nThus, we must have:\n$$[x_j - |a|_{\\max} \\Delta t, x_j + |a|_{\\max} \\Delta t] \\subseteq [x_j - \\Delta x, x_j + \\Delta x]$$\nThis inclusion is satisfied if and only if the extent of the physical domain of dependence is less than or equal to the extent of the numerical domain of dependence. This leads to the inequality:\n$$|a|_{\\max} \\Delta t \\le \\Delta x$$\nDividing by $\\Delta x$ (which is strictly positive), we obtain the classic CFL condition:\n$$\\frac{|a|_{\\max} \\Delta t}{\\Delta x} \\le 1$$\nThe dimensionless group $\\lambda = \\frac{|a|_{\\max} \\Delta t}{\\Delta x}$ is known as the Courant number. The stability condition is therefore $\\lambda \\le 1$. For some multi-stage or higher-order schemes, the stability-enforcing limit on $\\lambda$ can be smaller than $1$. The problem statement provides a practical stability and TVD-property constraint of $\\lambda \\le 0.9$, which falls within this theoretical framework.\n\nNext, we compute the largest time step $\\Delta t$ that satisfies the given constraint.\nThe provided information is:\nMaximum characteristic wavespeed, $|a| = \\max |f^{\\prime}(u)| = 3$. We denote this by $|a|_{\\max} = 3$.\nGrid spacing, $\\Delta x = 0.01$.\nThe Courant number, $\\lambda = \\frac{|a|_{\\max} \\Delta t}{\\Delta x}$.\nThe CFL constraint to be enforced: $\\lambda \\le 0.9$.\n\nWe substitute the definition of the Courant number into the constraint:\n$$\\frac{|a|_{\\max} \\Delta t}{\\Delta x} \\le 0.9$$\nWe are looking for the largest possible time step, $\\Delta t$, which we denote $\\Delta t_{\\max}$. This value is obtained when the equality holds:\n$$\\frac{|a|_{\\max} \\Delta t_{\\max}}{\\Delta x} = 0.9$$\nSolving for $\\Delta t_{\\max}$, we get:\n$$\\Delta t_{\\max} = \\frac{0.9 \\cdot \\Delta x}{|a|_{\\max}}$$\nNow, we substitute the given numerical values into this expression:\n$$\\Delta t_{\\max} = \\frac{0.9 \\times 0.01}{3}$$\nPerforming the calculation:\n$$0.9 \\times 0.01 = 0.009$$\n$$\\Delta t_{\\max} = \\frac{0.009}{3} = 0.003$$\nTherefore, the largest time step that satisfies the stated CFL constraint is $0.003$.", "answer": "$$\\boxed{0.003}$$", "id": "3442602"}, {"introduction": "Real astrophysical environments are rarely isotropic; phenomena like magnetic fields and thermal conduction can introduce strong directional dependencies. This practice extends the basic CFL concept to a more complex, multi-dimensional scenario involving a magnetized, gravitationally stratified plasma where wave speeds are anisotropic. By deriving the directional characteristic speeds and the corresponding time step constraints for a directionally split scheme [@problem_id:3538584], you will learn how to adapt the CFL condition to handle the rich physics of anisotropic wave propagation.", "problem": "Consider a two-dimensional, plane-parallel, gravitationally stratified, fully ionized hydrogen-helium plasma representing a coronal segment of a stellar atmosphere. Gravity of magnitude $g$ is uniform and points in the negative $z$-direction. The temperature is uniform and equal to $T$, so the atmosphere is isothermal. The mean molecular weight is $\\mu$. The plasma is threaded by a uniform magnetic field that makes an angle $\\phi$ with the $x$-axis (measured in the $x$-$z$ plane). Thermal conduction is extremely efficient along magnetic field lines and negligible across them, so compressions parallel to the magnetic field are effectively isothermal, while compressions perpendicular to the magnetic field are effectively adiabatic with ratio of specific heats $\\gamma$. You will analyze how this anisotropic thermodynamics modifies the directional signal speeds that enter the Courant-Friedrichs-Lewy (CFL) condition for an explicit, directionally split, first-order finite-volume Godunov method using a local Lax-Friedrichs (Rusanov) flux.\n\nWork in the low-Mach-number, non-magnetically-dynamic limit in which the only wave family of interest is the acoustic-like compressive mode and the magnetic field enters only by enforcing the anisotropic thermodynamic response described above. Start from the linearized mass and momentum conservation equations for a compressible fluid and an anisotropic closure for the pressure-density relation consistent with the assumptions above. By considering plane-wave perturbations with wavevector aligned with either the $x$-axis or the $z$-axis, derive the directional characteristic speeds $c_{x}$ and $c_{z}$ that control signal propagation in the numerical fluxes. Express these in terms of the isothermal sound speed along the magnetic field $c_{\\parallel}$ and the adiabatic sound speed across the magnetic field $c_{\\perp}$, the angle $\\phi$, and fundamental constants and parameters. Then, enforce the requirement that in each one-dimensional split sweep the numerical domain of dependence contains the physical domain of dependence, and obtain the maximum stable time step $\\Delta t_{\\max}$ for one full $x$-$z$ update in terms of the directional speeds, grid spacings, and flow velocities.\n\nAssume the following physically plausible parameters representative of a stellar corona:\n- Uniform temperature $T = 1.00 \\times 10^{6}\\ \\mathrm{K}$.\n- Mean molecular weight $\\mu = 0.6$.\n- Ratio of specific heats $\\gamma = \\frac{5}{3}$.\n- Gravitational acceleration $g = 274\\ \\mathrm{m}\\ \\mathrm{s}^{-2}$.\n- Boltzmann constant $k_{B} = 1.380649 \\times 10^{-23}\\ \\mathrm{J}\\ \\mathrm{K}^{-1}$.\n- Proton mass $m_{p} = 1.6726219 \\times 10^{-27}\\ \\mathrm{kg}$.\n- Magnetic-field angle $\\phi = 30^{\\circ}$.\n- Background velocities $u_{x} = 4.00 \\times 10^{4}\\ \\mathrm{m}\\ \\mathrm{s}^{-1}$ and $u_{z} = 0$.\n- Courant number $C = 0.5$.\n\nLet the isothermal scale height be $H = \\frac{k_{B} T}{\\mu m_{p} g}$. Choose an anisotropic grid that resolves the steep vertical stratification with $\\Delta z = \\frac{H}{2500}$ and a ten times larger horizontal spacing $\\Delta x = 10\\,\\Delta z$.\n\nUsing only the fundamental laws and facts specified or implicit above, compute the maximum stable time step $\\Delta t_{\\max}$ implied by the CFL condition for the described explicit, directionally split scheme. Express your final answer in seconds and round to four significant figures.", "solution": "The user has provided a problem in computational astrophysics that requires the derivation and calculation of the maximum stable time step, $\\Delta t_{\\max}$, for a specific numerical scheme. The validation process will be performed first.\n\n### Step 1: Extract Givens\n- **System Description**: Two-dimensional ($x$-$z$), plane-parallel, gravitationally stratified, fully ionized hydrogen-helium plasma.\n- **Gravity**: Uniform magnitude $g$, pointing in the negative $z$-direction.\n- **Temperature**: Uniform and constant, $T$.\n- **Mean Molecular Weight**: $\\mu$.\n- **Magnetic Field**: Uniform, in the $x$-$z$ plane, at an angle $\\phi$ with the $x$-axis.\n- **Anisotropic Thermodynamics**:\n    - Compressions parallel to the magnetic field are isothermal.\n    - Compressions perpendicular to the magnetic field are adiabatic with ratio of specific heats $\\gamma$.\n- **Numerical Scheme**: Explicit, directionally split, first-order finite-volume Godunov method with a local Lax-Friedrichs (Rusanov) flux.\n- **Physical Limit**: Low-Mach-number, non-magnetically-dynamic, considering only the acoustic-like compressive mode.\n- **Task**:\n    1.  Derive directional characteristic speeds $c_x$ and $c_z$.\n    2.  Obtain the expression for the maximum stable time step $\\Delta t_{\\max}$ for one full $x$-$z$ update.\n    3.  Compute a numerical value for $\\Delta t_{\\max}$.\n- **Physical Parameters**:\n    - $T = 1.00 \\times 10^{6}\\ \\mathrm{K}$\n    - $\\mu = 0.6$\n    - $\\gamma = \\frac{5}{3}$\n    - $g = 274\\ \\mathrm{m}\\ \\mathrm{s}^{-2}$\n    - $k_{B} = 1.380649 \\times 10^{-23}\\ \\mathrm{J}\\ \\mathrm{K}^{-1}$\n    - $m_{p} = 1.6726219 \\times 10^{-27}\\ \\mathrm{kg}$\n    - $\\phi = 30^{\\circ}$\n    - $u_{x} = 4.00 \\times 10^{4}\\ \\mathrm{m}\\ \\mathrm{s}^{-1}$\n    - $u_{z} = 0\\ \\mathrm{m}\\ \\mathrm{s}^{-1}$\n    - Courant number $C = 0.5$\n- **Grid Definitions**:\n    - Isothermal scale height: $H = \\frac{k_{B} T}{\\mu m_{p} g}$\n    - Grid spacing in $z$: $\\Delta z = \\frac{H}{2500}$\n    - Grid spacing in $x$: $\\Delta x = 10\\,\\Delta z$\n\n### Step 2: Validate Using Extracted Givens\n- **Scientific Grounding**: The problem is well-grounded in the principles of plasma physics, fluid dynamics, and numerical methods for hyperbolic conservation laws. The concept of anisotropic heat conduction guided by a strong magnetic field is fundamental in astrophysics, particularly in stellar coronae. The Courant-Friedrichs-Lewy (CFL) condition is a cornerstone of explicit numerical methods. The specified parameters are physically realistic for a stellar corona.\n- **Well-Posedness**: The problem is well-posed. It provides all necessary information, including physical laws, parameters, and a clear description of the numerical scheme's properties, to uniquely determine the characteristic speeds and the resulting maximum stable time step.\n- **Objectivity**: The problem is stated in precise, objective, and technical language, free from ambiguity or subjective claims.\n- **Consistency and Completeness**: The setup is self-contained and internally consistent. No required information is missing, and no constraints are contradictory. The simplification to consider only the acoustic-like mode is explicitly stated and serves to make the problem tractable while focusing on the core concept of anisotropic wave propagation.\n\n### Step 3: Verdict and Action\nThe problem is deemed **valid**. It is a scientifically sound, well-posed, and non-trivial problem in computational astrophysics. A full solution will be derived.\n\n### Solution Derivation\nThe solution proceeds in several steps:\n1.  Derive the anisotropic sound speed based on the problem's thermodynamic constraints.\n2.  Determine the directional characteristic speeds, $c_x$ and $c_z$, for waves propagating along the grid axes.\n3.  Calculate the numerical values of the required physical quantities.\n4.  Apply the CFL condition for a directionally split scheme to find the maximum stable time step, $\\Delta t_{\\max}$.\n\n**1. Anisotropic Sound Speed**\nThe problem specifies that the thermal response of the plasma depends on the direction of compression relative to the magnetic field $\\mathbf{B}$.\nLet $\\hat{\\mathbf{b}}$ be the unit vector in the direction of the magnetic field. Since $\\mathbf{B}$ is in the $x$-$z$ plane at an angle $\\phi$ to the $x$-axis, we have:\n$$ \\hat{\\mathbf{b}} = (\\cos\\phi, 0, \\sin\\phi) $$\nThe speed of sound for compressions parallel to $\\mathbf{B}$ is the isothermal sound speed, $c_{\\parallel}$, given by:\n$$ c_{\\parallel}^2 = \\frac{P_0}{\\rho_0} = \\frac{k_B T}{\\mu m_p} $$\nwhere $P_0$ and $\\rho_0$ are the background pressure and density.\nThe speed of sound for compressions perpendicular to $\\mathbf{B}$ is the adiabatic sound speed, $c_{\\perp}$, given by:\n$$ c_{\\perp}^2 = \\frac{\\gamma P_0}{\\rho_0} = \\gamma c_{\\parallel}^2 $$\nFor a general plane wave with wavevector $\\mathbf{k}$, the effective sound speed squared, $c_{\\text{eff}}^2$, is a combination of these, weighted by the direction of $\\mathbf{k}$ relative to $\\hat{\\mathbf{b}}$. Let $\\theta$ be the angle between $\\mathbf{k}$ and $\\mathbf{B}$. The pressure perturbation $p'$ is related to the density perturbation $\\rho'$ by $p' = c_{\\text{eff}}^2 \\rho'$, where:\n$$ c_{\\text{eff}}^2 = c_{\\parallel}^2 \\cos^2\\theta + c_{\\perp}^2 \\sin^2\\theta $$\nThis relation constitutes the anisotropic closure required by the problem.\n\n**2. Directional Characteristic Speeds ($c_x$ and $c_z$)**\nA directionally split numerical scheme treats propagation along each coordinate axis separately. The relevant characteristic speeds are the speeds of waves propagating purely along these axes.\nFor a wave propagating in the $x$-direction, the wavevector is $\\mathbf{k} = (k_x, 0, 0)$, and the unit vector is $\\hat{\\mathbf{k}} = (1, 0, 0)$. The angle $\\theta_x$ between this wavevector and the magnetic field $\\mathbf{B}$ is given by:\n$$ \\cos\\theta_x = \\hat{\\mathbf{k}} \\cdot \\hat{\\mathbf{b}} = (1, 0, 0) \\cdot (\\cos\\phi, 0, \\sin\\phi) = \\cos\\phi $$\nThe characteristic speed in the $x$-direction, $c_x$, is the effective sound speed for this orientation:\n$$ c_x^2 = c_{\\parallel}^2 \\cos^2\\phi + c_{\\perp}^2 \\sin^2\\phi $$\nFor a wave propagating in the $z$-direction, the wavevector is $\\mathbf{k} = (0, 0, k_z)$, and the unit vector is $\\hat{\\mathbf{k}} = (0, 0, 1)$. The angle $\\theta_z$ between this wavevector and $\\mathbf{B}$ is given by:\n$$ \\cos\\theta_z = \\hat{\\mathbf{k}} \\cdot \\hat{\\mathbf{b}} = (0, 0, 1) \\cdot (\\cos\\phi, 0, \\sin\\phi) = \\sin\\phi $$\nThe characteristic speed in the $z$-direction, $c_z$, is then:\n$$ c_z^2 = c_{\\parallel}^2 \\cos^2\\theta_z + c_{\\perp}^2 \\sin^2\\theta_z = c_{\\parallel}^2 \\sin^2\\phi + c_{\\perp}^2 \\cos^2\\phi $$\nThese are the required directional speeds.\n\n**3. Numerical Calculations**\nFirst, we compute the base sound speed $c_{\\parallel}$ using the given parameters: $T = 1.00 \\times 10^6\\ \\mathrm{K}$, $\\mu = 0.6$, $k_{B} = 1.380649 \\times 10^{-23}\\ \\mathrm{J}\\ \\mathrm{K}^{-1}$, and $m_{p} = 1.6726219 \\times 10^{-27}\\ \\mathrm{kg}$.\n$$ c_{\\parallel}^2 = \\frac{k_B T}{\\mu m_p} = \\frac{(1.380649 \\times 10^{-23}\\ \\mathrm{J}\\ \\mathrm{K}^{-1}) (1.00 \\times 10^6\\ \\mathrm{K})}{(0.6)(1.6726219 \\times 10^{-27}\\ \\mathrm{kg})} \\approx 1.375763 \\times 10^{10}\\ \\mathrm{m}^2\\ \\mathrm{s}^{-2} $$\n$$ c_{\\parallel} = \\sqrt{1.375763 \\times 10^{10}\\ \\mathrm{m}^2\\ \\mathrm{s}^{-2}} \\approx 1.17293 \\times 10^5\\ \\mathrm{m}\\ \\mathrm{s}^{-1} $$\nNow we find $c_x$ and $c_z$ with $\\gamma = \\frac{5}{3}$ and $\\phi = 30^{\\circ}$ (so $\\cos^2\\phi = \\frac{3}{4}$ and $\\sin^2\\phi = \\frac{1}{4}$).\n$$ c_x^2 = c_{\\parallel}^2 \\cos^2\\phi + (\\gamma c_{\\parallel}^2) \\sin^2\\phi = c_{\\parallel}^2(\\cos^2\\phi + \\gamma \\sin^2\\phi) = c_{\\parallel}^2 \\left(\\frac{3}{4} + \\frac{5}{3} \\cdot \\frac{1}{4}\\right) = c_{\\parallel}^2 \\left(\\frac{9+5}{12}\\right) = \\frac{7}{6} c_{\\parallel}^2 $$\n$$ c_x = c_{\\parallel} \\sqrt{\\frac{7}{6}} \\approx (1.17293 \\times 10^5\\ \\mathrm{m}\\ \\mathrm{s}^{-1}) \\sqrt{\\frac{7}{6}} \\approx 1.26690 \\times 10^5\\ \\mathrm{m}\\ \\mathrm{s}^{-1} $$\n$$ c_z^2 = c_{\\parallel}^2 \\sin^2\\phi + (\\gamma c_{\\parallel}^2) \\cos^2\\phi = c_{\\parallel}^2(\\sin^2\\phi + \\gamma \\cos^2\\phi) = c_{\\parallel}^2 \\left(\\frac{1}{4} + \\frac{5}{3} \\cdot \\frac{3}{4}\\right) = c_{\\parallel}^2 \\left(\\frac{1+5}{4}\\right) = \\frac{3}{2} c_{\\parallel}^2 $$\n$$ c_z = c_{\\parallel} \\sqrt{\\frac{3}{2}} \\approx (1.17293 \\times 10^5\\ \\mathrm{m}\\ \\mathrm{s}^{-1}) \\sqrt{\\frac{3}{2}} \\approx 1.43647 \\times 10^5\\ \\mathrm{m}\\ \\mathrm{s}^{-1} $$\nNext, we calculate the grid spacings. The isothermal scale height $H$ is:\n$$ H = \\frac{k_B T}{\\mu m_p g} = \\frac{c_{\\parallel}^2}{g} = \\frac{1.375763 \\times 10^{10}\\ \\mathrm{m}^2\\ \\mathrm{s}^{-2}}{274\\ \\mathrm{m}\\ \\mathrm{s}^{-2}} \\approx 5.02103 \\times 10^7\\ \\mathrm{m} $$\nThe grid spacings $\\Delta z$ and $\\Delta x$ are:\n$$ \\Delta z = \\frac{H}{2500} = \\frac{5.02103 \\times 10^7\\ \\mathrm{m}}{2500} \\approx 2.00841 \\times 10^4\\ \\mathrm{m} $$\n$$ \\Delta x = 10 \\Delta z \\approx 2.00841 \\times 10^5\\ \\mathrm{m} $$\n\n**4. CFL Condition and $\\Delta t_{\\max}$**\nFor an explicit, directionally split scheme, the time step $\\Delta t$ must satisfy the CFL condition for each directional sweep. The fastest signal speed in a given direction is the sum of the fluid velocity magnitude and the characteristic speed.\nFor the $x$-sweep:\n$$ \\Delta t \\le C \\frac{\\Delta x}{|u_x| + c_x} $$\nFor the $z$-sweep:\n$$ \\Delta t \\le C \\frac{\\Delta z}{|u_z| + c_z} $$\nThe maximum stable time step for a full $x$-$z$ update, $\\Delta t_{\\max}$, is limited by the more restrictive of these two conditions:\n$$ \\Delta t_{\\max} = C \\cdot \\min \\left( \\frac{\\Delta x}{|u_x| + c_x}, \\frac{\\Delta z}{|u_z| + c_z} \\right) $$\nWe now substitute the numerical values: $C = 0.5$, $u_x = 4.00 \\times 10^4\\ \\mathrm{m}\\ \\mathrm{s}^{-1}$, $u_z = 0\\ \\mathrm{m}\\ \\mathrm{s}^{-1}$.\nThe time scale for the $x$-sweep is:\n$$ \\tau_x = \\frac{\\Delta x}{|u_x| + c_x} = \\frac{2.00841 \\times 10^5\\ \\mathrm{m}}{4.00 \\times 10^4\\ \\mathrm{m}\\ \\mathrm{s}^{-1} + 1.26690 \\times 10^5\\ \\mathrm{m}\\ \\mathrm{s}^{-1}} = \\frac{2.00841 \\times 10^5\\ \\mathrm{m}}{1.66690 \\times 10^5\\ \\mathrm{m}\\ \\mathrm{s}^{-1}} \\approx 1.20488\\ \\mathrm{s} $$\nThe time scale for the $z$-sweep is:\n$$ \\tau_z = \\frac{\\Delta z}{|u_z| + c_z} = \\frac{2.00841 \\times 10^4\\ \\mathrm{m}}{0\\ \\mathrm{m}\\ \\mathrm{s}^{-1} + 1.43647 \\times 10^5\\ \\mathrm{m}\\ \\mathrm{s}^{-1}} = \\frac{2.00841 \\times 10^4\\ \\mathrm{m}}{1.43647 \\times 10^5\\ \\mathrm{m}\\ \\mathrm{s}^{-1}} \\approx 0.13981\\ \\mathrm{s} $$\nThe minimum of these two time scales is $\\tau_z \\approx 0.13981\\ \\mathrm{s}$. Thus, the maximum stable time step is:\n$$ \\Delta t_{\\max} = C \\cdot \\min(\\tau_x, \\tau_z) = 0.5 \\times 0.13981\\ \\mathrm{s} \\approx 0.069905\\ \\mathrm{s} $$\nRounding to four significant figures as required gives $\\Delta t_{\\max} \\approx 0.06991\\ \\mathrm{s}$.", "answer": "$$\n\\boxed{0.06991}\n$$", "id": "3538584"}, {"introduction": "In radiation hydrodynamics, the CFL condition presents a formidable obstacle, as the true speed of light would force explicit simulations to take impractically small time steps. This advanced exercise introduces a powerful and widely used technique to manage this challenge: the Reduced Speed-of-Light (RSOL) approximation. You will design a local RSOL strategy, derive the modified CFL constraint, and quantify the trade-off between computational gain and fidelity [@problem_id:3538624], tackling a real-world problem at the frontier of computational astrophysics.", "problem": "You are asked to design and analyze a local \"Reduced Speed-of-Light\" (RSOL) strategy for explicit radiation–magnetohydrodynamics (MHD) integration in the context of the Courant–Friedrichs–Lewy (CFL) condition. The objective is to construct a spatially varying effective light speed $c_{\\mathrm{eff}}(x)$ that adapts to radiation–matter coupling strength, then to derive, implement, and quantify how a spatially varying $c_{\\mathrm{eff}}(x)$ modifies the radiation–MHD CFL time step and the global error in radiation-driven winds.\n\nYour derivation and implementation must start from the following fundamental base:\n- The Courant–Friedrichs–Lewy (CFL) condition constrains the explicit time step such that no physical signal travels further than one spatial cell in a single time step.\n- The fastest characteristic signal speeds in radiation–MHD arise from fluid magnetosonic waves and radiation transport modes. In magnetohydrodynamics (MHD), the fast magnetosonic speed combines sound and Alfvénic propagation.\n- Radiation transport exhibits different characteristic speeds in the optically thin (free-streaming) versus optically thick (diffusion) regimes.\n\nYou must derive the CFL constraint for the coupled system from these principles, without using any pre-given \"shortcut\" formula. You must also devise a local RSOL strategy that ensures scientific realism by respecting two constraints:\n1. Convection safety: the reduced light speed should remain sufficiently larger than the fluid signal speed. Introduce a safety factor $\\lambda > 0$ and ensure $c_{\\mathrm{eff}}(x) \\ge \\lambda \\left( |u(x)| + v_{\\mathrm{ms}}(x) \\right)$.\n2. Diffusion-limit consistency: in optically thick cells, the reduced light speed can be safely lowered roughly proportional to the inverse of one plus the optical depth per cell. Use the cell optical depth $\\tau(x) = \\kappa(x)\\,\\rho(x)\\,\\Delta x(x)$ to formulate this.\n\nWith these constraints, define a concrete, local RSOL strategy:\n- For each cell, set\n$$\nc_{\\mathrm{eff}}(x) = \\min\\!\\left( c,\\; \\max\\!\\left( \\lambda \\left( |u(x)| + v_{\\mathrm{ms}}(x) \\right),\\; \\frac{c}{1+\\tau(x)} \\right) \\right).\n$$\nHere $c$ is the true speed of light, $|u(x)|$ is the local fluid speed magnitude, $v_{\\mathrm{ms}}(x)$ is the local fast magnetosonic speed, and $\\tau(x)$ is the local cell optical depth.\n\nRadiation characteristic speed $v_{\\mathrm{rad}}(x)$ must reflect the transport regime:\n- In optically thin cells where $\\tau(x) \\le 1$, take $v_{\\mathrm{rad}}(x) = c_{\\mathrm{eff}}(x)$.\n- In optically thick cells where $\\tau(x) > 1$, take $v_{\\mathrm{rad}}(x) = c_{\\mathrm{eff}}(x)/\\sqrt{3}$ (consistent with the diffusion-limit propagation of the first-order radiation moment system).\n\nMagnetosonic speed is defined from standard MHD:\n- The Alfvén speed is $v_A(x) = \\dfrac{|\\boldsymbol{B}(x)|}{\\sqrt{\\mu_0 \\rho(x)}}$, with vacuum permeability $\\mu_0$.\n- The fast magnetosonic speed is $v_{\\mathrm{ms}}(x) = \\sqrt{ c_s(x)^2 + v_A(x)^2 }$, with sound speed $c_s(x)$.\n\nFrom first principles, derive the explicit time step constraint for the coupled radiation–MHD system in terms of grid spacing and the maximum local signal speed. Your program must compute the minimum allowable time step across all cells, given a specified CFL number $C_{\\mathrm{CFL}}$.\n\nTo quantify the global error in radiation-driven winds introduced by RSOL, adopt a physically motivated relaxation model for radiation–matter momentum coupling over a single cell:\n- Define the true radiation acceleration per cell as $a_i^{\\mathrm{true}} = \\dfrac{\\kappa_i F_i}{c}$, where $F_i$ is the radiation flux.\n- Let the true radiation–matter coupling timescale be $t_{\\mathrm{rad},i}^{\\mathrm{true}} = \\dfrac{1}{\\kappa_i \\rho_i c}$.\n- Let the RSOL-modified coupling timescale be $t_{\\mathrm{rad},i}^{\\mathrm{eff}} = \\dfrac{1}{\\kappa_i \\rho_i c_{\\mathrm{eff},i}}$.\n- Let the fluid crossing (interaction) time per cell be $t_{\\mathrm{dyn},i} = \\dfrac{\\Delta x_i}{|u_i| + v_{\\mathrm{ms},i}}$.\n- Model the effective acceleration realized over the interaction time via a relaxation factor $f = 1 - \\exp\\!\\left( - \\dfrac{t_{\\mathrm{dyn}}}{t_{\\mathrm{rad}}} \\right )$:\n$$\na_i^{\\mathrm{true,eff}} = a_i^{\\mathrm{true}} \\left( 1 - \\exp\\!\\left( - \\frac{t_{\\mathrm{dyn},i}}{t_{\\mathrm{rad},i}^{\\mathrm{true}}} \\right ) \\right),\\quad\na_i^{\\mathrm{RSOL,eff}} = a_i^{\\mathrm{true}} \\left( 1 - \\exp\\!\\left( - \\frac{t_{\\mathrm{dyn},i}}{t_{\\mathrm{rad},i}^{\\mathrm{eff}}} \\right ) \\right).\n$$\nUse a simple work-energy estimate for the terminal wind speed after traversing the domain of length $\\sum_i \\Delta x_i$:\n$$\nv_{\\infty}^{\\mathrm{true}} = \\sqrt{ 2 \\sum_i a_i^{\\mathrm{true,eff}} \\Delta x_i },\\quad\nv_{\\infty}^{\\mathrm{RSOL}} = \\sqrt{ 2 \\sum_i a_i^{\\mathrm{RSOL,eff}} \\Delta x_i }.\n$$\nReport the fractional error\n$$\nE = \\frac{ v_{\\infty}^{\\mathrm{RSOL}} - v_{\\infty}^{\\mathrm{true}} }{ v_{\\infty}^{\\mathrm{true}} }.\n$$\n\nPhysical units:\n- Use International System of Units (SI): distances in meters, speeds in meters per second, time in seconds, mass density in kilograms per cubic meter, magnetic field in Tesla, opacity in square meters per kilogram, radiation flux in watts per square meter.\n- Express all time steps in seconds and wind-speed error as a dimensionless decimal (not a percentage).\n\nTest suite:\nImplement your program for the following three multi-cell domains (each domain has $N = 3$ cells). Constants common to all cases:\n- True speed of light $c = 3.0 \\times 10^{8}\\ \\mathrm{m/s}$.\n- Vacuum permeability $\\mu_0 = 4 \\pi \\times 10^{-7}\\ \\mathrm{N/A^2}$.\n- RSOL safety factor $\\lambda = 10$.\n- CFL number $C_{\\mathrm{CFL}} = 0.4$.\n\nCase $1$ (moderate coupling, mixed optical depths):\n- $\\Delta x = [1.0\\times 10^{9},\\ 1.0\\times 10^{9},\\ 1.0\\times 10^{9}]$.\n- $\\rho = [1.0\\times 10^{-9},\\ 5.0\\times 10^{-10},\\ 2.0\\times 10^{-10}]$.\n- $\\kappa = [0.34,\\ 0.34,\\ 0.34]$.\n- $|\\boldsymbol{B}| = [1.0\\times 10^{-3},\\ 5.0\\times 10^{-4},\\ 2.0\\times 10^{-4}]$.\n- $c_s = [2.0\\times 10^{4},\\ 2.0\\times 10^{4},\\ 2.0\\times 10^{4}]$.\n- $|u| = [5.0\\times 10^{4},\\ 6.0\\times 10^{4},\\ 7.0\\times 10^{4}]$.\n- $F = [1.0\\times 10^{10},\\ 1.0\\times 10^{10},\\ 1.0\\times 10^{10}]$.\n\nCase $2$ (optically thin, higher flow speeds):\n- $\\Delta x = [5.0\\times 10^{9},\\ 5.0\\times 10^{9},\\ 5.0\\times 10^{9}]$.\n- $\\rho = [1.0\\times 10^{-12},\\ 2.0\\times 10^{-12},\\ 1.5\\times 10^{-12}]$.\n- $\\kappa = [0.10,\\ 0.10,\\ 0.10]$.\n- $|\\boldsymbol{B}| = [1.0\\times 10^{-5},\\ 1.0\\times 10^{-5},\\ 1.0\\times 10^{-5}]$.\n- $c_s = [1.0\\times 10^{4},\\ 1.0\\times 10^{4},\\ 1.0\\times 10^{4}]$.\n- $|u| = [1.0\\times 10^{5},\\ 1.2\\times 10^{5},\\ 8.0\\times 10^{4}]$.\n- $F = [5.0\\times 10^{9},\\ 5.0\\times 10^{9},\\ 5.0\\times 10^{9}]$.\n\nCase $3$ (optically thick, strong coupling):\n- $\\Delta x = [1.0\\times 10^{8},\\ 1.0\\times 10^{8},\\ 1.0\\times 10^{8}]$.\n- $\\rho = [1.0\\times 10^{-5},\\ 2.0\\times 10^{-6},\\ 5.0\\times 10^{-6}]$.\n- $\\kappa = [10.0,\\ 10.0,\\ 10.0]$.\n- $|\\boldsymbol{B}| = [1.0\\times 10^{-3},\\ 1.0\\times 10^{-3},\\ 5.0\\times 10^{-4}]$.\n- $c_s = [5.0\\times 10^{3},\\ 5.0\\times 10^{3},\\ 5.0\\times 10^{3}]$.\n- $|u| = [1.0\\times 10^{3},\\ 2.0\\times 10^{3},\\ 1.5\\times 10^{3}]$.\n- $F = [1.0\\times 10^{8},\\ 1.0\\times 10^{8},\\ 1.0\\times 10^{8}]$.\n\nRequired outputs for each case:\n- The CFL-limited time step $\\Delta t$ in seconds (rounded by floating-point arithmetic, not manually rounded).\n- The fractional terminal wind-speed error $E$ as a decimal.\n\nFinal output format:\nYour program should produce a single line of output containing the six results for the three cases in order as a comma-separated list enclosed in square brackets, namely $[\\Delta t_1, E_1, \\Delta t_2, E_2, \\Delta t_3, E_3]$.", "solution": "The problem requires the design and analysis of a Reduced Speed-of-Light (RSOL) approximation within the context of explicit numerical integration for radiation-magnetohydrodynamics (MHD). The primary objectives are to derive the Courant–Friedrichs–Lewy (CFL) time step constraint for this coupled system and to quantify the numerical error introduced by the RSOL method in a model of a radiation-driven wind.\n\n### 1. Derivation of the CFL Time Step Constraint\n\nThe Courant–Friedrichs–Lewy (CFL) condition is a fundamental stability criterion for explicit numerical methods for solving hyperbolic partial differential equations. It mandates that the numerical domain of dependence must contain the physical domain of dependence. For a one-dimensional grid with cell size $\\Delta x$, this translates to the requirement that the time step $\\Delta t$ must be small enough so that the fastest physical signal does not propagate more than one grid cell in a single step. This is expressed as:\n$$\n\\Delta t \\le C_{\\mathrm{CFL}} \\frac{\\Delta x}{v_{\\text{signal, max}}}\n$$\nwhere $C_{\\mathrm{CFL}} \\le 1$ is the CFL number, a safety factor, and $v_{\\text{signal, max}}$ is the maximum signal speed present in the system.\n\nIn a coupled radiation-MHD system, signals propagate through two primary channels: the fluid (MHD waves) and the radiation field. The overall maximum signal speed in a given grid cell is the maximum of the speeds from these two channels.\n\nFor a system with multiple grid cells, indexed by $i$, the stability of the entire domain requires that the CFL condition is met in every cell. Consequently, the global time step is limited by the cell that requires the smallest time step, i.e., the cell where the ratio of cell size to maximum signal speed is minimal.\nThe maximum signal speed in the lab frame for the fluid component in cell $i$ is the sum of the bulk fluid velocity magnitude $|u_i|$ and the fastest MHD wave speed, the fast magnetosonic speed $v_{\\mathrm{ms},i}$.\n$$\nv_{\\text{fluid}, i} = |u_i| + v_{\\mathrm{ms}, i}\n$$\nThe fast magnetosonic speed $v_{\\mathrm{ms},i}$ is given by the combination of the sound speed $c_{s,i}$ and the Alfvén speed $v_{A,i}$:\n$$\nv_{\\mathrm{ms},i} = \\sqrt{c_{s,i}^2 + v_{A,i}^2}\n$$\nwhere the Alfvén speed is defined as:\n$$\nv_{A,i} = \\frac{|\\boldsymbol{B}_i|}{\\sqrt{\\mu_0 \\rho_i}}\n$$\nHere, $|\\boldsymbol{B}_i|$ is the magnetic field strength, $\\rho_i$ is the mass density, and $\\mu_0$ is the vacuum permeability.\n\nThe signal speed of the radiation component, $v_{\\mathrm{rad},i}$, depends on the local optical depth of the medium. The problem specifies a model where this speed is also a function of the effective speed of light, $c_{\\mathrm{eff},i}$:\n- In optically thin regions ($\\tau_i \\le 1$): $v_{\\mathrm{rad},i} = c_{\\mathrm{eff},i}$ (free-streaming).\n- In optically thick regions ($\\tau_i > 1$): $v_{\\mathrm{rad},i} = c_{\\mathrm{eff},i} / \\sqrt{3}$ (diffusive propagation, consistent with M1 moment closure).\n\nThe cell optical depth $\\tau_i$ is given by $\\tau_i = \\kappa_i \\rho_i \\Delta x_i$, where $\\kappa_i$ is the opacity.\n\nThe local effective speed of light, $c_{\\mathrm{eff},i}$, is constructed to adapt to local conditions while maintaining physical realism. It is defined as:\n$$\nc_{\\mathrm{eff},i} = \\min\\!\\left( c,\\; \\max\\!\\left( \\lambda \\left( |u_i| + v_{\\mathrm{ms},i} \\right),\\; \\frac{c}{1+\\tau_i} \\right) \\right)\n$$\nThis formulation ensures $c_{\\mathrm{eff},i}$ does not fall below a multiple $\\lambda$ of the fluid characteristic speed (convection safety) and is reduced in optically thick regions, while never exceeding the true speed of light $c$.\n\nThe maximum total signal speed in cell $i$, $v_{\\max, i}$, is thus:\n$$\nv_{\\max,i} = \\max(v_{\\text{fluid}, i}, v_{\\mathrm{rad},i})\n$$\nThe global time step for the entire computational domain is constrained by the minimum of all local time step limits:\n$$\n\\Delta t = C_{\\mathrm{CFL}} \\min_{i} \\left( \\frac{\\Delta x_i}{v_{\\max,i}} \\right)\n$$\n\n### 2. Quantification of RSOL-Induced Error\n\nThe RSOL approximation introduces errors primarily by altering the timescale of radiation-matter coupling. The problem provides a physically motivated model to estimate this error for a radiation-driven wind.\n\nThe true radiation acceleration is $a_i^{\\text{true}} = \\frac{\\kappa_i F_i}{c}$, where $F_i$ is the radiation flux. This acceleration is imparted to the matter over a coupling timescale. The true coupling timescale is $t_{\\text{rad},i}^{\\text{true}} = \\frac{1}{\\kappa_i \\rho_i c}$. With RSOL, the effective speed of light $c_{\\mathrm{eff},i}$ replaces $c$, leading to a modified, shorter coupling timescale: $t_{\\text{rad},i}^{\\text{eff}} = \\frac{1}{\\kappa_i \\rho_i c_{\\mathrm{eff},i}}$.\n\nThe model assumes that the actual momentum exchanged during the time a fluid parcel crosses a cell, $t_{\\text{dyn},i} = \\frac{\\Delta x_i}{|u_i| + v_{\\mathrm{ms},i}}$, follows a relaxation process. The fraction of the maximum possible momentum transfer achieved is given by $f = 1 - \\exp(-t_{\\text{dyn}} / t_{\\text{rad}})$. This leads to an effective acceleration imparted in each cell:\n- True system: $a_i^{\\text{true,eff}} = a_i^{\\text{true}} \\left( 1 - \\exp\\left( - \\frac{t_{\\text{dyn},i}}{t_{\\text{rad},i}^{\\text{true}}} \\right) \\right)$\n- RSOL system: $a_i^{\\text{RSOL,eff}} = a_i^{\\text{true}} \\left( 1 - \\exp\\left( - \\frac{t_{\\text{dyn},i}}{t_{\\text{rad},i}^{\\text{eff}}} \\right) \\right)$\n\nSince $c_{\\mathrm{eff},i} \\le c$, we have $t_{\\text{rad},i}^{\\text{eff}} \\ge t_{\\text{rad},i}^{\\text{true}}$. The argument of the exponential becomes more negative (or stays the same) with RSOL: $-t_{\\text{dyn},i} / t_{\\text{rad},i}^{\\text{eff}} \\le -t_{\\text{dyn},i} / t_{\\text{rad},i}^{\\text{true}}$. This implies $a_i^{\\text{RSOL,eff}} \\ge a_i^{\\text{true,eff}}$.\n\nThe terminal wind speed $v_{\\infty}$ is estimated using the work-energy theorem, assuming the wind starts from rest and is accelerated over the entire domain:\n$$\n\\frac{1}{2} v_{\\infty}^2 = \\sum_i (\\text{acceleration in cell } i) \\times (\\text{distance } \\Delta x_i)\n$$\nThis gives:\n$$\nv_{\\infty}^{\\text{true}} = \\sqrt{ 2 \\sum_i a_i^{\\text{true,eff}} \\Delta x_i } \\quad \\text{and} \\quad v_{\\infty}^{\\text{RSOL}} = \\sqrt{ 2 \\sum_i a_i^{\\text{RSOL,eff}} \\Delta x_i }\n$$\nThe fractional error $E$ in the terminal wind speed due to the RSOL approximation is then:\n$$\nE = \\frac{ v_{\\infty}^{\\text{RSOL}} - v_{\\infty}^{\\text{true}} }{ v_{\\infty}^{\\text{true}} }\n$$\n\n### 3. Computational Procedure\n\nFor each test case, the following steps are performed:\n1.  For each cell $i=1, \\dots, N$:\n    a. Calculate the Alfvén speed $v_{A,i}$ and the fast magnetosonic speed $v_{\\mathrm{ms},i}$.\n    b. Calculate the cell optical depth $\\tau_i$.\n    c. Determine the effective speed of light $c_{\\mathrm{eff},i}$ using the RSOL formula.\n    d. Determine the radiation characteristic speed $v_{\\mathrm{rad},i}$ based on $\\tau_i$.\n    e. Compute the maximum local signal speed $v_{\\max,i} = \\max(|u_i| + v_{\\mathrm{ms},i}, v_{\\mathrm{rad},i})$.\n    f. Calculate the local time step limit $\\Delta t_{\\text{limit},i} = \\Delta x_i / v_{\\max,i}$.\n    g. For the error analysis, calculate $t_{\\text{dyn},i}$, $a_i^{\\text{true,eff}}$, and $a_i^{\\text{RSOL,eff}}$.\n\n2.  Compute the global CFL time step: $\\Delta t = C_{\\mathrm{CFL}} \\min_i (\\Delta t_{\\text{limit},i})$.\n\n3.  Compute the total work-energy terms $\\sum_i a_i^{\\text{true,eff}} \\Delta x_i$ and $\\sum_i a_i^{\\text{RSOL,eff}} \\Delta x_i$.\n\n4.  Calculate the terminal velocities $v_{\\infty}^{\\text{true}}$ and $v_{\\infty}^{\\text{RSOL}}$.\n\n5.  Calculate the final fractional error $E$.\n\nThis procedure is implemented below for the three specified test cases.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for all test cases and print the results.\n    \"\"\"\n    # Define constants common to all cases\n    C = 3.0e8  # True speed of light in m/s\n    MU_0 = 4 * np.pi * 1.0e-7  # Vacuum permeability in N/A^2\n    LAMBDA = 10.0  # RSOL safety factor\n    C_CFL = 0.4  # CFL number\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1 (moderate coupling, mixed optical depths)\n        {\n            \"dx\": np.array([1.0e9, 1.0e9, 1.0e9]),\n            \"rho\": np.array([1.0e-9, 5.0e-10, 2.0e-10]),\n            \"kappa\": np.array([0.34, 0.34, 0.34]),\n            \"B\": np.array([1.0e-3, 5.0e-4, 2.0e-4]),\n            \"cs\": np.array([2.0e4, 2.0e4, 2.0e4]),\n            \"u\": np.array([5.0e4, 6.0e4, 7.0e4]),\n            \"F\": np.array([1.0e10, 1.0e10, 1.0e10]),\n        },\n        # Case 2 (optically thin, higher flow speeds)\n        {\n            \"dx\": np.array([5.0e9, 5.0e9, 5.0e9]),\n            \"rho\": np.array([1.0e-12, 2.0e-12, 1.5e-12]),\n            \"kappa\": np.array([0.10, 0.10, 0.10]),\n            \"B\": np.array([1.0e-5, 1.0e-5, 1.0e-5]),\n            \"cs\": np.array([1.0e4, 1.0e4, 1.0e4]),\n            \"u\": np.array([1.0e5, 1.2e5, 8.0e4]),\n            \"F\": np.array([5.0e9, 5.0e9, 5.0e9]),\n        },\n        # Case 3 (optically thick, strong coupling)\n        {\n            \"dx\": np.array([1.0e8, 1.0e8, 1.0e8]),\n            \"rho\": np.array([1.0e-5, 2.0e-6, 5.0e-6]),\n            \"kappa\": np.array([10.0, 10.0, 10.0]),\n            \"B\": np.array([1.0e-3, 1.0e-3, 5.0e-4]),\n            \"cs\": np.array([5.0e3, 5.0e3, 5.0e3]),\n            \"u\": np.array([1.0e3, 2.0e3, 1.5e3]),\n            \"F\": np.array([1.0e8, 1.0e8, 1.0e8]),\n        },\n    ]\n\n    results = []\n    for case_data in test_cases:\n        dt, E = calculate_case(case_data, C, MU_0, LAMBDA, C_CFL)\n        results.extend([dt, E])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\ndef calculate_case(data, c, mu_0, lambda_r, c_cfl):\n    \"\"\"\n    Calculates the time step and error for a single test case.\n    \n    Args:\n        data (dict): A dictionary containing the physical parameters for the case.\n        c (float): Speed of light.\n        mu_0 (float): Vacuum permeability.\n        lambda_r (float): RSOL safety factor.\n        c_cfl (float): CFL number.\n        \n    Returns:\n        tuple: A tuple containing (time_step, error).\n    \"\"\"\n    # Unpack data for clarity\n    dx = data[\"dx\"]\n    rho = data[\"rho\"]\n    kappa = data[\"kappa\"]\n    B = data[\"B\"]\n    cs = data[\"cs\"]\n    u = data[\"u\"]\n    F = data[\"F\"]\n\n    # --- Part 1: Calculate CFL Time Step ---\n\n    # 1. Calculate MHD speeds for all cells\n    vA = B / np.sqrt(mu_0 * rho)\n    v_ms = np.sqrt(cs**2 + vA**2)\n\n    # 2. Calculate optical depth\n    tau = kappa * rho * dx\n\n    # 3. Calculate effective speed of light c_eff\n    v_fluid_signal = u + v_ms\n    c_conv_safe = lambda_r * v_fluid_signal\n    c_diff_lim = c / (1.0 + tau)\n    c_eff = np.minimum(c, np.maximum(c_conv_safe, c_diff_lim))\n\n    # 4. Calculate radiation characteristic speed v_rad\n    v_rad = np.where(tau <= 1, c_eff, c_eff / np.sqrt(3))\n\n    # 5. Calculate maximum local signal speed v_max\n    v_max = np.maximum(v_fluid_signal, v_rad)\n\n    # 6. Calculate local time step limits and find the minimum\n    dt_limits = dx / v_max\n    min_dt_limit = np.min(dt_limits)\n\n    # 7. Apply CFL number to get the final time step\n    delta_t = c_cfl * min_dt_limit\n\n    # --- Part 2: Calculate Fractional Error ---\n    \n    # 1. Calculate various timescales and accelerations\n    t_dyn = dx / v_fluid_signal\n    a_true = (kappa * F) / c\n    \n    t_rad_true = 1.0 / (kappa * rho * c)\n    t_rad_eff = 1.0 / (kappa * rho * c_eff)\n\n    # 2. Calculate effective accelerations using the relaxation model\n    a_true_eff = a_true * (1.0 - np.exp(-t_dyn / t_rad_true))\n    a_rsol_eff = a_true * (1.0 - np.exp(-t_dyn / t_rad_eff))\n    \n    # 3. Calculate total work done (proportional to v_inf^2 / 2)\n    work_true = np.sum(a_true_eff * dx)\n    work_rsol = np.sum(a_rsol_eff * dx)\n\n    # 4. Calculate terminal velocities\n    v_inf_true = np.sqrt(2 * work_true)\n    v_inf_rsol = np.sqrt(2 * work_rsol)\n\n    # 5. Calculate fractional error\n    # Handle case where v_inf_true is zero to avoid division by zero\n    if v_inf_true == 0:\n        error = 0.0 if v_inf_rsol == 0.0 else np.inf\n    else:\n        error = (v_inf_rsol - v_inf_true) / v_inf_true\n\n    return delta_t, error\n\nsolve()\n```", "id": "3538624"}]}