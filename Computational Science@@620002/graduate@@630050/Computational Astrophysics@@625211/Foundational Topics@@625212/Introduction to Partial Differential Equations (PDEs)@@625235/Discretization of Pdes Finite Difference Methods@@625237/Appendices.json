{"hands_on_practices": [{"introduction": "Before a numerical scheme can be trusted, its stability must be rigorously established. This practice tackles the foundational concept of numerical stability through the lens of the Forward-Time, Centered-Space (FTCS) scheme for the diffusion equation, a canonical problem in computational physics. By performing a von Neumann stability analysis from first principles, you will derive the famous Courant-Friedrichs-Lewy (CFL) condition that governs the maximum allowable time step for this explicit method [@problem_id:3508817].", "problem": "In modeling electron thermal conduction in an optically thick accretion disk annulus, consider the scalar diffusion of temperature in one spatial dimension with periodic boundary conditions. On a uniform grid with spacing $\\Delta x$ and time step $\\Delta t$, an explicit forward-time, centered-space (FTCS) finite difference method advances the nodal temperature $u_i^n$ according to\n$$\nu_i^{n+1} \\;=\\; u_i^n \\;+\\; \\mu \\,\\big(u_{i+1}^n \\;-\\; 2\\,u_i^n \\;+\\; u_{i-1}^n\\big),\n$$\nwhere $\\mu \\equiv \\chi\\,\\Delta t/\\Delta x^2$ and $\\chi$ is the thermal diffusivity. Using von Neumann (Fourier) stability analysis from first principles, determine the largest value of the dimensionless diffusion number $\\mu$ for which the scheme is linearly stable for all spatial Fourier modes. Provide your answer as an exact analytic number. No rounding is required, and no physical units should be included in the final answer.", "solution": "The user wants to find the stability criterion for a given finite difference scheme using von Neumann analysis.\n\n### Step 1: Problem Validation\n\n**1.1. Extract Givens:**\n- **Governing Process:** Scalar diffusion of temperature in one spatial dimension, $u_t = \\chi u_{xx}$.\n- **Discretization Scheme:** Explicit Forward-Time, Centered-Space (FTCS).\n- **Update Rule:** $u_i^{n+1} = u_i^n + \\mu (u_{i+1}^n - 2u_i^n + u_{i-1}^n)$.\n- **Variables:** $u_i^n$ is the temperature at spatial grid point $i$ and time step $n$.\n- **Grid:** Uniform spatial spacing $\\Delta x$ and time step $\\Delta t$.\n- **Dimensionless Diffusion Number:** $\\mu \\equiv \\chi \\Delta t / \\Delta x^2$.\n- **Physical Constant:** $\\chi$ is the thermal diffusivity.\n- **Boundary Conditions:** Periodic.\n- **Methodology:** Von Neumann (Fourier) stability analysis from first principles.\n- **Objective:** Determine the largest value of $\\mu$ for which the scheme is linearly stable for all spatial Fourier modes.\n\n**1.2. Validate Using Extracted Givens:**\n- **Scientific Grounding:** The problem is a canonical example in the study of numerical solutions to partial differential equations (PDEs), specifically the heat/diffusion equation. The FTCS scheme is a standard (though conditionally stable) method, and von Neumann analysis is the appropriate tool for analyzing its stability under periodic boundary conditions. The physical context of accretion disks is a valid application area for such models. The problem is scientifically and mathematically sound.\n- **Well-Posedness:** The problem is well-posed. It asks for a specific, uniquely determinable value (the stability limit of $\\mu$) using a specified, standard mathematical procedure.\n- **Objectivity:** The problem is stated in clear, objective, and unambiguous technical language.\n- **Completeness and Consistency:** The problem provides all necessary information: the discretization scheme, the definition of the parameter $\\mu$, the required analysis method, and the specific property to be determined. There are no contradictions.\n\n**1.3. Verdict and Action:**\nThe problem is valid. It is a standard, well-posed problem in computational physics. A solution will be derived.\n\n### Step 2: Solution Derivation\n\nThe analysis proceeds by applying the von Neumann stability method to the given FTCS finite difference equation. The core idea is to decompose the numerical solution at a given time step into its spatial Fourier modes and to determine the condition under which the amplitude of every mode does not grow in subsequent time steps.\n\nLet the nodal temperature $u_i^n$ at grid point $x_i = i\\Delta x$ and time $t_n = n\\Delta t$ be represented by a single generic Fourier mode. Due to the linearity of the difference equation, the behavior of a full Fourier series solution is determined by the behavior of its individual modes. A generic mode has the form:\n$$\nu_i^n = A(k)^n e^{I k x_i} = A^n e^{I k i \\Delta x}\n$$\nwhere $k$ is the spatial wavenumber, $I \\equiv \\sqrt{-1}$ is the imaginary unit, and $A(k)$ is the amplification factor for the mode with wavenumber $k$. For simplicity, we denote $A(k)$ as $A$. A new amplitude $A^{n+1}$ is obtained at the next time step. For the scheme to be stable, the magnitude of the amplification factor must not exceed unity for any wavenumber $k$. This is the von Neumann stability condition:\n$$\n|A| = \\left|\\frac{A^{n+1}}{A^n}\\right| \\le 1 \\quad \\forall k\n$$\n\nWe substitute the Fourier mode representation into the given FTCS scheme:\n$$\nu_i^{n+1} = u_i^n + \\mu (u_{i+1}^n - 2u_i^n + u_{i-1}^n)\n$$\nSubstituting $u_j^m = A^m e^{I k j \\Delta x}$ for $(m,j) \\in \\{(n, i-1), (n, i), (n, i+1), (n+1, i)\\}$:\n$$\nA^{n+1} e^{I k i \\Delta x} = A^n e^{I k i \\Delta x} + \\mu \\left( A^n e^{I k (i+1) \\Delta x} - 2 A^n e^{I k i \\Delta x} + A^n e^{I k (i-1) \\Delta x} \\right)\n$$\nWe can divide the entire equation by the non-zero common factor $A^n e^{I k i \\Delta x}$ to find the amplification factor $A = A^{n+1}/A^n$:\n$$\nA = 1 + \\mu \\left( e^{I k \\Delta x} - 2 + e^{-I k \\Delta x} \\right)\n$$\nUsing Euler's identity, $e^{I\\theta} + e^{-I\\theta} = 2\\cos(\\theta)$, we can simplify the term in the parentheses:\n$$\ne^{I k \\Delta x} + e^{-I k \\Delta x} = 2\\cos(k \\Delta x)\n$$\nSubstituting this back into the expression for $A$:\n$$\nA = 1 + \\mu \\left( 2\\cos(k \\Delta x) - 2 \\right) = 1 - 2\\mu \\left( 1 - \\cos(k \\Delta x) \\right)\n$$\nTo further simplify, we use the half-angle trigonometric identity $1 - \\cos(\\theta) = 2\\sin^2(\\theta/2)$:\n$$\nA = 1 - 2\\mu \\left( 2\\sin^2\\left(\\frac{k \\Delta x}{2}\\right) \\right) = 1 - 4\\mu \\sin^2\\left(\\frac{k \\Delta x}{2}\\right)\n$$\nThe amplification factor $A$ is a purely real quantity. Therefore, the stability condition $|A| \\le 1$ translates to the inequalities:\n$$\n-1 \\le A \\le 1\n$$\nLet's analyze these two inequalities separately.\n\nFirst, the upper bound:\n$$\nA \\le 1 \\implies 1 - 4\\mu \\sin^2\\left(\\frac{k \\Delta x}{2}\\right) \\le 1\n$$\n$$\n-4\\mu \\sin^2\\left(\\frac{k \\Delta x}{2}\\right) \\le 0\n$$\nSince $\\mu \\equiv \\chi \\Delta t / \\Delta x^2$ must be non-negative (as physical diffusivity $\\chi$, time step $\\Delta t$, and grid spacing $\\Delta x$ are non-negative), and $\\sin^2(\\cdot)$ is always non-negative, this inequality $A \\le 1$ is unconditionally satisfied. This is expected for a diffusive process, which should not amplify any mode.\n\nSecond, the lower bound, which imposes the crucial constraint:\n$$\nA \\ge -1 \\implies 1 - 4\\mu \\sin^2\\left(\\frac{k \\Delta x}{2}\\right) \\ge -1\n$$\n$$\n2 \\ge 4\\mu \\sin^2\\left(\\frac{k \\Delta x}{2}\\right)\n$$\n$$\n\\mu \\sin^2\\left(\\frac{k \\Delta x}{2}\\right) \\le \\frac{1}{2}\n$$\nThis condition must hold for all possible wavenumbers $k$ that can be represented on the grid. The stability of the scheme is limited by the \"worst-case\" mode, which is the mode that maximizes the term $\\sin^2(k \\Delta x / 2)$, thereby making the constraint on $\\mu$ most stringent. The range of the $\\sin^2$ function is $[0, 1]$. The maximum value is $1$. This maximum occurs for the highest frequency (most oscillatory) mode representable on the grid, which corresponds to $k \\Delta x = \\pi$. This is the Nyquist frequency, with a wavelength of $2\\Delta x$.\n\nTo ensure stability for all modes, we must satisfy the inequality for this worst-case scenario:\n$$\n\\max\\left[\\sin^2\\left(\\frac{k \\Delta x}{2}\\right)\\right] = 1\n$$\nSubstituting this maximum value into the stability inequality:\n$$\n\\mu \\cdot 1 \\le \\frac{1}{2}\n$$\n$$\n\\mu \\le \\frac{1}{2}\n$$\nThis is the famous Courant-Friedrichs-Lewy (CFL) condition for the $1$D diffusion equation solved with the FTCS scheme. The scheme is stable if and only if $\\mu \\le 1/2$. The problem asks for the largest value of $\\mu$ for which the scheme is stable. This corresponds to the equality in the condition.\n\nThus, the largest value of the dimensionless diffusion number $\\mu$ is $1/2$.", "answer": "$$\n\\boxed{\\frac{1}{2}}\n$$", "id": "3508817"}, {"introduction": "While periodic domains are convenient for theoretical analysis, most astrophysical problems involve physical boundaries that require careful treatment. This exercise focuses on the practical and crucial task of implementing a Neumann (zero-derivative) boundary condition without degrading the scheme's overall accuracy. Using Taylor series analysis, you will derive the value for a 'ghost cell' that correctly enforces the physical constraint, a fundamental technique in finite difference and finite volume methods [@problem_id:3508873].", "problem": "Consider a one-dimensional slab model for the midplane of an astrophysical accretion disk with reflective symmetry at the midplane, such that the physical field $u(x,t)$ satisfies the Neumann boundary condition $\\partial_{x} u(0,t) = 0$ for all $t$. You discretize a partial differential equation (PDE) governing the evolution of $u$ on a uniform spatial grid with spacing $\\Delta x$, placing nodal unknowns $u_{i}(t)$ at locations $x_{i} = i\\,\\Delta x$ for integer $i \\ge 0$. To construct second-order accurate centered finite-difference stencils near the boundary, you introduce a single ghost node at $x_{-1} = -\\Delta x$ with value $u_{-1}(t)$. The ghost value must be chosen so that, when used in standard second-order centered stencils, the discrete boundary treatment is consistent with the continuous Neumann boundary condition and yields overall second-order accuracy in space near $x=0$.\n\nStarting from the continuous Neumann boundary condition $\\partial_{x} u(0,t) = 0$ and using Taylor expansions about $x=0$ together with smoothness assumptions appropriate for astrophysical transport problems (e.g., $u$ is at least three times continuously differentiable in $x$ near $x=0$), derive the mirrored-stencil ghost value that achieves second-order accuracy. Your derivation must proceed from first principles and must not rely on any pre-stated discrete boundary formula. Express your final answer as a closed-form symbolic expression for $u_{-1}(t)$ in terms of interior nodal values. No numerical rounding is required, and no physical units should be included in your final expression.", "solution": "The problem requires the derivation of a value for a ghost node, denoted $u_{-1}(t)$, for a one-dimensional numerical grid. This ghost value must be chosen such that it facilitates a second-order accurate finite-difference implementation of the Neumann boundary condition $\\partial_{x} u(0,t) = 0$ at the grid point $x_0=0$. The derivation must proceed from first principles, utilizing Taylor series expansions.\n\nThe spatial grid is defined by points $x_i = i\\,\\Delta x$ for integers $i \\ge 0$. The boundary is located at the node $x_0 = 0$. The ghost node is located at $x_{-1} = -\\Delta x$. The value of the physical field at these nodes at a given time $t$ is denoted by $u_i(t) = u(x_i, t)$. For conciseness in the derivation of the spatial differencing scheme, the explicit dependence on time $t$ will be suppressed, writing $u_i$ for $u_i(t)$.\n\nOur starting point is the continuous boundary condition given in the problem statement:\n$$ \\left. \\frac{\\partial u}{\\partial x} \\right|_{x=0} = 0 $$\nThe goal is to define $u_{-1}$ such that a discrete representation of this condition is satisfied to second-order accuracy in the grid spacing $\\Delta x$. The problem specifies the use of a standard second-order centered difference stencil to approximate the derivative at $x_0 = 0$. This stencil involves the points $x_1 = \\Delta x$ and the ghost point $x_{-1} = -\\Delta x$.\n\nThe derivation proceeds by analyzing the truncation error of this centered difference formula using Taylor series. The problem states that the function $u(x,t)$ is at least three times continuously differentiable with respect to $x$ near $x=0$. Let us expand $u(x)$ in a Taylor series around the point $x=0$.\n$$ u(x) = u(0) + x \\left. \\frac{\\partial u}{\\partial x} \\right|_{x=0} + \\frac{x^2}{2!} \\left. \\frac{\\partial^2 u}{\\partial x^2} \\right|_{x=0} + \\frac{x^3}{3!} \\left. \\frac{\\partial^3 u}{\\partial x^3} \\right|_{x=0} + \\mathcal{O}(x^4) $$\nWe evaluate this expansion at the grid points $x_1 = \\Delta x$ and $x_{-1} = -\\Delta x$.\n\nFor the point $x_1 = \\Delta x$, we have $u_1 = u(\\Delta x)$:\n$$ u_1 = u_0 + \\Delta x \\left. \\frac{\\partial u}{\\partial x} \\right|_{x=0} + \\frac{(\\Delta x)^2}{2} \\left. \\frac{\\partial^2 u}{\\partial x^2} \\right|_{x=0} + \\frac{(\\Delta x)^3}{6} \\left. \\frac{\\partial^3 u}{\\partial x^3} \\right|_{x=0} + \\mathcal{O}((\\Delta x)^4) $$\n\nFor the point $x_{-1} = -\\Delta x$, we have $u_{-1} = u(-\\Delta x)$:\n$$ u_{-1} = u_0 - \\Delta x \\left. \\frac{\\partial u}{\\partial x} \\right|_{x=0} + \\frac{(\\Delta x)^2}{2} \\left. \\frac{\\partial^2 u}{\\partial x^2} \\right|_{x=0} - \\frac{(\\Delta x)^3}{6} \\left. \\frac{\\partial^3 u}{\\partial x^3} \\right|_{x=0} + \\mathcal{O}((\\Delta x)^4) $$\nIt is important to recognize that $u_{-1}$ in the expression above represents the analytical value of the function at $x = -\\Delta x$. The ghost node value we seek to define in our numerical scheme is intended to be an approximation to this.\n\nThe standard second-order centered difference formula for the first derivative at $x_0=0$ is given by $\\frac{u_1 - u_{-1}}{2 \\Delta x}$. To examine its accuracy, we substitute the Taylor expansions. We compute the difference $u_1 - u_{-1}$ by subtracting the second expansion from the first:\n$$ u_1 - u_{-1} = \\left( u_0 - u_0 \\right) + \\left( \\Delta x \\left. \\frac{\\partial u}{\\partial x} \\right|_{x=0} - \\left(-\\Delta x \\left. \\frac{\\partial u}{\\partial x} \\right|_{x=0}\\right) \\right) + \\left( \\frac{(\\Delta x)^2}{2} \\left. \\frac{\\partial^2 u}{\\partial x^2} \\right|_{x=0} - \\frac{(\\Delta x)^2}{2} \\left. \\frac{\\partial^2 u}{\\partial x^2} \\right|_{x=0} \\right) + \\left( \\frac{(\\Delta x)^3}{6} \\left. \\frac{\\partial^3 u}{\\partial x^3} \\right|_{x=0} - \\left(-\\frac{(\\Delta x)^3}{6} \\left. \\frac{\\partial^3 u}{\\partial x^3} \\right|_{x=0}\\right) \\right) + \\mathcal{O}((\\Delta x)^5) $$\nThe terms involving even powers of $\\Delta x$ cancel, while terms involving odd powers add. This simplifies to:\n$$ u_1 - u_{-1} = 2\\Delta x \\left. \\frac{\\partial u}{\\partial x} \\right|_{x=0} + \\frac{(\\Delta x)^3}{3} \\left. \\frac{\\partial^3 u}{\\partial x^3} \\right|_{x=0} + \\mathcal{O}((\\Delta x)^5) $$\nNow, we divide by $2 \\Delta x$ to form the finite difference approximation of the derivative:\n$$ \\frac{u_1 - u_{-1}}{2 \\Delta x} = \\left. \\frac{\\partial u}{\\partial x} \\right|_{x=0} + \\frac{(\\Delta x)^2}{6} \\left. \\frac{\\partial^3 u}{\\partial x^3} \\right|_{x=0} + \\mathcal{O}((\\Delta x)^4) $$\nThis relationship shows that the centered difference formula $\\frac{u_1 - u_{-1}}{2 \\Delta x}$ approximates the true derivative $\\left. \\frac{\\partial u}{\\partial x} \\right|_{x=0}$ with a leading error term of order $(\\Delta x)^2$. The approximation is therefore second-order accurate. The truncation error, $T$, is the difference between the discrete operator and the continuous operator:\n$$ T = \\frac{u_1 - u_{-1}}{2 \\Delta x} - \\left. \\frac{\\partial u}{\\partial x} \\right|_{x=0} = \\frac{(\\Delta x)^2}{6} \\left. \\frac{\\partial^3 u}{\\partial x^3} \\right|_{x=0} + \\mathcal{O}((\\Delta x)^4) = \\mathcal{O}((\\Delta x)^2) $$\nTo implement the Neumann boundary condition $\\left. \\frac{\\partial u}{\\partial x} \\right|_{x=0} = 0$ in a way that is consistent with the second-order accuracy of the numerical method, we must enforce its discrete analogue. The standard procedure is to set the second-order accurate discrete approximation of the derivative equal to zero. This ensures that the error incurred in satisfying the boundary condition is of the same order as the truncation error of the interior scheme.\n\nTherefore, we impose the algebraic condition:\n$$ \\frac{u_1 - u_{-1}}{2 \\Delta x} = 0 $$\nThis equation defines the value of the ghost node $u_{-1}$ in our algorithm. Solving for $u_{-1}$ yields the simple relation:\n$$ u_1 - u_{-1} = 0 $$\n$$ u_{-1} = u_1 $$\nReintroducing the time dependence, the final expression for the ghost node value is:\n$$ u_{-1}(t) = u_1(t) $$\nThis result is referred to as a \"mirrored-stencil\" or \"even-symmetry\" condition. It implies that the value at the ghost node is a mirror image of the value at the first interior node $x_1$ across the boundary plane $x=0$. This corresponds to imposing an even symmetry condition on the discrete solution profile around the boundary, $u_{-i} = u_i$ for $i=1$, which is the discrete analogue of the property of an even function $u(-x)=u(x)$ whose derivative at $x=0$ is zero. By defining $u_{-1}(t) = u_1(t)$, when a centered difference stencil for another operator, such as the second derivative $\\frac{u_{i+1} - 2u_i + u_{i-1}}{(\\Delta x)^2}$, is applied at the boundary point $i=0$, it becomes $\\frac{u_1 - 2u_0 + u_{-1}}{(\\Delta x)^2} = \\frac{2u_1 - 2u_0}{(\\Delta x)^2}$. This allows the use of a uniform stencil structure throughout the computational domain, which is the primary motivation for the ghost node method.\n\nThe derivation from first principles using Taylor series thus rigorously establishes that setting $u_{-1}(t) = u_1(t)$ provides a second-order accurate implementation of the zero-derivative Neumann boundary condition.", "answer": "$$\\boxed{u_{-1}(t) = u_1(t)}$$", "id": "3508873"}, {"introduction": "Moving from diffusive to advective phenomena, we encounter the challenge of numerically transporting sharp features, a ubiquitous task in simulating astrophysical fluids and plasmas. High-order schemes often produce non-physical oscillations near discontinuities, a problem addressed by slope limiters. This hands-on coding exercise allows you to implement and compare an unlimited second-order scheme with a robust minmod-limited scheme, directly observing how limiters are essential for capturing crisp, physically meaningful solutions [@problem_id:3508820].", "problem": "Consider the one-dimensional linear advection equation in conservation form,\n$$\n\\frac{\\partial u}{\\partial t} + a \\frac{\\partial u}{\\partial x} = 0,\n$$\non a periodic domain of length $L$, where $a$ is a constant advection speed. The initial condition is a square pulse of amplitude $1$ and width $w$ centered at $x_0$, defined on a uniform grid of $N$ cells. The boundary conditions are periodic for all times. Your task is to discretize this problem using finite difference methods to assess numerical overshoot near discontinuities.\n\nStarting from this partial differential equation and the conservation principle, implement a second-order spatial discretization based on piecewise linear reconstruction of cell-centered values to left interface states and an upwind numerical flux for $a0$. Use a Strong Stability Preserving (SSP) Runge–Kutta time integrator of order two for temporal discretization. Compare two reconstruction strategies:\n- A \"no limiter\" reconstruction using an unlimited centered slope.\n- A minmod-limited reconstruction using the minmod slope limiter, which reduces spurious oscillations.\n\nDefine the Courant–Friedrichs–Lewy (CFL) number $C$ by\n$$\nC = \\frac{a \\,\\Delta t}{\\Delta x},\n$$\nand choose the time step $\\Delta t$ to satisfy $C \\le C_{\\text{target}}$, by setting the number of time steps $n$ to the smallest integer such that $n \\,\\Delta t \\ge T$ with $\\Delta t \\le C_{\\text{target}} \\Delta x / a$, and then taking $\\Delta t = T/n$. Use periodic indexing for spatial differences and fluxes.\n\nFor each test case below, advect the square pulse for a duration $T$ and measure the maximum Gibbs overshoot amplitude defined as\n$$\nA = \\max_i u_i(T) - 1,\n$$\nreported as a nonnegative float (use $A=0$ if $\\max_i u_i(T)\\le 1$). Compute $A$ for both reconstructions: first with no limiter, then with the minmod limiter. The reconstruction from cell center $u_i$ to the left state at interface $x_{i+1/2}$ should be of the form $u_{i+1/2}^L = u_i + \\frac{1}{2}\\sigma_i$, where $\\sigma_i$ is the chosen slope. For the minmod limiter, the slope $\\sigma_i$ is given by the elementwise minmod of backward and forward differences, that is,\n$$\n\\operatorname{minmod}(r,s) = \\begin{cases}\n\\operatorname{sign}(r)\\,\\min(|r|,|s|),  \\text{if } r\\,s  0, \\\\\n0,  \\text{otherwise}.\n\\end{cases}\n$$\nThe upwind flux for $a0$ at interface $x_{i+1/2}$ is $F_{i+1/2} = a\\,u_{i+1/2}^L$, and the semi-discrete operator for cell $i$ is\n$$\n\\mathcal{L}(u)_i = -\\frac{F_{i+1/2} - F_{i-1/2}}{\\Delta x}.\n$$\nEvolve with the two-stage SSP Runge–Kutta scheme:\n$$\nu^{(1)} = u^n + \\Delta t\\,\\mathcal{L}(u^n), \\quad\nu^{n+1} = \\frac{1}{2}\\,u^n + \\frac{1}{2}\\,\\left(u^{(1)} + \\Delta t\\,\\mathcal{L}(u^{(1)})\\right).\n$$\n\nUse $a=1$, $L=1$, and $x_0=0.25$ for all tests. Initialize the square pulse as $u(x,0)=1$ for $x \\in [x_0, x_0+w)$ modulo $L$, and $u(x,0)=0$ otherwise.\n\nTest suite parameters $(N, C_{\\text{target}}, w, T)$:\n- Test $1$: $(N=256, C_{\\text{target}}=0.45, w=0.25, T=0.5)$.\n- Test $2$: $(N=128, C_{\\text{target}}=0.95, w=0.10, T=0.5)$.\n- Test $3$: $(N=64, C_{\\text{target}}=0.20, w=0.40, T=0.5)$.\n- Test $4$: $(N=128, C_{\\text{target}}=0.70, w=0.02, T=0.2)$.\n\nYour program should produce a single line of output containing the results as a comma-separated list of pairs, each pair itself a two-element list $[A_{\\text{no limiter}}, A_{\\text{minmod}}]$, aggregated over the four tests in the order above, with six decimal places for each float and no spaces. For example, a valid output format is\n$$\n[[a_{11},a_{12}],[a_{21},a_{22}],[a_{31},a_{32}],[a_{41},a_{42}]],\n$$\nwhere each $a_{ij}$ is a decimal number rounded to six digits after the decimal point.", "solution": "The user has provided a problem statement that requires the numerical solution of the one-dimensional linear advection equation. As per my duties as an exacting professor, I will first validate the problem statement.\n\n### Step 1: Extract Givens\n- **Governing Equation**: The one-dimensional linear advection equation in conservation form, $\\frac{\\partial u}{\\partial t} + a \\frac{\\partial u}{\\partial x} = 0$.\n- **Domain**: A periodic domain of length $L$. The computational grid is uniform with $N$ cells.\n- **Physical Parameters**: $a$ is a constant advection speed. For all tests, $a=1$ and $L=1$.\n- **Initial Condition**: A square pulse of amplitude $1$ and width $w$, starting at $x_0=0.25$. Specifically, $u(x,0)=1$ for $x \\in [x_0, x_0+w)$ modulo $L$, and $u(x,0)=0$ otherwise.\n- **Boundary Conditions**: Periodic for all times.\n- **Numerical Method**: A finite difference method.\n    - **Spatial Discretization**: Second-order piecewise linear reconstruction from cell-centered values to left interface states, combined with an upwind numerical flux for $a0$.\n    - **Reconstruction Strategies**:\n        1. No limiter: an unlimited centered slope.\n        2. Minmod limiter: a slope limited by the `minmod` function.\n    - **Time Discretization**: A two-stage Strong Stability Preserving (SSP) Runge–Kutta scheme.\n- **Time Step Control**: The Courant–Friedrichs–Lewy (CFL) number is $C = \\frac{a \\,\\Delta t}{\\Delta x}$. The time step $\\Delta t$ is chosen to satisfy $C \\le C_{\\text{target}}$. The number of time steps $n$ is the smallest integer such that $n \\,\\Delta t \\ge T$ with $\\Delta t \\le C_{\\text{target}} \\Delta x / a$, followed by setting $\\Delta t = T/n$.\n- **Scheme Formulas**:\n    - **Reconstruction**: The state at the left side of the interface $x_{i+1/2}$ is $u_{i+1/2}^L = u_i + \\frac{1}{2}\\sigma_i$, where $\\sigma_i$ is the slope in cell $i$.\n    - **Minmod Limiter**: $\\operatorname{minmod}(r,s) = \\begin{cases} \\operatorname{sign}(r)\\,\\min(|r|,|s|),  \\text{if } r\\,s  0, \\\\ 0,  \\text{otherwise}. \\end{cases}$ The slope is computed using backward and forward differences as arguments.\n    - **Upwind Flux**: For $a0$, the flux at interface $x_{i+1/2}$ is $F_{i+1/2} = a\\,u_{i+1/2}^L$.\n    - **Semi-discrete Operator**: $\\mathcal{L}(u)_i = -\\frac{F_{i+1/2} - F_{i-1/2}}{\\Delta x}$.\n    - **SSP-RK2 Integrator**:\n        $$u^{(1)} = u^n + \\Delta t\\,\\mathcal{L}(u^n)$$\n        $$u^{n+1} = \\frac{1}{2}\\,u^n + \\frac{1}{2}\\,\\left(u^{(1)} + \\Delta t\\,\\mathcal{L}(u^{(1)})\\right)$$\n- **Output Metric**: The maximum Gibbs overshoot amplitude, $A = \\max_i u_i(T) - 1$, reported as non-negative.\n- **Test Cases**:\n    - Test 1: $(N=256, C_{\\text{target}}=0.45, w=0.25, T=0.5)$.\n    - Test 2: $(N=128, C_{\\text{target}}=0.95, w=0.10, T=0.5)$.\n    - Test 3: $(N=64, C_{\\text{target}}=0.20, w=0.40, T=0.5)$.\n    - Test 4: $(N=128, C_{\\text{target}}=0.70, w=0.02, T=0.2)$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is a classic exercise in computational fluid dynamics, specifically the study of numerical methods for hyperbolic conservation laws.\n- **Scientific/Factual Soundness**: The problem is scientifically sound. The linear advection equation, finite difference methods, piecewise linear reconstruction, slope limiters (minmod), and SSP-RK time integration are all standard, well-established concepts in numerical analysis and computational physics.\n- **Well-Posedness**: The problem is well-posed. The governing PDE with the given initial and boundary conditions has a unique, stable solution. The numerical scheme provided is also well-defined and, with the specified constraints (CFL condition, SSP integrator, minmod limiter), is expected to produce a stable numerical solution. The \"unlimited centered slope\" is understood in context to be the standard second-order centered difference approximation, which is also a well-defined choice (though known to be non-monotone). The instruction to use backward and forward differences for the minmod limiter is also standard, interpreting them as $u_i-u_{i-1}$ and $u_{i+1}-u_i$.\n- **Completeness and Consistency**: The problem provides all necessary parameters, equations, and algorithmic steps. The initial condition description has a slight tension between \"centered at $x_0$\" and \"for $x \\in [x_0, x_0+w)$\", but the latter is a precise mathematical definition that overrides any ambiguity in the former descriptive phrase. All other definitions are clear and consistent.\n- **Objectivity**: The problem is stated in objective, mathematical terms, free of subjective language.\n\n### Step 3: Verdict and Action\nThe problem is **valid**. It is a well-defined, self-contained, and scientifically grounded computational task. I will now proceed with the solution.\n\n### Solution Derivation\n\nThe problem requires us to solve the linear advection equation, a prototype for hyperbolic conservation laws, to analyze the behavior of numerical schemes near discontinuities.\n\n**1. Discretization Framework**\nWe begin by defining the discrete domain. The spatial domain of length $L=1$ is divided into $N$ uniform cells, each of width $\\Delta x = L/N$. The cell centers are located at $x_i = (i+0.5)\\Delta x$ for $i = 0, 1, \\dots, N-1$. The cell interfaces are at $x_{i+1/2} = (i+1)\\Delta x$. The discrete solution at time $t$ is represented by a vector of cell-averaged values, $u(t) = \\{u_0(t), u_1(t), \\dots, u_{N-1}(t)\\}$.\n\nThe initial condition is a square pulse, which we discretize by assigning values to the cell centers. For each cell $i$, we set $u_i(0)=1$ if its center $x_i$ falls within the interval $[x_0, x_0+w)$, and $u_i(0)=0$ otherwise. Given the periodic domain, this interval is treated modulo $L$.\n\nThe time step $\\Delta t$ is determined by the target CFL number $C_{\\text{target}}$. The maximum allowable time step for stability is $\\Delta t_{\\text{max}} = C_{\\text{target}} \\Delta x / a$. To ensure the simulation finishes exactly at time $T$, we calculate the number of steps $n$ as the smallest integer satisfying $n \\ge T/\\Delta t_{\\text{max}}$. This is computed as $n = \\lceil T/\\Delta t_{\\text{max}} \\rceil$. The actual time step used is then $\\Delta t = T/n$. This guarantees that $n$ steps of size $\\Delta t$ cover the total duration $T$ and that the CFL condition $C = a \\Delta t / \\Delta x \\le C_{\\text{target}}$ is satisfied.\n\n**2. Numerical Scheme: Method of Lines**\nWe use the method of lines, which first discretizes the spatial derivatives to obtain a system of ordinary differential equations (ODEs), one for each cell $i$:\n$$\n\\frac{du_i}{dt} = \\mathcal{L}(u)_i\n$$\nThe operator $\\mathcal{L}(u)_i$ is an approximation of $-a \\frac{\\partial u}{\\partial x}$ at a cell center $x_i$. Using the conservation form, we express this as a divergence of numerical fluxes at the cell interfaces:\n$$\n\\mathcal{L}(u)_i = -\\frac{F_{i+1/2} - F_{i-1/2}}{\\Delta x}\n$$\nHere, $F_{i+1/2}$ is the numerical flux across the interface $x_{i+1/2}$.\n\n**3. Upwind Flux and Piecewise Linear Reconstruction**\nFor the linear advection equation with $a0$, the information flows from left to right. An upwind flux scheme thus uses the state from the upwind (left) side of the interface to compute the flux. The flux at interface $x_{i+1/2}$ is given by $F_{i+1/2} = a u_{i+1/2}^L$, where $u_{i+1/2}^L$ is the reconstructed value of the solution on the left side of the interface.\n\nTo achieve second-order spatial accuracy, we use a piecewise linear reconstruction. Within each cell $i$, we model the solution as a linear function $u(x) = u_i + s_i(x-x_i)$, where $s_i$ is the slope. The problem defines the reconstructed value using $\\sigma_i = s_i \\Delta x$ as $u_{i+1/2}^L = u_i + \\frac{1}{2}\\sigma_i$. This formula evaluates the linear profile from cell $i$ at its right boundary, $x_{i+1/2} = x_i + \\Delta x/2$.\n\nThe core of the task is to compare two ways of calculating the slope representative $\\sigma_i$:\n- **No Limiter (Unlimited Centered Slope)**: A standard second-order-accurate choice for the slope at cell $i$ is based on the values in the neighboring cells, $i-1$ and $i+1$. The corresponding slope representative is $\\sigma_i = \\frac{1}{2}(u_{i+1} - u_{i-1})$. While this scheme is second-order, it is not guaranteed to be monotonic and typically introduces spurious oscillations (Gibbs overshoot and undershoot) near discontinuities.\n- **Minmod Limiter**: To suppress these oscillations, we employ a slope limiter. The slope is chosen conservatively. The problem specifies using the backward difference, $\\Delta u_{i-1/2} = u_i - u_{i-1}$, and the forward difference, $\\Delta u_{i+1/2} = u_{i+1} - u_i$. The minmod-limited slope representative is then $\\sigma_i = \\operatorname{minmod}(\\Delta u_{i-1/2}, \\Delta u_{i+1/2})$. The minmod function returns the argument with the smallest absolute value if both have the same sign, and zero otherwise. This choice ensures that the reconstruction does not introduce new local extrema, a property known as Total Variation Diminishing (TVD), thus preventing overshoot.\n\nIn all cases, periodic boundary conditions are enforced by using modular arithmetic on the indices (e.g., cell index $-1$ corresponds to $N-1$, and index $N$ corresponds to $0$).\n\n**4. Time Integration**\nThe resulting system of ODEs, $\\frac{du}{dt} = \\mathcal{L}(u)$, is integrated in time using the provided two-stage SSP Runge-Kutta (SSP-RK2) method:\n$$\nu^{(1)} = u^n + \\Delta t\\,\\mathcal{L}(u^n)\n$$\n$$\nu^{n+1} = \\frac{1}{2}\\,u^n + \\frac{1}{2}\\,\\left(u^{(1)} + \\Delta t\\,\\mathcal{L}(u^{(1)})\\right)\n$$\nThis integrator is chosen because it preserves the stability properties (like the TVD property) of the spatial discretization under a suitable CFL constraint, which is satisfied by our time step selection.\n\n**5. Final Measurement**\nAfter evolving the solution from $t=0$ to $t=T$, the maximum Gibbs overshoot amplitude is computed for both the unlimited and minmod-limited schemes. The metric is $A = \\max(\\max_i u_i(T) - 1, 0)$, ensuring it is non-negative. This procedure is repeated for each set of parameters in the test suite.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the simulation for all test cases and print the results.\n    \"\"\"\n    test_cases = [\n        (256, 0.45, 0.25, 0.5),  # Test 1\n        (128, 0.95, 0.10, 0.5),  # Test 2\n        (64, 0.20, 0.40, 0.5),   # Test 3\n        (128, 0.70, 0.02, 0.2),   # Test 4\n    ]\n\n    all_results = []\n    for params in test_cases:\n        N, C_target, w, T = params\n        a = 1.0\n        L = 1.0\n        x0 = 0.25\n\n        # Run simulation for the 'no limiter' case\n        A_nolimiter = run_simulation(N, C_target, w, T, a, L, x0, limiter='none')\n        # Run simulation for the 'minmod limiter' case\n        A_minmod = run_simulation(N, C_target, w, T, a, L, x0, limiter='minmod')\n        \n        all_results.append([A_nolimiter, A_minmod])\n\n    # Format the output string as specified\n    result_str = \",\".join([f\"[{res[0]:.6f},{res[1]:.6f}]\" for res in all_results])\n    print(f\"[{result_str}]\")\n\ndef run_simulation(N, C_target, w, T, a, L, x0, limiter):\n    \"\"\"\n    Performs a single simulation run for a given set of parameters and limiter type.\n    \"\"\"\n    # 1. Spatial and Temporal Grid Setup\n    dx = L / N\n    x = np.linspace(dx / 2.0, L - dx / 2.0, N)\n\n    # Time step calculation\n    dt_max = C_target * dx / a\n    n_steps = int(np.ceil(T / dt_max))\n    dt = T / n_steps\n\n    # 2. Initial Condition\n    u0 = np.zeros(N)\n    x_start = x0\n    x_end = x0 + w\n    # Handle periodic wrap-around for the pulse interval\n    if x_end  L:\n        mask = (x = x_start) | (x  (x_end - L))\n    else:\n        mask = (x = x_start)  (x  x_end)\n    u0[mask] = 1.0\n    \n    u = u0.copy()\n\n    # 3. Time Evolution\n    for _ in range(n_steps):\n        # SSP-RK2 Scheme\n        Lu_n = calculate_L(u, N, dx, a, limiter)\n        u1 = u + dt * Lu_n\n        Lu_1 = calculate_L(u1, N, dx, a, limiter)\n        u = 0.5 * u + 0.5 * (u1 + dt * Lu_1)\n\n    # 4. Measure Overshoot\n    overshoot = np.max(u) - 1.0\n    return max(0.0, overshoot)\n\ndef minmod_vec(r, s):\n    \"\"\"\n    Vectorized minmod function.\n    \"\"\"\n    sign_r = np.sign(r)\n    min_abs = np.minimum(np.abs(r), np.abs(s))\n    result = sign_r * min_abs\n    \n    # Condition: r*s  0. If not, the result is 0.\n    mask = (r * s) = 0\n    result[mask] = 0.0\n    return result\n\ndef calculate_L(u, N, dx, a, limiter):\n    \"\"\"\n    Calculates the semi-discrete operator L(u).\n    \"\"\"\n    # Periodic boundary conditions are handled using np.roll\n    u_im1 = np.roll(u, 1)  # u_{i-1}\n    u_ip1 = np.roll(u, -1) # u_{i+1}\n\n    # Calculate slope representative sigma\n    if limiter == 'none':\n        # Unlimited centered slope\n        sigma = 0.5 * (u_ip1 - u_im1)\n    elif limiter == 'minmod':\n        # Minmod-limited slope\n        bwd_diff = u - u_im1\n        fwd_diff = u_ip1 - u\n        sigma = minmod_vec(bwd_diff, fwd_diff)\n    else:\n        raise ValueError(\"Unknown limiter type\")\n\n    # Reconstruct left state at interface x_{i+1/2}\n    u_L_at_ip12 = u + 0.5 * sigma\n\n    # Calculate upwind flux (since a  0)\n    F_ip12 = a * u_L_at_ip12\n\n    # Flux at interface x_{i-1/2} is the rolled F_ip12\n    F_im12 = np.roll(F_ip12, 1)\n\n    # Compute the semi-discrete operator\n    Lu = -(F_ip12 - F_im12) / dx\n    return Lu\n\nif __name__ == \"__main__\":\n    solve()\n\n```", "id": "3508820"}]}