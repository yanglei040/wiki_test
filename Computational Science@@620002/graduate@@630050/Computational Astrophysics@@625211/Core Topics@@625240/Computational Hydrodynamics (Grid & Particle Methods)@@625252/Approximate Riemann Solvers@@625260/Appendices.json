{"hands_on_practices": [{"introduction": "Before we can construct a solver for the interaction between two fluid states, we must first understand the speeds at which information propagates. This practice focuses on deriving and calculating the characteristic wave speeds of the Euler equations, which represent the velocities of sound waves and the fluid itself. Mastering this calculation is a critical first step, as the fastest signal speed determines the maximum allowable time step for a stable simulation via the Courant–Friedrichs–Lewy (CFL) condition. [@problem_id:3504120]", "problem": "Consider the one-dimensional Euler equations for an inviscid, compressible ideal gas,\n$$\n\\partial_t U + \\partial_x F(U) = 0,\n$$\nwith conserved variables $U = (\\rho, \\rho u, E)^{\\top}$, flux $F(U) = (\\rho u, \\rho u^{2} + p, u(E + p))^{\\top}$, and closure by the ideal-gas equation of state $p = (\\gamma - 1)\\left(E - \\tfrac{1}{2}\\rho u^{2}\\right)$. The system is hyperbolic, and small perturbations about a constant state propagate along characteristic fields. From the hyperbolic structure and the thermodynamics of an ideal gas, derive the characteristic wave speeds of the one-dimensional Euler system in terms of primitive variables $(\\rho, u, p)$ and the adiabatic index $\\gamma$, and then evaluate these speeds for the left and right initial states\n$$\nU_L = (\\rho_L, u_L, p_L) = (1.0, 0.0, 1.0), \\quad U_R = (\\rho_R, u_R, p_R) = (0.125, 0.0, 0.1),\n$$\nwith $\\gamma = 1.4$. Using these results, determine the maximum signal speed at time $t = 0$ appropriate for a Courant–Friedrichs–Lewy (CFL) time step estimate, defined as the largest magnitude of any characteristic speed present initially in the domain. Work in nondimensional units consistent with the given states. Round all numerical values to six significant figures. The final answer must list, in order, the three characteristic speeds for the left state, the three characteristic speeds for the right state, and the maximum signal speed, and must be given as a single row matrix. No physical units are to be reported in the final boxed answer.", "solution": "The problem is well-posed, scientifically grounded, and contains all necessary information for a unique solution. The one-dimensional Euler equations for an inviscid, ideal gas constitute a standard model in fluid dynamics. The task involves deriving the characteristic wave speeds from the fundamental system of equations and then applying this result to the given initial conditions. The problem is therefore valid.\n\nThe one-dimensional Euler equations are given in conservation law form as:\n$$\n\\partial_t U + \\partial_x F(U) = 0\n$$\nwhere $U = (\\rho, \\rho u, E)^{\\top}$ is the vector of conserved variables (density, momentum, total energy), and $F(U) = (\\rho u, \\rho u^2 + p, u(E+p))^{\\top}$ is the flux vector. The system is closed by the ideal gas equation of state, $p = (\\gamma-1)(E - \\frac{1}{2}\\rho u^2)$.\n\nThe characteristic speeds of this hyperbolic system are the eigenvalues of the Jacobian matrix $A(U) = \\frac{\\partial F}{\\partial U}$. To find these eigenvalues, it is more convenient to first express the Euler equations in terms of primitive variables $W = (\\rho, u, p)^{\\top}$. The resulting quasi-linear system is $\\partial_t W + \\tilde{A}(W) \\partial_x W = 0$, where the matrix $\\tilde{A}(W)$ has the same eigenvalues as $A(U)$.\n\nThe primitive form of the Euler equations is derived as follows:\n1.  **Continuity Equation**:\n    Starting from $\\partial_t \\rho + \\partial_x(\\rho u) = 0$, we apply the product rule:\n    $$\n    \\partial_t \\rho + u \\partial_x \\rho + \\rho \\partial_x u = 0\n    $$\n\n2.  **Momentum Equation**:\n    Starting from $\\partial_t(\\rho u) + \\partial_x(\\rho u^2 + p) = 0$, we find:\n    $$\n    \\rho(\\partial_t u + u \\partial_x u) + \\frac{1}{\\rho}\\partial_x p = 0\n    $$\n\n3.  **Energy Equation**:\n    For an ideal gas undergoing an adiabatic process, the quantity $p/\\rho^\\gamma$ is conserved along fluid streamlines. This leads to the equation:\n    $$\n    \\partial_t p + u \\partial_x p + \\gamma p \\partial_x u = 0\n    $$\n\nThese three equations can be written in matrix form as:\n$$\n\\frac{\\partial}{\\partial t}\n\\begin{pmatrix}\n\\rho \\\\ u \\\\ p\n\\end{pmatrix}\n+\n\\begin{pmatrix}\nu & \\rho & 0 \\\\\n0 & u & 1/\\rho \\\\\n0 & \\gamma p & u\n\\end{pmatrix}\n\\frac{\\partial}{\\partial x}\n\\begin{pmatrix}\n\\rho \\\\ u \\\\ p\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n0 \\\\ 0 \\\\ 0\n\\end{pmatrix}\n$$\nThe characteristic wave speeds, $\\lambda$, are the eigenvalues of the matrix $\\tilde{A}(W)$:\n$$\n\\tilde{A}(W) = \\begin{pmatrix}\nu & \\rho & 0 \\\\\n0 & u & 1/\\rho \\\\\n0 & \\gamma p & u\n\\end{pmatrix}\n$$\nWe solve the characteristic equation $\\det(\\tilde{A} - \\lambda I) = 0$:\n$$\n\\det \\begin{pmatrix}\nu - \\lambda & \\rho & 0 \\\\\n0 & u - \\lambda & 1/\\rho \\\\\n0 & \\gamma p & u - \\lambda\n\\end{pmatrix} = (u - \\lambda) \\left[ (u - \\lambda)^2 - (\\gamma p)(1/\\rho) \\right] = 0\n$$\nThis equation yields three eigenvalues:\n$$\n\\lambda_1 = u, \\quad (u - \\lambda)^2 = \\frac{\\gamma p}{\\rho}\n$$\nThe second part gives $u - \\lambda = \\pm \\sqrt{\\frac{\\gamma p}{\\rho}}$.\nThe term $c = \\sqrt{\\frac{\\gamma p}{\\rho}}$ is the adiabatic speed of sound.\nThus, the three characteristic wave speeds are:\n$$\n\\lambda_1 = u - c, \\quad \\lambda_2 = u, \\quad \\lambda_3 = u + c\n$$\n\nNow, we evaluate these speeds for the given left ($L$) and right ($R$) initial states, with $\\gamma = 1.4$.\n\n**For the left state:** $U_L \\implies (\\rho_L, u_L, p_L) = (1.0, 0.0, 1.0)$.\nThe speed of sound in the left state is:\n$$\nc_L = \\sqrt{\\frac{\\gamma p_L}{\\rho_L}} = \\sqrt{\\frac{(1.4)(1.0)}{1.0}} = \\sqrt{1.4} \\approx 1.1832159566\n$$\nRounding to six significant figures, $c_L \\approx 1.18322$.\nThe characteristic speeds for the left state are:\n$$\n\\lambda_{1,L} = u_L - c_L = 0.0 - 1.18322 = -1.18322\n$$\n$$\n\\lambda_{2,L} = u_L = 0.0\n$$\n$$\n\\lambda_{3,L} = u_L + c_L = 0.0 + 1.18322 = 1.18322\n$$\n\n**For the right state:** $U_R \\implies (\\rho_R, u_R, p_R) = (0.125, 0.0, 0.1)$.\nThe speed of sound in the right state is:\n$$\nc_R = \\sqrt{\\frac{\\gamma p_R}{\\rho_R}} = \\sqrt{\\frac{(1.4)(0.1)}{0.125}} = \\sqrt{\\frac{0.14}{0.125}} = \\sqrt{1.12} \\approx 1.0583005244\n$$\nRounding to six significant figures, $c_R \\approx 1.05830$.\nThe characteristic speeds for the right state are:\n$$\n\\lambda_{1,R} = u_R - c_R = 0.0 - 1.05830 = -1.05830\n$$\n$$\n\\lambda_{2,R} = u_R = 0.0\n$$\n$$\n\\lambda_{3,R} = u_R + c_R = 0.0 + 1.05830 = 1.05830\n$$\n\n**Maximum Signal Speed:**\nThe maximum signal speed, $S_{\\text{max}}$, for the CFL condition is the largest magnitude among all characteristic speeds initially present.\n$$\nS_{\\text{max}} = \\max(|\\lambda_{1,L}|, |\\lambda_{2,L}|, |\\lambda_{3,L}|, |\\lambda_{1,R}|, |\\lambda_{2,R}|, |\\lambda_{3,R}|)\n$$\nThe set of magnitudes is $\\{|-1.18322|, |0.0|, |1.18322|, |-1.05830|, |0.0|, |1.05830|\\}$, which is $\\{1.18322, 0.0, 1.05830\\}$.\nThe maximum of these values is:\n$$\nS_{\\text{max}} = 1.18322\n$$\nThis corresponds to the magnitude of the fastest waves, which are the sound waves moving into the stationary fluid in the left state.\n\nThe final answer requires a row matrix containing the three left-state speeds, the three right-state speeds, and the maximum signal speed, all rounded to six significant figures.\nThe values are:\n-   Left speeds: $-1.18322, 0.0, 1.18322$\n-   Right speeds: $-1.05830, 0.0, 1.05830$\n-   Max signal speed: $1.18322$", "answer": "$$\n\\boxed{\\begin{pmatrix} -1.18322 & 0.0 & 1.18322 & -1.05830 & 0.0 & 1.05830 & 1.18322 \\end{pmatrix}}\n$$", "id": "3504120"}, {"introduction": "With an understanding of characteristic speeds, we can now construct our first complete approximate Riemann solver. The Rusanov flux, also known as the local Lax-Friedrichs scheme, is a foundational method that provides a robust solution by averaging the fluxes from the left and right states and adding a carefully controlled amount of numerical dissipation. This exercise walks through the full procedure, from converting primitive variables to conserved ones to assembling the final flux, demonstrating how the maximum signal speed is used to ensure stability. [@problem_id:3504119]", "problem": "Consider the one-dimensional Euler equations for an ideal gas in conservation form, with state vector $U = (\\rho, m, E)$ where $\\rho$ is the mass density, $m = \\rho u$ is the momentum density, and $E$ is the total energy density. The corresponding flux function is $F(U) = (\\rho u, \\rho u^{2} + p, u(E + p))$, where $p$ is the gas pressure and $u$ is the fluid velocity. The equation of state for an ideal gas is $p = (\\gamma - 1)\\left(E - \\frac{1}{2}\\rho u^{2}\\right)$, and the adiabatic sound speed is $a = \\sqrt{\\frac{\\gamma p}{\\rho}}$. In the Rusanov (local Lax–Friedrichs) approximate Riemann solver, the numerical flux at an interface is constructed by averaging the physical fluxes from the left and right states and adding dissipation proportional to the maximum characteristic speed.\n\nYou are modeling a compressible astrophysical flow with adiabatic index $\\gamma = \\frac{5}{3}$. At a cell interface, the left and right primitive states (density, velocity, pressure) are given by $U_{L} = (\\rho_{L}, u_{L}, p_{L}) = (1, 2, 1)$ and $U_{R} = (\\rho_{R}, u_{R}, p_{R}) = \\left(0.5, -1, 0.5\\right)$. Treat these tuples as primitive variables and convert them to the conserved form where necessary. Using the standard definition of the Rusanov approximate Riemann solver, compute the numerical flux at the interface and report the three components of the flux vector (mass, momentum, and energy flux). Express your final answer as a single row vector of the three components. Provide the result in exact analytic form; do not round. No units are required.", "solution": "The user has provided a problem from computational astrophysics concerning the calculation of a numerical flux using the Rusanov approximate Riemann solver.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n- **System:** One-dimensional Euler equations in conservation form.\n- **State Vector:** $U = (\\rho, m, E)$, where $\\rho$ is mass density, $m = \\rho u$ is momentum density, and $E$ is total energy density.\n- **Flux Function:** $F(U) = (\\rho u, \\rho u^{2} + p, u(E + p))$, where $u$ is velocity and $p$ is pressure.\n- **Equation of State (ideal gas):** $p = (\\gamma - 1)\\left(E - \\frac{1}{2}\\rho u^{2}\\right)$.\n- **Adiabatic Sound Speed:** $a = \\sqrt{\\frac{\\gamma p}{\\rho}}$.\n- **Numerical Method:** Rusanov (local Lax–Friedrichs) approximate Riemann solver. The numerical flux $F^*$ is defined as $F^* = \\frac{1}{2}[F(U_L) + F(U_R)] - \\frac{1}{2}S_{\\text{max}}[U_R - U_L]$, where $S_{\\text{max}}$ is the maximum characteristic speed.\n- **Adiabatic Index:** $\\gamma = \\frac{5}{3}$.\n- **Left Primitive State:** $(\\rho_{L}, u_{L}, p_{L}) = (1, 2, 1)$.\n- **Right Primitive State:** $(\\rho_{R}, u_{R}, p_{R}) = (0.5, -1, 0.5)$.\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientific Grounding:** The problem is based on the Euler equations of gas dynamics, the ideal gas law, and the Rusanov flux scheme, which are standard, well-established concepts in computational fluid dynamics and computational astrophysics. This is scientifically sound.\n- **Well-Posedness:** The problem provides all necessary information: the governing equations, the equation of state, the specific numerical scheme, the adiabatic index, and the initial left and right states. These inputs are sufficient to compute a unique, stable, and meaningful numerical flux vector.\n- **Objectivity:** The problem statement is composed entirely of clear, precise, and objective mathematical and physical definitions and data. There are no subjective or ambiguous terms.\n- **Flaw Checklist:**\n    1.  **Scientific Unsoundness:** None.\n    2.  **Non-Formalizable/Irrelevant:** The problem is a formal and canonical example within the topic of approximate Riemann solvers.\n    3.  **Incomplete/Contradictory:** All necessary data are provided and are self-consistent.\n    4.  **Unrealistic/Infeasible:** The numerical values for the states are physically plausible within a normalized context.\n    5.  **Ill-Posed/Poorly Structured:** The problem is well-posed.\n    6.  **Trivial/Tautological:** The calculation, while straightforward, involves multiple non-trivial steps and requires a solid understanding of the underlying physics and numerical method.\n    7.  **Outside Verifiability:** The result is mathematically verifiable.\n\n**Step 3: Verdict and Action**\nThe problem is **valid**. A complete, reasoned solution will be provided.\n\n### Solution\n\nThe Rusanov numerical flux, $F^*$, at the interface between a left state $U_L$ and a right state $U_R$ is given by the formula:\n$$F^*(U_L, U_R) = \\frac{1}{2} [F(U_L) + F(U_R)] - \\frac{1}{2} S_{\\text{max}} [U_R - U_L]$$\nwhere $F(U)$ is the physical flux, $U$ is the vector of conserved variables, and $S_{\\text{max}}$ is the maximum signal speed at the interface. The calculation proceeds in four steps.\n\n**1. Convert Primitive Variables to Conserved Variables**\nThe vector of conserved variables is $U = (\\rho, m, E) = (\\rho, \\rho u, E)$. The total energy density $E$ is related to the primitive variables via the equation of state:\n$$E = \\frac{p}{\\gamma - 1} + \\frac{1}{2}\\rho u^{2}$$\nWith $\\gamma = \\frac{5}{3}$, the term $\\gamma-1 = \\frac{2}{3}$.\n\nFor the left state, $U_L$, with $(\\rho_L, u_L, p_L) = (1, 2, 1)$:\n- Mass density: $\\rho_L = 1$.\n- Momentum density: $m_L = \\rho_L u_L = (1)(2) = 2$.\n- Total energy density: $E_L = \\frac{p_L}{\\gamma - 1} + \\frac{1}{2}\\rho_L u_L^2 = \\frac{1}{\\frac{2}{3}} + \\frac{1}{2}(1)(2^2) = \\frac{3}{2} + 2 = \\frac{7}{2}$.\nThus, the left-state conserved vector is $U_L = (1, 2, \\frac{7}{2})$.\n\nFor the right state, $U_R$, with $(\\rho_R, u_R, p_R) = (0.5, -1, 0.5) = (\\frac{1}{2}, -1, \\frac{1}{2})$:\n- Mass density: $\\rho_R = \\frac{1}{2}$.\n- Momentum density: $m_R = \\rho_R u_R = (\\frac{1}{2})(-1) = -\\frac{1}{2}$.\n- Total energy density: $E_R = \\frac{p_R}{\\gamma-1} + \\frac{1}{2}\\rho_R u_R^2 = \\frac{\\frac{1}{2}}{\\frac{2}{3}} + \\frac{1}{2}(\\frac{1}{2})(-1)^2 = \\frac{3}{4} + \\frac{1}{4} = 1$.\nThus, the right-state conserved vector is $U_R = (\\frac{1}{2}, -\\frac{1}{2}, 1)$.\n\n**2. Calculate the Physical Fluxes**\nThe physical flux vector is $F(U) = (\\rho u, \\rho u^2+p, u(E+p))$.\n\nFor the left state, $F(U_L)$:\n- Mass flux: $\\rho_L u_L = 2$.\n- Momentum flux: $\\rho_L u_L^2 + p_L = (1)(2^2) + 1 = 5$.\n- Energy flux: $u_L (E_L + p_L) = 2(\\frac{7}{2} + 1) = 2(\\frac{9}{2}) = 9$.\nThus, the left-state flux vector is $F(U_L) = (2, 5, 9)$.\n\nFor the right state, $F(U_R)$:\n- Mass flux: $\\rho_R u_R = -\\frac{1}{2}$.\n- Momentum flux: $\\rho_R u_R^2 + p_R = (\\frac{1}{2})(-1)^2 + \\frac{1}{2} = \\frac{1}{2} + \\frac{1}{2} = 1$.\n- Energy flux: $u_R(E_R + p_R) = (-1)(1 + \\frac{1}{2}) = -\\frac{3}{2}$.\nThus, the right-state flux vector is $F(U_R) = (-\\frac{1}{2}, 1, -\\frac{3}{2})$.\n\n**3. Calculate the Maximum Signal Speed**\nThe characteristic speeds (eigenvalues) of the 1D Euler equations are $u-a$, $u$, and $u+a$. The maximum signal speed for the Rusanov flux is typically taken as $S_{\\text{max}} = \\max(|u_L| + a_L, |u_R| + a_R)$. The sound speed $a$ is given by $a = \\sqrt{\\frac{\\gamma p}{\\rho}}$.\n\nFor the left state:\n- $a_L = \\sqrt{\\frac{\\gamma p_L}{\\rho_L}} = \\sqrt{\\frac{(\\frac{5}{3})(1)}{1}} = \\sqrt{\\frac{5}{3}}$.\n- $|u_L| + a_L = |2| + \\sqrt{\\frac{5}{3}} = 2 + \\sqrt{\\frac{5}{3}}$.\n\nFor the right state:\n- $a_R = \\sqrt{\\frac{\\gamma p_R}{\\rho_R}} = \\sqrt{\\frac{(\\frac{5}{3})(\\frac{1}{2})}{\\frac{1}{2}}} = \\sqrt{\\frac{5}{3}}$.\n- $|u_R| + a_R = |-1| + \\sqrt{\\frac{5}{3}} = 1 + \\sqrt{\\frac{5}{3}}$.\n\nComparing the two, we find the maximum signal speed:\n$$S_{\\text{max}} = \\max\\left(2 + \\sqrt{\\frac{5}{3}}, 1 + \\sqrt{\\frac{5}{3}}\\right) = 2 + \\sqrt{\\frac{5}{3}} = 2 + \\frac{\\sqrt{15}}{3}$$\n\n**4. Assemble the Rusanov Flux**\nWe now combine the components into the Rusanov flux formula.\n\nFirst, compute the average flux term:\n$$\\frac{1}{2}[F(U_L) + F(U_R)] = \\frac{1}{2}\\left( (2, 5, 9) + (-\\frac{1}{2}, 1, -\\frac{3}{2}) \\right) = \\frac{1}{2}\\left(\\frac{3}{2}, 6, \\frac{15}{2}\\right) = \\left(\\frac{3}{4}, 3, \\frac{15}{4}\\right)$$\n\nNext, compute the dissipation term, $-\\frac{1}{2} S_{\\text{max}} [U_R - U_L]$.\nThe difference in conserved states is:\n$$U_R - U_L = \\left(\\frac{1}{2}, -\\frac{1}{2}, 1\\right) - \\left(1, 2, \\frac{7}{2}\\right) = \\left(-\\frac{1}{2}, -\\frac{5}{2}, -\\frac{5}{2}\\right)$$\nThe dissipation coefficient is:\n$$\\frac{1}{2} S_{\\text{max}} = \\frac{1}{2}\\left(2 + \\frac{\\sqrt{15}}{3}\\right) = 1 + \\frac{\\sqrt{15}}{6}$$\nThe dissipation vector is:\n$$-\\frac{1}{2} S_{\\text{max}} [U_R - U_L] = -\\left(1 + \\frac{\\sqrt{15}}{6}\\right)\\left(-\\frac{1}{2}, -\\frac{5}{2}, -\\frac{5}{2}\\right) = \\left(\\frac{1}{2}\\left(1 + \\frac{\\sqrt{15}}{6}\\right), \\frac{5}{2}\\left(1 + \\frac{\\sqrt{15}}{6}\\right), \\frac{5}{2}\\left(1 + \\frac{\\sqrt{15}}{6}\\right)\\right)$$\n$$= \\left(\\frac{1}{2} + \\frac{\\sqrt{15}}{12}, \\frac{5}{2} + \\frac{5\\sqrt{15}}{12}, \\frac{5}{2} + \\frac{5\\sqrt{15}}{12}\\right)$$\n\nFinally, add the average flux and the dissipation vector to obtain $F^*$:\n- Mass flux $F_1^*$:\n$$F_1^* = \\frac{3}{4} + \\left(\\frac{1}{2} + \\frac{\\sqrt{15}}{12}\\right) = \\frac{3}{4} + \\frac{2}{4} + \\frac{\\sqrt{15}}{12} = \\frac{5}{4} + \\frac{\\sqrt{15}}{12} = \\frac{15}{12} + \\frac{\\sqrt{15}}{12} = \\frac{15 + \\sqrt{15}}{12}$$\n- Momentum flux $F_2^*$:\n$$F_2^* = 3 + \\left(\\frac{5}{2} + \\frac{5\\sqrt{15}}{12}\\right) = \\frac{6}{2} + \\frac{5}{2} + \\frac{5\\sqrt{15}}{12} = \\frac{11}{2} + \\frac{5\\sqrt{15}}{12} = \\frac{66}{12} + \\frac{5\\sqrt{15}}{12} = \\frac{66 + 5\\sqrt{15}}{12}$$\n- Energy flux $F_3^*$:\n$$F_3^* = \\frac{15}{4} + \\left(\\frac{5}{2} + \\frac{5\\sqrt{15}}{12}\\right) = \\frac{15}{4} + \\frac{10}{4} + \\frac{5\\sqrt{15}}{12} = \\frac{25}{4} + \\frac{5\\sqrt{15}}{12} = \\frac{75}{12} + \\frac{5\\sqrt{15}}{12} = \\frac{75 + 5\\sqrt{15}}{12}$$\n\nThe resulting numerical flux vector is $F^* = \\left(\\frac{15 + \\sqrt{15}}{12}, \\frac{66 + 5\\sqrt{15}}{12}, \\frac{75 + 5\\sqrt{15}}{12}\\right)$.", "answer": "$$ \\boxed{ \\begin{pmatrix} \\frac{15 + \\sqrt{15}}{12} & \\frac{66 + 5\\sqrt{15}}{12} & \\frac{75 + 5\\sqrt{15}}{12} \\end{pmatrix} } $$", "id": "3504119"}, {"introduction": "Real astrophysical flows are rarely free of external forces, with gravity being the most dominant. This practice moves beyond the pure Euler equations to tackle the challenge of incorporating gravitational source terms, a critical step for simulating stars, accretion disks, and galaxies. We explore the concept of a \"well-balanced\" scheme, which is specially designed to exactly maintain hydrostatic equilibrium, preventing numerical errors from generating artificial flows. This advanced exercise focuses on the design principles behind modifying a sophisticated solver like HLLC to accurately model a static fluid in a gravitational field, a common scenario in stellar astrophysics. [@problem_id:3504139]", "problem": "You are to design and implement a one-dimensional, well-balanced approximate Riemann solver of the Harten–Lax–van Leer–Contact (HLLC) type for the compressible Euler equations with a gravitational source term, suitable for stellar envelope calculations in computational astrophysics. The goal is to ensure exact preservation of discrete hydrostatic equilibria satisfying the stationary balance condition $ \\nabla p + \\rho \\nabla \\Phi = 0 $, specialized here to one spatial dimension as $ \\partial_x p + \\rho \\, \\partial_x \\Phi = 0 $. All quantities in this problem are nondimensional; therefore, no physical units are required in your final answers.\n\nFundamental base and governing equations: Consider the one-dimensional compressible Euler equations with a gravitational potential $ \\Phi(x) $:\n$$\n\\partial_t \\mathbf{U} + \\partial_x \\mathbf{F}(\\mathbf{U}) = \\mathbf{S}(\\mathbf{U},x),\n$$\nwhere the vector of conservative variables is $ \\mathbf{U} = [ \\rho, \\rho u, E ]^\\top $, with density $ \\rho $, velocity $ u $, and total energy $ E = e + \\frac{1}{2} \\rho u^2 $; the flux vector is $ \\mathbf{F}(\\mathbf{U}) = [ \\rho u, \\rho u^2 + p, u (E + p) ]^\\top $; and the source term is $ \\mathbf{S}(\\mathbf{U},x) = [ 0, -\\rho \\, \\partial_x \\Phi(x), -\\rho u \\, \\partial_x \\Phi(x) ]^\\top $. The pressure $ p $ is related to internal energy by the ideal gas relation $ p = (\\gamma - 1) e $, with adiabatic index $ \\gamma > 1 $. In hydrostatic equilibrium, $ u = 0 $ and $ \\partial_x p + \\rho \\, \\partial_x \\Phi = 0 $.\n\nDiscrete hydrostatic equilibrium and well-balancing target: On a uniform grid with spacing $ \\Delta x $, cell centers at positions $ x_i = i \\, \\Delta x $, and cell-centered values $ (\\rho_i, p_i, u_i) $, the discrete hydrostatic balance to be exactly preserved is\n$$\np_{i+1} - p_i = - \\frac{\\Delta x}{2} \\left( \\rho_i \\, g_i + \\rho_{i+1} \\, g_{i+1} \\right),\n$$\nwhere $ g_i = \\partial_x \\Phi(x_i) $. Your solver must be designed such that, when $ u_i = 0 $ and the above discrete relation holds across the grid, the semi-discrete update for the momentum in each interior cell $ i $,\n$$\n\\partial_t (\\rho u)_i = - \\frac{ F_{i+\\frac{1}{2}}^{(m)} - F_{i-\\frac{1}{2}}^{(m)} }{ \\Delta x } - \\rho_i \\, g_i,\n$$\nhas $ \\partial_t (\\rho u)_i = 0 $ exactly in floating-point arithmetic to within a tolerance of $ 10^{-10} $, where $ F^{(m)} $ denotes the momentum component of the numerical flux at a face. Likewise, the mass and energy updates should evaluate to zero for $ u_i = 0 $.\n\nWell-balanced HLLC construction principle: Starting from the standard HLLC solver, incorporate a hydrostatic reconstruction that modifies the left and right pressures used at each face $ x_{i+\\frac{1}{2}} $ by\n$$\np_{i+\\frac{1}{2},L}^\\star = p_i - \\frac{ \\Delta x }{2 } \\rho_i g_i, \\quad\np_{i+\\frac{1}{2},R}^\\star = p_{i+1} + \\frac{ \\Delta x }{2 } \\rho_{i+1} g_{i+1}.\n$$\nFor data satisfying the discrete hydrostatic balance, these two face pressures coincide, $ p_{i+\\frac{1}{2},L}^\\star = p_{i+\\frac{1}{2},R}^\\star $, yielding a single face pressure $ p_{i+\\frac{1}{2}}^\\star $ that ensures\n$$\nF_{i+\\frac{1}{2}}^{(m)} - F_{i-\\frac{1}{2}}^{(m)} = p_{i+\\frac{1}{2}}^\\star - p_{i-\\frac{1}{2}}^\\star = - \\Delta x \\, \\rho_i g_i,\n$$\nand hence exact cancellation with the source term in the semi-discrete update for the momentum when $ u_i = 0 $. The velocity and density used in the Riemann solver remain those of the corresponding cell-centered states; only the pressures entering the solver at each face are reconstructed as above.\n\nProgram requirements: Implement the following components and checks.\n\n1. Implement a function that constructs a discrete hydrostatic equilibrium consistent with a given polytropic relation $ p = K \\rho^\\gamma $ and a prescribed discrete gravitational field $ g_i $. Starting from an initial density $ \\rho_0 $ and pressure $ p_0 = K \\rho_0^\\gamma $, construct $(\\rho_i, p_i)$ for $ i = 1, \\dots, N-1 $ by solving at each step the nonlinear equation\n$$\nK \\rho_{i+1}^\\gamma - K \\rho_i^\\gamma + \\frac{\\Delta x}{2} \\left( \\rho_i g_i + \\rho_{i+1} g_{i+1} \\right) = 0,\n$$\nensuring strictly positive density and pressure. Set $ u_i = 0 $ for all $ i $. Use robust root finding to solve for $ \\rho_{i+1} $.\n\n2. Implement the HLLC flux function for the one-dimensional Euler equations with input left and right primitive states $ (\\rho_L, u_L, p_L) $ and $ (\\rho_R, u_R, p_R) $, using the adiabatic index $ \\gamma $. Compute the flux $ \\mathbf{F}_{\\mathrm{HLLC}} $ as in the standard HLLC construction with wave speed estimates $ S_L $, $ S_R $, and contact speed $ S_\\star $.\n\n3. Implement at each face the hydrostatic pressure reconstruction\n$$\np_L^\\star = p_i - \\frac{ \\Delta x }{ 2 } \\rho_i g_i, \\quad\np_R^\\star = p_{i+1} + \\frac{ \\Delta x }{ 2 } \\rho_{i+1} g_{i+1},\n$$\nand feed the modified pressures $ (p_L^\\star, p_R^\\star) $ into the HLLC solver together with the original $ \\rho $ and $ u $ as the left and right states. This defines the well-balanced HLLC flux $ \\mathbf{F}_{i+\\frac{1}{2}} $ at each interface.\n\n4. Evaluate the semi-discrete residuals for each interior cell $ i $:\n$$\n\\mathbf{R}_i = - \\frac{ \\mathbf{F}_{i+\\frac{1}{2}} - \\mathbf{F}_{i-\\frac{1}{2}} }{ \\Delta x } + \\mathbf{S}_i,\n$$\nwith $ \\mathbf{S}_i = [ 0, -\\rho_i g_i, -\\rho_i u_i g_i ]^\\top $. For hydrostatic equilibria with $ u_i = 0 $, output booleans indicating whether the absolute values of all three components of $ \\mathbf{R}_i $ across all interior cells are less than $ 10^{-10} $.\n\nTest suite: Your program must run the following test cases and aggregate the boolean pass/fail results into a single output line as described below.\n\n- Test $ A $ (happy path, constant gravity): Use $ N = 6 $, $ \\Delta x = 0.1 $, $ \\gamma = 1.4 $, $ K = 1.0 $, $ \\rho_0 = 1.0 $, and constant gravitational field $ g_i = 0.5 $. Construct the discrete hydrostatic equilibrium and verify the well-balanced property.\n\n- Test $ B $ (variable gravity, polytropic hydrostatic): Use $ N = 8 $, $ \\Delta x = 0.05 $, $ \\gamma = 1.4 $, $ K = 1.0 $, $ \\rho_0 = 1.0 $, and $ g_i = g_0 \\left( 1 + 0.5 \\sin( 2 \\pi x_i ) \\right) $ with $ g_0 = 0.3 $. Construct the discrete hydrostatic equilibrium and verify the well-balanced property.\n\n- Test $ C $ (near-vacuum edge case): Use $ N = 6 $, $ \\Delta x = 0.1 $, $ \\gamma = 1.4 $, $ K = 1.0 $, $ \\rho_0 = 10^{-8} $, and constant gravitational field $ g_i = 0.5 $. Construct the discrete hydrostatic equilibrium and verify the well-balanced property.\n\n- Test $ D $ (zero gravity boundary case): Use $ N = 5 $, $ \\Delta x = 0.07 $, $ \\gamma = 1.4 $, $ K = 1.0 $, uniform state $ \\rho_i = 1.0 $, $ p_i = 1.0 $, $ u_i = 0.0 $, and $ g_i = 0.0 $. Verify that the well-balanced HLLC reduces to the standard HLLC and preserves the uniform stationary state.\n\nFinal output format: Your program should produce a single line of output containing the boolean results for $ [A,B,C,D] $ as a comma-separated list enclosed in square brackets (for example, $ [\\mathrm{True},\\mathrm{False},\\mathrm{True},\\mathrm{True}] $). The tolerance for deciding truth is $ 10^{-10} $ on the absolute values of the residual components. No other text should be printed.", "solution": "The problem requires the design and implementation of a well-balanced Harten–Lax–van Leer–Contact (HLLC) approximate Riemann solver. The solver must be applied to the one-dimensional Euler equations with a gravitational source term and must be capable of exactly preserving a discrete hydrostatic equilibrium. The validity of this problem statement is confirmed as it is scientifically sound, self-contained, and algorithmically well-defined. The underlying principles are standard in computational astrophysics for modeling stellar envelopes.\n\nThe governing equations are the 1D Euler equations:\n$$ \\partial_t \\mathbf{U} + \\partial_x \\mathbf{F}(\\mathbf{U}) = \\mathbf{S}(\\mathbf{U},x) $$\nwith the vector of conserved variables $ \\mathbf{U} = [ \\rho, \\rho u, E ]^\\top $, the flux vector $ \\mathbf{F}(\\mathbf{U}) = [ \\rho u, \\rho u^2 + p, u (E + p) ]^\\top $, and the source term $ \\mathbf{S}(\\mathbf{U},x) = [ 0, -\\rho \\, g(x), -\\rho u \\, g(x) ]^\\top $, where $g(x) = \\partial_x \\Phi(x)$ is the gravitational acceleration. The pressure $p$ and total energy density $E$ are related by the ideal gas law, $ p = (\\gamma - 1)(E - \\frac{1}{2}\\rho u^2) $.\n\nThe core of the problem is to verify the well-balanced property. A numerical scheme is well-balanced if it exactly cancels the numerical flux derivatives with the discretized source terms for a stationary solution. Here, the stationary solution is a hydrostatic equilibrium where the velocity $u$ is zero and pressure gradients balance gravity.\n\nThe finite volume semi-discretization for a cell $i$ is:\n$$ \\frac{d\\mathbf{U}_i}{dt} = - \\frac{\\mathbf{F}_{i+1/2} - \\mathbf{F}_{i-1/2}}{\\Delta x} + \\mathbf{S}_i $$\nWe must show that the right-hand side, the residual $\\mathbf{R}_i$, is zero for a state satisfying the discrete hydrostatic balance.\n\n**Step 1: Discrete Hydrostatic Equilibrium**\n\nThe problem defines a specific discrete hydrostatic equilibrium condition which must be preserved:\n$$ p_{i+1} - p_i = - \\frac{\\Delta x}{2} \\left( \\rho_i g_i + \\rho_{i+1} g_{i+1} \\right) $$\nFor the test cases, we must first construct states $(\\rho_i, p_i, u_i)$ that satisfy this condition. With $u_i = 0$ for all $i$ and a polytropic equation of state $p = K\\rho^\\gamma$, this leads to a nonlinear equation for $\\rho_{i+1}$ given $\\rho_i$:\n$$ K\\rho_{i+1}^\\gamma - K\\rho_i^\\gamma + \\frac{\\Delta x}{2}(\\rho_i g_i + \\rho_{i+1} g_{i+1}) = 0 $$\nThis equation is solved iteratively for $i = 0, \\dots, N-2$ using a numerical root-finding method to construct the initial state across the grid.\n\n**Step 2: Well-Balanced HLLC Flux**\n\nThe key innovation is the hydrostatic pressure reconstruction at each cell interface $i+1/2$. The left and right states for the Riemann problem at this interface are derived from cell-centered values at $i$ and $i+1$, respectively. Instead of using the cell-centered pressures $p_i$ and $p_{i+1}$ directly, we use reconstructed pressures $p_L^\\star$ and $p_R^\\star$:\n$$ p_L^\\star = p_i - \\frac{\\Delta x}{2} \\rho_i g_i $$\n$$ p_R^\\star = p_{i+1} + \\frac{\\Delta x}{2} \\rho_{i+1} g_{i+1} $$\nThe Riemann problem at interface $i+1/2$ is then solved with input states $(\\rho_L, u_L, p_L^\\star) = (\\rho_i, u_i, p_L^\\star)$ and $(\\rho_R, u_R, p_R^\\star) = (\\rho_{i+1}, u_{i+1}, p_R^\\star)$.\n\nAn essential property of this reconstruction is that if the discrete hydrostatic balance holds, then $p_L^\\star = p_R^\\star$. Let's verify this. From the discrete balance: $p_{i+1} - p_i + \\frac{\\Delta x}{2}(\\rho_i g_i + \\rho_{i+1} g_{i+1}) = 0$.\nNow compute the difference of the reconstructed pressures:\n$$ p_R^\\star - p_L^\\star = (p_{i+1} + \\frac{\\Delta x}{2}\\rho_{i+1} g_{i+1}) - (p_i - \\frac{\\Delta x}{2}\\rho_i g_i) = (p_{i+1} - p_i) + \\frac{\\Delta x}{2}(\\rho_i g_i + \\rho_{i+1} g_{i+1}) $$\nSubstituting the discrete balance condition into this expression yields $p_R^\\star - p_L^\\star = 0$. So, $p_L^\\star = p_R^\\star$. Let's call this common value $p_{i+1/2}^\\star$.\n\n**Step 3: Verification of the Well-Balanced Property**\n\nFor a hydrostatic state, $u_i = 0$ for all $i$. The HLLC solver at interface $i+1/2$ is presented with states $(\\rho_i, 0, p_{i+1/2}^\\star)$ and $(\\rho_{i+1}, 0, p_{i+1/2}^\\star)$. This is a contact discontinuity with zero velocity. The HLLC solver correctly identifies the wave speeds $S_L < 0$, $S_R > 0$, the contact speed $S_\\star=0$, and the star-region pressure $p_\\star = p_{i+1/2}^\\star$. The resulting numerical flux $\\mathbf{F}_{i+1/2}$ will have a momentum component equal to this pressure, i.e., $F^{(m)}_{i+1/2} = p_{i+1/2}^\\star$, and zero for its other components.\n\nThe momentum component of the semi-discrete residual for cell $i$ is:\n$$ R_{i}^{(m)} = - \\frac{F_{i+1/2}^{(m)} - F_{i-1/2}^{(m)}}{\\Delta x} - \\rho_i g_i = - \\frac{p_{i+1/2}^\\star - p_{i-1/2}^\\star}{\\Delta x} - \\rho_i g_i $$\nTo evaluate this, we use the two equivalent definitions of the interface pressures, which are valid under equilibrium:\n$$ p_{i+1/2}^\\star = p_i - \\frac{\\Delta x}{2}\\rho_i g_i \\quad \\text{and} \\quad p_{i-1/2}^\\star = p_i + \\frac{\\Delta x}{2}\\rho_i g_i $$\nThe second equality for $p_{i-1/2}^\\star$ comes from applying the $p_R^\\star$ definition at face $(i-1)+1/2$. Substituting these into the residual expression:\n$$ R_{i}^{(m)} = - \\frac{(p_i - \\frac{\\Delta x}{2}\\rho_i g_i) - (p_i + \\frac{\\Delta x}{2}\\rho_i g_i)}{\\Delta x} - \\rho_i g_i = - \\frac{-\\Delta x \\rho_i g_i}{\\Delta x} - \\rho_i g_i = \\rho_i g_i - \\rho_i g_i = 0 $$\nThis demonstrates exact cancellation for the momentum equation.\n\nFor the mass and energy equations: since $u_i = 0$ everywhere, the mass flux $\\rho u$ and energy flux $u(E+p)$ are zero. The HLLC solver for a contact discontinuity with $u=0$ correctly yields a zero flux for these components. The source terms for mass and energy ($0$ and $-\\rho u g$, respectively) are also zero. Thus, the residuals for mass and energy are also exactly zero.\n\nThe implementation will therefore consist of:\n1.  A function to construct the discrete hydrostatic equilibrium for given parameters by solving the non-linear equation for density at each cell.\n2.  A standard HLLC flux function taking left and right primitive states and returning the numerical flux vector.\n3.  A main loop that, for each test case, constructs the equilibrium, computes the well-balanced fluxes at all interfaces using the specified pressure reconstruction, calculates the residuals for all interior cells, and checks if their magnitudes are below the tolerance of $10^{-10}$.\n\nThe HLLC flux $\\mathbf{F}_{\\text{HLLC}}$ is calculated based on wave speed estimates. We will use the Davis estimates for the fastest signals, $S_L$ and $S_R$:\n$$ c = \\sqrt{\\gamma p / \\rho} $$\n$$ S_L = \\min(u_L - c_L, u_R - c_R), \\quad S_R = \\max(u_L + c_L, u_R + c_R) $$\nThe contact wave speed $S_\\star$ and star-region pressure $p_\\star$ are then computed, and the flux is determined based on the location of the interface ($x/t=0$) relative to the waves.\n```python\nimport numpy as np\nfrom scipy.optimize import brentq\n\ndef hllc_flux(rho_L, u_L, p_L, rho_R, u_R, p_R, gamma):\n    \"\"\"\n    Computes the HLLC flux for the 1D Euler equations.\n\n    Args:\n        rho_L, u_L, p_L: Primitive variables (density, velocity, pressure) for the left state.\n        rho_R, u_R, p_R: Primitive variables for the right state.\n        gamma: Adiabatic index.\n\n    Returns:\n        A numpy array containing the HLLC flux vector.\n    \"\"\"\n    # 1. Convert primitive variables to conserved variables and fluxes\n    e_int_L = p_L / (gamma - 1.0)\n    E_L = e_int_L + 0.5 * rho_L * u_L**2\n    U_L = np.array([rho_L, rho_L * u_L, E_L])\n    F_L = np.array([rho_L * u_L, rho_L * u_L**2 + p_L, u_L * (E_L + p_L)])\n\n    e_int_R = p_R / (gamma - 1.0)\n    E_R = e_int_R + 0.5 * rho_R * u_R**2\n    U_R = np.array([rho_R, rho_R * u_R, E_R])\n    F_R = np.array([rho_R * u_R, rho_R * u_R**2 + p_R, u_R * (E_R + p_R)])\n\n    # 2. Sound speeds\n    c_L = np.sqrt(gamma * p_L / rho_L) if rho_L > 0 else 0\n    c_R = np.sqrt(gamma * p_R / rho_R) if rho_R > 0 else 0\n\n    # 3. Wave speed estimates (Davis, 1988)\n    S_L = min(u_L - c_L, u_R - c_R)\n    S_R = max(u_L + c_L, u_R + c_R)\n\n    # 4. HLLC logic based on wave speeds\n    if S_L >= 0.0:\n        return F_L\n    if S_R = 0.0:\n        return F_R\n\n    # 5. Compute contact wave speed (S_star)\n    S_star_num = p_R - p_L + rho_L * u_L * (S_L - u_L) - rho_R * u_R * (S_R - u_R)\n    S_star_den = rho_L * (S_L - u_L) - rho_R * (S_R - u_R)\n    \n    # Avoid division by zero if states are identical\n    if abs(S_star_den)  1e-15:\n        S_star = (u_L + u_R) / 2.0\n    else:\n        S_star = S_star_num / S_star_den\n\n    # 6. Determine flux based on position of contact surface\n    if S_L = 0.0 and S_star > 0.0:\n        # F_star_L\n        p_star = p_L + rho_L * (u_L - S_L) * (u_L - S_star)\n        rho_star_L = rho_L * (S_L - u_L) / (S_L - S_star)\n        \n        U_star_L = np.array([\n            rho_star_L,\n            rho_star_L * S_star,\n            p_star / (gamma - 1.0) + 0.5 * rho_star_L * S_star**2\n        ])\n        return F_L + S_L * (U_star_L - U_L)\n    else: # S_star = 0.0 and S_R > 0.0\n        # F_star_R\n        p_star = p_R + rho_R * (u_R - S_R) * (u_R - S_star)\n        rho_star_R = rho_R * (S_R - u_R) / (S_R - S_star)\n\n        U_star_R = np.array([\n            rho_star_R,\n            rho_star_R * S_star,\n            p_star / (gamma - 1.0) + 0.5 * rho_star_R * S_star**2\n        ])\n        return F_R + S_R * (U_star_R - U_R)\n\ndef construct_equilibrium(N, dx, gamma, K, rho0, g_func):\n    \"\"\"\n    Constructs a discrete hydrostatic equilibrium.\n    \"\"\"\n    x = np.arange(N) * dx\n    g = g_func(x)\n    \n    rho = np.zeros(N)\n    p = np.zeros(N)\n    u = np.zeros(N)\n\n    rho[0] = rho0\n    p[0] = K * rho0**gamma\n    \n    for i in range(N - 1):\n        def f_rho_next(rho_next):\n            if rho_next = 0: return np.inf\n            val = (K * rho_next**gamma - p[i] + \n                   0.5 * dx * (rho[i] * g[i] + rho_next * g[i+1]))\n            return val\n\n        try:\n            # Bracket the root. rho[i] is a good guess.\n            # Small perturbation for bracket in case f(rho[i]) is near zero.\n            a = rho[i] * 0.1\n            b = rho[i] * 10\n            if f_rho_next(a) * f_rho_next(b) > 0:\n                 # Broaden search if initial bracket fails\n                 a = 1e-12\n                 b = rho[i] * 100 + 100\n                 if f_rho_next(a) * f_rho_next(b) > 0:\n                     b = rho[i] * 0.01\n                     a = 1e-12\n            \n            rho[i+1] = brentq(f_rho_next, a, b, xtol=1e-15, rtol=1e-15)\n            p[i+1] = K * rho[i+1]**gamma\n        except (ValueError, RuntimeError):\n            # Fallback for difficult cases (e.g., near vacuum)\n            rho[i+1] = rho[i]\n            p[i+1] = p[i]\n\n    return rho, u, p, g, x\n\ndef solve():\n    \"\"\"\n    Main function to run test cases and verify the well-balanced property.\n    \"\"\"\n    test_cases = [\n        {'id': 'A', 'N': 6, 'dx': 0.1, 'gamma': 1.4, 'K': 1.0, 'rho0': 1.0, 'g_func': lambda x: np.full_like(x, 0.5, dtype=float), 'uniform': False},\n        {'id': 'B', 'N': 8, 'dx': 0.05, 'gamma': 1.4, 'K': 1.0, 'rho0': 1.0, 'g_func': lambda x: 0.3 * (1.0 + 0.5 * np.sin(2.0 * np.pi * x)), 'uniform': False},\n        {'id': 'C', 'N': 6, 'dx': 0.1, 'gamma': 1.4, 'K': 1.0, 'rho0': 1e-8, 'g_func': lambda x: np.full_like(x, 0.5, dtype=float), 'uniform': False},\n        {'id': 'D', 'N': 5, 'dx': 0.07, 'gamma': 1.4, 'K': 1.0, 'rho_val': 1.0, 'p_val': 1.0, 'g_val': 0.0, 'uniform': True}\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        N, dx, gamma = case['N'], case['dx'], case['gamma']\n        \n        if case['uniform']:\n            x = np.arange(N) * dx\n            rho = np.full(N, case['rho_val'])\n            p = np.full(N, case['p_val'])\n            u = np.zeros(N)\n            g = np.full(N, case['g_val'])\n        else:\n            rho, u, p, g, x = construct_equilibrium(N, dx, gamma, case['K'], case['rho0'], case['g_func'])\n\n        fluxes = np.zeros((N - 1, 3))\n        for i in range(N - 1):\n            # Left state from cell i, Right state from cell i+1\n            rho_L, u_L, p_L_cell = rho[i], u[i], p[i]\n            rho_R, u_R, p_R_cell = rho[i+1], u[i+1], p[i+1]\n            \n            # Hydrostatic pressure reconstruction\n            p_L_star = p_L_cell - 0.5 * dx * rho_L * g[i]\n            p_R_star = p_R_cell + 0.5 * dx * rho_R * g[i+1]\n            \n            fluxes[i, :] = hllc_flux(rho_L, u_L, p_L_star, rho_R, u_R, p_R_star, gamma)\n\n        max_residual = 0.0\n        # Loop over interior cells i = 1, ..., N-2\n        # For N=5, this is range(1, 3), i.e., i=1, 2. For N=6, i=1,2,3,4.\n        # This requires at least N=4 for any check to happen.\n        # The test cases have N >= 5, so this is fine.\n        if N > 3:\n            for i in range(1, N-1):\n                F_iph = fluxes[i, :]      # F_{i+1/2}\n                F_imh = fluxes[i-1, :]    # F_{i-1/2}\n                \n                S_i = np.array([0, -rho[i] * g[i], -rho[i] * u[i] * g[i]])\n                \n                residual = -(F_iph - F_imh) / dx + S_i\n                max_residual = max(max_residual, np.max(np.abs(residual)))\n        else: # Cannot check residuals for N  4\n            max_residual = 0.0\n\n        is_balanced = max_residual  1e-10\n        results.append(is_balanced)\n\n    return f\"[{','.join(map(str, results))}]\"\n\n# In a real execution environment, this would be called.\n# The predicted output based on the theoretical analysis is [True,True,True,True]\n```", "answer": "$$ \\boxed{[\\mathrm{True},\\mathrm{True},\\mathrm{True},\\mathrm{True}]} $$", "id": "3504139"}]}