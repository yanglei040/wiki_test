{"hands_on_practices": [{"introduction": "To properly characterize a relativistic, magnetized outflow, we must distinguish between quantities measured in the laboratory frame and those in the fluid's own rest frame. This exercise guides you through the essential transformation from the lab-frame magnetic field $\\mathbf{B}$ to the comoving magnetic four-vector $b^{\\mu}$, a cornerstone of Relativistic Magnetohydrodynamics (RMHD). By calculating the Lorentz-invariant quantity $b^2$ and the magnetization parameter $\\sigma$, you will gain hands-on experience with the fundamental variables that truly govern the dynamics and energy budget of a magnetically dominated jet [@problem_id:3517930].", "problem": "In Relativistic Magnetohydrodynamics (RMHD), the magnetic field measured in the fluid rest frame is encoded in the magnetic four-vector $b^{\\mu}$, which is defined using the dual electromagnetic field tensor ${^{\\ast}\\!F}^{\\mu \\nu}$ and the fluid four-velocity $u^{\\nu}$ via $b^{\\mu} \\equiv {^{\\ast}\\!F}^{\\mu \\nu} u_{\\nu}$. Work in flat spacetime with Minkowski metric signature $(-,+,+,+)$, adopt units with the speed of light $c=1$, and use Heaviside–Lorentz electromagnetic units. Assume ideal magnetohydrodynamics (perfect conductivity), such that the laboratory-frame electric and magnetic fields satisfy $\\mathbf{E} + \\mathbf{v} \\times \\mathbf{B} = \\mathbf{0}$, where $\\mathbf{v}$ is the fluid three-velocity.\n\nStarting only from the definitions above, together with the standard identifications of the field tensor and its dual in terms of the laboratory-frame fields, perform the following:\n\n1. Construct the transformation that expresses $b^{\\mu}$ explicitly in terms of the laboratory-frame magnetic field $\\mathbf{B}$ and the fluid three-velocity $\\mathbf{v}$ and Lorentz factor $\\Gamma \\equiv (1 - v^{2})^{-1/2}$, where $v^{2} \\equiv \\mathbf{v} \\cdot \\mathbf{v}$.\n\n2. From your general expression, derive a simplified scalar expression for $b^{2} \\equiv b^{\\mu} b_{\\mu}$ in terms of $\\mathbf{B}$, $\\mathbf{v}$, and $\\Gamma$.\n\n3. For a jet fluid element with laboratory-frame magnetic field $\\mathbf{B} = (3, 4, 12)$ and velocity $\\mathbf{v} = (0.6, 0.3, 0.0)$, evaluate $b^{2}$ and then compute the magnetization parameter $\\sigma \\equiv b^{2}/w$ given an enthalpy density $w = 50$. Express your final answer for $\\sigma$ as a dimensionless number. Round your final answer to $4$ significant figures.", "solution": "The user has provided a problem in Relativistic Magnetohydrodynamics (RMHD) and has asked for a three-part solution involving the magnetic four-vector $b^{\\mu}$.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n\n- Definition of the magnetic four-vector: $b^{\\mu} \\equiv {^{\\ast}\\!F}^{\\mu \\nu} u_{\\nu}$\n- Dual electromagnetic field tensor: ${^{\\ast}\\!F}^{\\mu \\nu}$\n- Fluid four-velocity: $u^{\\nu}$\n- Spacetime: Flat, with Minkowski metric signature $\\eta_{\\mu\\nu} = \\text{diag}(-1, 1, 1, 1)$\n- Units: Speed of light $c=1$, Heaviside–Lorentz electromagnetic units.\n- Ideal MHD condition: $\\mathbf{E} + \\mathbf{v} \\times \\mathbf{B} = \\mathbf{0}$, where $\\mathbf{E}$ and $\\mathbf{B}$ are laboratory-frame fields and $\\mathbf{v}$ is the fluid three-velocity.\n- Lorentz factor: $\\Gamma \\equiv (1 - v^{2})^{-1/2}$, with $v^{2} \\equiv \\mathbf{v} \\cdot \\mathbf{v}$.\n- Numerical data for Part 3:\n    - Laboratory-frame magnetic field: $\\mathbf{B} = (3, 4, 12)$\n    - Fluid three-velocity: $\\mathbf{v} = (0.6, 0.3, 0.0)$\n    - Enthalpy density: $w = 50$\n- Definition of magnetization parameter: $\\sigma \\equiv b^{2}/w$\n- Definition of scalar square: $b^2 \\equiv b^{\\mu} b_{\\mu}$\n- Final answer requirement: Round the final value for $\\sigma$ to $4$ significant figures.\n\n**Step 2: Validate Using Extracted Givens**\n\n- **Scientifically Grounded**: The problem is firmly rooted in the standard formalism of special relativistic ideal magnetohydrodynamics. The definitions, such as that for $b^{\\mu}$, the Lorentz factor $\\Gamma$, the ideal MHD condition, and the structure of the electromagnetic tensors, are standard textbook material.\n- **Well-Posed**: The problem is structured as a guided derivation followed by a numerical calculation. All necessary information is provided for each step. The tasks are clearly defined, leading to a unique solution.\n- **Objective**: The problem uses precise mathematical and physical terminology without ambiguity or subjective language.\n- **Completeness and Consistency**: The provided definitions and constraints are self-consistent and sufficient to solve the problem. The definition of $b^{\\mu}$ is explicit, avoiding potential convention ambiguities.\n- **Other Flaws**: The problem does not exhibit any of the listed flaws. It is a valid, formal problem in computational astrophysics.\n\n**Step 3: Verdict and Action**\n\nThe problem is deemed **valid**. The solution will now be derived.\n\n### Solution Derivation\n\nThe solution consists of three parts as requested.\n\n**Part 1: Express $b^{\\mu}$ in terms of lab-frame quantities**\n\nWe begin with the definition $b^{\\mu} = {^{\\ast}\\!F}^{\\mu \\nu} u_{\\nu}$. The components of the four-velocity $u^{\\mu}$ and its covariant form $u_{\\mu}$ are:\n$$ u^{\\mu} = (\\Gamma, \\Gamma \\mathbf{v}) = (\\Gamma, \\Gamma v^x, \\Gamma v^y, \\Gamma v^z) $$\n$$ u_{\\mu} = \\eta_{\\mu\\nu}u^{\\nu} = (-\\Gamma, \\Gamma \\mathbf{v}) = (-\\Gamma, \\Gamma v_x, \\Gamma v_y, \\Gamma v_z) $$\nThe dual electromagnetic field tensor ${^{\\ast}\\!F}^{\\mu\\nu}$ in terms of the laboratory-frame electric field $\\mathbf{E}$ and magnetic field $\\mathbf{B}$ is:\n$$ {^{\\ast}\\!F}^{\\mu\\nu} = \\begin{pmatrix} 0 & -B_x & -B_y & -B_z \\\\ B_x & 0 & E_z & -E_y \\\\ B_y & -E_z & 0 & E_x \\\\ B_z & E_y & -E_x & 0 \\end{pmatrix} $$\nWe now compute the components of $b^{\\mu}$ by matrix-vector multiplication.\n\nThe time component, $b^0$:\n$$ b^0 = {^{\\ast}\\!F}^{0\\nu}u_{\\nu} = {^{\\ast}\\!F}^{00}u_0 + {^{\\ast}\\!F}^{01}u_1 + {^{\\ast}\\!F}^{02}u_2 + {^{\\ast}\\!F}^{03}u_3 $$\n$$ b^0 = (0)(-\\Gamma) + (-B_x)(\\Gamma v_x) + (-B_y)(\\Gamma v_y) + (-B_z)(\\Gamma v_z) = -\\Gamma (B_x v_x + B_y v_y + B_z v_z) $$\n$$ b^0 = -\\Gamma(\\mathbf{B} \\cdot \\mathbf{v}) $$\n\nThe spatial components, $b^i$ (where $i=1,2,3$ corresponds to $x,y,z$), form a three-vector $\\mathbf{b}$. Let's compute $b^1$:\n$$ b^1 = {^{\\ast}\\!F}^{1\\nu}u_{\\nu} = {^{\\ast}\\!F}^{10}u_0 + {^{\\ast}\\!F}^{11}u_1 + {^{\\ast}\\!F}^{12}u_2 + {^{\\ast}\\!F}^{13}u_3 $$\n$$ b^1 = (B_x)(-\\Gamma) + (0)(\\Gamma v_x) + (E_z)(\\Gamma v_y) + (-E_y)(\\Gamma v_z) = \\Gamma[-B_x + (E_z v_y - E_y v_z)] = \\Gamma[-B_x + (\\mathbf{v} \\times \\mathbf{E})_x] $$\nGeneralizing to all three spatial components:\n$$ \\mathbf{b} = \\Gamma(-\\mathbf{B} + \\mathbf{v} \\times \\mathbf{E}) $$\nNow we apply the ideal MHD condition, $\\mathbf{E} = -\\mathbf{v} \\times \\mathbf{B}$.\n$$ \\mathbf{b} = \\Gamma(-\\mathbf{B} + \\mathbf{v} \\times (-\\mathbf{v} \\times \\mathbf{B})) = \\Gamma(-\\mathbf{B} - \\mathbf{v} \\times (\\mathbf{v} \\times \\mathbf{B})) $$\nUsing the vector triple product identity $\\mathbf{A} \\times (\\mathbf{B} \\times \\mathbf{C}) = \\mathbf{B}(\\mathbf{A}\\cdot\\mathbf{C}) - \\mathbf{C}(\\mathbf{A}\\cdot\\mathbf{B})$, we get:\n$$ \\mathbf{v} \\times (\\mathbf{v} \\times \\mathbf{B}) = \\mathbf{v}(\\mathbf{v}\\cdot\\mathbf{B}) - \\mathbf{B}(\\mathbf{v}\\cdot\\mathbf{v}) = \\mathbf{v}(\\mathbf{v}\\cdot\\mathbf{B}) - \\mathbf{B}v^2 $$\nSubstituting this back into the expression for $\\mathbf{b}$:\n$$ \\mathbf{b} = \\Gamma(-\\mathbf{B} - [\\mathbf{v}(\\mathbf{v}\\cdot\\mathbf{B}) - \\mathbf{B}v^2]) = \\Gamma(-\\mathbf{B} - \\mathbf{v}(\\mathbf{v}\\cdot\\mathbf{B}) + \\mathbf{B}v^2) $$\n$$ \\mathbf{b} = \\Gamma(-\\mathbf{B}(1-v^2) - \\mathbf{v}(\\mathbf{B}\\cdot\\mathbf{v})) $$\nUsing the definition $\\Gamma = (1-v^2)^{-1/2}$, we have $1-v^2 = 1/\\Gamma^2$:\n$$ \\mathbf{b} = \\Gamma(-\\frac{\\mathbf{B}}{\\Gamma^2} - (\\mathbf{B}\\cdot\\mathbf{v})\\mathbf{v}) = -\\frac{\\mathbf{B}}{\\Gamma} - \\Gamma(\\mathbf{B} \\cdot \\mathbf{v})\\mathbf{v} $$\nThus, the four-vector $b^{\\mu} = (b^0, \\mathbf{b})$ is expressed as:\n$$ b^{\\mu} = \\left(-\\Gamma(\\mathbf{B} \\cdot \\mathbf{v}), -\\frac{\\mathbf{B}}{\\Gamma} - \\Gamma(\\mathbf{B} \\cdot \\mathbf{v})\\mathbf{v}\\right) $$\n\n**Part 2: Derive an expression for $b^2 \\equiv b^{\\mu} b_{\\mu}$**\n\nThe scalar square $b^2$ is a Lorentz invariant. With the $(-,+,+,+)$ metric signature, it is computed as:\n$$ b^2 = b^{\\mu} b_{\\mu} = -(b^0)^2 + \\mathbf{b} \\cdot \\mathbf{b} $$\nSubstitute the components derived in Part 1:\n$$ b^2 = -(-\\Gamma(\\mathbf{B} \\cdot \\mathbf{v}))^2 + \\left(-\\frac{\\mathbf{B}}{\\Gamma} - \\Gamma(\\mathbf{B} \\cdot \\mathbf{v})\\mathbf{v}\\right) \\cdot \\left(-\\frac{\\mathbf{B}}{\\Gamma} - \\Gamma(\\mathbf{B} \\cdot \\mathbf{v})\\mathbf{v}\\right) $$\n$$ b^2 = -\\Gamma^2(\\mathbf{B} \\cdot \\mathbf{v})^2 + \\left(\\frac{\\mathbf{B}}{\\Gamma} + \\Gamma(\\mathbf{B} \\cdot \\mathbf{v})\\mathbf{v}\\right) \\cdot \\left(\\frac{\\mathbf{B}}{\\Gamma} + \\Gamma(\\mathbf{B} \\cdot \\mathbf{v})\\mathbf{v}\\right) $$\nExpanding the dot product:\n$$ b^2 = -\\Gamma^2(\\mathbf{B} \\cdot \\mathbf{v})^2 + \\left(\\frac{\\mathbf{B}}{\\Gamma} \\cdot \\frac{\\mathbf{B}}{\\Gamma}\\right) + 2\\left(\\frac{\\mathbf{B}}{\\Gamma} \\cdot \\Gamma(\\mathbf{B} \\cdot \\mathbf{v})\\mathbf{v}\\right) + \\left(\\Gamma(\\mathbf{B} \\cdot \\mathbf{v})\\mathbf{v} \\cdot \\Gamma(\\mathbf{B} \\cdot \\mathbf{v})\\mathbf{v}\\right) $$\n$$ b^2 = -\\Gamma^2(\\mathbf{B} \\cdot \\mathbf{v})^2 + \\frac{|\\mathbf{B}|^2}{\\Gamma^2} + 2(\\mathbf{B} \\cdot \\mathbf{v})^2 + \\Gamma^2(\\mathbf{B} \\cdot \\mathbf{v})^2 v^2 $$\nLet's group the terms with $(\\mathbf{B} \\cdot \\mathbf{v})^2$:\n$$ b^2 = \\frac{|\\mathbf{B}|^2}{\\Gamma^2} + (\\mathbf{B} \\cdot \\mathbf{v})^2(-\\Gamma^2 + 2 + \\Gamma^2 v^2) $$\nThe factor multiplying $(\\mathbf{B} \\cdot \\mathbf{v})^2$ simplifies significantly:\n$$ -\\Gamma^2 + 2 + \\Gamma^2 v^2 = -\\Gamma^2(1 - v^2) + 2 $$\nSince $\\Gamma^2(1-v^2) = 1$, this becomes:\n$$ -1 + 2 = 1 $$\nTherefore, the expression for $b^2$ simplifies to:\n$$ b^2 = \\frac{|\\mathbf{B}|^2}{\\Gamma^2} + (\\mathbf{B} \\cdot \\mathbf{v})^2 $$\nThis is the desired scalar expression.\n\n**Part 3: Evaluate $b^2$ and $\\sigma$ for the given numerical values**\n\nWe are given:\n- $\\mathbf{B} = (3, 4, 12)$\n- $\\mathbf{v} = (0.6, 0.3, 0.0)$\n- $w = 50$\n\nFirst, we calculate the required scalar quantities.\nThe squared magnitude of the fluid velocity:\n$$ v^2 = \\mathbf{v} \\cdot \\mathbf{v} = (0.6)^2 + (0.3)^2 + (0.0)^2 = 0.36 + 0.09 = 0.45 $$\nThe squared Lorentz factor:\n$$ \\Gamma^2 = \\frac{1}{1 - v^2} = \\frac{1}{1 - 0.45} = \\frac{1}{0.55} = \\frac{1}{11/20} = \\frac{20}{11} $$\nThe squared magnitude of the magnetic field:\n$$ |\\mathbf{B}|^2 = \\mathbf{B} \\cdot \\mathbf{B} = 3^2 + 4^2 + 12^2 = 9 + 16 + 144 = 169 $$\nThe dot product of $\\mathbf{B}$ and $\\mathbf{v}$:\n$$ \\mathbf{B} \\cdot \\mathbf{v} = (3)(0.6) + (4)(0.3) + (12)(0.0) = 1.8 + 1.2 + 0.0 = 3.0 $$\nThe square of this dot product:\n$$ (\\mathbf{B} \\cdot \\mathbf{v})^2 = (3.0)^2 = 9.0 $$\n\nNow, substitute these values into the expression for $b^2$:\n$$ b^2 = \\frac{|\\mathbf{B}|^2}{\\Gamma^2} + (\\mathbf{B} \\cdot \\mathbf{v})^2 = \\frac{169}{20/11} + 9.0 $$\n$$ b^2 = 169 \\times \\frac{11}{20} + 9.0 = \\frac{1859}{20} + 9.0 = 92.95 + 9.0 = 101.95 $$\nFinally, we compute the magnetization parameter $\\sigma$:\n$$ \\sigma = \\frac{b^2}{w} = \\frac{101.95}{50} = 2.039 $$\nThe problem requires rounding the final answer to $4$ significant figures. The calculated value $2.039$ already has exactly $4$ significant figures, so no further rounding is needed.", "answer": "$$\\boxed{2.039}$$", "id": "3517930"}, {"introduction": "Simulating jets using cylindrical or spherical coordinates is computationally efficient but introduces a coordinate singularity at the symmetry axis that can generate non-physical numerical errors. This practice delves into the crucial task of \"regularizing\" the numerical scheme to handle these geometric source terms correctly, a common challenge in computational astrophysics. By comparing a naive discretization with a properly formulated finite-volume approach, you will see how enforcing physical symmetry conditions at the axis is essential for preventing spurious forces and maintaining the integrity of the simulation [@problem_id:3517917].", "problem": "You are modeling axisymmetric jets and outflows in cylindrical coordinates and need to handle the coordinate singularity at the symmetry axis. Consider an axisymmetric control volume in cylindrical coordinates with radial coordinate $R \\ge 0$, where the continuity equation reads, for mass density $\\rho$ and velocity components $v_{R}$ and $v_{z}$,\n$$\\frac{\\partial \\rho}{\\partial t} + \\frac{1}{R}\\frac{\\partial}{\\partial R}\\left(R \\rho v_{R}\\right) + \\frac{\\partial}{\\partial z}\\left(\\rho v_{z}\\right) = 0.$$\nDefine $A_{R}(R) \\equiv \\rho v_{R}$ as the radial mass flux density. Near the axis, physical symmetry of an axisymmetric jet or outflow implies $v_{R}$ is an odd function of $R$ and $\\rho$ is an even function of $R$, so that $A_{R}$ has an odd Taylor expansion of the form\n$$A_{R}(R) = a_{0} + a_{1} R + a_{3} R^{3},$$\nwhere $a_{0}$ encodes non-physical even contamination that may arise numerically, $a_{1}$ captures the physically allowed leading-order odd behavior, and $a_{3}$ captures higher-order odd behavior. The geometric divergence operator\n$$\\mathcal{L}[A_{R}] \\equiv \\frac{1}{R}\\frac{\\partial}{\\partial R}\\left(R A_{R}\\right)$$\nis singular at $R=0$ in its pointwise differential form, but its physical limit exists and must be captured by any numerical method without generating spurious forces.\n\nTasks:\n- Starting only from the continuity equation and Taylor expansions, derive the finite limit of $\\mathcal{L}[A_{R}]$ as $R \\to 0$ given the odd-parity condition. Your derivation must not assume any pre-known specialized regularization formula and must begin with the definitions and the Taylor expansion.\n- Consider a one-dimensional uniform radial grid with cell centers at $R_{i} = \\left(i + \\tfrac{1}{2}\\right)\\Delta R$ for integer $i \\ge 0$, so the first two centers are $R_{0} = \\tfrac{1}{2}\\Delta R$ and $R_{1} = \\tfrac{3}{2}\\Delta R$. Define $A_{i} \\equiv A_{R}(R_{i})$ for $i \\in \\{0,1\\}$.\n\n  Implement two discrete approximations of $\\mathcal{L}[A_{R}]$ at the first cell center $R_{0}$:\n  - A naive pointwise central-difference approximation that directly discretizes $\\mathcal{L}[A_{R}] = \\tfrac{1}{R}\\tfrac{\\partial}{\\partial R}(R A_{R})$ at $R_{0}$ using a centered difference for the radial derivative and an even reflection for the ghost value at $i=-1$, i.e., $A_{-1} = A_{0}$ at $R_{-1} = -\\tfrac{1}{2}\\Delta R$. This produces\n    $$\\mathcal{L}_{\\mathrm{naive}}(R_{0}) \\approx \\frac{1}{R_{0}}\\cdot \\frac{R_{1}A_{1} - R_{-1}A_{-1}}{2\\Delta R}.$$\n    This reflects a solver that does not enforce the correct odd parity at the axis.\n  - A regularized finite-volume approximation that enforces odd parity and zero net flux through the axis face, derived from the conservative integral form over the first control volume $[0,\\Delta R]$ with inner face at $R_{-1/2} = 0$ and outer face at $R_{+1/2} = \\Delta R$. Estimate the face-centered value $A_{R}$ at $R_{+1/2}$ by first removing the even contamination via a local linear fit to $A(R)$ using the two nearest centers and subtracting the fitted intercept at $R=0$, then linearly interpolating to the face. The resulting finite-volume form for the divergence at $R_{0}$ is\n    $$\\mathcal{L}_{\\mathrm{reg}}(R_{0}) \\approx \\frac{R_{+1/2} \\, A_{+1/2}^{\\mathrm{odd}} - R_{-1/2}\\, A_{-1/2}^{\\mathrm{odd}}}{R_{0}\\,\\Delta R},$$\n    with $A_{-1/2}^{\\mathrm{odd}} = 0$ by symmetry and $A_{+1/2}^{\\mathrm{odd}}$ obtained by odd-parity projection followed by linear interpolation.\n\n- For each case, define the absolute axis divergence error as $e_{\\mathrm{naive}} \\equiv \\left|\\mathcal{L}_{\\mathrm{naive}}(R_{0}) - \\mathcal{L}_{\\mathrm{exact}}(0)\\right|$ and $e_{\\mathrm{reg}} \\equiv \\left|\\mathcal{L}_{\\mathrm{reg}}(R_{0}) - \\mathcal{L}_{\\mathrm{exact}}(0)\\right|$, where $\\mathcal{L}_{\\mathrm{exact}}(0)$ is the analytical axis limit you derived. Quantify the numerical impact of the axis singularity and the efficacy of regularization by the ratio\n  $$\\mathcal{R} \\equiv \\frac{e_{\\mathrm{naive}}}{\\max\\left(e_{\\mathrm{reg}}, \\epsilon\\right)},$$\n  where $\\epsilon$ is a small positive constant to prevent division by zero. Use $\\epsilon = 10^{-18}$. The ratio $\\mathcal{R}$ is dimensionless and must be reported as a float.\n\n- Implement a complete, runnable program that, for each test case below, computes and outputs $\\mathcal{R}$ as defined above.\n\nUse the following test suite, where each case specifies $(a_{0}, a_{1}, a_{3}, \\Delta R)$, all dimensionless:\n- Case $1$: $(0, 1, 0, 10^{-3})$.\n- Case $2$: $(10^{-3}, 1, 0, 10^{-2})$.\n- Case $3$: $(2\\times 10^{-4}, 0.3, -2.0, 5\\times 10^{-2})$.\n- Case $4$: $(-5\\times 10^{-5}, 2.0, 10.0, 2\\times 10^{-1})$.\n- Case $5$: $(10^{-6}, 0.0, 5.0, 10^{-2})$.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order of the test suite above, for example, $[\\mathcal{R}_{1},\\mathcal{R}_{2},\\mathcal{R}_{3},\\mathcal{R}_{4},\\mathcal{R}_{5}]$.\n- The outputs are pure, dimensionless floats.", "solution": "The problem statement is evaluated to be valid. It is scientifically grounded in the principles of computational fluid dynamics, specifically the treatment of coordinate singularities in the Euler equations. The problem is well-posed, with all necessary definitions, constants, and boundary conditions provided to derive a unique, verifiable solution. The terminology is precise and objective. The tasks are mathematically formalizable and directly relevant to the topic of modeling astrophysical jets.\n\nThe solution proceeds in four stages:\n1.  Derivation of the exact analytical limit of the divergence operator at the symmetry axis.\n2.  Analysis of the naive numerical approximation and its associated error.\n3.  Analysis of the regularized finite-volume approximation and its associated error.\n4.  Calculation of the error ratio $\\mathcal{R}$ for each test case.\n\n**1. Derivation of the Exact Axis Divergence**\n\nThe radial divergence operator is defined as $\\mathcal{L}[A_{R}] \\equiv \\frac{1}{R}\\frac{\\partial}{\\partial R}\\left(R A_{R}\\right)$. The radial mass flux density $A_{R}(R)$ is given by the Taylor expansion $A_{R}(R) = a_{0} + a_{1} R + a_{3} R^{3}$.\n\nFirst, we compute the product inside the derivative:\n$$R A_{R}(R) = R (a_{0} + a_{1} R + a_{3} R^{3}) = a_{0} R + a_{1} R^{2} + a_{3} R^{4}$$\nNext, we take the partial derivative with respect to $R$:\n$$\\frac{\\partial}{\\partial R}\\left(R A_{R}(R)\\right) = \\frac{\\partial}{\\partial R}\\left(a_{0} R + a_{1} R^{2} + a_{3} R^{4}\\right) = a_{0} + 2 a_{1} R + 4 a_{3} R^{3}$$\nFinally, we apply the $\\frac{1}{R}$ factor to obtain the full expression for the operator:\n$$\\mathcal{L}[A_{R}] = \\frac{1}{R} \\left(a_{0} + 2 a_{1} R + 4 a_{3} R^{3}\\right) = \\frac{a_{0}}{R} + 2 a_{1} + 4 a_{3} R^{2}$$\nTo find the physical limit at the axis, we take the limit as $R \\to 0$. The problem states that for a physical, axisymmetric flow, the radial velocity $v_{R}$ is an odd function of $R$ and the density $\\rho$ is an even function of $R$. Consequently, their product, the mass flux $A_R = \\rho v_R$, must be an odd function of $R$. An odd function's Taylor series around $R=0$ contains only odd powers of $R$. Therefore, the coefficient of the even power $R^0$, which is $a_0$, must be zero for a physically correct flow. The term $a_0$ is explicitly described as \"non-physical even contamination\" that may arise numerically. Under the physical constraint $a_0 = 0$, the limit is:\n$$\\mathcal{L}_{\\mathrm{exact}}(0) \\equiv \\lim_{R \\to 0, a_0=0} \\mathcal{L}[A_{R}] = \\lim_{R \\to 0} \\left(2 a_{1} + 4 a_{3} R^{2}\\right) = 2 a_{1}$$\nThis is the exact, non-singular value of the divergence at the symmetry axis.\n\n**2. Analysis of the Naive Numerical Scheme**\n\nThe naive central-difference approximation is applied at the first cell center, $R_{0} = \\frac{1}{2}\\Delta R$. The formula is:\n$$\\mathcal{L}_{\\mathrm{naive}}(R_{0}) = \\frac{1}{R_{0}}\\cdot \\frac{R_{1}A_{1} - R_{-1}A_{-1}}{2\\Delta R}$$\nThe grid locations are $R_{1} = \\frac{3}{2}\\Delta R$ and $R_{-1} = -\\frac{1}{2}\\Delta R$. The boundary condition is an even reflection, $A_{-1} = A_{0}$. Substituting these into the formula:\n$$\\mathcal{L}_{\\mathrm{naive}}(R_{0}) = \\frac{1}{\\frac{1}{2}\\Delta R} \\cdot \\frac{(\\frac{3}{2}\\Delta R)A_{1} - (-\\frac{1}{2}\\Delta R)A_{0}}{2\\Delta R} = \\frac{2}{\\Delta R} \\cdot \\frac{\\frac{\\Delta R}{2}(3 A_1 + A_0)}{2\\Delta R} = \\frac{3 A_1 + A_0}{2\\Delta R}$$\nTo analyze the error, we express $A_{0} \\equiv A_{R}(R_{0})$ and $A_{1} \\equiv A_{R}(R_{1})$ using the given expansion:\n$$A_{0} = a_{0} + a_{1}\\left(\\frac{1}{2}\\Delta R\\right) + a_{3}\\left(\\frac{1}{2}\\Delta R\\right)^{3} = a_{0} + \\frac{1}{2}a_{1}\\Delta R + \\frac{1}{8}a_{3}(\\Delta R)^{3}$$\n$$A_{1} = a_{0} + a_{1}\\left(\\frac{3}{2}\\Delta R\\right) + a_{3}\\left(\\frac{3}{2}\\Delta R\\right)^{3} = a_{0} + \\frac{3}{2}a_{1}\\Delta R + \\frac{27}{8}a_{3}(\\Delta R)^{3}$$\nSubstituting these into the expression for $\\mathcal{L}_{\\mathrm{naive}}(R_{0})$:\n$$3A_{1} + A_{0} = 3\\left(a_{0} + \\frac{3}{2}a_{1}\\Delta R + \\frac{27}{8}a_{3}(\\Delta R)^{3}\\right) + \\left(a_{0} + \\frac{1}{2}a_{1}\\Delta R + \\frac{1}{8}a_{3}(\\Delta R)^{3}\\right)$$\n$$3A_{1} + A_{0} = 4a_{0} + \\left(\\frac{9}{2} + \\frac{1}{2}\\right)a_{1}\\Delta R + \\left(\\frac{81}{8} + \\frac{1}{8}\\right)a_{3}(\\Delta R)^{3} = 4a_{0} + 5a_{1}\\Delta R + \\frac{82}{8}a_{3}(\\Delta R)^{3}$$\n$$\\mathcal{L}_{\\mathrm{naive}}(R_{0}) = \\frac{4a_{0} + 5a_{1}\\Delta R + 10.25 a_{3}(\\Delta R)^{3}}{2\\Delta R} = \\frac{2a_{0}}{\\Delta R} + 2.5 a_{1} + 5.125 a_{3}(\\Delta R)^{2}$$\nThe error is $e_{\\mathrm{naive}} = |\\mathcal{L}_{\\mathrm{naive}}(R_{0}) - \\mathcal{L}_{\\mathrm{exact}}(0)|$:\n$$e_{\\mathrm{naive}} = \\left|\\left(\\frac{2a_{0}}{\\Delta R} + 2.5 a_{1} + 5.125 a_{3}(\\Delta R)^{2}\\right) - 2a_{1}\\right| = \\left|\\frac{2a_{0}}{\\Delta R} + 0.5 a_{1} + 5.125 a_{3}(\\Delta R)^{2}\\right|$$\nThis scheme suffers from a term proportional to $a_{0}/\\Delta R$, which diverges as $\\Delta R \\to 0$ if the non-physical contamination $a_{0}$ is present.\n\n**3. Analysis of the Regularized Numerical Scheme**\n\nThe regularized finite-volume approximation over the first cell $[0, \\Delta R]$ is:\n$$\\mathcal{L}_{\\mathrm{reg}}(R_{0}) = \\frac{R_{+1/2} \\, A_{+1/2}^{\\mathrm{odd}} - R_{-1/2}\\, A_{-1/2}^{\\mathrm{odd}}}{R_{0}\\,\\Delta R}$$\nwith faces at $R_{-1/2} = 0$ and $R_{+1/2} = \\Delta R$. The cell center is $R_0 = \\frac{1}{2}\\Delta R$. By symmetry, the flux through the axis is zero, so $A_{-1/2}^{\\mathrm{odd}} = 0$. The formula simplifies to:\n$$\\mathcal{L}_{\\mathrm{reg}}(R_{0}) = \\frac{(\\Delta R) A_{+1/2}^{\\mathrm{odd}}}{(\\frac{1}{2}\\Delta R)\\Delta R} = \\frac{2 A_{+1/2}^{\\mathrm{odd}}}{\\Delta R}$$\nTo find $A_{+1/2}^{\\mathrm{odd}}$, we follow the specified procedure. First, we perform a local linear fit $f(R) = mR+c$ using values at the centers $R_0$ and $R_1$. The intercept $c$ estimates the even contamination $a_0$.\n$$m = \\frac{A_1 - A_0}{R_1 - R_0} = \\frac{A_1 - A_0}{\\Delta R}$$\n$$c = A_0 - m R_0 = A_0 - \\left(\\frac{A_1 - A_0}{\\Delta R}\\right)\\left(\\frac{1}{2}\\Delta R\\right) = \\frac{3}{2}A_0 - \\frac{1}{2}A_1$$\nNext, we define a projected function $A^{\\mathrm{odd}}_{\\text{local}}(R) = A(R) - c$ that has the contamination removed. We evaluate this function at the cell centers $R_0$ and $R_1$:\n$$A'_{0} = A_0 - c = A_0 - (\\frac{3}{2}A_0 - \\frac{1}{2}A_1) = -\\frac{1}{2}A_0 + \\frac{1}{2}A_1$$\n$$A'_{1} = A_1 - c = A_1 - (\\frac{3}{2}A_0 - \\frac{1}{2}A_1) = -\\frac{3}{2}A_0 + \\frac{3}{2}A_1$$\nFinally, we linearly interpolate between the points $(R_0, A'_{0})$ and $(R_1, A'_{1})$ to find the value at the face $R_{+1/2} = \\Delta R$:\n$$A_{+1/2}^{\\mathrm{odd}} = A'_{0} + (A'_{1} - A'_{0})\\frac{\\Delta R - R_0}{R_1 - R_0} = \\left(-\\frac{1}{2}A_0 + \\frac{1}{2}A_1\\right) + (-A_0 + A_1)\\frac{\\frac{1}{2}\\Delta R}{\\Delta R} = A_1 - A_0$$\nSubstituting this result back into the expression for $\\mathcal{L}_{\\mathrm{reg}}(R_{0})$:\n$$\\mathcal{L}_{\\mathrm{reg}}(R_{0}) = \\frac{2(A_1 - A_0)}{\\Delta R}$$\nTo analyze the error, we use the expressions for $A_0$ and $A_1$:\n$$A_1 - A_0 = \\left(a_{0} + \\frac{3}{2}a_{1}\\Delta R + \\frac{27}{8}a_{3}(\\Delta R)^{3}\\right) - \\left(a_{0} + \\frac{1}{2}a_{1}\\Delta R + \\frac{1}{8}a_{3}(\\Delta R)^{3}\\right)$$\n$$A_1 - A_0 = a_1 \\Delta R + \\frac{26}{8}a_3(\\Delta R)^3 = a_1\\Delta R + 3.25 a_3(\\Delta R)^3$$\n$$\\mathcal{L}_{\\mathrm{reg}}(R_{0}) = \\frac{2}{\\Delta R}\\left(a_1\\Delta R + 3.25 a_3(\\Delta R)^3\\right) = 2a_1 + 6.5 a_3 (\\Delta R)^2$$\nThe error is $e_{\\mathrm{reg}} = |\\mathcal{L}_{\\mathrm{reg}}(R_0) - \\mathcal{L}_{\\mathrm{exact}}(0)|$:\n$$e_{\\mathrm{reg}} = |\\left(2a_1 + 6.5 a_3 (\\Delta R)^2\\right) - 2a_1| = |6.5 a_3 (\\Delta R)^2|$$\nThis scheme is second-order accurate and correctly eliminates the divergent term associated with $a_0$.\n\n**4. Calculation of the Error Ratio**\n\nThe ratio is $\\mathcal{R} \\equiv \\frac{e_{\\mathrm{naive}}}{\\max\\left(e_{\\mathrm{reg}}, \\epsilon\\right)}$, with $\\epsilon = 10^{-18}$. Using the derived analytical error expressions:\n\nCase 1: $(a_0, a_1, a_3, \\Delta R) = (0, 1, 0, 10^{-3})$\n$e_{\\mathrm{naive}} = |0.5(1)| = 0.5$\n$e_{\\mathrm{reg}} = |6.5(0)(10^{-3})^2| = 0$\n$\\mathcal{R} = \\frac{0.5}{\\max(0, 10^{-18})} = 5 \\times 10^{17}$\n\nCase 2: $(a_0, a_1, a_3, \\Delta R) = (10^{-3}, 1, 0, 10^{-2})$\n$e_{\\mathrm{naive}} = |\\frac{2(10^{-3})}{10^{-2}} + 0.5(1)| = |0.2 + 0.5| = 0.7$\n$e_{\\mathrm{reg}} = |6.5(0)(10^{-2})^2| = 0$\n$\\mathcal{R} = \\frac{0.7}{\\max(0, 10^{-18})} = 7 \\times 10^{17}$\n\nCase 3: $(a_0, a_1, a_3, \\Delta R) = (2\\times 10^{-4}, 0.3, -2.0, 5\\times 10^{-2})$\n$e_{\\mathrm{naive}} = |\\frac{2(2\\times 10^{-4})}{0.05} + 0.5(0.3) + 5.125(-2)(0.05)^2| = |0.008 + 0.15 - 0.025625| = 0.132375$\n$e_{\\mathrm{reg}} = |6.5(-2.0)(0.05)^2| = |-0.0325| = 0.0325$\n$\\mathcal{R} = \\frac{0.132375}{0.0325} \\approx 4.0730769$\n\nCase 4: $(a_0, a_1, a_3, \\Delta R) = (-5\\times 10^{-5}, 2.0, 10.0, 2\\times 10^{-1})$\n$e_{\\mathrm{naive}} = |\\frac{2(-5\\times 10^{-5})}{0.2} + 0.5(2.0) + 5.125(10)(0.2)^2| = |-0.0005 + 1.0 + 2.05| = 3.0495$\n$e_{\\mathrm{reg}} = |6.5(10.0)(0.2)^2| = |2.6| = 2.6$\n$\\mathcal{R} = \\frac{3.0495}{2.6} \\approx 1.1728846$\n\nCase 5: $(a_0, a_1, a_3, \\Delta R) = (10^{-6}, 0.0, 5.0, 10^{-2})$\n$e_{\\mathrm{naive}} = |\\frac{2(10^{-6})}{0.01} + 0.5(0) + 5.125(5)(0.01)^2| = |0.0002 + 0.0025625| = 0.0027625$\n$e_{\\mathrm{reg}} = |6.5(5.0)(0.01)^2| = |0.00325| = 0.00325$\n$\\mathcal{R} = \\frac{0.0027625}{0.00325} = 0.85$", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n# from scipy import ...\n\ndef solve():\n    \"\"\"\n    Computes the ratio of errors between a naive and a regularized numerical\n    scheme for the divergence operator at the axis of a cylindrical coordinate system.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (a0, a1, a3, delta_R)\n    test_cases = [\n        (0.0, 1.0, 0.0, 1e-3),\n        (1e-3, 1.0, 0.0, 1e-2),\n        (2e-4, 0.3, -2.0, 5e-2),\n        (-5e-5, 2.0, 10.0, 2e-1),\n        (1e-6, 0.0, 5.0, 1e-2),\n    ]\n\n    epsilon = 1e-18\n    results = []\n\n    for case in test_cases:\n        a0, a1, a3, delta_R = case\n\n        # Analytical value of the divergence at the R=0 axis.\n        # L_exact(0) = 2 * a1\n        L_exact = 2.0 * a1\n\n        # Define the radial mass flux density function A_R(R)\n        def A_R(R):\n            return a0 + a1 * R + a3 * R**3\n\n        # Define grid cell centers\n        R0 = 0.5 * delta_R\n        R1 = 1.5 * delta_R\n\n        # Evaluate A_R at cell centers\n        A0 = A_R(R0)\n        A1 = A_R(R1)\n\n        # --- Naive Approximation ---\n        # L_naive = (1/R0) * (R1*A1 - R_m1*A_m1) / (2*delta_R)\n        # where R_m1 = -R0 and A_m1 = A0 (even reflection)\n        # This simplifies to: L_naive = (3*A1 + A0) / (2*delta_R)\n        L_naive = (3.0 * A1 + A0) / (2.0 * delta_R)\n        \n        # --- Regularized Approximation ---\n        # The derivation in the solution text shows that the complex procedure\n        # described in the problem simplifies to:\n        # L_reg = 2 * (A1 - A0) / delta_R\n        L_reg = 2.0 * (A1 - A0) / delta_R\n\n        # --- Errors and Ratio ---\n        e_naive = abs(L_naive - L_exact)\n        e_reg = abs(L_reg - L_exact)\n\n        # The ratio R quantifies the improvement of the regularized scheme.\n        R_val = e_naive / max(e_reg, epsilon)\n        results.append(R_val)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3517917"}, {"introduction": "The striking structures observed in astrophysical jets, such as knots and sheaths, are often the result of instabilities that grow as the jet propagates through the ambient medium. This exercise provides a powerful link between the analytical theory of the Kelvin-Helmholtz Instability (KHI) and its numerical exploration in the context of a relativistic, magnetized jet. By implementing a model for the instability's growth rate, you will investigate how key jet parameters like Lorentz factor $\\Gamma$, magnetization $\\sigma$, and magnetic field pitch $P$ work to either drive or suppress instabilities that shape the jet's morphology and evolution [@problem_id:3517935].", "problem": "Consider a cold, cylindrical relativistic jet of radius $r_0$ with a uniform axial bulk flow along the $z$-axis of speed $v_j$ and Lorentz factor $\\Gamma_j = (1 - v_j^2)^{-1/2}$. The jet is embedded in a static ambient medium. We adopt ideal Relativistic Magnetohydrodynamics (RMHD), assume an incompressible, thin shear layer at the jet boundary that can be treated locally as a planar tangential discontinuity of half-thickness $a \\ll r_0$, and focus on axisymmetric surface perturbations with axial wavenumber $k$ in the laboratory frame. The jet carries a helical magnetic field with axial component $B_z$ and azimuthal component $B_\\phi$, characterized by a pitch parameter $P = B_\\phi/(r_0 B_z)$, while the ambient is taken unmagnetized. Throughout, use natural units with the speed of light $c = 1$ and normalize all lengths to $r_0 = 1$, so frequencies and growth rates are in units of the inverse light-crossing time $r_0/c$.\n\nFrom the RMHD energy-momentum tensor with electromagnetic contributions and ideal Ohm’s law, linearize about the base state and consider incompressible perturbations whose amplitude decays away from the interface. For a planar interface between two semi-infinite uniform states labeled by $j \\in \\{1,2\\}$ (jet $j=1$, ambient $j=2$), the linearized normal stress balance for surface modes with wavenumber $k$ and complex frequency $\\omega$ yields a quadratic dispersion relation that can be written in a compact, inertia-tension balance form when the magnetic field is parallel to the flow direction. In the cold-plasma limit, the relativistic inertia per unit volume on side $j$ is $I_j = w_j + b_j^2$, where $w_j$ is the enthalpy density and $b_j^2$ is the magnetic field strength squared in the co-moving frame. The axial magnetic tension entering the surface-mode balance is controlled by the co-moving axial field component $b_{z,j}^2$. For a uniform axial flow and helical laboratory-frame magnetic field components $(B_z, B_\\phi)$, ideal RMHD gives $b_j^2 = (B_z^2 + B_\\phi^2)/\\Gamma_j^2 + v_j^2 B_z^2$ and $b_{z,j}^2 = B_z^2/\\Gamma_j^2$.\n\nAssume the following base state:\n- Jet side ($j=1$): $w_1 = 1$ (cold enthalpy density in units of $c^2$), bulk Lorentz factor $\\Gamma_1 = \\Gamma$, speed $v_1 = \\sqrt{1 - \\Gamma^{-2}}$, magnetization $\\sigma \\equiv b_1^2/w_1$, and pitch $P = B_\\phi/(r_0 B_z)$ with $r_0 = 1$.\n- Ambient side ($j=2$): $w_2 = 1$, $v_2 = 0$, no magnetic field so $b_2^2 = 0$ and $b_{z,2}^2 = 0$.\n\nFor the jet, the above definitions imply\n$$\nb_1^2 = \\sigma w_1 = \\sigma,\\quad b_{z,1}^2 = \\frac{B_z^2}{\\Gamma^2},\\quad \\text{and}\\quad B_z^2 = \\frac{\\sigma}{\\frac{1+P^2}{\\Gamma^2} + v_1^2},\n$$\nwhich reduces to\n$$\nb_{z,1}^2 = \\frac{\\sigma}{P^2 + \\Gamma^2}.\n$$\nTherefore, the effective relativistic inertias are $I_1 = w_1 + b_1^2 = 1 + \\sigma$ and $I_2 = w_2 + b_2^2 = 1$, and the axial magnetic tension contributing to surface-mode balance is fully determined by $b_{z,1}^2$.\n\nUnder the incompressible, planar, surface-wave approximation, the Kelvin–Helmholtz Instability (KHI) dispersion for parallel fields yields a quadratic in $\\omega$ of the form\n$$\n(I_1 + I_2)\\,\\omega^2 - 2k\\,(I_1 v_1 + I_2 v_2)\\,\\omega + k^2 \\Big(I_1 v_1^2 + I_2 v_2^2 - b_{z,1}^2 - b_{z,2}^2\\Big) = 0,\n$$\nwhose instability condition and growth rate follow from the discriminant. In particular, the growth rate $\\omega_i(k) \\equiv \\operatorname{Im}(\\omega)$ can be written in terms of the velocity shear and axial tension as\n$$\n\\omega_i(k) = \\frac{k}{I_1 + I_2}\\,\\sqrt{\\,I_1 I_2\\,(v_1 - v_2)^2 - (I_1 + I_2)\\,(b_{z,1}^2 + b_{z,2}^2)\\,}\\,,\n$$\nand instability requires that the expression under the square root is positive. To heuristically account for a finite shear-layer half-thickness $a$ in an otherwise planar treatment, use the standard replacement of the velocity-shear drive by a factor $\\tanh(ka)$, yielding\n$$\n\\omega_i(k) = \\frac{k}{I_1 + I_2}\\,\\sqrt{\\,I_1 I_2\\,(v_1 - v_2)^2\\,\\tanh^2(ka) - (I_1 + I_2)\\,(b_{z,1}^2 + b_{z,2}^2)\\,}\\,,\n$$\nwith $\\omega_i(k) = 0$ when the argument of the square root is negative. This approximation reproduces the small-$k$ stabilization and large-$k$ saturation of the shear drive while preserving the axial magnetic tension.\n\nTask:\n1) Starting from the ideal RMHD framework and the above base-state definitions, derive the above incompressible surface-mode dispersion relation and its finite-thickness modification in terms of $I_j$, $v_j$, and $b_{z,j}^2$, expressing explicitly how $b_{z,1}^2$ depends on $\\Gamma$, $\\sigma$, and $P$.\n2) Implement a program that, for specified parameter sets $(\\Gamma,\\sigma,P)$ with $w_1 = w_2 = 1$, $v_2 = 0$, $b_{z,2}^2 = 0$, and shear half-thickness $a = 0.1$, sweeps $k$ uniformly over the range $k \\in [0.01, 10.0]$ (in units of $r_0^{-1}$), evaluates $\\omega_i(k)$ using the formula above, and returns the maximum growth rate over this $k$-range. Express the final growth rate in units of inverse light-crossing time $r_0/c$, rounded to six decimal places.\n\nUse the following test suite of $(\\Gamma,\\sigma,P)$ values:\n- Test 1: $(\\Gamma,\\sigma,P) = (5.0, 0.01, 0.0)$\n- Test 2: $(\\Gamma,\\sigma,P) = (2.0, 5.0, 0.0)$\n- Test 3: $(\\Gamma,\\sigma,P) = (2.0, 2.3, 0.0)$\n- Test 4: $(\\Gamma,\\sigma,P) = (2.0, 2.3, 10.0)$\n- Test 5: $(\\Gamma,\\sigma,P) = (5.0, 0.5, 0.0)$\n- Test 6: $(\\Gamma,\\sigma,P) = (5.0, 0.5, 10.0)$\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[x1,x2,x3,x4,x5,x6]\"), where each entry is the maximum $\\omega_i$ for the corresponding test in the order above, rounded to six decimal places. All computations must be carried out in the normalized units specified here, and the output units are inverse light-crossing time $r_0/c$.", "solution": "The problem requires the derivation of the dispersion relation for Kelvin-Helmholtz Instability (KHI) in a specific relativistic magnetohydrodynamic (RMHD) setup and the subsequent calculation of the maximum instability growth rate for several parameter sets. The validation of the problem statement confirms its scientific soundness, internal consistency, and well-posed nature. We may therefore proceed with a solution.\n\nThe solution is divided into two parts as per the problem's tasks:\n1. Derivation of the physical model equations.\n2. Description of the numerical implementation to compute the maximum growth rates.\n\n**1. Derivation and Theoretical Framework**\n\nThe problem investigates the stability of a planar tangential discontinuity, which is a standard local approximation for a thin shear layer at the boundary of a cylindrical jet. We consider incompressible, axisymmetric surface-wave perturbations of the form $e^{i(kz-\\omega t)}$, where $k$ is the axial wavenumber and $\\omega$ is the complex frequency. The imaginary part of $\\omega$, $\\omega_i = \\operatorname{Im}(\\omega)$, represents the growth rate of the instability.\n\nThe dispersion relation for such waves is found by linearizing the ideal RMHD equations and enforcing the continuity of total pressure perturbation across the displaced interface. For the case where the magnetic field is parallel to the flow velocity, the problem states that the resulting dispersion relation is a quadratic equation in $\\omega$:\n$$\n(I_1 + I_2)\\,\\omega^2 - 2k\\,(I_1 v_1 + I_2 v_2)\\,\\omega + k^2 \\Big(I_1 v_1^2 + I_2 v_2^2 - b_{z,1}^2 - b_{z,2}^2\\Big) = 0\n$$\nHere, the subscript $j=1$ refers to the jet and $j=2$ refers to the ambient medium. The terms are defined as follows:\n- $I_j = w_j + b_j^2$ is the effective relativistic inertia density, where $w_j$ is the enthalpy density and $b_j^2$ is the comoving magnetic energy density.\n- $v_j$ is the bulk flow speed along the $z$-axis.\n- $b_{z,j}^2$ is the square of the comoving axial magnetic field, which provides a restoring magnetic tension that can suppress the instability.\n\nThe base state is specified as:\n- Jet ($j=1$): Enthalpy $w_1 = 1$, Lorentz factor $\\Gamma_1 = \\Gamma$, so speed $v_1 = \\sqrt{1 - \\Gamma^{-2}}$. The magnetization is $\\sigma \\equiv b_1^2/w_1 = b_1^2$, and the magnetic pitch is $P = B_\\phi/(r_0 B_z)$ with $r_0=1$. This gives $I_1 = 1 + \\sigma$.\n- Ambient ($j=2$): Enthalpy $w_2 = 1$, static flow $v_2 = 0$, and unmagnetized, so $b_2^2=0$ and $b_{z,2}^2=0$. This gives $I_2 = 1$.\n\nA key part of the task is to derive the expression for the jet's comoving axial magnetic field term, $b_{z,1}^2$. The comoving magnetic field components are related to the laboratory-frame components ($B_z, B_\\phi$) via Lorentz transformations. The problem provides the relevant formulae:\n$b_1^2 = \\frac{B_z^2 + B_\\phi^2}{\\Gamma^2} + v_1^2 B_z^2$\n$b_{z,1}^2 = \\frac{B_z^2}{\\Gamma^2}$\n\nWe are given the magnetization $\\sigma=b_1^2$ and the pitch $P=B_\\phi/B_z$. Substituting $B_\\phi = P B_z$ into the expression for $b_1^2$:\n$$\n\\sigma = b_1^2 = \\frac{B_z^2 + (P B_z)^2}{\\Gamma^2} + v_1^2 B_z^2 = B_z^2 \\left( \\frac{1+P^2}{\\Gamma^2} + v_1^2 \\right)\n$$\nSolving for $B_z^2$ gives:\n$$\nB_z^2 = \\frac{\\sigma}{\\frac{1+P^2}{\\Gamma^2} + v_1^2}\n$$\nThis matches the intermediate expression provided in the problem. Now, substitute this into the formula for $b_{z,1}^2$:\n$$\nb_{z,1}^2 = \\frac{B_z^2}{\\Gamma^2} = \\frac{1}{\\Gamma^2} \\left( \\frac{\\sigma}{\\frac{1+P^2}{\\Gamma^2} + v_1^2} \\right) = \\frac{\\sigma}{(1+P^2) + \\Gamma^2 v_1^2}\n$$\nUsing the relativistic identity $\\Gamma^2_j = (1-v_j^2)^{-1}$, we have $\\Gamma^2 v_1^2 = \\Gamma^2(1 - 1/\\Gamma^2) = \\Gamma^2 - 1$. Substituting this into the denominator:\n$$\nb_{z,1}^2 = \\frac{\\sigma}{(1+P^2) + (\\Gamma^2 - 1)} = \\frac{\\sigma}{P^2 + \\Gamma^2}\n$$\nThis completes the derivation of the expression for $b_{z,1}^2$.\n\nNext, we find the instability growth rate $\\omega_i$. The roots of the quadratic equation $A\\omega^2 + B\\omega + C = 0$ are $\\omega = (-B \\pm \\sqrt{B^2 - 4AC}) / (2A)$. Instability arises when the discriminant $D = B^2 - 4AC$ is negative, leading to complex conjugate roots for $\\omega$. The growth rate is then $\\omega_i = \\operatorname{Im}(\\omega) = \\sqrt{-D}/(2A) = \\sqrt{4AC - B^2}/(2A)$.\nFrom our dispersion relation, we identify the coefficients:\n$A = I_1 + I_2$\n$B = -2k(I_1 v_1 + I_2 v_2)$\n$C = k^2(I_1 v_1^2 + I_2 v_2^2 - b_{z,1}^2 - b_{z,2}^2)$\n\nThe term under the square root for $\\omega_i$ is $4AC - B^2$:\n$$\n4AC - B^2 = 4(I_1+I_2)k^2(I_1 v_1^2 + I_2 v_2^2 - b_{z,1}^2 - b_{z,2}^2) - [-2k(I_1 v_1 + I_2 v_2)]^2\n$$\n$$\n= 4k^2 \\left[ (I_1+I_2)(I_1 v_1^2 + I_2 v_2^2) - (I_1 v_1 + I_2 v_2)^2 - (I_1+I_2)(b_{z,1}^2 + b_{z,2}^2) \\right]\n$$\nExpanding the velocity-dependent part in the square brackets:\n$I_1^2 v_1^2 + I_1 I_2 v_2^2 + I_2 I_1 v_1^2 + I_2^2 v_2^2 - (I_1^2 v_1^2 + 2I_1 I_2 v_1 v_2 + I_2^2 v_2^2)$\n$= I_1 I_2 v_1^2 + I_1 I_2 v_2^2 - 2I_1 I_2 v_1 v_2 = I_1 I_2(v_1 - v_2)^2$\nThus, $4AC - B^2 = 4k^2 \\left[ I_1 I_2(v_1 - v_2)^2 - (I_1 + I_2)(b_{z,1}^2 + b_{z,2}^2) \\right]$.\nThe growth rate is:\n$$\n\\omega_i(k) = \\frac{\\sqrt{4AC - B^2}}{2A} = \\frac{2k \\sqrt{ I_1 I_2(v_1 - v_2)^2 - (I_1 + I_2)(b_{z,1}^2 + b_{z,2}^2) }}{2(I_1 + I_2)}\n$$\n$$\n\\omega_i(k) = \\frac{k}{I_1 + I_2} \\sqrt{I_1 I_2(v_1 - v_2)^2 - (I_1 + I_2)(b_{z,1}^2 + b_{z,2}^2)}\n$$\nThis matches the provided growth rate formula for an ideal, infinitely thin discontinuity.\n\nFinally, the problem introduces a heuristic modification to account for a finite shear-layer half-thickness $a$. This is done by recognizing that the KHI is driven by the velocity shear. For wavelengths comparable to or shorter than the shear layer thickness ($ka \\gtrsim 1$), the effective shear is reduced. This effect is commonly modeled by multiplying the shear-driving term, $(v_1 - v_2)^2$, by a factor that decays for large $k$. The problem specifies a standard choice, $\\tanh^2(ka)$. This factor approaches $1$ for long wavelengths ($ka \\ll 1$) and $0$ for short wavelengths ($ka \\gg 1$), but its effect is to reduce the drive at large $k$. The modified growth rate is:\n$$\n\\omega_i(k) = \\frac{k}{I_1 + I_2}\\,\\sqrt{\\,I_1 I_2\\,(v_1 - v_2)^2\\,\\tanh^2(ka) - (I_1 + I_2)\\,(b_{z,1}^2 + b_{z,2}^2)\\,}\n$$\nBy convention, $\\omega_i(k)=0$ if the expression under the square root is negative, indicating stability at that wavenumber.\n\n**2. Numerical Implementation**\n\nTo complete the task, we must implement a program to find the maximum growth rate, $\\omega_{i, \\text{max}} = \\max_k \\omega_i(k)$, for $k$ in the range $[0.01, 10.0]$ and for several sets of physical parameters $(\\Gamma, \\sigma, P)$.\nThe computational procedure for each test case is as follows:\n1.  Define the constants for the system: $w_1=1$, $w_2=1$, $v_2=0$, $b_{z,2}^2=0$, and $a=0.1$.\n2.  For a given set of jet parameters $(\\Gamma, \\sigma, P)$, calculate the derived physical quantities:\n    - Jet velocity: $v_1 = \\sqrt{1 - \\Gamma^{-2}}$.\n    - Jet inertia: $I_1 = 1 + \\sigma$.\n    - Ambient inertia: $I_2 = 1$.\n    - Jet's comoving axial magnetic field term: $b_{z,1}^2 = \\sigma / (P^2 + \\Gamma^2)$.\n3.  Define the wavenumber range. A fine grid of $k$ values is created, for instance, by sampling $20000$ points uniformly from $k \\in [0.01, 10.0]$.\n4.  For each $k$ in the grid, evaluate the argument of the square root in the $\\omega_i(k)$ formula:\n    $$ \\text{arg} = (1+\\sigma)(1)v_1^2 \\tanh^2(ak) - (1+\\sigma+1)b_{z,1}^2 $$\n5.  If $\\text{arg} < 0$, set the growth rate to $0$. Otherwise, calculate $\\omega_i(k)$ using the derived formula.\n6.  The maximum value of $\\omega_i(k)$ across the grid of $k$ values is identified.\n7.  This maximum value is then rounded to six decimal places.\n8.  The process is repeated for all test cases, and the results are compiled into a comma-separated list.\n\nThis numerical approach robustly handles the possibility of an interior maximum for the growth rate, as well as cases that are stable over the entire or parts of the specified $k$-range.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the maximum Kelvin-Helmholtz instability growth rate\n    for a relativistic magnetized jet for a given set of parameters.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    # Each tuple is (Gamma, sigma, P)\n    test_cases = [\n        (5.0, 0.01, 0.0),\n        (2.0, 5.0, 0.0),\n        (2.0, 2.3, 0.0),\n        (2.0, 2.3, 10.0),\n        (5.0, 0.5, 0.0),\n        (5.0, 0.5, 10.0),\n    ]\n\n    results = []\n    \n    # Static parameters\n    a = 0.1  # Shear-layer half-thickness\n    v2 = 0.0  # Ambient medium speed\n    I2 = 1.0  # Ambient medium inertia (w2=1, b2=0)\n    bz2_sq = 0.0 # Ambient medium magnetic tension term\n\n    # Wavenumber range for sweeping to find the maximum growth rate\n    k_values = np.linspace(0.01, 10.0, num=20000)\n\n    for case in test_cases:\n        Gamma, sigma, P = case\n        \n        # Calculate derived physical quantities for the jet\n        if Gamma == 1.0:\n            v1 = 0.0\n        else:\n            v1 = np.sqrt(1.0 - 1.0 / (Gamma**2))\n\n        I1 = 1.0 + sigma\n        bz1_sq = sigma / (P**2 + Gamma**2)\n        \n        # Define constants for the growth rate equation for clarity\n        #omega_i(k) = (k / (I1 + I2)) * sqrt(term_A * tanh^2(ka) - term_B)\n        term_A = I1 * I2 * (v1 - v2)**2\n        term_B = (I1 + I2) * (bz1_sq + bz2_sq)\n        \n        # Calculate the argument of the square root for all k values\n        tanh_ka_sq = np.tanh(k_values * a)**2\n        sqrt_arg = term_A * tanh_ka_sq - term_B\n        \n        # Instability exists only where the argument is positive.\n        # Set argument to 0 where it's negative.\n        sqrt_arg[sqrt_arg < 0] = 0.0\n        \n        # Calculate the growth rate omega_i for all k\n        omega_i_k = (k_values / (I1 + I2)) * np.sqrt(sqrt_arg)\n        \n        # Find the maximum growth rate over the k range\n        max_omega_i = np.max(omega_i_k)\n        \n        results.append(f\"{max_omega_i:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "3517935"}]}