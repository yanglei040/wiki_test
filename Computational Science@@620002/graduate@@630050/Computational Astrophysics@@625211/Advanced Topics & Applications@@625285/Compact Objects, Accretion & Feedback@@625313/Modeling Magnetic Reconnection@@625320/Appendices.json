{"hands_on_practices": [{"introduction": "A primary objective in studying magnetic reconnection is to quantify its rate, which determines how quickly magnetic energy is converted. This rate is governed by the reconnection electric field, $E_{\\mathrm{rec}}$. This first hands-on practice provides a concrete method for measuring this key parameter by numerically integrating the electric field along a path crossing the current sheet and comparing it to a common proxy derived from the ideal inflow conditions [@problem_id:3519733]. This exercise is fundamental for validating numerical simulations and building an intuition for how non-ideal physics inside the diffusion region connects to the global dynamics.", "problem": "You must write a complete and runnable program that implements and verifies a consistency check for the rate of magnetic flux transfer across a prescribed cut in a two-dimensional, plane-invariant, magnetohydrodynamic reconnection context. The objective is to compute the magnetic flux transfer rate across a vertical cut using the electric field, and to compare this with an independent estimate constructed from the inflow speed times the upstream magnetic field, which under ideal magnetohydrodynamics (MHD) provides a second measure of the reconnection electric field. The result must be returned for a small test suite of parameter choices as real-valued discrepancies.\n\nBegin from the following fundamental base:\n- Faraday’s law: $\\partial \\mathbf{B} / \\partial t = - \\nabla \\times \\mathbf{E}$, where $\\mathbf{B}$ is the magnetic field and $\\mathbf{E}$ is the electric field.\n- Ideal Ohm’s law (ideal MHD limit outside any non-ideal region): $\\mathbf{E} = - \\mathbf{v} \\times \\mathbf{B}$, where $\\mathbf{v}$ is the plasma velocity.\n- In two-dimensional reconnection invariant along the $z$-axis, one may use a magnetic vector potential $\\mathbf{A} = A_z(x,y,t) \\hat{\\mathbf{z}}$ with $\\mathbf{B} = \\nabla \\times \\mathbf{A} = (\\partial_y A_z, -\\partial_x A_z, 0)$ and $E_z = - \\partial_t A_z$ (in a gauge where the scalar potential has no $z$-dependence). Along a symmetry midline where $B_y = 0$ and $v_x = 0$, ideal Ohm’s law reduces to $E_z = v_y B_x$ in the ideal region.\n\nDefinitions for this problem:\n- Consider a vertical cut $\\mathcal{C}$ at $x = 0$ from $y = -Y_c$ to $y = +Y_c$, with length $2 Y_c$.\n- Define the flux-transfer rate across the cut per unit length along $z$ as\n$$\n\\dot{\\Phi}_{\\mathrm{cut}}(t) \\equiv \\int_{-Y_c}^{Y_c} E_z(x=0,y,t) \\, dy,\n$$\nwhich follows from integrating Faraday’s law around a rectangular contour that uses $\\mathcal{C}$ as its interior segment and lies in regions where the tangential electric field is negligible except along $\\mathcal{C}$. In the ideal region sufficiently upstream, $E_z$ equals the inflow measure $v_{\\mathrm{in}} B$, where $v_{\\mathrm{in}}$ is the inflow speed toward the current sheet and $B$ is the reconnecting upstream magnetic field component.\n- In the test configuration, take a static initial magnetic configuration derived from a vector potential $A_0(y)$, such that at time $t=0$ the reconnecting magnetic field component is $B_x(y,0) = \\partial_y A_0(y) = B_0 \\tanh(y/\\delta)$, where $B_0 > 0$ and $\\delta > 0$ are constants.\n- Prescribe an electric field profile $E_z(y)$ at $t=0$ of the form\n$$\nE_z(y) = E_0 + E_1 \\exp\\!\\left(-\\left(\\frac{y}{w}\\right)^2\\right),\n$$\nwith constants $E_0$ (background, ideal contribution), $E_1$ (non-ideal localized correction), and $w>0$ (localization width). This choice is consistent with $E_z = - \\partial_t A_z$ if one takes $A_z(x,y,t) = A_0(y) - E_z(y) t$, in which case $B_x(y,t) = B_0 \\tanh(y/\\delta) - t \\, \\partial_y E_z(y)$; you are to evaluate all quantities at $t=0$ so that $B_x(y,0) = B_0 \\tanh(y/\\delta)$.\n- Define an “upstream” sampling location $y_{\\mathrm{up}}$ with $|y_{\\mathrm{up}}| \\le Y_c$ but sufficiently away from $y=0$ so that $B_x(y_{\\mathrm{up}},0) \\neq 0$. In the ideal region upstream, the inflow relation gives\n$$\nE_{\\mathrm{up}} \\equiv \\left[v_{\\mathrm{in}}(y_{\\mathrm{up}}) \\, B_x(y_{\\mathrm{up}},0)\\right] = E_z(y_{\\mathrm{up}}),\n$$\nso a predicted flux-transfer rate assuming uniformity along the cut is\n$$\n\\dot{\\Phi}_{\\mathrm{pred}} = 2 Y_c \\, E_{\\mathrm{up}}.\n$$\n\nYour tasks:\n- For each parameter set in the test suite below, evaluate numerically the integral defining $\\dot{\\Phi}_{\\mathrm{cut}}$ and the product $\\dot{\\Phi}_{\\mathrm{pred}} = 2 Y_c E_z(y_{\\mathrm{up}})$.\n- Compute the absolute relative discrepancy\n$$\nr = \\frac{\\left|\\dot{\\Phi}_{\\mathrm{cut}} - \\dot{\\Phi}_{\\mathrm{pred}}\\right|}{\\max\\!\\left(10^{-12}, \\left|\\dot{\\Phi}_{\\mathrm{cut}}\\right|\\right)},\n$$\nwhich is dimensionless. A small value of $r$ indicates consistency between the direct cut-based flux-transfer rate and the inflow estimate.\n\nPhysical units to use:\n- Magnetic field $B$ in tesla (T),\n- Lengths $y, Y_c, \\delta, w, y_{\\mathrm{up}}$ in meters (m),\n- Electric field $E$ in volts per meter (V/m),\n- The rate $\\dot{\\Phi}$ has units of volt (V), since it is an integral of $E_z$ over a length along $y$ per unit length along $z$.\n\nNumerical test suite:\n- Use the following four parameter sets, each specified as $(B_0, \\delta, E_0, E_1, w, Y_c, y_{\\mathrm{up}})$, with all quantities in the units specified above:\n    1. $(2.0 \\times 10^{-8}, \\; 5.0 \\times 10^{4}, \\; 1.0 \\times 10^{-3}, \\; 0.0, \\; 2.5 \\times 10^{4}, \\; 5.0 \\times 10^{5}, \\; 1.5 \\times 10^{5})$\n    2. $(2.0 \\times 10^{-8}, \\; 5.0 \\times 10^{4}, \\; 1.0 \\times 10^{-3}, \\; 5.0 \\times 10^{-4}, \\; 2.5 \\times 10^{4}, \\; 5.0 \\times 10^{5}, \\; 1.5 \\times 10^{5})$\n    3. $(2.0 \\times 10^{-8}, \\; 5.0 \\times 10^{4}, \\; 1.0 \\times 10^{-3}, \\; -5.0 \\times 10^{-4}, \\; 1.0 \\times 10^{5}, \\; 5.0 \\times 10^{5}, \\; 1.5 \\times 10^{5})$\n    4. $(2.0 \\times 10^{-8}, \\; 5.0 \\times 10^{4}, \\; 1.0 \\times 10^{-3}, \\; 2.0 \\times 10^{-4}, \\; 1.0 \\times 10^{4}, \\; 5.0 \\times 10^{5}, \\; 5.0 \\times 10^{2})$\n\nProgram requirements:\n- Implement a function that, for each test case, defines $E_z(y)$ and $B_x(y,0)$ as specified and evaluates $\\dot{\\Phi}_{\\mathrm{cut}}$ by numerical quadrature over $y \\in [-Y_c, Y_c]$.\n- Compute $\\dot{\\Phi}_{\\mathrm{pred}} = 2 Y_c E_z(y_{\\mathrm{up}})$ and then compute the discrepancy $r$ as defined above.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[r1,r2,r3,r4]\"), where each entry is the $r$ value for the corresponding test case in the order listed above. The entries must be floating-point numbers without units.\n\nScientific realism and constraints:\n- The magnetic profile $B_x(y,0) = B_0 \\tanh(y/\\delta)$ is a canonical model of a current sheet used in reconnection studies.\n- The electric field profile $E_z(y)$ incorporates a uniform ideal contribution $E_0$ and a localized non-ideal correction $E_1 \\exp[-(y/w)^2]$ to allow testing both the ideal consistency case and departures due to non-ideal effects.\n- The inflow estimate $v_{\\mathrm{in}} B$ is evaluated as $E_z(y_{\\mathrm{up}})$ under the ideal assumption at the upstream sampling point. In the presence of a localized non-ideal term, this estimate may not match the cut-integrated $\\dot{\\Phi}_{\\mathrm{cut}}$, and the discrepancy $r$ quantifies that inconsistency.\n\nAngle units do not arise in this problem. All numerical results to be printed are pure numbers (dimensionless discrepancies).", "solution": "We derive an implementable expression for the magnetic flux transfer rate across a vertical cut and its ideal inflow-based proxy, and then provide a numerical plan to evaluate and compare them.\n\nFundamental basis and geometry:\n- Start with Faraday’s law, $\\partial \\mathbf{B} / \\partial t = - \\nabla \\times \\mathbf{E}$, and the ideal Ohm’s law, $\\mathbf{E} = - \\mathbf{v} \\times \\mathbf{B}$, valid in the ideal region.\n- In a two-dimensional system invariant along $z$, let $\\mathbf{A} = A_z(x,y,t) \\hat{\\mathbf{z}}$, $\\mathbf{B} = \\nabla \\times \\mathbf{A} = (\\partial_y A_z, -\\partial_x A_z, 0)$, and $E_z = -\\partial_t A_z$.\n- Consider a vertical cut $\\mathcal{C}$ at $x=0$ from $y=-Y_c$ to $y=+Y_c$. The magnetic flux transfer rate across this cut per unit $z$-length can be obtained by considering a rectangular loop that uses $\\mathcal{C}$ as one side and closes in regions where the tangential electric field is negligible. By Faraday’s law in integral form, $d\\Phi/dt = - \\oint \\mathbf{E} \\cdot d\\mathbf{l}$. If the contributions along the closing segments vanish (or can be made negligible in the ideal region), the remaining contribution is the line integral along $\\mathcal{C}$:\n$$\n\\dot{\\Phi}_{\\mathrm{cut}}(t) = \\int_{-Y_c}^{Y_c} E_z(x=0,y,t) \\, dy.\n$$\nThis is a standard diagnostic for two-dimensional reconnection rate when the cut crosses the non-ideal region.\n\nIdeal inflow proxy:\n- On a symmetry midline, one usually has $B_y = 0$ and $v_x = 0$. The $z$-component of the ideal Ohm’s law reduces to $E_z = v_y B_x$ in the ideal region. Sampling at an upstream location $y_{\\mathrm{up}}$ where the non-ideal effects are negligible yields\n$$\nE_{\\mathrm{up}} \\equiv v_{\\mathrm{in}}(y_{\\mathrm{up}}) \\, B_x(y_{\\mathrm{up}},0) = E_z(y_{\\mathrm{up}}).\n$$\nAssuming that $E_z$ is approximately uniform across the non-ideal layer along the cut (a common property in steady two-dimensional reconnection), a predicted flux-transfer rate is\n$$\n\\dot{\\Phi}_{\\mathrm{pred}} = 2 Y_c \\, E_{\\mathrm{up}}.\n$$\nIn the strictly uniform $E_z$ case, $\\dot{\\Phi}_{\\mathrm{cut}} = \\dot{\\Phi}_{\\mathrm{pred}}$ exactly; in the presence of a localized non-ideal enhancement or reduction, they may differ.\n\nModel fields for the test suite:\n- We prescribe a reconnecting magnetic field at $t=0$ given by\n$$\nB_x(y,0) = \\partial_y A_0(y) = B_0 \\tanh\\!\\left(\\frac{y}{\\delta}\\right),\n$$\nwith constants $B_0 > 0$ and $\\delta > 0$. This is a current-sheet profile widely used in reconnection modeling.\n- We prescribe an electric field profile at $t=0$,\n$$\nE_z(y) = E_0 + E_1 \\exp\\!\\left(-\\left(\\frac{y}{w}\\right)^2\\right),\n$$\nwith constants $E_0$, $E_1$, $w > 0$. Consistency with Faraday’s law is ensured by $E_z = -\\partial_t A_z$ if one takes $A_z(x,y,t) = A_0(y) - E_z(y) t$, so that $B_x(y,t) = B_0 \\tanh(y/\\delta) - t \\, \\partial_y E_z(y)$. We only evaluate at $t=0$, hence $B_x(y,0) = B_0 \\tanh(y/\\delta)$ is the relevant magnetic field.\n\nComputational definitions:\n- The direct cut-based rate at $t=0$ is\n$$\n\\dot{\\Phi}_{\\mathrm{cut}} = \\int_{-Y_c}^{Y_c} \\left[E_0 + E_1 \\exp\\!\\left(-\\left(\\frac{y}{w}\\right)^2\\right)\\right] dy.\n$$\n- The inflow proxy uses the upstream sampled value,\n$$\nE_{\\mathrm{up}} = E_z(y_{\\mathrm{up}}) = E_0 + E_1 \\exp\\!\\left(-\\left(\\frac{y_{\\mathrm{up}}}{w}\\right)^2\\right),\n$$\nand predicts\n$$\n\\dot{\\Phi}_{\\mathrm{pred}} = 2 Y_c \\, E_{\\mathrm{up}}.\n$$\n- The discrepancy to report is the absolute relative error\n$$\nr = \\frac{\\left|\\dot{\\Phi}_{\\mathrm{cut}} - \\dot{\\Phi}_{\\mathrm{pred}}\\right|}{\\max\\!\\left(10^{-12}, \\left|\\dot{\\Phi}_{\\mathrm{cut}}\\right|\\right)}.\n$$\n\nAlgorithmic plan:\n- For each test case, define $E_z(y)$ as above and evaluate the integral for $\\dot{\\Phi}_{\\mathrm{cut}}$ numerically using a robust quadrature over $y \\in [-Y_c, Y_c]$.\n- Evaluate $E_{\\mathrm{up}} = E_z(y_{\\mathrm{up}})$ and compute $\\dot{\\Phi}_{\\mathrm{pred}} = 2 Y_c E_{\\mathrm{up}}$.\n- Compute $r$ as defined.\n- Aggregate the results $[r_1, r_2, r_3, r_4]$ in the order of the provided test suite.\n\nInterpretation:\n- Case $1$ has $E_1 = 0$, so $E_z(y)$ is uniform and the two measures coincide up to numerical integration error; $r$ should be close to $0$.\n- Cases $2$ and $3$ include localized non-ideal corrections ($E_1 \\neq 0$) that vary along $y$, so $\\dot{\\Phi}_{\\mathrm{cut}}$ accumulates these variations whereas $\\dot{\\Phi}_{\\mathrm{pred}}$ only reflects the upstream value; nonzero $r$ quantifies the inconsistency.\n- Case $4$ uses a very small $y_{\\mathrm{up}}$ close to the neutral line; although $E_{\\mathrm{up}}$ remains finite, this probes sensitivity when sampling too close to the current sheet, providing an edge-case check.\n\nAll computations are to be performed in the specified units, but the printed outputs $r_i$ are dimensionless real numbers as required.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import integrate\n\ndef ez_profile(y, E0, E1, w):\n    # Electric field profile E_z(y) = E0 + E1 * exp(-(y/w)^2)\n    if w = 0:\n        return E0\n    return E0 + E1 * np.exp(- (y / w)**2)\n\ndef bx_profile(y, B0, delta):\n    # Reconnecting magnetic field at t=0: B_x(y,0) = B0 * tanh(y/delta)\n    return B0 * np.tanh(y / delta)\n\ndef compute_dotPhi_cut(E0, E1, w, Yc):\n    # Numerically integrate E_z over y in [-Yc, Yc]\n    integrand = lambda yy: ez_profile(yy, E0, E1, w)\n    # Use high-accuracy quadrature\n    val, err = integrate.quad(integrand, -Yc, Yc, epsabs=1e-12, epsrel=1e-12, limit=200)\n    return val\n\ndef compute_discrepancy(case):\n    # Unpack parameters: (B0, delta, E0, E1, w, Yc, y_up)\n    B0, delta, E0, E1, w, Yc, y_up = case\n\n    # Direct cut-based flux-transfer rate\n    dotPhi_cut = compute_dotPhi_cut(E0, E1, w, Yc)\n\n    # Upstream E_z at y_up (ideal proxy v_in * B_up)\n    E_up = ez_profile(y_up, E0, E1, w)\n\n    # Predicted rate assuming uniform E_z across the cut\n    dotPhi_pred = 2.0 * Yc * E_up\n\n    # Discrepancy (absolute relative error)\n    denom = max(1e-12, abs(dotPhi_cut))\n    r = abs(dotPhi_cut - dotPhi_pred) / denom\n    return r\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each tuple is (B0, delta, E0, E1, w, Yc, y_up)\n    test_cases = [\n        (2.0e-8, 5.0e4, 1.0e-3, 0.0,       2.5e4, 5.0e5, 1.5e5),\n        (2.0e-8, 5.0e4, 1.0e-3, 5.0e-4,    2.5e4, 5.0e5, 1.5e5),\n        (2.0e-8, 5.0e4, 1.0e-3, -5.0e-4,   1.0e5, 5.0e5, 1.5e5),\n        (2.0e-8, 5.0e4, 1.0e-3, 2.0e-4,    1.0e4, 5.0e5, 5.0e2),\n    ]\n\n    results = []\n    for case in test_cases:\n        r = compute_discrepancy(case)\n        # Format with reasonable precision to ensure a clean single-line output\n        results.append(f\"{r:.12g}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "3519733"}, {"introduction": "After learning how to measure the reconnection rate, a natural next question is: what physics determines its value? This practice shifts from numerical diagnostics to fundamental theory, challenging you to derive the scaling laws for the reconnection rate in two distinct physical regimes. You will first analyze the classic Sweet-Parker model for slow, resistive reconnection, and then contrast it with the model for fast, collisionless reconnection mediated by the Hall effect [@problem_id:3519768]. This analytical exercise is essential for understanding the critical difference between collisional and collisionless plasmas and explains why reconnection can be an explosive process in many astrophysical environments.", "problem": "A two-dimensional, steady magnetic reconnection layer in a uniform, singly ionized, collisionless plasma is modeled at the macroscopic level by Magnetohydrodynamics (MHD) and, at sub-ion scales, by Hall Magnetohydrodynamics (Hall MHD). The upstream magnetic field is $B_0$, mass density is $\\rho_0$, and the system-scale length of the current sheet is $L$ (along the outflow). Assume incompressible flow and anti-parallel fields with no guide field. The Alfvén speed is $V_A = B_0/\\sqrt{\\mu_0 \\rho_0}$ and the Lundquist number is $S = \\mu_0 L V_A/\\eta$, where $\\eta$ is the resistivity. The ion inertial length is $d_i = \\sqrt{m_i/(\\mu_0 n e^2)}$, where $n$ is the number density, $e$ is the elementary charge, and $m_i$ is the ion mass. The reconnection rate is defined as the normalized inflow, $R \\equiv V_{\\mathrm{in}}/V_A$, and the layer thickness is $\\delta$.\n\nUsing as the fundamental base the integral forms of Faraday’s law and Ampère’s law (neglecting displacement current), mass continuity for incompressible flow, and the generalized Ohm’s law,\n$E + v_i \\times B = \\dfrac{J \\times B}{n e} - \\dfrac{\\nabla \\cdot P_e}{n e} - \\dfrac{m_e}{n e^2} \\dfrac{dJ}{dt} + \\eta J$,\nperform the following modeling steps:\n\n1) In resistive MHD (neglecting Hall, electron pressure tensor, and electron inertia), derive the Sweet–Parker scalings for the reconnection rate $R_{\\mathrm{SP}}$ and current layer thickness $\\delta_{\\mathrm{SP}}$ in terms of $S$ and $L$.\n\n2) In the collisionless Hall regime with $d_i \\ll L$ and $\\eta \\to 0$, adopt the following physically motivated modeling assumptions based on Hall MHD: (i) the ion-coupled diffusion region has thickness $\\delta_i \\sim d_i$ and outflow speed of order $V_A$, (ii) dispersive whistler dynamics localize the diffusion region along the outflow to a length $\\ell \\sim \\kappa d_i$, where $\\kappa$ is an order-unity constant, and (iii) the steady reconnection electric field $E_z$ is uniform across the layer by Faraday’s law. Using mass continuity across the ion layer and these assumptions, derive the Hall-regime scalings for the reconnection rate $R_{\\mathrm{H}}$ and the layer thickness $\\delta_{\\mathrm{H}}$ in terms of $L$, $d_i$, and $\\kappa$.\n\n3) For the astrophysically relevant parameter choice $S = 10^{8}$, $L/d_i = 5000$, and $\\kappa = 10$, compute the dimensionless ratio $R_{\\mathrm{H}}/R_{\\mathrm{SP}}$.\n\nProvide the final answer as the single pure number $R_{\\mathrm{H}}/R_{\\mathrm{SP}}$. No units are required. No rounding is required beyond exact arithmetic.", "solution": "The problem requires the derivation and comparison of magnetic reconnection rates in two different physical regimes: resistive Magnetohydrodynamics (MHD) and Hall MHD. The solution will proceed in three parts as requested.\n\nPart 1: Derivation of Sweet–Parker Scalings\n\nIn the Sweet–Parker model for resistive MHD, reconnection occurs in a thin current sheet of length $L$ and thickness $\\delta_{\\mathrm{SP}}$. We apply conservation laws and Ohm's law to this region.\n\n1.  Mass Conservation: For a steady, incompressible flow ($\\rho = \\rho_0 = \\mathrm{const}$), the mass flux entering the reconnection region must equal the mass flux exiting it. Plasma flows in from above and below along the length $L$ with velocity $V_{\\mathrm{in}}$, and it is ejected from the sides along the thickness $\\delta_{\\mathrm{SP}}$ with velocity $V_{\\mathrm{out}}$. In a two-dimensional approximation, this balance is expressed as:\n    $$ \\rho_0 V_{\\mathrm{in}} (2L) = \\rho_0 V_{\\mathrm{out}} (2\\delta_{\\mathrm{SP}}) $$\n    This simplifies to a geometric constraint on the aspect ratio of the sheet:\n    $$ V_{\\mathrm{in}} L = V_{\\mathrm{out}} \\delta_{\\mathrm{SP}} $$\n\n2.  Energy Conservation: The magnetic energy of the inflowing plasma is converted into the kinetic energy of the outflowing plasma jet. Equating the upstream magnetic energy density with the downstream kinetic energy density gives:\n    $$ \\frac{1}{2}\\rho_0 V_{\\mathrm{out}}^2 \\approx \\frac{B_0^2}{2\\mu_0} $$\n    Solving for the outflow velocity $V_{\\mathrm{out}}$ yields that it is on the order of the upstream Alfvén speed, $V_A = B_0 / \\sqrt{\\mu_0 \\rho_0}$:\n    $$ V_{\\mathrm{out}} \\approx V_A $$\n\n3.  Ohm's Law and Electromotive Force: In a steady state ($\\partial/\\partial t = 0$), Faraday's law, $\\nabla \\times E = 0$, implies that the reconnection electric field, $E_z$, is uniform. In the ideal inflow region, the electric field is given by $E \\approx -v \\times B$. With $v=(0, -V_{\\mathrm{in}}, 0)$ and $B=(B_0, 0, 0)$, we find $E_z \\approx V_{\\mathrm{in}} B_0$. Inside the resistive layer, plasma velocity is small, and the resistive term of the generalized Ohm's law, $E + v \\times B = \\eta J$, dominates. Thus, $E_z \\approx \\eta J_z$. Equating the two expressions for $E_z$ gives:\n    $$ V_{\\mathrm{in}} B_0 \\approx \\eta J_z $$\n\n4.  Ampère's Law: The current density $J_z$ is related to the shear in the magnetic field across the layer. From Ampère's law, $\\nabla \\times B = \\mu_0 J$, we can estimate the current density as:\n    $$ J_z \\approx \\frac{1}{\\mu_0} \\frac{\\Delta B_x}{\\Delta y} \\approx \\frac{1}{\\mu_0} \\frac{2B_0}{\\delta_{\\mathrm{SP}}} $$\n    For scaling purposes, we use $J_z \\sim B_0 / (\\mu_0 \\delta_{\\mathrm{SP}})$.\n\n5.  Solving for Scalings: Substituting the expression for $J_z$ into the relation from Ohm's law:\n    $$ V_{\\mathrm{in}} B_0 \\sim \\eta \\frac{B_0}{\\mu_0 \\delta_{\\mathrm{SP}}} \\implies V_{\\mathrm{in}} \\mu_0 \\delta_{\\mathrm{SP}} \\sim \\eta $$\n    We now have a system of two scaling relations for the two unknowns, $V_{\\mathrm{in}}$ and $\\delta_{\\mathrm{SP}}$:\n    From mass and energy conservation: $\\delta_{\\mathrm{SP}} \\sim L \\frac{V_{\\mathrm{in}}}{V_A}$.\n    From Ohm's and Ampere's laws: $V_{\\mathrm{in}} \\sim \\frac{\\eta}{\\mu_0 \\delta_{\\mathrm{SP}}}$.\n    Substituting $\\delta_{\\mathrm{SP}}$ from the first relation into the second:\n    $$ V_{\\mathrm{in}} \\sim \\frac{\\eta}{\\mu_0 (L V_{\\mathrm{in}} / V_A)} = \\frac{\\eta V_A}{\\mu_0 L V_{\\mathrm{in}}} $$\n    $$ V_{\\mathrm{in}}^2 \\sim \\frac{\\eta V_A}{\\mu_0 L} $$\n    The normalized reconnection rate is $R_{\\mathrm{SP}} = V_{\\mathrm{in}}/V_A$. Dividing by $V_A^2$:\n    $$ R_{\\mathrm{SP}}^2 = \\left(\\frac{V_{\\mathrm{in}}}{V_A}\\right)^2 \\sim \\frac{\\eta}{\\mu_0 L V_A} $$\n    Recognizing the inverse of the Lundquist number $S = \\mu_0 L V_A / \\eta$:\n    $$ R_{\\mathrm{SP}} \\sim S^{-1/2} $$\n    The layer thickness $\\delta_{\\mathrm{SP}}$ is then found by:\n    $$ \\delta_{\\mathrm{SP}} \\sim L \\frac{V_{\\mathrm{in}}}{V_A} = L R_{\\mathrm{SP}} \\sim L S^{-1/2} $$\n\nPart 2: Hall Reconnection Scalings\n\nIn the collisionless Hall MHD regime, we use the specific modeling assumptions provided. The physics of the Hall effect and whistler waves, which break the frozen-in condition at the ion inertial scale $d_i$, are encapsulated in these assumptions.\n\n1.  Diffusion Region Geometry: The problem states that the diffusion region has a thickness $\\delta_{\\mathrm{H}}$ on the order of the ion inertial length, and the outflow is localized to a length $\\ell$.\n    - Assumption (i): $\\delta_{\\mathrm{H}} \\sim d_i$. This provides the scaling for the layer thickness directly.\n    - Assumption (iii): $\\ell \\sim \\kappa d_i$, where $\\kappa$ is an order-unity constant.\n\n2.  Outflow Velocity: Assumption (ii) states that the outflow speed remains on the order of the Alfvén speed, $V_{\\mathrm{out}} \\sim V_A$.\n\n3.  Mass Conservation: We apply the incompressible mass continuity equation to this small, localized diffusion region of size $\\ell \\times \\delta_{\\mathrm{H}}$:\n    $$ V_{\\mathrm{in}} \\ell \\sim V_{\\mathrm{out}} \\delta_{\\mathrm{H}} $$\n\n4.  Solving for Scalings: Substitute the assumptions into the mass conservation relation:\n    $$ V_{\\mathrm{in}} (\\kappa d_i) \\sim V_A d_i $$\n    Solving for the inflow velocity $V_{\\mathrm{in}}$:\n    $$ V_{\\mathrm{in}} \\sim \\frac{V_A d_i}{\\kappa d_i} = \\frac{V_A}{\\kappa} $$\n    The Hall reconnection rate $R_{\\mathrm{H}} = V_{\\mathrm{in}}/V_A$ is therefore:\n    $$ R_{\\mathrm{H}} \\sim \\frac{1}{\\kappa} $$\n    The layer thickness scaling is given directly by assumption (i):\n    $$ \\delta_{\\mathrm{H}} \\sim d_i $$\n    These results show that the Hall reconnection rate is a constant (for a given $\\kappa$) and is independent of the global system size $L$ and resistivity, leading to \"fast\" reconnection. The unused parameter $L/d_i$ is provided to establish that the system is in the astrophysically relevant regime where global scales are much larger than kinetic scales ($L \\gg d_i$).\n\nPart 3: Calculation of the Ratio $R_{\\mathrm{H}}/R_{\\mathrm{SP}}$\n\nWe are given the parameters $S = 10^{8}$ and $\\kappa = 10$. Using the derived scalings as equalities for this estimate:\n\n1.  Calculate the Sweet-Parker reconnection rate $R_{\\mathrm{SP}}$:\n    $$ R_{\\mathrm{SP}} = S^{-1/2} = (10^8)^{-1/2} = 10^{-4} $$\n\n2.  Calculate the Hall reconnection rate $R_{\\mathrm{H}}$:\n    $$ R_{\\mathrm{H}} = \\frac{1}{\\kappa} = \\frac{1}{10} = 0.1 $$\n\n3.  Compute the ratio $R_{\\mathrm{H}}/R_{\\mathrm{SP}}$:\n    $$ \\frac{R_{\\mathrm{H}}}{R_{\\mathrm{SP}}} = \\frac{0.1}{10^{-4}} = \\frac{10^{-1}}{10^{-4}} = 10^{(-1) - (-4)} = 10^3 $$\n    The ratio is $1000$.", "answer": "$$\\boxed{1000}$$", "id": "3519768"}, {"introduction": "While two-dimensional models with simple X-points are invaluable, real astrophysical magnetic fields are three-dimensional and far more complex. In 3D, reconnection no longer occurs at a single point but within intricate structures called quasi-separatrix layers (QSLs). This final practice introduces a powerful computational tool to locate these regions: the magnetic squashing factor, $Q$ [@problem_id:3519769]. By tracing how neighboring magnetic field lines diverge, the $Q$ factor provides a map of the magnetic topology, highlighting the geometric structures where intense currents can build up and release energy, thus guiding researchers to the active sites of reconnection in complex systems.", "problem": "Consider a magnetohydrodynamics (MHD) magnetic field $\\mathbf{B}(\\mathbf{r})$ in a simply connected Cartesian box with coordinates $(x,y,z)$, where $z$ is the preferred direction of open field-line mapping. Assume $\\nabla \\cdot \\mathbf{B} = 0$ and $B_z(x,y,z)  0$ everywhere in the domain so that field lines monotonically connect the lower boundary $z=0$ to the upper boundary $z=L$. Define the field-line mapping $\\mathcal{F}: (x_0,y_0) \\mapsto (X(x_0,y_0),Y(x_0,y_0))$ by tracing the magnetic field line starting at $(x_0,y_0,0)$ until it intersects the plane $z=L$ at $(X,Y,L)$. The squashing factor $Q$ at a footpoint $(x_0,y_0,0)$ is defined by the $2\\times 2$ Jacobian $D\\mathcal{F}$ of the mapping,\n$$\nD\\mathcal{F}(x_0,y_0) \\equiv \n\\begin{pmatrix}\n\\frac{\\partial X}{\\partial x_0}  \\frac{\\partial X}{\\partial y_0} \\\\\n\\frac{\\partial Y}{\\partial x_0}  \\frac{\\partial Y}{\\partial y_0}\n\\end{pmatrix},\n$$\nand\n$$\nQ(x_0,y_0) \\equiv \\frac{\\left\\| D\\mathcal{F}(x_0,y_0) \\right\\|_F^2}{\\left| \\det D\\mathcal{F}(x_0,y_0) \\right|} = \\frac{\\left(\\frac{\\partial X}{\\partial x_0}\\right)^2 + \\left(\\frac{\\partial X}{\\partial y_0}\\right)^2 + \\left(\\frac{\\partial Y}{\\partial x_0}\\right)^2 + \\left(\\frac{\\partial Y}{\\partial y_0}\\right)^2}{\\left| \\frac{\\partial X}{\\partial x_0}\\frac{\\partial Y}{\\partial y_0} - \\frac{\\partial X}{\\partial y_0}\\frac{\\partial Y}{\\partial x_0} \\right|}.\n$$\nHigh values of $Q$ indicate quasi-separatrix layers (QSLs), which are likely sites of magnetic reconnection.\n\nYour task is to write a complete, runnable program that:\n- Numerically integrates field lines to compute $\\mathcal{F}$ for a grid of footpoints $(x_0,y_0)$ on $z=0$.\n- Approximates $D\\mathcal{F}$ using finite differences around each footpoint.\n- Computes $Q$ at each footpoint.\n- Identifies likely reconnection sites as footpoints where $Q \\ge Q_{\\mathrm{thr}}$.\n\nUse the field-line equations with $z$ as the independent variable:\n$$\n\\frac{dx}{dz} = \\frac{B_x(x,y,z)}{B_z(x,y,z)}, \\qquad \\frac{dy}{dz} = \\frac{B_y(x,y,z)}{B_z(x,y,z)},\n$$\nintegrated from $z=0$ to $z=L$ with $(x(0),y(0))=(x_0,y_0)$, to determine $(X,Y)=(x(L),y(L))$. Use an explicit fourth-order Runge–Kutta method with a uniform number of steps $M$ for all test cases.\n\nFor numerical differentiation, use a symmetric two-point stencil with increment $\\varepsilon$:\n$$\n\\frac{\\partial X}{\\partial x_0} \\approx \\frac{X(x_0+\\varepsilon,y_0)-X(x_0-\\varepsilon,y_0)}{2\\varepsilon}, \\quad\n\\frac{\\partial X}{\\partial y_0} \\approx \\frac{X(x_0,y_0+\\varepsilon)-X(x_0,y_0-\\varepsilon)}{2\\varepsilon},\n$$\nand analogously for $\\partial Y/\\partial x_0$ and $\\partial Y/\\partial y_0$.\n\nField configurations. For all test cases below, adopt the divergence-free in-plane field derived from a flux function and a uniform guide field:\n$$\nB_x(x,y,z) = a\\,x + s\\,\\sin(\\pi x)\\cos(\\pi y), \\quad\nB_y(x,y,z) = -a\\,y - s\\,\\cos(\\pi x)\\sin(\\pi y), \\quad\nB_z(x,y,z) = B_0,\n$$\nwith constants $a$, $s$, and $B_0$ (dimensionless). This satisfies $\\nabla\\cdot\\mathbf{B}=0$ and $B_z(x,y,z)=B_00$.\n\nNumerical requirements common to all tests:\n- Integrator: explicit fourth-order Runge–Kutta with $M$ steps over $z\\in[0,L]$.\n- Finite-difference increment: $\\varepsilon = 10^{-6}$.\n- The grid of footpoints on $z=0$ is a uniform $N\\times N$ Cartesian grid over $[x_{\\min},x_{\\max}]\\times[y_{\\min},y_{\\max}]$ including the endpoints.\n\nTest suite. Implement the following three test cases, each specified by $(a,s,B_0,L,N,x_{\\min},x_{\\max},y_{\\min},y_{\\max},Q_{\\mathrm{thr}},M)$:\n- Test A (happy path, linear hyperbolic flux tube): $(a,s,B_0,L,N,x_{\\min},x_{\\max},y_{\\min},y_{\\max},Q_{\\mathrm{thr}},M)=(1,0,1,1,15,-1,1,-1,1,5,400)$. Expect spatially uniform $Q$ greater than $Q_{\\mathrm{thr}}$.\n- Test B (boundary case, uniform field): $(a,s,B_0,L,N,x_{\\min},x_{\\max},y_{\\min},y_{\\max},Q_{\\mathrm{thr}},M)=(0,0,1,1,9,-1,1,-1,1,2.5,400)$. Expect spatially uniform $Q$ less than $Q_{\\mathrm{thr}}$.\n- Test C (nonlinear perturbation of hyperbolic tube): $(a,s,B_0,L,N,x_{\\min},x_{\\max},y_{\\min},y_{\\max},Q_{\\mathrm{thr}},M)=(1,0.3,1,1,13,-0.9,0.9,-0.9,0.9,10,400)$. Expect spatially varying $Q$ with localized enhancements.\n\nOutputs. For each test case, your program must compute:\n- The maximum squashing factor over the grid, $\\max Q$, as a floating-point value rounded to $6$ decimal places.\n- The count of grid points where $Q \\ge Q_{\\mathrm{thr}}$, as an integer.\n\nFinal output format. Your program should produce a single line of output containing the results for all three tests as a comma-separated list of lists:\n$$\n\\big[\\,[\\max Q_A,\\ \\mathrm{count}_A],\\ [\\max Q_B,\\ \\mathrm{count}_B],\\ [\\max Q_C,\\ \\mathrm{count}_C]\\,\\big]\n$$\nwhere each $\\max Q$ is rounded to $6$ decimal places. There are no physical units because all quantities are dimensionless by construction.", "solution": "The problem requires the development of a numerical code to identify potential sites of magnetic reconnection in given magnetic field configurations. This is accomplished by calculating the magnetic squashing factor, $Q$, across a grid of magnetic field-line footpoints. High values of $Q$ are associated with quasi-separatrix layers (QSLs), where magnetic reconnection is likely to occur. The solution involves numerically tracing magnetic field lines, approximating the Jacobian of the field-line mapping, and then computing $Q$.\n\nA magnetic field line is a curve $\\mathbf{r}(l)$ whose tangent is everywhere parallel to the magnetic field vector $\\mathbf{B}$, i.e., $d\\mathbf{r}/dl \\propto \\mathbf{B}$. The problem specifies a Cartesian domain where $B_z  0$, allowing us to use the $z$-coordinate as the independent variable for tracing field lines. The field-line equations are thus given by the system of ordinary differential equations (ODEs):\n$$\n\\frac{dx}{dz} = \\frac{B_x(x,y,z)}{B_z(x,y,z)}, \\qquad \\frac{dy}{dz} = \\frac{B_y(x,y,z)}{B_z(x,y,z)}\n$$\nLet us denote the state vector as $\\mathbf{p}(z) = (x(z), y(z))^T$. The ODE system can be written abstractly as $\\frac{d\\mathbf{p}}{dz} = \\mathbf{f}(z, \\mathbf{p})$, where $\\mathbf{f} = (B_x/B_z, B_y/B_z)^T$.\n\nTo solve this system numerically, we employ the explicit fourth-order Runge-Kutta (RK4) method. Given an initial position $\\mathbf{p}_n = \\mathbf{p}(z_n)$ at step $n$, the position at the next step $z_{n+1} = z_n + h$ is approximated by:\n$$\n\\mathbf{p}_{n+1} = \\mathbf{p}_n + \\frac{h}{6}(\\mathbf{k}_1 + 2\\mathbf{k}_2 + 2\\mathbf{k}_3 + \\mathbf{k}_4)\n$$\nwhere $h$ is the step size and the stages $\\mathbf{k}_i$ are:\n$$\n\\begin{aligned}\n\\mathbf{k}_1 = \\mathbf{f}(z_n, \\mathbf{p}_n) \\\\\n\\mathbf{k}_2 = \\mathbf{f}(z_n + \\frac{h}{2}, \\mathbf{p}_n + \\frac{h}{2}\\mathbf{k}_1) \\\\\n\\mathbf{k}_3 = \\mathbf{f}(z_n + \\frac{h}{2}, \\mathbf{p}_n + \\frac{h}{2}\\mathbf{k}_2) \\\\\n\\mathbf{k}_4 = \\mathbf{f}(z_n + h, \\mathbf{p}_n + h\\mathbf{k}_3)\n\\end{aligned}\n$$\nWe integrate from $z=0$ to $z=L$ using $M$ uniform steps, so the step size is $h = L/M$.\n\nThe field-line mapping, $\\mathcal{F}$, relates the starting coordinates $(x_0, y_0)$ of a field line at the $z=0$ boundary to its ending coordinates $(X, Y)$ at the $z=L$ boundary. This is formally written as $(X, Y) = \\mathcal{F}(x_0, y_0)$. The mapping is computed by integrating the field-line equations with initial conditions $(x(0), y(0)) = (x_0, y_0)$ to find $(X, Y) = (x(L), y(L))$.\n\nThe squashing factor $Q$ is defined based on the $2 \\times 2$ Jacobian matrix of this mapping, $D\\mathcal{F}$:\n$$\nD\\mathcal{F}(x_0,y_0) \\equiv \n\\begin{pmatrix}\n\\frac{\\partial X}{\\partial x_0}  \\frac{\\partial X}{\\partial y_0} \\\\\n\\frac{\\partial Y}{\\partial x_0}  \\frac{\\partial Y}{\\partial y_0}\n\\end{pmatrix}\n$$\nSince an analytical expression for $\\mathcal{F}$ is generally not available, we approximate the partial derivatives in the Jacobian using a symmetric two-point finite difference formula. For a small displacement $\\varepsilon$, the derivatives are calculated as:\n$$\n\\begin{aligned}\n\\frac{\\partial X}{\\partial x_0} \\approx \\frac{X(x_0+\\varepsilon, y_0) - X(x_0-\\varepsilon, y_0)}{2\\varepsilon},  \\frac{\\partial X}{\\partial y_0} \\approx \\frac{X(x_0, y_0+\\varepsilon) - X(x_0, y_0-\\varepsilon)}{2\\varepsilon} \\\\\n\\frac{\\partial Y}{\\partial x_0} \\approx \\frac{Y(x_0+\\varepsilon, y_0) - Y(x_0-\\varepsilon, y_0)}{2\\varepsilon},  \\frac{\\partial Y}{\\partial y_0} \\approx \\frac{Y(x_0, y_0+\\varepsilon) - Y(x_0, y_0-\\varepsilon)}{2\\varepsilon}\n\\end{aligned}\n$$\nThis requires four separate field-line integrations for each footpoint $(x_0, y_0)$ where the Jacobian is to be evaluated.\n\nWith the elements of the Jacobian matrix, we compute the squashing factor $Q$ using its definition:\n$$\nQ(x_0,y_0) = \\frac{\\left\\| D\\mathcal{F}(x_0,y_0) \\right\\|_F^2}{\\left| \\det D\\mathcal{F}(x_0,y_0) \\right|} = \\frac{\\left(\\frac{\\partial X}{\\partial x_0}\\right)^2 + \\left(\\frac{\\partial X}{\\partial y_0}\\right)^2 + \\left(\\frac{\\partial Y}{\\partial x_0}\\right)^2 + \\left(\\frac{\\partial Y}{\\partial y_0}\\right)^2}{\\left| \\frac{\\partial X}{\\partial x_0}\\frac{\\partial Y}{\\partial y_0} - \\frac{\\partial X}{\\partial y_0}\\frac{\\partial Y}{\\partial x_0} \\right|}\n$$\nThe numerator is the squared Frobenius norm of the Jacobian, and the denominator is the absolute value of its determinant.\n\nThe overall algorithm proceeds as follows for each test case:\n1. Define the grid of $N \\times N$ footpoints $(x_0, y_0)$ on the $z=0$ plane over the domain $[x_{\\min}, x_{\\max}] \\times [y_{\\min}, y_{\\max}]$.\n2. Initialize a variable for the maximum $Q$, $\\max Q = 0$, and a counter for points exceeding the threshold, $\\mathrm{count} = 0$.\n3. For each footpoint $(x_0, y_0)$ in the grid:\n    a. Perform four RK4 integrations to find the endpoints for the initial conditions $(x_0 \\pm \\varepsilon, y_0, 0)$ and $(x_0, y_0 \\pm \\varepsilon, 0)$.\n    b. Compute the four elements of the Jacobian $D\\mathcal{F}$ using the finite difference formulas.\n    c. Calculate the value of $Q$ from the Jacobian elements.\n    d. If $Q  \\max Q$, update $\\max Q = Q$.\n    e. If $Q \\ge Q_{\\mathrm{thr}}$, increment $\\mathrm{count}$.\n4. After iterating through all grid points, store the final $\\max Q$ (rounded to $6$ decimal places) and $\\mathrm{count}$.\n5. After processing all test cases, the results are formatted into a single-line string representing a list of lists.\nFor the specific magnetic field $\\mathbf{B} = (a\\,x + s\\,\\sin(\\pi x)\\cos(\\pi y), -a\\,y - s\\,\\cos(\\pi x)\\sin(\\pi y), B_0)$, the ODE right-hand side is $\\mathbf{f} = \\frac{1}{B_0}(B_x, B_y)^T$ since $B_z$ is constant.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef dz_derivs(z, pos, a, s, B0):\n    \"\"\"\n    Computes the RHS of the field-line ODEs, d(x,y)/dz.\n    z is formally an argument but is unused since B is z-independent.\n    \"\"\"\n    x, y = pos\n    # Bx = a*x + s*sin(pi*x)*cos(pi*y)\n    # By = -a*y - s*cos(pi*x)*sin(pi*y)\n    # Bz = B0\n    # dx/dz = Bx/Bz, dy/dz = By/Bz\n    bx = a * x + s * np.sin(np.pi * x) * np.cos(np.pi * y)\n    by = -a * y - s * np.cos(np.pi * x) * np.sin(np.pi * y)\n    return np.array([bx, by]) / B0\n\ndef trace_field_line(x0, y0, L, M, a, s, B0):\n    \"\"\"\n    Integrates a magnetic field line from (x0, y0, 0) to z=L.\n    Uses the 4th-order Runge-Kutta method.\n    \"\"\"\n    pos = np.array([x0, y0], dtype=np.float64)\n    z = 0.0\n    h = L / M\n\n    for _ in range(M):\n        k1 = dz_derivs(z, pos, a, s, B0)\n        k2 = dz_derivs(z + h/2, pos + h/2 * k1, a, s, B0)\n        k3 = dz_derivs(z + h/2, pos + h/2 * k2, a, s, B0)\n        k4 = dz_derivs(z + h, pos + h * k3, a, s, B0)\n        pos += (h/6) * (k1 + 2*k2 + 2*k3 + k4)\n        z += h\n    return pos\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (a, s, B0, L, N, x_min, x_max, y_min, y_max, Q_thr, M)\n        # Test A (happy path, linear hyperbolic flux tube)\n        (1, 0, 1, 1, 15, -1, 1, -1, 1, 5, 400),\n        # Test B (boundary case, uniform field)\n        (0, 0, 1, 1, 9, -1, 1, -1, 1, 2.5, 400),\n        # Test C (nonlinear perturbation of hyperbolic tube)\n        (1, 0.3, 1, 1, 13, -0.9, 0.9, -0.9, 0.9, 10, 400)\n    ]\n\n    all_results = []\n    # Finite-difference increment\n    eps = 1e-6\n\n    for case_params in test_cases:\n        a, s, B0, L, N, x_min, x_max, y_min, y_max, Q_thr, M = case_params\n\n        x_grid = np.linspace(x_min, x_max, N, dtype=np.float64)\n        y_grid = np.linspace(y_min, y_max, N, dtype=np.float64)\n\n        max_q = 0.0\n        q_count = 0\n\n        for y0 in y_grid:\n            for x0 in x_grid:\n                # Main logic to calculate the result for one grid point\n                # Trace four field lines for finite differences\n                pos_px = trace_field_line(x0 + eps, y0, L, M, a, s, B0)\n                pos_mx = trace_field_line(x0 - eps, y0, L, M, a, s, B0)\n                pos_py = trace_field_line(x0, y0 + eps, L, M, a, s, B0)\n                pos_my = trace_field_line(x0, y0 - eps, L, M, a, s, B0)\n\n                # Compute Jacobian elements\n                dX_dx0 = (pos_px[0] - pos_mx[0]) / (2 * eps)\n                dY_dx0 = (pos_px[1] - pos_mx[1]) / (2 * eps)\n                \n                dX_dy0 = (pos_py[0] - pos_my[0]) / (2 * eps)\n                dY_dy0 = (pos_py[1] - pos_my[1]) / (2 * eps)\n\n                # Compute squashing factor Q\n                norm_sq = dX_dx0**2 + dX_dy0**2 + dY_dx0**2 + dY_dy0**2\n                det = dX_dx0 * dY_dy0 - dX_dy0 * dY_dx0\n\n                q_val = 0.0\n                if abs(det) > 1e-15: # Avoid division by zero\n                    q_val = norm_sq / abs(det)\n                else:\n                    # If determinant is zero, Q is infinite (true separatrix)\n                    # unless norm_sq is also zero (trivial mapping)\n                    q_val = np.inf if norm_sq > 1e-15 else 2.0\n\n                if q_val >= Q_thr:\n                    q_count += 1\n                \n                if q_val > max_q:\n                    max_q = q_val\n        \n        # Store rounded max Q and the integer count\n        all_results.append([round(max_q, 6), q_count])\n\n    # Final print statement in the exact required format without spaces\n    sub_strings = [f\"[{r[0]},{r[1]}]\" for r in all_results]\n    print(f\"[{','.join(sub_strings)}]\")\n\nsolve()\n```", "id": "3519769"}]}