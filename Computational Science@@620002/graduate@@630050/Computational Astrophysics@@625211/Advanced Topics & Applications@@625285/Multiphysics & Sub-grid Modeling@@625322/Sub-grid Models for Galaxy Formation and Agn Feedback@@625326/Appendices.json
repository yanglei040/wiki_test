{"hands_on_practices": [{"introduction": "A primary goal of feedback models is to explain the powerful galactic outflows observed in nature. In the dense centers of starburst galaxies and around quasars, intense radiation can be trapped by dust, transferring its momentum multiple times and driving a strong wind. This exercise [@problem_id:3537605] provides a hands-on calculation of this \"momentum-driven\" outflow, asking you to connect the fundamental luminosity of the central engine to the terminal velocity of the resulting wind by balancing the radiative force against the outflow's momentum flux.", "problem": "In a sub-grid radiation pressure feedback model for galaxy formation and Active Galactic Nucleus (AGN) feedback, dusty gas reprocesses ultraviolet into infrared radiation, leading to a momentum boost proportional to the infrared optical depth. Assume that radiation of bolometric luminosity $L$ imparts momentum to the gas at a rate characterized by an effective momentum flux due to multiple scatterings in the infrared with optical depth $\\tau_{\\mathrm{IR}}$. The mass outflow rate is linked to the star-forming reservoir via the mass-loading factor $\\eta$ through $\\dot{M}_{\\mathrm{out}} = \\eta \\,\\dot{M}_{\\star}$, where $\\dot{M}_{\\star}$ is the Star Formation Rate (SFR). In the steady, momentum-driven limit with negligible gravity at the launch scale and isotropic coupling, the terminal velocity $v_{\\infty}$ of the wind can be estimated by equating the radiation-driven momentum flux to the wind momentum flux.\n\nStarting from fundamental radiative momentum transfer and conservation of momentum, compute the radiation-driven momentum flux and estimate the wind terminal velocity under the following conditions: $\\tau_{\\mathrm{IR}} = 5$, $L = 10^{46}\\,\\mathrm{erg\\,s^{-1}}$, $\\eta = 1$, and $\\dot{M}_{\\star} = 50\\,M_{\\odot}\\,\\mathrm{yr^{-1}}$. Use the speed of light $c = 2.99792458 \\times 10^{10}\\,\\mathrm{cm\\,s^{-1}}$, solar mass $M_{\\odot} = 1.98847 \\times 10^{33}\\,\\mathrm{g}$, and $1\\,\\mathrm{yr} = 3.15576 \\times 10^{7}\\,\\mathrm{s}$. Round your answer to $4$ significant figures. Express the momentum flux in dyne and the terminal velocity in $\\mathrm{km\\,s^{-1}}$. The solution must justify the formulae used from first principles, without invoking empirical fitting functions or unresolved parameterizations beyond the stated assumptions.", "solution": "The problem will be solved in two parts: first, the calculation of the radiation momentum flux, and second, the estimation of the wind terminal velocity.\n\n**Part 1: Radiation-Driven Momentum Flux**\n\nThe fundamental principle is the transfer of momentum from a radiation field to matter. According to the theory of relativity, a photon with energy $E$ carries momentum $p = E/c$, where $c$ is the speed of light. The rate of energy emission from the central source is its bolometric luminosity, $L = dE/dt$. Consequently, the rate at which momentum is carried away by the radiation field, i.e., the momentum flux of the photons, is $\\dot{p}_{\\gamma} = d p/dt = (1/c) dE/dt = L/c$.\n\nIn the context of this problem, the radiation interacts with a dusty gas. The total momentum imparted to the gas is the sum of two effects:\n1.  The initial absorption of high-energy (UV/optical) photons. If all photons are absorbed, this transfers momentum at a rate of $\\dot{p}_{\\mathrm{abs}} = L/c$.\n2.  The re-radiation of this energy at infrared wavelengths by the heated dust, and the subsequent multiple scattering of these IR photons within the optically thick medium. The problem states that this leads to a \"momentum boost proportional to the infrared optical depth $\\tau_{\\mathrm{IR}}$\". In a standard optically thick, radiation pressure-supported medium, a photon random-walks and imparts its momentum approximately $\\tau_{\\mathrm{IR}}$ times before escaping. This provides an additional momentum flux of $\\dot{p}_{\\mathrm{scatter}} \\approx \\tau_{\\mathrm{IR}} (L/c)$.\n\nThe total radiation momentum flux imparted to the gas, $\\dot{p}_{\\mathrm{rad}}$, is the sum of the momentum from initial absorption and subsequent multiple scatterings.\n$$\n\\dot{p}_{\\mathrm{rad}} = \\dot{p}_{\\mathrm{abs}} + \\dot{p}_{\\mathrm{scatter}} = \\frac{L}{c} + \\tau_{\\mathrm{IR}} \\frac{L}{c} = (1 + \\tau_{\\mathrm{IR}}) \\frac{L}{c}\n$$\nThis formula is derived from the first principles of radiative transfer under the simplifying assumptions of the model and is not an arbitrary empirical function. We are given the values $L = 10^{46}\\,\\mathrm{erg\\,s^{-1}}$, $\\tau_{\\mathrm{IR}} = 5$, and $c = 2.99792458 \\times 10^{10}\\,\\mathrm{cm\\,s^{-1}}$. Substituting these values:\n$$\n\\dot{p}_{\\mathrm{rad}} = (1 + 5) \\frac{10^{46}\\,\\mathrm{erg\\,s^{-1}}}{2.99792458 \\times 10^{10}\\,\\mathrm{cm\\,s^{-1}}}\n$$\n$$\n\\dot{p}_{\\mathrm{rad}} = \\frac{6 \\times 10^{46}}{2.99792458 \\times 10^{10}}\\,\\mathrm{erg\\,cm^{-1}}\n$$\nThe unit $\\mathrm{erg\\,cm^{-1}}$ is equivalent to $\\mathrm{g\\,cm^{2}\\,s^{-2} / cm} = \\mathrm{g\\,cm\\,s^{-2}}$, which is the CGS unit of force, the dyne.\n$$\n\\dot{p}_{\\mathrm{rad}} \\approx 2.0013856 \\times 10^{36}\\,\\mathrm{dyne}\n$$\nRounding to $4$ significant figures, the radiation-driven momentum flux is $2.001 \\times 10^{36}\\,\\mathrm{dyne}$.\n\n**Part 2: Wind Terminal Velocity**\n\nThe problem asks to estimate the wind's terminal velocity $v_{\\infty}$ by equating the radiation-driven momentum flux to the wind's momentum flux. This is the condition for a steady, momentum-driven outflow where the radiative force is balanced by the rate of momentum gain of the outflowing material.\n\nThe momentum flux of the wind, $\\dot{p}_{\\mathrm{wind}}$, is the product of the mass outflow rate, $\\dot{M}_{\\mathrm{out}}$, and the terminal velocity of the wind, $v_{\\infty}$.\n$$\n\\dot{p}_{\\mathrm{wind}} = \\dot{M}_{\\mathrm{out}} v_{\\infty}\n$$\nThe problem specifies that the mass outflow rate is related to the star formation rate, $\\dot{M}_{\\star}$, through the mass-loading factor, $\\eta$:\n$$\n\\dot{M}_{\\mathrm{out}} = \\eta \\dot{M}_{\\star}\n$$\nThus, the wind momentum flux is:\n$$\n\\dot{p}_{\\mathrm{wind}} = \\eta \\dot{M}_{\\star} v_{\\infty}\n$$\nEquating the radiation and wind momentum fluxes, $\\dot{p}_{\\mathrm{rad}} = \\dot{p}_{\\mathrm{wind}}$:\n$$\n(1 + \\tau_{\\mathrm{IR}}) \\frac{L}{c} = \\eta \\dot{M}_{\\star} v_{\\infty}\n$$\nWe can now solve for the terminal velocity $v_{\\infty}$:\n$$\nv_{\\infty} = \\frac{(1 + \\tau_{\\mathrm{IR}}) L}{\\eta \\dot{M}_{\\star} c}\n$$\nTo calculate the numerical value, we first need to convert the star formation rate $\\dot{M}_{\\star}$ into CGS units ($\\mathrm{g\\,s^{-1}}$). We are given $\\dot{M}_{\\star} = 50\\,M_{\\odot}\\,\\mathrm{yr^{-1}}$, $M_{\\odot} = 1.98847 \\times 10^{33}\\,\\mathrm{g}$, and $1\\,\\mathrm{yr} = 3.15576 \\times 10^{7}\\,\\mathrm{s}$.\n$$\n\\dot{M}_{\\star} = 50 \\frac{M_{\\odot}}{\\mathrm{yr}} = 50 \\times \\frac{1.98847 \\times 10^{33}\\,\\mathrm{g}}{3.15576 \\times 10^{7}\\,\\mathrm{s}}\n$$\n$$\n\\dot{M}_{\\star} \\approx 3.150495 \\times 10^{27}\\,\\mathrm{g\\,s^{-1}}\n$$\nNow we substitute the values for $\\eta=1$, $\\dot{M}_{\\star}$, and the previously calculated $\\dot{p}_{\\mathrm{rad}}$ into the expression for $v_{\\infty}$.\n$$\nv_{\\infty} = \\frac{\\dot{p}_{\\mathrm{rad}}}{\\eta \\dot{M}_{\\star}} = \\frac{2.0013856 \\times 10^{36}\\,\\mathrm{g\\,cm\\,s^{-2}}}{1 \\times (3.150495 \\times 10^{27}\\,\\mathrm{g\\,s^{-1}})}\n$$\n$$\nv_{\\infty} \\approx 6.35260 \\times 10^{8}\\,\\mathrm{cm\\,s^{-1}}\n$$\nThe problem requires the answer in $\\mathrm{km\\,s^{-1}}$. We use the conversion $1\\,\\mathrm{km} = 10^5\\,\\mathrm{cm}$.\n$$\nv_{\\infty} \\approx \\frac{6.35260 \\times 10^{8}\\,\\mathrm{cm\\,s^{-1}}}{10^{5}\\,\\mathrm{cm\\,km^{-1}}} \\approx 6352.60\\,\\mathrm{km\\,s^{-1}}\n$$\nRounding to $4$ significant figures, the wind terminal velocity is $6353\\,\\mathrm{km\\,s^{-1}}$.\n\nThe final calculated values are a momentum flux of $2.001 \\times 10^{36}\\,\\mathrm{dyne}$ and a terminal velocity of $6353\\,\\mathrm{km\\,s^{-1}}$.", "answer": "$$\n\\boxed{\\begin{pmatrix} 2.001 \\times 10^{36}  6.353 \\times 10^{3} \\end{pmatrix}}\n$$", "id": "3537605"}, {"introduction": "While radiation pressure is a key feedback mechanism, Active Galactic Nuclei also inject vast amounts of energy kinetically or thermally, inflating large, hot bubbles in the surrounding halo gas. The large-scale impact of this \"jet mode\" feedback depends on how these buoyant bubbles rise and distribute their energy throughout the intracluster or circumgalactic medium. This practice [@problem_id:3537559] applies classical fluid dynamics to this astrophysical scenario, allowing you to derive the terminal rise speed of a bubble by balancing the upward buoyant force with the downward hydrodynamic drag.", "problem": "In a cosmological hydrodynamics simulation of galaxy formation, an Active Galactic Nucleus (AGN) injects energy that inflates a low-density bubble in the Intracluster Medium (ICM). Because the bubble interior and its turbulent boundary layer are unresolved, the sub-grid model represents the bubble as a spherical body subject to buoyancy and hydrodynamic drag. Consider a single bubble of radius $R=10\\,\\mathrm{kpc}$ embedded in an ICM with gravitational acceleration $g=10^{-8}\\,\\mathrm{cm\\,s^{-2}}$ and density contrast $\\Delta \\rho / \\rho \\approx 1$, where $\\rho$ is the ambient ICM density and $\\Delta \\rho$ is the difference between ambient and bubble interior density. Assume the high Reynolds number regime appropriate for the ICM, and adopt a constant drag coefficient for a spherical body $C_{d}=0.5$ as typical in sub-grid models of buoyant bubbles.\n\nStarting from the following fundamental base:\n- Archimedes’ principle for buoyancy in a gravitational field, which states that the buoyant force equals the weight of displaced fluid.\n- The standard inertial drag law for a body moving through a fluid at high Reynolds number, where the drag force is proportional to the dynamic pressure times the cross-sectional area.\n\nDerive the terminal buoyant rise speed of the bubble by balancing buoyancy and drag, and then estimate the rise time to travel a distance equal to its own radius. Use $1\\,\\mathrm{kpc}=3.08567758\\times 10^{21}\\,\\mathrm{cm}$ and $1\\,\\mathrm{Myr}=3.15576\\times 10^{13}\\,\\mathrm{s}$ for unit conversions. Round both the speed and the time to three significant figures. Express the final speed in $\\mathrm{km\\,s^{-1}}$ and the final time in $\\mathrm{Myr}$.", "solution": "The terminal buoyant rise speed, $v_t$, is achieved when the upward buoyant force, $F_B$, is exactly balanced by the downward hydrodynamic drag force, $F_D$. The bubble is modeled as a sphere of radius $R$.\n\nThe volume of the spherical bubble is given by:\n$$V = \\frac{4}{3}\\pi R^3$$\n\nThe cross-sectional area of the bubble perpendicular to its motion is:\n$$A = \\pi R^2$$\n\nThe buoyant force is given by Archimedes' principle. The net upward force is the weight of the displaced ambient fluid minus the weight of the bubble itself.\n$$F_B = (\\rho - \\rho_{\\text{bubble}}) V g = \\Delta \\rho V g$$\nSubstituting the expression for the volume $V$:\n$$F_B = \\Delta \\rho \\left(\\frac{4}{3}\\pi R^3\\right) g$$\n\nThe hydrodynamic drag force for a body at high Reynolds number is given by the inertial drag law:\n$$F_D = C_d A \\left(\\frac{1}{2}\\rho v^2\\right)$$\nHere, $\\rho$ is the density of the ambient medium through which the bubble moves, $v$ is the bubble's speed, and $C_d$ is the dimensionless drag coefficient. Substituting the expression for the area $A$:\n$$F_D = C_d (\\pi R^2) \\frac{1}{2}\\rho v^2 = \\frac{1}{2} C_d \\pi R^2 \\rho v^2$$\n\nAt terminal velocity $v_t$, the forces are in equilibrium, $F_B = F_D$:\n$$\\Delta \\rho \\left(\\frac{4}{3}\\pi R^3\\right) g = \\frac{1}{2} C_d \\pi R^2 \\rho v_t^2$$\n\nWe now solve for $v_t^2$. We can simplify by canceling common terms $(\\pi R^2)$:\n$$\\Delta \\rho \\left(\\frac{4}{3}R\\right) g = \\frac{1}{2} C_d \\rho v_t^2$$\nRearranging to isolate $v_t^2$:\n$$v_t^2 = \\frac{\\frac{4}{3} \\Delta \\rho R g}{\\frac{1}{2} C_d \\rho} = \\frac{8}{3} \\left(\\frac{\\Delta \\rho}{\\rho}\\right) \\frac{g R}{C_d}$$\nThe terminal velocity is the square root of this expression:\n$$v_t = \\sqrt{\\frac{8}{3} \\left(\\frac{\\Delta \\rho}{\\rho}\\right) \\frac{g R}{C_d}}$$\n\nWe now substitute the given values into this symbolic expression.\n- $\\frac{\\Delta \\rho}{\\rho} \\approx 1$\n- $C_d = 0.5$\n- $g = 10^{-8}\\,\\mathrm{cm\\,s^{-2}}$\n- $R = 10\\,\\mathrm{kpc} = 10 \\times (3.08567758 \\times 10^{21}\\,\\mathrm{cm}) = 3.08567758 \\times 10^{22}\\,\\mathrm{cm}$\n\nSubstituting the numerical values for the dimensionless constants:\n$$v_t = \\sqrt{\\frac{8}{3} (1) \\frac{g R}{0.5}} = \\sqrt{\\frac{16}{3} g R}$$\nNow, we substitute the physical quantities in CGS units:\n$$v_t = \\sqrt{\\frac{16}{3} (10^{-8}\\,\\mathrm{cm\\,s^{-2}}) (3.08567758 \\times 10^{22}\\,\\mathrm{cm})}$$\n$$v_t = \\sqrt{1.645694709 \\times 10^{15}\\,\\mathrm{cm^2\\,s^{-2}}} \\approx 4.0567163 \\times 10^7\\,\\mathrm{cm\\,s^{-1}}$$\nThe problem requires the speed in $\\mathrm{km\\,s^{-1}}$. We use the conversion $1\\,\\mathrm{km} = 10^5\\,\\mathrm{cm}$:\n$$v_t \\approx (4.0567163 \\times 10^7\\,\\mathrm{cm\\,s^{-1}}) \\times \\left(\\frac{1\\,\\mathrm{km}}{10^5\\,\\mathrm{cm}}\\right) = 405.67163\\,\\mathrm{km\\,s^{-1}}$$\nRounding to three significant figures, the terminal speed is:\n$$v_t \\approx 406\\,\\mathrm{km\\,s^{-1}}$$\n\nNext, we estimate the rise time, $t$, for the bubble to travel a distance, $d$, equal to its own radius, $R$. Assuming the bubble travels at its terminal velocity (i.e., the acceleration phase is negligible), the time is given by:\n$$t = \\frac{d}{v_t} = \\frac{R}{v_t}$$\nUsing the unrounded value for $v_t$ to maintain precision:\n$$t = \\frac{3.08567758 \\times 10^{22}\\,\\mathrm{cm}}{4.0567163 \\times 10^7\\,\\mathrm{cm\\,s^{-1}}} \\approx 7.60639 \\times 10^{14}\\,\\mathrm{s}$$\nThe problem requires the time in megayears (Myr). We use the conversion $1\\,\\mathrm{Myr} = 3.15576 \\times 10^{13}\\,\\mathrm{s}$:\n$$t \\approx \\frac{7.60639 \\times 10^{14}\\,\\mathrm{s}}{3.15576 \\times 10^{13}\\,\\mathrm{s/Myr}} \\approx 24.1032\\,\\mathrm{Myr}$$\nRounding to three significant figures, the rise time is:\n$$t \\approx 24.1\\,\\mathrm{Myr}$$\n\nThe final answers are a terminal speed of $406\\,\\mathrm{km\\,s^{-1}}$ and a rise time of $24.1\\,\\mathrm{Myr}$.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n406  24.1\n\\end{pmatrix}\n}\n$$", "id": "3537559"}, {"introduction": "Implementing physical models in a numerical simulation introduces a new set of challenges that are not purely physical. To prevent the unphysical, artificial collapse of gas clumps, simulations must ensure the local Jeans length, $\\lambda_J$, is adequately resolved by the computational grid. This computational experiment [@problem_id:3537584] tasks you with designing and testing a common sub-grid solution—a pressure floor—while also evaluating its unintended consequences on another critical process, the accretion onto the central black hole. This practice highlights the crucial trade-offs inherent in sub-grid modeling.", "problem": "You are asked to design and implement a computational experiment to assess whether a sub-grid pressure floor of the form $P_{\\mathrm{floor}} = K \\,\\rho^{\\gamma_{\\mathrm{eff}}}$ can prevent artificial fragmentation in Active Galactic Nucleus (AGN) influenced galactic cores while not biasing black hole accretion histories. The assessment must be done purely from first principles and well-tested formulas, and your program must decide this for a set of test cases.\n\nBegin from the following fundamental bases:\n- The Jeans instability criterion in a barotropic fluid, where the instantaneous effective sound speed is $c_s^2 = \\mathrm{d}P/\\mathrm{d}\\rho$, and the Jeans length is\n$$\n\\lambda_J = \\sqrt{\\frac{\\pi\\, c_s^2}{G\\,\\rho}}.\n$$\n- The Bondi accretion rate (steady, spherically symmetric) for a black hole of mass $M_{\\mathrm{BH}}$ in gas of density $\\rho$ and sound speed $c_s$ with relative velocity $v$,\n$$\n\\dot{M}_{\\mathrm{Bondi}} \\propto \\frac{\\rho\\, G^2 M_{\\mathrm{BH}}^2}{\\left(c_s^2 + v^2\\right)^{3/2}},\n$$\nwhich is used only up to a ratio, so all proportionality constants cancel in a comparative analysis.\n\nYou must:\n1. Treat the gas as barotropic under the sub-grid floor with $P_{\\mathrm{floor}} = K\\,\\rho^{\\gamma_{\\mathrm{eff}}}$, so that $c_{s,\\mathrm{eff}}^2 = \\mathrm{d}P_{\\mathrm{floor}}/\\mathrm{d}\\rho$.\n2. Choose the coefficient $K$ such that the Jeans length requirement $\\lambda_J \\ge N_J \\Delta x$ is satisfied for all densities in an AGN core density range $\\rho \\in [\\rho_{\\min}, \\rho_{\\max}]$. To achieve this, identify the most constraining reference density $\\rho_{\\mathrm{ref}}$ in the range based on the monotonicity of $\\lambda_J(\\rho)$ implied by the chosen $\\gamma_{\\mathrm{eff}}$, and enforce $\\lambda_J(\\rho_{\\mathrm{ref}}) = N_J \\Delta x$ to set $K$. You must derive the needed expressions from the above bases; do not assume or import any further closed-form results.\n3. Quantify accretion bias by comparing, at each density, the Bondi accretion rate evaluated with and without the pressure floor. Adopt a thermal baseline with gas temperature $T_0$ and adiabatic index $\\gamma_{\\mathrm{ad}}$, giving a baseline thermal sound speed $c_{s,0}^2 = \\gamma_{\\mathrm{ad}} k_B T_0 / (\\mu m_p)$. With the floor active, use $c_{s,\\mathrm{use}}^2(\\rho) = \\max\\left(c_{s,0}^2,\\; c_{s,\\mathrm{eff}}^2(\\rho)\\right)$. For each density, define the instantaneous ratio\n$$\n\\mathcal{R}(\\rho) \\equiv \\frac{\\dot{M}_{\\mathrm{Bondi, floor}}(\\rho)}{\\dot{M}_{\\mathrm{Bondi, base}}(\\rho)} = \\left(\\frac{c_{s,0}^2 + v^2}{c_{s,\\mathrm{use}}^2(\\rho) + v^2}\\right)^{3/2}.\n$$\nAggregate over the density range using a mass-weighting proportional to $\\rho$ on a fixed log-spaced grid of $N_{\\mathrm{dens}}$ densities between $n_{\\mathrm{H},\\min}$ and $n_{\\mathrm{H},\\max}$, where $\\rho = \\mu m_p n_{\\mathrm{H}}$. Define the mass-weighted mean ratio\n$$\n\\overline{\\mathcal{R}} = \\frac{\\sum_i \\rho_i \\,\\mathcal{R}(\\rho_i)}{\\sum_i \\rho_i}.\n$$\nDeclare the sub-grid floor to be “non-biasing” if $|\\overline{\\mathcal{R}} - 1| \\le \\tau$ for a specified tolerance $\\tau$.\n4. Declare the floor to “prevent artificial fragmentation” if for all densities in the grid the Jeans criterion is satisfied, i.e., $\\lambda_J(\\rho) \\ge N_J \\Delta x$ when evaluated using the floor $P_{\\mathrm{floor}}$ and its implied $c_{s,\\mathrm{eff}}(\\rho)$.\n5. For each test case, output a boolean that is true if and only if both conditions hold: it prevents artificial fragmentation and is non-biasing by the above criterion.\n\nConstants, units, and fixed choices:\n- Use centimeter–gram–second units throughout. Gravitational constant $G$ in $\\mathrm{cm^3\\,g^{-1}\\,s^{-2}}$, Boltzmann constant $k_B$ in $\\mathrm{erg\\,K^{-1}}$, proton mass $m_p$ in $\\mathrm{g}$, Solar mass $M_\\odot$ in $\\mathrm{g}$, and parsec in $\\mathrm{cm}$.\n- Use mean molecular weight $\\mu = 0.62$, adiabatic index $\\gamma_{\\mathrm{ad}} = 5/3$, and baseline temperature $T_0 = 10^{4}\\,\\mathrm{K}$.\n- Use a log-spaced density grid with $N_{\\mathrm{dens}} = 64$ samples from $n_{\\mathrm{H},\\min} = 10^{2}\\,\\mathrm{cm^{-3}}$ to $n_{\\mathrm{H},\\max} = 10^{5}\\,\\mathrm{cm^{-3}}$. Convert to mass density via $\\rho = \\mu m_p n_{\\mathrm{H}}$.\n- Use tolerance $\\tau = 0.25$ (i.e., deviations up to a quarter in the mass-weighted mean ratio are acceptable).\n- The Bondi mass $M_{\\mathrm{BH}}$ is given in Solar masses but cancels out in the ratio; include it in parameters for completeness and scientific realism.\n\nTest suite of parameter sets to evaluate:\n- Case A (happy path): $\\Delta x = 5\\,\\mathrm{pc}$, $N_J = 4$, $\\gamma_{\\mathrm{eff}} = 4/3$, $M_{\\mathrm{BH}} = 10^{8}\\,M_\\odot$, $v = 50\\,\\mathrm{km\\,s^{-1}}$.\n- Case B (bias-prone isothermal floor at coarse resolution): $\\Delta x = 20\\,\\mathrm{pc}$, $N_J = 4$, $\\gamma_{\\mathrm{eff}} = 1.0$, $M_{\\mathrm{BH}} = 10^{8}\\,M_\\odot$, $v = 10\\,\\mathrm{km\\,s^{-1}}$.\n- Case C (stiff floor with low relative velocity): $\\Delta x = 5\\,\\mathrm{pc}$, $N_J = 4$, $\\gamma_{\\mathrm{eff}} = 2.0$, $M_{\\mathrm{BH}} = 10^{8}\\,M_\\odot$, $v = 10\\,\\mathrm{km\\,s^{-1}}$.\n- Case D (stiff floor but high relative velocity): $\\Delta x = 5\\,\\mathrm{pc}$, $N_J = 4$, $\\gamma_{\\mathrm{eff}} = 2.0$, $M_{\\mathrm{BH}} = 10^{8}\\,M_\\odot$, $v = 300\\,\\mathrm{km\\,s^{-1}}$.\n- Case E (fine resolution polytropic floor): $\\Delta x = 0.5\\,\\mathrm{pc}$, $N_J = 4$, $\\gamma_{\\mathrm{eff}} = 4/3$, $M_{\\mathrm{BH}} = 10^{8}\\,M_\\odot$, $v = 10\\,\\mathrm{km\\,s^{-1}}$.\n\nImplementation requirements:\n- For each case, compute the coefficient $K$ by enforcing $\\lambda_J(\\rho_{\\mathrm{ref}}) = N_J \\Delta x$ at the most constraining density $\\rho_{\\mathrm{ref}}$ within $[\\rho_{\\min}, \\rho_{\\max}]$, determined by the sign of $\\mathrm{d}\\ln \\lambda_J / \\mathrm{d}\\ln \\rho$ implied by $\\gamma_{\\mathrm{eff}}$. Then evaluate the two criteria above across the density grid and combine them into the final boolean.\n- Angle units are not applicable.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[result_1,result_2,\\dots]$) where each entry is a boolean corresponding to the cases in the order A, B, C, D, E.\n\nAll numerical inputs are given above; ensure all internal calculations use the specified units. The final outputs are booleans and therefore unitless.", "solution": "The problem asks us to design and implement a computational experiment to evaluate a sub-grid pressure floor model, $P_{\\mathrm{floor}} = K \\rho^{\\gamma_{\\mathrm{eff}}}$, for its ability to prevent artificial fragmentation in simulations while not biasing black hole accretion rates. We must develop an algorithm based on first principles to test this for several scenarios. The solution proceeds in several logical steps.\n\n**1. Effective Sound Speed and Jeans Length**\nThe pressure floor is given by a barotropic equation of state, $P_{\\mathrm{floor}} = K \\rho^{\\gamma_{\\mathrm{eff}}}$. The corresponding effective sound speed squared, $c_{s,\\mathrm{eff}}^2$, is the derivative of pressure with respect to density:\n$$\nc_{s,\\mathrm{eff}}^2 = \\frac{\\mathrm{d}P_{\\mathrm{floor}}}{\\mathrm{d}\\rho} = \\frac{\\mathrm{d}}{\\mathrm{d}\\rho}\\left(K \\rho^{\\gamma_{\\mathrm{eff}}}\\right) = K \\gamma_{\\mathrm{eff}} \\rho^{\\gamma_{\\mathrm{eff}}-1}\n$$\nThe Jeans length, $\\lambda_J$, is a critical scale for gravitational instability. Using the effective sound speed from the pressure floor, it is given by:\n$$\n\\lambda_J(\\rho) = \\sqrt{\\frac{\\pi c_{s,\\mathrm{eff}}^2}{G \\rho}} = \\sqrt{\\frac{\\pi (K \\gamma_{\\mathrm{eff}} \\rho^{\\gamma_{\\mathrm{eff}}-1})}{G \\rho}} = \\sqrt{\\frac{\\pi K \\gamma_{\\mathrm{eff}}}{G}} \\rho^{\\frac{\\gamma_{\\mathrm{eff}}-2}{2}}\n$$\nwhere $G$ is the gravitational constant.\n\n**2. Determining the Coefficient $K$**\nThe pressure floor must prevent artificial fragmentation, which is achieved by ensuring that the Jeans length is always resolved by a minimum number of grid cells, $N_J$. This is a form of the Truelove-Bate-Couchman criterion: $\\lambda_J(\\rho) \\ge N_J \\Delta x$ for all densities $\\rho$ in the relevant range $[\\rho_{\\min}, \\rho_{\\max}]$. To ensure this condition holds, we must enforce it at the density $\\rho_{\\mathrm{ref}}$ where $\\lambda_J(\\rho)$ is at its minimum value within the range.\n\nThe monotonicity of $\\lambda_J(\\rho)$ depends on the sign of the exponent of $\\rho$, which is $(\\gamma_{\\mathrm{eff}}-2)/2$.\n- If $\\gamma_{\\mathrm{eff}}  2$, the exponent is negative, so $\\lambda_J(\\rho)$ is a decreasing function of $\\rho$. The minimum occurs at $\\rho_{\\mathrm{ref}} = \\rho_{\\max}$.\n- If $\\gamma_{\\mathrm{eff}}  2$, the exponent is positive, so $\\lambda_J(\\rho)$ is an increasing function of $\\rho$. The minimum occurs at $\\rho_{\\mathrm{ref}} = \\rho_{\\min}$.\n- If $\\gamma_{\\mathrm{eff}} = 2$, the exponent is zero, and $\\lambda_J(\\rho)$ is constant. Any density can be chosen as $\\rho_{\\mathrm{ref}}$; for consistency, we can choose one of the bounds, for example, $\\rho_{\\mathrm{ref}} = \\rho_{\\min}$.\n\nBy setting the Jeans length to the required minimum at this most constraining density, we satisfy the criterion everywhere in the density range.\n$$\n\\lambda_J(\\rho_{\\mathrm{ref}}) = N_J \\Delta x\n$$\nSquaring both sides and substituting the expression for $\\lambda_J(\\rho)$:\n$$\n(N_J \\Delta x)^2 = \\frac{\\pi K \\gamma_{\\mathrm{eff}}}{G} \\rho_{\\mathrm{ref}}^{\\gamma_{\\mathrm{eff}}-2}\n$$\nSolving for the coefficient $K$:\n$$\nK = \\frac{(N_J \\Delta x)^2 G}{\\pi \\gamma_{\\mathrm{eff}}} \\rho_{\\mathrm{ref}}^{2-\\gamma_{\\mathrm{eff}}}\n$$\nThis formula defines the value of $K$ for each test case.\n\n**3. Fragmentation Prevention Condition**\nThe first condition for a successful model is that it prevents artificial fragmentation. As per the problem, this is true if $\\lambda_J(\\rho) \\ge N_J \\Delta x$ for all densities on our test grid. By our construction of $K$, we have set an equality at the minimum of $\\lambda_J(\\rho)$ for the continuous range, so this condition is guaranteed to hold for all $\\rho \\in [\\rho_{\\min}, \\rho_{\\max}]$, and thus for all discrete points within it. The flag for this condition, `prevents_fragmentation`, will be determined by explicitly checking this for all points on the discrete density grid.\n\n**4. Accretion Bias Condition**\nThe second condition is that the floor does not unduly bias the black hole accretion rate, modeled by the Bondi rate, $\\dot{M}_{\\mathrm{Bondi}}$. We compare the rate with the floor to a baseline thermal case.\n\nThe baseline case assumes a gas with a constant temperature $T_0$ and adiabatic index $\\gamma_{\\mathrm{ad}}$. The baseline sound speed squared is:\n$$\nc_{s,0}^2 = \\frac{\\gamma_{\\mathrm{ad}} k_B T_0}{\\mu m_p}\n$$\nwhere $k_B$ is the Boltzmann constant, $\\mu$ is the mean molecular weight, and $m_p$ is the proton mass.\n\nWhen the pressure floor is active, the sound speed used in a simulation would be the maximum of the baseline thermal sound speed and the floor's effective sound speed:\n$$\nc_{s,\\mathrm{use}}^2(\\rho) = \\max\\left(c_{s,0}^2, c_{s,\\mathrm{eff}}^2(\\rho)\\right)\n$$\nThe Bondi accretion rate is proportional to $(c_s^2 + v^2)^{-3/2}$, where $v$ is the relative velocity between the black hole and the gas. The accretion bias is quantified by the ratio $\\mathcal{R}(\\rho)$:\n$$\n\\mathcal{R}(\\rho) = \\frac{\\dot{M}_{\\mathrm{Bondi, floor}}}{\\dot{M}_{\\mathrm{Bondi, base}}} = \\frac{\\left(c_{s,\\mathrm{use}}^2(\\rho) + v^2\\right)^{-3/2}}{\\left(c_{s,0}^2 + v^2\\right)^{-3/2}} = \\left(\\frac{c_{s,0}^2 + v^2}{c_{s,\\mathrm{use}}^2(\\rho) + v^2}\\right)^{3/2}\n$$\nNote that all other terms in the Bondi formula ($\\rho$, $G$, $M_{\\mathrm{BH}}$) cancel out.\n\nTo get a single metric for the bias, we compute a mass-weighted average of $\\mathcal{R}(\\rho)$ over a logarithmic grid of $N_{\\mathrm{dens}}$ gas number densities, $n_{\\mathrm{H},i}$, from $n_{\\mathrm{H},\\min}$ to $n_{\\mathrm{H},\\max}$. The mass density is $\\rho_i = \\mu m_p n_{\\mathrm{H},i}$.\n$$\n\\overline{\\mathcal{R}} = \\frac{\\sum_{i=1}^{N_{\\mathrm{dens}}} \\rho_i \\mathcal{R}(\\rho_i)}{\\sum_{i=1}^{N_{\\mathrm{dens}}} \\rho_i}\n$$\nThe floor is considered \"non-biasing\" if the average ratio is close to unity, specifically if $|\\overline{\\mathcal{R}} - 1| \\le \\tau$, where $\\tau$ is a given tolerance.\n\n**5. Algorithm Summary**\nFor each test case $(\\Delta x, N_J, \\gamma_{\\mathrm{eff}}, M_{\\mathrm{BH}}, v)$:\n1. Define constants and convert all inputs to a consistent CGS unit system.\n2. Create a logarithmically spaced grid of $N_{\\mathrm{dens}}$ number densities $n_{\\mathrm{H},i}$ from $n_{\\mathrm{H},\\min}$ to $n_{\\mathrm{H},\\max}$, and convert to a mass density grid $\\rho_i$.\n3. Determine the reference density $\\rho_{\\mathrm{ref}}$ by comparing $\\gamma_{\\mathrm{eff}}$ to $2$. If $\\gamma_{\\mathrm{eff}}  2$, $\\rho_{\\mathrm{ref}} = \\rho_{\\max}$; otherwise, $\\rho_{\\mathrm{ref}} = \\rho_{\\min}$.\n4. Calculate the coefficient $K$ using $\\rho_{\\mathrm{ref}}$ and the test case parameters.\n5. Calculate $c_{s,\\mathrm{eff}}^2(\\rho_i)$ for each density on the grid.\n6. Verify the fragmentation condition: check if $\\sqrt{\\pi c_{s,\\mathrm{eff}}^2(\\rho_i) / (G \\rho_i)} \\ge N_J \\Delta x$ for all $i$.\n7. Calculate the baseline sound speed squared, $c_{s,0}^2$.\n8. Calculate $c_{s,\\mathrm{use}}^2(\\rho_i) = \\max(c_{s,0}^2, c_{s,\\mathrm{eff}}^2(\\rho_i))$ for all $i$.\n9. Calculate $\\mathcal{R}(\\rho_i)$ for all $i$.\n10. Compute the mass-weighted average $\\overline{\\mathcal{R}}$.\n11. Verify the non-biasing condition: check if $|\\overline{\\mathcal{R}} - 1| \\le \\tau$.\n12. The final result for the test case is the logical AND of the fragmentation prevention and non-biasing boolean outcomes.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem of evaluating a sub-grid pressure floor for AGN simulations.\n    This function sets up constants and test cases, then iterates through them,\n    calling a helper function to evaluate each case. Finally, it prints the\n    results in the specified format.\n    \"\"\"\n\n    # --- Constants in CGS units ---\n    G_CGS = 6.67430e-8    # cm^3 g^-1 s^-2\n    KB_CGS = 1.380649e-16   # erg K^-1 (g cm^2 s^-2 K^-1)\n    MP_CGS = 1.6726219e-24  # g\n    M_SUN_CGS = 1.98847e33    # g\n    PC_CGS = 3.08567758e18  # cm\n    KMS_TO_CMS = 1e5        # Factor to convert km/s to cm/s\n\n    # --- Fixed problem parameters ---\n    MU = 0.62               # Mean molecular weight\n    GAMMA_AD = 5.0 / 3.0    # Adiabatic index\n    T0 = 1e4                # K, Baseline gas temperature\n    N_DENS = 64             # Number of density samples\n    N_H_MIN = 1e2           # cm^-3, Min number density\n    N_H_MAX = 1e5           # cm^-3, Max number density\n    TAU = 0.25              # Tolerance for accretion bias\n\n    # --- Test suite of parameter sets ---\n    # (delta_x_pc, N_J, gamma_eff, M_BH_Msun, v_kms)\n    test_cases = [\n        (5.0, 4, 4.0/3.0, 1e8, 50.0),   # Case A\n        (20.0, 4, 1.0, 1e8, 10.0),    # Case B\n        (5.0, 4, 2.0, 1e8, 10.0),     # Case C\n        (5.0, 4, 2.0, 1e8, 300.0),    # Case D\n        (0.5, 4, 4.0/3.0, 1e8, 10.0),   # Case E\n    ]\n    \n    # --- Density grid setup ---\n    # Create a logarithmically spaced grid of number densities\n    n_h_grid = np.geomspace(N_H_MIN, N_H_MAX, N_DENS)\n    # Convert to mass density grid\n    rho_grid = MU * MP_CGS * n_h_grid\n    rho_min = rho_grid[0]\n    rho_max = rho_grid[-1]\n\n    # --- Baseline sound speed ---\n    cs0_sq = (GAMMA_AD * KB_CGS * T0) / (MU * MP_CGS)\n\n    results = []\n    for case in test_cases:\n        delta_x_pc, N_J, gamma_eff, M_BH_Msun, v_kms = case\n\n        # --- Unit conversions ---\n        delta_x = delta_x_pc * PC_CGS\n        v = v_kms * KMS_TO_CMS\n        \n        # --- Step 1: Determine K ---\n        # Determine the reference density rho_ref where Jeans length is minimal\n        if gamma_eff  2.0:\n            rho_ref = rho_max\n        else: # gamma_eff = 2.0\n            rho_ref = rho_min\n        \n        # Calculate the pressure floor coefficient K\n        # K = ( (N_J*dx)^2 * G / (pi*gamma_eff) ) * rho_ref^(2-gamma_eff)\n        K_coeff = ((N_J * delta_x)**2 * G_CGS) / (np.pi * gamma_eff)\n        K_coeff *= rho_ref**(2.0 - gamma_eff)\n\n        # --- Step 2: Evaluate fragmentation prevention condition ---\n        # c_s,eff^2 = K * gamma_eff * rho^(gamma_eff-1)\n        cs_eff_sq_grid = K_coeff * gamma_eff * rho_grid**(gamma_eff - 1.0)\n        \n        # lambda_J = sqrt(pi * c_s,eff^2 / (G * rho))\n        lambda_J_sq_grid = (np.pi * cs_eff_sq_grid) / (G_CGS * rho_grid)\n        lambda_J_grid = np.sqrt(lambda_J_sq_grid)\n\n        # Check if Jeans length is resolved at all densities in the grid.\n        # Use a small tolerance for floating point comparisons.\n        prevents_fragmentation = np.all(lambda_J_grid = N_J * delta_x * (1.0 - 1e-9))\n\n        # --- Step 3: Evaluate accretion bias condition ---\n        # c_s,use^2 = max(c_s,0^2, c_s,eff^2)\n        cs_use_sq_grid = np.maximum(cs0_sq, cs_eff_sq_grid)\n\n        # R(rho) = ( (cs0^2 + v^2) / (cs_use^2 + v^2) )^(3/2)\n        numerator = cs0_sq + v**2\n        denominator = cs_use_sq_grid + v**2\n        R_grid = (numerator / denominator)**(1.5)\n\n        # Calculate mass-weighted mean of R\n        # np.average with weights=rho_grid does sum(R*rho)/sum(rho)\n        R_bar = np.average(R_grid, weights=rho_grid)\n\n        # Check if the bias is within tolerance\n        is_non_biasing = np.abs(R_bar - 1.0) = TAU\n\n        # --- Step 4: Final verdict for the case ---\n        # The model is valid if it prevents fragmentation AND is non-biasing.\n        final_verdict = prevents_fragmentation and is_non_biasing\n        results.append(final_verdict)\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(lambda b: str(b).capitalize(), results))}]\")\n\nsolve()\n\n```", "id": "3537584"}]}