{"hands_on_practices": [{"introduction": "At the heart of any explicit chemo-dynamical simulation lies the challenge of numerical stability. This exercise delves into the practical constraints that govern the speed at which a simulation can evolve by deriving the maximum stable timestep. You will explore how this limit is co-determined by the propagation of sound and shock waves (the Courant-Friedrichs-Lewy condition) and the potentially rapid energy losses from physical source terms like radiative cooling, a process that can introduce \"stiff\" numerical challenges and often dominates the computational cost [@problem_id:3505207].", "problem": "Consider a one-dimensional explicit finite-volume solver for compressible gas dynamics with radiative cooling, as commonly employed in chemo-dynamical simulations of galaxies. A uniform mesh of size $\\Delta x$ resolves a region with local bulk velocity $u$, adiabatic sound speed $c_s$, adiabatic index $\\gamma$, total particle number density $n$, gas temperature $T$, and metallicity $Z$. The gas is ideal, with pressure $p = n k_B T$, where $k_B$ is the Boltzmann constant. Radiative cooling is represented as an energy sink term in the internal energy equation with volumetric cooling rate $\\dot{e}_{\\mathrm{cool}} = -n^{2}\\,\\Lambda(T,Z)$, where $\\Lambda(T,Z)$ is the tabulated cooling function that depends on temperature and metallicity; this form is appropriate when the rate can be approximated by $n_e n_H \\Lambda(T,Z)$ with ionization fractions absorbed into $\\Lambda$. The integrator uses a Courant-Friedrichs-Lewy (CFL) safety factor $C_{\\mathrm{CFL}} \\in (0,1)$ for the hyperbolic flux update and a source-term safety factor $\\beta \\in (0,1)$ for the explicit cooling update.\n\nStarting from first principles—namely, the domain-of-dependence requirement for explicit schemes applied to hyperbolic conservation laws, and ideal-gas thermodynamics—derive the maximum stable timestep imposed by wave propagation. Then, derive the explicit cooling-limited timestep implied by the requirement that the fractional change in internal energy per update not exceed the source-term safety factor. Finally, combine these constraints into a single effective maximum stable timestep for the zone.\n\nExpress your final answer as a single closed-form analytic expression for the effective timestep in seconds, in terms of $\\Delta x$, $u$, $c_s$, $n$, $T$, $\\Lambda(T,Z)$, $\\gamma$, $k_B$, $C_{\\mathrm{CFL}}$, and $\\beta$. Do not include units inside your final boxed expression. No numerical rounding is required.", "solution": "The problem statement is evaluated to be scientifically grounded, well-posed, objective, and internally consistent. It poses a standard, non-trivial question in computational astrophysics regarding the stability of numerical schemes for hydrodynamics with source terms. All necessary variables and constraints for the derivation are provided. Therefore, the problem is valid and a solution will be provided.\n\nThe goal is to derive the effective maximum stable timestep, $\\Delta t_{\\mathrm{eff}}$, for a one-dimensional explicit finite-volume solver. This timestep is determined by the most restrictive of two constraints: the Courant-Friedrichs-Lewy (CFL) condition for wave propagation (the hyperbolic part of the equations) and a stability condition for the explicit integration of the radiative cooling source term.\n\nFirst, we derive the timestep limit imposed by wave propagation. The equations of compressible gas dynamics are a system of hyperbolic conservation laws. For a one-dimensional system, the characteristic speeds at which information propagates are $u-c_s$, $u$, and $u+c_s$, where $u$ is the local fluid velocity and $c_s$ is the adiabatic sound speed. An explicit numerical scheme on a discrete grid of cell size $\\Delta x$ is stable only if the numerical domain of dependence of a grid cell contains the physical domain of dependence. This is the CFL condition. It requires that no wave can travel more than one cell width, $\\Delta x$, in a single timestep, $\\Delta t$. The maximum possible signal speed in the grid frame is given by the maximum of the absolute values of the characteristic speeds:\n$$\nv_{\\mathrm{max}} = \\max(|u-c_s|, |u|, |u+c_s|)\n$$\nSince the sound speed $c_s$ is by definition non-negative, this simplifies to:\n$$\nv_{\\mathrm{max}} = |u| + c_s\n$$\nThe CFL condition is therefore $\\Delta t \\le \\frac{\\Delta x}{v_{\\mathrm{max}}}$, which translates to:\n$$\n\\Delta t \\le \\frac{\\Delta x}{|u| + c_s}\n$$\nThe problem specifies a CFL safety factor $C_{\\mathrm{CFL}} \\in (0,1)$, which is a fractional multiplier used to ensure stability in practice. The maximum stable timestep constraint from the hyperbolic flux update, which we denote $\\Delta t_{\\mathrm{CFL}}$, is thus:\n$$\n\\Delta t_{\\mathrm{CFL}} = C_{\\mathrm{CFL}} \\frac{\\Delta x}{|u| + c_s}\n$$\n\nNext, we derive the timestep limit imposed by the explicit treatment of the radiative cooling source term. The problem states that radiative cooling acts as a volumetric energy sink, with a rate given by $\\dot{e}_{\\mathrm{cool}} = -n^2 \\Lambda(T,Z)$, where $n$ is the particle number density and $\\Lambda(T,Z)$ is the cooling function. This term represents the rate of change of the internal energy density, $e_{\\mathrm{int}}$, due to cooling. So, $\\frac{de_{\\mathrm{int}}}{dt}\\Big|_{\\mathrm{cool}} = -n^2 \\Lambda(T,Z)$.\n\nFor an ideal gas with an adiabatic index $\\gamma$, the internal energy density is related to the pressure $p$ by:\n$$\ne_{\\mathrm{int}} = \\frac{p}{\\gamma - 1}\n$$\nUsing the ideal gas law, $p = n k_B T$, where $k_B$ is the Boltzmann constant and $T$ is the temperature, we can express the internal energy density in terms of the given variables:\n$$\ne_{\\mathrm{int}} = \\frac{n k_B T}{\\gamma - 1}\n$$\nThe problem requires that for an explicit update, the fractional change in internal energy over one timestep must not exceed a source-term safety factor $\\beta \\in (0,1)$. For an explicit (forward Euler) update, the change in internal energy density due to cooling over a timestep $\\Delta t$ is $\\Delta e_{\\mathrm{int}} \\approx \\frac{de_{\\mathrm{int}}}{dt}\\Big|_{\\mathrm{cool}} \\Delta t$. The stability constraint is thus:\n$$\n\\frac{|\\Delta e_{\\mathrm{int}}|}{e_{\\mathrm{int}}} \\le \\beta\n$$\nSubstituting the expressions for $\\Delta e_{\\mathrm{int}}$ and $e_{\\mathrm{int}}$:\n$$\n\\frac{|-n^2 \\Lambda(T,Z) \\Delta t|}{ \\frac{n k_B T}{\\gamma - 1} } \\le \\beta\n$$\nSimplifying the expression:\n$$\n\\frac{n^2 \\Lambda(T,Z) \\Delta t (\\gamma - 1)}{n k_B T} \\le \\beta\n$$\n$$\n\\frac{n (\\gamma - 1) \\Lambda(T,Z)}{k_B T} \\Delta t \\le \\beta\n$$\nSolving for $\\Delta t$ gives the maximum stable timestep imposed by the cooling term, which we denote $\\Delta t_{\\mathrm{cool}}$:\n$$\n\\Delta t_{\\mathrm{cool}} = \\frac{\\beta k_B T}{n (\\gamma - 1) \\Lambda(T,Z)}\n$$\n\nFinally, for the overall explicit scheme to be stable, the timestep $\\Delta t$ must satisfy both constraints simultaneously. Therefore, the effective maximum stable timestep, $\\Delta t_{\\mathrm{eff}}$, is the minimum of the two derived timesteps:\n$$\n\\Delta t_{\\mathrm{eff}} = \\min(\\Delta t_{\\mathrm{CFL}}, \\Delta t_{\\mathrm{cool}})\n$$\nSubstituting the expressions for $\\Delta t_{\\mathrm{CFL}}$ and $\\Delta t_{\\mathrm{cool}}$, we obtain the final combined expression for the effective timestep:\n$$\n\\Delta t_{\\mathrm{eff}} = \\min \\left( C_{\\mathrm{CFL}} \\frac{\\Delta x}{|u| + c_s}, \\frac{\\beta k_B T}{n (\\gamma - 1) \\Lambda(T,Z)} \\right)\n$$\nThis single closed-form expression provides the maximum stable timestep for the zone in terms of all specified parameters, as requested.", "answer": "$$\\boxed{\\min \\left( C_{\\mathrm{CFL}} \\frac{\\Delta x}{|u| + c_s}, \\frac{\\beta k_B T}{n (\\gamma - 1) \\Lambda(T,Z)} \\right)}$$", "id": "3505207"}, {"introduction": "While simulations produce metals in discrete star-forming regions, observations often reveal smoothly distributed chemical elements across galaxies, pointing to an efficient mixing mechanism. This practice models the complex physics of interstellar turbulence as an effective diffusion process that homogenizes the chemical makeup of the gas. By connecting microscopic turbulence parameters to a macroscopic smoothing timescale, you will develop a physical intuition for how long it takes for metals to mix across galactic scales, a key process in shaping observable metallicity gradients [@problem_id:3505136].", "problem": "In chemo-dynamical simulations of star-forming galactic discs, the metal mass fraction (metallicity) field $Z(\\boldsymbol{x},t)$ can be treated as a passive scalar advected by the flow and mixed by turbulent eddies in the Interstellar Medium (ISM). Consider a local one-dimensional radial patch in which the large-scale mean flow is negligible and turbulent mixing acts as an effective diffusion with coefficient $D_{\\mathrm{turb}}$. Assume homogeneous, isotropic turbulence so that, in a mixing-length closure, $D_{\\mathrm{turb}}$ can be parameterized in terms of the root-mean-square (RMS) turbulent velocity $\\sigma_{\\mathrm{turb}}$ and the outer (energy-containing) scale $\\ell_{0}$ as $D_{\\mathrm{turb}} = C\\,\\ell_{0}\\,\\sigma_{\\mathrm{turb}}$, where $C$ is a dimensionless constant of order unity.\n\nA star-forming ring has produced an initially sharp radial step in metallicity that is smoothed by turbulent diffusion. Let the characteristic width of the transition be $L$. Starting from the diffusion equation for a passive scalar and the mixing-length estimate above, derive the characteristic e-folding time for the decay of a metallicity gradient across scale $L$ in terms of $D_{\\mathrm{turb}}$ and argue how it scales with $L$. For the purpose of obtaining a single numerical estimate, neglect order-unity geometric constants and set the characteristic timescale to $\\tau_{\\mathrm{char}} \\equiv L^{2}/D_{\\mathrm{turb}}$.\n\nUse the following physically plausible ISM parameters representative of a supernova-driven warm neutral medium:\n- $C = \\frac{1}{3}$,\n- $\\sigma_{\\mathrm{turb}} = 10$ km s$^{-1}$,\n- $\\ell_{0} = 100$ pc,\n- $L = 300$ pc.\n\nAdopt the unit conversions $1$ pc $= 3.085677581 \\times 10^{18}$ cm and $1$ Myr $= 3.15576 \\times 10^{13}$ s. Compute $\\tau_{\\mathrm{char}}$ and express your final answer in Myr, rounded to three significant figures. Your final answer must be a single number.", "solution": "We model the metallicity $Z$ as a passive scalar satisfying the diffusion equation in one dimension,\n$$\n\\frac{\\partial Z}{\\partial t} \\;=\\; D_{\\mathrm{turb}}\\,\\frac{\\partial^{2} Z}{\\partial x^{2}} \\,,\n$$\nwhere $D_{\\mathrm{turb}}$ is the effective turbulent diffusivity. This equation follows from Fick’s law, $\\boldsymbol{J} = -D_{\\mathrm{turb}} \\nabla Z$, and conservation of the scalar, $\\partial Z/\\partial t + \\nabla \\cdot \\boldsymbol{J} = 0$. The eigenmodes of the diffusion operator are Fourier modes $Z \\propto \\exp\\!\\left( \\mathrm{i} k x - D_{\\mathrm{turb}} k^{2} t \\right)$, whose amplitudes decay exponentially with an e-folding time\n$$\n\\tau(k) \\;=\\; \\frac{1}{D_{\\mathrm{turb}}\\,k^{2}} \\,.\n$$\nFor an initially sharp step that is smoothed over a characteristic spatial scale $L$, the dominant large-scale mode controlling the late-time decay has wavenumber $k \\sim 1/L$ up to a geometric constant of order unity (for example, $k \\sim \\pi/L$ for a mode spanning a domain of size $L$). Neglecting order-unity factors, the characteristic smoothing time scales as\n$$\n\\tau_{\\mathrm{char}} \\;\\sim\\; \\frac{L^{2}}{D_{\\mathrm{turb}}} \\,.\n$$\n\nTo relate this to ISM turbulence, we use the mixing-length estimate for homogeneous isotropic turbulence,\n$$\nD_{\\mathrm{turb}} \\;=\\; C\\,\\ell_{0}\\,\\sigma_{\\mathrm{turb}} \\,,\n$$\nwhere $C$ is a dimensionless constant of order unity, $\\ell_{0}$ is the outer scale (correlation length), and $\\sigma_{\\mathrm{turb}}$ is the RMS turbulent velocity. This scaling follows from a random-walk argument: the effective diffusivity is the product of a characteristic step size and step speed.\n\nWe now compute $D_{\\mathrm{turb}}$ numerically using the given values, converting to cgs units:\n- $\\sigma_{\\mathrm{turb}} = 10$ km s$^{-1} = 10^{6}$ cm s$^{-1}$,\n- $\\ell_{0} = 100$ pc $= 100 \\times 3.085677581 \\times 10^{18}$ cm $= 3.085677581 \\times 10^{20}$ cm,\n- $C = \\frac{1}{3}$.\n\nTherefore,\n$$\nD_{\\mathrm{turb}} \\;=\\; \\frac{1}{3}\\,\\left(3.085677581 \\times 10^{20}\\ \\mathrm{cm}\\right)\\,\\left(10^{6}\\ \\mathrm{cm\\ s^{-1}}\\right)\n\\;=\\; \\frac{1}{3}\\,\\left(3.085677581 \\times 10^{26}\\ \\mathrm{cm^{2}\\ s^{-1}}\\right)\n\\;=\\; 1.0285591937 \\times 10^{26}\\ \\mathrm{cm^{2}\\ s^{-1}} \\,.\n$$\n\nNext, convert $L$ to cgs and compute $L^{2}$:\n- $L = 300$ pc $= 300 \\times 3.085677581 \\times 10^{18}$ cm $= 9.257032743 \\times 10^{20}$ cm,\n- $L^{2} = \\left(9.257032743 \\times 10^{20}\\ \\mathrm{cm}\\right)^{2} = 8.568758090 \\times 10^{41}\\ \\mathrm{cm^{2}}$.\n\nThe characteristic time in seconds is then\n$$\n\\tau_{\\mathrm{char}} \\;=\\; \\frac{L^{2}}{D_{\\mathrm{turb}}}\n\\;=\\; \\frac{8.568758090 \\times 10^{41}}{1.0285591937 \\times 10^{26}}\\ \\mathrm{s}\n\\;=\\; 8.33088984 \\times 10^{15}\\ \\mathrm{s} \\,.\n$$\n\nConvert this to Myr using $1$ Myr $= 3.15576 \\times 10^{13}$ s:\n$$\n\\tau_{\\mathrm{char}} \\;=\\; \\frac{8.33088984 \\times 10^{15}\\ \\mathrm{s}}{3.15576 \\times 10^{13}\\ \\mathrm{s\\ Myr^{-1}}}\n\\;=\\; 263.998 \\ \\mathrm{Myr} \\,.\n$$\n\nRounding to three significant figures as required yields\n$$\n\\tau_{\\mathrm{char}} \\;=\\; 264 \\ \\mathrm{Myr} \\,.\n$$\n\nThis result is consistent with ISM turbulence levels: with $\\sigma_{\\mathrm{turb}} \\sim 10$ km s$^{-1}$ and $\\ell_{0} \\sim 100$ pc, the effective diffusivity $D_{\\mathrm{turb}} \\sim 10^{26}$ cm$^{2}$ s$^{-1}$ implies that smoothing a metallicity gradient across a few hundred parsecs occurs on a few $10^{2}$ Myr, comparable to a galactic dynamical time, which is physically plausible for mixing in disc galaxies.", "answer": "$$\\boxed{264}$$", "id": "3505136"}, {"introduction": "Stellar feedback is a cornerstone of modern galaxy formation theory, regulating star formation and driving powerful galactic outflows, yet its implementation remains a primary uncertainty in simulations. This exercise guides you through a comparison of two common feedback prescriptions: an idealized \"energy-conserving\" model and a more realistic \"thermal dump\" model where injected energy can be radiated away. By implementing these schemes, you will directly investigate how feedback efficiency determines a galaxy's ability to retain its gas and metals, a fundamental process in establishing the observed mass-metallicity relation of galaxies [@problem_id:3505175].", "problem": "You are to implement and compare two stellar feedback prescriptions in a simplified chemo-dynamical model of a dwarf galaxy halo, and quantify metal retention and the blowout threshold. The halo is modeled with a spherical overdensity definition, and feedback launches an outflow that may escape depending on its velocity relative to the halo escape speed. Your program must be a complete, runnable program that computes, for each provided test case, the metal retention fraction for an energy-conserving feedback scheme versus a thermal dump scheme, and the blowout thresholds. All calculations must adhere to physically consistent units, and every intermediate physical quantity must be treated with explicit unit conversions. All outputs must be unit-consistent as specified.\n\nFundamental base and definitions to use:\n\n- Assume a spherical halo with mass $M_{\\mathrm{halo}}$ at redshift $z = 0$. The virial radius $R_{\\mathrm{vir}}$ is defined by the spherical overdensity condition with overdensity $\\Delta_{c}$ relative to the critical density $\\rho_{c}$. Use the critical density $\\rho_{c} = \\dfrac{3 H_{0}^{2}}{8 \\pi G}$, where $H_{0}$ is the Hubble constant and $G$ is the gravitational constant. The virial radius is $R_{\\mathrm{vir}} = \\left(\\dfrac{3 M_{\\mathrm{halo}}}{4 \\pi \\Delta_{c} \\rho_{c}}\\right)^{1/3}$. The halo escape speed at $R_{\\mathrm{vir}}$ is $v_{\\mathrm{esc}} = \\sqrt{\\dfrac{2 G M_{\\mathrm{halo}}}{R_{\\mathrm{vir}}}}$.\n- The baryon mass is $M_{\\mathrm{gas}} = f_{b} M_{\\mathrm{halo}}$, with baryon fraction $f_{b}$.\n- A star formation event forms stellar mass $M_{*}$. The number of supernovae per unit stellar mass is $\\eta_{\\mathrm{SN}}$ (supernova, SN). The energy per supernova is $E_{\\mathrm{SN}}$. A fraction $\\epsilon_{E}$ of the total supernova energy couples as feedback energy $E_{\\mathrm{fb}}$.\n- The energy-conserving feedback scheme instantaneously converts the coupled energy into outflow kinetic energy. The mass loading factor is $\\eta_{w}$ such that $M_{\\mathrm{out}} = \\eta_{w} M_{*}$. The wind speed $v_{w}$ satisfies energy conservation, and blowout occurs when $v_{w} \\ge v_{\\mathrm{esc}}$.\n- The thermal dump feedback injects the same coupled energy thermally into the gas. Radiative cooling reduces this energy. The remaining effective energy is modeled as $E_{\\mathrm{eff}} = E_{\\mathrm{fb}} \\exp\\!\\left(-\\dfrac{t_{\\mathrm{adv}}}{t_{\\mathrm{cool}}}\\right)$, where $t_{\\mathrm{adv}}$ is a fixed advection time scale, and $t_{\\mathrm{cool}}$ is the radiative cooling time computed from the local gas conditions. The thermal energy per unit mass after injection is $e_{\\mathrm{th}} = \\dfrac{E_{\\mathrm{fb}}}{M_{\\mathrm{out}}}$, and the post-injection temperature is $T = \\dfrac{2 \\mu m_{p}}{3 k_{B}} e_{\\mathrm{th}}$, with mean molecular weight $\\mu$, proton mass $m_{p}$, and Boltzmann constant $k_{B}$. Assume fully ionized gas with number density $n = \\dfrac{\\rho}{\\mu m_{p}}$, where $\\rho$ is the mass density inside the star-forming region of radius $r_{\\mathrm{sf}}$, treating the star-forming region volume as $V_{\\mathrm{sf}} = \\dfrac{4}{3} \\pi r_{\\mathrm{sf}}^{3}$ and $\\rho = \\dfrac{M_{\\mathrm{gas}}}{V_{\\mathrm{sf}}}$. The cooling function is approximated as $\\Lambda(T,Z) = \\Lambda_{0} Z \\left(\\dfrac{T}{10^{6}\\,\\mathrm{K}}\\right)^{1/2}$, and the cooling time is $t_{\\mathrm{cool}} = \\dfrac{\\tfrac{3}{2} n k_{B} T}{n^{2}\\Lambda(T,Z)} = \\dfrac{\\tfrac{3}{2} k_{B} T}{n \\Lambda(T,Z)}$. Here $Z$ is the gas metallicity by mass fraction after yield addition, and $\\Lambda_{0}$ is a constant.\n- The metal yield adds new metals $M_{Z,\\mathrm{new}} = y M_{*}$ into the gas. The initial metallicity is $Z_{0}$, so the post-yield metallicity is $Z_{1} = \\dfrac{Z_{0} M_{\\mathrm{gas}} + M_{Z,\\mathrm{new}}}{M_{\\mathrm{gas}}}$. The wind is metal-loaded relative to the interstellar medium (ISM) by a factor $\\xi$, such that its metal mass fraction is $Z_{w} = \\min\\!\\left(1,\\xi Z_{1}\\right)$. The total metal mass after yield is $M_{Z,\\mathrm{tot}} = Z_{1} M_{\\mathrm{gas}}$, and the metal mass carried by the outflow is $M_{Z,\\mathrm{out}} = \\min\\!\\left(Z_{w} M_{\\mathrm{out}}, M_{Z,\\mathrm{tot}}\\right)$. If blowout occurs (escape), those metals are lost from the halo; otherwise, they are retained. The metal retention fraction is $f_{Z,\\mathrm{ret}} = \\dfrac{M_{Z,\\mathrm{ret}}}{M_{Z,\\mathrm{tot}}}$, where $M_{Z,\\mathrm{ret}} = M_{Z,\\mathrm{tot}} - M_{Z,\\mathrm{out}}$ if blowout occurs and $M_{Z,\\mathrm{ret}} = M_{Z,\\mathrm{tot}}$ otherwise.\n\nRequired thresholds to compute:\n\n- For energy-conserving feedback, compute the minimal coupling efficiency $\\epsilon_{E,\\mathrm{th}}$ such that $v_{w} = v_{\\mathrm{esc}}$ under the above assumptions.\n- For thermal dump, compute the critical advection time $t_{\\mathrm{adv,crit}}$ such that $v_{w} = v_{\\mathrm{esc}}$ when $E_{\\mathrm{eff}} = \\dfrac{1}{2} M_{\\mathrm{out}} v_{\\mathrm{esc}}^{2}$ and $E_{\\mathrm{eff}} = E_{\\mathrm{fb}} \\exp\\!\\left(-\\dfrac{t_{\\mathrm{adv}}}{t_{\\mathrm{cool}}}\\right)$. Express $t_{\\mathrm{adv,crit}}$ in megayears (Myr). If the required ratio $\\dfrac{\\tfrac{1}{2} M_{\\mathrm{out}} v_{\\mathrm{esc}}^{2}}{E_{\\mathrm{fb}}}$ exceeds $1$, report $t_{\\mathrm{adv,crit}}$ as a negative value to indicate that blowout is impossible even without cooling.\n\nUnits and constants:\n\n- Use $G = 6.67430\\times 10^{-11}\\,\\mathrm{m^{3}\\,kg^{-1}\\,s^{-2}}$, $H_{0} = 70\\,\\mathrm{km\\,s^{-1}\\,Mpc^{-1}}$, $f_{b} = 0.16$, $\\Delta_{c} = 200$, $m_{p} = 1.67262\\times 10^{-27}\\,\\mathrm{kg}$, $k_{B} = 1.380649\\times 10^{-23}\\,\\mathrm{J\\,K^{-1}}$, $\\mu = 0.6$ (dimensionless), Solar mass $M_{\\odot} = 1.98847\\times 10^{30}\\,\\mathrm{kg}$, $1\\,\\mathrm{erg} = 10^{-7}\\,\\mathrm{J}$, $1\\,\\mathrm{kpc} = 3.085677581\\times 10^{19}\\,\\mathrm{m}$, $1\\,\\mathrm{Myr} = 3.15576\\times 10^{13}\\,\\mathrm{s}$. Use $E_{\\mathrm{SN}} = 10^{51}\\,\\mathrm{erg}$. Use $\\Lambda_{0} = 2\\times 10^{-23}\\,\\mathrm{erg\\,cm^{3}\\,s^{-1}}$ converted to International System of Units (SI) as $\\Lambda_{0,\\mathrm{SI}} = 2\\times 10^{-36}\\,\\mathrm{J\\,m^{3}\\,s^{-1}}$.\n- All outputs that involve physical time must be expressed in megayears (Myr). Metallicity and retention are dimensionless fractions. Booleans must be produced as literal boolean values.\n\nTest suite:\n\nYour program must evaluate the following four test cases. For each case, use the same global constants given above, and the star-forming region radius $r_{\\mathrm{sf}}$ and other astrophysical parameters as specified. All masses appearing in parameters are in Solar masses $M_{\\odot}$, lengths in kiloparsecs (kpc), and times in megayears (Myr), but your internal calculations must convert to SI units.\n\n- Case $1$ (general case):\n    - $M_{\\mathrm{halo}} = 10^{9}\\,M_{\\odot}$, $M_{*} = 10^{6}\\,M_{\\odot}$, $\\epsilon_{E} = 0.1$, $\\eta_{w} = 5$, $Z_{0} = 0.001$, $y = 0.02$, $\\eta_{\\mathrm{SN}} = 0.01\\,\\mathrm{SN}\\,M_{\\odot}^{-1}$, $E_{\\mathrm{SN}} = 10^{51}\\,\\mathrm{erg}$, $\\xi = 3$, $r_{\\mathrm{sf}} = 0.5\\,\\mathrm{kpc}$, $t_{\\mathrm{adv}} = 30\\,\\mathrm{Myr}$.\n- Case $2$ (near energy blowout threshold):\n    - $M_{\\mathrm{halo}} = 10^{9}\\,M_{\\odot}$, $M_{*} = 5\\times 10^{5}\\,M_{\\odot}$, $\\epsilon_{E} = 9.65\\times 10^{-3}$, $\\eta_{w} = 5$, $Z_{0} = 0.001$, $y = 0.02$, $\\eta_{\\mathrm{SN}} = 0.01\\,\\mathrm{SN}\\,M_{\\odot}^{-1}$, $E_{\\mathrm{SN}} = 10^{51}\\,\\mathrm{erg}$, $\\xi = 3$, $r_{\\mathrm{sf}} = 0.5\\,\\mathrm{kpc}$, $t_{\\mathrm{adv}} = 30\\,\\mathrm{Myr}$.\n- Case $3$ (high mass loading edge):\n    - $M_{\\mathrm{halo}} = 10^{9}\\,M_{\\odot}$, $M_{*} = 10^{6}\\,M_{\\odot}$, $\\epsilon_{E} = 0.05$, $\\eta_{w} = 20$, $Z_{0} = 0.001$, $y = 0.02$, $\\eta_{\\mathrm{SN}} = 0.01\\,\\mathrm{SN}\\,M_{\\odot}^{-1}$, $E_{\\mathrm{SN}} = 10^{51}\\,\\mathrm{erg}$, $\\xi = 3$, $r_{\\mathrm{sf}} = 0.5\\,\\mathrm{kpc}$, $t_{\\mathrm{adv}} = 30\\,\\mathrm{Myr}$.\n- Case $4$ (lower mass halo, shorter advection):\n    - $M_{\\mathrm{halo}} = 5\\times 10^{8}\\,M_{\\odot}$, $M_{*} = 3\\times 10^{5}\\,M_{\\odot}$, $\\epsilon_{E} = 0.05$, $\\eta_{w} = 5$, $Z_{0} = 5\\times 10^{-4}$, $y = 0.02$, $\\eta_{\\mathrm{SN}} = 0.01\\,\\mathrm{SN}\\,M_{\\odot}^{-1}$, $E_{\\mathrm{SN}} = 10^{51}\\,\\mathrm{erg}$, $\\xi = 3$, $r_{\\mathrm{sf}} = 0.5\\,\\mathrm{kpc}$, $t_{\\mathrm{adv}} = 10\\,\\mathrm{Myr}$.\n\nRequired outputs per test case:\n\n- Compute and output, in the following order, as a list for each case:\n    1. $f_{Z,\\mathrm{ret}}$ for energy-conserving feedback (dimensionless decimal).\n    2. $f_{Z,\\mathrm{ret}}$ for thermal dump feedback (dimensionless decimal).\n    3. A boolean indicating blowout under energy-conserving feedback.\n    4. A boolean indicating blowout under thermal dump feedback.\n    5. The energy-conserving blowout coupling threshold $\\epsilon_{E,\\mathrm{th}}$ (dimensionless decimal).\n    6. The thermal dump critical advection time $t_{\\mathrm{adv,crit}}$ in $\\mathrm{Myr}$ (float; negative if blowout is impossible even without cooling).\n\nFinal output format:\n\nYour program should produce a single line of output containing the results as a comma-separated list of the four case results, each case result itself being a list in the order specified above, with the entire output enclosed in square brackets. For example, an output with $N$ cases should look like: $[[\\ldots],[\\ldots],[\\ldots],[\\ldots]]$. No additional text should be printed.", "solution": "The user-provided problem is a well-posed and scientifically grounded exercise in computational astrophysics, requiring the implementation of a simplified chemo-dynamical model for a dwarf galaxy. The problem is valid as it is self-contained, with all necessary physical formulae, constants, and parameters provided to compute the required quantities. The model, while simplified, is based on established principles of galaxy formation theory, including halo structure, stellar feedback, and chemical enrichment.\n\nThe solution is implemented as a Python program that systematically processes each test case. The core of the solution is a function that executes the physical model for a given set of parameters. All calculations are performed in the International System of Units (SI) to ensure physical consistency.\n\nThe algorithmic and physical steps are as follows:\n\n1.  **Initialization and Unit Conversion**: All physical constants ($G$, $H_0$, $m_p$, etc.) are defined in their SI base units. Input parameters for each test case, given in common astrophysical units (e.g., $M_{\\odot}$ for mass, kpc for distance), are converted to SI units at the outset. For example, the Hubble constant $H_0 = 70\\,\\mathrm{km\\,s^{-1}\\,Mpc^{-1}}$ is converted to $\\mathrm{s}^{-1}$.\n\n2.  **Halo Properties**: The model begins by characterizing the dark matter halo. The critical density of the universe at redshift $z=0$ is computed using the Hubble constant $H_0$ and the gravitational constant $G$:\n    $$ \\rho_{c} = \\frac{3 H_{0}^{2}}{8 \\pi G} $$\n    With the halo mass $M_{\\mathrm{halo}}$ and the overdensity parameter $\\Delta_c = 200$, the virial radius $R_{\\mathrm{vir}}$ is determined:\n    $$ R_{\\mathrm{vir}} = \\left(\\frac{3 M_{\\mathrm{halo}}}{4 \\pi \\Delta_{c} \\rho_{c}}\\right)^{1/3} $$\n    The escape velocity at this radius, which sets the condition for material to be ejected from the halo (blowout), is then:\n    $$ v_{\\mathrm{esc}} = \\sqrt{\\frac{2 G M_{\\mathrm{halo}}}{R_{\\mathrm{vir}}}} $$\n\n3.  **Baryonic and Feedback Components**: The total baryonic mass is assumed to be a fixed fraction $f_b$ of the halo mass, $M_{\\mathrm{gas}} = f_b M_{\\mathrm{halo}}$. A star formation event produces a stellar mass $M_*$. The total energy released by supernovae is $E_{\\mathrm{SN,tot}} = \\eta_{\\mathrm{SN}} M_* E_{\\mathrm{SN}}$, where $\\eta_{\\mathrm{SN}}$ is the number of supernovae per unit stellar mass and $E_{\\mathrm{SN}}$ is the energy per supernova. A fraction $\\epsilon_E$ of this energy is coupled to the interstellar medium as feedback energy, $E_{\\mathrm{fb}} = \\epsilon_E E_{\\mathrm{SN,tot}}$. The feedback drives an outflow of mass $M_{\\mathrm{out}} = \\eta_w M_*$, where $\\eta_w$ is the mass loading factor.\n\n4.  **Chemical Evolution**: The star formation event enriches the gas with metals. The newly synthesized metal mass is $M_{Z,\\mathrm{new}} = y M_*$, where $y$ is the stellar yield. The gas metallicity (mass fraction) increases from its initial value $Z_0$ to a post-yield value $Z_1$:\n    $$ Z_1 = \\frac{Z_0 M_{\\mathrm{gas}} + M_{Z,\\mathrm{new}}}{M_{\\mathrm{gas}}} $$\n    The total metal mass available in the galaxy is $M_{Z,\\mathrm{tot}} = Z_1 M_{\\mathrm{gas}}$. The outflow is assumed to have a metallicity $Z_w = \\min(1, \\xi Z_1)$, potentially enhanced over the ambient medium by a factor $\\xi$. The mass of metals ejected in the outflow is $M_{Z,\\mathrm{out}} = \\min(Z_w M_{\\mathrm{out}}, M_{Z,\\mathrm{tot}})$. This prevents unphysical removal of more metals than exist.\n\n5.  **Energy-Conserving Feedback Model**: In this scheme, the feedback energy $E_{\\mathrm{fb}}$ is instantaneously converted into the kinetic energy of the outflow:\n    $$ \\frac{1}{2} M_{\\mathrm{out}} v_{w,\\mathrm{EC}}^2 = E_{\\mathrm{fb}} \\quad \\implies \\quad v_{w,\\mathrm{EC}} = \\sqrt{\\frac{2 E_{\\mathrm{fb}}}{M_{\\mathrm{out}}}} $$\n    Blowout occurs if $v_{w,\\mathrm{EC}} \\ge v_{\\mathrm{esc}}$. If blowout occurs, the ejected metals $M_{Z,\\mathrm{out}}$ are permanently lost. The metal retention fraction $f_{Z,\\mathrm{ret}}$ is the ratio of the retained metal mass to the total initial metal mass.\n\n6.  **Thermal Dump Feedback Model**: This model considers radiative cooling. The energy $E_{\\mathrm{fb}}$ is first injected as thermal energy into the outflow mass $M_{\\mathrm{out}}$, resulting in a specific thermal energy $e_{\\mathrm{th}} = E_{\\mathrm{fb}} / M_{\\mathrm{out}}$. This raises the gas temperature to $T$:\n    $$ T = \\frac{2 \\mu m_p}{3 k_B} e_{\\mathrm{th}} $$\n    The gas cools over time. The cooling time, $t_{\\mathrm{cool}}$, depends on the gas density $n$ and the cooling function $\\Lambda(T, Z_1)$. The gas is assumed to be confined to a star-forming region of radius $r_{\\mathrm{sf}}$, giving density $\\rho = M_{\\mathrm{gas}} / (\\frac{4}{3}\\pi r_{\\mathrm{sf}}^3)$ and number density $n = \\rho / (\\mu m_p)$. The cooling time is:\n    $$ t_{\\mathrm{cool}} = \\frac{\\frac{3}{2} k_B T}{n \\Lambda(T, Z_1)}, \\quad \\text{with} \\quad \\Lambda(T, Z_1) = \\Lambda_0 Z_1 \\left(\\frac{T}{10^6\\,\\mathrm{K}}\\right)^{1/2} $$\n    After a fixed advection timescale $t_{\\mathrm{adv}}$, the remaining effective energy available to drive the outflow is $E_{\\mathrm{eff}} = E_{\\mathrm{fb}} \\exp(-t_{\\mathrm{adv}} / t_{\\mathrm{cool}})$. This leads to a wind speed $v_{w,\\mathrm{TD}} = \\sqrt{2 E_{\\mathrm{eff}} / M_{\\mathrm{out}}}$. Blowout and metal retention are then assessed as in the energy-conserving case.\n\n7.  **Threshold Calculations**:\n    -   For the energy-conserving model, the blowout threshold coupling efficiency, $\\epsilon_{E,\\mathrm{th}}$, is the minimum efficiency required for the outflow to reach escape velocity. This is found by setting $v_{w,\\mathrm{EC}} = v_{\\mathrm{esc}}$ and solving for $\\epsilon_E$:\n        $$ \\frac{1}{2} M_{\\mathrm{out}} v_{\\mathrm{esc}}^2 = \\epsilon_{E,\\mathrm{th}} E_{\\mathrm{SN,tot}} \\quad \\implies \\quad \\epsilon_{E,\\mathrm{th}} = \\frac{M_{\\mathrm{out}} v_{\\mathrm{esc}}^2}{2 E_{\\mathrm{SN,tot}}} $$\n    -   For the thermal dump model, the critical advection time, $t_{\\mathrm{adv,crit}}$, is the time over which cooling can operate before the effective energy drops below the level required for blowout. We set the final kinetic energy to the critical value $\\frac{1}{2} M_{\\mathrm{out}} v_{\\mathrm{esc}}^2$ and solve for $t_{\\mathrm{adv}}$:\n        $$ \\frac{1}{2} M_{\\mathrm{out}} v_{\\mathrm{esc}}^2 = E_{\\mathrm{fb}} \\exp(-t_{\\mathrm{adv,crit}} / t_{\\mathrm{cool}}) \\quad \\implies \\quad t_{\\mathrm{adv,crit}} = -t_{\\mathrm{cool}} \\ln\\left(\\frac{\\frac{1}{2} M_{\\mathrm{out}} v_{\\mathrm{esc}}^2}{E_{\\mathrm{fb}}}\\right) $$\n        If the required kinetic energy exceeds the initially coupled feedback energy ($E_{\\mathrm{fb}}$), blowout is impossible even with no cooling. In this case, the argument of the logarithm is greater than $1$, yielding a negative $t_{\\mathrm{adv,crit}}$, which serves as the required flag.\n\nThe final program iterates through each test case, applies these calculations, and formats the six required output values into a single list. These lists are then combined into a final list-of-lists structure for output.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes and compares two stellar feedback prescriptions in a simplified \n    chemo-dynamical model of a dwarf galaxy halo.\n    \"\"\"\n    # Define physical and astronomical constants in SI units\n    CONST = {\n        'G': 6.67430e-11,          # Gravitational constant in m^3 kg^-1 s^-2\n        'Mpc_to_m': 3.085677581e22, # Meters per Megaparsec\n        'kpc_to_m': 3.085677581e19, # Meters per kiloparsec\n        'Msol_to_kg': 1.98847e30,   # Kilograms per Solar mass\n        'erg_to_J': 1e-7,          # Joules per erg\n        'Myr_to_s': 3.15576e13,      # Seconds per Megayear\n        'm_p': 1.67262e-27,        # Proton mass in kg\n        'k_B': 1.380649e-23,       # Boltzmann constant in J K^-1\n        'mu': 0.6,                 # Mean molecular weight (dimensionless)\n        'f_b': 0.16,               # Baryon fraction (dimensionless)\n        'Delta_c': 200.0,          # Overdensity parameter (dimensionless)\n        'Lambda0_SI': 2e-36,       # Cooling function constant in J m^3 s^-1\n    }\n    # Derived constant: Hubble constant in s^-1\n    CONST['H0'] = 70 * 1000 / CONST['Mpc_to_m']\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {'name': 'Case 1', 'M_halo': 1e9, 'M_star': 1e6, 'eps_E': 0.1, 'eta_w': 5, 'Z0': 0.001, \n         'y': 0.02, 'eta_SN': 0.01, 'E_SN': 1e51, 'xi': 3, 'r_sf': 0.5, 't_adv': 30},\n        {'name': 'Case 2', 'M_halo': 1e9, 'M_star': 5e5, 'eps_E': 9.65e-3, 'eta_w': 5, 'Z0': 0.001, \n         'y': 0.02, 'eta_SN': 0.01, 'E_SN': 1e51, 'xi': 3, 'r_sf': 0.5, 't_adv': 30},\n        {'name': 'Case 3', 'M_halo': 1e9, 'M_star': 1e6, 'eps_E': 0.05, 'eta_w': 20, 'Z0': 0.001, \n         'y': 0.02, 'eta_SN': 0.01, 'E_SN': 1e51, 'xi': 3, 'r_sf': 0.5, 't_adv': 30},\n        {'name': 'Case 4', 'M_halo': 5e8, 'M_star': 3e5, 'eps_E': 0.05, 'eta_w': 5, 'Z0': 5e-4, \n         'y': 0.02, 'eta_SN': 0.01, 'E_SN': 1e51, 'xi': 3, 'r_sf': 0.5, 't_adv': 10},\n    ]\n\n    final_results_str = []\n    for params in test_cases:\n        # Convert input parameters to SI units\n        M_halo_si = params['M_halo'] * CONST['Msol_to_kg']\n        M_star_si = params['M_star'] * CONST['Msol_to_kg']\n        eta_SN_si = params['eta_SN'] / CONST['Msol_to_kg']\n        E_SN_si = params['E_SN'] * CONST['erg_to_J']\n        r_sf_si = params['r_sf'] * CONST['kpc_to_m']\n        t_adv_si = params['t_adv'] * CONST['Myr_to_s']\n\n        # Step 1: Calculate Halo Properties\n        rho_c = (3 * CONST['H0']**2) / (8 * np.pi * CONST['G'])\n        R_vir = ((3 * M_halo_si) / (4 * np.pi * CONST['Delta_c'] * rho_c))**(1/3)\n        v_esc = np.sqrt((2 * CONST['G'] * M_halo_si) / R_vir)\n        \n        # Step 2: Calculate Gas, Outflow, and Feedback Energy\n        M_gas_si = CONST['f_b'] * M_halo_si\n        M_out_si = params['eta_w'] * M_star_si\n        E_fb_total_sn = eta_SN_si * M_star_si * E_SN_si\n        E_fb = params['eps_E'] * E_fb_total_sn\n\n        # Step 3: Calculate Chemical Evolution\n        M_Z_new = params['y'] * M_star_si\n        Z1 = (params['Z0'] * M_gas_si + M_Z_new) / M_gas_si\n        M_Z_tot = Z1 * M_gas_si\n        Z_w = min(1.0, params['xi'] * Z1)\n        M_Z_out = min(Z_w * M_out_si, M_Z_tot)\n\n        # Step 4: Energy-Conserving Feedback Model\n        v_w_ec = np.sqrt((2 * E_fb) / M_out_si) if M_out_si > 0 else 0\n        blowout_ec = v_w_ec >= v_esc\n        \n        M_Z_ret_ec = M_Z_tot - M_Z_out if blowout_ec else M_Z_tot\n        f_Z_ret_ec = M_Z_ret_ec / M_Z_tot if M_Z_tot > 0 else 1.0\n        \n        # Step 5: Thermal Dump Feedback Model\n        V_sf = (4/3) * np.pi * r_sf_si**3\n        rho_gas_sf = M_gas_si / V_sf\n        n_gas_sf = rho_gas_sf / (CONST['mu'] * CONST['m_p'])\n        e_th = E_fb / M_out_si if M_out_si > 0 else 0\n        T_post_inj = (2 * CONST['mu'] * CONST['m_p'] / (3 * CONST['k_B'])) * e_th\n\n        Lambda_T_Z = CONST['Lambda0_SI'] * Z1 * np.sqrt(T_post_inj / 1e6)\n        if n_gas_sf > 0 and Lambda_T_Z > 0:\n            t_cool = (1.5 * CONST['k_B'] * T_post_inj) / (n_gas_sf * Lambda_T_Z)\n        else:\n            t_cool = np.inf\n\n        E_eff = E_fb * np.exp(-t_adv_si / t_cool) if t_cool > 0 else 0\n        v_w_td = np.sqrt((2 * E_eff) / M_out_si) if M_out_si > 0 else 0\n        blowout_td = v_w_td >= v_esc\n        \n        M_Z_ret_td = M_Z_tot - M_Z_out if blowout_td else M_Z_tot\n        f_Z_ret_td = M_Z_ret_td / M_Z_tot if M_Z_tot > 0 else 1.0\n\n        # Step 6: Threshold Calculations\n        E_kin_crit = 0.5 * M_out_si * v_esc**2\n        eps_E_th = E_kin_crit / E_fb_total_sn if E_fb_total_sn > 0 else np.inf\n\n        ratio = E_kin_crit / E_fb if E_fb > 0 else np.inf\n        if ratio > 1.0 :\n            t_adv_crit_si = -t_cool * np.log(ratio)\n        elif t_cool == np.inf or ratio = 0:\n            t_adv_crit_si = np.inf # Effectively means blowout requires no cooling or is impossible\n        else:\n            t_adv_crit_si = -t_cool * np.log(ratio)\n        \n        t_adv_crit_myr = t_adv_crit_si / CONST['Myr_to_s']\n\n        # Collect and format results for the current case\n        case_results = [\n            f_Z_ret_ec, f_Z_ret_td, blowout_ec, blowout_td, eps_E_th, t_adv_crit_myr\n        ]\n        # Required format is a list of strings without white-space inside the inner lists.\n        final_results_str.append(f\"[{','.join(str(v) for v in case_results)}]\")\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(final_results_str)}]\")\n\nsolve()\n\n```", "id": "3505175"}]}