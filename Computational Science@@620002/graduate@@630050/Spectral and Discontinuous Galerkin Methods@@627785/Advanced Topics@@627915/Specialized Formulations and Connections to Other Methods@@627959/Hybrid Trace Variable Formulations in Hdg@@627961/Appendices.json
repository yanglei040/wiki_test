{"hands_on_practices": [{"introduction": "This first practice serves as a fundamental introduction to the mechanics of the HDG method. By solving a simple one-dimensional diffusion problem on just two elements [@problem_id:3390545], you will manually perform the key steps of static condensation. This exercise is designed to build concrete intuition for how local element-wise problems are formulated in terms of the hybrid trace variable and how these local systems are assembled into a global, condensed system for the trace unknowns alone.", "problem": "Consider the steady one-dimensional diffusion equation on the interval $[0,1]$ with constant diffusivity $\\kappa0$ and zero volumetric source, written in mixed first-order form: find $u:(0,1)\\to\\mathbb{R}$ and $q:(0,1)\\to\\mathbb{R}$ such that\n$$\nq \\;=\\; -\\,\\kappa\\,\\frac{du}{dx}, \n\\qquad \n\\frac{dq}{dx} \\;=\\; 0 \\quad \\text{in } (0,1),\n$$\nsubject to mixed Dirichlet–Neumann boundary conditions\n$$\nu(0) \\;=\\; U_{D}, \n\\qquad \nq(1) \\;=\\; g_{N},\n$$\nwhere $U_{D}\\in\\mathbb{R}$ and $g_{N}\\in\\mathbb{R}$ are prescribed data, and the outward normal at $x=1$ is $+1$.\n\nPartition the domain into two elements $K_{1}=[0,h_{1}]$ and $K_{2}=[h_{1},1]$ with $0h_{1}1$, and apply the Hybridizable Discontinuous Galerkin (HDG) method with piecewise constant local approximation spaces, that is, take on each element $K$ the spaces $W_{h}(K)=\\mathbb{P}_{0}(K)$ for $u_{h}$ and $V_{h}(K)=\\mathbb{P}_{0}(K)$ for $q_{h}$, and take the trace space on each face $F$ to be $M_{h}(F)=\\mathbb{P}_{0}(F)$ for the hybrid trace $\\widehat{u}_{h}$. Use a constant stabilization parameter $\\tau0$ on all faces, and define the numerical flux on any non-Neumann face by\n$$\n\\widehat{q}_{h}\\,n \\;=\\; q_{h}\\,n + \\tau\\,(u_{h}-\\widehat{u}_{h}),\n$$\nwhile on the Neumann boundary face at $x=1$ impose $\\widehat{q}_{h}\\,n = g_{N}$. On the Dirichlet boundary face at $x=0$, impose $\\widehat{u}_{h}=U_{D}$.\n\nStarting from the mixed first-order form above and standard elementwise integration by parts, derive the local HDG equations on each element and the single global conservativity equation on the interior face at $x=h_{1}$. By statically condensing the elementwise unknowns and any boundary-face traces that are not globally coupled, reduce the system to a single equation for the interior-face trace value $\\widehat{u}_{h}(h_{1})$. Solve this reduced equation and provide the explicit closed-form expression for $\\widehat{u}_{h}(h_{1})$ as a function of the parameters $\\kappa$, $\\tau$, $h_{1}$, $U_{D}$, and $g_{N}$.\n\nExpress your final answer as a single analytical expression. No rounding is required.", "solution": "The user-provided problem is validated as self-contained, scientifically grounded, well-posed, and objective. It is a standard exercise in applying the Hybridizable Discontinuous Galerkin (HDG) method to a one-dimensional boundary value problem. We proceed with the solution.\n\nThe problem requires the derivation of the value of the hybrid trace unknown, $\\widehat{u}_{h}$, at the interior face $x=h_1$. We denote this value by $\\widehat{u}_{h,1} \\equiv \\widehat{u}_{h}(h_{1})$. The domain $\\Omega = [0,1]$ is partitioned into two elements, $K_1 = [0, h_1]$ and $K_2 = [h_1, 1]$. The approximation spaces for the solution $u_h$ and the flux $q_h$ are piecewise constant on each element, i.e., $u_h|_{K_i} = u_i \\in \\mathbb{R}$ and $q_h|_{K_i} = q_i \\in \\mathbb{R}$ for $i=1,2$. The hybrid trace $\\widehat{u}_h$ is constant on each face, with values $\\widehat{u}_h(0)$, $\\widehat{u}_h(h_1)$, and $\\widehat{u}_h(1)$.\n\nThe local HDG equations are derived from the weak formulation of the governing equations on each element $K$. For a test function $v \\in \\mathbb{P}_0(K)$ and a test flux $w \\in \\mathbb{P}_0(K)$, the equations are:\n$$\n\\int_K w q_h \\,dx = -\\kappa \\int_{\\partial K} w n \\widehat{u}_h \\,ds\n$$\n$$\n\\int_{\\partial K} v n \\widehat{q}_h \\,ds = 0\n$$\nSince the test functions are constants ($v=1, w=1$), these simplify to:\n$$\n|K|q_h = -\\kappa \\sum_{F \\in \\partial K} n_F \\widehat{u}_h|_F\n$$\n$$\n\\sum_{F \\in \\partial K} n_F \\widehat{q}_h|_F = 0\n$$\nwhere $|K|$ is the length of element $K$ and $n_F$ is the outward normal at face $F$.\n\nThe problem statement regarding the numerical flux is interpreted as follows: the definition $\\widehat{q}_{h}\\,n \\;=\\; q_{h}\\,n + \\tau\\,(u_{h}-\\widehat{u}_{h})$ holds on all faces, and the Neumann condition is imposed weakly as a global equation $\\widehat{q}_h \\cdot n = g_N$ at the boundary. This interpretation is necessary for a well-posed system.\n\n**Step 1: Local Equations and Static Condensation**\n\nOn element $K_1=[0, h_1]$:\nThe unknowns are constants $u_1, q_1$. The length is $|K_1|=h_1$. The faces are at $x=0$ (normal $n=-1$) and $x=h_1$ (normal $n=+1$). The trace values are $\\widehat{u}_h(0) = U_D$ (given Dirichlet data) and $\\widehat{u}_h(h_1) = \\widehat{u}_{h,1}$.\nThe first local equation gives:\n$h_1 q_1 = -\\kappa [ (+1)\\widehat{u}_{h,1} + (-1)U_D ] \\implies q_1 = -\\frac{\\kappa}{h_1}(\\widehat{u}_{h,1} - U_D) = \\frac{\\kappa}{h_1}(U_D - \\widehat{u}_{h,1})$.\nFor the second local equation, the numerical fluxes at the faces are:\nAt $x=h_1$: $n_1 \\widehat{q}_{h,1} = (+1)q_1 + \\tau(u_1 - \\widehat{u}_{h,1})$.\nAt $x=0$: $n_1 \\widehat{q}_{h,1} = (-1)q_1 + \\tau(u_1 - U_D)$.\nSumming these gives: $[q_1 + \\tau(u_1 - \\widehat{u}_{h,1})] + [-q_1 + \\tau(u_1 - U_D)] = 0 \\implies 2\\tau u_1 - \\tau(\\widehat{u}_{h,1} + U_D) = 0$.\nThis yields $u_1 = \\frac{1}{2}(U_D + \\widehat{u}_{h,1})$.\n\nOn element $K_2=[h_1, 1]$:\nThe unknowns are constants $u_2, q_2$. The length is $|K_2|=1-h_1$. The faces are at $x=h_1$ (normal $n=-1$) and $x=1$ (normal $n=+1$). We denote the unknown trace value at $x=1$ as $\\widehat{u}_{h,2} \\equiv \\widehat{u}_h(1)$.\nThe first local equation gives:\n$(1-h_1) q_2 = -\\kappa [ (+1)\\widehat{u}_{h,2} + (-1)\\widehat{u}_{h,1} ] \\implies q_2 = -\\frac{\\kappa}{1-h_1}(\\widehat{u}_{h,2} - \\widehat{u}_{h,1})$.\nFor the second local equation, the numerical fluxes at the faces are:\nAt $x=1$: $n_2 \\widehat{q}_{h,2} = (+1)q_2 + \\tau(u_2 - \\widehat{u}_{h,2})$.\nAt $x=h_1$: $n_2 \\widehat{q}_{h,2} = (-1)q_2 + \\tau(u_2 - \\widehat{u}_{h,1})$.\nSumming these gives: $[q_2 + \\tau(u_2 - \\widehat{u}_{h,2})] + [-q_2 + \\tau(u_2 - \\widehat{u}_{h,1})] = 0 \\implies 2\\tau u_2 - \\tau(\\widehat{u}_{h,1} + \\widehat{u}_{h,2}) = 0$.\nThis yields $u_2 = \\frac{1}{2}(\\widehat{u}_{h,1} + \\widehat{u}_{h,2})$.\n\n**Step 2: Global System for Hybrid Traces**\n\nThe global system consists of equations for the unknown trace values $\\widehat{u}_{h,1}$ and $\\widehat{u}_{h,2}$.\nAt the interior face $x=h_1$, we enforce continuity of the numerical flux. The outward normal for $K_1$ is $n=+1$, for $K_2$ it is $n=-1$.\n$(\\widehat{q}_h \\cdot n)|_{K_1, x=h_1} + (\\widehat{q}_h \\cdot n)|_{K_2, x=h_1} = 0$.\n$[q_1 + \\tau(u_1 - \\widehat{u}_{h,1})] + [-q_2 + \\tau(u_2-\\widehat{u}_{h,1})] = 0 \\implies q_1 - q_2 + \\tau(u_1+u_2-2\\widehat{u}_{h,1}) = 0$.\n\nAt the Neumann boundary face $x=1$, we impose the condition $\\widehat{q}_h \\cdot n = g_N$. The outward normal from $K_2$ is $n=+1$.\n$(\\widehat{q}_h \\cdot n)|_{K_2, x=1} = g_N \\implies q_2 + \\tau(u_2 - \\widehat{u}_{h,2}) = g_N$.\n\n**Step 3: Reduction to a Single Equation and Solution**\n\nWe now have a $2 \\times 2$ system for $\\widehat{u}_{h,1}$ and $\\widehat{u}_{h,2}$. First, we use the Neumann equation to eliminate $\\widehat{u}_{h,2}$.\nSubstitute the condensed forms for $q_2$ and $u_2$ into the Neumann equation:\n$-\\frac{\\kappa}{1-h_1}(\\widehat{u}_{h,2} - \\widehat{u}_{h,1}) + \\tau\\left(\\frac{1}{2}(\\widehat{u}_{h,1} + \\widehat{u}_{h,2}) - \\widehat{u}_{h,2}\\right) = g_N$\n$\\frac{\\kappa}{1-h_1}(\\widehat{u}_{h,1} - \\widehat{u}_{h,2}) + \\frac{\\tau}{2}(\\widehat{u}_{h,1} - \\widehat{u}_{h,2}) = g_N$\n$\\left(\\frac{\\kappa}{1-h_1} + \\frac{\\tau}{2}\\right) (\\widehat{u}_{h,1} - \\widehat{u}_{h,2}) = g_N$.\nThis allows expressing $(\\widehat{u}_{h,1} - \\widehat{u}_{h,2})$ and consequently $\\widehat{u}_{h,2}$ in terms of $\\widehat{u}_{h,1}$:\n$\\widehat{u}_{h,2} = \\widehat{u}_{h,1} - g_N \\left(\\frac{\\kappa}{1-h_1} + \\frac{\\tau}{2}\\right)^{-1}$.\n\nNext, substitute all condensed forms into the interior face equation:\n$q_1 - q_2 + \\tau(u_1+u_2-2\\widehat{u}_{h,1}) = 0$\n$\\frac{\\kappa}{h_1}(U_D - \\widehat{u}_{h,1}) - \\left[-\\frac{\\kappa}{1-h_1}(\\widehat{u}_{h,2} - \\widehat{u}_{h,1})\\right] + \\tau\\left(\\frac{1}{2}(U_D + \\widehat{u}_{h,1}) + \\frac{1}{2}(\\widehat{u}_{h,1} + \\widehat{u}_{h,2}) - 2\\widehat{u}_{h,1}\\right) = 0$\n$\\frac{\\kappa}{h_1}(U_D - \\widehat{u}_{h,1}) + \\frac{\\kappa}{1-h_1}(\\widehat{u}_{h,2} - \\widehat{u}_{h,1}) + \\frac{\\tau}{2}(U_D - 2\\widehat{u}_{h,1} + \\widehat{u}_{h,2}) = 0$\nGrouping terms:\n$(U_D - \\widehat{u}_{h,1})\\left(\\frac{\\kappa}{h_1} + \\frac{\\tau}{2}\\right) + (\\widehat{u}_{h,2} - \\widehat{u}_{h,1})\\left(\\frac{\\kappa}{1-h_1} + \\frac{\\tau}{2}\\right) = 0$\nLet $A = \\frac{\\kappa}{1-h_1} + \\frac{\\tau}{2}$. From the Neumann equation, we already know $(\\widehat{u}_{h,1}-\\widehat{u}_{h,2})A = g_N$, so $(\\widehat{u}_{h,2}-\\widehat{u}_{h,1})A = -g_N$.\nSubstitute this into the equation:\n$(U_D - \\widehat{u}_{h,1})\\left(\\frac{\\kappa}{h_1} + \\frac{\\tau}{2}\\right) - g_N = 0$\n$(U_D - \\widehat{u}_{h,1})\\left(\\frac{2\\kappa + \\tau h_1}{2h_1}\\right) = g_N$\n$U_D - \\widehat{u}_{h,1} = \\frac{2h_1 g_N}{2\\kappa + \\tau h_1}$\n$\\widehat{u}_{h,1} = U_D - \\frac{2h_1 g_N}{2\\kappa + \\tau h_1}$\nTo express this as a single fraction:\n$\\widehat{u}_{h,1} = \\frac{U_D(2\\kappa + \\tau h_1) - 2h_1 g_N}{2\\kappa + \\tau h_1}$.\nThis is the explicit closed-form expression for $\\widehat{u}_h(h_1)$.", "answer": "$$\\boxed{\\frac{U_{D}(2\\kappa + \\tau h_{1}) - 2h_{1}g_{N}}{2\\kappa + \\tau h_{1}}}$$", "id": "3390545"}, {"introduction": "Having seen the algebraic procedure of static condensation, we now turn to its practical motivation: computational efficiency. This exercise [@problem_id:3390584] asks you to analyze and compare the memory storage and arithmetic complexity of the HDG method against a standard Discontinuous Galerkin (DG) approach for a large-scale problem. By calculating the ratio of non-zero entries in the respective global matrices, you will quantify the significant computational savings that make HDG an attractive method for complex simulations.", "problem": "Consider the scalar Poisson equation discretized by a symmetric interior penalty Discontinuous Galerkin (DG) method and by a Hybridizable Discontinuous Galerkin (HDG) method with static condensation that eliminates element-interior unknowns, leaving only face trace unknowns globally. Use the following data and modeling assumptions to compare arithmetic complexity and memory storage.\n\nFundamental definitions and facts you may use:\n- For polynomial degree $p$ on triangles, the number of scalar element-interior basis functions is $n_{\\mathrm{el}} = \\frac{(p+1)(p+2)}{2}$.\n- For polynomial degree $p$ on an edge, the number of scalar trace basis functions is $m_{\\mathrm{ed}} = p+1$.\n- On a block-sparse global matrix, the dominant per-iteration cost of a Krylov method is proportional to the number of stored nonzero scalar entries. In Compressed Sparse Row (CSR) storage, memory is also proportional to the number of stored nonzero scalar entries.\n- In a DG matrix assembled on a simplicial mesh, each element contributes one $n_{\\mathrm{el}}\\times n_{\\mathrm{el}}$ self-block, and each interior edge contributes off-diagonal couplings between the two adjacent elements. Counting both symmetric off-diagonal blocks, the total nonzeros is modeled by $\\mathrm{nnz}_{\\mathrm{DG}} = E\\,n_{\\mathrm{el}}^{2} + 2\\,E_{\\mathrm{int}}\\,n_{\\mathrm{el}}^{2}$, where $E$ is the number of elements and $E_{\\mathrm{int}}$ the number of interior edges.\n- In an HDG condensed global matrix on a triangle, each element contributes a dense $(3\\,m_{\\mathrm{ed}})\\times(3\\,m_{\\mathrm{ed}})$ block among its three edges’ traces. When assembling globally over edges, diagonal edge blocks are shared by the two incident elements and should be counted once; off-diagonal edge-edge couplings (between two distinct edges of the same element) are unique to that element. A consistent count of stored nonzeros is $\\mathrm{nnz}_{\\mathrm{HDG}} = E\\,(3\\,m_{\\mathrm{ed}})^{2} - E_{\\mathrm{int}}\\,m_{\\mathrm{ed}}^{2}$.\n\nGeometry and mesh:\n- The domain is the rectangle partitioned into $N_{x}\\times N_{y}$ rectangles with $N_{x} = 20$ and $N_{y} = 10$, each rectangle split into two triangles by the same diagonal. The mesh has homogeneous Dirichlet boundary conditions, so only interior edges carry global HDG trace unknowns.\n- For this structured triangulation, the numbers of mesh entities are:\n  - Elements: $E = 2\\,N_{x}\\,N_{y}$.\n  - Total edges: $E_{\\mathrm{tot}} = 3\\,N_{x}\\,N_{y} + N_{x} + N_{y}$.\n  - Boundary edges: $E_{\\partial} = 2\\,N_{x} + 2\\,N_{y}$.\n  - Interior edges: $E_{\\mathrm{int}} = E_{\\mathrm{tot}} - E_{\\partial} = 3\\,N_{x}\\,N_{y} - N_{x} - N_{y}$.\n\nPolynomial degree:\n- Use $p = 3$ on elements and edges.\n\nTasks:\n1. Using the above, compute the ratio of arithmetic complexity per matrix-vector product for HDG after static condensation relative to the global DG system, $\\mathcal{C} = \\frac{\\mathrm{nnz}_{\\mathrm{HDG}}}{\\mathrm{nnz}_{\\mathrm{DG}}}$.\n2. Compute the fractional memory savings $\\mathcal{S} = 1 - \\frac{\\mathrm{nnz}_{\\mathrm{HDG}}}{\\mathrm{nnz}_{\\mathrm{DG}}}$.\n\nReport your final answer as a two-entry row vector $\\begin{pmatrix}\\mathcal{C}  \\mathcal{S}\\end{pmatrix}$, rounded to four significant figures. No units are required.", "solution": "We begin by determining the combinatorial quantities of the mesh. With $N_{x} = 20$ and $N_{y} = 10$, the number of triangular elements is\n$$\nE = 2\\,N_{x}\\,N_{y} = 2\\cdot 20 \\cdot 10 = 400.\n$$\nThe number of interior edges is\n$$\nE_{\\mathrm{int}} = 3\\,N_{x}\\,N_{y} - N_{x} - N_{y} = 3\\cdot 20 \\cdot 10 - 20 - 10 = 600 - 30 = 570.\n$$\n\nNext, we compute the local degrees of freedom counts at polynomial degree $p=3$. On triangles,\n$$\nn_{\\mathrm{el}} = \\frac{(p+1)(p+2)}{2} = \\frac{(3+1)(3+2)}{2} = \\frac{4\\cdot 5}{2} = 10,\n$$\nand on edges,\n$$\nm_{\\mathrm{ed}} = p+1 = 3+1 = 4.\n$$\n\nWe now model the number of stored nonzeros in the global matrices.\n\nFor the Discontinuous Galerkin (DG) matrix, we use the block pattern count that includes element self-couplings and pairwise couplings across each interior edge, counting both symmetric off-diagonal blocks. This gives\n$$\n\\mathrm{nnz}_{\\mathrm{DG}} = E\\,n_{\\mathrm{el}}^{2} + 2\\,E_{\\mathrm{int}}\\,n_{\\mathrm{el}}^{2}.\n$$\nSubstituting $E=400$, $E_{\\mathrm{int}}=570$, and $n_{\\mathrm{el}}=10$ yields\n$$\n\\mathrm{nnz}_{\\mathrm{DG}} = 400\\cdot 10^{2} + 2\\cdot 570 \\cdot 10^{2} = 400\\cdot 100 + 1140\\cdot 100 = 40{,}000 + 114{,}000 = 154{,}000.\n$$\n\nFor the Hybridizable Discontinuous Galerkin (HDG) condensed matrix, each triangle contributes a dense $(3\\,m_{\\mathrm{ed}})\\times(3\\,m_{\\mathrm{ed}})$ local Schur block among its three edges. Assembled globally, diagonal edge blocks are shared by two triangles and thus must be counted once, while off-diagonal couplings between two distinct edges are unique to the triangle that contains both edges. A consistent global count is\n$$\n\\mathrm{nnz}_{\\mathrm{HDG}} = E\\,(3\\,m_{\\mathrm{ed}})^{2} - E_{\\mathrm{int}}\\,m_{\\mathrm{ed}}^{2}.\n$$\nWith $E=400$, $E_{\\mathrm{int}}=570$, and $m_{\\mathrm{ed}}=4$,\n$$\n(3\\,m_{\\mathrm{ed}})^{2} = (3\\cdot 4)^{2} = 12^{2} = 144, \\quad m_{\\mathrm{ed}}^{2}=4^{2}=16,\n$$\nso\n$$\n\\mathrm{nnz}_{\\mathrm{HDG}} = 400\\cdot 144 - 570\\cdot 16 = 57{,}600 - 9{,}120 = 48{,}480.\n$$\n\nThe arithmetic complexity ratio per matrix-vector multiplication is modeled as the ratio of nonzeros:\n$$\n\\mathcal{C} = \\frac{\\mathrm{nnz}_{\\mathrm{HDG}}}{\\mathrm{nnz}_{\\mathrm{DG}}} = \\frac{48{,}480}{154{,}000}.\n$$\nCompute the fraction:\n$$\n\\mathcal{C} = \\frac{48{,}480}{154{,}000} \\approx 0.3148051948\\ldots\n$$\n\nThe fractional memory savings is\n$$\n\\mathcal{S} = 1 - \\mathcal{C} \\approx 1 - 0.3148051948\\ldots \\approx 0.6851948052\\ldots\n$$\n\nRounding both to four significant figures gives\n$$\n\\mathcal{C} \\approx 0.3148, \\qquad \\mathcal{S} \\approx 0.6852.\n$$\n\nWe report the result as a row vector with these two entries.", "answer": "$$\\boxed{\\begin{pmatrix}0.3148  0.6852\\end{pmatrix}}$$", "id": "3390584"}, {"introduction": "Efficiency in HDG methods is not just about the global system; it also depends on the cost of the local solves that are performed on every element during the static condensation process. This advanced practice [@problem_id:3390593] explores how the choice of polynomial basis for the trace variable—specifically, Legendre versus Chebyshev polynomials—affects the structure and inversion cost of the local face matrices. This analysis reveals the deep connection between polynomial approximation theory and the design of computationally efficient numerical algorithms.", "problem": "Consider the scalar Poisson model problem in two space dimensions with Dirichlet boundary conditions. Let a Hybridizable Discontinuous Galerkin (HDG) discretization be used with polynomial degree $p \\ge 0$ for element-interior fields and degree $p$ for the hybrid trace variable on each face. On each reference face $\\widehat{F} = [-1,1]$, consider two hierarchical choices of trace bases:\n- Legendre hierarchy: $\\{\\phi^{(L)}_{n}(x)\\}_{n=0}^{p}$ with $\\phi^{(L)}_{n}(x) = P_{n}(x)$, the Legendre polynomial of degree $n$.\n- Chebyshev hierarchy: $\\{\\phi^{(C)}_{n}(x)\\}_{n=0}^{p}$ with $\\phi^{(C)}_{n}(x) = T_{n}(x)$, the Chebyshev polynomial of the first kind of degree $n$.\n\nAssume the HDG stabilization bilinear form on a (flat, affine) face $F$ reduces on $\\widehat{F}$ to the weighted $L^{2}$ pairing with unit weight, that is, for trace functions $\\widehat{u}$ and $\\widehat{v}$, $s_{F}(\\widehat{u},\\widehat{v}) = \\tau \\int_{-1}^{1} \\widehat{u}(x)\\,\\widehat{v}(x)\\,dx$ with constant $\\tau0$. Under static condensation, the local Schur complement assembly and solution on each face require inverting the face stabilization matrix\n$$\nM^{(b)} = \\big(M^{(b)}_{mn}\\big)_{m,n=0}^{p}, \\qquad M^{(b)}_{mn} = \\int_{-1}^{1} \\phi^{(b)}_{m}(x)\\,\\phi^{(b)}_{n}(x)\\,dx,\n$$\nwhere $b \\in \\{L,C\\}$ denotes the Legendre or Chebyshev choice.\n\nWorking from the orthogonality of $P_{n}$ with respect to the unit weight on $[-1,1]$, and from the identity $T_{n}(\\cos\\theta)=\\cos(n\\theta)$ together with the change of variables $x=\\cos\\theta$ on $[-1,1]$, derive the sparsity/density structure of $M^{(L)}$ and $M^{(C)}$. Then, define the per-face floating-point multiplication counts as follows:\n- For a diagonal positive-definite matrix of size $m \\times m$, the inversion cost is $m$ multiplications (count each reciprocal as one multiplication; ignore additions).\n- For a block-diagonal matrix with two dense positive-definite blocks of sizes $n_{e}$ and $n_{o}$, the inversion cost by naive Gaussian elimination on each dense block is $\\frac{1}{3}n_{e}^{3} + \\frac{1}{3}n_{o}^{3}$ multiplications (ignore additions and lower-order terms), without any pivoting or further structure exploitation.\n- For a fully dense positive-definite matrix of size $m \\times m$, the inversion cost by naive Gaussian elimination is $\\frac{1}{3}m^{3}$ multiplications.\n\nLet $m = p+1$ denote the number of face degrees of freedom. Let $n_{e}$ be the number of even indices in $\\{0,1,\\dots,p\\}$, and $n_{o}$ be the number of odd indices in $\\{0,1,\\dots,p\\}$. Using the above facts, compute the exact expression for the ratio\n$$\nR(p) \\equiv \\frac{\\text{multiplication cost to invert }M^{(C)}}{\\text{multiplication cost to invert }M^{(L)}}.\n$$\nExpress $R(p)$ in closed form as a function of $p$, using only algebraic operations and, if desired, the floor and ceiling functions.\n\nFinally, justify, from approximation and projection arguments for polynomial spaces on affine meshes and the standard HDG local postprocessing, whether the asymptotic $L^{2}$-convergence order of the postprocessed solution $u_{h}^{\\star}$ depends on the above choice of trace basis under the same stabilization and mesh sequence. Your final reported answer must be the closed-form expression for $R(p)$ only; no units are required, and no rounding is needed.", "solution": "The problem is first validated.\n\n### Step 1: Extract Givens\n-   **Method:** Hybridizable Discontinuous Galerkin (HDG) for the $2$D scalar Poisson problem.\n-   **Polynomial Degree:** $p \\ge 0$ for element and trace spaces.\n-   **Reference Face:** $\\widehat{F} = [-1,1]$.\n-   **Trace Bases:**\n    1.  Legendre: $\\{\\phi^{(L)}_{n}(x) = P_{n}(x)\\}_{n=0}^{p}$, Legendre polynomials.\n    2.  Chebyshev: $\\{\\phi^{(C)}_{n}(x) = T_{n}(x)\\}_{n=0}^{p}$, Chebyshev polynomials of the first kind.\n-   **Stabilization Form:** $s_{F}(\\widehat{u},\\widehat{v}) = \\tau \\int_{-1}^{1} \\widehat{u}(x)\\,\\widehat{v}(x)\\,dx$ for a constant $\\tau0$. We can set $\\tau=1$ without loss of generality as it is a common scaling factor.\n-   **Face Matrix:** $M^{(b)}_{mn} = \\int_{-1}^{1} \\phi^{(b)}_{m}(x)\\,\\phi^{(b)}_{n}(x)\\,dx$ for $b \\in \\{L,C\\}$.\n-   **Polynomial Properties:** $P_{n}$ are orthogonal on $[-1,1]$ with unit weight. $T_{n}(\\cos\\theta)=\\cos(n\\theta)$, and $x=\\cos\\theta$ for $x \\in [-1,1]$.\n-   **Cost Models for Inversion ($m \\times m$ matrix):**\n    -   Diagonal: $m$ multiplications.\n    -   Block-diagonal (dense blocks of size $n_{e}, n_{o}$): $\\frac{1}{3}n_{e}^{3} + \\frac{1}{3}n_{o}^{3}$ multiplications.\n    -   Fully dense: $\\frac{1}{3}m^{3}$ multiplications.\n-   **Definitions:** $m = p+1$, $n_{e} = $ number of even indices in $\\{0, \\dots, p\\}$, $n_{o} = $ number of odd indices in $\\{0, \\dots, p\\}$.\n-   **Objective 1:** Compute the ratio $R(p) = \\frac{\\text{cost to invert }M^{(C)}}{\\text{cost to invert }M^{(L)}}$.\n-   **Objective 2:** Justify if the $L^{2}$-convergence order of the postprocessed solution $u_{h}^{\\star}$ depends on the choice of basis.\n\n### Step 2: Validate Using Extracted Givens\n-   **Scientific Grounding:** The problem is firmly rooted in the theory of spectral and discontinuous Galerkin methods, a standard topic in numerical analysis for partial differential equations. The use of Legendre and Chebyshev bases, and the analysis of local matrix inversion costs, are common and valid concerns in this field.\n-   **Well-Posedness:** The problem is well-posed. It provides all necessary definitions, including the specific cost models for matrix inversion, which removes any ambiguity in calculation. The objectives are clearly stated and a unique solution is derivable from the givens.\n-   **Objectivity:** The problem is stated in objective, mathematical language, free from any subjective claims.\n-   **Conclusion:** The problem is valid.\n\n### Derivation of the Solution\n\nThe solution proceeds by, first, determining the structure and inversion cost for the Legendre-based matrix $M^{(L)}$, then for the Chebyshev-based matrix $M^{(C)}$. The ratio $R(p)$ is then computed. Finally, the question of convergence order is addressed.\n\n**1. Analysis of the Legendre Basis Matrix $M^{(L)}$**\n\nThe entries of the matrix $M^{(L)}$ are given by\n$$\nM^{(L)}_{mn} = \\int_{-1}^{1} \\phi^{(L)}_{m}(x)\\,\\phi^{(L)}_{n}(x)\\,dx = \\int_{-1}^{1} P_{m}(x)\\,P_{n}(x)\\,dx.\n$$\nA fundamental property of Legendre polynomials $\\{P_n(x)\\}$ is their orthogonality on the interval $[-1,1]$ with respect to the unit weight function $w(x)=1$. The orthogonality relation is\n$$\n\\int_{-1}^{1} P_{m}(x) P_{n}(x) dx = \\frac{2}{2n+1} \\delta_{mn},\n$$\nwhere $\\delta_{mn}$ is the Kronecker delta. This implies that the matrix $M^{(L)}$ is diagonal:\n$$\nM^{(L)}_{mn} = \\begin{cases} \\frac{2}{2n+1}  \\text{if } m=n \\\\ 0  \\text{if } m \\neq n \\end{cases}.\n$$\nThe size of the matrix is $(p+1) \\times (p+1)$, or $m \\times m$. According to the provided cost model, the inversion of a diagonal matrix of size $m \\times m$ requires $m$ multiplications.\nTherefore, the cost to invert $M^{(L)}$ is\n$$\n\\text{Cost}(M^{(L)}) = m = p+1.\n$$\n\n**2. Analysis of the Chebyshev Basis Matrix $M^{(C)}$**\n\nThe entries of the matrix $M^{(C)}$ are given by\n$$\nM^{(C)}_{mn} = \\int_{-1}^{1} \\phi^{(C)}_{m}(x)\\,\\phi^{(C)}_{n}(x)\\,dx = \\int_{-1}^{1} T_{m}(x)\\,T_{n}(x)\\,dx.\n$$\nTo evaluate this integral, we use the suggested change of variables $x = \\cos\\theta$, which maps the interval $[-1,1]$ to $[\\pi,0]$. We have $dx = -\\sin\\theta\\,d\\theta$ and the identity $T_k(\\cos\\theta) = \\cos(k\\theta)$. The integral becomes\n$$\nM^{(C)}_{mn} = \\int_{\\pi}^{0} T_{m}(\\cos\\theta)T_{n}(\\cos\\theta) (-\\sin\\theta\\,d\\theta) = \\int_{0}^{\\pi} \\cos(m\\theta)\\cos(n\\theta)\\sin\\theta\\,d\\theta.\n$$\nWe use the trigonometric identity $\\cos(A)\\cos(B) = \\frac{1}{2}(\\cos(A-B) + \\cos(A+B))$:\n$$\nM^{(C)}_{mn} = \\frac{1}{2} \\int_{0}^{\\pi} \\left( \\cos((m-n)\\theta) + \\cos((m+n)\\theta) \\right) \\sin\\theta\\,d\\theta.\n$$\nThe integral is non-zero only if $m$ and $n$ have the same parity. This is because $\\cos(k\\theta)\\sin\\theta$ is an odd function about $\\theta=\\pi/2$ if $k$ is odd, and an even function if $k$ is even. Integrating an odd function over a symmetric interval like $[0, \\pi]$ (symmetric about $\\pi/2$) gives zero.\nLet's analyze $\\int_0^\\pi \\cos(k\\theta)\\sin\\theta d\\theta$. This integral is non-zero only if $k$ is an even integer. If $m$ and $n$ have different parity, then $m-n$ and $m+n$ are both odd. In this case, both terms in the integral are zero, and thus $M^{(C)}_{mn} = 0$.\nIf $m$ and $n$ have the same parity, then $m-n$ and $m+n$ are both even. In this case, the integral is generally non-zero.\nThis implies that $M^{(C)}$ is a block-diagonal matrix. If we order the basis functions by parity (even degrees first, then odd degrees), $M^{(C)}$ has two diagonal blocks. The first block corresponds to interactions between even-indexed basis functions, and the second block corresponds to interactions between odd-indexed basis functions. These blocks are dense.\n\nThe size of the even-indexed block is $n_e$, the number of even integers in $\\{0, 1, \\dots, p\\}$. The size of the odd-indexed block is $n_o$, the number of odd integers in $\\{0, 1, \\dots, p\\}$. The problem states that for such a matrix, the inversion cost is\n$$\n\\text{Cost}(M^{(C)}) = \\frac{1}{3}n_{e}^{3} + \\frac{1}{3}n_{o}^{3}.\n$$\n\n**3. Calculation of $n_e$ and $n_o$**\n\nThe total number of degrees of freedom is $m = p+1$.\n$n_e$ is the count of even numbers $\\{0, 2, 4, \\dots\\}$ up to $p$.\n$n_o$ is the count of odd numbers $\\{1, 3, 5, \\dots\\}$ up to $p$.\nThese can be expressed compactly using the floor and ceiling functions:\n- The even indices are $0, 2, \\dots, 2k$ where $2k \\le p$, so $k \\le p/2$. The number of such indices is $k+1$. This is $\\lfloor p/2 \\rfloor + 1$. Thus, $n_e = \\lfloor \\frac{p}{2} \\rfloor + 1$.\n- The odd indices are $1, 3, \\dots, 2k-1$ where $2k-1 \\le p$, so $k \\le (p+1)/2$. The number of odd indices is $\\lceil p/2 \\rceil$. Thus, $n_o = \\lceil \\frac{p}{2} \\rceil$.\nWe can verify that $n_e+n_o = (\\lfloor \\frac{p}{2} \\rfloor + 1) + \\lceil \\frac{p}{2} \\rceil = (\\lfloor \\frac{p}{2} \\rfloor + \\lceil \\frac{p}{2} \\rceil) + 1 = p+1=m$.\n\n**4. Computation of the Ratio $R(p)$**\n\nWe now compute the ratio $R(p)$:\n$$\nR(p) = \\frac{\\text{Cost}(M^{(C)})}{\\text{Cost}(M^{(L)})} = \\frac{\\frac{1}{3}(n_e^3 + n_o^3)}{p+1}.\n$$\nSubstituting the expressions for $n_e$ and $n_o$:\n$$\nR(p) = \\frac{1}{3(p+1)}\\left( \\left(\\lfloor \\frac{p}{2} \\rfloor + 1\\right)^3 + \\left(\\lceil \\frac{p}{2} \\rceil\\right)^3 \\right).\n$$\nThis is the required closed-form expression for $R(p)$.\n\n**5. Justification of Convergence Order Independence**\n\nThe question is whether the asymptotic $L^2$-convergence order of the postprocessed solution $u_h^\\star$ depends on the choice of trace basis (Legendre vs. Chebyshev). The answer is no.\n\nThe reasoning is as follows: The two sets of basis functions, $\\{\\phi^{(L)}_{n}(x)\\}_{n=0}^{p}$ and $\\{\\phi^{(C)}_{n}(x)\\}_{n=0}^{p}$, are both complete bases for the same finite-dimensional space of polynomials of degree at most $p$ on the reference face, denoted $\\mathcal{P}^p(\\widehat{F})$. A change of basis from Legendre to Chebyshev is a linear, invertible transformation.\n\nThe HDG method seeks a solution in a specific finite element space, which is defined independently of its basis. The Galerkin formulation leads to a global system of linear equations. While the entries of the matrix and a vector of coefficients for the numerical solution $\\lambda_h$ depend on the chosen basis, the resulting function $\\lambda_h$ (which is a linear combination of basis functions) is identical for any choice of basis, up to numerical precision.\n\nThe standard HDG error analysis for the Poisson problem proves convergence rates that depend on the polynomial degree $p$ and the regularity of the exact solution. For a sufficiently smooth solution and a sequence of quasi-uniform meshes of size $h$, the postprocessed solution $u_h^\\star$ is known to achieve an optimal convergence order of $O(h^{p+2})$ in the $L^2$-norm for $p\\ge 1$. These theoretical results hinge on the approximation properties of the polynomial spaces $\\mathcal{P}^p(K)$ and $\\mathcal{P}^p(F)$, not on the specific basis used to represent functions within them.\n\nSince the choice of basis does not alter the underlying polynomial space, the approximation properties of the HDG method are unchanged. The computed solution functions $(u_h, q_h, \\lambda_h)$ are invariant, and therefore, the postprocessed solution $u_h^\\star$ and its $L^2$-error are also independent of the basis choice. Consequently, the asymptotic $L^2$-convergence order does not depend on whether a Legendre or Chebyshev basis is used for the trace variable.", "answer": "$$\n\\boxed{\\frac{1}{3(p+1)}\\left( \\left(\\lfloor \\frac{p}{2} \\rfloor + 1\\right)^3 + \\left(\\lceil \\frac{p}{2} \\rceil\\right)^3 \\right)}\n$$", "id": "3390593"}]}