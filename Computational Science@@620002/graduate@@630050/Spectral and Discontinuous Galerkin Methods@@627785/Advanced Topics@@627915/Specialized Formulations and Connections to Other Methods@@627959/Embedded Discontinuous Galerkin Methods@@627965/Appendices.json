{"hands_on_practices": [{"introduction": "To truly master the Embedded Discontinuous Galerkin (EDG) method, we must move from abstract theory to concrete application. This first practice guides you through the fundamental steps of constructing an EDG scheme for the canonical Poisson equation. By working through this problem, you will translate the continuous PDE into its first-order weak formulation, define the essential discrete spaces, and understand how the continuous trace variable $\\widehat{u}_h$ stitches the local solutions together, allowing you to predict the method's accuracy [@problem_id:3383258].", "problem": "Consider the scalar diffusion model problem with Dirichlet boundary conditions: find $u:\\Omega \\to \\mathbb{R}$ such that $-\\nabla \\cdot (\\kappa \\nabla u) = f$ in $\\Omega=(0,1)^2$ and $u=g$ on $\\partial \\Omega$, where $\\kappa=1$. Take the manufactured function $u(x,y)=\\sin(\\pi x)\\sin(\\pi y)$ and the forcing $f=2\\pi^2 u$, and set $g=u|_{\\partial \\Omega}$ (which is identically zero). Starting from the first-order system representation and the elementwise weak formulations, derive the Embedded Discontinuous Galerkin (EDG) method of polynomial degree $k=1$ on a shape-regular, quasi-uniform partition of $\\Omega$ into axis-aligned rectangles. Explicitly specify the discrete spaces for the element-wise flux $q_h$, element-wise scalar field $u_h$, and the embedded trace $\\widehat{u}_h$, and write the local EDG equations including the numerical flux with a stabilization parameter $\\tau>0$ that is constant per edge. Then, detail the trace continuity constraints in the EDG trace space for $k=1$ on this rectangular mesh: explain what continuity is enforced at interior vertices and along interior edges, and how Dirichlet boundary values are incorporated on $\\partial \\Omega$. Finally, define the energy error as $\\left(\\sum_{K}\\|\\nabla(u-u_h)\\|_{L^2(K)}^2\\right)^{1/2}$ and the $L^2$ error as $\\|u-u_h\\|_{L^2(\\Omega)}$, and, under standard stability and approximation properties for EDG on quasi-uniform meshes with smooth exact solutions, provide the ordered pair of exponents $(r_E,r_{L^2})$ such that these errors behave like $C h^{r_E}$ and $C h^{r_{L^2}}$ as $h\\to 0$ for $k=1$. Express your final answer as a single row matrix containing the two exponents. No rounding is required and no physical units are involved.", "solution": "The problem statement is validated as scientifically grounded, well-posed, and objective. It poses a standard question in the field of numerical analysis for partial differential equations, specifically concerning the Embedded Discontinuous Galerkin (EDG) method. All required information to formulate the method and determine its theoretical convergence properties is provided.\n\nThe problem starts with the scalar diffusion equation on the domain $\\Omega=(0,1)^2$:\n$$\n-\\nabla \\cdot (\\kappa \\nabla u) = f\n$$\nwith $\\kappa=1$. This is the Poisson equation $-\\nabla^2 u = f$. For the purpose of deriving the method, we will use the general forcing term $f$. The provided manufactured solution $u(x,y)=\\sin(\\pi x)\\sin(\\pi y)$ corresponds to the specified forcing term $f = -\\nabla^2 u = 2\\pi^2\\sin(\\pi x)\\sin(\\pi y) = 2\\pi^2 u$.\n\nThe EDG method is formulated by first rewriting the second-order PDE as a first-order system. We introduce the flux variable $q = -\\kappa \\nabla u$. With $\\kappa=1$, this is $q = -\\nabla u$. The system is:\n$$\n\\begin{cases}\nq + \\nabla u = 0 & \\text{in } \\Omega \\\\\n\\nabla \\cdot q = f & \\text{in } \\Omega\n\\end{cases}\n$$\nThe weak formulation is derived on an element-by-element basis. Let $\\mathcal{T}_h$ be a partition of $\\Omega$ into shape-regular, quasi-uniform, axis-aligned rectangles $K$. For an arbitrary element $K \\in \\mathcal{T}_h$, we multiply the two equations by vector and scalar test functions, $v_q$ and $v_u$ respectively, and integrate over $K$:\n$$\n\\int_K (q + \\nabla u) \\cdot v_q \\, dK = 0\n$$\n$$\n\\int_K (\\nabla \\cdot q) v_u \\, dK = \\int_K f v_u \\, dK\n$$\nApplying integration by parts to the divergence terms yields:\n$$\n\\int_K q \\cdot v_q \\, dK - \\int_K u (\\nabla \\cdot v_q) \\, dK + \\int_{\\partial K} u (v_q \\cdot n) \\, dS = 0\n$$\n$$\n-\\int_K q \\cdot \\nabla v_u \\, dK + \\int_{\\partial K} (q \\cdot n) v_u \\, dS = \\int_K f v_u \\, dK\n$$\nwhere $n$ is the outward unit normal vector to the boundary $\\partial K$.\n\nThe EDG method defines three discrete variables: the approximate scalar field $u_h$, the approximate flux $q_h$, and the embedded trace $\\widehat{u}_h$. For polynomial degree $k=1$ on a rectangular mesh, the discrete spaces are defined as follows:\n\\begin{itemize}\n    \\item The element-wise scalar field $u_h$ belongs to the space $U_h = \\{v \\in L^2(\\Omega): v|_K \\in Q_1(K) \\text{ for all } K \\in \\mathcal{T}_h \\}$, where $Q_1(K)$ is the space of bilinear polynomials on the rectangle $K$, spanned by $\\{1, x, y, xy\\}$.\n    \\item The element-wise flux $q_h$ belongs to the space $Q_h = \\{ v_q \\in (L^2(\\Omega))^2: v_q|_K \\in (P_1(K))^2 \\text{ for all } K \\in \\mathcal{T}_h \\}$, where $P_1(K)$ is the space of linear polynomials.\n    \\item The embedded trace $\\widehat{u}_h$ belongs to the space $\\widehat{U}_h = \\{ \\widehat{v} \\in C^0(\\mathcal{E}_h) : \\widehat{v}|_e \\in P_1(e) \\text{ for all } e \\in \\mathcal{E}_h \\}$, where $\\mathcal{E}_h$ is the mesh skeleton (the union of all element faces). $C^0(\\mathcal{E}_h)$ denotes the space of continuous functions on the skeleton, and $P_1(e)$ is the space of linear polynomials on an edge $e$.\n\\end{itemize}\n\nThe EDG formulation is obtained by replacing the exact solutions and their boundary traces in the weak formulation with their discrete counterparts and numerical fluxes. The trace of $u$ on $\\partial K$ is replaced by the single-valued trace variable $\\widehat{u}_h$. The normal component of the flux, $q \\cdot n$, is replaced by a numerical flux $\\widehat{q}_h \\cdot n$. A standard choice for the numerical flux, incorporating the stabilization parameter $\\tau>0$, is:\n$$\n\\widehat{q}_h \\cdot n = q_h \\cdot n - \\tau(u_h - \\widehat{u}_h)\n$$\nThe local EDG equations for any element $K \\in \\mathcal{T}_h$ are: find $(u_h|_K, q_h|_K) \\in Q_1(K) \\times (P_1(K))^2$ such that for a given $\\widehat{u}_h$ on $\\partial K$:\n$$\n\\int_K q_h \\cdot v_q \\, dK - \\int_K u_h (\\nabla \\cdot v_q) \\, dK + \\int_{\\partial K} \\widehat{u}_h (v_q \\cdot n) \\, dS = 0, \\quad \\forall v_q \\in (P_1(K))^2\n$$\n$$\n-\\int_K q_h \\cdot \\nabla v_u \\, dK + \\int_{\\partial K} (q_h \\cdot n - \\tau(u_h - \\widehat{u}_h)) v_u \\, dS = \\int_K f v_u \\, dK, \\quad \\forall v_u \\in Q_1(K)\n$$\nThese local equations are coupled globally through the trace variable $\\widehat{u}_h$.\n\nThe continuity constraints are entirely encoded in the definition of the trace space $\\widehat{U}_h$.\n\\begin{itemize}\n    \\item **Interior Vertices:** The degrees of freedom for $\\widehat{U}_h$ are the values of the function at the vertices of the mesh. For an interior vertex $V$, there is a single unknown value $\\widehat{u}_h(V)$. This value is shared by all edges incident to $V$, thereby enforcing $C^0$ continuity at the vertex.\n    \\item **Interior Edges:** For an interior edge $e$ with vertices $V_1$ and $V_2$, the function $\\widehat{u}_h|_e$ is the unique linear polynomial determined by the values $\\widehat{u}_{h}(V_1)$ and $\\widehat{u}_{h}(V_2)$. Since $\\widehat{u}_h$ is single-valued on the skeleton $\\mathcal{E}_h$, this same linear function serves as the trace for both elements sharing the edge $e$.\n    \\item **Dirichlet Boundary:** On the boundary of the domain $\\partial\\Omega$, the values of $\\widehat{u}_h$ are not unknown but are prescribed by the Dirichlet condition $u=g$. For any vertex $V \\in \\partial\\Omega$, the corresponding degree of freedom is fixed: $\\widehat{u}_h(V) = g(V)$. In this specific problem, $g=0$, so $\\widehat{u}_h(V) = 0$ for all vertices $V$ on the boundary. This implies $\\widehat{u}_h \\equiv 0$ on $\\partial\\Omega$.\n\\end{itemize}\n\nFinally, we consider the convergence rates. The problem defines the energy error and $L^2$ error as:\n$$\n\\text{Energy error} = \\left(\\sum_{K \\in \\mathcal{T}_h}\\|\\nabla(u-u_h)\\|_{L^2(K)}^2\\right)^{1/2}\n$$\n$$\nL^2 \\text{ error} = \\|u-u_h\\|_{L^2(\\Omega)}\n$$\nFor a sufficiently smooth exact solution $u$ and a quasi-uniform mesh sequence with mesh size $h \\to 0$, standard a priori error analysis for DG-type methods using polynomials of degree $k$ yields optimal convergence rates. The EDG method, as a member of the family of Hybridizable DG (HDG) methods, achieves these optimal rates.\nFor the $L^2$ error of the scalar variable, the convergence rate is one order higher than the polynomial degree used for the approximation.\n$$\n\\|u-u_h\\|_{L^2(\\Omega)} = O(h^{k+1})\n$$\nFor the energy error, in the sense of the broken $H^1$-seminorm, the rate is determined by the approximation properties of the polynomial gradient.\n$$\n\\left(\\sum_{K \\in \\mathcal{T}_h}\\|\\nabla(u-u_h)\\|_{L^2(K)}^2\\right)^{1/2} = O(h^k)\n$$\nWhile HDG/EDG methods are known for achieving an improved convergence rate of $O(h^{k+1})$ for the flux variable $q_h$, this high-order convergence does not generally carry over to the broken gradient $\\nabla u_h$ without special choices of parameters or post-processing.\nFor the specified polynomial degree $k=1$, the exponents for the error behavior are:\n\\begin{itemize}\n    \\item $r_E = k = 1$. The energy error behaves like $C h^1$.\n    \\item $r_{L^2} = k+1 = 2$. The $L^2$ error behaves like $C h^2$.\n\\end{itemize}\nThe ordered pair of exponents is $(r_E, r_{L^2}) = (1, 2)$.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1 & 2\n\\end{pmatrix}\n}\n$$", "id": "3383258"}, {"introduction": "A robust numerical method requires that the discrete algebraic system faithfully represents the continuous weak formulation. This practice focuses on a critical implementation detail: the numerical quadrature used to compute the integrals in the EDG bilinear form [@problem_id:3383256]. You will analyze the polynomial degrees of the different terms, including the crucial face stabilization terms, to determine the minimum quadrature strength needed to avoid integration errors and ensure the theoretical properties of the method are preserved.", "problem": "Consider the scalar Poisson problem on a Cartesian domain with an affine mesh of tensor-product elements (rectangles in two dimensions or hexahedra in three dimensions). Let the embedded discontinuous Galerkin (EDG) method be applied with interior element trial and test spaces given by polynomials of total degree at most $k$, denoted $P^{k}(K)$ on each element $K$, and with an embedded (continuous) trace space of degree at most $k$ on each face. Assume constant coefficients and an affine geometry mapping so that Jacobians are constant, and let the stabilization parameter $\\tau$ be a constant on each face. The symmetric EDG bilinear form consists of:\n- a volume term over each element $K$ involving products of gradients of trial and test functions,\n- face consistency terms involving normal fluxes paired with differences between interior and trace functions, and\n- face stabilization terms proportional to the product $(u_{h}-\\widehat{u}_{h})(v_{h}-\\widehat{v}_{h})$ on each face, where $u_{h},v_{h}\\in P^{k}(K)$ and $\\widehat{u}_{h},\\widehat{v}_{h}$ are their traces in the face space of degree at most $k$.\n\nQuadrature for volume integrals is taken as a tensor-product Gauss–Legendre rule with the same one-dimensional degree of exactness $q$ in each coordinate direction. Quadrature for face integrals is taken as a one-dimensional Gauss–Legendre rule of degree of exactness $q$ along the face parametric coordinate. The quadrature degree $q$ is defined as the largest integer such that the rule is exact for all one-dimensional polynomials up to degree $q$ in the corresponding integration variable.\n\nUsing only the definitions of the polynomial spaces $P^{k}$, the affine mapping assumption, and the structure of the EDG bilinear form described above, determine the minimal integer value of $q$ (as a closed-form function of $k$) that guarantees exact evaluation of all contributions of the EDG bilinear form (both volume and face integrals) on tensor-product elements when stabilization terms are present. Provide your final answer as a symbolic expression in $k$ with no units.", "solution": "The problem is valid. It is a well-posed question within the established field of numerical analysis for partial differential equations, specifically concerning the requirements for numerical quadrature in the context of the embedded discontinuous Galerkin (EDG) method. All terms are clearly defined, and the premises are scientifically and mathematically sound.\n\nThe objective is to determine the minimal integer value for the degree of exactness, $q$, of a one-dimensional Gauss-Legendre quadrature rule, such that the tensor-product rules constructed from it are sufficient to exactly integrate all terms in the symmetric EDG bilinear form for the Poisson problem. The analysis must consider both volume and face integrals. Exact integration is required, so we must find the maximum polynomial degree of any integrand that appears in the bilinear form.\n\nLet $K$ be a tensor-product element in the mesh, and let $\\hat{K}$ be the reference element (e.g., $[-1, 1]^d$ for dimension $d$). The problem states the mapping from $\\hat{K}$ to $K$ is affine, which implies that the Jacobian of the transformation, $J_K$, and its determinant, $\\det(J_K)$, are constant. Similarly, for any face $F$ of $K$, the face mapping from a reference face $\\hat{F}$ has a constant Jacobian determinant, which is the differential surface element scaling factor.\n\nThe trial and test functions, $u_h$ and $v_h$, belong to the space $P^{k}(K)$, which is the space of polynomials on $K$ of total degree at most $k$.\n\nFirst, we analyze the volume integral term of the bilinear form:\n$$\n\\int_{K} \\nabla u_h \\cdot \\nabla v_h \\, dV\n$$\nSince $u_h, v_h \\in P^{k}(K)$, their gradients, $\\nabla u_h$ and $\\nabla v_h$, are vector-valued polynomials whose components are polynomials of total degree at most $k-1$. The dot product, $\\nabla u_h \\cdot \\nabla v_h$, is therefore a scalar polynomial of total degree at most $(k-1) + (k-1) = 2k-2$. So, the integrand belongs to $P^{2k-2}(K)$.\nWhen transformed to the reference element $\\hat{K}$, the integral becomes:\n$$\n\\int_{\\hat{K}} (\\nabla_{\\hat{x}} \\hat{u}_h J_K^{-T}) \\cdot (\\nabla_{\\hat{x}} \\hat{v}_h J_K^{-T}) \\det(J_K) \\, d\\hat{V}\n$$\nwhere $\\hat{u}_h$ and $\\hat{v}_h$ are the polynomials on the reference element. Since the mapping is affine, $J_K$ is a constant matrix. The integrand on the reference element is a polynomial in the reference coordinates $\\hat{x}$. Its total degree is the same as the integrand on the physical element, which is $2k-2$.\n\nThe volume quadrature is a tensor-product rule formed from a $1$D Gauss-Legendre rule with degree of exactness $q$. This means the $1$D rule exactly integrates any polynomial of degree up to $q$. A tensor-product rule constructed from such $1$D rules on a $d$-dimensional domain is exact for all polynomials in the tensor-product space $Q_q = \\text{span}\\{x_1^{i_1} \\cdots x_d^{i_d} | 0 \\leq i_j \\leq q \\text{ for } j=1, \\dots, d\\}$. To guarantee exact integration of any polynomial of total degree $D$, we must ensure that $P^D \\subset Q_q$. A polynomial of total degree $D$ can contain a monomial of the form $x_j^D$. For this to be in $Q_q$, the exponent must be less than or equal to $q$, so we must have $q \\geq D$.\nFor the volume term, the integrand has a total degree of $D = 2k-2$. Thus, we require $q \\geq 2k-2$ for the volume integrals to be exact.\n\nNext, we analyze the face integral terms. These integrals are evaluated over the faces $F$ of the elements. The bilinear form includes consistency and stabilization terms.\nLet's first consider the stabilization term, which, as stated in the problem, is proportional to:\n$$\n\\int_F \\tau (u_h - \\widehat{u}_h)(v_h - \\widehat{v}_h) \\, dS\n$$\nHere, $u_h$ and $v_h$ are from $P^k(K)$, and their traces on the face $F$, denoted $u_h|_F$ and $v_h|_F$, are polynomials of total degree at most $k$ in the $(d-1)$ face coordinates. The trace-space functions, $\\widehat{u}_h$ and $\\widehat{v}_h$, are also polynomials of degree at most $k$ on the face $F$. Therefore, the differences $(u_h - \\widehat{u}_h)$ and $(v_h - \\widehat{v}_h)$ are polynomials on $F$ of total degree at most $k$. The parameter $\\tau$ is constant on the face. The product $(u_h - \\widehat{u}_h)(v_h - \\widehat{v}_h)$ is a polynomial on the face $F$ of total degree at most $k + k = 2k$.\n\nNow let's consider the consistency term, which has the form (up to a sign) of:\n$$\n\\int_F (\\nabla u_h \\cdot n) (v_h - \\widehat{v}_h) \\, dS\n$$\nThe normal vector $n$ is constant on the flat faces of the affine elements. The term $\\nabla u_h \\cdot n$ is a linear combination of the components of $\\nabla u_h$, which are polynomials of total degree at most $k-1$. Thus, $\\nabla u_h \\cdot n$ is a polynomial of total degree at most $k-1$. As established before, $(v_h - \\widehat{v}_h)$ is a polynomial of total degree at most $k$. The product, $(\\nabla u_h \\cdot n)(v_h - \\widehat{v}_h)$, is therefore a polynomial on the face $F$ of total degree at most $(k-1) + k = 2k-1$.\n\nComparing the face terms, the stabilization term integrand has a total degree of $2k$, while the consistency term integrand has a total degree of $2k-1$. The highest polynomial degree on a face is thus $2k$, arising from the stabilization term.\nThe face quadrature is a tensor-product rule over the $(d-1)$-dimensional reference face, constructed from the same $1$D rule with degree of exactness $q$. Following the same logic as for the volume integral, to exactly integrate a polynomial of total degree $D_{\\text{face}}=2k$ on the face, the $1$D rule's degree of exactness must satisfy $q \\geq D_{\\text{face}}$. Therefore, from the face integrals, we have the requirement $q \\geq 2k$.\n\nTo ensure all terms in the EDG bilinear form are integrated exactly, we must satisfy the requirements from both volume and face integrals.\nFrom the volume integral: $q \\geq 2k-2$.\nFrom the face integrals: $q \\geq 2k$.\nThe more restrictive condition is $q \\geq 2k$. The minimal integer value of $q$ that satisfies both conditions is therefore $2k$.", "answer": "$$\n\\boxed{2k}\n$$", "id": "3383256"}, {"introduction": "The true power of a numerical method is revealed in its performance on challenging problems, such as those involving anisotropic media or meshes. This exercise explores the crucial role of the stabilization parameter $\\tau_F$ in maintaining stability and accuracy in such scenarios [@problem_id:3383210]. By analyzing the stability requirements for an anisotropic diffusion problem, you will learn how to design a parameter scaling that correctly adapts to local physics and geometry, ensuring the EDG method remains robust and optimally convergent.", "problem": "Consider the scalar diffusion problem on a rectangular domain $\\Omega \\subset \\mathbb{R}^2$ with homogeneous Dirichlet boundary conditions: find $u$ such that\n$$\n-\\nabla \\cdot \\left(\\mathbf{A}\\,\\nabla u\\right) = f \\quad \\text{in } \\Omega, \n\\qquad u = 0 \\quad \\text{on } \\partial\\Omega,\n$$\nwhere the diffusion tensor is the symmetric positive definite diagonal matrix $\\mathbf{A} = \\mathrm{diag}(a_x, a_y)$ with $a_x>0$ and $a_y>0$. Let $\\mathcal{T}_h$ be a shape-regular partition of $\\Omega$ into axis-aligned rectangles of side lengths $h_x$ and $h_y$, with possible anisotropy $h_x \\neq h_y$ but with bounded aspect ratio across the mesh.\n\nWe consider an embedded discontinuous Galerkin (EDG) method of polynomial degree $k \\ge 1$ on $\\mathcal{T}_h$, where the elementwise unknown $u_h$ and the globally single-valued trace $\\widehat{u}_h$ on the mesh skeleton are coupled by a face-based stabilization (also called embedding) parameter $\\tau_F>0$ on each face $F$. On every interior face $F$ with unit normal $\\mathbf{n}_F$, the numerical normal flux has the form\n$$\n-\\mathbf{A}\\,\\nabla u_h \\cdot \\mathbf{n}_F \\;+\\; \\tau_F\\,(u_h - \\widehat{u}_h),\n$$\nwith a consistent choice on boundary faces. Assume $\\tau_F$ may depend on local element sizes and on $\\mathbf{A}$, and that the mesh is uniform so that each vertical face is shared by two rectangles of width $h_x$ and each horizontal face is shared by two rectangles of height $h_y$. Define the mesh size normal to $F$ by $h_{n,F}$, so that $h_{n,F} = h_x$ on vertical faces and $h_{n,F} = h_y$ on horizontal faces, and define the normal diffusivity $\\kappa_F := \\mathbf{n}_F^\\top \\mathbf{A} \\mathbf{n}_F$.\n\nStarting from the definition of the EDG bilinear form, the elementwise integration by parts, the Cauchy–Schwarz and Young inequalities, the anisotropic trace inequality on rectangles, and the standard polynomial inverse inequality, determine a face-wise anisotropic scaling for $\\tau_F$ that is sufficient to guarantee uniform coercivity of the EDG bilinear form with constants independent of the aspect ratio $h_x/h_y$, and that preserves optimal convergence rates in the broken energy norm and the $L^2$ norm under standard regularity assumptions. Your proposed scaling should be expressed in terms of $k$, $\\kappa_F$, and $h_{n,F}$, and should reduce on vertical faces to a scaling involving $a_x$ and $h_x$, and on horizontal faces to a scaling involving $a_y$ and $h_y$. Among the following options, select the one that meets these criteria and does not over-penalize faces in directions where the element is long, so that the condition number of the condensed EDG system remains optimally proportional to the square of the inverse face-normal mesh size.\n\nWhich choice for $\\tau_F$ is appropriate?\n\nA. $\\tau_F \\simeq C\\,(k+1)\\,\\dfrac{\\sqrt{\\mathbf{n}_F^\\top \\mathbf{A} \\mathbf{n}_F}}{h_{t,F}}$, where $h_{t,F}$ is the mesh size tangential to $F$ and $C>0$ is a generic constant independent of $h_x$, $h_y$, $a_x$, $a_y$, and $k$.\n\nB. $\\tau_F \\simeq C\\,(k+1)^2\\,\\dfrac{\\mathbf{n}_F^\\top \\mathbf{A} \\mathbf{n}_F}{h_{n,F}}$, with the face value taken as the maximum of the contributions from the two neighboring elements when $h_{n,F}$ differs across the face; on a uniform rectangular mesh, this reduces to $\\tau_F \\simeq C\\,(k+1)^2\\,a_x/h_x$ on vertical faces and $\\tau_F \\simeq C\\,(k+1)^2\\,a_y/h_y$ on horizontal faces.\n\nC. $\\tau_F \\simeq C\\,(k+1)^2\\,\\dfrac{\\mathrm{tr}(\\mathbf{A})}{(h_x + h_y)}$, applied uniformly on all faces regardless of orientation.\n\nD. $\\tau_F \\simeq C\\,(k+1)^2\\,\\max\\!\\left(\\dfrac{a_x}{h_x},\\,\\dfrac{a_y}{h_y}\\right)$, applied uniformly on all faces regardless of orientation.\n\nE. $\\tau_F \\simeq C\\,(k+1)^2\\,\\big(\\mathbf{n}_F^\\top \\mathbf{A} \\mathbf{n}_F\\big)\\,h_{n,F}$, with $C>0$ independent of $h_x$, $h_y$, $a_x$, $a_y$, and $k$.\n\nSelect the correct option.", "solution": "The embedded discontinuous Galerkin (EDG) method is a type of hybridizable discontinuous Galerkin (HDG) method. The stability and convergence analysis hinges on the proper choice of the stabilization parameter, $\\tau_F$, which weakly enforces continuity of the solution across element faces. The problem asks for an anisotropic scaling of $\\tau_F$ for a diffusion problem with an anisotropic tensor $\\mathbf{A}$ on a mesh with anisotropic elements. The scaling must ensure uniform coercivity of the resulting global system for the trace variable $\\widehat{u}_h$, preserve optimal convergence rates, and maintain good conditioning of the global matrix, with constants independent of the mesh aspect ratio $h_x/h_y$ and the diffusion anisotropy $a_x/a_y$.\n\nThe derivation of the stabilization parameter arises from the stability analysis of the method. For the global system on the trace variable $\\widehat{u}_h$ to be coercive, certain terms arising from integration by parts must be controlled. In the analysis of DG-type methods, a key step involves bounding face integral terms by volume integrals. Let's analyze the critical term. The coercivity proof, after some algebra, requires bounding a term of the form $\\sum_{K \\in \\mathcal{T}_h} \\sum_{F \\subset \\partial K} \\frac{1}{\\tau_F} \\| \\mathbf{n}_F \\cdot (\\mathbf{A}\\nabla u_h)\\|^2_{L^2(F)}$ by a fraction of the natural energy norm term $\\sum_{K \\in \\mathcal{T}_h} \\|\\mathbf{A}^{1/2} \\nabla u_h\\|^2_{L^2(K)}$. This requires an inequality of the form:\n$$\n\\| \\mathbf{n}_F \\cdot (\\mathbf{A}\\nabla v_h)\\|^2_{L^2(F)} \\le C_{inv} \\frac{\\kappa_F}{h_{n,F}} \\|\\mathbf{A}^{1/2} \\nabla v_h\\|^2_{L^2(K)}\n$$\nfor any polynomial $v_h$ of degree $k$ on element $K$, where $F$ is a face of $K$. Here, $C_{inv}$ is a constant that depends on the polynomial degree $k$ but is independent of the element geometry ($h_x$, $h_y$) and the diffusion tensor ($\\mathbf{A}$). This is a form of an anisotropic trace inverse inequality. The polynomial degree dependence is well-known to be quadratic, i.e., $C_{inv} \\propto (k+1)^2$.\n\nTo see why this inequality holds, consider a rectangular element $K$ with side lengths $h_x$ and $h_y$, and a vertical face $F$ (so $\\mathbf{n}_F = (\\pm 1, 0)^\\top$). On this face, $h_{n,F} = h_x$ and the normal diffusivity is $\\kappa_F = \\mathbf{n}_F^\\top\\mathbf{A}\\mathbf{n}_F = a_x$. The quantity to be bounded is $\\|a_x \\partial_x v_h\\|^2_{L^2(F)}$. By scaling to a reference element $\\hat{K}$, applying a trace inequality for polynomials and their derivatives, and then scaling back to the physical element $K$, one can show that:\n$$\n\\|a_x \\partial_x v_h\\|^2_{L^2(F)} \\le C(k+1)^2 \\frac{a_x}{h_x} \\left( a_x \\|\\partial_x v_h\\|^2_{L^2(K)} + a_y \\|\\partial_y v_h\\|^2_{L^2(K)} \\right)\n$$\nThe term on the right is exactly $C(k+1)^2 \\frac{\\kappa_F}{h_{n,F}} \\|\\mathbf{A}^{1/2} \\nabla v_h\\|^2_{L^2(K)}$.\nA similar argument holds for horizontal faces.\n\nFor stability, we must choose $\\tau_F$ large enough to control the term arising from the trace inequality. Specifically, to make $\\sum_{K,F}\\frac{1}{\\tau_F} \\| \\mathbf{n}_F \\cdot (\\mathbf{A}\\nabla v_h)\\|^2_{L^2(F)}$ absorbable into $\\sum_K \\|\\mathbf{A}^{1/2} \\nabla v_h\\|^2_{L^2(K)}$, we need to select $\\tau_F$ such that:\n$$\n\\tau_F \\ge C_0 (k+1)^2 \\frac{\\kappa_F}{h_{n,F}}\n$$\nfor a sufficiently large constant $C_0 > 0$. This choice ensures that the coercivity constant of the global system for $\\widehat{u}_h$ is independent of the aspect ratio $h_x/h_y$ and diffusion anisotropy $a_x/a_y$.\n\nThis scaling is also known to be optimal. A smaller $\\tau_F$ (e.g., with a lower power of $(k+1)$ or a different dependence on $h$ or $\\mathbf{A}$) would fail to provide uniform stability. A significantly larger $\\tau_F$ (over-penalization) would degrade the constant in the approximation error bounds and pollute the solution, leading to suboptimal convergence. It would also increase the condition number of the system matrix unnecessarily. This specific choice does not over-penalize faces, since on a face $F$, the penalty depends only on the mesh size $h_{n,F}$ normal to it and the diffusivity $\\kappa_F$ in that normal direction. This property is crucial for maintaining an optimal condition number for the condensed system, which should scale as $\\max_{F} (h_{n,F}^{-2})$ independently of any anisotropy.\n\nLet's check the given options based on this derivation. The appropriate scaling for $\\tau_F$ is proportional to $(k+1)^2 \\frac{\\kappa_F}{h_{n,F}}$.\n\n**Option A: $\\tau_F \\simeq C\\,(k+1)\\,\\dfrac{\\sqrt{\\mathbf{n}_F^\\top \\mathbf{A} \\mathbf{n}_F}}{h_{t,F}}$**\nThis option has several flaws.\n1. The polynomial degree dependence is $(k+1)$, which is insufficient for stability for general $k \\ge 1$. The inverse inequality introduces a $(k+1)^2$ factor.\n2. The dependence on the normal diffusivity $\\kappa_F = \\mathbf{n}_F^\\top \\mathbf{A} \\mathbf{n}_F$ is via its square root, $\\sqrt{\\kappa_F}$, which is incorrect. The scaling should be linear with $\\kappa_F$.\n3. The mesh size dependence is on $h_{t,F}^{-1}$, the inverse of the *tangential* mesh size. For anisotropic elements, stability requires dependence on the *normal* mesh size $h_{n,F}^{-1}$. Using $h_{t,F}$ would make the stabilization parameter too small on elements that are short in the normal direction but long in the tangential one, leading to a loss of uniform stability.\n**Verdict: Incorrect.**\n\n**Option B: $\\tau_F \\simeq C\\,(k+1)^2\\,\\dfrac{\\mathbf{n}_F^\\top \\mathbf{A} \\mathbf{n}_F}{h_{n,F}}$, with the face value taken as the maximum of the contributions from the two neighboring elements when $h_{n,F}$ differs across the face; on a uniform rectangular mesh, this reduces to $\\tau_F \\simeq C\\,(k+1)^2\\,a_x/h_x$ on vertical faces and $\\tau_F \\simeq C\\,(k+1)^2\\,a_y/h_y$ on horizontal faces.**\nThis is precisely the scaling derived from the stability analysis.\n1. The dependence on polynomial degree is $(k+1)^2$.\n2. The dependence on diffusivity is linear in $\\kappa_F = \\mathbf{n}_F^\\top \\mathbf{A} \\mathbf{n}_F$.\n3. The dependence on mesh size is on $h_{n,F}^{-1}$, the inverse of the normal mesh size.\nThis choice ensures uniform coercivity, leads to optimal error estimates, and does not over-penalize, thus preserving the optimal conditioning of the condensed system. The specified reduction for a uniform rectangular mesh is also correct: on a vertical face, $\\kappa_F = a_x$ and $h_{n,F}=h_x$; on a horizontal face, $\\kappa_F = a_y$ and $h_{n,F}=h_y$.\n**Verdict: Correct.**\n\n**Option C: $\\tau_F \\simeq C\\,(k+1)^2\\,\\dfrac{\\mathrm{tr}(\\mathbf{A})}{(h_x + h_y)}$, applied uniformly on all faces regardless of orientation.**\nThis is an isotropic scaling, as it does not depend on the face orientation $\\mathbf{n}_F$. It uses an arithmetic average of mesh sizes and the trace of the diffusion tensor, $\\mathrm{tr}(\\mathbf{A}) = a_x + a_y$. If an element is highly anisotropic, e.g., $h_x \\ll h_y$, then on a vertical face, stability requires a penalty proportional to $a_x/h_x$. This formula provides a penalty of about $(a_x+a_y)/h_y$, which can be arbitrarily smaller than required, leading to loss of stability. Thus, it fails to provide uniform coercivity.\n**Verdict: Incorrect.**\n\n**Option D: $\\tau_F \\simeq C\\,(k+1)^2\\,\\max\\!\\left(\\dfrac{a_x}{h_x},\\,\\dfrac{a_y}{h_y}\\right)$, applied uniformly on all faces regardless of orientation.**\nThis is another isotropic scaling. While it will likely guarantee coercivity (by taking the maximum penalty required over all possible orientations), it violates the criterion of not over-penalizing. For example, if $a_x/h_x \\gg a_y/h_y$, this scaling applies the large penalty $\\sim a_x/h_x$ to *all* faces, including horizontal ones where only a smaller penalty $\\sim a_y/h_y$ is needed. This over-penalization degrades the accuracy constants in the error estimates and, critically, worsens the condition number of the global system, making it dependent on the aspect ratios.\n**Verdict: Incorrect.**\n\n**Option E: $\\tau_F \\simeq C\\,(k+1)^2\\,\\big(\\mathbf{n}_F^\\top \\mathbf{A} \\mathbf{n}_F\\big)\\,h_{n,F}$, with $C>0$ independent of $h_x$, $h_y$, $a_x$, $a_y$, and $k$.**\nThis scaling suggests $\\tau_F \\simeq C(k+1)^2 \\kappa_F h_{n,F}$. The mesh size dependence is $h_{n,F}$, not $h_{n,F}^{-1}$. As the mesh is refined ($h_{n,F} \\to 0$), this stabilization parameter vanishes. A vanishing penalty cannot provide control over the jump terms or flux terms, so the method would not be stable. The penalty parameter must be sufficiently large, not small. The minor inconsistency that $C$ is said to be independent of $k$ while the formula contains $(k+1)^2$ does not change the fact that the scaling with $h_{n,F}$ is fundamentally wrong.\n**Verdict: Incorrect.**", "answer": "$$\\boxed{B}$$", "id": "3383210"}]}