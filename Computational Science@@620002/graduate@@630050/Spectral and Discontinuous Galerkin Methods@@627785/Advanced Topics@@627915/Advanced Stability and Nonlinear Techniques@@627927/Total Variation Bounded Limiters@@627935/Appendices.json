{"hands_on_practices": [{"introduction": "In Discontinuous Galerkin (DG) methods, the solution within each cell is represented by a polynomial. For high-order accuracy, we want this polynomial to be as faithful as possible to the underlying solution, but to prevent spurious oscillations near discontinuities, we may need to \"limit\" its high-order components. This first exercise establishes the fundamental connection between the intuitive physical slope of a linear element and its corresponding modal coefficient in the Legendre basis, which is the quantity directly targeted by most limiters [@problem_id:3424008].", "problem": "Consider a one-dimensional Discontinuous Galerkin (DG) method of polynomial degree $p=1$ for a scalar conservation law on a uniform mesh, and focus on a single cell $I_j=[x_{j-\\frac{1}{2}},x_{j+\\frac{1}{2}}]$ of length $h_j=x_{j+\\frac{1}{2}}-x_{j-\\frac{1}{2}}$ and center $x_j=\\frac{1}{2}\\left(x_{j-\\frac{1}{2}}+x_{j+\\frac{1}{2}}\\right)$. The DG solution restricted to $I_j$ is represented in a conservative linear form as $u_h|_{I_j}(x)=\\bar{u}_j+\\sigma_j\\,(x-x_j)$, where $\\bar{u}_j$ is the cell average and $\\sigma_j$ is the cell slope. Let the cell be mapped to the reference element via the affine transformation $x=x_j+\\frac{h_j}{2}\\,\\xi$, with $\\xi\\in[-1,1]$. On the reference element, consider the Legendre polynomial basis $\\{P_0(\\xi),P_1(\\xi)\\}$ with $P_0(\\xi)=1$ and $P_1(\\xi)=\\xi$, and define the modal coefficients by the $L^2$ projection with respect to the standard inner product on $[-1,1]$. That is, write\n$$\nu_h(x(\\xi))=\\hat{u}_{j,0}\\,P_0(\\xi)+\\hat{u}_{j,1}\\,P_1(\\xi),\n$$\nwhere the coefficients $\\hat{u}_{j,0}$ and $\\hat{u}_{j,1}$ are the Legendre modal coefficients. Use the orthogonality of the Legendre polynomials, namely $\\int_{-1}^{1}P_m(\\xi)\\,P_n(\\xi)\\,d\\xi=\\frac{2}{2n+1}\\,\\delta_{mn}$, and the reference mapping to derive, from first principles, a closed-form expression that maps the physical slope $\\sigma_j$ to the first modal coefficient $\\hat{u}_{j,1}$. Your final answer must be a single analytic expression in terms of $\\sigma_j$ and $h_j$. No rounding is required, and no physical units are involved. Also briefly explain why this mapping is the one targeted by Total Variation Bounded (TVB) limiters in degree $p=1$ DG schemes.", "solution": "The problem is valid. It is a well-posed, scientifically grounded problem in the field of numerical analysis for partial differential equations. All necessary information is provided, and the objective is a formal derivation based on standard principles of the Discontinuous Galerkin (DG) method.\n\nThe primary objective is to derive the relationship between the physical slope, $\\sigma_j$, and the first Legendre modal coefficient, $\\hat{u}_{j,1}$, for a DG solution of polynomial degree $p=1$ in a cell $I_j$.\n\nThe solution $u_h$ within the cell $I_j$ is represented in two equivalent forms. In physical coordinates $x \\in I_j = [x_{j-\\frac{1}{2}}, x_{j+\\frac{1}{2}}]$, the representation is:\n$$\nu_h(x) = \\bar{u}_j + \\sigma_j (x - x_j)\n$$\nwhere $\\bar{u}_j$ is the cell average, $\\sigma_j$ is the cell slope, and $x_j$ is the cell center.\n\nThe cell $I_j$ is mapped to the reference element $\\xi \\in [-1, 1]$ via the affine transformation:\n$$\nx(\\xi) = x_j + \\frac{h_j}{2} \\xi\n$$\nwhere $h_j$ is the length of cell $I_j$. By substituting this mapping into the physical representation, we can express the solution as a function of the reference coordinate $\\xi$:\n$$\nu_h(x(\\xi)) = \\bar{u}_j + \\sigma_j \\left( \\left(x_j + \\frac{h_j}{2} \\xi\\right) - x_j \\right) = \\bar{u}_j + \\sigma_j \\frac{h_j}{2} \\xi\n$$\n\nIn the reference element, the solution is also represented in a modal form using the Legendre polynomial basis $\\{P_0(\\xi), P_1(\\xi)\\}$, where $P_0(\\xi) = 1$ and $P_1(\\xi) = \\xi$:\n$$\nu_h(x(\\xi)) = \\hat{u}_{j,0} P_0(\\xi) + \\hat{u}_{j,1} P_1(\\xi) = \\hat{u}_{j,0} + \\hat{u}_{j,1} \\xi\n$$\nwhere $\\hat{u}_{j,0}$ and $\\hat{u}_{j,1}$ are the modal coefficients.\n\nThe problem states that the modal coefficients are determined by the $L^2$ projection of the solution onto the basis functions. The formula for the projection of a function $f(\\xi)$ onto an orthogonal basis function $P_n(\\xi)$ over the interval $[-1, 1]$ is:\n$$\n\\hat{f}_n = \\frac{\\langle f, P_n \\rangle}{\\langle P_n, P_n \\rangle} = \\frac{\\int_{-1}^{1} f(\\xi) P_n(\\xi) d\\xi}{\\int_{-1}^{1} P_n(\\xi)^2 d\\xi}\n$$\n\nWe apply this formula to find the coefficient $\\hat{u}_{j,1}$:\n$$\n\\hat{u}_{j,1} = \\frac{\\int_{-1}^{1} u_h(x(\\xi)) P_1(\\xi) d\\xi}{\\int_{-1}^{1} P_1(\\xi)^2 d\\xi}\n$$\n\nThe denominator is given by the orthogonality property of Legendre polynomials provided in the problem statement: $\\int_{-1}^{1}P_m(\\xi)P_n(\\xi)d\\xi = \\frac{2}{2n+1}\\delta_{mn}$. For $n=1$, this gives:\n$$\n\\int_{-1}^{1} P_1(\\xi)^2 d\\xi = \\frac{2}{2(1)+1} = \\frac{2}{3}\n$$\nThus, the expression for $\\hat{u}_{j,1}$ simplifies to:\n$$\n\\hat{u}_{j,1} = \\frac{3}{2} \\int_{-1}^{1} u_h(x(\\xi)) P_1(\\xi) d\\xi\n$$\n\nNow, we substitute the expressions for $u_h(x(\\xi))$ and $P_1(\\xi) = \\xi$ into the integral:\n$$\n\\hat{u}_{j,1} = \\frac{3}{2} \\int_{-1}^{1} \\left(\\bar{u}_j + \\sigma_j \\frac{h_j}{2} \\xi\\right) \\xi \\,d\\xi\n$$\nWe expand the integrand:\n$$\n\\hat{u}_{j,1} = \\frac{3}{2} \\int_{-1}^{1} \\left(\\bar{u}_j \\xi + \\sigma_j \\frac{h_j}{2} \\xi^2\\right) d\\xi\n$$\nUsing the linearity of the integral, we can split it into two parts:\n$$\n\\hat{u}_{j,1} = \\frac{3}{2} \\left( \\int_{-1}^{1} \\bar{u}_j \\xi \\,d\\xi + \\int_{-1}^{1} \\sigma_j \\frac{h_j}{2} \\xi^2 \\,d\\xi \\right)\n$$\nThe first integral, $\\int_{-1}^{1} \\bar{u}_j \\xi \\,d\\xi$, is the integral of an odd function ($\\xi$) over a symmetric interval, which is zero.\n$$\n\\int_{-1}^{1} \\bar{u}_j \\xi \\,d\\xi = \\bar{u}_j \\left[ \\frac{\\xi^2}{2} \\right]_{-1}^{1} = \\bar{u}_j \\left(\\frac{1}{2} - \\frac{1}{2}\\right) = 0\n$$\nThe second integral is:\n$$\n\\int_{-1}^{1} \\sigma_j \\frac{h_j}{2} \\xi^2 \\,d\\xi = \\sigma_j \\frac{h_j}{2} \\int_{-1}^{1} \\xi^2 \\,d\\xi = \\sigma_j \\frac{h_j}{2} \\left[ \\frac{\\xi^3}{3} \\right]_{-1}^{1} = \\sigma_j \\frac{h_j}{2} \\left(\\frac{1}{3} - \\frac{-1}{3}\\right) = \\sigma_j \\frac{h_j}{2} \\left(\\frac{2}{3}\\right) = \\sigma_j \\frac{h_j}{3}\n$$\nSubstituting this result back into the expression for $\\hat{u}_{j,1}$:\n$$\n\\hat{u}_{j,1} = \\frac{3}{2} \\left( 0 + \\sigma_j \\frac{h_j}{3} \\right) = \\frac{3}{2} \\left( \\frac{\\sigma_j h_j}{3} \\right)\n$$\nSimplifying this expression gives the final mapping from the physical slope $\\sigma_j$ to the modal coefficient $\\hat{u}_{j,1}$:\n$$\n\\hat{u}_{j,1} = \\frac{1}{2} \\sigma_j h_j\n$$\n\nRegarding the connection to Total Variation Bounded (TVB) limiters:\nFor discontinuous solutions of hyperbolic conservation laws, high-order numerical methods like DG can produce spurious oscillations (Gibbs phenomenon) near shocks or sharp gradients. Limiters are designed to suppress these oscillations to maintain physical realism and numerical stability. For a scalar conservation law, the total variation (TV) of the exact solution is non-increasing in time. TVD (Total Variation Diminishing) and TVB (Total Variation Bounded) schemes aim to enforce a similar property on the numerical solution.\nIn a $p=1$ DG scheme, the solution in cell $I_j$ consists of a cell average $\\bar{u}_j$ and a linear part characterized by the slope $\\sigma_j$. The cell average $\\bar{u}_j$ represents the conserved quantity and is fundamental to the scheme's conservation property; it is generally not modified by the limiter. The slope $\\sigma_j$, representing the higher-order component of the solution, is responsible for creating potential overshoots and undershoots. Therefore, limiters for $p=1$ DG focus on modifying or \"limiting\" this slope.\nThe derived relationship, $\\hat{u}_{j,1} = \\frac{1}{2} \\sigma_j h_j$, demonstrates that the first modal coefficient $\\hat{u}_{j,1}$ is directly proportional to the physical slope $\\sigma_j$ (scaled by the cell size $h_j$). This direct proportionality is crucial. It means that limiting the magnitude of the modal coefficient $\\hat{u}_{j,1}$ is mathematically equivalent to limiting the magnitude of the physical slope $\\sigma_j$. TVB limiters, such as the widely used minmod-based limiter, operate by comparing the current modal coefficient $\\hat{u}_{j,1}$ to quantities derived from the differences in cell averages of neighboring cells. This comparison determines if the slope is 'too steep' and risks causing an oscillation. If so, $\\hat{u}_{j,1}$ is replaced by a 'limited' value, which in turn reduces the physical slope $\\sigma_j$, locally driving the scheme towards a non-oscillatory, first-order accurate constant state within the cell. The derived mapping is thus the fundamental link that allows the physical concept of slope limiting to be implemented computationally in the modal space of the DG method.", "answer": "$$\n\\boxed{\\frac{1}{2}\\sigma_j h_j}\n$$", "id": "3424008"}, {"introduction": "The power of a Total Variation Bounded (TVB) limiter lies in its ability to distinguish between spurious oscillations and genuine, smooth extrema of a solution. The key to this is the parameter $M$, which sets a threshold based on the local mesh size $h$ for how much curvature, approximated by second differences of cell averages, is acceptable. This practice guides you through the analytical derivation of an optimal $M$ for a known smooth solution, revealing how the limiter can be tuned to preserve high-order accuracy where the solution is well-behaved [@problem_id:3424065].", "problem": "Consider the one-dimensional scalar balance law $u_{t} + (f(u))_{x} = s(x)$ on a periodic domain with uniform mesh spacing $h>0$, where the numerical method is a piecewise linear Discontinuous Galerkin (DG) scheme using a Total Variation Bounded (TVB) slope limiter. Let the flux be $f(u) = \\frac{1}{2}u^{2}$ and consider the manufactured steady solution $u(x) = A \\sin(k x)$ with amplitude $A>0$ and wavenumber $k>0$, together with the source term $s(x) = (f(u(x)))_{x}$ so that $(f(u))_{x} - s(x) = 0$ and the flux gradient and source exactly balance for all $x$.\n\nIn the TVB limiter, the modified minmod function uses a smoothness sensor based on second differences of cell averages. Denote the cell average in cell $I_{i}$ by $\\bar{u}_{i}$. The limiter is taken to be inactive in cell $I_{i}$ if the smoothness condition\n$$\n|\\bar{u}_{i+1} - 2\\bar{u}_{i} + \\bar{u}_{i-1}| \\le M h^{2}\n$$\nholds, where $M>0$ is a user-chosen TVB parameter. Otherwise, the limiter activates and reduces the slope. Assume the mesh is sufficiently fine that $u(x)$ is well-resolved and that the DG reconstruction without limiting recovers the correct local slope in smooth regions.\n\nStarting from the Taylor expansion of smooth solutions and the definition of the above TVB smoothness sensor, derive an analytical expression for the minimal $M$ as a function of $A$ and $k$ that guarantees the limiter remains inactive in all smooth regions of the manufactured steady solution (i.e., everywhere, since $(f(u))_{x} - s(x) = 0$ identically) for sufficiently small $h$. Your final answer must be a single closed-form expression in $A$ and $k$, with no numerical approximation or rounding.", "solution": "The user has posed a problem concerning the determination of a parameter in a Total Variation Bounded (TVB) limiter for a Discontinuous Galerkin (DG) numerical scheme. The goal is to find the minimum value of the TVB parameter $M$ that prevents the limiter from activating on a known smooth, steady-state solution.\n\nThe problem statement has been validated and is deemed to be scientifically grounded, well-posed, and objective. It represents a standard analysis in the field of numerical methods for partial differential equations.\n\nThe core of the problem lies in the TVB smoothness sensor condition, which dictates that the slope limiter is inactive in cell $I_i$ if the following inequality holds:\n$$\n|\\bar{u}_{i+1} - 2\\bar{u}_{i} + \\bar{u}_{i-1}| \\le M h^{2}\n$$\nHere, $\\bar{u}_i$ is the average of the solution $u(x)$ over the cell $I_i = [x_{i-1/2}, x_{i+1/2}]$, $h = x_{i+1/2} - x_{i-1/2}$ is the uniform mesh spacing, and $M$ is the TVB parameter. We are asked to find the minimal $M > 0$ that ensures this condition is met for all cells $i$, given the smooth manufactured solution $u(x) = A \\sin(k x)$.\n\nLet $x_i$ be the center of cell $I_i$. The cell average $\\bar{u}_i$ is defined as:\n$$\n\\bar{u}_i = \\frac{1}{h} \\int_{x_i - h/2}^{x_i + h/2} u(x) \\, dx\n$$\nFor a smooth function $u(x)$ and a small mesh size $h$, we can expand $u(x)$ in a Taylor series around $x_i$:\n$$\nu(x) = u(x_i) + u'(x_i)(x-x_i) + \\frac{u''(x_i)}{2!}(x-x_i)^2 + \\frac{u'''(x_i)}{3!}(x-x_i)^3 + \\dots\n$$\nSubstituting this into the integral for the cell average gives:\n$$\n\\bar{u}_i = \\frac{1}{h} \\int_{x_i - h/2}^{x_i + h/2} \\left( u(x_i) + u'(x_i)(x-x_i) + \\frac{u''(x_i)}{2}(x-x_i)^2 + \\dots \\right) dx\n$$\nUpon integration, terms with odd powers of $(x-x_i)$ vanish due to the symmetry of the interval $[-h/2, h/2]$.\n$$\n\\bar{u}_i = \\frac{1}{h} \\left[ u(x_i)h + u'(x_i) \\cdot 0 + \\frac{u''(x_i)}{2} \\frac{h^3}{12} + \\frac{u^{(4)}(x_i)}{24} \\frac{h^5}{80} + \\dots \\right]\n$$\nThis results in the well-known expansion for the cell average:\n$$\n\\bar{u}_i = u(x_i) + \\frac{h^2}{24} u''(x_i) + O(h^4)\n$$\nNow, we must analyze the central difference term $|\\bar{u}_{i+1} - 2\\bar{u}_{i} + \\bar{u}_{i-1}|$. Let's substitute the expansion for each average. The cell centers are located at $x_{i-1} = x_i - h$, $x_i$, and $x_{i+1} = x_i + h$.\n\\begin{align*}\n\\bar{u}_{i+1} - 2\\bar{u}_{i} + \\bar{u}_{i-1} &= \\left( u(x_{i+1}) + \\frac{h^2}{24} u''(x_{i+1}) + O(h^4) \\right) \\\\\n&\\quad - 2 \\left( u(x_i) + \\frac{h^2}{24} u''(x_i) + O(h^4) \\right) \\\\\n&\\quad + \\left( u(x_{i-1}) + \\frac{h^2}{24} u''(x_{i-1}) + O(h^4) \\right)\n\\end{align*}\nGrouping terms by the function being differenced:\n$$\n\\bar{u}_{i+1} - 2\\bar{u}_{i} + \\bar{u}_{i-1} = (u(x_{i+1}) - 2u(x_i) + u(x_{i-1})) + \\frac{h^2}{24}(u''(x_{i+1}) - 2u''(x_i) + u''(x_{i-1})) + O(h^6)\n$$\nThe expressions in parentheses are standard second-order central difference approximations. Their Taylor series expansions are:\n$$\nu(x_{i+1}) - 2u(x_i) + u(x_{i-1}) = h^2 u''(x_i) + \\frac{h^4}{12} u^{(4)}(x_i) + O(h^6)\n$$\n$$\nu''(x_{i+1}) - 2u''(x_i) + u''(x_{i-1}) = h^2 (u'')''(x_i) + O(h^4) = h^2 u^{(4)}(x_i) + O(h^4)\n$$\nSubstituting these back into the expression for the difference of averages:\n$$\n\\bar{u}_{i+1} - 2\\bar{u}_{i} + \\bar{u}_{i-1} = \\left( h^2 u''(x_i) + \\frac{h^4}{12} u^{(4)}(x_i) \\right) + \\frac{h^2}{24} \\left( h^2 u^{(4)}(x_i) \\right) + O(h^6)\n$$\n$$\n\\bar{u}_{i+1} - 2\\bar{u}_{i} + \\bar{u}_{i-1} = h^2 u''(x_i) + \\left( \\frac{1}{12} + \\frac{1}{24} \\right) h^4 u^{(4)}(x_i) + O(h^6) = h^2 u''(x_i) + O(h^4)\n$$\nThe problem states the analysis is for \"sufficiently small $h$,\" which implies we are concerned with the leading-order behavior. The smoothness condition becomes:\n$$\n|h^2 u''(x_i) + O(h^4)| \\le M h^2\n$$\nDividing by $h^2$:\n$$\n|u''(x_i) + O(h^2)| \\le M\n$$\nFor this inequality to hold for any given $x_i$ as $h \\to 0$, we must have:\n$$\n|u''(x_i)| \\le M\n$$\nTo ensure the limiter remains inactive for the entire smooth solution, this condition must be satisfied for all possible cell locations $x_i$. As the mesh is refined, the set of cell centers $\\{x_i\\}$ becomes dense in the domain. Therefore, the parameter $M$ must be chosen to satisfy:\n$$\nM \\ge \\sup_{x} |u''(x)|\n$$\nThe minimal value of $M$ that guarantees the limiter is never active on the smooth solution is thus the supremum (or maximum, since the function is continuous on a compact domain implicit in the periodic setup) of the absolute value of the second derivative of the solution.\n$$\nM_{min} = \\max_x |u''(x)|\n$$\nWe are given the manufactured solution $u(x) = A \\sin(k x)$. We compute its first and second derivatives:\nFirst derivative:\n$$\nu'(x) = \\frac{d}{dx} (A \\sin(k x)) = A k \\cos(k x)\n$$\nSecond derivative:\n$$\nu''(x) = \\frac{d}{dx} (A k \\cos(k x)) = -A k^2 \\sin(k x)\n$$\nNow, we find the maximum absolute value of $u''(x)$:\n$$\n|u''(x)| = |-A k^2 \\sin(k x)|\n$$\nGiven that $A > 0$ and $k > 0$, the term $A k^2$ is a positive constant.\n$$\n|u''(x)| = A k^2 |\\sin(k x)|\n$$\nThe maximum value of the function $|\\sin(\\theta)|$ is $1$. Therefore, the maximum value of $|u''(x)|$ is:\n$$\n\\max_x |u''(x)| = A k^2 \\cdot \\max_x |\\sin(k x)| = A k^2 \\cdot 1 = A k^2\n$$\nThe minimal value for the TVB parameter $M$ that ensures the limiter remains inactive for the given smooth solution is $A k^2$. The information about the specific flux function $f(u)$ and the source term $s(x)$ serves to justify that $u(x) = A \\sin(k x)$ is a valid steady-state solution to the underlying balance law, but does not enter the calculation for $M$ itself, as the limiter condition depends only on the solution variable $u$.", "answer": "$$\n\\boxed{A k^{2}}\n$$", "id": "3424065"}, {"introduction": "While preserving smooth features is important, for nonlinear conservation laws like the Euler or Burgers' equations, it is paramount that the numerical scheme satisfies the correct entropy condition to select the physically relevant solution. A TVB limiter with a large $M$ parameter can inadvertently re-introduce oscillations that were removed by a stricter limiter, leading to a local entropy violation. This hands-on coding problem challenges you to construct a concrete counterexample demonstrating this failure and to implement a mitigation strategy that restores the entropy-satisfying property of the scheme [@problem_id:3424004].", "problem": "Consider the one-dimensional scalar conservation law $u_t + f(u)_x = 0$ with the inviscid Burgers flux $f(u) = \\tfrac{1}{2}u^2$ and the convex mathematical entropy $U(u) = \\tfrac{1}{2}u^2$. Work on the periodic domain $[0,1]$ partitioned into $N$ uniform cells with $N = 20$ and cell size $\\Delta x = 1/N$. Use a discontinuous Galerkin (DG) representation of degree $p=1$ (piecewise linear per cell) so that, on each cell $K_i = [x_{i-\\frac{1}{2}}, x_{i+\\frac{1}{2}}]$ with cell center $x_i$, the polynomial representation is $u_i(x) = \\bar{u}_i + s_i (x - x_i)$, where $\\bar{u}_i$ is the cell average and $s_i$ is the (unlimited) slope obtained by the $L^2$ projection of the initial condition onto degree-$1$ polynomials on $K_i$. Initialize with an under-resolved step:\n- $u_0(x) = 1$ for $x < x_0$ and $u_0(x) = 0$ for $x \\ge x_0$,\n- with the step located at $x_0 = \\tfrac{1}{3} + \\tfrac{1}{4}\\Delta x$,\nso that the discontinuity lies strictly inside a single cell (not aligned with interfaces).\n\nApply the Total Variation Bounded (TVB) minmod limiter (TVB stands for Total Variation Bounded) to the slopes $s_i$ as follows. Let $\\Delta^+ \\bar{u}_i = \\bar{u}_{i+1} - \\bar{u}_i$ and $\\Delta^- \\bar{u}_i = \\bar{u}_i - \\bar{u}_{i-1}$ with periodic indexing. Define the TVB threshold parameter $M > 0$ and the cell-based threshold $\\tau_i = M (\\Delta x)^2$. The TVB-modified minmod slope is\n- if $(\\Delta x)^2 |s_i| \\le M$, then $s_i^{\\text{TVB}} = s_i$ (no limiting),\n- otherwise $s_i^{\\text{TVB}} = \\operatorname{minmod}\\!\\big(s_i, \\tfrac{\\Delta^+ \\bar{u}_i}{\\Delta x}, \\tfrac{\\Delta^- \\bar{u}_i}{\\Delta x}\\big)$,\nwhere $\\operatorname{minmod}(a,b,c)$ returns $\\operatorname{sign}(a)\\min(|a|,|b|,|c|)$ if $\\operatorname{sign}(a)=\\operatorname{sign}(b)=\\operatorname{sign}(c)$ and returns $0$ otherwise.\n\nDefine the per-cell discrete entropy as the integral of $U(u_i(x))$ over each $K_i$:\n$$\nE_i(s) = \\int_{x_{i-\\frac{1}{2}}}^{x_{i+\\frac{1}{2}}} U\\big(\\bar{u}_i + s(x - x_i)\\big)\\,dx,\n$$\nwith $s$ instantiated as either the baseline-limited slope $s_i^{\\text{base}}$ or the $M$-TVB-limited slope $s_i^{\\text{TVB}}$. Use the following baseline for comparison: the strictly Total Variation Diminishing (TVD) minmod limiter, corresponding to the TVB parameter $M=0$, yielding $s_i^{\\text{base}} = \\operatorname{minmod}\\!\\big(s_i, \\tfrac{\\Delta^+ \\bar{u}_i}{\\Delta x}, \\tfrac{\\Delta^- \\bar{u}_i}{\\Delta x}\\big)$.\n\nYour tasks:\n1. Construct a concrete counterexample within the above setting showing that an improperly scaled $M$ leads to an entropy increase near the under-resolved gradient. Specifically, identify the single “most troubled” cell $K_j$ containing the discontinuity (the one with the largest $|s_i|$) and compute $E_j(s_j^{\\text{TVB}})$ and $E_j(s_j^{\\text{base}})$. Declare that an entropy increase has occurred if $E_j(s_j^{\\text{TVB}}) > E_j(s_j^{\\text{base}}) + \\varepsilon$, with $\\varepsilon = 10^{-12}$.\n2. Detection rule: for a given $M$, compute the boolean detector $\\mathcal{D}(M)$ which is $1$ (true) if the entropy increase occurs in $K_j$ under the above criterion, and $0$ (false) otherwise.\n3. Mitigation strategy: if $\\mathcal{D}(M)=1$, perform an a posteriori fix by re-limiting in $K_j$ with the baseline TVD limiter (i.e., set $s_j^{\\text{mit}} = s_j^{\\text{base}}$) and recompute the entropy. Report whether, after this mitigation, the entropy increase remains according to the same criterion.\n\nTest suite:\n- Case $1$ (happy path): $M = 10^{-3}$, no mitigation applied. Output the boolean indicating whether an entropy increase remains.\n- Case $2$ (counterexample): $M = 1$, no mitigation applied. Output the boolean indicating whether an entropy increase remains.\n- Case $3$ (mitigated): $M = 1$, apply the mitigation if the detector triggers. Output the boolean indicating whether an entropy increase remains after mitigation.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order of the above cases. For example, if the booleans are false, true, false, the output must be printed exactly as: \"[False,True,False]\".\n- All outputs are booleans. No physical units or angle units are involved in this task.\n\nThe solution must be derived from fundamental definitions of the discontinuous Galerkin method with a piecewise linear basis, the TVB limiter definition, the convex entropy integral, and properties of convex functions. Do not assume any shortcut formulas beyond these definitions; all required expressions must be derived from first principles in your reasoning. The constructed example must be reproducible by the provided program without any user input, using the specified test suite parameters only.", "solution": "The problem requires us to construct a specific numerical counterexample demonstrating that a Total Variation Bounded (TVB) limiter, under certain conditions, can lead to a local increase in the discrete mathematical entropy, a behavior that strictly Total Variation Diminishing (TVD) limiters are designed to prevent. We will follow a systematic, principle-based approach to derive the necessary quantities and evaluate the test cases.\n\n### Step 1: Initial Data Projection for the Discontinuous Galerkin Method\n\nThe problem is set on a periodic domain $[0,1]$ with $N=20$ cells, so the cell width is $\\Delta x = 1/N = 0.05$. The cells are $K_i = [x_{i-\\frac{1}{2}}, x_{i+\\frac{1}{2}}]$ for $i=0, \\dots, N-1$, where the cell interface is $x_{i-\\frac{1}{2}} = i\\Delta x$ and the cell center is $x_i = (i+0.5)\\Delta x$.\n\nThe solution within each cell is represented by a degree $p=1$ polynomial: $u_i(x) = \\bar{u}_i + s_i(x-x_i)$. The coefficients $\\bar{u}_i$ (cell average) and $s_i$ (slope) are determined by an $L^2$ projection of the initial condition $u_0(x)$ onto a basis of polynomials on $K_i$. The basis functions corresponding to this representation are $\\{1, x-x_i\\}$, which are orthogonal on the symmetric cell interval $[x_i-\\Delta x/2, x_i+\\Delta x/2]$.\n\nThe cell average $\\bar{u}_i$ is determined by projecting $u_0(x)$ onto the constant basis function:\n$$\n\\bar{u}_i = \\frac{1}{\\Delta x} \\int_{x_{i-\\frac{1}{2}}}^{x_{i+\\frac{1}{2}}} u_0(x) \\, dx\n$$\n\nThe slope $s_i$ is determined by projecting $u_0(x)$ onto the linear basis function $(x-x_i)$:\n$$\ns_i \\int_{x_{i-\\frac{1}{2}}}^{x_{i+\\frac{1}{2}}} (x - x_i)^2 \\, dx = \\int_{x_{i-\\frac{1}{2}}}^{x_{i+\\frac{1}{2}}} u_0(x) (x - x_i) \\, dx\n$$\nThe normalization integral on the left side is $\\int_{-\\Delta x/2}^{\\Delta x/2} \\xi^2 \\, d\\xi = [\\xi^3/3]_{-\\Delta x/2}^{\\Delta x/2} = \\Delta x^3/12$. This yields the formula for the slope:\n$$\ns_i = \\frac{12}{\\Delta x^3} \\int_{x_{i-\\frac{1}{2}}}^{x_{i+\\frac{1}{2}}} u_0(x) (x - x_i) \\, dx\n$$\n\nThe initial condition is a step function: $u_0(x) = 1$ for $x < x_0$ and $u_0(x) = 0$ for $x \\ge x_0$, with the discontinuity at $x_0 = \\frac{1}{3} + \\frac{1}{4}\\Delta x = \\frac{1}{3} + \\frac{1}{4}(\\frac{1}{20}) = \\frac{1}{3} + \\frac{1}{80} = \\frac{83}{240}$.\nNumerically, $x_0 \\approx 0.34583$. Since $\\Delta x = 0.05$, the cell index $j$ containing $x_0$ is found by $j = \\lfloor x_0 / \\Delta x \\rfloor = \\lfloor 0.34583 / 0.05 \\rfloor = \\lfloor 6.9166 \\rfloor = 6$. The cell is $K_6 = [6\\Delta x, 7\\Delta x] = [0.3, 0.35]$. This is the \"most troubled\" cell, as it is the only one where the slope will be non-zero.\n\nFor any cell $K_i$ with $i < 6$, $u_0(x)=1$ everywhere in the cell. Thus, $\\bar{u}_i = 1$ and $s_i=0$.\nFor any cell $K_i$ with $i > 6$, $u_0(x)=0$ everywhere in the cell. Thus, $\\bar{u}_i = 0$ and $s_i=0$.\n\nFor the cell $K_6$, where $j=6$:\n$x_{6-\\frac{1}{2}} = 0.3$, $x_{6+\\frac{1}{2}} = 0.35$, and $x_6 = 0.325$.\n$$\n\\bar{u}_6 = \\frac{1}{\\Delta x} \\int_{0.3}^{0.35} u_0(x) \\, dx = \\frac{1}{\\Delta x} \\int_{0.3}^{x_0} 1 \\, dx = \\frac{x_0 - 0.3}{\\Delta x} = \\frac{83/240 - 72/240}{12/240} = \\frac{11}{12}\n$$\n$$\ns_6 = \\frac{12}{\\Delta x^3} \\int_{0.3}^{x_0} (x - x_6) \\, dx = \\frac{12}{\\Delta x^3} \\left[ \\frac{(x-x_6)^2}{2} \\right]_{0.3}^{x_0} = \\frac{6}{\\Delta x^3} \\left( (x_0 - x_6)^2 - (0.3 - x_6)^2 \\right)\n$$\nWith $x_0 = 83/240$, $x_6 = 0.325 = 78/240$, and $0.3 = 72/240$, we have:\n$x_0 - x_6 = 5/240$. And $0.3 - x_6 = -6/240 = -\\Delta x/2$.\n$$\ns_6 = \\frac{6}{\\Delta x^3} \\left( (\\frac{5}{240})^2 - (-\\frac{6}{240})^2 \\right) = \\frac{6}{(\\frac{12}{240})^3} \\frac{25-36}{240^2} = \\frac{6 \\cdot 240^3}{12^3} \\frac{-11}{240^2} = \\frac{6 \\cdot 240 \\cdot (-11)}{1728} = \\frac{-15840}{1728} = -\\frac{55}{6}\n$$\nSo, the initial unlimited slope in the troubled cell is $s_j = s_6 = -55/6 \\approx -9.167$.\n\n### Step 2: Limiter Application\n\nWe require the baseline TVD-limited slope, $s_j^{\\text{base}}$, and the TVB-limited slope, $s_j^{\\text{TVB}}$. The baseline slope is $s_j^{\\text{base}} = \\operatorname{minmod}(s_j, \\frac{\\Delta^+ \\bar{u}_j}{\\Delta x}, \\frac{\\Delta^- \\bar{u}_j}{\\Delta x})$.\nFor cell $j=6$:\n$\\bar{u}_{j+1} = \\bar{u}_7 = 0$.\n$\\bar{u}_j = \\bar{u}_6 = 11/12$.\n$\\bar{u}_{j-1} = \\bar{u}_5 = 1$.\nThe differences are $\\Delta^+ \\bar{u}_j = 0 - 11/12 = -11/12$ and $\\Delta^- \\bar{u}_j = 11/12 - 1 = -1/12$.\nThe candidate slopes for the minmod function are:\n1.  $s_j = -55/6$\n2.  $\\frac{\\Delta^+ \\bar{u}_j}{\\Delta x} = \\frac{-11/12}{1/20} = -220/12 = -55/3$\n3.  $\\frac{\\Delta^- \\bar{u}_j}{\\Delta x} = \\frac{-1/12}{1/20} = -20/12 = -5/3$\n\nAll three arguments are negative. The minmod function will return the one with the smallest magnitude: $\\operatorname{minmod}(-55/6, -55/3, -5/3) = \\operatorname{minmod}(-9.167, -18.333, -1.667) = -5/3$.\nThus, the baseline TVD-limited slope is $s_j^{\\text{base}} = -5/3$.\n\nThe TVB limiter applies the TVD minmod limiter only if $(\\Delta x)^2 |s_j| > M$.\nLet's compute the threshold quantity: $(\\Delta x)^2 |s_j| = (1/20)^2 |-55/6| = \\frac{1}{400} \\frac{55}{6} = \\frac{55}{2400} = \\frac{11}{480} \\approx 0.0229167$.\nThe TVB-limited slope is:\n$$\ns_j^{\\text{TVB}} =\n\\begin{cases}\ns_j = -55/6 & \\text{if } M \\ge 11/480 \\\\\ns_j^{\\text{base}} = -5/3 & \\text{if } M < 11/480\n\\end{cases}\n$$\n\n### Step 3: Discrete Entropy Analysis\n\nThe discrete entropy in cell $K_j$ is defined as $E_j(s) = \\int_{K_j} U(u_j(x)) \\, dx$, where $U(u)=\\frac{1}{2}u^2$ and $u_j(x) = \\bar{u}_j + s(x-x_j)$.\n$$\nE_j(s) = \\int_{x_j-\\Delta x/2}^{x_j+\\Delta x/2} \\frac{1}{2} (\\bar{u}_j + s(x-x_j))^2 \\, dx\n$$\nLet $\\xi = x-x_j$.\n$$\nE_j(s) = \\frac{1}{2} \\int_{-\\Delta x/2}^{\\Delta x/2} (\\bar{u}_j^2 + 2s\\bar{u}_j\\xi + s^2\\xi^2) \\, d\\xi\n$$\nThe term linear in $\\xi$ integrates to zero over the symmetric interval.\n$$\nE_j(s) = \\frac{1}{2} \\left[ \\bar{u}_j^2 \\xi + s^2 \\frac{\\xi^3}{3} \\right]_{-\\Delta x/2}^{\\Delta x/2} = \\frac{1}{2} \\left( \\bar{u}_j^2 \\Delta x + s^2 \\frac{\\Delta x^3}{12} \\right) = \\Delta x \\left( \\frac{1}{2}\\bar{u}_j^2 + \\frac{1}{24} s^2 (\\Delta x)^2 \\right)\n$$\nAn entropy increase is declared if $E_j(s_j^{\\text{TVB}}) > E_j(s_j^{\\text{base}}) + \\varepsilon$. This is equivalent to:\n$$\n\\Delta x \\left( \\frac{1}{2}\\bar{u}_j^2 + \\frac{1}{24} (s_j^{\\text{TVB}})^2 (\\Delta x)^2 \\right) > \\Delta x \\left( \\frac{1}{2}\\bar{u}_j^2 + \\frac{1}{24} (s_j^{\\text{base}})^2 (\\Delta x)^2 \\right) + \\varepsilon\n$$\n$$\n\\frac{\\Delta x^3}{24} \\left( (s_j^{\\text{TVB}})^2 - (s_j^{\\text{base}})^2 \\right) > \\varepsilon\n$$\nEntropy increases if and only if $|s_j^{\\text{TVB}}| > |s_j^{\\text{base}}|$, and the magnitude of the difference is large enough to exceed the tolerance $\\varepsilon$.\n\n### Step 4: Evaluation of Test Cases\n\nWe evaluate the boolean condition for each case. The troubled cell index is $j=6$.\nThe values are: $\\varepsilon = 10^{-12}$, $\\Delta x = 0.05$, $s_j = -55/6$, $s_j^{\\text{base}} = -5/3$, and the TVB scale factor is $11/480$.\n\n**Case 1: $M = 10^{-3} = 0.001$.**\nWe check the TVB condition: $M = 0.001$ versus the threshold $11/480 \\approx 0.0229$.\nSince $M < 11/480$, the limiter is activated.\n$s_j^{\\text{TVB}} = s_j^{\\text{base}} = -5/3$.\nThe entropy increase check is $\\frac{\\Delta x^3}{24} \\left( (s_j^{\\text{base}})^2 - (s_j^{\\text{base}})^2 \\right) > \\varepsilon$, which simplifies to $0 > \\varepsilon$. This is false.\n**Result for Case 1: False.**\n\n**Case 2: $M = 1$.**\nWe check the TVB condition: $M = 1$ versus the threshold $11/480 \\approx 0.0229$.\nSince $M > 11/480$, the limiter is NOT activated.\n$s_j^{\\text{TVB}} = s_j = -55/6$.\nThe entropy increase check is $\\frac{\\Delta x^3}{24} \\left( (-55/6)^2 - (-5/3)^2 \\right) > \\varepsilon$.\nThe left side is $\\frac{(0.05)^3}{24} \\left( \\frac{3025}{36} - \\frac{25}{9} \\right) = \\frac{0.000125}{24} \\left( \\frac{3025-100}{36} \\right) = \\frac{0.000125}{24} \\frac{2925}{36} \\approx 4.23 \\times 10^{-4}$.\nSince $4.23 \\times 10^{-4} > 10^{-12}$, the condition is true. An entropy increase occurs.\n**Result for Case 2: True.**\n\n**Case 3: $M = 1$, with mitigation.**\nFor $M=1$, the detector $\\mathcal{D}(M)$ triggers, as shown in Case 2. The mitigation rule is to re-limit the slope in cell $j$, setting $s_j^{\\text{mit}} = s_j^{\\text{base}}$.\nSo, the slope used for the final check is $s_j^{\\text{mit}} = -5/3$.\nThe problem asks whether the entropy increase remains after mitigation, using the same criterion. The criterion is a comparison of the current state's entropy to the baseline entropy. Here, the current state is the mitigated state.\nThe check is $E_j(s_j^{\\text{mit}}) > E_j(s_j^{\\text{base}}) + \\varepsilon$.\nSince $s_j^{\\text{mit}} = s_j^{\\text{base}}$, this is equivalent to $E_j(s_j^{\\text{base}}) > E_j(s_j^{\\text{base}}) + \\varepsilon$, which simplifies to $0 > \\varepsilon$. This is false. The mitigation successfully prevents the entropy increase.\n**Result for Case 3: False.**\n\nThe final sequence of booleans is [False, True, False].", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the DG-TVB limiter problem by constructing the counterexample.\n    \"\"\"\n\n    # --- Problem Parameters ---\n    N = 20\n    dx = 1.0 / N\n    x0 = 1.0 / 3.0 + 0.25 * dx\n    epsilon = 1e-12\n    test_suite = [\n        # Case 1: M, apply_mitigation\n        (1e-3, False),\n        # Case 2: M, apply_mitigation\n        (1.0, False),\n        # Case 3: M, apply_mitigation\n        (1.0, True)\n    ]\n\n    # --- Step 1: Compute Initial State (L2 Projection) ---\n    bar_u = np.zeros(N)\n    s = np.zeros(N)\n    j_troubled = -1\n\n    for i in range(N):\n        x_imhalf = i * dx\n        x_iphalf = (i + 1) * dx\n        x_i = (i + 0.5) * dx\n\n        if x_iphalf <= x0:\n            # Cell is entirely to the left of the discontinuity\n            bar_u[i] = 1.0\n            s[i] = 0.0\n        elif x_imhalf >= x0:\n            # Cell is entirely to the right of the discontinuity\n            bar_u[i] = 0.0\n            s[i] = 0.0\n        else:\n            # Cell contains the discontinuity\n            j_troubled = i\n            # Integral for the cell average\n            bar_u[i] = (x0 - x_imhalf) / dx\n            # Integral for the slope\n            # Using formula: integral = (b-a) * ((a+b)/2 - xc)\n            # where a=x_imhalf, b=x0, xc=x_i\n            integral_val = (x0 - x_imhalf) * (0.5 * (x_imhalf + x0) - x_i)\n            s[i] = 12.0 / (dx**3) * integral_val\n\n    # Ensure the troubled cell was found\n    if j_troubled == -1:\n        raise ValueError(\"Discontinuity location x0 was not found in any cell.\")\n\n    s_j_unlimited = s[j_troubled]\n    bar_u_j = bar_u[j_troubled]\n\n    # --- Step 2: Compute Baseline (TVD) Limited Slope ---\n    \n    # Periodic indexing\n    j_plus_1 = (j_troubled + 1) % N\n    j_minus_1 = (j_troubled - 1 + N) % N\n\n    delta_plus_bar_u = bar_u[j_plus_1] - bar_u_j\n    delta_minus_bar_u = bar_u_j - bar_u[j_minus_1]\n\n    s_cand_1 = s_j_unlimited\n    s_cand_2 = delta_plus_bar_u / dx\n    s_cand_3 = delta_minus_bar_u / dx\n\n    def minmod(a, b, c):\n        \"\"\"Standard minmod function for three arguments.\"\"\"\n        if a > 0 and b > 0 and c > 0:\n            return min(a, b, c)\n        elif a < 0 and b < 0 and c < 0:\n            return max(a, b, c)\n        else:\n            return 0.0\n            \n    s_j_base = minmod(s_cand_1, s_cand_2, s_cand_3)\n\n    # --- Step 3: Function for Entropy Difference ---\n    def compute_entropy_difference(s_test, s_ref, dx_val):\n        \"\"\"\n        Computes E(s_test) - E(s_ref).\n        Formula derived in solution: dx^3/24 * (s_test^2 - s_ref^2)\n        \"\"\"\n        return (dx_val**3 / 24.0) * (s_test**2 - s_ref**2)\n\n    # --- Step 4: Evaluate Test Cases ---\n    results = []\n    \n    tvb_threshold_quantity = (dx**2) * abs(s_j_unlimited)\n\n    for M, apply_mitigation in test_suite:\n        \n        # Determine the TVB-limited slope\n        if tvb_threshold_quantity <= M:\n            s_j_tvb = s_j_unlimited  # No limiting\n        else:\n            s_j_tvb = s_j_base      # Limit\n\n        # Run the detector: does an entropy increase occur with s_j_tvb?\n        entropy_diff_unmitigated = compute_entropy_difference(s_j_tvb, s_j_base, dx)\n        detector_triggered = entropy_diff_unmitigated > epsilon\n        \n        # Determine the final slope after potential mitigation\n        s_j_final = s_j_tvb\n        if apply_mitigation and detector_triggered:\n            s_j_final = s_j_base # Apply fix\n\n        # Check if entropy increase remains with the final slope\n        final_entropy_diff = compute_entropy_difference(s_j_final, s_j_base, dx)\n        increase_remains = final_entropy_diff > epsilon\n        \n        results.append(increase_remains)\n\n    # --- Final Output ---\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3424004"}]}