{"hands_on_practices": [{"introduction": "To build a numerical solver for a PDE with uncertainty, we must first understand how to formulate the problem on a single computational element. This practice guides you through the foundational step of deriving the semi-discrete weak form for a nonlinear PDE using a Discontinuous Galerkin (DG) method in space combined with a Generalized Polynomial Chaos (gPC) expansion for the random variable. By working through this exercise, you will see how the tensor-product structure of the basis leads to a local system of equations and how the orthonormality of the stochastic basis simplifies the resulting local mass matrix.", "problem": "Consider the nonlinear conservation law Burgers' equation $u_t + \\frac{1}{2}(u^2)_x = 0$ on the spatial domain $[0,1]$ with a uniform mesh of $N$ elements of size $h = 1/N$. Use the Discontinuous Galerkin (DG) method with a modal spatial basis of degree $p=1$ and Generalized Polynomial Chaos (gPC) for uncertainty quantification with polynomial degree $P=1$ in a single scalar random variable $\\zeta$ uniformly distributed on $[-1,1]$, with density $\\rho(\\zeta) = 1/2$. The gPC basis is the Legendre family orthonormalized with respect to $\\rho$: $\\psi_0(\\zeta) = 1$ and $\\psi_1(\\zeta) = \\sqrt{3}\\,\\zeta$. On each element, map the physical coordinate $x$ to the reference coordinate $\\eta \\in [-1,1]$ via $x = x_e + \\frac{h}{2}\\eta$, and use the modal Legendre spatial basis $P_0(\\eta) = 1$ and $P_1(\\eta) = \\eta$. Approximate the solution locally on element $e$ as\n$$\nu_e(\\eta,t,\\zeta) = \\sum_{i=0}^{1}\\sum_{k=0}^{1} \\widehat{u}_{i,k}^{(e)}(t)\\,P_i(\\eta)\\,\\psi_k(\\zeta).\n$$\nDerive the semidiscrete DG weak form on each element using test functions identical to the spatial basis functions and the Lax–Friedrichs numerical flux for Burgers' equation,\n$$\nf^{\\ast}(a,b) = \\frac{1}{2}\\left( \\frac{a^2}{2} + \\frac{b^2}{2} \\right) - \\frac{\\alpha}{2}\\,(b-a),\n$$\nwhere $\\alpha \\ge 0$ is a deterministic constant chosen to bound the characteristic speed. Assemble the local element system in terms of the spatial-stochastic coefficients $\\widehat{u}_{i,k}^{(e)}(t)$, explicitly identifying the spatial mass operator, the volume coupling induced by the term $\\frac{1}{2}(u^2)$, and the face flux contributions. In your derivation, use only the properties of Legendre polynomials, orthonormality of the gPC basis with respect to $\\rho$, and the mapping between physical and reference coordinates.\n\nFinally, compute and report the explicit $4 \\times 4$ spatial-stochastic local mass matrix $M_e$ for element $e$ associated with the coefficient ordering $(\\widehat{u}_{0,0}^{(e)},\\,\\widehat{u}_{1,0}^{(e)},\\,\\widehat{u}_{0,1}^{(e)},\\,\\widehat{u}_{1,1}^{(e)})$. Your final answer must be this matrix written exactly in closed form. No rounding is required and no units are involved in the answer.", "solution": "The problem requires the derivation of the semidiscrete weak form for Burgers' equation using a Discontinuous Galerkin (DG) method with Generalized Polynomial Chaos (gPC) for uncertainty quantification, and the explicit computation of the local spatial-stochastic mass matrix.\n\nThe governing partial differential equation (PDE) is Burgers' equation:\n$$\n\\frac{\\partial u}{\\partial t} + \\frac{\\partial}{\\partial x}\\left(\\frac{1}{2}u^2\\right) = 0\n$$\nThe solution $u(x, t, \\zeta)$ is approximated on each element $I_e = [x_{e-1/2}, x_{e+1/2}]$ by mapping to a reference element $\\eta \\in [-1,1]$ using $x = x_e + \\frac{h}{2}\\eta$. The approximation is a tensor product of spatial and stochastic basis functions:\n$$\nu_e(\\eta, t, \\zeta) = \\sum_{i=0}^{1}\\sum_{k=0}^{1} \\widehat{u}_{i,k}^{(e)}(t)\\,P_i(\\eta)\\,\\psi_k(\\zeta)\n$$\nwhere $P_i(\\eta)$ are the spatial Legendre basis functions ($P_0(\\eta)=1, P_1(\\eta)=\\eta$) and $\\psi_k(\\zeta)$ are the orthonormal gPC basis functions ($\\psi_0(\\zeta)=1, \\psi_1(\\zeta)=\\sqrt{3}\\zeta$).\n\nThe standard DG weak formulation is obtained by multiplying the PDE by a spatial test function $v_h(x)$ and integrating over an element $I_e$. Using integration by parts on the flux term, we get:\n$$\n\\int_{I_e} \\frac{\\partial u}{\\partial t} v_h \\,dx - \\int_{I_e} \\frac{1}{2}u^2 \\frac{dv_h}{dx} \\,dx + \\left[ f^*(u) v_h \\right]_{x_{e-1/2}}^{x_{e+1/2}} = 0\n$$\nwhere $f^*(u)$ is the numerical flux, replacing the analytical flux $\\frac{1}{2}u^2$ at element boundaries. This is given as the Lax-Friedrichs flux. The term expands to $f^*(u(x_{e+1/2}^-), u(x_{e+1/2}^+)) v_h(x_{e+1/2}) - f^*(u(x_{e-1/2}^-), u(x_{e-1/2}^+)) v_h(x_{e-1/2})$.\n\nWe now apply the stochastic Galerkin method. The test functions are $v_{jl}(\\eta, \\zeta) = P_j(\\eta)\\psi_l(\\zeta)$ for $j, l \\in \\{0, 1\\}$. We multiply the spatially-discretized equation, still continuous in $\\zeta$, by $\\psi_l(\\zeta)$ and integrate over the stochastic domain with the weight function $\\rho(\\zeta) = 1/2$. This projects the equation onto the gPC basis. The spatial test functions are $v_h(\\eta) = P_j(\\eta)$. After changing variables to the reference element ($dx = \\frac{h}{2}d\\eta$, $\\frac{d}{dx} = \\frac{2}{h}\\frac{d}{d\\eta}$), the full weak form becomes:\n$$\n\\int_{-1}^{1}\\psi_l(\\zeta)\\rho(\\zeta) \\left( \\int_{-1}^{1} \\frac{\\partial u}{\\partial t} P_j(\\eta) \\frac{h}{2} \\,d\\eta \\right) d\\zeta \\\\\n- \\int_{-1}^{1}\\psi_l(\\zeta)\\rho(\\zeta) \\left( \\int_{-1}^{1} \\frac{1}{2}u^2 \\frac{2}{h}\\frac{dP_j}{d\\eta} \\frac{h}{2} \\,d\\eta \\right) d\\zeta \\\\\n+ \\int_{-1}^{1}\\psi_l(\\zeta)\\rho(\\zeta) \\left( f_{e+1/2}^* P_j(1) - f_{e-1/2}^* P_j(-1) \\right) d\\zeta = 0\n$$\nfor $j,l \\in \\{0,1\\}$. We analyze each term separately.\n\n1.  **Mass Operator (Time Derivative Term):**\n    Let's denote this term by $\\mathcal{M}$.\n    $$\n    \\mathcal{M} = \\frac{h}{2} \\int_{-1}^{1} \\int_{-1}^{1} \\frac{\\partial u}{\\partial t} P_j(\\eta) \\psi_l(\\zeta) \\rho(\\zeta) \\,d\\eta \\,d\\zeta\n    $$\n    Substitute the expansion for $u_t = \\sum_{i=0}^{1}\\sum_{k=0}^{1} \\frac{d\\widehat{u}_{i,k}^{(e)}}{dt} P_i(\\eta)\\psi_k(\\zeta)$:\n    $$\n    \\mathcal{M} = \\frac{h}{2} \\int_{-1}^{1} \\int_{-1}^{1} \\left( \\sum_{i=0}^{1}\\sum_{k=0}^{1} \\frac{d\\widehat{u}_{i,k}^{(e)}}{dt} P_i(\\eta)\\psi_k(\\zeta) \\right) P_j(\\eta) \\psi_l(\\zeta) \\rho(\\zeta) \\,d\\eta \\,d\\zeta\n    $$\n    Rearranging the summations and integrals:\n    $$\n    \\mathcal{M} = \\frac{h}{2} \\sum_{i=0}^{1}\\sum_{k=0}^{1} \\frac{d\\widehat{u}_{i,k}^{(e)}}{dt} \\left( \\int_{-1}^{1} P_i(\\eta)P_j(\\eta) \\,d\\eta \\right) \\left( \\int_{-1}^{1} \\psi_k(\\zeta)\\psi_l(\\zeta)\\rho(\\zeta) \\,d\\zeta \\right)\n    $$\n    The gPC basis is orthonormal with respect to the weight $\\rho(\\zeta)$, so $\\int_{-1}^{1} \\psi_k(\\zeta)\\psi_l(\\zeta)\\rho(\\zeta) \\,d\\zeta = \\delta_{kl}$, the Kronecker delta.\n    $$\n    \\mathcal{M} = \\frac{h}{2} \\sum_{i=0}^{1}\\sum_{k=0}^{1} \\frac{d\\widehat{u}_{i,k}^{(e)}}{dt} \\left( \\int_{-1}^{1} P_i(\\eta)P_j(\\eta) \\,d\\eta \\right) \\delta_{kl}\n    $$\n    Summing over $k$ collapses the sum, leaving only the term where $k=l$.\n    $$\n    \\mathcal{M} = \\frac{h}{2} \\sum_{i=0}^{1} \\frac{d\\widehat{u}_{i,l}^{(e)}}{dt} \\left( \\int_{-1}^{1} P_i(\\eta)P_j(\\eta) \\,d\\eta \\right)\n    $$\n    This expression defines the entries of the local mass matrix $M_e$.\n\n2.  **Volume Coupling (Nonlinear Convection Term):**\n    Let's denote this term by $\\mathcal{V}$.\n    $$\n    \\mathcal{V} = - \\int_{-1}^{1} \\int_{-1}^{1} \\frac{1}{2}u^2 \\frac{dP_j}{d\\eta} \\psi_l(\\zeta) \\rho(\\zeta) \\,d\\eta \\,d\\zeta\n    $$\n    $u^2(\\eta,\\zeta)$ is given by $(\\sum_{i,k} \\widehat{u}_{ik}P_i\\psi_k)(\\sum_{m,n} \\widehat{u}_{mn}P_m\\psi_n)$. This term couples all the modal coefficients nonlinearly. It involves spatial integrals of the form $\\int_{-1}^1 P_i(\\eta)P_m(\\eta)\\frac{dP_j}{d\\eta}d\\eta$ and stochastic integrals $\\int_{-1}^1 \\psi_k(\\zeta)\\psi_n(\\zeta)\\psi_l(\\zeta)\\rho(\\zeta)d\\zeta$.\n\n3.  **Face Flux Contributions:**\n    Let's denote this term by $\\mathcal{F}$.\n    $$\n    \\mathcal{F} = P_j(1) \\int_{-1}^{1} f_{e+1/2}^* \\psi_l(\\zeta) \\rho(\\zeta) \\,d\\zeta - P_j(-1) \\int_{-1}^{1} f_{e-1/2}^* \\psi_l(\\zeta) \\rho(\\zeta) \\,d\\zeta\n    $$\n    The numerical flux $f^*(a,b)$ is a nonlinear function of the boundary traces $a=u_e$ and $b=u_{e+1}$, which themselves are expansions in $\\zeta$. E.g., $u_e(\\eta=1, \\zeta) = \\sum_{i,k} \\widehat{u}_{ik}^{(e)} P_i(1) \\psi_k(\\zeta)$. This term couples the coefficients of element $e$ nonlinearly with those of its neighbors.\n\n**Computation of the Local Mass Matrix $M_e$**\n\nThe final task is to compute the $4 \\times 4$ mass matrix $M_e$ for element $e$. Its entries are the coefficients of the vector of time derivatives $\\dot{\\mathbf{\\widehat{u}}}^{(e)} = \\left(\\frac{d\\widehat{u}_{0,0}^{(e)}}{dt}, \\frac{d\\widehat{u}_{1,0}^{(e)}}{dt}, \\frac{d\\widehat{u}_{0,1}^{(e)}}{dt}, \\frac{d\\widehat{u}_{1,1}^{(e)}}{dt}\\right)^T$ in the system of equations.\nFrom the expression for $\\mathcal{M}$, the system takes the form $M_e \\dot{\\mathbf{\\widehat{u}}}^{(e)}$. Let us define the local spatial mass matrix on the reference element as $M^{sp}$, with entries $M^{sp}_{ji} = \\int_{-1}^{1} P_i(\\eta)P_j(\\eta) \\,d\\eta$.\nUsing $P_0(\\eta)=1$ and $P_1(\\eta)=\\eta$:\n$M_{00}^{sp} = \\int_{-1}^{1} (1)(1) \\,d\\eta = [\\eta]_{-1}^1 = 2$.\n$M_{01}^{sp} = M_{10}^{sp} = \\int_{-1}^{1} (1)(\\eta) \\,d\\eta = [\\eta^2/2]_{-1}^1 = 0$.\n$M_{11}^{sp} = \\int_{-1}^{1} (\\eta)(\\eta) \\,d\\eta = [\\eta^3/3]_{-1}^1 = \\frac{1}{3} - (-\\frac{1}{3}) = \\frac{2}{3}$.\nSo, the spatial mass matrix is $M^{sp} = \\begin{pmatrix} 2  0 \\\\ 0  \\frac{2}{3} \\end{pmatrix}$.\n\nThe expression for $\\mathcal{M}$ shows that for a given stochastic test mode $l$, the equations only involve coefficients $\\widehat{u}_{i,l}$ with the same stochastic index. This means the full mass matrix will be block diagonal. We have two blocks, one for $l=0$ and one for $l=1$.\nFor $l=0$, the system involves $\\dot{\\widehat{u}}_{0,0}$ and $\\dot{\\widehat{u}}_{1,0}$. The submatrix is $\\frac{h}{2} M^{sp}$.\nFor $l=1$, the system involves $\\dot{\\widehat{u}}_{0,1}$ and $\\dot{\\widehat{u}}_{1,1}$. The submatrix is also $\\frac{h}{2} M^{sp}$.\n\nThe full system's mass matrix $M_e$ is therefore the Kronecker product $M_e = I_2 \\otimes \\left(\\frac{h}{2}M^{sp}\\right)$, where $I_2$ is the $2 \\times 2$ identity matrix from the stochastic Galerkin projection's orthonormality.\nLet's compute the block matrix for the ordering $(\\widehat{u}_{0,0}^{(e)},\\,\\widehat{u}_{1,0}^{(e)},\\,\\widehat{u}_{0,1}^{(e)},\\,\\widehat{u}_{1,1}^{(e)})$.\n\nThe block is $\\frac{h}{2}M^{sp} = \\frac{h}{2}\\begin{pmatrix} 2  0 \\\\ 0  \\frac{2}{3} \\end{pmatrix} = \\begin{pmatrix} h  0 \\\\ 0  \\frac{h}{3} \\end{pmatrix}$.\n\nThe full $4 \\times 4$ mass matrix is:\n$$\nM_e = \\begin{pmatrix} \\frac{h}{2}M^{sp}  0 \\\\ 0  \\frac{h}{2}M^{sp} \\end{pmatrix} = \\begin{pmatrix} h  0  0  0 \\\\ 0  \\frac{h}{3}  0  0 \\\\ 0  0  h  0 \\\\ 0  0  0  \\frac{h}{3} \\end{pmatrix}\n$$\nThis is the spatial-stochastic local mass matrix for the element $e$.", "answer": "$$\n\\boxed{\\begin{pmatrix} h  0  0  0 \\\\ 0  \\frac{h}{3}  0  0 \\\\ 0  0  h  0 \\\\ 0  0  0  \\frac{h}{3} \\end{pmatrix}}\n$$", "id": "3426145"}, {"introduction": "While the mass matrix often decouples the stochastic modes, the true challenge and richness of intrusive stochastic Galerkin methods appear in the stiffness matrix when PDE coefficients are uncertain. This exercise focuses on this critical coupling mechanism by having you compute the stochastic stiffness block for a diffusion problem with a random coefficient. You will gain hands-on experience calculating the essential triple-product integrals, $C_{\\alpha\\beta\\gamma}$, which directly translate the uncertainty in the physical model into a coupled algebraic system.", "problem": "Consider a single-parameter uncertainty quantification setting for a linear diffusion-type model discretized in space by a one-element Discontinuous Galerkin (DG) method. Let the random input be a single standard normal variable $\\xi \\sim \\mathcal{N}(0,1)$ with density $\\varphi(\\xi) = (2\\pi)^{-1/2}\\exp(-\\xi^{2}/2)$. Use a generalized Polynomial Chaos (gPC) stochastic Galerkin (SG) approximation with the orthonormal probabilists’ Hermite basis $\\{\\psi_{n}(\\xi)\\}_{n=0}^{2}$ up to total degree $p=2$, where $\\psi_{0}(\\xi)=1$, $\\psi_{1}(\\xi)=\\xi$, and $\\psi_{2}(\\xi)=(\\xi^{2}-1)/\\sqrt{2}$. Define the triple-product coefficients\n$$\nC_{\\alpha\\beta\\gamma} \\;=\\; \\mathbb{E}\\!\\left[\\psi_{\\alpha}(\\xi)\\,\\psi_{\\beta}(\\xi)\\,\\psi_{\\gamma}(\\xi)\\right] \\;=\\; \\int_{-\\infty}^{\\infty} \\psi_{\\alpha}(\\xi)\\,\\psi_{\\beta}(\\xi)\\,\\psi_{\\gamma}(\\xi)\\,\\varphi(\\xi)\\,d\\xi,\n$$\nfor $\\alpha,\\beta,\\gamma \\in \\{0,1,2\\}$. Assume the spatial DG semi-discretization, after numerical quadrature and flux specification, produces a single scalar spatial mass $M_{s}=2$ and a single scalar spatial stiffness $K_{s}=3$ for the unique local trial function on the element. The random diffusion coefficient is expanded in the same stochastic basis as\n$$\na(\\xi) \\;=\\; a_{0}\\,\\psi_{0}(\\xi) \\;+\\; a_{1}\\,\\psi_{1}(\\xi) \\;+\\; a_{2}\\,\\psi_{2}\\!(\\xi),\n$$\nwith deterministic coefficients $a_{0}=3$, $a_{1}=-1$, and $a_{2}=2$.\n\nIn the stochastic Galerkin system, the $3\\times 3$ stochastic mass block is $G^{(0)}$ with entries $G^{(0)}_{\\alpha\\beta}=\\mathbb{E}[\\psi_{\\alpha}\\psi_{\\beta}]=\\delta_{\\alpha\\beta}$, and the $3\\times 3$ stochastic stiffness block is\n$$\nS \\;=\\; a_{0}\\,G^{(0)} \\;+\\; a_{1}\\,G^{(1)} \\;+\\; a_{2}\\,G^{(2)}, \\quad \\text{where}\\quad G^{(\\gamma)}_{\\alpha\\beta} \\;=\\; C_{\\alpha\\beta\\gamma}.\n$$\nThe full mass and stiffness matrices in the SG system are $M = M_{s}\\,G^{(0)}$ and $K = K_{s}\\,S$.\n\nStarting from the orthonormality of $\\{\\psi_{n}\\}$ with respect to $\\varphi(\\xi)$ and the defining properties of the probabilists’ Hermite polynomials, explicitly compute all $C_{\\alpha\\beta\\gamma}$ needed to assemble $G^{(0)}$, $G^{(1)}$, and $G^{(2)}$ for $\\alpha,\\beta,\\gamma \\in \\{0,1,2\\}$. Then assemble $S$ and the full stiffness $K = K_{s}S$.\n\nWhat is the exact closed-form value of the $(3,3)$ entry of $K$ when the basis is ordered as $(\\psi_{0},\\psi_{1},\\psi_{2})$ corresponding to indices $(1,2,3)$? Provide your answer as a single simplified analytic expression. Do not round.", "solution": "The goal is to compute the $(3,3)$ entry of the full stiffness matrix $K$. The matrix $K$ is defined as $K = K_{s}S$, where $K_s=3$ is a scalar. We first need to compute the $(3,3)$ entry of the stochastic stiffness block $S$.\n\nThe stochastic stiffness matrix $S$ is defined as a linear combination of matrices $G^{(\\gamma)}$:\n$$\nS = a_{0}G^{(0)} + a_{1}G^{(1)} + a_{2}G^{(2)}\n$$\nThe $(3,3)$ entry of $S$, denoted $S_{33}$, is therefore:\n$$\nS_{33} = a_{0}G^{(0)}_{33} + a_{1}G^{(1)}_{33} + a_{2}G^{(2)}_{33}\n$$\nThe problem specifies that the basis functions $\\psi_{0}, \\psi_{1}, \\psi_{2}$ correspond to matrix indices $1, 2, 3$. Thus, the matrix entry $(i,j)=(3,3)$ corresponds to the basis functions with indices $(\\alpha, \\beta)=(2, 2)$. The entries of the matrices $G^{(\\gamma)}$ are defined by the triple-product coefficients $C_{\\alpha\\beta\\gamma}$:\n$$\nG^{(\\gamma)}_{\\alpha\\beta} = C_{\\alpha\\beta\\gamma} = \\mathbb{E}[\\psi_{\\alpha}\\psi_{\\beta}\\psi_{\\gamma}]\n$$\nSo, we need to compute $G^{(0)}_{33}=C_{220}$, $G^{(1)}_{33}=C_{221}$, and $G^{(2)}_{33}=C_{222}$.\n\n1.  **Compute $C_{220}$**:\n    Since $\\psi_{0}(\\xi)=1$, this coefficient is $C_{220} = \\mathbb{E}[\\psi_{2}(\\xi)\\psi_{2}(\\xi)\\psi_{0}(\\xi)] = \\mathbb{E}[\\psi_{2}(\\xi)^2]$. By the orthonormality of the basis, $\\mathbb{E}[\\psi_{\\alpha}\\psi_{\\beta}] = \\delta_{\\alpha\\beta}$, so for $\\alpha=\\beta=2$:\n    $$\n    C_{220} = 1\n    $$\n\n2.  **Compute $C_{221}$**:\n    This coefficient is $C_{221} = \\mathbb{E}[\\psi_{2}(\\xi)^2 \\psi_{1}(\\xi)]$. The basis functions are $\\psi_{1}(\\xi)=\\xi$ (an odd function) and $\\psi_{2}(\\xi)=(\\xi^{2}-1)/\\sqrt{2}$ (an even function). The square, $\\psi_{2}(\\xi)^{2}$, is therefore also an even function. The product of an even function ($\\psi_{2}^{2}$) and an odd function ($\\psi_{1}$) is an odd function. The expectation is the integral of this odd function against the even probability density function $\\varphi(\\xi)$ over the symmetric interval $(-\\infty, \\infty)$. This integral is zero.\n    $$\n    C_{221} = 0\n    $$\n\n3.  **Compute $C_{222}$**:\n    This coefficient is $C_{222} = \\mathbb{E}[\\psi_{2}(\\xi)^3]$. We substitute the expression for $\\psi_{2}(\\xi)$:\n    $$\n    C_{222} = \\mathbb{E}\\left[\\left(\\frac{\\xi^{2}-1}{\\sqrt{2}}\\right)^{3}\\right] = \\frac{1}{2\\sqrt{2}}\\mathbb{E}\\left[(\\xi^{2}-1)^{3}\\right] = \\frac{1}{2\\sqrt{2}}\\mathbb{E}\\left[\\xi^{6} - 3\\xi^{4} + 3\\xi^{2} - 1\\right]\n    $$\n    By linearity of expectation, this becomes:\n    $$\n    C_{222} = \\frac{1}{2\\sqrt{2}} \\left( \\mathbb{E}[\\xi^{6}] - 3\\mathbb{E}[\\xi^{4}] + 3\\mathbb{E}[\\xi^{2}] - \\mathbb{E}[1] \\right)\n    $$\n    The even-powered moments of a standard normal variable $\\xi \\sim \\mathcal{N}(0,1)$ are given by the double factorial $\\mathbb{E}[\\xi^{2n}] = (2n-1)!!$.\n    -   $\\mathbb{E}[1] = 1$\n    -   $\\mathbb{E}[\\xi^{2}] = 1$\n    -   $\\mathbb{E}[\\xi^{4}] = 3 \\times 1 = 3$\n    -   $\\mathbb{E}[\\xi^{6}] = 5 \\times 3 \\times 1 = 15$\n    Substituting these values:\n    $$\n    C_{222} = \\frac{1}{2\\sqrt{2}} (15 - 3(3) + 3(1) - 1) = \\frac{1}{2\\sqrt{2}} (15 - 9 + 3 - 1) = \\frac{8}{2\\sqrt{2}} = \\frac{4}{\\sqrt{2}} = 2\\sqrt{2}\n    $$\n\nNow, we assemble the entry $S_{33}$ using the given coefficients $a_{0}=3$, $a_{1}=-1$, and $a_{2}=2$:\n$$\nS_{33} = a_{0}C_{220} + a_{1}C_{221} + a_{2}C_{222} = (3)(1) + (-1)(0) + (2)(2\\sqrt{2}) = 3 + 4\\sqrt{2}\n$$\nFinally, we compute the $(3,3)$ entry of the full stiffness matrix $K$ using the given spatial stiffness $K_{s}=3$:\n$$\nK_{33} = K_{s} S_{33} = 3(3 + 4\\sqrt{2}) = 9 + 12\\sqrt{2}\n$$\nThis is the exact, closed-form value for the specified matrix entry.", "answer": "$$\n\\boxed{9 + 12\\sqrt{2}}\n$$", "id": "3426119"}, {"introduction": "After mastering the formulation of local mass and stiffness matrices, the final step is to assemble them into a single global system that can be solved numerically. This practice zooms out to the \"big picture,\" guiding you to derive the elegant Kronecker product structure of the global system matrix for a DG-gPC discretization. Understanding this structure is paramount for analyzing system properties like sparsity, as you will do here, and for developing scalable, efficient solvers for large-scale uncertainty quantification problems.", "problem": "Consider the one-dimensional elliptic model problem with a random diffusion coefficient on the spatial domain $\\mathcal{D}=(0,1)$: find $u:\\mathcal{D}\\times\\Gamma\\to\\mathbb{R}$ such that\n$$\n-\\frac{d}{dx}\\!\\left(a(x,\\xi)\\,\\frac{du}{dx}(x,\\xi)\\right)=f(x)\\quad\\text{for }x\\in(0,1),\n$$\nwith homogeneous Dirichlet boundary conditions $u(0,\\xi)=u(1,\\xi)=0$ for all $\\xi\\in\\Gamma$. The random input is modeled as a single scalar random variable $\\xi\\in[-1,1]$ with the uniform distribution, and the coefficient is affine in $\\xi$:\n$$\na(x,\\xi)=a_{0}(x)+a_{1}(x)\\,\\xi,\n$$\nwhere $a_{0}(x)0$ and $a_{1}(x)$ are deterministic functions.\n\nDiscretize the spatial domain using the symmetric interior penalty Discontinuous Galerkin (DG) method with polynomial degree $r=2$ in each element and a uniform mesh of $N=50$ elements. Let $\\{\\varphi_{i}(x)\\}_{i=1}^{n_{x}}$ denote the spatial DG basis, where $n_{x}=3N=150$. Discretize the stochastic space using Generalized Polynomial Chaos (gPC) with the orthonormal Legendre basis $\\{\\psi_{k}(\\xi)\\}_{k=0}^{p_{s}}$ up to total degree $p_{s}=4$ in the single variable $\\xi$; thus the number of stochastic basis functions is $n_{s}=p_{s}+1=5$. Form the Galerkin approximation\n$$\nu_{h}(x,\\xi)=\\sum_{i=1}^{n_{x}}\\sum_{k=0}^{p_{s}} c_{ik}\\,\\varphi_{i}(x)\\,\\psi_{k}(\\xi),\n$$\nand use the standard DG weak formulation in space combined with Galerkin projection in the stochastic space, with the stochastic inner product\n$$\n\\langle g,h\\rangle := \\int_{-1}^{1} g(\\xi)\\,h(\\xi)\\,\\frac{1}{2}\\,d\\xi.\n$$\n\nStarting from the fundamental definitions of the symmetric interior penalty DG bilinear form and the Galerkin projection in the stochastic space with an orthonormal basis, carry out the following:\n\n1. Derive the global algebraic system that couples spatial and stochastic degrees of freedom. Express the system matrix in a Kronecker product form that separates deterministic spatial operators and stochastic moment matrices. Your derivation must start from the DG weak form and the gPC Galerkin projection and justify the separation explicitly from first principles (orthogonality and bilinearity).\n\n2. Using the well-known three-term recurrence for orthonormal Legendre polynomials, identify the sparsity pattern of the stochastic moment matrices arising from the terms with $a_{0}(x)$ and $a_{1}(x)\\,\\xi$. Explain, based on orthonormality and parity, whether any diagonal entries appear in the stochastic matrix associated with multiplication by $\\xi$.\n\n3. Using the standard structure of the symmetric interior penalty DG stiffness operator with $r=2$ on a uniform mesh, observe that each element contributes a $3\\times 3$ dense block on the main block diagonal, and nearest-neighbor couplings contribute $3\\times 3$ dense blocks on the first off-diagonals. Assuming that these blocks are dense and the coefficient functions do not introduce additional zeros, determine the exact number of nonzero entries in each spatial stiffness matrix obtained from $a_{0}$ and $a_{1}$ separately.\n\n4. Combine your findings to compute the exact number of nonzero entries of the full global system matrix obtained from the Kronecker-structured sum. You may assume that the Kronecker product of two sparse matrices has a nonzero pattern that is the Cartesian product of the factors’ nonzero patterns, and that the contributions from the $a_{0}$ and $a_{1}$ terms do not overlap in the global matrix because one occupies only block-diagonal stochastic positions and the other occupies only strictly off-diagonal stochastic positions.\n\nGive your final answer as a single integer equal to the exact number of nonzero entries in the full global matrix. No rounding is required.", "solution": "### 1. Derivation of the Global Algebraic System\n\nThe given partial differential equation is:\n$$\n-\\frac{d}{dx}\\!\\left(a(x,\\xi)\\,\\frac{du}{dx}(x,\\xi)\\right)=f(x) \\quad \\text{for } x \\in (0,1)\n$$\nwith $u(0,\\xi)=u(1,\\xi)=0$. The random coefficient is $a(x,\\xi) = a_0(x) + a_1(x)\\xi$.\n\nThe solution $u(x,\\xi)$ is approximated using a separation of variables and a Galerkin expansion:\n$$\nu_h(x,\\xi) = \\sum_{i=1}^{n_x} \\sum_{k=0}^{p_s} c_{ik} \\varphi_i(x) \\psi_k(\\xi)\n$$\nwhere $\\{\\varphi_i(x)\\}$ is the spatial DG basis and $\\{\\psi_k(\\xi)\\}$ is the stochastic gPC basis. The test functions are of the form $v_{jl}(x,\\xi) = \\varphi_j(x)\\psi_l(\\xi)$.\n\nThe weak formulation combines the spatial DG formulation with a stochastic Galerkin projection. The symmetric interior penalty DG bilinear form, denoted $B(g;u,v)$, is linear in its first argument, the coefficient function $g$. For a fixed $\\xi$, the spatial weak problem is to find $u(\\cdot, \\xi) \\in V_h = \\text{span}\\{\\varphi_i\\}_{i=1}^{n_x}$ such that for all $v_h \\in V_h$:\n$$\nB(a(\\cdot,\\xi); u(\\cdot,\\xi), v_h) = (f, v_h)_{\\mathcal{D}}\n$$\nwhere $(\\cdot,\\cdot)_{\\mathcal{D}}$ is the $L^2((0,1))$ inner product.\n\nSubstituting the expansion for $u(x,\\xi) = \\sum_i u_i(\\xi) \\varphi_i(x)$ and using $v_h = \\varphi_j$, we obtain a system of equations for the coefficient functions $u_i(\\xi)$:\n$$\n\\sum_{i=1}^{n_x} B(a(\\cdot, \\xi); \\varphi_i, \\varphi_j) u_i(\\xi) = (f, \\varphi_j)_{\\mathcal{D}} \\quad \\text{for } j=1, \\dots, n_x\n$$\nUsing the affine form of $a(x,\\xi)$ and the linearity of $B(\\cdot; \\cdot, \\cdot)$:\n$$\nB(a(\\cdot, \\xi); \\varphi_i, \\varphi_j) = B(a_0(\\cdot) + a_1(\\cdot)\\xi; \\varphi_i, \\varphi_j) = B(a_0; \\varphi_i, \\varphi_j) + \\xi B(a_1; \\varphi_i, \\varphi_j)\n$$\nLet's define the deterministic spatial stiffness matrices $K_0$ and $K_1$ with entries:\n$$\n(K_0)_{ji} = B(a_0; \\varphi_i, \\varphi_j) \\quad \\text{and} \\quad (K_1)_{ji} = B(a_1; \\varphi_i, \\varphi_j)\n$$\nand the spatial load vector $F_{sp}$ with entries $(F_{sp})_j = (f, \\varphi_j)_{\\mathcal{D}}$. The semi-discretized system (discrete in space, continuous in $\\xi$) is:\n$$\n(K_0 + \\xi K_1) \\mathbf{u}(\\xi) = F_{sp}\n$$\nwhere $\\mathbf{u}(\\xi)$ is the vector of coefficient functions $[u_1(\\xi), \\dots, u_{n_x}(\\xi)]^T$.\n\nNext, we apply Galerkin projection in the stochastic space. We expand the vector of functions $\\mathbf{u}(\\xi)$ in the gPC basis: $\\mathbf{u}(\\xi) = \\sum_{k=0}^{p_s} C_k \\psi_k(\\xi)$, where $C_k = [c_{1k}, c_{2k}, \\dots, c_{n_x,k}]^T$ is the vector of deterministic coefficients for the $k$-th stochastic basis function. The Galerkin condition requires the residual to be orthogonal to the test basis $\\{\\psi_l(\\xi)\\}_{l=0}^{p_s}$ with respect to the stochastic inner product $\\langle\\cdot, \\cdot\\rangle$:\n$$\n\\left\\langle (K_0 + \\xi K_1) \\sum_{k=0}^{p_s} C_k \\psi_k(\\xi) - F_{sp}, \\psi_l(\\xi) \\right\\rangle = 0 \\quad \\text{for } l=0, \\dots, p_s\n$$\nSince $K_0$, $K_1$, $C_k$, and $F_{sp}$ are deterministic, we can pull them out of the inner product:\n$$\n\\sum_{k=0}^{p_s} K_0 C_k \\langle \\psi_k, \\psi_l \\rangle + \\sum_{k=0}^{p_s} K_1 C_k \\langle \\xi \\psi_k, \\psi_l \\rangle = F_{sp} \\langle 1, \\psi_l \\rangle\n$$\nThe basis $\\{\\psi_k\\}$ is orthonormal, so $\\langle \\psi_k, \\psi_l \\rangle = \\delta_{kl}$. The constant function is $\\psi_0(\\xi) = 1$, which is normalized since $\\langle 1,1 \\rangle = \\int_{-1}^1 1^2 \\frac{1}{2} d\\xi = 1$. Thus, $\\langle 1, \\psi_l \\rangle = \\langle \\psi_0, \\psi_l \\rangle = \\delta_{0l}$.\nLet's define the stochastic moment matrices $M_0$ and $M_1$ of size $n_s \\times n_s = (p_s+1)\\times(p_s+1)$:\n$$\n(M_0)_{lk} = \\langle \\psi_k, \\psi_l \\rangle = \\delta_{kl} \\quad \\implies \\quad M_0 = I_{n_s}\n$$\n$$\n(M_1)_{lk} = \\langle \\xi \\psi_k, \\psi_l \\rangle\n$$\nThe system for a given $l$ becomes:\n$$\nK_0 C_l + \\sum_{k=0}^{p_s} (M_1)_{lk} K_1 C_k = F_{sp} \\delta_{0l}\n$$\nThis represents $n_s$ coupled linear systems. Let $\\mathcal{C}$ be the global vector of unknowns, formed by stacking the vectors $C_k$: $\\mathcal{C} = [C_0^T, C_1^T, \\dots, C_{p_s}^T]^T$. The full algebraic system can be written in block form. The $(l,k)$-th block of the system matrix is $(M_0)_{lk}K_0 + (M_1)_{lk}K_1 = \\delta_{lk}K_0 + (M_1)_{lk}K_1$.\nThis block structure is precisely the definition of a sum of Kronecker products. The global system matrix $\\mathcal{K}$ is:\n$$\n\\mathcal{K} = M_0 \\otimes K_0 + M_1 \\otimes K_1 = I_{n_s} \\otimes K_0 + M_1 \\otimes K_1\n$$\nwhere $I_{n_s}$ is the $n_s \\times n_s$ identity matrix. The global system is $\\mathcal{K}\\mathcal{C} = \\mathcal{F}$, where $\\mathcal{F}$ is the global right-hand side vector $[F_{sp}^T, 0, \\dots, 0]^T$.\n\n### 2. Sparsity of Stochastic Moment Matrices\n\nThe basis $\\{\\psi_k(\\xi)\\}_{k=0}^{p_s}$ consists of orthonormal Legendre polynomials for the uniform measure on $[-1,1]$ with weight $1/2$. The three-term recurrence relation for orthogonal polynomials states that $\\xi \\psi_k(\\xi)$ is a linear combination of $\\psi_{k-1}(\\xi)$, $\\psi_k(\\xi)$, and $\\psi_{k+1}(\\xi)$. For Legendre polynomials, this relation simplifies such that $\\xi \\psi_k(\\xi)$ is a linear combination of only $\\psi_{k-1}(\\xi)$ and $\\psi_{k+1}(\\xi)$.\nTherefore, the matrix $M_1$ with entries $(M_1)_{lk} = \\langle \\xi \\psi_k, \\psi_l \\rangle$ is nonzero only when $l=k+1$ or $l=k-1$. This means $M_1$ is a symmetric tridiagonal matrix.\n\nThe diagonal entries are $(M_1)_{kk} = \\langle \\xi \\psi_k, \\psi_k \\rangle = \\int_{-1}^1 \\xi \\psi_k^2(\\xi) \\frac{1}{2} d\\xi$. Since Legendre polynomials $P_k(\\xi)$ have parity $(-1)^k$, their squares $P_k^2(\\xi)$ are always even functions. The same holds for the orthonormal basis $\\psi_k^2(\\xi)$. The integrand $\\xi \\psi_k^2(\\xi)$ is an odd function. The integral of an odd function over the symmetric interval $[-1,1]$ is zero. Therefore, all diagonal entries of $M_1$ are zero.\n\nThe matrix $M_1$ is a symmetric matrix with a zero diagonal and non-zero entries only on the first super- and sub-diagonals. For $p_s=4$, the matrix dimension is $n_s=p_s+1=5$. There are $n_s-1=4$ non-zero entries on the super-diagonal and $4$ on the sub-diagonal. The total number of nonzero entries in $M_1$ is $nnz(M_1) = 2(n_s-1) = 2(5-1) = 8$.\n\n### 3. Number of Nonzero Entries in Spatial Matrices\n\nThe spatial discretization uses a uniform mesh of $N=50$ elements and DG with polynomial degree $r=2$. The number of local basis functions per element is $r+1=3$. The total number of spatial degrees of freedom is $n_x = (r+1)N = 3 \\times 50 = 150$.\n\nThe problem states that the DG stiffness matrix (for either $K_0$ or $K_1$) has a specific block structure:\n-   $N=50$ dense $3 \\times 3$ blocks on the main diagonal, corresponding to interactions within each element.\n-   $N-1=49$ dense $3 \\times 3$ blocks on the first super-diagonal and $N-1=49$ dense $3 \\times 3$ blocks on the first sub-diagonal, corresponding to interactions between adjacent elements.\n\nThe total number of non-zero entries in a spatial matrix $K$ (either $K_0$ or $K_1$) is the sum of non-zeros from all these blocks.\n-   Non-zeros from diagonal blocks: $N \\times (3 \\times 3) = 50 \\times 9 = 450$.\n-   Non-zeros from off-diagonal blocks: $2 \\times (N-1) \\times (3 \\times 3) = 2 \\times 49 \\times 9 = 98 \\times 9 = 882$.\n\nThe total number of non-zeros in one spatial matrix is $nnz(K) = 450 + 882 = 1332$.\nThis holds for both $K_0$ and $K_1$, so $nnz(K_0) = nnz(K_1) = 1332$.\n\n### 4. Total Number of Nonzero Entries in the Global Matrix\n\nThe global system matrix is $\\mathcal{K} = I_{n_s} \\otimes K_0 + M_1 \\otimes K_1$. We use the property $nnz(A \\otimes B) = nnz(A) \\times nnz(B)$.\n\nThe first term is $I_{n_s} \\otimes K_0$. The matrix $I_{n_s}$ is the $5 \\times 5$ identity matrix, so $nnz(I_{n_s})=5$.\n$$\nnnz(I_{n_s} \\otimes K_0) = nnz(I_{n_s}) \\times nnz(K_0) = 5 \\times 1332 = 6660\n$$\nThe second term is $M_1 \\otimes K_1$. From Part 2, $nnz(M_1) = 8$.\n$$\nnnz(M_1 \\otimes K_1) = nnz(M_1) \\times nnz(K_1) = 8 \\times 1332 = 10656\n$$\nThe problem correctly states that the nonzero patterns of these two terms are disjoint. The term $I_{n_s} \\otimes K_0$ contributes only to the block-diagonal of $\\mathcal{K}$ (blocks $(l,l)$), while $M_1 \\otimes K_1$ contributes only to the block off-diagonals (blocks $(l,k)$ with $l \\neq k$), because $M_1$ has a zero diagonal. Consequently, the total number of non-zeros is the sum of the non-zeros from each term.\n\n$$\nnnz(\\mathcal{K}) = nnz(I_{n_s} \\otimes K_0) + nnz(M_1 \\otimes K_1) = 6660 + 10656 = 17316\n$$\nThe total number of nonzero entries in the full global system matrix is $17316$.", "answer": "$$\n\\boxed{17316}\n$$", "id": "3426079"}]}