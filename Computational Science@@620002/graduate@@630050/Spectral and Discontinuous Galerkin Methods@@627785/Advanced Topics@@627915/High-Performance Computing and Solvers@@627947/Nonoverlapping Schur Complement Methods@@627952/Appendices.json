{"hands_on_practices": [{"introduction": "This first exercise provides a concrete connection between the abstract Schur complement operator $S$ and the physical concept of energy. You will calculate the Schur complement energy for a simple 1D problem by first determining the discrete harmonic extension, which is the function that minimizes the Discontinuous Galerkin energy given specific interface values. This practice [@problem_id:3404183] clarifies the variational meaning of the Schur complement and demonstrates how it emerges directly from the underlying bilinear form.", "problem": "Consider the symmetric interior penalty Galerkin (SIPG) discretization of the homogeneous diffusion equation $-u''=0$ on the one-dimensional domain $\\Omega=[0,1]$ with homogeneous Dirichlet boundary conditions $u(0)=0$ and $u(1)=0$. The mesh consists of two equal subdomains (elements) $E_{1}=[0,\\frac{1}{2}]$ and $E_{2}=[\\frac{1}{2},1]$, each equipped with a polynomial basis of degree $1$ given by the local Legendre polynomials on the reference interval $[-1,1]$, namely $\\phi_{0}(\\xi)=1$ and $\\phi_{1}(\\xi)=\\xi$, with the affine mapping $x=\\frac{h}{2}(\\xi+1)$ where $h=\\frac{1}{2}$ is the element length. On each element $E_{i}$ the discrete function is $u_{i}(\\xi)=a_{i}\\phi_{0}(\\xi)+b_{i}\\phi_{1}(\\xi)$.\n\nLet the symmetric interior penalty Galerkin bilinear form $a(\\cdot,\\cdot)$ be defined in one dimension by\n$$\na(u,v)=\\sum_{E}\\int_{E}u'(x)v'(x)\\,dx-\\sum_{F\\in\\mathcal{F}_{\\mathrm{int}}}\\left(\\{u'\\}\\,[v]+\\{v'\\}\\,[u]\\right)+\\sum_{F\\in\\mathcal{F}_{\\mathrm{int}}}\\frac{\\sigma}{h_{F}}[u][v]+\\sum_{F\\in\\mathcal{F}_{\\partial\\Omega}}\\left(-u' n\\, v - v' n\\, u + \\frac{\\sigma}{h_{F}}u v\\right),\n$$\nwhere $\\mathcal{F}_{\\mathrm{int}}$ is the set of interior faces, $\\mathcal{F}_{\\partial\\Omega}$ is the set of boundary faces, $h_{F}$ is the adjacent element length, $n$ is the outward unit normal on faces, $[u]$ denotes the jump of $u$ across an interior face, and $\\{u'\\}$ denotes the average of the normal derivatives across that face. The penalty parameter $\\sigma>0$ is a given positive constant.\n\nIn the nonoverlapping Schur complement framework for discontinuous Galerkin methods, one condenses interior element coefficients and obtains a skeletal operator $S$ acting on a vector of face values. In this two-element case, the skeletal vector reduces to a single scalar interface value. Denote this interface vector by $\\mathbf{x}\\in\\mathbb{R}$ and its sole component by $x$, representing the common trace value imposed on both sides of the shared interior face at $x=\\frac{1}{2}$.\n\nDefine the discrete harmonic extension as the minimizer $u_{h}\\in V_{h}$ of the SIPG energy $a(u,u)$ over the discrete space $V_{h}$ of piecewise degree-$1$ polynomials on $E_{1}$ and $E_{2}$, subject to the trace constraints $u(0)=0$, $u(\\tfrac{1}{2}^{-})=x$, $u(\\tfrac{1}{2}^{+})=x$, and $u(1)=0$. For the particular case of unit displacement $x=1$, compute the corresponding discrete harmonic extension and evaluate the Schur complement energy $x^{T}S x=a(u_{h},u_{h})$.\n\nProvide your final answer exactly as a single real number. No rounding is required, and no units are necessary.", "solution": "The problem requires the computation of the Schur complement energy, $x^{T}S x$, for a specific case of a symmetric interior penalty Galerkin (SIPG) discretization. The problem states that this energy is equal to the SIPG energy of the discrete harmonic extension, i.e., $x^{T}S x = a(u_{h}, u_{h})$. We are asked to compute this value for a unit displacement at the interface, which corresponds to setting the interface value $x$ to $1$.\n\nFirst, we must determine the discrete harmonic extension $u_h$ for the interface value $x=1$. The function $u_h$ belongs to the discrete space $V_h$ of piecewise polynomials of degree $1$ on the mesh elements $E_{1}=[0,\\frac{1}{2}]$ and $E_{2}=[\\frac{1}{2},1]$. The harmonic extension is defined as the minimizer of the energy $a(u,u)$ subject to a set of trace constraints. For our case with $x=1$, these constraints are:\n$1$. $u(0)=0$\n$2$. $u(\\frac{1}{2}^{-})=1$\n$3$. $u(\\frac{1}{2}^{+})=1$\n$4$. $u(1)=0$\n\nThe space $V_h$ consists of functions that are linear on each element. Let's represent the function $u_h$ on each element $E_i$ as a linear polynomial of the spatial coordinate $x$.\nOn element $E_1 = [0, \\frac{1}{2}]$, let $u_1(x) = c_1 x + d_1$. The constraints are:\n$u_1(0) = 0 \\implies c_1(0) + d_1 = 0 \\implies d_1 = 0$.\n$u_1(\\frac{1}{2}) = 1 \\implies c_1(\\frac{1}{2}) = 1 \\implies c_1 = 2$.\nThus, on $E_1$, the function is $u_1(x) = 2x$. The derivative is $u_1'(x) = 2$.\n\nOn element $E_2 = [\\frac{1}{2}, 1]$, let $u_2(x) = c_2 x + d_2$. The constraints are:\n$u_2(\\frac{1}{2}) = 1 \\implies c_2(\\frac{1}{2}) + d_2 = 1$.\n$u_2(1) = 0 \\implies c_2(1) + d_2 = 0 \\implies d_2 = -c_2$.\nSubstituting the second equation into the first gives $\\frac{1}{2}c_2 - c_2 = 1$, which simplifies to $-\\frac{1}{2}c_2 = 1$, so $c_2 = -2$. This implies $d_2 = -(-2) = 2$.\nThus, on $E_2$, the function is $u_2(x) = -2x+2 = 2(1-x)$. The derivative is $u_2'(x) = -2$.\n\nThe discrete function $u_h$ is uniquely determined by these constraints. The minimization aspect of the definition is fulfilled trivially as the set of admissible functions contains only one element. So, the discrete harmonic extension for $x=1$ is:\n$$\nu_h(x) = \\begin{cases} 2x & \\text{for } x \\in [0, \\frac{1}{2}] \\\\ 2(1-x) & \\text{for } x \\in [\\frac{1}{2}, 1] \\end{cases}\n$$\nAnd its derivative is:\n$$\nu_h'(x) = \\begin{cases} 2 & \\text{for } x \\in (0, \\frac{1}{2}) \\\\ -2 & \\text{for } x \\in (\\frac{1}{2}, 1) \\end{cases}\n$$\nNow we must compute $a(u_h, u_h)$ using the provided bilinear form:\n$$\na(u,v)=\\sum_{E}\\int_{E}u'(x)v'(x)\\,dx-\\sum_{F\\in\\mathcal{F}_{\\mathrm{int}}}\\left(\\{u'\\}\\,[v]+\\{v'\\}\\,[u]\\right)+\\sum_{F\\in\\mathcal{F}_{\\mathrm{int}}}\\frac{\\sigma}{h_{F}}[u][v]+\\sum_{F\\in\\mathcal{F}_{\\partial\\Omega}}\\left(-2u' n\\, v + \\frac{\\sigma}{h_{F}}u^2\\right)\n$$\nWe evaluate $a(u_h, u_h)$ term by term.\n\n$1$. Volume integral term: $\\sum_{E}\\int_{E}(u_h'(x))^2\\,dx$\nThis is the sum of integrals over the two elements $E_1$ and $E_2$.\n$$\n\\int_{E_1} (u_1'(x))^2 \\,dx = \\int_{0}^{1/2} (2)^2 \\,dx = 4 \\int_{0}^{1/2} dx = 4 \\left(\\frac{1}{2}\\right) = 2.\n$$\n$$\n\\int_{E_2} (u_2'(x))^2 \\,dx = \\int_{1/2}^{1} (-2)^2 \\,dx = 4 \\int_{1/2}^{1} dx = 4 \\left(1-\\frac{1}{2}\\right) = 2.\n$$\nThe sum is $2+2=4$.\n\n$2$. Interior face terms: contributions from $F \\in \\mathcal{F}_{\\mathrm{int}} = \\{\\frac{1}{2}\\}$.\nThese terms involve jumps $[u_h]$ and averages $\\{u_h'\\}$ at the interior face $x=\\frac{1}{2}$. Let's define the jump at a face as the difference between the values on the left ($L$) and right ($R$) elements, i.e., $[q] = q_L - q_R$.\nThe jump of the function $u_h$ is:\n$$\n[u_h] = u_1(\\tfrac{1}{2}) - u_2(\\tfrac{1}{2}) = 1 - 1 = 0.\n$$\nSince $[u_h]=0$, all terms containing it as a factor are zero. Specifically, the terms $-\\sum (\\{u_h'\\}[u_h] + \\{u_h'\\}[u_h])$ and $\\sum \\frac{\\sigma}{h_F} [u_h][u_h]$ are both zero.\n$$\n-2\\{u_h'\\} [u_h] + \\frac{\\sigma}{h_F}[u_h]^2 = -2\\{u_h'\\}(0) + \\frac{\\sigma}{h_F}(0)^2 = 0.\n$$\nThus, the contribution from the interior face is $0$.\n\n$3$. Boundary face terms: contributions from $F \\in \\mathcal{F}_{\\partial\\Omega} = \\{0, 1\\}$.\nThe term is $\\sum_{F\\in\\mathcal{F}_{\\partial\\Omega}}\\left(-2u' n\\, u + \\frac{\\sigma}{h_{F}}u^2\\right)$.\nAt the boundary face $F=\\{0\\}$, the function value is $u_h(0)=0$. The outward normal is $n=-1$.\nThe contribution is $-2u_h'(0)n u_h(0) + \\frac{\\sigma}{h}u_h(0)^2 = -2(2)(-1)(0) + \\frac{\\sigma}{1/2}(0)^2 = 0$.\nAt the boundary face $F=\\{1\\}$, the function value is $u_h(1)=0$. The outward normal is $n=1$.\nThe contribution is $-2u_h'(1)n u_h(1) + \\frac{\\sigma}{h}u_h(1)^2 = -2(-2)(1)(0) + \\frac{\\sigma}{1/2}(0)^2 = 0$.\nThus, the total contribution from the boundary faces is $0$.\n\nFinally, we sum all contributions to find the total energy $a(u_h, u_h)$:\n$$\na(u_h, u_h) = 4 + 0 + 0 = 4.\n$$\nThe Schur complement energy $x^T S x$ for $x=1$ is therefore $4$.", "answer": "$$\\boxed{4}$$", "id": "3404183"}, {"introduction": "Building on the conceptual foundation, this practice delves into the algebraic machinery required to assemble the Schur complement operator at an interface between non-conforming elements. When adjacent elements use different polynomial degrees, a projection is needed to enforce continuity in a weak sense. This exercise [@problem_id:3404186] guides you through the construction of interface mass matrices and the crucial $L^2$ projection operator, culminating in the assembly of a mortar-based Schur complement, a key technique in flexible high-order methods.", "problem": "Consider two affine quadrilateral elements in two spatial dimensions that share a vertical interface. Let the left element be $K_{L}=[-1,0]\\times[-1,1]$ and the right element be $K_{R}=[0,1]\\times[-1,1]$. The common interface is the vertical segment $\\Gamma=\\{0\\}\\times[-1,1]$, of physical length $2$. Assume a Discontinuous Galerkin (DG) trace space on each side that is spanned on $\\Gamma$ by the restrictions of a tensor-product modal basis using Legendre polynomials in the coordinate along the interface. On the left, use polynomial degree $p_{L}=2$ along $\\Gamma$ with the trace basis $\\{\\phi_{i}(s)\\}_{i=0}^{2}$ where $\\phi_{i}(s)=P_{i}(s)$, and on the right, use degree $p_{R}=3$ with $\\{\\psi_{j}(s)\\}_{j=0}^{3}$ where $\\psi_{j}(s)=P_{j}(\\tilde{s})$. Here $P_{n}$ denotes the $n$-th Legendre polynomial on $[-1,1]$, $s\\in[-1,1]$ is the coordinate along $\\Gamma$ oriented upward with respect to $K_{L}$, and $\\tilde{s}\\in[-1,1]$ is the coordinate along $\\Gamma$ in the local orientation of $K_{R}$ chosen downward so that $\\tilde{s}=-s$. \n\nUse the following fundamental facts:\n- The $L^{2}$ inner product on $\\Gamma$ is $(u,v)_{\\Gamma}=\\int_{-1}^{1}u(s)\\,v(s)\\,ds$ because the physical-to-reference mapping on $\\Gamma$ has unit Jacobian for this geometry.\n- The Legendre polynomials satisfy the orthogonality relation $\\int_{-1}^{1}P_{m}(s)\\,P_{n}(s)\\,ds=\\dfrac{2}{2n+1}\\,\\delta_{mn}$.\n- The $L^{2}$ projection from the right trace space to the left trace space is defined by: given a coefficient vector $c_{R}\\in\\mathbb{R}^{4}$, find $c_{L}\\in\\mathbb{R}^{3}$ such that $\\sum_{i=0}^{2}c_{L,i}\\phi_{i}$ minimizes $\\left\\|\\sum_{i=0}^{2}c_{L,i}\\phi_{i}-\\sum_{j=0}^{3}c_{R,j}\\psi_{j}\\right\\|_{L^{2}(\\Gamma)}$. This yields the normal equations $M_{L}\\,c_{L}=B\\,c_{R}$, where $(M_{L})_{ik}=(\\phi_{i},\\phi_{k})_{\\Gamma}$ and $B_{ij}=(\\phi_{i},\\psi_{j})_{\\Gamma}$.\n- In a nonoverlapping Schur complement method for a symmetric positive definite model problem with a hybridized trace, the interface bilinear form assembled on a chosen mortar trace space equals the sum of the contributions of the neighboring elements. When the mortar is the left trace space and one uses the $L^{2}$ projection described above to represent the right contribution in the left space, the assembled interface operator $S$ acting on left trace coefficients is obtained by combining the left interface mass form with the right interface mass form represented through the projection.\n\nTasks:\n1. Construct explicitly the left and right interface mass matrices $M_{L}\\in\\mathbb{R}^{3\\times 3}$ and $M_{R}\\in\\mathbb{R}^{4\\times 4}$ on $\\Gamma$ using the bases $\\{\\phi_{i}\\}$ and $\\{\\psi_{j}\\}$ and the $L^{2}$ inner product on $\\Gamma$.\n2. Construct explicitly the projection matrix $P\\in\\mathbb{R}^{3\\times 4}$ that maps right trace coefficients to left trace coefficients via the $L^{2}$ projection defined above, taking into account the orientation $\\tilde{s}=-s$ on the right.\n3. Using the ingredients above and representing the right contribution on the left trace space through the projection, assemble the mortar-side interface operator $S\\in\\mathbb{R}^{3\\times 3}$ associated with the interface $\\Gamma$.\n4. Compute $\\det(S)$ and provide your final answer as an exact expression. Do not round. No units are required.", "solution": "The problem asks for the determinant of an interface operator $S$ constructed in the framework of a nonoverlapping Schur complement method for a Discontinuous Galerkin (DG) discretization. The solution requires constructing several matrices based on the properties of Legendre polynomials and then combining them according to the rules of mortar methods.\n\nThe steps are as follows:\n1.  Construct the interface mass matrices $M_L$ and $M_R$.\n2.  Construct the projection matrix $P$ from the right trace space to the left trace space. This first involves constructing the cross-mass matrix $B$.\n3.  Assemble the mortar-side interface operator $S$.\n4.  Compute the determinant of $S$.\n\nFirst, let's list the relevant Legendre polynomials, $P_n(s)$:\n$P_0(s) = 1$\n$P_1(s) = s$\n$P_2(s) = \\frac{1}{2}(3s^2 - 1)$\n$P_3(s) = \\frac{1}{2}(5s^3 - 3s)$\nThe key properties we will use are the orthogonality relation, $\\int_{-1}^{1}P_{m}(s)P_{n}(s)ds=\\frac{2}{2n+1}\\delta_{mn}$, and the parity property, $P_n(-s) = (-1)^n P_n(s)$.\n\n**Task 1: Construction of mass matrices $M_L$ and $M_R$**\n\nThe left trace space is spanned by $\\{\\phi_i(s) = P_i(s)\\}_{i=0}^2$. The left mass matrix $M_L \\in \\mathbb{R}^{3\\times 3}$ has entries given by $(M_L)_{ik} = (\\phi_i, \\phi_k)_{\\Gamma} = \\int_{-1}^{1} P_i(s) P_k(s) ds$. Due to the orthogonality of Legendre polynomials, this matrix is diagonal:\n$$\n(M_L)_{ik} = \\frac{2}{2i+1} \\delta_{ik}\n$$\nFor $i, k \\in \\{0, 1, 2\\}$, the matrix is:\n$$\nM_L = \\begin{pmatrix}\n\\frac{2}{2(0)+1} & 0 & 0 \\\\\n0 & \\frac{2}{2(1)+1} & 0 \\\\\n0 & 0 & \\frac{2}{2(2)+1}\n\\end{pmatrix}\n= \\begin{pmatrix}\n2 & 0 & 0 \\\\\n0 & \\frac{2}{3} & 0 \\\\\n0 & 0 & \\frac{2}{5}\n\\end{pmatrix}\n$$\n\nThe right trace space is spanned by $\\{\\psi_j(s) = P_j(\\tilde{s})\\}_{j=0}^3$, with $\\tilde{s} = -s$. The right mass matrix $M_R \\in \\mathbb{R}^{4\\times 4}$ has entries $(M_R)_{jk} = (\\psi_j, \\psi_k)_{\\Gamma} = \\int_{-1}^{1} P_j(\\tilde{s}) P_k(\\tilde{s}) ds$. We perform a change of variables from $s$ to $\\tilde{s}$. As $s$ goes from $-1$ to $1$, $\\tilde{s}$ goes from $1$ to $-1$. Also, $ds = -d\\tilde{s}$.\n$$\n(M_R)_{jk} = \\int_{1}^{-1} P_j(\\tilde{s}) P_k(\\tilde{s}) (-d\\tilde{s}) = \\int_{-1}^{1} P_j(\\tilde{s}) P_k(\\tilde{s}) d\\tilde{s}\n$$\nThis is the standard orthogonality integral. Thus, $M_R$ is also diagonal:\n$$\n(M_R)_{jk} = \\frac{2}{2j+1} \\delta_{jk}\n$$\nFor $j, k \\in \\{0, 1, 2, 3\\}$, the matrix is:\n$$\nM_R = \\begin{pmatrix}\n\\frac{2}{1} & 0 & 0 & 0 \\\\\n0 & \\frac{2}{3} & 0 & 0 \\\\\n0 & 0 & \\frac{2}{5} & 0 \\\\\n0 & 0 & 0 & \\frac{2}{7}\n\\end{pmatrix}\n= \\begin{pmatrix}\n2 & 0 & 0 & 0 \\\\\n0 & \\frac{2}{3} & 0 & 0 \\\\\n0 & 0 & \\frac{2}{5} & 0 \\\\\n0 & 0 & 0 & \\frac{2}{7}\n\\end{pmatrix}\n$$\n\n**Task 2: Construction of the projection matrix $P$**\n\nThe problem defines the $L^2$ projection via the normal equations $M_L c_L = B c_R$, where $c_L$ and $c_R$ are coefficient vectors. The projection matrix $P$ that maps right coefficients to left coefficients is therefore $P = M_L^{-1} B$. We first need to compute the cross-mass matrix $B \\in \\mathbb{R}^{3\\times 4}$. Its entries are $B_{ij} = (\\phi_i, \\psi_j)_{\\Gamma}$.\n$$\nB_{ij} = \\int_{-1}^{1} \\phi_i(s) \\psi_j(s) ds = \\int_{-1}^{1} P_i(s) P_j(\\tilde{s}) ds = \\int_{-1}^{1} P_i(s) P_j(-s) ds\n$$\nUsing the parity property $P_j(-s) = (-1)^j P_j(s)$:\n$$\nB_{ij} = \\int_{-1}^{1} P_i(s) (-1)^j P_j(s) ds = (-1)^j \\int_{-1}^{1} P_i(s) P_j(s) ds = (-1)^j \\frac{2}{2i+1} \\delta_{ij}\n$$\nGiven that $i \\in \\{0, 1, 2\\}$ and $j \\in \\{0, 1, 2, 3\\}$, the resulting matrix $B$ is:\n$$\nB = \\begin{pmatrix}\n(-1)^0 \\frac{2}{1} & 0 & 0 & 0 \\\\\n0 & (-1)^1 \\frac{2}{3} & 0 & 0 \\\\\n0 & 0 & (-1)^2 \\frac{2}{5} & 0\n\\end{pmatrix}\n= \\begin{pmatrix}\n2 & 0 & 0 & 0 \\\\\n0 & -\\frac{2}{3} & 0 & 0 \\\\\n0 & 0 & \\frac{2}{5} & 0\n\\end{pmatrix}\n$$\nNow we find $P = M_L^{-1} B$. First, we compute $M_L^{-1}$:\n$$\nM_L^{-1} = \\left( \\begin{pmatrix}\n2 & 0 & 0 \\\\\n0 & \\frac{2}{3} & 0 \\\\\n0 & 0 & \\frac{2}{5}\n\\end{pmatrix} \\right)^{-1} = \\begin{pmatrix}\n\\frac{1}{2} & 0 & 0 \\\\\n0 & \\frac{3}{2} & 0 \\\\\n0 & 0 & \\frac{5}{2}\n\\end{pmatrix}\n$$\nThen, the projection matrix $P$ is:\n$$\nP = M_L^{-1} B = \\begin{pmatrix}\n\\frac{1}{2} & 0 & 0 \\\\\n0 & \\frac{3}{2} & 0 \\\\\n0 & 0 & \\frac{5}{2}\n\\end{pmatrix}\n\\begin{pmatrix}\n2 & 0 & 0 & 0 \\\\\n0 & -\\frac{2}{3} & 0 & 0 \\\\\n0 & 0 & \\frac{2}{5} & 0\n\\end{pmatrix}\n= \\begin{pmatrix}\n1 & 0 & 0 & 0 \\\\\n0 & -1 & 0 & 0 \\\\\n0 & 0 & 1 & 0\n\\end{pmatrix}\n$$\n\n**Task 3: Assembly of the interface operator $S$**\n\nThe problem describes the assembly of a mortar-side operator $S \\in \\mathbb{R}^{3\\times 3}$ for a symmetric positive definite problem. A standard construction for such an operator, consistent with the problem's description of combining contributions, is based on a variational formulation where the slave trace is constrained to be a projection of the master trace. If $\\lambda_L$ and $\\lambda_R$ are the traces with coefficient vectors $c_L$ and $c_L$ respectively, and the left side is the mortar (master), the constraint is $\\lambda_R = \\Pi_R(\\lambda_L)$, where $\\Pi_R$ is the $L^2$ projection from the left space to the right space. This leads to the coefficient relation $c_R = M_R^{-1} B^T c_L$. The total interface energy is $E = \\frac{1}{2} c_L^T M_L c_L + \\frac{1}{2} c_R^T M_R c_R$. Substituting the constraint for $c_R$:\n$$\nE = \\frac{1}{2} c_L^T M_L c_L + \\frac{1}{2} (M_R^{-1} B^T c_L)^T M_R (M_R^{-1} B^T c_L) = \\frac{1}{2} c_L^T (M_L + B M_R^{-1} B^T) c_L\n$$\nThe resulting symmetric mortar operator is thus $S = M_L + B M_R^{-1} B^T$.\n\nWe compute the second term, $B M_R^{-1} B^T$.\n$M_R^{-1} = \\text{diag}(\\frac{1}{2}, \\frac{3}{2}, \\frac{5}{2}, \\frac{7}{2})$.\n$B^T = \\begin{pmatrix} 2 & 0 & 0 \\\\ 0 & -\\frac{2}{3} & 0 \\\\ 0 & 0 & \\frac{2}{5} \\\\ 0 & 0 & 0 \\end{pmatrix}$.\nThe term $B M_R^{-1}$ is:\n$$\nB M_R^{-1} = \\begin{pmatrix}\n2 & 0 & 0 & 0 \\\\\n0 & -\\frac{2}{3} & 0 & 0 \\\\\n0 & 0 & \\frac{2}{5} & 0\n\\end{pmatrix}\n\\begin{pmatrix}\n\\frac{1}{2} & 0 & 0 & 0 \\\\\n0 & \\frac{3}{2} & 0 & 0 \\\\\n0 & 0 & \\frac{5}{2} & 0 \\\\\n0 & 0 & 0 & \\frac{7}{2}\n\\end{pmatrix}\n= \\begin{pmatrix}\n1 & 0 & 0 & 0 \\\\\n0 & -1 & 0 & 0 \\\\\n0 & 0 & 1 & 0\n\\end{pmatrix} = P\n$$\nSo, $B M_R^{-1} B^T = P B^T$:\n$$\nP B^T = \\begin{pmatrix}\n1 & 0 & 0 & 0 \\\\\n0 & -1 & 0 & 0 \\\\\n0 & 0 & 1 & 0\n\\end{pmatrix}\n\\begin{pmatrix}\n2 & 0 & 0 \\\\\n0 & -\\frac{2}{3} & 0 \\\\\n0 & 0 & \\frac{2}{5} \\\\\n0 & 0 & 0\n\\end{pmatrix}\n= \\begin{pmatrix}\n2 & 0 & 0 \\\\\n0 & \\frac{2}{3} & 0 \\\\\n0 & 0 & \\frac{2}{5}\n\\end{pmatrix} = M_L\n$$\nThis remarkably simple result means that the projected contribution from the right element is identical to the contribution from the left element. Therefore, the assembled operator $S$ is:\n$$\nS = M_L + M_L = 2 M_L = 2 \\begin{pmatrix}\n2 & 0 & 0 \\\\\n0 & \\frac{2}{3} & 0 \\\\\n0 & 0 & \\frac{2}{5}\n\\end{pmatrix}\n= \\begin{pmatrix}\n4 & 0 & 0 \\\\\n0 & \\frac{4}{3} & 0 \\\\\n0 & 0 & \\frac{4}{5}\n\\end{pmatrix}\n$$\n\n**Task 4: Compute the determinant of $S$**\n\nThe determinant of the diagonal matrix $S$ is the product of its diagonal elements:\n$$\n\\det(S) = (4) \\times \\left(\\frac{4}{3}\\right) \\times \\left(\\frac{4}{5}\\right) = \\frac{4 \\times 4 \\times 4}{3 \\times 5} = \\frac{64}{15}\n$$\nThe value is an exact fraction.", "answer": "$$\\boxed{\\frac{64}{15}}$$", "id": "3404186"}, {"introduction": "The Schur complement system must be solved efficiently, and its conditioning dictates the performance of iterative solvers. This final practice transitions from matrix construction to spectral analysis, exploring the relationship between the global Schur complement's spectrum and the properties of local subdomain problems. By implementing a numerical experiment [@problem_id:3404164], you will investigate how the condition number $\\kappa(S)$ can be bounded using local Dirichlet-to-Neumann maps, providing essential insight into the design of domain decomposition preconditioners.", "problem": "Consider the one-dimensional symmetric diffusion model problem in the form $-(a(x) u'(x))' = f(x)$ posed on the closed interval $[0,1]$ with homogeneous Dirichlet boundary conditions $u(0) = 0$ and $u(1) = 0$. Let the interval be partitioned into $N$ nonoverlapping subdomains (elements) of equal length. On each subdomain, use a spectral element discretization with Legendre-Gauss-Lobatto (LGL) nodes of polynomial degree $p$ and quadrature weights that render the Galerkin bilinear form consistent for polynomial data. Assume the diffusion coefficient $a(x)$ is constant on each subdomain, taking value $a_e > 0$ on subdomain $e$, and that $f(x)$ plays no role in the matrix condition number.\n\nWithin each subdomain $e$, let the nodal basis be the Lagrange interpolants at the LGL nodes in the reference coordinate $\\xi \\in [-1,1]$, mapped affinely to the physical subdomain $[x_L^e, x_R^e]$ via $x(\\xi) = \\frac{x_L^e + x_R^e}{2} + \\frac{h_e}{2} \\xi$ with $h_e = x_R^e - x_L^e$. Denote by $D$ the derivative matrix of the Lagrange basis evaluated at the LGL nodes in the reference coordinate, by $\\{w_i\\}_{i=0}^p$ the LGL quadrature weights on $[-1,1]$, and by $W = \\mathrm{diag}(w_0, w_1, \\dots, w_p)$ the diagonal quadrature matrix. The element stiffness matrix $K^{(e)} \\in \\mathbb{R}^{(p+1) \\times (p+1)}$ is defined by the quadrature formula for the Galerkin bilinear form,\n$$\nK^{(e)} = \\frac{2}{h_e} \\, D^\\top \\, W \\, a_e \\, D,\n$$\nwhere $a_e$ multiplies the weights since it is constant on subdomain $e$. Partition the degrees of freedom on each subdomain into boundary nodes $b$ (the two endpoints) and interior nodes $i$ (the remaining nodes), yielding the block decomposition\n$$\nK^{(e)} = \\begin{bmatrix} K^{(e)}_{bb} & K^{(e)}_{bi} \\\\ K^{(e)}_{ib} & K^{(e)}_{ii} \\end{bmatrix}.\n$$\nDefine the local discrete Dirichlet-to-Neumann map (also known as the local discrete Steklov operator) on the boundary trace space by static condensation of interior degrees of freedom,\n$$\nT^{(e)} = K^{(e)}_{bb} - K^{(e)}_{bi} \\left(K^{(e)}_{ii}\\right)^{-1} K^{(e)}_{ib} \\in \\mathbb{R}^{2 \\times 2}.\n$$\n\nAssemble the nonoverlapping Schur complement $S$ on the global interface trace degrees of freedom by summing the contributions from each subdomainâ€™s $T^{(e)}$ to the interface nodes they touch and enforcing the homogeneous Dirichlet boundary values at $x=0$ and $x=1$ directly (these boundary values are set to zero and therefore do not contribute unknowns to $S$). The global Schur complement $S \\in \\mathbb{R}^{(N-1) \\times (N-1)}$ is symmetric positive definite. Define its spectral condition number by\n$$\n\\kappa(S) = \\frac{\\lambda_{\\max}(S)}{\\lambda_{\\min}(S)},\n$$\nwhere $\\lambda_{\\max}(\\cdot)$ and $\\lambda_{\\min}(\\cdot)$ are the largest and smallest eigenvalues, respectively.\n\nOn each subdomain, define the local discrete Steklov eigenproblem on the boundary trace space as\n$$\nT^{(e)} v_b = \\lambda \\, v_b,\n$$\nwith $v_b \\in \\mathbb{R}^2$. Let $\\lambda_{\\max}\\!\\left(T^{(e)}\\right)$ denote the largest eigenvalue of $T^{(e)}$. In one spatial dimension, each interior interface is shared by at most $2$ subdomains. Using a norm subadditivity or Gershgorin-type argument, one can show the upper bound\n$$\n\\lambda_{\\max}(S) \\le 2 \\, \\max_{e=1,\\dots,N} \\lambda_{\\max}\\!\\left(T^{(e)}\\right).\n$$\nThis provides a computable surrogate bound based purely on local Steklov eigenvalues.\n\nTask:\n- Implement the described spectral element construction for the one-dimensional problem in a programmatic form that builds the element stiffness matrices $K^{(e)}$, performs static condensation to obtain $T^{(e)}$, assembles the global Schur complement $S$, and computes the exact $\\lambda_{\\max}(S)$ and $\\kappa(S)$ numerically.\n- Compute the surrogate upper bound $U = 2 \\, \\max_{e} \\lambda_{\\max}\\!\\left(T^{(e)}\\right)$ and evaluate the sharpness of the bound by reporting the ratio $R = \\lambda_{\\max}(S)/U$.\n- No physical units are required for this purely mathematical problem; report all floating-point results as raw decimal values.\n\nUse the following test suite of parameter sets, where each test case is specified by the triple $(N, p, \\{a_e\\}_{e=1}^N)$:\n- Test case $1$: $N = 2$, $p = 4$, $\\{a_e\\} = [1.0, 1.0]$.\n- Test case $2$: $N = 2$, $p = 4$, $\\{a_e\\} = [10^{-3}, 10^{3}]$.\n- Test case $3$: $N = 5$, $p = 3$, $\\{a_e\\} = [1.0, 2.0, 3.0, 4.0, 5.0]$.\n- Test case $4$: $N = 3$, $p = 6$, $\\{a_e\\} = [1.0, 0.1, 10.0]$.\n- Test case $5$: $N = 4$, $p = 2$, $\\{a_e\\} = [1.0, 1.0, 1.0, 1.0]$.\n\nYour program should produce a single line of output containing the results of all test cases aggregated into a list of lists, where each inner list is $[\\lambda_{\\max}(S), U, R, \\kappa(S)]$ for the corresponding test case. The exact text format must be a single line with a Python-style list literal, for example $[[x_1, y_1, z_1, w_1],[x_2, y_2, z_2, w_2],\\dots]$, with no additional text.", "solution": "The problem is valid. It constitutes a well-defined exercise in numerical analysis, specifically within the domain of spectral element methods and nonoverlapping domain decomposition. All parameters are provided, the theoretical basis is sound, and the objectives are clear and computationally verifiable.\n\nThe solution proceeds by programmatically implementing the defined mathematical objects and procedures. The overall process can be divided into four main stages: (1) computation of reference element data, (2) construction of local element matrices and their static condensation, (3) assembly of the global interface problem, and (4) computation of the specified spectral properties.\n\n**1. Reference Spectral Element Data**\n\nThe method is based on a reference element defined on the interval $\\xi \\in [-1, 1]$. All computations for a physical element are performed by mapping from this reference element. For a given polynomial degree $p$, we require three fundamental components on the reference element:\n\n- **Legendre-Gauss-Lobatto (LGL) Nodes $\\{\\xi_i\\}_{i=0}^p$**: These are the $p+1$ nodes used for interpolation and quadrature. They are the roots of the polynomial $(1-\\xi^2)P'_p(\\xi)$, where $P'_p(\\xi)$ is the derivative of the Legendre polynomial of degree $p$. The set of nodes includes the endpoints $\\xi_0 = -1$ and $\\xi_p = 1$.\n\n- **LGL Quadrature Weights $\\{w_i\\}_{i=0}^p$**: Associated with each node $\\xi_i$ is a quadrature weight $w_i$, used for numerical integration. The weights are given by the formula:\n$$w_i = \\frac{2}{p(p+1) [P_p(\\xi_i)]^2}$$\nThis quadrature rule is exact for polynomials of degree up to $2p-1$.\n\n- **Lagrange Derivative Matrix $D$**: The local solution within an element is represented as a linear combination of Lagrange basis functions $L_j(\\xi)$, each non-zero only at a single node $\\xi_j$. The derivative matrix $D \\in \\mathbb{R}^{(p+1) \\times (p+1)}$ contains the values of the derivatives of these basis functions evaluated at all the nodes. An entry $D_{ij}$ is given by $D_{ij} = L'_j(\\xi_i)$. A standard formula for its entries is:\n$$\nD_{ij} = \\begin{cases}\n    \\frac{P_p(\\xi_i)}{P_p(\\xi_j)(\\xi_i - \\xi_j)} & \\text{if } i \\neq j \\\\\n    -\\frac{p(p+1)}{4} & \\text{if } i=j=0 \\\\\n    \\frac{p(p+1)}{4} & \\text{if } i=j=p \\\\\n    0 & \\text{otherwise for diagonal entries}\n\\end{cases}\n$$\nThese three components, $\\{\\xi_i\\}$, $\\{w_i\\}$, and $D$, depend only on the polynomial degree $p$ and are computed once.\n\n**2. Element Stiffness Matrix and Static Condensation**\n\nThe continuous problem is $-(a(x)u'(x))' = f(x)$. The corresponding weak form involves the bilinear form $B(u, v) = \\int_0^1 a(x) u'(x) v'(x) dx$. For a single element $e$ with domain $[x_L^e, x_R^e]$ and constant coefficient $a_e$, this integral becomes $a_e \\int_{x_L^e}^{x_R^e} u'(x) v'(x) dx$. Using an affine map from the reference element, $x(\\xi) = x_L^e + \\frac{h_e}{2}(1+\\xi)$, where $h_e = x_R^e - x_L^e$, the chain rule gives $u'(x) = \\frac{du}{d\\xi}\\frac{d\\xi}{dx} = u'(\\xi) \\frac{2}{h_e}$. The integral transforms to:\n$$ B^{(e)}(u, v) = a_e \\int_{-1}^{1} u'(\\xi) \\frac{2}{h_e} \\cdot v'(\\xi) \\frac{2}{h_e} \\cdot \\frac{h_e}{2} d\\xi = \\frac{2a_e}{h_e} \\int_{-1}^{1} u'(\\xi) v'(\\xi) d\\xi $$\nDiscretizing with the Lagrange basis and using LGL quadrature, we obtain the element stiffness matrix $K^{(e)}$. The integral $\\int (L'_j(\\xi)) (L'_k(\\xi)) d\\xi$ is approximated by $\\sum_m w_m L'_j(\\xi_m) L'_k(\\xi_m)$. This corresponds to the matrix expression:\n$$ K^{(e)} = \\frac{2a_e}{h_e} D^\\top W D $$\nwhere $W = \\mathrm{diag}(w_0, \\dots, w_p)$.\n\nThe nodes are partitioned into boundary nodes (indices $b = \\{0, p\\}$) and interior nodes (indices $i = \\{1, \\dots, p-1\\}$). This induces a block structure on $K^{(e)}$:\n$$ K^{(e)} = \\begin{bmatrix} K^{(e)}_{bb} & K^{(e)}_{bi} \\\\ K^{(e)}_{ib} & K^{(e)}_{ii} \\end{bmatrix} $$\nStatic condensation eliminates the interior degrees of freedom to find the relationship between nodal values and generalized forces on the element boundary. This yields the local Schur complement, or discrete Dirichlet-to-Neumann map, $T^{(e)} \\in \\mathbb{R}^{2 \\times 2}$:\n$$ T^{(e)} = K^{(e)}_{bb} - K^{(e)}_{bi} \\left(K^{(e)}_{ii}\\right)^{-1} K^{(e)}_{ib} $$\nThe matrix $T^{(e)}$ represents the stiffness contribution of element $e$ to its boundary nodes. We compute $T^{(e)}$ and its largest eigenvalue, $\\lambda_{\\max}(T^{(e)})$, for each element.\n\n**3. Global Schur Complement Assembly**\n\nThe global Schur complement matrix $S$ operates on the vector of unknown values at the $N-1$ interior interfaces of the domain partition. The interfaces are located at $x_j = j/N$ for $j=1, \\dots, N-1$. The matrix $S$ is assembled by summing the contributions from the local $T^{(e)}$ matrices. An interface at $x_j$ is the right boundary of element $j-1$ and the left boundary of element $j$. Its stiffness is the sum of stiffnesses from both sides.\nThe matrix $S$ is tridiagonal:\n- The diagonal entries are $S_{j,j} = T^{(j)}_{11} + T^{(j+1)}_{00}$ for $j=0, \\dots, N-2$. (Note: $T_{11}$ is the right-node contribution, $T_{00}$ is the left-node contribution).\n- The off-diagonal entries are $S_{j, j+1} = T^{(j+1)}_{01}$ and $S_{j+1, j} = T^{(j+1)}_{10}$ for $j=0, \\dots, N-3$.\n\n**4. Computation of Spectral Quantities**\n\nWith the global Schur complement matrix $S$ assembled, we compute the required quantities:\n- The eigenvalues of the symmetric matrix $S$ are computed numerically. We find the largest eigenvalue $\\lambda_{\\max}(S)$ and the smallest eigenvalue $\\lambda_{\\min}(S)$.\n- The spectral condition number is $\\kappa(S) = \\frac{\\lambda_{\\max}(S)}{\\lambda_{\\min}(S)}$.\n- The surrogate upper bound for $\\lambda_{\\max}(S)$ is calculated as $U = 2 \\cdot \\max_{e=1, \\dots, N} \\lambda_{\\max}(T^{(e)})$.\n- The sharpness of this bound is evaluated by the ratio $R = \\frac{\\lambda_{\\max}(S)}{U}$.\n\nThis procedure is applied to each test case specified in the problem statement.", "answer": "```python\nimport numpy as np\nfrom scipy.special import legendre, roots_jacobi\n\nclass SpectralElementSolver:\n    \"\"\"\n    Implements a 1D spectral element method to analyze the Schur complement condition number.\n    \"\"\"\n    \n    def __init__(self, N, p, a_vals):\n        \"\"\"\n        Initializes the solver with problem parameters.\n\n        Args:\n            N (int): Number of nonoverlapping subdomains.\n            p (int): Polynomial degree of LGL approximation.\n            a_vals (list or np.array): Diffusion coefficient values on each subdomain.\n        \"\"\"\n        self.N = N\n        self.p = p\n        self.a_vals = np.array(a_vals)\n        self.h = 1.0 / N\n\n        # Precompute reference element data that depends only on p\n        self._nodes, self._weights = self._lgl_nodes_weights()\n        self._D = self._derivative_matrix()\n        \n        # Will store local and global matrices during computation\n        self.T_elements = []  # List of local Schur complements T^(e)\n        self.S = None         # Global Schur complement\n\n    def _lgl_nodes_weights(self):\n        \"\"\"\n        Computes the Legendre-Gauss-Lobatto (LGL) nodes and weights for a given degree p.\n        \"\"\"\n        if self.p == 0:\n            return np.array([-1.0, 1.0]), np.array([1.0, 1.0]) # Linear element\n        if self.p == 1:\n            nodes = np.array([-1.0, 1.0])\n            weights = np.array([1.0, 1.0])\n            return nodes, weights\n\n        # Interior LGL nodes are the roots of the derivative of the Legendre polynomial P_p.\n        # These are also the roots of the Jacobi polynomial P_{p-1}^{(1,1)}.\n        jacobi_roots, _ = roots_jacobi(self.p - 1, 1, 1)\n        nodes = np.concatenate(([-1.0], jacobi_roots, [1.0]))\n        nodes = np.sort(nodes)\n\n        # LGL weights formula\n        p_poly = legendre(self.p)\n        weights = 2.0 / (self.p * (self.p + 1) * (p_poly(nodes))**2)\n        \n        return nodes, weights\n\n    def _derivative_matrix(self):\n        \"\"\"\n        Computes the differentiation matrix for the Lagrange basis on LGL nodes.\n        \"\"\"\n        n_pts = self.p + 1\n        D = np.zeros((n_pts, n_pts))\n        p_poly = legendre(self.p)\n        p_vals = p_poly(self._nodes)\n        nodes = self._nodes\n\n        # Off-diagonal entries\n        for i in range(n_pts):\n            for j in range(n_pts):\n                if i != j:\n                    D[i, j] = p_vals[i] / (p_vals[j] * (nodes[i] - nodes[j]))\n        \n        # Diagonal entries for endpoints\n        D[0, 0] = -self.p * (self.p + 1) / 4.0\n        D[self.p, self.p] = self.p * (self.p + 1) / 4.0\n        # Interior diagonal entries are 0, which is the default from np.zeros.\n\n        return D\n\n    def build_and_solve(self):\n        \"\"\"\n        Builds all matrices and computes the required spectral quantities.\n        \"\"\"\n        max_lambda_T_list = []\n\n        # 1. Compute local Schur complements (T_e) for each element\n        for e in range(self.N):\n            a_e = self.a_vals[e]\n            \n            # Form element stiffness matrix K_e\n            W_diag = np.diag(self._weights)\n            K_e = (a_e * 2.0 / self.h) * (self._D.T @ W_diag @ self._D)\n\n            # Partition into boundary and interior DoFs\n            b_indices = [0, self.p]\n            i_indices = list(range(1, self.p))\n\n            K_bb = K_e[np.ix_(b_indices, b_indices)]\n            \n            if self.p > 1: # If there are interior nodes\n                K_bi = K_e[np.ix_(b_indices, i_indices)]\n                K_ib = K_e[np.ix_(i_indices, b_indices)]\n                K_ii = K_e[np.ix_(i_indices, i_indices)]\n                # Static condensation\n                T_e = K_bb - K_bi @ np.linalg.inv(K_ii) @ K_ib\n            else: # No interior nodes to condense\n                T_e = K_bb\n\n            self.T_elements.append(T_e)\n\n            # Compute and store max eigenvalue of T_e\n            if T_e.shape[0] > 0:\n                eigvals_T = np.linalg.eigvalsh(T_e)\n                max_lambda_T_list.append(np.max(eigvals_T))\n        \n        # 2. Assemble and analyze global Schur complement S\n        if self.N > 1:\n            self.S = np.zeros((self.N - 1, self.N - 1))\n            \n            # Diagonal entries: sum contributions from adjacent elements\n            for i in range(self.N - 1):\n                # Interface i is shared by element i (right) and i+1 (left)\n                self.S[i, i] = self.T_elements[i][1, 1] + self.T_elements[i+1][0, 0]\n\n            # Off-diagonal entries: from shared element\n            for i in range(self.N - 2):\n                self.S[i, i+1] = self.T_elements[i+1][0, 1]\n                self.S[i+1, i] = self.T_elements[i+1][1, 0]\n\n            eigvals_S = np.linalg.eigvalsh(self.S)\n            lambda_max_S = np.max(eigvals_S)\n            lambda_min_S = np.min(eigvals_S)\n            kappa_S = lambda_max_S / lambda_min_S if lambda_min_S > 0 else np.inf\n        else: # Case with only one element, no interfaces.\n             lambda_max_S = 0.0\n             kappa_S = 1.0\n\n        # 3. Compute the surrogate bound U and the sharpness ratio R\n        U = 2.0 * np.max(max_lambda_T_list) if max_lambda_T_list else 0.0\n        R = lambda_max_S / U if U > 0 else 0.0\n\n        return [lambda_max_S, U, R, kappa_S]\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print results.\n    \"\"\"\n    test_cases = [\n        (2, 4, [1.0, 1.0]),\n        (2, 4, [1.0e-3, 1.0e3]),\n        (5, 3, [1.0, 2.0, 3.0, 4.0, 5.0]),\n        (3, 6, [1.0, 0.1, 10.0]),\n        (4, 2, [1.0, 1.0, 1.0, 1.0])\n    ]\n\n    results = []\n    for N, p, a_vals in test_cases:\n        solver = SpectralElementSolver(N, p, a_vals)\n        result = solver.build_and_solve()\n        results.append(result)\n\n    # Print in the specified single-line list-of-lists format\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3404164"}]}