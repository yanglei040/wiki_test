{"hands_on_practices": [{"introduction": "To effectively apply Implicit-Explicit (IMEX) methods, we must first understand the structure of the discrete operators we are splitting. This foundational exercise guides you through constructing the semi-discrete operator for a linear advection equation from first principles using the Discontinuous Galerkin (DG) method. By building the operator matrix for a simple, concrete case, you will gain direct insight into how discretization choices, like the numerical flux, define the system's properties and establish a clear link between the operator's eigenvalues and the stability limits of an explicit time-stepping scheme. [@problem_id:3391299]", "problem": "Consider the linear advection component of an advection–diffusion system on the periodic interval $[0,1]$, given by the scalar conservation law $u_{t} + (a u)_{x} = 0$ with constant advection speed $a = 1$. Discretize the advection operator using the discontinuous Galerkin (DG) method with piecewise constant basis functions (polynomial degree $0$) on a uniform mesh of $K = 2$ elements of equal size $h = \\frac{1}{2}$, and impose periodic boundary conditions. Use the upwind numerical flux for the interface terms and perform exact integration. Assemble the explicit semi-discrete DG advection operator matrix $L$ such that the semi-discrete system reads $u_{t} = L u$, where $u$ is the vector of DG degrees of freedom.\n\nStarting from the conservation law and the DG weak form on each element, derive the explicit form of $L$ on this mesh. Then compute the spectral radius $\\rho(L)$ of this matrix. Finally, consider an Implicit–Explicit (IMEX) Euler time discretization in which the advection term is treated by the explicit forward Euler method and the diffusion term (not present in this operator) would be treated implicitly. Using the forward Euler absolute stability region, determine the maximum linearly stable explicit timestep $\\Delta t_{\\max}$ imposed by the advection operator on this mesh.\n\nExpress your final answer as a row matrix $\\big[ \\rho(L) \\ \\ \\Delta t_{\\max} \\big]$ in exact form (no rounding).", "solution": "The user wants to analyze a discontinuous Galerkin (DG) discretization of a linear advection equation.\n\n### Step 1: Extract Givens\n- **Partial Differential Equation (PDE)**: $u_{t} + (a u)_{x} = 0$\n- **Domain**: Periodic interval $[0,1]$\n- **Advection Speed**: Constant, $a = 1$\n- **Discretization Method**: Discontinuous Galerkin (DG)\n- **Basis Functions**: Piecewise constant (polynomial degree $p=0$)\n- **Mesh**: Uniform with $K = 2$ elements.\n- **Element Size**: $h = \\frac{1-0}{K} = \\frac{1}{2}$\n- **Element Definitions**: $I_1 = [0, \\frac{1}{2}]$, $I_2 = [\\frac{1}{2}, 1]$\n- **Numerical Flux**: Upwind flux for interface terms.\n- **Integration**: Exact integration is to be used.\n- **Task**:\n    1. Assemble the semi-discrete DG operator matrix $L$ for the system $u_{t} = L u$.\n    2. Compute the spectral radius $\\rho(L)$.\n    3. Determine the maximum linearly stable explicit timestep $\\Delta t_{\\max}$ for a forward Euler scheme applied to this operator.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is a standard exercise in the numerical analysis of partial differential equations, specifically within the topic of spectral and discontinuous Galerkin methods.\n- **Scientifically Grounded**: The problem is based on the well-established DG method for linear advection, a fundamental topic in computational science. All principles invoked (weak formulation, numerical fluxes, stability analysis) are standard and correct.\n- **Well-Posed**: The problem is clearly stated with all necessary parameters (PDE, domain, boundary conditions, discretization details) to derive a unique operator matrix $L$. The subsequent tasks of finding its spectral radius and the corresponding explicit time-stepping stability limit are well-defined mathematical procedures.\n- **Objective**: The problem is formulated in precise, unambiguous mathematical language.\n- **Completeness**: The setup is complete. The equation, domain, mesh, basis functions, and numerical flux are all specified.\n- **Conclusion**: The problem is valid, self-contained, and consistent.\n\n### Step 3: Verdict and Action\nThe problem is valid. The solution will proceed.\n\n### Derivation of the Semi-Discrete System\n\nThe DG weak formulation of the PDE $u_t + (au)_x = 0$ is obtained by multiplying by a test function $v_h$ from the same approximation space and integrating over an element $I_j = [x_{j-1/2}, x_{j+1/2}]$:\n$$\n\\int_{I_j} u_t v_h \\, dx + \\int_{I_j} (au)_x v_h \\, dx = 0\n$$\nApplying integration by parts to the second term yields:\n$$\n\\int_{I_j} u_t v_h \\, dx - \\int_{I_j} au v_{h,x} \\, dx + [au v_h]_{x_{j-1/2}}^{x_{j+1/2}} = 0\n$$\nExpanding the boundary term and replacing the flux $au$ with a numerical flux, denoted by $(au)^*$, we get:\n$$\n\\int_{I_j} u_t v_h \\, dx - \\int_{I_j} au v_{h,x} \\, dx + (au)^*|_{x_{j+1/2}} v_h(x_{j+1/2}^-) - (au)^*|_{x_{j-1/2}} v_h(x_{j-1/2}^+) = 0\n$$\nHere, $v_h(x_{j+1/2}^-)$ is the value of the test function from within element $I_j$ at the right boundary, and $v_h(x_{j-1/2}^+)$ is the value from within $I_j$ at the left boundary.\n\nFor this problem, we use piecewise constant basis functions ($p=0$). The approximate solution on element $I_j$ is $u_h(x,t) = u_j(t)$ for $x \\in I_j$. The test function is also a constant on the element, $v_h(x) = 1$. Consequently, its derivative $v_{h,x}$ is $0$, and the term $\\int_{I_j} au v_{h,x} \\, dx$ vanishes. The formulation simplifies to:\n$$\n\\int_{I_j} \\frac{du_j}{dt} \\cdot 1 \\, dx + (au)^*|_{x_{j+1/2}} - (au)^*|_{x_{j-1/2}} = 0\n$$\nSince $\\int_{I_j} dx = h$, we have:\n$$\nh \\frac{du_j}{dt} + (au)^*|_{x_{j+1/2}} - (au)^*|_{x_{j-1/2}} = 0\n$$\nRearranging for the time derivative gives the semi-discrete form for element $j$:\n$$\n\\frac{du_j}{dt} = - \\frac{1}{h} \\left( (au)^*|_{x_{j+1/2}} - (au)^*|_{x_{j-1/2}} \\right)\n$$\n\nThe specified upwind flux for advection speed $a > 0$ is $(au)^* = a u_{\\text{left}}$, where $u_{\\text{left}}$ is the value of the solution in the element to the left of the interface. We are given $a=1$.\n\nThe mesh consists of two elements, $I_1 = [0, 1/2]$ and $I_2 = [1/2, 1]$, with size $h=1/2$. The degrees of freedom are $u_1$ and $u_2$.\n\n**For element $I_1$ (j=1):**\nThe interfaces are at $x_{1/2}=0$ and $x_{3/2}=1/2$. The equation is:\n$$\n\\frac{du_1}{dt} = - \\frac{1}{h} \\left( (au)^*|_{x=1/2} - (au)^*|_{x=0} \\right)\n$$\n- At the interface $x=1/2$ (between $I_1$ and $I_2$), the left state is $u_1$. So, $(au)^*|_{x=1/2} = a u_1 = u_1$.\n- At the interface $x=0$, due to periodic boundary conditions, the left state is from the end of the domain, which is element $I_2$. So, the left state is $u_2$. Thus, $(au)^*|_{x=0} = a u_2 = u_2$.\nSubstituting these fluxes into the equation for $u_1$:\n$$\n\\frac{du_1}{dt} = - \\frac{1}{h} (u_1 - u_2) = \\frac{1}{h} (-u_1 + u_2)\n$$\n\n**For element $I_2$ (j=2):**\nThe interfaces are at $x_{3/2}=1/2$ and $x_{5/2}=1$. The equation is:\n$$\n\\frac{du_2}{dt} = - \\frac{1}{h} \\left( (au)^*|_{x=1} - (au)^*|_{x=1/2} \\right)\n$$\n- At the interface $x=1$, due to periodic boundary conditions, the left state is from element $I_2$. So, $(au)^*|_{x=1} = a u_2 = u_2$.\n- At the interface $x=1/2$ (between $I_1$ and $I_2$), the left state is from element $I_1$, which is $u_1$. So, $(au)^*|_{x=1/2} = a u_1 = u_1$.\nSubstituting these fluxes into the equation for $u_2$:\n$$\n\\frac{du_2}{dt} = - \\frac{1}{h} (u_2 - u_1) = \\frac{1}{h} (u_1 - u_2)\n$$\n\n### Assembly of the Operator Matrix $L$\nThe system of ordinary differential equations is:\n$$\n\\frac{d}{dt} \\begin{pmatrix} u_1 \\\\ u_2 \\end{pmatrix} = \\frac{1}{h} \\begin{pmatrix} -u_1 + u_2 \\\\ u_1 - u_2 \\end{pmatrix} = \\frac{1}{h} \\begin{pmatrix} -1  1 \\\\ 1  -1 \\end{pmatrix} \\begin{pmatrix} u_1 \\\\ u_2 \\end{pmatrix}\n$$\nWith $h=1/2$, the operator matrix $L$ is:\n$$\nL = \\frac{1}{1/2} \\begin{pmatrix} -1  1 \\\\ 1  -1 \\end{pmatrix} = 2 \\begin{pmatrix} -1  1 \\\\ 1  -1 \\end{pmatrix} = \\begin{pmatrix} -2  2 \\\\ 2  -2 \\end{pmatrix}\n$$\n\n### Calculation of the Spectral Radius $\\rho(L)$\nThe eigenvalues $\\lambda$ of $L$ are the roots of the characteristic equation $\\det(L - \\lambda I) = 0$:\n$$\n\\det \\begin{pmatrix} -2-\\lambda  2 \\\\ 2  -2-\\lambda \\end{pmatrix} = 0\n$$\n$$\n(-2-\\lambda)^2 - (2)(2) = 0\n$$\n$$\n(2+\\lambda)^2 - 4 = 0\n$$\n$$\n(2+\\lambda)^2 = 4\n$$\n$$\n2+\\lambda = \\pm 2\n$$\nThe two eigenvalues are:\n$$\n\\lambda_1 = -2 + 2 = 0\n$$\n$$\n\\lambda_2 = -2 - 2 = -4\n$$\nThe spectrum of $L$ is $\\{0, -4\\}$. The spectral radius is the maximum absolute value of the eigenvalues:\n$$\n\\rho(L) = \\max(|\\lambda_1|, |\\lambda_2|) = \\max(|0|, |-4|) = 4\n$$\n\n### Determination of the Maximum Stable Timestep $\\Delta t_{\\max}$\nThe forward Euler method is applied to the semi-discrete system $u_t = Lu$:\n$$\nu^{n+1} = u^n + \\Delta t L u^n = (I + \\Delta t L) u^n\n$$\nFor linear stability, the eigenvalues of the amplification matrix $G = I + \\Delta t L$ must have a magnitude no greater than $1$. The eigenvalues of $G$ are $g_i = 1 + \\Delta t \\lambda_i$, where $\\lambda_i$ are the eigenvalues of $L$.\nThe stability condition is $|1 + \\Delta t \\lambda_i| \\le 1$ for all $i$. This requires the complex number $z = \\Delta t \\lambda_i$ to lie within the absolute stability region of the forward Euler method, which is a disk of radius $1$ centered at $-1$ in the complex plane.\n- For $\\lambda_1 = 0$: $|1 + \\Delta t \\cdot 0| = |1| = 1 \\le 1$. This condition is satisfied for any $\\Delta t$.\n- For $\\lambda_2 = -4$: $|1 + \\Delta t (-4)| \\le 1$, which is $|1 - 4 \\Delta t| \\le 1$.\nThis inequality is equivalent to $-1 \\le 1 - 4\\Delta t \\le 1$.\n1.  $1 - 4\\Delta t \\le 1 \\implies -4\\Delta t \\le 0 \\implies \\Delta t \\ge 0$.\n2.  $-1 \\le 1 - 4\\Delta t \\implies 4\\Delta t \\le 2 \\implies \\Delta t \\le \\frac{2}{4} = \\frac{1}{2}$.\nCombining these, we get $0 \\le \\Delta t \\le \\frac{1}{2}$. The maximum stable timestep is therefore:\n$$\n\\Delta t_{\\max} = \\frac{1}{2}\n$$\n\nThe final answer requires the row matrix $[\\rho(L) \\ \\ \\Delta t_{\\max}]$.\n$$\n\\rho(L) = 4, \\quad \\Delta t_{\\max} = \\frac{1}{2}\n$$\nThe resulting matrix is $\\begin{pmatrix} 4  \\frac{1}{2} \\end{pmatrix}$.", "answer": "$$\n\\boxed{\\begin{pmatrix} 4  \\frac{1}{2} \\end{pmatrix}}\n$$", "id": "3391299"}, {"introduction": "The core motivation for using IMEX methods lies in their ability to efficiently handle systems with both stiff and non-stiff components, such as advection-diffusion problems. This practice provides a quantitative comparison of the maximum allowable time step, $\\Delta t$, for an IMEX scheme versus a fully explicit Runge-Kutta scheme. Rather than building large matrices, this problem utilizes established scaling laws for the spectral radii of DG operators to analyze stability, a powerful technique for predicting numerical behavior across different mesh sizes and polynomial degrees. [@problem_id:3391304] This comparison makes the practical advantage of IMEX methods tangible, demonstrating how treating the stiff diffusion term implicitly circumvents its severe time step restriction.", "problem": "Consider the one-dimensional constant-coefficient advection–diffusion equation $u_{t} + a\\,u_{x} = \\nu\\,u_{xx}$ on the periodic domain $x \\in [0,1]$, discretized in space by the Discontinuous Galerkin (DG) method of polynomial degree $p$ on a uniform mesh of size $h$, using an upwind numerical flux for the advective term and the symmetric interior penalty Galerkin (SIPG) form for the diffusive term. Let the semidiscrete system be written in the additive form $u'(t) = L_{A}u(t) + L_{D}u(t)$, where $L_{A}$ is the advection operator and $L_{D}$ is the diffusion operator. It is known from inverse estimates for DG polynomial spaces that the spectral radius of $L_{A}$ scales like $\\omega_{A} = \\frac{a}{h}(2p+1)$ and the spectral radius of $L_{D}$ scales like $\\omega_{D} = \\frac{\\nu}{h^{2}}(2p+1)^{2}$.\n\nYou will advance the semidiscrete system in time with two different time integrators:\n- An Implicit–Explicit (IMEX) Additive Runge–Kutta (ARK) method in which the advection part $L_{A}$ is treated explicitly and the diffusion part $L_{D}$ is treated implicitly. The implicit part is assumed to be A-stable (no restriction from negative real eigenvalues), and the explicit part has a linear stability region whose intersection with the imaginary axis is a known constant $\\alpha_{I} = 2.785$.\n- A fully explicit classical fourth-order Runge–Kutta (RK) method, whose linear stability region intersects the imaginary axis at $\\alpha_{E} = 2.785$ and the negative real axis at $\\beta_{E} = 2.785$.\n\nUsing only the above foundational facts and scaling laws (no other pretabulated stability limits or shortcut formulas), derive the time step restrictions implied by the absolute stability requirement for each integrator, and compute the ratio $R$ of the maximum allowable IMEX time step to the maximum allowable fully explicit RK time step under the following parameter values: $a = 1$, $\\nu = 10^{-3}$, $h = \\frac{1}{128}$, $p = 5$.\n\nRound your final numerical answer for $R$ to four significant figures. Report $R$ as a dimensionless quantity.", "solution": "We begin from the semidiscrete representation $u'(t) = L_{A}u(t) + L_{D}u(t)$ resulting from the Discontinuous Galerkin (DG) spatial discretization of $u_{t} + a\\,u_{x} = \\nu\\,u_{xx}$. For constant-coefficient linear operators on a uniform mesh, the advection operator $L_{A}$ has eigenvalues that are predominantly purely imaginary due to its skew-adjoint character with upwind flux stabilization, while the diffusion operator $L_{D}$ has eigenvalues that are real and negative due to ellipticity and the symmetric interior penalty Galerkin (SIPG) construction.\n\nThe fundamental DG inverse estimates establish that for polynomials of degree $p$ on elements of size $h$, one has the derivative norm bound and trace inequalities implying that the semidiscrete operator norms scale as:\n$$\n\\omega_{A} = \\frac{a}{h}(2p+1), \\qquad \\omega_{D} = \\frac{\\nu}{h^{2}}(2p+1)^{2}.\n$$\nThese are well-tested scaling estimates reflecting the largest-magnitude eigenvalues of the advection and diffusion operators, respectively.\n\nAbsolute stability of a Runge–Kutta method applied to a linear system $y' = \\lambda y$ requires that $\\Delta t\\,\\lambda$ lie in the method’s stability region. For purely imaginary $\\lambda$ (from advection), the restriction is governed by the intersection of the stability region with the imaginary axis; for negative real $\\lambda$ (from diffusion), the restriction is governed by the intersection with the negative real axis.\n\nFor the Implicit–Explicit (IMEX) Additive Runge–Kutta (ARK) method:\n- The explicit part advances $L_{A}$, with imaginary eigenvalues bounded by $|\\lambda_{A}| \\leq \\omega_{A}$. The intersection of the explicit stability region with the imaginary axis is at $\\alpha_{I} = 2.785$, so the time step must satisfy\n$$\n\\Delta t_{\\text{IMEX}} \\leq \\frac{\\alpha_{I}}{\\omega_{A}} = \\frac{2.785}{\\frac{a}{h}(2p+1)}.\n$$\n- The implicit part is A-stable, so the diffusion eigenvalues on the negative real axis do not impose a restriction on $\\Delta t_{\\text{IMEX}}$.\n\nFor the fully explicit classical fourth-order Runge–Kutta (RK) method:\n- The advection restriction is\n$$\n\\Delta t \\leq \\frac{\\alpha_{E}}{\\omega_{A}} = \\frac{2.785}{\\frac{a}{h}(2p+1)}.\n$$\n- The diffusion restriction is\n$$\n\\Delta t \\leq \\frac{\\beta_{E}}{\\omega_{D}} = \\frac{2.785}{\\frac{\\nu}{h^{2}}(2p+1)^{2}}.\n$$\nThe fully explicit allowable time step is the minimum of these two.\n\nWe are asked to compute the ratio $R$ of the IMEX maximum time step to the fully explicit RK maximum time step for $a = 1$, $\\nu = 10^{-3}$, $h = \\frac{1}{128}$, and $p = 5$. First, we compute the operator scales:\n$$\n2p+1 = 11, \\quad \\omega_{A} = \\frac{a}{h}(2p+1) = \\frac{1}{h}\\cdot 11 = 11 \\cdot 128 = 1408,\n$$\n$$\n\\omega_{D} = \\frac{\\nu}{h^{2}}(2p+1)^{2} = \\nu \\cdot \\frac{1}{h^{2}} \\cdot 121 = 10^{-3} \\cdot 16384 \\cdot 121 = 16.384 \\cdot 121 = 1982.464.\n$$\nWe next identify which constraint is active for the fully explicit RK method by comparing the advection and diffusion limits. Since $\\omega_{D} > \\omega_{A}$, the diffusion constraint is stricter:\n$$\n\\Delta t_{\\text{explicit}} = \\frac{\\beta_{E}}{\\omega_{D}} = \\frac{2.785}{1982.464}.\n$$\nFor the IMEX method, only the advection constraint applies:\n$$\n\\Delta t_{\\text{IMEX}} = \\frac{\\alpha_{I}}{\\omega_{A}} = \\frac{2.785}{1408}.\n$$\nThe ratio simplifies to\n$$\nR = \\frac{\\Delta t_{\\text{IMEX}}}{\\Delta t_{\\text{explicit}}} = \\frac{\\alpha_{I}/\\omega_{A}}{\\beta_{E}/\\omega_{D}} = \\frac{\\alpha_{I}}{\\beta_{E}}\\cdot \\frac{\\omega_{D}}{\\omega_{A}}.\n$$\nGiven $\\alpha_{I} = \\beta_{E} = 2.785$, this becomes\n$$\nR = \\frac{\\omega_{D}}{\\omega_{A}} = \\frac{\\frac{\\nu}{h^{2}}(2p+1)^{2}}{\\frac{a}{h}(2p+1)} = \\frac{\\nu}{a}\\cdot \\frac{2p+1}{h}.\n$$\nSubstituting the parameter values,\n$$\nR = \\frac{10^{-3}}{1}\\cdot \\frac{11}{\\frac{1}{128}} = 10^{-3}\\cdot 11 \\cdot 128 = 1.408.\n$$\nRounded to four significant figures, the ratio is $1.408$. This shows that, under the given parameters, the IMEX method permits a time step larger by a factor of $1.408$ compared to the fully explicit fourth-order Runge–Kutta scheme.", "answer": "$$\\boxed{1.408}$$", "id": "3391304"}, {"introduction": "Transitioning from theory to practical implementation, we must address the fact that the linear systems arising from the implicit part of an IMEX scheme are typically solved inexactly using iterative methods. This exercise explores the critical relationship between the solver's termination tolerance, $\\tau$, and the overall order of accuracy, $p$, of the time integration method. Based on standard assumptions about the stability of the implicit solver, you will determine how the tolerance must scale with the time step, $\\Delta t$, to preserve the theoretical convergence rate of the IMEX scheme. [@problem_id:3391226] Mastering this concept is essential for developing efficient and reliable scientific code, as it ensures a correct balance between computational cost and numerical accuracy.", "problem": "Consider the linear advection–diffusion initial–value problem on a periodic domain,\n$$\nu_t + a\\,u_x \\;=\\; \\nu\\,u_{xx}, \\qquad x\\in [0,L], \\quad t\\ge 0,\n$$\nwith smooth initial data, where $a\\in\\mathbb{R}$ and $\\nu0$. Suppose the spatial discretization is performed by a high-order Discontinuous Galerkin (DG) method or a Fourier spectral method, yielding a semi-discrete ordinary differential equation (ODE) system\n$$\n\\mathbf{M}\\,\\dot{\\mathbf{u}}(t) \\;=\\; \\mathbf{f}(\\mathbf{u}(t)) \\;+\\; \\mathbf{g}(\\mathbf{u}(t)),\n$$\nwhere $\\mathbf{M}$ is a symmetric positive definite mass matrix, $\\mathbf{f}$ encodes the explicit advection contribution, and $\\mathbf{g}$ encodes the stiff diffusion contribution. Assume $\\mathbf{g}$ is linear and can be written as $\\mathbf{g}(\\mathbf{u})=\\mathbf{L}\\mathbf{u}$ with $\\mathbf{L}$ symmetric negative semi-definite in the $\\mathbf{M}$-inner product. The time integration uses an Implicit–Explicit (IMEX) Additive Runge–Kutta (ARK) method of global order $p\\ge 1$ with an $L$-stable implicit part. At each implicit stage, the linear system for the stage value $\\mathbf{Y}_i$ is solved inexactly by an iterative method that is terminated when the stage equation residual in the $\\mathbf{M}$-norm satisfies\n$$\n\\|\\mathbf{r}_i\\|_{\\mathbf{M}} \\;\\le\\; \\tau,\n$$\nwhere $\\tau0$ is a user-specified absolute tolerance and $\\|\\mathbf{v}\\|_{\\mathbf{M}}:=\\sqrt{\\mathbf{v}^\\top \\mathbf{M}\\mathbf{v}}$. Assume there exists a constant $c_\\star$ independent of the time step $\\Delta t$ and the spatial resolution such that, for each implicit stage matrix of the form $\\mathbf{A}_i(\\Delta t):=\\mathbf{M}-\\Delta t\\,\\gamma_i\\,\\mathbf{J}_g$ (with $\\gamma_i0$ the diagonal implicit coefficient and $\\mathbf{J}_g$ the Jacobian of $\\mathbf{g}$, here equal to $\\mathbf{L}$), the inverse is uniformly bounded in the $\\mathbf{M}$-operator norm:\n$\n\\|\\mathbf{A}_i(\\Delta t)^{-1}\\|_{\\mathbf{M}} \\le c_\\star.\n$\nNeglect spatial discretization error by assuming it is asymptotically smaller than the temporal error for the time steps under consideration.\n\nYou are asked to analyze how the inexactness of the implicit stage solves affects the overall accuracy of the IMEX method. In particular, determine how the tolerance $\\tau$ should scale with the time step $\\Delta t$ in order to retain the designed global order $p$ of the IMEX method for the semi-discrete advection–diffusion system. Choose the best recommendation that guarantees preservation of global order $p$ with minimal oversolving, and justify your choice by reasoning from the semi-discrete ODE, stability of the implicit operator, and the structure of the IMEX ARK method.\n\nWhich recommendation is most appropriate?\n\nA. Choose $\\tau = C\\,\\Delta t^{p}$ (with $C$ independent of $\\Delta t$), enforced as an absolute tolerance on the stage residual in the $\\mathbf{M}$-norm, so that the solver-induced local defect is of the same asymptotic size as the method’s local truncation error.\n\nB. Choose $\\tau = C\\,\\Delta t^{p+1}$ to match the local truncation error directly, because the stage residual contributes to the one-step error without any additional factor of $\\Delta t$.\n\nC. Keep $\\tau$ independent of $\\Delta t$ to avoid unnecessary work at small $\\Delta t$, since the implicit operator is $L$-stable and damps stiffness-originated errors.\n\nD. Choose $\\tau = C\\,\\Delta t^{p-1}$ because diffusion stiffness amplifies stage errors by a factor of order $\\Delta t^{-1}$, requiring tighter stage tolerances than the nominal local truncation error scaling.\n\nHere $C0$ denotes a $\\Delta t$-independent constant that may depend on solution norms and method coefficients. Assume all stability and smoothness conditions needed for classical order $p$ error estimates hold for the exact solves, and focus only on the effect of terminating the implicit stage solves at tolerance $\\tau$ as specified above.", "solution": "The problem statement is subjected to validation.\n\n### Step 1: Extract Givens\n- **Governing Equation:** Linear advection–diffusion equation $u_t + a\\,u_x = \\nu\\,u_{xx}$ on a periodic domain $x\\in [0,L]$, $t\\ge 0$, with $a\\in\\mathbb{R}$, $\\nu0$, and smooth initial data.\n- **Semi-Discrete System:** $\\mathbf{M}\\,\\dot{\\mathbf{u}}(t) = \\mathbf{f}(\\mathbf{u}(t)) + \\mathbf{g}(\\mathbf{u}(t))$.\n- **Mass Matrix $\\mathbf{M}$:** Symmetric positive definite.\n- **Advection Term $\\mathbf{f}(\\mathbf{u})$:** Treated explicitly.\n- **Diffusion Term $\\mathbf{g}(\\mathbf{u})$:** Stiff, treated implicitly. It is linear, so $\\mathbf{g}(\\mathbf{u})=\\mathbf{L}\\mathbf{u}$.\n- **Diffusion Matrix $\\mathbf{L}$:** Symmetric negative semi-definite in the $\\mathbf{M}$-inner product.\n- **Time Integration:** Implicit–Explicit (IMEX) Additive Runge–Kutta (ARK) method of global order $p\\ge 1$. The implicit part is $L$-stable.\n- **Inexact Solves:** Implicit stage linear systems are solved inexactly.\n- **Termination Criterion:** The iterative solve for each implicit stage $i$ is terminated when the stage equation residual, $\\mathbf{r}_i$, satisfies $\\|\\mathbf{r}_i\\|_{\\mathbf{M}} \\le \\tau$, where $\\|\\mathbf{v}\\|_{\\mathbf{M}}:=\\sqrt{\\mathbf{v}^\\top \\mathbf{M}\\mathbf{v}}$ and $\\tau0$ is an absolute tolerance.\n- **Implicit Stage Matrix:** The matrix for the $i$-th implicit stage is $\\mathbf{A}_i(\\Delta t):=\\mathbf{M}-\\Delta t\\,\\gamma_i\\,\\mathbf{J}_g$, with $\\gamma_i0$ being a diagonal coefficient of the implicit Runge-Kutta method and $\\mathbf{J}_g=\\mathbf{L}$ being the Jacobian of $\\mathbf{g}$.\n- **Boundedness Assumption:** There exists a constant $c_\\star$ independent of $\\Delta t$ and spatial resolution such that the inverse of the stage matrix is uniformly bounded in the operator norm induced by the $\\mathbf{M}$-norm: $\\|\\mathbf{A}_i(\\Delta t)^{-1}\\|_{\\mathbf{M}} \\le c_\\star$.\n- **Simplifying Assumptions:** Spatial discretization error is negligible. Classical order conditions for the exact-solve case are assumed to hold.\n- **Question:** Determine the scaling of the tolerance $\\tau$ with the time step $\\Delta t$ to retain the global order of accuracy $p$ with minimal oversolving.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientifically Grounded:** The problem is a canonical example in the field of numerical analysis for partial differential equations. The use of IMEX ARK methods for advection-diffusion-reaction systems is a standard and well-studied technique. The properties of the discretized operators ($\\mathbf{M}$, $\\mathbf{L}$) are characteristic of spatial discretizations like the Discontinuous Galerkin or spectral methods.\n- **Well-Posed:** The problem is well-posed. It asks for a specific relationship between numerical parameters ($\\tau$ and $\\Delta t$) to achieve a desired theoretical property (order of accuracy). The provided assumptions, particularly the uniform boundedness of the implicit stage matrix inverse, are standard in the rigorous analysis of such methods and are necessary to derive a definite conclusion.\n- **Objective:** The problem is stated using precise, objective, and standard terminology from numerical analysis.\n\nThe problem statement is internally consistent, scientifically sound, and well-posed. No flaws are identified.\n\n### Step 3: Verdict and Action\nThe problem is **valid**. A solution will be derived.\n\n### Derivation of the Correct Tolerance Scaling\n\nThe goal is to determine how the tolerance $\\tau$ for the inexact linear solves must scale with the time step $\\Delta t$ to ensure the global error of the time integration method remains $\\mathcal{O}(\\Delta t^p)$.\n\n1.  **Local Truncation Error (LTE):** An IMEX ARK method with global order $p$ has a local truncation error of order $\\mathcal{O}(\\Delta t^{p+1})$. This is the error introduced in a single step, assuming the step begins with the exact solution to the ODE system and all stage equations are solved exactly. To maintain the global order $p$, any additional errors introduced within a step must not be of a lower order in $\\Delta t$ than the method's own LTE.\n\n2.  **Analysis of an Inexact Implicit Stage:** Let us consider a generic implicit stage $i$ of the ARK method. The implicit part of the stage equation can be written as:\n    $$(\\mathbf{M} - \\Delta t\\,\\gamma_i\\,\\mathbf{L}) \\mathbf{Y}_i = \\mathbf{b}_i$$\n    where $\\mathbf{Y}_i$ is the exact stage solution vector and $\\mathbf{b}_i$ contains information from the previous time step and prior stages. Let $\\mathbf{A}_i := \\mathbf{M} - \\Delta t\\,\\gamma_i\\,\\mathbf{L}$. The exact stage solution is $\\mathbf{Y}_i = \\mathbf{A}_i^{-1}\\mathbf{b}_i$.\n\n    The iterative solver computes an approximate stage solution, $\\hat{\\mathbf{Y}}_i$. The solver is terminated when the residual $\\mathbf{r}_i := \\mathbf{A}_i \\hat{\\mathbf{Y}}_i - \\mathbf{b}_i$ satisfies $\\|\\mathbf{r}_i\\|_{\\mathbf{M}} \\le \\tau$.\n\n3.  **Error in the Stage Solution:** The error in the stage solution due to the inexact solve is $\\mathbf{e}_i := \\hat{\\mathbf{Y}}_i - \\mathbf{Y}_i$. We can relate this error to the residual:\n    $$\\mathbf{A}_i \\mathbf{e}_i = \\mathbf{A}_i (\\hat{\\mathbf{Y}}_i - \\mathbf{Y}_i) = (\\mathbf{A}_i \\hat{\\mathbf{Y}}_i - \\mathbf{b}_i) - (\\mathbf{A}_i \\mathbf{Y}_i - \\mathbf{b}_i) = \\mathbf{r}_i - \\mathbf{0} = \\mathbf{r}_i$$\n    Therefore, the stage solution error is $\\mathbf{e}_i = \\mathbf{A}_i^{-1} \\mathbf{r}_i$.\n\n4.  **Bounding the Stage Solution Error:** Using the norm induced by the $\\mathbf{M}$-inner product, we can bound the magnitude of this error:\n    $$\\|\\mathbf{e}_i\\|_{\\mathbf{M}} = \\|\\mathbf{A}_i^{-1} \\mathbf{r}_i\\|_{\\mathbf{M}} \\le \\|\\mathbf{A}_i^{-1}\\|_{\\mathbf{M}} \\|\\mathbf{r}_i\\|_{\\mathbf{M}}$$\n    Using the problem's givens, $\\|\\mathbf{A}_i^{-1}\\|_{\\mathbf{M}} \\le c_\\star$ and $\\|\\mathbf{r}_i\\|_{\\mathbf{M}} \\le \\tau$, we obtain a bound on the stage error:\n    $$\\|\\mathbf{e}_i\\|_{\\mathbf{M}} \\le c_\\star \\tau$$\n    This shows that the error in each stage vector is of order $\\mathcal{O}(\\tau)$.\n\n5.  **Contribution to the One-Step Error:** The error in the stage solutions, $\\mathbf{e}_i$, propagates to the final solution update for the step. The solution at the new time level, $\\mathbf{u}_{n+1}$, is computed as a linear combination of the solution at the old time level, $\\mathbf{u}_n$, and terms involving the stage values:\n    $$\\mathbf{u}_{n+1} = \\mathbf{u}_n + \\Delta t \\sum_{j=1}^s \\left( b_j^E \\mathbf{f}(\\mathbf{Y}_j) + b_j^I \\mathbf{L}\\mathbf{Y}_j \\right)$$\n    When using the inexact stage solutions $\\hat{\\mathbf{Y}}_j = \\mathbf{Y}_j + \\mathbf{e}_j$, the computed update $\\hat{\\mathbf{u}}_{n+1}$ will differ from the exact-solve update $\\mathbf{u}_{n+1}$. The error induced by the solver in one step, $\\delta_{\\text{step}} := \\hat{\\mathbf{u}}_{n+1} - \\mathbf{u}_{n+1}$, is:\n    $$\\delta_{\\text{step}} = \\Delta t \\sum_{j=1}^s \\left( b_j^E (\\mathbf{f}(\\hat{\\mathbf{Y}}_j) - \\mathbf{f}(\\mathbf{Y}_j)) + b_j^I \\mathbf{L}(\\hat{\\mathbf{Y}}_j - \\mathbf{Y}_j) \\right)$$\n    Assuming the functions are well-behaved (e.g., $\\mathbf{f}$ is Lipschitz continuous), the term inside the summation is of the order of the stage errors, $\\max_j \\|\\mathbf{e}_j\\|_{\\mathbf{M}}$.\n    $$\\|\\delta_{\\text{step}}\\|_{\\mathbf{M}} \\approx \\mathcal{O}(\\Delta t \\cdot \\max_j \\|\\mathbf{e}_j\\|_{\\mathbf{M}})$$\n    Since $\\|\\mathbf{e}_j\\|_{\\mathbf{M}} = \\mathcal{O}(\\tau)$, the local error introduced by the inexact solves is:\n    $$\\|\\delta_{\\text{step}}\\|_{\\mathbf{M}} = \\mathcal{O}(\\Delta t \\cdot \\tau)$$\n\n6.  **Matching Error Orders:** To preserve the method's global order of $p$, the local error from the inexact solves must be, at most, of the same order as the method's intrinsic local truncation error.\n    $$\\text{Solver-induced local error} \\le \\text{Method's local truncation error}$$\n    $$\\mathcal{O}(\\Delta t \\cdot \\tau) \\le \\mathcal{O}(\\Delta t^{p+1})$$\n    For this to hold as $\\Delta t \\to 0$, we must have:\n    $$\\tau = \\mathcal{O}(\\Delta t^p)$$\n    Choosing $\\tau = C\\,\\Delta t^p$ for some constant $C$ ensures that the solver-induced local error is $\\mathcal{O}(\\Delta t^{p+1})$, which matches the order of the method's LTE. This choice is optimal in that it is the least stringent requirement on $\\tau$ that preserves the order of accuracy, thus avoiding unnecessary oversolving.\n\n### Option-by-Option Analysis\n\n**A. Choose $\\tau = C\\,\\Delta t^{p}$ (with $C$ independent of $\\Delta t$), enforced as an absolute tolerance on the stage residual in the $\\mathbf{M}$-norm, so that the solver-induced local defect is of the same asymptotic size as the method’s local truncation error.**\nThis recommendation aligns perfectly with our derivation. Setting $\\tau = C\\,\\Delta t^p$ makes the solver-induced local error $\\mathcal{O}(\\Delta t \\cdot \\tau) = \\mathcal{O}(\\Delta t^{p+1})$, which is the same order as the method's local truncation error. This ensures that the global order $p$ is preserved without making the tolerance unnecessarily strict.\n**Verdict: Correct.**\n\n**B. Choose $\\tau = C\\,\\Delta t^{p+1}$ to match the local truncation error directly, because the stage residual contributes to the one-step error without any additional factor of $\\Delta t$.**\nThe scaling $\\tau = C\\,\\Delta t^{p+1}$ is unnecessarily strict. It leads to a solver-induced local error of $\\mathcal{O}(\\Delta t \\cdot \\Delta t^{p+1}) = \\mathcal{O}(\\Delta t^{p+2})$, which is one order smaller than required. This results in \"oversolving\" and unnecessary computational cost. The justification is also flawed; as shown in the derivation, the contribution of stage-level errors to the one-step error is scaled by a factor of $\\Delta t$ arising from the Runge-Kutta update formula.\n**Verdict: Incorrect.**\n\n**C. Keep $\\tau$ independent of $\\Delta t$ to avoid unnecessary work at small $\\Delta t$, since the implicit operator is $L$-stable and damps stiffness-originated errors.**\nIf $\\tau = \\mathcal{O}(1)$ (independent of $\\Delta t$), the solver-induced local error is $\\mathcal{O}(\\Delta t \\cdot \\tau) = \\mathcal{O}(\\Delta t)$. For any method with order $p \\ge 1$, its LTE is $\\mathcal{O}(\\Delta t^{p+1})$, which is of higher order than $\\mathcal{O}(\\Delta t)$. The total local error would be dominated by the solver error, becoming $\\mathcal{O}(\\Delta t)$. The accumulated global error over $T/\\Delta t$ steps would be $(T/\\Delta t) \\cdot \\mathcal{O}(\\Delta t) = \\mathcal{O}(1)$, implying a total loss of convergence as $\\Delta t \\to 0$. The $L$-stability is already accounted for in the constant $c_\\star$ and does not eliminate the need to control the tolerance.\n**Verdict: Incorrect.**\n\n**D. Choose $\\tau = C\\,\\Delta t^{p-1}$ because diffusion stiffness amplifies stage errors by a factor of order $\\Delta t^{-1}$, requiring tighter stage tolerances than the nominal local truncation error scaling.**\nThis choice of tolerance $\\tau = C\\,\\Delta t^{p-1}$ leads to a solver-induced local error of $\\mathcal{O}(\\Delta t \\cdot \\Delta t^{p-1}) = \\mathcal{O}(\\Delta t^p)$. This error will dominate the method's LTE of $\\mathcal{O}(\\Delta t^{p+1})$. The total local error is $\\mathcal{O}(\\Delta t^p)$, which leads to a global error of $(T/\\Delta t) \\cdot \\mathcal{O}(\\Delta t^p) = \\mathcal{O}(\\Delta t^{p-1})$. The method's order is reduced from $p$ to $p-1$. The reasoning is also faulty: the assumption $\\|\\mathbf{A}_i(\\Delta t)^{-1}\\|_{\\mathbf{M}} \\le c_\\star$ explicitly states that there is no $\\Delta t^{-1}$ amplification. This assumption is a direct consequence of the $L$-stability of the implicit method applied to a dissipative operator.\n**Verdict: Incorrect.**", "answer": "$$\\boxed{A}$$", "id": "3391226"}]}