{"hands_on_practices": [{"introduction": "The first step in applying the method of lines is to discretize the spatial derivatives, transforming the partial differential equation into a large system of coupled ordinary differential equations (ODEs). This exercise guides you through this fundamental process for a 1D hyperbolic conservation law using the Discontinuous Galerkin (DG) method. Mastering this derivation is crucial as it reveals how element-local volume integrals and inter-element numerical fluxes combine to form the right-hand side of the semi-discrete system that governs the evolution of the solution's degrees of freedom [@problem_id:3399419].", "problem": "Consider the one-dimensional conservation law $u_t + f(u)_x = 0$ posed on a bounded interval $\\Omega = [a,b]$, where $u(x,t)$ is scalar and $f(u)$ is a smooth flux function. Let $\\Omega$ be partitioned into $N$ disjoint open elements $K_j = (x_{j-\\frac{1}{2}}, x_{j+\\frac{1}{2}})$ for $j = 1,\\dots,N$, with interfaces at points $x_{j\\pm\\frac{1}{2}}$. On each element $K_j$, approximate $u(x,t)$ by a polynomial $u_h(x,t) \\in P^p(K_j)$ of degree at most $p$, expanded in a chosen local basis $\\{\\phi_{j,m}(x)\\}_{m=0}^{p}$ so that $u_h(x,t) = \\sum_{m=0}^{p} c_{j,m}(t)\\,\\phi_{j,m}(x)$ for time-dependent modal coefficients $\\{c_{j,m}(t)\\}$.\n\nUsing the Discontinuous Galerkin (DG) method and the method-of-lines discretization, construct the elementwise semi-discrete equations by multiplying the conservation law by a test function $v \\in P^p(K_j)$, integrating by parts on each element, and replacing the physical flux $f(u)$ at the interfaces by a consistent numerical flux $\\hat{f}(u^-,u^+)$ that depends on the interior trace $u^-$ and exterior trace $u^+$ at each interface. Explicitly identify how interface jumps and averages enter via the numerical flux by choosing the local Lax–Friedrichs form $\\hat{f}(u^-,u^+) = \\{f(u)\\} - \\frac{\\alpha}{2}[u]$, where $\\{f(u)\\} = \\frac{1}{2}\\big(f(u^-)+f(u^+)\\big)$, $[u] = u^+ - u^-$, and $\\alpha \\ge \\sup_{s \\in [u^-,u^+]}|f'(s)|$ is a local bound on the wavespeed.\n\nDerive, in full detail, the semi-discrete ordinary differential equation for the modal coefficients $c_{j,m}(t)$ in terms of the element mass matrix entries $M_{j,mq} = \\int_{K_j} \\phi_{j,m}(x)\\,\\phi_{j,q}(x)\\,\\mathrm{d}x$, the volume term involving $f(u_h)$ and $\\partial_x\\phi_{j,q}$, and the two interface contributions at $x_{j\\pm\\frac{1}{2}}$ expressed through $\\{f(u)\\}$ and $[u]$ evaluated with traces from neighboring elements. Your final answer must be a single closed-form analytic expression for $\\dot{c}_{j,m}(t)$ in index notation, including the numerical flux written in terms of averages and jumps. No numerical evaluation is required, and no boundary conditions need be imposed beyond using interior/exterior traces at interfaces. The final answer should not include any units.", "solution": "The derivation of the semi-discrete ordinary differential equation (ODE) for the modal coefficients begins with the weak formulation of the conservation law, $u_t + f(u)_x = 0$, on an element $K_j = (x_{j-\\frac{1}{2}}, x_{j+\\frac{1}{2}})$. We multiply the PDE by a test function $v_h(x) \\in P^p(K_j)$ and integrate over the element $K_j$:\n$$ \\int_{K_j} \\frac{\\partial u_h}{\\partial t} v_h(x) \\, \\mathrm{d}x + \\int_{K_j} \\frac{\\partial f(u_h)}{\\partial x} v_h(x) \\, \\mathrm{d}x = 0 $$\nHere, $u_h$ is the polynomial approximation to the solution $u$ on $K_j$.\n\nThe second term, containing the flux derivative, is integrated by parts:\n$$ \\int_{K_j} \\frac{\\partial f(u_h)}{\\partial x} v_h(x) \\, \\mathrm{d}x = \\left[ f(u_h(x,t)) v_h(x) \\right]_{x_{j-\\frac{1}{2}}}^{x_{j+\\frac{1}{2}}} - \\int_{K_j} f(u_h(x,t)) \\frac{\\mathrm{d}v_h(x)}{\\mathrm{d}x} \\, \\mathrm{d}x $$\nIn the Discontinuous Galerkin method, the single-valued physical flux at the discontinuous interfaces is replaced by a numerical flux function, $\\hat{f}(u^-, u^+)$, which depends on the two states on either side of the interface. The weak formulation becomes:\n$$ \\int_{K_j} \\frac{\\partial u_h}{\\partial t} v_h \\, \\mathrm{d}x = \\int_{K_j} f(u_h) \\frac{\\mathrm{d}v_h}{\\mathrm{d}x} \\, \\mathrm{d}x - \\hat{f}_{j+\\frac{1}{2}}v_h(x_{j+\\frac{1}{2}}) + \\hat{f}_{j-\\frac{1}{2}}v_h(x_{j-\\frac{1}{2}}) $$\nwhere $\\hat{f}_{j+\\frac{1}{2}} = \\hat{f}(u_h(x_{j+\\frac{1}{2}}^-), u_h(x_{j+\\frac{1}{2}}^+))$ and $\\hat{f}_{j-\\frac{1}{2}} = \\hat{f}(u_h(x_{j-\\frac{1}{2}}^-), u_h(x_{j-\\frac{1}{2}}^+))$.\n\nTo obtain the system of ODEs for the coefficients, we substitute the basis expansion $u_h(x,t) = \\sum_{m=0}^{p} c_{j,m}(t)\\,\\phi_{j,m}(x)$ and choose the test functions to be the basis functions, $v_h(x) = \\phi_{j,q}(x)$ for $q=0, \\dots, p$.\n$$ \\sum_{m=0}^{p} \\left( \\int_{K_j} \\phi_{j,m}(x) \\phi_{j,q}(x) \\, \\mathrm{d}x \\right) \\frac{\\mathrm{d}c_{j,m}}{\\mathrm{d}t} = \\int_{K_j} f(u_h) \\frac{\\mathrm{d}\\phi_{j,q}}{\\mathrm{d}x} \\, \\mathrm{d}x - \\hat{f}_{j+\\frac{1}{2}} \\phi_{j,q}(x_{j+\\frac{1}{2}}) + \\hat{f}_{j-\\frac{1}{2}} \\phi_{j,q}(x_{j-\\frac{1}{2}}) $$\nThe left side can be written in terms of the mass matrix entries $M_{j,qm}$. The equation becomes $\\sum_{m=0}^{p} M_{j,qm} \\dot{c}_{j,m} = R_{j,q}(t)$, where $R_{j,q}(t)$ is the right-hand side. In matrix form for element $j$, this is $\\mathbf{M}_j \\dot{\\mathbf{c}}_j = \\mathbf{R}_j$.\n\nThe problem asks for an explicit expression for $\\dot{c}_{j,m}(t)$, which requires inverting the mass matrix: $\\dot{\\mathbf{c}}_j = \\mathbf{M}_j^{-1} \\mathbf{R}_j$. In component form, this is:\n$$ \\frac{\\mathrm{d}c_{j,m}}{\\mathrm{d}t} = \\sum_{q=0}^{p} (M_j^{-1})_{mq} R_{j,q}(t) $$\nSubstituting the local Lax-Friedrichs flux, $\\hat{f}(u^-,u^+) = \\{f(u)\\} - \\frac{\\alpha}{2}[u]$, gives the final expression. The quantities $u_h$ and its traces depend on the coefficients $\\{c_{j,m}(t)\\}$ from element $j$ and its neighbors, making the system of ODEs coupled.", "answer": "$$ \\boxed{ \\dot{c}_{j,m}(t) = \\sum_{q=0}^{p} (M_j^{-1})_{mq} \\left[ \\int_{K_j} f(u_h) \\frac{\\mathrm{d}\\phi_{j,q}}{\\mathrm{d}x} \\, \\mathrm{d}x - \\left( \\{f(u_h)\\}_{j+\\frac{1}{2}} - \\frac{\\alpha_{j+\\frac{1}{2}}}{2}[u_h]_{j+\\frac{1}{2}} \\right) \\phi_{j,q}(x_{j+\\frac{1}{2}}) + \\left( \\{f(u_h)\\}_{j-\\frac{1}{2}} - \\frac{\\alpha_{j-\\frac{1}{2}}}{2}[u_h]_{j-\\frac{1}{2}} \\right) \\phi_{j,q}(x_{j-\\frac{1}{2}}) \\right] } $$", "id": "3399419"}, {"introduction": "Once the semi-discrete ODE system is established, choosing a stable time step for an explicit time integrator is paramount, as a step size that is too large will cause the numerical solution to blow up. This practice connects the abstract stability region of a time-integration scheme, such as the forward Euler method, to the concrete spectral properties of the DG spatial operator. By completing this exercise [@problem_id:3399416], you will derive a time-step restriction based on the operator's spectral radius, a vital skill for implementing any stable explicit DG scheme.", "problem": "Consider the one-dimensional linear diffusion equation $u_{t}=\\nu u_{xx}$ on a periodic interval, discretized in space by a symmetric interior penalty Discontinuous Galerkin (DG) method of polynomial degree $p$ on a uniform mesh. This yields a method-of-lines semi-discrete system $M \\dot{\\mathbf{u}}(t)=K \\mathbf{u}(t)$ with mass matrix $M$ that is symmetric positive definite, stiffness matrix $K$ that is symmetric negative semidefinite for sufficiently large penalty, and the linear operator $A=M^{-1}K$. Assume periodic boundary conditions, so that all eigenvalues of $A$ are real and non-positive.\n\nLet the time integration be performed by the forward Euler explicit Runge–Kutta (RK) method, which has stability function $R(z)=1+z$. Starting from the method-of-lines formulation and the definition of a stability function, do the following:\n\n- Express the one-step linear amplification matrix $G$ in terms of $R$ and $A$ (you must justify the expression from first principles for linear constant-coefficient right-hand sides).\n- Using only the spectral radius $\\rho(A)$ and the assumed spectral location of $A$, derive the largest time-step bound $\\Delta t_{\\max}$ such that all DG modes are non-amplified in one step, meaning the maximum modal amplification factor has magnitude less than or equal to $1$. Your bound must be a closed-form analytic expression in terms of $\\rho(A)$ alone.\n\nYour final answer must be the single expression for $\\Delta t_{\\max}$. No numerical rounding is required.", "solution": "We begin from the method-of-lines semi-discrete system $M \\dot{\\mathbf{u}}(t)=K \\mathbf{u}(t)$. Since $M$ is symmetric positive definite, we can rewrite the system in the standard linear form\n$$\n\\dot{\\mathbf{u}}(t) = A \\mathbf{u}(t), \\quad A := M^{-1}K.\n$$\nBy the assumptions on the symmetric interior penalty discretization with periodic boundary conditions, $K$ is symmetric negative semidefinite for sufficiently large penalty, hence $A$ is similar to a symmetric negative semidefinite matrix. In particular, all eigenvalues of $A$ are real and non-positive.\n\nFor a linear right-hand side $\\dot{\\mathbf{u}}(t)=A \\mathbf{u}(t)$ and a one-step time integrator with stability function $R(z)$, the numerical update can be written in the form\n$$\n\\mathbf{u}^{n+1} = G \\,\\mathbf{u}^{n}, \\quad G = R(\\Delta t\\, A),\n$$\nwhere $R$ acts on the matrix argument through its power series. This follows by applying the method to the scalar test equation $y'=\\lambda y$, which yields $y^{n+1} = R(\\Delta t \\lambda) y^{n}$, and then extending by the spectral mapping theorem.\n\nSpecializing to forward Euler, whose stability function is $R(z)=1+z$, we obtain the amplification matrix\n$$\nG \\;=\\; R(\\Delta t A) \\;=\\; I + \\Delta t\\, A.\n$$\n\nWe now derive a step-size bound that guarantees non-amplification of all modes in one forward Euler step. Let $\\{\\lambda_{j}\\}$ denote the eigenvalues of $A$. Since $A$ has real non-positive eigenvalues, write $\\lambda_{j}=-r_{j}$ with $r_{j}\\ge 0$. Acting on an eigenmode, the scalar amplification factor is\n$$\ng(\\lambda_{j}) \\;=\\; R(\\Delta t \\lambda_{j}) \\;=\\; 1 + \\Delta t \\lambda_{j} \\;=\\; 1 - \\Delta t r_{j}.\n$$\nNon-amplification in one step requires $|g(\\lambda_{j})|\\le 1$ for all $j$. Because $g(\\lambda_{j})$ is real, the condition $|1 - \\Delta t r_{j}| \\le 1$ is equivalent to\n$$\n-1 \\le 1 - \\Delta t r_{j} \\le 1 \\;\\;\\Longleftrightarrow\\;\\; 0 \\le \\Delta t r_{j} \\le 2.\n$$\nThe most restrictive constraint corresponds to the largest $r_{j}$, namely $r_{\\max}=\\max_{j} r_{j} = \\rho(A)$, since $\\rho(A)=\\max_{j} |\\lambda_{j}|$ and $\\lambda_{j}\\le 0$. Therefore,\n$$\n\\Delta t \\,\\rho(A) \\le 2 \\;\\;\\Longleftrightarrow\\;\\; \\Delta t \\le \\frac{2}{\\rho(A)}.\n$$\nThus the largest time step that guarantees non-amplification of all DG modes under forward Euler is\n$$\n\\Delta t_{\\max} \\;=\\; \\frac{2}{\\rho(A)}.\n$$", "answer": "$$\\boxed{\\frac{2}{\\rho(A)}}$$", "id": "3399416"}, {"introduction": "Many physical problems, such as convection-diffusion, involve terms with vastly different time scale constraints, leading to stiff ODE systems. Implicit-Explicit (IMEX) Runge-Kutta methods provide an elegant and efficient solution by treating the stiff terms (like diffusion) implicitly and the non-stiff terms (like convection) explicitly. This hands-on problem [@problem_id:3399430] demonstrates how to apply an IMEX scheme to a DG-discretized equation, showing how to formulate the algebraic system that must be solved at each implicit stage, a key practical skill for developing modern numerical solvers.", "problem": "Consider the scalar convection–diffusion equation $u_{t} + \\partial_{x} f(u) = \\partial_{x}\\!\\left(\\nu\\, \\partial_{x} u\\right)$ on a one-dimensional domain with sufficiently smooth initial and boundary data, constant viscosity $\\nu > 0$, and a smooth flux function $f(u)$. Let the domain be partitioned into non-overlapping elements and consider a discontinuous Galerkin (DG) spatial discretization using a polynomial space of fixed degree on each element. Let $\\{\\varphi_{i}\\}$ denote a basis of the DG space and write the DG approximation as $u_{h}(x,t) = \\sum_{i} U_{i}(t)\\,\\varphi_{i}(x)$, with coefficient vector $U(t)$.\n\nFor the convective operator, use a consistent monotone numerical flux on interelement boundaries and integrate the volume term by parts in each element to obtain a DG convective residual. For the diffusive operator, use the symmetric interior penalty Galerkin (SIPG) bilinear form with penalty parameter chosen sufficiently large to guarantee stability. Denote by $M$ the global DG mass matrix, by $C(U)$ the assembled global convective residual vector, and by $K_{\\nu}$ the assembled global SIPG stiffness matrix for diffusion, which is linear in $\\nu$. Assume $\\nu$ is constant in space so that $K_{\\nu} = \\nu K$ for a symmetric positive semidefinite matrix $K$ determined by the mesh, penalty, and basis.\n\n1. Starting from first principles of the DG method of lines, derive the semi-discrete system in the form $M\\,\\dot{U}(t) = E\\!\\left(U(t)\\right) + I\\!\\left(U(t)\\right)$ and identify $E(U)$ and $I(U)$ corresponding to the explicit convective and implicit diffusive contributions.\n\n2. Apply an implicit–explicit Runge–Kutta (IMEX–RK) time discretization in additive form to the system $M\\,\\dot{U} = E(U) + I(U)$, using the two-stage, second-order Ascher–Ruuth–Spiteri pair (often denoted ARS$(2,2,2)$) with the following Butcher arrays. For the explicit part $E(U)$, use\n$$\nA = \\begin{pmatrix}\n0 & 0 \\\\\n1 & 0\n\\end{pmatrix},\\quad\nb^{\\top} = \\begin{pmatrix}\n1 - \\gamma & \\gamma\n\\end{pmatrix},\\quad\nc = \\begin{pmatrix}\n0 \\\\\n1\n\\end{pmatrix},\n$$\nand for the diagonally implicit part $I(U)$, use\n$\n\\hat{A} = \\begin{pmatrix}\n\\gamma & 0 \\\\\n1 - \\gamma & \\gamma\n\\end{pmatrix},\\ \n\\hat{b}^{\\top} = \\begin{pmatrix}\n1 - \\gamma & \\gamma\n\\end{pmatrix},\\\n\\hat{c} = \\begin{pmatrix}\n\\gamma \\\\\n1\n\\end{pmatrix},\n$\nwith $\\gamma = 1 - 1/\\sqrt{2}$. Derive the stage equations and the step update in mass-matrix form, and isolate the algebraic system that must be solved at each stage for the implicit diffusion.\n\n3. Under the assumptions above (constant $\\nu$ so $K_{\\nu} = \\nu K$ and using ARS$(2,2,2)$), identify the exact symmetric positive definite matrix that is factorized once per time step and reused at both stages. Provide your final answer as an exact symbolic expression in terms of $M$, $\\Delta t$, $\\gamma$, $\\nu$, and $K$.\n\nYour final answer must be a single closed-form analytic expression. Do not include units. Do not approximate $\\gamma$; leave it exact.", "solution": "### Derivation of the Semi-discrete System\n\nWe begin with the scalar convection–diffusion equation $u_{t} + \\partial_{x} f(u) = \\partial_{x}\\!\\left(\\nu\\, \\partial_{x} u\\right)$, which can be rewritten as $u_{t} = -\\partial_{x} f(u) + \\partial_{x}\\!\\left(\\nu\\, \\partial_{x} u\\right)$. The method of lines approach discretizes the spatial operators to obtain a system of ODEs for the coefficients $U(t)$ of the DG basis functions.\n\n1.  **Mass Matrix:** The time-derivative term $\\int (\\partial_t u_h) \\varphi_i \\,dx$ leads to the $i$-th component of the vector $M\\dot{U}(t)$, where the global mass matrix has entries $(M)_{ij} = \\int_{\\Omega} \\varphi_i \\varphi_j \\,dx$.\n\n2.  **Convective Term (Explicit Part):** The spatial discretization of the convective operator $-\\partial_x f(u)$ (including integration by parts and using a numerical flux) leads to the assembled global convective residual vector, which the problem denotes $C(U)$. This term is to be treated explicitly, so we identify $E(U) = C(U)$.\n\n3.  **Diffusive Term (Implicit Part):** The symmetric interior penalty Galerkin (SIPG) discretization of the diffusive operator $+\\partial_x(\\nu \\partial_x u)$ results in the matrix-vector product $-K_{\\nu}U$, where $K_{\\nu}$ is the global SIPG stiffness matrix. For constant viscosity, $K_{\\nu} = \\nu K$. This linear term is to be treated implicitly, so we identify $I(U) = -\\nu K U$.\n\nCombining these parts, the semi-discrete system is $M\\dot{U}(t) = C(U) - \\nu K U$, which matches the required form $M\\dot{U}(t) = E(U(t)) + I(U(t))$.\n\n### IMEX-RK Time Discretization\n\nAn additive IMEX-RK scheme, when multiplied by the mass matrix $M$, has stage equations of the form:\n$$\nM U^{(i)} = M U^n + \\Delta t \\sum_{j=1}^{i-1} a_{ij} E(U^{(j)}) + \\Delta t \\sum_{j=1}^{i} \\hat{a}_{ij} I(U^{(j)})\n$$\nIsolating the terms for the current stage $i$ on the left side gives:\n$$\nM U^{(i)} - \\Delta t \\hat{a}_{ii} I(U^{(i)}) = M U^n + \\Delta t \\sum_{j=1}^{i-1} a_{ij} E(U^{(j)}) + \\Delta t \\sum_{j=1}^{i-1} \\hat{a}_{ij} I(U^{(j)})\n$$\nUsing $I(U) = -\\nu K U$, the left-hand side becomes $(M + \\Delta t \\hat{a}_{ii} \\nu K) U^{(i)}$, revealing the linear system to be solved for the stage vector $U^{(i)}$.\n\nFor the specific ARS$(2,2,2)$ scheme with $\\gamma = 1 - 1/\\sqrt{2}$, we have $\\hat{a}_{11} = \\hat{a}_{22} = \\gamma$. The two stage equations are:\n\n**Stage 1 ($i=1$):**\n$$\n(M + \\Delta t \\gamma \\nu K) U^{(1)} = M U^n\n$$\n\n**Stage 2 ($i=2$):** With $a_{21}=1$ and $\\hat{a}_{21}=1-\\gamma$:\n$$\n(M + \\Delta t \\gamma \\nu K) U^{(2)} = M U^n + \\Delta t E(U^{(1)}) - \\Delta t (1-\\gamma) \\nu K U^{(1)}\n$$\n\nThe final update is given by:\n$$\nM U^{n+1} = M U^n + \\Delta t \\sum_{i=1}^{2} b_i E(U^{(i)}) + \\Delta t \\sum_{i=1}^{2} \\hat{b}_i I(U^{(i)})\n$$\n\n### Identification of the Factorized Matrix\n\nThe equations for both stages involve solving a linear system with the **same** matrix on the left-hand side. This is because the implicit part of the scheme is a Singly Diagonally Implicit RK (SDIRK) method, with equal diagonal entries $\\hat{a}_{11} = \\hat{a}_{22} = \\gamma$. The matrix to be factorized once per time step is:\n$$\nL = M + \\Delta t \\gamma \\nu K\n$$\nThis matrix is symmetric positive definite (SPD) because:\n- $M$ is SPD.\n- $K$ is symmetric positive semidefinite (SPS).\n- $\\Delta t, \\gamma, \\nu$ are all positive scalars.\n- The sum of an SPD matrix and an SPS matrix is SPD.\n\nTherefore, the matrix $L$ is well-suited for factorization.", "answer": "$$\n\\boxed{M + \\Delta t \\gamma \\nu K}\n$$", "id": "3399430"}]}