{"hands_on_practices": [{"introduction": "To begin, we must understand the most fundamental role of the Jacobian: to relate an infinitesimal area or volume in the reference element to its counterpart in the physical element. The determinant of the Jacobian matrix, often denoted as $J$, is precisely this local scaling factor. This first exercise [@problem_id:3393863] provides a direct calculation of the Jacobian determinant for a simple curvilinear mapping, grounding the abstract concept in a concrete geometric interpretation.", "problem": "In high-order Spectral Element Method (SEM) and Discontinuous Galerkin (DG) formulations, integrals over a physical element are evaluated by pulling back to a reference element via a smooth mapping. Consider the two-dimensional reference square $[-1,1]^2$ with coordinates $(\\xi,\\eta)$ and the curvilinear isoparametric mapping $\\boldsymbol{x}(\\xi,\\eta) = \\big(x(\\xi,\\eta),y(\\xi,\\eta)\\big)$ into the physical plane defined by\n$$\nx(\\xi,\\eta) = \\xi + 0.1\\,\\xi\\,\\eta,\\qquad y(\\xi,\\eta) = \\eta + 0.2\\,\\eta^{2}.\n$$\nStarting from first principles, namely the change-of-variables theorem for surface integrals and the definition of the Jacobian matrix as the matrix of partial derivatives of the mapping, derive the determinant of the Jacobian matrix $J(\\xi,\\eta)$ for this mapping. Using your derived expression, evaluate $J(\\xi,\\eta)$ and its absolute value $|J(\\xi,\\eta)|$ at the point $(\\xi,\\eta)=(0.5,-0.5)$. Briefly interpret the value of the determinant as a local area scaling factor that relates an infinitesimal area element in the reference space to its image in the physical space. Express your final answer as the exact value of $|J(0.5,-0.5)|$ (no rounding).", "solution": "The problem requires the derivation of the Jacobian determinant for a given mapping from a reference element to a physical element, its evaluation at a specific point, and an interpretation of its geometric meaning.\n\nThe mapping from the reference coordinates $(\\xi, \\eta)$ in the square $[-1,1]^2$ to the physical coordinates $(x,y)$ is given by $\\boldsymbol{x}(\\xi,\\eta) = \\big(x(\\xi,\\eta), y(\\xi,\\eta)\\big)$, with components:\n$$\nx(\\xi,\\eta) = \\xi + 0.1\\,\\xi\\,\\eta\n$$\n$$\ny(\\xi,\\eta) = \\eta + 0.2\\,\\eta^{2}\n$$\nFrom first principles, the Jacobian matrix of this transformation, denoted $\\mathbf{J}(\\xi, \\eta)$, is the matrix of all first-order partial derivatives of the mapping functions:\n$$\n\\mathbf{J}(\\xi, \\eta) = \\frac{\\partial(x,y)}{\\partial(\\xi,\\eta)} = \\begin{pmatrix} \\frac{\\partial x}{\\partial \\xi}  \\frac{\\partial x}{\\partial \\eta} \\\\ \\frac{\\partial y}{\\partial \\xi}  \\frac{\\partial y}{\\partial \\eta} \\end{pmatrix}\n$$\nWe compute each partial derivative:\n1.  $\\frac{\\partial x}{\\partial \\xi} = \\frac{\\partial}{\\partial \\xi} (\\xi + 0.1\\,\\xi\\,\\eta) = 1 + 0.1\\,\\eta$\n2.  $\\frac{\\partial x}{\\partial \\eta} = \\frac{\\partial}{\\partial \\eta} (\\xi + 0.1\\,\\xi\\,\\eta) = 0.1\\,\\xi$\n3.  $\\frac{\\partial y}{\\partial \\xi} = \\frac{\\partial}{\\partial \\xi} (\\eta + 0.2\\,\\eta^{2}) = 0$\n4.  $\\frac{\\partial y}{\\partial \\eta} = \\frac{\\partial}{\\partial \\eta} (\\eta + 0.2\\,\\eta^{2}) = 1 + 0.4\\,\\eta$\n\nSubstituting these into the matrix gives the Jacobian matrix for the mapping:\n$$\n\\mathbf{J}(\\xi, \\eta) = \\begin{pmatrix} 1 + 0.1\\,\\eta  0.1\\,\\xi \\\\ 0  1 + 0.4\\,\\eta \\end{pmatrix}\n$$\nThe determinant of the Jacobian matrix, denoted by $J(\\xi,\\eta)$, is calculated as:\n$$\nJ(\\xi,\\eta) = \\det(\\mathbf{J}(\\xi, \\eta)) = (1 + 0.1\\,\\eta)(1 + 0.4\\,\\eta) - (0.1\\,\\xi)(0)\n$$\nThus, the expression for the Jacobian determinant is:\n$$\nJ(\\xi,\\eta) = (1 + 0.1\\,\\eta)(1 + 0.4\\,\\eta)\n$$\nNext, we evaluate this determinant at the specified point $(\\xi, \\eta) = (0.5, -0.5)$.\nSubstituting $\\xi = 0.5$ and $\\eta = -0.5$:\n$$\nJ(0.5, -0.5) = \\big(1 + 0.1 \\times (-0.5)\\big) \\big(1 + 0.4 \\times (-0.5)\\big)\n$$\n$$\nJ(0.5, -0.5) = (1 - 0.05)(1 - 0.20)\n$$\n$$\nJ(0.5, -0.5) = (0.95)(0.80)\n$$\nTo find the exact value, we can use fractions: $0.95 = \\frac{95}{100} = \\frac{19}{20}$ and $0.80 = \\frac{80}{100} = \\frac{4}{5}$.\n$$\nJ(0.5, -0.5) = \\left(\\frac{19}{20}\\right) \\left(\\frac{4}{5}\\right) = \\frac{19 \\times 4}{20 \\times 5} = \\frac{19}{5 \\times 5} = \\frac{19}{25}\n$$\nThis exact value can also be expressed as the decimal $0.76$.\nThe value of the Jacobian determinant at the point is $J(0.5,-0.5) = 0.76$.\nThe absolute value is $|J(0.5, -0.5)| = |0.76| = 0.76$.\n\nThe interpretation of the Jacobian determinant comes from the change of variables theorem for multiple integrals. An infinitesimal area element $dA_{ref} = d\\xi\\,d\\eta$ in the reference space is mapped to an infinitesimal area element $dA_{phys} = dx\\,dy$ in the physical space, and their areas are related by:\n$$\ndA_{phys} = |J(\\xi,\\eta)| \\, dA_{ref}\n$$\nThe value $|J(\\xi,\\eta)|$ is therefore the local area scaling factor. At the point $(\\xi, \\eta) = (0.5, -0.5)$, the value is $|J| = 0.76$. This means that an infinitesimal area in the reference space around this point is transformed into an area in the physical space that is $0.76$ times as large. Since $|J|  1$, the mapping is a local compression of area. The sign of $J = 0.76$ is positive, which indicates that the mapping is orientation-preserving at this point.", "answer": "$$\n\\boxed{\\frac{19}{25}}\n$$", "id": "3393863"}, {"introduction": "Understanding the geometric scaling is the first step; the next is to see how it impacts the numerical machinery of spectral and discontinuous Galerkin methods. Since all integration is performed on the reference element, the integrand is always a product of the original function and the geometric factors from the mapping. This practice problem [@problem_id:3393882] demonstrates how even a simple polynomial mapping can alter the integrand in a way that affects the accuracy of standard numerical quadrature rules, a crucial consideration for ensuring the fidelity of the simulation.", "problem": "Consider a single curvilinear element in one dimension used in a spectral or discontinuous Galerkin method. The physical coordinate $x$ is obtained from a reference coordinate $\\xi \\in [-1,1]$ by a polynomial mapping $x(\\xi) = \\xi + \\epsilon \\,\\xi^{2}$. The geometric factor (Jacobian of the mapping) is $J(\\xi) = \\frac{dx}{d\\xi}$. The elementwise physical integral of a scalar field $f(x)$ is related to the reference-element integral by the change-of-variables formula: $\\int_{\\Omega_{e}} f(x) \\, dx = \\int_{-1}^{1} f(x(\\xi))\\,J(\\xi)\\,d\\xi$. In Gaussian quadrature the reference-element integral is approximated by a weighted sum of function evaluations at nodes in $[-1,1]$.\n\nStarting from these foundational facts, define $f(x) = x^{4}$, fix the mapping parameter $\\epsilon = \\frac{1}{4}$ and use a $N=3$ point Gauss–Legendre quadrature on $[-1,1]$. Compute the quadrature error defined as $\\mathcal{E}_{3}\\left(\\frac{1}{4}\\right) = Q_{3} - I_{\\text{exact}}$, where $I_{\\text{exact}}$ is the exact value of $\\int_{\\Omega_{e}} x^{4}\\,dx$, and $Q_{3}$ is the $3$-point Gauss–Legendre quadrature approximation of $\\int_{-1}^{1} f(x(\\xi))\\,J(\\xi)\\,d\\xi$ on the reference interval. Express the final answer as an exact rational number.", "solution": "The objective is to compute the quadrature error $\\mathcal{E}_{3}\\left(\\frac{1}{4}\\right) = Q_{3} - I_{\\text{exact}}$.\n\nFirst, we establish the specific forms of the mapping and the Jacobian for the given parameter $\\epsilon = \\frac{1}{4}$.\nThe mapping is $x(\\xi) = \\xi + \\frac{1}{4}\\xi^{2}$.\nThe Jacobian is the derivative of the mapping with respect to the reference coordinate $\\xi$:\n$$\nJ(\\xi) = \\frac{d}{d\\xi}\\left(\\xi + \\frac{1}{4}\\xi^{2}\\right) = 1 + \\frac{1}{2}\\xi\n$$\nThe integrand on the reference element, which we denote as $g(\\xi)$, is given by $f(x(\\xi))J(\\xi)$. With $f(x) = x^{4}$, we have:\n$$\ng(\\xi) = \\left(\\xi + \\frac{1}{4}\\xi^{2}\\right)^{4} \\left(1 + \\frac{1}{2}\\xi\\right)\n$$\nTo proceed, we expand $g(\\xi)$ into a polynomial in $\\xi$:\n$$\ng(\\xi) = \\xi^{4}\\left(1 + \\frac{1}{4}\\xi\\right)^{4} \\left(1 + \\frac{1}{2}\\xi\\right)\n$$\nUsing the binomial theorem for $(a+b)^4 = a^4 + 4a^3b + 6a^2b^2 + 4ab^3 + b^4$:\n$$\n\\left(1 + \\frac{1}{4}\\xi\\right)^{4} = 1^{4} + 4(1)^{3}\\left(\\frac{1}{4}\\xi\\right) + 6(1)^{2}\\left(\\frac{1}{4}\\xi\\right)^{2} + 4(1)\\left(\\frac{1}{4}\\xi\\right)^{3} + \\left(\\frac{1}{4}\\xi\\right)^{4}\n$$\n$$\n= 1 + \\xi + \\frac{6}{16}\\xi^{2} + \\frac{4}{64}\\xi^{3} + \\frac{1}{256}\\xi^{4} = 1 + \\xi + \\frac{3}{8}\\xi^{2} + \\frac{1}{16}\\xi^{3} + \\frac{1}{256}\\xi^{4}\n$$\nMultiplying by $\\xi^{4}$:\n$$\n\\xi^{4}\\left(1 + \\frac{1}{4}\\xi\\right)^{4} = \\xi^{4} + \\xi^{5} + \\frac{3}{8}\\xi^{6} + \\frac{1}{16}\\xi^{7} + \\frac{1}{256}\\xi^{8}\n$$\nFinally, multiplying by $J(\\xi) = (1 + \\frac{1}{2}\\xi)$:\n$$\ng(\\xi) = \\left(\\xi^{4} + \\xi^{5} + \\frac{3}{8}\\xi^{6} + \\frac{1}{16}\\xi^{7} + \\frac{1}{256}\\xi^{8}\\right)\\left(1 + \\frac{1}{2}\\xi\\right)\n$$\n$$\n= (\\xi^{4} + \\xi^{5} + \\frac{3}{8}\\xi^{6} + \\frac{1}{16}\\xi^{7} + \\frac{1}{256}\\xi^{8}) + (\\frac{1}{2}\\xi^{5} + \\frac{1}{2}\\xi^{6} + \\frac{3}{16}\\xi^{7} + \\frac{1}{32}\\xi^{8} + \\frac{1}{512}\\xi^{9})\n$$\nCollecting terms by powers of $\\xi$:\n$$\ng(\\xi) = \\xi^{4} + \\frac{3}{2}\\xi^{5} + \\frac{7}{8}\\xi^{6} + \\frac{1}{4}\\xi^{7} + \\frac{9}{256}\\xi^{8} + \\frac{1}{512}\\xi^{9}\n$$\nThis is a polynomial of degree $9$. The $N=3$ point Gauss-Legendre quadrature rule is exact for polynomials of degree $2N-1 = 2(3)-1 = 5$ or less. The error is therefore the difference between the quadrature sum and the exact integral of the terms in $g(\\xi)$ with degree greater than $5$.\n\nLet $p_{5}(\\xi)$ be the part of $g(\\xi)$ with degree $\\le 5$, and $r(\\xi)$ be the remainder.\n$p_{5}(\\xi) = \\xi^{4} + \\frac{3}{2}\\xi^{5}$\n$r(\\xi) = g(\\xi) - p_{5}(\\xi) = \\frac{7}{8}\\xi^{6} + \\frac{1}{4}\\xi^{7} + \\frac{9}{256}\\xi^{8} + \\frac{1}{512}\\xi^{9}$\n\nThe exact integral is $I_{\\text{exact}} = \\int_{-1}^{1} g(\\xi) d\\xi = \\int_{-1}^{1} (p_{5}(\\xi) + r(\\xi)) d\\xi$.\nThe quadrature approximation is $Q_{3} = Q_{3}(g) = Q_{3}(p_{5} + r) = Q_{3}(p_{5}) + Q_{3}(r)$.\nDue to the exactness property of the quadrature rule, $Q_{3}(p_{5}) = \\int_{-1}^{1} p_{5}(\\xi) d\\xi$.\nThe error is therefore:\n$$\n\\mathcal{E}_{3} = Q_{3} - I_{\\text{exact}} = (Q_{3}(p_{5}) + Q_{3}(r)) - \\left(\\int_{-1}^{1} p_{5}(\\xi)d\\xi + \\int_{-1}^{1} r(\\xi)d\\xi\\right) = Q_{3}(r) - \\int_{-1}^{1} r(\\xi)d\\xi\n$$\nWe compute the two terms separately.\n\n1.  The exact integral of the remainder $r(\\xi)$.\n    $$\n    \\int_{-1}^{1} r(\\xi)d\\xi = \\int_{-1}^{1} \\left(\\frac{7}{8}\\xi^{6} + \\frac{1}{4}\\xi^{7} + \\frac{9}{256}\\xi^{8} + \\frac{1}{512}\\xi^{9}\\right) d\\xi\n    $$\n    The integral of an odd function (odd powers of $\\xi$) over the symmetric interval $[-1,1]$ is zero. We only need to integrate the even powers:\n    $$\n    \\int_{-1}^{1} r(\\xi)d\\xi = \\int_{-1}^{1} \\left(\\frac{7}{8}\\xi^{6} + \\frac{9}{256}\\xi^{8}\\right) d\\xi = \\left[\\frac{7}{8}\\frac{\\xi^{7}}{7} + \\frac{9}{256}\\frac{\\xi^{9}}{9}\\right]_{-1}^{1} = \\left[\\frac{1}{8}\\xi^{7} + \\frac{1}{256}\\xi^{9}\\right]_{-1}^{1}\n    $$\n    $$\n    = \\left(\\frac{1}{8} + \\frac{1}{256}\\right) - \\left(-\\frac{1}{8} - \\frac{1}{256}\\right) = 2\\left(\\frac{1}{8} + \\frac{1}{256}\\right) = \\frac{1}{4} + \\frac{1}{128} = \\frac{32}{128} + \\frac{1}{128} = \\frac{33}{128}\n    $$\n\n2.  The quadrature approximation of the remainder, $Q_{3}(r)$.\n    The $N=3$ Gauss-Legendre quadrature nodes ($\\xi_{i}$) and weights ($w_{i}$) are:\n    $\\xi_{1} = -\\sqrt{\\frac{3}{5}}$, $w_{1} = \\frac{5}{9}$\n    $\\xi_{2} = 0$, $w_{2} = \\frac{8}{9}$\n    $\\xi_{3} = \\sqrt{\\frac{3}{5}}$, $w_{3} = \\frac{5}{9}$\n    The quadrature sum is $Q_{3}(r) = \\sum_{i=1}^{3} w_{i}r(\\xi_{i})$.\n    Since $r(0)=0$, the term for $\\xi_2=0$ is zero. Let $\\xi_0 = \\sqrt{\\frac{3}{5}}$.\n    $r(-\\xi_0) = \\frac{7}{8}(-\\xi_0)^{6} + \\frac{1}{4}(-\\xi_0)^{7} + \\frac{9}{256}(-\\xi_0)^{8} + \\frac{1}{512}(-\\xi_0)^{9} = \\frac{7}{8}\\xi_0^{6} - \\frac{1}{4}\\xi_0^{7} + \\frac{9}{256}\\xi_0^{8} - \\frac{1}{512}\\xi_0^{9}$.\n    $r(\\xi_0) = \\frac{7}{8}\\xi_0^{6} + \\frac{1}{4}\\xi_0^{7} + \\frac{9}{256}\\xi_0^{8} + \\frac{1}{512}\\xi_0^{9}$.\n    $Q_{3}(r) = w_{1}r(-\\xi_{0}) + w_{3}r(\\xi_{0}) = \\frac{5}{9}(r(-\\xi_{0}) + r(\\xi_{0}))$.\n    $r(-\\xi_{0}) + r(\\xi_{0}) = 2\\left(\\frac{7}{8}\\xi_0^{6} + \\frac{9}{256}\\xi_0^{8}\\right)$.\n    We have $\\xi_0^2 = \\frac{3}{5}$, so $\\xi_0^6 = (\\frac{3}{5})^3 = \\frac{27}{125}$ and $\\xi_0^8 = (\\frac{3}{5})^4 = \\frac{81}{625}$.\n    $$\n    Q_{3}(r) = \\frac{5}{9} \\times 2 \\left( \\frac{7}{8}\\frac{27}{125} + \\frac{9}{256}\\frac{81}{625} \\right) = \\frac{10}{9} \\left( \\frac{189}{1000} + \\frac{729}{160000} \\right)\n    $$\n    To add the fractions in the parenthesis, we use a common denominator of $160000$:\n    $$\n    Q_{3}(r) = \\frac{10}{9} \\left( \\frac{189 \\times 160}{160000} + \\frac{729}{160000} \\right) = \\frac{10}{9} \\left( \\frac{30240 + 729}{160000} \\right) = \\frac{10}{9} \\left( \\frac{30969}{160000} \\right)\n    $$\n    The sum of digits of $30969$ is $3+0+9+6+9 = 27$, so it is divisible by $9$. $30969/9=3441$.\n    $$\n    Q_{3}(r) = \\frac{10 \\times 3441}{160000} = \\frac{3441}{16000}\n    $$\n\n3.  Finally, we compute the error $\\mathcal{E}_{3}$.\n    $$\n    \\mathcal{E}_{3} = Q_{3}(r) - \\int_{-1}^{1} r(\\xi)d\\xi = \\frac{3441}{16000} - \\frac{33}{128}\n    $$\n    The least common multiple of $16000$ and $128$ is $16000$, since $16000 = 125 \\times 128$.\n    $$\n    \\mathcal{E}_{3} = \\frac{3441}{16000} - \\frac{33 \\times 125}{128 \\times 125} = \\frac{3441}{16000} - \\frac{4125}{16000} = \\frac{3441 - 4125}{16000} = -\\frac{684}{16000}\n    $$\n    This rational number can be simplified by dividing the numerator and denominator by their greatest common divisor, which is $4$.\n    $$\n    \\mathcal{E}_{3} = -\\frac{684 \\div 4}{16000 \\div 4} = -\\frac{171}{4000}\n    $$\n    The prime factorization of the numerator is $171 = 3^2 \\times 19$, and of the denominator is $4000 = 2^5 \\times 5^3$. There are no common factors, so the fraction is in its simplest form.", "answer": "$$\n\\boxed{-\\frac{171}{4000}}\n$$", "id": "3393882"}, {"introduction": "Finally, we explore a more profound and critical property related to the discretization of geometric factors: the Geometric Conservation Law (GCL). For a numerical scheme to be robust on curvilinear grids, its discrete operators must not introduce errors for trivial solutions, such as a uniform flow. This exercise [@problem_id:3393877] serves as a vital cautionary tale, demonstrating how an inconsistent or 'naive' discretization of the metric terms violates the GCL, leading to the generation of spurious, unphysical source terms even for a constant solution.", "problem": "Consider a two-dimensional nodal spectral element discretization on the reference square $\\hat{\\Omega} = [-1,1] \\times [-1,1]$ with a tensor-product Gauss–Lobatto–Legendre (GLL) grid of polynomial degree $N=2$. The nodes in each coordinate are $s \\in \\{-1,0,1\\}$ and $r \\in \\{-1,0,1\\}$, and the associated one-dimensional GLL differentiation matrix is\n$$\nD \\;=\\;\n\\begin{pmatrix}\n-\\tfrac{3}{2}  2  -\\tfrac{1}{2} \\\\[4pt]\n-\\tfrac{1}{2}  0  \\tfrac{1}{2} \\\\[4pt]\n\\tfrac{1}{2}  -2  \\tfrac{3}{2}\n\\end{pmatrix}.\n$$\nLet the curvilinear mapping from reference coordinates $(r,s)$ to physical coordinates $(x,y)$ be\n$$\nx(r,s) \\;=\\; r \\;+\\; r\\,s^{2}, \n\\qquad\ny(r,s) \\;=\\; s.\n$$\nAdopt the standard covariant base vectors $\\mathbf{a}_{r} = \\partial \\mathbf{x}/\\partial r$ and $\\mathbf{a}_{s} = \\partial \\mathbf{x}/\\partial s$, the Jacobian determinant $J = \\det[\\mathbf{a}_{r}\\ \\mathbf{a}_{s}]$, and the contravariant metric vectors $J\\,\\mathbf{a}^{r}$ and $J\\,\\mathbf{a}^{s}$ defined by the planar $90^{\\circ}$ rotation of the covariant base vectors:\n$$\nJ\\,\\mathbf{a}^{r} \\;=\\; \\big(a_{s,y},\\,-a_{s,x}\\big),\n\\qquad\nJ\\,\\mathbf{a}^{s} \\;=\\; \\big(-a_{r,y},\\,a_{r,x}\\big),\n$$\nwhere $\\mathbf{a}_{r}=(a_{r,x},a_{r,y})$ and $\\mathbf{a}_{s}=(a_{s,x},a_{s,y})$. For this mapping, the exact $y$-components of the contravariant metric vectors are\n$$\nG^{r}_{y}(r,s) \\;=\\; -\\,2\\,r\\,s,\n\\qquad\nG^{s}_{y}(r,s) \\;=\\; 1 \\;+\\; s^{2}.\n$$\nThese satisfy the continuous metric identity $\\partial_{r} G^{r}_{y} + \\partial_{s} G^{s}_{y} = 0$.\n\nNow construct a discrete metric approximation that violates the metric identity by defining the $y$-component of $J\\,\\mathbf{a}^{s}$ via a degree-one interpolation in the $s$-direction using only the endpoint nodes $s=\\pm 1$:\n$$\n\\tilde{G}^{s}_{y}(r,s) \\;:=\\; I_{1}\\big[\\,1+s^{2}\\,\\big](s)\n\\;=\\; \\tfrac{1+s}{2}\\big(1+1^{2}\\big) \\;+\\; \\tfrac{1-s}{2}\\big(1+(-1)^{2}\\big)\n\\;=\\; 2,\n$$\nso that $\\tilde{G}^{s}_{y}$ is constant in $s$. Keep $G^{r}_{y}$ exact at the nodes.\n\nConsider mapped linear advection of a constant solution $u(r,s)\\equiv u_{0}$ with a constant physical advection velocity $\\mathbf{a}=(0,1)$. In strong form, the semi-discrete volume residual at a node $(r_{i},s_{j})$ is computed by applying the tensor-product differentiation operators to the mapped contravariant flux components\n$$\n\\phi^{r}(r_{i},s_{j}) \\;=\\; u_{0}\\,G^{r}_{y}(r_{i},s_{j}), \n\\qquad\n\\phi^{s}(r_{i},s_{j}) \\;=\\; u_{0}\\,\\tilde{G}^{s}_{y}(r_{i},s_{j}),\n$$\nnamely\n$$\n\\mathcal{R}_{ij} \\;=\\; \\sum_{k=1}^{3} D_{ik}\\,\\phi^{r}(r_{k},s_{j}) \\;+\\; \\sum_{\\ell=1}^{3} D_{j\\ell}\\,\\phi^{s}(r_{i},s_{\\ell}).\n$$\n\nUsing $u_{0}=1$, evaluate the semi-discrete volume residual $\\mathcal{R}_{ij}$ at the nodal point $(r_{i},s_{j})=(0,1)$. Provide the final answer as a single real number. No rounding is required.", "solution": "The problem is valid. The setup is self-contained, scientifically sound within the domain of numerical analysis for partial differential equations, and well-posed. All necessary data and definitions for the calculation are provided.\n\nThe objective is to compute the semi-discrete volume residual $\\mathcal{R}_{ij}$ at the nodal point $(r_{i},s_{j})=(0,1)$. The nodal grid points for polynomial degree $N=2$ are $r, s \\in \\{-1, 0, 1\\}$. We can index these as $r_1=-1$, $r_2=0$, $r_3=1$ and $s_1=-1$, $s_2=0$, $s_3=1$. The target node $(r,s)=(0,1)$ thus corresponds to the indices $(i,j)=(2,3)$.\n\nThe formula for the semi-discrete volume residual at node $(r_i, s_j)$ is given by:\n$$\n\\mathcal{R}_{ij} \\;=\\; \\sum_{k=1}^{3} D_{ik}\\,\\phi^{r}(r_{k},s_{j}) \\;+\\; \\sum_{\\ell=1}^{3} D_{j\\ell}\\,\\phi^{s}(r_{i},s_{\\ell})\n$$\nWe need to evaluate this for $(i,j)=(2,3)$:\n$$\n\\mathcal{R}_{23} \\;=\\; \\sum_{k=1}^{3} D_{2k}\\,\\phi^{r}(r_{k},s_{3}) \\;+\\; \\sum_{\\ell=1}^{3} D_{3\\ell}\\,\\phi^{s}(r_{2},s_{\\ell})\n$$\nThe calculation is split into two parts.\n\nPart 1: The derivative in the $r$-direction.\nThis term is the first summation: $\\sum_{k=1}^{3} D_{2k}\\,\\phi^{r}(r_{k},s_{3})$. This corresponds to applying the second row of the differentiation matrix $D$ to the vector of flux values $\\phi^r$ evaluated along the line where $s=s_3=1$.\nThe second row of the differentiation matrix $D$ is given as $(D_{21}, D_{22}, D_{23}) = (-\\frac{1}{2}, 0, \\frac{1}{2})$.\nThe contravariant flux component $\\phi^r$ is defined as $\\phi^{r}(r,s) = u_{0}\\,G^{r}_{y}(r,s)$. With $u_0=1$ and the exact metric component $G^{r}_{y}(r,s) = -2rs$, the flux becomes $\\phi^{r}(r,s) = -2rs$.\nWe evaluate this flux at $s_j=s_3=1$ for each of the $r$-nodes $r_k \\in \\{-1, 0, 1\\}$:\n\\begin{itemize}\n    \\item For $k=1$, $r_1=-1$: $\\phi^{r}(r_{1},s_{3}) = \\phi^{r}(-1,1) = -2(-1)(1) = 2$.\n    \\item For $k=2$, $r_2=0$: $\\phi^{r}(r_{2},s_{3}) = \\phi^{r}(0,1) = -2(0)(1) = 0$.\n    \\item For $k=3$, $r_3=1$: $\\phi^{r}(r_{3},s_{3}) = \\phi^{r}(1,1) = -2(1)(1) = -2$.\n\\end{itemize}\nThe first term of the residual is the dot product of the second row of $D$ and the vector of flux values $(\\phi^{r}(-1,1), \\phi^{r}(0,1), \\phi^{r}(1,1))$:\n$$\n\\sum_{k=1}^{3} D_{2k}\\,\\phi^{r}(r_{k},s_{3}) = D_{21}\\phi^{r}(r_1,s_3) + D_{22}\\phi^{r}(r_2,s_3) + D_{23}\\phi^{r}(r_3,s_3)\n= \\left(-\\frac{1}{2}\\right)(2) \\;+\\; (0)(0) \\;+\\; \\left(\\frac{1}{2}\\right)(-2) = -1 - 1 = -2.\n$$\n\nPart 2: The derivative in the $s$-direction.\nThis term is the second summation: $\\sum_{\\ell=1}^{3} D_{3\\ell}\\,\\phi^{s}(r_{2},s_{\\ell})$. This corresponds to applying the third row of the differentiation matrix $D$ to the vector of flux values $\\phi^s$ evaluated along the line where $r=r_2=0$.\nThe third row of the differentiation matrix $D$ is given as $(D_{31}, D_{32}, D_{33}) = (\\frac{1}{2}, -2, \\frac{3}{2})$.\nThe contravariant flux component $\\phi^s$ is defined using the approximated metric, $\\phi^{s}(r,s) = u_{0}\\,\\tilde{G}^{s}_{y}(r,s)$. With $u_0=1$ and the given approximation $\\tilde{G}^{s}_{y}(r,s) = 2$, the flux becomes $\\phi^{s}(r,s) = 2$.\nThis flux is constant. We evaluate it at $r_i=r_2=0$ for each of the $s$-nodes $s_\\ell \\in \\{-1, 0, 1\\}$:\n\\begin{itemize}\n    \\item For $\\ell=1$, $s_1=-1$: $\\phi^{s}(r_{2},s_{1}) = \\phi^{s}(0,-1) = 2$.\n    \\item For $\\ell=2$, $s_2=0$: $\\phi^{s}(r_{2},s_{2}) = \\phi^{s}(0,0) = 2$.\n    \\item For $\\ell=3$, $s_3=1$: $\\phi^{s}(r_{2},s_{3}) = \\phi^{s}(0,1) = 2$.\n\\end{itemize}\nThe second term of the residual is the dot product of the third row of $D$ and the vector of flux values $(\\phi^{s}(0,-1), \\phi^{s}(0,0), \\phi^{s}(0,1))$:\n$$\n\\sum_{\\ell=1}^{3} D_{3\\ell}\\,\\phi^{s}(r_{2},s_{\\ell}) = D_{31}\\phi^{s}(r_2,s_1) + D_{32}\\phi^{s}(r_2,s_2) + D_{33}\\phi^{s}(r_2,s_3)\n= \\left(\\frac{1}{2}\\right)(2) \\;+\\; (-2)(2) \\;+\\; \\left(\\frac{3}{2}\\right)(2) = 1 - 4 + 3 = 0.\n$$\nThis result is expected, as differentiation of a constant function by a consistent discrete operator yields zero. The sum of the elements in any row of the GLL differentiation matrix is zero, which ensures this property.\n\nFinally, we sum the two parts to get the total residual $\\mathcal{R}_{23}$:\n$$\n\\mathcal{R}_{23} = (-2) + (0) = -2.\n$$\nThe non-zero residual indicates that the chosen discrete approximation of the metric factors violates the discrete Geometric Conservation Law (GCL), leading to spurious source terms even for a constant solution.", "answer": "$$\\boxed{-2}$$", "id": "3393877"}]}