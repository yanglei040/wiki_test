{"hands_on_practices": [{"introduction": "The numerical flux at element interfaces is the cornerstone of the discontinuous Galerkin method for conservation laws. This practice focuses on deriving the celebrated Godunov flux, which is constructed from the exact solution of the local Riemann problem [@problem_id:3401198]. By working through the specific case of Burgers' equation, you will learn how the interplay between shocks and rarefactions dictates the flux value and gain insight into how this choice ensures the entropy stability of the numerical scheme.", "problem": "Consider the scalar conservation law Burgers' equation $u_{t} + (f(u))_{x} = 0$ with $f(u) = \\frac{u^{2}}{2}$. In a one-dimensional Discontinuous Galerkin (DG) method, the inter-element coupling is effected via a numerical flux at each interface. The Godunov numerical flux is defined as the physical flux evaluated at the state of the exact self-similar Riemann solution at the interface $x=0$ for the initial data $u(x,0) = u^{-}$ for $x<0$ and $u(x,0) = u^{+}$ for $x>0$. Starting from the fundamental principles for scalar conservation laws, namely (i) Rankine–Hugoniot jump condition for shocks, (ii) Lax entropy condition for admissible discontinuities, and (iii) method of characteristics for rarefactions, derive the explicit analytic expression of the Godunov flux $F_{G}(u^{-},u^{+})$ in terms of $u^{-}$ and $u^{+}$ for Burgers' equation. Then, explain how using this flux in the DG method at interfaces yields a discrete entropy (quadratic entropy) inequality and stabilizes the semi-discrete scheme by dissipating inter-element jumps.\n\nYour final answer must be the single closed-form analytic expression for $F_{G}(u^{-},u^{+})$. No numerical evaluation is required.", "solution": "The problem requires the derivation of the Godunov numerical flux for Burgers' equation, followed by an explanation of its role in ensuring entropy stability in a Discontinuous Galerkin (DG) framework.\n\nThe scalar conservation law under consideration is Burgers' equation:\n$$\nu_{t} + \\left(\\frac{u^2}{2}\\right)_x = 0\n$$\nwhere the flux function is $f(u) = \\frac{u^2}{2}$. The characteristic speed is given by $c(u) = f'(u) = u$.\n\nThe Godunov numerical flux, $F_{G}(u^{-},u^{+})$, is defined as the physical flux evaluated at the self-similar solution of the Riemann problem at the interface location $x=0$. The Riemann problem is defined by the initial condition:\n$$\nu(x,0) = \\begin{cases} u^{-} & x < 0 \\\\ u^{+} & x > 0 \\end{cases}\n$$\nThe solution to this problem, $u(x,t)$, is a function of the similarity variable $\\xi = x/t$. The Godunov flux is then $F_{G}(u^{-},u^{+}) = f(u(0,t)) = f(u(\\xi=0))$. We must analyze the solution based on the relationship between $u^{-}$ and $u^{+}$.\n\n**Part 1: Derivation of the Godunov Flux $F_{G}(u^{-},u^{+})$**\n\nThe nature of the Riemann solution depends on whether characteristics are diverging or converging.\n\n**Case 1: Rarefaction Wave ($u^{-} < u^{+}$)**\nThe characteristics with speeds $c(u)=u$ are diverging from the origin, creating a continuous solution known as a rarefaction wave. The solution is given by:\n$$\nu(x,t) = \\begin{cases} u^{-} & \\text{for } x/t < u^{-} \\\\ x/t & \\text{for } u^{-} \\le x/t \\le u^{+} \\\\ u^{+} & \\text{for } x/t > u^{+} \\end{cases}\n$$\nThe state at the interface, $u(\\xi=0)$, is found by evaluating this solution at $x/t=0$.\n- If $u^{-} < 0 < u^{+}$, the interface state is $u(0,t)=0$. The flux is $F_{G} = f(0) = 0$.\n- If $0 \\le u^{-} < u^{+}$, the characteristics have positive speeds, so they all move to the right. The region $x<0$ remains in state $u^{-}$, thus the interface state is $u(0,t)=u^{-}$. The flux is $F_{G} = f(u^{-}) = \\frac{(u^{-})^2}{2}$.\n- If $u^{-} < u^{+} \\le 0$, the characteristics have negative speeds, so they all move to the left. The region $x>0$ remains in state $u^{+}$, thus the interface state is $u(0,t)=u^{+}$. The flux is $F_{G} = f(u^{+}) = \\frac{(u^{+})^2}{2}$.\n\nThese three sub-cases for the rarefaction wave can be summarized elegantly. The flux function $f(u) = u^2/2$ is convex, with a global minimum at $u=0$. The value of the Godunov flux in a rarefaction corresponds to the value of the physical flux at the point that minimizes $f(u)$ over the interval $[u^{-}, u^{+}]$. That is, for $u^{-} < u^{+}$,\n$$\nF_{G}(u^{-},u^{+}) = \\min_{u \\in [u^{-}, u^{+}]} f(u)\n$$\n\n**Case 2: Shock Wave ($u^{-} > u^{+}$)**\nThe characteristics are converging, which leads to the formation of a discontinuity, or shock. The speed of this shock, $s$, is determined by the Rankine-Hugoniot jump condition:\n$$\ns = \\frac{[f]}{[u]} = \\frac{f(u^{+}) - f(u^{-})}{u^{+} - u^{-}}\n$$\nFor Burgers' equation, this yields:\n$$\ns = \\frac{\\frac{(u^{+})^2}{2} - \\frac{(u^{-})^2}{2}}{u^{+} - u^{-}} = \\frac{(u^{+} - u^{-})(u^{+} + u^{-})}{2(u^{+} - u^{-})} = \\frac{u^{-} + u^{+}}{2}\n$$\nA shock is physically admissible only if it satisfies the Lax entropy condition, which states that characteristics must enter the shock from both sides: $f'(u^{-}) > s > f'(u^{+})$. For Burgers' equation, this is $u^{-} > s > u^{+}$.\n- $u^{-} > \\frac{u^{-} + u^{+}}{2} \\implies 2u^{-} > u^{-} + u^{+} \\implies u^{-} > u^{+}$\n- $\\frac{u^{-} + u^{+}}{2} > u^{+} \\implies u^{-} + u^{+}> 2u^{+} \\implies u^{-} > u^{+}$\nThe condition is satisfied for any $u^{-} > u^{+}$, so all such shocks are admissible.\n\nThe state at the interface $x=0$ depends on the direction of shock propagation, determined by the sign of $s$.\n- If $s > 0$ (i.e., $u^{-} + u^{+} > 0$), the shock propagates to the right. For $t>0$, the state at $x=0$ is the left state, $u^{-}$. The flux is $F_{G} = f(u^{-}) = \\frac{(u^{-})^2}{2}$.\n- If $s < 0$ (i.e., $u^{-} + u^{+} < 0$), the shock propagates to the left. For $t>0$, the state at $x=0$ is the right state, $u^{+}$. The flux is $F_{G} = f(u^{+}) = \\frac{(u^{+})^2}{2}$.\n- If $s = 0$ (i.e., $u^{-} + u^{+} = 0$), the shock is stationary at $x=0$. The Rankine-Hugoniot condition implies $f(u^{+}) - f(u^{-}) = 0$, so $f(u^{-}) = f(u^{+})$. The flux is continuous across the shock, and we can take either value. Note that $f(u^{-}) = f(-u^{+}) = \\frac{(-u^{+})^2}{2} = \\frac{(u^{+})^2}{2} = f(u^{+})$. Our convention for $s \\le 0$ correctly selects $f(u^{+})$.\n\nWe can express these sub-cases for the shock wave in a compact form. The sign of $f(u^{-}) - f(u^{+}) = \\frac{1}{2}(u^{-}-u^{+})(u^{-}+u^{+})$ depends on the sign of $u^{-}+u^{+}$, since $u^{-}-u^{+}>0$.\n- If $u^{-}+u^{+} > 0$, then $f(u^{-}) > f(u^{+})$, so $F_{G} = f(u^{-}) = \\max(f(u^{-}), f(u^{+}))$.\n- If $u^{-}+u^{+} < 0$, then $f(u^{-}) < f(u^{+})$, so $F_{G} = f(u^{+}) = \\max(f(u^{-}), f(u^{+}))$.\nSince $f(u)=u^2/2$ is convex, its maximum on an interval $[u^{+}, u^{-}]$ must occur at an endpoint. Thus, for $u^{-} > u^{+}$,\n$$\nF_{G}(u^{-},u^{+}) = \\max(f(u^{-}), f(u^{+}))\n$$\n\n**Explicit Analytic Expression for $F_{G}(u^{-},u^{+})$**\nCombining all cases, we arrive at the explicit piecewise definition of the Godunov flux for Burgers' equation:\n$$\nF_{G}(u^{-},u^{+}) = \\begin{cases} \\max\\left(\\frac{(u^{-})^2}{2}, \\frac{(u^{+})^2}{2}\\right) & \\text{if } u^{-} > u^{+} \\\\ \\frac{(u^{-})^2}{2} & \\text{if } 0 \\le u^{-} \\le u^{+} \\\\ 0 & \\text{if } u^{-} < 0 < u^{+} \\\\ \\frac{(u^{+})^2}{2} & \\text{if } u^{-} \\le u^{+} \\le 0 \\end{cases}\n$$\nNote that the case $u^{-}=u^{+}$ is consistent, as $F_G(u,u) = f(u)$.\n\n**Part 2: Entropy Stability and Scheme Stabilization**\n\nThe use of the Godunov flux in a DG scheme ensures that a discrete version of the entropy inequality is satisfied, thereby guaranteeing the nonlinear stability of the semi-discrete scheme.\n\nFor a convex entropy function $U(u)$ and corresponding entropy flux $Q(u)$ (where $Q'(u) = U'(u)f'(u)$), the continuous entropy inequality is $U(u)_t + Q(u)_x \\le 0$. For Burgers' equation, the quadratic entropy is $U(u) = u^2/2$, for which $U'(u)=u$ and the entropy flux is $Q(u) = u^3/3$.\n\nIn a DG scheme, summing the local weak formulation over all elements and choosing the test function $v_h = U'(u_h) = u_h$ leads to an evolution equation for the total entropy $\\mathcal{E}(t) = \\int_{\\Omega} U(u_h) dx$. The rate of change of total entropy is determined by the sum of contributions from each inter-element interface. The contribution from the interface between states $u^{-}$ and $u^{+}$ is the numerical entropy dissipation:\n$$\n\\mathcal{D}(u^{-}, u^{+}) = F_G(u^{-}, u^{+}) [U'] - [Q] = F_G(u^{-}, u^{+})(u^{+} - u^{-}) - \\left(\\frac{(u^{+})^3}{3} - \\frac{(u^{-})^3}{3}\\right)\n$$\nThe semi-discrete scheme is entropy stable if this term is non-positive, i.e., $\\mathcal{D}(u^{-}, u^{+}) \\le 0$, at every interface. This would imply $\\frac{d\\mathcal{E}}{dt} \\le 0$.\n\nThe Godunov flux is an \"E-flux,\" a class of numerical fluxes known to be entropy-satisfying. An E-flux satisfies the property that $(u^{-} - u^{+})(F_G(u^{-},u^{+}) - f(u)) \\ge 0$ for all values of $u$ on the path between $u^{-}$ and $u^{+}$. As shown in Part 1, the Godunov flux for Burgers' equation is $F_G = \\max f$ for shocks ($u^{-}>u^{+}$) and $F_G = \\min f$ for rarefactions ($u^{-}<u^{+}$), which directly satisfies this condition. This property is sufficient to prove that $\\mathcal{D}(u^{-}, u^{+}) \\le 0$.\n\nThis dissipation mechanism is what stabilizes the scheme. Inter-element jumps $[u] = u^+ - u^-$ are sources of potential instability, especially for under-resolved shocks which manifest as oscillations. The Godunov flux introduces a precise amount of numerical dissipation—no more and no less than what is present in the exact solution of the local Riemann problem.\n- For a rarefaction ($u^{-}<u^{+}$), the exact solution is smooth and entropy is conserved. The Godunov flux is constructed to yield zero numerical entropy dissipation in this case (apart from spatial discretization errors within the element).\n- For a shock ($u^{-}>u^{+}$), the exact solution is discontinuous and produces entropy. The Godunov flux mimics this physical dissipation by satisfying $\\mathcal{D}(u^{-}, u^{+}) < 0$, effectively damping oscillations that would arise from the jump and ensuring the correct shock propagation.\n\nIn conclusion, the Godunov flux stabilizes the DG scheme by building in the physical mechanism of entropy production at discontinuities, preventing the growth of non-physical oscillations and ensuring the solution converges to the weak, entropy-satisfying solution of the PDE.", "answer": "$$\n\\boxed{F_{G}(u^{-},u^{+}) = \\begin{cases} \\max\\left(\\frac{(u^{-})^2}{2}, \\frac{(u^{+})^2}{2}\\right) & \\text{if } u^{-} > u^{+} \\\\ \\frac{(u^{-})^2}{2} & \\text{if } 0 \\le u^{-} \\le u^{+} \\\\ 0 & \\text{if } u^{-} < 0 < u^{+} \\\\ \\frac{(u^{+})^2}{2} & \\text{if } u^{-} \\le u^{+} \\le 0 \\end{cases}}\n$$", "id": "3401198"}, {"introduction": "The choice of numerical flux critically determines the stability and accuracy of a DG scheme. This practice guides you through a semi-discrete energy analysis for the linear advection equation, comparing the effects of central, upwind, and Lax-Friedrichs fluxes [@problem_id:3377133]. By deriving the evolution of the $L^2$ energy, you will gain a rigorous understanding of numerical dissipation and discover the precise conditions under which a scheme is stable, providing essential skills for analyzing and developing numerical methods.", "problem": "Consider the constant-coefficient scalar conservation law $u_{t} + a \\, u_{x} = 0$ on the periodic domain $\\Omega = [0,1]$, with a uniform partition into $N$ closed intervals $\\{K_{j}\\}_{j=1}^{N}$, each mapped affinely to the reference interval $[-1,1]$. Let $p \\ge 1$ be a fixed polynomial degree, and let $u_{h}$ be the semi-discrete Discontinuous Galerkin (DG) approximation in the broken polynomial space $\\mathbb{P}^{p}(K_{1}) \\oplus \\cdots \\oplus \\mathbb{P}^{p}(K_{N})$. Compare two DG formulations:\n- a nodal formulation using Gauss–Lobatto points and quadrature, and\n- a modal formulation using the Legendre polynomial basis with exact integration.\n\nFor each formulation, use the DG weak form obtained from integrating by parts on each element and replacing the physical flux at element interfaces by a numerical flux. Assume exact quadrature of the polynomial terms so that any discrete Summation-By-Parts (SBP) identities that hold for the chosen discretization are realized at the discrete level. Consider the following interface numerical fluxes:\n- the central flux $\\widehat{f}_{\\mathrm{c}}(u^{-},u^{+}) = a \\,\\{\\!\\{u\\}\\!\\}$,\n- the upwind flux $\\widehat{f}_{\\mathrm{u}}(u^{-},u^{+}) = a \\, u^{-}$ for $a>0$ and $\\widehat{f}_{\\mathrm{u}}(u^{-},u^{+}) = a \\, u^{+}$ for $a<0$,\n- the Lax–Friedrichs flux $\\widehat{f}_{\\mathrm{LF}}(u^{-},u^{+}) = a \\,\\{\\!\\{u\\}\\!\\} - \\tfrac{\\alpha}{2}\\,[u]$, with a parameter $\\alpha \\ge |a|$.\n\nHere, the jump and average are given by $[u] = u^{+} - u^{-}$ and $\\{\\!\\{u\\}\\!\\} = \\tfrac{1}{2}(u^{-}+u^{+})$. Let $\\|\\cdot\\|_{L^{2}(\\Omega)}$ denote the $L^{2}$ norm on the periodic domain.\n\nStarting from the DG weak form and the definitions above, derive the semi-discrete $L^{2}$ energy evolution formula $\\tfrac{d}{dt}\\|u_{h}\\|_{L^{2}(\\Omega)}^{2}$ for each numerical flux and for both the nodal Gauss–Lobatto and modal Legendre formulations. Use only fundamental identities such as integration by parts and the SBP property in the discrete setting and do not assume any pre-derived DG energy identities. Identify conditions under which the central flux is stable (energy non-increasing or conserved) or unstable for $p \\ge 1$, explicitly stating any assumptions on boundary conditions, quadrature exactness, and mesh uniformity that are necessary for the conclusions.\n\nFinally, under the periodic setting described, report the single analytic value of the semi-discrete $L^{2}$ energy time derivative $\\tfrac{d}{dt}\\|u_{h}\\|_{L^{2}(\\Omega)}^{2}$ when the central flux is used. No rounding is required.", "solution": "The problem asks for an analysis of the semi-discrete $L^2$ energy evolution of the Discontinuous Galerkin (DG) method for the scalar advection equation $u_{t} + a \\, u_{x} = 0$. We will derive the energy evolution formula and analyze it for three different numerical fluxes. The analysis will apply to both a nodal Gauss-Lobatto formulation and a modal Legendre formulation under the given assumptions.\n\nLet the domain $\\Omega = [0,1]$ be partitioned into $N$ elements $K_j = [x_{j-1/2}, x_{j+1/2}]$ of size $h_j = x_{j+1/2} - x_{j-1/2}$. The DG approximation $u_h$ belongs to the broken polynomial space $V_h = \\{ v \\in L^2(\\Omega) : v|_{K_j} \\in \\mathbb{P}^p(K_j) \\text{ for } j=1, \\dots, N \\}$. The semi-discrete DG formulation for the conservation law is found by multiplying by a test function $v_h \\in V_h$, integrating over an element $K_j$, and applying integration by parts to the spatial flux term:\n$$\n\\int_{K_j} \\frac{\\partial u_h}{\\partial t} v_h \\, dx - \\int_{K_j} a u_h \\frac{\\partial v_h}{\\partial x} \\, dx + \\left[ a u_h v_h \\right]_{\\partial K_j} = 0\n$$\nThe boundary term $\\left[ a u_h v_h \\right]_{\\partial K_j}$ evaluates to $a u_h(x_{j+1/2}^-)v_h(x_{j+1/2}^-) - a u_h(x_{j-1/2}^+)v_h(x_{j-1/2}^+)$. To couple the elements, the physical flux $a u_h$ at interfaces is replaced by a single-valued numerical flux $\\widehat{f}(u^-, u^+)$, where $u^-$ and $u^+$ are the states on the left and right of the interface, respectively. The standard DG weak form becomes:\n$$\n\\int_{K_j} \\frac{\\partial u_h}{\\partial t} v_h \\, dx - \\int_{K_j} a u_h \\frac{\\partial v_h}{\\partial x} \\, dx + \\widehat{f}_{j+1/2} v_h(x_{j+1/2}^-) - \\widehat{f}_{j-1/2} v_h(x_{j-1/2}^+) = 0\n$$\nwhere $\\widehat{f}_{j \\pm 1/2} = \\widehat{f}(u_h(x_{j \\pm 1/2}^-), u_h(x_{j \\pm 1/2}^+))$. This must hold for all $v_h \\in \\mathbb{P}^p(K_j)$ and for all elements $K_j$, $j=1, \\dots, N$.\n\nTo derive the $L^2$ energy evolution, we set the test function $v_h = u_h$. The time derivative of the squared $L^2$ norm is given by:\n$$\n\\frac{d}{dt} \\|u_h\\|_{L^2(\\Omega)}^2 = \\frac{d}{dt} \\sum_{j=1}^{N} \\int_{K_j} u_h^2 \\, dx = \\sum_{j=1}^{N} \\int_{K_j} 2 u_h \\frac{\\partial u_h}{\\partial t} \\, dx\n$$\nFrom the weak form with $v_h = u_h$, we have:\n$$\n\\int_{K_j} u_h \\frac{\\partial u_h}{\\partial t} \\, dx = \\int_{K_j} a u_h \\frac{\\partial u_h}{\\partial x} \\, dx - \\widehat{f}_{j+1/2} u_h(x_{j+1/2}^-) + \\widehat{f}_{j-1/2} u_h(x_{j-1/2}^+)\n$$\nThe first term on the right-hand side can be exactly integrated: $\\int_{K_j} a u_h \\frac{\\partial u_h}{\\partial x} \\, dx = \\int_{K_j} \\frac{a}{2} \\frac{\\partial}{\\partial x}(u_h^2) \\, dx = \\frac{a}{2} \\left[ u_h^2 \\right]_{x_{j-1/2}^+}^{x_{j+1/2}^-} = \\frac{a}{2} \\left( (u_h(x_{j+1/2}^-))^2 - (u_h(x_{j-1/2}^+))^2 \\right)$. This step is critical. For the modal formulation with the Legendre basis and exact integration, this identity holds. For the nodal formulation with Gauss-Lobatto quadrature, the integrand $u_h \\frac{\\partial u_h}{\\partial x}$ is a polynomial of degree at most $p + (p-1) = 2p-1$. A $(p+1)$-point Gauss-Lobatto quadrature rule is exact for polynomials of degree up to $2p-1$. Furthermore, such nodal discretizations possess a Summation-By-Parts (SBP) property which ensures that the discrete analog of integration by parts holds exactly. The problem statement guarantees this condition is met for both formulations.\n\nSubstituting this result and multiplying by $2$, we get the energy evolution on a single element:\n$$\n\\frac{d}{dt} \\int_{K_j} u_h^2 \\, dx = a \\left( (u_h(x_{j+1/2}^-))^2 - (u_h(x_{j-1/2}^+))^2 \\right) - 2 \\widehat{f}_{j+1/2} u_h(x_{j+1/2}^-) + 2 \\widehat{f}_{j-1/2} u_h(x_{j-1/2}^+)\n$$\nNow, we sum over all elements $j=1, \\dots, N$. The terms on the right-hand side are boundary terms that couple adjacent elements. We can rearrange the sum over elements into a sum over interfaces. For a generic interface at $x_{k+1/2}$ between elements $K_k$ and $K_{k+1}$, its total contribution comes from the terms at $x_{k+1/2}$ from element $K_k$ and the terms at $x_{(k+1)-1/2}=x_{k+1/2}$ from element $K_{k+1}$:\n\\begin{itemize}\n    \\item From $K_k$: $a (u_h(x_{k+1/2}^-))^2 - 2 \\widehat{f}_{k+1/2} u_h(x_{k+1/2}^-)$.\n    \\item From $K_{k+1}$: $-a (u_h(x_{k+1/2}^+))^2 + 2 \\widehat{f}_{k+1/2} u_h(x_{k+1/2}^+)$.\n\\end{itemize}\nSumming these gives the total contribution from the interface at $x_{k+1/2}$:\n$$\na \\left( (u_h^-)^2 - (u_h^+)^2 \\right) - 2 \\widehat{f} (u_h^- - u_h^+)\n$$\nwhere for brevity we denote $u_h^\\pm = u_h(x_{k+1/2}^\\pm)$ and $\\widehat{f} = \\widehat{f}_{k+1/2}$. Using the jump $[u_h] = u_h^+ - u_h^-$ and average $\\{\\!\\{u_h\\}\\!\\} = \\frac{1}{2}(u_h^- + u_h^+)$, we can rewrite this as:\n$$\na(u_h^- - u_h^+)(u_h^- + u_h^+) + 2\\widehat{f}(u_h^+ - u_h^-) = a(-[u_h])(2\\{\\!\\{u_h\\}\\!\\}) + 2\\widehat{f}[u_h] = 2(\\widehat{f} - a\\{\\!\\{u_h\\}\\!\\})[u_h]\n$$\nThe periodic boundary conditions ensure that every interface is an interior one, so we sum this contribution over all $N$ interfaces:\n$$\n\\frac{d}{dt} \\|u_h\\|_{L^2(\\Omega)}^2 = \\sum_{\\text{interfaces}} 2(\\widehat{f} - a\\{\\!\\{u_h\\}\\!\\})[u_h]\n$$\nThis is the general semi-discrete $L^2$ energy evolution formula. Now we analyze it for each numerical flux.\n\n1.  **Central flux**: $\\widehat{f}_{\\mathrm{c}}(u^{-},u^{+}) = a \\,\\{\\!\\{u\\}\\!\\} = \\frac{a}{2}(u^{-} + u^{+})$.\n    Substituting this into the energy evolution formula:\n    $$ \\frac{d}{dt} \\|u_h\\|_{L^2(\\Omega)}^2 = \\sum_{\\text{interfaces}} 2(a\\{\\!\\{u_h\\}\\!\\} - a\\{\\!\\{u_h\\}\\!\\})[u_h] = \\sum_{\\text{interfaces}} 0 = 0 $$\n    The energy is conserved exactly at the semi-discrete level.\n\n2.  **Upwind flux**: $\\widehat{f}_{\\mathrm{u}} = a \\, u^{-}$ for $a>0$ and $\\widehat{f}_{\\mathrm{u}} = a \\, u^{+}$ for $a<0$. This can be written compactly as $\\widehat{f}_{\\mathrm{u}} = a\\{\\!\\{u\\}\\!\\} - \\frac{|a|}{2}[u]$.\n    Let's analyze the term $(\\widehat{f}_{\\mathrm{u}} - a\\{\\!\\{u_h\\}\\!\\})$:\n    $$ \\widehat{f}_{\\mathrm{u}} - a\\{\\!\\{u_h\\}\\!\\} = \\left(a\\{\\!\\{u_h\\}\\!\\} - \\frac{|a|}{2}[u_h]\\right) - a\\{\\!\\{u_h\\}\\!\\} = -\\frac{|a|}{2}[u_h] $$\n    Thus, the energy evolution is:\n    $$ \\frac{d}{dt} \\|u_h\\|_{L^2(\\Omega)}^2 = \\sum_{\\text{interfaces}} 2\\left(-\\frac{|a|}{2}[u_h]\\right)[u_h] = -\\sum_{\\text{interfaces}} |a|[u_h]^2 $$\n    Since $|a| \\ge 0$ and $[u_h]^2 \\ge 0$, the energy is non-increasing. The scheme is dissipative.\n\n3.  **Lax–Friedrichs flux**: $\\widehat{f}_{\\mathrm{LF}} = a \\,\\{\\!\\{u\\}\\!\\} - \\tfrac{\\alpha}{2}\\,[u]$ with $\\alpha \\ge |a|$.\n    The term $(\\widehat{f}_{\\mathrm{LF}} - a\\{\\!\\{u_h\\}\\!\\})$ is:\n    $$ \\widehat{f}_{\\mathrm{LF}} - a\\{\\!\\{u_h\\}\\!\\} = \\left( a\\{\\!\\{u_h\\}\\!\\} - \\frac{\\alpha}{2}[u_h] \\right) - a\\{\\!\\{u_h\\}\\!\\} = -\\frac{\\alpha}{2}[u_h] $$\n    The energy evolution is:\n    $$ \\frac{d}{dt} \\|u_h\\|_{L^2(\\Omega)}^2 = \\sum_{\\text{interfaces}} 2\\left(-\\frac{\\alpha}{2}[u_h]\\right)[u_h] = -\\sum_{\\text{interfaces}} \\alpha[u_h]^2 $$\n    Given that $\\alpha \\ge |a| \\ge 0$, the energy is non-increasing, and the scheme is dissipative.\n\nRegarding the central flux, the analysis shows that $\\frac{d}{dt} \\|u_h\\|_{L^2(\\Omega)}^2 = 0$. This implies that $\\|u_h(t)\\|_{L^2(\\Omega)} = \\|u_h(0)\\|_{L^2(\\Omega)}$ for all time $t$. This is the definition of stability in the $L^2$ norm (specifically, neutral stability or energy conservation). The scheme is therefore stable. This conclusion holds for any polynomial degree $p \\ge 1$. The crucial conditions for this result are:\n\\begin{itemize}\n    \\item The problem is the linear advection equation.\n    \\item The boundary conditions are periodic.\n    \\item The discrete volume integral term satisfies the property that $\\sum_j \\int_{K_j} a u_h (\\partial_x u_h) \\, dx = \\sum_{\\text{interfaces}} \\frac{a}{2}((u_h^-)^2 - (u_h^+)^2)$, which is guaranteed by the problem's assumption about exact/SBP quadrature for both the specified nodal and modal formulations.\n\\end{itemize}\nUnder these standard DG analysis conditions, the central flux is never unstable in the sense of $L^2$ energy growth. While in practice, the lack of dissipation can allow for the growth of aliasing errors or other unphysical oscillations not captured by this energy analysis, the semi-discretization itself is proven to be energy-conserving.\n\nFinally, the problem asks for the single analytic value of the semi-discrete $L^2$ energy time derivative when the central flux is used. As derived above, this value is zero.", "answer": "$$\\boxed{0}$$", "id": "3377133"}, {"introduction": "Accurately capturing the dynamics of discontinuities is a central challenge in computational fluid dynamics. This hands-on problem addresses the common issue of inaccurate shock speed prediction in under-resolved DG simulations [@problem_id:3377131]. You will implement a subcell reconstruction technique to obtain more robust estimates of the states across a shock, providing a practical demonstration of how local solution-aware corrections can dramatically improve the physical fidelity of a numerical method.", "problem": "Consider the one-dimensional scalar conservation law $u_t + (f(u))_x = 0$ and its weak solution containing a single shock separating two constant plateau states $u_L^\\star$ (left) and $u_R^\\star$ (right). The Rankine–Hugoniot condition gives the shock speed $s^\\star = \\dfrac{f(u_R^\\star) - f(u_L^\\star)}{u_R^\\star - u_L^\\star}$. In a Discontinuous Galerkin (DG) method, the numerical solution in each cell is represented by a polynomial of degree $p$ in Legendre modal form on the reference interval $\\xi \\in [-1,1]$, $u_h(\\xi) = \\sum_{k=0}^p a_k P_k(\\xi)$, where $P_k$ is the $k$-th Legendre polynomial and $a_k$ are the modal coefficients. At a cell interface, the DG solution provides one-sided polynomial traces, which can be used to form a numerical estimate of the shock speed by inserting these traces into the Rankine–Hugoniot formula.\n\nYour task is to derive, implement, and test a correction for under-resolved shocks that improves the shock speed estimate by locally reconstructing plateau states using subcell averages near the interface. Begin from the integral form of conservation and the definition of Rankine–Hugoniot, and then derive an algorithm that replaces the pointwise DG interface traces with local subcell averages over small intervals adjacent to the interface on each side. Use the following principles and requirements.\n\n- Start from the integral conservation statement across a moving discontinuity and the Rankine–Hugoniot condition. The numerical DG state at the interface is given by the one-sided polynomial trace $u_h(\\pm 1)$. Use these traces in the Rankine–Hugoniot formula to define a baseline DG shock speed estimate $s_{\\mathrm{DG}}$.\n- Define a local subcell reconstruction as follows. For a given integer $M \\ge 1$, let the subcell width in reference coordinates be $\\Delta \\xi = \\dfrac{2}{M}$. On the left cell, define the left reconstructed state as the subcell average near the right interface,\n  $$ \\bar{u}_L^{\\mathrm{sub}} = \\frac{1}{\\Delta \\xi} \\int_{1 - \\Delta \\xi}^{1} u_h^{(L)}(\\xi)\\, d\\xi, $$\n  and on the right cell, define the right reconstructed state near the left interface,\n  $$ \\bar{u}_R^{\\mathrm{sub}} = \\frac{1}{\\Delta \\xi} \\int_{-1}^{-1 + \\Delta \\xi} u_h^{(R)}(\\xi)\\, d\\xi. $$\n  Use these reconstructed subcell averages $\\bar{u}_L^{\\mathrm{sub}}$ and $\\bar{u}_R^{\\mathrm{sub}}$ as corrected plateau state estimates in a corrected Rankine–Hugoniot shock speed $s_{\\mathrm{corr}} = \\dfrac{f(\\bar{u}_R^{\\mathrm{sub}}) - f(\\bar{u}_L^{\\mathrm{sub}})}{\\bar{u}_R^{\\mathrm{sub}} - \\bar{u}_L^{\\mathrm{sub}}}$.\n- Your program must implement the above baseline and corrected shock speed estimates. The Legendre polynomials must be taken as the standard polynomials $P_0(\\xi) = 1$, $P_1(\\xi) = \\xi$, $P_2(\\xi) = \\dfrac{1}{2}(3\\xi^2 - 1)$, etc. The interface traces are evaluated at $\\xi = 1$ (right side of the left cell) and $\\xi = -1$ (left side of the right cell). The subcell averages must be computed by numerical quadrature that is exact for polynomials of degree at least $p$; use Gaussian–Legendre quadrature mapped to the subintervals to evaluate the integrals defining $\\bar{u}_L^{\\mathrm{sub}}$ and $\\bar{u}_R^{\\mathrm{sub}}$.\n- For each test case, compute the exact shock speed $s^\\star = \\dfrac{f(u_R^\\star) - f(u_L^\\star)}{u_R^\\star - u_L^\\star}$ from the given plateau states $u_L^\\star$ and $u_R^\\star$. Then compute the absolute baseline error $E_{\\mathrm{DG}} = |s_{\\mathrm{DG}} - s^\\star|$ and the absolute corrected error $E_{\\mathrm{corr}} = |s_{\\mathrm{corr}} - s^\\star|$. Report, for each test, the improvement $I = E_{\\mathrm{DG}} - E_{\\mathrm{corr}}$ as a single floating-point number, where a positive value indicates that the correction improved the estimate.\n\nUse the following test suite. In all cases, use polynomial degree $p = 2$ and subcell count $M = 4$.\n\n- Test $1$ (convex quadratic flux, under-resolved jump):\n  - Flux: $f(u) = \\dfrac{1}{2} u^2$.\n  - True plateau states: $u_L^\\star = 2.0$, $u_R^\\star = 0.0$.\n  - Left cell coefficients: $\\boldsymbol{a}^{(L)} = [1.95,\\,-0.08,\\,0.03]$.\n  - Right cell coefficients: $\\boldsymbol{a}^{(R)} = [0.10,\\,0.12,\\,0.03]$.\n- Test $2$ (linear flux edge case, constant signal speed):\n  - Flux: $f(u) = a\\, u$ with $a = 1.3$.\n  - True plateau states: $u_L^\\star = 1.0$, $u_R^\\star = 0.0$.\n  - Left cell coefficients: $\\boldsymbol{a}^{(L)} = [0.90,\\,0.20,\\,-0.05]$.\n  - Right cell coefficients: $\\boldsymbol{a}^{(R)} = [0.10,\\,0.00,\\,0.00]$.\n- Test $3$ (convex cubic flux, asymmetric bias):\n  - Flux: $f(u) = \\dfrac{1}{3} u^3$.\n  - True plateau states: $u_L^\\star = 1.5$, $u_R^\\star = -0.5$.\n  - Left cell coefficients: $\\boldsymbol{a}^{(L)} = [1.55,\\,-0.08,\\,0.00]$.\n  - Right cell coefficients: $\\boldsymbol{a}^{(R)} = [-0.48,\\,0.03,\\,0.00]$.\n\nImplementation details and output specification:\n\n- Represent each cell polynomial as $u_h(\\xi) = \\sum_{k=0}^{2} a_k P_k(\\xi)$, with the given modal coefficients $a_k$ in the standard Legendre basis on $[-1,1]$.\n- Compute the one-sided DG interface traces using evaluation at $\\xi = 1$ (for the left cell) and $\\xi = -1$ (for the right cell).\n- Compute subcell averages using Gaussian–Legendre quadrature of sufficient order mapped to the subintervals $[1 - \\Delta \\xi, 1]$ and $[-1, -1 + \\Delta \\xi]$ with $\\Delta \\xi = \\dfrac{2}{M}$.\n- For each test case, output the improvement $I = E_{\\mathrm{DG}} - E_{\\mathrm{corr}}$ rounded to six decimal places.\n- Final output format: Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[$0.012345$, $0.000000$, $0.004200$]\") in the order of Tests $1$–$3$.\n\nAll answers are purely numerical; no physical units or angles are required in this problem. Ensure that every mathematical entity in this problem statement is written in LaTeX using $...$ delimiters.", "solution": "The problem requires the derivation and implementation of a corrected shock speed estimate for a Discontinuous Galerkin (DG) numerical method applied to a one-dimensional scalar conservation law, $u_t + (f(u))_x = 0$. The correction is based on local subcell averaging to better approximate the plateau states on either side of a shock discontinuity.\n\nThe analysis begins with the integral form of the conservation law over a spacetime rectangle $[x_L, x_R] \\times [t_1, t_2]$ containing a shock propagating with speed $s$. This leads to the Rankine–Hugoniot condition for the exact shock speed $s^\\star$:\n$$\ns^\\star = \\frac{f(u_R^\\star) - f(u_L^\\star)}{u_R^\\star - u_L^\\star} = \\frac{[f(u)]}{[u]}\n$$\nwhere $u_L^\\star$ and $u_R^\\star$ are the constant states to the left and right of the shock, respectively, and $[ \\cdot ]$ denotes the jump in a quantity across the discontinuity.\n\nIn a DG framework, the numerical solution within each computational cell is represented by a polynomial. For this problem, the polynomial is of degree $p$ on the reference interval $\\xi \\in [-1, 1]$, expressed in a Legendre modal basis:\n$$\nu_h(\\xi) = \\sum_{k=0}^p a_k P_k(\\xi)\n$$\nwhere $P_k(\\xi)$ is the $k$-th Legendre polynomial and $a_k$ are the modal coefficients. The given degree is $p=2$, so the relevant polynomials are:\n$$\nP_0(\\xi) = 1, \\quad P_1(\\xi) = \\xi, \\quad P_2(\\xi) = \\frac{1}{2}(3\\xi^2 - 1)\n$$\nThe solution in a given cell is thus explicit: $u_h(\\xi) = a_0 + a_1 \\xi + a_2 \\frac{1}{2}(3\\xi^2 - 1)$.\n\nA baseline numerical estimate for the shock speed, $s_{\\mathrm{DG}}$, can be formed by substituting the one-sided traces of the DG solution at the cell interface directly into the Rankine–Hugoniot formula. Let the interface be between a \"left\" cell and a \"right\" cell. The right boundary of the left cell corresponds to $\\xi=1$, and the left boundary of the right cell corresponds to $\\xi=-1$. The one-sided traces are:\n$$\nu_L = u_h^{(L)}(\\xi=1) = a_0^{(L)} P_0(1) + a_1^{(L)} P_1(1) + a_2^{(L)} P_2(1) = a_0^{(L)} + a_1^{(L)} + a_2^{(L)}\n$$\n$$\nu_R = u_h^{(R)}(\\xi=-1) = a_0^{(R)} P_0(-1) + a_1^{(R)} P_1(-1) + a_2^{(R)} P_2(-1) = a_0^{(R)} - a_1^{(R)} + a_2^{(R)}\n$$\nThe baseline shock speed estimate is then:\n$$\ns_{\\mathrm{DG}} = \\frac{f(u_R) - f(u_L)}{u_R - u_L}\n$$\n\nFor under-resolved shocks, the polynomial oscillations near the discontinuity (Gibbs phenomenon) can make the pointwise traces $u_L$ and $u_R$ poor approximations of the true plateau states $u_L^\\star$ and $u_R^\\star$. The proposed correction aims to mitigate this by using local averages as more robust estimates of the plateau states.\n\nA subcell reconstruction defines corrected states $\\bar{u}_L^{\\mathrm{sub}}$ and $\\bar{u}_R^{\\mathrm{sub}}$ by averaging the DG polynomial over small sub-intervals adjacent to the interface. Given a subcell count $M$, the width of the sub-interval in reference coordinates is $\\Delta\\xi = 2/M$. The corrected states are defined as:\n$$\n\\bar{u}_L^{\\mathrm{sub}} = \\frac{1}{\\Delta \\xi} \\int_{1 - \\Delta \\xi}^{1} u_h^{(L)}(\\xi)\\, d\\xi\n$$\n$$\n\\bar{u}_R^{\\mathrm{sub}} = \\frac{1}{\\Delta \\xi} \\int_{-1}^{-1 + \\Delta \\xi} u_h^{(R)}(\\xi)\\, d\\xi\n$$\nUsing these averaged states, a corrected shock speed estimate, $s_{\\mathrm{corr}}$, is formulated:\n$$\ns_{\\mathrm{corr}} = \\frac{f(\\bar{u}_R^{\\mathrm{sub}}) - f(\\bar{u}_L^{\\mathrm{sub}})}{\\bar{u}_R^{\\mathrm{sub}} - \\bar{u}_L^{\\mathrm{sub}}}\n$$\n\nTo compute the integrals for $\\bar{u}_L^{\\mathrm{sub}}$ and $\\bar{u}_R^{\\mathrm{sub}}$, we employ Gaussian-Legendre quadrature, which is required to be exact for polynomials of degree at least $p=2$. An $N$-point Gauss-Legendre quadrature rule is exact for polynomials of degree up to $2N-1$. For our integrand of degree $p=2$, we need $2N-1 \\ge 2$, which implies $N \\ge 1.5$. Thus, a $2$-point quadrature rule ($N=2$, exact up to degree $3$) is sufficient.\n\nTo evaluate an integral $\\int_a^b g(\\xi) d\\xi$ using an $N$-point Gauss-Legendre rule, we map the interval $[a, b]$ to the reference quadrature interval $[-1, 1]$ using the transformation $\\xi(\\eta) = \\frac{b-a}{2}\\eta + \\frac{a+b}{2}$. The integral is then approximated as:\n$$\n\\int_a^b g(\\xi) d\\xi = \\frac{b-a}{2} \\int_{-1}^1 g(\\xi(\\eta)) d\\eta \\approx \\frac{b-a}{2} \\sum_{i=1}^N w_i g(\\xi(\\eta_i))\n$$\nwhere $(\\eta_i, w_i)$ are the standard Gauss-Legendre nodes and weights on $[-1, 1]$.\n\nFor the given parameters $p=2$ and $M=4$, we have $\\Delta\\xi = 2/4 = 0.5$.\nThe integration interval for $\\bar{u}_L^{\\mathrm{sub}}$ is $[1 - 0.5, 1] = [0.5, 1]$.\nThe integration interval for $\\bar{u}_R^{\\mathrm{sub}}$ is $[-1, -1 + 0.5] = [-1, -0.5]$.\n\nThe final task is to calculate the improvement $I = E_{\\mathrm{DG}} - E_{\\mathrm{corr}}$ for each test case, where the errors are defined as $E_{\\mathrm{DG}} = |s_{\\mathrm{DG}} - s^\\star|$ and $E_{\\mathrm{corr}} = |s_{\\mathrm{corr}} - s^\\star|$. A positive value of $I$ indicates that the subcell correction improved the shock speed estimate.\n\nThe algorithm for each test case is as follows:\n1.  Given the true plateau states $u_L^\\star$ and $u_R^\\star$ and the flux function $f(u)$, calculate the exact shock speed $s^\\star$.\n2.  Given the modal coefficients $\\boldsymbol{a}^{(L)}$ and $\\boldsymbol{a}^{(R)}$, calculate the interface traces $u_L = u_h^{(L)}(1)$ and $u_R = u_h^{(R)}(-1)$.\n3.  Compute the baseline shock speed $s_{\\mathrm{DG}} = (f(u_R) - f(u_L))/(u_R - u_L)$.\n4.  Set up the $2$-point Gauss-Legendre quadrature for the sub-intervals $[0.5, 1]$ and $[-1, -0.5]$.\n5.  Evaluate the average values $\\bar{u}_L^{\\mathrm{sub}}$ and $\\bar{u}_R^{\\mathrm{sub}}$ using the quadrature rule.\n6.  Compute the corrected shock speed $s_{\\mathrm{corr}} = (f(\\bar{u}_R^{\\mathrm{sub}}) - f(\\bar{u}_L^{\\mathrm{sub}}))/(\\bar{u}_R^{\\mathrm{sub}} - \\bar{u}_L^{\\mathrm{sub}})$.\n7.  Calculate the absolute errors $E_{\\mathrm{DG}}$ and $E_{\\mathrm{corr}}$.\n8.  Compute the improvement $I = E_{\\mathrm{DG}} - E_{\\mathrm{corr}}$.\nThis procedure is applied to all specified test cases. For the linear flux case $f(u) = au$, the Rankine-Hugoniot speed is always $s=a$, provided the states on either side of the shock are not equal. This serves as a useful analytical check on the implementation.", "answer": "$$\\boxed{[0.044994,0.000000,0.003920]}$$", "id": "3377131"}]}