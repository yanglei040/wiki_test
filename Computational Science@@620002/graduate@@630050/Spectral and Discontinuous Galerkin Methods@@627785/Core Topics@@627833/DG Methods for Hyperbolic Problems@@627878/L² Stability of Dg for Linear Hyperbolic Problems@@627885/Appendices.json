{"hands_on_practices": [{"introduction": "To build a robust numerical method, we must first understand potential failures. This practice explores a seemingly natural choice for a Discontinuous Galerkin scheme: the central numerical flux. By performing a von Neumann stability analysis, you will discover that this intuitive choice, when paired with a simple forward Euler time-stepping method, leads to unconditional instability, causing the discrete energy of the solution to grow without bound. This foundational exercise [@problem_id:3394374] highlights the critical role of the numerical flux in ensuring the $L^2$ stability of the scheme.", "problem": "Consider the linear advection equation $u_{t} + a\\,u_{x} = 0$ with constant wave speed $a \\in \\mathbb{R}\\setminus\\{0\\}$ on the periodic domain $x \\in [0,2\\pi]$. Discretize the domain into $N$ uniform cells of width $h = \\frac{2\\pi}{N}$, and approximate $u$ by a piecewise constant function on each cell (polynomial degree zero) using the Discontinuous Galerkin (DG) method. Employ the central numerical flux at interfaces, defined by $\\widehat{u} = \\frac{1}{2}\\left(u^{-} + u^{+}\\right)$, and advance in time with the forward Euler method with time step $\\Delta t > 0$. Define the discrete $L^{2}$ energy of a cellwise constant vector $(u_{j})_{j=0}^{N-1}$ by $E = h \\sum_{j=0}^{N-1} |u_{j}|^{2}$.\n\nStarting from the weak form with test function $v \\equiv 1$ on each cell and the flux balance at interfaces, derive the semi-discrete update for the cell averages and the corresponding forward Euler step. Then, consider the discrete Fourier mode $u_{j}^{n} = \\alpha^{n} \\exp\\!\\big(i\\,\\theta\\,j\\big)$ with $\\theta = \\frac{\\pi}{2}$ on the uniform grid, and determine the one-step amplification factor of the discrete $L^{2}$ energy, defined as the ratio $\\frac{E^{n+1}}{E^{n}}$ for this mode.\n\nProvide your final answer as a single closed-form expression in terms of $a$, $\\Delta t$, and $h$. No numerical evaluation is required.", "solution": "The problem is first validated to ensure it is scientifically grounded, well-posed, and objective.\nThe problem asks for the derivation of the one-step amplification factor for the discrete $L^2$ energy of a Discontinuous Galerkin (DG) scheme for the linear advection equation.\n\nGivens extracted from the problem statement:\n-   PDE: $u_{t} + a\\,u_{x} = 0$, where $a \\in \\mathbb{R}\\setminus\\{0\\}$ is a constant wave speed.\n-   Domain: $x \\in [0, 2\\pi]$, periodic.\n-   Discretization: $N$ uniform cells, $K_j = [x_{j-1/2}, x_{j+1/2}]$, of width $h = \\frac{2\\pi}{N}$.\n-   Approximation space: Piecewise constant functions on each cell (polynomial degree $p=0$). The solution in cell $K_j$ is denoted by the constant value $u_j$.\n-   Numerical flux: Central flux, $\\widehat{u} = \\frac{1}{2}\\left(u^{-} + u^{+}\\right)$, where $u^{-}$ and $u^{+}$ are the values at the interface from the left and right cells, respectively.\n-   Time integration: Forward Euler method with time step $\\Delta t > 0$.\n-   Test function: $v \\equiv 1$ on each cell.\n-   Discrete $L^2$ energy definition: $E = h \\sum_{j=0}^{N-1} |u_{j}|^{2}$.\n-   Fourier mode for analysis: $u_{j}^{n} = \\alpha^{n} \\exp\\!\\big(i\\,\\theta\\,j\\big)$ with wave number $\\theta = \\frac{\\pi}{2}$.\n-   Objective: Find the energy amplification factor $\\frac{E^{n+1}}{E^{n}}$ for this mode.\n\nThe problem is valid. It is a standard von Neumann stability analysis of a widely used numerical method (DG-P0) for a fundamental hyperbolic PDE. All components are clearly defined, and the question is self-contained and mathematically well-posed. There are no scientific flaws, ambiguities, or contradictions.\n\nWe proceed with the solution.\n\nFirst, we derive the semi-discrete scheme. We start with the PDE $u_{t} + a\\,u_{x} = 0$. We multiply by a test function $v$ and integrate over a cell $K_j = [x_{j-1/2}, x_{j+1/2}]$:\n$$\n\\int_{K_j} u_t v \\,dx + \\int_{K_j} a u_x v \\,dx = 0\n$$\nFor a piecewise constant approximation $u(x,t) = u_j(t)$ for $x \\in K_j$, and using the specified constant test function $v(x) = 1$ for $x \\in K_j$, the first term becomes:\n$$\n\\int_{K_j} \\frac{d u_j}{dt} (1) \\,dx = \\frac{d u_j}{dt} \\int_{K_j} dx = h \\frac{d u_j}{dt}\n$$\nThe second term is integrated by parts:\n$$\n\\int_{K_j} a u_x v \\,dx = a [u v]_{x_{j-1/2}}^{x_{j+1/2}} - a \\int_{K_j} u v_x \\,dx\n$$\nSince $v$ is constant on the cell, its derivative $v_x = 0$, so the integral on the right-hand side vanishes. The boundary term is evaluated using the numerical flux. The physical flux is $f(u) = au$. The numerical flux at an interface is $\\widehat{f} = a \\widehat{u}$. The integration by parts formula for the DG method is:\n$$\n\\int_{K_j} a u_x v \\,dx = a \\left( \\widehat{u}(x_{j+1/2}) v(x_{j+1/2}^-) - \\widehat{u}(x_{j-1/2}) v(x_{j-1/2}^+) \\right)\n$$\nwhere $v$ is evaluated from within the cell $K_j$, meaning $v(x_{j+1/2}^-) = v(x_{j-1/2}^+) = 1$. The numerical flux values are given by the central flux formula:\n-   At interface $x_{j+1/2}$: $\\widehat{u}_{j+1/2} = \\frac{1}{2}(u_j + u_{j+1})$.\n-   At interface $x_{j-1/2}$: $\\widehat{u}_{j-1/2} = \\frac{1}{2}(u_{j-1} + u_j)$.\nSubstituting these into the weak form, we get:\n$$\nh \\frac{d u_j}{dt} + a \\left( \\frac{u_j + u_{j+1}}{2} - \\frac{u_{j-1} + u_j}{2} \\right) = 0\n$$\nSimplifying the terms in the parenthesis gives:\n$$\nh \\frac{d u_j}{dt} + a \\left( \\frac{u_{j+1} - u_{j-1}}{2} \\right) = 0\n$$\nThis yields the semi-discrete ordinary differential equation for the cell average $u_j$:\n$$\n\\frac{d u_j}{dt} = - \\frac{a}{2h} (u_{j+1} - u_{j-1})\n$$\n\nNext, we apply the forward Euler method for time discretization: $\\frac{u_j^{n+1} - u_j^n}{\\Delta t} = \\frac{d u_j}{dt}\\Big|_n$.\n$$\n\\frac{u_j^{n+1} - u_j^n}{\\Delta t} = - \\frac{a}{2h} (u_{j+1}^n - u_{j-1}^n)\n$$\nThe fully discrete update rule is:\n$$\nu_j^{n+1} = u_j^n - \\frac{a \\Delta t}{2h} (u_{j+1}^n - u_{j-1}^n)\n$$\nLet $\\lambda = \\frac{a \\Delta t}{h}$ be the Courant number. The scheme is:\n$$\nu_j^{n+1} = u_j^n - \\frac{\\lambda}{2} (u_{j+1}^n - u_{j-1}^n)\n$$\nNow, we perform a von Neumann stability analysis by substituting the discrete Fourier mode $u_j^n = \\alpha^n \\exp(i \\theta j)$:\n$$\n\\alpha^{n+1} \\exp(i \\theta j) = \\alpha^n \\exp(i \\theta j) - \\frac{\\lambda}{2} \\left[ \\alpha^n \\exp(i \\theta (j+1)) - \\alpha^n \\exp(i \\theta (j-1)) \\right]\n$$\nWe divide by $\\alpha^n \\exp(i \\theta j)$:\n$$\n\\alpha = 1 - \\frac{\\lambda}{2} \\left[ \\exp(i \\theta) - \\exp(-i \\theta) \\right]\n$$\nUsing Euler's formula, $\\exp(i\\theta) - \\exp(-i\\theta) = 2i \\sin(\\theta)$, the amplification factor $\\alpha$ becomes:\n$$\n\\alpha = 1 - \\frac{\\lambda}{2} (2i \\sin(\\theta)) = 1 - i \\lambda \\sin(\\theta)\n$$\nThe problem asks for the one-step amplification factor of the discrete $L^2$ energy, $E^n = h \\sum_{j=0}^{N-1} |u_j^n|^2$.\nLet's compute the ratio $\\frac{E^{n+1}}{E^n}$.\n$$\nE^{n+1} = h \\sum_{j=0}^{N-1} |u_j^{n+1}|^2 = h \\sum_{j=0}^{N-1} |\\alpha u_j^n|^2 = h \\sum_{j=0}^{N-1} |\\alpha|^2 |u_j^n|^2 = |\\alpha|^2 \\left( h \\sum_{j=0}^{N-1} |u_j^n|^2 \\right) = |\\alpha|^2 E^n\n$$\nThus, the energy amplification factor is $\\frac{E^{n+1}}{E^n} = |\\alpha|^2$.\nWe now compute $|\\alpha|^2$:\n$$\n|\\alpha|^2 = \\alpha \\overline{\\alpha} = (1 - i \\lambda \\sin(\\theta))(1 + i \\lambda \\sin(\\theta)) = 1^2 - (i \\lambda \\sin(\\theta))^2 = 1 - i^2 \\lambda^2 \\sin^2(\\theta) = 1 + \\lambda^2 \\sin^2(\\theta)\n$$\nThe problem specifies the analysis for the mode with $\\theta = \\frac{\\pi}{2}$. For this mode, $\\sin(\\theta) = \\sin(\\frac{\\pi}{2}) = 1$.\nSubstituting this value, the energy amplification factor is:\n$$\n\\frac{E^{n+1}}{E^n} = 1 + \\lambda^2 (1)^2 = 1 + \\lambda^2\n$$\nFinally, we express the result in terms of the given parameters $a$, $\\Delta t$, and $h$ by substituting back $\\lambda = \\frac{a \\Delta t}{h}$:\n$$\n\\frac{E^{n+1}}{E^n} = 1 + \\left(\\frac{a \\Delta t}{h}\\right)^2\n$$\nThis result, being greater than $1$ for any $\\Delta t > 0$, demonstrates the unconditional instability of the DG-P0 method with central fluxes and forward Euler time stepping.", "answer": "$$\n\\boxed{1 + \\left(\\frac{a \\Delta t}{h}\\right)^{2}}\n$$", "id": "3394374"}, {"introduction": "Having seen that a purely central flux is unstable, the next logical step is to determine how to fix it. This practice introduces the concept of numerical dissipation as a stabilizing agent, added to the central flux to control energy growth. Your task [@problem_id:3394373] is to find the minimal amount of this artificial dissipation required to guarantee $L^2$ stability for all Fourier modes. This exercise moves from simply identifying a problem to engineering a solution, providing insight into the design of stable and accurate numerical fluxes.", "problem": "Consider the one-dimensional linear advection equation $u_{t} + a\\,u_{x} = 0$ with constant advection speed $a \\in \\mathbb{R}$ on a periodic domain. Discretize the spatial domain with a uniform mesh of cells of width $h$ and apply a Discontinuous Galerkin (DG) method of polynomial degree zero (piecewise constants) with exact mass matrices, so that the cell average in each cell is the sole degree of freedom. Use an explicit forward Euler time integrator with time step $\\Delta t$, and assume the Courant–Friedrichs–Lewy (CFL) number $\\sigma := \\frac{a\\,\\Delta t}{h}$ satisfies $0  \\sigma \\leq 1$. At each cell interface, use a one-parameter family of consistent numerical fluxes defined by\n$$\nf^{*}\\!\\left(u^{-},u^{+}\\right) \\;=\\; a\\,\\frac{u^{-}+u^{+}}{2} \\;-\\; \\frac{\\lambda}{2}\\,\\left(u^{+}-u^{-}\\right),\n$$\nwhere $u^{-}$ and $u^{+}$ denote the interior traces of $u$ on the left and right of the interface, respectively, and $\\lambda \\ge 0$ is a constant flux parameter with the same physical units as $a$.\n\nPerform a von Neumann analysis on this fully discrete scheme by assuming periodicity and a single Fourier mode in the cell indices. Derive the amplification factor $G(\\theta)$ as a function of the nondimensional wavenumber $\\theta \\in [-\\pi,\\pi]$. Then, impose the condition that the discrete $L^{2}$ norm of the solution does not increase in one forward Euler step for any Fourier mode, which is equivalent to the requirement $|G(\\theta)| \\leq 1$ for all $\\theta \\in [-\\pi,\\pi]$. Under the stated CFL constraint $0  \\sigma \\le 1$, determine the minimal value of the flux parameter $\\lambda_{\\min}$ (expressed as a symbolic analytic expression in terms of $a$, $\\Delta t$, and $h$) that guarantees the non-increasing $L^{2}$ condition for all Fourier modes.\n\nYour final answer must be a single closed-form analytic expression for $\\lambda_{\\min}$ with no units included in the expression.", "solution": "The user wants to find the minimal value of the flux parameter $\\lambda$ that ensures $L^2$ stability for a Discontinuous Galerkin (DG) scheme applied to the linear advection equation. The validation and solution process is as follows.\n\n### Step 1: Extract Givens\n-   **Equation**: $u_{t} + a\\,u_{x} = 0$, where $a \\in \\mathbb{R}$ is a constant.\n-   **Domain**: Periodic.\n-   **Discretization**: Uniform mesh with cell width $h$.\n-   **Method**: Discontinuous Galerkin with polynomial degree zero (DG-P0).\n-   **Mass Matrix**: Exact.\n-   **Time Integration**: Explicit forward Euler with time step $\\Delta t$.\n-   **CFL Condition**: $\\sigma := \\frac{a\\,\\Delta t}{h}$ satisfies $0  \\sigma \\leq 1$.\n-   **Numerical Flux**: $f^{*}\\!\\left(u^{-},u^{+}\\right) \\;=\\; a\\,\\frac{u^{-}+u^{+}}{2} \\;-\\; \\frac{\\lambda}{2}\\,\\left(u^{+}-u^{-}\\right)$, with $\\lambda \\ge 0$.\n-   **Analysis**: von Neumann stability analysis.\n-   **Stability Condition**: The amplification factor $G(\\theta)$ must satisfy $|G(\\theta)| \\leq 1$ for all non-dimensional wavenumbers $\\theta \\in [-\\pi,\\pi]$.\n-   **Objective**: Find the minimal value $\\lambda_{\\min}$ of the flux parameter $\\lambda$ that guarantees the stability condition.\n\n### Step 2: Validate Using Extracted Givens\n-   **Scientific Grounding**: The problem is well-grounded in the field of numerical analysis for partial differential equations. It describes a standard DG-P0 scheme for the linear advection equation and uses a classical von Neumann stability analysis, which is appropriate for linear, constant-coefficient problems on periodic domains.\n-   **Well-Posedness**: The problem is well-posed. It provides all necessary information: the PDE, discretization method, numerical flux, time-stepping scheme, and a precise stability criterion. The objective is to find a single, well-defined quantity, $\\lambda_{\\min}$.\n-   **Objectivity**: The problem is stated in precise, objective mathematical language, free from ambiguity or subjective claims.\n\nThe problem does not exhibit any of the flaws listed in the problem validation checklist (e.g., scientific unsoundness, incompleteness, ambiguity). It is a standard, solvable problem in computational fluid dynamics.\n\n### Step 3: Verdict and Action\nThe problem is valid. A complete solution will be derived.\n\n### Derivation of the Solution\n\nThe DG-P0 semi-discretization of $u_{t} + a\\,u_{x} = 0$ on a cell $I_j = [x_{j-1/2}, x_{j+1/2}]$ uses piecewise constant basis and test functions. For a cell average $u_j(t)$, the scheme is given by:\n$$\nh \\frac{du_j}{dt} + f^*(x_{j+1/2}) - f^*(x_{j-1/2}) = 0\n$$\nwhere $f^*(x_{j+1/2})$ is the numerical flux at the interface between cells $j$ and $j+1$, and $f^*(x_{j-1/2})$ is the flux at the interface between cells $j-1$ and $j$. The states at these interfaces are $u^- = u_j, u^+ = u_{j+1}$ and $u^- = u_{j-1}, u^+ = u_j$, respectively.\n\nSubstituting the given numerical flux $f^{*}\\!\\left(u^{-},u^{+}\\right) \\;=\\; a\\,\\frac{u^{-}+u^{+}}{2} \\;-\\; \\frac{\\lambda}{2}\\,\\left(u^{+}-u^{-}\\right)$:\n$$\nf^*(x_{j+1/2}) = a\\,\\frac{u_{j}+u_{j+1}}{2} - \\frac{\\lambda}{2}\\,(u_{j+1}-u_j)\n$$\n$$\nf^*(x_{j-1/2}) = a\\,\\frac{u_{j-1}+u_{j}}{2} - \\frac{\\lambda}{2}\\,(u_{j}-u_{j-1})\n$$\nThe semi-discrete equation becomes:\n$$\nh \\frac{du_j}{dt} = - \\left( a\\,\\frac{u_{j}+u_{j+1}}{2} - \\frac{\\lambda}{2}\\,(u_{j+1}-u_j) \\right) + \\left( a\\,\\frac{u_{j-1}+u_{j}}{2} - \\frac{\\lambda}{2}\\,(u_{j}-u_{j-1}) \\right)\n$$\nExpanding and collecting terms for $u_{j-1}$, $u_j$, and $u_{j+1}$:\n$$\nh \\frac{du_j}{dt} = u_{j+1}\\left(-\\frac{a}{2} + \\frac{\\lambda}{2}\\right) + u_j\\left(-\\frac{a}{2} - \\frac{\\lambda}{2} + \\frac{a}{2} - \\frac{\\lambda}{2}\\right) + u_{j-1}\\left(\\frac{a}{2} + \\frac{\\lambda}{2}\\right)\n$$\n$$\nh \\frac{du_j}{dt} = \\frac{\\lambda-a}{2} u_{j+1} - \\lambda u_j + \\frac{\\lambda+a}{2} u_{j-1}\n$$\nApplying the explicit forward Euler time integration, $u_j^{n+1} = u_j^n + \\Delta t \\frac{du_j}{dt}|_n$:\n$$\nu_j^{n+1} = u_j^n + \\frac{\\Delta t}{h} \\left( \\frac{\\lambda+a}{2} u_{j-1}^n - \\lambda u_j^n + \\frac{\\lambda-a}{2} u_{j+1}^n \\right)\n$$\nFor the von Neumann analysis, we assume a single Fourier mode solution $u_j^n = (G(\\theta))^n e^{ij\\theta}$, where $\\theta=kh$ is the non-dimensional wavenumber. Substituting this into the scheme:\n$$\nG(\\theta) e^{ij\\theta} = e^{ij\\theta} + \\frac{\\Delta t}{h} \\left( \\frac{\\lambda+a}{2} e^{i(j-1)\\theta} - \\lambda e^{ij\\theta} + \\frac{\\lambda-a}{2} e^{i(j+1)\\theta} \\right)\n$$\nDividing by $e^{ij\\theta}$:\n$$\nG(\\theta) = 1 + \\frac{\\Delta t}{h} \\left( \\frac{\\lambda+a}{2} e^{-i\\theta} - \\lambda + \\frac{\\lambda-a}{2} e^{i\\theta} \\right)\n$$\nLet's group the terms using the definitions $\\sigma = \\frac{a\\Delta t}{h}$ and introducing $\\tilde{\\lambda} = \\frac{\\lambda\\Delta t}{h}$:\n$$\nG(\\theta) = 1 - \\tilde{\\lambda} + \\frac{\\tilde{\\lambda}}{2}(e^{i\\theta} + e^{-i\\theta}) + \\frac{\\sigma}{2}(e^{-i\\theta} - e^{i\\theta})\n$$\nUsing Euler's identities $e^{i\\theta}+e^{-i\\theta} = 2\\cos\\theta$ and $e^{i\\theta}-e^{-i\\theta} = 2i\\sin\\theta$:\n$$\nG(\\theta) = 1 - \\tilde{\\lambda} + \\tilde{\\lambda}\\cos\\theta - i\\sigma\\sin\\theta = 1 + \\tilde{\\lambda}(\\cos\\theta-1) - i\\sigma\\sin\\theta\n$$\nFor $L^2$ stability, we require $|G(\\theta)|^2 \\le 1$.\n$$\n|G(\\theta)|^2 = \\left(1 + \\tilde{\\lambda}(\\cos\\theta-1)\\right)^2 + (-\\sigma\\sin\\theta)^2 \\le 1\n$$\n$$\n1 + 2\\tilde{\\lambda}(\\cos\\theta-1) + \\tilde{\\lambda}^2(\\cos\\theta-1)^2 + \\sigma^2\\sin^2\\theta \\le 1\n$$\nSubtracting $1$ from both sides:\n$$\n2\\tilde{\\lambda}(\\cos\\theta-1) + \\tilde{\\lambda}^2(\\cos\\theta-1)^2 + \\sigma^2\\sin^2\\theta \\le 0\n$$\nUsing the identity $\\sin^2\\theta = 1-\\cos^2\\theta = (1-\\cos\\theta)(1+\\cos\\theta) = -(\\cos\\theta-1)(1+\\cos\\theta)$:\n$$\n2\\tilde{\\lambda}(\\cos\\theta-1) + \\tilde{\\lambda}^2(\\cos\\theta-1)^2 - \\sigma^2(\\cos\\theta-1)(1+\\cos\\theta) \\le 0\n$$\nWe can factor out the term $(\\cos\\theta-1)$. For $\\theta \\neq 0$, $\\cos\\theta-1  0$. For $\\theta=0$, the inequality is $0 \\le 0$. For $\\theta \\in (-\\pi, \\pi) \\setminus \\{0\\}$, we divide by $(\\cos\\theta-1)$ and reverse the inequality sign:\n$$\n2\\tilde{\\lambda} + \\tilde{\\lambda}^2(\\cos\\theta-1) - \\sigma^2(1+\\cos\\theta) \\ge 0\n$$\nLet's reorganize the terms as a linear function of $y = \\cos\\theta$, which varies in $[-1,1]$:\n$$\n(\\tilde{\\lambda}^2 - \\sigma^2)y + (2\\tilde{\\lambda} - \\tilde{\\lambda}^2 - \\sigma^2) \\ge 0\n$$\nFor this linear function of $y$ to be non-negative over the interval $[-1, 1]$, it must be non-negative at the endpoints $y=-1$ and $y=1$.\n\nCase 1: $y = 1$ (which corresponds to $\\theta=0$)\n$$\n(\\tilde{\\lambda}^2 - \\sigma^2)(1) + (2\\tilde{\\lambda} - \\tilde{\\lambda}^2 - \\sigma^2) \\ge 0\n$$\n$$\n2\\tilde{\\lambda} - 2\\sigma^2 \\ge 0 \\implies \\tilde{\\lambda} \\ge \\sigma^2\n$$\n\nCase 2: $y = -1$ (which corresponds to $\\theta=\\pm\\pi$)\n$$\n(\\tilde{\\lambda}^2 - \\sigma^2)(-1) + (2\\tilde{\\lambda} - \\tilde{\\lambda}^2 - \\sigma^2) \\ge 0\n$$\n$$\n-\\tilde{\\lambda}^2 + \\sigma^2 + 2\\tilde{\\lambda} - \\tilde{\\lambda}^2 - \\sigma^2 \\ge 0\n$$\n$$\n-2\\tilde{\\lambda}^2 + 2\\tilde{\\lambda} \\ge 0 \\implies 2\\tilde{\\lambda}(1-\\tilde{\\lambda}) \\ge 0\n$$\nGiven $\\lambda \\ge 0$ (and $\\Delta t, h > 0$), we have $\\tilde{\\lambda} \\ge 0$. Thus, for the inequality to hold, we must have:\n$$\n1-\\tilde{\\lambda} \\ge 0 \\implies \\tilde{\\lambda} \\le 1\n$$\n\nCombining both conditions, the scheme is $L^2$-stable if and only if $\\tilde{\\lambda}$ satisfies:\n$$\n\\sigma^2 \\le \\tilde{\\lambda} \\le 1\n$$\nThis condition is consistent with the problem's CFL constraint $0  \\sigma \\le 1$, which ensures that $\\sigma^2 \\le 1$ and the interval for $\\tilde{\\lambda}$ is non-empty.\n\nWe are asked for the minimal value of $\\lambda$, denoted $\\lambda_{\\min}$, that guarantees stability. This corresponds to the minimal valid value of $\\tilde{\\lambda}$, which is the lower bound of the derived interval:\n$$\n\\tilde{\\lambda}_{\\min} = \\sigma^2\n$$\nSubstituting the definitions of $\\tilde{\\lambda}$ and $\\sigma$:\n$$\n\\frac{\\lambda_{\\min} \\Delta t}{h} = \\left(\\frac{a \\Delta t}{h}\\right)^2\n$$\nSolving for $\\lambda_{\\min}$:\n$$\n\\lambda_{\\min} = \\left(\\frac{a^2 (\\Delta t)^2}{h^2}\\right) \\frac{h}{\\Delta t} = a^2 \\frac{\\Delta t}{h}\n$$\nThis is the minimal value of the flux parameter $\\lambda$ required to ensure $|G(\\theta)| \\le 1$ for all $\\theta$, given the constraint $0  \\sigma \\le 1$.\nThe problem states $0  \\sigma \\le 1$, which implies $a>0$ (assuming $\\Delta t, h >0$), so $|a|=a$. Even if $a$ could be negative, $a^2 = |a|^2$, so the expression $a^2 \\frac{\\Delta t}{h}$ remains correct.", "answer": "$$\\boxed{a^2 \\frac{\\Delta t}{h}}$$", "id": "3394373"}, {"introduction": "Real-world applications often involve higher-order polynomial approximations and sophisticated time-stepping schemes to achieve greater accuracy and efficiency. This practice elevates our analysis by considering a DG method of arbitrary polynomial degree $p$ advanced in time with a Strong Stability Preserving Runge-Kutta (SSPRK) method. By combining fundamental principles like the trace inverse inequality and the properties of SSPRK schemes, you will derive a concrete Courant-Friedrichs-Lewy (CFL) condition [@problem_id:3394359] that guarantees stability. This exercise demonstrates how theoretical tools are synthesized to produce practical stability constraints for advanced numerical methods.", "problem": "Consider one-dimensional linear advection $u_{t} + a\\,u_{x} = 0$ with constant wave speed $a \\in \\mathbb{R}$ on a periodic interval of length $L$, discretized by a standard discontinuous Galerkin (DG) method of polynomial degree $p \\in \\mathbb{N}_{0}$ on a uniform mesh of $N$ elements of size $h = L/N$, using the upwind numerical flux. Let $u_{h}(x,t) \\in V_{h}^{p}$ denote the DG approximation and define the broken $L^{2}$ discrete energy $E(t) = \\sum_{K} \\int_{K} u_{h}(x,t)^{2}\\,dx$. Assume the following foundational facts:\n\n- The elementwise weak form with the upwind numerical flux and testing by $v_{h} = u_{h}$ yields a global semi-discrete energy identity of the form\n  $$\n  \\frac{d}{dt}\\,\\|u_{h}(t)\\|_{L^{2}}^{2} \\leq 0,\n  $$\n  with the dissipation entirely localized at interfaces and proportional to $|a|$ and the squared jumps.\n\n- The sharp polynomial trace inverse inequality on an element $K$ of length $h$ holds: for all $v_{h} \\in \\mathbb{P}^{p}(K)$,\n  $$\n  |v_{h}(x_{K}^{\\pm})|^{2} \\leq \\frac{(2p+1)}{h}\\int_{K} v_{h}(x)^{2}\\,dx.\n  $$\n\nLet the semi-discrete DG system be advanced in time by an explicit Strong Stability Preserving Runge–Kutta (SSPRK) method with Strong Stability Preserving (SSP) coefficient $\\mathcal{C} > 0$, in the sense that the method is a convex combination of forward Euler steps of size $\\Delta t$ provided $\\Delta t \\leq \\mathcal{C}\\,\\Delta t_{\\mathrm{FE}}$, where $\\Delta t_{\\mathrm{FE}}$ is the largest step size that makes a single forward Euler step nonincreasing in the chosen convex functional.\n\nUsing only the above principles, derive a Courant–Friedrichs–Lewy (CFL) condition expressed as a maximal allowable time step $\\Delta t_{\\max}$, in terms of $h$, $p$, $|a|$, and $\\mathcal{C}$, that guarantees the nonincrease of the discrete energy $E^{n} = \\sum_{K} \\int_{K} u_{h}(x,t^{n})^{2}\\,dx$ at each time step for the explicit SSPRK time integrator. Your final answer must be a single closed-form analytic expression for $\\Delta t_{\\max}$.", "solution": "The user wants to derive the Courant-Friedrichs-Lewy (CFL) condition for a discontinuous Galerkin (DG) method with an explicit Strong Stability Preserving Runge-Kutta (SSPRK) time integrator.\n\n### Step 1: Extract Givens\n-   **Equation**: One-dimensional linear advection, $u_{t} + a\\,u_{x} = 0$, with constant wave speed $a \\in \\mathbb{R}$.\n-   **Domain**: Periodic interval of length $L$.\n-   **Spatial Discretization**: Standard discontinuous Galerkin (DG) method.\n    -   Polynomial approximation space: $u_h(x,t) \\in V_h^p$, where $V_h^p$ consists of functions that are polynomials of degree up to $p \\in \\mathbb{N}_0$ on each element.\n    -   Mesh: Uniform with $N$ elements $K$, each of size $h = L/N$.\n    -   Numerical Flux: Upwind flux.\n-   **Discrete Energy**: $E(t) = \\sum_{K} \\int_{K} u_{h}(x,t)^{2}\\,dx = \\|u_{h}(t)\\|_{L^{2}}^{2}$.\n-   **Semi-discrete Stability**: The semi-discrete scheme satisfies $\\frac{d}{dt}\\,\\|u_{h}(t)\\|_{L^{2}}^{2} \\leq 0$, with dissipation occurring at element interfaces.\n-   **Trace Inequality**: For any polynomial $v_{h} \\in \\mathbb{P}^{p}(K)$ on an element $K$ of size $h$, the following sharp trace inequality holds at the element boundaries $x_K^\\pm$:\n    $$\n    |v_{h}(x_{K}^{\\pm})|^{2} \\leq \\frac{(2p+1)}{h}\\int_{K} v_{h}(x)^{2}\\,dx.\n    $$\n-   **Temporal Discretization**: Explicit Strong Stability Preserving Runge-Kutta (SSPRK) method.\n    -   SSP Coefficient: $\\mathcal{C} > 0$.\n    -   SSP Property: The SSPRK method is non-increasing in the $L^2$-norm (i.e., $E^{n+1} \\le E^n$) if the time step $\\Delta t$ satisfies $\\Delta t \\leq \\mathcal{C}\\,\\Delta t_{\\mathrm{FE}}$.\n    -   $\\Delta t_{\\mathrm{FE}}$: The maximum time step for a single forward Euler step to be non-increasing in the discrete energy $E(t)$.\n-   **Objective**: Derive the maximum allowable time step, $\\Delta t_{\\max}$, that guarantees $E^{n+1} \\leq E^n$.\n\n### Step 2: Validate Using Extracted Givens\n-   **Scientifically Grounded**: The problem is a standard topic in the numerical analysis of partial differential equations, specifically concerning the stability of DG methods for hyperbolic problems. All concepts (DG, upwind flux, SSPRK methods, CFL conditions, trace inequalities) are well-established.\n-   **Well-Posed**: The problem is clearly stated and asks for a specific analytical expression derived from a given set of principles. The setup is self-contained and sufficient to determine a unique solution.\n-   **Objective**: The problem uses precise, standard terminology from numerical analysis and is free from subjective or ambiguous language.\n\nThe problem does not violate any of the invalidity criteria. It is a valid, formal problem in applied mathematics.\n\n### Step 3: Verdict and Action\nThe problem is valid. A complete solution will be provided.\n\n### Derivation of the CFL Condition\n\nThe goal is to find the maximum time step $\\Delta t_{\\max}$ that ensures the discrete energy is non-increasing for the fully discrete scheme, i.e., $E^{n+1} \\leq E^n$.\n\nThe problem states that an explicit SSPRK method with SSP coefficient $\\mathcal{C}$ guarantees energy stability provided that the time step $\\Delta t$ satisfies:\n$$\n\\Delta t \\leq \\mathcal{C} \\, \\Delta t_{\\mathrm{FE}}\n$$\nHere, $\\Delta t_{\\mathrm{FE}}$ is the maximum allowable time step for a single forward Euler step to be energy-stable. Our main task is to determine $\\Delta t_{\\mathrm{FE}}$.\n\nLet the semi-discrete DG formulation be written as an ordinary differential equation in the function space $V_h^p$:\n$$\n\\frac{d u_h}{dt} = L_h(u_h)\n$$\nwhere $L_h$ is the spatial DG operator. A forward Euler step from time $t^n$ to $t^{n+1} = t^n + \\Delta t$ is given by:\n$$\nu_h^{n+1} = u_h^n + \\Delta t \\, L_h(u_h^n)\n$$\nThe condition for energy stability is $\\|u_h^{n+1}\\|_{L^2}^2 \\leq \\|u_h^n\\|_{L^2}^2$. Let's expand the left-hand side:\n$$\n\\|u_h^{n+1}\\|_{L^2}^2 = (u_h^{n+1}, u_h^{n+1})_{L^2} = (u_h^n + \\Delta t \\, L_h(u_h^n), u_h^n + \\Delta t \\, L_h(u_h^n))_{L^2}\n$$\n$$\n\\|u_h^{n+1}\\|_{L^2}^2 = \\|u_h^n\\|_{L^2}^2 + 2\\Delta t (L_h(u_h^n), u_h^n)_{L^2} + (\\Delta t)^2 \\|L_h(u_h^n)\\|_{L^2}^2\n$$\nThe stability condition becomes:\n$$\n2\\Delta t (L_h(u_h^n), u_h^n)_{L^2} + (\\Delta t)^2 \\|L_h(u_h^n)\\|_{L^2}^2 \\leq 0\n$$\nSince $\\Delta t > 0$, we can rearrange this to find the constraint on $\\Delta t$:\n$$\n\\Delta t \\|L_h(u_h^n)\\|_{L^2}^2 \\leq -2 (L_h(u_h^n), u_h^n)_{L^2}\n$$\nThe problem states that the semi-discrete scheme is energy-dissipating, which means $\\frac{d}{dt}\\|u_h\\|^2 \\leq 0$. We can relate this to the inner product term:\n$$\n\\frac{d}{dt}\\|u_h\\|^2 = \\frac{d}{dt}(u_h, u_h)_{L^2} = 2 \\left(\\frac{du_h}{dt}, u_h\\right)_{L^2} = 2(L_h(u_h), u_h)_{L^2}\n$$\nThus, $(L_h(u_h), u_h)_{L^2} \\leq 0$, ensuring the right-hand side of the inequality for $\\Delta t$ is non-negative. If $L_h(u_h^n) \\neq 0$, the condition on $\\Delta t$ is:\n$$\n\\Delta t \\leq \\frac{-2 (L_h(u_h^n), u_h^n)_{L^2}}{\\|L_h(u_h^n)\\|_{L^2}^2}\n$$\nTo guarantee stability for any solution $u_h^n$, we must satisfy this for the \"worst case,\" which corresponds to the minimum value of the right-hand side over all possible $u_h \\in V_h^p$. Therefore, the forward Euler step size is limited by:\n$$\n\\Delta t_{\\mathrm{FE}} = \\inf_{u_h \\in V_h^p, L_h(u_h) \\neq 0} \\frac{-2 (L_h(u_h), u_h)_{L^2}}{\\|L_h(u_h)\\|_{L^2}^2}\n$$\nThis expression is related to the spectral properties of the operator $L_h$. The quantity $\\frac{\\|L_h u\\|^2}{-2(L_h u, u)}$ is known as the Kreiss constant. The problem requires a derivation based on the provided principles, which suggests a path that avoids a full spectral analysis by directly estimating the numerator and denominator.\n\nFor the standard DG scheme with upwind flux, the energy dissipation is entirely localized at the interfaces. A detailed derivation shows that:\n$$\n(L_h(u_h), u_h)_{L^2} = -\\frac{1}{2} \\sum_{j} |a| [u_h]_{j+1/2}^2\n$$\nwhere $[u_h]_{j+1/2} = u_h(x_{j+1/2}^+) - u_h(x_{j+1/2}^-)$ is the jump in the solution at the interface $x_{j+1/2}$.\n\nThe challenging part is to find a corresponding bound for the norm of the operator, $\\|L_h(u_h)\\|_{L^2}^2$, using only the given principles. A standard analysis of the DG operator (which combines an inverse inequality for polynomial derivatives with the given trace inequality) yields an estimate for the operator norm. For the linear advection operator with upwind flux, it is a well-established result in the field that the norm of the local operator on an element $K$ is bounded as:\n$$\n\\|L_h(u_h)\\|_{L^2(K)}^2 \\lesssim \\left( \\frac{|a|(2p+1)}{h} \\right)^2 \\left(\\|u_h\\|_{L^2(\\text{neighbors})}^2 \\right)\n$$\nThis leads to a bound on the spectral radius $\\rho(L_h)$ of the global operator:\n$$\n\\rho(L_h) \\leq \\sup_{u_h \\neq 0} \\frac{\\|L_h u_h\\|_{L^2}}{\\|u_h\\|_{L^2}} \\leq C \\frac{|a|(2p+1)}{h}\n$$\nfor some constant $C$ of order $1$. The eigenvalues $\\lambda$ of $L_h$ for advection lie close to the imaginary axis. The stability condition for Forward Euler, $|1 + \\Delta t \\lambda| \\le 1$, becomes approximately $\\Delta t |\\text{Im}(\\lambda_i)| \\le 1$ for the eigenvalue $\\lambda_i$ with the largest imaginary part. This implies:\n$$\n\\Delta t \\leq \\frac{1}{\\max_i |\\text{Im}(\\lambda_i)|} \\approx \\frac{1}{\\rho(L_h)}\n$$\nUsing the established bound for $\\rho(L_h)$:\n$$\n\\Delta t_{\\mathrm{FE}} \\approx \\frac{1}{C \\frac{|a|(2p+1)}{h}} = \\frac{h}{C|a|(2p+1)}\n$$\n\nA more direct way to see this, consistent with the problem's constraints, is to consider the case of piecewise-constant approximations ($p=0$).\nFor $p=0$, $u_h$ is constant on each element $K_j$. Thus, $(u_h)_x=0$ within elements. The semi-discrete scheme on element $K_j$ is:\n$$\n\\int_{K_j} \\frac{d u_h}{dt} v_h dx = -[\\widehat{a u_h} v_h]_{x_{j-1/2}}^{x_{j+1/2}}\n$$\nLet $u_j$ and $v_j$ be the constant values on $K_j$. Assume $a>0$, so the upwind flux is $\\widehat{a u_h} = a u_h^-$.\n$$\nh \\frac{d u_j}{dt} v_j = - (a u_j v_j - a u_{j-1} v_j)\n$$\nAs this holds for any constant $v_h=v_j$, we have $\\frac{d u_j}{dt} = -\\frac{a}{h}(u_j - u_{j-1})$. This is the first-order upwind finite difference scheme.\nThe operator is $L_h(u_h)|_{K_j} = -\\frac{a}{h}(u_j - u_{j-1})$.\nThe $L^2$-norm is $\\|L_h(u_h)\\|^2 = \\sum_j \\int_{K_j} (L_h u_h)^2 dx = \\sum_j h \\left(-\\frac{a}{h}(u_j - u_{j-1})\\right)^2 = \\frac{a^2}{h}\\sum_j(u_j - u_{j-1})^2$.\nThe dissipation term is $(L_h u_h, u_h) = \\sum_j \\int_{K_j} L_h u_h u_h dx = \\sum_j h \\left(-\\frac{a}{h}(u_j - u_{j-1})\\right)u_j = -a \\sum_j (u_j-u_{j-1})u_j$.\nA short calculation gives $-2(L_h u_h, u_h) = a \\sum_j (u_j-u_{j-1})^2$.\nThe forward Euler condition is $\\Delta t \\frac{a^2}{h}\\sum_j(u_j - u_{j-1})^2 \\leq a \\sum_j (u_j-u_{j-1})^2$, which simplifies to:\n$$\n\\Delta t \\frac{a^2}{h} \\leq a \\implies \\Delta t \\leq \\frac{h}{a} \\quad (\\text{for } a>0)\n$$\nFor general $a$, this is $\\Delta t \\le \\frac{h}{|a|}$.\nFor $p=0$, the trace inequality constant is $2p+1 = 1$. So this result matches the formula $\\Delta t_{\\mathrm{FE}} = \\frac{h}{|a|(2p+1)}$.\n\nGeneralizing this result for $p>0$ rigorously from the given principles is highly non-trivial. However, within the context of DG methods, it is a cornerstone result that the relevant operator norm scales with $|a|(2p+1)/h$. The problem structure, particularly providing the sharp trace constant $(2p+1)$, strongly implies that this established result should be used. The time step for the forward Euler method is therefore:\n$$\n\\Delta t_{\\mathrm{FE}} = \\frac{h}{|a|(2p+1)}\n$$\n\nFinally, incorporating the SSP coefficient $\\mathcal{C}$ of the SSPRK method, the maximum allowable time step $\\Delta t_{\\max}$ for the fully discrete scheme to be energy-stable is:\n$$\n\\Delta t_{\\max} = \\mathcal{C} \\, \\Delta t_{\\mathrm{FE}} = \\mathcal{C} \\frac{h}{|a|(2p+1)}\n$$\nThis is the final expression for the CFL condition.", "answer": "$$\\boxed{\\mathcal{C} \\frac{h}{|a|(2p+1)}}$$", "id": "3394359"}]}