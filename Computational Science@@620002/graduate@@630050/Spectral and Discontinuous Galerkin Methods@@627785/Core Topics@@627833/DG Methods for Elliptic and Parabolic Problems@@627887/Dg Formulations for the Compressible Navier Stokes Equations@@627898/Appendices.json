{"hands_on_practices": [{"introduction": "The quadratic nonlinearities in the Navier-Stokes equations, such as the convective term, are a primary source of instability in numerical simulations. A powerful technique to address this is to use a split-form discretization that mimics the conservation properties of the continuous equations at the discrete level. This exercise [@problem_id:3376460] guides you through deriving a \"skew-symmetric\" form of the convective term that discretely conserves energy, and then demonstrates its effectiveness in reducing aliasing errors compared to more naive approaches.", "problem": "Consider a one-dimensional prototype of the quadratic convective nonlinearity that appears in the compressible Euler and Navier–Stokes equations, modeled by the inviscid Burgers-type strong form on the reference element $[-1,1]$:\n$$\n\\frac{\\partial u}{\\partial t} + \\mathcal{C}(u) = 0, \\qquad \\mathcal{C}(u) := \\frac{\\partial}{\\partial x}\\!\\left(\\frac{u^2}{2}\\right),\n$$\nwith periodic boundary conditions. In a nodal Discontinuous Galerkin (DG) collocation discretization based on Gauss–Lobatto–Legendre (GLL) nodes, the semi-discrete differentiation operator $D$ and diagonal mass/weight matrix $W$ satisfy the Summation-By-Parts (SBP) property $W D + D^{\\top} W = B$, where $B$ is a rank-$2$ matrix containing only boundary contributions. On a periodic mesh, these boundary contributions cancel between neighboring elements, and are thus taken to vanish at the semi-discrete level.\n\n- Use the following GLL data for polynomial degree $N=2$ on $[-1,1]$:\n  - Nodes $x_0=-1$, $x_1=0$, $x_2=1$.\n  - Quadrature weights $W=\\mathrm{diag}\\!\\big(\\frac{1}{3},\\frac{4}{3},\\frac{1}{3}\\big)$.\n  - Differentiation matrix\n    $$\n    D =\n    \\begin{pmatrix}\n    -\\frac{3}{2}  2  -\\frac{1}{2} \\\\\n    -\\frac{1}{2}  0  \\frac{1}{2} \\\\\n    \\frac{1}{2}  -2  \\frac{3}{2}\n    \\end{pmatrix}.\n    $$\n  You may assume the SBP identity $W D + D^{\\top} W = \\mathrm{diag}(-1,0,1)$ holds.\n\n- Let $u(x)=1+x^2$, and let $u_i := u(x_i)$ denote its nodal values. Define the exact strong-form convective derivative at nodes by\n  $$\n  s_{\\mathrm{exact},i} := u(x_i)\\,\\frac{d u}{d x}(x_i).\n  $$\n\n- In collocation, two common under-integrated strong-form discretizations of $\\mathcal{C}(u)$ at the nodes are:\n  - Conservative (flux) form: $s_{\\mathrm{cons}} := D\\big(\\frac{1}{2} u^{\\circ 2}\\big)$, where $u^{\\circ 2}$ denotes componentwise square.\n  - Advective form: $s_{\\mathrm{adv}} := U\\,D u$, where $U=\\mathrm{diag}(u_0,u_1,u_2)$.\n\nA skew-symmetric split form of the strong-form convective derivative for quadratic nonlinearities is sought in the family\n$$\ns_{\\alpha,\\beta}(u) = \\alpha\\, U\\,D u \\;+\\; \\beta\\, D\\!\\left(\\frac{1}{2}u^{\\circ 2}\\right),\n$$\nwith constants $\\alpha$ and $\\beta$ that do not depend on $u$ or $x$. You will determine $\\alpha$ and $\\beta$ by enforcing discrete energy conservation in the periodic case with the SBP property.\n\nTasks:\n1) Starting from the SBP identity and the semi-discrete energy $E = \\frac{1}{2} u^{\\top} W u$, derive the necessary and sufficient condition on $\\alpha$ and $\\beta$ for the skew-symmetric split form $s_{\\alpha,\\beta}(u)$ to satisfy $dE/dt = 0$ on a periodic mesh for all $u$. Express your final $s_{\\mathrm{skew}}(u)$ explicitly.\n\n2) Using the provided nodes $x_i$ and operators $D$ and $W$, compute the nodal vectors $s_{\\mathrm{exact}}$, $s_{\\mathrm{cons}}$, and $s_{\\mathrm{skew}}$ for $u(x)=1+x^2$.\n\n3) Define the weighted aliasing-error norms\n$$\n\\|e_{\\mathrm{cons}}\\|_{W}^{2} := \\sum_{i=0}^{2} w_i \\left(s_{\\mathrm{cons},i} - s_{\\mathrm{exact},i}\\right)^{2},\n\\qquad\n\\|e_{\\mathrm{skew}}\\|_{W}^{2} := \\sum_{i=0}^{2} w_i \\left(s_{\\mathrm{skew},i} - s_{\\mathrm{exact},i}\\right)^{2},\n$$\nwith $w_0=\\frac{1}{3}$, $w_1=\\frac{4}{3}$, $w_2=\\frac{1}{3}$. Compute the ratio\n$$\nr = \\frac{\\|e_{\\mathrm{cons}}\\|_{W}^{2}}{\\|e_{\\mathrm{skew}}\\|_{W}^{2}}.\n$$\n\nProvide the final value of $r$ as an exact number. Do not include units. Do not use a percentage. If you approximate, round to four significant figures.", "solution": "The problem is evaluated to be scientifically sound, self-contained, and well-posed. All data and definitions required for a unique solution are provided, and there are no internal contradictions or violations of mathematical principles. We may proceed with the solution.\n\nThe problem is divided into three tasks. We will address them in sequence.\n\n### Task 1: Derivation of the Skew-Symmetric Form\nWe are given the semi-discrete equation for the nodal values vector $\\mathbf{u}$ as $\\frac{d\\mathbf{u}}{dt} + s_{\\alpha,\\beta}(\\mathbf{u}) = 0$. The discrete kinetic energy on the element is $E = \\frac{1}{2} \\mathbf{u}^{\\top} W \\mathbf{u}$. The time rate of change of energy is given by:\n$$\n\\frac{dE}{dt} = \\frac{1}{2} \\left( \\frac{d\\mathbf{u}^{\\top}}{dt} W \\mathbf{u} + \\mathbf{u}^{\\top} W \\frac{d\\mathbf{u}}{dt} \\right) = \\mathbf{u}^{\\top} W \\frac{d\\mathbf{u}}{dt}\n$$\nwhere we have used the symmetry of the mass matrix $W$. Substituting the semi-discrete equation, we get:\n$$\n\\frac{dE}{dt} = -\\mathbf{u}^{\\top} W s_{\\alpha,\\beta}(\\mathbf{u})\n$$\nThe split form $s_{\\alpha,\\beta}(\\mathbf{u})$ is given by:\n$$\ns_{\\alpha,\\beta}(\\mathbf{u}) = \\alpha U D \\mathbf{u} + \\beta D\\left(\\frac{1}{2}\\mathbf{u}^{\\circ 2}\\right)\n$$\nwhere $U = \\mathrm{diag}(\\mathbf{u})$ and $\\mathbf{u}^{\\circ 2}$ is the element-wise square of $\\mathbf{u}$. The energy change rate becomes:\n$$\n\\frac{dE}{dt} = -\\mathbf{u}^{\\top} W \\left[ \\alpha U D \\mathbf{u} + \\frac{\\beta}{2} D(\\mathbf{u}^{\\circ 2}) \\right] = -\\alpha (\\mathbf{u}^{\\top} W U D \\mathbf{u}) - \\frac{\\beta}{2} (\\mathbf{u}^{\\top} W D(\\mathbf{u}^{\\circ 2}))\n$$\nLet's analyze the term $\\mathbf{u}^{\\top} W U$. Since $W$ and $U$ are diagonal, with entries $w_i$ and $u_i$ respectively, the $j$-th element of the row vector $\\mathbf{u}^{\\top} W U$ is $\\sum_i u_i (WU)_{ij} = \\sum_i u_i W_{ij} U_{jj} = u_j W_{jj} U_{jj} = u_j w_j u_j = w_j u_j^2$. This is the same as the $j$-th component of the row vector $(\\mathbf{u}^{\\circ 2})^{\\top} W$. Thus, we have the identity $\\mathbf{u}^{\\top} W U = (\\mathbf{u}^{\\circ 2})^{\\top} W$.\nLet's define two quadratic forms:\n$$\nT_1 = (\\mathbf{u}^{\\circ 2})^{\\top} W D \\mathbf{u} \\qquad \\text{and} \\qquad T_2 = \\mathbf{u}^{\\top} W D(\\mathbf{u}^{\\circ 2})\n$$\nWith this, the energy change rate is $\\frac{dE}{dt} = -(\\alpha T_1 + \\frac{\\beta}{2} T_2)$.\n\nThe Summation-By-Parts (SBP) property $W D + D^{\\top} W = B$ provides a discrete integration-by-parts formula. For any vectors $\\mathbf{v}$ and $\\mathbf{z}$:\n$$\n\\mathbf{v}^{\\top} W D \\mathbf{z} + (D\\mathbf{v})^{\\top} W \\mathbf{z} = \\mathbf{v}^{\\top} B \\mathbf{z}\n$$\nLet $\\mathbf{v} = \\mathbf{u}^{\\circ 2}$ and $\\mathbf{z} = \\mathbf{u}$. The SBP formula gives:\n$$\n(\\mathbf{u}^{\\circ 2})^{\\top} W D \\mathbf{u} + (D(\\mathbf{u}^{\\circ 2}))^{\\top} W \\mathbf{u} = (\\mathbf{u}^{\\circ 2})^{\\top} B \\mathbf{u}\n$$\nThe second term on the left is $(D(\\mathbf{u}^{\\circ 2}))^{\\top} W \\mathbf{u} = \\mathbf{u}^{\\top} W (D(\\mathbf{u}^{\\circ 2})) = T_2$. The first term is $T_1$. So, we have the relation:\n$$\nT_1 + T_2 = (\\mathbf{u}^{\\circ 2})^{\\top} B \\mathbf{u}\n$$\nThe term on the right is a boundary term. For a globally periodic mesh, the sum of these boundary terms over all elements vanishes.\n\nWe now express the energy change rate in terms of $T_1$ and the boundary term. From the SBP relation, we have $T_2 = (\\mathbf{u}^{\\circ 2})^{\\top} B \\mathbf{u} - T_1$. Substituting this into the expression for $\\frac{dE}{dt}$:\n$$\n\\frac{dE}{dt} = -\\left[ \\alpha T_1 + \\frac{\\beta}{2} \\left( (\\mathbf{u}^{\\circ 2})^{\\top} B \\mathbf{u} - T_1 \\right) \\right] = -\\left[ \\left(\\alpha - \\frac{\\beta}{2}\\right)T_1 + \\frac{\\beta}{2}(\\mathbf{u}^{\\circ 2})^{\\top} B \\mathbf{u} \\right]\n$$\nThe total energy change over a periodic domain is the sum of these elemental contributions. The sum of the boundary term $\\frac{\\beta}{2}(\\mathbf{u}^{\\circ 2})^{\\top} B \\mathbf{u}$ over all elements is zero. However, the term $T_1$ is generally non-zero and its sum over the elements does not vanish. Therefore, for the total energy to be conserved for any $\\mathbf{u}$, the coefficient of $T_1$ must be zero:\n$$\n\\alpha - \\frac{\\beta}{2} = 0 \\implies 2\\alpha = \\beta\n$$\nFor the split-form discretization to be consistent with the original convective term $\\mathcal{C}(u)$, the sum of the coefficients must be unity, since both $U D \\mathbf{u}$ and $D(\\frac{1}{2}\\mathbf{u}^{\\circ 2})$ are consistent discretizations of $\\mathcal{C}(u)$:\n$$\n\\alpha + \\beta = 1\n$$\nSolving this system of two linear equations:\n$$\n\\alpha + 2\\alpha = 1 \\implies 3\\alpha = 1 \\implies \\alpha = \\frac{1}{3}\n$$\n$$\n\\beta = 2\\alpha = \\frac{2}{3}\n$$\nThe resulting energy-conserving or skew-symmetric split form is:\n$$\ns_{\\mathrm{skew}}(\\mathbf{u}) = \\frac{1}{3} U D \\mathbf{u} + \\frac{2}{3} D\\left(\\frac{1}{2}\\mathbf{u}^{\\circ 2}\\right) = \\frac{1}{3} U D \\mathbf{u} + \\frac{1}{3} D(\\mathbf{u}^{\\circ 2})\n$$\n\n### Task 2: Computation of Nodal Vectors\nWe are given $u(x) = 1+x^2$ and the GLL nodes $x_0=-1, x_1=0, x_2=1$.\nThe nodal values of $u(x)$ are:\n$u_0 = u(-1) = 1+(-1)^2 = 2$\n$u_1 = u(0) = 1+0^2 = 1$\n$u_2 = u(1) = 1+1^2 = 2$\nThe nodal vector is $\\mathbf{u} = \\begin{pmatrix} 2  1  2 \\end{pmatrix}^{\\top}$.\n\nThe exact strong-form convective derivative is $s_{\\mathrm{exact},i} = u(x_i) \\frac{du}{dx}(x_i)$. With $\\frac{du}{dx} = 2x$:\n$s_{\\mathrm{exact},0} = u(-1) \\cdot (2(-1)) = 2 \\cdot (-2) = -4$\n$s_{\\mathrm{exact},1} = u(0) \\cdot (2(0)) = 1 \\cdot 0 = 0$\n$s_{\\mathrm{exact},2} = u(1) \\cdot (2(1)) = 2 \\cdot 2 = 4$\nSo, $\\mathbf{s}_{\\mathrm{exact}} = \\begin{pmatrix} -4  0  4 \\end{pmatrix}^{\\top}$.\n\nThe conservative form is $s_{\\mathrm{cons}} = D(\\frac{1}{2} \\mathbf{u}^{\\circ 2})$. The vector of squared nodal values is $\\mathbf{u}^{\\circ 2} = \\begin{pmatrix} 2^2  1^2  2^2 \\end{pmatrix}^{\\top} = \\begin{pmatrix} 4  1  4 \\end{pmatrix}^{\\top}$.\n$$\n\\mathbf{s}_{\\mathrm{cons}} = \\frac{1}{2} D \\mathbf{u}^{\\circ 2} = \\frac{1}{2} \\begin{pmatrix} -\\frac{3}{2}  2  -\\frac{1}{2} \\\\ -\\frac{1}{2}  0  \\frac{1}{2} \\\\ \\frac{1}{2}  -2  \\frac{3}{2} \\end{pmatrix} \\begin{pmatrix} 4 \\\\ 1 \\\\ 4 \\end{pmatrix} = \\frac{1}{2} \\begin{pmatrix} -6+2-2 \\\\ -2+0+2 \\\\ 2-2+6 \\end{pmatrix} = \\frac{1}{2} \\begin{pmatrix} -6 \\\\ 0 \\\\ 6 \\end{pmatrix} = \\begin{pmatrix} -3 \\\\ 0 \\\\ 3 \\end{pmatrix}\n$$\n\nThe skew-symmetric form is $s_{\\mathrm{skew}}(\\mathbf{u}) = \\frac{1}{3} U D \\mathbf{u} + \\frac{1}{3} D(\\mathbf{u}^{\\circ 2})$.\nFirst, we compute $D\\mathbf{u}$:\n$$\nD\\mathbf{u} = \\begin{pmatrix} -\\frac{3}{2}  2  -\\frac{1}{2} \\\\ -\\frac{1}{2}  0  \\frac{1}{2} \\\\ \\frac{1}{2}  -2  \\frac{3}{2} \\end{pmatrix} \\begin{pmatrix} 2 \\\\ 1 \\\\ 2 \\end{pmatrix} = \\begin{pmatrix} -3+2-1 \\\\ -1+0+1 \\\\ 1-2+3 \\end{pmatrix} = \\begin{pmatrix} -2 \\\\ 0 \\\\ 2 \\end{pmatrix}\n$$\nThe matrix $U$ is $\\mathrm{diag}(2,1,2)$. So, $UD\\mathbf{u} = \\begin{pmatrix} 2  0  0 \\\\ 0  1  0 \\\\ 0  0  2 \\end{pmatrix} \\begin{pmatrix} -2 \\\\ 0 \\\\ 2 \\end{pmatrix} = \\begin{pmatrix} -4 \\\\ 0 \\\\ 4 \\end{pmatrix}$.\nWe already computed $D(\\mathbf{u}^{\\circ 2}) = \\begin{pmatrix} -6  0  6 \\end{pmatrix}^{\\top}$.\n$$\n\\mathbf{s}_{\\mathrm{skew}} = \\frac{1}{3} \\begin{pmatrix} -4 \\\\ 0 \\\\ 4 \\end{pmatrix} + \\frac{1}{3} \\begin{pmatrix} -6 \\\\ 0 \\\\ 6 \\end{pmatrix} = \\frac{1}{3} \\begin{pmatrix} -10 \\\\ 0 \\\\ 10 \\end{pmatrix} = \\begin{pmatrix} -\\frac{10}{3} \\\\ 0 \\\\ \\frac{10}{3} \\end{pmatrix}\n$$\n\n### Task 3: Computation of the Error Ratio\nFirst, we compute the error vectors.\n$$\n\\mathbf{e}_{\\mathrm{cons}} = \\mathbf{s}_{\\mathrm{cons}} - \\mathbf{s}_{\\mathrm{exact}} = \\begin{pmatrix} -3 \\\\ 0 \\\\ 3 \\end{pmatrix} - \\begin{pmatrix} -4 \\\\ 0 \\\\ 4 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 0 \\\\ -1 \\end{pmatrix}\n$$\n$$\n\\mathbf{e}_{\\mathrm{skew}} = \\mathbf{s}_{\\mathrm{skew}} - \\mathbf{s}_{\\mathrm{exact}} = \\begin{pmatrix} -\\frac{10}{3} \\\\ 0 \\\\ \\frac{10}{3} \\end{pmatrix} - \\begin{pmatrix} -4 \\\\ 0 \\\\ 4 \\end{pmatrix} = \\begin{pmatrix} -\\frac{10}{3} + \\frac{12}{3} \\\\ 0 \\\\ \\frac{10}{3} - \\frac{12}{3} \\end{pmatrix} = \\begin{pmatrix} \\frac{2}{3} \\\\ 0 \\\\ -\\frac{2}{3} \\end{pmatrix}\n$$\nNext, we compute the weighted squared norms. The weights are $w_0=\\frac{1}{3}, w_1=\\frac{4}{3}, w_2=\\frac{1}{3}$.\n$$\n\\|\\mathbf{e}_{\\mathrm{cons}}\\|_{W}^{2} = \\sum_{i=0}^{2} w_i e_{\\mathrm{cons},i}^2 = \\frac{1}{3}(1)^2 + \\frac{4}{3}(0)^2 + \\frac{1}{3}(-1)^2 = \\frac{1}{3} + 0 + \\frac{1}{3} = \\frac{2}{3}\n$$\n$$\n\\|\\mathbf{e}_{\\mathrm{skew}}\\|_{W}^{2} = \\sum_{i=0}^{2} w_i e_{\\mathrm{skew},i}^2 = \\frac{1}{3}\\left(\\frac{2}{3}\\right)^2 + \\frac{4}{3}(0)^2 + \\frac{1}{3}\\left(-\\frac{2}{3}\\right)^2 = \\frac{1}{3}\\left(\\frac{4}{9}\\right) + 0 + \\frac{1}{3}\\left(\\frac{4}{9}\\right) = \\frac{4}{27} + \\frac{4}{27} = \\frac{8}{27}\n$$\nFinally, we compute the ratio $r$:\n$$\nr = \\frac{\\|\\mathbf{e}_{\\mathrm{cons}}\\|_{W}^{2}}{\\|\\mathbf{e}_{\\mathrm{skew}}\\|_{W}^{2}} = \\frac{\\frac{2}{3}}{\\frac{8}{27}} = \\frac{2}{3} \\times \\frac{27}{8} = \\frac{2 \\times 27}{3 \\times 8} = \\frac{54}{24} = \\frac{9 \\times 6}{4 \\times 6} = \\frac{9}{4}\n$$\nAs a decimal, this is $2.25$. The problem requests an exact number.", "answer": "$$\\boxed{\\frac{9}{4}}$$", "id": "3376460"}, {"introduction": "Robustly handling shocks and contact discontinuities is paramount in simulating compressible flows. This requires a sophisticated treatment at element interfaces, often using approximate Riemann solvers built from linearizations of the flux. This practice [@problem_id:3376511] first asks you to derive the celebrated Roe linearization for the Euler equations. It then confronts a critical challenge of high-order methods: the potential for non-physical states (e.g., negative pressure), guiding you to construct a positivity-preserving limiter that enforces physical realizability without violating conservation.", "problem": "Consider the one-dimensional compressible Euler equations in conservation form with state vector $\\,\\boldsymbol{q} = (\\rho,\\,\\rho u,\\,E)^{\\top}\\,$, flux $\\,\\boldsymbol{f}(\\boldsymbol{q}) = \\big(\\rho u,\\,\\rho u^{2} + p,\\,u(E + p)\\big)^{\\top}\\,$, and an ideal-gas equation of state $\\,p = (\\gamma - 1)\\left(E - \\frac{1}{2}\\rho u^{2}\\right)\\,$ with constant ratio of specific heats $\\,\\gamma > 1\\,$.\n\nPart A (derivation): Starting from the conservation form and the ideal-gas thermodynamics above, derive the Roe linearization for the compressible Euler flux across an interface with unit normal in the flow direction, that is, determine a constant Jacobian $\\,\\tilde{\\boldsymbol{A}}\\,(\\boldsymbol{q}_{\\mathrm{L}},\\boldsymbol{q}_{\\mathrm{R}})\\,$ such that $\\,\\boldsymbol{f}(\\boldsymbol{q}_{\\mathrm{R}}) - \\boldsymbol{f}(\\boldsymbol{q}_{\\mathrm{L}}) = \\tilde{\\boldsymbol{A}}\\,(\\boldsymbol{q}_{\\mathrm{R}} - \\boldsymbol{q}_{\\mathrm{L}})\\,$. Your derivation must identify the Roe-averaged quantities $\\,\\tilde{u}\\,$ and $\\,\\tilde{H}\\,$, the Roe sound speed $\\,\\tilde{a}\\,$, and the eigenvalues of $\\,\\tilde{\\boldsymbol{A}}\\,$ in terms of the left and right states. Do not quote the result; derive it from the defining property of the Roe linearization and the ideal-gas relations.\n\nPart B (positivity modifications in Discontinuous Galerkin): In a Discontinuous Galerkin (DG) formulation for high-Mach flows, density and pressure must remain positive at quadrature points to avoid loss of hyperbolicity and nonphysical states. Explain, from first principles of conservation and convexity, how a positivity-preserving limiter can be constructed by rescaling polynomial deviations from the cell average. In particular, consider a nodal DG representation on a cell with two quadrature nodes with equal weights $\\,\\frac{1}{2}\\,$ and conservative nodal states $\\,\\boldsymbol{U}_{1}=(\\rho_{1},m_{1},E_{1})^{\\top}\\,$ and $\\,\\boldsymbol{U}_{2}=(\\rho_{2},m_{2},E_{2})^{\\top}\\,$, where $\\,m=\\rho u\\,$. The cell average is $\\,\\bar{\\boldsymbol{U}}=\\frac{1}{2}(\\boldsymbol{U}_{1}+\\boldsymbol{U}_{2})\\,$. The positivity-preserving rescaling produces the limited nodal state $\\,\\boldsymbol{U}_{1}^{\\mathrm{lim}} = \\bar{\\boldsymbol{U}} + \\theta\\big(\\boldsymbol{U}_{1} - \\bar{\\boldsymbol{U}}\\big)\\,$ with $\\,\\theta \\in [0,1]\\,$ chosen minimally so that both $\\,\\rho(\\theta) > 0\\,$ and $\\,p(\\theta) \\ge 0\\,$ at node $\\,1\\,$, where $\\,\\rho(\\theta)\\,$, $\\,m(\\theta)\\,$, and $\\,E(\\theta)\\,$ are the components of $\\,\\boldsymbol{U}_{1}^{\\mathrm{lim}}\\,$ and $\\,p(\\theta)=(\\gamma-1)\\!\\left(E(\\theta)-\\frac{1}{2}\\frac{m(\\theta)^{2}}{\\rho(\\theta)}\\right)\\,$. Derive the scalar nonlinear condition for $\\,\\theta\\,$ implied by $\\,p(\\theta)=0\\,$ and reduce it to a quadratic equation. State precisely how the minimal admissible $\\,\\theta\\,$ is selected from the roots of this quadratic under the constraint $\\,\\theta \\in [0,1]\\,$.\n\nConcrete calculation: Take $\\,\\gamma=1.4\\,$ and the two nodal states\n- $\\,\\boldsymbol{U}_{1} = (\\rho_{1},m_{1},E_{1})^{\\top} = (\\,0.05,\\,2.0,\\,39.75\\,)^{\\top}\\,$,\n- $\\,\\boldsymbol{U}_{2} = (\\rho_{2},m_{2},E_{2})^{\\top} = (\\,0.8,\\,4.0,\\,12.5\\,)^{\\top}\\,$,\nso that $\\,\\bar{\\boldsymbol{U}} = \\frac{1}{2}(\\boldsymbol{U}_{1}+\\boldsymbol{U}_{2})\\,$. Compute the minimal $\\,\\theta \\in [0,1]\\,$ such that the limited state at node $\\,1\\,$ satisfies $\\,p(\\theta)=0\\,$ (take the pressure floor as $\\,0\\,$ for this computation). Round your answer for $\\,\\theta\\,$ to four significant figures. The final answer you submit must be only the numerical value of $\\,\\theta\\,$, which is dimensionless.", "solution": "The user has provided a two-part problem concerning the compressible Euler equations. I will first validate the problem statement and then provide a complete solution.\n\n## Problem Validation\n\n### Step 1: Extract Givens\n\n**Part A (Derivation):**\n-   System of equations: One-dimensional compressible Euler equations in conservation form.\n-   State vector: $\\boldsymbol{q} = (\\rho, \\rho u, E)^{\\top}$.\n-   Flux vector: $\\boldsymbol{f}(\\boldsymbol{q}) = (\\rho u, \\rho u^2 + p, u(E+p))^{\\top}$.\n-   Equation of state: Ideal gas, $p = (\\gamma-1)(E - \\frac{1}{2}\\rho u^2)$, with constant $\\gamma > 1$.\n-   Task: Derive the Roe linearization $\\tilde{\\boldsymbol{A}}(\\boldsymbol{q}_{\\mathrm{L}}, \\boldsymbol{q}_{\\mathrm{R}})$ satisfying $\\boldsymbol{f}(\\boldsymbol{q}_{\\mathrm{R}}) - \\boldsymbol{f}(\\boldsymbol{q}_{\\mathrm{L}}) = \\tilde{\\boldsymbol{A}}(\\boldsymbol{q}_{\\mathrm{R}} - \\boldsymbol{q}_{\\mathrm{L}})$.\n-   Required outputs: Expressions for Roe-averaged quantities $\\tilde{u}$ and $\\tilde{H}$, Roe sound speed $\\tilde{a}$, and the eigenvalues of $\\tilde{\\boldsymbol{A}}$. The derivation must be from first principles.\n\n**Part B (Positivity-Preserving Limiter):**\n-   Context: Nodal Discontinuous Galerkin (DG) method, one cell with two quadrature nodes.\n-   Quadrature weights: Equal, $\\frac{1}{2}$.\n-   Nodal states: $\\boldsymbol{U}_{1}=(\\rho_{1},m_{1},E_{1})^{\\top}$ and $\\boldsymbol{U}_{2}=(\\rho_{2},m_{2},E_{2})^{\\top}$, where $m=\\rho u$.\n-   Cell average: $\\bar{\\boldsymbol{U}}=\\frac{1}{2}(\\boldsymbol{U}_{1}+\\boldsymbol{U}_{2})$.\n-   Limited state at node 1: $\\boldsymbol{U}_{1}^{\\mathrm{lim}} = \\bar{\\boldsymbol{U}} + \\theta(\\boldsymbol{U}_{1} - \\bar{\\boldsymbol{U}})$ with $\\theta \\in [0,1]$.\n-   Positivity constraints: $\\rho(\\theta) > 0$ and $p(\\theta) \\ge 0$ at node 1, where $p(\\theta)=(\\gamma-1)(E(\\theta)-\\frac{1}{2}\\frac{m(\\theta)^{2}}{\\rho(\\theta)})$.\n-   Task 1 (Derivation): Derive the scalar nonlinear condition for $\\theta$ from $p(\\theta)=0$, reduce it to a quadratic equation, and explain how to select the minimal admissible $\\theta \\in [0,1]$.\n-   Task 2 (Calculation): For $\\gamma=1.4$ and given nodal states $\\boldsymbol{U}_{1} = (0.05, 2.0, 39.75)^{\\top}$ and $\\boldsymbol{U}_{2} = (0.8, 4.0, 12.5)^{\\top}$, compute the minimal $\\theta \\in [0,1]$ that makes $p(\\theta)=0$.\n-   Final answer requirement: Numerical value of $\\theta$ rounded to four significant figures.\n\n### Step 2: Validate Using Extracted Givens\n\n1.  **Scientifically Grounded:** The problem deals with the Euler equations, ideal gas law, Roe linearization, and positivity-preserving limiters. These are standard, well-established concepts in computational fluid dynamics (CFD) and applied mathematics. The problem is scientifically sound.\n2.  **Well-Posed:**\n    -   Part A is a standard derivation task with a unique, well-known result. All necessary definitions are provided.\n    -   Part B presents a clear procedure for limiting a solution. It specifies the form of the limited state and the conditions it must satisfy. The given numerical values lead to a situation (negative pressure at a node) where such a limiter is required, making the problem meaningful. It asks to solve for a parameter $\\theta$, and the derivation leads to a solvable quadratic equation. The problem is well-posed.\n3.  **Objective:** The problem is stated in precise mathematical and physical terms, free of ambiguity or subjectivity.\n\n### Step 3: Verdict and Action\n\nThe problem is **valid**. It is scientifically grounded, well-posed, objective, and contains all necessary information. I will now proceed with the solution.\n\n## Part A: Derivation of the Roe Linearization\n\nThe Roe linearization requires finding a matrix $\\tilde{\\boldsymbol{A}}(\\boldsymbol{q}_{\\mathrm{L}}, \\boldsymbol{q}_{\\mathrm{R}})$ such that the flux difference across a discontinuity satisfies\n$$ \\boldsymbol{f}(\\boldsymbol{q}_{\\mathrm{R}}) - \\boldsymbol{f}(\\boldsymbol{q}_{\\mathrm{L}}) = \\tilde{\\boldsymbol{A}}(\\boldsymbol{q}_{\\mathrm{R}} - \\boldsymbol{q}_{\\mathrm{L}}) $$\nLet $\\Delta(\\cdot)$ denote the jump $(\\cdot)_{\\mathrm{R}} - (\\cdot)_{\\mathrm{L}}$. The condition is $\\Delta\\boldsymbol{f} = \\tilde{\\boldsymbol{A}}\\Delta\\boldsymbol{q}$.\nThe Roe matrix $\\tilde{\\boldsymbol{A}}$ has the same structure as the true flux Jacobian $\\boldsymbol{A}(\\boldsymbol{q}) = \\frac{\\partial\\boldsymbol{f}}{\\partial\\boldsymbol{q}}$, but is evaluated at a special \"Roe-averaged\" state. The Jacobian of the Euler flux is:\n$$ \\boldsymbol{A}(\\boldsymbol{q}) = \\begin{pmatrix} 0  1  0 \\\\ \\frac{\\gamma-3}{2}u^2  (3-\\gamma)u  \\gamma-1 \\\\ u\\left(\\frac{\\gamma-1}{2}u^2-H\\right)  H - (\\gamma-1)u^2  \\gamma u \\end{pmatrix} $$\nwhere $H = (E+p)/\\rho$ is the specific total enthalpy. The Roe matrix $\\tilde{\\boldsymbol{A}}$ is obtained by replacing $u$ and $H$ with their Roe averages $\\tilde{u}$ and $\\tilde{H}$:\n$$ \\tilde{\\boldsymbol{A}} = \\begin{pmatrix} 0  1  0 \\\\ \\frac{\\gamma-3}{2}\\tilde{u}^2  (3-\\gamma)\\tilde{u}  \\gamma-1 \\\\ \\tilde{u}\\left(\\frac{\\gamma-1}{2}\\tilde{u}^2-\\tilde{H}\\right)  \\tilde{H} - (\\gamma-1)\\tilde{u}^2  \\gamma \\tilde{u} \\end{pmatrix} $$\nThe Roe-averaged quantities are defined as follows:\n$$ \\tilde{\\rho} = \\sqrt{\\rho_{\\mathrm{L}}\\rho_{\\mathrm{R}}} $$\n$$ \\tilde{u} = \\frac{\\sqrt{\\rho_{\\mathrm{L}}}u_{\\mathrm{L}} + \\sqrt{\\rho_{\\mathrm{R}}}u_{\\mathrm{R}}}{\\sqrt{\\rho_{\\mathrm{L}}} + \\sqrt{\\rho_{\\mathrm{R}}}} $$\n$$ \\tilde{H} = \\frac{\\sqrt{\\rho_{\\mathrm{L}}}H_{\\mathrm{L}} + \\sqrt{\\rho_{\\mathrm{R}}}H_{\\mathrm{R}}}{\\sqrt{\\rho_{\\mathrm{L}}} + \\sqrt{\\rho_{\\mathrm{R}}}} $$\nThe derivation consists of showing that with these definitions, the property $\\Delta\\boldsymbol{f} = \\tilde{\\boldsymbol{A}}\\Delta\\boldsymbol{q}$ holds exactly. This verification relies on several identities that are satisfied by the Roe averages. Let $S_{\\mathrm{L}}=\\sqrt{\\rho_{\\mathrm{L}}}$ and $S_{\\mathrm{R}}=\\sqrt{\\rho_{\\mathrm{R}}}$.\n\n**Key Identities:**\nA crucial set of identities relates the jumps in conserved quantities to jumps in primitive variables using the Roe averages.\n1.  $\\Delta(\\rho u) = \\rho_{\\mathrm{R}}u_{\\mathrm{R}} - \\rho_{\\mathrm{L}}u_{\\mathrm{L}} = S_{\\mathrm{R}}^2 u_{\\mathrm{R}} - S_{\\mathrm{L}}^2 u_{\\mathrm{L}}$.\n    A direct algebraic manipulation shows: $\\tilde{u}\\Delta\\rho + \\tilde{\\rho}\\Delta u = \\tilde{u}(\\rho_{\\mathrm{R}}-\\rho_{\\mathrm{L}}) + \\sqrt{\\rho_{\\mathrm{L}}\\rho_{\\mathrm{R}}}(u_{\\mathrm{R}}-u_{\\mathrm{L}}) = \\Delta(\\rho u)$.\n2.  $\\Delta(\\rho u^2) = 2\\tilde{u}\\Delta(\\rho u) - \\tilde{u}^2\\Delta\\rho$.\n    Proof: $2\\tilde{u}\\Delta(\\rho u) - \\tilde{u}^2\\Delta\\rho = \\tilde{u}(2\\Delta(\\rho u) - \\tilde{u}\\Delta\\rho)$. The term in parentheses becomes\n    $2(S_{\\mathrm{R}}^2 u_{\\mathrm{R}} - S_{\\mathrm{L}}^2 u_{\\mathrm{L}}) - \\frac{S_{\\mathrm{L}}u_{\\mathrm{L}}+S_{\\mathrm{R}}u_{\\mathrm{R}}}{S_{\\mathrm{L}}+S_{\\mathrm{R}}}(S_{\\mathrm{R}}^2-S_{\\mathrm{L}}^2) = (S_{\\mathrm{L}}+S_{\\mathrm{R}})(S_{\\mathrm{R}}u_{\\mathrm{R}} - S_{\\mathrm{L}}u_{\\mathrm{L}})$.\n    Multiplying by $\\tilde{u}$ gives $(S_{\\mathrm{L}}u_{\\mathrm{L}}+S_{\\mathrm{R}}u_{\\mathrm{R}})(S_{\\mathrm{R}}u_{\\mathrm{R}} - S_{\\mathrm{L}}u_{\\mathrm{L}}) = S_{\\mathrm{R}}^2 u_{\\mathrm{R}}^2 - S_{\\mathrm{L}}^2 u_{\\mathrm{L}}^2 = \\Delta(\\rho u^2)$.\n3.  $\\Delta(\\rho uH) = \\tilde{u}\\Delta(\\rho H) + \\tilde{H}\\Delta(\\rho u) - \\tilde{u}\\tilde{H}\\Delta\\rho$. This can be proven with similar (though lengthier) algebraic steps.\n\n**Verification of the Roe Property:** We check $\\Delta\\boldsymbol{f} = \\tilde{\\boldsymbol{A}}\\Delta\\boldsymbol{q}$ row by row.\n$\\Delta\\boldsymbol{q} = (\\Delta\\rho, \\Delta(\\rho u), \\Delta E)^{\\top} = (\\Delta q_1, \\Delta q_2, \\Delta q_3)^{\\top}$.\n$\\Delta\\boldsymbol{f} = (\\Delta(\\rho u), \\Delta(\\rho u^2+p), \\Delta(u(E+p)))^{\\top} = (\\Delta f_1, \\Delta f_2, \\Delta f_3)^{\\top}$.\n\n*   **Row 1:** $\\Delta f_1 = \\Delta(\\rho u) = \\Delta q_2$.\n    The first row of $\\tilde{\\boldsymbol{A}}\\Delta\\boldsymbol{q}$ is $0 \\cdot \\Delta q_1 + 1 \\cdot \\Delta q_2 + 0 \\cdot \\Delta q_3 = \\Delta q_2$. This is correct.\n\n*   **Row 2:** $\\Delta f_2 = \\Delta(\\rho u^2+p) = \\Delta(\\rho u^2) + \\Delta p$.\n    Using $p = (\\gamma-1)(E - \\frac{1}{2}\\rho u^2)$, we have $\\Delta p = (\\gamma-1)(\\Delta E - \\frac{1}{2}\\Delta(\\rho u^2))$.\n    So, $\\Delta f_2 = \\Delta(\\rho u^2) + (\\gamma-1)(\\Delta E - \\frac{1}{2}\\Delta(\\rho u^2)) = \\frac{3-\\gamma}{2}\\Delta(\\rho u^2) + (\\gamma-1)\\Delta E$.\n    The second row of $\\tilde{\\boldsymbol{A}}\\Delta\\boldsymbol{q}$ is $\\frac{\\gamma-3}{2}\\tilde{u}^2 \\Delta q_1 + (3-\\gamma)\\tilde{u} \\Delta q_2 + (\\gamma-1) \\Delta q_3$.\n    Equating the two expressions for $\\Delta f_2$, we must verify:\n    $\\frac{3-\\gamma}{2}\\Delta(\\rho u^2) = \\frac{\\gamma-3}{2}\\tilde{u}^2 \\Delta\\rho + (3-\\gamma)\\tilde{u}\\Delta(\\rho u)$.\n    Dividing by $\\frac{3-\\gamma}{2}$, this is exactly Identity 2: $\\Delta(\\rho u^2) = 2\\tilde{u}\\Delta(\\rho u) - \\tilde{u}^2 \\Delta\\rho$. This is correct.\n\n*   **Row 3:** $\\Delta f_3 = \\Delta(u(E+p)) = \\Delta(\\rho u H)$.\n    The third row of $\\tilde{\\boldsymbol{A}}\\Delta\\boldsymbol{q}$ is $\\tilde{u}(\\frac{\\gamma-1}{2}\\tilde{u}^2-\\tilde{H})\\Delta\\rho + (\\tilde{H} - (\\gamma-1)\\tilde{u}^2)\\Delta(\\rho u) + \\gamma\\tilde{u}\\Delta E$.\n    Let's rearrange this expression. From the relation for pressure, $\\Delta p = \\frac{\\gamma-1}{\\gamma}\\Delta(\\rho(H-u^2/2)) = \\frac{\\gamma-1}{\\gamma}(\\Delta(\\rho H)-\\frac{1}{2}\\Delta(\\rho u^2))$.\n    Also, $\\Delta E = \\frac{\\Delta p}{\\gamma-1} + \\frac{1}{2}\\Delta(\\rho u^2) = \\frac{1}{\\gamma}\\Delta(\\rho H) + \\frac{\\gamma-1}{2\\gamma}\\Delta(\\rho u^2)$.\n    Substitute this into the third row expression:\n    $= \\tilde{u}(\\frac{\\gamma-1}{2}\\tilde{u}^2-\\tilde{H})\\Delta\\rho + (\\tilde{H} - (\\gamma-1)\\tilde{u}^2)\\Delta(\\rho u) + \\gamma\\tilde{u}\\left( \\frac{1}{\\gamma}\\Delta(\\rho H) + \\frac{\\gamma-1}{2\\gamma}\\Delta(\\rho u^2) \\right)$\n    $= \\tilde{u}(\\frac{\\gamma-1}{2}\\tilde{u}^2-\\tilde{H})\\Delta\\rho + (\\tilde{H} - (\\gamma-1)\\tilde{u}^2)\\Delta(\\rho u) + \\tilde{u}\\Delta(\\rho H) + \\frac{\\gamma-1}{2}\\tilde{u}\\Delta(\\rho u^2)$.\n    Using Identity 2, $\\Delta(\\rho u^2) = 2\\tilde{u}\\Delta(\\rho u) - \\tilde{u}^2 \\Delta\\rho$:\n    $= \\tilde{u}\\Delta(\\rho H) + \\Delta\\rho\\left[\\tilde{u}(\\frac{\\gamma-1}{2}\\tilde{u}^2-\\tilde{H}) - \\frac{\\gamma-1}{2}\\tilde{u}^3\\right] + \\Delta(\\rho u)\\left[\\tilde{H} - (\\gamma-1)\\tilde{u}^2 + (\\gamma-1)\\tilde{u}^2\\right]$\n    $= \\tilde{u}\\Delta(\\rho H) + \\Delta\\rho[-\\tilde{u}\\tilde{H}] + \\Delta(\\rho u)[\\tilde{H}]$.\n    This is precisely Identity 3: $\\tilde{u}\\Delta(\\rho H) + \\tilde{H}\\Delta(\\rho u) - \\tilde{u}\\tilde{H}\\Delta\\rho = \\Delta(\\rho u H)$. This is correct.\n\n**Eigenvalues:**\nThe eigenvalues of the Roe matrix $\\tilde{\\boldsymbol{A}}$ are obtained by analogy with the eigenvalues of the true Jacobian $\\boldsymbol{A}(\\boldsymbol{q})$, which are $\\lambda_1=u-a$, $\\lambda_2=u$, $\\lambda_3=u+a$, where $a=\\sqrt{\\gamma p/\\rho}$ is the sound speed. Replacing the variables with their Roe-averaged counterparts gives the eigenvalues of $\\tilde{\\boldsymbol{A}}$:\n$$ \\tilde{\\lambda}_1 = \\tilde{u} - \\tilde{a}, \\quad \\tilde{\\lambda}_2 = \\tilde{u}, \\quad \\tilde{\\lambda}_3 = \\tilde{u} + \\tilde{a} $$\nThe Roe-averaged sound speed $\\tilde{a}$ is defined by\n$$ \\tilde{a}^2 = (\\gamma-1)\\left(\\tilde{H} - \\frac{1}{2}\\tilde{u}^2\\right) $$\nThis expression arises from requiring $\\tilde{a}^2 = \\gamma\\tilde{p}/\\tilde{\\rho}$ which can be shown to be consistent with the other definitions. The Roe-averaging procedure guarantees that $\\tilde{a}^2 > 0$ if the states L and R have positive pressure and density, thus ensuring the hyperbolicity of the linearized system.\n\n## Part B: Positivity-Preserving Limiter\n\nThe problem asks for the derivation of a condition on a scaling factor $\\theta$ to enforce positivity of pressure, and then to compute this factor for a specific case.\n\n**Derivation of the Quadratic Equation:**\nThe limited state at node 1 is given by $\\boldsymbol{U}_{1}^{\\mathrm{lim}} = \\bar{\\boldsymbol{U}} + \\theta(\\boldsymbol{U}_{1} - \\bar{\\boldsymbol{U}})$, where $\\theta \\in [0,1]$. This can be written as a convex combination: $\\boldsymbol{U}_{1}^{\\mathrm{lim}}(\\theta) = (1-\\theta)\\bar{\\boldsymbol{U}} + \\theta\\boldsymbol{U}_{1}$.\nThe components of the limited state vector $\\boldsymbol{U}_{1}^{\\mathrm{lim}}(\\theta) = (\\rho(\\theta), m(\\theta), E(\\theta))^{\\top}$ are:\n$$ \\rho(\\theta) = (1-\\theta)\\bar{\\rho} + \\theta\\rho_{1} $$\n$$ m(\\theta) = (1-\\theta)\\bar{m} + \\theta m_{1} $$\n$$ E(\\theta) = (1-\\theta)\\bar{E} + \\theta E_{1} $$\nThe pressure positivity constraint is $p(\\theta) \\ge 0$, where $p(\\theta) = (\\gamma-1)(E(\\theta) - \\frac{1}{2}\\frac{m(\\theta)^2}{\\rho(\\theta)})$. We set $p(\\theta)=0$ to find the boundary of the admissible region. Since $\\gamma > 1$, this requires\n$$ E(\\theta) - \\frac{1}{2}\\frac{m(\\theta)^2}{\\rho(\\theta)} = 0 $$\nAssuming $\\rho(\\theta)>0$, this is equivalent to $2E(\\theta)\\rho(\\theta) - m(\\theta)^2 = 0$.\nSubstituting the expressions for $\\rho(\\theta), m(\\theta), E(\\theta)$:\n$$ 2 \\left((1-\\theta)\\bar{E} + \\theta E_{1}\\right) \\left((1-\\theta)\\bar{\\rho} + \\theta\\rho_{1}\\right) - \\left((1-\\theta)\\bar{m} + \\theta m_{1}\\right)^2 = 0 $$\nThis is a quadratic equation in $\\theta$. Let's expand it in powers of $\\theta$:\n$$ (1-\\theta)^2 [2\\bar{E}\\bar{\\rho} - \\bar{m}^2] + \\theta(1-\\theta)[2(\\bar{E}\\rho_1 + E_1\\bar{\\rho}) - 2\\bar{m}m_1] + \\theta^2[2E_1\\rho_1 - m_1^2] = 0 $$\nLet $C_0 = 2\\bar{E}\\bar{\\rho} - \\bar{m}^2$, $C_1 = 2(\\bar{E}\\rho_1 + E_1\\bar{\\rho}) - 2\\bar{m}m_1$, and $C_2 = 2E_1\\rho_1 - m_1^2$. The equation is:\n$$ (1-2\\theta+\\theta^2)C_0 + (\\theta-\\theta^2)C_1 + \\theta^2 C_2 = 0 $$\nRearranging into the standard form $A\\theta^2 + B\\theta + C = 0$:\n$$ \\theta^2(C_0 - C_1 + C_2) + \\theta(-2C_0 + C_1) + C_0 = 0 $$\nThus, $A=C_0 - C_1 + C_2$, $B=-2C_0 + C_1$, and $C=C_0$.\n\n**Selection of $\\theta$:**\nThe coefficient $C=C_0$ is proportional to the numerator of the pressure of the cell-averaged state $\\bar{\\boldsymbol{U}}$. It is assumed that the cell average has positive pressure, so $C_0 > 0$. The value of the quadratic at $\\theta=1$ is $A(1)^2+B(1)+C = C_2$, which is proportional to the numerator of the pressure at the original nodal state $\\boldsymbol{U}_1$. The limiting procedure is invoked because this pressure is negative, so $C_2  0$.\nA continuous function that is positive at $\\theta=0$ and negative at $\\theta=1$ must have at least one root in the interval $(0,1)$.\nThe set of admissible states (with positive density and pressure) is convex. The trajectory of $\\boldsymbol{U}_1^{\\text{lim}}(\\theta)$ for $\\theta \\in [0,1]$ is a straight line from the admissible state $\\bar{\\boldsymbol{U}}$ to the non-physical state $\\boldsymbol{U}_1$. This line must cross the boundary of the admissible set exactly once in $(0,1)$. Therefore, the quadratic equation has a unique root $\\theta_p \\in (0,1)$.\nThe region where $p(\\theta) \\ge 0$ is the interval $[0, \\theta_p]$. The question asks for the minimal $\\theta \\in [0,1]$ such that $p(\\theta)=0$. This is precisely the root $\\theta_p$.\n\n**Concrete Calculation:**\nGiven $\\gamma=1.4$, $\\boldsymbol{U}_{1} = (0.05, 2.0, 39.75)^{\\top}$, and $\\boldsymbol{U}_{2} = (0.8, 4.0, 12.5)^{\\top}$.\nFirst, compute the cell average $\\bar{\\boldsymbol{U}}$:\n$$ \\bar{\\rho} = \\frac{0.05+0.8}{2} = 0.425 $$\n$$ \\bar{m} = \\frac{2.0+4.0}{2} = 3.0 $$\n$$ \\bar{E} = \\frac{39.75+12.5}{2} = 26.125 $$\nSo $\\bar{\\boldsymbol{U}} = (0.425, 3.0, 26.125)^{\\top}$.\nThe state at node 1 needs limiting because its pressure is negative: $p_1 = (1.4-1)(39.75 - \\frac{2.0^2}{2 \\times 0.05}) = 0.4(39.75 - 40) = -0.1$.\nThe state is modified as $\\boldsymbol{U}_1^{\\text{lim}}(\\theta) = \\bar{\\boldsymbol{U}} + \\theta(\\boldsymbol{U}_1 - \\bar{\\boldsymbol{U}})$. The components are:\n$$ \\rho(\\theta) = 0.425 + \\theta(0.05 - 0.425) = 0.425 - 0.375\\theta $$\n$$ m(\\theta) = 3.0 + \\theta(2.0 - 3.0) = 3.0 - \\theta $$\n$$ E(\\theta) = 26.125 + \\theta(39.75 - 26.125) = 26.125 + 13.625\\theta $$\nThe condition $p(\\theta)=0$ leads to $2E(\\theta)\\rho(\\theta) - m(\\theta)^2 = 0$.\n$$ 2(26.125 + 13.625\\theta)(0.425 - 0.375\\theta) - (3.0 - \\theta)^2 = 0 $$\nExpanding the terms:\n$2(26.125 \\times 0.425 - 26.125 \\times 0.375\\theta + 13.625 \\times 0.425\\theta - 13.625 \\times 0.375\\theta^2) - (9 - 6\\theta + \\theta^2) = 0$\n$2(11.103125 - 9.796875\\theta + 5.790625\\theta - 5.109375\\theta^2) - (9 - 6\\theta + \\theta^2) = 0$\n$2(11.103125 - 4.00625\\theta - 5.109375\\theta^2) - 9 + 6\\theta - \\theta^2 = 0$\n$22.20625 - 8.0125\\theta - 10.21875\\theta^2 - 9 + 6\\theta - \\theta^2 = 0$\nCollecting terms for the quadratic equation in $\\theta$:\n$$ (-10.21875 - 1)\\theta^2 + (-8.0125 + 6)\\theta + (22.20625 - 9) = 0 $$\n$$ -11.21875\\theta^2 - 2.0125\\theta + 13.20625 = 0 $$\nMultiplying by $-1$:\n$$ 11.21875\\theta^2 + 2.0125\\theta - 13.20625 = 0 $$\nWe solve for $\\theta$ using the quadratic formula, $\\theta = \\frac{-b \\pm \\sqrt{b^2-4ac}}{2a}$:\n$$ \\theta = \\frac{-2.0125 \\pm \\sqrt{2.0125^2 - 4(11.21875)(-13.20625)}}{2(11.21875)} $$\n$$ \\theta = \\frac{-2.0125 \\pm \\sqrt{4.05015625 + 592.6546875}}{22.4375} $$\n$$ \\theta = \\frac{-2.0125 \\pm \\sqrt{596.70484375}}{22.4375} $$\n$$ \\theta = \\frac{-2.0125 \\pm 24.42754274}{22.4375} $$\nWe seek the root in $[0,1]$. The positive solution is:\n$$ \\theta = \\frac{-2.0125 + 24.42754274}{22.4375} = \\frac{22.41504274}{22.4375} \\approx 0.999000... $$\nThe other root is negative ($\\approx -1.178$) and is not physically relevant.\nRounding to four significant figures, we get $\\theta = 0.9990$.", "answer": "$$\n\\boxed{0.9990}\n$$", "id": "3376511"}, {"introduction": "While explicit time-stepping schemes are simple to implement, they can be prohibitively expensive for problems with stiffness, such as flows with high viscosity or fine mesh resolution. Implicit methods offer a path to larger time steps, but require solving a large nonlinear system at each step. This practice [@problem_id:3376455] delves into the core of modern implicit solvers by asking you to derive the convective and viscous flux Jacobians for the 2D Navier-Stokes equations. Understanding these components is crucial for implementing efficient Newton-Krylov solvers, which are a cornerstone of advanced CFD.", "problem": "Consider the two-dimensional compressible Navier–Stokes equations in conservative form for an ideal gas with constant ratio of specific heats $ \\gamma $, specific gas constant $ R $, constant dynamic viscosity $ \\mu $, and constant thermal conductivity $ \\kappa $. The conservative state is $ U = [ \\rho, \\rho u, \\rho v, \\rho E ]^{\\top} $, where $ \\rho $ is density, $ u $ and $ v $ are velocity components, and $ E $ is the total specific energy. The pressure is given by $ p = (\\gamma - 1)\\left( \\rho E - \\frac{1}{2}\\rho (u^{2} + v^{2}) \\right) $, with $ H = E + \\frac{p}{\\rho} $ the specific total enthalpy. The convective flux in direction $ x $ is $ F^{c}_{x}(U) = [ \\rho u,\\ \\rho u^{2} + p,\\ \\rho u v,\\ u(\\rho E + p) ]^{\\top} $, and analogously in direction $ y $. The viscous stress tensor uses a Newtonian fluid with Stokes’ hypothesis, $ \\tau = \\mu \\left( \\nabla \\mathbf{v} + \\nabla \\mathbf{v}^{\\top} - \\frac{2}{3}(\\nabla \\cdot \\mathbf{v}) I \\right) $, where $ \\mathbf{v} = (u,v) $, and the heat flux is $ \\mathbf{q} = - \\kappa \\nabla T $. The temperature is $ T = \\frac{p}{\\rho R} = \\frac{\\gamma - 1}{R}\\left( E - \\frac{1}{2}(u^{2} + v^{2}) \\right) $. Let $ \\mathbf{n} = (n_{x}, n_{y}) $ be a unit normal.\n\n- Using only these definitions and relations, derive the normal convective Jacobian $ A^{c}_{n}(U) = \\dfrac{\\partial}{\\partial U}\\big( F^{c}(U) \\cdot \\mathbf{n} \\big) \\in \\mathbb{R}^{4 \\times 4} $, where $ F^{c}(U) \\cdot \\mathbf{n} = n_{x} F^{c}_{x}(U) + n_{y} F^{c}_{y}(U) $.\n\n- Derive the normal viscous flux Jacobian with respect to the state gradients, $ K^{v}_{n}(U) = \\dfrac{\\partial}{\\partial (\\nabla U)}\\big( F^{v}(U, \\nabla U) \\cdot \\mathbf{n} \\big) $, viewed as the $ 4 \\times 8 $ matrix that maps the stacked gradient vector $ [ \\partial_{x}\\rho,\\ \\partial_{x}(\\rho u),\\ \\partial_{x}(\\rho v),\\ \\partial_{x}(\\rho E),\\ \\partial_{y}\\rho,\\ \\partial_{y}(\\rho u),\\ \\partial_{y}(\\rho v),\\ \\partial_{y}(\\rho E) ]^{\\top} $ to $ F^{v} \\cdot \\mathbf{n} $, at a fixed state $ U $. Write the entries of $ K^{v}_{n}(U) $ explicitly in terms of $ \\rho, u, v, E, \\gamma, R, \\mu, \\kappa, n_{x}, n_{y} $.\n\n- In one paragraph, explain how $ A^{c}_{n}(U) $ and $ K^{v}_{n}(U) $ are used to form the element-local and face contributions to the Jacobian of the semi-discrete Discontinuous Galerkin residual under an implicit backward Euler time discretization, and how this Jacobian is applied in a Newton–Krylov method (matrix-free action) including the role of numerical fluxes at interfaces.\n\nFinally, consider the uniform state $ \\rho = 1.18\\ \\mathrm{kg/m^{3}} $, $ u = 210\\ \\mathrm{m/s} $, $ v = -35\\ \\mathrm{m/s} $, $ p = 101325\\ \\mathrm{Pa} $, with $ \\gamma = 1.4 $, and a unit normal $ \\mathbf{n} = (0.6, 0.8) $. Compute the spectral radius of $ A^{c}_{n}(U) $ at this state, i.e., $ \\rho(A^{c}_{n}) = |u_{n}| + a $, where $ u_{n} = u n_{x} + v n_{y} $ and the speed of sound $ a = \\sqrt{\\gamma p / \\rho} $. Express your final numerical answer in $ \\mathrm{m/s} $ and round to four significant figures.", "solution": "The problem asks for several derivations related to the Jacobians of the compressible Navier-Stokes equations, an explanation of their use in a Discontinuous Galerkin (DG) method, and a numerical calculation. The problem is scientifically grounded, well-posed, objective, and contains all necessary information for a unique solution.\n\nFirst, we derive the normal convective Jacobian $ A^{c}_{n}(U) = \\dfrac{\\partial}{\\partial U}\\big( F^{c}(U) \\cdot \\mathbf{n} \\big) $.\nLet the state vector be $ U = [U_{1}, U_{2}, U_{3}, U_{4}]^{\\top} = [\\rho, \\rho u, \\rho v, \\rho E]^{\\top} $. The primitive variables can be expressed in terms of the conservative variables: $ \\rho = U_{1} $, $ u=U_{2}/U_{1} $, $ v=U_{3}/U_{1} $, and $ E=U_{4}/U_{1} $. The pressure $ p $ is given by\n$$ p = (\\gamma - 1)\\left( \\rho E - \\frac{1}{2}\\rho (u^{2} + v^{2}) \\right) = (\\gamma - 1)\\left( U_{4} - \\frac{U_{2}^{2} + U_{3}^{2}}{2U_{1}} \\right) $$\nThe normal convective flux is $ F^{c}_{n} = n_{x} F^{c}_{x} + n_{y} F^{c}_{y} $. Let $ u_{n} = u n_{x} + v n_{y} $.\n$$ F^{c}_{n}(U) = \\begin{pmatrix} \\rho u_{n} \\\\ \\rho u u_{n} + p n_{x} \\\\ \\rho v u_{n} + p n_{y} \\\\ (\\rho E + p) u_{n} \\end{pmatrix} $$\nThe Jacobian $ A^{c}_{n} $ is a $ 4 \\times 4 $ matrix whose entries are $ (A^{c}_{n})_{ij} = \\dfrac{\\partial (F^{c}_{n})_{i}}{\\partial U_{j}} $. The derivation is performed by applying the chain rule, for instance, $ \\dfrac{\\partial (F^{c}_{n})_{i}}{\\partial U_{j}} = \\sum_{k=1}^{4} \\dfrac{\\partial (F^{c}_{n})_{i}}{\\partial W_{k}} \\dfrac{\\partial W_{k}}{\\partial U_{j}} $, where $ W=[\\rho, u, v, p]^{\\top} $ is a set of primitive variables. The required partial derivatives are:\n$ \\dfrac{\\partial u}{\\partial U} = [-\\frac{u}{\\rho}, \\frac{1}{\\rho}, 0, 0] $, $ \\dfrac{\\partial v}{\\partial U} = [-\\frac{v}{\\rho}, 0, \\frac{1}{\\rho}, 0] $, and $ \\dfrac{\\partial p}{\\partial U} = [(\\gamma-1)\\frac{u^{2}+v^{2}}{2}, -(\\gamma-1)u, -(\\gamma-1)v, \\gamma-1] $.\nLet's define $ \\phi^{2} = \\frac{\\gamma-1}{2}(u^{2}+v^{2}) $ and the total specific enthalpy $ H = E + \\frac{p}{\\rho} $. After carrying out the differentiation, the resulting Jacobian matrix is:\n$$ A^{c}_{n}(U) = \\begin{pmatrix}\n0  n_{x}  n_{y}  0 \\\\\nn_{x}(\\phi^{2}-u^{2}) - n_{y}uv  u_{n} + (2-\\gamma)u n_{x}  u n_{y} - (\\gamma-1)v n_{x}  (\\gamma-1)n_{x} \\\\\nn_{y}(\\phi^{2}-v^{2}) - n_{x}uv  v n_{x} - (\\gamma-1)u n_{y}  u_{n} + (2-\\gamma)v n_{y}  (\\gamma-1)n_{y} \\\\\nu_{n}(\\phi^{2}-H)  H n_{x} - (\\gamma-1)u u_{n}  H n_{y} - (\\gamma-1)v u_{n}  \\gamma u_{n}\n\\end{pmatrix} $$\n\nSecond, we derive the normal viscous flux Jacobian with respect to the state gradients, $ K^{v}_{n}(U) = \\dfrac{\\partial}{\\partial (\\nabla U)}\\big( F^{v}(U, \\nabla U) \\cdot \\mathbf{n} \\big) $.\nThe normal viscous flux is $ F^{v}_{n} = n_{x} F^{v}_{x} + n_{y} F^{v}_{y} $. Using the definitions for the viscous stress tensor $ \\tau $ and heat flux $ \\mathbf{q} $, we have:\n$$ F^{v}_{n} = \\begin{pmatrix} 0 \\\\ n_{x}\\tau_{xx} + n_{y}\\tau_{yx} \\\\ n_{x}\\tau_{xy} + n_{y}\\tau_{yy} \\\\ u(n_{x}\\tau_{xx} + n_{y}\\tau_{yx}) + v(n_{x}\\tau_{xy} + n_{y}\\tau_{yy}) - (n_{x}q_{x} + n_{y}q_{y}) \\end{pmatrix} $$\nThe viscous flux is linear in the gradients of primitive variables (velocity components $ u, v $ and temperature $ T $). These gradients must be expressed in terms of the gradients of the conservative state $ \\nabla U $. For a fixed state $ U $, this relationship is linear. For example, $ \\partial_{x} u = \\frac{1}{\\rho}\\partial_{x}(\\rho u) - \\frac{u}{\\rho}\\partial_{x}\\rho = \\frac{1}{U_{1}}\\partial_{x}U_{2} - \\frac{u}{U_{1}}\\partial_{x}U_{1} $. Similarly for $ \\partial_{y}u, \\partial_{x}v, \\partial_{y}v $. The temperature gradient is:\n$$ \\nabla T = \\frac{\\gamma-1}{R\\rho} \\left[ (u^{2}+v^{2}-E)\\nabla\\rho - u\\nabla(\\rho u) - v\\nabla(\\rho v) + \\nabla(\\rho E) \\right] $$\nThe problem asks for the $ 4 \\times 8 $ matrix $ K^{v}_{n} $ that maps the stacked gradient vector $ [\\partial_{x}U^{\\top}, \\partial_{y}U^{\\top}]^{\\top} $ to $ F^{v}_{n} $. Let $ C_{\\mu} = \\mu/\\rho $ and $ C_{\\kappa}=\\frac{\\kappa(\\gamma-1)}{R\\rho} $. The entries of $ K^{v}_{n} $ are computed by substituting the expressions for primitive variable gradients and collecting coefficients for each component of $ \\nabla U $.\n\nThe resulting matrix $ K^{v}_{n} $ is:\n$ K^{v}_{n} = \\begin{pmatrix} K^{v,x}  K^{v,y} \\end{pmatrix} $, where $ K^{v,x} $ and $ K^{v,y} $ are $ 4 \\times 4 $ matrices.\nThe first row is zero: $ (K^{v}_{n})_{1,j} = 0 $ for $ j=1, \\dots, 8 $.\n\nFor the second row $(F^{v}_{n,2} = n_x\\tau_{xx} + n_y\\tau_{xy})$:\n$ (K_{n}^{v})_{2,1} = -C_{\\mu}(\\frac{4}{3}n_{x}u + n_{y}v) $\n$ (K_{n}^{v})_{2,2} = C_{\\mu}\\frac{4}{3}n_{x} $\n$ (K_{n}^{v})_{2,3} = C_{\\mu}n_{y} $\n$ (K_{n}^{v})_{2,4} = 0 $\n$ (K_{n}^{v})_{2,5} = C_{\\mu}(\\frac{2}{3}n_{x}v - n_{y}u) $\n$ (K_{n}^{v})_{2,6} = C_{\\mu}n_{y} $\n$ (K_{n}^{v})_{2,7} = -C_{\\mu}\\frac{2}{3}n_{x} $\n$ (K_{n}^{v})_{2,8} = 0 $\n\nFor the third row $(F^{v}_{n,3} = n_x\\tau_{xy} + n_y\\tau_{yy})$:\n$ (K_{n}^{v})_{3,1} = C_{\\mu}(-n_{x}v + \\frac{2}{3}n_{y}u) $\n$ (K_{n}^{v})_{3,2} = -C_{\\mu}\\frac{2}{3}n_{y} $\n$ (K_{n}^{v})_{3,3} = C_{\\mu}n_{x} $\n$ (K_{n}^{v})_{3,4} = 0 $\n$ (K_{n}^{v})_{3,5} = -C_{\\mu}(n_{x}u + \\frac{4}{3}n_{y}v) $\n$ (K_{n}^{v})_{3,6} = C_{\\mu}n_{x} $\n$ (K_{n}^{v})_{3,7} = C_{\\mu}\\frac{4}{3}n_{y} $\n$ (K_{n}^{v})_{3,8} = 0 $\n\nFor the fourth row, let $ E_{k} = \\frac{1}{2}(u^{2}+v^{2}) $. The contributions are from the stress tensor work and the heat flux. The coefficients are a sum of terms from both parts.\n$ (K_{n}^{v})_{4,j} = u(K_{n}^{v})_{2,j} + v(K_{n}^{v})_{3,j} - \\frac{\\partial(n_x q_x + n_y q_y)}{\\partial (\\nabla U)_j} $.\nThe heat flux parts are:\n$ (K_{n}^{v})_{4,1} = u(K_{n}^{v})_{2,1} + v(K_{n}^{v})_{3,1} + C_{\\kappa}n_{x}(u^{2}+v^{2}-E) $\n$ (K_{n}^{v})_{4,2} = u(K_{n}^{v})_{2,2} + v(K_{n}^{v})_{3,2} - C_{\\kappa}n_{x}u $\n$ (K_{n}^{v})_{4,3} = u(K_{n}^{v})_{2,3} + v(K_{n}^{v})_{3,3} - C_{\\kappa}n_{x}v $\n$ (K_{n}^{v})_{4,4} = C_{\\kappa}n_{x} $\n$ (K_{n}^{v})_{4,5} = u(K_{n}^{v})_{2,5} + v(K_{n}^{v})_{3,5} + C_{\\kappa}n_{y}(u^{2}+v^{2}-E) $\n$ (K_{n}^{v})_{4,6} = u(K_{n}^{v})_{2,6} + v(K_{n}^{v})_{3,6} - C_{\\kappa}n_{y}u $\n$ (K_{n}^{v})_{4,7} = u(K_{n}^{v})_{2,7} + v(K_{n}^{v})_{3,7} - C_{\\kappa}n_{y}v $\n$ (K_{n}^{v})_{4,8} = C_{\\kappa}n_{y} $\n\nThird, we explain the role of $ A^{c}_{n} $ and $ K^{v}_{n} $ in an implicit DG method for the Navier-Stokes equations.\nThe semi-discrete DG formulation results in a system of ordinary differential equations, $ M \\frac{d\\mathbf{U}}{dt} = \\mathcal{R}(\\mathbf{U}) $, where $ \\mathbf{U} $ is the vector of all degrees of freedom for the discrete solution $ U_{h} $ and $ M $ is the mass matrix. Applying an implicit time integration scheme, such as Backward Euler, yields a nonlinear algebraic system at each time step $ n+1 $: $ \\mathbf{G}(\\mathbf{U}^{n+1}) = \\mathbf{U}^{n+1} - \\mathbf{U}^{n} - \\Delta t M^{-1}\\mathcal{R}(\\mathbf{U}^{n+1}) = \\mathbf{0} $. This system is typically solved using Newton's method, which requires solving a linear system $ J_{\\mathbf{G}} \\delta\\mathbf{U} = -\\mathbf{G} $ at each iteration, where $ J_{\\mathbf{G}} = I - \\Delta t M^{-1}\\frac{\\partial\\mathcal{R}}{\\partial\\mathbf{U}} $ is the system Jacobian. For large-scale problems, this linear system is solved with a Krylov subspace method (e.g., GMRES), which avoids forming the dense matrix $ J_{\\mathbf{G}} $ explicitly. Instead, it only requires the action of the Jacobian on a vector, $ w \\mapsto J_{\\mathbf{G}} w $, a so-called matrix-free approach. The Jacobian of the residual, $ \\frac{\\partial\\mathcal{R}}{\\partial\\mathbf{U}} $, consists of contributions from element-local volume integrals and face integrals coupling neighboring elements. The Jacobian of the face integral terms, which involve numerical fluxes for convective ($ \\hat{F}_{n}^{c} $) and viscous ($ \\hat{F}_{n}^{v} $) terms, is where $ A^{c}_{n} $ and $ K^{v}_{n} $ are essential. The linearization of the numerical convective flux, $ \\frac{\\partial \\hat{F}_{n}^{c}}{\\partial U} $, is built using the normal convective Jacobians $ A^{c}_{n} $ evaluated at the states on both sides of the interface. Similarly, the linearization of the numerical viscous flux, e.g., using the BR2 scheme, involves derivatives with respect to the state, $ U $, and its gradient, $ \\nabla U $. The derivative $ \\frac{\\partial \\hat{F}_{n}^{v}}{\\partial (\\nabla U)} $ is constructed from the matrix $ K^{v}_{n} $. Thus, $ A^{c}_{n} $ and $ K^{v}_{n} $ are fundamental building blocks for assembling the action of the full system Jacobian required by the Newton-Krylov solver.\n\nFinally, we compute the spectral radius of $ A^{c}_{n}(U) $ for the given state.\nThe data are: $ \\rho = 1.18\\ \\mathrm{kg/m^{3}} $, $ u = 210\\ \\mathrm{m/s} $, $ v = -35\\ \\mathrm{m/s} $, $ p = 101325\\ \\mathrm{Pa} $, $ \\gamma = 1.4 $, and $ \\mathbf{n} = (0.6, 0.8) $.\nThe eigenvalues of $ A^{c}_{n}(U) $ are $ u_{n}, u_{n}, u_{n}+a, u_{n}-a $, where $ u_{n} $ is the normal velocity and $ a $ is the speed of sound. The spectral radius is the maximum of the absolute values of the eigenvalues, given by $ \\rho(A^{c}_{n}) = |u_{n}| + a $.\nFirst, we compute the normal velocity $ u_{n} $:\n$$ u_{n} = u n_{x} + v n_{y} = (210)(0.6) + (-35)(0.8) = 126 - 28 = 98\\ \\mathrm{m/s} $$\nNext, we compute the speed of sound $ a $:\n$$ a = \\sqrt{\\frac{\\gamma p}{\\rho}} = \\sqrt{\\frac{(1.4)(101325)}{1.18}} \\approx \\sqrt{120216.1}\\ \\mathrm{m/s} \\approx 346.722\\ \\mathrm{m/s} $$\nThe spectral radius is then:\n$$ \\rho(A^{c}_{n}) = |u_{n}| + a = |98| + 346.722 = 444.722\\ \\mathrm{m/s} $$\nRounding to four significant figures, the result is $ 444.7\\ \\mathrm{m/s} $.", "answer": "$$ \\boxed{444.7} $$", "id": "3376455"}]}