{"hands_on_practices": [{"introduction": "The algebraic structure of a Discontinuous Galerkin method is determined by its weak formulation and the choice of numerical fluxes. This exercise provides hands-on practice in assembling the local matrices that arise from interface flux terms, connecting the abstract definition of a numerical flux to its concrete algebraic representation. By explicitly computing the penalty block, you will confirm the crucial property of symmetry that arises from a symmetric interior penalty flux choice, which is essential for solving many elliptic problems efficiently. [@problem_id:3405412]", "problem": "Consider the one-dimensional Poisson equation on a two-element patch written in the first-order Local Discontinuous Galerkin (LDG) form:\n$$\nq = u_x, \\qquad -q_x = f,\n$$\non the domain $\\Omega = [0,2h]$ partitioned into elements $K^{-} = [0,h]$ and $K^{+} = [h,2h]$. On each element, approximate both $u$ and $q$ in the same polynomial space of degree $p=1$, spanned by the modal Legendre basis on the reference element $\\hat{K} = [-1,1]$,\n$$\n\\phi_0(\\xi) = \\frac{1}{\\sqrt{2}}, \\qquad \\phi_1(\\xi) = \\sqrt{\\frac{3}{2}}\\,\\xi,\n$$\nunder the affine map $x = x_c + \\frac{h}{2}\\,\\xi$ from $\\hat{K}$ to each physical element. At the internal interface $F = \\{x=h\\}$, adopt the outward normal convention $n^{-}=+1$ on $K^{-}$ and $n^{+}=-1$ on $K^{+}$. For any scalar trace $w$, define the average and jump by\n$$\n\\{w\\} = \\frac{w^{-} + w^{+}}{2}, \\qquad [w] = w^{-} - w^{+},\n$$\nwhere superscripts $(-)$ and $(+)$ denote traces from $K^{-}$ and $K^{+}$, respectively.\n\nFormulate the LDG weak form on each element by integration by parts:\n- Multiply $q = u_x$ by a test function $r$ and integrate by parts on each element to obtain the boundary term $\\int_{\\partial K} \\hat{u}\\, r\\, n\\, ds$.\n- Multiply $-q_x = f$ by a test function $v$ and integrate by parts on each element to obtain the boundary term $-\\int_{\\partial K} \\hat{q}\\, n\\, v\\, ds$.\n\nOn the interior face $F$ adopt the symmetric interior penalty (symmetric LDG) numerical fluxes for this first-order LDG system:\n$$\n\\hat{u} = \\{u\\}, \\qquad \\hat{q}\\,n = \\{q\\} - \\sigma\\,[u],\n$$\nwith a symmetric, element-independent penalty parameter $\\sigma > 0$.\n\nUsing these definitions:\n1. Assemble explicitly the $F$-local interface flux contribution matrices, in terms of the traces of basis functions at $\\xi=\\pm 1$, for the three contributions:\n   - the $u$-to-$r$ consistency block arising from $\\int_{F} \\hat{u}\\,[r]\\,ds$,\n   - the $q$-to-$v$ consistency block arising from $-\\int_{F} \\{q\\}\\,[v]\\,ds$,\n   - the $u$-to-$v$ penalty block arising from $+\\int_{F} \\sigma\\,[u]\\,[v]\\,ds$.\n   Use the ordering of degrees of freedom on the face given by the vector of $u$ coefficients $\\big(u_0^{-},u_1^{-},u_0^{+},u_1^{+}\\big)$ and similarly for $q$, and the corresponding ordering of test function coefficients for $r$ and $v$.\n2. Focus on the $u$-to-$v$ penalty block matrix, denote it by $P(\\sigma)$. Confirm its symmetry under the symmetric penalty choice by quantifying the symmetry defect via the Frobenius norm of its skew-symmetric part,\n$$\nS(\\sigma) = \\frac{1}{2}\\left(P(\\sigma) - P(\\sigma)^{\\top}\\right), \\qquad \\|S(\\sigma)\\|_{F}.\n$$\n\nWhat is the value of $\\|S(\\sigma)\\|_{F}$? Give your final answer as a single exact number. No rounding is required and no units are associated with this quantity.", "solution": "The problem asks for the Frobenius norm of the skew-symmetric part of the penalty matrix, $P(\\sigma)$, arising from the interface term in a Local Discontinuous Galerkin (LDG) formulation of the one-dimensional Poisson equation.\n\nFirst, we establish the necessary components for the calculation. The approximation for the unknown field $u$ and the test function $v$ on the two elements $K^{-} = [0,h]$ and $K^{+} = [h,2h]$ is done in a polynomial space of degree $p=1$. The basis functions on the reference element $\\hat{K} = [-1,1]$ are given as $\\phi_0(\\xi) = \\frac{1}{\\sqrt{2}}$ and $\\phi_1(\\xi) = \\sqrt{\\frac{3}{2}}\\,\\xi$.\n\nThe degrees of freedom (DoFs) for the field $u$ are the coefficients in the basis expansion on each element: $(u_0^{-}, u_1^{-})$ for $K^{-}$ and $(u_0^{+}, u_1^{+})$ for $K^{+}$. The full vector of coefficients for $u$ across the two-element patch is $\\mathbf{U} = (u_0^{-}, u_1^{-}, u_0^{+}, u_1^{+})^{\\top}$. Similarly, for the test function $v$, the coefficient vector is $\\mathbf{V} = (v_0^{-}, v_1^{-}, v_0^{+}, v_1^{+})^{\\top}$.\n\nThe functions $u$ and $v$ on each physical element are given by:\nOn $K^{-}$, where $x = \\frac{h}{2} + \\frac{h}{2}\\xi$:\n$u(x)|_{K^{-}} = u_h^{-}(\\xi) = u_0^{-} \\phi_0(\\xi) + u_1^{-} \\phi_1(\\xi)$\n$v(x)|_{K^{-}} = v_h^{-}(\\xi) = v_0^{-} \\phi_0(\\xi) + v_1^{-} \\phi_1(\\xi)$\n\nOn $K^{+}$, where $x = \\frac{3h}{2} + \\frac{h}{2}\\xi$:\n$u(x)|_{K^{+}} = u_h^{+}(\\xi) = u_0^{+} \\phi_0(\\xi) + u_1^{+} \\phi_1(\\xi)$\n$v(x)|_{K^{+}} = v_h^{+}(\\xi) = v_0^{+} \\phi_0(\\xi) + v_1^{+} \\phi_1(\\xi)$\n\nThe problem specifies the penalty term contribution to the weak form is $I_p = \\int_{F} \\sigma\\,[u]\\,[v]\\,ds$. The interface $F$ is the point $\\{x=h\\}$. For a one-dimensional problem, this integral is simply the evaluation of the integrand at the point, so $I_p = \\sigma [u][v] |_{x=h}$.\n\nThe jump operator is defined as $[w] = w^{-} - w^{+}$, where $w^{-}$ is the trace from $K^{-}$ and $w^{+}$ is the trace from $K^{+}$. The interface $x=h$ corresponds to $\\xi=1$ on $K^{-}$ and $\\xi=-1$ on $K^{+}$.\nFirst, we evaluate the basis functions at these points:\n$\\phi_0(1) = \\frac{1}{\\sqrt{2}}$\n$\\phi_1(1) = \\sqrt{\\frac{3}{2}}$\n$\\phi_0(-1) = \\frac{1}{\\sqrt{2}}$\n$\\phi_1(-1) = -\\sqrt{\\frac{3}{2}}$\n\nThe traces of $u$ at $x=h$ are:\n$u^{-} = u_h^{-}(\\xi=1) = u_0^{-} \\phi_0(1) + u_1^{-} \\phi_1(1) = u_0^{-} \\frac{1}{\\sqrt{2}} + u_1^{-} \\sqrt{\\frac{3}{2}}$\n$u^{+} = u_h^{+}(\\xi=-1) = u_0^{+} \\phi_0(-1) + u_1^{+} \\phi_1(-1) = u_0^{+} \\frac{1}{\\sqrt{2}} - u_1^{+} \\sqrt{\\frac{3}{2}}$\n\nThe jump $[u]$ is therefore:\n$[u] = u^{-} - u^{+} = \\left(u_0^{-} \\frac{1}{\\sqrt{2}} + u_1^{-} \\sqrt{\\frac{3}{2}}\\right) - \\left(u_0^{+} \\frac{1}{\\sqrt{2}} - u_1^{+} \\sqrt{\\frac{3}{2}}\\right)$\n$[u] = u_0^{-} \\frac{1}{\\sqrt{2}} + u_1^{-} \\sqrt{\\frac{3}{2}} - u_0^{+} \\frac{1}{\\sqrt{2}} + u_1^{+} \\sqrt{\\frac{3}{2}}$\n\nThis can be written as a dot product $\\mathbf{b}^{\\top}\\mathbf{U}$, where $\\mathbf{U} = (u_0^{-}, u_1^{-}, u_0^{+}, u_1^{+})^{\\top}$ and $\\mathbf{b}$ is a vector of the basis function trace values:\n$\\mathbf{b} = \\begin{pmatrix} \\phi_0(1) \\\\ \\phi_1(1) \\\\ -\\phi_0(-1) \\\\ -\\phi_1(-1) \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{\\sqrt{2}} \\\\ \\sqrt{\\frac{3}{2}} \\\\ -\\frac{1}{\\sqrt{2}} \\\\ \\sqrt{\\frac{3}{2}} \\end{pmatrix}$\n\nSo, $[u] = \\mathbf{b}^{\\top}\\mathbf{U}$. Similarly, for the test function $v$, $[v] = \\mathbf{b}^{\\top}\\mathbf{V}$.\n\nThe penalty term $I_p$ can now be expressed in terms of the coefficient vectors:\n$I_p = \\sigma [u][v] = \\sigma (\\mathbf{b}^{\\top}\\mathbf{U}) (\\mathbf{b}^{\\top}\\mathbf{V})$\nSince the terms are scalars, we can rearrange:\n$I_p = \\sigma (\\mathbf{V}^{\\top}\\mathbf{b}) (\\mathbf{b}^{\\top}\\mathbf{U}) = \\mathbf{V}^{\\top} (\\sigma\\,\\mathbf{b}\\mathbf{b}^{\\top}) \\mathbf{U}$\n\nThe matrix of this bilinear form, which we denote $P(\\sigma)$, is the quantity in the middle:\n$P(\\sigma) = \\sigma\\,\\mathbf{b}\\mathbf{b}^{\\top}$\n\nThis is the outer product of the vector $\\mathbf{b}$ with its transpose, scaled by $\\sigma$. Let's compute this $4 \\times 4$ matrix explicitly:\n$P(\\sigma) = \\sigma \\begin{pmatrix} \\frac{1}{\\sqrt{2}} \\\\ \\sqrt{\\frac{3}{2}} \\\\ -\\frac{1}{\\sqrt{2}} \\\\ \\sqrt{\\frac{3}{2}} \\end{pmatrix} \\begin{pmatrix} \\frac{1}{\\sqrt{2}} & \\sqrt{\\frac{3}{2}} & -\\frac{1}{\\sqrt{2}} & \\sqrt{\\frac{3}{2}} \\end{pmatrix}$\n\n$P(\\sigma) = \\sigma \\begin{pmatrix}\n\\frac{1}{2} & \\frac{\\sqrt{3}}{2} & -\\frac{1}{2} & \\frac{\\sqrt{3}}{2} \\\\\n\\frac{\\sqrt{3}}{2} & \\frac{3}{2} & -\\frac{\\sqrt{3}}{2} & \\frac{3}{2} \\\\\n-\\frac{1}{2} & -\\frac{\\sqrt{3}}{2} & \\frac{1}{2} & -\\frac{\\sqrt{3}}{2} \\\\\n\\frac{\\sqrt{3}}{2} & \\frac{3}{2} & -\\frac{\\sqrt{3}}{2} & \\frac{3}{2}\n\\end{pmatrix}$\n\nThe problem asks us to quantify the symmetry defect of this matrix. A matrix $A$ is symmetric if $A = A^{\\top}$. The outer product of any real column vector $\\mathbf{b}$ with its transpose, $\\mathbf{b}\\mathbf{b}^{\\top}$, always results in a symmetric matrix. Let $A = \\mathbf{b}\\mathbf{b}^{\\top}$. Then the entry $A_{ij} = b_i b_j$. The entry of the transpose is $(A^{\\top})_{ij} = A_{ji} = b_j b_i$. Since scalar multiplication is commutative, $b_i b_j = b_j b_i$, so $A_{ij}=(A^{\\top})_{ij}$. Therefore, $A = A^{\\top}$.\n\nThis means that our matrix $P(\\sigma) = \\sigma \\mathbf{b}\\mathbf{b}^{\\top}$ is symmetric. We can also see this by inspecting the explicit matrix form.\n\nThe skew-symmetric part of $P(\\sigma)$ is defined as $S(\\sigma) = \\frac{1}{2}\\left(P(\\sigma) - P(\\sigma)^{\\top}\\right)$.\nSince $P(\\sigma)$ is symmetric, $P(\\sigma) = P(\\sigma)^{\\top}$.\nTherefore,\n$S(\\sigma) = \\frac{1}{2}\\left(P(\\sigma) - P(\\sigma)\\right) = \\frac{1}{2} \\mathbf{0} = \\mathbf{0}$\nwhere $\\mathbf{0}$ is the $4 \\times 4$ zero matrix.\n\nThe final step is to calculate the Frobenius norm of $S(\\sigma)$. The Frobenius norm of a matrix $A$ is $\\|A\\|_{F} = \\sqrt{\\sum_{i,j} |A_{ij}|^2}$.\nFor the zero matrix, all its elements are $0$, so the sum is $0$.\n$\\|S(\\sigma)\\|_{F} = \\|\\mathbf{0}\\|_{F} = \\sqrt{0^2 + 0^2 + \\dots + 0^2} = 0$.\n\nThe value of the symmetry defect, quantified by the Frobenius norm of the skew-symmetric part of the penalty matrix, is exactly $0$. This confirms the symmetric nature of this specific penalty contribution to the formulation.", "answer": "$$\\boxed{0}$$", "id": "3405412"}, {"introduction": "A fundamental check for any numerical method is its consistencyâ€”the ability to exactly reproduce the solution to the partial differential equation if that solution is simple enough to be represented by the discrete approximation space. This exercise investigates this core property for the Local Discontinuous Galerkin (LDG) method by applying the scheme to a known, smooth solution. You will verify how the specific definitions of the numerical fluxes ensure that the discrete system is perfectly satisfied, reinforcing why the LDG formulation is a valid and accurate discretization of the underlying equations. [@problem_id:3405445]", "problem": "Consider the one-dimensional elliptic model problem on the interval $[0,1]$ with exact solution $u(x)=x^2$. Introduce the first-order system by setting $q=u'$ and $-q'=f$, so that $f(x)=-2$. Let $\\{x_{i}\\}_{i=0}^{N}$ be a mesh of $[0,1]$ with $N \\geq 2$ elements $K_{i}=(x_{i-1},x_{i})$. For each element $K$, let $n$ denote the outward unit normal on $\\partial K$, i.e., $n=-1$ at the left endpoint and $n=+1$ at the right endpoint. For an interior interface $x_{i}$ with left and right traces $\\phi^{-}$ and $\\phi^{+}$, define the jump and average by $[\\phi]=\\phi^{+}-\\phi^{-}$ and $\\{\\phi\\}=(\\phi^{+}+\\phi^{-})/2$.\n\nThe Local Discontinuous Galerkin (LDG) residual functional $R(v,r)$ associated with the first-order system is defined for broken test functions $v$ and $r$ by\n$$\nR(v,r)\n=\n\\sum_{K}\\left(\\int_{K} q\\,r\\,dx+\\int_{K} u\\,r'\\,dx-\\sum_{x\\in\\partial K}\\hat{u}\\,r\\,n\\right)\n+\n\\sum_{K}\\left(\\int_{K} q\\,v'\\,dx-\\sum_{x\\in\\partial K}\\hat{q}\\,v\\,n-\\int_{K} f\\,v\\,dx\\right).\n$$\nOn interior interfaces $x_{i}$, adopt the two-parameter numerical flux family\n$$\n\\hat{u}=\\{u\\}-\\sigma\\,[q],\n\\qquad\n\\hat{q}=\\{q\\}-\\tau\\,[u],\n$$\nwith real constants $\\sigma$ and $\\tau$. On the boundary $\\{0,1\\}$, impose Dirichlet-consistent fluxes\n$$\n\\hat{u}(0)=u(0)=0,\\quad \\hat{u}(1)=u(1)=1,\\qquad \\hat{q}(0)=q(0),\\quad \\hat{q}(1)=q(1).\n$$\n\n(a) Compute analytically, in closed form, the total interior interface contribution to $R(v,r)$ when $u(x)=x^2$ and $q(x)=2x$ are substituted into the residual. Express your result as a function of the test traces $v^{\\pm}$ and $r^{\\pm}$ at interfaces and the parameters $\\sigma$ and $\\tau$.\n\n(b) Using only the fundamental identities of integration by parts and the definitions above, verify that there exists at least one choice of the interior flux parameters $\\sigma$ and $\\tau$ for which the global residual $R(v,r)$ vanishes for all broken test functions $v$ and $r$. Then, for such a choice and with the boundary fluxes as stated, determine the value of the global residual $R(v,r)$.\n\nYour final answer must be a single real number giving the value of $R(v,r)$ for the chosen fluxes. No rounding is required.", "solution": "The problem is divided into two parts. We will address them sequentially. The core of the problem lies in analyzing the Local Discontinuous Galerkin (LDG) residual functional for a given exact solution.\n\nLet the exact solution be $u(x) = x^2$. The first-order system is defined by $q = u'$ and $-q' = f$.\nThis implies $q(x) = \\frac{d}{dx}(x^2) = 2x$ and $f(x) = -\\frac{d}{dx}(2x) = -2$.\nThe functions $u(x)$ and $q(x)$ are continuous on the domain $[0,1]$. Therefore, at any interior interface $x_{i}$, the left and right traces are equal: $u(x_i^-) = u(x_i^+) = u(x_i)$ and $q(x_i^-) = q(x_i^+) = q(x_i)$.\nThis leads to the following values for the jump $[ \\cdot ]$ and average $\\{ \\cdot \\}$ operators at any interior interface $x_i$:\n$[u](x_i) = u(x_i^+) - u(x_i^-) = 0$\n$[q](x_i) = q(x_i^+) - q(x_i^-) = 0$\n$\\{u\\}(x_i) = \\frac{u(x_i^+) + u(x_i^-)}{2} = u(x_i) = x_i^2$\n$\\{q\\}(x_i) = \\frac{q(x_i^+) + q(x_i^-)}{2} = q(x_i) = 2x_i$\n\nThe LDG residual functional is given by:\n$$\nR(v,r)\n=\n\\sum_{K}\\left(\\int_{K} q\\,r\\,dx+\\int_{K} u\\,r'\\,dx-\\sum_{x\\in\\partial K}\\hat{u}\\,r\\,n\\right)\n+\n\\sum_{K}\\left(\\int_{K} q\\,v'\\,dx-\\sum_{x\\in\\partial K}\\hat{q}\\,v\\,n-\\int_{K} f\\,v\\,dx\\right).\n$$\n\n**(a) Computation of the total interior interface contribution to $R(v,r)$**\n\nThe terms in $R(v,r)$ involving sums over element boundaries $\\partial K$ can be reorganized into a sum over interior interfaces and a sum over the domain boundary points $\\{0,1\\}$.\nThe total contribution from all element faces is $-\\sum_K \\sum_{x\\in\\partial K} (\\hat{u}rn + \\hat{q}vn)$.\nLet's consider a single interior interface at $x_i$, which is the right boundary of element $K_i=(x_{i-1},x_i)$ and the left boundary of element $K_{i+1}=(x_i,x_{i+1})$. For $K_i$, the outward normal at $x_i$ is $n=+1$. For $K_{i+1}$, the outward normal at $x_i$ is $n=-1$. The numerical fluxes $\\hat{u}$ and $\\hat{q}$ are single-valued at the interface.\nThe contribution to the sum from the interface $x_i$ is:\n$$\n-(\\hat{u}(x_i)r(x_i^-)(+1) + \\hat{u}(x_i)r(x_i^+)(-1)) - (\\hat{q}(x_i)v(x_i^-)(+1) + \\hat{q}(x_i)v(x_i^+)(-1))\n$$\n$$\n= -\\hat{u}(x_i)(r(x_i^-) - r(x_i^+)) - \\hat{q}(x_i)(v(x_i^-) - v(x_i^+)) = \\hat{u}(x_i)[r](x_i) + \\hat{q}(x_i)[v](x_i)\n$$\nThe total interior interface contribution to $R(v,r)$, which we denote by $I(v,r)$, is the sum of these terms over all interior interfaces $x_i$ for $i=1, \\dots, N-1$:\n$$\nI(v,r) = \\sum_{i=1}^{N-1} \\left( \\hat{u}(x_i)[r](x_i) + \\hat{q}(x_i)[v](x_i) \\right)\n$$\nNow, we substitute the definitions of the numerical fluxes at an interior interface:\n$$\n\\hat{u}(x_i) = \\{u\\}(x_i) - \\sigma [q](x_i)\n\\qquad\n\\hat{q}(x_i) = \\{q\\}(x_i) - \\tau [u](x_i)\n$$\nSince we are using the smooth exact solution, $[u](x_i)=0$ and $[q](x_i)=0$. The fluxes simplify to:\n$$\n\\hat{u}(x_i) = \\{u\\}(x_i) = u(x_i) = x_i^2\n$$\n$$\n\\hat{q}(x_i) = \\{q\\}(x_i) = q(x_i) = 2x_i\n$$\nThis demonstrates the consistency of the numerical fluxes. Notably, the values of $\\hat{u}(x_i)$ and $\\hat{q}(x_i)$ are independent of the parameters $\\sigma$ and $\\tau$ when evaluated with the smooth exact solution.\nSubstituting these into the expression for $I(v,r)$:\n$$\nI(v,r) = \\sum_{i=1}^{N-1} \\left( u(x_i)[r](x_i) + q(x_i)[v](x_i) \\right)\n$$\nUsing the specific forms $u(x_i) = x_i^2$ and $q(x_i) = 2x_i$, and expressing the jumps in terms of the traces $v^\\pm$ and $r^\\pm$:\n$$\nI(v,r) = \\sum_{i=1}^{N-1} \\left( x_i^2 (r(x_i^+) - r(x_i^-)) + 2x_i (v(x_i^+) - v(x_i^-)) \\right)\n$$\nThis is the closed-form expression for the total interior interface contribution.\n\n**(b) Verification and determination of the global residual $R(v,r)$**\n\nTo analyze the global residual, we apply integration by parts to terms with derivatives on the test functions $v$ and $r$. For an element $K$:\n$\\int_K u r' dx = [ur]_{\\partial K} - \\int_K u' r dx$\n$\\int_K q v' dx = [qv]_{\\partial K} - \\int_K q' v dx$\nSubstituting these into the definition of $R(v,r)$:\n$$\nR(v,r) = \\sum_{K}\\left(\\int_{K} (q - u')r\\,dx + [ur]_{\\partial K} -\\sum_{x\\in\\partial K}\\hat{u}\\,r\\,n\\right) + \\sum_{K}\\left([qv]_{\\partial K} - \\int_{K} (f+q')v\\,dx -\\sum_{x\\in\\partial K}\\hat{q}\\,v\\,n\\right)\n$$\nSince we use $u(x)=x^2$, $q(x)=2x$, and $f(x)=-2$, we have $q-u'=0$ and $-q'-f = 0$. Thus, the volume integrals over each element $K$ vanish:\n$$\n\\int_K (q-u')r\\,dx = 0 \\quad \\text{and} \\quad \\int_K(f+q')v\\,dx=0\n$$\nThe residual simplifies to a sum of interface and boundary terms:\n$$\nR(v,r) = \\sum_{K}\\left([ur]_{\\partial K} - \\sum_{x\\in\\partial K}\\hat{u}\\,r\\,n\\right) + \\sum_{K}\\left([qv]_{\\partial K} - \\sum_{x\\in\\partial K}\\hat{q}\\,v\\,n\\right)\n$$\nLet's analyze the first part of this sum. By rearranging the summation over elements and their boundaries to a sum over interfaces and domain boundaries, we get:\n$$\n\\sum_{K}\\left([ur]_{\\partial K} - \\sum_{x\\in\\partial K}\\hat{u}\\,r\\,n\\right) = \\sum_{i=1}^{N-1}(\\hat{u}(x_i)-u(x_i))[r](x_i) + (u(1)-\\hat{u}(1))r(1^-) - (u(0)-\\hat{u}(0))r(0^+)\n$$\nSimilarly for the second part:\n$$\n\\sum_{K}\\left([qv]_{\\partial K} - \\sum_{x\\in\\partial K}\\hat{q}\\,v\\,n\\right) = \\sum_{i=1}^{N-1}(\\hat{q}(x_i)-q(x_i))[v](x_i) + (q(1)-\\hat{q}(1))v(1^-) - (q(0)-\\hat{q}(0))v(0^+)\n$$\nWe now evaluate each of these terms.\nFor the interior interfaces $x_i \\in (0,1)$, we have already shown in part (a) that $\\hat{u}(x_i)=u(x_i)$ and $\\hat{q}(x_i)=q(x_i)$, for any values of $\\sigma$ and $\\tau$. Therefore, the sums over the interior interfaces vanish:\n$$\n\\sum_{i=1}^{N-1}(\\hat{u}(x_i)-u(x_i))[r](x_i) = 0\n\\qquad \\text{and} \\qquad\n\\sum_{i=1}^{N-1}(\\hat{q}(x_i)-q(x_i))[v](x_i) = 0\n$$\nThis holds for any choice of the parameters $\\sigma$ and $\\tau$. This verifies that there exists at least one such choice (in fact, any choice is valid).\n\nNow we evaluate the boundary terms at $x=0$ and $x=1$. We are given the boundary flux conditions:\n$\\hat{u}(0)=u(0)$, $\\hat{u}(1)=u(1)$, $\\hat{q}(0)=q(0)$, $\\hat{q}(1)=q(1)$.\nUsing the exact solution, we have $u(0)=0^2=0$, $u(1)=1^2=1$, $q(0)=2(0)=0$, and $q(1)=2(1)=2$.\nSo the boundary flux values are: $\\hat{u}(0)=0$, $\\hat{u}(1)=1$, $\\hat{q}(0)=0$, $\\hat{q}(1)=2$.\nSubstituting these values into the remaining terms of the residual:\n$$\n(u(1)-\\hat{u}(1))r(1^-) = (1-1)r(1^-) = 0\n$$\n$$\n-(u(0)-\\hat{u}(0))r(0^+) = -(0-0)r(0^+) = 0\n$$\n$$\n(q(1)-\\hat{q}(1))v(1^-) = (2-2)v(1^-) = 0\n$$\n$$\n-(q(0)-\\hat{q}(0))v(0^+) = -(0-0)v(0^+) = 0\n$$\nAll terms in the expression for $R(v,r)$ are zero. This means that for any parameters $\\sigma, \\tau$, and for the given boundary fluxes, the global residual vanishes for all broken test functions $v,r$ when the exact solution is used.\n$$\nR(v,r) = 0\n$$\nThe problem asks for the value of the global residual for a valid choice of parameters. As shown, any choice is valid, and for any such choice, the value of the residual is $0$.", "answer": "$$\\boxed{0}$$", "id": "3405445"}, {"introduction": "For time-dependent and conservative systems, a numerical scheme should ideally preserve global quantities like total mass or energy. This property of conservation is not automatic and depends critically on the definition of the numerical flux at element interfaces. This problem serves as an important counterexample, demonstrating what happens when a non-conservative, double-valued flux is used instead of a standard single-valued one. By deriving the semi-discrete equations, you will see precisely how this improper choice leads to a spurious change in the total mass, providing a concrete understanding of why proper flux design is essential. [@problem_id:3405510]", "problem": "Consider the one-dimensional pure diffusion equation $u_{t} = \\kappa u_{xx}$ on the domain $[0,1]$ with homogeneous Neumann boundary conditions $u_{x}(0,t) = 0$ and $u_{x}(1,t) = 0$. Introduce the first-order system $q = u_{x}$ and $u_{t} = \\kappa q_{x}$. Discretize this system by a Local Discontinuous Galerkin (LDG) method on a mesh of two uniform elements $K_{1} = [0,\\tfrac{1}{2}]$ and $K_{2} = [\\tfrac{1}{2},1]$, using piecewise constant trial and test functions for both $u$ and $q$. Denote the element-constant values by $u_{1}(t)$ and $u_{2}(t)$ for $u$, and $q_{1}(t)$ and $q_{2}(t)$ for $q$. Let the outward unit normals on the endpoints of each element be $n = -1$ at the left endpoint and $n = +1$ at the right endpoint.\n\nUse the LDG weak forms of $q - u_{x} = 0$ and $u_{t} - \\kappa q_{x} = 0$ with the following numerical fluxes. At the internal interface $x = \\tfrac{1}{2}$, choose a nonconservative numerical trace $\\widehat{u}$ that is elementwise (double-valued): for the right face of $K_{1}$, set $\\widehat{u} = u_{1}$, and for the left face of $K_{2}$, set $\\widehat{u} = u_{2}$. At the domain boundaries $x = 0$ and $x = 1$, set $\\widehat{u} = 0$. Impose the homogeneous Neumann boundary condition for the conservation law by taking $\\widehat{\\kappa q} = 0$ at $x = 0$ and $x = 1$. At the internal interface $x = \\tfrac{1}{2}$, let the diffusive numerical flux be elementwise (double-valued) as well: for the right face of $K_{1}$, set $\\widehat{\\kappa q} = \\kappa q_{1}$, and for the left face of $K_{2}$, set $\\widehat{\\kappa q} = \\kappa q_{2}$.\n\nStarting from the LDG weak formulations and these flux choices, derive the semi-discrete equations for $q_{1}(t)$ and $q_{2}(t)$ and the global rate of change of the total mass $\\int_{0}^{1} u(x,t)\\,dx$. For the specific data $\\kappa = 1$, $h = \\tfrac{1}{2}$, $u_{1}(0) = 1$, and $u_{2}(0) = 0$, compute the instantaneous rate of change of the total mass $\\dfrac{d}{dt}\\int_{0}^{1} u(x,t)\\,dx$ at $t = 0$. Express your final answer as a single real number. No rounding is required.", "solution": "We start with the weak formulations for the first-order system on an element $K_j$.\nLet $v$ be a test function for the $u$ equation, and $p$ be a test function for the $q$ equation. Since the trial and test functions are piecewise constant on each element, $u(x,t) = u_j(t)$, $q(x,t) = q_j(t)$, $v(x) = v_j$, and $p(x) = p_j$ for $x \\in K_j$.\n\n**1. Weak form for $q - u_x = 0$:**\nMultiplying by a test function $p$ and integrating over an element $K_j$:\n$$ \\int_{K_j} q p \\,dx - \\int_{K_j} u_x p \\,dx = 0 $$\nIntegrating the second term by parts:\n$$ \\int_{K_j} q p \\,dx + \\int_{K_j} u p_x \\,dx - [u p]_{\\partial K_j} = 0 $$\nReplacing boundary values with numerical fluxes, this becomes:\n$$ \\int_{K_j} q p \\,dx + \\int_{K_j} u p_x \\,dx - [\\widehat{u} p n]_{\\partial K_j} = 0 $$\nSince $p$ is constant on $K_j$, its derivative $p_x = 0$. We choose the test function $p$ to be $1$ on $K_j$ and $0$ elsewhere, so $p_j=1$. This simplifies the equation to:\n$$ q_j \\int_{K_j} dx - [\\widehat{u} n]_{\\partial K_j} = 0 $$\n$$ h q_j - (\\widehat{u}(x_{j,R}) n(x_{j,R}) + \\widehat{u}(x_{j,L}) n(x_{j,L})) = 0 $$\nwhere $x_{j,L}$ and $x_{j,R}$ are the left and right endpoints of $K_j$.\n\nFor element $K_1 = [0, \\tfrac{1}{2}]$, with $h=\\tfrac{1}{2}$, $x_{1,L}=0$, $x_{1,R}=\\tfrac{1}{2}$, $n(0)=-1$, $n(\\tfrac{1}{2})=+1$:\n$$ \\tfrac{1}{2} q_1 - (\\widehat{u}(\\tfrac{1}{2}) \\cdot (+1) + \\widehat{u}(0) \\cdot (-1)) = 0 $$\nUsing the given fluxes, $\\widehat{u}(\\tfrac{1}{2}) = u_1$ (right face of $K_1$) and $\\widehat{u}(0)=0$:\n$$ \\tfrac{1}{2} q_1 - (u_1 \\cdot 1 + 0 \\cdot (-1)) = 0 \\implies \\tfrac{1}{2} q_1 = u_1 \\implies q_1(t) = 2 u_1(t) $$\n\nFor element $K_2 = [\\tfrac{1}{2}, 1]$, with $h=\\tfrac{1}{2}$, $x_{2,L}=\\tfrac{1}{2}$, $x_{2,R}=1$, $n(\\tfrac{1}{2})=-1$, $n(1)=+1$:\n$$ \\tfrac{1}{2} q_2 - (\\widehat{u}(1) \\cdot (+1) + \\widehat{u}(\\tfrac{1}{2}) \\cdot (-1)) = 0 $$\nUsing the given fluxes, $\\widehat{u}(1) = 0$ and $\\widehat{u}(\\tfrac{1}{2}) = u_2$ (left face of $K_2$):\n$$ \\tfrac{1}{2} q_2 - (0 \\cdot 1 + u_2 \\cdot (-1)) = 0 \\implies \\tfrac{1}{2} q_2 = -u_2 \\implies q_2(t) = -2 u_2(t) $$\nThe semi-discrete equations for $q_1(t)$ and $q_2(t)$ are thus the algebraic relations:\n$q_1(t) = \\frac{u_1(t)}{h}$ and $q_2(t) = -\\frac{u_2(t)}{h}$.\n\n**2. Weak form for $u_t - \\kappa q_x = 0$:**\nMultiplying by a test function $v$ and integrating over $K_j$:\n$$ \\int_{K_j} u_t v \\,dx - \\int_{K_j} (\\kappa q)_x v \\,dx = 0 $$\nIntegrating the second term by parts and introducing the numerical flux $\\widehat{\\kappa q}$:\n$$ \\int_{K_j} u_t v \\,dx + \\int_{K_j} \\kappa q v_x \\,dx - [\\widehat{\\kappa q} v n]_{\\partial K_j} = 0 $$\nFor piecewise constant $v$, $v_x=0$. Choosing $v=1$ on $K_j$ and $0$ elsewhere:\n$$ \\frac{du_j}{dt} \\int_{K_j} dx - [\\widehat{\\kappa q} n]_{\\partial K_j} = 0 $$\n$$ h \\frac{du_j}{dt} - (\\widehat{\\kappa q}(x_{j,R}) n(x_{j,R}) + \\widehat{\\kappa q}(x_{j,L}) n(x_{j,L})) = 0 $$\n\nFor element $K_1 = [0, \\tfrac{1}{2}]$:\n$$ \\tfrac{1}{2} \\frac{du_1}{dt} - (\\widehat{\\kappa q}(\\tfrac{1}{2}) \\cdot (+1) + \\widehat{\\kappa q}(0) \\cdot (-1)) = 0 $$\nUsing fluxes $\\widehat{\\kappa q}(\\tfrac{1}{2}) = \\kappa q_1$ and $\\widehat{\\kappa q}(0) = 0$:\n$$ \\tfrac{1}{2} \\frac{du_1}{dt} - (\\kappa q_1 \\cdot 1 + 0 \\cdot (-1)) = 0 \\implies \\frac{du_1}{dt} = 2 \\kappa q_1 = \\frac{\\kappa}{h} q_1 $$\n\nFor element $K_2 = [\\tfrac{1}{2}, 1]$:\n$$ \\tfrac{1}{2} \\frac{du_2}{dt} - (\\widehat{\\kappa q}(1) \\cdot (+1) + \\widehat{\\kappa q}(\\tfrac{1}{2}) \\cdot (-1)) = 0 $$\nUsing fluxes $\\widehat{\\kappa q}(1) = 0$ and $\\widehat{\\kappa q}(\\tfrac{1}{2}) = \\kappa q_2$:\n$$ \\tfrac{1}{2} \\frac{du_2}{dt} - (0 \\cdot 1 + \\kappa q_2 \\cdot (-1)) = 0 \\implies \\frac{du_2}{dt} = -2 \\kappa q_2 = -\\frac{\\kappa}{h} q_2 $$\n\n### Derivation of the Global Rate of Change of Total Mass\n\nThe total mass is given by $M(t) = \\int_0^1 u(x,t) \\,dx$. For the piecewise constant approximation, this becomes:\n$$ M(t) = \\int_0^{1/2} u_1(t) \\,dx + \\int_{1/2}^1 u_2(t) \\,dx = u_1(t) h + u_2(t) h = h(u_1(t)+u_2(t)) $$\nThe rate of change of total mass is:\n$$ \\frac{dM}{dt} = h \\left( \\frac{du_1}{dt} + \\frac{du_2}{dt} \\right) $$\nSubstituting the derived ODEs for $u_1$ and $u_2$:\n$$ \\frac{dM}{dt} = h \\left( \\frac{\\kappa q_1}{h} - \\frac{\\kappa q_2}{h} \\right) = \\kappa (q_1(t) - q_2(t)) $$\nThis is the general expression for the rate of change of total mass. This confirms that mass is not conserved in this scheme unless $q_1=q_2$, a direct consequence of the non-conservative numerical flux choices for $\\widehat{\\kappa q}$.\n\n### Calculation of the Instantaneous Rate of Change at $t=0$\n\nWe need to evaluate $\\frac{dM}{dt}$ at $t=0$, which is $\\kappa(q_1(0) - q_2(0))$.\nWe are given the parameters and initial conditions:\n- $\\kappa = 1$\n- $h = \\tfrac{1}{2}$\n- $u_1(0) = 1$\n- $u_2(0) = 0$\n\nFirst, we compute the initial values of $q_1$ and $q_2$ using the semi-discrete relations derived earlier:\n$$ q_1(0) = \\frac{u_1(0)}{h} = \\frac{1}{1/2} = 2 $$\n$$ q_2(0) = -\\frac{u_2(0)}{h} = -\\frac{0}{1/2} = 0 $$\nNow, we can compute the instantaneous rate of change of the total mass at $t=0$:\n$$ \\left. \\frac{dM}{dt} \\right|_{t=0} = \\kappa (q_1(0) - q_2(0)) = 1 \\cdot (2 - 0) = 2 $$\nThe instantaneous rate of change of the total mass at $t=0$ is $2$.", "answer": "$$\\boxed{2}$$", "id": "3405510"}]}