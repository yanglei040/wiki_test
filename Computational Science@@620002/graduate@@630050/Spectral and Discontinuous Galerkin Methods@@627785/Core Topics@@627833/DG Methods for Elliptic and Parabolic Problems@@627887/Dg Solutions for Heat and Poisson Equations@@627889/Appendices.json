{"hands_on_practices": [{"introduction": "The first step in constructing any finite element method is choosing a basis for the discrete solution space. This exercise explores the practical consequences of selecting either a modal (orthonormal) or nodal (Lagrange) basis within the Discontinuous Galerkin framework. By deriving the elemental mass and stiffness matrices, you will gain firsthand insight into how this fundamental choice impacts matrix structure, such as when the mass matrix becomes diagonal, and how these matrices scale from a universal reference element to a physical one [@problem_id:3378044].", "problem": "Consider the one-dimensional reference element $I = [-1,1]$ and the polynomial space $V_h^k = \\mathbb{P}^k(I)$ of total degree at most $k \\in \\mathbb{N}$. Two elementwise polynomial bases for $V_h^k$ are to be compared: a modal basis defined by orthonormal Legendre polynomials and a nodal basis defined by Lagrange polynomials through quadrature nodes. The context is the discontinuous Galerkin (DG) discretization of the heat and Poisson equations, where the primary local bilinear forms involve the element mass matrix and the element stiffness matrix. Work on a single element and do not include interface flux contributions.\n\nStart from the following fundamental definitions, properties, and constructions:\n- The classical Legendre polynomials $\\{P_n(r)\\}_{n=0}^\\infty$ on $[-1,1]$ satisfy $\\int_{-1}^{1} P_n(r) P_m(r)\\,dr = \\frac{2}{2n+1}\\,\\delta_{nm}$.\n- The orthonormal Legendre basis is defined by $\\phi_n(r) = \\sqrt{\\frac{2n+1}{2}}\\,P_n(r)$, so that $\\int_{-1}^{1} \\phi_n(r)\\,\\phi_m(r)\\,dr = \\delta_{nm}$ for $0 \\le n,m \\le k$.\n- Given $N_p = k+1$ distinct nodes $\\{\\xi_i\\}_{i=1}^{N_p} \\subset [-1,1]$, the nodal Lagrange basis $\\{\\ell_i(r)\\}_{i=1}^{N_p}$ is defined by $\\ell_i(\\xi_j) = \\delta_{ij}$ and spans $\\mathbb{P}^k(I)$.\n- For Gauss–Legendre (GL) nodes, there exist positive weights $\\{w_i\\}_{i=1}^{N_p}$ such that $\\sum_{i=1}^{N_p} w_i\\,f(\\xi_i) = \\int_{-1}^{1} f(r)\\,dr$ exactly for all polynomials $f$ of degree up to $2N_p-1$.\n- For Gauss–Lobatto–Legendre (GLL) nodes, there exist positive weights $\\{w_i\\}_{i=1}^{N_p}$ such that $\\sum_{i=1}^{N_p} w_i\\,f(\\xi_i) = \\int_{-1}^{1} f(r)\\,dr$ exactly for all polynomials $f$ of degree up to $2N_p-3$.\n- Under the affine map from the reference element to a physical element $K = [x_L,x_R]$, $x(r) = x_c + \\frac{h}{2}\\,r$ with $x_c = \\frac{x_L+x_R}{2}$ and $h = x_R - x_L$, the Jacobian is $J = \\frac{dx}{dr} = \\frac{h}{2}$ and derivatives transform via $\\frac{d}{dx} = \\frac{2}{h}\\frac{d}{dr}$.\n\nTasks:\n1. Using only the above definitions and the orthogonality of Legendre polynomials, derive the element mass matrix and element stiffness matrix on the reference element $I$ in the modal basis $\\{\\phi_n\\}_{n=0}^{k}$, where the mass inner product is $\\int_{-1}^{1} (\\cdot)\\,(\\cdot)\\,dr$ and the stiffness inner product is $\\int_{-1}^{1} \\frac{d}{dr}(\\cdot)\\,\\frac{d}{dr}(\\cdot)\\,dr$. State whether each matrix is diagonal and justify your answer from first principles.\n2. Repeat the derivation in the nodal basis $\\{\\ell_i\\}_{i=1}^{N_p}$ for two choices of nodes: Gauss–Legendre and Gauss–Lobatto–Legendre. Use the exactness properties of the corresponding quadrature rules to deduce when the element mass matrix is diagonal under exact quadrature of degree sufficient for the integrands. Express both the mass and stiffness matrices in terms of the quadrature evaluation matrix and weights, and explain the role of exactness in each case.\n3. Map your expressions to a physical element $K$ via the affine map specified above, and derive the explicit scaling factors that relate the reference-element matrices to the physical-element matrices for both the mass and stiffness bilinear forms relevant to the heat and Poisson equations.\n\nFinally, answer the following explicit question in a single closed-form analytic expression. On a physical element of length $h$, using the nodal Lagrange basis at Gauss–Legendre nodes with exact Gauss–Legendre quadrature, what is the expression for each diagonal entry of the element mass matrix $M_{ii}$? Your final answer must be a single analytic expression and must not include any units. No rounding is required.", "solution": "The problem is assessed to be valid as it is scientifically grounded in the theory of numerical methods for partial differential equations, is well-posed with a clear and consistent set of definitions and objectives, and is free from any subjective or ambiguous language. We may proceed with the solution.\n\nThe solution is organized into three parts, corresponding to the three tasks outlined in the problem statement, followed by the derivation of the final answer.\n\n**1. Analysis in the Modal Basis**\n\nThe modal basis is given by the set of orthonormal Legendre polynomials $\\{\\phi_n(r)\\}_{n=0}^{k}$ on the reference element $I = [-1, 1]$. The defining property of this basis is its orthonormality with respect to the $L^2$ inner product:\n$$\n\\int_{-1}^{1} \\phi_n(r) \\phi_m(r) \\,dr = \\delta_{nm}\n$$\nwhere $\\delta_{nm}$ is the Kronecker delta. The basis functions are indexed from $n=0$ to $k$.\n\nThe element mass matrix on the reference element, denoted $M^I$, has entries $M_{nm}$ for $0 \\le n,m \\le k$. Its entries are defined by the inner product of the basis functions:\n$$\nM_{nm} = \\int_{-1}^{1} \\phi_n(r) \\phi_m(r) \\,dr\n$$\nBy direct application of the orthonormality property of the basis, we find:\n$$\nM_{nm} = \\delta_{nm}\n$$\nThis means the mass matrix in the orthonormal modal basis is the identity matrix, $M^I = I$. An identity matrix is, by definition, a diagonal matrix.\n\nThe element stiffness matrix on the reference element, denoted $S^I$, has entries $S_{nm}$ defined by the inner product of the derivatives of the basis functions:\n$$\nS_{nm} = \\int_{-1}^{1} \\frac{d\\phi_n}{dr}(r) \\frac{d\\phi_m}{dr}(r) \\,dr\n$$\nTo determine if this matrix is diagonal, we examine its off-diagonal entries, where $n \\ne m$. The basis function $\\phi_n(r)$ is a polynomial of degree $n$, and its derivative $\\frac{d\\phi_n}{dr}$ is a polynomial of degree $n-1$. The parity of the Legendre polynomial $P_n(r)$ is $(-1)^n$. Since $\\phi_n(r)$ is a scalar multiple of $P_n(r)$, it has the same parity. The derivative of a function with a given parity has the opposite parity. Thus, $\\frac{d\\phi_n}{dr}$ has parity $(-1)^{n-1}$. The integrand is the product $\\frac{d\\phi_n}{dr} \\frac{d\\phi_m}{dr}$, which has parity $(-1)^{n-1}(-1)^{m-1} = (-1)^{n+m-2}$. If $n$ and $m$ have different parity (one even, one odd), then $n+m$ is odd, $n+m-2$ is odd, and the integrand is an odd function. The integral of an odd function over the symmetric interval $[-1, 1]$ is zero. Therefore, $S_{nm} = 0$ if $n$ and $m$ have different parities.\n\nHowever, this does not guarantee that the matrix is diagonal. Consider an off-diagonal entry where $n$ and $m$ have the same parity (e.g., $n=2$, $m=0$, or $n=3$, $m=1$). For $n=0$, $\\phi_0(r)$ is a constant, so $\\frac{d\\phi_0}{dr} = 0$. This implies $S_{0m} = S_{n0} = 0$ for all $n,m$. For $n,m > 0$ with the same parity and $n \\ne m$, the integrand is a non-zero even function, and the integral is generally non-zero. For example, for $k \\ge 3$, the entry $S_{13}$ is generally non-zero. Thus, the stiffness matrix $S^I$ is not diagonal.\n\n**2. Analysis in the Nodal Basis**\n\nThe nodal basis is given by the Lagrange polynomials $\\{\\ell_i(r)\\}_{i=1}^{N_p}$ of degree $k=N_p-1$, defined by the condition $\\ell_i(\\xi_j) = \\delta_{ij}$ at a set of $N_p$ distinct nodes $\\{\\xi_j\\}_{j=1}^{N_p}$.\n\nThe element mass matrix entries are $M_{ij} = \\int_{-1}^{1} \\ell_i(r) \\ell_j(r) \\,dr$. The integrand $\\ell_i(r) \\ell_j(r)$ is a polynomial of degree at most $k+k = 2k = 2(N_p-1) = 2N_p - 2$. We approximate this integral using a quadrature rule with nodes $\\{\\xi_p\\}_{p=1}^{N_p}$ and weights $\\{w_p\\}_{p=1}^{N_p}$:\n$$\nM_{ij} \\approx \\sum_{p=1}^{N_p} w_p \\ell_i(\\xi_p) \\ell_j(\\xi_p) = \\sum_{p=1}^{N_p} w_p \\delta_{ip} \\delta_{jp}\n$$\nThe sum is non-zero only if $p=i$ and $p=j$, which requires $i=j$. This gives:\n$$\nM_{ij} \\approx w_i \\delta_{ij}\n$$\nThis approximation, called mass lumping, always yields a diagonal matrix. The question is when this result is exact.\n\n- **Gauss–Legendre (GL) Nodes:** The corresponding quadrature rule is exact for polynomials of degree up to $2N_p-1$. Since the integrand's degree is $2N_p-2$, which is less than or equal to $2N_p-1$, the quadrature is exact. Therefore, for a nodal basis constructed on GL nodes, the element mass matrix is exactly diagonal: $M_{ij} = w_i \\delta_{ij}$, where $\\{w_i\\}$ are the GL quadrature weights.\n\n- **Gauss–Lobatto–Legendre (GLL) Nodes:** The corresponding quadrature rule is exact for polynomials of degree up to $2N_p-3$. The integrand's degree is $2N_p-2$. Since $2N_p-2 > 2N_p-3$, the quadrature rule is not exact for the off-diagonal terms in general. Thus, for a nodal basis constructed on GLL nodes, the exact mass matrix is not diagonal. The lumped mass matrix $M_{ij} = w_i \\delta_{ij}$ (where $\\{w_i\\}$ are the GLL weights) is an approximation.\n\nThe element stiffness matrix entries are $S_{ij} = \\int_{-1}^{1} \\frac{d\\ell_i}{dr}(r) \\frac{d\\ell_j}{dr}(r) \\,dr$. The integrand $\\frac{d\\ell_i}{dr} \\frac{d\\ell_j}{dr}$ is a polynomial of degree at most $(k-1) + (k-1) = 2k-2 = 2N_p-4$.\n\n- **GL Quadrature:** Exactness is up to degree $2N_p-1$. Since $2N_p-4 \\le 2N_p-1$, the quadrature is exact.\n- **GLL Quadrature:** Exactness is up to degree $2N_p-3$. Since $2N_p-4 \\le 2N_p-3$, the quadrature is also exact.\n\nIn both cases, the stiffness matrix can be computed exactly using the corresponding quadrature rule:\n$$\nS_{ij} = \\sum_{p=1}^{N_p} w_p \\frac{d\\ell_i}{dr}(\\xi_p) \\frac{d\\ell_j}{dr}(\\xi_p)\n$$\nLet $D$ be the differentiation matrix with entries $D_{pi} = \\frac{d\\ell_i}{dr}(\\xi_p)$, and $W$ be the diagonal matrix of weights with entries $W_{pp} = w_p$. The stiffness matrix can be written as $S^I = D^T W D$. In general, the entries $\\frac{d\\ell_i}{dr}(\\xi_p)$ are not zero for $i \\ne p$. Therefore, the differentiation matrix $D$ is not diagonal, and consequently, the stiffness matrix $S^I$ is not diagonal for either choice of nodes.\n\n**3. Mapping to a Physical Element**\n\nLet $K=[x_L, x_R]$ be a physical element of length $h=x_R-x_L$. The affine map from the reference element $I=[-1,1]$ is $x(r) = x_c + \\frac{h}{2}r$, where $x_c = \\frac{x_L+x_R}{2}$. The Jacobian of this transformation is $J = \\frac{dx}{dr} = \\frac{h}{2}$. The derivative with respect to $x$ is related to the derivative with respect to $r$ by $\\frac{d}{dx} = \\frac{dr}{dx} \\frac{d}{dr} = (\\frac{h}{2})^{-1} \\frac{d}{dr} = \\frac{2}{h} \\frac{d}{dr}$.\n\nLet $\\chi_i(r)$ be a basis function on the reference element and $\\psi_i(x)$ be the corresponding basis function on the physical element, such that $\\psi_i(x(r)) = \\chi_i(r)$.\n\nThe physical element mass matrix $M^K$ has entries:\n$$\nM_{ij}^K = \\int_{K} \\psi_i(x) \\psi_j(x) \\,dx\n$$\nChanging variables to the reference coordinate $r$:\n$$\nM_{ij}^K = \\int_{-1}^{1} \\psi_i(x(r)) \\psi_j(x(r)) \\frac{dx}{dr} \\,dr = \\int_{-1}^{1} \\chi_i(r) \\chi_j(r) \\left(\\frac{h}{2}\\right) \\,dr = \\frac{h}{2} \\int_{-1}^{1} \\chi_i(r) \\chi_j(r) \\,dr\n$$\nThis gives the relation $M_{ij}^K = \\frac{h}{2} M_{ij}^I$. The scaling factor for the mass matrix is $\\frac{h}{2}$.\n\nThe physical element stiffness matrix $S^K$ has entries:\n$$\nS_{ij}^K = \\int_{K} \\frac{d\\psi_i}{dx}(x) \\frac{d\\psi_j}{dx}(x) \\,dx\n$$\nChanging variables:\n$$\nS_{ij}^K = \\int_{-1}^{1} \\left(\\frac{2}{h} \\frac{d\\chi_i}{dr}(r)\\right) \\left(\\frac{2}{h} \\frac{d\\chi_j}{dr}(r)\\right) \\left(\\frac{h}{2}\\right) \\,dr = \\frac{4}{h^2} \\frac{h}{2} \\int_{-1}^{1} \\frac{d\\chi_i}{dr}(r) \\frac{d\\chi_j}{dr}(r) \\,dr\n$$\nThis gives the relation $S_{ij}^K = \\frac{2}{h} S_{ij}^I$. The scaling factor for the stiffness matrix is $\\frac{2}{h}$.\n\n**Final Answer Derivation**\n\nThe question asks for the expression for a diagonal entry $M_{ii}$ of the element mass matrix on a physical element of length $h$, using a nodal Lagrange basis at Gauss–Legendre nodes with exact Gauss–Legendre quadrature.\n\nFrom Part 2, we established that for a Lagrange basis on GL nodes, the reference element mass matrix $M^I$ is diagonal, with entries $M_{ij}^I = w_i \\delta_{ij}$. The diagonal entries are therefore $M_{ii}^I = w_i$, where $w_i$ is the $i$-th GL quadrature weight.\n\nFrom Part 3, we found that the physical element mass matrix $M^K$ is related to the reference matrix by the scaling factor $\\frac{h}{2}$. Thus, $M_{ij}^K = \\frac{h}{2} M_{ij}^I$.\n\nCombining these results, the diagonal entries of the physical mass matrix are:\n$$\nM_{ii}^K = \\frac{h}{2} M_{ii}^I = \\frac{h}{2} w_i\n$$\nThis is the required single closed-form analytic expression for each diagonal entry, where $w_i$ denotes the $i$-th quadrature weight corresponding to the $i$-th Gauss-Legendre node.", "answer": "$$\\boxed{\\frac{h w_i}{2}}$$", "id": "3378044"}, {"introduction": "While the elemental matrices are defined by integrals, in practice they are computed using numerical quadrature, a step that can introduce errors if not handled carefully. This practice focuses on the stiffness matrix, which arises from the diffusion term in Poisson and heat equations, and challenges you to determine the minimum quadrature accuracy needed to assemble it without error [@problem_id:3378064]. Successfully completing this task is crucial for writing a correct and efficient DG code, as it prevents the subtle but significant issue of aliasing from corrupting your numerical solution.", "problem": "Consider the steady-state heat (Poisson) equation with constant diffusion coefficient on a single affine one-dimensional element mapped from the reference interval $[-1,1]$. Using the Discontinuous Galerkin (DG) method with the Symmetric Interior Penalty Galerkin (SIPG) formulation, focus on the elemental volume stiffness bilinear form $a_{E}(u,v) = \\int_{E} \\kappa \\,\\partial_{x} u \\,\\partial_{x} v \\,\\mathrm{d}x$, where $\\kappa$ is constant and the mapping from the reference element is affine, so that Jacobian factors are constant. Let the local trial and test spaces be polynomials of degree at most $p$ on the reference element, and consider the modal monomial basis $\\{\\phi_{k}(x)\\}_{k=0}^{p}$ with $\\phi_{k}(x) = x^{k}$. Thus, $\\partial_{x}\\phi_{k}(x) = k\\,x^{k-1}$ for $k \\geq 1$ and $\\partial_{x}\\phi_{0}(x) = 0$.\n\nDefine the exact elemental stiffness entries $K_{ij} = \\int_{-1}^{1} \\partial_{x}\\phi_{i}(x)\\,\\partial_{x}\\phi_{j}(x)\\,\\mathrm{d}x$ for $i,j \\in \\{0,1,\\dots,p\\}$. For numerical integration, use Gauss–Legendre quadrature on $[-1,1]$ that is exact for polynomials up to degree $D$ (the quadrature exactness degree), so the computed entries are $K_{ij}^{(D)} = \\sum_{\\ell=1}^{Q} w_{\\ell}\\,\\partial_{x}\\phi_{i}(x_{\\ell})\\,\\partial_{x}\\phi_{j}(x_{\\ell})$, where $\\{(x_{\\ell},w_{\\ell})\\}_{\\ell=1}^{Q}$ are the quadrature nodes and weights and $D = 2Q - 1$.\n\nTo quantify the impact of under-integration on the diffusion operator assembly, define the aliasing count\n$A(D,p) = \\#\\left\\{(i,j)\\in\\{1,\\dots,p\\}^{2} \\,\\middle|\\, i+j-2 > D \\text{ and } i+j-2 \\text{ is even}\\right\\}$,\nwhich counts the number of stiffness entries whose exact integrand polynomial has even degree strictly greater than $D$ (hence nonzero exact integral on $[-1,1]$) and will not be integrated exactly by the quadrature.\n\nStarting from the definitions above and the fundamental property that Gauss–Legendre quadrature integrates exactly all polynomials up to its exactness degree $D$, derive $A(D,p)$ in terms of $p$ and $D$, and then determine the minimum quadrature exactness degree $D_{\\min}$ such that $A(D,p) = 0$ for all pairs $(i,j)$ with $1 \\leq i,j \\leq p$. Express your final answer for $D_{\\min}$ as a closed-form analytic expression in $p$. No rounding is required, and no units are needed.", "solution": "The problem asks for the minimum quadrature exactness degree $D_{\\min}$ such that the aliasing count $A(D,p)$ is zero. The analysis begins with the elemental stiffness matrix entries and the properties of the numerical integration scheme.\n\nThe elemental stiffness matrix entries on the reference element $[-1,1]$ are given by\n$$ K_{ij} = \\int_{-1}^{1} \\partial_{x}\\phi_{i}(x)\\,\\partial_{x}\\phi_{j}(x)\\,\\mathrm{d}x $$\nfor $i,j \\in \\{0, 1, \\dots, p\\}$. The basis functions are the monomials $\\phi_k(x) = x^k$. Their derivatives are $\\partial_x \\phi_k(x) = kx^{k-1}$ for $k \\ge 1$, and $\\partial_x \\phi_0(x) = 0$.\n\nIf either $i=0$ or $j=0$, the corresponding derivative is zero, which results in $K_{ij}=0$. These entries are computed exactly regardless of the quadrature rule. The problem correctly focuses on the indices $i,j \\in \\{1, \\dots, p\\}$, for which the derivatives are non-zero. For these indices, the integrand is:\n$$ \\mathcal{I}_{ij}(x) = \\partial_{x}\\phi_{i}(x)\\,\\partial_{x}\\phi_{j}(x) = (ix^{i-1})(jx^{j-1}) = ijx^{i+j-2} $$\nThis integrand, $\\mathcal{I}_{ij}(x)$, is a polynomial in $x$ of degree $\\deg(\\mathcal{I}_{ij}) = i+j-2$.\n\nThe numerical integration is performed using a Gauss-Legendre quadrature rule that is exact for all polynomials of degree up to $D$. This means that the computed stiffness entry $K_{ij}^{(D)}$ is equal to the exact entry $K_{ij}$ if the degree of the integrand is less than or equal to $D$:\n$$ K_{ij}^{(D)} = K_{ij} \\quad \\text{if} \\quad i+j-2 \\le D $$\nIf $i+j-2 > D$, the quadrature rule is not guaranteed to produce the exact integral, and an aliasing error can occur.\n\nThe aliasing count, $A(D,p)$, is defined to quantify the number of entries susceptible to this error. The definition is:\n$$ A(D,p) = \\#\\left\\{(i,j)\\in\\{1,\\dots,p\\}^{2} \\,\\middle|\\, i+j-2 > D \\text{ and } i+j-2 \\text{ is even}\\right\\} $$\nThis definition incorporates two conditions for a pair $(i,j)$ to contribute to the count:\n1.  $i+j-2 > D$: The degree of the integrand polynomial exceeds the quadrature's degree of exactness. This is the condition for potential numerical inaccuracy.\n2.  $i+j-2$ is even: The exact integral $\\int_{-1}^{1} ijx^{i+j-2} \\mathrm{d}x$ is non-zero, as the integral of an odd power of $x$ over a symmetric interval $[-1,1]$ is zero. An integration error is only meaningful if the value being integrated is not zero.\n\nThe objective is to find the minimum degree of exactness, $D_{\\min}$, such that $A(D,p) = 0$. For $A(D,p)$ to be zero, the set of pairs $(i,j)$ satisfying the two conditions must be empty.\n$$ \\left\\{(i,j)\\in\\{1,\\dots,p\\}^{2} \\,\\middle|\\, i+j-2 > D \\text{ and } i+j-2 \\text{ is even}\\right\\} = \\emptyset $$\nA sufficient way to ensure this set is empty is to ensure that the first condition, $i+j-2 > D$, is never met for any pair $(i,j)$ in the specified range. If this inequality is never true, its conjunction with any other condition will also never be true.\n\nTherefore, we seek a value of $D$ such that for all $i,j \\in \\{1, 2, \\dots, p\\}$, the following inequality holds:\n$$ i+j-2 \\le D $$\nTo satisfy this for all possible pairs $(i,j)$, $D$ must be greater than or equal to the maximum possible value of the expression $i+j-2$.\n$$ D \\ge \\max_{i,j \\in \\{1,\\dots,p\\}} (i+j-2) $$\nThe maximum value of the expression $i+j-2$ occurs when both $i$ and $j$ take their maximum possible values. In the set $\\{1, 2, \\dots, p\\}$, the maximum value for both $i$ and $j$ is $p$.\nSubstituting $i=p$ and $j=p$ into the expression gives the maximum degree of any integrand polynomial we must integrate:\n$$ \\max_{i,j \\in \\{1,\\dots,p\\}} (i+j-2) = p+p-2 = 2p-2 $$\nThus, to ensure that all integrand polynomials $\\mathcal{I}_{ij}(x)$ have a degree less than or equal to $D$, we must have:\n$$ D \\ge 2p-2 $$\nThe minimum integer value of $D$ that satisfies this condition is $D_{\\min} = 2p-2$.\n\nIf we choose $D = 2p-2$, then for any $(i,j) \\in \\{1,\\dots,p\\}^2$, we have $i+j-2 \\le p+p-2 = 2p-2 = D$. This means the condition $i+j-2 > D$ is never satisfied, and thus $A(2p-2, p) = 0$.\n\nTo confirm this is the minimum value, consider $D = 2p-3$. For this choice, we examine the pair $(i,j) = (p,p)$. The degree of the integrand is $p+p-2 = 2p-2$. The condition $i+j-2 > D$ becomes $2p-2 > 2p-3$, which is true. The second condition, $i+j-2$ is even, is also true since $2p-2 = 2(p-1)$ is always an even integer for any integer $p \\ge 1$. Therefore, for $D=2p-3$, the pair $(p,p)$ contributes to the aliasing count, so $A(2p-3, p) \\ge 1$. This confirms that $D = 2p-2$ is the minimum required degree of exactness.", "answer": "$$\\boxed{2p-2}$$", "id": "3378064"}, {"introduction": "After assembling the global matrices, we must analyze the properties of the resulting semi-discrete system, especially for time-dependent problems like the heat equation. This exercise guides you through a spectral analysis of the Symmetric Interior Penalty Galerkin (SIPG) operator to determine its eigenvalues, which govern the stability of the system [@problem_id:3378059]. Understanding the relationship between the spectral radius, the mesh size $h$, and the polynomial degree $k$ is essential for setting a stable time step in any explicit time-marching scheme.", "problem": "Consider the one-dimensional heat equation $u_{t} = \\kappa \\, u_{xx}$ on a periodic interval $[0,L]$ with thermal diffusivity $\\kappa \\equiv 1$. Discretize the spatial operator using the Symmetric Interior Penalty Galerkin (SIPG) method on a uniform mesh with $N$ elements of size $h = L/N$. Use piecewise-constant polynomials (degree $k=0$) on each element with a canonical elementwise basis. Let the standard SIPG bilinear form be defined by the penalty-on-jumps formulation on faces, with penalty coefficient $\\tau/h$, where $\\tau>0$ is dimensionless, and let the semi-discrete system be written in matrix form as $M \\, \\dot{U}(t) = -A \\, U(t)$, where $M$ is the mass matrix and $A$ is the SIPG stiffness matrix. Assume periodic boundary conditions and the canonical orientation of jumps so that the assembled $A$ is circulant.\n\nUsing discrete Fourier analysis on the uniform mesh, derive the exact eigenvalues of the generalized eigenproblem $A \\, \\Phi = \\lambda \\, M \\, \\Phi$ for the SIPG operator with $k=0$ and show how the spectral radius depends on $h$ and the penalty parameter $\\tau$. Then, adopt the commonly used degree-dependent penalty scaling $\\tau = c \\, (k+1)^{2}$ with $c>0$ independent of $h$ and $k$, and express the spectral radius as a closed-form analytic function of $k$ and $h$.\n\nYour final answer must be a single closed-form analytic expression for the spectral radius in terms of $c$, $k$, and $h$, with no units. Do not provide inequalities. No rounding is required.", "solution": "The problem requires a spectral analysis of the SIPG spatial discretization for the 1D heat equation, specifically for piecewise-constant ($k=0$) polynomials on a uniform periodic mesh. We need to find the eigenvalues of the generalized eigenproblem $A \\Phi = \\lambda M \\Phi$, where $M$ is the mass matrix and $A$ is the SIPG stiffness matrix.\n\n**1. Constructing the Mass and Stiffness Matrices**\n\nLet the domain $[0,L]$ be divided into $N$ elements $I_j$ of size $h=L/N$. For a piecewise-constant basis, the $j$-th basis function $\\phi_j(x)$ is 1 on element $I_j$ and 0 elsewhere. The vector of unknowns is $U(t)$, where $u_h(x,t) = \\sum_j U_j(t) \\phi_j(x)$.\n\nThe mass matrix entries $M_{ij} = \\int_{0}^{L} \\phi_i(x) \\phi_j(x) \\, dx$ are non-zero only for $i=j$ because the basis functions have disjoint support. The diagonal entries are:\n$$\nM_{jj} = \\int_{I_j} 1^2 \\, dx = h\n$$\nThus, the mass matrix is $M = hI$, where $I$ is the identity matrix.\n\nThe SIPG stiffness matrix $A$ has entries $A_{ij} = a(\\phi_j, \\phi_i)$, where $a(u,v)$ is the bilinear form for the operator $-u_{xx}$. For piecewise-constant polynomials ($k=0$), the derivatives inside elements are zero. The standard SIPG formulation simplifies to only the penalty term, which acts on the jumps at element faces:\n$$\na(u,v) = \\sum_{\\text{faces}} \\frac{\\tau}{h} [u][v]\n$$\nTo find the $i$-th row of the matrix product $AU$, we compute $a(u_h, \\phi_i)$. The test function $\\phi_i$ only has non-zero jumps at its two faces, $x_{i-1/2}$ and $x_{i+1/2}$. With a standard orientation, the jump $[\\phi_i]$ is 1 at $x_{i-1/2}$ and -1 at $x_{i+1/2}$. The jumps in the solution $u_h$ are $[u_h]_{i-1/2} = U_i - U_{i-1}$ and $[u_h]_{i+1/2} = U_{i+1} - U_i$.\nPutting this together:\n$$\na(u_h, \\phi_i) = \\frac{\\tau}{h} \\left( [u_h]_{i-1/2}[\\phi_i]_{i-1/2} + [u_h]_{i+1/2}[\\phi_i]_{i+1/2} \\right) = \\frac{\\tau}{h} \\left( (U_i - U_{i-1})(1) + (U_{i+1} - U_i)(-1) \\right)\n$$\n$$\na(u_h, \\phi_i) = \\frac{\\tau}{h} (-U_{i+1} + 2U_i - U_{i-1})\n$$\nThis corresponds to the action of the standard 1D discrete Laplacian matrix. Accounting for periodic boundary conditions, the matrix $A$ is $\\frac{\\tau}{h}$ times a circulant matrix with the generating row $(2, -1, 0, \\dots, 0, -1)$.\n\n**2. Solving the Eigenproblem**\n\nThe generalized eigenproblem $A \\Phi = \\lambda M \\Phi$ becomes $A \\Phi = \\lambda (hI) \\Phi$, which simplifies to the standard eigenproblem for the matrix $M^{-1}A$:\n$$\n\\frac{1}{h}A \\Phi = \\lambda \\Phi\n$$\nThe eigenvalues $\\lambda$ are the eigenvalues of the matrix $\\frac{1}{h}A$. Let $C$ be the circulant matrix component of $A$, so $A = \\frac{\\tau}{h} C$. Then we are finding the eigenvalues of $\\frac{\\tau}{h^2}C$.\n\nThe eigenvalues $\\mu_j$ of the $N \\times N$ circulant matrix $C$ (with first row $(2, -1, \\dots, -1)$) are found using discrete Fourier analysis:\n$$\n\\mu_j = 2 - e^{i \\frac{2\\pi j}{N}} - e^{-i \\frac{2\\pi j}{N}} = 2 - 2\\cos\\left(\\frac{2\\pi j}{N}\\right) = 4\\sin^2\\left(\\frac{\\pi j}{N}\\right)\n$$\nfor $j = 0, 1, \\dots, N-1$.\n\nThe eigenvalues of the operator $M^{-1}A$ are therefore:\n$$\n\\lambda_j = \\frac{\\tau}{h^2} \\mu_j = \\frac{4\\tau}{h^2} \\sin^2\\left(\\frac{\\pi j}{N}\\right)\n$$\n\n**3. Determining the Spectral Radius**\n\nThe spectral radius, $\\rho(M^{-1}A)$, is the maximum absolute value of the eigenvalues. Since all $\\lambda_j \\ge 0$:\n$$\n\\rho(M^{-1}A) = \\max_{j} \\lambda_j = \\frac{4\\tau}{h^2} \\max_{j} \\sin^2\\left(\\frac{\\pi j}{N}\\right) = \\frac{4\\tau}{h^2}\n$$\nThe maximum value of the sine term is 1 (approached as $N \\to \\infty$ or achieved for $j=N/2$ if $N$ is even), so we use this value for a general stability bound.\n\nFinally, we adopt the degree-dependent penalty scaling $\\tau = c(k+1)^2$. Substituting this into our expression for the spectral radius gives the final result:\n$$\n\\rho = \\frac{4}{h^2} \\left[ c(k+1)^2 \\right] = \\frac{4c(k+1)^2}{h^2}\n$$\nThis provides the spectral radius as a function of $c$, $k$, and $h$.", "answer": "$$\n\\boxed{\\frac{4c(k+1)^2}{h^2}}\n$$", "id": "3378059"}]}