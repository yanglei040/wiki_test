{"hands_on_practices": [{"introduction": "This first exercise explores a foundational property of polynomial interpolation that gives spectral methods their power. By considering the differentiation of a polynomial using a spectral differentiation matrix, you will discover the conditions under which the numerical result is not just an approximation, but exact. This practice highlights the principle that the polynomial interpolant of degree $N$ for a function that is already a polynomial of degree at most $N$ is the polynomial itself [@problem_id:3409312].", "problem": "Consider the spectral collocation discretization on the interval $\\left[-1,1\\right]$ using Chebyshev–Gauss–Lobatto (CGL) nodes. Let $N=7$ so there are $N+1=8$ nodes $x_i=\\cos\\left(\\frac{\\pi i}{N}\\right)$ for $i=0,1,\\dots,N$. Define the test polynomial\n$$\np(x)=x^{7}-\\frac{3}{5}x^{6}+\\sqrt{2}\\,x^{5}-\\frac{1}{7}x^{4}+\\pi\\,x^{3}-\\exp(1)\\,x^{2}+\\frac{1}{3}x-\\ln(2).\n$$\nUsing the barycentric Lagrange basis on the CGL nodes, construct the nodal differentiation matrix $D$ associated with these nodes from first principles, then compute the discrete derivative vector $D\\,\\mathbf{p}$, where $\\mathbf{p}=\\left(p(x_0),p(x_1),\\dots,p(x_7)\\right)^{\\top}$. Compare $D\\,\\mathbf{p}$ to the exact nodal derivative vector $\\mathbf{p}'=\\left(p'(x_0),p'(x_1),\\dots,p'(x_7)\\right)^{\\top}$ and determine the maximum norm of the nodal error\n$$\nE_{\\infty}=\\max_{0\\leq i\\leq 7}\\left|\\,\\left(D\\,\\mathbf{p}\\right)_i - p'(x_i)\\,\\right|.\n$$\nYour final answer must be the exact value of $E_{\\infty}$ as a single real number. No rounding is required. This computation confirms the spectral accuracy of the discrete derivative on appropriate nodes for this test polynomial in the context of Discontinuous Galerkin (DG) and spectral methods.", "solution": "The problem is validated as self-contained, scientifically grounded, and well-posed. All data and definitions required for its resolution are provided, and there are no internal contradictions or violations of established scientific principles. The problem is a direct application of fundamental theorems in the field of numerical analysis, specifically concerning spectral methods and polynomial interpolation.\n\nThe problem asks for the maximum nodal error when differentiating a specific polynomial, $p(x)$, using a spectral collocation method on Chebyshev-Gauss-Lobatto (CGL) nodes. The number of nodes is given by $N+1=8$, corresponding to a maximum polynomial degree of $N=7$. The nodes are defined on the interval $[-1, 1]$ by the formula $x_i = \\cos(\\frac{\\pi i}{N})$ for $i=0, 1, \\dots, N$. With $N=7$, the nodes are $x_i = \\cos(\\frac{\\pi i}{7})$ for $i=0, 1, \\dots, 7$.\n\nThe polynomial to be differentiated is:\n$$\np(x)=x^{7}-\\frac{3}{5}x^{6}+\\sqrt{2}\\,x^{5}-\\frac{1}{7}x^{4}+\\pi\\,x^{3}-\\exp(1)\\,x^{2}+\\frac{1}{3}x-\\ln(2)\n$$\nThe degree of this polynomial is $\\deg(p)=7$.\n\nThe core of the spectral differentiation method lies in polynomial interpolation. Given a set of data points $(x_i, f(x_i))$ for $i=0, \\dots, N$, we first construct a unique polynomial of degree at most $N$, let us call it $\\mathcal{I}_N f(x)$, that interpolates the data, i.e., $\\mathcal{I}_N f(x_i) = f(x_i)$ for all $i$. The derivative of the function $f(x)$ at the nodes is then approximated by the exact derivative of the interpolating polynomial evaluated at those nodes, $(\\mathcal{I}_N f)'(x_i)$.\n\nThe nodal differentiation matrix, $D$, is an $(N+1) \\times (N+1)$ matrix that formalizes this operation. If $\\mathbf{f}$ is the vector of function values at the nodes, $\\mathbf{f} = (f(x_0), f(x_1), \\dots, f(x_N))^{\\top}$, then the vector of approximate derivatives at these nodes is given by the matrix-vector product $D\\mathbf{f}$. The entries of this matrix are given by $D_{ij} = \\ell_j'(x_i)$, where $\\ell_j(x)$ is the $j$-th Lagrange basis polynomial.\n\nThe problem requires constructing $D$ from first principles using the barycentric Lagrange basis. For the specified CGL nodes, the barycentric weights are given by $w_j = (-1)^j \\delta_j$, where $\\delta_0 = \\delta_N = 1/2$ and $\\delta_j = 1$ for $j=1, \\dots, N-1$. For $N=7$, these weights are:\n$$\nw_0 = \\frac{1}{2}, \\quad w_1 = -1, \\quad w_2 = 1, \\quad w_3 = -1, \\quad w_4 = 1, \\quad w_5 = -1, \\quad w_6 = 1, \\quad w_7 = -\\frac{1}{2}\n$$\nUsing these weights, the entries of the differentiation matrix $D$ can be constructed as follows:\nThe off-diagonal entries are given by:\n$D_{ij} = \\frac{w_j/w_i}{x_i - x_j}$ for $i \\neq j$\nThe diagonal entries are given by specific formulas for CGL nodes to avoid numerical instability:\n$D_{00} = \\frac{2N^2+1}{6}$\n$D_{NN} = -\\frac{2N^2+1}{6}$\n$D_{ii} = -\\frac{x_i}{2(1-x_i^2)}$ for $i=1, \\dots, N-1$\nFor $N=7$, this yields $D_{00} = \\frac{2(7^2)+1}{6} = \\frac{99}{6} = \\frac{33}{2}$ and $D_{77} = -\\frac{33}{2}$.\n\nWhile these formulas allow for the explicit construction of the matrix $D$, a crucial theoretical observation makes the direct computation of $D$, $\\mathbf{p}$, and $p'(x_i)$ unnecessary. The central principle of polynomial interpolation is that for any set of $N+1$ distinct points, there exists a unique polynomial of degree at most $N$ that passes through these points.\n\nIn this problem, the function to be differentiated, $p(x)$, is itself a polynomial. The degree of $p(x)$ is $7$. The spectral method employs an interpolating polynomial of degree at most $N=7$. Therefore, the unique polynomial of degree at most $7$ that interpolates the values of $p(x)$ at the $8$ distinct CGL nodes, $(x_i, p(x_i))$, must be the polynomial $p(x)$ itself.\nSymbolically, if we denote the interpolating polynomial by $\\mathcal{I}_7 p(x)$, we have:\n$$\n\\mathcal{I}_7 p(x) = p(x)\n$$\nThe discrete differentiation operation computes the derivative of the interpolant at the nodes. Thus, the $i$-th component of the discrete derivative vector $D\\mathbf{p}$ is:\n$$\n(D\\mathbf{p})_i = (\\mathcal{I}_7 p)'(x_i)\n$$\nSince $\\mathcal{I}_7 p(x) = p(x)$, it follows that $(\\mathcal{I}_7 p)'(x) = p'(x)$. Therefore, the value computed by the spectral method at each node is the exact value of the derivative:\n$$\n(D\\mathbf{p})_i = p'(x_i)\n$$\nThis holds for all nodes $i=0, 1, \\dots, 7$.\n\nThe problem asks for the maximum norm of the nodal error, which is defined as:\n$$\nE_{\\infty} = \\max_{0 \\leq i \\leq 7} |(D\\mathbf{p})_i - p'(x_i)|\n$$\nSubstituting the result from our analysis:\n$$\nE_{\\infty} = \\max_{0 \\leq i \\leq 7} |p'(x_i) - p'(x_i)| = \\max_{0 \\leq i \\leq 7} |0|\n$$\nThis leads to the conclusion that the error is exactly zero at every node.\n\nThe maximum norm of the nodal error is therefore:\n$$\nE_{\\infty} = 0\n$$\nThis result is not an approximation. It is an exact consequence of the properties of polynomial interpolation. For any polynomial of degree less than or equal to $N$, the spectral differentiation on $N+1$ nodes is exact. This is a foundational property of spectral methods and distinguishes them from lower-order methods like finite differences, which would not yield an exact derivative for a degree-$7$ polynomial. The complex coefficients in $p(x)$ are irrelevant to this conclusion, which depends only on the degree of the polynomial relative to the number of collocation points.", "answer": "$$\n\\boxed{0}\n$$", "id": "3409312"}, {"introduction": "While interpolation can be exact for polynomials, its stability when approximating general functions is a critical concern. This practice introduces the Lebesgue constant, which quantifies the worst-case amplification of errors in the data values and is determined by the properties of the Lagrange basis. You will perform a hands-on calculation of the Lebesgue function, $\\Lambda_{n}(x) = \\sum_{j=0}^{n} |\\ell_{j}(x)|$, for both equispaced and Chebyshev nodes, providing a concrete understanding of why the choice of interpolation points is paramount for numerical stability [@problem_id:3409339].", "problem": "Let $\\Lambda_{n}(x)$ denote the Lebesgue function for degree-$n$ polynomial interpolation on $[-1,1]$, defined by the Lagrange basis polynomials $\\{\\ell_{j}(x)\\}_{j=0}^{n}$ associated with nodes $\\{x_{j}\\}_{j=0}^{n}$ via\n$$\n\\Lambda_{n}(x) \\equiv \\sum_{j=0}^{n} |\\ell_{j}(x)|, \\quad \\text{where} \\quad \\ell_{j}(x) \\equiv \\prod_{\\substack{m=0 \\\\ m\\neq j}}^{n} \\frac{x - x_{m}}{x_{j} - x_{m}}.\n$$\nThe Lebesgue constant is $\\max_{x \\in [-1,1]} \\Lambda_{n}(x)$ and characterizes the operator norm of the interpolation map in the uniform norm, a stability indicator central to spectral and Discontinuous Galerkin (DG) discretizations.\n\nUsing only the above fundamental definitions, consider $n=3$ so that there are $n+1 = 4$ nodes. Work out $\\Lambda_{3}(x)$ explicitly for the following two node families on $[-1,1]$:\n- Equispaced nodes: $x_{0}=-1$, $x_{1}=-\\frac{1}{3}$, $x_{2}=\\frac{1}{3}$, $x_{3}=1$.\n- Chebyshev–Lobatto nodes: $x_{j}=\\cos\\!\\left(\\frac{j\\pi}{3}\\right)$ for $j \\in \\{0,1,2,3\\}$, i.e., $x_{0}=1$, $x_{1}=\\frac{1}{2}$, $x_{2}=-\\frac{1}{2}$, $x_{3}=-1$.\n\nDerive closed-form expressions for $\\Lambda_{3}(x)$ on each mesh by constructing the Lagrange basis polynomials and reducing the absolute-value sum using symmetry and algebraic identities implied by the definition. Determine the exact values of the maxima of $\\Lambda_{3}(x)$ on $[-1,1]$ for each node family. Report the two exact maxima, in the order (equispaced, Chebyshev–Lobatto), as a single row matrix. No rounding is permitted, and the final answers must be exact analytic expressions without units.", "solution": "We start from the definition of the Lagrange basis polynomials,\n$$\n\\ell_{j}(x) = \\prod_{\\substack{m=0 \\\\ m \\neq j}}^{3} \\frac{x - x_{m}}{x_{j} - x_{m}},\n$$\nand the Lebesgue function,\n$$\n\\Lambda_{3}(x) = \\sum_{j=0}^{3} |\\ell_{j}(x)|.\n$$\nBecause both node sets are symmetric about $x=0$, the Lebesgue function will be even, so it suffices to analyze $x \\in [0,1]$ and extend by symmetry.\n\n**Case I: Chebyshev–Lobatto nodes** $x \\in \\{-1,-\\frac{1}{2},\\frac{1}{2},1\\}$. Label the nodes as $a=-1$, $b=-\\frac{1}{2}$, $c=\\frac{1}{2}$, $d=1$. Direct application of the definition yields\n$$\n\\ell_{a}(x) = -\\frac{2}{3}\\,(x+\\tfrac{1}{2})(x-\\tfrac{1}{2})(x-1), \\quad\n\\ell_{b}(x) = \\frac{4}{3}\\,(x+1)(x-\\tfrac{1}{2})(x-1),\n$$\n$$\n\\ell_{c}(x) = -\\frac{4}{3}\\,(x+1)(x+\\tfrac{1}{2})(x-1), \\quad\n\\ell_{d}(x) = \\frac{2}{3}\\,(x+1)(x+\\tfrac{1}{2})(x-\\tfrac{1}{2}).\n$$\nOn $[0,\\frac{1}{2}]$, the sign pattern is $\\ell_{a}(x) \\le 0$, $\\ell_{b}(x) \\ge 0$, $\\ell_{c}(x) \\ge 0$, $\\ell_{d}(x) \\le 0$. Hence\n$$\n\\Lambda_{3}(x) = -\\ell_{a}(x) + \\ell_{b}(x) + \\ell_{c}(x) - \\ell_{d}(x) = 1 - 2\\big(\\ell_{a}(x) + \\ell_{d}(x)\\big).\n$$\nA key simplification comes from factoring the common terms:\n$$\n\\ell_{a}(x) + \\ell_{d}(x) = -\\frac{2}{3}(x+\\tfrac{1}{2})(x-\\tfrac{1}{2})(x-1) + \\frac{2}{3}(x+1)(x+\\tfrac{1}{2})(x-\\tfrac{1}{2})\n$$\n$$\n= \\frac{2}{3}(x+\\tfrac{1}{2})(x-\\tfrac{1}{2})\\big(-(x-1)+(x+1)\\big) = \\frac{4}{3}(x+\\tfrac{1}{2})(x-\\tfrac{1}{2}).\n$$\nTherefore on $[0,\\frac{1}{2}]$,\n$$\n\\Lambda_{3}(x) = 1 - \\frac{8}{3}\\left(x+\\frac{1}{2}\\right)\\left(x-\\frac{1}{2}\\right) = 1 - \\frac{8}{3}\\left(x^{2}-\\frac{1}{4}\\right) = \\frac{5}{3} - \\frac{8}{3}x^{2}.\n$$\nThus $\\Lambda_{3}(x)$ is a concave quadratic in $x^{2}$ on $[0,\\frac{1}{2}]$ with maximum at $x=0$ equal to $\\frac{5}{3}$.\n\nOn $[\\frac{1}{2},1]$, the sign pattern is $\\ell_{a}(x) \\ge 0$, $\\ell_{b}(x) \\le 0$, $\\ell_{c}(x) \\ge 0$, $\\ell_{d}(x) \\ge 0$, so\n$$\n\\Lambda_{3}(x) = \\ell_{a}(x) - \\ell_{b}(x) + \\ell_{c}(x) + \\ell_{d}(x) = 1 - 2\\,\\ell_{b}(x).\n$$\nLet $h(x) \\equiv (x+1)(x-\\frac{1}{2})(x-1)$ so that $\\ell_{b}(x) = \\frac{4}{3} h(x)$. Then\n$$\nh(x) = (x^{2}+\\tfrac{1}{2}x-\\tfrac{1}{2})(x-1) = x^{3} - \\frac{1}{2}x^{2} - x + \\frac{1}{2}.\n$$\nIts derivative $h'(x) = 3x^{2} - x - 1$ vanishes at $x^{\\star} = \\frac{1+\\sqrt{13}}{6} \\in (\\frac{1}{2},1)$, where $h''(x^{\\star}) = 6x^{\\star} - 1 > 0$, so $h$ attains a local minimum. Evaluating,\n$$\nh\\left(\\frac{1+\\sqrt{13}}{6}\\right) = \\frac{35 - 13\\sqrt{13}}{108}, \\quad \\Rightarrow \\quad \\ell_{b,\\min} = \\frac{4}{3}\\,h\\left(\\frac{1+\\sqrt{13}}{6}\\right) = \\frac{35 - 13\\sqrt{13}}{81}.\n$$\nThus on $[\\frac{1}{2},1]$,\n$$\n\\max \\Lambda_{3}(x) = 1 - 2\\,\\ell_{b,\\min} = 1 - \\frac{2(35 - 13\\sqrt{13})}{81} = \\frac{11 + 26\\sqrt{13}}{81},\n$$\nwhich is strictly less than $\\frac{5}{3}$. Hence the Chebyshev–Lobatto Lebesgue constant is\n$$\n\\max_{x \\in [-1,1]} \\Lambda_{3}(x) = \\frac{5}{3}.\n$$\n\n**Case II: Equispaced nodes** $x \\in \\{-1,-\\frac{1}{3},\\frac{1}{3},1\\}$. Label the nodes as $a=-1$, $b=-\\frac{1}{3}$, $c=\\frac{1}{3}$, $d=1$. From the definition,\n$$\n\\ell_{a}(x) = -\\frac{9}{16}\\,(x+\\tfrac{1}{3})(x-\\tfrac{1}{3})(x-1), \\quad\n\\ell_{b}(x) = \\frac{27}{16}\\,(x+1)(x-\\tfrac{1}{3})(x-1),\n$$\n$$\n\\ell_{c}(x) = -\\frac{27}{16}\\,(x+1)(x+\\tfrac{1}{3})(x-1), \\quad\n\\ell_{d}(x) = \\frac{9}{16}\\,(x+1)(x+\\tfrac{1}{3})(x-\\tfrac{1}{3}).\n$$\nOn $[0,\\frac{1}{3}]$, the signs are $\\ell_{a}(x) \\le 0$, $\\ell_{b}(x) \\ge 0$, $\\ell_{c}(x) \\ge 0$, $\\ell_{d}(x) \\le 0$, hence\n$$\n\\Lambda_{3}(x) = -\\ell_{a}(x) + \\ell_{b}(x) + \\ell_{c}(x) - \\ell_{d}(x) = 1 - 2\\big(\\ell_{a}(x) + \\ell_{d}(x)\\big).\n$$\nAs before, a cancellation occurs:\n$$\n\\ell_{a}(x) + \\ell_{d}(x) = -\\frac{9}{16}(x+\\tfrac{1}{3})(x-\\tfrac{1}{3})(x-1) + \\frac{9}{16}(x+1)(x+\\tfrac{1}{3})(x-\\tfrac{1}{3})\n$$\n$$\n= \\frac{9}{16}(x+\\tfrac{1}{3})(x-\\tfrac{1}{3})\\big(-(x-1)+(x+1)\\big) = \\frac{9}{8}(x+\\tfrac{1}{3})(x-\\tfrac{1}{3}).\n$$\nTherefore on $[0,\\frac{1}{3}]$,\n$$\n\\Lambda_{3}(x) = 1 - \\frac{9}{4}\\left(x+\\frac{1}{3}\\right)\\left(x-\\frac{1}{3}\\right) = 1 - \\frac{9}{4}\\left(x^{2}-\\frac{1}{9}\\right) = \\frac{5}{4} - \\frac{9}{4}x^{2},\n$$\nso the maximum there is at $x=0$ with value $\\frac{5}{4}$.\n\nOn $[\\frac{1}{3},1]$, the signs are $\\ell_{a}(x) \\ge 0$, $\\ell_{b}(x) \\le 0$, $\\ell_{c}(x) \\ge 0$, $\\ell_{d}(x) \\ge 0$, hence\n$$\n\\Lambda_{3}(x) = 1 - 2\\,\\ell_{b}(x).\n$$\nLet $g(x) \\equiv (x+1)(x-\\frac{1}{3})(x-1)$, so that $\\ell_{b}(x) = \\frac{27}{16}g(x)$. Expand\n$$\ng(x) = (x^{2} + \\tfrac{2}{3}x - \\tfrac{1}{3})(x-1) = x^{3} - \\frac{1}{3}x^{2} - x + \\frac{1}{3}.\n$$\nCritical points satisfy $g'(x) = 3x^{2} - \\frac{2}{3}x - 1 = 0$, i.e.,\n$$\n9x^{2} - 2x - 3 = 0 \\quad \\Rightarrow \\quad x^{\\star} = \\frac{1 + 2\\sqrt{7}}{9} \\in \\big(\\tfrac{1}{3},1\\big), \\quad g''(x^{\\star}) = 6x^{\\star} - \\frac{2}{3} > 0,\n$$\nso $g$ attains its minimum at $x^{\\star}$. Evaluating at $x^{\\star}$, set $s = \\sqrt{7}$ and compute\n$$\nx^{\\star} = \\frac{1 + 2s}{9}, \\quad (x^{\\star})^{2} = \\frac{29 + 4s}{81}, \\quad (x^{\\star})^{3} = \\frac{85 + 62s}{729}.\n$$\nThen\n$$\ng(x^{\\star}) = (x^{\\star})^{3} - \\frac{1}{3}(x^{\\star})^{2} - x^{\\star} + \\frac{1}{3} = \\frac{160 - 112s}{729} = \\frac{16(10 - 7s)}{729},\n$$\nand thus\n$$\n\\ell_{b,\\min} = \\frac{27}{16}\\,g(x^{\\star}) = \\frac{10 - 7\\sqrt{7}}{27}.\n$$\nHence on $[\\frac{1}{3},1]$,\n$$\n\\max \\Lambda_{3}(x) = 1 - 2\\,\\ell_{b,\\min} = 1 - \\frac{2(10 - 7\\sqrt{7})}{27} = \\frac{7 + 14\\sqrt{7}}{27}.\n$$\nThis exceeds $\\frac{5}{4}$, so the equispaced Lebesgue constant is\n$$\n\\max_{x \\in [-1,1]} \\Lambda_{3}(x) = \\frac{7 + 14\\sqrt{7}}{27}.\n$$\n\nConclusion and comparison. We have determined the exact maxima of the Lebesgue function for $n=3$:\n- Equispaced nodes $\\{-1,-\\frac{1}{3},\\frac{1}{3},1\\}$: $\\max \\Lambda_{3}(x) = \\frac{7 + 14\\sqrt{7}}{27}$.\n- Chebyshev–Lobatto nodes $\\{-1,-\\frac{1}{2},\\frac{1}{2},1\\}$: $\\max \\Lambda_{3}(x) = \\frac{5}{3}$.\n\nThese are close in magnitude. For this low degree, the equispaced set yields a slightly smaller Lebesgue constant, whereas for higher degrees the Chebyshev families are known to have asymptotically superior behavior in stability as reflected by the Lebesgue constant’s growth.", "answer": "$$\\boxed{\\begin{pmatrix}\\frac{7\\left(1+2\\sqrt{7}\\right)}{27} & \\frac{5}{3}\\end{pmatrix}}$$", "id": "3409339"}, {"introduction": "Building on the concept of stability, this final exercise places polynomial interpolation within the practical context of spectral and Discontinuous Galerkin (DG) methods. It challenges you to analyze how the stability of interpolation, characterized by the local Lebesgue constant, is affected by the geometric mapping from a standard reference element to physical mesh elements. This analysis is fundamental for designing robust and accurate $hp$-adaptive numerical schemes, particularly on domains with curved boundaries [@problem_id:3409330].", "problem": "Consider a one-dimensional mesh with elements $E_j = [x_{j-1}, x_j]$ and sizes $h_j = x_j - x_{j-1}$. On each element $E_j$, an interpolation operator of degree $p_j$ is defined by Lagrange basis polynomials associated with a set of distinct nodes obtained by mapping a fixed reference node set on $[-1,1]$ to $E_j$. Assume the mapping from the reference element to $E_j$ is affine of the form $x = \\alpha_j + \\beta_j \\hat{x}$, where $\\beta_j = h_j/2$ and $\\alpha_j = (x_{j-1}+x_j)/2$, and the interpolation is evaluated using the Lagrange basis or the barycentric formulation. Let the local Lebesgue function on $E_j$ be defined by $\\Lambda_j(x) = \\sum_{k=0}^{p_j} \\lvert \\ell_{j,k}(x) \\rvert$, where $\\ell_{j,k}(x)$ are the elementwise Lagrange basis polynomials, and let the local Lebesgue constant be $\\lVert \\Lambda_j \\rVert_{\\infty,E_j} = \\sup_{x \\in E_j} \\Lambda_j(x)$. In the context of Discontinuous Galerkin (DG) methods (Discontinuous Galerkin) and $hp$-adaptivity (simultaneous mesh-size $h$ and polynomial-degree $p$ adaptation), consider the following statements about the effect of nonuniform element sizes and mappings on the local Lebesgue constant, barycentric evaluation, and implications for stability.\n\nSelect all statements that are true.\n\nA. Under the affine mapping $x = \\alpha_j + \\beta_j \\hat{x}$ with $\\beta_j = h_j/2$, the local Lebesgue constant on $E_j$ is equal to the Lebesgue constant on the reference element for the same node set and degree $p_j$, and therefore nonuniform element sizes $h_j$ do not change $\\lVert \\Lambda_j \\rVert_{\\infty,E_j}$.\n\nB. Under the affine mapping $x = \\alpha_j + \\beta_j \\hat{x}$, the barycentric weights scale with $\\beta_j$ in such a way that the barycentric interpolant is rescaled by a factor depending on $h_j$, making interpolation on small elements inherently less accurate even in exact arithmetic; consequently $p$-refinement on small elements is unstable due to this rescaling.\n\nC. If the element mapping is nonaffine, $x = \\psi_j(\\hat{x})$, with a strongly varying Jacobian $J_j(\\hat{x}) = \\mathrm{d}\\psi_j/\\mathrm{d}\\hat{x}$ that clusters mapped nodes in physical coordinates, the local Lebesgue constant on $E_j$ can be larger than that of the same reference nodes on $[-1,1]$, which may degrade interpolation stability at high $p_j$.\n\nD. In DG time integration for linear hyperbolic problems, the explicit Courant–Friedrichs–Lewy (CFL) time-step restriction on each element is directly proportional to the inverse of the local Lebesgue constant; hence reducing $h_j$ lowers $\\lVert \\Lambda_j \\rVert_{\\infty,E_j}$ and increases the allowable time step.\n\nE. An $hp$-adaptive strategy that selects node sets with provably bounded Lebesgue constants (for example, Gauss–Lobatto–Chebyshev nodes) and evaluates interpolation in reference coordinates (or rescales barycentric weights by a common factor per element) avoids numerical instability due to nonuniform $h_j$; the exact interpolant is invariant under affine scaling, and finite-precision weight scaling can be mitigated without changing the interpolant.", "solution": "### Solution and Option Analysis\n\nWe begin by establishing the relationship between quantities on a physical element $E_j$ and the reference element $\\hat{E} = [-1,1]$ under the affine mapping $x(\\hat{x}) = \\alpha_j + \\beta_j \\hat{x}$. The inverse mapping is $\\hat{x}(x) = (x - \\alpha_j) / \\beta_j$. Let the reference nodes be $\\{\\hat{x}_k\\}_{k=0}^{p_j} \\subset [-1,1]$ and the physical nodes be $x_{j,k} = x(\\hat{x}_k)$.\n\n**A. Under the affine mapping $x = \\alpha_j + \\beta_j \\hat{x}$ with $\\beta_j = h_j/2$, the local Lebesgue constant on $E_j$ is equal to the Lebesgue constant on the reference element for the same node set and degree $p_j$, and therefore nonuniform element sizes $h_j$ do not change $\\lVert \\Lambda_j \\rVert_{\\infty,E_j}$.**\n\nThe Lagrange basis polynomial on the reference element is $\\hat{\\ell}_k(\\hat{x}) = \\prod_{i=0, i \\neq k}^{p_j} \\frac{\\hat{x} - \\hat{x}_i}{\\hat{x}_k - \\hat{x}_i}$.\nThe Lagrange basis polynomial on the physical element $E_j$ is $\\ell_{j,k}(x) = \\prod_{i=0, i \\neq k}^{p_j} \\frac{x - x_{j,i}}{x_{j,k} - x_{j,i}}$.\nBy substituting the affine mapping $x = \\alpha_j + \\beta_j \\hat{x}$ and $x_{j,k} = \\alpha_j + \\beta_j \\hat{x}_k$ into the expression for $\\ell_{j,k}(x)$, we find:\n$$ \\ell_{j,k}(x(\\hat{x})) = \\prod_{i=0, i \\neq k}^{p_j} \\frac{(\\alpha_j + \\beta_j \\hat{x}) - (\\alpha_j + \\beta_j \\hat{x}_i)}{(\\alpha_j + \\beta_j \\hat{x}_k) - (\\alpha_j + \\beta_j \\hatx_i)} = \\prod_{i=0, i \\neq k}^{p_j} \\frac{\\beta_j (\\hat{x} - \\hat{x}_i)}{\\beta_j (\\hat{x}_k - \\hat{x}_i)} = \\hat{\\ell}_k(\\hat{x}) $$\nThis shows that the basis functions are invariant under the affine mapping, i.e., $\\ell_{j,k}(x) = \\hat{\\ell}_k(\\hat{x}(x))$.\nThe local Lebesgue function is $\\Lambda_j(x) = \\sum_{k=0}^{p_j} |\\ell_{j,k}(x)|$. For any point $x \\in E_j$, which maps to $\\hat{x} \\in [-1,1]$, we have:\n$$ \\Lambda_j(x) = \\sum_{k=0}^{p_j} |\\ell_{j,k}(x)| = \\sum_{k=0}^{p_j} |\\hat{\\ell}_k(\\hat{x}(x))| = \\hat{\\Lambda}(\\hat{x}(x)) $$\nwhere $\\hat{\\Lambda}(\\hat{x})$ is the Lebesgue function on the reference element.\nThe local Lebesgue constant is the supremum of this function over the element:\n$$ \\lVert \\Lambda_j \\rVert_{\\infty,E_j} = \\sup_{x \\in E_j} \\Lambda_j(x) = \\sup_{\\hat{x} \\in [-1,1]} \\hat{\\Lambda}(\\hat{x}) = \\lVert \\hat{\\Lambda} \\rVert_{\\infty,[-1,1]} $$\nThis proves that the local Lebesgue constant on element $E_j$ is identical to the Lebesgue constant on the reference element. Its value depends on the choice of reference nodes and the polynomial degree $p_j$, but not on the element size $h_j$ (or the parameters $\\alpha_j, \\beta_j$ of the affine map). Therefore, nonuniform element sizes $h_j$ do not affect the local Lebesgue constant, assuming the degree $p_j$ and reference nodes are the same.\nThe statement is **Correct**.\n\n**B. Under the affine mapping $x = \\alpha_j + \\beta_j \\hat{x}$, the barycentric weights scale with $\\beta_j$ in such a way that the barycentric interpolant is rescaled by a factor depending on $h_j$, making interpolation on small elements inherently less accurate even in exact arithmetic; consequently $p$-refinement on small elements is unstable due to this rescaling.**\n\nThe barycentric interpolation formula is $I_{p_j}f(x) = \\left. \\sum_{k=0}^{p_j} \\frac{w_{j,k}}{x-x_{j,k}} f(x_{j,k}) \\middle/ \\sum_{k=0}^{p_j} \\frac{w_{j,k}}{x-x_{j,k}} \\right.$.\nThe barycentric weights are $w_{j,k} = 1/\\prod_{i \\neq k}(x_{j,k} - x_{j,i})$.\nLet the reference weights be $\\hat{w}_k = 1/\\prod_{i \\neq k}(\\hat{x}_k - \\hat{x}_i)$. Since $x_{j,k} - x_{j,i} = \\beta_j(\\hat{x}_k - \\hat{x}_i)$, the physical weights are $w_{j,k} = 1/(\\beta_j^{p_j} \\prod_{i \\neq k}(\\hat{x}_k - \\hat{x}_i)) = \\hat{w}_k / \\beta_j^{p_j}$. The weights do scale with $\\beta_j$.\nHowever, let's examine the full formula. The term $\\frac{w_{j,k}}{x-x_{j,k}}$ becomes $\\frac{\\hat{w}_k/\\beta_j^{p_j}}{\\beta_j(\\hat{x}-\\hat{x}_k)} = \\frac{1}{\\beta_j^{p_j+1}}\\frac{\\hat{w}_k}{\\hat{x}-\\hat{x}_k}$.\nThe factor $1/\\beta_j^{p_j+1}$ appears in every term in both the numerator and denominator of the barycentric formula, so it cancels out. The interpolant value is therefore invariant under the affine mapping. The statement that the interpolant is \"rescaled\" is false.\nFurthermore, the claim that this makes interpolation \"inherently less accurate\" on small elements is false. In fact, for a sufficiently smooth function, the interpolation error is proportional to $h_j^{p_j+1}$, meaning smaller elements lead to *more* accurate results. The issue with the scaling of weights is one of numerical stability in finite-precision arithmetic (risk of overflow/underflow), not one of accuracy in exact arithmetic. This numerical problem can be completely resolved by rescaling all weights by a common factor (e.g., $\\beta_j^{p_j}$), which does not alter the interpolant.\nThe statement is **Incorrect**.\n\n**C. If the element mapping is nonaffine, $x = \\psi_j(\\hat{x})$, with a strongly varying Jacobian $J_j(\\hat{x}) = \\mathrm{d}\\psi_j/\\mathrm{d}\\hat{x}$ that clusters mapped nodes in physical coordinates, the local Lebesgue constant on $E_j$ can be larger than that of the same reference nodes on $[-1,1]$, which may degrade interpolation stability at high $p_j$.**\n\nFor a non-affine mapping $\\psi_j$, the invariance property derived in (A) no longer holds. The basis function on the physical element, evaluated at a mapped point $x = \\psi_j(\\hat{x})$, is $\\ell_{j,k}(\\psi_j(\\hat{x})) = \\prod_{i \\neq k} \\frac{\\psi_j(\\hat{x}) - \\psi_j(\\hat{x}_i)}{\\psi_j(\\hat{x}_k) - \\psi_j(\\hat{x}_i)}$, which is not equal to $\\hat{\\ell}_k(\\hat{x})$. The distribution of the physical nodes $x_{j,k} = \\psi_j(\\hat{x}_k)$ is distorted compared to the reference nodes $\\hat{x}_k$.\nThe Lebesgue constant is highly sensitive to the node distribution. For instance, on $[-1,1]$, Chebyshev nodes yield a slowly growing Lebesgue constant ($\\mathcal{O}(\\log p)$), while equidistant nodes lead to exponential growth ($\\mathcal{O}(2^p/p)$).\nA non-affine mapping with a strongly varying Jacobian can transform a \"good\" set of nodes (like Chebyshev nodes) into a \"bad\" set of nodes in physical space (e.g., by clustering them in one region and spreading them far apart in another). Such a distortion can significantly increase the Lebesgue constant $\\lVert \\Lambda_j \\rVert_{\\infty,E_j}$ above the value on the reference element. A large Lebesgue constant amplifies interpolation error, as shown by the bound $\\lVert f - I_p f \\rVert_\\infty \\le (1+\\lVert \\Lambda \\rVert_\\infty) \\inf_{q \\in \\mathcal{P}_p} \\lVert f - q \\rVert_\\infty$, thereby degrading numerical stability. This is a well-known challenge for spectral and DG methods on elements with curved boundaries.\nThe statement is **Correct**.\n\n**D. In DG time integration for linear hyperbolic problems, the explicit Courant–Friedrichs–Lewy (CFL) time-step restriction on each element is directly proportional to the inverse of the local Lebesgue constant; hence reducing $h_j$ lowers $\\lVert \\Lambda_j \\rVert_{\\infty,E_j}$ and increases the allowable time step.**\n\nThis statement contains multiple errors.\nFirst, for a DG method applied to a linear hyperbolic equation (e.g., $u_t + a u_x = 0$), the explicit CFL time-step restriction on an element $E_j$ is of the form $\\Delta t \\le C \\frac{h_j}{p_j^2}$ (the dependency on $p$ can vary slightly, but $p_j^2$ is a common conservative estimate, related to polynomial inverse inequalities). The time step $\\Delta t$ is directly proportional to the element size $h_j$. Therefore, reducing $h_j$ *decreases*, not increases, the allowable time step.\nSecond, the CFL restriction's dependence is on $h_j$ and $p_j$, not directly on the Lebesgue constant $\\lVert \\Lambda_j \\rVert_{\\infty,E_j}$. While both the spectral radius of the DG operator and the Lebesgue constant depend on $p_j$, they are distinct quantities with different scaling laws. For example, for Chebyshev nodes, $\\lVert \\Lambda_j \\rVert_{\\infty,E_j} \\sim \\mathcal{O}(\\log p_j)$, while the CFL restriction scales with $p_j^{-2}$.\nThird, as established in (A), for affine mappings, the local Lebesgue constant $\\lVert \\Lambda_j \\rVert_{\\infty,E_j}$ is independent of $h_j$. The claim that \"reducing $h_j$ lowers $\\lVert \\Lambda_j \\rVert_{\\infty,E_j}$\" is false.\nThe statement is incorrect on every point it makes.\nThe statement is **Incorrect**.\n\n**E. An $hp$-adaptive strategy that selects node sets with provably bounded Lebesgue constants (for example, Gauss–Lobatto–Chebyshev nodes) and evaluates interpolation in reference coordinates (or rescales barycentric weights by a common factor per element) avoids numerical instability due to nonuniform $h_j$; the exact interpolant is invariant under affine scaling, and finite-precision weight scaling can be mitigated without changing the interpolant.**\n\nThis statement correctly summarizes a robust strategy for implementing $hp$-adaptive methods.\n1.  **Node Selection:** Using nodes like Chebyshev-Gauss-Lobatto ensures that the reference Lebesgue constant $\\lVert \\hat{\\Lambda}_{p_j} \\rVert_{\\infty}$ grows slowly (logarithmically) with $p_j$, which is crucial for stability in $p$-refinement.\n2.  **Handling $h_j$ variation:** For affine mappings, the stability is independent of $h_j$ in exact arithmetic because the Lebesgue constant is invariant. The numerical issues arise in finite precision from the scaling of barycentric weights, as discussed in (B). Evaluating the interpolant on the reference element and then mapping the result, or equivalently, rescaling the barycentric weights on the physical element by a common factor (like $\\beta_j^{p_j}$), are standard and effective techniques to circumvent these finite-precision problems.\n3.  **Invariance Properties:** The statement correctly notes that the theoretical underpinnings of this strategy are the invariance of the exact interpolant under affine scaling and the fact that the barycentric formula is invariant to a common scaling of the weights.\nEvery component of this statement is accurate and reflects best practices in computational science for spectral and DG methods.\nThe statement is **Correct**.", "answer": "$$\\boxed{ACE}$$", "id": "3409330"}]}