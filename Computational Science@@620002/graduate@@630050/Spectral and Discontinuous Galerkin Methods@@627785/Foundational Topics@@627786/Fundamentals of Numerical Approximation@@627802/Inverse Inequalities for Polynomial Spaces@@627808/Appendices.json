{"hands_on_practices": [{"introduction": "Inverse inequalities are fundamental tools for analyzing the stability and convergence of numerical methods. A key skill is understanding how these inequalities transform from a canonical reference element to a physical mesh element. This exercise will guide you through the process of deriving the scaling of an inverse inequality with respect to the mesh size $h$ and polynomial degree $p$, and then apply this result to a practical scenario involving the stability of a post-processing operator, demonstrating how these theoretical bounds directly inform numerical algorithm design [@problem_id:3392877].", "problem": "Consider a single one-dimensional mesh element $K$ of length $h$ supporting a polynomial finite-dimensional space $\\mathbb{P}_{p}(K)$ of degree at most $p$, as used in Spectral methods and Discontinuous Galerkin (DG) methods. Let $v_{h} \\in \\mathbb{P}_{p}(K)$ be a polynomial field on $K$. A local post-processing operator based on the $k$-th derivative, denoted $\\mathcal{P}_{k}$, is employed to enhance the maximum-norm (i.e., $L^{\\infty}$-norm) accuracy of $v_{h}$ by canceling leading-order error terms through a polynomial reconstruction that uses derivatives up to order $k$. The $L^{\\infty}$ improvement of such a reconstruction is monotone in $k$, with larger $k$ yielding a stronger reduction in the $L^{\\infty}$-error.\n\nStarting from the affine mapping from the reference element $[-1,1]$ to $K$, the scaling of derivatives under this mapping, and norm equivalence properties of $\\mathbb{P}_{p}([-1,1])$, derive an inverse inequality of the form that bounds $\\|D^{k} v_{h}\\|_{L^{2}(K)}$ by a constant times a power of $p$ and $h$ multiplied by $\\|v_{h}\\|_{L^{2}(K)}$. Use this inverse inequality to justify that the stability amplification of the post-processor can be bounded above by an expression of the form $\\alpha \\, C_{\\mathrm{inv}} \\, p^{2k} \\, h^{-k}$, for a constant $C_{\\mathrm{inv}}$ that depends only on the choice of reference norms and the polynomial basis but not on $h$ or $p$. Assume that the $L^{\\infty}$ improvement grows monotonically with $k$ (so a larger $k$ is preferable), but must be chosen to keep the amplification bounded by unity, and that $k$ must satisfy $0 \\le k \\le p$.\n\nGiven the numerical values $p=8$, $h=20$, $\\alpha=0.25$, and $C_{\\mathrm{inv}}=0.125$, choose the largest integer $k$ that optimizes the $L^{\\infty}$ improvement without violating the stability constraint $\\alpha \\, C_{\\mathrm{inv}} \\, p^{2k} \\, h^{-k} \\le 1$, subject to $k \\le p$. Report the chosen integer $k$ as your final answer.", "solution": "The problem requires us to first derive an inverse inequality relating the $L^2$-norm of the $k$-th derivative of a polynomial to the $L^2$-norm of the polynomial itself. Subsequently, we must justify the form of a given stability amplification bound and then determine the optimal integer order $k$ for a post-processing operator subject to a stability constraint.\n\nFirst, we derive the inverse inequality. Let $\\hat{K} = [-1, 1]$ be the reference element and $K$ be a physical element of length $h$. The affine mapping $F: \\hat{K} \\to K$ can be written as $x = F(\\hat{x}) = x_c + \\frac{h}{2}\\hat{x}$, where $x_c$ is the center of the element $K$. The Jacobian of this mapping is $J = \\frac{dx}{d\\hat{x}} = \\frac{h}{2}$.\n\nLet $v_h \\in \\mathbb{P}_p(K)$ be a polynomial of degree at most $p$ on the physical element $K$. We can define a corresponding polynomial $\\hat{v} \\in \\mathbb{P}_p(\\hat{K})$ on the reference element via the composition $\\hat{v}(\\hat{x}) = v_h(x(\\hat{x}))$. Using the chain rule for differentiation, we relate the derivatives on $K$ and $\\hat{K}$:\n$$ \\frac{dv_h}{dx} = \\frac{d\\hat{v}}{d\\hat{x}} \\frac{d\\hat{x}}{dx} = \\frac{d\\hat{v}}{d\\hat{x}} \\left(\\frac{dx}{d\\hat{x}}\\right)^{-1} = \\frac{2}{h} \\frac{d\\hat{v}}{d\\hat{x}} $$\nBy repeated application of this rule, the $k$-th derivative on the physical element is related to the $k$-th derivative on the reference element by:\n$$ D^k v_h \\equiv \\frac{d^k v_h}{dx^k} = \\left(\\frac{2}{h}\\right)^k \\frac{d^k \\hat{v}}{d\\hat{x}^k} \\equiv \\left(\\frac{2}{h}\\right)^k D^k \\hat{v} $$\nNext, we relate the $L^2$-norms on the two elements. The $L^2$-norm of a function $w$ on an element $I$ is defined as $\\|w\\|_{L^2(I)} = \\left(\\int_I |w|^2 dx\\right)^{1/2}$. For the function $v_h$, we perform a change of variables $x \\to \\hat{x}$, for which the differential element transforms as $dx = J d\\hat{x} = \\frac{h}{2} d\\hat{x}$:\n$$ \\|v_h\\|_{L^2(K)}^2 = \\int_K |v_h(x)|^2 dx = \\int_{-1}^1 |\\hat{v}(\\hat{x})|^2 \\frac{h}{2} d\\hat{x} = \\frac{h}{2} \\|\\hat{v}\\|_{L^2(\\hat{K})}^2 $$\nThis gives the relation $\\|\\hat{v}\\|_{L^2(\\hat{K})}^2 = \\frac{2}{h} \\|v_h\\|_{L^2(K)}^2$.\n\nWe apply the same transformation to the norm of the $k$-th derivative:\n$$ \\|D^k v_h\\|_{L^2(K)}^2 = \\int_K |D^k v_h(x)|^2 dx = \\int_{-1}^1 \\left|\\left(\\frac{2}{h}\\right)^k D^k \\hat{v}(\\hat{x})\\right|^2 \\frac{h}{2} d\\hat{x} = \\left(\\frac{2}{h}\\right)^{2k} \\frac{h}{2} \\|D^k \\hat{v}\\|_{L^2(\\hat{K})}^2 $$\nA standard inverse inequality for polynomials $\\hat{v} \\in \\mathbb{P}_p(\\hat{K})$ on the reference element states that there exists a constant $\\hat{C}_k$, independent of $p$, such that:\n$$ \\|D^k \\hat{v}\\|_{L^2(\\hat{K})} \\le \\hat{C}_k p^{2k} \\|\\hat{v}\\|_{L^2(\\hat{K})} $$\nThe scaling $p^{2k}$ is a known sharp estimate for large polynomial degrees. Substituting this inequality into our expression for $\\|D^k v_h\\|_{L^2(K)}^2$:\n$$ \\|D^k v_h\\|_{L^2(K)}^2 \\le \\left(\\frac{2}{h}\\right)^{2k} \\frac{h}{2} \\left( \\hat{C}_k p^{2k} \\|\\hat{v}\\|_{L^2(\\hat{K})} \\right)^2 = \\left(\\frac{2}{h}\\right)^{2k} \\frac{h}{2} \\hat{C}_k^2 p^{4k} \\|\\hat{v}\\|_{L^2(\\hat{K})}^2 $$\nNow we substitute $\\|\\hat{v}\\|_{L^2(\\hat{K})}^2 = \\frac{2}{h} \\|v_h\\|_{L^2(K)}^2$ into the right-hand side:\n$$ \\|D^k v_h\\|_{L^2(K)}^2 \\le \\left(\\frac{2}{h}\\right)^{2k} \\frac{h}{2} \\hat{C}_k^2 p^{4k} \\left(\\frac{2}{h} \\|v_h\\|_{L^2(K)}^2\\right) = \\hat{C}_k^2 \\frac{2^{2k}}{h^{2k}} p^{4k} \\|v_h\\|_{L^2(K)}^2 $$\nTaking the square root of both sides, we obtain the final form of the inverse inequality:\n$$ \\|D^k v_h\\|_{L^2(K)} \\le \\left(\\hat{C}_k 2^k\\right) p^{2k} h^{-k} \\|v_h\\|_{L^2(K)} $$\nThis expression bounds the norm of the $k$-th derivative by a constant times powers of $p$ and $h$ and the norm of the function itself, as requested.\n\nThe problem states that the stability amplification of the post-processor $\\mathcal{P}_k$ is bounded by an expression of the form $\\alpha \\, C_{\\mathrm{inv}} \\, p^{2k} \\, h^{-k}$. The post-processor $\\mathcal{P}_k$ uses derivatives up to order $k$. The stability of such an operator is fundamentally linked to the amplification of the input function's norm. Since the operator involves derivatives, its stability properties must depend on the norms of these derivatives. The derived inverse inequality shows that the relative size of the $k$-th derivative, i.e., the ratio $\\|D^k v_h\\|_{L^2(K)}/\\|v_h\\|_{L^2(K)}$, is bounded by a term proportional to $p^{2k}h^{-k}$. It is therefore entirely consistent that a measure of stability amplification for an operator involving $D^k$ would be governed by this bound. The constants $\\alpha$ and $C_{\\mathrm{inv}}$ encapsulate the particulars of the operator's construction and the constants from the underlying inequalities.\n\nFinally, we must find the largest integer $k$ that optimizes the $L^{\\infty}$-error improvement, which is given to be monotonic in $k$. This requires finding the largest integer $k$ that satisfies the stability constraint $\\alpha \\, C_{\\mathrm{inv}} \\, p^{2k} \\, h^{-k} \\le 1$ and the problem-space constraint $0 \\le k \\le p$.\nWe are given the numerical values $p=8$, $h=20$, $\\alpha=0.25$, and $C_{\\mathrm{inv}}=0.125$.\nSubstituting these values into the stability inequality yields:\n$$ (0.25) \\cdot (0.125) \\cdot (8)^{2k} \\cdot (20)^{-k} \\le 1 $$\nWe can rewrite the constants as fractions: $\\alpha = \\frac{1}{4}$ and $C_{\\mathrm{inv}} = \\frac{1}{8}$.\n$$ \\frac{1}{4} \\cdot \\frac{1}{8} \\cdot (8^2)^k \\cdot \\frac{1}{20^k} \\le 1 $$\n$$ \\frac{1}{32} \\cdot \\left(\\frac{64}{20}\\right)^k \\le 1 $$\nSimplifying the base of the power:\n$$ \\left(\\frac{64}{20}\\right)^k = \\left(\\frac{16}{5}\\right)^k = (3.2)^k $$\nSo the inequality becomes:\n$$ (3.2)^k \\le 32 $$\nWe must find the largest integer $k$ satisfying this inequality, subject to $k \\le p=8$. We can test integer values for $k$:\nFor $k=0$: $(3.2)^0 = 1 \\le 32$. The condition is satisfied.\nFor $k=1$: $(3.2)^1 = 3.2 \\le 32$. The condition is satisfied.\nFor $k=2$: $(3.2)^2 = 10.24 \\le 32$. The condition is satisfied.\nFor $k=3$: $(3.2)^3 = 10.24 \\times 3.2 = 32.768$. Since $32.768 > 32$, the condition is violated.\nAs $(3.2)^k$ is a strictly increasing function for $k>0$, any integer $k \\ge 3$ will also violate the inequality.\nThe largest integer value of $k$ that satisfies the stability constraint is $2$. This also satisfies $k \\le 8$. Since a larger $k$ gives better $L^\\infty$ improvement, we select the largest permissible integer value.\nThus, the optimal choice for $k$ is $2$.", "answer": "$$\\boxed{2}$$", "id": "3392877"}, {"introduction": "The precision of spectral and DG methods relies on the deep connection between continuous operators, orthogonal polynomials, and numerical quadrature. Inverse inequalities can often be made exact for specific polynomials, revealing sharp constants that govern the method's behavior. In this practice, you will determine the exact constant in an identity relating a weighted derivative norm to a discrete norm for a Legendre polynomial, reinforcing the properties of these cornerstone functions and the structure of Gauss-Lobatto-Legendre quadrature [@problem_id:3392878].", "problem": "Consider the reference element $[-1,1]$ and the polynomial space of degree at most $N$, denoted $\\mathbb{P}_{N}$. Let $P_{N}(x)$ be the Legendre polynomial of degree $N$, normalized so that $\\displaystyle \\int_{-1}^{1} P_{N}(x)^{2}\\,\\mathrm{d}x = \\frac{2}{2N+1}$. Define the Gauss–Lobatto–Legendre quadrature with $N+1$ points $\\{x_{i}\\}_{i=1}^{N+1}$, consisting of the endpoints $x_{1}=-1$ and $x_{N+1}=1$, and $N-1$ interior points which are the distinct roots of $P_{N}'(x)$. The corresponding quadrature weights $\\{w_{i}\\}_{i=1}^{N+1}$ are given by the well-known formulas\n$$\nw_{1}=w_{N+1}=\\frac{2}{N(N+1)},\\qquad w_{i}=\\frac{2}{N(N+1)\\left[P_{N}(x_{i})\\right]^{2}},\\quad i=2,\\dots,N.\n$$\nThese weights are those used in spectral element and discontinuous Galerkin methods to define a discrete $L^{2}$ norm by quadrature. Consider the weighted $H^{1}$-seminorm induced by the Legendre operator on $[-1,1]$, defined for a differentiable function $p$ by $\\displaystyle \\int_{-1}^{1} \\left(1-x^{2}\\right) \\left[p'(x)\\right]^{2}\\,\\mathrm{d}x$. In the context of inverse inequalities for polynomial spaces, one is often interested in bounding this seminorm in terms of a discrete $L^{2}$ norm $\\displaystyle \\sum_{i=1}^{N+1} w_{i}\\, [p(x_{i})]^{2}$.\n\nYour task is to determine the exact constant $C_{N}$ such that the following identity holds for the specific choice $p(x)=P_{N}(x)$:\n$$\n\\int_{-1}^{1} \\left(1-x^{2}\\right) \\left[P_{N}'(x)\\right]^{2}\\,\\mathrm{d}x \\;=\\; C_{N} \\sum_{i=1}^{N+1} w_{i}\\, \\left[P_{N}(x_{i})\\right]^{2}.\n$$\nYour answer must be a single closed-form analytic expression for $C_{N}$ in terms of $N$. No inequalities or equations are permitted as the final answer. No rounding is required.", "solution": "The problem is to determine the constant $C_{N}$ from the following identity, which is specified to hold for the polynomial choice $p(x) = P_{N}(x)$:\n$$\n\\int_{-1}^{1} \\left(1-x^{2}\\right) \\left[P_{N}'(x)\\right]^{2}\\,\\mathrm{d}x \\;=\\; C_{N} \\sum_{i=1}^{N+1} w_{i}\\, \\left[P_{N}(x_{i})\\right]^{2}\n$$\nTo find $C_{N}$, we shall evaluate the left-hand side (LHS) and the right-hand side (RHS) of this equation separately.\n\nLet us first analyze the RHS, which is the discrete summation term:\n$$\n\\text{RHS} = \\sum_{i=1}^{N+1} w_{i}\\, \\left[P_{N}(x_{i})\\right]^{2}\n$$\nThe summation can be split into the contributions from the endpoints ($i=1$ and $i=N+1$) and the interior points ($i=2, \\dots, N$).\n\nThe endpoints of the Gauss–Lobatto–Legendre (GLL) mesh are $x_{1}=-1$ and $x_{N+1}=1$. The corresponding quadrature weights are given as $w_{1} = w_{N+1} = \\frac{2}{N(N+1)}$.\nThe Legendre polynomial $P_{N}(x)$, with the standard normalization $\\int_{-1}^{1} [P_{N}(x)]^2\\,\\mathrm{d}x = \\frac{2}{2N+1}$, satisfies $P_{N}(1)=1$ and $P_{N}(-1)=(-1)^{N}$.\nThe contribution from the endpoints to the sum is therefore:\n$$\nw_{1} [P_{N}(x_{1})]^{2} + w_{N+1} [P_{N}(x_{N+1})]^{2} = \\frac{2}{N(N+1)} [P_{N}(-1)]^{2} + \\frac{2}{N(N+1)} [P_{N}(1)]^{2}\n$$\n$$\n= \\frac{2}{N(N+1)} [(-1)^{N}]^{2} + \\frac{2}{N(N+1)} [1]^{2} = \\frac{2}{N(N+1)} (1+1) = \\frac{4}{N(N+1)}\n$$\n\nThe interior GLL points, $\\{x_{i}\\}_{i=2}^{N}$, are the $N-1$ distinct roots of the derivative of the Legendre polynomial, $P_{N}'(x)$. The corresponding quadrature weights are given by the formula $w_{i} = \\frac{2}{N(N+1)[P_{N}(x_{i})]^{2}}$ for $i=2, \\dots, N$.\nThe contribution from the interior points to the sum is:\n$$\n\\sum_{i=2}^{N} w_{i} [P_{N}(x_{i})]^{2} = \\sum_{i=2}^{N} \\left(\\frac{2}{N(N+1)[P_{N}(x_{i})]^{2}}\\right) [P_{N}(x_{i})]^{2} = \\sum_{i=2}^{N} \\frac{2}{N(N+1)}\n$$\nSince there are $N-1$ interior points (from $i=2$ to $i=N$), this sum evaluates to:\n$$\n(N-1) \\times \\frac{2}{N(N+1)} = \\frac{2(N-1)}{N(N+1)}\n$$\n\nCombining the contributions from the endpoints and the interior points, the total value of the RHS is:\n$$\n\\text{RHS} = \\frac{4}{N(N+1)} + \\frac{2(N-1)}{N(N+1)} = \\frac{4 + 2N - 2}{N(N+1)} = \\frac{2N+2}{N(N+1)} = \\frac{2(N+1)}{N(N+1)} = \\frac{2}{N}\n$$\n\nNext, we evaluate the LHS, which is the integral term:\n$$\n\\text{LHS} = \\int_{-1}^{1} (1-x^{2}) [P_{N}'(x)]^{2}\\,\\mathrm{d}x\n$$\nThis integral can be solved using integration by parts. Let $u = (1-x^{2})P_{N}'(x)$ and $\\mathrm{d}v = P_{N}'(x)\\,\\mathrm{d}x$. Then $\\mathrm{d}u = \\frac{\\mathrm{d}}{\\mathrm{d}x}\\left[(1-x^{2})P_{N}'(x)\\right]\\,\\mathrm{d}x$ and $v = P_{N}(x)$.\n$$\n\\text{LHS} = \\left[ (1-x^{2})P_{N}'(x)P_{N}(x) \\right]_{-1}^{1} - \\int_{-1}^{1} P_{N}(x) \\frac{\\mathrm{d}}{\\mathrm{d}x}\\left[(1-x^{2})P_{N}'(x)\\right]\\,\\mathrm{d}x\n$$\nThe boundary term vanishes because the factor $(1-x^{2})$ is zero at $x=1$ and $x=-1$.\nSo, we are left with:\n$$\n\\text{LHS} = - \\int_{-1}^{1} P_{N}(x) \\frac{\\mathrm{d}}{\\mathrm{d}x}\\left[(1-x^{2})P_{N}'(x)\\right]\\,\\mathrm{d}x\n$$\nLegendre polynomials are solutions to the Legendre differential equation:\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}x}\\left[(1-x^{2})\\frac{\\mathrm{d}y}{\\mathrm{d}x}\\right] + n(n+1)y = 0\n$$\nFor $y=P_{N}(x)$, this becomes:\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}x}\\left[(1-x^{2})P_{N}'(x)\\right] = -N(N+1)P_{N}(x)\n$$\nSubstituting this into our expression for the LHS:\n$$\n\\text{LHS} = - \\int_{-1}^{1} P_{N}(x) \\left[-N(N+1)P_{N}(x)\\right]\\,\\mathrm{d}x = N(N+1) \\int_{-1}^{1} [P_{N}(x)]^{2}\\,\\mathrm{d}x\n$$\nUsing the given normalization condition for Legendre polynomials, $\\int_{-1}^{1} [P_{N}(x)]^{2}\\,\\mathrm{d}x = \\frac{2}{2N+1}$, we get:\n$$\n\\text{LHS} = N(N+1) \\left(\\frac{2}{2N+1}\\right) = \\frac{2N(N+1)}{2N+1}\n$$\n\nFinally, we equate the expressions for the LHS and RHS to solve for $C_{N}$:\n$$\n\\text{LHS} = C_{N} \\times \\text{RHS}\n$$\n$$\n\\frac{2N(N+1)}{2N+1} = C_{N} \\times \\frac{2}{N}\n$$\nSolving for $C_{N}$ yields:\n$$\nC_{N} = \\frac{2N(N+1)}{2N+1} \\times \\frac{N}{2} = \\frac{N^{2}(N+1)}{2N+1}\n$$\nThis is the exact constant for the given identity.", "answer": "$$\n\\boxed{\\frac{N^{2}(N+1)}{2N+1}}\n$$", "id": "3392878"}, {"introduction": "Inverse inequalities can be interpreted from a spectral perspective, where the constants reflect how energy is distributed across different polynomial modes. This viewpoint is especially powerful when designing filters to stabilize simulations by selectively damping high-frequency content. This problem challenges you to compute an optimal inverse constant on a \"high-pass\" subspace of polynomials, and then use this insight to design a simple spectral filter, linking the abstract theory directly to techniques used in advanced computational modeling like Large Eddy Simulation [@problem_id:3392892].", "problem": "Let $I=[-1,1]$ and let $\\mathbb{P}_p$ denote the space of all real polynomials on $I$ of degree at most $p$. Equip $\\mathbb{P}_p$ with the standard $L^2$ inner product $(u,v)=\\int_{-1}^{1} u(x)\\,v(x)\\,dx$. Let $\\{P_k\\}_{k\\ge 0}$ be the Legendre polynomials, characterized as the unique polynomial solutions of the second-order Sturm–Liouville problem $-\\frac{d}{dx}\\big((1-x^2)\\,P_k'(x)\\big)=k(k+1)\\,P_k(x)$ on $I$ with $P_k(1)=1$ for each nonnegative integer $k$, and known to be mutually orthogonal in $L^2(I)$.\n\nDefine the high-pass subspace $\\mathcal{H}_{p,m}=\\{v\\in\\mathbb{P}_p:\\,(v,q)=0\\text{ for all }q\\in\\mathbb{P}_m\\}$, where $m$ is a fixed integer with $0\\le m<p$. Consider the bilinear forms $a(v,w)=\\int_{-1}^{1}(1-x^2)\\,v'(x)\\,w'(x)\\,dx$ and $b(v,w)=\\int_{-1}^{1}v(x)\\,w(x)\\,dx$ on $\\mathbb{P}_p$. The optimal inverse constant on $\\mathcal{H}_{p,m}$ associated with the weighted gradient is defined by\n$$\nC_{p,m}=\\sup_{v\\in\\mathcal{H}_{p,m}\\setminus\\{0\\}}\\frac{\\big(a(v,v)\\big)^{1/2}}{\\big(b(v,v)\\big)^{1/2}}.\n$$\nStarting from fundamental properties of the Legendre polynomials and the above bilinear forms, determine a closed-form analytic expression for $C_{p,m}$ in terms of $p$ and $m$.\n\nNext, consider a Large Eddy Simulation (LES)-like polynomial filter defined spectrally by solving for $u\\in\\mathbb{P}_p$ the variational problem\n$$\nb(u,w)+\\kappa^{-2}\\,a(u,w)=b(v,w)\\quad\\text{for all }w\\in\\mathbb{P}_p,\n$$\nwhere $\\kappa>0$ is a tunable parameter and $v\\in\\mathbb{P}_p$ is the input polynomial. This filter acts diagonally on the Legendre basis due to the Sturm–Liouville structure of the operator $-\\frac{d}{dx}\\big((1-x^2)\\frac{d}{dx}\\big)$. Choose $\\kappa$ so that the filter’s amplitude gain on the lowest high-pass mode of degree $k=m+1$ equals $1/2$. Derive a closed-form analytic expression for this choice of $\\kappa$ in terms of $m$.\n\nYour final answer should consist of two expressions, written in a single row, in the order $C_{p,m}$ and $\\kappa$. No numerical approximation is required.", "solution": "The problem as stated is mathematically well-posed, scientifically grounded in the theory of numerical analysis and orthogonal polynomials, and contains all necessary information for a unique solution. We can therefore proceed with the derivation.\n\nThe problem is divided into two parts. First, we determine the optimal inverse constant $C_{p,m}$. Second, we derive an expression for the filter parameter $\\kappa$.\n\nPart 1: Determination of the inverse constant $C_{p,m}$.\n\nThe constant $C_{p,m}$ is defined as the supremum of a Rayleigh quotient:\n$$\nC_{p,m}^2 = \\sup_{v\\in\\mathcal{H}_{p,m}\\setminus\\{0\\}} \\frac{a(v,v)}{b(v,v)} = \\sup_{v\\in\\mathcal{H}_{p,m}\\setminus\\{0\\}} \\frac{\\int_{-1}^{1}(1-x^2)\\,(v'(x))^2\\,dx}{\\int_{-1}^{1}(v(x))^2\\,dx}\n$$\nThe space $\\mathcal{H}_{p,m}$ consists of polynomials in $\\mathbb{P}_p$ that are $L^2$-orthogonal to all polynomials in $\\mathbb{P}_m$. The Legendre polynomials $\\{P_k\\}_{k=0}^p$ form an orthogonal basis for $\\mathbb{P}_p$. The subspace $\\mathbb{P}_m$ is spanned by $\\{P_k\\}_{k=0}^m$. Therefore, the orthogonality condition $(v,q)=0$ for all $q\\in\\mathbb{P}_m$ implies that any $v \\in \\mathcal{H}_{p,m}$ can be expressed as a linear combination of Legendre polynomials of degrees higher than $m$:\n$$\nv(x) = \\sum_{k=m+1}^{p} c_k P_k(x)\n$$\nfor some real coefficients $c_k$.\n\nWe now express the numerator and denominator of the Rayleigh quotient in terms of these coefficients. The denominator is $b(v,v) = (v,v)$. Using the expansion of $v$ and the orthogonality of the Legendre polynomials, $(P_k, P_j) = \\delta_{kj} \\|P_k\\|_{L^2}^2$, we have:\n$$\nb(v,v) = \\left(\\sum_{k=m+1}^{p} c_k P_k, \\sum_{j=m+1}^{p} c_j P_j\\right) = \\sum_{k=m+1}^{p} \\sum_{j=m+1}^{p} c_k c_j (P_k, P_j) = \\sum_{k=m+1}^{p} c_k^2 \\|P_k\\|_{L^2}^2\n$$\nThe squared $L^2$-norm of the $k$-th Legendre polynomial is a standard result: $\\|P_k\\|_{L^2}^2 = \\int_{-1}^{1} P_k(x)^2 dx = \\frac{2}{2k+1}$. Thus,\n$$\nb(v,v) = \\sum_{k=m+1}^{p} c_k^2 \\frac{2}{2k+1}\n$$\nFor the numerator, $a(v,v) = \\int_{-1}^{1}(1-x^2)\\,(v'(x))^2\\,dx$, we analyze the bilinear form $a(P_k, P_j)$. Using integration by parts:\n$$\na(P_k, P_j) = \\int_{-1}^{1} (1-x^2) P_k'(x) P_j'(x) dx = \\left[(1-x^2)P_k'(x) P_j(x)\\right]_{-1}^{1} - \\int_{-1}^{1} P_j(x) \\frac{d}{dx}\\left((1-x^2)P_k'(x)\\right) dx\n$$\nThe boundary term vanishes since $(1-x^2)=0$ at $x=\\pm 1$. We are left with the integral term. By substituting the Sturm-Liouville equation for $P_k$, $-\\frac{d}{dx}\\big((1-x^2)P_k'(x)\\big)=k(k+1)P_k(x)$, we get:\n$$\na(P_k, P_j) = \\int_{-1}^{1} P_j(x) \\left(-\\frac{d}{dx}\\big((1-x^2)P_k'(x)\\big)\\right) dx = \\int_{-1}^{1} P_j(x) [k(k+1)P_k(x)] dx = k(k+1) (P_k, P_j)\n$$\nThis shows that the Legendre polynomials are also orthogonal with respect to the inner product $a(\\cdot,\\cdot)$. Now we can compute $a(v,v)$:\n$$\na(v,v) = a\\left(\\sum_{k=m+1}^{p} c_k P_k, \\sum_{j=m+1}^{p} c_j P_j\\right) = \\sum_{k,j=m+1}^{p} c_k c_j a(P_k, P_j) = \\sum_{k=m+1}^{p} c_k^2 a(P_k, P_k)\n$$\nUsing the relation $a(P_k,P_k) = k(k+1)(P_k,P_k) = k(k+1)\\|P_k\\|_{L^2}^2$:\n$$\na(v,v) = \\sum_{k=m+1}^{p} c_k^2 k(k+1) \\|P_k\\|_{L^2}^2 = \\sum_{k=m+1}^{p} c_k^2 k(k+1) \\frac{2}{2k+1}\n$$\nThe Rayleigh quotient for $C_{p,m}^2$ becomes:\n$$\n\\frac{a(v,v)}{b(v,v)} = \\frac{\\sum_{k=m+1}^{p} c_k^2 k(k+1) \\frac{2}{2k+1}}{\\sum_{k=m+1}^{p} c_k^2 \\frac{2}{2k+1}}\n$$\nThis is a weighted average of the values $\\lambda_k = k(k+1)$ for $k \\in \\{m+1, \\dots, p\\}$, with non-negative weights $w_k = c_k^2 \\frac{2}{2k+1}$. The supremum of such a weighted average is the maximum of the values being averaged. The function $f(k) = k(k+1)$ is strictly increasing for $k \\ge 0$. Therefore, the maximum value of $\\lambda_k$ for $k$ in the range from $m+1$ to $p$ occurs at $k=p$.\n$$\nC_{p,m}^2 = \\sup_{v\\in\\mathcal{H}_{p,m}\\setminus\\{0\\}} \\frac{a(v,v)}{b(v,v)} = \\max_{k \\in \\{m+1, \\dots, p\\}} k(k+1) = p(p+1)\n$$\nTaking the square root gives the final expression for the inverse constant:\n$$\nC_{p,m} = \\sqrt{p(p+1)}\n$$\n\nPart 2: Determination of the filter parameter $\\kappa$.\n\nThe filter is defined by the variational problem: for a given $v \\in \\mathbb{P}_p$, find $u \\in \\mathbb{P}_p$ such that\n$$\nb(u,w) + \\kappa^{-2}a(u,w) = b(v,w) \\quad \\text{for all } w \\in \\mathbb{P}_p\n$$\nThe problem states that this filter acts diagonally on the Legendre basis. Let's verify this and find the gain. Let the input be a single mode $v = P_k$ for some $k \\in \\{0, \\dots, p\\}$. We seek a solution of the form $u = g_k P_k$, where $g_k$ is the amplitude gain for that mode.\nSubstituting $v=P_k$ and $u=g_k P_k$ into the variational form:\n$$\nb(g_k P_k, w) + \\kappa^{-2}a(g_k P_k, w) = b(P_k, w)\n$$\n$$\ng_k b(P_k, w) + g_k \\kappa^{-2}a(P_k, w) = b(P_k, w)\n$$\nThis must hold for all test functions $w \\in \\mathbb{P}_p$. It is sufficient to test against the basis functions $w=P_j$ for $j \\in \\{0, \\dots, p\\}$.\n$$\ng_k (P_k, P_j) + g_k \\kappa^{-2} a(P_k, P_j) = (P_k, P_j)\n$$\nUsing the identities $(P_k, P_j) = \\delta_{kj} \\|P_k\\|_{L^2}^2$ and $a(P_k, P_j) = k(k+1) \\delta_{kj} \\|P_k\\|_{L^2}^2$:\n$$\ng_k \\delta_{kj} \\|P_k\\|_{L^2}^2 + g_k \\kappa^{-2} k(k+1) \\delta_{kj} \\|P_k\\|_{L^2}^2 = \\delta_{kj} \\|P_k\\|_{L^2}^2\n$$\nIf $j \\neq k$, the equation is trivially satisfied as $0=0$. For $j=k$, we have:\n$$\ng_k \\|P_k\\|_{L^2}^2 + g_k \\kappa^{-2} k(k+1) \\|P_k\\|_{L^2}^2 = \\|P_k\\|_{L^2}^2\n$$\nSince $\\|P_k\\|_{L^2}^2 \\neq 0$, we can divide by it:\n$$\ng_k (1 + \\kappa^{-2} k(k+1)) = 1\n$$\nThe amplitude gain for the $k$-th mode is:\n$$\ng_k = \\frac{1}{1 + \\kappa^{-2} k(k+1)}\n$$\nThe problem requires setting $\\kappa$ such that the gain on the lowest high-pass mode, which is $P_{m+1}$ (of degree $k=m+1$), is equal to $1/2$.\nSo we set $g_{m+1} = \\frac{1}{2}$:\n$$\n\\frac{1}{1 + \\kappa^{-2} (m+1)((m+1)+1)} = \\frac{1}{2}\n$$\n$$\n1 + \\kappa^{-2} (m+1)(m+2) = 2\n$$\n$$\n\\kappa^{-2} (m+1)(m+2) = 1\n$$\n$$\n\\kappa^2 = (m+1)(m+2)\n$$\nSince $\\kappa>0$, we take the positive square root:\n$$\n\\kappa = \\sqrt{(m+1)(m+2)}\n$$\n\nThe two derived expressions are $C_{p,m} = \\sqrt{p(p+1)}$ and $\\kappa = \\sqrt{(m+1)(m+2)}$.", "answer": "$$\n\\boxed{\\begin{pmatrix} \\sqrt{p(p+1)} & \\sqrt{(m+1)(m+2)} \\end{pmatrix}}\n$$", "id": "3392892"}]}