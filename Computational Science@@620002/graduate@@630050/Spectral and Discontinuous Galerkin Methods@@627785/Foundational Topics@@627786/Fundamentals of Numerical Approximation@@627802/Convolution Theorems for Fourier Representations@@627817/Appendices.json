{"hands_on_practices": [{"introduction": "The convolution theorem is not just a mathematical identity; it is a powerful tool for simplifying complex calculations. A common application is finding the Fourier transform of a function that can be constructed by convolving simpler functions whose transforms are already known. This first practice illustrates this principle by deriving the Fourier transform of a triangular pulse, recognizing it as the self-convolution of a simple rectangular pulse [@problem_id:27693].", "problem": "A triangular pulse function, $f_a(t)$, can be generated by the self-convolution of a simpler function. Consider a rectangular pulse function, $p_a(t)$, defined as:\n$$\np_a(t) = \n\\begin{cases} \n1 & \\text{if } |t| \\le \\frac{a}{2} \\\\\n0 & \\text{if } |t| > \\frac{a}{2} \n\\end{cases}\n$$\nwhere $a$ is a positive constant representing the width of the pulse.\n\nThe triangular pulse, $f_a(t)$, is given by the convolution of this rectangular pulse with itself:\n$$\nf_a(t) = (p_a * p_a)(t) = \\int_{-\\infty}^{\\infty} p_a(\\tau) p_a(t - \\tau) d\\tau\n$$\nThis resulting triangular pulse is centered at $t=0$, has a base of width $2a$, and a peak height of $a$.\n\nYour task is to derive the Fourier transform, $\\hat{f_a}(k)$, of this triangular pulse. You must use the Convolution Theorem.\n\n**Definitions and Theorems:**\n\n1.  **The Fourier Transform:** The Fourier transform of a function $g(t)$ is denoted by $\\hat{g}(k)$ or $\\mathcal{F}\\{g(t)\\}$ and is defined as:\n    $$\n    \\hat{g}(k) = \\int_{-\\infty}^{\\infty} g(t) e^{-ikt} dt\n    $$\n2.  **The Convolution Theorem:** The Fourier transform of a convolution of two functions, $g(t)$ and $h(t)$, is the product of their individual Fourier transforms:\n    $$\n    \\mathcal{F}\\{ (g * h)(t) \\} = \\hat{g}(k) \\hat{h}(k)\n    $$\n\nUsing these definitions, derive the expression for $\\hat{f_a}(k)$.", "solution": "By the Convolution Theorem, \n$$\\mathcal{F}\\{f_a(t)\\}=\\mathcal{F}\\{p_a * p_a\\}\n=\\bigl(\\mathcal{F}\\{p_a(t)\\}\\bigr)^2.$$\nFirst compute \n$$\\hat p_a(k)=\\int_{-\\infty}^{\\infty}p_a(t)\\,e^{-ikt}dt\n=\\int_{-a/2}^{a/2}e^{-ikt}dt\n=\\left[\\frac{e^{-ikt}}{-ik}\\right]_{-a/2}^{a/2}\n=\\frac{e^{-ik(a/2)}-e^{ik(a/2)}}{-ik}\n=\\frac{2\\sin\\!\\bigl(\\tfrac{ka}{2}\\bigr)}{k}.$$\nHence\n$$\\hat f_a(k)=\\bigl(\\hat p_a(k)\\bigr)^2\n=\\left(\\frac{2\\sin\\!\\bigl(\\tfrac{ka}{2}\\bigr)}{k}\\right)^2\n=\\frac{4\\sin^2\\!\\bigl(\\tfrac{ka}{2}\\bigr)}{k^2}\\,. $$", "answer": "$$\\boxed{\\frac{4\\sin^2\\!\\bigl(\\frac{ka}{2}\\bigr)}{k^2}}$$", "id": "27693"}, {"introduction": "Beyond simplifying transform calculations, the convolution theorem offers an elegant strategy for evaluating otherwise intractable integrals. This exercise demonstrates how to solve a challenging definite integral by identifying its structure as a convolution of two sinc functions [@problem_id:539758]. By moving to the Fourier domain, the difficult convolution becomes a simple multiplication of two rectangular functions, making the solution straightforward and showcasing the theorem's problem-solving utility.", "problem": "Evaluate the integral $ I = \\int_{-\\infty}^{\\infty} \\frac{\\sin(k(t-\\tau))}{\\pi(t-\\tau)} \\frac{\\sin(m\\tau)}{\\pi\\tau}  d\\tau $ at $ t = 0 $ for positive constants $ k > 0 $ and $ m > 0 $. The result should be expressed in terms of $ k $ and $ m $.  \n\n**Background:**  \nThe convolution theorem states that the Fourier transform of the convolution of two functions is the product of their Fourier transforms. The convolution of functions $ f $ and $ g $ is defined as:  \n\n$$ (f * g)(t) = \\int_{-\\infty}^{\\infty} f(\\tau) g(t - \\tau)  d\\tau. $$\n  \nThe Fourier transform of the function $ \\frac{\\sin(W t)}{\\pi t} $ is the rectangular function:  \n\n$$ \\mathcal{F}\\left\\{ \\frac{\\sin(W t)}{\\pi t} \\right\\}(\\omega) = \\begin{cases} \n1 & \\text{if } |\\omega| < W, \\\\\n0 & \\text{otherwise}.\n\\end{cases} $$\n  \nUse these properties to evaluate the integral.", "solution": "1. Define the functions  \n$$f(t)=\\frac{\\sin(k t)}{\\pi t},\\quad g(t)=\\frac{\\sin(m t)}{\\pi t}.$$  \nTheir convolution is  \n$$ (f*g)(t)=\\int_{-\\infty}^\\infty f(t-\\tau)\\,g(\\tau)\\,d\\tau. $$\n\n2. By the convolution theorem, with the Fourier transform convention  \n$$\\mathcal F\\{h(t)\\}(\\omega)=\\int_{-\\infty}^\\infty h(t)e^{-i\\omega t}dt,$$  \nwe have  \n$$\\mathcal F\\{f\\}(\\omega)=\\begin{cases}1&|\\omega|<k,\\\\0&\\text{otherwise},\\end{cases} \n\\quad\n\\mathcal F\\{g\\}(\\omega)=\\begin{cases}1&|\\omega|<m,\\\\0&\\text{otherwise}.\\end{cases}$$  \nHence  \n$$\\mathcal F\\{f*g\\}(\\omega)\n=\\mathcal F\\{f\\}(\\omega)\\,\\mathcal F\\{g\\}(\\omega)\n=\\begin{cases}1&|\\omega|<\\min(k,m),\\\\0&\\text{otherwise}.\\end{cases}$$\n\n3. Invert the transform:  \n$$(f*g)(t)\n=\\frac{1}{2\\pi}\\int_{-\\min(k,m)}^{\\min(k,m)}e^{i\\omega t}d\\omega\n=\\frac{\\sin\\bigl(\\min(k,m)\\,t\\bigr)}{\\pi\\,t}.$$\n\n4. Evaluate at $t=0$ by the limit $\\lim_{t\\to0}\\sin(a t)/(π t)=a/π$:  \n$$(f*g)(0)=\\frac{\\min(k,m)}{\\pi}.$$", "answer": "$$\\boxed{\\frac{\\min(k,m)}{\\pi}}$$", "id": "539758"}, {"introduction": "In scientific computing, the convolution theorem is fundamental to understanding and mitigating numerical errors in pseudo-spectral methods. When evaluating a nonlinear product like $q(x)=u(x)v(x)w(x)$ in physical space, the corresponding operation in Fourier space is a convolution of the spectra, which expands the range of active wavenumbers. This practice uses the convolution theorem to determine the exact spectral width of a cubic product and derive the grid resolution required to compute it without aliasing error [@problem_id:3423295], a critical step in ensuring the stability and accuracy of numerical simulations.", "problem": "Consider a periodic domain and a pseudo-spectral evaluation of a cubic nonlinearity in the context of spectral and Discontinuous Galerkin (DG) methods. Let $u(x)$, $v(x)$, and $w(x)$ be fields whose complex Fourier series are supported only on integer wavenumbers $k$ satisfying $|k|\\le K$, for some fixed positive integer $K$. You wish to evaluate the product $q(x)=u(x)\\,v(x)\\,w(x)$ in a way that is free of aliasing on the retained band $|k|\\le K$.\n\nAdopt the following procedure: transform each field to physical space on a uniform grid of $M$ equispaced points using the Discrete Fourier Transform (DFT), multiply pointwise to obtain $q(x)$ on that grid, then transform back using the Fast Fourier Transform (FFT) and truncate to retain only modes with $|k|\\le K$. Assume $M$ is an even integer and that the DFT wavenumber indexing is the usual principal set $k\\in\\{-M/2,\\dots,M/2-1\\}$.\n\nStarting only from the convolution theorem for Fourier series and the fact that discrete convolution in Fourier space is computed modulo $M$ by the DFT, derive the minimal padding size $M$ (as a function of $K$) that guarantees no aliasing error contaminates the retained modes $|k|\\le K$ when forming the cubic product. Then express the corresponding padding factor $p := \\frac{M}{2K}$ as a single exact number. Finally, explain, based on your derivation, why the commonly used three-halves rule (i.e., padding factor $p=\\frac{3}{2}$) that suffices for quadratic nonlinearities is insufficient for cubic interactions.\n\nYour final answer must be the single value of $p$ (no units). No numerical rounding is required.", "solution": "Let the fields $u(x)$, $v(x)$, and $w(x)$ be represented by their complex Fourier series. Given that their spectra are supported on integer wavenumbers $k$ such that $|k| \\le K$, their series representations are:\n$$u(x) = \\sum_{k=-K}^{K} \\hat{u}_k e^{ikx}$$\n$$v(x) = \\sum_{l=-K}^{K} \\hat{v}_l e^{ilx}$$\n$$w(x) = \\sum_{m=-K}^{K} \\hat{w}_m e^{imx}$$\nwhere $\\hat{u}_k$, $\\hat{v}_l$, and $\\hat{w}_m$ are the complex Fourier coefficients.\n\nThe exact product is $q(x) = u(x)v(x)w(x)$. To determine the spectral content of $q(x)$, we apply the convolution theorem. First, let's find the spectrum of the intermediate product $p(x) = u(x)v(x)$. The Fourier coefficients of $p(x)$, denoted $\\hat{p}_j$, are given by the convolution of the coefficients of $u(x)$ and $v(x)$:\n$$\\hat{p}_j = (\\hat{u} * \\hat{v})_j = \\sum_{k=-\\infty}^{\\infty} \\hat{u}_k \\hat{v}_{j-k}$$\nSince $\\hat{u}_k$ is non-zero only for $|k| \\le K$ and $\\hat{v}_{j-k}$ is non-zero only for $|j-k| \\le K$, the coefficients $\\hat{p}_j$ can be non-zero only if there exists a $k$ satisfying both conditions. The triangle inequality on the wavenumbers implies $|j| = |k + (j-k)| \\le |k| + |j-k| \\le K + K = 2K$. Thus, the field $p(x)$ has its spectrum supported on wavenumbers $|j| \\le 2K$.\n\nNext, we find the spectrum of the final product $q(x) = p(x)w(x)$. Its Fourier coefficients, $\\hat{q}_n$, are the convolution of the coefficients of $p(x)$ and $w(x)$:\n$$\\hat{q}_n = (\\hat{p} * \\hat{w})_n = \\sum_{j=-\\infty}^{\\infty} \\hat{p}_j \\hat{w}_{n-j}$$\nHere, $\\hat{p}_j$ is non-zero only for $|j| \\le 2K$ and $\\hat{w}_{n-j}$ is non-zero only for $|n-j| \\le K$. Applying the triangle inequality again, we find the support for $\\hat{q}_n$:\n$$|n| = |j + (n-j)| \\le |j| + |n-j| \\le 2K + K = 3K$$\nTherefore, the exact cubic product $q(x)$ is a band-limited function with its Fourier spectrum supported on wavenumbers $|n| \\le 3K$.\n\nThe pseudo-spectral method computes the product on a discrete grid of $M$ points. The discrete Fourier transform (DFT) of the pointwise product $q_j = u_j v_j w_j$ yields numerical coefficients $\\tilde{q}_n$. Due to the finite sampling, these numerical coefficients are related to the exact Fourier coefficients $\\hat{q}_n$ by the aliasing formula:\n$$\\tilde{q}_n = \\sum_{s=-\\infty}^{\\infty} \\hat{q}_{n+sM}$$\nOur goal is to ensure that the computed coefficients are free of aliasing error for the retained modes, which are those with $|n| \\le K$. This means we require $\\tilde{q}_n = \\hat{q}_n$ for all $|n| \\le K$. For this to hold, the sum over aliasing terms must be zero:\n$$\\sum_{s \\in \\mathbb{Z}, s \\neq 0} \\hat{q}_{n+sM} = 0 \\quad \\text{for all } n \\text{ s.t. } |n| \\le K$$\nSince we know that $\\hat{q}_{k'}$ is non-zero only for $|k'| \\le 3K$, the condition for no aliasing on the retained modes is that for any integer $n$ in the range $|n| \\le K$ and any non-zero integer $s$, the aliased wavenumber $n+sM$ must fall outside the spectral support of the exact product. That is:\n$$|n+sM| > 3K \\quad \\text{for all } n \\in [-K, K] \\text{ and } s \\in \\mathbb{Z} \\setminus \\{0\\}$$\nWe only need to check the most restrictive cases, which correspond to $s = 1$ and $s = -1$. For $|s| \\ge 2$, the inequality will hold if it holds for $|s|=1$, assuming a reasonable grid size $M>K$.\n\nCase 1: $s=1$. We must have $|n+M| > 3K$. Since $M$ must be large enough to represent the initial fields (i.e., $M \\ge 2K+1$), $M$ is positive and greater than $K$. Thus $n+M$ is positive for all $|n|\\le K$. The condition becomes $n+M > 3K$. This must hold for all $n \\in [-K, K]$. The worst case (i.e., the smallest value of the left-hand side) occurs at $n=-K$:\n$$-K + M > 3K \\implies M > 4K$$\n\nCase 2: $s=-1$. We must have $|n-M| > 3K$. Since $M > K$, $n-M$ is negative for all $|n|\\le K$. The condition becomes $-(n-M) > 3K$, or $M-n > 3K$. This must hold for all $n \\in [-K, K]$. The worst case (i.e., the smallest value of the left-hand side) occurs at $n=K$:\n$$M - K > 3K \\implies M > 4K$$\nBoth cases yield the same strict inequality: $M > 4K$. This is the minimal condition on the grid size $M$ to guarantee that the cubic product is dealiased for all retained modes $|k|\\le K$.\n\nThe problem defines the padding factor as $p := \\frac{M}{2K}$. Substituting the derived condition for $M$:\n$$p \\cdot (2K) > 4K$$\nSince $K$ is a positive integer, $2K > 0$, and we can divide by it without changing the inequality's direction:\n$$p > 2$$\nThe problem asks for \"the\" padding factor as a single exact number. This corresponds to the boundary of the required condition. Any padding factor greater than $2$ will successfully dealias the cubic nonlinearity. The rule is therefore based on this boundary value. The minimum required padding factor approaches this value from above, so the rule is denoted by the number $2$.\n\nFinally, we explain why the three-halves rule, $p=\\frac{3}{2}$, is insufficient. A padding factor of $p=\\frac{3}{2}$ implies a grid size of $M = p \\cdot (2K) = \\frac{3}{2} \\cdot (2K) = 3K$. This choice of $M$ violates the derived necessary condition $M > 4K$ for any positive $K$.\nTo see the failure explicitly, consider $M=3K$. The aliasing formula for the mode $n=K$ is $\\tilde{q}_K = \\sum_s \\hat{q}_{K+s(3K)}$. For $s=-1$, one of the aliasing terms is $\\hat{q}_{K-3K} = \\hat{q}_{-2K}$. The wavenumber $-2K$ lies within the spectral support of the exact product $q(x)$ (since $|-2K| \\le 3K$ for $K\\ge 0$). In general, $\\hat{q}_{-2K}$ is non-zero. Therefore, the computation of $\\tilde{q}_K$ is contaminated by $\\hat{q}_{-2K}$, and the result is aliased: $\\tilde{q}_K = \\hat{q}_K + \\hat{q}_{-2K} + \\dots \\neq \\hat{q}_K$. The three-halves rule, which is sufficient for quadratic nonlinearities (requiring $M>3K$), is therefore insufficient for cubic nonlinearities, which generate higher wavenumbers and thus demand a larger grid for dealiasing.", "answer": "$$\n\\boxed{2}\n$$", "id": "3423295"}]}