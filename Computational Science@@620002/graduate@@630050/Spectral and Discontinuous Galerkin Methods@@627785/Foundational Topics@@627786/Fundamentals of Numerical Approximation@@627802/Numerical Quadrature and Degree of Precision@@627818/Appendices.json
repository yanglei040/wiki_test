{"hands_on_practices": [{"introduction": "Understanding numerical quadrature begins with deriving the rules themselves. This exercise guides you through the construction of the three-point Gauss-Legendre rule from first principles, using only moment-matching conditions and symmetry. By solving for the nodes and weights directly, you will gain a fundamental appreciation for how Gaussian quadrature achieves the highest possible degree of precision for a given number of points. [@problem_id:3405879]", "problem": "In high-order Discontinuous Galerkin (DG) methods and Spectral Element Methods, volume integrals over a reference element are evaluated by numerical quadrature. A quadrature rule on an interval $[a,b]$ is an approximation of the form $\\int_{a}^{b} f(x)\\,\\mathrm{d}x \\approx \\sum_{j=1}^{m} w_{j} f(x_{j})$, where $x_{j}$ are nodes and $w_{j}$ are weights. The degree of precision of a quadrature rule is the largest integer $n$ such that the rule is exact for all polynomials of degree at most $n$. On the symmetric interval $[-1, 1]$, Gaussian quadrature rules associated with Legendre polynomials are widely used because they maximize the degree of precision for a given number of points.\n\nStarting from the definitions above and symmetry considerations of $[-1, 1]$, construct a three-point quadrature rule of Gauss-Legendre type on $[-1, 1]$ by determining its nodes $x_1, x_2, x_3$ and weights $w_1, w_2, w_3$ so that the rule is exact for all monomials $x^{k}$ with $k \\in \\{0, 1, 2, 3, 4, 5\\}$. Use only the moment conditions implied by exactness on monomials and the symmetry of the interval, without invoking any pre-derived closed-form formulas for Gaussian quadrature nodes or weights. Then verify that the constructed rule achieves degree of precision equal to $5$ by checking exactness for $x^{k}$, $k=0, 1, 2, 3, 4, 5$.\n\nYour final answer must list, in a single row, the three nodes followed by the three weights, in increasing order of the nodes, as exact analytical expressions. No rounding is required.", "solution": "The problem requires the construction of a three-point quadrature rule on the interval $[-1, 1]$, of the form $\\int_{-1}^{1} f(x)\\,\\mathrm{d}x \\approx \\sum_{j=1}^{3} w_{j} f(x_{j})$, which is exact for all polynomials of degree up to $5$. This means the rule must be exact for the monomial basis $\\{x^k\\}$ for $k \\in \\{0, 1, 2, 3, 4, 5\\}$. We must determine the six unknowns: three nodes $x_1, x_2, x_3$ and three weights $w_1, w_2, w_3$.\n\nThe condition of exactness for $f(x) = x^k$ yields a system of six equations:\n$$\n\\sum_{j=1}^{3} w_{j} x_{j}^{k} = \\int_{-1}^{1} x^{k}\\,\\mathrm{d}x \\quad \\text{for } k = 0, 1, 2, 3, 4, 5\n$$\nFirst, we compute the right-hand side of these equations, which are the moments of the interval $[-1, 1]$. The integral is given by:\n$$\n\\int_{-1}^{1} x^{k}\\,\\mathrm{d}x = \\left[ \\frac{x^{k+1}}{k+1} \\right]_{-1}^{1} = \\frac{1^{k+1} - (-1)^{k+1}}{k+1}\n$$\nIf $k$ is an odd integer, $k+1$ is even, and the integral is $\\frac{1-1}{k+1} = 0$.\nIf $k$ is an even integer, $k+1$ is odd, and the integral is $\\frac{1-(-1)}{k+1} = \\frac{2}{k+1}$.\n\nThis gives us the following values for the moments:\n$k=0: \\int_{-1}^{1} 1\\,\\mathrm{d}x = 2$\n$k=1: \\int_{-1}^{1} x\\,\\mathrm{d}x = 0$\n$k=2: \\int_{-1}^{1} x^2\\,\\mathrm{d}x = \\frac{2}{3}$\n$k=3: \\int_{-1}^{1} x^3\\,\\mathrm{d}x = 0$\n$k=4: \\int_{-1}^{1} x^4\\,\\mathrm{d}x = \\frac{2}{5}$\n$k=5: \\int_{-1}^{1} x^5\\,\\mathrm{d}x = 0$\n\nThe system of six equations for the nodes and weights is:\n1.  $w_1 x_1^0 + w_2 x_2^0 + w_3 x_3^0 = w_1 + w_2 + w_3 = 2$\n2.  $w_1 x_1^1 + w_2 x_2^1 + w_3 x_3^1 = 0$\n3.  $w_1 x_1^2 + w_2 x_2^2 + w_3 x_3^2 = \\frac{2}{3}$\n4.  $w_1 x_1^3 + w_2 x_2^3 + w_3 x_3^3 = 0$\n5.  $w_1 x_1^4 + w_2 x_2^4 + w_3 x_3^4 = \\frac{2}{5}$\n6.  $w_1 x_1^5 + w_2 x_2^5 + w_3 x_3^5 = 0$\n\nAs suggested by the problem, we utilize the symmetry of the integration interval $[-1, 1]$. For an optimal quadrature rule, the nodes and weights should exhibit symmetry. Let us postulate a symmetric configuration: one node at the origin, and the other two symmetric with respect to the origin. Let the nodes be ordered as $x_1 < x_2 < x_3$.\nWe set $x_2 = 0$ and $x_1 = -\\xi$, $x_3 = \\xi$ for some $\\xi > 0$.\nThe symmetry of the nodes implies a corresponding symmetry in the weights: $w_1 = w_3$.\n\nSubstituting these symmetry assumptions into our system of equations greatly simplifies it. The unknowns are reduced to three: $\\xi$, $w_1$, and $w_2$.\n\nLet's re-examine the equations:\n1.  $w_1 + w_2 + w_1 = 2w_1 + w_2 = 2$\n2.  $w_1(-\\xi) + w_2(0) + w_1(\\xi) = -w_1\\xi + w_1\\xi = 0$. This equation is automatically satisfied by our symmetry assumption and provides no new information.\n3.  $w_1(-\\xi)^2 + w_2(0)^2 + w_1(\\xi)^2 = w_1\\xi^2 + w_1\\xi^2 = 2w_1\\xi^2 = \\frac{2}{3}$\n4.  $w_1(-\\xi)^3 + w_2(0)^3 + w_1(\\xi)^3 = -w_1\\xi^3 + w_1\\xi^3 = 0$. This is also automatically satisfied.\n5.  $w_1(-\\xi)^4 + w_2(0)^4 + w_1(\\xi)^4 = w_1\\xi^4 + w_1\\xi^4 = 2w_1\\xi^4 = \\frac{2}{5}$\n6.  $w_1(-\\xi)^5 + w_2(0)^5 + w_1(\\xi)^5 = -w_1\\xi^5 + w_1\\xi^5 = 0$. This is also automatically satisfied.\n\nThe fact that the equations for odd powers of $x$ (which correspond to integrals of odd functions over a symmetric interval) are automatically satisfied validates our symmetry assumption. We are left with a system of three equations derived from the even powers of $x$:\n(A) $2w_1 + w_2 = 2$\n(B) $2w_1\\xi^2 = \\frac{2}{3} \\implies w_1\\xi^2 = \\frac{1}{3}$\n(C) $2w_1\\xi^4 = \\frac{2}{5} \\implies w_1\\xi^4 = \\frac{1}{5}$\n\nWe can solve this system for $\\xi$, $w_1$, and $w_2$. By dividing equation (C) by equation (B), we can eliminate $w_1$:\n$$\n\\frac{w_1\\xi^4}{w_1\\xi^2} = \\frac{1/5}{1/3}\n$$\n$$\n\\xi^2 = \\frac{3}{5}\n$$\nSince we defined $\\xi > 0$, we have $\\xi = \\sqrt{\\frac{3}{5}}$.\n\nThe nodes are therefore:\n$x_1 = -\\sqrt{\\frac{3}{5}}$\n$x_2 = 0$\n$x_3 = \\sqrt{\\frac{3}{5}}$\n\nNow we determine the weights. From equation (B), we find $w_1$:\n$$\nw_1 = \\frac{1}{3\\xi^2} = \\frac{1}{3 \\left(\\frac{3}{5}\\right)} = \\frac{1}{\\frac{9}{5}} = \\frac{5}{9}\n$$\nDue to symmetry, $w_3 = w_1 = \\frac{5}{9}$.\n\nFinally, we find $w_2$ from equation (A):\n$$\nw_2 = 2 - 2w_1 = 2 - 2\\left(\\frac{5}{9}\\right) = 2 - \\frac{10}{9} = \\frac{18 - 10}{9} = \\frac{8}{9}\n$$\n\nSo, the three-point quadrature rule is defined by:\nNodes: $x_1 = -\\sqrt{\\frac{3}{5}}$, $x_2 = 0$, $x_3 = \\sqrt{\\frac{3}{5}}$\nWeights: $w_1 = \\frac{5}{9}$, $w_2 = \\frac{8}{9}$, $w_3 = \\frac{5}{9}$\n\nThe problem requires verification that this rule is exact for $k \\in \\{0, 1, 2, 3, 4, 5\\}$.\nLet $S_k = \\sum_{j=1}^{3} w_j x_j^k$ and $I_k = \\int_{-1}^{1} x^k\\,\\mathrm{d}x$.\n\n- For $k=0$: $S_0 = \\frac{5}{9}(1) + \\frac{8}{9}(1) + \\frac{5}{9}(1) = \\frac{18}{9} = 2$. $I_0 = 2$. Exact.\n- For $k=1$: $S_1 = \\frac{5}{9}(-\\sqrt{\\frac{3}{5}}) + \\frac{8}{9}(0) + \\frac{5}{9}(\\sqrt{\\frac{3}{5}}) = 0$. $I_1 = 0$. Exact.\n- For $k=2$: $S_2 = \\frac{5}{9}(-\\sqrt{\\frac{3}{5}})^2 + \\frac{8}{9}(0)^2 + \\frac{5}{9}(\\sqrt{\\frac{3}{5}})^2 = \\frac{5}{9}(\\frac{3}{5}) + 0 + \\frac{5}{9}(\\frac{3}{5}) = \\frac{1}{3} + \\frac{1}{3} = \\frac{2}{3}$. $I_2 = \\frac{2}{3}$. Exact.\n- For $k=3$: $S_3 = \\frac{5}{9}(-\\sqrt{\\frac{3}{5}})^3 + \\frac{8}{9}(0)^3 + \\frac{5}{9}(\\sqrt{\\frac{3}{5}})^3 = \\frac{5}{9}(-\\frac{3}{5}\\sqrt{\\frac{3}{5}}) + 0 + \\frac{5}{9}(\\frac{3}{5}\\sqrt{\\frac{3}{5}}) = 0$. $I_3 = 0$. Exact.\n- For $k=4$: $S_4 = \\frac{5}{9}(-\\sqrt{\\frac{3}{5}})^4 + \\frac{8}{9}(0)^4 + \\frac{5}{9}(\\sqrt{\\frac{3}{5}})^4 = \\frac{5}{9}(\\frac{9}{25}) + 0 + \\frac{5}{9}(\\frac{9}{25}) = \\frac{1}{5} + \\frac{1}{5} = \\frac{2}{5}$. $I_4 = \\frac{2}{5}$. Exact.\n- For $k=5$: $S_5 = \\frac{5}{9}(-\\sqrt{\\frac{3}{5}})^5 + \\frac{8}{9}(0)^5 + \\frac{5}{9}(\\sqrt{\\frac{3}{5}})^5 = \\frac{5}{9}(-\\frac{9}{25}\\sqrt{\\frac{3}{5}}) + 0 + \\frac{5}{9}(\\frac{9}{25}\\sqrt{\\frac{3}{5}}) = 0$. $I_5 = 0$. Exact.\n\nThe verification confirms that the rule is exact for all monomials up to degree $5$. The degree of precision is the largest integer $n$ such that the rule is exact for all polynomials of degree at most $n$. Since the rule is exact for $x^5$ but not for $x^6$ (a general property of $m$-point Gaussian quadrature is that its degree of precision is $2m-1$), the degree of precision for this $3$-point rule is $2(3)-1=5$. Our verification is consistent with this theoretical result.\n\nThe final answer consists of the nodes and weights in the specified order.\nNodes in increasing order: $x_1 = -\\sqrt{\\frac{3}{5}}$, $x_2 = 0$, $x_3 = \\sqrt{\\frac{3}{5}}$.\nCorresponding weights: $w_1 = \\frac{5}{9}$, $w_2 = \\frac{8}{9}$, $w_3 = \\frac{5}{9}$.\nThe list is: $-\\sqrt{\\frac{3}{5}}, 0, \\sqrt{\\frac{3}{5}}, \\frac{5}{9}, \\frac{8}{9}, \\frac{5}{9}$.", "answer": "$$\n\\boxed{\\begin{pmatrix} -\\sqrt{\\frac{3}{5}} & 0 & \\sqrt{\\frac{3}{5}} & \\frac{5}{9} & \\frac{8}{9} & \\frac{5}{9} \\end{pmatrix}}\n$$", "id": "3405879"}, {"introduction": "While Gaussian quadrature rules are optimal, it is instructive to analyze rules with arbitrarily chosen nodes to understand what makes a quadrature rule \"good\" for use in numerical methods. This problem investigates an interpolatory rule with a non-standard node placement and uncovers a critical issue: a non-positive weight. You will connect this mathematical property directly to its practical consequence for the stability of explicit time-stepping schemes in Discontinuous Galerkin (DG) methods, highlighting the importance of positive quadrature weights. [@problem_id:3405819]", "problem": "Consider an interpolatory quadrature rule on the interval $[-1, 1]$ with four distinct nodes $x_1=-1$, $x_2=-\\frac{1}{2}$, $x_3=0$, and $x_4=1$. By definition, an interpolatory quadrature rule with $n$ nodes has degree of precision at least $n-1$ if its weights $w_1, \\dots, w_n$ are chosen so that the rule is exact for all polynomials of degree up to $n-1$. This is enforced by matching the moments of monomials: for integers $k=0, 1, \\dots, n-1$, the weights must satisfy $\\sum_{i=1}^{n} w_{i} x_{i}^{k} = \\int_{-1}^{1} x^{k}\\,\\mathrm{d}x$. Using only these fundamental definitions and facts, compute the unique weights $w_1, w_2, w_3, w_4$ that make the rule exact for all polynomials of degree at most $3$ on $[-1, 1]$, and determine whether all weights are positive. Then, based on first principles, infer the implications of the sign pattern of these weights for explicit time stepping in Discontinuous Galerkin (DG) methods when a mass-lumped quadrature is used to diagonalize the mass matrix. As your final numeric answer, report the smallest weight value $w_{\\min}$.", "solution": "The problem requires the computation of weights for a specific four-node interpolatory quadrature rule on the interval $[-1, 1]$ and an analysis of their properties, particularly in the context of Discontinuous Galerkin (DG) methods.\n\nThe quadrature rule is defined on the interval $[-1, 1]$ with $n=4$ distinct nodes: $x_1=-1$, $x_2=-\\frac{1}{2}$, $x_3=0$, and $x_4=1$.\nThe rule is specified to be an interpolatory quadrature rule, which is made exact for all polynomials of degree up to $n-1 = 3$. This condition is enforced by requiring that the quadrature rule exactly integrates the monomials $x^k$ for $k=0, 1, 2, 3$. This yields a system of linear equations for the unknown weights $w_1, w_2, w_3, w_4$:\n$$ \\sum_{i=1}^{4} w_{i} x_{i}^{k} = \\int_{-1}^{1} x^{k}\\,\\mathrm{d}x \\quad \\text{for } k=0, 1, 2, 3 $$\n\nFirst, we compute the right-hand side of these equations, which are the moments of the monomials on $[-1, 1]$.\nFor $k=0$:\n$$ \\int_{-1}^{1} x^{0}\\,\\mathrm{d}x = \\int_{-1}^{1} 1\\,\\mathrm{d}x = [x]_{-1}^{1} = 1 - (-1) = 2 $$\nFor $k=1$:\n$$ \\int_{-1}^{1} x^{1}\\,\\mathrm{d}x = \\left[\\frac{x^{2}}{2}\\right]_{-1}^{1} = \\frac{1^{2}}{2} - \\frac{(-1)^{2}}{2} = 0 $$\nFor $k=2$:\n$$ \\int_{-1}^{1} x^{2}\\,\\mathrm{d}x = \\left[\\frac{x^{3}}{3}\\right]_{-1}^{1} = \\frac{1^{3}}{3} - \\frac{(-1)^{3}}{3} = \\frac{1}{3} - \\left(-\\frac{1}{3}\\right) = \\frac{2}{3} $$\nFor $k=3$:\n$$ \\int_{-1}^{1} x^{3}\\,\\mathrm{d}x = \\left[\\frac{x^{4}}{4}\\right]_{-1}^{1} = \\frac{1^{4}}{4} - \\frac{(-1)^{4}}{4} = 0 $$\n\nNow, we construct the linear system by substituting the node values $x_1=-1, x_2=-1/2, x_3=0, x_4=1$ and the computed integrals.\nFor $k=0$: $w_1(x_1)^0 + w_2(x_2)^0 + w_3(x_3)^0 + w_4(x_4)^0 = w_1 + w_2 + w_3 + w_4 = 2$\nFor $k=1$: $w_1(x_1)^1 + w_2(x_2)^1 + w_3(x_3)^1 + w_4(x_4)^1 = -w_1 - \\frac{1}{2}w_2 + 0 \\cdot w_3 + w_4 = 0$\nFor $k=2$: $w_1(x_1)^2 + w_2(x_2)^2 + w_3(x_3)^2 + w_4(x_4)^2 = w_1 + \\frac{1}{4}w_2 + 0 \\cdot w_3 + w_4 = \\frac{2}{3}$\nFor $k=3$: $w_1(x_1)^3 + w_2(x_2)^3 + w_3(x_3)^3 + w_4(x_4)^3 = -w_1 - \\frac{1}{8}w_2 + 0 \\cdot w_3 + w_4 = 0$\n\nThe system of equations is:\n1. $w_1 + w_2 + w_3 + w_4 = 2$\n2. $-w_1 - \\frac{1}{2}w_2 + w_4 = 0$\n3. $w_1 + \\frac{1}{4}w_2 + w_4 = \\frac{2}{3}$\n4. $-w_1 - \\frac{1}{8}w_2 + w_4 = 0$\n\nFrom equations (2) and (4), we have:\n$$ -w_1 - \\frac{1}{2}w_2 + w_4 = -w_1 - \\frac{1}{8}w_2 + w_4 $$\n$$ -\\frac{1}{2}w_2 = -\\frac{1}{8}w_2 $$\n$$ \\left(\\frac{1}{8} - \\frac{1}{2}\\right)w_2 = 0 \\implies -\\frac{3}{8}w_2 = 0 \\implies w_2 = 0 $$\n\nSubstituting $w_2=0$ into the system simplifies it:\n1. $w_1 + w_3 + w_4 = 2$\n2. $-w_1 + w_4 = 0 \\implies w_1 = w_4$\n3. $w_1 + w_4 = \\frac{2}{3}$\n\nFrom (2) and (3), we substitute $w_4=w_1$ into (3):\n$$ w_1 + w_1 = \\frac{2}{3} \\implies 2w_1 = \\frac{2}{3} \\implies w_1 = \\frac{1}{3} $$\nSince $w_1=w_4$, we also have $w_4 = \\frac{1}{3}$.\n\nFinally, we use equation (1) to find $w_3$:\n$$ \\frac{1}{3} + w_3 + \\frac{1}{3} = 2 $$\n$$ w_3 + \\frac{2}{3} = 2 \\implies w_3 = 2 - \\frac{2}{3} = \\frac{6-2}{3} = \\frac{4}{3} $$\n\nThe unique weights are $w_1 = \\frac{1}{3}$, $w_2 = 0$, $w_3 = \\frac{4}{3}$, and $w_4 = \\frac{1}{3}$.\n\nThe second part of the problem asks whether all weights are positive. The set of weights is $\\{\\frac{1}{3}, 0, \\frac{4}{3}, \\frac{1}{3}\\}$. Since $w_2 = 0$, not all weights are strictly positive. They are all non-negative.\n\nThe third part of the problem concerns the implications for DG methods. In a DG method, for each element, a mass matrix $M$ is assembled with entries $M_{ij} = \\int_K \\phi_i \\phi_j \\,\\mathrm{d}x$, where $\\phi_i$ are basis functions on the element $K$. For explicit time-stepping schemes, the term $M^{-1}u$ must be computed at each step, making the inversion of $M$ a computational bottleneck.\n\nMass lumping is a technique to approximate $M$ with a diagonal matrix, $\\tilde{M}$, which is trivial to invert. This is often achieved by choosing the basis functions $\\phi_i$ to be Lagrange polynomials associated with a set of quadrature nodes $x_k$ (i.e., $\\phi_i(x_k) = \\delta_{ik}$), and then approximating the integral using that same quadrature rule:\n$$ \\tilde{M}_{ij} = \\sum_{k=1}^n w_k \\phi_i(x_k) \\phi_j(x_k) = \\sum_{k=1}^n w_k \\delta_{ik} \\delta_{jk} $$\n(Here, weights $w_k$ are scaled by the Jacobian of the mapping from the reference to the physical element, a positive constant). This results in a diagonal matrix with entries $\\tilde{M}_{ii} = w_i$.\n\nAn explicit time-stepping scheme for a semi-discrete system $\\frac{du}{dt} = M^{-1}F(u)$ becomes $\\frac{du}{dt} = \\tilde{M}^{-1}F(u)$ after mass lumping. This means the update for the $i$-th degree of freedom is proportional to $(\\tilde{M}^{-1})_{ii} = 1/w_i$.\n\nThe sign pattern of the weights has critical implications:\n- If all $w_i > 0$, the lumped mass matrix $\\tilde{M}$ is diagonal and positive definite. This is generally desired as it often preserves the stability properties of the original continuous problem.\n- If any weight $w_i < 0$, $\\tilde{M}$ is not positive definite, which can introduce instabilities and cause non-physical behavior, potentially rendering the time-stepping scheme unconditionally unstable.\n- If any weight $w_i = 0$, as is the case here with $w_2=0$, the corresponding diagonal entry of $\\tilde{M}$ is zero. This makes the matrix $\\tilde{M}$ singular, and its inverse does not exist. The update for the corresponding degree of freedom is undefined, as it would involve division by zero. Consequently, this quadrature rule is unsuitable for mass lumping in DG methods requiring the inversion of the mass matrix for explicit time-stepping. The numerical scheme would fail.\n\nThe final numeric answer is the smallest weight value, $w_{\\min}$.\n$$ w_{\\min} = \\min\\left\\{\\frac{1}{3}, 0, \\frac{4}{3}, \\frac{1}{3}\\right\\} = 0 $$", "answer": "$$\n\\boxed{0}\n$$", "id": "3405819"}, {"introduction": "One of the most important considerations in applying spectral and DG methods to nonlinear problems is ensuring that the nonlinear terms are integrated accurately. Insufficient quadrature precision can lead to aliasing errors, where high-frequency components of the solution are misrepresented, causing numerical instability. This practice will allow you to explore this phenomenon by demonstrating how a standard quadrature rule fails for a cubic nonlinearity and how increasing the degree of precision through \"over-integration\" can eliminate these errors. [@problem_id:3405861]", "problem": "Consider a one-dimensional spectral or discontinuous Galerkin element on the reference interval $\\left[-1, 1\\right]$, and let the approximate solution $u(x)$ be a polynomial of degree at most $p$ in the monomial basis. Focus on the volume integral of a nonlinear flux function $f(u)$ over the element, which is a common operation in volume terms of spectral and discontinuous Galerkin methods.\n\nUse the following fundamental base:\n- A numerical quadrature rule of degree of precision $m$ is exact for the integral of any polynomial of degree at most $m$.\n- The composition of a polynomial $u(x)$ of degree at most $p$ with a polynomial nonlinearity $f(u)=u^q$ yields a polynomial $f(u(x))$ of degree at most $qp$.\n- For Gauss-Legendre quadrature on $\\left[-1, 1\\right]$ with $N$ nodes, the degree of precision is $m=2N-1$.\n\nTask:\n1. Starting from the core definitions above, show that if $u \\in \\mathbb{P}_p$ (the space of polynomials of degree at most $p$) and $f(u)=u^q$, then the volume integral $\\int_{-1}^{1} f(u(x))\\,dx$ is computed exactly by any quadrature rule with degree of precision $m \\ge qp$. Explain why this implies that exactness to degree $m=2p$ is sufficient for the quadratic nonlinearity $f(u)=\\tfrac{1}{2}u^2$ but insufficient for the cubic $f(u)=u^3$ when $p \\ge 1$, and why $m=3p$ removes the aliasing for the cubic case.\n\n2. Using the above, design a computational test that:\n   - Constructs the specific polynomial $u(x)=x^p$, which is of degree exactly $p$ and yields $f(u(x))$ of degree exactly $qp$ for integer $q \\ge 1$.\n   - Computes the exact integral $I_{q}=\\int_{-1}^{1} f(u(x))\\,dx$ analytically by expanding $f(u(x))$ in the monomial basis and integrating term by term (only even powers contribute, since the domain is symmetric).\n   - Approximates $I_{q}$ using Gauss-Legendre quadrature with a number of nodes $N$ chosen to realize a target degree of precision $m$ via $m=2N-1$.\n   - Reports whether aliasing is present by comparing the quadrature approximation against the analytic value. Use a relative tolerance of $\\varepsilon=10^{-12}$ to declare equality.\n\n3. Implement the test suite below, and aggregate the boolean outcomes as specified at the end:\n   - Test 1 (happy path for quadratic): $p=4$, $q=2$, target $m=2p$. Declare the test as passing if no aliasing is detected, i.e., the quadrature agrees with the analytic integral within tolerance.\n   - Test 2 (insufficiency for cubic): $p=4$, $q=3$, target $m=2p$. Declare the test as passing if aliasing is detected, i.e., the quadrature does not agree within tolerance.\n   - Test 3 (over-integration for cubic): $p=4$, $q=3$, target $m=3p$. Declare the test as passing if no aliasing is detected.\n   - Test 4 (boundary-degree check): $p=2$, $q=3$, target $m=2p$. Declare the test as passing if aliasing is detected.\n   - Test 5 (small-degree quadratic): $p=2$, $q=2$, target $m=2p$. Declare the test as passing if no aliasing is detected.\n\nImplementation requirements:\n- You must compute the analytic integral exactly by manipulating polynomial coefficients: given $u(x)=x^p$, construct $f(u(x))$ as a monomial polynomial using repeated polynomial multiplication in the monomial basis and integrate term-by-term by $\\int_{-1}^{1} x^k\\,dx = 0$ for odd $k$ and $\\int_{-1}^{1} x^k\\,dx = \\dfrac{2}{k+1}$ for even $k$.\n- You must realize the target degree of precision $m$ by selecting the smallest integer $N$ such that $2N-1 \\ge m$, then use $N$-point Gauss-Legendre quadrature to compute the numerical integral of $f(u(x))$.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[result1,result2,result3,result4,result5]\").\n- Each result should be a boolean value: \"True\" if the test passes under the criteria above, and \"False\" otherwise.\n- No physical units or angles are involved in this problem; all computations are dimensionless.", "solution": "The problem statement is assessed as valid. It is scientifically grounded in the principles of numerical analysis, specifically numerical quadrature and polynomial approximation theory. It is well-posed, objective, and contains all necessary information to derive a solution and implement the required computational tests.\n\n### 1. Theoretical Analysis of Quadrature Exactness\n\nThe problem requires an analysis of the conditions under which a numerical quadrature rule can exactly integrate the volume term $\\int_{-1}^{1} f(u(x))\\,dx$ in a spectral or discontinuous Galerkin method.\n\nThe givens are:\n- The domain of integration is the reference interval $I = [-1, 1]$.\n- The approximate solution $u(x)$ is a polynomial of degree at most $p$, denoted as $u \\in \\mathbb{P}_p$.\n- The nonlinear flux function is a polynomial of the form $f(u) = u^q$ for some integer $q \\ge 1$.\n- A numerical quadrature rule with degree of precision $m$ exactly integrates any polynomial of degree at most $m$.\n- For Gauss-Legendre quadrature with $N$ nodes, the degree of precision is $m = 2N-1$.\n\nFirst, we determine the nature of the integrand $f(u(x))$. Since $u(x)$ is a polynomial of degree at most $p$, it can be written as $u(x) = \\sum_{k=0}^{p} c_k x^k$. The composition $f(u(x))$ is then $(u(x))^q = (\\sum_{k=0}^{p} c_k x^k)^q$. The highest power of $x$ in this expression arises from the highest power of $x$ in $u(x)$, which is $x^p$. Thus, the term of highest degree in the expansion of $f(u(x))$ is $(c_p x^p)^q = c_p^q x^{pq}$. This means that $f(u(x))$ is a polynomial of degree at most $pq$.\n\nAccording to the definition of degree of precision, a quadrature rule can compute the integral $\\int_{-1}^{1} g(x)\\,dx$ exactly if $g(x)$ is a polynomial and its degree, $\\text{deg}(g)$, satisfies $\\text{deg}(g) \\le m$. In our case, the integrand is $g(x) = f(u(x))$, which is a polynomial of degree at most $pq$. Therefore, for exact integration, we must choose a quadrature rule with a degree of precision $m$ such that $m \\ge pq$.\n\nNow, we apply this general result to the specific cases mentioned:\n\n- **Quadratic nonlinearity ($q=2$):** The flux is $f(u) = u^2$ (or $\\frac{1}{2}u^2$, the constant factor does not affect the polynomial degree). The integrand $f(u(x))$ is a polynomial of degree at most $2p$. If we use a quadrature rule with a target degree of precision $m=2p$, the condition for exactness $m \\ge 2p$ is met. This means that a quadrature rule with $m=2p$ is sufficient to compute the integral exactly, and no aliasing error will occur.\n\n- **Cubic nonlinearity ($q=3$):** The flux is $f(u) = u^3$. The integrand $f(u(x))$ is a polynomial of degree at most $3p$. If we use a quadrature rule with a target degree of precision $m=2p$, the condition for exactness $m \\ge 3p$ is *not* met for any $p \\ge 1$, since $2p < 3p$. The quadrature rule is not powerful enough to exactly integrate the high-degree polynomial that results from the cubic nonlinearity. This failure to resolve the highest-degree terms in the polynomial results in an aliasing error, where the contribution of these high-degree terms is incorrectly mapped to the result, leading to an inaccurate numerical integral.\n\n- **De-aliasing the cubic case:** To eliminate the aliasing error for the cubic nonlinearity, one must use a quadrature rule that satisfies the exactness condition $m \\ge 3p$. By choosing a rule with a degree of precision $m=3p$, we ensure that the integral is computed exactly. This technique is often referred to as over-integration or de-aliasing.\n\n### 2. Design of the Computational Test\n\nThe computational test is designed to verify the theoretical conclusions above.\n\n**a. Polynomial Construction and Analytic Integration:**\nWe choose the specific polynomial $u(x) = x^p$, which has a degree of exactly $p$. The flux function $f(u) = u^q$ then becomes $f(u(x)) = (x^p)^q = x^{pq}$. This is a monomial of degree exactly $pq$. The problem requires computing the analytic integral by expanding $f(u)$ and integrating term-by-term. In this simplified case, there is only one term, $x^{pq}$.\n\nThe exact integral $I_{q,p} = \\int_{-1}^{1} x^{pq}\\,dx$ is calculated using the standard formula for integrating powers of $x$ over a symmetric interval:\n$$\nI_{q,p} = \\int_{-1}^{1} x^{k}\\,dx = \\begin{cases} 0 & \\text{if } k \\text{ is odd} \\\\ \\frac{2}{k+1} & \\text{if } k \\text{ is even} \\end{cases}\n$$\nHere, $k=pq$. So, the exact analytic integral is $I_{q,p} = \\frac{2}{pq+1}$ if $pq$ is even, and $I_{q,p} = 0$ if $pq$ is odd. For all the test cases specified, $p$ and $q$ are such that $pq$ is even, so the integral will be non-zero.\n\n**b. Numerical Integration:**\nThe numerical integral is computed using Gauss-Legendre quadrature. Given a target degree of precision $m$, we need to find the minimum number of quadrature nodes $N$ that achieves this precision. The relationship is $2N-1 \\ge m$. Solving for $N$ gives $N \\ge \\frac{m+1}{2}$. Since $N$ must be an integer, we choose $N = \\lceil \\frac{m+1}{2} \\rceil$. In integer arithmetic, this can be computed as $N = (m+2)//2$.\n\nWith $N$ determined, we obtain the $N$ Gauss-Legendre nodes $\\{x_i\\}_{i=1}^N$ and weights $\\{w_i\\}_{i=1}^N$. The numerical approximation of the integral is then:\n$$\n\\tilde{I}_{q,p} = \\sum_{i=1}^{N} w_i f(u(x_i)) = \\sum_{i=1}^{N} w_i (x_i)^{pq}\n$$\n\n**c. Aliasing Detection:**\nAliasing is present if the numerical integral $\\tilde{I}_{q,p}$ does not match the analytic integral $I_{q,p}$. We compare these values using a relative tolerance $\\varepsilon = 10^{-12}$. Aliasing is detected if:\n$$\n\\frac{|I_{q,p} - \\tilde{I}_{q,p}|}{|I_{q,p}|} \\ge \\varepsilon\n$$\nThis is equivalent to checking if $I_{q,p}$ and $\\tilde{I}_{q,p}$ are not \"close\" within the given relative tolerance.\n\n### 3. Test Cases Implementation\n\nThe implementation will follow the logic above for each of the five test cases. A helper function will perform the calculations for a given set of parameters $(p, q, m_{\\text{target}})$ and return a boolean indicating whether the test's specific condition (e.g., \"aliasing is detected\") is met.\n\n- **Test 1 ($p=4, q=2, m=2p=8$):** Integrand degree is $pq=8$. Target precision is $m=8$. The rule should be exact ($m \\ge pq$). The test passes if no aliasing is detected.\n- **Test 2 ($p=4, q=3, m=2p=8$):** Integrand degree is $pq=12$. Target precision is $m=8$. The rule is insufficient ($m < pq$). The test passes if aliasing is detected.\n- **Test 3 ($p=4, q=3, m=3p=12$):** Integrand degree is $pq=12$. Target precision is $m=12$. The rule should be exact ($m \\ge pq$). The test passes if no aliasing is detected.\n- **Test 4 ($p=2, q=3, m=2p=4$):** Integrand degree is $pq=6$. Target precision is $m=4$. The rule is insufficient ($m < pq$). The test passes if aliasing is detected.\n- **Test 5 ($p=2, q=2, m=2p=4$):** Integrand degree is $pq=4$. Target precision is $m=4$. The rule should be exact ($m \\ge pq$). The test passes if no aliasing is detected.\n\nThe final program will execute these tests and format the boolean pass/fail outcomes as a comma-separated list.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.special import roots_legendre\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite for quadrature aliasing and print results.\n    \"\"\"\n    \n    # Test cases defined as (p, q, m_name, m_func, expected_aliasing) tuples.\n    # m_name is for clarity, m_func calculates target m from p.\n    # expected_aliasing: True if the test passes when aliasing is detected.\n    test_cases = [\n        # Test 1: p=4, q=2, m=2p. Should be exact. Pass if no aliasing.\n        {'p': 4, 'q': 2, 'm_target': 2 * 4, 'pass_if_aliasing_detected': False},\n        # Test 2: p=4, q=3, m=2p. Insufficient. Pass if aliasing.\n        {'p': 4, 'q': 3, 'm_target': 2 * 4, 'pass_if_aliasing_detected': True},\n        # Test 3: p=4, q=3, m=3p. Sufficient. Pass if no aliasing.\n        {'p': 4, 'q': 3, 'm_target': 3 * 4, 'pass_if_aliasing_detected': False},\n        # Test 4: p=2, q=3, m=2p. Insufficient. Pass if aliasing.\n        {'p': 2, 'q': 3, 'm_target': 2 * 2, 'pass_if_aliasing_detected': True},\n        # Test 5: p=2, q=2, m=2p. Sufficient. Pass if no aliasing.\n        {'p': 2, 'q': 2, 'm_target': 2 * 2, 'pass_if_aliasing_detected': False},\n    ]\n\n    results = []\n\n    for case in test_cases:\n        p = case['p']\n        q = case['q']\n        m_target = case['m_target']\n        pass_if_aliasing_detected = case['pass_if_aliasing_detected']\n\n        # 1. ANALYTIC INTEGRAL\n        # The integrand is f(u(x)) = (x^p)^q = x^(p*q).\n        integrand_degree = p * q\n        \n        # Analytic integral I = integral from -1 to 1 of x^k dx.\n        # I = 2/(k+1) if k is even, I = 0 if k is odd.\n        # For all test cases, p*q is even.\n        if integrand_degree % 2 != 0:\n            analytic_integral = 0.0\n        else:\n            analytic_integral = 2.0 / (integrand_degree + 1)\n            \n        # 2. NUMERICAL INTEGRAL\n        # Determine number of quadrature points N for target precision m.\n        # The degree of precision for N-point Gauss-Legendre is 2N-1.\n        # We need 2N-1 >= m_target => N >= (m_target + 1)/2.\n        # As N must be an integer, N = ceil((m_target + 1)/2).\n        num_points_N = int(np.ceil((m_target + 1) / 2.0))\n\n        # Get Gauss-Legendre nodes and weights.\n        nodes, weights = roots_legendre(num_points_N)\n        \n        # Evaluate the integrand at the nodes.\n        integrand_values = nodes ** integrand_degree\n        \n        # Compute the numerical integral by summing weighted values.\n        numeric_integral = np.sum(weights * integrand_values)\n\n        # 3. ALIASING DETECTION AND TEST VERDICT\n        # Aliasing is detected if the numerical result is not close to the analytic one.\n        # Using a relative tolerance of 1e-12 as specified.\n        # atol is a failsafe for cases where the analytic integral is zero.\n        is_exact = np.isclose(analytic_integral, numeric_integral, rtol=1e-12, atol=1e-15)\n        aliasing_detected = not is_exact\n        \n        # The test passes if the aliasing detection matches the expectation.\n        test_passes = (aliasing_detected == pass_if_aliasing_detected)\n        results.append(test_passes)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3405861"}]}