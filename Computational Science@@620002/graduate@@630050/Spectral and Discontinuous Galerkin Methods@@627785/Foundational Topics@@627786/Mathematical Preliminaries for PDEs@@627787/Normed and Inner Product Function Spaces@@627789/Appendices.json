{"hands_on_practices": [{"introduction": "The distinction between a general normed space and an inner product space (a Hilbert space) is fundamental to the theory of spectral and DG methods. The parallelogram law is the key identity that a norm must satisfy to be generated by an inner product. This exercise provides a hands-on calculation to demonstrate this abstract principle concretely, showing that the common $L^1$ norm fails the test and reinforcing why the $L^2$ space is the natural setting for methods based on orthogonality [@problem_id:3404469].", "problem": "In the analysis of spectral methods and Discontinuous Galerkin (DG) methods, the choice of function space and norm influences stability and approximation properties. Consider the space of continuous functions on the unit interval, denoted $C([0,1])$. Define the norm $\\| \\cdot \\|_{1}$ on $C([0,1])$ by\n$$\n\\| f \\|_{1} = \\int_{0}^{1} | f(x) | \\, dx.\n$$\nThe parallelogram law is the identity\n$$\n\\| f + g \\|^{2} + \\| f - g \\|^{2} = 2 \\| f \\|^{2} + 2 \\| g \\|^{2}\n$$\nthat must hold for any norm $\\| \\cdot \\|$ induced by an inner product.\n\nConstruct a concrete counterexample within $C([0,1])$ that shows $\\| \\cdot \\|_{1}$ violates the parallelogram law by evaluating the defect\n$$\nD = \\| f + g \\|_{1}^{2} + \\| f - g \\|_{1}^{2} - 2 \\| f \\|_{1}^{2} - 2 \\| g \\|_{1}^{2}\n$$\nfor the continuous functions\n$$\nf(x) = \\max \\{ 1 - 4x, 0 \\}, \\qquad g(x) = \\max \\{ 4x - 3, 0 \\}, \\qquad x \\in [0,1].\n$$\nExplain why this violation implies that no inner product can generate the norm $\\| \\cdot \\|_{1}$ on $C([0,1])$. Report as your final answer the exact value of $D$ (no rounding).", "solution": "The goal is to compute the defect $D$ for the given functions $f(x)$ and $g(x)$ and the norm $\\| \\cdot \\|_1$. We begin by analyzing the functions and computing the required norms.\n\nThe function $f(x) = \\max \\{ 1 - 4x, 0 \\}$ is non-zero when $1 - 4x  0$, which implies $x  1/4$. Thus, $f(x)$ can be written in piecewise form as:\n$$\nf(x) =\n\\begin{cases}\n1 - 4x  \\text{for } 0 \\le x \\le 1/4 \\\\\n0  \\text{for } 1/4  x \\le 1\n\\end{cases}\n$$\nThe function $g(x) = \\max \\{ 4x - 3, 0 \\}$ is non-zero when $4x - 3  0$, which implies $x  3/4$. Thus, $g(x)$ can be written in piecewise form as:\n$$\ng(x) =\n\\begin{cases}\n0  \\text{for } 0 \\le x \\le 3/4 \\\\\n4x - 3  \\text{for } 3/4  x \\le 1\n\\end{cases}\n$$\nBoth $f(x)$ and $g(x)$ are non-negative for all $x \\in [0,1]$. This simplifies the calculation of their norms, as $|f(x)| = f(x)$ and $|g(x)| = g(x)$.\n\nWe first calculate $\\| f \\|_{1}$:\n$$\n\\| f \\|_{1} = \\int_{0}^{1} |f(x)| \\, dx = \\int_{0}^{1} f(x) \\, dx = \\int_{0}^{1/4} (1-4x) \\, dx\n$$\nThis integral represents the area of a triangle with base $1/4$ and height $f(0)=1$. The area is $\\frac{1}{2} \\times \\frac{1}{4} \\times 1 = \\frac{1}{8}$. Alternatively, by direct integration:\n$$\n\\| f \\|_{1} = \\left[ x - 2x^2 \\right]_{0}^{1/4} = \\left( \\frac{1}{4} - 2\\left(\\frac{1}{4}\\right)^2 \\right) - (0) = \\frac{1}{4} - \\frac{2}{16} = \\frac{1}{4} - \\frac{1}{8} = \\frac{1}{8}.\n$$\n\nNext, we calculate $\\| g \\|_{1}$:\n$$\n\\| g \\|_{1} = \\int_{0}^{1} |g(x)| \\, dx = \\int_{0}^{1} g(x) \\, dx = \\int_{3/4}^{1} (4x-3) \\, dx\n$$\nThis integral represents the area of a triangle with base $1 - 3/4 = 1/4$ and height $g(1)=1$. The area is $\\frac{1}{2} \\times \\frac{1}{4} \\times 1 = \\frac{1}{8}$. Alternatively, by direct integration:\n$$\n\\| g \\|_{1} = \\left[ 2x^2 - 3x \\right]_{3/4}^{1} = (2-3) - \\left( 2\\left(\\frac{3}{4}\\right)^2 - 3\\left(\\frac{3}{4}\\right) \\right) = -1 - \\left( \\frac{18}{16} - \\frac{9}{4} \\right) = -1 - \\left( \\frac{9}{8} - \\frac{18}{8} \\right) = -1 - \\left(-\\frac{9}{8}\\right) = \\frac{1}{8}.\n$$\n\nNow we consider the functions $f+g$ and $f-g$. The supports of $f(x)$ and $g(x)$ are $[0, 1/4]$ and $[3/4, 1]$ respectively, which are disjoint.\nSince $f(x) \\ge 0$ and $g(x) \\ge 0$, we have $|f(x)+g(x)| = f(x)+g(x)$.\n$$\n\\| f + g \\|_{1} = \\int_{0}^{1} |f(x)+g(x)| \\, dx = \\int_{0}^{1} (f(x)+g(x)) \\, dx = \\int_{0}^{1} f(x) \\, dx + \\int_{0}^{1} g(x) \\, dx = \\|f\\|_{1} + \\|g\\|_{1}\n$$\n$$\n\\| f + g \\|_{1} = \\frac{1}{8} + \\frac{1}{8} = \\frac{2}{8} = \\frac{1}{4}.\n$$\n\nFor the difference $f-g$, we consider its absolute value. Because the supports are disjoint:\n- If $x \\in [0, 1/4]$, $g(x)=0$, so $|f(x)-g(x)| = |f(x)| = f(x)$.\n- If $x \\in (1/4, 3/4)$, $f(x)=0$ and $g(x)=0$, so $|f(x)-g(x)| = 0$.\n- If $x \\in [3/4, 1]$, $f(x)=0$, so $|f(x)-g(x)| = |-g(x)| = |g(x)| = g(x)$.\nTherefore, $|f(x)-g(x)| = f(x) + g(x)$ for all $x \\in [0,1]$.\nThis leads to:\n$$\n\\| f - g \\|_{1} = \\int_{0}^{1} |f(x)-g(x)| \\, dx = \\int_{0}^{1} (f(x)+g(x)) \\, dx = \\|f+g\\|_{1} = \\frac{1}{4}.\n$$\n\nFinally, we compute the defect $D$:\n$$\nD = \\| f + g \\|_{1}^{2} + \\| f - g \\|_{1}^{2} - 2 \\| f \\|_{1}^{2} - 2 \\| g \\|_{1}^{2}\n$$\nSubstituting the calculated values:\n$$\nD = \\left(\\frac{1}{4}\\right)^2 + \\left(\\frac{1}{4}\\right)^2 - 2\\left(\\frac{1}{8}\\right)^2 - 2\\left(\\frac{1}{8}\\right)^2\n$$\n$$\nD = \\frac{1}{16} + \\frac{1}{16} - 2\\left(\\frac{1}{64}\\right) - 2\\left(\\frac{1}{64}\\right)\n$$\n$$\nD = \\frac{2}{16} - \\frac{4}{64} = \\frac{1}{8} - \\frac{1}{16}\n$$\n$$\nD = \\frac{2}{16} - \\frac{1}{16} = \\frac{1}{16}.\n$$\n\n**Explanation**\n\nThe parallelogram law is a necessary and sufficient condition for a norm to be induced by an inner product. This is the content of the Jordan-von Neumann theorem. A norm $\\| \\cdot \\|$ on a vector space $V$ is generated by an inner product $\\langle \\cdot, \\cdot \\rangle$ (i.e., $\\| v \\| = \\sqrt{\\langle v, v \\rangle}$ for all $v \\in V$) if and only if the identity $\\| u+v \\|^2 + \\| u-v \\|^2 = 2\\| u \\|^2 + 2\\| v \\|^2$ holds for all $u, v \\in V$.\n\nThis identity is equivalent to the statement that the defect $D = \\| u+v \\|^2 + \\| u-v \\|^2 - 2\\| u \\|^2 - 2\\| v \\|^2$ must be equal to $0$ for all pairs of vectors. We have constructed a specific counterexample within the space $C([0,1])$ using the functions $f(x) = \\max \\{ 1 - 4x, 0 \\}$ and $g(x) = \\max \\{ 4x - 3, 0 \\}$. Our calculation shows that for this pair of functions, the defect under the norm $\\| \\cdot \\|_1$ is $D = 1/16$.\n\nSince $D \\neq 0$, the parallelogram law is violated. This violation proves that the norm $\\| \\cdot \\|_{1}$ on the space $C([0,1])$ cannot be generated by any inner product. Consequently, $(C([0,1]), \\| \\cdot \\|_1)$ is a normed vector space but not an inner product space.", "answer": "$$\n\\boxed{\\frac{1}{16}}\n$$", "id": "3404469"}, {"introduction": "Having established the importance of inner product spaces, we now explore how to construct their foundational tools: orthonormal bases. The Gram-Schmidt process provides a systematic way to convert any set of linearly independent functions into an orthonormal set, which, when applied to simple monomials in $L^2([-1,1])$, generates the highly important Legendre polynomials. This practice solidifies the connection between an abstract algorithm and a classical polynomial family central to spectral methods, and introduces the core skill of analyzing a function's spectral projection [@problem_id:3404473].", "problem": "Consider the real Hilbert space $L^{2}((-1,1))$ with the standard inner product $\\langle u,v\\rangle=\\int_{-1}^{1} u(x)\\,v(x)\\,dx$, as used in spectral and Discontinuous Galerkin (DG) methods. Let $\\{1,x,x^{2},\\dots\\}$ denote the monomial sequence.\n\n(a) Apply the Gramâ€“Schmidt process with respect to $\\langle\\cdot,\\cdot\\rangle$ to the first three monomials to construct the first three orthonormal polynomials $\\{\\phi_{0},\\phi_{1},\\phi_{2}\\}$. Based on orthogonality and normalization properties, identify the general form of the resulting orthonormal sequence $\\{\\phi_{n}\\}_{n\\ge 0}$ in terms of a classical orthogonal polynomial family, and justify this identification from first principles of orthogonality in $L^{2}((-1,1))$.\n\n(b) For a fixed parameter $\\alpha0$, let $f(x)=\\exp(\\alpha x)$, and define the spectral projection coefficients $c_{n}=\\langle f,\\phi_{n}\\rangle$ for $n\\ge 0$. Express $c_{n}$ in closed form using standard special functions, starting from the inner product definition and orthogonality properties established in part (a).\n\n(c) As a quantitative diagnostic of numerical stability with respect to the distribution of energy among modes, define the infinite-dimensional growth factor\n$$\nG(\\alpha)\\;=\\;\\lim_{N\\to\\infty}\\frac{\\bigg(\\sum_{n=0}^{N} |c_{n}|^{2}\\bigg)^{1/2}}{|c_{0}|}.\n$$\nDerive a closed-form analytic expression for $G(\\alpha)$ as a function of $\\alpha$. Report your final result as a single closed-form expression in $\\alpha$. No rounding is required, and no units are involved.", "solution": "(a) Construction of Orthonormal Polynomials and Identification\n\nWe are tasked with applying the Gram-Schmidt process to the monomial sequence $\\{v_n(x) = x^n\\}_{n=0,1,2}$ in the Hilbert space $L^2((-1,1))$ with the inner product $\\langle u, v \\rangle = \\int_{-1}^1 u(x)v(x)dx$. The resulting orthonormal polynomials are denoted by $\\{\\phi_0, \\phi_1, \\phi_2\\}$.\n\nLet $p_n$ be the orthogonal polynomials obtained before normalization.\n\nFor $n=0$:\nThe first basis vector is $v_0(x) = 1$. We set $p_0(x) = v_0(x) = 1$.\nThe squared norm is $\\|p_0\\|^2 = \\langle 1, 1 \\rangle = \\int_{-1}^1 1^2 dx = 2$.\nThe first orthonormal polynomial is $\\phi_0(x) = \\frac{p_0(x)}{\\|p_0\\|} = \\frac{1}{\\sqrt{2}}$.\n\nFor $n=1$:\nThe second basis vector is $v_1(x) = x$. The orthogonal polynomial $p_1$ is given by\n$p_1(x) = v_1(x) - \\frac{\\langle v_1, p_0 \\rangle}{\\langle p_0, p_0 \\rangle} p_0(x)$.\nThe inner product is $\\langle v_1, p_0 \\rangle = \\langle x, 1 \\rangle = \\int_{-1}^1 x dx = 0$.\nThus, $p_1(x) = x$.\nThe squared norm is $\\|p_1\\|^2 = \\langle x, x \\rangle = \\int_{-1}^1 x^2 dx = \\left[\\frac{x^3}{3}\\right]_{-1}^1 = \\frac{2}{3}$.\nThe second orthonormal polynomial is $\\phi_1(x) = \\frac{p_1(x)}{\\|p_1\\|} = \\frac{x}{\\sqrt{2/3}} = \\sqrt{\\frac{3}{2}} x$.\n\nFor $n=2$:\nThe third basis vector is $v_2(x) = x^2$. The orthogonal polynomial $p_2$ is\n$p_2(x) = v_2(x) - \\frac{\\langle v_2, p_0 \\rangle}{\\langle p_0, p_0 \\rangle} p_0(x) - \\frac{\\langle v_2, p_1 \\rangle}{\\langle p_1, p_1 \\rangle} p_1(x)$.\nWe calculate the required inner products:\n$\\langle v_2, p_0 \\rangle = \\langle x^2, 1 \\rangle = \\int_{-1}^1 x^2 dx = \\frac{2}{3}$.\n$\\langle v_2, p_1 \\rangle = \\langle x^2, x \\rangle = \\int_{-1}^1 x^3 dx = 0$.\nSubstituting these values:\n$p_2(x) = x^2 - \\frac{2/3}{2} (1) - \\frac{0}{2/3} (x) = x^2 - \\frac{1}{3}$.\nThe squared norm is $\\|p_2\\|^2 = \\langle x^2 - \\frac{1}{3}, x^2 - \\frac{1}{3} \\rangle = \\int_{-1}^1 (x^4 - \\frac{2}{3}x^2 + \\frac{1}{9}) dx$.\n$\\|p_2\\|^2 = \\left[\\frac{x^5}{5} - \\frac{2}{9}x^3 + \\frac{1}{9}x\\right]_{-1}^1 = 2\\left(\\frac{1}{5} - \\frac{2}{9} + \\frac{1}{9}\\right) = 2\\left(\\frac{1}{5} - \\frac{1}{9}\\right) = 2\\left(\\frac{9-5}{45}\\right) = \\frac{8}{45}$.\nThe third orthonormal polynomial is $\\phi_2(x) = \\frac{p_2(x)}{\\|p_2\\|} = \\frac{x^2 - 1/3}{\\sqrt{8/45}} = \\sqrt{\\frac{45}{8}} (x^2 - \\frac{1}{3}) = \\sqrt{\\frac{5}{2}} \\cdot \\frac{1}{2}(3x^2 - 1)$.\n\nThe sequence of polynomials $\\{p_n\\}_{n \\ge 0}$ obtained by orthogonalizing the monomial basis $\\{1, x, x^2, \\dots\\}$ on the interval $[-1, 1]$ with weight function $w(x)=1$ are, by definition, the Legendre polynomials, denoted $P_n(x)$.\nThe first three Legendre polynomials are $P_0(x) = 1$, $P_1(x) = x$, and $P_2(x) = \\frac{1}{2}(3x^2-1)$. Our calculated orthogonal polynomials $p_0, p_1, p_2$ are scalar multiples of these (in this case, $p_0=P_0$, $p_1=P_1$, $p_2=\\frac{2}{3}P_2$).\nThe standard normalization for Legendre polynomials is $\\langle P_n, P_m \\rangle = \\int_{-1}^1 P_n(x)P_m(x) dx = \\frac{2}{2n+1}\\delta_{nm}$, where $\\delta_{nm}$ is the Kronecker delta.\nThe orthonormal polynomials $\\phi_n(x)$ are therefore the normalized Legendre polynomials:\n$\\phi_n(x) = \\frac{P_n(x)}{\\|P_n\\|} = \\frac{P_n(x)}{\\sqrt{2/(2n+1)}} = \\sqrt{\\frac{2n+1}{2}} P_n(x)$.\nOur results for $n=0, 1, 2$ confirm this general form:\n$\\phi_0(x) = \\sqrt{\\frac{1}{2}} P_0(x) = \\frac{1}{\\sqrt{2}}$.\n$\\phi_1(x) = \\sqrt{\\frac{3}{2}} P_1(x) = \\sqrt{\\frac{3}{2}} x$.\n$\\phi_2(x) = \\sqrt{\\frac{5}{2}} P_2(x) = \\sqrt{\\frac{5}{2}} \\frac{1}{2}(3x^2 - 1)$.\nThe justification from first principles is that the Legendre polynomials are precisely defined by this orthogonalization process on $L^2((-1,1))$.\n\n(b) Calculation of Spectral Coefficients\n\nThe spectral projection coefficients $c_n$ are given by the inner product $c_n = \\langle f, \\phi_n \\rangle$, where $f(x) = \\exp(\\alpha x)$.\n$c_n = \\int_{-1}^1 \\exp(\\alpha x) \\phi_n(x) dx$.\nUsing the result from part (a), we substitute $\\phi_n(x) = \\sqrt{\\frac{2n+1}{2}} P_n(x)$:\n$c_n = \\sqrt{\\frac{2n+1}{2}} \\int_{-1}^1 \\exp(\\alpha x) P_n(x) dx$.\nA standard integral identity involving Legendre polynomials and the exponential function relates this integral to the modified Bessel function of the first kind of half-integer order, $I_{n+1/2}(\\alpha)$:\n$\\int_{-1}^1 \\exp(\\alpha x) P_n(x) dx = \\sqrt{\\frac{2\\pi}{\\alpha}} I_{n+1/2}(\\alpha)$.\nSubstituting this identity into the expression for $c_n$:\n$c_n = \\sqrt{\\frac{2n+1}{2}} \\left( \\sqrt{\\frac{2\\pi}{\\alpha}} I_{n+1/2}(\\alpha) \\right) = \\sqrt{\\frac{(2n+1)\\pi}{\\alpha}} I_{n+1/2}(\\alpha)$.\nThis is the closed-form expression for the spectral coefficients $c_n$.\n\n(c) Derivation of the Growth Factor\n\nThe growth factor $G(\\alpha)$ is defined as\n$$G(\\alpha) = \\lim_{N\\to\\infty}\\frac{\\bigg(\\sum_{n=0}^{N} |c_{n}|^{2}\\bigg)^{1/2}}{|c_{0}|}.$$\nThe numerator involves the sum of the squared magnitudes of the spectral coefficients. Since the set $\\{\\phi_n\\}_{n \\ge 0}$ forms a complete orthonormal basis for the Hilbert space $L^2((-1,1))$, Parseval's identity applies to any function $f \\in L^2((-1,1))$. The identity states that $\\sum_{n=0}^{\\infty} |c_n|^2 = \\|f\\|^2_{L^2}$.\nThus, the limit in the numerator is the $L^2$-norm of $f(x) = \\exp(\\alpha x)$:\n$\\lim_{N\\to\\infty} \\sum_{n=0}^{N} |c_n|^2 = \\|f\\|^2 = \\langle f, f \\rangle = \\int_{-1}^1 (\\exp(\\alpha x))^2 dx = \\int_{-1}^1 \\exp(2\\alpha x) dx$.\nEvaluating the integral:\n$\\|f\\|^2 = \\left[\\frac{\\exp(2\\alpha x)}{2\\alpha}\\right]_{-1}^1 = \\frac{\\exp(2\\alpha) - \\exp(-2\\alpha)}{2\\alpha} = \\frac{\\sinh(2\\alpha)}{\\alpha}$.\nThe numerator of $G(\\alpha)$ is therefore $\\|f\\| = \\sqrt{\\frac{\\sinh(2\\alpha)}{\\alpha}}$.\n\nThe denominator is $|c_0|$. We calculate $c_0$ using either the direct integral or the formula from part (b) with $n=0$.\nUsing the direct integral with $\\phi_0(x) = 1/\\sqrt{2}$:\n$c_0 = \\langle \\exp(\\alpha x), \\phi_0 \\rangle = \\int_{-1}^1 \\exp(\\alpha x) \\frac{1}{\\sqrt{2}} dx = \\frac{1}{\\sqrt{2}} \\left[\\frac{\\exp(\\alpha x)}{\\alpha}\\right]_{-1}^1 = \\frac{\\exp(\\alpha) - \\exp(-\\alpha)}{\\sqrt{2}\\alpha} = \\frac{2\\sinh(\\alpha)}{\\sqrt{2}\\alpha} = \\frac{\\sqrt{2}\\sinh(\\alpha)}{\\alpha}$.\nSince $\\alpha  0$, $\\sinh(\\alpha)  0$, so $|c_0| = c_0 = \\frac{\\sqrt{2}\\sinh(\\alpha)}{\\alpha}$.\n\nNow, we assemble the expression for $G(\\alpha)$:\n$G(\\alpha) = \\frac{\\|f\\|}{|c_0|} = \\frac{\\sqrt{\\frac{\\sinh(2\\alpha)}{\\alpha}}}{\\frac{\\sqrt{2}\\sinh(\\alpha)}{\\alpha}}$.\nWe simplify this expression:\n$G(\\alpha) = \\frac{\\sqrt{\\sinh(2\\alpha)}}{\\sqrt{\\alpha}} \\cdot \\frac{\\alpha}{\\sqrt{2}\\sinh(\\alpha)} = \\frac{\\sqrt{\\alpha}}{\\sqrt{2}} \\frac{\\sqrt{\\sinh(2\\alpha)}}{\\sinh(\\alpha)}$.\nUsing the double-angle identity for the hyperbolic sine function, $\\sinh(2\\alpha) = 2\\sinh(\\alpha)\\cosh(\\alpha)$:\n$G(\\alpha) = \\frac{\\sqrt{\\alpha}}{\\sqrt{2}} \\frac{\\sqrt{2\\sinh(\\alpha)\\cosh(\\alpha)}}{\\sinh(\\alpha)} = \\frac{\\sqrt{\\alpha}}{\\sqrt{2}} \\frac{\\sqrt{2}\\sqrt{\\sinh(\\alpha)}\\sqrt{\\cosh(\\alpha)}}{\\sinh(\\alpha)}$.\n$G(\\alpha) = \\sqrt{\\alpha} \\frac{\\sqrt{\\sinh(\\alpha)}\\sqrt{\\cosh(\\alpha)}}{(\\sqrt{\\sinh(\\alpha)})^2} = \\sqrt{\\alpha} \\frac{\\sqrt{\\cosh(\\alpha)}}{\\sqrt{\\sinh(\\alpha)}} = \\sqrt{\\alpha \\frac{\\cosh(\\alpha)}{\\sinh(\\alpha)}}$.\nThis simplifies to:\n$G(\\alpha) = \\sqrt{\\alpha \\coth(\\alpha)}$.\nThis is the final closed-form analytic expression for the growth factor.", "answer": "$$\\boxed{\\sqrt{\\alpha \\coth(\\alpha)}}$$", "id": "3404473"}, {"introduction": "In practical implementations, computations are performed on a standard reference element and then mapped to physical elements in a mesh. This exercise explores how this geometric mapping affects the crucial property of orthogonality for different polynomial families. By analyzing the inner product under a change of variables, you will discover why Legendre polynomials are a natural choice for many spectral and DG methods and quantify the impact on the conditioning of the local mass matrix, a key factor in numerical stability [@problem_id:3404484].", "problem": "Let $\\hat{K} = [-1,1]$ be the reference element and let $K = [a,b]$ be a physical element obtained via the affine mapping $\\phi : \\hat{K} \\to K$, $x = \\phi(\\xi) = x_{c} + \\frac{h}{2}\\,\\xi$, where $h = b-a$ and $x_{c} = \\frac{a+b}{2}$. Consider the $L^{2}$ inner product induced on $K$ by the change of variables from $\\hat{K}$, namely\n$$\n(u,v)_{K} = \\int_{K} u(x)\\,v(x)\\,dx = \\frac{h}{2}\\int_{-1}^{1} u(\\phi(\\xi))\\,v(\\phi(\\xi))\\,d\\xi.\n$$\nLet $\\mathbb{P}_{N}(\\hat{K})$ denote polynomials of degree at most $N$ on $\\hat{K}$. Consider three standard polynomial families on $\\hat{K}$:\n- the Legendre polynomials $\\{P_{n}(\\xi)\\}_{n=0}^{N}$ orthogonal with respect to the weight $w_{L}(\\xi) = 1$ on $[-1,1]$,\n- the Chebyshev polynomials of the first kind $\\{T_{n}(\\xi)\\}_{n=0}^{N}$ orthogonal with respect to the weight $w_{C}(\\xi) = (1-\\xi^{2})^{-1/2}$ on $[-1,1]$,\n- the Jacobi polynomials $\\{P_{n}^{(\\alpha,\\beta)}(\\xi)\\}_{n=0}^{N}$ with parameters $\\alpha,\\beta  -1$, orthogonal with respect to the weight $w_{J}(\\xi) = (1-\\xi)^{\\alpha}(1+\\xi)^{\\beta}$ on $[-1,1]$.\n\nDefine the mapped bases on $K$ by composition, for example $\\widehat{P}_{n}(x) := P_{n}(\\phi^{-1}(x))$, and similarly for $\\widehat{T}_{n}$ and $\\widehat{P}_{n}^{(\\alpha,\\beta)}$.\n\nTasks:\n1. Using the definition of $(\\cdot,\\cdot)_{K}$, analyze and compare the orthogonality properties of the mapped Legendre, Chebyshev, and Jacobi families on $K$ under the inner product $(\\cdot,\\cdot)_{K}$. Identify which family remains mutually orthogonal and which do not, and justify the conclusions starting from the change-of-variables principle and the defining weights.\n2. For the Chebyshev and Jacobi families, define their natural weighted inner products on $\\hat{K}$, namely $(u,v)_{w} := \\int_{-1}^{1} u(\\xi)\\,v(\\xi)\\,w(\\xi)\\,d\\xi$ for the corresponding weight $w(\\xi)$. Establish norm-equivalence on the finite-dimensional space $\\mathbb{P}_{N}(\\hat{K})$ between $\\|\\,\\cdot\\,\\|_{L^{2}(\\hat{K})}$ and $\\|\\,\\cdot\\,\\|_{L^{2}(\\hat{K},w)}$, and derive explicit $N$-dependent bounds for optimal constants $C_{\\mathrm{low}}(N)$ and $C_{\\mathrm{high}}(N)$ such that\n$$\nC_{\\mathrm{low}}(N)\\,\\|p\\|_{L^{2}(\\hat{K},w)} \\le \\|p\\|_{L^{2}(\\hat{K})} \\le C_{\\mathrm{high}}(N)\\,\\|p\\|_{L^{2}(\\hat{K},w)} \\quad \\text{for all } p \\in \\mathbb{P}_{N}(\\hat{K}).\n$$\nYour derivation must start from fundamental inequalities for polynomials on $[-1,1]$ and the qualitative behavior of the weights near the endpoints, without assuming or citing ready-made equivalence constants.\n3. In the setting of the Discontinuous Galerkin (DG) method, define the local mass matrix $\\mathbf{M}_{N}$ on $K$ associated with the mapped Legendre basis $\\{\\widehat{P}_{n}\\}_{n=0}^{N}$ and the inner product $(\\cdot,\\cdot)_{K}$. Compute the spectral condition number of $\\mathbf{M}_{N}$ in the matrix $2$-norm, expressed purely as a function of the polynomial degree $N$.\n\nYour final answer must be the closed-form analytic expression for the condition number from Task 3. No rounding is required and no units are involved.", "solution": "### Task 1: Orthogonality of Mapped Bases\n\nThe orthogonality of a mapped basis $\\{\\widehat{\\psi}_n(x)\\}_{n=0}^N$ on the physical element $K$ is determined by evaluating the inner product $(\\widehat{\\psi}_m, \\widehat{\\psi}_n)_K$ for $m \\ne n$. We use the given change of variables formula for the inner product:\n$$\n(\\widehat{\\psi}_m, \\widehat{\\psi}_n)_K = \\frac{h}{2}\\int_{-1}^{1} \\widehat{\\psi}_m(\\phi(\\xi))\\,\\widehat{\\psi}_n(\\phi(\\xi))\\,d\\xi\n$$\nBy definition of the mapped basis, $\\widehat{\\psi}_n(\\phi(\\xi)) = \\psi_n(\\phi^{-1}(\\phi(\\xi))) = \\psi_n(\\xi)$. Substituting this into the integral, we obtain:\n$$\n(\\widehat{\\psi}_m, \\widehat{\\psi}_n)_K = \\frac{h}{2}\\int_{-1}^{1} \\psi_m(\\xi)\\,\\psi_n(\\xi)\\,d\\xi\n$$\nThis demonstrates that the inner product on the physical element $K$ for the mapped basis functions is directly proportional to the standard (unweighted, $w(\\xi)=1$) $L^2$ inner product on the reference element $\\hat{K}$. We now analyze each family based on this result.\n\n1.  **Mapped Legendre Basis $\\{\\widehat{P}_n\\}$**: The Legendre polynomials $\\{P_n(\\xi)\\}$ are defined by their orthogonality with respect to the weight $w_L(\\xi) = 1$ on $\\hat{K}$. Their orthogonality relation is:\n    $$\n    \\int_{-1}^{1} P_m(\\xi)\\,P_n(\\xi)\\,d\\xi = \\frac{2}{2n+1}\\delta_{mn}\n    $$\n    where $\\delta_{mn}$ is the Kronecker delta. Therefore, for the mapped Legendre basis, we have:\n    $$\n    (\\widehat{P}_m, \\widehat{P}_n)_K = \\frac{h}{2} \\left( \\frac{2}{2n+1}\\delta_{mn} \\right) = \\frac{h}{2n+1}\\delta_{mn}\n    $$\n    Since $(\\widehat{P}_m, \\widehat{P}_n)_K = 0$ for $m \\ne n$, the mapped Legendre basis **is orthogonal** on $K$ with respect to the $(\\cdot, \\cdot)_K$ inner product.\n\n2.  **Mapped Chebyshev Basis $\\{\\widehat{T}_n\\}$**: The Chebyshev polynomials $\\{T_n(\\xi)\\}$ are orthogonal with respect to the weight $w_C(\\xi) = (1-\\xi^2)^{-1/2}$. For the mapped basis, we evaluate:\n    $$\n    (\\widehat{T}_m, \\widehat{T}_n)_K = \\frac{h}{2}\\int_{-1}^{1} T_m(\\xi)\\,T_n(\\xi)\\,d\\xi\n    $$\n    This is an unweighted integral. The Chebyshev polynomials are not orthogonal without their weight function. For example, for $m=0$ and $n=2$, $T_0(\\xi)=1$ and $T_2(\\xi)=2\\xi^2-1$.\n    $$\n    \\int_{-1}^{1} T_0(\\xi)\\,T_2(\\xi)\\,d\\xi = \\int_{-1}^{1} (2\\xi^2-1)\\,d\\xi = \\left[ \\frac{2}{3}\\xi^3 - \\xi \\right]_{-1}^{1} = \\left(\\frac{2}{3}-1\\right) - \\left(-\\frac{2}{3}+1\\right) = -\\frac{2}{3} \\ne 0\n    $$\n    Thus, the mapped Chebyshev basis **is not orthogonal** on $K$ with respect to the $(\\cdot, \\cdot)_K$ inner product.\n\n3.  **Mapped Jacobi Basis $\\{\\widehat{P}_n^{(\\alpha, \\beta)}\\}$**: The Jacobi polynomials $\\{P_n^{(\\alpha, \\beta)}(\\xi)\\}$ are orthogonal with respect to the weight $w_J(\\xi) = (1-\\xi)^\\alpha(1+\\xi)^\\beta$. Similar to the Chebyshev case, the inner product for the mapped basis is unweighted:\n    $$\n    (\\widehat{P}_m^{(\\alpha,\\beta)}, \\widehat{P}_n^{(\\alpha,\\beta)})_K = \\frac{h}{2}\\int_{-1}^{1} P_m^{(\\alpha,\\beta)}(\\xi)\\,P_n^{(\\alpha,\\beta)}(\\xi)\\,d\\xi\n    $$\n    Unless $\\alpha=\\beta=0$ (the Legendre case), Jacobi polynomials are not orthogonal with respect to the unity weight function. Therefore, the mapped Jacobi basis **is not orthogonal** on $K$ with respect to the $(\\cdot, \\cdot)_K$ inner product.\n\n**Conclusion for Task 1**: The affine mapping from $\\hat{K}$ to $K$ introduces a constant Jacobian determinant ($h/2$). Consequently, the $L^2(K)$ inner product transforms into a scaled version of the unweighted $L^2(\\hat{K})$ inner product. Only the basis that is originally orthogonal with respect to the unweighted inner product on $\\hat{K}$, namely the Legendre polynomials, remains orthogonal after being mapped to $K$.\n\n### Task 2: Norm Equivalence Bounds\n\nWe seek constants $C_{\\mathrm{low}}(N)$ and $C_{\\mathrm{high}}(N)$ satisfying $C_{\\mathrm{low}}(N)\\,\\|p\\|_{w} \\le \\|p\\|_{L^{2}} \\le C_{\\mathrm{high}}(N)\\,\\|p\\|_{w}$ for all $p \\in \\mathbb{P}_{N}(\\hat{K})$. This is equivalent to finding bounds on the Rayleigh quotient $R(p) = \\frac{\\|p\\|_{L^{2}}^2}{\\|p\\|_{w}^2} = \\frac{\\int_{-1}^1 p(\\xi)^2 d\\xi}{\\int_{-1}^1 p(\\xi)^2 w(\\xi) d\\xi}$.\nThe optimal constants are $C_{\\mathrm{high}}(N)^2 = \\sup_{p \\in \\mathbb{P}_N} R(p)$ and $C_{\\mathrm{low}}(N)^2 = \\inf_{p \\in \\mathbb{P}_N} R(p)$.\n\nThe derivation relies on the qualitative behavior of the weight function $w(\\xi)$ and the property that a polynomial $p \\in \\mathbb{P}_N$ cannot be arbitrarily localized; its features have a characteristic scale. A polynomial that is large in a region of size $\\Delta\\xi$ near a point $\\xi_0$ must satisfy $\\Delta\\xi \\gtrsim 1/N$ in the interior of $[-1,1]$ and $\\Delta\\xi \\gtrsim 1/N^2$ near the endpoints $\\xi = \\pm 1$.\n\n**Chebyshev Case**: $w_C(\\xi)=(1-\\xi^2)^{-1/2}$.\n\n-   **Upper Bound $C_{\\mathrm{high}}(N)$**: We want to maximize $R(p)$. We can write $\\|p\\|_{L^2}^2 = \\int_{-1}^1 p(\\xi)^2 \\frac{1}{w_C(\\xi)} w_C(\\xi) d\\xi$. The term $1/w_C(\\xi) = \\sqrt{1-\\xi^2}$ is bounded above by $1$ on $[-1,1]$.\n    $$\n    \\|p\\|_{L^2}^2 \\le \\left(\\sup_{\\xi \\in [-1,1]} \\frac{1}{w_C(\\xi)}\\right) \\int_{-1}^1 p(\\xi)^2 w_C(\\xi) d\\xi = 1 \\cdot \\|p\\|_{w_C}^2\n    $$\n    This implies $\\|p\\|_{L^2} \\le \\|p\\|_{w_C}$, so $C_{\\mathrm{high}}(N) \\le 1$. We can choose a polynomial that is concentrated where $1/w_C(\\xi)$ is maximal (i.e., at $\\xi=0$), for instance $p(\\xi)=(1-\\xi^2)^{\\lfloor N/2 \\rfloor}$. This demonstrates that the bound of $1$ is sharp and independent of $N$. So, $C_{\\mathrm{high}}(N)=1$.\n\n-   **Lower Bound $C_{\\mathrm{low}}(N)$**: We want to minimize $R(p)$, which means choosing a polynomial $p$ that is concentrated where $w_C(\\xi)$ is large, i.e., near the endpoints $\\xi=\\pm 1$. Let's consider a polynomial $p \\in \\mathbb{P}_N$ that is maximally concentrated near $\\xi=1$. Such a polynomial must have a peak of width at least $\\Delta\\xi \\sim 1/N^2$. Let's assume $p(\\xi)$ is approximately constant in the interval $[1-c/N^2, 1]$ for some constant $c$.\n    $$\n    \\int_{1-c/N^2}^1 p(\\xi)^2 d\\xi \\approx p(1)^2 \\int_{1-c/N^2}^1 d\\xi \\sim p(1)^2 N^{-2}\n    $$\n    $$\n    \\int_{1-c/N^2}^1 p(\\xi)^2 w_C(\\xi) d\\xi \\approx p(1)^2 \\int_{1-c/N^2}^1 (1-\\xi^2)^{-1/2} d\\xi \\approx p(1)^2 \\int_{1-c/N^2}^1 (\\sqrt{2}\\sqrt{1-\\xi})^{-1} d\\xi \\sim p(1)^2 N^{-1}\n    $$\n    The ratio $R(p)$ for such a polynomial scales as $N^{-2}/N^{-1} = N^{-1}$. Thus, $C_{\\mathrm{low}}(N)^2 \\sim N^{-1}$, which implies $C_{\\mathrm{low}}(N) \\sim N^{-1/2}$.\n\n**Jacobi Case**: $w_J(\\xi)=(1-\\xi)^{\\alpha}(1+\\xi)^{\\beta}$ for $\\alpha, \\beta  -1$.\n\n-   **Upper Bound $C_{\\mathrm{high}}(N)$**: We analyze $1/w_J = (1-\\xi)^{-\\alpha}(1+\\xi)^{-\\beta}$.\n    -   If $\\alpha, \\beta \\le 0$, $1/w_J$ is bounded on $[-1,1]$. Then $C_{\\mathrm{high}}(N)$ is a constant independent of $N$.\n    -   If $\\alpha  0$ (or $\\beta  0$), $1/w_J$ is unbounded at $\\xi=1$ (or $\\xi=-1$). Let's assume $\\alpha0$ and consider a polynomial $p \\in \\mathbb{P}_N$ concentrated near $\\xi=1$.\n        $$\n        \\int_{1-c/N^2}^1 p(\\xi)^2 d\\xi \\sim p(1)^2 N^{-2}\n        $$\n        $$\n        \\int_{1-c/N^2}^1 p(\\xi)^2 w_J(\\xi) d\\xi \\approx p(1)^2 \\int_{1-c/N^2}^1 (1-\\xi)^\\alpha d\\xi \\sim p(1)^2 (N^{-2})^{\\alpha+1} = p(1)^2 N^{-2\\alpha-2}\n        $$\n        The ratio $R(p)$ scales as $N^{-2} / N^{-2\\alpha-2} = N^{2\\alpha}$. This suggests $C_{\\mathrm{high}}(N)^2 \\sim N^{2\\alpha}$. Considering both ends, we get $C_{\\mathrm{high}}(N) \\sim N^{\\max(\\alpha,\\beta,0)}$.\n\n-   **Lower Bound $C_{\\mathrm{low}}(N)$**: We need to concentrate the polynomial where $w_J$ is large.\n    -   If $\\alpha, \\beta \\ge 0$, $w_J$ is bounded. $C_{\\mathrm{low}}(N)$ is a constant independent of $N$.\n    -   If $\\alpha  0$ (or $\\beta  0$), $w_J$ is unbounded at $\\xi=1$ (or $\\xi=-1$). Let's assume $\\alpha0$ and consider a polynomial $p \\in \\mathbb{P}_N$ concentrated near $\\xi=1$. The same estimates as above for the integrals hold.\n        The ratio $R(p)$ scales as $N^{2\\alpha}$. Since $\\alpha0$, this gives a decay with $N$. This suggests $C_{\\mathrm{low}}(N)^2 \\sim N^{2\\alpha}$. Considering both ends, we get $C_{\\mathrm{low}}(N) \\sim N^{\\min(\\alpha,\\beta,0)}$.\n\n### Task 3: Condition Number of Legendre Mass Matrix\n\nThe final task is to compute the spectral condition number of the local mass matrix $\\mathbf{M}_N$ on the element $K$. The basis is the mapped Legendre basis $\\{\\widehat{P}_n(x)\\}_{n=0}^N$. The entries of the mass matrix are given by $(\\mathbf{M}_N)_{mn} = (\\widehat{P}_m, \\widehat{P}_n)_K$.\n\nFrom the analysis in Task 1, we established that this basis is orthogonal and the matrix entries are:\n$$\n(\\mathbf{M}_N)_{mn} = \\frac{h}{2n+1}\\delta_{mn}\n$$\nThis means that the mass matrix $\\mathbf{M}_N$ is an $(N+1) \\times (N+1)$ diagonal matrix:\n$$\n\\mathbf{M}_N = \\begin{pmatrix}\nh  0  \\cdots  0 \\\\\n0  h/3  \\cdots  0 \\\\\n\\vdots  \\vdots  \\ddots  \\vdots \\\\\n0  0  \\cdots  h/(2N+1)\n\\end{pmatrix}\n$$\nThe eigenvalues of a diagonal matrix are its diagonal entries. Let the eigenvalues be $\\lambda_n$ for $n=0, 1, \\ldots, N$:\n$$\n\\lambda_n = \\frac{h}{2n+1}\n$$\nThe spectral condition number in the $2$-norm, $\\kappa_2(\\mathbf{M}_N)$, is the ratio of the largest to the smallest eigenvalue.\nThe largest eigenvalue, $\\lambda_{\\max}$, corresponds to the smallest denominator ($n=0$):\n$$\n\\lambda_{\\max} = \\lambda_0 = \\frac{h}{2(0)+1} = h\n$$\nThe smallest eigenvalue, $\\lambda_{\\min}$, corresponds to the largest denominator ($n=N$):\n$$\n\\lambda_{\\min} = \\lambda_N = \\frac{h}{2N+1}\n$$\nThe condition number is therefore:\n$$\n\\kappa_2(\\mathbf{M}_N) = \\frac{\\lambda_{\\max}}{\\lambda_{\\min}} = \\frac{h}{\\frac{h}{2N+1}} = 2N+1\n$$\nThe result is a function of the polynomial degree $N$ only, as requested.", "answer": "$$\\boxed{2N+1}$$", "id": "3404484"}]}