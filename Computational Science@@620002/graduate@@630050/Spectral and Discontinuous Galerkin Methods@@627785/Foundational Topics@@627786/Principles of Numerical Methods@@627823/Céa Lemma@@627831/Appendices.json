{"hands_on_practices": [{"introduction": "The power of Céa's lemma lies in its guarantee of quasi-optimality, but for symmetric problems, it promises something even stronger: the Galerkin solution is the unique best approximation in the energy norm. This practice [@problem_id:3368495] provides a concrete, computational demonstration of this core principle. By explicitly calculating and comparing the energy norm error for both the Galerkin ($a$-orthogonal) projection and the standard $L^2$ projection, you will see firsthand why the Galerkin method is the natural choice for minimizing error in the norm induced by the problem itself.", "problem": "Consider the interval domain $\\Omega=(0,1)$ and the Sobolev space $V=H_{0}^{1}(\\Omega)$ endowed with the bilinear form $a(u,v)=\\int_{0}^{1} u'(x)\\,v'(x)\\,\\mathrm{d}x$, which induces the $H^{1}$ seminorm $\\|w\\|_{1}^{2}=a(w,w)=\\int_{0}^{1}|w'(x)|^{2}\\,\\mathrm{d}x$. Let the finite-dimensional trial subspace be $V_{h}=\\operatorname{span}\\{\\varphi\\}$ with the single spectral basis function $\\varphi(x)=x(1-x)$. Define the exact target function as $u(x)=\\varphi(x)+\\chi(x)$, where $\\chi(x)=x^{3}-x^{4}\\in H_{0}^{1}(\\Omega)$. The $L^{2}$ projection $P_{L^{2}}u\\in V_{h}$ is the unique element $c_{L^{2}}\\varphi$ such that $\\int_{0}^{1}(u-c_{L^{2}}\\varphi)\\,\\varphi\\,\\mathrm{d}x=0$. The $a$-orthogonal projection $P_{a}u\\in V_{h}$ is the unique element $c_{a}\\varphi$ such that $a(u-c_{a}\\varphi,\\varphi)=0$.\n\nStarting from the core definitions of projection in Hilbert spaces and the properties of the bilinear form $a(\\cdot,\\cdot)$ (continuity and coercivity on $H_{0}^{1}(\\Omega)$), perform the following:\n\n1. Compute the coefficients $c_{L^{2}}$ and $c_{a}$ explicitly in terms of the integrals of $\\varphi$, $\\chi$, and their derivatives.\n2. Using these coefficients, compute the squared $H^{1}$ seminorm errors $\\|u-P_{L^{2}}u\\|_{1}^{2}$ and $\\|u-P_{a}u\\|_{1}^{2}$.\n3. Form the exact ratio $R=\\dfrac{\\|u-P_{L^{2}}u\\|_{1}}{\\|u-P_{a}u\\|_{1}}$ and express it in closed form. No rounding is required.\n4. Justify, using only core definitions (continuity and coercivity of $a$ on $H_{0}^{1}(\\Omega)$), why the $a$-orthogonal projection $P_{a}u$ yields the quasi-optimal error bound in the $H^{1}$ seminorm, and identify the continuity and coercivity constants for $a(\\cdot,\\cdot)$ with respect to $\\|\\cdot\\|_{1}$.\n\nProvide the final value of $R$ as the answer.", "solution": "The problem requires us to compare the error of two different projections, the $L^2$ projection and the $a$-orthogonal (or Galerkin) projection, of a function $u(x)$ onto a one-dimensional subspace $V_h$. We are asked to compute the ratio of the errors in the $H^1$ seminorm and to provide a theoretical justification for the optimality of the $a$-orthogonal projection.\n\nThe domain is $\\Omega=(0,1)$ and the function space is $V=H_{0}^{1}(\\Omega)$.\nThe bilinear form is $a(u,v)=\\int_{0}^{1} u'(x)\\,v'(x)\\,\\mathrm{d}x$. The associated seminorm is $\\|w\\|_{1} = \\sqrt{a(w,w)}$. By the Poincaré inequality, this is a norm on $H_{0}^{1}(\\Omega)$.\nThe finite-dimensional subspace is $V_{h}=\\operatorname{span}\\{\\varphi\\}$, where the basis function is $\\varphi(x)=x(1-x)=x-x^{2}$.\nThe target function is $u(x)=\\varphi(x)+\\chi(x)$, with $\\chi(x)=x^{3}-x^{4}$.\nBoth $\\varphi(x)$ and $\\chi(x)$ are in $H_{0}^{1}(\\Omega)$ since they are polynomials that vanish at $x=0$ and $x=1$.\n\nWe will first compute the necessary integrals involving $\\varphi$, $\\chi$, and their derivatives.\nThe derivatives are $\\varphi'(x) = 1-2x$ and $\\chi'(x) = 3x^{2}-4x^{3}$.\n\nIntegrals for the $L^2$ projection:\nThe squared $L^2$ norm of $\\varphi$ is:\n$$(\\varphi, \\varphi)_{L^2} = \\int_{0}^{1} \\varphi(x)^{2}\\,\\mathrm{d}x = \\int_{0}^{1} (x-x^{2})^{2}\\,\\mathrm{d}x = \\int_{0}^{1} (x^{2}-2x^{3}+x^{4})\\,\\mathrm{d}x = \\left[\\frac{x^{3}}{3}-\\frac{2x^{4}}{4}+\\frac{x^{5}}{5}\\right]_{0}^{1} = \\frac{1}{3}-\\frac{1}{2}+\\frac{1}{5} = \\frac{10-15+6}{30} = \\frac{1}{30}$$\nThe $L^2$ inner product of $\\chi$ and $\\varphi$ is:\n$$(\\chi, \\varphi)_{L^2} = \\int_{0}^{1} \\chi(x)\\varphi(x)\\,\\mathrm{d}x = \\int_{0}^{1} (x^{3}-x^{4})(x-x^{2})\\,\\mathrm{d}x = \\int_{0}^{1} (x^{4}-2x^{5}+x^{6})\\,\\mathrm{d}x = \\left[\\frac{x^{5}}{5}-\\frac{2x^{6}}{6}+\\frac{x^{7}}{7}\\right]_{0}^{1} = \\frac{1}{5}-\\frac{1}{3}+\\frac{1}{7} = \\frac{21-35+15}{105} = \\frac{1}{105}$$\n\nIntegrals for the $H^1$ seminorm and $a$-orthogonal projection:\nThe bilinear form evaluated for $\\varphi$ with itself is:\n$$a(\\varphi, \\varphi) = \\int_{0}^{1} (\\varphi'(x))^{2}\\,\\mathrm{d}x = \\int_{0}^{1} (1-2x)^{2}\\,\\mathrm{d}x = \\int_{0}^{1} (1-4x+4x^{2})\\,\\mathrm{d}x = \\left[x-2x^{2}+\\frac{4x^{3}}{3}\\right]_{0}^{1} = 1-2+\\frac{4}{3} = \\frac{1}{3}$$\nThe bilinear form evaluated for $\\chi$ and $\\varphi$ is:\n$$a(\\chi, \\varphi) = \\int_{0}^{1} \\chi'(x)\\varphi'(x)\\,\\mathrm{d}x = \\int_{0}^{1} (3x^{2}-4x^{3})(1-2x)\\,\\mathrm{d}x = \\int_{0}^{1} (3x^{2}-10x^{3}+8x^{4})\\,\\mathrm{d}x = \\left[x^{3}-\\frac{10x^{4}}{4}+\\frac{8x^{5}}{5}\\right]_{0}^{1} = 1-\\frac{5}{2}+\\frac{8}{5} = \\frac{10-25+16}{10} = \\frac{1}{10}$$\nThe squared $H^1$ seminorm of $\\chi$ is:\n$$a(\\chi, \\chi) = \\|\\chi\\|_{1}^{2} = \\int_{0}^{1} (\\chi'(x))^{2}\\,\\mathrm{d}x = \\int_{0}^{1} (3x^{2}-4x^{3})^{2}\\,\\mathrm{d}x = \\int_{0}^{1} (9x^{4}-24x^{5}+16x^{6})\\,\\mathrm{d}x = \\left[\\frac{9x^{5}}{5}-\\frac{24x^{6}}{6}+\\frac{16x^{7}}{7}\\right]_{0}^{1} = \\frac{9}{5}-4+\\frac{16}{7} = \\frac{63-140+80}{35} = \\frac{3}{35}$$\n\n**1. Computation of coefficients $c_{L^{2}}$ and $c_{a}$**\n\nThe $L^{2}$ projection $P_{L^{2}}u = c_{L^{2}}\\varphi$ is defined by $\\int_{0}^{1}(u-c_{L^{2}}\\varphi)\\varphi\\,\\mathrm{d}x=0$.\nThis gives $c_{L^{2}} = \\dfrac{\\int_{0}^{1} u\\varphi\\,\\mathrm{d}x}{\\int_{0}^{1} \\varphi^{2}\\,\\mathrm{d}x} = \\dfrac{(\\varphi+\\chi, \\varphi)_{L^2}}{(\\varphi, \\varphi)_{L^2}} = \\dfrac{(\\varphi, \\varphi)_{L^2} + (\\chi, \\varphi)_{L^2}}{(\\varphi, \\varphi)_{L^2}} = 1 + \\dfrac{(\\chi, \\varphi)_{L^2}}{(\\varphi, \\varphi)_{L^2}}$.\nUsing the computed integrals:\n$$c_{L^{2}} = 1 + \\frac{1/105}{1/30} = 1 + \\frac{30}{105} = 1 + \\frac{2}{7} = \\frac{9}{7}$$\n\nThe $a$-orthogonal projection $P_{a}u = c_{a}\\varphi$ is defined by $a(u-c_{a}\\varphi, \\varphi)=0$.\nThis gives $c_{a} = \\dfrac{a(u,\\varphi)}{a(\\varphi,\\varphi)} = \\dfrac{a(\\varphi+\\chi, \\varphi)}{a(\\varphi,\\varphi)} = \\dfrac{a(\\varphi,\\varphi) + a(\\chi,\\varphi)}{a(\\varphi,\\varphi)} = 1 + \\dfrac{a(\\chi,\\varphi)}{a(\\varphi,\\varphi)}$.\nUsing the computed values for the bilinear form:\n$$c_{a} = 1 + \\frac{1/10}{1/3} = 1 + \\frac{3}{10} = \\frac{13}{10}$$\n\n**2. Computation of squared $H^{1}$ seminorm errors**\n\nThe error for the $L^2$ projection is $u-P_{L^2}u = u-c_{L^2}\\varphi = (\\varphi+\\chi)-c_{L^2}\\varphi = (1-c_{L^2})\\varphi + \\chi$.\nThe squared $H^1$ seminorm of this error is:\n$$\\|u-P_{L^{2}}u\\|_{1}^{2} = a((1-c_{L^{2}})\\varphi + \\chi, (1-c_{L^{2}})\\varphi + \\chi) = (1-c_{L^{2}})^{2} a(\\varphi,\\varphi) + 2(1-c_{L^{2}}) a(\\chi, \\varphi) + a(\\chi,\\chi)$$\nSubstituting the values $1-c_{L^2} = 1-9/7 = -2/7$ and the integral values:\n$$\\|u-P_{L^{2}}u\\|_{1}^{2} = \\left(-\\frac{2}{7}\\right)^{2} \\left(\\frac{1}{3}\\right) + 2\\left(-\\frac{2}{7}\\right) \\left(\\frac{1}{10}\\right) + \\frac{3}{35} = \\frac{4}{49}\\cdot\\frac{1}{3} - \\frac{4}{70} + \\frac{3}{35} = \\frac{4}{147} - \\frac{2}{35} + \\frac{3}{35} = \\frac{4}{147} + \\frac{1}{35}$$\nThe common denominator is $735$:\n$$\\|u-P_{L^{2}}u\\|_{1}^{2} = \\frac{4 \\cdot 5}{735} + \\frac{1 \\cdot 21}{735} = \\frac{20+21}{735} = \\frac{41}{735}$$\n\nFor the $a$-orthogonal projection, the error is $u-P_{a}u = u-c_a\\varphi = (1-c_a)\\varphi+\\chi$.\nSince $\\varphi \\in V_h$, its projection is itself, $P_a\\varphi=\\varphi$. Thus, $u-P_a u = (\\varphi+\\chi)-P_a(\\varphi+\\chi) = (\\varphi-P_a\\varphi) + (\\chi-P_a\\chi) = \\chi-P_a\\chi$.\nThe error $u-P_a u$ is $a$-orthogonal to the space $V_h$. This is the property of best approximation in the energy norm.\n$$\\|u-P_{a}u\\|_{1}^{2} = \\|\\chi - P_a\\chi\\|_1^2 = a(\\chi,\\chi) - \\|P_a\\chi\\|_1^2 = a(\\chi,\\chi) - \\frac{a(\\chi,\\varphi)^2}{a(\\varphi,\\varphi)}$$\nUsing the computed values:\n$$\\|u-P_{a}u\\|_{1}^{2} = \\frac{3}{35} - \\frac{(1/10)^{2}}{1/3} = \\frac{3}{35} - \\frac{1/100}{1/3} = \\frac{3}{35} - \\frac{3}{100} = \\frac{300-105}{3500} = \\frac{195}{3500} = \\frac{39}{700}$$\n\n**3. Computation of the ratio $R$**\n\nThe ratio $R$ is given by:\n$$R = \\frac{\\|u-P_{L^{2}}u\\|_{1}}{\\|u-P_{a}u\\|_{1}} = \\sqrt{\\frac{\\|u-P_{L^{2}}u\\|_{1}^{2}}{\\|u-P_{a}u\\|_{1}^{2}}}$$\nSubstituting the calculated error values:\n$$R^{2} = \\frac{41/735}{39/700} = \\frac{41}{735} \\times \\frac{700}{39} = \\frac{41 \\times (7 \\times 100)}{ (3 \\times 5 \\times 7^2) \\times 39} = \\frac{41 \\times 100}{3 \\times 5 \\times 7 \\times 39} = \\frac{41 \\times (20 \\times 5)}{(105) \\times 39} = \\frac{41 \\times 20}{21 \\times 39} = \\frac{820}{819}$$\nTherefore, the exact ratio is:\n$$R = \\sqrt{\\frac{820}{819}}$$\n\n**4. Justification of Quasi-Optimality**\n\nThe justification for the quasi-optimal error bound of the $a$-orthogonal projection $P_a u$ is provided by Céa's Lemma. This lemma relies on the continuity and coercivity of the bilinear form $a(\\cdot,\\cdot)$ on the Hilbert space $V=H_0^1(\\Omega)$.\n\nThe norm used is $\\|v\\|_1 = \\sqrt{a(v,v)}$.\nContinuity requires finding a constant $M>0$ such that $|a(u,v)| \\le M \\|u\\|_{1} \\|v\\|_{1}$ for all $u, v \\in V$. By the Cauchy-Schwarz inequality on the space of square-integrable functions $L^2(0,1)$, we have:\n$$|a(u,v)| = \\left|\\int_{0}^{1} u'(x)v'(x)\\,\\mathrm{d}x\\right| \\le \\left(\\int_{0}^{1} (u'(x))^2\\,\\mathrm{d}x\\right)^{1/2} \\left(\\int_{0}^{1} (v'(x))^2\\,\\mathrm{d}x\\right)^{1/2} = \\|u\\|_{1} \\|v\\|_{1}$$\nThis holds with a continuity constant $M=1$.\n\nCoercivity requires finding a constant $\\alpha>0$ such that $a(v,v) \\ge \\alpha \\|v\\|_{1}^{2}$ for all $v \\in V$. By definition of the norm $\\|\\cdot\\|_1$:\n$$a(v,v) = \\int_{0}^{1} (v'(x))^2\\,\\mathrm{d}x = \\|v\\|_{1}^{2}$$\nThis holds with a coercivity constant $\\alpha=1$.\n\nCéa's Lemma states that for $u_h = P_a u$, the following inequality holds for any $v_h \\in V_h$:\n$\\|u-u_h\\|_{1} \\le \\frac{M}{\\alpha} \\|u-v_h\\|_{1}$.\nThe proof is as follows:\nBy coercivity, $\\alpha\\|u-u_h\\|_1^2 \\le a(u-u_h, u-u_h)$.\nBy Galerkin orthogonality, $a(u-u_h, z_h) = 0$ for any $z_h \\in V_h$. Let $z_h = u_h - v_h \\in V_h$.\nThen $a(u-u_h, u-u_h) = a(u-u_h, u-v_h + v_h-u_h) = a(u-u_h, u-v_h) + a(u-u_h, v_h-u_h) = a(u-u_h, u-v_h)$.\nUsing continuity, $a(u-u_h, u-v_h) \\le M\\|u-u_h\\|_1 \\|u-v_h\\|_1$.\nCombining these gives $\\alpha\\|u-u_h\\|_1^2 \\le M\\|u-u_h\\|_1 \\|u-v_h\\|_1$.\nDividing by $\\|u-u_h\\|_1$ (for $u \\ne u_h$), we get $\\|u-u_h\\|_1 \\le \\frac{M}{\\alpha}\\|u-v_h\\|_1$.\nSince this is true for any $v_h \\in V_h$, we have:\n$$\\|u-P_a u\\|_1 \\le \\frac{M}{\\alpha} \\inf_{v_h \\in V_h} \\|u-v_h\\|_1$$\nWith $M=1$ and $\\alpha=1$, we get $\\|u-P_a u\\|_1 \\le \\inf_{v_h \\in V_h} \\|u-v_h\\|_1$. Since $P_a u \\in V_h$, the reverse inequality is trivial, leading to equality:\n$$\\|u-P_a u\\|_1 = \\inf_{v_h \\in V_h} \\|u-v_h\\|_1$$\nThis shows that the $a$-orthogonal projection provides the best approximation in the energy norm $\\|\\cdot\\|_1$. It is not just quasi-optimal; it is optimal. The quasi-optimality constant is $C = M/\\alpha = 1$. This explains why $P_a u$ is the benchmark against which other approximations are compared in the energy norm. Our calculation confirms this, as $R > 1$, meaning $\\|u-P_{L^{2}}u\\|_{1} > \\|u-P_{a}u\\|_{1}$.", "answer": "$$\\boxed{\\sqrt{\\frac{820}{819}}}$$", "id": "3368495"}, {"introduction": "While Céa's lemma provides a powerful theoretical bound, its practical utility hinges on the magnitude of the stability constant $C = M/\\alpha$. This constant is not universal; it depends on both the bilinear form and the norm chosen for the analysis. This exercise [@problem_id:2539773] delves into this critical subtlety by examining a singularly perturbed reaction-diffusion problem. You will discover how a seemingly natural choice of norm can lead to a stability constant that degrades as the perturbation parameter $\\epsilon \\to 0$, making the error estimate unreliable and highlighting the importance of parameter-robust norms in analysis.", "problem": "Consider the one-dimensional reaction–diffusion model on the open interval $(0,1)$ with homogeneous Dirichlet boundary conditions, where $0<\\epsilon \\ll 1$:\n$$\n\\epsilon\\,u''-u=f \\quad \\text{in }(0,1), \\qquad u(0)=u(1)=0.\n$$\nAdopt the coercive variational formulation obtained by multiplying the equation by $-1$ and integrating by parts, so that the bilinear form and linear functional are\n$$\na(u,v)=\\epsilon\\int_{0}^{1}u'(x)\\,v'(x)\\,dx+\\int_{0}^{1}u(x)\\,v(x)\\,dx, \\qquad \\ell(v)=-\\int_{0}^{1}f(x)\\,v(x)\\,dx,\n$$\nfor all $u,v\\in H_{0}^{1}(0,1)$. Work with the norm $\\|v\\|_{H_{0}^{1}(0,1)}:=\\|v'\\|_{L^{2}(0,1)}$. Using only core definitions (continuity and coercivity of bilinear forms) and well-tested facts (the sharp Poincaré inequality on $(0,1)$), perform the following:\n\n1. Determine the smallest coercivity constant $\\alpha>0$ and a valid continuity constant $M>0$ such that\n$$\na(v,v)\\ge \\alpha\\,\\|v\\|_{H_{0}^{1}(0,1)}^{2}\\quad \\text{for all } v\\in H_{0}^{1}(0,1), \n$$\nand\n$$\n|a(w,v)|\\le M\\,\\|w\\|_{H_{0}^{1}(0,1)}\\,\\|v\\|_{H_{0}^{1}(0,1)}\\quad \\text{for all } w,v\\in H_{0}^{1}(0,1).\n$$\n\n2. Then, express the ratio $M/\\alpha$ in closed form in terms of $\\epsilon$ only, using the optimal constant in the Poincaré inequality on $(0,1)$.\n\nFinally, briefly state how the scaling of $M/\\alpha$ as $\\epsilon\\to 0$ affects the pre-asymptotic reliability of the a priori error estimate provided by Céa’s lemma in the Finite Element Method (FEM).\n\nImportant: Express your final answer for $M/\\alpha$ as a single closed-form analytic expression in terms of $\\epsilon$, with no numerical approximation or rounding.", "solution": "The problem as stated is mathematically and scientifically sound, self-contained, and well-posed. It is a standard exercise in the a priori analysis of the Finite Element Method for a singularly perturbed problem. We proceed with the solution.\n\nThe task is to find the coercivity constant $\\alpha$ and a continuity constant $M$ for the bilinear form\n$$ a(u,v)=\\epsilon\\int_{0}^{1}u'(x)\\,v'(x)\\,dx+\\int_{0}^{1}u(x)\\,v(x)\\,dx $$\nwith respect to the norm $\\|v\\|_{H_{0}^{1}(0,1)}:=\\|v'\\|_{L^{2}(0,1)}$.\n\nFirst, we determine the smallest coercivity constant $\\alpha$. The coercivity condition is $a(v,v) \\ge \\alpha \\|v\\|_{H_{0}^{1}(0,1)}^{2}$ for all $v \\in H_0^1(0,1)$. Substituting the definitions of the bilinear form and the norm, we have:\n$$ \\epsilon\\int_{0}^{1}(v'(x))^{2}\\,dx+\\int_{0}^{1}(v(x))^{2}\\,dx \\ge \\alpha \\int_{0}^{1}(v'(x))^{2}\\,dx. $$\nUsing the notation of $L^2$-norms, $\\|v'\\|_{L^2(0,1)}^2 = \\int_0^1 (v'(x))^2 dx$ and $\\|v\\|_{L^2(0,1)}^2 = \\int_0^1 (v(x))^2 dx$, the inequality becomes:\n$$ \\epsilon \\|v'\\|_{L^2(0,1)}^{2} + \\|v\\|_{L^2(0,1)}^{2} \\ge \\alpha \\|v'\\|_{L^2(0,1)}^{2}. $$\nTo find the smallest possible value for $\\alpha$, we compute the infimum of the Rayleigh quotient:\n$$ \\alpha = \\inf_{v \\in H_0^1(0,1), v \\neq 0} \\frac{a(v,v)}{\\|v'\\|_{L^2(0,1)}^2} = \\inf_{v \\neq 0} \\frac{\\epsilon \\|v'\\|_{L^2(0,1)}^{2} + \\|v\\|_{L^2(0,1)}^{2}}{\\|v'\\|_{L^2(0,1)}^2} = \\epsilon + \\inf_{v \\neq 0} \\frac{\\|v\\|_{L^2(0,1)}^2}{\\|v'\\|_{L^2(0,1)}^2}. $$\nThe term $\\inf_{v \\neq 0} \\frac{\\|v\\|_{L^2(0,1)}^2}{\\|v'\\|_{L^2(0,1)}^2}$ can be made arbitrarily close to zero. To demonstrate this, consider the sequence of functions $v_n(x) = \\sin(n\\pi x)$ for $n \\in \\{1, 2, 3, \\dots\\}$, which belong to $H_0^1(0,1)$. The squared $L^2$-norm of $v_n$ is $\\|v_n\\|_{L^2(0,1)}^2 = \\int_0^1 \\sin^2(n\\pi x)dx = \\frac{1}{2}$, and the squared $L^2$-norm of its derivative is $\\|v_n'\\|_{L^2(0,1)}^2 = \\int_0^1 (n\\pi)^2 \\cos^2(n\\pi x)dx = \\frac{(n\\pi)^2}{2}$. The ratio is $\\frac{\\|v_n\\|_{L^2(0,1)}^2}{\\|v_n'\\|_{L^2(0,1)}^2} = \\frac{1}{(n\\pi)^2}$, which tends to $0$ as $n \\to \\infty$. Thus, the infimum is $0$.\nTherefore, the smallest (optimal) coercivity constant is $\\alpha = \\epsilon$.\n\nNext, we determine a valid continuity constant $M$. The continuity condition is $|a(w,v)| \\le M \\|w\\|_{H_{0}^{1}(0,1)} \\|v\\|_{H_{0}^{1}(0,1)}$ for all $w, v \\in H_0^1(0,1)$. Using the specified norm, this is:\n$$ |a(w,v)| \\le M \\|w'\\|_{L^2(0,1)} \\|v'\\|_{L^2(0,1)}. $$\nApplying the triangle inequality and the Cauchy-Schwarz inequality to the bilinear form:\n$$ |a(w,v)| = \\left|\\epsilon\\int_{0}^{1}w'v'\\,dx+\\int_{0}^{1}wv\\,dx\\right| \\le \\epsilon \\left|\\int_{0}^{1}w'v'\\,dx\\right| + \\left|\\int_{0}^{1}wv\\,dx\\right| \\le \\epsilon \\|w'\\|_{L^2} \\|v'\\|_{L^2} + \\|w\\|_{L^2} \\|v\\|_{L^2}. $$\nTo obtain a bound in terms of $\\|w'\\|_{L^2}$ and $\\|v'\\|_{L^2}$ only, we use the sharp Poincaré inequality on $(0,1)$, which states that for any $v \\in H_0^1(0,1)$, $\\|v\\|_{L^2} \\le C_P \\|v'\\|_{L^2}$. The sharp constant $C_P$ is given by $1/\\sqrt{\\lambda_1}$, where $\\lambda_1$ is the smallest eigenvalue of the operator $-d^2/dx^2$ with homogeneous Dirichlet boundary conditions. The eigenvalues are $\\lambda_n = (n\\pi)^2$ for $n=1,2,\\dots$, so $\\lambda_1 = \\pi^2$. Thus, the sharp inequality is $\\|v\\|_{L^2} \\le \\frac{1}{\\pi}\\|v'\\|_{L^2}$.\nSubstituting this into our bound for $|a(w,v)|$:\n$$ |a(w,v)| \\le \\epsilon \\|w'\\|_{L^2} \\|v'\\|_{L^2} + \\left(\\frac{1}{\\pi}\\|w'\\|_{L^2}\\right) \\left(\\frac{1}{\\pi}\\|v'\\|_{L^2}\\right) = \\left(\\epsilon + \\frac{1}{\\pi^2}\\right) \\|w'\\|_{L^2} \\|v'\\|_{L^2}. $$\nThis demonstrates that $M = \\epsilon + \\frac{1}{\\pi^2}$ is a valid continuity constant. To verify it is the smallest possible, we must check if the supremum is attained. The supremum is\n$$ M = \\sup_{w,v \\neq 0} \\frac{|a(w,v)|}{\\|w'\\|_{L^2}\\|v'\\|_{L^2}} \\ge \\sup_{v \\neq 0} \\frac{a(v,v)}{\\|v'\\|_{L^2}^2} = \\sup_{v \\neq 0} \\left(\\epsilon + \\frac{\\|v\\|_{L^2}^2}{\\|v'\\|_{L^2}^2}\\right) = \\epsilon + \\sup_{v \\neq 0} \\frac{\\|v\\|_{L^2}^2}{\\|v'\\|_{L^2}^2}. $$\nThe supremum of the ratio $\\frac{\\|v\\|_{L^2}^2}{\\|v'\\|_{L^2}^2}$ is the reciprocal of the smallest eigenvalue $\\lambda_1=\\pi^2$, which is $1/\\pi^2$. This supremum is attained by the first eigenfunction $v_1(x) = \\sin(\\pi x)$. Hence, the optimal continuity constant is $M = \\epsilon + \\frac{1}{\\pi^2}$.\n\nThe ratio $M/\\alpha$ is then:\n$$ \\frac{M}{\\alpha} = \\frac{\\epsilon + \\frac{1}{\\pi^2}}{\\epsilon} = 1 + \\frac{1}{\\epsilon \\pi^2}. $$\n\nFinally, we analyze the effect of this ratio on Céa's lemma. The lemma provides the a priori error estimate for the finite element solution $u_h$ relative to the exact solution $u$:\n$$ \\|u - u_h\\|_{H_0^1(0,1)} \\le \\frac{M}{\\alpha} \\inf_{v_h \\in V_h} \\|u - v_h\\|_{H_0^1(0,1)}. $$\nHere, $V_h$ is the finite-dimensional subspace of $H_0^1(0,1)$, and the norm is as specified, $\\|v\\|_{H_0^1(0,1)} = \\|v'\\|_{L^2(0,1)}$. The constant of stability is $\\frac{M}{\\alpha} = 1 + \\frac{1}{\\epsilon \\pi^2}$. In the singularly perturbed regime where $\\epsilon \\to 0$, this constant scales as $O(\\epsilon^{-1})$ and grows without bound. A very large stability constant renders the estimate quantitatively poor in the pre-asymptotic regime (i.e., for practical mesh sizes $h$). Although the estimate remains formally valid, it becomes an extreme overestimation of the true error, making it an unreliable tool for predicting the accuracy of the numerical solution for small $\\epsilon$. This degradation of the a priori error bound due to a problem parameter is a well-known issue in numerical analysis.", "answer": "$$\n\\boxed{1 + \\frac{1}{\\epsilon \\pi^{2}}}\n$$", "id": "2539773"}, {"introduction": "The theoretical elegance of Galerkin methods often assumes exact integration, a luxury we rarely have in practice, especially in spectral and high-order methods. When numerical quadrature is used to approximate the integrals in the bilinear form, the foundational Galerkin orthogonality is lost. This practice [@problem_id:3368516] extends our analysis to this realistic scenario by applying the framework of Strang's First Lemma. You will construct a spectral element example where quadrature error, or aliasing, is intentionally triggered, and compute the resulting consistency error term that pollutes the ideal quasi-optimal bound.", "problem": "Consider the one-dimensional reference element $\\Omega = [-1,1]$ and the Spectral Element Method (SEM) with polynomial degree $p=3$ using the modal Legendre basis $\\{P_{0}(x),P_{1}(x),P_{2}(x),P_{3}(x)\\}$, where $P_{n}(x)$ denotes the $n$-th Legendre polynomial. Let the bilinear form be the $L^{2}$ inner product $a(u,v) = \\int_{-1}^{1} u(x)\\,v(x)\\,\\mathrm{d}x$, which is coercive on $L^{2}(\\Omega)$, and define its discrete counterpart $a_{h}(u,v)$ by Gauss–Lobatto–Legendre (GLL) quadrature with $N=p+1=4$ nodes. The GLL nodes are $x_{0}=-1$, $x_{3}=1$, and the interior nodes are the zeros of $P_{3}'(x)$, namely $x_{1}=-1/\\sqrt{5}$ and $x_{2}=1/\\sqrt{5}$. The corresponding GLL weights are given by\n$$\nw_{0}=w_{3}=\\frac{2}{N(N-1)} \\quad \\text{and} \\quad w_{i}=\\frac{2}{N(N-1)}\\frac{1}{P_{N-1}(x_{i})^{2}} \\quad \\text{for} \\quad i=1,2,\n$$\nwith $N-1=3$ and $P_{3}(x)$ the Legendre polynomial of degree $3$.\n\nLet the exact solution be $u(x)=P_{3}(x)$ and let the right-hand side be chosen so that the continuous weak problem is $a(u,v)=\\ell(v)$ for all $v \\in L^{2}(\\Omega)$, with $\\ell$ defined consistently by the exact bilinear form. With the discrete bilinear form $a_{h}$ defined by the above GLL quadrature, the quasi-optimal error bound for the SEM is augmented by an aliasing-driven consistency term (as in the generalized Céa framework for inexact bilinear forms).\n\nUsing only fundamental properties of Legendre polynomials (orthogonality on $[-1,1]$ with respect to the weight $1$) and the exactness degree of GLL quadrature (exact for polynomials up to degree $2N-3$), construct the explicit SEM instance described and compute the consistency error term\n$$\n\\sup_{v_{h}\\in \\mathbb{P}_{3}\\setminus\\{0\\}} \\frac{\\left|a(u,v_{h})-a_{h}(u,v_{h})\\right|}{\\|v_{h}\\|_{a}},\n$$\nwhere $\\mathbb{P}_{3}$ denotes polynomials of degree at most $3$ on $\\Omega$ and $\\|v\\|_{a}=\\sqrt{a(v,v)}$ is the norm induced by $a(\\cdot,\\cdot)$. Express your final answer as an exact, simplified analytical expression. No rounding is required and no physical units are involved. Your derivation must explicitly show where the Gauss–Lobatto quadrature breaks exact orthogonality of the modal basis and how this yields the stated consistency term.", "solution": "The objective is to compute the consistency error term, which we denote by $C_{err}$:\n$$\nC_{err} = \\sup_{v_{h}\\in \\mathbb{P}_{3}\\setminus\\{0\\}} \\frac{\\left|a(u,v_{h})-a_{h}(u,v_{h})\\right|}{\\|v_{h}\\|_{a}}\n$$\nGiven are the exact solution $u(x) = P_{3}(x)$, the space of test functions $\\mathbb{P}_{3}$, the exact bilinear form $a(u,v) = \\int_{-1}^{1} u(x)v(x)dx$, and the discrete bilinear form $a_{h}(u,v) = \\sum_{i=0}^{3} u(x_i)v(x_i)w_i$, which is derived from GLL quadrature with $N=4$ points. The norm is the energy norm $\\|v_h\\|_a = \\sqrt{a(v_h, v_h)}$.\n\nAn arbitrary test function $v_h \\in \\mathbb{P}_{3}$ can be expressed in the Legendre basis as:\n$$\nv_h(x) = c_{0}P_{0}(x) + c_{1}P_{1}(x) + c_{2}P_{2}(x) + c_{3}P_{3}(x)\n$$\nfor some real coefficients $c_0, c_1, c_2, c_3$.\n\nThe numerator of the expression for $C_{err}$ is the quadrature error for the integral of $u(x)v_h(x)$:\n$$\n|a(u,v_h) - a_h(u,v_h)| = \\left| \\int_{-1}^{1} P_{3}(x)v_h(x)dx - \\sum_{i=0}^{3} P_{3}(x_i)v_h(x_i)w_i \\right|\n$$\nThe GLL quadrature rule with $N$ points is exact for polynomials of degree up to $2N-3$. In our case, $N=4$, so the quadrature is exact for any polynomial of degree up to $2(4)-3 = 5$.\n\nLet us analyze the integrand $P_{3}(x)v_h(x)$. Substituting the expansion for $v_h(x)$:\n$$\nP_{3}(x)v_h(x) = P_{3}(x) \\sum_{k=0}^{3} c_k P_k(x) = \\sum_{k=0}^{3} c_k P_3(x)P_k(x)\n$$\nThe degree of the polynomial $P_3(x)P_k(x)$ is $3+k$.\n-   For $k=0$, the degree is $3$.\n-   For $k=1$, the degree is $4$.\n-   For $k=2$, the degree is $5$.\nIn all these cases ($k=0,1,2$), the degree of the integrand is less than or equal to $5$, so the GLL quadrature is exact. This means:\n$$\n\\int_{-1}^{1} P_3(x)P_k(x)dx = \\sum_{i=0}^{3} P_3(x_i)P_k(x_i)w_i \\quad \\text{for } k=0,1,2\n$$\nIn other words, $a(P_3, P_k) = a_h(P_3, P_k)$ for $k=0,1,2$.\nBy the orthogonality property of Legendre polynomials, $\\int_{-1}^{1} P_m(x)P_n(x)dx = 0$ for $m \\neq n$. Thus, $a(P_3, P_k)=0$ for $k=0,1,2$. Consequently, $a_h(P_3, P_k)=0$ for $k=0,1,2$.\n\nThe consistency error term arises only from the component of the integrand with degree greater than $5$. This occurs for $k=3$, where the integrand is $c_3 P_3(x)^2$, a polynomial of degree $6$. For this term, the quadrature is not exact.\nThis explicitly shows that the quadrature error, and thus the consistency error, is due to the aliasing of the highest-degree term in the product $u(x)v_h(x)$.\n\nThe total error term in the numerator is therefore:\n$$\na(u,v_h) - a_h(u,v_h) = \\sum_{k=0}^{3} c_k (a(P_3, P_k) - a_h(P_3, P_k)) = c_3 (a(P_3, P_3) - a_h(P_3, P_3))\n$$\nThe absolute value is $|c_3| |a(P_3, P_3) - a_h(P_3, P_3)|$.\n\nNow we consider the denominator, $\\|v_h\\|_a^2 = a(v_h, v_h)$. Using the expansion of $v_h$ and the orthogonality of Legendre polynomials:\n$$\na(v_h, v_h) = \\int_{-1}^{1} \\left(\\sum_{j=0}^{3} c_j P_j(x)\\right)\\left(\\sum_{k=0}^{3} c_k P_k(x)\\right) dx = \\sum_{j,k=0}^{3} c_j c_k \\int_{-1}^{1} P_j(x)P_k(x) dx\n$$\n$$\na(v_h, v_h) = \\sum_{k=0}^{3} c_k^2 \\int_{-1}^{1} P_k(x)^2 dx = \\sum_{k=0}^{3} c_k^2 \\frac{2}{2k+1}\n$$\nSo, $\\|v_h\\|_a = \\sqrt{c_{0}^2\\frac{2}{1} + c_{1}^2\\frac{2}{3} + c_{2}^2\\frac{2}{5} + c_{3}^2\\frac{2}{7}}$.\n\nThe expression to maximize becomes:\n$$\n\\frac{|c_3| |a(P_3, P_3) - a_h(P_3, P_3)|}{\\sqrt{c_{0}^2(2) + c_{1}^2(2/3) + c_{2}^2(2/5) + c_{3}^2(2/7)}}\n$$\nTo maximize this fraction over all non-zero $v_h$ (i.e., not all $c_k$ are zero), we observe that the numerator depends only on $|c_3|$, while the denominator is minimized for a fixed $|c_3|$ by setting $c_0=c_1=c_2=0$. Therefore, the supremum is attained when $v_h$ is proportional to $P_3(x)$. For such $v_h$, the expression simplifies to:\n$$\nC_{err} = \\frac{|a(P_3, P_3) - a_h(P_3, P_3)|}{\\|P_3\\|_{a}} = \\frac{|a(P_3, P_3) - a_h(P_3, P_3)|}{\\sqrt{a(P_3, P_3)}}\n$$\nWe now compute the necessary terms.\n1.  The exact inner product (norm-squared):\n    The normalization of Legendre polynomials gives $a(P_n, P_n) = \\int_{-1}^{1} P_n(x)^2 dx = \\frac{2}{2n+1}$.\n    For $n=3$, $a(P_3, P_3) = \\frac{2}{2(3)+1} = \\frac{2}{7}$.\n\n2.  The discrete inner product $a_h(P_3, P_3) = \\sum_{i=0}^{3} P_3(x_i)^2 w_i$.\n    We need the GLL nodes $x_i$ and weights $w_i$ for $N=4$.\n    The nodes are $x_0=-1$, $x_3=1$, and the zeros of $P_3'(x)$. From $P_3(x) = \\frac{1}{2}(5x^3 - 3x)$, we have $P_3'(x) = \\frac{1}{2}(15x^2 - 3)$. Setting $P_3'(x)=0$ gives $x^2=1/5$, so $x_1 = -1/\\sqrt{5}$ and $x_2 = 1/\\sqrt{5}$.\n    The weights are $w_0 = w_3 = \\frac{2}{N(N-1)} = \\frac{2}{4(3)} = \\frac{1}{6}$.\n    The interior weights are $w_i = \\frac{2}{N(N-1)P_{N-1}(x_i)^2} = \\frac{1}{6 P_3(x_i)^2}$ for $i=1,2$.\n    We evaluate $P_3(x)$ at the interior nodes:\n    $P_3(-1/\\sqrt{5}) = \\frac{1}{2}\\left(5\\left(\\frac{-1}{\\sqrt{5}}\\right)^3 - 3\\left(\\frac{-1}{\\sqrt{5}}\\right)\\right) = \\frac{1}{2}\\left(\\frac{-5}{5\\sqrt{5}} + \\frac{3}{\\sqrt{5}}\\right) = \\frac{1}{2}\\left(\\frac{2}{\\sqrt{5}}\\right) = \\frac{1}{\\sqrt{5}}$.\n    $P_3(1/\\sqrt{5}) = \\frac{1}{2}\\left(5\\left(\\frac{1}{\\sqrt{5}}\\right)^3 - 3\\left(\\frac{1}{\\sqrt{5}}\\right)\\right) = \\frac{1}{2}\\left(\\frac{5}{5\\sqrt{5}} - \\frac{3}{\\sqrt{5}}\\right) = \\frac{1}{2}\\left(\\frac{-2}{\\sqrt{5}}\\right) = -\\frac{1}{\\sqrt{5}}$.\n    So, $w_1 = \\frac{1}{6 (1/\\sqrt{5})^2} = \\frac{1}{6(1/5)} = \\frac{5}{6}$, and $w_2 = \\frac{1}{6 (-1/\\sqrt{5})^2} = \\frac{5}{6}$.\n    We also need $P_3(x)$ at the boundary nodes: $P_3(1)=1$ and $P_3(-1)=-1$.\n    Now we can calculate $a_h(P_3, P_3)$:\n    $$\n    a_h(P_3, P_3) = P_3(x_0)^2 w_0 + P_3(x_1)^2 w_1 + P_3(x_2)^2 w_2 + P_3(x_3)^2 w_3\n    $$\n    $$\n    a_h(P_3, P_3) = (-1)^2 \\left(\\frac{1}{6}\\right) + \\left(\\frac{1}{\\sqrt{5}}\\right)^2 \\left(\\frac{5}{6}\\right) + \\left(-\\frac{1}{\\sqrt{5}}\\right)^2 \\left(\\frac{5}{6}\\right) + (1)^2 \\left(\\frac{1}{6}\\right)\n    $$\n    $$\n    a_h(P_3, P_3) = 1 \\cdot \\frac{1}{6} + \\frac{1}{5} \\cdot \\frac{5}{6} + \\frac{1}{5} \\cdot \\frac{5}{6} + 1 \\cdot \\frac{1}{6} = \\frac{1}{6} + \\frac{1}{6} + \\frac{1}{6} + \\frac{1}{6} = \\frac{4}{6} = \\frac{2}{3}\n    $$\n3.  Combine the terms to find $C_{err}$:\n    The numerator is $|a(P_3, P_3) - a_h(P_3, P_3)| = \\left|\\frac{2}{7} - \\frac{2}{3}\\right| = \\left|\\frac{6-14}{21}\\right| = \\left|-\\frac{8}{21}\\right| = \\frac{8}{21}$.\n    The denominator is $\\sqrt{a(P_3, P_3)} = \\sqrt{\\frac{2}{7}}$.\n    $$\n    C_{err} = \\frac{8/21}{\\sqrt{2/7}} = \\frac{8}{21} \\sqrt{\\frac{7}{2}} = \\frac{8}{21} \\frac{\\sqrt{7}}{\\sqrt{2}} = \\frac{8 \\sqrt{14}}{21 \\cdot 2} = \\frac{4\\sqrt{14}}{21}\n    $$\nThe consistency error term is $\\frac{4\\sqrt{14}}{21}$.", "answer": "$$\\boxed{\\frac{4\\sqrt{14}}{21}}$$", "id": "3368516"}]}