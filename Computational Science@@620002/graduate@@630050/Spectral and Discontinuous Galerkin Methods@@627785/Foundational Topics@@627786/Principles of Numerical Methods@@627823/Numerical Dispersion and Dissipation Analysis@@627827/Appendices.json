{"hands_on_practices": [{"introduction": "To accurately analyze a full PDE discretization, we must first understand the errors introduced by the time-stepping scheme. This practice isolates the error contribution from the time integration component. By applying the classical fourth-order Runge-Kutta method (RK4) to a simple oscillatory ordinary differential equation, which models the behavior of a single Fourier mode in a semi-discretized wave equation, you will perform a detailed Taylor series analysis. This exercise will allow you to derive the leading-order temporal dispersion and dissipation errors, revealing how the time step size $\\Delta t$ fundamentally controls accuracy for wave-like solutions. [@problem_id:3404837]", "problem": "Consider a one-dimensional linear, constant-coefficient hyperbolic partial differential equation discretized in space by a high-order Spectral Discontinuous Galerkin (SDG) scheme on a periodic domain. For a single Fourier mode with wavenumber corresponding to a semi-discrete frequency $\\omega > 0$, the semi-discrete system for the modal amplitude reduces to the linear ordinary differential equation $\\frac{d y}{d t} = i \\omega y$, where $i$ is the imaginary unit. This purely imaginary semi-discrete eigenvalue reflects the non-dissipative character of the underlying spatial discretization for the considered mode.\n\nApply the classical explicit four-stage fourth-order Runge–Kutta (RK) method (RK4) with time step $\\Delta t$ to this semi-discrete system. Let $z = i \\omega \\Delta t$, and denote the one-step numerical amplification factor by $G(z)$. Define the temporal dissipation error as $\\left|G(z)\\right| - 1$ (i.e., the deviation of the amplification factor magnitude from unity), and define the temporal dispersion error as $\\Phi(z) - \\omega \\Delta t$, where $\\Phi(z) = \\arg(G(z))$ is the numerical phase advance per time step measured in radians.\n\nStarting from the definition of the RK4 method and the linear test equation $\\frac{d y}{d t} = \\lambda y$ with $\\lambda = i \\omega$, derive the leading-order terms in the small-parameter expansion in $\\xi = \\omega \\Delta t$ of both the temporal dispersion error and the temporal dissipation error for RK4. Show explicitly the order in $\\Delta t$ of each error.\n\nExpress your final answer as a row matrix whose first entry is the leading-order dispersion error per time step in radians, and whose second entry is the leading-order dissipation error per time step, both written as analytic functions of $\\omega$ and $\\Delta t$. No rounding is required.", "solution": "The problem statement is a well-posed and scientifically grounded exercise in the numerical analysis of ordinary differential equations, specifically the stability and accuracy analysis of the classical fourth-order Runge-Kutta method for oscillatory problems. All provided information is consistent, complete, and standard within the field of numerical methods. The problem is therefore deemed valid.\n\nThe task is to analyze the temporal dispersion and dissipation errors introduced by the classical four-stage fourth-order Runge-Kutta (RK4) method when applied to the linear test equation $\\frac{d y}{d t} = \\lambda y$, where the eigenvalue $\\lambda$ is purely imaginary, $\\lambda = i \\omega$, with $\\omega > 0$. The semi-discrete equation is thus $\\frac{d y}{d t} = i \\omega y$.\n\nWhen applied to the linear test equation, the one-step update $y_{n+1} = G(z) y_n$ for RK4 is defined by the amplification factor $G(z)$, where $z = \\lambda \\Delta t$. For the classical RK4 method, the amplification factor is the fourth-order Taylor series expansion of the exponential:\n$$G(z) = 1 + z + \\frac{z^2}{2!} + \\frac{z^3}{3!} + \\frac{z^4}{4!}$$\n\nThe problem specifies $\\lambda = i\\omega$, so we set $z = i\\omega\\Delta t$. Let $\\xi = \\omega\\Delta t$. Thus, $z = i\\xi$.\n$$G(i\\xi) = 1 + i\\xi + \\frac{(i\\xi)^2}{2} + \\frac{(i\\xi)^3}{6} + \\frac{(i\\xi)^4}{24} = 1 + i\\xi - \\frac{\\xi^2}{2} - i\\frac{\\xi^3}{6} + \\frac{\\xi^4}{24}$$\nSeparating real and imaginary parts:\n$$G(i\\xi) = \\left(1 - \\frac{\\xi^2}{2} + \\frac{\\xi^4}{24}\\right) + i\\left(\\xi - \\frac{\\xi^3}{6}\\right)$$\n\n**Temporal Dispersion Error**\n\nThe dispersion error per time step is $\\Phi(z) - \\omega\\Delta t = \\arg(G(i\\xi)) - \\xi$. The numerical phase is $\\Phi(i\\xi) = \\arg(G(i\\xi))$, which can be calculated using $\\arctan$ of the ratio of the imaginary part to the real part.\n$$\\Phi(i\\xi) = \\arctan\\left(\\frac{\\xi - \\xi^3/6}{1 - \\xi^2/2 + \\xi^4/24}\\right)$$\nFor small $\\xi$, we perform a Taylor expansion. First, expand the argument of the $\\arctan$ function:\n$$\\frac{\\xi - \\xi^3/6}{1 - \\xi^2/2 + \\xi^4/24} = \\left(\\xi - \\frac{\\xi^3}{6}\\right)\\left(1 - \\left(\\frac{\\xi^2}{2} - \\frac{\\xi^4}{24}\\right)\\right)^{-1}$$\nUsing $(1-u)^{-1} = 1 + u + u^2 + \\dots$ with $u = \\frac{\\xi^2}{2} - \\frac{\\xi^4}{24}$:\n$$= \\left(\\xi - \\frac{\\xi^3}{6}\\right)\\left(1 + \\left(\\frac{\\xi^2}{2} - \\frac{\\xi^4}{24}\\right) + \\left(\\frac{\\xi^2}{2}\\right)^2 + O(\\xi^6)\\right)$$\n$$= \\left(\\xi - \\frac{\\xi^3}{6}\\right)\\left(1 + \\frac{\\xi^2}{2} + \\frac{5\\xi^4}{24} + O(\\xi^6)\\right)$$\n$$= \\xi + \\frac{\\xi^3}{2} + \\frac{5\\xi^5}{24} - \\frac{\\xi^3}{6} - \\frac{\\xi^5}{12} + O(\\xi^7) = \\xi + \\frac{\\xi^3}{3} + \\frac{\\xi^5}{8} + O(\\xi^7)$$\nNow, use the Taylor series for $\\arctan(x) = x - \\frac{x^3}{3} + \\frac{x^5}{5} - \\dots$:\n$$\\Phi(i\\xi) = \\left(\\xi + \\frac{\\xi^3}{3} + \\frac{\\xi^5}{8}\\right) - \\frac{1}{3}\\left(\\xi + \\frac{\\xi^3}{3}\\right)^3 + \\frac{1}{5}\\left(\\xi\\right)^5 + O(\\xi^7)$$\n$$\\Phi(i\\xi) = \\xi + \\frac{\\xi^3}{3} + \\frac{\\xi^5}{8} - \\frac{1}{3}\\left(\\xi^3 + \\xi^5 + \\dots\\right) + \\frac{\\xi^5}{5} + O(\\xi^7)$$\n$$\\Phi(i\\xi) = \\xi + \\left(\\frac{1}{3} - \\frac{1}{3}\\right)\\xi^3 + \\left(\\frac{1}{8} - \\frac{1}{3} + \\frac{1}{5}\\right)\\xi^5 + O(\\xi^7)$$\n$$\\Phi(i\\xi) = \\xi + \\left(\\frac{15 - 40 + 24}{120}\\right)\\xi^5 + O(\\xi^7) = \\xi - \\frac{1}{120}\\xi^5 + O(\\xi^7)$$\nThe dispersion error is $\\Phi(i\\xi) - \\xi$. The leading-order term is:\n$$\\text{Dispersion Error} = -\\frac{1}{120}\\xi^5 = -\\frac{1}{120}(\\omega\\Delta t)^5$$\nThis error is of order $O((\\Delta t)^5)$.\n\n**Temporal Dissipation Error**\n\nThe dissipation error is $|G(z)| - 1 = |G(i\\xi)| - 1$. We first compute $|G(i\\xi)|^2$:\n$$|G(i\\xi)|^2 = \\left(1 - \\frac{\\xi^2}{2} + \\frac{\\xi^4}{24}\\right)^2 + \\left(\\xi - \\frac{\\xi^3}{6}\\right)^2$$\nExpanding each term and collecting powers of $\\xi$:\n$$= \\left(1 - \\xi^2 + \\frac{\\xi^4}{3} - \\frac{\\xi^6}{24} + O(\\xi^8)\\right) + \\left(\\xi^2 - \\frac{\\xi^4}{3} + \\frac{\\xi^6}{36}\\right)$$\n$$= 1 + (-\\xi^2 + \\xi^2) + (\\frac{\\xi^4}{3} - \\frac{\\xi^4}{3}) + (-\\frac{\\xi^6}{24} + \\frac{\\xi^6}{36}) + O(\\xi^8)$$\n$$= 1 + \\left(\\frac{-3+2}{72}\\right)\\xi^6 + O(\\xi^8) = 1 - \\frac{\\xi^6}{72} + O(\\xi^8)$$\nNow we find $|G(i\\xi)|$ by taking the square root. Using the binomial expansion $(1+x)^{1/2} = 1 + \\frac{1}{2}x + O(x^2)$:\n$$|G(i\\xi)| = \\left(1 - \\frac{\\xi^6}{72} + O(\\xi^8)\\right)^{1/2} = 1 + \\frac{1}{2}\\left(-\\frac{\\xi^6}{72}\\right) + O(\\xi^8) = 1 - \\frac{\\xi^6}{144} + O(\\xi^8)$$\nThe dissipation error is $|G(i\\xi)| - 1$. The leading-order term is:\n$$\\text{Dissipation Error} = -\\frac{1}{144}\\xi^6 = -\\frac{1}{144}(\\omega\\Delta t)^6$$\nThis error is of order $O((\\Delta t)^6)$.\n\nThe leading-order temporal dispersion error per time step is $-\\frac{(\\omega\\Delta t)^5}{120}$, and the leading-order temporal dissipation error per time step is $-\\frac{(\\omega\\Delta t)^6}{144}$.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n-\\frac{(\\omega \\Delta t)^5}{120}  -\\frac{(\\omega \\Delta t)^6}{144}\n\\end{pmatrix}\n}\n$$", "id": "3404837"}, {"introduction": "High-order methods like Discontinuous Galerkin (DG) are powerful, but their discrete operators often possess a richer structure than simpler schemes, including the presence of non-physical or \"spurious\" solution modes. This advanced exercise demonstrates how to use Fourier analysis to peer inside the discrete operator and identify these distinct modes through its eigenvalues. You will then solve a practical design problem: constructing a mathematical filter that precisely removes the spurious mode while leaving the physically correct wave propagation characteristics untouched, a core technique in the development of robust high-order schemes. [@problem_id:3404792]", "problem": "Consider the one-dimensional linear advection equation $\\frac{\\partial u}{\\partial t}+a\\,\\frac{\\partial u}{\\partial x}=0$ with constant wave speed $a>0$ on a uniform mesh of spacing $h$. Discretize in space using the Discontinuous Galerkin (DG) method with polynomial degree $p=1$ and an upwind numerical flux. Advance in time with a single-step explicit method of step size $\\Delta t$ so that one application of the semi-discrete operator followed by the time step produces a linear update operator on the per-element degrees of freedom. Under a Fourier ansatz with wavenumber $k$, define the nondimensional wavenumber $\\theta=k\\,h$ (in radians), and let $G(\\theta)$ denote the resulting $2\\times 2$ Fourier symbol (amplification matrix) mapping the element state at time level $n$ to time level $n+1$. Assume that for each fixed $\\theta$ with $0|\\theta|\\pi$, the matrix $G(\\theta)$ is diagonalizable with two distinct eigenpairs $\\{g_{p}(\\theta),v_{p}(\\theta)\\}$ and $\\{g_{s}(\\theta),v_{s}(\\theta)\\}$, where the subscript $p$ denotes the physical branch and the subscript $s$ denotes the spurious branch. The discrete dispersion relation of the primary (physical) mode is encoded by the argument of $g_{p}(\\theta)$ via $g_{p}(\\theta)=\\exp\\!\\big(-\\mathrm{i}\\,\\omega_{h}(\\theta)\\,\\Delta t\\big)$, where $\\omega_{h}(\\theta)$ is the discrete frequency.\n\nYou are to use discrete symbol factorization to separate the physical and spurious branches and to design a linear, wavenumber-dependent, post-step filter that removes the non-physical branch while preserving the primary mode’s discrete dispersion relation. Constrain the filter to be a first-degree polynomial in the symbol $G(\\theta)$ of the form\n$$\n\\Phi(\\theta)=\\alpha_{0}(\\theta)\\,I+\\alpha_{1}(\\theta)\\,G(\\theta),\n$$\nwhere $I$ is the $2\\times 2$ identity and $\\alpha_{0}(\\theta)$, $\\alpha_{1}(\\theta)$ are scalar functions of $\\theta$ to be determined. Impose the design requirements:\n- The filter removes the spurious branch exactly, i.e., $\\Phi(\\theta)\\,v_{s}(\\theta)=0$.\n- The filter preserves the physical branch exactly, i.e., $\\Phi(\\theta)\\,v_{p}(\\theta)=v_{p}(\\theta)$, thereby leaving $\\omega_{h}(\\theta)$ unchanged.\n\nAssuming only that $g_{p}(\\theta)\\neq g_{s}(\\theta)$ and that the eigenvectors form a basis for $\\mathbb{C}^{2}$, determine the closed-form expression for the ratio $\\alpha_{1}(\\theta)/\\alpha_{0}(\\theta)$ in terms of the eigenvalues of $G(\\theta)$. Your final answer must be a single analytic expression in terms of $g_{p}(\\theta)$ and $g_{s}(\\theta)$ only. No numerical evaluation is required.", "solution": "The analysis begins by formalizing the filter design constraints. The problem specifies a post-step filter of the form $\\Phi(\\theta) = \\alpha_{0}(\\theta)I + \\alpha_{1}(\\theta)G(\\theta)$, where $I$ is the $2\\times 2$ identity matrix, $G(\\theta)$ is the amplification matrix, and $\\alpha_0(\\theta)$ and $\\alpha_1(\\theta)$ are scalar coefficients to be determined. The amplification matrix $G(\\theta)$ is assumed to be diagonalizable with two distinct eigenpairs: a physical mode $\\{g_{p}(\\theta), v_{p}(\\theta)\\}$ and a spurious mode $\\{g_{s}(\\theta), v_{s}(\\theta)\\}$. The eigenvectors $v_{p}(\\theta)$ and $v_{s}(\\theta)$ form a basis for $\\mathbb{C}^{2}$.\n\nThe defining property of these eigenpairs is that the application of the matrix $G(\\theta)$ to an eigenvector scales it by the corresponding eigenvalue:\n$$G(\\theta)v_{p}(\\theta) = g_{p}(\\theta)v_{p}(\\theta)$$\n$$G(\\theta)v_{s}(\\theta) = g_{s}(\\theta)v_{s}(\\theta)$$\n\nThe filter $\\Phi(\\theta)$ must satisfy two constraints:\n1.  **Spurious Mode Removal**: The filter must completely annihilate the spurious branch. This is expressed as $\\Phi(\\theta) v_{s}(\\theta) = 0$.\n2.  **Physical Mode Preservation**: The filter must leave the physical branch unchanged. This is expressed as $\\Phi(\\theta) v_{p}(\\theta) = v_{p}(\\theta)$.\n\nLet us analyze the first constraint. We substitute the definition of $\\Phi(\\theta)$ into the condition:\n$$(\\alpha_{0}(\\theta)I + \\alpha_{1}(\\theta)G(\\theta)) v_{s}(\\theta) = 0$$\nUsing the linearity of matrix multiplication and the property that $I v_s(\\theta) = v_s(\\theta)$, we have:\n$$\\alpha_{0}(\\theta)v_{s}(\\theta) + \\alpha_{1}(\\theta)G(\\theta)v_{s}(\\theta) = 0$$\nNow, we use the eigenvector relationship $G(\\theta)v_{s}(\\theta) = g_{s}(\\theta)v_{s}(\\theta)$:\n$$\\alpha_{0}(\\theta)v_{s}(\\theta) + \\alpha_{1}(\\theta)g_{s}(\\theta)v_{s}(\\theta) = 0$$\nSince an eigenvector $v_{s}(\\theta)$ is by definition non-zero, we can factor it out:\n$$(\\alpha_{0}(\\theta) + \\alpha_{1}(\\theta)g_{s}(\\theta))v_{s}(\\theta) = 0$$\nFor this equation to hold, the scalar coefficient must be zero:\n$$\\alpha_{0}(\\theta) + \\alpha_{1}(\\theta)g_{s}(\\theta) = 0 \\quad (1)$$\n\nNext, we analyze the second constraint in a similar manner. We substitute the definition of $\\Phi(\\theta)$ into the preservation condition:\n$$(\\alpha_{0}(\\theta)I + \\alpha_{1}(\\theta)G(\\theta)) v_{p}(\\theta) = v_{p}(\\theta)$$\nApplying linearity and the eigenvector property $G(\\theta)v_{p}(\\theta) = g_{p}(\\theta)v_{p}(\\theta)$:\n$$\\alpha_{0}(\\theta)v_{p}(\\theta) + \\alpha_{1}(\\theta)g_{p}(\\theta)v_{p}(\\theta) = v_{p}(\\theta)$$\nWe can rearrange the equation to gather all terms involving $v_p(\\theta)$ on one side:\n$$(\\alpha_{0}(\\theta) + \\alpha_{1}(\\theta)g_{p}(\\theta) - 1)v_{p}(\\theta) = 0$$\nSince the eigenvector $v_{p}(\\theta)$ is non-zero, the scalar coefficient must be zero:\n$$\\alpha_{0}(\\theta) + \\alpha_{1}(\\theta)g_{p}(\\theta) = 1 \\quad (2)$$\n\nEquations $(1)$ and $(2)$ form a system of two linear equations for the two unknown functions $\\alpha_{0}(\\theta)$ and $\\alpha_{1}(\\theta)$:\n$$\n\\begin{cases}\n\\alpha_{0}(\\theta) + \\alpha_{1}(\\theta)g_{s}(\\theta) = 0 \\\\\n\\alpha_{0}(\\theta) + \\alpha_{1}(\\theta)g_{p}(\\theta) = 1\n\\end{cases}\n$$\nThe problem asks for the ratio $\\alpha_{1}(\\theta)/\\alpha_{0}(\\theta)$. From equation $(1)$, we can directly express $\\alpha_{0}(\\theta)$ in terms of $\\alpha_{1}(\\theta)$:\n$$\\alpha_{0}(\\theta) = -\\alpha_{1}(\\theta)g_{s}(\\theta)$$\nTo find the ratio, we can divide both sides by $\\alpha_{0}(\\theta)$, assuming $\\alpha_{0}(\\theta) \\neq 0$:\n$$1 = -\\frac{\\alpha_{1}(\\theta)}{\\alpha_{0}(\\theta)}g_{s}(\\theta)$$\nSolving for the ratio gives:\n$$\\frac{\\alpha_{1}(\\theta)}{\\alpha_{0}(\\theta)} = -\\frac{1}{g_{s}(\\theta)}$$\nThis derivation is valid provided that $\\alpha_{0}(\\theta) \\neq 0$ and $g_{s}(\\theta) \\neq 0$. To confirm the validity and non-triviality of the coefficients, we can solve the linear system for $\\alpha_{0}(\\theta)$ and $\\alpha_{1}(\\theta)$ explicitly. Subtracting equation $(1)$ from equation $(2)$:\n$$(\\alpha_{0}(\\theta) + \\alpha_{1}(\\theta)g_{p}(\\theta)) - (\\alpha_{0}(\\theta) + \\alpha_{1}(\\theta)g_{s}(\\theta)) = 1 - 0$$\n$$\\alpha_{1}(\\theta)(g_{p}(\\theta) - g_{s}(\\theta)) = 1$$\nThe problem states that the eigenvalues are distinct, $g_{p}(\\theta) \\neq g_{s}(\\theta)$, which ensures that $g_{p}(\\theta) - g_{s}(\\theta) \\neq 0$. Therefore, we can solve for $\\alpha_{1}(\\theta)$:\n$$\\alpha_{1}(\\theta) = \\frac{1}{g_{p}(\\theta) - g_{s}(\\theta)}$$\nSince the denominator is non-zero, $\\alpha_{1}(\\theta)$ is well-defined and non-zero. Substituting this into the rearranged equation $(1)$:\n$$\\alpha_{0}(\\theta) = -\\alpha_{1}(\\theta)g_{s}(\\theta) = -\\frac{g_{s}(\\theta)}{g_{p}(\\theta) - g_{s}(\\theta)}$$\nThe coefficient $\\alpha_{0}(\\theta)$ is non-zero as long as $g_{s}(\\theta) \\neq 0$.\nThe ratio is then:\n$$\\frac{\\alpha_{1}(\\theta)}{\\alpha_{0}(\\theta)} = \\frac{\\frac{1}{g_{p}(\\theta) - g_{s}(\\theta)}}{-\\frac{g_{s}(\\theta)}{g_{p}(\\theta) - g_{s}(\\theta)}} = -\\frac{1}{g_{s}(\\theta)}$$\nThis confirms the result found by the more direct manipulation of equation $(1)$. The final expression for the ratio depends only on the spurious eigenvalue $g_{s}(\\theta)$.", "answer": "$$\n\\boxed{-\\frac{1}{g_{s}(\\theta)}}\n$$", "id": "3404792"}, {"introduction": "Theoretical analysis finds its ultimate value when it guides practical implementation and allows for the quantitative evaluation of numerical methods. This final practice is a computational exercise that brings the concepts of dispersion and dissipation to life. You will implement a spectral method with a tunable modal filter, a common and effective technique for suppressing spurious Gibbs oscillations in solutions with sharp features. This hands-on coding task requires you to measure and evaluate the crucial trade-off inherent in filtering: how much artificial dissipation is needed to clean up a solution, and what is the corresponding cost in phase accuracy for the physically important waves? [@problem_id:3404850]", "problem": "Consider the one-dimensional linear advection equation $\\frac{\\partial u}{\\partial t} + a\\,\\frac{\\partial u}{\\partial x} = 0$ on the periodic domain $x \\in [0,2\\pi)$, with wave speed $a$. A Fourier spectral collocation method exactly represents spatial derivatives for individual Fourier modes $u(x,t) = \\hat{u}(t)\\,e^{i k x}$, where $k \\in \\mathbb{Z}$ denotes the integer wavenumber. To reduce Gibbs oscillations near discontinuities while preserving low-wavenumber phase accuracy, a modal filter is applied after each explicit time step. The objective is to quantify the trade-off between suppression of high-wavenumber content (dissipation) and preservation of low-wavenumber phase speed (dispersion).\n\nStarting from the governing equation $\\frac{\\partial u}{\\partial t} + a\\,\\frac{\\partial u}{\\partial x} = 0$, the Fourier symbol of the spectral derivative is $i k$. Using a Strong Stability Preserving Runge–Kutta method of order three (SSP-RK3), specifically the Shu–Osher form of third-order Total Variation Diminishing Runge–Kutta (TVD-RK3), the one-step amplification polynomial for a linear constant-coefficient system $u_t = L u$ is given by the truncated Taylor series of the exponential:\n$$\nG_{\\text{RK3}}(\\lambda) = 1 + \\lambda + \\frac{1}{2}\\lambda^2 + \\frac{1}{6}\\lambda^3,\n$$\nwhere $\\lambda = \\Delta t\\,L$. For linear advection, $L = -a\\,\\frac{\\partial}{\\partial x}$ and for a Fourier mode $e^{i k x}$, one has $L \\mapsto -a\\,i k$, so $\\lambda = -i\\,a\\,k\\,\\Delta t$. A tuned exponential modal filter of order $m$ is defined by the transfer function\n$$\n\\sigma(k) = \\exp\\!\\left(-\\alpha\\,\\left(\\frac{|k|}{k_{\\max}}\\right)^{2m}\\right),\n$$\nwhere $k_{\\max}$ is the maximum resolvable wavenumber on the grid, $m \\in \\mathbb{N}$ is the filter order, and $\\alpha > 0$ is chosen to meet a specified attenuation at a cut-off ratio $r_{\\mathrm{cut}} \\in (0,1)$:\n$$\n\\sigma\\!\\left(r_{\\mathrm{cut}}\\,k_{\\max}\\right) = s_{\\mathrm{target}} \\quad \\Rightarrow \\quad \\alpha = -\\frac{\\ln(s_{\\mathrm{target}})}{r_{\\mathrm{cut}}^{2m}}.\n$$\nThe combined one-step amplification for wavenumber $k$ is then\n$$\nG(k) = \\sigma(k)\\,G_{\\text{RK3}}(-i\\,a\\,k\\,\\Delta t).\n$$\nDefine the numerical angular frequency by the argument (in radians) of $G_{\\text{RK3}}$,\n$$\n\\omega_{\\text{num}}(k) = \\frac{\\arg\\!\\left(G_{\\text{RK3}}(-i\\,a\\,k\\,\\Delta t)\\right)}{\\Delta t},\n$$\nand the numerical phase speed by $c_{\\text{num}}(k) = \\omega_{\\text{num}}(k)/k$. Because $\\sigma(k)$ is real and positive, it does not alter the phase, only the magnitude.\n\nYou must write a complete, runnable program that computes two metrics per test case:\n- Low-wavenumber phase error:\n$$\nE_{\\text{phase,low}} = \\max_{k/k_{\\max} \\in (0,r_{\\text{phase}}]}\\left| \\frac{c_{\\text{num}}(k)}{a} - 1 \\right|,\n$$\nwhich quantifies dispersion at low wavenumbers, expressed as a dimensionless decimal. Angles must be measured in radians.\n- High-wavenumber mean dissipation per step:\n$$\nD_{\\text{high}} = \\frac{1}{\\#\\{k: k/k_{\\max} \\in [r_{\\text{diss}},1]\\}} \\sum_{k/k_{\\max} \\in [r_{\\text{diss}},1]}\\left(1 - |G(k)|\\right),\n$$\nwhich quantifies attenuation due to the filter and time stepping, expressed as a dimensionless decimal.\n\nUse a uniform grid with $N$ points on $[0,2\\pi)$, so the resolvable wavenumbers are integers and $k_{\\max} = N/2$. Take $a = 1$. The program must evaluate the metrics on the set of positive wavenumbers $k = 1,2,\\dots,k_{\\max}$. The low-wavenumber threshold is $r_{\\text{phase}} = 0.2$, and the high-wavenumber threshold is $r_{\\text{diss}} = 0.6$.\n\nImplement the tuned filter by choosing $\\alpha$ from $s_{\\mathrm{target}}$ and $r_{\\mathrm{cut}}$ via the formula above. If $s_{\\mathrm{target}} = 1$, interpret this as the no-filter case with $\\alpha = 0$.\n\nDesign the program to process the following three test cases:\n- Case $1$: $(N=\\;256,\\; \\Delta t=\\;0.05,\\; m=\\;8,\\; r_{\\mathrm{cut}}=\\;0.7,\\; s_{\\mathrm{target}}=\\;1.0)$.\n- Case $2$: $(N=\\;256,\\; \\Delta t=\\;0.05,\\; m=\\;8,\\; r_{\\mathrm{cut}}=\\;0.7,\\; s_{\\mathrm{target}}=\\;0.1)$.\n- Case $3$: $(N=\\;256,\\; \\Delta t=\\;0.05,\\; m=\\;16,\\; r_{\\mathrm{cut}}=\\;0.6,\\; s_{\\mathrm{target}}=\\;0.001)$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order $[E_{\\text{phase,low}}^{(1)},D_{\\text{high}}^{(1)},E_{\\text{phase,low}}^{(2)},D_{\\text{high}}^{(2)},E_{\\text{phase,low}}^{(3)},D_{\\text{high}}^{(3)}]$, where the superscript indicates the case number. All angles must be handled in radians, and the outputs are dimensionless decimals.", "solution": "The starting point is the one-dimensional linear advection equation $\\frac{\\partial u}{\\partial t} + a\\,\\frac{\\partial u}{\\partial x} = 0$ on a periodic domain. For a Fourier mode $u(x,t) = \\hat{u}(t)\\,e^{i k x}$, substitution yields\n$$\n\\frac{d\\hat{u}}{dt} + a\\,i\\,k\\,\\hat{u} = 0,\n$$\nwhich is a linear ordinary differential equation with constant coefficient $L = -a\\,i\\,k$. The exact solution over one time step $\\Delta t$ has amplification factor $e^{\\lambda}$ with $\\lambda = \\Delta t\\,L = -i\\,a\\,k\\,\\Delta t$.\n\nWe consider the Shu–Osher third-order Total Variation Diminishing Runge–Kutta method (Strong Stability Preserving Runge–Kutta method of order three). For any linear system $u_t = L u$, the one-step amplification polynomial is the third-order Taylor polynomial of the exponential:\n$$\nG_{\\text{RK3}}(\\lambda) = 1 + \\lambda + \\frac{1}{2}\\lambda^2 + \\frac{1}{6}\\lambda^3.\n$$\nThis follows directly from the staged updates of Shu–Osher TVD-RK3 when $L$ is linear:\n- First stage: $u^{(1)} = (1+\\lambda)u^n$.\n- Second stage: $u^{(2)} = \\frac{3}{4}u^n + \\frac{1}{4}\\left(1 + 2\\lambda + \\lambda^2\\right)u^n = \\left(1 + \\frac{1}{2}\\lambda + \\frac{1}{4}\\lambda^2\\right)u^n$.\n- Third stage: $u^{n+1} = \\frac{1}{3}u^n + \\frac{2}{3}\\left(1 + \\frac{3}{2}\\lambda + \\frac{3}{4}\\lambda^2 + \\frac{1}{4}\\lambda^3\\right)u^n = \\left(1 + \\lambda + \\frac{1}{2}\\lambda^2 + \\frac{1}{6}\\lambda^3\\right)u^n$.\n\nFor the Fourier spectral collocation discretization of the spatial derivative, the symbol is exact: $\\partial_x \\mapsto i k$ for mode $e^{i k x}$. Thus, for advection speed $a$, the semi-discrete operator is $L = -a\\,i\\,k$, and the Runge–Kutta step has amplification $G_{\\text{RK3}}(-i\\,a\\,k\\,\\Delta t)$.\n\nTo mitigate Gibbs oscillations associated with high-wavenumber content, we apply a tuned exponential modal filter after each step. The filter transfer function is\n$$\n\\sigma(k) = \\exp\\!\\left(-\\alpha\\,\\left(\\frac{|k|}{k_{\\max}}\\right)^{2m}\\right),\n$$\nwhere $m$ is the filter order, $k_{\\max} = N/2$ for $N$ equispaced points on $[0,2\\pi)$, and $\\alpha$ is chosen to meet a design constraint at the cut-off ratio $r_{\\mathrm{cut}}$:\n$$\n\\sigma(r_{\\mathrm{cut}}\\,k_{\\max}) = s_{\\mathrm{target}} \\;\\Rightarrow\\; \\alpha = -\\frac{\\ln(s_{\\mathrm{target}})}{r_{\\mathrm{cut}}^{2m}}.\n$$\nWhen $s_{\\mathrm{target}} = 1$, we interpret this as no filtering, so $\\alpha = 0$ and $\\sigma(k) = 1$ for all $k$.\n\nThe combined one-step amplification for wavenumber $k$ is\n$$\nG(k) = \\sigma(k)\\,G_{\\text{RK3}}(-i\\,a\\,k\\,\\Delta t),\n$$\nwhich is a complex number. Its magnitude $|G(k)|$ reflects dissipation (amplitude attenuation), and its argument $\\arg(G(k))$ would reflect phase advance. However, since $\\sigma(k)$ is real and positive, it does not alter the phase; hence, dispersion is fully controlled by $G_{\\text{RK3}}$.\n\nWe define the numerical angular frequency by\n$$\n\\omega_{\\text{num}}(k) = \\frac{\\arg\\!\\left(G_{\\text{RK3}}(-i\\,a\\,k\\,\\Delta t)\\right)}{\\Delta t},\n$$\nand the numerical phase speed by $c_{\\text{num}}(k) = \\omega_{\\text{num}}(k)/k$. The exact phase speed is $a$. The low-wavenumber phase error metric is then\n$$\nE_{\\text{phase,low}} = \\max_{k/k_{\\max} \\in (0,r_{\\text{phase}}]}\\left| \\frac{c_{\\text{num}}(k)}{a} - 1 \\right|,\n$$\nevaluated over the set of positive wavenumbers $k = 1,2,\\dots,k_{\\max}$ with the ratio $k/k_{\\max}$ lying within $(0,r_{\\text{phase}}]$, where $r_{\\text{phase}}$ is a prescribed threshold. This metric is dimensionless.\n\nThe high-wavenumber mean dissipation per step is defined by\n$$\nD_{\\text{high}} = \\frac{1}{K_{\\text{count}}}\\sum_{k/k_{\\max} \\in [r_{\\text{diss}},1]}\\left(1 - |G(k)|\\right),\n$$\nwhere $K_{\\text{count}}$ is the number of wavenumbers in the specified high-wavenumber range and $|G(k)|$ is the magnitude of the combined amplification. This metric is also dimensionless and reflects the trade-off: larger dissipation suppresses Gibbs oscillations but reduces amplitude of high-frequency content.\n\nAlgorithmic steps for each test case $(N,\\Delta t,m,r_{\\mathrm{cut}},s_{\\mathrm{target}})$ with $a=1$:\n1. Set $k_{\\max} = N/2$ and construct the array of positive integer wavenumbers $k = 1,2,\\dots,k_{\\max}$.\n2. Compute the ratio $r(k) = k/k_{\\max}$ for each $k$.\n3. Compute $\\alpha = -\\ln(s_{\\mathrm{target}})/r_{\\mathrm{cut}}^{2m}$, with the convention that if $s_{\\mathrm{target}} = 1$ then $\\alpha = 0$.\n4. Evaluate the filter $\\sigma(k) = \\exp\\left(-\\alpha\\,r(k)^{2m}\\right)$.\n5. Compute $\\lambda(k) = -i\\,a\\,k\\,\\Delta t$ and the Runge–Kutta amplification $G_{\\text{RK3}}(\\lambda) = 1 + \\lambda + \\frac{1}{2}\\lambda^2 + \\frac{1}{6}\\lambda^3$.\n6. Form the combined amplification $G(k) = \\sigma(k)\\,G_{\\text{RK3}}(\\lambda)$.\n7. Compute the phase speed using only $G_{\\text{RK3}}$: $c_{\\text{num}}(k) = \\arg(G_{\\text{RK3}}(\\lambda))/(\\Delta t\\,k)$, with angles in radians.\n8. Compute $E_{\\text{phase,low}}$ as the maximum of $\\left|c_{\\text{num}}(k)/a - 1\\right|$ over $k$ with $r(k) \\in (0,r_{\\text{phase}}]$, where $r_{\\text{phase}} = 0.2$.\n9. Compute $D_{\\text{high}}$ as the mean of $1 - |G(k)|$ over $k$ with $r(k) \\in [r_{\\text{diss}},1]$, where $r_{\\text{diss}} = 0.6$.\n10. Output the six results for the three test cases in the specified order and format.\n\nScientific realism and numerical soundness:\n- The Fourier spectral derivative symbol $i k$ is exact for Fourier modes, providing a clean foundation for dispersion analysis without spatial discretization error in the derivative.\n- The TVD-RK3 amplification polynomial is a well-tested formula and represents third-order temporal accuracy.\n- The exponential filter is a standard design in spectral methods; tuning $\\alpha$ via a specified attenuation at a cut-off ratio is widely used to control Gibbs oscillations while minimizing low-wavenumber distortion.\n- The dispersion metric focuses on low wavenumbers where physical fidelity is most critical, and the dissipation metric emphasizes high wavenumbers where Gibbs oscillations occur.\n- Angles are measured in radians, and all outputs are dimensionless decimals, conforming to the requirement on units.\n\nTest suite and final output:\n- Case $1$: $(N=\\;256,\\; \\Delta t=\\;0.05,\\; m=\\;8,\\; r_{\\mathrm{cut}}=\\;0.7,\\; s_{\\mathrm{target}}=\\;1.0)$.\n- Case $2$: $(N=\\;256,\\; \\Delta t=\\;0.05,\\; m=\\;8,\\; r_{\\mathrm{cut}}=\\;0.7,\\; s_{\\mathrm{target}}=\\;0.1)$.\n- Case $3$: $(N=\\;256,\\; \\Delta t=\\;0.05,\\; m=\\;16,\\; r_{\\mathrm{cut}}=\\;0.6,\\; s_{\\mathrm{target}}=\\;0.001)$.\nThe program must print a single line: $[E_{\\text{phase,low}}^{(1)},D_{\\text{high}}^{(1)},E_{\\text{phase,low}}^{(2)},D_{\\text{high}}^{(2)},E_{\\text{phase,low}}^{(3)},D_{\\text{high}}^{(3)}]$, where each quantity is a decimal.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef rk3_amplification(lambda_k: np.ndarray) - np.ndarray:\n    \"\"\"\n    Compute the Shu-Osher TVD-RK3 amplification polynomial G_RK3(lambda)\n    for a given array of lambda values.\n    G_RK3(lambda) = 1 + lambda + 0.5*lambda^2 + (1/6)*lambda^3\n    \"\"\"\n    return 1.0 + lambda_k + 0.5 * (lambda_k ** 2) + (1.0 / 6.0) * (lambda_k ** 3)\n\ndef tuned_exponential_filter(r: np.ndarray, m: int, r_cut: float, s_target: float) - np.ndarray:\n    \"\"\"\n    Compute the tuned exponential filter sigma(k) = exp(-alpha * r^(2m)),\n    where r = |k|/k_max. Alpha is chosen so that sigma(r_cut) = s_target.\n    If s_target == 1.0, alpha is set to 0 (no filter).\n    \"\"\"\n    if np.isclose(s_target, 1.0):\n        alpha = 0.0\n    else:\n        # alpha = -ln(s_target) / r_cut^(2m)\n        alpha = -np.log(s_target) / (r_cut ** (2 * m))\n    sigma = np.exp(-alpha * (r ** (2 * m)))\n    return sigma\n\ndef compute_metrics(N: int, dt: float, m: int, r_cut: float, s_target: float,\n                    a: float = 1.0, r_phase: float = 0.2, r_diss: float = 0.6) - tuple[float, float]:\n    \"\"\"\n    Compute E_phase_low and D_high for the given parameters.\n    - N: number of grid points on [0, 2*pi)\n    - dt: time step\n    - m: filter order\n    - r_cut: cut-off ratio for tuning\n    - s_target: target attenuation at r_cut\n    - a: advection speed (default 1.0)\n    - r_phase: threshold for low-wavenumber phase error metric\n    - r_diss: threshold for high-wavenumber dissipation metric\n    Returns (E_phase_low, D_high) as floats.\n    \"\"\"\n    k_max = N // 2\n    # Positive wavenumbers 1..k_max\n    k = np.arange(1, k_max + 1, dtype=float)\n    r = k / k_max\n\n    # Semi-discrete lambda for linear advection with spectral derivative\n    lambda_k = -1j * a * k * dt\n\n    # RK3 amplification (phase carrier)\n    G_rk3 = rk3_amplification(lambda_k)\n\n    # Tuned filter sigma (magnitude-only; real and positive)\n    sigma = tuned_exponential_filter(r, m, r_cut, s_target)\n\n    # Combined amplification per step\n    G_combined = sigma * G_rk3\n\n    # Low-wavenumber phase error metric: use phase of G_rk3 only (filter does not change phase)\n    # angle in radians\n    omega_num = np.angle(G_rk3) / dt\n    c_num = omega_num / k  # numerical phase speed\n\n    # Mask for low-wavenumber band\n    low_mask = (r  0.0)  (r = r_phase)\n    if not np.any(low_mask):\n        # Should not happen for provided parameters, but guard anyway\n        E_phase_low = 0.0\n    else:\n        E_phase_low = np.max(np.abs(c_num[low_mask] / a - 1.0))\n\n    # High-wavenumber dissipation: mean(1 - |G|)\n    high_mask = (r = r_diss)  (r = 1.0)\n    if not np.any(high_mask):\n        D_high = 0.0\n    else:\n        mag = np.abs(G_combined[high_mask])\n        D_high = float(np.mean(1.0 - mag))\n\n    return float(E_phase_low), float(D_high)\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each test case: (N, dt, m, r_cut, s_target)\n    test_cases = [\n        (256, 0.05, 8, 0.7, 1.0),     # Case 1: no filter\n        (256, 0.05, 8, 0.7, 0.1),     # Case 2: moderate filter\n        (256, 0.05, 16, 0.6, 0.001),  # Case 3: aggressive filter\n    ]\n\n    results = []\n    for case in test_cases:\n        N, dt, m, r_cut, s_target = case\n        E_phase_low, D_high = compute_metrics(N=N, dt=dt, m=m, r_cut=r_cut, s_target=s_target)\n        # Optionally round for cleaner output; keep sufficient precision\n        results.append(f\"{E_phase_low:.10f}\")\n        results.append(f\"{D_high:.10f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "3404850"}]}