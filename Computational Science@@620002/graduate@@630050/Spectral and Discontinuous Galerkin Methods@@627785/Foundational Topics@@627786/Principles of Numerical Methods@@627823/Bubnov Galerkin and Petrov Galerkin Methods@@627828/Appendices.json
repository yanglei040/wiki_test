{"hands_on_practices": [{"introduction": "Mastering the Galerkin method begins with its application to a fundamental problem. This exercise applies the Bubnov-Galerkin spectral method to the classic Sturm-Liouville eigenvalue problem, a cornerstone of mathematical physics and engineering. By working through the process of deriving the weak formulation, selecting appropriate basis functions, assembling the discrete stiffness and mass matrices, and solving the resulting generalized eigenvalue problem, you will solidify your understanding of the core mechanics of the Bubnov-Galerkin framework [@problem_id:3368169].", "problem": "Consider the Sturm–Liouville eigenvalue problem for the one-dimensional Laplacian with homogeneous Dirichlet boundary conditions on the symmetric interval:\nfind nontrivial $u \\in H_{0}^{1}(-1,1)$ and $\\lambda \\in \\mathbb{R}$ such that\n$$\n- u''(x) = \\lambda\\, u(x), \\quad x \\in (-1,1), \\qquad u(-1)=u(1)=0.\n$$\nThe exact spectrum is $\\lambda_{n}^{\\star} = \\left(\\frac{n\\pi}{2}\\right)^{2}$ for $n \\in \\mathbb{N}$, so the first two exact eigenvalues are $\\lambda_{1}^{\\star} = \\pi^{2}/4$ and $\\lambda_{2}^{\\star} = \\pi^{2}$.\n\nUsing a Legendre spectral Bubnov Galerkin discretization with polynomial trial space $\\mathbb{P}_{3}^{0} := \\{ p \\in \\mathbb{P}_{3} : p(\\pm 1)=0\\}$, proceed as follows:\n- Start from the weak formulation derived from Green’s identity and the Dirichlet boundary conditions.\n- Choose the modal Legendre basis functions for the trial space given by $\\phi_{0}(x) = L_{2}(x)-L_{0}(x)$ and $\\phi_{1}(x) = L_{3}(x)-L_{1}(x)$, where $L_{n}(x)$ denotes the Legendre polynomial of degree $n$ normalized by $L_{n}(1)=1$.\n- Assemble the stiffness matrix $K$ with entries $K_{ij} = \\int_{-1}^{1} \\phi'_{i}(x)\\,\\phi'_{j}(x)\\,dx$ and the mass matrix $M$ with entries $M_{ij} = \\int_{-1}^{1} \\phi_{i}(x)\\,\\phi_{j}(x)\\,dx$.\n- Solve the resulting $2\\times 2$ generalized eigenvalue problem $K \\mathbf{a} = \\lambda_{h}\\, M \\mathbf{a}$ to obtain the two Rayleigh–Ritz approximations $\\lambda_{h,1}$ and $\\lambda_{h,2}$ of the first two eigenvalues.\n\nIn addition, briefly justify whether a Petrov Galerkin choice with the same two boundary-vanishing test functions leads to a different discrete spectrum for this problem, given the self-adjoint form of the bilinear form.\n\nDefine the dimensionless quantity\n$$\n\\Pi := \\left(\\frac{\\lambda_{h,1}}{\\pi^{2}/4}\\right)\\left(\\frac{\\lambda_{h,2}}{\\pi^{2}}\\right).\n$$\nCompute $\\Pi$ exactly and express your final answer as a closed-form analytic expression in terms of $\\pi$. Do not provide intermediate numerical approximations. The final answer must be a single expression.", "solution": "The problem statement has been validated and is deemed valid. It is scientifically grounded, well-posed, and objective, presenting a standard problem in the numerical analysis of differential equations. All necessary information is provided, and there are no contradictions or ambiguities.\n\nThe problem asks for the solution of a Sturm-Liouville eigenvalue problem using a Legendre spectral Bubnov-Galerkin method. The problem is to find nontrivial $u \\in H_{0}^{1}(-1,1)$ and $\\lambda \\in \\mathbb{R}$ such that:\n$$\n- u''(x) = \\lambda\\, u(x), \\quad x \\in (-1,1), \\qquad u(-1)=u(1)=0.\n$$\nFirst, we derive the weak formulation. We multiply the differential equation by a test function $v \\in H_{0}^{1}(-1,1)$ and integrate over the domain $(-1,1)$:\n$$\n-\\int_{-1}^{1} u''(x)v(x) \\,dx = \\lambda \\int_{-1}^{1} u(x)v(x) \\,dx.\n$$\nApplying integration by parts (Green's first identity) to the left-hand side gives:\n$$\n\\int_{-1}^{1} u'(x)v'(x) \\,dx - \\left[u'(x)v(x)\\right]_{-1}^{1} = \\lambda \\int_{-1}^{1} u(x)v(x) \\,dx.\n$$\nSince the test function $v$ is in $H_{0}^{1}(-1,1)$, it satisfies the homogeneous Dirichlet boundary conditions $v(-1)=v(1)=0$. Thus, the boundary term vanishes. The weak formulation is: find $u \\in H_{0}^{1}(-1,1)$ and $\\lambda \\in \\mathbb{R}$ such that\n$$a(u,v) = \\lambda (u,v)_{L^2} \\qquad \\forall v \\in H_{0}^{1}(-1,1),$$\nwhere $a(u,v) := \\int_{-1}^{1} u'(x)v'(x) \\,dx$ is a symmetric bilinear form and $(u,v)_{L^2} := \\int_{-1}^{1} u(x)v(x) \\,dx$ is the $L^2$ inner product.\n\nFor the Bubnov-Galerkin method, we seek an approximate solution $u_h(x)$ in a finite-dimensional trial space $\\mathbb{P}_{3}^{0} = \\{ p \\in \\mathbb{P}_{3} : p(\\pm 1)=0\\}$. The approximate solution is expressed as a linear combination of basis functions, $u_h(x) = \\sum_{j=0}^{1} a_j \\phi_j(x)$. The test functions are chosen from the same space. The given basis functions are $\\phi_{0}(x) = L_{2}(x)-L_{0}(x)$ and $\\phi_{1}(x) = L_{3}(x)-L_{1}(x)$, where $L_n(x)$ are the Legendre polynomials normalized such that $L_n(1)=1$. These are:\n$L_0(x) = 1$\n$L_1(x) = x$\n$L_2(x) = \\frac{1}{2}(3x^2-1)$\n$L_3(x) = \\frac{1}{2}(5x^3-3x)$\nWe have already verified in the problem validation phase that these basis functions satisfy the required boundary conditions, i.e., $\\phi_i(\\pm 1)=0$ for $i=0,1$.\n\nThe Bubnov-Galerkin method leads to the generalized matrix eigenvalue problem $K \\mathbf{a} = \\lambda_{h} M \\mathbf{a}$, where $\\mathbf{a}$ is the vector of coefficients $[a_0, a_1]^T$, and the stiffness matrix $K$ and mass matrix $M$ have entries:\n$K_{ij} = a(\\phi_j, \\phi_i) = \\int_{-1}^{1} \\phi'_{j}(x)\\phi'_{i}(x)\\,dx$\n$M_{ij} = (\\phi_j, \\phi_i)_{L^2} = \\int_{-1}^{1} \\phi_{j}(x)\\phi_{i}(x)\\,dx$\n\nWe compute the derivatives of the basis functions:\n$\\phi'_{0}(x) = L'_{2}(x) - L'_{0}(x) = 3x - 0 = 3x$\n$\\phi'_{1}(x) = L'_{3}(x) - L'_{1}(x) = \\frac{1}{2}(15x^2 - 3) - 1 = \\frac{15}{2}x^2 - \\frac{5}{2}$\n\nNow, we assemble the stiffness matrix $K$:\n$K_{00} = \\int_{-1}^{1} (3x)^2 \\,dx = 9 \\int_{-1}^{1} x^2 \\,dx = 9 \\left[\\frac{x^3}{3}\\right]_{-1}^{1} = 9\\left(\\frac{2}{3}\\right) = 6$.\n$K_{11} = \\int_{-1}^{1} \\left(\\frac{15}{2}x^2 - \\frac{5}{2}\\right)^2 \\,dx = \\frac{25}{4} \\int_{-1}^{1} (3x^2 - 1)^2 \\,dx = \\frac{25}{4} \\int_{-1}^{1} (9x^4 - 6x^2 + 1) \\,dx = \\frac{25}{4} \\left[9\\frac{x^5}{5} - 6\\frac{x^3}{3} + x\\right]_{-1}^{1} = \\frac{25}{4} \\cdot 2\\left(\\frac{9}{5} - 2 + 1\\right) = \\frac{25}{2}\\left(\\frac{4}{5}\\right) = 10$.\n$K_{01} = K_{10} = \\int_{-1}^{1} (3x)\\left(\\frac{15}{2}x^2 - \\frac{5}{2}\\right) \\,dx = \\int_{-1}^{1} \\left(\\frac{45}{2}x^3 - \\frac{15}{2}x\\right) \\,dx = 0$, since the integrand is an odd function integrated over a symmetric interval.\nThus, the stiffness matrix is $K = \\begin{pmatrix} 6 & 0 \\\\ 0 & 10 \\end{pmatrix}$.\n\nNext, we assemble the mass matrix $M$. We use the orthogonality property of Legendre polynomials: $\\int_{-1}^{1} L_m(x)L_n(x)\\,dx = \\frac{2}{2n+1}\\delta_{mn}$.\n$M_{00} = \\int_{-1}^{1} (\\phi_0(x))^2 \\,dx = \\int_{-1}^{1} (L_2(x)-L_0(x))^2 \\,dx = \\int_{-1}^{1} (L_2^2 - 2L_2L_0 + L_0^2) \\,dx$. Due to orthogonality, $\\int L_2L_0 \\,dx = 0$.\n$M_{00} = \\int_{-1}^{1} L_2^2 \\,dx + \\int_{-1}^{1} L_0^2 \\,dx = \\frac{2}{2(2)+1} + \\frac{2}{2(0)+1} = \\frac{2}{5} + 2 = \\frac{12}{5}$.\n$M_{11} = \\int_{-1}^{1} (\\phi_1(x))^2 \\,dx = \\int_{-1}^{1} (L_3(x)-L_1(x))^2 \\,dx = \\int_{-1}^{1} L_3^2 \\,dx + \\int_{-1}^{1} L_1^2 \\,dx = \\frac{2}{2(3)+1} + \\frac{2}{2(1)+1} = \\frac{2}{7} + \\frac{2}{3} = \\frac{6+14}{21} = \\frac{20}{21}$.\n$M_{01} = M_{10} = \\int_{-1}^{1} (L_2(x)-L_0(x))(L_3(x)-L_1(x)) \\,dx = 0$, due to the orthogonality of Legendre polynomials of different parity.\nThus, the mass matrix is $M = \\begin{pmatrix} 12/5 & 0 \\\\ 0 & 20/21 \\end{pmatrix}$.\n\nThe matrices $K$ and $M$ are diagonal because the basis functions were chosen to have definite parity (even/odd), which separates the problem into two uncoupled subproblems corresponding to even and odd eigenfunctions. The even basis function $\\phi_0(x)$ approximates the first (even) eigenfunction of the continuous problem, and the odd basis function $\\phi_1(x)$ approximates the second (odd) eigenfunction.\nThe generalized eigenvalue problem $K \\mathbf{a} = \\lambda_h M \\mathbf{a}$ simplifies to:\n$\\lambda_{h,1} = \\frac{K_{00}}{M_{00}} = \\frac{6}{12/5} = \\frac{30}{12} = \\frac{5}{2}$.\n$\\lambda_{h,2} = \\frac{K_{11}}{M_{11}} = \\frac{10}{20/21} = \\frac{210}{20} = \\frac{21}{2}$.\nThese are the Rayleigh-Ritz approximations for the first two eigenvalues.\n\nRegarding the Petrov-Galerkin method, the defining characteristic is the use of a test space $W_h$ that is different from the trial space $V_h$. The query asks about a \"Petrov Galerkin choice with the same two boundary-vanishing test functions\". This implies using a test space spanned by $\\{\\phi_0, \\phi_1\\}$, which is identical to the trial space $V_h = \\text{span}\\{\\phi_0, \\phi_1\\}$. When the test space and trial space are the same ($W_h=V_h$), the method is, by definition, the Bubnov-Galerkin method. Therefore, the resulting discrete spectrum would be identical. For a self-adjoint problem like this one, the symmetric bilinear form $a(u,v)$ makes the Bubnov-Galerkin method the natural choice, guaranteeing real eigenvalues that are upper bounds on the true eigenvalues (Rayleigh-Ritz principle). A genuine Petrov-Galerkin method ($W_h \\neq V_h$) would generally lead to non-symmetric matrices and a different, less optimal, discrete spectrum.\n\nFinally, we compute the dimensionless quantity $\\Pi$:\n$$\n\\Pi := \\left(\\frac{\\lambda_{h,1}}{\\pi^{2}/4}\\right)\\left(\\frac{\\lambda_{h,2}}{\\pi^{2}}\\right)\n$$\nSubstituting the computed eigenvalues $\\lambda_{h,1} = 5/2$ and $\\lambda_{h,2} = 21/2$:\n$$\n\\Pi = \\left(\\frac{5/2}{\\pi^{2}/4}\\right)\\left(\\frac{21/2}{\\pi^{2}}\\right) = \\left(\\frac{5}{2} \\cdot \\frac{4}{\\pi^2}\\right)\\left(\\frac{21}{2\\pi^2}\\right) = \\left(\\frac{10}{\\pi^2}\\right)\\left(\\frac{21}{2\\pi^2}\\right) = \\frac{210}{2\\pi^4} = \\frac{105}{\\pi^4}.\n$$", "answer": "$$\\boxed{\\frac{105}{\\pi^4}}$$", "id": "3368169"}, {"introduction": "While the Bubnov-Galerkin method provides a natural and robust formulation for self-adjoint problems, its choice of identical trial and test spaces is not the only option. The Petrov-Galerkin framework offers the freedom to design test functions strategically to achieve specific desirable properties in the discrete system. This practice [@problem_id:3368122] is a design exercise where you will construct a specialized polynomial test space that diagonalizes the stiffness matrix for the Laplacian operator, illustrating the power and elegance of the Petrov-Galerkin approach for simplifying discrete systems.", "problem": "Consider a single spectral element and the second-order self-adjoint operator $-\\frac{d^{2}}{dx^{2}}$ acting on a scalar field $u(x)$ on the interval $[-1,1]$ with homogeneous Neumann boundary conditions on the physical problem. In the standard weak form, the bilinear form associated with the operator is $a(u,v)=\\int_{-1}^{1} u'(x)\\,v'(x)\\,dx$, defined on a suitable subspace of the Sobolev space $H^{1}([-1,1])$. In Discontinuous Galerkin (DG) methods, modal spectral bases are commonly used per element; here we focus on constructing Petrov–Galerkin trial/test pairs that diagonalize the elemental stiffness matrix corresponding to $a(\\cdot,\\cdot)$.\n\nLet the trial space on $[-1,1]$ be the polynomial span $\\mathcal{S}_{N}=\\operatorname{span}\\{L_{n}(x):n=1,\\dots,N\\}$, where $L_{n}(x)$ denotes the Legendre polynomial of degree $n$ (the degree-zero constant mode is excluded due to the Neumann nullspace). Construct a Petrov–Galerkin test space $\\mathcal{T}_{N}=\\operatorname{span}\\{V_{n}(x):n=1,\\dots,N\\}$ such that each test function $V_{n}(x)$ is a polynomial satisfying $-V_{n}''(x)=L_{n}(x)$ and $V_{n}'(-1)=V_{n}'(1)=0$. Using only fundamental properties of Legendre polynomials and the bilinear form, derive the form of the stiffness matrix entries $A_{mn}=a(L_{n},V_{m})$ and prove that the matrix is diagonal.\n\nOn $[0,1]$, define the shifted Legendre polynomials $\\widetilde{L}_{n}(x)=L_{n}(2x-1)$ and repeat the Petrov–Galerkin construction with the trial space $\\widetilde{\\mathcal{S}}_{N}=\\operatorname{span}\\{\\widetilde{L}_{n}(x):n=1,\\dots,N\\}$ and test functions $\\widetilde{V}_{n}(x)$ satisfying $-\\widetilde{V}_{n}''(x)=\\widetilde{L}_{n}(x)$ and $\\widetilde{V}_{n}'(0)=\\widetilde{V}_{n}'(1)=0$. Derive the corresponding stiffness matrix entries $\\widetilde{A}_{mn}$ and prove diagonalization.\n\nDefine the spectral condition number of the diagonalized stiffness matrix on the reduced (mean-zero) subspace as the ratio of the largest to the smallest diagonal entry. Compute this condition number $\\kappa(N)$ explicitly as a closed-form expression in $N$. Your final answer must be a single analytic expression. If you use numerical constants, keep them exact; no rounding is required.", "solution": "The problem is first validated to ensure it is scientifically grounded, well-posed, and objective.\n\n### Step 1: Extract Givens\n- **Operator and Domain 1**: The second-order operator is $-\\frac{d^{2}}{dx^{2}}$ on the interval $[-1,1]$.\n- **Bilinear Form**: $a(u,v)=\\int_{-1}^{1} u'(x)\\,v'(x)\\,dx$.\n- **Trial Space on $[-1,1]$**: $\\mathcal{S}_{N}=\\operatorname{span}\\{L_{n}(x):n=1,\\dots,N\\}$, where $L_{n}(x)$ are Legendre polynomials.\n- **Test Space on $[-1,1]$**: $\\mathcal{T}_{N}=\\operatorname{span}\\{V_{n}(x):n=1,\\dots,N\\}$.\n- **Test Function Definition on $[-1,1]$**: For each $n$, $V_{n}(x)$ is a polynomial satisfying $-V_{n}''(x)=L_{n}(x)$ and $V_{n}'(-1)=V_{n}'(1)=0$.\n- **Stiffness Matrix on $[-1,1]$**: $A_{mn}=a(L_{n},V_{m})$.\n- **Task 1**: Derive $A_{mn}$ and prove the matrix is diagonal.\n- **Domain 2**: The interval $[0,1]$.\n- **Shifted Trial Functions**: $\\widetilde{L}_{n}(x)=L_{n}(2x-1)$, spanning $\\widetilde{\\mathcal{S}}_{N}$.\n- **Shifted Test Functions**: $\\widetilde{V}_{n}(x)$ satisfying $-\\widetilde{V}_{n}''(x)=\\widetilde{L}_{n}(x)$ and $\\widetilde{V}_{n}'(0)=\\widetilde{V}_{n}'(1)=0$.\n- **Stiffness Matrix on $[0,1]$**: $\\widetilde{A}_{mn}=a(\\widetilde{L}_{n},\\widetilde{V}_{m})=\\int_{0}^{1} \\widetilde{L}_{n}'(x)\\,\\widetilde{V}_{m}'(x)\\,dx$.\n- **Task 2**: Derive $\\widetilde{A}_{mn}$ and prove the matrix is diagonal.\n- **Condition Number**: The spectral condition number $\\kappa(N)$ is the ratio of the largest to the smallest diagonal entry of the stiffness matrix.\n- **Task 3**: Compute $\\kappa(N)$ as a closed-form expression in $N$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically sound, located squarely within the mathematical discipline of numerical analysis, specifically the theory of spectral and discontinuous Galerkin methods. The given elements—Legendre polynomials, Sobolev spaces, and Petrov-Galerkin formulations—are standard concepts. The construction of the test space is a well-known technique to diagonalize operator matrices. The problem is well-posed, with sufficient information provided to derive the requested quantities. The language is objective and precise. The problem does not violate any of the specified invalidity criteria.\n\n### Step 3: Verdict and Action\nThe problem is valid. A complete solution will be provided.\n\n### Solution Derivation\n\nThe solution proceeds in three parts as requested by the problem statement.\n\n**Part 1: Stiffness Matrix on $[-1,1]$**\n\nThe entries of the stiffness matrix $A$ are given by the bilinear form $A_{mn} = a(L_{n}, V_{m})$.\n$$A_{mn} = \\int_{-1}^{1} L_{n}'(x) V_{m}'(x) dx$$\nWe apply integration by parts to this integral, with $u=V_{m}'(x)$ and $dv=L_{n}'(x)dx$. This gives $du=V_{m}''(x)dx$ and $v=L_{n}(x)$.\n$$A_{mn} = \\left[ V_{m}'(x) L_{n}(x) \\right]_{-1}^{1} - \\int_{-1}^{1} L_{n}(x) V_{m}''(x) dx$$\nThe boundary term is evaluated as:\n$$\\left[ V_{m}'(x) L_{n}(x) \\right]_{-1}^{1} = V_{m}'(1) L_{n}(1) - V_{m}'(-1) L_{n}(-1)$$\nFrom the definition of the test functions $V_{m}(x)$, we are given the homogeneous Neumann boundary conditions $V_{m}'(1) = 0$ and $V_{m}'(-1) = 0$. Therefore, the boundary term vanishes for all $n$ and $m$.\nThe expression for $A_{mn}$ simplifies to:\n$$A_{mn} = - \\int_{-1}^{1} L_{n}(x) V_{m}''(x) dx$$\nNext, we use the second defining property of the test functions, which is the differential equation $-V_{m}''(x) = L_{m}(x)$. Substituting this into the integral yields:\n$$A_{mn} = \\int_{-1}^{1} L_{n}(x) L_{m}(x) dx$$\nThis integral is the standard inner product of Legendre polynomials on the interval $[-1,1]$. A fundamental property of Legendre polynomials is their orthogonality with respect to this inner product:\n$$\\int_{-1}^{1} L_{n}(x) L_{m}(x) dx = \\frac{2}{2n+1} \\delta_{mn}$$\nwhere $\\delta_{mn}$ is the Kronecker delta.\nThus, the entries of the stiffness matrix are:\n$$A_{mn} = \\frac{2}{2n+1} \\delta_{mn}$$\nThis result shows that the matrix $A$ is diagonal, as $A_{mn} = 0$ for $m \\neq n$. The diagonal entries are $A_{nn} = \\frac{2}{2n+1}$ for $n=1, \\dots, N$. This completes the first part of the problem.\n\n**Part 2: Stiffness Matrix on $[0,1]$**\n\nFor the second part, we consider the interval $[0,1]$ and the shifted basis functions. The stiffness matrix entries are $\\widetilde{A}_{mn} = \\int_{0}^{1} \\widetilde{L}_{n}'(x) \\widetilde{V}_{m}'(x) dx$.\nThe derivation follows the same procedure. We use integration by parts with $u = \\widetilde{V}_{m}'(x)$ and $dv = \\widetilde{L}_{n}'(x)dx$.\n$$\\widetilde{A}_{mn} = \\left[ \\widetilde{V}_{m}'(x) \\widetilde{L}_{n}(x) \\right]_{0}^{1} - \\int_{0}^{1} \\widetilde{L}_{n}(x) \\widetilde{V}_{m}''(x) dx$$\nThe given boundary conditions for the shifted test functions are $\\widetilde{V}_{m}'(0) = 0$ and $\\widetilde{V}_{m}'(1) = 0$. This causes the boundary term to vanish.\n$$\\widetilde{A}_{mn} = - \\int_{0}^{1} \\widetilde{L}_{n}(x) \\widetilde{V}_{m}''(x) dx$$\nUsing the defining differential equation $-\\widetilde{V}_{m}''(x) = \\widetilde{L}_{m}(x)$, we obtain:\n$$\\widetilde{A}_{mn} = \\int_{0}^{1} \\widetilde{L}_{n}(x) \\widetilde{L}_{m}(x) dx$$\nTo evaluate this integral, we substitute the definition $\\widetilde{L}_{k}(x) = L_{k}(2x-1)$ and perform a change of variables. Let $\\xi = 2x - 1$. Then $d\\xi = 2dx$, or $dx = \\frac{1}{2}d\\xi$. The limits of integration change as follows: when $x=0$, $\\xi=-1$; when $x=1$, $\\xi=1$.\n$$\\widetilde{A}_{mn} = \\int_{-1}^{1} L_{n}(\\xi) L_{m}(\\xi) \\left(\\frac{1}{2} d\\xi\\right) = \\frac{1}{2} \\int_{-1}^{1} L_{n}(\\xi) L_{m}(\\xi) d\\xi$$\nUsing the standard orthogonality property of Legendre polynomials again:\n$$\\widetilde{A}_{mn} = \\frac{1}{2} \\left( \\frac{2}{2n+1} \\delta_{mn} \\right) = \\frac{1}{2n+1} \\delta_{mn}$$\nThis proves that the stiffness matrix $\\widetilde{A}$ for the shifted problem is also diagonal, with entries $\\widetilde{A}_{nn} = \\frac{1}{2n+1}$ for $n=1, \\dots, N$.\n\n**Part 3: Spectral Condition Number**\n\nThe spectral condition number $\\kappa(N)$ of the diagonalized stiffness matrix is defined as the ratio of its largest to its smallest diagonal entry (eigenvalue). We can use either matrix $A$ or $\\widetilde{A}$, as the condition number will be identical. Let's use the diagonal entries of $A$, which are $\\lambda_n = A_{nn} = \\frac{2}{2n+1}$ for $n \\in \\{1, 2, \\dots, N\\}$.\nThe function $f(n) = \\frac{2}{2n+1}$ is a strictly decreasing function for positive $n$.\nTherefore, the largest eigenvalue, $\\lambda_{\\max}$, occurs at the smallest index, $n=1$:\n$$\\lambda_{\\max} = \\lambda_1 = \\frac{2}{2(1)+1} = \\frac{2}{3}$$\nThe smallest eigenvalue, $\\lambda_{\\min}$, occurs at the largest index, $n=N$:\n$$\\lambda_{\\min} = \\lambda_N = \\frac{2}{2N+1}$$\nThe spectral condition number $\\kappa(N)$ is the ratio of these two values:\n$$\\kappa(N) = \\frac{\\lambda_{\\max}}{\\lambda_{\\min}} = \\frac{2/3}{2/(2N+1)}$$\n$$\\kappa(N) = \\frac{2}{3} \\cdot \\frac{2N+1}{2} = \\frac{2N+1}{3}$$\nThis is the closed-form expression for the condition number as a function of $N$.", "answer": "$$\\boxed{\\frac{2N+1}{3}}$$", "id": "3368122"}, {"introduction": "Bridging theory and practice, the implementation of Galerkin methods invariably involves numerical quadrature to approximate the integrals in the weak form. This approximation can have profound effects on the properties of the resulting discrete system. This final exercise [@problem_id:3368113] delves into these practical considerations, examining how the interplay between a simple quadrature rule and the choice of test functions (Bubnov vs. Petrov) impacts the symmetric positive-definiteness of the mass matrix and, consequently, the numerical stability of an associated time-dependent problem.", "problem": "Consider the one-dimensional reference element $\\Omega = [-1,1]$ with a two-dimensional polynomial approximation space. Let the trial basis be $\\{\\phi_{0}(x),\\phi_{1}(x)\\} = \\{1,x\\}$. Define two Galerkin variants using the same two-point symmetric quadrature:\n- Quadrature nodes at $x=\\pm \\xi$ with $0<\\xi\\leq 1$ and equal weights $1$ at each node. Thus, for any integrand $g(x)$, the quadrature approximation is $\\int_{-1}^{1} g(x)\\,\\mathrm{d}x \\approx g(\\xi)+g(-\\xi)$.\n- Bubnov Galerkin uses the test basis equal to the trial basis, i.e., $\\{\\psi_{0}(x),\\psi_{1}(x)\\} = \\{1,x\\}$.\n- Petrov Galerkin uses a non-orthogonal test basis $\\{\\psi_{0}(x),\\psi_{1}(x)\\} = \\{1,x+\\alpha\\}$ with a real parameter $\\alpha\\in\\mathbb{R}$.\n\nLet the semi-discrete system approximate a diffusion process with diffusivity $\\kappa>0$ via the bilinear form $a(u,v) = \\kappa\\int_{-1}^{1} u_{x} v_{x}\\,\\mathrm{d}x$, discretized by the same quadrature. Denote by $M$ the discrete mass matrix with entries $M_{ij} = \\sum_{q} w_{q}\\,\\psi_{i}(x_{q})\\,\\phi_{j}(x_{q})$, and by $C$ the discrete stiffness matrix with entries $C_{ij} = \\sum_{q} w_{q}\\,\\kappa\\,\\phi_{j}'(x_{q})\\,\\psi_{i}'(x_{q})$. Consider the semi-discrete ordinary differential equation $M\\,\\dot{\\boldsymbol{u}}(t) = -\\,C\\,\\boldsymbol{u}(t)$.\n\nTasks:\n1. Starting from the definitions above, derive the Bubnov Galerkin mass matrix $M^{B}$ and show when it is symmetric positive definite in terms of $\\xi$. Compute the associated stiffness matrix $C^{B}$.\n2. For the Petrov Galerkin case, derive the mass matrix $M^{P}$ and its symmetric part $M^{\\mathrm{sym}} = \\tfrac{1}{2}\\left(M^{P} + (M^{P})^{\\top}\\right)$. State the necessary and sufficient condition on $\\alpha$ and $\\xi$ for $M^{\\mathrm{sym}}$ to be symmetric positive definite.\n3. Assume the explicit forward Euler method is applied to the symmetrized Petrov system $M^{\\mathrm{sym}}\\,\\dot{\\boldsymbol{u}}(t) = -\\,C^{P}\\,\\boldsymbol{u}(t)$. Using an energy method based on the inner product induced by $M^{\\mathrm{sym}}$, derive the largest admissible time step $\\Delta t_{\\max}$ that guarantees non-increasing discrete energy $E(\\boldsymbol{u}) = \\tfrac{1}{2}\\,\\boldsymbol{u}^{\\top} M^{\\mathrm{sym}} \\boldsymbol{u}$ for every step. Express your final answer as a closed-form analytic expression in terms of $\\kappa$, $\\xi$, and $\\alpha$. State your result for $\\Delta t_{\\max}$ in the same time units as $t$.\n\nYour final answer must be a single closed-form analytic expression for $\\Delta t_{\\max}$.", "solution": "The problem statement is subjected to validation and is found to be valid. It is scientifically grounded in the theory of numerical methods for differential equations, specifically spectral and discontinuous Galerkin methods. The problem is well-posed, objective, self-contained, and all terms are formally defined. No inconsistencies, contradictions, or unrealistic assumptions are present. We may therefore proceed with the solution.\n\nThe problem is divided into three tasks. We will address them in sequence.\n\nThe foundational elements are:\n- The domain $\\Omega = [-1, 1]$.\n- The trial basis functions $\\{\\phi_{0}(x), \\phi_{1}(x)\\} = \\{1, x\\}$, with derivatives $\\{\\phi_{0}'(x), \\phi_{1}'(x)\\} = \\{0, 1\\}$.\n- A two-point symmetric quadrature rule with nodes $x_q \\in \\{\\xi, -\\xi\\}$ and weights $w_q=1$. The quadrature approximation is $\\int_{-1}^{1} g(x)\\,\\mathrm{d}x \\approx g(\\xi) + g(-\\xi)$. The parameter $\\xi$ satisfies $0 < \\xi \\leq 1$.\n\n**Task 1: Bubnov-Galerkin Analysis**\nIn the Bubnov-Galerkin method, the test basis is identical to the trial basis: $\\{\\psi_{0}(x), \\psi_{1}(x)\\} = \\{1, x\\}$. The derivatives are $\\{\\psi_{0}'(x), \\psi_{1}'(x)\\} = \\{0, 1\\}$.\n\nThe discrete mass matrix $M^B$ has entries $M_{ij}^{B} = \\sum_{q} w_{q}\\,\\psi_{i}(x_{q})\\,\\phi_{j}(x_{q}) = \\psi_{i}(\\xi)\\phi_{j}(\\xi) + \\psi_{i}(-\\xi)\\phi_{j}(-\\xi)$.\n- $M_{00}^{B} = \\psi_{0}(\\xi)\\phi_{0}(\\xi) + \\psi_{0}(-\\xi)\\phi_{0}(-\\xi) = (1)(1) + (1)(1) = 2$.\n- $M_{01}^{B} = \\psi_{0}(\\xi)\\phi_{1}(\\xi) + \\psi_{0}(-\\xi)\\phi_{1}(-\\xi) = (1)(\\xi) + (1)(-\\xi) = 0$.\n- $M_{10}^{B} = \\psi_{1}(\\xi)\\phi_{0}(\\xi) + \\psi_{1}(-\\xi)\\phi_{0}(-\\xi) = (\\xi)(1) + (-\\xi)(1) = 0$.\n- $M_{11}^{B} = \\psi_{1}(\\xi)\\phi_{1}(\\xi) + \\psi_{1}(-\\xi)\\phi_{1}(-\\xi) = (\\xi)(\\xi) + (-\\xi)(-\\xi) = \\xi^2 + \\xi^2 = 2\\xi^2$.\nThe Bubnov-Galerkin mass matrix is $M^{B} = \\begin{pmatrix} 2 & 0 \\\\ 0 & 2\\xi^2 \\end{pmatrix}$.\nFor $M^{B}$ to be symmetric positive definite (SPD), it must be symmetric and all its eigenvalues must be positive. As $M^{B}$ is a diagonal matrix, it is symmetric, and its eigenvalues are its diagonal entries. The conditions for positive definiteness are $2 > 0$ and $2\\xi^2 > 0$. The first condition is always true. Since the problem specifies $0 < \\xi \\leq 1$, we have $\\xi \\neq 0$, which implies $\\xi^2 > 0$. Therefore, $M^B$ is SPD for all permissible values of $\\xi$.\n\nThe discrete stiffness matrix $C^B$ has entries $C_{ij}^{B} = \\sum_{q} w_{q}\\,\\kappa\\,\\phi_{j}'(x_{q})\\,\\psi_{i}'(x_{q}) = \\kappa(\\phi_{j}'(\\xi)\\psi_{i}'(\\xi) + \\phi_{j}'(-\\xi)\\psi_{i}'(-\\xi))$.\n- $C_{00}^{B} = \\kappa(\\phi_{0}'(\\xi)\\psi_{0}'(\\xi) + \\phi_{0}'(-\\xi)\\psi_{0}'(-\\xi)) = \\kappa((0)(0) + (0)(0)) = 0$.\n- $C_{01}^{B} = \\kappa(\\phi_{1}'(\\xi)\\psi_{0}'(\\xi) + \\phi_{1}'(-\\xi)\\psi_{0}'(-\\xi)) = \\kappa((1)(0) + (1)(0)) = 0$.\n- $C_{10}^{B} = \\kappa(\\phi_{0}'(\\xi)\\psi_{1}'(\\xi) + \\phi_{0}'(-\\xi)\\psi_{1}'(-\\xi)) = \\kappa((0)(1) + (0)(1)) = 0$.\n- $C_{11}^{B} = \\kappa(\\phi_{1}'(\\xi)\\psi_{1}'(\\xi) + \\phi_{1}'(-\\xi)\\psi_{1}'(-\\xi)) = \\kappa((1)(1) + (1)(1)) = 2\\kappa$.\nThe Bubnov-Galerkin stiffness matrix is $C^{B} = \\begin{pmatrix} 0 & 0 \\\\ 0 & 2\\kappa \\end{pmatrix}$.\n\n**Task 2: Petrov-Galerkin Analysis**\nIn this case, the test basis is $\\{\\psi_{0}(x), \\psi_{1}(x)\\} = \\{1, x+\\alpha\\}$. The derivatives are $\\{\\psi_{0}'(x), \\psi_{1}'(x)\\} = \\{0, 1\\}$, which are identical to the Bubnov-Galerkin case.\n\nThe Petrov-Galerkin mass matrix $M^P$ has entries $M^P_{ij} = \\psi_{i}(\\xi)\\phi_{j}(\\xi) + \\psi_{i}(-\\xi)\\phi_{j}(-\\xi)$.\n- $M_{00}^{P} = \\psi_{0}(\\xi)\\phi_{0}(\\xi) + \\psi_{0}(-\\xi)\\phi_{0}(-\\xi) = (1)(1) + (1)(1) = 2$.\n- $M_{01}^{P} = \\psi_{0}(\\xi)\\phi_{1}(\\xi) + \\psi_{0}(-\\xi)\\phi_{1}(-\\xi) = (1)(\\xi) + (1)(-\\xi) = 0$.\n- $M_{10}^{P} = \\psi_{1}(\\xi)\\phi_{0}(\\xi) + \\psi_{1}(-\\xi)\\phi_{0}(-\\xi) = (\\xi+\\alpha)(1) + (-\\xi+\\alpha)(1) = 2\\alpha$.\n- $M_{11}^{P} = \\psi_{1}(\\xi)\\phi_{1}(\\xi) + \\psi_{1}(-\\xi)\\phi_{1}(-\\xi) = (\\xi+\\alpha)(\\xi) + (-\\xi+\\alpha)(-\\xi) = \\xi^2 + \\alpha\\xi + \\xi^2 - \\alpha\\xi = 2\\xi^2$.\nThe Petrov-Galerkin mass matrix is $M^{P} = \\begin{pmatrix} 2 & 0 \\\\ 2\\alpha & 2\\xi^2 \\end{pmatrix}$.\n\nThe symmetric part of $M^P$ is $M^{\\mathrm{sym}} = \\frac{1}{2}(M^P + (M^P)^{\\top})$.\n$M^{\\mathrm{sym}} = \\frac{1}{2} \\left( \\begin{pmatrix} 2 & 0 \\\\ 2\\alpha & 2\\xi^2 \\end{pmatrix} + \\begin{pmatrix} 2 & 2\\alpha \\\\ 0 & 2\\xi^2 \\end{pmatrix} \\right) = \\frac{1}{2} \\begin{pmatrix} 4 & 2\\alpha \\\\ 2\\alpha & 4\\xi^2 \\end{pmatrix} = \\begin{pmatrix} 2 & \\alpha \\\\ \\alpha & 2\\xi^2 \\end{pmatrix}$.\nFor $M^{\\mathrm{sym}}$ to be SPD, by Sylvester's criterion, its leading principal minors must be positive.\n1. The first minor is $2 > 0$, which is always true.\n2. The second minor is the determinant: $\\det(M^{\\mathrm{sym}}) = (2)(2\\xi^2) - (\\alpha)(\\alpha) = 4\\xi^2 - \\alpha^2$.\nThis must be positive: $4\\xi^2 - \\alpha^2 > 0$, which implies $4\\xi^2 > \\alpha^2$. Taking the square root of both sides gives $2|\\xi| > |\\alpha|$. Since $0 < \\xi \\leq 1$, this simplifies to $2\\xi > |\\alpha|$, or $-2\\xi < \\alpha < 2\\xi$. This is the necessary and sufficient condition for $M^{\\mathrm{sym}}$ to be SPD.\n\n**Task 3: Stability Analysis**\nWe analyze the symmetrized system $M^{\\mathrm{sym}}\\,\\dot{\\boldsymbol{u}}(t) = -\\,C^{P}\\,\\boldsymbol{u}(t)$. The stiffness matrix $C^P$ is computed using the PG test basis derivatives. As shown, $\\{\\psi'_0, \\psi'_1\\} = \\{0, 1\\}$, which is the same as for BG. Thus, $C^P = C^B = \\begin{pmatrix} 0 & 0 \\\\ 0 & 2\\kappa \\end{pmatrix}$.\n\nThe explicit forward Euler method for $\\dot{\\boldsymbol{y}} = \\boldsymbol{f}(\\boldsymbol{y})$ is $\\boldsymbol{y}^{n+1} = \\boldsymbol{y}^n + \\Delta t \\, \\boldsymbol{f}(\\boldsymbol{y}^n)$. For our system, $\\dot{\\boldsymbol{u}} = -(M^{\\mathrm{sym}})^{-1}C^P\\boldsymbol{u}$, so the update rule is:\n$\\boldsymbol{u}^{n+1} = \\boldsymbol{u}^n - \\Delta t (M^{\\mathrm{sym}})^{-1} C^P \\boldsymbol{u}^n$.\n\nThe discrete energy is $E(\\boldsymbol{u}) = \\frac{1}{2}\\,\\boldsymbol{u}^{\\top} M^{\\mathrm{sym}} \\boldsymbol{u}$. The stability condition is non-increasing energy, $E(\\boldsymbol{u}^{n+1}) \\leq E(\\boldsymbol{u}^n)$.\n$(\\boldsymbol{u}^{n+1})^{\\top} M^{\\mathrm{sym}} \\boldsymbol{u}^{n+1} \\leq (\\boldsymbol{u}^{n})^{\\top} M^{\\mathrm{sym}} \\boldsymbol{u}^{n}$.\nSubstituting the update rule for $\\boldsymbol{u}^{n+1}$:\n$(\\boldsymbol{u}^n - \\Delta t (M^{\\mathrm{sym}})^{-1} C^P \\boldsymbol{u}^n)^{\\top} M^{\\mathrm{sym}} (\\boldsymbol{u}^n - \\Delta t (M^{\\mathrm{sym}})^{-1} C^P \\boldsymbol{u}^n) \\leq (\\boldsymbol{u}^{n})^{\\top} M^{\\mathrm{sym}} \\boldsymbol{u}^{n}$.\nExpanding the left-hand side (LHS):\nLHS $= (\\boldsymbol{u}^n)^{\\top} M^{\\mathrm{sym}} \\boldsymbol{u}^n - \\Delta t (\\boldsymbol{u}^n)^{\\top} (C^P)^{\\top} (M^{\\mathrm{sym}})^{-1} M^{\\mathrm{sym}} \\boldsymbol{u}^n - \\Delta t (\\boldsymbol{u}^n)^{\\top} M^{\\mathrm{sym}} (M^{\\mathrm{sym}})^{-1} C^P \\boldsymbol{u}^n + (\\Delta t)^2 (\\boldsymbol{u}^n)^{\\top} (C^P)^{\\top} (M^{\\mathrm{sym}})^{-1} M^{\\mathrm{sym}} (M^{\\mathrm{sym}})^{-1} C^P \\boldsymbol{u}^n$.\nSince $M^{\\mathrm{sym}}$ and $C^P$ are symmetric, this simplifies to:\nLHS $= (\\boldsymbol{u}^n)^{\\top} M^{\\mathrm{sym}} \\boldsymbol{u}^n - 2\\Delta t (\\boldsymbol{u}^n)^{\\top} C^P \\boldsymbol{u}^n + (\\Delta t)^2 (\\boldsymbol{u}^n)^{\\top} C^P (M^{\\mathrm{sym}})^{-1} C^P \\boldsymbol{u}^n$.\nThe stability inequality becomes:\n$-2\\Delta t (\\boldsymbol{u}^n)^{\\top} C^P \\boldsymbol{u}^n + (\\Delta t)^2 (\\boldsymbol{u}^n)^{\\top} C^P (M^{\\mathrm{sym}})^{-1} C^P \\boldsymbol{u}^n \\leq 0$.\nThis must hold for any vector $\\boldsymbol{u}^n$. If $\\boldsymbol{u}^n$ is in the null space of $C^P$, the inequality becomes $0 \\leq 0$, which is trivially satisfied. For any $\\boldsymbol{u}^n$ not in the null space of $C^P$, we can divide by $(\\boldsymbol{u}^n)^{\\top} C^P \\boldsymbol{u}^n$ (which is positive since $C^P$ is positive semi-definite and $\\boldsymbol{u}^n$ is not in its null space) and rearrange to find a bound on $\\Delta t$:\n$\\Delta t \\leq \\frac{2 (\\boldsymbol{u}^n)^{\\top} C^P \\boldsymbol{u}^n}{(\\boldsymbol{u}^n)^{\\top} C^P (M^{\\mathrm{sym}})^{-1} C^P \\boldsymbol{u}^n}$.\n\nTo find the most restrictive time step, we must find the minimum of the right-hand side over all $\\boldsymbol{u}^n$ not in the null space of $C^P$.\nLet $\\boldsymbol{u}^n = (u_0, u_1)^{\\top}$.\nThe numerator is $2 (\\boldsymbol{u}^n)^{\\top} C^P \\boldsymbol{u}^n = 2 \\begin{pmatrix} u_0 & u_1 \\end{pmatrix} \\begin{pmatrix} 0 & 0 \\\\ 0 & 2\\kappa \\end{pmatrix} \\begin{pmatrix} u_0 \\\\ u_1 \\end{pmatrix} = 4\\kappa u_1^2$.\nFor the denominator, we first find $(M^{\\mathrm{sym}})^{-1}$:\n$(M^{\\mathrm{sym}})^{-1} = \\frac{1}{\\det(M^{\\mathrm{sym}})} \\begin{pmatrix} 2\\xi^2 & -\\alpha \\\\ -\\alpha & 2 \\end{pmatrix} = \\frac{1}{4\\xi^2 - \\alpha^2} \\begin{pmatrix} 2\\xi^2 & -\\alpha \\\\ -\\alpha & 2 \\end{pmatrix}$.\nAnd we compute $C^P \\boldsymbol{u}^n = \\begin{pmatrix} 0 \\\\ 2\\kappa u_1 \\end{pmatrix}$.\nThe denominator term is $(C^P \\boldsymbol{u}^n)^{\\top} (M^{\\mathrm{sym}})^{-1} (C^P \\boldsymbol{u}^n)$:\n$= \\begin{pmatrix} 0 & 2\\kappa u_1 \\end{pmatrix} \\frac{1}{4\\xi^2 - \\alpha^2} \\begin{pmatrix} 2\\xi^2 & -\\alpha \\\\ -\\alpha & 2 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 2\\kappa u_1 \\end{pmatrix}$\n$= \\frac{1}{4\\xi^2 - \\alpha^2} \\begin{pmatrix} -2\\alpha\\kappa u_1 & 4\\kappa u_1 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 2\\kappa u_1 \\end{pmatrix}$\n$= \\frac{1}{4\\xi^2 - \\alpha^2} (4\\kappa u_1)(2\\kappa u_1) = \\frac{8\\kappa^2 u_1^2}{4\\xi^2 - \\alpha^2}$.\nSubstituting these into the inequality for $\\Delta t$:\n$\\Delta t \\leq \\frac{4\\kappa u_1^2}{\\frac{8\\kappa^2 u_1^2}{4\\xi^2 - \\alpha^2}}$.\nFor $u_1 \\neq 0$, we can cancel terms:\n$\\Delta t \\leq \\frac{4\\kappa u_1^2 (4\\xi^2 - \\alpha^2)}{8\\kappa^2 u_1^2} = \\frac{4\\xi^2 - \\alpha^2}{2\\kappa}$.\nThis upper bound is independent of the choice of $\\boldsymbol{u}^n$ (as long as it is not in the null space of $C^P$). Thus, it is the most restrictive bound.\nThe largest admissible time step is $\\Delta t_{\\max} = \\frac{4\\xi^2 - \\alpha^2}{2\\kappa}$. This is valid under the condition $4\\xi^2 - \\alpha^2 > 0$ required for $M^{\\mathrm{sym}}$ to be SPD, ensuring $\\Delta t_{\\max} > 0$.", "answer": "$$\n\\boxed{\\frac{4\\xi^{2} - \\alpha^{2}}{2\\kappa}}\n$$", "id": "3368113"}]}