{"hands_on_practices": [{"introduction": "The first step in applying Hamilton's principle to a continuous system is performing a spatial discretization to obtain a finite-dimensional representation. This practice focuses on the kinetic energy term, showing how to derive the variationally consistent mass matrix from first principles using finite element shape functions. You will then contrast this with the computationally efficient lumped mass matrix, providing a concrete understanding of how variational principles are often approximated in practice [@problem_id:3569540].", "problem": "Consider a single four-node bilinear quadrilateral finite element in the reference configuration, modeling a homogeneous, isotropic elastic solid undergoing small motions without external forces. The reference domain is the unit square with out-of-plane thickness, that is, $\\Omega_0 = \\{(X,Y) \\mid 0 \\leq X \\leq 1, \\ 0 \\leq Y \\leq 1\\}$ and thickness $t_0 = 0.01 \\ \\mathrm{m}$ in the third direction. The material has constant mass density $\\rho_0 = 7800 \\ \\mathrm{kg/m^3}$. Let a single Cartesian component of the displacement be discretized by the standard four-node bilinear shape functions\n$$\nN_1(X,Y) = (1 - X)(1 - Y), \\quad\nN_2(X,Y) = X(1 - Y), \\quad\nN_3(X,Y) = XY, \\quad\nN_4(X,Y) = (1 - X)Y,\n$$\nso that the discrete field is $u(X,Y,t) = \\sum_{i=1}^{4} N_i(X,Y) \\, q_i(t)$ with generalized coordinates $q_i(t)$.\n\nStarting from Hamilton’s principle for dynamics, derive the semidiscrete equations of motion for this element by using the exact kinetic energy integral over $\\Omega_0$ (with the given thickness) and obtain the consistent element mass matrix entries from first principles. Then, construct the diagonal lumped mass matrix by the row-sum technique, and explain, in terms of the semidiscrete energy arising from Hamilton’s principle, the consequence of mass lumping for energy conservation in the absence of external forces.\n\nFinally, for the nodal velocity vector $\\dot{\\boldsymbol{q}} = \\begin{pmatrix}1 & 2 & 3 & 4\\end{pmatrix}^{\\mathsf{T}} \\ \\mathrm{m/s}$, compute the scalar difference $\\Delta T = T_{\\text{consistent}} - T_{\\text{lumped}}$ between the kinetic energy obtained with the consistent mass matrix and that obtained with the lumped mass matrix. Round your answer to four significant figures. Express the final energy in Joules.", "solution": "Hamilton's principle states that for a conservative mechanical system, the variation of the action integral is zero, i.e., $\\delta \\int_{t_1}^{t_2} L \\, dt = 0$, where $L = T - V$ is the Lagrangian, $T$ is the kinetic energy, and $V$ is the potential energy. For the given elastic solid without external forces, the system is conservative.\n\nThe kinetic energy $T$ of the element is given by the integral of the kinetic energy density over its volume $\\Omega$:\n$$\nT = \\frac{1}{2} \\int_{\\Omega} \\rho \\dot{u}^2 \\, dV\n$$\nFor the reference configuration, this is $T = \\frac{1}{2} \\int_{\\Omega_0} \\rho_0 \\dot{u}^2 \\, dV_0$. The displacement field $u$ is a single Cartesian component, discretized using the shape functions $N_i$ and nodal degrees of freedom $q_i(t)$ as $u(X,Y,t) = \\sum_{i=1}^{4} N_i(X,Y) q_i(t)$. This can be written in matrix form as $u = \\mathbf{N}\\mathbf{q}$, where $\\mathbf{N} = \\begin{pmatrix} N_1 & N_2 & N_3 & N_4 \\end{pmatrix}$ and $\\mathbf{q} = \\begin{pmatrix} q_1 & q_2 & q_3 & q_4 \\end{pmatrix}^\\mathsf{T}$.\n\nThe velocity field is $\\dot{u} = \\mathbf{N}\\dot{\\mathbf{q}}$. Substituting this into the kinetic energy expression gives:\n$$\nT = \\frac{1}{2} \\int_{\\Omega_0} \\rho_0 (\\mathbf{N}\\dot{\\mathbf{q}})^{\\mathsf{T}} (\\mathbf{N}\\dot{\\mathbf{q}}) \\, dV_0 = \\frac{1}{2} \\int_{\\Omega_0} \\rho_0 \\dot{\\mathbf{q}}^{\\mathsf{T}} \\mathbf{N}^{\\mathsf{T}} \\mathbf{N} \\dot{\\mathbf{q}} \\, dV_0\n$$\nSince the nodal velocities $\\dot{\\mathbf{q}}$ are functions of time only and not of position, they can be factored out of the integral:\n$$\nT = \\frac{1}{2} \\dot{\\mathbf{q}}^{\\mathsf{T}} \\left( \\rho_0 \\int_{\\Omega_0} \\mathbf{N}^{\\mathsf{T}} \\mathbf{N} \\, dV_0 \\right) \\dot{\\mathbf{q}} = \\frac{1}{2} \\dot{\\mathbf{q}}^{\\mathsf{T}} \\mathbf{M} \\dot{\\mathbf{q}}\n$$\nwhere $\\mathbf{M} = \\rho_0 \\int_{\\Omega_0} \\mathbf{N}^{\\mathsf{T}} \\mathbf{N} \\, dV_0$ is the consistent element mass matrix.\n\nThe potential energy $V$ is the strain energy stored in the element, which can be expressed in quadratic form as $V = \\frac{1}{2} \\mathbf{q}^{\\mathsf{T}} \\mathbf{K} \\mathbf{q}$, where $\\mathbf{K}$ is the element stiffness matrix. The Lagrangian for the discrete system is $L = \\frac{1}{2} \\dot{\\mathbf{q}}^{\\mathsf{T}} \\mathbf{M} \\dot{\\mathbf{q}} - \\frac{1}{2} \\mathbf{q}^{\\mathsf{T}} \\mathbf{K} \\mathbf{q}$.\n\nApplying the Euler-Lagrange equations, $\\frac{d}{dt}\\left(\\frac{\\partial L}{\\partial \\dot{\\mathbf{q}}}\\right) - \\frac{\\partial L}{\\partial \\mathbf{q}} = \\mathbf{0}$, yields the semidiscrete equations of motion:\n$$\n\\mathbf{M} \\ddot{\\mathbf{q}} + \\mathbf{K} \\mathbf{q} = \\mathbf{0}\n$$\n\nNext, we compute the consistent mass matrix $\\mathbf{M}_{\\text{consistent}}$. The volume element is $dV_0 = t_0 \\, dX \\, dY$, where $t_0$ is the constant thickness. The domain of integration is the unit square in the $X-Y$ plane. The entries of the mass matrix are given by:\n$$\nM_{ij} = \\rho_0 t_0 \\int_{0}^{1} \\int_{0}^{1} N_i(X,Y) N_j(X,Y) \\, dX \\, dY\n$$\nDue to the product form of the shape functions, these integrals are separable. Let's compute the basis integrals:\n$\\int_0^1 (1-\\xi)^2 d\\xi = \\frac{1}{3}$, $\\int_0^1 \\xi^2 d\\xi = \\frac{1}{3}$, $\\int_0^1 \\xi(1-\\xi) d\\xi = \\frac{1}{6}$, $\\int_0^1 \\xi d\\xi = \\frac{1}{2}$, $\\int_0^1 (1-\\xi) d\\xi = \\frac{1}{2}$.\nFor example, for the diagonal term $M_{11}$:\n$M_{11} = \\rho_0 t_0 \\int_0^1 (1-X)^2 dX \\int_0^1 (1-Y)^2 dY = \\rho_0 t_0 (\\frac{1}{3})(\\frac{1}{3}) = \\frac{\\rho_0 t_0}{9}$.\nFor the off-diagonal term $M_{12}$:\n$M_{12} = \\rho_0 t_0 \\int_0^1 X(1-X) dX \\int_0^1 (1-Y)^2 dY = \\rho_0 t_0 (\\frac{1}{6})(\\frac{1}{3}) = \\frac{\\rho_0 t_0}{18}$.\nFor the off-diagonal term $M_{13}$:\n$M_{13} = \\rho_0 t_0 \\int_0^1 X(1-X) dX \\int_0^1 Y(1-Y) dY = \\rho_0 t_0 (\\frac{1}{6})(\\frac{1}{6}) = \\frac{\\rho_0 t_0}{36}$.\nBy symmetry and the structure of the shape functions, we can construct the full matrix. Let $c = \\rho_0 t_0 = 7800 \\frac{\\text{kg}}{\\text{m}^3} \\times 0.01 \\ \\text{m} = 78 \\ \\frac{\\text{kg}}{\\text{m}^2}$.\n$$\n\\mathbf{M}_{\\text{consistent}} = \\frac{c}{36} \\begin{pmatrix} 4 & 2 & 1 & 2 \\\\ 2 & 4 & 2 & 1 \\\\ 1 & 2 & 4 & 2 \\\\ 2 & 1 & 2 & 4 \\end{pmatrix} = \\frac{78}{36} \\begin{pmatrix} 4 & 2 & 1 & 2 \\\\ 2 & 4 & 2 & 1 \\\\ 1 & 2 & 4 & 2 \\\\ 2 & 1 & 2 & 4 \\end{pmatrix} = \\frac{13}{6} \\begin{pmatrix} 4 & 2 & 1 & 2 \\\\ 2 & 4 & 2 & 1 \\\\ 1 & 2 & 4 & 2 \\\\ 2 & 1 & 2 & 4 \\end{pmatrix}\n$$\nThe lumped mass matrix $\\mathbf{M}_{\\text{lumped}}$ is constructed using the row-sum technique, where each diagonal entry is the sum of all entries in the corresponding row of the consistent mass matrix, and all off-diagonal entries are zero.\n$M_{ii}^{\\text{lumped}} = \\sum_{j=1}^{4} M_{ij}^{\\text{consistent}}$.\nFor the first row: $\\sum_{j=1}^{4} M_{1j} = \\frac{13}{6}(4+2+1+2) = \\frac{13}{6}(9) = \\frac{39}{2} = 19.5$.\nDue to the symmetry of the element geometry and shape functions, all row sums are identical. The total mass of the element is $m = \\rho_0 t_0 \\times A = 78 \\times (1 \\times 1) = 78$ kg. The sum of the diagonal entries of the lumped matrix is $4 \\times 19.5 = 78$, so mass is conserved.\n$$\n\\mathbf{M}_{\\text{lumped}} = \\begin{pmatrix} 19.5 & 0 & 0 & 0 \\\\ 0 & 19.5 & 0 & 0 \\\\ 0 & 0 & 19.5 & 0 \\\\ 0 & 0 & 0 & 19.5 \\end{pmatrix} = 19.5 \\mathbf{I}\n$$\nwhere $\\mathbf{I}$ is the $4 \\times 4$ identity matrix.\n\nThe consequence of mass lumping for energy conservation:\nIn a conservative system, the total energy $E = T+V$ is constant. The semidiscrete equations of motion, $\\mathbf{M} \\ddot{\\mathbf{q}} + \\mathbf{K} \\mathbf{q} = \\mathbf{0}$, conserve the discrete total energy $E_{\\text{discrete}} = \\frac{1}{2} \\dot{\\mathbf{q}}^{\\mathsf{T}} \\mathbf{M} \\dot{\\mathbf{q}} + \\frac{1}{2} \\mathbf{q}^{\\mathsf{T}} \\mathbf{K} \\mathbf{q}$. This is because $\\frac{dE_{\\text{discrete}}}{dt} = \\dot{\\mathbf{q}}^{\\mathsf{T}}(\\mathbf{M}\\ddot{\\mathbf{q}} + \\mathbf{K}\\mathbf{q}) = \\dot{\\mathbf{q}}^{\\mathsf{T}}\\mathbf{0} = 0$. This conservation property holds for any symmetric mass matrix $\\mathbf{M}$, including both $\\mathbf{M}_{\\text{consistent}}$ and $\\mathbf{M}_{\\text{lumped}}$.\n\nHowever, the physical meaning of the conserved quantity changes. The consistent mass matrix $\\mathbf{M}_{\\text{consistent}}$ is derived directly from the kinetic energy integral of the interpolated field, $T_{\\text{consistent}} = \\frac{1}{2}\\int \\rho_0 (\\mathbf{N}\\dot{\\mathbf{q}})^2 dV_0$. Thus, $E_{\\text{consistent}} = T_{\\text{consistent}} + V$ is a consistent, discrete representation of the continuum energy.\nThe lumped mass matrix $\\mathbf{M}_{\\text{lumped}}$ is an ad-hoc approximation. While the resulting system conserves its own energy, $E_{\\text{lumped}} = T_{\\text{lumped}} + V$, the kinetic energy term $T_{\\text{lumped}} = \\frac{1}{2}\\dot{\\mathbf{q}}^{\\mathsf{T}}\\mathbf{M}_{\\text{lumped}}\\dot{\\mathbf{q}}$ is no longer the true kinetic energy of the velocity field defined by the shape functions. It corresponds to a simplified model of point masses at the nodes. Therefore, the consequence of mass lumping is not the violation of energy conservation for the resulting algebraic system, but the substitution of the variationally consistent energy expression with an approximate one, thereby altering the dynamic characteristics (e.g., natural frequencies) of the model.\n\nFinally, we compute the kinetic energy difference $\\Delta T = T_{\\text{consistent}} - T_{\\text{lumped}}$ for $\\dot{\\boldsymbol{q}} = \\begin{pmatrix}1 & 2 & 3 & 4\\end{pmatrix}^{\\mathsf{T}} \\ \\mathrm{m/s}$.\n$$\n\\Delta T = \\frac{1}{2} \\dot{\\mathbf{q}}^{\\mathsf{T}} \\mathbf{M}_{\\text{consistent}} \\dot{\\mathbf{q}} - \\frac{1}{2} \\dot{\\mathbf{q}}^{\\mathsf{T}} \\mathbf{M}_{\\text{lumped}} \\dot{\\mathbf{q}} = \\frac{1}{2} \\dot{\\mathbf{q}}^{\\mathsf{T}} (\\mathbf{M}_{\\text{consistent}} - \\mathbf{M}_{\\text{lumped}}) \\dot{\\mathbf{q}}\n$$\nLet's compute the difference matrix $\\mathbf{M}_{\\text{diff}} = \\mathbf{M}_{\\text{consistent}} - \\mathbf{M}_{\\text{lumped}}$.\n$M_{ii}^{\\text{lumped}} = \\frac{13}{6}(9) = \\frac{39}{2}$. The consistent matrix entries are scaled by $\\frac{13}{6}$.\n$\\mathbf{M}_{\\text{lumped}} = \\frac{13}{6} \\begin{pmatrix} 9 & 0 & 0 & 0 \\\\ 0 & 9 & 0 & 0 \\\\ 0 & 0 & 9 & 0 \\\\ 0 & 0 & 0 & 9 \\end{pmatrix}$.\n$$\n\\mathbf{M}_{\\text{diff}} = \\frac{13}{6} \\left( \\begin{pmatrix} 4 & 2 & 1 & 2 \\\\ 2 & 4 & 2 & 1 \\\\ 1 & 2 & 4 & 2 \\\\ 2 & 1 & 2 & 4 \\end{pmatrix} - \\begin{pmatrix} 9 & 0 & 0 & 0 \\\\ 0 & 9 & 0 & 0 \\\\ 0 & 0 & 9 & 0 \\\\ 0 & 0 & 0 & 9 \\end{pmatrix} \\right) = \\frac{13}{6} \\begin{pmatrix} -5 & 2 & 1 & 2 \\\\ 2 & -5 & 2 & 1 \\\\ 1 & 2 & -5 & 2 \\\\ 2 & 1 & 2 & -5 \\end{pmatrix}\n$$\nNow we compute the quadratic form $\\dot{\\mathbf{q}}^{\\mathsf{T}} \\mathbf{M}_{\\text{diff}} \\dot{\\mathbf{q}}$:\n$$\n\\mathbf{M}_{\\text{diff}} \\dot{\\mathbf{q}} = \\frac{13}{6} \\begin{pmatrix} -5 & 2 & 1 & 2 \\\\ 2 & -5 & 2 & 1 \\\\ 1 & 2 & -5 & 2 \\\\ 2 & 1 & 2 & -5 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 2 \\\\ 3 \\\\ 4 \\end{pmatrix} = \\frac{13}{6} \\begin{pmatrix} -5(1) + 2(2) + 1(3) + 2(4) \\\\ 2(1) - 5(2) + 2(3) + 1(4) \\\\ 1(1) + 2(2) - 5(3) + 2(4) \\\\ 2(1) + 1(2) + 2(3) - 5(4) \\end{pmatrix} = \\frac{13}{6} \\begin{pmatrix} 10 \\\\ 2 \\\\ -2 \\\\ -10 \\end{pmatrix}\n$$\n$$\n\\dot{\\mathbf{q}}^{\\mathsf{T}} (\\mathbf{M}_{\\text{diff}} \\dot{\\mathbf{q}}) = \\begin{pmatrix} 1 & 2 & 3 & 4 \\end{pmatrix} \\frac{13}{6} \\begin{pmatrix} 10 \\\\ 2 \\\\ -2 \\\\ -10 \\end{pmatrix} = \\frac{13}{6} (1(10) + 2(2) + 3(-2) + 4(-10))\n$$\n$$\n= \\frac{13}{6} (10 + 4 - 6 - 40) = \\frac{13}{6} (-32) = -\\frac{13 \\times 16}{3} = -\\frac{208}{3}\n$$\nThe energy difference is $\\Delta T = \\frac{1}{2} \\left(-\\frac{208}{3}\\right) = -\\frac{104}{3} \\approx -34.666...$ J.\nRounding to four significant figures, we get $\\Delta T = -34.67$ J.", "answer": "$$\n\\boxed{-34.67}\n$$", "id": "3569540"}, {"introduction": "With discrete representations of kinetic and potential energy, we can formulate a discrete action and apply Hamilton's principle directly to derive a time-stepping algorithm. This exercise guides you through the construction of a complete numerical method, known as a variational integrator, starting from a midpoint discrete Lagrangian. By applying the discrete Euler-Lagrange equations, you will see how structure-preserving algorithms that inherently conserve quantities like momentum and energy are systematically built [@problem_id:3569586].", "problem": "Consider a hyperelastic continuum body occupying a fixed reference configuration $\\Omega_{0}$ with material mass density $\\rho_{0}$. Let $d(X,t)$ denote the material displacement field. Introduce a uniform time grid $t_{n}=n h$ with time step $h>0$, and define the midpoint discrete Lagrangian over a single time step by\n$$\nL_{d}\\!\\left(d_{n},d_{n+1}\\right)=\\int_{\\Omega_{0}} \\tfrac{1}{2}\\,\\rho_{0}\\,\\left(\\tfrac{d_{n+1}-d_{n}}{h}\\right)\\!\\cdot\\!\\left(\\tfrac{d_{n+1}-d_{n}}{h}\\right)\\,dV \\;-\\; \\Psi\\!\\left(\\tfrac{d_{n+1}+d_{n}}{2}\\right).\n$$\nAssume there are no external forces. Perform a standard finite element (FE) spatial discretization with shape functions that interpolate the displacement field as $d(X,t)\\approx \\sum_{a} N_{a}(X)\\,d_{a}(t)$, leading to a vector of nodal unknowns $d_{n}\\in\\mathbb{R}^{N}$. Let the consistent mass matrix be\n$$\nM=\\int_{\\Omega_{0}}\\rho_{0}\\,N^{\\top}N\\,dV,\n$$\nand assume a linear elastic stored energy so that the discrete potential can be represented exactly as the quadratic form\n$$\n\\Psi(d)=\\tfrac{1}{2}\\,d^{\\top}K\\,d,\n$$\nwith a symmetric positive semidefinite stiffness matrix $K\\in\\mathbb{R}^{N\\times N}$. Using discrete Hamilton’s principle (stationarity of the discrete action sum), derive the fully discrete update map for the nodal displacement vector $d_{n+1}$ in terms of $d_{n}$ and $d_{n-1}$, expressed only in terms of $M$, $K$, and $h$. You may assume that the matrix to be inverted in the update is nonsingular.\n\nProvide your final answer as a single closed-form analytic expression for $d_{n+1}$ in terms of $d_{n}$, $d_{n-1}$, $M$, $K$, and $h$. No numerical evaluation is required, and no units are to be reported with the final expression.", "solution": "The solution proceeds by first expressing the discrete Lagrangian in terms of the nodal displacement vectors and the provided matrices, and then applying the discrete Hamilton's principle to find the equations of motion.\n\nFirst, we substitute the FE spatial discretization into the given discrete Lagrangian, $L_{d}\\!\\left(d_{n},d_{n+1}\\right)$. The displacement vector at time $t_n$ is denoted by the nodal vector $d_n$.\n\nThe first term in the Lagrangian is the discrete kinetic energy, $T_d$. Using the FE approximation $d(X, t_n) \\approx N(X)d_n$:\n$$\nT_d(d_n, d_{n+1}) = \\int_{\\Omega_{0}} \\tfrac{1}{2}\\,\\rho_{0}\\,\\left(\\frac{N d_{n+1}-N d_{n}}{h}\\right)^{\\top}\\left(\\frac{N d_{n+1}-N d_{n}}{h}\\right)\\,dV\n$$\n$$\nT_d(d_n, d_{n+1}) = \\frac{1}{2h^2} \\int_{\\Omega_{0}} \\rho_{0} (d_{n+1}-d_n)^{\\top} N^{\\top} N (d_{n+1}-d_n)\\,dV\n$$\nSince the nodal vectors $d_n$ and $d_{n+1}$ are independent of the spatial variable $X$, they can be moved outside the integral:\n$$\nT_d(d_n, d_{n+1}) = \\frac{1}{2h^2} (d_{n+1}-d_n)^{\\top} \\left(\\int_{\\Omega_{0}} \\rho_{0} N^{\\top} N \\,dV\\right) (d_{n+1}-d_n)\n$$\nSubstituting the definition of the consistent mass matrix $M$, we get:\n$$\nT_d(d_n, d_{n+1}) = \\frac{1}{2h^2} (d_{n+1}-d_n)^{\\top} M (d_{n+1}-d_n)\n$$\nThe second term in the Lagrangian is the negative of the potential energy, evaluated at the midpoint displacement $\\frac{d_{n+1}+d_n}{2}$. Given the quadratic form for the potential energy, $\\Psi(d) = \\frac{1}{2}d^{\\top}K d$, we have:\n$$\n\\Psi\\left(\\frac{d_{n+1}+d_{n}}{2}\\right) = \\frac{1}{2} \\left(\\frac{d_{n+1}+d_{n}}{2}\\right)^{\\top} K \\left(\\frac{d_{n+1}+d_{n}}{2}\\right) = \\frac{1}{8} (d_{n+1}+d_n)^{\\top} K (d_{n+1}+d_n)\n$$\nCombining these results, the fully discrete Lagrangian for a single time step is:\n$$\nL_d(d_n, d_{n+1}) = \\frac{1}{2h^2} (d_{n+1}-d_n)^{\\top} M (d_{n+1}-d_n) - \\frac{1}{8} (d_{n+1}+d_n)^{\\top} K (d_{n+1}+d_n)\n$$\nThe discrete action sum over a time interval is $S_d = \\sum_{n} L_d(d_n, d_{n+1})$. Discrete Hamilton's principle requires that the action be stationary with respect to variations in the path, i.e., $\\delta S_d = 0$. Considering variations $\\delta d_n$ at an arbitrary interior time step $t_n$ (which implies $\\delta d_k = 0$ at the endpoints of the time interval), the stationarity condition yields the discrete Euler-Lagrange equations. The nodal displacement vector $d_n$ appears in two consecutive Lagrangian terms: $L_d(d_{n-1}, d_n)$ and $L_d(d_n, d_{n+1})$. The stationarity condition with respect to $d_n$ is:\n$$\n\\frac{\\partial}{\\partial d_n} \\left( L_d(d_{n-1}, d_n) + L_d(d_n, d_{n+1}) \\right) = 0\n$$\nThis can be written as:\n$$\nD_2 L_d(d_{n-1}, d_n) + D_1 L_d(d_n, d_{n+1}) = 0\n$$\nwhere $D_1 L_d(x,y)$ denotes the partial derivative (gradient) of $L_d(x,y)$ with respect to its first argument $x$, and $D_2 L_d(x,y)$ denotes the partial derivative with respect to its second argument $y$.\n\nWe compute these derivatives. Using the matrix calculus identity $\\nabla_z (z^{\\top}A z) = 2Az$ for a symmetric matrix $A$:\nFor $L_d(x,y) = \\frac{1}{2h^2} (y-x)^{\\top} M (y-x) - \\frac{1}{8} (y+x)^{\\top} K (y+x)$:\nThe gradient with respect to the first argument $x$ is:\n$$\nD_1 L_d(x,y) = \\frac{\\partial L_d}{\\partial x} = \\frac{1}{2h^2} \\left( -2M(y-x) \\right) - \\frac{1}{8} \\left( 2K(y+x) \\right) = -\\frac{1}{h^2}M(y-x) - \\frac{1}{4}K(y+x)\n$$\nThe gradient with respect to the second argument $y$ is:\n$$\nD_2 L_d(x,y) = \\frac{\\partial L_d}{\\partial y} = \\frac{1}{2h^2} \\left( 2M(y-x) \\right) - \\frac{1}{8} \\left( 2K(y+x) \\right) = \\frac{1}{h^2}M(y-x) - \\frac{1}{4}K(y+x)\n$$\nNow we evaluate these for our discrete Euler-Lagrange equation:\n$$\nD_1 L_d(d_n, d_{n+1}) = -\\frac{1}{h^2}M(d_{n+1}-d_n) - \\frac{1}{4}K(d_{n+1}+d_n)\n$$\n$$\nD_2 L_d(d_{n-1}, d_n) = \\frac{1}{h^2}M(d_n-d_{n-1}) - \\frac{1}{4}K(d_n+d_{n-1})\n$$\nSubstituting these into the stationarity condition:\n$$\n\\left( \\frac{1}{h^2}M(d_n-d_{n-1}) - \\frac{1}{4}K(d_n+d_{n-1}) \\right) + \\left( -\\frac{1}{h^2}M(d_{n+1}-d_n) - \\frac{1}{4}K(d_{n+1}+d_n) \\right) = 0\n$$\nTo simplify and solve for $d_{n+1}$, we can multiply the entire equation by $h^2$:\n$$\nM(d_n-d_{n-1}) - \\frac{h^2}{4}K(d_n+d_{n-1}) - M(d_{n+1}-d_n) - \\frac{h^2}{4}K(d_{n+1}+d_n) = 0\n$$\nNow, we group terms by the displacement vectors $d_{n+1}$, $d_n$, and $d_{n-1}$:\n$$\n\\left(-M - \\frac{h^2}{4}K\\right)d_{n+1} + \\left(M - \\frac{h^2}{4}K + M - \\frac{h^2}{4}K\\right)d_n + \\left(-M - \\frac{h^2}{4}K\\right)d_{n-1} = 0\n$$\n$$\n-\\left(M + \\frac{h^2}{4}K\\right)d_{n+1} + \\left(2M - \\frac{h^2}{2}K\\right)d_n - \\left(M + \\frac{h^2}{4}K\\right)d_{n-1} = 0\n$$\nIsolating the term with $d_{n+1}$:\n$$\n\\left(M + \\frac{h^2}{4}K\\right)d_{n+1} = \\left(2M - \\frac{h^2}{2}K\\right)d_n - \\left(M + \\frac{h^2}{4}K\\right)d_{n-1}\n$$\nThe problem states that the matrix to be inverted is nonsingular. This matrix is $\\left(M + \\frac{h^2}{4}K\\right)$. Since $M$ is symmetric positive definite (for a non-degenerate mesh) and $K$ is symmetric positive semidefinite, their sum is symmetric positive definite and thus invertible. We can therefore left-multiply by its inverse to solve for $d_{n+1}$:\n$$\nd_{n+1} = \\left(M + \\frac{h^2}{4}K\\right)^{-1} \\left[ \\left(2M - \\frac{h^2}{2}K\\right)d_n - \\left(M + \\frac{h^2}{4}K\\right)d_{n-1} \\right]\n$$\nThis is the fully discrete update map for the nodal displacement vector.", "answer": "$$\n\\boxed{\\left(M + \\frac{h^{2}}{4}K\\right)^{-1} \\left[ \\left(2M - \\frac{h^{2}}{2}K\\right)d_{n} - \\left(M + \\frac{h^{2}}{4}K\\right)d_{n-1} \\right]}\n$$", "id": "3569586"}, {"introduction": "Hamilton's principle is not only a tool for deriving equations of motion but also for analyzing the physical stability of a system. This practice explores the stability of a pre-compressed hyperelastic body by examining the second variation of the action, $\\delta^2 \\mathcal{A}$. You will establish the profound connection between the positivity of the second variation and the dynamic stability of an equilibrium state, and determine the critical compression $\\lambda_c$ at which the system loses ellipticity and becomes unstable [@problem_id:3569602].", "problem": "Consider an infinite, homogeneous, hyperelastic solid idealized as a one-dimensional rod along the material coordinate $X$, with reference mass density $\\rho_{0}>0$. The rod is modeled by a Saint Venant–Kirchhoff hyperelastic energy per unit reference volume\n$$\nW(E) = \\frac{E_{Y}}{2}\\,E^{2},\n$$\nwhere $E_{Y}>0$ is a constant material modulus and $E$ is the Green–Lagrange strain defined via the deformation gradient $F=\\partial x/\\partial X$ by\n$$\nE = \\frac{1}{2}\\left(F^{2}-1\\right).\n$$\nAssume the rod is held in a finitely compressed homogeneous state with constant stretch $F=\\lambda\\in(0,1)$.\n\nUsing Hamilton’s principle for dynamics, consider small-amplitude, longitudinal, plane-wave perturbations $u(X,t)$ superposed on the compressed state. Derive the second variation of the action along such perturbations and show how its positivity reduces to a requirement on a scalar acoustic modulus associated with the compressed state. Identify this scalar acoustic modulus explicitly in terms of $\\lambda$ and $E_{Y}$ and determine the exact critical compressive stretch $\\lambda_{c}\\in(0,1)$ at which ellipticity is lost, i.e., where the acoustic modulus first vanishes. Provide your final answer for $\\lambda_{c}$ as a single exact expression. No rounding is required and no units are needed in the final answer.", "solution": "Hamilton's principle states that the variation of the action integral, $\\mathcal{A}$, is zero for a physical motion between two times $t_1$ and $t_2$. The action is defined as the time integral of the Lagrangian, $\\mathcal{L}$, which is the difference between the total kinetic energy, $\\mathcal{T}$, and the total potential energy, $\\mathcal{V}$.\n$$\n\\mathcal{A} = \\int_{t_1}^{t_2} \\mathcal{L} \\, dt = \\int_{t_1}^{t_2} (\\mathcal{T} - \\mathcal{V}) \\, dt\n$$\nFor a one-dimensional continuum with material coordinate $X$, the total kinetic and potential energies are given by integrals over the reference domain:\n$$\n\\mathcal{T} = \\int_{-\\infty}^{\\infty} \\frac{1}{2} \\rho_0 \\dot{x}^2 \\, dX\n$$\n$$\n\\mathcal{V} = \\int_{-\\infty}^{\\infty} W(E) \\, dX\n$$\nHere, $\\rho_0$ is the reference mass density, $x(X,t)$ is the position of a material point $X$ at time $t$, $\\dot{x} = \\partial x / \\partial t$ is the material velocity, $W(E)$ is the strain energy density per unit reference volume, and $E$ is the Green–Lagrange strain. The Lagrangian density, $\\mathcal{L}_{d}$, is $\\frac{1}{2} \\rho_0 \\dot{x}^2 - W(E)$.\n\nThe motion is described as a small-amplitude perturbation $u(X,t)$ superposed on a static, homogeneous, pre-compressed state $x_0(X) = \\lambda X$, where $\\lambda \\in (0,1)$ is the constant stretch.\nThe total deformation is:\n$$\nx(X,t) = x_0(X) + u(X,t) = \\lambda X + u(X,t)\n$$\nWe express the kinematic quantities in terms of the perturbation $u(X,t)$:\nThe velocity is $\\dot{x} = \\frac{\\partial}{\\partial t}(\\lambda X + u) = \\dot{u}$.\nThe deformation gradient is $F = \\frac{\\partial x}{\\partial X} = \\frac{\\partial}{\\partial X}(\\lambda X + u) = \\lambda + u_{,X}$.\n\nThe Green–Lagrange strain $E = \\frac{1}{2}(F^2 - 1)$ becomes:\n$$\nE = \\frac{1}{2}((\\lambda + u_{,X})^2 - 1) = \\frac{1}{2}(\\lambda^2 + 2\\lambda u_{,X} + u_{,X}^2 - 1)\n$$\nLet $E_0 = \\frac{1}{2}(\\lambda^2 - 1)$ be the constant strain in the pre-compressed state. The strain can be written as:\n$$\nE = E_0 + \\lambda u_{,X} + \\frac{1}{2} u_{,X}^2\n$$\nThe Lagrangian density is a function of $\\dot{u}$ and $u_{,X}$:\n$$\n\\mathcal{L}_{d} = \\frac{1}{2} \\rho_0 \\dot{u}^2 - W\\left(E_0 + \\lambda u_{,X} + \\frac{1}{2} u_{,X}^2\\right)\n$$\nTo find the second variation of the action, we expand the Lagrangian density in a Taylor series about the equilibrium state ($u=0, \\dot{u}=0, u_{,X}=0$) and retain terms up to the second order in the perturbation field and its derivatives.\nThe strain energy density $W(E)$ is expanded around $E_0$:\n$$\nW(E) \\approx W(E_0) + \\left.\\frac{dW}{dE}\\right|_{E_0}(E - E_0) + \\frac{1}{2}\\left.\\frac{d^2W}{dE^2}\\right|_{E_0}(E - E_0)^2\n$$\nSubstituting $E - E_0 = \\lambda u_{,X} + \\frac{1}{2} u_{,X}^2$:\n$$\nW(E) \\approx W(E_0) + \\left.\\frac{dW}{dE}\\right|_{E_0}\\left(\\lambda u_{,X} + \\frac{1}{2} u_{,X}^2\\right) + \\frac{1}{2}\\left.\\frac{d^2W}{dE^2}\\right|_{E_0}\\left(\\lambda u_{,X}\\right)^2\n$$\nWe only keep terms up to quadratic in $u$ and its derivatives. The Lagrangian density becomes:\n$$\n\\mathcal{L}_{d} \\approx \\frac{1}{2} \\rho_0 \\dot{u}^2 - \\left[ W(E_0) + \\lambda\\left.\\frac{dW}{dE}\\right|_{E_0} u_{,X} + \\frac{1}{2}\\left(\\left.\\frac{dW}{dE}\\right|_{E_0} + \\lambda^2\\left.\\frac{d^2W}{dE^2}\\right|_{E_0}\\right) u_{,X}^2 \\right]\n$$\nThe second variation of the action, $\\delta^2 \\mathcal{A}$, is given by the integral of the quadratic part of the Lagrangian density, $\\mathcal{L}_2$:\n$$\n\\delta^2 \\mathcal{A} = \\int_{t_1}^{t_2} \\int_{-\\infty}^{\\infty} \\mathcal{L}_2 \\, dX \\, dt\n$$\nwhere\n$$\n\\mathcal{L}_2 = \\frac{1}{2} \\rho_0 \\dot{u}^2 - \\frac{1}{2}\\left(\\left.\\frac{dW}{dE}\\right|_{E_0} + \\lambda^2\\left.\\frac{d^2W}{dE^2}\\right|_{E_0}\\right) u_{,X}^2\n$$\nFor the pre-compressed state to be dynamically stable, the second variation of the action must be positive for any admissible non-zero perturbation $u(X,t)$. The kinetic energy term $\\frac{1}{2}\\rho_0 \\dot{u}^2$ is non-negative. Stability requires that the potential energy part of $\\delta^2 \\mathcal{A}$ be positive definite. This means the coefficient of $u_{,X}^2$ in the potential energy part of $\\mathcal{L}_2$ must be positive. This coefficient is defined as the scalar acoustic modulus, $\\mathcal{C}$.\n$$\n\\mathcal{C} = \\left.\\frac{dW}{dE}\\right|_{E_0} + \\lambda^2\\left.\\frac{d^2W}{dE^2}\\right|_{E_0}\n$$\nPositivity of the second variation, and thus stability of the compressed state, requires $\\mathcal{C} > 0$. Loss of ellipticity occurs when this modulus first vanishes.\n\nNow, we evaluate $\\mathcal{C}$ for the given Saint Venant–Kirchhoff material model:\n$$\nW(E) = \\frac{E_Y}{2} E^2\n$$\nThe first and second derivatives of $W$ with respect to $E$ are:\n$$\n\\frac{dW}{dE} = E_Y E\n$$\n$$\n\\frac{d^2W}{dE^2} = E_Y\n$$\nWe evaluate these at the pre-strained state $E_0 = \\frac{1}{2}(\\lambda^2-1)$:\n$$\n\\left.\\frac{dW}{dE}\\right|_{E_0} = E_Y E_0 = E_Y \\frac{1}{2}(\\lambda^2-1)\n$$\n$$\n\\left.\\frac{d^2W}{dE^2}\\right|_{E_0} = E_Y\n$$\nSubstituting these expressions into the formula for the acoustic modulus $\\mathcal{C}$:\n$$\n\\mathcal{C} = E_Y \\frac{1}{2}(\\lambda^2-1) + \\lambda^2 E_Y = \\frac{E_Y}{2} (\\lambda^2-1 + 2\\lambda^2)\n$$\nThe explicit expression for the scalar acoustic modulus is:\n$$\n\\mathcal{C} = \\frac{E_Y}{2} (3\\lambda^2 - 1)\n$$\nEllipticity is lost when the acoustic modulus vanishes, i.e., $\\mathcal{C} = 0$. This defines the critical compressive stretch $\\lambda_c$. Since $E_Y > 0$, we must have:\n$$\n3\\lambda_c^2 - 1 = 0\n$$\nSolving for $\\lambda_c$:\n$$\n\\lambda_c^2 = \\frac{1}{3}\n$$\nSince the stretch $\\lambda$ is defined in the interval $(0,1)$, we take the positive root:\n$$\n\\lambda_c = \\sqrt{\\frac{1}{3}} = \\frac{1}{\\sqrt{3}}\n$$\nThis value lies in the specified range, as $\\frac{1}{\\sqrt{3}} \\approx 0.577$. At this critical stretch, the material loses its capacity to support incremental longitudinal waves, signaling the onset of a material instability.\nThe final answer is the exact value of $\\lambda_c$.", "answer": "$$\n\\boxed{\\frac{1}{\\sqrt{3}}}\n$$", "id": "3569602"}]}