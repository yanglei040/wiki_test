{"hands_on_practices": [{"introduction": "To effectively use representation theorems, we must first build a solid understanding of their fundamental components: the principal invariants and the Cayley-Hamilton theorem. This first exercise takes us back to first principles, guiding you to derive the explicit form of the invariants from the characteristic polynomial for a simple diagonal tensor. By then verifying the Cayley-Hamilton theorem through direct substitution, you will solidify your grasp of this crucial relationship that underpins all subsequent simplifications of isotropic tensor functions [@problem_id:3595159].", "problem": "Consider a homogeneous, isotropic constitutive model in three spatial dimensions, where isotropy implies that any scalar response depending on a second-order tensor $A$ can be expressed in terms of the principal invariants of $A$. Let $A$ be a second-order tensor with spectral representation in an orthonormal basis given by $A=\\mathrm{diag}(\\lambda_{1},\\lambda_{2},\\lambda_{3})$, where $\\lambda_{1},\\lambda_{2},\\lambda_{3}\\in\\mathbb{R}$ are distinct principal values. The principal invariants $I_{1}$, $I_{2}$, and $I_{3}$ of $A$ are the scalar coefficients appearing in the characteristic polynomial of $A$, defined by $\\det(\\eta I - A)$, where $I$ is the identity tensor and $\\eta$ is a scalar indeterminate. Starting from the foundational definitions of eigenvalues, determinants, and the characteristic polynomial for a second-order tensor, and using only those as the base, perform the following:\n\n- Derive explicit analytic expressions for $I_{1}$, $I_{2}$, and $I_{3}$ in terms of $\\lambda_{1}$, $\\lambda_{2}$, and $\\lambda_{3}$.\n- Using these expressions, verify the Cayley–Hamilton identity for $A$ in the form $A^{3}-I_{1}A^{2}+I_{2}A-I_{3}I=\\mathbf{0}$ by direct evaluation in the chosen basis.\n\nExpress your final answer as a single row matrix containing $I_{1}$, $I_{2}$, and $I_{3}$, in closed form. No numerical evaluation or rounding is required, and no physical units are involved.", "solution": "The problem requires the derivation of the principal invariants of a second-order tensor $A$ and the subsequent verification of the Cayley-Hamilton identity for this tensor. The analysis will be performed in the provided orthonormal basis where $A$ is diagonal.\n\nFirst, we derive the expressions for the principal invariants $I_{1}$, $I_{2}$, and $I_{3}$. The problem defines these as the scalar coefficients in the characteristic polynomial $p(\\eta) = \\det(\\eta I - A)$. The standard form of the characteristic polynomial for a second-order tensor in three dimensions is given by $p(\\eta) = \\eta^{3} - I_{1}\\eta^{2} + I_{2}\\eta - I_{3}$.\n\nThe tensor $A$ is given in its spectral representation in an orthonormal basis as a diagonal matrix with its principal values (eigenvalues) $\\lambda_{1}$, $\\lambda_{2}$, and $\\lambda_{3}$ on the diagonal:\n$$\nA = \\begin{pmatrix}\n\\lambda_{1} & 0 & 0 \\\\\n0 & \\lambda_{2} & 0 \\\\\n0 & 0 & \\lambda_{3}\n\\end{pmatrix}\n$$\nThe identity tensor $I$ in the same basis is:\n$$\nI = \\begin{pmatrix}\n1 & 0 & 0 \\\\\n0 & 1 & 0 \\\\\n0 & 0 & 1\n\\end{pmatrix}\n$$\nWe construct the tensor $\\eta I - A$:\n$$\n\\eta I - A = \\eta \\begin{pmatrix}\n1 & 0 & 0 \\\\\n0 & 1 & 0 \\\\\n0 & 0 & 1\n\\end{pmatrix} - \\begin{pmatrix}\n\\lambda_{1} & 0 & 0 \\\\\n0 & \\lambda_{2} & 0 \\\\\n0 & 0 & \\lambda_{3}\n\\end{pmatrix} = \\begin{pmatrix}\n\\eta - \\lambda_{1} & 0 & 0 \\\\\n0 & \\eta - \\lambda_{2} & 0 \\\\\n0 & 0 & \\eta - \\lambda_{3}\n\\end{pmatrix}\n$$\nThe determinant of this diagonal matrix is the product of its diagonal elements:\n$$\n\\det(\\eta I - A) = (\\eta - \\lambda_{1})(\\eta - \\lambda_{2})(\\eta - \\lambda_{3})\n$$\nWe expand this product to obtain the polynomial in terms of $\\eta$:\n$$\n\\begin{aligned}\n\\det(\\eta I - A) &= (\\eta^{2} - (\\lambda_{1} + \\lambda_{2})\\eta + \\lambda_{1}\\lambda_{2})(\\eta - \\lambda_{3}) \\\\\n&= \\eta^{3} - \\lambda_{3}\\eta^{2} - (\\lambda_{1} + \\lambda_{2})\\eta^{2} + \\lambda_{3}(\\lambda_{1} + \\lambda_{2})\\eta + \\lambda_{1}\\lambda_{2}\\eta - \\lambda_{1}\\lambda_{2}\\lambda_{3} \\\\\n&= \\eta^{3} - (\\lambda_{1} + \\lambda_{2} + \\lambda_{3})\\eta^{2} + (\\lambda_{1}\\lambda_{2} + \\lambda_{1}\\lambda_{3} + \\lambda_{2}\\lambda_{3})\\eta - \\lambda_{1}\\lambda_{2}\\lambda_{3}\n\\end{aligned}\n$$\nBy comparing this expanded form with the standard characteristic polynomial $p(\\eta) = \\eta^{3} - I_{1}\\eta^{2} + I_{2}\\eta - I_{3}$, we can identify the invariants by equating the coefficients of the powers of $\\eta$:\nThe coefficient of $\\eta^{2}$ gives $-I_{1} = -(\\lambda_{1} + \\lambda_{2} + \\lambda_{3})$, which implies:\n$$\nI_{1} = \\lambda_{1} + \\lambda_{2} + \\lambda_{3}\n$$\nThis is the trace of the tensor $A$, $\\mathrm{tr}(A)$.\n\nThe coefficient of $\\eta$ gives $I_{2} = \\lambda_{1}\\lambda_{2} + \\lambda_{1}\\lambda_{3} + \\lambda_{2}\\lambda_{3}$. This can also be expressed as $I_{2} = \\frac{1}{2}[(\\mathrm{tr}(A))^{2} - \\mathrm{tr}(A^{2})]$.\n$$\nI_{2} = \\lambda_{1}\\lambda_{2} + \\lambda_{2}\\lambda_{3} + \\lambda_{3}\\lambda_{1}\n$$\nThe constant term gives $-I_{3} = -\\lambda_{1}\\lambda_{2}\\lambda_{3}$, which implies:\n$$\nI_{3} = \\lambda_{1}\\lambda_{2}\\lambda_{3}\n$$\nThis is the determinant of the tensor $A$, $\\det(A)$.\n\nNext, we verify the Cayley-Hamilton identity, which states that a tensor satisfies its own characteristic equation:\n$$\nA^{3} - I_{1}A^{2} + I_{2}A - I_{3}I = \\mathbf{0}\n$$\nWe perform a direct evaluation in the given basis. First, we compute the necessary powers of the matrix $A$:\n$$\nA^{2} = A A = \\begin{pmatrix}\n\\lambda_{1}^{2} & 0 & 0 \\\\\n0 & \\lambda_{2}^{2} & 0 \\\\\n0 & 0 & \\lambda_{3}^{2}\n\\end{pmatrix}\n$$\n$$\nA^{3} = A^{2} A = \\begin{pmatrix}\n\\lambda_{1}^{3} & 0 & 0 \\\\\n0 & \\lambda_{2}^{3} & 0 \\\\\n0 & 0 & \\lambda_{3}^{3}\n\\end{pmatrix}\n$$\nNow, substitute the expressions for $A$, $A^{2}$, $A^{3}$, $I$ and the invariants $I_{1}$, $I_{2}$, $I_{3}$ into the Cayley-Hamilton equation. Substituting these matrices into the left-hand side of the identity gives a single matrix. Let's examine the $(1,1)$ component of this resultant matrix:\n$$\n(\\text{Result})_{(1,1)} = \\lambda_{1}^{3} - (\\lambda_{1}+\\lambda_{2}+\\lambda_{3})\\lambda_{1}^{2} + (\\lambda_{1}\\lambda_{2}+\\lambda_{2}\\lambda_{3}+\\lambda_{3}\\lambda_{1})\\lambda_{1} - \\lambda_{1}\\lambda_{2}\\lambda_{3}\n$$\nExpanding the terms:\n$$\n= \\lambda_{1}^{3} - \\lambda_{1}^{3} - \\lambda_{2}\\lambda_{1}^{2} - \\lambda_{3}\\lambda_{1}^{2} + \\lambda_{1}^{2}\\lambda_{2} + \\lambda_{1}\\lambda_{2}\\lambda_{3} + \\lambda_{1}^{2}\\lambda_{3} - \\lambda_{1}\\lambda_{2}\\lambda_{3}\n$$\nCollecting like terms:\n$$\n= (\\lambda_{1}^{3} - \\lambda_{1}^{3}) + (-\\lambda_{2}\\lambda_{1}^{2} + \\lambda_{1}^{2}\\lambda_{2}) + (-\\lambda_{3}\\lambda_{1}^{2} + \\lambda_{1}^{2}\\lambda_{3}) + (\\lambda_{1}\\lambda_{2}\\lambda_{3} - \\lambda_{1}\\lambda_{2}\\lambda_{3})\n$$\n$$\n= 0 + 0 + 0 + 0 = 0\n$$\nAn alternative and more elegant way to see this is to recognize that the diagonal entries of the matrix equation $A^{3} - I_{1}A^{2} + I_{2}A - I_{3}I$ are precisely the characteristic polynomial $p(\\eta)$ evaluated at each eigenvalue $\\lambda_{i}$. For the $i$-th diagonal entry, we have:\n$$\n(\\text{Result})_{(i,i)} = \\lambda_{i}^{3} - I_{1}\\lambda_{i}^{2} + I_{2}\\lambda_{i} - I_{3} = p(\\lambda_{i})\n$$\nBy definition, the eigenvalues $\\lambda_{1}$, $\\lambda_{2}$, and $\\lambda_{3}$ are the roots of the characteristic polynomial $p(\\eta) = \\det(\\eta I - A) = 0$. Therefore, $p(\\lambda_{1}) = 0$, $p(\\lambda_{2}) = 0$, and $p(\\lambda_{3}) = 0$.\nThe off-diagonal elements are all zero throughout the calculation. Thus, the resulting matrix is the zero matrix:\n$$\nA^{3} - I_{1}A^{2} + I_{2}A - I_{3}I = \\begin{pmatrix}\np(\\lambda_{1}) & 0 & 0 \\\\\n0 & p(\\lambda_{2}) & 0 \\\\\n0 & 0 & p(\\lambda_{3})\n\\end{pmatrix} = \\begin{pmatrix}\n0 & 0 & 0 \\\\\n0 & 0 & 0 \\\\\n0 & 0 & 0\n\\end{pmatrix} = \\mathbf{0}\n$$\nThis directly verifies the Cayley-Hamilton identity for the tensor $A$ in the chosen basis. The expressions for the invariants are thus confirmed.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\lambda_{1} + \\lambda_{2} + \\lambda_{3} & \\lambda_{1}\\lambda_{2} + \\lambda_{2}\\lambda_{3} + \\lambda_{3}\\lambda_{1} & \\lambda_{1}\\lambda_{2}\\lambda_{3}\n\\end{pmatrix}\n}\n$$", "id": "3595159"}, {"introduction": "With the Cayley-Hamilton theorem established as a fundamental identity, we can now explore its primary application: the systematic reduction of tensor polynomials. This practice challenges you to take a tensor polynomial of a degree higher than two and reduce it to the canonical form for a 3D isotropic function, which involves at most the second power of the tensor. Mastering this algebraic procedure is essential, as it demonstrates how seemingly complex material responses can be expressed in a consistent and simplified basis, a cornerstone of constitutive modeling [@problem_id:3595140].", "problem": "In computational solid mechanics, any isotropic tensor function of a single second-order tensor argument in three dimensions can be represented in terms of the identity tensor and powers of the argument. Let $\\mathbf{A}$ be a second-order tensor on $\\mathbb{R}^{3}$ with principal invariants $I_{1}$, $I_{2}$, and $I_{3}$, where $I_{1}=\\mathrm{tr}\\,\\mathbf{A}$, $I_{2}$ is the sum of the principal minors of order $2$ of $\\mathbf{A}$, and $I_{3}=\\det \\mathbf{A}$. Consider the tensor polynomial $p(\\mathbf{A})=\\mathbf{A}^{4}+2\\,\\mathbf{A}^{3}+\\mathbf{A}$. Starting only from the definitions of the principal invariants and the Cayley–Hamilton theorem for $\\mathbf{A}$, reduce $p(\\mathbf{A})$ to the canonical isotropic form $\\alpha_{0}\\,\\mathbf{I}+\\alpha_{1}\\,\\mathbf{A}+\\alpha_{2}\\,\\mathbf{A}^{2}$, and express the scalar coefficients $\\alpha_{i}$ in closed form as functions of $I_{1}$, $I_{2}$, and $I_{3}$. Provide your final answer as the row matrix $\\begin{pmatrix}\\alpha_{0}&\\alpha_{1}&\\alpha_{2}\\end{pmatrix}$. This is a symbolic calculation; no numerical rounding is required.", "solution": "The problem requires the reduction of a tensor polynomial $p(\\mathbf{A}) = \\mathbf{A}^{4} + 2\\,\\mathbf{A}^{3} + \\mathbf{A}$ to its canonical isotropic form $\\alpha_{0}\\,\\mathbf{I} + \\alpha_{1}\\,\\mathbf{A} + \\alpha_{2}\\,\\mathbf{A}^{2}$, where $\\mathbf{A}$ is a second-order tensor in a three-dimensional space $\\mathbb{R}^{3}$. The coefficients $\\alpha_{0}$, $\\alpha_{1}$, and $\\alpha_{2}$ must be expressed in terms of the principal invariants of $\\mathbf{A}$, denoted $I_{1}$, $I_{2}$, and $I_{3}$. The fundamental tool for this reduction is the Cayley-Hamilton theorem.\n\nThe characteristic equation of a second-order tensor $\\mathbf{A}$ in $\\mathbb{R}^{3}$ is given by $\\det(\\mathbf{A} - \\lambda\\mathbf{I}) = 0$, where $\\lambda$ represents the eigenvalues and $\\mathbf{I}$ is the second-order identity tensor. This cubic equation can be expanded in terms of the principal invariants:\n$$ \\lambda^{3} - I_{1}\\lambda^{2} + I_{2}\\lambda - I_{3} = 0 $$\nwhere $I_{1} = \\mathrm{tr}\\,\\mathbf{A}$, $I_{2} = \\frac{1}{2}[(\\mathrm{tr}\\,\\mathbf{A})^{2} - \\mathrm{tr}(\\mathbf{A}^{2})]$ (equivalent to the sum of principal minors of order $2$), and $I_{3} = \\det \\mathbf{A}$.\n\nThe Cayley-Hamilton theorem asserts that the tensor $\\mathbf{A}$ satisfies its own characteristic equation. By substituting $\\mathbf{A}$ for $\\lambda$ and appropriately including the identity tensor $\\mathbf{I}$ for the scalar term, we obtain the fundamental tensor identity:\n$$ \\mathbf{A}^{3} - I_{1}\\mathbf{A}^{2} + I_{2}\\mathbf{A} - I_{3}\\mathbf{I} = \\mathbf{0} $$\nwhere $\\mathbf{0}$ is the zero tensor. This identity allows us to express $\\mathbf{A}^{3}$ as a linear combination of lower powers of $\\mathbf{A}$:\n$$ \\mathbf{A}^{3} = I_{1}\\mathbf{A}^{2} - I_{2}\\mathbf{A} + I_{3}\\mathbf{I} $$\nThis is the first step in the reduction. To reduce the $\\mathbf{A}^{4}$ term in the polynomial $p(\\mathbf{A})$, we multiply the above expression for $\\mathbf{A}^{3}$ by $\\mathbf{A}$:\n$$ \\mathbf{A}^{4} = \\mathbf{A} \\cdot \\mathbf{A}^{3} = \\mathbf{A}(I_{1}\\mathbf{A}^{2} - I_{2}\\mathbf{A} + I_{3}\\mathbf{I}) $$\n$$ \\mathbf{A}^{4} = I_{1}\\mathbf{A}^{3} - I_{2}\\mathbf{A}^{2} + I_{3}\\mathbf{A} $$\nThe resulting expression for $\\mathbf{A}^{4}$ still contains $\\mathbf{A}^{3}$. We must substitute the expression for $\\mathbf{A}^{3}$ from the Cayley-Hamilton theorem into this equation for $\\mathbf{A}^{4}$:\n$$ \\mathbf{A}^{4} = I_{1}(I_{1}\\mathbf{A}^{2} - I_{2}\\mathbf{A} + I_{3}\\mathbf{I}) - I_{2}\\mathbf{A}^{2} + I_{3}\\mathbf{A} $$\nDistributing the scalar $I_{1}$ and grouping terms by powers of $\\mathbf{A}$:\n$$ \\mathbf{A}^{4} = I_{1}^{2}\\mathbf{A}^{2} - I_{1}I_{2}\\mathbf{A} + I_{1}I_{3}\\mathbf{I} - I_{2}\\mathbf{A}^{2} + I_{3}\\mathbf{A} $$\n$$ \\mathbf{A}^{4} = (I_{1}^{2} - I_{2})\\mathbf{A}^{2} + (I_{3} - I_{1}I_{2})\\mathbf{A} + (I_{1}I_{3})\\mathbf{I} $$\nNow we have successfully expressed both $\\mathbf{A}^{3}$ and $\\mathbf{A}^{4}$ in the required form. We can substitute these into the original polynomial $p(\\mathbf{A})$:\n$$ p(\\mathbf{A}) = \\mathbf{A}^{4} + 2\\,\\mathbf{A}^{3} + \\mathbf{A} $$\n$$ p(\\mathbf{A}) = \\left[ (I_{1}^{2} - I_{2})\\mathbf{A}^{2} + (I_{3} - I_{1}I_{2})\\mathbf{A} + (I_{1}I_{3})\\mathbf{I} \\right] + 2\\left[ I_{1}\\mathbf{A}^{2} - I_{2}\\mathbf{A} + I_{3}\\mathbf{I} \\right] + \\mathbf{A} $$\nTo find the coefficients $\\alpha_{0}$, $\\alpha_{1}$, and $\\alpha_{2}$ of the canonical form $\\alpha_{0}\\mathbf{I} + \\alpha_{1}\\mathbf{A} + \\alpha_{2}\\mathbf{A}^{2}$, we collect the coefficients for each tensor power:\n\nFor the coefficient $\\alpha_{0}$ of the identity tensor $\\mathbf{I}$:\n$$ \\alpha_{0}\\mathbf{I} = (I_{1}I_{3})\\mathbf{I} + 2(I_{3}\\mathbf{I}) = (I_{1}I_{3} + 2I_{3})\\mathbf{I} $$\n$$ \\alpha_{0} = I_{3}(I_{1} + 2) $$\n\nFor the coefficient $\\alpha_{1}$ of the tensor $\\mathbf{A}$:\n$$ \\alpha_{1}\\mathbf{A} = (I_{3} - I_{1}I_{2})\\mathbf{A} + 2(-I_{2}\\mathbf{A}) + 1\\mathbf{A} = (I_{3} - I_{1}I_{2} - 2I_{2} + 1)\\mathbf{A} $$\n$$ \\alpha_{1} = 1 + I_{3} - I_{2}(I_{1} + 2) $$\n\nFor the coefficient $\\alpha_{2}$ of the tensor $\\mathbf{A}^{2}$:\n$$ \\alpha_{2}\\mathbf{A}^{2} = (I_{1}^{2} - I_{2})\\mathbf{A}^{2} + 2(I_{1}\\mathbf{A}^{2}) = (I_{1}^{2} - I_{2} + 2I_{1})\\mathbf{A}^{2} $$\n$$ \\alpha_{2} = I_{1}^{2} + 2I_{1} - I_{2} $$\n\nThese three scalar coefficients $\\alpha_{0}$, $\\alpha_{1}$, and $\\alpha_{2}$ are expressed as closed-form functions of the principal invariants $I_{1}$, $I_{2}$, and $I_{3}$. The final answer is the row matrix containing these coefficients in order.", "answer": "$$\n\\boxed{\\begin{pmatrix} I_{3}(I_{1} + 2) & 1 + I_{3} - I_{2}(I_{1} + 2) & I_{1}^{2} + 2I_{1} - I_{2} \\end{pmatrix}}\n$$", "id": "3595140"}, {"introduction": "This final practice bridges the gap between abstract theory and practical application in computational mechanics. Here, you will apply the chain rule to an isotropic energy function—a function of the tensor invariants—to derive the expressions for the stress and the algorithmic tangent modulus, which are the first and second derivatives of the energy, respectively. This task is not merely a theoretical exercise; it is the exact process required to implement a new hyperelastic material model within a finite element analysis framework, demonstrating the direct utility of representation theorems in advanced engineering simulation [@problem_id:3595206].", "problem": "Consider an isotropic hyperelastic material whose Helmholtz free energy density is a scalar function of the principal invariants of the right Cauchy-Green deformation tensor $\\,\\mathbf{C}\\in\\mathbb{R}^{3\\times 3}\\,$, defined by $\\,W(\\mathbf{C}) = \\widehat{W}(I_1(\\mathbf{C}), I_2(\\mathbf{C}), I_3(\\mathbf{C}))\\,$, where $\\,I_1=\\mathrm{tr}\\,\\mathbf{C}\\,$, $\\,I_2=\\tfrac{1}{2}(I_1^2 - \\mathrm{tr}\\,\\mathbf{C}^2)\\,$, and $\\,I_3=\\det\\mathbf{C}\\,$. By the representation theorem for isotropic tensor functions, any isotropic scalar function of $\\,\\mathbf{C}\\,$ can be written as a function of $\\,I_1, I_2, I_3\\,$.\n\nStarting from the fundamental facts and definitions below, derive explicit expressions for the first and second derivatives of $\\,W\\,$ with respect to $\\,\\mathbf{C}\\,$:\n- The first derivative $\\,\\partial W/\\partial \\mathbf{C}\\,$, which is a second-order tensor, and\n- The second derivative $\\,\\partial^2 W/\\partial \\mathbf{C}\\,\\partial \\mathbf{C}\\,$, which is a fourth-order tensor.\n\nUse only the following base ingredients in your derivation:\n- The chain rule for multivariable functions and tensor functions,\n- The differential identities for the invariants:\n  1. $\\,\\mathrm{d}I_1 = \\mathbf{I} : \\mathrm{d}\\mathbf{C}\\,$,\n  2. $\\,\\mathrm{d}I_2 = (I_1\\mathbf{I} - \\mathbf{C}) : \\mathrm{d}\\mathbf{C}\\,$,\n  3. $\\,\\mathrm{d}I_3 = I_3\\,\\mathbf{C}^{-1} : \\mathrm{d}\\mathbf{C}\\,$,\n  where $\\,\\mathbf{I}\\,$ is the second-order identity tensor and $:$ denotes the Frobenius inner product.\n- The differentials of the gradients above to construct the second derivatives $\\,\\partial^2 I_\\alpha/\\partial \\mathbf{C}\\,\\partial \\mathbf{C}\\,$, restricted to symmetric variations $\\,\\mathrm{d}\\mathbf{C}=\\mathrm{d}\\mathbf{C}^T\\,$:\n  1. $\\,\\partial^2 I_1/\\partial \\mathbf{C}\\,\\partial \\mathbf{C} = \\mathbb{O}\\,$ (the zero fourth-order tensor),\n  2. $\\,\\partial^2 I_2/\\partial \\mathbf{C}\\,\\partial \\mathbf{C} = \\mathbf{I}\\otimes\\mathbf{I} - \\mathbb{I}_s\\,$, where $\\,(\\mathbf{A}\\otimes\\mathbf{B})_{ijkl} = A_{ij}B_{kl}\\,$ and $\\,(\\mathbb{I}_s)_{ijkl}=\\tfrac{1}{2}(\\delta_{ik}\\delta_{jl}+\\delta_{il}\\delta_{jk})\\,$,\n  3. $\\,\\partial^2 I_3/\\partial \\mathbf{C}\\,\\partial \\mathbf{C} = I_3\\left(\\mathbf{C}^{-1}\\otimes\\mathbf{C}^{-1} - \\mathbb{K}_s\\right)\\,$, with $\\,(\\mathbb{K}_s)_{ijkl}=\\tfrac{1}{2}\\left[(\\mathbf{C}^{-1})_{ik}(\\mathbf{C}^{-1})_{lj}+(\\mathbf{C}^{-1})_{il}(\\mathbf{C}^{-1})_{kj}\\right]\\,$,\n  so that $\\,\\mathbb{I}_s:\\mathrm{d}\\mathbf{C}=\\mathrm{d}\\mathbf{C}\\,$ and $\\,\\mathbb{K}_s:\\mathrm{d}\\mathbf{C}=\\mathbf{C}^{-1}\\mathrm{d}\\mathbf{C}\\,\\mathbf{C}^{-1}\\,$ for symmetric $\\,\\mathrm{d}\\mathbf{C}\\,$.\n\nThen, implement your derived formulas in a program that computes:\n- The energy $\\,W(\\mathbf{C})\\,$,\n- The gradient $\\,\\partial W/\\partial \\mathbf{C}\\,$,\n- The Hessian $\\,\\partial^2 W/\\partial \\mathbf{C}\\,\\partial \\mathbf{C}\\,$, which is the material Hessian. In a total Lagrangian finite element formulation with the second Piola-Kirchhoff stress $\\,\\mathbf{S}=2\\,\\partial W/\\partial \\mathbf{C}\\,$ and the Green-Lagrange strain $\\,\\mathbf{E}=\\tfrac{1}{2}(\\mathbf{C}-\\mathbf{I})\\,$, the algorithmic tangent $\\,\\mathbb{C}_{\\mathbf{S}\\mathbf{E}}=\\partial \\mathbf{S}/\\partial \\mathbf{E}=4\\,\\partial^2 W/\\partial \\mathbf{C}\\,\\partial \\mathbf{C}\\,$.\n\nFor numerical evaluation and verification, use the specific scalar energy\n$$\nW(I_1,I_2,I_3) = \\tfrac{1}{2}a\\,(I_1-3)^2 + \\tfrac{1}{2}b\\,(I_2-3)^2 + \\tfrac{1}{2}c\\,(\\ln I_3)^2 + d\\,I_1 I_2 + e\\,I_2 I_3 + f\\,I_1 \\ln I_3,\n$$\nwith parameters $\\,a,b,c,d,e,f\\,$ specified in the test suite below. Your implementation must:\n- Compute $\\,W\\,$, $\\,\\partial W/\\partial \\mathbf{C}\\,$, and $\\,\\partial^2 W/\\partial \\mathbf{C}\\,\\partial \\mathbf{C}\\,$ for given symmetric positive definite $\\,\\mathbf{C}\\,$,\n- Verify the gradient by comparing the analytical directional derivative $\\,(\\partial W/\\partial \\mathbf{C}) : \\mathbf{D}\\,$ against a central finite-difference approximation for a symmetric direction $\\,\\mathbf{D}\\,$,\n- Verify the Hessian by comparing $\\,\\mathbf{D} : (\\partial^2 W/\\partial \\mathbf{C}\\,\\partial \\mathbf{C} : \\mathbf{D})\\,$ against a second-order central finite-difference approximation,\n- Verify the minor and major symmetries of the fourth-order Hessian restricted to symmetric tensors.\n\nUse the following test suite. For each case, build $\\,\\mathbf{C}=\\mathbf{F}^T\\mathbf{F}\\,$ and use the given symmetric direction $\\,\\mathbf{D}\\,$ and parameters $\\,a,b,c,d,e,f\\,$:\n1. Case 1:\n   - $\\mathbf{F}_1 = \\begin{bmatrix}1&0&0\\\\0&1&0\\\\0&0&1\\end{bmatrix}$,\n   - $\\mathbf{D}_1 = \\begin{bmatrix}0.3&-0.1&0.05\\\\-0.1&0.2&0.07\\\\0.05&0.07&-0.15\\end{bmatrix}$,\n   - $a=1.5,\\,b=0.8,\\,c=2.2,\\,d=0.6,\\,e=-0.4,\\,f=0.9$.\n2. Case 2:\n   - $\\mathbf{F}_2 = \\begin{bmatrix}1.15&0.20&0\\\\0.10&0.95&0.05\\\\0&-0.05&1.10\\end{bmatrix}$,\n   - $\\mathbf{D}_2 = \\begin{bmatrix}-0.2&0.12&0.03\\\\0.12&0.1&-0.04\\\\0.03&-0.04&0.05\\end{bmatrix}$,\n   - $a=2.0,\\,b=1.0,\\,c=1.2,\\,d=-0.3,\\,e=0.55,\\,f=1.1$.\n3. Case 3:\n   - $\\mathbf{F}_3 = \\begin{bmatrix}0.9&0.3&0.1\\\\0&1.05&-0.2\\\\0&0&1.2\\end{bmatrix}$,\n   - $\\mathbf{D}_3 = \\begin{bmatrix}0.08&-0.02&0.01\\\\-0.02&-0.06&0.03\\\\0.01&0.03&0.02\\end{bmatrix}$,\n   - $a=0.7,\\,b=1.5,\\,c=0.9,\\,d=0.4,\\,e=-0.2,\\,f=0.5$.\n4. Case 4:\n   - $\\mathbf{F}_4 = \\begin{bmatrix}1.02&0.02&0\\\\0&0.98&0.01\\\\0&0&1.00\\end{bmatrix}$,\n   - $\\mathbf{D}_4 = \\begin{bmatrix}0.05&0.01&-0.02\\\\0.01&-0.04&0.015\\\\-0.02&0.015&-0.01\\end{bmatrix}$,\n   - $a=1.0,\\,b=1.0,\\,c=10.0,\\,d=0.2,\\,e=0.1,\\,f=0.0$.\n\nNumerical verification details:\n- Use central differences with step sizes $\\,\\varepsilon_1=10^{-7}\\,$ for the first derivative and $\\,\\varepsilon_2=10^{-6}\\,$ for the second derivative along the given $\\,\\mathbf{D}\\,$.\n- For each case, produce three boolean checks:\n  1. Gradient check: $\\,\\left|(\\partial W/\\partial \\mathbf{C}):\\mathbf{D} - \\dfrac{W(\\mathbf{C}+\\varepsilon_1\\mathbf{D}) - W(\\mathbf{C}-\\varepsilon_1\\mathbf{D})}{2\\varepsilon_1}\\right| \\le 10^{-8}\\,$,\n  2. Hessian check: $\\,\\left|\\mathbf{D}:\\left(\\dfrac{\\partial^2 W}{\\partial \\mathbf{C}\\,\\partial \\mathbf{C}}:\\mathbf{D}\\right) - \\dfrac{W(\\mathbf{C}+\\varepsilon_2\\mathbf{D}) - 2W(\\mathbf{C}) + W(\\mathbf{C}-\\varepsilon_2\\mathbf{D})}{\\varepsilon_2^2}\\right| \\le 10^{-6}\\,$,\n  3. Symmetry check: the fourth-order tensor $\\,\\partial^2 W/\\partial \\mathbf{C}\\,\\partial \\mathbf{C}\\,$ satisfies minor and major symmetries to within $\\,10^{-10}\\,$, i.e., $\\,\\|\\mathbb{H}-\\mathbb{H}^{(ij)}\\|_\\infty\\le 10^{-10}\\,$, $\\,\\|\\mathbb{H}-\\mathbb{H}^{(kl)}\\|_\\infty\\le 10^{-10}\\,$, and $\\,\\|\\mathbb{H}-\\mathbb{H}^{(ij\\leftrightarrow kl)}\\|_\\infty\\le 10^{-10}\\,$, where superscripts denote index permutations on the fourth-order tensor.\n\nFinal output format:\n- Your program should produce a single line of output containing the twelve boolean results for the four cases, ordered as $[\\text{grad}_1,\\text{hess}_1,\\text{sym}_1,\\text{grad}_2,\\text{hess}_2,\\text{sym}_2,\\text{grad}_3,\\text{hess}_3,\\text{sym}_3,\\text{grad}_4,\\text{hess}_4,\\text{sym}_4]$, printed as a comma-separated list enclosed in square brackets (e.g., \"[True,True,False, ...]\").\n- No user input is required and no physical units are involved; all quantities are dimensionless.", "solution": "The problem requires the derivation of the first and second derivatives of an isotropic scalar-valued tensor function, the Helmholtz free energy $W$, with respect to its argument, the right Cauchy-Green deformation tensor $\\mathbf{C}$. The energy is given as a function of the principal invariants of $\\mathbf{C}$, $W(\\mathbf{C}) = \\widehat{W}(I_1(\\mathbf{C}), I_2(\\mathbf{C}), I_3(\\mathbf{C}))$.\n\n### Problem Validation\n**Step 1: Extract Givens**\n- The Helmholtz free energy is a function of the invariants of $\\mathbf{C}$: $W(\\mathbf{C}) = \\widehat{W}(I_1, I_2, I_3)$.\n- The invariants are defined as: $I_1 = \\mathrm{tr}\\,\\mathbf{C}$, $I_2 = \\tfrac{1}{2}((\\mathrm{tr}\\,\\mathbf{C})^2 - \\mathrm{tr}\\,\\mathbf{C}^2)$, and $I_3 = \\det\\mathbf{C}$.\n- The differential identities for the invariants are:\n  1. $\\mathrm{d}I_1 = \\mathbf{I} : \\mathrm{d}\\mathbf{C}$\n  2. $\\mathrm{d}I_2 = (I_1\\mathbf{I} - \\mathbf{C}) : \\mathrm{d}\\mathbf{C}$\n  3. $\\mathrm{d}I_3 = I_3\\,\\mathbf{C}^{-1} : \\mathrm{d}\\mathbf{C}$\n- The second derivatives of the invariants are given as:\n  1. $\\partial^2 I_1/\\partial \\mathbf{C}\\,\\partial \\mathbf{C} = \\mathbb{O}$ (zero fourth-order tensor)\n  2. $\\partial^2 I_2/\\partial \\mathbf{C}\\,\\partial \\mathbf{C} = \\mathbf{I}\\otimes\\mathbf{I} - \\mathbb{I}_s$\n  3. $\\partial^2 I_3/\\partial \\mathbf{C}\\,\\partial \\mathbf{C} = I_3\\left(\\mathbf{C}^{-1}\\otimes\\mathbf{C}^{-1} - \\mathbb{K}_s\\right)$\n  Here, $(\\mathbb{I}_s)_{ijkl}=\\tfrac{1}{2}(\\delta_{ik}\\delta_{jl}+\\delta_{il}\\delta_{jk})$ and $(\\mathbb{K}_s)_{ijkl}=\\tfrac{1}{2}((\\mathbf{C}^{-1})_{ik}(\\mathbf{C}^{-1})_{lj}+(\\mathbf{C}^{-1})_{il}(\\mathbf{C}^{-1})_{kj})$.\n- The specific form of the energy function is provided:\n$$\nW(I_1,I_2,I_3) = \\tfrac{1}{2}a\\,(I_1-3)^2 + \\tfrac{1}{2}b\\,(I_2-3)^2 + \\tfrac{1}{2}c\\,(\\ln I_3)^2 + d\\,I_1 I_2 + e\\,I_2 I_3 + f\\,I_1 \\ln I_3\n$$\n- Numerical data for four test cases, including $\\mathbf{F}$, $\\mathbf{D}$, and parameters $a,b,c,d,e,f$.\n- Verification criteria based on central finite differences with specified step sizes and tolerances.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is scientifically well-founded, belonging to the established field of nonlinear continuum mechanics and hyperelasticity. The use of invariants and representation theorems is a cornerstone of this field. All mathematical definitions and identities provided are standard and correct. The problem is well-posed, objective, and self-contained, providing all necessary information for a unique, verifiable solution. There are no contradictions, ambiguities, or scientifically unsound premises.\n\n**Step 3: Verdict and Action**\nThe problem is deemed **valid**. A full derivation and solution will be provided.\n\n### Derivation of Derivatives\nLet $W_\\alpha = \\partial \\widehat{W} / \\partial I_\\alpha$ and $W_{\\alpha\\beta} = \\partial^2 \\widehat{W} / \\partial I_\\alpha \\partial I_\\beta$ denote the partial derivatives of the energy function with respect to its arguments, the invariants.\n\n**1. First Derivative of W with respect to C**\nUsing the chain rule, the first derivative of $W$ with respect to $\\mathbf{C}$ is:\n$$\n\\frac{\\partial W}{\\partial \\mathbf{C}} = \\sum_{\\alpha=1}^{3} \\frac{\\partial \\widehat{W}}{\\partial I_\\alpha} \\frac{\\partial I_\\alpha}{\\partial \\mathbf{C}} = W_1 \\frac{\\partial I_1}{\\partial \\mathbf{C}} + W_2 \\frac{\\partial I_2}{\\partial \\mathbf{C}} + W_3 \\frac{\\partial I_3}{\\partial \\mathbf{C}}\n$$\nThe gradients of the invariants, $\\partial I_\\alpha/\\partial \\mathbf{C}$, can be identified from their differential forms, $\\mathrm{d}I_\\alpha = (\\partial I_\\alpha/\\partial \\mathbf{C}) : \\mathrm{d}\\mathbf{C}$. Given that $\\mathbf{C}$ is symmetric, $\\mathbf{C}^{-T} = \\mathbf{C}^{-1}$.\n- From $\\mathrm{d}I_1 = \\mathbf{I} : \\mathrm{d}\\mathbf{C}$, we have $\\frac{\\partial I_1}{\\partial \\mathbf{C}} = \\mathbf{I}$.\n- From $\\mathrm{d}I_2 = (I_1\\mathbf{I} - \\mathbf{C}) : \\mathrm{d}\\mathbf{C}$, we have $\\frac{\\partial I_2}{\\partial \\mathbf{C}} = I_1\\mathbf{I} - \\mathbf{C}$.\n- From $\\mathrm{d}I_3 = I_3\\mathbf{C}^{-1} : \\mathrm{d}\\mathbf{C}$, we have $\\frac{\\partial I_3}{\\partial \\mathbf{C}} = I_3\\mathbf{C}^{-1}$.\n\nThe partial derivatives $W_\\alpha$ for the given energy function are:\n- $W_1 = \\frac{\\partial \\widehat{W}}{\\partial I_1} = a(I_1-3) + d I_2 + f \\ln I_3$\n- $W_2 = \\frac{\\partial \\widehat{W}}{\\partial I_2} = b(I_2-3) + d I_1 + e I_3$\n- $W_3 = \\frac{\\partial \\widehat{W}}{\\partial I_3} = c \\frac{\\ln I_3}{I_3} + e I_2 + f \\frac{I_1}{I_3}$\n\nSubstituting these components, the first derivative is:\n$$\n\\frac{\\partial W}{\\partial \\mathbf{C}} = \\left(a(I_1-3) + d I_2 + f \\ln I_3\\right)\\mathbf{I} + \\left(b(I_2-3) + d I_1 + e I_3\\right)(I_1\\mathbf{I} - \\mathbf{C}) + \\left(c \\frac{\\ln I_3}{I_3} + e I_2 + f \\frac{I_1}{I_3}\\right)I_3\\mathbf{C}^{-1}\n$$\n\n**2. Second Derivative of W with respect to C**\nThe second derivative, a fourth-order tensor, is obtained by differentiating the first derivative with respect to $\\mathbf{C}$:\n$$\n\\frac{\\partial^2 W}{\\partial \\mathbf{C} \\partial \\mathbf{C}} = \\frac{\\partial}{\\partial \\mathbf{C}} \\left( \\sum_{\\alpha=1}^{3} W_\\alpha \\frac{\\partial I_\\alpha}{\\partial \\mathbf{C}} \\right)\n$$\nApplying the product rule and chain rule for tensor functions:\n$$\n\\frac{\\partial^2 W}{\\partial \\mathbf{C} \\partial \\mathbf{C}} = \\sum_{\\alpha=1}^{3} \\left[ \\frac{\\partial W_\\alpha}{\\partial \\mathbf{C}} \\otimes \\frac{\\partial I_\\alpha}{\\partial \\mathbf{C}} + W_\\alpha \\frac{\\partial^2 I_\\alpha}{\\partial \\mathbf{C} \\partial \\mathbf{C}} \\right]\n$$\nThe term $\\partial W_\\alpha / \\partial \\mathbf{C}$ is expanded using the chain rule again:\n$$\n\\frac{\\partial W_\\alpha}{\\partial \\mathbf{C}} = \\sum_{\\beta=1}^{3} \\frac{\\partial W_\\alpha}{\\partial I_\\beta} \\frac{\\partial I_\\beta}{\\partial \\mathbf{C}} = \\sum_{\\beta=1}^{3} W_{\\alpha\\beta} \\frac{\\partial I_\\beta}{\\partial \\mathbf{C}}\n$$\nSubstituting this back yields the general expression for the material Hessian:\n$$\n\\mathbb{H} = \\frac{\\partial^2 W}{\\partial \\mathbf{C} \\partial \\mathbf{C}} = \\sum_{\\alpha=1}^{3} \\sum_{\\beta=1}^{3} W_{\\alpha\\beta} \\frac{\\partial I_\\beta}{\\partial \\mathbf{C}} \\otimes \\frac{\\partial I_\\alpha}{\\partial \\mathbf{C}} + \\sum_{\\alpha=1}^{3} W_\\alpha \\frac{\\partial^2 I_\\alpha}{\\partial \\mathbf{C} \\partial \\mathbf{C}}\n$$\nWe need the second partial derivatives of $\\widehat{W}$ with respect to the invariants:\n- $W_{11} = \\frac{\\partial^2 \\widehat{W}}{\\partial I_1^2} = a$\n- $W_{12} = \\frac{\\partial^2 \\widehat{W}}{\\partial I_1 \\partial I_2} = d$\n- $W_{13} = \\frac{\\partial^2 \\widehat{W}}{\\partial I_1 \\partial I_3} = \\frac{f}{I_3}$\n- $W_{22} = \\frac{\\partial^2 \\widehat{W}}{\\partial I_2^2} = b$\n- $W_{23} = \\frac{\\partial^2 \\widehat{W}}{\\partial I_2 \\partial I_3} = e$\n- $W_{33} = \\frac{\\partial^2 \\widehat{W}}{\\partial I_3^2} = c \\frac{1 - \\ln I_3}{I_3^2} - f \\frac{I_1}{I_3^2}$\n\nLet's denote $\\mathbf{G}_\\alpha = \\partial I_\\alpha / \\partial \\mathbf{C}$ and $\\mathbb{H}_\\alpha = \\partial^2 I_\\alpha / \\partial \\mathbf{C} \\partial \\mathbf{C}$. The Hessian is\n$$\n\\mathbb{H} = \\sum_{\\alpha, \\beta=1}^{3} W_{\\alpha\\beta} \\, (\\mathbf{G}_\\beta \\otimes \\mathbf{G}_\\alpha) + W_1 \\mathbb{H}_1 + W_2 \\mathbb{H}_2 + W_3 \\mathbb{H}_3\n$$\nSubstituting the given expressions for $\\mathbb{H}_\\alpha$:\n$$\n\\mathbb{H} = \\sum_{\\alpha, \\beta=1}^{3} W_{\\alpha\\beta} \\, (\\mathbf{G}_\\beta \\otimes \\mathbf{G}_\\alpha) + W_2 (\\mathbf{I}\\otimes\\mathbf{I} - \\mathbb{I}_s) + W_3 I_3\\left(\\mathbf{C}^{-1}\\otimes\\mathbf{C}^{-1} - \\mathbb{K}_s\\right)\n$$\nThis expression is explicit in terms of $\\mathbf{C}$, its invariants, and the material parameters. It can be directly implemented numerically. The first term is a sum of nine dyadic products of second-order tensors. The remaining terms are scaled versions of the given fourth-order tensors. This final expression for $\\mathbb{H}$ will be used in the implementation for verification.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main solver function that iterates through test cases and prints results.\n    \"\"\"\n    # Define test cases as per the problem statement\n    test_cases = [\n        {\n            \"F\": np.array([[1.0, 0.0, 0.0], [0.0, 1.0, 0.0], [0.0, 0.0, 1.0]]),\n            \"D\": np.array([[0.3, -0.1, 0.05], [-0.1, 0.2, 0.07], [0.05, 0.07, -0.15]]),\n            \"params\": (1.5, 0.8, 2.2, 0.6, -0.4, 0.9)  # a, b, c, d, e, f\n        },\n        {\n            \"F\": np.array([[1.15, 0.20, 0.0], [0.10, 0.95, 0.05], [0.0, -0.05, 1.10]]),\n            \"D\": np.array([[-0.2, 0.12, 0.03], [0.12, 0.1, -0.04], [0.03, -0.04, 0.05]]),\n            \"params\": (2.0, 1.0, 1.2, -0.3, 0.55, 1.1)\n        },\n        {\n            \"F\": np.array([[0.9, 0.3, 0.1], [0.0, 1.05, -0.2], [0.0, 0.0, 1.2]]),\n            \"D\": np.array([[0.08, -0.02, 0.01], [-0.02, -0.06, 0.03], [0.01, 0.03, 0.02]]),\n            \"params\": (0.7, 1.5, 0.9, 0.4, -0.2, 0.5)\n        },\n        {\n            \"F\": np.array([[1.02, 0.02, 0.0], [0.0, 0.98, 0.01], [0.0, 0.0, 1.00]]),\n            \"D\": np.array([[0.05, 0.01, -0.02], [0.01, -0.04, 0.015], [-0.02, 0.015, -0.01]]),\n            \"params\": (1.0, 1.0, 10.0, 0.2, 0.1, 0.0)\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        F = case[\"F\"]\n        D = case[\"D\"]\n        params = case[\"params\"]\n        grad_check, hess_check, sym_check = perform_case_analysis(F, D, params)\n        results.extend([grad_check, hess_check, sym_check])\n\n    print(f\"[{','.join(map(str, results))}]\")\n\ndef _calculate_W(C_tensor, params):\n    \"\"\"Helper function to compute the scalar energy W for a given C.\"\"\"\n    a, b, c, d, e, f = params\n    I1 = np.trace(C_tensor)\n    I2 = 0.5 * (I1**2 - np.trace(C_tensor @ C_tensor))\n    I3 = np.linalg.det(C_tensor)\n    \n    if I3 <= 0: return np.inf # Physically inadmissible state\n    ln_I3 = np.log(I3)\n\n    return (0.5 * a * (I1 - 3)**2 +\n            0.5 * b * (I2 - 3)**2 +\n            0.5 * c * ln_I3**2 +\n            d * I1 * I2 +\n            e * I2 * I3 +\n            f * I1 * ln_I3)\n\ndef perform_case_analysis(F, D, params):\n    \"\"\"\n    Performs the full analysis for a single test case:\n    1. Computes W, gradient, and Hessian.\n    2. Verifies gradient and Hessian via finite differences.\n    3. Verifies symmetries of the Hessian.\n    Returns three boolean checks.\n    \"\"\"\n    a, b, c, d, e, f = params\n    eps1, eps2 = 1e-7, 1e-6\n    grad_tol, hess_tol, sym_tol = 1e-8, 1e-6, 1e-10\n\n    # Basic Tensors\n    C = F.T @ F\n    C_inv = np.linalg.inv(C)\n    I = np.eye(3)\n\n    # Invariants\n    I1 = np.trace(C)\n    I2 = 0.5 * (I1**2 - np.trace(C @ C))\n    I3 = np.linalg.det(C)\n    ln_I3 = np.log(I3)\n\n    # Energy\n    W = _calculate_W(C, params)\n\n    # First derivatives of W w.r.t. invariants\n    W1 = a * (I1 - 3) + d * I2 + f * ln_I3\n    W2 = b * (I2 - 3) + d * I1 + e * I3\n    W3 = c * ln_I3 / I3 + e * I2 + f * I1 / I3\n\n    # First derivative of W w.r.t. C\n    dW_dC = W1 * I + W2 * (I1 * I - C) + W3 * I3 * C_inv\n\n    # Second derivatives of W w.r.t. invariants\n    W11 = a\n    W12 = d\n    W13 = f / I3\n    W22 = b\n    W23 = e\n    W33 = c * (1 - ln_I3) / I3**2 - f * I1 / I3**2\n    W_ab = np.array([[W11, W12, W13], [W12, W22, W23], [W13, W23, W33]])\n\n    # Assemble the Hessian (4th order tensor)\n    G_alpha = [I, I1 * I - C, I3 * C_inv]\n    \n    H_term1 = np.zeros((3, 3, 3, 3))\n    for alpha in range(3):\n        for beta in range(3):\n            H_term1 += W_ab[alpha, beta] * np.einsum('ij,kl->ijkl', G_alpha[beta], G_alpha[alpha])\n\n    # Special 4th-order tensors\n    II = np.einsum('ij,kl->ijkl', I, I)\n    Is = 0.5 * (np.einsum('ik,jl->ijkl', I, I) + np.einsum('il,jk->ijkl', I, I))\n    \n    CInvCInv = np.einsum('ij,kl->ijkl', C_inv, C_inv)\n    # Note: C_inv is symmetric, so C_inv_lj = C_inv_jl.\n    Ks = 0.5 * (np.einsum('ik,jl->ijkl', C_inv, C_inv) + np.einsum('il,jk->ijkl', C_inv, C_inv))\n\n    H_term2 = W2 * (II - Is)\n    H_term3 = W3 * I3 * (CInvCInv - Ks)\n\n    H = H_term1 + H_term2 + H_term3\n\n    # --- Verification ---\n\n    # 1. Gradient Check\n    grad_ana = np.sum(dW_dC * D)\n    W_p1 = _calculate_W(C + eps1 * D, params)\n    W_m1 = _calculate_W(C - eps1 * D, params)\n    grad_fd = (W_p1 - W_m1) / (2 * eps1)\n    grad_check = np.abs(grad_ana - grad_fd) <= grad_tol\n\n    # 2. Hessian Check\n    hess_ana = np.einsum('ijkl,ij,kl', H, D, D)\n    W_p2 = _calculate_W(C + eps2 * D, params)\n    W_m2 = _calculate_W(C - eps2 * D, params)\n    hess_fd = (W_p2 - 2 * W + W_m2) / eps2**2\n    hess_check = np.abs(hess_ana - hess_fd) <= hess_tol\n\n    # 3. Symmetry Check\n    minor_sym1_check = np.max(np.abs(H - H.transpose(1, 0, 2, 3))) <= sym_tol\n    minor_sym2_check = np.max(np.abs(H - H.transpose(0, 1, 3, 2))) <= sym_tol\n    major_sym_check = np.max(np.abs(H - H.transpose(2, 3, 0, 1))) <= sym_tol\n    sym_check = minor_sym1_check and minor_sym2_check and major_sym_check\n\n    return grad_check, hess_check, sym_check\n\nif __name__ == '__main__':\n    solve()\n```", "id": "3595206"}]}