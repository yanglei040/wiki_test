{"hands_on_practices": [{"introduction": "Index notation truly shines when performing complex tensor calculus operations. This first practice challenges you to derive a cornerstone identity in continuum mechanics: the derivative of the Jacobian determinant with respect to the deformation gradient [@problem_id:3574041]. By working from the fundamental definition of the determinant using the Levi-Civita symbol, you will gain invaluable experience in applying the product rule and manipulating indices to arrive at a compact and powerful result.", "problem": "Consider a finite deformation of a continuum body from a reference configuration to a current configuration, and let the deformation gradient be denoted by $F_{iI}$, where lowercase Latin indices $i,j,k$ refer to the current (spatial) components and uppercase Latin indices $I,J,K$ refer to the reference (material) components. The local volume change is given by the Jacobian determinant $J=\\det F$. A core, coordinate-free definition of the determinant in index notation is\n$$\nJ=\\frac{1}{6}\\,\\epsilon_{ijk}\\,\\epsilon_{IJK}\\,F_{iI}\\,F_{jJ}\\,F_{kK},\n$$\nwhere $\\epsilon_{abc}$ is the Levi-Civita symbol and repeated indices imply summation (Einstein summation convention). Using only fundamental definitions and properties of index notation, namely the product rule for differentiation, the Kronecker delta $\\delta_{ab}$, and the antisymmetry of the Levi-Civita symbol, compute the derivative $\\frac{\\partial J}{\\partial F_{iJ}}$ in closed form and express it solely in terms of $J$ and the inverse of the deformation gradient $F^{-1}_{Ji}$. Your derivation must start from the given definition of $J$ above and explicitly use index operations; you may not assume any pre-known formula for the derivative of a determinant.\n\nProvide your final answer as a single analytical expression. No numerical evaluation is required.", "solution": "The problem asks for the derivative of the Jacobian determinant $J$ with respect to the deformation gradient tensor $F_{iI}$. The derivation must start from the provided index-notation definition of the determinant and use only fundamental properties of index notation.\n\nThe Jacobian determinant $J$ is given by\n$$\nJ = \\frac{1}{6}\\,\\epsilon_{ijk}\\,\\epsilon_{IJK}\\,F_{iI}\\,F_{jJ}\\,F_{kK}\n$$\nTo compute the derivative $\\frac{\\partial J}{\\partial F_{pQ}}$, where we use indices $(p,Q)$ for the derivative to avoid confusion with the dummy summation indices in the definition of $J$, we apply the differentiation operator. The components of the deformation gradient $F_{iI}$ are considered independent variables, so we have the fundamental relation $\\frac{\\partial F_{iI}}{\\partial F_{pQ}} = \\delta_{ip}\\delta_{IQ}$, where $\\delta$ is the Kronecker delta.\n\nWe apply the product rule for differentiation to the expression for $J$:\n$$\n\\frac{\\partial J}{\\partial F_{pQ}} = \\frac{1}{6}\\,\\epsilon_{ijk}\\,\\epsilon_{IJK} \\, \\frac{\\partial}{\\partial F_{pQ}} (F_{iI}\\,F_{jJ}\\,F_{kK})\n$$\n$$\n\\frac{\\partial J}{\\partial F_{pQ}} = \\frac{1}{6}\\,\\epsilon_{ijk}\\,\\epsilon_{IJK} \\left( \\left(\\frac{\\partial F_{iI}}{\\partial F_{pQ}}\\right) F_{jJ}\\,F_{kK} + F_{iI}\\left(\\frac{\\partial F_{jJ}}{\\partial F_{pQ}}\\right)F_{kK} + F_{iI}F_{jJ}\\left(\\frac{\\partial F_{kK}}{\\partial F_{pQ}}\\right) \\right)\n$$\nSubstituting $\\frac{\\partial F_{iI}}{\\partial F_{pQ}} = \\delta_{ip}\\delta_{IQ}$, the expression becomes:\n$$\n\\frac{\\partial J}{\\partial F_{pQ}} = \\frac{1}{6}\\,\\epsilon_{ijk}\\,\\epsilon_{IJK} \\left( (\\delta_{ip}\\delta_{IQ}) F_{jJ}\\,F_{kK} + (\\delta_{jp}\\delta_{JQ}) F_{iI}\\,F_{kK} + (\\delta_{kp}\\delta_{KQ}) F_{iI}\\,F_{jJ} \\right)\n$$\nWe analyze the three terms within the parentheses separately.\n\nTerm 1: We contract the Kronecker deltas with the tensors, substituting $i \\to p$ and $I \\to Q$.\n$$\n\\epsilon_{ijk}\\,\\epsilon_{IJK} (\\delta_{ip}\\delta_{IQ}) F_{jJ}\\,F_{kK} = \\epsilon_{pjk}\\,\\epsilon_{QJK}\\,F_{jJ}\\,F_{kK}\n$$\n\nTerm 2: We contract the Kronecker deltas, substituting $j \\to p$ and $J \\to Q$.\n$$\n\\epsilon_{ijk}\\,\\epsilon_{IJK} (\\delta_{jp}\\delta_{JQ}) F_{iI}\\,F_{kK} = \\epsilon_{ipk}\\,\\epsilon_{IQK}\\,F_{iI}\\,F_{kK}\n$$\nThe summation indices in this term are $(i,I,k,K)$. These are dummy indices and can be relabeled. Let us rename them to match the indices in Term 1: let $i \\to j$, $I \\to J$ and $k \\to k'$, $K \\to K'$. This yields $\\epsilon_{jpk'}\\,\\epsilon_{JQ K'}\\,F_{jJ}\\,F_{k'K'}$. Using the antisymmetry of the Levi-Civita symbol, $\\epsilon_{jpk'} = -\\epsilon_{pjk'}$ and $\\epsilon_{JQK'} = -\\epsilon_{QJK'}$. Thus, the term becomes $(-\\epsilon_{pjk'})(-\\epsilon_{QJK'})F_{jJ}\\,F_{k'K'} = \\epsilon_{pjk'}\\epsilon_{QJK'}F_{jJ}F_{k'K'}$. As $k'$ and $K'$ are also dummy indices, we can rename them to $k$ and $K$, showing that Term 2 is identical to Term 1.\n\nTerm 3: We contract the Kronecker deltas, substituting $k \\to p$ and $K \\to Q$.\n$$\n\\epsilon_{ijk}\\,\\epsilon_{IJK} (\\delta_{kp}\\delta_{KQ}) F_{iI}\\,F_{jJ} = \\epsilon_{ijp}\\,\\epsilon_{IJQ}\\,F_{iI}\\,F_{jJ}\n$$\nBy a similar relabeling of dummy indices and use of antisymmetry (two swaps in each epsilon, e.g., $\\epsilon_{ijp}=\\epsilon_{pij}$), this term can also be shown to be identical to Term 1.\n\nSince the three terms are identical, their sum is three times one of them:\n$$\n\\frac{\\partial J}{\\partial F_{pQ}} = \\frac{1}{6} \\left( 3 \\times \\epsilon_{pjk}\\,\\epsilon_{QJK}\\,F_{jJ}\\,F_{kK} \\right) = \\frac{1}{2}\\,\\epsilon_{pjk}\\,\\epsilon_{QJK}\\,F_{jJ}\\,F_{kK}\n$$\nThis expression is the component $(p, Q)$ of the cofactor matrix of $F$, denoted as $C_{pQ}$. The problem now requires expressing this result in terms of $J$ and the inverse deformation gradient, $F^{-1}$. This requires relating the cofactor matrix to the inverse matrix. The relationship is given by Cramer's rule: $C = J (F^{-1})^T$. In index notation, this is $C_{pQ} = J F^{-1}_{Qp}$. We will now derive this relationship from fundamental principles.\n\nLet's prove the related identity $C F^T = J I$, or in index notation, $C_{pI} (F^T)_{Ik} = J\\delta_{pk}$, which is $C_{pI} F_{kI} = J\\delta_{pk}$.\nConsider the product $C_{pI} F_{kI}$:\n$$\nC_{pI} F_{kI} = \\left( \\frac{1}{2}\\,\\epsilon_{pmn}\\,\\epsilon_{IMN}\\,F_{mM}\\,F_{nN} \\right) F_{kI}\n$$\nRearranging the terms, we get:\n$$\nC_{pI} F_{kI} = \\frac{1}{2}\\,\\epsilon_{pmn} \\left( \\epsilon_{IMN}\\,F_{kI}\\,F_{mM}\\,F_{nN} \\right)\n$$\nThe expression in the parenthesis, $\\epsilon_{IMN}\\,F_{kI}\\,F_{mM}\\,F_{nN}$, involves summation over the material indices $(I,M,N)$. This expression is a fundamental representation of the determinant. Specifically, for any matrix $A$, we have the identity $\\epsilon_{IJK} A_{pI} A_{qJ} A_{rK} = \\det(A) \\epsilon_{pqr}$. Applying this to our expression with matrix $F$, we get:\n$$\n\\epsilon_{IMN}\\,F_{kI}\\,F_{mM}\\,F_{nN} = J\\,\\epsilon_{kmn}\n$$\nSubstituting this back into our equation for $C_{pI} F_{kI}$:\n$$\nC_{pI} F_{kI} = \\frac{1}{2}\\,\\epsilon_{pmn} (J\\,\\epsilon_{kmn}) = \\frac{J}{2}\\,\\epsilon_{pmn}\\,\\epsilon_{kmn}\n$$\nWe now use the $\\epsilon-\\delta$ identity, which relates the product of two Levi-Civita symbols to Kronecker deltas. The contraction over two indices gives $\\epsilon_{imn}\\epsilon_{jmn} = 2\\delta_{ij}$. Using this identity with our indices ($p$ and $k$), we have:\n$$\n\\epsilon_{pmn}\\,\\epsilon_{kmn} = 2\\delta_{pk}\n$$\nTherefore,\n$$\nC_{pI} F_{kI} = \\frac{J}{2} (2\\delta_{pk}) = J\\delta_{pk}\n$$\n This confirms the matrix identity $C F^T = J I$. To find $C$, we right-multiply by $(F^T)^{-1}$:\n$$\nC = J (F^T)^{-1} = J (F^{-1})^T\n$$\nIn component form, this gives the relationship between the cofactor component $C_{pQ}$ and the inverse tensor component:\n$$\nC_{pQ} = J ((F^{-1})^T)_{pQ} = J F^{-1}_{Qp}\n$$\nWe have already shown that $\\frac{\\partial J}{\\partial F_{pQ}} = C_{pQ}$. Therefore,\n$$\n\\frac{\\partial J}{\\partial F_{pQ}} = J F^{-1}_{Qp}\n$$\nThe problem statement asks for $\\frac{\\partial J}{\\partial F_{iJ}}$. By replacing the free indices $(p,Q)$ with $(i,J)$, we obtain the final expression. The result should be expressed in terms of $J$ and the components of the inverse tensor, which are conventionally written as $F^{-1}_{Ji}$ (first index material, second index spatial). Our derived expression $J F^{-1}_{Ji}$ respects this convention.\n\nThus, the derivative is:\n$$\n\\frac{\\partial J}{\\partial F_{iJ}} = J F^{-1}_{Ji}\n$$\nThis result is also known as Jacobi's formula. Our derivation used only the specified fundamental tools, starting from the given definition of the determinant.", "answer": "$$\n\\boxed{J F^{-1}_{Ji}}\n$$", "id": "3574041"}, {"introduction": "The rules of the summation convention are not merely mathematical formalisms; they are essential for upholding fundamental physical principles. This next exercise demonstrates the critical link between correct index contraction and the principle of material frame-indifference, or objectivity [@problem_id:3574098]. Through a carefully constructed counterexample, you will see how a seemingly plausible \"energy\" function fails this physical test, highlighting why constitutive laws must be built upon true scalar invariants like those derived from the right Cauchy-Green tensor.", "problem": "Consider a hyperelastic solid undergoing a deformation with deformation gradient $F_{ij} = \\partial x_i / \\partial X_j$. In index notation with the Einstein summation convention (repeated indices are summed), the frame-indifference (objectivity) requirement states that a superposed rigid body motion with a proper orthogonal tensor $R_{ik}$, satisfying $R_{ik} R_{jk} = \\delta_{ij}$ and $\\det R = 1$, must not change the stored energy density $W$: that is, $W(R_{ik} F_{kj}) = W(F_{ij})$. A standard route to ensure objectivity is to express $W$ in terms of the right Cauchy–Green deformation tensor $C_{ij} = F_{ki} F_{kj}$. \n\nA common pitfall when using index notation is to drop the Einstein summation on repeated indices and inadvertently turn a scalar contraction into a componentwise product. To expose the danger, consider the following deliberately faulty derivation. Starting from a quadratic form $W(F_{ij})$ that, when properly contracted, would produce a scalar, suppose one carelessly rewrites $F_{ij} F_{ij}$ without summation and then, to extract a “scalar,” keeps only the $(i,j)=(1,2)$ component, thereby defining the non-objective quantity $\\widetilde{W}(F_{ij}) = \\tfrac{\\mu}{2}\\,F_{12} F_{12}$, where $\\mu>0$ is a constant. \n\nConstruct a concrete counterexample demonstrating that $\\widetilde{W}$ violates objectivity, and then fix the construction by introducing $C_{ij} = F_{ki} F_{kj}$. Proceed as follows:\n\n1. Let $F_{ij}$ be a pure stretch with $F_{ij} = \\mathrm{diag}(\\lambda_1,\\lambda_2,\\lambda_3)$, where $\\lambda_1,\\lambda_2,\\lambda_3>0$ and all off-diagonal components vanish. Let $R_{ij}(\\theta)$ be a rotation about the $x_3$-axis through angle $\\theta$, with components\n$$\nR_{ij}(\\theta) = \n\\begin{pmatrix}\n\\cos\\theta & -\\sin\\theta & 0\\\\\n\\sin\\theta & \\cos\\theta & 0\\\\\n0 & 0 & 1\n\\end{pmatrix}.\n$$\nCompute $(RF)_{12} = R_{1k} F_{k2}$ and use it to evaluate the “energy” $\\widetilde{W}(RF)$ implied by the faulty derivation.\n\n2. Using your result, obtain the spurious energy shift $\\Delta \\widetilde{W}(\\theta) = \\widetilde{W}(R(\\theta)F) - \\widetilde{W}(F)$ in closed form, expressed in terms of $\\mu$, $\\lambda_2$, and $\\theta$.\n\n3. Now correct the construction by introducing the right Cauchy–Green tensor $C_{ij} = F_{ki} F_{kj}$ and the properly contracted scalar $I_1 = C_{ii}$. Using index notation and the orthogonality of $R_{ij}(\\theta)$, show that $I_1(RF) = I_1(F)$, thereby restoring objectivity. Do not skip contraction steps in your demonstration.\n\nProvide the exact analytic expression for the quantity in step 2 as your final answer. No numerical evaluation is required, and no units are needed.", "solution": "The problem asks for three tasks: first, to demonstrate the non-objectivity of a faultily constructed \"stored energy\" function; second, to quantify the spurious energy change under a rigid body rotation; and third, to show how a proper construction using the right Cauchy–Green deformation tensor restores objectivity.\n\n**Part 1: Compute $(RF)_{12}$ and $\\widetilde{W}(RF)$**\n\nLet the transformed deformation gradient be $F'_{ij} = (RF)_{ij}$. Using the Einstein summation convention, this is written as:\n$$ F'_{ij} = R_{ik} F_{kj} $$\nWe are asked to compute the component $(RF)_{12}$, which is $F'_{12}$. The summation over the repeated index $k$ (from $1$ to $3$) is expanded as:\n$$ F'_{12} = R_{1k} F_{k2} = R_{11} F_{12} + R_{12} F_{22} + R_{13} F_{32} $$\nWe substitute the given component values for the tensors $R_{ij}$ and $F_{ij}$:\n- From $R_{ij}(\\theta)$: $R_{11} = \\cos\\theta$, $R_{12} = -\\sin\\theta$, $R_{13} = 0$.\n- From $F_{ij} = \\mathrm{diag}(\\lambda_1, \\lambda_2, \\lambda_3)$: $F_{12} = 0$, $F_{22} = \\lambda_2$, $F_{32} = 0$.\n\nSubstituting these values into the expression for $F'_{12}$:\n$$ F'_{12} = (\\cos\\theta)(0) + (-\\sin\\theta)(\\lambda_2) + (0)(0) = -\\lambda_2 \\sin\\theta $$\nNow we can evaluate the faulty energy function $\\widetilde{W}$ for the transformed deformation gradient $F'_{ij} = (RF)_{ij}$. The definition is $\\widetilde{W}(F'_{ij}) = \\frac{\\mu}{2} F'_{12} F'_{12}$.\n$$ \\widetilde{W}(RF) = \\frac{\\mu}{2} (F'_{12})^2 = \\frac{\\mu}{2} (-\\lambda_2 \\sin\\theta)^2 = \\frac{\\mu}{2} \\lambda_2^2 \\sin^2(\\theta) $$\nThis result shows that the value of $\\widetilde{W}$ depends on the rotation angle $\\theta$, which is a direct violation of the principle of objectivity.\n\n**Part 2: Compute the spurious energy shift $\\Delta \\widetilde{W}(\\theta)$**\n\nThe spurious energy shift is defined as $\\Delta \\widetilde{W}(\\theta) = \\widetilde{W}(R(\\theta)F) - \\widetilde{W}(F)$. We have already calculated the first term. We now calculate the second term, $\\widetilde{W}(F)$, for the original deformation state:\n$$ \\widetilde{W}(F) = \\frac{\\mu}{2} F_{12} F_{12} $$\nSince the initial deformation $F_{ij}$ is a pure stretch, its off-diagonal components are zero. In particular, $F_{12} = 0$. Therefore:\n$$ \\widetilde{W}(F) = \\frac{\\mu}{2} (0)^2 = 0 $$\nThe energy shift is then:\n$$ \\Delta \\widetilde{W}(\\theta) = \\left( \\frac{\\mu}{2} \\lambda_2^2 \\sin^2(\\theta) \\right) - 0 = \\frac{\\mu}{2} \\lambda_2^2 \\sin^2(\\theta) $$\nThis expression quantifies the non-objective change in the faulty \"energy\" due to a pure rotation. Since $\\lambda_2 > 0$ and $\\mu > 0$, this shift is non-zero for any $\\theta$ for which $\\sin\\theta \\neq 0$.\n\n**Part 3: Correct the construction and demonstrate objectivity**\n\nTo correct the formulation, we must base the stored energy function on a quantity that is invariant under rigid rotations. The right Cauchy–Green tensor $C_{ij} = F_{ki} F_{kj}$ is such a quantity. Let's demonstrate that the tensor $C_{ij}$ itself is objective.\n\nLet $F'_{ij} = R_{ik} F_{kj}$ be the rotated deformation gradient. The corresponding right Cauchy–Green tensor, let's call it $C'_{ab}$, is given by:\n$$ C'_{ab} = F'_{ka} F'_{kb} $$\nSubstitute the expression for $F'_{ij}$:\n$$ C'_{ab} = (R_{kc} F_{ca}) (R_{kd} F_{db}) $$\nwhere $c$ and $d$ are new dummy indices for summation. We can rearrange the terms since they are scalars:\n$$ C'_{ab} = (R_{kc} R_{kd}) (F_{ca} F_{db}) $$\nThe term $R_{kc} R_{kd}$ involves a summation over the repeated index $k$. This corresponds to the matrix product $R^T R$. The components of the transpose tensor $(R^T)$ are $(R^T)_{ck} = R_{kc}$. So, the expression is the $(c,d)$ component of $R^T R$:\n$$ R_{kc} R_{kd} = (R^T)_{ck} R_{kd} = (R^T R)_{cd} $$\nBecause $R_{ij}$ is an orthogonal tensor, we have $R^T R = I$, where $I$ is the identity tensor. In index notation, this is $(R^T R)_{cd} = \\delta_{cd}$. Therefore:\n$$ R_{kc} R_{kd} = \\delta_{cd} $$\nSubstituting this back into the expression for $C'_{ab}$:\n$$ C'_{ab} = \\delta_{cd} (F_{ca} F_{db}) $$\nThe Kronecker delta $\\delta_{cd}$ is $1$ if $c=d$ and $0$ otherwise. The summation over $c$ (or $d$) collapses:\n$$ C'_{ab} = F_{da} F_{db} $$\nThis expression, $F_{da} F_{db}$, is exactly the definition of the original right Cauchy–Green tensor $C_{ab} = F_{ka} F_{kb}$ (with the dummy index just named $d$ instead of $k$). Thus, we have shown that:\n$$ C'_{ab} = C_{ab} $$\nThe right Cauchy–Green tensor is itself invariant under the superposed rotation. Consequently, any scalar function of $C_{ij}$ will also be objective.\n\nThe problem specifically asks to show this for the first invariant, $I_1 = C_{ii}$. For the original deformation $F$, this is $I_1(F) = C_{ii} = F_{ki} F_{ki}$. For the rotated deformation $F'$, this is $I_1(RF) = C'_{ii} = F'_{ki} F'_{ki}$. Using our intermediate result $C'_{ij} = C_{ij}$, it immediately follows that $C'_{ii} = C_{ii}$, and therefore $I_1(RF) = I_1(F)$.\n\nThis completes the demonstration. The use of a proper tensorial contraction, as in the definition of $C_{ij}$, ensures that the resulting quantity is a proper scalar or tensor that transforms correctly under coordinate system changes, and in this case, a particular scalar invariant of $C_{ij}$ is shown to be objective. The faulty function $\\widetilde{W}$ failed because it arbitrarily selected a single component, $F_{12}$, whose value is not preserved under rotations.\n\nThe final answer required is the expression for $\\Delta \\widetilde{W}(\\theta)$ derived in Part 2.", "answer": "$$\\boxed{\\frac{\\mu}{2} \\lambda_2^2 \\sin^2(\\theta)}$$", "id": "3574098"}, {"introduction": "Our final practice bridges the gap between theoretical tensor analysis and the practical realities of computational solid mechanics. In developing finite element codes, index-related errors are a frequent and subtle source of bugs that can lead to physically incorrect results [@problem_id:3574084]. This problem asks you to step into the role of a methods developer and use first principles—such as energy conjugacy and objectivity—to design robust diagnostic tests that can detect these errors in the assembly of an internal force vector.", "problem": "In the Total Lagrangian Finite Element Method (FEM) for large deformation solid mechanics, the balance of linear momentum in the reference configuration is expressed in index notation as $$P_{iJ,J} + B_i = 0 \\quad \\text{in } \\Omega_0,$$ where $P_{iJ}$ is the First Piola–Kirchhoff stress (FPK), $B_i$ is the body force per unit reference volume, $\\Omega_0$ is the reference domain, lowercase indices $(i,j,k)$ denote spatial components in the current configuration, and uppercase indices $(I,J,K)$ denote material components in the reference configuration. The corresponding weak form uses the virtual displacement field $\\delta u_i$ and its gradient with respect to the material coordinates $X_J$, namely $\\delta u_{i,J}$.\n\nUpon spatial discretization, taking the virtual displacement field as $\\delta u_i = N_a \\, \\delta d_{a i}$, where $N_a$ is a scalar shape function and $\\delta d_{a i}$ are nodal virtual displacements, the internal force (residual) vector for node $a$ and spatial component $i$ emerges as\n$$R_{a i} = \\int_{\\Omega_0} N_{a,J} \\, P_{iJ} \\, dV_0,$$\nup to external traction terms.\n\nPractical implementations sometimes mistakenly mix reference and current configuration indices, leading to bugs such as using $N_{a,i}$ instead of $N_{a,J}$ inside $\\Omega_0$, or forming an accidental contraction of $P_{iJ}$ with a spatial gradient or deformation gradient component with mismatched indices (e.g., $P_{iJ} F_{ij}$), which violates the pull-back/push-forward structure and the summation convention.\n\nSelect all options that describe scientifically sound and effective diagnostic tests, derived from first principles, to detect such index-position errors in assembling element residuals and to ensure the correct reference/current configuration mix.\n\nA. Energy conjugacy test: Starting from the definition of internal virtual work in the reference configuration, $$\\delta W_{\\text{int}} = \\int_{\\Omega_0} P_{iJ} \\, \\delta F_{iJ} \\, dV_0,$$ with $\\delta F_{iJ} = \\delta u_{i,J}$, verify numerically that $$\\delta W_{\\text{int}} = \\sum_a R_{a i} \\, \\delta d_{a i}$$ holds for arbitrary virtual nodal displacements. This test fails if $R_{a i}$ is assembled using $N_{a,i}$ or any mismatched contraction such as $P_{iJ} F_{ij}$.\n\nB. Objectivity and rigid-body motion patch test: Apply a superposed rigid rotation $Q_{ik}$ to any deformation (so $F'_{iJ} = Q_{ik} F_{kJ}$ and $P'_{iJ} = Q_{ik} P_{kJ}$) and check that the assembled residual transforms as a spatial vector (i.e., $R'_{a i} = Q_{ik} R_{a k}$). Additionally, for a pure rigid rotation $F_{iJ} = Q_{iJ}$ with no external loads and stress-free reference state, verify $R_{a i} = 0$. Index mismatches in $R_{a i}$ violate these invariance properties.\n\nC. Scalar contraction check in the current configuration: Form the scalar $$S_a = \\int_{\\Omega_0} N_a \\, P_{iJ} \\, F_{ij} \\, dV_0$$ and require $S_a = 0$ under rigid rotation. This checks whether the contraction of a mixed tensor $P_{iJ}$ with $F_{ij}$ is objective and thus can diagnose indexing errors.\n\nD. Push-forward equivalence test: Assemble the internal forces in two mathematically equivalent ways—(i) Total Lagrangian form $$R_{a i}^{(0)} = \\int_{\\Omega_0} N_{a,J} \\, P_{iJ} \\, dV_0,$$ and (ii) Updated Lagrangian form using the Cauchy stress $\\sigma_{ij}$ and the current-domain gradient $$R_{a i}^{(t)} = \\int_{\\Omega} N_{a,j} \\, \\sigma_{ij} \\, dV,$$—and verify $R_{a i}^{(0)} = R_{a i}^{(t)}$ for the same state by using the Piola identity $P_{iJ} = J \\, \\sigma_{ik} \\, F^{-1}_{kJ}$ and $dV = J \\, dV_0$. Any misuse of $N_{a,i}$ in $\\Omega_0$ or mismatched contractions will break this equivalence.\n\nE. Index reassignment check: Because both $i$ and $J$ are component labels, verify correctness by reassigning the contraction to the spatial index, $$R_a = \\int_{\\Omega_0} N_{a,i} \\, P_{iJ} \\, dV_0,$$ so that only the repeated index $i$ is contracted. This reassignment is acceptable provided the integral is over $\\Omega_0$.\n\nChoose all that apply.", "solution": "The correct expression for the internal force vector at node $a$ in spatial direction $i$ is derived from the principle of virtual work. The internal virtual work is given by:\n$$ \\delta W_{\\text{int}} = \\int_{\\Omega_0} P_{iJ} \\delta F_{iJ} \\, dV_0 $$\nwhere $P_{iJ}$ is the First Piola-Kirchhoff stress tensor and $\\delta F_{iJ}$ is the variation of the deformation gradient. The variation of the deformation gradient is the gradient of the virtual displacement, $\\delta F_{iJ} = \\delta u_{i,J}$. Using the finite element discretization for the virtual displacement field, $\\delta u_i = N_a(X_K) \\, \\delta d_{ai}$, its gradient with respect to the material coordinates $X_J$ is $\\delta u_{i,J} = N_{a,J} \\, \\delta d_{ai}$. Substituting this into the virtual work expression yields:\n$$ \\delta W_{\\text{int}} = \\int_{\\Omega_0} P_{iJ} (N_{a,J} \\, \\delta d_{ai}) \\, dV_0 = \\delta d_{ai} \\int_{\\Omega_0} N_{a,J} \\, P_{iJ} \\, dV_0 $$\nThe internal virtual work can also be expressed discretely as the work done by the internal nodal forces $R_{ai}$ over the virtual nodal displacements $\\delta d_{ai}$:\n$$ \\delta W_{\\text{int}} = R_{ai} \\, \\delta d_{ai} $$\n(summation over repeated indices $a$ and $i$ is implied). By comparing the two expressions for $\\delta W_{\\text{int}}$ and noting that this must hold for arbitrary $\\delta d_{ai}$, we identify the internal force vector as:\n$$ R_{ai} = \\int_{\\Omega_0} N_{a,J} \\, P_{iJ} \\, dV_0 $$\nThis expression correctly contracts the material gradient of the shape function, $N_{a,J} = \\partial N_a / \\partial X_J$, with the material index of the First Piola-Kirchhoff stress, $P_{iJ}$. We now evaluate each option against this background.\n\n### Option-by-Option Analysis\n\n**A. Energy conjugacy test**\n\nThis option proposes to verify that the fundamental relationship $\\delta W_{\\text{int}} = \\sum_a R_{a i} \\, \\delta d_{a i}$ holds numerically for arbitrary virtual nodal displacements $\\delta d_{a i}$, where $\\delta W_{\\text{int}}$ is computed directly from its definition $\\int_{\\Omega_0} P_{iJ} \\, \\delta F_{iJ} \\, dV_0$.\n\nAs derived above, the expression for $R_{ai}$ is obtained precisely from this equality. Therefore, this test is a direct verification of the correct implementation of the internal force vector assembly. If an incorrect implementation is used, for example one with an index error such as $R^{\\text{err}}_{ai} = \\int_{\\Omega_0} N_{a,i} \\, P_{iJ} \\, dV_0$, the equality will not hold in general. In this erroneous form, the spatial gradient $N_{a,i} = \\partial N_a/\\partial x_i$ is used in an integral over the reference domain $\\Omega_0$, which is inconsistent. The test would compute $\\delta W_{\\text{int}}$ using the correct physics and compare it against the work computed using the implemented (and possibly buggy) residuals. Any discrepancy signals an error. This is a primary and fundamental consistency check.\n\n**Verdict: Correct**\n\n**B. Objectivity and rigid-body motion patch test**\n\nThis option proposes two related tests based on the principle of material frame-indifference (objectivity).\n\n1.  **Superposed rigid rotation:** A superposed rigid rotation on the current configuration is given by $x'_i = Q_{ik} x_k$, where $Q$ is a proper orthogonal tensor. The deformation gradient and FPK stress transform as $F'_{iJ} = Q_{ik} F_{kJ}$ and $P'_{iJ} = Q_{ik} P_{kJ}$. The correctly implemented internal force vector must transform as a spatial vector:\n    $$ R'_{a i} = \\int_{\\Omega_0} N_{a,J} \\, P'_{iJ} \\, dV_0 = \\int_{\\Omega_0} N_{a,J} \\, (Q_{ik} P_{kJ}) \\, dV_0 $$\n    Since $Q_{ik}$ is spatially uniform, it can be taken out of the integral:\n    $$ R'_{a i} = Q_{ik} \\int_{\\Omega_0} N_{a,J} \\, P_{kJ} \\, dV_0 = Q_{ik} R_{a k} $$\n    An implementation with incorrect index handling (e.g., involving spatial gradients like $N_{a,k}$ or non-objective contractions) would violate this transformation rule.\n\n2.  **Pure rigid-body motion:** A rigid-body motion applied to a stress-free reference configuration results in zero strain and, for any physically reasonable material model, zero stress ($P_{iJ}=0$). Consequently, the internal force vector must be zero, $R_{ai} = 0$. This is a crucial \"patch test\" that any valid finite element formulation must pass. An implementation that produces spurious internal forces for a strain-free motion is fundamentally flawed. Indexing errors can easily lead to failure of this test.\n\nBoth tests are standard, powerful, and essential diagnostics for codes in nonlinear solid mechanics. They rigorously check if the implementation respects fundamental physical principles.\n\n**Verdict: Correct**\n\n**C. Scalar contraction check in the current configuration**\n\nThis option proposes forming a quantity $S_a = \\int_{\\Omega_0} N_a \\, P_{iJ} \\, F_{ij} \\, dV_0$ and requiring it to be zero under rigid rotation. There is a fundamental flaw in the definition of the integrand. The term $P_{iJ} \\, F_{ij}$ violates standard index notation. The summation convention requires repeated indices to appear in pairs. Here, $i$ is a repeated index, implying summation. However, $j$ is a free spatial index and $J$ is a free material index. The term $P_{iJ} \\, F_{ij}$ is therefore not a scalar but a two-point tensor with components $(j, J)$. The integral $S_a$ would thus not be a scalar but a quantity $S_{ajJ}$. The option incorrectly labels it $S_a$. The premise of the test is ill-defined. One cannot build a sound diagnostic test on a mathematically malformed expression. The problem statement itself gives $P_{iJ}F_{ij}$ as an example of an \"accidental contraction\" that \"violates the...summation convention,\" so proposing a test based on this very term is nonsensical.\n\n**Verdict: Incorrect**\n\n**D. Push-forward equivalence test**\n\nThis option proposes to verify the equality of the internal force vector computed using a Total Lagrangian (TL) formulation and an Updated Lagrangian (UL) formulation. The two expressions are:\n$$ R_{a i}^{(0)} = \\int_{\\Omega_0} N_{a,J} \\, P_{iJ} \\, dV_0 \\quad \\text{(TL form)} $$\n$$ R_{a i}^{(t)} = \\int_{\\Omega} N_{a,j} \\, \\sigma_{ij} \\, dV \\quad \\text{(UL form)} $$\nThese two forms are mathematically equivalent. This can be shown by transforming the UL integral back to the reference domain $\\Omega_0$. We use the relations $dV = J \\, dV_0$ where $J=\\det(F)$, the Piola identity $P_{iJ} = J \\sigma_{ik} F^{-1}_{kJ}$, and the chain rule for gradients $N_{a,j} = N_{a,J} F^{-1}_{Jj}$.\n$$ R_{a i}^{(t)} = \\int_{\\Omega_0} (N_{a,K} F^{-1}_{Kj}) \\, \\sigma_{ij} \\, (J \\, dV_0) = \\int_{\\Omega_0} N_{a,K} (J \\sigma_{ij} F^{-1}_{Kj}) \\, dV_0 $$\nUsing the symmetry of the Cauchy stress, $\\sigma_{ij}=\\sigma_{ji}$, the term in parentheses is $J \\sigma_{ji} F^{-1}_{Kj}$, which is the definition of $P_{iK}$. Thus,\n$$ R_{a i}^{(t)} = \\int_{\\Omega_0} N_{a,K} \\, P_{iK} \\, dV_0 = R_{a i}^{(0)} $$\nSince the two forms are rigorously equivalent, implementing both and verifying that they produce the same result (to machine precision) is an excellent and comprehensive verification test. An index error in either implementation, such as using $N_{a,i}$ in the TL form, would break this identity.\n\n**Verdict: Correct**\n\n**E. Index reassignment check**\n\nThis option proposes to check correctness by using the expression $R_a = \\int_{\\Omega_0} N_{a,i} \\, P_{iJ} \\, dV_0$. This is fundamentally incorrect. This expression is an example of the very error one seeks to diagnose. Let's analyze its structure: summation is over the spatial index $i$. The free indices are the node number $a$ and the material index $J$. The result is therefore not a scalar $R_a$ and certainly not the spatial force vector $R_{ai}$. It is a quantity $R_{aJ}$ with nodal and material indices. This quantity is related to the material nodal forces associated with the Second Piola-Kirchhoff stress, since $F^{-1}_{Ki} P_{iJ} = S_{KJ}$, the Second PK stress. The proposed integral is $\\int_{\\Omega_0} (N_{a,K}F^{-1}_{Ki}) P_{iJ} dV_0 = \\int_{\\Omega_0} N_{a,K} S_{KJ} dV_0$. This is not the spatial internal force vector. This option attempts to justify an incorrect formulation as a valid check, which is a fallacy.\n\n**Verdict: Incorrect**", "answer": "$$\\boxed{ABD}$$", "id": "3574084"}]}