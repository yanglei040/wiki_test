{"hands_on_practices": [{"introduction": "To begin our hands-on exploration, we will ground the abstract principles of Gauss quadrature in a foundational task in the Finite Element Method (FEM): the assembly of element matrices. This first practice involves calculating an entry of the consistent mass matrix for a simple one-dimensional linear element [@problem_id:3567628]. You will use the isoparametric mapping to transform the integral from the physical element to a canonical reference domain, and then apply the 2-point Gauss quadrature rule. This exercise demonstrates a key insight: for polynomial integrands, which are ubiquitous in FEM for linear elements, numerical quadrature can provide not just an approximation, but the exact analytical result.", "problem": "Consider a one-dimensional, two-node, linear isoparametric finite element used in the Finite Element Method (FEM) for computational solid mechanics, with physical coordinates $x \\in [x_{1}, x_{2}]$ and element length $h = x_{2} - x_{1} > 0$. Let $N_{1}(x)$ and $N_{2}(x)$ denote the linear Lagrange shape functions that interpolate a scalar field exactly at the nodes, satisfying $N_{1}(x_{1}) = 1$, $N_{1}(x_{2}) = 0$, $N_{2}(x_{1}) = 0$, and $N_{2}(x_{2}) = 1$. The affine isoparametric mapping from the reference coordinate $\\xi \\in [-1, 1]$ to the physical coordinate $x \\in [x_{1}, x_{2}]$ is used to transform integrals from the physical domain to the reference domain. Using the standard two-point Gauss quadrature rule on the reference interval $[-1, 1]$ and the affine map, compute exactly the consistent mass matrix entry\n$$\nM_{11} = \\int_{x_{1}}^{x_{2}} N_{1}(x)^{2} \\, dx,\n$$\nand express your final answer as a single closed-form analytic expression in terms of $x_{1}$ and $x_{2}$. No numerical rounding is required, and no physical units are to be included in the final expression.", "solution": "The problem is first validated against the specified criteria.\n\n### Problem Validation\n**Step 1: Extract Givens**\n- Element type: A one-dimensional, two-node, linear isoparametric finite element.\n- Physical domain: $x \\in [x_{1}, x_{2}]$.\n- Element length: $h = x_{2} - x_{1} > 0$.\n- Shape functions: Linear Lagrange shape functions $N_{1}(x)$ and $N_{2}(x)$.\n- Nodal conditions: $N_{1}(x_{1}) = 1$, $N_{1}(x_{2}) = 0$, $N_{2}(x_{1}) = 0$, and $N_{2}(x_{2}) = 1$.\n- Reference domain: $\\xi \\in [-1, 1]$.\n- Mapping: Affine isoparametric mapping from $\\xi$ to $x$.\n- Integration method: Standard two-point Gauss quadrature rule on the reference interval $[-1, 1]$.\n- Quantity to compute: The consistent mass matrix entry $M_{11} = \\int_{x_{1}}^{x_{2}} N_{1}(x)^{2} \\, dx$.\n- Requirement: The computation must be exact.\n- Output format: A single closed-form analytic expression in terms of $x_{1}$ and $x_{2}$.\n\n**Step 2: Validate Using Extracted Givens**\n1.  **Scientific Grounding**: The problem is based on fundamental and standard principles of the Finite Element Method (FEM), including isoparametric mapping, shape functions, and Gauss quadrature. These are core concepts in computational solid mechanics. The problem is scientifically sound.\n2.  **Well-Posedness**: The problem is well-posed. It asks for the exact calculation of a specific integral using a specified method. A potential issue could be the requirement of an \"exact\" result from a numerical quadrature rule. However, a $2$-point Gauss quadrature rule integrates polynomials of degree up to $2n-1 = 2(2)-1 = 3$ exactly. The integrand, once transformed to the reference domain, is $(N_{1}(\\xi))^{2}J$, where $N_1(\\xi)$ is linear in $\\xi$ and the Jacobian $J$ is constant for a linear element. Thus, the integrand is a quadratic polynomial in $\\xi$ (degree $2$), which is less than $3$. Therefore, the $2$-point Gauss quadrature will yield the exact value of the integral, and there is no contradiction.\n3.  **Objectivity**: The problem is stated using precise, objective, and standard mathematical and engineering terminology.\n4.  **Completeness**: All necessary information (element type, shape function properties, domains, mapping type, integration rule) is provided. The problem is self-contained.\n\n**Step 3: Verdict and Action**\nThe problem is valid. A complete solution will be provided.\n\n### Solution\nThe objective is to compute the consistent mass matrix entry $M_{11} = \\int_{x_{1}}^{x_{2}} N_{1}(x)^{2} \\, \\mathrm{d}x$ using the isoparametric mapping and a $2$-point Gauss quadrature rule.\n\nFirst, we define the linear Lagrange shape functions on the reference element, which spans the domain $\\xi \\in [-1, 1]$. The shape functions corresponding to nodes at $\\xi = -1$ and $\\xi = 1$ are:\n$$\nN_{1}(\\xi) = \\frac{1 - \\xi}{2}\n$$\n$$\nN_{2}(\\xi) = \\frac{1 + \\xi}{2}\n$$\nThese functions satisfy the required properties: $N_{1}(-1) = 1$, $N_{1}(1) = 0$, $N_{2}(-1) = 0$, and $N_{2}(1) = 1$.\n\nThe isoparametric mapping provides the physical coordinate $x$ as a function of the reference coordinate $\\xi$ using these same shape functions:\n$$\nx(\\xi) = N_{1}(\\xi)x_{1} + N_{2}(\\xi)x_{2} = \\frac{1 - \\xi}{2}x_{1} + \\frac{1 + \\xi}{2}x_{2}\n$$\nThis is an affine map. To transform the integral from the physical domain to the reference domain, we need the Jacobian of the transformation, $J$:\n$$\nJ = \\frac{\\mathrm{d}x}{\\mathrm{d}\\xi} = \\frac{\\mathrm{d}}{\\mathrm{d}\\xi} \\left( \\frac{x_{1} + x_{2}}{2} + \\xi \\frac{x_{2} - x_{1}}{2} \\right) = \\frac{x_{2} - x_{1}}{2}\n$$\nThe differential element transforms as $\\mathrm{d}x = J \\, \\mathrm{d}\\xi$.\n\nThe integral for $M_{11}$ can now be rewritten in the reference coordinate system. By the definition of an isoparametric element, the shape function $N_{1}(x)$ evaluated at a point $x(\\xi)$ is equivalent to the reference shape function $N_{1}(\\xi)$.\n$$\nM_{11} = \\int_{x_{1}}^{x_{2}} N_{1}(x)^{2} \\, \\mathrm{d}x = \\int_{-1}^{1} (N_{1}(x(\\xi)))^{2} J \\, \\mathrm{d}\\xi = \\int_{-1}^{1} (N_{1}(\\xi))^{2} J \\, \\mathrm{d}\\xi\n$$\nLet's define the integrand in the reference domain as $f(\\xi)$:\n$$\nf(\\xi) = (N_{1}(\\xi))^{2} J = \\left( \\frac{1 - \\xi}{2} \\right)^{2} \\left( \\frac{x_{2} - x_{1}}{2} \\right) = \\frac{x_{2} - x_{1}}{8} (1 - \\xi)^{2}\n$$\nThis integrand is a polynomial of degree $2$ in $\\xi$.\n\nThe problem specifies using the $2$-point Gauss quadrature rule to evaluate the integral. The general form of Gauss quadrature is:\n$$\n\\int_{-1}^{1} f(\\xi) \\, \\mathrm{d}\\xi \\approx \\sum_{i=1}^{n} w_{i} f(\\xi_{i})\n$$\nwhere $\\xi_i$ are the quadrature points (abscissas) and $w_i$ are the corresponding weights. For $n=2$, the points and weights are:\n- Points: $\\xi_{1} = -\\frac{1}{\\sqrt{3}}$, $\\xi_{2} = \\frac{1}{\\sqrt{3}}$\n- Weights: $w_{1} = 1$, $w_{2} = 1$\n\nA $2$-point Gauss rule provides an exact result for polynomial integrands of degree up to $2n-1 = 2(2)-1 = 3$. Since our integrand $f(\\xi)$ is a polynomial of degree $2$, the quadrature will be an exact calculation, not an approximation.\n$$\nM_{11} = \\sum_{i=1}^{2} w_{i} f(\\xi_{i}) = w_{1} f(\\xi_{1}) + w_{2} f(\\xi_{2})\n$$\nSubstituting the values for the points and weights:\n$$\nM_{11} = (1) \\cdot f\\left(-\\frac{1}{\\sqrt{3}}\\right) + (1) \\cdot f\\left(\\frac{1}{\\sqrt{3}}\\right)\n$$\nNow we evaluate the function $f(\\xi)$ at the two Gauss points:\nAt $\\xi_1 = -1/\\sqrt{3}$:\n$$\nf\\left(-\\frac{1}{\\sqrt{3}}\\right) = \\frac{x_{2} - x_{1}}{8} \\left(1 - \\left(-\\frac{1}{\\sqrt{3}}\\right)\\right)^{2} = \\frac{x_{2} - x_{1}}{8} \\left(1 + \\frac{1}{\\sqrt{3}}\\right)^{2}\n$$\nAt $\\xi_2 = 1/\\sqrt{3}$:\n$$\nf\\left(\\frac{1}{\\sqrt{3}}\\right) = \\frac{x_{2} - x_{1}}{8} \\left(1 - \\frac{1}{\\sqrt{3}}\\right)^{2}\n$$\nSumming these two terms gives $M_{11}$:\n$$\nM_{11} = \\frac{x_{2} - x_{1}}{8} \\left[ \\left(1 + \\frac{1}{\\sqrt{3}}\\right)^{2} + \\left(1 - \\frac{1}{\\sqrt{3}}\\right)^{2} \\right]\n$$\nLet's simplify the expression in the square brackets. Using the identity $(a+b)^{2} + (a-b)^{2} = 2(a^{2} + b^{2})$ with $a=1$ and $b=1/\\sqrt{3}$:\n$$\n\\left(1 + \\frac{1}{\\sqrt{3}}\\right)^{2} + \\left(1 - \\frac{1}{\\sqrt{3}}\\right)^{2} = 2 \\left(1^{2} + \\left(\\frac{1}{\\sqrt{3}}\\right)^{2}\\right) = 2 \\left(1 + \\frac{1}{3}\\right) = 2 \\left(\\frac{4}{3}\\right) = \\frac{8}{3}\n$$\nSubstituting this result back into the expression for $M_{11}$:\n$$\nM_{11} = \\frac{x_{2} - x_{1}}{8} \\left( \\frac{8}{3} \\right)\n$$\nThis simplifies to:\n$$\nM_{11} = \\frac{x_{2} - x_{1}}{3}\n$$\nThis is the exact value for the mass matrix entry $M_{11}$, expressed as a closed-form analytic expression in terms of the nodal coordinates $x_1$ and $x_2$.", "answer": "$$\n\\boxed{\\frac{x_{2} - x_{1}}{3}}\n$$", "id": "3567628"}, {"introduction": "Having mastered the application in 1D, we now extend our analysis to two dimensions, focusing on a geometry that is fundamental to flexible meshing: the triangle. Unlike squares, triangles do not naturally lend themselves to simple tensor-product rules, requiring specially designed quadrature schemes. This practice asks you to work with a standard 3-point symmetric rule for a reference triangle [@problem_id:3567605]. Your task is to verify its claimed degree of precision by testing it against a basis of quadratic polynomials and then to find the error for a cubic monomial, thereby identifying the rule's limitations. This process is vital for any computational engineer who must select or validate integration schemes for meshes containing non-rectangular elements.", "problem": "In computational solid mechanics, integrals over triangular finite elements arise in the assembly of consistent mass matrices and element stiffness matrices. Consider the reference triangle $\\mathcal{T}=\\{(x,y)\\in\\mathbb{R}^{2}: x\\geq 0,\\ y\\geq 0,\\ x+y\\leq 1\\}$ with vertices at $(0,0)$, $(1,0)$, and $(0,1)$. A widely used symmetric $3$-point quadrature rule on $\\mathcal{T}$ places nodes at barycentric coordinates $(\\frac{2}{3},\\frac{1}{6},\\frac{1}{6})$ and its cyclic permutations, which in Cartesian coordinates are\n$$(x_{1},y_{1})=\\left(\\frac{1}{6},\\frac{1}{6}\\right),\\quad (x_{2},y_{2})=\\left(\\frac{2}{3},\\frac{1}{6}\\right),\\quad (x_{3},y_{3})=\\left(\\frac{1}{6},\\frac{2}{3}\\right),$$\nwith equal weights $w$ chosen so that the rule integrates constant functions over $\\mathcal{T}$ exactly. The quadrature approximation is\n$$\\widehat{I}[f]\\;=\\;\\sum_{i=1}^{3} w\\, f(x_{i},y_{i}).$$\nUsing only fundamental definitions of integration on $\\mathbb{R}^{2}$ and direct calculation, verify that this $3$-point symmetric triangle rule integrates every polynomial on $\\mathcal{T}$ of total degree at most $2$ exactly. Then identify a cubic monomial that is not integrated exactly by this rule, and compute the quadrature error\n$$E[f]\\;=\\;\\widehat{I}[f]\\;-\\;\\int_{\\mathcal{T}} f(x,y)\\,\\mathrm{d}A,$$\nfor your choice. As a concrete, fully specified calculation, report as your final answer the exact value of $E[x^{3}]$. Do not round your answer.", "solution": "This solution first verifies that the given $3$-point symmetric quadrature rule is exact for all polynomials of total degree at most $2$ over the reference triangle $\\mathcal{T}$. It then computes the quadrature error for the monomial $f(x,y) = x^3$ to identify the rule's limitations.\n\nThe integral of a function $f(x,y)$ over the reference triangle $\\mathcal{T}=\\{(x,y)\\in\\mathbb{R}^{2}: x\\geq 0,\\ y\\geq 0,\\ x+y\\leq 1\\}$ is denoted by $I[f] = \\int_{\\mathcal{T}} f(x,y)\\,\\mathrm{d}A$. The quadrature approximation is given by $\\widehat{I}[f]\\;=\\;\\sum_{i=1}^{3} w\\, f(x_{i},y_{i})$, where the quadrature points are $(x_{1},y_{1})=(\\frac{1}{6},\\frac{1}{6})$, $(x_{2},y_{2})=(\\frac{2}{3},\\frac{1}{6})$, $(x_{3},y_{3})=(\\frac{1}{6},\\frac{2}{3})$, and the weight $w$ is a constant.\n\nFirst, we determine the value of the weight $w$. The problem states that $w$ is chosen such that the rule integrates constant functions exactly. Let us consider the constant function $f(x,y) = 1$.\nThe exact integral is the area of the triangle $\\mathcal{T}$.\n$$I[1] = \\int_{\\mathcal{T}} 1 \\,\\mathrm{d}A = \\int_{0}^{1} \\int_{0}^{1-x} 1 \\,\\mathrm{d}y\\,\\mathrm{d}x = \\int_{0}^{1} [y]_{0}^{1-x} \\,\\mathrm{d}x = \\int_{0}^{1} (1-x) \\,\\mathrm{d}x = \\left[x - \\frac{x^2}{2}\\right]_{0}^{1} = 1 - \\frac{1}{2} = \\frac{1}{2}.$$\nThe quadrature approximation for $f(x,y) = 1$ is:\n$$\\widehat{I}[1] = w \\, f(x_1, y_1) + w \\, f(x_2, y_2) + w \\, f(x_3, y_3) = w(1) + w(1) + w(1) = 3w.$$\nFor the rule to be exact for constant functions, we must have $\\widehat{I}[1] = I[1]$, which gives $3w = \\frac{1}{2}$, so $w = \\frac{1}{6}$.\n\nNext, we verify that the rule is exact for all polynomials of total degree up to $2$. A basis for the space of polynomials of total degree at most $2$ is given by $\\{1, x, y, x^2, xy, y^2\\}$. Since the integral and the quadrature sum are both linear operators, we only need to verify exactness for each basis function. We have already shown this for $f(x,y)=1$.\n\nFor $f(x,y) = x$:\n$$I[x] = \\int_{0}^{1} \\int_{0}^{1-x} x \\,\\mathrm{d}y\\,\\mathrm{d}x = \\int_{0}^{1} x(1-x) \\,\\mathrm{d}x = \\int_{0}^{1} (x - x^2) \\,\\mathrm{d}x = \\left[\\frac{x^2}{2} - \\frac{x^3}{3}\\right]_{0}^{1} = \\frac{1}{2} - \\frac{1}{3} = \\frac{1}{6}.$$\n$$\\widehat{I}[x] = w \\sum_{i=1}^{3} x_i = \\frac{1}{6} \\left(\\frac{1}{6} + \\frac{2}{3} + \\frac{1}{6}\\right) = \\frac{1}{6} \\left(\\frac{1}{6} + \\frac{4}{6} + \\frac{1}{6}\\right) = \\frac{1}{6} \\left(\\frac{6}{6}\\right) = \\frac{1}{6}.$$\nThe rule is exact for $f(x,y)=x$.\n\nFor $f(x,y) = y$:\nBy symmetry of the domain $\\mathcal{T}$ and the quadrature points with respect to the line $y=x$, we can state that $I[y] = I[x] = \\frac{1}{6}$. Let's verify the approximation:\n$$\\widehat{I}[y] = w \\sum_{i=1}^{3} y_i = \\frac{1}{6} \\left(\\frac{1}{6} + \\frac{1}{6} + \\frac{2}{3}\\right) = \\frac{1}{6} \\left(\\frac{1}{6} + \\frac{1}{6} + \\frac{4}{6}\\right) = \\frac{1}{6} \\left(\\frac{6}{6}\\right) = \\frac{1}{6}.$$\nThe rule is exact for $f(x,y)=y$.\n\nFor $f(x,y) = x^2$:\n$$I[x^2] = \\int_{0}^{1} \\int_{0}^{1-x} x^2 \\,\\mathrm{d}y\\,\\mathrm{d}x = \\int_{0}^{1} x^2(1-x) \\,\\mathrm{d}x = \\int_{0}^{1} (x^2 - x^3) \\,\\mathrm{d}x = \\left[\\frac{x^3}{3} - \\frac{x^4}{4}\\right]_{0}^{1} = \\frac{1}{3} - \\frac{1}{4} = \\frac{1}{12}.$$\n$$\\widehat{I}[x^2] = w \\sum_{i=1}^{3} x_i^2 = \\frac{1}{6} \\left( \\left(\\frac{1}{6}\\right)^2 + \\left(\\frac{2}{3}\\right)^2 + \\left(\\frac{1}{6}\\right)^2 \\right) = \\frac{1}{6} \\left(\\frac{1}{36} + \\frac{4}{9} + \\frac{1}{36}\\right) = \\frac{1}{6} \\left(\\frac{1}{36} + \\frac{16}{36} + \\frac{1}{36}\\right) = \\frac{1}{6} \\left(\\frac{18}{36}\\right) = \\frac{1}{6} \\cdot \\frac{1}{2} = \\frac{1}{12}.$$\nThe rule is exact for $f(x,y)=x^2$.\n\nFor $f(x,y) = y^2$:\nBy symmetry, $I[y^2] = I[x^2] = \\frac{1}{12}$.\n$$\\widehat{I}[y^2] = w \\sum_{i=1}^{3} y_i^2 = \\frac{1}{6} \\left( \\left(\\frac{1}{6}\\right)^2 + \\left(\\frac{1}{6}\\right)^2 + \\left(\\frac{2}{3}\\right)^2 \\right) = \\frac{1}{6} \\left(\\frac{1}{36} + \\frac{1}{36} + \\frac{16}{36}\\right) = \\frac{1}{6} \\left(\\frac{18}{36}\\right) = \\frac{1}{12}.$$\nThe rule is exact for $f(x,y)=y^2$.\n\nFor $f(x,y) = xy$:\n$$I[xy] = \\int_{0}^{1} \\int_{0}^{1-x} xy \\,\\mathrm{d}y\\,\\mathrm{d}x = \\frac{1}{2} \\int_{0}^{1} x \\left[\\frac{y^2}{2}\\right]_{0}^{1-x} \\,\\mathrm{d}x = \\frac{1}{2} \\int_{0}^{1} x(1-x)^2 \\,\\mathrm{d}x = \\frac{1}{2} \\int_{0}^{1} (x - 2x^2 + x^3) \\,\\mathrm{d}x = \\frac{1}{2} \\left[\\frac{x^2}{2} - \\frac{2x^3}{3} + \\frac{x^4}{4}\\right]_{0}^{1} = \\frac{1}{2} \\left(\\frac{1}{2} - \\frac{2}{3} + \\frac{1}{4}\\right) = \\frac{1}{2} \\left(\\frac{6 - 8 + 3}{12}\\right) = \\frac{1}{24}.$$\n$$\\widehat{I}[xy] = w \\sum_{i=1}^{3} x_i y_i = \\frac{1}{6} \\left( \\left(\\frac{1}{6}\\right)\\left(\\frac{1}{6}\\right) + \\left(\\frac{2}{3}\\right)\\left(\\frac{1}{6}\\right) + \\left(\\frac{1}{6}\\right)\\left(\\frac{2}{3}\\right) \\right) = \\frac{1}{6} \\left(\\frac{1}{36} + \\frac{2}{18} + \\frac{2}{18}\\right) = \\frac{1}{6} \\left(\\frac{1}{36} + \\frac{4}{36} + \\frac{4}{36}\\right) = \\frac{1}{6} \\left(\\frac{9}{36}\\right) = \\frac{1}{6} \\cdot \\frac{1}{4} = \\frac{1}{24}.$$\nThe rule is exact for $f(x,y)=xy$.\nSince the rule is exact for all basis polynomials of total degree at most $2$, it is exact for any polynomial of total degree at most $2$. The verification is complete.\n\nFinally, we must compute the quadrature error $E[f]=\\widehat{I}[f] - I[f]$ for the monomial $f(x,y) = x^3$.\nFirst, we calculate the exact integral:\n$$I[x^3] = \\int_{0}^{1} \\int_{0}^{1-x} x^3 \\,\\mathrm{d}y\\,\\mathrm{d}x = \\int_{0}^{1} x^3(1-x) \\,\\mathrm{d}x = \\int_{0}^{1} (x^3 - x^4) \\,\\mathrm{d}x = \\left[\\frac{x^4}{4} - \\frac{x^5}{5}\\right]_{0}^{1} = \\frac{1}{4} - \\frac{1}{5} = \\frac{1}{20}.$$\nNext, we calculate the quadrature approximation:\n$$\\widehat{I}[x^3] = w \\sum_{i=1}^{3} x_i^3 = \\frac{1}{6} \\left( \\left(\\frac{1}{6}\\right)^3 + \\left(\\frac{2}{3}\\right)^3 + \\left(\\frac{1}{6}\\right)^3 \\right) = \\frac{1}{6} \\left( \\frac{1}{216} + \\frac{8}{27} + \\frac{1}{216} \\right) = \\frac{1}{6} \\left( \\frac{2}{216} + \\frac{64}{216} \\right) = \\frac{1}{6} \\left( \\frac{66}{216} \\right) = \\frac{11}{216}.$$\nThe integrals $I[x^3] = \\frac{1}{20}$ and $\\widehat{I}[x^3] = \\frac{11}{216}$ are not equal, confirming that this cubic monomial is not integrated exactly.\n\nThe quadrature error is:\n$$E[x^3] = \\widehat{I}[x^3] - I[x^3] = \\frac{11}{216} - \\frac{1}{20}.$$\nTo find a common denominator, we compute the least common multiple of $216$ and $20$. $216 = 2^3 \\cdot 3^3$ and $20 = 2^2 \\cdot 5$. The LCM is $2^3 \\cdot 3^3 \\cdot 5 = 8 \\cdot 27 \\cdot 5 = 1080$.\n$$E[x^3] = \\frac{11 \\cdot 5}{216 \\cdot 5} - \\frac{1 \\cdot 54}{20 \\cdot 54} = \\frac{55}{1080} - \\frac{54}{1080} = \\frac{1}{1080}.$$\nThe exact value of the quadrature error for $f(x,y)=x^3$ is $\\frac{1}{1080}$.", "answer": "$$\\boxed{\\frac{1}{1080}}$$", "id": "3567605"}, {"introduction": "Our final practice is a capstone exercise that reveals the profound and sometimes counter-intuitive impact of quadrature rules on the accuracy and stability of a finite element simulation. You will write a program to simulate a plate in pure bending, a classic scenario that is notoriously challenging for certain element formulations [@problem_id:3567617]. By comparing the strain energy computed with full ($2 \\times 2$) integration versus reduced ($1 \\times 1$) integration with hourglass stabilization, you will directly observe critical numerical phenomena. This exercise provides a concrete demonstration of shear locking, a pathology where overly stiff elements fail to bend correctly, and the trade-offs involved in using reduced integration to cure it, which in turn necessitates stabilization to control non-physical 'hourglass' modes.", "problem": "You must write a complete, runnable program that computes and compares the strain energy accuracy for a two-dimensional, small-strain, linear elastic bending-dominated patch test using Finite Element Method (FEM) quadrilateral elements under two numerical integration schemes: full $2\\times 2$ Gauss-Legendre integration and reduced $1\\times 1$ Gauss-Legendre integration augmented with hourglass stabilization. The comparison must be expressed as relative errors with respect to an analytically derived strain energy for a prescribed pure-bending displacement field. All internal physical computations must use the International System of Units (SI). The final outputs are dimensionless decimals (no units). The program must produce a single line of output containing the results as a comma-separated list enclosed in square brackets.\n\nThe domain is a rectangular plate in the $x$-$y$ plane of length $L$ along the $x$-direction and height $H$ along the $y$-direction. The plate has thickness $t$ in the out-of-plane direction (the $z$-direction). Assume plane stress conditions, small strains, and linear elasticity with Young’s modulus $E$ and Poisson’s ratio $\\nu$. The plate is discretized with $N_x\\times N_y$ bilinear four-node quadrilateral elements (each element is a rectangle aligned with the axes). Nodes are arranged on a structured grid covering the rectangle $[0,L]\\times[-H/2,H/2]$, with the standard local element node ordering: node $1$ bottom-left, node $2$ bottom-right, node $3$ top-right, node $4$ top-left.\n\nPrescribe a pure bending displacement field intended to represent Euler-Bernoulli-type bending about the $z$-axis with curvature $\\kappa$:\n- $u_x(x,y) = -\\kappa x y$\n- $u_y(x,y) = \\frac{1}{2}\\kappa x^2$\nFrom small-strain kinematics, the exact strain field induced by this displacement is dominated by $\\varepsilon_{xx}(x,y)=\\frac{\\partial u_x}{\\partial x}=-\\kappa y$, with $\\varepsilon_{yy}(x,y)=\\frac{\\partial u_y}{\\partial y}=0$ and $\\varepsilon_{xy}(x,y)=\\frac{1}{2}\\left(\\frac{\\partial u_x}{\\partial y}+\\frac{\\partial u_y}{\\partial x}\\right)=0$. For plane stress, the constitutive law is $\\boldsymbol{\\sigma}=\\mathbf{D}\\boldsymbol{\\varepsilon}$, where in Voigt notation $\\boldsymbol{\\varepsilon}=[\\varepsilon_{xx},\\varepsilon_{yy},\\gamma_{xy}]^\\top$ with $\\gamma_{xy}=2\\varepsilon_{xy}$ and\n$$\n\\mathbf{D}=\\begin{bmatrix}\n\\frac{E}{1-\\nu^2} & \\frac{\\nu E}{1-\\nu^2} & 0 \\\\\n\\frac{\\nu E}{1-\\nu^2} & \\frac{E}{1-\\nu^2} & 0 \\\\\n0 & 0 & \\frac{E}{2(1+\\nu)}\n\\end{bmatrix}.\n$$\n\nShape functions for the bilinear quadrilateral element on the parent square $(-1\\le \\xi \\le 1, -1\\le \\eta \\le 1)$ are standard bilinear functions $N_i(\\xi,\\eta)$ for $i=1,\\dots,4$. The isoparametric map from $(\\xi,\\eta)$ to $(x,y)$ is bilinear using the element’s nodal coordinates, and the strain-displacement matrix $\\mathbf{B}$ is obtained by differentiating the shape functions and mapping derivatives to physical coordinates via the Jacobian $\\mathbf{J}$. You must use Gauss-Legendre quadrature:\n- In one dimension, the $1$-point rule has an abscissa at $0$ with weight $2$, and the $2$-point rule has abscissae at $\\pm 1/\\sqrt{3}$ with weights $1$.\n- In two dimensions, form the tensor product of the one-dimensional rules. For $2\\times 2$, the four points are $(\\pm 1/\\sqrt{3},\\pm 1/\\sqrt{3})$ with unit weights; for $1\\times 1$, the single point is $(0,0)$ with weight $4$.\n\nDefine the strain energy as\n$$\nU=\\frac{1}{2}\\int_{\\Omega} \\boldsymbol{\\varepsilon}^\\top \\mathbf{D}\\,\\boldsymbol{\\varepsilon}\\, \\mathrm{d}\\Omega\n$$\nwith $\\Omega$ the three-dimensional volume. Under plane stress with constant thickness $t$, this reduces to a two-dimensional area integral multiplied by $t$. The exact analytical energy for the prescribed bending field must be derived from first principles by directly integrating the energy density using the exact strain field over the rectangular domain. Express the exact strain energy in Joules.\n\nFor the reduced $1\\times 1$ integration, augment the computed strain energy with an hourglass stabilization energy at the element level to control spurious zero-energy modes typical of reduced integration in bilinear quadrilaterals. Define for each element the area $A$ and a characteristic length $\\ell=\\sqrt{A}$. Let the element nodal displacement vector be $\\mathbf{d}_e=[u_{1x},u_{1y},u_{2x},u_{2y},u_{3x},u_{3y},u_{4x},u_{4y}]^\\top$. Define four hourglass coordinates:\n- $q_{1x}=u_{1x}-u_{2x}+u_{3x}-u_{4x}$\n- $q_{2x}=u_{1x}+u_{2x}-u_{3x}-u_{4x}$\n- $q_{1y}=u_{1y}-u_{2y}+u_{3y}-u_{4y}$\n- $q_{2y}=u_{1y}+u_{2y}-u_{3y}-u_{4y}$\nLet the shear modulus be $G=\\frac{E}{2(1+\\nu)}$. The element hourglass stabilization energy is\n$$\nU_{\\mathrm{hg}}=\\frac{1}{2}\\,c_{\\mathrm{hg}}\\,G\\,t\\,A\\,\\frac{q_{1x}^2+q_{2x}^2+q_{1y}^2+q_{2y}^2}{\\ell^2}\n$$\nwhere $c_{\\mathrm{hg}}$ is a dimensionless stabilization coefficient. Use $c_{\\mathrm{hg}}=0.1$.\n\nYour program must:\n- Construct the structured mesh and evaluate the nodal displacements from the prescribed bending field.\n- Compute the total strain energy by assembling element contributions using:\n  - Full $2\\times 2$ Gauss-Legendre quadrature without stabilization.\n  - Reduced $1\\times 1$ Gauss-Legendre quadrature at $(\\xi,\\eta)=(0,0)$ with weight $4$, plus the hourglass stabilization energy $U_{\\mathrm{hg}}$ per element.\n- Compute the exact analytical strain energy for the domain from the exact strain field definition above.\n- Report the relative errors for each integration scheme as\n$$\n\\varepsilon_{\\mathrm{full}}=\\frac{U_{\\mathrm{full}}-U_{\\mathrm{exact}}}{U_{\\mathrm{exact}}},\\qquad\n\\varepsilon_{\\mathrm{red}}=\\frac{U_{\\mathrm{red+hg}}-U_{\\mathrm{exact}}}{U_{\\mathrm{exact}}}\n$$\n\nUse the following test suite of parameter values (all in SI units):\n- Case $1$ (happy path): $E=70\\times 10^{9}$, $\\nu=0.25$, $L=1.0$, $H=0.2$, $t=0.01$, $\\kappa=5.0$, $N_x=4$, $N_y=2$.\n- Case $2$ (coarse mesh edge case): $E=210\\times 10^{9}$, $\\nu=0.3$, $L=1.0$, $H=0.2$, $t=0.01$, $\\kappa=5.0$, $N_x=1$, $N_y=1$.\n- Case $3$ (slender bending-dominated): $E=210\\times 10^{9}$, $\\nu=0.3$, $L=2.0$, $H=0.05$, $t=0.005$, $\\kappa=10.0$, $N_x=8$, $N_y=1$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, ordered as $[\\varepsilon_{\\mathrm{full},1},\\varepsilon_{\\mathrm{red},1},\\varepsilon_{\\mathrm{full},2},\\varepsilon_{\\mathrm{red},2},\\varepsilon_{\\mathrm{full},3},\\varepsilon_{\\mathrm{red},3}]$, where the subscript indicates the case number. Each entry must be a decimal number.", "solution": "This solution evaluates the accuracy of two finite element integration schemes—full $2 \\times 2$ Gauss-Legendre quadrature and reduced $1 \\times 1$ Gauss-Legendre quadrature with hourglass stabilization—for a plane stress quadrilateral element under a pure bending load. The evaluation is performed by deriving the exact analytical strain energy and comparing it against the numerically computed values from each scheme.\n\n### Step 1: Analytical Strain Energy ($U_{\\mathrm{exact}}$)\n\nThe problem defines a pure bending displacement field:\n- $u_x(x,y) = -\\kappa x y$\n- $u_y(x,y) = \\frac{1}{2}\\kappa x^2$\n\nThe corresponding small-strain tensor components are:\n- $\\varepsilon_{xx} = \\frac{\\partial u_x}{\\partial x} = -\\kappa y$\n- $\\varepsilon_{yy} = \\frac{\\partial u_y}{\\partial y} = 0$\n- $\\gamma_{xy} = 2\\varepsilon_{xy} = \\frac{\\partial u_x}{\\partial y} + \\frac{\\partial u_y}{\\partial x} = (-\\kappa x) + (\\kappa x) = 0$\n\nIn Voigt notation for plane stress, the strain vector is $\\boldsymbol{\\varepsilon} = [\\varepsilon_{xx}, \\varepsilon_{yy}, \\gamma_{xy}]^\\top = [-\\kappa y, 0, 0]^\\top$. The material constitutive matrix $\\mathbf{D}$ is given by:\n$$\n\\mathbf{D}=\\frac{E}{1-\\nu^2}\\begin{bmatrix}\n1 & \\nu & 0 \\\\\n\\nu & 1 & 0 \\\\\n0 & 0 & \\frac{1-\\nu}{2}\n\\end{bmatrix}\n$$\nThe strain energy density, $W$, is calculated as $W = \\frac{1}{2}\\boldsymbol{\\varepsilon}^\\top \\mathbf{D} \\boldsymbol{\\varepsilon}$.\n$$\nW = \\frac{1}{2} \\begin{bmatrix} -\\kappa y & 0 & 0 \\end{bmatrix} \\left( \\frac{E}{1-\\nu^2}\\begin{bmatrix}\n1 & \\nu & 0 \\\\\n\\nu & 1 & 0 \\\\\n0 & 0 & \\frac{1-\\nu}{2}\n\\end{bmatrix} \\right) \\begin{bmatrix} -\\kappa y \\\\ 0 \\\\ 0 \\end{bmatrix} = \\frac{1}{2} \\frac{E \\kappa^2 y^2}{1-\\nu^2}\n$$\nThe total exact strain energy, $U_{\\mathrm{exact}}$, is the integral of the energy density over the volume of the plate, $\\Omega = [0,L] \\times [-H/2, H/2] \\times [0, t]$.\n$$\nU_{\\mathrm{exact}} = \\int_{\\Omega} W \\, \\mathrm{d}\\Omega = t \\int_{0}^{L} \\int_{-H/2}^{H/2} \\frac{1}{2} \\frac{E \\kappa^2 y^2}{1-\\nu^2} \\, \\mathrm{d}y \\, \\mathrm{d}x\n$$\n$$\nU_{\\mathrm{exact}} = \\frac{t E \\kappa^2}{2(1-\\nu^2)} \\int_{0}^{L} \\left[ \\frac{y^3}{3} \\right]_{-H/2}^{H/2} \\, \\mathrm{d}x = \\frac{t E \\kappa^2}{2(1-\\nu^2)} \\int_{0}^{L} \\frac{H^3}{12} \\, \\mathrm{d}x\n$$\n$$\nU_{\\mathrm{exact}} = \\frac{t E \\kappa^2 H^3}{24(1-\\nu^2)} [x]_0^L = \\frac{E \\kappa^2 L H^3 t}{24(1-\\nu^2)}\n$$\nThis is the analytical reference value for the strain energy in Joules.\n\n### Step 2: Finite Element Formulation\n\nThe domain is discretized into a structured mesh of $N_x \\times N_y$ rectangular bilinear quadrilateral elements. For each element, the strain energy is computed numerically and summed up.\n\n**Element Formulation:**\nA standard four-node isoparametric quadrilateral element is used. For a rectangular element of width $h_x$ and height $h_y$, the mapping from parent coordinates $(\\xi, \\eta) \\in [-1, 1]\\times[-1, 1]$ to physical coordinates $(x,y)$ is linear, and the Jacobian matrix of this transformation is constant and diagonal:\n$$ \\mathbf{J} = \\begin{bmatrix} h_x/2 & 0 \\\\ 0 & h_y/2 \\end{bmatrix}, \\quad \\det(\\mathbf{J}) = \\frac{h_x h_y}{4} = \\frac{A_e}{4} $$\nwhere $A_e$ is the element area. The strain-displacement matrix, $\\mathbf{B}(\\xi, \\eta)$, relates the nodal displacements of the element, $\\mathbf{d}_e$, to the strain at any point $(\\xi, \\eta)$ within the element: $\\boldsymbol{\\varepsilon}(\\xi, \\eta) = \\mathbf{B}(\\xi, \\eta) \\mathbf{d}_e$. The matrix $\\mathbf{B}$ is derived from the derivatives of the shape functions $N_i$.\n\n**Element Strain Energy Calculation:**\nThe strain energy of an element, $U_e$, is computed by numerical quadrature:\n$$ U_e = \\int_{A_e} \\frac{t}{2} \\boldsymbol{\\varepsilon}^\\top \\mathbf{D} \\boldsymbol{\\varepsilon} \\, \\mathrm{d}A = \\frac{t}{2} \\int_{-1}^1 \\int_{-1}^1 (\\mathbf{B}\\mathbf{d}_e)^\\top \\mathbf{D} (\\mathbf{B}\\mathbf{d}_e) \\det(\\mathbf{J}) \\, \\mathrm{d}\\xi \\mathrm{d}\\eta $$\n$$ U_e = \\frac{t}{2} \\sum_{p=1}^{N_{gp}} (\\mathbf{B}(\\xi_p, \\eta_p)\\mathbf{d}_e)^\\top \\mathbf{D} (\\mathbf{B}(\\xi_p, \\eta_p)\\mathbf{d}_e) \\det(\\mathbf{J}) w_p $$\nwhere $(\\xi_p, \\eta_p)$ are the Gauss point coordinates and $w_p$ are the corresponding weights.\n\n**Full Integration ($2\\times 2$):**\nThis scheme uses four Gauss points at $(\\pm 1/\\sqrt{3}, \\pm 1/\\sqrt{3})$, each with a weight of $w_p=1$. This rule can exactly integrate polynomials of degree up to $3$ in each coordinate. The bilinear element formulation can lead to a spurious shear strain, $\\gamma_{xy}$, which is linear in $\\xi$. This phenomenon, known as shear locking, is captured by the $2 \\times 2$ integration rule, leading to an artificially stiff response and an overestimation of the strain energy.\n\n**Reduced Integration ($1\\times 1$):**\nThis scheme uses a single Gauss point at the element center $(\\xi, \\eta)=(0,0)$ with weight $w_p=4$. At this specific point, the spurious shear strain for a rectangular element under pure bending is zero. Thus, reduced integration avoids shear locking. However, it can fail to detect certain deformation modes known as hourglass modes (zero-energy modes), making the element too flexible and potentially leading to numerical instability.\n\n### Step 3: Hourglass Stabilization\n\nTo counteract the spurious flexibility of reduced integration, a stabilization energy, $U_{\\mathrm{hg}}$, is added to the element's strain energy. This energy penalizes the hourglass modes. For each element, nodal displacements $\\mathbf{d}_e$ are used to compute hourglass coordinates $q$.\n- $q_{1x}=u_{1x}-u_{2x}+u_{3x}-u_{4x}$\n- $q_{2x}=u_{1x}+u_{2x}-u_{3x}-u_{4x}$\n- $q_{1y}=u_{1y}-u_{2y}+u_{3y}-u_{4y}$\n- $q_{2y}=u_{1y}+u_{2y}-u_{3y}-u_{4y}$\n\nThese are non-zero only for non-physical, oscillatory displacement patterns that the single Gauss point fails to \"see\". The stabilization energy for an element is:\n$$ U_{\\mathrm{hg}} = \\frac{1}{2}\\,c_{\\mathrm{hg}}\\,G\\,t\\,A\\,\\frac{q_{1x}^2+q_{2x}^2+q_{1y}^2+q_{2y}^2}{\\ell^2} $$\nWith $c_{\\mathrm{hg}}=0.1$, $\\ell^2=A$, and $G=\\frac{E}{2(1+\\nu)}$, this simplifies to:\n$$ U_{\\mathrm{hg}} = \\frac{1}{2}\\,c_{\\mathrm{hg}}\\,G\\,t\\,(q_{1x}^2+q_{2x}^2+q_{1y}^2+q_{2y}^2) $$\nThe total strain energy for the reduced integration scheme is $U_{\\mathrm{red+hg}} = \\sum_e (U_{e, \\mathrm{red}} + U_{e, \\mathrm{hg}})$.\n\n### Step 4: Implementation Algorithm\n\nThe program will execute the following steps for each test case:\n1.  Calculate the exact analytical strain energy $U_{\\mathrm{exact}}$ using the derived formula.\n2.  Generate the mesh: define nodal coordinates and element connectivity for the $N_x \\times N_y$ grid.\n3.  Evaluate the prescribed displacement field $(u_x, u_y)$ at each node to obtain the global displacement vector.\n4.  Initialize total energies $U_{\\mathrm{full}} = 0$ and $U_{\\mathrm{red+hg}} = 0$.\n5.  Loop through each element in the mesh:\n    a. Extract the element's nodal displacements $\\mathbf{d}_e$.\n    b. Compute the element strain energy $U_{e, \\mathrm{full}}$ using the $2 \\times 2$ Gauss rule and add it to $U_{\\mathrm{full}}$.\n    c. Compute the element strain energy $U_{e, \\mathrm{red}}$ using the $1 \\times 1$ Gauss rule.\n    d. Compute the element's hourglass stabilization energy $U_{e, \\mathrm{hg}}$.\n    e. Add the sum $(U_{e, \\mathrm{red}} + U_{e, \\mathrm{hg}})$ to $U_{\\mathrm{red+hg}}$.\n6.  Calculate the final relative errors $\\varepsilon_{\\mathrm{full}} = (U_{\\mathrm{full}}-U_{\\mathrm{exact}})/U_{\\mathrm{exact}}$ and $\\varepsilon_{\\mathrm{red}} = (U_{\\mathrm{red+hg}}-U_{\\mathrm{exact}})/U_{\\mathrm{exact}}$.\n7.  Store the results and format them for the final output.\n\nThis procedure is implemented in the following Python code.", "answer": "```python\nimport numpy as np\n\ndef get_B_matrix(xi, eta, hx, hy):\n    \"\"\"\n    Computes the strain-displacement matrix (B-matrix) for a 4-node\n    quadrilateral element at a specific point (xi, eta) in the parent domain.\n    Assumes a rectangular element aligned with the coordinate axes.\n    Node ordering is counter-clockwise: BL, BR, TR, TL.\n    \"\"\"\n    # Derivatives of bilinear shape functions w.r.t. parent coordinates (xi, eta)\n    # N1 = 0.25 * (1-xi)*(1-eta)\n    # N2 = 0.25 * (1+xi)*(1-eta)\n    # N3 = 0.25 * (1+xi)*(1+eta)\n    # N4 = 0.25 * (1-xi)*(1+eta)\n    \n    dNdxi = 0.25 * np.array([-(1 - eta), (1 - eta), (1 + eta), -(1 + eta)])\n    dNdeta = 0.25 * np.array([-(1 - xi), -(1 + xi), (1 + xi), (1 - xi)])\n    \n    # Using inverse of Jacobian for a rectangular element to find derivatives w.r.t (x,y)\n    # J_inv = [[2/hx, 0], [0, 2/hy]]\n    dNdx = dNdxi * (2.0 / hx)\n    dNdy = dNdeta * (2.0 / hy)\n    \n    B = np.zeros((3, 8))\n    for i in range(4):\n        B[0, 2 * i] = dNdx[i]\n        B[1, 2 * i + 1] = dNdy[i]\n        B[2, 2 * i] = dNdy[i]\n        B[2, 2 * i + 1] = dNdx[i]\n        \n    return B\n\ndef compute_element_energy(elem_disp, hx, hy, t, D):\n    \"\"\"\n    Computes strain energy for one element using both full (2x2) and reduced (1x1)\n    Gauss-Legendre quadrature.\n    \"\"\"\n    # Full 2x2 Gauss quadrature\n    U_full = 0.0\n    gp_pos = 1.0 / np.sqrt(3.0)\n    gp_coords = [(-gp_pos, -gp_pos), (gp_pos, -gp_pos),\n                 (gp_pos, gp_pos), (-gp_pos, gp_pos)]\n    gp_weights = [1.0, 1.0, 1.0, 1.0]\n    \n    detJ = hx * hy / 4.0\n\n    for i in range(4):\n        xi, eta = gp_coords[i]\n        w = gp_weights[i]\n        B = get_B_matrix(xi, eta, hx, hy)\n        strain = B @ elem_disp\n        # Energy = 0.5 * integral(strain^T * D * strain * t) dArea\n        U_full += 0.5 * (strain.T @ D @ strain) * detJ * w * t\n\n    # Reduced 1x1 Gauss quadrature\n    xi_red, eta_red = 0.0, 0.0\n    w_red = 4.0\n    B_center = get_B_matrix(xi_red, eta_red, hx, hy)\n    strain_center = B_center @ elem_disp\n    U_red = 0.5 * (strain_center.T @ D @ strain_center) * detJ * w_red * t\n    \n    return U_full, U_red\n\ndef compute_hourglass_energy(elem_disp, hx, hy, t, E, nu, c_hg):\n    \"\"\"\n    Computes hourglass stabilization energy for one element.\n    \"\"\"\n    # Extract x and y components of nodal displacements\n    u_disp = elem_disp[0::2] # [u1x, u2x, u3x, u4x]\n    v_disp = elem_disp[1::2] # [u1y, u2y, u3y, u4y]\n    \n    # Hourglass vectors\n    h1_vec = np.array([1.0, -1.0, 1.0, -1.0])\n    h2_vec = np.array([1.0, 1.0, -1.0, -1.0])\n\n    # Hourglass coordinates\n    q1x = h1_vec @ u_disp\n    q2x = h2_vec @ u_disp\n    q1y = h1_vec @ v_disp\n    q2y = h2_vec @ v_disp\n    \n    G = E / (2.0 * (1.0 + nu))\n    A_e = hx * hy\n    # From problem: characteristic length squared ell^2 = A, so A/ell^2 = 1.\n    U_hg = 0.5 * c_hg * G * t * (q1x**2 + q2x**2 + q1y**2 + q2y**2)\n    \n    return U_hg\n\ndef solve():\n    test_cases = [\n        # (E, nu, L, H, t, kappa, Nx, Ny) in SI units\n        (70e9, 0.25, 1.0, 0.2, 0.01, 5.0, 4, 2),\n        (210e9, 0.3, 1.0, 0.2, 0.01, 5.0, 1, 1),\n        (210e9, 0.3, 2.0, 0.05, 0.005, 10.0, 8, 1)\n    ]\n    \n    results = []\n    \n    for case in test_cases:\n        E, nu, L, H, t, kappa, Nx, Ny = case\n        \n        # 1. Analytical strain energy\n        U_exact = (E * kappa**2 * L * H**3 * t) / (24.0 * (1.0 - nu**2))\n        \n        # 2. Material constitutive matrix for plane stress\n        D_factor = E / (1.0 - nu**2)\n        D = D_factor * np.array([[1.0, nu, 0.0],\n                                 [nu, 1.0, 0.0],\n                                 [0.0, 0.0, (1.0 - nu) / 2.0]])\n\n        # 3. Mesh generation\n        hx = L / Nx\n        hy = H / Ny\n        \n        num_nodes_x = Nx + 1\n        num_nodes_y = Ny + 1\n        num_nodes = num_nodes_x * num_nodes_y\n        \n        node_coords = np.zeros((num_nodes, 2))\n        for j in range(num_nodes_y):\n            for i in range(num_nodes_x):\n                node_id = j * num_nodes_x + i\n                node_coords[node_id, 0] = i * hx\n                node_coords[node_id, 1] = j * hy - H / 2.0\n                \n        elements = []\n        for j in range(Ny):\n            for i in range(Nx):\n                n1 = j * num_nodes_x + i       # Bottom-left\n                n2 = j * num_nodes_x + (i + 1) # Bottom-right\n                n3 = (j + 1) * num_nodes_x + (i + 1) # Top-right\n                n4 = (j + 1) * num_nodes_x + i # Top-left\n                elements.append([n1, n2, n3, n4])\n\n        # 4. Prescribed nodal displacements\n        nodal_disps = np.zeros((num_nodes, 2))\n        for i in range(num_nodes):\n            x, y = node_coords[i, 0], node_coords[i, 1]\n            nodal_disps[i, 0] = -kappa * x * y\n            nodal_disps[i, 1] = 0.5 * kappa * x**2\n\n        # 5. FEM strain energy computation by summing over elements\n        U_full_total = 0.0\n        U_red_hg_total = 0.0\n        c_hg = 0.1\n        \n        for elem_nodes in elements:\n            # Assemble element displacement vector [u1x, u1y, u2x, u2y, ...]\n            elem_disp_vec = np.zeros(8)\n            for i, node_id in enumerate(elem_nodes):\n                elem_disp_vec[2 * i] = nodal_disps[node_id, 0]\n                elem_disp_vec[2 * i + 1] = nodal_disps[node_id, 1]\n\n            # Compute element energies\n            U_elem_full, U_elem_red = compute_element_energy(elem_disp_vec, hx, hy, t, D)\n            U_elem_hg = compute_hourglass_energy(elem_disp_vec, hx, hy, t, E, nu, c_hg)\n            \n            # Accumulate total energies\n            U_full_total += U_elem_full\n            U_red_hg_total += U_elem_red + U_elem_hg\n\n        # 6. Compute relative errors\n        eps_full = (U_full_total - U_exact) / U_exact\n        eps_red = (U_red_hg_total - U_exact) / U_exact\n        \n        results.append(eps_full)\n        results.append(eps_red)\n        \n    print(f\"[{','.join(f'{r:.10f}' for r in results)}]\")\n\nsolve()\n```", "id": "3567617"}]}