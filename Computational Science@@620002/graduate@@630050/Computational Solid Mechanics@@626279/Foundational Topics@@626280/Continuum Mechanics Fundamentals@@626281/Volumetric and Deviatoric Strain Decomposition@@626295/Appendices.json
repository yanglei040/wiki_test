{"hands_on_practices": [{"introduction": "In computational solid mechanics, abstract second-order tensors like strain are often flattened into vector form using Voigt notation for efficient storage and matrix operations. This practice is about making that crucial connection between the mathematical definition of deviatoric strain and its computational representation. By deriving the deviatoric projection matrix [@problem_id:3609739], you will build a fundamental tool used in finite element codes to implement material models where volumetric and distortional responses are treated separately.", "problem": "Consider small-strain kinematics in three-dimensional ($3$D) computational solid mechanics. Let the symmetric infinitesimal strain tensor be denoted by $\\boldsymbol{\\varepsilon}$ with components $\\varepsilon_{ij}$, and recall the volumetricâ€“deviatoric decomposition defined by the fundamental relation $\\boldsymbol{\\varepsilon} = \\boldsymbol{\\varepsilon}^{\\text{dev}} + \\boldsymbol{\\varepsilon}^{\\text{vol}}$, where the volumetric part is given by $\\boldsymbol{\\varepsilon}^{\\text{vol}} = \\tfrac{1}{3} \\operatorname{tr}(\\boldsymbol{\\varepsilon}) \\boldsymbol{I}$ and the deviatoric part by $\\boldsymbol{\\varepsilon}^{\\text{dev}} = \\boldsymbol{\\varepsilon} - \\tfrac{1}{3} \\operatorname{tr}(\\boldsymbol{\\varepsilon}) \\boldsymbol{I}$. In three dimensions, adopt the engineering Voigt notation for strains, mapping $\\boldsymbol{\\varepsilon}$ to the $6 \\times 1$ strain vector $\\boldsymbol{e}$ as $\\boldsymbol{e} = [\\varepsilon_{11}, \\varepsilon_{22}, \\varepsilon_{33}, \\gamma_{23}, \\gamma_{13}, \\gamma_{12}]^{\\mathsf{T}}$ with $\\gamma_{ij} = 2 \\varepsilon_{ij}$ for $i \\neq j$. Using only these definitions and the linearity of the mapping between tensor and Voigt vector representations, derive the unique linear operator $\\mathbb{P}^{\\text{dev}}$ in Voigt form, represented as a $6 \\times 6$ matrix, such that $\\boldsymbol{e}^{\\text{dev}} = \\mathbb{P}^{\\text{dev}} \\boldsymbol{e}$ yields the engineering-Voigt vector of the deviatoric strain $\\boldsymbol{\\varepsilon}^{\\text{dev}}$. Provide the explicit $6 \\times 6$ matrix of $\\mathbb{P}^{\\text{dev}}$. Express your final answer as an exact matrix; no rounding is required and no physical units are involved.", "solution": "The problem statement is deemed valid as it is scientifically grounded, well-posed, and objective. It presents a standard derivation in continuum mechanics that is based on established definitions and is free from any contradictions or ambiguities.\n\nThe objective is to derive the $6 \\times 6$ matrix representation, $\\mathbb{P}^{\\text{dev}}$, of the linear operator that projects the engineering Voigt strain vector $\\boldsymbol{e}$ onto its deviatoric part $\\boldsymbol{e}^{\\text{dev}}$. The relationship is given by $\\boldsymbol{e}^{\\text{dev}} = \\mathbb{P}^{\\text{dev}} \\boldsymbol{e}$.\n\nThe derivation begins with the fundamental definition of the deviatoric strain tensor, $\\boldsymbol{\\varepsilon}^{\\text{dev}}$, in terms of the full strain tensor, $\\boldsymbol{\\varepsilon}$:\n$$\n\\boldsymbol{\\varepsilon}^{\\text{dev}} = \\boldsymbol{\\varepsilon} - \\boldsymbol{\\varepsilon}^{\\text{vol}}\n$$\nwhere $\\boldsymbol{\\varepsilon}^{\\text{vol}}$ is the volumetric part of the strain. The volumetric strain is defined as:\n$$\n\\boldsymbol{\\varepsilon}^{\\text{vol}} = \\frac{1}{3} \\operatorname{tr}(\\boldsymbol{\\varepsilon}) \\boldsymbol{I}\n$$\nHere, $\\operatorname{tr}(\\boldsymbol{\\varepsilon})$ is the trace of the strain tensor, and $\\boldsymbol{I}$ is the second-order identity tensor. The trace is the sum of the diagonal components:\n$$\n\\operatorname{tr}(\\boldsymbol{\\varepsilon}) = \\varepsilon_{11} + \\varepsilon_{22} + \\varepsilon_{33}\n$$\nSubstituting this into the definition for $\\boldsymbol{\\varepsilon}^{\\text{dev}}$, we obtain its component form:\n$$\n\\varepsilon_{ij}^{\\text{dev}} = \\varepsilon_{ij} - \\frac{1}{3} (\\varepsilon_{11} + \\varepsilon_{22} + \\varepsilon_{33}) \\delta_{ij}\n$$\nwhere $\\delta_{ij}$ is the Kronecker delta, which is $1$ if $i=j$ and $0$ if $i \\neq j$.\n\nWe now evaluate the components of $\\boldsymbol{\\varepsilon}^{\\text{dev}}$.\n\nFor the diagonal components ($i=j$):\n$$\n\\varepsilon_{11}^{\\text{dev}} = \\varepsilon_{11} - \\frac{1}{3}(\\varepsilon_{11} + \\varepsilon_{22} + \\varepsilon_{33}) = \\frac{2}{3}\\varepsilon_{11} - \\frac{1}{3}\\varepsilon_{22} - \\frac{1}{3}\\varepsilon_{33}\n$$\n$$\n\\varepsilon_{22}^{\\text{dev}} = \\varepsilon_{22} - \\frac{1}{3}(\\varepsilon_{11} + \\varepsilon_{22} + \\varepsilon_{33}) = -\\frac{1}{3}\\varepsilon_{11} + \\frac{2}{3}\\varepsilon_{22} - \\frac{1}{3}\\varepsilon_{33}\n$$\n$$\n\\varepsilon_{33}^{\\text{dev}} = \\varepsilon_{33} - \\frac{1}{3}(\\varepsilon_{11} + \\varepsilon_{22} + \\varepsilon_{33}) = -\\frac{1}{3}\\varepsilon_{11} - \\frac{1}{3}\\varepsilon_{22} + \\frac{2}{3}\\varepsilon_{33}\n$$\n\nFor the off-diagonal components ($i \\neq j$), the Kronecker delta $\\delta_{ij}$ is zero, so the second term vanishes:\n$$\n\\varepsilon_{ij}^{\\text{dev}} = \\varepsilon_{ij} - 0 = \\varepsilon_{ij}\n$$\nThis means $\\varepsilon_{23}^{\\text{dev}} = \\varepsilon_{23}$, $\\varepsilon_{13}^{\\text{dev}} = \\varepsilon_{13}$, and $\\varepsilon_{12}^{\\text{dev}} = \\varepsilon_{12}$.\n\nNext, we map these tensor components to the engineering Voigt strain vector notation. The full strain vector $\\boldsymbol{e}$ and the deviatoric strain vector $\\boldsymbol{e}^{\\text{dev}}$ are defined as:\n$$\n\\boldsymbol{e} = \\begin{pmatrix} \\varepsilon_{11} \\\\ \\varepsilon_{22} \\\\ \\varepsilon_{33} \\\\ \\gamma_{23} \\\\ \\gamma_{13} \\\\ \\gamma_{12} \\end{pmatrix} = \\begin{pmatrix} \\varepsilon_{11} \\\\ \\varepsilon_{22} \\\\ \\varepsilon_{33} \\\\ 2\\varepsilon_{23} \\\\ 2\\varepsilon_{13} \\\\ 2\\varepsilon_{12} \\end{pmatrix} \\quad \\text{and} \\quad \\boldsymbol{e}^{\\text{dev}} = \\begin{pmatrix} \\varepsilon_{11}^{\\text{dev}} \\\\ \\varepsilon_{22}^{\\text{dev}} \\\\ \\varepsilon_{33}^{\\text{dev}} \\\\ \\gamma_{23}^{\\text{dev}} \\\\ \\gamma_{13}^{\\text{dev}} \\\\ \\gamma_{12}^{\\text{dev}} \\end{pmatrix} = \\begin{pmatrix} \\varepsilon_{11}^{\\text{dev}} \\\\ \\varepsilon_{22}^{\\text{dev}} \\\\ \\varepsilon_{33}^{\\text{dev}} \\\\ 2\\varepsilon_{23}^{\\text{dev}} \\\\ 2\\varepsilon_{13}^{\\text{dev}} \\\\ 2\\varepsilon_{12}^{\\text{dev}} \\end{pmatrix}\n$$\nThe first three components of $\\boldsymbol{e}^{\\text{dev}}$ are the diagonal components of $\\boldsymbol{\\varepsilon}^{\\text{dev}}$ which we have already found in terms of the components of $\\boldsymbol{\\varepsilon}$. We can write them in terms of the first three components of $\\boldsymbol{e}$:\n$$\ne_1^{\\text{dev}} = \\varepsilon_{11}^{\\text{dev}} = \\frac{2}{3}e_1 - \\frac{1}{3}e_2 - \\frac{1}{3}e_3\n$$\n$$\ne_2^{\\text{dev}} = \\varepsilon_{22}^{\\text{dev}} = -\\frac{1}{3}e_1 + \\frac{2}{3}e_2 - \\frac{1}{3}e_3\n$$\n$$\ne_3^{\\text{dev}} = \\varepsilon_{33}^{\\text{dev}} = -\\frac{1}{3}e_1 - \\frac{1}{3}e_2 + \\frac{2}{3}e_3\n$$\nThe last three components of $\\boldsymbol{e}^{\\text{dev}}$ are the engineering shear strains. Using the fact that $\\varepsilon_{ij}^{\\text{dev}} = \\varepsilon_{ij}$ for $i \\neq j$:\n$$\ne_4^{\\text{dev}} = \\gamma_{23}^{\\text{dev}} = 2\\varepsilon_{23}^{\\text{dev}} = 2\\varepsilon_{23} = \\gamma_{23} = e_4\n$$\n$$\ne_5^{\\text{dev}} = \\gamma_{13}^{\\text{dev}} = 2\\varepsilon_{13}^{\\text{dev}} = 2\\varepsilon_{13} = \\gamma_{13} = e_5\n$$\n$$\ne_6^{\\text{dev}} = \\gamma_{12}^{\\text{dev}} = 2\\varepsilon_{12}^{\\text{dev}} = 2\\varepsilon_{12} = \\gamma_{12} = e_6\n$$\nWe now write these relationships in matrix form, $\\boldsymbol{e}^{\\text{dev}} = \\mathbb{P}^{\\text{dev}} \\boldsymbol{e}$:\n$$\n\\begin{pmatrix} e_1^{\\text{dev}} \\\\ e_2^{\\text{dev}} \\\\ e_3^{\\text{dev}} \\\\ e_4^{\\text{dev}} \\\\ e_5^{\\text{dev}} \\\\ e_6^{\\text{dev}} \\end{pmatrix} =\n\\begin{pmatrix}\n\\frac{2}{3}e_1 - \\frac{1}{3}e_2 - \\frac{1}{3}e_3 + 0e_4 + 0e_5 + 0e_6 \\\\\n-\\frac{1}{3}e_1 + \\frac{2}{3}e_2 - \\frac{1}{3}e_3 + 0e_4 + 0e_5 + 0e_6 \\\\\n-\\frac{1}{3}e_1 - \\frac{1}{3}e_2 + \\frac{2}{3}e_3 + 0e_4 + 0e_5 + 0e_6 \\\\\n0e_1 + 0e_2 + 0e_3 + 1e_4 + 0e_5 + 0e_6 \\\\\n0e_1 + 0e_2 + 0e_3 + 0e_4 + 1e_5 + 0e_6 \\\\\n0e_1 + 0e_2 + 0e_3 + 0e_4 + 0e_5 + 1e_6\n\\end{pmatrix}\n$$\nBy inspection, we extract the coefficients to form the matrix $\\mathbb{P}^{\\text{dev}}$:\n$$\n\\mathbb{P}^{\\text{dev}} =\n\\begin{pmatrix}\n\\frac{2}{3} & -\\frac{1}{3} & -\\frac{1}{3} & 0 & 0 & 0 \\\\\n-\\frac{1}{3} & \\frac{2}{3} & -\\frac{1}{3} & 0 & 0 & 0 \\\\\n-\\frac{1}{3} & -\\frac{1}{3} & \\frac{2}{3} & 0 & 0 & 0 \\\\\n0 & 0 & 0 & 1 & 0 & 0 \\\\\n0 & 0 & 0 & 0 & 1 & 0 \\\\\n0 & 0 & 0 & 0 & 0 & 1\n\\end{pmatrix}\n$$\nThis matrix maps the normal strain components to their deviatoric counterparts while leaving the engineering shear strain components unchanged, consistent with the definition of deviatoric strain. It can be conveniently written in block form as:\n$$\n\\mathbb{P}^{\\text{dev}} = \\begin{pmatrix} \\mathbb{P}_{3 \\times 3}^{\\text{dev}} & \\boldsymbol{0}_{3 \\times 3} \\\\ \\boldsymbol{0}_{3 \\times 3} & \\boldsymbol{I}_{3 \\times 3} \\end{pmatrix}\n, \\quad \\text{where} \\quad\n\\mathbb{P}_{3 \\times 3}^{\\text{dev}} = \\frac{1}{3} \\begin{pmatrix} 2 & -1 & -1 \\\\ -1 & 2 & -1 \\\\ -1 & -1 & 2 \\end{pmatrix}\n$$\nThe resulting $6 \\times 6$ matrix is the required linear operator.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{2}{3} & -\\frac{1}{3} & -\\frac{1}{3} & 0 & 0 & 0 \\\\\n-\\frac{1}{3} & \\frac{2}{3} & -\\frac{1}{3} & 0 & 0 & 0 \\\\\n-\\frac{1}{3} & -\\frac{1}{3} & \\frac{2}{3} & 0 & 0 & 0 \\\\\n0 & 0 & 0 & 1 & 0 & 0 \\\\\n0 & 0 & 0 & 0 & 1 & 0 \\\\\n0 & 0 & 0 & 0 & 0 & 1\n\\end{pmatrix}\n}\n$$", "id": "3609739"}, {"introduction": "Moving beyond the limitations of infinitesimal theory, the analysis of large deformations requires more sophisticated strain measures. The logarithmic (Hencky) strain is particularly powerful because it retains a clean, additive split into volumetric and deviatoric components, mirroring the simplicity of the small-strain case. This exercise [@problem_id:3609701] will guide you through applying this decomposition in the context of finite principal stretches, reinforcing the physical concepts of volume change and isochoric distortion in a large-deformation setting.", "problem": "Consider a homogeneous deformation characterized by the deformation gradient $\\mathbf{F}$ with its polar decomposition $\\mathbf{F} = \\mathbf{R}\\,\\mathbf{U}$, where $\\mathbf{R}$ is a proper orthogonal rotation and $\\mathbf{U}$ is the right stretch tensor, which is symmetric positive definite (SPD). The principal stretches $\\lambda_1$, $\\lambda_2$, and $\\lambda_3$ are the eigenvalues of $\\mathbf{U}$, and the logarithmic (Hencky) strain tensor is defined as $\\mathbf{h} = \\ln \\mathbf{U}$ by the spectral mapping of the matrix logarithm on SPD tensors. The volumetric-deviatoric split of any second-order tensor is its additive decomposition into spherical and deviatoric parts, where the spherical part is $(\\operatorname{tr}\\mathbf{h}/3)\\,\\mathbf{I}$ and the deviatoric part is $\\mathbf{h}^{\\text{dev}} = \\mathbf{h} - (\\operatorname{tr}\\mathbf{h}/3)\\,\\mathbf{I}$.\n\nStarting from these definitions and facts alone, derive the principal components of the deviatoric logarithmic strain, and use them to compute the principal deviatoric logarithmic strains for the specific principal stretches\n$$\n\\lambda_1 = 4,\\quad \\lambda_2 = 1,\\quad \\lambda_3 = 2.\n$$\nThen, using fundamental properties of determinants and logarithms, demonstrate that their sum is zero.\n\nExpress the final answer as the row vector of the three principal deviatoric logarithmic strains in exact form using natural logarithms. No rounding is required, and no units should be included in the final answer.", "solution": "The problem is valid as it is scientifically grounded in continuum mechanics, well-posed, and objective. It provides all necessary information for a unique solution. We will proceed by first deriving the general expression for the principal deviatoric logarithmic strains, then computing their specific values for the given principal stretches, and finally demonstrating that their sum is zero.\n\nThe right stretch tensor $\\mathbf{U}$ is symmetric and positive-definite (SPD). As such, it admits a spectral decomposition in terms of its eigenvalues $\\lambda_i$ (the principal stretches) and its corresponding orthonormal eigenvectors $\\mathbf{n}_i$ (the principal directions):\n$$\n\\mathbf{U} = \\sum_{i=1}^{3} \\lambda_i \\mathbf{n}_i \\otimes \\mathbf{n}_i\n$$\nThe logarithmic (Hencky) strain tensor $\\mathbf{h}$ is defined as $\\mathbf{h} = \\ln \\mathbf{U}$. This operation is performed via the spectral theorem, which states that $\\mathbf{h}$ shares the same principal directions $\\mathbf{n}_i$ as $\\mathbf{U}$, and its eigenvalues (the principal logarithmic strains, $h_i$) are the natural logarithms of the eigenvalues of $\\mathbf{U}$:\n$$\nh_i = \\ln \\lambda_i\n$$\nThus, the spectral decomposition of $\\mathbf{h}$ is:\n$$\n\\mathbf{h} = \\sum_{i=1}^{3} (\\ln \\lambda_i) \\mathbf{n}_i \\otimes \\mathbf{n}_i\n$$\nThe trace of a tensor is an invariant equal to the sum of its eigenvalues. Therefore, the trace of the logarithmic strain tensor is the sum of its principal values:\n$$\n\\operatorname{tr}(\\mathbf{h}) = \\sum_{i=1}^{3} h_i = \\sum_{i=1}^{3} \\ln \\lambda_i\n$$\nUsing the property of logarithms that the sum of logarithms is the logarithm of the product, we have:\n$$\n\\operatorname{tr}(\\mathbf{h}) = \\ln(\\lambda_1 \\lambda_2 \\lambda_3)\n$$\nThe product of the eigenvalues of a matrix is equal to its determinant. Thus, $\\lambda_1 \\lambda_2 \\lambda_3 = \\det(\\mathbf{U})$. Furthermore, from the polar decomposition $\\mathbf{F} = \\mathbf{R}\\mathbf{U}$ and the fact that $\\det(\\mathbf{R}) = 1$ for a proper rotation, we know that the volumetric Jacobian $J = \\det(\\mathbf{F}) = \\det(\\mathbf{U})$. This leads to the fundamental relation:\n$$\n\\operatorname{tr}(\\mathbf{h}) = \\ln(\\det(\\mathbf{U})) = \\ln(J)\n$$\nThis trace represents the total volumetric change in logarithmic scale.\n\nThe problem defines the volumetric-deviatoric split of $\\mathbf{h}$ as an additive decomposition into a spherical (volumetric) part, $\\mathbf{h}^{\\text{vol}}$, and a deviatoric part, $\\mathbf{h}^{\\text{dev}}$:\n$$\n\\mathbf{h} = \\mathbf{h}^{\\text{vol}} + \\mathbf{h}^{\\text{dev}}\n$$\nwhere the spherical part is given by $\\mathbf{h}^{\\text{vol}} = \\frac{1}{3}\\operatorname{tr}(\\mathbf{h})\\mathbf{I}$ and the deviatoric part is consequently $\\mathbf{h}^{\\text{dev}} = \\mathbf{h} - \\frac{1}{3}\\operatorname{tr}(\\mathbf{h})\\mathbf{I}$. The deviatoric part represents the change in shape (distortion) at constant volume.\n\nTo find the principal components of the deviatoric logarithmic strain, we analyze the tensor $\\mathbf{h}^{\\text{dev}}$ in the principal basis $\\{\\mathbf{n}_1, \\mathbf{n}_2, \\mathbf{n}_3\\}$. In this basis, the matrix representation of $\\mathbf{h}$ is diagonal with entries $h_i = \\ln \\lambda_i$. The identity tensor $\\mathbf{I}$ is also diagonal. The matrix representation of $\\mathbf{h}^{\\text{dev}}$ is therefore also diagonal, and its diagonal entries are the principal deviatoric strains, $h_i^{\\text{dev}}$.\n$$\nh_i^{\\text{dev}} = h_i - \\frac{1}{3}\\operatorname{tr}(\\mathbf{h})\n$$\nSubstituting the expressions for $h_i$ and $\\operatorname{tr}(\\mathbf{h})$, we arrive at the general formula for the principal components of the deviatoric logarithmic strain:\n$$\nh_i^{\\text{dev}} = \\ln \\lambda_i - \\frac{1}{3} \\sum_{j=1}^{3} \\ln \\lambda_j\n$$\nThis completes the first part of the task.\n\nNext, we compute the specific values for the principal stretches $\\lambda_1 = 4$, $\\lambda_2 = 1$, and $\\lambda_3 = 2$.\nFirst, we compute the trace of the logarithmic strain tensor $\\mathbf{h}$:\n$$\n\\operatorname{tr}(\\mathbf{h}) = \\ln(4) + \\ln(1) + \\ln(2) = \\ln(4 \\times 1 \\times 2) = \\ln(8)\n$$\nThe mean strain component is $\\frac{1}{3}\\operatorname{tr}(\\mathbf{h}) = \\frac{1}{3}\\ln(8)$. We can simplify this using logarithm properties: $\\frac{1}{3}\\ln(8) = \\frac{1}{3}\\ln(2^3) = \\frac{3}{3}\\ln(2) = \\ln(2)$.\n\nNow we compute each principal deviatoric strain, $h_i^{\\text{dev}} = \\ln \\lambda_i - \\ln(2)$:\nFor $i=1$:\n$$\nh_1^{\\text{dev}} = \\ln(4) - \\ln(2) = \\ln\\left(\\frac{4}{2}\\right) = \\ln(2)\n$$\nFor $i=2$:\n$$\nh_2^{\\text{dev}} = \\ln(1) - \\ln(2) = 0 - \\ln(2) = -\\ln(2)\n$$\nFor $i=3$:\n$$\nh_3^{\\text{dev}} = \\ln(2) - \\ln(2) = 0\n$$\nThe principal deviatoric logarithmic strains are therefore $\\ln(2)$, $-\\ln(2)$, and $0$.\n\nFinally, we are asked to demonstrate that the sum of these principal components is zero, using fundamental properties of determinants and logarithms. The sum of the principal deviatoric strains is, by definition, the trace of the deviatoric tensor, $\\operatorname{tr}(\\mathbf{h}^{\\text{dev}})$.\n$$\n\\operatorname{tr}(\\mathbf{h}^{\\text{dev}}) = \\sum_{i=1}^{3} h_i^{\\text{dev}} = \\sum_{i=1}^{3} \\left(\\ln \\lambda_i - \\frac{1}{3} \\sum_{j=1}^{3} \\ln \\lambda_j\\right)\n$$\nExpanding the sum:\n$$\n\\operatorname{tr}(\\mathbf{h}^{\\text{dev}}) = \\left(\\sum_{i=1}^{3} \\ln \\lambda_i\\right) - 3 \\left(\\frac{1}{3} \\sum_{j=1}^{3} \\ln \\lambda_j\\right) = \\left(\\sum_{i=1}^{3} \\ln \\lambda_i\\right) - \\left(\\sum_{j=1}^{3} \\ln \\lambda_j\\right)\n$$\nNow, we use the properties of logarithms and determinants. The sum of logarithms is the logarithm of the product:\n$$\n\\sum_{i=1}^{3} \\ln \\lambda_i = \\ln(\\lambda_1 \\lambda_2 \\lambda_3)\n$$\nThe product of eigenvalues is the determinant of the tensor:\n$$\n\\lambda_1 \\lambda_2 \\lambda_3 = \\det(\\mathbf{U})\n$$\nTherefore, the sum of the principal deviatoric strains is:\n$$\n\\operatorname{tr}(\\mathbf{h}^{\\text{dev}}) = \\ln(\\det(\\mathbf{U})) - \\ln(\\det(\\mathbf{U})) = 0\n$$\nThis demonstrates that the sum is identically zero, rooted in the definition of the deviatoric tensor and the fundamental properties of logarithms and determinants. For our specific case, the sum is $\\ln(2) + (-\\ln(2)) + 0 = 0$, which is consistent with the general proof.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\ln(2) & -\\ln(2) & 0\n\\end{pmatrix}\n}\n$$", "id": "3609701"}, {"introduction": "Theoretical formulas are only half the story; a robust numerical implementation must handle potential instabilities. This advanced practice confronts the challenge of computing the logarithmic strain when principal stretches are nearly equal, a scenario that can lead to numerical errors in naive implementations. By developing a stabilized algorithm [@problem_id:3609738], you will gain insight into the subtleties of computational kinematics and learn techniques essential for creating reliable and accurate simulation tools.", "problem": "You are given a right stretch tensor from the polar decomposition in continuum mechanics, which is a symmetric positive-definite (SPD) tensor denoted by $\\boldsymbol{U} \\in \\mathbb{R}^{3 \\times 3}$. The aim is to compute the deviatoric part of the logarithmic (Hencky) strain, denoted by $\\boldsymbol{h}^{\\mathrm{dev}}$, using the eigendecomposition of $\\boldsymbol{U}$, and to design an algorithm that remains numerically stable when principal stretches are nearly equal.\n\nStart from fundamental definitions:\n- The logarithmic strain is defined as the principal matrix logarithm $\\boldsymbol{h} = \\log \\boldsymbol{U}$.\n- The deviatoric projection of any second-order tensor $\\boldsymbol{A}$ is given by $\\operatorname{dev}(\\boldsymbol{A}) = \\boldsymbol{A} - \\dfrac{1}{3}\\operatorname{tr}(\\boldsymbol{A}) \\boldsymbol{I}$, where $\\boldsymbol{I}$ is the identity tensor and $\\operatorname{tr}(\\cdot)$ denotes the trace operator.\n\nUsing only the spectral theorem for real symmetric matrices and these definitions as the fundamental base, derive from first principles an algorithm that computes $\\boldsymbol{h}^{\\mathrm{dev}}$ from $\\boldsymbol{U}$ via its eigendecomposition $\\boldsymbol{U} = \\boldsymbol{Q}\\,\\mathrm{diag}(\\lambda_1,\\lambda_2,\\lambda_3)\\,\\boldsymbol{Q}^\\mathsf{T}$, with $\\lambda_i > 0$ the principal stretches and $\\boldsymbol{Q}$ orthogonal. Your algorithm must explicitly address and mitigate numerical stability issues when two or more $\\lambda_i$ are nearly equal. In particular, incorporate a clustering tolerance $\\tau > 0$ so that eigenvalues within a relative gap less than or equal to $\\tau$ are treated as a cluster and assigned a common principal logarithmic stretch equal to the average of their logarithms, while their spectral projector is taken as the sum of the individual projectors. Then form $\\boldsymbol{h}$ from this clustered spectral representation and finally compute $\\boldsymbol{h}^{\\mathrm{dev}}$ by removing the volumetric part.\n\nImplementation requirements:\n- Design two computational paths:\n  - An \"exact spectral\" path that uses the eigendecomposition to compute $\\boldsymbol{h} = \\boldsymbol{Q}\\,\\mathrm{diag}(\\log \\lambda_1,\\log \\lambda_2,\\log \\lambda_3)\\,\\boldsymbol{Q}^\\mathsf{T}$ without clustering, and then $\\boldsymbol{h}^{\\mathrm{dev}}$ via the deviatoric projection.\n  - A \"stabilized spectral\" path that performs eigenvalue clustering with a user-specified tolerance $\\tau$ as described above before reconstructing $\\boldsymbol{h}$, and then applies the deviatoric projection to obtain $\\boldsymbol{h}^{\\mathrm{dev}}$.\n- For both paths, ensure that the result is real-valued and symmetric to within floating-point rounding.\n- Angles, when used, must be in radians.\n\nTest suite and output specification:\n- Use the following five symmetric positive-definite test tensors (all entries are dimensionless). Let $\\boldsymbol{R}_z(\\theta)$ denote a rotation by angle $\\theta$ about the $z$-axis and $\\boldsymbol{R}_y(\\phi)$ a rotation by angle $\\phi$ about the $y$-axis. Use $\\theta = \\pi/4$ and $\\phi = 0.2$ (radians), and define $\\boldsymbol{Q} = \\boldsymbol{R}_z(\\theta)\\,\\boldsymbol{R}_y(\\phi)$.\n  1. $\\boldsymbol{U}_1 = \\mathrm{diag}(1.4,\\,1.1,\\,0.7)$.\n  2. $\\boldsymbol{U}_2 = \\boldsymbol{Q}^\\mathsf{T}\\,\\mathrm{diag}(1.5,\\,1.5,\\,0.8)\\,\\boldsymbol{Q}$.\n  3. $\\boldsymbol{U}_3 = \\mathrm{diag}(1.2,\\,1.2,\\,1.2)$.\n  4. $\\boldsymbol{U}_4 = \\mathrm{diag}(1.1,\\,1.100000001,\\,0.9)$.\n  5. $\\boldsymbol{U}_5 = \\mathrm{diag}(10^{-8},\\,1.0,\\,10^{8})$.\n- Use a clustering tolerance of $\\tau = 10^{-7}$.\n- For each $\\boldsymbol{U}_k$, compute the Frobenius norm of the difference between the stabilized and exact deviatoric logarithmic strains,\n  $$e_k = \\left\\|\\boldsymbol{h}^{\\mathrm{dev}}_{\\mathrm{stabilized}}(\\boldsymbol{U}_k;\\tau) - \\boldsymbol{h}^{\\mathrm{dev}}_{\\mathrm{exact}}(\\boldsymbol{U}_k)\\right\\|_{\\mathrm{F}},$$\n  where $\\|\\cdot\\|_{\\mathrm{F}}$ is the Frobenius norm.\n- Your program should produce a single line of output containing the five real numbers $e_1,\\ldots,e_5$ as a comma-separated list enclosed in square brackets, with no units, for example, $[x_1,x_2,x_3,x_4,x_5]$.\n\nYour task:\n- Provide a complete, runnable program that implements the above algorithm and computes the required output on the specified test suite. No user input is required. Ensure all intermediate computations adhere to the definitions provided and that numerical stability is addressed in the stabilized path via eigenvalue clustering.", "solution": "The problem requires the development and implementation of a numerically stable algorithm to compute the deviatoric part of the logarithmic strain tensor, $\\boldsymbol{h}^{\\mathrm{dev}}$, from the right stretch tensor $\\boldsymbol{U}$. The solution must be derived from first principles and must explicitly address numerical instabilities arising from nearly-repeated principal stretches (eigenvalues of $\\boldsymbol{U}$).\n\nFirst, we establish the mathematical framework based on the provided definitions. The right stretch tensor $\\boldsymbol{U}$ is a symmetric positive-definite (SPD) tensor in $\\mathbb{R}^{3 \\times 3}$. According to the spectral theorem for real symmetric matrices, $\\boldsymbol{U}$ can be decomposed as:\n$$ \\boldsymbol{U} = \\sum_{i=1}^{3} \\lambda_i (\\boldsymbol{q}_i \\otimes \\boldsymbol{q}_i) = \\boldsymbol{Q} \\boldsymbol{\\Lambda} \\boldsymbol{Q}^\\mathsf{T} $$\nwhere $\\lambda_i > 0$ are the eigenvalues of $\\boldsymbol{U}$, known as the principal stretches, and $\\boldsymbol{q}_i$ are the corresponding orthonormal eigenvectors, forming the columns of the orthogonal matrix $\\boldsymbol{Q}$. The tensor $\\boldsymbol{\\Lambda}$ is a diagonal matrix of the eigenvalues. The term $\\boldsymbol{P}_i = \\boldsymbol{q}_i \\otimes \\boldsymbol{q}_i$ represents the spectral projector onto the eigenspace of $\\lambda_i$.\n\nThe logarithmic strain tensor, or Hencky strain, $\\boldsymbol{h}$, is defined as the principal matrix logarithm of $\\boldsymbol{U}$. Applying the function on the spectrum of $\\boldsymbol{U}$ yields:\n$$ \\boldsymbol{h} = \\log(\\boldsymbol{U}) = \\sum_{i=1}^{3} \\log(\\lambda_i) \\boldsymbol{P}_i = \\boldsymbol{Q} \\mathrm{diag}(\\log\\lambda_1, \\log\\lambda_2, \\log\\lambda_3) \\boldsymbol{Q}^\\mathsf{T} $$\nWe denote the principal logarithmic strains as $h_i = \\log(\\lambda_i)$.\n\nThe deviatoric part of any second-order tensor $\\boldsymbol{A}$, denoted $\\operatorname{dev}(\\boldsymbol{A})$, is obtained by subtracting its isotropic (or spherical) part:\n$$ \\operatorname{dev}(\\boldsymbol{A}) = \\boldsymbol{A} - \\frac{1}{3}\\operatorname{tr}(\\boldsymbol{A}) \\boldsymbol{I} $$\nwhere $\\operatorname{tr}(\\cdot)$ is the trace operator and $\\boldsymbol{I}$ is the $3 \\times 3$ identity tensor.\n\nTo find the deviatoric logarithmic strain $\\boldsymbol{h}^{\\mathrm{dev}}$, we first compute the trace of $\\boldsymbol{h}$:\n$$ \\operatorname{tr}(\\boldsymbol{h}) = \\operatorname{tr}\\left(\\sum_{i=1}^{3} h_i \\boldsymbol{P}_i\\right) = \\sum_{i=1}^{3} h_i \\operatorname{tr}(\\boldsymbol{P}_i) $$\nThe trace of a rank-$1$ projector $\\boldsymbol{P}_i = \\boldsymbol{q}_i \\boldsymbol{q}_i^\\mathsf{T}$ is $\\operatorname{tr}(\\boldsymbol{q}_i \\boldsymbol{q}_i^\\mathsf{T}) = \\operatorname{tr}(\\boldsymbol{q}_i^\\mathsf{T} \\boldsymbol{q}_i) = \\operatorname{tr}(1) = 1$. Thus, the trace of $\\boldsymbol{h}$ is the sum of the principal logarithmic strains, which is the volumetric logarithmic strain $h_{\\mathrm{vol}}$:\n$$ \\operatorname{tr}(\\boldsymbol{h}) = \\sum_{i=1}^{3} h_i = \\log(\\lambda_1) + \\log(\\lambda_2) + \\log(\\lambda_3) = \\log(\\lambda_1 \\lambda_2 \\lambda_3) = \\log(\\det(\\boldsymbol{U})) $$\nThe deviatoric strain tensor is then:\n$$ \\boldsymbol{h}^{\\mathrm{dev}} = \\boldsymbol{h} - \\frac{1}{3} h_{\\mathrm{vol}} \\boldsymbol{I} = \\boldsymbol{h} - \\frac{1}{3} \\left(\\sum_{i=1}^{3} h_i\\right) \\boldsymbol{I} $$\n\nTwo computational procedures are designed as per the problem requirements.\n\n**1. Exact Spectral Algorithm**\nThis path follows the derived formulas directly, without special handling for eigenvalue proximity.\n1.  Compute the eigendecomposition of $\\boldsymbol{U}$ to obtain eigenvalues $\\lambda_i$ and eigenvectors $\\boldsymbol{q}_i$ (as columns of $\\boldsymbol{Q}$).\n2.  Compute the principal logarithmic strains $h_i = \\log(\\lambda_i)$ for $i=1, 2, 3$.\n3.  Reconstruct the full logarithmic strain tensor $\\boldsymbol{h} = \\boldsymbol{Q} \\mathrm{diag}(h_1, h_2, h_3) \\boldsymbol{Q}^\\mathsf{T}$.\n4.  Compute the trace $\\operatorname{tr}(\\boldsymbol{h}) = h_1 + h_2 + h_3$.\n5.  Compute the deviatoric tensor $\\boldsymbol{h}^{\\mathrm{dev}}_{\\mathrm{exact}} = \\boldsymbol{h} - \\frac{1}{3}\\operatorname{tr}(\\boldsymbol{h})\\boldsymbol{I}$.\n\n**2. Stabilized Spectral Algorithm**\nThis path addresses numerical instabilities that occur when two or more eigenvalues $\\lambda_i$ are nearly equal. In such cases, the corresponding eigenvectors are not numerically stable, though the subspace they span is. The prescribed stabilization procedure regularizes the computation by averaging within clusters of close eigenvalues.\n1.  Compute the eigendecomposition of $\\boldsymbol{U}$ to obtain sorted eigenvalues $\\lambda_1 \\le \\lambda_2 \\le \\lambda_3$ and eigenvectors $\\boldsymbol{Q}$.\n2.  Identify clusters of eigenvalues. A cluster is formed if the relative gap between adjacent eigenvalues is below a tolerance $\\tau$. For a pair $\\lambda_i, \\lambda_{i+1}$, the condition is $|\\lambda_{i+1} - \\lambda_i| / ((\\lambda_{i+1} + \\lambda_i)/2) \\le \\tau$. The clustering is transitive.\n3.  For each identified cluster $C_k = \\{\\lambda_j, ..., \\lambda_m\\}$, compute a common principal logarithmic stretch as the average of their individual logarithms:\n    $$ h_{C_k} = \\frac{1}{|C_k|} \\sum_{j \\in C_k} \\log(\\lambda_j) $$\n    For eigenvalues not in any cluster, their logarithmic strain is computed individually as $h_i = \\log(\\lambda_i)$.\n4.  Reconstruct the stabilized logarithmic strain tensor $\\boldsymbol{h}_{\\mathrm{stabilized}}$ using the (potentially averaged) principal logarithmic strains.\n    $$ \\boldsymbol{h}_{\\mathrm{stabilized}} = \\boldsymbol{Q} \\mathrm{diag}(h^{\\mathrm{stab}}_1, h^{\\mathrm{stab}}_2, h^{\\mathrm{stab}}_3) \\boldsymbol{Q}^\\mathsf{T} $$\n5.  Compute the trace $\\operatorname{tr}(\\boldsymbol{h}_{\\mathrm{stabilized}})$. Note that this procedure preserves the trace: $\\operatorname{tr}(\\boldsymbol{h}_{\\mathrm{stabilized}}) = \\sum_i h^{\\mathrm{stab}}_i = \\sum_i \\log(\\lambda_i) = \\operatorname{tr}(\\boldsymbol{h})$.\n6.  Compute the deviatoric tensor $\\boldsymbol{h}^{\\mathrm{dev}}_{\\mathrm{stabilized}} = \\boldsymbol{h}_{\\mathrm{stabilized}} - \\frac{1}{3}\\operatorname{tr}(\\boldsymbol{h}_{\\mathrm{stabilized}})\\boldsymbol{I}$.\n\nThe stabilization works by replacing the numerically sensitive computation involving individual projectors, e.g., $\\log(\\lambda_i)\\boldsymbol{P}_i + \\log(\\lambda_j)\\boldsymbol{P}_j$, with $\\frac{1}{2}(\\log\\lambda_i+\\log\\lambda_j)(\\boldsymbol{P}_i+\\boldsymbol{P}_j)$. The combined projector $\\boldsymbol{P}_i+\\boldsymbol{P}_j$ is stable even if $\\boldsymbol{P}_i$ and $\\boldsymbol{P}_j$ are not.\n\nFinally, the difference between the two approaches for each test case $\\boldsymbol{U}_k$ is quantified using the Frobenius norm of the difference between the resulting deviatoric tensors:\n$$ e_k = \\left\\|\\boldsymbol{h}^{\\mathrm{dev}}_{\\mathrm{stabilized}}(\\boldsymbol{U}_k;\\tau) - \\boldsymbol{h}^{\\mathrm{dev}}_{\\mathrm{exact}}(\\boldsymbol{U}_k)\\right\\|_{\\mathrm{F}} $$\nThe implementation will construct the five test tensors, compute $e_k$ for each, and report the results. To ensure symmetry in the face of floating-point inaccuracies, all computed strain tensors $\\boldsymbol{h}$ and $\\boldsymbol{h}^{\\mathrm{dev}}$ are explicitly symmetrized via the operation $\\boldsymbol{A} \\to \\frac{1}{2}(\\boldsymbol{A} + \\boldsymbol{A}^\\mathsf{T})$.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef compute_h_dev(U, stabilized, tau):\n    \"\"\"\n    Computes the deviatoric logarithmic strain tensor for a given stretch tensor U.\n\n    Args:\n        U (np.ndarray): The 3x3 symmetric positive-definite right stretch tensor.\n        stabilized (bool): If True, use the eigenvalue clustering stabilization.\n                           If False, use the direct 'exact' spectral method.\n        tau (float): The relative tolerance for eigenvalue clustering.\n\n    Returns:\n        np.ndarray: The 3x3 deviatoric logarithmic strain tensor.\n    \"\"\"\n    # For a real symmetric matrix U, eigh is the correct and robust choice.\n    # It returns eigenvalues sorted in ascending order and corresponding eigenvectors.\n    l, Q = np.linalg.eigh(U)\n\n    # The problem statement guarantees U is SPD, so all eigenvalues lambda_i are > 0.\n    # Thus, np.log(l) is well-defined.\n    \n    h_prin = np.log(l)\n    \n    h_prin_to_use = h_prin.copy()\n    \n    if stabilized:\n        # Perform eigenvalue clustering on the sorted eigenvalues 'l'.\n        \n        # Check for proximity between adjacent eigenvalues\n        is_close_01 = abs(l[1] - l[0]) = tau * (l[1] + l[0]) / 2.0\n        is_close_12 = abs(l[2] - l[1]) = tau * (l[2] + l[1]) / 2.0\n        \n        if is_close_01 and is_close_12:\n            # Cluster of 3: all eigenvalues are close.\n            h_avg = np.mean(h_prin)\n            h_prin_to_use[:] = h_avg\n        elif is_close_01:\n            # Cluster of 2: eigenvalues at indices 0 and 1 are close.\n            h_avg = np.mean(h_prin[0:2])\n            h_prin_to_use[0:2] = h_avg\n        elif is_close_12:\n            # Cluster of 2: eigenvalues at indices 1 and 2 are close.\n            h_avg = np.mean(h_prin[1:3])\n            h_prin_to_use[1:3] = h_avg\n    \n    # Reconstruct the logarithmic strain tensor H from its spectral components\n    H = Q @ np.diag(h_prin_to_use) @ Q.T\n    \n    # Enforce symmetry to correct for any minor floating-point inaccuracies\n    H = (H + H.T) / 2.0\n    \n    # Compute the deviatoric part by removing the isotropic part\n    trace_H = np.trace(H)\n    H_dev = H - (1/3.0) * trace_H * np.eye(3)\n    \n    return H_dev\n\ndef solve():\n    \"\"\"\n    Main function to define test cases, run computations, and print the results.\n    \"\"\"\n    # Define constants as per the problem statement\n    theta = np.pi / 4.0\n    phi = 0.2\n    tau = 1e-7\n\n    # Construct the rotation matrix Q for test case U_2\n    c_th, s_th = np.cos(theta), np.sin(theta)\n    Rz = np.array([[c_th, -s_th, 0.0], \n                   [s_th,  c_th, 0.0], \n                   [0.0,   0.0, 1.0]])\n    \n    c_ph, s_ph = np.cos(phi), np.sin(phi)\n    Ry = np.array([[c_ph,  0.0, s_ph],                    \n                   [0.0,   1.0, 0.0], \n                   [-s_ph, 0.0, c_ph]])\n    \n    Q_for_U2 = Rz @ Ry\n\n    # Define the five symmetric positive-definite test tensors\n    test_cases = [\n        # U_1: Distinct eigenvalues\n        np.diag([1.4, 1.1, 0.7]),\n        \n        # U_2: Repeated eigenvalues, non-diagonal\n        Q_for_U2.T @ np.diag([1.5, 1.5, 0.8]) @ Q_for_U2,\n        \n        # U_3: All eigenvalues are identical (isotropic stretch)\n        np.diag([1.2, 1.2, 1.2]),\n        \n        # U_4: Nearly-repeated eigenvalues, to test clustering\n        np.diag([1.1, 1.100000001, 0.9]),\n        \n        # U_5: Eigenvalues with very large spread (ill-conditioned)\n        np.diag([1e-8, 1.0, 1e8])\n    ]\n\n    results = []\n    for U in test_cases:\n        # Compute the deviatoric log strain using the 'exact' method\n        h_dev_exact = compute_h_dev(U, stabilized=False, tau=None)\n        \n        # Compute the deviatoric log strain using the 'stabilized' method\n        h_dev_stab = compute_h_dev(U, stabilized=True, tau=tau)\n        \n        # Calculate the Frobenius norm of the difference between the two results\n        error = np.linalg.norm(h_dev_stab - h_dev_exact, 'fro')\n        results.append(error)\n\n    # Format and print the final output as a single list\n    print(f\"[{','.join([f'{r:.17e}' for r in results])}]\")\n\nsolve()\n```", "id": "3609738"}]}