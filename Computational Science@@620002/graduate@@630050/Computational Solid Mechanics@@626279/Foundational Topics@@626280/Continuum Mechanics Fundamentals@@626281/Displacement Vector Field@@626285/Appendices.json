{"hands_on_practices": [{"introduction": "Linear strain theory offers a simplified view of deformation, but it has significant limitations. This practice explores a crucial case where this theory can be misleading: a displacement field that seems to represent a pure rigid-body rotation. By computing the Green–Lagrange strain, you will discover that finite rotations induce apparent strains that linearized theory misses, highlighting the necessity of geometrically non-linear measures in finite deformation analysis [@problem_id:3559297].", "problem": "Consider a homogeneous body in its reference configuration with material point position vector $\\boldsymbol{X} = (X_{1}, X_{2}, X_{3})$. A displacement vector field $\\boldsymbol{u}(\\boldsymbol{X})$ is prescribed as $\\boldsymbol{u}(\\boldsymbol{X}) = (\\theta X_{2}, -\\theta X_{1}, 0)$, where $\\theta$ is a finite constant angle. The current configuration is given by $\\boldsymbol{x}(\\boldsymbol{X}) = \\boldsymbol{X} + \\boldsymbol{u}(\\boldsymbol{X})$. Using the fundamental kinematic definitions of continuum mechanics, derive the deformation gradient $\\boldsymbol{F}$ and the Green–Lagrange strain tensor $\\boldsymbol{E}$. Then, starting from the definitions of the right Cauchy–Green deformation tensor and the infinitesimal strain tensor, explain from first principles why the Green–Lagrange strain is not zero for finite $\\theta$, even though the infinitesimal strain computed from the symmetric part of the displacement gradient is zero for this field.\n\nYou must base your derivation on the following:\n- The deformation gradient is defined as $\\boldsymbol{F} = \\partial \\boldsymbol{x} / \\partial \\boldsymbol{X}$.\n- The right Cauchy–Green deformation tensor is defined as $\\boldsymbol{C} = \\boldsymbol{F}^{\\mathsf{T}} \\boldsymbol{F}$.\n- The Green–Lagrange strain tensor is defined as $\\boldsymbol{E} = \\tfrac{1}{2}(\\boldsymbol{C} - \\boldsymbol{I})$, where $\\boldsymbol{I}$ is the identity tensor.\n- The infinitesimal (linearized) strain tensor is $\\boldsymbol{\\varepsilon}^{\\text{lin}} = \\tfrac{1}{2}(\\nabla \\boldsymbol{u} + (\\nabla \\boldsymbol{u})^{\\mathsf{T}})$.\n\nAssume the angle $\\theta$ is specified in radians. No numerical rounding is required. Provide your final answer as the $3 \\times 3$ matrix expression for $\\boldsymbol{E}$ in terms of $\\theta$, and express the angle in radians. In addition to this final answer, your solution must derive $\\boldsymbol{F}$ and include the requested explanation.", "solution": "The problem statement is evaluated as valid. It is scientifically grounded in continuum mechanics, well-posed, and objective. It provides all necessary definitions and data to derive the requested quantities and formulate the explanation.\n\nThe problem asks for the derivation of the deformation gradient $\\boldsymbol{F}$ and the Green–Lagrange strain tensor $\\boldsymbol{E}$ for a given displacement field, followed by an explanation for the discrepancy between the Green–Lagrange strain and the infinitesimal strain for this field.\n\nThe position vector in the reference configuration is $\\boldsymbol{X} = (X_1, X_2, X_3)$.\nThe prescribed displacement vector field is $\\boldsymbol{u}(\\boldsymbol{X}) = (\\theta X_2, -\\theta X_1, 0)$, where $\\theta$ is a finite constant.\nThe position vector in the current configuration is given by $\\boldsymbol{x}(\\boldsymbol{X}) = \\boldsymbol{X} + \\boldsymbol{u}(\\boldsymbol{X})$.\nIn component form, the current coordinates $x_i$ are:\n$$x_1 = X_1 + u_1(\\boldsymbol{X}) = X_1 + \\theta X_2$$\n$$x_2 = X_2 + u_2(\\boldsymbol{X}) = X_2 - \\theta X_1$$\n$$x_3 = X_3 + u_3(\\boldsymbol{X}) = X_3 + 0 = X_3$$\n\nFirst, we derive the deformation gradient $\\boldsymbol{F}$, defined as $F_{ij} = \\frac{\\partial x_i}{\\partial X_j}$.\n\nThe components of $\\boldsymbol{F}$ are calculated as follows:\n$F_{11} = \\frac{\\partial x_1}{\\partial X_1} = \\frac{\\partial}{\\partial X_1}(X_1 + \\theta X_2) = 1$\n$F_{12} = \\frac{\\partial x_1}{\\partial X_2} = \\frac{\\partial}{\\partial X_2}(X_1 + \\theta X_2) = \\theta$\n$F_{13} = \\frac{\\partial x_1}{\\partial X_3} = \\frac{\\partial}{\\partial X_3}(X_1 + \\theta X_2) = 0$\n\n$F_{21} = \\frac{\\partial x_2}{\\partial X_1} = \\frac{\\partial}{\\partial X_1}(X_2 - \\theta X_1) = -\\theta$\n$F_{22} = \\frac{\\partial x_2}{\\partial X_2} = \\frac{\\partial}{\\partial X_2}(X_2 - \\theta X_1) = 1$\n$F_{23} = \\frac{\\partial x_2}{\\partial X_3} = \\frac{\\partial}{\\partial X_3}(X_2 - \\theta X_1) = 0$\n\n$F_{31} = \\frac{\\partial x_3}{\\partial X_1} = \\frac{\\partial}{\\partial X_1}(X_3) = 0$\n$F_{32} = \\frac{\\partial x_3}{\\partial X_2} = \\frac{\\partial}{\\partial X_2}(X_3) = 0$\n$F_{33} = \\frac{\\partial x_3}{\\partial X_3} = \\frac{\\partial}{\\partial X_3}(X_3) = 1$\n\nAssembling these components into matrix form, the deformation gradient is:\n$$\\boldsymbol{F} = \\begin{pmatrix} 1 & \\theta & 0 \\\\ -\\theta & 1 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix}$$\n\nNext, we derive the Green–Lagrange strain tensor $\\boldsymbol{E}$. This requires the right Cauchy–Green deformation tensor $\\boldsymbol{C} = \\boldsymbol{F}^{\\mathsf{T}} \\boldsymbol{F}$.\nThe transpose of $\\boldsymbol{F}$ is:\n$$\\boldsymbol{F}^{\\mathsf{T}} = \\begin{pmatrix} 1 & -\\theta & 0 \\\\ \\theta & 1 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix}$$\nNow, we compute the matrix product $\\boldsymbol{C} = \\boldsymbol{F}^{\\mathsf{T}} \\boldsymbol{F}$:\n$$\\boldsymbol{C} = \\begin{pmatrix} 1 & -\\theta & 0 \\\\ \\theta & 1 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix} \\begin{pmatrix} 1 & \\theta & 0 \\\\ -\\theta & 1 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix}$$\n$$= \\begin{pmatrix} (1)(1) + (-\\theta)(-\\theta) + (0)(0) & (1)(\\theta) + (-\\theta)(1) + (0)(0) & (1)(0) + (-\\theta)(0) + (0)(1) \\\\ (\\theta)(1) + (1)(-\\theta) + (0)(0) & (\\theta)(\\theta) + (1)(1) + (0)(0) & (\\theta)(0) + (1)(0) + (0)(1) \\\\ (0)(1) + (0)(-\\theta) + (1)(0) & (0)(\\theta) + (0)(1) + (1)(0) & (0)(0) + (0)(0) + (1)(1) \\end{pmatrix}$$\n$$= \\begin{pmatrix} 1 + \\theta^2 & 0 & 0 \\\\ 0 & 1 + \\theta^2 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix}$$\nThe Green–Lagrange strain tensor is defined as $\\boldsymbol{E} = \\frac{1}{2}(\\boldsymbol{C} - \\boldsymbol{I})$, where $\\boldsymbol{I}$ is the second-order identity tensor.\n$$\\boldsymbol{E} = \\frac{1}{2} \\left( \\begin{pmatrix} 1 + \\theta^2 & 0 & 0 \\\\ 0 & 1 + \\theta^2 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix} - \\begin{pmatrix} 1 & 0 & 0 \\\\ 0 & 1 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix} \\right)$$\n$$\\boldsymbol{E} = \\frac{1}{2} \\begin{pmatrix} \\theta^2 & 0 & 0 \\\\ 0 & \\theta^2 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{2}\\theta^2 & 0 & 0 \\\\ 0 & \\frac{1}{2}\\theta^2 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix}$$\nFor any finite, non-zero angle $\\theta$, the Green–Lagrange strain tensor $\\boldsymbol{E}$ is non-zero.\n\nNow, we investigate the infinitesimal strain tensor $\\boldsymbol{\\varepsilon}^{\\text{lin}}$ and explain the discrepancy.\nFirst, we compute the displacement gradient tensor, $\\nabla \\boldsymbol{u}$, whose components are $(\\nabla \\boldsymbol{u})_{ij} = \\frac{\\partial u_i}{\\partial X_j}$.\n$u_1 = \\theta X_2$, $u_2 = -\\theta X_1$, $u_3 = 0$.\n$(\\nabla \\boldsymbol{u})_{11} = \\frac{\\partial u_1}{\\partial X_1} = 0$, $(\\nabla \\boldsymbol{u})_{12} = \\frac{\\partial u_1}{\\partial X_2} = \\theta$, $(\\nabla \\boldsymbol{u})_{13} = \\frac{\\partial u_1}{\\partial X_3} = 0$\n$(\\nabla \\boldsymbol{u})_{21} = \\frac{\\partial u_2}{\\partial X_1} = -\\theta$, $(\\nabla \\boldsymbol{u})_{22} = \\frac{\\partial u_2}{\\partial X_2} = 0$, $(\\nabla \\boldsymbol{u})_{23} = \\frac{\\partial u_2}{\\partial X_3} = 0$\n$(\\nabla \\boldsymbol{u})_{31} = \\frac{\\partial u_3}{\\partial X_1} = 0$, $(\\nabla \\boldsymbol{u})_{32} = \\frac{\\partial u_3}{\\partial X_2} = 0$, $(\\nabla \\boldsymbol{u})_{33} = \\frac{\\partial u_3}{\\partial X_3} = 0$\nThus, the displacement gradient tensor is:\n$$\\nabla \\boldsymbol{u} = \\begin{pmatrix} 0 & \\theta & 0 \\\\ -\\theta & 0 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix}$$\nThis tensor is purely skew-symmetric, meaning $(\\nabla \\boldsymbol{u})^{\\mathsf{T}} = -\\nabla \\boldsymbol{u}$.\n\nThe infinitesimal strain tensor is the symmetric part of the displacement gradient:\n$$\\boldsymbol{\\varepsilon}^{\\text{lin}} = \\frac{1}{2}(\\nabla \\boldsymbol{u} + (\\nabla \\boldsymbol{u})^{\\mathsf{T}})$$\nSubstituting the calculated $\\nabla \\boldsymbol{u}$:\n$$\\boldsymbol{\\varepsilon}^{\\text{lin}} = \\frac{1}{2} \\left( \\begin{pmatrix} 0 & \\theta & 0 \\\\ -\\theta & 0 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix} + \\begin{pmatrix} 0 & -\\theta & 0 \\\\ \\theta & 0 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix} \\right) = \\frac{1}{2} \\begin{pmatrix} 0 & 0 & 0 \\\\ 0 & 0 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix} = \\boldsymbol{0}$$\nSo, the infinitesimal strain is the zero tensor.\n\nThe explanation for this seeming contradiction lies in the fundamental relationship between the Green–Lagrange strain tensor $\\boldsymbol{E}$ and the infinitesimal strain tensor $\\boldsymbol{\\varepsilon}^{\\text{lin}}$. This relationship can be derived by substituting $\\boldsymbol{F} = \\boldsymbol{I} + \\nabla \\boldsymbol{u}$ into the definition of $\\boldsymbol{E}$.\n$$\\boldsymbol{E} = \\frac{1}{2}(\\boldsymbol{F}^{\\mathsf{T}}\\boldsymbol{F} - \\boldsymbol{I}) = \\frac{1}{2}((\\boldsymbol{I} + \\nabla \\boldsymbol{u})^{\\mathsf{T}}(\\boldsymbol{I} + \\nabla \\boldsymbol{u}) - \\boldsymbol{I})$$\n$$\\boldsymbol{E} = \\frac{1}{2}((\\boldsymbol{I} + (\\nabla \\boldsymbol{u})^{\\mathsf{T}})(\\boldsymbol{I} + \\nabla \\boldsymbol{u}) - \\boldsymbol{I})$$\n$$\\boldsymbol{E} = \\frac{1}{2}(\\boldsymbol{I} + \\nabla \\boldsymbol{u} + (\\nabla \\boldsymbol{u})^{\\mathsf{T}} + (\\nabla \\boldsymbol{u})^{\\mathsf{T}} \\nabla \\boldsymbol{u} - \\boldsymbol{I})$$\n$$\\boldsymbol{E} = \\frac{1}{2}(\\nabla \\boldsymbol{u} + (\\nabla \\boldsymbol{u})^{\\mathsf{T}}) + \\frac{1}{2}(\\nabla \\boldsymbol{u})^{\\mathsf{T}} \\nabla \\boldsymbol{u}$$\nRecognizing the first term as $\\boldsymbol{\\varepsilon}^{\\text{lin}}$, we have:\n$$\\boldsymbol{E} = \\boldsymbol{\\varepsilon}^{\\text{lin}} + \\frac{1}{2}(\\nabla \\boldsymbol{u})^{\\mathsf{T}} \\nabla \\boldsymbol{u}$$\nThis equation shows that the Green–Lagrange strain tensor consists of a linear part, which is the infinitesimal strain tensor, and a nonlinear (quadratic) part, $\\frac{1}{2}(\\nabla \\boldsymbol{u})^{\\mathsf{T}} \\nabla \\boldsymbol{u}$.\n\nFor the given problem:\n1.  The linear part, $\\boldsymbol{\\varepsilon}^{\\text{lin}}$, is zero. In linearized theory, a zero strain tensor implies a rigid body motion (translation plus rotation). The skew-symmetric displacement gradient represents an infinitesimal rotation, which linearized theory considers strain-free.\n2.  However, the problem specifies that $\\theta$ is a *finite* angle. This means the displacement gradients are not infinitesimally small, and the quadratic term $(\\nabla \\boldsymbol{u})^{\\mathsf{T}} \\nabla \\boldsymbol{u}$ cannot be neglected.\n3.  Let's compute this nonlinear term explicitly:\n$$(\\nabla \\boldsymbol{u})^{\\mathsf{T}} \\nabla \\boldsymbol{u} = \\begin{pmatrix} 0 & -\\theta & 0 \\\\ \\theta & 0 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix} \\begin{pmatrix} 0 & \\theta & 0 \\\\ -\\theta & 0 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix} = \\begin{pmatrix} \\theta^2 & 0 & 0 \\\\ 0 & \\theta^2 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix}$$\n4.  Substituting this into the full expression for $\\boldsymbol{E}$:\n$$\\boldsymbol{E} = \\boldsymbol{0} + \\frac{1}{2} \\begin{pmatrix} \\theta^2 & 0 & 0 \\\\ 0 & \\theta^2 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{2}\\theta^2 & 0 & 0 \\\\ 0 & \\frac{1}{2}\\theta^2 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix}$$\nThis result matches our initial calculation of $\\boldsymbol{E}$.\n\nIn summary, the infinitesimal strain tensor $\\boldsymbol{\\varepsilon}^{\\text{lin}}$ is an approximation valid only when all components of the displacement gradient $\\nabla \\boldsymbol{u}$ are much smaller than $1$. The given displacement field, when $\\theta$ is finite, represents a deformation with large gradients (specifically, large rotational components). The linearized strain tensor incorrectly registers this as a strain-free rigid motion. The Green–Lagrange strain tensor $\\boldsymbol{E}$ is a geometrically exact measure that correctly accounts for nonlinearities arising from finite rotations and displacements. The non-zero components of $\\boldsymbol{E}$ indicate that the given displacement field, contrary to the prediction of linear theory, does induce strain. Specifically, it causes stretching along the $X_1$ and $X_2$ directions, which is captured by the quadratic term in its definition. This highlights a fundamental limitation of linear strain theory in the presence of finite rotations.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{1}{2}\\theta^2 & 0 & 0 \\\\\n0 & \\frac{1}{2}\\theta^2 & 0 \\\\\n0 & 0 & 0\n\\end{pmatrix}\n}\n$$", "id": "3559297"}, {"introduction": "Building on the concept that finite deformations require non-linear strain measures, this exercise provides a direct, quantitative comparison for the case of simple shear. You will derive both the infinitesimal strain tensor ($\\boldsymbol{\\varepsilon}$) and the Green–Lagrange strain tensor ($\\boldsymbol{E}$) for this common deformation mode. Calculating the magnitude of their difference will provide a tangible understanding of how and when non-linear terms become significant [@problem_id:3559282].", "problem": "A homogeneous simple shear is prescribed in the reference configuration by the displacement vector field $\\boldsymbol{u}(\\boldsymbol{X})=\\big(\\gamma\\,X_{2},\\,0,\\,0\\big)$, where $\\boldsymbol{X}=\\big(X_{1},X_{2},X_{3}\\big)$ denotes the material coordinates and $\\gamma$ is a real, finite constant. Starting strictly from the fundamental kinematic definitions of the displacement gradient, the deformation gradient, the infinitesimal strain tensor, and the Green–Lagrange strain tensor, carry out the following:\n\n1. Derive the displacement gradient and the deformation gradient associated with the mapping $\\boldsymbol{x}(\\boldsymbol{X})=\\boldsymbol{X}+\\boldsymbol{u}(\\boldsymbol{X})$.\n2. From these, construct the infinitesimal strain tensor $\\boldsymbol{\\varepsilon}$ and the Green–Lagrange strain tensor $\\boldsymbol{E}$.\n3. To quantify the difference between $\\boldsymbol{\\varepsilon}$ and $\\boldsymbol{E}$ for finite $\\gamma$, define $\\boldsymbol{\\Delta}(\\gamma)=\\boldsymbol{E}-\\boldsymbol{\\varepsilon}$ and report the scalar measure\n$$D(\\gamma)=\\|\\boldsymbol{\\Delta}(\\gamma)\\|_{F},$$\nwhere $\\|\\cdot\\|_{F}$ denotes the Frobenius norm. Provide $D(\\gamma)$ as a closed-form analytic expression in terms of $\\gamma$.\n\nExpress your final answer as a single analytic expression in $\\gamma$. No rounding is required. No units are needed because strain is dimensionless.", "solution": "The user wants me to solve a problem based on the displacement vector field $\\boldsymbol{u}(\\boldsymbol{X})=\\big(\\gamma\\,X_{2},\\,0,\\,0\\big)$, with $\\boldsymbol{X}=\\big(X_{1},X_{2},X_{3}\\big)$ as the material coordinates and $\\gamma$ as a real, finite constant.\n\n### Step 1: Extract Givens\n- Displacement vector field: $\\boldsymbol{u}(\\boldsymbol{X}) = (\\gamma X_2, 0, 0)$\n- Material coordinates: $\\boldsymbol{X} = (X_1, X_2, X_3)$\n- Constant: $\\gamma$ is a real, finite constant.\n- Mapping: $\\boldsymbol{x}(\\boldsymbol{X}) = \\boldsymbol{X} + \\boldsymbol{u}(\\boldsymbol{X})$\n- Tensors to derive:\n  - Displacement gradient, $\\nabla_X \\boldsymbol{u}$\n  - Deformation gradient, $\\boldsymbol{F}$\n  - Infinitesimal strain tensor, $\\boldsymbol{\\varepsilon}$\n  - Green–Lagrange strain tensor, $\\boldsymbol{E}$\n- Derived quantities:\n  - Difference tensor: $\\boldsymbol{\\Delta}(\\gamma) = \\boldsymbol{E} - \\boldsymbol{\\varepsilon}$\n  - Scalar measure: $D(\\gamma)=\\|\\boldsymbol{\\Delta}(\\gamma)\\|_{F}$, where $\\|\\cdot\\|_{F}$ is the Frobenius norm.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically grounded, well-posed, and objective. It is a standard exercise in the kinematics of continuum mechanics, using established definitions for the displacement gradient, deformation gradient, and two common strain tensors (infinitesimal and Green-Lagrange). The problem is self-contained, with all necessary information provided. The mathematical operations are well-defined, and a unique, meaningful solution exists. There are no contradictions, ambiguities, or violations of scientific principles.\n\n### Step 3: Verdict and Action\nThe problem is valid. A complete solution will be provided.\n\n***\n\nThe solution proceeds by systematically computing the required kinematic quantities based on their fundamental definitions in continuum mechanics.\n\nThe displacement vector field is given by $\\boldsymbol{u}(\\boldsymbol{X}) = u_1 \\mathbf{e}_1 + u_2 \\mathbf{e}_2 + u_3 \\mathbf{e}_3$, where the components are:\n$$u_1(\\boldsymbol{X}) = \\gamma X_2$$\n$$u_2(\\boldsymbol{X}) = 0$$\n$$u_3(\\boldsymbol{X}) = 0$$\n\nFirst, we derive the displacement gradient tensor, denoted as $\\nabla_X \\boldsymbol{u}$. Its components are given by $(\\nabla_X \\boldsymbol{u})_{ij} = \\frac{\\partial u_i}{\\partial X_j}$.\nThe non-zero component is:\n$$\\frac{\\partial u_1}{\\partial X_2} = \\gamma$$\nAll other partial derivatives are zero. In matrix form, the displacement gradient tensor is:\n$$\\nabla_X \\boldsymbol{u} = \\begin{pmatrix} \\frac{\\partial u_1}{\\partial X_1} & \\frac{\\partial u_1}{\\partial X_2} & \\frac{\\partial u_1}{\\partial X_3} \\\\ \\frac{\\partial u_2}{\\partial X_1} & \\frac{\\partial u_2}{\\partial X_2} & \\frac{\\partial u_2}{\\partial X_3} \\\\ \\frac{\\partial u_3}{\\partial X_1} & \\frac{\\partial u_3}{\\partial X_2} & \\frac{\\partial u_3}{\\partial X_3} \\end{pmatrix} = \\begin{pmatrix} 0 & \\gamma & 0 \\\\ 0 & 0 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix}$$\n\nNext, we derive the deformation gradient tensor, $\\boldsymbol{F}$. It is defined as $\\boldsymbol{F} = \\boldsymbol{I} + \\nabla_X \\boldsymbol{u}$, where $\\boldsymbol{I}$ is the second-order identity tensor.\n$$\\boldsymbol{F} = \\begin{pmatrix} 1 & 0 & 0 \\\\ 0 & 1 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix} + \\begin{pmatrix} 0 & \\gamma & 0 \\\\ 0 & 0 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix} = \\begin{pmatrix} 1 & \\gamma & 0 \\\\ 0 & 1 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix}$$\n\nNow, we construct the infinitesimal strain tensor, $\\boldsymbol{\\varepsilon}$. It is defined as the symmetric part of the displacement gradient: $\\boldsymbol{\\varepsilon} = \\frac{1}{2}(\\nabla_X \\boldsymbol{u} + (\\nabla_X \\boldsymbol{u})^T)$.\nFirst, we find the transpose of the displacement gradient:\n$$(\\nabla_X \\boldsymbol{u})^T = \\begin{pmatrix} 0 & 0 & 0 \\\\ \\gamma & 0 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix}$$\nThen, we compute $\\boldsymbol{\\varepsilon}$:\n$$\\boldsymbol{\\varepsilon} = \\frac{1}{2}\\left( \\begin{pmatrix} 0 & \\gamma & 0 \\\\ 0 & 0 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix} + \\begin{pmatrix} 0 & 0 & 0 \\\\ \\gamma & 0 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix} \\right) = \\frac{1}{2} \\begin{pmatrix} 0 & \\gamma & 0 \\\\ \\gamma & 0 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix} = \\begin{pmatrix} 0 & \\frac{\\gamma}{2} & 0 \\\\ \\frac{\\gamma}{2} & 0 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix}$$\n\nWe proceed to construct the Green–Lagrange strain tensor, $\\boldsymbol{E}$. It is defined by $\\boldsymbol{E} = \\frac{1}{2}(\\boldsymbol{F}^T \\boldsymbol{F} - \\boldsymbol{I})$.\nFirst, we compute the right Cauchy–Green deformation tensor, $\\boldsymbol{C} = \\boldsymbol{F}^T \\boldsymbol{F}$:\n$$\\boldsymbol{F}^T = \\begin{pmatrix} 1 & 0 & 0 \\\\ \\gamma & 1 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix}$$\n$$\\boldsymbol{C} = \\boldsymbol{F}^T \\boldsymbol{F} = \\begin{pmatrix} 1 & 0 & 0 \\\\ \\gamma & 1 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix} \\begin{pmatrix} 1 & \\gamma & 0 \\\\ 0 & 1 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix} = \\begin{pmatrix} 1 & \\gamma & 0 \\\\ \\gamma & \\gamma^2 + 1 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix}$$\nNow, we can find $\\boldsymbol{E}$:\n$$\\boldsymbol{E} = \\frac{1}{2}(\\boldsymbol{C} - \\boldsymbol{I}) = \\frac{1}{2}\\left( \\begin{pmatrix} 1 & \\gamma & 0 \\\\ \\gamma & \\gamma^2 + 1 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix} - \\begin{pmatrix} 1 & 0 & 0 \\\\ 0 & 1 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix} \\right) = \\frac{1}{2} \\begin{pmatrix} 0 & \\gamma & 0 \\\\ \\gamma & \\gamma^2 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix} = \\begin{pmatrix} 0 & \\frac{\\gamma}{2} & 0 \\\\ \\frac{\\gamma}{2} & \\frac{\\gamma^2}{2} & 0 \\\\ 0 & 0 & 0 \\end{pmatrix}$$\nAlternatively, one could use the relationship $\\boldsymbol{E} = \\frac{1}{2}(\\nabla_X \\boldsymbol{u} + (\\nabla_X \\boldsymbol{u})^T + (\\nabla_X \\boldsymbol{u})^T \\nabla_X \\boldsymbol{u}) = \\boldsymbol{\\varepsilon} + \\frac{1}{2}(\\nabla_X \\boldsymbol{u})^T \\nabla_X \\boldsymbol{u}$.\n\nThe third part of the problem requires us to quantify the difference between $\\boldsymbol{E}$ and $\\boldsymbol{\\varepsilon}$. We define the difference tensor $\\boldsymbol{\\Delta}(\\gamma) = \\boldsymbol{E} - \\boldsymbol{\\varepsilon}$.\n$$\\boldsymbol{\\Delta}(\\gamma) = \\begin{pmatrix} 0 & \\frac{\\gamma}{2} & 0 \\\\ \\frac{\\gamma}{2} & \\frac{\\gamma^2}{2} & 0 \\\\ 0 & 0 & 0 \\end{pmatrix} - \\begin{pmatrix} 0 & \\frac{\\gamma}{2} & 0 \\\\ \\frac{\\gamma}{2} & 0 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix} = \\begin{pmatrix} 0 & 0 & 0 \\\\ 0 & \\frac{\\gamma^2}{2} & 0 \\\\ 0 & 0 & 0 \\end{pmatrix}$$\nThis difference tensor, $\\boldsymbol{\\Delta}(\\gamma) = \\frac{1}{2}(\\nabla_X \\boldsymbol{u})^T \\nabla_X \\boldsymbol{u}$, represents the purely nonlinear contribution to the Green-Lagrange strain tensor.\n\nFinally, we compute the scalar measure $D(\\gamma)$, which is the Frobenius norm of $\\boldsymbol{\\Delta}(\\gamma)$. The Frobenius norm of a matrix $A$ is given by $\\|A\\|_F = \\sqrt{\\sum_{i,j} |A_{ij}|^2}$.\nFor the tensor $\\boldsymbol{\\Delta}(\\gamma)$, all components are zero except for $\\Delta_{22} = \\frac{\\gamma^2}{2}$.\nTherefore, the Frobenius norm is:\n$$D(\\gamma) = \\|\\boldsymbol{\\Delta}(\\gamma)\\|_F = \\sqrt{0^2 + 0^2 + 0^2 + 0^2 + \\left(\\frac{\\gamma^2}{2}\\right)^2 + 0^2 + 0^2 + 0^2 + 0^2}$$\n$$D(\\gamma) = \\sqrt{\\left(\\frac{\\gamma^2}{2}\\right)^2} = \\sqrt{\\frac{\\gamma^4}{4}}$$\nSince $\\gamma$ is a real number, $\\gamma^2$ is non-negative. Thus, we can take the positive square root:\n$$D(\\gamma) = \\frac{\\gamma^2}{2}$$\nThis expression quantifies the magnitude of the difference between the Green-Lagrange and infinitesimal strain tensors for this specific finite shear deformation.", "answer": "$$\\boxed{\\frac{\\gamma^2}{2}}$$", "id": "3559282"}, {"introduction": "The ultimate test of theoretical understanding in computational mechanics is its successful implementation in code. This practice challenges you to perform a \"patch test,\" a cornerstone of finite element verification, to ensure your model behaves correctly. By applying boundary conditions derived from an exact linear displacement field, you will verify that your implementation of bilinear elements can reproduce a constant strain state to machine precision, a fundamental check for any valid simulation code [@problem_id:3559279].", "problem": "You must design, justify, and implement a two-dimensional patch test that verifies the exact reproduction of a linear displacement vector field by bilinear quadrilateral elements, commonly denoted as $Q_{1}$, on a structured mesh in the context of small-strain linear elasticity. The starting point must be the Principle of Virtual Work, the definition of the symmetric small-strain tensor, and the linear elastic Cauchy stress-strain relations for plane stress and plane strain. Your task is to construct a computational experiment in which the finite element discretization must reproduce the exact linear displacement field to machine precision when the boundary tractions are derived consistently from the exact stress field and the rigid-body modes are minimally constrained.\n\nThe problem setup is as follows. Consider a rectangular domain $\\Omega = [0,L_{x}] \\times [0,L_{y}]$, discretized by a structured mesh of $Q_{1}$ bilinear quadrilateral elements. The unknown is the displacement vector field $\\boldsymbol{u}(x,y) = [u(x,y), v(x,y)]^{\\mathsf{T}}$. Assume small strains with the symmetric strain definition $\\boldsymbol{\\varepsilon} = \\tfrac{1}{2}\\left(\\nabla \\boldsymbol{u} + \\nabla \\boldsymbol{u}^{\\mathsf{T}}\\right)$, unit thickness, no body forces, and boundary tractions $\\boldsymbol{t} = \\boldsymbol{\\sigma}\\boldsymbol{n}$ prescribed on $\\partial \\Omega$, where $\\boldsymbol{n}$ is the outward unit normal and $\\boldsymbol{\\sigma}$ is the Cauchy stress. For constitutive behavior, use linear elasticity: the Cauchy stress $\\boldsymbol{\\sigma}$ is related to $\\boldsymbol{\\varepsilon}$ by the appropriate linear elastic law for either plane strain or plane stress. All material constants must be in International System of Units (SI units): Young’s modulus $E$ in pascal and Poisson’s ratio $\\nu$ dimensionless.\n\nYour finite element discretization must be based solely on:\n- The Principle of Virtual Work for small-strain linear elasticity.\n- The definition of the symmetric strain tensor.\n- The linear elastic Cauchy stress-strain relation (Hooke’s law) for plane strain and plane stress.\n- Exact numerical integration using Gauss quadrature sufficient to integrate all polynomials that appear.\n\nYou must verify the exact reproduction of a linear displacement field of the form\n$\\displaystyle u(x,y) = a_{0} + a_{1}\\,x + a_{2}\\,y,\\quad v(x,y) = b_{0} + b_{1}\\,x + b_{2}\\,y,$\nwith constants $a_{0},a_{1},a_{2},b_{0},b_{1},b_{2}$. The symmetric strain is constant in $\\Omega$ for this field, hence the stress is constant when computed from Hooke’s law. Use this constant stress to define the boundary traction $\\boldsymbol{t}=\\boldsymbol{\\sigma}\\boldsymbol{n}$ on every portion of $\\partial \\Omega$. Remove the rigid-body modes by prescribing the exact displacement at the node at $(x,y)=(0,0)$ for both components and prescribing the exact vertical displacement at the node at $(x,y)=(L_{x},0)$. No other displacement boundary conditions are allowed. All other boundaries must be traction boundaries consistent with $\\boldsymbol{t}=\\boldsymbol{\\sigma}\\boldsymbol{n}$. Assume unit thickness $t=1$.\n\nImplementation requirements:\n- Assemble the global stiffness matrix using $Q_{1}$ elements, with the symmetric small-strain-displacement matrix and exact Gauss quadrature on each element (use a $2\\times 2$ Gauss rule for the interior and a $2$-point Gauss rule on each boundary edge).\n- Assemble the consistent global traction force vector by integrating $\\boldsymbol{N}^{\\mathsf{T}}\\boldsymbol{t}$ along boundary edges, where $\\boldsymbol{N}$ is the $Q_{1}$ shape function matrix for the edge.\n- Impose the displacement constraints by direct elimination in the linear system (row and column modification) in a way that preserves symmetry.\n- Solve the linear system to obtain the nodal displacement vector and compute the nodal exact displacement from the prescribed linear field.\n- Compute the maximum absolute nodal displacement error $\\max_{i}\\lvert U_{i}^{\\text{num}} - U_{i}^{\\text{exact}}\\rvert$ over all displacement components. This error must be reported in meters.\n\nTest suite:\nEvaluate the maximum absolute nodal displacement error for each of the following four cases. All lengths are in meters and Young’s modulus is in pascal. The angle unit is not applicable.\n\n- Case $1$ (happy path, single element, plane strain):\n  - $N_{x}=1$, $N_{y}=1$, $L_{x}=1.0$, $L_{y}=1.0$, $E=1.00\\times 10^{3}$, $\\nu=0.30$, plane strain.\n  - Coefficients: $a_{0}=0.10$, $a_{1}=0.20$, $a_{2}=-0.30$, $b_{0}=-0.05$, $b_{1}=0.40$, $b_{2}=0.25$.\n\n- Case $2$ (rectangular mesh, plane stress):\n  - $N_{x}=2$, $N_{y}=3$, $L_{x}=2.0$, $L_{y}=1.0$, $E=2.10\\times 10^{5}$, $\\nu=0.29$, plane stress.\n  - Coefficients: $a_{0}=-0.02$, $a_{1}=0.15$, $a_{2}=0.05$, $b_{0}=0.03$, $b_{1}=-0.10$, $b_{2}=0.12$.\n\n- Case $3$ (high aspect ratio elements, plane strain):\n  - $N_{x}=4$, $N_{y}=1$, $L_{x}=8.0$, $L_{y}=1.0$, $E=7.00\\times 10^{4}$, $\\nu=0.33$, plane strain.\n  - Coefficients: $a_{0}=0.00$, $a_{1}=0.05$, $a_{2}=1.50$, $b_{0}=0.01$, $b_{1}=-1.20$, $b_{2}=0.02$.\n\n- Case $4$ (moderate mesh, plane stress):\n  - $N_{x}=3$, $N_{y}=3$, $L_{x}=1.5$, $L_{y}=1.5$, $E=3.00\\times 10^{5}$, $\\nu=0.25$, plane stress.\n  - Coefficients: $a_{0}=0.005$, $a_{1}=-0.08$, $a_{2}=0.06$, $b_{0}=-0.01$, $b_{1}=0.07$, $b_{2}=-0.09$.\n\nFinal output specification:\n- Your program must compute, for each of the four cases, the maximum absolute nodal displacement error in meters, expressed as a floating-point number.\n- Your program must produce a single line of output containing the results as a comma-separated list enclosed in square brackets, for example, $[r_{1},r_{2},r_{3},r_{4}]$, where $r_{k}$ is the result for case $k$.", "solution": "The problem posed is a classical verification procedure in computational solid mechanics known as the patch test. Its purpose is to verify that a finite element formulation can exactly reproduce a state of constant strain. For the displacement-based finite element method, this is a necessary condition for convergence. The problem is well-posed, scientifically sound, and provides all necessary information to construct a valid computational experiment. We shall proceed with the solution.\n\n### 1. Theoretical Foundation: The Principle of Virtual Work\n\nThe foundation for the finite element model is the Principle of Virtual Work (PVW), which represents the weak form of the mechanical equilibrium equations. For a body occupying a domain $\\Omega$ with boundary $\\partial\\Omega$, subjected to body forces $\\boldsymbol{f}$ and surface tractions $\\boldsymbol{t}$ on the boundary portion $\\partial\\Omega_t$, the PVW states that the internal virtual work must equal the external virtual work for any kinematically admissible virtual displacement field $\\delta\\boldsymbol{u}$:\n$$\n\\int_{\\Omega} \\boldsymbol{\\sigma} : \\delta\\boldsymbol{\\varepsilon} \\, dV = \\int_{\\Omega} \\boldsymbol{f} \\cdot \\delta\\boldsymbol{u} \\, dV + \\int_{\\partial\\Omega_t} \\boldsymbol{t} \\cdot \\delta\\boldsymbol{u} \\, dS\n$$\nHere, $\\boldsymbol{\\sigma}$ is the Cauchy stress tensor and $\\delta\\boldsymbol{\\varepsilon}$ is the virtual strain tensor, defined as the symmetric part of the gradient of the virtual displacement, $\\delta\\boldsymbol{\\varepsilon} = \\tfrac{1}{2}(\\nabla(\\delta\\boldsymbol{u}) + (\\nabla(\\delta\\boldsymbol{u}))^{\\mathsf{T}})$. The problem specifies no body forces ($\\boldsymbol{f}=\\boldsymbol{0}$) and unit thickness, so the volume and surface integrals simplify to area and line integrals, respectively:\n$$\n\\int_{\\Omega} \\boldsymbol{\\sigma} : \\delta\\boldsymbol{\\varepsilon} \\, dA = \\int_{\\partial\\Omega_t} \\boldsymbol{t} \\cdot \\delta\\boldsymbol{u} \\, dL\n$$\n\n### 2. Finite Element Discretization\n\nWe discretize the domain $\\Omega$ into a mesh of non-overlapping bilinear quadrilateral elements ($Q_1$). Within each element $e$, the displacement field $\\boldsymbol{u}(\\boldsymbol{x})$ is approximated by interpolating nodal displacements $\\boldsymbol{d}^e$ using shape functions $\\boldsymbol{N}(\\boldsymbol{x})$:\n$$\n\\boldsymbol{u}(\\boldsymbol{x}) \\approx \\boldsymbol{u}^h(\\boldsymbol{x}) = \\boldsymbol{N}(\\boldsymbol{x}) \\boldsymbol{d}^e\n$$\nFor a $Q_1$ element with four nodes, the matrices are structured as:\n$$\n\\boldsymbol{N} = \\begin{bmatrix} N_1 & 0 & N_2 & 0 & N_3 & 0 & N_4 & 0 \\\\ 0 & N_1 & 0 & N_2 & 0 & N_3 & 0 & N_4 \\end{bmatrix}, \\quad \\boldsymbol{d}^e = [u_1, v_1, u_2, v_2, u_3, v_3, u_4, v_4]^{\\mathsf{T}}\n$$\nwhere $N_i(\\xi, \\eta) = \\frac{1}{4}(1+\\xi_i \\xi)(1+\\eta_i \\eta)$ are the bilinear shape functions on the parent element domain $[-1, 1] \\times [-1, 1]$.\n\nThe small-strain tensor $\\boldsymbol{\\varepsilon} = [\\varepsilon_{xx}, \\varepsilon_{yy}, \\gamma_{xy}]^{\\mathsf{T}}$ (using engineering shear strain $\\gamma_{xy} = 2\\varepsilon_{xy}$) is related to nodal displacements via the strain-displacement matrix $\\boldsymbol{B}$:\n$$\n\\boldsymbol{\\varepsilon}^h = \\boldsymbol{B} \\boldsymbol{d}^e, \\quad \\text{where} \\quad \\boldsymbol{B}_i = \\begin{bmatrix} \\partial N_i/\\partial x & 0 \\\\ 0 & \\partial N_i/\\partial y \\\\ \\partial N_i/\\partial y & \\partial N_i/\\partial x \\end{bmatrix} \\quad \\text{and} \\quad \\boldsymbol{B} = [\\boldsymbol{B}_1, \\boldsymbol{B}_2, \\boldsymbol{B}_3, \\boldsymbol{B}_4]\n$$\nThe derivatives with respect to physical coordinates $(x,y)$ are found using the chain rule and the Jacobian of the isoparametric map: $\\left\\{\\partial N_i/\\partial x, \\partial N_i/\\partial y\\right\\}^{\\mathsf{T}} = \\boldsymbol{J}^{-1} \\left\\{\\partial N_i/\\partial \\xi, \\partial N_i/\\partial \\eta\\right\\}^{\\mathsf{T}}$. For the specified structured rectangular mesh, the Jacobian $\\boldsymbol{J}$ is constant within each element.\n\nThe constitutive relation is Hooke's Law, $\\boldsymbol{\\sigma} = \\boldsymbol{D}\\boldsymbol{\\varepsilon}$, where $\\boldsymbol{D}$ is the material elasticity matrix. For **plane strain**:\n$$\n\\boldsymbol{D}_{\\text{strain}} = \\frac{E}{(1+\\nu)(1-2\\nu)} \\begin{bmatrix} 1-\\nu & \\nu & 0 \\\\ \\nu & 1-\\nu & 0 \\\\ 0 & 0 & \\frac{1-2\\nu}{2} \\end{bmatrix}\n$$\nAnd for **plane stress**:\n$$\n\\boldsymbol{D}_{\\text{stress}} = \\frac{E}{1-\\nu^2} \\begin{bmatrix} 1 & \\nu & 0 \\\\ \\nu & 1 & 0 \\\\ 0 & 0 & \\frac{1-\\nu}{2} \\end{bmatrix}\n$$\nSubstituting the finite element approximations into the PVW and noting it holds for arbitrary virtual displacements $\\delta\\boldsymbol{d}$, we obtain the discretized system $\\boldsymbol{K}\\boldsymbol{U} = \\boldsymbol{F}$, where $\\boldsymbol{U}$ is the global vector of nodal displacements. The element stiffness matrix $\\boldsymbol{k}^e$ and global stiffness matrix $\\boldsymbol{K}$ are assembled from:\n$$\n\\boldsymbol{k}^e = \\int_{\\Omega_e} \\boldsymbol{B}^{\\mathsf{T}} \\boldsymbol{D} \\boldsymbol{B} \\, t \\, dA\n$$\nThe problem specifies unit thickness $t=1$. The integral is computed numerically using a $2 \\times 2$ Gauss quadrature rule, which is sufficient to exactly integrate the resulting polynomial integrand for rectangular elements.\n\n### 3. Patch Test Setup\n\nThe essence of the patch test is to apply boundary conditions derived from a known exact solution that the element should be able to reproduce. Here, the target is a linear displacement field:\n$$\nu(x,y) = a_0 + a_1 x + a_2 y \\quad , \\quad v(x,y) = b_0 + b_1 x + b_2 y\n$$\nThis field yields a constant strain state throughout the domain $\\Omega$:\n$$\n\\boldsymbol{\\varepsilon}_{\\text{exact}} = \\begin{Bmatrix} \\varepsilon_{xx} \\\\ \\varepsilon_{yy} \\\\ \\gamma_{xy} \\end{Bmatrix} = \\begin{Bmatrix} \\partial u / \\partial x \\\\ \\partial v / \\partial y \\\\ \\partial u / \\partial y + \\partial v / \\partial x \\end{Bmatrix} = \\begin{Bmatrix} a_1 \\\\ b_2 \\\\ a_2 + b_1 \\end{Bmatrix}\n$$\nThe corresponding Cauchy stress, $\\boldsymbol{\\sigma}_{\\text{exact}} = \\boldsymbol{D} \\boldsymbol{\\varepsilon}_{\\text{exact}}$, is also constant. This constant stress is used to define the tractions $\\boldsymbol{t} = \\boldsymbol{\\sigma}_{\\text{exact}} \\boldsymbol{n}$ on the entire boundary $\\partial\\Omega$, where $\\boldsymbol{n}$ is the outward unit normal.\n\nThe external force vector $\\boldsymbol{F}$ is assembled from consistent nodal forces derived from these tractions. For a boundary edge, the elemental force vector is:\n$$\n\\boldsymbol{f}^e_{\\text{ext}} = \\int_{\\text{edge}} \\boldsymbol{N}^{\\mathsf{T}} \\boldsymbol{t} \\, t \\, dL\n$$\nThis integral is computed using a $2$-point Gauss rule along each boundary edge. For a constant traction $\\boldsymbol{t}$ on a straight edge of length $L_{edge}$, this integral distributes the total force $\\boldsymbol{t} L_{edge}$ equally to the two nodes of the edge.\n\n### 4. System Solution and Verification\n\nThe global system $\\boldsymbol{K}\\boldsymbol{U}=\\boldsymbol{F}$ is singular because the traction-only boundary conditions do not preclude rigid-body motion (two translations and one rotation in 2D). To obtain a unique solution, we must impose minimal displacement boundary conditions. The problem specifies:\n1. $u(0,0) = a_0$\n2. $v(0,0) = b_0$\n3. $v(L_x,0) = b_0 + b_1 L_x$\n\nThese three constraints are sufficient to remove the three rigid-body modes. They are imposed on the linear system using a direct elimination method that preserves the symmetry of the stiffness matrix. This involves modifying the rows and columns of $\\boldsymbol{K}$ corresponding to the constrained degrees of freedom (DOFs) and adjusting the force vector $\\boldsymbol{F}$ accordingly. For a prescribed DOF $U_k = d$:\n1. For all free DOFs $i$, update the force component: $F_i \\leftarrow F_i - K_{ik} d$.\n2. Set row $k$ and column $k$ of the matrix to zero, i.e., $K_{ik} = K_{ki} = 0$ for $i \\neq k$.\n3. Set the diagonal entry to unity: $K_{kk} \\leftarrow 1$.\n4. Set the force component to the prescribed value: $F_k \\leftarrow d$.\n\nAfter solving the modified system for the numerical nodal displacements $\\boldsymbol{U}_{\\text{num}}$, we compare them against the exact nodal displacements $\\boldsymbol{U}_{\\text{exact}}$, computed by evaluating the linear displacement field at each node's coordinates. The verification is successful if the maximum absolute error is on the order of machine precision:\n$$\n\\text{Error} = \\max_{i} | (U_{\\text{num}})_i - (U_{\\text{exact}})_i | \\approx 0\n$$\n\nThis procedure is systematically applied to the four test cases provided.", "answer": "```python\nimport numpy as np\n\ndef get_constitutive_matrix(E, nu, case_type):\n    \"\"\"\n    Constructs the 2D linear elastic constitutive matrix D.\n    \n    Args:\n        E (float): Young's modulus.\n        nu (float): Poisson's ratio.\n        case_type (str): 'plane_strain' or 'plane_stress'.\n\n    Returns:\n        np.ndarray: The 3x3 constitutive matrix.\n    \"\"\"\n    if case_type == 'plane_strain':\n        factor = E / ((1 + nu) * (1 - 2 * nu))\n        D = factor * np.array([\n            [1 - nu, nu, 0],\n            [nu, 1 - nu, 0],\n            [0, 0, (1 - 2 * nu) / 2]\n        ])\n    elif case_type == 'plane_stress':\n        factor = E / (1 - nu**2)\n        D = factor * np.array([\n            [1, nu, 0],\n            [nu, 1, 0],\n            [0, 0, (1 - nu) / 2]\n        ])\n    else:\n        raise ValueError(\"Invalid case_type. Must be 'plane_strain' or 'plane_stress'.\")\n    return D\n\ndef get_shape_func_derivs_parent(xi, eta):\n    \"\"\"\n    Computes derivatives of Q1 shape functions with respect to parent coordinates.\n    Node ordering is counter-clockwise from bottom-left: (-1,-1), (1,-1), (1,1), (-1,1).\n    \"\"\"\n    dN_dxi = 0.25 * np.array([-(1 - eta), (1 - eta), (1 + eta), -(1 + eta)])\n    dN_deta = 0.25 * np.array([-(1 - xi), -(1 + xi), (1 + xi), (1 - xi)])\n    return dN_dxi, dN_deta\n\ndef solve_patch_test_case(params):\n    \"\"\"\n    Runs a single patch test case.\n    \"\"\"\n    Nx, Ny, Lx, Ly, E, nu, case_type, coeffs = params\n    a0, a1, a2, b0, b1, b2 = coeffs\n\n    # 1. Mesh Generation\n    num_nodes_x = Nx + 1\n    num_nodes_y = Ny + 1\n    num_nodes = num_nodes_x * num_nodes_y\n    num_elements = Nx * Ny\n    \n    nodes = np.zeros((num_nodes, 2))\n    for j in range(num_nodes_y):\n        for i in range(num_nodes_x):\n            node_idx = j * num_nodes_x + i\n            nodes[node_idx] = [i * Lx / Nx, j * Ly / Ny]\n\n    elements = np.zeros((num_elements, 4), dtype=int)\n    for j in range(Ny):\n        for i in range(Nx):\n            el_idx = j * Nx + i\n            n1 = j * num_nodes_x + i        # bottom-left\n            n2 = j * num_nodes_x + i + 1    # bottom-right\n            n3 = (j + 1) * num_nodes_x + i + 1  # top-right\n            n4 = (j + 1) * num_nodes_x + i      # top-left\n            elements[el_idx] = [n1, n2, n3, n4]\n\n    # 2. Exact Solution & Material Properties\n    eps_exact = np.array([a1, b2, a2 + b1]) # [exx, eyy, gxy]\n    D = get_constitutive_matrix(E, nu, case_type)\n    sigma_exact = D @ eps_exact\n\n    # 3. Assembly of Global Stiffness Matrix K\n    num_dofs = 2 * num_nodes\n    K = np.zeros((num_dofs, num_dofs))\n    \n    gp_loc = 1.0 / np.sqrt(3)\n    gauss_points = [(-gp_loc, -gp_loc), (gp_loc, -gp_loc), (gp_loc, gp_loc), (-gp_loc, gp_loc)]\n    gauss_weights = [1.0, 1.0, 1.0, 1.0]\n\n    hx, hy = Lx / Nx, Ly / Ny\n    \n    # Pre-calculate for rectangular elements\n    J = np.array([[hx / 2, 0], [0, hy / 2]])\n    detJ = np.linalg.det(J)\n    invJ = np.linalg.inv(J)\n\n    for el_nodes_indices in elements:\n        ke = np.zeros((8, 8))\n        for gp, w in zip(gauss_points, gauss_weights):\n            xi, eta = gp\n            dN_dxi, dN_deta = get_shape_func_derivs_parent(xi, eta)\n            \n            dN_dx_dy = invJ @ np.vstack((dN_dxi, dN_deta))\n            dN_dx = dN_dx_dy[0, :]\n            dN_dy = dN_dx_dy[1, :]\n\n            B = np.zeros((3, 8))\n            B[0, 0::2] = dN_dx\n            B[1, 1::2] = dN_dy\n            B[2, 0::2] = dN_dy\n            B[2, 1::2] = dN_dx\n            \n            ke += B.T @ D @ B * detJ * w\n        \n        dof_indices = np.ravel([[2 * n, 2 * n + 1] for n in el_nodes_indices])\n        K[np.ix_(dof_indices, dof_indices)] += ke\n\n    # 4. Assembly of Global Force Vector F\n    F = np.zeros(num_dofs)\n    boundary_edges = {\n        'bottom': [(j * num_nodes_x + i, j * num_nodes_x + i + 1) for j in range(Ny) for i in range(Nx) if j == 0],\n        'right': [(j * num_nodes_x + i + 1, (j + 1) * num_nodes_x + i + 1) for j in range(Ny) for i in range(Nx) if i == Nx - 1],\n        'top': [((j + 1) * num_nodes_x + i, (j + 1) * num_nodes_x + i + 1) for j in range(Ny) for i in range(Nx) if j == Ny - 1],\n        'left': [(j * num_nodes_x + i, (j + 1) * num_nodes_x + i) for j in range(Ny) for i in range(Nx) if i == 0]\n    }\n    # Correct order for outward normal\n    boundary_edges['top'] = [(n2, n1) for n1, n2 in boundary_edges['top']]\n    boundary_edges['left'] = [(n2, n1) for n1, n2 in boundary_edges['left']]\n\n    normals = {'bottom': np.array([0, -1]),'right': np.array([1, 0]),'top': np.array([0, 1]),'left': np.array([-1, 0])}\n    edge_lengths = {'bottom': hx, 'top': hx, 'left': hy, 'right': hy}\n\n    for side, edges in boundary_edges.items():\n        if not edges: continue\n        traction = np.array([sigma_exact[0]*normals[side][0] + sigma_exact[2]*normals[side][1],\n                             sigma_exact[2]*normals[side][0] + sigma_exact[1]*normals[side][1]])\n        force_per_node = traction * edge_lengths[side] / 2.0\n        for n1, n2 in edges:\n            F[2 * n1:2 * n1 + 2] += force_per_node\n            F[2 * n2:2 * n2 + 2] += force_per_node\n\n    # 5. Apply Displacement Boundary Conditions\n    node_0_idx = 0\n    node_Lx0_idx = Nx\n    \n    u0 = a0 + a1 * nodes[node_0_idx, 0] + a2 * nodes[node_0_idx, 1]\n    v0 = b0 + b1 * nodes[node_0_idx, 0] + b2 * nodes[node_0_idx, 1]\n    vLx0 = b0 + b1 * nodes[node_Lx0_idx, 0] + b2 * nodes[node_Lx0_idx, 1]\n\n    prescribed_dofs = {\n        2 * node_0_idx: u0,            # u(0,0)\n        2 * node_0_idx + 1: v0,        # v(0,0)\n        2 * node_Lx0_idx + 1: vLx0     # v(Lx,0)\n    }\n    \n    free_dofs = np.setdiff1d(np.arange(num_dofs), list(prescribed_dofs.keys()))\n    \n    for dof, val in prescribed_dofs.items():\n        F[free_dofs] -= K[free_dofs, dof] * val\n    \n    for dof, val in prescribed_dofs.items():\n        K[dof, :] = 0\n        K[:, dof] = 0\n        K[dof, dof] = 1\n        F[dof] = val\n\n    # 6. Solve and Compute Error\n    U_num = np.linalg.solve(K, F)\n    \n    U_exact = np.zeros(num_dofs)\n    for i in range(num_nodes):\n        x, y = nodes[i, 0], nodes[i, 1]\n        U_exact[2 * i] = a0 + a1 * x + a2 * y\n        U_exact[2 * i + 1] = b0 + b1 * x + b2 * y\n        \n    error = np.max(np.abs(U_num - U_exact))\n    return error\n\ndef solve():\n    \"\"\"\n    Main function to run all test cases and print results.\n    \"\"\"\n    test_cases = [\n        # Case 1\n        {'Nx': 1, 'Ny': 1, 'Lx': 1.0, 'Ly': 1.0, 'E': 1.00e3, 'nu': 0.30, 'type': 'plane_strain', \n         'coeffs': (0.10, 0.20, -0.30, -0.05, 0.40, 0.25)},\n        # Case 2\n        {'Nx': 2, 'Ny': 3, 'Lx': 2.0, 'Ly': 1.0, 'E': 2.10e5, 'nu': 0.29, 'type': 'plane_stress',\n         'coeffs': (-0.02, 0.15, 0.05, 0.03, -0.10, 0.12)},\n        # Case 3\n        {'Nx': 4, 'Ny': 1, 'Lx': 8.0, 'Ly': 1.0, 'E': 7.00e4, 'nu': 0.33, 'type': 'plane_strain',\n         'coeffs': (0.00, 0.05, 1.50, 0.01, -1.20, 0.02)},\n        # Case 4\n        {'Nx': 3, 'Ny': 3, 'Lx': 1.5, 'Ly': 1.5, 'E': 3.00e5, 'nu': 0.25, 'type': 'plane_stress',\n         'coeffs': (0.005, -0.08, 0.06, -0.01, 0.07, -0.09)}\n    ]\n    \n    results = []\n    for case in test_cases:\n        params = (case['Nx'], case['Ny'], case['Lx'], case['Ly'], case['E'], case['nu'], case['type'], case['coeffs'])\n        result = solve_patch_test_case(params)\n        results.append(result)\n\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == '__main__':\n    solve()\n```", "id": "3559279"}]}