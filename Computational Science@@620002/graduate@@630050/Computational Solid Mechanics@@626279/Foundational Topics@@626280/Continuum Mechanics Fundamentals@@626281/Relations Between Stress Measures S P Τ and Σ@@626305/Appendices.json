{"hands_on_practices": [{"introduction": "To build a solid foundation, we begin with a direct application of the stress transformation laws. This first practice provides a concrete numerical exercise to solidify your understanding of the relationships between the Cauchy ($\\sigma$), Kirchhoff ($\\tau$), first Piola-Kirchhoff ($P$), and second Piola-Kirchhoff ($S$) stress tensors. By working with a simple diagonal deformation gradient, you can focus on the mechanics of the push-forward and pull-back operations and confirm their consistency without the distraction of complex matrix algebra [@problem_id:3594819].", "problem": "A homogeneous, isochoric deformation is characterized by the deformation gradient $F=\\operatorname{diag}(2,\\,1/2,\\,1)$. In the current configuration, the Cauchy stress is given by the symmetric tensor $\\sigma=\\begin{bmatrix}1&0&0\\\\0&2&0\\\\0&0&3\\end{bmatrix}$. Starting from first principles—namely, the balance of tractions between configurations, the definition of traction vectors via the Cauchy and first Piola–Kirchhoff stresses, and Nanson’s formula—derive the mappings that relate the Cauchy stress $\\sigma$, the Kirchhoff stress $\\tau$, the first Piola–Kirchhoff stress $P$, and the second Piola–Kirchhoff stress $S$. Then, using these mappings, compute $P$, $\\tau$, and $S$ for the given $F$ and $\\sigma$, and verify the identity $\\tau = F S F^{T}$. Assume there are no couple stresses, so the Cauchy stress is symmetric, and that all fields are smooth enough for the required transformations.\n\nProvide your final answer as a single row matrix containing the diagonal entries of $P$, $\\tau$, and $S$ in that order, i.e., $(P_{11},\\,P_{22},\\,P_{33},\\,\\tau_{11},\\,\\tau_{22},\\,\\tau_{33},\\,S_{11},\\,S_{22},\\,S_{33})$. No rounding is required. Express all quantities without units.", "solution": "The problem statement is rigorously grounded in the principles of continuum mechanics, provides a self-contained and consistent set of data, and is mathematically well-posed. The deformation is specified as homogeneous and isochoric, with the deformation gradient $F=\\operatorname{diag}(2, \\frac{1}{2}, 1)$. The isochoric condition is verified by computing the determinant of $F$, $J = \\det(F) = 2 \\times \\frac{1}{2} \\times 1 = 1$. The Cauchy stress tensor $\\sigma$ is provided as a symmetric tensor, consistent with the assumption of no couple stresses. All required information is present to derive the requested stress measures and verify the given identity. Thus, the problem is valid, and we may proceed with the solution.\n\nThe primary task is to derive the relationships between the Cauchy stress $\\sigma$, the Kirchhoff stress $\\tau$, the first Piola–Kirchhoff stress $P$, and the second Piola–Kirchhoff stress $S$.\n\nLet an infinitesimal force vector $d\\mathbf{f}$ act on an area element $d\\mathbf{a} = \\mathbf{n}\\,da$ in the current (deformed) configuration, where $\\mathbf{n}$ is the unit normal vector and $da$ is the elemental area. The Cauchy stress tensor $\\sigma$ relates the force and the area element by the relation:\n$$d\\mathbf{f} = \\sigma \\mathbf{n} \\, da$$\n\nIn the reference (undeformed) configuration, the corresponding area element is $d\\mathbf{A} = \\mathbf{N}\\,dA$. The first Piola–Kirchhoff stress tensor $P$ is defined such that it relates the same force vector $d\\mathbf{f}$ to this reference area element:\n$$d\\mathbf{f} = P \\mathbf{N} \\, dA$$\n\nEquating these two expressions for the force gives the fundamental balance equation:\n$$\\sigma \\mathbf{n} \\, da = P \\mathbf{N} \\, dA$$\n\nThe relationship between the area elements in the current and reference configurations is given by Nanson's formula:\n$$\\mathbf{n} \\, da = J F^{-T} \\mathbf{N} \\, dA$$\nwhere $J = \\det(F)$ is the Jacobian of the deformation, and $F$ is the deformation gradient.\n\nSubstituting Nanson's formula into the force balance equation yields:\n$$\\sigma (J F^{-T} \\mathbf{N} \\, dA) = P \\mathbf{N} \\, dA$$\n$$J (\\sigma F^{-T}) \\mathbf{N} \\, dA = (P \\mathbf{N}) \\, dA$$\nSince this equality must hold for any arbitrary area element $d\\mathbf{A}$ (and thus any normal $\\mathbf{N}$), we can deduce the tensor relationship:\n$$P = J \\sigma F^{-T}$$\nThis is the mapping from the Cauchy stress $\\sigma$ to the first Piola–Kirchhoff stress $P$.\n\nThe Kirchhoff stress $\\tau$ is defined as a scaled version of the Cauchy stress:\n$$\\tau = J \\sigma$$\nThis definition is motivated by considerations of work and power, ensuring that the work rate per unit reference volume is given by $\\tau:d$, where $d$ is the rate of deformation tensor.\n\nThe second Piola–Kirchhoff stress $S$ is a symmetric tensor that is work-conjugate to the Green–Lagrange strain tensor $E$. It is related to the first Piola–Kirchhoff stress $P$ through a pull-back operation involving the deformation gradient $F$:\n$$P = F S$$\nThis relation can be considered the definition of $S$ in terms of $P$. From this, we can express $S$ as:\n$$S = F^{-1} P$$\nBy substituting the expression for $P$ in terms of $\\sigma$, we obtain the mapping from $\\sigma$ to $S$:\n$$S = F^{-1} (J \\sigma F^{-T}) = J F^{-1} \\sigma F^{-T}$$\n\nNow, we compute the specific stress tensors for the given problem.\nThe givens are:\nDeformation gradient: $$F = \\begin{pmatrix} 2 & 0 & 0 \\\\ 0 & \\frac{1}{2} & 0 \\\\ 0 & 0 & 1 \\end{pmatrix}$$\nCauchy stress: $$\\sigma = \\begin{pmatrix} 1 & 0 & 0 \\\\ 0 & 2 & 0 \\\\ 0 & 0 & 3 \\end{pmatrix}$$\n\nFirst, we compute necessary quantities derived from $F$:\nThe Jacobian is $J = \\det(F) = 2 \\times \\frac{1}{2} \\times 1 = 1$.\nThe inverse of the deformation gradient is $$F^{-1} = \\begin{pmatrix} \\frac{1}{2} & 0 & 0 \\\\ 0 & 2 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix}$$\nThe transpose of the inverse is $$F^{-T} = (F^{-1})^T = \\begin{pmatrix} \\frac{1}{2} & 0 & 0 \\\\ 0 & 2 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix}$$\n\nUsing the derived mappings, we compute $\\tau$, $P$, and $S$.\n\n1.  **Kirchhoff Stress ($\\tau$)**:\n    $$\\tau = J \\sigma = 1 \\cdot \\sigma = \\sigma$$\n    $$\\tau = \\begin{pmatrix} 1 & 0 & 0 \\\\ 0 & 2 & 0 \\\\ 0 & 0 & 3 \\end{pmatrix}$$\n\n2.  **First Piola–Kirchhoff Stress ($P$)**:\n    $$P = J \\sigma F^{-T} = 1 \\cdot \\sigma F^{-T} = \\sigma F^{-T}$$\n    $$P = \\begin{pmatrix} 1 & 0 & 0 \\\\ 0 & 2 & 0 \\\\ 0 & 0 & 3 \\end{pmatrix} \\begin{pmatrix} \\frac{1}{2} & 0 & 0 \\\\ 0 & 2 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix} = \\begin{pmatrix} 1 \\cdot \\frac{1}{2} & 0 & 0 \\\\ 0 & 2 \\cdot 2 & 0 \\\\ 0 & 0 & 3 \\cdot 1 \\end{pmatrix}$$\n    $$P = \\begin{pmatrix} \\frac{1}{2} & 0 & 0 \\\\ 0 & 4 & 0 \\\\ 0 & 0 & 3 \\end{pmatrix}$$\n\n3.  **Second Piola–Kirchhoff Stress ($S$)**:\n    $$S = J F^{-1} \\sigma F^{-T} = 1 \\cdot F^{-1} \\sigma F^{-T} = F^{-1} (\\sigma F^{-T}) = F^{-1} P$$\n    $$S = \\begin{pmatrix} \\frac{1}{2} & 0 & 0 \\\\ 0 & 2 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix} \\begin{pmatrix} \\frac{1}{2} & 0 & 0 \\\\ 0 & 4 & 0 \\\\ 0 & 0 & 3 \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{2} \\cdot \\frac{1}{2} & 0 & 0 \\\\ 0 & 2 \\cdot 4 & 0 \\\\ 0 & 0 & 1 \\cdot 3 \\end{pmatrix}$$\n    $$S = \\begin{pmatrix} \\frac{1}{4} & 0 & 0 \\\\ 0 & 8 & 0 \\\\ 0 & 0 & 3 \\end{pmatrix}$$\n\nFinally, we must verify the identity $\\tau = F S F^{T}$.\nSince $F$ is a diagonal matrix, its transpose is itself, $F^T = F$. The identity simplifies to $\\tau = F S F$.\n$$F S F = \\left( \\begin{pmatrix} 2 & 0 & 0 \\\\ 0 & \\frac{1}{2} & 0 \\\\ 0 & 0 & 1 \\end{pmatrix} \\begin{pmatrix} \\frac{1}{4} & 0 & 0 \\\\ 0 & 8 & 0 \\\\ 0 & 0 & 3 \\end{pmatrix} \\right) \\begin{pmatrix} 2 & 0 & 0 \\\\ 0 & \\frac{1}{2} & 0 \\\\ 0 & 0 & 1 \\end{pmatrix}$$\n$$F S F = \\begin{pmatrix} 2 \\cdot \\frac{1}{4} & 0 & 0 \\\\ 0 & \\frac{1}{2} \\cdot 8 & 0 \\\\ 0 & 0 & 1 \\cdot 3 \\end{pmatrix} \\begin{pmatrix} 2 & 0 & 0 \\\\ 0 & \\frac{1}{2} & 0 \\\\ 0 & 0 & 1 \\end{pmatrix}$$\n$$F S F = \\begin{pmatrix} \\frac{1}{2} & 0 & 0 \\\\ 0 & 4 & 0 \\\\ 0 & 0 & 3 \\end{pmatrix} \\begin{pmatrix} 2 & 0 & 0 \\\\ 0 & \\frac{1}{2} & 0 \\\\ 0 & 0 & 1 \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{2} \\cdot 2 & 0 & 0 \\\\ 0 & 4 \\cdot \\frac{1}{2} & 0 \\\\ 0 & 0 & 3 \\cdot 1 \\end{pmatrix}$$\n$$F S F = \\begin{pmatrix} 1 & 0 & 0 \\\\ 0 & 2 & 0 \\\\ 0 & 0 & 3 \\end{pmatrix}$$\nThis resulting matrix is identical to the Kirchhoff stress tensor $\\tau$, thus verifying the identity $\\tau = F S F^T$.\n\nThe problem asks for the diagonal entries of $P$, $\\tau$, and $S$ in the order $(P_{11}, P_{22}, P_{33}, \\tau_{11}, \\tau_{22}, \\tau_{33}, S_{11}, S_{22}, S_{33})$.\nFrom our calculations:\n$P$: $P_{11} = \\frac{1}{2}$, $P_{22} = 4$, $P_{33} = 3$\n$\\tau$: $\\tau_{11} = 1$, $\\tau_{22} = 2$, $\\tau_{33} = 3$\n$S$: $S_{11} = \\frac{1}{4}$, $S_{22} = 8$, $S_{33} = 3$\nThe final answer is the row matrix containing these values.", "answer": "$$\\boxed{\\begin{pmatrix} \\frac{1}{2} & 4 & 3 & 1 & 2 & 3 & \\frac{1}{4} & 8 & 3 \\end{pmatrix}}$$", "id": "3594819"}, {"introduction": "Moving beyond simple coaxial stretching, this exercise explores the effects of a non-trivial deformation. Simple shear is a canonical example in finite elasticity that reveals important physical phenomena unique to large-strain theory. This practice challenges you to apply the stress transformation laws to a non-diagonal deformation gradient, leading to the discovery that a pure shear deformation can induce normal stresses—a counter-intuitive result known as the Poynting effect, which is a direct consequence of nonlinear kinematics [@problem_id:3594874].", "problem": "A homogeneous hyperelastic solid undergoes a finite simple shear deformation characterized by the deformation gradient\n$$\nF=\\begin{bmatrix}\n1 & \\gamma & 0\\\\\n0 & 1 & 0\\\\\n0 & 0 & 1\n\\end{bmatrix},\n$$\nwhere $\\gamma$ is a real-valued shear parameter. At a material point, the Second Piola–Kirchhoff (PK2) stress tensor $S$ is given and symmetric,\n$$\nS=\\begin{bmatrix}\nS_{11} & S_{12} & S_{13}\\\\\nS_{12} & S_{22} & S_{23}\\\\\nS_{13} & S_{23} & S_{33}\n\\end{bmatrix}.\n$$\nStarting only from the equivalence of internal power between the reference and current configurations and the definitions of the First Piola–Kirchhoff (PK1) stress $P$, the PK2 stress $S$, the Kirchhoff stress $\\tau$, and the Cauchy stress $\\sigma$, perform the following:\n\n1. Derive the transformation that expresses the Cauchy stress $\\sigma$ in terms of $F$, $S$, and the determinant $J=\\det F$.\n2. Using the derived transformation, compute the explicit $3\\times 3$ matrix of the Cauchy stress $\\sigma$ for the given $F$ and general symmetric $S$.\n3. From your explicit expression, identify which off-diagonal components of $\\sigma$ are nonzero in general (treat $S_{ij}$ and $\\gamma$ as independent real parameters).\n\nExpress your final answer as the explicit matrix for $\\sigma$ in terms of $\\gamma$ and the components $S_{ij}$. No numerical evaluation is required, and no rounding is needed. Do not include units in your final expression.", "solution": "The problem as stated is scientifically grounded, well-posed, and objective. It is a standard problem in continuum mechanics that tests the understanding of different stress measures and their transformations under finite deformation. All necessary information is provided, and the tasks are clearly defined. The problem is valid and can be solved.\n\nThe primary objective is to find the Cauchy stress tensor $\\sigma$ for a simple shear deformation, starting from the Second Piola-Kirchhoff stress tensor $S$. This involves two main steps: first, deriving the general transformation law relating $\\sigma$ and $S$, and second, applying this law to the specific deformation gradient $F$ provided.\n\n**1. Derivation of the Transformation from $S$ to $\\sigma$**\n\nThe derivation begins with the principle of equivalence of internal power, which states that the rate of work done by stresses per unit volume is the same whether calculated in the reference (undeformed) configuration or the current (deformed) configuration. Let $\\mathcal{P}_0$ be the power density in the reference configuration and $\\mathcal{P}$ be the power density in the current configuration. The relationship between them is $\\mathcal{P}_0 = J \\mathcal{P}$, where $J = \\det F$ is the determinant of the deformation gradient $F$, representing the ratio of current volume to reference volume.\n\nThe power densities are defined in terms of stress and rates of deformation. In the reference configuration, the power density is given by the double contraction of the First Piola-Kirchhoff (PK1) stress tensor $P$ and the rate of change of the deformation gradient $\\dot{F}$:\n$$ \\mathcal{P}_0 = P : \\dot{F} = \\text{tr}(P^T \\dot{F}) $$\nIn the current configuration, the power density is given by the double contraction of the Cauchy stress tensor $\\sigma$ and the rate of deformation tensor $d$ (also known as the stretching tensor):\n$$ \\mathcal{P} = \\sigma : d $$\nThe rate of deformation tensor $d$ is the symmetric part of the spatial velocity gradient $l$, where $l = \\dot{F} F^{-1}$. Thus, $d = \\frac{1}{2}(l + l^T)$. Since the Cauchy stress tensor $\\sigma$ is symmetric, its contraction with the anti-symmetric part of $l$ is zero. Therefore, we can write $\\mathcal{P} = \\sigma : l = \\sigma : (\\dot{F} F^{-1})$.\n\nSubstituting these expressions into the power equivalence equation:\n$$ P : \\dot{F} = J (\\sigma : (\\dot{F} F^{-1})) $$\nRewriting this using the trace operator:\n$$ \\text{tr}(P^T \\dot{F}) = J \\, \\text{tr}(\\sigma^T (\\dot{F} F^{-1})) $$\nSince $\\sigma$ is symmetric, $\\sigma^T = \\sigma$. Applying the cyclic property of the trace operator ($\\text{tr}(ABC) = \\text{tr}(BCA)$) to the right-hand side:\n$$ \\text{tr}(P^T \\dot{F}) = J \\, \\text{tr}(F^{-1} \\sigma \\dot{F}) $$\nThis equality must hold for any arbitrary rate of deformation $\\dot{F}$. This implies that the coefficients of $\\dot{F}$ on both sides must be equal:\n$$ P^T = J F^{-1} \\sigma \\implies P = J \\sigma (F^{-1})^T $$\nThis equation relates the PK1 stress $P$ to the Cauchy stress $\\sigma$.\n\nNext, we introduce the Second Piola-Kirchhoff (PK2) stress tensor $S$. The definition relating $P$ and $S$ is:\n$$ P = F S $$\nThis relation can also be derived from power principles by noting that $S$ is energetically conjugate to the rate of the Green-Lagrange strain tensor $\\dot{E}$, where $E = \\frac{1}{2}(F^T F - I)$.\n\nEquating the two expressions for $P$:\n$$ F S = J \\sigma (F^{-1})^T $$\nTo solve for $\\sigma$, we pre-multiply by $F^{-1}$ and post-multiply by $F^T$:\n$$ F^{-1} (F S) F^T = F^{-1} (J \\sigma (F^{-1})^T) F^T $$\n$$ S F^T = J \\sigma (F^{-1})^T F^T $$\nUsing the identity $(A^{-1})^T = (A^T)^{-1}$, we have $(F^{-1})^T F^T = (F^T)^{-1} F^T = I$, where $I$ is the identity tensor.\n$$ S F^T = J \\sigma I = J \\sigma $$\nFinally, we arrive at the transformation law for the Cauchy stress:\n$$ \\sigma = \\frac{1}{J} F S F^T $$\nThis completes the first part of the problem. This transformation is known as the push-forward operation. Note that the Kirchhoff stress $\\tau$ is defined as $\\tau = J\\sigma$, so the transformation can also be written as $\\tau = FSF^T$.\n\n**2. Computation of the Cauchy Stress Matrix**\n\nNow, we apply this formula to the given deformation and stress.\nThe deformation gradient is:\n$$ F = \\begin{bmatrix} 1 & \\gamma & 0\\\\ 0 & 1 & 0\\\\ 0 & 0 & 1 \\end{bmatrix} $$\nThe Second Piola-Kirchhoff stress tensor is symmetric:\n$$ S = \\begin{bmatrix} S_{11} & S_{12} & S_{13}\\\\ S_{12} & S_{22} & S_{23}\\\\ S_{13} & S_{23} & S_{33} \\end{bmatrix} $$\nFirst, we compute the determinant $J = \\det F$:\n$$ J = \\det \\begin{bmatrix} 1 & \\gamma & 0\\\\ 0 & 1 & 0\\\\ 0 & 0 & 1 \\end{bmatrix} = 1(1 \\cdot 1 - 0 \\cdot 0) - \\gamma(0 \\cdot 1 - 0 \\cdot 0) + 0 = 1 $$\nSince $J=1$, the deformation is isochoric (volume-preserving), and the transformation simplifies to:\n$$ \\sigma = F S F^T $$\nThe transpose of $F$ is:\n$$ F^T = \\begin{bmatrix} 1 & 0 & 0\\\\ \\gamma & 1 & 0\\\\ 0 & 0 & 1 \\end{bmatrix} $$\nWe perform the matrix multiplication in two steps. First, we compute the product $FS$:\n$$ FS = \\begin{bmatrix} 1 & \\gamma & 0\\\\ 0 & 1 & 0\\\\ 0 & 0 & 1 \\end{bmatrix} \\begin{bmatrix} S_{11} & S_{12} & S_{13}\\\\ S_{12} & S_{22} & S_{23}\\\\ S_{13} & S_{23} & S_{33} \\end{bmatrix} = \\begin{bmatrix} S_{11} + \\gamma S_{12} & S_{12} + \\gamma S_{22} & S_{13} + \\gamma S_{23}\\\\ S_{12} & S_{22} & S_{23}\\\\ S_{13} & S_{23} & S_{33} \\end{bmatrix} $$\nNext, we post-multiply this result by $F^T$:\n$$ \\sigma = (FS)F^T = \\begin{bmatrix} S_{11} + \\gamma S_{12} & S_{12} + \\gamma S_{22} & S_{13} + \\gamma S_{23}\\\\ S_{12} & S_{22} & S_{23}\\\\ S_{13} & S_{23} & S_{33} \\end{bmatrix} \\begin{bmatrix} 1 & 0 & 0\\\\ \\gamma & 1 & 0\\\\ 0 & 0 & 1 \\end{bmatrix} $$\nCalculating each component of the resulting matrix $\\sigma$:\n$\\sigma_{11} = (S_{11} + \\gamma S_{12})(1) + (S_{12} + \\gamma S_{22})(\\gamma) = S_{11} + \\gamma S_{12} + \\gamma S_{12} + \\gamma^2 S_{22} = S_{11} + 2\\gamma S_{12} + \\gamma^2 S_{22}$\n$\\sigma_{12} = (S_{11} + \\gamma S_{12})(0) + (S_{12} + \\gamma S_{22})(1) = S_{12} + \\gamma S_{22}$\n$\\sigma_{13} = (S_{11} + \\gamma S_{12})(0) + (S_{12} + \\gamma S_{22})(0) + (S_{13} + \\gamma S_{23})(1) = S_{13} + \\gamma S_{23}$\n$\\sigma_{21} = (S_{12})(1) + (S_{22})(\\gamma) = S_{12} + \\gamma S_{22}$\n$\\sigma_{22} = (S_{12})(0) + (S_{22})(1) = S_{22}$\n$\\sigma_{23} = (S_{12})(0) + (S_{22})(0) + (S_{23})(1) = S_{23}$\n$\\sigma_{31} = (S_{13})(1) + (S_{23})(\\gamma) = S_{13} + \\gamma S_{23}$\n$\\sigma_{32} = (S_{13})(0) + (S_{23})(1) = S_{23}$\n$\\sigma_{33} = (S_{13})(0) + (S_{23})(0) + (S_{33})(1) = S_{33}$\n\nAs expected, the resulting Cauchy stress tensor $\\sigma$ is symmetric ($\\sigma_{ij} = \\sigma_{ji}$). The final matrix is:\n$$ \\sigma = \\begin{bmatrix} S_{11} + 2\\gamma S_{12} + \\gamma^2 S_{22} & S_{12} + \\gamma S_{22} & S_{13} + \\gamma S_{23} \\\\ S_{12} + \\gamma S_{22} & S_{22} & S_{23} \\\\ S_{13} + \\gamma S_{23} & S_{23} & S_{33} \\end{bmatrix} $$\n\n**3. Analysis of Off-Diagonal Components**\n\nThe problem asks to identify the off-diagonal components of $\\sigma$ that are nonzero in general. The unique off-diagonal components are:\n$$ \\sigma_{12} = S_{12} + \\gamma S_{22} $$\n$$ \\sigma_{13} = S_{13} + \\gamma S_{23} $$\n$$ \\sigma_{23} = S_{23} $$\nSince the parameters $S_{ij}$ and $\\gamma$ are treated as independent real variables, a component is zero in general only if its expression identically evaluates to zero for all parameter values, which is not the case for any of these. For example, $\\sigma_{12}$ is only zero if the specific condition $S_{12} = -\\gamma S_{22}$ is met, but it is not zero in general. Therefore, all three unique off-diagonal components, $\\sigma_{12}$, $\\sigma_{13}$, and $\\sigma_{23}$, are nonzero in general. It is also worth noting that the simple shear deformation generates a normal stress component $\\sigma_{11}$ (the Poynting effect) even if the initial stress state $S$ were purely shear.", "answer": "$$ \\boxed{\n\\begin{pmatrix}\nS_{11} + 2\\gamma S_{12} + \\gamma^{2} S_{22} & S_{12} + \\gamma S_{22} & S_{13} + \\gamma S_{23} \\\\\nS_{12} + \\gamma S_{22} & S_{22} & S_{23} \\\\\nS_{13} + \\gamma S_{23} & S_{23} & S_{33}\n\\end{pmatrix}\n} $$", "id": "3594874"}, {"introduction": "The final practice bridges the gap between analytical theory and computational implementation, a critical step for any engineer or scientist in this field. In computational mechanics, it is crucial to verify that theoretical relationships are correctly implemented in code, and a powerful technique is to use randomized numerical tests to check for self-consistency across a wide range of inputs. This exercise guides you in designing a test suite to numerically confirm that the entire network of stress transformations holds true, building confidence in both the underlying theory and its computational application under various and sometimes extreme conditions [@problem_id:3594833].", "problem": "You are to design and implement a randomized numerical test for stress measure consistency in computational solid mechanics at finite strain. Begin from fundamental kinematics and power equivalence principles between reference and current configurations, and derive the relations connecting the First Piola–Kirchhoff stress (FPK), the Second Piola–Kirchhoff stress (SPK), the Kirchhoff stress, and the Cauchy stress. Without using any pre-provided formulas, you must use your derivation to construct a program that generates random but controlled deformation gradients and symmetric stress tensors, and then verifies that the derived relations hold simultaneously within specified tolerances.\n\nAssume a three-dimensional continuum with reference coordinates denoted by $\\boldsymbol{X}$ and current coordinates denoted by $\\boldsymbol{x}$. The deformation gradient is $ \\boldsymbol{F} = \\dfrac{\\partial \\boldsymbol{x}}{\\partial \\boldsymbol{X}} $, with determinant $ J = \\det \\boldsymbol{F} $, and $ J > 0 $. Consider the following stress measures:\n- The Cauchy stress $ \\boldsymbol{\\sigma} $ acting on the current configuration.\n- The Kirchhoff stress $ \\boldsymbol{\\tau} $ defined via a change of volume.\n- The First Piola–Kirchhoff stress $ \\boldsymbol{P} $ mapping reference area to nominal traction.\n- The Second Piola–Kirchhoff stress $ \\boldsymbol{S} $ defined via pull-back to the reference configuration.\n\nYou must:\n1. Derive, starting only from foundational kinematics and the equivalence of power between configurations, the exact relations that connect these stress measures. Use the kinematic change-of-variables for areas and volumes and the appropriate push-forward and pull-back operations to ensure consistency.\n2. Implement a randomized numerical test in a programming language that generates invertible $ \\boldsymbol{F} $ with $ J > 0 $ and symmetric $ \\boldsymbol{S} $, and verifies, with prescribed tolerances, that your derived relations hold simultaneously.\n3. Use a consistent matrix norm to quantify the error. Let $ \\| \\cdot \\|_{F} $ denote the Frobenius norm. For two matrices $ \\boldsymbol{A} $ and $ \\boldsymbol{B} $, define the relative error as \n$$ e_{\\mathrm{rel}}(\\boldsymbol{A}, \\boldsymbol{B}) = \\dfrac{\\| \\boldsymbol{A} - \\boldsymbol{B} \\|_{F}}{\\| \\boldsymbol{B} \\|_{F} + \\varepsilon}, $$\nwith $ \\varepsilon = 10^{-15} $. Define the absolute error as $ e_{\\mathrm{abs}}(\\boldsymbol{A}, \\boldsymbol{B}) = \\| \\boldsymbol{A} - \\boldsymbol{B} \\|_{F} $. A test passes if both the relative error and the absolute error for each identity are below the corresponding tolerances.\n\nRandom generation requirements:\n- Generate a proper rotation $ \\boldsymbol{R} $ (with $ \\det \\boldsymbol{R} = +1 $) using a random matrix and a $ \\boldsymbol{Q}\\boldsymbol{R} $ decomposition, adjusting signs to ensure a proper orthogonal matrix.\n- Construct $ \\boldsymbol{F} = \\boldsymbol{R} \\boldsymbol{U} $ with $ \\boldsymbol{U} $ diagonal and strictly positive entries (principal stretches), so that $ J = \\det \\boldsymbol{F} = \\det \\boldsymbol{U} > 0 $. This ensures invertibility and positive orientation.\n- Draw a random symmetric $ \\boldsymbol{S} $ as $ \\boldsymbol{S} = \\dfrac{1}{2} (\\boldsymbol{A} + \\boldsymbol{A}^{T}) $, where $ \\boldsymbol{A} $ has independent standard normal entries.\n\nVerification structure:\n- Based on your derivation, implement the computations of $ \\boldsymbol{P} $, $ \\boldsymbol{\\tau} $, and $ \\boldsymbol{\\sigma} $ from $ \\boldsymbol{F} $ and $ \\boldsymbol{S} $.\n- Check the simultaneous consistency of all identities using both relative and absolute errors.\n\nTest suite:\nProvide five test cases that cover typical and edge scenarios. Each test case specifies how to generate $ \\boldsymbol{F} $ and $ \\boldsymbol{S} $ and the tolerances to be used.\n\n- Test case $ 1 $ (random moderate stretch): seed $ 0 $, $ \\boldsymbol{U} = \\mathrm{diag}(u_{1}, u_{2}, u_{3}) $ with $ u_{i} \\sim \\mathrm{Uniform}(0.5, 2) $, $ \\boldsymbol{S} $ from a random symmetric draw; tolerances: $ \\mathrm{rtol} = 10^{-10} $, $ \\mathrm{atol} = 10^{-12} $.\n- Test case $ 2 $ (identity mapping): seed $ 1 $, $ \\boldsymbol{U} = \\mathrm{diag}(1, 1, 1) $ so $ \\boldsymbol{F} = \\boldsymbol{R} \\boldsymbol{I} = \\boldsymbol{R} $; additionally set $ \\boldsymbol{R} = \\boldsymbol{I} $ to test the identity configuration; $ \\boldsymbol{S} $ random symmetric; tolerances: $ \\mathrm{rtol} = 10^{-12} $, $ \\mathrm{atol} = 10^{-14} $.\n- Test case $ 3 $ (small $ J $): seed $ 2 $, $ \\boldsymbol{U} = \\mathrm{diag}(10^{-2}, 10^{-2}, 10^{-2}) $ so $ J = 10^{-6} $, $ \\boldsymbol{S} $ random symmetric; tolerances: $ \\mathrm{rtol} = 10^{-9} $, $ \\mathrm{atol} = 10^{-12} $.\n- Test case $ 4 $ (ill-conditioned stretch): seed $ 3 $, $ \\boldsymbol{U} = \\mathrm{diag}(10^{3}, 10^{-3}, 1) $ so $ J = 1 $, $ \\boldsymbol{S} $ random symmetric; tolerances: $ \\mathrm{rtol} = 10^{-9} $, $ \\mathrm{atol} = 10^{-12} $.\n- Test case $ 5 $ (pure rotation): seed $ 4 $, $ \\boldsymbol{U} = \\mathrm{diag}(1, 1, 1) $ and $ \\boldsymbol{F} = \\boldsymbol{R} $ with a random proper rotation; $ \\boldsymbol{S} $ random symmetric; tolerances: $ \\mathrm{rtol} = 10^{-12} $, $ \\mathrm{atol} = 10^{-14} $.\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. Each entry must be a boolean indicating whether the corresponding test case passed all simultaneous checks. For example, produce $ [\\mathrm{True}, \\mathrm{True}, \\mathrm{False}, \\mathrm{True}, \\mathrm{True}] $ if that is the outcome.", "solution": "The problem statement is assessed to be valid as it is scientifically grounded in the principles of continuum mechanics, is well-posed with a clear objective and constraints, and is free of ambiguity or contradiction. We may therefore proceed with the derivation and implementation.\n\nThe core of this problem lies in deriving and verifying the kinematic and kinetic relationships between different stress measures used in finite-strain computational mechanics. The derivation begins from the principle of power equivalence, which posits that the internal power expended during a deformation is an objective quantity, independent of the configuration (reference or current) used for its calculation.\n\nLet a material body occupy a reference configuration $\\Omega_0$ with material points labeled by coordinates $\\boldsymbol{X}$. Under a deformation map $\\boldsymbol{x} = \\boldsymbol{\\phi}(\\boldsymbol{X}, t)$, the body occupies a current configuration $\\Omega_t$ at time $t$. The fundamental measure of deformation is the deformation gradient tensor, defined as $\\boldsymbol{F} = \\dfrac{\\partial \\boldsymbol{x}}{\\partial \\boldsymbol{X}}$. We assume the deformation is orientation-preserving, so the Jacobian determinant $J = \\det \\boldsymbol{F} > 0$.\n\nThe internal power, $\\mathcal{P}_{\\text{int}}$, can be expressed in the current (Eulerian) configuration using the Cauchy stress tensor $\\boldsymbol{\\sigma}$ and the rate of deformation tensor $\\boldsymbol{d}$:\n$$\n\\mathcal{P}_{\\text{int}} = \\int_{\\Omega_t} \\boldsymbol{\\sigma} : \\boldsymbol{d} \\, dv\n$$\nwhere $dv$ is a volume element in the current configuration. The rate of deformation is the symmetric part of the spatial velocity gradient $\\boldsymbol{l} = \\nabla_{\\boldsymbol{x}}\\boldsymbol{v}$, i.e., $\\boldsymbol{d} = \\frac{1}{2}(\\boldsymbol{l} + \\boldsymbol{l}^T)$. Since the Cauchy stress $\\boldsymbol{\\sigma}$ is symmetric, the product $\\boldsymbol{\\sigma} : \\boldsymbol{l}$ is equivalent to $\\boldsymbol{\\sigma} : \\boldsymbol{d}$.\n\nAlternatively, the internal power can be expressed in the reference (Lagrangian) configuration using the First Piola-Kirchhoff (FPK) stress tensor $\\boldsymbol{P}$ and the rate of the deformation gradient, $\\dot{\\boldsymbol{F}}$:\n$$\n\\mathcal{P}_{\\text{int}} = \\int_{\\Omega_0} \\boldsymbol{P} : \\dot{\\boldsymbol{F}} \\, dV\n$$\nwhere $dV$ is a volume element in the reference configuration. The FPK stress $\\boldsymbol{P}$ is a two-point tensor that relates forces in the current configuration to areas in the reference configuration.\n\nBy the principle of power equivalence, these two expressions must be equal. The volume elements are related by $dv = J dV$. Equating the power integrals and converting the integration domain to $\\Omega_0$ yields:\n$$\n\\int_{\\Omega_0} \\boldsymbol{P} : \\dot{\\boldsymbol{F}} \\, dV = \\int_{\\Omega_0} (\\boldsymbol{\\sigma} : \\boldsymbol{d}) J \\, dV\n$$\nSince this equality must hold for any arbitrary sub-volume, the integrands must be equal, leading to the local power identity:\n$$\n\\boldsymbol{P} : \\dot{\\boldsymbol{F}} = J (\\boldsymbol{\\sigma} : \\boldsymbol{d})\n$$\nTo proceed, we establish the kinematic relationship between $\\dot{\\boldsymbol{F}}$ and $\\boldsymbol{l}$. The material time derivative of $\\boldsymbol{F}$ is $\\dot{\\boldsymbol{F}} = \\frac{\\partial}{\\partial \\boldsymbol{X}} (\\boldsymbol{v})$, where $\\boldsymbol{v}$ is the material velocity. Using the chain rule, $\\dot{\\boldsymbol{F}} = (\\frac{\\partial \\boldsymbol{v}}{\\partial \\boldsymbol{x}})(\\frac{\\partial \\boldsymbol{x}}{\\partial \\boldsymbol{X}}) = \\boldsymbol{l} \\boldsymbol{F}$.\n\nSubstituting this into the power identity and recalling that $\\boldsymbol{\\sigma} : \\boldsymbol{d} = \\boldsymbol{\\sigma} : \\boldsymbol{l}$:\n$$\n\\boldsymbol{P} : (\\boldsymbol{l} \\boldsymbol{F}) = J (\\boldsymbol{\\sigma} : \\boldsymbol{l})\n$$\nUsing the identity for the double-dot product, $(\\boldsymbol{A}\\boldsymbol{B}):\\boldsymbol{C} = \\boldsymbol{A}:(\\boldsymbol{C}\\boldsymbol{B}^T)$, we get $\\boldsymbol{P}:(\\boldsymbol{l}\\boldsymbol{F}) = (\\boldsymbol{P}\\boldsymbol{F}^T):\\boldsymbol{l}$. The power identity becomes:\n$$\n(\\boldsymbol{P}\\boldsymbol{F}^T) : \\boldsymbol{l} = (J\\boldsymbol{\\sigma}) : \\boldsymbol{l}\n$$\nThis must hold for any arbitrary velocity field, and thus for any arbitrary $\\boldsymbol{l}$. This implies the fundamental relationship between the FPK stress $\\boldsymbol{P}$ and the Cauchy stress $\\boldsymbol{\\sigma}$:\n$$\n\\boldsymbol{P}\\boldsymbol{F}^T = J\\boldsymbol{\\sigma} \\quad \\implies \\quad \\boldsymbol{\\sigma} = \\frac{1}{J} \\boldsymbol{P} \\boldsymbol{F}^T\n$$\nThis relation is a push-forward operation. The inverse, a pull-back operation, is $\\boldsymbol{P} = J\\boldsymbol{\\sigma}\\boldsymbol{F}^{-T}$.\n\nThe Kirchhoff stress, $\\boldsymbol{\\tau}$, is introduced as a scaled version of the Cauchy stress, $\\boldsymbol{\\tau} = J\\boldsymbol{\\sigma}$. It is a symmetric tensor that represents the Cauchy stress acting on a volume scaled back to its reference size. Substituting $\\boldsymbol{\\tau}$ into the previous relation yields a direct connection to the FPK stress:\n$$\n\\boldsymbol{\\tau} = \\boldsymbol{P} \\boldsymbol{F}^T \\quad \\implies \\quad \\boldsymbol{P} = \\boldsymbol{\\tau} \\boldsymbol{F}^{-T}\n$$\n\nThe Second Piola-Kirchhoff (SPK) stress, $\\boldsymbol{S}$, is a symmetric tensor fully defined in the reference configuration. It is energetically conjugate to the rate of the Green-Lagrange strain tensor, $\\dot{\\boldsymbol{E}}$, where $\\boldsymbol{E} = \\frac{1}{2}(\\boldsymbol{F}^T\\boldsymbol{F} - \\boldsymbol{I})$. The power density in the reference configuration can thus also be written as $\\boldsymbol{S} : \\dot{\\boldsymbol{E}}$. Equating this to the power density expressed with the FPK stress:\n$$\n\\boldsymbol{P} : \\dot{\\boldsymbol{F}} = \\boldsymbol{S} : \\dot{\\boldsymbol{E}}\n$$\nThe rate of Green-Lagrange strain is $\\dot{\\boldsymbol{E}} = \\frac{1}{2}(\\dot{\\boldsymbol{F}}^T\\boldsymbol{F} + \\boldsymbol{F}^T\\dot{\\boldsymbol{F}})$. As $\\boldsymbol{S}$ is symmetric, it can be shown that $\\boldsymbol{S} : \\dot{\\boldsymbol{E}} = (\\boldsymbol{F}\\boldsymbol{S}) : \\dot{\\boldsymbol{F}}$. The power identity becomes:\n$$\n\\boldsymbol{P} : \\dot{\\boldsymbol{F}} = (\\boldsymbol{F}\\boldsymbol{S}) : \\dot{\\boldsymbol{F}}\n$$\nThis holds for any $\\dot{\\boldsymbol{F}}$, which yields the direct relationship between the FPK and SPK stress tensors:\n$$\n\\boldsymbol{P} = \\boldsymbol{F} \\boldsymbol{S} \\quad \\implies \\quad \\boldsymbol{S} = \\boldsymbol{F}^{-1} \\boldsymbol{P}\n$$\n\nIn summary, starting from a given symmetric SPK stress $\\boldsymbol{S}$ and deformation gradient $\\boldsymbol{F}$, the other stress measures are derived as:\n1.  First Piola-Kirchhoff stress: $\\boldsymbol{P} = \\boldsymbol{F}\\boldsymbol{S}$\n2.  Kirchhoff stress: $\\boldsymbol{\\tau} = \\boldsymbol{P}\\boldsymbol{F}^T = \\boldsymbol{F}\\boldsymbol{S}\\boldsymbol{F}^T$\n3.  Cauchy stress: $\\boldsymbol{\\sigma} = \\frac{1}{J}\\boldsymbol{\\tau} = \\frac{1}{J}\\boldsymbol{F}\\boldsymbol{S}\\boldsymbol{F}^T$\n\nThe numerical test will generate $\\boldsymbol{F}$ and $\\boldsymbol{S}$ according to the problem specification. It will then compute $\\boldsymbol{P}$, $\\boldsymbol{\\tau}$, and $\\boldsymbol{\\sigma}$ using a primary sequence of operations (e.g., $\\boldsymbol{S} \\to \\boldsymbol{P} \\to \\boldsymbol{\\tau} \\to \\boldsymbol{\\sigma}$). Subsequently, it will verify the consistency of the full set of derived stress measures by checking other relations that link them, such as composite push-forward ($\\boldsymbol{\\sigma} = \\frac{1}{J}\\boldsymbol{F}\\boldsymbol{S}\\boldsymbol{F}^T$) and pull-back ($\\boldsymbol{S} = J\\boldsymbol{F}^{-1}\\boldsymbol{\\sigma}\\boldsymbol{F}^{-T}$) identities. A test case is passed if all checks are satisfied within the specified absolute and relative tolerances.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Designs and implements a randomized numerical test for stress measure\n    consistency in computational solid mechanics at finite strain.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            'seed': 0, 'u_params': ('uniform', (0.5, 2.0)), 'R_mode': 'random', \n            'rtol': 1e-10, 'atol': 1e-12\n        },\n        {\n            'seed': 1, 'u_params': ('fixed', [1.0, 1.0, 1.0]), 'R_mode': 'identity',\n            'rtol': 1e-12, 'atol': 1e-14\n        },\n        {\n            'seed': 2, 'u_params': ('fixed', [1e-2, 1e-2, 1e-2]), 'R_mode': 'random', \n            'rtol': 1e-9, 'atol': 1e-12\n        },\n        {\n            'seed': 3, 'u_params': ('fixed', [1e3, 1e-3, 1.0]), 'R_mode': 'random', \n            'rtol': 1e-9, 'atol': 1e-12\n        },\n        {\n            'seed': 4, 'u_params': ('fixed', [1.0, 1.0, 1.0]), 'R_mode': 'random', \n            'rtol': 1e-12, 'atol': 1e-14\n        },\n    ]\n\n    results = []\n\n    def check_error(A, B, rtol, atol):\n        \"\"\"\n        Calculates relative and absolute error and checks against tolerances.\n        \"\"\"\n        epsilon = 1e-15\n        abs_err = np.linalg.norm(A - B, 'fro')\n        norm_B = np.linalg.norm(B, 'fro')\n        rel_err = abs_err / (norm_B + epsilon)\n        return (rel_err < rtol) and (abs_err < atol)\n\n    for case in test_cases:\n        np.random.seed(case['seed'])\n\n        # 1. Generate random but controlled F and S\n        # Generate F = R U\n        # Generate proper rotation R\n        if case['R_mode'] == 'identity':\n            R = np.identity(3)\n        else: # 'random'\n            A_rand = np.random.randn(3, 3)\n            Q, _ = np.linalg.qr(A_rand)\n            # Ensure R is a proper rotation (det(R) = +1)\n            if np.linalg.det(Q) < 0:\n                Q[:, 0] *= -1\n            R = Q\n\n        # Generate stretch tensor U\n        u_mode, u_vals = case['u_params']\n        if u_mode == 'uniform':\n            stretches = np.random.uniform(u_vals[0], u_vals[1], 3)\n        else: # 'fixed'\n            stretches = np.array(u_vals)\n        U = np.diag(stretches)\n\n        F = R @ U\n\n        # Generate random symmetric S\n        A_s = np.random.randn(3, 3)\n        S = 0.5 * (A_s + A_s.T)\n\n        # 2. Compute other stress measures based on derived relations\n        J = np.linalg.det(F)\n        if J <= 0:\n            # This should not happen with the given generation method\n            results.append(False)\n            continue\n        \n        # Sequentially compute P, tau, sigma from S\n        # This set constitutes the reference values for the checks.\n        P_ref = F @ S\n        tau_ref = P_ref @ F.T\n        sigma_ref = (1/J) * tau_ref\n        \n        # 3. Verify that derived relations hold simultaneously\n        # A test case passes if all checks are satisfied.\n        all_checks_passed = True\n        \n        # Check 1: Composite push-forward from S to tau\n        # Verify tau = F S F^T\n        tau_check_1 = F @ S @ F.T\n        if not check_error(tau_check_1, tau_ref, case['rtol'], case['atol']):\n            all_checks_passed = False\n\n        # Check 2: Composite push-forward from S to sigma\n        # Verify sigma = (1/J) F S F^T\n        sigma_check_2 = (1/J) * (F @ S @ F.T)\n        if not check_error(sigma_check_2, sigma_ref, case['rtol'], case['atol']):\n            all_checks_passed = False\n            \n        # Check 3: Full cycle consistency check (pull-back of sigma to S)\n        # Verify S = J F^{-1} sigma F^{-T}\n        # This check involves matrix inversion and is a good test of numerical stability.\n        try:\n            F_inv = np.linalg.inv(F)\n            F_inv_T = F_inv.T\n            S_check_3 = J * F_inv @ sigma_ref @ F_inv_T\n            if not check_error(S_check_3, S, case['rtol'], case['atol']):\n                all_checks_passed = False\n        except np.linalg.LinAlgError:\n            all_checks_passed = False # Inversion failed\n\n        results.append(all_checks_passed)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3594833"}]}