{"hands_on_practices": [{"introduction": "The deformation map, $\\boldsymbol{\\varphi}$, is the cornerstone of continuum mechanics, providing a mathematical description of how a body moves and changes shape. A fundamental property of this map is its invertibility, which ensures that each point in the deformed body can be uniquely traced back to its original position. This exercise [@problem_id:3579886] provides hands-on practice with this core concept by asking you to find the inverse of a simple shear deformation, reinforcing the bijective relationship between material and spatial coordinates.", "problem": "In computational solid mechanics, a deformation of a body is described by a mapping from the reference (material) coordinates to the current (spatial) coordinates. Let $X = (X_1, X_2)$ denote the material coordinates in the reference configuration and let $x = (x_1, x_2)$ denote the spatial coordinates in the current configuration. Consider the planar deformation mapping $\\varphi : \\mathbb{R}^2 \\to \\mathbb{R}^2$ defined by\n$$\nx = \\varphi(X), \\quad \\text{with} \\quad \\varphi(X_1, X_2) = (X_1 + \\gamma X_2,\\, X_2),\n$$\nwhere $\\gamma \\in \\mathbb{R}$ is a constant shear parameter. Starting from the core definitions of the deformation mapping and the deformation gradient, determine the explicit form of the inverse mapping $\\varphi^{-1} : \\mathbb{R}^2 \\to \\mathbb{R}^2$ that takes spatial coordinates $x$ back to material coordinates $X$, and verify the composition property $\\varphi^{-1}(\\varphi(X)) = X$ for all $X \\in \\mathbb{R}^2$.\n\nExpress your final answer as a single analytic expression for $\\varphi^{-1}(x)$ in terms of $x_1$, $x_2$, and $\\gamma$. No rounding is required. Do not include units in your final expression.", "solution": "The problem provides a planar deformation mapping $\\varphi: \\mathbb{R}^2 \\to \\mathbb{R}^2$ that relates the material coordinates $X = (X_1, X_2)$ to the spatial coordinates $x = (x_1, x_2)$. The mapping is defined as $x = \\varphi(X)$, with the explicit form:\n$$\n\\varphi(X_1, X_2) = (X_1 + \\gamma X_2, X_2)\n$$\nwhere $\\gamma$ is a constant real number. In component form, this relationship is expressed as a system of two equations:\n$$\nx_1 = X_1 + \\gamma X_2 \\\\\nx_2 = X_2\n$$\n\nThe first task is to determine the inverse mapping $\\varphi^{-1}: \\mathbb{R}^2 \\to \\mathbb{R}^2$. This inverse mapping transforms the spatial coordinates $x$ back into the material coordinates $X$, such that $X = \\varphi^{-1}(x)$. To find this inverse, we must solve the system of equations for $X_1$ and $X_2$ in terms of $x_1$ and $x_2$.\n\nFrom the second equation, we immediately have the expression for $X_2$:\n$$\nX_2 = x_2\n$$\nNow, we can substitute this result into the first equation:\n$$\nx_1 = X_1 + \\gamma (x_2)\n$$\nSolving for $X_1$, we obtain:\n$$\nX_1 = x_1 - \\gamma x_2\n$$\nThus, we have found the components of the material coordinates $X$ as functions of the spatial coordinates $x$. We can now write the explicit form of the inverse mapping $\\varphi^{-1}$:\n$$\nX = \\varphi^{-1}(x_1, x_2) = (X_1, X_2) = (x_1 - \\gamma x_2, x_2)\n$$\n\nThe second task is to verify the composition property $\\varphi^{-1}(\\varphi(X)) = X$. This property asserts that applying the inverse mapping to the result of the forward mapping returns the original coordinates.\n\nLet us start with an arbitrary point in the reference configuration, $X = (X_1, X_2)$.\nFirst, we apply the forward mapping $\\varphi$:\n$$\n\\varphi(X) = \\varphi(X_1, X_2) = (X_1 + \\gamma X_2, X_2)\n$$\nLet the resulting point in the spatial configuration be $x = (x_1, x_2)$, where $x_1 = X_1 + \\gamma X_2$ and $x_2 = X_2$.\n\nNext, we apply the inverse mapping $\\varphi^{-1}$ to this point $x$:\n$$\n\\varphi^{-1}(x) = \\varphi^{-1}(x_1, x_2) = (x_1 - \\gamma x_2, x_2)\n$$\nNow, we substitute the expressions for $x_1$ and $x_2$ in terms of $X_1$ and $X_2$ back into this equation:\n$$\n\\varphi^{-1}(\\varphi(X_1, X_2)) = \\left( (X_1 + \\gamma X_2) - \\gamma (X_2), (X_2) \\right)\n$$\nSimplifying the first component of the resulting vector:\n$$\n(X_1 + \\gamma X_2) - \\gamma X_2 = X_1 + \\gamma X_2 - \\gamma X_2 = X_1\n$$\nThe second component is simply $X_2$.\nTherefore, the composition yields:\n$$\n\\varphi^{-1}(\\varphi(X_1, X_2)) = (X_1, X_2) = X\n$$\nThe composition property is verified for all $X \\in \\mathbb{R}^2$.\n\nThe problem asks for the explicit form of the inverse mapping $\\varphi^{-1}(x)$. Based on our derivation, this is given by the components of $X$ expressed in terms of the components of $x$.", "answer": "$$\n\\boxed{(x_1 - \\gamma x_2, x_2)}\n$$", "id": "3579886"}, {"introduction": "While the deformation map describes the overall change in shape, the deformation gradient, $\\mathbf{F} = \\nabla_X \\boldsymbol{\\varphi}$, is the key to understanding the local effects of deformation at a single point. This tensor contains all the information about local stretching, shearing, and rotation. This practice [@problem_id:3579908] challenges you to compute $\\mathbf{F}$ for a non-uniform deformation and analyze its mathematical properties, revealing the profound link between the non-symmetry of $\\mathbf{F}$ and the presence of local rotation.", "problem": "Consider a body undergoing a deformation from a reference (material) configuration with material coordinates $\\boldsymbol{X} = (X_{1}, X_{2}, X_{3})$ to a current (spatial) configuration with spatial coordinates $\\boldsymbol{x} = (x_{1}, x_{2}, x_{3})$ described by the mapping $\\boldsymbol{\\varphi} : \\mathbb{R}^{3} \\to \\mathbb{R}^{3}$, where\n$$\n\\boldsymbol{\\varphi}(\\boldsymbol{X}) = \\left( X_{1} + \\kappa X_{2}^{2},\\, X_{2},\\, X_{3} \\right),\n$$\nand $\\kappa$ is a real constant parameter. Starting from the fundamental definition of the deformation gradient, compute the deformation gradient tensor $\\boldsymbol{F}(\\boldsymbol{X})$ in the material coordinates. Then, determine whether $\\boldsymbol{F}(\\boldsymbol{X})$ is symmetric for all $\\boldsymbol{X}$ and discuss the kinematic implications of your finding in terms of local rotation and stretch in the polar decomposition. Your reasoning must proceed from first principles: the meaning of a deformation map in computational solid mechanics and the definition of the deformation gradient as the material derivative of the map. Express your final answer as the exact analytic expression for $\\boldsymbol{F}(\\boldsymbol{X})$. No rounding is required, and no units should be included in the final expression.", "solution": "The deformation map $\\boldsymbol{x} = \\boldsymbol{\\varphi}(\\boldsymbol{X})$ relates the position of a material point $\\boldsymbol{X}$ in the reference configuration to its position $\\boldsymbol{x}$ in the current configuration. The components of this map are given as:\n$$\nx_{1}(\\boldsymbol{X}) = X_{1} + \\kappa X_{2}^{2} \\\\\nx_{2}(\\boldsymbol{X}) = X_{2} \\\\\nx_{3}(\\boldsymbol{X}) = X_{3}\n$$\nThe deformation gradient tensor, denoted by $\\boldsymbol{F}$, is defined as the material gradient of the deformation map $\\boldsymbol{\\varphi}$. It describes how an infinitesimal vector $d\\boldsymbol{X}$ in the reference configuration is mapped to an infinitesimal vector $d\\boldsymbol{x}$ in the current configuration, via the relation $d\\boldsymbol{x} = \\boldsymbol{F} d\\boldsymbol{X}$. The components of $\\boldsymbol{F}$ are given by the partial derivatives of the spatial coordinates with respect to the material coordinates:\n$$\nF_{ij} = \\frac{\\partial x_{i}}{\\partial X_{j}}\n$$\nwhere $i, j \\in \\{1, 2, 3\\}$. We now compute each of the nine components of the tensor $\\boldsymbol{F}(\\boldsymbol{X})$.\n\nFor the first row ($i=1$):\n$$\nF_{11} = \\frac{\\partial x_{1}}{\\partial X_{1}} = \\frac{\\partial}{\\partial X_{1}}(X_{1} + \\kappa X_{2}^{2}) = 1 \\\\\nF_{12} = \\frac{\\partial x_{1}}{\\partial X_{2}} = \\frac{\\partial}{\\partial X_{2}}(X_{1} + \\kappa X_{2}^{2}) = 2\\kappa X_{2} \\\\\nF_{13} = \\frac{\\partial x_{1}}{\\partial X_{3}} = \\frac{\\partial}{\\partial X_{3}}(X_{1} + \\kappa X_{2}^{2}) = 0\n$$\n\nFor the second row ($i=2$):\n$$\nF_{21} = \\frac{\\partial x_{2}}{\\partial X_{1}} = \\frac{\\partial}{\\partial X_{1}}(X_{2}) = 0 \\\\\nF_{22} = \\frac{\\partial x_{2}}{\\partial X_{2}} = \\frac{\\partial}{\\partial X_{2}}(X_{2}) = 1 \\\\\nF_{23} = \\frac{\\partial x_{2}}{\\partial X_{3}} = \\frac{\\partial}{\\partial X_{3}}(X_{2}) = 0\n$$\n\nFor the third row ($i=3$):\n$$\nF_{31} = \\frac{\\partial x_{3}}{\\partial X_{1}} = \\frac{\\partial}{\\partial X_{1}}(X_{3}) = 0 \\\\\nF_{32} = \\frac{\\partial x_{3}}{\\partial X_{2}} = \\frac{\\partial}{\\partial X_{2}}(X_{3}) = 0 \\\\\nF_{33} = \\frac{\\partial x_{3}}{\\partial X_{3}} = \\frac{\\partial}{\\partial X_{3}}(X_{3}) = 1\n$$\n\nAssembling these components into a matrix representation, the deformation gradient tensor is:\n$$\n\\boldsymbol{F}(\\boldsymbol{X}) = \\begin{pmatrix} 1 & 2\\kappa X_{2} & 0 \\\\ 0 & 1 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix}\n$$\n\nNext, we must determine if $\\boldsymbol{F}(\\boldsymbol{X})$ is symmetric for all $\\boldsymbol{X}$. A tensor is symmetric if it is equal to its transpose, i.e., if $\\boldsymbol{F} = \\boldsymbol{F}^{T}$. The transpose of $\\boldsymbol{F}$ is:\n$$\n\\boldsymbol{F}^{T}(\\boldsymbol{X}) = \\begin{pmatrix} 1 & 0 & 0 \\\\ 2\\kappa X_{2} & 1 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix}\n$$\nComparing $\\boldsymbol{F}$ and $\\boldsymbol{F}^{T}$, we see that $\\boldsymbol{F} = \\boldsymbol{F}^{T}$ if and only if $F_{12} = F_{21}$, $F_{13} = F_{31}$, and $F_{23} = F_{32}$. The second and third conditions are satisfied ($0=0$). However, the first condition requires $2\\kappa X_{2} = 0$. This equality holds for all $\\boldsymbol{X}$ only if the constant $\\kappa = 0$. If $\\kappa \\neq 0$, the equality holds only for material points on the plane $X_{2} = 0$. Since the problem asks if $\\boldsymbol{F}$ is symmetric for *all* $\\boldsymbol{X}$, the answer is no (assuming a non-trivial deformation where $\\kappa \\neq 0$).\n\nFinally, we discuss the kinematic implications. The polar decomposition theorem states that any invertible deformation gradient $\\boldsymbol{F}$ can be uniquely decomposed into the product of a rotation tensor $\\boldsymbol{R}$ and a symmetric, positive-definite right stretch tensor $\\boldsymbol{U}$, such that $\\boldsymbol{F} = \\boldsymbol{R}\\boldsymbol{U}$. The tensor $\\boldsymbol{U}$ describes the pure stretching and shearing of the material element from the reference configuration, while $\\boldsymbol{R}$ describes its subsequent rigid body rotation.\n\nIf the deformation gradient $\\boldsymbol{F}$ were symmetric, it would imply that $\\boldsymbol{F} = \\boldsymbol{U}$ and the rotation tensor $\\boldsymbol{R} = \\boldsymbol{I}$ (the identity tensor), assuming $\\boldsymbol{F}$ is also positive definite. A deformation where $\\boldsymbol{R} = \\boldsymbol{I}$ is known as a pure stretch, meaning the material element is stretched along its principal axes without any local rotation.\n\nIn this problem, $\\boldsymbol{F}$ is generally not symmetric. The non-symmetry of $\\boldsymbol{F}$ is a direct indication that the deformation is not a pure stretch. The rotation tensor $\\boldsymbol{R}$ will not be the identity tensor (unless $2\\kappa X_{2} = 0$). This means that, in general, a material element at a point $\\boldsymbol{X}$ undergoes both stretching (described by $\\boldsymbol{U}$) and a local rigid body rotation (described by $\\boldsymbol{R}$). The deformation described is a non-uniform simple shear, where the amount of shear in the $X_{1}$ direction is proportional to the square of the $X_2$ coordinate. Simple shear is a classic example of a motion that intrinsically involves rotation. The non-symmetry of the deformation gradient is the mathematical manifestation of this physical rotation.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1 & 2\\kappa X_{2} & 0 \\\\\n0 & 1 & 0 \\\\\n0 & 0 & 1\n\\end{pmatrix}\n}\n$$", "id": "3579908"}, {"introduction": "Continuum mechanics is ultimately the study of motion, which requires us to understand how deformations evolve over time. This involves examining the rate of change of the deformation gradient, $\\dot{\\mathbf{F}}$, and its connection to the velocity field. This exercise [@problem_id:3579907] guides you through the derivation and verification of the fundamental kinematic relationship between $\\dot{\\mathbf{F}}$ and the material and spatial gradients of velocity, bridging the gap between a static description of deformation and a full dynamic analysis.", "problem": "Consider a smooth motion map from a material configuration to a spatial configuration defined by the function $\\mathbf{x}(\\mathbf{X}, t)$, where $\\mathbf{X} \\in \\mathbb{R}^3$ denotes the material coordinates and $\\mathbf{x} \\in \\mathbb{R}^3$ denotes the spatial coordinates at time $t \\in \\mathbb{R}$. Let the deformation gradient be defined as $\\mathbf{F}(\\mathbf{X}, t)$ with entries given by the partial derivatives of $\\mathbf{x}$ with respect to $\\mathbf{X}$, and let the material velocity be $\\mathbf{v}(\\mathbf{X}, t)$ defined by the time derivative of $\\mathbf{x}$ at fixed $\\mathbf{X}$. Assume the motion map and its partial derivatives are continuous in all arguments so that differentiation can be interchanged.\n\nTask 1 (derivation):\n- Starting from the kinematic definition of the motion map and the deformation gradient, derive an expression for the material time derivative of the deformation gradient, expressed in terms of the material gradient of the velocity. The derivation must begin from the fundamental definitions of $\\mathbf{x}(\\mathbf{X}, t)$, $\\mathbf{F}(\\mathbf{X}, t)$, and $\\mathbf{v}(\\mathbf{X}, t)$.\n- Derive a relation connecting the material gradient of velocity and the spatial gradient of velocity through the deformation gradient. The derivation must begin from the fundamental definitions and use only standard chain-rule arguments in a scientifically realistic manner.\n\nTask 2 (implementation and comparison):\nImplement the derived expressions and compare them numerically on three kinematically distinct motions. For each motion, evaluate the following residuals at specified material points:\n- Residual A: the maximum absolute entrywise difference between the material time derivative of the deformation gradient and the material gradient of the velocity, evaluated at fixed $\\mathbf{X}$.\n- Residual B: the maximum absolute entrywise difference between the material gradient of velocity and the product of the spatial velocity gradient and the deformation gradient, evaluated at the same $\\mathbf{X}$.\n\nAll quantities are to be computed in consistent physical units with positions in meters ($\\mathrm m$), time in seconds ($\\mathrm s$), and angular rates in radians per second. The residuals must be reported in reciprocal seconds ($1/\\mathrm s$). Angles must be treated in radians.\n\nUse the following test suite, which spans a general case, a rigid-body boundary case, and an inhomogeneous edge case:\n\n- Test Case 1 (time-dependent simple shear):\n  - Motion: $\\mathbf{x}(\\mathbf{X}, t) = \\begin{bmatrix} X_1 + \\gamma(t) X_2 \\\\ X_2 \\\\ X_3 \\end{bmatrix}$ with $\\gamma(t) = t^2$ for $t = 0.5\\,\\mathrm s$.\n  - Material points (in $\\mathrm m$): $\\mathbf{X}^{(1)} = \\begin{bmatrix} 0.4 \\\\ -0.3 \\\\ 0.2 \\end{bmatrix}$, $\\mathbf{X}^{(2)} = \\begin{bmatrix} 1.0 \\\\ 0.0 \\\\ -0.5 \\end{bmatrix}$, $\\mathbf{X}^{(3)} = \\begin{bmatrix} 0.0 \\\\ 0.0 \\\\ 0.0 \\end{bmatrix}$.\n\n- Test Case 2 (planar rigid rotation about the $z$-axis):\n  - Motion: $\\mathbf{x}(\\mathbf{X}, t) = \\mathbf{R}(t)\\,\\mathbf{X}$, where $\\mathbf{R}(t)$ is the rotation of angle $\\theta(t) = \\omega t$ with angular rate $\\omega = 3.0\\,\\mathrm{rad}/\\mathrm s$ at $t = 0.2\\,\\mathrm s$.\n  - Material points (in $\\mathrm m$): $\\mathbf{X}^{(1)} = \\begin{bmatrix} 0.7 \\\\ 0.2 \\\\ 0.0 \\end{bmatrix}$, $\\mathbf{X}^{(2)} = \\begin{bmatrix} -0.5 \\\\ 1.0 \\\\ 0.3 \\end{bmatrix}$, $\\mathbf{X}^{(3)} = \\begin{bmatrix} 0.0 \\\\ 0.0 \\\\ 0.0 \\end{bmatrix}$.\n\n- Test Case 3 (inhomogeneous, time-dependent stretch-shear):\n  - Motion: $\\mathbf{x}(\\mathbf{X}, t) = \\begin{bmatrix} e^{\\alpha t} X_1 \\\\ \\left(1 + \\beta t X_1\\right) X_2 \\\\ X_3 \\end{bmatrix}$ with $\\alpha = 1.2\\,\\mathrm s^{-1}$, $\\beta = 0.8\\,\\mathrm{m}^{-1}\\mathrm s^{-1}$ at $t = 0.4\\,\\mathrm s$.\n  - Material points (in $\\mathrm m$): $\\mathbf{X}^{(1)} = \\begin{bmatrix} 0.6 \\\\ 0.5 \\\\ -0.2 \\end{bmatrix}$, $\\mathbf{X}^{(2)} = \\begin{bmatrix} 1.2 \\\\ -0.4 \\\\ 0.1 \\end{bmatrix}$, $\\mathbf{X}^{(3)} = \\begin{bmatrix} 0.0 \\\\ 1.0 \\\\ 0.0 \\end{bmatrix}$.\n\nFor each test case, compute:\n- Residual A: $\\max$ over the listed points of the maximum absolute entry of the difference between the material time derivative of $\\mathbf{F}$ and the material gradient of $\\mathbf{v}$, expressed in $1/\\mathrm s$.\n- Residual B: $\\max$ over the listed points of the maximum absolute entry of the difference between the material gradient of $\\mathbf{v}$ and the product of the spatial gradient of $\\mathbf{v}$ with $\\mathbf{F}$, expressed in $1/\\mathrm s$.\n\nFinal output format:\nYour program should produce a single line of output containing the six residuals as a comma-separated list enclosed in square brackets (for example, $\\left[ r_1, r_2, r_3, r_4, r_5, r_6 \\right]$). The entries must be ordered as $\\left[ \\text{Shear Residual A}, \\text{Shear Residual B}, \\text{Rotation Residual A}, \\text{Rotation Residual B}, \\text{Inhomogeneous Residual A}, \\text{Inhomogeneous Residual B} \\right]$, with each value in $1/\\mathrm s$.", "solution": "The solution is presented in two parts as required: first, the analytical derivations of the kinematic relations, and second, the numerical implementation to verify these relations for the specified test cases.\n\n### Part 1: Analytical Derivations\n\nThe core of this problem lies in deriving two fundamental kinematic identities in continuum mechanics. These derivations are based on the provided definitions of the motion map $\\mathbf{x}(\\mathbf{X}, t)$, the deformation gradient $\\mathbf{F}(\\mathbf{X}, t)$, and the material velocity $\\mathbf{v}(\\mathbf{X}, t)$.\n\n**Derivation 1: Material Time Derivative of the Deformation Gradient**\n\nThe first task is to derive an expression for the material time derivative of the deformation gradient, $\\dot{\\mathbf{F}}$, in terms of the material gradient of the velocity, $\\nabla_{\\mathbf{X}} \\mathbf{v}$.\n\nBy definition, the deformation gradient $\\mathbf{F}$ is the tensor whose components are given by the partial derivatives of the spatial coordinates $x_i$ with respect to the material coordinates $X_j$:\n$$\nF_{ij}(\\mathbf{X}, t) = \\frac{\\partial x_i(\\mathbf{X}, t)}{\\partial X_j}\n$$\nThe material time derivative, denoted by a superposed dot, is the partial derivative with respect to time $t$ holding the material coordinate $\\mathbf{X}$ fixed. Applying this to $F_{ij}$:\n$$\n\\dot{F}_{ij} = \\frac{\\partial}{\\partial t} \\left( F_{ij} \\right) = \\frac{\\partial}{\\partial t} \\left( \\frac{\\partial x_i}{\\partial X_j} \\right)\n$$\nThe problem statement assumes that the motion map $\\mathbf{x}(\\mathbf{X}, t)$ and its partial derivatives are continuous in all their arguments. This smoothness condition allows for the interchange of the order of partial differentiation with respect to $t$ and $X_j$:\n$$\n\\dot{F}_{ij} = \\frac{\\partial}{\\partial X_j} \\left( \\frac{\\partial x_i}{\\partial t} \\right)\n$$\nThe material velocity $\\mathbf{v}(\\mathbf{X}, t)$ is defined as the time derivative of the position vector $\\mathbf{x}(\\mathbf{X}, t)$ for a fixed material point $\\mathbf{X}$:\n$$\nv_i(\\mathbf{X}, t) = \\frac{\\partial x_i(\\mathbf{X}, t)}{\\partial t}\n$$\nSubstituting this definition into the expression for $\\dot{F}_{ij}$:\n$$\n\\dot{F}_{ij} = \\frac{\\partial v_i}{\\partial X_j}\n$$\nThe term on the right-hand side, $\\frac{\\partial v_i}{\\partial X_j}$, is the $ij$-th component of the material gradient of the velocity field $\\mathbf{v}$, which is denoted as $\\nabla_{\\mathbf{X}} \\mathbf{v}$. Therefore, in direct tensor notation, we arrive at the first required identity:\n$$\n\\dot{\\mathbf{F}} = \\nabla_{\\mathbf{X}} \\mathbf{v}\n$$\nThis identity shows that the rate of change of the deformation gradient for a material particle is equal to the gradient of the velocity field with respect to the particle's original position.\n\n**Derivation 2: Relation Between Material and Spatial Velocity Gradients**\n\nThe second task is to derive the relationship between the material gradient of velocity, $\\nabla_{\\mathbf{X}} \\mathbf{v}$, and the spatial gradient of velocity, $\\nabla_{\\mathbf{x}} \\mathbf{v}$. The spatial velocity gradient, often denoted by $\\mathbf{L}$, has components $L_{ik} = \\frac{\\partial v_i}{\\partial x_k}$.\n\nThe velocity field can be expressed as a function of material coordinates, $\\mathbf{v}(\\mathbf{X}, t)$, or as a function of spatial coordinates, $\\mathbf{v}(\\mathbf{x}, t)$. These two representations are linked through the motion map: $\\mathbf{v}(\\mathbf{X}, t) = \\mathbf{v}(\\mathbf{x}(\\mathbf{X}, t), t)$.\n\nWe start with the component form of the material velocity gradient, which we found in the first derivation:\n$$\n(\\nabla_{\\mathbf{X}} \\mathbf{v})_{ij} = \\frac{\\partial v_i(\\mathbf{x}(\\mathbf{X}, t), t)}{\\partial X_j}\n$$\nTo evaluate this derivative, we apply the chain rule for multivariable functions, treating $v_i$ as a function of $\\mathbf{x}$, which in turn is a function of $\\mathbf{X}$:\n$$\n\\frac{\\partial v_i}{\\partial X_j} = \\sum_{k=1}^{3} \\frac{\\partial v_i}{\\partial x_k} \\frac{\\partial x_k}{\\partial X_j}\n$$\nLet's identify the terms in this summation:\n- The term $\\frac{\\partial v_i}{\\partial x_k}$ is the $ik$-th component of the spatial velocity gradient, $\\mathbf{L} = \\nabla_{\\mathbf{x}} \\mathbf{v}$.\n- The term $\\frac{\\partial x_k}{\\partial X_j}$ is the $kj$-th component of the deformation gradient, $\\mathbf{F}$.\n\nSubstituting these back into the summation gives:\n$$\n(\\nabla_{\\mathbf{X}} \\mathbf{v})_{ij} = \\sum_{k=1}^{3} L_{ik} F_{kj}\n$$\nThis summation is precisely the definition of the $ij$-th component of the matrix product of $\\mathbf{L}$ and $\\mathbf{F}$. Thus, in direct tensor notation, we have the second required identity:\n$$\n\\nabla_{\\mathbf{X}} \\mathbf{v} = (\\nabla_{\\mathbf{x}} \\mathbf{v}) \\cdot \\mathbf{F} \\quad \\text{or} \\quad \\nabla_{\\mathbf{X}} \\mathbf{v} = \\mathbf{L} \\mathbf{F}\n$$\nCombining the two derived identities, we obtain the fundamental relation $\\dot{\\mathbf{F}} = \\mathbf{L} \\mathbf{F}$, which is a cornerstone of kinematic analysis in continuum mechanics.\n\n### Part 2: Numerical Verification\n\nThe derived identities, $\\dot{\\mathbf{F}} = \\nabla_{\\mathbf{X}} \\mathbf{v}$ and $\\nabla_{\\mathbf{X}} \\mathbf{v} = (\\nabla_{\\mathbf{x}} \\mathbf{v}) \\cdot \\mathbf{F}$, are exact analytical relationships. The numerical implementation will verify that for the given test cases, the difference between the left-hand side and the right-hand side of these equations is zero, up to floating-point precision.\n\n- **Residual A** corresponds to the first identity: $\\text{Residual A} = \\max_{\\mathbf{X}^{(k)}} \\| \\dot{\\mathbf{F}} - \\nabla_{\\mathbf{X}} \\mathbf{v} \\|_{\\max}$.\n- **Residual B** corresponds to the second identity: $\\text{Residual B} = \\max_{\\mathbf{X}^{(k)}} \\| \\nabla_{\\mathbf{X}} \\mathbf{v} - (\\nabla_{\\mathbf{x}} \\mathbf{v}) \\cdot \\mathbf{F} \\|_{\\max}$.\n\nFor each test case, we must first compute the analytical expressions for the required tensors ($\\mathbf{F}$, $\\dot{\\mathbf{F}}$, $\\nabla_{\\mathbf{X}}\\mathbf{v}$, and $\\nabla_{\\mathbf{x}}\\mathbf{v}$), then evaluate them at the specified time and material points, and finally compute the residuals. The analytical derivations for each case confirm that both residual matrices are identically zero. The Python code below implements these calculations. The resulting non-zero residuals are attributable solely to floating-point arithmetic errors.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef calculate_residuals_case1():\n    \"\"\"Calculates residuals for Test Case 1 (time-dependent simple shear).\"\"\"\n    t = 0.5\n    points = [\n        np.array([0.4, -0.3, 0.2]),\n        np.array([1.0, 0.0, -0.5]),\n        np.array([0.0, 0.0, 0.0]),\n    ]\n    max_res_A = 0.0\n    max_res_B = 0.0\n\n    for X in points:\n        # Material time derivative of F\n        F_dot = np.array([[0.0, 2 * t, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0]])\n\n        # Material gradient of velocity\n        # v = [2*t*X2, 0, 0], so grad_X(v) is independent of X\n        grad_v_mat = np.array([[0.0, 2 * t, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0]])\n\n        # Deformation gradient F\n        F = np.array([[1.0, t**2, 0.0], [0.0, 1.0, 0.0], [0.0, 0.0, 1.0]])\n\n        # Spatial gradient of velocity L\n        # x = [X1 + t^2*X2, X2, X3] => X2 = x2\n        # v_spatial = [2*t*x2, 0, 0], grad_x(v_spatial) is independent of x\n        grad_v_spa = np.array([[0.0, 2 * t, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0]])\n\n        # Residual matrices\n        res_A_matrix = F_dot - grad_v_mat\n        res_B_matrix = grad_v_mat - grad_v_spa @ F\n\n        # Maximum absolute entrywise norms\n        current_res_A = np.max(np.abs(res_A_matrix))\n        current_res_B = np.max(np.abs(res_B_matrix))\n\n        max_res_A = max(max_res_A, current_res_A)\n        max_res_B = max(max_res_B, current_res_B)\n        \n    return max_res_A, max_res_B\n    \ndef calculate_residuals_case2():\n    \"\"\"Calculates residuals for Test Case 2 (planar rigid rotation).\"\"\"\n    t = 0.2\n    omega = 3.0\n    points = [\n        np.array([0.7, 0.2, 0.0]),\n        np.array([-0.5, 1.0, 0.3]),\n        np.array([0.0, 0.0, 0.0]),\n    ]\n    max_res_A = 0.0\n    max_res_B = 0.0\n\n    theta = omega * t\n    ct, st = np.cos(theta), np.sin(theta)\n\n    for X in points:\n        # F = R(t), so F_dot = R_dot(t)\n        R_dot = omega * np.array([[-st, -ct, 0.0], [ct, -st, 0.0], [0.0, 0.0, 0.0]])\n        F_dot = R_dot\n\n        # v = R_dot * X, so grad_X(v) = R_dot\n        grad_v_mat = R_dot\n\n        # F = R(t)\n        F = np.array([[ct, -st, 0.0], [st, ct, 0.0], [0.0, 0.0, 1.0]])\n\n        # L = R_dot * R^T, independent of x\n        grad_v_spa = omega * np.array([[0.0, -1.0, 0.0], [1.0, 0.0, 0.0], [0.0, 0.0, 0.0]])\n\n        # Residual matrices\n        res_A_matrix = F_dot - grad_v_mat\n        res_B_matrix = grad_v_mat - grad_v_spa @ F\n\n        # Maximum absolute entrywise norms\n        current_res_A = np.max(np.abs(res_A_matrix))\n        current_res_B = np.max(np.abs(res_B_matrix))\n\n        max_res_A = max(max_res_A, current_res_A)\n        max_res_B = max(max_res_B, current_res_B)\n        \n    return max_res_A, max_res_B\n\ndef calculate_residuals_case3():\n    \"\"\"Calculates residuals for Test Case 3 (inhomogeneous stretch-shear).\"\"\"\n    t = 0.4\n    alpha = 1.2\n    beta = 0.8\n    points = [\n        np.array([0.6, 0.5, -0.2]),\n        np.array([1.2, -0.4, 0.1]),\n        np.array([0.0, 1.0, 0.0]),\n    ]\n    max_res_A = 0.0\n    max_res_B = 0.0\n\n    for X in points:\n        X1, X2, X3 = X\n        eat = np.exp(alpha * t)\n\n        # F_dot depends on X\n        F_dot = np.array([\n            [alpha * eat, 0.0, 0.0],\n            [beta * X2, beta * X1, 0.0],\n            [0.0, 0.0, 0.0]\n        ])\n\n        # grad_v_mat depends on X\n        # v = [alpha*eat*X1, beta*X1*X2, 0]\n        grad_v_mat = np.array([\n            [alpha * eat, 0.0, 0.0],\n            [beta * X2, beta * X1, 0.0],\n            [0.0, 0.0, 0.0]\n        ])\n        \n        # F depends on X\n        F = np.array([\n            [eat, 0.0, 0.0],\n            [beta * t * X2, 1 + beta * t * X1, 0.0],\n            [0.0, 0.0, 1.0]\n        ])\n\n        # grad_v_spa depends on X, via the mapping x(X)\n        denom = 1 + beta * t * X1\n        grad_v_spa_21 = (beta * X2 * np.exp(-alpha * t)) / denom\n        grad_v_spa_22 = (beta * X1) / denom\n        grad_v_spa = np.array([\n            [alpha, 0.0, 0.0],\n            [grad_v_spa_21, grad_v_spa_22, 0.0],\n            [0.0, 0.0, 0.0]\n        ])\n\n        # Residual matrices\n        res_A_matrix = F_dot - grad_v_mat\n        res_B_matrix = grad_v_mat - grad_v_spa @ F\n        \n        # Maximum absolute entrywise norms\n        current_res_A = np.max(np.abs(res_A_matrix))\n        current_res_B = np.max(np.abs(res_B_matrix))\n\n        max_res_A = max(max_res_A, current_res_A)\n        max_res_B = max(max_res_B, current_res_B)\n        \n    return max_res_A, max_res_B\n\ndef solve():\n    \"\"\"Main function to solve the problem and print results.\"\"\"\n    # Test Case 1\n    res_A_1, res_B_1 = calculate_residuals_case1()\n    \n    # Test Case 2\n    res_A_2, res_B_2 = calculate_residuals_case2()\n    \n    # Test Case 3\n    res_A_3, res_B_3 = calculate_residuals_case3()\n\n    results = [res_A_1, res_B_1, res_A_2, res_B_2, res_A_3, res_B_3]\n\n    print(f\"[{','.join(f'{r:.1e}' for r in results)}]\")\n\nsolve()\n```", "id": "3579907"}]}