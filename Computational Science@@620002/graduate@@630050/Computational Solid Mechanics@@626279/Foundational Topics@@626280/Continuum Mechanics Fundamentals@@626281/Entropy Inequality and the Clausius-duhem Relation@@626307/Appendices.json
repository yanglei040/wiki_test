{"hands_on_practices": [{"introduction": "The second law of thermodynamics, in the form of the Clausius-Duhem inequality, provides a fundamental constraint on all physical processes. To begin our hands-on exploration, we first bridge the abstract principles of thermodynamics with the concrete quantities of continuum mechanics. This practice [@problem_id:3562449] guides you through a derivation for a simplified, isothermal process to isolate the core relationship between the work done by stresses, $\\boldsymbol{\\sigma}:\\mathbf{d}$, and the change in stored energy, leading directly to the concept of mechanical dissipation.", "problem": "Consider a continuum body undergoing a homogeneous, isothermal process at constant absolute temperature $T$ with negligible body forces, no volumetric heat sources, and zero heat flux. Let the local kinematics be described by the velocity gradient $\\mathbf{L}$ with symmetric part $\\mathbf{d} = \\frac{1}{2}(\\mathbf{L} + \\mathbf{L}^{\\mathsf{T}})$, and let the local stress be the Cauchy stress tensor $\\boldsymbol{\\sigma}$. Assume that at a material point the tensors $\\boldsymbol{\\sigma}$ and $\\mathbf{d}$ share a common principal basis and are diagonal, with $\\boldsymbol{\\sigma} = \\mathrm{diag}(\\sigma_1,\\sigma_2,\\sigma_3)$ and $\\mathbf{d} = \\mathrm{diag}(d_1,d_2,d_3)$, where $\\sigma_i$ and $d_i$ are the principal stress components and principal rates of deformation, respectively.\n\nStarting from the balance of energy (first law of thermodynamics) and the local form of the second law of thermodynamics (entropy inequality), and introducing the specific Helmholtz free energy $\\psi = e - T s$ (where $e$ is the specific internal energy and $s$ is the specific entropy), derive the specialized form of the Clausius-Duhem relation for the present isothermal, homogeneous, no-heat-flux setting, identifying the mechanical dissipation density in terms of $\\boldsymbol{\\sigma}:\\mathbf{d}$ and $\\rho \\dot{\\psi}$, where $\\rho$ is the mass density. Then, compute the stress power $\\boldsymbol{\\sigma}:\\mathbf{d}$ for the given diagonal tensors. Finally, use the derived inequality to interpret the sign of $\\boldsymbol{\\sigma}:\\mathbf{d}$ in terms of whether the process produces energy within the material (e.g., increases stored free energy or dissipates) or consumes energy (e.g., the material does net work on the surroundings by reducing stored free energy).\n\nExpress your final answer as a single closed-form analytic expression for $\\boldsymbol{\\sigma}:\\mathbf{d}$ in terms of $\\sigma_1$, $\\sigma_2$, $\\sigma_3$, $d_1$, $d_2$, and $d_3. No numerical evaluation is requested.", "solution": "The problem is validated as being scientifically grounded, well-posed, and objective. It is a standard derivation in continuum thermomechanics. All necessary information is provided, and the assumptions are consistent and physically reasonable within the context of theoretical mechanics. The problem is solvable.\n\nWe begin the derivation from the local form of the first and second laws of thermodynamics.\n\nThe first law of thermodynamics, or the balance of energy, in its local form for a continuum is given by:\n$$\n\\rho \\dot{e} = \\boldsymbol{\\sigma}:\\mathbf{d} - \\nabla \\cdot \\mathbf{q} + \\rho r\n$$\nwhere $\\rho$ is the mass density, $\\dot{e}$ is the material time derivative of the specific internal energy $e$, $\\boldsymbol{\\sigma}$ is the Cauchy stress tensor, $\\mathbf{d}$ is the rate of deformation tensor (the symmetric part of the velocity gradient $\\mathbf{L}$), $\\mathbf{q}$ is the heat flux vector, and $r$ is the specific heat supply rate (volumetric heat source per unit mass).\n\nThe second law of thermodynamics, expressed as the local entropy inequality, is:\n$$\n\\rho \\dot{s} \\ge - \\nabla \\cdot \\left(\\frac{\\mathbf{q}}{T}\\right) + \\frac{\\rho r}{T}\n$$\nwhere $\\dot{s}$ is the material time derivative of the specific entropy $s$ and $T$ is the absolute temperature.\n\nThe problem specifies several simplifying conditions:\n1.  The process is isothermal, so the temperature $T$ is constant, which implies $\\dot{T} = 0$.\n2.  There are no volumetric heat sources, so $r = 0$.\n3.  The heat flux is zero, so $\\mathbf{q} = \\mathbf{0}$. This also implies that its divergence is zero, $\\nabla \\cdot \\mathbf{q} = 0$.\n\nApplying these conditions to the balance of energy equation, we get:\n$$\n\\rho \\dot{e} = \\boldsymbol{\\sigma}:\\mathbf{d}\n$$\nThis states that under these adiabatic conditions, the rate of change of internal energy is equal to the stress power per unit volume.\n\nApplying the same conditions to the entropy inequality, we find that the term $\\frac{\\rho r}{T}$ is zero, and the term $\\nabla \\cdot \\left(\\frac{\\mathbf{q}}{T}\\right)$ is also zero since $\\mathbf{q} = \\mathbf{0}$ and $T$ is spatially constant (due to homogeneity of the process). The inequality simplifies to:\n$$\n\\rho \\dot{s} \\ge 0\n$$\n\nNext, we introduce the specific Helmholtz free energy, $\\psi$, defined as:\n$$\n\\psi = e - T s\n$$\nWe take the material time derivative of $\\psi$:\n$$\n\\dot{\\psi} = \\dot{e} - \\dot{T}s - T \\dot{s}\n$$\nSince the process is isothermal, $\\dot{T} = 0$, and the expression simplifies to:\n$$\n\\dot{\\psi} = \\dot{e} - T \\dot{s}\n$$\nThis equation can be rearranged to express the rate of change of internal energy, $\\dot{e}$, or the entropy production term, $T\\dot{s}$:\n$$\n\\dot{e} = \\dot{\\psi} + T \\dot{s} \\quad \\text{or} \\quad T \\dot{s} = \\dot{e} - \\dot{\\psi}\n$$\n\nNow, we substitute the simplified energy balance, $\\rho \\dot{e} = \\boldsymbol{\\sigma}:\\mathbf{d}$, into the expression for $T\\dot{s}$:\n$$\nT \\dot{s} = \\frac{1}{\\rho}(\\boldsymbol{\\sigma}:\\mathbf{d}) - \\dot{\\psi}\n$$\nMultiplying by $\\rho$, we get:\n$$\n\\rho T \\dot{s} = \\boldsymbol{\\sigma}:\\mathbf{d} - \\rho \\dot{\\psi}\n$$\nThe simplified entropy inequality is $\\rho \\dot{s} \\ge 0$. Since $T > 0$, this is equivalent to $\\rho T \\dot{s} \\ge 0$. Substituting our expression for $\\rho T \\dot{s}$ yields the specialized form of the Clausius-Duhem relation for this process:\n$$\n\\boldsymbol{\\sigma}:\\mathbf{d} - \\rho \\dot{\\psi} \\ge 0\n$$\nThe quantity $\\mathcal{D}_{\\text{mech}} = \\boldsymbol{\\sigma}:\\mathbf{d} - \\rho \\dot{\\psi}$ is the mechanical dissipation density. It represents the portion of the stress power per unit volume, $\\boldsymbol{\\sigma}:\\mathbf{d}$, that is not stored as reversible free energy (the term $\\rho \\dot{\\psi}$) and is therefore dissipated, in this case converted into entropy. The inequality states that this dissipation must be non-negative.\n\nThe second part of the problem requires computing the stress power, $\\boldsymbol{\\sigma}:\\mathbf{d}$. The double-dot product of two second-order tensors $\\mathbf{A}$ and $\\mathbf{B}$ is defined as $\\mathbf{A}:\\mathbf{B} = \\mathrm{tr}(\\mathbf{A}^{\\mathsf{T}}\\mathbf{B})$. Since both $\\boldsymbol{\\sigma}$ and $\\mathbf{d}$ are symmetric, this is simply $\\mathrm{tr}(\\boldsymbol{\\sigma}\\mathbf{d})$. The problem states that in a common principal basis, the tensors are diagonal:\n$$\n\\boldsymbol{\\sigma} = \\mathrm{diag}(\\sigma_1, \\sigma_2, \\sigma_3) \\quad \\text{and} \\quad \\mathbf{d} = \\mathrm{diag}(d_1, d_2, d_3)\n$$\nIn this basis, the matrix product $\\boldsymbol{\\sigma}\\mathbf{d}$ is also diagonal:\n$$\n\\boldsymbol{\\sigma}\\mathbf{d} = \\begin{pmatrix} \\sigma_1 & 0 & 0 \\\\ 0 & \\sigma_2 & 0 \\\\ 0 & 0 & \\sigma_3 \\end{pmatrix} \\begin{pmatrix} d_1 & 0 & 0 \\\\ 0 & d_2 & 0 \\\\ 0 & 0 & d_3 \\end{pmatrix} = \\begin{pmatrix} \\sigma_1 d_1 & 0 & 0 \\\\ 0 & \\sigma_2 d_2 & 0 \\\\ 0 & 0 & \\sigma_3 d_3 \\end{pmatrix}\n$$\nThe trace of this product matrix is the sum of its diagonal elements:\n$$\n\\boldsymbol{\\sigma}:\\mathbf{d} = \\mathrm{tr}(\\boldsymbol{\\sigma}\\mathbf{d}) = \\sigma_1 d_1 + \\sigma_2 d_2 + \\sigma_3 d_3\n$$\nThis is the closed-form analytic expression for the stress power.\n\nFinally, we interpret the sign of $\\boldsymbol{\\sigma}:\\mathbf{d}$ using the inequality $\\boldsymbol{\\sigma}:\\mathbf{d} \\ge \\rho \\dot{\\psi}$.\nThe term $\\boldsymbol{\\sigma}:\\mathbf{d}$ represents the rate of work per unit volume done by the stresses *on* the material.\nThe term $\\rho \\dot{\\psi}$ represents the rate of increase of stored (recoverable) free energy per unit volume.\n- If $\\boldsymbol{\\sigma}:\\mathbf{d} > 0$, the surroundings are doing positive work on the material. This supplied energy is partitioned into an increase in stored free energy ($\\rho \\dot{\\psi}$) and dissipation ($\\mathcal{D}_{\\text{mech}} \\ge 0$). This corresponds to a process that consumes energy from the outside and either stores it or dissipates it, thus \"producing\" an increase in the energy content (stored or dissipated) of the material.\n- If $\\boldsymbol{\\sigma}:\\mathbf{d} < 0$, the material is doing net work on its surroundings. For this to happen, the inequality $\\boldsymbol{\\sigma}:\\mathbf{d} \\ge \\rho \\dot{\\psi}$ must hold. This implies $\\rho \\dot{\\psi}$ must be negative and its magnitude must be greater than or equal to the magnitude of the dissipation plus the magnitude of the work done. Specifically, $\\rho \\dot{\\psi} \\le \\boldsymbol{\\sigma}:\\mathbf{d} < 0$. This means the material is releasing its stored free energy ($\\dot{\\psi} < 0$) at a rate sufficient to perform work on the surroundings and cover any internal dissipation. This corresponds to a process where the material \"consumes\" its own stored energy to produce work.", "answer": "$$\n\\boxed{\\sigma_1 d_1 + \\sigma_2 d_2 + \\sigma_3 d_3}\n$$", "id": "3562449"}, {"introduction": "With the foundational principles established, the next step is to apply them to a specific constitutive model, a crucial task in computational mechanics for model validation and verification. This exercise [@problem_id:3562507] involves deriving the precise form of the dissipation for a common thermo-viscoelastic material model. By doing so, you will construct an analytical benchmark problem, providing an exact solution against which the accuracy of a numerical simulation can be rigorously tested.", "problem": "Consider a one-dimensional homogeneous thermo-viscoelastic solid bar undergoing small strains, where the local thermodynamic framework is used to derive and benchmark the entropy production required by the Clausius-Duhem inequality (Clausius-Duhem). The derivation must start from fundamental balance laws and constitutive assumptions that are standard in computational solid mechanics. Work in the per-unit-volume description. The task is to derive, specialize, and then evaluate an analytical benchmark for the instantaneous entropy production density that can be used to verify the implementation of the Clausius-Duhem inequality in a computational solid mechanics code.\n\nFundamental base:\n- Local energy balance (First Law of Thermodynamics): the rate of change of internal energy per unit volume is equal to mechanical power minus the divergence of heat flux plus volumetric heat source. Let the internal energy per unit volume be $u$, the Cauchy stress be $\\sigma$, the small-strain rate tensor be $D$, the heat flux be $q$, and the volumetric heat source be $r_v$. Then,\n$$\\dot{u} = \\sigma : D - \\nabla \\cdot q + r_v.$$\n- Helmholtz free energy per unit volume is defined by $\\phi = u - T \\eta$, where $T$ is the absolute temperature and $\\eta$ is the entropy per unit volume.\n- Local entropy inequality (Second Law of Thermodynamics) in differential form,\n$$\\dot{\\eta} \\ge -\\nabla \\cdot \\left(\\frac{q}{T}\\right) + \\frac{r_v}{T}.$$\n- Kinematics: one-dimensional small-strain bar with strain $\\varepsilon(t)$ and strain rate $\\dot{\\varepsilon}(t)$, so that in one dimension $\\sigma : D = \\sigma \\, \\dot{\\varepsilon}$.\n\nConstitutive assumptions:\n- Linear Kelvin-Voigt viscoelasticity (uniaxial): $\\sigma = E \\, \\varepsilon + \\eta_v \\, \\dot{\\varepsilon}$, where $E$ is the Young’s modulus and $\\eta_v$ is the viscosity coefficient (Pascal-second).\n- Fourier’s law of heat conduction: $q = -k \\, \\nabla T$, where $k$ is the thermal conductivity (W per meter per Kelvin).\n- Helmholtz free energy per unit volume for thermoelasticity with separable caloric part:\n$$\\phi(\\varepsilon, T) = \\frac{1}{2} E \\, \\varepsilon^2 + c_v \\left( T - T_{\\mathrm{ref}} - T \\ln \\frac{T}{T_{\\mathrm{ref}}} \\right),$$\nwhere $c_v$ is the volumetric heat capacity per unit volume (J per meter cubed per Kelvin) and $T_{\\mathrm{ref}}$ is a strictly positive reference temperature in Kelvin. Define entropy per unit volume by $\\eta = -\\partial \\phi/\\partial T$.\n\nScenario to benchmark:\n- The strain is prescribed as $\\varepsilon(t) = A \\sin(\\omega t)$, with amplitude $A$ (dimensionless) and angular frequency $\\omega$ (radians per second). Therefore $\\dot{\\varepsilon}(t) = A \\omega \\cos(\\omega t)$.\n- The temperature field is composed of a time-periodic uniform component and an optional constant spatial gradient. Let\n$$T(x,t) = T_0 + B \\cos(\\omega t) + G x,$$\nwhere $T_0$ is a baseline temperature in Kelvin, $B$ is a temperature oscillation amplitude in Kelvin, $G$ is a constant temperature gradient in Kelvin per meter, and $x$ is the position along the bar in meters. All parameters will be chosen so that $T(x,t)$ remains strictly positive for all cases considered.\n- There is no volumetric heat source, i.e., $r_v = 0$.\n\nYour tasks:\n1) Starting from the local energy balance, the definition of the Helmholtz free energy per unit volume, and the local entropy inequality, derive the Clausius-Duhem inequality in per-unit-volume form that bounds the instantaneous dissipation density. Express the inequality entirely in terms of $\\sigma$, $D$, $\\phi$, $\\eta$, $T$, and $q$.\n2) Specialize the inequality to the one-dimensional Kelvin-Voigt-Fourier model described above, using the given free energy $\\phi(\\varepsilon,T)$, and simplify the dissipation density to a form that isolates the viscous and conductive contributions. Then define the instantaneous entropy production density (per unit volume) from this dissipation in a way that is consistent with the Clausius-Duhem framework.\n3) Using the specialized expression, compute the analytical instantaneous dissipation density and entropy production density at specified times $t^\\star$ and positions $x^\\star$ for the following test suite of parameter values. Use the International System of Units (SI units). Report the dissipation density in watts per meter cubed and the entropy production density in watts per meter cubed per Kelvin. All angles are in radians. For each test, use $T_{\\mathrm{ref}} = 300$ Kelvin and $c_v = 3 \\times 10^6$ joules per meter cubed per Kelvin. The elastic modulus $E$ is provided but does not enter the final entropy production in this benchmark due to the thermodynamic structure; nevertheless, include it as a parameter for completeness.\n\nTest suite (each case lists $(A,\\omega,t^\\star,T_0,B,G,x^\\star,\\eta_v,k,E)$):\n- Case $1$ (happy path, no spatial gradient): $(A=\\;0.01,\\;\\omega=\\;10,\\;t^\\star=\\;0.2,\\;T_0=\\;300,\\;B=\\;5,\\;G=\\;0,\\;x^\\star=\\;0,\\;\\eta_v=\\;1000,\\;k=\\;10,\\;E=\\;10^{9})$.\n- Case $2$ (combined viscous and conductive, positive gradient): $(A=\\;0.01,\\;\\omega=\\;10,\\;t^\\star=\\;0.2,\\;T_0=\\;300,\\;B=\\;5,\\;G=\\;50,\\;x^\\star=\\;1,\\;\\eta_v=\\;1000,\\;k=\\;10,\\;E=\\;10^{9})$.\n- Case $3$ (boundary: zero strain amplitude, conduction only): $(A=\\;0,\\;\\omega=\\;10,\\;t^\\star=\\;0.0,\\;T_0=\\;300,\\;B=\\;0,\\;G=\\;50,\\;x^\\star=\\;2,\\;\\eta_v=\\;1000,\\;k=\\;10,\\;E=\\;10^{9})$.\n- Case $4$ (edge: zero viscosity and zero gradient, purely elastic reversible process): $(A=\\;0.02,\\;\\omega=\\;5,\\;t^\\star=\\;0.3,\\;T_0=\\;300,\\;B=\\;1,\\;G=\\;0,\\;x^\\star=\\;0,\\;\\eta_v=\\;0,\\;k=\\;10,\\;E=\\;10^{9})$.\n\nComputational specification:\n- For each test case, compute $\\dot{\\varepsilon}(t^\\star) = A \\omega \\cos(\\omega t^\\star)$, $T(x^\\star,t^\\star) = T_0 + B \\cos(\\omega t^\\star) + G x^\\star$, and $||\\nabla T||^2 = G^2$ in one dimension. Then evaluate the instantaneous dissipation density and instantaneous entropy production density that arise from your specialized Clausius-Duhem result.\n- Units and outputs: Dissipation density must be computed in watts per meter cubed, and entropy production density must be computed in watts per meter cubed per Kelvin.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element is a two-item list $[\\xi, D]$ with $\\xi$ the entropy production density and $D$ the dissipation density for a given test case, in the order listed above. For example, a valid output format is $[[\\xi_1,D_1],[\\xi_2,D_2],[\\xi_3,D_3],[\\xi_4,D_4]]$ with numerical values replacing the symbols.\n\nNo hints or intermediate formulas should be assumed beyond the fundamental base above. All quantities used must be explicitly defined and derived from the stated base. All physical parameters must be strictly positive where necessary to ensure scientific realism, and the temperature must remain strictly positive in all cases.", "solution": "The problem requires the derivation and evaluation of the instantaneous entropy production density for a one-dimensional thermo-viscoelastic solid, based on the fundamental principles of continuum thermodynamics. The solution proceeds in three parts as requested: first, the derivation of the general Clausius-Duhem inequality; second, its specialization to the specified constitutive model; and third, the numerical evaluation for a given suite of test cases.\n\n### Part 1: Derivation of the Clausius-Duhem Inequality\n\nThe derivation begins with the fundamental laws and definitions provided. All quantities are per unit volume.\n\n1.  **Local Energy Balance (First Law):**\n    $$ \\dot{u} = \\sigma : D - \\nabla \\cdot q + r_v $$\n    Here, $\\dot{u}$ is the rate of change of internal energy density, $\\sigma : D$ is the stress power, $\\nabla \\cdot q$ is the divergence of the heat flux vector $q$, and $r_v$ is the volumetric heat source.\n\n2.  **Helmholtz Free Energy:**\n    The Helmholtz free energy density $\\phi$ is defined as:\n    $$ \\phi = u - T \\eta $$\n    where $T$ is the absolute temperature and $\\eta$ is the entropy density. Taking the material time derivative (denoted by a dot) gives:\n    $$ \\dot{\\phi} = \\dot{u} - \\dot{T}\\eta - T\\dot{\\eta} $$\n    Rearranging for $\\dot{u}$ yields:\n    $$ \\dot{u} = \\dot{\\phi} + \\dot{T}\\eta + T\\dot{\\eta} $$\n\n3.  **Local Entropy Inequality (Second Law):**\n    $$ \\dot{\\eta} \\ge -\\nabla \\cdot \\left(\\frac{q}{T}\\right) + \\frac{r_v}{T} $$\n    The term on the right-hand side represents the entropy flux into the volume and the entropy supply from sources. The inequality states that the rate of entropy change can be greater than the supply, with the difference being the entropy production.\n\n4.  **Combining the Laws:**\n    We substitute the expression for $\\dot{u}$ from the Helmholtz free energy relation into the energy balance equation:\n    $$ \\dot{\\phi} + \\dot{T}\\eta + T\\dot{\\eta} = \\sigma : D - \\nabla \\cdot q + r_v $$\n    This equation can be solved for the term $T\\dot{\\eta}$:\n    $$ T\\dot{\\eta} = \\sigma : D - (\\dot{\\phi} + \\dot{T}\\eta) - \\nabla \\cdot q + r_v $$\n    Next, we expand the divergence term in the entropy inequality using the product rule:\n    $$ \\nabla \\cdot \\left(\\frac{q}{T}\\right) = \\frac{1}{T}\\nabla \\cdot q - \\frac{1}{T^2} q \\cdot \\nabla T $$\n    Substituting this into the entropy inequality gives:\n    $$ \\dot{\\eta} \\ge -\\frac{1}{T}\\nabla \\cdot q + \\frac{1}{T^2} q \\cdot \\nabla T + \\frac{r_v}{T} $$\n    Since temperature $T$ is strictly positive, we can multiply by $T$ without changing the inequality's direction:\n    $$ T\\dot{\\eta} \\ge -\\nabla \\cdot q + \\frac{1}{T} q \\cdot \\nabla T + r_v $$\n    Now, we substitute the expression for $T\\dot{\\eta}$ from the energy balance:\n    $$ \\sigma : D - (\\dot{\\phi} + \\dot{T}\\eta) - \\nabla \\cdot q + r_v \\ge -\\nabla \\cdot q + \\frac{1}{T} q \\cdot \\nabla T + r_v $$\n    The terms $-\\nabla \\cdot q$ and $r_v$ cancel from both sides, leaving the fundamental dissipation inequality, also known as the Clausius-Duhem inequality in this local form:\n    $$ \\sigma : D - (\\dot{\\phi} + \\dot{T}\\eta) - \\frac{1}{T} q \\cdot \\nabla T \\ge 0 $$\n    This inequality states that the sum of mechanical and thermal dissipation must be non-negative. This completes the first task. The expression $\\sigma : D - (\\dot{\\phi} + \\dot{T}\\eta) - \\frac{1}{T} q \\cdot \\nabla T$ represents the dissipation density, which is bounded below by zero.\n\n### Part 2: Specialization and Definition of Entropy Production\n\nNext, we specialize this inequality for the given one-dimensional thermo-viscoelastic model.\n\n1.  **State Variables and Chain Rule:**\n    The Helmholtz free energy $\\phi$ is given as a function of strain $\\varepsilon$ and temperature $T$, i.e., $\\phi(\\varepsilon, T)$. For a one-dimensional problem, the tensor contraction $\\sigma:D$ simplifies to the scalar product $\\sigma \\dot{\\varepsilon}$. The material time derivative of $\\phi$ is found using the chain rule:\n    $$ \\dot{\\phi} = \\frac{\\partial \\phi}{\\partial \\varepsilon} \\dot{\\varepsilon} + \\frac{\\partial \\phi}{\\partial T} \\dot{T} $$\n    Substituting this into the inequality from Part 1:\n    $$ \\sigma \\dot{\\varepsilon} - \\left(\\frac{\\partial \\phi}{\\partial \\varepsilon} \\dot{\\varepsilon} + \\frac{\\partial \\phi}{\\partial T} \\dot{T} + \\eta \\dot{T}\\right) - \\frac{1}{T} q \\cdot \\nabla T \\ge 0 $$\n    Grouping terms by rates:\n    $$ \\left(\\sigma - \\frac{\\partial \\phi}{\\partial \\varepsilon}\\right)\\dot{\\varepsilon} - \\left(\\eta + \\frac{\\partial \\phi}{\\partial T}\\right)\\dot{T} - \\frac{1}{T} q \\cdot \\nabla T \\ge 0 $$\n\n2.  **Thermodynamic Consistency:**\n    The problem provides the constitutive definition for entropy: $\\eta = -\\partial \\phi/\\partial T$. Substituting this into the inequality, the coefficient of $\\dot{T}$ becomes:\n    $$ -\\left(\\eta + \\frac{\\partial \\phi}{\\partial T}\\right) = -\\left(-\\frac{\\partial \\phi}{\\partial T} + \\frac{\\partial \\phi}{\\partial T}\\right) = 0 $$\n    This identity ensures that the material model is thermodynamically consistent and that the rate of temperature change $\\dot{T}$ does not directly contribute to dissipation. The inequality simplifies to:\n    $$ \\left(\\sigma - \\frac{\\partial \\phi}{\\partial \\varepsilon}\\right)\\dot{\\varepsilon} - \\frac{1}{T} q \\cdot \\nabla T \\ge 0 $$\n\n3.  **Applying Constitutive Laws:**\n    We now introduce the specific constitutive assumptions for stress and heat flux.\n    *   The total stress is $\\sigma = E \\varepsilon + \\eta_v \\dot{\\varepsilon}$.\n    *   The free energy is $\\phi(\\varepsilon, T) = \\frac{1}{2} E \\varepsilon^2 + c_v ( T - T_{\\mathrm{ref}} - T \\ln \\frac{T}{T_{\\mathrm{ref}}} )$. The derivative with respect to strain gives the elastic part of the stress: $\\frac{\\partial \\phi}{\\partial \\varepsilon} = E \\varepsilon$.\n    *   The dissipative part of the stress (overstress) is therefore $\\sigma - \\frac{\\partial \\phi}{\\partial \\varepsilon} = (E \\varepsilon + \\eta_v \\dot{\\varepsilon}) - E \\varepsilon = \\eta_v \\dot{\\varepsilon}$.\n    *   Fourier's law for heat conduction is $q = -k \\nabla T$.\n\n    Substituting these into the simplified inequality:\n    $$ (\\eta_v \\dot{\\varepsilon}) \\dot{\\varepsilon} - \\frac{1}{T} (-k \\nabla T) \\cdot \\nabla T \\ge 0 $$\n    Which simplifies to:\n    $$ \\eta_v \\dot{\\varepsilon}^2 + \\frac{k}{T} ||\\nabla T||^2 \\ge 0 $$\n    In one dimension, $||\\nabla T||^2 = (\\frac{\\partial T}{\\partial x})^2$.\n\n4.  **Dissipation and Entropy Production Density:**\n    The term on the left-hand side of the inequality is the instantaneous dissipation density, which we denote as $D_{diss}$. Its units are (J/m³/s) or (W/m³).\n    $$ D_{diss} = \\eta_v \\dot{\\varepsilon}^2 + \\frac{k}{T} \\left(\\frac{\\partial T}{\\partial x}\\right)^2 $$\n    The entropy production density, $\\xi$, is defined as the dissipation density divided by the absolute temperature, $\\xi = D_{diss} / T$. Its units are (W/m³/K).\n    $$ \\xi = \\frac{1}{T}D_{diss} = \\frac{\\eta_v}{T} \\dot{\\varepsilon}^2 + \\frac{k}{T^2} \\left(\\frac{\\partial T}{\\partial x}\\right)^2 $$\n    Both $D_{diss}$ and $\\xi$ must be non-negative. These are the final expressions used for the benchmark evaluation. The elastic modulus $E$ appears in the reversible parts of the stress and free energy, which cancel out in the dissipation expression, as expected.\n\n### Part 3: Evaluation for Benchmark Scenarios\n\nWe use the derived formulas to compute $D_{diss}$ and $\\xi$ for the four test cases.\nGiven the prescribed strain $\\varepsilon(t) = A \\sin(\\omega t)$ and temperature field $T(x,t) = T_0 + B \\cos(\\omega t) + G x$, we first evaluate the necessary components at a given point $(x^\\star, t^\\star)$:\n*   Strain rate: $\\dot{\\varepsilon}(t^\\star) = A \\omega \\cos(\\omega t^\\star)$\n*   Temperature: $T(x^\\star, t^\\star) = T_0 + B \\cos(\\omega t^\\star) + G x^\\star$\n*   Temperature gradient: $\\frac{\\partial T}{\\partial x} = G$ (since $G$ is a constant)\n\n**Case 1:** $(A=0.01, \\omega=10, t^\\star=0.2, T_0=300, B=5, G=0, x^\\star=0, \\eta_v=1000, k=10)$\n*   $\\omega t^\\star = 10 \\times 0.2 = 2.0$ rad\n*   $\\dot{\\varepsilon}(t^\\star) = 0.01 \\times 10 \\cos(2.0) \\approx -0.041615$ s⁻¹\n*   $T(x^\\star, t^\\star) = 300 + 5 \\cos(2.0) + 0 \\times 0 \\approx 297.9193$ K\n*   $G = 0$ K/m\n*   $D_{diss} = 1000 \\times (-0.041615)^2 + \\frac{10}{297.9193} (0)^2 \\approx 1.7318$ W/m³\n*   $\\xi = D_{diss} / T \\approx 1.7318 / 297.9193 \\approx 0.005813$ W/(m³·K)\n\n**Case 2:** $(A=0.01, \\omega=10, t^\\star=0.2, T_0=300, B=5, G=50, x^\\star=1, \\eta_v=1000, k=10)$\n*   $\\omega t^\\star = 2.0$ rad\n*   $\\dot{\\varepsilon}(t^\\star) \\approx -0.041615$ s⁻¹ (same as Case 1)\n*   $T(x^\\star, t^\\star) = 300 + 5 \\cos(2.0) + 50 \\times 1 \\approx 347.9193$ K\n*   $G = 50$ K/m\n*   $D_{diss} = 1000 \\times (-0.041615)^2 + \\frac{10}{347.9193} (50)^2 \\approx 1.7318 + 71.8553 \\approx 73.5871$ W/m³\n*   $\\xi = D_{diss} / T \\approx 73.5871 / 347.9193 \\approx 0.211507$ W/(m³·K)\n\n**Case 3:** $(A=0, \\omega=10, t^\\star=0.0, T_0=300, B=0, G=50, x^\\star=2, \\eta_v=1000, k=10)$\n*   $A=0 \\implies \\dot{\\varepsilon}(t^\\star) = 0$\n*   $T(x^\\star, t^\\star) = 300 + 0 \\cos(0) + 50 \\times 2 = 400.0$ K\n*   $G = 50$ K/m\n*   $D_{diss} = 1000 \\times (0)^2 + \\frac{10}{400.0} (50)^2 = 0 + 0.025 \\times 2500 = 62.5$ W/m³\n*   $\\xi = D_{diss} / T = 62.5 / 400.0 = 0.15625$ W/(m³·K)\n\n**Case 4:** $(A=0.02, \\omega=5, t^\\star=0.3, T_0=300, B=1, G=0, x^\\star=0, \\eta_v=0, k=10)$\n*   $\\eta_v = 0$ and $G = 0$.\n*   This scenario represents a purely thermoelastic process without viscous dissipation or heat conduction due to a temperature gradient.\n*   $D_{diss} = 0 \\times \\dot{\\varepsilon}^2 + \\frac{k}{T} (0)^2 = 0.0$ W/m³\n*   $\\xi = 0.0$ W/(m³·K)\nThis result is expected, as ideal thermoelasticity is a reversible process with zero entropy production.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the instantaneous dissipation density and entropy production density\n    for a one-dimensional thermo-viscoelastic bar under prescribed loading.\n    \"\"\"\n    # Define constant parameters from the problem statement.\n    # T_ref and c_v are part of the free energy definition but do not appear \n    # in the final dissipation expression, similar to E.\n    # T_ref = 300.0  # K\n    # c_v = 3.0e6  # J/(m^3*K)\n\n    # Test suite parameters: (A, omega, t_star, T0, B, G, x_star, eta_v, k, E)\n    test_cases = [\n        # Case 1: Happy path, no spatial gradient\n        (0.01, 10.0, 0.2, 300.0, 5.0, 0.0, 0.0, 1000.0, 10.0, 1e9),\n        # Case 2: Combined viscous and conductive, positive gradient\n        (0.01, 10.0, 0.2, 300.0, 5.0, 50.0, 1.0, 1000.0, 10.0, 1e9),\n        # Case 3: Boundary - zero strain amplitude, conduction only\n        (0.0, 10.0, 0.0, 300.0, 0.0, 50.0, 2.0, 1000.0, 10.0, 1e9),\n        # Case 4: Edge - zero viscosity and zero gradient, reversible process\n        (0.02, 5.0, 0.3, 300.0, 1.0, 0.0, 0.0, 0.0, 10.0, 1e9),\n    ]\n\n    results = []\n\n    for case in test_cases:\n        A, omega, t_star, T0, B, G, x_star, eta_v, k, E = case\n\n        # Calculate intermediate quantities at the specified point (x_star, t_star)\n        \n        # Strain rate: eps_dot(t) = A * omega * cos(omega * t)\n        eps_dot_star = A * omega * np.cos(omega * t_star)\n        \n        # Temperature: T(x,t) = T0 + B * cos(omega * t) + G * x\n        T_star = T0 + B * np.cos(omega * t_star) + G * x_star\n        \n        # Temperature gradient (is constant G)\n        # We need its square for the dissipation calculation\n        grad_T_sq = G**2\n\n        # The problem statement guarantees T > 0 for all cases.\n        # We handle the case T_star = 0 to avoid division by zero, though it won't occur here.\n        if T_star <= 0:\n            raise ValueError(\"Temperature must be strictly positive.\")\n\n        # Calculate dissipation density (D_diss) in W/m^3\n        # D_diss = eta_v * (eps_dot)^2 + (k/T) * (dT/dx)^2\n        viscous_dissipation = eta_v * eps_dot_star**2\n        thermal_dissipation = (k / T_star) * grad_T_sq\n        D_diss = viscous_dissipation + thermal_dissipation\n\n        # Calculate entropy production density (xi) in W/(m^3*K)\n        # xi = D_diss / T\n        xi = D_diss / T_star\n\n        results.append([xi, D_diss])\n\n    # Format the output string as required: [[xi_1,D_1],[xi_2,D_2],...]\n    formatted_results = [f\"[{xi},{D}]\" for xi, D in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "3562507"}, {"introduction": "A central challenge in computational solid mechanics is ensuring that numerical algorithms respect the fundamental laws of physics. Even a constitutively valid material model can produce unphysical results if implemented with a naive time integration scheme. This advanced computational practice [@problem_id:3562407] tasks you with building a benchmark that exposes this very issue—a violation of the discrete Clausius-Duhem inequality—and then implementing a robust, entropy-stable scheme to enforce thermodynamic consistency at the algorithmic level.", "problem": "Consider a one-dimensional small-strain thermo-viscoplastic material undergoing a rapid strain ramp. The local thermomechanical model is per unit volume and adopts the following fundamental base: the local form of the First Law of Thermodynamics (energy balance) and the Second Law of Thermodynamics, which implies the Clausius-Duhem (CD) inequality. The CD inequality per unit volume can be written as\n$$\n\\mathcal{D} = \\sigma \\, \\dot{\\varepsilon} - \\dot{\\psi} - \\eta \\, \\dot{T} \\ge 0,\n$$\nwhere $\\,\\sigma\\,$ is the Cauchy stress, $\\,\\varepsilon\\,$ is the total strain, $\\,\\psi\\,$ is the Helmholtz free energy density, $\\,\\eta\\,$ is the entropy density, and $\\,T\\,$ is the absolute temperature. Assume no heat conduction or external heat sources and express all quantities per unit volume. For a small-strain one-dimensional setting, take the free energy density as\n$$\n\\psi(\\varepsilon_e, T) = \\tfrac{1}{2} E \\, \\varepsilon_e^2 \\;+\\; c \\left[T - T_0 - T \\ln\\!\\left(\\tfrac{T}{T_0}\\right)\\right],\n$$\nwith $\\,\\varepsilon_e = \\varepsilon - \\varepsilon_p\\,$ the elastic strain, $\\,\\varepsilon_p\\,$ the plastic strain, $\\,E\\,$ the elastic modulus, $\\,c\\,$ the heat capacity per unit volume (assumed constant), and $\\,T_0\\,$ the reference temperature. The stress is $\\,\\sigma = E \\,\\varepsilon_e\\,$ and the entropy density is\n$$\n\\eta(T) = c \\,\\ln\\!\\left(\\tfrac{T}{T_0}\\right).\n$$\n\nPlastic flow is governed by a Perzyna-type overstress model in one dimension,\n$$\n\\dot{\\varepsilon}_p = \\frac{\\gamma}{E}\\,\\left\\langle |\\sigma| - \\sigma_y(T) \\right\\rangle \\,\\mathrm{sign}(\\sigma),\n$$\nwhere $\\,\\gamma\\,$ is a viscosity-like parameter, $\\,\\sigma_y(T) = \\sigma_{y0}\\,\\max\\{1 - \\beta (T-T_0),\\, \\underline{\\kappa}\\}\\,$ is the temperature-dependent yield stress with floor $\\,\\underline{\\kappa}\\in(0,1)\\,$ to prevent vanishing yield stress, and $\\,\\langle x\\rangle = \\max\\{x,0\\}\\,$ denotes the ramp function. The adiabatic temperature evolution is\n$$\n\\dot{T} = \\frac{\\chi}{c}\\,\\sigma\\,\\dot{\\varepsilon}_p,\n$$\nwhere $\\,\\chi \\in [0,1]\\,$ is the Taylor-Quinney coefficient (fraction of plastic work converted to heat).\n\nYou will construct a time-integration benchmark that exposes a violation of the discrete form of the CD inequality under a naive explicit scheme during fast thermal transients in viscoplasticity, and then fix it via an entropy-stable time integration or via an entropy limiter.\n\nLet the imposed total strain history be a ramp\n$$\n\\varepsilon(t) = \\varepsilon_\\mathrm{final}\\,\\min\\!\\left(\\frac{t}{t_\\mathrm{ramp}},\\,1\\right),\n$$\nwith $\\,\\varepsilon_\\mathrm{final} > 0\\,$ and $\\,t_\\mathrm{ramp} > 0\\,$. The total simulation time is $\\,t_\\mathrm{end} > t_\\mathrm{ramp}\\,$. Use the following parameters (all in International System of Units (SI)):\n- $\\,E = 2.0\\times 10^{11}\\,$ Pa,\n- $\\,c = 3.5\\times 10^{6}\\,$ J$\\cdot$m$^{-3}\\cdot$K$^{-1}$,\n- $\\,T_0 = 300\\,$ K,\n- $\\,\\sigma_{y0} = 4.0\\times 10^{8}\\,$ Pa,\n- $\\,\\beta = 1.0\\times 10^{-3}\\,$ K$^{-1}$,\n- $\\,\\underline{\\kappa} = 0.2\\,$ (dimensionless floor),\n- $\\,\\gamma = 5.0\\times 10^{3}\\,$ s$^{-1}$,\n- $\\,\\chi = 0.9\\,$ (dimensionless),\n- $\\,\\varepsilon_\\mathrm{final} = 0.02\\,$ (dimensionless),\n- $\\,t_\\mathrm{ramp} = 1.0\\times 10^{-4}\\,$ s,\n- $\\,t_\\mathrm{end} = 2.0\\times 10^{-4}\\,$ s.\n\nDefine the discrete per-step entropy production for a time step $\\,n\\to n+1\\,$ with time increment $\\,\\Delta t\\,$ as\n$$\n\\mathcal{D}^{(n)} = \\sigma^{(n)}\\,\\frac{\\varepsilon^{(n+1)} - \\varepsilon^{(n)}}{\\Delta t}\\; -\\; \\frac{\\psi^{(n+1)} - \\psi^{(n)}}{\\Delta t}\\; -\\; \\eta^{(n)}\\,\\frac{T^{(n+1)} - T^{(n)}}{\\Delta t},\n$$\nfor the naive explicit scheme. This choice evaluates the stress and entropy at the previous time level and the free energy change over the step, known to produce spurious negative values at large $\\,\\Delta t\\,$ during rapid transients due to a mismatch in the elastic energy balance.\n\nFor the entropy-stable variant, use the following discrete production and update:\n- Midpoint stress $\\,\\sigma^\\mathrm{avg} = \\tfrac{1}{2}\\left(\\sigma^{(n)} + \\sigma^{(n+1)}\\right)\\,$,\n- Discrete gradient for thermal part $\\,\\eta^\\mathrm{dg} = -\\dfrac{\\psi_\\mathrm{th}(T^{(n+1)}) - \\psi_\\mathrm{th}(T^{(n)})}{T^{(n+1)} - T^{(n)}}\\,$ if $\\,T^{(n+1)} \\ne T^{(n)}\\,$, and $\\,\\eta^\\mathrm{dg} = \\eta(T^{(n)})\\,$ otherwise,\n- Entropy-stable per-step production\n$$\n\\mathcal{D}_\\mathrm{es}^{(n)} = \\sigma^\\mathrm{avg}\\,\\frac{\\varepsilon^{(n+1)} - \\varepsilon^{(n)}}{\\Delta t}\\; -\\; \\frac{\\psi^{(n+1)} - \\psi^{(n)}}{\\Delta t}\\; -\\; \\eta^\\mathrm{dg}\\,\\frac{T^{(n+1)} - T^{(n)}}{\\Delta t},\n$$\nand update the temperature using midpoint plastic power\n$$\nT^{(n+1)} = T^{(n)} + \\frac{\\chi}{c}\\,\\sigma^\\mathrm{avg}\\,\\Delta \\varepsilon_p,\n$$\nwhere $\\,\\Delta \\varepsilon_p = \\varepsilon_p^{(n+1)} - \\varepsilon_p^{(n)}\\,$ is the plastic strain increment over the step.\n\nFor the entropy limiter variant, keep the naive explicit evaluation of $\\,\\mathcal{D}^{(n)}\\,$, but if $\\,\\mathcal{D}^{(n)} < 0\\,$, adjust the plastic increment $\\,\\Delta \\varepsilon_p\\,$ within the step so that $\\,\\mathcal{D}^{(n)} \\ge 0\\,$. One algebraic limiter derived from the discrete elastic mismatch sets $\\,\\Delta \\varepsilon_p\\,$ to\n$$\n\\Delta \\varepsilon_p^\\star = \\left(\\Delta \\varepsilon + \\varepsilon_e^{(n)}\\right) - \\sqrt{\\max\\left\\{\\varepsilon_e^{(n)}\\left(2\\Delta \\varepsilon + \\varepsilon_e^{(n)}\\right),\\,0\\right\\}},\n$$\nand then clamps it to $\\,\\Delta \\varepsilon_p \\leftarrow \\min\\left\\{\\Delta \\varepsilon,\\,\\max\\left\\{\\Delta \\varepsilon_p,\\,\\Delta \\varepsilon_p^\\star\\right\\}\\right\\}\\,$, with $\\,\\varepsilon_e^{(n)} = \\varepsilon^{(n)} - \\varepsilon_p^{(n)}\\,$. After changing $\\,\\Delta \\varepsilon_p\\,$, recompute $\\,\\sigma^{(n+1)}\\,$, $\\,T^{(n+1)}\\,$, and $\\,\\mathcal{D}^{(n)}\\,$ consistently for the step.\n\nImplement a program that simulates the above model for three test cases using the specified parameters and the strain ramp:\n1. Naive explicit scheme with $\\,\\Delta t = 2.0\\times 10^{-5}\\,$ s.\n2. Entropy-stable scheme with $\\,\\Delta t = 2.0\\times 10^{-5}\\,$ s.\n3. Naive explicit scheme with the entropy limiter with $\\,\\Delta t = 2.0\\times 10^{-5}\\,$ s.\n\nFor each case, simulate from $\\,t=0\\,$ to $\\,t=t_\\mathrm{end}\\,$, record the per-step discrete production $\\,\\mathcal{D}^{(n)}\\,$ (or $\\,\\mathcal{D}_\\mathrm{es}^{(n)}\\,$ for the entropy-stable case), and report the minimum value over all time steps. Express the final results in watts per cubic meter (W/m$^3$), as floating-point numbers. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[\\text{result1},\\text{result2},\\text{result3}]$).", "solution": "The derivation begins with the fundamental laws applied to a one-dimensional continuum under small-strain assumptions. Per unit volume, the First Law of Thermodynamics (the energy balance without conduction or external sources) and the Second Law of Thermodynamics imply the Clausius-Duhem (CD) inequality\n$$\n\\mathcal{D} = \\sigma\\,\\dot{\\varepsilon} - \\dot{\\psi} - \\eta\\,\\dot{T} \\ge 0,\n$$\nwhere $\\,\\psi\\,$ is the Helmholtz free energy density, $\\,\\eta\\,$ is the entropy density, $\\,\\sigma\\,$ the stress, and $\\,\\varepsilon\\,$ the total strain.\n\nWe adopt a separable free energy density per unit volume,\n$$\n\\psi(\\varepsilon_e, T) = \\psi_\\mathrm{me}(\\varepsilon_e) + \\psi_\\mathrm{th}(T),\n\\quad\n\\psi_\\mathrm{me}(\\varepsilon_e) = \\tfrac{1}{2} E \\varepsilon_e^2,\n\\quad\n\\psi_\\mathrm{th}(T) = c \\left[T - T_0 - T \\ln\\!\\left(\\tfrac{T}{T_0}\\right)\\right],\n$$\nwith $\\,\\varepsilon_e = \\varepsilon - \\varepsilon_p\\,$. The stress is $\\,\\sigma = \\partial \\psi_\\mathrm{me}/\\partial \\varepsilon_e = E\\,\\varepsilon_e\\,$, and the entropy density is $\\,\\eta(T) = -\\partial \\psi/\\partial T = c \\ln\\!\\left(\\tfrac{T}{T_0}\\right)\\,$. For the thermal part, compute $\\,\\dot{\\psi}_\\mathrm{th} = - c \\ln\\!\\left(\\tfrac{T}{T_0}\\right)\\dot{T}\\,$, which cancels exactly with $\\,\\eta\\,\\dot{T}\\,$ in the CD inequality:\n$$\n-\\dot{\\psi}_\\mathrm{th} - \\eta \\,\\dot{T} = c \\ln\\!\\left(\\tfrac{T}{T_0}\\right)\\dot{T} - c \\ln\\!\\left(\\tfrac{T}{T_0}\\right)\\dot{T} = 0.\n$$\nTherefore, in the continuous setting, the inequality reduces to\n$$\n\\mathcal{D} = \\sigma \\,\\dot{\\varepsilon} - \\dot{\\psi}_\\mathrm{me} \\ge 0.\n$$\nWith $\\,\\dot{\\psi}_\\mathrm{me} = E\\,\\varepsilon_e\\,\\dot{\\varepsilon}_e\\,$ and $\\,\\dot{\\varepsilon}_e = \\dot{\\varepsilon} - \\dot{\\varepsilon}_p\\,$, we obtain\n$$\n\\mathcal{D} = E\\,\\varepsilon_e\\,\\dot{\\varepsilon} - E\\,\\varepsilon_e\\,\\dot{\\varepsilon}_e\n= E\\,\\varepsilon_e\\,\\dot{\\varepsilon}_p\n= \\sigma \\,\\dot{\\varepsilon}_p \\ge 0,\n$$\nunder the standard viscoplastic dissipation assumption $\\,\\sigma\\,\\dot{\\varepsilon}_p \\ge 0\\,$, which is enforced by choosing a flow rule with $\\,\\mathrm{sign}(\\dot{\\varepsilon}_p)=\\mathrm{sign}(\\sigma)\\,$ and $\\,\\dot{\\varepsilon}_p \\ge 0\\,$ when $\\,|\\sigma|>\\sigma_y(T)\\,$. The adiabatic temperature evolution $\\,\\dot{T} = (\\chi/c)\\,\\sigma\\,\\dot{\\varepsilon}_p\\,$, with $\\,\\chi \\in [0,1]\\,$, is also consistent with the inequality since it does not introduce negative dissipation.\n\nWe now consider discrete time integration. Let time step $\\,n\\to n+1\\,$ of size $\\,\\Delta t\\,$ and define discrete entropic production via backward differences. A naive explicit evaluation, which uses $\\,\\sigma^{(n)}\\,$ and $\\,\\eta^{(n)}\\,$ for power and entropy terms, is\n$$\n\\mathcal{D}^{(n)} = \\sigma^{(n)}\\frac{\\Delta \\varepsilon}{\\Delta t} - \\frac{\\Delta \\psi}{\\Delta t} - \\eta^{(n)}\\frac{\\Delta T}{\\Delta t}, \\quad\n\\Delta \\varepsilon = \\varepsilon^{(n+1)}-\\varepsilon^{(n)},\\;\n\\Delta \\psi = \\psi^{(n+1)}-\\psi^{(n)},\\;\n\\Delta T = T^{(n+1)}-T^{(n)}.\n$$\nSplit $\\,\\Delta \\psi = \\Delta \\psi_\\mathrm{me} + \\Delta \\psi_\\mathrm{th}\\,$. For the mechanical part, inserting $\\,\\psi_\\mathrm{me}(\\varepsilon_e) = \\tfrac{1}{2} E \\varepsilon_e^2\\,$ with $\\,\\varepsilon_e^{(i)} = \\varepsilon^{(i)} - \\varepsilon_p^{(i)}\\,$ yields\n$$\n\\sigma^{(n)}\\frac{\\Delta \\varepsilon}{\\Delta t} - \\frac{\\Delta \\psi_\\mathrm{me}}{\\Delta t}\n= E\\,\\varepsilon_e^{(n)}\\frac{\\Delta \\varepsilon}{\\Delta t} - \\frac{\\tfrac{1}{2} E\\left[(\\varepsilon_e^{(n+1)})^2 - (\\varepsilon_e^{(n)})^2\\right]}{\\Delta t}.\n$$\nWriting $\\,\\Delta \\varepsilon_e = \\varepsilon_e^{(n+1)} - \\varepsilon_e^{(n)} = \\Delta \\varepsilon - \\Delta \\varepsilon_p\\,$, and noting that\n$$\nE\\,\\varepsilon_e^{(n)}\\Delta \\varepsilon_e - \\tfrac{1}{2}E \\left[ (\\varepsilon_e^{(n+1)})^2 - (\\varepsilon_e^{(n)})^2 \\right]\n= -\\tfrac{1}{2} E (\\Delta \\varepsilon_e)^2 \\le 0,\n$$\nwe obtain the discrete mechanical mismatch\n$$\n\\sigma^{(n)}\\frac{\\Delta \\varepsilon}{\\Delta t} - \\frac{\\Delta \\psi_\\mathrm{me}}{\\Delta t}\n= -\\frac{1}{2} E \\frac{(\\Delta \\varepsilon_e)^2}{\\Delta t} + E\\,\\varepsilon_e^{(n)}\\frac{\\Delta \\varepsilon_p}{\\Delta t}.\n$$\nThe first term is spurious and non-positive, appearing purely from evaluating the stress at the previous time level instead of the midpoint. During rapid transients (large $\\,\\Delta t\\,$), $\\,|\\Delta \\varepsilon_e|\\,$ can be large enough that this negative term dominates, resulting in $\\,\\mathcal{D}^{(n)}<0\\,$ even though the continuous $\\,\\mathcal{D}\\ge 0\\,$.\n\nFor the thermal part with the naive explicit evaluation, we use $\\,\\eta^{(n)}\\,\\Delta T/\\Delta t\\,$ and $\\,\\Delta \\psi_\\mathrm{th}/\\Delta t\\,$. In the continuous setting, the thermal terms cancel exactly by construction; however, at the discrete level using $\\,\\eta^{(n)}\\,$, they do not cancel exactly. A robust entropy-stable discretization uses a discrete gradient for the thermal term,\n$$\n\\eta^\\mathrm{dg} = -\\frac{\\psi_\\mathrm{th}(T^{(n+1)}) - \\psi_\\mathrm{th}(T^{(n)})}{T^{(n+1)} - T^{(n)}} \\quad \\text{if } T^{(n+1)} \\ne T^{(n)},\n$$\nand $\\,\\eta^\\mathrm{dg} = \\eta(T^{(n)})\\,$ otherwise, which guarantees\n$$\n-\\frac{\\Delta \\psi_\\mathrm{th}}{\\Delta t} - \\eta^\\mathrm{dg}\\frac{\\Delta T}{\\Delta t} = 0\n$$\nexactly at the discrete level.\n\nAn entropy-stable mechanical discretization uses the midpoint stress $\\,\\sigma^\\mathrm{avg} = \\tfrac{1}{2}(\\sigma^{(n)} + \\sigma^{(n+1)})\\,$:\n$$\n\\sigma^\\mathrm{avg}\\frac{\\Delta \\varepsilon}{\\Delta t} - \\frac{\\Delta \\psi_\\mathrm{me}}{\\Delta t}\n= \\sigma^\\mathrm{avg}\\frac{\\Delta \\varepsilon_p}{\\Delta t} \\ge 0,\n$$\nsince $\\,\\sigma^\\mathrm{avg}\\,$ and $\\,\\Delta \\varepsilon_p\\,$ have aligned signs under monotonic loading and dissipative flow. Therefore, the entropy-stable per-step production\n$$\n\\mathcal{D}_\\mathrm{es}^{(n)} = \\sigma^\\mathrm{avg}\\frac{\\Delta \\varepsilon}{\\Delta t} - \\frac{\\Delta \\psi}{\\Delta t} - \\eta^\\mathrm{dg}\\frac{\\Delta T}{\\Delta t}\n= \\sigma^\\mathrm{avg}\\frac{\\Delta \\varepsilon_p}{\\Delta t} \\ge 0,\n$$\nis non-negative by construction. Updating temperature with midpoint plastic power,\n$$\nT^{(n+1)} = T^{(n)} + \\frac{\\chi}{c}\\,\\sigma^\\mathrm{avg}\\,\\Delta \\varepsilon_p,\n$$\nkeeps the thermal coupling consistent.\n\nAlternatively, one can design an entropy limiter in the naive explicit scheme that increases the plastic increment $\\,\\Delta \\varepsilon_p\\,$ within the step to suppress the spurious elastic mismatch. Setting\n$$\n\\Delta \\varepsilon_p^\\star = \\left(\\Delta \\varepsilon + \\varepsilon_e^{(n)}\\right) - \\sqrt{\\max\\left\\{\\varepsilon_e^{(n)}\\left(2\\Delta \\varepsilon + \\varepsilon_e^{(n)}\\right),\\,0\\right\\}},\n$$\nand updating $\\,\\Delta \\varepsilon_p \\leftarrow \\min\\left\\{\\Delta \\varepsilon,\\,\\max\\left\\{\\Delta \\varepsilon_p,\\,\\Delta \\varepsilon_p^\\star\\right\\}\\right\\}\\,$ makes the per-step mechanical production non-negative:\n$$\n-\\frac{1}{2} E \\frac{(\\Delta \\varepsilon_e)^2}{\\Delta t} + E\\,\\varepsilon_e^{(n)}\\frac{\\Delta \\varepsilon_p}{\\Delta t} \\ge 0,\n$$\nwhere $\\,\\Delta \\varepsilon_e = \\Delta \\varepsilon - \\Delta \\varepsilon_p\\,$. After adjusting $\\,\\Delta \\varepsilon_p\\,$, recompute $\\,\\sigma^{(n+1)}\\,$, $\\,T^{(n+1)}\\,$, and $\\,\\mathcal{D}^{(n)}\\,$ for consistency.\n\nAlgorithmic design for the simulation:\n- Initialize $\\,\\varepsilon_p^{(0)} = 0\\,$, $\\,T^{(0)} = T_0\\,$, and $\\,\\sigma^{(0)} = E(\\varepsilon^{(0)} - \\varepsilon_p^{(0)}) = 0\\,$.\n- For each time step $\\,n\\,$:\n  - Compute $\\,\\varepsilon^{(n)}\\,$ and $\\,\\varepsilon^{(n+1)}\\,$ from the ramp.\n  - Compute $\\,\\sigma^{(n)} = E(\\varepsilon^{(n)} - \\varepsilon_p^{(n)})\\,$ and $\\,\\sigma_y^{(n)} = \\sigma_{y0}\\,\\max\\{1 - \\beta (T^{(n)}-T_0),\\, \\underline{\\kappa}\\}\\,$.\n  - Compute $\\,\\dot{\\varepsilon}_p^{(n)} = \\tfrac{\\gamma}{E}\\,\\langle |\\sigma^{(n)}| - \\sigma_y^{(n)} \\rangle \\,\\mathrm{sign}(\\sigma^{(n)})\\,$, and $\\,\\Delta \\varepsilon_p = \\dot{\\varepsilon}_p^{(n)}\\Delta t\\,$.\n  - Form $\\,\\varepsilon_p^{(n+1)} = \\varepsilon_p^{(n)} + \\Delta \\varepsilon_p\\,$ and $\\,\\sigma^{(n+1)} = E(\\varepsilon^{(n+1)} - \\varepsilon_p^{(n+1)})\\,$.\n  - For the explicit scheme, update $\\,T^{(n+1)} = T^{(n)} + \\tfrac{\\chi}{c}\\,\\sigma^{(n)}\\,\\Delta \\varepsilon_p\\,$; for the entropy-stable scheme, update $\\,T^{(n+1)} = T^{(n)} + \\tfrac{\\chi}{c}\\,\\sigma^\\mathrm{avg}\\,\\Delta \\varepsilon_p\\,$ with $\\,\\sigma^\\mathrm{avg} = \\tfrac{1}{2}(\\sigma^{(n)}+\\sigma^{(n+1)})\\,$.\n  - Compute $\\,\\psi^{(n)} = \\psi_\\mathrm{me}(\\varepsilon_e^{(n)}) + \\psi_\\mathrm{th}(T^{(n)})\\,$ and $\\,\\psi^{(n+1)}\\,$ similarly, and the entropy $\\,\\eta^{(n)} = \\eta(T^{(n)})\\,$. For the entropy-stable variant, use $\\,\\eta^\\mathrm{dg} = -\\tfrac{\\psi_\\mathrm{th}(T^{(n+1)}) - \\psi_\\mathrm{th}(T^{(n)})}{T^{(n+1)} - T^{(n)}}\\,$ if $\\,\\Delta T \\ne 0\\,$, else $\\,\\eta^\\mathrm{dg} = \\eta^{(n)}\\,$.\n  - Form $\\,\\mathcal{D}^{(n)}\\,$ or $\\,\\mathcal{D}_\\mathrm{es}^{(n)}\\,$ accordingly.\n  - In the entropy limiter variant, if $\\,\\mathcal{D}^{(n)} < 0\\,$, replace $\\,\\Delta \\varepsilon_p\\,$ by the limited $\\,\\Delta \\varepsilon_p^\\star\\,$ clamped as above, recompute $\\,\\varepsilon_p^{(n+1)}\\,$, $\\,\\sigma^{(n+1)}\\,$, $\\,T^{(n+1)}\\,$, and $\\,\\mathcal{D}^{(n)}\\,$.\n- Record the minimum $\\,\\mathcal{D}^{(n)}\\,$ (or $\\,\\mathcal{D}_\\mathrm{es}^{(n)}\\,$) over the simulation. The unit of $\\,\\mathcal{D}\\,$ is power per unit volume (W/m$^3$).\n\nTest suite design:\n- Case 1 (explicit, large step): $\\,\\Delta t = 2.0\\times 10^{-5}\\,$ s, expecting violation ($\\,\\min \\mathcal{D}^{(n)} < 0\\,$).\n- Case 2 (entropy-stable, large step): $\\,\\Delta t = 2.0\\times 10^{-5}\\,$ s, expecting $\\,\\min \\mathcal{D}_\\mathrm{es}^{(n)} \\ge 0\\,$ by construction.\n- Case 3 (explicit with limiter, large step): $\\,\\Delta t = 2.0\\times 10^{-5}\\,$ s, expecting $\\,\\min \\mathcal{D}^{(n)} \\ge 0\\,$ after applying the limiter.\n\nThe final program executes these cases and prints a single line with the minimum discrete production values in watts per cubic meter (W/m$^3$), as a comma-separated list in square brackets.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\n# Material and loading parameters (SI units)\nE = 2.0e11                 # Pa\nc = 3.5e6                  # J/(m^3 K)\nT0 = 300.0                 # K\nsigma_y0 = 4.0e8           # Pa\nbeta = 1.0e-3              # 1/K\nkappa_floor = 0.2          # dimensionless floor for yield stress fraction\ngamma = 5.0e3              # 1/s\nchi = 0.9                  # Taylor-Quinney coefficient\neps_final = 0.02           # final strain\nt_ramp = 1.0e-4            # s\nt_end = 2.0e-4             # s\n\ndef strain_history(t: float) -> float:\n    return eps_final * min(t / t_ramp, 1.0)\n\ndef psi_mech(eps_e: float) -> float:\n    return 0.5 * E * eps_e**2\n\ndef psi_th(T: float) -> float:\n    # c [T - T0 - T ln(T/T0)]\n    return c * (T - T0 - T * np.log(T / T0))\n\ndef eta(T: float) -> float:\n    # c ln(T/T0)\n    return c * np.log(T / T0)\n\ndef yield_stress(T: float) -> float:\n    # sigma_y(T) = sigma_y0 * max(1 - beta (T-T0), kappa_floor)\n    return sigma_y0 * max(1.0 - beta * (T - T0), kappa_floor)\n\ndef flow_rate(sigma: float, T: float) -> float:\n    # Perzyna-type: dot_eps_p = (gamma/E) * <|sigma| - sigma_y(T)> * sign(sigma)\n    y = yield_stress(T)\n    overstress = max(abs(sigma) - y, 0.0)\n    sgn = 0.0\n    if sigma > 0.0:\n        sgn = 1.0\n    elif sigma < 0.0:\n        sgn = -1.0\n    return (gamma / E) * overstress * sgn\n\ndef simulate(dt: float, method: str) -> float:\n    nsteps = int(round(t_end / dt))\n    # State variables\n    eps_p = 0.0\n    T = T0\n    # For recording minimum discrete production\n    min_D = np.inf\n    # Initial total strain and stress\n    t_n = 0.0\n    eps_n = strain_history(t_n)\n    sigma_n = E * (eps_n - eps_p)\n    psi_n = psi_mech(eps_n - eps_p) + psi_th(T)\n    eta_n = eta(T)\n\n    for n in range(nsteps):\n        t_np1 = (n + 1) * dt\n        eps_np1 = strain_history(t_np1)\n        Deps = eps_np1 - eps_n\n\n        # Current stress and yield\n        sigma_n = E * (eps_n - eps_p)\n        y_n = yield_stress(T)\n\n        # Plastic increment by explicit flow\n        dot_eps_p = flow_rate(sigma_n, T)\n        Deps_p = dot_eps_p * dt\n\n        # Tentative update of plastic strain and stress\n        eps_p_tent = eps_p + Deps_p\n        sigma_np1_tent = E * (eps_np1 - eps_p_tent)\n\n        if method == \"explicit\":\n            # Explicit temperature update\n            T_np1 = T + (chi / c) * sigma_n * Deps_p\n\n            # Energetics\n            psi_np1 = psi_mech(eps_np1 - eps_p_tent) + psi_th(T_np1)\n            eta_n_use = eta_n\n            # Discrete production (explicit)\n            Dn = sigma_n * (Deps / dt) - (psi_np1 - psi_n) / dt - eta_n_use * (T_np1 - T) / dt\n\n            # Record min and accept tentative updates\n            min_D = min(min_D, Dn)\n            eps_p = eps_p_tent\n            eps_n = eps_np1\n            psi_n = psi_np1\n            T = T_np1\n            eta_n = eta(T)\n\n        elif method == \"entropy_stable\":\n            # Midpoint stress\n            sigma_avg = 0.5 * (sigma_n + sigma_np1_tent)\n            # Entropy-stable temperature update using midpoint plastic power\n            T_np1 = T + (chi / c) * sigma_avg * Deps_p\n\n            # Energetics\n            psi_np1 = psi_mech(eps_np1 - eps_p_tent) + psi_th(T_np1)\n            # Discrete gradient for thermal term\n            dT = T_np1 - T\n            if abs(dT) > 0.0:\n                eta_dg = - (psi_th(T_np1) - psi_th(T)) / dT\n            else:\n                eta_dg = eta_n\n            # Entropy-stable discrete production\n            Dn = sigma_avg * (Deps / dt) - (psi_np1 - psi_n) / dt - eta_dg * (dT / dt)\n\n            # Record min and accept tentative updates\n            min_D = min(min_D, Dn)\n            eps_p = eps_p_tent\n            eps_n = eps_np1\n            psi_n = psi_np1\n            T = T_np1\n            eta_n = eta(T)\n\n        elif method == \"explicit_with_limiter\":\n            # Explicit temperature update\n            T_np1 = T + (chi / c) * sigma_n * Deps_p\n\n            # Energetics pre-check\n            psi_np1 = psi_mech(eps_np1 - eps_p_tent) + psi_th(T_np1)\n            Dn = sigma_n * (Deps / dt) - (psi_np1 - psi_n) / dt - eta_n * (T_np1 - T) / dt\n\n            if Dn < 0.0:\n                # Compute limited plastic increment to enforce non-negative production\n                eps_e_n = eps_n - eps_p\n                # Target increment derived analytically; clamp within [0, Deps]\n                radicand = eps_e_n * (2.0 * Deps + eps_e_n)\n                if radicand < 0.0:\n                    radicand = 0.0\n                Deps_p_star = (Deps + eps_e_n) - np.sqrt(radicand)\n                # Clamp to physical range and ensure we do not reduce existing plasticity\n                Deps_p_lim = min(Deps, max(Deps_p, max(0.0, Deps_p_star)))\n\n                # Recompute tentative updates with limiter\n                eps_p_tent = eps_p + Deps_p_lim\n                sigma_np1_tent = E * (eps_np1 - eps_p_tent)\n                T_np1 = T + (chi / c) * sigma_n * Deps_p_lim\n\n                psi_np1 = psi_mech(eps_np1 - eps_p_tent) + psi_th(T_np1)\n                Dn = sigma_n * (Deps / dt) - (psi_np1 - psi_n) / dt - eta_n * (T_np1 - T) / dt\n\n            # Record min and accept final updates\n            min_D = min(min_D, Dn)\n            eps_p = eps_p_tent\n            eps_n = eps_np1\n            psi_n = psi_np1\n            T = T_np1\n            eta_n = eta(T)\n\n        else:\n            raise ValueError(\"Unknown method\")\n\n    return float(min_D)\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        (\"explicit\", 2.0e-5),\n        (\"entropy_stable\", 2.0e-5),\n        (\"explicit_with_limiter\", 2.0e-5),\n    ]\n\n    results = []\n    for method, dt in test_cases:\n        minD = simulate(dt, method)\n        results.append(minD)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3562407"}]}