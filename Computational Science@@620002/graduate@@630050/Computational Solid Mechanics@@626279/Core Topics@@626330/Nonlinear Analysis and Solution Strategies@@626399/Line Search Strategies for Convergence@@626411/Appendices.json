{"hands_on_practices": [{"introduction": "To build a robust line search algorithm, we must first establish what constitutes an \"optimal\" step. This practice explores the theoretical ideal by modeling the energy landscape along a search direction as a simple quadratic function. By deriving the exact minimizer of this quadratic model, you will prove that it naturally satisfies the strong Wolfe conditions ([@problem_id:3577571]), providing fundamental insight into why these conditions are the cornerstone of modern optimization routines.", "problem": "In computational solid mechanics, globalization of Newton-Raphson (NR) iterations within the Finite Element Method (FEM) frequently uses a line search along a trial step to ensure convergence of a selected merit function. Consider a one-dimensional line search parameterized by a scalar step length $\\alpha \\in \\mathbb{R}$ applied to a twice continuously differentiable merit function $\\phi(\\alpha)$ that represents either a Taylor expansion of the discrete total potential energy or the squared norm of the residual along the trial direction. Assume the local model of $\\phi$ along the line is the quadratic\n$$\n\\phi(\\alpha) = \\phi_{0} + \\phi'_{0}\\,\\alpha + \\tfrac{1}{2} H \\alpha^{2},\n$$\nwith $H>0$ and $\\phi'_{0} < 0$, where $\\phi_{0} = \\phi(0)$ and $\\phi'_{0} = \\left.\\frac{d\\phi}{d\\alpha}\\right|_{\\alpha=0}$. Using first principles from calculus and the standard definition of the strong Wolfe conditions (SWC), derive the exact minimizer $\\alpha^{\\ast}$ of $\\phi(\\alpha)$ and prove that $\\alpha^{\\ast}$ satisfies the SWC for some parameters $c_{1}$ and $c_{2}$ satisfying $0 < c_{1} < c_{2} < 1$. The strong Wolfe conditions are the sufficient decrease (Armijo) condition and the curvature condition stated for $\\phi$ along the line. Provide the exact analytic expression for $\\alpha^{\\ast}$ as your final answer. No rounding is required and no units are needed.", "solution": "The problem statement is first subjected to a rigorous validation process.\n\n### Step 1: Extract Givens\n- **Domain**: Computational solid mechanics, specifically line search for Newton-Raphson methods.\n- **Merit Function**: A twice continuously differentiable function $\\phi(\\alpha)$ parameterized by a scalar step length $\\alpha \\in \\mathbb{R}$.\n- **Local Model**: The function $\\phi(\\alpha)$ is modeled as a quadratic: $\\phi(\\alpha) = \\phi_{0} + \\phi'_{0}\\,\\alpha + \\tfrac{1}{2} H \\alpha^{2}$.\n- **Initial Conditions**: $\\phi_{0} = \\phi(0)$ and $\\phi'_{0} = \\left.\\frac{d\\phi}{d\\alpha}\\right|_{\\alpha=0}$.\n- **Constraints**: $H > 0$ and $\\phi'_{0}  0$. The latter signifies a descent direction.\n- **Task 1**: Derive the exact minimizer $\\alpha^{\\ast}$ of $\\phi(\\alpha)$.\n- **Task 2**: Prove that $\\alpha^{\\ast}$ satisfies the strong Wolfe conditions (SWC) for some valid parameters $c_{1}$ and $c_{2}$.\n- **SWC Definition**: The SWC consist of the sufficient decrease (Armijo) condition and the curvature condition.\n- **SWC Parameters**: $0  c_{1}  c_{2}  1$.\n\n### Step 2: Validate Using Extracted Givens\n1.  **Scientifically Grounded**: The problem is well-grounded in the theory of numerical optimization, which is a fundamental component of computational mechanics. The use of a quadratic model for a merit function, the concept of a line search, and the application of Wolfe conditions are all standard, established practices. The assumptions $\\phi'_{0}  0$ (the search direction is a descent direction) and $H > 0$ (the function is locally convex) are standard requirements for ensuring a meaningful minimization step. The problem is scientifically and mathematically sound.\n2.  **Well-Posed**: The problem is to find the unique minimizer of a strictly convex quadratic function ($H > 0$), which is a classic, well-posed problem. It then asks for a proof based on this minimizer, which is also a well-defined mathematical task.\n3.  **Objective**: The problem is stated using precise mathematical notation and terminology, with no subjective or ambiguous language.\n4.  **Completeness**: All necessary information ($\\phi(\\alpha)$'s form, constraints on its parameters, definitions of SWC) is provided. The problem is self-contained.\n5.  **Consistency**: There are no internal contradictions. The constraints $H > 0$ and $\\phi'_{0}  0$ are consistent with the goal of minimization.\n\n### Step 3: Verdict and Action\nThe problem is deemed **valid**. It is a standard, well-posed problem from the field of numerical analysis as applied to engineering. A solution will be derived.\n\n### Derivation of the Solution\n\nThe problem requires us to first find the minimizer of the given quadratic merit function and then prove that this minimizer satisfies the strong Wolfe conditions.\n\n**Part 1: Derivation of the Minimizer $\\alpha^{\\ast}$**\n\nThe merit function is given by the quadratic model:\n$$\n\\phi(\\alpha) = \\phi_{0} + \\phi'_{0}\\,\\alpha + \\frac{1}{2} H \\alpha^{2}\n$$\nTo find the stationary points of $\\phi(\\alpha)$, we compute its first derivative with respect to $\\alpha$ and set it to zero.\n$$\n\\phi'(\\alpha) = \\frac{d\\phi}{d\\alpha} = \\phi'_{0} + H \\alpha\n$$\nSetting $\\phi'(\\alpha) = 0$ at the minimizer $\\alpha = \\alpha^{\\ast}$:\n$$\n\\phi'_{0} + H \\alpha^{\\ast} = 0\n$$\nSolving for $\\alpha^{\\ast}$, we get:\n$$\n\\alpha^{\\ast} = -\\frac{\\phi'_{0}}{H}\n$$\nTo confirm that this stationary point corresponds to a minimum, we examine the second derivative of $\\phi(\\alpha)$:\n$$\n\\phi''(\\alpha) = \\frac{d^2\\phi}{d\\alpha^2} = H\n$$\nThe problem states that $H > 0$. Since the second derivative is positive, the function $\\phi(\\alpha)$ is strictly convex, and thus $\\alpha^{\\ast}$ is the unique global minimizer. Given $\\phi'_{0}  0$ and $H > 0$, it follows that $\\alpha^{\\ast} > 0$, which is consistent with taking a finite step in the descent direction.\n\n**Part 2: Verification of the Strong Wolfe Conditions (SWC)**\n\nThe strong Wolfe conditions consist of two inequalities that must be satisfied by the step length $\\alpha$. For this problem, we must show that $\\alpha^{\\ast}$ satisfies them for some choice of parameters $c_{1}$ and $c_{2}$ where $0  c_{1}  c_{2}  1$.\n\nThe two conditions are:\n1.  **Sufficient Decrease (Armijo) Condition**: $\\phi(\\alpha) \\le \\phi(0) + c_{1} \\alpha \\phi'(0)$\n    In the problem's notation, this is: $\\phi(\\alpha) \\le \\phi_{0} + c_{1} \\alpha \\phi'_{0}$.\n2.  **Curvature Condition (Strong Form)**: $|\\phi'(\\alpha)| \\le c_{2} |\\phi'(0)|$\n    In the problem's notation, this is: $|\\phi'(\\alpha)| \\le c_{2} |\\phi'_{0}|$. Since $\\phi'_{0}  0$, we have $|\\phi'_{0}| = -\\phi'_{0}$, so the condition can also be written as $|\\phi'(\\alpha)| \\le -c_{2} \\phi'_{0}$.\n\nWe will now check if $\\alpha^{\\ast} = -\\frac{\\phi'_{0}}{H}$ satisfies these two conditions.\n\n**Verification of the Curvature Condition:**\nWe evaluate $\\phi'(\\alpha)$ at $\\alpha^{\\ast}$:\n$$\n\\phi'(\\alpha^{\\ast}) = \\phi'_{0} + H \\alpha^{\\ast} = \\phi'_{0} + H \\left(-\\frac{\\phi'_{0}}{H}\\right) = \\phi'_{0} - \\phi'_{0} = 0\n$$\nSubstituting this result into the curvature condition inequality:\n$$\n|\\phi'(\\alpha^{\\ast})| \\le c_{2} |\\phi'_{0}| \\implies |0| \\le c_{2} |\\phi'_{0}| \\implies 0 \\le c_{2} |\\phi'_{0}|\n$$\nWe are given $0  c_{1}  c_{2}  1$, so $c_{2} > 0$. We are also given $\\phi'_{0}  0$, which means $|\\phi'_{0}| > 0$. Therefore, the product $c_{2} |\\phi'_{0}|$ is strictly positive. The inequality $0 \\le c_{2} |\\phi'_{0}|$ is always true. Thus, the curvature condition is satisfied for any permissible value of $c_{2}$.\n\n**Verification of the Sufficient Decrease Condition:**\nFirst, we evaluate $\\phi(\\alpha^{\\ast})$:\n$$\n\\phi(\\alpha^{\\ast}) = \\phi_{0} + \\phi'_{0} \\alpha^{\\ast} + \\frac{1}{2} H (\\alpha^{\\ast})^{2}\n$$\nSubstitute $\\alpha^{\\ast} = -\\frac{\\phi'_{0}}{H}$:\n$$\n\\phi(\\alpha^{\\ast}) = \\phi_{0} + \\phi'_{0} \\left(-\\frac{\\phi'_{0}}{H}\\right) + \\frac{1}{2} H \\left(-\\frac{\\phi'_{0}}{H}\\right)^{2} = \\phi_{0} - \\frac{(\\phi'_{0})^{2}}{H} + \\frac{1}{2}H \\frac{(\\phi'_{0})^{2}}{H^{2}}\n$$\n$$\n\\phi(\\alpha^{\\ast}) = \\phi_{0} - \\frac{(\\phi'_{0})^{2}}{H} + \\frac{1}{2}\\frac{(\\phi'_{0})^{2}}{H} = \\phi_{0} - \\frac{1}{2}\\frac{(\\phi'_{0})^{2}}{H}\n$$\nNow, we evaluate the right-hand side of the Armijo inequality at $\\alpha^{\\ast}$:\n$$\n\\phi_{0} + c_{1} \\alpha^{\\ast} \\phi'_{0} = \\phi_{0} + c_{1} \\left(-\\frac{\\phi'_{0}}{H}\\right) \\phi'_{0} = \\phi_{0} - c_{1} \\frac{(\\phi'_{0})^{2}}{H}\n$$\nThe Armijo inequality $\\phi(\\alpha^{\\ast}) \\le \\phi_{0} + c_{1} \\alpha^{\\ast} \\phi'_{0}$ becomes:\n$$\n\\phi_{0} - \\frac{1}{2}\\frac{(\\phi'_{0})^{2}}{H} \\le \\phi_{0} - c_{1} \\frac{(\\phi'_{0})^{2}}{H}\n$$\nSubtracting $\\phi_{0}$ from both sides gives:\n$$\n- \\frac{1}{2}\\frac{(\\phi'_{0})^{2}}{H} \\le - c_{1} \\frac{(\\phi'_{0})^{2}}{H}\n$$\nSince $H > 0$ and $\\phi'_{0} \\ne 0$, the term $\\frac{(\\phi'_{0})^{2}}{H}$ is strictly positive. We can divide both sides by this term without changing the inequality's direction:\n$$\n- \\frac{1}{2} \\le - c_{1}\n$$\nMultiplying both sides by $-1$ reverses the inequality sign:\n$$\n\\frac{1}{2} \\ge c_{1} \\quad \\text{or} \\quad c_{1} \\le \\frac{1}{2}\n$$\nThis result shows that the sufficient decrease condition is satisfied if and only if the parameter $c_{1}$ is chosen such that $c_{1} \\le \\frac{1}{2}$.\n\n**Conclusion:**\nThe exact minimizer $\\alpha^{\\ast} = -\\frac{\\phi'_{0}}{H}$ satisfies the strong Wolfe conditions provided we can select parameters $c_{1}$ and $c_{2}$ that meet the following requirements:\n1.  $0  c_1  c_2  1$ (from the definition of SWC parameters)\n2.  $c_1 \\le \\frac{1}{2}$ (derived from the Armijo condition)\n\nIt is indeed possible to choose such parameters. For example, any pair $(c_{1}, c_{2})$ such that $0  c_{1} \\le \\frac{1}{2}$ and $c_{1}  c_{2}  1$ will work. A typical choice in optimization algorithms might be $c_{1} = 10^{-4}$ and $c_{2} = 0.9$, which clearly satisfies these constraints. Therefore, the proof is complete. The exact minimizer of the quadratic model satisfies the strong Wolfe conditions.\n\nThe final answer required is the analytical expression for $\\alpha^{\\ast}$.", "answer": "$$\n\\boxed{-\\frac{\\phi'_{0}}{H}}\n$$", "id": "3577571"}, {"introduction": "Moving from the ideal quadratic model to a more physically representative scenario, we now consider a nonlinear spring whose potential energy function is cubic. This results in a line search objective function $\\phi(\\alpha)$ that is also a cubic polynomial, offering a richer, non-symmetric energy landscape to explore. This exercise ([@problem_id:3577646]) challenges you to apply the principles of the Wolfe conditions to a concrete, analytically solvable problem, bridging the gap between pure theory and practical engineering application.", "problem": "A one-dimensional nonlinear spring with displacement $u$ stores internal energy according to the truncated small-strain polynomial model $E(u)=\\frac{1}{2} k\\,u^{2}+\\frac{1}{3} b\\,u^{3}$, where $k0$ and $b0$ are nondimensional stiffness parameters. The equilibrium configuration is obtained by minimizing the total potential energy, and a Newtonâ€“Raphson (NR) iteration is globalized by a line search along a descent direction $p^{k}$. At the current iterate $u^{k}$, the line search seeks a step length $\\alpha0$ that reduces the scalar function $\\phi(\\alpha)=E(u^{k}+\\alpha\\,p^{k})$ while promoting global convergence.\n\nConsider the specific data $k=100$, $b=200$, $u^{k}=0.05$, and $p^{k}=-0.02$, all nondimensional. The objective along the line is the cubic function $\\phi(\\alpha)=E(u^{k}+\\alpha\\,p^{k})$. Compute a single positive step length $\\alpha$ that simultaneously satisfies the Armijo sufficient decrease condition with $c_{1}=10^{-4}$ and the strong Wolfe curvature condition with $c_{2}=0.9$ along the given $p^{k}$. Express your final $\\alpha$ as a dimensionless number. If you must approximate, round your answer to four significant figures.", "solution": "The user has provided a problem from computational mechanics involving a line search for a one-dimensional nonlinear system.\n\n### Step 1: Extract Givens\n-   Internal energy function: $E(u)=\\frac{1}{2} k\\,u^{2}+\\frac{1}{3} b\\,u^{3}$\n-   Stiffness parameters: $k0$, $b0$\n-   Specific data: $k=100$, $b=200$ (nondimensional)\n-   Current iterate: $u^{k}=0.05$ (nondimensional)\n-   Search direction: $p^{k}=-0.02$ (nondimensional)\n-   Line search objective function: $\\phi(\\alpha)=E(u^{k}+\\alpha\\,p^{k})$\n-   Armijo condition parameter: $c_{1}=10^{-4}$\n-   Strong Wolfe condition parameter: $c_{2}=0.9$\n-   Objective: Compute a single positive step length $\\alpha0$ satisfying both conditions.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically grounded, well-posed, and objective. It describes a standard application of a Newton-type optimization algorithm with a line search globalization strategy, a core topic in computational solid mechanics and numerical optimization. The energy function is a simple but valid polynomial model. The line search conditions (Armijo and strong Wolfe) are standard. All necessary data are provided, and there are no internal contradictions. The problem can be formalized and solved using established mathematical principles.\n\n### Step 3: Verdict and Action\nThe problem is valid. A complete solution will be provided.\n\n### Solution Derivation\nThe goal is to find a step length $\\alpha0$ that satisfies two conditions for the line search function $\\phi(\\alpha)=E(u^{k}+\\alpha\\,p^{k})$.\n\nThe two conditions are:\n1.  **Armijo (Sufficient Decrease) Condition**:\n    $$\\phi(\\alpha) \\le \\phi(0) + c_{1} \\alpha \\phi'(0)$$\n2.  **Strong Wolfe (Curvature) Condition**:\n    $$|\\phi'(\\alpha)| \\le c_{2} |\\phi'(0)|$$\n\nFirst, we define $\\phi(\\alpha)$ and its derivative $\\phi'(\\alpha)$ using the provided energy function $E(u)$.\nThe derivative of the energy function with respect to $u$ is the internal force:\n$$E'(u) = \\frac{dE}{du} = k u + b u^2$$\nThe derivative of the line search function $\\phi(\\alpha)$ with respect to $\\alpha$ is found using the chain rule:\n$$\\phi'(\\alpha) = \\frac{d}{d\\alpha} E(u^{k}+\\alpha\\,p^{k}) = E'(u^{k}+\\alpha\\,p^{k}) \\cdot \\frac{d}{d\\alpha}(u^{k}+\\alpha\\,p^{k}) = E'(u^{k}+\\alpha\\,p^{k}) \\cdot p^{k}$$\n\nNext, we evaluate $\\phi(0)$ and $\\phi'(0)$ using the given data:\n$k=100$, $b=200$, $u^{k}=0.05$, $p^{k}=-0.02$.\n\nAt $\\alpha=0$, we are at the current iterate $u^k$:\n$$\\phi(0) = E(u^{k}) = \\frac{1}{2} k (u^{k})^{2} + \\frac{1}{3} b (u^{k})^{3}$$\n$$\\phi(0) = \\frac{1}{2}(100)(0.05)^{2} + \\frac{1}{3}(200)(0.05)^{3} = 50(0.0025) + \\frac{200}{3}(0.000125)$$\n$$\\phi(0) = 0.125 + \\frac{0.025}{3} = \\frac{1}{8} + \\frac{1}{120} = \\frac{15+1}{120} = \\frac{16}{120} = \\frac{2}{15}$$\nFor the derivative at $\\alpha=0$:\n$$E'(u^k) = k u^k + b (u^k)^2 = 100(0.05) + 200(0.05)^2 = 5 + 200(0.0025) = 5 + 0.5 = 5.5$$\n$$\\phi'(0) = E'(u^k) p^k = (5.5)(-0.02) = -0.11$$\nSince $\\phi'(0)0$, the direction $p^k$ is a valid descent direction.\n\nNow, we can state the specific conditions for $\\alpha$ using $c_1 = 10^{-4}$ and $c_2 = 0.9$:\n1.  Armijo: $\\phi(\\alpha) \\le \\frac{2}{15} - 0.000011 \\alpha$\n2.  Strong Wolfe: $|\\phi'(\\alpha)| \\le 0.099$\n\nTo proceed, we need the general expression for $\\phi'(\\alpha)$. Let $u(\\alpha) = u^k + \\alpha p^k = 0.05 - 0.02\\alpha$.\n$$\\phi'(\\alpha) = \\left( k(u^k+\\alpha p^k) + b(u^k+\\alpha p^k)^2 \\right) p^k$$\n$$\\phi'(\\alpha) = \\left( 100(0.05 - 0.02\\alpha) + 200(0.05 - 0.02\\alpha)^2 \\right) (-0.02)$$\nLet's expand the term in the parentheses:\n$$(5 - 2\\alpha) + 200(0.0025 - 0.002\\alpha + 0.0004\\alpha^2) = 5 - 2\\alpha + 0.5 - 0.4\\alpha + 0.08\\alpha^2$$\n$$= 0.08\\alpha^2 - 2.4\\alpha + 5.5$$\nMultiplying by $p^k = -0.02$:\n$$\\phi'(\\alpha) = (-0.02)(0.08\\alpha^2 - 2.4\\alpha + 5.5) = -0.0016\\alpha^2 + 0.048\\alpha - 0.11$$\n\nThe problem asks for a single step length $\\alpha$. An interval of acceptable $\\alpha$ values typically exists. The most physically and mathematically principled choice for a single step is the one that minimizes the potential energy along the search direction. This corresponds to an \"exact line search,\" where we find $\\alpha  0$ such that $\\phi'(\\alpha)=0$.\nWe solve the quadratic equation $\\phi'(\\alpha)=0$:\n$$-0.0016\\alpha^2 + 0.048\\alpha - 0.11 = 0$$\nMultiplying by $-10000$ to clear decimals gives:\n$$16\\alpha^2 - 480\\alpha + 1100 = 0$$\nDividing by $4$:\n$$4\\alpha^2 - 120\\alpha + 275 = 0$$\nUsing the quadratic formula, $\\alpha = \\frac{-b \\pm \\sqrt{b^2-4ac}}{2a}$:\n$$\\alpha = \\frac{120 \\pm \\sqrt{(-120)^2 - 4(4)(275)}}{2(4)} = \\frac{120 \\pm \\sqrt{14400 - 4400}}{8}$$\n$$\\alpha = \\frac{120 \\pm \\sqrt{10000}}{8} = \\frac{120 \\pm 100}{8}$$\nThis gives two positive roots:\n$$\\alpha_1 = \\frac{120-100}{8} = \\frac{20}{8} = 2.5$$\n$$\\alpha_2 = \\frac{120+100}{8} = \\frac{220}{8} = 27.5$$\nTo determine which root corresponds to a minimum, we examine the sign of the second derivative, $\\phi''(\\alpha)$:\n$$\\phi''(\\alpha) = \\frac{d}{d\\alpha}(-0.0016\\alpha^2 + 0.048\\alpha - 0.11) = -0.0032\\alpha + 0.048$$\nAt $\\alpha_1=2.5$:\n$$\\phi''(2.5) = -0.0032(2.5) + 0.048 = -0.008 + 0.048 = 0.04  0$$\nThis indicates a local minimum.\nAt $\\alpha_2=27.5$:\n$$\\phi''(27.5) = -0.0032(27.5) + 0.048 = -0.088 + 0.048 = -0.04  0$$\nThis indicates a local maximum.\nThe step length that minimizes $\\phi(\\alpha)$ is $\\alpha^*=2.5$.\n\nFinally, we must verify that $\\alpha^*=2.5$ satisfies both the Armijo and strong Wolfe conditions.\n1.  **Strong Wolfe Condition**:\n    We must check if $|\\phi'(2.5)| \\le 0.099$. By construction, $\\alpha^*=2.5$ is a root of $\\phi'(\\alpha)$, so $\\phi'(2.5)=0$. The condition becomes $|0| \\le 0.099$, which is true.\n\n2.  **Armijo Condition**:\n    We must check if $\\phi(2.5) \\le \\phi(0) + c_1(2.5)\\phi'(0)$. To find $\\phi(2.5)$, we integrate $\\phi'(\\alpha)$:\n    $$\\phi(\\alpha) = \\int (-0.0016\\alpha^2 + 0.048\\alpha - 0.11) d\\alpha = -\\frac{0.0016}{3}\\alpha^3 + 0.024\\alpha^2 - 0.11\\alpha + C$$\n    Using the initial condition $\\phi(0) = C = 2/15$.\n    $$\\phi(2.5) = -\\frac{0.0016}{3}(2.5)^3 + 0.024(2.5)^2 - 0.11(2.5) + \\frac{2}{15}$$\n    Using fractions, $\\alpha=5/2$:\n    $$\\phi(5/2) = -\\frac{0.0016}{3}\\left(\\frac{125}{8}\\right) + 0.024\\left(\\frac{25}{4}\\right) - 0.11\\left(\\frac{5}{2}\\right) + \\frac{2}{15}$$\n    $$\\phi(5/2) = -0.0002\\frac{125}{3} + 0.006(25) - 0.275 + \\frac{2}{15}$$\n    $$\\phi(5/2) = -\\frac{0.025}{3} + 0.15 - 0.275 + \\frac{2}{15} = -\\frac{1}{120} + \\frac{3}{20} - \\frac{11}{40} + \\frac{16}{120}$$\n    With a common denominator of $120$:\n    $$\\phi(5/2) = \\frac{-1 + 18 - 33 + 16}{120} = \\frac{34-34}{120} = 0$$\n    The Armijo condition is:\n    $$0 \\le \\frac{2}{15} - 0.000011(2.5) = \\frac{2}{15} - 0.0000275$$\n    Since $\\frac{2}{15} \\approx 0.1333$, the inequality $0 \\le 0.1333 - 0.0000275$ is true.\n\nBoth conditions are satisfied for the step length $\\alpha=2.5$. This is an exact, positive, and dimensionless number.", "answer": "$$\\boxed{2.5}$$", "id": "3577646"}, {"introduction": "In most large-scale computational mechanics problems, the potential energy function is far too complex to minimize analytically. Instead of seeking an exact minimum, we employ iterative algorithms to find a step length that guarantees sufficient progress. This hands-on problem ([@problem_id:3577625]) guides you through implementing the most widely used of these methods: the Armijo backtracking line search. By coding this algorithm, you will gain practical experience in iteratively satisfying the sufficient decrease condition, a core skill for developing and debugging robust nonlinear solvers.", "problem": "Consider the one-dimensional total potential energy for a hyperelastic bar given by the scalar function $\\Pi(u) = \\tfrac{1}{2}\\,k\\,u^{2} + \\tfrac{1}{4}\\,\\beta\\,u^{4} - f\\,u$, where $k$, $\\beta$, $f$, and $u$ are nondimensional real numbers. At an iterate $u^{k}$ with a given search direction $p^{k}$, apply an Armijo backtracking line search to find the first acceptable step size $\\alpha \\in (0,1]$ that satisfies the sufficient decrease condition\n$\\Pi(u^{k} + \\alpha\\,p^{k}) \\le \\Pi(u^{k}) + c_{1}\\,\\alpha\\,\\nabla \\Pi(u^{k})\\,p^{k}$,\nwhere $\\nabla \\Pi(u)$ denotes the derivative of $\\Pi$ with respect to $u$ and the product $\\nabla \\Pi(u^{k})\\,p^{k}$ is the directional derivative in the direction $p^{k}$. Use the following rules and parameters:\n- Use initial step size $\\alpha_{0} = 1$, backtracking factor $\\tau = 0.5$, and Armijo constant $c_{1} = 10^{-4}$.\n- If the direction is not a descent direction, meaning $\\nabla \\Pi(u^{k})\\,p^{k} \\ge 0$, replace $p^{k}$ by the steepest descent direction $-\\,\\nabla \\Pi(u^{k})$ before starting backtracking.\n- If $p^{k} = 0$ after this check, return $\\alpha = 1$ by convention, since $\\Pi(u^{k} + \\alpha\\,p^{k}) = \\Pi(u^{k})$ and the condition holds trivially.\n- During backtracking, repeatedly test the Armijo condition starting from $\\alpha = \\alpha_{0}$ and update $\\alpha \\leftarrow \\tau\\,\\alpha$ until the condition is first satisfied. For numerical robustness, one may cap the number of backtracks at a fixed finite integer.\n\nBase your implementation on fundamental principles: compute $\\nabla \\Pi(u)$ directly from the definition of $\\Pi(u)$ by differentiation, evaluate the Armijo condition as given, and perform the stated backtracking. All quantities are nondimensional (no physical units).\n\nImplement a program that, for each test case below, computes the first acceptable $\\alpha$ according to the rules above.\n\nTest suite (each case specifies $(k,\\beta,f,u^{k},p^{k})$):\n- Case A (Newton-like step on a quadratic energy, expected to accept $\\alpha$ near unity): $k = 10$, $\\beta = 0$, $f = 4$, $u^{k} = 0.5$, $p^{k} = -0.1$.\n- Case B (non-descent input direction; enforce steepest descent, moderate stiffness so that the first acceptable halved step is $\\alpha = 0.5$): $k = 3$, $\\beta = 0$, $f = 0$, $u^{k} = 1.0$, $p^{k} = +1.0$.\n- Case C (steepest descent on a quadratic with stronger stiffness so that $\\alpha = 0.25$ is the first acceptable step): $k = 5$, $\\beta = 0$, $f = 0$, $u^{k} = 1.0$, $p^{k} = -5.0$.\n- Case D (zero direction; return $\\alpha = 1$ by convention; also exercises the quartic term): $k = 2$, $\\beta = 5$, $f = 0$, $u^{k} = 0.0$, $p^{k} = 0.0$.\n\nYour program must produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order of the test cases, for example $[\\alpha_{A},\\alpha_{B},\\alpha_{C},\\alpha_{D}]$. The answers for each case must be real numbers (floating-point values).", "solution": "The user-provided problem is assessed as valid. It is scientifically grounded in the principles of numerical optimization for nonlinear mechanics, well-posed with a clear and deterministic algorithm, and formally specified with all necessary data and conditions. The following solution adheres to the specified algorithmic procedure.\n\nThe core task is to implement an Armijo backtracking line search to find an acceptable step size $\\alpha$ for minimizing a one-dimensional potential energy function $\\Pi(u)$.\n\nThe potential energy is given by:\n$$ \\Pi(u) = \\tfrac{1}{2}\\,k\\,u^{2} + \\tfrac{1}{4}\\,\\beta\\,u^{4} - f\\,u $$\nwhere $k$, $\\beta$, $f$, and $u$ are nondimensional real numbers.\n\nThe first step is to derive the gradient of the potential energy, $\\nabla\\Pi(u)$, which represents the residual force in the mechanical system. By differentiating $\\Pi(u)$ with respect to $u$, we obtain:\n$$ \\nabla\\Pi(u) = \\frac{d\\Pi}{du} = k\\,u + \\beta\\,u^{3} - f $$\n\nThe Armijo line search algorithm aims to find a step size $\\alpha \\in (0, 1]$ that satisfies the sufficient decrease condition. This condition ensures that the new point $u^{k+1} = u^k + \\alpha p^k$ yields a reduction in potential energy that is at least a fraction of the linear decrease predicted by the first-order Taylor expansion at $u^k$. The condition is formally stated as:\n$$ \\Pi(u^{k} + \\alpha\\,p^{k}) \\le \\Pi(u^{k}) + c_{1}\\,\\alpha\\,\\nabla \\Pi(u^{k})\\,p^{k} $$\nHere, $u^k$ is the current iterate, $p^k$ is the search direction, $c_1$ is the Armijo constant (given as $c_1 = 10^{-4}$), and the term $\\nabla\\Pi(u^k)p^k$ is the directional derivative of $\\Pi$ at $u^k$ in the direction $p^k$.\n\nThe specified algorithmic procedure is as follows:\n\n1.  **Direction Verification**: At the current iterate $u^k$, calculate the gradient $\\nabla\\Pi(u^k)$ and the directional derivative $\\nabla\\Pi(u^k)p^k$. A valid search direction must be a descent direction, meaning it must satisfy $\\nabla\\Pi(u^k)p^k  0$. If this is not the case (i.e., if $\\nabla\\Pi(u^k)p^k \\ge 0$), the provided search direction $p^k$ is discarded. It is replaced by the steepest descent direction, which is defined as $p^k \\leftarrow -\\nabla\\Pi(u^k)$.\n\n2.  **Zero Direction Handling**: After the direction verification step, the resulting search direction $p^k$ is checked. If $p^k = 0$, it implies that $\\nabla\\Pi(u^k)=0$, meaning $u^k$ is a stationary point (an equilibrium position). At a stationary point, no further progress can be made. The Armijo condition simplifies to $\\Pi(u^k) \\le \\Pi(u^k)$, which is trivially true. By the problem's convention, an alpha value of $\\alpha=1$ is returned in this case.\n\n3.  **Backtracking Search**: If the search direction $p^k$ is a non-zero descent direction, the backtracking procedure begins.\n    - The initial trial step size is set to $\\alpha = \\alpha_0 = 1$.\n    - The Armijo sufficient decrease condition is evaluated with the current $\\alpha$.\n    - If the condition is satisfied, the current $\\alpha$ is accepted, and the search terminates.\n    - If the condition is not satisfied, the step size is too large. It is reduced by the backtracking factor $\\tau = 0.5$, so the new trial step size becomes $\\alpha \\leftarrow \\tau\\alpha$.\n    - This process of checking the condition and reducing $\\alpha$ is repeated until the condition is first satisfied. The properties of continuously differentiable functions guarantee that this process will terminate for a sufficiently small $\\alpha > 0$.\n\nThis complete algorithm is applied to each of the provided test cases $(k, \\beta, f, u^k, p^k)$ to determine the first acceptable step size $\\alpha$.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the Armijo line search step size for a series of test cases.\n    \"\"\"\n\n    # Test cases: tuples of (k, beta, f, u_k, p_k)\n    test_cases = [\n        (10.0, 0.0, 4.0, 0.5, -0.1), # Case A\n        (3.0, 0.0, 0.0, 1.0, 1.0),  # Case B\n        (5.0, 0.0, 0.0, 1.0, -5.0), # Case C\n        (2.0, 5.0, 0.0, 0.0, 0.0)   # Case D\n    ]\n\n    # --- Helper functions for potential energy and its gradient ---\n    def pi_potential(u, k, beta, f):\n        \"\"\"Computes the potential energy Pi(u) as a scalar.\"\"\"\n        return 0.5 * k * u**2 + 0.25 * beta * u**4 - f * u\n\n    def grad_pi_potential(u, k, beta, f):\n        \"\"\"Computes the gradient of the potential energy nabla Pi(u) as a scalar.\"\"\"\n        return k * u + beta * u**3 - f\n\n    def perform_line_search(k, beta, f, u_k, p_k):\n        \"\"\"\n        Performs the Armijo backtracking line search for a single case.\n        \"\"\"\n        # Line search parameters as defined in the problem\n        c1 = 1e-4\n        tau = 0.5\n        alpha_0 = 1.0\n\n        # Calculate gradient at the current iterate u_k\n        grad_k = grad_pi_potential(u_k, k, beta, f)\n        \n        current_p_k = float(p_k)\n\n        # Step 1: Check if the search direction is a descent direction.\n        # If not, replace it with the steepest descent direction.\n        dir_deriv = grad_k * current_p_k\n        if dir_deriv >= 0:\n            current_p_k = -grad_k\n        \n        # Step 2: Handle the zero direction case.\n        # This check occurs *after* the potential update of p_k.\n        if np.isclose(current_p_k, 0.0):\n            return 1.0\n        \n        # Step 3: Perform backtracking line search.\n        # Re-calculate directional derivative in case p_k was updated.\n        dir_deriv = grad_k * current_p_k\n        \n        alpha = alpha_0\n        pi_k = pi_potential(u_k, k, beta, f)\n        \n        # This term on the RHS of the Armijo condition is constant during the loop\n        armijo_rhs_slope = c1 * dir_deriv\n        \n        # Loop until the Armijo condition is satisfied\n        while True:\n            lhs = pi_potential(u_k + alpha * current_p_k, k, beta, f)\n            rhs = pi_k + alpha * armijo_rhs_slope\n            \n            if lhs = rhs:\n                # Sufficient decrease condition is met\n                return alpha\n            \n            # Condition not met, backtrack (reduce step size)\n            alpha *= tau\n\n    results = []\n    for case in test_cases:\n        alpha_result = perform_line_search(*case)\n        results.append(alpha_result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3577625"}]}