{"hands_on_practices": [{"introduction": "To build a solid understanding of the finite element method, we begin with the fundamental building blocks. This first exercise focuses on the one-dimensional quadratic element, providing a clear and simple context to master the construction of Lagrange shape functions. By deriving these functions and verifying their core properties—the Kronecker-delta for nodal interpolation and the partition of unity for representing constant states—you will establish a firm foundation for tackling more complex elements. [@problem_id:3599831]", "problem": "In computational solid mechanics, consider a one-dimensional quadratic isoparametric finite element with natural coordinate $\\xi \\in [-1,1]$ and nodal positions at $\\xi_{1}=-1$, $\\xi_{2}=0$, and $\\xi_{3}=1$. Using the definition of Lagrange interpolation polynomials, construct the shape functions $N_{1}(\\xi)$, $N_{2}(\\xi)$, and $N_{3}(\\xi)$ as polynomials of degree at most $2$ such that they satisfy the Kronecker-delta property $N_{i}(\\xi_{j})=\\delta_{ij}$. Then, using the definition of the finite element interpolation $u^{h}(\\xi)=\\sum_{i=1}^{3}N_{i}(\\xi)\\,u_{i}$ for arbitrary nodal values $u_{1}$, $u_{2}$, and $u_{3}$, verify the nodal interpolation property $u^{h}(\\xi_{j})=u_{j}$ for $j\\in\\{1,2,3\\}$.\n\nFinally, define the partition-of-unity function $S(\\xi)=N_{1}(\\xi)+N_{2}(\\xi)+N_{3}(\\xi)$. Provide $S(\\xi)$ in its simplest form as your final answer. No numerical rounding is required, and no physical units are involved. Express the final answer as a single closed-form analytic expression.", "solution": "The user has provided a valid problem statement from the field of computational solid mechanics. It is scientifically grounded, well-posed, and objective. We will proceed with a full solution.\n\nThe problem requires the construction of shape functions for a one-dimensional quadratic finite element, verification of the interpolation property, and the calculation of the sum of these shape functions, known as the partition-of-unity function.\n\nThe element is defined in a natural coordinate system $\\xi \\in [-1, 1]$, with three nodes located at $\\xi_1 = -1$, $\\xi_2 = 0$, and $\\xi_3 = 1$.\n\nFirst, we construct the shape functions $N_1(\\xi)$, $N_2(\\xi)$, and $N_3(\\xi)$ using Lagrange interpolation polynomials. The general form of the $i$-th Lagrange basis polynomial for a set of $n$ distinct points $\\{\\xi_k\\}_{k=1}^n$ is given by:\n$$L_i(\\xi) = \\prod_{j=1, j \\neq i}^{n} \\frac{\\xi - \\xi_j}{\\xi_i - \\xi_j}$$\nThe shape function $N_i(\\xi)$ is defined as the Lagrange polynomial that has a value of $1$ at node $\\xi_i$ and $0$ at all other nodes $\\xi_j$ (where $j \\neq i$). This corresponds exactly to the Lagrange basis polynomial, $N_i(\\xi) = L_i(\\xi)$. For our 3-node element ($n=3$), we have:\n\nFor $N_1(\\xi)$, associated with node $\\xi_1=-1$:\n$$N_1(\\xi) = \\frac{\\xi - \\xi_2}{\\xi_1 - \\xi_2} \\cdot \\frac{\\xi - \\xi_3}{\\xi_1 - \\xi_3} = \\frac{\\xi - 0}{-1 - 0} \\cdot \\frac{\\xi - 1}{-1 - 1} = \\frac{\\xi}{-1} \\cdot \\frac{\\xi - 1}{-2} = \\frac{1}{2}\\xi(\\xi - 1) = \\frac{1}{2}\\xi^2 - \\frac{1}{2}\\xi$$\n\nFor $N_2(\\xi)$, associated with node $\\xi_2=0$:\n$$N_2(\\xi) = \\frac{\\xi - \\xi_1}{\\xi_2 - \\xi_1} \\cdot \\frac{\\xi - \\xi_3}{\\xi_2 - \\xi_3} = \\frac{\\xi - (-1)}{0 - (-1)} \\cdot \\frac{\\xi - 1}{0 - 1} = \\frac{\\xi + 1}{1} \\cdot \\frac{\\xi - 1}{-1} = -(\\xi+1)(\\xi-1) = -(\\xi^2 - 1) = 1 - \\xi^2$$\n\nFor $N_3(\\xi)$, associated with node $\\xi_3=1$:\n$$N_3(\\xi) = \\frac{\\xi - \\xi_1}{\\xi_3 - \\xi_1} \\cdot \\frac{\\xi - \\xi_2}{\\xi_3 - \\xi_2} = \\frac{\\xi - (-1)}{1 - (-1)} \\cdot \\frac{\\xi - 0}{1 - 0} = \\frac{\\xi + 1}{2} \\cdot \\frac{\\xi}{1} = \\frac{1}{2}\\xi(\\xi + 1) = \\frac{1}{2}\\xi^2 + \\frac{1}{2}\\xi$$\n\nThese shape functions satisfy the Kronecker-delta property $N_i(\\xi_j) = \\delta_{ij}$ by construction.\n\nNext, we verify the nodal interpolation property for the finite element approximation $u^h(\\xi) = \\sum_{i=1}^{3} N_i(\\xi) u_i = N_1(\\xi)u_1 + N_2(\\xi)u_2 + N_3(\\xi)u_3$. We must show that $u^h(\\xi_j) = u_j$ for $j \\in \\{1, 2, 3\\}$.\n\nFor $j=1$ (at node $\\xi_1 = -1$):\n$$u^h(\\xi_1) = N_1(\\xi_1)u_1 + N_2(\\xi_1)u_2 + N_3(\\xi_1)u_3$$\nUsing the Kronecker-delta property ($N_1(\\xi_1)=1$, $N_2(\\xi_1)=0$, $N_3(\\xi_1)=0$):\n$$u^h(-1) = (1)u_1 + (0)u_2 + (0)u_3 = u_1$$\n\nFor $j=2$ (at node $\\xi_2 = 0$):\n$$u^h(\\xi_2) = N_1(\\xi_2)u_1 + N_2(\\xi_2)u_2 + N_3(\\xi_2)u_3$$\nUsing the Kronecker-delta property ($N_1(\\xi_2)=0$, $N_2(\\xi_2)=1$, $N_3(\\xi_2)=0$):\n$$u^h(0) = (0)u_1 + (1)u_2 + (0)u_3 = u_2$$\n\nFor $j=3$ (at node $\\xi_3 = 1$):\n$$u^h(\\xi_3) = N_1(\\xi_3)u_1 + N_2(\\xi_3)u_2 + N_3(\\xi_3)u_3$$\nUsing the Kronecker-delta property ($N_1(\\xi_3)=0$, $N_2(\\xi_3)=0$, $N_3(\\xi_3)=1$):\n$$u^h(1) = (0)u_1 + (0)u_2 + (1)u_3 = u_3$$\nThe nodal interpolation property is thus verified.\n\nFinally, we find the simplest form of the partition-of-unity function $S(\\xi) = N_1(\\xi) + N_2(\\xi) + N_3(\\xi)$. We sum the derived shape functions:\n$$S(\\xi) = \\left(\\frac{1}{2}\\xi^2 - \\frac{1}{2}\\xi\\right) + \\left(1 - \\xi^2\\right) + \\left(\\frac{1}{2}\\xi^2 + \\frac{1}{2}\\xi\\right)$$\nWe group the terms by powers of $\\xi$:\n$$S(\\xi) = \\left(\\frac{1}{2}\\xi^2 - \\xi^2 + \\frac{1}{2}\\xi^2\\right) + \\left(-\\frac{1}{2}\\xi + \\frac{1}{2}\\xi\\right) + 1$$\nSimplifying the coefficients:\n$$S(\\xi) = \\left(\\frac{1}{2} - 1 + \\frac{1}{2}\\right)\\xi^2 + \\left(-\\frac{1}{2} + \\frac{1}{2}\\right)\\xi + 1$$\n$$S(\\xi) = (0)\\xi^2 + (0)\\xi + 1$$\n$$S(\\xi) = 1$$\nThe sum of the shape functions is equal to $1$ for all $\\xi \\in [-1, 1]$. This is the partition of unity property, which ensures that the element can exactly represent a constant field. The simplest form of $S(\\xi)$ is $1$.", "answer": "$$\\boxed{1}$$", "id": "3599831"}, {"introduction": "Having mastered the 1D case, we now advance to two dimensions with the six-node quadratic triangle (T6), a versatile element widely used in structural analysis. This practice introduces barycentric coordinates, the natural framework for triangular domains, and extends the principles of Lagrange interpolation to elements with both vertex and midside nodes. Constructing these shape functions will deepen your understanding of how interpolation works over more complex geometries and nodal arrangements. [@problem_id:3599866]", "problem": "Consider a two-dimensional triangular isoparametric finite element used in the Finite Element Method (FEM) for computational solid mechanics. Let the natural (barycentric) coordinates be denoted by $L_1$, $L_2$, and $L_3$, which satisfy $L_1 + L_2 + L_3 = 1$ and $L_i \\ge 0$ inside the triangle, with $L_i$ equal to the vertex-associated area coordinates. A six-node quadratic triangle (often denoted as $T6$) has nodes located at the three vertices and the three midpoints of the edges. In barycentric coordinates, the nodal locations are:\n- Vertex nodes: $(L_1,L_2,L_3) = (1,0,0)$, $(0,1,0)$, $(0,0,1)$,\n- Midside nodes: $(L_1,L_2,L_3) = \\left(\\frac{1}{2},\\frac{1}{2},0\\right)$, $\\left(0,\\frac{1}{2},\\frac{1}{2}\\right)$, $\\left(\\frac{1}{2},0,\\frac{1}{2}\\right)$.\n\nStarting from the definition of barycentric coordinates and the Lagrange interpolation requirements for quadratic completeness on the triangle, derive explicit analytic expressions for the six quadratic Lagrange shape functions $\\{N_1,N_2,N_3,N_{12},N_{23},N_{31}\\}$ associated with the nodes listed above. Each shape function must be a polynomial in $(L_1,L_2,L_3)$ of total degree two, must satisfy the Kronecker-delta nodal property $N_a(\\text{node }b) = \\delta_{ab}$ for all six nodes, and the partition of unity $\\sum_{a} N_a = 1$.\n\nThen, verify the nodal interpolation property at all six nodes by evaluating each shape function at the corresponding nodal barycentric coordinates.\n\nYour final answer must present the six derived shape functions as a single row vector of closed-form expressions in barycentric coordinates, ordered as $[N_1, N_2, N_3, N_{12}, N_{23}, N_{31}]$. No numerical rounding is required, and no units are involved.", "solution": "The problem has been validated and is scientifically grounded, well-posed, and objective. It is a standard problem in the Finite Element Method (FEM) concerning the derivation of shape functions for a specific element type. All required data and conditions are provided, and there are no contradictions. We may proceed with the solution.\n\nThe objective is to derive the six quadratic Lagrange shape functions $\\{N_1, N_2, N_3, N_{12}, N_{23}, N_{31}\\}$ for a 6-node quadratic triangle. The derivation will be based on the Kronecker-delta property, which states that a shape function $N_a$ must be unity at its corresponding node $a$ and zero at all other nodes. The shape functions are required to be polynomials of total degree two in the barycentric coordinates $L_1$, $L_2$, and $L_3$.\n\nThe six nodes of the T6 element are located at the following barycentric coordinates $(L_1, L_2, L_3)$:\n- Node 1 (vertex): $(1,0,0)$\n- Node 2 (vertex): $(0,1,0)$\n- Node 3 (vertex): $(0,0,1)$\n- Node 12 (midside): $(\\frac{1}{2},\\frac{1}{2},0)$\n- Node 23 (midside): $(0,\\frac{1}{2},\\frac{1}{2})$\n- Node 31 (midside): $(\\frac{1}{2},0,\\frac{1}{2})$\n\nA powerful method for constructing Lagrange polynomials is to build them from their zeros. A shape function $N_a$ must be zero at all nodes $b \\neq a$.\n\n**1. Derivation of Vertex Node Shape Functions ($N_1, N_2, N_3$)**\n\nLet us derive the shape function $N_1$ associated with vertex node 1. By the Kronecker-delta property, $N_1$ must be $1$ at node 1 and $0$ at nodes 2, 3, 12, 23, and 31.\n\nThe locations of the nodes where $N_1$ must be zero are:\n- Node 2: $(0,1,0)$\n- Node 3: $(0,0,1)$\n- Node 23: $(0,\\frac{1}{2},\\frac{1}{2})$\n\nAll three of these nodes lie on the line defined by the equation $L_1 = 0$. Therefore, the polynomial for $N_1$ must contain a factor of $L_1$.\n\nThe remaining nodes where $N_1$ must be zero are:\n- Node 12: $(\\frac{1}{2},\\frac{1}{2},0)$\n- Node 31: $(\\frac{1}{2},0,\\frac{1}{2})$\n\nBoth of these nodes lie on the line defined by the equation $L_1 = \\frac{1}{2}$, which can be written as $L_1 - \\frac{1}{2} = 0$. Therefore, $N_1$ must also contain a factor of $(L_1 - \\frac{1}{2})$.\n\nCombining these factors, we can propose a form for $N_1$ as a product of these two linear factors:\n$$N_1(L_1, L_2, L_3) = C \\cdot L_1 \\left(L_1 - \\frac{1}{2}\\right)$$\nThis expression is a quadratic polynomial in $L_1$, and by construction, it is zero at the five required nodes. The constant $C$ is determined by imposing the condition that $N_1=1$ at node 1, where $(L_1, L_2, L_3) = (1,0,0)$.\n$$N_1(1,0,0) = C \\cdot 1 \\left(1 - \\frac{1}{2}\\right) = C \\cdot \\frac{1}{2} = 1$$\nSolving for $C$ gives $C=2$. Substituting this back into the expression for $N_1$:\n$$N_1 = 2 \\cdot L_1 \\left(L_1 - \\frac{1}{2}\\right) = L_1 (2L_1 - 1)$$\nBy symmetry, the shape functions for the other two vertex nodes, $N_2$ and $N_3$, can be written directly:\n$$N_2 = L_2 (2L_2 - 1)$$\n$$N_3 = L_3 (2L_3 - 1)$$\n\n**2. Derivation of Midside Node Shape Functions ($N_{12}, N_{23}, N_{31}$)**\n\nNext, let us derive the shape function $N_{12}$ for the midside node between vertices 1 and 2. $N_{12}$ must be $1$ at node 12 and $0$ at all other nodes.\n\nThe nodes where $N_{12}$ must be zero are 1, 2, 3, 23, and 31.\n- Nodes 2, 3, and 23 lie on the line $L_1 = 0$.\n- Nodes 1, 3, and 31 lie on the line $L_2 = 0$.\n\nFor $N_{12}$ to be zero at all these points, its polynomial representation must contain factors of $L_1$ and $L_2$. We propose the form:\n$$N_{12}(L_1, L_2, L_3) = C \\cdot L_1 L_2$$\nThis expression is a quadratic polynomial. It is zero on the line $L_1=0$ (edge 2-3) and on the line $L_2=0$ (edge 1-3), thus correctly evaluating to zero at nodes 1, 2, 3, 23, and 31. The constant $C$ is determined by the condition that $N_{12}=1$ at node 12, where $(L_1, L_2, L_3) = (\\frac{1}{2},\\frac{1}{2},0)$.\n$$N_{12}\\left(\\frac{1}{2},\\frac{1}{2},0\\right) = C \\cdot \\frac{1}{2} \\cdot \\frac{1}{2} = C \\cdot \\frac{1}{4} = 1$$\nThis yields $C=4$. The shape function is:\n$$N_{12} = 4 L_1 L_2$$\nBy symmetry, the shape functions for the other midside nodes, $N_{23}$ and $N_{31}$, are:\n$$N_{23} = 4 L_2 L_3$$\n$$N_{31} = 4 L_3 L_1$$\n\n**3. Verification of Nodal Properties and Partition of Unity**\n\nThe derived shape functions are:\n$N_1 = L_1(2L_1 - 1)$\n$N_2 = L_2(2L_2 - 1)$\n$N_3 = L_3(2L_3 - 1)$\n$N_{12} = 4 L_1 L_2$\n$N_{23} = 4 L_2 L_3$\n$N_{31} = 4 L_3 L_1$\n\n**Kronecker-Delta Property Verification:** Let's verify this for $N_1$ and $N_{12}$ as examples.\nFor $N_1 = L_1(2L_1-1)$:\n- At Node 1 $(1,0,0)$: $N_1 = 1(2(1)-1) = 1$.\n- At Node 2 $(0,1,0)$: $N_1 = 0(2(0)-1) = 0$.\n- At Node 3 $(0,0,1)$: $N_1 = 0(2(0)-1) = 0$.\n- At Node 12 $(\\frac{1}{2},\\frac{1}{2},0)$: $N_1 = \\frac{1}{2}(2(\\frac{1}{2})-1) = 0$.\n- At Node 23 $(0,\\frac{1}{2},\\frac{1}{2})$: $N_1 = 0(2(0)-1) = 0$.\n- At Node 31 $(\\frac{1}{2},0,\\frac{1}{2})$: $N_1 = \\frac{1}{2}(2(\\frac{1}{2})-1) = 0$.\nThe property holds for $N_1$. By symmetry, it holds for $N_2$ and $N_3$.\n\nFor $N_{12} = 4L_1L_2$:\n- At Node 1 $(1,0,0)$: $N_{12} = 4(1)(0) = 0$.\n- At Node 2 $(0,1,0)$: $N_{12} = 4(0)(1) = 0$.\n- At Node 3 $(0,0,1)$: $N_{12} = 4(0)(0) = 0$.\n- At Node 12 $(\\frac{1}{2},\\frac{1}{2},0)$: $N_{12} = 4(\\frac{1}{2})(\\frac{1}{2}) = 1$.\n- At Node 23 $(0,\\frac{1}{2},\\frac{1}{2})$: $N_{12} = 4(0)(\\frac{1}{2}) = 0$.\n- At Node 31 $(\\frac{1}{2},0,\\frac{1}{2})$: $N_{12} = 4(\\frac{1}{2})(0) = 0$.\nThe property holds for $N_{12}$. By symmetry, it holds for $N_{23}$ and $N_{31}$.\n\n**Partition of Unity Verification:** We must check if $\\sum_{a} N_a = 1$.\n$$ \\sum_{a} N_a = N_1 + N_2 + N_3 + N_{12} + N_{23} + N_{31} $$\n$$ \\sum_{a} N_a = L_1(2L_1-1) + L_2(2L_2-1) + L_3(2L_3-1) + 4L_1L_2 + 4L_2L_3 + 4L_3L_1 $$\n$$ \\sum_{a} N_a = (2L_1^2 - L_1) + (2L_2^2 - L_2) + (2L_3^2 - L_3) + 4L_1L_2 + 4L_2L_3 + 4L_3L_1 $$\nLet us rearrange the terms:\n$$ \\sum_{a} N_a = (2L_1^2 + 2L_2^2 + 2L_3^2 + 4L_1L_2 + 4L_2L_3 + 4L_3L_1) - (L_1 + L_2 + L_3) $$\nWe can factor out a $2$ from the first parenthesis:\n$$ \\sum_{a} N_a = 2(L_1^2 + L_2^2 + L_3^2 + 2L_1L_2 + 2L_2L_3 + 2L_3L_1) - (L_1 + L_2 + L_3) $$\nRecognizing the first term as the expansion of $2(L_1+L_2+L_3)^2$:\n$$ \\sum_{a} N_a = 2(L_1+L_2+L_3)^2 - (L_1+L_2+L_3) $$\nUsing the fundamental property of barycentric coordinates, $L_1+L_2+L_3 = 1$:\n$$ \\sum_{a} N_a = 2(1)^2 - 1 = 2-1 = 1 $$\nThe partition of unity is satisfied. All derived functions are correct.\n\nThe final answer is the set of six shape functions arranged in the specified order.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\nL_1(2L_1 - 1) & L_2(2L_2 - 1) & L_3(2L_3 - 1) & 4L_1L_2 & 4L_2L_3 & 4L_3L_1\n\\end{pmatrix}\n}\n$$", "id": "3599866"}, {"introduction": "The final practice bridges the gap between the theoretical construction of shape functions and their practical application in a finite element code. By analyzing the integrand of the element stiffness matrix for a bilinear quadrilateral (Q4) element, you will see how the polynomial degree of the shape functions directly determines the required order of numerical integration. This exercise [@problem_id:3599878] is crucial for ensuring the accuracy of a simulation, as it reveals the minimum Gauss quadrature rule needed to compute the stiffness matrix exactly under the given conditions.", "problem": "Consider an isoparametric four-node bilinear quadrilateral (Q4) finite element in two-dimensional linear elasticity with a constant constitutive matrix $C$ and an affine mapping from the reference square $\\{(\\xi,\\eta)\\,|\\, -1 \\le \\xi \\le 1,\\,-1 \\le \\eta \\le 1\\}$ to the physical element $\\Omega_{e}$. The affine mapping assumption implies a constant and positive Jacobian determinant $J$, with the Jacobian matrix $J$ independent of $(\\xi,\\eta)$. Let the standard bilinear shape functions be $N_{1}(\\xi,\\eta)$, $N_{2}(\\xi,\\eta)$, $N_{3}(\\xi,\\eta)$, $N_{4}(\\xi,\\eta)$, and let the strain-displacement matrix $B(\\xi,\\eta)$ be defined in terms of the spatial derivatives $\\partial N_{i}/\\partial x$ and $\\partial N_{i}/\\partial y$, obtained via the chain rule from the natural derivatives $\\partial N_{i}/\\partial \\xi$ and $\\partial N_{i}/\\partial \\eta$.\n\nStarting from first principles of the isoparametric formulation and the definition of bilinear shape functions on the reference domain, determine the highest polynomial degree in $(\\xi,\\eta)$ of the integrand of the element stiffness integral\n$$\n\\int_{\\Omega_{e}} B^{T} C B\\, d\\Omega,\n$$\nwhen it is expressed in natural coordinates via the mapping (so the integrand in natural coordinates is $B^{T} C B\\, J$). Then, deduce the minimal tensor-product Gauss–Legendre quadrature rule (number of points per natural coordinate direction) required to integrate this bivariate polynomial exactly.\n\nProvide your final answer as a row matrix containing three entries: the polynomial degree and the minimal number of Gauss points in the $\\xi$- and $\\eta$-directions, in that order. No numerical rounding is required.", "solution": "The problem asks for the highest polynomial degree of the integrand of the element stiffness matrix for an isoparametric four-node bilinear quadrilateral element, given an affine mapping, and the minimal Gauss-Legendre quadrature rule for its exact integration. The solution is derived from first principles.\n\nLet the natural coordinates be $(\\xi, \\eta)$, where $-1 \\le \\xi \\le 1$ and $-1 \\le \\eta \\le 1$. The four-node bilinear shape functions $N_i(\\xi, \\eta)$ are given by:\n$$\n\\begin{aligned}\nN_{1}(\\xi,\\eta) &= \\frac{1}{4}(1-\\xi)(1-\\eta) \\\\\nN_{2}(\\xi,\\eta) &= \\frac{1}{4}(1+\\xi)(1-\\eta) \\\\\nN_{3}(\\xi,\\eta) &= \\frac{1}{4}(1+\\xi)(1+\\eta) \\\\\nN_{4}(\\xi,\\eta) &= \\frac{1}{4}(1-\\xi)(1+\\eta)\n\\end{aligned}\n$$\nThese functions are bilinear, meaning they are linear in each coordinate variable separately.\n\nThe first step is to compute the derivatives of the shape functions with respect to the natural coordinates. Let's take $N_1$ as an example:\n$$\n\\frac{\\partial N_{1}}{\\partial \\xi} = \\frac{\\partial}{\\partial \\xi} \\left[ \\frac{1}{4}(1 - \\xi - \\eta + \\xi\\eta) \\right] = \\frac{1}{4}(-1 + \\eta)\n$$\n$$\n\\frac{\\partial N_{1}}{\\partial \\eta} = \\frac{\\partial}{\\partial \\eta} \\left[ \\frac{1}{4}(1 - \\xi - \\eta + \\xi\\eta) \\right] = \\frac{1}{4}(-1 + \\xi)\n$$\nBy inspection of all four shape functions, we find a general pattern: $\\frac{\\partial N_{i}}{\\partial \\xi}$ is a linear function of $\\eta$ only, and $\\frac{\\partial N_{i}}{\\partial \\eta}$ is a linear function of $\\xi$ only. Thus, these derivatives are polynomials of degree $1$ in one natural coordinate and degree $0$ in the other.\n\nThe relationship between physical coordinate derivatives $(\\partial/\\partial x, \\partial/\\partial y)$ and natural coordinate derivatives $(\\partial/\\partial \\xi, \\partial/\\partial \\eta)$ is given by the Jacobian matrix of the coordinate transformation, $\\mathbf{J}$.\n$$\n\\begin{pmatrix} \\frac{\\partial f}{\\partial \\xi} \\\\ \\frac{\\partial f}{\\partial \\eta} \\end{pmatrix} = \\mathbf{J} \\begin{pmatrix} \\frac{\\partial f}{\\partial x} \\\\ \\frac{\\partial f}{\\partial y} \\end{pmatrix}, \\quad \\text{where} \\quad \\mathbf{J} = \\begin{pmatrix} \\frac{\\partial x}{\\partial \\xi} & \\frac{\\partial y}{\\partial \\xi} \\\\ \\frac{\\partial x}{\\partial \\eta} & \\frac{\\partial y}{\\partial \\eta} \\end{pmatrix}\n$$\nThe problem states that the mapping from the reference to the physical element is affine. A key property of an affine mapping is that its Jacobian matrix $\\mathbf{J}$ is constant (independent of position $(\\xi, \\eta)$). Consequently, the inverse Jacobian matrix, $\\mathbf{J}^{-1}$, and the Jacobian determinant, $J = \\det(\\mathbf{J})$, are also constant.\n\nThe spatial derivatives of the shape functions are obtained via the inverse relationship:\n$$\n\\begin{pmatrix} \\frac{\\partial N_{i}}{\\partial x} \\\\ \\frac{\\partial N_{i}}{\\partial y} \\end{pmatrix} = \\mathbf{J}^{-1} \\begin{pmatrix} \\frac{\\partial N_{i}}{\\partial \\xi} \\\\ \\frac{\\partial N_{i}}{\\partial \\eta} \\end{pmatrix}\n$$\nLet the constant entries of the inverse Jacobian be $J^{-1}_{kl}$. Then we have:\n$$\n\\frac{\\partial N_{i}}{\\partial x} = J^{-1}_{11} \\frac{\\partial N_{i}}{\\partial \\xi} + J^{-1}_{12} \\frac{\\partial N_{i}}{\\partial \\eta}\n$$\n$$\n\\frac{\\partial N_{i}}{\\partial y} = J^{-1}_{21} \\frac{\\partial N_{i}}{\\partial \\xi} + J^{-1}_{22} \\frac{\\partial N_{i}}{\\partial \\eta}\n$$\nSince $\\frac{\\partial N_{i}}{\\partial \\xi}$ is a polynomial of degree $1$ in $\\eta$ and $\\frac{\\partial N_{i}}{\\partial \\eta}$ is a polynomial of degree $1$ in $\\xi$, and $J^{-1}_{kl}$ are constants, the spatial derivatives $\\frac{\\partial N_{i}}{\\partial x}$ and $\\frac{\\partial N_{i}}{\\partial y}$ are linear combinations of a function of $\\xi$ and a function of $\\eta$. Specifically, each spatial derivative is a general linear polynomial of the form $a\\xi + b\\eta + c$.\n\nThe strain-displacement matrix, $B$, relates the strain vector $\\boldsymbol{\\epsilon} = \\{\\epsilon_{xx}, \\epsilon_{yy}, \\gamma_{xy}\\}^T$ to the nodal displacement vector $\\mathbf{d}$. For a 2D problem, it is an $3 \\times 8$ matrix whose entries are composed of the spatial derivatives of the shape functions. A typical structure is:\n$$\nB(\\xi,\\eta) = \\begin{pmatrix}\n\\frac{\\partial N_1}{\\partial x} & 0 & \\dots & \\frac{\\partial N_4}{\\partial x} & 0 \\\\\n0 & \\frac{\\partial N_1}{\\partial y} & \\dots & 0 & \\frac{\\partial N_4}{\\partial y} \\\\\n\\frac{\\partial N_1}{\\partial y} & \\frac{\\partial N_1}{\\partial x} & \\dots & \\frac{\\partial N_4}{\\partial y} & \\frac{\\partial N_4}{\\partial x}\n\\end{pmatrix}\n$$\nSince every entry $\\frac{\\partial N_i}{\\partial x}$ and $\\frac{\\partial N_i}{\\partial y}$ is a polynomial of degree $1$ in $(\\xi, \\eta)$, every non-zero entry of the matrix $B(\\xi,\\eta)$ is a polynomial of degree $1$ in $(\\xi, \\eta)$.\n\nThe element stiffness integral in natural coordinates is $\\int_{-1}^{1} \\int_{-1}^{1} B^{T} C B\\, J \\,d\\xi\\,d\\eta$. The integrand is the matrix product $B^{T} C B J$.\n- $B$ is a $3 \\times 8$ matrix with entries being polynomials of degree at most $1$.\n- $C$ is a constant $3 \\times 3$ matrix.\n- $J$ is a constant scalar.\nThe product $B^T C B$ results in an $8 \\times 8$ matrix. Any entry of this matrix is a sum of products of entries from $B$ and constants from $C$. A typical term in this sum has the form $(\\text{entry of } B) \\times (\\text{constant}) \\times (\\text{entry of } B)$. Since each entry of $B$ is a linear polynomial in $\\xi$ and $\\eta$, their product is a quadratic polynomial. For instance, $(a_1\\xi + b_1\\eta + c_1)(a_2\\xi + b_2\\eta + c_2)$ yields terms up to $\\xi^2$, $\\eta^2$, and $\\xi\\eta$.\nTherefore, each entry of the matrix $B^T C B$ is a bivariate polynomial of total degree at most $2$. The highest power of $\\xi$ is $2$, and the highest power of $\\eta$ is $2$. As $J$ is a constant, the integrand $B^T C B J$ is a matrix whose entries are polynomials of total degree $2$. The question refers to the integrand as a scalar quantity, which can be interpreted as any entry of the resulting element stiffness matrix before integration. For instance, the $(i,j)$-th entry of the matrix to be integrated is a polynomial of total degree $2$. The highest polynomial degree in $(\\xi,\\eta)$ is $2$.\n\nNext, we determine the minimal Gauss-Legendre quadrature rule for exact integration. An $n$-point Gauss-Legendre rule can integrate a polynomial of degree up to $2n-1$ exactly. For a tensor-product rule over the square domain, we consider each direction independently.\nTo integrate with respect to $\\xi$, we must handle the highest polynomial degree in $\\xi$. As established, the integrand is a polynomial of degree $2$ in $\\xi$ for any fixed $\\eta$. Let $p_\\xi$ be the degree in $\\xi$, so $p_\\xi = 2$. We need to find the minimum integer $n_\\xi$ such that:\n$$\n2n_{\\xi} - 1 \\ge p_\\xi = 2\n$$\n$$\n2n_{\\xi} \\ge 3 \\implies n_{\\xi} \\ge 1.5\n$$\nThe smallest integer satisfying this is $n_{\\xi} = 2$.\n\nSimilarly, the integrand is a polynomial of degree $2$ in $\\eta$ for any fixed $\\xi$. Let $p_\\eta = 2$. We need to find the minimum integer $n_\\eta$ such that:\n$$\n2n_{\\eta} - 1 \\ge p_\\eta = 2\n$$\n$$\n2n_{\\eta} \\ge 3 \\implies n_{\\eta} \\ge 1.5\n$$\nThe smallest integer satisfying this is $n_{\\eta} = 2$.\n\nTherefore, the minimal tensor-product Gauss-Legendre quadrature rule required to integrate the stiffness matrix exactly is a $2 \\times 2$ rule, with $2$ points in the $\\xi$-direction and $2$ points in the $\\eta$-direction.\n\nThe three requested values are:\n1.  The highest polynomial degree of the integrand: $2$.\n2.  The minimal number of Gauss points in the $\\xi$-direction: $2$.\n3.  The minimal number of Gauss points in the $\\eta$-direction: $2$.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n2 & 2 & 2\n\\end{pmatrix}\n}\n$$", "id": "3599878"}]}