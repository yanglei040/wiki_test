{"hands_on_practices": [{"introduction": "Understanding the finite element method begins with mastering the construction of shape functions. This first practice focuses on the one-dimensional quadratic element, a fundamental building block in many analyses. By deriving the shape functions from the principles of Lagrange interpolation and evaluating them at specific Gauss-Legendre quadrature points, you will build a core skill essential for the numerical integration of element matrices [@problem_id:3589622].", "problem": "Consider the one-dimensional isoparametric quadratic bar element used in the Finite Element Method (FEM) on the parent coordinate domain $\\xi \\in [-1,1]$ with nodes at $\\xi_1 = -1$, $\\xi_2 = 0$, and $\\xi_3 = 1$. In a displacement-based formulation, the interpolated field is represented as $u(\\xi) = \\sum_{i=1}^{3} N_i(\\xi) u_i$, where $N_i(\\xi)$ are the shape functions associated with the nodes. Starting from polynomial interpolation principles consistent with the finite element method, derive the quadratic shape functions $N_i(\\xi)$ that satisfy the Kronecker delta property $N_i(\\xi_j) = \\delta_{ij}$, the partition of unity $\\sum_{i=1}^{3} N_i(\\xi) = 1$, and completeness for constant and linear fields. Then, compute $N_i(\\xi)$ and the derivatives $\\dfrac{dN_i}{d\\xi}(\\xi)$ at the Gauss–Legendre points $\\xi = \\pm \\dfrac{1}{\\sqrt{3}}$, which are used in $2$-point Gaussian quadrature. Provide the final answer as a single row matrix, with entries in the order\n$$N_1\\!\\left(-\\frac{1}{\\sqrt{3}}\\right),\\, N_2\\!\\left(-\\frac{1}{\\sqrt{3}}\\right),\\, N_3\\!\\left(-\\frac{1}{\\sqrt{3}}\\right),\\, \\frac{dN_1}{d\\xi}\\!\\left(-\\frac{1}{\\sqrt{3}}\\right),\\, \\frac{dN_2}{d\\xi}\\!\\left(-\\frac{1}{\\sqrt{3}}\\right),\\, \\frac{dN_3}{d\\xi}\\!\\left(-\\frac{1}{\\sqrt{3}}\\right),\\, N_1\\!\\left(\\frac{1}{\\sqrt{3}}\\right),\\, N_2\\!\\left(\\frac{1}{\\sqrt{3}}\\right),\\, N_3\\!\\left(\\frac{1}{\\sqrt{3}}\\right),\\, \\frac{dN_1}{d\\xi}\\!\\left(\\frac{1}{\\sqrt{3}}\\right),\\, \\frac{dN_2}{d\\xi}\\!\\left(\\frac{1}{\\sqrt{3}}\\right),\\, \\frac{dN_3}{d\\xi}\\!\\left(\\frac{1}{\\sqrt{3}}\\right). Express all entries in exact analytic form; no numerical rounding is required.", "solution": "The problem statement is first subjected to a rigorous validation process.\n\n### Step 1: Extract Givens\n-   Element Type: One-dimensional isoparametric quadratic bar element.\n-   Parent Coordinate Domain: $\\xi \\in [-1, 1]$.\n-   Nodal Coordinates: $\\xi_1 = -1$, $\\xi_2 = 0$, $\\xi_3 = 1$.\n-   Interpolated Field Representation: $u(\\xi) = \\sum_{i=1}^{3} N_i(\\xi) u_i$.\n-   Shape Function Properties:\n    -   Kronecker delta property: $N_i(\\xi_j) = \\delta_{ij}$.\n    -   Partition of unity: $\\sum_{i=1}^{3} N_i(\\xi) = 1$.\n    -   Completeness for constant and linear fields.\n-   Objective:\n    1.  Derive the quadratic shape functions $N_i(\\xi)$.\n    2.  Compute the values of $N_i(\\xi)$ and their derivatives $\\frac{dN_i}{d\\xi}(\\xi)$ at the $2$-point Gauss–Legendre quadrature points, which are $\\xi = \\pm \\frac{1}{\\sqrt{3}}$.\n-   Final Answer Format: A single row matrix containing $12$ specific values in a prescribed order, expressed in exact analytic form.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is a standard, fundamental exercise in the field of computational solid mechanics, specifically within the Finite Element Method (FEM).\n-   **Scientifically Grounded:** The concepts of isoparametric mapping, parent elements, shape functions (as Lagrange polynomials), and Gaussian quadrature are all canonical, well-established principles in numerical analysis and engineering. There are no scientific or factual unsoundness.\n-   **Well-Posed:** The problem is clearly defined and self-contained. The nodal positions and the required polynomial degree (quadratic) provide sufficient information to uniquely determine the shape functions. The task is unambiguous and has a unique, stable solution.\n-   **Objective:** The language is formal, precise, and devoid of any subjectivity, ambiguity, or opinion.\n\n### Step 3: Verdict and Action\nThe problem is deemed **valid**. It is scientifically sound, well-posed, objective, and complete. The solution process may proceed.\n\nThe shape functions $N_i(\\xi)$ for a quadratic element are second-degree polynomials. Given the nodal coordinates $\\xi_1 = -1$, $\\xi_2 = 0$, and $\\xi_3 = 1$, we can use the formula for Lagrange interpolation polynomials to derive them, as this construction inherently satisfies the Kronecker delta property $N_i(\\xi_j) = \\delta_{ij}$.\n\nFor a generic node $i$, the Lagrange shape function is given by:\n$$N_i(\\xi) = \\prod_{j=1, j\\neq i}^{3} \\frac{\\xi - \\xi_j}{\\xi_i - \\xi_j}$$\n\nFor node $1$ ($\\xi_1 = -1$):\n$$N_1(\\xi) = \\frac{\\xi - \\xi_2}{\\xi_1 - \\xi_2} \\cdot \\frac{\\xi - \\xi_3}{\\xi_1 - \\xi_3} = \\frac{\\xi - 0}{-1 - 0} \\cdot \\frac{\\xi - 1}{-1 - 1} = \\frac{\\xi}{-1} \\cdot \\frac{\\xi - 1}{-2} = \\frac{1}{2}\\xi(\\xi - 1) = \\frac{1}{2}\\xi^2 - \\frac{1}{2}\\xi$$\n\nFor node $2$ ($\\xi_2 = 0$):\n$$N_2(\\xi) = \\frac{\\xi - \\xi_1}{\\xi_2 - \\xi_1} \\cdot \\frac{\\xi - \\xi_3}{\\xi_2 - \\xi_3} = \\frac{\\xi - (-1)}{0 - (-1)} \\cdot \\frac{\\xi - 1}{0 - 1} = \\frac{\\xi + 1}{1} \\cdot \\frac{\\xi - 1}{-1} = -(\\xi+1)(\\xi-1) = 1 - \\xi^2$$\n\nFor node $3$ ($\\xi_3 = 1$):\n$$N_3(\\xi) = \\frac{\\xi - \\xi_1}{\\xi_3 - \\xi_1} \\cdot \\frac{\\xi - \\xi_2}{\\xi_3 - \\xi_2} = \\frac{\\xi - (-1)}{1 - (-1)} \\cdot \\frac{\\xi - 0}{1 - 0} = \\frac{\\xi + 1}{2} \\cdot \\frac{\\xi}{1} = \\frac{1}{2}\\xi(\\xi + 1) = \\frac{1}{2}\\xi^2 + \\frac{1}{2}\\xi$$\n\nThese functions satisfy the partition of unity property:\n$$\\sum_{i=1}^{3} N_i(\\xi) = \\left(\\frac{1}{2}\\xi^2 - \\frac{1}{2}\\xi\\right) + (1 - \\xi^2) + \\left(\\frac{1}{2}\\xi^2 + \\frac{1}{2}\\xi\\right) = \\left(\\frac{1}{2} - 1 + \\frac{1}{2}\\right)\\xi^2 + \\left(-\\frac{1}{2} + \\frac{1}{2}\\right)\\xi + 1 = 1$$\n\nNext, we find the derivatives of the shape functions with respect to $\\xi$:\n$$\\frac{dN_1}{d\\xi} = \\frac{d}{d\\xi}\\left(\\frac{1}{2}\\xi^2 - \\frac{1}{2}\\xi\\right) = \\xi - \\frac{1}{2}$$\n$$\\frac{dN_2}{d\\xi} = \\frac{d}{d\\xi}\\left(1 - \\xi^2\\right) = -2\\xi$$\n$$\\frac{dN_3}{d\\xi} = \\frac{d}{d\\xi}\\left(\\frac{1}{2}\\xi^2 + \\frac{1}{2}\\xi\\right) = \\xi + \\frac{1}{2}$$\n\nNow we evaluate the shape functions and their derivatives at the Gauss-Legendre points $\\xi = \\pm \\frac{1}{\\sqrt{3}}$.\n\n**Evaluation at $\\xi = -\\frac{1}{\\sqrt{3}}$:**\nFor this point, $\\xi^2 = \\left(-\\frac{1}{\\sqrt{3}}\\right)^2 = \\frac{1}{3}$.\n$N_1\\left(-\\frac{1}{\\sqrt{3}}\\right) = \\frac{1}{2}\\left(\\frac{1}{3} - \\left(-\\frac{1}{\\sqrt{3}}\\right)\\right) = \\frac{1}{6} + \\frac{1}{2\\sqrt{3}} = \\frac{1}{6} + \\frac{\\sqrt{3}}{6} = \\frac{1+\\sqrt{3}}{6}$.\n$N_2\\left(-\\frac{1}{\\sqrt{3}}\\right) = 1 - \\left(\\frac{1}{3}\\right) = \\frac{2}{3}$.\n$N_3\\left(-\\frac{1}{\\sqrt{3}}\\right) = \\frac{1}{2}\\left(\\frac{1}{3} + \\left(-\\frac{1}{\\sqrt{3}}\\right)\\right) = \\frac{1}{6} - \\frac{1}{2\\sqrt{3}} = \\frac{1}{6} - \\frac{\\sqrt{3}}{6} = \\frac{1-\\sqrt{3}}{6}$.\n\n$\\frac{dN_1}{d\\xi}\\left(-\\frac{1}{\\sqrt{3}}\\right) = -\\frac{1}{\\sqrt{3}} - \\frac{1}{2} = -\\frac{\\sqrt{3}}{3} - \\frac{1}{2} = \\frac{-3-2\\sqrt{3}}{6}$.\n$\\frac{dN_2}{d\\xi}\\left(-\\frac{1}{\\sqrt{3}}\\right) = -2\\left(-\\frac{1}{\\sqrt{3}}\\right) = \\frac{2}{\\sqrt{3}} = \\frac{2\\sqrt{3}}{3}$.\n$\\frac{dN_3}{d\\xi}\\left(-\\frac{1}{\\sqrt{3}}\\right) = -\\frac{1}{\\sqrt{3}} + \\frac{1}{2} = -\\frac{\\sqrt{3}}{3} + \\frac{1}{2} = \\frac{3-2\\sqrt{3}}{6}$.\n\n**Evaluation at $\\xi = \\frac{1}{\\sqrt{3}}$:**\nFor this point, $\\xi^2 = \\left(\\frac{1}{\\sqrt{3}}\\right)^2 = \\frac{1}{3}$.\n$N_1\\left(\\frac{1}{\\sqrt{3}}\\right) = \\frac{1}{2}\\left(\\frac{1}{3} - \\frac{1}{\\sqrt{3}}\\right) = \\frac{1}{6} - \\frac{1}{2\\sqrt{3}} = \\frac{1}{6} - \\frac{\\sqrt{3}}{6} = \\frac{1-\\sqrt{3}}{6}$.\n$N_2\\left(\\frac{1}{\\sqrt{3}}\\right) = 1 - \\frac{1}{3} = \\frac{2}{3}$.\n$N_3\\left(\\frac{1}{\\sqrt{3}}\\right) = \\frac{1}{2}\\left(\\frac{1}{3} + \\frac{1}{\\sqrt{3}}\\right) = \\frac{1}{6} + \\frac{1}{2\\sqrt{3}} = \\frac{1}{6} + \\frac{\\sqrt{3}}{6} = \\frac{1+\\sqrt{3}}{6}$.\n\n$\\frac{dN_1}{d\\xi}\\left(\\frac{1}{\\sqrt{3}}\\right) = \\frac{1}{\\sqrt{3}} - \\frac{1}{2} = \\frac{\\sqrt{3}}{3} - \\frac{1}{2} = \\frac{-3+2\\sqrt{3}}{6}$.\n$\\frac{dN_2}{d\\xi}\\left(\\frac{1}{\\sqrt{3}}\\right) = -2\\left(\\frac{1}{\\sqrt{3}}\\right) = -\\frac{2}{\\sqrt{3}} = -\\frac{2\\sqrt{3}}{3}$.\n$\\frac{dN_3}{d\\xi}\\left(\\frac{1}{\\sqrt{3}}\\right) = \\frac{1}{\\sqrt{3}} + \\frac{1}{2} = \\frac{\\sqrt{3}}{3} + \\frac{1}{2} = \\frac{3+2\\sqrt{3}}{6}$.\n\nThe $12$ values for the final answer matrix, in the specified order, are:\n1.  $N_1\\left(-\\frac{1}{\\sqrt{3}}\\right) = \\frac{1+\\sqrt{3}}{6}$\n2.  $N_2\\left(-\\frac{1}{\\sqrt{3}}\\right) = \\frac{2}{3}$\n3.  $N_3\\left(-\\frac{1}{\\sqrt{3}}\\right) = \\frac{1-\\sqrt{3}}{6}$\n4.  $\\frac{dN_1}{d\\xi}\\left(-\\frac{1}{\\sqrt{3}}\\right) = \\frac{-3-2\\sqrt{3}}{6}$\n5.  $\\frac{dN_2}{d\\xi}\\left(-\\frac{1}{\\sqrt{3}}\\right) = \\frac{2\\sqrt{3}}{3}$\n6.  $\\frac{dN_3}{d\\xi}\\left(-\\frac{1}{\\sqrt{3}}\\right) = \\frac{3-2\\sqrt{3}}{6}$\n7.  $N_1\\left(\\frac{1}{\\sqrt{3}}\\right) = \\frac{1-\\sqrt{3}}{6}$\n8.  $N_2\\left(\\frac{1}{\\sqrt{3}}\\right) = \\frac{2}{3}$\n9.  $N_3\\left(\\frac{1}{\\sqrt{3}}\\right) = \\frac{1+\\sqrt{3}}{6}$\n10. $\\frac{dN_1}{d\\xi}\\left(\\frac{1}{\\sqrt{3}}\\right) = \\frac{-3+2\\sqrt{3}}{6}$\n11. $\\frac{dN_2}{d\\xi}\\left(\\frac{1}{\\sqrt{3}}\\right) = -\\frac{2\\sqrt{3}}{3}$\n12. $\\frac{dN_3}{d\\xi}\\left(\\frac{1}{\\sqrt{3}}\\right) = \\frac{3+2\\sqrt{3}}{6}$", "answer": "$$\n\\boxed{\n\\begin{pmatrix} \\frac{1+\\sqrt{3}}{6} & \\frac{2}{3} & \\frac{1-\\sqrt{3}}{6} & \\frac{-3-2\\sqrt{3}}{6} & \\frac{2\\sqrt{3}}{3} & \\frac{3-2\\sqrt{3}}{6} & \\frac{1-\\sqrt{3}}{6} & \\frac{2}{3} & \\frac{1+\\sqrt{3}}{6} & \\frac{-3+2\\sqrt{3}}{6} & -\\frac{2\\sqrt{3}}{3} & \\frac{3+2\\sqrt{3}}{6} \\end{pmatrix}\n}\n$$", "id": "3589622"}, {"introduction": "Real-world engineering problems often require moving beyond one-dimension. This exercise extends the concept of polynomial interpolation to two dimensions using the versatile triangular element [@problem_id:3589709]. You will use the elegant framework of barycentric coordinates to construct quadratic ($P_2$) shape functions from first principles, providing a powerful demonstration of how these functions maintain key properties like the partition of unity in more complex geometric settings.", "problem": "Consider a nondegenerate triangle in the plane with vertices $\\mathbf{X}_1$, $\\mathbf{X}_2$, and $\\mathbf{X}_3$. Let $(\\lambda_1,\\lambda_2,\\lambda_3)$ denote the barycentric coordinates of a generic point $\\mathbf{X}$ with respect to this triangle, defined by the fundamental properties: (i) $\\lambda_i(\\mathbf{X}_j)=\\delta_{ij}$ for $i,j\\in\\{1,2,3\\}$, (ii) $\\lambda_i \\ge 0$ inside the triangle, and (iii) $\\lambda_1+\\lambda_2+\\lambda_3=1$ for all $\\mathbf{X}$ in the affine span of the triangle. In the quadratic Lagrange ($P_2$) finite element on a triangle, the interpolation space consists of all polynomials of total degree at most $2$ on the triangle, and the nodal set comprises the $3$ vertex nodes at $\\mathbf{X}_1,\\mathbf{X}_2,\\mathbf{X}_3$ and the $3$ edge-midpoint nodes at the barycentric coordinates $(\\tfrac{1}{2},\\tfrac{1}{2},0)$, $(0,\\tfrac{1}{2},\\tfrac{1}{2})$, and $(\\tfrac{1}{2},0,\\tfrac{1}{2})$. The Lagrange shape function $N_a$ associated with a node $a$ is defined by the interpolation conditions $N_a(\\text{node }a)=1$ and $N_a(\\text{node }b)=0$ for all $b\\neq a$, and $N_a$ belongs to the $P_2$ space.\n\nStarting only from these definitions and facts, and without invoking any pre-memorized shape function formulas, do the following:\n- Derive explicitly the $P_2$ Lagrange shape functions associated with the $3$ vertices and the $3$ edge midpoints in terms of $(\\lambda_1,\\lambda_2,\\lambda_3)$. Your derivation must use the interpolation conditions and the structure of the quadratic polynomial space in barycentric form.\n- Using only $\\lambda_1+\\lambda_2+\\lambda_3=1$, verify that the sum of the six derived shape functions is identically $1$ on the triangle (partition of unity).\n\nProvide your final answer as the ordered row vector of the six shape functions associated with the nodes $(\\mathbf{X}_1,\\mathbf{X}_2,\\mathbf{X}_3,\\text{mid}_{12},\\text{mid}_{23},\\text{mid}_{31})$, expressed symbolically in terms of $(\\lambda_1,\\lambda_2,\\lambda_3)$. No numerical rounding is required, and no physical units are involved.", "solution": "We begin from the definitions of barycentric coordinates and the Lagrange interpolation property. The barycentric coordinates $(\\lambda_1,\\lambda_2,\\lambda_3)$ satisfy $\\lambda_i(\\mathbf{X}_j)=\\delta_{ij}$ and $\\lambda_1+\\lambda_2+\\lambda_3=1$. The quadratic polynomial space on the triangle in barycentric form is spanned by the six monomials\n$$\n\\{\\lambda_1^2,\\ \\lambda_2^2,\\ \\lambda_3^2,\\ \\lambda_1\\lambda_2,\\ \\lambda_2\\lambda_3,\\ \\lambda_3\\lambda_1\\}.\n$$\nTherefore, any $P_2$ shape function $N$ can be expressed as a linear combination of these monomials.\n\nVertex-associated shape functions. Consider the vertex shape function $N_1$ associated with $\\mathbf{X}_1$. By the Lagrange conditions, $N_1(\\mathbf{X}_1)=1$ and $N_1(\\mathbf{X}_2)=N_1(\\mathbf{X}_3)=0$. Moreover, $N_1$ must vanish along the edges opposite to $\\mathbf{X}_1$ at the two vertices and at the midpoint on those edges where $\\lambda_1=0$, so it is natural to factor out $\\lambda_1$. Since $N_1$ is quadratic, the most general form consistent with this factor is\n$$\nN_1(\\lambda_1,\\lambda_2,\\lambda_3)=\\lambda_1\\left(a\\,\\lambda_1+b\\,\\lambda_2+c\\,\\lambda_3\\right),\n$$\nfor constants $a$, $b$, and $c$. Enforcing the nodal conditions:\n- At $\\mathbf{X}_1$, we have $(\\lambda_1,\\lambda_2,\\lambda_3)=(1,0,0)$, so $N_1(1,0,0)=1$, which gives $a=1$.\n- At the midpoint $\\text{mid}_{12}$ with $(\\lambda_1,\\lambda_2,\\lambda_3)=(\\tfrac{1}{2},\\tfrac{1}{2},0)$, we require $N_1=0$, so\n$$\n0=\\tfrac{1}{2}\\left(a\\,\\tfrac{1}{2}+b\\,\\tfrac{1}{2}+c\\cdot 0\\right)=\\frac{a+b}{4}\\ \\ \\Rightarrow\\ \\ b=-a=-1.\n$$\n- At the midpoint $\\text{mid}_{31}$ with $(\\lambda_1,\\lambda_2,\\lambda_3)=(\\tfrac{1}{2},0,\\tfrac{1}{2})$, we require $N_1=0$, so\n$$\n0=\\tfrac{1}{2}\\left(a\\,\\tfrac{1}{2}+b\\cdot 0+c\\,\\tfrac{1}{2}\\right)=\\frac{a+c}{4}\\ \\ \\Rightarrow\\ \\ c=-a=-1.\n$$\nWith $a=1$, $b=-1$, and $c=-1$, we obtain\n$$\nN_1=\\lambda_1\\left(\\lambda_1-\\lambda_2-\\lambda_3\\right).\n$$\nUsing $\\lambda_1+\\lambda_2+\\lambda_3=1$, this can be simplified to the familiar symmetric form\n$$\nN_1=\\lambda_1\\left(2\\,\\lambda_1-1\\right).\n$$\nBy cyclic permutation of indices, the other two vertex shape functions are\n$$\nN_2=\\lambda_2\\left(2\\,\\lambda_2-1\\right),\\qquad N_3=\\lambda_3\\left(2\\,\\lambda_3-1\\right).\n$$\n\nEdge-midpoint shape functions. Consider the shape function $N_{12}$ associated with the midpoint on edge $\\overline{\\mathbf{X}_1\\mathbf{X}_2}$, whose barycentric coordinates are $(\\tfrac{1}{2},\\tfrac{1}{2},0)$. The Lagrange conditions demand $N_{12}(\\tfrac{1}{2},\\tfrac{1}{2},0)=1$, $N_{12}(\\mathbf{X}_1)=N_{12}(\\mathbf{X}_2)=N_{12}(\\mathbf{X}_3)=0$, and $N_{12}(\\text{mid}_{23})=N_{12}(\\text{mid}_{31})=0$. Because $N_{12}$ must vanish whenever either $\\lambda_1=0$ or $\\lambda_2=0$, it must contain the factor $\\lambda_1\\lambda_2$. Since it is quadratic, no additional factors of $\\lambda_i$ can appear. Therefore,\n$$\nN_{12}=d\\,\\lambda_1\\lambda_2.\n$$\nImposing $N_{12}(\\tfrac{1}{2},\\tfrac{1}{2},0)=1$ gives $d\\cdot\\tfrac{1}{4}=1$, hence $d=4$, so\n$$\nN_{12}=4\\,\\lambda_1\\lambda_2.\n$$\nBy cyclic permutation of indices, the remaining two edge-midpoint shape functions are\n$$\nN_{23}=4\\,\\lambda_2\\lambda_3,\\qquad N_{31}=4\\,\\lambda_3\\lambda_1.\n$$\n\nPartition of unity. Let $S$ denote the sum of the six derived shape functions:\n$$\nS=\\underbrace{\\lambda_1(2\\lambda_1-1)+\\lambda_2(2\\lambda_2-1)+\\lambda_3(2\\lambda_3-1)}_{\\text{vertex terms}}+\\underbrace{4(\\lambda_1\\lambda_2+\\lambda_2\\lambda_3+\\lambda_3\\lambda_1)}_{\\text{edge terms}}.\n$$\nCollecting terms,\n$$\nS=2(\\lambda_1^2+\\lambda_2^2+\\lambda_3^2)-(\\lambda_1+\\lambda_2+\\lambda_3)+4(\\lambda_1\\lambda_2+\\lambda_2\\lambda_3+\\lambda_3\\lambda_1).\n$$\nUsing only the identity $(\\lambda_1+\\lambda_2+\\lambda_3)^2=\\lambda_1^2+\\lambda_2^2+\\lambda_3^2+2(\\lambda_1\\lambda_2+\\lambda_2\\lambda_3+\\lambda_3\\lambda_1)$ together with $\\lambda_1+\\lambda_2+\\lambda_3=1$, we have\n$$\n\\lambda_1^2+\\lambda_2^2+\\lambda_3^2=1-2(\\lambda_1\\lambda_2+\\lambda_2\\lambda_3+\\lambda_3\\lambda_1).\n$$\nSubstituting into $S$ yields\n$$\nS=2\\big(1-2(\\lambda_1\\lambda_2+\\lambda_2\\lambda_3+\\lambda_3\\lambda_1)\\big)-1+4(\\lambda_1\\lambda_2+\\lambda_2\\lambda_3+\\lambda_3\\lambda_1)=1.\n$$\nHence the quadratic Lagrange shape functions form a partition of unity on the triangle.\n\nTherefore, ordered as $(N_1,N_2,N_3,N_{12},N_{23},N_{31})$ and expressed in terms of $(\\lambda_1,\\lambda_2,\\lambda_3)$, the six $P_2$ Lagrange shape functions are\n$$\n\\big(\\lambda_1(2\\lambda_1-1),\\ \\lambda_2(2\\lambda_2-1),\\ \\lambda_3(2\\lambda_3-1),\\ 4\\lambda_1\\lambda_2,\\ 4\\lambda_2\\lambda_3,\\ 4\\lambda_3\\lambda_1\\big).\n$$", "answer": "$$\\boxed{\\begin{pmatrix}\\lambda_1\\left(2\\lambda_1-1\\right) & \\lambda_2\\left(2\\lambda_2-1\\right) & \\lambda_3\\left(2\\lambda_3-1\\right) & 4\\lambda_1\\lambda_2 & 4\\lambda_2\\lambda_3 & 4\\lambda_3\\lambda_1\\end{pmatrix}}$$", "id": "3589709"}, {"introduction": "Shape functions are not just a theoretical curiosity; they are the machinery that drives the finite element method. This final practice bridges theory and application by tasking you with the implementation of a 2D quadrilateral element to compute the element stiffness matrix, $\\mathbf{K}$ [@problem_id:3589673]. You will work through the entire process, from computing the Jacobian of the isoparametric mapping to forming the strain-displacement matrix ($\\mathbf{B}$-matrix) and performing numerical integration, culminating in a verification of the stiffness matrix's symmetry—a critical check for any valid FEM implementation.", "problem": "You are asked to implement an isoparametric bilinear quadrilateral element with polynomial interpolation and shape functions in two-dimensional small-strain linear elasticity and to verify a structural property of the resulting element stiffness. The focus is on deriving and computing the strain-displacement matrix, often termed the $\\mathbf{B}$-matrix, at Gaussian quadrature points for a distorted element and verifying that the assembled element stiffness matrix is symmetric. Work from fundamental definitions and well-tested facts and construct your algorithm accordingly.\n\nAssume two-dimensional small-strain kinematics. The small-strain tensor is defined as $\\boldsymbol{\\varepsilon} = \\operatorname{sym}\\left(\\nabla \\mathbf{u}\\right)$, where $\\mathbf{u}$ is the displacement field. The constitutive model is linear elasticity, expressed as $\\boldsymbol{\\sigma} = \\mathbf{D}\\,\\boldsymbol{\\varepsilon}$, with $\\boldsymbol{\\sigma}$ the Cauchy stress tensor and $\\mathbf{D}$ the symmetric constitutive tensor for plane strain. Use an isoparametric mapping from the natural coordinates $(\\xi,\\eta)\\in[-1,1]\\times[-1,1]$ to the physical coordinates $(x,y)$ via polynomial interpolation with bilinear shape functions that satisfy the Kronecker-delta property at the nodes. The nodes are numbered counterclockwise starting at the bottom-left corner, yielding a four-node $Q_1$ element. The gradient transformation from natural derivatives to physical derivatives should be carried out using the Jacobian of the mapping.\n\nYour task is to:\n- Derive the bilinear shape functions for the $Q_1$ element from the polynomial interpolation conditions in natural coordinates $(\\xi,\\eta)$.\n- Derive the transformation of shape function derivatives from natural coordinates to physical coordinates using the Jacobian matrix $\\mathbf{J}(\\xi,\\eta)$ of the isoparametric mapping and its inverse.\n- Construct the strain-displacement matrix $\\mathbf{B}(\\xi,\\eta)$ for the two-dimensional small-strain case at each quadrature point.\n- Assemble the element stiffness matrix $\\mathbf{K}$ using Gaussian quadrature with $2\\times 2$ points, thickness $t$, and material parameters Young’s modulus $E$ and Poisson’s ratio $\\nu$ under plane strain conditions.\n- Verify the symmetry of $\\mathbf{K}$ by checking whether $\\mathbf{K} = \\mathbf{K}^\\top$ within a reasonable numerical tolerance.\n\nUse the following test suite of elements and material parameters. All lengths are in $\\mathrm{m}$ and all elastic moduli are in $\\mathrm{Pa}$. Thickness $t$ is in $\\mathrm{m}$.\n\nTest case $1$:\n- Nodes: $\\left[(0,0),(1,0),(1,1),(0,1)\\right]$\n- $E = 70\\times 10^{9}$, $\\nu = 0.33$, $t = 0.1$\n\nTest case $2$:\n- Nodes: $\\left[(0,0),(1.2,0),(1.2,1),(0.2,1)\\right]$\n- $E = 210\\times 10^{9}$, $\\nu = 0.3$, $t = 0.05$\n\nTest case $3$:\n- Nodes: $\\left[(0,0),(1,0),(0.9,0.8),(-0.1,0.9)\\right]$\n- $E = 120\\times 10^{9}$, $\\nu = 0.25$, $t = 0.2$\n\nTest case $4$:\n- Nodes: rotation by $30$ degrees of the rectangle with corners $\\left[(0,0),(2,0),(2,1),(0,1)\\right]$ about the origin, giving coordinates $\\left[(0,0),(1.7320508075688772,1.0),(1.2320508075688772,1.8660254037844386),(-0.5,0.8660254037844386)\\right]$\n- $E = 1\\times 10^{9}$, $\\nu = 0.4$, $t = 0.005$\n\nYour program must:\n- For each test case, compute the $\\mathbf{B}$-matrix at all four $2\\times 2$ Gaussian quadrature points, assemble the element stiffness matrix $\\mathbf{K}$, and check symmetry within a strict absolute tolerance based on the magnitude of $\\mathbf{K}$.\n- Produce a single line of output containing the symmetry check results for the four test cases as a comma-separated list enclosed in square brackets; for example, $\\left[\\text{result}_1,\\text{result}_2,\\text{result}_3,\\text{result}_4\\right]$, where each entry is a boolean.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the exact form $\\left[\\text{result}_1,\\text{result}_2,\\text{result}_3,\\text{result}_4\\right]$, where each $\\text{result}_i$ is either $\\text{True}$ or $\\text{False}$.", "solution": "The problem is to implement a two-dimensional, four-node isoparametric quadrilateral element for linear elasticity and verify the symmetry of the resulting element stiffness matrix, $\\mathbf{K}$. This verification serves as a fundamental validation of the implementation's correctness, as the symmetry of $\\mathbf{K}$ is a direct consequence of the underlying conservative physical principles and the variational formulation of the finite element method. The derivation proceeds from first principles as follows.\n\nFirst, we establish the polynomial interpolation within the parent element domain. A four-node quadrilateral ($Q_1$) element uses bilinear shape functions, $N_i(\\xi, \\eta)$, defined over the natural coordinate system $(\\xi, \\eta)$, where $\\xi, \\eta \\in [-1, 1]$. A general bilinear polynomial is of the form $p(\\xi, \\eta) = c_1 + c_2\\xi + c_3\\eta + c_4\\xi\\eta$. The shape function for node $i$, $N_i$, must satisfy the Kronecker-delta property: $N_i(\\xi_j, \\eta_j) = \\delta_{ij}$, where $(\\xi_j, \\eta_j)$ are the coordinates of node $j$. The nodes are numbered counter-clockwise in the parent domain: node $1$ at $(-1, -1)$, node $2$ at $(1, -1)$, node $3$ at $(1, 1)$, and node $4$ at $(-1, 1)$. By requiring $N_i$ to be $1$ at its own node and $0$ at the others, we derive the four shape functions:\n$$N_1(\\xi, \\eta) = \\frac{1}{4}(1-\\xi)(1-\\eta)$$\n$$N_2(\\xi, \\eta) = \\frac{1}{4}(1+\\xi)(1-\\eta)$$\n$$N_3(\\xi, \\eta) = \\frac{1}{4}(1+\\xi)(1+\\eta)$$\n$$N_4(\\xi, \\eta) = \\frac{1}{4}(1-\\xi)(1+\\eta)$$\n\nSecond, we define the isoparametric mapping. The physical coordinates $(x, y)$ of any point within the element are interpolated from the nodal coordinates $(x_i, y_i)$ using the same shape functions:\n$$x(\\xi, \\eta) = \\sum_{i=1}^{4} N_i(\\xi, \\eta) x_i, \\quad y(\\xi, \\eta) = \\sum_{i=1}^{4} N_i(\\xi, \\eta) y_i$$\nTo relate derivatives with respect to physical coordinates $(x, y)$ to those in natural coordinates $(\\xi, \\eta)$, we use the chain rule, which defines the Jacobian matrix $\\mathbf{J}$:\n$$ \\begin{Bmatrix} \\frac{\\partial f}{\\partial \\xi} \\\\ \\frac{\\partial f}{\\partial \\eta} \\end{Bmatrix} = \\begin{bmatrix} \\frac{\\partial x}{\\partial \\xi} & \\frac{\\partial y}{\\partial \\xi} \\\\ \\frac{\\partial x}{\\partial \\eta} & \\frac{\\partial y}{\\partial \\eta} \\end{bmatrix} \\begin{Bmatrix} \\frac{\\partial f}{\\partial x} \\\\ \\frac{\\partial f}{\\partial y} \\end{Bmatrix} = \\mathbf{J} \\begin{Bmatrix} \\frac{\\partial f}{\\partial x} \\\\ \\frac{\\partial f}{\\partial y} \\end{Bmatrix} $$\nThe components of $\\mathbf{J}$ are found by differentiating the mapping equations:\n$$J_{11} = \\frac{\\partial x}{\\partial \\xi} = \\sum_{i=1}^{4} \\frac{\\partial N_i}{\\partial \\xi} x_i, \\quad J_{12} = \\frac{\\partial y}{\\partial \\xi} = \\sum_{i=1}^{4} \\frac{\\partial N_i}{\\partial \\xi} y_i$$\n$$J_{21} = \\frac{\\partial x}{\\partial \\eta} = \\sum_{i=1}^{4} \\frac{\\partial N_i}{\\partial \\eta} x_i, \\quad J_{22} = \\frac{\\partial y}{\\partial \\eta} = \\sum_{i=1}^{4} \\frac{\\partial N_i}{\\partial \\eta} y_i$$\nThe required physical derivatives are obtained by inverting the relationship: $\\nabla_x f = \\mathbf{J}^{-1} \\nabla_\\xi f$.\n\nThird, we construct the strain-displacement matrix, $\\mathbf{B}$. The displacement field $\\mathbf{u} = (u_x, u_y)$ is interpolated similarly to the geometry: $u_x = \\sum N_i u_{xi}$ and $u_y = \\sum N_i u_{yi}$, where $\\mathbf{d} = [u_{x1}, u_{y1}, \\dots, u_{x4}, u_{y4}]^\\top$ is the vector of nodal displacements. For small-strain kinematics, the strain vector in Voigt notation (using engineering shear strain) is $\\boldsymbol{\\varepsilon} = [\\varepsilon_{xx}, \\varepsilon_{yy}, \\gamma_{xy}]^\\top$, where:\n$$\\varepsilon_{xx} = \\frac{\\partial u_x}{\\partial x}, \\quad \\varepsilon_{yy} = \\frac{\\partial u_y}{\\partial y}, \\quad \\gamma_{xy} = \\frac{\\partial u_x}{\\partial y} + \\frac{\\partial u_y}{\\partial x}$$\nSubstituting the interpolated displacements, we obtain the relationship $\\boldsymbol{\\varepsilon} = \\mathbf{B}\\mathbf{d}$. The matrix $\\mathbf{B}$ is partitioned as $\\mathbf{B} = [\\mathbf{B}_1, \\mathbf{B}_2, \\mathbf{B}_3, \\mathbf{B}_4]$, where each sub-matrix $\\mathbf{B}_i$ relates strain to the displacements of node $i$:\n$$ \\mathbf{B}_i(\\xi, \\eta) = \\begin{bmatrix} \\frac{\\partial N_i}{\\partial x} & 0 \\\\ 0 & \\frac{\\partial N_i}{\\partial y} \\\\ \\frac{\\partial N_i}{\\partial y} & \\frac{\\partial N_i}{\\partial x} \\end{bmatrix} $$\nThe spatial derivatives of the shape functions, $\\frac{\\partial N_i}{\\partial x}$ and $\\frac{\\partial N_i}{\\partial y}$, are computed at each point $(\\xi, \\eta)$ using the inverse Jacobian:\n$$ \\begin{Bmatrix} \\frac{\\partial N_i}{\\partial x} \\\\ \\frac{\\partial N_i}{\\partial y} \\end{Bmatrix} = \\mathbf{J}^{-1}(\\xi, \\eta) \\begin{Bmatrix} \\frac{\\partial N_i}{\\partial \\xi} \\\\ \\frac{\\partial N_i}{\\partial \\eta} \\end{Bmatrix} $$\n\nFourth, we assemble the element stiffness matrix $\\mathbf{K}$. From the principle of virtual work, $\\mathbf{K}$ is given by the integral over the element volume $V_e$:\n$$ \\mathbf{K} = \\int_{V_e} \\mathbf{B}^\\top \\mathbf{D} \\mathbf{B} \\, dV $$\nFor a two-dimensional element of constant thickness $t$, this becomes an area integral, which is transformed to the parent domain:\n$$ \\mathbf{K} = t \\int_{-1}^{1} \\int_{-1}^{1} \\mathbf{B}(\\xi, \\eta)^\\top \\mathbf{D} \\mathbf{B}(\\xi, \\eta) \\det(\\mathbf{J}(\\xi, \\eta)) \\, d\\xi d\\eta $$\nThe material's constitutive behavior is described by the symmetric matrix $\\mathbf{D}$. For plane strain, it is:\n$$ \\mathbf{D} = \\frac{E}{(1+\\nu)(1-2\\nu)} \\begin{bmatrix} 1-\\nu & \\nu & 0 \\\\ \\nu & 1-\\nu & 0 \\\\ 0 & 0 & \\frac{1-2\\nu}{2} \\end{bmatrix} $$\nwhere $E$ is Young's modulus and $\\nu$ is Poisson's ratio. The integral is evaluated numerically using $2 \\times 2$ Gaussian quadrature. The quadrature points are $(\\xi_k, \\eta_k) = (\\pm 1/\\sqrt{3}, \\pm 1/\\sqrt{3})$, and all associated weights $w_k$ are $1$. The stiffness matrix is thus the sum:\n$$ \\mathbf{K} = t \\sum_{k=1}^{4} w_k \\mathbf{B}(\\xi_k, \\eta_k)^\\top \\mathbf{D} \\mathbf{B}(\\xi_k, \\eta_k) \\det(\\mathbf{J}(\\xi_k, \\eta_k)) $$\n\nFinally, we address the symmetry of $\\mathbf{K}$. The integrand, let's call it $\\mathbf{C}(\\xi, \\eta) = \\mathbf{B}^\\top \\mathbf{D} \\mathbf{B}$, is symmetric because $\\mathbf{D}$ is symmetric: $\\mathbf{C}^\\top = (\\mathbf{B}^\\top \\mathbf{D} \\mathbf{B})^\\top = \\mathbf{B}^\\top \\mathbf{D}^\\top (\\mathbf{B}^\\top)^\\top = \\mathbf{B}^\\top \\mathbf{D} \\mathbf{B} = \\mathbf{C}$. Since $\\mathbf{K}$ is a weighted sum of these symmetric matrices (where the weights are the scalar product of thickness, quadrature weight, and the Jacobian determinant), $\\mathbf{K}$ must also be symmetric: $\\mathbf{K} = \\mathbf{K}^\\top$. The provided task is to verify this property numerically. Due to floating-point arithmetic, the computed matrix $\\mathbf{K}$ might not be exactly equal to its transpose $\\mathbf{K}^\\top$. The verification must therefore check that the difference $\\mathbf{K} - \\mathbf{K}^\\top$ is zero within a small, strict numerical tolerance that accounts for machine precision errors. We will check if `np.allclose(K, K.T)` holds true, using an absolute tolerance that scales with the magnitude of the matrix entries, ensuring a rigorous yet practical test.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef get_stiffness_matrix(nodes, E, nu, t):\n    \"\"\"\n    Computes the 8x8 stiffness matrix for a 4-node isoparametric\n    quadrilateral element under plane strain conditions.\n\n    Args:\n        nodes (np.ndarray): A 4x2 array of nodal coordinates, ordered counter-clockwise.\n        E (float): Young's modulus.\n        nu (float): Poisson's ratio.\n        t (float): Element thickness.\n\n    Returns:\n        np.ndarray: The 8x8 element stiffness matrix K.\n    \"\"\"\n    # Define the constitutive matrix D for plane strain\n    D_factor = E / ((1 + nu) * (1 - 2 * nu))\n    D = D_factor * np.array([\n        [1 - nu, nu, 0],\n        [nu, 1 - nu, 0],\n        [0, 0, (1 - 2 * nu) / 2.]\n    ])\n\n    # 2x2 Gaussian quadrature points and weights\n    # For a 2x2 scheme in [-1, 1], all weights are 1.0.\n    gp_val = 1.0 / np.sqrt(3.0)\n    gauss_points = [\n        (-gp_val, -gp_val),\n        (gp_val, -gp_val),\n        (gp_val, gp_val),\n        (-gp_val, gp_val)\n    ]\n    \n    # Initialize the 8x8 element stiffness matrix\n    K = np.zeros((8, 8))\n\n    # Loop over the Gaussian quadrature points\n    for xi, eta in gauss_points:\n        # Derivatives of shape functions with respect to natural coordinates (xi, eta)\n        dNdxi_vec = 0.25 * np.array([\n            -(1 - eta),  # dN1/dxi\n            (1 - eta),   # dN2/dxi\n            (1 + eta),   # dN3/dxi\n            -(1 + eta)   # dN4/dxi\n        ])\n        \n        dNdeta_vec = 0.25 * np.array([\n            -(1 - xi),   # dN1/deta\n            -(1 + xi),   # dN2/deta\n            (1 + xi),    # dN3/deta\n            (1 - xi)     # dN4/deta\n        ])\n        \n        # Calculate the Jacobian matrix J\n        # J = [[dx/dxi, dy/dxi], [dx/deta, dy/deta]]\n        J = np.zeros((2, 2))\n        J[0, 0] = np.dot(dNdxi_vec, nodes[:, 0])\n        J[0, 1] = np.dot(dNdxi_vec, nodes[:, 1])\n        J[1, 0] = np.dot(dNdeta_vec, nodes[:, 0])\n        J[1, 1] = np.dot(dNdeta_vec, nodes[:, 1])\n        \n        detJ = np.linalg.det(J)\n        \n        # The Jacobian determinant must be positive for a valid mapping.\n        if detJ <= 0:\n            raise ValueError(\"Jacobian determinant is non-positive. Element is distorted.\")\n        \n        invJ = np.linalg.inv(J)\n        \n        # Initialize the strain-displacement matrix B (3x8)\n        B = np.zeros((3, 8))\n        for i in range(4):\n            # Combine the derivatives for node i\n            dNi_dxieta = np.array([dNdxi_vec[i], dNdeta_vec[i]])\n            \n            # Transform derivatives to physical coordinates (x, y)\n            dNi_dxy = invJ @ dNi_dxieta\n            dN_dx = dNi_dxy[0]\n            dN_dy = dNi_dxy[1]\n            \n            # Populate the B matrix for node i (columns 2*i and 2*i+1)\n            B[0, 2 * i] = dN_dx\n            B[1, 2 * i + 1] = dN_dy\n            B[2, 2 * i] = dN_dy\n            B[2, 2 * i + 1] = dN_dx\n\n        # Accumulate the stiffness matrix contribution from the current Gauss point\n        # The quadrature weight is 1.0.\n        K += B.T @ D @ B * detJ * t\n        \n    return K\n\n\ndef solve():\n    \"\"\"\n    Main function to run the test cases and verify the symmetry\n    of the computed element stiffness matrices.\n    \"\"\"\n    test_cases = [\n        {'nodes': np.array([(0.0, 0.0), (1.0, 0.0), (1.0, 1.0), (0.0, 1.0)]), \n         'E': 70e9, 'nu': 0.33, 't': 0.1},\n        {'nodes': np.array([(0.0, 0.0), (1.2, 0.0), (1.2, 1.0), (0.2, 1.0)]), \n         'E': 210e9, 'nu': 0.3, 't': 0.05},\n        {'nodes': np.array([(0.0, 0.0), (1.0, 0.0), (0.9, 0.8), (-0.1, 0.9)]), \n         'E': 120e9, 'nu': 0.25, 't': 0.2},\n        {'nodes': np.array([(0.0, 0.0), (1.7320508075688772, 1.0), \n                             (1.2320508075688772, 1.8660254037844386), \n                             (-0.5, 0.8660254037844386)]), \n         'E': 1e9, 'nu': 0.4, 't': 0.005}\n    ]\n    \n    results = []\n    for case in test_cases:\n        K = get_stiffness_matrix(case['nodes'], case['E'], case['nu'], case['t'])\n        \n        # Symmetry Check: Verify that K is equal to its transpose K.T within a\n        # strict tolerance to account for floating-point inaccuracies.\n        # The absolute tolerance is scaled by the maximum absolute value in K,\n        # as suggested by the prompt \"based on the magnitude of K\".\n        max_abs_K = np.max(np.abs(K))\n        \n        if max_abs_K == 0.0:\n            # For a zero matrix, it is symmetric, and atol can be 0.\n            dynamic_atol = 0.0\n        else:\n            # Define a strict absolute tolerance that scales with the matrix magnitude.\n            # A factor of 1e-12 is robust for double precision arithmetic.\n            dynamic_atol = 1e-12 * max_abs_K\n            \n        is_symmetric = np.allclose(K, K.T, rtol=0, atol=dynamic_atol)\n        results.append(is_symmetric)\n        \n    # Print the results in the required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```", "id": "3589673"}]}