{"hands_on_practices": [{"introduction": "This first exercise embodies the core principle of the patch test. We will start with a known constant strain field and derive the corresponding linear displacement field. By applying these exact displacements to the nodes of a simple patch of elements, we can verify that a correct finite element formulation recovers the constant stress state, confirming that the element passes the test for consistency [@problem_id:3606154].", "problem": "Consider a square two-by-two patch of bilinear isoparametric quadrilateral elements used in the Finite Element Method (FEM) for small-strain, linear elasticity under plane stress. The physical domain is the square $[0,L] \\times [0,L]$, partitioned into four equal elements by a uniform grid with nodal coordinates at\n$$(x_i,y_i) \\in \\{0,\\tfrac{L}{2},L\\} \\times \\{0,\\tfrac{L}{2},L\\},$$\nand the nodes numbered left-to-right, bottom-to-top as follows:\n$$\n\\text{Node }1:(0,0),\\quad \\text{Node }2:(\\tfrac{L}{2},0),\\quad \\text{Node }3:(L,0),\\\\\n\\text{Node }4:(0,\\tfrac{L}{2}),\\quad \\text{Node }5:(\\tfrac{L}{2},\\tfrac{L}{2}),\\quad \\text{Node }6:(L,\\tfrac{L}{2}),\\\\\n\\text{Node }7:(0,L),\\quad \\text{Node }8:(\\tfrac{L}{2},L),\\quad \\text{Node }9:(L,L).\n$$\nAssume small-strain kinematics where the in-plane strains are defined by\n$$\\varepsilon_{xx}=\\frac{\\partial u}{\\partial x},\\quad \\varepsilon_{yy}=\\frac{\\partial v}{\\partial y},\\quad \\gamma_{xy}=\\frac{\\partial u}{\\partial y}+\\frac{\\partial v}{\\partial x},$$\nwith displacement components $u(x,y)$ and $v(x,y)$. A uniform strain state is prescribed on the entire patch:\n$$\\varepsilon_{xx}=\\varepsilon_0,\\quad \\varepsilon_{yy}=0,\\quad \\gamma_{xy}=0,$$\nwith rigid-body translation and rotation fixed by the constraints that $u(0,0)=0$ and $v(0,0)=0$. The material is linear elastic, homogeneous, and isotropic with Young’s modulus $E$ and Poisson’s ratio $\\nu$, and the stress-strain relation is that of plane stress.\n\nTasks:\n1. Starting from the small-strain kinematic definitions and the uniform strain specification, derive the exact displacement field $(u(x,y),v(x,y))$ consistent with the constraints, and then construct the global nodal displacement vector for the nine-node patch ordered as $\\left[u_1, v_1, u_2, v_2, \\dots, u_9, v_9\\right]$.\n2. Using the fact that bilinear isoparametric quadrilateral elements reproduce globally linear displacement fields exactly when nodal values are taken from the exact field, deduce the assembled stress field produced by the patch under plane stress. Express your stress components $\\sigma_{xx}$, $\\sigma_{yy}$, and $\\tau_{xy}$ symbolically in terms of $E$, $\\nu$, and $\\varepsilon_0$.\n\nExpress displacement units in meters and stress units in Pascals. The final answer must be a single row matrix containing the ordered nodal displacement components followed by the three stress components, all in closed-form analytic expressions. No rounding is required.", "solution": "The problem requires the determination of nodal displacements and the resulting stress state for a patch of finite elements under a prescribed uniform strain field. The solution proceeds in two main parts: first, deriving the exact displacement field and the corresponding nodal displacements, and second, using the properties of the finite elements to determine the stress field.\n\nPart 1: Derivation of the Exact Displacement Field and Nodal Displacements\n\nThe problem specifies a uniform strain state throughout the domain:\n$$ \\varepsilon_{xx} = \\varepsilon_0 $$\n$$ \\varepsilon_{yy} = 0 $$\n$$ \\gamma_{xy} = 0 $$\n\nThe small-strain kinematic relations are given as:\n$$ \\varepsilon_{xx} = \\frac{\\partial u}{\\partial x}, \\quad \\varepsilon_{yy} = \\frac{\\partial v}{\\partial y}, \\quad \\gamma_{xy} = \\frac{\\partial u}{\\partial y} + \\frac{\\partial v}{\\partial x} $$\n\nWe integrate these relations to find the displacement field $(u(x,y), v(x,y))$.\nFrom $\\frac{\\partial u}{\\partial x} = \\varepsilon_0$, we integrate with respect to $x$ to obtain:\n$$ u(x,y) = \\int \\varepsilon_0 \\, dx = \\varepsilon_0 x + f(y) $$\nwhere $f(y)$ is an arbitrary function of $y$.\n\nFrom $\\frac{\\partial v}{\\partial y} = 0$, we integrate with respect to $y$ to obtain:\n$$ v(x,y) = \\int 0 \\, dy = g(x) $$\nwhere $g(x)$ is an arbitrary function of $x$.\n\nNext, we use the shear strain condition $\\gamma_{xy} = 0$:\n$$ \\frac{\\partial u}{\\partial y} + \\frac{\\partial v}{\\partial x} = 0 $$\nSubstituting the expressions for $u$ and $v$:\n$$ \\frac{\\partial}{\\partial y}(\\varepsilon_0 x + f(y)) + \\frac{\\partial}{\\partial x}(g(x)) = 0 $$\n$$ \\frac{df}{dy} + \\frac{dg}{dx} = 0 \\implies \\frac{df}{dy} = -\\frac{dg}{dx} $$\nSince the left side is a function of $y$ only and the right side is a function of $x$ only, they must both be equal to a constant, which we will call $C_1$.\n$$ \\frac{df}{dy} = C_1 \\implies f(y) = \\int C_1 \\, dy = C_1 y + C_2 $$\n$$ \\frac{dg}{dx} = -C_1 \\implies g(x) = \\int -C_1 \\, dx = -C_1 x + C_3 $$\nHere, $C_2$ and $C_3$ are constants of integration.\n\nSubstituting these functions back gives the general displacement field for the prescribed uniform strain state:\n$$ u(x,y) = \\varepsilon_0 x + C_1 y + C_2 $$\n$$ v(x,y) = -C_1 x + C_3 $$\nThe terms involving $C_1, C_2, C_3$ represent rigid-body motion. $(C_2, C_3)$ is a uniform translation, and the terms $C_1 y$ and $-C_1 x$ represent a small rigid-body rotation about the origin. The problem states that rigid-body translation and rotation are fixed. The specific constraints given are $u(0,0)=0$ and $v(0,0)=0$.\nApplying these constraints:\n$$ u(0,0) = \\varepsilon_0(0) + C_1(0) + C_2 = 0 \\implies C_2 = 0 $$\n$$ v(0,0) = -C_1(0) + C_3 = 0 \\implies C_3 = 0 $$\nThe constraints fix the rigid-body translation. The problem's phrasing implies that rigid-body rotation is also to be suppressed. The rotation component is $\\omega_z = \\frac{1}{2}(\\frac{\\partial v}{\\partial x} - \\frac{\\partial u}{\\partial y}) = \\frac{1}{2}(-C_1 - C_1) = -C_1$. To fix the rotation to zero, we must set $C_1 = 0$.\n\nTherefore, the exact displacement field corresponding to the pure strain state with no rigid-body motion is:\n$$ u(x,y) = \\varepsilon_0 x $$\n$$ v(x,y) = 0 $$\nThis field is linear in its spatial coordinates.\n\nNext, we evaluate this exact displacement field at the nine nodal coordinates to construct the global nodal displacement vector. The nodal coordinates are provided, and the vector is ordered as $[u_1, v_1, u_2, v_2, \\dots, u_9, v_9]$.\n\nNode 1: $(x_1,y_1) = (0,0) \\implies u_1 = \\varepsilon_0(0) = 0$, $v_1=0$\nNode 2: $(x_2,y_2) = (\\frac{L}{2},0) \\implies u_2 = \\varepsilon_0(\\frac{L}{2})$, $v_2=0$\nNode 3: $(x_3,y_3) = (L,0) \\implies u_3 = \\varepsilon_0 L$, $v_3=0$\nNode 4: $(x_4,y_4) = (0,\\frac{L}{2}) \\implies u_4 = \\varepsilon_0(0) = 0$, $v_4=0$\nNode 5: $(x_5,y_5) = (\\frac{L}{2},\\frac{L}{2}) \\implies u_5 = \\varepsilon_0(\\frac{L}{2})$, $v_5=0$\nNode 6: $(x_6,y_6) = (L,\\frac{L}{2}) \\implies u_6 = \\varepsilon_0 L$, $v_6=0$\nNode 7: $(x_7,y_7) = (0,L) \\implies u_7 = \\varepsilon_0(0) = 0$, $v_7=0$\nNode 8: $(x_8,y_8) = (\\frac{L}{2},L) \\implies u_8 = \\varepsilon_0(\\frac{L}{2})$, $v_8=0$\nNode 9: $(x_9,y_9) = (L,L) \\implies u_9 = \\varepsilon_0 L$, $v_9=0$\n\nThe global nodal displacement vector $\\mathbf{d}$ is the $18$-component vector:\n$$ \\mathbf{d} = \\left[ 0, 0, \\frac{\\varepsilon_0 L}{2}, 0, \\varepsilon_0 L, 0, 0, 0, \\frac{\\varepsilon_0 L}{2}, 0, \\varepsilon_0 L, 0, 0, 0, \\frac{\\varepsilon_0 L}{2}, 0, \\varepsilon_0 L, 0 \\right]^T $$\n\nPart 2: Deduction of the Assembled Stress Field\n\nThe problem states a crucial property of the bilinear isoparametric quadrilateral elements: they reproduce globally linear displacement fields exactly. This property is known as passing the patch test for completeness. Since the exact displacement field $(u(x,y) = \\varepsilon_0 x, v(x,y) = 0)$ is linear, the finite element approximation $u^h(x,y), v^h(x,y)$ constructed from the exact nodal displacements will be identical to the exact field everywhere within the patch.\n$$ u^h(x,y) = u(x,y) = \\varepsilon_0 x $$\n$$ v^h(x,y) = v(x,y) = 0 $$\nConsequently, the strains computed from the finite element solution are constant and equal to the prescribed strains:\n$$ \\varepsilon_{xx}^h = \\frac{\\partial u^h}{\\partial x} = \\varepsilon_0 $$\n$$ \\varepsilon_{yy}^h = \\frac{\\partial v^h}{\\partial y} = 0 $$\n$$ \\gamma_{xy}^h = \\frac{\\partial u^h}{\\partial y} + \\frac{\\partial v^h}{\\partial x} = 0 + 0 = 0 $$\nThe stress field is obtained from the strain field using the plane stress constitutive relation for a linear elastic, isotropic material. The relationship is:\n$$ \\begin{Bmatrix} \\sigma_{xx} \\\\ \\sigma_{yy} \\\\ \\tau_{xy} \\end{Bmatrix} = \\frac{E}{1-\\nu^2} \\begin{bmatrix} 1 & \\nu & 0 \\\\ \\nu & 1 & 0 \\\\ 0 & 0 & \\frac{1-\\nu}{2} \\end{bmatrix} \\begin{Bmatrix} \\varepsilon_{xx} \\\\ \\varepsilon_{yy} \\\\ \\gamma_{xy} \\end{Bmatrix} $$\nSubstituting the strain values $\\{\\varepsilon_0, 0, 0\\}^T$:\n$$ \\begin{Bmatrix} \\sigma_{xx} \\\\ \\sigma_{yy} \\\\ \\tau_{xy} \\end{Bmatrix} = \\frac{E}{1-\\nu^2} \\begin{bmatrix} 1 & \\nu & 0 \\\\ \\nu & 1 & 0 \\\\ 0 & 0 & \\frac{1-\\nu}{2} \\end{bmatrix} \\begin{Bmatrix} \\varepsilon_0 \\\\ 0 \\\\ 0 \\end{Bmatrix} $$\nThis gives the stress components:\n$$ \\sigma_{xx} = \\frac{E}{1-\\nu^2} (1 \\cdot \\varepsilon_0 + \\nu \\cdot 0) = \\frac{E \\varepsilon_0}{1-\\nu^2} $$\n$$ \\sigma_{yy} = \\frac{E}{1-\\nu^2} (\\nu \\cdot \\varepsilon_0 + 1 \\cdot 0) = \\frac{\\nu E \\varepsilon_0}{1-\\nu^2} $$\n$$ \\tau_{xy} = \\frac{E}{1-\\nu^2} \\left( \\frac{1-\\nu}{2} \\cdot 0 \\right) = 0 $$\nSince the strain field is uniform across the entire patch, the stress field is also uniform.\n\nFinally, we assemble the final answer as a single row matrix containing the $18$ ordered nodal displacement components followed by the $3$ stress components $(\\sigma_{xx}, \\sigma_{yy}, \\tau_{xy})$.", "answer": "$$ \\boxed{\\begin{pmatrix} 0 & 0 & \\frac{\\varepsilon_0 L}{2} & 0 & \\varepsilon_0 L & 0 & 0 & 0 & \\frac{\\varepsilon_0 L}{2} & 0 & \\varepsilon_0 L & 0 & 0 & 0 & \\frac{\\varepsilon_0 L}{2} & 0 & \\varepsilon_0 L & 0 & \\frac{E \\varepsilon_0}{1-\\nu^2} & \\frac{\\nu E \\varepsilon_0}{1-\\nu^2} & 0 \\end{pmatrix}} $$", "id": "3606154"}, {"introduction": "A robust understanding comes not just from seeing a test pass, but from knowing *why* it passes. This thought experiment explores the consequences of violating a fundamental requirement of finite element shape functions—the partition of unity. By examining a hypothetical element that fails this property, we can predict the specific errors that arise, reinforcing the importance of the theoretical underpinnings for any valid element formulation [@problem_id:3606135].", "problem": "Consider a small-strain, two-dimensional, linear elastic patch test for the Finite Element Method (FEM) on a $2 \\times 2$ mesh of identical, $4$-node isoparametric quadrilateral elements covering the rectangular domain $\\Omega = [0,2L] \\times [0,2H]$. Let the exact displacement field be a uniform strain state,\n$$\n\\mathbf{u}(\\mathbf{x}) = \\mathbf{B}\\,\\mathbf{x}, \\quad \\text{with } \\mathbf{B} \\text{ a constant } 2 \\times 2 \\text{ matrix}, \\quad \\boldsymbol{\\varepsilon} = \\mathrm{sym}(\\nabla \\mathbf{u}) = \\mathrm{sym}(\\mathbf{B}),\n$$\nand zero body forces. The nodal displacements on the entire $\\partial \\Omega$ are prescribed so that the nodal values exactly satisfy $\\mathbf{u}(\\mathbf{x}_i) = \\mathbf{B}\\,\\mathbf{x}_i$ for each boundary node $i$.\n\nFor each element, let the geometry mapping use the standard bilinear shape functions on the parent space $(\\xi,\\eta) \\in [-1,1]^2$,\n$$\nN_1 = \\tfrac{1}{4}(1-\\xi)(1-\\eta), \\quad N_2 = \\tfrac{1}{4}(1+\\xi)(1-\\eta), \\quad N_3 = \\tfrac{1}{4}(1+\\xi)(1+\\eta), \\quad N_4 = \\tfrac{1}{4}(1-\\xi)(1+\\eta),\n$$\nso that the physical coordinates are interpolated as $\\mathbf{x}(\\xi,\\eta) = \\sum_{i=1}^{4} N_i(\\xi,\\eta)\\,\\mathbf{x}_i$. However, suppose the displacement interpolation violates the Partition of Unity (PoU) by modifying only the first displacement shape function with a bubble:\n$$\n\\tilde{N}_1(\\xi,\\eta) = N_1(\\xi,\\eta) + \\beta\\,b(\\xi,\\eta), \\quad \\tilde{N}_2 = N_2, \\quad \\tilde{N}_3 = N_3, \\quad \\tilde{N}_4 = N_4,\n$$\nwhere $\\beta \\neq 0$ is a fixed, dimensionless parameter and $b(\\xi,\\eta) = \\tfrac{1}{4}(1-\\xi^2)(1-\\eta^2)$ satisfies $b=0$ along the element boundary but $b>0$ in the element interior. Thus, $\\sum_{i=1}^{4} \\tilde{N}_i = 1 + \\beta\\,b \\neq 1$ in the interior, while $\\sum_{i=1}^{4} \\tilde{N}_i = 1$ on the element boundary.\n\nUsing the above hypothetical displacement shape functions $\\{\\tilde{N}_i\\}$ on every element of the $2 \\times 2$ patch, and the exact nodal boundary displacements corresponding to the uniform strain field, which of the following best describes the qualitative error in the computed strain field and patch-test outcome?\n\nA. The computed strain field remains exactly uniform across the entire patch because nodal boundary displacements enforce the exact solution; the patch test passes.\n\nB. The computed displacement field is exact along all element boundaries, but the interior of each element exhibits nonuniform, oscillatory strains of order $\\mathcal{O}(\\beta)$, leading to nonconstant stresses and inconsistent nodal reactions; the patch test fails and the error does not vanish unless $\\beta \\to 0$.\n\nC. Only rigid-body motion reproduction is lost due to the PoU violation, but uniform strain reproduction remains exact; the patch test passes.\n\nD. The modification introduces a zero-energy hourglass mode that annihilates stiffness, producing identically zero stress throughout the patch, regardless of the imposed uniform strain.\n\nE. A spurious constant body force is induced by the PoU violation such that boundary reactions remain correct and the uniform strain is reproduced; the patch test passes.", "solution": "The fundamental principle being tested is the patch test, a necessary condition for the convergence of a finite element formulation. An element passes the patch test if, for any patch of elements, the finite element solution exactly reproduces any arbitrary constant strain state when the corresponding linear displacement field is imposed on the boundary of the patch.\n\nFirst, let us analyze the properties of the proposed displacement shape functions, $\\{\\tilde{N}_i\\}$. The sum of these shape functions is:\n$$\n\\sum_{i=1}^{4} \\tilde{N}_i(\\xi,\\eta) = \\tilde{N}_1 + N_2 + N_3 + N_4 = (N_1 + \\beta b) + N_2 + N_3 + N_4 = \\left(\\sum_{i=1}^{4} N_i\\right) + \\beta b(\\xi,\\eta)\n$$\nStandard bilinear shape functions satisfy the Partition of Unity (PoU) property, $\\sum_{i=1}^{4} N_i = 1$. Therefore, for the modified shape functions:\n$$\n\\sum_{i=1}^{4} \\tilde{N}_i(\\xi,\\eta) = 1 + \\beta b(\\xi,\\eta)\n$$\nSince $\\beta \\neq 0$ and the bubble function $b(\\xi,\\eta) > 0$ in the element interior, the PoU property is violated. This violation has immediate consequences. For instance, the element cannot exactly reproduce a rigid-body translation. If we set all nodal displacements to a constant vector $\\mathbf{u}_0$, the interpolated displacement is:\n$$\n\\mathbf{u}^h = \\sum_{i=1}^{4} \\tilde{N}_i \\mathbf{u}_0 = \\left(\\sum_{i=1}^{4} \\tilde{N}_i\\right) \\mathbf{u}_0 = (1 + \\beta b) \\mathbf{u}_0 \\neq \\mathbf{u}_0\n$$\nSince rigid-body motion reproduction is a necessary condition to pass the patch test, we can already conclude the element will fail. However, let us investigate the specific case of a constant strain state.\n\nThe patch test requires the exact reproduction of a linear displacement field, $\\mathbf{u}(\\mathbf{x}) = \\mathbf{B}\\mathbf{x}$. Let us check if the element formulation can do this. The finite element displacement field, $\\mathbf{u}^h$, is interpolated from the nodal values $\\mathbf{d}_i$. If the interpolation were exact, then by setting the nodal displacements to their exact values, $\\mathbf{d}_i = \\mathbf{u}(\\mathbf{x}_i) = \\mathbf{B}\\mathbf{x}_i$, the interpolated field $\\mathbf{u}^h$ should equal $\\mathbf{u}(\\mathbf{x})$ everywhere in the element.\nLet's compute the interpolated field with these nodal values:\n$$\n\\mathbf{u}^h(\\xi,\\eta) = \\sum_{i=1}^{4} \\tilde{N}_i(\\xi,\\eta) \\mathbf{d}_i = \\sum_{i=1}^{4} \\tilde{N}_i(\\xi,\\eta) (\\mathbf{B}\\mathbf{x}_i) = \\mathbf{B} \\left( \\sum_{i=1}^{4} \\tilde{N}_i(\\xi,\\eta) \\mathbf{x}_i \\right)\n$$\nNow we analyze the sum:\n$$\n\\sum_{i=1}^{4} \\tilde{N}_i \\mathbf{x}_i = (N_1 + \\beta b)\\mathbf{x}_1 + N_2\\mathbf{x}_2 + N_3\\mathbf{x}_3 + N_4\\mathbf{x}_4 = \\left(\\sum_{i=1}^{4} N_i \\mathbf{x}_i\\right) + \\beta b(\\xi,\\eta) \\mathbf{x}_1\n$$\nFor an isoparametric element, the geometry is interpolated using the same standard shape functions used for displacement in a conventional formulation: $\\mathbf{x}(\\xi,\\eta) = \\sum_{i=1}^{4} N_i(\\xi,\\eta)\\mathbf{x}_i$. Substituting this in, we get:\n$$\n\\sum_{i=1}^{4} \\tilde{N}_i \\mathbf{x}_i = \\mathbf{x}(\\xi,\\eta) + \\beta b(\\xi,\\eta) \\mathbf{x}_1\n$$\nThe interpolated displacement field is therefore:\n$$\n\\mathbf{u}^h(\\xi,\\eta) = \\mathbf{B} \\left(\\mathbf{x}(\\xi,\\eta) + \\beta b(\\xi,\\eta) \\mathbf{x}_1\\right) = \\mathbf{B}\\mathbf{x}(\\xi,\\eta) + \\beta b(\\xi,\\eta) \\mathbf{B}\\mathbf{x}_1\n$$\nSince $\\mathbf{u}(\\mathbf{x}) = \\mathbf{B}\\mathbf{x}$, we find:\n$$\n\\mathbf{u}^h(\\mathbf{x}) = \\mathbf{u}(\\mathbf{x}) + \\beta b(\\xi(\\mathbf{x}),\\eta(\\mathbf{x})) \\mathbf{u}(\\mathbf{x}_1)\n$$\nThe finite element field $\\mathbf{u}^h$ is not equal to the exact linear field $\\mathbf{u}$. There is an error term proportional to $\\beta$ and the bubble function $b$. This confirms that the formulation cannot exactly represent a constant strain state. Therefore, the patch test is failed.\n\nNow, let us examine the computed strain field, $\\boldsymbol{\\varepsilon}^h = \\mathrm{sym}(\\nabla \\mathbf{u}^h)$.\n$$\n\\boldsymbol{\\varepsilon}^h = \\mathrm{sym}(\\nabla \\mathbf{u}) + \\mathrm{sym}(\\nabla [\\beta b(\\xi(\\mathbf{x}),\\eta(\\mathbf{x})) \\mathbf{u}(\\mathbf{x}_1)])\n$$\nThe exact strain is $\\boldsymbol{\\varepsilon} = \\mathrm{sym}(\\nabla \\mathbf{u}) = \\mathrm{sym}(\\mathbf{B})$, which is a constant tensor. The error in strain is:\n$$\n\\boldsymbol{\\varepsilon}_{error} = \\beta \\, \\mathrm{sym}(\\nabla [b \\cdot \\mathbf{u}(\\mathbf{x}_1)]) = \\beta \\, \\mathrm{sym}((\\nabla b) \\otimes \\mathbf{u}(\\mathbf{x}_1))\n$$\nThe vector $\\mathbf{u}(\\mathbf{x}_1)$ is a constant for a given element. The gradient of the bubble function, $\\nabla b$, is generally not constant over the element. For example, $\\partial b / \\partial\\xi = -\\frac{1}{2}\\xi(1-\\eta^2)$, which is a function of position. The gradient $\\nabla b$ in physical coordinates involves the Jacobian of the geometric map, but it will remain a non-constant function of position.\nThis means the computed strain, $\\boldsymbol{\\varepsilon}^h = \\boldsymbol{\\varepsilon} + \\boldsymbol{\\varepsilon}_{error}$, is not uniform across the element. It contains a spurious, non-constant part with oscillatory characteristics inherited from the bubble function and its derivatives. The magnitude of this error is of order $\\mathcal{O}(\\beta)$. A non-uniform strain field implies a non-uniform stress field ($\\boldsymbol{\\sigma}^h = \\mathbf{C}\\boldsymbol{\\varepsilon}^h$), which is physically incorrect for this problem. The inability to satisfy equilibrium with the exact solution leads to incorrect nodal displacements being computed for the interior nodes, and consequently, inconsistent nodal reaction forces.\n\nWe can now evaluate the given options.\n\nA. The computed strain field remains exactly uniform across the entire patch because nodal boundary displacements enforce the exact solution; the patch test passes.\n**Incorrect**. As derived, the strain field is not uniform due to the inability of the modified shape functions to reproduce a linear displacement field. The patch test fails.\n\nB. The computed displacement field is exact along all element boundaries, but the interior of each element exhibits nonuniform, oscillatory strains of order $\\mathcal{O}(\\beta)$, leading to nonconstant stresses and inconsistent nodal reactions; the patch test fails and the error does not vanish unless $\\beta \\to 0$.\n**Correct**. This option correctly identifies the failure of the patch test and accurately describes the resulting error. The computed strain is indeed non-uniform and oscillatory of order $\\mathcal{O}(\\beta)$, leading to non-constant stresses. This inconsistency means the patch test fails. The phrase \"The computed displacement field is exact along all element boundaries\" is strictly true only for the outer boundary $\\partial\\Omega$ where displacements are prescribed. For internal element boundaries, the solved nodal displacements will be erroneous, leading to an inexact displacement field along those boundaries. However, among the given choices, this statement provides the best and most complete description of the physically significant consequences of the formulation error.\n\nC. Only rigid-body motion reproduction is lost due to the PoU violation, but uniform strain reproduction remains exact; the patch test passes.\n**Incorrect**. We have shown that both rigid-body motion and constant strain state reproduction are lost. The patch test fails.\n\nD. The modification introduces a zero-energy hourglass mode that annihilates stiffness, producing identically zero stress throughout the patch, regardless of the imposed uniform strain.\n**Incorrect**. This modification does not necessarily create a zero-energy mode. It creates an inconsistent formulation. The boundary conditions correspond to a non-zero strain state, so the computed stresses will be non-zero, albeit incorrect. Claiming identically zero stress is physically implausible.\n\nE. A spurious constant body force is induced by the PoU violation such that boundary reactions remain correct and the uniform strain is reproduced; the patch test passes.\n**Incorrect**. The patch test fails. The error induced in the strain field is non-constant, so it cannot be represented by a spurious constant body force.\n\nThus, option B provides the best qualitative description of the outcome.", "answer": "$$\\boxed{B}$$", "id": "3606135"}, {"introduction": "In practice, element performance involves more than just consistency. Issues like volumetric locking can degrade accuracy, particularly when modeling nearly incompressible materials. This final problem challenges us to disentangle the concept of consistency (passing the patch test) from numerical stability (avoiding locking) by applying a hydrostatic strain field to a patch of elements, forcing a careful analysis of whether the exact solution is still reproduced [@problem_id:3606141].", "problem": "Consider a small-strain, plane strain, linear elastic body occupying the square domain $\\Omega = [0,2L] \\times [0,2L]$ with $L>0$. The material is isotropic with Young’s modulus $E>0$ and Poisson’s ratio $\\nu = 0.499$. The body is discretized using the Finite Element Method (FEM) with a $2 \\times 2$ patch of bilinear quadrilateral ($Q4$) isoparametric elements, each element being an axis-aligned square of side length $L$. The geometry mapping for each element from the bi-unit parent domain $(\\xi,\\eta) \\in [-1,1] \\times [-1,1]$ to the physical element is affine, so that $x = x_{c} + \\frac{L}{2}\\,\\xi$ and $y = y_{c} + \\frac{L}{2}\\,\\eta$, where $(x_{c},y_{c})$ is the element center.\n\nLet the exact displacement field be the uniform hydrostatic strain-induced field\n$$\nu_{x}(x,y) = \\epsilon_{0}\\,x, \\quad u_{y}(x,y) = \\epsilon_{0}\\,y,\n$$\nwith $\\epsilon_{0}$ a prescribed constant. This produces the exact constant strain field\n$$\n\\boldsymbol{\\epsilon}_{\\text{exact}} = \n\\begin{pmatrix}\n\\epsilon_{0} & 0 \\\\\n0 & \\epsilon_{0}\n\\end{pmatrix},\n$$\nequivalently $\\epsilon_{xx} = \\epsilon_{0}$, $\\epsilon_{yy} = \\epsilon_{0}$, and $\\gamma_{xy} = 0$.\n\nImpose essential boundary conditions at all boundary nodes by prescribing the exact displacements $u_{x}=\\epsilon_{0} x$ and $u_{y}=\\epsilon_{0} y$. Use Selective Reduced Integration (SRI) in the element-level internal virtual work computation: split the stress into deviatoric and volumetric parts using Lamé parameters $\\mu = \\frac{E}{2(1+\\nu)}$ and $\\lambda = \\frac{E\\,\\nu}{(1+\\nu)(1-2\\nu)}$, and integrate the deviatoric contribution with standard $2 \\times 2$ Gauss quadrature over each element, while integrating the volumetric contribution with a single Gauss point at $(\\xi,\\eta)=(0,0)$ per element.\n\nDefine the patch test error measure\n$$\nJ \\;=\\; \\left(\\frac{1}{|\\Omega|}\\int_{\\Omega} \\left\\| \\boldsymbol{\\epsilon}_{h} - \\boldsymbol{\\epsilon}_{\\text{exact}} \\right\\|_{F}^{2}\\, \\mathrm{d}\\Omega \\right)^{1/2},\n$$\nwhere $\\boldsymbol{\\epsilon}_{h}$ is the finite element strain field obtained with the above SRI scheme, $\\|\\cdot\\|_{F}$ is the Frobenius norm, and $|\\Omega|$ is the area of $\\Omega$. Compute the value of $J$. Provide your answer as a single real number with no units. No rounding is required.", "solution": "The problem asks for the computation of the error norm $J$, which quantifies the difference between the strain field computed by the finite element analysis, $\\boldsymbol{\\epsilon}_{h}$, and the exact strain field, $\\boldsymbol{\\epsilon}_{\\text{exact}}$.\n\nThe problem setup describes a classic \"patch test.\" The patch test is a fundamental consistency check for a finite element formulation. It verifies whether a patch of elements can exactly reproduce a state of constant strain. If a formulation passes the patch test, the FEM solution for displacements and strains will be exact when the true solution corresponds to a constant strain field.\n\nThe exact displacement field is given by $u_{x}(x,y) = \\epsilon_{0}\\,x$ and $u_{y}(x,y) = \\epsilon_{0}\\,y$. This is a linear displacement field. The corresponding exact strain tensor is constant throughout the domain:\n$$\n\\epsilon_{xx} = \\frac{\\partial u_x}{\\partial x} = \\epsilon_0, \\quad \\epsilon_{yy} = \\frac{\\partial u_y}{\\partial y} = \\epsilon_0, \\quad \\gamma_{xy} = \\frac{\\partial u_x}{\\partial y} + \\frac{\\partial u_y}{\\partial x} = 0\n$$\nThis represents a state of constant hydrostatic strain.\n\nThe FEM solution involves finding the nodal displacements $\\mathbf{d}_h$ that satisfy the system of linear equations $K \\mathbf{d}_h = \\mathbf{f}$, where $K$ is the global stiffness matrix and $\\mathbf{f}$ is the global force vector.\n\nFor an element formulation to pass the patch test, two conditions must be met:\n1.  The finite element basis functions must be able to exactly represent the constant strain field. For the $Q4$ element, the shape functions $N_i(\\xi, \\eta)$ are bilinear. The mapping from the parent to the physical domain is affine. This means the displacement field within an element, $u_h(x,y) = \\sum_i N_i(x,y) d_i$, is also bilinear. A bilinear function space contains all linear functions. Since the exact displacement field is linear, it can be represented exactly by the $Q4$ elements.\n2.  The discrete system of equations must yield the exact nodal displacements.\n\nIn this problem, essential boundary conditions are applied to all nodes on the boundary of the domain $\\Omega = [0,2L] \\times [0,2L]$. The $2 \\times 2$ patch has $9$ nodes. 8 of these lie on the boundary, and one node at $(L,L)$ is an interior node. For all boundary nodes (node $j$), the displacements are set to their exact values: $\\mathbf{d}_j = (\\epsilon_0 x_j, \\epsilon_0 y_j)^T$. The displacement of the central node, $\\mathbf{d}_c$, is the only unknown to be solved for.\n\nThe equilibrium equation for the free degrees of freedom at the central node is derived from the weak form, stating that the sum of internal forces at that node must be zero (since there are no applied external forces at that node). The internal force vector for the central node is the sum of contributions from the four elements that meet at this node:\n$$\n\\mathbf{F}_{\\text{int},c} = \\sum_{e=1}^{4} \\mathbf{F}_{\\text{int},c}^{e} = \\mathbf{0}\n$$\nIf we test whether the exact solution satisfies this system, we substitute the exact displacements for all nodes into the formulation. For a constant strain state $\\boldsymbol{\\epsilon}_c$, the stress $\\boldsymbol{\\sigma}_c = D \\boldsymbol{\\epsilon}_c$ is also constant. The internal force vector can be written as:\n$$\n\\mathbf{F}_{\\text{int}}^{e} = \\left(\\int_{\\Omega_e} B^T \\, d\\Omega \\right) \\boldsymbol{\\sigma}_c\n$$\nThe equilibrium equation for the central node becomes:\n$$\n\\mathbf{F}_{\\text{int},c} = \\left( \\sum_{e=1}^{4} \\int_{\\Omega_e} B_c^T \\, d\\Omega \\right) \\boldsymbol{\\sigma}_c = \\mathbf{0}\n$$\nwhere $B_c$ is the part of the $B$ matrix corresponding to the central node. For a regular patch of affine elements surrounding an interior node, it is a standard result in FEM that the sum of the integrals of the strain-displacement matrix is zero: $\\sum_{e=1}^{4} \\int_{\\Omega_e} B_c \\, d\\Omega = \\mathbf{0}$. This ensures that a constant stress field produces zero net force on an internal node, satisfying equilibrium.\n\nThe problem specifies a Selective Reduced Integration (SRI) scheme. The key point is that for an affine element, the Jacobian of the transformation is constant, and the components of the $B$ matrix are linear functions of $\\xi$ and $\\eta$. Both the $1 \\times 1$ and $2 \\times 2$ Gauss quadrature rules integrate linear functions exactly over the parent domain. Therefore, the integral $\\int_{\\Omega_e} B^T \\, d\\Omega$ is computed exactly by both integration schemes, and thus the total internal force calculation is also exact. The property $\\sum_e \\int B_c^T d\\Omega = \\mathbf{0}$ holds, and the force balance at the central node is satisfied by the exact nodal displacements.\n\nThus, the finite element solution for the nodal displacements, $\\mathbf{d}_h$, is identical to the vector of exact nodal displacements.\nSince the nodal displacements $\\mathbf{d}_h$ are exact and the bilinear shape functions can exactly represent the linear displacement field, the interpolated FEM displacement field $\\mathbf{u}_h(\\mathbf{x})$ is identical to the exact field $\\mathbf{u}_{\\text{exact}}(\\mathbf{x})$ everywhere in the domain $\\Omega$:\n$$\n\\mathbf{u}_h(\\mathbf{x}) = \\mathbf{u}_{\\text{exact}}(\\mathbf{x})\n$$\nThe finite element strain field $\\boldsymbol{\\epsilon}_h$ is obtained by differentiating the displacement field $\\mathbf{u}_h$:\n$$\n\\boldsymbol{\\epsilon}_h(\\mathbf{x}) = \\nabla^s \\mathbf{u}_h(\\mathbf{x}) = \\nabla^s \\mathbf{u}_{\\text{exact}}(\\mathbf{x}) = \\boldsymbol{\\epsilon}_{\\text{exact}}\n$$\nThis means that the computed strain field is pointwise identical to the exact constant strain field.\n\nNow, we can compute the error measure $J$:\n$$\nJ \\;=\\; \\left(\\frac{1}{|\\Omega|}\\int_{\\Omega} \\left\\| \\boldsymbol{\\epsilon}_{h} - \\boldsymbol{\\epsilon}_{\\text{exact}} \\right\\|_{F}^{2}\\, \\mathrm{d}\\Omega \\right)^{1/2}\n$$\nSubstituting $\\boldsymbol{\\epsilon}_{h} = \\boldsymbol{\\epsilon}_{\\text{exact}}$:\n$$\nJ \\;=\\; \\left(\\frac{1}{|\\Omega|}\\int_{\\Omega} \\left\\| \\boldsymbol{\\epsilon}_{\\text{exact}} - \\boldsymbol{\\epsilon}_{\\text{exact}} \\right\\|_{F}^{2}\\, \\mathrm{d}\\Omega \\right)^{1/2} = \\left(\\frac{1}{|\\Omega|}\\int_{\\Omega} \\left\\| \\mathbf{0} \\right\\|_{F}^{2}\\, \\mathrm{d}\\Omega \\right)^{1/2}\n$$\nThe Frobenius norm of the zero matrix is $0$. The integrand is $0$ everywhere in the domain.\n$$\nJ \\;=\\; \\left(\\frac{1}{|\\Omega|}\\int_{\\Omega} 0 \\, \\mathrm{d}\\Omega \\right)^{1/2} = 0\n$$\nThe value of the error measure $J$ is exactly $0$. This confirms that the given FEM formulation passes the patch test for constant strain. The use of Selective Reduced Integration, while important for avoiding locking in more complex problems, does not compromise the element's ability to pass the patch test. The specific material properties ($E$, $\\nu$) and geometric parameters ($L$) do not affect this fundamental result.", "answer": "$$\\boxed{0}$$", "id": "3606141"}]}