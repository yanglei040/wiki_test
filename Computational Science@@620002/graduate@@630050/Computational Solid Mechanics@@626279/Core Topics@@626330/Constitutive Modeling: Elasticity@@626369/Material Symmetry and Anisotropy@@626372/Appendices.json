{"hands_on_practices": [{"introduction": "This first practice bridges the gap between material properties measured in the lab and the tensor components used in simulations. You will construct the full compliance and stiffness matrices for an orthotropic material from its fundamental engineering constants. This exercise is essential for understanding the internal structure of the constitutive model and for verifying a critical requirement for material stability: the positive definiteness of the stiffness matrix [@problem_id:3580525].", "problem": "You are given a linear elastic orthotropic solid in three dimensions under small strains. In Voigt notation, the constitutive relation is $\\,\\boldsymbol{\\sigma} = \\mathbf{C}\\,\\boldsymbol{\\varepsilon}\\,$, where $\\,\\mathbf{C}\\,$ is the symmetric $\\,6\\times 6\\,$ stiffness matrix, and the compliance matrix $\\,\\mathbf{S}\\,$ satisfies $\\,\\mathbf{S} = \\mathbf{C}^{-1}\\,$. The orthotropic material at a point is characterized by the nine engineering constants: three Young’s moduli $\\,E_1,E_2,E_3\\,$, three Poisson ratios $\\,\\nu_{12},\\nu_{23},\\nu_{31}\\,$ (with the reciprocal Poisson ratios constrained by $\\,\\nu_{21} = \\nu_{12}\\,E_2/E_1\\,$, $\\,\\nu_{32} = \\nu_{23}\\,E_3/E_2\\,$, $\\,\\nu_{13} = \\nu_{31}\\,E_1/E_3\\,$ to ensure symmetry of the compliance), and three shear moduli $\\,G_{12},G_{23},G_{31}\\,$. Under the standard engineering shear strain convention, the compliance matrix $\\,\\mathbf{S}\\,$ in Voigt ordering $\\,\\{11,22,33,23,13,12\\}\\,$ has the block-diagonal structure consistent with orthotropy and must be assembled from the given engineering constants. Using only fundamental linear elasticity principles and matrix theory, do the following for each test case:\n\n1. Assemble $\\,\\mathbf{S}\\,$ from the provided engineering constants, ensuring the reciprocity relations $\\,\\nu_{ji} = \\nu_{ij} E_j / E_i\\,$ are enforced so that $\\,\\mathbf{S}\\,$ is symmetric.\n2. Compute the stiffness matrix $\\,\\mathbf{C} = \\mathbf{S}^{-1}\\,$ explicitly by numerical inversion.\n3. Check symmetry of $\\,\\mathbf{S}\\,$ and $\\,\\mathbf{C}\\,$ using a numerical tolerance of $\\,10^{-10}\\,$ in the absolute sense for entries.\n4. Check positive definiteness of $\\,\\mathbf{C}\\,$ by verifying that all eigenvalues of the symmetrized matrix $\\,(\\mathbf{C}+\\mathbf{C}^\\mathsf{T})/2\\,$ are strictly greater than a positivity tolerance of $\\,10^{-9}\\,$ in gigapascals (GPa).\n5. Report the smallest eigenvalue of $\\,\\mathbf{C}\\,$ (in GPa) rounded to $\\,6\\,$ decimal places.\n\nAll stiffness-like quantities $\\,E_i\\,$ and $\\,G_{ij}\\,$ are provided in gigapascals (GPa), Poisson ratios are dimensionless, the compliance entries are to be treated in inverse gigapascals (GPa$^{-1}$), and the stiffness entries in gigapascals (GPa). Angles are not involved. The output for each test case must be a list $[\\text{is\\_S\\_symmetric}, \\text{is\\_C\\_symmetric}, \\text{is\\_C\\_positive\\_definite}, \\text{min\\_eig\\_C\\_GPa}]$, where the booleans indicate the results of the symmetry and positive definiteness checks, and the last entry is the rounded smallest eigenvalue of $\\,\\mathbf{C}\\,$ in GPa.\n\nTest suite (there are $\\,3\\,$ distinct cases):\n\n- Case $\\,1\\,$ (highly orthotropic, fiber-reinforced-like):\n  - $\\,E_1 = 150.0\\,$ GPa, $\\,E_2 = 10.0\\,$ GPa, $\\,E_3 = 10.0\\,$ GPa\n  - $\\,\\nu_{12} = 0.25\\,$, $\\,\\nu_{23} = 0.30\\,$, $\\,\\nu_{31} = 0.02\\,$\n  - $\\,G_{12} = 5.5\\,$ GPa, $\\,G_{23} = 3.8\\,$ GPa, $\\,G_{31} = 5.2\\,$ GPa\n\n- Case $\\,2\\,$ (quasi-isotropic baseline):\n  - $\\,E_1 = E_2 = E_3 = 210.0\\,$ GPa\n  - $\\,\\nu_{12} = \\nu_{23} = \\nu_{31} = 0.30\\,$\n  - $\\,G_{12} = G_{23} = G_{31} = \\dfrac{210.0}{2(1+0.30)}\\,$ GPa\n\n- Case $\\,3\\,$ (near-incompressible-like):\n  - $\\,E_1 = E_2 = E_3 = 3.5\\,$ GPa\n  - $\\,\\nu_{12} = \\nu_{23} = \\nu_{31} = 0.49\\,$\n  - $\\,G_{12} = G_{23} = G_{31} = \\dfrac{3.5}{2(1+0.49)}\\,$ GPa\n\nYour program must compute, for each case, the $\\,\\mathbf{S}\\,$ and $\\,\\mathbf{C}\\,$ matrices, perform the checks, and produce a single line of output containing a list of $\\,3\\,$ sublists (one per case) in the exact format:\n$[ [b_{11},b_{12},b_{13},f_1], [b_{21},b_{22},b_{23},f_2], [b_{31},b_{32},b_{33},f_3] ]$\nwhere $\\,b_{ij}\\,$ are booleans and $\\,f_i\\,$ are floats (in GPa) rounded to $\\,6\\,$ decimal places. No additional text must be printed beyond this single-line output.", "solution": "We start from the linear elasticity relation $\\,\\boldsymbol{\\sigma} = \\mathbf{C}\\,\\boldsymbol{\\varepsilon}\\,$ and its inverse $\\,\\boldsymbol{\\varepsilon} = \\mathbf{S}\\,\\boldsymbol{\\sigma}\\,$, with $\\,\\mathbf{S} = \\mathbf{C}^{-1}\\,$. For an orthotropic material under the engineering shear strain convention in Voigt notation $\\,\\{11,22,33,23,13,12\\}\\,$, the compliance matrix $\\,\\mathbf{S}\\,$ is block diagonal between normal and shear components. The shear compliances are given directly by the inverses of the shear moduli as $\\,S_{44}=1/G_{23}\\,$, $\\,S_{55}=1/G_{31}\\,$, and $\\,S_{66}=1/G_{12}\\,$, with all other shear off-diagonal entries vanishing due to orthotropy.\n\nFor the normal $\\,3\\times 3\\,$ block, orthotropy with reciprocal Poisson relations imposes symmetry. Specifically, to ensure $\\,\\mathbf{S}\\,$ is symmetric, we enforce $\\,\\nu_{21} = \\nu_{12}\\,E_2/E_1\\,$, $\\,\\nu_{32} = \\nu_{23}\\,E_3/E_2\\,$, and $\\,\\nu_{13} = \\nu_{31}\\,E_1/E_3\\,$. With these, the normal part entries are $\\,S_{11}=1/E_1\\,$, $\\,S_{22}=1/E_2\\,$, $\\,S_{33}=1/E_3\\,$, $\\,S_{12} = S_{21} = -\\nu_{12}/E_1\\,$, $\\,S_{13} = S_{31} = -\\nu_{13}/E_1\\,$, $\\,S_{23} = S_{32} = -\\nu_{23}/E_2\\,$. These are well-tested formulas in elasticity linking engineering constants to the compliance. The full $\\,6\\times 6\\,$ compliance $\\,\\mathbf{S}\\,$ is then assembled by placing the normal $\\,3\\times 3\\,$ block in the upper left, and the shear compliances on the diagonal positions $\\,44\\,$, $\\,55\\,$, and $\\,66\\,$.\n\nWith $\\,\\mathbf{S}\\,$ constructed, the stiffness matrix $\\,\\mathbf{C}\\,$ follows from $\\,\\mathbf{C} = \\mathbf{S}^{-1}\\,$, computable numerically by standard matrix inversion. The resulting $\\,\\mathbf{C}\\,$ should be symmetric by physical principles; numerically, we test symmetry of both $\\,\\mathbf{S}\\,$ and $\\,\\mathbf{C}\\,$ using an absolute tolerance $\\,10^{-10}\\,$ on the difference from their transposes.\n\nFor positive definiteness, in linear elastic stability, the stiffness matrix $\\,\\mathbf{C}\\,$ must be symmetric positive definite, meaning all eigenvalues are strictly positive. Numerically, we evaluate the eigenvalues of the symmetrized matrix $\\,(\\mathbf{C} + \\mathbf{C}^\\mathsf{T})/2\\,$ using an algorithm for Hermitian matrices, and verify that the minimal eigenvalue exceeds a small tolerance $\\,10^{-9}\\,$ in gigapascals to account for roundoff. This produces a boolean $\\,\\text{is\\_C\\_positive\\_definite}\\,$ per test case. We additionally report the smallest eigenvalue itself, in gigapascals, rounded to $\\,6\\,$ decimal places.\n\nAll given $\\,E_i\\,$ and $\\,G_{ij}\\,$ are specified in gigapascals (GPa), so the compliance entries computed as reciprocals are in inverse gigapascals (GPa$^{-1}$), while the stiffness entries are in gigapascals (GPa). The Poisson ratios are dimensionless. Because $\\,\\mathbf{S}\\,$ in this orthotropic form is block diagonal in its shear components with strictly positive $\\,G_{ij}\\,$, stability checks reduce largely to the normal block’s contribution, but numerically we evaluate the full $\\,6\\times 6\\,$ matrix to account for coupling after inversion.\n\nThe algorithm applied to each case is:\n- Input $\\,E_1,E_2,E_3,\\nu_{12},\\nu_{23},\\nu_{31},G_{12},G_{23},G_{31}\\,$ (all in GPa except the dimensionless Poisson ratios).\n- Compute $\\,\\nu_{21}=\\nu_{12}E_2/E_1\\,$, $\\,\\nu_{32}=\\nu_{23}E_3/E_2\\,$, $\\,\\nu_{13}=\\nu_{31}E_1/E_3\\,$.\n- Assemble $\\,\\mathbf{S}\\,$ by placing:\n  - $\\,S_{11}=1/E_1\\,$, $\\,S_{22}=1/E_2\\,$, $\\,S_{33}=1/E_3\\,$,\n  - $\\,S_{12}=S_{21}=-\\nu_{12}/E_1\\,$, $\\,S_{13}=S_{31}=-\\nu_{13}/E_1\\,$, $\\,S_{23}=S_{32}=-\\nu_{23}/E_2\\,$,\n  - $\\,S_{44}=1/G_{23}\\,$, $\\,S_{55}=1/G_{31}\\,$, $\\,S_{66}=1/G_{12}\\,$,\n  and zeros elsewhere.\n- Compute $\\,\\mathbf{C} = \\mathbf{S}^{-1}\\,$ and symmetrize $\\,\\mathbf{C}\\,$ as $\\,\\mathbf{C}_\\text{sym} = (\\mathbf{C}+\\mathbf{C}^\\mathsf{T})/2\\,$ for eigen-analysis.\n- Check $\\,\\|\\mathbf{S}-\\mathbf{S}^\\mathsf{T}\\|_\\infty \\le 10^{-10}\\,$ and $\\,\\|\\mathbf{C}-\\mathbf{C}^\\mathsf{T}\\|_\\infty \\le 10^{-10}\\,$ to set the symmetry booleans.\n- Compute the eigenvalues of $\\,\\mathbf{C}_\\text{sym}\\,$, set the positive definiteness boolean if the minimal eigenvalue is $\\,> 10^{-9}\\,$, and record that minimal eigenvalue rounded to $\\,6\\,$ decimal places.\n\nThe test suite comprises $\\,3\\,$ cases as specified in the problem statement. For the quasi-isotropic cases, the shear moduli are set consistently via $\\,G = E/[2(1+\\nu)]\\,$ for the stated $\\,E\\,$ and $\\,\\nu\\,$, ensuring internal consistency. The final program outputs a single line with the list $\\,\\big[\\,[\\text{is\\_S\\_symmetric}, \\text{is\\_C\\_symmetric}, \\text{is\\_C\\_positive\\_definite}, \\text{min\\_eig\\_C\\_GPa}], \\ldots\\big]\\,$ for the $\\,3\\,$ cases, with the smallest eigenvalue in gigapascals rounded to $\\,6\\,$ decimals, as required.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef assemble_compliance(E1, E2, E3, nu12, nu23, nu31, G12, G23, G31):\n    \"\"\"\n    Assemble the 6x6 orthotropic compliance matrix S (Voigt order 11,22,33,23,13,12)\n    using engineering shear strains. Units: E and G in GPa, S in 1/GPa.\n    \"\"\"\n    # The major Poisson's ratios are given. The minor ones are found by reciprocity.\n    # The given nu12, nu23, nu31 are the primary constants.\n    # To make S symmetric, we need nu_ij/E_i = nu_ji/E_j.\n    # So nu21 = nu12 * E2/E1, nu13 = nu31 * E1/E3, nu32 = nu23 * E3/E2.\n    nu13_calc = nu31 * E1 / E3\n\n    S = np.zeros((6, 6), dtype=float)\n\n    # Normal block (3x3)\n    S[0, 0] = 1.0 / E1\n    S[1, 1] = 1.0 / E2\n    S[2, 2] = 1.0 / E3\n\n    S[0, 1] = S[1, 0] = -nu12 / E1\n    S[0, 2] = S[2, 0] = -nu13_calc / E1 # which is equivalent to -nu31/E3\n    S[1, 2] = S[2, 1] = -nu23 / E2\n\n    # Shear compliances (engineering shear)\n    S[3, 3] = 1.0 / G23\n    S[4, 4] = 1.0 / G31\n    S[5, 5] = 1.0 / G12\n\n    return S\n\ndef is_symmetric(M, atol=1e-10):\n    return np.allclose(M, M.T, atol=atol, rtol=0.0)\n\ndef stiffness_from_compliance(S):\n    # Invert compliance to get stiffness\n    return np.linalg.inv(S)\n\ndef min_eigenvalue_and_pd(C, pd_tol=1e-9):\n    # Symmetrize to avoid numerical asymmetry effects\n    Csym = 0.5 * (C + C.T)\n    # Use eigvalsh for symmetric/Hermitian matrices\n    evals = np.linalg.eigvalsh(Csym)\n    lam_min = float(np.min(evals))\n    is_pd = lam_min > pd_tol\n    return lam_min, is_pd\n\ndef solve():\n    # Define the test cases from the problem statement (all moduli in GPa).\n    # Case 1: Highly orthotropic\n    case1 = {\n        \"E1\": 150.0, \"E2\": 10.0, \"E3\": 10.0,\n        \"nu12\": 0.25, \"nu23\": 0.30, \"nu31\": 0.02,\n        \"G12\": 5.5, \"G23\": 3.8, \"G31\": 5.2\n    }\n\n    # Case 2: Quasi-isotropic baseline\n    E_iso = 210.0\n    nu_iso = 0.30\n    G_iso = E_iso / (2.0 * (1.0 + nu_iso))\n    case2 = {\n        \"E1\": E_iso, \"E2\": E_iso, \"E3\": E_iso,\n        \"nu12\": nu_iso, \"nu23\": nu_iso, \"nu31\": nu_iso,\n        \"G12\": G_iso, \"G23\": G_iso, \"G31\": G_iso\n    }\n\n    # Case 3: Near-incompressible-like\n    E_nc = 3.5\n    nu_nc = 0.49\n    G_nc = E_nc / (2.0 * (1.0 + nu_nc))\n    case3 = {\n        \"E1\": E_nc, \"E2\": E_nc, \"E3\": E_nc,\n        \"nu12\": nu_nc, \"nu23\": nu_nc, \"nu31\": nu_nc,\n        \"G12\": G_nc, \"G23\": G_nc, \"G31\": G_nc\n    }\n\n    test_cases = [case1, case2, case3]\n\n    results = []\n    for params in test_cases:\n        S = assemble_compliance(**params)\n        C = stiffness_from_compliance(S)\n\n        S_sym = is_symmetric(S, atol=1e-10)\n        C_sym = is_symmetric(C, atol=1e-10)\n\n        lam_min, is_pd = min_eigenvalue_and_pd(C, pd_tol=1e-9)\n        # Round the minimal eigenvalue to 6 decimals as required\n        lam_min_rounded = round(lam_min, 6)\n\n        results.append([S_sym, C_sym, is_pd, lam_min_rounded])\n\n    # Final print statement in the format shown in the problem description's example.\n    # The default str() representation includes spaces after commas.\n    print(str(results))\n\nsolve()\n```", "id": "3580525"}, {"introduction": "In practical applications, the natural symmetry axes of an anisotropic material rarely align with the global coordinate system of your simulation. This exercise guides you through the crucial task of rotating the stiffness tensor from the material's local frame to the global frame using the formal Bond matrix transformation. Mastering this procedure is fundamental for accurately modeling realistic composite or geological materials whose orientation varies in space [@problem_id:3580567].", "problem": "Consider a homogeneous, linear elastic solid whose material symmetry is orthotropic with respect to a local Cartesian frame. Let the constitutive law be given in the local material frame by the fourth-order elasticity tensor $\\,\\mathbf{C}\\,$ such that $\\,\\boldsymbol{\\sigma} = \\mathbf{C} : \\boldsymbol{\\varepsilon}\\,$, where $\\,\\boldsymbol{\\sigma}\\,$ is the Cauchy stress and $\\,\\boldsymbol{\\varepsilon}\\,$ is the infinitesimal strain. The global frame is misaligned with the orthotropic axes by a proper orthogonal rotation $\\,\\mathbf{Q}\\in \\mathrm{SO}(3)\\,$. You must derive the transformed stiffness matrix in Voigt notation using the Bond matrix and quantify the induced coupling terms.\n\nYour derivation must start from the following fundamental base:\n- Linearity of elasticity in the small-strain regime with $\\,\\boldsymbol{\\sigma} = \\mathbf{C} : \\boldsymbol{\\varepsilon}\\,$.\n- The fourth-order tensor transformation law under a rotation $\\,\\mathbf{Q}\\,$, given by $\\,\\mathbf{C}^{\\prime}_{pqrs} = Q_{pi} Q_{qj} Q_{rk} Q_{sl}\\, \\mathbf{C}_{ijkl}\\,$.\n- The definitions of Voigt notation with engineering shear strains, where the stress Voigt vector is $\\,\\mathbf{s} = [\\sigma_{11},\\sigma_{22},\\sigma_{33},\\sigma_{23},\\sigma_{13},\\sigma_{12}]^{\\mathsf{T}}\\,$ and the strain Voigt vector is $\\,\\mathbf{e} = [\\varepsilon_{11},\\varepsilon_{22},\\varepsilon_{33},2\\varepsilon_{23},2\\varepsilon_{13},2\\varepsilon_{12}]^{\\mathsf{T}}\\,$.\n\nTasks:\n1. From first principles, construct the Bond matrices $\\,\\mathbf{B}_{\\sigma}(\\mathbf{Q})\\,$ and $\\,\\mathbf{B}_{\\varepsilon}(\\mathbf{Q})\\,$ that transform Voigt stress and Voigt strain, respectively, under the rotation $\\,\\mathbf{Q}\\,$, without assuming closed-form shortcut formulas. Use the action of $\\,\\mathbf{Q}\\,$ on symmetric second-order tensors and the definitions of Voigt mapping with engineering shear components to build these matrices column-by-column from their effect on Voigt basis tensors.\n2. Show that the transformed stiffness in Voigt notation satisfies $\\,\\mathbf{C}^{\\prime} = \\mathbf{B}_{\\sigma}(\\mathbf{Q})\\,\\mathbf{C}\\,\\mathbf{B}_{\\varepsilon}(\\mathbf{Q})^{-1}\\,$.\n3. Construct the orthotropic compliance matrix $\\,\\mathbf{S}\\,$ in the local material frame using engineering constants $\\,E_{1},E_{2},E_{3},\\nu_{12},\\nu_{13},\\nu_{23},G_{12},G_{13},G_{23}\\,$. Enforce major symmetry by setting $\\,\\nu_{21} = \\nu_{12}\\,E_{2}/E_{1}\\,$, $\\,\\nu_{31} = \\nu_{13}\\,E_{3}/E_{1}\\,$, and $\\,\\nu_{32} = \\nu_{23}\\,E_{3}/E_{2}\\,$, then obtain $\\,\\mathbf{C} = \\mathbf{S}^{-1}\\,$.\n4. Define the induced coupling terms as the normal–shear off-diagonal block of $\\,\\mathbf{C}^{\\prime}\\,$, that is, all entries $\\,C^{\\prime}_{ij}\\,$ with $\\,i\\in\\{1,2,3\\}\\,$ and $\\,j\\in\\{4,5,6\\}\\,$ in Voigt indexing. Quantify the total induced coupling by the sum of absolute values of the upper-block entries $\\,\\sum_{i=1}^{3}\\sum_{j=4}^{6} \\left|C^{\\prime}_{ij}\\right|\\,$.\n\nPhysical units and numerical format:\n- All moduli $\\,E_{k}\\,$ and $\\,G_{ij}\\,$ must be specified in gigapascals (GPa), and your output must be expressed in gigapascals (GPa).\n- All angles used to define rotations must be specified in degrees and converted to radians internally.\n- The final outputs must be real numbers (floats).\n\nTest suite:\nImplement your derivation in a program and evaluate the total induced coupling for the following four test cases. For each case, construct $\\,\\mathbf{S}\\,$, invert to get $\\,\\mathbf{C}\\,$, build $\\,\\mathbf{B}_{\\sigma}\\,$ and $\\,\\mathbf{B}_{\\varepsilon}\\,$ from $\\,\\mathbf{Q}\\,$, form $\\,\\mathbf{C}^{\\prime}\\,$, and compute the coupling sum $\\,\\sum_{i=1}^{3}\\sum_{j=4}^{6} \\left|C^{\\prime}_{ij}\\right|\\,$ in GPa, rounded to six decimal places.\n\n- Test case $\\,1\\,$ (happy path, aligned orthotropy): $\\,E_{1}=150\\,\\mathrm{GPa}\\,$, $\\,E_{2}=12\\,\\mathrm{GPa}\\,$, $\\,E_{3}=12\\,\\mathrm{GPa}\\,$, $\\,\\nu_{12}=0.25\\,$, $\\,\\nu_{13}=0.20\\,$, $\\,\\nu_{23}=0.30\\,$, $\\,G_{12}=6\\,\\mathrm{GPa}\\,$, $\\,G_{13}=5\\,\\mathrm{GPa}\\,$, $\\,G_{23}=4\\,\\mathrm{GPa}\\,$, and $\\,\\mathbf{Q}=\\mathbf{I}\\,$ the identity rotation. Expected behavior: zero coupling.\n- Test case $\\,2\\,$ (planar misalignment): Same moduli as Test case $\\,1\\,$, with $\\,\\mathbf{Q}\\,$ a rotation about the global $\\,3\\,$-axis by $\\,45^{\\circ}\\,$.\n- Test case $\\,3\\,$ (isotropic limit, edge case): $\\,E_{1}=E_{2}=E_{3}=100\\,\\mathrm{GPa}\\,$, $\\,\\nu_{12}=\\nu_{13}=\\nu_{23}=0.25\\,$, $\\,G_{12}=G_{13}=G_{23}=E/(2(1+\\nu))=40\\,\\mathrm{GPa}\\,$, and $\\,\\mathbf{Q}\\,$ is a rotation of $\\,40^{\\circ}\\,$ about the axis $\\,\\mathbf{a}=[1,1,1]^{\\mathsf{T}}/\\sqrt{3}\\,$. Expected behavior: zero coupling (up to numerical tolerance).\n- Test case $\\,4\\,$ (strongly anisotropic, composite misalignment): $\\,E_{1}=50\\,\\mathrm{GPa}\\,$, $\\,E_{2}=10\\,\\mathrm{GPa}\\,$, $\\,E_{3}=5\\,\\mathrm{GPa}\\,$, $\\,\\nu_{12}=0.25\\,$, $\\,\\nu_{13}=0.20\\,$, $\\,\\nu_{23}=0.30\\,$, $\\,G_{12}=8\\,\\mathrm{GPa}\\,$, $\\,G_{13}=6\\,\\mathrm{GPa}\\,$, $\\,G_{23}=4\\,\\mathrm{GPa}\\,$, and $\\,\\mathbf{Q}\\,$ is the composition of rotations by $\\,30^{\\circ}\\,$ about the global $\\,1\\,$-axis, $\\,20^{\\circ}\\,$ about the global $\\,2\\,$-axis, and $\\,10^{\\circ}\\,$ about the global $\\,3\\,$-axis, applied in that order.\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in GPa, rounded to six decimal places, for the four test cases in order. For example, $\\,\\left[\\text{result}_{1},\\text{result}_{2},\\text{result}_{3},\\text{result}_{4}\\right]\\,$.", "solution": "The problem requires the derivation and implementation of the transformation law for the stiffness matrix of a linear elastic orthotropic material under a coordinate system rotation. The goal is to quantify the induced normal-shear coupling. The solution will be systematically developed by addressing the four tasks outlined in the problem statement.\n\n### Task 1: Construction of Bond Matrices $\\mathbf{B}_{\\sigma}(\\mathbf{Q})$ and $\\mathbf{B}_{\\varepsilon}(\\mathbf{Q})$\n\nThe transformation of a symmetric second-order tensor, such as the Cauchy stress $\\boldsymbol{\\sigma}$, from the local material frame to a rotated global frame is given by $\\boldsymbol{\\sigma}' = \\mathbf{Q} \\boldsymbol{\\sigma} \\mathbf{Q}^{\\mathsf{T}}$, where $\\mathbf{Q} \\in \\mathrm{SO}(3)$ is the proper orthogonal rotation matrix. In component form, this is $\\sigma'_{ij} = Q_{ik} Q_{jl} \\sigma_{kl}$, where summation over repeated indices is implied.\n\nVoigt notation provides a mapping from a symmetric second-order tensor to a $6 \\times 1$ vector. The problem specifies the following mappings:\n- Stress vector: $\\mathbf{s} = [\\sigma_{11}, \\sigma_{22}, \\sigma_{33}, \\sigma_{23}, \\sigma_{13}, \\sigma_{12}]^{\\mathsf{T}}$\n- Strain vector (with engineering shear components): $\\mathbf{e} = [\\varepsilon_{11}, \\varepsilon_{22}, \\varepsilon_{33}, 2\\varepsilon_{23}, 2\\varepsilon_{13}, 2\\varepsilon_{12}]^{\\mathsf{T}}$\n\nThe Bond matrices, $\\mathbf{B}_{\\sigma}(\\mathbf{Q})$ and $\\mathbf{B}_{\\varepsilon}(\\mathbf{Q})$, are the $6 \\times 6$ transformation matrices for these Voigt vectors, defined by $\\mathbf{s}' = \\mathbf{B}_{\\sigma} \\mathbf{s}$ and $\\mathbf{e}' = \\mathbf{B}_{\\varepsilon} \\mathbf{e}$. We construct these matrices by relating the components of the transformed vectors ($\\mathbf{s}', \\mathbf{e}'$) to the components of the original vectors ($\\mathbf{s}, \\mathbf{e}$).\n\nLet the Voigt indices be $I, J \\in \\{1, \\dots, 6\\}$ and tensor indices be $i, j, k, l \\in \\{1, 2, 3\\}$. The mapping from Voigt index to tensor index pair is: $1 \\to (1,1)$, $2 \\to (2,2)$, $3 \\to (3,3)$, $4 \\to (2,3)$, $5 \\to (1,3)$, $6 \\to (1,2)$.\n\n**Construction of $\\mathbf{B}_{\\sigma}(\\mathbf{Q})$:**\nThe entry $(B_{\\sigma})_{IJ}$ is the coefficient of $s_J$ in the expansion of $s'_I$.\n\n1.  **Normal stress transformation ($I \\in \\{1,2,3\\}$):** The transformed normal stress component $\\sigma'_{ii}$ is given by:\n    $$ \\sigma'_{ii} = Q_{ik} Q_{il} \\sigma_{kl} = \\sum_{k=1}^3 Q_{ik}^2 \\sigma_{kk} + \\sum_{k<l} 2 Q_{ik} Q_{il} \\sigma_{kl} $$\n    The coefficients for $s_J = \\sigma_{kk}$ ($J \\in \\{1,2,3\\}$) are $(B_{\\sigma})_{IJ} = Q_{ik}^2$. For $s_J = \\sigma_{kl}$ ($J \\in \\{4,5,6\\}$), the coefficients are $(B_{\\sigma})_{IJ} = 2 Q_{ik} Q_{il}$.\n\n2.  **Shear stress transformation ($I \\in \\{4,5,6\\}$):** A transformed shear stress component $\\sigma'_{ij}$ ($i \\neq j$) is:\n    $$ \\sigma'_{ij} = Q_{ik} Q_{jl} \\sigma_{kl} = \\sum_{k=1}^3 Q_{ik} Q_{jk} \\sigma_{kk} + \\sum_{k<l} (Q_{ik} Q_{jl} + Q_{il} Q_{jk}) \\sigma_{kl} $$\n    The coefficients for $s_J = \\sigma_{kk}$ ($J \\in \\{1,2,3\\}$) are $(B_{\\sigma})_{IJ} = Q_{ik} Q_{jk}$. For $s_J = \\sigma_{kl}$ ($J \\in \\{4,5,6\\}$), they are $(B_{\\sigma})_{IJ} = Q_{ik} Q_{jl} + Q_{il} Q_{jk}$.\n\n**Construction of $\\mathbf{B}_{\\varepsilon}(\\mathbf{Q})$:**\nThe construction is analogous, but we must account for the factors of $2$ in the engineering shear strain definition, $\\gamma_{ij} = e_{I > 3} = 2\\varepsilon_{ij}$.\n\n1.  **Normal strain transformation ($I \\in \\{1,2,3\\}$):** The transformed normal strain component $\\varepsilon'_{ii}$ is:\n    $$ \\varepsilon'_{ii} = Q_{ik} Q_{il} \\varepsilon_{kl} = \\sum_{k=1}^3 Q_{ik}^2 \\varepsilon_{kk} + \\sum_{k<l} 2 Q_{ik} Q_{il} \\varepsilon_{kl} = \\sum_{k=1}^3 Q_{ik}^2 e_k + \\sum_{k<l} Q_{ik} Q_{il} e_{J>3} $$\n    The coefficients for $e_J = \\varepsilon_{kk}$ ($J \\in \\{1,2,3\\}$) are $(B_{\\varepsilon})_{IJ} = Q_{ik}^2$. For $e_J = 2\\varepsilon_{kl}$ ($J \\in \\{4,5,6\\}$), they are $(B_{\\varepsilon})_{IJ} = Q_{ik} Q_{il}$.\n\n2.  **Shear strain transformation ($I \\in \\{4,5,6\\}$):** A transformed engineering shear strain component $e'_I = 2\\varepsilon'_{ij}$ ($i \\neq j$) is:\n    $$ 2\\varepsilon'_{ij} = 2 Q_{ik} Q_{jl} \\varepsilon_{kl} = \\sum_{k=1}^3 2 Q_{ik} Q_{jk} \\varepsilon_{kk} + \\sum_{k<l} (Q_{ik} Q_{jl} + Q_{il} Q_{jk}) (2\\varepsilon_{kl}) $$\n    The coefficients for $e_J = \\varepsilon_{kk}$ ($J \\in \\{1,2,3\\}$) are $(B_{\\varepsilon})_{IJ} = 2 Q_{ik} Q_{jk}$. For $e_J = 2\\varepsilon_{kl}$ ($J \\in \\{4,5,6\\}$), they are $(B_{\\varepsilon})_{IJ} = Q_{ik} Q_{jl} + Q_{il} Q_{jk}$.\n\nThese formulas allow for the systematic construction of $\\mathbf{B}_{\\sigma}$ and $\\mathbf{B}_{\\varepsilon}$ from the rotation matrix $\\mathbf{Q}$.\n\n### Task 2: Derivation of Transformed Stiffness in Voigt Notation\n\nWe start with the constitutive relations in the local and global frames, expressed in Voigt notation:\n-   Local frame: $\\mathbf{s} = \\mathbf{C} \\mathbf{e}$\n-   Global frame: $\\mathbf{s}' = \\mathbf{C}' \\mathbf{e}'$\n\nWe also have the vector transformation laws derived above:\n-   $\\mathbf{s}' = \\mathbf{B}_{\\sigma}(\\mathbf{Q}) \\mathbf{s}$\n-   $\\mathbf{e}' = \\mathbf{B}_{\\varepsilon}(\\mathbf{Q}) \\mathbf{e}$, which implies $\\mathbf{e} = \\mathbf{B}_{\\varepsilon}(\\mathbf{Q})^{-1} \\mathbf{e}'$ (since $\\mathbf{Q}$ is orthogonal, $\\mathbf{B}_{\\varepsilon}$ is invertible).\n\nTo find the expression for $\\mathbf{C}'$, we substitute the local frame laws into the transformation laws to relate $\\mathbf{s}'$ and $\\mathbf{e}'$:\n1.  Start with the stress transformation: $\\mathbf{s}' = \\mathbf{B}_{\\sigma} \\mathbf{s}$\n2.  Substitute the local constitutive law: $\\mathbf{s}' = \\mathbf{B}_{\\sigma} (\\mathbf{C} \\mathbf{e})$\n3.  Substitute the expression for $\\mathbf{e}$: $\\mathbf{s}' = \\mathbf{B}_{\\sigma} \\mathbf{C} (\\mathbf{B}_{\\varepsilon}^{-1} \\mathbf{e}')$\n4.  Rearrange into the global constitutive form: $\\mathbf{s}' = (\\mathbf{B}_{\\sigma} \\mathbf{C} \\mathbf{B}_{\\varepsilon}^{-1}) \\mathbf{e}'$\n\nBy comparing this result with the definition $\\mathbf{s}' = \\mathbf{C}' \\mathbf{e}'$, we directly identify the transformed stiffness matrix in Voigt notation:\n$$ \\mathbf{C}' = \\mathbf{B}_{\\sigma}(\\mathbf{Q}) \\mathbf{C} \\mathbf{B}_{\\varepsilon}(\\mathbf{Q})^{-1} $$\nThis derivation is general for the specified Voigt notation.\n\n### Task 3: Construction of Orthotropic Compliance and Stiffness Matrices\n\nFor a linear elastic orthotropic material, the compliance matrix $\\mathbf{S}$ in the local material frame (where the axes align with the material symmetry planes) relates the strain vector $\\mathbf{e}$ to the stress vector $\\mathbf{s}$ via $\\mathbf{e} = \\mathbf{S} \\mathbf{s}$. Using the nine independent engineering constants ($E_1, E_2, E_3, \\nu_{12}, \\nu_{13}, \\nu_{23}, G_{12}, G_{13}, G_{23}$), and enforcing the symmetry condition of the compliance matrix ($\\mathbf{S} = \\mathbf{S}^{\\mathsf{T}}$), the matrix $\\mathbf{S}$ is:\n$$\n\\mathbf{S} = \\begin{pmatrix}\n\\frac{1}{E_1} & -\\frac{\\nu_{12}}{E_1} & -\\frac{\\nu_{13}}{E_1} & 0 & 0 & 0 \\\\\n-\\frac{\\nu_{12}}{E_1} & \\frac{1}{E_2} & -\\frac{\\nu_{23}}{E_2} & 0 & 0 & 0 \\\\\n-\\frac{\\nu_{13}}{E_1} & -\\frac{\\nu_{23}}{E_2} & \\frac{1}{E_3} & 0 & 0 & 0 \\\\\n0 & 0 & 0 & \\frac{1}{G_{23}} & 0 & 0 \\\\\n0 & 0 & 0 & 0 & \\frac{1}{G_{13}} & 0 \\\\\n0 & 0 & 0 & 0 & 0 & \\frac{1}{G_{12}}\n\\end{pmatrix}\n$$\nThe problem correctly states the symmetry relations (e.g., $\\nu_{21}/E_2 = \\nu_{12}/E_1$) which are embedded in this form. The local stiffness matrix $\\mathbf{C}$ is then obtained by inverting the compliance matrix:\n$$ \\mathbf{C} = \\mathbf{S}^{-1} $$\nThis matrix $\\mathbf{C}$ is block-diagonal, with no coupling between normal and shear components in the material frame.\n\n### Task 4: Quantification of Induced Coupling\n\nWhen the material is observed in a coordinate system rotated by $\\mathbf{Q}$, the transformed stiffness matrix $\\mathbf{C}'$ is generally fully populated. The problem defines \"induced coupling\" as the terms that link normal stresses to shear strains and shear stresses to normal strains. In the $6 \\times 6$ matrix $\\mathbf{C}'$, these are the off-diagonal blocks. The specific quantity to compute is the sum of the absolute values of the entries in the upper-right $3 \\times 3$ block, which represents the normal-shear coupling terms:\n$$ \\text{Coupling} = \\sum_{i=1}^{3}\\sum_{j=4}^{6} |C'_{ij}| $$\nThis metric provides a scalar measure of the anisotropy induced by the misalignment between the material symmetries and the global observation frame. For an unrotated orthotropic material or any isotropic material, this sum is zero. For a misaligned anisotropic material, it will be non-zero. The calculation proceeds by first computing $\\mathbf{C}'$ for a given $\\mathbf{Q}$ and material properties, and then summing the specified elements.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the material rotation problem for the given test cases.\n    \"\"\"\n\n    def construct_ortho_compliance(E1, E2, E3, nu12, nu13, nu23, G12, G13, G23):\n        \"\"\"Constructs the 6x6 orthotropic compliance matrix S.\"\"\"\n        S = np.zeros((6, 6))\n        S[0, 0] = 1 / E1\n        S[1, 1] = 1 / E2\n        S[2, 2] = 1 / E3\n\n        S[0, 1] = S[1, 0] = -nu12 / E1\n        S[0, 2] = S[2, 0] = -nu13 / E1\n        S[1, 2] = S[2, 1] = -nu23 / E2\n        # The problem statement implies this symmetry by providing nu_ij/E_i = nu_ji/E_j\n        # e.g., nu21 = nu12 * E2/E1, so -nu21/E2 = -nu12/E1\n\n        S[3, 3] = 1 / G23\n        S[4, 4] = 1 / G13\n        S[5, 5] = 1 / G12\n        return S\n\n    def get_rotation_matrix_from_axis_angle(axis, angle_rad):\n        \"\"\"Creates a 3x3 rotation matrix using Rodrigues' formula.\"\"\"\n        axis = np.asarray(axis)\n        axis = axis / np.linalg.norm(axis)\n        K = np.array([[0, -axis[2], axis[1]],\n                      [axis[2], 0, -axis[0]],\n                      [-axis[1], axis[0], 0]])\n        R = np.eye(3) + np.sin(angle_rad) * K + (1 - np.cos(angle_rad)) * np.dot(K, K)\n        return R\n\n    def construct_bond_matrices(Q):\n        \"\"\"Constructs the Bond matrices B_sigma and B_epsilon from a rotation matrix Q.\"\"\"\n        B_sigma = np.zeros((6, 6))\n        B_epsilon = np.zeros((6, 6))\n        \n        # Voigt index to tensor (i, j) map (0-based)\n        # 1-based: 1->11, 2->22, 3->33, 4->23, 5->13, 6->12\n        voigt_map = [(0, 0), (1, 1), (2, 2), (1, 2), (0, 2), (0, 1)]\n\n        for I in range(6):\n            for J in range(6):\n                i, j = voigt_map[I]\n                k, l = voigt_map[J]\n\n                if I < 3:  # Transformed component is a normal stress/strain\n                    if J < 3:  # Original is normal\n                        B_sigma[I, J] = Q[i, k]**2\n                        B_epsilon[I, J] = Q[i, k]**2\n                    else:  # Original is shear\n                        B_sigma[I, J] = 2 * Q[i, k] * Q[i, l]\n                        B_epsilon[I, J] = Q[i, k] * Q[i, l]\n                else:  # Transformed component is a shear stress/strain\n                    if J < 3:  # Original is normal\n                        B_sigma[I, J] = Q[i, k] * Q[j, k]\n                        B_epsilon[I, J] = 2 * Q[i, k] * Q[j, k]\n                    else:  # Original is shear\n                        B_sigma[I, J] = Q[i, k] * Q[j, l] + Q[i, l] * Q[j, k]\n                        B_epsilon[I, J] = Q[i, k] * Q[j, l] + Q[i, l] * Q[j, k]\n        return B_sigma, B_epsilon\n\n    # Test cases defined in the problem statement.\n    # Each case is a dictionary of material properties and rotation parameters.\n    test_cases = [\n        # Case 1: Aligned orthotropy\n        {'mat': {'E1': 150, 'E2': 12, 'E3': 12, 'nu12': 0.25, 'nu13': 0.20, 'nu23': 0.30, \n                 'G12': 6, 'G13': 5, 'G23': 4}, \n         'rot': {'type': 'identity'}},\n        # Case 2: Planar misalignment\n        {'mat': {'E1': 150, 'E2': 12, 'E3': 12, 'nu12': 0.25, 'nu13': 0.20, 'nu23': 0.30, \n                 'G12': 6, 'G13': 5, 'G23': 4}, \n         'rot': {'type': 'axis_angle', 'axis': [0, 0, 1], 'angle_deg': 45}},\n        # Case 3: Isotropic limit\n        {'mat': {'E1': 100, 'E2': 100, 'E3': 100, 'nu12': 0.25, 'nu13': 0.25, 'nu23': 0.25, \n                 'G12': 40, 'G13': 40, 'G23': 40}, \n         'rot': {'type': 'axis_angle', 'axis': [1, 1, 1], 'angle_deg': 40}},\n        # Case 4: Composite misalignment\n        {'mat': {'E1': 50, 'E2': 10, 'E3': 5, 'nu12': 0.25, 'nu13': 0.20, 'nu23': 0.30, \n                 'G12': 8, 'G13': 6, 'G23': 4}, \n         'rot': {'type': 'composite', 'angles_deg': [30, 20, 10]}},\n    ]\n\n    results = []\n    for case in test_cases:\n        # 1. Construct orthotropic compliance and stiffness matrices\n        S = construct_ortho_compliance(**case['mat'])\n        C = np.linalg.inv(S)\n\n        # 2. Construct the rotation matrix Q\n        rot_params = case['rot']\n        if rot_params['type'] == 'identity':\n            Q = np.eye(3)\n        elif rot_params['type'] == 'axis_angle':\n            angle_rad = np.deg2rad(rot_params['angle_deg'])\n            Q = get_rotation_matrix_from_axis_angle(rot_params['axis'], angle_rad)\n        elif rot_params['type'] == 'composite':\n            angle_x_rad = np.deg2rad(rot_params['angles_deg'][0])\n            angle_y_rad = np.deg2rad(rot_params['angles_deg'][1])\n            angle_z_rad = np.deg2rad(rot_params['angles_deg'][2])\n            \n            Qx = get_rotation_matrix_from_axis_angle([1, 0, 0], angle_x_rad)\n            Qy = get_rotation_matrix_from_axis_angle([0, 1, 0], angle_y_rad)\n            Qz = get_rotation_matrix_from_axis_angle([0, 0, 1], angle_z_rad)\n            \n            # Rotations applied in order: 1-axis, then 2-axis, then 3-axis.\n            # Q = Q_z * Q_y * Q_x\n            Q = Qz @ Qy @ Qx\n\n        # 3. Construct Bond matrices\n        B_sigma, B_epsilon = construct_bond_matrices(Q)\n\n        # 4. Compute transformed stiffness matrix C'\n        # C_prime = B_sigma @ C @ inv(B_epsilon)\n        C_prime = B_sigma @ C @ np.linalg.inv(B_epsilon)\n\n        # 5. Quantify induced coupling\n        # Sum of absolute values of the upper-right 3x3 block (normal-shear coupling)\n        coupling_block = C_prime[0:3, 3:6]\n        total_coupling = np.sum(np.abs(coupling_block))\n        \n        results.append(total_coupling)\n\n    # Format the final output as a comma-separated list of floats rounded to 6 decimal places.\n    formatted_results = [f\"{res:.6f}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "3580567"}, {"introduction": "Beyond the basic requirement of a positive-definite stiffness tensor, a more stringent condition known as strong ellipticity governs a material's stability against localized failure modes like shear bands. This advanced practice delves into this concept by having you compute the acoustic tensor for an orthotropic material. By searching for directions that cause a loss of ellipticity, you will gain hands-on experience with a key predictive tool in computational failure mechanics [@problem_id:3580511].", "problem": "Consider an orthotropic, linearly elastic solid with material axes aligned with the Cartesian coordinate axes. Let $\\sigma_{ij}$ denote the Cauchy stress, $\\epsilon_{kl}$ the infinitesimal strain, and $C_{ijkl}$ the fourth-order stiffness tensor. Under the small-strain regime, the constitutive law is given by $\\,\\sigma_{ij} = C_{ijkl}\\,\\epsilon_{kl}\\,$. For incremental wave propagation and localization analysis, the Acoustic Tensor (AT) $\\,\\mathbb{Q}(\\mathbf{n})\\,$ associated with a unit normal direction $\\,\\mathbf{n}\\in\\mathbb{R}^3\\,$ is defined by the contraction $\\,Q_{ik}(\\mathbf{n}) = C_{ijkl}\\,n_j\\,n_l\\,$. Strong ellipticity holds if and only if $\\,\\mathbb{Q}(\\mathbf{n})\\,$ is positive definite for every unit vector $\\,\\mathbf{n}\\,$, equivalently if the Legendre–Hadamard condition $\\,a_i\\,C_{ijkl}\\,n_j\\,n_l\\,a_k > 0\\,$ holds for all nonzero $\\,\\mathbf{a},\\mathbf{n}\\in\\mathbb{R}^3\\,$. Loss of strong ellipticity (onset of localization) is detected when at least one eigenvalue of $\\,\\mathbb{Q}(\\mathbf{n})\\,$ becomes non-positive for some $\\,\\mathbf{n}\\,$.\n\nOrthotropic stiffness may be specified via engineering constants: Young’s moduli $\\,E_1,E_2,E_3\\,$, Poisson’s ratios $\\,\\nu_{12},\\nu_{13},\\nu_{23}\\,$ (with reciprocal relations $\\,\\nu_{21}=\\nu_{12}\\,E_2/E_1\\,$, $\\,\\nu_{31}=\\nu_{13}\\,E_3/E_1\\,$, $\\,\\nu_{32}=\\nu_{23}\\,E_3/E_2\\,$), and shear moduli $\\,G_{12},G_{13},G_{23}\\,$. The $\\,6\\times 6\\,$ compliance matrix $\\,\\mathbf{S}\\,$ in Voigt notation has diagonal entries $\\,S_{11}=1/E_1\\,$, $\\,S_{22}=1/E_2\\,$, $\\,S_{33}=1/E_3\\,$, $\\,S_{44}=1/G_{23}\\,$, $\\,S_{55}=1/G_{13}\\,$, $\\,S_{66}=1/G_{12}\\,$ and symmetric off-diagonal entries $\\,S_{12}=-\\nu_{12}/E_1\\,$, $\\,S_{13}=-\\nu_{13}/E_1\\,$, and $\\,S_{23}=-\\nu_{23}/E_2\\,$. The stiffness in Voigt notation is $\\,\\mathbf{C}^{\\mathrm{V}}=\\mathbf{S}^{-1}\\,$. You must base your derivation and computation on these definitions without introducing unvalidated simplifications.\n\nYour task is to write a complete, runnable program that:\n- Constructs the orthotropic compliance $\\,\\mathbf{S}\\,$ from the given engineering constants, enforces reciprocal relations for Poisson’s ratios, and computes the Voigt stiffness $\\,\\mathbf{C}^{\\mathrm{V}}=\\mathbf{S}^{-1}\\,$.\n- From $\\,\\mathbf{C}^{\\mathrm{V}}\\,$ and the shear moduli $\\,G_{12},G_{13},G_{23}\\,$, computes the Acoustic Tensor $\\,\\mathbb{Q}(\\mathbf{n})\\,$ for any unit vector $\\,\\mathbf{n}=[n_1,n_2,n_3]^\\top\\,$ via the fundamental contraction $\\,Q_{ik}(\\mathbf{n}) = C_{ijkl}\\,n_j\\,n_l\\,$ for orthotropy aligned with the axes, without assuming any isotropic shortcut.\n- Samples directions $\\,\\mathbf{n}\\,$ on the unit sphere using spherical angles $\\,\\theta\\in[0,\\pi]\\,$ and $\\,\\phi\\in[0,2\\pi)\\,$ in radians with a uniform grid of $\\,N_\\theta=41\\,$ and $\\,N_\\phi=81\\,$, using $\\,n_1=\\sin\\theta\\cos\\phi\\,$, $\\,n_2=\\sin\\theta\\sin\\phi\\,$, $\\,n_3=\\cos\\theta\\,$.\n- For each test case below, computes the minimum eigenvalue of $\\,\\mathbb{Q}(\\mathbf{n})\\,$ over the sampled directions, identifies the orientation $\\,\\mathbf{n}\\,$ that attains this minimum, and flags loss of strong ellipticity if the minimum eigenvalue is non-positive.\n\nScientific realism: All moduli are specified in gigapascal (GPa). In advanced computational solid mechanics, the effective tangent stiffness of anisotropic media under softening may include non-positive shear moduli; you must therefore evaluate strong ellipticity strictly from the Acoustic Tensor eigenvalues without discarding such cases.\n\nAngles: All angles must be treated in radians.\n\nUnits: All stiffness entries and eigenvalues must be expressed in gigapascal (GPa). Your program must report eigenvalues in gigapascal (GPa).\n\nTest suite parameters (each tuple lists $\\,E_1,E_2,E_3\\,$ in GPa; $\\,\\nu_{12},\\nu_{13},\\nu_{23}\\,$ dimensionless; and $\\,G_{12},G_{13},G_{23}\\,$ in GPa):\n- Test $\\,1\\,$ (happy path, strongly elliptic): $$(E_1,E_2,E_3)=(140,70,50),\\quad (\\nu_{12},\\nu_{13},\\nu_{23})=(0.25,0.20,0.22),\\quad (G_{12},G_{13},G_{23})=(50,35,25).$$\n- Test $\\,2\\,$ (near-boundary in-plane shear softening): $$(E_1,E_2,E_3)=(140,70,50),\\quad (\\nu_{12},\\nu_{13},\\nu_{23})=(0.25,0.20,0.22),\\quad (G_{12},G_{13},G_{23})=(1.0,35,25).$$\n- Test $\\,3\\,$ (edge case with softening tangent in plane $\\,1$–$\\,2$): $$(E_1,E_2,E_3)=(20,180,160),\\quad (\\nu_{12},\\nu_{13},\\nu_{23})=(0.15,0.10,0.08),\\quad (G_{12},G_{13},G_{23})=(-0.5,60,60).$$\n\nYour program must produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each test case result is a list of the form $\\,[$min\\_eigenvalue\\_in\\_GPa$,\\,n_x,\\,n_y,\\,n_z,$loss\\_boolean$]\\,$, in the same order as the test suite above. For example, the final output must look like $\\,[[\\cdots],[\\cdots],[\\cdots]]\\,$ with floats and booleans only.\n\nAnswer all eigenvalues in gigapascal (GPa). Angles must be handled in radians. The final program must be entirely self-contained and require no input.", "solution": "The problem is assessed to be valid. It is scientifically grounded in the principles of continuum mechanics, specifically the theory of linear elasticity and material stability. The problem is well-posed, objective, and contains a complete and consistent set of definitions and data required for a computational solution. The inclusion of a material with a negative shear modulus is a valid scenario in the context of incremental analysis of material softening, which is precisely where the loss of strong ellipticity and localization phenomena are studied.\n\nThe solution proceeds by implementing the specified computational procedure. The core of the task is to determine the state of strong ellipticity for a given orthotropic material by finding the minimum eigenvalue of its acoustic tensor, $\\mathbb{Q}(\\mathbf{n})$, over all possible spatial directions $\\mathbf{n}$.\n\nFirst, the constitutive relationship for a linearly elastic material is given by the generalized Hooke's Law, $\\sigma_{ij} = C_{ijkl}\\,\\epsilon_{kl}$, where $\\sigma_{ij}$ is the Cauchy stress tensor, $\\epsilon_{kl}$ is the infinitesimal strain tensor, and $C_{ijkl}$ is the fourth-order elasticity or stiffness tensor. For an orthotropic material with its symmetry axes aligned with the Cartesian coordinate axes, the stiffness tensor has $9$ independent non-zero components. It is convenient to represent this relationship using the $6 \\times 6$ stiffness matrix $\\mathbf{C}^\\mathrm{V}$ in Voigt notation.\n\nThe computational steps are as follows:\n\n1.  **Construct the Compliance Matrix $\\mathbf{S}$**: The material is defined by its engineering constants: Young's moduli $E_1, E_2, E_3$; Poisson's ratios $\\nu_{12}, \\nu_{13}, \\nu_{23}$; and shear moduli $G_{12}, G_{13}, G_{23}$. The $6 \\times 6$ compliance matrix $\\mathbf{S}$ is constructed first. Its non-zero elements are defined as:\n    - Diagonal elements: $S_{11}=1/E_1, S_{22}=1/E_2, S_{33}=1/E_3, S_{44}=1/G_{23}, S_{55}=1/G_{13}, S_{66}=1/G_{12}$.\n    - Off-diagonal elements: $S_{12}=S_{21}=-\\nu_{12}/E_1$, $S_{13}=S_{31}=-\\nu_{13}/E_1$, $S_{23}=S_{32}=-\\nu_{23}/E_2$.\n    The symmetry of the compliance matrix, e.g., $S_{12}=S_{21}$, is guaranteed by the Maxwell reciprocal relations, such as $\\nu_{21}/E_2 = \\nu_{12}/E_1$. The full matrix is:\n    $$\n    \\mathbf{S} = \\begin{pmatrix}\n    1/E_1 & -\\nu_{12}/E_1 & -\\nu_{13}/E_1 & 0 & 0 & 0 \\\\\n    -\\nu_{12}/E_1 & 1/E_2 & -\\nu_{23}/E_2 & 0 & 0 & 0 \\\\\n    -\\nu_{13}/E_1 & -\\nu_{23}/E_2 & 1/E_3 & 0 & 0 & 0 \\\\\n    0 & 0 & 0 & 1/G_{23} & 0 & 0 \\\\\n    0 & 0 & 0 & 0 & 1/G_{13} & 0 \\\\\n    0 & 0 & 0 & 0 & 0 & 1/G_{12}\n    \\end{pmatrix}\n    $$\n\n2.  **Compute the Stiffness Matrix $\\mathbf{C}^\\mathrm{V}$**: The stiffness matrix in Voigt notation, $\\mathbf{C}^\\mathrm{V}$, is the inverse of the compliance matrix: $\\mathbf{C}^\\mathrm{V} = \\mathbf{S}^{-1}$. This inversion is carried out numerically. Due to the block-diagonal structure of $\\mathbf{S}$ for an orthotropic material, the corresponding stiffness matrix $\\mathbf{C}^\\mathrm{V}$ is also block-diagonal, with $C^\\mathrm{V}_{44} = G_{23}$, $C^\\mathrm{V}_{55} = G_{13}$, and $C^\\mathrm{V}_{66} = G_{12}$. The upper-left $3 \\times 3$ block of $\\mathbf{C}^\\mathrm{V}$ contains the coupled stiffness components $C^\\mathrm{V}_{11}, C^\\mathrm{V}_{12}, \\dots, C^\\mathrm{V}_{33}$.\n\n3.  **Construct the Acoustic Tensor $\\mathbb{Q}(\\mathbf{n})$**: The acoustic tensor $\\mathbb{Q}(\\mathbf{n})$ is a $3 \\times 3$ matrix whose components $Q_{ik}$ are defined by the contraction $Q_{ik}(\\mathbf{n}) = C_{ijkl}\\,n_j\\,n_l$, where $\\mathbf{n}=[n_1, n_2, n_3]^\\top$ is a unit direction vector. For an orthotropic material, the components of $\\mathbb{Q}(\\mathbf{n})$ can be expressed in terms of the Voigt stiffness constants and the components of $\\mathbf{n}$. The derivation, which involves mapping Voigt indices to fourth-order tensor indices (e.g., $C^\\mathrm{V}_{11} \\to C_{1111}$, $C^\\mathrm{V}_{66} \\to C_{1212}$) and performing the summation, yields the following symmetric matrix:\n    $$\n    \\mathbb{Q}(\\mathbf{n}) = \\begin{pmatrix}\n    Q_{11} & Q_{12} & Q_{13} \\\\\n    Q_{12} & Q_{22} & Q_{23} \\\\\n    Q_{13} & Q_{23} & Q_{33}\n    \\end{pmatrix}\n    $$\n    where the components are:\n    - $Q_{11} = C^\\mathrm{V}_{11} n_1^2 + C^\\mathrm{V}_{66} n_2^2 + C^\\mathrm{V}_{55} n_3^2$\n    - $Q_{22} = C^\\mathrm{V}_{66} n_1^2 + C^\\mathrm{V}_{22} n_2^2 + C^\\mathrm{V}_{44} n_3^2$\n    - $Q_{33} = C^\\mathrmV_{55} n_1^2 + C^\\mathrmV_{44} n_2^2 + C^\\mathrmV_{33} n_3^2$\n    - $Q_{12} = (C^\\mathrmV_{12} + C^\\mathrmV_{66}) n_1 n_2$\n    - $Q_{13} = (C^\\mathrmV_{13} + C^\\mathrmV_{55}) n_1 n_3$\n    - $Q_{23} = (C^\\mathrmV_{23} + C^\\mathrmV_{44}) n_2 n_3$\n\n4.  **Numerical Search for Minimum Eigenvalue**: The strong ellipticity condition requires $\\mathbb{Q}(\\mathbf{n})$ to be positive definite for all unit vectors $\\mathbf{n}$. This is equivalent to checking if the minimum eigenvalue of $\\mathbb{Q}(\\mathbf{n})$ is positive for all $\\mathbf{n}$. To find the global minimum eigenvalue, a numerical search is performed over the surface of the unit sphere. The surface is discretized using a grid of spherical coordinates $\\theta \\in [0, \\pi]$ and $\\phi \\in [0, 2\\pi)$. The problem specifies a grid of $N_\\theta = 41$ points for the polar angle and $N_\\phi = 81$ points for the azimuthal angle. For each direction $\\mathbf{n}(\\theta, \\phi) = (\\sin\\theta\\cos\\phi, \\sin\\theta\\sin\\phi, \\cos\\theta)^\\top$, the acoustic tensor $\\mathbb{Q}(\\mathbf{n})$ is constructed and its eigenvalues are computed. Since $\\mathbb{Q}(\\mathbf{n})$ is real and symmetric, its eigenvalues are real. The smallest eigenvalue over the entire grid of directions is identified.\n\n5.  **Check for Loss of Strong Ellipticity**: The material loses strong ellipticity if the minimum eigenvalue found is non-positive, i.e., $\\lambda_{\\min} \\le 0$. This condition signals the possibility of material instability, such as the formation of shear bands. The program will flag this condition with a boolean value.\n\nThe final program implements this entire procedure for each of the three test cases, reporting the minimum eigenvalue, the direction vector $\\mathbf{n}$ at which it occurs, and a boolean flag indicating the loss of strong ellipticity.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the minimum eigenvalue of the acoustic tensor for given orthotropic\n    materials to check for loss of strong ellipticity.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each tuple contains: (E1, E2, E3), (nu12, nu13, nu23), (G12, G13, G23)\n    test_cases = [\n        # Test 1 (happy path, strongly elliptic)\n        ((140.0, 70.0, 50.0), (0.25, 0.20, 0.22), (50.0, 35.0, 25.0)),\n        # Test 2 (near-boundary in-plane shear softening)\n        ((140.0, 70.0, 50.0), (0.25, 0.20, 0.22), (1.0, 35.0, 25.0)),\n        # Test 3 (edge case with softening tangent in plane 1–2)\n        ((20.0, 180.0, 160.0), (0.15, 0.10, 0.08), (-0.5, 60.0, 60.0)),\n    ]\n\n    # Sampling grid parameters for the unit sphere\n    N_theta = 41\n    N_phi = 81\n\n    final_results = []\n\n    for E_vals, nu_vals, G_vals in test_cases:\n        E1, E2, E3 = E_vals\n        nu12, nu13, nu23 = nu_vals\n        G12, G13, G23 = G_vals\n\n        # 1. Construct the 6x6 compliance matrix S in Voigt notation.\n        S = np.zeros((6, 6))\n        \n        # Diagonal entries\n        S[0, 0] = 1.0 / E1\n        S[1, 1] = 1.0 / E2\n        S[2, 2] = 1.0 / E3\n        S[3, 3] = 1.0 / G23  # Corresponds to the 2-3 plane\n        S[4, 4] = 1.0 / G13  # Corresponds to the 1-3 plane\n        S[5, 5] = 1.0 / G12  # Corresponds to the 1-2 plane\n        \n        # Off-diagonal entries (upper-left 3x3 block)\n        S[0, 1] = S[1, 0] = -nu12 / E1\n        S[0, 2] = S[2, 0] = -nu13 / E1\n        S[1, 2] = S[2, 1] = -nu23 / E2\n\n        # 2. Compute the stiffness matrix C_V by inverting S.\n        C_V = np.linalg.inv(S)\n        C11, C22, C33 = C_V[0, 0], C_V[1, 1], C_V[2, 2]\n        C12, C13, C23 = C_V[0, 1], C_V[0, 2], C_V[1, 2]\n        C44, C55, C66 = C_V[3, 3], C_V[4, 4], C_V[5, 5]\n\n        # 3. Search for the minimum eigenvalue of the acoustic tensor over the unit sphere.\n        min_global_eig = float('inf')\n        best_n_vector = None\n\n        thetas = np.linspace(0, np.pi, N_theta)\n        phis = np.linspace(0, 2 * np.pi, N_phi, endpoint=False)\n\n        for theta in thetas:\n            for phi in phis:\n                # Components of the unit direction vector n\n                n1 = np.sin(theta) * np.cos(phi)\n                n2 = np.sin(theta) * np.sin(phi)\n                n3 = np.cos(theta)\n\n                # Construct the acoustic tensor Q for the direction n\n                Q = np.zeros((3, 3))\n                \n                Q[0, 0] = C11 * n1**2 + C66 * n2**2 + C55 * n3**2\n                Q[1, 1] = C66 * n1**2 + C22 * n2**2 + C44 * n3**2\n                Q[2, 2] = C55 * n1**2 + C44 * n2**2 + C33 * n3**2\n                \n                Q[0, 1] = Q[1, 0] = (C12 + C66) * n1 * n2\n                Q[0, 2] = Q[2, 0] = (C13 + C55) * n1 * n3\n                Q[1, 2] = Q[2, 1] = (C23 + C44) * n2 * n3\n                \n                # Compute eigenvalues of the symmetric matrix Q. eigvalsh is efficient.\n                eigenvalues = np.linalg.eigvalsh(Q)\n                min_local_eig = eigenvalues[0]  # eigvalsh returns sorted eigenvalues\n\n                if min_local_eig < min_global_eig:\n                    min_global_eig = min_local_eig\n                    best_n_vector = [n1, n2, n3]\n\n        # 4. Check for loss of strong ellipticity.\n        loss_of_ellipticity = min_global_eig <= 0.0\n\n        # Store the results for the current test case.\n        case_result = [min_global_eig, best_n_vector[0], best_n_vector[1], best_n_vector[2], loss_of_ellipticity]\n        final_results.append(case_result)\n\n    # Final print statement in the exact required format.\n    # The str() function converts the inner lists to their string representation,\n    # and join(',') combines them into a single string.\n    print(f\"[{','.join(map(str, final_results))}]\")\n\nsolve()\n```", "id": "3580511"}]}