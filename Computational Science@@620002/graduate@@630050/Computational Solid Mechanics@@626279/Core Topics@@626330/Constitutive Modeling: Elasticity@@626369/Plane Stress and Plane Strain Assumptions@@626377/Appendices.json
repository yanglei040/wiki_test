{"hands_on_practices": [{"introduction": "Understanding the practical difference between plane stress and plane strain begins with quantifying their effect on a material's apparent stiffness. This foundational exercise asks you to derive the stress response to a prescribed in-plane strain from first principles, highlighting how the out-of-plane constraint inherent in the plane strain assumption makes a material effectively stiffer. By completing this practice [@problem_id:3588356], you will gain a tangible feel for why the choice between these two idealizations is a critical modeling decision.", "problem": "Consider a homogeneous, isotropic, linearly elastic solid characterized by Young’s modulus $E$ and Poisson’s ratio $\\nu$. A material point lies in a wide plate such that its in-plane strain state is prescribed as $\\varepsilon_{xx}=\\varepsilon_{0}$, $\\varepsilon_{yy}=0$, and $\\gamma_{xy}=0$. Depending on the structural idealization, the out-of-plane constraint differs:\n\n- Under the plane stress idealization, the through-thickness normal stress satisfies $\\sigma_{zz}=0$.\n- Under the plane strain idealization, the through-thickness normal strain satisfies $\\varepsilon_{zz}=0$.\n\nStarting from the three-dimensional linear elastic constitutive law in terms of the Lamé parameters, without invoking any pre-reduced two-dimensional formulas, derive the resulting $\\sigma_{xx}$ for each idealization in terms of $E$, $\\nu$, and $\\varepsilon_{0}$. Then evaluate the two numerical values for a material with $E=210\\,\\mathrm{GPa}$, $\\nu=0.30$, and $\\varepsilon_{0}=1.0\\times 10^{-3}$. Express your final numerical values in gigapascals (GPa) and round your answer to four significant figures. Briefly interpret the physical reason for any difference between the two results.", "solution": "The problem requires the derivation of the normal stress component $\\sigma_{xx}$ under both plane stress and plane strain idealizations, starting from the three-dimensional linear elastic constitutive law expressed in terms of Lamé parameters.\n\nThe constitutive relation for a homogeneous, isotropic, linearly elastic material relating the Cauchy stress tensor $\\sigma_{ij}$ to the infinitesimal strain tensor $\\varepsilon_{ij}$ is given by:\n$$ \\sigma_{ij} = \\lambda \\varepsilon_{kk} \\delta_{ij} + 2\\mu \\varepsilon_{ij} $$\nwhere $\\lambda$ and $\\mu$ are the Lamé parameters, $\\delta_{ij}$ is the Kronecker delta, and $\\varepsilon_{kk} = \\varepsilon_{xx} + \\varepsilon_{yy} + \\varepsilon_{zz}$ is the volumetric strain (trace of the strain tensor). The Lamé parameters are related to Young’s modulus $E$ and Poisson’s ratio $\\nu$ by:\n$$ \\lambda = \\frac{E\\nu}{(1+\\nu)(1-2\\nu)} $$\n$$ \\mu = G = \\frac{E}{2(1+\\nu)} $$\nThe given in-plane strain state is $\\varepsilon_{xx}=\\varepsilon_0$, $\\varepsilon_{yy}=0$, and $\\gamma_{xy}=0$. Since the engineering shear strain $\\gamma_{xy} = 2\\varepsilon_{xy}$, we have $\\varepsilon_{xy}=0$. The stress-strain relations for the normal components expand to:\n$$ \\sigma_{xx} = \\lambda(\\varepsilon_{xx} + \\varepsilon_{yy} + \\varepsilon_{zz}) + 2\\mu \\varepsilon_{xx} $$\n$$ \\sigma_{yy} = \\lambda(\\varepsilon_{xx} + \\varepsilon_{yy} + \\varepsilon_{zz}) + 2\\mu \\varepsilon_{yy} $$\n$$ \\sigma_{zz} = \\lambda(\\varepsilon_{xx} + \\varepsilon_{yy} + \\varepsilon_{zz}) + 2\\mu \\varepsilon_{zz} $$\nSubstituting the known strain components $\\varepsilon_{xx}=\\varepsilon_0$ and $\\varepsilon_{yy}=0$:\n$$ \\sigma_{xx} = \\lambda(\\varepsilon_0 + \\varepsilon_{zz}) + 2\\mu \\varepsilon_0 $$\n$$ \\sigma_{yy} = \\lambda(\\varepsilon_0 + \\varepsilon_{zz}) $$\n$$ \\sigma_{zz} = \\lambda(\\varepsilon_0 + \\varepsilon_{zz}) + 2\\mu \\varepsilon_{zz} = (\\lambda+2\\mu)\\varepsilon_{zz} + \\lambda\\varepsilon_0 $$\n\nWe will now analyze each idealization separately.\n\n**1. Plane Stress Idealization ($\\sigma_{zz}=0$)**\n\nUnder the plane stress condition, we impose $\\sigma_{zz}=0$. Using the equation for $\\sigma_{zz}$:\n$$ 0 = (\\lambda+2\\mu)\\varepsilon_{zz} + \\lambda\\varepsilon_0 $$\nFrom this, we solve for the out-of-plane strain $\\varepsilon_{zz}$:\n$$ \\varepsilon_{zz} = -\\frac{\\lambda}{\\lambda+2\\mu}\\varepsilon_0 $$\nNow, we substitute this expression for $\\varepsilon_{zz}$ into the equation for $\\sigma_{xx}$:\n$$ \\sigma_{xx} = \\lambda\\left(\\varepsilon_0 - \\frac{\\lambda}{\\lambda+2\\mu}\\varepsilon_0\\right) + 2\\mu \\varepsilon_0 $$\n$$ \\sigma_{xx} = \\varepsilon_0 \\left[ \\lambda\\left(1 - \\frac{\\lambda}{\\lambda+2\\mu}\\right) + 2\\mu \\right] = \\varepsilon_0 \\left[ \\lambda\\left(\\frac{\\lambda+2\\mu-\\lambda}{\\lambda+2\\mu}\\right) + 2\\mu \\right] $$\n$$ \\sigma_{xx} = \\varepsilon_0 \\left[ \\frac{2\\mu\\lambda}{\\lambda+2\\mu} + 2\\mu \\right] = \\varepsilon_0 \\cdot 2\\mu \\left[ \\frac{\\lambda}{\\lambda+2\\mu} + 1 \\right] = \\varepsilon_0 \\cdot 2\\mu \\left[ \\frac{2\\lambda+2\\mu}{\\lambda+2\\mu} \\right]$$\n$$ \\sigma_{xx} = \\varepsilon_0 \\frac{4\\mu(\\lambda+\\mu)}{\\lambda+2\\mu} $$\nTo express this in terms of $E$ and $\\nu$, we substitute the relations for $\\lambda$ and $\\mu$. We can simplify the combinations of parameters first:\n$$ \\lambda+2\\mu = \\frac{E\\nu}{(1+\\nu)(1-2\\nu)} + \\frac{E}{1+\\nu} = \\frac{E}{1+\\nu}\\left(\\frac{\\nu}{1-2\\nu}+1\\right) = \\frac{E(1-\\nu)}{(1+\\nu)(1-2\\nu)} $$\nThe ratio $\\frac{\\lambda}{\\lambda+2\\mu}$ then becomes $\\frac{\\nu}{1-\\nu}$, which is a useful identity. Let's use it to simplify the expression for $\\sigma_{xx}$ in a more direct way:\n$$ \\sigma_{xx} = \\lambda(\\varepsilon_0 + \\varepsilon_{zz}) + 2\\mu\\varepsilon_0 = \\lambda\\left(\\varepsilon_0 - \\frac{\\nu}{1-\\nu}\\varepsilon_0\\right) + 2\\mu\\varepsilon_0 $$\n$$ \\sigma_{xx} = \\varepsilon_0 \\left[ \\lambda\\left(\\frac{1-\\nu-\\nu}{1-\\nu}\\right) + 2\\mu \\right] = \\varepsilon_0 \\left[ \\lambda\\frac{1-2\\nu}{1-\\nu} + 2\\mu \\right] $$\nSubstituting $\\lambda = \\frac{E\\nu}{(1+\\nu)(1-2\\nu)}$ and $\\mu = \\frac{E}{2(1+\\nu)}$:\n$$ \\sigma_{xx} = \\varepsilon_0 \\left[ \\frac{E\\nu}{(1+\\nu)(1-2\\nu)} \\frac{1-2\\nu}{1-\\nu} + \\frac{E}{1+\\nu} \\right] $$\n$$ \\sigma_{xx} = \\varepsilon_0 \\left[ \\frac{E\\nu}{(1+\\nu)(1-\\nu)} + \\frac{E}{1+\\nu} \\right] = \\frac{E\\varepsilon_0}{1+\\nu} \\left[ \\frac{\\nu}{1-\\nu} + 1 \\right] $$\n$$ \\sigma_{xx} = \\frac{E\\varepsilon_0}{1+\\nu} \\left[ \\frac{\\nu+1-\\nu}{1-\\nu} \\right] = \\frac{E\\varepsilon_0}{(1+\\nu)(1-\\nu)} $$\nThus, for plane stress:\n$$ \\sigma_{xx}^{\\text{p-stress}} = \\frac{E}{1-\\nu^2}\\varepsilon_0 $$\n\n**2. Plane Strain Idealization ($\\varepsilon_{zz}=0$)**\n\nUnder the plane strain condition, $\\varepsilon_{zz}=0$ is imposed directly. The volumetric strain is $\\varepsilon_{kk} = \\varepsilon_{xx} + \\varepsilon_{yy} + \\varepsilon_{zz} = \\varepsilon_0 + 0 + 0 = \\varepsilon_0$.\nThe derivation for $\\sigma_{xx}$ is very direct. We use the general equation for $\\sigma_{xx}$ and substitute the known strains:\n$$ \\sigma_{xx} = \\lambda(\\varepsilon_0 + 0 + 0) + 2\\mu \\varepsilon_0 = (\\lambda+2\\mu)\\varepsilon_0 $$\nUsing the expression for $\\lambda+2\\mu$ in terms of $E$ and $\\nu$ derived previously:\n$$ \\lambda+2\\mu = \\frac{E(1-\\nu)}{(1+\\nu)(1-2\\nu)} $$\nThus, for plane strain:\n$$ \\sigma_{xx}^{\\text{p-strain}} = \\frac{E(1-\\nu)}{(1+\\nu)(1-2\\nu)}\\varepsilon_0 $$\n\n**3. Numerical Evaluation**\n\nGiven $E=210\\,\\mathrm{GPa}$, $\\nu=0.30$, and $\\varepsilon_{0}=1.0\\times 10^{-3}$.\n\nFor plane stress:\n$$ \\sigma_{xx}^{\\text{p-stress}} = \\frac{210\\,\\mathrm{GPa}}{1-(0.30)^2} \\times (1.0 \\times 10^{-3}) = \\frac{210}{1-0.09} \\times 10^{-3}\\,\\mathrm{GPa} = \\frac{210}{0.91} \\times 10^{-3}\\,\\mathrm{GPa} $$\n$$ \\sigma_{xx}^{\\text{p-stress}} \\approx 230.7692... \\times 10^{-3}\\,\\mathrm{GPa} = 0.2307692...\\,\\mathrm{GPa} $$\nRounding to four significant figures, we get $0.2308\\,\\mathrm{GPa}$.\n\nFor plane strain:\n$$ \\sigma_{xx}^{\\text{p-strain}} = \\frac{210\\,\\mathrm{GPa} \\times (1-0.30)}{(1+0.30)(1-2 \\times 0.30)} \\times (1.0 \\times 10^{-3}) = \\frac{210 \\times 0.70}{1.30 \\times 0.40} \\times 10^{-3}\\,\\mathrm{GPa} $$\n$$ \\sigma_{xx}^{\\text{p-strain}} = \\frac{147}{0.52} \\times 10^{-3}\\,\\mathrm{GPa} \\approx 282.6923... \\times 10^{-3}\\,\\mathrm{GPa} = 0.2826923...\\,\\mathrm{GPa} $$\nRounding to four significant figures, we get $0.2827\\,\\mathrm{GPa}$.\n\n**4. Physical Interpretation**\n\nThe calculated stress for plane strain ($\\approx 0.2827\\,\\mathrm{GPa}$) is significantly higher than for plane stress ($\\approx 0.2308\\,\\mathrm{GPa}$). This difference arises from the out-of-plane ($z$-direction) constraint.\nIn both cases, stretching the material in the $x$-direction ($\\varepsilon_{xx} = \\varepsilon_0 > 0$) would naturally cause it to contract in the transverse directions ($y$ and $z$) due to the Poisson effect.\n- In the **plane stress** case, the material is thin and free to deform through its thickness ($\\sigma_{zz}=0$). It can and does contract in the $z$-direction, which partially relieves internal stresses. In this case, $\\varepsilon_{zz} = -\\frac{\\nu}{1-\\nu}\\varepsilon_0 \\approx -0.43\\varepsilon_0$, a significant contraction.\n- In the **plane strain** case, the material is constrained from deforming in the $z$-direction ($\\varepsilon_{zz}=0$). This constraint prevents the natural Poisson's contraction. To enforce this zero strain, a tensile stress $\\sigma_{zz}$ must be developed within the material ($\\sigma_{zz} = \\lambda \\varepsilon_0 > 0$). This constraint makes the material effectively stiffer in its response to the applied strain $\\varepsilon_{xx}$. A greater stress $\\sigma_{xx}$ is required to achieve the same strain $\\varepsilon_0$ because the material cannot freely deform in the thickness direction.", "answer": "$$\n\\boxed{\\begin{pmatrix} 0.2308 & 0.2827 \\end{pmatrix}}\n$$", "id": "3588356"}, {"introduction": "While plane stress and plane strain are 2D idealizations, the underlying physics remains three-dimensional, a fact with profound consequences for stress analysis. This practice explores how the \"hidden\" out-of-plane stress, $\\sigma_{zz}$, that arises to enforce the plane strain condition affects stress invariants, which are fundamental to theories of material yield and failure. By correctly calculating the second deviatoric invariant, $J_2$ [@problem_id:3588334], you will learn to avoid the common pitfall of treating a plane strain problem as a true 2D stress state.", "problem": "A flat body of isotropic, linearly elastic material is subjected to an in-plane stress state that is uniform through the thickness. The nonzero Cartesian stress components are given as $\\sigma_{xx} = 120\\,\\text{MPa}$, $\\sigma_{yy} = -30\\,\\text{MPa}$, and $\\sigma_{xy} = 45\\,\\text{MPa}$, with $\\sigma_{xz} = \\sigma_{yz} = 0$. The material has Poisson’s ratio $\\nu = 0.28$. Consider two modeling assumptions for the same in-plane state: (i) plane stress, and (ii) plane strain.\n\nStarting from the fundamental definitions of the Cauchy stress tensor decomposition into hydrostatic and deviatoric parts and from three-dimensional linear elasticity (generalized Hooke’s law), do the following:\n\n- Explain why the in-plane invariant $I_{1}^{\\text{in-plane}} = \\sigma_{xx} + \\sigma_{yy}$ differs in interpretation from the true first invariant $I_{1} = \\sigma_{xx} + \\sigma_{yy} + \\sigma_{zz}$ under plane strain but coincides under plane stress, and identify the role of the “hidden” $\\sigma_{zz}$.\n- Using the deviatoric stress definition $s_{ij} = \\sigma_{ij} - \\tfrac{1}{3}\\,\\sigma_{kk}\\,\\delta_{ij}$ and the second invariant $J_{2} = \\tfrac{1}{2}\\,s_{ij}\\,s_{ij}$, compute the correct value of $J_{2}$ for the given stress state under both assumptions: (i) plane stress and (ii) plane strain.\n\nExpress both $J_{2}$ values in $\\text{MPa}^{2}$ and round each to four significant figures. Provide the two values in the order (plane stress, plane strain).", "solution": "The problem statement is evaluated as valid. It is scientifically grounded in the principles of linear elasticity, well-posed with a unique solution, and formally complete and consistent. All necessary data ($\\sigma_{xx}$, $\\sigma_{yy}$, $\\sigma_{xy}$, $\\nu$) and definitions ($I_1$, $J_2$, $s_{ij}$) are provided. We may proceed with the solution.\n\nThe problem requires an analysis of a given in-plane stress state under two distinct assumptions: plane stress and plane strain. We will first address the conceptual part concerning the stress invariants and then perform the numerical calculation of the second invariant of the deviatoric stress, $J_2$.\n\nThe stress tensor $\\boldsymbol{\\sigma}$ in Cartesian coordinates for the given problem is:\n$$\n\\boldsymbol{\\sigma} = \\begin{pmatrix} \\sigma_{xx} & \\sigma_{xy} & \\sigma_{xz} \\\\ \\sigma_{yx} & \\sigma_{yy} & \\sigma_{yz} \\\\ \\sigma_{zx} & \\sigma_{zy} & \\sigma_{zz} \\end{pmatrix} = \\begin{pmatrix} 120\\,\\text{MPa} & 45\\,\\text{MPa} & 0 \\\\ 45\\,\\text{MPa} & -30\\,\\text{MPa} & 0 \\\\ 0 & 0 & \\sigma_{zz} \\end{pmatrix}\n$$\nThe value of $\\sigma_{zz}$ depends on the modeling assumption.\n\n**Part 1: Interpretation of Stress Invariants**\n\nThe first invariant of the Cauchy stress tensor, $I_1 = \\text{tr}(\\boldsymbol{\\sigma})$, is defined as the sum of the diagonal components:\n$$\nI_1 = \\sigma_{kk} = \\sigma_{xx} + \\sigma_{yy} + \\sigma_{zz}\n$$\nThis invariant is directly related to the hydrostatic (or mean) stress, $\\sigma_m$, by $\\sigma_m = \\frac{1}{3} I_1$. Hydrostatic stress is responsible for volume changes (dilatation) in an isotropic elastic material. The \"in-plane\" invariant is given as $I_{1}^{\\text{in-plane}} = \\sigma_{xx} + \\sigma_{yy}$.\n\n**Case (i): Plane Stress Assumption**\nThe plane stress assumption is applicable to thin bodies loaded in their plane. It is defined by the condition that the stress components acting perpendicular to the plane are zero. For a body in the $x-y$ plane, this means:\n$$\n\\sigma_{zz} = \\sigma_{xz} = \\sigma_{yz} = 0\n$$\nThe given problem already states $\\sigma_{xz} = \\sigma_{yz} = 0$, so the key constraint is $\\sigma_{zz} = 0$.\nUnder this assumption, the true first invariant $I_1$ becomes:\n$$\nI_1 = \\sigma_{xx} + \\sigma_{yy} + 0 = \\sigma_{xx} + \\sigma_{yy}\n$$\nIn this case, the true first invariant $I_1$ is identical to the in-plane invariant $I_{1}^{\\text{in-plane}}$. They represent the same physical quantity. The hydrostatic stress is fully determined by the in-plane components. The \"hidden\" stress $\\sigma_{zz}$ is zero by definition, so it plays no role. It is important to note that while $\\sigma_{zz}$ is zero, the corresponding out-of-plane strain, $\\epsilon_{zz}$, is generally non-zero. From generalized Hooke's law, $\\epsilon_{zz} = \\frac{1}{E}[\\sigma_{zz} - \\nu(\\sigma_{xx} + \\sigma_{yy})]$, which simplifies to $\\epsilon_{zz} = -\\frac{\\nu}{E}(\\sigma_{xx} + \\sigma_{yy})$.\n\n**Case (ii): Plane Strain Assumption**\nThe plane strain assumption is applicable to thick or long bodies where deformation in one direction is constrained. It is defined by the condition that the strain components in the out-of-plane direction are zero. For a body in the $x-y$ plane, this means:\n$$\n\\epsilon_{zz} = \\epsilon_{xz} = \\epsilon_{yz} = 0\n$$\nTo maintain the condition $\\epsilon_{zz}=0$, a normal stress $\\sigma_{zz}$ must develop. We find its value using the three-dimensional constitutive relation (generalized Hooke's law) for an isotropic, linearly elastic material:\n$$\n\\epsilon_{zz} = \\frac{1}{E} [ \\sigma_{zz} - \\nu (\\sigma_{xx} + \\sigma_{yy}) ]\n$$\nSetting $\\epsilon_{zz} = 0$, we solve for $\\sigma_{zz}$:\n$$\n0 = \\frac{1}{E} [ \\sigma_{zz} - \\nu (\\sigma_{xx} + \\sigma_{yy}) ] \\implies \\sigma_{zz} = \\nu (\\sigma_{xx} + \\sigma_{yy})\n$$\nThis $\\sigma_{zz}$ is the \"hidden\" stress. It is a reaction stress that arises to enforce the geometric constraint of zero out-of-plane normal strain. Since $\\nu \\neq 0$ and, in this problem, $\\sigma_{xx} + \\sigma_{yy} \\neq 0$, $\\sigma_{zz}$ is non-zero.\nThe true first invariant $I_1$ is now:\n$$\nI_1 = \\sigma_{xx} + \\sigma_{yy} + \\sigma_{zz} = \\sigma_{xx} + \\sigma_{yy} + \\nu(\\sigma_{xx} + \\sigma_{yy}) = (1+\\nu)(\\sigma_{xx} + \\sigma_{yy})\n$$\nIn this case, $I_1 = (1+\\nu) I_{1}^{\\text{in-plane}}$. The true first invariant $I_1$ and the in-plane invariant $I_{1}^{\\text{in-plane}}$ are not the same; they differ by a factor of $(1+\\nu)$. The quantity $I_{1}^{\\text{in-plane}}$ no longer represents the full trace of the stress tensor and thus provides an incomplete measure of the hydrostatic stress state. The interpretation differs because the physical constraint of plane strain induces the out-of-plane stress $\\sigma_{zz}$, which must be included in any physically correct measure of volumetric stress.\n\n**Part 2: Calculation of the Second Deviatoric Stress Invariant, $J_2$**\n\nThe deviatoric stress tensor, $s_{ij}$, is defined as $s_{ij} = \\sigma_{ij} - \\sigma_m \\delta_{ij} = \\sigma_{ij} - \\frac{1}{3}I_1 \\delta_{ij}$. The second invariant of the deviatoric stress, $J_2$, measures the magnitude of the shear (or distortional) components of the stress state and is related to the strain energy of distortion. It is defined as:\n$$\nJ_2 = \\frac{1}{2} s_{ij} s_{ij} = \\frac{1}{2} (s_{xx}^2 + s_{yy}^2 + s_{zz}^2 + 2s_{xy}^2 + 2s_{yz}^2 + 2s_{xz}^2)\n$$\nAn alternative, and often more convenient, expression for $J_2$ in terms of the stress components is:\n$$\nJ_2 = \\frac{1}{6} [ (\\sigma_{xx} - \\sigma_{yy})^2 + (\\sigma_{yy} - \\sigma_{zz})^2 + (\\sigma_{zz} - \\sigma_{xx})^2 ] + \\sigma_{xy}^2 + \\sigma_{yz}^2 + \\sigma_{xz}^2\n$$\nSince $\\sigma_{xz} = \\sigma_{yz} = 0$ in this problem, the formula simplifies to:\n$$\nJ_2 = \\frac{1}{6} [ (\\sigma_{xx} - \\sigma_{yy})^2 + (\\sigma_{yy} - \\sigma_{zz})^2 + (\\sigma_{zz} - \\sigma_{xx})^2 ] + \\sigma_{xy}^2\n$$\nWe use the given stress values: $\\sigma_{xx} = 120\\,\\text{MPa}$, $\\sigma_{yy} = -30\\,\\text{MPa}$, and $\\sigma_{xy} = 45\\,\\text{MPa}$.\n\n**Case (i): Plane Stress Calculation**\nUnder the plane stress assumption, $\\sigma_{zz} = 0\\,\\text{MPa}$.\nWe compute the differences:\n$\\sigma_{xx} - \\sigma_{yy} = 120 - (-30) = 150\\,\\text{MPa}$\n$\\sigma_{yy} - \\sigma_{zz} = -30 - 0 = -30\\,\\text{MPa}$\n$\\sigma_{zz} - \\sigma_{xx} = 0 - 120 = -120\\,\\text{MPa}$\nSubstituting these into the formula for $J_2$:\n$$\nJ_2 = \\frac{1}{6} [ (150)^2 + (-30)^2 + (-120)^2 ] + (45)^2\n$$\n$$\nJ_2 = \\frac{1}{6} [ 22500 + 900 + 14400 ] + 2025\n$$\n$$\nJ_2 = \\frac{1}{6} [ 37800 ] + 2025 = 6300 + 2025 = 8325\\,\\text{MPa}^2\n$$\nThe value is $8325\\,\\text{MPa}^2$, which has four significant figures.\n\n**Case (ii): Plane Strain Calculation**\nFirst, we must calculate the value of the hidden stress $\\sigma_{zz}$ using $\\nu=0.28$:\n$$\n\\sigma_{zz} = \\nu (\\sigma_{xx} + \\sigma_{yy}) = 0.28 \\times (120 + (-30)) = 0.28 \\times 90 = 25.2\\,\\text{MPa}\n$$\nNow we compute the differences required for the $J_2$ formula with $\\sigma_{zz} = 25.2\\,\\text{MPa}$:\n$\\sigma_{xx} - \\sigma_{yy} = 120 - (-30) = 150\\,\\text{MPa}$\n$\\sigma_{yy} - \\sigma_{zz} = -30 - 25.2 = -55.2\\,\\text{MPa}$\n$\\sigma_{zz} - \\sigma_{xx} = 25.2 - 120 = -94.8\\,\\text{MPa}$\nSubstituting these into the formula for $J_2$:\n$$\nJ_2 = \\frac{1}{6} [ (150)^2 + (-55.2)^2 + (-94.8)^2 ] + (45)^2\n$$\n$$\nJ_2 = \\frac{1}{6} [ 22500 + 3047.04 + 8987.04 ] + 2025\n$$\n$$\nJ_2 = \\frac{1}{6} [ 34534.08 ] + 2025 = 5755.68 + 2025 = 7780.68\\,\\text{MPa}^2\n$$\nRounding this value to four significant figures, we get $7781\\,\\text{MPa}^2$.\n\nThe final results are $J_2 = 8325\\,\\text{MPa}^2$ for the plane stress case and $J_2 = 7781\\,\\text{MPa}^2$ for the plane strain case.", "answer": "$$\n\\boxed{\\begin{pmatrix} 8325 & 7781 \\end{pmatrix}}\n$$", "id": "3588334"}, {"introduction": "A robust computational analysis requires not only theoretical understanding but also methods to verify the correctness of the implementation. This advanced practice bridges theory and code by tasking you with developing a computational test to detect a mismatch between the intended physical model (plane strain) and the constitutive law actually used in a finite element assembly (plane stress). The exercise [@problem_id:3588365] leverages the distinct energy signatures of the two models, equipping you with a powerful diagnostic tool to identify spurious compliance and ensure the physical integrity of your simulations.", "problem": "Consider a homogeneous, isotropic, linearly elastic solid governed by the three-dimensional Hooke law $\\boldsymbol{\\sigma} = 2 \\mu \\boldsymbol{\\varepsilon} + \\lambda \\, \\mathrm{tr}(\\boldsymbol{\\varepsilon}) \\mathbf{I}$, where $\\boldsymbol{\\sigma}$ is the Cauchy stress tensor, $\\boldsymbol{\\varepsilon}$ is the infinitesimal strain tensor, $\\mu$ and $\\lambda$ are the Lamé parameters, and $\\mathbf{I}$ is the identity tensor. The Lamé parameters are related to Young's modulus $E$ and Poisson's ratio $\\nu$ by $\\mu = \\dfrac{E}{2(1+\\nu)}$ and $\\lambda = \\dfrac{E \\nu}{(1+\\nu)(1-2\\nu)}$. The plane stress assumption is defined by $\\sigma_{zz} = 0$, while the plane strain assumption is defined by $\\varepsilon_{zz} = 0$, with $z$ being the out-of-plane direction. In the context of two-dimensional analysis, the constitutive relation is represented in the Voigt notation $\\boldsymbol{\\sigma} = \\mathbf{D} \\boldsymbol{\\varepsilon}$ with $\\boldsymbol{\\varepsilon} = [\\varepsilon_{xx}, \\varepsilon_{yy}, \\gamma_{xy}]^\\top$, where $\\gamma_{xy} = 2 \\varepsilon_{xy}$ is the engineering shear strain.\n\nStarting from the stated three-dimensional Hooke law and the definitions of plane stress and plane strain, derive the two-dimensional material matrices $\\mathbf{D}^{ps}(E,\\nu)$ and $\\mathbf{D}^{pe}(E,\\nu)$ for plane stress and plane strain, respectively. Then analyze the physical consequences of mistakenly using $\\mathbf{D}^{ps}$ in a finite element mesh that is intended for plane strain: specifically, quantify how the assembled stiffness responds to volumetric (hydrostatic-like) in-plane deformation compared to shear deformation, and explain the origin of any discrepancy using the derived constitutive laws.\n\nYou are to propose and implement a computational test that detects such a mismatch directly from the assembled global stiffness matrix $\\mathbf{K}$ without solving a boundary value problem. Use the Finite Element Method (FEM) with bilinear quadrilateral elements ($Q4$) on a unit square domain of side length $1$ and unit thickness, discretized into $2 \\times 2$ elements (i.e., $4$ elements with $3 \\times 3$ nodes). Let $\\mathbf{K}$ be assembled from the element stiffness matrices $\\mathbf{K}_e = \\int_{\\Omega_e} \\mathbf{B}^\\top \\mathbf{D} \\mathbf{B} \\, \\mathrm{d}\\Omega$, where $\\mathbf{B}$ is the strain-displacement matrix for the bilinear shape functions, and the integral is evaluated using standard $2 \\times 2$ Gaussian quadrature in the parent coordinates. Use no body forces.\n\nDefine two kinematically admissible displacement fields represented on the nodal degrees of freedom:\n- Uniform in-plane dilation: $\\mathbf{u}_{\\mathrm{hydro}}(x,y) = [\\alpha x, \\alpha y]^\\top$, which induces $\\varepsilon_{xx} = \\alpha$, $\\varepsilon_{yy} = \\alpha$, and $\\gamma_{xy} = 0$.\n- Pure in-plane shear: $\\mathbf{u}_{\\mathrm{shear}}(x,y) = \\left[\\dfrac{\\gamma}{2} y, \\dfrac{\\gamma}{2} x\\right]^\\top$, which induces $\\varepsilon_{xx} = 0$, $\\varepsilon_{yy} = 0$, and $\\gamma_{xy} = \\gamma$.\n\nFor a given assembled global stiffness matrix $\\mathbf{K}$, compute the strain energy for each field as $W_{\\mathrm{hydro}} = \\dfrac{1}{2} \\mathbf{U}_{\\mathrm{hydro}}^\\top \\mathbf{K} \\mathbf{U}_{\\mathrm{hydro}}$ and $W_{\\mathrm{shear}} = \\dfrac{1}{2} \\mathbf{U}_{\\mathrm{shear}}^\\top \\mathbf{K} \\mathbf{U}_{\\mathrm{shear}}$, where $\\mathbf{U}$ denotes the global nodal displacement vector induced by each field. Form the dimensionless energy ratio\n$$\nQ_{\\mathrm{comp}} = \\frac{W_{\\mathrm{hydro}} / \\alpha^2}{W_{\\mathrm{shear}} / \\gamma^2}.\n$$\nShow from first principles that for a homogeneous isotropic continuum, this ratio depends only on the constitutive type and Poisson's ratio, specifically\n$$\nQ^{ps}(\\nu) = \\frac{4(1+\\nu)}{1-\\nu},\n\\qquad\nQ^{pe}(\\nu) = \\frac{4}{1-2\\nu}.\n$$\nConsequently, a mesh assembled with $\\mathbf{D}^{ps}$ will exhibit $Q_{\\mathrm{comp}} \\approx Q^{ps}(\\nu)$, whereas a mesh intended for plane strain should exhibit $Q_{\\mathrm{comp}} \\approx Q^{pe}(\\nu)$.\n\nDesign a detection algorithm that, given the intended plane strain parameters $(E,\\nu)$ and the actually assembled matrix type (either plane stress or plane strain), declares a mismatch if the relative deviation $\\left| Q_{\\mathrm{comp}} / Q^{pe}(\\nu) - 1 \\right|$ exceeds a tolerance of $0.05$ (i.e., $5$ percent). Note that for $\\nu = 0$, $Q^{ps}(\\nu) = Q^{pe}(\\nu)$, so the test cannot distinguish the two at that boundary.\n\nImplement the computation and detection as a single, self-contained program. Use the following test suite to ensure coverage:\n- Test $1$: $E = 210 \\times 10^9$ pascals, $\\nu = 0.3$, assembled as plane stress (mismatch expected).\n- Test $2$: $E = 210 \\times 10^9$ pascals, $\\nu = 0.3$, assembled as plane strain (no mismatch expected).\n- Test $3$: $E = 1 \\times 10^6$ pascals, $\\nu = 0.0$, assembled as plane stress (no mismatch expected by theory).\n- Test $4$: $E = 1 \\times 10^9$ pascals, $\\nu = -0.2$, assembled as plane stress (mismatch expected).\n- Test $5$: $E = 3 \\times 10^7$ pascals, $\\nu = 0.49$, assembled as plane stress (mismatch expected).\n- Test $6$: $E = 3 \\times 10^7$ pascals, $\\nu = 0.49$, assembled as plane strain (no mismatch expected).\n\nTake $\\alpha = 10^{-3}$ and $\\gamma = 10^{-3}$, the domain length in meters, and thickness equal to $1$ meter. All energies are computed in joules, but the final detection outputs are dimensionless booleans. Your program should produce a single line of output containing the detection results for the six tests as a comma-separated list enclosed in square brackets (e.g., $[r_1,r_2,r_3,r_4,r_5,r_6]$), where each $r_i$ is a boolean indicating whether a mismatch was detected for test $i$ using the above criterion. No user input is required, and no external files may be used.", "solution": "The problem is assessed to be valid. It is scientifically grounded in the principles of continuum mechanics and the finite element method, well-posed with all necessary data and conditions provided, and articulated with objective, formal language. There are no contradictions, ambiguities, or factual errors. The problem will be solved as stated.\n\nThe solution proceeds in four stages:\n1.  Derivation of the two-dimensional plane stress ($\\mathbf{D}^{ps}$) and plane strain ($\\mathbf{D}^{pe}$) constitutive matrices from the three-dimensional Hooke's law.\n2.  Analytical derivation of the theoretical energy ratios, $Q^{ps}(\\nu)$ and $Q^{pe}(\\nu)$, for a homogeneous continuum subjected to the specified deformation fields.\n3.  Explanation of the physical discrepancy arising from the incorrect use of a plane stress model for a plane strain condition.\n4.  Formulation of the computational test using the Finite Element Method (FEM) to detect this modeling mismatch.\n\n### 1. Derivation of Constitutive Matrices\n\nThe three-dimensional isotropic linear elastic constitutive relation (Hooke's Law) is given by:\n$$\n\\boldsymbol{\\sigma} = 2 \\mu \\boldsymbol{\\varepsilon} + \\lambda \\, \\mathrm{tr}(\\boldsymbol{\\varepsilon}) \\mathbf{I}\n$$\nwhere $\\boldsymbol{\\sigma}$ is the Cauchy stress tensor, $\\boldsymbol{\\varepsilon}$ is the infinitesimal strain tensor, $\\mathbf{I}$ is the second-order identity tensor, and $\\lambda$ and $\\mu$ are the Lamé parameters. In terms of Young's modulus $E$ and Poisson's ratio $\\nu$, they are:\n$$\n\\mu = \\frac{E}{2(1+\\nu)}, \\qquad \\lambda = \\frac{E\\nu}{(1+\\nu)(1-2\\nu)}\n$$\nThe six independent components of stress and strain are related by:\n$$\n\\begin{Bmatrix} \\sigma_{xx} \\\\ \\sigma_{yy} \\\\ \\sigma_{zz} \\\\ \\sigma_{xy} \\\\ \\sigma_{yz} \\\\ \\sigma_{zx} \\end{Bmatrix} =\n\\begin{bmatrix}\n\\lambda+2\\mu & \\lambda & \\lambda & 0 & 0 & 0 \\\\\n\\lambda & \\lambda+2\\mu & \\lambda & 0 & 0 & 0 \\\\\n\\lambda & \\lambda & \\lambda+2\\mu & 0 & 0 & 0 \\\\\n0 & 0 & 0 & \\mu & 0 & 0 \\\\\n0 & 0 & 0 & 0 & \\mu & 0 \\\\\n0 & 0 & 0 & 0 & 0 & \\mu\n\\end{bmatrix}\n\\begin{Bmatrix} \\varepsilon_{xx} \\\\ \\varepsilon_{yy} \\\\ \\varepsilon_{zz} \\\\ 2\\varepsilon_{xy} \\\\ 2\\varepsilon_{yz} \\\\ 2\\varepsilon_{zx} \\end{Bmatrix}\n$$\nWe use engineering shear strain $\\gamma_{ij} = 2\\varepsilon_{ij}$. The relation for two-dimensional problems in Voigt notation is $\\boldsymbol{\\sigma} = \\mathbf{D} \\boldsymbol{\\varepsilon}$ with $\\boldsymbol{\\sigma} = [\\sigma_{xx}, \\sigma_{yy}, \\sigma_{xy}]^\\top$ and $\\boldsymbol{\\varepsilon} = [\\varepsilon_{xx}, \\varepsilon_{yy}, \\gamma_{xy}]^\\top$.\n\n**Plane Strain (pe):**\nThe plane strain condition is defined by the constraint that all out-of-plane strains are zero: $\\varepsilon_{zz} = \\varepsilon_{xz} = \\varepsilon_{yz} = 0$.\nThe stress-strain relations for the in-plane components simplify to:\n$$\n\\sigma_{xx} = (\\lambda+2\\mu)\\varepsilon_{xx} + \\lambda\\varepsilon_{yy}\n$$\n$$\n\\sigma_{yy} = \\lambda\\varepsilon_{xx} + (\\lambda+2\\mu)\\varepsilon_{yy}\n$$\n$$\n\\sigma_{xy} = \\mu \\gamma_{xy}\n$$\nThe out-of-plane stress $\\sigma_{zz}$ is non-zero: $\\sigma_{zz} = \\lambda(\\varepsilon_{xx} + \\varepsilon_{yy})$.\nSubstituting the expressions for $\\lambda$ and $\\mu$ in terms of $E$ and $\\nu$:\n$$\n\\lambda+2\\mu = \\frac{E\\nu}{(1+\\nu)(1-2\\nu)} + \\frac{E}{1+\\nu} = \\frac{E(1-\\nu)}{(1+\\nu)(1-2\\nu)}\n$$\n$$\n\\mu = \\frac{E}{2(1+\\nu)}\n$$\nThis gives the plane strain constitutive matrix $\\mathbf{D}^{pe}$:\n$$\n\\mathbf{D}^{pe}(E,\\nu) = \\frac{E}{(1+\\nu)(1-2\\nu)}\n\\begin{bmatrix}\n1-\\nu & \\nu & 0 \\\\\n\\nu & 1-\\nu & 0 \\\\\n0 & 0 & \\frac{1-2\\nu}{2}\n\\end{bmatrix}\n$$\n\n**Plane Stress (ps):**\nThe plane stress condition is defined by the constraint that all out-of-plane stresses are zero: $\\sigma_{zz} = \\sigma_{xz} = \\sigma_{yz} = 0$.\nFrom $\\sigma_{zz} = \\lambda(\\varepsilon_{xx}+\\varepsilon_{yy}+\\varepsilon_{zz}) + 2\\mu\\varepsilon_{zz} = 0$, we solve for $\\varepsilon_{zz}$:\n$$\n\\varepsilon_{zz} = -\\frac{\\lambda}{\\lambda+2\\mu}(\\varepsilon_{xx}+\\varepsilon_{yy}) = -\\frac{\\nu}{1-\\nu}(\\varepsilon_{xx}+\\varepsilon_{yy})\n$$\nSubstituting this into the expressions for $\\sigma_{xx}$ and $\\sigma_{yy}$:\n$$\n\\sigma_{xx} = (\\lambda+2\\mu)\\varepsilon_{xx} + \\lambda\\varepsilon_{yy} + \\lambda\\varepsilon_{zz} = (\\lambda+2\\mu)\\varepsilon_{xx} + \\lambda\\varepsilon_{yy} - \\frac{\\lambda^2}{\\lambda+2\\mu}(\\varepsilon_{xx}+\\varepsilon_{yy})\n$$\nAfter algebraic simplification, this yields:\n$$\n\\sigma_{xx} = \\frac{E}{1-\\nu^2}(\\varepsilon_{xx} + \\nu\\varepsilon_{yy})\n$$\n$$\n\\sigma_{yy} = \\frac{E}{1-\\nu^2}(\\nu\\varepsilon_{xx} + \\varepsilon_{yy})\n$$\nThe shear relation remains $\\sigma_{xy} = \\mu \\gamma_{xy}$. This gives the plane stress constitutive matrix $\\mathbf{D}^{ps}$:\n$$\n\\mathbf{D}^{ps}(E,\\nu) = \\frac{E}{1-\\nu^2}\n\\begin{bmatrix}\n1 & \\nu & 0 \\\\\n\\nu & 1 & 0 \\\\\n0 & 0 & \\frac{1-\\nu}{2}\n\\end{bmatrix}\n$$\n\n### 2. Derivation of Theoretical Energy Ratios\n\nThe strain energy density $w$ is given by $w = \\frac{1}{2} \\boldsymbol{\\varepsilon}^\\top \\mathbf{D} \\boldsymbol{\\varepsilon}$. The total energy $W$ is the integral of $w$ over the volume. For a homogeneous strain field over a domain of unit volume ($1 \\times 1 \\times 1$), $W=w$.\n\n**Case 1: Uniform In-plane Dilation (Hydrostatic-like)**\nThe displacement field $\\mathbf{u}_{\\mathrm{hydro}}(x,y) = [\\alpha x, \\alpha y]^\\top$ induces a uniform strain state $\\boldsymbol{\\varepsilon}_{\\mathrm{hydro}} = [\\alpha, \\alpha, 0]^\\top$.\n\nFor plane stress:\n$$\nW_{\\mathrm{hydro}}^{ps} = \\frac{1}{2} [\\alpha, \\alpha, 0] \\frac{E}{1-\\nu^2}\n\\begin{bmatrix} 1 & \\nu & 0 \\\\ \\nu & 1 & 0 \\\\ 0 & 0 & (1-\\nu)/2 \\end{bmatrix}\n\\begin{Bmatrix} \\alpha \\\\ \\alpha \\\\ 0 \\end{Bmatrix} = \\frac{E\\alpha^2}{2(1-\\nu^2)}(1+\\nu+\\nu+1) = \\frac{E\\alpha^2(1+\\nu)}{1-\\nu^2} = \\frac{E\\alpha^2}{1-\\nu}\n$$\nThus, $W_{\\mathrm{hydro}}^{ps}/\\alpha^2 = \\frac{E}{1-\\nu}$.\n\nFor plane strain:\n$$\nW_{\\mathrm{hydro}}^{pe} = \\frac{1}{2} [\\alpha, \\alpha, 0] \\frac{E}{(1+\\nu)(1-2\\nu)}\n\\begin{bmatrix} 1-\\nu & \\nu & 0 \\\\ \\nu & 1-\\nu & 0 \\\\ 0 & 0 & (1-2\\nu)/2 \\end{bmatrix}\n\\begin{Bmatrix} \\alpha \\\\ \\alpha \\\\ 0 \\end{Bmatrix} = \\frac{E\\alpha^2}{2(1+\\nu)(1-2\\nu)}(1-\\nu+\\nu+\\nu+1-\\nu) = \\frac{E\\alpha^2}{(1+\\nu)(1-2\\nu)}\n$$\nThus, $W_{\\mathrm{hydro}}^{pe}/\\alpha^2 = \\frac{E}{(1+\\nu)(1-2\\nu)}$.\n\n**Case 2: Pure In-plane Shear**\nThe field $\\mathbf{u}_{\\mathrm{shear}}(x,y) = [\\frac{\\gamma}{2}y, \\frac{\\gamma}{2}x]^\\top$ induces a uniform strain state $\\boldsymbol{\\varepsilon}_{\\mathrm{shear}}=[0, 0, \\gamma]^\\top$.\n\nFor both plane stress and plane strain, the shear response is governed by the shear modulus $\\mu=G=\\frac{E}{2(1+\\nu)}$. The $(3,3)$ component of $\\mathbf{D}^{ps}$ is $\\frac{E}{1-\\nu^2}\\frac{1-\\nu}{2}=\\frac{E}{2(1+\\nu)}=\\mu$. The $(3,3)$ component of $\\mathbf{D}^{pe}$ is $\\frac{E}{(1+\\nu)(1-2\\nu)}\\frac{1-2\\nu}{2}=\\frac{E}{2(1+\\nu)}=\\mu$.\n$$\nW_{\\mathrm{shear}} = \\frac{1}{2} [0, 0, \\gamma] \\mathbf{D} \\begin{Bmatrix} 0 \\\\ 0 \\\\ \\gamma \\end{Bmatrix} = \\frac{1}{2}\\mu\\gamma^2 = \\frac{E\\gamma^2}{4(1+\\nu)}\n$$\nThus, for both cases, $W_{\\mathrm{shear}}/\\gamma^2 = \\frac{E}{4(1+\\nu)}$.\n\n**Energy Ratios:**\nThe dimensionless ratio $Q$ is formed by dividing the normalized hydrostatic energy by the normalized shear energy.\nFor plane stress:\n$$\nQ^{ps}(\\nu) = \\frac{W_{\\mathrm{hydro}}^{ps}/\\alpha^2}{W_{\\mathrm{shear}}/\\gamma^2} = \\frac{E/(1-\\nu)}{E/(4(1+\\nu))} = \\frac{4(1+\\nu)}{1-\\nu}\n$$\nFor plane strain:\n$$\nQ^{pe}(\\nu) = \\frac{W_{\\mathrm{hydro}}^{pe}/\\alpha^2}{W_{\\mathrm{shear}}/\\gamma^2} = \\frac{E/((1+\\nu)(1-2\\nu))}{E/(4(1+\\nu))} = \\frac{4}{1-2\\nu}\n$$\nThese derivations confirm the expressions provided in the problem statement.\n\n### 3. Physical Consequences of Modeling Mismatch\n\nThe core of the mismatch lies in the volumetric stiffness. The shear stiffness, governed by $\\mu$, is identical for both models. However, the resistance to area changes (in-plane volumetric strain) is significantly different.\n\nUsing a plane stress constitutive matrix $\\mathbf{D}^{ps}$ for a physical situation that is actually in plane strain means the model will be too \"soft\" with respect to volumetric deformations. The plane stress assumption allows for out-of-plane deformation ($\\varepsilon_{zz} \\neq 0$), which provides a \"relief\" mechanism for in-plane expansion or contraction. A plane strain model explicitly forbids this ($\\varepsilon_{zz} = 0$), forcing all deformation to occur in-plane, which requires higher stresses for the same in-plane strain, hence a higher stiffness.\n\nThis is most pronounced as $\\nu$ approaches $0.5$. For plane strain, a material with $\\nu \\to 0.5$ becomes incompressible; the bulk modulus, and therefore $Q^{pe}(\\nu)$, approaches infinity. In contrast, for plane stress, $Q^{ps}(0.5) = 4(1.5)/0.5 = 12$, a finite value. Using a plane stress model for a nearly incompressible plane strain problem would grossly underestimate the material's resistance to volumetric changes, a phenomenon known as \"spurious compliance\" which can lead to large, non-physical predicted deformations.\n\n### 4. Computational Test Formulation\n\nThe proposed test leverages the fact that bilinear quadrilateral (Q4) finite elements can exactly represent any displacement field that is linear in the spatial coordinates $x$ and $y$. Both $\\mathbf{u}_{\\mathrm{hydro}}$ and $\\mathbf{u}_{\\mathrm{shear}}$ are linear fields. Consequently, the strain energy computed from the assembled global stiffness matrix $\\mathbf{K}$ and the corresponding nodal displacement vectors $\\mathbf{U}$ must, aside from floating-point error, exactly match the analytical continuum energy.\n$$\nW = \\frac{1}{2}\\mathbf{U}^\\top \\mathbf{K} \\mathbf{U} \\equiv \\int_{\\Omega} \\frac{1}{2}\\boldsymbol{\\varepsilon}^\\top \\mathbf{D} \\boldsymbol{\\varepsilon} \\, \\mathrm{d}\\Omega\n$$\nThe test proceeds as follows:\n1.  Discretize the unit square domain with a $2 \\times 2$ mesh of Q4 elements. This results in $9$ nodes and $18$ degrees of freedom (DOFs).\n2.  For a given test case specified by $(E, \\nu)$ and assembly type (`ps` or `pe`), assemble the $18 \\times 18$ global stiffness matrix $\\mathbf{K}$ using the appropriate constitutive matrix $\\mathbf{D}$. Element stiffness matrices $\\mathbf{K}_e = \\int_{\\Omega_e} \\mathbf{B}^\\top \\mathbf{D} \\mathbf{B} \\, t \\, \\mathrm{d}\\Omega$ (with thickness $t=1$) are computed using $2 \\times 2$ Gaussian quadrature.\n3.  Construct the global nodal displacement vectors $\\mathbf{U}_{\\mathrm{hydro}}$ and $\\mathbf{U}_{\\mathrm{shear}}$ by evaluating the analytical displacement fields at the coordinates of each of the $9$ nodes.\n4.  Compute the strain energies $W_{\\mathrm{hydro}} = \\frac{1}{2}\\mathbf{U}_{\\mathrm{hydro}}^\\top \\mathbf{K} \\mathbf{U}_{\\mathrm{hydro}}$ and $W_{\\mathrm{shear}} = \\frac{1}{2}\\mathbf{U}_{\\mathrm{shear}}^\\top \\mathbf{K} \\mathbf{U}_{\\mathrm{shear}}$.\n5.  Calculate the computational energy ratio $Q_{\\mathrm{comp}} = \\frac{W_{\\mathrm{hydro}}/\\alpha^2}{W_{\\mathrm{shear}}/\\gamma^2}$. Because the FEM model is exact for these fields, $Q_{\\mathrm{comp}}$ will be numerically equal to the theoretical ratio ($Q^{ps}$ or $Q^{pe}$) corresponding to the matrix $\\mathbf{D}$ used in the assembly.\n6.  The detection logic compares $Q_{\\mathrm{comp}}$ to the *intended* theoretical ratio for a plane strain problem, $Q^{pe}(\\nu)$. A mismatch is declared if the relative deviation exceeds the tolerance of $5\\%$:\n    $$\n    \\left| \\frac{Q_{\\mathrm{comp}}}{Q^{pe}(\\nu)} - 1 \\right| > 0.05\n    $$\nThis test effectively checks if the \"volumetric-to-shear stiffness ratio\" embedded in the matrix $\\mathbf{K}$ matches that of a true plane strain material with Poisson's ratio $\\nu$.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the FEM-based detection of constitutive model mismatch.\n    \"\"\"\n    \n    # --- Problem Parameters ---\n    ALPHA = 1e-3\n    GAMMA = 1e-3\n    TOLERANCE = 0.05\n    THICKNESS = 1.0\n\n    def get_constitutive_matrix(E, nu, matrix_type):\n        \"\"\"\n        Returns the 2D constitutive matrix D for plane stress or plane strain.\n        \n        Args:\n            E (float): Young's modulus.\n            nu (float): Poisson's ratio.\n            matrix_type (str): Either 'ps' for plane stress or 'pe' for plane strain.\n\n        Returns:\n            numpy.ndarray: The 3x3 constitutive matrix.\n        \"\"\"\n        if matrix_type == 'ps':\n            # Check for nu = -1 where the formula is ill-defined\n            if abs(1.0 + nu) < 1e-9:\n                raise ValueError(\"Poisson's ratio cannot be -1 for plane stress.\")\n            factor = E / (1.0 - nu**2)\n            D = factor * np.array([\n                [1.0, nu, 0.0],\n                [nu, 1.0, 0.0],\n                [0.0, 0.0, (1.0 - nu) / 2.0]\n            ])\n        elif matrix_type == 'pe':\n            # Check for nu = -1 or nu = 0.5 where formula is ill-defined\n            if abs(1.0 + nu) < 1e-9 or abs(1.0 - 2.0 * nu) < 1e-9:\n                 raise ValueError(\"Poisson's ratio is out of bounds for plane strain.\")\n            factor = E / ((1.0 + nu) * (1.0 - 2.0 * nu))\n            D = factor * np.array([\n                [1.0 - nu, nu, 0.0],\n                [nu, 1.0 - nu, 0.0],\n                [0.0, 0.0, (1.0 - 2.0 * nu) / 2.0]\n            ])\n        else:\n            raise ValueError(f\"Invalid matrix_type: {matrix_type}\")\n        return D\n\n    def get_B_matrix_and_detJ(xi, eta, elem_coords):\n        \"\"\"\n        Computes the strain-displacement matrix (B) and Jacobian determinant for a Q4 element.\n        \"\"\"\n        # Derivatives of shape functions w.r.t. parent coordinates (xi, eta)\n        dN_dxi = 0.25 * np.array([-(1.0 - eta), (1.0 - eta), (1.0 + eta), -(1.0 + eta)])\n        dN_deta = 0.25 * np.array([-(1.0 - xi), -(1.0 + xi), (1.0 + xi), (1.0 - xi)])\n\n        # Jacobian matrix\n        J = np.array([\n            [np.dot(dN_dxi, elem_coords[:, 0]), np.dot(dN_dxi, elem_coords[:, 1])],\n            [np.dot(dN_deta, elem_coords[:, 0]), np.dot(dN_deta, elem_coords[:, 1])]\n        ])\n\n        detJ = np.linalg.det(J)\n        if abs(detJ) < 1e-12:\n            raise np.linalg.LinAlgError(\"Jacobian determinant is zero or near-zero.\")\n        \n        J_inv = np.linalg.inv(J)\n\n        # Derivatives of shape functions w.r.t. global coordinates (x, y)\n        dN_dxy = J_inv @ np.vstack([dN_dxi, dN_deta])\n        \n        # Strain-displacement matrix (B)\n        B = np.zeros((3, 8))\n        for i in range(4):\n            B[0, 2 * i] = dN_dxy[0, i]\n            B[1, 2 * i + 1] = dN_dxy[1, i]\n            B[2, 2 * i] = dN_dxy[1, i]\n            B[2, 2 * i + 1] = dN_dxy[0, i]\n            \n        return B, detJ\n\n    def assemble_stiffness_matrix(E, nu, matrix_type):\n        \"\"\"\n        Assembles the global stiffness matrix K for the specified mesh and material.\n        \"\"\"\n        # Mesh: 3x3 grid of nodes for a 2x2 element mesh on a unit square\n        nodes_coords = np.array([\n            [0.0, 0.0], [0.5, 0.0], [1.0, 0.0],\n            [0.0, 0.5], [0.5, 0.5], [1.0, 0.5],\n            [0.0, 1.0], [0.5, 1.0], [1.0, 1.0]\n        ])\n        \n        # Element connectivity (local nodes -> global node indices)\n        elements_nodes = np.array([\n            [0, 1, 4, 3],  # Element 0\n            [1, 2, 5, 4],  # Element 1\n            [3, 4, 7, 6],  # Element 2\n            [4, 5, 8, 7]   # Element 3\n        ], dtype=int)\n\n        num_nodes = nodes_coords.shape[0]\n        num_dofs = 2 * num_nodes\n        K_global = np.zeros((num_dofs, num_dofs))\n        \n        D = get_constitutive_matrix(E, nu, matrix_type)\n        \n        # 2x2 Gaussian quadrature points and weights\n        gauss_points = [-1.0 / np.sqrt(3.0), 1.0 / np.sqrt(3.0)]\n        gauss_weights = [1.0, 1.0]\n\n        for elem_node_indices in elements_nodes:\n            elem_coords = nodes_coords[elem_node_indices]\n            K_element = np.zeros((8, 8))\n\n            for i in range(len(gauss_points)):\n                for j in range(len(gauss_points)):\n                    xi, eta = gauss_points[i], gauss_points[j]\n                    weight = gauss_weights[i] * gauss_weights[j]\n                    \n                    B, detJ = get_B_matrix_and_detJ(xi, eta, elem_coords)\n                    \n                    K_element += B.T @ D @ B * detJ * weight * THICKNESS\n\n            # Assemble element matrix into global matrix\n            dof_indices = []\n            for node_idx in elem_node_indices:\n                dof_indices.extend([2 * node_idx, 2 * node_idx + 1])\n            \n            K_global[np.ix_(dof_indices, dof_indices)] += K_element\n            \n        return K_global, nodes_coords\n\n    def run_detection_test(E, nu_intended, assembled_as, alpha, gamma):\n        \"\"\"\n        Runs the detection test for a single case.\n        \"\"\"\n        try:\n            K_global, nodes_coords = assemble_stiffness_matrix(E, nu_intended, assembled_as)\n        except ValueError as e:\n            # Handle cases where constitutive matrix is ill-defined\n            # The test cases provided are valid, but this is a robust check.\n            if \"Poisson's ratio\" in str(e): # A specific parameter error\n                 if assembled_as == 'pe':\n                    # If this was the intended assembly, Q_comp is ill-defined.\n                    # Q_pe is also infinite. The ratio is indeterminate (inf/inf).\n                    # A mismatch is arguably true as the model is singular.\n                    return True\n                 else: # Assembled as 'ps', but intended 'pe' is singular\n                    # Q_comp is finite from ps, Q_pe is infinite. Mismatch.\n                    return True\n            else:\n                raise e\n\n\n        num_nodes = nodes_coords.shape[0]\n        \n        # Generate global nodal displacement vectors U\n        U_hydro = np.zeros(2 * num_nodes)\n        U_shear = np.zeros(2 * num_nodes)\n        for i in range(num_nodes):\n            x, y = nodes_coords[i, 0], nodes_coords[i, 1]\n            U_hydro[2 * i] = alpha * x\n            U_hydro[2 * i + 1] = alpha * y\n            U_shear[2 * i] = gamma / 2.0 * y\n            U_shear[2 * i + 1] = gamma / 2.0 * x\n\n        # Compute strain energies\n        W_hydro = 0.5 * U_hydro.T @ K_global @ U_hydro\n        W_shear = 0.5 * U_shear.T @ K_global @ U_shear\n        \n        # Avoid division by zero\n        if abs(W_shear) < 1e-12 or gamma == 0:\n            return True # Ill-defined test indicates a problem (mismatch)\n\n        # Compute computational energy ratio\n        Q_comp = (W_hydro / alpha**2) / (W_shear / gamma**2)\n        \n        # Theoretical plane strain energy ratio\n        if abs(1.0 - 2.0 * nu_intended) < 1e-9: # Avoid division by zero for nu=0.5\n            # If Q_comp is finite, it's a mismatch with an infinite theoretical Q_pe\n            return True\n        Q_pe_theoretical = 4.0 / (1.0 - 2.0 * nu_intended)\n\n        # Detection logic\n        relative_deviation = abs(Q_comp / Q_pe_theoretical - 1.0)\n        mismatch_detected = relative_deviation > TOLERANCE\n        \n        return mismatch_detected\n\n    # --- Test Suite Execution ---\n    test_cases = [\n        # (E, nu_intended, assembled_as)\n        (210e9, 0.3, 'ps'), # Test 1: Mismatch expected (ps used for pe)\n        (210e9, 0.3, 'pe'), # Test 2: No mismatch (correctly assembled as pe)\n        (1e6, 0.0, 'ps'),   # Test 3: No mismatch (ps and pe are identical for nu=0)\n        (1e9, -0.2, 'ps'),  # Test 4: Mismatch expected (auxetic material)\n        (3e7, 0.49, 'ps'),  # Test 5: Mismatch expected (near-incompressible case)\n        (3e7, 0.49, 'pe'),  # Test 6: No mismatch (correctly assembled near-incompressible pe)\n    ]\n    \n    results = []\n    for E, nu, assembly_type in test_cases:\n        result = run_detection_test(E, nu, assembly_type, ALPHA, GAMMA)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(str(r) for r in results)}]\")\n\nsolve()\n```", "id": "3588365"}]}