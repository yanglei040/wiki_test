{"hands_on_practices": [{"introduction": "This first exercise is a cornerstone of computational dynamics. By starting with the governing differential equation for a simple one-dimensional bar, you will derive the consistent and lumped mass matrices from first principles [@problem_id:3551458]. This hands-on calculation provides a concrete, analytical understanding of how these different mass representations affect the predicted natural frequencies of a structure and reveals the fundamental trade-off between stiffness and accuracy.", "problem": "Consider axial vibrations of a uniform, prismatic bar of length $L$, cross-sectional area $A$, Young's modulus $E$, and mass density $\\rho$, aligned along the spatial coordinate $x \\in [0, L]$. Assume small-strain linear elasticity, one-dimensional axial motion, and no external loads. The boundary at $x=0$ is fixed (displacement $u(0,t)=0$) and the boundary at $x=L$ is traction-free (natural boundary condition). The continuous governing principle is the balance of linear momentum, and the finite-dimensional model is to be constructed using the Finite Element Method (FEM).\n\nDiscretize the bar into $2$ equal two-node linear elements. Starting from the strong form of the governing equation and its weak (variational) form derived by multiplying with an admissible test function and integrating over the domain, use the Galerkin projection with standard linear shape functions to:\n\n- Derive the element-level consistent mass matrix by integrating the kinetic energy term over each element.\n- Construct the element-level lumped mass matrix by diagonalizing the element mass via nodal mass summation.\n- Assemble the global stiffness and mass matrices for the $2$-element mesh.\n- Impose the essential boundary condition at $x=0$ to obtain the reduced generalized eigenvalue problem for the retained nodal degrees of freedom.\n\nLet $\\omega_{\\text{cons}}$ denote the smallest (fundamental) angular frequency obtained from the reduced generalized eigenproblem using the consistent mass matrix, and let $\\omega_{\\text{lump}}$ denote the smallest angular frequency obtained using the lumped mass matrix. Compute the ratio\n$$\nR \\equiv \\frac{\\omega_{\\text{cons}}}{\\omega_{\\text{lump}}}\n$$\nas an exact closed-form analytic expression in radicals, simplified as far as possible. Provide $R$ as a dimensionless quantity. No numerical rounding is required; express the final answer exactly.", "solution": "The user wants me to act as a meticulous STEM professor and solve a problem on the axial vibration of a bar using the Finite Element Method.\n\n### Problem Validation\n\nFirst, I will validate the provided problem statement.\n\n**Step 1: Extract Givens**\n- **System**: A uniform, prismatic bar.\n- **Parameters**: Length $L$, cross-sectional area $A$, Young's modulus $E$, mass density $\\rho$.\n- **Domain**: Spatial coordinate $x \\in [0, L]$.\n- **Physics**: One-dimensional axial small-strain linear elastic vibrations with no external loads.\n- **Boundary Conditions**: Fixed at $x=0$ ($u(0,t)=0$) and traction-free at $x=L$.\n- **Method**: Finite Element Method (FEM) using a discretization of $2$ equal two-node linear elements.\n- **Tasks**:\n    1. Derive the element-level consistent mass matrix.\n    2. Construct the element-level lumped mass matrix via nodal mass summation.\n    3. Assemble the global stiffness and mass matrices.\n    4. Impose the essential boundary condition at $x=0$ to obtain the reduced generalized eigenvalue problem.\n    5. Find the smallest angular frequency from the consistent mass formulation, $\\omega_{\\text{cons}}$.\n    6. Find the smallest angular frequency from the lumped mass formulation, $\\omega_{\\text{lump}}$.\n    7. Compute the ratio $R \\equiv \\frac{\\omega_{\\text{cons}}}{\\omega_{\\text{lump}}}$.\n- **Output Requirement**: The ratio $R$ must be an exact, simplified, closed-form analytic expression in radicals.\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientific Grounding**: The problem is based on the well-established principles of continuum mechanics, structural dynamics, and the Finite Element Method. The formulation of consistent and lumped mass matrices is a standard topic in computational mechanics. The problem is scientifically sound.\n- **Well-Posed**: The problem is well-posed. It provides all necessary physical parameters ($L, A, E, \\rho$), boundary conditions, and discretization details ($2$ linear elements) to arrive at a unique solution for the discrete frequencies. The fixed boundary condition prevents rigid body motion, ensuring non-zero vibration frequencies.\n- **Objective**: The problem is stated using precise, objective, and standard terminology from engineering and mathematics. There are no subjective or ambiguous statements.\n\n**Step 3: Verdict and Action**\nThe problem is valid as it is scientifically grounded, well-posed, and objective. I will proceed with a full derivation of the solution.\n\n### Solution Derivation\n\nThe analysis of free vibrations of an elastic body using the Finite Element Method leads to the generalized eigenvalue problem:\n$$(\\mathbf{K} - \\omega^2 \\mathbf{M})\\mathbf{d} = \\mathbf{0}$$\nwhere $\\mathbf{K}$ is the global stiffness matrix, $\\mathbf{M}$ is the global mass matrix, $\\omega$ is the angular frequency of vibration, and $\\mathbf{d}$ is the vector of nodal displacement amplitudes.\n\n**1. Element Discretization and Shape Functions**\nThe bar of length $L$ is discretized into $2$ equal elements. The element length is $h_e = L/2$. The nodes are located at $x_1=0$, $x_2=L/2$, and $x_3=L$.\n\nFor a standard two-node linear element of length $h_e$, the axial displacement field $u(x)$ is interpolated from the nodal displacements $u_1$ and $u_2$ using linear shape functions $N_1(x)$ and $N_2(x)$. In a local coordinate system $\\xi \\in [-1, 1]$, the shape functions are:\n$$N_1(\\xi) = \\frac{1-\\xi}{2}, \\quad N_2(\\xi) = \\frac{1+\\xi}{2}$$\nThe relationship between the global coordinate $x$ (within the element, from $0$ to $h_e$) and the local coordinate $\\xi$ is $x = \\frac{h_e}{2}(1+\\xi)$, which gives $dx = \\frac{h_e}{2}d\\xi$. The derivative operator transforms as $\\frac{d}{dx} = \\frac{d\\xi}{dx}\\frac{d}{d\\xi} = \\frac{2}{h_e}\\frac{d}{d\\xi}$.\n\n**2. Element Stiffness Matrix**\nThe element stiffness matrix $\\mathbf{k}^e$ is given by:\n$$k^e_{ij} = \\int_{0}^{h_e} E A \\frac{dN_i}{dx}\\frac{dN_j}{dx} dx$$\nThe derivatives of the shape functions with respect to $x$ are:\n$$\\frac{dN_1}{dx} = -\\frac{1}{h_e}, \\quad \\frac{dN_2}{dx} = \\frac{1}{h_e}$$\nIntegrating gives the well-known stiffness matrix for a 1D bar element:\n$$\\mathbf{k}^e = E A \\int_{0}^{h_e} \\begin{pmatrix} (-1/h_e)^2 & (-1/h_e)(1/h_e) \\\\ (1/h_e)(-1/h_e) & (1/h_e)^2 \\end{pmatrix} dx = \\frac{EA}{h_e} \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix}$$\nSince $h_e = L/2$, the element stiffness matrix for both elements is:\n$$\\mathbf{k}^e = \\frac{2EA}{L} \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix}$$\n\n**3. Element Consistent Mass Matrix**\nThe element consistent mass matrix $\\mathbf{m}^e_{\\text{cons}}$ is given by:\n$$m^e_{\\text{cons}, ij} = \\int_{0}^{h_e} \\rho A N_i(x) N_j(x) dx = \\int_{-1}^{1} \\rho A N_i(\\xi) N_j(\\xi) \\frac{h_e}{2} d\\xi$$\nThe integrals evaluate to:\n$$\\int_{-1}^{1} N_1^2(\\xi) \\frac{h_e}{2} d\\xi = \\frac{h_e}{2} \\int_{-1}^{1} \\left(\\frac{1-\\xi}{2}\\right)^2 d\\xi = \\frac{h_e}{3}$$\n$$\\int_{-1}^{1} N_1(\\xi) N_2(\\xi) \\frac{h_e}{2} d\\xi = \\frac{h_e}{2} \\int_{-1}^{1} \\frac{1-\\xi^2}{4} d\\xi = \\frac{h_e}{6}$$\nThus, the element consistent mass matrix is:\n$$\\mathbf{m}^e_{\\text{cons}} = \\frac{\\rho A h_e}{6} \\begin{pmatrix} 2 & 1 \\\\ 1 & 2 \\end{pmatrix}$$\nWith $h_e = L/2$, this becomes:\n$$\\mathbf{m}^e_{\\text{cons}} = \\frac{\\rho A L}{12} \\begin{pmatrix} 2 & 1 \\\\ 1 & 2 \\end{pmatrix}$$\n\n**4. Element Lumped Mass Matrix**\nThe lumped mass matrix is typically formed by distributing the total element mass, $M_e = \\rho A h_e$, to the nodes. A common method, row-sum lumping, involves summing the entries of each row of the consistent mass matrix and placing the result on the corresponding diagonal entry.\n$$m^e_{\\text{lump}, ii} = \\sum_{j} m^e_{\\text{cons}, ij}$$\nSum of row 1: $\\frac{\\rho A h_e}{6} (2+1) = \\frac{\\rho A h_e}{2}$.\nSum of row 2: $\\frac{\\rho A h_e}{6} (1+2) = \\frac{\\rho A h_e}{2}$.\nThis gives a diagonal matrix:\n$$\\mathbf{m}^e_{\\text{lump}} = \\frac{\\rho A h_e}{2} \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix}$$\nWith $h_e = L/2$, this becomes:\n$$\\mathbf{m}^e_{\\text{lump}} = \\frac{\\rho A L}{4} \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix}$$\n\n**5. Assembly of Global Matrices**\nThe global matrices are assembled by summing the contributions from element $1$ (connecting nodes $1$ and $2$) and element $2$ (connecting nodes $2$ and $3$). The global system has $3$ degrees of freedom ($u_1, u_2, u_3$).\n\nGlobal Stiffness Matrix $\\mathbf{K}$:\n$$\\mathbf{K} = \\frac{2EA}{L} \\begin{pmatrix} 1 & -1 & 0 \\\\ -1 & 1+1 & -1 \\\\ 0 & -1 & 1 \\end{pmatrix} = \\frac{2EA}{L} \\begin{pmatrix} 1 & -1 & 0 \\\\ -1 & 2 & -1 \\\\ 0 & -1 & 1 \\end{pmatrix}$$\nGlobal Consistent Mass Matrix $\\mathbf{M}_{\\text{cons}}$:\n$$\\mathbf{M}_{\\text{cons}} = \\frac{\\rho AL}{12} \\begin{pmatrix} 2 & 1 & 0 \\\\ 1 & 2+2 & 1 \\\\ 0 & 1 & 2 \\end{pmatrix} = \\frac{\\rho AL}{12} \\begin{pmatrix} 2 & 1 & 0 \\\\ 1 & 4 & 1 \\\\ 0 & 1 & 2 \\end{pmatrix}$$\nGlobal Lumped Mass Matrix $\\mathbf{M}_{\\text{lump}}$:\n$$\\mathbf{M}_{\\text{lump}} = \\frac{\\rho AL}{4} \\begin{pmatrix} 1 & 0 & 0 \\\\ 0 & 1+1 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix} = \\frac{\\rho AL}{4} \\begin{pmatrix} 1 & 0 & 0 \\\\ 0 & 2 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix}$$\n\n**6. Application of Boundary Condition**\nThe essential boundary condition $u(0,t)=0$ corresponds to $u_1=0$. This is imposed by removing the first row and first column from the global matrices. The remaining degrees of freedom are $u_2$ and $u_3$.\n\nReduced Stiffness Matrix $\\mathbf{K}_{\\text{red}}$:\n$$\\mathbf{K}_{\\text{red}} = \\frac{2EA}{L} \\begin{pmatrix} 2 & -1 \\\\ -1 & 1 \\end{pmatrix}$$\nReduced Consistent Mass Matrix $\\mathbf{M}_{\\text{cons,red}}$:\n$$\\mathbf{M}_{\\text{cons,red}} = \\frac{\\rho AL}{12} \\begin{pmatrix} 4 & 1 \\\\ 1 & 2 \\end{pmatrix}$$\nReduced Lumped Mass Matrix $\\mathbf{M}_{\\text{lump,red}}$:\n$$\\mathbf{M}_{\\text{lump,red}} = \\frac{\\rho AL}{4} \\begin{pmatrix} 2 & 0 \\\\ 0 & 1 \\end{pmatrix}$$\n\n**7. Solution of Eigenvalue Problems**\nWe must now solve the reduced eigenvalue problem $\\det(\\mathbf{K}_{\\text{red}} - \\omega^2 \\mathbf{M}_{\\text{red}}) = 0$ for both mass matrix formulations. Let $\\lambda = \\omega^2$.\n\n**Case A: Consistent Mass**\nThe eigenproblem is $\\det(\\mathbf{K}_{\\text{red}} - \\lambda_{\\text{cons}} \\mathbf{M}_{\\text{cons,red}}) = 0$.\n$$\\det\\left( \\frac{2EA}{L} \\begin{pmatrix} 2 & -1 \\\\ -1 & 1 \\end{pmatrix} - \\lambda_{\\text{cons}} \\frac{\\rho AL}{12} \\begin{pmatrix} 4 & 1 \\\\ 1 & 2 \\end{pmatrix} \\right) = 0$$\nLet $\\alpha = \\frac{2EA}{L}$ and $\\beta_c = \\frac{\\rho AL}{12}$.\n$$\\det \\begin{pmatrix} 2\\alpha - 4\\lambda_{\\text{cons}}\\beta_c & -\\alpha - \\lambda_{\\text{cons}}\\beta_c \\\\ -\\alpha - \\lambda_{\\text{cons}}\\beta_c & \\alpha - 2\\lambda_{\\text{cons}}\\beta_c \\end{pmatrix} = 0$$\n$$(2\\alpha - 4\\lambda_{\\text{cons}}\\beta_c)(\\alpha - 2\\lambda_{\\text{cons}}\\beta_c) - (-\\alpha - \\lambda_{\\text{cons}}\\beta_c)^2 = 0$$\n$$(2\\alpha^2 - 8\\alpha\\beta_c\\lambda_{\\text{cons}} + 8\\beta_c^2\\lambda_{\\text{cons}}^2) - (\\alpha^2 + 2\\alpha\\beta_c\\lambda_{\\text{cons}} + \\beta_c^2\\lambda_{\\text{cons}}^2) = 0$$\n$$7\\beta_c^2\\lambda_{\\text{cons}}^2 - 10\\alpha\\beta_c\\lambda_{\\text{cons}} + \\alpha^2 = 0$$\nThe roots for $\\lambda_{\\text{cons}}$ are:\n$$\\lambda_{\\text{cons}} = \\frac{10\\alpha\\beta_c \\pm \\sqrt{100\\alpha^2\\beta_c^2 - 4(7\\beta_c^2)(\\alpha^2)}}{14\\beta_c^2} = \\frac{\\alpha}{\\beta_c} \\frac{10 \\pm \\sqrt{72}}{14} = \\frac{\\alpha}{\\beta_c} \\frac{10 \\pm 6\\sqrt{2}}{14} = \\frac{\\alpha}{\\beta_c} \\frac{5 \\pm 3\\sqrt{2}}{7}$$\nThe fundamental frequency corresponds to the smaller eigenvalue:\n$$\\omega_{\\text{cons}}^2 = \\lambda_{\\text{cons,min}} = \\frac{\\alpha}{\\beta_c} \\frac{5 - 3\\sqrt{2}}{7} = \\frac{2EA/L}{\\rho AL/12} \\frac{5 - 3\\sqrt{2}}{7} = \\frac{24E}{\\rho L^2} \\frac{5 - 3\\sqrt{2}}{7}$$\n\n**Case B: Lumped Mass**\nThe eigenproblem is $\\det(\\mathbf{K}_{\\text{red}} - \\lambda_{\\text{lump}} \\mathbf{M}_{\\text{lump,red}}) = 0$.\n$$\\det\\left( \\frac{2EA}{L} \\begin{pmatrix} 2 & -1 \\\\ -1 & 1 \\end{pmatrix} - \\lambda_{\\text{lump}} \\frac{\\rho AL}{4} \\begin{pmatrix} 2 & 0 \\\\ 0 & 1 \\end{pmatrix} \\right) = 0$$\nLet $\\beta_l = \\frac{\\rho AL}{4}$.\n$$\\det \\begin{pmatrix} 2\\alpha - 2\\lambda_{\\text{lump}}\\beta_l & -\\alpha \\\\ -\\alpha & \\alpha - \\lambda_{\\text{lump}}\\beta_l \\end{pmatrix} = 0$$\n$$(2\\alpha - 2\\lambda_{\\text{lump}}\\beta_l)(\\alpha - \\lambda_{\\text{lump}}\\beta_l) - \\alpha^2 = 0$$\n$$2\\alpha^2 - 4\\alpha\\beta_l\\lambda_{\\text{lump}} + 2\\beta_l^2\\lambda_{\\text{lump}}^2 - \\alpha^2 = 0$$\n$$2\\beta_l^2\\lambda_{\\text{lump}}^2 - 4\\alpha\\beta_l\\lambda_{\\text{lump}} + \\alpha^2 = 0$$\nThe roots for $\\lambda_{\\text{lump}}$ are:\n$$\\lambda_{\\text{lump}} = \\frac{4\\alpha\\beta_l \\pm \\sqrt{16\\alpha^2\\beta_l^2 - 4(2\\beta_l^2)(\\alpha^2)}}{4\\beta_l^2} = \\frac{\\alpha}{\\beta_l} \\frac{4 \\pm \\sqrt{8}}{4} = \\frac{\\alpha}{\\beta_l} \\frac{4 \\pm 2\\sqrt{2}}{4} = \\frac{\\alpha}{\\beta_l} \\frac{2 \\pm \\sqrt{2}}{2}$$\nThe fundamental frequency corresponds to the smaller eigenvalue:\n$$\\omega_{\\text{lump}}^2 = \\lambda_{\\text{lump,min}} = \\frac{\\alpha}{\\beta_l} \\frac{2 - \\sqrt{2}}{2} = \\frac{2EA/L}{\\rho AL/4} \\frac{2 - \\sqrt{2}}{2} = \\frac{8E}{\\rho L^2} \\frac{2 - \\sqrt{2}}{2} = \\frac{4E}{\\rho L^2} (2 - \\sqrt{2})$$\n\n**8. Computation of the Ratio R**\nThe required ratio is $R = \\frac{\\omega_{\\text{cons}}}{\\omega_{\\text{lump}}}$. It is simpler to first compute $R^2$.\n$$R^2 = \\frac{\\omega_{\\text{cons}}^2}{\\omega_{\\text{lump}}^2} = \\frac{\\frac{24E}{\\rho L^2} \\frac{5 - 3\\sqrt{2}}{7}}{\\frac{4E}{\\rho L^2} (2 - \\sqrt{2})} = \\frac{24}{4} \\frac{5 - 3\\sqrt{2}}{7(2 - \\sqrt{2})} = \\frac{6}{7} \\frac{5 - 3\\sqrt{2}}{2 - \\sqrt{2}}$$\nTo simplify the fraction, we rationalize the denominator:\n$$\\frac{5 - 3\\sqrt{2}}{2 - \\sqrt{2}} = \\frac{(5 - 3\\sqrt{2})(2 + \\sqrt{2})}{(2 - \\sqrt{2})(2 + \\sqrt{2})} = \\frac{10 + 5\\sqrt{2} - 6\\sqrt{2} - 3(2)}{4 - 2} = \\frac{4 - \\sqrt{2}}{2}$$\nSubstituting this back into the expression for $R^2$:\n$$R^2 = \\frac{6}{7} \\left( \\frac{4 - \\sqrt{2}}{2} \\right) = \\frac{3(4 - \\sqrt{2})}{7}$$\nFinally, taking the square root gives the ratio $R$:\n$$R = \\sqrt{\\frac{3(4 - \\sqrt{2})}{7}}$$\nThis is the exact, simplified, closed-form analytical expression for the ratio.", "answer": "$$\\boxed{\\sqrt{\\frac{3(4 - \\sqrt{2})}{7}}}$$", "id": "3551458"}, {"introduction": "In real-world engineering analysis, finite element meshes are rarely composed of perfectly shaped elements. This practice investigates how geometric distortion, quantified by the condition number of the mapping's Jacobian matrix, can compromise the physical realism of standard row-sum mass lumping [@problem_id:3551430]. You will implement and compare different lumping strategies, gaining practical skills for building more robust and stable models for explicit dynamics simulations, especially when dealing with low-quality meshes.", "problem": "Consider a single four-node bilinear quadrilateral finite element in two-dimensional computational solid mechanics. Starting from the conservation of linear momentum and the Galerkin method, the semi-discrete equations of motion for the nodal displacement vector $\\mathbf{u}(t)$ read\n$$\n\\mathbf{M}\\,\\ddot{\\mathbf{u}}(t) + \\mathbf{K}\\,\\mathbf{u}(t) = \\mathbf{f}(t),\n$$\nwhere $\\mathbf{M}$ is the mass matrix, $\\mathbf{K}$ is the stiffness matrix, and $\\mathbf{f}(t)$ is the external force vector. For a four-node bilinear quadrilateral element, the consistent mass matrix $\\mathbf{M}_c$ is given by the domain integral\n$$\n\\mathbf{M}_c = \\int_{\\Omega_e} \\rho\\,t\\, \\mathbf{N}^\\top \\mathbf{N}\\,\\mathrm{d}\\Omega,\n$$\nwhere $\\rho$ is the mass density, $t$ is the thickness, $\\mathbf{N} = [N_1,N_2,N_3,N_4]$ collects the bilinear shape functions, and $\\Omega_e$ is the element domain in physical space. Through isoparametric mapping $\\mathbf{x}(\\xi,\\eta)$ from the reference square $\\hat{\\Omega} = [-1,1]\\times[-1,1]$ with coordinates $(\\xi,\\eta)$ to the physical element, the integral transforms as\n$$\n\\mathbf{M}_c = \\int_{\\hat{\\Omega}} \\rho\\,t\\, \\mathbf{N}^\\top(\\xi,\\eta) \\mathbf{N}(\\xi,\\eta)\\, \\det(\\mathbf{J}(\\xi,\\eta))\\, \\mathrm{d}\\xi\\,\\mathrm{d}\\eta,\n$$\nwhere $\\mathbf{J}(\\xi,\\eta) = \\dfrac{\\partial \\mathbf{x}}{\\partial (\\xi,\\eta)}$ is the mapping Jacobian. The lumped mass matrix $\\mathbf{M}_\\ell$ is a diagonal approximation of $\\mathbf{M}_c$ defined to preserve total element mass while redistributing it among nodes. In highly skewed elements, the mapping Jacobians $\\mathbf{J}(\\xi,\\eta)$ can have large condition numbers, which can cause pathological nodal mass distributions for $\\mathbf{M}_\\ell$ if naively computed. Your task is to:\n- Derive an algorithm to compute $\\mathbf{M}_c$ by numerical quadrature over $\\hat{\\Omega}$ using the bilinear shape functions and the isoparametric Jacobian $\\mathbf{J}(\\xi,\\eta)$.\n- Construct a diagonal lumped mass matrix $\\mathbf{M}_\\ell$ by applying the row-sum lumping method to $\\mathbf{M}_c$ and examine its nodal mass distribution.\n- Evaluate the condition number $\\kappa(\\mathbf{J}(\\xi,\\eta))$ of the Jacobian in the $2$-norm, defined by $\\kappa(\\mathbf{J}) = \\sigma_{\\max}(\\mathbf{J}) / \\sigma_{\\min}(\\mathbf{J})$, where $\\sigma_{\\max}$ and $\\sigma_{\\min}$ are the largest and smallest singular values obtained via Singular Value Decomposition (SVD).\n- Propose and implement two scaling techniques that stabilize the lumped mass matrix $\\mathbf{M}_\\ell$ under large $\\kappa(\\mathbf{J})$:\n  1. Determinant averaging (uniform lumping): replace the variable $\\det(\\mathbf{J}(\\xi,\\eta))$ in lumping by its element-average $\\overline{\\det(\\mathbf{J})}$ to obtain balanced nodal masses while preserving total mass.\n  2. Determinant clipping with renormalization: clip $\\det(\\mathbf{J}(\\xi,\\eta))$ to an interval $[\\alpha\\,\\overline{\\det(\\mathbf{J})},\\,\\beta\\,\\overline{\\det(\\mathbf{J})}]$ pointwise in quadrature, construct the diagonal $\\mathbf{M}_\\ell$ from the clipped determinants, and then renormalize the diagonal so that the total mass equals that of $\\mathbf{M}_c$.\n\nUse the following bilinear shape functions on $\\hat{\\Omega}$ for node ordering $\\{(-1,-1),(+1,-1),(+1,+1),(-1,+1)\\}$:\n$$\nN_1(\\xi,\\eta) = \\tfrac{1}{4}(1-\\xi)(1-\\eta),\\quad\nN_2(\\xi,\\eta) = \\tfrac{1}{4}(1+\\xi)(1-\\eta),\\quad\nN_3(\\xi,\\eta) = \\tfrac{1}{4}(1+\\xi)(1+\\eta),\\quad\nN_4(\\xi,\\eta) = \\tfrac{1}{4}(1-\\xi)(1+\\eta).\n$$\nThe isoparametric mapping is $\\mathbf{x}(\\xi,\\eta) = \\sum_{i=1}^{4} N_i(\\xi,\\eta)\\,\\mathbf{x}_i$, where $\\mathbf{x}_i$ are the physical node coordinates. The Jacobian is\n$$\n\\mathbf{J}(\\xi,\\eta) = \n\\begin{bmatrix}\n\\sum_{i=1}^{4} \\dfrac{\\partial N_i}{\\partial \\xi}(\\xi,\\eta)\\,x_i & \\sum_{i=1}^{4} \\dfrac{\\partial N_i}{\\partial \\eta}(\\xi,\\eta)\\,x_i \\\\\n\\sum_{i=1}^{4} \\dfrac{\\partial N_i}{\\partial \\xi}(\\xi,\\eta)\\,y_i & \\sum_{i=1}^{4} \\dfrac{\\partial N_i}{\\partial \\eta}(\\xi,\\eta)\\,y_i\n\\end{bmatrix}.\n$$\n\nNumerical settings:\n- Use mass density $\\rho = 7800\\,\\mathrm{kg/m^3}$ and thickness $t = 0.01\\,\\mathrm{m}$.\n- For computing $\\mathbf{M}_c$, use a tensor-product Gauss-Legendre quadrature with $2\\times 2$ points at $\\xi,\\eta \\in \\{\\pm 1/\\sqrt{3}\\}$ and unit weights in the reference domain.\n- For evaluating $\\kappa(\\mathbf{J})$, sample a uniform grid of $9\\times 9$ points over $\\hat{\\Omega}$ and report the maximum sampled condition number.\n- For determinant clipping, use $\\alpha = 0.5$ and $\\beta = 2.0$.\n\nTest suite:\nCompute the required quantities for the following four elements with physical node coordinates (in meters), ordered as $\\mathbf{x}_1,\\mathbf{x}_2,\\mathbf{x}_3,\\mathbf{x}_4$ corresponding to the reference nodes $\\{(-1,-1),(+1,-1),(+1,+1),(-1,+1)\\}$:\n- Case A (baseline square): $\\mathbf{x}_1 = (0, 0)$, $\\mathbf{x}_2 = (1, 0)$, $\\mathbf{x}_3 = (1, 1)$, $\\mathbf{x}_4 = (0, 1)$.\n- Case B (severely slanted trapezoid): $\\mathbf{x}_1 = (0, 0)$, $\\mathbf{x}_2 = (100, 0)$, $\\mathbf{x}_3 = (100, 1)$, $\\mathbf{x}_4 = (0, 0.02)$.\n- Case C (highly skewed trapezoid): $\\mathbf{x}_1 = (0, 0)$, $\\mathbf{x}_2 = (2, 0)$, $\\mathbf{x}_3 = (1.6, 0.02)$, $\\mathbf{x}_4 = (0.1, 0.98)$.\n- Case D (near-degenerate top edge): $\\mathbf{x}_1 = (0, 0)$, $\\mathbf{x}_2 = (1, 0)$, $\\mathbf{x}_3 = (1, 0.01)$, $\\mathbf{x}_4 = (0, 1)$.\n\nFor each case, compute:\n- The maximum sampled Jacobian condition number $\\kappa_{\\max}$ over the $9\\times 9$ grid.\n- The $2$-norm condition number of the consistent mass matrix, $\\kappa(\\mathbf{M}_c)$.\n- The ratio $r_{\\text{naive}} = \\max_i (M_{\\ell,ii}) / \\min_i (M_{\\ell,ii})$ for the row-sum lumped $\\mathbf{M}_\\ell$.\n- The ratio $r_{\\text{uniform}}$ for determinant averaging (uniform lumping).\n- The ratio $r_{\\text{clipped}}$ for determinant clipping with renormalization.\n\nAll ratios and condition numbers are dimensionless. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each case contributes an inner list of five floats rounded to six decimal places in the order $[\\kappa_{\\max}, \\kappa(\\mathbf{M}_c), r_{\\text{naive}}, r_{\\text{uniform}}, r_{\\text{clipped}}]$. For example, the output format must look like $[[a_1,a_2,a_3,a_4,a_5],[b_1,b_2,b_3,b_4,b_5],[c_1,c_2,c_3,c_4,c_5],[d_1,d_2,d_3,d_4,d_5]]$.", "solution": "The problem requires the computation and analysis of consistent and lumped mass matrices for a four-node bilinear quadrilateral finite element, particularly focusing on stabilization techniques for elements with significant geometric distortion. The solution involves implementing the finite element formulation for the mass matrix, evaluating metrics of distortion and stability, and applying corrective algorithms.\n\n### 1. Preliminaries: Bilinear Quadrilateral Element\n\nThe analysis is performed on a four-node quadrilateral element. The element's geometry and displacement field are interpolated from its nodal values using isoparametric mapping. The mapping from the reference square domain $\\hat{\\Omega} = [-1,1]\\times[-1,1]$ with local coordinates $(\\xi,\\eta)$ to the physical domain $\\Omega_e$ with global coordinates $\\mathbf{x}=(x,y)$ is given by:\n$$ \\mathbf{x}(\\xi,\\eta) = \\sum_{i=1}^{4} N_i(\\xi,\\eta)\\,\\mathbf{x}_i $$\nwhere $\\mathbf{x}_i$ are the coordinates of the four nodes and $N_i(\\xi,\\eta)$ are the bilinear shape functions. The shape functions for nodes ordered as $\\{(-1,-1),(+1,-1),(+1,+1),(-1,+1)\\}$ are:\n$$\n\\begin{aligned}\nN_1(\\xi,\\eta) &= \\tfrac{1}{4}(1-\\xi)(1-\\eta) \\\\\nN_2(\\xi,\\eta) &= \\tfrac{1}{4}(1+\\xi)(1-\\eta) \\\\\nN_3(\\xi,\\eta) &= \\tfrac{1}{4}(1+\\xi)(1+\\eta) \\\\\nN_4(\\xi,\\eta) &= \\tfrac{1}{4}(1-\\xi)(1+\\eta)\n\\end{aligned}\n$$\nA key property of these shape functions is that they form a partition of unity, i.e., $\\sum_{i=1}^{4} N_i(\\xi,\\eta) = 1$ for all $(\\xi,\\eta)$.\n\nThe transformation is described locally by the Jacobian matrix $\\mathbf{J}$, which relates derivatives in the physical and reference coordinate systems:\n$$\n\\mathbf{J}(\\xi,\\eta) = \\frac{\\partial \\mathbf{x}}{\\partial (\\xi,\\eta)} = \n\\begin{bmatrix}\n\\partial x/\\partial \\xi & \\partial x/\\partial \\eta \\\\\n\\partial y/\\partial \\xi & \\partial y/\\partial \\eta\n\\end{bmatrix}\n=\n\\begin{bmatrix}\n\\sum_{i=1}^{4} \\frac{\\partial N_i}{\\partial \\xi} x_i & \\sum_{i=1}^{4} \\frac{\\partial N_i}{\\partial \\eta} x_i \\\\\n\\sum_{i=1}^{4} \\frac{\\partial N_i}{\\partial \\xi} y_i & \\sum_{i=1}^{4} \\frac{\\partial N_i}{\\partial \\eta} y_i\n\\end{bmatrix}\n$$\nThe differential area element transforms as $\\mathrm{d}\\Omega = \\det(\\mathbf{J}(\\xi,\\eta))\\,\\mathrm{d}\\xi\\,\\mathrm{d}\\eta$. A non-uniform $\\det(\\mathbf{J})$ signifies geometric distortion.\n\n### 2. Consistent Mass Matrix and its Condition Number\n\nThe consistent mass matrix, $\\mathbf{M}_c$, is derived from the kinetic energy term in the weak form of the equations of motion. For a scalar field (like temperature, or as a basis for the vector displacement field), the $4\\times 4$ consistent mass matrix is:\n$$ \\mathbf{M}_c = \\int_{\\Omega_e} \\rho t \\mathbf{N}^\\top \\mathbf{N} \\, \\mathrm{d}\\Omega = \\int_{-1}^{1}\\int_{-1}^{1} \\rho t \\mathbf{N}^\\top(\\xi,\\eta) \\mathbf{N}(\\xi,\\eta) \\det(\\mathbf{J}(\\xi,\\eta)) \\, \\mathrm{d}\\xi \\mathrm{d}\\eta $$\nwhere $\\rho$ is the density, $t$ is the thickness, and $\\mathbf{N} = [N_1, N_2, N_3, N_4]$. This integral is evaluated numerically using a $2 \\times 2$ Gauss-Legendre quadrature rule. The quadrature points are $(\\xi_q, \\eta_q)$ for $q=1, \\dots, 4$ at coordinates $(\\pm 1/\\sqrt{3}, \\pm 1/\\sqrt{3})$, and all weights $w_q$ are $1$. The matrix is approximated as:\n$$ \\mathbf{M}_c \\approx \\rho t \\sum_{q=1}^{4} w_q \\left[ \\mathbf{N}^\\top(\\xi_q, \\eta_q) \\mathbf{N}(\\xi_q, \\eta_q) \\det(\\mathbf{J}(\\xi_q, \\eta_q)) \\right] $$\nThe condition number $\\kappa(\\mathbf{M}_c)$ is computed using the matrix $2$-norm, which is the ratio of its largest to smallest singular values (or eigenvalues, since $\\mathbf{M}_c$ is symmetric positive definite). A large condition number indicates that the matrix is close to singular, which can lead to numerical issues.\n\n### 3. Jacobian Condition Number\n\nThe condition number of the Jacobian, $\\kappa(\\mathbf{J}) = \\sigma_{\\max}(\\mathbf{J}) / \\sigma_{\\min}(\\mathbf{J})$, measures the distortion of the mapping from the reference square to the physical element. A value of $\\kappa(\\mathbf{J})=1$ corresponds to a mapping that locally preserves shape (i.e., it's a rotation and uniform scaling), while large values indicate severe shearing or stretching. We evaluate this quantity over a $9 \\times 9$ grid of points in $\\hat{\\Omega}$ and report the maximum value, $\\kappa_{\\max}$.\n\n### 4. Mass Lumping Techniques\n\nFor explicit time integration schemes, a diagonal (lumped) mass matrix is highly desirable as its inversion is trivial.\n\n#### 4.1. Naive Row-Sum Lumping\nThis is the most common lumping technique. The diagonal entries of the lumped mass matrix $\\mathbf{M}_\\ell$ are the row sums of the consistent mass matrix $\\mathbf{M}_c$:\n$$ M_{\\ell,ii} = \\sum_{j=1}^{4} M_{c,ij} $$\nUsing the partition of unity property ($\\sum_j N_j = 1$), this simplifies to an efficient calculation:\n$$ M_{\\ell,ii} = \\int_{\\Omega_e} \\rho t N_i \\left( \\sum_{j=1}^{4} N_j \\right) \\mathrm{d}\\Omega = \\int_{\\Omega_e} \\rho t N_i \\mathrm{d}\\Omega = \\int_{\\hat{\\Omega}} \\rho t N_i(\\xi, \\eta) \\det(\\mathbf{J}(\\xi,\\eta)) \\,\\mathrm{d}\\xi \\mathrm{d}\\eta $$\nNumerically:\n$$ M_{\\ell,ii}^{(\\text{naive})} = \\rho t \\sum_{q=1}^{4} w_q N_i(\\xi_q, \\eta_q) \\det(\\mathbf{J}(\\xi_q, \\eta_q)) $$\nIn highly distorted elements, variations in $\\det(\\mathbf{J})$ can lead to a poor distribution of mass, including an unphysical negative mass at a node, although this is not possible with the bilinear shape functions and non-inverted elements. The ratio $r_{\\text{naive}} = \\max_i(M_{\\ell,ii}) / \\min_i(M_{\\ell,ii})$ measures the non-uniformity of this distribution.\n\n#### 4.2. Stabilized Lumping 1: Determinant Averaging\nTo counteract the effect of a varying Jacobian determinant, this method replaces the pointwise determinant $\\det(\\mathbf{J})$ with its average value over the element, $\\overline{\\det(\\mathbf{J})} = A_e / A_{\\hat{\\Omega}}$, where $A_e$ is the physical element area and $A_{\\hat{\\Omega}}=4$ is the reference element area.\nThe physical area is $A_e = \\int_{\\hat{\\Omega}} \\det(\\mathbf{J}) \\,\\mathrm{d}\\xi\\mathrm{d}\\eta \\approx \\sum_q w_q \\det(\\mathbf{J}_q)$.\nThus, $\\overline{\\det(\\mathbf{J})} \\approx \\frac{1}{4}\\sum_q w_q \\det(\\mathbf{J}_q)$. The nodal mass is then:\n$$ M_{\\ell,ii}^{(\\text{uniform})} = \\rho t \\sum_{q=1}^{4} w_q N_i(\\xi_q, \\eta_q) \\overline{\\det(\\mathbf{J})} = \\rho t \\overline{\\det(\\mathbf{J})} \\sum_{q=1}^{4} w_q N_i(\\xi_q, \\eta_q) $$\nSince the $2 \\times 2$ Gauss quadrature exactly integrates the bilinear shape functions over the reference domain, $\\sum_q w_q N_i(\\xi_q, \\eta_q) = \\int_{\\hat{\\Omega}} N_i \\,\\mathrm{d}\\xi\\mathrm{d}\\eta = 1$.\nThis simplifies to $M_{\\ell,ii}^{(\\text{uniform})} = \\rho t \\overline{\\det(\\mathbf{J})} = \\rho t A_e / 4$. All nodal masses are equal, yielding a ratio $r_{\\text{uniform}} = 1$. This method preserves total mass.\n\n#### 4.3. Stabilized Lumping 2: Determinant Clipping and Renormalization\nThis method offers a compromise between the naive method and uniform averaging. It limits the influence of extreme local variations in $\\det(\\mathbf{J})$ while still retaining some local character.\n1.  **Clipping**: At each quadrature point $q$, the determinant $\\det(\\mathbf{J}_q)$ is clipped to a range defined by factors $\\alpha$ and $\\beta$ of the average determinant:\n    $$ \\det(\\mathbf{J}_q)^{\\text{clipped}} = \\max(\\alpha \\overline{\\det(\\mathbf{J})}, \\min(\\det(\\mathbf{J}_q), \\beta \\overline{\\det(\\mathbf{J})})) $$\n2.  **Pre-computation**: Unscaled lumped masses are computed using these clipped determinants:\n    $$ \\tilde{M}_{\\ell,ii}^{(\\text{clipped})} = \\rho t \\sum_{q=1}^{4} w_q N_i(\\xi_q, \\eta_q) \\det(\\mathbf{J}_q)^{\\text{clipped}} $$\n3.  **Renormalization**: The total mass from this procedure, $\\tilde{M}_{\\text{total}} = \\sum_i \\tilde{M}_{\\ell,ii}^{(\\text{clipped})}$, generally does not match the true element mass, $M_{\\text{total}} = \\rho t A_e$. A scaling factor $\\gamma = M_{\\text{total}} / \\tilde{M}_{\\text{total}}$ is computed and applied to enforce mass conservation:\n    $$ M_{\\ell,ii}^{(\\text{clipped})} = \\gamma \\, \\tilde{M}_{\\ell,ii}^{(\\text{clipped})} $$\nThe ratio $r_{\\text{clipped}}$ is then computed from these final mass values. This scheme moderates the mass distribution while strictly preserving the total element mass.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main solver function to process all test cases and print results.\n    \"\"\"\n\n    def compute_element_properties(coords, rho, t, alpha, beta):\n        \"\"\"\n        Computes the required quantities for a single quadrilateral element.\n\n        Args:\n            coords (np.ndarray): 4x2 array of nodal coordinates.\n            rho (float): Mass density.\n            t (float): Element thickness.\n            alpha (float): Lower bound factor for determinant clipping.\n            beta (float): Upper bound factor for determinant clipping.\n\n        Returns:\n            tuple: A 5-tuple containing [k_max_J, k_Mc, r_naive, r_uniform, r_clipped].\n        \"\"\"\n\n        # Quadrature points (2x2 Gauss-Legendre)\n        gp_val = 1.0 / np.sqrt(3.0)\n        gauss_points = np.array([\n            [-gp_val, -gp_val],\n            [gp_val, -gp_val],\n            [gp_val, gp_val],\n            [-gp_val, gp_val]\n        ])\n        gauss_weights = np.array([1.0, 1.0, 1.0, 1.0])\n        num_gp = len(gauss_points)\n\n        def shape_functions(xi, eta):\n            N = np.zeros(4)\n            N[0] = 0.25 * (1 - xi) * (1 - eta)\n            N[1] = 0.25 * (1 + xi) * (1 - eta)\n            N[2] = 0.25 * (1 + xi) * (1 + eta)\n            N[3] = 0.25 * (1 - xi) * (1 + eta)\n            return N\n\n        def shape_function_derivatives(xi, eta):\n            dNdxi = np.zeros(4)\n            dNdeta = np.zeros(4)\n            dNdxi[0] = -0.25 * (1 - eta)\n            dNdxi[1] = 0.25 * (1 - eta)\n            dNdxi[2] = 0.25 * (1 + eta)\n            dNdxi[3] = -0.25 * (1 + eta)\n            dNdeta[0] = -0.25 * (1 - xi)\n            dNdeta[1] = -0.25 * (1 + xi)\n            dNdeta[2] = 0.25 * (1 + xi)\n            dNdeta[3] = 0.25 * (1 - xi)\n            return dNdxi, dNdeta\n\n        def jacobian(xi, eta, node_coords):\n            dNdxi, dNdeta = shape_function_derivatives(xi, eta)\n            J = np.zeros((2, 2))\n            J[0, 0] = np.dot(dNdxi, node_coords[:, 0])  # dx/dxi\n            J[0, 1] = np.dot(dNdeta, node_coords[:, 0]) # dx/deta\n            J[1, 0] = np.dot(dNdxi, node_coords[:, 1])  # dy/dxi\n            J[1, 1] = np.dot(dNdeta, node_coords[:, 1]) # dy/deta\n            return J\n\n        # --- 1. Max Jacobian Condition Number ---\n        grid_points = np.linspace(-1, 1, 9)\n        kappa_J_values = []\n        for xi in grid_points:\n            for eta in grid_points:\n                J = jacobian(xi, eta, coords)\n                singular_values = np.linalg.svd(J, compute_uv=False)\n                if singular_values[1] < 1e-12:\n                    # Handle singular or near-singular case\n                    kappa_J = np.inf\n                else:\n                    kappa_J = singular_values[0] / singular_values[1]\n                kappa_J_values.append(kappa_J)\n        k_max_J = np.max(kappa_J_values)\n        \n        # --- Pre-computation at Gauss points ---\n        N_at_gp = np.array([shape_functions(gp[0], gp[1]) for gp in gauss_points])\n        detJ_at_gp = np.array([np.linalg.det(jacobian(gp[0], gp[1], coords)) for gp in gauss_points])\n\n        # --- 2. Consistent Mass Matrix & Condition Number ---\n        M_c = np.zeros((4, 4))\n        for q in range(num_gp):\n            N_q = N_at_gp[q, :].reshape(4, 1)\n            M_c += rho * t * (N_q @ N_q.T) * detJ_at_gp[q] * gauss_weights[q]\n        k_Mc = np.linalg.cond(M_c)\n\n        # Total element area and mass\n        area = np.sum(detJ_at_gp * gauss_weights)\n        total_mass = rho * t * area\n\n        # --- 3. Naive Row-Sum Lumping ---\n        M_l_naive = np.zeros(4)\n        for i in range(4):\n            M_l_naive[i] = rho * t * np.sum(N_at_gp[:, i] * detJ_at_gp * gauss_weights)\n        \n        if np.min(M_l_naive) > 1e-12:\n             r_naive = np.max(M_l_naive) / np.min(M_l_naive)\n        else:\n             r_naive = np.inf\n\n        # --- 4. Uniform Lumping ---\n        # All nodal masses are equal (total_mass / 4), so ratio is 1.0\n        r_uniform = 1.0\n\n        # --- 5. Determinant Clipping with Renormalization ---\n        detJ_avg = area / np.sum(gauss_weights)\n        detJ_min_clip = alpha * detJ_avg\n        detJ_max_clip = beta * detJ_avg\n        \n        detJ_clipped = np.clip(detJ_at_gp, detJ_min_clip, detJ_max_clip)\n\n        M_l_clipped_unscaled = np.zeros(4)\n        for i in range(4):\n            M_l_clipped_unscaled[i] = rho * t * np.sum(N_at_gp[:, i] * detJ_clipped * gauss_weights)\n\n        total_mass_clipped = np.sum(M_l_clipped_unscaled)\n        \n        renorm_factor = 1.0\n        if total_mass_clipped > 1e-12:\n            renorm_factor = total_mass / total_mass_clipped\n        \n        M_l_clipped = M_l_clipped_unscaled * renorm_factor\n        \n        if np.min(M_l_clipped) > 1e-12:\n            r_clipped = np.max(M_l_clipped) / np.min(M_l_clipped)\n        else:\n            r_clipped = np.inf\n\n        return k_max_J, k_Mc, r_naive, r_uniform, r_clipped\n\n    # Numerical settings from problem statement\n    RHO = 7800.0  # kg/m^3\n    T = 0.01     # m\n    ALPHA = 0.5\n    BETA = 2.0\n\n    # Test cases: physical node coordinates (x1, x2, x3, x4)\n    test_cases = [\n        # Case A: Baseline square\n        np.array([[0, 0], [1, 0], [1, 1], [0, 1]]),\n        # Case B: Severely slanted trapezoid\n        np.array([[0, 0], [100, 0], [100, 1], [0, 0.02]]),\n        # Case C: Highly skewed trapezoid\n        np.array([[0, 0], [2, 0], [1.6, 0.02], [0.1, 0.98]]),\n        # Case D: Near-degenerate top edge\n        np.array([[0, 0], [1, 0], [1, 0.01], [0, 1]]),\n    ]\n    \n    results = []\n    for coords in test_cases:\n        case_results = compute_element_properties(coords, RHO, T, ALPHA, BETA)\n        formatted_results = [f\"{val:.6f}\" for val in case_results]\n        results.append(f\"[{','.join(formatted_results)}]\")\n\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "3551430"}, {"introduction": "The choice between a consistent and a lumped mass matrix often involves a trade-off between accuracy and computational cost. This advanced exercise moves beyond a simple comparison of eigenvalues to analyze how each scheme propagates waves through the numerical grid, a property known as numerical dispersion [@problem_id:3551454]. By creating a 'blended' mass matrix, you will determine an optimal formulation that minimizes error for high-frequency waves, illustrating a powerful technique used in the development of high-fidelity numerical methods.", "problem": "Consider a one-dimensional homogeneous elastic bar of density $\\rho$, Young's modulus $E$, and constant cross-sectional area $A$. Small-amplitude axial motion $u(x,t)$ satisfies the linear wave equation derived from Newton's second law of motion and Hooke's law: $\\rho \\,\\partial_{tt} u - E \\,\\partial_{xx} u = 0$. Discretize the spatial domain with a uniform mesh of size $h$ using standard linear Lagrange finite elements, yielding the semi-discrete equation $M \\,\\ddot{\\mathbf{u}} + K \\,\\mathbf{u} = \\mathbf{0}$ for nodal displacements $\\mathbf{u}(t)$. Let $M_c$ denote the consistent mass matrix and $M_\\ell$ the lumped mass matrix. Consider the blended mass matrix $M(\\alpha) = \\alpha M_c + (1-\\alpha) M_\\ell$, where the blending parameter $\\alpha \\in [0,1]$ is to be chosen to minimize high-frequency dispersion error in the semi-discrete system.\n\nUsing the standard plane-wave ansatz on an infinite uniform lattice, the discrete dispersion relation of the generalized eigenproblem $K \\,\\boldsymbol{\\phi} = \\omega^2 M(\\alpha) \\,\\boldsymbol{\\phi}$ can be obtained and compared with the exact continuum dispersion relation $\\omega_c = c k$, where $c = \\sqrt{E/\\rho}$ is the wave speed and $k$ is the wavenumber. Define the dimensionless wavenumber $\\xi = k h$ restricted to the resolvable band $\\xi \\in [0,\\pi]$. In this problem, define the high-frequency dispersion error as the mismatch between the discrete angular frequency and the continuum angular frequency at the highest resolvable wavenumber $\\xi = \\pi$. Specifically, choose $\\alpha = \\alpha(h,\\rho)$ to enforce exact matching at $\\xi = \\pi$, that is, to satisfy $\\omega(\\alpha,\\pi) = \\omega_c(\\pi)$.\n\nYour tasks are:\n- Starting from the semi-discrete finite element model constructed from the linear wave equation and standard linear elements on a uniform mesh, derive the discrete dispersion relation $\\omega(\\alpha,\\xi)$ in terms of the material parameters $E$, $\\rho$, the mesh size $h$, and the blending parameter $\\alpha$.\n- Use this dispersion relation to determine the value $\\alpha(h,\\rho)$ that exactly matches the continuum angular frequency at $\\xi = \\pi$, i.e., $\\omega(\\alpha,\\pi) = \\omega_c(\\pi)$. Express this $\\alpha(h,\\rho)$ as a closed-form function.\n- Implement a program that computes $\\alpha(h,\\rho)$ for the following test suite of $(h,\\rho)$ values:\n    1. $(h,\\rho) = (0.01\\,\\text{m}, 7800\\,\\text{kg/m}^3)$,\n    2. $(h,\\rho) = (0.50\\,\\text{m}, 2700\\,\\text{kg/m}^3)$,\n    3. $(h,\\rho) = (10^{-6}\\,\\text{m}, 1000\\,\\text{kg/m}^3)$,\n    4. $(h,\\rho) = (0.123\\,\\text{m}, 8900\\,\\text{kg/m}^3)$.\n- The output for each test case must be the single floating-point value of $\\alpha$ (dimensionless). Report each $\\alpha$ rounded to $6$ decimal places.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[0.123456,0.234567,0.345678,0.456789]$).", "solution": "The problem as stated is valid. It is a well-posed problem in computational solid mechanics that is scientifically grounded in the principles of continuum mechanics and the finite element method. The provided information is self-contained, consistent, and sufficient for deriving a solution.\n\nThe solution proceeds in two stages. First, the discrete dispersion relation for the finite element model is derived. Second, this relation is used to find the blending parameter $\\alpha$ that satisfies the specified accuracy condition.\n\n**1. Derivation of the Discrete Dispersion Relation**\n\nThe governing partial differential equation for axial motion $u(x,t)$ in a one-dimensional elastic bar is the wave equation:\n$$ \\rho A \\,\\frac{\\partial^2 u}{\\partial t^2} - E A \\,\\frac{\\partial^2 u}{\\partial x^2} = 0 $$\nwhere $\\rho$ is the material density, $E$ is Young's modulus, and $A$ is the constant cross-sectional area.\n\nWe discretize this equation using standard linear Lagrange finite elements on a uniform mesh of size $h$. For a generic element of length $h$, the basis functions are $N_1(\\eta) = 1-\\eta$ and $N_2(\\eta) = \\eta$, where $\\eta=x/h$ is the local coordinate.\n\nThe element stiffness matrix $K^e$ is given by:\n$$ K^e = \\int_0^h E A \\begin{pmatrix} \\frac{dN_1}{dx} \\\\ \\frac{dN_2}{dx} \\end{pmatrix} \\begin{pmatrix} \\frac{dN_1}{dx} & \\frac{dN_2}{dx} \\end{pmatrix} dx = \\frac{EA}{h} \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix} $$\n\nThe element consistent mass matrix $M_c^e$ is given by:\n$$ M_c^e = \\int_0^h \\rho A \\begin{pmatrix} N_1 \\\\ N_2 \\end{pmatrix} \\begin{pmatrix} N_1 & N_2 \\end{pmatrix} dx = \\frac{\\rho A h}{6} \\begin{pmatrix} 2 & 1 \\\\ 1 & 2 \\end{pmatrix} $$\n\nThe element lumped mass matrix $M_\\ell^e$ is obtained via row-sum lumping, which places the sum of each row of $M_c^e$ onto the diagonal:\n$$ M_\\ell^e = \\frac{\\rho A h}{2} \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix} $$\n\nThe blended element mass matrix $M^e(\\alpha)$ is a linear combination of the consistent and lumped matrices:\n$$ M^e(\\alpha) = \\alpha M_c^e + (1-\\alpha) M_\\ell^e = \\alpha \\frac{\\rho A h}{6} \\begin{pmatrix} 2 & 1 \\\\ 1 & 2 \\end{pmatrix} + (1-\\alpha) \\frac{\\rho A h}{2} \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix} \\\\ = \\frac{\\rho A h}{6} \\left[ \\begin{pmatrix} 2\\alpha & \\alpha \\\\ \\alpha & 2\\alpha \\end{pmatrix} + \\begin{pmatrix} 3(1-\\alpha) & 0 \\\\ 0 & 3(1-\\alpha) \\end{pmatrix} \\right] = \\frac{\\rho A h}{6} \\begin{pmatrix} 3 - \\alpha & \\alpha \\\\ \\alpha & 3 - \\alpha \\end{pmatrix} $$\n\nFor an infinite, uniform mesh, the semi-discrete equation of motion for a generic node $j$, $M\\ddot{\\mathbf{u}} + K\\mathbf{u} = \\mathbf{0}$, can be written by assembling the contributions from the two adjacent elements, $(j-1, j)$ and $(j, j+1)$:\n$$ [M(\\alpha)\\ddot{\\mathbf{u}}]_j + [K\\mathbf{u}]_j = 0 $$\n$$ \\frac{\\rho A h}{6} \\left( \\alpha \\ddot{u}_{j-1} + 2(3 - \\alpha) \\ddot{u}_j + \\alpha \\ddot{u}_{j+1} \\right) + \\frac{EA}{h} \\left( -u_{j-1} + 2u_j - u_{j+1} \\right) = 0 $$\n\nWe analyze the dispersive properties of this system by substituting the plane-wave ansatz $u_j(t) = \\hat{\\phi} e^{i(kx_j - \\omega t)}$, where $x_j = jh$, $k$ is the wavenumber, and $\\omega$ is the angular frequency. This gives $u_{j\\pm1} = u_j e^{\\pm ikh}$ and $\\ddot{u}_j = -\\omega^2 u_j$. Introducing the dimensionless wavenumber $\\xi = kh$, the ansatz becomes $u_{j\\pm1} = u_j e^{\\pm i\\xi}$. Substituting this into the assembled equation and dividing by $u_j$ yields:\n$$ -\\omega^2 \\frac{\\rho A h}{6} \\left( \\alpha e^{-i\\xi} + 2(3 - \\alpha) + \\alpha e^{i\\xi} \\right) + \\frac{EA}{h} \\left( -e^{-i\\xi} + 2 - e^{i\\xi} \\right) = 0 $$\nUsing Euler's formula $e^{\\pm i\\xi} = \\cos\\xi \\pm i\\sin\\xi$, the equation simplifies:\n$$ -\\omega^2 \\frac{\\rho A h}{6} \\left( 2\\alpha\\cos\\xi + 2(3 - \\alpha) \\right) + \\frac{EA}{h} \\left( 2 - 2\\cos\\xi \\right) = 0 $$\nSolving for $\\omega^2$:\n$$ \\omega^2(\\alpha, \\xi) = \\frac{EA/h}{\\rho A h/6} \\frac{2(1-\\cos\\xi)}{2(\\alpha\\cos\\xi + 3 - \\alpha)} = \\frac{6E}{\\rho h^2} \\frac{1-\\cos\\xi}{3-\\alpha(1-\\cos\\xi)} $$\nUsing the half-angle identity $1 - \\cos\\xi = 2\\sin^2(\\xi/2)$, we get the discrete dispersion relation:\n$$ \\omega^2(\\alpha, \\xi) = \\frac{6E}{\\rho h^2} \\frac{2\\sin^2(\\xi/2)}{3-2\\alpha\\sin^2(\\xi/2)} = \\frac{12 c^2}{h^2} \\frac{\\sin^2(\\xi/2)}{3-2\\alpha\\sin^2(\\xi/2)} $$\nwhere $c = \\sqrt{E/\\rho}$ is the continuum wave speed. The discrete angular frequency is therefore:\n$$ \\omega(\\alpha, \\xi) = \\frac{c}{h} \\sqrt{ \\frac{12\\sin^2(\\xi/2)}{3-2\\alpha\\sin^2(\\xi/2)} } $$\n\n**2. Determination of the Blending Parameter $\\alpha$**\n\nThe problem requires us to choose $\\alpha$ such that the discrete angular frequency matches the exact continuum angular frequency, $\\omega_c(k) = ck$, at the highest resolvable wavenumber on the lattice, which corresponds to $\\xi = \\pi$.\nThe continuum frequency at $\\xi = \\pi$ is:\n$$ \\omega_c(\\pi) = c k |_{\\xi=\\pi} = c \\frac{\\pi}{h} $$\nThe discrete frequency at $\\xi = \\pi$ is found by substituting $\\xi=\\pi$ into our derived relation. At this point, $\\sin^2(\\xi/2) = \\sin^2(\\pi/2) = 1$.\n$$ \\omega^2(\\alpha, \\pi) = \\frac{12 c^2}{h^2} \\frac{1}{3-2\\alpha(1)} = \\frac{12 c^2}{h^2(3-2\\alpha)} $$\nEquating the squared frequencies, $(\\omega_c(\\pi))^2 = \\omega^2(\\alpha, \\pi)$:\n$$ \\left(c \\frac{\\pi}{h}\\right)^2 = \\frac{12 c^2}{h^2(3-2\\alpha)} \\implies \\frac{c^2 \\pi^2}{h^2} = \\frac{12 c^2}{h^2(3-2\\alpha)} $$\nThe terms $c^2/h^2$ cancel, yielding an equation for $\\alpha$ that is independent of all physical and discretization parameters ($E, \\rho, A, h$):\n$$ \\pi^2 = \\frac{12}{3-2\\alpha} \\implies 3-2\\alpha = \\frac{12}{\\pi^2} \\implies 2\\alpha = 3 - \\frac{12}{\\pi^2} $$\nSolving for $\\alpha$ gives the closed-form expression:\n$$ \\alpha = \\frac{3}{2} - \\frac{6}{\\pi^2} $$\nThe problem asks for $\\alpha(h, \\rho)$, which is a constant function in this case. The value of $\\alpha$ that satisfies the condition is independent of $h$ and $\\rho$. Therefore, the result will be the same for all test cases.\n\nNumerically, the value is:\n$$ \\alpha = 1.5 - \\frac{6}{9.8696044...} \\approx 1.5 - 0.6079271... \\approx 0.892072898... $$\nRounding to $6$ decimal places, we get $\\alpha = 0.892073$. This value is applied to all provided test cases.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the optimal mass matrix blending parameter alpha.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    # The parameters h and rho are not used in the final calculation,\n    # as the derived expression for alpha is a constant. This is an\n    # expected outcome of the dimensionless dispersion analysis.\n    test_cases = [\n        {'h': 0.01, 'rho': 7800},\n        {'h': 0.50, 'rho': 2700},\n        {'h': 10**-6, 'rho': 1000},\n        {'h': 0.123, 'rho': 8900},\n    ]\n\n    # As derived in the solution, the value of alpha that matches the continuum\n    # dispersion relation at the highest resolvable wavenumber (xi=pi) is\n    # a constant value given by alpha = 3/2 - 6/pi^2.\n    alpha_val = 1.5 - 6 / (np.pi**2)\n\n    # Since alpha is constant, the result is the same for all test cases.\n    results = [alpha_val for _ in test_cases]\n\n    # Format the results to 6 decimal places as required.\n    formatted_results = [f\"{res:.6f}\" for res in results]\n\n    # The final print statement must follow the exact specified format.\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "3551454"}]}