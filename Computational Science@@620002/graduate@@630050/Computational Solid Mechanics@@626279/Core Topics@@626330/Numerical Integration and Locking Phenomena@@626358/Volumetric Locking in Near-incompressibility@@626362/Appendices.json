{"hands_on_practices": [{"introduction": "To effectively diagnose and treat volumetric locking, we must first understand the kinematics of deformation at a fundamental level. This practice guides you through the essential tensor algebra that separates any given strain into its volume-changing (volumetric) and shape-changing (deviatoric) components. By constructing the precise mathematical projectors for these components [@problem_id:3609956], you will build the theoretical foundation needed to grasp why the incompressibility constraint, $\\operatorname{tr}(\\boldsymbol{\\varepsilon}) \\approx 0$, is so challenging for standard low-order elements.", "problem": "A central cause of volumetric locking in near-incompressibility is the improper mixing of volumetric and deviatoric deformation modes in low-order displacement-based finite elements. To analyze the kinematics underlying this phenomenon, consider the small-strain tensor defined by the kinematic relation $\\,\\boldsymbol{\\varepsilon} = \\tfrac{1}{2}\\left(\\nabla \\boldsymbol{u} + \\nabla \\boldsymbol{u}^{\\mathsf{T}}\\right)\\,$, the Frobenius inner product $\\,\\boldsymbol{A}:\\boldsymbol{B} = \\sum_{i,j} A_{ij} B_{ij}\\,$, and the decomposition of the space of symmetric second-order tensors into the one-dimensional subspace spanned by the identity tensor and its orthogonal complement.\n\n1) Using only the symmetry of the small-strain tensor and the orthogonal decomposition with respect to the Frobenius inner product, construct the unique fourth-order projection tensors $\\,\\mathbb{P}^{\\mathrm{vol}}\\,$ and $\\,\\mathbb{P}^{\\mathrm{dev}}\\,$ that map any symmetric tensor $\\,\\boldsymbol{A}\\,$ to its spherical (volumetric) part and deviatoric part, respectively. Derive their explicit components in index notation in terms of Kronecker deltas. You must not assume their forms; instead, determine them by imposing isotropy, idempotence, and orthogonality onto the subspaces spanned by $\\,\\boldsymbol{I}\\,$ and its orthogonal complement.\n\n2) Prove that these projectors satisfy $\\,\\mathbb{P}^{\\mathrm{vol}}:\\mathbb{P}^{\\mathrm{vol}}=\\mathbb{P}^{\\mathrm{vol}}\\,$, $\\,\\mathbb{P}^{\\mathrm{dev}}:\\mathbb{P}^{\\mathrm{dev}}=\\mathbb{P}^{\\mathrm{dev}}\\,$, $\\,\\mathbb{P}^{\\mathrm{vol}}:\\mathbb{P}^{\\mathrm{dev}}=\\mathbb{O}\\,$, and $\\,\\mathbb{P}^{\\mathrm{vol}}+\\mathbb{P}^{\\mathrm{dev}}=\\mathbb{I}^{\\mathrm{sym}}\\,$, where $\\,\\mathbb{I}^{\\mathrm{sym}}\\,$ is the symmetric fourth-order identity. Explain briefly how this decomposition isolates the kinematics constrained in the near-incompressible limit $\\,\\operatorname{tr}\\boldsymbol{\\varepsilon}\\approx 0\\,$, clarifying the link to volumetric locking in displacement-based formulations of the Finite Element Method (FEM).\n\n3) Let the given small-strain tensor be\n$$\n\\boldsymbol{\\varepsilon} \\;=\\;\n\\begin{pmatrix}\n3 & 2 & -1 \\\\\n2 & 1 & 0 \\\\\n-1 & 0 & -2\n\\end{pmatrix}.\n$$\nApply your deviatoric projector to compute the deviatoric strain $\\,\\boldsymbol{\\varepsilon}^{\\mathrm{dev}} = \\mathbb{P}^{\\mathrm{dev}}:\\boldsymbol{\\varepsilon}\\,$. Then compute the squared Frobenius norm $\\,\\|\\boldsymbol{\\varepsilon}^{\\mathrm{dev}}\\|_{F}^{2} = \\boldsymbol{\\varepsilon}^{\\mathrm{dev}}:\\boldsymbol{\\varepsilon}^{\\mathrm{dev}}\\,$. Provide your final answer as a single exact number with no units. Do not round.", "solution": "The problem is assessed to be valid as it is scientifically grounded in continuum mechanics and computational solid mechanics, well-posed, objective, and internally consistent. It presents a standard, yet non-trivial, exercise in tensor algebra and its application to understanding numerical artifacts in the Finite Element Method (FEM).\n\nThe solution proceeds in three parts as requested.\n\nPart 1: Construction of the Projection Tensors\n\nWe begin by considering the space of symmetric second-order tensors in three dimensions ($d=3$), which is a $6$-dimensional vector space. Any such tensor $\\boldsymbol{A}$ can be uniquely decomposed into a spherical (volumetric) part $\\boldsymbol{A}^{\\mathrm{vol}}$ and a deviatoric part $\\boldsymbol{A}^{\\mathrm{dev}}$ such that $\\boldsymbol{A} = \\boldsymbol{A}^{\\mathrm{vol}} + \\boldsymbol{A}^{\\mathrm{dev}}$.\n\nThe volumetric part $\\boldsymbol{A}^{\\mathrm{vol}}$ is defined to belong to the one-dimensional subspace spanned by the second-order identity tensor $\\boldsymbol{I}$. Thus, $\\boldsymbol{A}^{\\mathrm{vol}}$ must be of the form $\\boldsymbol{A}^{\\mathrm{vol}} = c\\boldsymbol{I}$ for some scalar $c$. The deviatoric part $\\boldsymbol{A}^{\\mathrm{dev}}$ belongs to the orthogonal complement of this subspace with respect to the Frobenius inner product. The condition for orthogonality is $\\boldsymbol{A}^{\\mathrm{dev}}:\\boldsymbol{I} = 0$. Since the trace of a tensor $\\boldsymbol{X}$ is given by $\\operatorname{tr}(\\boldsymbol{X}) = \\boldsymbol{X}:\\boldsymbol{I}$, this condition is equivalent to $\\operatorname{tr}(\\boldsymbol{A}^{\\mathrm{dev}}) = 0$.\n\nThe tensor $\\boldsymbol{A}^{\\mathrm{vol}}$ is the orthogonal projection of $\\boldsymbol{A}$ onto the subspace spanned by $\\boldsymbol{I}$. Using the standard formula for orthogonal projection in an inner product space, we have:\n$$\n\\boldsymbol{A}^{\\mathrm{vol}} = \\frac{\\boldsymbol{A}:\\boldsymbol{I}}{\\boldsymbol{I}:\\boldsymbol{I}} \\boldsymbol{I}\n$$\nWe compute the components of this expression. The numerator is the trace of $\\boldsymbol{A}$:\n$$\n\\boldsymbol{A}:\\boldsymbol{I} = A_{ij}\\delta_{ij} = A_{ii} = \\operatorname{tr}(\\boldsymbol{A})\n$$\nThe denominator is the squared norm of the identity tensor:\n$$\n\\boldsymbol{I}:\\boldsymbol{I} = \\delta_{ij}\\delta_{ij} = \\delta_{ii} = 3\n$$\nSubstituting these back, we find the expression for the volumetric part of $\\boldsymbol{A}$:\n$$\n\\boldsymbol{A}^{\\mathrm{vol}} = \\frac{\\operatorname{tr}(\\boldsymbol{A})}{3}\\boldsymbol{I}\n$$\nWe are seeking the fourth-order volumetric projection tensor $\\mathbb{P}^{\\mathrm{vol}}$ such that $\\boldsymbol{A}^{\\mathrm{vol}} = \\mathbb{P}^{\\mathrm{vol}}:\\boldsymbol{A}$. In index notation, this is $(\\boldsymbol{A}^{\\mathrm{vol}})_{ij} = (\\mathbb{P}^{\\mathrm{vol}})_{ijkl}A_{kl}$.\nFrom our derived expression, we have:\n$$\n(\\boldsymbol{A}^{\\mathrm{vol}})_{ij} = \\left(\\frac{1}{3} \\operatorname{tr}(\\boldsymbol{A})\\right)\\delta_{ij} = \\frac{1}{3} (A_{mm})\\delta_{ij}\n$$\nTo match the form $(\\mathbb{P}^{\\mathrm{vol}})_{ijkl}A_{kl}$, we write the trace using a Kronecker delta: $A_{mm} = \\delta_{kl}A_{kl}$.\n$$\n(\\boldsymbol{A}^{\\mathrm{vol}})_{ij} = \\frac{1}{3} \\delta_{ij}(\\delta_{kl}A_{kl}) = \\left(\\frac{1}{3}\\delta_{ij}\\delta_{kl}\\right)A_{kl}\n$$\nBy comparing the terms, we identify the components of the volumetric projection tensor:\n$$\n(\\mathbb{P}^{\\mathrm{vol}})_{ijkl} = \\frac{1}{3}\\delta_{ij}\\delta_{kl}\n$$\nThe deviatoric part is defined by subtraction: $\\boldsymbol{A}^{\\mathrm{dev}} = \\boldsymbol{A} - \\boldsymbol{A}^{\\mathrm{vol}}$. The corresponding deviatoric projection tensor $\\mathbb{P}^{\\mathrm{dev}}$ is therefore $\\mathbb{P}^{\\mathrm{dev}} = \\mathbb{I}^{\\mathrm{sym}} - \\mathbb{P}^{\\mathrm{vol}}$, where $\\mathbb{I}^{\\mathrm{sym}}$ is the symmetric fourth-order identity tensor. The action of $\\mathbb{I}^{\\mathrm{sym}}$ on any symmetric tensor $\\boldsymbol{A}$ is to return $\\boldsymbol{A}$ itself. Its components are given by:\n$$\n(\\mathbb{I}^{\\mathrm{sym}})_{ijkl} = \\frac{1}{2}(\\delta_{ik}\\delta_{jl} + \\delta_{il}\\delta_{jk})\n$$\nThus, the components of the deviatoric projection tensor are:\n$$\n(\\mathbb{P}^{\\mathrm{dev}})_{ijkl} = \\frac{1}{2}(\\delta_{ik}\\delta_{jl} + \\delta_{il}\\delta_{jk}) - \\frac{1}{3}\\delta_{ij}\\delta_{kl}\n$$\n\nPart 2: Projector Properties and Link to Volumetric Locking\n\nWe now prove the required properties using index notation and the double contraction rule $(\\mathbb{A}:\\mathbb{B})_{ijkl} = A_{ijmn}B_{mnkl}$.\n\n1.  Idempotence of $\\mathbb{P}^{\\mathrm{vol}}$: $\\mathbb{P}^{\\mathrm{vol}}:\\mathbb{P}^{\\mathrm{vol}}=\\mathbb{P}^{\\mathrm{vol}}$\n    $$\n    (\\mathbb{P}^{\\mathrm{vol}}:\\mathbb{P}^{\\mathrm{vol}})_{ijkl} = (\\mathbb{P}^{\\mathrm{vol}})_{ijmn}(\\mathbb{P}^{\\mathrm{vol}})_{mnkl} = \\left(\\frac{1}{3}\\delta_{ij}\\delta_{mn}\\right)\\left(\\frac{1}{3}\\delta_{mn}\\delta_{kl}\\right) = \\frac{1}{9}\\delta_{ij}\\delta_{kl}(\\delta_{mn}\\delta_{mn}) = \\frac{1}{9}\\delta_{ij}\\delta_{kl}(\\delta_{mm})\n    $$\n    Since $\\delta_{mm} = 3$, this becomes $\\frac{3}{9}\\delta_{ij}\\delta_{kl} = \\frac{1}{3}\\delta_{ij}\\delta_{kl} = (\\mathbb{P}^{\\mathrm{vol}})_{ijkl}$. The property is proven.\n\n2.  Orthogonality: $\\mathbb{P}^{\\mathrm{vol}}:\\mathbb{P}^{\\mathrm{dev}}=\\mathbb{O}$\n    We use the property that $\\mathbb{P}^{\\mathrm{dev}} = \\mathbb{I}^{\\mathrm{sym}} - \\mathbb{P}^{\\mathrm{vol}}$.\n    $$\n    \\mathbb{P}^{\\mathrm{vol}}:\\mathbb{P}^{\\mathrm{dev}} = \\mathbb{P}^{\\mathrm{vol}}:(\\mathbb{I}^{\\mathrm{sym}} - \\mathbb{P}^{\\mathrm{vol}}) = \\mathbb{P}^{\\mathrm{vol}}:\\mathbb{I}^{\\mathrm{sym}} - \\mathbb{P}^{\\mathrm{vol}}:\\mathbb{P}^{\\mathrm{vol}}\n    $$\n    The second term is $\\mathbb{P}^{\\mathrm{vol}}$ from the previous proof. For the first term:\n    $$\n    (\\mathbb{P}^{\\mathrm{vol}}:\\mathbb{I}^{\\mathrm{sym}})_{ijkl} = (\\mathbb{P}^{\\mathrm{vol}})_{ijmn}(\\mathbb{I}^{\\mathrm{sym}})_{mnkl} = \\left(\\frac{1}{3}\\delta_{ij}\\delta_{mn}\\right)\\left(\\frac{1}{2}(\\delta_{mk}\\delta_{nl} + \\delta_{ml}\\delta_{nk})\\right) = \\frac{1}{6}\\delta_{ij}(\\delta_{mn}\\delta_{mk}\\delta_{nl} + \\delta_{mn}\\delta_{ml}\\delta_{nk})\n    $$\n    $$\n    = \\frac{1}{6}\\delta_{ij}(\\delta_{nk}\\delta_{nl} + \\delta_{lk}\\delta_{nk}) = \\frac{1}{6}\\delta_{ij}(\\delta_{kl} + \\delta_{kl}) = \\frac{1}{3}\\delta_{ij}\\delta_{kl} = (\\mathbb{P}^{\\mathrm{vol}})_{ijkl}\n    $$\n    So, $\\mathbb{P}^{\\mathrm{vol}}:\\mathbb{I}^{\\mathrm{sym}} = \\mathbb{P}^{\\mathrm{vol}}$. Therefore, $\\mathbb{P}^{\\mathrm{vol}}:\\mathbb{P}^{\\mathrm{dev}} = \\mathbb{P}^{\\mathrm{vol}} - \\mathbb{P}^{\\mathrm{vol}} = \\mathbb{O}$. The property is proven.\n\n3.  Idempotence of $\\mathbb{P}^{\\mathrm{dev}}$: $\\mathbb{P}^{\\mathrm{dev}}:\\mathbb{P}^{\\mathrm{dev}}=\\mathbb{P}^{\\mathrm{dev}}$\n    $$\n    \\mathbb{P}^{\\mathrm{dev}}:\\mathbb{P}^{\\mathrm{dev}} = (\\mathbb{I}^{\\mathrm{sym}} - \\mathbb{P}^{\\mathrm{vol}}):(\\mathbb{I}^{\\mathrm{sym}} - \\mathbb{P}^{\\mathrm{vol}}) = \\mathbb{I}^{\\mathrm{sym}}:\\mathbb{I}^{\\mathrm{sym}} - \\mathbb{I}^{\\mathrm{sym}}:\\mathbb{P}^{\\mathrm{vol}} - \\mathbb{P}^{\\mathrm{vol}}:\\mathbb{I}^{\\mathrm{sym}} + \\mathbb{P}^{\\mathrm{vol}}:\\mathbb{P}^{\\mathrm{vol}}\n    $$\n    Since $\\mathbb{I}^{\\mathrm{sym}}$ is the identity, $\\mathbb{I}^{\\mathrm{sym}}:\\mathbb{I}^{\\mathrm{sym}} = \\mathbb{I}^{\\mathrm{sym}}$. We have shown $\\mathbb{I}^{\\mathrm{sym}}:\\mathbb{P}^{\\mathrm{vol}} = \\mathbb{P}^{\\mathrm{vol}}$ and $\\mathbb{P}^{\\mathrm{vol}}:\\mathbb{I}^{\\mathrm{sym}} = \\mathbb{P}^{\\mathrm{vol}}$, and $\\mathbb{P}^{\\mathrm{vol}}:\\mathbb{P}^{\\mathrm{vol}} = \\mathbb{P}^{\\mathrm{vol}}$.\n    Substituting these gives: $\\mathbb{I}^{\\mathrm{sym}} - \\mathbb{P}^{\\mathrm{vol}} - \\mathbb{P}^{\\mathrm{vol}} + \\mathbb{P}^{\\mathrm{vol}} = \\mathbb{I}^{\\mathrm{sym}} - \\mathbb{P}^{\\mathrm{vol}} = \\mathbb{P}^{\\mathrm{dev}}$. The property is proven.\n\n4.  Completeness: $\\mathbb{P}^{\\mathrm{vol}}+\\mathbb{P}^{\\mathrm{dev}}=\\mathbb{I}^{\\mathrm{sym}}$\n    This holds by the very definition of $\\mathbb{P}^{\\mathrm{dev}} = \\mathbb{I}^{\\mathrm{sym}} - \\mathbb{P}^{\\mathrm{vol}}$.\n\nLink to Volumetric Locking:\nIn near-incompressible elasticity, the material strongly resists volumetric changes, leading to the kinematic constraint $\\operatorname{tr}(\\boldsymbol{\\varepsilon}) \\approx 0$. This decomposition is crucial because it isolates the kinematic mode that is being constrained. The volumetric strain is $\\boldsymbol{\\varepsilon}^{\\mathrm{vol}} = \\mathbb{P}^{\\mathrm{vol}}:\\boldsymbol{\\varepsilon} = \\frac{1}{3}\\operatorname{tr}(\\boldsymbol{\\varepsilon})\\boldsymbol{I}$, so the incompressibility constraint is equivalent to demanding $\\boldsymbol{\\varepsilon}^{\\mathrm{vol}} \\approx \\boldsymbol{0}$.\nIn low-order displacement-based Finite Element formulations (e.g., linear triangles or tetrahedra), the displacement field $\\boldsymbol{u}$ is simple, which in turn restricts the strain field $\\boldsymbol{\\varepsilon}$ to be constant (or linear) over an element. The constraint $\\operatorname{tr}(\\boldsymbol{\\varepsilon}) = 0$ must be satisfied throughout the element. For a low-order element, this single equation can impose a disproportionately strong constraint on the limited number of available kinematic degrees of freedom. This can \"lock\" the element, making it artificially stiff because the only way for the simple interpolated displacement field to satisfy $\\operatorname{tr}(\\boldsymbol{\\varepsilon}) = 0$ everywhere is to adopt a trivial, zero-deformation state. The element is thus unable to represent valid shape-changing (deviatoric) deformations, such as pure shear, under the incompressibility constraint. This phenomenon is known as volumetric locking.\n\nPart 3: Application to a Given Strain Tensor\n\nWe are given the small-strain tensor:\n$$\n\\boldsymbol{\\varepsilon} = \\begin{pmatrix} 3 & 2 & -1 \\\\ 2 & 1 & 0 \\\\ -1 & 0 & -2 \\end{pmatrix}\n$$\nFirst, we compute the deviatoric strain $\\boldsymbol{\\varepsilon}^{\\mathrm{dev}} = \\boldsymbol{\\varepsilon} - \\boldsymbol{\\varepsilon}^{\\mathrm{vol}}$. We need the trace of $\\boldsymbol{\\varepsilon}$:\n$$\n\\operatorname{tr}(\\boldsymbol{\\varepsilon}) = 3 + 1 + (-2) = 2\n$$\nThe volumetric strain is:\n$$\n\\boldsymbol{\\varepsilon}^{\\mathrm{vol}} = \\frac{1}{3}\\operatorname{tr}(\\boldsymbol{\\varepsilon})\\boldsymbol{I} = \\frac{2}{3}\\begin{pmatrix} 1 & 0 & 0 \\\\ 0 & 1 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix} = \\begin{pmatrix} 2/3 & 0 & 0 \\\\ 0 & 2/3 & 0 \\\\ 0 & 0 & 2/3 \\end{pmatrix}\n$$\nNow, we subtract this from the total strain to find the deviatoric strain:\n$$\n\\boldsymbol{\\varepsilon}^{\\mathrm{dev}} = \\begin{pmatrix} 3 & 2 & -1 \\\\ 2 & 1 & 0 \\\\ -1 & 0 & -2 \\end{pmatrix} - \\begin{pmatrix} 2/3 & 0 & 0 \\\\ 0 & 2/3 & 0 \\\\ 0 & 0 & 2/3 \\end{pmatrix} = \\begin{pmatrix} 3 - \\frac{2}{3} & 2 & -1 \\\\ 2 & 1 - \\frac{2}{3} & 0 \\\\ -1 & 0 & -2 - \\frac{2}{3} \\end{pmatrix} = \\begin{pmatrix} \\frac{7}{3} & 2 & -1 \\\\ 2 & \\frac{1}{3} & 0 \\\\ -1 & 0 & -\\frac{8}{3} \\end{pmatrix}\n$$\nFinally, we compute the squared Frobenius norm of the deviatoric strain, $\\|\\boldsymbol{\\varepsilon}^{\\mathrm{dev}}\\|_{F}^{2} = \\boldsymbol{\\varepsilon}^{\\mathrm{dev}}:\\boldsymbol{\\varepsilon}^{\\mathrm{dev}}$, which is the sum of the squares of its components:\n$$\n\\|\\boldsymbol{\\varepsilon}^{\\mathrm{dev}}\\|_{F}^{2} = \\left(\\frac{7}{3}\\right)^2 + (2)^2 + (-1)^2 + (2)^2 + \\left(\\frac{1}{3}\\right)^2 + (0)^2 + (-1)^2 + (0)^2 + \\left(-\\frac{8}{3}\\right)^2\n$$\n$$\n\\|\\boldsymbol{\\varepsilon}^{\\mathrm{dev}}\\|_{F}^{2} = \\frac{49}{9} + 4 + 1 + 4 + \\frac{1}{9} + 0 + 1 + 0 + \\frac{64}{9}\n$$\n$$\n\\|\\boldsymbol{\\varepsilon}^{\\mathrm{dev}}\\|_{F}^{2} = \\left(\\frac{49}{9} + \\frac{1}{9} + \\frac{64}{9}\\right) + (4 + 1 + 4 + 1)\n$$\n$$\n\\|\\boldsymbol{\\varepsilon}^{\\mathrm{dev}}\\|_{F}^{2} = \\frac{114}{9} + 10 = \\frac{38}{3} + 10 = \\frac{38}{3} + \\frac{30}{3} = \\frac{68}{3}\n$$", "answer": "$$\\boxed{\\frac{68}{3}}$$", "id": "3609956"}, {"introduction": "With the kinematic decomposition established, we can now observe the locking phenomenon in a clear and controlled environment. This exercise presents a classic analytical problem: the uniform compression of an elastic block [@problem_id:3609974]. You will contrast the exact solution under perfect incompressibility, which predicts lateral expansion, with the pathologically stiff behavior of a single, displacement-based finite element that spuriously suppresses this expansion, thereby demonstrating the essence of volumetric locking.", "problem": "Consider small-strain, plane-strain, linear elasticity on the unit square domain $\\Omega = (0,1)\\times(0,1)$ with displacement vector field $u = (u_x,u_y)$ and Cauchy stress tensor $\\sigma$. The material is isotropic with shear modulus $\\mu>0$ and the Lamé parameter $\\lambda>0$; the incompressible limit corresponds to enforcing the kinematic constraint $\\nabla\\cdot u = 0$ with a Lagrange multiplier pressure $p$, and writing the constitutive law as $\\sigma = -p I + 2\\mu\\,\\epsilon(u)$, where $\\epsilon(u) = \\frac{1}{2}\\left(\\nabla u + \\nabla u^{\\top}\\right)$ is the small-strain tensor and $I$ is the identity tensor. In the standard displacement-only formulation, the constitutive law is written $\\sigma = \\lambda\\,\\operatorname{tr}(\\epsilon(u))\\,I + 2\\mu\\,\\epsilon(u)$.\n\nA vertical uniform compression is prescribed by the kinematic boundary conditions $u_y(x,1) = -\\delta$ and $u_y(x,0) = 0$ for some given $\\delta>0$. The lateral edges are intended to be free of traction; that is, on $x=0$ and $x=1$ one imposes $\\sigma\\,n = 0$ where $n$ is the outward unit normal.\n\nPart I (Exact incompressible baseline): Using the pressure-based incompressible formulation (with the constraint $\\nabla\\cdot u = 0$ enforced by $p$), derive the exact solution for $(u,p)$ that satisfies equilibrium, the above kinematic boundary conditions, and traction-free lateral edges. From this exact solution, compute the uniform vertical reaction traction $\\bar{t}_y^{\\text{exact}}$ on the top edge $y=1$ (the constant value of $\\sigma_{yy}$ along $y=1$).\n\nPart II (Quadrilateral four-node element locking scenario): Consider the displacement-only Quadrilateral four-node ($Q1$) Finite Element Method (FEM) on this single-element mesh with the same vertical kinematic boundary conditions. To emulate the common locking effect wherein lateral expansion is spuriously suppressed on coarse, displacement-only meshes under near-incompressibility, impose $u_x=0$ on the lateral edges $x=0$ and $x=1$. Using the displacement-only constitutive law $\\sigma = \\lambda\\,\\operatorname{tr}(\\epsilon(u))\\,I + 2\\mu\\,\\epsilon(u)$, compute the resulting uniform vertical reaction traction $\\bar{t}_y^{\\text{Q1}}$ on the top edge.\n\nPart III (Quantitative comparison): Form the ratio $R(\\lambda,\\mu)$ defined by\n$$\nR(\\lambda,\\mu) \\;=\\; \\frac{|\\bar{t}_y^{\\text{Q1}}|}{|\\bar{t}_y^{\\text{exact}}|},\n$$\nand simplify it to a closed-form expression in terms of $\\lambda$ and $\\mu$ only. This dimensionless ratio quantifies the over-stiffening that characterizes volumetric locking as the incompressible limit is approached. Provide the simplified analytic expression for $R(\\lambda,\\mu)$ as your final answer. No rounding is required, and no units should be included in your final expression.", "solution": "The problem asks for a quantitative comparison between the exact solution of an incompressible elasticity problem and a corresponding finite element solution exhibiting volumetric locking. The analysis is divided into three parts.\n\n### Part I: Exact Incompressible Baseline Solution\n\nThe governing equations for a small-strain, plane-strain, incompressible elastic material are the equilibrium equation and the incompressibility constraint:\n$$\n\\nabla \\cdot \\sigma = 0\n$$\n$$\n\\nabla \\cdot u = 0\n$$\nThe constitutive law relating the Cauchy stress tensor $\\sigma$ to the displacement field $u = (u_x, u_y)$ involves a Lagrange multiplier pressure $p$:\n$$\n\\sigma = -p I + 2\\mu\\,\\epsilon(u)\n$$\nwhere $\\mu > 0$ is the shear modulus, $I$ is the identity tensor, and $\\epsilon(u) = \\frac{1}{2}(\\nabla u + \\nabla u^{\\top})$ is the small-strain tensor.\n\nThe boundary conditions are:\n1.  Bottom edge ($y=0$): $u_y(x,0) = 0$.\n2.  Top edge ($y=1$): $u_y(x,1) = -\\delta$, for some $\\delta > 0$.\n3.  Lateral edges ($x=0, 1$): Traction-free, i.e., $\\sigma n = 0$, where $n$ is the outward normal.\n\nGiven the uniform vertical compression, we seek a solution where the vertical displacement $u_y$ is a function of $y$ only. The boundary conditions suggest a linear profile:\n$$\nu_y(x,y) = -\\delta y\n$$\nThis choice satisfies $u_y(x,0)=0$ and $u_y(x,1)=-\\delta$.\n\nNow, we use the incompressibility constraint $\\nabla \\cdot u = 0$:\n$$\n\\frac{\\partial u_x}{\\partial x} + \\frac{\\partial u_y}{\\partial y} = 0 \\implies \\frac{\\partial u_x}{\\partial x} + \\frac{\\partial}{\\partial y}(-\\delta y) = 0 \\implies \\frac{\\partial u_x}{\\partial x} = \\delta\n$$\nIntegrating with respect to $x$ gives:\n$$\nu_x(x,y) = \\delta x + C(y)\n$$\nwhere $C(y)$ is an arbitrary function of $y$.\n\nNext, we evaluate the components of the strain tensor $\\epsilon(u)$:\n$$\n\\epsilon_{xx} = \\frac{\\partial u_x}{\\partial x} = \\delta\n$$\n$$\n\\epsilon_{yy} = \\frac{\\partial u_y}{\\partial y} = -\\delta\n$$\n$$\n\\epsilon_{xy} = \\frac{1}{2}\\left(\\frac{\\partial u_x}{\\partial y} + \\frac{\\partial u_y}{\\partial x}\\right) = \\frac{1}{2}\\left(C'(y) + 0\\right) = \\frac{1}{2}C'(y)\n$$\n\nThe equilibrium equation $\\nabla \\cdot \\sigma = 0$ can be written using the Stokes flow equations by substituting the constitutive law: $-\\nabla p + \\mu \\nabla^2 u = 0$. In component form:\n$x$-component:\n$$\n-\\frac{\\partial p}{\\partial x} + \\mu \\left(\\frac{\\partial^2 u_x}{\\partial x^2} + \\frac{\\partial^2 u_x}{\\partial y^2}\\right) = 0 \\implies -\\frac{\\partial p}{\\partial x} + \\mu \\left(0 + C''(y)\\right) = 0 \\implies \\frac{\\partial p}{\\partial x} = \\mu C''(y)\n$$\n$y$-component:\n$$\n-\\frac{\\partial p}{\\partial y} + \\mu \\left(\\frac{\\partial^2 u_y}{\\partial x^2} + \\frac{\\partial^2 u_y}{\\partial y^2}\\right) = 0 \\implies - \\frac{\\partial p}{\\partial y} + \\mu(0+0) = 0 \\implies \\frac{\\partial p}{\\partial y} = 0\n$$\nThe $y$-component implies that pressure $p$ is a function of $x$ only, $p=p(x)$. Substituting this into the $x$-component equation, we have $\\frac{dp}{dx} = \\mu C''(y)$. Since the left side depends only on $x$ and the right side only on $y$, both must be equal to a constant, say $K$.\n$$\n\\frac{dp}{dx} = K \\implies p(x) = Kx + P_0\n$$\n$$\n\\mu C''(y) = K \\implies C'(y) = \\frac{K}{\\mu} y + A_1\n$$\nwhere $P_0$ and $A_1$ are constants of integration.\n\nNow we apply the traction-free boundary conditions on the lateral edges. At $x=0$, $n=(-1,0)$, and at $x=1$, $n=(1,0)$. The conditions are $\\sigma_{xx}(0,y)=0$, $\\sigma_{xy}(0,y)=0$ and $\\sigma_{xx}(1,y)=0$, $\\sigma_{xy}(1,y)=0$.\n\nThe stress components are:\n$$\n\\sigma_{xx} = -p + 2\\mu\\epsilon_{xx} = -(Kx+P_0) + 2\\mu\\delta\n$$\n$$\n\\sigma_{xy} = 2\\mu\\epsilon_{xy} = \\mu C'(y) = \\mu\\left(\\frac{K}{\\mu}y + A_1\\right) = Ky + \\mu A_1\n$$\nApplying $\\sigma_{xx}(0,y)=0$:\n$$\n-P_0 + 2\\mu\\delta = 0 \\implies P_0 = 2\\mu\\delta\n$$\nApplying $\\sigma_{xx}(1,y)=0$:\n$$\n-(K+P_0) + 2\\mu\\delta = 0 \\implies -K - (2\\mu\\delta) + 2\\mu\\delta = 0 \\implies K=0\n$$\nWith $K=0$, the pressure is constant: $p(x) = P_0 = 2\\mu\\delta$.\nNow, applying $\\sigma_{xy}(0,y)=0$:\n$$\nKy + \\mu A_1 = 0 \\implies (0)y + \\mu A_1 = 0 \\implies A_1 = 0\n$$\nThe condition on $x=1$ is automatically satisfied. Thus, all constants are determined. The displacement component $u_x$ is $u_x(x,y) = \\delta x + A_2$, where $A_2$ is a constant corresponding to rigid body motion which does not affect stresses. We can set $A_2=-\\delta/2$ to have $\\int_0^1 u_x(x,0)dx=0$, but it is not necessary for finding the stress.\n\nThe state of stress is uniform throughout the domain:\n$$\n\\sigma_{xx} = -(2\\mu\\delta) + 2\\mu\\delta = 0\n$$\n$$\n\\sigma_{yy} = -p + 2\\mu\\epsilon_{yy} = -(2\\mu\\delta) + 2\\mu(-\\delta) = -4\\mu\\delta\n$$\n$$\n\\sigma_{xy} = (0)y + \\mu(0) = 0\n$$\nThe vertical reaction traction on the top edge $y=1$ is the value of $\\sigma_{yy}$ along this edge.\n$$\n\\bar{t}_y^{\\text{exact}} = \\sigma_{yy}|_{y=1} = -4\\mu\\delta\n$$\n\n### Part II: Quadrilateral Four-Node Element Locking Scenario\n\nFor this part, we consider a single four-node bilinear quadrilateral ($Q1$) finite element occupying the domain $\\Omega$. The displacement field $(u_x, u_y)$ is interpolated from the nodal displacements. The boundary conditions are now applied to the nodes.\n-   $u_y(x,0)=0 \\implies u_{y1}=0, u_{y2}=0$\n-   $u_y(x,1)=-\\delta \\implies u_{y3}=-\\delta, u_{y4}=-\\delta$\n-   $u_x=0$ on lateral edges ($x=0,1$) $\\implies u_{x1}=u_{x4}=0$ and $u_{x2}=u_{x3}=0$.\nAll four nodal x-displacements are zero: $u_{x1}=u_{x2}=u_{x3}=u_{x4}=0$.\n\nThe displacement field for a $Q1$ element on the unit square is given by:\n$$\nu(x,y) = \\sum_{i=1}^4 N_i(x,y) u_i\n$$\nwhere $u_i = (u_{xi}, u_{yi})$ are nodal displacements, and the shape functions are:\n$N_1=(1-x)(1-y)$, $N_2=x(1-y)$, $N_3=xy$, $N_4=(1-x)y$.\n\nWith the specified nodal displacements:\n$$\nu_x(x,y) = \\sum N_i(x,y) u_{xi} = 0\n$$\n$$\nu_y(x,y) = N_1(0) + N_2(0) + N_3(-\\delta) + N_4(-\\delta) = -xy\\delta - (1-x)y\\delta = -y\\delta(x + 1 - x) = -y\\delta\n$$\nThe displacement field within the element is $u = (0, -\\delta y)$.\n\nNow, we compute the strain components from this displacement field:\n$$\n\\epsilon_{xx} = \\frac{\\partial u_x}{\\partial x} = 0\n$$\n$$\n\\epsilon_{yy} = \\frac{\\partial u_y}{\\partial y} = -\\delta\n$$\n$$\n\\epsilon_{xy} = \\frac{1}{2}\\left(\\frac{\\partial u_x}{\\partial y} + \\frac{\\partial u_y}{\\partial x}\\right) = 0\n$$\nThe volumetric strain is $\\operatorname{tr}(\\epsilon) = \\epsilon_{xx} + \\epsilon_{yy} = 0 - \\delta = -\\delta$.\n\nFor this part, we use the displacement-only constitutive law:\n$$\n\\sigma = \\lambda\\,\\operatorname{tr}(\\epsilon)\\,I + 2\\mu\\,\\epsilon\n$$\nwhere $\\lambda > 0$ is the other Lamé parameter.\nThe stress components are:\n$$\n\\sigma_{xx} = \\lambda(-\\delta) + 2\\mu(0) = -\\lambda\\delta\n$$\n$$\n\\sigma_{yy} = \\lambda(-\\delta) + 2\\mu(-\\delta) = -(\\lambda+2\\mu)\\delta\n$$\n$$\n\\sigma_{xy} = 2\\mu(0) = 0\n$$\nThe stress field is uniform. The vertical reaction traction on the top edge $y=1$ is:\n$$\n\\bar{t}_y^{\\text{Q1}} = \\sigma_{yy}|_{y=1} = -(\\lambda+2\\mu)\\delta\n$$\n\n### Part III: Quantitative Comparison\n\nWe form the ratio $R(\\lambda,\\mu) = \\frac{|\\bar{t}_y^{\\text{Q1}}|}{|\\bar{t}_y^{\\text{exact}}|}$.\nWe have $|\\bar{t}_y^{\\text{exact}}| = |-4\\mu\\delta| = 4\\mu\\delta$, since $\\mu, \\delta > 0$.\nWe have $|\\bar{t}_y^{\\text{Q1}}| = |-(\\lambda+2\\mu)\\delta| = (\\lambda+2\\mu)\\delta$, since $\\lambda, \\mu, \\delta > 0$.\n\nThe ratio is:\n$$\nR(\\lambda,\\mu) = \\frac{(\\lambda+2\\mu)\\delta}{4\\mu\\delta}\n$$\nThe factor $\\delta$ cancels out:\n$$\nR(\\lambda,\\mu) = \\frac{\\lambda+2\\mu}{4\\mu} = \\frac{\\lambda}{4\\mu} + \\frac{2\\mu}{4\\mu} = \\frac{\\lambda}{4\\mu} + \\frac{1}{2}\n$$\nThis ratio quantifies the overestimation of stiffness by the locked finite element model. As the material approaches the incompressible limit ($\\lambda \\to \\infty$), this ratio $R(\\lambda,\\mu)$ tends to infinity, which is the hallmark of volumetric locking.", "answer": "$$\\boxed{\\frac{\\lambda}{4\\mu} + \\frac{1}{2}}$$", "id": "3609974"}, {"introduction": "While simple compression illustrates locking, the phenomenon is most pronounced in bending-dominated problems. This hands-on computational exercise brings the concept into a practical engineering context by simulating a cantilever beam—a standard benchmark where volumetric locking leads to excessively stiff results [@problem_id:3609948]. You will implement a finite element model to first witness this numerical failure and then apply a widely used and effective remedy: selective reduced integration (SRI), quantitatively measuring the dramatic improvement in accuracy.", "problem": "Consider a two-dimensional small-strain linear elasticity model of a cantilever beam in plane strain, discretized by four-node bilinear quadrilateral finite elements. The beam has length $L$ in meters, height $H$ in meters, and out-of-plane thickness $b$ in meters. The left edge ($x=0$) is fully clamped, and a vertical downward point load of magnitude $P$ in Newtons is applied at the free end ($x=L$) at the node closest to mid-height ($y=H/2$). The objective is to quantify volumetric locking in near-incompressibility by comparing full versus selective reduced integration of the volumetric stiffness and to compute the relative error in tip deflection, expressed as a decimal.\n\nFundamental base:\n- Small-strain kinematics: the infinitesimal strain tensor is defined by $ \\varepsilon = \\tfrac{1}{2}(\\nabla \\mathbf{u} + (\\nabla \\mathbf{u})^T)$, where $\\mathbf{u}$ is the displacement field. In the two-dimensional plane strain setting, the engineering strain vector is $[\\varepsilon_{xx}, \\varepsilon_{yy}, \\gamma_{xy}]^T$, with $\\gamma_{xy} = 2 \\varepsilon_{xy}$.\n- Isotropic linear elasticity (Lamé parameters): the Cauchy stress is $ \\sigma = 2 \\mu \\, \\varepsilon + \\lambda \\, \\text{tr}(\\varepsilon) \\, I$. The bulk modulus $K$ and shear modulus $\\mu$ are related to the Lamé parameter $\\lambda$ by $ \\lambda = K - \\tfrac{2}{3} \\mu$. In a two-dimensional plane strain formulation using the engineering strain vector, the constitutive matrix $C_{\\text{full}}$ acting on $[\\varepsilon_{xx},\\varepsilon_{yy},\\gamma_{xy}]^T$ is\n$$\nC_{\\text{full}} = \\begin{bmatrix}\n\\lambda + 2\\mu & \\lambda & 0 \\\\\n\\lambda & \\lambda + 2\\mu & 0 \\\\\n0 & 0 & \\mu\n\\end{bmatrix}.\n$$\n- Selective reduced integration: decompose $C_{\\text{full}} = C_{\\text{dev}} + C_{\\text{vol}}$ with\n$$\nC_{\\text{dev}} = \\begin{bmatrix}\n2\\mu & 0 & 0 \\\\\n0 & 2\\mu & 0 \\\\\n0 & 0 & \\mu\n\\end{bmatrix}, \\quad\nC_{\\text{vol}} = \\begin{bmatrix}\n\\lambda & \\lambda & 0 \\\\\n\\lambda & \\lambda & 0 \\\\\n0 & 0 & 0\n\\end{bmatrix}.\n$$\nIntegrate $C_{\\text{dev}}$ with full $2\\times 2$ Gauss quadrature, and integrate $C_{\\text{vol}}$ with a single Gauss point at the element center (one-point quadrature) to reduce volumetric locking while avoiding hourglassing of the distortional modes.\n\nBeam reference tip deflection:\n- The analytical reference for the vertical tip deflection at mid-height for a slender cantilever beam under a tip load $P$ is given by the Euler–Bernoulli expression\n$$\n\\delta_{\\text{ref}} = \\frac{P L^3}{3 E I},\n$$\nwhere the Young’s modulus $E$ and Poisson’s ratio $\\nu$ follow from $K$ and $\\mu$ via $ E = \\frac{9 K \\mu}{3 K + \\mu}$ and $ \\nu = \\frac{3 K - 2 \\mu}{2(3 K + \\mu)}$, and where the second moment of area is $ I = \\frac{b H^3}{12}$. Express $\\delta_{\\text{ref}}$ in meters.\n\nFinite element approximation details:\n- Use four-node bilinear quadrilateral (Q4) isoparametric elements in plane strain. Construct the strain–displacement matrix $B$ from the derivatives of the shape functions with respect to the physical coordinates using the Jacobian of the isoparametric mapping. The element stiffness is\n$$\nK_e = \\int_{\\Omega_e} B^T C B \\, b \\, d\\Omega,\n$$\nwhere $b$ is the out-of-plane thickness, and $C$ is either $C_{\\text{full}}$ for the full integration case or the split $C_{\\text{dev}}$, $C_{\\text{vol}}$ integrated as specified above for the selective reduced integration case. Assemble the global stiffness matrix, apply essential boundary conditions of zero displacement on the left edge ($x=0$) for both $u_x$ and $u_y$, apply the point load $P$ in the negative $y$ direction at the free-end mid-height node, and solve the resulting linear system for nodal displacements.\n\nQuantity of interest and error measure:\n- Let $\\delta_{\\text{FE,full}}$ be the magnitude of the vertical displacement of the free-end mid-height node computed with full integration, and let $\\delta_{\\text{FE,sel}}$ be the corresponding magnitude computed with selective reduced integration. Compute the relative errors, expressed as decimals, by\n$$\ne_{\\text{full}} = \\frac{\\delta_{\\text{FE,full}} - \\delta_{\\text{ref}}}{\\delta_{\\text{ref}}}, \\quad\ne_{\\text{sel}} = \\frac{\\delta_{\\text{FE,sel}} - \\delta_{\\text{ref}}}{\\delta_{\\text{ref}}}.\n$$\nNo percentage sign is permitted.\n\nTest suite:\n- Use the following parameter sets, with all physical quantities in SI units:\n    - Case $1$: $L=1.0$, $H=0.2$, $b=0.1$, $P=1000.0$, $N_x=4$, $N_y=4$, $\\mu=1.0\\times 10^9$, $K/\\mu = 10$.\n    - Case $2$: $L=1.0$, $H=0.2$, $b=0.1$, $P=1000.0$, $N_x=4$, $N_y=4$, $\\mu=1.0\\times 10^9$, $K/\\mu = 1000$.\n    - Case $3$: $L=1.0$, $H=0.2$, $b=0.1$, $P=1000.0$, $N_x=8$, $N_y=8$, $\\mu=1.0\\times 10^9$, $K/\\mu = 1000$.\n    - Case $4$: $L=1.0$, $H=0.2$, $b=0.1$, $P=1000.0$, $N_x=2$, $N_y=2$, $\\mu=1.0\\times 10^9$, $K/\\mu = 100$.\n\nYour program must, for each case, compute $e_{\\text{full}}$ and $e_{\\text{sel}}$ as defined above. The final output format must be a single line containing a list of lists of the form $[[e_{\\text{full,1}},e_{\\text{sel,1}}],[e_{\\text{full,2}},e_{\\text{sel,2}}],[e_{\\text{full,3}},e_{\\text{sel,3}}],[e_{\\text{full,4}},e_{\\text{sel,4}}]]$. No additional text is permitted in the output. All angles, if any arise, must be in radians. All deflections must be computed in meters, and all forces in Newtons. The relative errors must be decimals (floating-point numbers).", "solution": "The problem is subjected to validation prior to any attempt at a solution.\n\n### Step 1: Extract Givens\n- **Model**: Two-dimensional small-strain linear elasticity, plane strain.\n- **Geometry**: Cantilever beam with length $L$, height $H$, out-of-plane thickness $b$.\n- **Boundary Conditions**: Left edge ($x=0$) is fully clamped ($u_x=0, u_y=0$).\n- **Loading**: Vertical downward point load of magnitude $P$ at the free end ($x=L$) at the node closest to mid-height ($y \\approx H/2$).\n- **Kinematics**: Infinitesimal strain tensor $\\varepsilon = \\tfrac{1}{2}(\\nabla \\mathbf{u} + (\\nabla \\mathbf{u})^T)$. Engineering strain vector is $[\\varepsilon_{xx}, \\varepsilon_{yy}, \\gamma_{xy}]^T$, where $\\gamma_{xy} = 2 \\varepsilon_{xy}$.\n- **Constitutive Law**: Isotropic linear elasticity, $\\sigma = 2 \\mu \\, \\varepsilon + \\lambda \\, \\text{tr}(\\varepsilon) \\, I$.\n- **Constitutive Matrix (Plane Strain)**:\n$$\nC_{\\text{full}} = \\begin{bmatrix}\n\\lambda + 2\\mu & \\lambda & 0 \\\\\n\\lambda & \\lambda + 2\\mu & 0 \\\\\n0 & 0 & \\mu\n\\end{bmatrix}\n$$\n- **Selective Reduced Integration (SRI) Decomposition**: $C_{\\text{full}} = C_{\\text{dev}} + C_{\\text{vol}}$, with\n$$\nC_{\\text{dev}} = \\begin{bmatrix}\n2\\mu & 0 & 0 \\\\\n0 & 2\\mu & 0 \\\\\n0 & 0 & \\mu\n\\end{bmatrix}, \\quad\nC_{\\text{vol}} = \\begin{bmatrix}\n\\lambda & \\lambda & 0 \\\\\n\\lambda & \\lambda & 0 \\\\\n0 & 0 & 0\n\\end{bmatrix}\n$$\n- **Integration Scheme**: For SRI, $C_{\\text{dev}}$ is integrated with full $2 \\times 2$ Gauss quadrature, and $C_{\\text{vol}}$ is integrated with one-point quadrature at the element center. For full integration, $C_{\\text{full}}$ is integrated with $2 \\times 2$ Gauss quadrature.\n- **Reference Deflection**: Euler–Bernoulli theory gives $\\delta_{\\text{ref}} = \\frac{P L^3}{3 E I}$, with $I = \\frac{b H^3}{12}$.\n- **Material Parameter Relations**: $E = \\frac{9 K \\mu}{3 K + \\mu}$, $\\nu = \\frac{3 K - 2 \\mu}{2(3 K + \\mu)}$, and $\\lambda = K - \\tfrac{2}{3} \\mu$.\n- **FE Discretization**: Four-node bilinear quadrilateral (Q4) isoparametric elements, with $N_x$ elements along the length and $N_y$ elements along the height.\n- **Element Stiffness**: $K_e = \\int_{\\Omega_e} B^T C B \\, b \\, d\\Omega$.\n- **Quantities of Interest**: $\\delta_{\\text{FE,full}}$ (full integration deflection), $\\delta_{\\text{FE,sel}}$ (SRI deflection).\n- **Error Measures**: $e_{\\text{full}} = \\frac{\\delta_{\\text{FE,full}} - \\delta_{\\text{ref}}}{\\delta_{\\text{ref}}}$, $e_{\\text{sel}} = \\frac{\\delta_{\\text{FE,sel}} - \\delta_{\\text{ref}}}{\\delta_{\\text{ref}}}$.\n- **Test Suite**:\n    - Case 1: $L=1.0, H=0.2, b=0.1, P=1000.0, N_x=4, N_y=4, \\mu=10^9, K/\\mu=10$.\n    - Case 2: $L=1.0, H=0.2, b=0.1, P=1000.0, N_x=4, N_y=4, \\mu=10^9, K/\\mu=1000$.\n    - Case 3: $L=1.0, H=0.2, b=0.1, P=1000.0, N_x=8, N_y=8, \\mu=10^9, K/\\mu=1000$.\n    - Case 4: $L=1.0, H=0.2, b=0.1, P=1000.0, N_x=2, N_y=2, \\mu=10^9, K/\\mu=100$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically grounded, well-posed, and objective.\n1.  **Scientific Soundness**: The problem is a standard application of the Finite Element Method (FEM) to linear elasticity, a fundamental theory in solid mechanics. The phenomenon of volumetric locking in nearly incompressible materials is a well-documented numerical artifact, and selective reduced integration is a classical technique to mitigate it. The provided equations for material properties, kinematics, and element formulation are standard in computational mechanics. The decomposition of the constitutive matrix, while a specific choice among a few possibilities, is a valid and commonly discussed approach for implementing B-bar type methods like SRI.\n2.  **Well-Posedness**: The problem is well-posed. The cantilever beam setup with specified boundary conditions and loading admits a unique solution in linear elasticity. The parameters and objectives are clearly defined, leading to a unique set of error values to be computed.\n3.  **Completeness and Consistency**: The problem statement is self-contained, providing all necessary physical parameters, geometric data, material laws, numerical procedures, and definitions required for a complete implementation. The test cases are fully specified. No contradictions are present.\n\n### Step 3: Verdict and Action\nThe problem is valid. A reasoned solution will be developed.\n\n### Solution\nThe problem requires the implementation of a two-dimensional finite element code to analyze a cantilever beam under plane strain conditions and quantify the effects of volumetric locking. We will compare results from a standard full integration scheme with those from a selective reduced integration scheme.\n\n#### Principle-Based Design\nThe solution is constructed based on the following principles of computational solid mechanics:\n\n1.  **Isoparametric Finite Element Formulation**: We use four-node quadrilateral (Q4) elements. The geometry of each element is mapped from a standard square parent domain $(\\xi, \\eta) \\in [-1, 1] \\times [-1, 1]$ to the physical domain $(x, y)$ using the same bilinear shape functions that are used to interpolate the displacement field. This is the essence of the isoparametric concept. The shape functions $N_i(\\xi, \\eta)$ for $i=1, 2, 3, 4$ are:\n    $$\n    N_1 = \\frac{1}{4}(1-\\xi)(1-\\eta), \\quad N_2 = \\frac{1}{4}(1+\\xi)(1-\\eta), \\quad N_3 = \\frac{1}{4}(1+\\xi)(1+\\eta), \\quad N_4 = \\frac{1}{4}(1-\\xi)(1+\\eta)\n    $$\n2.  **Strain-Displacement Matrix ($B$)**: The strain field is related to the nodal displacements via the strain-displacement matrix $B$. For a Q4 element with 8 degrees of freedom (DOFs), $B$ is a $3 \\times 8$ matrix. Its components are derived from the spatial derivatives of the shape functions. Since the shape functions are defined in the natural coordinate system, the chain rule is used, involving the inverse of the Jacobian matrix $J$ of the coordinate mapping:\n    $$\n    \\begin{bmatrix} \\frac{\\partial N_i}{\\partial x} \\\\ \\frac{\\partial N_i}{\\partial y} \\end{bmatrix} = J^{-1} \\begin{bmatrix} \\frac{\\partial N_i}{\\partial \\xi} \\\\ \\frac{\\partial N_i}{\\partial \\eta} \\end{bmatrix}\n    $$\n    The matrix $B$ is then assembled as $B = [B_1, B_2, B_3, B_4]$, where each $B_i$ sub-matrix for node $i$ is:\n    $$\n    B_i = \\begin{bmatrix} \\frac{\\partial N_i}{\\partial x} & 0 \\\\ 0 & \\frac{\\partial N_i}{\\partial y} \\\\ \\frac{\\partial N_i}{\\partial y} & \\frac{\\partial N_i}{\\partial x} \\end{bmatrix}\n    $$\n3.  **Numerical Integration**: The element stiffness matrix $K_e$ is computed by integrating over the element's volume. This integral is evaluated numerically using Gauss quadrature.\n    $$\n    K_e = \\int_{\\Omega_e} B^T C B \\, b \\, d\\Omega = b \\int_{-1}^{1}\\int_{-1}^{1} B(\\xi, \\eta)^T C B(\\xi, \\eta) \\det(J(\\xi, \\eta)) \\, d\\xi \\, d\\eta\n    $$\n    The integral is approximated by a weighted sum of the integrand evaluated at specific Gauss points. For a $2 \\times 2$ quadrature rule, there are four points at $(\\xi_j, \\eta_j) = (\\pm 1/\\sqrt{3}, \\pm 1/\\sqrt{3})$ with weights $w_j = 1$.\n\n4.  **Volumetric Locking and Selective Reduced Integration (SRI)**: For nearly incompressible materials ($\\nu \\to 0.5$, or equivalently $K/\\mu \\gg 1$), the bulk modulus $K$ and Lamé parameter $\\lambda$ become very large. The condition of incompressibility, $\\text{tr}(\\varepsilon) = \\varepsilon_{xx} + \\varepsilon_{yy} \\approx 0$, must be satisfied. In a standard Q4 element, the strain field is not constant. Full integration ($2 \\times 2$ quadrature) enforces the incompressibility constraint at four points, which is too stringent for the element's kinematic degrees of freedom. This \"over-constraining\" makes the element artificially stiff, a phenomenon known as volumetric locking.\n\n    SRI mitigates this by \"relaxing\" the incompressibility constraint. The stiffness matrix is split into a deviatoric part ($K_{e, \\text{dev}}$), which is integrated fully, and a volumetric part ($K_{e, \\text{vol}}$), which is under-integrated.\n    -   $K_{e, \\text{dev}} = b \\int_{\\Omega_e} B^T C_{\\text{dev}} B \\, d\\Omega$ is evaluated using the full $2 \\times 2$ Gauss quadrature rule. This preserves the element's ability to represent shear and other distortions accurately and prevents spurious zero-energy modes (hourglassing).\n    -   $K_{e, \\text{vol}} = b \\int_{\\Omega_e} B^T C_{\\text{vol}} B \\, d\\Omega$ is evaluated using a single Gauss point at the element's center $(\\xi, \\eta) = (0, 0)$ with weight $w = 4$. This enforces the incompressibility constraint only on average over the element, allowing it to bend more freely without a large energy penalty.\n\n5.  **Assembly and Solution**: The element stiffness matrices are assembled into a global stiffness matrix $K$. Boundary conditions are applied by modifying $K$ and the global force vector $F$. The clamped condition at $x=0$ means setting the DOFs corresponding to nodes on this edge to zero. The point load $P$ is added to the corresponding entry in $F$. The resulting linear system $K U = F$ is solved for the vector of nodal displacements $U$.\n\n#### Computational Steps\nFor each test case:\n1.  **Preprocessing**: Given $L, H, b, P, N_x, N_y, \\mu, K/\\mu$:\n    -   Calculate $K = \\mu \\cdot (K/\\mu)$.\n    -   Calculate Young's modulus $E = \\frac{9 K \\mu}{3 K + \\mu}$ and Poisson's ratio $\\nu = \\frac{3 K - 2 \\mu}{2(3 K + \\mu)}$.\n    -   Calculate the Lamé parameter $\\lambda = K - \\frac{2}{3} \\mu$.\n    -   Calculate the second moment of area $I = \\frac{b H^3}{12}$.\n    -   Calculate the reference tip deflection $\\delta_{\\text{ref}} = \\frac{P L^3}{3 E I}$.\n    -   Construct the material matrices $C_{\\text{full}}$, $C_{\\text{dev}}$, and $C_{\\text{vol}}$.\n    -   Generate a structured nodal grid and element connectivity list for the $N_x \\times N_y$ mesh.\n\n2.  **FEM Solver (run twice: for Full Integration and SRI)**:\n    -   Initialize a global stiffness matrix $K$ and force vector $F$ to zero.\n    -   Loop over all elements in the mesh. For each element:\n        -   Calculate the element stiffness matrix $K_e$.\n            -   For Full Integration: Use a $2 \\times 2$ Gauss quadrature on the term $B^T C_{\\text{full}} B$.\n            -   For Selective Reduced Integration: Sum the deviatoric part ($B^T C_{\\text{dev}} B$) integrated with $2 \\times 2$ quadrature and the volumetric part ($B^T C_{\\text{vol}} B$) integrated with $1$-point quadrature.\n        -   Assemble $K_e$ into the global matrix $K$ based on the element's nodal connectivity.\n    -   Apply the point load: find the node at $(x, y) = (L, H/2)$, determine its vertical DOF index, and set the corresponding entry in $F$ to $-P$.\n    -   Apply boundary conditions: identify all DOFs on the clamped edge ($x=0$) and modify $K$ and $F$ to enforce zero displacement (e.g., by setting diagonal entries of $K$ to 1, corresponding rows/columns to 0, and forcing the RHS to 0).\n    -   Solve the linear system $K U = F$ for the displacement vector $U$.\n    -   Extract the vertical displacement $u_y$ at the loaded node. The magnitude is $\\delta_{\\text{FE}} = |u_y| = -u_y$.\n\n3.  **Postprocessing**:\n    -   Using the computed deflections $\\delta_{\\text{FE,full}}$ and $\\delta_{\\text{FE,sel}}$, calculate the relative errors $e_{\\text{full}}$ and $e_{\\text{sel}}$ with respect to $\\delta_{\\text{ref}}$.\n    -   Collect the pairs $[e_{\\text{full}}, e_{\\text{sel}}]$ for each test case.\n\nThis procedure is implemented for each of the four test cases provided in the problem statement, and the results are aggregated into the required output format.", "answer": "```python\nimport numpy as np\nfrom scipy.linalg import solve as linsolve\n\ndef solve():\n    \"\"\"\n    Main function to solve the finite element problem for all test cases.\n    \"\"\"\n    test_cases = [\n        # L, H, b, P, Nx, Ny, mu, K_mu_ratio\n        (1.0, 0.2, 0.1, 1000.0, 4, 4, 1.0e9, 10.0),\n        (1.0, 0.2, 0.1, 1000.0, 4, 4, 1.0e9, 1000.0),\n        (1.0, 0.2, 0.1, 1000.0, 8, 8, 1.0e9, 1000.0),\n        (1.0, 0.2, 0.1, 1000.0, 2, 2, 1.0e9, 100.0),\n    ]\n\n    all_results = []\n    \n    for case in test_cases:\n        L, H, b, P, Nx, Ny, mu, K_mu_ratio = case\n        \n        # --- Preprocessing: Material and Reference Calculation ---\n        K = mu * K_mu_ratio\n        E = (9 * K * mu) / (3 * K + mu)\n        # nu = (3 * K - 2 * mu) / (2 * (3 * K + mu)) # Not directly needed for C-matrix\n        lmbda = K - (2.0 / 3.0) * mu\n        \n        I = (b * H**3) / 12.0\n        delta_ref = (P * L**3) / (3.0 * E * I)\n        \n        # --- Solve for Full Integration ---\n        delta_fe_full = run_fem_analysis(L, H, b, P, Nx, Ny, mu, lmbda, 'full')\n        e_full = (delta_fe_full - delta_ref) / delta_ref\n        \n        # --- Solve for Selective Reduced Integration ---\n        delta_fe_sel = run_fem_analysis(L, H, b, P, Nx, Ny, mu, lmbda, 'selective')\n        e_sel = (delta_fe_sel - delta_ref) / delta_ref\n        \n        all_results.append([e_full, e_sel])\n        \n    print(f\"[{','.join(map(str, all_results))}]\")\n\ndef run_fem_analysis(L, H, b, P, Nx, Ny, mu, lmbda, integration_type):\n    \"\"\"\n    Performs a single Finite Element Analysis for given parameters.\n    \"\"\"\n    # --- Mesh Generation ---\n    num_nodes_x = Nx + 1\n    num_nodes_y = Ny + 1\n    num_nodes = num_nodes_x * num_nodes_y\n    num_elements = Nx * Ny\n    num_dofs = 2 * num_nodes\n\n    x_coords = np.linspace(0, L, num_nodes_x)\n    y_coords = np.linspace(0, H, num_nodes_y)\n    node_coords = np.array([[x, y] for x in x_coords for y in y_coords])\n\n    elements = []\n    for i in range(Nx):\n        for j in range(Ny):\n            n1 = i * num_nodes_y + j\n            n2 = (i + 1) * num_nodes_y + j\n            n3 = (i + 1) * num_nodes_y + (j + 1)\n            n4 = i * num_nodes_y + (j + 1)\n            elements.append([n1, n2, n3, n4])\n    \n    elements = np.array(elements)\n    \n    # --- Constitutive Matrices ---\n    C_full = np.array([[lmbda + 2*mu, lmbda, 0],\n                       [lmbda, lmbda + 2*mu, 0],\n                       [0, 0, mu]])\n    \n    C_dev = np.array([[2*mu, 0, 0],\n                      [0, 2*mu, 0],\n                      [0, 0, mu]])\n\n    C_vol = np.array([[lmbda, lmbda, 0],\n                      [lmbda, lmbda, 0],\n                      [0, 0, 0]])\n\n    # --- Assembly ---\n    K_global = np.zeros((num_dofs, num_dofs))\n    F_global = np.zeros(num_dofs)\n\n    # Gauss quadrature points and weights\n    gp_pos = 1.0 / np.sqrt(3.0)\n    gauss_points_2x2 = [(-gp_pos, -gp_pos, 1.0), (gp_pos, -gp_pos, 1.0),\n                        (gp_pos, gp_pos, 1.0), (-gp_pos, gp_pos, 1.0)]\n    \n    for el_nodes in elements:\n        el_coords = node_coords[el_nodes]\n        Ke = np.zeros((8, 8))\n\n        if integration_type == 'full':\n            for xi, eta, w in gauss_points_2x2:\n                B, detJ = get_B_matrix_and_detJ(xi, eta, el_coords)\n                Ke += B.T @ C_full @ B * detJ * w * b\n        \n        elif integration_type == 'selective':\n            # Deviatoric part (2x2 integration)\n            for xi, eta, w in gauss_points_2x2:\n                B, detJ = get_B_matrix_and_detJ(xi, eta, el_coords)\n                Ke += B.T @ C_dev @ B * detJ * w * b\n            \n            # Volumetric part (1-point integration)\n            B_center, detJ_center = get_B_matrix_and_detJ(0.0, 0.0, el_coords)\n            w_center = 4.0\n            Ke += B_center.T @ C_vol @ B_center * detJ_center * w_center * b\n\n        # Assemble Ke into K_global\n        dof_indices = np.array([[2 * n, 2 * n + 1] for n in el_nodes]).flatten()\n        K_global[np.ix_(dof_indices, dof_indices)] += Ke\n\n    # --- Boundary Conditions and Loads ---\n    # Apply point load P\n    load_node_y_idx = Ny // 2\n    load_node_idx = Nx * num_nodes_y + load_node_y_idx\n    load_dof = 2 * load_node_idx + 1\n    F_global[load_dof] = -P\n\n    # Apply clamped boundary condition at x=0\n    clamped_nodes = np.arange(num_nodes_y)\n    clamped_dofs = []\n    for node_idx in clamped_nodes:\n        clamped_dofs.append(2 * node_idx)\n        clamped_dofs.append(2 * node_idx + 1)\n\n    for dof in clamped_dofs:\n        K_global[dof, :] = 0\n        K_global[:, dof] = 0\n        K_global[dof, dof] = 1.0\n        F_global[dof] = 0.0\n\n    # --- Solve ---\n    U = linsolve(K_global, F_global)\n\n    # --- Extract Result ---\n    tip_deflection_val = U[load_dof]\n    return -tip_deflection_val # Return magnitude\n\ndef get_B_matrix_and_detJ(xi, eta, el_coords):\n    \"\"\"\n    Computes the B-matrix and the determinant of the Jacobian for a Q4 element.\n    \"\"\"\n    # Derivatives of shape functions w.r.t. natural coordinates\n    dN_dxi = 0.25 * np.array([-(1 - eta), (1 - eta), (1 + eta), -(1 + eta)])\n    dN_deta = 0.25 * np.array([-(1 - xi), -(1 + xi), (1 + xi), (1 - xi)])\n    \n    # Jacobian matrix\n    J = np.zeros((2, 2))\n    J[0, 0] = np.dot(dN_dxi, el_coords[:, 0]) # dx/dxi\n    J[0, 1] = np.dot(dN_dxi, el_coords[:, 1]) # dy/dxi\n    J[1, 0] = np.dot(dN_deta, el_coords[:, 0]) # dx/deta\n    J[1, 1] = np.dot(dN_deta, el_coords[:, 1]) # dy/deta\n    \n    detJ = np.linalg.det(J)\n    invJ = np.linalg.inv(J)\n    \n    # Derivatives of shape functions w.r.t. physical coordinates\n    dN_cart = invJ @ np.vstack((dN_dxi, dN_deta))\n    dN_dx = dN_cart[0, :]\n    dN_dy = dN_cart[1, :]\n    \n    # B-matrix\n    B = np.zeros((3, 8))\n    for i in range(4):\n        B[0, 2*i] = dN_dx[i]\n        B[1, 2*i+1] = dN_dy[i]\n        B[2, 2*i] = dN_dy[i]\n        B[2, 2*i+1] = dN_dx[i]\n        \n    return B, detJ\n\nif __name__ == '__main__':\n    solve()\n```", "id": "3609948"}]}