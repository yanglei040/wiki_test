{"hands_on_practices": [{"introduction": "The cornerstone of any mixed finite element method is its variational formulation. This first practice guides you through the fundamental steps of deriving the mixed weak form for incompressible elasticity, starting from the principle of virtual work. You will then apply this framework to a concrete example by calculating the inf-sup quotient, which is a quantitative measure of the stability of the mixed formulation, a critical concept explored further in this chapter [@problem_id:3582046].", "problem": "Consider linear, small-strain, incompressible elasticity for a two-dimensional body occupying the rectangular domain $\\Omega = (0,2\\pi)\\times(0,2\\pi)$. Assume periodic boundary conditions on $\\partial \\Omega$ for all kinematic fields and zero-mean pressure. The material behavior is governed by a shear modulus $\\mu>0$ and the incompressibility constraint. Start from the principle of virtual work, the small-strain kinematics $\\boldsymbol{\\epsilon}(\\boldsymbol{u}) = \\tfrac{1}{2}(\\nabla \\boldsymbol{u} + (\\nabla \\boldsymbol{u})^{\\top})$, and the incompressibility constraint $\\nabla\\cdot \\boldsymbol{u} = 0$, and introduce a Lagrange multiplier field to enforce incompressibility.\n\nTasks:\n- Derive the mixed weak form of the incompressible elasticity problem by identifying appropriate function spaces $V$ and $Q$ that incorporate the boundary conditions and uniqueness conditions, and by expressing the bilinear and linear forms that appear in the resulting saddle-point problem. Clearly distinguish the deviatoric contribution of the strain. You may take the deviatoric part of any second-order tensor $\\boldsymbol{A}$ in spatial dimension $d$ to be $\\boldsymbol{A}^{d} = \\boldsymbol{A} - \\tfrac{1}{d}\\operatorname{tr}(\\boldsymbol{A})\\boldsymbol{I}$, and here use $d=2$.\n- Briefly explain, at the continuous level, how the Enhanced Assumed Strain (EAS) method enriches the strain space to alleviate volumetric locking and how this relates to the mixed formulation you have derived. No computation is required for this explanatory part.\n- Now fix the function spaces for this periodic setting as\n  - $V = \\{\\, \\boldsymbol{w} \\in [H^{1}_{\\mathrm{per}}(\\Omega)]^{2} : \\int_{\\Omega} \\boldsymbol{w}\\, d\\Omega = \\boldsymbol{0} \\,\\}$,\n  - $Q = L^{2}_{0}(\\Omega) = \\{\\, p \\in L^{2}(\\Omega) : \\int_{\\Omega} p\\, d\\Omega = 0 \\,\\}$,\n  and the bilinear form $b(\\cdot,\\cdot)$ that couples the divergence constraint with the pressure field as obtained in your derivation.\n- Using your $b(\\cdot,\\cdot)$ and the $H^{1}$- and $L^{2}$-norms defined by $\\|\\boldsymbol{w}\\|_{H^{1}(\\Omega)}^{2} = \\|\\boldsymbol{w}\\|_{L^{2}(\\Omega)}^{2} + \\|\\nabla \\boldsymbol{w}\\|_{L^{2}(\\Omega)}^{2}$ and $\\|p\\|_{L^{2}(\\Omega)}^{2} = \\int_{\\Omega} p^{2}\\, d\\Omega$, compute the value of the following inf-sup quotient for the specific pair\n  - $\\boldsymbol{w}(x,y) = \\big(-\\tfrac{1}{2}\\cos x \\cos y,\\; \\tfrac{1}{2}\\sin x \\sin y\\big)$,\n  - $p(x,y) = \\sin x \\cos y$,\n  on $\\Omega$:\n  $$\\beta_{\\star} \\;=\\; \\frac{\\left|\\, b(\\boldsymbol{w},p) \\,\\right|}{\\|\\boldsymbol{w}\\|_{H^{1}(\\Omega)}\\, \\|p\\|_{L^{2}(\\Omega)}}.$$\nProvide your final answer for $\\beta_{\\star}$ in exact, fully simplified analytic form. Do not round or approximate.", "solution": "**Part 1: Derivation of the Mixed Weak Form**\n\nWe begin with the principle of virtual work for a body $\\Omega$ with no body forces and periodic boundary conditions, which nullifies boundary integrals of tractions. The principle states that the internal virtual work is zero for any kinematically admissible virtual displacement $\\boldsymbol{w}$:\n$$\n\\int_{\\Omega} \\boldsymbol{\\sigma} : \\boldsymbol{\\epsilon}(\\boldsymbol{w}) \\, d\\Omega = 0\n$$\nHere, $\\boldsymbol{\\sigma}$ is the Cauchy stress tensor and $\\boldsymbol{\\epsilon}(\\boldsymbol{w}) = \\frac{1}{2}(\\nabla \\boldsymbol{w} + (\\nabla \\boldsymbol{w})^{\\top})$ is the virtual strain tensor corresponding to the virtual displacement field $\\boldsymbol{w}$.\n\nFor an incompressible elastic material, the stress tensor $\\boldsymbol{\\sigma}$ is decomposed into its deviatoric part $\\boldsymbol{\\sigma}'$ and a hydrostatic part determined by the pressure $p$, which acts as a Lagrange multiplier to enforce the incompressibility constraint $\\nabla \\cdot \\boldsymbol{u} = 0$. The constitutive relation is:\n$$\n\\boldsymbol{\\sigma} = \\boldsymbol{\\sigma}' - p\\boldsymbol{I} = 2\\mu\\boldsymbol{\\epsilon}^{d}(\\boldsymbol{u}) - p\\boldsymbol{I}\n$$\nwhere $\\mu > 0$ is the shear modulus, $\\boldsymbol{I}$ is the identity tensor, and $\\boldsymbol{\\epsilon}^{d}(\\boldsymbol{u})$ is the deviatoric part of the strain tensor $\\boldsymbol{\\epsilon}(\\boldsymbol{u})$. In two dimensions ($d=2$), the deviatoric part of a tensor $\\boldsymbol{A}$ is given by $\\boldsymbol{A}^{d} = \\boldsymbol{A} - \\frac{1}{2}\\operatorname{tr}(\\boldsymbol{A})\\boldsymbol{I}$. The solution for the displacement field $\\boldsymbol{u}$ must satisfy the incompressibility constraint $\\nabla \\cdot \\boldsymbol{u} = \\operatorname{tr}(\\boldsymbol{\\epsilon}(\\boldsymbol{u})) = 0$. Consequently, the strain tensor $\\boldsymbol{\\epsilon}(\\boldsymbol{u})$ is purely deviatoric, i.e., $\\boldsymbol{\\epsilon}^{d}(\\boldsymbol{u}) = \\boldsymbol{\\epsilon}(\\boldsymbol{u}) - \\frac{1}{2}\\operatorname{tr}(\\boldsymbol{\\epsilon}(\\boldsymbol{u}))\\boldsymbol{I} = \\boldsymbol{\\epsilon}(\\boldsymbol{u})$.\n\nSubstituting the constitutive law into the principle of virtual work:\n$$\n\\int_{\\Omega} (2\\mu\\boldsymbol{\\epsilon}^{d}(\\boldsymbol{u}) - p\\boldsymbol{I}) : \\boldsymbol{\\epsilon}(\\boldsymbol{w}) \\, d\\Omega = 0\n$$\nUsing the linearity of the trace and the inner product, this becomes:\n$$\n\\int_{\\Omega} 2\\mu\\boldsymbol{\\epsilon}^{d}(\\boldsymbol{u}) : \\boldsymbol{\\epsilon}(\\boldsymbol{w}) \\, d\\Omega - \\int_{\\Omega} p (\\boldsymbol{I} : \\boldsymbol{\\epsilon}(\\boldsymbol{w})) \\, d\\Omega = 0\n$$\nWe note that $\\boldsymbol{I} : \\boldsymbol{\\epsilon}(\\boldsymbol{w}) = \\operatorname{tr}(\\boldsymbol{\\epsilon}(\\boldsymbol{w})) = \\nabla \\cdot \\boldsymbol{w}$. Also, for the solution $\\boldsymbol{u}$, $\\boldsymbol{\\epsilon}^d(\\boldsymbol{u}) = \\boldsymbol{\\epsilon}(\\boldsymbol{u})$. The term $\\boldsymbol{\\epsilon}^{d}(\\boldsymbol{u}) : \\boldsymbol{\\epsilon}(\\boldsymbol{w})$ can be expanded by decomposing $\\boldsymbol{\\epsilon}(\\boldsymbol{w})$ into its deviatoric and volumetric parts: $\\boldsymbol{\\epsilon}(\\boldsymbol{w}) = \\boldsymbol{\\epsilon}^d(\\boldsymbol{w}) + \\frac{1}{2}(\\nabla \\cdot \\boldsymbol{w})\\boldsymbol{I}$.\n$$\n\\boldsymbol{\\epsilon}^{d}(\\boldsymbol{u}) : \\boldsymbol{\\epsilon}(\\boldsymbol{w}) = \\boldsymbol{\\epsilon}^{d}(\\boldsymbol{u}) : \\left(\\boldsymbol{\\epsilon}^d(\\boldsymbol{w}) + \\frac{1}{2}(\\nabla \\cdot \\boldsymbol{w})\\boldsymbol{I}\\right) = \\boldsymbol{\\epsilon}^{d}(\\boldsymbol{u}) : \\boldsymbol{\\epsilon}^d(\\boldsymbol{w}) + \\frac{1}{2}(\\nabla \\cdot \\boldsymbol{w}) (\\boldsymbol{\\epsilon}^{d}(\\boldsymbol{u}) : \\boldsymbol{I})\n$$\nSince $\\boldsymbol{\\epsilon}^d(\\boldsymbol{u})$ is deviatoric, its trace is zero, so $\\boldsymbol{\\epsilon}^{d}(\\boldsymbol{u}) : \\boldsymbol{I} = \\operatorname{tr}(\\boldsymbol{\\epsilon}^d(\\boldsymbol{u})) = 0$. Thus, $\\boldsymbol{\\epsilon}^{d}(\\boldsymbol{u}) : \\boldsymbol{\\epsilon}(\\boldsymbol{w}) = \\boldsymbol{\\epsilon}^{d}(\\boldsymbol{u}) : \\boldsymbol{\\epsilon}^d(\\boldsymbol{w})$.\n\nThe first equation of our weak form is:\n$$\n\\int_{\\Omega} 2\\mu\\boldsymbol{\\epsilon}^{d}(\\boldsymbol{u}) : \\boldsymbol{\\epsilon}^d(\\boldsymbol{w}) \\, d\\Omega - \\int_{\\Omega} p (\\nabla \\cdot \\boldsymbol{w}) \\, d\\Omega = 0\n$$\nThe second equation arises from the weak enforcement of the incompressibility constraint. We multiply $\\nabla \\cdot \\boldsymbol{u} = 0$ by a test function for the pressure, $q$, and integrate over $\\Omega$:\n$$\n\\int_{\\Omega} q (\\nabla \\cdot \\boldsymbol{u}) \\, d\\Omega = 0\n$$\nTo establish a symmetric saddle-point structure, we define the bilinear forms:\n$a(\\boldsymbol{u}, \\boldsymbol{w}) = \\int_{\\Omega} 2\\mu\\boldsymbol{\\epsilon}^{d}(\\boldsymbol{u}) : \\boldsymbol{\\epsilon}^{d}(\\boldsymbol{w}) \\, d\\Omega$\n$b(\\boldsymbol{w}, p) = -\\int_{\\Omega} p (\\nabla \\cdot \\boldsymbol{w}) \\, d\\Omega$\n\nThe mixed variational problem is to find $(\\boldsymbol{u}, p) \\in V \\times Q$ such that:\n$$\n\\begin{cases}\na(\\boldsymbol{u}, \\boldsymbol{w}) + b(\\boldsymbol{w}, p) = 0 & \\forall \\boldsymbol{w} \\in V \\\\\nb(\\boldsymbol{u}, q) = 0 & \\forall q \\in Q\n\\end{cases}\n$$\nThe function spaces $V$ and $Q$ must be chosen to ensure well-posedness and incorporate the boundary and uniqueness conditions. For the displacement field $\\boldsymbol{u}$ and test function $\\boldsymbol{w}$, we need square-integrable first derivatives, periodic boundary conditions, and a zero-mean condition to remove rigid body translations. For the pressure $p$ and its test function $q$, we require square-integrability and a zero-mean condition to ensure uniqueness. Thus, the appropriate spaces are:\n$V = \\{\\boldsymbol{w} \\in [H^{1}_{\\mathrm{per}}(\\Omega)]^{2} : \\int_{\\Omega} \\boldsymbol{w}\\, d\\Omega = \\boldsymbol{0} \\}$\n$Q = L^{2}_{0}(\\Omega) = \\{p \\in L^{2}(\\Omega) : \\int_{\\Omega} p\\, d\\Omega = 0 \\}$\n\n**Part 2: Explanation of the Enhanced Assumed Strain (EAS) Method**\n\nAt the continuous level, volumetric locking is a pathology that arises in the finite element discretization of problems with constraints, like incompressibility. Standard low-order displacement-based elements are too \"stiff\" because the discrete space for displacements cannot accurately represent the divergence-free fields required by the constraint. This results in a solution that is overly constrained, often leading to a pressure field that oscillates wildly and a displacement field that is trivially zero or near-zero.\n\nThe Enhanced Assumed Strain (EAS) method addresses this issue by enriching the strain field formulation directly, rather than by introducing a separate pressure field. The strain tensor $\\boldsymbol{\\epsilon}$ within each element is decomposed into a compatible part, $\\boldsymbol{\\epsilon}^{\\text{disp}}$, derived from the nodal displacements, and an incompatible, enhanced part, $\\tilde{\\boldsymbol{\\epsilon}}$:\n$$\n\\boldsymbol{\\epsilon} = \\boldsymbol{\\epsilon}^{\\text{disp}} + \\tilde{\\boldsymbol{\\epsilon}}\n$$\nThe enhanced strain $\\tilde{\\boldsymbol{\\epsilon}}$ is chosen from a space of functions defined locally on the element. It is not required to be derivable from a continuous displacement field, hence \"incompatible\". To ensure consistency and convergence (specifically, to pass the patch test), the enhanced strain is required to be orthogonal to the space of constant stresses over the element domain $K$, leading to the condition $\\int_{K} \\tilde{\\boldsymbol{\\epsilon}} \\, dV = \\boldsymbol{0}$.\n\nIn the context of incompressibility, the enhancement is targeted at the volumetric part of the strain. By enriching the volumetric strain, the element gains the flexibility needed to satisfy the incompressibility constraint in a weak sense without locking. This enriched kinematic description allows for a more accurate representation of the nearly-divergence-free deformation modes.\n\nThe connection to the mixed formulation is deep. The parameters defining the enhanced strain field $\\tilde{\\boldsymbol{\\epsilon}}$ act as internal degrees of freedom that can be statically condensed at the element level. It can be shown that for specific choices of enhancement spaces, the EAS method is mathematically equivalent to certain stable mixed $u/p$ formulations. The Lagrange multipliers associated with the orthogonality constraint on $\\tilde{\\boldsymbol{\\epsilon}}$ play a role analogous to the pressure variable $p$ in the mixed method.\n\n**Part 3: Computation of the Inf-Sup Quotient $\\beta_{\\star}$**\n\nWe are asked to compute the value of $\\beta_{\\star} = \\frac{|b(\\boldsymbol{w},p)|}{\\|\\boldsymbol{w}\\|_{H^{1}(\\Omega)} \\|p\\|_{L^{2}(\\Omega)}}$ for the specific functions:\n$\\boldsymbol{w}(x,y) = (-\\frac{1}{2}\\cos x \\cos y, \\frac{1}{2}\\sin x \\sin y)$\n$p(x,y) = \\sin x \\cos y$\non the domain $\\Omega = (0, 2\\pi) \\times (0, 2\\pi)$. The bilinear form is $b(\\boldsymbol{w},p) = -\\int_{\\Omega} p(\\nabla \\cdot \\boldsymbol{w}) \\, d\\Omega$.\n\nStep 1: Compute the numerator, $|b(\\boldsymbol{w},p)|$.\nFirst, we find the divergence of $\\boldsymbol{w}$:\n$$\n\\nabla \\cdot \\boldsymbol{w} = \\frac{\\partial w_1}{\\partial x} + \\frac{\\partial w_2}{\\partial y} = \\frac{\\partial}{\\partial x}\\left(-\\frac{1}{2}\\cos x \\cos y\\right) + \\frac{\\partial}{\\partial y}\\left(\\frac{1}{2}\\sin x \\sin y\\right)\n$$\n$$\n\\nabla \\cdot \\boldsymbol{w} = \\frac{1}{2}\\sin x \\cos y + \\frac{1}{2}\\sin x \\cos y = \\sin x \\cos y\n$$\nNow, we compute $b(\\boldsymbol{w},p)$:\n$$\nb(\\boldsymbol{w},p) = - \\int_0^{2\\pi} \\int_0^{2\\pi} (\\sin x \\cos y)(\\sin x \\cos y) \\, dx dy = - \\int_0^{2\\pi} \\sin^2 x \\, dx \\int_0^{2\\pi} \\cos^2 y \\, dy\n$$\nUsing the identities $\\int_0^{2\\pi} \\sin^2\\theta \\, d\\theta = \\pi$ and $\\int_0^{2\\pi} \\cos^2\\theta \\, d\\theta = \\pi$:\n$$\nb(\\boldsymbol{w},p) = -(\\pi)(\\pi) = -\\pi^2\n$$\nThe numerator is $|b(\\boldsymbol{w},p)| = |-\\pi^2| = \\pi^2$.\n\nStep 2: Compute the denominator, $\\|\\boldsymbol{w}\\|_{H^{1}(\\Omega)}\\|p\\|_{L^{2}(\\Omega)}$.\nFirst, we compute $\\|p\\|_{L^{2}(\\Omega)}$:\n$$\n\\|p\\|_{L^{2}(\\Omega)}^2 = \\int_{\\Omega} p^2 \\, d\\Omega = \\int_0^{2\\pi} \\int_0^{2\\pi} (\\sin x \\cos y)^2 \\, dx dy\n$$\n$$\n\\|p\\|_{L^{2}(\\Omega)}^2 = \\int_0^{2\\pi} \\sin^2 x \\, dx \\int_0^{2\\pi} \\cos^2 y \\, dy = (\\pi)(\\pi) = \\pi^2\n$$\nSo, $\\|p\\|_{L^{2}(\\Omega)} = \\sqrt{\\pi^2} = \\pi$.\n\nNext, we compute $\\|\\boldsymbol{w}\\|_{H^{1}(\\Omega)}$. The norm is defined by $\\|\\boldsymbol{w}\\|_{H^{1}(\\Omega)}^2 = \\|\\boldsymbol{w}\\|_{L^{2}(\\Omega)}^2 + \\|\\nabla \\boldsymbol{w}\\|_{L^{2}(\\Omega)}^2$.\nWe compute the $L^2$ norm of $\\boldsymbol{w}$:\n$$\n\\|\\boldsymbol{w}\\|_{L^{2}(\\Omega)}^2 = \\int_{\\Omega} (w_1^2 + w_2^2) \\, d\\Omega = \\int_0^{2\\pi}\\int_0^{2\\pi} \\left( \\left(-\\frac{1}{2}\\cos x \\cos y\\right)^2 + \\left(\\frac{1}{2}\\sin x \\sin y\\right)^2 \\right) \\, dx dy\n$$\n$$\n\\|\\boldsymbol{w}\\|_{L^{2}(\\Omega)}^2 = \\frac{1}{4} \\int_0^{2\\pi}\\int_0^{2\\pi} (\\cos^2 x \\cos^2 y + \\sin^2 x \\sin^2 y) \\, dx dy\n$$\n$$\n\\|\\boldsymbol{w}\\|_{L^{2}(\\Omega)}^2 = \\frac{1}{4} \\left( \\int_0^{2\\pi}\\cos^2 x dx \\int_0^{2\\pi}\\cos^2 y dy + \\int_0^{2\\pi}\\sin^2 x dx \\int_0^{2\\pi}\\sin^2 y dy \\right)\n$$\n$$\n\\|\\boldsymbol{w}\\|_{L^{2}(\\Omega)}^2 = \\frac{1}{4} ((\\pi)(\\pi) + (\\pi)(\\pi)) = \\frac{2\\pi^2}{4} = \\frac{\\pi^2}{2}\n$$\nNow we compute the $L^2$ norm of the gradient of $\\boldsymbol{w}$:\nThe gradient is $\\nabla \\boldsymbol{w} = \\begin{pmatrix} \\partial_x w_1 & \\partial_y w_1 \\\\ \\partial_x w_2 & \\partial_y w_2 \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{2}\\sin x \\cos y & \\frac{1}{2}\\cos x \\sin y \\\\ \\frac{1}{2}\\cos x \\sin y & \\frac{1}{2}\\sin x \\cos y \\end{pmatrix}$.\n$$\n\\|\\nabla \\boldsymbol{w}\\|_{L^{2}(\\Omega)}^2 = \\int_{\\Omega} (\\nabla \\boldsymbol{w} : \\nabla \\boldsymbol{w}) \\, d\\Omega = \\int_{\\Omega} \\left( (\\partial_x w_1)^2 + (\\partial_y w_1)^2 + (\\partial_x w_2)^2 + (\\partial_y w_2)^2 \\right) \\, d\\Omega\n$$\n$$\n\\|\\nabla \\boldsymbol{w}\\|_{L^{2}(\\Omega)}^2 = \\int_0^{2\\pi}\\int_0^{2\\pi} \\frac{1}{4} \\left( (\\sin^2 x \\cos^2 y) + (\\cos^2 x \\sin^2 y) + (\\cos^2 x \\sin^2 y) + (\\sin^2 x \\cos^2 y) \\right) \\, dx dy\n$$\n$$\n\\|\\nabla \\boldsymbol{w}\\|_{L^{2}(\\Omega)}^2 = \\frac{1}{2} \\int_0^{2\\pi}\\int_0^{2\\pi} (\\sin^2 x \\cos^2 y + \\cos^2 x \\sin^2 y) \\, dx dy\n$$\n$$\n\\|\\nabla \\boldsymbol{w}\\|_{L^{2}(\\Omega)}^2 = \\frac{1}{2} \\left( \\int\\sin^2 x dx \\int\\cos^2 y dy + \\int\\cos^2 x dx \\int\\sin^2 y dy \\right)\n= \\frac{1}{2} ((\\pi)(\\pi) + (\\pi)(\\pi)) = \\pi^2\n$$\nCombining the terms for the $H^1$ norm:\n$$\n\\|\\boldsymbol{w}\\|_{H^{1}(\\Omega)}^2 = \\|\\boldsymbol{w}\\|_{L^{2}(\\Omega)}^2 + \\|\\nabla \\boldsymbol{w}\\|_{L^{2}(\\Omega)}^2 = \\frac{\\pi^2}{2} + \\pi^2 = \\frac{3\\pi^2}{2}\n$$\nSo, $\\|\\boldsymbol{w}\\|_{H^{1}(\\Omega)} = \\sqrt{\\frac{3\\pi^2}{2}} = \\pi\\sqrt{\\frac{3}{2}}$.\n\nStep 3: Calculate $\\beta_{\\star}$.\n$$\n\\beta_{\\star} = \\frac{|b(\\boldsymbol{w},p)|}{\\|\\boldsymbol{w}\\|_{H^{1}(\\Omega)} \\|p\\|_{L^{2}(\\Omega)}} = \\frac{\\pi^2}{\\left(\\pi\\sqrt{\\frac{3}{2}}\\right)(\\pi)} = \\frac{\\pi^2}{\\pi^2\\sqrt{\\frac{3}{2}}} = \\frac{1}{\\sqrt{\\frac{3}{2}}} = \\sqrt{\\frac{2}{3}}\n$$\nSimplifying the final result:\n$$\n\\beta_{\\star} = \\frac{\\sqrt{2}}{\\sqrt{3}} = \\frac{\\sqrt{6}}{3}\n$$", "answer": "$$\\boxed{\\frac{\\sqrt{6}}{3}}$$", "id": "3582046"}, {"introduction": "The stability of a mixed formulation, governed by the Ladyzhenskaya–Babuška–Brezzi (LBB) condition, is not merely a theoretical curiosity; it is a practical necessity for obtaining meaningful numerical solutions. This exercise challenges you to diagnose a famously unstable element pair by identifying the \"spurious pressure mode\" that violates the LBB condition. Mastering this type of analysis provides the intuition needed to select appropriate and robust finite element technologies for constrained problems [@problem_id:3582079].", "problem": "Consider the mixed displacement–pressure formulation of linearized incompressible elasticity on a polygonal domain $\\Omega \\subset \\mathbb{R}^2$ with homogeneous Dirichlet boundary conditions for the displacement. Let the trial and test spaces be $V = [H^1_0(\\Omega)]^2$ and $Q = L^2_0(\\Omega)$, and the bilinear form associated with the incompressibility constraint be\n$$\nb(\\boldsymbol{v}, q) = \\int_{\\Omega} q \\, \\nabla \\cdot \\boldsymbol{v} \\, \\mathrm{d}\\Omega.\n$$\nThe Ladyzhenskaya–Babuška–Brezzi (LBB) condition (also called the inf–sup condition) requires the existence of a constant $\\beta > 0$, independent of the mesh size $h$, such that\n$$\n\\inf_{0 \\neq q_h \\in Q_h} \\sup_{0 \\neq \\boldsymbol{v}_h \\in V_h} \\frac{b(\\boldsymbol{v}_h, q_h)}{\\|\\boldsymbol{v}_h\\|_{H^1(\\Omega)} \\, \\|q_h\\|_{L^2(\\Omega)}} \\ge \\beta,\n$$\nwhere $V_h \\subset V$ and $Q_h \\subset Q$ are the discrete spaces. Consider a family of shape-regular, quasi-uniform, axis-aligned quadrilateral meshes $\\{\\mathcal{T}_h\\}$ that partition $\\Omega$ into rectangles. Let the discrete spaces be\n$$\nV_h = \\{\\boldsymbol{v}_h \\in [C^0(\\overline{\\Omega})]^2: \\ \\boldsymbol{v}_h|_{K} \\in [Q_1(K)]^2 \\ \\forall K \\in \\mathcal{T}_h, \\ \\boldsymbol{v}_h|_{\\partial \\Omega} = \\boldsymbol{0}\\},\n$$\n$$\nQ_h = \\{q_h \\in C^0(\\overline{\\Omega}) \\cap L^2_0(\\Omega): \\ q_h|_{K} \\in Q_1(K) \\ \\forall K \\in \\mathcal{T}_h\\},\n$$\nwhere $Q_1(K)$ denotes the space of bilinear polynomials on element $K$.\n\nYou are to decide which of the following options correctly constructs a nontrivial sequence $q_h \\in Q_h$ and provides a correct argument showing that the pair $[Q_1]^2$–$Q_1$ on quadrilaterals violates the LBB condition. Your choice must start from the mixed variational form and reason from first principles (polynomial structure and element-wise mappings), without invoking black-box stabilization results.\n\nA. On a uniform rectangular mesh, assign the pressure nodal values by $p_{i,j} = (-1)^{i+j}$ at mesh node indices $(i,j)$ and define $q_h \\in Q_h$ by continuous bilinear interpolation. On each element $K$, the restriction $q_h|_K$ equals a scaled $Q_1$ basis function proportional to the monomial $xy$ in the element’s local coordinates. Since for any $\\boldsymbol{v}_h \\in [Q_1]^2$, the divergence $\\nabla \\cdot \\boldsymbol{v}_h|_K$ lies in $\\operatorname{span}\\{1, x, y\\}$, it follows that\n$$\n\\int_K q_h \\, \\nabla \\cdot \\boldsymbol{v}_h \\, \\mathrm{d}\\Omega = 0\n$$\nby orthogonality of $xy$ with $\\{1, x, y\\}$ over a rectangle. Summing over elements gives $b(\\boldsymbol{v}_h, q_h) = 0$ for all $\\boldsymbol{v}_h \\in V_h$, while $\\|q_h\\|_{L^2(\\Omega)} > 0$ and $\\int_{\\Omega} q_h \\, \\mathrm{d}\\Omega = 0$. Therefore, the discrete inf–sup constant is $\\beta_h = 0$, violating the LBB condition.\n\nB. Take $q_h$ to be any nonzero constant function on $\\Omega$. Since $\\boldsymbol{v}_h \\in V_h$ vanishes on $\\partial \\Omega$, the divergence theorem implies $b(\\boldsymbol{v}_h, q_h) = \\int_{\\Omega} q_h \\, \\nabla \\cdot \\boldsymbol{v}_h \\, \\mathrm{d}\\Omega = q_h \\int_{\\partial \\Omega} \\boldsymbol{v}_h \\cdot \\boldsymbol{n} \\, \\mathrm{d}s = 0$ for all $\\boldsymbol{v}_h \\in V_h$, hence the LBB condition is violated.\n\nC. Use a triangular mesh and the equal-order continuous piecewise linear pair $[P_1]^2$–$P_1$ and argue by analogy that equal-order pairs are always unstable, so $[Q_1]^2$–$Q_1$ on quadrilaterals is unstable for the same reason.\n\nD. Add an Enhanced Assumed Strain (EAS) enrichment to the displacement space within $[Q_1]^2$ elements and argue that because EAS modifies strains independently of displacements, the mixed pair $[Q_1]^2$–$Q_1$ becomes unstable, demonstrating violation of the LBB condition.\n\nSelect the option that correctly constructs and justifies a counterexample sequence $q_h$ demonstrating violation of the LBB condition for $[Q_1]^2$–$Q_1$ on quadrilateral meshes, using only the polynomial structure of $Q_1$ and properties of $b(\\cdot,\\cdot)$ as the fundamental base.", "solution": "Option A provides the correct construction and reasoning. To violate the LBB condition, one must find a non-zero pressure mode $q_h \\in Q_h$ for which $b(\\boldsymbol{v}_h, q_h) = 0$ for all possible discrete displacement fields $\\boldsymbol{v}_h \\in V_h$.\n\n1.  **Construction of the Spurious Mode**: Option A constructs the classic \"checkerboard\" pressure mode by setting nodal values $p_{i,j} = (-1)^{i+j}$. The resulting continuous bilinear field $q_h$ is non-zero, has a zero mean integral over any uniform grid of rectangles (thus $\\int_{\\Omega} q_h \\, \\mathrm{d}\\Omega = 0$), and is an element of $Q_h$.\n2.  **Orthogonality Argument**: On each rectangular element $K$, this checkerboard mode is proportional to the monomial $xy$ in local coordinates. The divergence of a $[Q_1]^2$ displacement field, $\\nabla \\cdot \\boldsymbol{v}_h$, is a linear polynomial, belonging to $\\operatorname{span}\\{1, x, y\\}$.\n3.  **Demonstration of Violation**: Over a rectangular domain, the monomial $xy$ is $L^2$-orthogonal to all linear polynomials, i.e., $\\int_K (xy) \\cdot c \\, dA = 0$ for any $c \\in \\operatorname{span}\\{1, x, y\\}$. Therefore, the integral in the bilinear form vanishes on each element:\n    $$ \\int_K q_h \\, \\nabla \\cdot \\boldsymbol{v}_h \\, \\mathrm{d}A = 0 $$\n    Summing over all elements gives $b(\\boldsymbol{v}_h, q_h) = 0$ for all $\\boldsymbol{v}_h \\in V_h$. Since we have found a non-zero $q_h$ for which the supremum in the LBB condition is zero, the discrete inf-sup constant $\\beta_h$ must be zero, thus violating the condition.\n\n**Incorrect Options**:\n*   **B** is incorrect because a non-zero constant function is not in the space $Q_h \\subset L^2_0(\\Omega)$, which requires a zero mean.\n*   **C** is incorrect because it argues by analogy instead of providing a direct proof for the specified quadrilateral element.\n*   **D** is incorrect as it introduces EAS, which is a method to *fix* element deficiencies, not a tool to analyze the stability of the original mixed formulation.", "answer": "$$\\boxed{A}$$", "id": "3582079"}, {"introduction": "The Enhanced Assumed Strain (EAS) method offers a powerful framework for developing high-performance elements that avoid locking, particularly in the challenging context of nonlinear material behavior. For these methods to be computationally efficient, a consistent linearization is required to achieve quadratic convergence in a Newton-Raphson scheme. This advanced practice focuses on deriving the condensed consistent tangent matrix for a nonlinear EAS element, a key procedure in modern finite element code development [@problem_id:3582049].", "problem": "Consider a single finite element in a mixed variational formulation employing the Enhanced Assumed Strain (EAS) method for a small-strain hyperelastic solid. Let the element domain be denoted by $\\Omega_{e} \\subset \\mathbb{R}^{d}$, with $d \\in \\{2,3\\}$. The compatible strain field is $\\boldsymbol{\\varepsilon}^{c}(\\boldsymbol{u}) = \\boldsymbol{B}(\\boldsymbol{x}) \\boldsymbol{u}$, where $\\boldsymbol{u}$ is the vector of nodal displacements and $\\boldsymbol{B}(\\boldsymbol{x})$ is the standard strain-displacement matrix. The enhanced strain field is assumed as $\\boldsymbol{\\varepsilon}^{e}(\\boldsymbol{\\alpha}) = \\boldsymbol{E}(\\boldsymbol{x}) \\boldsymbol{\\alpha}$, where $\\boldsymbol{\\alpha}$ is the vector of internal EAS parameters and $\\boldsymbol{E}(\\boldsymbol{x})$ is a prescribed, element-local strain interpolation operator. The total strain is $\\boldsymbol{\\varepsilon}(\\boldsymbol{u},\\boldsymbol{\\alpha}) = \\boldsymbol{\\varepsilon}^{c}(\\boldsymbol{u}) + \\boldsymbol{\\varepsilon}^{e}(\\boldsymbol{\\alpha})$.\n\nAssume a hyperelastic stored energy density $\\Psi(\\boldsymbol{\\varepsilon})$ so that the Cauchy stress satisfies $\\boldsymbol{\\sigma}(\\boldsymbol{\\varepsilon}) = \\partial \\Psi / \\partial \\boldsymbol{\\varepsilon}$ and the consistent material tangent operator is $\\mathbb{C}_{t}(\\boldsymbol{\\varepsilon}) = \\partial^{2} \\Psi / \\partial \\boldsymbol{\\varepsilon} \\, \\partial \\boldsymbol{\\varepsilon}$, both evaluated at the current iterate. The total potential energy of the element is\n$$\n\\Pi(\\boldsymbol{u},\\boldsymbol{\\alpha}) = \\int_{\\Omega_{e}} \\Psi\\!\\left(\\boldsymbol{\\varepsilon}(\\boldsymbol{u},\\boldsymbol{\\alpha})\\right) \\, \\mathrm{d}\\Omega - \\boldsymbol{f}_{e}^{\\mathrm{ext}} \\! \\cdot \\boldsymbol{u},\n$$\nwhere $\\boldsymbol{f}_{e}^{\\mathrm{ext}}$ is the external nodal force vector assembled over $\\Omega_{e}$.\n\nStarting from the principle of stationary potential energy, derive the mixed residual equations for $\\boldsymbol{u}$ and $\\boldsymbol{\\alpha}$, and perform an exact first-order linearization with respect to $(\\boldsymbol{u},\\boldsymbol{\\alpha})$ to obtain the block Newton system for the element. Then, to preserve quadratic Newton convergence under static condensation, condense the internal EAS parameters at the tangent level by eliminating $\\Delta \\boldsymbol{\\alpha}$ from the block system. Compute the resulting consistent tangent matrix of the condensed displacement-only system in closed form. Express your final answer as a single analytic expression in terms of the block tangent matrices emerging from the linearization.\n\nNo numerical evaluation is required. Your final expression must be analytic and self-contained. Do not include any units in the final expression.", "solution": "The starting point for the derivation is the principle of stationary potential energy applied to the provided functional for a single finite element. The total potential energy, $\\Pi$, is a function of the nodal displacements $\\boldsymbol{u}$ and the internal Enhanced Assumed Strain (EAS) parameters $\\boldsymbol{\\alpha}$:\n$$\n\\Pi(\\boldsymbol{u},\\boldsymbol{\\alpha}) = \\int_{\\Omega_{e}} \\Psi\\!\\left(\\boldsymbol{\\varepsilon}(\\boldsymbol{u},\\boldsymbol{\\alpha})\\right) \\, \\mathrm{d}\\Omega - \\boldsymbol{f}_{e}^{\\mathrm{ext}} \\! \\cdot \\boldsymbol{u}\n$$\nThe principle of stationary potential energy requires that the first variation of $\\Pi$ vanishes for any admissible variations $\\delta\\boldsymbol{u}$ and $\\delta\\boldsymbol{\\alpha}$:\n$$\n\\delta \\Pi(\\boldsymbol{u},\\boldsymbol{\\alpha}) = 0\n$$\nWe compute the variation as:\n$$\n\\delta \\Pi = \\int_{\\Omega_{e}} \\frac{\\partial \\Psi}{\\partial \\boldsymbol{\\varepsilon}} : \\delta \\boldsymbol{\\varepsilon} \\, \\mathrm{d}\\Omega - \\boldsymbol{f}_{e}^{\\mathrm{ext}} \\! \\cdot \\delta \\boldsymbol{u}\n$$\nGiven that $\\boldsymbol{\\sigma} = \\partial \\Psi / \\partial \\boldsymbol{\\varepsilon}$ and $\\delta\\boldsymbol{\\varepsilon} = \\delta\\boldsymbol{\\varepsilon}^{c} + \\delta\\boldsymbol{\\varepsilon}^{e} = \\boldsymbol{B}\\delta\\boldsymbol{u} + \\boldsymbol{E}\\delta\\boldsymbol{\\alpha}$, we can write:\n$$\n\\delta \\Pi = \\int_{\\Omega_{e}} \\boldsymbol{\\sigma} : (\\boldsymbol{B}\\delta\\boldsymbol{u} + \\boldsymbol{E}\\delta\\boldsymbol{\\alpha}) \\, \\mathrm{d}\\Omega - \\boldsymbol{f}_{e}^{\\mathrm{ext}} \\! \\cdot \\delta \\boldsymbol{u}\n$$\nRearranging to group terms in $\\delta\\boldsymbol{u}$ and $\\delta\\boldsymbol{\\alpha}$:\n$$\n\\delta \\Pi = \\left( \\int_{\\Omega_{e}} \\boldsymbol{B}^{T} \\boldsymbol{\\sigma} \\, \\mathrm{d}\\Omega - \\boldsymbol{f}_{e}^{\\mathrm{ext}} \\right) \\cdot \\delta\\boldsymbol{u} + \\left( \\int_{\\Omega_{e}} \\boldsymbol{E}^{T} \\boldsymbol{\\sigma} \\, \\mathrm{d}\\Omega \\right) \\cdot \\delta\\boldsymbol{\\alpha} = 0\n$$\nSince the variations $\\delta\\boldsymbol{u}$ and $\\delta\\boldsymbol{\\alpha}$ are independent and arbitrary, their respective coefficients must vanish. This yields the system of residual equations:\n$$\n\\boldsymbol{r}_{u}(\\boldsymbol{u},\\boldsymbol{\\alpha}) = \\int_{\\Omega_{e}} \\boldsymbol{B}^{T} \\boldsymbol{\\sigma}(\\boldsymbol{\\varepsilon}(\\boldsymbol{u},\\boldsymbol{\\alpha})) \\, \\mathrm{d}\\Omega - \\boldsymbol{f}_{e}^{\\mathrm{ext}} = \\boldsymbol{0}\n$$\n$$\n\\boldsymbol{r}_{\\alpha}(\\boldsymbol{u},\\boldsymbol{\\alpha}) = \\int_{\\Omega_{e}} \\boldsymbol{E}^{T} \\boldsymbol{\\sigma}(\\boldsymbol{\\varepsilon}(\\boldsymbol{u},\\boldsymbol{\\alpha})) \\, \\mathrm{d}\\Omega = \\boldsymbol{0}\n$$\nTo solve this nonlinear system using the Newton-Raphson method, we linearize the residuals. The linearized system for the corrections $(\\Delta\\boldsymbol{u}, \\Delta\\boldsymbol{\\alpha})$ can be written in a block matrix form:\n$$\n\\begin{bmatrix} \\frac{\\partial \\boldsymbol{r}_{u}}{\\partial \\boldsymbol{u}} & \\frac{\\partial \\boldsymbol{r}_{u}}{\\partial \\boldsymbol{\\alpha}} \\\\ \\frac{\\partial \\boldsymbol{r}_{\\alpha}}{\\partial \\boldsymbol{u}} & \\frac{\\partial \\boldsymbol{r}_{\\alpha}}{\\partial \\boldsymbol{\\alpha}} \\end{bmatrix} \\begin{pmatrix} \\Delta\\boldsymbol{u} \\\\ \\Delta\\boldsymbol{\\alpha} \\end{pmatrix} = - \\begin{pmatrix} \\boldsymbol{r}_{u} \\\\ \\boldsymbol{r}_{\\alpha} \\end{pmatrix}\n$$\nThe blocks of the tangent matrix are calculated using the directional derivatives, where the variation of stress is $\\mathrm{D}\\boldsymbol{\\sigma}[\\Delta\\boldsymbol{\\varepsilon}] = \\mathbb{C}_{t}\\Delta\\boldsymbol{\\varepsilon}$.\n\nThe four blocks of the tangent matrix are:\n1.  $\\boldsymbol{K}_{uu} = \\frac{\\partial \\boldsymbol{r}_{u}}{\\partial \\boldsymbol{u}} = \\int_{\\Omega_{e}} \\boldsymbol{B}^{T} \\mathbb{C}_{t} \\boldsymbol{B} \\, \\mathrm{d}\\Omega$\n2.  $\\boldsymbol{K}_{u\\alpha} = \\frac{\\partial \\boldsymbol{r}_{u}}{\\partial \\boldsymbol{\\alpha}} = \\int_{\\Omega_{e}} \\boldsymbol{B}^{T} \\mathbb{C}_{t} \\boldsymbol{E} \\, \\mathrm{d}\\Omega$\n3.  $\\boldsymbol{K}_{\\alpha u} = \\frac{\\partial \\boldsymbol{r}_{\\alpha}}{\\partial \\boldsymbol{u}} = \\int_{\\Omega_{e}} \\boldsymbol{E}^{T} \\mathbb{C}_{t} \\boldsymbol{B} \\, \\mathrm{d}\\Omega$\n4.  $\\boldsymbol{K}_{\\alpha\\alpha} = \\frac{\\partial \\boldsymbol{r}_{\\alpha}}{\\partial \\boldsymbol{\\alpha}} = \\int_{\\Omega_{e}} \\boldsymbol{E}^{T} \\mathbb{C}_{t} \\boldsymbol{E} \\, \\mathrm{d}\\Omega$\n\nNote that due to the major symmetry of $\\mathbb{C}_{t}$, $\\boldsymbol{K}_{\\alpha u} = \\boldsymbol{K}_{u\\alpha}^{T}$. The full linearized system is:\n$$\n\\boldsymbol{K}_{uu} \\Delta\\boldsymbol{u} + \\boldsymbol{K}_{u\\alpha} \\Delta\\boldsymbol{\\alpha} = -\\boldsymbol{r}_{u}\n$$\n$$\n\\boldsymbol{K}_{\\alpha u} \\Delta\\boldsymbol{u} + \\boldsymbol{K}_{\\alpha\\alpha} \\Delta\\boldsymbol{\\alpha} = -\\boldsymbol{r}_{\\alpha}\n$$\nTo condense the system, we eliminate the internal parameters $\\Delta\\boldsymbol{\\alpha}$ at the tangent level. From the second equation, we solve for $\\Delta\\boldsymbol{\\alpha}$, assuming $\\boldsymbol{K}_{\\alpha\\alpha}$ is invertible:\n$$\n\\Delta\\boldsymbol{\\alpha} = -\\boldsymbol{K}_{\\alpha\\alpha}^{-1} ( \\boldsymbol{r}_{\\alpha} + \\boldsymbol{K}_{\\alpha u} \\Delta\\boldsymbol{u} )\n$$\nSubstituting this expression for $\\Delta\\boldsymbol{\\alpha}$ into the first equation:\n$$\n\\boldsymbol{K}_{uu} \\Delta\\boldsymbol{u} + \\boldsymbol{K}_{u\\alpha} \\left( -\\boldsymbol{K}_{\\alpha\\alpha}^{-1} ( \\boldsymbol{r}_{\\alpha} + \\boldsymbol{K}_{\\alpha u} \\Delta\\boldsymbol{u} ) \\right) = -\\boldsymbol{r}_{u}\n$$\nRearranging to group terms involving $\\Delta\\boldsymbol{u}$:\n$$\n( \\boldsymbol{K}_{uu} - \\boldsymbol{K}_{u\\alpha} \\boldsymbol{K}_{\\alpha\\alpha}^{-1} \\boldsymbol{K}_{\\alpha u} ) \\Delta\\boldsymbol{u} = -\\boldsymbol{r}_{u} + \\boldsymbol{K}_{u\\alpha} \\boldsymbol{K}_{\\alpha\\alpha}^{-1} \\boldsymbol{r}_{\\alpha}\n$$\nThis equation is of the form $\\boldsymbol{K}_{\\text{cond}} \\Delta\\boldsymbol{u} = -\\boldsymbol{r}_{\\text{cond}}$, where $\\boldsymbol{K}_{\\text{cond}}$ is the condensed tangent matrix (also known as the consistent tangent operator or the Schur complement of $\\boldsymbol{K}_{\\alpha\\alpha}$), and $\\boldsymbol{r}_{\\text{cond}}$ is the condensed residual vector.\n\nThe problem asks for the consistent tangent matrix of the condensed displacement-only system. This is the operator multiplying $\\Delta\\boldsymbol{u}$:\n$$\n\\boldsymbol{K}_{\\text{cond}} = \\boldsymbol{K}_{uu} - \\boldsymbol{K}_{u\\alpha} \\boldsymbol{K}_{\\alpha\\alpha}^{-1} \\boldsymbol{K}_{\\alpha u}\n$$\nThis expression represents the final condensed tangent matrix, which preserves the quadratic convergence of the Newton-Raphson method when the internal EAS parameters are eliminated.", "answer": "$$\n\\boxed{\\boldsymbol{K}_{uu} - \\boldsymbol{K}_{u\\alpha} \\boldsymbol{K}_{\\alpha\\alpha}^{-1} \\boldsymbol{K}_{\\alpha u}}\n$$", "id": "3582049"}]}