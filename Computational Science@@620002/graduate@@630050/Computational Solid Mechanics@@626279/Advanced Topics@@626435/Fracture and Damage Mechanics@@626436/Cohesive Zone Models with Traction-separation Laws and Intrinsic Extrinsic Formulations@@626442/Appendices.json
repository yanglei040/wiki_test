{"hands_on_practices": [{"introduction": "To begin, we build intuition with a fundamental thought experiment. This practice explores how a cohesive interface and an elastic bulk material share a total imposed deformation. By deriving the traction and separation from first principles, you will gain a clear understanding of how the interface's stiffness competes with the bulk stiffness, a core concept that distinguishes intrinsic cohesive models. [@problem_id:3548973]", "problem": "Consider a homogeneous, linearly elastic layer of thickness $H$ and shear modulus $G$, perfectly bonded on its top surface ($y=H$) to a rigid plate that imposes a small-strain simple shear deformation, and connected on its bottom surface ($y=0$) to a rigid substrate through a zero-thickness cohesive interface. The simple shear boundary condition is applied by prescribing a tangential displacement $u_{x}(y=H)=\\gamma H$ at the top surface and $u_{x}(y=0)=0$ at the bottom substrate, where $\\gamma$ is the applied macroscopic shear strain. Assume quasi-static, plane strain, and small deformations. The cohesive interface follows a linear tangential traction-separation law, $T_{t}=K_{t}\\,\\delta_{t}$, where $K_{t}$ is the tangential stiffness of the interface (constant), $\\delta_{t}$ is the tangential separation (the displacement jump across the interface), and $T_{t}$ is the tangential traction transmitted by the interface. The layer is otherwise purely elastic with shear stress $\\tau$ related to the bulk shear strain $\\gamma_{\\text{bulk}}$ by $\\tau=G\\,\\gamma_{\\text{bulk}}$. The total imposed tangential displacement across the thickness, $\\Delta u=\\gamma H$, is distributed between the bulk shear deformation of the elastic layer and the tangential separation of the cohesive interface.\n\nStarting from kinematic compatibility, equilibrium, and the given constitutive relations, derive closed-form expressions for the tangential separation $\\delta_{t}$ and the tangential traction $T_{t}$ as functions of the applied shear strain $\\gamma$, the layer thickness $H$, the shear modulus $G$, and the interface stiffness $K_{t}$. Express $\\delta_{t}$ in meters (m) and $T_{t}$ in Pascals (Pa). Then briefly interpret how the dependence of $\\delta_{t}$ and $T_{t}$ on $\\gamma$ reflects the behavior of intrinsic versus extrinsic cohesive zone formulations in the limits of very large and very small $K_{t}$.\n\nYour final answer must be a single closed-form expression containing both $\\delta_{t}$ and $T_{t}$ as entries of a row matrix, and no additional commentary. No numerical evaluation is required.", "solution": "We begin with small-strain simple shear kinematics across the thickness of the elastic layer. The imposed macroscopic shear strain is $\\gamma$, so the total tangential displacement across the thickness is\n$$\n\\Delta u \\;=\\; u_{x}(H)-u_{x}(0)\\;=\\;\\gamma H.\n$$\nBecause the bottom of the elastic layer is connected to the rigid substrate through a zero-thickness cohesive interface, the total tangential displacement $\\Delta u$ is partitioned into two contributions:\n1. The bulk shear deformation of the elastic layer, producing a tangential displacement $\\Delta u_{\\text{bulk}}$.\n2. The tangential separation (displacement jump) across the cohesive interface, $\\delta_{t}$.\n\nThus, kinematic compatibility gives\n$$\n\\Delta u \\;=\\; \\Delta u_{\\text{bulk}} + \\delta_{t}.\n$$\nUnder small-strain linear elasticity, the bulk shear strain is uniform and related to the shear stress $\\tau$ through\n$$\n\\tau \\;=\\; G\\,\\gamma_{\\text{bulk}}.\n$$\nThe bulk shear strain $\\gamma_{\\text{bulk}}$ is the displacement gradient across the thickness $H$, so the bulk tangential displacement is\n$$\n\\Delta u_{\\text{bulk}} \\;=\\; \\gamma_{\\text{bulk}}\\,H.\n$$\nCombining with the constitutive equation for the bulk,\n$$\n\\Delta u_{\\text{bulk}} \\;=\\; \\frac{\\tau}{G}\\,H.\n$$\nThe cohesive interface follows the linear tangential traction-separation law\n$$\nT_{t} \\;=\\; K_{t}\\,\\delta_{t}.\n$$\nIn quasi-static equilibrium without body forces and with uniform loading, the shear stress transmitted through the elastic layer equals the interface tangential traction,\n$$\n\\tau \\;=\\; T_{t}.\n$$\nTherefore,\n$$\n\\tau \\;=\\; K_{t}\\,\\delta_{t}.\n$$\nUsing kinematic compatibility,\n$$\n\\gamma H \\;=\\; \\Delta u_{\\text{bulk}} + \\delta_{t} \\;=\\; \\frac{\\tau}{G}\\,H + \\delta_{t}.\n$$\nSubstitute $\\tau=K_{t}\\,\\delta_{t}$ to obtain\n$$\n\\gamma H \\;=\\; \\frac{K_{t}\\,\\delta_{t}}{G}\\,H + \\delta_{t}\n\\;\\;\\Rightarrow\\;\\;\n\\gamma H \\;=\\; \\delta_{t}\\left(1+\\frac{K_{t}H}{G}\\right).\n$$\nSolve for the tangential separation:\n$$\n\\delta_{t} \\;=\\; \\frac{\\gamma H}{\\,1+\\frac{K_{t}H}{G}\\,}\n\\;=\\;\n\\frac{\\gamma H G}{G+K_{t}H}.\n$$\nThe tangential traction is then\n$$\nT_{t} \\;=\\; K_{t}\\,\\delta_{t}\n\\;=\\;\nK_{t}\\,\\frac{\\gamma H}{\\,1+\\frac{K_{t}H}{G}\\,}\n\\;=\\;\n\\frac{\\gamma H K_{t} G}{G+K_{t}H}.\n$$\n\nInterpretation of the dependence on $\\gamma$ and the role of intrinsic versus extrinsic cohesive formulations:\n- Both $\\delta_{t}$ and $T_{t}$ are linear in the applied shear strain $\\gamma$, reflecting linear response for both the bulk elastic layer and the interface. The proportionality factors depend on the ratio $K_{t}H/G$, which compares the interface stiffness to the bulk shear stiffness of the layer.\n- In the limit $K_{t}H/G \\to \\infty$ (very large interface stiffness, representative of an extrinsic formulation prior to damage with a high penalty stiffness), we have\n$$\n\\delta_{t} \\to 0, \\qquad T_{t} \\to \\gamma G,\n$$\nwhich corresponds to a nearly perfect bond with no slip at the interface; all deformation is in the bulk, and the traction equals the classical elastic shear stress.\n- In the limit $K_{t}H/G \\to 0$ (very soft interface, representative of a fully degraded or intrinsically compliant interface), we have\n$$\n\\delta_{t} \\to \\gamma H, \\qquad T_{t} \\to 0,\n$$\nindicating that the deformation localizes at the interface as slip, with negligible traction transmission.\nThese limits elucidate how the intrinsic cohesive zone model with finite $K_{t}$ introduces compliance from the onset, while an extrinsic formulation often employs a very large initial $K_{t}$ to approximate a perfect bond before damage initiation, thereby suppressing $\\delta_{t}$ until a softening law is triggered.", "answer": "$$\\boxed{\\begin{pmatrix}\\dfrac{\\gamma H G}{G+K_{t}H}  \\dfrac{\\gamma H K_{t} G}{G+K_{t}H}\\end{pmatrix}}$$", "id": "3548973"}, {"introduction": "A critical step in using intrinsic cohesive zone models is the selection of the initial penalty stiffness, which is a numerical parameter that can artificially soften the structure if chosen improperly. This exercise guides you through a rigorous derivation to determine the minimal stiffness required to avoid this \"compliance pollution.\" The result provides a robust, physically-grounded rule for setting up accurate cohesive simulations. [@problem_id:3548961]", "problem": "A two-dimensional elastic body in plane strain contains a prospective crack path along which an intrinsic cohesive zone model is pre-inserted. The body has Young’s modulus $E$ and Poisson’s ratio $\\nu$. The cohesive interface follows a bilinear traction–separation law in mode I (normal opening), with an initial linear segment of slope $k$ (the intrinsic penalty stiffness), attaining a peak traction $\\sigma_{\\max}$ at an opening $\\delta_{0}$, and softening to zero traction at a final opening $\\delta_{f}$. The material fracture energy per unit area is $G_{c}$, and the interface law is calibrated so that the area under the traction–separation curve equals $G_{c}$. The intended process-zone size along the crack path is a prescribed length $\\ell$ based on a Linear Elastic Fracture Mechanics scaling choice by the analyst. In an intrinsic formulation, the initial linear segment introduces extra compliance prior to damage, which can pollute the global stiffness if $k$ is chosen too small.\n\nStarting from first principles and well-tested facts in Linear Elastic Fracture Mechanics and energy balance, do the following:\n\n1. Express the “numerical crack width” $w$ at peak traction in terms of $\\sigma_{\\max}$ and $k$.\n2. Use a consistent energy-based scaling argument to connect the intended process-zone size $\\ell$ and the peak traction $\\sigma_{\\max}$, taking into account the relevant plane strain elastic modulus $E'$. You may assume that the intended choice of $\\ell$ is set by the analyst through this scaling so that $\\ell$ is fixed and $\\sigma_{\\max}$ is thereby implicitly determined by $(E,\\nu,G_{c},\\ell)$.\n3. To avoid pollution of global compliance by the intrinsic cohesive interfaces, impose the requirement that the elastic compliance of the cohesive interface in its initial linear segment does not exceed a fraction $\\eta \\in (0,1)$ of the elastic compliance of an adjacent bulk segment of length $\\ell$ loaded in the same normal direction under small strain in plane strain. Here, “compliance” is defined per unit area as displacement per unit traction.\n4. Using the above, determine the minimal intrinsic penalty $k$ that is consistent with the intended process-zone size $\\ell$ and the compliance pollution requirement.\n\nProvide your final answer as a single closed-form symbolic expression for $k$ in terms of $E$, $\\nu$, $\\ell$, and $\\eta$. Do not substitute numerical values. Do not include units in the final boxed answer.", "solution": "The objective is to find the minimal intrinsic penalty stiffness, $k$, that satisfies a given constraint on compliance pollution. The final expression for $k$ must be in terms of the material's Young's modulus $E$, Poisson's ratio $\\nu$, the prescribed process zone length $\\ell$, and the compliance fraction $\\eta$.\n\nFirst, we must correctly formulate the term \"compliance\" as defined in the problem statement: displacement per unit traction, on a per-unit-area basis. Let us denote this quantity by $\\mathcal{C}$.\n\nFor the cohesive interface, its mechanical behavior in the initial, undamaged state is described by the linear relation between traction $\\sigma$ and separation $\\delta$:\n$$ \\sigma = k \\delta $$\nHere, $k$ is the intrinsic penalty stiffness. Following the problem's definition, the compliance of the cohesive interface, $\\mathcal{C}_{coh}$, is the separation per unit traction:\n$$ \\mathcal{C}_{coh} = \\frac{\\delta}{\\sigma} = \\frac{\\delta}{k \\delta} = \\frac{1}{k} $$\n\nNext, we evaluate the compliance of the reference bulk material segment. The problem specifies a segment of length $\\ell$ loaded in the normal direction under plane strain conditions. For a material in plane strain, the effective modulus relating uniaxial stress (traction) $\\sigma$ to the corresponding strain $\\epsilon$ in the same direction is the plane strain modulus, $E'$, defined as:\n$$ E' = \\frac{E}{1 - \\nu^2} $$\nThe strain in the bulk segment is therefore $\\epsilon = \\sigma / E'$. The total displacement, $\\Delta u$, across the segment of length $\\ell$ is the product of the strain and the length:\n$$ \\Delta u = \\epsilon \\cdot \\ell = \\left(\\frac{\\sigma}{E'}\\right) \\ell $$\nThe compliance of this bulk segment, $\\mathcal{C}_{bulk}$, is its displacement per unit traction:\n$$ \\mathcal{C}_{bulk} = \\frac{\\Delta u}{\\sigma} = \\frac{(\\sigma/E')\\ell}{\\sigma} = \\frac{\\ell}{E'} $$\n\nThe problem imposes a constraint to limit the \"pollution\" of the global stiffness by the numerically introduced compliance of the intrinsic cohesive law. This constraint states that the compliance of the cohesive interface must not exceed a fraction $\\eta$ of the compliance of the adjacent bulk segment of length $\\ell$:\n$$ \\mathcal{C}_{coh} \\le \\eta \\mathcal{C}_{bulk} $$\nSubstituting the expressions for $\\mathcal{C}_{coh}$ and $\\mathcal{C}_{bulk}$ derived above:\n$$ \\frac{1}{k} \\le \\eta \\left(\\frac{\\ell}{E'}\\right) $$\n\nWe are asked for the minimal value of the intrinsic penalty stiffness $k$ that satisfies this condition. The inequality can be rearranged to find a lower bound for $k$:\n$$ k \\ge \\frac{E'}{\\eta \\ell} $$\nThe minimal value of $k$ is therefore given by the equality:\n$$ k_{min} = \\frac{E'}{\\eta \\ell} $$\n\nThe preceding parts of the problem statement, concerning the LEFM scaling for $\\ell$ and the relation between $\\sigma_{\\max}$, $\\delta_0$, and $k$, provide the physical and theoretical context. They explain how the length scale $\\ell$ is not arbitrary but is grounded in the fracture mechanics of the material, typically scaling as $\\ell \\propto E'G_c/\\sigma_{\\max}^2$. This ensures that the compliance comparison is physically meaningful, i.e., the numerical compliance is being compared against the physical compliance of a material volume of a size comparable to the fracture process zone. However, for the specific calculation of $k$ in terms of the given variable $\\ell$, these relations are not directly needed for the final algebraic step.\n\nFinally, to express the result in terms of the specified variables $E$, $\\nu$, $\\ell$, and $\\eta$, we substitute the definition of the plane strain modulus $E'$ into the expression for $k_{min}$:\n$$ k = \\frac{1}{\\eta \\ell} \\left(\\frac{E}{1 - \\nu^2}\\right) = \\frac{E}{\\eta \\ell (1 - \\nu^2)} $$\nThis is the minimal required intrinsic penalty stiffness consistent with the compliance pollution criterion and the specified process zone length.", "answer": "$$\\boxed{\\frac{E}{\\eta \\ell (1 - \\nu^2)}}$$", "id": "3548961"}, {"introduction": "This final practice transitions from theory to computational implementation, guiding you through the core of a nonlinear finite element solver. You will implement a single Newton–Raphson iteration for a cohesive element, computing the residual force and the essential consistent tangent matrix from a complex traction-separation law. This exercise provides direct experience with the algorithm that enables the simulation of fracture using cohesive zone models. [@problem_id:3548989]", "problem": "Implement a single Newton–Raphson iteration for a two-node planar interface element governed by a cohesive zone model with traction–separation laws and both intrinsic and extrinsic formulations. The interface has a unit normal vector $\\mathbf{n} \\in \\mathbb{R}^2$ and a unit tangent vector $\\mathbf{t} \\in \\mathbb{R}^2$ obtained from an orientation angle $\\theta$ in radians, where $\\mathbf{n} = [\\cos(\\theta), \\sin(\\theta)]^\\top$ and $\\mathbf{t} = [-\\sin(\\theta), \\cos(\\theta)]^\\top$. The nodal displacement vector is $\\mathbf{u} \\in \\mathbb{R}^4$ with ordering $[u_{\\text{top},x}, u_{\\text{top},y}, u_{\\text{bot},x}, u_{\\text{bot},y}]^\\top$ in millimeters. The displacement jump in the local interface frame is $\\boldsymbol{\\delta} \\in \\mathbb{R}^2$ with components $\\delta_n$ (normal) and $\\delta_t$ (tangential), computed from $\\boldsymbol{\\delta} = \\mathbf{B}\\,\\mathbf{u}$, where\n$$\n\\mathbf{B} = \n\\begin{bmatrix}\nn_x  n_y  -n_x  -n_y \\\\\nt_x  t_y  -t_x  -t_y\n\\end{bmatrix}.\n$$\nThe traction–separation law defines the cohesive traction vector $\\mathbf{T}(\\boldsymbol{\\delta}) = [T_n, T_t]^\\top$ in megapascals (MPa). Use the following physically and numerically sound model parameters (constants), stated in consistent units:\n- Intrinsic normal stiffness $k_{n0} = 1000\\,\\text{MPa/mm}$,\n- Intrinsic tangential stiffness $k_{t0} = 500\\,\\text{MPa/mm}$,\n- Compressive penalty stiffness $k_c = 5000\\,\\text{MPa/mm}$,\n- Exponential softening length $d_0 = 0.05\\,\\text{mm}$,\n- Mode coupling parameter $\\beta = 1.2$,\n- Extrinsic activation threshold $\\delta_a = 0.02\\,\\text{mm}$,\n- Small regularization $\\varepsilon = 10^{-12}\\,\\text{mm}$.\n\nDefine the effective separation\n$$\n\\delta_{\\text{eff}} = \\sqrt{\\max(\\delta_n, 0)^2 + \\beta\\,\\delta_t^2 + \\varepsilon},\n$$\nand let $s = \\exp\\!\\left(-\\dfrac{\\delta_{\\text{eff}}}{d_0}\\right)$.\n\nFor the intrinsic formulation, the traction components are\n$$\nT_n = \n\\begin{cases}\nk_{n0}\\,\\delta_n\\,s,  \\delta_n \\ge 0, \\\\\nk_c\\,\\delta_n,  \\delta_n  0,\n\\end{cases}\n\\qquad\nT_t = k_{t0}\\,\\delta_t\\,s.\n$$\nFor the extrinsic formulation, use\n$$\nT_n =\n\\begin{cases}\nk_c\\,\\delta_n,  \\delta_n  0, \\\\\n0,  \\delta_n \\ge 0 \\text{ and } \\delta_{\\text{eff}}  \\delta_a, \\\\\nk_{n0}\\,\\delta_n\\,s,  \\delta_n \\ge 0 \\text{ and } \\delta_{\\text{eff}} \\ge \\delta_a,\n\\end{cases}\n\\qquad\nT_t =\n\\begin{cases}\n0,  \\delta_n  0, \\\\\n0,  \\delta_n \\ge 0 \\text{ and } \\delta_{\\text{eff}}  \\delta_a, \\\\\nk_{t0}\\,\\delta_t\\,s,  \\delta_n \\ge 0 \\text{ and } \\delta_{\\text{eff}} \\ge \\delta_a.\n\\end{cases}\n$$\n\nDerive and implement the consistent tangent matrix $\\mathbf{C} = \\dfrac{\\partial \\mathbf{T}}{\\partial \\boldsymbol{\\delta}} \\in \\mathbb{R}^{2 \\times 2}$ for use in Newton–Raphson, based on the above model. The required derivatives are\n- For $\\delta_n \\ge 0$:\n$$\n\\frac{\\partial \\delta_{\\text{eff}}}{\\partial \\delta_n} = \\frac{\\delta_n}{\\delta_{\\text{eff}}}, \\quad\n\\frac{\\partial \\delta_{\\text{eff}}}{\\partial \\delta_t} = \\frac{\\beta\\,\\delta_t}{\\delta_{\\text{eff}}}, \\quad\n\\frac{\\partial s}{\\partial \\delta_n} = -\\frac{s}{d_0}\\,\\frac{\\delta_n}{\\delta_{\\text{eff}}}, \\quad\n\\frac{\\partial s}{\\partial \\delta_t} = -\\frac{s}{d_0}\\,\\frac{\\beta\\,\\delta_t}{\\delta_{\\text{eff}}},\n$$\nand\n$$\nC_{nn} = \\frac{\\partial T_n}{\\partial \\delta_n} = k_{n0}\\left(s + \\delta_n \\frac{\\partial s}{\\partial \\delta_n}\\right), \\quad\nC_{nt} = \\frac{\\partial T_n}{\\partial \\delta_t} = k_{n0}\\left(\\delta_n \\frac{\\partial s}{\\partial \\delta_t}\\right),\n$$\n$$\nC_{tn} = \\frac{\\partial T_t}{\\partial \\delta_n} = k_{t0}\\left(\\delta_t \\frac{\\partial s}{\\partial \\delta_n}\\right), \\quad\nC_{tt} = \\frac{\\partial T_t}{\\partial \\delta_t} = k_{t0}\\left(s + \\delta_t \\frac{\\partial s}{\\partial \\delta_t}\\right).\n$$\n- For $\\delta_n  0$ (compression), use $T_n = k_c\\,\\delta_n$ with $C_{nn} = k_c$ and $C_{nt} = 0$, and $T_t = k_{t0}\\,\\delta_t\\,s$ where $\\dfrac{\\partial s}{\\partial \\delta_n} = 0$, $\\dfrac{\\partial s}{\\partial \\delta_t} = -\\dfrac{s}{d_0}\\,\\dfrac{\\beta\\,\\delta_t}{\\delta_{\\text{eff}}}$; thus $C_{tn} = 0$ and $C_{tt} = k_{t0}\\left(s + \\delta_t \\dfrac{\\partial s}{\\partial \\delta_t}\\right)$. For the extrinsic formulation in the not-activated regime ($\\delta_n \\ge 0$ and $\\delta_{\\text{eff}}  \\delta_a$), set $\\mathbf{T} = \\mathbf{0}$ and $\\mathbf{C} = \\mathbf{0}$.\n\nWith a given external traction vector $\\mathbf{T}_{\\text{ext}} \\in \\mathbb{R}^2$ in megapascals, define the traction-space residual\n$$\n\\mathbf{r}(\\mathbf{u}) = \\mathbf{T}(\\boldsymbol{\\delta}(\\mathbf{u})) - \\mathbf{T}_{\\text{ext}}.\n$$\nMap the traction-space residual to the nodal residual via $\\mathbf{R} = \\mathbf{B}^\\top \\mathbf{r}$, and the consistent tangent to the nodal tangent via\n$$\n\\mathbf{K} = \\mathbf{B}^\\top \\mathbf{C}\\,\\mathbf{B} \\in \\mathbb{R}^{4 \\times 4}.\n$$\nPerform a single Newton–Raphson update\n$$\n\\Delta \\mathbf{u} = -\\,\\mathbf{K}^{\\dagger}\\,\\mathbf{R}, \\qquad \\mathbf{u}_{\\text{new}} = \\mathbf{u} + \\Delta \\mathbf{u},\n$$\nwhere $\\mathbf{K}^{\\dagger}$ is a numerically robust inverse, chosen as the standard inverse if $\\mathbf{K}$ is well-conditioned and otherwise the Moore–Penrose pseudoinverse. Then recompute $\\boldsymbol{\\delta}_{\\text{new}} = \\mathbf{B}\\,\\mathbf{u}_{\\text{new}}$, $\\mathbf{T}_{\\text{new}} = \\mathbf{T}(\\boldsymbol{\\delta}_{\\text{new}})$, and the updated traction-space residual $\\mathbf{r}_{\\text{new}} = \\mathbf{T}_{\\text{new}} - \\mathbf{T}_{\\text{ext}}$.\n\nState and apply the convergence criterion on the residual norm: declare convergence if\n$$\n\\|\\mathbf{r}_{\\text{new}}\\|_2 \\le \\tau_r,\n$$\nwith tolerance $\\tau_r$ in megapascals. Use $\\tau_r = 10^{-3}\\,\\text{MPa}$ in all tests.\n\nYour program must implement the above for the following test suite. All displacements are in millimeters, tractions in megapascals, stiffnesses in megapascals per millimeter, and angles in radians. For each case, perform exactly one Newton–Raphson iteration and output whether the convergence criterion is met. The program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets.\n\nTest suite:\n- Case $1$ (intrinsic, tension-shear mixed, happy path): $\\theta = 0$, $\\mathbf{u}_{\\text{top}} = [0.03, 0.00]$, $\\mathbf{u}_{\\text{bot}} = [0.00, 0.01]$, $\\mathbf{T}_{\\text{ext}} = [5.0, -2.0]$, formulation $=$ intrinsic.\n- Case $2$ (intrinsic, compression in normal): $\\theta = 0$, $\\mathbf{u}_{\\text{top}} = [-0.01, 0.00]$, $\\mathbf{u}_{\\text{bot}} = [0.00, 0.00]$, $\\mathbf{T}_{\\text{ext}} = [0.5, 1.0]$, formulation $=$ intrinsic.\n- Case $3$ (extrinsic, not activated edge case): $\\theta = \\dfrac{\\pi}{4}$, $\\mathbf{u}_{\\text{top}} = [0.003, 0.003]$, $\\mathbf{u}_{\\text{bot}} = [0.00, 0.00]$, $\\mathbf{T}_{\\text{ext}} = [1.0, 1.0]$, formulation $=$ extrinsic.\n- Case $4$ (extrinsic, activated): $\\theta = \\dfrac{\\pi}{6}$, $\\mathbf{u}_{\\text{top}} = [0.05, 0.02]$, $\\mathbf{u}_{\\text{bot}} = [0.00, 0.00]$, $\\mathbf{T}_{\\text{ext}} = [2.5, 1.5]$, formulation $=$ extrinsic.\n- Case $5$ (intrinsic, zero residual boundary): $\\theta = \\dfrac{\\pi}{3}$, $\\mathbf{u}_{\\text{top}} = [0.00, 0.00]$, $\\mathbf{u}_{\\text{bot}} = [0.00, 0.00]$, $\\mathbf{T}_{\\text{ext}} = [0.0, 0.0]$, formulation $=$ intrinsic.\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, with each entry a boolean indicating whether the convergence criterion $\\|\\mathbf{r}_{\\text{new}}\\|_2 \\le \\tau_r$ is satisfied after one iteration (for example, $[{\\tt True},{\\tt False},\\dots]$).", "solution": "The task is to implement a single Newton–Raphson iteration for a two-node cohesive element. The solution process is structured as follows:\n1.  **Kinematics**: Map the global nodal displacements $\\mathbf{u}$ to the local interface separation (displacement jump) $\\boldsymbol{\\delta}$.\n2.  **Constitutive Evaluation**: Based on the current separation $\\boldsymbol{\\delta}$, calculate the cohesive traction vector $\\mathbf{T}$ and the consistent tangent stiffness matrix in the local frame, $\\mathbf{C} = \\frac{\\partial \\mathbf{T}}{\\partial \\boldsymbol{\\delta}}$.\n3.  **Residual and Stiffness Assembly**: Compute the traction-space residual $\\mathbf{r}$, and then map it and the local tangent $\\mathbf{C}$ to the global nodal residual vector $\\mathbf{R}$ and tangent stiffness matrix $\\mathbf{K}$.\n4.  **Newton-Raphson Update**: Solve the linear system for the displacement increment $\\Delta\\mathbf{u}$ and update the nodal displacements.\n5.  **Convergence Check**: Re-evaluate the state at the new displacement $\\mathbf{u}_{\\text{new}}$ and check if the norm of the new traction-space residual $\\|\\mathbf{r}_{\\text{new}}\\|_2$ meets the specified tolerance.\n\nLet us detail each step.\n\n**1. Kinematics**\nThe geometry of the planar interface is defined by the orientation angle $\\theta$. The unit normal vector $\\mathbf{n}$ and unit tangent vector $\\mathbf{t}$ define the local coordinate system of the interface:\n$$\n\\mathbf{n} = \\begin{bmatrix} n_x \\\\ n_y \\end{bmatrix} = \\begin{bmatrix} \\cos(\\theta) \\\\ \\sin(\\theta) \\end{bmatrix}, \\quad\n\\mathbf{t} = \\begin{bmatrix} t_x \\\\ t_y \\end{bmatrix} = \\begin{bmatrix} -\\sin(\\theta) \\\\ \\cos(\\theta) \\end{bmatrix}.\n$$\nThe global nodal displacement vector for the two-node element is $\\mathbf{u} = [u_{\\text{top},x}, u_{\\text{top},y}, u_{\\text{bot},x}, u_{\\text{bot},y}]^\\top$. The displacement jump across the interface, $\\boldsymbol{\\delta} = [\\delta_n, \\delta_t]^\\top$, is the relative displacement of the top node with respect to the bottom node, projected onto the local interface frame. This is computed via the kinematic matrix $\\mathbf{B}$:\n$$\n\\boldsymbol{\\delta} = \\mathbf{B}\\,\\mathbf{u},\n$$\nwhere\n$$\n\\mathbf{B} = \n\\begin{bmatrix}\nn_x  n_y  -n_x  -n_y \\\\\nt_x  t_y  -t_x  -t_y\n\\end{bmatrix}.\n$$\nThe components $\\delta_n$ and $\\delta_t$ represent the normal and tangential separation, respectively.\n\n**2. Constitutive Evaluation: Traction and Tangent**\nThe core of the problem lies in the cohesive zone model (CZM), which defines the relationship between the separation $\\boldsymbol{\\delta}$ and the traction $\\mathbf{T}$. This relationship is nonlinear and history-dependent in general, but for this problem, it is given as a direct function of the current $\\boldsymbol{\\delta}$. The consistent tangent matrix $\\mathbf{C} = \\frac{\\partial \\mathbf{T}}{\\partial \\boldsymbol{\\delta}}$ is essential for the quadratic convergence of the Newton–Raphson method.\n\nWe first define several intermediate quantities based on $\\boldsymbol{\\delta} = [\\delta_n, \\delta_t]^\\top$. All parameters are given in consistent units of MPa, mm.\n- Parameters: $k_{n0} = 1000$, $k_{t0} = 500$, $k_c = 5000$, $d_0 = 0.05$, $\\beta = 1.2$, $\\delta_a = 0.02$, $\\varepsilon = 10^{-12}$.\n- Effective separation: $\\delta_{\\text{eff}} = \\sqrt{\\max(\\delta_n, 0)^2 + \\beta\\,\\delta_t^2 + \\varepsilon}$. The use of $\\max(\\delta_n, 0)$ ensures that compressive normal separation does not contribute to damage.\n- Softening function: $s = \\exp(-\\frac{\\delta_{\\text{eff}}}{d_0})$.\n\nThe traction $\\mathbf{T}$ and tangent $\\mathbf{C}$ depend on the specific formulation ('intrinsic' or 'extrinsic') and the state of deformation (tension, compression, activated, or not activated).\n\n**Case I: Intrinsic Formulation**\n- If $\\delta_n \\ge 0$ (tension/shear):\n  $$ T_n = k_{n0}\\,\\delta_n\\,s, \\qquad T_t = k_{t0}\\,\\delta_t\\,s $$\n  The consistent tangent $\\mathbf{C} = \\begin{bmatrix} C_{nn}  C_{nt} \\\\ C_{tn}  C_{tt} \\end{bmatrix}$ is derived using the product and chain rules. The required partial derivatives of $s$ are:\n  $$ \\frac{\\partial s}{\\partial \\delta_n} = -\\frac{s}{d_0}\\frac{\\partial \\delta_{\\text{eff}}}{\\partial \\delta_n} = -\\frac{s}{d_0} \\frac{\\delta_n}{\\delta_{\\text{eff}}}, \\qquad \\frac{\\partial s}{\\partial \\delta_t} = -\\frac{s}{d_0}\\frac{\\partial \\delta_{\\text{eff}}}{\\partial \\delta_t} = -\\frac{s}{d_0} \\frac{\\beta\\,\\delta_t}{\\delta_{\\text{eff}}} $$\n  The tangent components are:\n  $$ C_{nn} = k_{n0}\\left(s + \\delta_n \\frac{\\partial s}{\\partial \\delta_n}\\right), \\quad C_{nt} = k_{n0}\\,\\delta_n \\frac{\\partial s}{\\partial \\delta_t} $$\n  $$ C_{tn} = k_{t0}\\,\\delta_t \\frac{\\partial s}{\\partial \\delta_n}, \\quad C_{tt} = k_{t0}\\left(s + \\delta_t \\frac{\\partial s}{\\partial \\delta_t}\\right) $$\n- If $\\delta_n  0$ (compression):\n  $$ T_n = k_c\\,\\delta_n, \\qquad T_t = k_{t0}\\,\\delta_t\\,s $$\n  Here, $\\delta_{\\text{eff}} = \\sqrt{\\beta\\,\\delta_t^2 + \\varepsilon}$, so $\\frac{\\partial \\delta_{\\text{eff}}}{\\partial \\delta_n} = 0$, which implies $\\frac{\\partial s}{\\partial \\delta_n} = 0$. The tangent becomes:\n  $$ C_{nn} = \\frac{\\partial T_n}{\\partial \\delta_n} = k_c, \\quad C_{nt} = \\frac{\\partial T_n}{\\partial \\delta_t} = 0 $$\n  $$ C_{tn} = \\frac{\\partial T_t}{\\partial \\delta_n} = k_{t0}\\,\\delta_t \\frac{\\partial s}{\\partial \\delta_n} = 0, \\quad C_{tt} = \\frac{\\partial T_t}{\\partial \\delta_t} = k_{t0}\\left(s+\\delta_t \\frac{\\partial s}{\\partial \\delta_t}\\right) $$\n  So, $\\mathbf{C}$ is diagonal: $\\mathbf{C} = \\text{diag}(k_c, k_{t0}(s+\\delta_t \\frac{\\partial s}{\\partial \\delta_t}))$.\n\n**Case II: Extrinsic Formulation**\n- If $\\delta_n  0$ (compression):\n  $$ T_n = k_c\\,\\delta_n, \\qquad T_t = 0 $$\n  The tangent is derived directly from these definitions.\n  $$ C_{nn} = k_c, \\quad C_{nt} = 0, \\quad C_{tn} = 0, \\quad C_{tt} = 0 $$\n- If $\\delta_n \\ge 0$:\n  - If $\\delta_{\\text{eff}}  \\delta_a$ (not activated): The interface has not yet started to separate.\n    $$ T_n = 0, \\qquad T_t = 0 \\implies \\mathbf{T} = \\mathbf{0} $$\n    The tangent is the zero matrix: $\\mathbf{C} = \\mathbf{0}$.\n  - If $\\delta_{\\text{eff}} \\ge \\delta_a$ (activated): The behavior is identical to the intrinsic formulation for $\\delta_n \\ge 0$.\n    $$ T_n = k_{n0}\\,\\delta_n\\,s, \\qquad T_t = k_{t0}\\,\\delta_t\\,s $$\n    The tangent matrix $\\mathbf{C}$ is the same as the full $2 \\times 2$ matrix for the intrinsic case in tension/shear.\n\n**3. Residual and Stiffness Assembly**\nWith the traction $\\mathbf{T}$ and local tangent $\\mathbf{C}$ evaluated at the current state $\\boldsymbol{\\delta}(\\mathbf{u})$, we can compute the residuals and global stiffness.\n- Traction-space residual: $\\mathbf{r} = \\mathbf{T}(\\boldsymbol{\\delta}(\\mathbf{u})) - \\mathbf{T}_{\\text{ext}}$.\n- Global nodal residual: $\\mathbf{R} = \\mathbf{B}^\\top \\mathbf{r}$. This maps the local traction residual to equivalent nodal forces.\n- Global nodal tangent stiffness: $\\mathbf{K} = \\mathbf{B}^\\top \\mathbf{C} \\mathbf{B}$. This maps the local constitutive stiffness to the global nodal stiffness matrix.\n\n**4. Newton-Raphson Update**\nThe core of the Newton-Raphson method is to solve the linearized system of equations for the displacement increment $\\Delta\\mathbf{u}$:\n$$ \\mathbf{K} \\Delta\\mathbf{u} = -\\mathbf{R} $$\nThe solution is given by:\n$$ \\Delta\\mathbf{u} = -\\mathbf{K}^{\\dagger}\\mathbf{R} $$\nwhere $\\mathbf{K}^{\\dagger}$ is a robust inverse. The Moore-Penrose pseudoinverse is used as specified, as it correctly handles cases where $\\mathbf{K}$ is singular (e.g., when $\\mathbf{C}=\\mathbf{0}$).\nThe nodal displacement vector is then updated:\n$$ \\mathbf{u}_{\\text{new}} = \\mathbf{u} + \\Delta\\mathbf{u} $$\n\n**5. Convergence Check**\nAfter the update, the state of the element is re-evaluated.\n- New displacement jump: $\\boldsymbol{\\delta}_{\\text{new}} = \\mathbf{B}\\,\\mathbf{u}_{\\text{new}}$.\n- New traction: $\\mathbf{T}_{\\text{new}}$ is found by applying the constitutive law to $\\boldsymbol{\\delta}_{\\text{new}}$.\n- New traction-space residual: $\\mathbf{r}_{\\text{new}} = \\mathbf{T}_{\\text{new}} - \\mathbf{T}_{\\text{ext}}$.\nThe convergence criterion is then checked against a tolerance $\\tau_r = 10^{-3}$:\n$$ \\|\\mathbf{r}_{\\text{new}}\\|_2 \\le \\tau_r $$\nwhere $\\|\\cdot\\|_2$ is the Euclidean norm. If this inequality holds, the iteration is considered converged. The algorithm will perform this sequence of steps for each test case and report the outcome of this check.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Implements a single Newton-Raphson iteration for a two-node planar interface \n    element with a cohesive zone model.\n    \"\"\"\n\n    # --- Model Parameters ---\n    k_n0 = 1000.0  # Intrinsic normal stiffness (MPa/mm)\n    k_t0 = 500.0   # Intrinsic tangential stiffness (MPa/mm)\n    k_c = 5000.0   # Compressive penalty stiffness (MPa/mm)\n    d_0 = 0.05     # Exponential softening length (mm)\n    beta = 1.2     # Mode coupling parameter\n    delta_a = 0.02 # Extrinsic activation threshold (mm)\n    epsilon = 1e-12# Small regularization (mm)\n    tau_r = 1e-3   # Residual tolerance (MPa)\n\n    # --- Test Suite ---\n    test_cases = [\n        # Case 1: intrinsic, tension-shear mixed\n        {'theta': 0.0, 'u': np.array([0.03, 0.00, 0.00, 0.01]), \n         'T_ext': np.array([5.0, -2.0]), 'formulation': 'intrinsic'},\n        # Case 2: intrinsic, compression\n        {'theta': 0.0, 'u': np.array([-0.01, 0.00, 0.00, 0.00]), \n         'T_ext': np.array([0.5, 1.0]), 'formulation': 'intrinsic'},\n        # Case 3: extrinsic, not activated\n        {'theta': np.pi / 4.0, 'u': np.array([0.003, 0.003, 0.00, 0.00]), \n         'T_ext': np.array([1.0, 1.0]), 'formulation': 'extrinsic'},\n        # Case 4: extrinsic, activated\n        {'theta': np.pi / 6.0, 'u': np.array([0.05, 0.02, 0.00, 0.00]), \n         'T_ext': np.array([2.5, 1.5]), 'formulation': 'extrinsic'},\n        # Case 5: intrinsic, zero residual\n        {'theta': np.pi / 3.0, 'u': np.array([0.00, 0.00, 0.00, 0.00]), \n         'T_ext': np.array([0.0, 0.0]), 'formulation': 'intrinsic'},\n    ]\n\n    def evaluate_model(delta, formulation):\n        \"\"\"\n        Calculates the traction vector T and consistent tangent matrix C.\n        \"\"\"\n        delta_n, delta_t = delta\n        T = np.zeros(2)\n        C = np.zeros((2, 2))\n\n        # --- Helper quantities ---\n        delta_n_pos = max(delta_n, 0)\n        delta_eff = np.sqrt(delta_n_pos**2 + beta * delta_t**2 + epsilon)\n        s = np.exp(-delta_eff / d_0)\n\n        # --- Intrinsic Formulation ---\n        if formulation == 'intrinsic':\n            if delta_n >= 0:  # Tension/Shear\n                T[0] = k_n0 * delta_n * s\n                T[1] = k_t0 * delta_t * s\n                \n                ds_ddn = -s / d_0 * delta_n / delta_eff\n                ds_ddt = -s / d_0 * beta * delta_t / delta_eff\n                \n                C[0, 0] = k_n0 * (s + delta_n * ds_ddn)\n                C[0, 1] = k_n0 * delta_n * ds_ddt\n                C[1, 0] = k_t0 * delta_t * ds_ddn\n                C[1, 1] = k_t0 * (s + delta_t * ds_ddt)\n            else:  # Compression\n                T[0] = k_c * delta_n\n                # Note: s is calculated with delta_n=0 in delta_eff\n                delta_eff_comp = np.sqrt(beta * delta_t**2 + epsilon)\n                s_comp = np.exp(-delta_eff_comp / d_0)\n                T[1] = k_t0 * delta_t * s_comp\n\n                C[0, 0] = k_c\n                # C[0,1] and C[1,0] are zero\n                ds_ddt_comp = -s_comp / d_0 * beta * delta_t / delta_eff_comp\n                C[1, 1] = k_t0 * (s_comp + delta_t * ds_ddt_comp)\n\n        # --- Extrinsic Formulation ---\n        elif formulation == 'extrinsic':\n            if delta_n  0: # Compression\n                T[0] = k_c * delta_n\n                T[1] = 0.0\n                C[0, 0] = k_c\n                # C[0,1], C[1,0], C[1,1] are zero\n            else: # Tension/Shear\n                if delta_eff  delta_a: # Not activated\n                    T = np.zeros(2)\n                    C = np.zeros((2, 2))\n                else: # Activated\n                    T[0] = k_n0 * delta_n * s\n                    T[1] = k_t0 * delta_t * s\n                    \n                    ds_ddn = -s / d_0 * delta_n / delta_eff\n                    ds_ddt = -s / d_0 * beta * delta_t / delta_eff\n                    \n                    C[0, 0] = k_n0 * (s + delta_n * ds_ddn)\n                    C[0, 1] = k_n0 * delta_n * ds_ddt\n                    C[1, 0] = k_t0 * delta_t * ds_ddn\n                    C[1, 1] = k_t0 * (s + delta_t * ds_ddt)\n        \n        return T, C\n\n    results = []\n    for case in test_cases:\n        theta = case['theta']\n        u = case['u']\n        T_ext = case['T_ext']\n        formulation = case['formulation']\n        \n        # 1. Kinematics\n        nx, ny = np.cos(theta), np.sin(theta)\n        tx, ty = -np.sin(theta), np.cos(theta)\n        \n        B = np.array([\n            [nx, ny, -nx, -ny],\n            [tx, ty, -tx, -ty]\n        ])\n        \n        delta = B @ u\n        \n        # 2. Constitutive Evaluation\n        T, C = evaluate_model(delta, formulation)\n        \n        # 3. Residual and Stiffness Assembly\n        r = T - T_ext\n        R = B.T @ r\n        K = B.T @ C @ B\n        \n        # 4. Newton-Raphson Update\n        # Use pseudoinverse for robustness against singular K\n        K_inv = np.linalg.pinv(K)\n        delta_u = -K_inv @ R\n        u_new = u + delta_u\n        \n        # 5. Convergence Check\n        delta_new = B @ u_new\n        T_new, _ = evaluate_model(delta_new, formulation)\n        r_new = T_new - T_ext\n        \n        r_norm = np.linalg.norm(r_new)\n        is_converged = r_norm = tau_r\n        results.append(is_converged)\n\n    # Format and print the final output\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3548989"}]}