{"hands_on_practices": [{"introduction": "Exact impenetrability constraints are expressed by the Karush-Kuhn-Tucker (KKT) conditions: $g \\ge 0$, $\\lambda \\ge 0$, and $\\lambda g = 0$. While Lagrange multiplier methods solve this system directly, the penalty method offers a simpler approximation by relating the contact force $\\lambda$ to the penetration $g^{-}$ via a stiff penalty parameter $k$. This exercise provides a foundational analysis of this approximation by asking you to derive the asymptotic error in the predicted force as $k \\to \\infty$ [@problem_id:3573078]. This will give you deep insight into how the penalty method converges to the exact solution and what governs its accuracy.", "problem": "Consider a single-degree-of-freedom linear elastic system modeling unilateral contact with a rigid obstacle. Let the unknown displacement be $u \\in \\mathbb{R}$, the linear elastic stiffness be $K0$, the applied external force be $F0$ acting in the direction that reduces the gap, and the initial gap be $g_{0}0$. The impenetrability constraint is described by the gap function $g(u) = g_{0} - u$, with the standard complementarity conditions $g(u) \\geq 0$, $\\lambda \\geq 0$, and $\\lambda\\,g(u) = 0$, where $\\lambda$ is the contact reaction (Lagrange multiplier). The mechanical equilibrium (sum of forces equals zero) reads $K\\,u + \\lambda = F$. Assume the contact-active regime $F \\geq K\\,g_{0}$ so that the exact multiplier solution satisfies $g(u)=0$.\n\nIn a primal-only penalty formulation, the impenetrability constraint is relaxed by introducing a penalty parameter $k0$ and a penalty contact force $\\lambda_{k} = k\\,g^{-}$, where $g^{-} = \\max\\{0,-g(u)\\}$. In the contact-active regime, the penalty equilibrium is $K\\,u + \\lambda_{k} = F$ with $g^{-} = u - g_{0}$.\n\nStarting only from the principles of mechanical equilibrium and the complementarity conditions for unilateral contact, and using the above penalty prescription, derive the asymptotic expansion of the force prediction error $\\Delta \\lambda(k) = \\lambda_{k} - \\lambda_{\\text{exact}}$ as $k \\to \\infty$, up to and including the term of order $k^{-2}$, expressed in terms of $F$, $K$, $g_{0}$, and $k$. Your final answer must be a single closed-form analytic expression for $\\Delta \\lambda(k)$ that contains terms up to $k^{-2}$ only. No numerical substitution is required; do not include units in your final boxed answer.", "solution": "The user wants me to solve a problem in the field of computational solid mechanics, focusing on unilateral contact constraints. Here's a structured approach to solving it:\n\n**Part 1: Problem Validation**\n\nFirst, I will validate the problem statement according to the specified rules.\n\n**Step 1: Extract Givens**\n\n*   System: Single-degree-of-freedom linear elastic system with unilateral contact.\n*   Unknown: Displacement $u \\in \\mathbb{R}$.\n*   Constants:\n    *   Linear elastic stiffness $K  0$.\n    *   Applied external force $F  0$.\n    *   Initial gap $g_{0}  0$.\n*   Gap function: $g(u) = g_{0} - u$.\n*   Complementarity conditions (exact problem):\n    1.  $g(u) \\geq 0$.\n    2.  $\\lambda \\geq 0$, where $\\lambda$ is the contact reaction Lagrange multiplier.\n    3.  $\\lambda\\,g(u) = 0$.\n*   Equilibrium equation (exact problem): $K\\,u + \\lambda = F$.\n*   Assumed regime: Contact-active, $F \\geq K\\,g_{0}$, which implies the exact solution has $g(u)=0$.\n*   Penalty formulation:\n    *   Penalty parameter $k  0$.\n    *   Penalty contact force $\\lambda_{k} = k\\,g^{-}$, where $g^{-} = \\max\\{0,-g(u)\\}$.\n    *   Penalty equilibrium: $K\\,u + \\lambda_{k} = F$.\n    *   In the contact-active regime, $g^{-} = u - g_{0}$.\n*   Objective: Derive the asymptotic expansion of the force prediction error $\\Delta \\lambda(k) = \\lambda_{k} - \\lambda_{\\text{exact}}$ as $k \\to \\infty$, up to and including the term of order $k^{-2}$.\n\n**Step 2: Validate Using Extracted Givens**\n\n*   **Scientifically Grounded:** The problem describes a canonical model of unilateral contact using a spring, a rigid barrier, and Karush-Kuhn-Tucker (KKT) or complementarity conditions. The penalty method is a standard, widely used technique for the numerical approximation of such constrained problems. All concepts are fundamental to contact mechanics and optimization theory. The setup is scientifically sound.\n*   **Well-Posed:** The problem is clearly defined. The assumption $F \\geq K\\,g_{0}$ ensures that contact occurs in the exact solution, making the distinction between contact-inactive and contact-active states unambiguous and simplifying the analysis. The goal of finding an asymptotic expansion is a standard mathematical objective for which a unique solution exists.\n*   **Objective:** The language is formal and mathematical, with no subjective or ambiguous terms.\n*   **Completeness:** All necessary equations, definitions, and parameters ($u, K, F, g_0, \\lambda, k, \\lambda_k$) are provided to derive the requested expression. The problem is self-contained.\n*   **Consistency:** The provided equations and conditions are mutually consistent. For instance, the condition $F \\geq K\\,g_{0}$ is consistent with the exact solution satisfying both $g(u)=0$ and $\\lambda \\geq 0$.\n\n**Step 3: Verdict and Action**\n\nThe problem statement is scientifically sound, well-posed, objective, complete, and consistent. It does not violate any of the invalidity criteria. Therefore, the problem is **valid**. I will proceed with the solution.\n\n**Part 2: Derivation of the Solution**\n\nThe objective is to find the asymptotic expansion of the error $\\Delta \\lambda(k) = \\lambda_{k} - \\lambda_{\\text{exact}}$. I will first find the exact solution ($\\lambda_{\\text{exact}}$) and then the penalty solution ($\\lambda_{k}$).\n\n**Step A: Determine the Exact Solution**\n\nIn the exact problem, the equilibrium equation and the complementarity conditions govern the system. The problem specifies the contact-active regime, where contact is made. This implies the gap is closed.\nFrom the complementarity conditions, a non-zero contact force $\\lambda  0$ can only exist if the gap is zero, $g(u) = 0$. The condition $F \\geq K g_0$ ensures this is the case.\nSetting the gap function to zero gives the exact displacement, $u_{\\text{exact}}$:\n$$g(u_{\\text{exact}}) = g_{0} - u_{\\text{exact}} = 0 \\implies u_{\\text{exact}} = g_{0}$$\nNow, substitute this displacement into the equilibrium equation to find the exact contact force, $\\lambda_{\\text{exact}}$:\n$$K u_{\\text{exact}} + \\lambda_{\\text{exact}} = F$$\n$$K g_{0} + \\lambda_{\\text{exact}} = F$$\n$$\\lambda_{\\text{exact}} = F - K g_{0}$$\nThe condition $F \\geq K g_0$ ensures that $\\lambda_{\\text{exact}} \\geq 0$, satisfying the complementarity conditions.\n\n**Step B: Determine the Penalty Solution**\n\nIn the penalty formulation, the complementarity condition $\\lambda g(u) = 0$ is relaxed. The penalty equilibrium equation is:\n$$K u_{k} + \\lambda_{k} = F$$\nwhere $u_k$ is the displacement in the penalty system. The penalty force $\\lambda_k$ is defined as:\n$$\\lambda_{k} = k g^{-} = k \\max\\{0, -g(u_k)\\}$$\nSince the system is in the contact-active regime, we anticipate that the displacement $u_k$ will result in a small penetration, meaning $u_k  g_0$. Therefore, the gap function $g(u_k) = g_0 - u_k$ will be negative. This gives:\n$$g^{-} = \\max\\{0, -(g_0 - u_k)\\} = u_k - g_0$$\nThe penalty force is thus:\n$$\\lambda_{k} = k(u_k - g_{0})$$\nWe now have a system of two linear equations for the two unknowns $u_k$ and $\\lambda_k$:\n1. $K u_k + \\lambda_k = F$\n2. $\\lambda_k = k(u_k - g_0)$\n\nTo solve for $\\lambda_k$, we can first express $u_k$ from the second equation:\n$$u_k = g_{0} + \\frac{\\lambda_k}{k}$$\nSubstitute this expression for $u_k$ into the first equation:\n$$K \\left( g_{0} + \\frac{\\lambda_k}{k} \\right) + \\lambda_k = F$$\n$$K g_{0} + \\frac{K}{k}\\lambda_k + \\lambda_k = F$$\nFactor out $\\lambda_k$:\n$$\\lambda_k \\left( \\frac{K}{k} + 1 \\right) = F - K g_{0}$$\n$$\\lambda_k \\left( \\frac{K+k}{k} \\right) = F - K g_{0}$$\nSolving for $\\lambda_k$ yields:\n$$\\lambda_k = (F - K g_{0}) \\frac{k}{k+K}$$\n\n**Step C: Calculate the Error and its Asymptotic Expansion**\n\nThe force prediction error is $\\Delta \\lambda(k) = \\lambda_{k} - \\lambda_{\\text{exact}}$. Substituting the expressions for $\\lambda_k$ and $\\lambda_{\\text{exact}}$:\n$$\\Delta \\lambda(k) = (F - K g_{0}) \\frac{k}{k+K} - (F - K g_{0})$$\nFactor out the common term $(F - K g_0)$:\n$$\\Delta \\lambda(k) = (F - K g_{0}) \\left( \\frac{k}{k+K} - 1 \\right)$$\n$$\\Delta \\lambda(k) = (F - K g_{0}) \\left( \\frac{k - (k+K)}{k+K} \\right)$$\n$$\\Delta \\lambda(k) = (F - K g_{0}) \\left( \\frac{-K}{k+K} \\right) = -K(F - K g_{0}) \\frac{1}{k+K}$$\nTo find the asymptotic expansion as $k \\to \\infty$, we expand the term $\\frac{1}{k+K}$. We factor out $k$ from the denominator:\n$$\\frac{1}{k+K} = \\frac{1}{k(1 + K/k)} = \\frac{1}{k} \\left( 1 + \\frac{K}{k} \\right)^{-1}$$\nUsing the geometric series expansion $(1+x)^{-1} = 1 - x + x^2 - x^3 + \\dots$ for $|x|1$, with $x = K/k$:\n$$\\left( 1 + \\frac{K}{k} \\right)^{-1} = 1 - \\frac{K}{k} + \\left(\\frac{K}{k}\\right)^2 - O\\left(k^{-3}\\right)$$\nSubstituting this back into the expression for $\\frac{1}{k+K}$:\n$$\\frac{1}{k+K} = \\frac{1}{k} \\left( 1 - \\frac{K}{k} + \\frac{K^2}{k^2} - O(k^{-3}) \\right) = \\frac{1}{k} - \\frac{K}{k^2} + \\frac{K^2}{k^3} - O(k^{-4})$$\nNow, substitute this expansion into the expression for $\\Delta \\lambda(k)$:\n$$\\Delta \\lambda(k) = -K(F - K g_{0}) \\left( \\frac{1}{k} - \\frac{K}{k^2} + O(k^{-3}) \\right)$$\nDistributing the term $-K(F - K g_0)$:\n$$\\Delta \\lambda(k) = -\\frac{K(F - K g_{0})}{k} + \\frac{K^2(F - K g_{0})}{k^2} + O(k^{-3})$$\nThe problem asks for the expansion up to and including the term of order $k^{-2}$. Truncating the series gives the final expression:\n$$\\Delta \\lambda(k) = -\\frac{K(F - K g_{0})}{k} + \\frac{K^2(F - K g_{0})}{k^2}$$", "answer": "$$\n\\boxed{-\\frac{K(F - K g_0)}{k} + \\frac{K^2(F - K g_0)}{k^2}}\n$$", "id": "3573078"}, {"introduction": "Real-world contact involves more than just normal impenetrability; friction is governed by its own set of complementarity conditions that determine stick or slip. This practice extends the KKT conditions to a coupled normal-tangential problem, where the stick state is defined by zero slip, $s_t=0$, and a sub-maximal friction force, $|r_t| \\le \\mu r_n$ [@problem_id:3573033]. By analyzing the problem, you will learn to navigate the case-based logic inherent to frictional contact and appreciate how normal and tangential responses can be coupled through the material's compliance.", "problem": "A linear elastic body is approximated at a single prospective contact point by a local compliance mapping in the contact frame with one normal and one tangential direction. Over a small quasi-static load increment, the condensed relation between the free (unconstrained) relative displacement increment and the contact reaction is assumed linear and given by\n$$\n\\begin{pmatrix}\ng_{n} \\\\\ns_{t}\n\\end{{pmatrix}\n=\n\\begin{pmatrix}\ng_{n}^{\\mathrm{tr}} \\\\\ns_{t}^{\\mathrm{tr}}\n\\end{pmatrix}\n+\n\\begin{pmatrix}\nc_{n}  \\alpha \\\\\n\\alpha  c_{t}\n\\end{pmatrix}\n\\begin{pmatrix}\nr_{n} \\\\\nr_{t}\n\\end{pmatrix},\n$$\nwhere $g_{n}$ is the post-correction normal gap increment, $s_{t}$ is the post-correction tangential slip increment, $g_{n}^{\\mathrm{tr}}$ and $s_{t}^{\\mathrm{tr}}$ are the trial (free) relative displacements in the normal and tangential directions, $r_{n}$ is the normal contact reaction (compression positive), and $r_{t}$ is the tangential contact reaction (sign convention: positive $r_{t}$ acts in the positive tangential direction). The coefficients $c_{n}$, $c_{t}$, and $\\alpha$ are the components of the symmetric positive definite local compliance matrix.\n\nImpenetrability and contact complementarity are enforced through the Karush–Kuhn–Tucker (KKT) conditions in the normal direction,\n$$\ng_{n} \\ge 0,\\quad r_{n} \\ge 0,\\quad r_{n}\\,g_{n} = 0,\n$$\nand two alternative friction models are considered in the tangential direction:\n\n1. Frictionless contact: $r_{t} = 0$.\n\n2. Coulomb friction with coefficient of friction $\\mu$: the set-valued law enforces either stick, with $s_{t} = 0$ and $|r_{t}| \\le \\mu\\,r_{n}$, or slip, with $s_{t} \\ne 0$, $|r_{t}| = \\mu\\,r_{n}$, and $r_{t}$ opposing the direction of $s_{t}$.\n\nAssume the following data for the increment: $c_{n} = 1.0 \\times 10^{-6}$, $c_{t} = 3.0 \\times 10^{-6}$, $\\alpha = 0.5 \\times 10^{-6}$, $g_{n}^{\\mathrm{tr}} = -1.0 \\times 10^{-4}$, $s_{t}^{\\mathrm{tr}} = 3.0 \\times 10^{-4}$, and $\\mu = 0.5$. All compliances are in $\\mathrm{m}/\\mathrm{N}$, all displacements are in $\\mathrm{m}$, and all reactions are in $\\mathrm{N}$. The rigid obstacle is a perfectly flat plane.\n\nStarting only from the above compliance mapping, the impenetrability complementarity conditions, and the Coulomb friction law, derive the normal reaction $r_{n}^{\\mathrm{F}}$ for the frictionless case and the normal reaction $r_{n}^{\\mathrm{C}}$ for the Coulomb friction case. Determine whether the Coulomb solution is stick or slip by checking consistency with the friction law and the KKT conditions. Then compute the ratio\n$$\n\\frac{r_{n}^{\\mathrm{C}}}{r_{n}^{\\mathrm{F}}}.\n$$\n\nAnswer as a single real number. No rounding is required. The ratio is dimensionless; do not include units in your final answer.", "solution": "The user wants me to solve the problem by following these steps.\n1.  **Problem Validation:** The problem is first validated to ensure it is scientifically sound, well-posed, and complete.\n\n    **Step 1: Extract Givens**\n    The givens are:\n    -   Compliance mapping:\n        $$\n        \\begin{pmatrix}\n        g_{n} \\\\\n        s_{t}\n        \\end{pmatrix}\n        =\n        \\begin{pmatrix}\n        g_{n}^{\\mathrm{tr}} \\\\\n        s_{t}^{\\mathrm{tr}}\n        \\end{pmatrix}\n        +\n        \\begin{pmatrix}\n        c_{n}  \\alpha \\\\\n        \\alpha  c_{t}\n        \\end{pmatrix}\n        \\begin{pmatrix}\n        r_{n} \\\\\n        r_{t}\n        \\end{pmatrix}\n        $$\n    -   Normal direction Karush-Kuhn-Tucker (KKT) conditions: $g_{n} \\ge 0$, $r_{n} \\ge 0$, $r_{n}\\,g_{n} = 0$.\n    -   Frictionless contact model: $r_{t} = 0$.\n    -   Coulomb friction model: stick ($s_{t} = 0$ and $|r_{t}| \\le \\mu\\,r_{n}$) or slip ($|r_{t}| = \\mu\\,r_{n}$ with $r_{t}$ opposing $s_{t}$).\n    -   Data: $c_{n} = 1.0 \\times 10^{-6} \\, \\mathrm{m/N}$, $c_{t} = 3.0 \\times 10^{-6} \\, \\mathrm{m/N}$, $\\alpha = 0.5 \\times 10^{-6} \\, \\mathrm{m/N}$, $g_{n}^{\\mathrm{tr}} = -1.0 \\times 10^{-4} \\, \\mathrm{m}$, $s_{t}^{\\mathrm{tr}} = 3.0 \\times 10^{-4} \\, \\mathrm{m}$, and $\\mu = 0.5$.\n\n    **Step 2: Validate Using Extracted Givens**\n    The problem is set within the standard framework of computational contact mechanics. The formulation using a local compliance matrix, KKT conditions for normal contact, and set-valued laws for friction is a cornerstone of the field. The provided compliance matrix is symmetric. Its positive definiteness must be checked:\n    -   $c_{n} = 1.0 \\times 10^{-6}  0$.\n    -   The determinant is $\\det(C) = c_{n}c_{t} - \\alpha^2 = (1.0 \\times 10^{-6})(3.0 \\times 10^{-6}) - (0.5 \\times 10^{-6})^2 = 3.0 \\times 10^{-12} - 0.25 \\times 10^{-12} = 2.75 \\times 10^{-12}  0$.\n    Since the leading principal minor and the determinant are positive, the compliance matrix is positive definite, which is physically and mathematically required for a stable system. The problem is scientifically grounded, well-posed, objective, and complete. All data and conditions are provided for a unique solution.\n\n    **Step 3: Verdict and Action**\n    The problem is deemed valid. A solution will be derived.\n\n2.  **Solution Derivation**\n\n    The problem requires the calculation of the normal reaction for two cases: frictionless contact ($r_{n}^{\\mathrm{F}}$) and Coulomb friction contact ($r_{n}^{\\mathrm{C}}$), followed by their ratio.\n\n    The trial normal gap is given as $g_{n}^{\\mathrm{tr}} = -1.0 \\times 10^{-4}  0$. A negative trial gap signifies interpenetration if no contact reaction were to develop. To satisfy the impenetrability condition $g_{n} \\ge 0$, a normal contact reaction $r_{n}  0$ must be generated. The KKT complementarity condition $r_{n}\\,g_{n} = 0$ then requires that the final gap be zero, i.e., $g_{n} = 0$. This holds for both the frictionless and the frictional cases.\n\n    **Case 1: Frictionless Contact**\n\n    For frictionless contact, the tangential reaction is zero by definition: $r_{t} = 0$. The compliance relation for the normal direction is:\n    $$\n    g_{n} = g_{n}^{\\mathrm{tr}} + c_{n}r_{n} + \\alpha r_{t}\n    $$\n    Substituting the conditions $g_{n} = 0$ and $r_{t} = 0$, we get:\n    $$\n    0 = g_{n}^{\\mathrm{tr}} + c_{n}r_{n}^{\\mathrm{F}}\n    $$\n    Solving for the normal reaction in the frictionless case, $r_{n}^{\\mathrm{F}}$:\n    $$\n    r_{n}^{\\mathrm{F}} = -\\frac{g_{n}^{\\mathrm{tr}}}{c_{n}}\n    $$\n    Substituting the given numerical values:\n    $$\n    r_{n}^{\\mathrm{F}} = -\\frac{-1.0 \\times 10^{-4} \\, \\mathrm{m}}{1.0 \\times 10^{-6} \\, \\mathrm{m/N}} = 100 \\, \\mathrm{N}\n    $$\n\n    **Case 2: Coulomb Friction Contact**\n\n    For the Coulomb friction case, we must determine whether the contact is in a stick or slip state. This is typically done by first assuming a stick condition and then verifying its validity.\n\n    **Assumption: Stick**\n    The stick condition dictates that the final tangential slip increment is zero: $s_{t} = 0$. We also have $g_{n} = 0$ from the normal contact condition. The compliance equations become a system of two linear equations for the unknown reactions $r_{n}$ and $r_{t}$:\n    $$\n    g_{n} = 0 = g_{n}^{\\mathrm{tr}} + c_{n}r_{n} + \\alpha r_{t}\n    $$\n    $$\n    s_{t} = 0 = s_{t}^{\\mathrm{tr}} + \\alpha r_{n} + c_{t}r_{t}\n    $$\n    This system can be written in matrix form:\n    $$\n    \\begin{pmatrix}\n    c_{n}  \\alpha \\\\\n    \\alpha  c_{t}\n    \\end{pmatrix}\n    \\begin{pmatrix}\n    r_{n} \\\\\n    r_{t}\n    \\end{pmatrix}\n    =\n    -\n    \\begin{pmatrix}\n    g_{n}^{\\mathrm{tr}} \\\\\n    s_{t}^{\\mathrm{tr}}\n    \\end{pmatrix}\n    $$\n    Solving for the reactions by matrix inversion:\n    $$\n    \\begin{pmatrix}\n    r_{n} \\\\\n    r_{t}\n    \\end{pmatrix}\n    =\n    -\\frac{1}{c_{n}c_{t} - \\alpha^2}\n    \\begin{pmatrix}\n    c_{t}  -\\alpha \\\\\n    -\\alpha  c_{n}\n    \\end{pmatrix}\n    \\begin{pmatrix}\n    g_{n}^{\\mathrm{tr}} \\\\\n    s_{t}^{\\mathrm{tr}}\n    \\end{pmatrix}\n    $$\n    We first calculate the reactions under this stick assumption.\n    The determinant is $\\det(C) = c_{n}c_{t} - \\alpha^2 = 2.75 \\times 10^{-12} \\, (\\mathrm{m/N})^2$.\n    The normal reaction for the stick assumption is:\n    $$\n    r_{n}^{\\mathrm{stick}} = -\\frac{c_{t}g_{n}^{\\mathrm{tr}} - \\alpha s_{t}^{\\mathrm{tr}}}{c_{n}c_{t} - \\alpha^2} = \\frac{- (3.0 \\times 10^{-6})(-1.0 \\times 10^{-4}) + (0.5 \\times 10^{-6})(3.0 \\times 10^{-4})}{2.75 \\times 10^{-12}}\n    $$\n    $$\n    r_{n}^{\\mathrm{stick}} = \\frac{3.0 \\times 10^{-10} + 1.5 \\times 10^{-10}}{2.75 \\times 10^{-12}} = \\frac{4.5 \\times 10^{-10}}{2.75 \\times 10^{-12}} = \\frac{4.5}{2.75} \\times 10^2 = \\frac{18}{11} \\times 100 = \\frac{1800}{11} \\, \\mathrm{N}\n    $$\n    The tangential reaction for the stick assumption is:\n    $$\n    r_{t}^{\\mathrm{stick}} = -\\frac{-\\alpha g_{n}^{\\mathrm{tr}} + c_{n}s_{t}^{\\mathrm{tr}}}{c_{n}c_{t} - \\alpha^2} = \\frac{- (-(0.5 \\times 10^{-6}))(-1.0 \\times 10^{-4}) - (1.0 \\times 10^{-6})(3.0 \\times 10^{-4})}{2.75 \\times 10^{-12}}\n    $$\n    $$\n    r_{t}^{\\mathrm{stick}} = \\frac{-0.5 \\times 10^{-10} - 3.0 \\times 10^{-10}}{2.75 \\times 10^{-12}} = \\frac{-3.5 \\times 10^{-10}}{2.75 \\times 10^{-12}} = -\\frac{3.5}{2.75} \\times 10^2 = -\\frac{14}{11} \\times 100 = -\\frac{1400}{11} \\, \\mathrm{N}\n    $$\n    **Verification of Stick Assumption**\n    For the stick assumption to be valid, the tangential reaction must satisfy the friction inequality $|r_{t}^{\\mathrm{stick}}| \\le \\mu r_{n}^{\\mathrm{stick}}$.\n    $$\n    |r_{t}^{\\mathrm{stick}}| = \\left|-\\frac{1400}{11}\\right| = \\frac{1400}{11} \\, \\mathrm{N}\n    $$\n    $$\n    \\mu r_{n}^{\\mathrm{stick}} = 0.5 \\times \\frac{1800}{11} = \\frac{900}{11} \\, \\mathrm{N}\n    $$\n    Comparing the two values, we find that $\\frac{1400}{11}  \\frac{900}{11}$. Thus, the condition $|r_{t}^{\\mathrm{stick}}| \\le \\mu r_{n}^{\\mathrm{stick}}$ is violated. The stick assumption is invalid, and the contact point must be in a state of slip.\n\n    **Calculation for Slip**\n    In the slip state, the magnitude of the tangential reaction is related to the normal reaction by the friction coefficient: $|r_{t}| = \\mu r_{n}$. The direction of the tangential force opposes the direction of relative motion (or impending motion). The trial slip is $s_{t}^{\\mathrm{tr}} = 3.0 \\times 10^{-4}  0$, and the calculated stick friction force $r_{t}^{\\mathrm{stick}} = -1400/11  0$ both indicate that the friction force acts in the negative tangential direction. Therefore, we have:\n    $$\n    r_{t} = -\\mu r_{n}\n    $$\n    We substitute this relationship into the normal compliance equation with $g_{n} = 0$:\n    $$\n    0 = g_{n}^{\\mathrm{tr}} + c_{n}r_{n} + \\alpha r_{t} = g_{n}^{\\mathrm{tr}} + c_{n}r_{n} + \\alpha(-\\mu r_{n})\n    $$\n    $$\n    0 = g_{n}^{\\mathrm{tr}} + (c_{n} - \\alpha \\mu)r_{n}\n    $$\n    Solving for the normal reaction in the Coulomb friction case, $r_{n}^{\\mathrm{C}}$:\n    $$\n    r_{n}^{\\mathrm{C}} = -\\frac{g_{n}^{\\mathrm{tr}}}{c_{n} - \\alpha \\mu}\n    $$\n    Substitute the numerical values:\n    $$\n    c_{n} - \\alpha \\mu = (1.0 \\times 10^{-6}) - (0.5 \\times 10^{-6})(0.5) = (1.0 - 0.25) \\times 10^{-6} = 0.75 \\times 10^{-6} \\, \\mathrm{m/N}\n    $$\n    $$\n    r_{n}^{\\mathrm{C}} = -\\frac{-1.0 \\times 10^{-4} \\, \\mathrm{m}}{0.75 \\times 10^{-6} \\, \\mathrm{m/N}} = \\frac{1.0}{0.75} \\times 10^2 \\, \\mathrm{N} = \\frac{4}{3} \\times 100 \\, \\mathrm{N} = \\frac{400}{3} \\, \\mathrm{N}\n    $$\n    The slip is non-zero, consistent with the slip assumption. The magnitude is $s_{t} = s_{t}^{\\mathrm{tr}} + (\\alpha - c_{t}\\mu)r_{n}^{\\mathrm{C}} = 3.0 \\times 10^{-4} + (0.5 \\times 10^{-6} - 3.0 \\times 10^{-6} \\times 0.5)(400/3) = 3.0 \\times 10^{-4} - 1.0 \\times 10^{-6} \\times (400/3) = (3 - 4/3) \\times 10^{-4} = 5/3 \\times 10^{-4}  0$. The resulting slip is positive, which is consistent with the negative friction force $r_{t} = -\\mu r_{n}^{\\mathrm{C}}  0$.\n\n    **Final Calculation: Ratio**\n\n    Finally, we compute the required ratio:\n    $$\n    \\frac{r_{n}^{\\mathrm{C}}}{r_{n}^{\\mathrm{F}}} = \\frac{400/3 \\, \\mathrm{N}}{100 \\, \\mathrm{N}} = \\frac{400}{300} = \\frac{4}{3}\n    $$\n    This is the final answer. The ratio is a dimensionless quantity, as required.", "answer": "$$\\boxed{\\frac{4}{3}}$$", "id": "3573033"}, {"introduction": "The final step in mastering contact mechanics is translating theory into a working computational tool. This hands-on exercise challenges you to implement a robust solver for a unilateral contact problem by reformulating the KKT conditions $\\lambda \\ge 0$, $g(\\mathbf{u}) \\ge 0$, and $\\lambda g(\\mathbf{u}) = 0$ as a single, smooth-enough equation using a Fischer-Burmeister function, $\\phi(g, s\\lambda)=0$ [@problem_id:3573041]. You will derive the consistent tangent matrix for the resulting nonlinear system and implement a semismooth Newton method, a powerful technique for handling the non-smooth nature of contact.", "problem": "Consider a frictionless, unilateral contact between a deformable body and a rigid, fixed plane under finite deformation kinematics. Let the current position of a representative contact point be $\\mathbf{x}(\\mathbf{X}) = \\mathbf{X} + \\mathbf{u}$, where $\\mathbf{X}$ is the material coordinate and $\\mathbf{u}$ is the displacement. Impenetrability is enforced by a scalar gap function $g(\\mathbf{u}) \\ge 0$, a nonnegative Lagrange multiplier $\\lambda \\ge 0$ interpreted as the normal contact force intensity, and the complementarity condition $\\lambda\\, g(\\mathbf{u}) = 0$. The unknowns are the displacement field and the Lagrange multiplier field. Start from the principle of virtual work and the Kuhn–Tucker complementarity conditions and perform a finite element discretization that enforces impenetrability at a node-to-rigid-plane contact in the current configuration.\n\nAssume the following fundamental base:\n- The principle of virtual work: the sum of internal, external, and contact virtual works vanishes at equilibrium.\n- Finite deformation mapping: $\\mathbf{x} = \\mathbf{X} + \\mathbf{u}$ and the contact gap is evaluated in the current configuration.\n- Contact impenetrability and complementarity (Kuhn–Tucker): $g(\\mathbf{u}) \\ge 0$, $\\lambda \\ge 0$, $\\lambda\\, g(\\mathbf{u}) = 0$.\n- Use a nodal, point-wise Lagrange multiplier for the contact constraint (node-to-rigid-plane), and a rigid plane with fixed unit normal $\\mathbf{n}$.\n\nTo ensure dimensional consistency in the complementarity reformulation, introduce a positive scaling parameter $s$ with units of meters per Newton so that $s\\,\\lambda$ has units of meters like $g(\\mathbf{u})$. Reformulate the complementarity using the Fischer–Burmeister function $\\phi(a,b) = \\sqrt{a^2 + b^2} - (a + b)$ applied to $(g(\\mathbf{u}), s\\,\\lambda)$. For numerical robustness, you may consider a smoothed variant $\\phi_\\mu(a,b) = \\sqrt{a^2 + b^2 + \\mu^2} - (a + b)$ with a small smoothing parameter $\\mu  0$ having units of meters.\n\nTask A (derivation): Starting from the principle of virtual work and the above definitions, specialize to a single nodal contact degree of freedom in the normal direction to the rigid plane. Let the rigid plane be $\\Gamma_c: \\mathbf{x}\\cdot\\mathbf{n} = 0$, with $\\mathbf{n}$ fixed. Let the representative node have an initial signed distance $y_0 = \\mathbf{X}\\cdot\\mathbf{n}  0$ from the plane along $\\mathbf{n}$, and a scalar displacement $u = \\mathbf{u}\\cdot\\mathbf{n}$ along $\\mathbf{n}$. The gap is $g(u) = y_0 + u \\ge 0$. Assume a linear elastic support of the node modeled by a scalar stiffness $k$ (in Newtons per meter) in the normal direction, so that, in the absence of contact, the internal nodal force equals $k\\,u$. Let the external nodal force along the normal be $f_{\\mathrm{ext}}$ (in Newtons), positive in the direction of $\\mathbf{n}$. Derive:\n- The discrete residual of equilibrium in the normal direction and the contact residual using the Fischer–Burmeister complementarity reformulation with scaling $s$ (and optionally smoothing $\\mu$).\n- The consistent tangent (Jacobian) for a semismooth Newton method applied to the coupled system of equilibrium and complementarity equations. Express all derivatives explicitly in terms of $u$, $\\lambda$, $g(u)$, $k$, $s$, and $\\mu$.\n\nTask B (algorithm): Design a semismooth Newton iteration that solves the coupled nonlinear system for $(u, \\lambda)$ using the consistent tangent derived in Task A. Use a stopping criterion based on the norm of the residual being less than a tolerance. To avoid non-differentiability at $(g,\\lambda) = (0,0)$, use the smoothed Fischer–Burmeister function $\\phi_\\mu$ with a small smoothing parameter $\\mu  0$.\n\nTest suite and numerical specification: Implement your derivation in a complete, runnable program and solve the following test cases. All quantities must be handled in the International System of Units (SI). Report each displacement in meters and each Lagrange multiplier in Newtons.\n\n- Test case $1$ (inactive contact): $k = 1000\\,\\mathrm{N/m}$, $y_0 = 0.01\\,\\mathrm{m}$, $f_{\\mathrm{ext}} = -2\\,\\mathrm{N}$, $s = 10^{-4}\\,\\mathrm{m/N}$, $\\mu = 10^{-12}\\,\\mathrm{m}$.\n- Test case $2$ (active contact): $k = 1000\\,\\mathrm{N/m}$, $y_0 = 0.01\\,\\mathrm{m}$, $f_{\\mathrm{ext}} = -50\\,\\mathrm{N}$, $s = 10^{-4}\\,\\mathrm{m/N}$, $\\mu = 10^{-12}\\,\\mathrm{m}$.\n- Test case $3$ (boundary case at onset): $k = 1000\\,\\mathrm{N/m}$, $y_0 = 0.01\\,\\mathrm{m}$, $f_{\\mathrm{ext}} = -10\\,\\mathrm{N}$, $s = 10^{-4}\\,\\mathrm{m/N}$, $\\mu = 10^{-12}\\,\\mathrm{m}$.\n- Test case $4$ (neutral corner): $k = 1000\\,\\mathrm{N/m}$, $y_0 = 0.0\\,\\mathrm{m}$, $f_{\\mathrm{ext}} = 0\\,\\mathrm{N}$, $s = 10^{-4}\\,\\mathrm{m/N}$, $\\mu = 10^{-12}\\,\\mathrm{m}$.\n\nAnswer specification:\n- For each test case, numerically solve for $(u, \\lambda)$.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, ordered as $[u_1, \\lambda_1, u_2, \\lambda_2, u_3, \\lambda_3, u_4, \\lambda_4]$ with each floating-point number rounded to six decimal places.", "solution": "The problem statement is assessed to be valid as it is scientifically grounded in computational contact mechanics, well-posed, objective, and provides a complete and consistent setup for a solvable numerical problem.\n\nThe task is to derive the governing equations and the consistent tangent for a one-dimensional, node-to-plane contact problem, and then to implement a semismooth Newton method to solve for the nodal displacement $u$ and the contact force (Lagrange multiplier) $\\lambda$.\n\n### 1. Derivation of the Governing Equations\n\nThe system is defined by two primary unknowns: the displacement $u$ along the normal to the rigid plane, and the contact force magnitude $\\lambda$. We need to formulate a system of two equations, $\\mathbf{R}(u, \\lambda) = \\mathbf{0}$, to solve for these unknowns.\n\nThe first equation arises from the equilibrium of forces acting on the node. Following the standard finite element formulation, the residual of equilibrium $R_u$ is the difference between the sum of external forces and the internal forces. The forces along the direction of the outward normal $\\mathbf{n}$ are:\n- The internal restoring force from the linear elastic support of stiffness $k$. This force is given as $F_{\\mathrm{int}} = k\\,u$.\n- The externally applied force, $f_{\\mathrm{ext}}$.\n- The contact force, $\\lambda$, which acts on the node in the direction of $\\mathbf{n}$ and must be non-negative, $\\lambda \\ge 0$.\n\nThe equilibrium equation is formed by stating that the internal force must balance the total external force (applied plus contact):\n$$ k\\,u = f_{\\mathrm{ext}} + \\lambda $$\nThe corresponding residual equation, for which we seek a root, is:\n$$ R_u(u, \\lambda) = k\\,u - f_{\\mathrm{ext}} - \\lambda = 0 $$\n\nThe second equation enforces the contact constraints, also known as the Kuhn-Tucker conditions for unilateral contact:\n1.  **Impenetrability**: The gap $g(u)$ must be non-negative. The gap is the current distance of the node from the rigid plane at position $0$. With an initial distance of $y_0$ and a displacement $u$, the gap is $g(u) = y_0 + u \\ge 0$.\n2.  **Non-tensile Force**: The contact force must be compressive (or zero), so $\\lambda \\ge 0$.\n3.  **Complementarity**: A contact force can only be generated if the gap is closed ($g(u)=0$). This is expressed as $\\lambda\\,g(u) = 0$.\n\nThese three conditions are compactly expressed by reformulating them into a single equation using the smoothed Fischer-Burmeister function, $\\phi_\\mu(a,b) = \\sqrt{a^2 + b^2 + \\mu^2} - (a+b)$. This function has the property that $\\phi_\\mu(a,b) \\approx 0$ is equivalent to the complementarity conditions for $a$ and $b$. To ensure dimensional consistency, we apply the function to the pair $(g(u), s\\lambda)$, where $s$ is a scaling parameter with units of m/N. This leads to the second residual equation:\n$$ R_\\lambda(u, \\lambda) = \\phi_\\mu(g(u), s\\lambda) = \\sqrt{(y_0+u)^2 + (s\\lambda)^2 + \\mu^2} - (y_0 + u + s\\lambda) = 0 $$\n\nThe complete system of nonlinear equations to solve for the state vector $\\mathbf{v} = [u, \\lambda]^T$ is:\n$$ \\mathbf{R}(\\mathbf{v}) = \\begin{Bmatrix} R_u(u, \\lambda) \\\\ R_\\lambda(u, \\lambda) \\end{Bmatrix} = \\begin{Bmatrix} k\\,u - f_{\\mathrm{ext}} - \\lambda \\\\ \\sqrt{(y_0+u)^2 + (s\\lambda)^2 + \\mu^2} - (y_0 + u + s\\lambda) \\end{Bmatrix} = \\mathbf{0} $$\n\n### 2. Derivation of the Consistent Tangent (Jacobian)\n\nTo solve this system with a semismooth Newton method, we require the Jacobian of the residual vector $\\mathbf{R}$ with respect to the state vector $\\mathbf{v}$. This Jacobian is the consistent tangent matrix $\\mathbf{K}_T$.\n$$ \\mathbf{K}_T(\\mathbf{v}) = \\frac{\\partial \\mathbf{R}}{\\partial \\mathbf{v}} = \\begin{bmatrix} \\frac{\\partial R_u}{\\partial u}  \\frac{\\partial R_u}{\\partial \\lambda} \\\\ \\frac{\\partial R_\\lambda}{\\partial u}  \\frac{\\partial R_\\lambda}{\\partial \\lambda} \\end{bmatrix} $$\nWe compute each component of this $2 \\times 2$ matrix:\n\n- **Derivative of $R_u$**:\n  $$ \\frac{\\partial R_u}{\\partial u} = \\frac{\\partial}{\\partial u}(k\\,u - f_{\\mathrm{ext}} - \\lambda) = k $$\n  $$ \\frac{\\partial R_u}{\\partial \\lambda} = \\frac{\\partial}{\\partial \\lambda}(k\\,u - f_{\\mathrm{ext}} - \\lambda) = -1 $$\n\n- **Derivative of $R_\\lambda$**: Let $g = y_0+u$ and $C = \\sqrt{(y_0+u)^2 + (s\\lambda)^2 + \\mu^2}$ for clarity.\n  The derivative with respect to $u$ is:\n  $$ \\frac{\\partial R_\\lambda}{\\partial u} = \\frac{\\partial}{\\partial u} \\left( C - (g+s\\lambda) \\right) = \\frac{\\partial C}{\\partial g}\\frac{\\partial g}{\\partial u} - \\frac{\\partial g}{\\partial u} = \\left(\\frac{g}{C} - 1\\right) \\frac{\\partial g}{\\partial u} $$\n  Since $\\frac{\\partial g}{\\partial u} = 1$, we have:\n  $$ \\frac{\\partial R_\\lambda}{\\partial u} = \\frac{g(u)}{C} - 1 = \\frac{y_0+u}{\\sqrt{(y_0+u)^2 + (s\\lambda)^2 + \\mu^2}} - 1 $$\n  The derivative with respect to $\\lambda$ is:\n  $$ \\frac{\\partial R_\\lambda}{\\partial \\lambda} = \\frac{\\partial}{\\partial \\lambda} \\left( C - (g+s\\lambda) \\right) = \\frac{\\partial C}{\\partial \\lambda} - \\frac{\\partial(s\\lambda)}{\\partial \\lambda} = \\frac{s \\cdot (s\\lambda)}{C} - s $$\n  Factoring out the scaling parameter $s$:\n  $$ \\frac{\\partial R_\\lambda}{\\partial \\lambda} = s\\left(\\frac{s\\lambda}{C} - 1\\right) = s\\left(\\frac{s\\lambda}{\\sqrt{(y_0+u)^2 + (s\\lambda)^2 + \\mu^2}} - 1\\right) $$\n\nThe complete consistent tangent matrix is therefore:\n$$ \\mathbf{K}_T(u,\\lambda) = \\begin{bmatrix} k  -1 \\\\ \\frac{y_0+u}{C} - 1  s\\left(\\frac{s\\lambda}{C} - 1\\right) \\end{bmatrix} $$\nwhere $C = \\sqrt{(y_0+u)^2 + (s\\lambda)^2 + \\mu^2}$.\n\n### 3. Algorithm: Semismooth Newton Method\n\nThe numerical algorithm solves $\\mathbf{R}(\\mathbf{v})=\\mathbf{0}$ iteratively. Starting from an initial guess $\\mathbf{v}_0$ (e.g., $\\mathbf{v}_0=[0,0]^T$), each iteration $i$ involves:\n1.  Computing the residual $\\mathbf{R}_i = \\mathbf{R}(\\mathbf{v}_i)$.\n2.  Checking if $||\\mathbf{R}_i||$ is below a tolerance. If so, the solution is found.\n3.  Computing the tangent matrix $\\mathbf{K}_{T,i} = \\mathbf{K}_T(\\mathbf{v}_i)$.\n4.  Solving the linear system $\\mathbf{K}_{T,i} \\Delta \\mathbf{v}_i = -\\mathbf{R}_i$ for the update $\\Delta \\mathbf{v}_i$.\n5.  Updating the solution: $\\mathbf{v}_{i+1} = \\mathbf{v}_i + \\Delta \\mathbf{v}_i$.\nThis process is repeated until convergence. The implemented code uses these derivations to solve the specified test cases.", "answer": "```python\n# The final answer must be a single, complete, standalone program.\n# This program implements the semismooth Newton method for a 1D contact problem.\n\nimport numpy as np\n\ndef solve_contact(k, y0, f_ext, s, mu, tol=1e-12, max_iter=20):\n    \"\"\"\n    Solves the 1D frictionless contact problem using a semismooth Newton method\n    with a Fischer-Burmeister complementarity reformulation.\n\n    Args:\n        k (float): Spring stiffness (N/m).\n        y0 (float): Initial gap (m).\n        f_ext (float): External force (N).\n        s (float): Scaling parameter (m/N).\n        mu (float): Smoothing parameter (m).\n        tol (float): Convergence tolerance for the residual norm.\n        max_iter (int): Maximum number of Newton iterations.\n\n    Returns:\n        tuple: A tuple (u, lam) containing the converged displacement (m)\n               and Lagrange multiplier (N).\n    \"\"\"\n    # Initial guess for displacement (u) and Lagrange multiplier (lam)\n    u, lam = 0.0, 0.0\n\n    for _ in range(max_iter):\n        # --- Evaluate state-dependent quantities ---\n        \n        # Gap function\n        g = y0 + u\n        \n        # Term inside the square root of the Fischer-Burmeister function\n        # This is guaranteed to be non-negative.\n        C_squared_arg = g**2 + (s * lam)**2 + mu**2\n        C = np.sqrt(C_squared_arg)\n\n        # --- Assemble the residual vector R = [R_u, R_lambda] ---\n        \n        # Residual of the equilibrium equation\n        R_u = k * u - f_ext - lam\n        \n        # Residual of the complementarity equation (Fischer-Burmeister)\n        R_lam = C - (g + s * lam) \n        \n        R = np.array([R_u, R_lam])\n\n        # --- Check for convergence ---\n        if np.linalg.norm(R)  tol:\n            break\n\n        # --- Assemble the consistent tangent (Jacobian) matrix K_T ---\n        \n        K_T_11 = k\n        K_T_12 = -1.0\n        K_T_21 = g / C - 1.0\n        K_T_22 = s * (s * lam / C - 1.0)\n        \n        K_T = np.array([[K_T_11, K_T_12], [K_T_21, K_T_22]])\n\n        # --- Solve the linear system K_T * dv = -R for the update dv ---\n        try:\n            dv = np.linalg.solve(K_T, -R)\n        except np.linalg.LinAlgError:\n            # Safeguard in case the Jacobian becomes singular,\n            # which is unlikely with mu  0 for this well-posed problem.\n            break\n            \n        # --- Update the solution vector [u, lam] ---\n        u += dv[0]\n        lam += dv[1]\n\n    # Post-processing: ensure the contact force is non-negative, as a small\n    # negative value can result from the smoothing for inactive contact.\n    if lam  0:\n        lam = 0.0\n\n    return u, lam\n\ndef solve():\n    \"\"\"\n    Main function to define and run the test suite, then print results\n    in the specified format.\n    \"\"\"\n    # Define the test cases from the problem statement:\n    # (k [N/m], y0 [m], f_ext [N], s [m/N], mu [m])\n    test_cases = [\n        (1000.0, 0.01, -2.0, 1e-4, 1e-12),   # Case 1 (inactive contact)\n        (1000.0, 0.01, -50.0, 1e-4, 1e-12),  # Case 2 (active contact)\n        (1000.0, 0.01, -10.0, 1e-4, 1e-12),  # Case 3 (boundary case)\n        (1000.0, 0.0, 0.0, 1e-4, 1e-12)      # Case 4 (neutral corner)\n    ]\n\n    results_list = []\n    for case in test_cases:\n        k, y0, f_ext, s, mu = case\n        u, lam = solve_contact(k, y0, f_ext, s, mu)\n        results_list.append(u)\n        results_list.append(lam)\n\n    # Format the results to 6 decimal places and join into the required string format.\n    formatted_results = [f\"{x:.6f}\" for x in results_list]\n    print(f\"[{','.join(formatted_results)}]\")\n\n# Execute the solver\nsolve()\n```", "id": "3573041"}]}