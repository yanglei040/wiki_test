{"hands_on_practices": [{"introduction": "This first exercise grounds the abstract theories of Lagrange multiplier and penalty methods in a simple, tangible problem that can be solved by hand. By working through a two-element bar model, you will directly compare how these two fundamental techniques enforce a displacement constraint, revealing their distinct mathematical structures and numerical consequences. This practice is essential for understanding the trade-off between the exact but indefinite Lagrange multiplier system and the approximate but numerically ill-conditioned penalty system [@problem_id:3586814].", "problem": "Consider a straight, prismatic bar occupying the interval $x \\in [0,2]$ with constant Young’s modulus $E$, cross-sectional area $A$, and no body forces. The bar is modeled by two equal-length, linear, two-node finite elements (nodes at $x=0,1,2$). A nodal force of magnitude $1$ is applied at the right end $x=2$, and the kinematic boundary condition $u(0)=0$ is to be enforced. Adopt the nondimensionalization $EA=1$ and element length $h=1$, so that all stiffness entries are dimensionless and the applied nodal force has magnitude $1$ in these nondimensional units. Let $u_1$, $u_2$, $u_3$ denote the nodal displacements at $x=0,1,2$, respectively.\n\nStarting from the principle of minimum potential energy and the strain-displacement relation for one-dimensional linear elasticity, perform the following:\n\n1) Derive the element stiffness matrix and assemble the global stiffness matrix for the unconstrained three-degree-of-freedom model (with no boundary condition imposed yet). Assemble the consistent global load vector corresponding to the single nodal force at $x=2$.\n\n2) Enforce $u(0)=0$ by:\n- A single Lagrange multiplier $\\lambda$ in a Karush–Kuhn–Tucker (KKT) saddle-point system. Solve exactly for the nodal displacements and the multiplier.\n- A penalty method with parameter $\\beta>0$ by augmenting the global stiffness matrix with a rank-one term targeting $u_1$ and leaving the load vector unchanged (the prescribed displacement is zero). Solve exactly for the nodal displacements as functions of $\\beta$.\n\n3) Justify, by a limit argument tied to the structure of the assembled matrices, that the penalty solution converges to the Lagrange multiplier solution as $\\beta \\to \\infty$.\n\n4) Let $\\kappa_2(\\boldsymbol{K}_\\beta)$ denote the $2$-norm condition number of the symmetric positive definite penalty stiffness matrix $\\boldsymbol{K}_\\beta$, i.e., the ratio of its largest to smallest eigenvalues. Using the assembly in this specific two-element setting and without appealing to any external formula, determine the exact constant $c$ such that\n$$\n\\kappa_2(\\boldsymbol{K}_\\beta) \\sim c\\,\\beta \\quad \\text{as } \\beta \\to \\infty,\n$$\nwhere $\\sim$ denotes asymptotic equivalence. You may use any valid spectral argument grounded in the assembled matrices and their limits as $\\beta \\to \\infty$.\n\nGive your final answer as the exact closed-form expression for the constant $c$ (dimensionless). Do not round.", "solution": "The problem is first validated against the specified criteria.\n\n### Problem Validation\n**Step 1: Extract Givens**\n- A straight, prismatic bar on the interval $x \\in [0,2]$.\n- Constant Young’s modulus $E$ and cross-sectional area $A$.\n- No body forces.\n- Modeled by two equal-length, linear, two-node finite elements with nodes at $x=0, 1, 2$.\n- A nodal force of magnitude $1$ is applied at $x=2$.\n- Kinematic boundary condition: $u(0)=0$.\n- Nondimensionalization: $EA=1$ and element length $h=1$.\n- Nodal displacements are denoted $u_1, u_2, u_3$ at $x=0, 1, 2$, respectively.\n- Task 1: Derive element and global stiffness matrices and the global load vector for the unconstrained system.\n- Task 2: Enforce $u(0)=0$ using a Lagrange multiplier and a penalty method, and solve for nodal displacements.\n- Task 3: Justify the convergence of the penalty solution to the Lagrange multiplier solution as the penalty parameter $\\beta \\to \\infty$.\n- Task 4: Determine the constant $c$ in the asymptotic behavior of the condition number $\\kappa_2(\\boldsymbol{K}_\\beta) \\sim c\\,\\beta$ as $\\beta \\to \\infty$.\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientifically Grounded**: The problem is a standard exercise in computational solid mechanics, applying the finite element method to a one-dimensional elasticity problem. The concepts of potential energy, stiffness matrices, Lagrange multipliers, and penalty methods are fundamental and correctly applied.\n- **Well-Posed**: The problem is clearly defined with sufficient information to derive a unique solution. The boundary conditions and applied loads are specified, ensuring a non-trivial, unique displacement field.\n- **Objective**: The problem is stated using precise, technical language, free from any subjectivity or ambiguity.\n- **Completeness and Consistency**: All necessary parameters ($EA, h$) and conditions are provided. The problem is self-contained and free of contradictions.\n- **Realism and Feasibility**: The problem describes a simplified but physically realistic mechanical system. The nondimensionalization is a standard practice in mechanics.\n- **Structure and Triviality**: The problem is well-structured, progressing from fundamental derivations to more advanced analysis of numerical methods. It requires substantive calculation and conceptual understanding, particularly for the asymptotic analysis of the condition number, and is therefore not trivial.\n\n**Step 3: Verdict and Action**\nThe problem is deemed **valid**. A full solution is warranted.\n\n### Solution\n\n**1) Element and Global System Derivation**\n\nThe potential energy functional for the one-dimensional bar is given by $\\Pi = U - W_{ext}$, where $U$ is the strain energy and $W_{ext}$ is the potential of the external forces.\n$U = \\frac{1}{2} \\int_0^2 EA \\left(\\frac{du}{dx}\\right)^2 dx$ and $W_{ext} = \\boldsymbol{F}^T \\boldsymbol{u}$, where $\\boldsymbol{u}=\\{u_1, u_2, u_3\\}^T$.\nFor a single linear, two-node finite element of length $h$ with nodal displacements $u_i$ and $u_{i+1}$, the displacement field is $u^{(e)}(x') = (1-x'/h)u_i + (x'/h)u_{i+1}$, where $x'$ is the local coordinate within the element. The strain is constant: $\\epsilon^{(e)} = \\frac{du^{(e)}}{dx'} = \\frac{u_{i+1}-u_i}{h}$.\nThe strain energy for one element is\n$U^{(e)} = \\frac{1}{2} \\int_0^h EA (\\epsilon^{(e)})^2 dx' = \\frac{1}{2} EA \\left(\\frac{u_{i+1}-u_i}{h}\\right)^2 h = \\frac{1}{2}\\frac{EA}{h}(u_{i+1}-u_i)^2$.\nThis quadratic form can be written as $U^{(e)} = \\frac{1}{2} \\begin{pmatrix} u_i & u_{i+1} \\end{pmatrix} \\boldsymbol{k}^{(e)} \\begin{pmatrix} u_i \\\\ u_{i+1} \\end{pmatrix}$.\nBy expanding $(u_{i+1}-u_i)^2 = u_i^2 - 2u_i u_{i+1} + u_{i+1}^2$, we identify the element stiffness matrix:\n$\\boldsymbol{k}^{(e)} = \\frac{EA}{h} \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix}$.\nWith the given nondimensionalization $EA=1$ and $h=1$, the element stiffness matrix is $\\boldsymbol{k}^{(e)} = \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix}$.\n\nThe system consists of two elements: one connecting nodes $1$ and $2$, and another connecting nodes $2$ and $3$. The global stiffness matrix $\\boldsymbol{K}$ is assembled by summing the contributions from each element:\n$\\boldsymbol{K} = \\begin{pmatrix} 1 & -1 & 0 \\\\ -1 & 1 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix} + \\begin{pmatrix} 0 & 0 & 0 \\\\ 0 & 1 & -1 \\\\ 0 & -1 & 1 \\end{pmatrix} = \\begin{pmatrix} 1 & -1 & 0 \\\\ -1 & 2 & -1 \\\\ 0 & -1 & 1 \\end{pmatrix}$.\n\nThe global load vector $\\boldsymbol{F}$ represents the nodal forces. A force of magnitude $1$ is applied at node $3$ ($x=2$), so the vector is:\n$\\boldsymbol{F} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix}$.\n\n**2) Enforcement of the Boundary Condition $u(0)=0$**\n\n*   **Lagrange Multiplier Method:**\nThe constraint is $u_1=0$. The augmented potential energy (Lagrangian) is $\\mathcal{L}(\\boldsymbol{u}, \\lambda) = \\frac{1}{2}\\boldsymbol{u}^T \\boldsymbol{K} \\boldsymbol{u} - \\boldsymbol{u}^T \\boldsymbol{F} + \\lambda u_1$.\nThe stationarity conditions $\\nabla_{\\boldsymbol{u}} \\mathcal{L} = \\boldsymbol{0}$ and $\\frac{\\partial \\mathcal{L}}{\\partial \\lambda} = 0$ yield the Karush–Kuhn–Tucker (KKT) system:\n$$\n\\begin{pmatrix} \\boldsymbol{K} & \\boldsymbol{C} \\\\ \\boldsymbol{C}^T & 0 \\end{pmatrix} \\begin{pmatrix} \\boldsymbol{u} \\\\ \\lambda \\end{pmatrix} = \\begin{pmatrix} \\boldsymbol{F} \\\\ g \\end{pmatrix}\n$$\nwhere $\\boldsymbol{C} = \\{1, 0, 0\\}^T$ and $g=0$. Substituting the matrices:\n$$\n\\begin{pmatrix}\n1 & -1 & 0 & 1 \\\\\n-1 & 2 & -1 & 0 \\\\\n0 & -1 & 1 & 0 \\\\\n1 & 0 & 0 & 0\n\\end{pmatrix}\n\\begin{pmatrix} u_1 \\\\ u_2 \\\\ u_3 \\\\ \\lambda \\end{pmatrix}\n=\n\\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\\\ 0 \\end{pmatrix}\n$$\nThe fourth equation gives $u_1=0$.\nFrom the third equation, $-u_2 + u_3 = 1$, so $u_3 = u_2+1$.\nSubstituting $u_1=0$ into the second equation gives $2u_2 - u_3 = 0$, so $u_3 = 2u_2$.\nEquating the expressions for $u_3$: $u_2+1 = 2u_2 \\implies u_2 = 1$.\nThen $u_3 = 2(1) = 2$.\nFinally, from the first equation, $u_1 - u_2 + \\lambda = 0 \\implies 0 - 1 + \\lambda = 0 \\implies \\lambda = 1$.\nThe solution is $\\boldsymbol{u} = \\{0, 1, 2\\}^T$ and the Lagrange multiplier is $\\lambda=1$.\n\n*   **Penalty Method:**\nThe potential energy is augmented with a penalty term: $\\Pi_\\beta(\\boldsymbol{u}) = \\frac{1}{2}\\boldsymbol{u}^T \\boldsymbol{K} \\boldsymbol{u} - \\boldsymbol{u}^T \\boldsymbol{F} + \\frac{1}{2}\\beta u_1^2$.\nMinimizing $\\Pi_\\beta$ with respect to $\\boldsymbol{u}$ gives $\\boldsymbol{K}\\boldsymbol{u} - \\boldsymbol{F} + \\beta \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix} u_1 = \\boldsymbol{0}$.\nThis can be written as $\\boldsymbol{K}_\\beta \\boldsymbol{u} = \\boldsymbol{F}$, where the penalty stiffness matrix is:\n$\\boldsymbol{K}_\\beta = \\boldsymbol{K} + \\beta \\begin{pmatrix} 1 & 0 & 0 \\\\ 0 & 0 & 0 \\\\ 0 & 0 & 0 \\end{pmatrix} = \\begin{pmatrix} 1+\\beta & -1 & 0 \\\\ -1 & 2 & -1 \\\\ 0 & -1 & 1 \\end{pmatrix}$.\nThe system of equations is:\n$$\n\\begin{pmatrix}\n1+\\beta & -1 & 0 \\\\\n-1 & 2 & -1 \\\\\n0 & -1 & 1\n\\end{pmatrix}\n\\begin{pmatrix} u_1 \\\\ u_2 \\\\ u_3 \\end{pmatrix}\n=\n\\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix}\n$$\nFrom the third equation, $-u_2 + u_3 = 1 \\implies u_3 = u_2+1$.\nSubstituting into the second equation: $-u_1 + 2u_2 - (u_2+1) = 0 \\implies u_2 = u_1+1$.\nSubstituting this into the first equation: $(1+\\beta)u_1 - (u_1+1) = 0 \\implies \\beta u_1 = 1 \\implies u_1 = \\frac{1}{\\beta}$.\nThen, $u_2 = \\frac{1}{\\beta}+1$ and $u_3 = u_2+1 = \\frac{1}{\\beta}+2$.\nThe penalty solution is $\\boldsymbol{u}_\\beta = \\{\\frac{1}{\\beta}, 1+\\frac{1}{\\beta}, 2+\\frac{1}{\\beta}\\}^T$.\n\n**3) Convergence of Penalty to Lagrange Multiplier Solution**\n\nWe compare the penalty solution $\\boldsymbol{u}_\\beta$ with the Lagrange multiplier solution $\\boldsymbol{u}_{LM} = \\{0, 1, 2\\}^T$.\nTaking the limit of each component of $\\boldsymbol{u}_\\beta$ as $\\beta \\to \\infty$:\n$\\lim_{\\beta \\to \\infty} u_{1,\\beta} = \\lim_{\\beta \\to \\infty} \\frac{1}{\\beta} = 0$.\n$\\lim_{\\beta \\to \\infty} u_{2,\\beta} = \\lim_{\\beta \\to \\infty} (1+\\frac{1}{\\beta}) = 1$.\n$\\lim_{\\beta \\to \\infty} u_{3,\\beta} = \\lim_{\\beta \\to \\infty} (2+\\frac{1}{\\beta}) = 2$.\nThus, $\\lim_{\\beta \\to \\infty} \\boldsymbol{u}_\\beta = \\boldsymbol{u}_{LM}$.\n\nTo justify this via the matrix structures, we identify the penalty force. In the penalty method, the term $\\beta u_1$ in the first equation of equilibrium can be interpreted as a proxy for the Lagrange multiplier, $\\lambda_\\beta = \\beta u_1$. From our solution, we find that $\\lambda_\\beta = \\beta (1/\\beta) = 1$. This is a constant. The penalty system $(\\boldsymbol{K}+\\beta \\boldsymbol{C}\\boldsymbol{C}^T)\\boldsymbol{u}_\\beta = \\boldsymbol{F}$ can be rewritten as the set of equations:\n$\\boldsymbol{K} \\boldsymbol{u}_\\beta + \\lambda_\\beta \\boldsymbol{C} = \\boldsymbol{F}$\n$u_{1,\\beta} = \\lambda_\\beta / \\beta$\nIn our case, $\\lambda_\\beta = 1$. As $\\beta \\to \\infty$, the second equation becomes $u_{1,\\beta} \\to 0$. In the limit, this system becomes:\n$\\boldsymbol{K} \\boldsymbol{u} + \\lambda \\boldsymbol{C} = \\boldsymbol{F}$\n$u_1 = 0$\nThis is precisely the KKT system for the Lagrange multiplier method. Therefore, the solution of the penalty system converges to the solution of the Lagrange multiplier system.\n\n**4) Asymptotic Behavior of the Condition Number**\n\nThe condition number is $\\kappa_2(\\boldsymbol{K}_\\beta) = \\frac{\\mu_{max}(\\beta)}{\\mu_{min}(\\beta)}$, where $\\mu_{max}(\\beta)$ and $\\mu_{min}(\\beta)$ are the largest and smallest eigenvalues of $\\boldsymbol{K}_\\beta$, respectively. We need to find the asymptotic behavior of these eigenvalues as $\\beta \\to \\infty$.\nThe matrix is $\\boldsymbol{K}_\\beta = \\boldsymbol{K} + \\beta \\boldsymbol{P}$, where $\\boldsymbol{P} = \\boldsymbol{C}\\boldsymbol{C}^T$ with $\\boldsymbol{C}=\\{1,0,0\\}^T$.\n\n*   **Largest Eigenvalue $\\mu_{max}(\\beta)$:**\n    The matrix $\\boldsymbol{P}$ is a rank-one projection matrix. Perturbation theory for eigenvalues shows that for a perturbation of the form $\\beta \\boldsymbol{P}$, one eigenvalue will grow proportionally to $\\beta$. The asymptotic behavior is given by $\\mu_{max}(\\beta) \\approx \\beta (\\boldsymbol{C}^T \\boldsymbol{C}) + \\boldsymbol{C}^T\\boldsymbol{K}\\boldsymbol{C} = \\beta(1) + 1$.\n    Thus, $\\mu_{max}(\\beta) \\sim \\beta$ as $\\beta \\to \\infty$.\n\n*   **Smallest Eigenvalue $\\mu_{min}(\\beta)$:**\n    The other eigenvalues of $\\boldsymbol{K}_\\beta$ converge to the eigenvalues of the original matrix $\\boldsymbol{K}$ projected onto the subspace where the constraint is exactly satisfied. This subspace is the one where $u_1=0$. Finding the eigenvalues for this constrained system is equivalent to finding the eigenvalues of the stiffness matrix for the degrees of freedom $u_2, u_3$ with $u_1=0$ enforced. This is the submatrix $\\boldsymbol{K}_{red}$ obtained by removing the first row and column of $\\boldsymbol{K}$:\n    $\\boldsymbol{K}_{red} = \\begin{pmatrix} 2 & -1 \\\\ -1 & 1 \\end{pmatrix}$.\n    The eigenvalues $\\mu'$ of $\\boldsymbol{K}_{red}$ are found from the characteristic equation:\n    $\\det(\\boldsymbol{K}_{red} - \\mu' \\boldsymbol{I}) = (2-\\mu')(1-\\mu') - (-1)^2 = 0$\n    $\\mu'^2 - 3\\mu' + 2 - 1 = 0$\n    $\\mu'^2 - 3\\mu' + 1 = 0$.\n    The roots are $\\mu' = \\frac{3 \\pm \\sqrt{3^2 - 4(1)(1)}}{2} = \\frac{3 \\pm \\sqrt{5}}{2}$.\n    The smallest eigenvalue of $\\boldsymbol{K}_\\beta$, $\\mu_{min}(\\beta)$, will converge to the smaller of these two values as $\\beta \\to \\infty$.\n    $\\mu_{min}(\\beta) \\to \\frac{3 - \\sqrt{5}}{2}$ as $\\beta \\to \\infty$.\n\n*   **Condition Number:**\n    The asymptotic behavior of the condition number is the ratio of the asymptotic behaviors of the largest and smallest eigenvalues:\n    $$\n    \\kappa_2(\\boldsymbol{K}_\\beta) = \\frac{\\mu_{max}(\\beta)}{\\mu_{min}(\\beta)} \\sim \\frac{\\beta}{\\frac{3 - \\sqrt{5}}{2}} = \\left(\\frac{2}{3 - \\sqrt{5}}\\right) \\beta.\n    $$\n    The problem asks for the constant $c$ such that $\\kappa_2(\\boldsymbol{K}_\\beta) \\sim c\\,\\beta$. Thus,\n    $c = \\frac{2}{3 - \\sqrt{5}}$.\n    To simplify this expression, we rationalize the denominator:\n    $c = \\frac{2}{3 - \\sqrt{5}} \\times \\frac{3 + \\sqrt{5}}{3 + \\sqrt{5}} = \\frac{2(3 + \\sqrt{5})}{3^2 - (\\sqrt{5})^2} = \\frac{2(3 + \\sqrt{5})}{9 - 5} = \\frac{2(3 + \\sqrt{5})}{4}$.\n    $c = \\frac{3 + \\sqrt{5}}{2}$.\nThis is the required constant. It is recognized as the square of the golden ratio, $\\phi^2$.", "answer": "$$\\boxed{\\frac{3 + \\sqrt{5}}{2}}$$", "id": "3586814"}, {"introduction": "A critical question when applying the penalty method is the selection of the penalty parameter, often denoted by $\\epsilon$. This exercise moves beyond simple guesswork, guiding you through a first-principles derivation to establish a quantitative rule for selecting $\\epsilon$ based on the system's physical properties. You will connect this numerical parameter to the local structural stiffness and a user-defined accuracy tolerance, yielding a robust and physically meaningful basis for practical implementation [@problem_id:3586819].", "problem": "Consider a linear elastic bar aligned with the $x$-axis, of constant cross-sectional area $A$, Young’s modulus $E$, and mesh size (element length) $h$. Model the bar using a standard two-node linear finite element within the Finite Element Method (FEM). The left node displacement $u_{1}$ is prescribed to be $\\bar{u}$, but will be enforced via a quadratic penalty method with penalty parameter $\\epsilon$. The right node displacement $u_{2}$ is fixed exactly to zero. There are no external body forces or tractions. The penalty adds a term $\\frac{1}{2}\\,\\epsilon\\,(u_{1}-\\bar{u})^{2}$ to the total potential energy.\n\nStarting from the principle of minimum potential energy and basic linear elasticity, derive a closed-form rule for the penalty parameter $\\epsilon$ that guarantees the pointwise constraint violation magnitude $|u_{1}-\\bar{u}|$ does not exceed a user-specified dimensionless tolerance fraction $\\theta$ of the prescribed amplitude, i.e., $|u_{1}-\\bar{u}| \\leq \\theta\\,|\\bar{u}|$, with $0<\\theta<1$. Your rule must express $\\epsilon$ explicitly in terms of the local element stiffness, mesh size, and the tolerance. Use the standard element stiffness $k_{e}$ of the two-node bar and relate it to material and geometric parameters to make the mesh-size dependence explicit.\n\nFor physical transparency, justify the rule from first principles by demonstrating the equilibrium condition derived from energy stationarity and interpreting the penalty enforcement in terms of the Lagrange multiplier (reaction) concept, noting that in the quadratic penalty approach the emergent reaction is $\\lambda \\approx \\epsilon\\,g$ with $g=u_{1}-\\bar{u}$.\n\nProvide the final expression for $\\epsilon$ in terms of $E$, $A$, $h$, and $\\theta$. Express $\\epsilon$ in Newton per meter. No numerical evaluation is required.", "solution": "The problem is first validated to ensure it is scientifically grounded, well-posed, and objective.\n\n**Step 1: Extract Givens**\n- **System:** A linear elastic bar along the $x$-axis.\n- **Model:** A single two-node linear finite element.\n- **Geometric and Material Properties:** Constant cross-sectional area $A$, Young’s modulus $E$, and element length (mesh size) $h$.\n- **Nodal Displacements:** Left node displacement is $u_{1}$, right node displacement is $u_{2}$.\n- **Boundary Conditions and Constraints:**\n    - The left node displacement $u_{1}$ is prescribed to be $\\bar{u}$. This constraint is enforced via a quadratic penalty method.\n    - The right node displacement is fixed: $u_{2} = 0$.\n- **Loading:** No external body forces or tractions.\n- **Penalty Formulation:** The penalty adds a term $\\frac{1}{2}\\,\\epsilon\\,(u_{1}-\\bar{u})^{2}$ to the total potential energy, where $\\epsilon$ is the penalty parameter.\n- **Required Condition:** The magnitude of the constraint violation must be bounded: $|u_{1}-\\bar{u}| \\leq \\theta\\,|\\bar{u}|$, where $\\theta$ is a user-specified dimensionless tolerance fraction, with $0 < \\theta < 1$.\n- **Objective:** Derive a closed-form rule for $\\epsilon$ in terms of $E$, $A$, $h$, and $\\theta$.\n- **Justification:** The rule must be justified from the principle of minimum potential energy and interpreted in terms of the Lagrange multiplier concept.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is scientifically grounded in the theory of linear elasticity and the Finite Element Method (FEM). The use of a quadratic penalty method to enforce essential boundary conditions is a standard and well-understood technique in computational mechanics. The problem is well-posed, providing all necessary parameters and a clear objective. The language is precise and objective. There are no contradictions, missing data, or violations of physical principles.\n\n**Step 3: Verdict and Action**\nThe problem is deemed **valid**. A solution will be derived.\n\n**Derivation of the Solution**\n\nThe solution starts from the principle of minimum potential energy. The total potential energy, $\\Pi$, of the system is the sum of the internal strain energy, $U$, and the potential energy of the penalty term, $\\Pi_{penalty}$, since there are no external loads.\n\nThe internal strain energy of a two-node bar element is given by:\n$$\nU = \\frac{1}{2} \\mathbf{d}^T \\mathbf{K}_e \\mathbf{d}\n$$\nwhere $\\mathbf{d} = \\begin{pmatrix} u_1 \\\\ u_2 \\end{pmatrix}$ is the vector of nodal displacements and $\\mathbf{K}_e$ is the element stiffness matrix. For a standard bar element of length $h$, area $A$, and Young's modulus $E$, the stiffness matrix is:\n$$\n\\mathbf{K}_e = \\frac{A E}{h} \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix}\n$$\nWe can define the scalar element stiffness as $k_e = \\frac{A E}{h}$, so that $\\mathbf{K}_e = k_e \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix}$.\n\nThe total potential energy $\\Pi$ is:\n$$\n\\Pi(u_1, u_2) = U + \\Pi_{penalty} = \\frac{1}{2} \\begin{pmatrix} u_1 & u_2 \\end{pmatrix} \\left( k_e \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix} \\right) \\begin{pmatrix} u_1 \\\\ u_2 \\end{pmatrix} + \\frac{1}{2} \\epsilon (u_1 - \\bar{u})^2\n$$\nExpanding the matrix product, the strain energy is $U = \\frac{1}{2} k_e (u_1^2 - 2u_1 u_2 + u_2^2)$.\nThe total potential energy is:\n$$\n\\Pi(u_1, u_2) = \\frac{1}{2} k_e (u_1^2 - 2u_1 u_2 + u_2^2) + \\frac{1}{2} \\epsilon (u_1 - \\bar{u})^2\n$$\nWe enforce the essential boundary condition at the right node by setting $u_2 = 0$. The potential energy becomes a function of $u_1$ only:\n$$\n\\Pi(u_1) = \\frac{1}{2} k_e u_1^2 + \\frac{1}{2} \\epsilon (u_1 - \\bar{u})^2\n$$\nAccording to the principle of minimum potential energy, the equilibrium state is found by setting the first variation (or derivative) of $\\Pi$ with respect to the free degree of freedom $u_1$ to zero:\n$$\n\\frac{d\\Pi}{du_1} = 0\n$$\n$$\n\\frac{d}{du_1} \\left( \\frac{1}{2} k_e u_1^2 + \\frac{1}{2} \\epsilon (u_1 - \\bar{u})^2 \\right) = k_e u_1 + \\epsilon (u_1 - \\bar{u}) (1) = 0\n$$\nThis equation represents the equilibrium equation for the system. We can now solve for the displacement $u_1$:\n$$\nk_e u_1 + \\epsilon u_1 - \\epsilon \\bar{u} = 0\n$$\n$$\n(k_e + \\epsilon) u_1 = \\epsilon \\bar{u}\n$$\n$$\nu_1 = \\frac{\\epsilon}{k_e + \\epsilon} \\bar{u}\n$$\nThe constraint violation, which we denote as $g$, is the difference between the computed displacement $u_1$ and the prescribed displacement $\\bar{u}$:\n$$\ng = u_1 - \\bar{u} = \\frac{\\epsilon}{k_e + \\epsilon} \\bar{u} - \\bar{u} = \\left( \\frac{\\epsilon}{k_e + \\epsilon} - 1 \\right) \\bar{u}\n$$\n$$\ng = \\left( \\frac{\\epsilon - (k_e + \\epsilon)}{k_e + \\epsilon} \\right) \\bar{u} = \\frac{-k_e}{k_e + \\epsilon} \\bar{u}\n$$\nThe problem requires that the magnitude of this violation does not exceed a specified tolerance:\n$$\n|g| = |u_1 - \\bar{u}| \\leq \\theta |\\bar{u}|\n$$\nSubstituting our expression for $g$ and assuming $\\bar{u} \\neq 0$:\n$$\n\\left| \\frac{-k_e}{k_e + \\epsilon} \\bar{u} \\right| \\leq \\theta |\\bar{u}|\n$$\n$$\n\\frac{|-k_e|}{|k_e + \\epsilon|} |\\bar{u}| \\leq \\theta |\\bar{u}|\n$$\nSince $k_e = \\frac{AE}{h} > 0$ and the penalty parameter $\\epsilon$ must be chosen to be positive, the denominator $k_e + \\epsilon$ is always positive. Thus, we can remove the absolute value signs:\n$$\n\\frac{k_e}{k_e + \\epsilon} \\leq \\theta\n$$\nWe now solve this inequality for the penalty parameter $\\epsilon$. Since $0 < \\theta < 1$:\n$$\nk_e \\leq \\theta (k_e + \\epsilon)\n$$\n$$\nk_e \\leq \\theta k_e + \\theta \\epsilon\n$$\n$$\nk_e - \\theta k_e \\leq \\theta \\epsilon\n$$\n$$\nk_e (1 - \\theta) \\leq \\theta \\epsilon\n$$\nSince $\\theta > 0$, we can divide by $\\theta$ without changing the inequality direction:\n$$\n\\epsilon \\geq \\frac{k_e (1 - \\theta)}{\\theta}\n$$\nThis inequality provides the rule for selecting $\\epsilon$. To guarantee the condition is met, we must choose $\\epsilon$ to be at least this large. A common practice is to set $\\epsilon$ to the minimum value that satisfies the condition, which gives the boundary of the acceptable region. Therefore, the rule is:\n$$\n\\epsilon = \\frac{1-\\theta}{\\theta} k_e\n$$\nFinally, we substitute the definition of the element stiffness $k_e = \\frac{AE}{h}$ to express $\\epsilon$ in terms of the fundamental material and geometric parameters:\n$$\n\\epsilon = \\frac{1-\\theta}{\\theta} \\frac{A E}{h}\n$$\nThe units of $\\epsilon$ are the same as stiffness, $[N/m]$, as required.\n\n**Justification and Interpretation**\nThe equilibrium equation derived from the stationarity of potential energy is $k_e u_1 + \\epsilon (u_1 - \\bar{u}) = 0$.\nThe term $k_e u_1$ represents the internal elastic force at node $1$ resisting deformation. The term $\\epsilon (u_1 - \\bar{u})$ is the force exerted by the penalty constraint. Let's define the constraint violation as $g = u_1 - \\bar{u}$. The equilibrium equation is then $k_e u_1 + \\epsilon g = 0$.\n\nIn the Lagrange multiplier method, a constraint $g(u)=0$ is enforced by introducing a Lagrange multiplier $\\lambda$ and adding a term $\\lambda g(u)$ to the potential energy. The stationarity condition with respect to the displacement then yields an equilibrium equation of the form $F_{internal} + \\lambda \\frac{\\partial g}{\\partial u} = 0$. For our constraint $g=u_1-\\bar{u}$, this becomes $k_e u_1 + \\lambda = 0$. Here, $\\lambda$ is the reaction force required to enforce the constraint $u_1 = \\bar{u}$ exactly.\n\nComparing the penalty equilibrium equation with the Lagrangian one, we can identify an emergent reaction force from the penalty method as $\\lambda_{penalty} = \\epsilon g = \\epsilon(u_1 - \\bar{u})$. This is the interpretation requested, where the reaction $\\lambda$ is approximated by $\\epsilon g$. As $\\epsilon \\to \\infty$, the violation $g \\to 0$, forcing $u_1 \\to \\bar{u}$, and the penalty method converges to the exact solution. Our derived rule for $\\epsilon$ quantifies how large the penalty parameter needs to be for a given, finite, non-zero error tolerance $\\theta$. It shows that to achieve a smaller tolerance (smaller $\\theta$), a larger penalty parameter $\\epsilon$ is required, since $\\frac{1-\\theta}{\\theta} \\to \\infty$ as $\\theta \\to 0^{+}$. The rule also shows that $\\epsilon$ must be scaled with the physical stiffness of the element, $k_e$, which is physically intuitive: a stiffer structure requires a stiffer penalty \"spring\" to enforce the displacement.", "answer": "$$\n\\boxed{\\left(\\frac{1-\\theta}{\\theta}\\right) \\frac{A E}{h}}\n$$", "id": "3586819"}, {"introduction": "Building on the theoretical rule for selecting a penalty parameter, this final practice challenges you to verify its importance through a computational experiment. You will write a finite element program to investigate how different scaling strategies for the penalty parameter affect the solution's convergence rate as the mesh is refined. This exercise will demonstrate concretely why scaling the penalty parameter with both material stiffness and mesh size is crucial for developing robust and reliable simulation tools [@problem_id:3586779].", "problem": "Consider a one-dimensional linear elastic bar of length $L$ and constant cross-sectional area $A$, with material stiffness (Young's modulus) $E$. The axial displacement field $u(x)$ is governed by the strong form of equilibrium\n$$\n- E A \\, u''(x) = b(x), \\quad x \\in (0,L),\n$$\nwith boundary conditions consisting of a Dirichlet value at the left end $u(0) = u_D$ and a natural (traction-free) Neumann condition at the right end $E A \\, u'(L) = 0$. The body force $b(x)$ is taken to be uniform, $b(x) = b_0$. The weak form is obtained by multiplying the strong form by an admissible test function $v(x)$ and integrating by parts, which yields the classical bilinear form in the interior, and the imposition of the Dirichlet boundary condition at $x=0$ can be performed weakly using the penalty method. The penalty formulation augments the potential energy with a boundary term that penalizes deviations from the prescribed Dirichlet data:\n$$\n\\Pi(u) = \\int_0^L \\frac{E A}{2} \\left(u'(x)\\right)^2 \\, dx - \\int_0^L b_0 \\, u(x) \\, dx + \\frac{\\alpha}{2}\\left(u(0) - u_D\\right)^2,\n$$\nwhere $\\alpha$ is a positive penalty parameter. The stationarity of $\\Pi(u)$ yields a symmetric positive definite discrete system for any $\\alpha > 0$, and the penalty enforces the Dirichlet condition approximately such that $u(0) \\to u_D$ as $\\alpha \\to \\infty$.\n\nThe central question is to determine how to scale $\\alpha$ with the material stiffness $E$ and the mesh size $h$ so that the convergence rate with respect to $h$ is optimal (i.e., consistent with the interpolation properties of the finite element basis) and independent of $E$. You must derive a dimensionless quantity $\\hat{\\alpha}$ built from $\\alpha$, $E$, $A$, and $h$, and propose a scaling that yields $h$-optimal convergence independent of $E$.\n\nStarting from the fundamental weak form and the finite element discretization with linear elements of size $h=L/N$, explain how the stiffness associated with the boundary penalty should relate to the interior stiffness scale $E A / h$. Based on dimensional analysis and spectral equivalence arguments, propose a dimensionless definition of $\\hat{\\alpha}$ and a scaling of $\\alpha$ in terms of $E$ and $h$ that targets $h$-optimal convergence independent of $E$.\n\nThen, write a program to numerically test several scaling strategies by computing energy-norm error convergence slopes for different $E$ and $h$, and reporting how these slopes differ between low and high stiffness when the same $\\hat{\\alpha}$ is used. For numerical experimentation, use the following well-posed and scientifically sound configuration:\n- Domain length: $L = 1$ expressed in meters;\n- Cross-sectional area: $A = 1$ expressed in square meters;\n- Prescribed Dirichlet displacement: $u_D = 0$ expressed in meters at $x=0$;\n- Traction-free right boundary: $E A \\, u'(L) = 0$;\n- Uniform body force: $b_0 = 1$ expressed in newtons per meter;\n- Mesh sizes: number of elements $N \\in \\{8,16,32,64\\}$, so $h = L/N$ expressed in meters;\n- Material stiffness values: $E \\in \\{10^5, 10^9\\}$ expressed in pascals.\n\nThe exact solution under $u(0)=0$ and $E A \\, u'(L) = 0$ is given by integrating the strong form with the appropriate boundary conditions, yielding a quadratic $u_{\\text{exact}}(x)$ whose derivative is linear in $x$.\n\nDefine the energy-norm of the error as\n$$\n\\left\\| e \\right\\|_E = \\left( \\int_0^L E A \\left( u_h'(x) - u_{\\text{exact}}'(x) \\right)^2 \\, dx \\right)^{1/2},\n$$\nwhere $u_h$ is the finite element solution obtained with the penalty method.\n\nImplement and test the following penalty scaling strategies, each parameterized by a dimensionless $\\hat{\\alpha}$:\n1. Constant reference stiffness scaling: $\\alpha = \\hat{\\alpha} \\, \\dfrac{E_{\\text{ref}}}{h_{\\text{ref}}}$, where $E_{\\text{ref}} = 10^7$ (pascals) and $h_{\\text{ref}} = 0.1$ (meters).\n2. Material-only scaling: $\\alpha = \\hat{\\alpha} \\, \\dfrac{E}{h_{\\text{ref}}}$, with $h_{\\text{ref}} = 0.1$ (meters).\n3. Mesh-only scaling: $\\alpha = \\hat{\\alpha} \\, \\dfrac{E_{\\text{ref}}}{h}$, with $E_{\\text{ref}} = 10^7$ (pascals).\n4. Recommended stiffness-mesh scaling: $\\alpha = \\hat{\\alpha} \\, \\dfrac{E}{h}$.\n\nFor each scaling strategy, and for each $\\hat{\\alpha} \\in \\{0.1, 1.0, 10.0, 100.0\\}$, compute the energy-norm error for each mesh size and estimate the convergence slope $p$ from a log-log least squares fit of $\\log\\left(\\left\\| e \\right\\|_E\\right)$ versus $\\log(h)$, for each $E \\in \\{10^5, 10^9\\}$. Then report the absolute difference in convergence slope between the low and high stiffness,\n$$\n\\Delta p = \\left| p(E=10^5) - p(E=10^9) \\right|.\n$$\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, ordered by scaling strategy (1 to 4), and within each strategy by ascending $\\hat{\\alpha}$ values. In total there are $16$ results. The required final output is dimensionless and must be floats. For example, the format must be\n$$\n[\\Delta p_{1,\\hat{\\alpha}=0.1},\\Delta p_{1,\\hat{\\alpha}=1.0},\\Delta p_{1,\\hat{\\alpha}=10.0},\\Delta p_{1,\\hat{\\alpha}=100.0},\\ldots,\\Delta p_{4,\\hat{\\alpha}=100.0}]\n$$\nwith no additional text.\n\nProvide the complete derivation of the proposed dimensionless parameter $\\hat{\\alpha}$ and its recommended scaling, and implement the numerical experiment as specified. The goal is to demonstrate that the recommended scaling yields $h$-optimal convergence independent of $E$ for sufficiently large $\\hat{\\alpha}$, while the other scalings do not.", "solution": "The user wants a detailed derivation for the optimal scaling of a penalty parameter in a 1D finite element problem and a numerical verification.\n\n### Problem Validation\nThe problem statement is parsed and validated against the specified criteria.\n\n**Step 1: Extracted Givens**\n- **Governing Equation (Strong Form):** $- E A \\, u''(x) = b(x)$, for $x \\in (0,L)$.\n- **Body Force:** $b(x) = b_0$ (uniform).\n- **Boundary Conditions:** $u(0) = u_D$ (Dirichlet), $E A \\, u'(L) = 0$ (Neumann, traction-free).\n- **Potential Energy with Penalty:** $\\Pi(u) = \\int_0^L \\frac{E A}{2} \\left(u'(x)\\right)^2 \\, dx - \\int_0^L b_0 \\, u(x) \\, dx + \\frac{\\alpha}{2}\\left(u(0) - u_D\\right)^2$.\n- **Penalty Parameter:** $\\alpha > 0$.\n- **Discretization:** Linear finite elements of size $h=L/N$.\n- **Objective:** Derive a dimensionless quantity $\\hat{\\alpha}$ from $\\alpha, E, A, h$ and propose a scaling for $\\alpha$ for optimal, $E$-independent convergence.\n- **Numerical Configuration:**\n    - Length: $L = 1$ m\n    - Area: $A = 1$ m$^2$\n    - Dirichlet value: $u_D = 0$ m\n    - Body force: $b_0 = 1$ N/m\n    - Number of elements: $N \\in \\{8, 16, 32, 64\\}$\n    - Material stiffness (Young's modulus): $E \\in \\{10^5, 10^9\\}$ Pa\n- **Exact Solution:** The problem implies the exact solution for $u(0)=0$ and $E A \\, u'(L)=0$ should be used for error computation.\n- **Error Metric:** Energy-norm of the error, $\\left\\| e \\right\\|_E = \\left( \\int_0^L E A \\left( u_h'(x) - u_{\\text{exact}}'(x) \\right)^2 \\, dx \\right)^{1/2}$.\n- **Scaling Strategies to Test:**\n    1. $\\alpha = \\hat{\\alpha} \\, \\frac{E_{\\text{ref}}}{h_{\\text{ref}}}$, with $E_{\\text{ref}} = 10^7$ Pa, $h_{\\text{ref}} = 0.1$ m.\n    2. $\\alpha = \\hat{\\alpha} \\, \\frac{E}{h_{\\text{ref}}}$, with $h_{\\text{ref}} = 0.1$ m.\n    3. $\\alpha = \\hat{\\alpha} \\, \\frac{E_{\\text{ref}}}{h}$, with $E_{\\text{ref}} = 10^7$ Pa.\n    4. $\\alpha = \\hat{\\alpha} \\, \\frac{E}{h}$.\n- **Test Parameters:** $\\hat{\\alpha} \\in \\{0.1, 1.0, 10.0, 100.0\\}$.\n- **Output Metric:** Absolute difference in convergence slopes, $\\Delta p = \\left| p(E=10^5) - p(E=10^9) \\right|$.\n- **Output Format:** Comma-separated list of $16$ $\\Delta p$ values in brackets.\n\n**Step 2: Validation Using Extracted Givens**\n- **Scientific Grounding:** The problem is based on fundamental principles of continuum mechanics and the finite element method. The 1D bar problem, weak form, potential energy, and penalty method are all standard and correct concepts.\n- **Well-Posedness:** The problem is well-posed. The functional $\\Pi(u)$ is strictly convex for $\\alpha > 0$, guaranteeing a unique solution for the finite element approximation. The numerical experiment is clearly defined.\n- **Objectivity:** The problem is stated using precise, objective mathematical language.\n- **Flaw Checklist:** The problem does not violate any of the specified invalidity criteria. It is scientifically sound, formalizable, complete, feasible, well-posed, and non-trivial.\n\n**Step 3: Verdict and Action**\nThe problem is deemed **valid**. A full solution will be provided.\n\n### Derivation and Method explanation\n\nThe solution to the problem requires a theoretical derivation of the appropriate penalty parameter scaling, followed by a numerical implementation to verify the theoretical findings.\n\n**1. Weak Form and Finite Element Discretization**\nThe starting point is the potential energy functional $\\Pi(u)$. The solution $u(x)$ is the function that minimizes this functional. The condition for minimization is that the first variation of $\\Pi(u)$ with respect to an admissible variation $\\delta u = v$ is zero.\n$$\n\\delta \\Pi(u, v) = \\frac{\\partial}{\\partial \\epsilon} \\Pi(u+\\epsilon v) \\Big|_{\\epsilon=0} = 0\n$$\nThis leads to the weak form of the problem: find $u \\in \\mathcal{V}$ (an appropriate function space) such that for all test functions $v \\in \\mathcal{V}_0$ (where functions vanish at the essential boundary if a strong imposition were used), the following holds:\n$$\n\\int_0^L E A \\, u'(x) v'(x) \\, dx + \\alpha u(0) v(0) = \\int_0^L b_0 v(x) \\, dx + \\alpha u_D v(0)\n$$\nWe discretize the domain $[0,L]$ into $N$ linear finite elements of uniform size $h = L/N$. The nodes are located at $x_i = i h$ for $i=0, 1, \\ldots, N$. The displacement field $u(x)$ is approximated by a piecewise linear function $u_h(x)$:\n$$\nu_h(x) = \\sum_{j=0}^{N} U_j \\phi_j(x)\n$$\nwhere $U_j$ are the unknown nodal displacements and $\\phi_j(x)$ are the standard linear \"hat\" basis functions. Substituting $u_h(x)$ for $u(x)$ and using the basis functions $\\phi_i(x)$ as test functions $v(x)$, we obtain a system of linear algebraic equations, $\\mathbf{K} \\mathbf{U} = \\mathbf{F}$, where $\\mathbf{U} = [U_0, U_1, \\ldots, U_N]^T$.\n\nThe entries of the stiffness matrix $\\mathbf{K}$ and force vector $\\mathbf{F}$ are given by:\n$$\nK_{ij} = \\int_0^L E A \\, \\phi_i'(x) \\phi_j'(x) \\, dx + \\alpha \\phi_i(0) \\phi_j(0)\n$$\n$$\nF_i = \\int_0^L b_0 \\phi_i(x) \\, dx + \\alpha u_D \\phi_i(0)\n$$\nThe integral for the stiffness matrix gives rise to the element stiffness matrix for an element of length $h$:\n$$\nk^e = \\frac{EA}{h} \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix}\n$$\nThe integral for the force vector gives the element force vector:\n$$\nf^e = \\frac{b_0 h}{2} \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}\n$$\nAfter assembly, the global stiffness matrix $\\mathbf{K}_{\\text{int}}$ (without the penalty term) has entries on its diagonal of the order of $EA/h$. For example, an interior node $i$ gets contribution from two elements, so $K_{\\text{int}, ii} \\approx 2EA/h$. The node at the boundary, $i=0$, has an assembled stiffness $K_{\\text{int}, 00} = EA/h$.\n\nThe penalty term $\\alpha \\phi_i(0) \\phi_j(0)$ only contributes when $i=0$ and $j=0$, since $\\phi_j(0)=0$ for $j>0$ and $\\phi_0(0)=1$. This term adds $\\alpha$ to the $(0,0)$ entry of the global stiffness matrix. The force term $\\alpha u_D \\phi_i(0)$ adds $\\alpha u_D$ to the first entry of the global force vector. Since $u_D=0$ in this problem, the force vector is not modified by the penalty.\nThe final stiffness matrix is $\\mathbf{K} = \\mathbf{K}_{\\text{int}} + \\mathbf{K}_{\\text{pen}}$, where $\\mathbf{K}_{\\text{pen}}$ is a matrix of zeros except for $K_{\\text{pen},00} = \\alpha$.\n\n**2. Dimensional Analysis and Proposed Scaling**\nThe quality of the numerical solution depends critically on the choice of the penalty parameter $\\alpha$.\n- If $\\alpha$ is too small, the Dirichlet boundary condition $u(0)=u_D$ is not enforced accurately. The penalty term $\\alpha(U_0 - u_D)^2/2$ becomes negligible compared to the strain energy, and the solution approaches that of a bar with a natural boundary condition at $x=0$.\n- If $\\alpha$ is too large, the stiffness term $K_{00} = EA/h + \\alpha$ becomes much larger than all other entries in the matrix $\\mathbf{K}$, leading to an ill-conditioned system and potential for large round-off errors.\n\nThe key insight is that for the system to be well-conditioned and for the physics to be correctly represented, the penalty stiffness $\\alpha$ should be of the same order of magnitude as the \"natural\" stiffness of the system at the point where the condition is applied. The stiffness of the first element connected to node $0$ is $EA/h$. This is the characteristic stiffness scale at the boundary. Therefore, to maintain a balanced contribution, $\\alpha$ should be proportional to this physical stiffness scale.\n\nWe propose the scaling:\n$$\n\\alpha = \\hat{\\alpha} \\frac{EA}{h}\n$$\nHere, $\\hat{\\alpha}$ is a dimensionless parameter. Let's verify the dimensions. The unit of the energy term $\\frac{\\alpha}{2} (u(0)-u_D)^2$ is Joules (J). Since $u$ has units of meters (m), $\\alpha$ must have units of $J/m^2 = N \\cdot m / m^2 = N/m$. The proposed scaling $\\frac{EA}{h}$ has units of $\\frac{(N/m^2) \\cdot m^2}{m} = N/m$. The dimensions are consistent.\n\nThis choice of $\\alpha$ ensures that the ratio of the penalty stiffness to the element stiffness, $\\alpha / (EA/h)$, is equal to the dimensionless constant $\\hat{\\alpha}$. This ratio remains constant regardless of mesh refinement (changes in $h$) or changes in material stiffness ($E$). This property is crucial for achieving robust convergence, i.e., convergence rates that are optimal for the choice of basis functions and independent of the material parameter $E$. The dimensionless quantity to be defined is thus:\n$$\n\\hat{\\alpha} = \\frac{\\alpha h}{EA}\n$$\n\n**3. Exact Solution**\nThe exact solution is required to compute the error. We integrate the strong form $-E A u''(x) = b_0$ twice.\nFirst integration:\n$$\n-E A u'(x) = b_0 x + C_1\n$$\nApplying the Neumann boundary condition $E A u'(L) = 0$:\n$$\n-(b_0 L + C_1) = 0 \\implies C_1 = -b_0 L\n$$\nSo, $u'(x) = -\\frac{1}{EA}(b_0 x - b_0 L) = \\frac{b_0}{EA}(L-x)$.\nSecond integration:\n$$\nu(x) = \\frac{b_0}{EA} \\left( Lx - \\frac{x^2}{2} \\right) + C_2\n$$\nApplying the Dirichlet boundary condition $u(0) = u_D = 0$:\n$$\n0 + C_2 = 0 \\implies C_2 = 0\n$$\nThe exact solution and its derivative are:\n$$\nu_{\\text{exact}}(x) = \\frac{b_0}{EA} \\left( Lx - \\frac{x^2}{2} \\right)\n$$\n$$\nu'_{\\text{exact}}(x) = \\frac{b_0}{EA} (L-x)\n$$\n\n**4. Numerical Experiment**\nThe numerical experiment will systematically test the four proposed scaling strategies for $\\alpha$. For each strategy, we vary the mesh size $h$ and compute the energy norm of the error, $\\|e\\|_E$. A log-log plot of $\\|e\\|_E$ versus $h$ is expected to be linear for a converging method. The slope of this line, $p$, represents the order of convergence.\n$$\n\\log(\\|e\\|_E) = p \\log(h) + c\n$$\nWe will compute this slope $p$ using a linear least-squares fit for two different material stiffnesses, $E=10^5$ Pa and $E=10^9$ Pa. The final reported metric, $\\Delta p = |p(E=10^5) - p(E=10^9)|$, quantifies how much the convergence rate depends on the material stiffness. An ideal scaling strategy (strategy 4) should yield $\\Delta p \\approx 0$, indicating that the convergence behavior is independent of $E$, as desired for a robust numerical method. The other strategies are expected to produce a significant dependency on $E$, resulting in larger values of $\\Delta p$. For linear elements, the optimal convergence rate in the energy norm is $p=1$.\n\nThe error norm is computed by summing up contributions from each element. The squared error on a single element $e$ (from $x_e$ to $x_{e+1}$) is:\n$$\n\\|e_e\\|_E^2 = \\int_{x_e}^{x_{e+1}} EA \\left( u_h'(x) - u'_{\\text{exact}}(x) \\right)^2 dx\n$$\nOn element $e$, the finite element solution's derivative is constant, $u_h'(x) = (U_{e+1}-U_e)/h$. The exact derivative is linear in $x$. Since the integrand is a simple polynomial in $x$, the integral can be computed analytically for high precision. The total error is then $\\|e\\|_E = \\left(\\sum_{e=0}^{N-1} \\|e_e\\|_E^2\\right)^{1/2}$.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the 1D bar problem with penalty enforcement of a Dirichlet BC,\n    and analyzes the convergence behavior for different penalty scaling strategies.\n    \"\"\"\n    #\n    # --- Problem Parameters ---\n    #\n    L = 1.0       # Length (m)\n    A = 1.0       # Area (m^2)\n    b0 = 1.0      # Uniform body force (N/m)\n    uD = 0.0      # Prescribed displacement (m)\n\n    E_values = [1e5, 1e9]  # Young's modulus values (Pa)\n    N_values = [8, 16, 32, 64] # Number of elements\n    alpha_hat_values = [0.1, 1.0, 10.0, 100.0]\n\n    E_ref = 1e7   # Reference stiffness (Pa)\n    h_ref = 0.1   # Reference mesh size (m)\n\n    #\n    # --- Exact Solution ---\n    #\n    def u_exact_prime(x, E):\n        # u_exact'(x) = (b0 / (E * A)) * (L - x)\n        # With L=1, A=1, b0=1: u_exact'(x) = (1/E) * (1-x)\n        return (b0 / (E * A)) * (L - x)\n\n    #\n    # --- FEM Routines ---\n    #\n    def solve_fem(N, E, alpha):\n        \"\"\"Assembles and solves the FEM system for a given configuration.\"\"\"\n        h = L / N\n        num_nodes = N + 1\n\n        # Initialize global matrices\n        K = np.zeros((num_nodes, num_nodes))\n        F = np.zeros(num_nodes)\n\n        # Element stiffness matrix and force vector\n        ke = (E * A / h) * np.array([[1, -1], [-1, 1]])\n        fe = (b0 * h / 2) * np.array([1, 1])\n\n        # Assembly loop\n        for i in range(N):\n            K[i:i+2, i:i+2] += ke\n            F[i:i+2] += fe\n            \n        # Apply penalty boundary condition at x=0 (node 0)\n        K[0, 0] += alpha\n        F[0] += alpha * uD # uD is 0, so no change to F\n\n        # Solve the system\n        U = np.linalg.solve(K, F)\n        return U\n\n    def compute_energy_norm_error(U, N, E):\n        \"\"\"Computes the energy norm of the error ||u_h - u_exact||_E.\"\"\"\n        h = L / N\n        error_sq = 0.0\n\n        for i in range(N):\n            # Coordinates of the element nodes\n            x_i = i * h\n            x_j = (i + 1) * h\n            \n            # Constant FE derivative on the element\n            uh_prime_val = (U[i+1] - U[i]) / h\n\n            # Integral of EA*(uh' - u_exact')^2 dx over the element\n            # This is computed analytically for precision.\n            # Let f(x) = uh' - u_exact'(x) = C - D*(L-x)\n            # Integral is EA * integral[x_i to x_j] (f(x))^2 dx\n            C = uh_prime_val\n            D = b0 / (E * A)\n            \n            # Antiderivative of (C - D*(L-x))^2 is (C - D*(L-x))^3 / (3*D)\n            term1 = (C - D * (L - x_j))**3\n            term2 = (C - D * (L - x_i))**3\n            \n            integral = (E * A / (3 * D)) * (term1 - term2)\n            error_sq += integral\n\n        return np.sqrt(error_sq)\n\n    #\n    # --- Scaling Strategies ---\n    #\n    def strategy1(alpha_hat, E, h):\n        return alpha_hat * E_ref / h_ref\n\n    def strategy2(alpha_hat, E, h):\n        return alpha_hat * E / h_ref\n\n    def strategy3(alpha_hat, E, h):\n        return alpha_hat * E_ref / h\n\n    def strategy4(alpha_hat, E, h):\n        return alpha_hat * E * A / h\n\n    strategies = [strategy1, strategy2, strategy3, strategy4]\n    all_delta_p = []\n\n    #\n    # --- Main Calculation Loop ---\n    #\n    for strategy in strategies:\n        for alpha_hat in alpha_hat_values:\n            slopes = {}\n            for E in E_values:\n                log_h_list = []\n                log_err_list = []\n                for N in N_values:\n                    h = L / N\n                    alpha = strategy(alpha_hat, E, h)\n                    \n                    U = solve_fem(N, E, alpha)\n                    error = compute_energy_norm_error(U, N, E)\n                    \n                    log_h_list.append(np.log(h))\n                    log_err_list.append(np.log(error))\n                \n                # Perform log-log linear regression to find the convergence slope\n                slope, _ = np.polyfit(log_h_list, log_err_list, 1)\n                slopes[E] = slope\n            \n            delta_p = np.abs(slopes[E_values[0]] - slopes[E_values[1]])\n            all_delta_p.append(delta_p)\n\n    #\n    # --- Final Output ---\n    #\n    # Output format: a single line with comma-separated values in brackets.\n    print(f\"[{','.join(map(str, all_delta_p))}]\")\n\nsolve()\n\n```", "id": "3586779"}]}