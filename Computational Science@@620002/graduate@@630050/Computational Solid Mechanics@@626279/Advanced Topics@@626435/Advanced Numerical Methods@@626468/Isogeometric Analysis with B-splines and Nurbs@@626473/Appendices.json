{"hands_on_practices": [{"introduction": "The building blocks of isogeometric analysis are B-spline basis functions. Before constructing complex geometries or performing analysis, it is essential to master the fundamental skill of evaluating these functions. This exercise provides hands-on practice with the Cox–de Boor recursion formula, the standard algorithm for computing B-spline values, reinforcing the local, recursive nature of these powerful functions. [@problem_id:3575735]", "problem": "Consider a one-dimensional isogeometric discretization used in computational solid mechanics, where the approximation space is built from a quadratic Basis spline (B-spline) basis defined on the open knot vector $\\Xi=\\{0,0,0,0.5,1,1,1\\}$. Such a space is commonly employed in Isogeometric Analysis (IGA) to approximate displacement fields, with Non-Uniform Rational B-Splines (NURBS) derived from these B-spline bases via weights if needed. Starting from the core definition of the B-spline basis via the Cox–de Boor recursion and the piecewise-constant zeroth-degree functions, compute the nonzero quadratic B-spline basis function values $N_{i,2}(u)$ at the parametric location $u=0.25$ for all indices $i$ that yield nonzero values. Report your final answer as a single row matrix ordered by increasing index $i$ of the nonzero functions. Provide exact values; no rounding is required. No physical units are associated with these basis values.", "solution": "The problem statement is subjected to validation.\n\n### Step 1: Extract Givens\n- **Field:** Computational solid mechanics, Isogeometric Analysis (IGA).\n- **Approximation space:** B-spline basis.\n- **Polynomial degree:** $p=2$ (quadratic).\n- **Knot vector:** $\\Xi=\\{0,0,0,0.5,1,1,1\\}$.\n- **Parametric evaluation point:** $u=0.25$.\n- **Task:** Compute all nonzero B-spline basis function values $N_{i,2}(u)$ at $u=0.25$.\n- **Methodology:** Cox–de Boor recursion.\n- **Output format:** A single row matrix of exact values, ordered by increasing index $i$.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientific Groundedness:** The problem is firmly grounded in the mathematical theory of B-splines, which is a core component of Computer-Aided Design (CAD) and Isogeometric Analysis. The Cox–de Boor recursion is the standard algorithm for evaluating B-spline basis functions. The provided knot vector is a valid open knot vector. The problem is scientifically and mathematically sound.\n- **Well-Posedness:** The problem is well-posed. The degree, knot vector, and evaluation point are all specified, leading to a unique and computable set of basis function values.\n- **Objectivity:** The problem is stated in precise, objective, and unambiguous mathematical language.\n- **Completeness and Consistency:** The problem provides all necessary information. The number of knots $m=7$ and the degree $p=2$ correctly define the number of basis functions $n = m - p - 1 = 7 - 2 - 1 = 4$. The structure of the open knot vector, with $p+1=3$ repeated knots at each end, is consistent with standard practice for B-splines that are interpolatory at the domain endpoints.\n\n### Step 3: Verdict and Action\nThe problem is valid. A complete solution will be provided.\n\n### Solution\nThe problem requires the computation of the values of quadratic ($p=2$) B-spline basis functions at the parametric coordinate $u=0.25$. The B-spline basis is defined by the open knot vector $\\Xi=\\{\\xi_1, \\xi_2, \\xi_3, \\xi_4, \\xi_5, \\xi_6, \\xi_7\\} = \\{0, 0, 0, 0.5, 1, 1, 1\\}$.\n\nThe number of basis functions, $n$, for a B-spline of degree $p$ with a knot vector of length $m$ is given by $n = m - p - 1$. Here, $m=7$ and $p=2$, so there are $n=7-2-1=4$ basis functions: $N_{1,2}(u)$, $N_{2,2}(u)$, $N_{3,2}(u)$, and $N_{4,2}(u)$.\n\nThe evaluation of these functions is performed using the Cox–de Boor recursion formula. For $p > 0$, the formula is:\n$$\nN_{i,p}(u) = \\frac{u - \\xi_i}{\\xi_{i+p} - \\xi_i} N_{i,p-1}(u) + \\frac{\\xi_{i+p+1} - u}{\\xi_{i+p+1} - \\xi_{i+1}} N_{i+1,p-1}(u)\n$$\nThe recursion starts from the base case for degree $p=0$:\n$$\nN_{i,0}(u) = \\begin{cases} 1 & \\text{if } \\xi_i \\le u < \\xi_{i+1} \\\\ 0 & \\text{otherwise} \\end{cases}\n$$\nBy convention, any term with a zero in the denominator (e.g., $\\frac{0}{0}$) is taken to be zero.\n\nA basis function $N_{i,p}(u)$ has local support and is non-zero only within the interval $[\\xi_i, \\xi_{i+p+1})$. For a given parametric coordinate $u \\in [\\xi_j, \\xi_{j+1})$, the only potentially non-zero basis functions of degree $p$ are $N_{j-p,p}, \\dots, N_{j,p}$.\n\nIn our case, $u=0.25$ lies in the knot span $[\\xi_3, \\xi_4) = [0, 0.5)$. Thus, we set $j=3$. For degree $p=2$, the only basis functions that can be non-zero at $u=0.25$ are $N_{3-2,2}(u)$, $N_{3-1,2}(u)$, and $N_{3,2}(u)$, which are $N_{1,2}(u)$, $N_{2,2}(u)$, and $N_{3,2}(u)$. The function $N_{4,2}(u)$ is zero because its support is $[\\xi_4, \\xi_7) = [0.5, 1)$, which does not contain $u=0.25$.\n\nWe proceed with the recursive calculation.\n\n**Step 1: Zeroth-degree basis functions ($p=0$)**\nWe evaluate $N_{i,0}(u)$ at $u=0.25$. Since $u=0.25$ is in the interval $[\\xi_3, \\xi_4) = [0, 0.5)$, the only non-zero zeroth-degree basis function is:\n$$\nN_{3,0}(0.25) = 1\n$$\nAll other $N_{i,0}(0.25)$ are $0$.\n\n**Step 2: First-degree basis functions ($p=1$)**\nWe compute the values of the necessary linear basis functions at $u=0.25$.\n- $N_{1,1}(0.25) = \\frac{0.25 - \\xi_1}{\\xi_2 - \\xi_1} N_{1,0}(0.25) + \\frac{\\xi_3 - 0.25}{\\xi_3 - \\xi_2} N_{2,0}(0.25)$.\nThe denominators $\\xi_2-\\xi_1=0-0=0$ and $\\xi_3-\\xi_2=0-0=0$. Thus, both terms are zero.\n$N_{1,1}(0.25) = 0$.\n\n- $N_{2,1}(0.25) = \\frac{0.25 - \\xi_2}{\\xi_3 - \\xi_2} N_{2,0}(0.25) + \\frac{\\xi_4 - 0.25}{\\xi_4 - \\xi_3} N_{3,0}(0.25)$.\nThe first denominator is $\\xi_3-\\xi_2=0-0=0$, so the first term is zero.\nThe second term is $\\frac{0.5 - 0.25}{0.5 - 0} N_{3,0}(0.25) = \\frac{0.25}{0.5} \\times 1 = 0.5$.\n$N_{2,1}(0.25) = 0.5$.\n\n- $N_{3,1}(0.25) = \\frac{0.25 - \\xi_3}{\\xi_4 - \\xi_3} N_{3,0}(0.25) + \\frac{\\xi_5 - 0.25}{\\xi_5 - \\xi_4} N_{4,0}(0.25)$.\n$N_{4,0}(0.25)=0$, so the second term is zero.\nThe first term is $\\frac{0.25 - 0}{0.5 - 0} N_{3,0}(0.25) = \\frac{0.25}{0.5} \\times 1 = 0.5$.\n$N_{3,1}(0.25) = 0.5$.\n\n- $N_{4,1}(0.25) = \\frac{0.25 - \\xi_4}{\\xi_5 - \\xi_4} N_{4,0}(0.25) + \\frac{\\xi_6 - 0.25}{\\xi_6 - \\xi_5} N_{5,0}(0.25)$.\nBoth $N_{4,0}(0.25)$ and $N_{5,0}(0.25)$ are $0$.\n$N_{4,1}(0.25) = 0$.\n\n**Step 3: Second-degree basis functions ($p=2$)**\nWe now compute the final quadratic basis function values at $u=0.25$.\n\n- $N_{1,2}(0.25) = \\frac{0.25 - \\xi_1}{\\xi_3 - \\xi_1} N_{1,1}(0.25) + \\frac{\\xi_4 - 0.25}{\\xi_4 - \\xi_2} N_{2,1}(0.25)$.\nThe first denominator is $\\xi_3-\\xi_1=0-0=0$, so the first term is zero.\nThe second term is $\\frac{0.5 - 0.25}{0.5 - 0} N_{2,1}(0.25) = \\frac{0.25}{0.5} \\times 0.5 = 0.5 \\times 0.5 = 0.25$.\n$$N_{1,2}(0.25) = 0.25 = \\frac{1}{4}$$\n\n- $N_{2,2}(0.25) = \\frac{0.25 - \\xi_2}{\\xi_4 - \\xi_2} N_{2,1}(0.25) + \\frac{\\xi_5 - 0.25}{\\xi_5 - \\xi_3} N_{3,1}(0.25)$.\nThe first term is $\\frac{0.25 - 0}{0.5 - 0} N_{2,1}(0.25) = \\frac{0.25}{0.5} \\times 0.5 = 0.5 \\times 0.5 = 0.25$.\nThe second term is $\\frac{1 - 0.25}{1 - 0} N_{3,1}(0.25) = \\frac{0.75}{1} \\times 0.5 = 0.75 \\times 0.5 = 0.375$.\n$N_{2,2}(0.25) = 0.25 + 0.375 = 0.625$.\n$$N_{2,2}(0.25) = 0.625 = \\frac{5}{8}$$\n\n- $N_{3,2}(0.25) = \\frac{0.25 - \\xi_3}{\\xi_5 - \\xi_3} N_{3,1}(0.25) + \\frac{\\xi_6 - 0.25}{\\xi_6 - \\xi_4} N_{4,1}(0.25)$.\n$N_{4,1}(0.25)=0$, so the second term is zero.\nThe first term is $\\frac{0.25 - 0}{1 - 0} N_{3,1}(0.25) = \\frac{0.25}{1} \\times 0.5 = 0.25 \\times 0.5 = 0.125$.\n$$N_{3,2}(0.25) = 0.125 = \\frac{1}{8}$$\n\nAs established, $N_{4,2}(0.25)=0$.\n\nA crucial property of B-spline basis functions is the partition of unity, which states that the sum of all basis functions at any point within the domain is equal to $1$. Let's verify this for our results:\n$$ \\sum_{i=1}^{4} N_{i,2}(0.25) = N_{1,2}(0.25) + N_{2,2}(0.25) + N_{3,2}(0.25) + N_{4,2}(0.25) $$\n$$ = \\frac{1}{4} + \\frac{5}{8} + \\frac{1}{8} + 0 = \\frac{2}{8} + \\frac{5}{8} + \\frac{1}{8} = \\frac{8}{8} = 1 $$\nThe partition of unity is satisfied, confirming the correctness of our calculations.\n\nThe non-zero basis function values at $u=0.25$ correspond to indices $i=1,2,3$. Ordered by increasing index $i$, the values are:\n$N_{1,2}(0.25) = \\frac{1}{4}$\n$N_{2,2}(0.25) = \\frac{5}{8}$\n$N_{3,2}(0.25) = \\frac{1}{8}$", "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{1}{4} & \\frac{5}{8} & \\frac{1}{8} \\end{pmatrix}}\n$$", "id": "3575735"}, {"introduction": "With a grasp of B-spline evaluation, we can now explore their use in constructing Non-Uniform Rational B-Splines (NURBS). A primary advantage of IGA is the ability of NURBS to exactly represent geometries like circles, ellipses, and spheres, which are only approximated in traditional finite element methods. This practice guides you through a verification to prove that a specific NURBS construction perfectly captures a circular arc, revealing the elegant mathematical properties that enable such geometric precision. [@problem_id:3575812]", "problem": "In the context of isogeometric analysis (IGA) for computational solid mechanics, exact geometric representation of curved boundaries is essential to prevent geometric discretization error from contaminating the numerical solution. Consider constructing a quadratic Non-Uniform Rational B-Spline (NURBS) curve that exactly represents the quarter unit circle spanning from the point $(1,0)$ to the point $(0,1)$ in the first quadrant.\n\nYou are given the control points $P_{0}=(1,0)$, $P_{1}=(1,1)$, and $P_{2}=(0,1)$, and the weights $w_{0}=1$, $w_{1}=1/\\sqrt{2}$, and $w_{2}=1$. The parametric coordinate is $\\xi \\in [0,1]$, and the degree is $p=2$ with the open knot vector $\\Xi=(0,0,0,1,1,1)$.\n\nStarting from the Cox–de Boor definition of B-spline basis functions and the fundamental definition of Non-Uniform Rational B-Splines (NURBS) curves as rational B-splines, construct the corresponding quadratic NURBS parameterization $\\mathbf{x}(\\xi)$ for the data above. Then, by direct derivation using only these foundational definitions and algebraic simplification, verify that this parameterization is an exact representation of the quarter unit circle by showing that the Euclidean norm $\\|\\mathbf{x}(\\xi)\\|$ is constant and equal to the radius for all $\\xi \\in [0,1]$.\n\nProvide the simplified closed-form expression of $\\|\\mathbf{x}(\\xi)\\|$ as a function of $\\xi$. No numerical rounding is required, and no units should be included in your final expression.", "solution": "### Step 1: Extract Givens and Validate\n- **Curve type:** Quadratic Non-Uniform Rational B-Spline (NURBS).\n- **Degree:** $p=2$.\n- **Knot vector:** $\\Xi=(0,0,0,1,1,1)$.\n- **Control points:** $P_{0}=(1,0)$, $P_{1}=(1,1)$, $P_{2}=(0,1)$.\n- **Weights:** $w_{0}=1$, $w_{1}=1/\\sqrt{2}$, $w_{2}=1$.\n- **Parameter domain:** $\\xi \\in [0,1]$.\n- **Task:** Verify that the curve is a quarter unit circle by showing $\\|\\mathbf{x}(\\xi)\\| = 1$.\n\nThe problem is a classic example from Computer-Aided Geometric Design and is mathematically well-posed and scientifically valid. All necessary information is provided.\n\n### Step 2: Derive the B-spline Basis Functions\nFor a degree $p=2$ spline with the clamped knot vector $\\Xi=\\{0,0,0,1,1,1\\}$, the B-spline basis functions $N_{i,2}(\\xi)$ are the quadratic Bernstein polynomials over the interval $[0,1]$. These can be derived from the Cox–de Boor recursion formula, but for this standard case, they are known to be:\n- $N_{0,2}(\\xi) = (1-\\xi)^2$\n- $N_{1,2}(\\xi) = 2\\xi(1-\\xi)$\n- $N_{2,2}(\\xi) = \\xi^2$\n\n### Step 3: Formulate the NURBS Curve Components\nA NURBS curve is defined by $\\mathbf{x}(\\xi) = \\frac{\\sum_{i=0}^{2} w_i N_{i,2}(\\xi) P_i}{\\sum_{i=0}^{2} w_i N_{i,2}(\\xi)}$.\nLet's denote the numerator vector as $\\mathbf{A}(\\xi) = (A_x(\\xi), A_y(\\xi))$ and the denominator scalar as $W(\\xi)$.\n\nThe denominator is the weighting function:\n$$W(\\xi) = w_0 N_{0,2}(\\xi) + w_1 N_{1,2}(\\xi) + w_2 N_{2,2}(\\xi)$$\n\nThe numerator vector's components are:\n$$A_x(\\xi) = w_0 N_{0,2}(\\xi) P_{0x} + w_1 N_{1,2}(\\xi) P_{1x} + w_2 N_{2,2}(\\xi) P_{2x}$$\n$$A_y(\\xi) = w_0 N_{0,2}(\\xi) P_{0y} + w_1 N_{1,2}(\\xi) P_{1y} + w_2 N_{2,2}(\\xi) P_{2y}$$\n\nSubstituting the given control points $P_0=(1,0)$, $P_1=(1,1)$, $P_2=(0,1)$ and weights $w_0=1$, $w_2=1$:\n$$A_x(\\xi) = 1 \\cdot N_{0,2}(\\xi) \\cdot 1 + w_1 N_{1,2}(\\xi) \\cdot 1 + 1 \\cdot N_{2,2}(\\xi) \\cdot 0 = N_{0,2}(\\xi) + w_1 N_{1,2}(\\xi)$$\n$$A_y(\\xi) = 1 \\cdot N_{0,2}(\\xi) \\cdot 0 + w_1 N_{1,2}(\\xi) \\cdot 1 + 1 \\cdot N_{2,2}(\\xi) \\cdot 1 = w_1 N_{1,2}(\\xi) + N_{2,2}(\\xi)$$\nAnd the denominator is:\n$$W(\\xi) = N_{0,2}(\\xi) + w_1 N_{1,2}(\\xi) + N_{2,2}(\\xi)$$\n\n### Step 4: Verify the Euclidean Norm\nThe parameterization is $\\mathbf{x}(\\xi) = (x(\\xi), y(\\xi)) = (\\frac{A_x(\\xi)}{W(\\xi)}, \\frac{A_y(\\xi)}{W(\\xi)})$.\nTo verify that the curve is on the unit circle, we must show that its Euclidean norm is 1 for all $\\xi \\in [0,1]$.\n$$\\|\\mathbf{x}(\\xi)\\|^2 = x(\\xi)^2 + y(\\xi)^2 = \\frac{A_x(\\xi)^2 + A_y(\\xi)^2}{W(\\xi)^2} = 1$$\nThis is equivalent to proving that $A_x(\\xi)^2 + A_y(\\xi)^2 = W(\\xi)^2$.\n\nLet's substitute our expressions for $A_x, A_y$, and $W$:\n$$\n(N_{0,2} + w_1 N_{1,2})^2 + (w_1 N_{1,2} + N_{2,2})^2 = (N_{0,2} + w_1 N_{1,2} + N_{2,2})^2\n$$\nLet's expand both sides. For simplicity, we drop the argument $(\\xi)$.\nLeft-Hand Side (LHS):\n$$\n\\text{LHS} = (N_{0,2}^2 + 2w_1 N_{0,2} N_{1,2} + w_1^2 N_{1,2}^2) + (w_1^2 N_{1,2}^2 + 2w_1 N_{1,2} N_{2,2} + N_{2,2}^2)\n$$\n$$\n\\text{LHS} = N_{0,2}^2 + N_{2,2}^2 + 2w_1 N_{1,2} (N_{0,2} + N_{2,2}) + 2w_1^2 N_{1,2}^2\n$$\nRight-Hand Side (RHS), treating it as $((N_{0,2} + N_{2,2}) + w_1 N_{1,2})^2$:\n$$\n\\text{RHS} = (N_{0,2} + N_{2,2})^2 + 2w_1 N_{1,2} (N_{0,2} + N_{2,2}) + w_1^2 N_{1,2}^2\n$$\n$$\n\\text{RHS} = N_{0,2}^2 + 2 N_{0,2} N_{2,2} + N_{2,2}^2 + 2w_1 N_{1,2} (N_{0,2} + N_{2,2}) + w_1^2 N_{1,2}^2\n$$\nFor LHS to equal RHS, we must have:\n$$\nN_{0,2}^2 + N_{2,2}^2 + 2w_1 N_{1,2} (N_{0,2} + N_{2,2}) + 2w_1^2 N_{1,2}^2 = N_{0,2}^2 + 2 N_{0,2} N_{2,2} + N_{2,2}^2 + 2w_1 N_{1,2} (N_{0,2} + N_{2,2}) + w_1^2 N_{1,2}^2\n$$\nCanceling common terms from both sides leaves us with the following condition:\n$$\n2w_1^2 N_{1,2}^2 = 2 N_{0,2} N_{2,2} + w_1^2 N_{1,2}^2\n$$\n$$\n\\implies \\boldsymbol{w_1^2 N_{1,2}^2 = 2 N_{0,2} N_{2,2}}\n$$\nThis is the fundamental condition for a quadratic NURBS to represent a conic section. Let's verify it with our given basis functions and weight:\n- $w_1 = 1/\\sqrt{2} \\implies w_1^2 = 1/2$\n- $N_{0,2}(\\xi) = (1-\\xi)^2$\n- $N_{1,2}(\\xi) = 2\\xi(1-\\xi)$\n- $N_{2,2}(\\xi) = \\xi^2$\n\nSubstitute into the condition:\nLHS: $w_1^2 N_{1,2}^2 = \\frac{1}{2} (2\\xi(1-\\xi))^2 = \\frac{1}{2} [4\\xi^2(1-\\xi)^2] = 2\\xi^2(1-\\xi)^2$.\nRHS: $2 N_{0,2} N_{2,2} = 2 (1-\\xi)^2 \\xi^2$.\n\nSince LHS = RHS, the condition holds true for all $\\xi$.\n\n### Step 5: Conclusion\nThe algebraic verification shows that $A_x(\\xi)^2 + A_y(\\xi)^2 = W(\\xi)^2$. Therefore,\n$$\n\\|\\mathbf{x}(\\xi)\\|^2 = \\frac{A_x(\\xi)^2 + A_y(\\xi)^2}{W(\\xi)^2} = 1\n$$\nTaking the square root gives $\\|\\mathbf{x}(\\xi)\\| = 1$ for all $\\xi \\in [0,1]$. This confirms that the given NURBS parameterization exactly represents a curve of constant radius 1, i.e., a circular arc. The provided closed-form expression for the Euclidean norm is simply 1.", "answer": "$$\n\\boxed{1}\n$$", "id": "3575812"}, {"introduction": "A key feature of the finite element method is the ability to refine the discretization to improve accuracy. In isogeometric analysis, this is achieved through refinement algorithms that operate on the underlying spline basis. This final exercise demonstrates knot insertion, the fundamental process for $h$-refinement in IGA, which increases the number of basis functions and control points while preserving the exact geometry of the curve. [@problem_id:3575751]", "problem": "Consider a planar quadratic Non-Uniform Rational B-Splines (NURBS) curve of degree $p=2$ used to exactly represent a quarter circular arc of radius $R=2$ in a curved beam idealization. The curve is defined over the clamped knot vector $\\Xi=\\{0,0,0,1,1,1\\}$ with control points $P_0=(2,0)$, $P_1=(2,2)$, $P_2=(0,2)$ and corresponding weights $w_0=1$, $w_1=\\frac{1}{\\sqrt{2}}$, $w_2=1$. Starting from the fundamental definition of a NURBS curve in $\\mathbb{R}^2$ as a rational projection of a polynomial B-spline curve defined in homogeneous coordinates, and from the standard knot insertion process for B-splines (applied to homogeneous control points), perform a single knot insertion at parameter $\\xi=0.5$.\n\nUsing these principles only, derive the new knot vector and compute the updated set of control points and weights exactly (without numerical rounding). Present the final result as a single row matrix that first lists the entries of the new knot vector, followed by the tuples $(x_i,y_i,w_i)$ of the updated control points and weights in order $i=0,1,2,3$. All mathematical entities must be expressed in exact symbolic form. Do not round. The final answer must be a single analytical expression.", "solution": "The problem is to perform a single knot insertion on a given quadratic Non-Uniform Rational B-Splines (NURBS) curve and to determine the resulting new knot vector, control points, and weights.\n\n### Step 1: Extract Givens\n- **Curve type**: Planar quadratic NURBS curve\n- **Degree**: $p=2$\n- **Geometry**: Quarter circular arc of radius $R=2$\n- **Knot vector**: $\\Xi=\\{\\,0,\\,0,\\,0,\\,1,\\,1,\\,1\\,\\}$\n- **Control points**: $P_0=(2,0)$, $P_1=(2,2)$, $P_2=(0,2)$\n- **Weights**: $w_0=1$, $w_1=\\frac{1}{\\sqrt{2}}$, $w_2=1$\n- **Task**: Perform a single knot insertion at parameter $\\xi=0.5$.\n- **Methodology**: Use the NURBS definition in homogeneous coordinates and the standard B-spline knot insertion algorithm.\n- **Output**: A single row matrix containing the new knot vector and the new control points and weights $(x_i, y_i, w_i)$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem statement describes a standard and well-defined procedure from the field of Computer-Aided Geometric Design (CAGD) and Isogeometric Analysis (IGA). A quadratic NURBS curve with the given control points and weights does indeed represent a quarter circular arc of radius $R=2$. The number of control points ($n+1=3$) and the size of the knot vector ($m+1=6$) are consistent with the degree ($p=2$) through the relation $m=n+p+1$ (here, $5=2+2+1$). The knot insertion algorithm is a fundamental, well-posed operation in spline theory. All provided information is self-contained, consistent, and scientifically sound. The problem is therefore deemed to be valid.\n\n### Step 3: Solution\nThe procedure for knot insertion in a NURBS curve is most transparently performed by operating on its corresponding B-spline representation in homogeneous space.\n\n**Part 1: Homogeneous Representation**\nA NURBS curve in $\\mathbb{R}^2$ is the projection of a B-spline curve in $\\mathbb{R}^3$ homogeneous space. The homogeneous control points $P_i^w$ are formed by multiplying the Cartesian coordinates of the control points $P_i=(x_i, y_i)$ by their respective weights $w_i$, and appending the weight as the last coordinate: $P_i^w = (w_i x_i, w_i y_i, w_i)$.\n\nThe given control points and weights are:\n$P_0=(2,0)$ with $w_0=1$\n$P_1=(2,2)$ with $w_1=\\frac{1}{\\sqrt{2}}$\n$P_2=(0,2)$ with $w_2=1$\n\nThe corresponding homogeneous control points are:\n$P_0^w = (1 \\cdot 2, 1 \\cdot 0, 1) = (2, 0, 1)$\n$P_1^w = (\\frac{1}{\\sqrt{2}} \\cdot 2, \\frac{1}{\\sqrt{2}} \\cdot 2, \\frac{1}{\\sqrt{2}}) = (\\frac{2}{\\sqrt{2}}, \\frac{2}{\\sqrt{2}}, \\frac{1}{\\sqrt{2}}) = (\\sqrt{2}, \\sqrt{2}, \\frac{1}{\\sqrt{2}})$\n$P_2^w = (1 \\cdot 0, 1 \\cdot 2, 1) = (0, 2, 1)$\n\nThese are the control points for a polynomial B-spline curve of degree $p=2$ with knot vector $\\Xi=\\{\\,0,\\,0,\\,0,\\,1,\\,1,\\,1\\,\\}$.\n\n**Part 2: Knot Insertion Algorithm**\nWe will insert the new knot $\\bar{\\xi}=0.5$ into the knot vector $\\Xi$. First, we must identify the knot span $[\\xi_k, \\xi_{k+1})$ in which $\\bar{\\xi}$ lies. The knot vector is $\\Xi=\\{\\xi_0, \\xi_1, \\xi_2, \\xi_3, \\xi_4, \\xi_5\\} = \\{\\,0,\\,0,\\,0,\\,1,\\,1,\\,1\\,\\}$. Since $\\xi_2=0 \\leq 0.5 < \\xi_3=1$, the index is $k=2$.\n\nThe insertion of a single knot increases the number of control points by one. The original curve has $n+1=3$ control points. The new curve will have $(n+1)+1=4$ control points, which we denote as $\\hat{P}_0^w, \\hat{P}_1^w, \\hat{P}_2^w, \\hat{P}_3^w$.\n\nThe formula for the new control points $\\hat{P}_j$ (Boehm's algorithm) is:\n$\\hat{P}_j = P_j$ for $j \\le k-p$\n$\\hat{P}_j = (1-\\alpha_j)P_{j-1} + \\alpha_j P_j$ for $k-p+1 \\le j \\le k$\n$\\hat{P}_j = P_{j-1}$ for $j \\ge k+1$\n\nHere, $\\alpha_j = \\frac{\\bar{\\xi} - \\xi_j}{\\xi_{j+p} - \\xi_j}$. We apply this to the homogeneous control points $P_i^w$. With $p=2$ and $k=2$:\n- For $j \\le k-p = 2-2=0$: $\\hat{P}_0^w = P_0^w$.\n- For $j \\ge k+1 = 3$: $\\hat{P}_3^w = P_{3-1}^w = P_2^w$.\n- For $k-p+1 \\le j \\le k$, which is $1 \\le j \\le 2$, we compute new points:\n\nFor $j=1$:\n$\\alpha_1 = \\frac{\\bar{\\xi} - \\xi_1}{\\xi_{1+p} - \\xi_1} = \\frac{0.5 - \\xi_1}{\\xi_3 - \\xi_1} = \\frac{0.5 - 0}{1 - 0} = 0.5 = \\frac{1}{2}$.\n$\\hat{P}_1^w = (1-\\alpha_1)P_0^w + \\alpha_1 P_1^w = \\frac{1}{2}P_0^w + \\frac{1}{2}P_1^w$.\n$\\hat{P}_1^w = \\frac{1}{2}(2, 0, 1) + \\frac{1}{2}(\\sqrt{2}, \\sqrt{2}, \\frac{1}{\\sqrt{2}}) = (1, 0, \\frac{1}{2}) + (\\frac{\\sqrt{2}}{2}, \\frac{\\sqrt{2}}{2}, \\frac{1}{2\\sqrt{2}}) = (1+\\frac{\\sqrt{2}}{2}, \\frac{\\sqrt{2}}{2}, \\frac{1}{2}+\\frac{\\sqrt{2}}{4}) = (\\frac{2+\\sqrt{2}}{2}, \\frac{\\sqrt{2}}{2}, \\frac{2+\\sqrt{2}}{4})$.\n\nFor $j=2$:\n$\\alpha_2 = \\frac{\\bar{\\xi} - \\xi_2}{\\xi_{2+p} - \\xi_2} = \\frac{0.5 - \\xi_2}{\\xi_4 - \\xi_2} = \\frac{0.5 - 0}{1 - 0} = 0.5 = \\frac{1}{2}$.\n$\\hat{P}_2^w = (1-\\alpha_2)P_1^w + \\alpha_2 P_2^w = \\frac{1}{2}P_1^w + \\frac{1}{2}P_2^w$.\n$\\hat{P}_2^w = \\frac{1}{2}(\\sqrt{2}, \\sqrt{2}, \\frac{1}{\\sqrt{2}}) + \\frac{1}{2}(0, 2, 1) = (\\frac{\\sqrt{2}}{2}, \\frac{\\sqrt{2}}{2}, \\frac{1}{2\\sqrt{2}}) + (0, 1, \\frac{1}{2}) = (\\frac{\\sqrt{2}}{2}, 1+\\frac{\\sqrt{2}}{2}, \\frac{\\sqrt{2}}{4}+\\frac{1}{2}) = (\\frac{\\sqrt{2}}{2}, \\frac{2+\\sqrt{2}}{2}, \\frac{2+\\sqrt{2}}{4})$.\n\nSo, the new set of homogeneous control points is:\n$\\hat{P}_0^w = (2, 0, 1)$\n$\\hat{P}_1^w = (\\frac{2+\\sqrt{2}}{2}, \\frac{\\sqrt{2}}{2}, \\frac{2+\\sqrt{2}}{4})$\n$\\hat{P}_2^w = (\\frac{\\sqrt{2}}{2}, \\frac{2+\\sqrt{2}}{2}, \\frac{2+\\sqrt{2}}{4})$\n$\\hat{P}_3^w = (0, 2, 1)$\n\n**Part 3: Projection back to Cartesian Coordinates**\nTo obtain the new Cartesian control points $\\hat{P}_j=(\\hat{x}_j, \\hat{y}_j)$ and weights $\\hat{w}_j$, we project the homogeneous points $\\hat{P}_j^w=(X_j, Y_j, W_j)$ back: $\\hat{w}_j = W_j$ and $(\\hat{x}_j, \\hat{y}_j) = (\\frac{X_j}{W_j}, \\frac{Y_j}{W_j})$.\n\n- For $\\hat{P}_0^w=(2,0,1)$:\n$\\hat{w}_0 = 1$\n$\\hat{P}_0 = (\\frac{2}{1}, \\frac{0}{1}) = (2,0)$.\n\n- For $\\hat{P}_1^w=(\\frac{2+\\sqrt{2}}{2}, \\frac{\\sqrt{2}}{2}, \\frac{2+\\sqrt{2}}{4})$:\n$\\hat{w}_1 = \\frac{2+\\sqrt{2}}{4}$\n$\\hat{x}_1 = \\frac{(2+\\sqrt{2})/2}{(2+\\sqrt{2})/4} = 2$\n$\\hat{y}_1 = \\frac{\\sqrt{2}/2}{(2+\\sqrt{2})/4} = \\frac{\\sqrt{2}}{2} \\cdot \\frac{4}{2+\\sqrt{2}} = \\frac{2\\sqrt{2}}{2+\\sqrt{2}} = \\frac{2\\sqrt{2}(2-\\sqrt{2})}{(2+\\sqrt{2})(2-\\sqrt{2})} = \\frac{4\\sqrt{2}-4}{4-2} = 2\\sqrt{2}-2$.\n$\\hat{P}_1 = (2, 2\\sqrt{2}-2)$.\n\n- For $\\hat{P}_2^w=(\\frac{\\sqrt{2}}{2}, \\frac{2+\\sqrt{2}}{2}, \\frac{2+\\sqrt{2}}{4})$:\n$\\hat{w}_2 = \\frac{2+\\sqrt{2}}{4}$\n$\\hat{x}_2 = \\frac{\\sqrt{2}/2}{(2+\\sqrt{2})/4} = 2\\sqrt{2}-2$\n$\\hat{y}_2 = \\frac{(2+\\sqrt{2})/2}{(2+\\sqrt{2})/4} = 2$.\n$\\hat{P}_2 = (2\\sqrt{2}-2, 2)$.\n\n- For $\\hat{P}_3^w=(0,2,1)$:\n$\\hat{w}_3 = 1$\n$\\hat{P}_3 = (\\frac{0}{1}, \\frac{2}{1}) = (0,2)$.\n\n**Part 4: Final Result**\nThe new knot vector, $\\hat{\\Xi}$, is formed by inserting $\\bar{\\xi}=0.5$ into $\\Xi$:\n$\\hat{\\Xi} = \\{\\,0,\\,0,\\,0,\\,0.5,\\,1,\\,1,\\,1\\,\\} = \\{\\,0,\\,0,\\,0,\\,\\frac{1}{2},\\,1,\\,1,\\,1\\,\\}$.\n\nThe new control points and weights, expressed as tuples $(\\hat{x}_i, \\hat{y}_i, \\hat{w}_i)$, are:\nFor $i=0$: $(2, 0, 1)$\nFor $i=1$: $(2, 2\\sqrt{2}-2, \\frac{2+\\sqrt{2}}{4})$\nFor $i=2$: $(2\\sqrt{2}-2, 2, \\frac{2+\\sqrt{2}}{4})$\nFor $i=3$: $(0, 2, 1)$\n\nThese results are collected into a single row matrix as requested.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0 & 0 & 0 & \\frac{1}{2} & 1 & 1 & 1 & 2 & 0 & 1 & 2 & 2\\sqrt{2}-2 & \\frac{2+\\sqrt{2}}{4} & 2\\sqrt{2}-2 & 2 & \\frac{2+\\sqrt{2}}{4} & 0 & 2 & 1\n\\end{pmatrix}\n}\n$$", "id": "3575751"}]}