{"hands_on_practices": [{"introduction": "Before tackling complex numerical simulations, it is essential to ground our understanding in problems with known analytical solutions. This practice challenges you to derive such a solution for a piezoelectric rod in torsion, a classic benchmark case [@problem_id:3561198]. By leveraging the material's symmetry to decouple the governing equations, you will reinforce your command of fundamental principles and develop a reference solution useful for validating computational models.", "problem": "Consider a right circular cylindrical piezoelectric rod of radius $a$ and length $L$, whose material symmetry is transversely isotropic about the axis $z$ (crystal class $6mm$) and whose poling direction coincides with the cylinder axis $z$. The rod is modeled in the linear piezoelectric regime under small strains and quasi-static electrostatics. The fundamental governing equations are:\n- Balance of linear momentum: $\\nabla \\cdot \\boldsymbol{T} + \\boldsymbol{b} = \\boldsymbol{0}$, with $\\boldsymbol{b} = \\boldsymbol{0}$.\n- Gauss's law in the absence of free charge: $\\nabla \\cdot \\boldsymbol{D} = 0$.\n- Electrostatic field definition: $\\boldsymbol{E} = -\\nabla \\phi$.\n\nThe linear piezoelectric constitutive relations in the stress–charge form are:\n$$\\boldsymbol{T} = \\boldsymbol{c}^{E} : \\boldsymbol{S} - \\boldsymbol{e}^{\\top} \\boldsymbol{E}, \\qquad \\boldsymbol{D} = \\boldsymbol{e} : \\boldsymbol{S} + \\boldsymbol{\\epsilon}^{S} \\boldsymbol{E},$$\nwhere $\\boldsymbol{T}$ is the Cauchy stress, $\\boldsymbol{S}$ is the small-strain tensor, $\\boldsymbol{D}$ is the electric displacement, $\\boldsymbol{E}$ is the electric field, $\\boldsymbol{c}^{E}$ is the elastic stiffness at constant electric field, $\\boldsymbol{e}$ is the piezoelectric coupling tensor, and $\\boldsymbol{\\epsilon}^{S}$ is the permittivity at constant strain.\n\nBoundary and loading conditions are:\n- Mechanical: the end at $z=0$ is fixed ($\\boldsymbol{u}=\\boldsymbol{0}$), and a static torque $M$ about the $z$-axis is applied to the end at $z=L$; the lateral surface $r=a$ is traction-free.\n- Electrical: the end faces are perfectly electroded with prescribed potentials $\\phi(0)=0$ and $\\phi(L)=V$, and the lateral surface $r=a$ is electrically insulated so that $\\boldsymbol{D}\\cdot \\boldsymbol{n}=0$ there.\n\nAssume an axisymmetric Saint-Venant torsion state with no warping of cross-sections and neglect end effects (i.e., fields are uniform along $z$ except for boundary layers near the ends). Under the given material symmetry about $z$ and poling along $z$, the only relevant stiffness in torsion is $c_{44}$ (the shear modulus in the rod), and the coupling between axial electric field $E_{z}$ and shear stress components $T_{z\\theta}$ vanishes for crystal class $6mm$.\n\nStarting from the above laws and conditions, derive the exact analytic expressions for:\n1. The circumferential displacement $u_{\\theta}(r)$ at the loaded end $z=L$, as a function of $r$, $a$, $L$, $M$, and $c_{44}$.\n2. The axial electric field $E_{z}$ throughout the rod, as a function of $V$ and $L$.\n\nExpress $u_{\\theta}$ in meters and $E_{z}$ in volts per meter. No numerical values are to be substituted; provide closed-form expressions only. No rounding is required. Your final answer must be a single analytic expression that contains both requested quantities in one row using the LaTeX $pmatrix$ environment, in the order $\\left(u_{\\theta}(r), E_{z}\\right)$.", "solution": "The problem statement presented is a well-posed boundary value problem in the field of linear piezoelectricity. It is scientifically grounded, internally consistent, and possesses sufficient information to derive a unique solution under the specified assumptions. The core of the problem lies in applying the principles of continuum mechanics and electrostatics to a piezoelectric material with specific symmetry (crystal class $6mm$) under a particular loading (torsion). A crucial simplification, explicitly stated in the problem, is that for this material class and loading, the mechanical torsion is decoupled from the axial electric field. This allows the problem to be separated into two independent subproblems: a purely mechanical torsion problem and a purely electrostatic problem.\n\nThe solution proceeds by analyzing these two subproblems separately.\n\nFirst, we address the mechanical torsion problem to find the circumferential displacement $u_{\\theta}(r)$ at the end $z=L$.\nThe problem assumes an axisymmetric Saint-Venant torsion state with no warping. For a circular shaft, this corresponds to a displacement field of the form:\n$$\nu_r = 0, \\quad u_z = 0, \\quad u_{\\theta} = r \\psi(z)\n$$\nwhere $u_r$, $u_{\\theta}$, and $u_z$ are the displacement components in cylindrical coordinates $(r, \\theta, z)$, and $\\psi(z)$ is the angle of twist of the cross-section at position $z$.\n\nThe non-zero components of the small-strain tensor $\\boldsymbol{S} = \\frac{1}{2}(\\nabla \\boldsymbol{u} + (\\nabla \\boldsymbol{u})^{\\top})$ are derived from this displacement field. The only non-zero component is the engineering shear strain in the $\\theta-z$ plane:\n$$\nS_{\\theta z} = \\frac{1}{2}\\left(\\frac{1}{r}\\frac{\\partial u_z}{\\partial \\theta} + \\frac{\\partial u_{\\theta}}{\\partial z}\\right) = \\frac{1}{2}\\frac{\\partial}{\\partial z}(r\\psi(z)) = \\frac{1}{2}r \\frac{d\\psi}{dz}\n$$\nThe assumption that fields are uniform along the length $L$ (neglecting end effects) implies that the rate of twist is constant. Let us define this constant rate of twist as $\\alpha$:\n$$\n\\alpha = \\frac{d\\psi}{dz}\n$$\nThus, the strain is $S_{\\theta z} = \\frac{1}{2}r\\alpha$.\n\nAccording to the problem statement, the electromechanical coupling between the shear stress $T_{\\theta z}$ and the axial electric field $E_z$ is zero for the $6mm$ crystal class. Also, the problem is structured such that we can assume a purely axial electric field $\\boldsymbol{E} = E_z \\boldsymbol{\\hat{e}}_z$, meaning $E_r=E_{\\theta}=0$. The constitutive relation for stress, $\\boldsymbol{T} = \\boldsymbol{c}^{E} : \\boldsymbol{S} - \\boldsymbol{e}^{\\top} \\boldsymbol{E}$, simplifies. For the shear stress component $T_{\\theta z}$, the piezoelectric term involving $E_z$ is absent. The relation reduces to the purely elastic form, where $c_{44}$ is the relevant shear modulus:\n$$\nT_{\\theta z} = 2 c_{44}^{E} S_{\\theta z} = 2 c_{44} \\left(\\frac{1}{2} r\\alpha\\right) = c_{44} r \\alpha\n$$\nWe omit the superscript $E$ on $c_{44}$ as it's the only one considered. This stress field automatically satisfies the equilibrium equation $\\nabla \\cdot \\boldsymbol{T} = \\boldsymbol{0}$ in the absence of body forces.\n\nNext, we apply the boundary conditions. The applied torque $M$ at the end $z=L$ is the resultant moment of the shear stress $T_{\\theta z}$ over the cross-sectional area $A$:\n$$\nM = \\int_A r T_{\\theta z} \\, dA = \\int_0^{2\\pi}\\int_0^a r (c_{44} r \\alpha) \\, r \\, dr \\, d\\theta\n$$\n$$\nM = 2\\pi c_{44} \\alpha \\int_0^a r^3 \\, dr = 2\\pi c_{44} \\alpha \\left[\\frac{r^4}{4}\\right]_0^a = \\frac{\\pi c_{44} a^4 \\alpha}{2}\n$$\nFrom this relation, we solve for the constant twist rate $\\alpha$:\n$$\n\\alpha = \\frac{2M}{\\pi c_{44} a^4}\n$$\nTo find the displacement, we integrate the twist rate $\\alpha = d\\psi/dz$ with respect to $z$. The boundary condition at the fixed end, $\\boldsymbol{u}=\\boldsymbol{0}$ at $z=0$, implies $u_{\\theta}(r,0)=0$, which means $\\psi(0)=0$.\n$$\n\\psi(z) = \\int_0^z \\alpha \\, dz' = \\alpha z\n$$\nThe circumferential displacement at the loaded end, $z=L$, is then given by:\n$$\nu_{\\theta}(r, L) = r \\psi(L) = r \\alpha L\n$$\nSubstituting the expression for $\\alpha$:\n$$\nu_{\\theta}(r, L) = r L \\left(\\frac{2M}{\\pi c_{44} a^4}\\right) = \\frac{2MLr}{\\pi a^4 c_{44}}\n$$\nThis is the first required expression.\n\nSecond, we address the electrostatic problem to find the axial electric field $E_z$.\nThe problem is decoupled, so we can solve for the electric field independently. The rod is electroded at its ends with $\\phi(0)=0$ and $\\phi(L)=V$. Neglecting end effects implies a uniform electric field along the $z$-axis. The geometry suggests that the electric potential $\\phi$ varies only with $z$, i.e., $\\phi = \\phi(z)$.\nThe electric field is related to the potential by $\\boldsymbol{E} = -\\nabla \\phi$. For a potential depending only on $z$, this simplifies to:\n$$\n\\boldsymbol{E} = -\\frac{d\\phi}{dz} \\boldsymbol{\\hat{e}}_z\n$$\nThus, the electric field is purely axial, with $E_z = -\\frac{d\\phi}{dz}$. Since we assume a uniform field, $E_z$ must be a constant.\n$$\n\\frac{d\\phi}{dz} = -E_z = \\text{constant}\n$$\nIntegrating this equation gives the potential:\n$$\n\\phi(z) = -E_z z + C\n$$\nwhere $C$ is an integration constant. We apply the electrical boundary conditions to determine $E_z$ and $C$:\n1. At $z=0$, $\\phi(0) = 0$:\n   $$0 = -E_z(0) + C \\implies C=0$$\n2. At $z=L$, $\\phi(L) = V$:\n   $$V = -E_z L$$\nSolving for the axial electric field component $E_z$:\n$$\nE_z = -\\frac{V}{L}\n$$\nThis result is consistent with all other conditions. Gauss's law $\\nabla \\cdot \\boldsymbol{D} = 0$ is satisfied because the decoupling implies $D_z = \\epsilon_{33}^{S} E_z$, which is constant, and other components of $\\boldsymbol{D}$ do not contribute to a non-zero divergence. The insulation condition on the lateral surface, $\\boldsymbol{D} \\cdot \\boldsymbol{n} = D_r = 0$, is also satisfied since $E_r=0$ and the strain field does not generate $D_r$.\n\nCombining the two derived expressions, we obtain the required solution set.\nThe circumferential displacement at $z=L$ is $u_{\\theta}(r) = \\frac{2MLr}{\\pi a^4 c_{44}}$.\nThe axial electric field is $E_z = -\\frac{V}{L}$.", "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{2MLr}{\\pi a^{4} c_{44}} & -\\frac{V}{L} \\end{pmatrix}}\n$$", "id": "3561198"}, {"introduction": "In practical engineering applications, the intrinsic material axes of a piezoelectric crystal rarely align perfectly with the global coordinate system of the component. This exercise provides hands-on practice in rotating the material property tensors—specifically the elastic stiffness $\\boldsymbol{c}$ and piezoelectric coupling $\\boldsymbol{e}$ tensors—from a crystal-based frame to a laboratory frame [@problem_id:3561275]. Mastering this tensor transformation is a critical and non-negotiable skill for accurately modeling anisotropic materials in any simulation environment.", "problem": "Consider a transversely isotropic piezoelectric crystal of crystallographic class $6mm$ whose material symmetry axis is aligned with the crystal-frame $Z$-axis. Let the crystal-frame be denoted by $\\{X,Y,Z\\}$ and the laboratory-frame by $\\{x,y,z\\}$. The laboratory-frame is obtained from the crystal-frame by a proper orthogonal rotation about the crystal-frame $Y$-axis by an angle of $30$ degrees. The rotation matrix $Q$ from the crystal-frame to the laboratory-frame is\n$$\nQ \\;=\\; \\begin{pmatrix}\n\\cos\\theta & 0 & \\sin\\theta \\\\\n0 & 1 & 0 \\\\\n-\\sin\\theta & 0 & \\cos\\theta\n\\end{pmatrix},\n\\quad \\text{with } \\theta = 30~\\text{degrees}.\n$$\nIn the crystal-frame, the nonzero independent elastic stiffness components (fourth-order elasticity tensor) consistent with transverse isotropy are given by\n$$\nC_{XXXX} = C_{YYYY} = C_{11} = 160~\\text{Gigapascal (GPa)}, \\quad\nC_{ZZZZ} = C_{33} = 140~\\text{GPa}, \\quad\nC_{XXZZ} = C_{YYZZ} = C_{13} = 75~\\text{GPa}, \\quad\nC_{XZXZ} = C_{YZYZ} = C_{44} = 35~\\text{GPa}.\n$$\nAll components related by the minor and major symmetries of the elasticity tensor are implied, and all other components not obtained by symmetry are zero. In the crystal-frame, the nonzero piezoelectric stress tensor components $e_{kij}$ (third-order tensor, symmetric in its last two indices $i,j$) consistent with the $6mm$ symmetry are\n$$\ne_{3 1 1} = e_{3 2 2} = e_{31} = -0.58~\\text{Coulomb per square meter}, \\quad\ne_{3 3 3} = e_{33} = 1.34~\\text{Coulomb per square meter}, \\quad\ne_{1 1 3} = e_{1 3 1} = e_{2 2 3} = e_{2 3 2} = e_{15} = 0.48~\\text{Coulomb per square meter}.\n$$\nStarting from the definition of tensor transformation under proper orthogonal rotations and the symmetry constraints of a transversely isotropic piezoelectric medium, derive the rotated laboratory-frame components $C'_{1111}$ and $e'_{311}$ and compute their numerical values for the given $Q$, $C_{11}$, $C_{33}$, $C_{13}$, $C_{44}$, $e_{31}$, $e_{33}$, and $e_{15}$. Express the rotated stiffness $C'_{11}$ (which equals $C'_{1111}$) in Gigapascal and round to four significant figures. Express the rotated piezoelectric stress coefficient $e'_{311}$ in Coulomb per square meter and round to three significant figures. Provide the final answer as a single row matrix containing the two numbers in the order $\\big(C'_{11},\\, e'_{311}\\big)$, with no units inside the matrix.", "solution": "The problem statement has been critically validated and found to be scientifically grounded, well-posed, objective, and internally consistent. It presents a standard problem in continuum mechanics concerning the transformation of material property tensors under a coordinate system rotation. All provided data are physically plausible and consistent with the specified material symmetry. We may therefore proceed with a full solution.\n\nThe problem requires the calculation of two components, $C'_{1111}$ and $e'_{311}$, of the elasticity and piezoelectric stress tensors, respectively, in a rotated laboratory frame. The transformation is from the crystal frame $\\{X, Y, Z\\}$ to the laboratory frame $\\{x, y, z\\}$ via a rotation of $\\theta = 30^\\circ$ about the $Y$-axis.\n\nThe transformation for the coordinates is given by $x_p = Q_{pi} X_i$, where $Q$ is the orthogonal rotation matrix.\nA fourth-order tensor, such as the elasticity tensor $C_{ijkl}$, transforms according to the rule:\n$$C'_{pqrs} = Q_{pi} Q_{qj} Q_{rk} Q_{sl} C_{ijkl}$$\nA third-order tensor, such as the piezoelectric stress tensor $e_{ijk}$, transforms according to:\n$$e'_{pqr} = Q_{pi} Q_{qj} Q_{rk} e_{ijk}$$\nIn these expressions, the Einstein summation convention over repeated indices ($i,j,k,l \\in \\{1,2,3\\}$) is implied. The components of the rotation matrix $Q$ for a rotation by an angle $\\theta$ about the $Y$-axis (the '$2$'-axis) are:\n$$\nQ = \\begin{pmatrix} \\cos\\theta & 0 & \\sin\\theta \\\\ 0 & 1 & 0 \\\\ -\\sin\\theta & 0 & \\cos\\theta \\end{pmatrix} = \\begin{pmatrix} c & 0 & s \\\\ 0 & 1 & 0 \\\\ -s & 0 & c \\end{pmatrix}\n$$\nwhere $c = \\cos\\theta$ and $s = \\sin\\theta$. For $\\theta = 30^\\circ$, we have $c = \\frac{\\sqrt{3}}{2}$ and $s = \\frac{1}{2}$.\n\n**Part 1: Calculation of the Rotated Elastic Stiffness Component $C'_{1111}$**\n\nWe need to compute the component $C'_{1111}$ of the rotated stiffness tensor. Setting $p=q=r=s=1$ in the transformation law:\n$$C'_{1111} = Q_{1i} Q_{1j} Q_{1k} Q_{1l} C_{ijkl}$$\nFrom the matrix $Q$, the only non-zero components in the first row are $Q_{11} = c$ and $Q_{13} = s$. Therefore, the indices $i, j, k, l$ in the sum can only take values of $1$ or $3$ to yield non-zero terms.\n\nThe material is transversely isotropic with the $Z$-axis (the '$3$'-axis) as the axis of symmetry. The non-zero components of $C_{ijkl}$ are those with an even number of each index from the transverse plane (i.e., indices $1$ and $2$). In our restricted sum where indices are only $1$ or $3$, the non-zero components are $C_{1111}$, $C_{3333}$, $C_{1133}$, and $C_{1313}$ (and those related by symmetry).\n\nLet us expand the summation by considering all contributing terms:\n$$C'_{1111} = \\sum_{i,j,k,l \\in \\{1,3\\}} Q_{1i} Q_{1j} Q_{1k} Q_{1l} C_{ijkl}$$\nThe terms in the sum can be grouped by the non-zero $C_{ijkl}$ components:\n1.  Term with $C_{1111}$: The only combination of indices is $i=j=k=l=1$. This gives the term $Q_{11}Q_{11}Q_{11}Q_{11}C_{1111} = c^4 C_{1111}$.\n2.  Term with $C_{3333}$: The only combination is $i=j=k=l=3$. This gives the term $Q_{13}Q_{13}Q_{13}Q_{13}C_{3333} = s^4 C_{3333}$.\n3.  Terms with $C_{1133}$ (and its symmetric equivalents like $C_{3311}$): These terms have two indices equal to $1$ and two equal to $3$. The combinations are $(1,1,3,3)$ and $(3,3,1,1)$. This yields $Q_{11}^2 Q_{13}^2 C_{1133} + Q_{13}^2 Q_{11}^2 C_{3311}$. Due to major symmetry, $C_{1133} = C_{3311}$. So this contribution is $2 c^2 s^2 C_{1133}$.\n4.  Terms with $C_{1313}$ (and its symmetric equivalents): These terms also have two indices equal to $1$ and two equal to $3$. The combinations are $(1,3,1,3)$, $(1,3,3,1)$, $(3,1,1,3)$, and $(3,1,3,1)$. This yields $Q_{11}Q_{13}Q_{11}Q_{13}C_{1313} + Q_{11}Q_{13}Q_{13}Q_{11}C_{1331} + Q_{13}Q_{11}Q_{11}Q_{13}C_{3113} + Q_{13}Q_{11}Q_{13}Q_{11}C_{3131}$. Due to minor symmetries, $C_{1313} = C_{1331} = C_{3113} = C_{3131}$. So this contribution is $4 c^2 s^2 C_{1313}$.\n\nAll other components like $C_{1113}$, $C_{1333}$ are zero for this symmetry class.\nCombining all terms, we obtain the full expression:\n$$C'_{1111} = c^4 C_{1111} + s^4 C_{3333} + 2c^2s^2 C_{1133} + 4c^2s^2 C_{1313}$$\nUsing the contracted (Voigt-like) notation from the problem statement: $C_{11} \\equiv C_{1111}$, $C_{33} \\equiv C_{3333}$, $C_{13} \\equiv C_{1133}$, and $C_{44} \\equiv C_{1313}$ (noting for transverse isotropy $C_{55}=C_{1313}=C_{44}$).\n$$C'_{11} = c^4 C_{11} + s^4 C_{33} + 2c^2s^2 C_{13} + 4c^2s^2 C_{44}$$\n$$C'_{11} = c^4 C_{11} + s^4 C_{33} + 2c^2s^2 (C_{13} + 2C_{44})$$\nSubstituting the numerical values:\n$\\theta = 30^\\circ$, $c = \\cos(30^\\circ) = \\frac{\\sqrt{3}}{2}$, $s = \\sin(30^\\circ) = \\frac{1}{2}$.\n$c^2 = \\frac{3}{4}$, $s^2 = \\frac{1}{4}$. $c^4 = \\frac{9}{16}$, $s^4 = \\frac{1}{16}$.\n$C_{11} = 160$ GPa, $C_{33} = 140$ GPa, $C_{13} = 75$ GPa, $C_{44} = 35$ GPa.\n$$C'_{11} = \\left(\\frac{9}{16}\\right)(160) + \\left(\\frac{1}{16}\\right)(140) + 2\\left(\\frac{3}{4}\\right)\\left(\\frac{1}{4}\\right)\\left(75 + 2(35)\\right)$$\n$$C'_{11} = \\frac{1440}{16} + \\frac{140}{16} + \\frac{6}{16}(75 + 70)$$\n$$C'_{11} = \\frac{1}{16} (1440 + 140 + 6(145)) = \\frac{1}{16} (1580 + 870) = \\frac{2450}{16}$$\n$C'_{11} = 153.125$ GPa.\nRounding to four significant figures, we get $C'_{1111} = 153.1$ GPa.\n\n**Part 2: Calculation of the Rotated Piezoelectric Component $e'_{311}$**\n\nWe now compute the component $e'_{311}$ of the rotated piezoelectric stress tensor. Setting $p=3, q=1, r=1$ in the transformation law:\n$$e'_{311} = Q_{3i} Q_{1j} Q_{1k} e_{ijk}$$\nFrom the $Q$ matrix, the non-zero components of the first row are $Q_{11}=c, Q_{13}=s$, and of the third row are $Q_{31}=-s, Q_{33}=c$. Thus, the summation indices must be $i \\in \\{1,3\\}$ and $j,k \\in \\{1,3\\}$.\n$$e'_{311} = \\sum_{i,j,k \\in \\{1,3\\}} Q_{3i} Q_{1j} Q_{1k} e_{ijk} = Q_{31} \\sum_{j,k \\in \\{1,3\\}} Q_{1j} Q_{1k} e_{1jk} + Q_{33} \\sum_{j,k \\in \\{1,3\\}} Q_{1j} Q_{1k} e_{3jk}$$\nFor a crystal of class $6mm$, the non-zero $e_{ijk}$ components given are $e_{311}=e_{322}=e_{31}$, $e_{333}=e_{33}$, and $e_{113}=e_{131}=e_{223}=e_{232}=e_{15}$. The problem also states symmetry in the last two indices, $e_{ijk} = e_{ikj}$.\n\nLet's evaluate the two sums:\n1.  First sum (with $i=1$):\n    $$Q_{31} [Q_{11}^2 e_{111} + Q_{11}Q_{13}e_{113} + Q_{13}Q_{11}e_{131} + Q_{13}^2 e_{133}]$$\n    For class $6mm$, $e_{111}=0$ and $e_{133}=0$. With $e_{113}=e_{131}=e_{15}$, this sum becomes:\n    $$(-s)[c \\cdot s \\cdot e_{15} + s \\cdot c \\cdot e_{15}] = -s(2cs e_{15}) = -2cs^2 e_{15}$$\n2.  Second sum (with $i=3$):\n    $$Q_{33} [Q_{11}^2 e_{311} + Q_{11}Q_{13}e_{313} + Q_{13}Q_{11}e_{331} + Q_{13}^2 e_{333}]$$\n    For class $6mm$, $e_{313}=e_{331}=0$. The sum becomes:\n    $$(c)[c^2 e_{311} + s^2 e_{333}] = c^3 e_{311} + cs^2 e_{333}$$\n    Using the notation from the problem: $e_{311}=e_{31}$ and $e_{333}=e_{33}$.\n\nCombining the two parts gives the full expression:\n$$e'_{311} = c^3 e_{31} + cs^2 e_{33} - 2cs^2 e_{15}$$\n$$e'_{311} = c^3 e_{31} + cs^2(e_{33} - 2e_{15})$$\nSubstituting the numerical values:\n$e_{31} = -0.58$ C/m$^2$, $e_{33} = 1.34$ C/m$^2$, $e_{15} = 0.48$ C/m$^2$.\n$c = \\frac{\\sqrt{3}}{2}$, $s = \\frac{1}{2}$. $c^3 = \\frac{3\\sqrt{3}}{8}$, $cs^2 = \\frac{\\sqrt{3}}{2} \\cdot \\frac{1}{4} = \\frac{\\sqrt{3}}{8}$.\n$$e'_{311} = \\left(\\frac{3\\sqrt{3}}{8}\\right)(-0.58) + \\frac{\\sqrt{3}}{8}(1.34 - 2(0.48))$$\n$$e'_{311} = \\frac{\\sqrt{3}}{8} [3(-0.58) + (1.34 - 0.96)]$$\n$$e'_{311} = \\frac{\\sqrt{3}}{8} [-1.74 + 0.38]$$\n$$e'_{311} = \\frac{\\sqrt{3}}{8} [-1.36] = -0.17\\sqrt{3} \\approx -0.17 \\times 1.73205...$$\n$e'_{311} \\approx -0.2944485$ C/m$^2$.\nRounding to three significant figures, we get $e'_{311} = -0.294$ C/m$^2$.\n\nThe requested numerical values are $C'_{1111} = 153.1$ GPa and $e'_{311} = -0.294$ C/m$^2$.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n153.1 & -0.294\n\\end{pmatrix}\n}\n$$", "id": "3561275"}, {"introduction": "The heart of computational mechanics lies in solving the large, and often nonlinear, systems of algebraic equations that arise from discretization methods like FEM. This coding-based practice guides you through the implementation and comparison of two powerful iterative solution schemes: the monolithic Newton method and a staggered (or partitioned) approach [@problem_id:3561263]. By building these solvers and testing their convergence behavior under varying physical conditions, you will gain invaluable insight into the practical challenges and trade-offs inherent in solving coupled multi-physics problems.", "problem": "You are tasked with constructing and analyzing a small, finite-dimensional model that captures electro-mechanical coupling in a piezoelectric solid and using it to compare monolithic and staggered Newton solvers under varying permittivity contrasts. The goal is to quantify approximate convergence domains of the two algorithms by sampling initial guesses and counting successful convergences within a prescribed tolerance.\n\nStart from the following fundamental base in electro-mechanics:\n- Balance of linear momentum in quasi-static small strain: $\\nabla \\cdot \\boldsymbol{\\sigma} + \\boldsymbol{b} = \\boldsymbol{0}$.\n- Gauss's law for electrostatics: $\\nabla \\cdot \\boldsymbol{D} - \\rho_{f} = 0$.\n- Linear piezoelectric constitutive relations for small fields and strains: $\\boldsymbol{\\sigma} = \\mathbf{C} : \\boldsymbol{\\varepsilon} - \\mathbf{e}^{\\mathsf{T}} \\boldsymbol{E}$ and $\\boldsymbol{D} = \\mathbf{e} : \\boldsymbol{\\varepsilon} + \\boldsymbol{\\epsilon} \\boldsymbol{E}$, where $\\mathbf{C}$ is the elastic stiffness tensor, $\\mathbf{e}$ is the piezoelectric coupling tensor, and $\\boldsymbol{\\epsilon}$ is the permittivity tensor.\n\nAssume a Galerkin discretization that yields a finite-dimensional approximation of the stationarity of a total energy with mechanical degrees of freedom $\\boldsymbol{u} \\in \\mathbb{R}^{n_u}$ and electrical potential degrees of freedom $\\boldsymbol{\\phi} \\in \\mathbb{R}^{n_{\\phi}}$. To make the problem self-contained, take $n_u = 2$ and $n_{\\phi} = 2$, and define a total discrete energy that includes a controlled nonlinearity in the dielectric response inspired by nonlinear dielectric behavior:\n$$\n\\Pi(\\boldsymbol{u},\\boldsymbol{\\phi}) = \\tfrac{1}{2} \\boldsymbol{u}^{\\mathsf{T}} \\mathbf{K}_{uu} \\boldsymbol{u} + \\boldsymbol{u}^{\\mathsf{T}} \\mathbf{K}_{u\\phi} \\boldsymbol{\\phi} + \\tfrac{1}{2} \\boldsymbol{\\phi}^{\\mathsf{T}} \\left( \\epsilon_r \\mathbf{K}_{\\phi\\phi}^{(0)} \\right) \\boldsymbol{\\phi} + \\tfrac{1}{2} \\alpha \\sum_{i=1}^{n_{\\phi}} \\phi_i^4 - \\boldsymbol{f}^{\\mathsf{T}} \\boldsymbol{u} - \\boldsymbol{r}^{\\mathsf{T}} \\boldsymbol{\\phi}.\n$$\nHere, $\\mathbf{K}_{uu} \\in \\mathbb{R}^{n_u \\times n_u}$ and $\\mathbf{K}_{\\phi\\phi}^{(0)} \\in \\mathbb{R}^{n_{\\phi} \\times n_{\\phi}}$ are symmetric positive definite matrices representing the mechanical and baseline electrical stiffnesses, respectively, $\\mathbf{K}_{u\\phi} \\in \\mathbb{R}^{n_u \\times n_{\\phi}}$ encodes piezoelectric coupling, $\\epsilon_r > 0$ is a relative permittivity scaling the baseline electrical stiffness, $\\alpha \\ge 0$ controls the strength of the nonlinear dielectric term, $\\boldsymbol{f} \\in \\mathbb{R}^{n_u}$ is a mechanical load, and $\\boldsymbol{r} \\in \\mathbb{R}^{n_{\\phi}}$ is an electrical load. The stationarity conditions are the coupled residual equations:\n$$\n\\boldsymbol{R}_u(\\boldsymbol{u},\\boldsymbol{\\phi}) = \\mathbf{K}_{uu} \\boldsymbol{u} + \\mathbf{K}_{u\\phi} \\boldsymbol{\\phi} - \\boldsymbol{f} = \\boldsymbol{0},\n$$\n$$\n\\boldsymbol{R}_{\\phi}(\\boldsymbol{u},\\boldsymbol{\\phi}) = \\mathbf{K}_{u\\phi}^{\\mathsf{T}} \\boldsymbol{u} + \\epsilon_r \\mathbf{K}_{\\phi\\phi}^{(0)} \\boldsymbol{\\phi} + 2 \\alpha \\boldsymbol{\\phi}^{\\odot 3} - \\boldsymbol{r} = \\boldsymbol{0},\n$$\nwhere $\\boldsymbol{\\phi}^{\\odot 3}$ denotes the element-wise cube.\n\nThe monolithic Newton method forms the Jacobian of the full residual\n$$\n\\boldsymbol{R}(\\boldsymbol{u},\\boldsymbol{\\phi}) = \\begin{bmatrix} \\boldsymbol{R}_u(\\boldsymbol{u},\\boldsymbol{\\phi}) \\\\ \\boldsymbol{R}_{\\phi}(\\boldsymbol{u},\\boldsymbol{\\phi}) \\end{bmatrix}\n$$\nand solves for increments from\n$$\n\\mathbf{J}(\\boldsymbol{u},\\boldsymbol{\\phi}) \\begin{bmatrix} \\Delta \\boldsymbol{u} \\\\ \\Delta \\boldsymbol{\\phi} \\end{bmatrix} = - \\boldsymbol{R}(\\boldsymbol{u},\\boldsymbol{\\phi}), \\quad \\text{with} \\quad\n\\mathbf{J}(\\boldsymbol{u},\\boldsymbol{\\phi}) = \\begin{bmatrix}\n\\mathbf{K}_{uu} & \\mathbf{K}_{u\\phi} \\\\\n\\mathbf{K}_{u\\phi}^{\\mathsf{T}} & \\epsilon_r \\mathbf{K}_{\\phi\\phi}^{(0)} + 6 \\alpha \\operatorname{diag}(\\boldsymbol{\\phi}^{\\odot 2})\n\\end{bmatrix}.\n$$\n\nThe staggered Newton method alternates between subproblems:\n- With $\\boldsymbol{\\phi}$ fixed, update $\\boldsymbol{u}$ by solving the linear mechanical subproblem\n$$\n\\mathbf{K}_{uu} \\boldsymbol{u}^{\\text{new}} = \\boldsymbol{f} - \\mathbf{K}_{u\\phi} \\boldsymbol{\\phi}^{\\text{current}}.\n$$\n- With $\\boldsymbol{u}$ updated, perform a Newton step for the electrical subproblem\n$$\n\\left( \\epsilon_r \\mathbf{K}_{\\phi\\phi}^{(0)} + 6 \\alpha \\operatorname{diag}\\left((\\boldsymbol{\\phi}^{\\text{current}})^{\\odot 2}\\right) \\right) \\Delta \\boldsymbol{\\phi} = - \\left( \\mathbf{K}_{u\\phi}^{\\mathsf{T}} \\boldsymbol{u}^{\\text{new}} + \\epsilon_r \\mathbf{K}_{\\phi\\phi}^{(0)} \\boldsymbol{\\phi}^{\\text{current}} + 2 \\alpha (\\boldsymbol{\\phi}^{\\text{current}})^{\\odot 3} - \\boldsymbol{r} \\right),\n$$\nthen set $\\boldsymbol{\\phi}^{\\text{new}} = \\boldsymbol{\\phi}^{\\text{current}} + \\Delta \\boldsymbol{\\phi}$, optionally using a line search to ensure residual decrease. Repeat until convergence of the full residual.\n\nYour program must implement both methods with a backtracking line search to promote global convergence:\n- Start with unit step size and halve the step until the residual norm decreases. If step size drops below a minimum threshold, declare failure for that initial guess.\n\nConvergence is declared if the Euclidean norm of the concatenated residual is below a tolerance $10^{-10}$ within a maximum number of iterations. Failure is declared otherwise.\n\nUse the following fixed matrices and vectors, which are chosen to be scientifically plausible and consistent:\n- $\\mathbf{K}_{uu} = \\begin{bmatrix} 12.0 & 3.0 \\\\ 3.0 & 5.0 \\end{bmatrix}$,\n- $\\mathbf{K}_{\\phi\\phi}^{(0)} = \\begin{bmatrix} 5.0 & 1.0 \\\\ 1.0 & 3.0 \\end{bmatrix}$,\n- $\\mathbf{K}_{u\\phi} = \\begin{bmatrix} -0.8 & 0.2 \\\\ 0.1 & -0.6 \\end{bmatrix}$,\n- $\\boldsymbol{f} = \\begin{bmatrix} 1.0 \\\\ -0.5 \\end{bmatrix}$,\n- $\\boldsymbol{r} = \\begin{bmatrix} 0.3 \\\\ -0.2 \\end{bmatrix}$.\n\nConstruct a test suite that spans permittivity contrasts and a boundary nonlinearity case. For each case, sample initial guesses on a uniform grid $\\{-a, 0, a\\}^{4}$ for $(u_1,u_2,\\phi_1,\\phi_2)$, and for each grid point run both solvers, counting successful convergences. The test suite parameters are:\n- Case $1$: $\\epsilon_r = 1$, $\\alpha = 0.1$, $a = 1.0$.\n- Case $2$: $\\epsilon_r = 100$, $\\alpha = 0.1$, $a = 2.0$.\n- Case $3$: $\\epsilon_r = 10000$, $\\alpha = 0.1$, $a = 5.0$.\n- Case $4$ (boundary, linear dielectric): $\\epsilon_r = 100$, $\\alpha = 0.0$, $a = 5.0$.\n\nFor each case, quantify the approximate convergence domain for each solver as the fraction of the $3^4 = 81$ initial guesses that successfully converge. This fraction must be computed as a floating-point number in $[0,1]$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets in the following order:\n$[\\text{M}_1,\\text{S}_1,\\text{M}_2,\\text{S}_2,\\text{M}_3,\\text{S}_3,\\text{M}_4,\\text{S}_4]$, where $\\text{M}_i$ is the monolithic Newton fraction for case $i$ and $\\text{S}_i$ is the staggered Newton fraction for case $i$. No physical units are involved; all quantities are dimensionless. Angles are not used. Percentages must be expressed as decimals in $[0,1]$ rather than with a percent sign.", "solution": "The user has provided a problem in computational solid mechanics, focusing on the numerical solution of a nonlinear electro-mechanical coupling problem. The task is to implement and compare two iterative solution algorithms—a monolithic Newton method and a staggered Newton method—and to evaluate their convergence behavior across a range of physical parameters.\n\n### Step 1: Extract Givens\n\n- **Problem Domain**: A finite-dimensional model ($n_u=2$, $n_{\\phi}=2$) for a piezoelectric solid.\n- **Degrees of Freedom**: Mechanical displacements $\\boldsymbol{u} \\in \\mathbb{R}^2$, electrical potential $\\boldsymbol{\\phi} \\in \\mathbb{R}^2$.\n- **Total Discrete Energy**:\n  $$\n  \\Pi(\\boldsymbol{u},\\boldsymbol{\\phi}) = \\tfrac{1}{2} \\boldsymbol{u}^{\\mathsf{T}} \\mathbf{K}_{uu} \\boldsymbol{u} + \\boldsymbol{u}^{\\mathsf{T}} \\mathbf{K}_{u\\phi} \\boldsymbol{\\phi} + \\tfrac{1}{2} \\boldsymbol{\\phi}^{\\mathsf{T}} \\left( \\epsilon_r \\mathbf{K}_{\\phi\\phi}^{(0)} \\right) \\boldsymbol{\\phi} + \\tfrac{1}{2} \\alpha \\sum_{i=1}^{2} \\phi_i^4 - \\boldsymbol{f}^{\\mathsf{T}} \\boldsymbol{u} - \\boldsymbol{r}^{\\mathsf{T}} \\boldsymbol{\\phi}\n  $$\n- **Residual Equations** (from $\\nabla \\Pi = \\boldsymbol{0}$):\n  - Mechanical: $\\boldsymbol{R}_u(\\boldsymbol{u},\\boldsymbol{\\phi}) = \\mathbf{K}_{uu} \\boldsymbol{u} + \\mathbf{K}_{u\\phi} \\boldsymbol{\\phi} - \\boldsymbol{f} = \\boldsymbol{0}$\n  - Electrical: $\\boldsymbol{R}_{\\phi}(\\boldsymbol{u},\\boldsymbol{\\phi}) = \\mathbf{K}_{u\\phi}^{\\mathsf{T}} \\boldsymbol{u} + \\epsilon_r \\mathbf{K}_{\\phi\\phi}^{(0)} \\boldsymbol{\\phi} + 2 \\alpha \\boldsymbol{\\phi}^{\\odot 3} - \\boldsymbol{r} = \\boldsymbol{0}$\n- **Fixed System Matrices and Vectors**:\n  - Mechanical stiffness: $\\mathbf{K}_{uu} = \\begin{bmatrix} 12.0 & 3.0 \\\\ 3.0 & 5.0 \\end{bmatrix}$ (Symmetric Positive Definite)\n  - Baseline electrical stiffness: $\\mathbf{K}_{\\phi\\phi}^{(0)} = \\begin{bmatrix} 5.0 & 1.0 \\\\ 1.0 & 3.0 \\end{bmatrix}$ (Symmetric Positive Definite)\n  - Piezoelectric coupling: $\\mathbf{K}_{u\\phi} = \\begin{bmatrix} -0.8 & 0.2 \\\\ 0.1 & -0.6 \\end{bmatrix}$\n  - Mechanical load: $\\boldsymbol{f} = \\begin{bmatrix} 1.0 \\\\ -0.5 \\end{bmatrix}$\n  - Electrical load: $\\boldsymbol{r} = \\begin{bmatrix} 0.3 \\\\ -0.2 \\end{bmatrix}$\n- **Monolithic Newton Method**: Solve $\\mathbf{J} \\Delta\\boldsymbol{x} = -\\boldsymbol{R}$ with Jacobian:\n  $$\n  \\mathbf{J}(\\boldsymbol{u},\\boldsymbol{\\phi}) = \\begin{bmatrix}\n  \\mathbf{K}_{uu} & \\mathbf{K}_{u\\phi} \\\\\n  \\mathbf{K}_{u\\phi}^{\\mathsf{T}} & \\epsilon_r \\mathbf{K}_{\\phi\\phi}^{(0)} + 6 \\alpha \\operatorname{diag}(\\boldsymbol{\\phi}^{\\odot 2})\n  \\end{bmatrix}\n  $$\n- **Staggered Newton Method**: Iterate:\n  1. Solve for $\\boldsymbol{u}^{\\text{new}}$: $\\mathbf{K}_{uu} \\boldsymbol{u}^{\\text{new}} = \\boldsymbol{f} - \\mathbf{K}_{u\\phi} \\boldsymbol{\\phi}^{\\text{current}}$.\n  2. Perform one Newton step for $\\boldsymbol{\\phi}$ using $\\boldsymbol{u}^{\\text{new}}$:\n     - Solve for $\\Delta\\boldsymbol{\\phi}$: $\\left( \\epsilon_r \\mathbf{K}_{\\phi\\phi}^{(0)} + 6 \\alpha \\operatorname{diag}\\left((\\boldsymbol{\\phi}^{\\text{current}})^{\\odot 2}\\right) \\right) \\Delta \\boldsymbol{\\phi} = -\\boldsymbol{R}_{\\phi}(\\boldsymbol{u}^{\\text{new}}, \\boldsymbol{\\phi}^{\\text{current}})$\n- **Line Search**: For both methods, use a backtracking line search (halving the step size from $1.0$) until the Euclidean norm of the full concatenated residual, $\\|\\boldsymbol{R}\\|_2$, decreases. Failure if step size falls below a minimum threshold.\n- **Convergence Criteria**: $\\|\\boldsymbol{R}\\|_2 < 10^{-10}$ within a maximum number of iterations.\n- **Test Suite**:\n  - Sample initial guesses for $(\\boldsymbol{u}, \\boldsymbol{\\phi})$ on a uniform grid $\\{-a, 0, a\\}^{4}$.\n  - Case 1: $\\epsilon_r = 1$, $\\alpha = 0.1$, $a = 1.0$.\n  - Case 2: $\\epsilon_r = 100$, $\\alpha = 0.1$, $a = 2.0$.\n  - Case 3: $\\epsilon_r = 10000$, $\\alpha = 0.1$, $a = 5.0$.\n  - Case 4: $\\epsilon_r = 100$, $\\alpha = 0.0$, $a = 5.0$.\n- **Required Output**: A single comma-separated list of $8$ numbers: $[\\text{M}_1,\\text{S}_1,\\text{M}_2,\\text{S}_2,\\text{M}_3,\\text{S}_3,\\text{M}_4,\\text{S}_4]$, where $\\text{M}_i$ and $\\text{S}_i$ are the convergence fractions for monolithic and staggered solvers for case $i$.\n\n### Step 2: Validate Using Extracted Givens\n\n1.  **Scientific Grounding**: The problem is well-grounded in the continuum theory of piezoelectricity and its numerical approximation via the finite element method (Galerkin discretization). The energy functional, residual equations, and Jacobian matrix are correctly derived. The matrices $\\mathbf{K}_{uu}$ and $\\mathbf{K}_{\\phi\\phi}^{(0)}$ are confirmed to be symmetric positive definite. The nonlinear dielectric term is a plausible simplified model. The setup is scientifically and mathematically sound.\n2.  **Well-Posedness**: The problem is well-posed. It specifies all necessary components: governing equations, numerical methods, fixed data, parameter-space exploration, and a clear metric for comparison (convergence fraction).\n3.  **Objectivity**: The problem is stated in precise, objective mathematical language, free of subjective claims.\n4.  **Completeness**: The problem is self-contained. While it omits standard numerical parameters like maximum iterations and minimum line search step size, these are implementation details that can be set to reasonable standard values (e.g., $50$ and $10^{-8}$, respectively) without altering the fundamental nature of the problem. This minor omission does not render the problem invalid.\n5.  **Consistency**: There are no internal contradictions in the problem statement.\n\n### Step 3: Verdict and Action\n\nThe problem is **valid**. It is a well-formulated, scientifically sound numerical experiment in computational mechanics. I will proceed with the implementation of the solution.\n\n### Principle-Based Design and Implementation\n\nThe solution requires the implementation of two distinct iterative solvers for a system of nonlinear equations and a framework to test them. The core of the implementation will be structured as follows:\n\n1.  **Data Representation**: The fixed matrices ($\\mathbf{K}_{uu}$, $\\mathbf{K}_{\\phi\\phi}^{(0)}$, $\\mathbf{K}_{u\\phi}$) and vectors ($\\boldsymbol{f}$, $\\boldsymbol{r}$) will be stored as `numpy` arrays. The state vector $\\boldsymbol{x}$ is a concatenation of the displacement vector $\\boldsymbol{u}$ and the potential vector $\\boldsymbol{\\phi}$.\n\n2.  **Residual and Jacobian Functions**: A function `compute_R` will be created to calculate the full residual vector $\\boldsymbol{R} = [\\boldsymbol{R}_u, \\boldsymbol{R}_{\\phi}]^T$ for a given state $(\\boldsymbol{u}, \\boldsymbol{\\phi})$ and parameters $\\epsilon_r, \\alpha$. The expressions for the Jacobian matrix $\\mathbf{J}$ and its sub-blocks will be implemented directly within the solver functions where they are needed.\n\n3.  **Monolithic Newton Solver**: A function `solve_monolithic` will implement the full Newton-Raphson scheme. In each iteration, it will:\n    a. Calculate the current residual $\\boldsymbol{R}$ and its norm. Check for convergence.\n    b. Assemble the $4 \\times 4$ Jacobian matrix $\\mathbf{J}$.\n    c. Solve the linear system $\\mathbf{J} \\Delta\\boldsymbol{x} = -\\boldsymbol{R}$ for the update step $\\Delta\\boldsymbol{x} = [\\Delta\\boldsymbol{u}, \\Delta\\boldsymbol{\\phi}]^T$.\n    d. Employ a backtracking line search by starting with a step size $\\lambda=1$ and halving it until the condition $\\|\\boldsymbol{R}(\\boldsymbol{x} + \\lambda \\Delta\\boldsymbol{x})\\|_2 < \\|\\boldsymbol{R}(\\boldsymbol{x})\\|_2$ is met.\n    e. Update the state vector $\\boldsymbol{x} \\leftarrow \\boldsymbol{x} + \\lambda \\Delta\\boldsymbol{x}$.\n    f. Terminate with failure if the maximum number of iterations is reached or the line search step becomes too small.\n\n4.  **Staggered Newton Solver**: A function `solve_staggered` will implement the block Gauss-Seidel type iteration. In each iteration, it will:\n    a. Calculate the current full residual $\\boldsymbol{R}$ and its norm. Check for convergence.\n    b. **Mechanical Update**: Solve the linear system $\\mathbf{K}_{uu} \\boldsymbol{u}^{\\text{new}} = \\boldsymbol{f} - \\mathbf{K}_{u\\phi} \\boldsymbol{\\phi}^{\\text{current}}$ to get the updated displacement $\\boldsymbol{u}^{\\text{new}}$. This is an exact solve for the mechanical subproblem.\n    c. **Electrical Update**: Perform a single Newton step for the electrical subproblem. This involves:\n        i. Assembling the electrical tangent stiffness $\\mathbf{J}_{\\phi\\phi} = \\epsilon_r \\mathbf{K}_{\\phi\\phi}^{(0)} + 6 \\alpha \\operatorname{diag}((\\boldsymbol{\\phi}^{\\text{current}})^{\\odot 2})$.\n        ii. Calculating the electrical residual at the new displacement, $\\boldsymbol{R}_{\\phi}(\\boldsymbol{u}^{\\text{new}}, \\boldsymbol{\\phi}^{\\text{current}})$.\n        iii. Solving the $2 \\times 2$ linear system $\\mathbf{J}_{\\phi\\phi} \\Delta\\boldsymbol{\\phi} = -\\boldsymbol{R}_{\\phi}(\\boldsymbol{u}^{\\text{new}}, \\boldsymbol{\\phi}^{\\text{current}})$ for the potential increment $\\Delta\\boldsymbol{\\phi}$.\n    d. **Line Search & Update**: In accordance with the prompt's global requirement for residual norm decrease, a backtracking line search will be applied to the electrical update. Starting with $\\lambda=1$, the step size is halved until the full residual norm at the state $(\\boldsymbol{u}^{\\text{new}}, \\boldsymbol{\\phi}^{\\text{current}} + \\lambda\\Delta\\boldsymbol{\\phi})$ is less than the norm at the start of the iteration. The state is then updated.\n    e. Terminate with failure if maximum iterations are reached or the line search fails.\n\n5.  **Test Harness**: A main loop will iterate through the four specified test cases. For each case:\n    a. A set of $3^4 = 81$ initial guesses is generated from the grid $\\{-a, 0, a\\}^4$.\n    b. Both `solve_monolithic` and `solve_staggered` are run for each initial guess.\n    c. The number of successful convergences for each solver is counted.\n    d. The success counts are converted to fractions by dividing by $81$.\n    e. These fractions are collected and formatted into the final output string.\n\nThis systematic approach ensures that both algorithms are implemented according to the specifications and that their performance is compared on an identical and comprehensive set of initial conditions for each parameter case, leading to a robust quantification of their respective convergence domains.", "answer": "```python\nimport numpy as np\nimport itertools\n\ndef solve():\n    \"\"\"\n    Constructs and solves a finite-dimensional electro-mechanical problem to compare\n    monolithic and staggered Newton solvers.\n    \"\"\"\n\n    # --- Problem Constants and Solver Parameters ---\n    K_uu = np.array([[12.0, 3.0], [3.0, 5.0]])\n    K_pp0 = np.array([[5.0, 1.0], [1.0, 3.0]])\n    K_up = np.array([[-0.8, 0.2], [0.1, -0.6]])\n    f = np.array([1.0, -0.5])\n    r = np.array([0.3, -0.2])\n    \n    TOL = 1e-10\n    MAX_ITER = 50\n    MIN_STEP = 1e-8\n\n    # --- Nested Helper Function to Compute Residual ---\n    def compute_R(u, phi, eps_r, alpha):\n        \"\"\"Computes the full residual vector [R_u, R_phi].\"\"\"\n        R_u = K_uu @ u + K_up @ phi - f\n        phi_cubed = np.power(phi, 3)\n        R_p = K_up.T @ u + eps_r * (K_pp0 @ phi) + 2 * alpha * phi_cubed - r\n        return np.concatenate((R_u, R_p))\n\n    # --- Nested Solver Implementations ---\n    def solve_monolithic(u0, phi0, eps_r, alpha):\n        \"\"\"Solves the coupled system using a monolithic Newton-Raphson scheme.\"\"\"\n        u = u0.copy()\n        phi = phi0.copy()\n\n        for _ in range(MAX_ITER):\n            R = compute_R(u, phi, eps_r, alpha)\n            current_norm = np.linalg.norm(R)\n\n            if current_norm < TOL:\n                return True\n\n            # Assemble Jacobian\n            J_uu = K_uu\n            J_up = K_up\n            J_pu = K_up.T\n            phi_squared = np.power(phi, 2)\n            J_pp = eps_r * K_pp0 + 6 * alpha * np.diag(phi_squared)\n            J = np.block([[J_uu, J_up], [J_pu, J_pp]])\n\n            try:\n                delta_x = np.linalg.solve(J, -R)\n            except np.linalg.LinAlgError:\n                return False  # Singular Jacobian\n\n            delta_u, delta_phi = delta_x[:2], delta_x[2:]\n\n            # Backtracking line search\n            step = 1.0\n            line_search_success = False\n            while step > MIN_STEP:\n                u_new = u + step * delta_u\n                phi_new = phi + step * delta_phi\n                \n                # Heuristic to prevent overflow in residual calculation with large steps\n                if np.any(np.abs(phi_new) > 1e12):\n                    step /= 2.0\n                    continue\n\n                R_new = compute_R(u_new, phi_new, eps_r, alpha)\n                if np.linalg.norm(R_new) < current_norm:\n                    u, phi = u_new, phi_new\n                    line_search_success = True\n                    break\n                step /= 2.0\n            \n            if not line_search_success:\n                return False  # Line search failed\n\n        return np.linalg.norm(compute_R(u, phi, eps_r, alpha)) < TOL\n\n    def solve_staggered(u0, phi0, eps_r, alpha):\n        \"\"\"Solves the coupled system using a staggered (block Gauss-Seidel) scheme.\"\"\"\n        u = u0.copy()\n        phi = phi0.copy()\n\n        for _ in range(MAX_ITER):\n            R_old = compute_R(u, phi, eps_r, alpha)\n            current_norm = np.linalg.norm(R_old)\n\n            if current_norm < TOL:\n                return True\n\n            # Mechanical Subproblem (u-update)\n            rhs_u = f - K_up @ phi\n            try:\n                u_new = np.linalg.solve(K_uu, rhs_u)\n            except np.linalg.LinAlgError:\n                return False\n\n            # Electrical Subproblem (phi-update, one Newton step)\n            R_p_at_new_u = K_up.T @ u_new + eps_r * (K_pp0 @ phi) + 2 * alpha * np.power(phi, 3) - r\n            J_pp = eps_r * K_pp0 + 6 * alpha * np.diag(np.power(phi, 2))\n            \n            try:\n                delta_phi = np.linalg.solve(J_pp, -R_p_at_new_u)\n            except np.linalg.LinAlgError:\n                return False\n\n            # Backtracking line search on the phi update, checking full residual norm\n            step = 1.0\n            line_search_success = False\n            while step > MIN_STEP:\n                phi_new = phi + step * delta_phi\n\n                if np.any(np.abs(phi_new) > 1e12):\n                    step /= 2.0\n                    continue\n\n                R_new = compute_R(u_new, phi_new, eps_r, alpha)\n                if np.linalg.norm(R_new) < current_norm:\n                    u, phi = u_new, phi_new\n                    line_search_success = True\n                    break\n                step /= 2.0\n            \n            if not line_search_success:\n                return False  # Line search failed\n\n        return np.linalg.norm(compute_R(u, phi, eps_r, alpha)) < TOL\n\n    # --- Main Execution Logic ---\n    test_cases = [\n        (1.0, 0.1, 1.0),\n        (100.0, 0.1, 2.0),\n        (10000.0, 0.1, 5.0),\n        (100.0, 0.0, 5.0),\n    ]\n\n    results = []\n    \n    for eps_r, alpha, a in test_cases:\n        grid_points = [-a, 0.0, a]\n        initial_guesses = [np.array(p) for p in itertools.product(grid_points, repeat=4)]\n        num_guesses = len(initial_guesses)\n\n        monolithic_success = 0\n        staggered_success = 0\n\n        for x0 in initial_guesses:\n            u0, phi0 = x0[:2], x0[2:]\n\n            if solve_monolithic(u0.copy(), phi0.copy(), eps_r, alpha):\n                monolithic_success += 1\n            \n            if solve_staggered(u0.copy(), phi0.copy(), eps_r, alpha):\n                staggered_success += 1\n        \n        mono_frac = monolithic_success / num_guesses\n        stag_frac = staggered_success / num_guesses\n        results.extend([mono_frac, stag_frac])\n\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3561263"}]}