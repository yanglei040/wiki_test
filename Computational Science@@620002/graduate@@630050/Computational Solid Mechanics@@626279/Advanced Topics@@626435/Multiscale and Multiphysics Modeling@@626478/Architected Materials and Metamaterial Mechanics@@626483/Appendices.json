{"hands_on_practices": [{"introduction": "Many metamaterials derive their unique behaviors from the geometry of their internal mechanisms. This exercise explores the classic \"rotating squares\" architecture, where large-scale nonlinear response arises from the collective motion of simple hinges [@problem_id:3544745]. You will derive the effective tangent modulus by linking micro-scale hinge rotation to macro-scale strain, capturing the essence of geometric nonlinearity. This practice builds foundational skills in modeling mechanism-based metamaterials and demonstrates how to incorporate practical manufacturing constraints into your analysis.", "problem": "Consider a two-dimensional architected metamaterial unit cell formed by a \"rotating squares\" mechanism: two rigid squares of side length $a$ connected at four corners by identical compliant hinges. Each hinge is modeled as a concentrated flexural spring with rotational stiffness determined by Euler–Bernoulli beam theory. The unit cell initially has width $2a$ and height $2a$, and an out-of-plane breadth $b$. The material of the hinges has Young's modulus $E$. Under a macroscopic horizontal engineering strain $\\varepsilon_x$ applied to the unit cell, the squares rotate by an angle $\\varphi$ (measured in radians). Due to the mechanism kinematics, the horizontal strain is related to the rotation by a purely geometric compatibility relation, without requiring any internal force balance other than at the hinges.\n\nManufacturing constraints impose a minimum manufacturable hinge thickness and a maximum slenderness to prevent excessively long and thin hinges. Specifically, given a nominal hinge thickness $t^\\mathrm{nom}$ and a nominal hinge length $l^\\mathrm{nom}$, the actual manufactured hinge thickness $t$ and hinge length $l$ must satisfy $t \\ge t_{\\min}$ and $l \\le s_{\\max} t$. Additionally, a minimum fillet radius $r_{\\min}$ at the hinge ends requires a minimum hinge length of $l \\ge 2 r_{\\min}$. The feasible manufactured dimensions are taken as $t = \\max(t^\\mathrm{nom}, t_{\\min})$ and $l = \\max\\left(2 r_{\\min}, \\min\\left(l^\\mathrm{nom}, s_{\\max} t\\right)\\right)$, which enforces both constraints.\n\nUsing the following fundamental base:\n- The strain energy in a linear elastic Euler–Bernoulli beam segment undergoing small rotations is given by the hinge energy $U_h = \\tfrac{1}{2} k_\\theta \\theta^2$ where $k_\\theta = \\frac{E I}{l}$, $I = \\frac{b t^3}{12}$ is the second moment of area of the rectangular hinge cross-section, and $l$ is the hinge length. The rotation $\\theta$ is the hinge rotation in radians.\n- The total potential energy stored in the unit cell is the sum of energies of the four identical hinges, each experiencing the same relative rotation. Treat the relative rotation across each hinge as $2\\varphi$ consistent with the rotating squares mechanism under symmetric actuation.\n- The macroscopic strain–rotation compatibility for the mechanism is $\\varepsilon_x = \\sin\\varphi$. This is a purely geometric nonlinearity originating from finite rotations of the squares.\n- The homogenized tangent modulus in the horizontal direction is derived from the second derivative of the strain energy density $\\psi(\\varepsilon_x)$ with respect to $\\varepsilon_x$, where $\\psi$ is the total hinge energy divided by the unit cell volume $V = (2a)(2a)b = 4a^2b$. The tangent modulus $E_\\mathrm{eff}(\\varepsilon_x)$ is defined by $E_\\mathrm{eff} = \\frac{d^2 \\psi}{d \\varepsilon_x^2}$.\n\nTask:\n1. Derive, from the stated fundamental base, the expression for the homogenized tangent modulus $E_\\mathrm{eff}(\\varepsilon_x)$ that captures geometric nonlinearity via the rotation $\\varphi$ and manufacturing constraints via the hinge stiffness $k_\\theta$.\n2. Implement a program that, for each test case in the test suite below, computes $E_\\mathrm{eff}$ using the derived expression and the manufacturing-constrained dimensions. The angle unit must be radians. Express the final modulus in Pascals (Pa). The program must output the results rounded to six decimal places.\n3. Use the following test suite parameter sets, each specified as an ordered tuple $(a, b, E, t^\\mathrm{nom}, l^\\mathrm{nom}, t_{\\min}, s_{\\max}, r_{\\min}, \\varepsilon_x)$ with International System of Units (SI):\n   - Case 1 (general case with feasible nominal dimensions): $(0.01 \\text{ m}, 0.001 \\text{ m}, 2.0 \\times 10^9 \\text{ Pa}, 4.0 \\times 10^{-4} \\text{ m}, 1.2 \\times 10^{-3} \\text{ m}, 3.5 \\times 10^{-4} \\text{ m}, 4.0, 3.0 \\times 10^{-4} \\text{ m}, 0.10)$.\n   - Case 2 (thickness increased to meet minimum and hinge length limited by slenderness): $(0.01 \\text{ m}, 0.001 \\text{ m}, 2.0 \\times 10^9 \\text{ Pa}, 4.0 \\times 10^{-4} \\text{ m}, 2.0 \\times 10^{-3} \\text{ m}, 6.0 \\times 10^{-4} \\text{ m}, 3.0, 2.0 \\times 10^{-4} \\text{ m}, 0.00)$.\n   - Case 3 (high geometric nonlinearity, fillet radius constrains minimum hinge length): $(0.008 \\text{ m}, 0.0012 \\text{ m}, 1.2 \\times 10^9 \\text{ Pa}, 3.0 \\times 10^{-4} \\text{ m}, 1.8 \\times 10^{-3} \\text{ m}, 3.0 \\times 10^{-4} \\text{ m}, 5.0, 6.0 \\times 10^{-4} \\text{ m}, 0.95)$.\n   - Case 4 (moderate strain with slenderness constraint active): $(0.012 \\text{ m}, 8.0 \\times 10^{-4} \\text{ m}, 3.0 \\times 10^9 \\text{ Pa}, 5.0 \\times 10^{-4} \\text{ m}, 2.1 \\times 10^{-3} \\text{ m}, 4.5 \\times 10^{-4} \\text{ m}, 3.5, 2.0 \\times 10^{-4} \\text{ m}, 0.50)$.\n\nFinal output format:\nYour program should produce a single line of output containing the results for the four cases as a comma-separated list enclosed in square brackets (e.g., $[result_1,result_2,result_3,result_4]$). Each $result_i$ must be a floating-point number representing $E_\\mathrm{eff}$ in Pascals, rounded to six decimal places, with no units printed.", "solution": "The problem is deemed valid. It is a self-contained, scientifically grounded problem in the mechanics of architected materials that is well-posed and objective. Although the use of a small-rotation energy model for potentially large rotations is a physical simplification, it is presented as a premise of the problem and does not constitute a logical contradiction that would render the problem unsolvable. The derivation and computation can proceed based on the provided axiomatic framework.\n\nThe objective is to derive an expression for the homogenized tangent modulus, $E_{\\text{eff}}$, of a \"rotating squares\" metamaterial unit cell and to compute its value for a given set of parameters. The tangent modulus is defined as the second derivative of the strain energy density $\\psi$ with respect to the macroscopic strain $\\varepsilon_x$: $E_{\\text{eff}}(\\varepsilon_x) = \\frac{d^2 \\psi}{d \\varepsilon_x^2}$.\n\nThe derivation proceeds in a step-by-step manner, beginning from the fundamental principles laid out in the problem statement.\n\nFirst, we determine the total strain energy, $U$, stored in the unit cell. The cell contains four identical compliant hinges. The rotational energy of a single hinge is given as $U_h = \\tfrac{1}{2} k_\\theta \\theta^2$, where $k_\\theta$ is the rotational stiffness and $\\theta$ is the angle of rotation across the hinge. For the rotating squares mechanism, the rotation of each square is $\\varphi$, and the relative rotation across each hinge is given as $\\theta = 2\\varphi$.\nThe total energy in the four hinges is:\n$$U = 4 U_h = 4 \\left( \\frac{1}{2} k_\\theta (2\\varphi)^2 \\right) = 2 k_\\theta (4\\varphi^2) = 8 k_\\theta \\varphi^2$$\n\nNext, we establish the strain energy density, $\\psi$. This is the total strain energy $U$ divided by the volume of the unit cell, $V$. The initial unit cell is a square of side length $2a$ with an out-of-plane breadth $b$, so its volume is $V = (2a)(2a)b = 4a^2b$.\n$$\\psi = \\frac{U}{V} = \\frac{8 k_\\theta \\varphi^2}{4 a^2 b} = \\frac{2 k_\\theta \\varphi^2}{a^2 b}$$\n\nTo find the tangent modulus, we must express $\\psi$ as a function of the macroscopic strain, $\\varepsilon_x$. The problem provides the purely geometric compatibility relation $\\varepsilon_x = \\sin\\varphi$. We can invert this to express the rotation angle $\\varphi$ in terms of the strain: $\\varphi = \\arcsin(\\varepsilon_x)$. The domain of $\\varepsilon_x$ is limited to $(-1, 1)$ for the arcsin function to be real-valued.\nSubstituting this into the expression for $\\psi$:\n$$\\psi(\\varepsilon_x) = \\frac{2 k_\\theta}{a^2 b} \\left( \\arcsin(\\varepsilon_x) \\right)^2$$\n\nNow, we can compute the tangent modulus by differentiating $\\psi(\\varepsilon_x)$ twice with respect to $\\varepsilon_x$. For convenience, let the constant pre-factor be $C = \\frac{2 k_\\theta}{a^2 b}$.\nThe first derivative is:\n$$\\frac{d\\psi}{d\\varepsilon_x} = C \\frac{d}{d\\varepsilon_x} \\left( \\arcsin(\\varepsilon_x) \\right)^2 = C \\cdot 2 \\arcsin(\\varepsilon_x) \\cdot \\frac{d}{d\\varepsilon_x} \\left( \\arcsin(\\varepsilon_x) \\right)$$\nUsing the standard derivative $\\frac{d}{dx}(\\arcsin x) = \\frac{1}{\\sqrt{1-x^2}}$, we get:\n$$\\frac{d\\psi}{d\\varepsilon_x} = 2C \\frac{\\arcsin(\\varepsilon_x)}{\\sqrt{1-\\varepsilon_x^2}}$$\n\nThe second derivative, $E_\\mathrm{eff} = \\frac{d^2\\psi}{d\\varepsilon_x^2}$, is found by differentiating the above expression using the quotient rule, $\\left(\\frac{f}{g}\\right)' = \\frac{f'g - fg'}{g^2}$, where $f(\\varepsilon_x) = \\arcsin(\\varepsilon_x)$ and $g(\\varepsilon_x) = \\sqrt{1-\\varepsilon_x^2}$.\nThe derivatives are $f'(\\varepsilon_x) = \\frac{1}{\\sqrt{1-\\varepsilon_x^2}}$ and $g'(\\varepsilon_x) = \\frac{-\\varepsilon_x}{\\sqrt{1-\\varepsilon_x^2}}$.\n$$E_\\mathrm{eff}(\\varepsilon_x) = 2C \\left[ \\frac{\\left( \\frac{1}{\\sqrt{1-\\varepsilon_x^2}} \\right) \\sqrt{1-\\varepsilon_x^2} - (\\arcsin(\\varepsilon_x)) \\left( \\frac{-\\varepsilon_x}{\\sqrt{1-\\varepsilon_x^2}} \\right)}{(\\sqrt{1-\\varepsilon_x^2})^2} \\right]$$\n$$E_\\mathrm{eff}(\\varepsilon_x) = 2C \\left[ \\frac{1 + \\frac{\\varepsilon_x \\arcsin(\\varepsilon_x)}{\\sqrt{1-\\varepsilon_x^2}}}{1-\\varepsilon_x^2} \\right]$$\nMultiplying the numerator and denominator by $\\sqrt{1-\\varepsilon_x^2}$ simplifies the expression:\n$$E_\\mathrm{eff}(\\varepsilon_x) = 2C \\left[ \\frac{\\sqrt{1-\\varepsilon_x^2} + \\varepsilon_x \\arcsin(\\varepsilon_x)}{(1-\\varepsilon_x^2)^{3/2}} \\right]$$\n\nNow, we substitute the constant $C = \\frac{2 k_\\theta}{a^2 b}$ and the hinge stiffness $k_\\theta = \\frac{EI}{l} = \\frac{E(bt^3/12)}{l} = \\frac{Ebt^3}{12l}$ back into the expression.\n$$E_\\mathrm{eff}(\\varepsilon_x) = 2 \\left( \\frac{2 k_\\theta}{a^2 b} \\right) \\left[ \\frac{\\sqrt{1-\\varepsilon_x^2} + \\varepsilon_x \\arcsin(\\varepsilon_x)}{(1-\\varepsilon_x^2)^{3/2}} \\right]$$\n$$E_\\mathrm{eff}(\\varepsilon_x) = \\frac{4 k_\\theta}{a^2 b} \\left[ \\frac{\\sqrt{1-\\varepsilon_x^2} + \\varepsilon_x \\arcsin(\\varepsilon_x)}{(1-\\varepsilon_x^2)^{3/2}} \\right]$$\n$$E_\\mathrm{eff}(\\varepsilon_x) = \\frac{4}{a^2 b} \\left( \\frac{E b t^3}{12l} \\right) \\left[ \\frac{\\sqrt{1-\\varepsilon_x^2} + \\varepsilon_x \\arcsin(\\varepsilon_x)}{(1-\\varepsilon_x^2)^{3/2}} \\right]$$\nThe out-of-plane breadth $b$ cancels, yielding the final derived expression for the homogenized tangent modulus:\n$$E_\\mathrm{eff}(\\varepsilon_x) = \\frac{E t^3}{3 a^2 l} \\frac{\\sqrt{1-\\varepsilon_x^2} + \\varepsilon_x \\arcsin(\\varepsilon_x)}{(1-\\varepsilon_x^2)^{3/2}}$$\n\nThe computational implementation requires, for each test case, first calculating the manufactured hinge dimensions $t$ and $l$ based on the given constraints:\n1.  Actual thickness $t = \\max(t^\\mathrm{nom}, t_{\\min})$.\n2.  Actual length $l = \\max\\left(2 r_{\\min}, \\min\\left(l^\\mathrm{nom}, s_{\\max} t\\right)\\right)$.\n\nThese dimensions, along with the provided material and geometric parameters, are then substituted into the derived formula for $E_\\mathrm{eff}(\\varepsilon_x)$ to compute the numerical result. For the special case of $\\varepsilon_x = 0$, the geometric term simplifies to $1$, and the modulus is $E_{\\text{eff}}(0) = \\frac{E t^3}{3 a^2 l}$. The final results are rounded to six decimal places as specified.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the homogenized tangent modulus for a rotating squares metamaterial\n    for several test cases, considering manufacturing constraints.\n    \"\"\"\n\n    test_cases = [\n        # Case 1: (a, b, E, t_nom, l_nom, t_min, s_max, r_min, eps_x) in SI units\n        (0.01, 0.001, 2.0e9, 4.0e-4, 1.2e-3, 3.5e-4, 4.0, 3.0e-4, 0.10),\n        # Case 2\n        (0.01, 0.001, 2.0e9, 4.0e-4, 2.0e-3, 6.0e-4, 3.0, 2.0e-4, 0.00),\n        # Case 3\n        (0.008, 0.0012, 1.2e9, 3.0e-4, 1.8e-3, 3.0e-4, 5.0, 6.0e-4, 0.95),\n        # Case 4\n        (0.012, 8.0e-4, 3.0e9, 5.0e-4, 2.1e-3, 4.5e-4, 3.5, 2.0e-4, 0.50),\n    ]\n\n    results = []\n\n    for case in test_cases:\n        a, b, E, t_nom, l_nom, t_min, s_max, r_min, eps_x = case\n\n        # Step 1: Determine manufactured hinge dimensions (t, l)\n        # Actual thickness is the maximum of nominal and minimum thickness\n        t_actual = np.maximum(t_nom, t_min)\n\n        # Actual length is determined by nominal length, slenderness, and fillet radius constraints\n        l_slenderness_limit = s_max * t_actual\n        l_intermediate = np.minimum(l_nom, l_slenderness_limit)\n        l_fillet_min = 2 * r_min\n        l_actual = np.maximum(l_fillet_min, l_intermediate)\n\n        # Step 2: Calculate the homogenized tangent modulus E_eff\n        # The derived formula is:\n        # E_eff = (E * t^3 / (3 * a^2 * l)) * (sqrt(1 - eps_x^2) + eps_x * arcsin(eps_x)) / (1 - eps_x^2)^(3/2)\n\n        # Pre-calculate the stiffness-related coefficient\n        coeff = (E * t_actual**3) / (3 * a**2 * l_actual)\n\n        # Handle the zero-strain case to avoid any potential division by zero,\n        # although the final expression is well-defined at eps_x = 0.\n        if eps_x == 0.0:\n            # For eps_x = 0, the geometric term becomes 1\n            e_eff = coeff\n        else:\n            # Calculate the geometric nonlinearity term\n            # Ensure eps_x is within the domain of arcsin\n            if abs(eps_x) >= 1.0:\n              # This case should not occur with the given test data, but it is a safeguard.\n              e_eff = np.inf\n            else:\n              asin_eps = np.arcsin(eps_x)\n              one_minus_eps_sq = 1 - eps_x**2\n              sqrt_term = np.sqrt(one_minus_eps_sq)\n              \n              numerator = sqrt_term + eps_x * asin_eps\n              denominator = one_minus_eps_sq**1.5\n              \n              geometric_term = numerator / denominator\n              e_eff = coeff * geometric_term\n        \n        results.append(e_eff)\n\n    # Format the results to six decimal places and print in the required format\n    formatted_results = [f\"{res:.6f}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "3544745"}, {"introduction": "While theoretical models often assume perfect geometries, real-world manufacturing inevitably introduces variations that can significantly impact performance. This practice introduces the critical topic of uncertainty quantification for architected materials, moving from a deterministic to a probabilistic design mindset [@problem_id:3544767]. By modeling a unit cell with uncertain parameters and applying Monte Carlo simulation, you will assess its robustness and reliability. This exercise provides essential, hands-on experience with the computational tools needed to design materials that are resilient to real-world imperfections.", "problem": "Consider a periodic architected unit cell that transmits load between two rigid plates through two independent parallel microstructural paths: one axial path consisting of a straight slender strut and one bending-dominated path consisting of a slender cantilever beam segment. Manufacturing variability introduces uncertainty in the ligament thicknesses and in the elastic modulus. The objective is to quantify robustness of the effective small-strain stiffness under these uncertainties.\n\nStarting point and assumptions:\n- Small-strain, linear elasticity applies, with one-dimensional Hooke’s law $\\sigma = E \\varepsilon$ and Euler–Bernoulli beam theory for slender beams.\n- The axial path has length $L_a$, width $b$, thickness $t_a$, and elastic modulus $E$; its cross-sectional area is $A_a = b t_a$.\n- The bending path is modeled as a cantilever beam of length $L_b$, width $b$, thickness $t_b$, and elastic modulus $E$; its area moment of inertia is $I_b = \\frac{b t_b^3}{12}$ for a rectangular section.\n- The two paths act as linear elastic springs in parallel between the plates.\n- Uncertainties in $E$, $t_a$, and $t_b$ are independent and uniformly distributed about nominal values within prescribed relative bounds.\n\nTask:\n1. Using first principles, derive the equivalent stiffness $K_{\\text{eff}}$ of the unit cell as a function of $E$, $b$, $t_a$, $t_b$, $L_a$, and $L_b$.\n2. Show how monotonicity with respect to $E$, $t_a$, and $t_b$ determines the worst-case (robust minimum) stiffness $K_{\\text{robust}}$ over independent bounded uncertainties.\n3. Estimate the reliability $R$ defined as the probability (expressed as a decimal fraction) that $K_{\\text{eff}} \\ge K_{\\min}$ under the specified independent uniform uncertainties, using Monte Carlo (MC) sampling with a fixed pseudo-random seed for reproducibility.\n\nImplementation requirements:\n- Compute $K_{\\text{robust}}$ by evaluating $K_{\\text{eff}}$ at the lower endpoints of the uncertain intervals.\n- Estimate $R$ via MC sampling with $N$ samples and a fixed seed $12345$.\n- Express stiffness values in Newton per meter (N/m) and reliability as a decimal fraction in $[0,1]$.\n- Angles are not involved in this problem.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each test case result is itself a two-element list containing $K_{\\text{robust}}$ and $R$, for example, $[[K_{\\text{robust},1},R_1],[K_{\\text{robust},2},R_2],\\dots]$.\n\nTest suite:\nUse the following four scientifically plausible parameter sets to exercise different regimes and edge cases. In all cases, $b$ is the in-plane ligament width and $K_{\\min}$ is the target threshold for reliability. Units: $E$ in Pascal (Pa), lengths in meters (m), and stiffness in Newton per meter (N/m).\n\n- Case $\\#1$ (moderate uncertainty, mixed axial–bending regime, “happy path”):\n  - $E_0 = 2 \\times 10^{9}$ Pa, $b = 1 \\times 10^{-2}$ m, $L_a = 5 \\times 10^{-1}$ m, $L_b = 5 \\times 10^{-2}$ m.\n  - $t_{a,0} = 1 \\times 10^{-4}$ m, $t_{b,0} = 1 \\times 10^{-3}$ m.\n  - Relative uncertainty bounds: $u_E = 1 \\times 10^{-1}$, $u_{t_a} = 2 \\times 10^{-1}$, $u_{t_b} = 2 \\times 10^{-1}$.\n  - Threshold: $K_{\\min} = 3.8 \\times 10^{3}$ N/m.\n  - MC samples: $N = 5 \\times 10^{4}$.\n\n- Case $\\#2$ (zero-uncertainty boundary; equality at threshold):\n  - $E_0 = 2 \\times 10^{9}$ Pa, $b = 1 \\times 10^{-2}$ m, $L_a = 5 \\times 10^{-1}$ m, $L_b = 5 \\times 10^{-2}$ m.\n  - $t_{a,0} = 1 \\times 10^{-4}$ m, $t_{b,0} = 1 \\times 10^{-3}$ m.\n  - Relative uncertainty bounds: $u_E = 0$, $u_{t_a} = 0$, $u_{t_b} = 0$.\n  - Threshold: $K_{\\min} = 4.04 \\times 10^{3}$ N/m.\n  - MC samples: $N = 1 \\times 10^{3}$.\n\n- Case $\\#3$ (high uncertainty, reliability stress test):\n  - $E_0 = 2 \\times 10^{9}$ Pa, $b = 1 \\times 10^{-2}$ m, $L_a = 5 \\times 10^{-1}$ m, $L_b = 5 \\times 10^{-2}$ m.\n  - $t_{a,0} = 1 \\times 10^{-4}$ m, $t_{b,0} = 1 \\times 10^{-3}$ m.\n  - Relative uncertainty bounds: $u_E = 4 \\times 10^{-1}$, $u_{t_a} = 5 \\times 10^{-1}$, $u_{t_b} = 5 \\times 10^{-1}$.\n  - Threshold: $K_{\\min} = 5 \\times 10^{3}$ N/m.\n  - MC samples: $N = 5 \\times 10^{4}$.\n\n- Case $\\#4$ (bending-dominated path with moderate uncertainty):\n  - $E_0 = 2 \\times 10^{9}$ Pa, $b = 1 \\times 10^{-2}$ m, $L_a = 5 \\times 10^{-1}$ m, $L_b = 2 \\times 10^{-2}$ m.\n  - $t_{a,0} = 2 \\times 10^{-5}$ m, $t_{b,0} = 2 \\times 10^{-3}$ m.\n  - Relative uncertainty bounds: $u_E = 1 \\times 10^{-1}$, $u_{t_a} = 2 \\times 10^{-1}$, $u_{t_b} = 1 \\times 10^{-1}$.\n  - Threshold: $K_{\\min} = 6 \\times 10^{3}$ N/m.\n  - MC samples: $N = 5 \\times 10^{4}$.\n\nOutput specification:\n- For each case, compute and return a two-element list $[K_{\\text{robust}}, R]$ where $K_{\\text{robust}}$ is a float in N/m and $R$ is a float in $[0,1]$.\n- Your program should produce a single line of output containing the results for the four cases as a comma-separated list enclosed in square brackets, for example, $[[K_{\\text{robust},1},R_1],[K_{\\text{robust},2},R_2],[K_{\\text{robust},3},R_3],[K_{\\text{robust},4},R_4]]$.", "solution": "The problem requires an analysis of the effective stiffness of a periodic architected unit cell. The analysis involves deriving the stiffness from first principles, determining its robust minimum value under parameter uncertainty, and estimating the reliability of the structure using a Monte Carlo simulation.\n\n### Step 1: Derivation of the Effective Stiffness, $K_{\\text{eff}}$\n\nThe unit cell's mechanical response is modeled by two independent load-bearing paths acting in parallel between two rigid plates. The total effective stiffness, $K_{\\text{eff}}$, is the sum of the stiffnesses of the individual paths: the axial path stiffness, $K_a$, and the bending path stiffness, $K_b$.\n\n$$ K_{\\text{eff}} = K_a + K_b $$\n\n**Stiffness of the Axial Path ($K_a$)**\n\nThe axial path is a slender strut of length $L_a$, width $b$, thickness $t_a$, and elastic modulus $E$. For a bar under axial load, the relationship between applied force $F$ and resulting elongation $\\delta$ is given by $F = k \\delta$. The stiffness $k$ is defined as $k = \\frac{EA}{L}$, where $A$ is the cross-sectional area and $L$ is the length.\n\nIn this case, the cross-sectional area is $A_a = b t_a$. The stiffness of the axial path is therefore:\n\n$$ K_a = \\frac{E A_a}{L_a} = \\frac{E b t_a}{L_a} $$\n\n**Stiffness of the Bending Path ($K_b$)**\n\nThe bending path is modeled as a cantilever beam of length $L_b$, width $b$, thickness $t_b$, and elastic modulus $E$. According to Euler-Bernoulli beam theory, the deflection $\\delta$ at the free end of a cantilever beam subjected to a point force $P$ at that end is:\n\n$$ \\delta = \\frac{P L_b^3}{3 E I_b} $$\n\nwhere $I_b$ is the area moment of inertia of the beam's cross-section. For a rectangular cross-section of width $b$ and height (thickness) $t_b$, the area moment of inertia is:\n\n$$ I_b = \\frac{b t_b^3}{12} $$\n\nThe stiffness of the cantilever beam, $K_b$, is the ratio of the applied force to the deflection, $K_b = P/\\delta$. Substituting the expressions for $\\delta$ and $I_b$:\n\n$$ K_b = \\frac{P}{\\delta} = \\frac{3 E I_b}{L_b^3} = \\frac{3 E}{L_b^3} \\left( \\frac{b t_b^3}{12} \\right) = \\frac{E b t_b^3}{4 L_b^3} $$\n\n**Total Effective Stiffness ($K_{\\text{eff}}$)**\n\nSumming the stiffnesses of the two parallel paths gives the total effective stiffness of the unit cell as a function of its geometric and material parameters:\n\n$$ K_{\\text{eff}}(E, t_a, t_b) = \\frac{E b t_a}{L_a} + \\frac{E b t_b^3}{4 L_b^3} $$\n\nThis function forms the basis for the subsequent uncertainty analysis.\n\n### Step 2: Determination of the Robust Minimum Stiffness, $K_{\\text{robust}}$\n\nThe robust minimum stiffness, $K_{\\text{robust}}$, is the guaranteed minimum stiffness of the unit cell given the uncertainties in the parameters $E$, $t_a$, and $t_b$. These parameters are independent and vary within specified bounds. To find the minimum value of $K_{\\text{eff}}$, we examine its dependence on each uncertain variable. This is achieved by assessing the sign of the partial derivatives of $K_{\\text{eff}}$ with respect to $E$, $t_a$, and $t_b$.\n\nThe function is: $K_{\\text{eff}} = E b \\left( \\frac{t_a}{L_a} + \\frac{t_b^3}{4 L_b^3} \\right)$.\n\n1.  **Partial derivative with respect to $E$**:\n    $$ \\frac{\\partial K_{\\text{eff}}}{\\partial E} = b \\left( \\frac{t_a}{L_a} + \\frac{t_b^3}{4 L_b^3} \\right) $$\n    Since all geometric parameters ($b, t_a, t_b, L_a, L_b$) are positive, this derivative is always positive. Thus, $K_{\\text{eff}}$ is a monotonically increasing function of $E$.\n\n2.  **Partial derivative with respect to $t_a$**:\n    $$ \\frac{\\partial K_{\\text{eff}}}{\\partial t_a} = \\frac{E b}{L_a} $$\n    Since $E$, $b$, and $L_a$ are positive, this derivative is always positive. Thus, $K_{\\text{eff}}$ is a monotonically increasing function of $t_a$.\n\n3.  **Partial derivative with respect to $t_b$**:\n    $$ \\frac{\\partial K_{\\text{eff}}}{\\partial t_b} = \\frac{E b}{4 L_b^3} (3 t_b^2) = \\frac{3 E b t_b^2}{4 L_b^3} $$\n    Since all parameters are positive, this derivative is always positive. Thus, $K_{\\text{eff}}$ is a monotonically increasing function of $t_b$.\n\nBecause $K_{\\text{eff}}$ is a monotonically increasing function with respect to each of the independent uncertain variables $E$, $t_a$, and $t_b$, its global minimum value over the uncertainty domain occurs when each variable is at its respective minimum value. For a variable $X$ with nominal value $X_0$ and relative uncertainty bound $u_X$, the value is in the interval $[X_0(1-u_X), X_0(1+u_X)]$. The minimum values are therefore:\n$E_{\\min} = E_0 (1 - u_E)$, $t_{a, \\min} = t_{a,0} (1 - u_{t_a})$, and $t_{b, \\min} = t_{b,0} (1 - u_{t_b})$.\n\n$K_{\\text{robust}}$ is calculated by substituting these minimum values into the $K_{\\text{eff}}$ expression:\n\n$$ K_{\\text{robust}} = K_{\\text{eff}}(E_{\\min}, t_{a, \\min}, t_{b, \\min}) = \\frac{E_{\\min} b t_{a, \\min}}{L_a} + \\frac{E_{\\min} b t_{b, \\min}^3}{4 L_b^3} $$\n\n### Step 3: Monte Carlo Estimation of Reliability, $R$\n\nThe reliability $R$ is the probability that the effective stiffness $K_{\\text{eff}}$ meets or exceeds a minimum required threshold, $K_{\\min}$, i.e., $R = P(K_{\\text{eff}} \\ge K_{\\min})$. We estimate this probability using a Monte Carlo (MC) simulation. The procedure is as follows:\n\n1.  **Set Seed**: A pseudo-random number generator is initialized with a fixed seed ($12345$) to ensure the reproducibility of the results.\n2.  **Generate Samples**: For each of the $N$ MC trials, a random sample is drawn for each uncertain parameter ($E, t_a, t_b$) from its specified uniform distribution:\n    -   $E^{(i)} \\sim U[E_0(1 - u_E), E_0(1 + u_E)]$\n    -   $t_a^{(i)} \\sim U[t_{a,0}(1 - u_{t_a}), t_{a,0}(1 + u_{t_a})]$\n    -   $t_b^{(i)} \\sim U[t_{b,0}(1 - u_{t_b}), t_{b,0}(1 + u_{t_b})]$\n    for $i = 1, \\dots, N$.\n3.  **Evaluate Stiffness**: For each set of sampled parameters $\\{E^{(i)}, t_a^{(i)}, t_b^{(i)}\\}$, the effective stiffness $K_{\\text{eff}}^{(i)}$ is calculated using the derived formula.\n4.  **Count Successes**: A trial is considered a \"success\" if $K_{\\text{eff}}^{(i)} \\ge K_{\\min}$. The total number of successful trials, $N_{\\text{success}}$, is counted.\n5.  **Estimate Probability**: The reliability $R$ is estimated as the ratio of successful trials to the total number of trials:\n    $$ R \\approx \\frac{N_{\\text{success}}}{N} $$\n\nThis method provides a robust numerical estimate of the reliability, which converges to the true probability as $N \\to \\infty$.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for robust stiffness and reliability for four test cases\n    of an architected unit cell.\n    \"\"\"\n\n    test_cases = [\n        # Case #1 (moderate uncertainty, mixed axial-bending regime)\n        {\n            \"E0\": 2e9, \"b\": 1e-2, \"La\": 5e-1, \"Lb\": 5e-2,\n            \"ta0\": 1e-4, \"tb0\": 1e-3,\n            \"uE\": 1e-1, \"uta\": 2e-1, \"utb\": 2e-1,\n            \"K_min\": 3.8e3, \"N\": 50000\n        },\n        # Case #2 (zero-uncertainty boundary)\n        {\n            \"E0\": 2e9, \"b\": 1e-2, \"La\": 5e-1, \"Lb\": 5e-2,\n            \"ta0\": 1e-4, \"tb0\": 1e-3,\n            \"uE\": 0.0, \"uta\": 0.0, \"utb\": 0.0,\n            \"K_min\": 4.04e3, \"N\": 1000\n        },\n        # Case #3 (high uncertainty, reliability stress test)\n        {\n            \"E0\": 2e9, \"b\": 1e-2, \"La\": 5e-1, \"Lb\": 5e-2,\n            \"ta0\": 1e-4, \"tb0\": 1e-3,\n            \"uE\": 4e-1, \"uta\": 5e-1, \"utb\": 5e-1,\n            \"K_min\": 5e3, \"N\": 50000\n        },\n        # Case #4 (bending-dominated path)\n        {\n            \"E0\": 2e9, \"b\": 1e-2, \"La\": 5e-1, \"Lb\": 2e-2,\n            \"ta0\": 2e-5, \"tb0\": 2e-3,\n            \"uE\": 1e-1, \"uta\": 2e-1, \"utb\": 1e-1,\n            \"K_min\": 6e3, \"N\": 50000\n        }\n    ]\n\n    results = []\n    # Fixed seed for reproducibility\n    seed = 12345\n    rng = np.random.default_rng(seed)\n\n    for case in test_cases:\n        E0, b, La, Lb = case[\"E0\"], case[\"b\"], case[\"La\"], case[\"Lb\"]\n        ta0, tb0 = case[\"ta0\"], case[\"tb0\"]\n        uE, uta, utb = case[\"uE\"], case[\"uta\"], case[\"utb\"]\n        K_min, N = case[\"K_min\"], case[\"N\"]\n\n        # Define the effective stiffness function\n        def calculate_k_eff(E, ta, tb):\n            k_a = (E * b * ta) / La\n            k_b = (E * b * tb**3) / (4 * Lb**3)\n            return k_a + k_b\n\n        # 1. Compute robust minimum stiffness, K_robust\n        E_min = E0 * (1 - uE)\n        ta_min = ta0 * (1 - uta)\n        tb_min = tb0 * (1 - utb)\n        K_robust = calculate_k_eff(E_min, ta_min, tb_min)\n\n        # 2. Estimate reliability, R, via Monte Carlo sampling\n        # Define uniform distribution bounds for uncertain parameters\n        E_lower, E_upper = E0 * (1 - uE), E0 * (1 + uE)\n        ta_lower, ta_upper = ta0 * (1 - uta), ta0 * (1 + uta)\n        tb_lower, tb_upper = tb0 * (1 - utb), tb0 * (1 + utb)\n\n        # Generate N random samples for each parameter\n        E_samples = rng.uniform(E_lower, E_upper, size=N)\n        ta_samples = rng.uniform(ta_lower, ta_upper, size=N)\n        tb_samples = rng.uniform(tb_lower, tb_upper, size=N)\n\n        # Calculate K_eff for all samples (vectorized)\n        k_eff_samples = calculate_k_eff(E_samples, ta_samples, tb_samples)\n        \n        # Count successful trials where K_eff >= K_min\n        success_count = np.sum(k_eff_samples >= K_min)\n        \n        # Estimate reliability\n        R = success_count / N\n\n        results.append([K_robust, R])\n\n    # Format the final output string as specified\n    formatted_results = [f\"[{k},{r}]\" for k, r in results]\n    final_output = f\"[{','.join(formatted_results)}]\"\n    print(final_output)\n\nsolve()\n```", "id": "3544767"}, {"introduction": "Modeling every microstructural detail of a large architected component is often computationally infeasible. To overcome this, we can use homogenized or \"effective\" continuum theories that capture the essential micro-scale physics, such as local rotations, at the macro-scale [@problem_id:3544744]. This advanced exercise guides you through the process of calibrating a micropolar (Cosserat) continuum model, a framework that accounts for such micro-rotations. By fitting the model's parameters to match the results of simulated macroscopic tests, you will practice a powerful technique for bridging scales, a cornerstone of modern multiscale mechanics.", "problem": "You are given a simplified, yet scientifically consistent, one-dimensional micropolar (Cosserat) beam surrogate for an architected periodic solid. The surrogate links micro-rotational stiffness parameters to macro-scale torsion and bending test responses. The material is modeled as an isotropic micropolar continuum with classical moduli, a Cosserat couple modulus, and a curvature modulus. The aim is to infer the Cosserat couple modulus and the curvature modulus by minimizing a physically motivated objective function against measured macro-scale stiffnesses.\n\nFundamental base and definitions:\n- The beam is slender and prismatic with circular cross-section of radius $R$ (in $\\mathrm{m}$). Its polar second moment of area is $J = \\pi R^4 / 2$ (in $\\mathrm{m}^4$), and the second moment for bending about any centroidal in-plane axis is $I = \\pi R^4 / 4$ (in $\\mathrm{m}^4$).\n- The classical isotropic moduli are the Young's modulus $E$ (in $\\mathrm{Pa}$) and the shear modulus $G$ (in $\\mathrm{Pa}$).\n- The micropolar (Cosserat) moduli to be determined are the Cosserat couple modulus $\\mu_c$ (in $\\mathrm{Pa}$) and the curvature modulus $A$ (in $\\mathrm{Pa}$), both assumed positive.\n- Micro-Finite Element (micro-FE) cell analyses yield dimensionless mode weights $\\zeta_t$ and $\\zeta_b$ that scale how the curvature modulus $A$ contributes in torsion and bending tests, respectively. These weights encode mode-dependent microstructural leverage and are treated as known, test-specific inputs.\n- Under small deformations, the torsion test imposes a macro twist rate $\\Theta$ (in $\\mathrm{rad/m}$), and the bending test imposes a macro curvature $\\mathcal{K}$ (in $\\mathrm{rad/m}$). The micro-rotation field couples to these gradients; the energy-minimizing micro-rotation gradient produces mode-dependent effective stiffness augmentations that are monotone in $\\mu_c$ and $A$.\n\nModel and macro response prediction:\n- By energy minimization with respect to the micro-rotation gradient in each mode, the torsion and bending stiffness augmentations are\n$$\nS_t(\\mu_c,A) = \\frac{\\mu_c \\, A \\, \\zeta_t}{\\mu_c + A \\, \\zeta_t}, \\qquad\nS_b(\\mu_c,A) = \\frac{\\mu_c \\, A \\, \\zeta_b}{\\mu_c + A \\, \\zeta_b}.\n$$\n- The predicted torsional and bending rigidities are\n$$\nK_t(\\mu_c,A) = \\left(G + S_t(\\mu_c,A)\\right) J, \\qquad\nK_b(\\mu_c,A) = \\left(E + S_b(\\mu_c,A)\\right) I,\n$$\nwith units of $\\mathrm{N \\cdot m^2}$.\n\nObjective function:\n- Given measured macro-scale rigidities $K_t^{\\mathrm{exp}}$ and $K_b^{\\mathrm{exp}}$ (in $\\mathrm{N \\cdot m^2}$) from tests on the architected beam, we define the objective function to be minimized over $(\\mu_c,A)$ as\n$$\n\\Phi(\\mu_c,A) = \\left(\\frac{K_t(\\mu_c,A) - K_t^{\\mathrm{exp}}}{K_t^{\\mathrm{exp}}}\\right)^2\n+ \\left(\\frac{K_b(\\mu_c,A) - K_b^{\\mathrm{exp}}}{K_b^{\\mathrm{exp}}}\\right)^2,\n$$\nsubject to $\\mu_c > 0$ and $A > 0$.\n\nNumerical requirements:\n- Angles are in radians, twist rate and curvature are in $\\mathrm{rad/m}$. All moduli ($E$, $G$, $\\mu_c$, $A$) are in $\\mathrm{Pa}$. All rigidities ($K_t$, $K_b$) are in $\\mathrm{N \\cdot m^2}$. The final fitted values of $\\mu_c$ and $A$ must be expressed in $\\mathrm{Pa}$.\n- Your program must minimize $\\Phi(\\mu_c,A)$ for each test case, using the provided inputs, and output the fitted $(\\mu_c,A)$ pairs.\n- The final output must be a single line containing the results as a comma-separated list of lists, enclosed in square brackets. Each inner list must contain the two fitted values $(\\mu_c,A)$ in scientific notation with three significant digits, in Pascals. For example: $[\\,[8.00\\mathrm{e}+08,1.50\\mathrm{e}+09],\\dots]$.\n\nTest suite:\nProvide solutions for the following three scientifically consistent scenarios. For each case, use the given parameters and the measured rigidities. Each case has distinct micro-FE mode weights, ensuring identifiability of $\\mu_c$ and $A$.\n\n- Case $1$ (happy path, moderate Cosserat effect):\n  - $R = 0.01\\,\\mathrm{m}$, $E = 1.2\\times 10^9\\,\\mathrm{Pa}$, $G = \\frac{E}{2(1+\\nu)}$ with $\\nu = 0.3$ so $G = 4.61538461538\\times 10^8\\,\\mathrm{Pa}$.\n  - $\\zeta_t = 0.6$, $\\zeta_b = 0.15$.\n  - Measured rigidities generated from a micro-FE-consistent reference with $\\mu_c^{\\mathrm{ref}} = 0.8\\times 10^9\\,\\mathrm{Pa}$ and $A^{\\mathrm{ref}} = 1.5\\times 10^9\\,\\mathrm{Pa}$:\n    - $J = \\pi R^4/2$, $I = \\pi R^4/4$.\n    - $K_t^{\\mathrm{exp}} = \\left(G + \\dfrac{\\mu_c^{\\mathrm{ref}} A^{\\mathrm{ref}} \\zeta_t}{\\mu_c^{\\mathrm{ref}} + A^{\\mathrm{ref}}\\zeta_t}\\right) J$,\n      $K_b^{\\mathrm{exp}} = \\left(E + \\dfrac{\\mu_c^{\\mathrm{ref}} A^{\\mathrm{ref}} \\zeta_b}{\\mu_c^{\\mathrm{ref}} + A^{\\mathrm{ref}}\\zeta_b}\\right) I$.\n\n- Case $2$ (edge case, small Cosserat effect):\n  - $R = 0.005\\,\\mathrm{m}$, $E = 0.8\\times 10^9\\,\\mathrm{Pa}$, $G = \\frac{E}{2(1+\\nu)}$ with $\\nu = 0.25$ so $G = 3.2\\times 10^8\\,\\mathrm{Pa}$.\n  - $\\zeta_t = 0.3$, $\\zeta_b = 0.1$.\n  - Measured rigidities from $\\mu_c^{\\mathrm{ref}} = 0.05\\times 10^9\\,\\mathrm{Pa}$ and $A^{\\mathrm{ref}} = 0.05\\times 10^9\\,\\mathrm{Pa}$:\n    - $J = \\pi R^4/2$, $I = \\pi R^4/4$.\n    - $K_t^{\\mathrm{exp}} = \\left(G + \\dfrac{\\mu_c^{\\mathrm{ref}} A^{\\mathrm{ref}} \\zeta_t}{\\mu_c^{\\mathrm{ref}} + A^{\\mathrm{ref}}\\zeta_t}\\right) J$,\n      $K_b^{\\mathrm{exp}} = \\left(E + \\dfrac{\\mu_c^{\\mathrm{ref}} A^{\\mathrm{ref}} \\zeta_b}{\\mu_c^{\\mathrm{ref}} + A^{\\mathrm{ref}}\\zeta_b}\\right) I$.\n\n- Case $3$ (large Cosserat effect with strong mode contrast):\n  - $R = 0.0075\\,\\mathrm{m}$, $E = 3.0\\times 10^9\\,\\mathrm{Pa}$, $G = \\frac{E}{2(1+\\nu)}$ with $\\nu = 0.3$ so $G = 1.15384615385\\times 10^9\\,\\mathrm{Pa}$.\n  - $\\zeta_t = 0.9$, $\\zeta_b = 0.2$.\n  - Measured rigidities from $\\mu_c^{\\mathrm{ref}} = 5.0\\times 10^9\\,\\mathrm{Pa}$ and $A^{\\mathrm{ref}} = 2.0\\times 10^9\\,\\mathrm{Pa}$:\n    - $J = \\pi R^4/2$, $I = \\pi R^4/4$.\n    - $K_t^{\\mathrm{exp}} = \\left(G + \\dfrac{\\mu_c^{\\mathrm{ref}} A^{\\mathrm{ref}} \\zeta_t}{\\mu_c^{\\mathrm{ref}} + A^{\\mathrm{ref}}\\zeta_t}\\right) J$,\n      $K_b^{\\mathrm{exp}} = \\left(E + \\dfrac{\\mu_c^{\\mathrm{ref}} A^{\\mathrm{ref}} \\zeta_b}{\\mu_c^{\\mathrm{ref}} + A^{\\mathrm{ref}}\\zeta_b}\\right) I$.\n\nAnswer specification:\n- For each case, return the fitted pair $[\\mu_c, A]$ in Pascals, formatted in scientific notation with three significant digits.\n- Your program should produce a single line containing the results as a comma-separated list enclosed in square brackets, for example:\n$[ [8.00\\mathrm{e}+08,1.50\\mathrm{e}+09],[5.00\\mathrm{e}+07,5.00\\mathrm{e}+07],[5.00\\mathrm{e}+09,2.00\\mathrm{e}+09] ]$.", "solution": "The objective is to determine the Cosserat couple modulus, $\\mu_c$, and the curvature modulus, $A$, for a micropolar beam surrogate by minimizing an objective function, $\\Phi(\\mu_c, A)$, against experimentally measured torsional and bending rigidities, $K_t^{\\mathrm{exp}}$ and $K_b^{\\mathrm{exp}}$.\n\nThe objective function to be minimized is given by:\n$$\n\\Phi(\\mu_c,A) = \\left(\\frac{K_t(\\mu_c,A) - K_t^{\\mathrm{exp}}}{K_t^{\\mathrm{exp}}}\\right)^2\n+ \\left(\\frac{K_b(\\mu_c,A) - K_b^{\\mathrm{exp}}}{K_b^{\\mathrm{exp}}}\\right)^2\n$$\nwhere the predicted rigidities are:\n$$\nK_t(\\mu_c,A) = \\left(G + S_t(\\mu_c,A)\\right) J, \\qquad\nK_b(\\mu_c,A) = \\left(E + S_b(\\mu_c,A)\\right) I\n$$\nThe stiffness augmentations, $S_t$ and $S_b$, are functions of the micropolar moduli:\n$$\nS_t(\\mu_c,A) = \\frac{\\mu_c \\, A \\, \\zeta_t}{\\mu_c + A \\, \\zeta_t}, \\qquad\nS_b(\\mu_c,A) = \\frac{\\mu_c \\, A \\, \\zeta_b}{\\mu_c + A \\, \\zeta_b}\n$$\n\nThe objective function $\\Phi(\\mu_c,A)$ is a sum of squared terms and is therefore non-negative. Its minimum value is $0$, which occurs if and only if both terms are zero. This requires the predicted rigidities to exactly match the experimental measurements:\n$$\nK_t(\\mu_c,A) = K_t^{\\mathrm{exp}} \\\\\nK_b(\\mu_c,A) = K_b^{\\mathrm{exp}}\n$$\nSubstituting the definitions for the predicted rigidities, we obtain a system of two equations:\n$$\n\\left(G + S_t(\\mu_c,A)\\right) J = K_t^{\\mathrm{exp}} \\\\\n\\left(E + S_b(\\mu_c,A)\\right) I = K_b^{\\mathrm{exp}}\n$$\nWe can solve for the required stiffness augmentations, which we will designate as $S_t^{\\mathrm{target}}$ and $S_b^{\\mathrm{target}}$:\n$$\nS_t^{\\mathrm{target}} = \\frac{K_t^{\\mathrm{exp}}}{J} - G \\\\\nS_b^{\\mathrm{target}} = \\frac{K_b^{\\mathrm{exp}}}{I} - E\n$$\nThe problem is reduced to finding $(\\mu_c, A)$ that satisfy the following system of non-linear algebraic equations:\n$$\nS_t^{\\mathrm{target}} = \\frac{\\mu_c \\, A \\, \\zeta_t}{\\mu_c + A \\, \\zeta_t} \\quad (1) \\\\\nS_b^{\\mathrm{target}} = \\frac{\\mu_c \\, A \\, \\zeta_b}{\\mu_c + A \\, \\zeta_b} \\quad (2)\n$$\nThe problem states that the experimental data, $K_t^{\\mathrm{exp}}$ and $K_b^{\\mathrm{exp}}$, are generated from known reference moduli, $\\mu_c^{\\mathrm{ref}}$ and $A^{\\mathrm{ref}}$. This means that an exact solution exists and is equal to these reference values. The minimization procedure is thus equivalent to an algebraic inversion of the model equations.\n\nTo solve for $\\mu_c$ and $A$, it is convenient to rearrange equations $(1)$ and $(2)$ by taking their reciprocals:\n$$\n\\frac{1}{S_t^{\\mathrm{target}}} = \\frac{\\mu_c + A \\, \\zeta_t}{\\mu_c \\, A \\, \\zeta_t} = \\frac{1}{A \\, \\zeta_t} + \\frac{1}{\\mu_c} \\\\\n\\frac{1}{S_b^{\\mathrm{target}}} = \\frac{\\mu_c + A \\, \\zeta_b}{\\mu_c \\, A \\, \\zeta_b} = \\frac{1}{A \\, \\zeta_b} + \\frac{1}{\\mu_c}\n$$\nThis transforms the non-linear system into a linear system for the variables $1/\\mu_c$ and $1/A$. Let $X = 1/\\mu_c$ and $Y = 1/A$. The system becomes:\n$$\nX + \\frac{Y}{\\zeta_t} = \\frac{1}{S_t^{\\mathrm{target}}} \\quad (3) \\\\\nX + \\frac{Y}{\\zeta_b} = \\frac{1}{S_b^{\\mathrm{target}}} \\quad (4)\n$$\nSubtracting equation $(4)$ from $(3)$:\n$$\nY \\left(\\frac{1}{\\zeta_t} - \\frac{1}{\\zeta_b}\\right) = \\frac{1}{S_t^{\\mathrm{target}}} - \\frac{1}{S_b^{\\mathrm{target}}}\n$$\n$$\nY \\frac{\\zeta_b - \\zeta_t}{\\zeta_t \\zeta_b} = \\frac{S_b^{\\mathrm{target}} - S_t^{\\mathrm{target}}}{S_t^{\\mathrm{target}} S_b^{\\mathrm{target}}}\n$$\nSolving for $Y = 1/A$:\n$$\nY = \\frac{S_b^{\\mathrm{target}} - S_t^{\\mathrm{target}}}{S_t^{\\mathrm{target}} S_b^{\\mathrm{target}}} \\frac{\\zeta_t \\zeta_b}{\\zeta_b - \\zeta_t} = \\frac{(S_t^{\\mathrm{target}} - S_b^{\\mathrm{target}})\\zeta_t \\zeta_b}{S_t^{\\mathrm{target}} S_b^{\\mathrm{target}}(\\zeta_t - \\zeta_b)}\n$$\nTherefore, the curvature modulus $A$ is:\n$$\nA = \\frac{1}{Y} = \\frac{S_t^{\\mathrm{target}} S_b^{\\mathrm{target}}(\\zeta_t - \\zeta_b)}{(S_t^{\\mathrm{target}} - S_b^{\\mathrm{target}})\\zeta_t \\zeta_b}\n$$\nThis solution is well-defined provided $\\zeta_t \\neq \\zeta_b$ and $S_t^{\\mathrm{target}} \\neq S_b^{\\mathrm{target}}$, conditions which are met as stated in the problem description.\n\nNext, we solve for $X = 1/\\mu_c$ using equation $(3)$:\n$$\nX = \\frac{1}{S_t^{\\mathrm{target}}} - \\frac{Y}{\\zeta_t} = \\frac{1}{S_t^{\\mathrm{target}}} - \\frac{1}{\\zeta_t} \\left( \\frac{(S_t^{\\mathrm{target}} - S_b^{\\mathrm{target}})\\zeta_t \\zeta_b}{S_t^{\\mathrm{target}} S_b^{\\mathrm{target}}(\\zeta_t - \\zeta_b)} \\right)\n$$\n$$\nX = \\frac{1}{S_t^{\\mathrm{target}}} - \\frac{(S_t^{\\mathrm{target}} - S_b^{\\mathrm{target}})\\zeta_b}{S_t^{\\mathrm{target}} S_b^{\\mathrm{target}}(\\zeta_t - \\zeta_b)}\n$$\n$$\nX = \\frac{S_b^{\\mathrm{target}}(\\zeta_t - \\zeta_b) - (S_t^{\\mathrm{target}} - S_b^{\\mathrm{target}})\\zeta_b}{S_t^{\\mathrm{target}} S_b^{\\mathrm{target}}(\\zeta_t - \\zeta_b)} = \\frac{S_b^{\\mathrm{target}}\\zeta_t - S_b^{\\mathrm{target}}\\zeta_b - S_t^{\\mathrm{target}}\\zeta_b + S_b^{\\mathrm{target}}\\zeta_b}{S_t^{\\mathrm{target}} S_b^{\\mathrm{target}}(\\zeta_t - \\zeta_b)}\n$$\n$$\nX = \\frac{S_b^{\\mathrm{target}}\\zeta_t - S_t^{\\mathrm{target}}\\zeta_b}{S_t^{\\mathrm{target}} S_b^{\\mathrm{target}}(\\zeta_t - \\zeta_b)}\n$$\nTherefore, the Cosserat couple modulus $\\mu_c$ is:\n$$\n\\mu_c = \\frac{1}{X} = \\frac{S_t^{\\mathrm{target}} S_b^{\\mathrm{target}}(\\zeta_t - \\zeta_b)}{S_b^{\\mathrm{target}}\\zeta_t - S_t^{\\mathrm{target}}\\zeta_b}\n$$\nThe computational procedure for each test case is as follows:\n1.  Calculate the beam cross-section properties $J = \\pi R^4 / 2$ and $I = \\pi R^4 / 4$ from the given radius $R$.\n2.  Calculate the stiffness augmentations $S_t(\\mu_c^{\\mathrm{ref}}, A^{\\mathrm{ref}})$ and $S_b(\\mu_c^{\\mathrm{ref}}, A^{\\mathrm{ref}})$ using the provided reference parameters for that case.\n3.  Calculate the \"experimental\" rigidities $K_t^{\\mathrm{exp}} = (G + S_t)J$ and $K_b^{\\mathrm{exp}} = (E + S_b)I$.\n4.  From these, determine the target stiffness augmentations: $S_t^{\\mathrm{target}} = K_t^{\\mathrm{exp}}/J - G$ and $S_b^{\\mathrm{target}} = K_b^{\\mathrm{exp}}/I - E$. By construction, these will be equal to the values from step 2.\n5.  Use the derived analytical formulas for $\\mu_c$ and $A$ to compute the fitted parameters. As the problem is noise-free, the result will be $(\\mu_c, A) = (\\mu_c^{\\mathrm{ref}}, A^{\\mathrm{ref}})$.\n6.  The final results for each case are formatted in scientific notation to three significant digits.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the Cosserat moduli for three test cases by inverting\n    the micropolar beam surrogate model.\n    \"\"\"\n    test_cases = [\n        # Case 1 (happy path, moderate Cosserat effect)\n        {\n            \"R\": 0.01,\n            \"E\": 1.2e9,\n            \"nu\": 0.3,\n            \"zeta_t\": 0.6,\n            \"zeta_b\": 0.15,\n            \"mu_c_ref\": 0.8e9,\n            \"A_ref\": 1.5e9\n        },\n        # Case 2 (edge case, small Cosserat effect)\n        {\n            \"R\": 0.005,\n            \"E\": 0.8e9,\n            \"nu\": 0.25,\n            \"zeta_t\": 0.3,\n            \"zeta_b\": 0.1,\n            \"mu_c_ref\": 0.05e9,\n            \"A_ref\": 0.05e9\n        },\n        # Case 3 (large Cosserat effect with strong mode contrast)\n        {\n            \"R\": 0.0075,\n            \"E\": 3.0e9,\n            \"nu\": 0.3,\n            \"zeta_t\": 0.9,\n            \"zeta_b\": 0.2,\n            \"mu_c_ref\": 5.0e9,\n            \"A_ref\": 2.0e9\n        }\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        # Extract parameters for the current case\n        R = case[\"R\"]\n        E = case[\"E\"]\n        nu = case[\"nu\"]\n        zeta_t = case[\"zeta_t\"]\n        zeta_b = case[\"zeta_b\"]\n        mu_c_ref = case[\"mu_c_ref\"]\n        A_ref = case[\"A_ref\"]\n\n        # Calculate classical shear modulus\n        G = E / (2 * (1 + nu))\n\n        # Calculate geometric properties\n        J = np.pi * R**4 / 2\n        I = np.pi * R**4 / 4\n\n        # Calculate stiffness augmentations from reference values\n        S_t_ref = (mu_c_ref * A_ref * zeta_t) / (mu_c_ref + A_ref * zeta_t)\n        S_b_ref = (mu_c_ref * A_ref * zeta_b) / (mu_c_ref + A_ref * zeta_b)\n        \n        # In a real scenario, we would use measured rigidities. Here, we generate them.\n        K_t_exp = (G + S_t_ref) * J\n        K_b_exp = (E + S_b_ref) * I\n\n        # Determine target stiffness augmentations from \"experimental\" data\n        S_t_target = K_t_exp / J - G\n        S_b_target = K_b_exp / I - E\n\n        # Apply the analytical solution to find mu_c and A\n        # Check for denominator becoming zero (though problem setup guarantees it won't)\n        if abs(zeta_t - zeta_b)  1e-15 or abs(S_t_target - S_b_target)  1e-15:\n             # This case should not be reached with the given problems\n             mu_c_fit, A_fit = np.nan, np.nan\n        else:\n            # Numerator for both A and mu_c\n            numerator = S_t_target * S_b_target * (zeta_t - zeta_b)\n            \n            # Denominator for A\n            denominator_A = (S_t_target - S_b_target) * zeta_t * zeta_b\n            A_fit = numerator / denominator_A if abs(denominator_A) > 0 else np.inf\n            \n            # Denominator for mu_c\n            denominator_mu_c = S_b_target * zeta_t - S_t_target * zeta_b\n            mu_c_fit = numerator / denominator_mu_c if abs(denominator_mu_c) > 0 else np.inf\n\n        results.append([mu_c_fit, A_fit])\n\n    # Format the final output string as specified\n    formatted_results = []\n    for res in results:\n        mu_c_str = f\"{res[0]:.2e}\"\n        A_str = f\"{res[1]:.2e}\"\n        formatted_results.append(f\"[{mu_c_str},{A_str}]\")\n        \n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n\n```", "id": "3544744"}]}