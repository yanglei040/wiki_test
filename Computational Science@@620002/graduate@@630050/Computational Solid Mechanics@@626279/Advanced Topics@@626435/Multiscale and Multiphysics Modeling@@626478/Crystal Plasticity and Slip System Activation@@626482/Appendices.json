{"hands_on_practices": [{"introduction": "At the heart of any crystal plasticity model is the constitutive \"flow rule,\" which dictates how much a crystal slips in response to stress. This first exercise provides hands-on practice in implementing the widely-used power-law relationship that connects the resolved shear stress on a slip system to its resulting slip rate. By coding this fundamental mechanism and identifying which systems are \"active,\" you will build the essential computational engine for predicting plastic deformation in crystalline materials [@problem_id:3556441].", "problem": "You are given a set of slip systems indexed by $\\alpha$ in the context of Crystal Plasticity (CP). Each slip system is characterized by a resolved shear stress $\\tau^\\alpha$ and a slip resistance (also called critical resolved shear stress) $g^\\alpha$, both with units of stress. The material is rate-dependent with a rate sensitivity parameter $m$ (dimensionless) and a reference slip rate $\\dot{\\gamma}_0$ (in $\\mathrm{s}^{-1}$). The mechanical dissipation is defined as $D = \\sum_\\alpha \\tau^\\alpha \\dot{\\gamma}^\\alpha$, and a convex dissipation potential is assumed to generate an associated flow rule. The goal is to compute the slip rates $\\dot{\\gamma}^\\alpha$ for each slip system based on this principle and then determine the active set using a thresholding algorithm. A slip system is considered active if its overstress ratio $r^\\alpha = \\left|\\tau^\\alpha\\right| / g^\\alpha$ is above a specified ratio threshold and its slip rate magnitude is above a prescribed tolerance.\n\nFundamental base for derivation and implementation:\n- The rate-dependent constitutive description is derived from the assumption of a convex pseudo-potential of dissipation that depends on the magnitude of the slip rates and on the slip resistances.\n- The associated flow rule is obtained by enforcing that the resolved shear stress is the subdifferential of the dissipation potential with respect to the slip rate, consistent with the second law of thermodynamics.\n\nYou must write a complete program that, for each test case specified below, computes:\n1. The slip rates $\\dot{\\gamma}^\\alpha$ in $\\mathrm{s}^{-1}$ for all slip systems.\n2. The active-set flags $A^\\alpha \\in \\{\\text{True}, \\text{False}\\}$ determined by the thresholding algorithm defined as follows:\n   - Compute the overstress ratio $r^\\alpha = \\left|\\tau^\\alpha\\right| / g^\\alpha$ (dimensionless).\n   - A slip system is active if both $r^\\alpha \\ge r_{\\mathrm{thr}}$ and $\\left|\\dot{\\gamma}^\\alpha\\right| \\ge \\dot{\\gamma}_{\\mathrm{tol}}$.\n\nYour program must produce a single line of output containing the results for all test cases as a comma-separated list enclosed in square brackets. Each test case’s result must be represented as a list containing two lists: the first is the list of slip rates in $\\mathrm{s}^{-1}$, and the second is the list of booleans for the active set. For example: $[\\,[\\,[\\dot{\\gamma}^1,\\dot{\\gamma}^2,\\ldots],\\,[A^1,A^2,\\ldots]\\,],\\ldots\\,]$.\n\nUse the following test suite. All stresses $\\tau^\\alpha$ and $g^\\alpha$ are to be interpreted in $\\mathrm{MPa}$, slip rates in $\\mathrm{s}^{-1}$, and angles are not used in this problem.\n\n- Test case $1$ (general case, mixed signs and a zero stress):\n  - $\\boldsymbol{\\tau} = [\\,120,\\,80,\\,-110,\\,20,\\,0,\\,95\\,]\\,\\mathrm{MPa}$,\n  - $\\boldsymbol{g} = [\\,100,\\,100,\\,100,\\,100,\\,100,\\,100\\,]\\,\\mathrm{MPa}$,\n  - $m = 0.05$,\n  - $\\dot{\\gamma}_0 = 10^{-3}\\,\\mathrm{s}^{-1}$,\n  - $r_{\\mathrm{thr}} = 0.98$,\n  - $\\dot{\\gamma}_{\\mathrm{tol}} = 10^{-6}\\,\\mathrm{s}^{-1}$.\n\n- Test case $2$ (boundary conditions including $\\left|\\tau^\\alpha\\right| = g^\\alpha$ and zero stress):\n  - $\\boldsymbol{\\tau} = [\\,100,\\,100,\\,-100,\\,50,\\,-50,\\,0\\,]\\,\\mathrm{MPa}$,\n  - $\\boldsymbol{g} = [\\,100,\\,120,\\,100,\\,60,\\,50,\\,80\\,]\\,\\mathrm{MPa}$,\n  - $m = 0.2$,\n  - $\\dot{\\gamma}_0 = 10^{-3}\\,\\mathrm{s}^{-1}$,\n  - $r_{\\mathrm{thr}} = 1.0$,\n  - $\\dot{\\gamma}_{\\mathrm{tol}} = 5\\times 10^{-6}\\,\\mathrm{s}^{-1}$.\n\n- Test case $3$ (low overstress ratios, moderate rate sensitivity):\n  - $\\boldsymbol{\\tau} = [\\,30,\\,-45,\\,70,\\,-10,\\,5,\\,15\\,]\\,\\mathrm{MPa}$,\n  - $\\boldsymbol{g} = [\\,150,\\,150,\\,200,\\,200,\\,180,\\,160\\,]\\,\\mathrm{MPa}$,\n  - $m = 0.5$,\n  - $\\dot{\\gamma}_0 = 10^{-2}\\,\\mathrm{s}^{-1}$,\n  - $r_{\\mathrm{thr}} = 0.9$,\n  - $\\dot{\\gamma}_{\\mathrm{tol}} = 10^{-4}\\,\\mathrm{s}^{-1}$.\n\n- Test case $4$ (near-zero stresses to probe numerical stability):\n  - $\\boldsymbol{\\tau} = [\\,0.1,\\,-0.2,\\,0.0,\\,0.05,\\,-0.05,\\,0.01\\,]\\,\\mathrm{MPa}$,\n  - $\\boldsymbol{g} = [\\,100,\\,100,\\,100,\\,120,\\,120,\\,150\\,]\\,\\mathrm{MPa}$,\n  - $m = 0.05$,\n  - $\\dot{\\gamma}_0 = 10^{-3}\\,\\mathrm{s}^{-1}$,\n  - $r_{\\mathrm{thr}} = 0.95$,\n  - $\\dot{\\gamma}_{\\mathrm{tol}} = 10^{-8}\\,\\mathrm{s}^{-1}$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element corresponds to one test case and is of the form $[\\,[\\dot{\\gamma}^1,\\dot{\\gamma}^2,\\ldots],\\,[A^1,A^2,\\ldots]\\,]$. All slip rates must be expressed in $\\mathrm{s}^{-1}$.", "solution": "The problem as stated is valid. It is scientifically grounded in the principles of continuum mechanics and materials science, specifically in the domain of rate-dependent crystal plasticity. The problem is well-posed, objective, and contains all necessary information to derive a unique and meaningful solution. The formulation is a standard one in the field, relying on a power-law relationship between resolved shear stress and slip rate, which is derivable from a convex dissipation potential.\n\nThe thermodynamic framework for crystal plasticity postulates the existence of a dissipation potential, $\\Psi$, which is a convex function of the slip rates $\\dot{\\gamma}^\\alpha$. The resolved shear stress $\\tau^\\alpha$ on each slip system $\\alpha$ is then derived from this potential through an associated flow rule, ensuring that the dissipation, $D = \\sum_\\alpha \\tau^\\alpha \\dot{\\gamma}^\\alpha$, is non-negative. This is expressed as:\n$$\n\\tau^\\alpha = \\frac{\\partial \\Psi}{\\partial \\dot{\\gamma}^\\alpha}\n$$\nA commonly used form for the dissipation potential, which gives rise to the specified power-law viscoplasticity model, is:\n$$\n\\Psi(\\{\\dot{\\gamma}^\\beta\\}; \\{g^\\beta\\}) = \\sum_{\\beta} \\frac{g^\\beta \\dot{\\gamma}_0}{m+1} \\left( \\frac{|\\dot{\\gamma}^\\beta|}{\\dot{\\gamma}_0} \\right)^{m+1}\n$$\nwhere $g^\\beta$ is the slip resistance of system $\\beta$, $\\dot{\\gamma}_0$ is a reference slip rate, and $m$ is the rate sensitivity parameter. All these quantities are given in the problem statement.\n\nApplying the associated flow rule, we differentiate the potential $\\Psi$ with respect to a specific slip rate $\\dot{\\gamma}^\\alpha$:\n$$\n\\tau^\\alpha = \\frac{\\partial}{\\partial \\dot{\\gamma}^\\alpha} \\left[ \\sum_{\\beta} \\frac{g^\\beta \\dot{\\gamma}_0}{m+1} \\left( \\frac{|\\dot{\\gamma}^\\beta|}{\\dot{\\gamma}_0} \\right)^{m+1} \\right]\n$$\nSince the slip systems are uncoupled in the potential, the derivatives for $\\beta \\neq \\alpha$ are zero. We are left with:\n$$\n\\tau^\\alpha = \\frac{g^\\alpha \\dot{\\gamma}_0}{m+1} \\frac{\\partial}{\\partial \\dot{\\gamma}^\\alpha} \\left( \\frac{|\\dot{\\gamma}^\\alpha|}{\\dot{\\gamma}_0} \\right)^{m+1}\n$$\nUsing the chain rule, and noting that $\\frac{d|x|}{dx} = \\mathrm{sgn}(x)$, we obtain:\n$$\n\\tau^\\alpha = \\frac{g^\\alpha \\dot{\\gamma}_0}{m+1} (m+1) \\left( \\frac{|\\dot{\\gamma}^\\alpha|}{\\dot{\\gamma}_0} \\right)^{m} \\frac{1}{\\dot{\\gamma}_0} \\mathrm{sgn}(\\dot{\\gamma}^\\alpha)\n$$\nSimplifying this expression yields the relationship between the resolved shear stress and the slip rate:\n$$\n\\tau^\\alpha = g^\\alpha \\left( \\frac{|\\dot{\\gamma}^\\alpha|}{\\dot{\\gamma}_0} \\right)^m \\mathrm{sgn}(\\dot{\\gamma}^\\alpha)\n$$\nTo ensure non-negative dissipation ($\\tau^\\alpha \\dot{\\gamma}^\\alpha \\ge 0$), the signs of $\\tau^\\alpha$ and $\\dot{\\gamma}^\\alpha$ must be the same, so $\\mathrm{sgn}(\\tau^\\alpha) = \\mathrm{sgn}(\\dot{\\gamma}^\\alpha)$. Taking the absolute value of both sides:\n$$\n|\\tau^\\alpha| = g^\\alpha \\left( \\frac{|\\dot{\\gamma}^\\alpha|}{\\dot{\\gamma}_0} \\right)^m\n$$\nWe can now solve for the magnitude of the slip rate $|\\dot{\\gamma}^\\alpha|$:\n$$\n\\left( \\frac{|\\tau^\\alpha|}{g^\\alpha} \\right) = \\left( \\frac{|\\dot{\\gamma}^\\alpha|}{\\dot{\\gamma}_0} \\right)^m \\implies \\left( \\frac{|\\tau^\\alpha|}{g^\\alpha} \\right)^{1/m} = \\frac{|\\dot{\\gamma}^\\alpha|}{\\dot{\\gamma}_0} \\implies |\\dot{\\gamma}^\\alpha| = \\dot{\\gamma}_0 \\left( \\frac{|\\tau^\\alpha|}{g^\\alpha} \\right)^{1/m}\n$$\nReintroducing the sign, we arrive at the final constitutive equation for the slip rate on system $\\alpha$:\n$$\n\\dot{\\gamma}^\\alpha = \\dot{\\gamma}_0 \\left( \\frac{|\\tau^\\alpha|}{g^\\alpha} \\right)^{1/m} \\mathrm{sgn}(\\tau^\\alpha)\n$$\nThis equation provides a direct method to compute the slip rate $\\dot{\\gamma}^\\alpha$ for each slip system given the resolved shear stress $\\tau^\\alpha$, the current slip resistance $g^\\alpha$, the reference slip rate $\\dot{\\gamma}_0$, and the rate sensitivity exponent $m$. It is important to note that if $\\tau^\\alpha = 0$, then $\\dot{\\gamma}^\\alpha = 0$, which is physically and mathematically consistent. All provided slip resistances $g^\\alpha$ are strictly positive, preventing any division by zero.\n\nThe second part of the problem requires the determination of the active set of slip systems. A slip system $\\alpha$ is defined as active if two conditions are met simultaneously:\n1.  The overstress ratio, $r^\\alpha = \\frac{|\\tau^\\alpha|}{g^\\alpha}$, must be greater than or equal to a specified threshold $r_{\\mathrm{thr}}$.\n2.  The magnitude of the slip rate, $|\\dot{\\gamma}^\\alpha|$, must be greater than or equal to a specified tolerance $\\dot{\\gamma}_{\\mathrm{tol}}$.\n\nTherefore, the activity flag $A^\\alpha$ for each system is determined by the logical expression:\n$$\nA^\\alpha = (r^\\alpha \\ge r_{\\mathrm{thr}}) \\land (|\\dot{\\gamma}^\\alpha| \\ge \\dot{\\gamma}_{\\mathrm{tol}})\n$$\nwhere $\\land$ represents the logical AND operator.\n\nThe computational procedure for each test case is as follows:\n1.  For each slip system $\\alpha$ from $1$ to $N$, where $N$ is the number of systems in the given test case:\n    a.  Obtain the values of $\\tau^\\alpha$, $g^\\alpha$, $m$, and $\\dot{\\gamma}_0$.\n    b.  Compute the slip rate $\\dot{\\gamma}^\\alpha$ using the derived power-law equation.\n    c.  Compute the overstress ratio $r^\\alpha = |\\tau^\\alpha| / g^\\alpha$.\n    d.  Evaluate the activity flag $A^\\alpha$ by checking if both $r^\\alpha \\ge r_{\\mathrm{thr}}$ and $|\\dot{\\gamma}^\\alpha| \\ge \\dot{\\gamma}_{\\mathrm{tol}}$ are `True`.\n2.  Collect the computed slip rates into a list $[\\dot{\\gamma}^1, \\dot{\\gamma}^2, \\ldots, \\dot{\\gamma}^N]$.\n3.  Collect the activity flags into a list $[A^1, A^2, \\ldots, A^N]$.\n4.  Combine these two lists into the final structure for the test case: $[[\\dot{\\gamma}^1, \\ldots], [A^1, \\ldots]]$.\nThis procedure is repeated for all specified test cases.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes slip rates and active sets for crystal plasticity problems.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (tau, g, m, gamma0_dot, r_thr, gamma_tol_dot)\n    # Stresses are in MPa, slip rates in s^-1.\n    test_cases = [\n        (\n            np.array([120.0, 80.0, -110.0, 20.0, 0.0, 95.0]),  # tau (MPa)\n            np.array([100.0, 100.0, 100.0, 100.0, 100.0, 100.0]),  # g (MPa)\n            0.05,  # m\n            1e-3,  # gamma0_dot (s^-1)\n            0.98,  # r_thr\n            1e-6   # gamma_tol_dot (s^-1)\n        ),\n        (\n            np.array([100.0, 100.0, -100.0, 50.0, -50.0, 0.0]),\n            np.array([100.0, 120.0, 100.0, 60.0, 50.0, 80.0]),\n            0.2,\n            1e-3,\n            1.0,\n            5e-6\n        ),\n        (\n            np.array([30.0, -45.0, 70.0, -10.0, 5.0, 15.0]),\n            np.array([150.0, 150.0, 200.0, 200.0, 180.0, 160.0]),\n            0.5,\n            1e-2,\n            0.9,\n            1e-4\n        ),\n        (\n            np.array([0.1, -0.2, 0.0, 0.05, -0.05, 0.01]),\n            np.array([100.0, 100.0, 100.0, 120.0, 120.0, 150.0]),\n            0.05,\n            1e-3,\n            0.95,\n            1e-8\n        )\n    ]\n\n    results = []\n    for case in test_cases:\n        tau, g, m, gamma0_dot, r_thr, gamma_tol_dot = case\n\n        # Ensure g is not zero to avoid division by zero, though not present in test data.\n        # Create a mask for non-zero g for safe division.\n        g_is_zero = (g == 0)\n        overstress_ratio = np.full_like(tau, 0.0)\n        \n        # Calculate overstress ratio only where g is not zero\n        # Where g is zero, overstress is infinite if tau is non-zero, handled implicitly\n        # since gamma_dot would be infinite. In this problem, all g > 0.\n        overstress_ratio = np.abs(tau) / g\n\n        # Calculate slip rates using the power-law constitutive equation.\n        # np.power(0, positive_number) is 0, correctly handling tau=0.\n        # np.sign(0) is 0, also handled correctly.\n        exponent = 1.0 / m\n        gamma_dot = gamma0_dot * np.power(overstress_ratio, exponent) * np.sign(tau)\n\n        # Determine the active set based on the two conditions.\n        # 1. Overstress ratio threshold\n        # 2. Slip rate magnitude tolerance\n        active_set_flags = (overstress_ratio >= r_thr)  (np.abs(gamma_dot) >= gamma_tol_dot)\n\n        # Format results for the current case as required\n        gamma_dot_list = gamma_dot.tolist()\n        active_set_list = active_set_flags.tolist()\n        \n        results.append([gamma_dot_list, active_set_list])\n\n    # Convert the list of results to the required string format.\n    # The default str() representation for lists includes spaces after commas,\n    # which is consistent with the visual spacing in the problem's LaTeX example.\n    result_strings = [str(r) for r in results]\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(result_strings)}]\")\n\nsolve()\n\n```", "id": "3556441"}, {"introduction": "As a crystal deforms, its internal lattice structure rotates, changing the orientation of its slip systems relative to the applied stress. This practice tackles the critical task of accurately tracking this lattice rotation, comparing a simple additive approximation with the kinematically exact multiplicative decomposition. By benchmarking these two approaches, you will directly observe the limitations of small-strain assumptions and appreciate the necessity of a rigorous finite-strain framework for problems involving large rotations [@problem_id:3556422].", "problem": "You are to implement a benchmark that compares two kinematic descriptions of lattice rotation used in small-strain crystal plasticity: an additive small-strain approximation and a multiplicative polar-decomposition-based rotation. The goal is to quantify how these two descriptions differ in predicting slip system activation when the imposed deformation gradients involve large spatial rotations and shears.\n\nStart from the following fundamental bases:\n- The deformation gradient is denoted by $\\boldsymbol{F} \\in \\mathbb{R}^{3 \\times 3}$, with $\\boldsymbol{H} = \\boldsymbol{F} - \\boldsymbol{I}$ the displacement gradient, where $\\boldsymbol{I}$ is the identity.\n- The small-strain tensor is $\\boldsymbol{\\varepsilon} = \\tfrac{1}{2}(\\boldsymbol{H} + \\boldsymbol{H}^\\top)$.\n- The Cauchy stress for an isotropic linear elastic material with Young’s modulus $E$ and Poisson’s ratio $\\nu$ is $\\boldsymbol{\\sigma} = \\lambda \\, \\mathrm{tr}(\\boldsymbol{\\varepsilon}) \\, \\boldsymbol{I} + 2 \\mu \\, \\boldsymbol{\\varepsilon}$ with Lamé parameters $\\mu = \\dfrac{E}{2(1+\\nu)}$ and $\\lambda = \\dfrac{\\nu E}{(1+\\nu)(1-2\\nu)}$.\n- The multiplicative rotation is defined by the polar decomposition as $\\boldsymbol{F} = \\boldsymbol{R} \\, \\boldsymbol{U}$, where $\\boldsymbol{R}$ is a proper orthogonal rotation and $\\boldsymbol{U}$ is the right stretch tensor. Compute $\\boldsymbol{R}$ via $\\boldsymbol{R} = \\boldsymbol{F} \\boldsymbol{U}^{-1}$ with $\\boldsymbol{U} = (\\boldsymbol{F}^\\top \\boldsymbol{F})^{1/2}$.\n- The additive small-strain lattice rotation approximation uses the skew-symmetric part of $\\boldsymbol{H}$, namely $\\boldsymbol{W} = \\tfrac{1}{2}(\\boldsymbol{H} - \\boldsymbol{H}^\\top)$, and approximates the lattice rotation update as $\\boldsymbol{R}_\\mathrm{add} \\approx \\boldsymbol{I} + \\boldsymbol{W}$.\n- For a slip system $\\alpha$ with reference slip direction $\\boldsymbol{s}_0^{(\\alpha)}$ and slip plane normal $\\boldsymbol{n}_0^{(\\alpha)}$ (both unit vectors and $\\boldsymbol{s}_0^{(\\alpha)} \\cdot \\boldsymbol{n}_0^{(\\alpha)} = 0$), the current directions are computed as follows:\n  - Under the multiplicative rotation model: $\\boldsymbol{s}_\\mathrm{mul}^{(\\alpha)} = \\boldsymbol{R} \\, \\boldsymbol{s}_0^{(\\alpha)}$, $\\boldsymbol{n}_\\mathrm{mul}^{(\\alpha)} = \\boldsymbol{R} \\, \\boldsymbol{n}_0^{(\\alpha)}$.\n  - Under the additive model: $\\boldsymbol{s}_\\mathrm{add}^{(\\alpha)} = \\dfrac{(\\boldsymbol{I} + \\boldsymbol{W}) \\boldsymbol{s}_0^{(\\alpha)}}{\\|(\\boldsymbol{I} + \\boldsymbol{W}) \\boldsymbol{s}_0^{(\\alpha)}\\|}$, $\\boldsymbol{n}_\\mathrm{add}^{(\\alpha)} = \\dfrac{(\\boldsymbol{I} + \\boldsymbol{W}) \\boldsymbol{n}_0^{(\\alpha)}}{\\|(\\boldsymbol{I} + \\boldsymbol{W}) \\boldsymbol{n}_0^{(\\alpha)}\\|}$.\n- The resolved shear stress on slip system $\\alpha$ is $\\tau^{(\\alpha)} = \\boldsymbol{s}^{(\\alpha)} \\cdot \\left( \\boldsymbol{\\sigma} \\, \\boldsymbol{n}^{(\\alpha)} \\right)$, which is equivalent to $\\tau^{(\\alpha)} = \\boldsymbol{\\sigma} : \\tfrac{1}{2}\\left(\\boldsymbol{s}^{(\\alpha)} \\otimes \\boldsymbol{n}^{(\\alpha)} + \\boldsymbol{n}^{(\\alpha)} \\otimes \\boldsymbol{s}^{(\\alpha)}\\right)$ for symmetric $\\boldsymbol{\\sigma}$.\n- The activation rule is given by a critical resolved shear stress $\\tau_c$: a slip system is considered active if $\\left|\\tau^{(\\alpha)}\\right| \\ge \\tau_c$.\n\nYou must implement the following:\n- Use a face-centered cubic lattice with the canonical $\\{111\\}\\langle 110 \\rangle$ family of slip systems in $\\mathbb{R}^3$. Construct the set of $12$ distinct slip systems $(\\boldsymbol{n}_0^{(\\alpha)}, \\boldsymbol{s}_0^{(\\alpha)})$ with unit vectors and $\\boldsymbol{n}_0^{(\\alpha)} \\cdot \\boldsymbol{s}_0^{(\\alpha)} = 0$, excluding pairs that differ only by sign (i.e., treat $\\boldsymbol{s}$ and $-\\boldsymbol{s}$ as the same slip direction for the purpose of counting $12$ systems).\n- For each test case, compute the Cauchy stress $\\boldsymbol{\\sigma}$ from $\\boldsymbol{\\varepsilon}(\\boldsymbol{F})$ using the same isotropic linear elastic law for both models.\n- For the multiplicative model, use $\\boldsymbol{R}$ from the polar decomposition. For the additive model, use $\\boldsymbol{R}_\\mathrm{add} = \\boldsymbol{I} + \\boldsymbol{W}$ as an instantaneous update, with $\\boldsymbol{s}_\\mathrm{add}^{(\\alpha)}$ and $\\boldsymbol{n}_\\mathrm{add}^{(\\alpha)}$ normalized to unit length as written above (do not orthogonalize or project $\\boldsymbol{R}_\\mathrm{add}$ onto $\\mathrm{SO}(3)$).\n- For each model, determine the set of active slip systems at the given state $\\boldsymbol{F}$, using the same $\\tau_c$.\n- Quantify the difference in activation prediction by the mismatch fraction defined as the number of slip systems with differing activation states divided by $12$.\n\nAll quantities are nondimensional for this benchmark. Angles in the test suite are specified in degrees; use radians internally for trigonometric functions. The program must compute the mismatch fraction for each test case as a float rounded to six decimal places.\n\nTest suite:\n- Material parameters: $E = 1.0$, $\\nu = 0.30$, and $\\tau_c = 0.08$.\n- Define a rotation about the $z$-axis by an angle $\\theta$ and a simple shear characterized by $\\gamma$ through the mapping $\\boldsymbol{F}(\\theta, \\gamma) = \\boldsymbol{R}_z(\\theta) \\left(\\boldsymbol{I} + \\boldsymbol{K}(\\gamma)\\right)$ with\n  $$\n  \\boldsymbol{R}_z(\\theta) =\n  \\begin{bmatrix}\n  \\cos\\theta  -\\sin\\theta  0 \\\\\n  \\sin\\theta  \\cos\\theta  0 \\\\\n  0  0  1\n  \\end{bmatrix}\n  $$\n  and\n  $$\n  \\boldsymbol{K}(\\gamma) =\n  \\begin{bmatrix}\n  0  \\gamma  0 \\\\\n  0  0  0 \\\\\n  0  0  0\n  \\end{bmatrix}.\n  $$\n- Four test cases $(\\theta,\\gamma)$ with $\\theta$ in degrees:\n  $1.$ $(\\theta,\\gamma) = (5.0, 0.01)$,\n  $2.$ $(\\theta,\\gamma) = (25.0, 0.10)$,\n  $3.$ $(\\theta,\\gamma) = (60.0, 0.30)$,\n  $4.$ $(\\theta,\\gamma) = (90.0, 0.00)$.\n\nYour program should produce a single line of output containing the four mismatch fractions, in order of the test cases, as a comma-separated list enclosed in square brackets, with each float rounded to six decimal places (e.g., $\"[0.000000,0.083333,0.250000,0.500000]\"$). No other output is permitted.", "solution": "This solution provides a computational benchmark to compare two kinematic descriptions of lattice rotation in crystal plasticity: a rigorous multiplicative decomposition model and a simplified additive small-strain approximation. The comparison is performed by evaluating the difference in predicted slip system activation for a face-centered cubic (FCC) crystal subjected to various deformation gradients involving combined shear and large rotations.\n\nFirst, we establish the fundamental continuum mechanics framework. The deformation of a material point is described by the deformation gradient tensor $\\boldsymbol{F} \\in \\mathbb{R}^{3 \\times 3}$. The displacement gradient is $\\boldsymbol{H} = \\boldsymbol{F} - \\boldsymbol{I}$, where $\\boldsymbol{I}$ is the second-order identity tensor. For small deformations, the infinitesimal strain tensor, or small-strain tensor, is defined as the symmetric part of the displacement gradient: $\\boldsymbol{\\varepsilon} = \\tfrac{1}{2}(\\boldsymbol{H} + \\boldsymbol{H}^\\top)$. The material response is assumed to be isotropic linear elastic, governed by the Cauchy stress relation $\\boldsymbol{\\sigma} = \\lambda \\, \\mathrm{tr}(\\boldsymbol{\\varepsilon}) \\, \\boldsymbol{I} + 2 \\mu \\, \\boldsymbol{\\varepsilon}$. The Lamé parameters $\\lambda$ and $\\mu$ are determined from Young’s modulus $E$ and Poisson’s ratio $\\nu$ via $\\mu = \\dfrac{E}{2(1+\\nu)}$ and $\\lambda = \\dfrac{\\nu E}{(1+\\nu)(1-2\\nu)}$. For this problem, $E=1.0$ and $\\nu=0.30$. This stress tensor $\\boldsymbol{\\sigma}$ is computed once from $\\boldsymbol{F}$ and used for both models, as the problem specifies comparing only the kinematic aspects of lattice rotation.\n\nThe core of the problem lies in the treatment of lattice rotation.\n\nThe multiplicative decomposition model provides a kinematically exact description of rotation. It is based on the polar decomposition of the deformation gradient, $\\boldsymbol{F} = \\boldsymbol{R} \\, \\boldsymbol{U}$. Here, $\\boldsymbol{R}$ is a proper orthogonal rotation tensor that represents the rigid body rotation of the material element, and $\\boldsymbol{U}$ is the symmetric positive-definite right stretch tensor representing the pure deformation part. $\\boldsymbol{R}$ is computed as $\\boldsymbol{R} = \\boldsymbol{F} \\boldsymbol{U}^{-1}$, where $\\boldsymbol{U}$ is the principal square root of the right Cauchy-Green deformation tensor, $\\boldsymbol{U} = (\\boldsymbol{F}^\\top \\boldsymbol{F})^{1/2}$. Under this model, the reference slip direction $\\boldsymbol{s}_0^{(\\alpha)}$ and slip plane normal $\\boldsymbol{n}_0^{(\\alpha)}$ of a slip system $\\alpha$ are rotated into the current configuration by $\\boldsymbol{R}$: $\\boldsymbol{s}_\\mathrm{mul}^{(\\alpha)} = \\boldsymbol{R} \\, \\boldsymbol{s}_0^{(\\alpha)}$ and $\\boldsymbol{n}_\\mathrm{mul}^{(\\alpha)} = \\boldsymbol{R} \\, \\boldsymbol{n}_0^{(\\alpha)}$.\n\nThe additive small-strain approximation model derives from the additive decomposition of the displacement gradient into its symmetric and skew-symmetric parts: $\\boldsymbol{H} = \\boldsymbol{\\varepsilon} + \\boldsymbol{W}$, where $\\boldsymbol{W} = \\tfrac{1}{2}(\\boldsymbol{H} - \\boldsymbol{H}^\\top)$ is the infinitesimal rotation tensor. This model approximates the finite rotation $\\boldsymbol{R}$ with the expression $\\boldsymbol{R}_\\mathrm{add} \\approx \\boldsymbol{I} + \\boldsymbol{W}$. This approximation is only valid for infinitesimally small rotations. For this benchmark, the current slip vectors are computed by applying this approximate transformation and then normalizing to maintain their unit length: $\\boldsymbol{s}_\\mathrm{add}^{(\\alpha)} = \\dfrac{(\\boldsymbol{I} + \\boldsymbol{W}) \\boldsymbol{s}_0^{(\\alpha)}}{\\|(\\boldsymbol{I} + \\boldsymbol{W}) \\boldsymbol{s}_0^{(\\alpha)}\\|}$ and $\\boldsymbol{n}_\\mathrm{add}^{(\\alpha)} = \\dfrac{(\\boldsymbol{I} + \\boldsymbol{W}) \\boldsymbol{n}_0^{(\\alpha)}}{\\|(\\boldsymbol{I} + \\boldsymbol{W}) \\boldsymbol{n}_0^{(\\alpha)}\\|}$.\n \nFor both models, the resolved shear stress on a slip system $\\alpha$ is calculated as $\\tau^{(\\alpha)} = \\boldsymbol{s}^{(\\alpha)} \\cdot \\left( \\boldsymbol{\\sigma} \\, \\boldsymbol{n}^{(\\alpha)} \\right)$, using the respectively computed current vectors $(\\boldsymbol{s}, \\boldsymbol{n})$. A slip system is deemed active if the absolute value of its resolved shear stress meets or exceeds a critical value, $|\\tau^{(\\alpha)}| \\ge \\tau_c$. For this problem, $\\tau_c = 0.08$.\n\nThe implementation starts by constructing the set of $12$ canonical slip systems for an FCC lattice. These are the $\\{111\\}\\langle 110 \\rangle$ systems. We programmatically generate the $12$ distinct slip systems $(\\boldsymbol{n}_0^{(\\alpha)}, \\boldsymbol{s}_0^{(\\alpha)})$ by identifying pairs of slip plane normals and slip directions that are orthogonal. The set of plane normals is derived from permutations of $(1,1,1)$ and the set of slip directions from permutations of $(1,1,0)$, ensuring normalized unit vectors and adherence to the crystallographic families.\n\nFor each test case defined by a rotation angle $\\theta$ and a shear magnitude $\\gamma$, the deformation gradient is constructed as $\\boldsymbol{F}(\\theta, \\gamma) = \\boldsymbol{R}_z(\\theta) \\left(\\boldsymbol{I} + \\boldsymbol{K}(\\gamma)\\right)$, where $\\boldsymbol{R}_z(\\theta)$ is a rotation matrix about the $z$-axis and $\\boldsymbol{K}(\\gamma)$ is a simple shear tensor.\n\nThe algorithm proceeds as follows:\n$1.$ For a given $(\\theta, \\gamma)$, compute $\\boldsymbol{F}$, then $\\boldsymbol{H}$, $\\boldsymbol{\\varepsilon}$, and finally the Cauchy stress $\\boldsymbol{\\sigma}$.\n$2.$ For the multiplicative model, compute the rotation tensor $\\boldsymbol{R}$ from the polar decomposition of $\\boldsymbol{F}$. Rotate each of the $12$ reference slip systems, $(\\boldsymbol{n}_0^{(\\alpha)}, \\boldsymbol{s}_0^{(\\alpha)})$, using $\\boldsymbol{R}$ to get $(\\boldsymbol{s}_\\mathrm{mul}^{(\\alpha)}, \\boldsymbol{n}_\\mathrm{mul}^{(\\alpha)})$. Calculate the resolved shear stress $\\tau_\\mathrm{mul}^{(\\alpha)}$ for each system and determine its activation status by comparing $|\\tau_\\mathrm{mul}^{(\\alpha)}|$ with $\\tau_c=0.08$.\n$3.$ For the additive model, compute the skew-symmetric tensor $\\boldsymbol{W}$ from $\\boldsymbol{H}$. The transformation operator is $\\boldsymbol{T}_\\mathrm{add} = \\boldsymbol{I} + \\boldsymbol{W}$. Apply this operator to each reference slip system, $(\\boldsymbol{n}_0^{(\\alpha)}, \\boldsymbol{s}_0^{(\\alpha)})$, and normalize the resulting vectors to obtain $(\\boldsymbol{s}_\\mathrm{add}^{(\\alpha)}, \\boldsymbol{n}_\\mathrm{add}^{(\\alpha)})$. Calculate the resolved shear stress $\\tau_\\mathrm{add}^{(\\alpha)}$ and determine activation status against the same $\\tau_c$.\n$4.$ Compare the activation states (active/inactive) predicted by the two models for each of the $12$ slip systems. The mismatch fraction is the number of systems with differing activation states divided by $12$.\n$5.$ This process is repeated for all four test cases: $(\\theta, \\gamma) = (5.0^\\circ, 0.01)$, $(25.0^\\circ, 0.10)$, $(60.0^\\circ, 0.30)$, and $(90.0^\\circ, 0.00)$. The resulting mismatch fractions are collected and formatted.\n\nThis benchmark quantifies the error introduced by the additive small-strain rotation approximation, which is expected to increase as the magnitude of rotation in the deformation gradient becomes large. The test case with $\\theta=90.0^\\circ$ represents a pure, finite rotation where the small-strain approximation is known to be particularly inaccurate.", "answer": "```python\nimport numpy as np\nfrom scipy.linalg import sqrtm\n\ndef solve():\n    \"\"\"\n    Implements a benchmark to compare multiplicative and additive kinematic\n    descriptions of lattice rotation in small-strain crystal plasticity.\n    \"\"\"\n\n    # Material parameters\n    E = 1.0\n    nu = 0.30\n    tau_c = 0.08\n\n    # Lamé parameters\n    mu = E / (2 * (1 + nu))\n    lambda_lame = (nu * E) / ((1 + nu) * (1 - 2 * nu))\n\n    # Test suite: (theta in degrees, gamma)\n    test_cases = [\n        (5.0, 0.01),\n        (25.0, 0.10),\n        (60.0, 0.30),\n        (90.0, 0.00),\n    ]\n\n    def generate_fcc_slip_systems():\n        \"\"\"\n        Generates the 12 canonical {111}110 slip systems for an FCC lattice.\n        \"\"\"\n        systems = []\n        \n        plane_normals_base = [\n            [1, 1, 1],\n            [1, -1, 1],\n            [-1, 1, 1],\n            [1, 1, -1]\n        ]\n        slip_dirs_base = [\n            [1, -1, 0], [1, 0, -1], [0, 1, -1],\n            [1, 1, 0], [1, 0, 1], [0, 1, 1]\n        ]\n\n        for n_vec in plane_normals_base:\n            for s_vec in slip_dirs_base:\n                if np.dot(n_vec, s_vec) == 0:\n                    n = np.array(n_vec, dtype=float)\n                    s = np.array(s_vec, dtype=float)\n                    n /= np.linalg.norm(n)\n                    s /= np.linalg.norm(s)\n                    systems.append((n, s))\n        return systems\n\n    slip_systems = generate_fcc_slip_systems()\n    num_slip_systems = len(slip_systems)\n    \n    results = []\n\n    for theta_deg, gamma in test_cases:\n        # 1. Construct deformation gradient F\n        theta_rad = np.deg2rad(theta_deg)\n        c, s = np.cos(theta_rad), np.sin(theta_rad)\n        \n        R_z = np.array([\n            [c, -s, 0],\n            [s,  c, 0],\n            [0,  0, 1]\n        ])\n        \n        K = np.array([\n            [0, gamma, 0],\n            [0, 0,     0],\n            [0, 0,     0]\n        ])\n        \n        I = np.identity(3)\n        F = R_z @ (I + K)\n        \n        # 2. Common calculations: H, epsilon, sigma\n        H = F - I\n        epsilon = 0.5 * (H + H.T)\n        sigma = lambda_lame * np.trace(epsilon) * I + 2 * mu * epsilon\n\n        # 3. Multiplicative model\n        F_T_F = F.T @ F\n        U = sqrtm(F_T_F)\n        U_inv = np.linalg.inv(U)\n        R_mul = F @ U_inv\n        \n        active_mul = []\n        for n0, s0 in slip_systems:\n            n_mul = R_mul @ n0\n            s_mul = R_mul @ s0\n            tau_mul = s_mul.T @ sigma @ n_mul\n            active_mul.append(np.abs(tau_mul) >= tau_c)\n\n        # 4. Additive model\n        W = 0.5 * (H - H.T)\n        T_add = I + W\n        \n        active_add = []\n        for n0, s0 in slip_systems:\n            n_prime = T_add @ n0\n            s_prime = T_add @ s0\n            \n            n_add = n_prime / np.linalg.norm(n_prime)\n            s_add = s_prime / np.linalg.norm(s_prime)\n            \n            tau_add = s_add.T @ sigma @ n_add\n            active_add.append(np.abs(tau_add) >= tau_c)\n            \n        # 5. Compare and calculate mismatch fraction\n        mismatch_count = 0\n        for i in range(num_slip_systems):\n            if active_mul[i] != active_add[i]:\n                mismatch_count += 1\n        \n        mismatch_fraction = mismatch_count / num_slip_systems\n        results.append(mismatch_fraction)\n\n    # Format the final output string\n    formatted_results = [f\"{r:.6f}\" for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "3556422"}, {"introduction": "This capstone practice integrates the concepts of slip and kinematics into the complete finite-strain framework built upon the multiplicative decomposition of deformation, $\\boldsymbol{F} = \\boldsymbol{F}^e \\boldsymbol{F}^p$. You will implement the essential push-forward and pull-back operations that correctly map slip system vectors across different kinematic configurations. The key objective is to numerically verify the principle of material frame-indifference, proving that the calculated resolved shear stress—the driving force for slip—is physically consistent and independent of the observer [@problem_id:3556393].", "problem": "Implement a program that, for finite-strain crystal plasticity kinematics, performs the push-forward and pull-back of slip systems between the reference, intermediate, and current configurations, and verifies the frame-indifference (objectivity) of a resolved shear stress activation criterion under superposed rigid-body rotations. All quantities are nondimensional. Use only the mathematical bases enumerated below and do not assume any shortcut formulas beyond them.\n\nBase definitions and facts:\n- Let the total deformation gradient be $F \\in \\mathbb{R}^{3 \\times 3}$ with the multiplicative split $F = F^e F^p$, where $F^e$ is the elastic part and $F^p$ is the plastic part.\n- Vectors push-forward by $A$ as $v \\mapsto A v$. Covectors (such as plane normals) push-forward by $A^{-T}$ as $n \\mapsto A^{-T} n$. These rules preserve duality in the sense that $n \\cdot v$ is invariant under the appropriate paired transformations.\n- The right polar decomposition of $F^e$ exists and is given by $F^e = R^e U^e$, where $R^e \\in \\mathrm{SO}(3)$ is a proper orthogonal rotation and $U^e$ is a symmetric, positive-definite stretch tensor. The rotation is $R^e = F^e (U^e)^{-1}$ and $U^e$ is the unique positive-definite square root of $C^e = (F^e)^T F^e$.\n- For a compressible Neo-Hookean elastic response, the Kirchhoff stress is $\\tau = \\mu (B^e - I) + \\kappa \\ln J \\, I$, where $B^e = F^e (F^e)^T$, $J = \\det(F^e)$, $I$ is the identity, $\\mu$ is the shear modulus, and $\\kappa$ is the bulk modulus. The Cauchy stress is $\\sigma = \\tau / J$.\n- The Schmid tensor for a slip system with slip direction $\\mathbf{s}$ and slip plane normal $\\mathbf{n}$ in the current configuration is $\\mathbf{P} = \\tfrac{1}{2} (\\mathbf{s} \\otimes \\mathbf{n} + \\mathbf{n} \\otimes \\mathbf{s})$. For a symmetric Cauchy stress $\\boldsymbol{\\sigma}$, the resolved shear stress equals $\\tau_{\\mathrm{rss}} = \\boldsymbol{\\sigma} : \\mathbf{P} = \\mathbf{s} \\cdot (\\boldsymbol{\\sigma} \\mathbf{n})$.\n\nTasks to implement:\n1. Push-forward mapping of a slip system $(\\mathbf{s}_0, \\mathbf{n}_0)$ from the reference configuration to the intermediate configuration via $F^p$, treating $\\mathbf{s}_0$ as a vector and $\\mathbf{n}_0$ as a covector, then normalize both, and then rotate both by $R^e$ to the current configuration. Explicitly, compute the intermediate slip direction and normal as the normalized images under $F^p$ and $(F^p)^{-T}$, respectively, and then compute the current slip direction and normal by rotation with $R^e$. Ensure that orthogonality $\\mathbf{s} \\cdot \\mathbf{n} = 0$ and unit norms are enforced at the current configuration.\n2. Pull-back mapping of a slip system $(\\mathbf{s}, \\mathbf{n})$ from the current configuration to the reference by undoing the rotation $R^e$ and then using $F^p$ inverses appropriately (vector pulled-back by $(F^p)^{-1}$ and covector pulled-back by $(F^p)^T$), normalizing at each stage. Verify that the round-trip from reference to current and back recovers the original directions up to a possible sign, which should not affect the physical slip system.\n3. Using the compressible Neo-Hookean model, compute the Cauchy stress $\\boldsymbol{\\sigma}$ from $F^e$ with given $(\\mu, \\kappa)$ and then compute the resolved shear stress $\\tau_{\\mathrm{rss}}$ for each slip system in the current configuration.\n4. Verify objectivity: Under a superposed rigid-body rotation $Q \\in \\mathrm{SO}(3)$ applied to the current configuration that changes $F^e$ to $F^{e\\star} = Q F^e$, recompute the current slip system and the Cauchy stress and evaluate the resolved shear stress $\\tau_{\\mathrm{rss}}^\\star$. Demonstrate numerically that $\\tau_{\\mathrm{rss}}^\\star = \\tau_{\\mathrm{rss}}$ within a specified tolerance.\n\nTest suite and parameters:\n- Use the following three test cases. For each case, use the given $F^p$, $F^e$, reference slip system $(\\mathbf{s}_0, \\mathbf{n}_0)$, rigid rotation $Q$, and elastic parameters $(\\mu, \\kappa)$. All matrices and vectors are to be used exactly as specified.\n\nCase A:\n- $$F^p = \\begin{bmatrix} 1  0.3  0 \\\\ 0  1  0.2 \\\\ 0  0  1 \\end{bmatrix}, \\quad F^e = \\begin{bmatrix} 1.1  0.2  0 \\\\ 0  0.9  0.1 \\\\ 0  0  1.05 \\end{bmatrix}$$\n- $$(\\mathbf{s}_0, \\mathbf{n}_0) = \\left( \\begin{bmatrix} 1 \\\\ 0 \\\\ 0 \\end{bmatrix}, \\begin{bmatrix} 0 \\\\ 1 \\\\ 0 \\end{bmatrix} \\right)$$\n- $$Q = \\begin{bmatrix} 0.5  -0.8660254037844386  0 \\\\ 0.8660254037844386  0.5  0 \\\\ 0  0  1 \\end{bmatrix}$$\n- $(\\mu, \\kappa) = (50, 100)$.\n\nCase B:\n- $F^p = \\mathrm{diag}(0.9, 1.3, 0.8547008547008547)$, $$F^e = \\begin{bmatrix} 1  0  0 \\\\ 0  \\tfrac{\\sqrt{2}}{2}  -\\tfrac{\\sqrt{2}}{2} \\\\ 0  \\tfrac{\\sqrt{2}}{2}  \\tfrac{\\sqrt{2}}{2} \\end{bmatrix}$$\n- $$(\\mathbf{s}_0, \\mathbf{n}_0) = \\left( \\begin{bmatrix} 0 \\\\ 1 \\\\ 0 \\end{bmatrix}, \\begin{bmatrix} 1 \\\\ 0 \\\\ 0 \\end{bmatrix} \\right)$$\n- $Q = I = \\begin{bmatrix} 1  0  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{bmatrix}$.\n- $(\\mu, \\kappa) = (50, 100)$.\n\nCase C:\n- $F^p = \\mathrm{diag}(1.2, 0.9, 0.9259259259)$, $$F^e = \\begin{bmatrix} 1  0.15  0 \\\\ 0  1  0.2 \\\\ 0.05  0  1 \\end{bmatrix}$$\n- $$(\\mathbf{s}_0, \\mathbf{n}_0) = \\left( \\frac{1}{\\sqrt{2}} \\begin{bmatrix} 1 \\\\ 1 \\\\ 0 \\end{bmatrix}, \\begin{bmatrix} 0 \\\\ 0 \\\\ 1 \\end{bmatrix} \\right)$$\n- $$Q = \\begin{bmatrix} 0  1  0 \\\\ 0  0  1 \\\\ 1  0  0 \\end{bmatrix}$$\n- $(\\mu, \\kappa) = (50, 100)$.\n\nWhat to compute and verify for each case:\n- Compute the current slip system $(\\mathbf{s}, \\mathbf{n})$ by push-forward and the reference slip system $(\\tilde{\\mathbf{s}}_0, \\tilde{\\mathbf{n}}_0)$ recovered by pull-back from $(\\mathbf{s}, \\mathbf{n})$. Enforce normalization at each step. Verify orthogonality and unit-norm of $(\\mathbf{s}, \\mathbf{n})$ numerically, and verify round-trip recovery of $(\\mathbf{s}_0, \\mathbf{n}_0)$ up to sign by checking that $\\left| \\tilde{\\mathbf{s}}_0 \\cdot \\mathbf{s}_0 \\right|$ and $\\left| \\tilde{\\mathbf{n}}_0 \\cdot \\mathbf{n}_0 \\right|$ are close to $1$.\n- Compute $\\boldsymbol{\\sigma}$ from $F^e$ and $(\\mu, \\kappa)$ and the resolved shear stress $\\tau_{\\mathrm{rss}}$. Then, with $F^{e\\star} = Q F^e$, recompute $\\boldsymbol{\\sigma}^\\star$ and $\\tau_{\\mathrm{rss}}^\\star$. Verify objectivity by checking that $\\left| \\tau_{\\mathrm{rss}}^\\star - \\tau_{\\mathrm{rss}} \\right|$ is within tolerance.\n\nNumerical tolerances and pass criteria:\n- Use tolerance $\\varepsilon_{\\mathrm{orth}} = 10^{-12}$ for orthogonality and unit-norm checks, $\\varepsilon_{\\mathrm{round}} = 10^{-10}$ for the round-trip checks on directions, and $\\varepsilon_{\\mathrm{obj}} = 10^{-10}$ for the objectivity check on resolved shear stress.\n- A case passes if and only if all three conditions hold: (i) $\\left| \\mathbf{s} \\cdot \\mathbf{n} \\right| \\le \\varepsilon_{\\mathrm{orth}}$ and $\\left| \\lVert \\mathbf{s} \\rVert - 1 \\right| \\le \\varepsilon_{\\mathrm{orth}}$ and $\\left| \\lVert \\mathbf{n} \\rVert - 1 \\right| \\le \\varepsilon_{\\mathrm{orth}}$; (ii) $\\left| \\tilde{\\mathbf{s}}_0 \\cdot \\mathbf{s}_0 \\right| \\ge 1 - \\varepsilon_{\\mathrm{round}}$ and $\\left| \\tilde{\\mathbf{n}}_0 \\cdot \\mathbf{n}_0 \\right| \\ge 1 - \\varepsilon_{\\mathrm{round}}$; (iii) $\\left| \\tau_{\\mathrm{rss}}^\\star - \\tau_{\\mathrm{rss}} \\right| \\le \\varepsilon_{\\mathrm{obj}}$.\n\nFinal output format:\n- Your program should produce a single line of output containing the pass or fail results for Cases A, B, and C as a comma-separated list enclosed in square brackets (for example, $\\left[ \\mathrm{True}, \\mathrm{False}, \\mathrm{True} \\right]$ should be printed as \"[True,False,True]\").", "solution": "The problem is valid as it is scientifically grounded in the principles of continuum mechanics and crystal plasticity, is well-posed with all necessary information provided, and is stated in an objective, formal manner. The tasks involve the implementation of standard, albeit specific, kinematic transformations and constitutive relations common in computational solid mechanics. We proceed to solve the problem by implementing the required steps.\n\nThe analysis is broken down into four principal parts for each test case, following the problem description: (1) the push-forward mapping of a slip system from the reference to the current configuration, (2) the pull-back mapping to verify the kinematic round-trip, (3) the computation of stress and resolved shear stress, and (4) the verification of frame-indifference (objectivity) of the resolved shear stress under a superposed rigid-body rotation.\n\n**1. Push-Forward Kinematics of a Slip System**\n\nThe kinematics of crystal plasticity relate three configurations: the reference (or undeformed) configuration $\\mathcal{B}_0$, the current (or deformed) configuration $\\mathcal{B}$, and a conceptual intermediate configuration $\\mathcal{B}_p$. The total deformation gradient $F$ is multiplicatively decomposed as $F = F^e F^p$, where $F^p$ maps from $\\mathcal{B}_0$ to $\\mathcal{B}_p$, and $F^e$ maps from $\\mathcal{B}_p$ to $\\mathcal{B}$.\n\nA slip system is defined by a slip direction vector and a slip plane normal covector. In the reference configuration, these are denoted as $(\\mathbf{s}_0, \\mathbf{n}_0)$, which are given as orthogonal unit vectors.\n\nThe push-forward from $\\mathcal{B}_0$ to $\\mathcal{B}_p$ is governed by $F^p$. A vector transforms as $v \\mapsto F^p v$, and a covector (normal) transforms as $n \\mapsto (F^p)^{-T} n$. This transformation law ensures that the dot product (duality pairing) between a vector and a covector is preserved between their un-normalized images, i.e., $((F^p)^{-T} \\mathbf{n}_0) \\cdot (F^p \\mathbf{s}_0) = \\mathbf{n}_0 \\cdot \\mathbf{s}_0$. The slip system in the intermediate configuration, $(\\mathbf{s}_{\\mathrm{int}}, \\mathbf{n}_{\\mathrm{int}})$, is obtained by normalizing these transformed vectors:\n$$\\mathbf{s}_{\\mathrm{int}} = \\frac{F^p \\mathbf{s}_0}{\\|F^p \\mathbf{s}_0\\|}, \\quad \\mathbf{n}_{\\mathrm{int}} = \\frac{(F^p)^{-T} \\mathbf{n}_0}{\\| (F^p)^{-T} \\mathbf{n}_0 \\|}$$\nSince $\\mathbf{s}_0 \\cdot \\mathbf{n}_0 = 0$, it follows that $\\mathbf{s}_{\\mathrm{int}} \\cdot \\mathbf{n}_{\\mathrm{int}} = 0$.\n\nThe mapping from $\\mathcal{B}_p$ to $\\mathcal{B}$ is governed by the elastic deformation gradient $F^e$. The problem specifies a particular kinematic assumption for this step. First, $F^e$ is decomposed via the right polar decomposition into a proper orthogonal rotation $R^e \\in \\mathrm{SO}(3)$ and a symmetric positive-definite right stretch tensor $U^e$, such that $F^e = R^e U^e$. The stretch $U^e$ is calculated as the unique positive-definite square root of the right Cauchy-Green tensor $C^e = (F^e)^T F^e$. The rotation is then found as $R^e = F^e (U^e)^{-1}$.\n\nThe problem states that the slip system vectors in the intermediate configuration are mapped to the current configuration by rotation with $R^e$. This implies that the slip system is considered to be embedded in a lattice that is elastically rotated but not stretched.\n$$\\mathbf{s} = R^e \\mathbf{s}_{\\mathrm{int}}, \\quad \\mathbf{n} = R^e \\mathbf{n}_{\\mathrm{int}}$$\nSince $R^e$ is a rotation and $(\\mathbf{s}_{\\mathrm{int}}, \\mathbf{n}_{\\mathrm{int}})$ are orthonormal, the resulting current slip system $(\\mathbf{s}, \\mathbf{n})$ will also consist of orthonormal vectors. This is verified numerically against the tolerance $\\varepsilon_{\\mathrm{orth}} = 10^{-12}$.\n\n**2. Pull-Back Kinematics and Round-Trip Verification**\n\nTo verify the consistency of the kinematic mappings, a round-trip from the current configuration back to the reference configuration is performed. This pull-back operation is the inverse of the push-forward.\n\nStarting with the current slip system $(\\mathbf{s}, \\mathbf{n})$, we first pull back to the intermediate configuration by undoing the rotation $R^e$:\n$$\\mathbf{s}_{\\mathrm{int}}^{\\mathrm{rec}} = (R^e)^{-1} \\mathbf{s} = (R^e)^T \\mathbf{s}, \\quad \\mathbf{n}_{\\mathrm{int}}^{\\mathrm{rec}} = (R^e)^{-1} \\mathbf{n} = (R^e)^T \\mathbf{n}$$\nNext, we pull back from $\\mathcal{B}_p$ to $\\mathcal{B}_0$. A vector is pulled back by $(F^p)^{-1}$ and a covector by $(F^p)^T$. The un-normalized reference vectors are:\n$$\\mathbf{s}_0' = (F^p)^{-1} \\mathbf{s}_{\\mathrm{int}}^{\\mathrm{rec}}, \\quad \\mathbf{n}_0' = (F^p)^T \\mathbf{n}_{\\mathrm{int}}^{\\mathrm{rec}}$$\nFinally, we normalize these vectors to obtain the recovered reference slip system $(\\tilde{\\mathbf{s}}_0, \\tilde{\\mathbf{n}}_0)$:\n$$\\tilde{\\mathbf{s}}_0 = \\frac{\\mathbf{s}_0'}{\\|\\mathbf{s}_0'\\|}, \\quad \\tilde{\\mathbf{n}}_0 = \\frac{\\mathbf{n}_0'}{\\|\\mathbf{n}_0'\\|}$$\nThe round-trip is considered successful if the recovered system $(\\tilde{\\mathbf{s}}_0, \\tilde{\\mathbf{n}}_0)$ is equivalent to the original system $(\\mathbf{s}_0, \\mathbf{n}_0)$. As a slip system's physical meaning is independent of the sign of its direction or normal vectors, we verify success by checking if their respective absolute dot products are close to $1$: $|\\tilde{\\mathbf{s}}_0 \\cdot \\mathbf{s}_0| \\ge 1 - \\varepsilon_{\\mathrm{round}}$ and $|\\tilde{\\mathbf{n}}_0 \\cdot \\mathbf{n}_0| \\ge 1 - \\varepsilon_{\\mathrm{round}}$, with $\\varepsilon_{\\mathrm{round}} = 10^{-10}$.\n\n**3. Stress and Resolved Shear Stress Calculation**\n\nThe driving force for slip is the resolved shear stress $\\tau_{\\mathrm{rss}}$, which depends on the Cauchy stress $\\boldsymbol{\\sigma}$ and the current slip system $(\\mathbf{s}, \\mathbf{n})$. The problem specifies a compressible Neo-Hookean material model.\n\nThe Kirchhoff stress $\\tau$ is first computed from the elastic deformation. It is given by:\n$$\\tau = \\mu (B^e - I) + \\kappa \\ln(J) I$$\nwhere $B^e = F^e (F^e)^T$ is the left Cauchy-Green (or Finger) tensor for the elastic deformation, $J = \\det(F^e)$ is the elastic volume change, $I$ is the $3 \\times 3$ identity matrix, and $(\\mu, \\kappa)$ are the shear and bulk moduli.\n\nThe Cauchy stress $\\boldsymbol{\\sigma}$ is related to the Kirchhoff stress by $\\boldsymbol{\\sigma} = \\tau / J$.\n\nThe resolved shear stress $\\tau_{\\mathrm{rss}}$ for the slip system $(\\mathbf{s}, \\mathbf{n})$ is the projection of the traction on the slip plane, $(\\boldsymbol{\\sigma} \\mathbf{n})$, onto the slip direction $\\mathbf{s}$:\n$$\\tau_{\\mathrm{rss}} = \\mathbf{s} \\cdot (\\boldsymbol{\\sigma} \\mathbf{n})$$\nFor a symmetric Cauchy stress, this is equivalent to the double contraction $\\boldsymbol{\\sigma} : \\mathbf{P}$, where $\\mathbf{P} = \\frac{1}{2}(\\mathbf{s} \\otimes \\mathbf{n} + \\mathbf{n} \\otimes \\mathbf{s})$ is the Schmid tensor.\n\n**4. Verification of Objectivity**\n\nA fundamental principle of continuum mechanics is frame-indifference or objectivity, which requires that material response be independent of the observer (i.e., independent of superposed rigid-body motions). We verify this for the resolved shear stress.\n\nA rigid-body rotation is applied to the current configuration, represented by a proper orthogonal matrix $Q \\in \\mathrm{SO}(3)$. This transforms the elastic deformation gradient to $F^{e\\star} = Q F^e$. All other quantities must be recomputed based on this new deformation.\n\nThe new polar decomposition is $F^{e\\star} = R^{e\\star} U^{e\\star}$. We find that $U^{e\\star} = U^e$ and $R^{e\\star} = Q R^e$. The intermediate configuration and its slip system $(\\mathbf{s}_{\\mathrm{int}}, \\mathbf{n}_{\\mathrm{int}})$ are unaffected, as they depend only on $F^p$. The new current slip system is:\n$$\\mathbf{s}^\\star = R^{e\\star} \\mathbf{s}_{\\mathrm{int}} = (Q R^e) \\mathbf{s}_{\\mathrm{int}} = Q \\mathbf{s}, \\quad \\mathbf{n}^\\star = R^{e\\star} \\mathbf{n}_{\\mathrm{int}} = (Q R^e) \\mathbf{n}_{\\mathrm{int}} = Q \\mathbf{n}$$\nThe new stress tensor $\\boldsymbol{\\sigma}^\\star$ is computed from $F^{e\\star}$. The transformed left Cauchy-Green tensor is $B^{e\\star} = Q B^e Q^T$ and the determinant is invariant, $J^\\star = J$. The resulting Kirchhoff and Cauchy stresses transform as objective second-order tensors:\n$$\\tau^\\star = Q \\tau Q^T, \\quad \\boldsymbol{\\sigma}^\\star = Q \\boldsymbol{\\sigma} Q^T$$\nThe new resolved shear stress $\\tau_{\\mathrm{rss}}^\\star$ is:\n$$\\tau_{\\mathrm{rss}}^\\star = \\mathbf{s}^\\star \\cdot (\\boldsymbol{\\sigma}^\\star \\mathbf{n}^\\star) = (Q\\mathbf{s}) \\cdot ((Q \\boldsymbol{\\sigma} Q^T) (Q\\mathbf{n})) = \\mathbf{s}^T Q^T Q \\boldsymbol{\\sigma} Q^T Q \\mathbf{n} = \\mathbf{s}^T \\boldsymbol{\\sigma} \\mathbf{n} = \\tau_{\\mathrm{rss}}$$\nThe resolved shear stress must be invariant. We verify this calculation numerically by checking that $|\\tau_{\\mathrm{rss}}^\\star - \\tau_{\\mathrm{rss}}| \\le \\varepsilon_{\\mathrm{obj}}$, with $\\varepsilon_{\\mathrm{obj}} = 10^{-10}$. A case passes if and only if all three verification criteria (orthonormality, round-trip, and objectivity) are met.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import inv, det, sqrtm\n\ndef solve():\n    \"\"\"\n    Main function to run the crystal plasticity kinematics validation\n    for all specified test cases.\n    \"\"\"\n\n    class CrystalPlasticityKinematics:\n        \"\"\"\n        A class to encapsulate the computations and state for a single\n        crystal plasticity test case.\n        \"\"\"\n\n        def __init__(self, Fp, Fe, s0, n0, Q, mu_kappa):\n            \"\"\"\n            Initializes the state with the given parameters for one test case.\n            \"\"\"\n            self.Fp = np.asarray(Fp, dtype=float)\n            self.Fe = np.asarray(Fe, dtype=float)\n            self.s0 = np.asarray(s0, dtype=float) / np.linalg.norm(s0)\n            self.n0 = np.asarray(n0, dtype=float) / np.linalg.norm(n0)\n            self.Q = np.asarray(Q, dtype=float)\n            self.mu, self.kappa = mu_kappa\n\n            # Intermediate and current quantities to be computed\n            self.s_int, self.n_int = None, None\n            self.Re, self.Ue = None, None\n            self.s, self.n = None, None\n            self.sigma, self.tau_rss = None, None\n            self.s_star, self.n_star = None, None\n            self.sigma_star, self.tau_rss_star = None, None\n            \n            # Recovered quantities\n            self.s0_tilde, self.n0_tilde = None, None\n\n        def _perform_polar_decomposition(self, F):\n            \"\"\"Computes the right polar decomposition F = R U.\"\"\"\n            C = F.T @ F\n            U = sqrtm(C)\n            # Ensure U is real, although it should be for positive semi-definite C\n            if np.iscomplexobj(U): U = U.real\n            R = F @ inv(U)\n            return R, U\n\n        def _perform_push_forward(self):\n            \"\"\"Task 1: Pushes the slip system from reference to current config.\"\"\"\n            # Map from reference to intermediate configuration\n            Fp_inv_T = inv(self.Fp).T\n            s_int_prime = self.Fp @ self.s0\n            n_int_prime = Fp_inv_T @ self.n0\n            \n            self.s_int = s_int_prime / np.linalg.norm(s_int_prime)\n            self.n_int = n_int_prime / np.linalg.norm(n_int_prime)\n\n            # Polar decomposition of elastic deformation\n            self.Re, self.Ue = self._perform_polar_decomposition(self.Fe)\n\n            # Map from intermediate to current configuration\n            self.s = self.Re @ self.s_int\n            self.n = self.Re @ self.n_int\n\n        def _perform_pull_back(self):\n            \"\"\"Task 2: Pulls the slip system from current back to reference.\"\"\"\n            # From current to intermediate\n            s_int_rec = self.Re.T @ self.s\n            n_int_rec = self.Re.T @ self.n\n            \n            # From intermediate to reference\n            s0_prime_rec = inv(self.Fp) @ s_int_rec\n            n0_prime_rec = self.Fp.T @ n_int_rec\n            \n            self.s0_tilde = s0_prime_rec / np.linalg.norm(s0_prime_rec)\n            self.n0_tilde = n0_prime_rec / np.linalg.norm(n0_prime_rec)\n\n        def _compute_stress_and_rss(self, F, s, n):\n            \"\"\"Task 3: Computes stress and resolved shear stress.\"\"\"\n            J = det(F)\n            if J = 0: raise ValueError(\"Non-positive determinant.\")\n            Be = F @ F.T\n            I = np.identity(3)\n            tau = self.mu * (Be - I) + self.kappa * np.log(J) * I\n            sigma = tau / J\n            tau_rss = s.dot(sigma @ n)\n            return sigma, tau_rss\n\n        def _compute_rotated_quantities(self):\n            \"\"\"Task 4: Re-computes quantities under superposed rotation.\"\"\"\n            # New elastic deformation gradient\n            Fe_star = self.Q @ self.Fe\n            \n            # New polar decomposition and current slip system\n            Re_star, _ = self._perform_polar_decomposition(Fe_star)\n            self.s_star = Re_star @ self.s_int\n            self.n_star = Re_star @ self.n_int\n\n            # New stress and RSS\n            self.sigma_star, self.tau_rss_star = self._compute_stress_and_rss(\n                Fe_star, self.s_star, self.n_star\n            )\n\n        def run_verifications(self, tolerances):\n            \"\"\"\n            Executes all computational tasks and performs verifications.\n            Returns True if all checks pass, False otherwise.\n            \"\"\"\n            eps_orth, eps_round, eps_obj = tolerances\n\n            # Perform all computations\n            self._perform_push_forward()\n            self._perform_pull_back()\n            self.sigma, self.tau_rss = self._compute_stress_and_rss(self.Fe, self.s, self.n)\n            self._compute_rotated_quantities()\n\n            # Verification (i): Orthonormality in current configuration\n            pass_ortho = (abs(self.s.dot(self.n)) = eps_orth and\n                          abs(np.linalg.norm(self.s) - 1) = eps_orth and\n                          abs(np.linalg.norm(self.n) - 1) = eps_orth)\n\n            # Verification (ii): Round-trip recovery\n            pass_round_trip = (abs(self.s0_tilde.dot(self.s0)) >= 1 - eps_round and\n                               abs(self.n0_tilde.dot(self.n0)) >= 1 - eps_round)\n\n            # Verification (iii): Objectivity of resolved shear stress\n            pass_objectivity = abs(self.tau_rss_star - self.tau_rss) = eps_obj\n\n            return pass_ortho and pass_round_trip and pass_objectivity\n\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case A\n        (np.array([[1, 0.3, 0], [0, 1, 0.2], [0, 0, 1]]),\n         np.array([[1.1, 0.2, 0], [0, 0.9, 0.1], [0, 0, 1.05]]),\n         np.array([1, 0, 0]),\n         np.array([0, 1, 0]),\n         np.array([[0.5, -0.8660254037844386, 0], [0.8660254037844386, 0.5, 0], [0, 0, 1]]),\n         (50, 100)),\n        # Case B\n        (np.diag([0.9, 1.3, 0.8547008547008547]),\n         np.array([[1, 0, 0], [0, np.sqrt(2)/2, -np.sqrt(2)/2], [0, np.sqrt(2)/2, np.sqrt(2)/2]]),\n         np.array([0, 1, 0]),\n         np.array([1, 0, 0]),\n         np.identity(3),\n         (50, 100)),\n        # Case C\n        (np.diag([1.2, 0.9, 0.9259259259]),\n         np.array([[1, 0.15, 0], [0, 1, 0.2], [0.05, 0, 1]]),\n         np.array([1/np.sqrt(2), 1/np.sqrt(2), 0]),\n         np.array([0, 0, 1]),\n         np.array([[0, 1, 0], [0, 0, 1], [1, 0, 0]]),\n         (50, 100))\n    ]\n\n    tolerances = (1e-12, 1e-10, 1e-10) # (eps_orth, eps_round, eps_obj)\n    results = []\n\n    for case_params in test_cases:\n        Fp, Fe, s0, n0, Q, mu_kappa = case_params\n        \n        try:\n            case_runner = CrystalPlasticityKinematics(Fp, Fe, s0, n0, Q, mu_kappa)\n            result = case_runner.run_verifications(tolerances)\n            results.append(result)\n        except (np.linalg.LinAlgError, ValueError) as e:\n            # In case of singular matrices or other numerical issues\n            print(f\"Error processing a case: {e}\")\n            results.append(False)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3556393"}]}