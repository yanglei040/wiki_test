{"hands_on_practices": [{"introduction": "The most direct way to understand hierarchical bases is to use them for their primary purpose: approximating a function. This first practice provides a concrete, step-by-step exercise in determining the modal coefficients, $c_i$, for a hierarchical interpolant on a reference triangle [@problem_id:3570981]. By working through the calculation, you will see firsthand how the coefficients for vertex, edge, and interior modes are found sequentially, demonstrating the foundational principle that adding higher-order modes does not alter the already-computed lower-order parts of the approximation.", "problem": "Consider the reference triangle $\\hat{T}=\\{(x,y)\\in\\mathbb{R}^2:\\, x\\ge 0,\\, y\\ge 0,\\, x+y\\le 1\\}$ with barycentric coordinates $\\lambda_1=1-x-y$, $\\lambda_2=x$, and $\\lambda_3=y$. A hierarchical $p$-version triangular basis up to polynomial order $p=2$ is defined by the following modes:\n- Vertex modes: $\\psi_1=\\lambda_1$, $\\psi_2=\\lambda_2$, $\\psi_3=\\lambda_3$.\n- Edge modes of order $2$: $\\psi_4=4\\,\\lambda_1\\lambda_2$ on edge $(1,2)$, $\\psi_5=4\\,\\lambda_2\\lambda_3$ on edge $(2,3)$, and $\\psi_6=4\\,\\lambda_3\\lambda_1$ on edge $(3,1)$.\n\nUse a hierarchical nodal interpolation operator with the following degrees of freedom applied sequentially:\n- Vertex values at $V_1=(0,0)$, $V_2=(1,0)$, and $V_3=(0,1)$.\n- Edge midpoint values at $M_{12}=\\left(\\frac{1}{2},0\\right)$, $M_{23}=\\left(\\frac{1}{2},\\frac{1}{2}\\right)$, and $M_{31}=\\left(0,\\frac{1}{2}\\right)$.\n\nFor the quadratic field $u(x,y)=x^2-xy+y^2$, determine the coefficients $c_1,\\dots,c_6$ in the hierarchical expansion\n$$\nI_2 u(x,y)=\\sum_{i=1}^{6} c_i\\,\\psi_i(x,y),\n$$\nby enforcing interpolation at the above degrees of freedom in hierarchical order. Report your answer as the $1\\times 6$ row vector $\\left(c_1, c_2, c_3, c_4, c_5, c_6\\right)$ with exact values. No rounding is required, and no units are involved.", "solution": "The problem is valid. It is a well-posed problem in computational solid mechanics, specifically concerning the Finite Element Method. All definitions, data, and conditions are scientifically sound, consistent, and complete, allowing for a unique solution.\n\nThe objective is to find the coefficients $c_1, \\dots, c_6$ for the hierarchical $p$-version expansion of the quadratic field $u(x,y)=x^2-xy+y^2$ on a reference triangle. The expansion is given by\n$$\nI_2 u(x,y)=\\sum_{i=1}^{6} c_i\\,\\psi_i(x,y)\n$$\nwhere the coefficients are determined by enforcing interpolation at a set of hierarchical nodes. The method relies on the sequential determination of coefficients, starting from the lowest polynomial order.\n\nFirst, we identify the interpolation nodes and the corresponding values of the function $u(x,y)$ and the barycentric coordinates $(\\lambda_1, \\lambda_2, \\lambda_3)$. The barycentric coordinates are defined as $\\lambda_1=1-x-y$, $\\lambda_2=x$, and $\\lambda_3=y$.\n\nThe interpolation points (degrees of freedom) are:\n- Vertices: $V_1=(0,0)$, $V_2=(1,0)$, $V_3=(0,1)$.\n- Edge midpoints: $M_{12}=\\left(\\frac{1}{2},0\\right)$, $M_{23}=\\left(\\frac{1}{2},\\frac{1}{2}\\right)$, $M_{31}=\\left(0,\\frac{1}{2}\\right)$.\n\nLet's evaluate the function $u(x,y) = x^2-xy+y^2$ at these nodes:\n- $u(V_1) = u(0,0) = 0^2 - (0)(0) + 0^2 = 0$.\n- $u(V_2) = u(1,0) = 1^2 - (1)(0) + 0^2 = 1$.\n- $u(V_3) = u(0,1) = 0^2 - (0)(1) + 1^2 = 1$.\n- $u(M_{12}) = u\\left(\\frac{1}{2},0\\right) = \\left(\\frac{1}{2}\\right)^2 - \\left(\\frac{1}{2}\\right)(0) + 0^2 = \\frac{1}{4}$.\n- $u(M_{23}) = u\\left(\\frac{1}{2},\\frac{1}{2}\\right) = \\left(\\frac{1}{2}\\right)^2 - \\left(\\frac{1}{2}\\right)\\left(\\frac{1}{2}\\right) + \\left(\\frac{1}{2}\\right)^2 = \\frac{1}{4} - \\frac{1}{4} + \\frac{1}{4} = \\frac{1}{4}$.\n- $u(M_{31}) = u\\left(0,\\frac{1}{2}\\right) = 0^2 - (0)\\left(\\frac{1}{2}\\right) + \\left(\\frac{1}{2}\\right)^2 = \\frac{1}{4}$.\n\nNext, we evaluate the barycentric coordinates at these nodes:\n- $V_1=(0,0) \\implies (\\lambda_1, \\lambda_2, \\lambda_3) = (1,0,0)$.\n- $V_2=(1,0) \\implies (\\lambda_1, \\lambda_2, \\lambda_3) = (0,1,0)$.\n- $V_3=(0,1) \\implies (\\lambda_1, \\lambda_2, \\lambda_3) = (0,0,1)$.\n- $M_{12}=\\left(\\frac{1}{2},0\\right) \\implies (\\lambda_1, \\lambda_2, \\lambda_3) = \\left(\\frac{1}{2},\\frac{1}{2},0\\right)$.\n- $M_{23}=\\left(\\frac{1}{2},\\frac{1}{2}\\right) \\implies (\\lambda_1, \\lambda_2, \\lambda_3) = \\left(0,\\frac{1}{2},\\frac{1}{2}\\right)$.\n- $M_{31}=\\left(0,\\frac{1}{2}\\right) \\implies (\\lambda_1, \\lambda_2, \\lambda_3) = \\left(\\frac{1}{2},0,\\frac{1}{2}\\right)$.\n\nThe hierarchical interpolation proceeds in stages.\n\n**Stage 1: Determine vertex coefficients ($c_1, c_2, c_3$)**\nWe first consider the linear interpolant, $I_1 u(x,y) = c_1\\psi_1 + c_2\\psi_2 + c_3\\psi_3$, and enforce interpolation at the vertices.\nThe basis functions are $\\psi_1=\\lambda_1$, $\\psi_2=\\lambda_2$, $\\psi_3=\\lambda_3$. These are the standard linear shape functions, which have the property that $\\psi_i(V_j) = \\delta_{ij}$ (the Kronecker delta).\n- At $V_1$: $I_1 u(V_1) = c_1\\psi_1(V_1) + c_2\\psi_2(V_1) + c_3\\psi_3(V_1) = c_1(1) + c_2(0) + c_3(0) = c_1$.\n  Enforcing $I_1 u(V_1) = u(V_1)$, we get $c_1 = 0$.\n- At $V_2$: $I_1 u(V_2) = c_1\\psi_1(V_2) + c_2\\psi_2(V_2) + c_3\\psi_3(V_2) = c_1(0) + c_2(1) + c_3(0) = c_2$.\n  Enforcing $I_1 u(V_2) = u(V_2)$, we get $c_2 = 1$.\n- At $V_3$: $I_1 u(V_3) = c_1\\psi_1(V_3) + c_2\\psi_2(V_3) + c_3\\psi_3(V_3) = c_1(0) + c_2(0) + c_3(1) = c_3$.\n  Enforcing $I_1 u(V_3) = u(V_3)$, we get $c_3 = 1$.\n\nSo, the vertex coefficients are $c_1=0$, $c_2=1$, and $c_3=1$. The linear portion of the interpolant is $I_1 u = (0)\\lambda_1 + (1)\\lambda_2 + (1)\\lambda_3 = \\lambda_2+\\lambda_3 = x+y$.\n\n**Stage 2: Determine edge coefficients ($c_4, c_5, c_6$)**\nNow we consider the full quadratic interpolant, $I_2 u = I_1 u + c_4\\psi_4 + c_5\\psi_5 + c_6\\psi_6$.\nThe crucial property of hierarchical bases is that the higher-order modes (edge modes $\\psi_4, \\psi_5, \\psi_6$) are zero at the nodes of the lower-order approximation (vertices $V_1, V_2, V_3$). For example, $\\psi_4=4\\lambda_1\\lambda_2$ is zero at $V_1$ (where $\\lambda_2=0$), $V_2$ (where $\\lambda_1=0$), and $V_3$ (where both are zero). This ensures that determining $c_4, c_5, c_6$ does not alter the already enforced interpolation conditions at the vertices.\nWe determine the edge coefficients by enforcing interpolation at the edge midpoints.\n\n- For $c_4$ (edge 1-2): We use the midpoint $M_{12}$. The interpolation condition is $I_2 u(M_{12}) = u(M_{12})$.\n  $I_1 u(M_{12}) + c_4\\psi_4(M_{12}) + c_5\\psi_5(M_{12}) + c_6\\psi_6(M_{12}) = u(M_{12})$.\n  At $M_{12}$, the barycentric coordinates are $(\\lambda_1, \\lambda_2, \\lambda_3) = (\\frac{1}{2},\\frac{1}{2},0)$.\n  The edge modes $\\psi_5=4\\lambda_2\\lambda_3$ and $\\psi_6=4\\lambda_3\\lambda_1$ are zero because $\\lambda_3=0$.\n  The mode $\\psi_4(M_{12}) = 4\\lambda_1\\lambda_2 = 4\\left(\\frac{1}{2}\\right)\\left(\\frac{1}{2}\\right) = 1$.\n  The value of the linear interpolant is $I_1 u(M_{12}) = \\lambda_2(M_{12}) + \\lambda_3(M_{12}) = \\frac{1}{2} + 0 = \\frac{1}{2}$.\n  The equation becomes: $\\frac{1}{2} + c_4(1) = u(M_{12}) = \\frac{1}{4}$.\n  Solving for $c_4$: $c_4 = \\frac{1}{4} - \\frac{1}{2} = -\\frac{1}{4}$.\n\n- For $c_5$ (edge 2-3): We use the midpoint $M_{23}$. The condition is $I_2 u(M_{23}) = u(M_{23})$.\n  $I_1 u(M_{23}) + c_4\\psi_4(M_{23}) + c_5\\psi_5(M_{23}) + c_6\\psi_6(M_{23}) = u(M_{23})$.\n  At $M_{23}$, $(\\lambda_1, \\lambda_2, \\lambda_3) = (0,\\frac{1}{2},\\frac{1}{2})$.\n  The edge modes $\\psi_4$ and $\\psi_6$ are zero because $\\lambda_1=0$.\n  The mode $\\psi_5(M_{23}) = 4\\lambda_2\\lambda_3 = 4\\left(\\frac{1}{2}\\right)\\left(\\frac{1}{2}\\right) = 1$.\n  The value of the linear interpolant is $I_1 u(M_{23}) = \\lambda_2(M_{23}) + \\lambda_3(M_{23}) = \\frac{1}{2} + \\frac{1}{2} = 1$.\n  The equation becomes: $1 + c_5(1) = u(M_{23}) = \\frac{1}{4}$.\n  Solving for $c_5$: $c_5 = \\frac{1}{4} - 1 = -\\frac{3}{4}$.\n\n- For $c_6$ (edge 3-1): We use the midpoint $M_{31}$. The condition is $I_2 u(M_{31}) = u(M_{31})$.\n  $I_1 u(M_{31}) + c_4\\psi_4(M_{31}) + c_5\\psi_5(M_{31}) + c_6\\psi_6(M_{31}) = u(M_{31})$.\n  At $M_{31}$, $(\\lambda_1, \\lambda_2, \\lambda_3) = (\\frac{1}{2},0,\\frac{1}{2})$.\n  The edge modes $\\psi_4$ and $\\psi_5$ are zero because $\\lambda_2=0$.\n  The mode $\\psi_6(M_{31}) = 4\\lambda_3\\lambda_1 = 4\\left(\\frac{1}{2}\\right)\\left(\\frac{1}{2}\\right) = 1$.\n  The value of the linear interpolant is $I_1 u(M_{31}) = \\lambda_2(M_{31}) + \\lambda_3(M_{31}) = 0 + \\frac{1}{2} = \\frac{1}{2}$.\n  The equation becomes: $\\frac{1}{2} + c_6(1) = u(M_{31}) = \\frac{1}{4}$.\n  Solving for $c_6$: $c_6 = \\frac{1}{4} - \\frac{1}{2} = -\\frac{1}{4}$.\n\nThe set of hierarchical coefficients is: $c_1=0$, $c_2=1$, $c_3=1$, $c_4=-\\frac{1}{4}$, $c_5=-\\frac{3}{4}$, $c_6=-\\frac{1}{4}$.\n\nVerification: The space spanned by the six basis functions $\\{\\psi_i\\}_{i=1}^6$ is the space of all quadratic polynomials on the triangle, $P_2(\\hat{T})$. Since the given function $u(x,y)=x^2-xy+y^2$ is a quadratic polynomial, its interpolation in this space must be exact. Let's confirm by reconstructing the polynomial.\n$I_2 u = c_1\\lambda_1 + c_2\\lambda_2 + c_3\\lambda_3 + c_4(4\\lambda_1\\lambda_2) + c_5(4\\lambda_2\\lambda_3) + c_6(4\\lambda_3\\lambda_1)$\n$I_2 u = (1)\\lambda_2 + (1)\\lambda_3 - \\frac{1}{4}(4\\lambda_1\\lambda_2) - \\frac{3}{4}(4\\lambda_2\\lambda_3) - \\frac{1}{4}(4\\lambda_3\\lambda_1)$\n$I_2 u = \\lambda_2 + \\lambda_3 - \\lambda_1\\lambda_2 - 3\\lambda_2\\lambda_3 - \\lambda_3\\lambda_1$\nSubstitute $\\lambda_1=1-x-y$, $\\lambda_2=x$, $\\lambda_3=y$:\n$I_2 u(x,y) = x + y - (1-x-y)x - 3xy - y(1-x-y)$\n$I_2 u(x,y) = x + y - (x-x^2-xy) - 3xy - (y-xy-y^2)$\n$I_2 u(x,y) = x + y - x + x^2 + xy - 3xy - y + xy + y^2$\n$I_2 u(x,y) = x^2 + y^2 + (1-3+1)xy = x^2 - xy + y^2 = u(x,y)$.\nThe reconstruction is exact, which validates the calculated coefficients.\n\nThe final answer is the row vector of coefficients $(c_1, c_2, c_3, c_4, c_5, c_6)$.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0 & 1 & 1 & -\\frac{1}{4} & -\\frac{3}{4} & -\\frac{1}{4}\n\\end{pmatrix}\n}\n$$", "id": "3570981"}, {"introduction": "Beyond interpolation, the true power of hierarchical bases is revealed when they are used in a Galerkin framework to assemble system matrices like the stiffness matrix $\\mathbf{K}$ and mass matrix $\\mathbf{M}$. This exercise guides you through deriving the structure of these matrices for a quadrilateral element using a tensor-product hierarchical basis [@problem_id:3570949]. The key outcome is understanding the resulting block-matrix structure, particularly the crucial $H^1$-orthogonality between different mode types, which underpins efficient solution algorithms like static condensation.", "problem": "Consider a single isoparametric quadrilateral finite element whose reference domain is the square $\\hat{\\Omega} = [-1,1] \\times [-1,1]$ with affine mapping to the physical element, so that the Jacobian is constant and scaling factors separate. Adopt a scalar field $u$ in the first-order Sobolev space (H1) as a proxy for a component of displacement in small-strain linear elasticity, and define the local bilinear forms for stiffness and mass as\n$$\na(u,v) = \\int_{\\hat{\\Omega}} \\kappa \\, \\nabla u \\cdot \\nabla v \\, \\mathrm{d}\\xi \\, \\mathrm{d}\\eta, \n\\qquad \nm(u,v) = \\int_{\\hat{\\Omega}} \\rho \\, u \\, v \\, \\mathrm{d}\\xi \\, \\mathrm{d}\\eta,\n$$\nwhere $\\kappa > 0$ is a constant diffusivity-like modulus and $\\rho > 0$ is a constant density-like coefficient. Let the hierarchical $p$-version tensor-product basis be constructed from one-dimensional hierarchical modes on $[-1,1]$:\n- Vertex modes $l_{1}(\\xi) = \\frac{1 - \\xi}{2}$ and $l_{2}(\\xi) = \\frac{1 + \\xi}{2}$ produce the four corner functions $L_{i}(\\xi,\\eta) = l_{\\alpha}(\\xi) \\, l_{\\beta}(\\eta)$ for $\\alpha,\\beta \\in \\{1,2\\}$.\n- Edge modes on each one-dimensional edge are $\\psi_{k}(\\xi)$ for $k = 2,3,\\dots,p$, defined to vanish at $\\xi = \\pm 1$ and span polynomials of increasing degree hierarchically; likewise in the $\\eta$-direction. A concrete choice may be taken as differences of Legendre polynomials $\\psi_{k}(\\xi) = c_{k}\\left(P_{k}(\\xi)-P_{k-2}(\\xi)\\right)$ with normalization constants $c_{k}>0$ and $P_{n}$ the $n$-th Legendre polynomial, though the derivation below holds for any hierarchical $\\psi_{k}$ that vanishes at the endpoints.\n- Interior modes are tensor products $\\Psi_{r,s}(\\xi,\\eta) = \\psi_{r}(\\xi)\\,\\psi_{s}(\\eta)$ with $r,s \\in \\{2,3,\\dots,p\\}$.\n\nClassify the modes by their geometric support: vertex modes $V$, edge modes $E$ (organized per edge and degree), and interior modes $I$. Using the fundamental weak forms above and the separability of the tensor-product basis, derive the local element stiffness matrix $\\mathbf{K}$ and mass matrix $\\mathbf{M}$ in terms of one-dimensional inner products of the hierarchical basis and their derivatives, exposing the Kronecker-product/sum structure. Then, identify and explain the resulting block structure of $\\mathbf{K}$ and $\\mathbf{M}$ when ordered by the $V$–$E$–$I$ classification, stating which blocks are diagonal, which are zero by construction, and which contain nonzero couplings induced by tensor-product separability and boundary vanishing properties.\n\nFinally, for polynomial order $p \\geq 2$, provide a single closed-form analytic expression for the total number of hierarchical degrees of freedom $N(p)$ of this quadrilateral element under the above classification. Express $N(p)$ as a simplified function of $p$.", "solution": "The problem statement is a valid exercise in the p-version finite element method. It is scientifically grounded in computational solid mechanics, mathematically well-posed, objective, and self-contained. All definitions and conditions are standard and allow for a unique, derivable solution. We will proceed with the derivation and analysis as requested.\n\nThe solution is presented in three parts:\n1. Derivation of the local stiffness and mass matrices in terms of one-dimensional inner products and Kronecker products/sums.\n2. Analysis of the block structure of these matrices under a Vertex-Edge-Interior (V-E-I) ordering of basis functions.\n3. Derivation of the total number of degrees of freedom, $N(p)$.\n\n**Part 1: Derivation of Element Matrices**\n\nLet the complete one-dimensional hierarchical basis on $[-1,1]$ be denoted by $\\{\\phi_i(\\xi)\\}_{i=0}^{p}$, where $\\phi_0(\\xi) = l_1(\\xi)$, $\\phi_1(\\xi) = l_2(\\xi)$, and $\\{\\phi_i(\\xi)\\}_{i=2}^{p} = \\{\\psi_i(\\xi)\\}_{i=2}^{p}$. The total number of 1D basis functions is $p+1$. The two-dimensional basis on $\\hat{\\Omega}$ is a tensor product of these 1D bases: $\\{ N_k(\\xi, \\eta) \\} = \\{ \\phi_i(\\xi) \\phi_j(\\eta) \\}_{i,j=0}^{p}$.\n\nWe define the one-dimensional mass and stiffness matrices on the reference interval $[-1,1]$ with respect to the basis $\\{\\phi_i\\}$. Let the components of these $1$D matrices be:\n$$\nM^1_{ij} = \\int_{-1}^{1} \\phi_i(x) \\phi_j(x) \\, \\mathrm{d}x\n$$\n$$\nK^1_{ij} = \\int_{-1}^{1} \\phi'_i(x) \\phi'_j(x) \\, \\mathrm{d}x\n$$\nwhere a prime denotes differentiation with respect to the argument, e.g., $\\phi'_i(x) = \\frac{\\mathrm{d}\\phi_i}{\\mathrm{d}x}(x)$.\n\nThe scalar field $u$ is approximated as a linear combination of the 2D basis functions:\n$$\nu(\\xi, \\eta) = \\sum_{k} u_k N_k(\\xi, \\eta) = \\sum_{i=0}^{p} \\sum_{j=0}^{p} u_{ij} \\phi_i(\\xi) \\phi_j(\\eta)\n$$\nThe components of the element mass matrix $\\mathbf{M}$ and stiffness matrix $\\mathbf{K}$ are given by $M_{kl} = m(N_k, N_l)$ and $K_{kl} = a(N_k, N_l)$ respectively. Let the $k$-th basis function correspond to the index pair $(i,j)$ and the $l$-th basis function to $(p,q)$. Thus, $N_k(\\xi, \\eta) = \\phi_i(\\xi) \\phi_j(\\eta)$ and $N_l(\\xi, \\eta) = \\phi_p(\\xi) \\phi_q(\\eta)$.\n\nFor the mass matrix entry, we have:\n$$\nM_{(i,j),(p,q)} = m(\\phi_i(\\xi)\\phi_j(\\eta), \\phi_p(\\xi)\\phi_q(\\eta)) = \\int_{-1}^{1}\\int_{-1}^{1} \\rho (\\phi_i(\\xi)\\phi_j(\\eta)) (\\phi_p(\\xi)\\phi_q(\\eta)) \\, \\mathrm{d}\\xi \\, \\mathrm{d}\\eta\n$$\nSince $\\rho$ is a constant and the integral is separable:\n$$\nM_{(i,j),(p,q)} = \\rho \\left( \\int_{-1}^{1} \\phi_i(\\xi)\\phi_p(\\xi) \\, \\mathrm{d}\\xi \\right) \\left( \\int_{-1}^{1} \\phi_j(\\eta)\\phi_q(\\eta) \\, \\mathrm{d}\\eta \\right) = \\rho \\, M^1_{ip} \\, M^1_{jq}\n$$\nThis structure is precisely the definition of the Kronecker product ($\\otimes$). If we arrange the basis functions with the $\\eta$ index varying fastest, the full mass matrix is:\n$$\n\\mathbf{M} = \\rho (\\mathbf{M}^1 \\otimes \\mathbf{M}^1)\n$$\n\nFor the stiffness matrix entry, we first compute the gradients:\n$$\n\\nabla N_k = \\nabla(\\phi_i(\\xi)\\phi_j(\\eta)) = \\begin{pmatrix} \\phi'_i(\\xi)\\phi_j(\\eta) \\\\ \\phi_i(\\xi)\\phi'_j(\\eta) \\end{pmatrix}, \\quad \\nabla N_l = \\begin{pmatrix} \\phi'_p(\\xi)\\phi_q(\\eta) \\\\ \\phi_p(\\xi)\\phi'_q(\\eta) \\end{pmatrix}\n$$\nThe integrand of the stiffness bilinear form is $\\nabla N_k \\cdot \\nabla N_l = \\phi'_i\\phi'_p\\phi_j\\phi_q + \\phi_i\\phi_p\\phi'_j\\phi'_q$.\n$$\nK_{(i,j),(p,q)} = a(N_k, N_l) = \\kappa \\int_{-1}^{1}\\int_{-1}^{1} (\\phi'_i(\\xi)\\phi'_p(\\xi)\\phi_j(\\eta)\\phi_q(\\eta) + \\phi_i(\\xi)\\phi_p(\\xi)\\phi'_j(\\eta)\\phi'_q(\\eta)) \\, \\mathrm{d}\\xi \\, \\mathrm{d}\\eta\n$$\nSeparating the integrals:\n$$\nK_{(i,j),(p,q)} = \\kappa \\left[ \\left(\\int_{-1}^{1} \\phi'_i(\\xi)\\phi'_p(\\xi)\\mathrm{d}\\xi\\right)\\left(\\int_{-1}^{1} \\phi_j(\\eta)\\phi_q(\\eta)\\mathrm{d}\\eta\\right) + \\left(\\int_{-1}^{1} \\phi_i(\\xi)\\phi_p(\\xi)\\mathrm{d}\\xi\\right)\\left(\\int_{-1}^{1} \\phi'_j(\\eta)\\phi'_q(\\eta)\\mathrm{d}\\eta\\right) \\right]\n$$\n$$\nK_{(i,j),(p,q)} = \\kappa ( K^1_{ip} M^1_{jq} + M^1_{ip} K^1_{jq} )\n$$\nThis structure corresponds to the Kronecker sum. The full stiffness matrix is:\n$$\n\\mathbf{K} = \\kappa (\\mathbf{K}^1 \\otimes \\mathbf{M}^1 + \\mathbf{M}^1 \\otimes \\mathbf{K}^1)\n$$\nThis derivation formally expresses the element matrices in terms of one-dimensional integrals and reveals their underlying Kronecker product/sum structure, as required.\n\n**Part 2: Block Structure Analysis**\n\nWe now re-order the basis functions according to the geometric classification: Vertex (V), Edge (E), and Interior (I).\n- **Vertex modes (V)**: $4$ functions $\\{l_\\alpha(\\xi)l_\\beta(\\eta)\\}_{\\alpha,\\beta \\in \\{1,2\\}}$.\n- **Edge modes (E)**: $4(p-1)$ functions. For edges parallel to the $\\xi$-axis, these are $\\{ \\psi_k(\\xi)l_\\beta(\\eta) \\}_{k=2..p, \\beta=1,2}$. For edges parallel to the $\\eta$-axis, $\\{ l_\\alpha(\\xi)\\psi_k(\\eta) \\}_{k=2..p, \\alpha=1,2}$.\n- **Interior modes (I)**: $(p-1)^2$ functions $\\{ \\psi_r(\\xi)\\psi_s(\\eta) \\}_{r,s=2..p}$.\n\nA crucial property of the hierarchical edge modes $\\psi_k(x)$ is that they vanish at the endpoints: $\\psi_k(\\pm 1) = 0$. This implies orthogonality between the derivatives of vertex modes and edge/interior modes. The 1D vertex modes $l_\\alpha(x)$ are linear, so $l''_\\alpha(x) = 0$. For any $k \\ge 2$:\n$$\n\\int_{-1}^{1} l'_\\alpha(x) \\psi'_k(x) \\, \\mathrm{d}x = [l'_\\alpha(x) \\psi_k(x)]_{-1}^{1} - \\int_{-1}^{1} l''_\\alpha(x) \\psi_k(x) \\, \\mathrm{d}x = l'_\\alpha(\\pm 1)\\psi_k(\\pm 1) - 0 = 0\n$$\nThis result, $\\langle l'_\\alpha, \\psi'_k \\rangle = 0$, is the key to the block structure of the stiffness matrix.\n\nThe matrices partitioned by the V-E-I ordering take the form:\n$$\n\\mathbf{M} = \\begin{pmatrix} \\mathbf{M}_{VV} & \\mathbf{M}_{VE} & \\mathbf{M}_{VI} \\\\ \\mathbf{M}_{EV} & \\mathbf{M}_{EE} & \\mathbf{M}_{EI} \\\\ \\mathbf{M}_{IV} & \\mathbf{M}_{IE} & \\mathbf{M}_{II} \\end{pmatrix}, \\quad \\mathbf{K} = \\begin{pmatrix} \\mathbf{K}_{VV} & \\mathbf{K}_{VE} & \\mathbf{K}_{VI} \\\\ \\mathbf{K}_{EV} & \\mathbf{K}_{EE} & \\mathbf{K}_{EI} \\\\ \\mathbf{K}_{IV} & \\mathbf{K}_{IE} & \\mathbf{K}_{II} \\end{pmatrix}\n$$\n\n**Mass Matrix ($\\mathbf{M}$) Block Structure:**\nThe mass form $m(u,v) = \\rho \\int_{\\hat{\\Omega}} u v \\, \\mathrm{d}\\xi\\mathrm{d}\\eta$ involves $L^2$ inner products. The hierarchical basis functions are generally not $L^2$-orthogonal across different types (V, E, I). For example, $\\int_{-1}^{1} l_\\alpha(x) \\psi_k(x) \\, \\mathrm{d}x \\neq 0$. Consequently, all off-diagonal blocks of the mass matrix are generally non-zero and densely populated.\n- $\\mathbf{M}_{VE}, \\mathbf{M}_{VI}, \\mathbf{M}_{EI}$ are all **non-zero**.\nThe mass matrix $\\mathbf{M}$ is a **fully coupled (dense) matrix** in this block partitioning.\n\n**Stiffness Matrix ($\\mathbf{K}$) Block Structure:**\nThe structure of $\\mathbf{K}$ is sparse due to the $\\langle l'_\\alpha, \\psi'_k \\rangle = 0$ property.\n- **$\\mathbf{K}_{VI}$ and $\\mathbf{K}_{IV}$ (Vertex-Interior Coupling):**\nLet $u = l_\\alpha(\\xi)l_\\beta(\\eta) \\in V$ and $v = \\psi_r(\\xi)\\psi_s(\\eta) \\in I$.\n$a(u,v) = \\kappa \\left( \\langle l'_\\alpha, \\psi'_r \\rangle \\langle l_\\beta, \\psi_s \\rangle + \\langle l_\\alpha, \\psi_r \\rangle \\langle l'_\\beta, \\psi'_s \\rangle \\right)$.\nBoth terms are zero because $\\langle l'_\\alpha, \\psi'_r \\rangle = 0$ and $\\langle l'_\\beta, \\psi'_s \\rangle = 0$.\nThus, $\\mathbf{K}_{VI} = \\mathbf{0}$ and by symmetry, $\\mathbf{K}_{IV} = \\mathbf{0}$. This is a fundamental property of hierarchical bases: vertex modes are $H^1$-orthogonal to interior modes.\n\n- **$\\mathbf{K}_{VE}$ and $\\mathbf{K}_{EI}$ (Other Couplings):**\nThese blocks are generally non-zero. For example, consider $u = l_\\alpha(\\xi)l_\\beta(\\eta) \\in V$ and an edge mode $v = \\psi_k(\\xi)l_\\gamma(\\eta) \\in E$.\n$a(u,v) = \\kappa \\left( \\langle l'_\\alpha, \\psi'_k \\rangle \\langle l_\\beta, l_\\gamma \\rangle + \\langle l_\\alpha, \\psi_k \\rangle \\langle l'_\\beta, l'_\\gamma \\rangle \\right) = \\kappa \\langle l_\\alpha, \\psi_k \\rangle \\langle l'_\\beta, l'_\\gamma \\rangle \\neq 0$.\nSo $\\mathbf{K}_{VE}$ and $\\mathbf{K}_{EV}$ are **non-zero**.\nSimilarly, for $u = \\psi_k(\\xi)l_\\beta(\\eta) \\in E$ and $v = \\psi_r(\\xi)\\psi_s(\\eta) \\in I$:\n$a(u,v) = \\kappa \\left( \\langle \\psi'_k, \\psi'_r \\rangle \\langle l_\\beta, \\psi_s \\rangle + \\langle \\psi_k, \\psi_r \\rangle \\langle l'_\\beta, \\psi'_s \\rangle \\right) = \\kappa \\langle \\psi'_k, \\psi'_r \\rangle \\langle l_\\beta, \\psi_s \\rangle \\neq 0$.\nSo $\\mathbf{K}_{EI}$ and $\\mathbf{K}_{IE}$ are also **non-zero**.\n\n- **$\\mathbf{K}_{EE}$ (Edge-Edge Block):**\nThis block has a specific structure. Edge modes on perpendicular edges are $H^1$-orthogonal. For $u = \\psi_k(\\xi)l_\\alpha(\\eta)$ and $v = l_\\beta(\\xi)\\psi_r(\\eta)$:\n$a(u,v) = \\kappa \\left( \\langle \\psi'_k, l'_\\beta \\rangle \\langle l_\\alpha, \\psi_r \\rangle + \\langle \\psi_k, l_\\beta \\rangle \\langle l'_\\alpha, \\psi'_r \\rangle \\right) = 0 + 0 = 0$.\nTherefore, $\\mathbf{K}_{EE}$ is **block-diagonal**, with non-zero couplings only between modes on the same edge or on parallel edges.\n\nIn summary, the stiffness matrix has the following block structure:\n$$\n\\mathbf{K} = \\begin{pmatrix} \\mathbf{K}_{VV} & \\mathbf{K}_{VE} & \\mathbf{0} \\\\ \\mathbf{K}_{EV} & \\mathbf{K}_{EE} & \\mathbf{K}_{EI} \\\\ \\mathbf{0} & \\mathbf{K}_{IE} & \\mathbf{K}_{II} \\end{pmatrix}\n$$\nwhere $\\mathbf{K}_{EE}$ is itself block-diagonal, separating modes associated with $\\xi$-edges from those associated with $\\eta$-edges. The diagonal blocks $\\mathbf{K}_{VV}$, $\\mathbf{K}_{EE}$, and $\\mathbf{K}_{II}$ are generally non-diagonal and contain non-zero entries.\n\n**Part 3: Total Number of Degrees of Freedom**\n\nThe total number of degrees of freedom (DoFs), $N(p)$, is the total number of basis functions for a polynomial order $p$. We can sum the number of modes in each category for $p \\ge 2$:\n1.  **Vertex Modes ($N_V$):** There are $4$ corners, each associated with one vertex mode (the tensor products of 1D linear hat functions).\n    $$N_V = 4$$\n2.  **Edge Modes ($N_E$):** There are $4$ edges. For each edge, there are hierarchical modes of degree $k=2, 3, \\dots, p$. The number of such modes per edge is $p-1$.\n    $$N_E = 4 \\times (p-1)$$\n3.  **Interior Modes ($N_I$):** These are tensor products of the 1D edge modes, $\\psi_r(\\xi)\\psi_s(\\eta)$. The indices $r$ and $s$ both range from $2$ to $p$. The number of choices for each index is $p-1$.\n    $$N_I = (p-1) \\times (p-1) = (p-1)^2$$\n\nThe total number of degrees of freedom $N(p)$ is the sum:\n$$\nN(p) = N_V + N_E + N_I = 4 + 4(p-1) + (p-1)^2\n$$\nExpanding and simplifying this expression:\n$$\nN(p) = 4 + 4p - 4 + (p^2 - 2p + 1)\n$$\n$$\nN(p) = p^2 + 2p + 1\n$$\nThis can be factored into a simple form:\n$$\nN(p) = (p+1)^2\n$$\nThis result is consistent with the tensor product construction, where we have $p+1$ basis functions in one dimension ($\\{l_1, l_2, \\psi_2, \\dots, \\psi_p\\}$), leading to $(p+1) \\times (p+1)$ functions in two dimensions.", "answer": "$$\n\\boxed{(p+1)^2}\n$$", "id": "3570949"}, {"introduction": "Our previous analyses benefited from the simplicity of an affine mapping, where the element Jacobian matrix $\\mathbf{J}$ is constant. This final practice confronts the more realistic scenario of a curved element, where $\\mathbf{J}$ varies spatially [@problem_id:3570976]. You will derive the stiffness contribution of an interior bubble mode and see how the non-constant Jacobian introduces a complex weighting factor into the stiffness integral, degrading the ideal matrix properties and providing insight into the interplay between geometry and numerical performance.", "problem": "Consider a single four-node bilinear quadrilateral finite element obtained by an isoparametric mapping from the reference square with local coordinates $(\\xi,\\eta) \\in [-1,1] \\times [-1,1]$ to the physical $(x,y)$-plane. The bilinear shape functions are $N_1(\\xi,\\eta) = \\frac{1}{4}(1-\\xi)(1-\\eta)$, $N_2(\\xi,\\eta) = \\frac{1}{4}(1+\\xi)(1-\\eta)$, $N_3(\\xi,\\eta) = \\frac{1}{4}(1+\\xi)(1+\\eta)$, $N_4(\\xi,\\eta) = \\frac{1}{4}(1-\\xi)(1+\\eta)$. The physical nodal coordinates are given by\n$$\n(x_1,y_1)=(-0.5,-1),\\quad (x_2,y_2)=(0.5,-1),\\quad (x_3,y_3)=(1.5,1),\\quad (x_4,y_4)=(-1.5,1).\n$$\nThe isoparametric mapping is defined by $x(\\xi,\\eta)=\\sum_{i=1}^{4}N_i(\\xi,\\eta)\\,x_i$ and $y(\\xi,\\eta)=\\sum_{i=1}^{4}N_i(\\xi,\\eta)\\,y_i$, with Jacobian matrix $\\mathbf{J}(\\xi,\\eta)=\\begin{bmatrix}\\partial x/\\partial \\xi & \\partial x/\\partial \\eta \\\\ \\partial y/\\partial \\xi & \\partial y/\\partial \\eta\\end{bmatrix}$ and determinant $\\det\\mathbf{J}$. Consider the hierarchical interior bubble mode of polynomial order $p=2$ on the reference element,\n$$\n\\hat{N}(\\xi,\\eta)=(1-\\xi^2)(1-\\eta^2),\n$$\nwhich vanishes on the boundary of the reference square. For a scalar diffusion problem with unit conductivity, the elemental stiffness associated with this interior mode in the Galerkin method is\n$$\nK_b=\\int_{-1}^{1}\\int_{-1}^{1} \\nabla_{\\boldsymbol{x}} \\hat{N}(\\xi,\\eta)\\cdot \\nabla_{\\boldsymbol{x}} \\hat{N}(\\xi,\\eta)\\,\\det\\mathbf{J}(\\xi,\\eta)\\,d\\xi\\,d\\eta,\n$$\nwhere $\\nabla_{\\boldsymbol{x}}$ denotes the gradient with respect to the physical coordinates and is related to the reference gradient by $\\nabla_{\\boldsymbol{x}} \\hat{N}=\\mathbf{J}^{-T}\\nabla_{\\boldsymbol{\\xi}}\\hat{N}$, with $\\nabla_{\\boldsymbol{\\xi}}$ the gradient in $(\\xi,\\eta)$.\n\nStarting only from these definitions and the given nodal coordinates and bubble mode:\n- Derive the explicit mapping $x(\\xi,\\eta)$ and $y(\\xi,\\eta)$ and the Jacobian $\\mathbf{J}(\\xi,\\eta)$.\n- Compute the closed-form expression for $\\nabla_{\\boldsymbol{x}}\\hat{N}(\\xi,\\eta)$ as a function of $(\\xi,\\eta)$.\n- Evaluate $K_b$ exactly.\n- Evaluate the “constant metric” approximation $K_b^{(0)}$ obtained by freezing $\\mathbf{J}$ at the element center $(\\xi,\\eta)=(0,0)$, i.e., taking $\\mathbf{J}(\\xi,\\eta)\\equiv \\mathbf{J}(0,0)$ and $\\det\\mathbf{J}(\\xi,\\eta)\\equiv \\det\\mathbf{J}(0,0)$ in the integral.\n- Report the ratio $R=K_b/K_b^{(0)}$ as a single, closed-form analytic expression. Do not round; provide the exact expression. The ratio $R$ is dimensionless.", "solution": "The user wants to solve a problem related to an isoparametric finite element. I will first validate the problem statement and then proceed with the solution if it is valid.\n\n### Step 1: Extract Givens\n-   **Element Type**: Four-node bilinear quadrilateral element.\n-   **Reference Element Coordinates**: $(\\xi,\\eta) \\in [-1,1] \\times [-1,1]$.\n-   **Bilinear Shape Functions**:\n    $N_1(\\xi,\\eta) = \\frac{1}{4}(1-\\xi)(1-\\eta)$\n    $N_2(\\xi,\\eta) = \\frac{1}{4}(1+\\xi)(1-\\eta)$\n    $N_3(\\xi,\\eta) = \\frac{1}{4}(1+\\xi)(1+\\eta)$\n    $N_4(\\xi,\\eta) = \\frac{1}{4}(1-\\xi)(1+\\eta)$\n-   **Physical Nodal Coordinates**:\n    $(x_1,y_1)=(-0.5,-1)$\n    $(x_2,y_2)=(0.5,-1)$\n    $(x_3,y_3)=(1.5,1)$\n    $(x_4,y_4)=(-1.5,1)$\n-   **Isoparametric Mapping**: $x(\\xi,\\eta)=\\sum_{i=1}^{4}N_i(\\xi,\\eta)\\,x_i$ and $y(\\xi,\\eta)=\\sum_{i=1}^{4}N_i(\\xi,\\eta)\\,y_i$.\n-   **Jacobian Matrix**: $\\mathbf{J}(\\xi,\\eta)=\\begin{bmatrix}\\partial x/\\partial \\xi & \\partial x/\\partial \\eta \\\\ \\partial y/\\partial \\xi & \\partial y/\\partial \\eta\\end{bmatrix}$.\n-   **Hierarchical Interior Bubble Mode**: $\\hat{N}(\\xi,\\eta)=(1-\\xi^2)(1-\\eta^2)$.\n-   **Elemental Stiffness Integral**: $K_b=\\int_{-1}^{1}\\int_{-1}^{1} \\nabla_{\\boldsymbol{x}} \\hat{N}(\\xi,\\eta)\\cdot \\nabla_{\\boldsymbol{x}} \\hat{N}(\\xi,\\eta)\\,\\det\\mathbf{J}(\\xi,\\eta)\\,d\\xi\\,d\\eta$.\n-   **Gradient Transformation**: $\\nabla_{\\boldsymbol{x}} \\hat{N}=\\mathbf{J}^{-T}\\nabla_{\\boldsymbol{\\xi}}\\hat{N}$.\n-   **Approximate Stiffness Integral**: $K_b^{(0)}$ is calculated by replacing $\\mathbf{J}(\\xi,\\eta)$ with $\\mathbf{J}(0,0)$ in the stiffness integral.\n-   **Objective**: Calculate the ratio $R=K_b/K_b^{(0)}$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is well-defined and grounded in the standard theory of the Finite Element Method (FEM). All concepts—isoparametric mapping, shape functions, Jacobian of transformation, hierarchical basis functions, and stiffness matrix computation—are fundamental to computational mechanics. The given data are complete and self-contained.\n\nTo ensure the problem is well-posed, we must check the validity of the isoparametric mapping. The mapping is valid if the Jacobian determinant, $\\det\\mathbf{J}$, does not become zero or negative within the element domain $[-1,1] \\times [-1,1]$. I will compute this as part of the solution. If $\\det\\mathbf{J} > 0$ for all $(\\xi,\\eta)$ in the domain, the mapping is one-to-one, and the problem is well-posed. The problem is objective and free of any scientific or factual unsoundness.\n\n### Step 3: Verdict and Action\nThe problem is deemed **valid**. I will proceed with the detailed solution.\n\n### Derivation of the Isoparametric Mapping and Jacobian\nThe physical coordinates $(x,y)$ are given by the isoparametric mapping:\n$x(\\xi,\\eta) = \\sum_{i=1}^{4} N_i(\\xi,\\eta) x_i$\n$y(\\xi,\\eta) = \\sum_{i=1}^{4} N_i(\\xi,\\eta) y_i$\n\nSubstituting the nodal coordinates and shape functions:\n$x(\\xi,\\eta) = \\frac{-0.5}{4}(1-\\xi)(1-\\eta) + \\frac{0.5}{4}(1+\\xi)(1-\\eta) + \\frac{1.5}{4}(1+\\xi)(1+\\eta) + \\frac{-1.5}{4}(1-\\xi)(1+\\eta)$\nIt is convenient to group the terms by the basis functions of the form $1, \\xi, \\eta, \\xi\\eta$:\n$x(\\xi,\\eta) = \\frac{1}{4}(-0.5+0.5+1.5-1.5) + \\frac{1}{4}(0.5+0.5+1.5+1.5)\\xi + \\frac{1}{4}(0.5-0.5+1.5-1.5)\\eta + \\frac{1}{4}(-0.5-0.5+1.5+1.5)\\xi\\eta$\n$x(\\xi,\\eta) = \\frac{1}{4}(0) + \\frac{1}{4}(4)\\xi + \\frac{1}{4}(0)\\eta + \\frac{1}{4}(2)\\xi\\eta = \\xi + \\frac{1}{2}\\xi\\eta$\n\nSimilarly for $y(\\xi,\\eta)$:\n$y(\\xi,\\eta) = \\frac{-1}{4}(1-\\xi)(1-\\eta) + \\frac{-1}{4}(1+\\xi)(1-\\eta) + \\frac{1}{4}(1+\\xi)(1+\\eta) + \\frac{1}{4}(1-\\xi)(1+\\eta)$\n$y(\\xi,\\eta) = \\frac{1}{4}(-1-1+1+1) + \\frac{1}{4}(1-1+1-1)\\xi + \\frac{1}{4}(1+1+1+1)\\eta + \\frac{1}{4}(-1+1+1-1)\\xi\\eta$\n$y(\\xi,\\eta) = \\frac{1}{4}(0) + \\frac{1}{4}(0)\\xi + \\frac{1}{4}(4)\\eta + \\frac{1}{4}(0)\\xi\\eta = \\eta$\n\nThe mapping is $x(\\xi,\\eta) = \\xi(1+\\frac{1}{2}\\eta)$ and $y(\\xi,\\eta) = \\eta$.\n\nNext, we compute the components of the Jacobian matrix $\\mathbf{J}(\\xi,\\eta)$:\n$\\frac{\\partial x}{\\partial \\xi} = 1 + \\frac{1}{2}\\eta$\n$\\frac{\\partial x}{\\partial \\eta} = \\frac{1}{2}\\xi$\n$\\frac{\\partial y}{\\partial \\xi} = 0$\n$\\frac{\\partial y}{\\partial \\eta} = 1$\nSo, the Jacobian matrix is:\n$$\n\\mathbf{J}(\\xi,\\eta) = \\begin{pmatrix} 1 + \\frac{1}{2}\\eta & \\frac{1}{2}\\xi \\\\ 0 & 1 \\end{pmatrix}\n$$\nThe determinant of the Jacobian is:\n$$\n\\det\\mathbf{J}(\\xi,\\eta) = \\left(1 + \\frac{1}{2}\\eta\\right)(1) - \\left(\\frac{1}{2}\\xi\\right)(0) = 1 + \\frac{1}{2}\\eta\n$$\nFor $\\eta \\in [-1,1]$, $\\det\\mathbf{J}$ ranges from $1 - 1/2 = 1/2$ to $1 + 1/2 = 3/2$. Since $\\det\\mathbf{J} > 0$ throughout the parent element, the mapping is valid.\n\n### Derivation of the Gradient of the Bubble Mode\nThe hierarchical bubble mode is $\\hat{N}(\\xi,\\eta)=(1-\\xi^2)(1-\\eta^2)$. Its gradient in reference coordinates $\\boldsymbol{\\xi}=(\\xi,\\eta)$ is:\n$$\n\\nabla_{\\boldsymbol{\\xi}}\\hat{N} = \\begin{pmatrix} \\frac{\\partial \\hat{N}}{\\partial \\xi} \\\\ \\frac{\\partial \\hat{N}}{\\partial \\eta} \\end{pmatrix} = \\begin{pmatrix} -2\\xi(1-\\eta^2) \\\\ -2\\eta(1-\\xi^2) \\end{pmatrix}\n$$\nThe gradient in physical coordinates $\\boldsymbol{x}=(x,y)$ is $\\nabla_{\\boldsymbol{x}}\\hat{N} = \\mathbf{J}^{-T}\\nabla_{\\boldsymbol{\\xi}}\\hat{N}$.\n$$\n\\mathbf{J}^{-1} = \\frac{1}{\\det\\mathbf{J}}\\begin{pmatrix} 1 & -\\frac{1}{2}\\xi \\\\ 0 & 1 + \\frac{1}{2}\\eta \\end{pmatrix} = \\frac{1}{1 + \\frac{1}{2}\\eta}\\begin{pmatrix} 1 & -\\frac{1}{2}\\xi \\\\ 0 & 1 + \\frac{1}{2}\\eta \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{1 + \\frac{1}{2}\\eta} & -\\frac{\\xi/2}{1 + \\frac{1}{2}\\eta} \\\\ 0 & 1 \\end{pmatrix}\n$$\n$$\n\\mathbf{J}^{-T} = (\\mathbf{J}^{-1})^T = \\begin{pmatrix} \\frac{1}{1 + \\frac{1}{2}\\eta} & 0 \\\\ -\\frac{\\xi/2}{1 + \\frac{1}{2}\\eta} & 1 \\end{pmatrix}\n$$\nNow we compute $\\nabla_{\\boldsymbol{x}}\\hat{N}$:\n$$\n\\nabla_{\\boldsymbol{x}}\\hat{N} = \\begin{pmatrix} \\frac{1}{1 + \\frac{1}{2}\\eta} & 0 \\\\ -\\frac{\\xi/2}{1 + \\frac{1}{2}\\eta} & 1 \\end{pmatrix} \\begin{pmatrix} -2\\xi(1-\\eta^2) \\\\ -2\\eta(1-\\xi^2) \\end{pmatrix} = \\begin{pmatrix} \\frac{-2\\xi(1-\\eta^2)}{1 + \\eta/2} \\\\ \\frac{\\xi^2(1-\\eta^2)}{1+\\eta/2} - 2\\eta(1-\\xi^2) \\end{pmatrix}\n$$\n\n### Evaluation of Exact Stiffness $K_b$\nThe stiffness term is given by $K_b = \\int_{-1}^{1}\\int_{-1}^{1} (\\nabla_{\\boldsymbol{x}} \\hat{N} \\cdot \\nabla_{\\boldsymbol{x}} \\hat{N}) \\det\\mathbf{J} \\,d\\xi d\\eta$.\nThe integrand can be simplified using the identity $(\\nabla_{\\boldsymbol{x}} \\hat{N} \\cdot \\nabla_{\\boldsymbol{x}} \\hat{N}) \\det\\mathbf{J} = \\nabla_{\\boldsymbol{\\xi}}\\hat{N}^T \\mathbf{J}^{-1}\\mathbf{J}^{-T} \\nabla_{\\boldsymbol{\\xi}}\\hat{N} \\det\\mathbf{J} = \\nabla_{\\boldsymbol{\\xi}}\\hat{N}^T (\\mathbf{J}^T\\mathbf{J})^{-1} \\nabla_{\\boldsymbol{\\xi}}\\hat{N} \\det\\mathbf{J}$.\nA more direct form is:\nIntegrand $I(\\xi, \\eta) = \\frac{1}{\\det\\mathbf{J}} \\left[ \\left(\\frac{\\partial y}{\\partial \\eta}\\frac{\\partial \\hat{N}}{\\partial \\xi} - \\frac{\\partial y}{\\partial \\xi}\\frac{\\partial \\hat{N}}{\\partial \\eta}\\right)^2 + \\left(-\\frac{\\partial x}{\\partial \\eta}\\frac{\\partial \\hat{N}}{\\partial \\xi} + \\frac{\\partial x}{\\partial \\xi}\\frac{\\partial \\hat{N}}{\\partial \\eta}\\right)^2 \\right]$\nSubstituting the derivatives:\n$A = \\frac{\\partial y}{\\partial \\eta}\\frac{\\partial \\hat{N}}{\\partial \\xi} - \\frac{\\partial y}{\\partial \\xi}\\frac{\\partial \\hat{N}}{\\partial \\eta} = (1)(-2\\xi(1-\\eta^2)) - (0)(\\dots) = -2\\xi(1-\\eta^2)$\n$B = -\\frac{\\partial x}{\\partial \\eta}\\frac{\\partial \\hat{N}}{\\partial \\xi} + \\frac{\\partial x}{\\partial \\xi}\\frac{\\partial \\hat{N}}{\\partial \\eta} = -(\\frac{\\xi}{2})(-2\\xi(1-\\eta^2)) + (1+\\frac{\\eta}{2})(-2\\eta(1-\\xi^2)) = \\xi^2(1-\\eta^2) - (2\\eta+\\eta^2)(1-\\xi^2)$\n$B = \\xi^2 - \\xi^2\\eta^2 - 2\\eta + 2\\eta\\xi^2 - \\eta^2 + \\eta^2\\xi^2 = \\xi^2(1+2\\eta) - \\eta(2+\\eta)$\n\nThe integral is $K_b = \\int_{-1}^{1}\\int_{-1}^{1} \\frac{A^2+B^2}{1+\\eta/2} d\\xi d\\eta$. We first integrate with respect to $\\xi$:\n$\\int_{-1}^1 A^2 d\\xi = \\int_{-1}^1 4\\xi^2(1-\\eta^2)^2 d\\xi = 4(1-\\eta^2)^2 [\\frac{\\xi^3}{3}]_{-1}^1 = \\frac{8}{3}(1-\\eta^2)^2$.\n$\\int_{-1}^1 B^2 d\\xi = \\int_{-1}^1 [\\xi^2(1+2\\eta) - \\eta(2+\\eta)]^2 d\\xi$\n$= (1+2\\eta)^2 \\int_{-1}^1 \\xi^4 d\\xi - 2\\eta(1+2\\eta)(2+\\eta) \\int_{-1}^1 \\xi^2 d\\xi + \\eta^2(2+\\eta)^2 \\int_{-1}^1 d\\xi$\n$= \\frac{2}{5}(1+2\\eta)^2 - \\frac{4}{3}\\eta(1+2\\eta)(2+\\eta) + 2\\eta^2(2+\\eta)^2$\nExpanding and collecting terms in powers of $\\eta$ gives:\n$\\int_{-1}^1 B^2 d\\xi = \\frac{2}{5} - \\frac{16}{15}\\eta + \\frac{44}{15}\\eta^2 + \\frac{16}{3}\\eta^3 + 2\\eta^4$\nThe integral of $A^2+B^2$ over $\\xi$ is:\n$I_\\eta = \\int_{-1}^1 (A^2+B^2) d\\xi = \\frac{8}{3}(1-2\\eta^2+\\eta^4) + \\frac{2}{5} - \\frac{16}{15}\\eta + \\frac{44}{15}\\eta^2 + \\frac{16}{3}\\eta^3 + 2\\eta^4$\n$I_\\eta = (\\frac{8}{3}+\\frac{2}{5}) - \\frac{16}{15}\\eta + (-\\frac{16}{3}+\\frac{44}{15})\\eta^2 + \\frac{16}{3}\\eta^3 + (\\frac{8}{3}+2)\\eta^4$\n$I_\\eta = \\frac{46}{15} - \\frac{16}{15}\\eta - \\frac{36}{15}\\eta^2 + \\frac{16}{3}\\eta^3 + \\frac{14}{3}\\eta^4 = \\frac{46}{15} - \\frac{16}{15}\\eta - \\frac{12}{5}\\eta^2 + \\frac{16}{3}\\eta^3 + \\frac{14}{3}\\eta^4$\n\nNow we must evaluate $K_b = \\int_{-1}^{1} \\frac{I_\\eta}{1+\\eta/2} d\\eta = 2 \\int_{-1}^{1} \\frac{I_\\eta}{\\eta+2} d\\eta$.\nUsing polynomial long division (or synthetic division with root $-2$) for $P(\\eta)=I_\\eta$:\n$I_\\eta = (\\eta+2) \\left(\\frac{14}{3}\\eta^3 - 4\\eta^2 + \\frac{28}{5}\\eta - \\frac{184}{15}\\right) + \\frac{138}{5}$\nThe integral becomes:\n$K_b = 2 \\int_{-1}^{1} \\left( \\frac{14}{3}\\eta^3 - 4\\eta^2 + \\frac{28}{5}\\eta - \\frac{184}{15} + \\frac{138/5}{\\eta+2} \\right) d\\eta$\nOver the symmetric interval $[-1,1]$, the integrals of the odd powers $\\eta^3$ and $\\eta$ are zero.\n$K_b = 2 \\left[ -4\\frac{\\eta^3}{3} - \\frac{184}{15}\\eta + \\frac{138}{5}\\ln|\\eta+2| \\right]_{-1}^{1}$\n$K_b = 2 \\left( \\left(-\\frac{4}{3} - \\frac{184}{15}\\right) - \\left(\\frac{4}{3} + \\frac{184}{15}\\right) \\right) + 2 \\left( \\frac{138}{5}(\\ln(3) - \\ln(1)) \\right)$\n$K_b = 2 \\left( -2\\left(\\frac{4}{3} + \\frac{184}{15}\\right) \\right) + \\frac{276}{5}\\ln(3)$\n$K_b = -4\\left(\\frac{20+184}{15}\\right) + \\frac{276}{5}\\ln(3) = -4\\left(\\frac{204}{15}\\right) + \\frac{276}{5}\\ln(3) = -\\frac{816}{15} + \\frac{276}{5}\\ln(3)$\n$K_b = -\\frac{272}{5} + \\frac{276}{5}\\ln(3) = \\frac{4}{5}(69\\ln(3) - 68)$\n\n### Evaluation of Approximate Stiffness $K_b^{(0)}$\nFor the approximation, we use $\\mathbf{J}_0 = \\mathbf{J}(0,0)$ and $\\det\\mathbf{J}_0 = \\det\\mathbf{J}(0,0)$.\nAt $(\\xi,\\eta)=(0,0)$, $\\mathbf{J}_0 = \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix} = \\mathbf{I}$, and $\\det\\mathbf{J}_0 = 1$.\nThe approximate stiffness is:\n$K_b^{(0)} = \\int_{-1}^{1}\\int_{-1}^{1} (\\nabla_{\\boldsymbol{x}}\\hat{N} \\cdot \\nabla_{\\boldsymbol{x}}\\hat{N}) \\det\\mathbf{J}_0 d\\xi d\\eta$ where $\\nabla_{\\boldsymbol{x}}\\hat{N} = \\mathbf{J}_0^{-T}\\nabla_{\\boldsymbol{\\xi}}\\hat{N} = \\mathbf{I}\\nabla_{\\boldsymbol{\\xi}}\\hat{N} = \\nabla_{\\boldsymbol{\\xi}}\\hat{N}$.\n$K_b^{(0)} = \\int_{-1}^{1}\\int_{-1}^{1} (\\nabla_{\\boldsymbol{\\xi}}\\hat{N} \\cdot \\nabla_{\\boldsymbol{\\xi}}\\hat{N}) (1) d\\xi d\\eta = \\int_{-1}^{1}\\int_{-1}^{1} \\left( \\left(\\frac{\\partial\\hat{N}}{\\partial\\xi}\\right)^2 + \\left(\\frac{\\partial\\hat{N}}{\\partial\\eta}\\right)^2 \\right) d\\xi d\\eta$\nWe evaluate the two terms separately:\n$\\int_{-1}^{1}\\int_{-1}^{1} \\left(\\frac{\\partial\\hat{N}}{\\partial\\xi}\\right)^2 d\\xi d\\eta = \\int_{-1}^{1}\\int_{-1}^{1} (-2\\xi(1-\\eta^2))^2 d\\xi d\\eta = 4 \\left(\\int_{-1}^1 \\xi^2 d\\xi\\right) \\left(\\int_{-1}^1 (1-\\eta^2)^2 d\\eta\\right)$\n$\\int_{-1}^1 \\xi^2 d\\xi = \\frac{2}{3}$\n$\\int_{-1}^1 (1-\\eta^2)^2 d\\eta = \\int_{-1}^1 (1-2\\eta^2+\\eta^4)d\\eta = \\left[\\eta - \\frac{2\\eta^3}{3} + \\frac{\\eta^5}{5}\\right]_{-1}^1 = 2(1 - \\frac{2}{3} + \\frac{1}{5}) = 2(\\frac{15-10+3}{15}) = \\frac{16}{15}$\nSo, the first integral is $4(\\frac{2}{3})(\\frac{16}{15}) = \\frac{128}{45}$.\nBy symmetry, $\\int_{-1}^{1}\\int_{-1}^{1} (\\frac{\\partial\\hat{N}}{\\partial\\eta})^2 d\\xi d\\eta = \\frac{128}{45}$.\n$K_b^{(0)} = \\frac{128}{45} + \\frac{128}{45} = \\frac{256}{45}$.\n\n### Calculation of the Ratio $R$\nThe ratio is $R = \\frac{K_b}{K_b^{(0)}}$.\n$$\nR = \\frac{\\frac{4}{5}(69\\ln(3) - 68)}{\\frac{256}{45}} = \\frac{4}{5} \\cdot \\frac{45}{256} (69\\ln(3) - 68)\n$$\n$$\nR = \\left(\\frac{4}{256}\\right) \\left(\\frac{45}{5}\\right) (69\\ln(3) - 68) = \\left(\\frac{1}{64}\\right) (9) (69\\ln(3) - 68) = \\frac{9}{64}(69\\ln(3) - 68)\n$$\nThis is the final closed-form analytic expression for the ratio $R$.", "answer": "$$\\boxed{\\frac{9}{64}(69\\ln(3) - 68)}$$", "id": "3570976"}]}