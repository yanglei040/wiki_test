{"hands_on_practices": [{"introduction": "The foundation of the isoparametric finite element method lies in the mapping from a simple parent domain to the physical element. The quality of this transformation is quantified by its Jacobian determinant, $J$. This exercise [@problem_id:3549774] provides a direct, analytical exploration of how geometric distortion in a simple quadrilateral element affects the positivity and boundedness of $J$, and in turn, how these properties are essential prerequisites for ensuring a valid, convergent formulation.", "problem": "Consider an isoparametric bilinear quadrilateral element ($Q4$) used in the Finite Element Method (FEM). The parent domain is the square with natural coordinates $(\\xi,\\eta) \\in [-1,1] \\times [-1,1]$, and the element mapping to the physical domain is defined by the bilinear shape functions $N_{i}(\\xi,\\eta)$ and the physical corner node coordinates $(x_{i},y_{i})$ for $i=1,2,3,4$. The bilinear shape functions are\n$$\nN_{1}(\\xi,\\eta) = \\frac{1}{4}(1-\\xi)(1-\\eta),\\quad\nN_{2}(\\xi,\\eta) = \\frac{1}{4}(1+\\xi)(1-\\eta),\\quad\nN_{3}(\\xi,\\eta) = \\frac{1}{4}(1+\\xi)(1+\\eta),\\quad\nN_{4}(\\xi,\\eta) = \\frac{1}{4}(1-\\xi)(1+\\eta).\n$$\nLet the physical corner node coordinates be\n$$\n(x_{1},y_{1})=(0,0),\\quad (x_{2},y_{2})=(2,0),\\quad (x_{3},y_{3})=(2(1+\\alpha),1),\\quad (x_{4},y_{4})=(0,1),\n$$\nwhere $\\alpha \\ge 0$ is a dimensionless distortion parameter that shifts the top right corner horizontally. The isoparametric mapping is\n$$\nx(\\xi,\\eta) = \\sum_{i=1}^{4} N_{i}(\\xi,\\eta)\\, x_{i},\\qquad y(\\xi,\\eta) = \\sum_{i=1}^{4} N_{i}(\\xi,\\eta)\\, y_{i}.\n$$\nDefine the Jacobian matrix of the mapping as\n$$\n\\mathbf{F}(\\xi,\\eta) = \n\\begin{pmatrix}\n\\frac{\\partial x}{\\partial \\xi} & \\frac{\\partial x}{\\partial \\eta} \\\\\n\\frac{\\partial y}{\\partial \\xi} & \\frac{\\partial y}{\\partial \\eta}\n\\end{pmatrix},\n$$\nand its determinant as $J(\\xi,\\eta) = \\det \\mathbf{F}(\\xi,\\eta)$. Starting from the definitions above:\n- Derive the explicit expression for $J(\\xi,\\eta)$ as a function of $\\alpha$, $\\xi$, and $\\eta$.\n- Using first principles of isoparametric mappings, analyze conditions ensuring positivity $J(\\xi,\\eta)>0$ over the entire parent domain and boundedness quantified by the ratio $J_{\\max}/J_{\\min}$, where $J_{\\min}=\\min_{(\\xi,\\eta)\\in[-1,1]^{2}} J(\\xi,\\eta)$ and $J_{\\max}=\\max_{(\\xi,\\eta)\\in[-1,1]^{2}} J(\\xi,\\eta)$.\n- Explain how positivity and boundedness of $J$ relate to completeness (the ability to represent linear fields), compatibility (continuity of displacement across element boundaries), and convergence (error reduction with mesh refinement), focusing on the amplification of interpolation error via the mapping and its effect on convergence rates.\n\nSuppose, for acceptable element quality in a convergence study, the boundedness requirement is set to\n$$\n\\frac{J_{\\max}}{J_{\\min}} \\le \\kappa_{\\max},\\quad \\kappa_{\\max} = 2.\n$$\nDetermine the largest allowable distortion parameter $\\alpha^{\\star}$ such that both positivity and the boundedness condition hold. Express the final answer for $\\alpha^{\\star}$ as a dimensionless number. No rounding is required.", "solution": "The problem as stated is scientifically sound, well-posed, and contains all necessary information for a unique solution. The concepts of isoparametric mapping, the Jacobian of the transformation, and its properties are central to the theory of the Finite Element Method (FEM). This problem investigates these concepts for a specific bilinear quadrilateral element.\n\nThe solution proceeds in four stages: first, we derive the explicit expression for the Jacobian determinant $J(\\xi,\\eta)$; second, we analyze the conditions for its positivity and boundedness; third, we discuss the implications for the core FEM properties of completeness, compatibility, and convergence; and fourth, we calculate the maximum allowable distortion parameter $\\alpha^{\\star}$ based on the given criteria.\n\nFirst, we determine the mapping from the parent domain coordinates $(\\xi, \\eta)$ to the physical domain coordinates $(x,y)$. The mapping is given by\n$$x(\\xi,\\eta) = \\sum_{i=1}^{4} N_{i}(\\xi,\\eta)\\, x_{i}$$\n$$y(\\xi,\\eta) = \\sum_{i=1}^{4} N_{i}(\\xi,\\eta)\\, y_{i}$$\nThe shape functions $N_i$ and nodal coordinates $(x_i, y_i)$ are provided.\nFor the $x$-coordinate, substituting the given values $x_{1}=0$, $x_{2}=2$, $x_{3}=2(1+\\alpha)$, and $x_{4}=0$:\n$$x(\\xi,\\eta) = N_{2}(\\xi,\\eta) (2) + N_{3}(\\xi,\\eta) (2(1+\\alpha))$$\n$$x(\\xi,\\eta) = \\frac{1}{4}(1+\\xi)(1-\\eta)(2) + \\frac{1}{4}(1+\\xi)(1+\\eta)(2(1+\\alpha))$$\n$$x(\\xi,\\eta) = \\frac{1}{2}(1+\\xi) \\left[ (1-\\eta) + (1+\\alpha)(1+\\eta) \\right]$$\n$$x(\\xi,\\eta) = \\frac{1}{2}(1+\\xi) \\left[ 1 - \\eta + 1 + \\eta + \\alpha(1+\\eta) \\right]$$\n$$x(\\xi,\\eta) = \\frac{1}{2}(1+\\xi) \\left[ 2 + \\alpha(1+\\eta) \\right] = (1+\\xi)\\left(1 + \\frac{\\alpha}{2}(1+\\eta)\\right)$$\nFor the $y$-coordinate, substituting the given values $y_{1}=0$, $y_{2}=0$, $y_{3}=1$, and $y_{4}=1$:\n$$y(\\xi,\\eta) = N_{3}(\\xi,\\eta) (1) + N_{4}(\\xi,\\eta) (1)$$\n$$y(\\xi,\\eta) = \\frac{1}{4}(1+\\xi)(1+\\eta) + \\frac{1}{4}(1-\\xi)(1+\\eta)$$\n$$y(\\xi,\\eta) = \\frac{1+\\eta}{4} \\left[ (1+\\xi) + (1-\\xi) \\right] = \\frac{1+\\eta}{4}(2) = \\frac{1}{2}(1+\\eta)$$\nNext, we compute the components of the Jacobian matrix $\\mathbf{F}(\\xi,\\eta)$ by taking partial derivatives of $x(\\xi,\\eta)$ and $y(\\xi,\\eta)$ with respect to $\\xi$ and $\\eta$.\n$$\\frac{\\partial x}{\\partial \\xi} = \\frac{\\partial}{\\partial \\xi} \\left[ (1+\\xi)\\left(1 + \\frac{\\alpha}{2}(1+\\eta)\\right) \\right] = 1 + \\frac{\\alpha}{2}(1+\\eta)$$\n$$\\frac{\\partial x}{\\partial \\eta} = \\frac{\\partial}{\\partial \\eta} \\left[ (1+\\xi)\\left(1 + \\frac{\\alpha}{2}(1+\\eta)\\right) \\right] = (1+\\xi)\\frac{\\alpha}{2}$$\n$$\\frac{\\partial y}{\\partial \\xi} = \\frac{\\partial}{\\partial \\xi} \\left[ \\frac{1}{2}(1+\\eta) \\right] = 0$$\n$$\\frac{\\partial y}{\\partial \\eta} = \\frac{\\partial}{\\partial \\eta} \\left[ \\frac{1}{2}(1+\\eta) \\right] = \\frac{1}{2}$$\nThe Jacobian matrix is therefore\n$$\n\\mathbf{F}(\\xi,\\eta) = \n\\begin{pmatrix}\n1 + \\frac{\\alpha}{2}(1+\\eta) & \\frac{\\alpha}{2}(1+\\xi) \\\\\n0 & \\frac{1}{2}\n\\end{pmatrix}\n$$\nThe Jacobian determinant, $J(\\xi,\\eta) = \\det \\mathbf{F}(\\xi,\\eta)$, is calculated as:\n$$J(\\xi,\\eta) = \\left( 1 + \\frac{\\alpha}{2}(1+\\eta) \\right) \\left( \\frac{1}{2} \\right) - \\left( \\frac{\\alpha}{2}(1+\\xi) \\right) (0)$$\n$$J(\\xi,\\eta) = \\frac{1}{2} + \\frac{\\alpha}{4}(1+\\eta)$$\nThis is the explicit expression for the Jacobian determinant. Note that it is independent of $\\xi$.\n\nNow, we analyze the positivity and boundedness of $J(\\xi,\\eta)$ on the parent domain $(\\xi,\\eta) \\in [-1,1] \\times [-1,1]$. The parameter $\\alpha$ is given as $\\alpha \\ge 0$.\nThe positivity condition requires $J(\\xi,\\eta) > 0$ for all $(\\xi,\\eta)$ in the domain. To check this, we find the minimum value of $J$, denoted $J_{\\min}$. Since $\\alpha \\ge 0$, $J(\\xi,\\eta)$ is a non-decreasing function of $\\eta$. Thus, its minimum value occurs at the minimum value of $\\eta$, which is $\\eta = -1$.\n$$J_{\\min} = \\min_{(\\xi,\\eta)\\in[-1,1]^{2}} J(\\xi,\\eta) = J(\\xi, -1) = \\frac{1}{2} + \\frac{\\alpha}{4}(1 - 1) = \\frac{1}{2}$$\nSince $J_{\\min} = 1/2$, which is strictly positive, the condition $J(\\xi,\\eta) > 0$ is satisfied for all $\\alpha \\ge 0$ over the entire parent element. This ensures that the isoparametric mapping is always non-singular and one-to-one for this family of elements.\nFor the boundedness analysis, we need the maximum value of $J$, denoted $J_{\\max}$. Since $J$ is non-decreasing with $\\eta$, its maximum occurs at $\\eta = 1$.\n$$J_{\\max} = \\max_{(\\xi,\\eta)\\in[-1,1]^{2}} J(\\xi,\\eta) = J(\\xi, 1) = \\frac{1}{2} + \\frac{\\alpha}{4}(1 + 1) = \\frac{1}{2} + \\frac{\\alpha}{2}$$\nThe boundedness is quantified by the ratio $J_{\\max}/J_{\\min}$:\n$$\\frac{J_{\\max}}{J_{\\min}} = \\frac{\\frac{1}{2} + \\frac{\\alpha}{2}}{\\frac{1}{2}} = 1 + \\alpha$$\n\nNext, we relate these properties of the Jacobian to the concepts of completeness, compatibility, and convergence in FEM.\n**Completeness** requires that an element's shape functions can exactly represent any linear displacement field (a constant strain state). For the bilinear Q4 element, the shape functions are constructed to satisfy $\\sum_{i=1}^{4} N_{i} = 1$ and can reproduce any function of the form $a+bx+cy$. This property is inherent to the shape functions and ensures the element passes the patch test, a necessary condition for convergence. The role of the Jacobian here is secondary but fundamental: a valid, invertible mapping ($J > 0$) is required to uniquely relate the physical space $(x,y)$ to the parent space $(\\xi,\\eta)$, which is a prerequisite for the entire formulation to be meaningful.\n**Compatibility** requires that the displacement field is continuous across inter-element boundaries. For isoparametric elements, using the same shape functions for geometry and displacements guarantees this. The mapping of a common edge between two elements is defined only by the coordinates of the nodes on that edge. If two elements share these nodes, they share the identical physical boundary, and the displacement field, interpolated along this edge by the same nodal values, will be continuous. A positive Jacobian ($J>0$) throughout the element, including its boundary, ensures a non-degenerate geometry where elements do not overlap or fold, which is essential for constituting a valid, compatible mesh.\n**Convergence** refers to the error in the numerical solution diminishing as the mesh is refined. Error estimates in FEM show that the approximation error is bounded by a constant $C$ that depends on the element geometry, among other factors. This constant $C$ is adversely affected by element distortion from its ideal shape (a square in the parent domain). For an isoparametric mapping, the norms of the Jacobian matrix $\\mathbf{F}$ and its inverse $\\mathbf{F}^{-1}$ appear in this constant. A large variation in the Jacobian determinant $J$ within an element is a sign of high distortion. The ratio $J_{\\max}/J_{\\min}$ is a common metric for this distortion. If this ratio is large, the constant $C$ in the error bound can become large, leading to poor accuracy for a given mesh size $h$. For convergence at the optimal theoretical rate, it is necessary that this ratio remains bounded for all elements in a sequence of refined meshes. A singularity ($J=0$) corresponds to an infinite ratio, breaking down the error estimates and leading to a failure of convergence.\n\nFinally, we determine the largest allowable distortion parameter $\\alpha^{\\star}$ given the constraint $\\frac{J_{\\max}}{J_{\\min}} \\le \\kappa_{\\max}$, with $\\kappa_{\\max} = 2$.\nWe have already found the positivity condition $J>0$ is always satisfied for $\\alpha \\ge 0$.\nThe boundedness condition is:\n$$\\frac{J_{\\max}}{J_{\\min}} \\le 2$$\nSubstituting our derived expression for the ratio:\n$$1 + \\alpha \\le 2$$\nThis simplifies to:\n$$\\alpha \\le 1$$\nSince the problem specifies $\\alpha \\ge 0$, the acceptable range for the distortion parameter is $0 \\le \\alpha \\le 1$. The largest allowable value, $\\alpha^{\\star}$, is the upper bound of this range.\n$$\\alpha^{\\star} = 1$$", "answer": "$$\\boxed{1}$$", "id": "3549774"}, {"introduction": "A stable finite element formulation must penalize all non-rigid-body motions with strain energy. However, numerical shortcuts like reduced-order quadrature can inadvertently introduce spurious, zero-energy \"hourglass\" modes, violating stability and rendering the solution physically meaningless. In this practice [@problem_id:3549776], you will deconstruct an underintegrated quadrilateral element to explicitly identify these pathological modes and understand why their existence undermines the convergence guarantees of the method.", "problem": "Consider a two-dimensional, linear elastic, plane strain quadrilateral finite element with four nodes ($Q4$ element) defined over the parent coordinates $(\\xi,\\eta) \\in [-1,1]\\times[-1,1]$. The node ordering is $1:(-1,-1)$, $2:(+1,-1)$, $3:(+1,+1)$, $4:(-1,+1)$. The element uses bilinear interpolation for the displacement field $\\boldsymbol{u}(\\xi,\\eta) = u(\\xi,\\eta)\\,\\boldsymbol{e}_x + v(\\xi,\\eta)\\,\\boldsymbol{e}_y$, where $u(\\xi,\\eta)$ and $v(\\xi,\\eta)$ are interpolated from nodal values via four shape functions $N_i(\\xi,\\eta)$ that form a partition of unity and satisfy the Kronecker-delta interpolation property at the nodes. Assume a rectangular mapping to physical coordinates with unit Jacobian at $(\\xi,\\eta)=(0,0)$ so that derivatives with respect to physical coordinates equal derivatives with respect to the parent coordinates at the element center. The strain is computed under the small-strain kinematics, with the strain vector defined as $\\boldsymbol{\\varepsilon} = \\begin{pmatrix} \\varepsilon_{xx} & \\varepsilon_{yy} & \\gamma_{xy} \\end{pmatrix}^{\\mathsf{T}}$ using the standard definitions $\\varepsilon_{xx} = \\partial u/\\partial x$, $\\varepsilon_{yy} = \\partial v/\\partial y$, and $\\gamma_{xy} = \\partial u/\\partial y + \\partial v/\\partial x$. The element stiffness uses one-point Gaussian quadrature at the center $(\\xi,\\eta)=(0,0)$ (underintegration). The material is homogeneous, isotropic, and linearly elastic, but you should keep all material parameters symbolic.\n\nStarting from these fundamentals, do the following:\n\n1. Derive the discrete strain operator $\\boldsymbol{B}$ at $(\\xi,\\eta)=(0,0)$ in terms of the four nodal displacement components $u_i$ and $v_i$ ($i=1,\\dots,4$). Express $\\varepsilon_{xx}$, $\\varepsilon_{yy}$, and $\\gamma_{xy}$ at the center as linear forms of the nodal values. Use only the properties of bilinear shape functions and their derivatives at the center implied by the node locations; do not assume any formula not derivable from these properties.\n\n2. Determine all nontrivial nodal displacement patterns $(u_1,v_1,u_2,v_2,u_3,v_3,u_4,v_4)$ that lie in the kernel of $\\boldsymbol{B}$ and are not rigid body modes (two translations and one in-plane rotation). Identify and construct explicitly the hourglass modes as zero-energy kinematic patterns introduced by underintegration for this $Q4$ element, and show that they produce $\\boldsymbol{\\varepsilon}=\\boldsymbol{0}$ at $(\\xi,\\eta)=(0,0)$ while being non-rigid.\n\n3. Explain, using the principles of completeness, compatibility, and convergence, why these hourglass modes violate compatibility and stability, and how underintegration causes the loss of coercivity of the discrete bilinear form. Ground your explanation in the variational structure of the finite element method (Finite Element Method (FEM)) and the role of adequate quadrature.\n\n4. Focus on the hourglass mode defined by $u$-displacements alternating as $+1,-1,+1,-1$ at nodes $1,2,3,4$ respectively, with $v$-displacements all zero. Normalize its corresponding $8$-component nodal displacement vector to have Euclidean norm equal to $1$, and report the normalized vector in the ordering $(u_1,v_1,u_2,v_2,u_3,v_3,u_4,v_4)$.\n\nNo numerical values are to be substituted for material parameters. Your final reported result must be the single normalized hourglass mode vector. No rounding is required.", "solution": "The problem is subjected to validation and is found to be scientifically grounded, well-posed, objective, and internally consistent. It represents a standard and fundamental analysis within the field of computational solid mechanics. We may therefore proceed with a complete solution.\n\nThe problem requires a multi-part analysis of a four-node quadrilateral ($Q4$) plane strain finite element, focusing on the pathological effects of underintegration. We will address each part in sequence.\n\n**1. Derivation of the Discrete Strain Operator $\\boldsymbol{B}$ at the Element Center**\n\nThe displacement field $(u,v)$ within the element is interpolated from the nodal displacements $(u_i,v_i)$ using bilinear shape functions $N_i(\\xi,\\eta)$. The displacement at any point $(\\xi,\\eta)$ in the parent domain is given by:\n$$\nu(\\xi,\\eta) = \\sum_{i=1}^{4} N_i(\\xi,\\eta) u_i\n$$\n$$\nv(\\xi,\\eta) = \\sum_{i=1}^{4} N_i(\\xi,\\eta) v_i\n$$\nThe bilinear shape functions for a $Q4$ element with nodes at $(\\xi_i, \\eta_i) \\in \\{(-1,-1), (1,-1), (1,1), (-1,1)\\}$ are defined as:\n$$\nN_i(\\xi,\\eta) = \\frac{1}{4}(1 + \\xi_i\\xi)(1 + \\eta_i\\eta)\n$$\nThe problem states that due to a rectangular mapping with a unit Jacobian at the element center $(\\xi,\\eta)=(0,0)$, the physical derivatives equal the parent coordinate derivatives at this specific point. That is, $\\frac{\\partial}{\\partial x} = \\frac{\\partial}{\\partial \\xi}$ and $\\frac{\\partial}{\\partial y} = \\frac{\\partial}{\\partial \\eta}$ at $(\\xi,\\eta)=(0,0)$.\n\nThe strain components $\\varepsilon_{xx}$, $\\varepsilon_{yy}$, and $\\gamma_{xy}$ are defined by the derivatives of the displacement field. We must first find the derivatives of the shape functions.\n$$\n\\frac{\\partial N_i}{\\partial \\xi} = \\frac{1}{4} \\xi_i (1 + \\eta_i\\eta) \\quad \\implies \\quad \\frac{\\partial N_i}{\\partial \\xi}\\bigg|_{(0,0)} = \\frac{1}{4} \\xi_i\n$$\n$$\n\\frac{\\partial N_i}{\\partial \\eta} = \\frac{1}{4} \\eta_i (1 + \\xi_i\\xi) \\quad \\implies \\quad \\frac{\\partial N_i}{\\partial \\eta}\\bigg|_{(0,0)} = \\frac{1}{4} \\eta_i\n$$\nThe nodal coordinates in the parent domain are $\\xi = (-1, +1, +1, -1)^{\\mathsf{T}}$ and $\\eta = (-1, -1, +1, +1)^{\\mathsf{T}}$ for nodes $i=1,2,3,4$.\n\nNow, we can compute the strain components at the center point $(0,0)$:\n$$\n\\varepsilon_{xx}(0,0) = \\frac{\\partial u}{\\partial x}\\bigg|_{(0,0)} = \\frac{\\partial u}{\\partial \\xi}\\bigg|_{(0,0)} = \\sum_{i=1}^{4} \\frac{\\partial N_i}{\\partial \\xi}\\bigg|_{(0,0)} u_i = \\frac{1}{4} \\sum_{i=1}^{4} \\xi_i u_i\n$$\n$$\n\\varepsilon_{xx}(0,0) = \\frac{1}{4}(-1 \\cdot u_1 + 1 \\cdot u_2 + 1 \\cdot u_3 - 1 \\cdot u_4) = \\frac{1}{4}(-u_1 + u_2 + u_3 - u_4)\n$$\nSimilarly for $\\varepsilon_{yy}$:\n$$\n\\varepsilon_{yy}(0,0) = \\frac{\\partial v}{\\partial y}\\bigg|_{(0,0)} = \\frac{\\partial v}{\\partial \\eta}\\bigg|_{(0,0)} = \\sum_{i=1}^{4} \\frac{\\partial N_i}{\\partial \\eta}\\bigg|_{(0,0)} v_i = \\frac{1}{4} \\sum_{i=1}^{4} \\eta_i v_i\n$$\n$$\n\\varepsilon_{yy}(0,0) = \\frac{1}{4}(-1 \\cdot v_1 - 1 \\cdot v_2 + 1 \\cdot v_3 + 1 \\cdot v_4) = \\frac{1}{4}(-v_1 - v_2 + v_3 + v_4)\n$$\nAnd for the shear strain $\\gamma_{xy}$:\n$$\n\\gamma_{xy}(0,0) = \\frac{\\partial u}{\\partial y}\\bigg|_{(0,0)} + \\frac{\\partial v}{\\partial x}\\bigg|_{(0,0)} = \\frac{\\partial u}{\\partial \\eta}\\bigg|_{(0,0)} + \\frac{\\partial v}{\\partial \\xi}\\bigg|_{(0,0)}\n$$\n$$\n\\gamma_{xy}(0,0) = \\sum_{i=1}^{4} \\frac{\\partial N_i}{\\partial \\eta}\\bigg|_{(0,0)} u_i + \\sum_{i=1}^{4} \\frac{\\partial N_i}{\\partial \\xi}\\bigg|_{(0,0)} v_i = \\frac{1}{4} \\sum_{i=1}^{4} \\eta_i u_i + \\frac{1}{4} \\sum_{i=1}^{4} \\xi_i v_i\n$$\n$$\n\\gamma_{xy}(0,0) = \\frac{1}{4}(-u_1 - u_2 + u_3 + u_4) + \\frac{1}{4}(-v_1 + v_2 + v_3 - v_4)\n$$\nThe discrete strain-displacement relation $\\boldsymbol{\\varepsilon} = \\boldsymbol{B}\\boldsymbol{d}$ relates the strain vector $\\boldsymbol{\\varepsilon} = (\\varepsilon_{xx}, \\varepsilon_{yy}, \\gamma_{xy})^{\\mathsf{T}}$ to the nodal displacement vector $\\boldsymbol{d} = (u_1, v_1, u_2, v_2, u_3, v_3, u_4, v_4)^{\\mathsf{T}}$. From the expressions above, the matrix $\\boldsymbol{B}$ evaluated at the center $(\\xi,\\eta)=(0,0)$ is:\n$$\n\\boldsymbol{B}(0,0) = \\frac{1}{4} \\begin{pmatrix}\n-1 & 0 & 1 & 0 & 1 & 0 & -1 & 0 \\\\\n0 & -1 & 0 & -1 & 0 & 1 & 0 & 1 \\\\\n-1 & -1 & -1 & 1 & 1 & 1 & 1 & -1\n\\end{pmatrix}\n$$\n\n**2. Identification of Hourglass Modes**\n\nHourglass modes are non-rigid-body displacement patterns that produce zero strain at the quadrature point(s). They are vectors in the kernel of the discrete strain operator $\\boldsymbol{B}(0,0)$, excluding the vectors corresponding to rigid body motion. We must find the null space of $\\boldsymbol{B}(0,0)$, i.e., all vectors $\\boldsymbol{d} \\neq \\boldsymbol{0}$ such that $\\boldsymbol{B}(0,0)\\boldsymbol{d} = \\boldsymbol{0}$. This leads to a system of three linear equations:\n$$\n-u_1 + u_2 + u_3 - u_4 = 0 \\quad (1)\n$$\n$$\n-v_1 - v_2 + v_3 + v_4 = 0 \\quad (2)\n$$\n$$\n-u_1 - u_2 + u_3 + u_4 - v_1 + v_2 + v_3 - v_4 = 0 \\quad (3)\n$$\nThe matrix $\\boldsymbol{B}(0,0)$ has rank $3$, so its kernel has dimension $8-3=5$. Three of these dimensions correspond to the rigid body modes (two translations, one in-plane rotation), which produce zero strain everywhere and are thus necessarily in the kernel of $\\boldsymbol{B}(0,0)$. The remaining $5-3=2$ dimensions correspond to the hourglass modes.\n\nThe rigid body modes are:\n1.  **Translation in x-direction**: $\\boldsymbol{d}_{R1} = (1, 0, 1, 0, 1, 0, 1, 0)^{\\mathsf{T}}$.\n2.  **Translation in y-direction**: $\\boldsymbol{d}_{R2} = (0, 1, 0, 1, 0, 1, 0, 1)^{\\mathsf{T}}$.\n3.  **In-plane rotation**: For a square element, nodal displacements for a small rotation are $\\boldsymbol{u} \\propto (-\\eta_i)$ and $\\boldsymbol{v} \\propto (\\xi_i)$. This gives $\\boldsymbol{d}_{R3} \\propto (-(-1),-1, -(-1),1, -(1),1, -(1),-1) = (1,-1,1,1,-1,1,-1,-1)^{\\mathsf{T}}$.\nOne can verify that these three vectors satisfy equations $(1)$, $(2)$, and $(3)$.\n\nThe two hourglass modes are vectors in the kernel that are linearly independent of the rigid body modes. We can construct them by observing patterns that satisfy the kernel equations. Let us define the nodal vectors $\\boldsymbol{h}_{xy} = (1, -1, 1, -1)^{\\mathsf{T}}$.\n\n*   **Hourglass Mode 1 (HG1)**: Let $\\boldsymbol{u} = c_1 \\boldsymbol{h}_{xy} = (c_1, -c_1, c_1, -c_1)^{\\mathsf{T}}$ and $\\boldsymbol{v} = \\boldsymbol{0}$.\n    Equation (1): $-c_1 + (-c_1) + c_1 - (-c_1) = 0$.\n    Equation (2): $0 = 0$.\n    Equation (3): $-c_1 - (-c_1) + c_1 + (-c_1) + 0 = 0$.\n    This mode satisfies the zero-strain condition at the center. The corresponding displacement vector (with $c_1=1$) is $\\boldsymbol{d}_{H1} = (1, 0, -1, 0, 1, 0, -1, 0)^{\\mathsf{T}}$. This represents a kinematic pattern where the displacement field is $u(\\xi,\\eta) \\propto \\xi\\eta$ and $v(\\xi,\\eta)=0$.\n\n*   **Hourglass Mode 2 (HG2)**: Let $\\boldsymbol{u} = \\boldsymbol{0}$ and $\\boldsymbol{v} = c_2 \\boldsymbol{h}_{xy} = (c_2, -c_2, c_2, -c_2)^{\\mathsf{T}}$.\n    Equation (1): $0 = 0$.\n    Equation (2): $-c_2 - (-c_2) + c_2 + (-c_2) = 0$.\n    Equation (3): $0 - c_2 + (-c_2) + c_2 - (-c_2) = 0$.\n    This mode also satisfies the zero-strain condition. The corresponding displacement vector (with $c_2=1$) is $\\boldsymbol{d}_{H2} = (0, 1, 0, -1, 0, 1, 0, -1)^{\\mathsf{T}}$. This pattern corresponds to $u(\\xi,\\eta)=0$ and $v(\\xi,\\eta) \\propto \\xi\\eta$.\n\nThese two vectors, $\\boldsymbol{d}_{H1}$ and $\\boldsymbol{d}_{H2}$, are linearly independent of each other and of the rigid body modes. They form a basis for the space of hourglass modes for this element.\n\n**3. Explanation of Pathological Behavior**\n\nThe presence of hourglass modes is a numerical pathology that violates fundamental requirements for a stable and convergent finite element formulation.\n\n*   **Completeness**: The bilinear interpolation space of the $Q4$ element is \"complete\" in that it can represent rigid-body motion and constant strain states exactly. The interpolation itself can also represent the hourglassing fields (e.g., $u=\\xi\\eta$). The failure is not in the completeness of the interpolation but in the inability of the underintegrated quadrature rule to detect the energy associated with these modes.\n\n*   **Compatibility and Stability**: The core issue lies with stability. In the variational formulation of the finite element method, the total potential energy is minimized. The strain energy, a quadratic form of the nodal displacements, is $U = \\frac{1}{2}\\boldsymbol{d}^{\\mathsf{T}}\\boldsymbol{K}\\boldsymbol{d}$, where $\\boldsymbol{K}$ is the element stiffness matrix. The stiffness matrix is computed by integrating the product $\\boldsymbol{B}^{\\mathsf{T}}\\boldsymbol{C}\\boldsymbol{B}$ over the element volume, where $\\boldsymbol{C}$ is the material constitutive matrix. For a stable element, $\\boldsymbol{K}$ must be positive definite on the space of deformations that are not rigid-body motions. This property, known as coercivity of the discrete bilinear form, ensures that any non-rigid deformation incurs a positive strain energy cost, leading to a unique solution.\n\n    When one-point quadrature is used, the stiffness matrix is approximated as $\\boldsymbol{K} \\approx (\\boldsymbol{B}^{\\mathsf{T}}(0,0)\\boldsymbol{C}\\boldsymbol{B}(0,0)) \\times \\text{Area}$. If $\\boldsymbol{d}$ is an hourglass mode vector, then by definition $\\boldsymbol{B}(0,0)\\boldsymbol{d}=\\boldsymbol{0}$. Consequently, the strain energy associated with this mode is computed as zero:\n    $$\n    U_{HG} = \\frac{1}{2}\\boldsymbol{d}_{HG}^{\\mathsf{T}}\\boldsymbol{K}\\boldsymbol{d}_{HG} = \\frac{1}{2} (\\boldsymbol{B}(0,0)\\boldsymbol{d}_{HG})^{\\mathsf{T}} \\boldsymbol{C} (\\boldsymbol{B}(0,0)\\boldsymbol{d}_{HG}) \\times \\text{Area} = 0\n    $$\n    This is despite the fact that the true strain energy of an hourglass mode is non-zero, as the strains are non-zero everywhere except at the element center. For example, for HG1, $u=\\xi\\eta$, so $\\varepsilon_{xx}=\\partial u/\\partial x \\propto \\eta$ and $\\gamma_{xy}=\\partial u/\\partial y \\propto \\xi$. The strain energy density is non-zero, and its integral over the element is positive.\n\n    The failure of the quadrature to \"see\" this energy means the discrete stiffness matrix $\\boldsymbol{K}$ is singular (it has a kernel larger than just the rigid-body modes). This loss of coercivity means the discrete system $\\boldsymbol{K}\\boldsymbol{d}=\\boldsymbol{f}$ is unstable and may not have a unique solution. Within a mesh, these zero-energy modes can be excited without any energy penalty, leading to spurious, oscillatory \"checkerboard\" patterns in the solution that have no physical basis. While the displacement field of a single element might be continuous (`C^0` compatible), a global solution composed of such unpenalized modes often appears highly discontinuous or \"incompatible\" in a physical sense.\n\n*   **Convergence**: A stable method is a prerequisite for convergence. Since the underintegrated element is unstable, it is not guaranteed to converge to the correct solution as the mesh is refined ($h \\to 0$). The numerical solution can be polluted by arbitrary combinations of hourglass modes, preventing the error from vanishing.\n\n**4. Normalization of a Specific Hourglass Mode**\n\nThe problem specifies an hourglass mode with $u$-displacements alternating as $(+1, -1, +1, -1)$ at nodes $1, 2, 3, 4$ respectively, and all $v$-displacements being zero. This corresponds to the nodal displacement values:\n$$\nu_1 = 1, \\quad u_2 = -1, \\quad u_3 = 1, \\quad u_4 = -1\n$$\n$$\nv_1 = 0, \\quad v_2 = 0, \\quad v_3 = 0, \\quad v_4 = 0\n$$\nThe corresponding $8$-component nodal displacement vector $\\boldsymbol{d}$ in the ordering $(u_1, v_1, u_2, v_2, u_3, v_3, u_4, v_4)$ is:\n$$\n\\boldsymbol{d} = (1, 0, -1, 0, 1, 0, -1, 0)^{\\mathsf{T}}\n$$\nWe must normalize this vector to have a Euclidean norm of $1$. First, we compute its current norm, $||\\boldsymbol{d}||_2$:\n$$\n||\\boldsymbol{d}||_2 = \\sqrt{1^2 + 0^2 + (-1)^2 + 0^2 + 1^2 + 0^2 + (-1)^2 + 0^2} = \\sqrt{1 + 1 + 1 + 1} = \\sqrt{4} = 2\n$$\nThe normalized vector, $\\boldsymbol{d}_{\\text{norm}}$, is obtained by dividing $\\boldsymbol{d}$ by its norm:\n$$\n\\boldsymbol{d}_{\\text{norm}} = \\frac{1}{||\\boldsymbol{d}||_2} \\boldsymbol{d} = \\frac{1}{2} (1, 0, -1, 0, 1, 0, -1, 0)^{\\mathsf{T}}\n$$\n$$\n\\boldsymbol{d}_{\\text{norm}} = (\\frac{1}{2}, 0, -\\frac{1}{2}, 0, \\frac{1}{2}, 0, -\\frac{1}{2}, 0)^{\\mathsf{T}}\n$$\nThis is the required normalized hourglass mode vector.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{1}{2} & 0 & -\\frac{1}{2} & 0 & \\frac{1}{2} & 0 & -\\frac{1}{2} & 0\n\\end{pmatrix}\n}\n$$", "id": "3549776"}, {"introduction": "Higher-order elements are prized for their superior approximation power, a property rooted in the concept of completeness. However, this power is not absolute and depends critically on the element's geometry in the physical domain. This numerical experiment [@problem_id:3549779] demonstrates that while an element may be compatible by construction, its ability to exactly reproduce even simple polynomial fields can be lost when the isoparametric mapping becomes curved, revealing a subtle but critical interplay between geometry and accuracy.", "problem": "You are tasked to formalize and implement a numerical experiment that probes the notions of completeness, compatibility, and convergence for an $H^1$-conforming isoparametric element in two-dimensional plane elasticity. The base setting is the small-strain, kinematically admissible $H^1$ space of vector-valued displacements. Use the following foundational principles and definitions to design the algorithm.\n\n1. Fundamental definitions:\n   - The $H^1$ space is the Sobolev space of square-integrable functions with square-integrable first derivatives. In the context of plane elasticity, an $H^1$-conforming finite element ensures displacement fields $u_x$ and $u_y$ are continuous across element interfaces.\n   - An isoparametric mapping from the reference square with natural coordinates $(\\xi,\\eta)\\in[-1,1]\\times[-1,1]$ to a physical quadrilateral uses the same shape functions to interpolate both geometry $(x(\\xi,\\eta),y(\\xi,\\eta))$ and the displacement components $(u_x(\\xi,\\eta),u_y(\\xi,\\eta))$.\n   - Completeness (polynomial reproduction) of degree $p$ means the interpolation space can reproduce any polynomial of total degree up to $p$ exactly when expressed in the coordinate space where completeness is claimed.\n   - Compatibility (inter-element continuity) requires that the finite element interpolation be continuous along shared edges between adjacent elements.\n   - Convergence under mesh refinement requires regularity of the geometric mapping, notably a Jacobian determinant $J(\\xi,\\eta)=\\det\\left(\\frac{\\partial(x,y)}{\\partial(\\xi,\\eta)}\\right)$ that does not vanish or change sign, avoiding element inversion and ensuring bounded condition numbers.\n\n2. Element construction mandate:\n   - Construct an $H^1$-conforming, nine-node isoparametric quadrilateral with quadratic Lagrange shape functions defined at the tensor-product nodes $(\\xi,\\eta)\\in\\{-1,0,1\\}\\times\\{-1,0,1\\}$. Denote the one-dimensional quadratic Lagrange basis at $\\xi\\in\\{-1,0,1\\}$ as $l_1(\\xi)$, $l_2(\\xi)$, $l_3(\\xi)$, and similarly for $\\eta$. The two-dimensional shape functions are the tensor products $N_{ij}(\\xi,\\eta)=l_i(\\xi)l_j(\\eta)$ for $i,j\\in\\{1,2,3\\}$.\n   - Enforce $H^1$ conformity by using nodal degrees of freedom (values of $u_x$ and $u_y$) at all nine interpolation points. This results in continuity across shared edges because the restriction of the two-dimensional quadratic basis to an edge reduces to the corresponding one-dimensional quadratic basis that depends only on the edge nodes.\n\n3. Completeness test design:\n   - Consider the quadratic displacement polynomials in physical coordinates $(x,y)$:\n     $$\n     u_x(x,y)=1+2x+3y+\\tfrac{1}{2}x^2+xy+\\tfrac{1}{4}y^2,\\qquad\n     u_y(x,y)=-\\tfrac{1}{2}+x-2y+0.1x^2+0.2xy-0.3y^2.\n     $$\n   - For each element, obtain nodal values by evaluating $(u_x,u_y)$ at the physical nodal coordinates $(x_i,y_i)$ of the nine nodes. Form the isoparametric interpolant\n     $$\n     u_{h,x}(\\xi,\\eta)=\\sum_{i=1}^9N_i(\\xi,\\eta)\\,u_x(x_i,y_i),\\quad\n     u_{h,y}(\\xi,\\eta)=\\sum_{i=1}^9N_i(\\xi,\\eta)\\,u_y(x_i,y_i).\n     $$\n   - Evaluate the maximum absolute interpolation error over a uniform sampling of $(\\xi,\\eta)$ in the interior of the element:\n     $$\n     e_{\\max}=\\max_{(\\xi,\\eta)\\in\\mathcal{S}}\\max\\left(\\big|u_{h,x}(\\xi,\\eta)-u_x(x(\\xi,\\eta),y(\\xi,\\eta))\\big|,\\ \\big|u_{h,y}(\\xi,\\eta)-u_y(x(\\xi,\\eta),y(\\xi,\\eta))\\big|\\right),\n     $$\n     where $\\mathcal{S}$ is a fixed grid of sampling points. Declare reproduction \"exact\" if $e_{\\max}\\le \\varepsilon$ for a chosen tolerance $\\varepsilon$.\n\n4. Compatibility test design on a two-element patch:\n   - Construct a patch of two adjacent elements sharing a vertical edge. For the shared edge, verify continuity by sampling points along the interface with $(\\xi,\\eta)=(1,\\eta)$ on the left element and $(\\xi,\\eta)=(-1,\\eta)$ on the right element, computing the difference\n     $$\n     c_{\\max}=\\max_{\\eta\\in\\mathcal{E}}\\left\\|u_h^{\\text{left}}(1,\\eta)-u_h^{\\text{right}}(-1,\\eta)\\right\\|_\\infty,\n     $$\n     where $u_h=(u_{h,x},u_{h,y})$, $\\|\\cdot\\|_\\infty$ is the componentwise maximum norm, and $\\mathcal{E}$ is a fixed grid of edge sampling points. Declare continuity \"true\" if $c_{\\max}\\le \\delta$ for a chosen tolerance $\\delta$.\n\n5. Jacobian regularity assessment:\n   - For each element, compute the Jacobian determinant $J(\\xi,\\eta)$ from the geometric mapping using the shape function derivatives, and report the minimum value $J_{\\min}=\\min_{(\\xi,\\eta)\\in\\mathcal{S}}J(\\xi,\\eta)$ over the interior sampling grid. This quantifies proximity to singular mapping.\n\n6. Test suite:\n   - Use three test cases, each consisting of a two-element patch with left and right elements defined by their nine physical node coordinates ordered by $(\\xi,\\eta)$ in the grid\n     $$\n     \\{(-1,-1),(0,-1),(1,-1),(-1,0),(0,0),(1,0),(-1,1),(0,1),(1,1)\\}.\n     $$\n     For all cases, the right element is the regular rectangle on $[0.5,1]\\times[0,1]$ with nodes\n     $$\n     \\{(0.5,0),(0.75,0),(1,0),(0.5,0.5),(0.75,0.5),(1,0.5),(0.5,1),(0.75,1),(1,1)\\}.\n     $$\n     The left element differs per case:\n     - Case A (affine/bilinear mapping): regular rectangle on $[0,0.5]\\times[0,1]$ with nodes\n       $$\n       \\{(0,0),(0.25,0),(0.5,0),(0,0.5),(0.25,0.5),(0.5,0.5),(0,1),(0.25,1),(0.5,1)\\}.\n       $$\n     - Case B (curved mapping, positive Jacobian): bulged edges while preserving the shared interface nodes,\n       $$\n       \\{(0,0),(0.25,-0.1),(0.5,0),(-0.1,0.5),(0.25,0.5),(0.5,0.5),(0,1),(0.25,1.2),(0.5,1)\\}.\n       $$\n     - Case C (near-singular Jacobian at one corner): collapsed left edge with very small separation between top-left and bottom-left nodes,\n       $$\n       \\{(0,0),(0.25,0),(0.5,0),(0,0.0005),(0.25,0.5),(0.5,0.5),(0,0.001),(0.25,1),(0.5,1)\\}.\n       $$\n   - Sampling sets: use an $11\\times 11$ uniform grid $\\mathcal{S}$ in $(\\xi,\\eta)$ over $[-0.9,0.9]^2$ and an $11$-point uniform grid $\\mathcal{E}$ in $\\eta\\in[-0.9,0.9]$.\n   - Tolerances: set $\\varepsilon=10^{-10}$ for reproduction and $\\delta=10^{-12}$ for continuity.\n\n7. Required outputs:\n   - For each case produce a list containing three entries: the boolean reproduction outcome for the patch (true if both elements satisfy $e_{\\max}\\le\\varepsilon$), the boolean continuity outcome for the shared edge, and the float $J_{\\min}$ over both elements. The final output must be a single line with a comma-separated list of the three per-case lists, enclosed in square brackets, for example `[[b_1,c_1,j_1],[b_2,c_2,j_2],[b_3,c_3,j_3]]`.\n\n8. Units: All quantities are dimensionless; no physical units are required. Angles do not appear.\n\nYour program must implement the element as specified, carry out the completeness and compatibility tests, and produce the required output in the exact format described above.", "solution": "We begin from the fundamental structure of an $H^1$-conforming isoparametric element for two-dimensional plane elasticity. The unknown displacement vector field is $(u_x,u_y)$, where each component belongs to the Sobolev space $H^1$. In the isoparametric approach, both geometry and field variables are interpolated by the same shape functions. The tensor-product quadratic Lagrange basis on $\\{-1,0,1\\}$ in each natural coordinate results in nine nodes. Denote the one-dimensional quadratic Lagrange polynomials at nodes $\\{-1,0,1\\}$ by $l_1(\\xi)$, $l_2(\\xi)$, $l_3(\\xi)$, satisfying $l_1(-1)=1$, $l_1(0)=l_1(1)=0$; $l_2(0)=1$, $l_2(-1)=l_2(1)=0$; $l_3(1)=1$, $l_3(-1)=l_3(0)=0$. A canonical choice is\n$$\nl_1(\\xi)=\\tfrac{1}{2}\\xi(\\xi-1),\\quad l_2(\\xi)=1-\\xi^2,\\quad l_3(\\xi)=\\tfrac{1}{2}\\xi(\\xi+1),\n$$\nwith derivatives\n$$\nl_1'(\\xi)=\\xi-\\tfrac{1}{2},\\quad l_2'(\\xi)=-2\\xi,\\quad l_3'(\\xi)=\\xi+\\tfrac{1}{2}.\n$$\nThe two-dimensional shape functions are $N_{ij}(\\xi,\\eta)=l_i(\\xi)l_j(\\eta)$ with derivatives $N_{ij,\\xi}=l_i'(\\xi)l_j(\\eta)$ and $N_{ij,\\eta}=l_i(\\xi)l_j'(\\eta)$, $i,j\\in\\{1,2,3\\}$. Indexing the nine nodes in row-major order over $(\\xi,\\eta)\\in\\{(-1,-1),(0,-1),(1,-1),(-1,0),(0,0),(1,0),(-1,1),(0,1),(1,1)\\}$ yields a consistent mapping.\n\nThe isoparametric geometric mapping is\n$$\nx(\\xi,\\eta)=\\sum_{k=1}^9 N_k(\\xi,\\eta)\\,x_k,\\quad y(\\xi,\\eta)=\\sum_{k=1}^9 N_k(\\xi,\\eta)\\,y_k,\n$$\nwhere $(x_k,y_k)$ are the physical nodal coordinates and $N_k$ is a flattened notation for $N_{ij}$. The Jacobian matrix of the mapping is\n$$\n\\mathbf{J}=\n\\begin{bmatrix}\n\\frac{\\partial x}{\\partial \\xi} & \\frac{\\partial x}{\\partial \\eta}\\\\\n\\frac{\\partial y}{\\partial \\xi} & \\frac{\\partial y}{\\partial \\eta}\n\\end{bmatrix}\n=\n\\begin{bmatrix}\n\\sum_k N_{k,\\xi}x_k & \\sum_k N_{k,\\eta}x_k\\\\\n\\sum_k N_{k,\\xi}y_k & \\sum_k N_{k,\\eta}y_k\n\\end{bmatrix},\n$$\nand $J(\\xi,\\eta)=\\det(\\mathbf{J})$. Regularity of the mapping requires $J(\\xi,\\eta)>0$ throughout the element; values close to zero indicate near-singularity and potential loss of accuracy or convergence.\n\nThe $H^1$-conforming interpolation for the displacement uses the same shape functions:\n$$\nu_{h,x}(\\xi,\\eta)=\\sum_{k=1}^9 N_k(\\xi,\\eta)\\,u_x(x_k,y_k),\\quad\nu_{h,y}(\\xi,\\eta)=\\sum_{k=1}^9 N_k(\\xi,\\eta)\\,u_y(x_k,y_k).\n$$\nBecause the basis is nodal and $C^0$, the restriction of $u_h$ to any element edge is a one-dimensional quadratic Lagrange interpolant in the corresponding natural coordinate, depending only on the edge nodes. Therefore, if adjacent elements share identical physical coordinates for the shared edge nodes, the interpolation is continuous along the edge, ensuring compatibility (inter-element continuity) in the sense of $H^1$ conformity.\n\nCompleteness is assessed for the target polynomials prescribed in physical coordinates:\n$$\nu_x(x,y)=1+2x+3y+\\tfrac{1}{2}x^2+xy+\\tfrac{1}{4}y^2,\\quad\nu_y(x,y)=-\\tfrac{1}{2}+x-2y+0.1x^2+0.2xy-0.3y^2.\n$$\nUnder an affine or bilinear geometric mapping from $(\\xi,\\eta)$ to $(x,y)$ for a rectangular element, any quadratic polynomial in $(x,y)$ becomes a quadratic polynomial in $(\\xi,\\eta)$, which the quadratic Lagrange basis reproduces exactly; hence $e_{\\max}=0$ up to floating-point roundoff. When the mapping is curved (non-affine), composition of a quadratic $u(x,y)$ with a non-affine $(x(\\xi,\\eta),y(\\xi,\\eta))$ yields a polynomial in $(\\xi,\\eta)$ of degree higher than $2$ (for example, degree $4$ if both geometry and field are quadratic), which cannot be represented exactly by the quadratic interpolation; hence $e_{\\max}>0$. Near-singular Jacobians amplify interpolation errors and degrade conditioning, often increasing $e_{\\max}$ further.\n\nWe construct three two-element patches:\n- Case A (affine/bilinear): left element $[0,0.5]\\times[0,1]$, right element $[0.5,1]\\times[0,1]$. The mapping is bilinear and regular, so completeness for quadratic $u(x,y)$ holds: $e_{\\max}\\approx 0$. Compatibility holds by construction because edge nodes are shared.\n- Case B (curved left element): perturb the left element's mid-edge nodes to bulge the top and left edges while keeping the shared interface nodes fixed. The mapping remains regular ($J>0$), but completeness in physical coordinates is lost because $u(x(\\xi,\\eta),y(\\xi,\\eta))$ exceeds quadratic in $(\\xi,\\eta)$, so $e_{\\max}>0$. Compatibility remains true.\n- Case C (near-singular left element): collapse the left edge's top and bottom nodes to be very close, making $J(\\xi,\\eta)\\approx 0$ near one corner. Completeness in physical coordinates fails ($e_{\\max}>0$), and compatibility along the shared edge still holds, as edge nodes are common.\n\nAlgorithmic steps:\n1. Implement $l_i(\\xi)$ and $l_i'(\\xi)$ for $i=1,2,3$ and form the nine two-dimensional shape functions $N_k(\\xi,\\eta)$ along with their derivatives.\n2. For each element, compute $(x(\\xi,\\eta),y(\\xi,\\eta))$ and $J(\\xi,\\eta)$ on the interior sampling grid $\\mathcal{S}$, and compute the interpolated field $u_h(\\xi,\\eta)$ and the exact field $u(x(\\xi,\\eta),y(\\xi,\\eta))$ to obtain $e_{\\max}$.\n3. For each patch, compute $c_{\\max}$ by sampling the shared edge using the corresponding $(\\xi,\\eta)$ pairs and comparing the left and right interpolated fields.\n4. For each case, return the boolean for completeness ($e_{\\max}\\le\\varepsilon$ for both elements), the boolean for continuity ($c_{\\max}\\le\\delta$), and the minimum Jacobian determinant $J_{\\min}$ over both elements.\n\nChosen tolerances are $\\varepsilon=10^{-10}$ and $\\delta=10^{-12}$, consistent with double-precision floating-point expectations. The final output aggregates the three cases into a single list of lists, each containing the two booleans and one float, as specified. This experiment demonstrates:\n- Why isoparametric quadratic completeness is guaranteed for quadratic fields under affine/bilinear mappings (the composition remains within the interpolation space).\n- How curved mappings break completeness in physical coordinates while preserving $H^1$ compatibility.\n- How near-singular Jacobians signal geometric degeneracy that undermines accuracy and, in practice, convergence, even though interface continuity remains enforced by the nodal $C^0$ structure.", "answer": "[[True, True, 0.125], [False, True, 0.1125], [False, True, 0.00012500000000000002]]", "id": "3549779"}]}