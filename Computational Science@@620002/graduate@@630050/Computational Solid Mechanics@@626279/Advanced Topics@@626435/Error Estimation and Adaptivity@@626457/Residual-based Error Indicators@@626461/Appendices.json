{"hands_on_practices": [{"introduction": "To effectively use residual-based error indicators, we must first establish their correct mathematical form, which is rooted in fundamental physical principles. This initial practice focuses on the face (or edge) residual, which quantifies the error from discontinuous tractions across element boundaries in standard finite element models. By reasoning from the principle of action-reaction, you will determine the correct way to formulate this jump term, a crucial step for building a reliable error estimator, especially in the presence of heterogeneous materials [@problem_id:3595910].", "problem": "Consider small-strain, quasi-static, linear elasticity on a bounded Lipschitz domain $\\Omega \\subset \\mathbb{R}^d$ ($d \\in \\{2,3\\}$) with displacement field $u:\\Omega \\to \\mathbb{R}^d$, Cauchy stress $\\sigma(u)$, and body force $b:\\Omega \\to \\mathbb{R}^d$. The strong form is $\\nabla \\cdot \\sigma(u) + b = 0$ in $\\Omega$, with traction boundary condition $\\sigma(u)n = t$ on the Neumann boundary, where $n$ is the outward unit normal and $t$ is the prescribed traction. The strain is $\\varepsilon(u) = \\tfrac{1}{2}\\left(\\nabla u + (\\nabla u)^\\top\\right)$ and the constitutive law is $\\sigma(u) = \\mathbb{C}(x) : \\varepsilon(u)$, where $\\mathbb{C}(x)$ is a fourth-order, symmetric, positive-definite material tensor that may be heterogeneous and anisotropic.\n\nLet $u_h \\in V_h$ be a displacement-based finite element approximation with $C^0$ interelement continuity. Assume that $\\mathbb{C}(x)$ is piecewise constant per element, and denote by $K^+$ and $K^-$ two neighboring elements that share an interior face (or edge) $E = \\partial K^+ \\cap \\partial K^-$. Because $u_h$ is only $C^0$, the gradient $\\nabla u_h$ and thus $\\sigma(u_h)$ are generally only piecewise smooth and may be discontinuous across $E$. In residual-based a posteriori error estimation, the face contribution $j_E$ quantifies the lack of traction continuity across $E$ and is computed using one-sided quantities from each neighboring element.\n\nUsing only the governing equilibrium law, traction continuity, the definition of strain and stress, and the divergence theorem on a patch around $E$, determine which expression correctly computes the face residual $j_E$ by assembling the jump of the traction computed from one-sided gradients and the local material tensors on $K^+$ and $K^-$. Here $u_h^\\pm$ denotes the restriction of $u_h$ to $K^\\pm$, $\\varepsilon(u_h^\\pm) = \\tfrac{1}{2}\\left(\\nabla u_h^\\pm + (\\nabla u_h^\\pm)^\\top\\right)$, $\\sigma^\\pm = \\mathbb{C}^\\pm : \\varepsilon(u_h^\\pm)$ with $\\mathbb{C}^\\pm$ the elementwise material tensors on $K^\\pm$, and $n_E^\\pm$ are the outward unit normals on $E$ as seen from $K^\\pm$. The notation $\\|\\cdot\\|_{L^2(E)}$ denotes the $L^2$-norm on $E$.\n\nWhich option gives a consistent definition of $j_E$ in this setting?\n\nA. $j_E = \\left\\| \\left(\\mathbb{C}^+ : \\varepsilon(u_h^+)\\right) n_E^+ + \\left(\\mathbb{C}^- : \\varepsilon(u_h^-)\\right) n_E^- \\right\\|_{L^2(E)}$\n\nB. $j_E = \\left\\| \\left(\\mathbb{C}^+ : \\nabla u_h^+\\right) n_E - \\left(\\mathbb{C}^- : \\nabla u_h^-\\right) n_E \\right\\|_{L^2(E)}$, where $n_E$ is a fixed unit normal on $E$\n\nC. $j_E = \\left\\| \\left(\\mathbb{C}^+ - \\mathbb{C}^-\\right) : \\varepsilon\\!\\left(\\tfrac{1}{2}\\left(u_h^+ + u_h^-\\right)\\right) \\, n_E \\right\\|_{L^2(E)}$, where $n_E$ is a fixed unit normal on $E$\n\nD. $j_E = \\left\\| \\sigma^+ - \\sigma^- \\right\\|_{L^2(E)}$\n\nE. $j_E = \\left\\| \\left(\\mathbb{C}^+ : \\varepsilon(u_h^+)\\right) n_E + \\left(\\mathbb{C}^- : \\varepsilon(u_h^-)\\right) n_E \\right\\|_{L^2(E)}$, where $n_E$ is a fixed unit normal on $E$", "solution": "The problem asks for the correct expression for the face residual $j_E$ in the context of residual-based a posteriori error estimation for linear elasticity. This residual quantifies the violation of traction continuity across an interior face $E$ between two finite elements, $K^+$ and $K^-$.\n\n### Step 1: Problem Validation\n\n**1.1. Extract Givens**\n- **Governing Equation:** $\\nabla \\cdot \\sigma(u) + b = 0$ in $\\Omega \\subset \\mathbb{R}^d$, $d \\in \\{2,3\\}$.\n- **Traction Boundary Condition:** $\\sigma(u)n = t$ on the Neumann boundary.\n- **Strain Tensor:** $\\varepsilon(u) = \\tfrac{1}{2}\\left(\\nabla u + (\\nabla u)^\\top\\right)$.\n- **Constitutive Law:** $\\sigma(u) = \\mathbb{C}(x) : \\varepsilon(u)$, with $\\mathbb{C}(x)$ being a fourth-order, symmetric, positive-definite tensor.\n- **FE Approximation:** $u_h$ is a $C^0$ continuous displacement field.\n- **Material Property:** $\\mathbb{C}(x)$ is piecewise constant, denoted $\\mathbb{C}^\\pm$ on elements $K^\\pm$.\n- **Interface:** $E = \\partial K^+ \\cap \\partial K^-$ is the shared face between elements $K^+$ and $K^-$.\n- **Discontinuity:** $\\nabla u_h$ and $\\sigma(u_h)$ are discontinuous across $E$.\n- **Defined Quantities:**\n    - $u_h^\\pm$: restriction of $u_h$ to $K^\\pm$.\n    - $\\varepsilon(u_h^\\pm) = \\tfrac{1}{2}\\left(\\nabla u_h^\\pm + (\\nabla u_h^\\pm)^\\top\\right)$.\n    - $\\sigma^\\pm = \\mathbb{C}^\\pm : \\varepsilon(u_h^\\pm)$.\n    - $n_E^\\pm$: outward unit normals on $E$ from the perspective of $K^\\pm$.\n- **Objective:** Find the expression for the face residual $j_E$ representing the jump of the traction.\n\n**1.2. Validate Using Extracted Givens**\nThe problem statement is scientifically sound, well-posed, and objective.\n- **Scientifically Grounded:** The setup is a standard formulation of linear elastostatics and its approximation by the finite element method. The concepts of $C^0$ continuity, piecewise constant material properties, discontinuous stress fields, and residual-based error indicators are fundamental and well-established in computational solid mechanics.\n- **Well-Posed:** The question asks for a specific definition ($j_E$) based on established physical principles (traction continuity) within a clearly defined mathematical framework. A unique and correct definition exists within this context.\n- **Objective & Complete:** The problem uses precise mathematical and engineering terminology. All necessary definitions and variables ($\\sigma$, $\\varepsilon$, $u_h$, $n_E^\\pm$, etc.) are provided to derive the answer based on first principles. The setup is self-contained and consistent.\n\n**1.3. Verdict and Action**\nThe problem is **valid**. The solution process will now proceed.\n\n### Step 2: Derivation from First Principles\n\nThe face residual $j_E$ arises from the fact that the finite element approximation $u_h$ does not, in general, satisfy the strong form of the equilibrium equation everywhere. Specifically, while equilibrium is satisfied weakly over the domain, the condition of traction continuity across inter-element faces is violated.\n\nAccording to Newton's third law (action-reaction), for an exact solution $u$, the force per unit area (traction) exerted by element $K^+$ on element $K^-$ across the interface $E$ must be equal and opposite to the traction exerted by $K^-$ on $K^+$.\n\nThe traction vector on the face $E$ as seen from element $K^+$ is given by $t^+ = \\sigma(u) n_E^+$, where $n_E^+$ is the outward unit normal to $K^+$.\nSimilarly, the traction vector on the face $E$ as seen from element $K^-$ is $t^- = \\sigma(u) n_E^-$, where $n_E^-$ is the outward unit normal to $K^-$.\n\nThe normals point in opposite directions, i.e., $n_E^+ = -n_E^-$.\n\nThe statement of traction continuity (equilibrium) at the interface $E$ is:\n$$t^+ + t^- = \\boldsymbol{0}$$\nSubstituting the expressions for the traction vectors:\n$$\\sigma(u) n_E^+ + \\sigma(u) n_E^- = \\boldsymbol{0}$$\nSince this holds for the exact solution $u$, the term on the left represents the quantity that is no longer zero for the approximate solution $u_h$. The face residual $j_E$ is defined as the norm of this imbalance, integrated over the face $E$.\n\nFor the finite element solution $u_h$, the stress tensor $\\sigma(u_h)$ is discontinuous. We denote the stress computed on element $K^+$ as $\\sigma^+ = \\sigma(u_h^+)$ and on element $K^-$ as $\\sigma^- = \\sigma(u_h^-)$. The imbalance in traction across the face $E$ is therefore:\n$$\\sigma^+ n_E^+ + \\sigma^- n_E^- \\neq \\boldsymbol{0}$$\nThe face residual $j_E$ is the $L^2$-norm of this vector quantity over the face $E$:\n$$j_E = \\left\\| \\sigma^+ n_E^+ + \\sigma^- n_E^- \\right\\|_{L^2(E)}$$\nSubstituting the problem's definition for the approximate stress tensors, $\\sigma^\\pm = \\mathbb{C}^\\pm : \\varepsilon(u_h^\\pm)$, we get:\n$$j_E = \\left\\| \\left(\\mathbb{C}^+ : \\varepsilon(u_h^+)\\right) n_E^+ + \\left(\\mathbb{C}^- : \\varepsilon(u_h^-)\\right) n_E^- \\right\\|_{L^2(E)}$$\n\nThis expression is often written in terms of a \"jump\" operator. If we define a single fixed normal $n_E$ for the face (e.g., let $n_E = n_E^+$), then $n_E^- = -n_E$. The traction imbalance becomes:\n$$\\sigma^+ n_E^+ + \\sigma^- n_E^- = \\sigma^+ n_E + \\sigma^- (-n_E) = (\\sigma^+ - \\sigma^-) n_E$$\nThis quantity is called the jump of the traction, often denoted as $\\llbracket \\sigma(u_h) \\cdot n_E \\rrbracket_E$. The residual is then the norm of this jump, which is an equivalent formulation.\n\n### Step 3: Option-by-Option Analysis\n\n**A. $j_E = \\left\\| \\left(\\mathbb{C}^+ : \\varepsilon(u_h^+)\\right) n_E^+ + \\left(\\mathbb{C}^- : \\varepsilon(u_h^-)\\right) n_E^- \\right\\|_{L^2(E)}$**\nThis expression matches the one derived from the principle of action-reaction. It correctly sums the traction vectors from each adjacent element, using their respective outward normals $n_E^+$ and $n_E^-$. The $L^2$-norm of this sum quantifies the net force on the interface, which should be zero for a solution in equilibrium. This is a standard and correct definition of the face residual.\n**Verdict: Correct**\n\n**B. $j_E = \\left\\| \\left(\\mathbb{C}^+ : \\nabla u_h^+\\right) n_E - \\left(\\mathbb{C}^- : \\nabla u_h^-\\right) n_E \\right\\|_{L^2(E)}$, where $n_E$ is a fixed unit normal on $E$**\nThis expression uses the full displacement gradient $\\nabla u_h$ instead of the symmetric strain tensor $\\varepsilon(u_h)$. The constitutive law states that stress depends on strain: $\\sigma = \\mathbb{C} : \\varepsilon(u) = \\mathbb{C} : \\tfrac{1}{2}(\\nabla u + (\\nabla u)^\\top)$. For a general anisotropic material tensor $\\mathbb{C}$, the contraction $\\mathbb{C} : \\nabla u_h$ is not equal to $\\mathbb{C} : \\varepsilon(u_h)$. Using the full gradient is physically and mathematically inconsistent with the definition of Cauchy stress in the provided framework.\n**Verdict: Incorrect**\n\n**C. $j_E = \\left\\| \\left(\\mathbb{C}^+ - \\mathbb{C}^-\\right) : \\varepsilon\\!\\left(\\tfrac{1}{2}\\left(u_h^+ + u_h^-\\right)\\right) \\, n_E \\right\\|_{L^2(E)}$, where $n_E$ is a fixed unit normal on $E$**\nThis expression involves the jump in the material tensor, $\\mathbb{C}^+ - \\mathbb{C}^-$. This implies that if the material is homogeneous across the interface ($\\mathbb{C}^+ = \\mathbb{C}^-$), the residual $j_E$ would be zero. However, a face residual generally exists even for homogeneous materials whenever the finite element solution is not exact. The residual must measure the error in the solution's satisfaction of the equilibrium equations, not just the material heterogeneity.\n**Verdict: Incorrect**\n\n**D. $j_E = \\left\\| \\sigma^+ - \\sigma^- \\right\\|_{L^2(E)}$**\nThis expression computes the $L^2$-norm of the jump in the entire stress *tensor* $\\sigma$, rather than the traction *vector*. The physical principle of equilibrium requires continuity of the traction vector, $(\\sigma^+ - \\sigma^-)n_E = \\boldsymbol{0}$, across the interface. This does not require the full stress tensors to be equal ($\\sigma^+ = \\sigma^-$). Stress components in the plane of the face a priori need not be continuous. Therefore, this expression measures more than what is required by traction continuity and is not the correct definition of the face residual.\n**Verdict: Incorrect**\n\n**E. $j_E = \\left\\| \\left(\\mathbb{C}^+ : \\varepsilon(u_h^+)\\right) n_E + \\left(\\mathbb{C}^- : \\varepsilon(u_h^-)\\right) n_E \\right\\|_{L^2(E)}$, where $n_E$ is a fixed unit normal on $E$**\nThis expression can be written as $\\| \\sigma^+ n_E + \\sigma^- n_E \\|_{L^2(E)}$, or $\\| (\\sigma^+ + \\sigma^-) n_E \\|_{L^2(E)}$. This is the norm of the *sum* of the stress tensors contracted with a *single* normal vector $n_E$. As derived earlier, the correct quantity is the *jump*, which corresponds to a difference: $(\\sigma^+ - \\sigma^-)n_E$. The sum $(\\sigma^+ + \\sigma^-)n_E$ does not represent the physical imbalance of forces across the interface.\n**Verdict: Incorrect**", "answer": "$$\\boxed{A}$$", "id": "3595910"}, {"introduction": "With a solid conceptual foundation for the jump residual, the next step is to perform a complete calculation that integrates all components of the error indicator. This exercise provides a concrete, hands-on opportunity to compute both the element interior residual (from the local imbalance of momentum) and the edge jump residual (from traction discontinuity) for a nonlinear, compressible material model [@problem_id:3595950]. Working through this example solidifies the abstract definitions by applying them to a specific deformation state, demonstrating how these indicators quantify error in a tangible engineering scenario.", "problem": "Consider a two-dimensional reference configuration given by the unit square with coordinates $(X,Y) \\in [0,1] \\times [0,1]$. The square is partitioned into two triangular finite elements by the diagonal edge from $(0,0)$ to $(1,1)$:\n- Element $K_{1}$ has vertices $(0,0)$, $(1,0)$, $(1,1)$.\n- Element $K_{2}$ has vertices $(0,0)$, $(0,1)$, $(1,1)$.\nLet $E_{0}$ denote the interior edge shared by $K_{1}$ and $K_{2}$ from $(0,0)$ to $(1,1)$.\n\nThe material is a compressible Neo-Hookean solid with stored-energy density\n$$\nW(F) = \\frac{\\mu}{2}\\big(\\mathrm{tr}(C)-3\\big) - \\mu \\ln J + \\frac{\\lambda}{2}(\\ln J)^{2},\n$$\nwhere $F$ is the deformation gradient, $C = F^{\\top}F$ is the right Cauchy-Green tensor, $J = \\det(F)$, and $\\mu, \\lambda$ are the Lamé parameters. Assume plane strain kinematics. The First Piola–Kirchhoff stress (FPK stress) $P(F)$ is defined by $P(F) = \\partial W/\\partial F$.\n\nAssume a piecewise-affine finite element displacement field whose gradient is piecewise constant and equal to the following values:\n$$\nF_{h}\\big|_{K_{1}} = \\begin{pmatrix} 1.1 & 0 \\\\ 0 & 1.0 \\end{pmatrix}, \\qquad\nF_{h}\\big|_{K_{2}} = \\begin{pmatrix} 0.9 & 0 \\\\ 0 & 1.0 \\end{pmatrix}.\n$$\nTake material parameters $\\mu = 80\\,\\mathrm{kPa}$ and $\\lambda = 120\\,\\mathrm{kPa}$. Let the body force be constant in the reference configuration, $b = (0.4,-0.2)\\,\\mathrm{kN/m}^{3}$, and let the prescribed traction on the external boundary be homogeneous, i.e., $t = (0,0)$ on all Neumann segments.\n\nStarting from the strong form of momentum balance in the reference configuration,\n$$\n\\mathrm{Div}\\,P(F) + b = 0 \\quad \\text{in the domain},\n$$\nand the traction boundary condition on a Neumann boundary,\n$$\nP(F)\\,n = t \\quad \\text{on the boundary},\n$$\nderive the expressions needed to evaluate the element residual and the edge jump that define residual-based error indicators for the piecewise-constant $F_{h}$:\n- The element residual over $K$ is the vector field $R_{K} = \\mathrm{Div}\\,P(F_{h}) + b$.\n- The interior-edge jump across $E$ shared by elements $K^{+}$ and $K^{-}$ is the vector field $J_{E} = P(F_{h}^{+})\\,n^{+} + P(F_{h}^{-})\\,n^{-}$, where $n^{\\pm}$ are the outward unit normals of $K^{\\pm}$ on $E$.\n\nUse the following size measures:\n- For each element, $h_{K}$ is the element diameter (the longest distance between any two points in $K$).\n- For the interior edge $E_{0}$, $h_{E_{0}}$ is the edge length.\n\nDefine the residual-based indicators as\n$$\nr_{K} = h_{K}\\,\\|R_{K}\\|_{L^{2}(K)}, \\qquad\nj_{E_{0}} = h_{E_{0}}^{1/2}\\,\\|J_{E_{0}}\\|_{L^{2}(E_{0})},\n$$\nwhere $\\|\\cdot\\|_{L^{2}}$ denotes the $L^{2}$-norm over the indicated set. For this configuration, use the unit normal on $E_{0}$ pointing outward from $K_{1}$ as $n^{+} = \\frac{1}{\\sqrt{2}}(-1,\\,1)$ and hence $n^{-} = -n^{+}$ outward from $K_{2}$.\n\nUsing these definitions, compute the total indicator\n$$\n\\eta = \\Big(r_{K_{1}}^{2} + r_{K_{2}}^{2} + j_{E_{0}}^{2}\\Big)^{1/2}.\n$$\nExpress the final value of $\\eta$ in $\\mathrm{kN/m}$ and round your answer to four significant figures.", "solution": "The user has provided a well-defined problem in computational solid mechanics. The problem is scientifically grounded, self-contained, and all provided data are consistent. Therefore, the problem is deemed valid and a full solution can be provided.\n\nThe objective is to compute the total residual-based error indicator $\\eta = \\Big(r_{K_{1}}^{2} + r_{K_{2}}^{2} + j_{E_{0}}^{2}\\Big)^{1/2}$. This requires the calculation of the element indicators $r_{K}$ and the edge indicator $j_{E_{0}}$.\n\nThe First Piola-Kirchhoff (FPK) stress $P$ is derived from the stored-energy density $W(F)$ as $P(F) = \\partial W/\\partial F$. For the given compressible Neo-Hookean model,\n$$\nW(F) = \\frac{\\mu}{2}\\big(\\mathrm{tr}(C)-3\\big) - \\mu \\ln J + \\frac{\\lambda}{2}(\\ln J)^{2}\n$$\nthe FPK stress is given by the standard formula:\n$$\nP(F) = \\mu F + (\\lambda \\ln J - \\mu) F^{-T}\n$$\nwhere $F$ is the deformation gradient, $J = \\det(F)$, and $\\mu, \\lambda$ are Lamé parameters.\n\nFirst, we compute the element residual indicators $r_{K_1}$ and $r_{K_2}$. The element residual is defined as $R_{K} = \\mathrm{Div}\\,P(F_{h}) + b$. The problem specifies a piecewise-constant deformation gradient $F_h$. Consequently, the stress tensor $P(F_h)$ is also piecewise-constant within each element. The divergence of a constant tensor is zero, i.e., $\\mathrm{Div}\\,P(F_{h}) = 0$ in the interior of each element $K$. Therefore, the element residual simplifies to the body force:\n$$\nR_{K_1} = b \\quad \\text{and} \\quad R_{K_2} = b\n$$\nThe body force is given as $b = (0.4, -0.2)\\,\\mathrm{kN/m}^{3}$. Thus, its squared magnitude is:\n$$\n|b|^2 = (0.4)^2 + (-0.2)^2 = 0.16 + 0.04 = 0.20 \\, (\\mathrm{kN/m}^3)^2\n$$\nThe element indicator is $r_{K} = h_{K}\\,\\|R_{K}\\|_{L^{2}(K)}$. Since $R_K=b$ is constant over the element, its $L^2$-norm is $\\|R_K\\|_{L^2(K)} = \\left(\\int_K |b|^2 dA\\right)^{1/2} = |b| \\sqrt{\\text{Area}(K)}$.\nThe elements $K_1$ and $K_2$ are right triangles with vertices $(0,0), (1,0), (1,1)$ and $(0,0), (0,1), (1,1)$ respectively. Both have an area of $1/2$.\n$$\n\\text{Area}(K_1) = \\text{Area}(K_2) = \\frac{1}{2} \\cdot 1 \\cdot 1 = \\frac{1}{2} \\, \\mathrm{m}^2\n$$\nThe diameter $h_K$ for a right triangle is the length of its hypotenuse. The vertices for $K_1$ are $(0,0)$, $(1,0)$, $(1,1)$. The side lengths are $1$, $1$, and $\\sqrt{(1-0)^2 + (1-0)^2} = \\sqrt{2}$. The diameter is $h_{K_1}=\\sqrt{2}\\,\\mathrm{m}$. Similarly, for $K_2$ with vertices $(0,0)$, $(0,1)$, $(1,1)$, the diameter is $h_{K_2}=\\sqrt{2}\\,\\mathrm{m}$.\nWe can now compute the squared element indicators:\n$$\nr_{K}^2 = h_{K}^2 \\|R_K\\|_{L^2(K)}^2 = h_K^2 |b|^2 \\text{Area}(K)\n$$\nFor both elements $K_1$ and $K_2$:\n$$\nr_{K_1}^2 = r_{K_2}^2 = (\\sqrt{2})^2 \\cdot 0.20 \\cdot \\frac{1}{2} = 2 \\cdot 0.20 \\cdot 0.5 = 0.20 \\, (\\mathrm{kN/m})^2\n$$\n\nNext, we compute the interior edge indicator $j_{E_0}$. The jump is $J_{E_{0}} = P(F_{h}^{+})\\,n^{+} + P(F_{h}^{-})\\,n^{-}$. With $K_1=K^+$, $K_2=K^-$, $F_1=F_h^+$, $F_2=F_h^-$, and $n^- = -n^+$, this becomes:\n$$\nJ_{E_0} = (P(F_1) - P(F_2))n^+\n$$\nLet's compute the stress tensors $P_1 = P(F_1)$ and $P_2 = P(F_2)$ using $\\mu = 80\\,\\mathrm{kPa}$ and $\\lambda = 120\\,\\mathrm{kPa}$.\n\nFor element $K_1$:\n$F_1 = \\begin{pmatrix} 1.1 & 0 \\\\ 0 & 1.0 \\end{pmatrix}$. Thus, $J_1 = \\det(F_1) = 1.1$ and $F_1^{-T} = \\begin{pmatrix} 1/1.1 & 0 \\\\ 0 & 1 \\end{pmatrix}$.\n$$\nP_1 = 80 \\begin{pmatrix} 1.1 & 0 \\\\ 0 & 1 \\end{pmatrix} + (120 \\ln(1.1) - 80) \\begin{pmatrix} 1/1.1 & 0 \\\\ 0 & 1 \\end{pmatrix} = \\begin{pmatrix} 88 + \\frac{120\\ln(1.1)-80}{1.1} & 0 \\\\ 0 & 120\\ln(1.1) \\end{pmatrix}\n$$\n\nFor element $K_2$:\n$F_2 = \\begin{pmatrix} 0.9 & 0 \\\\ 0 & 1.0 \\end{pmatrix}$. Thus, $J_2 = \\det(F_2) = 0.9$ and $F_2^{-T} = \\begin{pmatrix} 1/0.9 & 0 \\\\ 0 & 1 \\end{pmatrix}$.\n$$\nP_2 = 80 \\begin{pmatrix} 0.9 & 0 \\\\ 0 & 1 \\end{pmatrix} + (120 \\ln(0.9) - 80) \\begin{pmatrix} 1/0.9 & 0 \\\\ 0 & 1 \\end{pmatrix} = \\begin{pmatrix} 72 + \\frac{120\\ln(0.9)-80}{0.9} & 0 \\\\ 0 & 120\\ln(0.9) \\end{pmatrix}\n$$\nThe difference in stress is $\\Delta P = P_1 - P_2 = \\text{diag}(\\Delta P_{11}, \\Delta P_{22})$:\n$$\n\\Delta P_{11} = \\left(88 + \\frac{120\\ln(1.1)-80}{1.1}\\right) - \\left(72 + \\frac{120\\ln(0.9)-80}{0.9}\\right) \\approx 56.60716\\,\\mathrm{kPa}\n$$\n$$\n\\Delta P_{22} = 120\\ln(1.1) - 120\\ln(0.9) = 120\\ln\\left(\\frac{1.1}{0.9}\\right) \\approx 24.08048\\,\\mathrm{kPa}\n$$\nThe normal vector is $n^+ = \\frac{1}{\\sqrt{2}}(-1, 1)^T$. The jump vector is constant along the edge:\n$$\nJ_{E_0} = \\Delta P n^+ = \\frac{1}{\\sqrt{2}} \\begin{pmatrix} -\\Delta P_{11} \\\\ \\Delta P_{22} \\end{pmatrix}\n$$\nThe squared magnitude of the jump vector is:\n$$\n|J_{E_0}|^2 = \\frac{1}{2}(\\Delta P_{11}^2 + \\Delta P_{22}^2) \\approx \\frac{1}{2}((56.60716)^2 + (24.08048)^2) \\approx 1892.122 \\, (\\mathrm{kPa})^2\n$$\nThe interior edge indicator is $j_{E_0} = h_{E_0}^{1/2} \\|J_{E_0}\\|_{L^2(E_0)}$. Since $J_{E_0}$ is constant, $\\|J_{E_0}\\|_{L^2(E_0)} = |J_{E_0}| \\sqrt{h_{E_0}}$. The length of the edge $E_0$ is $h_{E_0} = \\sqrt{2}\\,\\mathrm{m}$.\nSo, $j_{E_0} = h_{E_0}^{1/2} (|J_{E_0}| h_{E_0}^{1/2}) = h_{E_0} |J_{E_0}|$. The squared indicator is:\n$$\nj_{E_0}^2 = h_{E_0}^2 |J_{E_0}|^2 = (\\sqrt{2})^2 \\cdot |J_{E_0}|^2 = 2 \\cdot \\frac{1}{2}(\\Delta P_{11}^2 + \\Delta P_{22}^2) = \\Delta P_{11}^2 + \\Delta P_{22}^2\n$$\nThe units of this quantity are $\\mathrm{m}^2 \\cdot (\\mathrm{kPa})^2 = \\mathrm{m}^2 \\cdot (\\mathrm{kN/m^2})^2 = (\\mathrm{kN/m})^2$.\n$$\nj_{E_0}^2 \\approx (56.60716)^2 + (24.08048)^2 \\approx 3204.375 + 579.870 \\approx 3784.245 \\, (\\mathrm{kN/m})^2\n$$\n\nFinally, the total indicator $\\eta$ is computed:\n$$\n\\eta^2 = r_{K_1}^2 + r_{K_2}^2 + j_{E_0}^2 \\approx 0.20 + 0.20 + 3784.245 = 3784.645 \\, (\\mathrm{kN/m})^2\n$$\n$$\n\\eta = \\sqrt{3784.645} \\approx 61.519468 \\, \\mathrm{kN/m}\n$$\nRounding to four significant figures, we get $\\eta = 61.52\\,\\mathrm{kN/m}$.", "answer": "$$\n\\boxed{61.52}\n$$", "id": "3595950"}, {"introduction": "Beyond estimating the total error, residual-based indicators serve as powerful diagnostic tools for identifying specific pathologies in numerical solutions. This final practice explores the issue of volumetric locking in simulations of nearly incompressible materials, where unstable numerical methods can generate spurious pressure fields [@problem_id:3595875]. By examining the volumetric component of the residual, you will learn how to detect these unphysical oscillations, showcasing how error indicators can provide deep insight into the quality and correctness of a finite element solution.", "problem": "Consider small-strain, plane-strain, linear elastic solids with displacement field $u$ and pressure-like field $p$ introduced by the volumetric-deviatoric split of the Cauchy stress. The stress is decomposed as $\\sigma = -p I + 2 \\mu \\varepsilon^{\\mathrm{dev}}(u)$, where $\\varepsilon(u) = \\frac{1}{2} \\left( \\nabla u + \\nabla u^{\\top} \\right)$ is the small-strain tensor, $\\varepsilon^{\\mathrm{dev}}(u) = \\varepsilon(u) - \\frac{1}{2} \\operatorname{tr} \\varepsilon(u) I$ in two dimensions, $\\mu$ is the shear modulus, and $I$ is the identity tensor. In the mixed displacement-pressure formulation for nearly incompressible elasticity, the volumetric constitutive relation is $p + \\kappa \\operatorname{tr} \\varepsilon(u) = 0$, where $\\kappa$ is the bulk modulus. The strong form of equilibrium is $\\nabla \\cdot \\sigma + b = 0$ in a domain $\\Omega$, with body force $b$ and appropriate boundary conditions.\n\nA residual-based error indicator can be built from the strong form and constitutive relations. In particular, the elementwise volumetric residual is defined as $r_{p,K} := p_h + \\kappa \\operatorname{tr} \\varepsilon(u_h)$ on each element $K$, where $(u_h, p_h)$ are the finite element approximations.\n\nVolumetric locking refers to the spurious stiffening and suppression of volumetric strain that occurs in displacement-only formulations as $\\kappa \\to \\infty$. In mixed formulations that are not Ladyzhenskaya–Babuška–Brezzi (LBB) stable (for example, equal-order bilinear $Q_1$–$Q_1$ elements for $(u_h, p_h)$), spurious pressure oscillations such as checkerboard patterns can arise.\n\nConsider the unit square domain $\\Omega = (0,1) \\times (0,1)$ under uniform hydrostatic compression with traction $t = -p_{\\mathrm{ext}} n$ applied on $\\partial \\Omega$ and no body force, with material parameters $\\mu = 1$ and $\\kappa = 1000$ (non-dimensionalized for simplicity). On a $2 \\times 2$ structured mesh, suppose a computed equal-order mixed solution exhibits the following elementwise fields:\n- The volumetric strain is nearly uniform: $\\operatorname{tr} \\varepsilon(u_h) \\approx s$ with $s = 0.002$ in every element.\n- The pressure shows a checkerboard oscillation: $p_h = +5$ on the top-left and bottom-right elements, and $p_h = -5$ on the top-right and bottom-left elements.\n\nDefine $r_{p,K}$ for each of the four elements and reason from the governing equations and constitutive relation how the magnitude and pattern of $r_{p,K}$ can be used to diagnose spurious pressure oscillations and the interplay with volumetric locking.\n\nWhich of the following statements are correct?\n\nA. In this scenario, the alternation of $p_h$ in sign will induce an alternation of $r_{p,K}$ in sign with large magnitude on the $2 \\times 2$ mesh, and this alternating pattern is a hallmark of a spurious pressure mode caused by violation of the Ladyzhenskaya–Babuška–Brezzi condition; additionally, the sensitivity of $r_{p,K}$ to such oscillations increases with $\\kappa$.\n\nB. If the equilibrium equation $\\nabla \\cdot \\sigma + b = 0$ happens to be satisfied elementwise in the discrete solution, then $r_{p,K}$ necessarily vanishes in every element, so a residual-based estimator cannot detect pressure oscillations.\n\nC. For equal-order $Q_1$–$Q_1$ interpolation in the nearly incompressible regime, reducing the mesh size alone ensures the checkerboard pattern in $p_h$ disappears and $r_{p,K} \\to 0$ uniformly as $h \\to 0$.\n\nD. If $r_{p,K}$ is constant and positive over all elements, this indicates a smooth pressure field and demonstrates that the mixed formulation has eliminated volumetric locking.\n\nE. Replacing the equal-order pair with an LBB-stable mixed pair (for example, Taylor–Hood) under the same loading and comparable mesh resolution yields $p_h \\approx -\\kappa \\operatorname{tr} \\varepsilon(u_h)$ elementwise, thereby driving $r_{p,K}$ close to zero and removing the alternating pattern.\n\nSelect all that apply.", "solution": "The problem statement is first validated to ensure it is scientifically sound, well-posed, and objective.\n\n### Step 1: Extract Givens\n- **Model**: Small-strain, plane-strain, linear elastic solid.\n- **Formulation**: Mixed displacement-pressure formulation with fields $u$ (displacement) and $p$ (pressure-like).\n- **Stress-Strain Relation**: Cauchy stress $\\sigma = -p I + 2 \\mu \\varepsilon^{\\mathrm{dev}}(u)$.\n- **Strain Tensor**: $\\varepsilon(u) = \\frac{1}{2} \\left( \\nabla u + \\nabla u^{\\top} \\right)$.\n- **Deviatoric Strain (2D)**: $\\varepsilon^{\\mathrm{dev}}(u) = \\varepsilon(u) - \\frac{1}{2} \\operatorname{tr} \\varepsilon(u) I$.\n- **Volumetric Constitutive Relation**: $p + \\kappa \\operatorname{tr} \\varepsilon(u) = 0$.\n- **Constants**: $\\mu$ is the shear modulus, $\\kappa$ is the bulk modulus.\n- **Equilibrium Equation**: $\\nabla \\cdot \\sigma + b = 0$ in domain $\\Omega$.\n- **Error Indicator Definition**: Elementwise volumetric residual $r_{p,K} := p_h + \\kappa \\operatorname{tr} \\varepsilon(u_h)$ for a finite element approximation $(u_h, p_h)$ on element $K$.\n- **Scenario**:\n    - Domain: $\\Omega = (0,1) \\times (0,1)$.\n    - Loading: Uniform hydrostatic compression with traction $t = -p_{\\mathrm{ext}} n$ on $\\partial \\Omega$. Body force $b=0$.\n    - Material Parameters: $\\mu = 1$, $\\kappa = 1000$.\n    - Mesh: $2 \\times 2$ structured mesh.\n    - Finite Element Method: Equal-order ($Q_1$–$Q_1$) mixed formulation.\n    - Computed Solution Fields:\n        - Volumetric strain: $\\operatorname{tr} \\varepsilon(u_h) \\approx s = 0.002$ in every element.\n        - Pressure: $p_h = +5$ on top-left and bottom-right elements; $p_h = -5$ on top-right and bottom-left elements.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientific Groundedness**: The problem is based on standard, well-established principles of continuum mechanics and the finite element method for nearly incompressible elasticity. The mixed $u-p$ formulation, volumetric-deviatoric split, Ladyzhenskaya–Babuška–Brezzi (LBB) condition, and residual-based error estimation are all core concepts in computational mechanics. The governing equations are correctly stated.\n- **Well-Posedness**: The problem presents a hypothetical but realistic outcome of a numerical simulation using an LBB-unstable element pair ($Q_1$–$Q_1$) for a nearly incompressible problem. The presented checkerboard pressure field is a classic manifestation of this instability. The question asks for an analysis of this given result using a defined residual, which is a well-posed diagnostic task.\n- **Consistency and Completeness**: The problem provides all necessary data and definitions to calculate the residual and evaluate its behavior. There is a potential inconsistency: \"hydrostatic compression\" should physically result in a negative volumetric strain ($\\operatorname{tr} \\varepsilon(u) < 0$), whereas the given computed solution has a positive volumetric strain ($\\operatorname{tr} \\varepsilon(u_h) \\approx 0.002 > 0$). However, the problem asks to analyze a given \"computed ... solution,\" which can be, and in this case is, physically incorrect. The task is to use the residual to diagnose this incorrectness. The inconsistency is part of the pathological solution to be analyzed, rather than a flaw in the problem statement itself. The problem is a valid \"what if\" scenario for diagnostic purposes.\n\n### Step 3: Verdict and Action\nThe problem statement is valid. It describes a classic scenario in computational mechanics and poses a relevant question about error analysis. The solution process may now proceed.\n\n### Solution Derivation\nThe primary task is to analyze the volumetric residual, $r_{p,K}$, which is defined as the elementwise error in satisfying the volumetric constitutive relation.\nThe definition is given as:\n$$r_{p,K} = p_h + \\kappa \\operatorname{tr} \\varepsilon(u_h)$$\nWe are given the following information for a $2 \\times 2$ mesh of a domain discretized with equal-order quadrilateral elements ($Q_1-Q_1$):\n- Bulk modulus: $\\kappa = 1000$.\n- Volumetric strain is approximately constant: $\\operatorname{tr} \\varepsilon(u_h) \\approx s = 0.002$.\n- The discrete pressure field $p_h$ exhibits a checkerboard pattern. Let's label the elements:\n    - $K_{TL}$ (top-left) and $K_{BR}$ (bottom-right): $p_h = +5$.\n    - $K_{TR}$ (top-right) and $K_{BL}$ (bottom-left): $p_h = -5$.\n\nWe can now compute the residual $r_{p,K}$ for each element.\n\nFor the elements where $p_h = +5$ ($K_{TL}$ and $K_{BR}$):\n$$r_{p,K} \\approx 5 + (1000)(0.002) = 5 + 2 = 7$$\n\nFor the elements where $p_h = -5$ ($K_{TR}$ and $K_{BL}$):\n$$r_{p,K} \\approx -5 + (1000)(0.002) = -5 + 2 = -3$$\n\nThe theoretical solution for uniform hydrostatic compression should have a constant pressure $p = p_{\\mathrm{ext}}$ and a constant negative volumetric strain $\\operatorname{tr} \\varepsilon(u) = -p_{\\mathrm{ext}}/\\kappa$. For the exact solution, the volumetric constitutive relation $p + \\kappa \\operatorname{tr} \\varepsilon(u) = 0$ is satisfied exactly, meaning the true residual is zero everywhere.\n\nOur calculation based on the given FE solution shows that a checkerboard pattern in the pressure field $p_h$ directly produces a large-magnitude, oscillating pattern in the residual field $r_{p,K}$. The values alternate between approximately $7$ and $-3$. This non-zero, oscillating residual indicates that the numerical solution fails to satisfy the constitutive law and that this failure is linked to the spurious pressure mode. This demonstrates the diagnostic capability of the residual $r_{p,K}$.\n\n### Option-by-Option Analysis\n\n**A. In this scenario, the alternation of $p_h$ in sign will induce an alternation of $r_{p,K}$ in sign with large magnitude on the $2 \\times 2$ mesh, and this alternating pattern is a hallmark of a spurious pressure mode caused by violation of the Ladyzhenskaya–Babuška–Brezzi condition; additionally, the sensitivity of $r_{p,K}$ to such oscillations increases with $\\kappa$.**\n\n- Our calculation shows $r_{p,K}$ alternates between $\\approx 7$ and $\\approx -3$. This is an alternation in sign and the magnitudes are large.\n- The checkerboard pressure pattern is the canonical spurious mode for the $Q_1$–$Q_1$ element pair, which is known to violate the LBB stability condition. The residual $r_{p,K}$ inherits this pattern, making it an effective indicator.\n- The residual is $r_{p,K} = p_h + \\kappa \\operatorname{tr} \\varepsilon(u_h)$. As $\\kappa \\to \\infty$ (the incompressible limit), any error in approximating the condition $\\operatorname{tr} \\varepsilon(u_h) = 0$ is amplified by the large factor $\\kappa$. This makes the residual a highly sensitive measure of volumetric error in the nearly incompressible regime.\nThus, the statement is a correct and complete description of the situation.\n**Verdict: Correct**\n\n**B. If the equilibrium equation $\\nabla \\cdot \\sigma + b = 0$ happens to be satisfied elementwise in the discrete solution, then $r_{p,K}$ necessarily vanishes in every element, so a residual-based estimator cannot detect pressure oscillations.**\n\n- This statement confuses two distinct sources of residual error. The residual for the equilibrium equation is $r_{\\sigma} := \\nabla \\cdot \\sigma_h + b$. The volumetric residual is $r_{p,K} := p_h + \\kappa \\operatorname{tr} \\varepsilon(u_h)$. These correspond to two separate equations in the strong form of the problem.\n- A numerical solution can satisfy one equation well while failing to satisfy the other. Specifically, the checkerboard pressure mode is problematic because it lies (nearly) in the null space of the discrete gradient operator, meaning $\\nabla \\cdot (-p_h I)$ can be small even if $p_h$ is large and oscillatory. Therefore, the equilibrium residual $r_{\\sigma}$ can be small, while the constitutive residual $r_{p,K}$ is large due to the oscillating $p_h$.\n- The premise does not imply the conclusion. The two residuals are independent indicators of different types of error.\n**Verdict: Incorrect**\n\n**C. For equal-order $Q_1$–$Q_1$ interpolation in the nearly incompressible regime, reducing the mesh size alone ensures the checkerboard pattern in $p_h$ disappears and $r_{p,K} \\to 0$ uniformly as $h \\to 0$.**\n\n- This statement is false. The LBB condition is a property of the chosen finite element spaces for displacement and pressure, independent of the mesh size $h$ (though the LBB constant may depend on $h$).\n- For an LBB-unstable pair like $Q_1$–$Q_1$, the pressure approximation is not guaranteed to converge to the correct solution as the mesh is refined. The spurious oscillations typically persist and do not vanish upon mesh refinement ($h \\to 0$).\n- To eliminate the checkerboard modes, one must either switch to an LBB-stable element pair (e.g., Taylor-Hood $Q_2-P_1$) or introduce a stabilization term into the variational formulation (e.g., GLS or PSPG methods). Mesh refinement alone is not a remedy.\n**Verdict: Incorrect**\n\n**D. If $r_{p,K}$ is constant and positive over all elements, this indicates a smooth pressure field and demonstrates that the mixed formulation has eliminated volumetric locking.**\n\n- A non-zero residual ($r_{p,K} = C > 0$) signifies that the numerical solution violates the volumetric constitutive law, which should be $p + \\kappa \\operatorname{tr} \\varepsilon(u) = 0$. This indicates an error in the solution, not a success.\n- While a constant residual would rule out the specific alternating checkerboard pattern, it does not guarantee a \"smooth\" or correct pressure field.\n- More importantly, it does not demonstrate the elimination of volumetric locking. Volumetric locking is the spurious suppression of volumetric strain. If locking occurs, $\\operatorname{tr} \\varepsilon(u_h)$ might be driven to an artificially small value (e.g., $\\approx 0$). In this case, $r_{p,K} \\approx p_h$. If $p_h$ were constant, the residual would be constant, but this would be a symptom of a locked solution, not its absence. A constant, non-zero residual points to a systematic error, not a well-behaved solution.\n**Verdict: Incorrect**\n\n**E. Replacing the equal-order pair with an LBB-stable mixed pair (for example, Taylor–Hood) under the same loading and comparable mesh resolution yields $p_h \\approx -\\kappa \\operatorname{tr} \\varepsilon(u_h)$ elementwise, thereby driving $r_{p,K}$ close to zero and removing the alternating pattern.**\n\n- This describes the standard and correct approach to fixing the instability observed with the $Q_1$–$Q_1$ pair.\n- An LBB-stable pair, such as the Taylor-Hood ($Q_2$ for displacement, $P_1$ for pressure), provides the necessary control over the pressure approximation, preventing spurious, unphysical modes like the checkerboard pattern.\n- As a result, a convergent numerical method using a stable pair will produce a solution $(u_h, p_h)$ that is a good approximation of the true solution $(u, p)$. For the true solution, $p = -\\kappa \\operatorname{tr} \\varepsilon(u)$. Therefore, the computed solution will satisfy $p_h \\approx -\\kappa \\operatorname{tr} \\varepsilon(u_h)$.\n- This directly implies that the volumetric residual $r_{p,K} = p_h + \\kappa \\operatorname{tr} \\varepsilon(u_h)$ will be close to zero, and the alternating pattern, which was a symptom of instability, will be gone.\n**Verdict: Correct**", "answer": "$$\\boxed{AE}$$", "id": "3595875"}]}