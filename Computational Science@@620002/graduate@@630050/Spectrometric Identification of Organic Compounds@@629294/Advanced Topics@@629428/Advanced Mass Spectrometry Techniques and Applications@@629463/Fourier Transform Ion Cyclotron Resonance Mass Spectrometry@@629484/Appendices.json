{"hands_on_practices": [{"introduction": "The foundation of Fourier Transform Ion Cyclotron Resonance (FT-ICR) mass spectrometry lies in the precise and predictable relationship between an ion's mass-to-charge ratio ($m/z$) and its cyclotron frequency ($\\omega_c$) within a strong magnetic field. This exercise solidifies this core principle by having you calculate the change in frequency resulting from a well-defined change in mass. By examining a hypothetical gas-phase cation exchange reaction directly within the ICR cell, you will reinforce the fundamental equation $\\omega_c = qB/m$ that makes FT-ICR a premier technique for mass measurement [@problem_id:1463743].", "problem": "In a Fourier Transform Ion Cyclotron Resonance (FT-ICR) mass spectrometer, ions are trapped within a Penning trap by a strong, uniform axial magnetic field, $B$. The trapped ions undergo cyclotron motion in a plane perpendicular to the magnetic field. The angular frequency of this motion, known as the cyclotron frequency ($\\omega_c$), is measured to determine the ion's mass-to-charge ratio.\n\nConsider an experiment where a large, neutral molecule, $M$, with a precise monoisotopic mass of $m_M = 1200.500000$ u, is ionized and trapped. It is initially observed as a singly-charged sodium adduct, $[M+\\text{Na}]^+$. This precursor ion is then isolated in the ICR cell. Subsequently, a neutral potassium-containing reagent is introduced into the cell, inducing a gas-phase cation exchange reaction that completely converts the precursor ion into a singly-charged potassium adduct, $[M+\\text{K}]^+$.\n\nGiven the following exact monoisotopic masses for the neutral atoms:\n- Mass of a sodium atom, $m_{\\text{Na}} = 22.989770$ u\n- Mass of a potassium atom, $m_{\\text{K}} = 38.963707$ u\n\nFor the purpose of this calculation, assume the mass of an ion is the simple sum of the masses of its constituent neutral atoms/molecules. Calculate the numerical ratio of the cyclotron frequency of the product ion to that of the precursor ion, $\\omega_{[M+\\text{K}]^+} / \\omega_{[M+\\text{Na}]^+}$. Round your final answer to six significant figures.", "solution": "The cyclotron angular frequency for an ion of charge $q$ and mass $m$ in a uniform magnetic field $B$ is\n$$\n\\omega_{c}=\\frac{qB}{m}.\n$$\nFor two singly charged ions in the same magnetic field, the ratio of their cyclotron frequencies is inversely proportional to the ratio of their masses:\n$$\n\\frac{\\omega_{[M+\\text{K}]^{+}}}{\\omega_{[M+\\text{Na}]^{+}}}\n=\\frac{qB/m_{[M+\\text{K}]^{+}}}{qB/m_{[M+\\text{Na}]^{+}}}\n=\\frac{m_{[M+\\text{Na}]^{+}}}{m_{[M+\\text{K}]^{+}}}.\n$$\nWith the stated assumption that the ion mass is the sum of constituent neutral masses,\n$$\nm_{[M+\\text{Na}]^{+}}=m_{M}+m_{\\text{Na}}=1200.500000+22.989770=1223.489770,\n$$\n$$\nm_{[M+\\text{K}]^{+}}=m_{M}+m_{\\text{K}}=1200.500000+38.963707=1239.463707.\n$$\nTherefore,\n$$\n\\frac{\\omega_{[M+\\text{K}]^{+}}}{\\omega_{[M+\\text{Na}]^{+}}}\n=\\frac{1223.489770}{1239.463707}\n=1-\\frac{1239.463707-1223.489770}{1239.463707}\n=1-\\frac{15.973937}{1239.463707}.\n$$\nNumerically,\n$$\n\\frac{15.973937}{1239.463707}=0.0128877811506\\ldots,\n$$\nso\n$$\n\\frac{\\omega_{[M+\\text{K}]^{+}}}{\\omega_{[M+\\text{Na}]^{+}}}=0.987112218849\\ldots \\approx 0.987112\n$$\nafter rounding to six significant figures.", "answer": "$$\\boxed{0.987112}$$", "id": "1463743"}, {"introduction": "While the frequency-mass relationship is the basis of FT-ICR, its most celebrated capability is its unparalleled resolving power, $R = m/\\Delta m$. This practice transitions from principle to practical application, challenging you to determine the minimum resolving power needed to solve a common analytical problem: distinguishing between two potential molecular formulas that are nearly isobaric. This exercise not only quantifies the performance required but also contextualizes the capabilities of FT-ICR in relation to other high-resolution mass analyzers, highlighting its essential role in resolving extreme chemical complexity [@problem_id:3715422].", "problem": "An unknown compound measured by high-resolution mass spectrometry produces a singly charged monoisotopic peak at $m/z = 300$. Two plausible elemental formula assignments have computed exact monoisotopic masses that differ by $3\\ \\text{mDa}$ near $m/z = 300$. In spectrometric identification of organic compounds, the nominal mass is the integer mass that rounds the mass of the molecule to the nearest integer, whereas the exact mass is calculated from the isotope masses of the constituent elements, and the monoisotopic mass corresponds to the mass using the most abundant isotopes. Using the operational definition of resolving power at Full Width at Half Maximum (FWHM), determine the minimum resolving power necessary to baseline-resolve these two candidate formulas at $m/z = 300$. Then, based on this requirement, assess whether the following instruments are feasible for baseline resolution under the same acquisition conditions: a Quadrupole Time-of-Flight (Q-TOF) with resolving power $R = 40{,}000$ at $m/z = 300$, an Orbitrap high-field analyzer with resolving power $R = 240{,}000$ at $m/z = 300$, and a Fourier Transform Ion Cyclotron Resonance (FT-ICR) mass spectrometer with resolving power $R = 450{,}000$ at $m/z = 300$. Round the computed minimum resolving power to four significant figures and express your answer as a dimensionless resolving power.", "solution": "The problem is first subjected to validation to ensure its scientific and logical integrity.\n\n### Step 1: Extract Givens\n- A singly charged monoisotopic peak is observed at a mass-to-charge ratio $m/z = 300$.\n- Two plausible candidate formulas have computed exact monoisotopic masses that differ by $\\Delta m = 3\\ \\text{mDa}$.\n- This mass difference occurs near $m/z = 300$.\n- The resolving power, $R$, is defined at Full Width at Half Maximum (FWHM).\n- The objective is to find the minimum resolving power, $R_{min}$, required for baseline resolution.\n- The specifications of three mass spectrometers are provided for feasibility assessment:\n    1. Q-TOF: $R = 40,000$ at $m/z = 300$.\n    2. Orbitrap: $R = 240,000$ at $m/z = 300$.\n    3. FT-ICR: $R = 450,000$ at $m/z = 300$.\n- The final calculated resolving power must be rounded to four significant figures.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically grounded, well-posed, and objective. It utilizes fundamental concepts of mass spectrometry, such as resolving power, mass-to-charge ratio, and mass accuracy. The provided values for $m/z$, mass difference, and instrument resolving powers are realistic and consistent with modern analytical chemistry practice. The problem statement provides a clear objective and sufficient information to arrive at a unique, meaningful solution. The term \"baseline-resolve\" requires a standard interpretation. In the context of the FWHM-based definition of resolving power, the minimum condition for resolving two adjacent peaks of equal height is that the separation between their maxima ($\\Delta m$) is equal to the FWHM of an individual peak ($\\Delta m_{FWHM}$). This criterion ensures a distinct valley between the peaks and is the standard interpretation for such problems. Thus, the problem is not underspecified.\n\n### Step 3: Verdict and Action\nThe problem is deemed valid. A complete solution is now provided.\n\n### Solution Derivation\n\nThe resolving power, $R$, of a mass spectrometer is a measure of its ability to distinguish between two peaks of slightly different mass-to-charge ratios. The operational definition based on the Full Width at Half Maximum (FWHM) of a single peak is given by:\n$$\nR = \\frac{m}{\\Delta m_{FWHM}}\n$$\nwhere $m$ is the mass-to-charge ratio of the ion of interest, and $\\Delta m_{FWHM}$ is the width of the peak at $50\\%$ of its maximum height.\n\nThe problem requires determining the minimum resolving power needed to \"baseline-resolve\" two peaks. For two Gaussian peaks of equal intensity and width, the minimum condition to consider them resolved (i.e., to see a valley between them) is when the separation between their centers, $\\Delta m$, is equal to the FWHM of one of the peaks. To achieve the minimum required resolving power, $R_{min}$, we must have a peak width, $\\Delta m_{FWHM}$, that is at most equal to the mass difference between the two species we wish to separate.\n$$\n\\Delta m_{FWHM} \\le \\Delta m\n$$\nTo find the minimum resolving power, we set the peak width to its maximum allowable value for resolution, which is the mass difference itself:\n$$\n\\Delta m_{FWHM} = \\Delta m\n$$\nSubstituting this condition into the defining equation for resolving power gives the expression for the minimum required resolving power, $R_{min}$:\n$$\nR_{min} = \\frac{m}{\\Delta m}\n$$\nThe problem states that the analysis is for a singly charged ion ($z=1$) at $m/z = 300$. Therefore, the mass $m$ of the ion is $300\\ \\text{Da}$. The mass difference between the two candidate formulas is given as $\\Delta m = 3\\ \\text{mDa}$. We must convert this to Daltons (Da) to maintain consistent units:\n$$\n\\Delta m = 3\\ \\text{mDa} = 3 \\times 10^{-3}\\ \\text{Da} = 0.003\\ \\text{Da}\n$$\nNow we can calculate the minimum required resolving power:\n$$\nR_{min} = \\frac{300\\ \\text{Da}}{0.003\\ \\text{Da}} = \\frac{300}{3 \\times 10^{-3}} = 100 \\times 10^3 = 100000\n$$\nThe problem requires this result to be rounded to four significant figures. To express $100000$ with four significant figures, we use scientific notation: $1.000 \\times 10^5$.\n\nNext, we assess the feasibility of the three listed instruments. An instrument is considered feasible if its specified resolving power, $R_{\\text{instrument}}$, is greater than or equal to the minimum required resolving power, $R_{min}$.\n$$\nR_{\\text{instrument}} \\ge R_{min}\n$$\nIn this case, the condition for feasibility is $R_{\\text{instrument}} \\ge 100000$.\n\n1.  **Q-TOF Mass Spectrometer**:\n    The specified resolving power is $R_{Q-TOF} = 40000$.\n    Comparing this to the requirement: $40000 < 100000$.\n    Conclusion: The Q-TOF instrument is **not feasible** for resolving these two candidates.\n\n2.  **Orbitrap High-Field Analyzer**:\n    The specified resolving power is $R_{Orbitrap} = 240000$.\n    Comparing this to the requirement: $240000 > 100000$.\n    Conclusion: The Orbitrap instrument is **feasible** for resolving these two candidates.\n\n3.  **FT-ICR Mass Spectrometer**:\n    The specified resolving power is $R_{FT-ICR} = 450000$.\n    Comparing this to the requirement: $450000 > 100000$.\n    Conclusion: The FT-ICR instrument is **feasible** for resolving these two candidates.\n\nTherefore, the minimum resolving power required is $1.000 \\times 10^5$, and both the Orbitrap and FT-ICR instruments meet this requirement.", "answer": "$$\n\\boxed{1.000 \\times 10^{5}}\n$$", "id": "3715422"}, {"introduction": "This final, advanced practice delves into the digital signal processing at the heart of the \"Fourier Transform\" in FT-ICR. You will write a program to simulate an ion's time-domain signal (transient) and investigate the effects of zero-filling, a common step in data processing. This exercise is designed to build a deep, intuitive understanding of how zero-filling can improve the digital representation of a peak for more accurate mass determination, while demonstrating that it does not—and cannot—increase the true resolving power, which remains fundamentally limited by the signal acquisition time [@problem_id:3702851].", "problem": "Design and implement a complete, runnable program that demonstrates, using a simulated Fourier Transform Ion Cyclotron Resonance (FT-ICR) mass spectrometry transient, the effect of zero-filling on peak interpolation and the invariance of true resolving power. The goal is to show that zero-filling increases the sampling density of the discrete spectrum, thereby interpolating peak tops, but does not increase true resolving power, which is set by the finite acquisition time. Begin from foundational principles about discrete sampling and the Discrete Fourier Transform (DFT), and proceed without assuming or using any shortcut formulas beyond those fundamental bases.\n\nUse the following fundamental base:\n- A time-domain FT-ICR transient can be modeled (in one dimension) as a sum of exponentially damped cosines:\n$$ s(t) = \\sum_{i=1}^{M} A_i e^{-t/\\tau} \\cos\\left(2\\pi f_i t + \\phi_i\\right), $$\nwhere $A_i$ is amplitude, $\\tau$ is a decay constant (assumed common to all components for simplicity), $f_i$ is cyclotron frequency, and $\\phi_i$ is phase.\n- The Discrete Fourier Transform (DFT) of $N$ uniformly sampled points with sampling frequency $F_s$ yields a frequency bin spacing\n$$ \\Delta f = \\frac{F_s}{N} = \\frac{1}{T}, $$\nwhere $T$ is the total acquisition time in seconds of the non-zero transient ($T = N/F_s$).\n- Zero-filling is defined here as appending zeros to the end of the transient before the DFT so that the transform length becomes $M = z N$, where $z$ is an integer zero-fill factor ($z \\ge 1$). The DFT bin spacing becomes $\\Delta f_{\\text{bin}} = F_s/M$, but the spectral envelope due to the finite-duration window is unchanged.\n\nYour program must:\n1. Simulate the transient $s(t)$ on the interval $t \\in [0, T)$ with uniform sampling at $F_s$, for the specified test cases below. Implement a function to compute the one-sided magnitude spectrum using the Fast Fourier Transform (FFT) algorithm on a zero-filled vector of length $M = z N$ (where $z$ is the zero-fill factor). Normalize the one-sided magnitude spectrum so that a cosine at an exact DFT bin frequency and amplitude $A$ has a spectral peak magnitude equal to $A$ (i.e., use a scale factor of $2/M$ on the magnitude of the complex FFT for a real-valued transient).\n2. For each spectrum, identify the maximum magnitude and the frequency at which this maximum occurs by scanning the one-sided spectrum. Report both quantities for each zero-fill factor in the single-component test case.\n3. Demonstrate that true resolving power is unchanged by zero-filling by evaluating a resolvability criterion derived from the finite-duration acquisition: two tones at frequencies $f_1$ and $f_2$ are considered truly resolvable if and only if $|f_2 - f_1| > 1/T$. Compute and report a boolean for each zero-fill factor for two doublet test cases, one below the resolution limit and one above it.\n\nPhysical units and conventions:\n- Frequencies must be treated and reported in hertz (Hz).\n- Time must be treated and specified in seconds (s).\n- Angles (phases) may be set to zero; no angle-dependent quantities are asked in the output.\n- Amplitudes are arbitrary units and dimensionless.\n- All reported float results must be rounded to six decimal places.\n- Booleans must be printed as True or False.\n\nTest suite specification:\n- Sampling frequency: $F_s = 65536$ Hz.\n- Acquisition time: $T = 0.25$ s.\n- Number of non-zero samples: $N = F_s T = 16384$ samples.\n- Common decay constant: $\\tau = 10.0$ s.\n- Phase: $\\phi_i = 0$ for all $i$.\n- Zero-fill factors to evaluate: $z \\in \\{1, 2, 4\\}$.\n\nCase A (single component, peak interpolation via zero-filling):\n- One component with $A_1 = 1.0$, $f_1 = 10000.5$ Hz.\n- For each $z \\in \\{1, 2, 4\\}$, compute and report:\n  - The maximum one-sided magnitude $m_{\\max}(z)$ (dimensionless, rounded to six decimals).\n  - The frequency $f_{\\max}(z)$ at which the maximum occurs (Hz, rounded to six decimals).\n\nCase B (doublet, below resolution limit):\n- Two components with $A_1 = A_2 = 1.0$, frequencies $f_1 = 10000.5$ Hz and $f_2 = f_1 + 0.5 \\Delta f$, where $\\Delta f = 1/T$.\n- For each $z \\in \\{1, 2, 4\\}$, compute and report a boolean value indicating $|f_2 - f_1| > 1/T$. This evaluates true resolving power and must be independent of $z$.\n\nCase C (doublet, above resolution limit):\n- Two components with $A_1 = A_2 = 1.0$, frequencies $f_1 = 10000.5$ Hz and $f_2 = f_1 + 1.1 \\Delta f$, where $\\Delta f = 1/T$.\n- For each $z \\in \\{1, 2, 4\\}$, compute and report the same boolean $|f_2 - f_1| > 1/T$.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list of four lists, in the order:\n  - The list of $m_{\\max}(z)$ for $z \\in \\{1, 2, 4\\}$.\n  - The list of $f_{\\max}(z)$ for $z \\in \\{1, 2, 4\\}$.\n  - The list of booleans for Case B for $z \\in \\{1, 2, 4\\}$.\n  - The list of booleans for Case C for $z \\in \\{1, 2, 4\\}$.\nFor example, the printed line must look like:\n$$ [ [m_{\\max}(1), m_{\\max}(2), m_{\\max}(4)], [f_{\\max}(1), f_{\\max}(2), f_{\\max}(4)], [\\text{B}_1, \\text{B}_2, \\text{B}_4], [\\text{C}_1, \\text{C}_2, \\text{C}_4] ] $$\nwith all floats rounded to six decimals and all booleans rendered as True or False.", "solution": "The problem is valid. It is scientifically grounded in the principles of Fourier analysis and digital signal processing as applied to Fourier Transform Ion Cyclotron Resonance (FT-ICR) mass spectrometry. The problem is well-posed, with all necessary parameters and definitions provided for a unique and meaningful computational demonstration.\n\nThe objective is to demonstrate two fundamental properties of the Discrete Fourier Transform (DFT) using a simulated FT-ICR transient: first, how zero-filling improves the accuracy of peak parameter estimation (interpolation), and second, that zero-filling does not improve the true resolving power, which is fundamentally limited by the acquisition time of the signal.\n\n**1. Signal Model and Discretization**\n\nThe problem provides a continuous-time model for an FT-ICR transient signal, $s(t)$, as a sum of $M$ exponentially damped sinusoids:\n$$ s(t) = \\sum_{i=1}^{M} A_i e^{-t/\\tau} \\cos\\left(2\\pi f_i t + \\phi_i\\right) $$\nHere, $A_i$ is the amplitude, $\\tau$ is the signal decay constant, $f_i$ is the ion's cyclotron frequency, and $\\phi_i$ is its initial phase. For this analysis, we assume a common decay constant $\\tau = 10.0$ s and zero initial phase $\\phi_i = 0$ for all components.\n\nTo process this signal digitally, we must sample it at discrete time intervals. We sample the signal for a total duration of $T = 0.25$ s at a sampling frequency of $F_s = 65536$ Hz. This yields $N = F_s T = 16384$ discrete data points. The time for the $k$-th sample (where $k$ is an integer from $0$ to $N-1$) is given by $t_k = k/F_s$. The discrete-time signal, denoted $s[k]$, is thus:\n$$ s[k] = s(t_k) = \\sum_{i=1}^{M} A_i e^{-t_k/\\tau} \\cos\\left(2\\pi f_i t_k\\right) $$\nfor $k = 0, 1, \\dots, N-1$.\n\n**2. The Discrete Fourier Transform, Zero-Filling, and Spectrum Calculation**\n\nThe DFT transforms the time-domain signal $s[k]$ into a frequency-domain representation. The Fast Fourier Transform (FFT) is an efficient algorithm for computing the DFT.\n\nZero-filling is the process of appending zeros to the end of the acquired signal $s[k]$ before performing the FFT. If we start with $N$ data points and append $(z-1)N$ zeros, the total length of the signal for the transform becomes $M_{len} = zN$, where $z \\ge 1$ is the zero-fill factor.\n\nThe DFT of a real-valued signal of length $M_{len}$ results in a set of $M_{len}$ complex numbers. These numbers correspond to frequencies from $0$ Hz up to $F_s$. For a real-valued input, the resulting spectrum is conjugate-symmetric, so we only need to analyze the one-sided spectrum, which contains information about frequencies from $0$ Hz to the Nyquist frequency, $F_s/2$. The number of points in the one-sided spectrum is $M_{len}/2 + 1$.\n\nThe frequency resolution of the DFT, or the spacing between adjacent frequency bins, is given by $\\Delta f_{\\text{bin}} = F_s / M_{len}$. By increasing the transform length $M_{len}$ through zero-filling (i.e., increasing $z$), we decrease the bin spacing $\\Delta f_{\\text{bin}}$, effectively sampling the underlying continuous Fourier transform of the signal at a higher density.\n\nThe magnitude of the frequency-domain signal is calculated from the complex output of the FFT. To relate the peak magnitude in the spectrum to the amplitude $A_i$ of the original cosine wave, we must apply a normalization factor. For a one-sided spectrum of a real signal of length $M_{len}$, the magnitude of components at non-zero and non-Nyquist frequencies is scaled by $2/M_{len}$. The DC component (at $0$ Hz) and the Nyquist component (at $F_s/2$) are scaled by $1/M_{len}$.\n\n**3. Case A: Peak Interpolation via Zero-Filling**\n\nThis case uses a single sinusoidal component with an amplitude $A_1 = 1.0$ and a frequency $f_1 = 10000.5$ Hz. This frequency is intentionally chosen to fall between the natural frequency bins of the DFT without zero-filling.\n\nThe frequency bin spacing without zero-filling ($z=1$) is $\\Delta f = F_s/N = 65536/16384 = 4$ Hz. The frequency bins are located at integer multiples of $4$ Hz (e.g., $10000$ Hz, $10004$ Hz, etc.). The signal frequency $f_1 = 10000.5$ Hz does not coincide with any bin. Consequently, the signal energy is spread across multiple bins, and the maximum measured magnitude in the discrete spectrum, $m_{\\max}(1)$, will be lower than the true amplitude $A_1=1.0$ (an effect known as scalloping loss). The frequency corresponding to this maximum, $f_{\\max}(1)$, will be the frequency of the nearest bin, not the true signal frequency.\n\nBy applying zero-filling with factors $z=2$ and $z=4$, the transform length increases to $M_{len}=32768$ and $M_{len}=65536$, respectively. The frequency bin spacing decreases to $\\Delta f_{\\text{bin}} = 2$ Hz and $\\Delta f_{\\text{bin}} = 1$ Hz. This finer sampling of the spectral envelope means that one of the DFT frequency points will land closer to the true peak of the underlying continuous spectrum. As a result, the measured maximum magnitude $m_{\\max}(z)$ will increase and approach the true amplitude $A_1$, and the measured frequency $f_{\\max}(z)$ will provide a better estimate of the true frequency $f_1$. This demonstrates that zero-filling acts as an interpolation method, improving the estimation of peak parameters from the discrete spectrum.\n\n**4. Cases B and C: Invariance of True Resolving Power**\n\nThe ability to distinguish two closely spaced peaks is known as resolving power. For a signal acquired over a finite duration $T$, the fundamental limit on resolving power is dictated by the uncertainty principle. The spectral peak associated with a finite-duration signal has a finite width that is inversely proportional to $T$. A common criterion for resolving two peaks of equal intensity, known as the Rayleigh criterion, states that the peaks are resolvable if their frequency separation is greater than the width of the main lobe of the instrument's line shape. For a rectangular time-domain window of duration $T$, this translates to the condition that two frequencies, $f_1$ and $f_2$, are truly resolvable if and only if:\n$$ |f_2 - f_1| > \\frac{1}{T} $$\nThe value $\\Delta f_{res} = 1/T$ is the resolution limit. In this problem, $T=0.25$ s, so the resolution limit is $1/0.25 = 4$ Hz.\n\nZero-filling increases the number of points in the spectrum but does not add new information about the signal; it cannot narrow the intrinsic width of the spectral peaks, which is fixed by $T$. Therefore, true resolving power is invariant to zero-filling.\n\n- **Case B (Below Resolution Limit):** The frequencies are $f_1 = 10000.5$ Hz and $f_2 = f_1 + 0.5 \\Delta f_{res} = 10000.5 + 0.5 \\times 4 = 10002.5$ Hz. The frequency separation is $|f_2 - f_1| = 2$ Hz. Since $2 \\text{ Hz} \\ngtr 4 \\text{ Hz}$, the resolvability condition is **false**. This will hold true regardless of the zero-fill factor $z$. The two signals are not truly resolvable.\n\n- **Case C (Above Resolution Limit):** The frequencies are $f_1 = 10000.5$ Hz and $f_2 = f_1 + 1.1 \\Delta f_{res} = 10000.5 + 1.1 \\times 4 = 10004.9$ Hz. The frequency separation is $|f_2 - f_1| = 4.4$ Hz. Since $4.4 \\text{ Hz} > 4 \\text{ Hz}$, the resolvability condition is **true**. This will also hold true regardless of the zero-fill factor $z$. The two signals are truly resolvable.\n\nThe program will compute these boolean values for each value of $z$ to explicitly demonstrate this invariance.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Simulates FT-ICR transients to demonstrate the effects of zero-filling on\n    peak interpolation and the invariance of true resolving power.\n    \"\"\"\n    \n    # Test suite specification\n    Fs = 65536.0  # Sampling frequency in Hz\n    T = 0.25      # Acquisition time in seconds\n    N = int(Fs * T) # Number of non-zero samples\n    tau = 10.0      # Common decay constant in seconds\n    phi = 0.0       # Common phase in radians\n    z_factors = [1, 2, 4] # Zero-fill factors\n    \n    # Time vector for the non-zero transient\n    t = np.arange(N) / Fs\n\n    def generate_transient(frequencies, amplitudes, t_vec, tau_val, phi_val):\n        \"\"\"\n        Generates a transient signal as a sum of exponentially damped cosines.\n        \"\"\"\n        signal = np.zeros_like(t_vec)\n        for f, A in zip(frequencies, amplitudes):\n            signal += A * np.exp(-t_vec / tau_val) * np.cos(2 * np.pi * f * t_vec + phi_val)\n        return signal\n\n    def compute_spectrum(transient, z, Fs_val):\n        \"\"\"\n        Computes the one-sided magnitude spectrum of a transient using FFT\n        with zero-filling.\n        \"\"\"\n        N_transient = len(transient)\n        M_len = z * N_transient # Total length after zero-filling\n\n        # Create the zero-filled signal\n        padded_signal = np.zeros(M_len)\n        padded_signal[:N_transient] = transient\n\n        # Compute the one-sided FFT\n        # np.fft.rfft is efficient for real inputs\n        fft_complex = np.fft.rfft(padded_signal)\n        \n        # Frequency axis for the one-sided spectrum\n        freq_axis = np.fft.rfftfreq(M_len, d=1.0/Fs_val)\n\n        # Compute magnitude and apply normalization\n        # Scale factor is 2/M for a one-sided spectrum to preserve amplitude\n        magnitude = np.abs(fft_complex) * (2.0 / M_len)\n        \n        # The DC component (at index 0) is not doubled\n        magnitude[0] /= 2.0\n        \n        return freq_axis, magnitude\n\n    # --- Case A: Single component, peak interpolation ---\n    case_A_freqs = [10000.5]\n    case_A_amps = [1.0]\n    transient_A = generate_transient(case_A_freqs, case_A_amps, t, tau, phi)\n    \n    m_max_results = []\n    f_max_results = []\n\n    for z in z_factors:\n        freqs, mags = compute_spectrum(transient_A, z, Fs)\n        max_idx = np.argmax(mags)\n        m_max = mags[max_idx]\n        f_max = freqs[max_idx]\n        \n        m_max_results.append(round(m_max, 6))\n        f_max_results.append(round(f_max, 6))\n\n    # --- Case B: Doublet, below resolution limit ---\n    delta_f_res = 1.0 / T\n    f1_B = 10000.5\n    f2_B = f1_B + 0.5 * delta_f_res\n    \n    bool_B_results = []\n    for z in z_factors:\n        # The resolvability criterion is independent of z\n        is_resolvable = (abs(f2_B - f1_B) > delta_f_res)\n        bool_B_results.append(is_resolvable)\n\n    # --- Case C: Doublet, above resolution limit ---\n    f1_C = 10000.5\n    f2_C = f1_C + 1.1 * delta_f_res\n\n    bool_C_results = []\n    for z in z_factors:\n        # The resolvability criterion is independent of z\n        is_resolvable = (abs(f2_C - f1_C) > delta_f_res)\n        bool_C_results.append(is_resolvable)\n\n    # Compile all results into the final list structure\n    final_results = [\n        m_max_results,\n        f_max_results,\n        bool_B_results,\n        bool_C_results\n    ]\n\n    # Format the output string exactly as required\n    print(str(final_results).replace(\"'\", \"\").replace(\" \", \"\"))\n\nsolve()\n\n```", "id": "3702851"}]}