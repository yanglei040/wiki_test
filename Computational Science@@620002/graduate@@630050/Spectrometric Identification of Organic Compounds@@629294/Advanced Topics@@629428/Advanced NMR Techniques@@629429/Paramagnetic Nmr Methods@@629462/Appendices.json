{"hands_on_practices": [{"introduction": "Before embarking on complex data fitting, it is essential to develop an intuition for the scale of paramagnetic effects. This exercise provides a foundational, order-of-magnitude calculation of the pseudocontact shift (PCS) using the well-established point-dipole model. By working through this problem, you will solidify your understanding of how the key physical parameters—the distance from the paramagnetic center ($r$) and the anisotropy of the magnetic susceptibility ($\\Delta\\chi$)—determine the magnitude of the observed shift.", "problem": "In paramagnetic Nuclear Magnetic Resonance (NMR), the pseudocontact shift arises from the magnetic field produced at a nucleus by the anisotropic, field-induced magnetic moment of a paramagnetic center. Consider a proton located at a distance of $r = 5.00\\ \\text{\\AA}$ from a paramagnetic center with total spin $S = 5/2$ at temperature $T = 298\\ \\mathrm{K}$. Assume the following scientifically realistic and commonly used approximations for advanced paramagnetic NMR analysis:\n- The paramagnetic-induced shift is dominated by the pseudocontact contribution from an anisotropic magnetic susceptibility tensor, with negligible Fermi contact contribution.\n- The point-dipole model applies for the field of the induced paramagnetic moment at the nuclear position.\n- The susceptibility is in the Curie regime and linearly related to the applied field, and only the axial anisotropy is considered significant. Take a representative axial susceptibility anisotropy of $\\Delta \\chi_{\\mathrm{ax}} = 3.0 \\times 10^{-32}\\ \\mathrm{m}^3$ at $T = 298\\ \\mathrm{K}$, with the rhombic term negligible.\n- For an order-of-magnitude estimate, consider the nuclear position and susceptibility principal axis orientation that maximize the absolute value of the pseudocontact shift.\n\nUsing only these physical assumptions, standard magnetostatics for a magnetic dipole field, and the linear response relation between induced magnetic moment and magnetic susceptibility, compute the expected order of magnitude of the paramagnetically induced chemical shift at the proton in parts per million (ppm). Round your answer to two significant figures and express it in ppm units (do not include the unit in your final boxed answer).", "solution": "The problem statement is evaluated for validity before proceeding to a solution.\n\n### Step 1: Extract Givens\n- Nuclear species: proton\n- Distance from paramagnetic center to nucleus: $r = 5.00\\ \\text{\\AA}$\n- Total electron spin of the paramagnetic center: $S = 5/2$\n- Temperature: $T = 298\\ \\mathrm{K}$\n- Dominant shift mechanism: pseudocontact contribution\n- Negligible contribution: Fermi contact shift\n- Applicable model: point-dipole model\n- Susceptibility regime: Curie regime, linear response to applied field\n- Anisotropy consideration: only axial anisotropy is significant\n- Axial susceptibility anisotropy at $T = 298\\ \\mathrm{K}$: $\\Delta \\chi_{\\mathrm{ax}} = 3.0 \\times 10^{-32}\\ \\mathrm{m}^3$\n- Rhombic susceptibility anisotropy: negligible\n- Calculation condition: compute the maximum absolute value of the pseudocontact shift.\n- Required output format: chemical shift in parts per million (ppm), rounded to two significant figures.\n\n### Step 2: Validate Using Extracted Givens\n1.  **Scientifically Grounded**: The problem describes the pseudocontact shift (PCS), a fundamental concept in the NMR spectroscopy of paramagnetic molecules. The underlying physics, including the point-dipole approximation for the magnetic field of the paramagnetic center and the role of magnetic susceptibility anisotropy ($\\Delta \\chi$), is well-established. The given values for distance ($r = 5.00\\ \\text{\\AA}$), temperature ($T = 298\\ \\mathrm{K}$), spin state ($S=5/2$, common for high-spin $d^5$ ions like $\\text{Mn}^{2+}$ or $\\text{Fe}^{3+}$), and susceptibility anisotropy ($\\Delta \\chi_{\\mathrm{ax}} = 3.0 \\times 10^{-32}\\ \\mathrm{m}^3$) are physically realistic and consistent with values found in the chemical literature for metalloproteins and coordination complexes.\n2.  **Well-Posed**: The problem is well-posed. It requests the calculation of a specific physical quantity, the pseudocontact shift, and provides all necessary numerical data and physical approximations required for the calculation. The instruction to find the orientation that maximizes the absolute shift value removes any ambiguity about the geometric configuration, ensuring a unique solution.\n3.  **Objective**: The problem is stated in precise, quantitative, and objective language, free from any subjective or speculative claims.\n4.  **Complete and Consistent**: The problem is self-contained. The provision of the value for $\\Delta \\chi_{\\mathrm{ax}}$ makes the calculation direct. The spin and temperature values, while not directly used in the final calculation, serve as a consistency check for the realism of the given $\\Delta \\chi_{\\mathrm{ax}}$, which it passes. There are no contradictions in the provided data or assumptions.\n\n### Step 3: Verdict and Action\nThe problem is deemed **valid** as it is scientifically sound, well-posed, and internally consistent. A solution will be formulated.\n\nThe pseudocontact shift, $\\delta_{\\mathrm{pcs}}$, is the change in the nuclear resonance frequency caused by the magnetic field of a paramagnetic center, averaged over the rapid tumbling of the molecule in solution. Under the point-dipole approximation and the linear response of the induced magnetic moment to the external field, the shift is governed by the anisotropy of the magnetic susceptibility tensor, $\\boldsymbol{\\chi}$. For a system with axial symmetry, where the rhombic component is negligible, the standard equation for the pseudocontact shift at a nucleus is:\n$$ \\delta_{\\mathrm{pcs}} = \\frac{1}{12\\pi r^3} \\Delta\\chi_{\\mathrm{ax}} (3\\cos^2\\theta - 1) $$\nIn this equation:\n- $\\delta_{\\mathrm{pcs}}$ is the dimensionless chemical shift. It is conventionally reported in parts per million (ppm) by multiplying this value by $10^6$.\n- $\\Delta\\chi_{\\mathrm{ax}}$ is the anisotropy of the molecular magnetic susceptibility tensor in SI units ($\\mathrm{m}^3$), defined as $\\Delta\\chi_{\\mathrm{ax}} = \\chi_{zz} - \\frac{1}{2}(\\chi_{xx} + \\chi_{yy})$, where $z$ is the principal axis.\n- $r$ is the distance in meters from the paramagnetic center to the nucleus.\n- $\\theta$ is the angle between the principal axis of the susceptibility tensor and the vector connecting the paramagnetic center to the nucleus.\n\nThe problem provides the following values:\n- $r = 5.00\\ \\text{\\AA} = 5.00 \\times 10^{-10}\\ \\mathrm{m}$\n- $\\Delta \\chi_{\\mathrm{ax}} = 3.0 \\times 10^{-32}\\ \\mathrm{m}^3$\n\nThe problem requires finding the maximum absolute value of the shift. This depends on the geometric factor $G(\\theta) = 3\\cos^2\\theta - 1$. The value of this factor varies with the angle $\\theta$. The function $\\cos^2\\theta$ ranges from $0$ to $1$.\n- The maximum value of $G(\\theta)$ occurs when $\\cos^2\\theta = 1$ (i.e., $\\theta = 0$ or $\\theta = \\pi$), for which $G = 3(1) - 1 = 2$.\n- The minimum value of $G(\\theta)$ occurs when $\\cos^2\\theta = 0$ (i.e., $\\theta = \\frac{\\pi}{2}$), for which $G = 3(0) - 1 = -1$.\n\nThe maximum absolute value of the geometric factor is therefore $|G(\\theta)|_{\\mathrm{max}} = 2$. This corresponds to the proton being located on the principal axis of the magnetic susceptibility tensor.\n\nWe can now calculate the maximum absolute value of the dimensionless shift, $|\\delta_{\\mathrm{pcs}}|_{\\mathrm{max}}$:\n$$ |\\delta_{\\mathrm{pcs}}|_{\\mathrm{max}} = \\left| \\frac{\\Delta\\chi_{\\mathrm{ax}}}{12\\pi r^3} \\times (2) \\right| = \\frac{|\\Delta\\chi_{\\mathrm{ax}}|}{6\\pi r^3} $$\nSubstituting the given numerical values:\n$$ |\\delta_{\\mathrm{pcs}}|_{\\mathrm{max}} = \\frac{3.0 \\times 10^{-32}\\ \\mathrm{m}^3}{6\\pi (5.00 \\times 10^{-10}\\ \\mathrm{m})^3} $$\nFirst, calculate the denominator:\n$$ r^3 = (5.00 \\times 10^{-10}\\ \\mathrm{m})^3 = 125 \\times 10^{-30}\\ \\mathrm{m}^3 = 1.25 \\times 10^{-28}\\ \\mathrm{m}^3 $$\n$$ 6\\pi r^3 = 6\\pi \\times (1.25 \\times 10^{-28}\\ \\mathrm{m}^3) = 7.5\\pi \\times 10^{-28}\\ \\mathrm{m}^3 \\approx 23.5619 \\times 10^{-28}\\ \\mathrm{m}^3 $$\nNow, compute the shift:\n$$ |\\delta_{\\mathrm{pcs}}|_{\\mathrm{max}} = \\frac{3.0 \\times 10^{-32}\\ \\mathrm{m}^3}{23.5619 \\times 10^{-28}\\ \\mathrm{m}^3} \\approx 0.12732 \\times 10^{-4} = 1.2732 \\times 10^{-5} $$\nThis is the dimensionless shift value. To express it in parts per million (ppm), we multiply by $10^6$:\n$$ |\\delta_{\\mathrm{pcs}}|_{\\mathrm{max, ppm}} = |\\delta_{\\mathrm{pcs}}|_{\\mathrm{max}} \\times 10^6 = (1.2732 \\times 10^{-5}) \\times 10^6 = 12.732 $$\nThe problem requires the answer to be rounded to two significant figures, as the input value for $\\Delta \\chi_{\\mathrm{ax}}$ has two significant figures.\n$$ 12.732 \\approx 13 $$\nThe expected order of magnitude of the shift is approximately $13$ ppm.", "answer": "$$ \\boxed{13} $$", "id": "3717795"}, {"introduction": "In experimental science, raw data does not come with convenient labels. This practice moves beyond simple calculation to the critical skill of experimental design and data interpretation. It challenges you to develop a robust workflow to distinguish a true paramagnetic hyperfine shift from other spectroscopic phenomena, such as strong hydrogen bonding, which can also produce anomalously large chemical shifts. This thought exercise [@problem_id:3717813] emphasizes the power of using a suite of orthogonal experiments to arrive at an unambiguous conclusion.", "problem": "A paramagnetic organometallic sample exhibits one or more extremely downfield $^{1}\\mathrm{H}$ nuclear magnetic resonance signals. You must decide whether any such signal arises primarily from electron-nucleus hyperfine interactions (contact or pseudocontact paramagnetic shifts) or from strong hydrogen bonding of an exchangeable site (e.g., $\\mathrm{OH}$ or $\\mathrm{NH}$) in the presence of an unpaired-electron metal center. Assume you have access to the following auxiliary measurements: variable-temperature $^{1}\\mathrm{H}$ nuclear magnetic resonance with accurate chemical shift versus temperature data, deuterium exchange by $\\text{D}_2\\text{O}$ addition in a non-protic solvent, magnetic susceptibility by the Evans method, longitudinal and transverse relaxation times $T_{1}$ and $T_{2}$, heteronuclear single quantum coherence spectroscopy between $^{1}\\mathrm{H}$ and $^{13}\\mathrm{C}$, and a reversible redox toggle to a diamagnetic oxidation state without altering the primary connectivity of the organic ligand.\n\nBase your reasoning on first principles applicable to paramagnetic nuclear magnetic resonance and hydrogen-bond-induced chemical shifts. In particular, use the following as foundational: the chemical shift arising from electron-nucleus hyperfine interactions in paramagnets tracks the magnetic susceptibility, which in many high-spin cases follows Curie behavior $\\chi \\propto 1/T$ at sufficiently high temperature $T$; deuterium exchange replaces exchangeable protons and extinguishes their $^{1}\\mathrm{H}$ signals; and paramagnetic relaxation enhancement increases $R_{1}=1/T_{1}$ and $R_{2}=1/T_{2}$ with a distance dependence that can be modeled by dipolar coupling. Do not assume or use any unpublished shortcut criteria that are not derived from these bases.\n\nWhich of the following decision trees most reliably classifies an extreme downfield $^{1}\\mathrm{H}$ signal as hyperfine-shifted (contact/pseudocontact) versus strongly hydrogen-bonded in a paramagnetic sample, while using confirmatory checks to guard against confounders?\n\nA. Step $1$: Perform a $\\text{D}_2\\text{O}$ shake to test exchangeability. If the peak disappears or loses integral upon $\\text{D}_2\\text{O}$ addition, classify it as hydrogen-bonded exchangeable; if it persists unchanged, proceed. Step $2$: Acquire variable-temperature spectra and plot chemical shift versus $1/T$ for the persistent resonance. If the dependence is linear with sizeable slope consistent with Curie behavior and the resonance exhibits severely shortened $T_{1}$ (e.g., sub-$10$ ms) relative to distant ligand protons, classify as hyperfine-shifted; if the resonance instead drifts only modestly upfield with increasing $T$ without linearity in $1/T$ and has relatively longer $T_{1}$, classify as hydrogen-bonded. Step $3$: Confirm by redox toggling to a diamagnetic state: a collapse of the anomalous shift into a normal diamagnetic range while preserving ligand connectivity confirms a hyperfine origin. Step $4$: As orthogonal checks, use the Evans method to verify bulk paramagnetism and $^{1}\\mathrm{H}$–$^{13}\\mathrm{C}$ heteronuclear single quantum coherence spectroscopy to differentiate non-exchangeable $\\mathrm{C}\\!-\\!\\mathrm{H}$ (correlating) from fast-exchanging $\\mathrm{O}\\!-\\!\\mathrm{H}/\\mathrm{N}\\!-\\!\\mathrm{H}$ (often non-correlating).\n\nB. Step $1$: Classify solely by absolute chemical shift: any resonance at chemical shift greater than $12$ ppm is assigned to hydrogen bonding; any resonance at chemical shift greater than $20$ ppm is assigned to paramagnetic contact shift. Step $2$: Use the Evans method only to document that the sample is paramagnetic; no further temperature or exchange tests are necessary. Step $3$: If two assignments conflict, defer to the larger absolute chemical shift magnitude.\n\nC. Step $1$: Evaluate nuclear Overhauser effect spectroscopy cross-peak intensities at a single temperature: if the downfield resonance shows multiple cross-peaks, assume it is a slowly exchanging hydrogen bond; if it shows few cross-peaks, assume proximity to a metal center and assign hyperfine shift. Step $2$: Ignore temperature dependence because cross-relaxation rates already encode distance information. Step $3$: Skip $\\text{D}_2\\text{O}$ exchange because exchangeable protons may still display cross-peaks.\n\nD. Step $1$: Use the Evans method to determine that the sample has nonzero bulk magnetic susceptibility; then assign every extreme downfield resonance to a hyperfine origin. Step $2$: If a resonance remains after $\\text{D}_2\\text{O}$ addition, treat it as a hyperfine-shifted $\\mathrm{C}\\!-\\!\\mathrm{H}$; if it disappears, do not attempt to quantify temperature dependence because exchange processes are inherently temperature-sensitive and confounding. Step $3$: Confirm assignments by comparing $T_{2}$ alone without using $T_{1}$ or the $1/T$ chemical shift trend.\n\nChoose the single best option.", "solution": "The user has requested a critical validation of the problem statement, followed by a detailed solution and evaluation of the provided options.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n\n- **Scenario**: A paramagnetic organometallic sample exhibits one or more extremely downfield $^{1}\\mathrm{H}$ nuclear magnetic resonance (NMR) signals.\n- **Objective**: To decide whether a given signal arises primarily from electron-nucleus hyperfine interactions (contact or pseudocontact shifts) or from strong hydrogen bonding of an exchangeable site (e.g., $\\mathrm{OH}$ or $\\mathrm{NH}$) in the presence of the paramagnetic center.\n- **Available Auxiliary Measurements**:\n    1. Variable-temperature (VT) $^{1}\\mathrm{H}$ NMR with accurate chemical shift ($\\delta$) versus temperature ($T$) data.\n    2. Deuterium exchange by $\\text{D}_2\\text{O}$ addition in a non-protic solvent.\n    3. Magnetic susceptibility ($\\chi$) by the Evans method.\n    4. Longitudinal and transverse relaxation times, $T_{1}$ and $T_{2}$.\n    5. Heteronuclear single quantum coherence (HSQC) spectroscopy between $^{1}\\mathrm{H}$ and $^{13}\\mathrm{C}$.\n    6. A reversible redox toggle to a diamagnetic oxidation state without altering primary ligand connectivity.\n- **Foundational Principles**:\n    1. Chemical shift from hyperfine interactions tracks magnetic susceptibility ($\\chi$), which for many high-spin cases follows Curie behavior ($\\chi \\propto 1/T$) at sufficiently high temperature $T$.\n    2. Deuterium exchange replaces exchangeable protons, extinguishing their $^{1}\\mathrm{H}$ signals.\n    3. Paramagnetic relaxation enhancement (PRE) increases relaxation rates $R_{1}=1/T_{1}$ and $R_{2}=1/T_{2}$ with a distance dependence modeled by dipolar coupling.\n\n**Step 2: Validate Using Extracted Givens**\n\n- **Scientifically Grounded**: The problem is firmly rooted in the established principles of paramagnetic NMR spectroscopy and physical organic chemistry. The distinction between hyperfine shifts and chemical exchange/hydrogen bonding effects is a standard, albeit complex, topic in the characterization of paramagnetic molecules. The provided principles (Curie law, $\\text{D}_2\\text{O}$ exchange, PRE) are fundamental and correctly stated.\n- **Well-Posed**: The problem is well-posed. It asks for the \"most reliable\" decision tree among a set of options to distinguish between two well-defined physical phenomena. Given the provided experimental techniques and foundational principles, a logical and scientifically defensible choice can be made. The existence of a \"most reliable\" method implies a ranking based on scientific rigor, which is a question of a clear, analytical nature.\n- **Objective**: The problem is stated in precise, objective language. It defines the phenomena of interest (hyperfine vs. hydrogen bonding shifts) and lists specific, real-world experimental techniques. The task is to evaluate procedural options against established scientific principles, not subjective preferences.\n\nThe problem statement does not exhibit any of the flaws listed:\n1.  **Scientific Unsoundness**: No violations of scientific principles are present.\n2.  **Non-Formalizable**: The problem is directly formalizable using the equations and concepts of NMR spectroscopy.\n3.  **Incomplete/Contradictory**: The problem provides a sufficient set of tools and principles to arrive at a reasoned conclusion.\n4.  **Unrealistic/Infeasible**: The scenario and available techniques are entirely realistic in a modern chemistry research laboratory.\n5.  **Ill-Posed**: The question is structured to have a single best answer based on the reliability and completeness of the proposed experimental workflows.\n6.  **Trivial/Tautological**: The problem is complex, requiring a nuanced understanding of multiple spectroscopic techniques and their interplay in paramagnetic systems.\n7.  **Outside Verifiability**: The principles and methods are all scientifically verifiable.\n\n**Step 3: Verdict and Action**\n\nThe problem statement is valid. I will proceed with the solution.\n\n### Solution Derivation\n\nThe task is to identify the most reliable experimental procedure to distinguish between two potential causes for an extremely downfield $^{1}\\mathrm{H}$ NMR signal in a paramagnetic complex: (1) a hyperfine shift due to interaction with the unpaired electron(s) on the metal, and (2) a strong hydrogen bond.\n\n**Analysis of the Phenomena bases on First Principles:**\n\n1.  **Hyperfine Shift ($\\delta_{\\text{para}}$)**: This shift is the sum of the contact shift ($\\delta_{\\text{con}}$) and the pseudocontact shift ($\\delta_{\\text{pcs}}$). The key property is its direct dependence on the bulk magnetic susceptibility, $\\chi$. For a system obeying the Curie Law, $\\chi$ is proportional to $1/T$. Therefore, the observed chemical shift, $\\delta_{\\text{obs}} = \\delta_{\\text{dia}} + \\delta_{\\text{para}}$, should follow the relation: $\\delta_{\\text{obs}} \\propto 1/T$. A plot of $\\delta_{\\text{obs}}$ versus $1/T$ should be linear (at temperatures where the Curie law holds). The slope is related to the hyperfine coupling constant, and the intercept at $1/T = 0$ (infinite temperature) yields the diamagnetic shift, $\\delta_{\\text{dia}}$. Furthermore, the fluctuating magnetic field from the nearby electron spin is a powerful relaxation mechanism. This paramagnetic relaxation enhancement (PRE) leads to a dramatic decrease in relaxation times $T_1$ and $T_2$ (i.e., an increase in relaxation rates $R_1$ and $R_2$), causing significant line broadening. This effect is strongly distance-dependent, often modeled as proportional to $r^{-6}$, where $r$ is the electron-nucleus distance.\n\n2.  **Hydrogen Bonding Shift ($\\delta_{\\text{H-bond}}$)**: This shift arises from the deshielding of a proton involved in a hydrogen bond. Its magnitude depends on the strength of the bond. The hydrogen bond is a dynamic equilibrium. As temperature increases, the equilibrium typically shifts away from the H-bonded state, weakening the average H-bond interaction. This causes the signal to move upfield (to lower $\\delta$). This temperature dependence is governed by the thermodynamics of the H-bond equilibrium and will generally not be linear in a plot of $\\delta$ versus $1/T$. Protons in N-H and O-H groups are Lewis acidic and will typically exchange with labile deuterons from $\\text{D}_2\\text{O}$. If such a proton is not otherwise close to the paramagnetic center, its relaxation times $T_1$ and $T_2$ will be in the normal diamagnetic range (e.g., $T_1 > 100$ ms). However, in the context of the problem, the H-bond exists *in the presence* of the metal, so if the H-bonded proton is also spatially proximate to the metal, it will experience some PRE, a potential source of ambiguity if relaxation is the only criterion used.\n\n**Evaluation of the Options:**\n\n**Option A:**\n\n- **Step 1**: Perform a $\\text{D}_2\\text{O}$ shake. This is an excellent initial test. If the signal disappears, it is an exchangeable proton (e.g., $\\mathrm{OH}$, $\\mathrm{NH}$), making a hydrogen-bond origin highly plausible. If it persists, it is likely a non-exchangeable $\\mathrm{C-H}$ proton, for which a strong hydrogen bond is not a typical explanation for extreme shifts, thus pointing strongly toward a hyperfine origin. This is a very effective initial triage.\n- **Step 2**: For a persistent signal, plot $\\delta$ vs. $1/T$. Linearity and a large slope are the textbook signature of a Curie-law-obeying hyperfine-shifted proton. This is a powerful diagnostic. Simultaneously checking for a severely shortened $T_{1}$ (e.g., sub-$10$ ms) confirms proximity to the paramagnetic center, consistent with a large hyperfine interaction. The contrast with the expected behavior for an H-bond (modest upfield drift with increasing $T$, non-linear vs. $1/T$, longer $T_1$ if distant from the metal) is correctly drawn. This step is rigorous and diagnostic.\n- **Step 3**: Confirm via redox toggle. Converting the metal to a diamagnetic state removes the source of the hyperfine interaction. If the anomalous shift collapses into the normal diamagnetic range ($0-10$ ppm), it provides definitive proof of a paramagnetic origin for the shift. This is an exceptionally powerful, almost incontrovertible, confirmatory step.\n- **Step 4**: Use orthogonal checks. Measuring bulk paramagnetism via the Evans method confirms the necessary prerequisite for any paramagnetic effect. Using $^{1}\\mathrm{H}$–$^{13}\\mathrm{C}$ HSQC can confirm a C-H bond (a correlation peak is expected) for a non-exchangeable proton, differentiating it from an exchangeable O-H/N-H which often fails to show a correlation due to fast exchange. These checks add robustness and help resolve ambiguities.\n\n**Verdict on A**: This option outlines a comprehensive, logical, and multi-pronged experimental strategy that uses orthogonal techniques to build a highly reliable conclusion. Each step is based on sound first principles. This is the gold standard for such an analysis. **Correct**.\n\n**Option B:**\n\n- **Step 1 & 3**: Classifying based on absolute chemical shift thresholds (e.g., $\\delta > 12$ ppm or $\\delta > 20$ ppm) is a gross oversimplification and is scientifically unsound. The ranges for strong hydrogen bonds and hyperfine shifts overlap significantly. For example, low-barrier hydrogen bonds can have shifts $\\delta > 20$ ppm, and some hyperfine-shifted protons can appear in the $10-20$ ppm range. Using magnitude as the arbiter is arbitrary.\n- **Step 2**: Using the Evans method only to prove that the sample is paramagnetic and then stopping is a waste of critical information. It ignores the most powerful diagnostic tools like VT-NMR and $\\text{D}_2\\text{O}$ exchange.\n\n**Verdict on B**: This method is unreliable, based on arbitrary and incorrect rules of thumb, and ignores crucial experiments. **Incorrect**.\n\n**Option C:**\n\n- **Step 1**: Using nuclear Overhauser effect spectroscopy (NOESY) as the primary tool is problematic. While NOEs are distance-dependent, their intensities are also a complex function of correlation times and exchange rates. For paramagnetic molecules, PRE often broadens signals so severely (short $T_2$) that NOEs are quenched for protons close to the metal. Using the *number* of cross-peaks as a classifier is not a reliable metric.\n- **Step 2**: Ignoring temperature dependence is a critical error. The $\\delta$ vs. $1/T$ plot is one of the most powerful tools for identifying a hyperfine shift.\n- **Step 3**: Skipping the $\\text{D}_2\\text{O}$ exchange test discards a simple and highly effective means of identifying exchangeable protons, which are the candidates for hydrogen bonding.\n\n**Verdict on C**: This method relies on a dubious interpretation of NOESY in a paramagnetic context and willfully ignores the most diagnostic experiments available. **Incorrect**.\n\n**Option D:**\n\n- **Step 1**: The initial assumption that *every* extreme downfield resonance must have a hyperfine origin simply because the sample is paramagnetic is a logical fallacy of hasty generalization. It ignores the alternative, valid possibility of strong H-bonding, which is the entire point of the problem.\n- **Step 2**: The rationale for not quantifying temperature dependence for an exchangeable proton is flawed. While chemical exchange is temperature-dependent and can cause broadening, the underlying chemical shift's temperature dependence is still present and highly informative. Avoiding the measurement is avoiding crucial data.\n- **Step 3**: Using $T_2$ alone is insufficient. Proximity to the metal shortens $T_2$ via PRE, but this does not distinguish whether the downfield shift is *caused* by a hyperfine interaction or by an incidental H-bond that happens to be near the metal. Ignoring $T_1$ and, more importantly, the $\\delta$ vs. $1/T$ relationship, discards essential information.\n\n**Verdict on D**: This method starts with a flawed premise and then proceeds by advising against performing the key experiments that would falsify that premise. **Incorrect**.\n\n**Conclusion**\nOption A presents the most rigorous and reliable methodology. It systematically employs a series of orthogonal experiments, each of which provides a distinct piece of the puzzle. The sequence of tests—exchangeability, temperature dependence, relaxation, redox behavior, and structural confirmation—is logical and designed to build an unassailable case, guarding against potential confounders at each step.", "answer": "$$\\boxed{A}$$", "id": "3717813"}, {"introduction": "Having established the fundamental equation for the pseudocontact shift and the qualitative methods for its identification, we now progress to modern quantitative analysis. This advanced computational practice [@problem_id:3717788] demonstrates how to fit the PCS model to a set of noisy experimental measurements to precisely determine the magnetic susceptibility tensor parameters ($\\Delta \\chi_{ax}$ and $\\Delta \\chi_{rh}$). By implementing a Bayesian inference framework, this exercise introduces a rigorous statistical approach to handling experimental uncertainty, a crucial skill for high-resolution structure determination using paramagnetic restraints.", "problem": "Consider Nuclear Magnetic Resonance (NMR) spectroscopy in the presence of a paramagnetic center that induces pseudocontact shifts (PCS) on nearby nuclei through an anisotropic magnetic susceptibility tensor. Let the paramagnetic center be fixed at the origin in the laboratory frame, and let the principal axes of the susceptibility tensor be aligned with the laboratory axes. The anisotropy of the magnetic susceptibility tensor is characterized by its principal values $\\Delta \\chi_x$, $\\Delta \\chi_y$, and $\\Delta \\chi_z$. Define the axial and rhombic components by the standard decompositions $\\Delta \\chi_{ax} = \\Delta \\chi_z - (\\Delta \\chi_x + \\Delta \\chi_y)/2$ and $\\Delta \\chi_{rh} = \\Delta \\chi_x - \\Delta \\chi_y$. A nucleus $i$ located at position vector $\\mathbf{r}_i = (x_i,y_i,z_i)$ (in meters) experiences a PCS that depends on the distance $r_i = \\|\\mathbf{r}_i\\|$ and on the angular coordinates $(\\theta_i,\\phi_i)$ of $\\mathbf{r}_i$ in the laboratory frame, where $\\theta_i$ is the polar angle measured from the $z$ axis and $\\phi_i$ is the azimuthal angle in the $xy$-plane. Assume the PCS is small enough that the frequency shift can be treated linearly with respect to the susceptibility anisotropy.\n\nStarting from the magnetostatic field of a magnetic dipole induced by a uniform external field and the definition of the NMR chemical shift as a relative field perturbation, derive the PCS expression for a nucleus at $\\mathbf{r}_i$ in terms of $\\Delta \\chi_{ax}$ and $\\Delta \\chi_{rh}$, expressed as a linear model in these parameters with geometry-dependent coefficients. Use a physically justified point-dipole approximation and assume the susceptibility tensor principal axes coincide with the laboratory axes. Assume angles are expressed in radians.\n\nAssume the measured PCS values are corrupted by additive, independent, identically distributed Gaussian noise with known standard deviation. Formulate a Bayesian inference model for the parameters $\\Delta \\chi_{ax}$ and $\\Delta \\chi_{rh}$ using a zero-mean Gaussian prior with diagonal covariance. Derive the posterior mean and covariance for the parameters under this model. From the posterior distribution, compute the two-sided equal-tailed $95\\%$ credible intervals for $\\Delta \\chi_{ax}$ and $\\Delta \\chi_{rh}$.\n\nYour task is to implement a program that:\n- Computes the geometry-dependent coefficients from positions of nuclei.\n- Generates synthetic PCS measurements for each test case using the derived PCS model and the specified true parameter values, with additive Gaussian noise. The random number generator must be seeded deterministically so results are reproducible.\n- Performs Bayesian inference to obtain the posterior mean and covariance of $\\Delta \\chi_{ax}$ and $\\Delta \\chi_{rh}$.\n- Reports the $95\\%$ credible intervals for $\\Delta \\chi_{ax}$ and $\\Delta \\chi_{rh}$ for each test case.\n\nAll physical units must be handled explicitly:\n- Positions $(x_i,y_i,z_i)$ are in meters ($\\mathrm{m}$).\n- Susceptibility anisotropy components $\\Delta \\chi_{ax}$ and $\\Delta \\chi_{rh}$ must be reported in cubic meters ($\\mathrm{m}^3$).\n- PCS values are given in parts per million (ppm) and must be converted to dimensionless fractional shifts by multiplying by $10^{-6}$ before inference.\n- Angles must be in radians.\n\nUse the following prior for susceptibility components: a zero-mean Gaussian prior with diagonal covariance where the prior standard deviations are $s_{ax} = 5.0 \\times 10^{-30}\\ \\mathrm{m}^3$ and $s_{rh} = 5.0 \\times 10^{-30}\\ \\mathrm{m}^3$. The noise in PCS measurements is Gaussian with known standard deviation per test case, specified in ppm and to be converted to dimensionless by multiplying by $10^{-6}$.\n\nTest Suite:\n- Test Case $1$ (happy path):\n  - True parameters: $\\Delta \\chi_{ax}^{(true)} = 1.20 \\times 10^{-30}\\ \\mathrm{m}^3$, $\\Delta \\chi_{rh}^{(true)} = 0.80 \\times 10^{-30}\\ \\mathrm{m}^3$.\n  - Noise standard deviation: $\\sigma = 0.20\\ \\mathrm{ppm}$.\n  - Positions of the $10$ nuclei (each component in meters):\n    - $\\mathbf{r}_1 = (1.5 \\times 10^{-9},\\ 0.5 \\times 10^{-9},\\ 2.0 \\times 10^{-9})$,\n    - $\\mathbf{r}_2 = (-2.2 \\times 10^{-9},\\ 1.0 \\times 10^{-9},\\ 1.8 \\times 10^{-9})$,\n    - $\\mathbf{r}_3 = (0.0,\\ -2.5 \\times 10^{-9},\\ 2.5 \\times 10^{-9})$,\n    - $\\mathbf{r}_4 = (3.0 \\times 10^{-9},\\ 0.0,\\ 1.2 \\times 10^{-9})$,\n    - $\\mathbf{r}_5 = (-1.0 \\times 10^{-9},\\ -1.5 \\times 10^{-9},\\ 2.2 \\times 10^{-9})$,\n    - $\\mathbf{r}_6 = (0.8 \\times 10^{-9},\\ 2.2 \\times 10^{-9},\\ 1.6 \\times 10^{-9})$,\n    - $\\mathbf{r}_7 = (-2.5 \\times 10^{-9},\\ -0.7 \\times 10^{-9},\\ 2.1 \\times 10^{-9})$,\n    - $\\mathbf{r}_8 = (1.9 \\times 10^{-9},\\ -2.0 \\times 10^{-9},\\ 1.5 \\times 10^{-9})$,\n    - $\\mathbf{r}_9 = (0.5 \\times 10^{-9},\\ 1.0 \\times 10^{-9},\\ 3.0 \\times 10^{-9})$,\n    - $\\mathbf{r}_{10} = (-1.2 \\times 10^{-9},\\ 2.8 \\times 10^{-9},\\ 1.4 \\times 10^{-9})$.\n- Test Case $2$ (low noise, varied geometry):\n  - True parameters: $\\Delta \\chi_{ax}^{(true)} = -0.50 \\times 10^{-30}\\ \\mathrm{m}^3$, $\\Delta \\chi_{rh}^{(true)} = 0.30 \\times 10^{-30}\\ \\mathrm{m}^3$.\n  - Noise standard deviation: $\\sigma = 0.05\\ \\mathrm{ppm}$.\n  - Positions of the $10$ nuclei (each component in meters):\n    - $\\mathbf{r}_1 = (2.0 \\times 10^{-9},\\ 2.0 \\times 10^{-9},\\ 2.0 \\times 10^{-9})$,\n    - $\\mathbf{r}_2 = (-2.5 \\times 10^{-9},\\ 1.5 \\times 10^{-9},\\ 1.0 \\times 10^{-9})$,\n    - $\\mathbf{r}_3 = (1.0 \\times 10^{-9},\\ -1.0 \\times 10^{-9},\\ 3.0 \\times 10^{-9})$,\n    - $\\mathbf{r}_4 = (-3.0 \\times 10^{-9},\\ -2.0 \\times 10^{-9},\\ 1.5 \\times 10^{-9})$,\n    - $\\mathbf{r}_5 = (2.2 \\times 10^{-9},\\ -2.8 \\times 10^{-9},\\ 1.2 \\times 10^{-9})$,\n    - $\\mathbf{r}_6 = (-1.6 \\times 10^{-9},\\ 2.4 \\times 10^{-9},\\ 2.6 \\times 10^{-9})$,\n    - $\\mathbf{r}_7 = (0.9 \\times 10^{-9},\\ 1.7 \\times 10^{-9},\\ 2.3 \\times 10^{-9})$,\n    - $\\mathbf{r}_8 = (-2.1 \\times 10^{-9},\\ -1.8 \\times 10^{-9},\\ 2.2 \\times 10^{-9})$,\n    - $\\mathbf{r}_9 = (1.4 \\times 10^{-9},\\ -2.6 \\times 10^{-9},\\ 1.9 \\times 10^{-9})$,\n    - $\\mathbf{r}_{10} = (-0.8 \\times 10^{-9},\\ 2.9 \\times 10^{-9},\\ 1.4 \\times 10^{-9})$.\n- Test Case $3$ (edge case, limited azimuthal variation):\n  - True parameters: $\\Delta \\chi_{ax}^{(true)} = 0.90 \\times 10^{-30}\\ \\mathrm{m}^3$, $\\Delta \\chi_{rh}^{(true)} = 0.00 \\times 10^{-30}\\ \\mathrm{m}^3$.\n  - Noise standard deviation: $\\sigma = 0.50\\ \\mathrm{ppm}$.\n  - Positions of the $10$ nuclei (each component in meters; all $y_i = 0$ to reduce azimuthal information):\n    - $\\mathbf{r}_1 = (1.0 \\times 10^{-9},\\ 0.0,\\ 2.0 \\times 10^{-9})$,\n    - $\\mathbf{r}_2 = (2.0 \\times 10^{-9},\\ 0.0,\\ 2.0 \\times 10^{-9})$,\n    - $\\mathbf{r}_3 = (-1.5 \\times 10^{-9},\\ 0.0,\\ 2.2 \\times 10^{-9})$,\n    - $\\mathbf{r}_4 = (-2.0 \\times 10^{-9},\\ 0.0,\\ 1.8 \\times 10^{-9})$,\n    - $\\mathbf{r}_5 = (2.5 \\times 10^{-9},\\ 0.0,\\ 2.5 \\times 10^{-9})$,\n    - $\\mathbf{r}_6 = (1.2 \\times 10^{-9},\\ 0.0,\\ 3.0 \\times 10^{-9})$,\n    - $\\mathbf{r}_7 = (-2.8 \\times 10^{-9},\\ 0.0,\\ 1.6 \\times 10^{-9})$,\n    - $\\mathbf{r}_8 = (1.6 \\times 10^{-9},\\ 0.0,\\ 2.4 \\times 10^{-9})$,\n    - $\\mathbf{r}_9 = (-1.0 \\times 10^{-9},\\ 0.0,\\ 2.8 \\times 10^{-9})$,\n    - $\\mathbf{r}_{10} = (3.0 \\times 10^{-9},\\ 0.0,\\ 1.5 \\times 10^{-9})$.\n\nRandomness must be controlled by a fixed seed equal to $12345$ for all test cases. Angles must be computed in radians. Your program should produce a single line of output containing the results for the three test cases as a comma-separated list of lists, each inner list containing four floating-point numbers in the order $[\\text{low}_{ax},\\text{high}_{ax},\\text{low}_{rh},\\text{high}_{rh}]$, all in $\\mathrm{m}^3$, enclosed in square brackets. For example, the output format must be exactly of the form $[[a_1,b_1,c_1,d_1],[a_2,b_2,c_2,d_2],[a_3,b_3,c_3,d_3]]$ where each $a_k,b_k,c_k,d_k$ is a floating-point number.", "solution": "The pseudocontact shift (PCS) arises because a paramagnetic center with anisotropic magnetic susceptibility distorts the local magnetic field experienced by a nucleus. The paramagnetic center at the origin is subject to a uniform external field $\\mathbf{B}_0$ along the $z$ axis. In magnetostatics, a linear medium with magnetic susceptibility tensor $\\boldsymbol{\\chi}$ develops a magnetization $\\mathbf{M} = \\boldsymbol{\\chi}\\,\\mathbf{H}_0$, where $\\mathbf{H}_0$ is the external magnetic field in units of amperes per meter. The magnetization is equivalent to a magnetic dipole moment density aligned with $\\mathbf{B}_0$, leading to a point-dipole approximation for the perturbing field at a position $\\mathbf{r}$. The magnetic field of a point dipole $\\mathbf{m}$ at position $\\mathbf{r}$ is given by the well-tested formula\n$$\n\\mathbf{B}_{dip}(\\mathbf{r}) = \\frac{\\mu_0}{4\\pi r^3}\\left(3(\\mathbf{m}\\cdot \\hat{\\mathbf{r}})\\hat{\\mathbf{r}} - \\mathbf{m}\\right),\n$$\nwhere $\\mu_0$ is the magnetic constant, $r = \\|\\mathbf{r}\\|$, and $\\hat{\\mathbf{r}} = \\mathbf{r}/r$ is the radial unit vector. For an anisotropic susceptibility, the effective dipole moment induced by $\\mathbf{B}_0$ is aligned with the principal axes of $\\boldsymbol{\\chi}$ in the point-dipole approximation. The PCS is the relative change in the local field along the detection axis divided by $B_0$, and for small perturbations this translates into a chemical shift $\\delta_{PCS}$ that depends linearly on the anisotropic components of the susceptibility tensor.\n\nIn the commonly adopted PCS theory for an anisotropic but axially decomposed susceptibility tensor with principal axes coincident with the laboratory axes, the PCS at nucleus $i$ located at angular coordinates $(\\theta_i,\\phi_i)$ relative to the $z$ axis can be derived by resolving the dipole field along the detection axis and expressing the tensor anisotropy in terms of the axial and rhombic components. The susceptibility principal values $\\Delta \\chi_x$, $\\Delta \\chi_y$, $\\Delta \\chi_z$ are combined into the axial and rhombic anisotropies:\n$$\n\\Delta \\chi_{ax} = \\Delta \\chi_z - \\frac{\\Delta \\chi_x + \\Delta \\chi_y}{2}, \\quad \\Delta \\chi_{rh} = \\Delta \\chi_x - \\Delta \\chi_y.\n$$\nUnder the point-dipole approximation and after normalizing by $B_0$ to obtain a dimensionless chemical shift, one obtains the linear PCS model\n$$\n\\delta_{PCS,i} = g_{ax,i}\\,\\Delta \\chi_{ax} + g_{rh,i}\\,\\Delta \\chi_{rh},\n$$\nwith geometry-dependent coefficients\n$$\ng_{ax,i} = \\frac{1}{12\\pi r_i^3}\\left(3\\cos^2\\theta_i - 1\\right), \\quad\ng_{rh,i} = \\frac{1}{12\\pi r_i^3}\\left(\\frac{3}{2}\\sin^2\\theta_i \\cos(2\\phi_i)\\right),\n$$\nwhere $r_i = \\|\\mathbf{r}_i\\|$, $\\cos\\theta_i = z_i/r_i$, $\\sin^2\\theta_i = 1 - \\cos^2\\theta_i$, and $\\phi_i = \\mathrm{atan2}(y_i,x_i)$ in radians. This expression is derived from the dipolar field expression by projecting along the detection axis and using the traceless anisotropy decomposition; it is a well-tested formula in paramagnetic NMR theory and places the PCS as a linear superposition of axial and rhombic contributions, each scaling like $1/r^3$ with specific angular modulation.\n\nWe now formulate a Bayesian inference problem for $\\boldsymbol{\\theta} = [\\Delta \\chi_{ax}, \\Delta \\chi_{rh}]^\\top$. Let $\\mathbf{y} \\in \\mathbb{R}^N$ be the vector of observed PCS values for $N$ nuclei. In practice, PCS values are recorded in parts per million (ppm); these must be converted to dimensionless fractional shifts by multiplying by $10^{-6}$:\n$$\n\\mathbf{y}_{dimless} = 10^{-6}\\,\\mathbf{y}_{ppm}.\n$$\nLet $\\mathbf{G} \\in \\mathbb{R}^{N \\times 2}$ be the design matrix composed of the geometry-dependent coefficients:\n$$\n\\mathbf{G} = \\begin{bmatrix}\ng_{ax,1} & g_{rh,1}\\\\\n\\vdots & \\vdots\\\\\ng_{ax,N} & g_{rh,N}\n\\end{bmatrix}.\n$$\nAssume a Gaussian likelihood with independent, identically distributed noise of known standard deviation $\\sigma$ (in ppm), converted to dimensionless form $\\sigma_{dimless} = 10^{-6}\\sigma$:\n$$\n\\mathbf{y}_{dimless} \\mid \\boldsymbol{\\theta} \\sim \\mathcal{N}(\\mathbf{G}\\boldsymbol{\\theta},\\, \\sigma_{dimless}^2\\,\\mathbf{I}_N).\n$$\nAssume a zero-mean Gaussian prior for $\\boldsymbol{\\theta}$ with diagonal covariance\n$$\n\\boldsymbol{\\theta} \\sim \\mathcal{N}(\\mathbf{0},\\, \\boldsymbol{\\Sigma}_{prior}), \\quad \\boldsymbol{\\Sigma}_{prior} = \\mathrm{diag}(s_{ax}^2, s_{rh}^2),\n$$\nwhere $s_{ax} = 5.0 \\times 10^{-30}\\ \\mathrm{m}^3$ and $s_{rh} = 5.0 \\times 10^{-30}\\ \\mathrm{m}^3$.\n\nBecause both the prior and the likelihood are Gaussian and the model is linear, the posterior distribution is also Gaussian with mean and covariance given by the conjugate update:\n$$\n\\boldsymbol{\\Sigma}_{post} = \\left(\\boldsymbol{\\Sigma}_{prior}^{-1} + \\frac{1}{\\sigma_{dimless}^2}\\,\\mathbf{G}^\\top \\mathbf{G}\\right)^{-1}, \\quad\n\\boldsymbol{\\mu}_{post} = \\boldsymbol{\\Sigma}_{post} \\left(\\frac{1}{\\sigma_{dimless}^2}\\,\\mathbf{G}^\\top \\mathbf{y}_{dimless}\\right).\n$$\nFrom the posterior, the marginal distributions for $\\Delta \\chi_{ax}$ and $\\Delta \\chi_{rh}$ are univariate normals with means given by components of $\\boldsymbol{\\mu}_{post}$ and variances given by diagonal entries of $\\boldsymbol{\\Sigma}_{post}$. Therefore, two-sided equal-tailed $95\\%$ credible intervals are\n$$\n[\\mu_{ax} - z_{0.975}\\,\\sigma_{ax},\\, \\mu_{ax} + z_{0.975}\\,\\sigma_{ax}], \\quad\n[\\mu_{rh} - z_{0.975}\\,\\sigma_{rh},\\, \\mu_{rh} + z_{0.975}\\,\\sigma_{rh}],\n$$\nwhere $z_{0.975} \\approx 1.95996398454005$, and $\\sigma_{ax}^2 = (\\boldsymbol{\\Sigma}_{post})_{11}$, $\\sigma_{rh}^2 = (\\boldsymbol{\\Sigma}_{post})_{22}$.\n\nAlgorithmic steps for the program:\n1. For each test case, construct the list of position vectors $\\mathbf{r}_i$ in meters.\n2. Compute for each nucleus $i$:\n   - $r_i = \\sqrt{x_i^2 + y_i^2 + z_i^2}$,\n   - $\\cos\\theta_i = z_i / r_i$, $\\sin^2\\theta_i = 1 - \\cos^2\\theta_i$,\n   - $\\phi_i = \\mathrm{atan2}(y_i,x_i)$ in radians,\n   - $g_{ax,i} = \\dfrac{1}{12\\pi r_i^3}\\left(3\\cos^2\\theta_i - 1\\right)$,\n   - $g_{rh,i} = \\dfrac{1}{12\\pi r_i^3}\\left(\\dfrac{3}{2}\\sin^2\\theta_i \\cos(2\\phi_i)\\right)$.\n3. Form $\\mathbf{G}$ and generate synthetic dimensionless PCS data using the true parameters $\\Delta \\chi_{ax}^{(true)}$, $\\Delta \\chi_{rh}^{(true)}$ with Gaussian noise in dimensionless units. Use a fixed random seed equal to $12345$ for reproducibility. Specifically,\n   $$\n   \\mathbf{y}_{dimless} = \\mathbf{G}\\boldsymbol{\\theta}^{(true)} + \\epsilon, \\quad \\epsilon \\sim \\mathcal{N}(\\mathbf{0},\\, \\sigma_{dimless}^2\\,\\mathbf{I}_N).\n   $$\n4. Apply the Bayesian conjugate update to compute $\\boldsymbol{\\Sigma}_{post}$ and $\\boldsymbol{\\mu}_{post}$.\n5. Extract the $95\\%$ credible intervals for $\\Delta \\chi_{ax}$ and $\\Delta \\chi_{rh}$.\n6. Aggregate the results as a single line string in the format $[[a_1,b_1,c_1,d_1],[a_2,b_2,c_2,d_2],[a_3,b_3,c_3,d_3]]$, where all $a_k,b_k,c_k,d_k$ are floating-point values representing bounds in $\\mathrm{m}^3$.\n\nThis approach integrates fundamental magnetostatics and linear-Gaussian Bayesian inference into a robust algorithm capable of handling realistic noisy PCS data, including edge cases with limited azimuthal variation (which broaden the credible intervals for the rhombic component due to reduced identifiability).", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef compute_geometry_coefficients(positions):\n    \"\"\"\n    Compute geometry-dependent coefficients g_ax and g_rh for PCS.\n    positions: array of shape (N, 3) with positions in meters.\n    Returns G: array of shape (N, 2).\n    \"\"\"\n    x = positions[:, 0]\n    y = positions[:, 1]\n    z = positions[:, 2]\n    r = np.sqrt(x**2 + y**2 + z**2)\n    # Avoid division by zero: positions are non-zero by construction.\n    cos_theta = z / r\n    sin2_theta = 1.0 - cos_theta**2\n    phi = np.arctan2(y, x)  # radians\n    prefactor = 1.0 / (12.0 * np.pi * r**3)\n    g_ax = prefactor * (3.0 * cos_theta**2 - 1.0)\n    g_rh = prefactor * (1.5 * sin2_theta * np.cos(2.0 * phi))\n    G = np.column_stack((g_ax, g_rh))\n    return G\n\ndef bayesian_inference(G, y_dimless, sigma_dimless, s_ax, s_rh):\n    \"\"\"\n    Perform conjugate Bayesian inference for linear-Gaussian model.\n    Prior: theta ~ N(0, diag([s_ax^2, s_rh^2]))\n    Likelihood: y ~ N(G theta, sigma^2 I)\n    Returns posterior mean and covariance.\n    \"\"\"\n    # Prior covariance and its inverse\n    prior_var = np.array([s_ax**2, s_rh**2])\n    Sigma_prior_inv = np.diag(1.0 / prior_var)\n    # Likelihood precision\n    precision_lik = (1.0 / (sigma_dimless**2)) * (G.T @ G)\n    # Posterior covariance and mean\n    Sigma_post = np.linalg.inv(Sigma_prior_inv + precision_lik)\n    mu_post = Sigma_post @ ((1.0 / (sigma_dimless**2)) * (G.T @ y_dimless))\n    return mu_post, Sigma_post\n\ndef credible_intervals(mu_post, Sigma_post, z=1.95996398454005):\n    \"\"\"\n    Compute 95% equal-tailed credible intervals for each parameter.\n    Returns list [low_ax, high_ax, low_rh, high_rh]\n    \"\"\"\n    stds = np.sqrt(np.diag(Sigma_post))\n    low_ax = mu_post[0] - z * stds[0]\n    high_ax = mu_post[0] + z * stds[0]\n    low_rh = mu_post[1] - z * stds[1]\n    high_rh = mu_post[1] + z * stds[1]\n    return [low_ax, high_ax, low_rh, high_rh]\n\ndef format_results(results):\n    \"\"\"\n    Format list of lists of floats into the exact required single-line string\n    without spaces: [[a,b,c,d],[...],...]\n    \"\"\"\n    inner = []\n    for res in results:\n        inner.append(\"[\" + \",\".join(f\"{v:.6e}\" for v in res) + \"]\")\n    return \"[\" + \",\".join(inner) + \"]\"\n\ndef solve():\n    # Fixed random seed for reproducibility\n    rng = np.random.RandomState(12345)\n\n    # Prior std (m^3)\n    s_ax = 5.0e-30\n    s_rh = 5.0e-30\n\n    test_cases = []\n\n    # Test Case 1\n    positions1 = np.array([\n        [1.5e-9, 0.5e-9, 2.0e-9],\n        [-2.2e-9, 1.0e-9, 1.8e-9],\n        [0.0e0, -2.5e-9, 2.5e-9],\n        [3.0e-9, 0.0e0, 1.2e-9],\n        [-1.0e-9, -1.5e-9, 2.2e-9],\n        [0.8e-9, 2.2e-9, 1.6e-9],\n        [-2.5e-9, -0.7e-9, 2.1e-9],\n        [1.9e-9, -2.0e-9, 1.5e-9],\n        [0.5e-9, 1.0e-9, 3.0e-9],\n        [-1.2e-9, 2.8e-9, 1.4e-9],\n    ])\n    theta_true1 = np.array([1.20e-30, 0.80e-30])  # [Δχ_ax, Δχ_rh] in m^3\n    sigma_ppm1 = 0.20\n    test_cases.append((positions1, theta_true1, sigma_ppm1))\n\n    # Test Case 2\n    positions2 = np.array([\n        [2.0e-9, 2.0e-9, 2.0e-9],\n        [-2.5e-9, 1.5e-9, 1.0e-9],\n        [1.0e-9, -1.0e-9, 3.0e-9],\n        [-3.0e-9, -2.0e-9, 1.5e-9],\n        [2.2e-9, -2.8e-9, 1.2e-9],\n        [-1.6e-9, 2.4e-9, 2.6e-9],\n        [0.9e-9, 1.7e-9, 2.3e-9],\n        [-2.1e-9, -1.8e-9, 2.2e-9],\n        [1.4e-9, -2.6e-9, 1.9e-9],\n        [-0.8e-9, 2.9e-9, 1.4e-9],\n    ])\n    theta_true2 = np.array([-0.50e-30, 0.30e-30])  # in m^3\n    sigma_ppm2 = 0.05\n    test_cases.append((positions2, theta_true2, sigma_ppm2))\n\n    # Test Case 3\n    positions3 = np.array([\n        [1.0e-9, 0.0e0, 2.0e-9],\n        [2.0e-9, 0.0e0, 2.0e-9],\n        [-1.5e-9, 0.0e0, 2.2e-9],\n        [-2.0e-9, 0.0e0, 1.8e-9],\n        [2.5e-9, 0.0e0, 2.5e-9],\n        [1.2e-9, 0.0e0, 3.0e-9],\n        [-2.8e-9, 0.0e0, 1.6e-9],\n        [1.6e-9, 0.0e0, 2.4e-9],\n        [-1.0e-9, 0.0e0, 2.8e-9],\n        [3.0e-9, 0.0e0, 1.5e-9],\n    ])\n    theta_true3 = np.array([0.90e-30, 0.00e-30])  # in m^3\n    sigma_ppm3 = 0.50\n    test_cases.append((positions3, theta_true3, sigma_ppm3))\n\n    results = []\n\n    for positions, theta_true, sigma_ppm in test_cases:\n        G = compute_geometry_coefficients(positions)\n        # Generate synthetic dimensionless PCS data y = G theta_true + noise\n        sigma_dimless = sigma_ppm * 1.0e-6\n        noise = rng.normal(loc=0.0, scale=sigma_dimless, size=positions.shape[0])\n        y_dimless = G @ theta_true + noise\n        # Perform Bayesian inference\n        mu_post, Sigma_post = bayesian_inference(G, y_dimless, sigma_dimless, s_ax, s_rh)\n        # Credible intervals\n        ci = credible_intervals(mu_post, Sigma_post)\n        results.append(ci)\n\n    # Final print statement in the exact required format without spaces.\n    print(format_results(results))\n\nsolve()\n```", "id": "3717788"}]}