{"hands_on_practices": [{"introduction": "In classical molecular dynamics, hydrogen bonds are not explicitly defined but emerge from the interplay of electrostatic and van der Waals forces. To analyze these crucial interactions from a simulation trajectory, we must first define what constitutes a hydrogen bond. This practice introduces the most common approach: using geometric criteria based on donor-acceptor distance and angle, which serve as practical proxies for identifying these interactions [@problem_id:3417156]. By applying different sets of criteria to the same configurations, you will explore how the choice of definition impacts the quantitative analysis of hydrogen bonding networks.", "problem": "In Molecular Dynamics (MD), classical force fields (FFs) do not include an explicit hydrogen-bond term; instead, hydrogen bonding emerges from the superposition of electrostatic and van der Waals interactions. In trajectory analysis, hydrogen bonds are often classified using geometric proxies grounded in molecular geometry: the donor–hydrogen–acceptor (D–H...A) angle and an intermolecular heavy-atom separation, such as the oxygen–oxygen separation $r_{OO}$ in water. From first principles, the oxygen–oxygen separation $r_{OO}$ is the Euclidean distance $r_{OO} = |\\mathbf{r}_{O}^{(1)} - \\mathbf{r}_{O}^{(2)}|$ between the oxygen positions $\\mathbf{r}_{O}^{(1)}$ and $\\mathbf{r}_{O}^{(2)}$, and the D–H...A angle $\\phi$ is defined by the angle between two vectors constructed from atom positions in the donor and acceptor molecules, with linearity ($\\phi \\rightarrow 180^{\\circ}$) generally increasing hydrogen-bond character. In practice, geometric classification employs thresholds that reflect these correlations: shorter $r_{OO}$ and larger $\\phi$ are taken to indicate a stronger hydrogen-bond motif.\n\nConsider three independent trajectory frames in a classical FF simulation of liquid water, with measured oxygen–oxygen separations and D–H...A angles given, respectively, by the lists $[2.7, 3.0, 3.7]$ in Angstroms and $[170^{\\circ}, 140^{\\circ}, 155^{\\circ}]$ in degrees. Two geometric classification criteria are defined:\n- Criterion A: a hydrogen bond is present if $r_{OO} < 3.5$ Angstroms and $\\phi > 150^{\\circ}$.\n- Criterion B: a hydrogen bond is present if $r_{OO} < 3.3$ Angstroms and $\\phi > 160^{\\circ}$.\n\nStarting from the geometric definitions above and the physical rationale that hydrogen-bond strength increases with decreasing $r_{OO}$ and increasing $\\phi$, determine, for each criterion, how many of the three frames are classified as hydrogen-bonded. Then, explain any discrepancies between the two criteria by relating them to the stringency of the thresholds and the underlying physical interpretation in classical FFs.\n\nReport the final result as the pair $(n_A, n_B)$ in a single row matrix, where $n_A$ is the number of frames classified as hydrogen-bonded under Criterion A and $n_B$ is the number under Criterion B. Angles are specified in degrees and distances in Angstroms. No rounding is needed.", "solution": "The problem requires the classification of three configurations from a molecular dynamics simulation of water based on two distinct geometric criteria for hydrogen bonding. We are given the oxygen-oxygen separation $r_{OO}$ and the donor-hydrogen-acceptor angle $\\phi$ for each of the three frames. The task is to determine the number of hydrogen-bonded frames according to each criterion, $n_A$ and $n_B$, and to explain any differences in the classification based on the physical interpretation of the geometric thresholds.\n\nFirst, we formalize the data provided for the three independent trajectory frames. Let the frames be indexed by $i=1, 2, 3$.\n\nFor frame 1:\n$r_{OO,1} = 2.7$ Angstroms\n$\\phi_1 = 170^{\\circ}$\n\nFor frame 2:\n$r_{OO,2} = 3.0$ Angstroms\n$\\phi_2 = 140^{\\circ}$\n\nFor frame 3:\n$r_{OO,3} = 3.7$ Angstroms\n$\\phi_3 = 155^{\\circ}$\n\nThe two classification criteria are defined by logical conjunctions of inequalities:\nCriterion A: A hydrogen bond is present if $r_{OO} < 3.5$ Angstroms AND $\\phi > 150^{\\circ}$.\nCriterion B: A hydrogen bond is present if $r_{OO} < 3.3$ Angstroms AND $\\phi > 160^{\\circ}$.\n\nWe will now apply each criterion to the three frames.\n\n**Analysis using Criterion A:**\nThe conditions for Criterion A are $r_{OO} < 3.5$ and $\\phi > 150^{\\circ}$.\n\n- **Frame 1:**\n  - Is $r_{OO,1} < 3.5$? $2.7 < 3.5$. This is true.\n  - Is $\\phi_1 > 150^{\\circ}$? $170 > 150$. This is true.\n  - Since both conditions are satisfied, Frame $1$ is classified as hydrogen-bonded.\n\n- **Frame 2:**\n  - Is $r_{OO,2} < 3.5$? $3.0 < 3.5$. This is true.\n  - Is $\\phi_2 > 150^{\\circ}$? $140 > 150$. This is false.\n  - Since one condition is not satisfied, Frame $2$ is not classified as hydrogen-bonded.\n\n- **Frame 3:**\n  - Is $r_{OO,3} < 3.5$? $3.7 < 3.5$. This is false.\n  - Is $\\phi_3 > 150^{\\circ}$? $155 > 150$. This is true.\n  - Since one condition is not satisfied, Frame $3$ is not classified as hydrogen-bonded.\n\nCounting the frames that satisfy Criterion A, we find that only Frame $1$ is classified as hydrogen-bonded. Therefore, the number of hydrogen-bonded frames under Criterion A is $n_A = 1$.\n\n**Analysis using Criterion B:**\nThe conditions for Criterion B are $r_{OO} < 3.3$ and $\\phi > 160^{\\circ}$.\n\n- **Frame 1:**\n  - Is $r_{OO,1} < 3.3$? $2.7 < 3.3$. This is true.\n  - Is $\\phi_1 > 160^{\\circ}$? $170 > 160$. This is true.\n  - Since both conditions are satisfied, Frame $1$ is classified as hydrogen-bonded.\n\n- **Frame 2:**\n  - Is $r_{OO,2} < 3.3$? $3.0 < 3.3$. This is true.\n  - Is $\\phi_2 > 160^{\\circ}$? $140 > 160$. This is false.\n  - Since one condition is not satisfied, Frame $2$ is not classified as hydrogen-bonded.\n\n- **Frame 3:**\n  - Is $r_{OO,3} < 3.3$? $3.7 < 3.3$. This is false.\n  - The angle condition, $\\phi_3 > 160^{\\circ}$ ($155 > 160$), is also false.\n  - Since both conditions are not satisfied, Frame $3$ is not classified as hydrogen-bonded.\n\nCounting the frames that satisfy Criterion B, we find that only Frame $1$ is classified as hydrogen-bonded. Therefore, the number of hydrogen-bonded frames under Criterion B is $n_B = 1$.\n\n**Explanation of Discrepancies and Interpretation:**\nThe final counts are $(n_A, n_B) = (1, 1)$. For this specific dataset, there is no discrepancy in the total number of hydrogen bonds identified by each criterion. However, the criteria themselves are different, and their stringency reflects different physical assumptions.\n\nCriterion A uses a distance cutoff of $3.5$ Angstroms and an angle cutoff of $150^{\\circ}$. Criterion B uses a shorter distance cutoff of $3.3$ Angstroms and a larger angle cutoff of $160^{\\circ}$. This means Criterion B is more stringent than Criterion A. To be classified as a hydrogen bond under Criterion B, the donor-acceptor pair must be closer, and the D-H...A geometry must be more linear.\n\nThe physical rationale, as stated in the problem, is that hydrogen bond strength generally increases with decreasing $r_{OO}$ and increasing $\\phi$ (approaching the ideal linear geometry of $180^{\\circ}$). Therefore, the stricter thresholds of Criterion B are designed to identify a subset of stronger, more geometrically ideal hydrogen bonds. Criterion A, being more lenient, would generally capture a larger set of interactions, including weaker or more transient hydrogen bonds.\n\nIn this particular case, Frame $1$ ($r_{OO}=2.7$, $\\phi=170^{\\circ}$) represents a very strong and geometrically favorable hydrogen bond, so it satisfies both the lenient (A) and strict (B) criteria. Frame $2$ fails both criteria on the angle requirement, although it passes the distance check for both. Frame $3$ fails both criteria on the distance requirement. The fact that $n_A = n_B$ for this small sample is a coincidence. If a fourth frame existed with, for example, $r_{OO} = 3.4$ Angstroms and $\\phi = 155^{\\circ}$, it would be classified as hydrogen-bonded by Criterion A but not by Criterion B. This would lead to $n_A > n_B$, which is the expected relationship when comparing a lenient criterion to a strict one over a large statistical ensemble. The choice of criteria in MD analysis is thus a trade-off: stricter criteria isolate the most stable hydrogen bonds but may miss weaker or distorted ones, while lenient criteria provide a more inclusive count at the risk of including configurations with minimal hydrogen-bonding character.\n\nThe final result is the pair of counts $(n_A, n_B)$.", "answer": "$$\\boxed{\\begin{pmatrix} 1 & 1 \\end{pmatrix}}$$", "id": "3417156"}, {"introduction": "While many force fields treat hydrogen bonds implicitly, some employ explicit potential energy terms to capture their unique characteristics with greater accuracy. This exercise delves into the construction of such a term, specifically the 10-12 potential, a functional form designed to model the radial dependence of the hydrogen bond energy. You will derive the potential's parameters directly from fundamental physical observables: the equilibrium interaction distance ($r_e$) and the well depth ($D_e$) [@problem_id:3417116]. This practice illuminates the core process of parameterization, demonstrating how abstract mathematical models are rigorously connected to concrete, measurable properties of molecular systems.", "problem": "In Molecular Dynamics (MD) simulations using Classical Force Fields (CFFs), hydrogen bonding is often represented by an anisotropic potential constructed along the donor–acceptor axis. A commonly used radial form for the hydrogen bond interaction is a repulsive–attractive inverse-power potential,\n$$E(r) = \\frac{A}{r^{12}} - \\frac{B}{r^{10}},$$\nwhere $r$ is the scalar donor–acceptor separation, and $A$ and $B$ are positive parameters that must be calibrated to reproduce target features of a reference potential of mean force (PMF), such as the equilibrium separation and well depth. Suppose that a reference PMF provides an equilibrium separation $r_{e}$ and a well depth $D_{e}$, with the conventional sign convention $E(r_{e}) = -D_{e}$ and $D_{e} > 0$. Mechanical equilibrium requires the vanishing of the force at $r_{e}$, so that $\\left.\\frac{dE}{dr}\\right|_{r=r_{e}} = 0$. Assume $A>0$, $B>0$, $r_{e}>0$, and $D_{e}>0$.\n\nStarting from core definitions of mechanical equilibrium and potential energy, and without invoking any pre-tabulated parameterization shortcuts, do the following:\n- Derive analytic expressions for $A$ and $B$ in terms of $r_{e}$ and $D_{e}$ by enforcing the conditions $\\left.\\frac{dE}{dr}\\right|_{r=r_{e}} = 0$ and $E(r_{e}) = -D_{e}$ on $E(r)$.\n- Using your derived expressions, argue whether the pair $(A,B)$ is structurally identifiable from the pair $(r_{e},D_{e})$ for this model. In your discussion, clearly articulate what happens to identifiability if only the equilibrium condition or only the well-depth condition were available.\n- Finally, verify whether the stationary point at $r_{e}$ is indeed a local minimum for $D_{e}>0$ by evaluating the sign of the second derivative $\\left.\\frac{d^{2}E}{dr^{2}}\\right|_{r=r_{e}}$ using your expressions for $A$ and $B$.\n\nReport the final expressions for $A$ and $B$ compactly in a single row using the LaTeX $\\texttt{pmatrix}$ environment. Provide analytic expressions only; do not perform any numerical evaluation. If you were to evaluate numerically, energies should be in kilojoules per mole and distances in nanometers, but no units are required in the final boxed expressions. No rounding is required.", "solution": "The problem is validated as scientifically grounded, well-posed, and objective. It is a standard parameterization exercise in the field of computational chemistry, free of any conceptual or logical flaws. We may proceed with the solution.\n\nThe potential energy function for the hydrogen bond is given as:\n$$E(r) = \\frac{A}{r^{12}} - \\frac{B}{r^{10}}$$\nwhere $r$ is the donor–acceptor distance, and $A$ and $B$ are positive parameters. The problem requires us to determine $A$ and $B$ from two physical constraints derived from a reference potential of mean force: the equilibrium separation $r_{e}$ and the well depth $D_{e}$.\n\nThe two conditions are:\n1.  The potential energy at the equilibrium separation is equal to the negative of the well depth: $E(r_{e}) = -D_{e}$.\n2.  The force, which is the negative gradient of the potential, is zero at the equilibrium separation, implying that the first derivative of the potential energy with respect to separation is zero: $\\left.\\frac{dE}{dr}\\right|_{r=r_{e}} = 0$.\n\nWe are given that $A>0$, $B>0$, $r_{e}>0$, and $D_{e}>0$.\n\nFirst, we address the mechanical equilibrium condition. We compute the first derivative of $E(r)$ with respect to $r$:\n$$\\frac{dE}{dr} = \\frac{d}{dr}\\left(A r^{-12} - B r^{-10}\\right) = -12 A r^{-13} + 10 B r^{-11}$$\nSetting this derivative to zero at $r=r_{e}$ yields:\n$$\\left.\\frac{dE}{dr}\\right|_{r=r_{e}} = -12 A r_{e}^{-13} + 10 B r_{e}^{-11} = 0$$\n$$10 B r_{e}^{-11} = 12 A r_{e}^{-13}$$\nMultiplying by $r_{e}^{13}$ gives:\n$$10 B r_{e}^{2} = 12 A$$\nThis provides a relationship between $A$ and $B$:\n$$B = \\frac{12}{10} A r_{e}^{-2} = \\frac{6}{5} A r_{e}^{-2}$$\nThis equation is the result of the equilibrium condition alone.\n\nNext, we apply the well-depth condition: $E(r_{e}) = -D_{e}$.\n$$E(r_{e}) = A r_{e}^{-12} - B r_{e}^{-10} = -D_{e}$$\nNow we substitute the expression for $B$ from the equilibrium condition into this equation:\n$$A r_{e}^{-12} - \\left(\\frac{6}{5} A r_{e}^{-2}\\right) r_{e}^{-10} = -D_{e}$$\n$$A r_{e}^{-12} - \\frac{6}{5} A r_{e}^{-12} = -D_{e}$$\nFactoring out the term $A r_{e}^{-12}$:\n$$A r_{e}^{-12} \\left(1 - \\frac{6}{5}\\right) = -D_{e}$$\n$$A r_{e}^{-12} \\left(-\\frac{1}{5}\\right) = -D_{e}$$\nSolving for $A$:\n$$A = 5 D_{e} r_{e}^{12}$$\nThis is the analytical expression for the parameter $A$. Since $D_{e}>0$ and $r_{e}>0$, it follows that $A>0$, which is consistent with the initial problem statement.\n\nNow we find the expression for $B$ by substituting the derived expression for $A$ back into the relationship $B = \\frac{6}{5} A r_{e}^{-2}$:\n$$B = \\frac{6}{5} \\left(5 D_{e} r_{e}^{12}\\right) r_{e}^{-2}$$\n$$B = 6 D_{e} r_{e}^{10}$$\nThis is the analytical expression for the parameter $B$. Similarly, since $D_{e}>0$ and $r_{e}>0$, it follows that $B>0$, consistent with the problem statement.\n\nRegarding the structural identifiability of the pair $(A,B)$:\n- When both the equilibrium condition and the well-depth condition are provided, we have a system of two independent linear equations for $A$ and $B$ (after fixing $r_e$). This system yields a unique solution for $(A, B)$ given a specific pair of observables $(r_{e}, D_{e})$. Therefore, the parameters $(A, B)$ are structurally identifiable from the data $(r_{e}, D_{e})$. The derived expressions show this unique mapping explicitly.\n- If only the equilibrium condition $\\left.\\frac{dE}{dr}\\right|_{r=r_{e}} = 0$ were available, we would only have the relation $B = \\frac{6}{5} A r_{e}^{-2}$. This is one equation with two unknowns, defining a line in the $(A, B)$ parameter space. Any pair $(A, B)$ on this line would satisfy the condition, so the parameters would not be structurally identifiable.\n- If only the well-depth condition $E(r_{e}) = -D_{e}$ were available, we would have $A r_{e}^{-12} - B r_{e}^{-10} = -D_{e}$. This is also one equation with two unknowns, again defining a line in the $(A, B)$ parameter space. The parameters would not be structurally identifiable in this case either.\n\nFinally, we must verify that the stationary point at $r=r_{e}$ corresponds to a local minimum of the potential energy. This requires the second derivative of the potential to be positive at $r_{e}$, i.e., $\\left.\\frac{d^{2}E}{dr^{2}}\\right|_{r=r_{e}} > 0$.\nThe first derivative is $\\frac{dE}{dr} = -12 A r^{-13} + 10 B r^{-11}$.\nThe second derivative is:\n$$\\frac{d^{2}E}{dr^{2}} = \\frac{d}{dr}\\left(-12 A r^{-13} + 10 B r^{-11}\\right) = (-12)(-13) A r^{-14} + (10)(-11) B r^{-12}$$\n$$\\frac{d^{2}E}{dr^{2}} = 156 A r^{-14} - 110 B r^{-12}$$\nEvaluating at $r=r_{e}$:\n$$\\left.\\frac{d^{2}E}{dr^{2}}\\right|_{r=r_{e}} = 156 A r_{e}^{-14} - 110 B r_{e}^{-12}$$\nNow, we substitute the expressions for $A$ and $B$ in terms of $r_{e}$ and $D_{e}$:\n$$A = 5 D_{e} r_{e}^{12}$$\n$$B = 6 D_{e} r_{e}^{10}$$\n$$\\left.\\frac{d^{2}E}{dr^{2}}\\right|_{r=r_{e}} = 156 (5 D_{e} r_{e}^{12}) r_{e}^{-14} - 110 (6 D_{e} r_{e}^{10}) r_{e}^{-12}$$\n$$\\left.\\frac{d^{2}E}{dr^{2}}\\right|_{r=r_{e}} = 780 D_{e} r_{e}^{-2} - 660 D_{e} r_{e}^{-2}$$\n$$\\left.\\frac{d^{2}E}{dr^{2}}\\right|_{r=r_{e}} = (780 - 660) D_{e} r_{e}^{-2} = 120 D_{e} r_{e}^{-2} = \\frac{120 D_{e}}{r_{e}^{2}}$$\nGiven that $D_{e} > 0$ and $r_{e} > 0$ from the problem statement, the numerator $120 D_{e}$ is positive, and the denominator $r_{e}^{2}$ is also positive. Thus, the entire expression for the second derivative is positive.\nSince $\\left.\\frac{d^{2}E}{dr^{2}}\\right|_{r=r_{e}} > 0$, the stationary point at $r=r_{e}$ is confirmed to be a local minimum, as expected for a stable equilibrium.\n\nThe final derived expressions for $A$ and $B$ are $A = 5 D_{e} r_{e}^{12}$ and $B = 6 D_{e} r_{e}^{10}$.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n5 D_{e} r_{e}^{12} & 6 D_{e} r_{e}^{10}\n\\end{pmatrix}\n}\n$$", "id": "3417116"}, {"introduction": "We have seen that hydrogen bonds can be identified using either geometric proxies or direct energy calculations. This advanced practice challenges you to bridge the gap between these two perspectives by building and comparing both types of classifiers from first principles. You will implement an energy-based definition using fundamental Coulomb and Lennard-Jones interaction terms and contrast its classifications with those from a standard geometric criterion [@problem_id:3417161]. This exercise provides a deep, hands-on understanding of the nuances of hydrogen bond definitions, revealing where and why these different physical models may agree or disagree in their description of molecular interactions.", "problem": "You are asked to construct an energy-based definition of a hydrogen bond within a classical force field and compare its binary classification to a geometric definition on a fixed test suite of dimer configurations. Start from fundamental physical definitions for electrostatics and van der Waals interactions used in Molecular Dynamics (MD), and do not introduce any ad hoc formulas beyond those definitions and the geometry you explicitly compute.\n\nThe energy-based definition declares a hydrogen bond present when the hydrogen bond energy is less than or equal to a calibrated threshold. The hydrogen bond energy is defined as the sum of a Coulombic term between a hydrogen donor atom and an acceptor atom, and a Lennard-Jones (LJ) term between the donor oxygen and the acceptor atom:\n$$E_{HB} = E_{\\mathrm{Coul}}(H\\text{-}A) + E_{\\mathrm{LJ}}(O\\text{-}A).$$\nUse the following fundamental definitions:\n- Coulomb energy with a relative dielectric constant:\n$$E_{\\mathrm{Coul}} = k_e \\frac{q_i q_j}{\\varepsilon_r r_{ij}},$$\nwhere $k_e = 332.06371$ in $\\text{kcal}\\,\\text{mol}^{-1}\\,\\text{\\AA}\\,e^{-2}$, $\\varepsilon_r$ is a dimensionless relative dielectric constant, $q_i$ and $q_j$ are partial charges in units of $e$, and $r_{ij}$ is an interatomic separation in $\\text{\\AA}$.\n- Lennard-Jones energy:\n$$E_{\\mathrm{LJ}}(r) = 4\\varepsilon\\left[\\left(\\frac{\\sigma}{r}\\right)^{12}-\\left(\\frac{\\sigma}{r}\\right)^6\\right],$$\nwith $\\varepsilon$ in $\\text{kcal}\\,\\text{mol}^{-1}$, $\\sigma$ in $\\text{\\AA}$, and $r$ in $\\text{\\AA}$. For unlike atoms $i$ and $j$, use Lorentz-Berthelot combining rules:\n$$\\sigma_{ij} = \\frac{\\sigma_i + \\sigma_j}{2}, \\quad \\varepsilon_{ij} = \\sqrt{\\varepsilon_i \\varepsilon_j}.$$\n\nAssume a water-like donor with the following parameters and geometry:\n- Donor oxygen at $\\mathbf{O} = (0,0,0)$ in $\\text{\\AA}$.\n- Donor hydrogen at $\\mathbf{H} = (0.96,0,0)$ in $\\text{\\AA}$, where $0.96$ is the O–H bond length in $\\text{\\AA}$.\n- Partial charges: $q_H = +0.417$, $q_A = -0.5$ (acceptor oxygen), in units of $e$.\n- Relative dielectric constant: $\\varepsilon_r = 4.0$ (dimensionless).\n- Lennard-Jones parameters for oxygen: $\\sigma_O = 3.1507$ in $\\text{\\AA}$, $\\varepsilon_O = 0.1521$ in $\\text{kcal}\\,\\text{mol}^{-1}$. The acceptor atom $A$ is an oxygen of the same type, so $\\sigma_A = \\sigma_O$, $\\varepsilon_A = \\varepsilon_O$.\n\nTo construct the geometry, each dimer configuration is specified by the oxygen–acceptor separation $d_{OA}$ in $\\text{\\AA}$ and the donor–hydrogen–acceptor angle $\\alpha$ in degrees (the angle at the hydrogen between vectors $\\mathbf{D}-\\mathbf{H}$ and $\\mathbf{A}-\\mathbf{H}$, where $\\mathbf{D}$ is the donor heavy atom $\\mathbf{O}$). Use the following construction for the acceptor position $\\mathbf{A}$ in the plane $z=0$:\n- Let $\\hat{\\mathbf{u}}(\\alpha)$ be a unit vector such that the angle between $\\mathbf{D}-\\mathbf{H}$ and $\\hat{\\mathbf{u}}$ is $\\alpha$. With $\\mathbf{D}-\\mathbf{H} = (-0.96,0,0)$, choose\n$$\\hat{\\mathbf{u}}(\\alpha) = \\left(-\\cos \\alpha, \\sin \\alpha, 0\\right),$$\nwith $\\alpha$ in radians for the trigonometric functions.\n- Let $\\mathbf{h} = \\mathbf{H}$ and $h^2 = \\|\\mathbf{h}\\|^2$. Determine the unique nonnegative $r_{HA}$ satisfying\n$$\\|\\mathbf{h} + r_{HA} \\hat{\\mathbf{u}}(\\alpha)\\| = d_{OA},$$\nwhich solves the quadratic equation\n$$r_{HA}^2 + 2(\\mathbf{h}\\cdot\\hat{\\mathbf{u}})r_{HA} + \\left(h^2 - d_{OA}^2\\right) = 0.$$\nTake the physically meaningful root\n$$r_{HA} = -(\\mathbf{h}\\cdot\\hat{\\mathbf{u}}) + \\sqrt{(\\mathbf{h}\\cdot\\hat{\\mathbf{u}})^2 - \\left(h^2 - d_{OA}^2\\right)}.$$\n- Set $\\mathbf{A} = \\mathbf{H} + r_{HA}\\ \\hat{\\mathbf{u}}(\\alpha)$. Then $r_{HA} = \\|\\mathbf{A}-\\mathbf{H}\\|$ and $r_{OA} = d_{OA}$ by construction.\n\nDefine the geometric hydrogen-bond criterion as “hydrogen-bonded” if and only if both $d_{OA} \\le 3.5$ in $\\text{\\AA}$ and $\\alpha \\ge 150$ in degrees. Angle comparisons must be performed in degrees. Boundary values equal to the thresholds must count as hydrogen-bonded under the geometric rule.\n\nCalibrate the energy threshold $E^\\star$ by requiring that the configuration with $d_{OA}^{(\\mathrm{cal})} = 3.5$ in $\\text{\\AA}$ and $\\alpha^{(\\mathrm{cal})} = 150$ in degrees lies exactly on the boundary of the energy-based classifier. That is, compute $E^\\star = E_{HB}(d_{OA}^{(\\mathrm{cal})}, \\alpha^{(\\mathrm{cal})})$ using the definitions above. The energy-based classifier is then “hydrogen-bonded” if and only if $E_{HB} \\le E^\\star$.\n\nImplement a program that:\n- Builds each configuration using the construction above.\n- Computes $E_{HB}$ in $\\text{kcal}\\,\\text{mol}^{-1}$.\n- Classifies each configuration by both rules (geometric and energy-based).\n- For each test case, outputs the integer $1$ if both classifiers agree (both “hydrogen-bonded” or both “not hydrogen-bonded”), and $0$ otherwise.\n\nUse the following test suite (all $d_{OA}$ in $\\text{\\AA}$, all $\\alpha$ in degrees):\n- $\\left(d_{OA}, \\alpha\\right) = \\left(2.8, 170\\right)$,\n- $\\left(d_{OA}, \\alpha\\right) = \\left(3.0, 120\\right)$,\n- $\\left(d_{OA}, \\alpha\\right) = \\left(4.0, 160\\right)$,\n- $\\left(d_{OA}, \\alpha\\right) = \\left(3.5, 150\\right)$,\n- $\\left(d_{OA}, \\alpha\\right) = \\left(3.6, 180\\right)$,\n- $\\left(d_{OA}, \\alpha\\right) = \\left(3.2, 150\\right)$.\n\nFinal output format: Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, for example $[x_1,x_2,\\dots,x_6]$, where each $x_i$ is an integer $0$ or $1$ corresponding to the $i$-th test case in the order listed above. No other output is permitted. All energies must be computed and compared in $\\text{kcal}\\,\\text{mol}^{-1}$, all lengths in $\\text{\\AA}$, and all angles in degrees. Angle trigonometric functions must internally use radians.", "solution": "The user has provided a valid, well-posed computational problem in the field of molecular modeling. The task is to implement and compare two different definitions of a hydrogen bond—one based on geometry and one based on interaction energy—for a series of water-like dimer configurations. The solution requires a multi-step procedure involving geometric construction, energy calculation, calibration of an energy threshold, and classification.\n\nThe logical steps to solve this problem are as follows:\n\n1.  **Define System Parameters and Constants**:\n    All physical parameters and constants required for the calculation are explicitly provided.\n    - Positions of the donor oxygen $\\mathbf{O}$ and hydrogen $\\mathbf{H}$ are fixed at $\\mathbf{O}=(0,0,0)\\,\\text{\\AA}$ and $\\mathbf{H}=(0.96,0,0)\\,\\text{\\AA}$, respectively. The donor O-H bond length is thus $h = 0.96\\,\\text{\\AA}$.\n    - Partial charges for the Coulomb interaction are $q_H = +0.417\\,e$ and $q_A = -0.5\\,e$, where $A$ is the acceptor oxygen atom.\n    - The Lennard-Jones parameters for an oxygen atom are $\\sigma_O = 3.1507\\,\\text{\\AA}$ and $\\varepsilon_O = 0.1521\\,\\text{kcal}\\,\\text{mol}^{-1}$. Since the acceptor $A$ is also an oxygen of the same type, Lorentz-Berthelot combining rules yield interaction parameters $\\sigma_{OA} = (\\sigma_O+\\sigma_O)/2 = \\sigma_O$ and $\\varepsilon_{OA} = \\sqrt{\\varepsilon_O\\varepsilon_O} = \\varepsilon_O$.\n    - Constants for the energy calculation are the Coulomb constant $k_e = 332.06371\\,\\text{kcal}\\,\\text{mol}^{-1}\\,\\text{\\AA}\\,e^{-2}$ and the relative dielectric constant $\\varepsilon_r = 4.0$.\n\n2.  **Geometric Construction of the Acceptor Atom Position**:\n    For each test case, defined by a donor-acceptor oxygen distance $d_{OA}$ and an O-H-A angle $\\alpha$, the position of the acceptor atom $\\mathbf{A}$ must be determined to calculate the required interatomic distances for the energy function.\n    The problem specifies a precise construction in the $z=0$ plane:\n    - The angle $\\alpha$ is defined between the vectors $\\mathbf{O}-\\mathbf{H}$ and $\\mathbf{A}-\\mathbf{H}$. The vector $\\mathbf{O}-\\mathbf{H}$ is $(-0.96, 0, 0)$, pointing along the negative x-axis.\n    - A unit vector $\\hat{\\mathbf{u}}(\\alpha) = (-\\cos\\alpha_{\\text{rad}}, \\sin\\alpha_{\\text{rad}}, 0)$ is defined, where $\\alpha_{\\text{rad}}$ is the angle in radians. This vector forms an angle $\\alpha$ with the direction vector of $\\mathbf{O}-\\mathbf{H}$, which is $(-1, 0, 0)$.\n    - The position of the acceptor atom $\\mathbf{A}$ is given by $\\mathbf{A} = \\mathbf{H} + r_{HA} \\hat{\\mathbf{u}}(\\alpha)$, where $r_{HA}$ is the H-A distance.\n    - The distance $r_{HA}$ is found by solving the geometric constraint $\\|\\mathbf{A} - \\mathbf{O}\\| = d_{OA}$. As shown in the problem statement, this leads to the quadratic equation for $r_{HA}$:\n    $$r_{HA}^2 + 2(\\mathbf{H}\\cdot\\hat{\\mathbf{u}})r_{HA} + \\left(\\|\\mathbf{H}\\|^2 - d_{OA}^2\\right) = 0$$\n    The problem specifies using the physically meaningful positive root:\n    $$r_{HA} = -(\\mathbf{H}\\cdot\\hat{\\mathbf{u}}) + \\sqrt{(\\mathbf{H}\\cdot\\hat{\\mathbf{u}})^2 - \\left(\\|\\mathbf{H}\\|^2 - d_{OA}^2\\right)}$$\n    where $\\mathbf{H} = (0.96,0,0)$. This construction uniquely determines $r_{HA}$ for each $(d_{OA}, \\alpha)$ pair. The distance $r_{OA}$ is simply $d_{OA}$.\n\n3.  **Calculation of the Hydrogen Bond Energy ($E_{HB}$)**:\n    The hydrogen bond energy is defined as the sum of a specific electrostatic term and a Lennard-Jones term:\n    $$E_{HB} = E_{\\mathrm{Coul}}(H\\text{-}A) + E_{\\mathrm{LJ}}(O\\text{-}A)$$\n    - The Coulombic term uses the H-A distance, $r_{HA}$, computed from the geometric construction:\n    $$E_{\\mathrm{Coul}} = k_e \\frac{q_H q_A}{\\varepsilon_r r_{HA}}$$\n    - The Lennard-Jones term uses the O-A distance, $r_{OA}=d_{OA}$:\n    $$E_{\\mathrm{LJ}} = 4\\varepsilon_{OA}\\left[\\left(\\frac{\\sigma_{OA}}{r_{OA}}\\right)^{12}-\\left(\\frac{\\sigma_{OA}}{r_{OA}}\\right)^6\\right]$$\n\n4.  **Calibration of the Energy Threshold ($E^\\star$)**:\n    The energy-based classifier requires a threshold $E^\\star$. This threshold is calibrated by calculating $E_{HB}$ for the configuration that lies on the boundary of the geometric definition.\n    - Geometric boundary: $d_{OA}^{(\\mathrm{cal})} = 3.5\\,\\text{\\AA}$ and $\\alpha^{(\\mathrm{cal})} = 150^\\circ$.\n    - First, we construct this specific geometry to find the corresponding $r_{HA}^{(\\mathrm{cal})}$.\n    - Then, we compute $E^\\star = E_{HB}(r_{OA}=d_{OA}^{(\\mathrm{cal})}, r_{HA}=r_{HA}^{(\\mathrm{cal})})$.\n\n5.  **Classification and Comparison**:\n    For each test case $(d_{OA}, \\alpha)$, we apply both classification schemes.\n    - **Geometric Classifier**: A hydrogen bond is present if and only if $d_{OA} \\le 3.5\\,\\text{\\AA}$ and $\\alpha \\ge 150^\\circ$.\n    - **Energy-based Classifier**: A hydrogen bond is present if and only if the computed $E_{HB}(d_{OA}, \\alpha) \\le E^\\star$.\n    - The two classifiers are said to agree if they both classify the configuration as \"hydrogen-bonded\" or both as \"not hydrogen-bonded\". An integer output of $1$ signifies agreement, and $0$ signifies disagreement.\n\nThis complete procedure is implemented for the provided test suite to generate the final output.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the hydrogen bond classification problem by comparing a geometric \n    and an energy-based definition.\n    \"\"\"\n\n    # --- Step 1: Define System Parameters and Constants ---\n    \n    # Coulomb constant in kcal/mol * Å/e^2\n    K_E = 332.06371\n    # Relative dielectric constant\n    EPSILON_R = 4.0\n    \n    # Donor atom (Oxygen) is at the origin\n    O_pos = np.array([0.0, 0.0, 0.0])\n    # Donor hydrogen position in Å\n    H_pos = np.array([0.96, 0.0, 0.0])\n    # O-H bond length\n    h_bond_length = np.linalg.norm(H_pos - O_pos)\n    \n    # Partial charges in units of elementary charge e\n    q_H = 0.417  # Donor hydrogen\n    q_A = -0.5   # Acceptor oxygen\n    \n    # Lennard-Jones parameters for Oxygen\n    sigma_O = 3.1507  # in Å\n    epsilon_O = 0.1521  # in kcal/mol\n    \n    # Acceptor is also an Oxygen, so LJ parameters for O-A interaction are the same\n    # due to Lorentz-Berthelot rules for like atoms.\n    sigma_OA = sigma_O\n    epsilon_OA = epsilon_O\n\n    def get_hbond_energy(d_oa, alpha_deg):\n        \"\"\"\n        Calculates the hydrogen bond energy for a given O-A distance and O-H-A angle.\n        \n        Args:\n            d_oa (float): The distance between the donor Oxygen and acceptor Oxygen in Å.\n            alpha_deg (float): The angle O-H-A in degrees.\n            \n        Returns:\n            float: The hydrogen bond energy E_HB in kcal/mol.\n        \"\"\"\n        \n        # --- Step 2: Geometric Construction ---\n        \n        alpha_rad = np.deg2rad(alpha_deg)\n        \n        # Unit vector defining the direction of the A-H vector relative to the O-H axis.\n        # The O-H vector is along the positive x-axis, so the vector from H to O\n        # (D-H in problem) is along the negative x-axis. The angle alpha is between\n        # D-H and A-H.\n        u_hat = np.array([-np.cos(alpha_rad), np.sin(alpha_rad), 0.0])\n        \n        # Dot product required for the quadratic equation solution.\n        # The problem defines geometry with h = H, which is the position vector of H.\n        h_dot_u = np.dot(H_pos, u_hat)\n        \n        h_sq = h_bond_length**2\n        d_oa_sq = d_oa**2\n        \n        # Calculate r_HA using the specified root of the quadratic equation.\n        # This is the distance between the donor Hydrogen and the acceptor Oxygen.\n        discriminant = h_dot_u**2 - (h_sq - d_oa_sq)\n        if discriminant < 0:\n            # Should not happen for the given test cases, as it implies no real\n            # solution for the triangle geometry.\n            return float('inf')\n            \n        r_ha = -h_dot_u + np.sqrt(discriminant)\n        \n        # The distance between the donor Oxygen and acceptor Oxygen is r_OA = d_oa.\n\n        # --- Step 3: Energy Calculation ---\n        \n        # Coulombic energy term (H-A interaction)\n        e_coul = K_E * (q_H * q_A) / (EPSILON_R * r_ha)\n        \n        # Lennard-Jones energy term (O-A interaction)\n        s_over_r = sigma_OA / d_oa\n        s_over_r_6 = s_over_r**6\n        s_over_r_12 = s_over_r_6**2\n        e_lj = 4.0 * epsilon_OA * (s_over_r_12 - s_over_r_6)\n        \n        e_hb = e_coul + e_lj\n        \n        return e_hb\n\n    # --- Step 4: Calibrate Energy Threshold E_star ---\n    \n    # The energy threshold is the energy of the configuration at the boundary\n    # of the geometric definition.\n    d_cal = 3.5  # Å\n    alpha_cal = 150.0  # degrees\n    E_star = get_hbond_energy(d_cal, alpha_cal)\n\n    # --- Step 5: Process Test Cases and Compare Classifiers ---\n    \n    test_cases = [\n        (2.8, 170.0),\n        (3.0, 120.0),\n        (4.0, 160.0),\n        (3.5, 150.0),\n        (3.6, 180.0),\n        (3.2, 150.0),\n    ]\n\n    results = []\n    \n    for d_oa_test, alpha_deg_test in test_cases:\n        # Geometric classification\n        is_hbond_geom = (d_oa_test <= 3.5) and (alpha_deg_test >= 150.0)\n        \n        # Energy-based classification\n        e_hb_test = get_hbond_energy(d_oa_test, alpha_deg_test)\n        is_hbond_energy = e_hb_test <= E_star\n        \n        # Compare classifiers: 1 for agreement, 0 for disagreement\n        agreement = 1 if (is_hbond_geom == is_hbond_energy) else 0\n        results.append(agreement)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3417161"}]}