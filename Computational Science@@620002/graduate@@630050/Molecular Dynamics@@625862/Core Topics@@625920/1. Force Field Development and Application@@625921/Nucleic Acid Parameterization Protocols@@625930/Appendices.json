{"hands_on_practices": [{"introduction": "A cornerstone of any molecular force field is the accurate representation of nonbonded interactions, which are dominated by the Lennard-Jones potential for van der Waals forces and the Coulomb potential for electrostatics. This exercise provides a fundamental calculation to dissect these two components. By analyzing a simplified, hypothetical model of a stacked adenine–thymine dimer, you will apply the core energy functions and the Lorentz–Berthelot mixing rules to quantify the contribution of each interaction type to the overall stability, gaining essential insight into the forces that shape nucleic acid structures [@problem_id:3430376].", "problem": "In the context of Molecular Dynamics (MD) nucleic acid parameterization protocols, consider a simplified coarse-grained two-site representation of a stacked adenine–thymine dimer. Each nucleobase is represented by two interaction sites whose nonbonded parameters were derived from a protocol that fits quantum-mechanical target data and combines atom-centered van der Waals terms with electrostatics using Lorentz–Berthelot mixing rules. Assume the stacks are parallel and separated by a physically reasonable interplanar distance, with lateral offsets reflected in the given intersite distances. Use the standard $12$–$6$ Lennard–Jones potential, Lorentz–Berthelot mixing rules for combining unlike sites, and an unscreened Coulomb interaction with point charges. The Coulomb constant in units compatible with kilojoules per mole (kJ mol$^{-1}$), nanometers (nm), and elementary charge ($e$) is $k_{\\mathrm{c}} = 138.935456 \\,\\mathrm{kJ\\,mol^{-1}\\,nm\\,e^{-2}}$. Energies must be computed in kilojoules per mole.\n\nThe two interaction pairs and their parameters are:\n- Pair $1$: adenine site $A_1$ and thymine site $T_1$\n  - Partial charges: $q_{A_1} = -0.01\\,e$, $q_{T_1} = +0.01\\,e$\n  - Lennard–Jones parameters: $\\sigma_{A_1} = 0.340\\,\\mathrm{nm}$, $\\epsilon_{A_1} = 0.45\\,\\mathrm{kJ\\,mol^{-1}}$; $\\sigma_{T_1} = 0.340\\,\\mathrm{nm}$, $\\epsilon_{T_1} = 0.45\\,\\mathrm{kJ\\,mol^{-1}}$\n  - Inter-site separation: $r_1 = 0.350\\,\\mathrm{nm}$\n- Pair $2$: adenine site $A_2$ and thymine site $T_2$\n  - Partial charges: $q_{A_2} = -0.03\\,e$, $q_{T_2} = +0.03\\,e$\n  - Lennard–Jones parameters: $\\sigma_{A_2} = 0.325\\,\\mathrm{nm}$, $\\epsilon_{A_2} = 0.30\\,\\mathrm{kJ\\,mol^{-1}}$; $\\sigma_{T_2} = 0.296\\,\\mathrm{nm}$, $\\epsilon_{T_2} = 0.30\\,\\mathrm{kJ\\,mol^{-1}}$\n  - Inter-site separation: $r_2 = 0.370\\,\\mathrm{nm}$\n\nStarting from fundamental definitions of the $12$–$6$ Lennard–Jones potential and Coulomb’s law, use the Lorentz–Berthelot mixing rules to obtain the unlike-site Lennard–Jones parameters for each pair and then compute the Lennard–Jones contribution $E_{\\mathrm{LJ}}$ and the Coulombic contribution $E_{\\mathrm{C}}$ to the stacked dimer interaction energy:\n- Compute and sum $E_{\\mathrm{LJ},1}$ and $E_{\\mathrm{LJ},2}$ to obtain $E_{\\mathrm{LJ}}$.\n- Compute and sum $E_{\\mathrm{C},1}$ and $E_{\\mathrm{C},2}$ to obtain $E_{\\mathrm{C}}$.\n\nFinally, report the magnitude ratio $R = \\left|E_{\\mathrm{LJ}}\\right| / \\left|E_{\\mathrm{C}}\\right|$ as a single scalar, which quantitatively assesses which term dominates stabilization. Round your final value of $R$ to four significant figures. Express $R$ as a unitless number.", "solution": "The problem is evaluated to be valid as it is scientifically grounded, well-posed, objective, and self-contained. It is a standard computational problem in the field of molecular mechanics and biophysical chemistry. All necessary data and constants are provided, and the required calculations are clearly specified.\n\nThe total interaction energy between the two coarse-grained nucleobases is the sum of the Lennard-Jones ($E_{\\mathrm{LJ}}$) and Coulombic ($E_{\\mathrm{C}}$) contributions. These contributions are calculated for each of the two interaction pairs and then summed.\n\nThe Lennard-Jones interaction energy, $E_{\\mathrm{LJ}}(r)$, between two sites separated by a distance $r$ is given by the $12$–$6$ potential:\n$$E_{\\mathrm{LJ}}(r) = 4\\epsilon_{ij} \\left[ \\left(\\frac{\\sigma_{ij}}{r}\\right)^{12} - \\left(\\frac{\\sigma_{ij}}{r}\\right)^{6} \\right]$$\nwhere $\\sigma_{ij}$ is the distance at which the potential is zero, and $\\epsilon_{ij}$ is the depth of the potential well for the interacting pair of sites $i$ and $j$.\n\nThe Coulombic interaction energy, $E_{\\mathrm{C}}(r)$, between two point charges $q_i$ and $q_j$ separated by a distance $r$ is given by Coulomb's law:\n$$E_{\\mathrm{C}}(r) = k_{\\mathrm{c}} \\frac{q_i q_j}{r}$$\nwhere $k_{\\mathrm{c}}$ is the Coulomb constant, given as $k_{\\mathrm{c}} = 138.935456 \\,\\mathrm{kJ\\,mol^{-1}\\,nm\\,e^{-2}}$.\n\nThe parameters for unlike-site interactions ($\\sigma_{ij}$ and $\\epsilon_{ij}$) are determined using the Lorentz–Berthelot mixing rules from the parameters of the individual sites ($\\sigma_i$, $\\epsilon_i$ and $\\sigma_j$, $\\epsilon_j$):\nArithmetic mean for $\\sigma_{ij}$:\n$$\\sigma_{ij} = \\frac{\\sigma_i + \\sigma_j}{2}$$\nGeometric mean for $\\epsilon_{ij}$:\n$$\\epsilon_{ij} = \\sqrt{\\epsilon_i \\epsilon_j}$$\n\nWe will now apply these principles to each interaction pair.\n\nPair $1$: Adenine site $A_1$ and Thymine site $T_1$.\nThe given parameters are:\n$q_{A_1} = -0.01\\,e$, $q_{T_1} = +0.01\\,e$\n$\\sigma_{A_1} = 0.340\\,\\mathrm{nm}$, $\\epsilon_{A_1} = 0.45\\,\\mathrm{kJ\\,mol^{-1}}$\n$\\sigma_{T_1} = 0.340\\,\\mathrm{nm}$, $\\epsilon_{T_1} = 0.45\\,\\mathrm{kJ\\,mol^{-1}}$\n$r_1 = 0.350\\,\\mathrm{nm}$\n\nFirst, we calculate the mixed Lennard-Jones parameters for the $A_1$-$T_1$ pair:\n$\\sigma_1 = \\sigma_{A_1 T_1} = \\frac{\\sigma_{A_1} + \\sigma_{T_1}}{2} = \\frac{0.340\\,\\mathrm{nm} + 0.340\\,\\mathrm{nm}}{2} = 0.340\\,\\mathrm{nm}$\n$\\epsilon_1 = \\epsilon_{A_1 T_1} = \\sqrt{\\epsilon_{A_1} \\epsilon_{T_1}} = \\sqrt{(0.45\\,\\mathrm{kJ\\,mol^{-1}}) \\times (0.45\\,\\mathrm{kJ\\,mol^{-1}})} = 0.45\\,\\mathrm{kJ\\,mol^{-1}}$\n\nNow, we compute the Lennard-Jones energy for Pair $1$:\n$E_{\\mathrm{LJ},1} = 4\\epsilon_1 \\left[ \\left(\\frac{\\sigma_1}{r_1}\\right)^{12} - \\left(\\frac{\\sigma_1}{r_1}\\right)^{6} \\right]$\n$E_{\\mathrm{LJ},1} = 4(0.45) \\left[ \\left(\\frac{0.340}{0.350}\\right)^{12} - \\left(\\frac{0.340}{0.350}\\right)^{6} \\right]$\n$E_{\\mathrm{LJ},1} = 1.8 \\left[ (0.971428...)^{12} - (0.971428...)^{6} \\right]$\n$E_{\\mathrm{LJ},1} = 1.8 [0.705315... - 0.839830...] = 1.8(-0.134515...) = -0.242127...\\,\\mathrm{kJ\\,mol^{-1}}$\n\nNext, we compute the Coulombic energy for Pair $1$:\n$E_{\\mathrm{C},1} = k_{\\mathrm{c}} \\frac{q_{A_1} q_{T_1}}{r_1} = (138.935456) \\frac{(-0.01\\,e)(+0.01\\,e)}{0.350\\,\\mathrm{nm}}$\n$E_{\\mathrm{C},1} = 138.935456 \\frac{-0.0001}{0.350} = -0.0396958...\\,\\mathrm{kJ\\,mol^{-1}}$\n\nPair $2$: Adenine site $A_2$ and Thymine site $T_2$.\nThe given parameters are:\n$q_{A_2} = -0.03\\,e$, $q_{T_2} = +0.03\\,e$\n$\\sigma_{A_2} = 0.325\\,\\mathrm{nm}$, $\\epsilon_{A_2} = 0.30\\,\\mathrm{kJ\\,mol^{-1}}$\n$\\sigma_{T_2} = 0.296\\,\\mathrm{nm}$, $\\epsilon_{T_2} = 0.30\\,\\mathrm{kJ\\,mol^{-1}}$\n$r_2 = 0.370\\,\\mathrm{nm}$\n\nFirst, we calculate the mixed Lennard-Jones parameters for the $A_2$-$T_2$ pair:\n$\\sigma_2 = \\sigma_{A_2 T_2} = \\frac{\\sigma_{A_2} + \\sigma_{T_2}}{2} = \\frac{0.325\\,\\mathrm{nm} + 0.296\\,\\mathrm{nm}}{2} = 0.3105\\,\\mathrm{nm}$\n$\\epsilon_2 = \\epsilon_{A_2 T_2} = \\sqrt{\\epsilon_{A_2} \\epsilon_{T_2}} = \\sqrt{(0.30\\,\\mathrm{kJ\\,mol^{-1}}) \\times (0.30\\,\\mathrm{kJ\\,mol^{-1}})} = 0.30\\,\\mathrm{kJ\\,mol^{-1}}$\n\nNow, we compute the Lennard-Jones energy for Pair $2$:\n$E_{\\mathrm{LJ},2} = 4\\epsilon_2 \\left[ \\left(\\frac{\\sigma_2}{r_2}\\right)^{12} - \\left(\\frac{\\sigma_2}{r_2}\\right)^{6} \\right]$\n$E_{\\mathrm{LJ},2} = 4(0.30) \\left[ \\left(\\frac{0.3105}{0.370}\\right)^{12} - \\left(\\frac{0.3105}{0.370}\\right)^{6} \\right]$\n$E_{\\mathrm{LJ},2} = 1.2 \\left[ (0.839189...)^{12} - (0.839189...)^{6} \\right]$\n$E_{\\mathrm{LJ},2} = 1.2 [0.121800... - 0.349000...] = 1.2(-0.227200...) = -0.272640...\\,\\mathrm{kJ\\,mol^{-1}}$\n\nNext, we compute the Coulombic energy for Pair $2$:\n$E_{\\mathrm{C},2} = k_{\\mathrm{c}} \\frac{q_{A_2} q_{T_2}}{r_2} = (138.935456) \\frac{(-0.03\\,e)(+0.03\\,e)}{0.370\\,\\mathrm{nm}}$\n$E_{\\mathrm{C},2} = 138.935456 \\frac{-0.0009}{0.370} = -0.338271...\\,\\mathrm{kJ\\,mol^{-1}}$\n\nTotal energies are found by summing the contributions from each pair.\nTotal Lennard-Jones energy:\n$E_{\\mathrm{LJ}} = E_{\\mathrm{LJ},1} + E_{\\mathrm{LJ},2} = (-0.242127...) + (-0.272640...) = -0.514767...\\,\\mathrm{kJ\\,mol^{-1}}$\n\nTotal Coulombic energy:\n$E_{\\mathrm{C}} = E_{\\mathrm{C},1} + E_{\\mathrm{C},2} = (-0.0396958...) + (-0.338271...) = -0.377967...\\,\\mathrm{kJ\\,mol^{-1}}$\n\nFinally, we compute the magnitude ratio $R = \\left|E_{\\mathrm{LJ}}\\right| / \\left|E_{\\mathrm{C}}\\right|$:\n$R = \\frac{|-0.514767...\\,\\mathrm{kJ\\,mol^{-1}}|}{|-0.377967...\\,\\mathrm{kJ\\,mol^{-1}}|}$\n$R = \\frac{0.514767...}{0.377967...} = 1.361937...$\n\nThe problem requires rounding the final value of $R$ to four significant figures.\n$R \\approx 1.362$\nThis ratio, being greater than $1$, indicates that in this specific coarse-grained model and geometry, the Lennard-Jones term contributes more to the attractive stabilization energy than the electrostatic term.", "answer": "$$\\boxed{1.362}$$", "id": "3430376"}, {"introduction": "While understanding energy components is crucial, a key skill for force field developers is deriving the parameters that define them. This practice guides you through a core workflow in parameterization: fitting the potential for a crucial dihedral angle, the glycosidic torsion $\\chi$, to a target energy profile derived from quantum mechanics (QM). You will implement a protocol to fit a Fourier series model to a QM scan and then use the resulting potential to compute key thermodynamic properties like conformational free energy differences and transition barriers, directly connecting QM data to macroscopic observables [@problem_id:3430386].", "problem": "You are tasked with implementing, from first principles, a protocol to update nucleic acid glycosidic torsion ($\\chi$) parameters using a provided quantum mechanics (QM) scan and to quantify how these updated parameters alter conformational thermodynamics in test simulations. The target context is classical molecular dynamics and nucleic acid parameterization.\n\nFundamental base:\n- Classical statistical mechanics: the Boltzmann distribution for a coordinate $\\chi$ with potential energy $U(\\chi)$ implies a probability density $p(\\chi) \\propto \\exp(-\\beta U(\\chi))$ where $\\beta = 1/(k_{\\mathrm{B}} T)$, $k_{\\mathrm{B}}$ is Boltzmann’s constant, and $T$ is temperature.\n- Classical force fields represent torsional potentials for dihedral angles by Fourier series. For $\\chi$, the torsional term is modeled as a sum of cosine series components, each characterized by an integer multiplicity and an amplitude to be determined by fitting.\n\nObjective:\nGiven a one-dimensional QM energy scan $U_{\\mathrm{QM}}(\\chi)$ for the glycosidic torsion $\\chi$, and a baseline non-torsional molecular mechanics energy $U_{0}(\\chi)$, estimate updated torsion amplitudes that best reproduce the QM profile when combined with $U_{0}(\\chi)$, then compute thermodynamic metrics derived from the updated total potential $U_{\\mathrm{tot}}(\\chi) = U_{0}(\\chi) + V_{\\mathrm{tors}}(\\chi)$. Specifically:\n- Fit torsional amplitudes for a predefined set of multiplicities by minimizing the squared deviation between $U_{\\mathrm{QM}}(\\chi)$ and $U_{0}(\\chi) + V_{\\mathrm{tors}}(\\chi)$ across provided grid points.\n- Compute the free energy difference between anti and syn conformational regions from the Boltzmann-weighted integrals of $U_{\\mathrm{tot}}(\\chi)$.\n- Compute barrier heights for transitions between anti and syn as the difference between the highest energy along the minimum-arc path connecting the minima and the energy at each respective minimum.\n\nModel definitions to use:\n- Use a torsional model of the form\n$$\nV_{\\mathrm{tors}}(\\chi) = \\sum_{n \\in \\mathcal{N}} \\frac{1}{2} k_{n} \\left(1 + \\cos(n \\chi)\\right),\n$$\nwhere $\\mathcal{N}$ is a set of integer multiplicities and $k_{n}$ are amplitudes to be fitted.\n- The fitting criterion is the least-squares minimization of\n$$\n\\sum_{i} \\left[ U_{\\mathrm{QM}}(\\chi_{i}) - U_{0}(\\chi_{i}) - V_{\\mathrm{tors}}(\\chi_{i}) \\right]^{2},\n$$\nwith respect to $\\{k_{n}\\}_{n \\in \\mathcal{N}}$.\n- The free energy for a region $\\mathcal{R}$ is\n$$\nG(\\mathcal{R}) = -k_{\\mathrm{B}} T \\ln \\left( \\int_{\\chi \\in \\mathcal{R}} \\exp\\left[-\\beta U_{\\mathrm{tot}}(\\chi)\\right] \\, d\\chi \\right),\n$$\nand the free energy difference to report is\n$$\n\\Delta G = G(\\mathrm{syn}) - G(\\mathrm{anti}),\n$$\nexpressed in kilocalories per mole.\n- Define barrier heights along the minimum-arc path connecting the anti and syn minima on $U_{\\mathrm{tot}}(\\chi)$ as\n$$\n\\Delta E_{\\mathrm{anti}\\rightarrow\\mathrm{syn}} = \\max_{\\chi \\in \\text{arc}} U_{\\mathrm{tot}}(\\chi) - U_{\\mathrm{tot}}(\\chi_{\\mathrm{min,anti}}),\n$$\n$$\n\\Delta E_{\\mathrm{syn}\\rightarrow\\mathrm{anti}} = \\max_{\\chi \\in \\text{arc}} U_{\\mathrm{tot}}(\\chi) - U_{\\mathrm{tot}}(\\chi_{\\mathrm{min,syn}}),\n$$\nexpressed in kilocalories per mole, where the arc is the shorter of the two angular paths on the circle.\n\nAngle unit and energy unit:\n- All angles $\\chi$ must be in radians.\n- All energies must be in kilocalories per mole (kcal/mol).\n- Use $T = 300$ Kelvin and $k_{\\mathrm{B}} = 0.0019872041$ kilocalories per mole per Kelvin.\n\nRegion definitions:\n- Anti region: $\\chi \\in \\left[-\\frac{5\\pi}{6}, -\\frac{\\pi}{3}\\right]$.\n- Syn region: $\\chi \\in \\left[0, \\frac{7\\pi}{9}\\right]$.\nThese bounds are typical for nucleic acid glycosidic torsion conformers and provide scientifically reasonable windows for anti and syn.\n\nNumerical implementation requirements:\n- Perform fitting via linear least squares using the provided grid points and model.\n- Perform numerical integrals using the trapezoidal rule on the $\\chi$ grid.\n- Identify minima in each region by scanning $U_{\\mathrm{tot}}(\\chi)$ over the grid restricted to the respective region.\n\nTest suite:\nImplement your program to solve the above for the following three test cases. In all cases, use a uniform grid of $N = 72$ angles $\\chi_{i}$ spanning $[-\\pi, \\pi)$, i.e., $\\chi_{i} = -\\pi + \\frac{2\\pi i}{N}$ for $i \\in \\{0,1,\\dots,N-1\\}$.\n\n- Test case $1$: Multiplicity set $\\mathcal{N} = \\{1,2,3\\}$. Baseline $U_{0}(\\chi) = a_{0} + a_{1} \\cos(\\chi)$ with $a_{0} = 0.5$ and $a_{1} = 0.1$. The QM scan is\n$$\nU_{\\mathrm{QM}}(\\chi) = 1.2 + 1.8\\left(1 + \\cos(\\chi)\\right) + 0.6\\left(1 + \\cos(3\\chi)\\right) + 0.2 \\cos(2\\chi).\n$$\n\n- Test case $2$: Multiplicity set $\\mathcal{N} = \\{1,2,3\\}$. Baseline $U_{0}(\\chi) = a_{0} + a_{1} \\cos(\\chi)$ with $a_{0} = 0.3$ and $a_{1} = 0.2$. The QM scan is\n$$\nU_{\\mathrm{QM}}(\\chi) = 0.8 + 0.2\\left(1 + \\cos(\\chi)\\right) + 2.5\\left(1 + \\cos(3\\chi)\\right) + 0.4 \\cos(2\\chi) + 0.2 \\cos(4\\chi).\n$$\n\n- Test case $3$: Multiplicity set $\\mathcal{N} = \\{1,2,3\\}$. Baseline $U_{0}(\\chi) = a_{0} + a_{1} \\cos(\\chi)$ with $a_{0} = 0.4$ and $a_{1} = -0.05$. The QM scan is\n$$\nU_{\\mathrm{QM}}(\\chi) = 0.4 + 0.05\\left(1 + \\cos(\\chi)\\right) + 0.08\\left(1 + \\cos(3\\chi)\\right) + 0.02 \\cos(2\\chi).\n$$\n\nRequired outputs:\nFor each test case, compute and return a list containing:\n- The fitted amplitudes $k_{1}$, $k_{2}$, $k_{3}$ in this order.\n- The free energy difference $\\Delta G$ in kilocalories per mole.\n- The barrier height $\\Delta E_{\\mathrm{anti}\\rightarrow\\mathrm{syn}}$ in kilocalories per mole.\n- The barrier height $\\Delta E_{\\mathrm{syn}\\rightarrow\\mathrm{anti}}$ in kilocalories per mole.\n\nFinal output format:\nYour program should produce a single line of output containing the results for the three test cases as a comma-separated list of lists enclosed in square brackets, with no spaces, in the exact format:\n$$\n\\left[\\left[k_{1},k_{2},k_{3},\\Delta G,\\Delta E_{\\mathrm{anti}\\rightarrow\\mathrm{syn}},\\Delta E_{\\mathrm{syn}\\rightarrow\\mathrm{anti}}\\right],\\left[\\cdots\\right],\\left[\\cdots\\right]\\right]\n$$\nwhere each numeric entry is a decimal floating-point number. For example, the printed line should look like\n$$\n\\left[[0.0,0.0,0.0,0.0,0.0,0.0],[0.0,0.0,0.0,0.0,0.0,0.0],[0.0,0.0,0.0,0.0,0.0,0.0]\\right],\n$$\nbut with your computed values in place of zeros.\n\nScientific realism: All definitions and parameter choices are within the standard practice of nucleic acid torsional parameterization and classical molecular dynamics. Use radians for angles and kilocalories per mole for energies. Your algorithm must be deterministic and self-contained without external files or inputs.", "solution": "The problem requires the implementation of a computational protocol to refine torsional parameters for a nucleic acid glycosidic angle, $\\chi$, and subsequently analyze the thermodynamic consequences of this refinement. The process involves fitting a torsional potential model to quantum mechanics (QM) data and then using the resulting total potential energy surface to compute conformational free energies and transition barriers.\n\nThe procedure is executed for three distinct test cases, each with its own QM energy scan and baseline molecular mechanics (MM) energy. The solution is structured into three main computational stages: (1) Parameter fitting via linear least squares, (2) Calculation of the free energy difference, $\\Delta G$, between the *syn* and *anti* conformations, and (3) Calculation of the energy barriers, $\\Delta E$, for the transitions between these two states.\n\nFirst, we establish the computational environment. The angle $\\chi$ is discretized on a uniform grid of $N=72$ points spanning the interval $[-\\pi, \\pi)$. The grid points are given by $\\chi_{i} = -\\pi + \\frac{2\\pi i}{N}$ for $i=0, 1, \\dots, N-1$. All energy quantities are specified in units of kilocalories per mole (kcal/mol), and angles are in radians. The temperature is set to $T=300$ K, and the Boltzmann constant is $k_{\\mathrm{B}} = 0.0019872041$ kcal mol$^{-1}$ K$^{-1}$. The inverse thermal energy, $\\beta = 1/(k_{\\mathrm{B}}T)$, is a recurring factor.\n\n**1. Torsional Parameter Fitting**\n\nThe primary goal is to determine the amplitudes $\\{k_{n}\\}$ for a set of torsional multiplicities $\\mathcal{N} = \\{1, 2, 3\\}$ in the potential energy function:\n$$\nV_{\\mathrm{tors}}(\\chi) = \\sum_{n \\in \\mathcal{N}} \\frac{1}{2} k_{n} \\left(1 + \\cos(n \\chi)\\right)\n$$\nThe total potential energy is the sum of a baseline non-torsional energy $U_{0}(\\chi)$ and this new torsional term: $U_{\\mathrm{tot}}(\\chi) = U_{0}(\\chi) + V_{\\mathrm{tors}}(\\chi)$. The amplitudes $\\{k_n\\}$ are found by minimizing the sum of squared differences between a target QM energy profile, $U_{\\mathrm{QM}}(\\chi)$, and this $U_{\\mathrm{tot}}(\\chi)$ over the grid points $\\{\\chi_i\\}$.\nThe objective is to minimize the residual sum of squares, $S$:\n$$\nS = \\sum_{i} \\left[ U_{\\mathrm{QM}}(\\chi_{i}) - \\left(U_{0}(\\chi_{i}) + V_{\\mathrm{tors}}(\\chi_{i})\\right) \\right]^{2}\n$$\nLet us define a target energy correction $Y(\\chi) = U_{\\mathrm{QM}}(\\chi) - U_{0}(\\chi)$. The problem simplifies to fitting $Y(\\chi)$ with the model $V_{\\mathrm{tors}}(\\chi)$:\n$$\nY(\\chi) \\approx \\sum_{n \\in \\mathcal{N}} k_n \\left( \\frac{1}{2}(1 + \\cos(n\\chi)) \\right)\n$$\nThis is a linear least-squares problem. Let $\\mathbf{y}$ be a vector with elements $y_i = Y(\\chi_i)$, and let $\\mathbf{k}$ be the vector of unknown amplitudes $[k_1, k_2, k_3]^T$. Let $\\mathbf{A}$ be the design matrix, where each column corresponds to a basis function evaluated at the grid points. The elements of $\\mathbf{A}$ are $A_{in} = \\frac{1}{2}(1 + \\cos(n\\chi_i))$ for $n \\in \\{1, 2, 3\\}$. The problem is to find $\\mathbf{k}$ that minimizes $\\|\\mathbf{A}\\mathbf{k} - \\mathbf{y}\\|_2^2$. This is solved using a standard linear least-squares solver, such as one provided by `numpy.linalg.lstsq`.\n\n**2. Free Energy Difference Calculation**\n\nOnce the optimal amplitudes $\\{k_n\\}$ are determined, the total potential $U_{\\mathrm{tot}}(\\chi)$ is fully defined for the entire grid. The relative stability of the *syn* and *anti* conformations is quantified by the free energy difference $\\Delta G = G(\\mathrm{syn}) - G(\\mathrm{anti})$. The free energy of a conformational state defined over a region of angles $\\mathcal{R}$ is given by:\n$$\nG(\\mathcal{R}) = -k_{\\mathrm{B}} T \\ln \\left( Z_{\\mathcal{R}} \\right) = -k_{\\mathrm{B}} T \\ln \\left( \\int_{\\chi \\in \\mathcal{R}} e^{-\\beta U_{\\mathrm{tot}}(\\chi)} \\, d\\chi \\right)\n$$\nwhere $Z_{\\mathcal{R}}$ is the partition function for the region. The free energy difference is then:\n$$\n\\Delta G = -k_{\\mathrm{B}} T \\ln\\left(\\frac{Z_{\\mathrm{syn}}}{Z_{\\mathrm{anti}}}\\right)\n$$\nThe regions are defined as $\\mathcal{R}_{\\mathrm{anti}} = [-\\frac{5\\pi}{6}, -\\frac{\\pi}{3}]$ and $\\mathcal{R}_{\\mathrm{syn}} = [0, \\frac{7\\pi}{9}]$. The integrals are computed numerically using the trapezoidal rule over the grid points $\\{\\chi_i\\}$ that fall within each respective region. Specifically, we calculate the Boltzmann-weighted integrand $p(\\chi_i) = \\exp(-\\beta U_{\\mathrm{tot}}(\\chi_i))$ at each grid point, then integrate this discrete function over the angles in each region.\n\n**3. Transition Barrier Height Calculation**\n\nThe energy barriers for transitioning between the *anti* and *syn* states are calculated from the total potential energy surface $U_{\\mathrm{tot}}(\\chi)$. First, the energy minima for each state, $U_{\\mathrm{tot}}(\\chi_{\\mathrm{min,anti}})$ and $U_{\\mathrm{tot}}(\\chi_{\\mathrm{min,syn}})$, are located by finding the minimum value of $U_{\\mathrm{tot}}(\\chi_i)$ for all grid points $\\chi_i$ within the *anti* and *syn* regions, respectively. Let the angles at these minima be $\\chi_{\\mathrm{min,anti}}$ and $\\chi_{\\mathrm{min,syn}}$.\n\nThe transition path between these two minima is taken as the shorter of the two possible arcs on the periodic domain $[-\\pi, \\pi)$. Let the two minima angles be $\\alpha_1$ and $\\alpha_2$. The shorter arc is the set of angles between them if $|\\alpha_1 - \\alpha_2| < \\pi$, and the set of angles \"wrapping around\" the circle otherwise. The highest energy point along this discrete path, $\\max_{\\chi \\in \\text{arc}} U_{\\mathrm{tot}}(\\chi)$, is identified. The barrier heights are then calculated as the difference between this maximum energy and the energy of each minimum:\n$$\n\\Delta E_{\\mathrm{anti}\\rightarrow\\mathrm{syn}} = \\max_{\\chi \\in \\text{arc}} U_{\\mathrm{tot}}(\\chi) - U_{\\mathrm{tot}}(\\chi_{\\mathrm{min,anti}})\n$$\n$$\n\\Delta E_{\\mathrm{syn}\\rightarrow\\mathrm{anti}} = \\max_{\\chi \\in \\text{arc}} U_{\\mathrm{tot}}(\\chi) - U_{\\mathrm{tot}}(\\chi_{\\mathrm{min,syn}})\n$$\nThis entire protocol is applied sequentially to each of the three test cases provided, and the six required output values ($k_1$, $k_2$, $k_3$, $\\Delta G$, $\\Delta E_{\\mathrm{anti}\\rightarrow\\mathrm{syn}}$, $\\Delta E_{\\mathrm{syn}\\rightarrow\\mathrm{anti}}$) are collected for each case.", "answer": "[[3.499999999999999,0.40000000000000036,1.2000000000000002,-1.5452243765452586,3.0298687798319693,3.313460616172965],[0.20000000000000018,0.8000000000000003,5.000000000000002,-3.3610931551069777,4.020583091040856,5.132148782060855],[-0.20000000000000007,0.040000000000000036,0.16000000000000003,0.003977507312952865,0.021156553531062955,0.02534571990425661]]", "id": "3430386"}, {"introduction": "A robust force field must not only replicate quantum mechanical energies but also accurately predict experimental observables. This final exercise demonstrates the critical process of validating and refining parameters by comparing simulation predictions to real-world data. You will investigate how subtle adjustments to 1–4 nonbonded scaling factors influence the conformational equilibrium of a ribose sugar ring and calculate the resulting ensemble-averaged NMR J-couplings, learning how to bridge the gap between theoretical models and experimental measurements [@problem_id:3430408].", "problem": "You are tasked with writing a complete, runnable program that models the influence of 1–4 nonbonded interaction scaling on the conformational equilibria of a ribose sugar ring and on ensemble-averaged Nuclear Magnetic Resonance (NMR) scalar couplings, using a simplified but scientifically grounded scheme aligned with parameterization protocols in Molecular Dynamics (MD) force fields for nucleic acids.\n\nThe fundamental base you must use includes: (i) classical statistical mechanics via the Boltzmann distribution, (ii) the superposition principle for ensemble averages, and (iii) the Karplus relation for vicinal scalar couplings in NMR. From these bases, derive the algorithm to compute ensemble populations as a function of energy and to compute averaged observables from those populations.\n\nAssume a three-state conformational model for the ribose ring pseudorotation with conformers labeled by $i \\in \\{1,2,3\\}$ corresponding to $i=1$ for C3′-endo, $i=2$ for C2′-endo, and $i=3$ for O4′-endo. The total potential energy of conformer $i$ at given 1–4 scalings is\n$$\nE_i(S_\\text{elec}, S_\\text{LJ}) \\;=\\; E_i^{(0)} \\;+\\; S_\\text{elec}\\,E_{i,\\text{elec}}^{(1\\text{–}4)} \\;+\\; S_\\text{LJ}\\,E_{i,\\text{LJ}}^{(1\\text{–}4)},\n$$\nwhere $E_i^{(0)}$ is the baseline intramolecular energy for conformer $i$ excluding 1–4 nonbonded terms, $E_{i,\\text{elec}}^{(1\\text{–}4)}$ and $E_{i,\\text{LJ}}^{(1\\text{–}4)}$ are the electrostatic and Lennard–Jones (LJ) 1–4 interaction contributions for conformer $i$, and $S_\\text{elec}$ and $S_\\text{LJ}$ are the electrostatic and Lennard–Jones 1–4 scaling factors, respectively.\n\nUse the following physically plausible parameters, all in kilojoules per mole for energies and in Kelvin for temperature:\n- Temperature $T = 298$.\n- Gas constant $R = 8.314462618\\times 10^{-3}$.\n- Baseline energies: $E_1^{(0)} = 0.0$, $E_2^{(0)} = 0.8$, $E_3^{(0)} = 4.0$.\n- Electrostatic 1–4 terms: $E_{1,\\text{elec}}^{(1\\text{–}4)} = -0.6$, $E_{2,\\text{elec}}^{(1\\text{–}4)} = -0.2$, $E_{3,\\text{elec}}^{(1\\text{–}4)} = -0.1$.\n- Lennard–Jones 1–4 terms: $E_{1,\\text{LJ}}^{(1\\text{–}4)} = 0.4$, $E_{2,\\text{LJ}}^{(1\\text{–}4)} = 0.1$, $E_{3,\\text{LJ}}^{(1\\text{–}4)} = 0.2$.\n\nLet the conformer-specific dihedral angles (degrees) for two vicinal proton–proton couplings be:\n- For $\\,^3J_{\\text{H1′–H2′}}$: $\\varphi_{12}^{(1)} = 60$, $\\varphi_{12}^{(2)} = 180$, $\\varphi_{12}^{(3)} = 300$.\n- For $\\,^3J_{\\text{H3′–H4′}}$: $\\varphi_{34}^{(1)} = 180$, $\\varphi_{34}^{(2)} = 60$, $\\varphi_{34}^{(3)} = 300$.\n\nUse the Karplus relation for vicinal couplings of the form\n$$\nJ(\\varphi) \\;=\\; A\\cos^2(\\varphi) \\;+\\; B\\cos(\\varphi) \\;+\\; C,\n$$\nwith parameters $A = 7.09$, $B = -1.42$, $C = 1.77$, and interpret $\\varphi$ in radians when evaluating the cosine functions. The resulting $J$ values must be computed in hertz. For each conformer $i$, the coupling values are $J_{12}^{(i)} = J(\\varphi_{12}^{(i)})$ and $J_{34}^{(i)} = J(\\varphi_{34}^{(i)})$.\n\nThe conformer populations are determined from the Boltzmann distribution. Define $\\beta = 1/(RT)$ and unnormalized weights $w_i = \\exp\\!\\big(-\\beta\\,E_i(S_\\text{elec}, S_\\text{LJ})\\big)$. The normalized population of conformer $i$ is $p_i = w_i / \\sum_{j=1}^{3} w_j$. The ensemble-averaged couplings are\n$$\n\\langle J_{12} \\rangle \\;=\\; \\sum_{i=1}^{3} p_i\\,J_{12}^{(i)}, \n\\qquad\n\\langle J_{34} \\rangle \\;=\\; \\sum_{i=1}^{3} p_i\\,J_{34}^{(i)}.\n$$\n\nCompare these ensemble-averaged couplings to fixed experimental reference values (in hertz):\n- $J_{12}^{\\text{(exp)}} = 5.50$,\n- $J_{34}^{\\text{(exp)}} = 6.90$.\n\nCompute the root-mean-square error (RMSE) in hertz as\n$$\n\\text{RMSE} \\;=\\; \\sqrt{\\tfrac{1}{2}\\left(\\left(\\langle J_{12} \\rangle - J_{12}^{\\text{(exp)}}\\right)^2 + \\left(\\langle J_{34} \\rangle - J_{34}^{\\text{(exp)}}\\right)^2\\right)}.\n$$\n\nYour program must, for each specified test case, compute the RMSE in hertz as a floating-point number. Angles must be treated in degrees in the input but converted to radians for trigonometric evaluations, and energies must be treated in kilojoules per mole. Use $T = 298$ and $R = 8.314462618\\times 10^{-3}$ to compute $\\beta$, and express the final RMSE results in hertz as floating-point numbers.\n\nTest suite: evaluate the following four scaling parameter pairs $(S_\\text{elec}, S_\\text{LJ})$:\n1. $(1.0, 1.0)$,\n2. $(0.8333333333, 0.5)$,\n3. $(0.0, 0.0)$,\n4. $(1.2, 1.2)$.\n\nFinal output format: your program should produce a single line of output containing the four RMSE results, in the same order as the test cases above, as a comma-separated list enclosed in square brackets, for example, $\\texttt{[r_1,r_2,r_3,r_4]}$. Each $r_k$ must be a floating-point number. No other text should be printed. All numeric answers are in hertz and must be represented as decimal floating-point values on this single output line.", "solution": "The problem has been validated and is determined to be scientifically sound, well-posed, and complete. All necessary data and definitions are provided for a unique and meaningful solution. The problem models a standard procedure in computational biophysics for force field parameterization, grounded in the principles of statistical mechanics and their application to structural biology.\n\nThe solution will be derived by systematically applying the principles and equations provided. The objective is to compute the root-mean-square error (RMSE) between calculated and experimental NMR J-couplings for a set of scaling parameters $(S_\\text{elec}, S_\\text{LJ})$. The framework involves a three-state model for the ribose sugar ring conformation.\n\nFirst, we establish the constants used throughout the calculation. The temperature is given as $T = 298 \\text{ K}$, and the gas constant is $R = 8.314462618 \\times 10^{-3} \\text{ kJ mol}^{-1} \\text{K}^{-1}$. From these, we define the thermal energy term $\\beta = 1/(RT)$.\n$$\n\\beta = \\frac{1}{RT} = \\frac{1}{(8.314462618 \\times 10^{-3} \\text{ kJ mol}^{-1} \\text{K}^{-1}) \\times (298 \\text{ K})} \\approx 0.403597 \\text{ mol kJ}^{-1}\n$$\n\nThe core of the model consists of three distinct conformational states, indexed by $i \\in \\{1, 2, 3\\}$. The potential energy of each state $i$ is a function of the 1–4 nonbonded interaction scaling factors, $S_\\text{elec}$ and $S_\\text{LJ}$. The energy is given by the linear combination:\n$$\nE_i(S_\\text{elec}, S_\\text{LJ}) = E_i^{(0)} + S_\\text{elec}\\,E_{i,\\text{elec}}^{(1\\text{–}4)} + S_\\text{LJ}\\,E_{i,\\text{LJ}}^{(1\\text{–}4)}\n$$\nHere, $E_i^{(0)}$ is the baseline energy, and $E_{i,\\text{elec}}^{(1\\text{–}4)}$ and $E_{i,\\text{LJ}}^{(1\\text{–}4)}$ are the electrostatic and Lennard-Jones 1–4 interaction energies, respectively. The provided parameters for the three states are (all in kJ/mol):\n- State $i=1$ (C3′-endo): $E_1^{(0)} = 0.0$, $E_{1,\\text{elec}}^{(1\\text{–}4)} = -0.6$, $E_{1,\\text{LJ}}^{(1\\text{–}4)} = 0.4$.\n- State $i=2$ (C2′-endo): $E_2^{(0)} = 0.8$, $E_{2,\\text{elec}}^{(1\\text{–}4)} = -0.2$, $E_{2,\\text{LJ}}^{(1\\text{–}4)} = 0.1$.\n- State $i=3$ (O4′-endo): $E_3^{(0)} = 4.0$, $E_{3,\\text{elec}}^{(1\\text{–}4)} = -0.1$, $E_{3,\\text{LJ}}^{(1\\text{–}4)} = 0.2$.\n\nAccording to the principles of statistical mechanics, the population $p_i$ of each state $i$ at thermal equilibrium is determined by its Boltzmann weight. The unnormalized weight $w_i$ is calculated from the state's energy $E_i$:\n$$\nw_i = \\exp(-\\beta E_i)\n$$\nThe normalized population $p_i$ is then found by dividing the individual weight by the sum of all weights (the partition function $Z = \\sum_{j=1}^{3} w_j$):\n$$\np_i = \\frac{w_i}{\\sum_{j=1}^{3} w_j}\n$$\nThe populations depend on the scaling factors $(S_\\text{elec}, S_\\text{LJ})$ because the energies $E_i$ do.\n\nNext, we relate the structure of each conformer to an observable quantity, the NMR scalar coupling $J$. The Karplus relation provides a function that maps a vicinal dihedral angle $\\varphi$ to a J-coupling value:\n$$\nJ(\\varphi) = A\\cos^2(\\varphi) + B\\cos(\\varphi) + C\n$$\nThe parameters are given as $A = 7.09$, $B = -1.42$, and $C = 1.77$. The input dihedral angles are in degrees and must be converted to radians for evaluating the cosine functions via $\\varphi_{\\text{rad}} = \\varphi_{\\text{deg}} \\times \\pi / 180$.\n\nThe problem defines two specific couplings, $\\,^3J_{\\text{H1′–H2′}}$ and $\\,^3J_{\\text{H3′–H4′}}$, which depend on the dihedral angles $\\varphi_{12}^{(i)}$ and $\\varphi_{34}^{(i)}$ for each state $i$. We pre-calculate these state-specific coupling values, $J_{12}^{(i)}$ and $J_{34}^{(i)}$, as they are independent of the scaling factors.\n\nFor $\\,^3J_{\\text{H1′–H2′}}$:\n- $J_{12}^{(1)} = J(60^\\circ) = J(\\pi/3 \\text{ rad}) = 7.09\\cos^2(\\pi/3) - 1.42\\cos(\\pi/3) + 1.77 = 7.09(0.5)^2 - 1.42(0.5) + 1.77 = 2.8325 \\text{ Hz}$.\n- $J_{12}^{(2)} = J(180^\\circ) = J(\\pi \\text{ rad}) = 7.09\\cos^2(\\pi) - 1.42\\cos(\\pi) + 1.77 = 7.09(-1)^2 - 1.42(-1) + 1.77 = 10.28 \\text{ Hz}$.\n- $J_{12}^{(3)} = J(300^\\circ) = J(5\\pi/3 \\text{ rad}) = 7.09\\cos^2(5\\pi/3) - 1.42\\cos(5\\pi/3) + 1.77 = 7.09(0.5)^2 - 1.42(0.5) + 1.77 = 2.8325 \\text{ Hz}$.\n\nFor $\\,^3J_{\\text{H3′–H4′}}$:\n- $J_{34}^{(1)} = J(180^\\circ) = 10.28 \\text{ Hz}$.\n- $J_{34}^{(2)} = J(60^\\circ) = 2.8325 \\text{ Hz}$.\n- $J_{34}^{(3)} = J(300^\\circ) = 2.8325 \\text{ Hz}$.\n\nThe experimentally measured J-coupling is an ensemble average over all thermally accessible conformations. The ensemble-averaged couplings, $\\langle J_{12} \\rangle$ and $\\langle J_{34} \\rangle$, are computed as the weighted average of the state-specific couplings, where the weights are the populations $p_i$:\n$$\n\\langle J_{12} \\rangle = \\sum_{i=1}^{3} p_i J_{12}^{(i)}\n\\qquad\n\\langle J_{34} \\rangle = \\sum_{i=1}^{3} p_i J_{34}^{(i)}\n$$\n\nFinally, we assess the quality of our model for a given set of scaling factors $(S_\\text{elec}, S_\\text{LJ})$ by comparing the calculated ensemble averages to fixed experimental reference values: $J_{12}^{\\text{(exp)}} = 5.50 \\text{ Hz}$ and $J_{34}^{\\text{(exp)}} = 6.90 \\text{ Hz}$. The deviation is quantified by the root-mean-square error (RMSE):\n$$\n\\text{RMSE} = \\sqrt{\\frac{1}{2}\\left( (\\langle J_{12} \\rangle - J_{12}^{\\text{(exp)}})^2 + (\\langle J_{34} \\rangle - J_{34}^{\\text{(exp)}})^2 \\right)}\n$$\n\nThe algorithmic procedure for each test case $(S_\\text{elec}, S_\\text{LJ})$ is as follows:\n$1$. For each conformer $i \\in \\{1, 2, 3\\}$, calculate the total energy $E_i(S_\\text{elec}, S_\\text{LJ})$.\n$2$. Using these energies, compute the Boltzmann weights $w_i$ and normalize them to obtain the populations $p_i$.\n$3$. Calculate the ensemble-averaged couplings $\\langle J_{12} \\rangle$ and $\\langle J_{34} \\rangle$ using the pre-computed $J^{(i)}$ values and the calculated populations $p_i$.\n$4$. Compute the final RMSE value by comparing the averaged couplings to the experimental targets.\n\nThis procedure will be implemented for the four specified pairs of scaling factors.", "answer": "[1.801646394582962,0.8654227843813876,1.4468648171731637,2.155891465225027]", "id": "3430408"}]}