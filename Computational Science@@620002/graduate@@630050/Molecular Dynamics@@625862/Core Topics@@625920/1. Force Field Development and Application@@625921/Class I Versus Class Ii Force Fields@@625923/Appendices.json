{"hands_on_practices": [{"introduction": "To truly grasp the distinction between Class I and Class II force fields, we must begin with their mathematical foundation: the potential energy function. This exercise takes you to the core of this difference by tasking you with constructing the Hessian matrix, which quantifies the curvature of the potential energy surface near an equilibrium geometry. By deriving and comparing the Hessians for a simple triatomic molecule using both a Class I (uncoupled) and a Class II (coupled) potential, you will see precisely how cross-terms manifest as off-diagonal elements, representing the coupling between molecular motions [@problem_id:3400965].", "problem": "Consider a non-linear triatomic molecule $A\\!-\\!B\\!-\\!C$ whose internal coordinates are $q_{1} = r_{AB}$, $q_{2} = r_{BC}$, and $q_{3} = \\theta_{ABC}$. In molecular dynamics (MD), small-amplitude vibrations near a reference geometry are captured by a quadratic approximation to the potential energy surface (PES), and the corresponding Hessian in internal coordinates is defined by $H_{ij} = \\left.\\frac{\\partial^{2}V}{\\partial q_{i}\\,\\partial q_{j}}\\right|_{q=q^{0}}$, where $q^{0} = (r_{AB}^{0}, r_{BC}^{0}, \\theta_{ABC}^{0})$ is the reference geometry.\n\nUsing only fundamental definitions and widely accepted forms of intramolecular potentials for bonded interactions, construct the internal-coordinate Hessian for the following two cases:\n\n(i) A Class I force field model with purely harmonic bond stretches and angle bending,\n$$\nV_{\\mathrm{I}} = \\tfrac{1}{2}k_{1}\\left(q_{1} - q_{1}^{0}\\right)^{2} + \\tfrac{1}{2}k_{2}\\left(q_{2} - q_{2}^{0}\\right)^{2} + \\tfrac{1}{2}k_{3}\\left(q_{3} - q_{3}^{0}\\right)^{2},\n$$\nwhere $k_{1}$, $k_{2}$, and $k_{3}$ are positive force constants.\n\n(ii) A Class II force field model that augments the above with stretch–bend coupling terms,\n$$\nV_{\\mathrm{II}} = V_{\\mathrm{I}} + k_{sb,1}\\left(q_{1} - q_{1}^{0}\\right)\\left(q_{3} - q_{3}^{0}\\right) + k_{sb,2}\\left(q_{2} - q_{2}^{0}\\right)\\left(q_{3} - q_{3}^{0}\\right),\n$$\nwhere $k_{sb,1}$ and $k_{sb,2}$ are coupling constants.\n\nDerive $H_{ij}$ symbolically for each case by evaluating the appropriate second derivatives at $q=q^{0}$, identify the off-diagonal elements, and compare how the off-diagonal structure changes from case (i) to case (ii). For your final reported result, provide the off-diagonal entries $H_{12}$, $H_{13}$, and $H_{23}$ for case (ii), ordered as $\\left(H_{12},\\,H_{13},\\,H_{23}\\right)$, expressed as a single analytic row matrix. No numerical approximation is required, and no units should be included in the reported row matrix.", "solution": "The user has provided a problem that is scientifically grounded, well-posed, and objective. It is based on standard definitions and models from molecular mechanics and vibrational spectroscopy. All necessary information is provided, and the problem is free of contradictions or ambiguities. Therefore, the problem is deemed valid and a full solution will be provided.\n\nThe problem requires the construction of the internal-coordinate Hessian matrix, $H$, for a non-linear triatomic molecule $A\\!-\\!B\\!-\\!C$. The elements of this matrix are defined as the second partial derivatives of the potential energy function $V$ with respect to the internal coordinates $q_i$, evaluated at a reference geometry $q^0$. The internal coordinates are given as $q_{1} = r_{AB}$, $q_{2} = r_{BC}$, and $q_{3} = \\theta_{ABC}$. The reference geometry is $q^{0} = (q_{1}^{0}, q_{2}^{0}, q_{3}^{0})$. The Hessian matrix element $H_{ij}$ is thus given by:\n$$\nH_{ij} = \\left.\\frac{\\partial^{2}V}{\\partial q_{i}\\,\\partial q_{j}}\\right|_{q=q^{0}}\n$$\nWe will compute this matrix for the two potential energy functions provided.\n\n**Case (i): Class I Force Field**\n\nThe potential energy function for the Class I model is:\n$$\nV_{\\mathrm{I}} = \\tfrac{1}{2}k_{1}\\left(q_{1} - q_{1}^{0}\\right)^{2} + \\tfrac{1}{2}k_{2}\\left(q_{2} - q_{2}^{0}\\right)^{2} + \\tfrac{1}{2}k_{3}\\left(q_{3} - q_{3}^{0}\\right)^{2}\n$$\nwhere $k_{1}$, $k_{2}$, and $k_{3}$ are positive force constants. We proceed by calculating the required second partial derivatives.\n\nFirst, we compute the diagonal elements of the Hessian, $H_{ii}$:\n$$\n\\frac{\\partial V_{\\mathrm{I}}}{\\partial q_{1}} = k_{1}\\left(q_{1} - q_{1}^{0}\\right) \\implies H_{11} = \\left.\\frac{\\partial^{2}V_{\\mathrm{I}}}{\\partial q_{1}^{2}}\\right|_{q=q^{0}} = \\left. k_{1} \\right|_{q=q^{0}} = k_{1}\n$$\n$$\n\\frac{\\partial V_{\\mathrm{I}}}{\\partial q_{2}} = k_{2}\\left(q_{2} - q_{2}^{0}\\right) \\implies H_{22} = \\left.\\frac{\\partial^{2}V_{\\mathrm{I}}}{\\partial q_{2}^{2}}\\right|_{q=q^{0}} = \\left. k_{2} \\right|_{q=q^{0}} = k_{2}\n$$\n$$\n\\frac{\\partial V_{\\mathrm{I}}}{\\partial q_{3}} = k_{3}\\left(q_{3} - q_{3}^{0}\\right) \\implies H_{33} = \\left.\\frac{\\partial^{2}V_{\\mathrm{I}}}{\\partial q_{3}^{2}}\\right|_{q=q^{0}} = \\left. k_{3} \\right|_{q=q^{0}} = k_{3}\n$$\nNext, we compute the off-diagonal elements, $H_{ij}$ for $i \\neq j$. By the equality of mixed partials (Clairaut's theorem), $H_{ij} = H_{ji}$.\n$$\nH_{12} = \\frac{\\partial}{\\partial q_{1}}\\left(\\frac{\\partial V_{\\mathrm{I}}}{\\partial q_{2}}\\right) = \\frac{\\partial}{\\partial q_{1}}\\left(k_{2}\\left(q_{2} - q_{2}^{0}\\right)\\right) = 0\n$$\nSince the derivative is zero everywhere, its value at $q=q^0$ is also $0$.\n$$\nH_{13} = \\frac{\\partial}{\\partial q_{1}}\\left(\\frac{\\partial V_{\\mathrm{I}}}{\\partial q_{3}}\\right) = \\frac{\\partial}{\\partial q_{1}}\\left(k_{3}\\left(q_{3} - q_{3}^{0}\\right)\\right) = 0\n$$\n$$\nH_{23} = \\frac{\\partial}{\\partial q_{2}}\\left(\\frac{\\partial V_{\\mathrm{I}}}{\\partial q_{3}}\\right) = \\frac{\\partial}{\\partial q_{2}}\\left(k_{3}\\left(q_{3} - q_{3}^{0}\\right)\\right) = 0\n$$\nThus, for the Class I model, the Hessian matrix is diagonal:\n$$\nH_{\\mathrm{I}} = \\begin{pmatrix} k_{1} & 0 & 0 \\\\ 0 & k_{2} & 0 \\\\ 0 & 0 & k_{3} \\end{pmatrix}\n$$\nAll off-diagonal elements are zero. This signifies that in this simple harmonic model, the bond stretches and the angle bend are completely uncoupled.\n\n**Case (ii): Class II Force Field**\n\nThe potential energy function for the Class II model includes cross-terms:\n$$\nV_{\\mathrm{II}} = V_{\\mathrm{I}} + k_{sb,1}\\left(q_{1} - q_{1}^{0}\\right)\\left(q_{3} - q_{3}^{0}\\right) + k_{sb,2}\\left(q_{2} - q_{2}^{0}\\right)\\left(q_{3} - q_{3}^{0}\\right)\n$$\nThe Hessian for $V_{\\mathrm{II}}$ can be calculated by adding the second derivatives of the new terms to the Hessian of $V_{\\mathrm{I}}$. Let $V_{\\text{cross}} = k_{sb,1}\\left(q_{1} - q_{1}^{0}\\right)\\left(q_{3} - q_{3}^{0}\\right) + k_{sb,2}\\left(q_{2} - q_{2}^{0}\\right)\\left(q_{3} - q_{3}^{0}\\right)$.\n\nLet's re-evaluate the Hessian elements.\nThe diagonal elements are:\n$$\n\\frac{\\partial^{2}V_{\\text{cross}}}{\\partial q_{1}^{2}} = \\frac{\\partial}{\\partial q_{1}}\\left(k_{sb,1}\\left(q_{3} - q_{3}^{0}\\right)\\right) = 0\n$$\n$$\n\\frac{\\partial^{2}V_{\\text{cross}}}{\\partial q_{2}^{2}} = \\frac{\\partial}{\\partial q_{2}}\\left(k_{sb,2}\\left(q_{3} - q_{3}^{0}\\right)\\right) = 0\n$$\n$$\n\\frac{\\partial^{2}V_{\\text{cross}}}{\\partial q_{3}^{2}} = \\frac{\\partial}{\\partial q_{3}}\\left(k_{sb,1}\\left(q_{1} - q_{1}^{0}\\right) + k_{sb,2}\\left(q_{2} - q_{2}^{0}\\right)\\right) = 0\n$$\nTherefore, the diagonal elements of the Hessian $H_{\\mathrm{II}}$ are identical to those of $H_{\\mathrm{I}}$: $H_{11} = k_{1}$, $H_{22} = k_{2}$, and $H_{33} = k_{3}$.\n\nNow we compute the off-diagonal elements:\n$$\nH_{12} = \\left.\\frac{\\partial^{2}V_{\\mathrm{II}}}{\\partial q_{1}\\,\\partial q_{2}}\\right|_{q=q^{0}} = \\frac{\\partial}{\\partial q_{1}}\\left(\\frac{\\partial V_{\\mathrm{I}}}{\\partial q_{2}} + \\frac{\\partial V_{\\text{cross}}}{\\partial q_{2}}\\right) = \\frac{\\partial}{\\partial q_{1}}\\left(k_{2}(q_{2}-q_{2}^{0}) + k_{sb,2}(q_{3}-q_{3}^{0})\\right) = 0\n$$\nSo the $H_{12}$ element remains zero. This term represents the stretch-stretch coupling, which is not included in this particular Class II potential form.\n$$\nH_{13} = \\left.\\frac{\\partial^{2}V_{\\mathrm{II}}}{\\partial q_{1}\\,\\partial q_{3}}\\right|_{q=q^{0}} = \\frac{\\partial}{\\partial q_{1}}\\left(\\frac{\\partial V_{\\mathrm{I}}}{\\partial q_{3}} + \\frac{\\partial V_{\\text{cross}}}{\\partial q_{3}}\\right) = \\frac{\\partial}{\\partial q_{1}}\\left(k_{3}(q_{3}-q_{3}^{0}) + k_{sb,1}(q_{1}-q_{1}^{0}) + k_{sb,2}(q_{2}-q_{2}^{0})\\right) = k_{sb,1}\n$$\nEvaluation at $q=q^0$ is simply $k_{sb,1}$.\n$$\nH_{23} = \\left.\\frac{\\partial^{2}V_{\\mathrm{II}}}{\\partial q_{2}\\,\\partial q_{3}}\\right|_{q=q^{0}} = \\frac{\\partial}{\\partial q_{2}}\\left(\\frac{\\partial V_{\\mathrm{I}}}{\\partial q_{3}} + \\frac{\\partial V_{\\text{cross}}}{\\partial q_{3}}\\right) = \\frac{\\partial}{\\partial q_{2}}\\left(k_{3}(q_{3}-q_{3}^{0}) + k_{sb,1}(q_{1}-q_{1}^{0}) + k_{sb,2}(q_{2}-q_{2}^{0})\\right) = k_{sb,2}\n$$\nEvaluation at $q=q^0$ is simply $k_{sb,2}$.\n\nThe full Hessian for the Class II model is:\n$$\nH_{\\mathrm{II}} = \\begin{pmatrix} k_{1} & 0 & k_{sb,1} \\\\ 0 & k_{2} & k_{sb,2} \\\\ k_{sb,1} & k_{sb,2} & k_{3} \\end{pmatrix}\n$$\n\n**Comparison and Final Answer**\n\nComparing the Hessians for the two cases reveals the effect of the Class II cross-terms.\n- In the Class I model ($H_{\\mathrm{I}}$), the Hessian is diagonal. All off-diagonal elements are zero. This corresponds to a potential energy surface where the internal motions (two stretches and one bend) are independent of each other in the harmonic approximation.\n- In the Class II model ($H_{\\mathrm{II}}$), the off-diagonal elements $H_{13}$ and $H_{23}$ (and their symmetric counterparts $H_{31}$ and $H_{32}$) are non-zero. They are equal to the coupling constants $k_{sb,1}$ and $k_{sb,2}$, respectively. This introduces a coupling between the stretching of bond $A\\!-\\!B$ and the bending of angle $\\theta_{ABC}$, and between the stretching of bond $B\\!-\\!C$ and the bending of angle $\\theta_{ABC}$. This is a more physically realistic representation, as stretching a bond often changes the electronic structure in a way that affects the stiffness of an adjacent angle. The stretch-stretch coupling term $H_{12}$ remains zero because no $(q_1-q_1^0)(q_2-q_2^0)$ term was included in the potential.\n\nThe problem asks for the off-diagonal entries $H_{12}$, $H_{13}$, and $H_{23}$ for case (ii) as an ordered row matrix. Based on our derivation:\n$H_{12} = 0$\n$H_{13} = k_{sb,1}$\n$H_{23} = k_{sb,2}$\n\nThe requested row matrix is therefore $(0, k_{sb,1}, k_{sb,2})$.", "answer": "$$\n\\boxed{\\begin{pmatrix} 0 & k_{sb,1} & k_{sb,2} \\end{pmatrix}}\n$$", "id": "3400965"}, {"introduction": "Having established the mathematical difference, the crucial next question is: why does this coupling matter for accuracy? This practice bridges the gap between the theoretical model and physical reality by using a more accurate quantum mechanical (QM) calculation as a \"ground truth\" benchmark. You will implement a protocol to fit both Class I and Class II models to a QM-derived Hessian and discover how the inclusion of cross-terms is vital for reproducing a system's softest vibrational modes—the very motions that govern conformational sampling and molecular flexibility [@problem_id:3401000].", "problem": "Consider a single internal coordinate pair for a triatomic system consisting of a bond displacement and a bond angle displacement. Let the generalized coordinate vector be $q = [\\Delta b, \\Delta \\theta]^{\\top}$, where $\\Delta b$ is a bond-length displacement expressed in angstroms and $\\Delta \\theta$ is an angle displacement expressed in radians. The potential energy of small displacements about equilibrium can be represented to second order by a quadratic form. In the Quantum Mechanics (QM) description, for example at the Density Functional Theory (DFT) level, the quadratic form is characterized by a symmetric Hessian matrix $H_{\\mathrm{QM}}$ in the internal coordinate basis, with entries in units of kilocalories per mole per squared-coordinate (for diagonal entries) and kilocalories per mole per angstrom-radian (for off-diagonal entries). The Molecular Mechanics (MM) description uses empirical potential forms. Class I force fields typically include uncoupled harmonic terms for bonds and angles. Class II force fields include additional cross-coupling terms such as bond-angle couplings.\n\nStarting from the following principles:\n- Newton’s second law $m \\, d^{2}x/dt^{2} = F$ and the small-oscillation approximation about a stable equilibrium.\n- The expansion of the potential energy to second order in the generalized coordinates, $V(q) \\approx \\frac{1}{2} q^{\\top} H q$, where $H$ is the Hessian of second derivatives evaluated at equilibrium.\n- The identification that, for harmonic potentials in internal coordinates, Class I can be written as $V_{\\mathrm{I}}(\\Delta b,\\Delta \\theta) = \\frac{1}{2} k_{b} (\\Delta b)^{2} + \\frac{1}{2} k_{\\theta} (\\Delta \\theta)^{2}$, and Class II as $V_{\\mathrm{II}}(\\Delta b,\\Delta \\theta) = \\frac{1}{2} k_{b} (\\Delta b)^{2} + \\frac{1}{2} k_{\\theta} (\\Delta \\theta)^{2} + k_{b\\theta} \\, \\Delta b \\, \\Delta \\theta$, where $k_{b}$, $k_{\\theta}$, and $k_{b\\theta}$ are force-field parameters.\n\nYour task is to design and implement a protocol that maps a given QM Hessian $H_{\\mathrm{QM}}$ to MM parameters for Class I and Class II force fields by fitting to the Hessian. Treat the MM Hessian $H_{\\mathrm{MM}}$ implied by the MM potential form as the quantity to be fitted to $H_{\\mathrm{QM}}$ by minimizing the Frobenius-norm error. Compute, for each class, the smallest eigenvalue $\\lambda_{\\min}$ of the corresponding Hessian (which reflects the curvature of the softest mode in these internal coordinates and is a proxy for a low-frequency mode important for conformational sampling) and quantify the relative mismatch as $r = \\left| \\lambda_{\\min}^{\\mathrm{MM}} - \\lambda_{\\min}^{\\mathrm{QM}} \\right| \\big/ \\lambda_{\\min}^{\\mathrm{QM}}$.\n\nImplement this protocol as a complete program that:\n- Represents the Class I and Class II MM Hessians derived from their respective potentials and fits the parameters to a given $H_{\\mathrm{QM}}$ by minimizing $\\| H_{\\mathrm{MM}} - H_{\\mathrm{QM}} \\|_{\\mathrm{F}}$ subject to physically reasonable positivity of $k_{b}$ and $k_{\\theta}$.\n- Computes $\\lambda_{\\min}^{\\mathrm{QM}}$, $\\lambda_{\\min}^{\\mathrm{I}}$, and $\\lambda_{\\min}^{\\mathrm{II}}$ by symmetric eigenvalue decomposition.\n- Computes the relative mismatches $r_{\\mathrm{I}}$ and $r_{\\mathrm{II}}$ for Class I and Class II, respectively.\n- Tests whether including the bond-angle coupling parameter $k_{b\\theta}$ reduces the mismatch in the low-curvature mode by evaluating whether $r_{\\mathrm{II}} < r_{\\mathrm{I}} - \\tau$, with a numerical tolerance $\\tau = 1\\times 10^{-12}$ to avoid floating point artifacts, and reports a boolean result for each test case.\n\nPhysical units and angle units:\n- Express displacements $\\Delta b$ in angstroms and $\\Delta \\theta$ in radians.\n- Hessian entries are in kilocalories per mole per squared-coordinate and kilocalories per mole per angstrom-radian. The eigenvalues are in kilocalories per mole per squared-coordinate and the relative mismatch $r$ is dimensionless.\n\nUse the following test suite of QM Hessians (each is a $2 \\times 2$ symmetric matrix in the internal coordinate basis $[\\Delta b, \\Delta \\theta]$):\n- Case $1$ (moderate positive coupling): $H_{\\mathrm{QM}}^{(1)} = \\begin{bmatrix} 200.0 & 30.0 \\\\ 30.0 & 40.0 \\end{bmatrix}$.\n- Case $2$ (no coupling): $H_{\\mathrm{QM}}^{(2)} = \\begin{bmatrix} 150.0 & 0.0 \\\\ 0.0 & 10.0 \\end{bmatrix}$.\n- Case $3$ (strong near-degenerate diagonal with large coupling): $H_{\\mathrm{QM}}^{(3)} = \\begin{bmatrix} 5.0 & 4.5 \\\\ 4.5 & 5.0 \\end{bmatrix}$.\n- Case $4$ (negative coupling): $H_{\\mathrm{QM}}^{(4)} = \\begin{bmatrix} 100.0 & -20.0 \\\\ -20.0 & 30.0 \\end{bmatrix}$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (for example, $[\\mathrm{True},\\mathrm{False},\\mathrm{True},\\mathrm{True}]$), where each boolean indicates whether including $k_{b\\theta}$ in Class II reduced the low-curvature mismatch relative to Class I for the corresponding case.", "solution": "The problem is valid. It is scientifically grounded in the principles of classical mechanics and computational chemistry, well-posed with a clear objective and sufficient data, and objective in its formulation. We can therefore proceed with a solution.\n\nThe core of this problem is to compare two molecular mechanics (MM) force field models, Class I and Class II, against a more accurate quantum mechanics (QM) description of the potential energy surface for a two-dimensional system. The comparison is based on how well each model reproduces the lowest-curvature mode of the QM potential, which is represented by the smallest eigenvalue of the Hessian matrix.\n\nLet the generalized coordinate vector be $q = [\\Delta b, \\Delta \\theta]^{\\top}$, where $\\Delta b$ is the bond displacement and $\\Delta \\theta$ is the angle displacement. The potential energy $V$ for small displacements is given by the quadratic form $V(q) \\approx \\frac{1}{2} q^{\\top} H q$. The Hessian matrix $H$ is a matrix of second partial derivatives of the potential energy with respect to the coordinates, $H_{ij} = \\frac{\\partial^2 V}{\\partial q_i \\partial q_j}$, evaluated at the equilibrium geometry.\n\nThe QM Hessian, $H_{\\mathrm{QM}}$, is given for each test case as a $2 \\times 2$ symmetric matrix:\n$$\nH_{\\mathrm{QM}} = \\begin{bmatrix} H_{11} & H_{12} \\\\ H_{12} & H_{22} \\end{bmatrix}\n$$\nHere, $H_{11}$ relates to the bond stiffness, $H_{22}$ to the angle stiffness, and $H_{12}$ to the coupling between bond stretching and angle bending.\n\nThe task involves deriving the corresponding Hessians for the Class I and Class II MM models, fitting their parameters to $H_{\\mathrm{QM}}$, and then comparing the eigenvalues.\n\n**1. Derivation and Fitting of MM Hessians**\n\nThe MM potentials are given as:\n- Class I: $V_{\\mathrm{I}}(q) = \\frac{1}{2} k_{b} (\\Delta b)^{2} + \\frac{1}{2} k_{\\theta} (\\Delta \\theta)^{2}$\n- Class II: $V_{\\mathrm{II}}(q) = \\frac{1}{2} k_{b} (\\Delta b)^{2} + \\frac{1}{2} k_{\\theta} (\\Delta \\theta)^{2} + k_{b\\theta} \\, \\Delta b \\, \\Delta \\theta$\n\nFrom these potentials, we derive the MM Hessians, $H_{\\mathrm{MM}}^{\\mathrm{I}}$ and $H_{\\mathrm{MM}}^{\\mathrm{II}}$.\n\nFor the Class I model:\n$H_{11}^{\\mathrm{I}} = \\frac{\\partial^2 V_{\\mathrm{I}}}{\\partial (\\Delta b)^2} = k_b$\n$H_{22}^{\\mathrm{I}} = \\frac{\\partial^2 V_{\\mathrm{I}}}{\\partial (\\Delta \\theta)^2} = k_\\theta$\n$H_{12}^{\\mathrm{I}} = \\frac{\\partial^2 V_{\\mathrm{I}}}{\\partial (\\Delta b) \\partial (\\Delta \\theta)} = 0$\nThus, the Class I Hessian has the form:\n$$\nH_{\\mathrm{MM}}^{\\mathrm{I}} = \\begin{bmatrix} k_b & 0 \\\\ 0 & k_\\theta \\end{bmatrix}\n$$\n\nFor the Class II model:\n$H_{11}^{\\mathrm{II}} = \\frac{\\partial^2 V_{\\mathrm{II}}}{\\partial (\\Delta b)^2} = k_b$\n$H_{22}^{\\mathrm{II}} = \\frac{\\partial^2 V_{\\mathrm{II}}}{\\partial (\\Delta \\theta)^2} = k_\\theta$\n$H_{12}^{\\mathrm{II}} = \\frac{\\partial^2 V_{\\mathrm{II}}}{\\partial (\\Delta b) \\partial (\\Delta \\theta)} = k_{b\\theta}$\nThus, the Class II Hessian has the form:\n$$\nH_{\\mathrm{MM}}^{\\mathrm{II}} = \\begin{bmatrix} k_b & k_{b\\theta} \\\\ k_{b\\theta} & k_\\theta \\end{bmatrix}\n$$\n\nThe parameters ($k_b, k_\\theta, k_{b\\theta}$) are determined by minimizing the Frobenius norm of the difference between the MM and QM Hessians, $\\| H_{\\mathrm{MM}} - H_{\\mathrm{QM}} \\|_{\\mathrm{F}}$. The squared Frobenius norm is the sum of the squared differences of the matrix elements.\n\nFor Class I, we minimize $\\| H_{\\mathrm{MM}}^{\\mathrm{I}} - H_{\\mathrm{QM}} \\|_{\\mathrm{F}}^2 = (k_b - H_{11})^2 + (0 - H_{12})^2 + (0 - H_{12})^2 + (k_\\theta - H_{22})^2$.\nThis sum is minimized by choosing parameters that minimize each term independently. The optimal parameters are clearly $k_b = H_{11}$ and $k_\\theta = H_{22}$. The problem specifies that the system is at a stable equilibrium, which implies the Hessian is positive-definite. For a $2 \\times 2$ matrix, this means $H_{11}>0$ and $H_{22}>0$, so the constraints $k_b > 0$ and $k_\\theta > 0$ are satisfied. The resulting Class I Hessian is the diagonal part of the QM Hessian:\n$$\nH_{\\mathrm{MM}}^{\\mathrm{I}} = \\begin{bmatrix} H_{11} & 0 \\\\ 0 & H_{22} \\end{bmatrix}\n$$\n\nFor Class II, we minimize $\\| H_{\\mathrm{MM}}^{\\mathrm{II}} - H_{\\mathrm{QM}} \\|_{\\mathrm{F}}^2 = (k_b - H_{11})^2 + (k_{b\\theta} - H_{12})^2 + (k_{b\\theta} - H_{12})^2 + (k_\\theta - H_{22})^2$.\nThe minimum is achieved when $k_b = H_{11}$, $k_\\theta = H_{22}$, and $k_{b\\theta} = H_{12}$. This fitting is exact, resulting in a minimum error of $0$. The Class II Hessian is identical to the QM Hessian:\n$$\nH_{\\mathrm{MM}}^{\\mathrm{II}} = H_{\\mathrm{QM}}\n$$\n\n**2. Eigenvalue Calculation and Mismatch Analysis**\n\nThe next step is to compute the smallest eigenvalue, $\\lambda_{\\min}$, for each Hessian: $H_{\\mathrm{QM}}$, $H_{\\mathrm{MM}}^{\\mathrm{I}}$, and $H_{\\mathrm{MM}}^{\\mathrm{II}}$. The eigenvalues of a $2 \\times 2$ symmetric matrix $\\begin{bmatrix} a & b \\\\ b & c \\end{bmatrix}$ are given by the formula $\\lambda = \\frac{(a+c) \\pm \\sqrt{(a-c)^2 + 4b^2}}{2}$. The smallest eigenvalue, $\\lambda_{\\min}$, corresponds to the minus sign. For a diagonal matrix, the eigenvalues are simply the diagonal entries.\n\n- $\\lambda_{\\min}^{\\mathrm{QM}}$ is the smallest eigenvalue of $H_{\\mathrm{QM}}$.\n- $\\lambda_{\\min}^{\\mathrm{I}}$ is the smallest eigenvalue of $H_{\\mathrm{MM}}^{\\mathrm{I}}$. Since $H_{\\mathrm{MM}}^{\\mathrm{I}}$ is diagonal, its eigenvalues are $H_{11}$ and $H_{22}$, so $\\lambda_{\\min}^{\\mathrm{I}} = \\min(H_{11}, H_{22})$.\n- $\\lambda_{\\min}^{\\mathrm{II}}$ is the smallest eigenvalue of $H_{\\mathrm{MM}}^{\\mathrm{II}}$. Since $H_{\\mathrm{MM}}^{\\mathrm{II}} = H_{\\mathrm{QM}}$, we have $\\lambda_{\\min}^{\\mathrm{II}} = \\lambda_{\\min}^{\\mathrm{QM}}$.\n\nThe relative mismatch for each class is calculated as $r = \\left| \\lambda_{\\min}^{\\mathrm{MM}} - \\lambda_{\\min}^{\\mathrm{QM}} \\right| \\big/ \\lambda_{\\min}^{\\mathrm{QM}}$.\n\nFor Class I:\n$$\nr_{\\mathrm{I}} = \\frac{\\left| \\lambda_{\\min}^{\\mathrm{I}} - \\lambda_{\\min}^{\\mathrm{QM}} \\right|}{\\lambda_{\\min}^{\\mathrm{QM}}} = \\frac{\\left| \\min(H_{11}, H_{22}) - \\lambda_{\\min}^{\\mathrm{QM}} \\right|}{\\lambda_{\\min}^{\\mathrm{QM}}}\n$$\nFor Class II:\n$$\nr_{\\mathrm{II}} = \\frac{\\left| \\lambda_{\\min}^{\\mathrm{II}} - \\lambda_{\\min}^{\\mathrm{QM}} \\right|}{\\lambda_{\\min}^{\\mathrm{QM}}} = \\frac{\\left| \\lambda_{\\min}^{\\mathrm{QM}} - \\lambda_{\\min}^{\\mathrm{QM}} \\right|}{\\lambda_{\\min}^{\\mathrm{QM}}} = 0\n$$\n\n**3. Comparison and Decision Logic**\n\nThe final step is to test if including the cross-coupling term provides a significant improvement. This is evaluated using the condition $r_{\\mathrm{II}} < r_{\\mathrm{I}} - \\tau$, with a tolerance $\\tau = 1 \\times 10^{-12}$.\nSubstituting $r_{\\mathrm{II}} = 0$, the condition becomes $0 < r_{\\mathrm{I}} - \\tau$, or simply $r_{\\mathrm{I}} > \\tau$.\n\nThis means the Class II model is considered an improvement if and only if the Class I model's relative mismatch in the smallest eigenvalue is greater than the numerical tolerance $\\tau$. This will be true for any QM Hessian that has a non-zero off-diagonal coupling term $H_{12}$, because this coupling affects the eigenvalues, whereas the Class I model, by construction, ignores it. If $H_{12} = 0$, then $H_{\\mathrm{QM}}$ is diagonal, $\\lambda_{\\min}^{\\mathrm{QM}} = \\min(H_{11}, H_{22}) = \\lambda_{\\min}^{\\mathrm{I}}$, so $r_{\\mathrm{I}} = 0$, and the condition $r_{\\mathrm{I}} > \\tau$ fails.\n\n**Algorithmic Protocol**\n\nFor each given $H_{\\mathrm{QM}}$:\n1.  Compute the eigenvalues of $H_{\\mathrm{QM}}$ and find $\\lambda_{\\min}^{\\mathrm{QM}}$.\n2.  Identify the diagonal elements $H_{11}$ and $H_{22}$.\n3.  Compute $\\lambda_{\\min}^{\\mathrm{I}} = \\min(H_{11}, H_{22})$.\n4.  Calculate the Class I mismatch $r_{\\mathrm{I}} = |\\lambda_{\\min}^{\\mathrm{I}} - \\lambda_{\\min}^{\\mathrm{QM}}| / \\lambda_{\\min}^{\\mathrm{QM}}$.\n5.  Set the Class II mismatch $r_{\\mathrm{II}} = 0$.\n6.  Evaluate the boolean expression $r_{\\mathrm{II}} < r_{\\mathrm{I}} - \\tau$. This simplifies to checking if $r_{\\mathrm{I}} > \\tau$.\n7.  Append the boolean result to a list.\n8.  After processing all cases, format the list of booleans as the final output.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Implements a protocol to compare Class I and Class II force fields\n    by fitting to QM Hessians and evaluating the mismatch in the\n    lowest-frequency vibrational mode proxy.\n    \"\"\"\n\n    # Define the test cases for the QM Hessian matrices\n    # H_QM = [[H_bb, H_b_theta], [H_b_theta, H_theta_theta]]\n    # Units: kcal/mol/Angstrom^2 (or rad^2) for diagonal,\n    #        kcal/mol/Angstrom-rad for off-diagonal.\n    test_cases = [\n        # Case 1: moderate positive coupling\n        np.array([[200.0, 30.0], [30.0, 40.0]]),\n        # Case 2: no coupling\n        np.array([[150.0, 0.0], [0.0, 10.0]]),\n        # Case 3: strong near-degenerate diagonal with large coupling\n        np.array([[5.0, 4.5], [4.5, 5.0]]),\n        # Case 4: negative coupling\n        np.array([[100.0, -20.0], [-20.0, 30.0]]),\n    ]\n\n    # Numerical tolerance for floating point comparisons\n    tau = 1e-12\n\n    results = []\n\n    for H_qm in test_cases:\n        # --- QM Analysis ---\n        # The eigenvalues of the Hessian correspond to the force constants of\n        # the normal modes. We need the smallest one (softest mode).\n        # numpy.linalg.eigh is used for symmetric matrices and returns\n        # eigenvalues in ascending order.\n        eigenvalues_qm = np.linalg.eigh(H_qm)[0]\n        lambda_min_qm = eigenvalues_qm[0]\n\n        # --- Class I Force Field Analysis ---\n        # The Class I model neglects off-diagonal terms. The best fit in the\n        # Frobenius norm sense is to set k_b and k_theta to the diagonal\n        # elements of H_qm.\n        # H_mm_I = [[H_qm[0,0], 0], [0, H_qm[1,1]]]\n        # The eigenvalues of a diagonal matrix are its diagonal elements.\n        lambda_min_I = min(H_qm[0, 0], H_qm[1, 1])\n        \n        # Calculate the relative mismatch for Class I.\n        # Since H_qm at a stable minimum is positive definite, lambda_min_qm > 0.\n        r_I = abs(lambda_min_I - lambda_min_qm) / lambda_min_qm\n\n        # --- Class II Force Field Analysis ---\n        # The Class II model includes the cross-term. The best fit in the\n        # Frobenius norm sense sets the parameters such that H_mm_II = H_qm.\n        # This is a perfect fit.\n        # Therefore, the eigenvalues are identical.\n        lambda_min_II = lambda_min_qm\n        \n        # The relative mismatch for Class II is zero.\n        r_II = 0.0\n\n        # --- Comparison ---\n        # Test if the Class II model has a smaller mismatch than the Class I model,\n        # accounting for the numerical tolerance tau.\n        # The condition is r_II  r_I - tau\n        is_improved = r_II  r_I - tau\n        results.append(is_improved)\n\n    # Final print statement in the exact required format.\n    # The map(str, ...) converts boolean True/False to strings \"True\"/\"False\".\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3401000"}, {"introduction": "Molecular dynamics simulations often employ techniques like constraints on high-frequency bond vibrations to allow for larger integration timesteps. This practical consideration introduces a subtle but important question: do the sophisticated cross-terms of a Class II force field still have an effect if one of the motions they couple to is frozen? This thought experiment challenges you to analyze how a stretch-bend coupling term behaves under a rigid constraint, revealing the nuanced ways in which these advanced energetic terms influence a system's effective potential and dynamics [@problem_id:3400984].", "problem": "In classical molecular dynamics (MD), constraints such as the SHAKE constraint algorithm (SHAKE) can be used to fix selected internal coordinates at specified values, thereby removing fast high-frequency degrees of freedom from the numerical integration. Consider a single angle degree of freedom $\\theta$ formed by atoms $i$-$j$-$k$, where the $j$-$k$ bond (for example, a bond to hydrogen) has length $r$. In a Class II force field, the potential energy for this triad is modeled by the sum of a harmonic bond, a harmonic angle, and a stretch-bend cross term,\n$$\nU(r,\\theta) \\;=\\; \\tfrac{1}{2} k_r \\,(r - r_0)^2 \\;+\\; \\tfrac{1}{2} k_\\theta \\,(\\theta - \\theta_0)^2 \\;+\\; k_{sb}\\,(r - r_0)\\,(\\theta - \\theta_0),\n$$\nwhere $k_r$, $k_\\theta$, $k_{sb}$ are positive constants and $r_0$, $\\theta_0$ are the reference bond length and angle, respectively. Assume holonomic constraints fix the bond length to $r=r_c$ at all times, with $r_c$ either equal to $r_0$ or not, and consider two ways of removing the coordinate $r$:\n- Exact holonomic constraint: enforce $r=r_c$ identically in time and compute the generalized force on $\\theta$ as the negative gradient of the constrained potential with respect to $\\theta$.\n- Adiabatic elimination: treat $r$ as a fast coordinate slaved to $\\theta$ by minimizing $U(r,\\theta)$ with respect to $r$ at fixed $\\theta$, and define an effective potential $U_{\\mathrm{eff}}(\\theta)=\\min_r U(r,\\theta)$.\n\nUsing only the fundamental definitions of generalized forces, holonomic constraints, and the negative gradient relationship between conservative forces and potential energy, reason about how the stretch-bend cross term alters the effective angle energetics under each removal scheme and whether its contribution survives in the reduced description. Which of the following statements are correct? Select all that apply.\n\nA. Under an exact holonomic constraint with $r=r_0$, the stretch-bend cross term produces zero generalized force on the angle and contributes no energy; after removing $r$, the remaining potential for $\\theta$ is purely harmonic with stiffness $k_\\theta$.\n\nB. If the constrained bond length is fixed at a value $r_c \\neq r_0$, the stretch-bend cross term yields a constant torque on the angle, shifting the effective equilibrium angle by $\\Delta\\theta = -\\dfrac{k_{sb}}{k_\\theta}(r_c - r_0)$, while the curvature about the new minimum remains $k_\\theta$.\n\nC. Eliminating the bond length by minimizing the energy with respect to $r$ at fixed $\\theta$ (adiabatic elimination of a fast coordinate) yields an effective angle stiffness $k_\\theta^{\\mathrm{eff}} = k_\\theta - \\dfrac{k_{sb}^2}{k_r}$, demonstrating that the stretch-bend coupling survives as a renormalization even without explicit $r$.\n\nD. With constraints, the stretch-bend coupling always survives and produces the same renormalization of $k_\\theta$ as in adiabatic elimination, regardless of whether $r_c = r_0$.\n\nE. In a Class I force field without any explicit cross terms, applying constraints to bonds to hydrogen reproduces the same renormalization $k_\\theta \\to k_\\theta - \\dfrac{k_{sb}^2}{k_r}$ via Lagrange multipliers.", "solution": "We start from the standard relationship between conservative forces and potential energy in classical mechanics: the generalized force conjugate to a coordinate is the negative partial derivative of the potential with respect to that coordinate. For the angle coordinate, the generalized force is\n$$\nF_\\theta(r,\\theta) \\;=\\; -\\frac{\\partial U}{\\partial \\theta}.\n$$\nWe also use the definition of a holonomic constraint that fixes a coordinate as an identity in time. Under an exact constraint $r=r_c$, the dynamics evolves on the constrained manifold and the effective angle force is computed from $U(r_c,\\theta)$.\n\nConsider the potential\n$$\nU(r,\\theta) \\;=\\; \\tfrac{1}{2} k_r \\,(r - r_0)^2 \\;+\\; \\tfrac{1}{2} k_\\theta \\,(\\theta - \\theta_0)^2 \\;+\\; k_{sb}\\,(r - r_0)\\,(\\theta - \\theta_0).\n$$\nDefine $x = r - r_0$ and $y = \\theta - \\theta_0$ for compactness. Then\n$$\nU(x,y) \\;=\\; \\tfrac{1}{2} k_r x^2 \\;+\\; \\tfrac{1}{2} k_\\theta y^2 \\;+\\; k_{sb}\\,x\\,y,\n$$\nand the angle force is\n$$\nF_\\theta(x,y) \\;=\\; -\\frac{\\partial U}{\\partial \\theta} \\;=\\; -\\frac{\\partial U}{\\partial y} \\;=\\; -\\left(k_\\theta y + k_{sb} x\\right).\n$$\n\nExact holonomic constraint at $r=r_c$:\n- If $r_c = r_0$, then $x = r_c - r_0 = 0$ for all time. The cross term $k_{sb} x y$ vanishes identically in the constrained potential, and the generalized force reduces to\n$$\nF_\\theta \\;=\\; -k_\\theta y.\n$$\nThe constrained potential becomes $U_{\\mathrm{constr}}(\\theta) = \\tfrac{1}{2}k_\\theta y^2$, which is purely harmonic in $\\theta$ with stiffness $k_\\theta$. Thus, the stretch-bend contribution does not survive in energy or forces when the constrained bond is fixed at its reference length.\n\n- If $r_c \\neq r_0$, then $x = r_c - r_0$ is a nonzero constant. The constrained potential is\n$$\nU_{\\mathrm{constr}}(\\theta) \\;=\\; \\tfrac{1}{2} k_r x^2 \\;+\\; \\tfrac{1}{2} k_\\theta y^2 \\;+\\; k_{sb} x y,\n$$\nwhere the $\\tfrac{1}{2} k_r x^2$ term is a constant offset. The generalized angle force along the constrained manifold is\n$$\nF_\\theta \\;=\\; -\\left(k_\\theta y + k_{sb} x\\right).\n$$\nSetting $F_\\theta=0$ gives the minimum at\n$$\ny^\\star \\;=\\; -\\frac{k_{sb}}{k_\\theta}\\,x \\;=\\; -\\frac{k_{sb}}{k_\\theta}\\,(r_c - r_0).\n$$\nThe curvature in $\\theta$ about this minimum is the second derivative $\\frac{\\partial^2 U_{\\mathrm{constr}}}{\\partial \\theta^2} = k_\\theta$, so the stiffness remains $k_\\theta$. Therefore, a non-equilibrium constraint shifts the equilibrium angle linearly by a constant torque from the cross term, but does not change the $\\theta$ curvature.\n\nAdiabatic elimination by minimizing with respect to $r$:\nIn this scheme, we remove $r$ by solving $\\frac{\\partial U}{\\partial r} = 0$ at fixed $\\theta$, which is equivalent to $\\frac{\\partial U}{\\partial x}=0$:\n$$\n\\frac{\\partial U}{\\partial x} \\;=\\; k_r x + k_{sb} y \\;=\\; 0 \\quad \\Rightarrow \\quad x^\\star(y) \\;=\\; -\\frac{k_{sb}}{k_r}\\,y.\n$$\nSubstituting $x^\\star(y)$ into $U(x,y)$ yields an effective potential for $\\theta$:\n\\begin{align*}\nU_{\\mathrm{eff}}(y) \n= \\tfrac{1}{2} k_r \\left(x^\\star\\right)^2 + \\tfrac{1}{2} k_\\theta y^2 + k_{sb}\\,x^\\star\\,y \\\\\n= \\tfrac{1}{2} k_r \\left(\\frac{k_{sb}^2}{k_r^2} y^2\\right) + \\tfrac{1}{2} k_\\theta y^2 - k_{sb}\\left(\\frac{k_{sb}}{k_r} y\\right) y \\\\\n= \\tfrac{1}{2}\\left(\\frac{k_{sb}^2}{k_r}\\right) y^2 + \\tfrac{1}{2} k_\\theta y^2 - \\left(\\frac{k_{sb}^2}{k_r}\\right) y^2 \\\\\n= \\tfrac{1}{2}\\left(k_\\theta - \\frac{k_{sb}^2}{k_r}\\right) y^2.\n\\end{align*}\nThus the cross term survives as a renormalization of the angle stiffness,\n$$\nk_\\theta^{\\mathrm{eff}} \\;=\\; k_\\theta - \\frac{k_{sb}^2}{k_r},\n$$\neven though $r$ has been removed. Note the qualitative difference from exact constraints at $r=r_0$: adiabatic elimination allows $r$ to relax consistently with $\\theta$, and the coupling reduces the effective angle stiffness. In contrast, an exact constraint pins $r$ to a constant independent of $\\theta$; if that constant equals $r_0$, the cross term contributes neither energy nor force on $\\theta$.\n\nFinally, consider the role of force field class. In a Class I force field, the potential is separable and lacks explicit cross terms between $r$ and $\\theta$. Therefore, there is no parameter $k_{sb}$ and no stretch-bend coupling to renormalize. Lagrange multipliers enforcing constraints introduce internal constraint forces to maintain $r=r_c$ but do not create new physical couplings absent from the potential; hence, no renormalization analogous to $k_{sb}^2/k_r$ can appear in a force field without $k_{sb}$.\n\nOption-by-option analysis:\n- A: Correct. With $r=r_0$, $x=0$ identically, so both the cross term $k_{sb} x y$ and its contribution to the angle force $-k_{sb} x$ vanish. The constrained potential in $\\theta$ is purely $\\tfrac{1}{2}k_\\theta y^2$ with stiffness $k_\\theta$.\n\n- B: Correct. With $r_c \\neq r_0$, $x$ is a nonzero constant. The angle force is $-k_\\theta y - k_{sb} x$, which yields the shifted minimum $y^\\star = -(k_{sb}/k_\\theta)x = -(k_{sb}/k_\\theta)(r_c-r_0)$. The curvature in $\\theta$ remains $k_\\theta$.\n\n- C: Correct. Adiabatic elimination gives $x^\\star = -(k_{sb}/k_r) y$ and $U_{\\mathrm{eff}}(\\theta) = \\tfrac{1}{2}(k_\\theta - k_{sb}^2/k_r) y^2$, showing that the coupling survives as a stiffness renormalization.\n\n- D: Incorrect. Under exact constraints with $r=r_0$, the coupling does not survive; there is no renormalization, only a pure harmonic angle term with stiffness $k_\\theta$. The renormalization arises from allowing $r$ to relax consistently with $\\theta$, which constraints prevent.\n\n- E: Incorrect. Class I force fields lack stretch-bend cross terms ($k_{sb}=0$), so there is no mechanism to generate the renormalization $k_\\theta \\to k_\\theta - k_{sb}^2/k_r$. Constraint forces enforced by Lagrange multipliers do not introduce new cross terms absent from the potential.", "answer": "$$\\boxed{ABC}$$", "id": "3400984"}]}