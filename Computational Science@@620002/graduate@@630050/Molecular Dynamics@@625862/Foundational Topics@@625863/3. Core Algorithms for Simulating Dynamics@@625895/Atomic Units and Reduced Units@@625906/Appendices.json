{"hands_on_practices": [{"introduction": "Atomic units provide a natural system for quantum mechanical problems by simplifying the fundamental equations. This exercise begins with the time-independent Schrödinger equation for the hydrogen atom, the cornerstone of quantum chemistry. By systematically non-dimensionalizing this equation, you will derive the expression for the atomic unit of length—the Bohr radius—from first principles and calculate its value using fundamental physical constants [@problem_id:3396447].", "problem": "In molecular dynamics, adopting atomic units and reduced units simplifies equations of motion and quantum-mechanical Hamiltonians by eliminating dimensional parameters. Consider the nonrelativistic hydrogenic electron moving in a Coulomb potential. Starting from the time-independent Schrödinger equation (TISE) for a single electron in the field of a stationary proton,\n$$-\\frac{\\hbar^{2}}{2 m_{e}} \\nabla^{2} \\psi(\\mathbf{r}) - \\frac{e^{2}}{4 \\pi \\epsilon_{0} r} \\psi(\\mathbf{r}) = E \\psi(\\mathbf{r}),$$\nand the Coulomb law with vacuum permittivity $\\epsilon_{0}$, perform a non-dimensionalization by introducing a characteristic length scale $a$ via $r = a r^*$ and requiring that the Hamiltonian takes the standard atomic-units form $-\\frac{1}{2}{\\nabla^*}^2 - \\frac{1}{r^*}$. From first principles, derive the resulting expression for the atomic unit of length, and then compute its value in meters using the following constants from the International System of Units (SI), with values recommended by the Committee on Data for Science and Technology (CODATA):\n$$\\hbar = 1.054571817 \\times 10^{-34} \\,\\text{J s},\\quad m_{e} = 9.1093837015 \\times 10^{-31} \\,\\text{kg},\\quad e = 1.602176634 \\times 10^{-19} \\,\\text{C},\\quad \\epsilon_{0} = 8.8541878128 \\times 10^{-12} \\,\\text{F m}^{-1}.$$\nAs a consistency check, compare your computed value with the accepted Bohr radius\n$$a_{0}^{\\text{(accepted)}} = 5.29177210903 \\times 10^{-11} \\,\\text{m}$$\nand verify that the relative error is less than $10^{-4}$. Express your final numerical answer in meters, and round your final number to ten significant figures. The final answer must be a single real-valued number.", "solution": "The problem statement has been validated and is deemed valid. It is a scientifically grounded, well-posed, and objective problem based on fundamental principles of quantum mechanics. All necessary data are provided, and the task is clearly defined.\n\nThe starting point is the time-independent Schrödinger equation (TISE) for a single electron of mass $m_e$ and charge $-e$ in the Coulomb potential of a stationary proton (charge $+e$):\n$$-\\frac{\\hbar^{2}}{2 m_{e}} \\nabla^{2} \\psi(\\mathbf{r}) - \\frac{e^{2}}{4 \\pi \\epsilon_{0} r} \\psi(\\mathbf{r}) = E \\psi(\\mathbf{r})$$\nHere, $\\mathbf{r}$ is the position vector of the electron, $r = |\\mathbf{r}|$ is its distance from the proton, $\\hbar$ is the reduced Planck constant, and $\\epsilon_{0}$ is the vacuum permittivity. The operator on the left-hand side is the Hamiltonian, $H$.\n\nThe goal is to non-dimensionalize this equation. We introduce a characteristic length scale $a$ and define a dimensionless position vector $\\mathbf{r}^*$ such that $\\mathbf{r} = a\\mathbf{r}^*$. Consequently, the magnitude scales as $r = a r^*$.\n\nWe must transform the differential operator $\\nabla^2$ (the Laplacian) to the new coordinate system. The chain rule for partial derivatives gives:\n$$\\frac{\\partial}{\\partial x_i} = \\frac{\\partial x_i^*}{\\partial x_i} \\frac{\\partial}{\\partial x_i^*} = \\frac{1}{a} \\frac{\\partial}{\\partial x_i^*}$$\nThe second partial derivative becomes:\n$$\\frac{\\partial^2}{\\partial x_i^2} = \\frac{\\partial}{\\partial x_i}\\left(\\frac{1}{a}\\frac{\\partial}{\\partial x_i^*}\\right) = \\frac{1}{a^2} \\frac{\\partial^2}{\\partial x_i^{*2}}$$\nThus, the Laplacian operator transforms as:\n$$\\nabla^2 = \\sum_i \\frac{\\partial^2}{\\partial x_i^2} = \\frac{1}{a^2} \\sum_i \\frac{\\partial^2}{\\partial x_i^{*2}} = \\frac{1}{a^2}{\\nabla^*}^2$$\nwhere ${\\nabla^*}^2$ is the Laplacian with respect to the dimensionless coordinates $\\mathbf{r}^*$.\n\nSubstituting $r = a r^*$ and $\\nabla^2 = \\frac{1}{a^2}{\\nabla^*}^2$ into the TISE, and letting the wavefunction in the new coordinates be $\\psi^*(\\mathbf{r}^*)$:\n$$-\\frac{\\hbar^{2}}{2 m_{e}} \\left(\\frac{1}{a^2}{\\nabla^*}^2\\right) \\psi^*(\\mathbf{r}^*) - \\frac{e^{2}}{4 \\pi \\epsilon_{0} (a r^*)} \\psi^*(\\mathbf{r}^*) = E \\psi^*(\\mathbf{r}^*)$$\nTo simplify, let us multiply the entire equation by the factor $\\frac{2 m_e a^2}{\\hbar^2}$:\n$$-{\\nabla^*}^2 \\psi^*(\\mathbf{r}^*) - \\left(\\frac{e^{2}}{4 \\pi \\epsilon_{0} a r^*}\\right)\\left(\\frac{2 m_e a^2}{\\hbar^2}\\right) \\psi^*(\\mathbf{r}^*) = \\left(\\frac{2 m_e a^2 E}{\\hbar^2}\\right) \\psi^*(\\mathbf{r}^*)$$\nSimplifying the coefficient of the potential energy term:\n$$-{\\nabla^*}^2 \\psi^*(\\mathbf{r}^*) - \\left(\\frac{2 m_e a e^2}{4 \\pi \\epsilon_{0} \\hbar^2}\\right) \\frac{1}{r^*} \\psi^*(\\mathbf{r}^*) = E^* \\psi^*(\\mathbf{r}^*)$$\nwhere $E^* = \\frac{2 m_e a^2 E}{\\hbar^2}$ is the dimensionless energy eigenvalue.\n\nThe problem requires that the Hamiltonian in dimensionless form be $\\tilde{H} = -\\frac{1}{2}{\\nabla^*}^2 - \\frac{1}{r^*}$. To match this form, we divide our transformed equation by $2$:\n$$\\left[-\\frac{1}{2}{\\nabla^*}^2 - \\left(\\frac{m_e a e^2}{4 \\pi \\epsilon_{0} \\hbar^2}\\right) \\frac{1}{r^*}\\right] \\psi^*(\\mathbf{r}^*) = \\frac{E^*}{2} \\psi^*(\\mathbf{r}^*)$$\nBy comparing the operator in the square brackets with the target Hamiltonian $\\tilde{H}$, we see that the kinetic energy term $-\\frac{1}{2}{\\nabla^*}^2$ matches. For the potential energy term to match $-\\frac{1}{r^*}$, the coefficient of the $\\frac{1}{r^*}$ term must be equal to $1$:\n$$\\frac{m_e a e^2}{4 \\pi \\epsilon_{0} \\hbar^2} = 1$$\nSolving this equation for the characteristic length $a$ gives the expression for the atomic unit of length, which is the Bohr radius, often denoted as $a_0$:\n$$a = \\frac{4 \\pi \\epsilon_{0} \\hbar^2}{m_e e^2}$$\nNow, we compute the numerical value of $a$ using the provided CODATA constants:\n$\\hbar = 1.054571817 \\times 10^{-34} \\,\\text{J s}$\n$m_{e} = 9.1093837015 \\times 10^{-31} \\,\\text{kg}$\n$e = 1.602176634 \\times 10^{-19} \\,\\text{C}$\n$\\epsilon_{0} = 8.8541878128 \\times 10^{-12} \\,\\text{F m}^{-1}$\n\nSubstituting these values into the expression for $a$:\n$$a = \\frac{4 \\pi (8.8541878128 \\times 10^{-12}) (1.054571817 \\times 10^{-34})^2}{(9.1093837015 \\times 10^{-31}) (1.602176634 \\times 10^{-19})^2}$$\nNumerically evaluating the expression:\nNumerator:\n$4\\pi \\epsilon_0 \\hbar^2 = 4\\pi (8.8541878128 \\times 10^{-12}) (1.054571817 \\times 10^{-34})^2 \\approx 1.23785642 \\times 10^{-78} \\, \\text{kg m}^3 \\text{C}^2 \\text{s}^{-2}$\nDenominator:\n$m_e e^2 = (9.1093837015 \\times 10^{-31}) (1.602176634 \\times 10^{-19})^2 \\approx 2.33833446 \\times 10^{-68} \\, \\text{kg C}^2$\n$$a = \\frac{1.23785642... \\times 10^{-78}}{2.33833446... \\times 10^{-68}} \\, \\text{m} \\approx 5.29177210903 \\times 10^{-11} \\, \\text{m}$$\nRounding the result to ten significant figures as requested:\n$$a \\approx 5.291772109 \\times 10^{-11} \\, \\text{m}$$\n\nFinally, we perform the consistency check. We compare our calculated value, $a_{\\text{calc}} = 5.29177210903... \\times 10^{-11} \\,\\text{m}$, with the accepted value, $a_{0}^{\\text{(accepted)}} = 5.29177210903 \\times 10^{-11} \\,\\text{m}$.\nThe relative error is calculated as:\n$$\\text{Relative Error} = \\frac{|a_{\\text{calc}} - a_{0}^{\\text{(accepted)}}|}{|a_{0}^{\\text{(accepted)}}|}$$\nSince the values are identical to the twelfth significant figure (the precision of the given accepted value), the numerator is effectively zero.\n$$\\text{Relative Error} \\approx \\frac{|5.29177210903 \\times 10^{-11} - 5.29177210903 \\times 10^{-11}|}{|5.29177210903 \\times 10^{-11}|} = 0$$\nThe relative error of $0$ is less than the required tolerance of $10^{-4}$. The consistency check is passed. The final answer is the computed value rounded to ten significant figures.", "answer": "$$\\boxed{5.291772109 \\times 10^{-11}}$$", "id": "3396447"}, {"introduction": "While atomic units are rooted in quantum mechanics, many classical molecular dynamics simulations employ a different convention: Lennard-Jones (LJ) reduced units. This system scales quantities by the parameters of the interaction potential itself ($\\sigma, \\epsilon$) and a reference mass ($m_0$). This practice focuses on the crucial task of translating between the dimensionless world of an MD simulation and the physical world, asking you to convert a reduced timestep into femtoseconds and, importantly, to justify its stability by comparing it to the fastest physical motion in the system [@problem_id:3396424].", "problem": "A coarse-grained diatomic molecule is simulated using molecular dynamics (MD) in a reduced unit system based on the Lennard-Jones (LJ) potential. The reduced timestep is $ \\Delta t^{\\ast} = 0.00450 $. The LJ parameters for the interaction site that defines the reduced units are: characteristic length $ \\sigma = 3.405\\,\\mathrm{\\AA} $, characteristic energy $ \\epsilon $ such that $ \\epsilon/k_B = 119.8\\,\\mathrm{K} $, and reference mass $ m_0 = 39.948\\,\\mathrm{u} $, where $ k_B $ is the Boltzmann constant and $ \\mathrm{u} $ is the atomic mass unit. The diatomic bond is modeled as a harmonic spring with stiffness $ k_b = 100\\,\\mathrm{N\\,m^{-1}} $, and both atoms have mass $ m_0 $.\n\nUsing first principles of nondimensionalization and Newtonian dynamics, convert the reduced timestep $ \\Delta t^{\\ast} $ to a physical timestep in femtoseconds, and justify whether this choice is stable by comparing it to the highest vibrational frequency in the model arising from the harmonic bond. Use the following constants: $ k_B = 1.380649 \\times 10^{-23}\\,\\mathrm{J\\,K^{-1}} $ and $ 1\\,\\mathrm{u} = 1.66053906660 \\times 10^{-27}\\,\\mathrm{kg} $. Express the final timestep in femtoseconds and round your answer to four significant figures.", "solution": "The problem requires the conversion of a reduced timestep from a molecular dynamics (MD) simulation into a physical timestep in femtoseconds. It also requires an analysis of the stability of this timestep by comparing it to the period of the fastest motion in the system, which arises from a harmonic bond.\n\nFirst, we determine the physical time unit corresponding to the reduced unit system. In a Lennard-Jones (LJ) system, reduced units are defined by a characteristic mass $m_0$, a characteristic length $\\sigma$, and a characteristic energy $\\epsilon$. The characteristic time, $\\tau$, can be derived by dimensional analysis. Time, $[T]$, can be constructed from mass $[M]$, length $[L]$, and energy $[E] = [M][L]^2[T]^{-2}$.\nThe combination $\\sigma \\sqrt{m_0/\\epsilon}$ has dimensions of time:\n$$ [L] \\sqrt{\\frac{[M]}{[M][L]^2[T]^{-2}}} = [L] \\sqrt{\\frac{[T]^2}{[L]^2}} = [L] \\frac{[T]}{[L]} = [T] $$\nThus, the characteristic time unit is given by the formula:\n$$ \\tau = \\sigma \\sqrt{\\frac{m_0}{\\epsilon}} $$\nThe physical timestep, $\\Delta t$, is related to the reduced timestep, $\\Delta t^{\\ast}$, by $\\Delta t = \\Delta t^{\\ast} \\tau$.\n\nWe are given the following values:\nCharacteristic length, $\\sigma = 3.405\\,\\mathrm{\\AA} = 3.405 \\times 10^{-10}\\,\\mathrm{m}$.\nReference mass, $m_0 = 39.948\\,\\mathrm{u}$. Using the conversion $1\\,\\mathrm{u} = 1.66053906660 \\times 10^{-27}\\,\\mathrm{kg}$, we get:\n$$ m_0 = 39.948 \\times (1.66053906660 \\times 10^{-27}\\,\\mathrm{kg}) \\approx 6.63352 \\times 10^{-26}\\,\\mathrm{kg} $$\nCharacteristic energy, $\\epsilon$, is given via $\\epsilon/k_B = 119.8\\,\\mathrm{K}$. Using the Boltzmann constant $k_B = 1.380649 \\times 10^{-23}\\,\\mathrm{J\\,K^{-1}}$:\n$$ \\epsilon = 119.8\\,\\mathrm{K} \\times (1.380649 \\times 10^{-23}\\,\\mathrm{J\\,K^{-1}}) \\approx 1.65402 \\times 10^{-21}\\,\\mathrm{J} $$\nNow we can calculate the characteristic time $\\tau$:\n$$ \\tau = (3.405 \\times 10^{-10}\\,\\mathrm{m}) \\sqrt{\\frac{6.63352 \\times 10^{-26}\\,\\mathrm{kg}}{1.65402 \\times 10^{-21}\\,\\mathrm{J}}} $$\n$$ \\tau \\approx (3.405 \\times 10^{-10}\\,\\mathrm{m}) \\sqrt{4.01053 \\times 10^{-5}\\,\\mathrm{s^2\\,m^{-2}}} $$\n$$ \\tau \\approx (3.405 \\times 10^{-10}\\,\\mathrm{m}) \\times (6.33288 \\times 10^{-3}\\,\\mathrm{s\\,m^{-1}}) $$\n$$ \\tau \\approx 2.15634 \\times 10^{-12}\\,\\mathrm{s} $$\nThe given reduced timestep is $\\Delta t^{\\ast} = 0.00450$. The physical timestep $\\Delta t$ is:\n$$ \\Delta t = \\Delta t^{\\ast} \\tau = 0.00450 \\times (2.15634 \\times 10^{-12}\\,\\mathrm{s}) \\approx 9.70353 \\times 10^{-15}\\,\\mathrm{s} $$\nSince $1\\,\\mathrm{fs} = 10^{-15}\\,\\mathrm{s}$, the timestep is $\\Delta t \\approx 9.70353\\,\\mathrm{fs}$.\nRounding to four significant figures, we get:\n$$ \\Delta t = 9.704\\,\\mathrm{fs} $$\n\nNext, we justify the stability of this timestep. The stability of numerical integration in MD is limited by the highest frequency of motion in the system. For stable integration using algorithms like the Verlet integrator, the timestep $\\Delta t$ should be significantly smaller than the period $T$ of the fastest oscillation. A common rule of thumb is $\\Delta t \\le T/10$.\n\nThe fastest motion in this model is the vibration of the harmonic bond connecting the two atoms. This is a classical two-body harmonic oscillator problem. The angular frequency of oscillation, $\\omega$, is given by:\n$$ \\omega = \\sqrt{\\frac{k_b}{\\mu}} $$\nwhere $k_b$ is the spring stiffness and $\\mu$ is the reduced mass of the system. The atoms have identical mass $m_0$, so the reduced mass is:\n$$ \\mu = \\frac{m_0 \\times m_0}{m_0 + m_0} = \\frac{m_0^2}{2m_0} = \\frac{m_0}{2} $$\nUsing the value for $m_0$ calculated earlier:\n$$ \\mu = \\frac{6.63352 \\times 10^{-26}\\,\\mathrm{kg}}{2} = 3.31676 \\times 10^{-26}\\,\\mathrm{kg} $$\nGiven the spring stiffness $k_b = 100\\,\\mathrm{N\\,m^{-1}} = 100\\,\\mathrm{kg\\,s^{-2}}$, we can calculate the angular frequency:\n$$ \\omega = \\sqrt{\\frac{100\\,\\mathrm{kg\\,s^{-2}}}{3.31676 \\times 10^{-26}\\,\\mathrm{kg}}} \\approx \\sqrt{3.01497 \\times 10^{27}\\,\\mathrm{s^{-2}}} \\approx 5.49088 \\times 10^{13}\\,\\mathrm{rad\\,s^{-1}} $$\nThe period of this oscillation, $T$, is related to the angular frequency by $T = 2\\pi/\\omega$:\n$$ T = \\frac{2\\pi}{5.49088 \\times 10^{13}\\,\\mathrm{rad\\,s^{-1}}} \\approx 1.14429 \\times 10^{-13}\\,\\mathrm{s} $$\nConverting the period to femtoseconds:\n$$ T \\approx 114.4\\,\\mathrm{fs} $$\nTo assess stability, we compare our timestep $\\Delta t = 9.704\\,\\mathrm{fs}$ to the vibrational period $T = 114.4\\,\\mathrm{fs}$. The ratio is:\n$$ \\frac{T}{\\Delta t} = \\frac{114.4\\,\\mathrm{fs}}{9.704\\,\\mathrm{fs}} \\approx 11.8 $$\nThis means there are approximately $12$ integration steps per period of the fastest oscillation. The stability criterion $\\Delta t \\le T/10$ is met, as $9.704\\,\\mathrm{fs} \\le (114.4/10)\\,\\mathrm{fs} = 11.44\\,\\mathrm{fs}$. Therefore, the chosen timestep of $\\Delta t^{\\ast} = 0.00450$ in reduced units, corresponding to $9.704\\,\\mathrm{fs}$, is a reasonable and stable choice for this simulation, although for high-precision simulations requiring excellent energy conservation, a slightly smaller timestep (e.g., providing $15-20$ steps per period) might be preferable.", "answer": "$$\\boxed{9.704}$$", "id": "3396424"}, {"introduction": "A robust simulation code must produce physically consistent results regardless of the internal unit system used. This final practice is a comprehensive verification exercise designed to prove the equivalence between calculations in SI units and LJ-based reduced units. You will implement the computation of forces, energies, and virials—including contributions from Coulombic interactions and long-range corrections—in both unit systems, demonstrating numerically that they are identical after conversion, a critical skill for developing and validating MD software [@problem_id:3396468].", "problem": "You are asked to construct a self-contained verification program that demonstrates the consistency of forces, energies, and virials between two computational molecular dynamics conventions: one using reduced units with Boltzmann constant equal to one ($k_B = 1$) and one using Standard International (SI) units. The physical model consists of particles interacting via pairwise Lennard–Jones (LJ) potentials and Coulombic interactions, with the LJ potential truncated at a finite cutoff and supplemented by a uniform-density long-range correction (LRC) for both energy and virial. Coulombic interactions are computed directly without a cutoff or Ewald summation. Your program must compute the total pairwise forces, total potential energy, and scalar virial in both unit systems for the same microscopic configurations, convert the reduced-unit results to SI using the derived base units, and verify that the converted reduced-unit results agree numerically with the directly computed SI results.\n\nFundamental base for the derivation must start from the following:\n- Newton’s Second Law and the definition of force as minus the gradient of potential: for a pair potential $u(r)$, the radial force magnitude is $f(r) = -\\frac{du}{dr}$, and the vector force is $\\mathbf{F} = f(r)\\,\\hat{\\mathbf{r}}$ with $\\hat{\\mathbf{r}} = \\mathbf{r}/r$ and $\\mathbf{r} = \\mathbf{r}_i - \\mathbf{r}_j$.\n- The Lennard–Jones potential $u_{\\mathrm{LJ}}(r) = 4\\epsilon\\left[\\left(\\frac{\\sigma}{r}\\right)^{12} - \\left(\\frac{\\sigma}{r}\\right)^6\\right]$ and Coulomb potential $u_{\\mathrm{C}}(r) = \\frac{1}{4\\pi\\epsilon_0}\\frac{q_i q_j}{r}$, where $\\epsilon$ is the energy scale, $\\sigma$ is the length scale, $\\epsilon_0$ is the vacuum permittivity, and $q_i$ are particle charges.\n- The scalar virial for pairwise interactions $W = \\sum_{i<j} \\mathbf{r}_{ij}\\cdot\\mathbf{F}_{ij}$, and its relationship to pressure in a volume $V$, $P = \\frac{N k_B T}{V} + \\frac{1}{3V}W$, is noted but the ideal-gas term is not included in this verification since only interaction contributions are compared.\n\nThe reduced-unit convention uses $\\epsilon$ and $\\sigma$ as base energy and length units, with $k_B = 1$ implying temperatures in reduced units $T^* = T/(\\epsilon/k_B)$ and energy unit $E_0 = \\epsilon$. The force unit is $F_0 = \\epsilon/\\sigma$, and the virial unit is $W_0 = \\epsilon$. For Coulombic interactions, define a dimensionless charge $\\hat{q} = q/\\sqrt{4\\pi\\epsilon_0 \\epsilon \\sigma}$ so that the reduced Coulomb potential and force take simple forms. The LJ long-range corrections beyond a cutoff $r_c$ under the uniform-density approximation ($g(r)=1$) must be incorporated into the total energy and virial:\n- Energy LRC per particle: $\\Delta U_{\\mathrm{LJ}}/N = \\frac{8\\pi}{3}\\rho\\,\\epsilon\\,\\sigma^3\\left[\\frac{1}{3}\\left(\\frac{\\sigma}{r_c}\\right)^9 - \\left(\\frac{\\sigma}{r_c}\\right)^3\\right]$.\n- Pressure LRC: $\\Delta P_{\\mathrm{LJ}} = \\frac{16\\pi}{3}\\rho^2\\,\\epsilon\\,\\sigma^3\\left[\\frac{2}{3}\\left(\\frac{\\sigma}{r_c}\\right)^9 - \\left(\\frac{\\sigma}{r_c}\\right)^3\\right]$.\n- Virial LRC: $\\Delta W_{\\mathrm{LJ}} = 3 V\\,\\Delta P_{\\mathrm{LJ}}$.\n\nYou must implement the following algorithmic requirements:\n1. For each test case, compute pairwise LJ contributions only for pairs with $r < r_c$ and Coulombic contributions for all pairs without cutoff. Sum total force vectors on each particle, total potential energy, and scalar virial $W$.\n2. Add the LJ long-range correction (LRC) for both total energy and scalar virial using the given density $\\rho = N/V$ and $V = L^3$.\n3. Compute these quantities in reduced units (using $\\sigma$ and $\\epsilon$ as base units and $k_B=1$) and then convert them to SI: energies $\\times \\epsilon$, forces $\\times \\epsilon/\\sigma$, virials $\\times \\epsilon$.\n4. Compute these quantities directly in SI using the given SI parameters and constants.\n5. Compare the converted reduced-unit results against the direct SI results by reporting, for each test case, whether the maximum absolute component-wise force discrepancy, the absolute energy discrepancy, and the absolute virial discrepancy are each strictly less than specified tolerances.\n\nPhysical constants to use in SI:\n- Vacuum permittivity $\\epsilon_0 = 8.8541878128\\times 10^{-12}\\ \\mathrm{F/m}$.\n- Coulomb’s constant $k_e = \\frac{1}{4\\pi\\epsilon_0}$.\n- Boltzmann constant $k_B = 1.380649\\times 10^{-23}\\ \\mathrm{J/K}$.\n- Elementary charge $e = 1.602176634\\times 10^{-19}\\ \\mathrm{C}$.\n\nTolerances:\n- Force comparison tolerance $\\tau_F = 10^{-12}\\ \\mathrm{N}$ (component-wise maximum absolute difference).\n- Energy comparison tolerance $\\tau_U = 10^{-21}\\ \\mathrm{J}$ (absolute difference).\n- Virial comparison tolerance $\\tau_W = 10^{-21}\\ \\mathrm{J}$ (absolute difference).\n\nYour program must implement and test the following test suite of configurations. All positions are given in meters, box side length $L$ in meters, the LJ cutoff $r_c$ is specified as a multiple of $\\sigma$ but must be applied in meters, and the LJ energy scale is specified via a temperature using $k_B T_\\epsilon$ so that $\\epsilon = k_B T_\\epsilon$.\n\nTest case 1 (general case):\n- Number of particles $N=3$.\n- LJ parameters: $\\sigma = 0.34\\times 10^{-9}\\ \\mathrm{m}$, $T_\\epsilon = 120\\ \\mathrm{K}$ so $\\epsilon = k_B T_\\epsilon$.\n- Cutoff: $r_c = 2.5\\,\\sigma$.\n- Box side length: $L = 6\\,\\sigma$.\n- Positions: $\\mathbf{r}_1 = (0,0,0)$, $\\mathbf{r}_2 = (0.9\\,\\sigma,0,0)$, $\\mathbf{r}_3 = (1.8\\,\\sigma,0.9\\,\\sigma,0)$.\n- Charges: $q_1 = +e$, $q_2 = -e$, $q_3 = +0.5\\,e$.\n\nTest case 2 (boundary cutoff case):\n- Number of particles $N=3$.\n- LJ parameters: $\\sigma = 0.34\\times 10^{-9}\\ \\mathrm{m}$, $T_\\epsilon = 300\\ \\mathrm{K}$ so $\\epsilon = k_B T_\\epsilon$.\n- Cutoff: $r_c = 2.0\\,\\sigma$.\n- Box side length: $L = 5\\,\\sigma$.\n- Positions: $\\mathbf{r}_1 = (0,0,0)$, $\\mathbf{r}_2 = (2.0\\,\\sigma,0,0)$, $\\mathbf{r}_3 = (0.9\\,\\sigma,0,1.0\\,\\sigma)$.\n- Charges: $q_1 = +0.5\\,e$, $q_2 = -0.5\\,e$, $q_3 = +e$.\n\nTest case 3 (high-density case):\n- Number of particles $N=4$.\n- LJ parameters: $\\sigma = 0.34\\times 10^{-9}\\ \\mathrm{m}$, $T_\\epsilon = 90\\ \\mathrm{K}$ so $\\epsilon = k_B T_\\epsilon$.\n- Cutoff: $r_c = 3.0\\,\\sigma$.\n- Box side length: $L = 3\\,\\sigma$.\n- Positions: $\\mathbf{r}_1 = (0,0,0)$, $\\mathbf{r}_2 = (1.1\\,\\sigma,0,0)$, $\\mathbf{r}_3 = (0,1.1\\,\\sigma,0)$, $\\mathbf{r}_4 = (1.1\\,\\sigma,1.1\\,\\sigma,0)$.\n- Charges: $q_1 = +e$, $q_2 = +e$, $q_3 = -e$, $q_4 = -0.5\\,e$.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. For each test case, output three booleans corresponding to force agreement, energy agreement, and virial agreement (in that order). The final output must therefore contain nine booleans in the order of test cases 1 through 3. For example: \"[True,True,True,False,True,True,True,True,False]\".", "solution": "The problem requires the construction of a verification program to demonstrate the numerical equivalence between molecular dynamics calculations performed in Standard International (SI) units and a system of reduced units. The verification must cover total potential energy, total pairwise force vectors, and the total scalar virial for a system of particles interacting via truncated Lennard-Jones (LJ) and full-range Coulomb potentials. The solution involves deriving the forms of physical quantities in reduced units and implementing parallel calculations in both systems to compare the results.\n\nFirst, we establish the theoretical foundation for the two unit systems.\n\n**1. Unit Systems and Conversion Factors**\n\nThe problem defines a reduced unit system based on the characteristic energy $\\epsilon$ and length $\\sigma$ of the Lennard-Jones potential. All physical quantities can be expressed as a product of a dimensionless number (its value in reduced units) and a combination of base units. Let starred quantities ($Q^*$) denote values in reduced units and unstarred quantities ($Q$) denote values in SI units.\n\n-   **Length**: The base unit is $\\sigma$. A distance $r$ is expressed as $r = r^* \\sigma$.\n-   **Energy**: The base unit is $\\epsilon$. An energy $U$ is expressed as $U = U^* \\epsilon$.\n-   **Force**: From the relation $F = -dU/dr$, the force unit $F_0$ is derived: $F_0 = \\epsilon/\\sigma$. A force $F$ is expressed as $F = F^* (\\epsilon/\\sigma)$.\n-   **Virial**: The scalar virial $W = \\sum \\mathbf{r}_{ij} \\cdot \\mathbf{F}_{ij}$ has units of length times force, which is $(\\sigma) \\times (\\epsilon/\\sigma) = \\epsilon$. Thus, the virial unit is $\\epsilon$, and $W = W^* \\epsilon$.\n-   **Volume and Density**: Volume scales as length cubed, $V = V^* \\sigma^3$. Number density $\\rho = N/V$ scales as $\\rho = (N/V^*) \\sigma^{-3} = \\rho^* \\sigma^{-3}$.\n-   **Charge**: To simplify the Coulomb potential in reduced units, a dimensionless charge $\\hat{q}$ is defined as $\\hat{q} = q/\\sqrt{4\\pi\\epsilon_0\\epsilon\\sigma}$, where $\\epsilon_0$ is the vacuum permittivity. Thus, an SI charge $q$ is related to its dimensionless counterpart by $q = \\hat{q} \\sqrt{4\\pi\\epsilon_0\\epsilon\\sigma}$.\n\n**2. Potentials and Forces in Reduced Units**\n\nUsing the conversion factors, we can re-express the potential energy and force equations.\n\n-   **Lennard-Jones Interaction**:\n    The SI potential is $u_{\\mathrm{LJ}}(r) = 4\\epsilon\\left[\\left(\\frac{\\sigma}{r}\\right)^{12} - \\left(\\frac{\\sigma}{r}\\right)^6\\right]$.\n    Substituting $r = r^*\\sigma$ and expressing the potential in units of $\\epsilon$:\n    $u^*_{\\mathrm{LJ}}(r^*) = \\frac{u_{\\mathrm{LJ}}(r^*\\sigma)}{\\epsilon} = \\frac{1}{\\epsilon} \\left( 4\\epsilon\\left[\\left(\\frac{\\sigma}{r^*\\sigma}\\right)^{12} - \\left(\\frac{\\sigma}{r^*\\sigma}\\right)^6\\right] \\right) = 4\\left[(r^*)^{-12} - (r^*)^{-6}\\right]$.\n\n    The magnitude of the force in SI units is $f_{\\mathrm{LJ}}(r) = -\\frac{du_{\\mathrm{LJ}}}{dr} = \\frac{24\\epsilon}{r}\\left[2\\left(\\frac{\\sigma}{r}\\right)^{12} - \\left(\\frac{\\sigma}{r}\\right)^6\\right]$.\n    Converting to reduced units:\n    $f^*_{\\mathrm{LJ}}(r^*) = \\frac{f_{\\mathrm{LJ}}(r^*\\sigma)}{\\epsilon/\\sigma} = \\frac{\\sigma}{\\epsilon} \\left( \\frac{24\\epsilon}{r^*\\sigma}\\left[2\\left(\\frac{\\sigma}{r^*\\sigma}\\right)^{12} - \\left(\\frac{\\sigma}{r^*\\sigma}\\right)^6\\right] \\right) = \\frac{24}{r^*}\\left[2(r^*)^{-12} - (r^*)^{-6}\\right]$.\n\n-   **Coulombic Interaction**:\n    The SI potential is $u_{\\mathrm{C}}(r) = \\frac{1}{4\\pi\\epsilon_0}\\frac{q_i q_j}{r}$.\n    Substituting $r = r^*\\sigma$ and $q = \\hat{q}\\sqrt{4\\pi\\epsilon_0\\epsilon\\sigma}$:\n    $u_{\\mathrm{C}}(r^*\\sigma) = \\frac{1}{4\\pi\\epsilon_0} \\frac{(\\hat{q}_i\\sqrt{4\\pi\\epsilon_0\\epsilon\\sigma})(\\hat{q}_j\\sqrt{4\\pi\\epsilon_0\\epsilon\\sigma})}{r^*\\sigma} = \\frac{4\\pi\\epsilon_0\\epsilon\\sigma}{4\\pi\\epsilon_0\\sigma} \\frac{\\hat{q}_i\\hat{q}_j}{r^*} = \\epsilon \\frac{\\hat{q}_i\\hat{q}_j}{r^*}$.\n    The reduced potential is therefore $u^*_{\\mathrm{C}}(r^*) = \\frac{u_{\\mathrm{C}}(r^*\\sigma)}{\\epsilon} = \\frac{\\hat{q}_i\\hat{q}_j}{r^*}$.\n\n    The force magnitude in SI units is $f_{\\mathrm{C}}(r) = -\\frac{du_{\\mathrm{C}}}{dr} = \\frac{1}{4\\pi\\epsilon_0}\\frac{q_i q_j}{r^2}$.\n    Converting to reduced units:\n    $f^*_{\\mathrm{C}}(r^*) = \\frac{f_{\\mathrm{C}}(r^*\\sigma)}{\\epsilon/\\sigma} = \\frac{\\sigma}{\\epsilon} \\left( \\frac{1}{4\\pi\\epsilon_0}\\frac{q_i q_j}{(r^*\\sigma)^2} \\right) = \\frac{\\sigma}{\\epsilon} \\frac{\\epsilon}{\\sigma} \\frac{\\hat{q}_i\\hat{q}_j}{(r^*)^2} = \\frac{\\hat{q}_i\\hat{q}_j}{(r^*)^2}$.\n\n**3. Virial and Long-Range Corrections in Reduced Units**\n\n-   **Pairwise Virial**: The virial contribution from a pair interaction is $w_{ij} = \\mathbf{r}_{ij} \\cdot \\mathbf{F}_{ij}$. In terms of the radial force magnitude, this is $w_{ij} = r_{ij} f_{ij}(r_{ij})$.\n    -   For LJ: $w_{\\mathrm{LJ}}(r_{ij}) = r_{ij} f_{\\mathrm{LJ}}(r_{ij}) = 24\\epsilon\\left[2\\left(\\frac{\\sigma}{r_{ij}}\\right)^{12} - \\left(\\frac{\\sigma}{r_{ij}}\\right)^6\\right]$. The reduced form is $w^*_{\\mathrm{LJ}}(r^*_{ij}) = 24\\left[2(r^*_{ij})^{-12} - (r^*_{ij})^{-6}\\right]$.\n    -   For Coulomb: $w_{\\mathrm{C}}(r_{ij}) = r_{ij} f_{\\mathrm{C}}(r_{ij}) = \\frac{1}{4\\pi\\epsilon_0}\\frac{q_i q_j}{r_{ij}} = u_{\\mathrm{C}}(r_{ij})$. The reduced form is $w^*_{\\mathrm{C}}(r^*_{ij}) = \\frac{\\hat{q}_i\\hat{q}_j}{r^*_{ij}} = u^*_{\\mathrm{C}}(r^*_{ij})$.\n\n-   **Long-Range Corrections (LRC)**: These are added to account for interactions beyond the LJ cutoff $r_c$.\n    -   Energy LRC (SI): $\\Delta U_{\\mathrm{LJ}} = N \\frac{8\\pi}{3}\\rho\\epsilon\\sigma^3\\left[\\frac{1}{3}\\left(\\frac{\\sigma}{r_c}\\right)^9 - \\left(\\frac{\\sigma}{r_c}\\right)^3\\right]$.\n    In reduced units, using $\\rho = \\rho^*/\\sigma^3$, $r_c = r_c^*\\sigma$, and dividing by $\\epsilon$:\n    $\\Delta U^*_{\\mathrm{LJ}} = N \\frac{8\\pi}{3}\\rho^*\\left[\\frac{1}{3}(r_c^*)^{-9} - (r_c^*)^{-3}\\right]$.\n\n    -   Virial LRC (SI): $\\Delta W_{\\mathrm{LJ}} = 3V \\Delta P_{\\mathrm{LJ}} = 3V \\frac{16\\pi}{3}\\rho^2\\epsilon\\sigma^3\\left[\\frac{2}{3}\\left(\\frac{\\sigma}{r_c}\\right)^9 - \\left(\\frac{\\sigma}{r_c}\\right)^3\\right] = N \\cdot 16\\pi\\rho\\epsilon\\sigma^3\\left[\\frac{2}{3}\\left(\\frac{\\sigma}{r_c}\\right)^9 - \\left(\\frac{\\sigma}{r_c}\\right)^3\\right]$.\n    In reduced units, this becomes:\n    $\\Delta W^*_{\\mathrm{LJ}} = N \\cdot 16\\pi\\rho^*\\left[\\frac{2}{3}(r_c^*)^{-9} - (r_c^*)^{-3}\\right]$.\n\n**4. Algorithmic Design for Verification**\n\nThe program implements two main computational functions: `calculate_si` and `calculate_ru`. Both functions take the same input parameters describing the system's state.\n\n-   `calculate_si` operates directly with SI units. It loops through all unique pairs of particles $(i, j)$. For each pair, it computes the distance $r_{ij}$. If $r_{ij} < r_c$, it calculates the LJ potential, force, and virial contribution and adds them to the totals. It then calculates the Coulomb potential, force, and virial contribution for the pair (without a cutoff) and adds them to the totals. After iterating through all pairs, it calculates the SI-based LJ long-range corrections for energy and virial and adds them to the respective sums. The function returns the total force array, total potential energy, and total scalar virial in SI units.\n\n-   `calculate_ru` first converts the input SI parameters into their reduced unit counterparts. It determines $r^*=r/\\sigma$, $r_c^*=r_c/\\sigma$, $\\rho^*=\\rho\\sigma^3$, and the dimensionless charges $\\hat{q}$. It then performs the same pairwise loop as `calculate_si` but uses the simplified reduced-unit formulas derived above. The loop computes the total reduced energy $U^*$, forces $\\mathbf{F}^*$, and virial $W^*$. It then calculates the reduced LRCs, $\\Delta U^*_{\\mathrm{LJ}}$ and $\\Delta W^*_{\\mathrm{LJ}}$, and adds them to the totals. Finally, it converts these total reduced unit quantities back to SI units using the conversion factors: $U = U^* \\epsilon$, $\\mathbf{F} = \\mathbf{F}^* (\\epsilon/\\sigma)$, and $W = W^* \\epsilon$.\n\nThe main verification routine calls both functions for each test case. It then compares the results:\n1.  The maximum absolute difference between any component of the force vectors is checked against the force tolerance $\\tau_F$.\n2.  The absolute difference between the total energies is checked against the energy tolerance $\\tau_U$.\n3.  The absolute difference between the total virials is checked against the virial tolerance $\\tau_W$.\n\nThe outcomes of these three comparisons (as booleans) are recorded for each test case. The final output is a flattened list of these boolean results. The careful implementation of these two parallel calculation paths provides a robust verification of the consistency between the unit systems.", "answer": "[True,True,True,True,True,True,True,True,True]", "id": "3396468"}]}