{"hands_on_practices": [{"introduction": "The parameters in empirical potentials are not merely abstract constants; they are deeply connected to measurable physical properties. This exercise provides a foundational link between the mathematical form of the Lennard-Jones potential and a real-world spectroscopic quantity. By analyzing the potential well's curvature at the equilibrium separation, you will derive the harmonic vibrational frequency of a diatomic molecule, solidifying your intuition for how potential energy landscapes govern molecular dynamics. [@problem_id:3420796]", "problem": "Consider a diatomic molecule whose interaction is modeled by the Lennard-Jones (LJ) potential, defined as $U_{\\mathrm{LJ}}(r) = 4 \\epsilon \\left[ \\left( \\frac{\\sigma}{r} \\right)^{12} - \\left( \\frac{\\sigma}{r} \\right)^{6} \\right]$, where $\\epsilon$ is a characteristic energy scale and $\\sigma$ is a characteristic length scale. The equilibrium separation $r_{e}$ is the value of $r$ that minimizes $U_{\\mathrm{LJ}}(r)$. Starting from Newton’s second law for the relative coordinate and the Taylor expansion of the potential about the minimum, determine the curvature $U''(r_{e})$ of the LJ potential at the minimum and use it to obtain the harmonic vibrational angular frequency $\\omega$ of the diatomic in terms of the reduced mass $\\mu$, $\\epsilon$, and $\\sigma$. Clearly state any approximations required to connect the curvature to the vibrational frequency. Provide the final answer as a single closed-form analytic expression for $\\omega$ in terms of $\\epsilon$, $\\sigma$, and $\\mu$ only; do not evaluate any numerical values. No units need be reported for the final expression, and no rounding is required.", "solution": "The problem will first be validated against the required criteria.\n\n### Step 1: Extract Givens\n- **Potential Energy Function**: The Lennard-Jones (LJ) potential, $U_{\\mathrm{LJ}}(r) = 4 \\epsilon \\left[ \\left( \\frac{\\sigma}{r} \\right)^{12} - \\left( \\frac{\\sigma}{r} \\right)^{6} \\right]$.\n- **Parameters**: $\\epsilon$ is a characteristic energy scale; $\\sigma$ is a characteristic length scale.\n- **Definition**: The equilibrium separation $r_{e}$ is the value of $r$ that minimizes $U_{\\mathrm{LJ}}(r)$.\n- **Objective 1**: Determine the curvature $U''(r_{e})$ of the LJ potential at the minimum.\n- **Objective 2**: Use the curvature to obtain the harmonic vibrational angular frequency $\\omega$ of the diatomic molecule.\n- **Required Variables**: The final expression for $\\omega$ must be in terms of the reduced mass $\\mu$, $\\epsilon$, and $\\sigma$.\n- **Methodology Hint**: Start from Newton’s second law for the relative coordinate and the Taylor expansion of the potential about the minimum.\n- **Approximation**: Clearly state any approximations required.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientifically Grounded**: The problem is based on the Lennard-Jones potential, a standard and fundamental model in molecular physics and condensed matter physics. The concepts of potential minima, harmonic approximation, and vibrational frequency are core principles of classical mechanics and quantum mechanics. The problem is scientifically sound.\n- **Well-Posed**: The problem provides a well-defined potential function and asks for derivable physical quantities. The steps to the solution are logically structured, and a unique answer is expected.\n- **Objective**: The problem is stated using precise, standard scientific terminology and mathematical expressions, free from any subjectivity or ambiguity.\n- **Flaw Analysis**: The problem does not violate any of the invalidity criteria. It is not scientifically unsound, is formalizable, is complete, is physically realistic within its modeling context, is well-posed, is a non-trivial standard problem, and is scientifically verifiable.\n\n### Step 3: Verdict and Action\nThe problem is **valid**. A full solution will be provided.\n\n### Solution Derivation\nThe solution proceeds in three main steps: 1. finding the equilibrium separation $r_e$; 2. calculating the curvature of the potential at this separation, $U''(r_e)$; and 3. relating this curvature to the vibrational angular frequency $\\omega$ using the harmonic approximation.\n\n**1. Equilibrium Separation ($r_e$)**\nThe equilibrium separation $r_e$ corresponds to the minimum of the potential energy function $U_{\\mathrm{LJ}}(r)$. To find this minimum, we compute the first derivative of $U_{\\mathrm{LJ}}(r)$ with respect to $r$ and set it to zero.\n\nThe potential is given by:\n$$U_{\\mathrm{LJ}}(r) = 4 \\epsilon \\left[ \\left( \\frac{\\sigma}{r} \\right)^{12} - \\left( \\frac{\\sigma}{r} \\right)^{6} \\right] = 4\\epsilon ( \\sigma^{12}r^{-12} - \\sigma^6 r^{-6} )$$\n\nThe first derivative is:\n$$\\frac{d U_{\\mathrm{LJ}}}{dr} = 4\\epsilon ( -12\\sigma^{12}r^{-13} - (-6)\\sigma^6 r^{-7} ) = 4\\epsilon ( -12\\sigma^{12}r^{-13} + 6\\sigma^6 r^{-7} )$$\n\nSetting the derivative to zero at $r=r_e$:\n$$4\\epsilon ( -12\\sigma^{12}r_e^{-13} + 6\\sigma^6 r_e^{-7} ) = 0$$\nSince $\\epsilon \\neq 0$, we have:\n$$12\\sigma^{12}r_e^{-13} = 6\\sigma^6 r_e^{-7}$$\nDividing both sides by $6\\sigma^6 r_e^{-13}$ (since $r_e \\neq 0$):\n$$2\\sigma^6 = r_e^6$$\nSolving for $r_e$:\n$$r_e = 2^{1/6}\\sigma$$\n\n**2. Curvature at Equilibrium ($U''(r_e)$)**\nThe curvature of the potential is its second derivative, $U''(r)$. We first find the general expression for $U''(r)$ by differentiating $\\frac{dU_{\\mathrm{LJ}}}{dr}$:\n$$U''(r) = \\frac{d^2 U_{\\mathrm{LJ}}}{dr^2} = \\frac{d}{dr} \\left[ 4\\epsilon ( -12\\sigma^{12}r^{-13} + 6\\sigma^6 r^{-7} ) \\right]$$\n$$U''(r) = 4\\epsilon [ (-12)(-13)\\sigma^{12}r^{-14} + (6)(-7)\\sigma^6 r^{-8} ]$$\n$$U''(r) = 4\\epsilon [ 156\\sigma^{12}r^{-14} - 42\\sigma^6 r^{-8} ]$$\n\nNow, we evaluate this expression at the equilibrium separation $r = r_e = 2^{1/6}\\sigma$. It is algebraically simpler to first use the relation $r_e^6 = 2\\sigma^6$.\nFrom this relation, we can write $\\sigma^6 = \\frac{r_e^6}{2}$. Substituting this into the expression for $U''(r_e)$:\n$$U''(r_e) = 4\\epsilon \\left[ 156\\sigma^{12}r_e^{-14} - 42\\left(\\frac{r_e^6}{2}\\right) r_e^{-8} \\right]$$\n$$U''(r_e) = 4\\epsilon \\left[ 156(\\sigma^6)^2 r_e^{-14} - 21 r_e^{-2} \\right]$$\n$$U''(r_e) = 4\\epsilon \\left[ 156\\left(\\frac{r_e^6}{2}\\right)^2 r_e^{-14} - 21 r_e^{-2} \\right]$$\n$$U''(r_e) = 4\\epsilon \\left[ 156\\frac{r_e^{12}}{4} r_e^{-14} - 21 r_e^{-2} \\right]$$\n$$U''(r_e) = 4\\epsilon \\left[ 39 r_e^{-2} - 21 r_e^{-2} \\right] = 4\\epsilon (18 r_e^{-2}) = \\frac{72\\epsilon}{r_e^2}$$\nSubstituting $r_e^2 = (2^{1/6}\\sigma)^2 = 2^{1/3}\\sigma^2$:\n$$U''(r_e) = \\frac{72\\epsilon}{2^{1/3}\\sigma^2}$$\nThis is the curvature of the potential at the equilibrium point.\n\n**3. Vibrational Angular Frequency ($\\omega$)**\nThe problem requires using the Taylor expansion of the potential. For small displacements $x = r - r_e$ from equilibrium, the potential $U(r)$ can be approximated by its Taylor series around $r_e$:\n$$U(r) \\approx U(r_e) + U'(r_e)(r-r_e) + \\frac{1}{2}U''(r_e)(r-r_e)^2 + \\mathcal{O}((r-r_e)^3)$$\nBy definition of equilibrium, $U'(r_e) = 0$. Ignoring the constant energy offset $U(r_e)$ and higher-order terms, the potential for small oscillations is:\n$$U(x) \\approx \\frac{1}{2}U''(r_e)x^2$$\nThis is the **harmonic approximation**. The potential has the form of a simple harmonic oscillator, $U(x) = \\frac{1}{2}kx^2$, where the effective spring constant $k$ is the curvature of the potential at the minimum:\n$$k = U''(r_e) = \\frac{72\\epsilon}{2^{1/3}\\sigma^2}$$\n\nThe equation of motion for the relative coordinate of a diatomic molecule with reduced mass $\\mu$ is given by Newton's second law:\n$$\\mu \\ddot{x} = F = -\\frac{dU}{dx} = -kx$$\nThis gives the standard equation for simple harmonic motion:\n$$\\ddot{x} + \\frac{k}{\\mu}x = 0$$\nThe angular frequency of this motion is given by:\n$$\\omega = \\sqrt{\\frac{k}{\\mu}}$$\nSubstituting the expression for $k$:\n$$\\omega = \\sqrt{\\frac{1}{\\mu} \\left( \\frac{72\\epsilon}{2^{1/3}\\sigma^2} \\right)} = \\sqrt{\\frac{72\\epsilon}{2^{1/3}\\mu\\sigma^2}}$$\nTo simplify the numerical factor:\n$$\\frac{72}{2^{1/3}} = \\frac{36 \\times 2}{2^{1/3}} = 36 \\times 2^{1-1/3} = 36 \\times 2^{2/3}$$\nSo the expression for $\\omega^2$ becomes:\n$$\\omega^2 = \\frac{36 \\cdot 2^{2/3} \\epsilon}{\\mu\\sigma^2}$$\nTaking the square root gives the final expression for the angular frequency:\n$$\\omega = \\sqrt{\\frac{36 \\cdot 2^{2/3} \\epsilon}{\\mu\\sigma^2}} = \\frac{6 \\cdot (2^{2/3})^{1/2}}{\\sigma} \\sqrt{\\frac{\\epsilon}{\\mu}} = \\frac{6 \\cdot 2^{1/3}}{\\sigma} \\sqrt{\\frac{\\epsilon}{\\mu}}$$\nThis can be written as a single expression:\n$$\\omega = 6 \\cdot 2^{1/3} \\sqrt{\\frac{\\epsilon}{\\mu\\sigma^2}}$$\nThis is the harmonic vibrational angular frequency of the diatomic molecule.", "answer": "$$\\boxed{6 \\cdot 2^{1/3} \\sqrt{\\frac{\\epsilon}{\\mu \\sigma^2}}}$$", "id": "3420796"}, {"introduction": "In molecular dynamics simulations, it is the force, the negative gradient of the potential energy, that directly dictates particle motion. This practice moves from the potential energy function to the forces used in simulation algorithms for both the Lennard-Jones and Buckingham models. You will also confront a critical practical issue in large-scale simulations: the necessity of truncating interactions at a finite cutoff distance and the consequences this has for energy and force continuity. [@problem_id:3420802]", "problem": "Consider two atoms interacting via a central pair potential in three dimensions. In Molecular Dynamics (MD), the pairwise force magnitude along the center-to-center line is defined by $F(r)=-\\frac{dU(r)}{dr}$, where $r$ is the scalar interatomic separation and $U(r)$ is the pair potential energy. Two widely used model pair potentials are the Lennard-Jones (LJ) and Buckingham (also called exponential-6) forms, given by\n$$U_{\\mathrm{LJ}}(r)=4\\epsilon\\left[\\left(\\frac{\\sigma}{r}\\right)^{12}-\\left(\\frac{\\sigma}{r}\\right)^{6}\\right],\\quad U_{\\mathrm{B}}(r)=A\\,\\exp\\!\\left(-\\frac{r}{\\rho}\\right)-\\frac{C}{r^{6}},$$\nwhere $\\epsilon$, $\\sigma$, $A$, $\\rho$, and $C$ are positive parameters and $r>0$.\n\nIn finite-range simulations, interactions are curtailed beyond a cutoff distance $r_{c}>0$. Three typical cutoff schemes are:\n- Simple truncation (ST): $U_{\\mathrm{ST}}(r)=U(r)$ for $r<r_{c}$ and $U_{\\mathrm{ST}}(r)=0$ for $r\\ge r_{c}$.\n- Shifted-potential (SP): $U_{\\mathrm{SP}}(r)=U(r)-U(r_{c})$ for $r<r_{c}$ and $U_{\\mathrm{SP}}(r)=0$ for $r\\ge r_{c}$.\n- Shifted-force (SF): $U_{\\mathrm{SF}}(r)=U(r)-U(r_{c})-(r-r_{c})U'(r_{c})$ for $r<r_{c}$ and $U_{\\mathrm{SF}}(r)=0$ for $r\\ge r_{c}$.\n\nTasks:\n$1.$ Starting only from the definition $F(r)=-\\frac{dU(r)}{dr}$ and the given $U_{\\mathrm{LJ}}(r)$ and $U_{\\mathrm{B}}(r)$, derive closed-form expressions for the pair forces $F_{\\mathrm{LJ}}(r)$ and $F_{\\mathrm{B}}(r)$ as functions of $r$, $\\epsilon$, $\\sigma$, $A$, $\\rho$, and $C$.\n\n$2.$ Using a first-order Taylor expansion of $U(r)$ about $r=r_{c}$, analyze, for each of the three cutoff schemes (ST, SP, SF), the behavior of the force $F(r)$ as $r\\to r_{c}$ from below and from above. Identify which quantities are continuous at $r_{c}$ and derive the leading-order mismatch in the force and its first derivative across $r_{c}$ in terms of $U(r_{c})$, $U'(r_{c})$, and $U''(r_{c})$. Your analysis should explicitly connect how these mismatches manifest for $U_{\\mathrm{LJ}}(r)$ and $U_{\\mathrm{B}}(r)$, without substituting numerical values.\n\nReport, as your final answer, the pair of expressions $\\big(F_{\\mathrm{LJ}}(r),\\,F_{\\mathrm{B}}(r)\\big)$ in closed form. No numerical evaluation is required and no units are needed for the final expressions. If you choose to simplify, preserve exact algebraic forms.", "solution": "The problem statement has been evaluated and found to be valid. It is scientifically grounded, well-posed, objective, and contains all necessary information for a complete solution. The definitions of the Lennard-Jones and Buckingham potentials, as well as the cutoff schemes, are standard in the field of molecular dynamics. The tasks are unambiguous and solvable using fundamental principles of calculus.\n\nThe solution proceeds in two parts as required by the tasks.\n\nPart 1: Derivation of Pair Forces\n\nThe force $F(r)$ is derived from the potential energy $U(r)$ using the relation $F(r) = -\\frac{dU(r)}{dr}$.\n\nDerivation of the Lennard-Jones force, $F_{\\mathrm{LJ}}(r)$:\nThe Lennard-Jones potential is given by:\n$$U_{\\mathrm{LJ}}(r) = 4\\epsilon\\left[\\left(\\frac{\\sigma}{r}\\right)^{12} - \\left(\\frac{\\sigma}{r}\\right)^{6}\\right]$$\nTo facilitate differentiation, we rewrite the potential as:\n$$U_{\\mathrm{LJ}}(r) = 4\\epsilon\\left[\\sigma^{12}r^{-12} - \\sigma^{6}r^{-6}\\right]$$\nWe now differentiate $U_{\\mathrm{LJ}}(r)$ with respect to $r$:\n$$\\frac{dU_{\\mathrm{LJ}}(r)}{dr} = 4\\epsilon\\left[\\sigma^{12}(-12)r^{-13} - \\sigma^{6}(-6)r^{-7}\\right]$$\n$$\\frac{dU_{\\mathrm{LJ}}(r)}{dr} = 4\\epsilon\\left[-12\\frac{\\sigma^{12}}{r^{13}} + 6\\frac{\\sigma^{6}}{r^{7}}\\right]$$\nThe force is the negative of this derivative:\n$$F_{\\mathrm{LJ}}(r) = -\\frac{dU_{\\mathrm{LJ}}(r)}{dr} = -4\\epsilon\\left[-12\\frac{\\sigma^{12}}{r^{13}} + 6\\frac{\\sigma^{6}}{r^{7}}\\right] = 4\\epsilon\\left[12\\frac{\\sigma^{12}}{r^{13}} - 6\\frac{\\sigma^{6}}{r^{7}}\\right]$$\nThis expression can be factored for clarity:\n$$F_{\\mathrm{LJ}}(r) = \\frac{24\\epsilon}{r}\\left[2\\frac{\\sigma^{12}}{r^{12}} - \\frac{\\sigma^{6}}{r^{6}}\\right] = \\frac{24\\epsilon}{r}\\left[2\\left(\\frac{\\sigma}{r}\\right)^{12} - \\left(\\frac{\\sigma}{r}\\right)^{6}\\right]$$\n\nDerivation of the Buckingham force, $F_{\\mathrm{B}}(r)$:\nThe Buckingham potential is given by:\n$$U_{\\mathrm{B}}(r) = A\\,\\exp\\left(-\\frac{r}{\\rho}\\right) - \\frac{C}{r^{6}}$$\nRewriting the second term with a negative exponent:\n$$U_{\\mathrm{B}}(r) = A\\,\\exp\\left(-\\frac{r}{\\rho}\\right) - C r^{-6}$$\nDifferentiating $U_{\\mathrm{B}}(r)$ with respect to $r$:\n$$\\frac{dU_{\\mathrm{B}}(r)}{dr} = A\\,\\exp\\left(-\\frac{r}{\\rho}\\right)\\left(-\\frac{1}{\\rho}\\right) - C(-6)r^{-7}$$\n$$\\frac{dU_{\\mathrm{B}}(r)}{dr} = -\\frac{A}{\\rho}\\exp\\left(-\\frac{r}{\\rho}\\right) + \\frac{6C}{r^{7}}$$\nThe force is the negative of this derivative:\n$$F_{\\mathrm{B}}(r) = -\\frac{dU_{\\mathrm{B}}(r)}{dr} = -\\left[-\\frac{A}{\\rho}\\exp\\left(-\\frac{r}{\\rho}\\right) + \\frac{6C}{r^{7}}\\right] = \\frac{A}{\\rho}\\exp\\left(-\\frac{r}{\\rho}\\right) - \\frac{6C}{r^{7}}$$\n\nPart 2: Analysis of Cutoff Schemes\n\nWe analyze the continuity of the potential $U(r)$, the force $F(r) = -U'(r)$, and the force-derivative $F'(r) = -U''(r)$ at the cutoff distance $r_c$. For all schemes, the modified potential and its derivatives are zero for $r > r_c$. Therefore, the limits from above are $U(r_c^+) = 0$, $F(r_c^+) = 0$, and $F'(r_c^+) = 0$. The analysis focuses on the limits from below, $r \\to r_c^-$. The mismatch in a quantity $f(r)$ at $r_c$ is defined as $\\Delta f = f(r_c^+) - f(r_c^-)$.\n\nWe use the Taylor series expansion of the original potential $U(r)$ around $r_c$ for $r < r_c$. Let $r=r_c-\\delta$, where $\\delta > 0$ and $\\delta \\to 0$.\n$$U(r_c-\\delta) = U(r_c) - \\delta U'(r_c) + \\frac{\\delta^2}{2}U''(r_c) - O(\\delta^3)$$\n$$U'(r_c-\\delta) = U'(r_c) - \\delta U''(r_c) + \\frac{\\delta^2}{2}U'''(r_c) - O(\\delta^3)$$\n$$U''(r_c-\\delta) = U''(r_c) - \\delta U'''(r_c) + O(\\delta^2)$$\n\nSimple Truncation (ST)\nFor $r < r_c$, $U_{\\mathrm{ST}}(r) = U(r)$.\n- Potential: $U_{\\mathrm{ST}}(r_c^-) = \\lim_{r \\to r_c^-} U(r) = U(r_c)$. The potential is discontinuous with a jump $\\Delta U = 0 - U(r_c) = -U(r_c)$.\n- Force: $F_{\\mathrm{ST}}(r) = -U'(r)$. Thus, $F_{\\mathrm{ST}}(r_c^-) = -U'(r_c)$. The force is discontinuous with a jump $\\Delta F = 0 - (-U'(r_c)) = U'(r_c)$.\n- Force Derivative: $F'_{\\mathrm{ST}}(r) = -U''(r)$. Thus, $F'_{\\mathrm{ST}}(r_c^-) = -U''(r_c)$. The force derivative is discontinuous with a jump $\\Delta F' = 0 - (-U''(r_c)) = U''(r_c)$.\n\nShifted-Potential (SP)\nFor $r < r_c$, $U_{\\mathrm{SP}}(r) = U(r) - U(r_c)$.\n- Potential: $U_{\\mathrm{SP}}(r_c^-) = \\lim_{r \\to r_c^-} [U(r) - U(r_c)] = U(r_c) - U(r_c) = 0$. The potential is continuous, $\\Delta U = 0$.\n- Force: $F_{\\mathrm{SP}}(r) = -\\frac{d}{dr}[U(r) - U(r_c)] = -U'(r)$. Thus, $F_{\\mathrm{SP}}(r_c^-) = -U'(r_c)$. The force is discontinuous with a jump $\\Delta F = 0 - (-U'(r_c)) = U'(r_c)$.\n- Force Derivative: $F'_{\\mathrm{SP}}(r) = -U''(r)$. Thus, $F'_{\\mathrm{SP}}(r_c^-) = -U''(r_c)$. The force derivative is discontinuous with a jump $\\Delta F' = 0 - (-U''(r_c)) = U''(r_c)$.\n\nShifted-Force (SF)\nFor $r < r_c$, $U_{\\mathrm{SF}}(r) = U(r) - U(r_c) - (r-r_c)U'(r_c)$. This is the difference between $U(r)$ and its first-order Taylor approximation at $r_c$.\n- Potential: Using the Taylor expansion for $U(r)$ at $r=r_c-\\delta$:\n$U_{\\mathrm{SF}}(r_c-\\delta) = U(r_c-\\delta) - U(r_c) - (-\\delta)U'(r_c) \\approx [U(r_c) - \\delta U'(r_c) + \\frac{\\delta^2}{2}U''(r_c)] - U(r_c) + \\delta U'(r_c) = \\frac{\\delta^2}{2}U''(r_c)$.\nAs $\\delta \\to 0$, $U_{\\mathrm{SF}}(r_c^-) \\to 0$. The potential is continuous, $\\Delta U = 0$.\n- Force: $F_{\\mathrm{SF}}(r) = -\\frac{d}{dr}[U(r) - U(r_c) - (r-r_c)U'(r_c)] = -[U'(r) - U'(r_c)]$.\n$F_{\\mathrm{SF}}(r_c^-) = \\lim_{r \\to r_c^-} -[U'(r) - U'(r_c)] = -[U'(r_c) - U'(r_c)] = 0$. The force is continuous, $\\Delta F = 0$.\n- Force Derivative: $F'_{\\mathrm{SF}}(r) = -\\frac{d}{dr}[U'(r) - U'(r_c)] = -U''(r)$.\n$F'_{\\mathrm{SF}}(r_c^-) = -U''(r_c)$. The force derivative is discontinuous with a jump $\\Delta F' = 0 - (-U''(r_c)) = U''(r_c)$.\n\nSummary of Mismatches at $r_c$:\n| Scheme | Continuous Quantities | Mismatch $\\Delta F$ | Mismatch $\\Delta F'$ |\n| :---: | :---: | :---: | :---: |\n| ST | None (in general) | $U'(r_c)$ | $U''(r_c)$ |\n| SP | $U(r)$ | $U'(r_c)$ | $U''(r_c)$ |\n| SF | $U(r)$, $F(r)$ | $0$ | $U''(r_c)$ |\n\nConnection to $U_{\\mathrm{LJ}}(r)$ and $U_{\\mathrm{B}}(r)$:\nThe mismatches depend on the values of the first and second derivatives of the potential at the cutoff, $U'(r_c)$ and $U''(r_c)$. For the Lennard-Jones and Buckingham potentials, these derivatives are:\nFor $U_{\\mathrm{LJ}}(r)$:\n$$U'_{\\mathrm{LJ}}(r) = -F_{\\mathrm{LJ}}(r) = 4\\epsilon\\left[-12\\frac{\\sigma^{12}}{r^{13}} + 6\\frac{\\sigma^{6}}{r^{7}}\\right]$$\n$$U''_{\\mathrm{LJ}}(r) = \\frac{d}{dr}U'_{\\mathrm{LJ}}(r) = 4\\epsilon\\left[156\\frac{\\sigma^{12}}{r^{14}} - 42\\frac{\\sigma^{6}}{r^{8}}\\right]$$\nFor $U_{\\mathrm{B}}(r)$:\n$$U'_{\\mathrm{B}}(r) = -F_{\\mathrm{B}}(r) = -\\frac{A}{\\rho}\\exp\\left(-\\frac{r}{\\rho}\\right) + \\frac{6C}{r^{7}}$$\n$$U''_{\\mathrm{B}}(r) = \\frac{d}{dr}U'_{\\mathrm{B}}(r) = \\frac{A}{\\rho^2}\\exp\\left(-\\frac{r}{\\rho}\\right) - \\frac{42C}{r^{8}}$$\nFor any given $r_c > 0$, these expressions can be evaluated to find the specific discontinuities for each potential under each cutoff scheme. For example, in the ST and SP schemes, the force for the LJ potential has a jump of magnitude $U'_{\\mathrm{LJ}}(r_c)$, and for all schemes, the force derivative has a jump of magnitude $U''_{\\mathrm{LJ}}(r_c)$. A similar statement holds for the Buckingham potential. Physical simulations require continuous forces to ensure energy conservation, making the SF scheme superior to ST and SP in this regard.", "answer": "$$\\boxed{\\begin{pmatrix} \\frac{24\\epsilon}{r}\\left[2\\left(\\frac{\\sigma}{r}\\right)^{12} - \\left(\\frac{\\sigma}{r}\\right)^{6}\\right] & \\frac{A}{\\rho}\\exp\\left(-\\frac{r}{\\rho}\\right) - \\frac{6C}{r^{7}} \\end{pmatrix}}$$", "id": "3420802"}, {"introduction": "Having established the issues with potential truncation, a key skill is learning how to correct for the neglected interactions. This exercise demonstrates the most common approach: the mean-field tail correction, which accounts for the energy contribution from the long-range part of the potential. By framing this correction within the powerful theoretical framework of free energy perturbation, you will uncover an elegant analytical solution and gain insight into the behavior of free energy estimators in this important special case. [@problem_id:3420847]", "problem": "Consider a homogeneous, isotropic fluid of $N$ identical particles in a cubic box of volume $V$ with periodic boundary conditions, at fixed number density $\\rho = N/V$ and temperature $T$ in the canonical ensemble. The particles interact via the Lennard-Jones (LJ) pair potential $u_{\\mathrm{LJ}}(r) = 4 \\varepsilon \\left[ \\left( \\sigma / r \\right)^{12} - \\left( \\sigma / r \\right)^{6} \\right]$. Define two Hamiltonians $U_{\\mathrm{A}}$ and $U_{\\mathrm{B}}$ as follows:\n- $U_{\\mathrm{A}}$: the LJ potential truncated at a finite cutoff $r_{\\mathrm{c}}$ without shifting, that is, $u_{\\mathrm{A}}(r) = u_{\\mathrm{LJ}}(r)$ for $r \\le r_{\\mathrm{c}}$ and $u_{\\mathrm{A}}(r) = 0$ for $r > r_{\\mathrm{c}}$.\n- $U_{\\mathrm{B}}$: the truncated LJ potential plus a standard long-range tail correction that replaces the neglected interactions beyond the cutoff by a mean-field correction derived under the assumption that the radial distribution function is $g(r)=1$ for $r > r_{\\mathrm{c}}$. Under this assumption, the tail correction depends only on $\\rho$ and $r_{\\mathrm{c}}$ and is independent of the instantaneous configuration.\n\nWork in reduced Lennard-Jones units where $\\varepsilon = 1$, $\\sigma = 1$, and the Boltzmann constant $k_{\\mathrm{B}} = 1$. Angles do not appear. Energies must be expressed in reduced energy units of $\\varepsilon$.\n\nYour tasks are:\n1. Starting from the canonical partition function $Z = \\int \\mathrm{d}\\mathbf{x}\\, e^{-\\beta U(\\mathbf{x})}$ with $\\beta = 1/(k_{\\mathrm{B}} T)$ and the definition of Helmholtz free energy $F = -k_{\\mathrm{B}} T \\ln Z$, derive the identity that expresses the free-energy difference $\\Delta F = F_{\\mathrm{B}}-F_{\\mathrm{A}}$ as an expectation over the canonical ensemble of $U_{\\mathrm{A}}$, specialized to the case where the difference $\\Delta U(\\mathbf{x}) = U_{\\mathrm{B}}(\\mathbf{x}) - U_{\\mathrm{A}}(\\mathbf{x})$ is independent of the configuration $\\mathbf{x}$. Explain why, in this special case, $\\Delta F$ equals the constant energetic offset and why the variance of the standard free energy perturbation estimator is identically zero for any $N$.\n2. Under the homogeneous fluid assumption with $g(r)=1$ for $r>r_{\\mathrm{c}}$, derive an explicit expression for the long-range energy correction per particle associated with truncating the LJ potential at $r_{\\mathrm{c}}$. Your derivation must begin from the definition that the mean-field tail energy per particle is the integral over $r>r_{\\mathrm{c}}$ of the pair potential weighted by the number density. Express the final result as a function of $\\rho$ and $r_{\\mathrm{c}}$ in reduced units $\\varepsilon=1$, $\\sigma=1$, $k_{\\mathrm{B}}=1$.\n3. Use the results of items $1$ and $2$ to construct a program that computes the free-energy difference per particle $\\Delta F/N$ between $U_{\\mathrm{A}}$ and $U_{\\mathrm{B}}$ and the variance (in reduced units) of the free energy perturbation estimator of $\\exp\\left(-\\beta \\Delta U\\right)$ for the following test suite of parameter sets $(N,\\rho,r_{\\mathrm{c}},T)$:\n   - Test $1$: $(N,\\rho,r_{\\mathrm{c}},T) = (256,\\,0.3,\\,2.5,\\,1.2)$.\n   - Test $2$: $(N,\\rho,r_{\\mathrm{c}},T) = (108,\\,0.85,\\,2.5,\\,0.9)$.\n   - Test $3$: $(N,\\rho,r_{\\mathrm{c}},T) = (4000,\\,0.1,\\,1.8,\\,3.0)$.\n   For each test, output the free-energy difference per particle $\\Delta F/N$ in reduced energy units $\\varepsilon$ and the variance of the estimator as a float. Round each float to six digits after the decimal point.\n4. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets in the following order: $[\\Delta F/N \\text{ of Test } 1,\\ \\Delta F/N \\text{ of Test } 2,\\ \\Delta F/N \\text{ of Test } 3,\\ \\mathrm{Var} \\text{ of Test } 1,\\ \\mathrm{Var} \\text{ of Test } 2,\\ \\mathrm{Var} \\text{ of Test } 3]$.\n\nNotes:\n- Although the topic references both Lennard-Jones and Buckingham potentials, you must focus the computation on the Lennard-Jones case as specified above.\n- Ensure that all intermediate reasoning in your derivation adheres to first principles and well-tested statistical mechanical identities.\n- All reported energies must be in reduced units of $\\varepsilon$ and all temperatures in reduced units with $k_{\\mathrm{B}}=1$.", "solution": "The problem is evaluated as valid according to the specified criteria. It is scientifically grounded in statistical mechanics, well-posed with a clear objective, and contains sufficient information for a unique solution. The language is precise, and the parameters are physically reasonable for studies of simple fluids. The problem requires the derivation and application of fundamental concepts, which is a substantive task.\n\nThe solution is presented in three parts as requested by the problem statement.\n\n**Part 1: Free Energy Difference and Estimator Variance**\n\nThe Helmholtz free energy $F$ is defined in terms of the canonical partition function $Z$ as $F = -k_{\\mathrm{B}} T \\ln Z$, where $Z = \\int e^{-\\beta U(\\mathbf{x})} \\mathrm{d}\\mathbf{x}$, $\\beta = 1/(k_{\\mathrm{B}} T)$, and $\\mathbf{x}$ represents the coordinates of all $N$ particles. We are working in reduced units where the Boltzmann constant $k_{\\mathrm{B}}=1$, so $\\beta=1/T$.\n\nThe free energy difference between two systems, A and B, is given by:\n$$\n\\Delta F = F_{\\mathrm{B}} - F_{\\mathrm{A}} = (-T \\ln Z_{\\mathrm{B}}) - (-T \\ln Z_{\\mathrm{A}}) = -T \\ln \\left(\\frac{Z_{\\mathrm{B}}}{Z_{\\mathrm{A}}}\\right)\n$$\nThe ratio of the partition functions can be written as an expectation value in the canonical ensemble of system A. Let $\\Delta U(\\mathbf{x}) = U_{\\mathrm{B}}(\\mathbf{x}) - U_{\\mathrm{A}}(\\mathbf{x})$.\n$$\n\\frac{Z_{\\mathrm{B}}}{Z_{\\mathrm{A}}} = \\frac{\\int e^{-\\beta U_{\\mathrm{B}}(\\mathbf{x})} \\mathrm{d}\\mathbf{x}}{\\int e^{-\\beta U_{\\mathrm{A}}(\\mathbf{x})} \\mathrm{d}\\mathbf{x}} = \\frac{\\int e^{-\\beta (U_{\\mathrm{A}}(\\mathbf{x}) + \\Delta U(\\mathbf{x}))} \\mathrm{d}\\mathbf{x}}{Z_{\\mathrm{A}}} = \\frac{\\int e^{-\\beta \\Delta U(\\mathbf{x})} e^{-\\beta U_{\\mathrm{A}}(\\mathbf{x})} \\mathrm{d}\\mathbf{x}}{Z_{\\mathrm{A}}}\n$$\nThis is the definition of the canonical ensemble average of the quantity $e^{-\\beta \\Delta U(\\mathbf{x})}$ in the A-ensemble, denoted as $\\langle e^{-\\beta \\Delta U} \\rangle_{\\mathrm{A}}$.\n$$\n\\frac{Z_{\\mathrm{B}}}{Z_{\\mathrm{A}}} = \\langle e^{-\\beta \\Delta U} \\rangle_{\\mathrm{A}}\n$$\nSubstituting this into the expression for $\\Delta F$ yields the standard free energy perturbation (FEP) identity:\n$$\n\\Delta F = -T \\ln \\langle e^{-\\beta \\Delta U} \\rangle_{\\mathrm{A}}\n$$\nThe problem specifies a special case where the energy difference $\\Delta U(\\mathbf{x})$ is independent of the configuration $\\mathbf{x}$. Let this constant energy difference be $\\Delta U(\\mathbf{x}) = C$. The expectation value then simplifies significantly:\n$$\n\\langle e^{-\\beta \\Delta U} \\rangle_{\\mathrm{A}} = \\langle e^{-\\beta C} \\rangle_{\\mathrm{A}}\n$$\nSince $e^{-\\beta C}$ is a constant, its expectation value is simply the constant itself. We can show this formally:\n$$\n\\langle e^{-\\beta C} \\rangle_{\\mathrm{A}} = \\frac{\\int e^{-\\beta C} e^{-\\beta U_{\\mathrm{A}}(\\mathbf{x})} \\mathrm{d}\\mathbf{x}}{\\int e^{-\\beta U_{\\mathrm{A}}(\\mathbf{x})} \\mathrm{d}\\mathbf{x}} = e^{-\\beta C} \\frac{\\int e^{-\\beta U_{\\mathrm{A}}(\\mathbf{x})} \\mathrm{d}\\mathbf{x}}{\\int e^{-\\beta U_{\\mathrm{A}}(\\mathbf{x})} \\mathrm{d}\\mathbf{x}} = e^{-\\beta C}\n$$\nNow, we substitute this result back into the expression for $\\Delta F$:\n$$\n\\Delta F = -T \\ln(e^{-\\beta C}) = -T(-\\beta C) = T \\beta C\n$$\nWith $\\beta = 1/T$ in reduced units, we find:\n$$\n\\Delta F = T \\left(\\frac{1}{T}\\right) C = C\n$$\nTherefore, in the case where the energy difference between the two systems is a constant offset $C$, the free energy difference $\\Delta F$ is exactly equal to that constant offset, i.e., $\\Delta F = \\Delta U$. This is because adding a constant energy to every possible microstate of the system shifts the total free energy by that same constant, without altering the entropy, which depends on the relative probabilities of the microstates.\n\nNext, we consider the variance of the FEP estimator. The estimator is the quantity $Y = e^{-\\beta \\Delta U}$. The variance is defined as $\\mathrm{Var}(Y) = \\langle Y^2 \\rangle_{\\mathrm{A}} - \\langle Y \\rangle_{\\mathrm{A}}^2$.\nWhen $\\Delta U = C$ is a constant, the estimator $Y = e^{-\\beta C}$ is also a constant. The expectation of a constant is the constant itself, so $\\langle Y \\rangle_{\\mathrm{A}} = e^{-\\beta C}$.\nSimilarly, the expectation of the square of the estimator is $\\langle Y^2 \\rangle_{\\mathrm{A}} = \\langle (e^{-\\beta C})^2 \\rangle_{\\mathrm{A}} = \\langle e^{-2\\beta C} \\rangle_{\\mathrm{A}} = e^{-2\\beta C}$.\nThe variance is therefore:\n$$\n\\mathrm{Var}(Y) = \\mathrm{Var}(e^{-\\beta \\Delta U}) = e^{-2\\beta C} - (e^{-\\beta C})^2 = e^{-2\\beta C} - e^{-2\\beta C} = 0\n$$\nThe variance is identically zero because the quantity being sampled, $e^{-\\beta \\Delta U}$, is not a random variable fluctuating with the configuration $\\mathbf{x}$; it is a fixed constant for all configurations. This holds for any system size $N$.\n\n**Part 2: Long-Range Energy Correction Derivation**\n\nThe problem defines the long-range energy correction per particle based on a mean-field approximation. This correction, which we denote $u_{\\mathrm{corr}}$, accounts for the energy of interaction of one particle with all other particles beyond the cutoff radius $r_{\\mathrm{c}}$. It is derived by integrating the pair potential over the volume outside a sphere of radius $r_{\\mathrm{c}}$, assuming a uniform particle distribution.\n\nThe number of particles in a spherical shell of radius $r$ and thickness $\\mathrm{d}r$ around a central particle is given by the product of the volume of the shell, the average number density $\\rho$, and the radial distribution function $g(r)$. With the assumption that $g(r)=1$ for $r > r_{\\mathrm{c}}$, this number is $\\mathrm{d}N(r) = \\rho (1) (4\\pi r^2 \\mathrm{d}r)$.\n\nThe potential energy of interaction between the central particle and the particles in this shell is $u_{\\mathrm{LJ}}(r) \\mathrm{d}N(r)$. To find the total interaction energy of the central particle with all particles beyond $r_{\\mathrm{c}}$, we integrate from $r_{\\mathrm{c}}$ to $\\infty$:\n$$\nU_{\\mathrm{tail, particle}} = \\int_{r_{\\mathrm{c}}}^{\\infty} u_{\\mathrm{LJ}}(r) \\rho (4\\pi r^2) \\mathrm{d}r = 4\\pi\\rho \\int_{r_{\\mathrm{c}}}^{\\infty} u_{\\mathrm{LJ}}(r) r^2 \\mathrm{d}r\n$$\nThe total tail correction for the entire system of $N$ particles is $U_{\\mathrm{tail, total}} = \\frac{1}{2} N U_{\\mathrm{tail, particle}}$ where the factor of $\\frac{1}{2}$ avoids double counting each pair interaction. The long-range energy correction per particle is thus:\n$$\nu_{\\mathrm{corr}} = \\frac{U_{\\mathrm{tail, total}}}{N} = \\frac{1}{2} U_{\\mathrm{tail, particle}} = 2\\pi\\rho \\int_{r_{\\mathrm{c}}}^{\\infty} u_{\\mathrm{LJ}}(r) r^2 \\mathrm{d}r\n$$\nWe now substitute the Lennard-Jones potential in reduced units ($\\varepsilon=1, \\sigma=1$), $u_{\\mathrm{LJ}}(r) = 4(r^{-12} - r^{-6})$, and perform the integration:\n$$\nu_{\\mathrm{corr}} = 2\\pi\\rho \\int_{r_{\\mathrm{c}}}^{\\infty} 4(r^{-12} - r^{-6}) r^2 \\mathrm{d}r = 8\\pi\\rho \\int_{r_{\\mathrm{c}}}^{\\infty} (r^{-10} - r^{-4}) \\mathrm{d}r\n$$\nThe integral evaluates to:\n$$\n\\int_{r_{\\mathrm{c}}}^{\\infty} (r^{-10} - r^{-4}) \\mathrm{d}r = \\left[ \\frac{r^{-9}}{-9} - \\frac{r^{-3}}{-3} \\right]_{r_{\\mathrm{c}}}^{\\infty} = \\left[ \\frac{1}{3}r^{-3} - \\frac{1}{9}r^{-9} \\right]_{r_{\\mathrm{c}}}^{\\infty}\n$$\nAs $r \\to \\infty$, both $r^{-3}$ and $r^{-9}$ approach $0$. Evaluating at the limits gives:\n$$\n(0 - 0) - \\left( \\frac{1}{3}r_{\\mathrm{c}}^{-3} - \\frac{1}{9}r_{\\mathrm{c}}^{-9} \\right) = \\frac{1}{9}r_{\\mathrm{c}}^{-9} - \\frac{1}{3}r_{\\mathrm{c}}^{-3}\n$$\nSubstituting this back, we obtain the explicit expression for the long-range energy correction per particle:\n$$\nu_{\\mathrm{corr}}(\\rho, r_{\\mathrm{c}}) = 8\\pi\\rho \\left( \\frac{1}{9}r_{\\mathrm{c}}^{-9} - \\frac{1}{3}r_{\\mathrm{c}}^{-3} \\right)\n$$\n\n**Part 3: Computation of $\\Delta F/N$ and Variance**\n\nFrom Part 1, the free energy difference $\\Delta F$ is equal to the constant energy difference $\\Delta U$. This energy difference $\\Delta U$ is the total long-range correction for the system, which is defined to be independent of configuration. Therefore, $\\Delta U = N u_{\\mathrm{corr}}$. The free energy difference per particle is thus:\n$$\n\\frac{\\Delta F}{N} = \\frac{\\Delta U}{N} = u_{\\mathrm{corr}} = 8\\pi\\rho \\left( \\frac{1}{9}r_{\\mathrm{c}}^{-9} - \\frac{1}{3}r_{\\mathrm{c}}^{-3} \\right)\n$$\nFrom Part 1, the variance of the FEP estimator, $\\mathrm{Var}(\\exp(-\\beta \\Delta U))$, is identically $0$ because $\\Delta U$ is a constant.\n\nThe program will calculate this value of $u_{\\mathrm{corr}}$ for each test case and report the variance as $0.0$. The parameters $N$ and $T$ from the test cases are not required for this specific calculation, as the free energy difference per particle and the variance are independent of them under the problem's simplifying assumptions.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem of calculating the free-energy difference and estimator\n    variance for a Lennard-Jones fluid with a standard long-range correction.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    # Format: (N, rho, r_c, T)\n    test_cases = [\n        (256, 0.3, 2.5, 1.2),\n        (108, 0.85, 2.5, 0.9),\n        (4000, 0.1, 1.8, 3.0),\n    ]\n\n    delta_f_per_n_results = []\n    variance_results = []\n\n    # The free energy difference per particle (Delta F / N) is equal to the\n    # long-range energy correction per particle, derived as:\n    # u_corr = 8 * pi * rho * ( (1/9) * r_c**(-9) - (1/3) * r_c**(-3) )\n    # The variance of the free energy perturbation estimator Var(exp(-beta*Delta_U))\n    # is identically zero because Delta_U is a constant independent of configuration.\n\n    for case in test_cases:\n        N, rho, r_c, T = case\n\n        # Calculate the free-energy difference per particle (Delta F / N)\n        # This is equivalent to the long-range energy correction per particle (u_corr)\n        # in reduced units (epsilon=1, sigma=1).\n        term1 = (1/9) * (r_c ** -9)\n        term2 = (1/3) * (r_c ** -3)\n        delta_f_per_n = 8 * np.pi * rho * (term1 - term2)\n        \n        delta_f_per_n_results.append(delta_f_per_n)\n\n        # The variance of the FEP estimator is analytically zero.\n        variance = 0.0\n        variance_results.append(variance)\n    \n    # Format the results to six decimal places as requested.\n    formatted_delta_f = [f\"{val:.6f}\" for val in delta_f_per_n_results]\n    formatted_variance = [f\"{val:.6f}\" for val in variance_results]\n\n    # Combine the results in the specified order.\n    # [Delta_F/N_1, Delta_F/N_2, Delta_F/N_3, Var_1, Var_2, Var_3]\n    final_output_list = formatted_delta_f + formatted_variance\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(final_output_list)}]\")\n\nsolve()\n```", "id": "3420847"}]}