{"hands_on_practices": [{"introduction": "A cornerstone of molecular force fields is the potential energy function describing the stretching of a covalent bond. While the harmonic oscillator provides a simple first approximation, the Morse potential offers a more physically realistic description by accounting for anharmonicity and bond dissociation. This practice challenges you to analytically explore the Morse potential, connecting its mathematical form to physical concepts like force, equilibrium fluctuations, and the deviations from harmonic behavior that are crucial for accurate molecular modeling [@problem_id:3413996].", "problem": "Consider a single diatomic bond coordinate $r$ in Molecular Dynamics (MD), modeled as an internal degree of freedom decoupled from other modes and sampled from the canonical ensemble at temperature $T$. The bond-stretching interaction is described by the Morse functional form, which belongs to the anharmonic class of bond potentials: \n$$U_{b}(r) = D_{e}\\left[1 - \\exp\\!\\left(-a\\,(r - r_{0})\\right)\\right]^{2},$$\nwhere $D_{e} > 0$ is the dissociation energy, $a > 0$ is an inverse length parameter, and $r_{0}$ is the equilibrium bond length. \n\n1. Using the definition of force $F(r) = -\\partial U_{b}/\\partial r$ and fundamental calculus, derive the exact analytic expression for $F(r)$ as a function of $r$.\n\n2. To compare equilibrium fluctuations of the bond length about $r_{0}$ under different force-field classes, define the harmonic (quadratic) reference potential \n$$U_{H}(r) = \\frac{1}{2}k\\,(r - r_{0})^{2},$$\nwith $k$ chosen such that the harmonic curvature at $r_{0}$ matches the Morse curvature $U_{b}''(r_{0})$. Working within the canonical ensemble (inverse temperature $\\beta = 1/(k_{B}T)$, where $k_{B}$ is the Boltzmann constant), derive the equilibrium mean-square fluctuation $\\sigma_{H}^{2} = \\langle (r - r_{0})^{2}\\rangle$ for the harmonic model from first principles.\n\n3. Now, approximate the Morse potential near $r_{0}$ by its Taylor expansion up to quartic order in the displacement $x = r - r_{0}$,\n$$U_{b}(r) \\approx c_{2}\\,x^{2} + c_{3}\\,x^{3} + c_{4}\\,x^{4},$$\nwhere the coefficients $c_{2}$, $c_{3}$, and $c_{4}$ are to be obtained from the expansion of the given $U_{b}(r)$. Assume the low-temperature, weak-anharmonic regime $k_{B}T \\ll D_{e}$, and compute the equilibrium mean-square fluctuation $\\sigma_{M}^{2} = \\langle x^{2}\\rangle$ for the quartic-approximate Morse potential using perturbation theory about the Gaussian baseline defined by $U_{H}(r)$, retaining terms through order $\\mathcal{O}((k_{B}T)^{2})$.\n\n4. Provide the closed-form analytic expression for the ratio $\\sigma_{M}^{2}/\\sigma_{H}^{2}$ to leading nontrivial order in $k_{B}T/D_{e}$, together with the exact analytic expression for $F(r)$ obtained in part 1. No numerical values are given, and no rounding is required. Express your final ratio as a dimensionless expression in terms of $D_{e}$, $a$, and $T$ (and $k_{B}$), and your force $F(r)$ as a function of $r$.", "solution": "The problem is assessed to be valid as it is scientifically grounded, well-posed, and objective. It is a standard problem in statistical mechanics applied to molecular modeling, with all necessary information provided for a unique solution.\n\nThe solution is derived in four parts as requested by the problem statement.\n\n**Part 1: Derivation of the Force $F(r)$**\n\nThe force $F(r)$ on the bond coordinate $r$ is defined as the negative gradient of the potential energy $U_{b}(r)$.\nThe Morse potential is given by:\n$$U_{b}(r) = D_{e}\\left[1 - \\exp(-a\\,(r - r_{0}))\\right]^{2}$$\nTo find the force, we must compute the derivative of $U_{b}(r)$ with respect to $r$. Using the chain rule:\n$$\\frac{\\partial U_{b}}{\\partial r} = D_{e} \\cdot 2 \\left[1 - \\exp(-a\\,(r - r_{0}))\\right] \\cdot \\frac{\\partial}{\\partial r} \\left[1 - \\exp(-a\\,(r - r_{0}))\\right]$$\nThe derivative of the term in the bracket is:\n$$\\frac{\\partial}{\\partial r} \\left[1 - \\exp(-a\\,(r - r_{0}))\\right] = - \\exp(-a\\,(r - r_{0})) \\cdot \\frac{\\partial}{\\partial r} \\left[-a\\,(r - r_{0})\\right] = - \\exp(-a\\,(r - r_{0})) \\cdot (-a) = a \\exp(-a\\,(r - r_{0}))$$\nSubstituting this back, we obtain the gradient of the potential:\n$$\\frac{\\partial U_{b}}{\\partial r} = 2 D_{e} \\left[1 - \\exp(-a\\,(r - r_{0}))\\right] \\cdot a \\exp(-a\\,(r - r_{0})) = 2aD_{e} \\left(\\exp(-a\\,(r - r_{0})) - \\exp(-2a\\,(r - r_{0}))\\right)$$\nThe force is the negative of this gradient:\n$$F(r) = -\\frac{\\partial U_{b}}{\\partial r} = -2aD_{e} \\left(\\exp(-a\\,(r - r_{0})) - \\exp(-2a\\,(r - r_{0}))\\right) = 2aD_{e} \\left(\\exp(-2a\\,(r - r_{0})) - \\exp(-a\\,(r - r_{0}))\\right)$$\n\n**Part 2: Mean-Square Fluctuation in the Harmonic Approximation, $\\sigma_{H}^{2}$**\n\nFirst, we determine the harmonic force constant $k$ by matching the curvature of the harmonic potential $U_{H}(r)$ to that of the Morse potential $U_{b}(r)$ at the equilibrium position $r_{0}$. The curvature is given by the second derivative.\nFrom Part 1, the first derivative is $U_{b}'(r) = 2aD_{e} (\\exp(-a(r - r_{0})) - \\exp(-2a(r - r_{0})))$.\nThe second derivative is:\n$$U_{b}''(r) = \\frac{\\partial}{\\partial r} \\left[2aD_{e} \\left(\\exp(-a(r - r_{0})) - \\exp(-2a(r - r_{0}))\\right)\\right] = 2aD_{e} \\left(-a\\exp(-a(r - r_{0})) + 2a\\exp(-2a(r - r_{0}))\\right)$$\nEvaluating at $r = r_{0}$:\n$$k = U_{b}''(r_{0}) = 2aD_{e} \\left(-a\\exp(0) + 2a\\exp(0)\\right) = 2aD_{e}(-a + 2a) = 2a^{2}D_{e}$$\nThe harmonic potential is $U_{H}(r) = \\frac{1}{2}k(r - r_{0})^{2}$. Let $x = r - r_{0}$. The mean-square fluctuation $\\sigma_{H}^{2}$ is the expectation value $\\langle x^{2} \\rangle$ in the canonical ensemble for this harmonic potential:\n$$\\sigma_{H}^{2} = \\langle x^{2} \\rangle_{H} = \\frac{\\int_{-\\infty}^{\\infty} x^{2} \\exp(-\\beta U_{H}(x)) \\,dx}{\\int_{-\\infty}^{\\infty} \\exp(-\\beta U_{H}(x)) \\,dx} = \\frac{\\int_{-\\infty}^{\\infty} x^{2} \\exp(-\\frac{1}{2}\\beta k x^{2}) \\,dx}{\\int_{-\\infty}^{\\infty} \\exp(-\\frac{1}{2}\\beta k x^{2}) \\,dx}$$\nThese are standard Gaussian integrals. The denominator is $\\sqrt{2\\pi/(\\beta k)}$ and the numerator is $\\frac{1}{\\beta k}\\sqrt{2\\pi/(\\beta k)}$.\nThus, the mean-square fluctuation for the harmonic model is:\n$$\\sigma_{H}^{2} = \\frac{1}{\\beta k} = \\frac{1}{\\beta(2a^{2}D_{e})} = \\frac{k_{B}T}{2a^{2}D_{e}}$$\n\n**Part 3: Mean-Square Fluctuation in the Quartic Approximation, $\\sigma_{M}^{2}$**\n\nWe approximate the Morse potential via a Taylor series in $x = r - r_{0}$ up to the fourth order:\n$$U_{b}(r) \\approx U_{b}(r_0) + U_{b}'(r_0)x + \\frac{U_{b}''(r_0)}{2!}x^2 + \\frac{U_{b}'''(r_0)}{3!}x^3 + \\frac{U_{b}''''(r_0)}{4!}x^4$$\nAt the minimum $r_{0}$, $U_{b}(r_0) = 0$ and $U_{b}'(r_0) = 0$. The potential becomes $U_{approx}(x) = c_{2}x^{2} + c_{3}x^{3} + c_{4}x^{4}$. We need the third and fourth derivatives of $U_b(r)$:\n$$U_{b}'''(r) = 2a^2D_{e}\\frac{\\partial}{\\partial r}\\left(2\\exp(-2a(r-r_0)) - \\exp(-a(r-r_0))\\right) = 2a^2D_{e}\\left(-4a\\exp(-2a(r-r_0)) + a\\exp(-a(r-r_0))\\right)$$\n$$U_{b}''''(r) = 2a^3D_{e}\\frac{\\partial}{\\partial r}\\left(\\exp(-a(r-r_0)) - 4\\exp(-2a(r-r_0))\\right) = 2a^3D_{e}\\left(-a\\exp(-a(r-r_0)) + 8a\\exp(-2a(r-r_0))\\right)$$\nEvaluating at $r=r_{0}$:\n$$U_{b}'''(r_0) = 2a^3D_{e}(1 - 4) = -6a^3D_{e}$$\n$$U_{b}''''(r_0) = 2a^4D_{e}(-1 + 8) = 14a^4D_{e}$$\nThe coefficients are:\n$$c_{2} = \\frac{U_{b}''(r_0)}{2} = \\frac{2a^2D_{e}}{2} = a^2D_{e}$$\n$$c_{3} = \\frac{U_{b}'''(r_0)}{6} = \\frac{-6a^3D_{e}}{6} = -a^3D_{e}$$\n$$c_{4} = \\frac{U_{b}''''(r_0)}{24} = \\frac{14a^4D_{e}}{24} = \\frac{7}{12}a^4D_{e}$$\nThe unperturbed potential is the harmonic part $U_0(x) = c_2 x^2$, and the perturbation is $U_{pert}(x) = c_3 x^3 + c_4 x^4$.\nWe compute the expectation value $\\sigma_{M}^{2} = \\langle x^{2} \\rangle$ using the partition function $Z$:\n$$\\sigma_{M}^{2} = -\\frac{1}{\\beta} \\frac{\\partial}{\\partial c_{2}} \\ln Z, \\quad \\text{where} \\quad Z = \\int_{-\\infty}^{\\infty} \\exp(-\\beta(c_2 x^2 + c_3 x^3 + c_4 x^4)) \\,dx$$\nUsing the cumulant expansion for $\\ln Z$:\n$$\\ln Z \\approx \\ln Z_0 + \\ln \\langle \\exp(-\\beta U_{pert}) \\rangle_0 \\approx \\ln Z_0 - \\beta \\langle U_{pert} \\rangle_0 + \\frac{\\beta^2}{2} (\\langle U_{pert}^2 \\rangle_0 - \\langle U_{pert} \\rangle_0^2)$$\nwhere $\\langle \\cdot \\rangle_0$ denotes an average over the harmonic distribution $\\exp(-\\beta c_2 x^2)$.\nOdd moments are zero, so $\\langle x^3 \\rangle_0 = 0$. Thus, $\\langle U_{pert} \\rangle_0 = c_4 \\langle x^4 \\rangle_0$.\nAlso, $\\langle U_{pert}^2 \\rangle_0 = \\langle (c_3 x^3 + c_4 x^4)^2 \\rangle_0 = c_3^2 \\langle x^6 \\rangle_0 + c_4^2 \\langle x^8 \\rangle_0$.\n$$\\ln Z \\approx \\ln Z_0 - \\beta c_4 \\langle x^4 \\rangle_0 + \\frac{\\beta^2}{2} c_3^2 \\langle x^6 \\rangle_0 - \\frac{\\beta^2}{2} c_4^2 \\langle x^4 \\rangle_0^2 + \\dots$$\nRetaining terms that will contribute corrections up to $\\mathcal{O}((k_B T)^2) = \\mathcal{O}(\\beta^{-2})$ to $\\langle x^2 \\rangle$, we can neglect the $c_4^2$ term.\n$$\\sigma_{M}^{2} = -\\frac{1}{\\beta} \\frac{\\partial}{\\partial c_2} \\left[ \\ln Z_0 - \\beta c_4 \\langle x^4 \\rangle_0 + \\frac{\\beta^2}{2} c_3^2 \\langle x^6 \\rangle_0 \\right]$$\nThe unperturbed part gives $\\sigma_H^2$: $-\\frac{1}{\\beta} \\frac{\\partial \\ln Z_0}{\\partial c_2} = \\langle x^2 \\rangle_0 = \\frac{1}{2\\beta c_2}$. We use $\\frac{\\partial \\langle x^{2n} \\rangle_0}{\\partial c_2} = -n \\frac{\\langle x^{2n} \\rangle_0}{c_2}$.\n$$\\sigma_{M}^{2} \\approx \\langle x^2 \\rangle_0 + c_4 \\frac{\\partial \\langle x^4 \\rangle_0}{\\partial c_2} - \\frac{\\beta c_3^2}{2} \\frac{\\partial \\langle x^6 \\rangle_0}{\\partial c_2} = \\langle x^2 \\rangle_0 + c_4 \\left(-2 \\frac{\\langle x^4 \\rangle_0}{c_2}\\right) - \\frac{\\beta c_3^2}{2} \\left(-3 \\frac{\\langle x^6 \\rangle_0}{c_2}\\right)$$\n$$\\sigma_{M}^{2} \\approx \\langle x^2 \\rangle_0 - \\frac{2c_4}{c_2} \\langle x^4 \\rangle_0 + \\frac{3\\beta c_3^2}{2c_2} \\langle x^6 \\rangle_0$$\nUsing the Gaussian moments $\\langle x^4 \\rangle_0 = 3(\\langle x^2 \\rangle_0)^2$ and $\\langle x^6 \\rangle_0 = 15(\\langle x^2 \\rangle_0)^3$:\n$$\\sigma_{M}^{2} \\approx \\langle x^2 \\rangle_0 - \\frac{6c_4}{c_2}(\\langle x^2 \\rangle_0)^2 + \\frac{45\\beta c_3^2}{2c_2}(\\langle x^2 \\rangle_0)^3$$\n\n**Part 4: Ratio $\\sigma_{M}^{2}/\\sigma_{H}^{2}$**\n\nDividing by $\\sigma_H^2 = \\langle x^2 \\rangle_0$:\n$$\\frac{\\sigma_{M}^{2}}{\\sigma_{H}^{2}} \\approx 1 - \\frac{6c_4}{c_2}\\langle x^2 \\rangle_0 + \\frac{45\\beta c_3^2}{2c_2}(\\langle x^2 \\rangle_0)^2$$\nSubstitute $\\langle x^2 \\rangle_0 = \\frac{1}{2\\beta c_2}$:\n$$\\frac{\\sigma_{M}^{2}}{\\sigma_{H}^{2}} \\approx 1 - \\frac{6c_4}{c_2} \\frac{1}{2\\beta c_2} + \\frac{45\\beta c_3^2}{2c_2} \\left(\\frac{1}{2\\beta c_2}\\right)^2 = 1 - \\frac{3c_4}{\\beta c_2^2} + \\frac{45c_3^2}{8\\beta c_2^3}$$\nNow, substitute the expressions for the coefficients $c_2, c_3, c_4$:\n$$c_2 = a^2D_e, \\quad c_3 = -a^3D_e, \\quad c_4 = \\frac{7}{12}a^4D_e$$\nThe correction term is:\n$$-\\frac{3}{\\beta} \\frac{\\frac{7}{12}a^4D_e}{(a^2D_e)^2} + \\frac{45}{8\\beta} \\frac{(-a^3D_e)^2}{(a^2D_e)^3} = -\\frac{7}{4\\beta} \\frac{a^4D_e}{a^4D_e^2} + \\frac{45}{8\\beta} \\frac{a^6D_e^2}{a^6D_e^3}$$\n$$= -\\frac{7}{4\\beta D_e} + \\frac{45}{8\\beta D_e} = \\frac{-14 + 45}{8\\beta D_e} = \\frac{31}{8\\beta D_e}$$\nSubstituting $\\beta = 1/(k_B T)$:\n$$\\frac{\\sigma_{M}^{2}}{\\sigma_{H}^{2}} \\approx 1 + \\frac{31 k_B T}{8D_e}$$\nThis is the final expression for the ratio.\n\nThe final answer requires both this ratio and the force $F(r)$ from Part 1.\n$F(r) = 2aD_{e} \\left(\\exp(-2a\\,(r - r_{0})) - \\exp(-a\\,(r - r_{0}))\\right)$\n$\\frac{\\sigma_{M}^{2}}{\\sigma_{H}^{2}} = 1 + \\frac{31 k_B T}{8D_e}$", "answer": "$$ \\boxed{ \\begin{pmatrix} 2aD_{e} \\left(\\exp(-2a(r - r_{0})) - \\exp(-a(r - r_{0}))\\right)  1 + \\frac{31 k_{B} T}{8 D_{e}} \\end{pmatrix} } $$", "id": "3413996"}, {"introduction": "Moving beyond simple bonds, the conformational preferences of molecules are dictated by torsional potentials, which describe rotation around bonds. This computational exercise guides you through a core task in force field development: parameterizing a torsional potential from a given energy scan. By fitting a flexible Fourier series to hypothetical data for butane, you will learn how to translate reference energy profiles into a functional form and use it within a statistical mechanics framework to predict temperature-dependent conformer populations [@problem_id:3414003].", "problem": "You are given a one-dimensional torsional energy scan for butane around a central carbon–carbon bond. The scan consists of measured relative potential energies as a function of the dihedral angle. The angle domain is periodic with period $2\\pi$, the torsional potential is a function of the dihedral angle $\\phi$, and the measured energies are in kilojoules per mole. The angle values are provided in degrees and must be converted to radians for any trigonometric calculation.\n\nStarting from the facts that (i) torsional potentials are periodic functions of the dihedral angle and thus are representable by a trigonometric series, and (ii) the Boltzmann distribution gives the relative probability of configurations as $p(\\phi) \\propto \\exp(-E(\\phi)/(RT))$ for energy $E(\\phi)$ at temperature $T$, build a computational method to fit a truncated Fourier representation and then compute conformer populations. Your approach must be grounded in the orthogonality of trigonometric functions and in least-squares fitting, without assuming any particular functional form beyond a general trigonometric series.\n\nData and requirements:\n- Let the dihedral angles $\\phi$ (in degrees) and corresponding relative energies $E$ (in kilojoules per mole) be:\n  - $\\phi \\in \\{0,30,60,90,120,150,180,210,240,270,300,330\\}$ degrees\n  - $E(\\phi) \\in \\{19.0,10.0,3.8,8.0,6.5,2.0,0.0,2.0,6.5,8.0,3.8,10.0\\}$ kilojoules per mole\n- Model the energy by a truncated trigonometric series up to order $n_{\\max}=3$:\n  $$E(\\phi) \\approx c_{0} + \\sum_{n=1}^{n_{\\max}} \\left(a_{n}\\cos(n\\phi) + b_{n}\\sin(n\\phi)\\right),$$\n  where $\\phi$ is in radians and the coefficients $c_{0}$, $a_{n}$, and $b_{n}$ are to be determined by linear least squares.\n- Express the fitted series in amplitude–phase form. For each $n \\in \\{1,2,3\\}$, define the amplitude $V_{n}$ and phase $\\gamma_{n}$ by the relationships that make the series equivalent to\n  $$E(\\phi) \\approx c_{0} + \\sum_{n=1}^{3} V_{n}\\cos\\!\\left(n\\phi - \\gamma_{n}\\right).$$\n  Report $V_{n}$ in kilojoules per mole and $\\gamma_{n}$ in radians.\n- Using the fitted $E(\\phi)$, compute conformer populations by discrete Boltzmann sampling on a uniform grid of angles with $1^\\circ$ resolution over $[0^\\circ,360^\\circ)$, converting angles to radians for energy evaluation. Use the Boltzmann factor $\\exp(-E(\\phi)/(RT))$, where the molar gas constant $R$ must be taken as $R=8.314462618\\times 10^{-3}$ kilojoules per mole per kelvin.\n- Define three conformer families by angular windows in degrees:\n  - trans: $\\phi \\in [165^{\\circ},195^{\\circ}]$\n  - $gauche^{+}$: $\\phi \\in [45^{\\circ},75^{\\circ}]$\n  - $gauche^{-}$: $\\phi \\in [285^{\\circ},315^{\\circ}]$\n  For each family, compute the population as the sum of Boltzmann weights within its window divided by the sum of Boltzmann weights over the full grid.\n- Angles must be treated in radians inside trigonometric functions; energies must be in kilojoules per mole; temperature must be in kelvin; phases $\\gamma_{n}$ must be reported in radians. Populations must be returned as decimal fractions.\n\nTest suite:\n- Use the single specified energy scan above and evaluate conformer populations at the following temperatures $T$ (kelvin): $298.15$, $50.0$, $1000.0$, and $1.0$.\n- For each test case (temperature $T$), output a list containing ten values in the following order:\n  - $V_{1}$, $V_{2}$, $V_{3}$ (kilojoules per mole)\n  - $\\gamma_{1}$, $\\gamma_{2}$, $\\gamma_{3}$ (radians)\n  - $p_{\\mathrm{trans}}$, $p_{\\mathrm{gauche}^{+}}$, $p_{\\mathrm{gauche}^{-}}$ (decimal fractions)\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element of the list corresponds to one temperature and is itself the list described above. For example, the format must be like:\n  $$[\\,[V_{1},V_{2},V_{3},\\gamma_{1},\\gamma_{2},\\gamma_{3},p_{\\mathrm{trans}},p_{\\mathrm{gauche}^{+}},p_{\\mathrm{gauche}^{-}}],\\ldots\\,].$$", "solution": "The problem requires us to develop a computational model for the torsional potential energy of butane based on a discrete set of energy-angle data points. This involves three principal steps: first, fitting the data to a physically motivated mathematical function; second, transforming the fitted parameters into a physically intuitive representation; and third, using the resulting potential energy function to compute equilibrium conformer populations via statistical mechanics.\n\nThe problem statement has been validated and is deemed scientifically sound, well-posed, and computationally tractable. All necessary data, constants, and procedural definitions are provided. We may therefore proceed with a complete solution.\n\n### 1. Modeling the Torsional Potential: The Fourier Series\n\nThe potential energy $E$ associated with torsion around a chemical bond is a periodic function of the dihedral angle $\\phi$, with a period of $2\\pi$ radians ($360^\\circ$). A powerful and fundamental mathematical result, Fourier's theorem, states that any well-behaved periodic function can be represented as an infinite sum of sine and cosine functions, known as a Fourier series. For practical modeling in chemistry, this series is truncated at a finite order, $n_{\\max}$, which is sufficient to capture the essential features of the potential energy surface.\n\nThe problem specifies a truncated Fourier series model up to order $n_{\\max}=3$:\n$$E(\\phi) \\approx c_{0} + \\sum_{n=1}^{3} \\left(a_{n}\\cos(n\\phi) + b_{n}\\sin(n\\phi)\\right)$$\nHere, $\\phi$ must be in radians. The term $c_0$ is the average energy over one full rotation. The coefficients $a_n$ and $b_n$ determine the shape of the potential. The index $n$ corresponds to the multiplicity of the torsional barrier; for example, the $n=3$ term would describe a 3-fold rotation like that in ethane, while the $n=1$ and $n=2$ terms capture the interactions that define the anti and gauche conformations in butane.\n\n### 2. Parameter Determination via Linear Least-Squares\n\nThe model is linear with respect to the unknown coefficients $\\mathbf{x} = [c_0, a_1, b_1, a_2, b_2, a_3, b_3]^T$. Given a set of $M$ data points $(\\phi_i, E_i)$, we seek the coefficients that minimize the discrepancy between the model and the data. This is a classic linear least-squares problem. We can express the system in matrix form:\n$$ \\mathbf{A} \\mathbf{x} \\approx \\mathbf{E} $$\nwhere $\\mathbf{E}$ is the vector of $M$ observed energies, and $\\mathbf{A}$ is the $M \\times 7$ design matrix, where each row corresponds to a data point $\\phi_i$ and each column corresponds to a basis function:\n$$ \\mathbf{A}_{i,j} = \\begin{cases} 1  j=0 \\\\ \\cos(n\\phi_i)  j=2n-1, n \\in \\{1,2,3\\} \\\\ \\sin(n\\phi_i)  j=2n, n \\in \\{1,2,3\\} \\end{cases} $$\nFor our specific data, we have $M=12$ angle-energy pairs. The angles $\\phi$ given in degrees must first be converted to radians for use in the trigonometric functions. The least-squares solution $\\mathbf{x}$ minimizes the sum of squared residuals, $||\\mathbf{A}\\mathbf{x} - \\mathbf{E}||^2$. This solution is found by solving the normal equations:\n$$ \\mathbf{x} = (\\mathbf{A}^T\\mathbf{A})^{-1}\\mathbf{A}^T\\mathbf{E} $$\nThis calculation will be performed numerically. Due to the symmetry of the provided energy data ($E(\\phi) = E(2\\pi - \\phi)$), we anticipate that the coefficients of the odd sine functions, $b_n$, will be close to zero.\n\n### 3. Amplitude–Phase Representation\n\nThe form $a_{n}\\cos(n\\phi) + b_{n}\\sin(n\\phi)$ is mathematically convenient but less physically intuitive than the amplitude–phase form, $V_{n}\\cos(n\\phi - \\gamma_{n})$. The parameter $V_n$ represents the amplitude (or \"height\") of the $n$-th torsional barrier component, and $\\gamma_n$ is its phase angle, which indicates the dihedral angle at which this component has its maximum value.\n\nUsing the trigonometric identity $\\cos(A-B) = \\cos A \\cos B + \\sin A \\sin B$, we can write:\n$$ V_{n}\\cos(n\\phi - \\gamma_{n}) = (V_{n}\\cos\\gamma_{n})\\cos(n\\phi) + (V_{n}\\sin\\gamma_{n})\\sin(n\\phi) $$\nBy comparing coefficients with $a_{n}\\cos(n\\phi) + b_{n}\\sin(n\\phi)$, we establish the relationships:\n$$ a_n = V_n \\cos\\gamma_n $$\n$$ b_n = V_n \\sin\\gamma_n $$\nThese equations are solved for $V_n$ and $\\gamma_n$:\n$$ V_n = \\sqrt{a_n^2 + b_n^2} $$\n$$ \\gamma_n = \\mathrm{atan2}(b_n, a_n) $$\nThe two-argument arctangent function, $\\mathrm{atan2}(y,x)$, is essential as it correctly determines the quadrant of the angle $\\gamma_n$, yielding a value in $(-\\pi, \\pi]$. The amplitude $V_n$ will be in units of kilojoules per mole, and the phase $\\gamma_n$ will be in radians.\n\n### 4. Conformer Populations from the Boltzmann Distribution\n\nThe fundamental principle connecting potential energy to conformational distribution at thermal equilibrium is the Boltzmann distribution. The probability $P(\\phi)$ of observing a system at a particular dihedral angle $\\phi$ is proportional to the Boltzmann factor:\n$$ P(\\phi) \\propto e^{-E(\\phi) / (RT)} $$\nwhere $E(\\phi)$ is the potential energy of that conformation, $T$ is the absolute temperature in kelvin, and $R$ is the molar gas constant ($R = 8.314462618 \\times 10^{-3} \\, \\text{kJ}\\,\\text{mol}^{-1}\\text{K}^{-1}$).\n\nTo calculate normalized probabilities, or populations, we must integrate this probability density over all possible angles. Computationally, we approximate this by summing over a fine, uniform grid of angles. The normalization constant is the partition function, $Q$, defined as the sum of all Boltzmann weights over the complete state space:\n$$ Q = \\sum_{j=0}^{N-1} e^{-E_{fit}(\\phi_j) / (RT)} $$\nwhere the sum is over a grid of $N$ angles covering the full circle, $[0^\\circ, 360^\\circ)$.\n\nThe population of a specific conformer (e.g., trans, gauche) is the sum of the Boltzmann weights for all angles within that conformer's defined angular window, divided by the total partition function $Q$:\n$$ p_{\\text{conf}} = \\frac{1}{Q} \\sum_{\\phi_j \\in \\text{window}} e^{-E_{fit}(\\phi_j) / (RT)} $$\nThis calculation is performed for each specified temperature. Lowering the temperature will cause the system to preferentially occupy the lowest-energy states, leading to highly skewed populations. Conversely, at very high temperatures, the term $E(\\phi)/(R T)$ approaches zero, causing all Boltzmann weights to approach $1$, and the populations become proportional to the size of their angular windows, indicating near-equal probability for all conformations.\n\nThe entire procedure provides a robust bridge from discrete experimental or computational data to a continuous, physically meaningful model of molecular conformation and dynamics.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the butane torsional potential problem by fitting a Fourier series to energy data\n    and calculating conformer populations at various temperatures.\n    \"\"\"\n    \n    # Step 1: Extract Givens\n    # Data from the problem statement\n    phi_deg = np.array([0, 30, 60, 90, 120, 150, 180, 210, 240, 270, 300, 330])\n    energies = np.array([19.0, 10.0, 3.8, 8.0, 6.5, 2.0, 0.0, 2.0, 6.5, 8.0, 3.8, 10.0])\n    \n    # Constants and definitions\n    R = 8.314462618e-3  # kJ/(mol*K)\n    n_max = 3\n    temperatures = [298.15, 50.0, 1000.0, 1.0]\n\n    # Convert angles from degrees to radians for trigonometric calculations\n    phi_rad = np.deg2rad(phi_deg)\n\n    # Step 2: Perform Linear Least-Squares Fit\n    # Construct the design matrix A for the model:\n    # E(phi) = c0 + a1*cos(phi) + b1*sin(phi) + ...\n    # The columns of A are the basis functions: 1, cos(phi), sin(phi), cos(2*phi), ...\n    A = np.zeros((len(phi_rad), 1 + 2 * n_max))\n    A[:, 0] = 1.0\n    for n in range(1, n_max + 1):\n        A[:, 2*n - 1] = np.cos(n * phi_rad)\n        A[:, 2*n] = np.sin(n * phi_rad)\n    \n    # Solve the linear system Ax = b for the coefficients x, where b is the energy vector.\n    # np.linalg.lstsq returns the solution vector, residuals, rank, and singular values.\n    # We only need the solution vector of coefficients.\n    coeffs, _, _, _ = np.linalg.lstsq(A, energies, rcond=None)\n    \n    c0 = coeffs[0]\n    a_coeffs = coeffs[1::2]\n    b_coeffs = coeffs[2::2]\n\n    # Step 3: Convert to Amplitude-Phase Form\n    # V_n = sqrt(a_n^2 + b_n^2)\n    # gamma_n = atan2(b_n, a_n)\n    V_n = np.sqrt(a_coeffs**2 + b_coeffs**2)\n    gamma_n = np.arctan2(b_coeffs, a_coeffs)\n    \n    V1, V2, V3 = V_n[0], V_n[1], V_n[2]\n    gamma1, gamma2, gamma3 = gamma_n[0], gamma_n[1], gamma_n[2]\n\n    # Step 4: Calculate Conformer Populations for each temperature\n    \n    # Define the fitted energy function\n    def E_fit(phi_rad_grid):\n        energy = c0\n        for n in range(1, n_max + 1):\n            energy += a_coeffs[n-1] * np.cos(n * phi_rad_grid) + b_coeffs[n-1] * np.sin(n * phi_rad_grid)\n        return energy\n        \n    # Create a fine grid for numerical integration (Boltzmann summation)\n    fine_grid_deg = np.arange(0, 360, 1)\n    fine_grid_rad = np.deg2rad(fine_grid_deg)\n    \n    # Calculate energies on the fine grid\n    E_values = E_fit(fine_grid_rad)\n    \n    # Define conformer windows\n    trans_indices = (fine_grid_deg = 165)  (fine_grid_deg = 195)\n    gauche_p_indices = (fine_grid_deg = 45)  (fine_grid_deg = 75)\n    gauche_m_indices = (fine_grid_deg = 285)  (fine_grid_deg = 315)\n    \n    all_results = []\n    \n    for T in temperatures:\n        # Calculate Boltzmann weights\n        # Avoid potential overflow/underflow by subtracting min energy, which cancels out in population calculation.\n        E_ref = E_values - np.min(E_values)\n        weights = np.exp(-E_ref / (R * T))\n        \n        # Calculate Partition Function Q (normalization constant)\n        Q = np.sum(weights)\n        \n        # Calculate sum of weights within each conformer window\n        W_trans = np.sum(weights[trans_indices])\n        W_gauche_p = np.sum(weights[gauche_p_indices])\n        W_gauche_m = np.sum(weights[gauche_m_indices])\n        \n        # Calculate populations\n        p_trans = W_trans / Q\n        p_gauche_p = W_gauche_p / Q\n        p_gauche_m = W_gauche_m / Q\n        \n        # Assemble the results for this temperature\n        # The fitted parameters V_n and gamma_n are independent of temperature\n        current_result = [\n            V1, V2, V3,\n            gamma1, gamma2, gamma3,\n            p_trans, p_gauche_p, p_gauche_m\n        ]\n        all_results.append(current_result)\n\n    # Step 5: Format and print the final output\n    # The required format is a string representation of a list of lists.\n    # Ex: [[...], [...], ...]\n    results_str = [str(res) for res in all_results]\n    print(f\"[{','.join(results_str)}]\")\n\nsolve()\n```", "id": "3414003"}, {"introduction": "The accurate and efficient calculation of non-bonded interactions is a central challenge in molecular simulation, often requiring sophisticated functional forms. This advanced practice delves into the construction of a multi-resolution potential, where a short-range Buckingham potential is smoothly joined to a long-range dispersion expansion. You will derive a switching function from first principles to ensure the continuity of energy and forces—a critical requirement for stable numerical integration—thereby gaining hands-on experience in the intricate design of modern, high-performance force fields [@problem_id:3414034].", "problem": "You are asked to construct and implement a composite two-body potential energy model suitable for Molecular Dynamics (MD) using a multi-resolution approach. The short-range interaction should be modeled by a Buckingham potential, while the long-range interaction uses a finite dispersion expansion. The two regimes must be blended by a smooth scalar switching function to ensure continuity of the potential and its derivatives.\n\nYou must proceed from fundamental definitions and construct the switching function purely from boundary smoothness conditions, without assuming a standard template. The final program must compute the total potential and corresponding radial force for a provided test suite. All distances are in nanometers (nm), energies in kilojoules per mole (kJ/mol), and forces in kilojoules per mole per nanometer (kJ mol^{-1} nm^{-1}). Angles do not appear. All numerical results must be rounded to eight decimal places.\n\nDefinitions and requirements:\n- The short-range potential is the Buckingham form\n  $$U_{\\mathrm{short}}(r) = A \\exp\\!\\left(-\\frac{r}{\\rho}\\right) - \\frac{C_6}{r^6} - \\frac{C_8}{r^8},$$\n  where $A  0$ and $\\rho  0$ control the repulsive exponential wall, and $C_6, C_8  0$ are dispersion coefficients.\n- The long-range dispersion potential is a truncated even inverse-power series\n  $$U_{\\mathrm{long}}(r) = - \\frac{C_6}{r^6} - \\frac{C_8}{r^8} - \\frac{C_{10}}{r^{10}},$$\n  where $C_{10}  0$ is an additional dispersion coefficient.\n- Define a switching interval $[r_{\\mathrm{sw}}, r_{\\mathrm{c}}]$ with $0  r_{\\mathrm{sw}}  r_{\\mathrm{c}}$. Let $s(r)$ be a scalar switching function such that:\n  - $s(r) = 1$ for $r \\le r_{\\mathrm{sw}}$,\n  - $s(r) = 0$ for $r \\ge r_{\\mathrm{c}}$,\n  - $s(r)$ is at least twice continuously differentiable on $\\mathbb{R}^{+}$ with $s'(r_{\\mathrm{sw}}) = s''(r_{\\mathrm{sw}}) = 0$ and $s'(r_{\\mathrm{c}}) = s''(r_{\\mathrm{c}}) = 0$.\n- Construct $s(r)$ on the open interval $(r_{\\mathrm{sw}}, r_{\\mathrm{c}})$ as a polynomial in the normalized coordinate\n  $$x = \\frac{r - r_{\\mathrm{sw}}}{r_{\\mathrm{c}} - r_{\\mathrm{sw}}},$$\n  with $x \\in (0,1)$ on this interval, such that it satisfies the six boundary conditions above. Do not assume any pre-existing closed form; derive the polynomial coefficients from the boundary conditions.\n- Define the composite potential\n  $$U_{\\mathrm{tot}}(r) = s(r)\\,U_{\\mathrm{short}}(r) + \\bigl(1 - s(r)\\bigr)\\,U_{\\mathrm{long}}(r).$$\n- Define the corresponding radial force by Newton’s second law as\n  $$F(r) = -\\frac{dU_{\\mathrm{tot}}}{dr}.$$\n  You must derive and implement an expression for $\\frac{dU_{\\mathrm{tot}}}{dr}$ using the product rule and the chain rule, including $s'(r)$.\n\nParameter values for the test suite:\n- $A = 1000\\,\\mathrm{kJ/mol}$,\n- $\\rho = 0.35\\,\\mathrm{nm}$,\n- $C_6 = 0.005\\,\\mathrm{kJ\\,nm^6/mol}$,\n- $C_8 = 0.0001\\,\\mathrm{kJ\\,nm^8/mol}$,\n- $C_{10} = 0.000002\\,\\mathrm{kJ\\,nm^{10}/mol}$,\n- $r_{\\mathrm{sw}} = 0.4\\,\\mathrm{nm}$,\n- $r_{\\mathrm{c}} = 0.8\\,\\mathrm{nm}$.\n\nTest radii:\n- $r = 0.35\\,\\mathrm{nm}$,\n- $r = 0.40\\,\\mathrm{nm}$,\n- $r = 0.60\\,\\mathrm{nm}$,\n- $r = 0.80\\,\\mathrm{nm}$,\n- $r = 1.00\\,\\mathrm{nm}$.\n\nTasks:\n- From the boundary conditions on $s(r)$, derive the coefficients of a minimal-degree polynomial $s(x)$ on $x \\in (0,1)$ that satisfies $s(0) = 1$, $s(1) = 0$, and $s'(0) = s''(0) = s'(1) = s''(1) = 0$. Express $s'(r)$ in terms of $x$ and the interval length $(r_{\\mathrm{c}} - r_{\\mathrm{sw}})$ by the chain rule.\n- Derive expressions for $\\frac{dU_{\\mathrm{short}}}{dr}$ and $\\frac{dU_{\\mathrm{long}}}{dr}$ and then derive $\\frac{dU_{\\mathrm{tot}}}{dr}$ using the product rule.\n- Implement a program that:\n  1. Computes $U_{\\mathrm{tot}}(r)$ and $F(r)$ for each test $r$ using the parameters above.\n  2. Rounds each number to eight decimal places.\n  3. Produces a single line of output containing a comma-separated list enclosed in square brackets. The list must contain, in order, the potential followed by the force for each $r$ in the test set, i.e., $[U_{\\mathrm{tot}}(0.35),F(0.35),U_{\\mathrm{tot}}(0.40),F(0.40),\\dots]$, all in the specified units.\n\nScientific realism constraints:\n- Only evaluate at $r  0$ to avoid singularities of the inverse powers.\n- Ensure that the switching function and its derivatives are well-defined and finite at the boundaries.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[result1,result2,...]\").", "solution": "The problem statement is critically evaluated and found to be valid. It is scientifically grounded in the principles of molecular mechanics, mathematically well-posed, and provides a complete and consistent set of definitions and parameters.\n\nThe task is to construct a composite potential energy function, $U_{\\mathrm{tot}}(r)$, and its corresponding force, $F(r)$, by smoothly joining a short-range Buckingham potential, $U_{\\mathrm{short}}(r)$, and a long-range dispersion potential, $U_{\\mathrm{long}}(r)$, using a switching function, $s(r)$. We must first derive the analytical form of $s(r)$ from a set of boundary conditions, then derive the expressions for $U_{\\mathrm{tot}}(r)$ and $F(r)$, and finally implement these to compute values for a given test suite.\n\nThe provided parameters are:\n- Repulsive term constant: $A = 1000\\,\\mathrm{kJ/mol}$\n- Repulsive term range: $\\rho = 0.35\\,\\mathrm{nm}$\n- Dispersion coefficients: $C_6 = 0.005\\,\\mathrm{kJ\\,nm^6/mol}$, $C_8 = 0.0001\\,\\mathrm{kJ\\,nm^8/mol}$, $C_{10} = 0.000002\\,\\mathrm{kJ\\,nm^{10}/mol}$\n- Switching interval: $[r_{\\mathrm{sw}}, r_{\\mathrm{c}}] = [0.4\\,\\mathrm{nm}, 0.8\\,\\mathrm{nm}]$\n\nThe potentials are defined as:\n$$U_{\\mathrm{short}}(r) = A \\exp\\!\\left(-\\frac{r}{\\rho}\\right) - \\frac{C_6}{r^6} - \\frac{C_8}{r^8}$$\n$$U_{\\mathrm{long}}(r) = - \\frac{C_6}{r^6} - \\frac{C_8}{r^8} - \\frac{C_{10}}{r^{10}}$$\n\nThe composite potential is:\n$$U_{\\mathrm{tot}}(r) = s(r)\\,U_{\\mathrm{short}}(r) + \\bigl(1 - s(r)\\bigr)\\,U_{\\mathrm{long}}(r)$$\n\nThe force is:\n$$F(r) = -\\frac{dU_{\\mathrm{tot}}}{dr}$$\n\nThe procedure is as follows:\n1. Derivation of the Switching Function, $s(r)$.\n2. Derivation of the Composite Potential, $U_{\\mathrm{tot}}(r)$.\n3. Derivation of the Radial Force, $F(r)$.\n4. Computation for the specified test cases.\n\n**1. Derivation of the Switching Function, $s(r)$**\n\nThe switching function $s(r)$ is defined on the interval $[r_{\\mathrm{sw}}, r_{\\mathrm{c}}]$. It is constructed using a normalized coordinate $x = \\frac{r - r_{\\mathrm{sw}}}{r_{\\mathrm{c}} - r_{\\mathrm{sw}}}$, which maps $r \\in [r_{\\mathrm{sw}}, r_{\\mathrm{c}}]$ to $x \\in [0, 1]$. The function must satisfy six boundary conditions to ensure it and its first two derivatives are continuous and zero at the boundaries of the switching region:\n- At $r = r_{\\mathrm{sw}}$ (or $x=0$): $s(0) = 1$, $s'(0)=0$, $s''(0)=0$.\n- At $r = r_{\\mathrm{c}}$ (or $x=1$): $s(1) = 0$, $s'(1)=0$, $s''(1)=0$.\nNote that these derivatives are with respect to $x$. We will use the chain rule for derivatives with respect to $r$.\n\nA polynomial of degree $5$, $s(x) = a_5 x^5 + a_4 x^4 + a_3 x^3 + a_2 x^2 + a_1 x + a_0$, has six coefficients and is the minimal degree polynomial capable of satisfying six independent conditions.\nIts derivatives are:\n$$s'(x) = 5 a_5 x^4 + 4 a_4 x^3 + 3 a_3 x^2 + 2 a_2 x + a_1$$\n$$s''(x) = 20 a_5 x^3 + 12 a_4 x^2 + 6 a_3 x + 2 a_2$$\n\nApplying the conditions at $x=0$:\n- $s(0) = a_0 = 1$\n- $s'(0) = a_1 = 0$\n- $s''(0) = 2a_2 = 0 \\implies a_2 = 0$\n\nSo far, $s(x) = a_5 x^5 + a_4 x^4 + a_3 x^3 + 1$. Applying the conditions at $x=1$:\n1. $s(1) = a_5 + a_4 + a_3 + 1 = 0 \\implies a_5 + a_4 + a_3 = -1$\n2. $s'(1) = 5a_5 + 4a_4 + 3a_3 = 0$\n3. $s''(1) = 20a_5 + 12a_4 + 6a_3 = 0 \\implies 10a_5 + 6a_4 + 3a_3 = 0$\n\nThis is a system of three linear equations for $a_3, a_4, a_5$. Subtracting (2) from (3):\n$$(10a_5 - 5a_5) + (6a_4 - 4a_4) + (3a_3 - 3a_3) = 0 - 0 \\implies 5a_5 + 2a_4 = 0 \\implies a_4 = -\\frac{5}{2}a_5$$\nSubstitute $a_4$ into (2):\n$$5a_5 + 4\\left(-\\frac{5}{2}a_5\\right) + 3a_3 = 0 \\implies 5a_5 - 10a_5 + 3a_3 = 0 \\implies -5a_5 + 3a_3 = 0 \\implies a_3 = \\frac{5}{3}a_5$$\nSubstitute $a_3$ and $a_4$ into (1):\n$$a_5 + \\left(-\\frac{5}{2}a_5\\right) + \\left(\\frac{5}{3}a_5\\right) = -1 \\implies \\left(\\frac{6 - 15 + 10}{6}\\right)a_5 = -1 \\implies \\frac{1}{6}a_5 = -1 \\implies a_5 = -6$$\nBack-substituting, we find the other coefficients:\n$$a_4 = -\\frac{5}{2}(-6) = 15$$\n$$a_3 = \\frac{5}{3}(-6) = -10$$\nThus, the polynomial for the switching region is:\n$$s(x) = -6x^5 + 15x^4 - 10x^3 + 1$$\nThe full definition of $s(r)$ is:\n$$\ns(r) =\n\\begin{cases}\n1  \\text{if } r \\le r_{\\mathrm{sw}} \\\\\n-6x^5 + 15x^4 - 10x^3 + 1, \\quad x = \\frac{r - r_{\\mathrm{sw}}}{r_{\\mathrm{c}} - r_{\\mathrm{sw}}}  \\text{if } r_{\\mathrm{sw}}  r  r_{\\mathrm{c}} \\\\\n0  \\text{if } r \\ge r_{\\mathrm{c}}\n\\end{cases}\n$$\nThe derivative with respect to $r$, $s'(r)$, is required for the force calculation. Using the chain rule, $s'(r) = \\frac{ds}{dx} \\frac{dx}{dr}$.\n$$\\frac{dx}{dr} = \\frac{1}{r_{\\mathrm{c}} - r_{\\mathrm{sw}}}$$\n$$\\frac{ds}{dx} = -30x^4 + 60x^3 - 30x^2$$\nSo, for $r_{\\mathrm{sw}}  r  r_{\\mathrm{c}}$,\n$$s'(r) = \\frac{1}{r_{\\mathrm{c}} - r_{\\mathrm{sw}}} (-30x^4 + 60x^3 - 30x^2)$$\nand $s'(r) = 0$ outside this interval.\n\n**2. Derivation of the Composite Potential, $U_{\\mathrm{tot}}(r)$**\n\nStarting from the definition of $U_{\\mathrm{tot}}(r)$:\n$$U_{\\mathrm{tot}}(r) = s(r)\\left(A e^{-r/\\rho} - \\frac{C_6}{r^6} - \\frac{C_8}{r^8}\\right) + (1-s(r))\\left(-\\frac{C_6}{r^6} - \\frac{C_8}{r^8} - \\frac{C_{10}}{r^{10}}\\right)$$\nWe can rearrange this expression to be more computationally efficient by factoring out the common terms:\n$$U_{\\mathrm{tot}}(r) = s(r) A e^{-r/\\rho} + s(r)\\left(-\\frac{C_6}{r^6} - \\frac{C_8}{r^8}\\right) + (1-s(r))\\left(-\\frac{C_6}{r^6} - \\frac{C_8}{r^8}\\right) - (1-s(r))\\frac{C_{10}}{r^{10}}$$\nThe terms involving $C_6$ and $C_8$ sum to $-\\frac{C_6}{r^6} - \\frac{C_8}{r^8}$ irrespective of $s(r)$:\n$$s(r)(\\dots) + (1-s(r))(\\dots) = (s(r) + 1 - s(r))(\\dots) = (\\dots)$$\nThis leads to the simplified potential:\n$$U_{\\mathrm{tot}}(r) = s(r) A e^{-r/\\rho} - \\frac{C_6}{r^6} - \\frac{C_8}{r^8} - (1-s(r))\\frac{C_{10}}{r^{10}}$$\n\n**3. Derivation of the Radial Force, $F(r)$**\n\nThe force is the negative gradient of the potential, $F(r) = -dU_{\\mathrm{tot}}/dr$. We differentiate the composite potential $U_{\\mathrm{tot}}(r) = s(r) U_{\\mathrm{short}}(r) + (1 - s(r)) U_{\\mathrm{long}}(r)$ with respect to $r$ using the product rule:\n$$\\frac{dU_{\\mathrm{tot}}}{dr} = \\frac{d}{dr}\\left[s(r)U_{\\mathrm{short}}(r)\\right] + \\frac{d}{dr}\\left[(1-s(r))U_{\\mathrm{long}}(r)\\right]$$\n$$\\frac{dU_{\\mathrm{tot}}}{dr} = \\left(s'(r)U_{\\mathrm{short}}(r) + s(r)\\frac{dU_{\\mathrm{short}}}{dr}\\right) + \\left(-s'(r)U_{\\mathrm{long}}(r) + (1-s(r))\\frac{dU_{\\mathrm{long}}}{dr}\\right)$$\nRearranging terms gives:\n$$\\frac{dU_{\\mathrm{tot}}}{dr} = s(r)\\frac{dU_{\\mathrm{short}}}{dr} + (1-s(r))\\frac{dU_{\\mathrm{long}}}{dr} + s'(r)\\left[U_{\\mathrm{short}}(r) - U_{\\mathrm{long}}(r)\\right]$$\nThe derivatives of the component potentials are:\n$$\\frac{dU_{\\mathrm{short}}}{dr} = -\\frac{A}{\\rho}e^{-r/\\rho} + \\frac{6C_6}{r^7} + \\frac{8C_8}{r^9}$$\n$$\\frac{dU_{\\mathrm{long}}}{dr} = \\frac{6C_6}{r^7} + \\frac{8C_8}{r^9} + \\frac{10C_{10}}{r^{11}}$$\nThe difference term is:\n$$U_{\\mathrm{short}}(r) - U_{\\mathrm{long}}(r) = \\left(A e^{-r/\\rho} - \\frac{C_6}{r^6} - \\frac{C_8}{r^8}\\right) - \\left(-\\frac{C_6}{r^6} - \\frac{C_8}{r^8} - \\frac{C_{10}}{r^{10}}\\right) = A e^{-r/\\rho} + \\frac{C_{10}}{r^{10}}$$\nThe total force is $F(r) = -dU_{\\mathrm{tot}}/dr$. If we define the forces corresponding to the short- and long-range potentials as $F_{\\mathrm{short}}(r) = -dU_{\\mathrm{short}}/dr$ and $F_{\\mathrm{long}}(r) = -dU_{\\mathrm{long}}/dr$, we can write:\n$$F_{\\mathrm{tot}}(r) = s(r)F_{\\mathrm{short}}(r) + (1-s(r))F_{\\mathrm{long}}(r) - s'(r)\\left[U_{\\mathrm{short}}(r) - U_{\\mathrm{long}}(r)\\right]$$\nwhere:\n$$F_{\\mathrm{short}}(r) = \\frac{A}{\\rho}e^{-r/\\rho} - \\frac{6C_6}{r^7} - \\frac{8C_8}{r^9}$$\n$$F_{\\mathrm{long}}(r) = -\\frac{6C_6}{r^7} - \\frac{8C_8}{r^9} - \\frac{10C_{10}}{r^{11}}$$\n\n**4. Computation Summary**\n\nThe potential and force are calculated based on the value of $r$:\n- For $r \\le r_{\\mathrm{sw}}$:\n    $U_{\\mathrm{tot}}(r) = U_{\\mathrm{short}}(r) = A e^{-r/\\rho} - \\frac{C_6}{r^6} - \\frac{C_8}{r^8}$\n    $F(r) = F_{\\mathrm{short}}(r) = \\frac{A}{\\rho}e^{-r/\\rho} - \\frac{6C_6}{r^7} - \\frac{8C_8}{r^9}$\n- For $r \\ge r_{\\mathrm{c}}$:\n    $U_{\\mathrm{tot}}(r) = U_{\\mathrm{long}}(r) = -\\frac{C_6}{r^6} - \\frac{C_8}{r^8} - \\frac{C_{10}}{r^{10}}$\n    $F(r) = F_{\\mathrm{long}}(r) = -\\frac{6C_6}{r^7} - \\frac{8C_8}{r^9} - \\frac{10C_{10}}{r^{11}}$\n- For $r_{\\mathrm{sw}}  r  r_{\\mathrm{c}}$:\n    Calculate $x$, $s(x)$, and $s'(r)$.\n    Then compute $U_{\\mathrm{tot}}(r)$ and $F(r)$ using the full composite expressions derived above. The simplified potential expression and the structured force expression are recommended for implementation.\n    $$U_{\\mathrm{tot}}(r) = s(x) A e^{-r/\\rho} - \\frac{C_6}{r^6} - \\frac{C_8}{r^8} - (1-s(x))\\frac{C_{10}}{r^{10}}$$\n    $$F(r) = s(x)F_{\\mathrm{short}}(r) + (1-s(x))F_{\\mathrm{long}}(r) - s'(r)\\left(A e^{-r/\\rho} + \\frac{C_{10}}{r^{10}}\\right)$$\nThese formulas will now be implemented to solve for the given test radii.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Constructs and evaluates a composite potential energy model for Molecular Dynamics.\n    \"\"\"\n\n    # Define parameters from the problem statement.\n    # Energies in kJ/mol, distances in nm.\n    A = 1000.0  # kJ/mol\n    rho = 0.35  # nm\n    C6 = 0.005  # kJ nm^6 / mol\n    C8 = 0.0001 # kJ nm^8 / mol\n    C10 = 0.000002 # kJ nm^10 / mol\n    r_sw = 0.4  # nm\n    r_c = 0.8   # nm\n    \n    params = {\n        'A': A, 'rho': rho, 'C6': C6, 'C8': C8, 'C10': C10,\n        'r_sw': r_sw, 'r_c': r_c\n    }\n\n    # Define the test cases from the problem statement.\n    test_radii = [0.35, 0.40, 0.60, 0.80, 1.00]\n\n    results = []\n    for r in test_radii:\n        potential, force = calculate_potential_and_force(r, params)\n        results.append(round(potential, 8))\n        results.append(round(force, 8))\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\ndef calculate_potential_and_force(r, params):\n    \"\"\"\n    Calculates the total potential energy and force for a given radius r.\n    \n    Args:\n        r (float): The interatomic distance in nm.\n        params (dict): A dictionary of model parameters.\n\n    Returns:\n        tuple: A tuple containing the total potential (kJ/mol) and force (kJ/mol/nm).\n    \"\"\"\n    A = params['A']\n    rho = params['rho']\n    C6 = params['C6']\n    C8 = params['C8']\n    C10 = params['C10']\n    r_sw = params['r_sw']\n    r_c = params['r_c']\n    \n    r_inv2 = 1.0 / (r * r)\n    r_inv6 = r_inv2 * r_inv2 * r_inv2\n    r_inv7 = r_inv6 / r\n    r_inv8 = r_inv6 * r_inv2\n    r_inv9 = r_inv8 / r\n    r_inv10 = r_inv8 * r_inv2\n    r_inv11 = r_inv10 / r\n    \n    # Potential and force components\n    exp_term = A * np.exp(-r / rho)\n    \n    U_short = exp_term - C6 * r_inv6 - C8 * r_inv8\n    F_short = (A / rho) * np.exp(-r / rho) - 6 * C6 * r_inv7 - 8 * C8 * r_inv9\n\n    U_long = -C6 * r_inv6 - C8 * r_inv8 - C10 * r_inv10\n    F_long = -6 * C6 * r_inv7 - 8 * C8 * r_inv9 - 10 * C10 * r_inv11\n\n    # Main logic to calculate the result for one case goes here.\n    if r = r_sw:\n        # Short-range regime\n        return U_short, F_short\n    \n    elif r = r_c:\n        # Long-range regime\n        return U_long, F_long\n        \n    else: # r_sw  r  r_c\n        # Switching regime\n        x = (r - r_sw) / (r_c - r_sw)\n        x2 = x * x\n        x3 = x2 * x\n        x4 = x3 * x\n        x5 = x4 * x\n\n        # Switching function s(x) and its derivative ds/dx\n        s_x = -6 * x5 + 15 * x4 - 10 * x3 + 1\n        ds_dx = -30 * x4 + 60 * x3 - 30 * x2\n        \n        # ds/dr by chain rule\n        ds_dr = ds_dx / (r_c - r_sw)\n        \n        # Composite potential U_tot\n        # U_tot = s_x * U_short + (1 - s_x) * U_long\n        # Simplified form for better numerical stability:\n        U_tot = s_x * exp_term - C6 * r_inv6 - C8 * r_inv8 - (1 - s_x) * C10 * r_inv10\n\n        # Composite force F_tot\n        U_diff = U_short - U_long  # This is A*exp(-r/rho) + C10/r^10\n        F_tot = s_x * F_short + (1 - s_x) * F_long - ds_dr * U_diff\n        \n        return U_tot, F_tot\n\nsolve()\n```", "id": "3414034"}]}