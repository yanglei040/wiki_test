{"hands_on_practices": [{"introduction": "For a model potential to be useful in simulation, its parameters must be carefully calibrated to represent a specific chemical bond. This exercise guides you through a robust protocol for parameterizing the Morse potential using data typically obtained from high-level electronic structure calculations. By using the bond's dissociation energy, its stiffness at equilibrium, and its energy at a stretched configuration, you will learn how to uniquely determine the potential's key parameters ($D_e$, $a$, and $r_e$), bridging the gap between quantum chemistry and classical force fields [@problem_id:3395888].", "problem": "A diatomic bond in a Molecular Dynamics (MD) force field is to be represented by a Morse anharmonic potential, taken in the convention where the energy is zero at the minimum and the dissociation energy is the asymptotic limit, so that the potential energy function is $$V(r)=D_e\\left(1-e^{-a(r-r_e)}\\right)^2$$, with $$V(r_e)=0$$ and $$V(\\infty)=D_e$$. You have three high-quality quantities from electronic-structure calculations: (i) the curvature at the minimum, defined as $$k_e=V''(r_e)$$, obtained by a normal-mode analysis around the equilibrium structure; (ii) one energy point labeled as a large stretch, namely $$E_s=V(r_s)$$ for a geometry $$r_sr_e$$ with substantial elongation; and (iii) the dissociation energy $$D_e$$, defined as the energy difference between the minimum and the dissociation limit. Assume the electronic-structure energies are on the same absolute reference such that the minimum is consistently zeroed at $$r=r_e$$. Which protocol below correctly uses these three inputs to determine $$\\left(D_e,a,r_e\\right)$$ uniquely and provides a sound justification of numerical robustness?\n\nA. Use the curvature to determine the range parameter by $$a=\\sqrt{\\dfrac{k_e}{2D_e}};$$ then recover the equilibrium distance by enforcing the stretched-point energy via $$E_s=D_e\\left(1-e^{-a(r_s-r_e)}\\right)^2,$$ solved as $$r_e=r_s+\\dfrac{1}{a}\\ln\\!\\left(1-\\sqrt{\\dfrac{E_s}{D_e}}\\right),$$ choosing the monotonically attractive branch with $$0\\sqrt{E_s/D_e}1.$$ Keep $$D_e$$ equal to the supplied dissociation energy. Robustness justification: the curvature near the minimum constrains $$a$$ independently of $$r_e$$, the far stretched point breaks the strong correlation between $$a$$ and $$r_e$$ that plagues purely near-equilibrium fits, and fixing the asymptote with $$D_e$$ enforces physical behavior; choosing $$E_s$$ not too close to either $$0$$ or $$D_e$$ avoids logarithmic ill-conditioning.\n\nB. Determine the range parameter from the curvature using the linear relation $$a=\\dfrac{k_e}{D_e};$$ then use the stretched-point energy by writing $$E_s=D_e\\left(1-e^{-a(r_s-r_e)}\\right)$$ and solve for the equilibrium distance as $$r_e=r_s-\\dfrac{1}{a}\\ln\\!\\left(1-\\dfrac{E_s}{D_e}\\right).$$ Keep $$D_e$$ equal to the supplied dissociation energy. Robustness justification: using a linear mapping for $$a$$ avoids squaring errors and the single logarithm keeps sensitivity low.\n\nC. Fit $$a$$ and $$D_e$$ by nonlinear least squares to two stretched points $$\\left(r_{s1},E_{s1}\\right)$$ and $$\\left(r_{s2},E_{s2}\\right)$$ while fixing $$r_e$$ at the geometry that minimizes the computed energy. Use the curvature $$k_e$$ only as a posterior consistency check and adjust if necessary. Robustness justification: two far points anchor the asymptote and the tail shape, and the minimum geometry is available directly from the electronic-structure scan.\n\nD. Set $$D_e=E_s$$ and assume $$r_e=r_s$$ because the minimum defines the zero of energy at the computed geometry. Then estimate $$a$$ by finite-difference curvature around $$r_s$$ using $$k_e\\approx V''(r_s)$$ and enforcing $$a=\\sqrt{k_e/(2D_e)}.$$ Robustness justification: co-locating the minimum and the stretched point reduces parameter correlation and the dissociation energy equals the observed far-stretch energy by construction.", "solution": "The user has requested a critical validation of a problem statement regarding the parameterization of a Morse potential, followed by a full solution and evaluation of the provided options.\n\n**Problem Validation**\n\n**Step 1: Extract Givens**\n\nThe problem statement provides the following explicit information:\n1.  **Potential Energy Function**: A Morse potential, $$V(r)=D_e\\left(1-e^{-a(r-r_e)}\\right)^2$$.\n2.  **Energy Convention**: The potential is zero at the minimum, $$V(r_e)=0$$, and the dissociation energy is the asymptotic limit, $$V(\\infty)=D_e$$.\n3.  **Input Data from Electronic-Structure Calculations**:\n    (i) The curvature at the minimum, $$k_e=V''(r_e)$$.\n    (ii) An energy point at a large stretch, $$E_s=V(r_s)$$ for a geometry $$r_sr_e$$.\n    (iii) The dissociation energy, $$D_e$$.\n4.  **Energy Reference**: The energy minimum is consistently zero, $$V(r_e)=0$$.\n5.  **Objective**: To find a protocol that correctly uses the three inputs to uniquely determine the parameters $$\\left(D_e,a,r_e\\right)$$ and provides a sound justification for numerical robustness.\n\n**Step 2: Validate Using Extracted Givens**\n\nThe problem is assessed against the required criteria:\n-   **Scientifically Grounded**: The Morse potential is a standard and physically meaningful model for the potential energy of a diatomic molecule, widely used in spectroscopy and molecular dynamics. The quantities $$D_e$$ (dissociation energy), $$r_e$$ (equilibrium bond length), and $$k_e$$ (harmonic force constant at the minimum) are fundamental properties of a chemical bond. The problem is firmly grounded in established principles of physical chemistry and computational physics.\n-   **Well-Posed**: The problem asks for a protocol to determine three parameters: $$D_e$$, $$a$$, and $$r_e$$. It provides three distinct pieces of information: a value for $$D_e$$, a value for $$k_e$$, and an energy-distance pair $$(r_s, E_s)$$. The problem implies that the input value of $$D_e$$ is to be used directly for the parameter $$D_e$$, leaving two unknowns, $$a$$ and $$r_e$$, to be determined from the remaining two constraints, $$k_e=V''(r_e)$$ and $$E_s=V(r_s)$$. With two equations and two unknowns, the system is, in principle, solvable. The question of uniqueness and numerical robustness is a standard consideration in parameter fitting, making the problem well-structured.\n-   **Objective**: The problem is stated using precise, unambiguous scientific language. All terms like \"curvature at the minimum\" and \"dissociation energy\" have clear, universally accepted definitions within the field.\n\nThe problem exhibits no scientific or factual unsoundness, is not metaphorical, is not incomplete or contradictory, does not posit unrealistic conditions, is not ill-posed, and is not trivial.\n\n**Step 3: Verdict and Action**\n\nThe problem statement is **valid**. The task is a standard parameterization exercise in chemical physics that requires both correct mathematical derivation and an understanding of numerical stability. I will now proceed with the solution.\n\n**Derivation of the Correct Protocol**\n\nThe objective is to determine the parameters $$a$$ and $$r_e$$ of the Morse potential $$V(r)=D_e\\left(1-e^{-a(r-r_e)}\\right)^2$$, given the values of $$D_e$$, $$k_e=V''(r_e)$$, and a point $$(r_s, E_s)$$ where $$r_s  r_e$$.\n\nFirst, we establish the relationship between the curvature $$k_e$$ and the potential parameters. This requires calculating the second derivative of $$V(r)$$ with respect to $$r$$.\n\nThe first derivative is:\n$$ V'(r) = \\frac{d}{dr} \\left[ D_e\\left(1-e^{-a(r-r_e)}\\right)^2 \\right] $$\n$$ V'(r) = D_e \\cdot 2\\left(1-e^{-a(r-r_e)}\\right) \\cdot \\frac{d}{dr}\\left(1-e^{-a(r-r_e)}\\right) $$\n$$ V'(r) = 2D_e\\left(1-e^{-a(r-r_e)}\\right) \\left(-e^{-a(r-r_e)} \\cdot (-a)\\right) $$\n$$ V'(r) = 2aD_e \\left(1-e^{-a(r-r_e)}\\right)e^{-a(r-r_e)} = 2aD_e \\left(e^{-a(r-r_e)} - e^{-2a(r-r_e)}\\right) $$\nAt the minimum $$r=r_e$$, we have $$V'(r_e)=2aD_e(e^0 - e^0) = 0$$, which is consistent with an equilibrium point.\n\nThe second derivative is:\n$$ V''(r) = \\frac{d}{dr} \\left[ 2aD_e \\left(e^{-a(r-r_e)} - e^{-2a(r-r_e)}\\right) \\right] $$\n$$ V''(r) = 2aD_e \\left(-a e^{-a(r-r_e)} - (-2a) e^{-2a(r-r_e)}\\right) $$\n$$ V''(r) = 2a^2D_e \\left(2e^{-2a(r-r_e)} - e^{-a(r-r_e)}\\right) $$\n\nThe curvature at the minimum, $$k_e$$, is $$V''(r_e)$$:\n$$ k_e = V''(r_e) = 2a^2D_e \\left(2e^0 - e^0\\right) = 2a^2D_e(2-1) = 2a^2D_e $$\nFrom this exact relationship, we can solve for the parameter $$a$$:\n$$ a^2 = \\frac{k_e}{2D_e} $$\nSince $$a$$ is a physical parameter representing the width of the potential well, it must be positive. Thus, we take the principal root:\n$$ a = \\sqrt{\\frac{k_e}{2D_e}} $$\nThis equation determines the parameter $$a$$ using two of the provided high-quality inputs, $$k_e$$ and $$D_e$$.\n\nNext, we use the third input, the energy point $$(r_s, E_s)$$, to determine the remaining parameter, $$r_e$$. The defining equation is:\n$$ E_s = V(r_s) = D_e\\left(1-e^{-a(r_s-r_e)}\\right)^2 $$\nWe solve for $$r_e$$. The parameter $$a$$ is now considered known from the previous step.\n$$ \\frac{E_s}{D_e} = \\left(1-e^{-a(r_s-r_e)}\\right)^2 $$\nTaking the square root of both sides gives:\n$$ \\pm\\sqrt{\\frac{E_s}{D_e}} = 1-e^{-a(r_s-r_e)} $$\nWe must choose the correct sign. The problem states that $$r_sr_e$$, which means the bond is stretched. For a positive parameter $$a$$, the exponent $$-a(r_s-r_e)$$ is negative. Therefore, $$0  e^{-a(r_s-r_e)}  1$$. This implies that the term $$1-e^{-a(r_s-r_e)}$$ is positive. Consequently, we must take the positive root:\n$$ \\sqrt{\\frac{E_s}{D_e}} = 1-e^{-a(r_s-r_e)} $$\nFurthermore, since $$r_s$$ is a point on the bound potential, $$0  E_s  D_e$$, which ensures that $$0  \\sqrt{E_s/D_e}  1$$, and the subsequent logarithm will be of a positive number.\n\nRearranging to solve for the exponential term:\n$$ e^{-a(r_s-r_e)} = 1 - \\sqrt{\\frac{E_s}{D_e}} $$\nTaking the natural logarithm of both sides:\n$$ -a(r_s-r_e) = \\ln\\left(1 - \\sqrt{\\frac{E_s}{D_e}}\\right) $$\nFinally, solving for $$r_e$$:\n$$ r_s - r_e = -\\frac{1}{a} \\ln\\left(1 - \\sqrt{\\frac{E_s}{D_e}}\\right) $$\n$$ r_e = r_s + \\frac{1}{a} \\ln\\left(1 - \\sqrt{\\frac{E_s}{D_e}}\\right) $$\nThis result provides a unique formula for $$r_e$$ based on the inputs. The protocol is thus analytically determined.\n\n**Evaluation of Options**\n\n**Option A:**\nThe protocol described is:\n1.  $$a=\\sqrt{\\dfrac{k_e}{2D_e}}$$\n2.  $$r_e=r_s+\\dfrac{1}{a}\\ln\\!\\left(1-\\sqrt{\\dfrac{E_s}{D_e}}\\right)$$ with the condition $$0\\sqrt{E_s/D_e}1$$.\n3.  $$D_e$$ is taken from the input.\n\nThis protocol exactly matches the derivation above. The justification provided in the option is also sound. The relationship $$k_e=2a^2D_e$$ does indeed constrain $$a$$ without reference to $$r_e$$. Using a data point $$(r_s, E_s)$$ far from the minimum ($$r_e$$) is a standard technique to avoid parameter correlation that arises when fitting only near-equilibrium data. Finally, the analysis of numerical robustness is correct: the logarithmic function is ill-conditioned if its argument approaches zero, which occurs when $$E_s \\to D_e$$. If $$E_s \\to 0$$, the data point provides information redundant with that from $$k_e$$, a less severe but still relevant issue.\n- **Verdict**: Correct.\n\n**Option B:**\nThe protocol described is:\n1.  $$a=\\dfrac{k_e}{D_e}$$\n2.  $$E_s=D_e\\left(1-e^{-a(r_s-r_e)}\\right)$$\n3.  $$r_e=r_s-\\dfrac{1}{a}\\ln\\!\\left(1-\\dfrac{E_s}{D_e}\\right)$$\n\nThis option is fundamentally flawed. The relationship between $$a$$, $$k_e$$, and $$D_e$$ is $$k_e = 2a^2D_e$$, not $$k_e = aD_e$$. The proposed formula for $$a$$ is mathematically incorrect. Additionally, the potential energy is stated as $$E_s=D_e\\left(1-e^{-a(r_s-r_e)}\\right)$$, which lacks the square on the parenthetical term, contradicting the definition of the Morse potential provided in the problem statement. The expression for $$r_e$$ is derived from this incorrect potential form. The entire protocol is based on incorrect mathematical relationships.\n- **Verdict**: Incorrect.\n\n**Option C:**\nThe protocol described is:\n1.  Fit $$a$$ and $$D_e$$ using nonlinear least squares to **two** stretched points.\n2.  Fix $$r_e$$ at the computationally determined minimum.\n3.  Use $$k_e$$ only for a posterior check.\n\nThis protocol is inconsistent with the problem statement. The problem provides one stretched point $$(r_s, E_s)$$, not two. It also provides $$D_e$$ and $$k_e$$ as high-quality inputs to be used for the parameterization, not as a check or a value to be fitted. This option describes an entirely different parameterization procedure that disregards the specified inputs.\n- **Verdict**: Incorrect.\n\n**Option D:**\nThe protocol described is:\n1.  Set $$D_e=E_s$$ and $$r_e=r_s$$.\n2.  Estimate $$k_e \\approx V''(r_s)$$.\n3.  Use $$a=\\sqrt{k_e/(2D_e)}$$.\n\nThis protocol is based on physically and mathematically absurd premises.\n-   $$D_e=E_s$$: The dissociation energy $$D_e$$ is the energy at infinite separation, which is the maximum possible potential energy for the bound state. $$E_s$$ is the energy at a finite separation $$r_s$$. For any finite stretch, $$E_s  D_e$$. Setting them equal is a fundamental error.\n-   $$r_e=r_s$$: $$r_e$$ is the equilibrium bond length where energy is minimum ($$V(r_e)=0$$). $$r_s$$ is a point of \"substantial elongation\" where the energy $$E_s  0$$. Equating these is a direct contradiction of the problem's setup and physical reality.\n-   $$k_e\\approx V''(r_s)$$: $$k_e$$ is defined as the curvature *at the minimum* ($$r_e$$), not at a stretched position $$r_s$$. The curvature of the Morse potential is not constant.\n\nThe justification provided is nonsensical as it is predicated on these falsehoods.\n- **Verdict**: Incorrect.", "answer": "$$\\boxed{A}$$", "id": "3395888"}, {"introduction": "Once a potential is defined, a crucial step in setting up a molecular dynamics simulation is choosing a stable integration timestep, as a value that is too large leads to numerical instability. This practice connects the analytical properties of the Morse potential—specifically its curvature at the equilibrium point—to the practical limits of the velocity-Verlet integrator. You will derive and apply a fundamental stability criterion to estimate the maximum stable timestep, a core skill for any simulation practitioner [@problem_id:3395859].", "problem": "Consider a single diatomic bond in a Molecular Dynamics (MD) simulation modeled by the Morse potential $U(r) = D_e \\left(1 - \\exp\\!\\left(-a \\left(r - r_e\\right)\\right)\\right)^{2}$, where $D_e$ is the dissociation energy, $a$ is the range parameter, and $r_e$ is the equilibrium bond length. Let $x = r - r_e$ denote the displacement from equilibrium and $m$ the reduced mass of the bonded pair. Assume velocity-Verlet integration is used, and adopt the standard small-amplitude accuracy requirement that the time step $\\Delta t$ must satisfy $\\Delta t\\,\\omega \\ll 1$ for the fastest local vibrational angular frequency $\\omega$ relevant to the trajectory. Implement this requirement by enforcing $\\Delta t\\,\\omega_{\\max} = \\eta$ with a chosen dimensionless safety factor $\\eta$.\n\nStarting only from Newton’s second law and the definition of the Morse potential, derive the small-amplitude vibrational angular frequency about $x=0$ and use it to obtain an analytic expression for the maximum time step $\\Delta t_{\\max}$ in terms of $m$, $D_e$, $a$, and $\\eta$. Then, evaluate $\\Delta t_{\\max}$ numerically for the following physically realistic parameters:\n- $D_e = 4.5\\,\\mathrm{eV}$,\n- $a = 2.0\\,\\mathrm{\\AA}^{-1}$,\n- $m = 0.923\\,\\mathrm{amu}$,\n- $\\eta = 0.10$.\n\nUse the exact conversions $1\\,\\mathrm{eV} = 1.602176634 \\times 10^{-19}\\,\\mathrm{J}$, $1\\,\\mathrm{\\AA} = 1.0 \\times 10^{-10}\\,\\mathrm{m}$, and $1\\,\\mathrm{amu} = 1.66053906660 \\times 10^{-27}\\,\\mathrm{kg}$. Express your final numerical answer for $\\Delta t_{\\max}$ in femtoseconds and round to four significant figures.\n\nFinally, based on the second derivative of the Morse potential $U''(x)$, briefly justify how the admissible $\\Delta t$ would be expected to change as the vibrational amplitude increases on the bond-stretching side ($x0$) versus the bond-compression side ($x0$). Do not compute any additional numbers for this qualitative part.", "solution": "The problem statement is scientifically grounded, well-posed, and objective. It presents a standard exercise in computational physics centered on the Morse potential, Newton's laws, and numerical stability criteria in molecular dynamics. All necessary parameters are provided, and the required derivations and calculations are formalizable. Therefore, the problem is valid.\n\nThe solution proceeds in three parts as requested: first, the derivation of the small-amplitude vibrational frequency; second, the derivation and numerical evaluation of the maximum time step; and third, a qualitative analysis of the time step's dependence on vibrational amplitude.\n\nThe Morse potential, as a function of the displacement $x = r - r_e$, is given by:\n$$U(x) = D_e \\left(1 - \\exp(-ax)\\right)^2$$\nThe force on the reduced mass $m$ is $F(x) = -dU/dx$. For small-amplitude oscillations around the equilibrium point $x=0$, the system behaves as a simple harmonic oscillator. The potential can be approximated by a Taylor series expansion around $x=0$:\n$$U(x) = U(0) + U'(0)x + \\frac{1}{2}U''(0)x^2 + \\mathcal{O}(x^3)$$\nAt equilibrium, the potential is at a minimum, so $U(0) = 0$ and the force $F(0)=-U'(0)=0$. For small displacements, the potential is harmonic:\n$$U(x) \\approx \\frac{1}{2}k x^2$$\nwhere the effective spring constant $k$ is given by the second derivative of the potential at equilibrium, $k = U''(0)$.\n\nFirst, we find the first derivative $U'(x)$:\n$$U'(x) = \\frac{d}{dx} \\left[ D_e \\left(1 - 2\\exp(-ax) + \\exp(-2ax)\\right) \\right] = 2aD_e \\left(\\exp(-ax) - \\exp(-2ax)\\right)$$\nNext, we find the second derivative $U''(x)$:\n$$U''(x) = \\frac{d}{dx} \\left[ 2aD_e \\left(\\exp(-ax) - \\exp(-2ax)\\right) \\right] = 2a^2D_e \\left(2\\exp(-2ax) - \\exp(-ax)\\right)$$\nEvaluating at $x=0$ yields the spring constant $k$:\n$$k = U''(0) = 2a^2D_e \\left(2\\exp(0) - \\exp(0)\\right) = 2a^2D_e(2 - 1) = 2a^2D_e$$\nThe small-amplitude (highest) vibrational angular frequency $\\omega_{\\max}$ is then:\n$$\\omega_{\\max} = \\sqrt{\\frac{k}{m}} = \\sqrt{\\frac{2a^2D_e}{m}} = a\\sqrt{\\frac{2D_e}{m}}$$\nThe stability condition for the velocity-Verlet integrator is implemented as $\\Delta t_{\\max}\\omega_{\\max} = \\eta$. Solving for the maximum time step $\\Delta t_{\\max}$ gives the analytic expression:\n$$\\Delta t_{\\max} = \\frac{\\eta}{\\omega_{\\max}} = \\frac{\\eta}{a\\sqrt{\\frac{2D_e}{m}}} = \\frac{\\eta}{a}\\sqrt{\\frac{m}{2D_e}}$$\nNow we evaluate this expression numerically. The given parameters must be converted to base SI units:\n$D_e = 4.5\\,\\mathrm{eV} = 4.5 \\times (1.602176634 \\times 10^{-19}\\,\\mathrm{J}) = 7.209794853 \\times 10^{-19}\\,\\mathrm{J}$\n$a = 2.0\\,\\mathrm{\\AA}^{-1} = 2.0 \\times (1.0 \\times 10^{-10}\\,\\mathrm{m})^{-1} = 2.0 \\times 10^{10}\\,\\mathrm{m}^{-1}$\n$m = 0.923\\,\\mathrm{amu} = 0.923 \\times (1.66053906660 \\times 10^{-27}\\,\\mathrm{kg}) = 1.532777558... \\times 10^{-27}\\,\\mathrm{kg}$\n$\\eta = 0.10$\n\nSubstituting these values into the expression for $\\Delta t_{\\max}$:\n$$\\Delta t_{\\max} = \\frac{0.10}{2.0 \\times 10^{10}\\,\\mathrm{m}^{-1}} \\sqrt{\\frac{1.532777... \\times 10^{-27}\\,\\mathrm{kg}}{2 \\times (7.209794853 \\times 10^{-19}\\,\\mathrm{J})}}$$\n$$\\Delta t_{\\max} = (5.0 \\times 10^{-12}\\,\\mathrm{m}) \\sqrt{1.063004... \\times 10^{-9}\\,\\mathrm{s}^2 \\cdot \\mathrm{m}^{-2}}$$\n$$\\Delta t_{\\max} = (5.0 \\times 10^{-12}\\,\\mathrm{m}) \\times (3.260374... \\times 10^{-5}\\,\\mathrm{s} \\cdot \\mathrm{m}^{-1})$$\n$$\\Delta t_{\\max} = 1.630187... \\times 10^{-16}\\,\\mathrm{s}$$\nTo express this in femtoseconds ($1\\,\\mathrm{fs} = 10^{-15}\\,\\mathrm{s}$):\n$$\\Delta t_{\\max} = (1.630187... \\times 10^{-16}\\,\\mathrm{s}) \\times \\frac{1\\,\\mathrm{fs}}{10^{-15}\\,\\mathrm{s}} = 0.1630187...\\,\\mathrm{fs}$$\nRounding to four significant figures, the numerical answer is $0.1630\\,\\mathrm{fs}$.\n\nFinally, for the qualitative justification, the admissible time step $\\Delta t$ is inversely related to the local frequency, $\\Delta t(x) \\propto 1/\\omega(x)$. The local frequency is determined by the local curvature of the potential, $\\omega(x) \\approx \\sqrt{U''(x)/m}$. Thus, $\\Delta t(x) \\propto 1/\\sqrt{U''(x)}$.\n- Bond-stretching side ($x0$): As $x$ increases, the curvature $U''(x) = 2a^2D_e \\left(2\\exp(-2ax) - \\exp(-ax)\\right)$ decreases because the potential \"softens\" and approaches the dissociation plateau. A smaller $U''(x)$ implies a lower local frequency, which permits a larger admissible time step $\\Delta t$.\n- Bond-compression side ($x0$): As $x$ becomes more negative, the term $-ax$ becomes large and positive. The exponential terms $\\exp(-2ax)$ and $\\exp(-ax)$ grow rapidly, with the $\\exp(-2ax)$ term dominating. This causes the curvature $U''(x)$ to increase sharply, representing the steep repulsive wall of the potential. A much larger $U''(x)$ implies a much higher local frequency, which demands a smaller admissible time step $\\Delta t$.\nTherefore, the admissible $\\Delta t$ would be expected to increase during bond stretching and decrease sharply during bond compression. The overall time step for a simulation must be chosen conservatively to resolve the highest frequency encountered, which occurs at the point of maximum compression.", "answer": "$$\\boxed{0.1630}$$", "id": "3395859"}, {"introduction": "A key advantage of the Morse potential over the simple harmonic oscillator is its ability to describe physical phenomena arising from anharmonicity, such as thermal expansion. As temperature increases, the average bond length of a real molecule shifts from the equilibrium position $r_e$, a behavior the symmetric harmonic potential cannot capture. In this computational exercise, you will use principles of statistical mechanics to numerically calculate the average bond length at a given temperature, directly quantifying the bond's thermal expansion due to the asymmetric shape of the Morse potential [@problem_id:3395887].", "problem": "Consider a classical diatomic bond coordinate governed by an anharmonic Morse potential used in Molecular Dynamics (MD). The potential energy as a function of bond length is given by the function $U_{M}(r)$, where $r$ is the internuclear separation. A canonical ensemble at temperature $T$ assigns to each configuration a probability density proportional to $\\exp(-\\beta U_{M}(r))$, where $\\beta = 1/(k_{B} T)$ and $k_{B}$ is the Boltzmann constant. The canonical average bond length is defined by the ratio of two integrals over the bond length domain. Your task is to compute this canonical average numerically for several specified parameter sets, and then to quantify the anharmonic shift away from the equilibrium bond length.\n\nStart from foundational statistical mechanics principles: the canonical probability density proportional to $\\exp(-\\beta U(r))$ and the definition of an ensemble average as a normalized integral over configuration space. Use only these principles and the stated potential as a base for your derivation and algorithm design.\n\nThe Morse potential is\n$$\nU_{M}(r) = D_{e} \\left(1 - e^{-a\\,(r - r_{e})}\\right)^{2},\n$$\nwhere $D_{e}$ is the well depth, $a$ sets the inverse length scale of the well, and $r_{e}$ is the equilibrium bond length. The canonical average bond length is\n$$\n\\langle r \\rangle = \\frac{\\int r \\, e^{-\\beta U_{M}(r)} \\, dr}{\\int e^{-\\beta U_{M}(r)} \\, dr}.\n$$\n\nImportant physical and numerical considerations:\n- In the absence of additional constraints, the integral over $r$ to $+\\infty$ is not normalizable for a Morse potential because $U_{M}(r) \\to D_{e}$ as $r \\to \\infty$, which yields a non-vanishing Boltzmann factor. In realistic Molecular Dynamics, dissociation or finite molecular environments limit accessible $r$. To obtain a well-defined, physically meaningful bound-state average at temperature $T$ well below the dissociation scale, restrict the integrals to a finite interval $[r_{\\min}, r_{\\max}]$ chosen adaptively by a Boltzmann-weight tolerance and a cap:\n  - Define a tolerance $\\tau$ with $\\tau = 10^{-12}$ and a right-hand cap $L_{\\text{cap}} = 10\\,\\text{\\AA}$.\n  - Compute the energy threshold $U_{\\text{th}} = -k_{B} T \\ln \\tau$.\n  - Find $r_{\\text{L}} \\in (0, r_{e})$ such that $U_{M}(r_{\\text{L}}) = U_{\\text{th}}$ and set $r_{\\min} = \\max(0, r_{\\text{L}})$.\n  - Attempt to find $r_{\\text{R}} \\in (r_{e}, r_{e} + L_{\\text{cap}})$ such that $U_{M}(r_{\\text{R}}) = U_{\\text{th}}$. If such $r_{\\text{R}}$ exists, set $r_{\\max} = r_{\\text{R}}$; otherwise, set $r_{\\max} = r_{e} + L_{\\text{cap}}$.\n  - This constructs a restricted canonical average appropriate to temperatures $T$ where bound states dominate. Your numerical method should robustly handle both regimes where $U_{\\text{th}}  D_{e}$ and $U_{\\text{th}} \\ge D_{e}$.\n\nProgram requirements:\n- Use $k_{B} = 1.380649 \\times 10^{-23}\\,\\mathrm{J/K}$.\n- Units:\n  - Energies $D_{e}$ must be in Joules.\n  - Temperature $T$ must be in Kelvin.\n  - Lengths $r$ and $r_{e}$ must be in Angstroms ($\\text{\\AA}$).\n  - The inverse length parameter $a$ must be in $\\text{\\AA}^{-1}$.\n- Compute the restricted canonical average $\\langle r \\rangle$ on $[r_{\\min}, r_{\\max}]$ and the anharmonic shift $\\Delta = \\langle r \\rangle - r_{e}$. Express both $\\langle r \\rangle$ and $\\Delta$ in Angstroms.\n- The numerical integration must be accurate enough for advanced graduate-level analysis; use an adaptive quadrature with stringent tolerances.\n\nTest suite:\nFor each of the following parameter sets $(D_{e}, a, r_{e}, T)$, compute $\\langle r \\rangle$ and $\\Delta$:\n1. $D_{e} = 8.000 \\times 10^{-19}\\,\\mathrm{J}$, $a = 2.0\\,\\text{\\AA}^{-1}$, $r_{e} = 1.0\\,\\text{\\AA}$, $T = 300\\,\\mathrm{K}$.\n2. $D_{e} = 8.000 \\times 10^{-20}\\,\\mathrm{J}$, $a = 1.5\\,\\text{\\AA}^{-1}$, $r_{e} = 1.5\\,\\text{\\AA}$, $T = 600\\,\\mathrm{K}$.\n3. $D_{e} = 1.1215 \\times 10^{-18}\\,\\mathrm{J}$, $a = 4.0\\,\\text{\\AA}^{-1}$, $r_{e} = 1.0\\,\\text{\\AA}$, $T = 50\\,\\mathrm{K}$.\n4. $D_{e} = 4.8065 \\times 10^{-20}\\,\\mathrm{J}$, $a = 2.0\\,\\text{\\AA}^{-1}$, $r_{e} = 1.2\\,\\text{\\AA}$, $T = 1000\\,\\mathrm{K}$.\n\nAlgorithmic output:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets.\n- The list should contain, in order, for each test case, first the canonical average $\\langle r \\rangle$ in Angstroms, then the shift $\\Delta$ in Angstroms. For the four test cases, the output must thus have eight floating-point numbers:\n$$\n[\\langle r \\rangle_{1}, \\Delta_{1}, \\langle r \\rangle_{2}, \\Delta_{2}, \\langle r \\rangle_{3}, \\Delta_{3}, \\langle r \\rangle_{4}, \\Delta_{4}]\n$$\nwith all lengths in Angstroms.", "solution": "The problem statement has been critically validated and is deemed to be a valid scientific problem. It is scientifically grounded in the principles of classical statistical mechanics, is mathematically well-posed with a clear and complete set of givens, and is expressed in objective, formal language. There are no contradictions, ambiguities, or factual unsoundness. The task is a standard, albeit non-trivial, exercise in computational physics. We may therefore proceed with the solution.\n\nThe problem requires a computation of the canonical average bond length $\\langle r \\rangle$ for a diatomic molecule whose potential energy $U_{M}(r)$ is described by the Morse potential. The anharmonicity of this potential, meaning its deviation from a simple quadratic (harmonic) form, causes a temperature-dependent shift in the average bond length away from the potential minimum $r_{e}$. Our objective is to calculate this average length and the corresponding shift $\\Delta = \\langle r \\rangle - r_{e}$.\n\nThe foundational principle is that in a canonical ensemble at temperature $T$, the probability density $p(r)$ of finding the system at a bond length $r$ is proportional to the Boltzmann factor, $e^{-\\beta U(r)}$, where $\\beta = 1/(k_{B}T)$ and $k_{B}$ is the Boltzmann constant.\n$$\np(r) = \\frac{e^{-\\beta U_{M}(r)}}{Z}\n$$\nThe normalization constant $Z$, known as the partition function for this one-dimensional configuration space, is given by the integral of the Boltzmann factor over all possible bond lengths:\n$$\nZ = \\int e^{-\\beta U_{M}(r)} \\, dr\n$$\nThe canonical average of any observable quantity $A(r)$ is then computed as its probability-weighted integral:\n$$\n\\langle A \\rangle = \\int A(r) p(r) \\, dr = \\frac{\\int A(r) e^{-\\beta U_{M}(r)} \\, dr}{\\int e^{-\\beta U_{M}(r)} \\, dr}\n$$\nFor this problem, the observable is the bond length itself, $A(r) = r$. Thus, we must compute:\n$$\n\\langle r \\rangle = \\frac{\\int r \\, e^{-\\beta U_{M}(r)} \\, dr}{\\int e^{-\\beta U_{M}(r)} \\, dr}\n$$\nThe Morse potential is given by:\n$$\nU_{M}(r) = D_{e} \\left(1 - e^{-a(r - r_{e})}\\right)^{2}\n$$\nwhere $D_{e}$ is the dissociation energy (well depth), $a$ is a parameter controlling the width of the potential well, and $r_{e}$ is the equilibrium bond length corresponding to the minimum energy $U_{M}(r_e) = 0$.\n\nA critical issue arises from the integral's domain. As $r \\to \\infty$, the term $e^{-a(r-r_e)} \\to 0$, and thus $U_{M}(r) \\to D_{e}$. The integrand $e^{-\\beta U_{M}(r)}$ approaches a non-zero constant $e^{-\\beta D_{e}}$. An integral of a function that approaches a positive constant over an infinite domain diverges. This reflects the physical reality that, in the absence of other constraints, there is a finite probability of dissociation. The problem circumvents this by defining a restricted canonical average for a bound state. This is physically justified at temperatures $T$ where $k_{B}T \\ll D_{e}$, as states with energy near or above $D_{e}$ are highly improbable. The integration domain is truncated to an interval $[r_{\\min}, r_{\\max}]$ where the Boltzmann factors at the boundaries are exceedingly small, as specified by a tolerance $\\tau = 10^{-12}$.\n\nThe algorithm to determine the integration bounds $[r_{\\min}, r_{\\max}]$ is as follows:\n1.  Calculate the energy threshold $U_{\\text{th}} = -k_{B} T \\ln \\tau$. This is the energy at which the Boltzmann weight $e^{-\\beta U}$ drops to the tolerance $\\tau$. Note that $U_{\\text{th}} = -\\frac{1}{\\beta} \\ln \\tau$.\n2.  To find the integration limits, we solve the equation $U_{M}(r) = U_{\\text{th}}$ for $r$:\n    $$\n    D_{e} \\left(1 - e^{-a(r - r_{e})}\\right)^{2} = U_{\\text{th}}\n    $$\n    $$\n    1 - e^{-a(r - r_{e})} = \\pm \\sqrt{\\frac{U_{\\text{th}}}{D_{e}}}\n    $$\n    $$\n    e^{-a(r - r_{e})} = 1 \\mp \\sqrt{\\frac{U_{\\text{th}}}{D_{e}}}\n    $$\n    $$\n    r = r_{e} - \\frac{1}{a} \\ln \\left(1 \\mp \\sqrt{\\frac{U_{\\text{th}}}{D_{e}}}\\right)\n    $$\n3.  This yields two potential solutions. The '+' sign corresponds to the inner wall of the potential ($r  r_{e}$), and the '-' sign corresponds to the outer wall ($r  r_{e}$).\n    -   The left boundary, $r_{\\text{L}}$, is found using the '+' sign: $r_{\\text{L}} = r_{e} - \\frac{1}{a} \\ln \\left(1 + \\sqrt{U_{\\text{th}}/D_{e}}\\right)$. This solution is always real and less than $r_e$. We set $r_{\\min} = \\max(0, r_{\\text{L}})$, as bond length cannot be negative.\n    -   The right boundary, $r_{\\text{R}}$, is associated with the '-' sign: $r_{\\text{R}} = r_{e} - \\frac{1}{a} \\ln \\left(1 - \\sqrt{U_{\\text{th}}/D_{e}}\\right)$.\n4.  The determination of $r_{\\max}$ depends on whether $U_{\\text{th}}$ is less than $D_{e}$:\n    -   **Case 1: $U_{\\text{th}}  D_{e}$**. The term $\\sqrt{U_{\\text{th}}/D_{e}}  1$, so the argument of the logarithm is positive and a real solution $r_{\\text{R}}  r_{e}$ exists. As per the problem's constraints, we must cap this value at $r_{e} + L_{\\text{cap}}$, where $L_{\\text{cap}} = 10\\,\\text{\\AA}$. Therefore, $r_{\\max} = \\min(r_{\\text{R}}, r_{e} + L_{\\text{cap}})$.\n    -   **Case 2: $U_{\\text{th}} \\ge D_{e}$**. The term $\\sqrt{U_{\\text{th}}/D_{e}} \\ge 1$, making the argument of the logarithm non-positive. No real solution for $r_{\\text{R}}$ exists. In this regime (high temperature or shallow well), the Boltzmann weight never drops below the tolerance $\\tau$ on the outer wall. Following the problem's explicit instructions, we use the hard cap: $r_{\\max} = r_{e} + L_{\\text{cap}}$.\n\nWith the integration limits $[r_{\\min}, r_{\\max}]$ established, we can define the two definite integrals to be computed numerically:\n$$\nN = \\int_{r_{\\min}}^{r_{\\max}} r \\, e^{-\\beta U_{M}(r)} \\, dr\n$$\n$$\nZ = \\int_{r_{\\min}}^{r_{\\max}} e^{-\\beta U_{M}(r)} \\, dr\n$$\nThe average bond length is then $\\langle r \\rangle = N/Z$, and the anharmonic shift is $\\Delta = \\langle r \\rangle - r_{e}$. Due to the asymmetric shape of the Morse potential (it is less steep for $r  r_{e}$ than for $r  r_{e}$), we expect $\\langle r \\rangle$ to be greater than $r_{e}$ for any $T  0$, resulting in a positive shift $\\Delta$.\n\nThe calculation will be implemented using adaptive quadrature, as provided by the `scipy.integrate.quad` function, to ensure high accuracy for the numerical integration of these well-behaved but potentially sharply peaked functions. The logic defined above will be applied to each parameter set from the test suite. All units must be consistent; we will use Joules for energy, Kelvin for temperature, and Angstroms for length, as specified.", "answer": "```python\nimport numpy as np\nfrom scipy.integrate import quad\n\ndef solve():\n    \"\"\"\n    Computes the canonical average bond length and anharmonic shift for a diatomic\n    molecule described by a Morse potential for several test cases.\n    \"\"\"\n\n    # Physical constant and numerical parameters\n    K_B = 1.380649e-23  # Boltzmann constant in J/K\n    TAU = 1.0e-12       # Boltzmann weight tolerance\n    L_CAP = 10.0        # Right-hand integration cap in Angstroms\n\n    # Test suite: (D_e [J], a [A^-1], r_e [A], T [K])\n    test_cases = [\n        (8.000e-19, 2.0, 1.0, 300.0),\n        (8.000e-20, 1.5, 1.5, 600.0),\n        (1.1215e-18, 4.0, 1.0, 50.0),\n        (4.8065e-20, 2.0, 1.2, 1000.0),\n    ]\n\n    results = []\n\n    def compute_metrics(De, a, re, T):\n        \"\"\"\n        Calculates r and Delta for a single set of parameters.\n        \"\"\"\n        # Calculate beta and the energy threshold\n        beta = 1.0 / (K_B * T)\n        U_th = -K_B * T * np.log(TAU)\n\n        # Define the Morse potential function\n        def morse_potential(r):\n            return De * (1 - np.exp(-a * (r - re)))**2\n\n        # --- Determine integration bounds [r_min, r_max] ---\n\n        # Calculate the left bound, r_L\n        # This is always well-defined for De  0, U_th = 0\n        sqrt_term = np.sqrt(U_th / De)\n        rL = re - (1.0 / a) * np.log(1.0 + sqrt_term)\n        r_min = max(0.0, rL)\n\n        # Calculate the right bound, r_max\n        if U_th  De:\n            # Solution for r  re exists.\n            rR = re - (1.0 / a) * np.log(1.0 - sqrt_term)\n            # Apply the cap as per problem statement logic.\n            # If the calculated rR is beyond the cap, use the cap.\n            r_max = min(rR, re + L_CAP)\n        else:\n            # No real solution for r  re. Use the hard cap.\n            r_max = re + L_CAP\n\n        # --- Perform numerical integration ---\n\n        # Define the integrands\n        # Numerator integrand: r * exp(-beta * U(r))\n        def integrand_numerator(r):\n            return r * np.exp(-beta * morse_potential(r))\n\n        # Denominator (partition function) integrand: exp(-beta * U(r))\n        def integrand_denominator(r):\n            return np.exp(-beta * morse_potential(r))\n        \n        # Use adaptive quadrature to compute the integrals\n        # quad returns a tuple (result, estimated_error)\n        numerator_integral, _ = quad(integrand_numerator, r_min, r_max)\n        denominator_integral, _ = quad(integrand_denominator, r_min, r_max)\n        \n        # --- Calculate final results ---\n        \n        if denominator_integral == 0:\n            # Should not happen with valid parameters, but as a safeguard.\n            avg_r = re\n        else:\n            avg_r = numerator_integral / denominator_integral\n        \n        anharmonic_shift = avg_r - re\n\n        return avg_r, anharmonic_shift\n\n    # Process each test case\n    for case in test_cases:\n        De, a, re, T = case\n        avg_r, delta = compute_metrics(De, a, re, T)\n        results.extend([avg_r, delta])\n\n    # Format and print the final output\n    print(f\"[{','.join(f'{x:.8f}' for x in results)}]\")\n\nsolve()\n```", "id": "3395887"}]}