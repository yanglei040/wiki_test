{"hands_on_practices": [{"introduction": "Before delving into complex simulation algorithms, it's crucial to have a firm grasp of the core mathematical conditions that underpin them. This first exercise provides a direct, hands-on check of the detailed balance and stationarity conditions for a simple two-state system. By working through this fundamental example, you will solidify your understanding of these definitions and see firsthand that while detailed balance is a sufficient condition for stationarity, a distribution that is not stationary can satisfy neither.", "problem": "A simplified model for the state of a single-core Central Processing Unit (CPU) in a server is described by a discrete-time Markov chain with two states: State 1 for 'Idle' and State 2 for 'Busy'. The state of the CPU is observed at regular, discrete time intervals.\n\nThe transition matrix $P$ for this Markov chain is given by:\n$$\nP = \\begin{pmatrix}\n0.9 & 0.1 \\\\\n0.4 & 0.6\n\\end{pmatrix}\n$$\nwhere the element $P_{ij}$ represents the probability of transitioning from state $i$ to state $j$ in one time step.\n\nA systems analyst proposes that the long-term probability distribution of the CPU being in either state is given by the vector $\\pi = (\\pi_1, \\pi_2)$, where $\\pi_1$ is the probability of being in the 'Idle' state and $\\pi_2$ is the probability of being in the 'Busy' state. The proposed distribution is $\\pi = (0.7, 0.3)$.\n\nThe detailed balance condition, a sufficient condition for a distribution to be stationary, is given by $\\pi_i P_{ij} = \\pi_j P_{ji}$ for all states $i, j$. Which of the following statements accurately describes the relationship between the proposed distribution $\\pi$ and this Markov chain?\n\nA. The detailed balance condition is satisfied.\n\nB. The distribution satisfies the condition for stationarity ($\\pi P = \\pi$), but the detailed balance condition is not satisfied.\n\nC. The detailed balance condition is not satisfied, but it is not possible to determine if the distribution is stationary from the information given.\n\nD. The distribution is not stationary, and the detailed balance condition is not satisfied.", "solution": "The problem asks us to evaluate a proposed distribution $\\pi = (0.7, 0.3)$ for a two-state Markov chain defined by the transition matrix $P = \\begin{pmatrix} 0.9 & 0.1 \\\\ 0.4 & 0.6 \\end{pmatrix}$. We need to check if the detailed balance condition is met and determine if the distribution is stationary.\n\nFirst, let's examine the detailed balance condition, which states that for a distribution $\\pi$ to be reversible with respect to a Markov chain $P$, the equation $\\pi_i P_{ij} = \\pi_j P_{ji}$ must hold for all pairs of states $i$ and $j$.\n\nFor a two-state system, we have states $i, j \\in \\{1, 2\\}$.\n- If $i = j$, the condition is trivially satisfied: $\\pi_1 P_{11} = \\pi_1 P_{11}$ and $\\pi_2 P_{22} = \\pi_2 P_{22}$.\n- The only non-trivial case to check is for $i=1$ and $j=2$. The condition for the pair $(2, 1)$ is identical.\n\nSo, we must check if $\\pi_1 P_{12} = \\pi_2 P_{21}$.\n\nThe given values are:\n- The proposed distribution: $\\pi = (\\pi_1, \\pi_2) = (0.7, 0.3)$.\n- The transition probabilities from the matrix $P$: $P_{12} = 0.1$ and $P_{21} = 0.4$.\n\nLet's calculate the left-hand side (LHS) of the detailed balance equation:\n$$\n\\text{LHS} = \\pi_1 P_{12} = (0.7) \\times (0.1) = 0.07\n$$\n\nNext, let's calculate the right-hand side (RHS) of the detailed balance equation:\n$$\n\\text{RHS} = \\pi_2 P_{21} = (0.3) \\times (0.4) = 0.12\n$$\n\nComparing the two sides, we see that $0.07 \\neq 0.12$. Therefore, the detailed balance condition is not satisfied for the proposed distribution $\\pi$. This immediately eliminates option A.\n\nNow, we need to determine if the distribution $\\pi$ is stationary. A distribution is stationary if it satisfies the equation $\\pi P = \\pi$. Let's compute the product of the distribution vector $\\pi$ and the transition matrix $P$:\n$$\n\\pi P = \\begin{pmatrix} 0.7 & 0.3 \\end{pmatrix} \\begin{pmatrix} 0.9 & 0.1 \\\\ 0.4 & 0.6 \\end{pmatrix}\n$$\nWe perform the matrix-vector multiplication:\n$$\n\\pi P = \\begin{pmatrix} (0.7)(0.9) + (0.3)(0.4) & (0.7)(0.1) + (0.3)(0.6) \\end{pmatrix}\n$$\n$$\n\\pi P = \\begin{pmatrix} 0.63 + 0.12 & 0.07 + 0.18 \\end{pmatrix}\n$$\n$$\n\\pi P = \\begin{pmatrix} 0.75 & 0.25 \\end{pmatrix}\n$$\n\nWe compare this result with the original proposed distribution $\\pi = (0.7, 0.3)$. Since $\\begin{pmatrix} 0.75 & 0.25 \\end{pmatrix} \\neq \\begin{pmatrix} 0.7 & 0.3 \\end{pmatrix}$, we have $\\pi P \\neq \\pi$. This means the proposed distribution is not stationary.\n\nAn important theoretical note for two-state Markov chains is that the stationarity condition is actually equivalent to the detailed balance condition. The stationarity equations are $\\pi_1 P_{11} + \\pi_2 P_{21} = \\pi_1$ and $\\pi_1 P_{12} + \\pi_2 P_{22} = \\pi_2$. Using the fact that matrix rows sum to 1 ($P_{11} = 1 - P_{12}$), the first equation becomes $\\pi_1(1-P_{12}) + \\pi_2 P_{21} = \\pi_1$, which simplifies to $-\\pi_1 P_{12} + \\pi_2 P_{21} = 0$, or $\\pi_1 P_{12} = \\pi_2 P_{21}$. This is precisely the detailed balance condition. Therefore, for a 2-state chain, if detailed balance fails, the distribution cannot be stationary.\n\nLet's evaluate the given options based on our findings:\nA. The detailed balance condition is satisfied. (False)\nB. The distribution satisfies the condition for stationarity, but the detailed balance condition is not satisfied. (False, because the distribution is not stationary. Also, this is impossible for a 2-state chain.)\nC. The detailed balance condition is not satisfied, but it is not possible to determine if the distribution is stationary from the information given. (False, we were able to determine it is not stationary.)\nD. The distribution is not stationary, and the detailed balance condition is not satisfied. (True)\n\nBoth conditions we checked (detailed balance and stationarity) failed for the proposed distribution $\\pi$. Thus, option D is the correct statement.", "answer": "$$\\boxed{D}$$", "id": "1660489"}, {"introduction": "In practice, ensuring a simulation correctly samples a target probability distribution, like the Boltzmann distribution, means carefully engineering the rules for proposing and accepting moves. This problem moves from definition to application by challenging you to correct a flawed Monte Carlo simulation that uses an incorrect acceptance criterion for asymmetric proposals. Deriving the proper Metropolis-Hastings acceptance rule from the principle of detailed balance is a cornerstone skill for anyone designing or implementing advanced sampling methods.", "problem": "A practitioner is using a Markov Chain Monte Carlo (MCMC) move embedded in a molecular dynamics workflow to sample the canonical ensemble of a system at temperature $T$. Let $E_i$ denote the energy of state $i$ and let $\\beta = 1/(k_B T)$ be the inverse thermal energy, where $k_B$ is the Boltzmann constant. Define the reduced energy $u_i = \\beta E_i$, so that the target equilibrium distribution is $\\pi(i) \\propto \\exp(-u_i)$.\n\nThe practitioner employs a state-dependent proposal mechanism $Q(i \\to j)$ to generate trial moves from state $i$ to state $j$, followed by an acceptance step $A(i \\to j)$, resulting in the one-step transition probability $W(i \\to j) = Q(i \\to j) A(i \\to j)$. Currently, the acceptance rule used is the symmetric Metropolis form $A_{\\mathrm{sym}}(i \\to j) = \\min\\{1, \\exp[-(u_j - u_i)]\\}$, which assumes symmetric proposals. However, the actual proposal probabilities are asymmetric.\n\nConsider two states with reduced energies $u_1 = 0$ and $u_2 = 1.3$. The proposal probabilities are $Q(1 \\to 2) = 0.80$ and $Q(2 \\to 1) = 0.20$. The goal is to diagnose the detailed balance violation and construct a corrected acceptance rule that restores detailed balance with respect to the target distribution $\\pi(i) \\propto \\exp(-u_i)$.\n\nStarting from first principles of the canonical ensemble and the definition of detailed balance for Markov chains, derive the acceptance rule that enforces detailed balance for asymmetric proposals, and compute the corrected acceptance probability $A^{\\star}(1 \\to 2)$ for the transition from state $1$ to state $2$ using the given $u_1$, $u_2$, $Q(1 \\to 2)$, and $Q(2 \\to 1)$.\n\nRound your final numerical answer for $A^{\\star}(1 \\to 2)$ to four significant figures. The acceptance probability is dimensionless; do not include units.", "solution": "The problem requires the derivation of a corrected acceptance rule for a Markov Chain Monte Carlo (MCMC) simulation that restores detailed balance for an asymmetric proposal mechanism, and the calculation of a specific acceptance probability.\n\nFirst, we establish the fundamental principles. A sufficient condition for a Markov chain to sample from a target equilibrium distribution $\\pi(i)$ is that the transition probabilities $W(i \\to j)$ satisfy the detailed balance condition. This condition ensures that at equilibrium, the total probability flux from any state $i$ to any state $j$ is equal to the flux from $j$ to $i$. Mathematically, this is expressed as:\n$$ \\pi(i) W(i \\to j) = \\pi(j) W(j \\to i) $$\nfor all pairs of states $(i, j)$.\n\nIn the context of this problem, the one-step transition probability $W(i \\to j)$ is composed of two parts: a proposal step with probability $Q(i \\to j)$ and an acceptance step with probability $A(i \\to j)$. The composite probability is $W(i \\to j) = Q(i \\to j) A(i \\to j)$ for $i \\neq j$. Substituting this into the detailed balance equation gives:\n$$ \\pi(i) Q(i \\to j) A(i \\to j) = \\pi(j) Q(j \\to i) A(j \\to i) $$\nThis equation is the core constraint that any valid acceptance rule must satisfy.\n\nThe problem states that the practitioner is using the symmetric Metropolis acceptance rule, $A_{\\mathrm{sym}}(i \\to j) = \\min\\{1, \\exp[-(u_j - u_i)]\\}$. This rule is derived under the assumption of symmetric proposals, where $Q(i \\to j) = Q(j \\to i)$. If we make this assumption, the proposal probabilities cancel out in the detailed balance constraint, leaving $\\pi(i) A(i \\to j) = \\pi(j) A(j \\to i)$. The symmetric Metropolis rule satisfies this simplified condition. However, the problem specifies that the proposal probabilities are asymmetric, with $Q(1 \\to 2) = 0.80$ and $Q(2 \\to 1) = 0.20$. Using an acceptance rule that assumes symmetry when the proposals are asymmetric violates the detailed balance condition, and the Markov chain will not converge to the correct target distribution $\\pi(i)$. This is the flaw in the practitioner's current methodology.\n\nTo derive the correct acceptance rule, we must rearrange the full detailed balance constraint to solve for the ratio of the acceptance probabilities:\n$$ \\frac{A(i \\to j)}{A(j \\to i)} = \\frac{\\pi(j)}{\\pi(i)} \\frac{Q(j \\to i)}{Q(i \\to j)} $$\nThe target distribution is the canonical ensemble distribution, $\\pi(i) \\propto \\exp(-\\beta E_i)$, where $E_i$ is the energy of state $i$. Using the given reduced energy $u_i = \\beta E_i$, the distribution is $\\pi(i) \\propto \\exp(-u_i)$. The ratio of probabilities for two states is therefore:\n$$ \\frac{\\pi(j)}{\\pi(i)} = \\frac{\\exp(-u_j)}{\\exp(-u_i)} = \\exp(-u_j + u_i) = \\exp[-(u_j - u_i)] $$\nSubstituting this into the acceptance ratio equation yields:\n$$ \\frac{A(i \\to j)}{A(j \\to i)} = \\exp[-(u_j - u_i)] \\frac{Q(j \\to i)}{Q(i \\to j)} $$\nThis is the general constraint that the acceptance rule must satisfy for asymmetric proposals. The most common choice for the acceptance probability that satisfies this ratio while maximizing the acceptance rate (and thus the efficiency of the sampling) is the Metropolis-Hastings acceptance rule. Let the right-hand side of the constraint be denoted by $\\rho_{ij}$:\n$$ \\rho_{ij} = \\exp[-(u_j - u_i)] \\frac{Q(j \\to i)}{Q(i \\to j)} $$\nThe Metropolis-Hastings acceptance probability is then given by:\n$$ A^{\\star}(i \\to j) = \\min\\{1, \\rho_{ij}\\} $$\nThis is the corrected acceptance rule that enforces detailed balance for any proposal mechanism $Q(i \\to j)$, symmetric or not.\n\nNow, we apply this derived rule to compute the specific acceptance probability $A^{\\star}(1 \\to 2)$ for the transition from state $1$ to state $2$. The given values are:\n- Reduced energy of state 1: $u_1 = 0$\n- Reduced energy of state 2: $u_2 = 1.3$\n- Proposal probability from 1 to 2: $Q(1 \\to 2) = 0.80$\n- Proposal probability from 2 to 1: $Q(2 \\to 1) = 0.20$\n\nWe identify $i=1$ and $j=2$. The corrected acceptance probability $A^{\\star}(1 \\to 2)$ is:\n$$ A^{\\star}(1 \\to 2) = \\min\\left\\{1, \\exp[-(u_2 - u_1)] \\frac{Q(2 \\to 1)}{Q(1 \\to 2)}\\right\\} $$\nFirst, we compute the argument of the $\\min$ function. The energy difference term is:\n$$ \\exp[-(u_2 - u_1)] = \\exp[-(1.3 - 0)] = \\exp(-1.3) $$\nThe ratio of proposal probabilities is:\n$$ \\frac{Q(2 \\to 1)}{Q(1 \\to 2)} = \\frac{0.20}{0.80} = 0.25 $$\nCombining these terms, we find $\\rho_{12}$:\n$$ \\rho_{12} = \\exp(-1.3) \\times 0.25 $$\nThe value of $\\exp(-1.3)$ is approximately $0.27253179...$. Therefore:\n$$ \\rho_{12} \\approx 0.27253179 \\times 0.25 = 0.06813295 $$\nSince $\\rho_{12}$ is less than $1$, the acceptance probability is equal to $\\rho_{12}$:\n$$ A^{\\star}(1 \\to 2) = \\min\\{1, 0.06813295\\} = 0.06813295 $$\nThe problem requires the final answer to be rounded to four significant figures. Rounding $0.06813295$ to four significant figures gives $0.06813$.", "answer": "$$\\boxed{0.06813}$$", "id": "3407505"}, {"introduction": "Detailed balance is not merely a mathematical convenience for algorithms; it is a manifestation of deep physical principles governing systems in thermal equilibrium. This advanced exercise explores this connection within the continuous-time framework of Langevin dynamics, which is fundamental to modeling molecular systems coupled to a heat bath. By analyzing a system with stochastic forces, you will derive a form of the fluctuation-dissipation theorem, revealing how detailed balance dictates the necessary relationship between random fluctuations and dissipative friction to maintain a stable temperature.", "problem": "Consider a single particle of mass $m$ moving in one spatial dimension with coordinate $x$ and momentum $p$ in a potential energy $U(x)$ at thermodynamic temperature $T$. The target equilibrium phase-space density is the Boltzmann distribution $\\pi(x,p) \\propto \\exp\\!\\big(-\\beta H(x,p)\\big)$ with inverse temperature $\\beta = 1/(k_B T)$, Boltzmann constant $k_B$, and Hamiltonian $H(x,p) = U(x) + p^2/(2m)$. Hamiltonian Monte Carlo (HMC) proposes moves by integrating Hamilton’s equations with a symplectic, reversible scheme, which preserves phase-space volume and (with a Metropolis accept/reject) detailed balance with respect to $\\pi(x,p)$.\n\nSuppose the force $-\\partial U/\\partial x$ is approximated during integration by a stochastic estimator whose error is modeled, in the small time-step limit, as additive Gaussian white noise in the momentum equation. Specifically, consider the stochastic differential equation (SDE)\n$$\n\\mathrm{d}x = \\frac{p}{m}\\,\\mathrm{d}t, \n\\qquad\n\\mathrm{d}p = -\\frac{\\partial U}{\\partial x}(x)\\,\\mathrm{d}t + \\sqrt{2\\,b}\\,\\mathrm{d}W_t,\n$$\nwhere $b > 0$ is a constant setting the strength of the force noise and $W_t$ is a standard Wiener process. \n\nUsing first principles:\n1. Derive the associated Fokker–Planck equation for the probability density $\\rho(x,p,t)$ and demonstrate, by direct substitution, whether the Boltzmann density $\\pi(x,p)$ is a stationary solution. Explain how this noisy forcing affects phase-space volume preservation and detailed balance in this context.\n2. To recover balance, consider augmenting the momentum dynamics with a linear friction term and a thermostat (Ornstein–Uhlenbeck type) noise,\n$$\n\\mathrm{d}p = -\\frac{\\partial U}{\\partial x}(x)\\,\\mathrm{d}t - \\gamma\\,p\\,\\mathrm{d}t + \\sqrt{2\\,\\alpha_{\\mathrm{th}}}\\,\\mathrm{d}B_t + \\sqrt{2\\,b}\\,\\mathrm{d}W_t,\n$$\nwhere $\\gamma \\ge 0$ is a constant friction coefficient, $\\alpha_{\\mathrm{th}} \\ge 0$ is a constant thermostat diffusion coefficient, and $B_t$ is an independent standard Wiener process. Derive, from the requirement that $\\pi(x,p)$ be stationary and that detailed balance hold with respect to $\\pi(x,p)$, a relation among $\\gamma$, $\\alpha_{\\mathrm{th}}$, and the physical parameters $m$, $k_B$, and $T$.\n\nFinally, determine the minimal friction coefficient $\\gamma_{\\min}$ for which one can choose a nonnegative $\\alpha_{\\mathrm{th}}$ to satisfy the stationarity and detailed balance conditions. Your final answer must be a single closed-form analytical expression for $\\gamma_{\\min}$ in terms of $b$, $m$, $k_B$, and $T$. Express the value of $\\gamma_{\\min}$ in units of $\\mathrm{s}^{-1}$. No numerical evaluation or rounding is required.", "solution": "### Part 1: Analysis of the Noisy Hamiltonian System\n\nThe system is described by the SDEs:\n$\\mathrm{d}x = \\frac{p}{m}\\,\\mathrm{d}t$\n$\\mathrm{d}p = -\\frac{\\partial U}{\\partial x}(x)\\,\\mathrm{d}t + \\sqrt{2\\,b}\\,\\mathrm{d}W_t$\n\nThis corresponds to a vector SDE $\\mathrm{d}\\mathbf{X}_t = \\mathbf{A}(\\mathbf{X}_t)\\,\\mathrm{d}t + \\mathbf{B}\\,\\mathrm{d}W_t$ with state vector $\\mathbf{X} = (x, p)^T$, drift vector $\\mathbf{A} = (\\frac{p}{m}, -\\frac{\\partial U}{\\partial x})^T$, and diffusion matrix $\\mathbf{B} = (0, \\sqrt{2b})^T$.\n\nThe associated Fokker-Planck equation for the probability density $\\rho(x,p,t)$ is given by:\n$$\n\\frac{\\partial \\rho}{\\partial t} = -\\sum_i \\frac{\\partial}{\\partial X_i} (A_i \\rho) + \\frac{1}{2} \\sum_{i,j} \\frac{\\partial^2}{\\partial X_i \\partial X_j} (D_{ij} \\rho)\n$$\nwhere $\\mathbf{D} = \\mathbf{B}\\mathbf{B}^T$ is the diffusion tensor. In our case:\n$$\n\\mathbf{D} = \\begin{pmatrix} 0 \\\\ \\sqrt{2b} \\end{pmatrix} \\begin{pmatrix} 0 & \\sqrt{2b} \\end{pmatrix} = \\begin{pmatrix} 0 & 0 \\\\ 0 & 2b \\end{pmatrix}\n$$\nThe Fokker-Planck equation is therefore:\n$$\n\\frac{\\partial \\rho}{\\partial t} = -\\frac{\\partial}{\\partial x}\\left(\\frac{p}{m}\\rho\\right) - \\frac{\\partial}{\\partial p}\\left(-\\frac{\\partial U}{\\partial x}\\rho\\right) + \\frac{1}{2}\\frac{\\partial^2}{\\partial p^2}(2b\\rho)\n$$\n$$\n\\frac{\\partial \\rho}{\\partial t} = -\\frac{\\partial}{\\partial x}\\left(\\frac{p}{m}\\rho\\right) + \\frac{\\partial}{\\partial p}\\left(\\frac{\\partial U}{\\partial x}\\rho\\right) + b\\frac{\\partial^2 \\rho}{\\partial p^2}\n$$\nTo check if the Boltzmann density $\\pi(x,p) = N \\exp(-\\beta H(x,p))$ is a stationary solution, we set $\\rho = \\pi$ and check if $\\frac{\\partial \\pi}{\\partial t} = 0$. The partial derivatives of $\\pi$ are:\n$$\n\\frac{\\partial \\pi}{\\partial x} = -\\beta \\frac{\\partial U}{\\partial x} \\pi, \\quad \\frac{\\partial \\pi}{\\partial p} = -\\beta \\frac{p}{m} \\pi\n$$\nSubstituting $\\pi$ into the stationary Fokker-Planck equation:\n$$\n0 \\stackrel{?}{=} -\\frac{\\partial}{\\partial x}\\left(\\frac{p}{m}\\pi\\right) + \\frac{\\partial}{\\partial p}\\left(\\frac{\\partial U}{\\partial x}\\pi\\right) + b\\frac{\\partial^2 \\pi}{\\partial p^2}\n$$\nThe terms evaluate to:\n$$\n-\\frac{\\partial}{\\partial x}\\left(\\frac{p}{m}\\pi\\right) = -\\frac{p}{m}\\frac{\\partial \\pi}{\\partial x} = -\\frac{p}{m}\\left(-\\beta \\frac{\\partial U}{\\partial x}\\pi\\right) = \\beta \\frac{p}{m}\\frac{\\partial U}{\\partial x}\\pi\n$$\n$$\n\\frac{\\partial}{\\partial p}\\left(\\frac{\\partial U}{\\partial x}\\pi\\right) = \\frac{\\partial U}{\\partial x}\\frac{\\partial \\pi}{\\partial p} = \\frac{\\partial U}{\\partial x}\\left(-\\beta \\frac{p}{m}\\pi\\right) = -\\beta \\frac{p}{m}\\frac{\\partial U}{\\partial x}\\pi\n$$\n$$\n\\frac{\\partial^2 \\pi}{\\partial p^2} = \\frac{\\partial}{\\partial p}\\left(-\\beta \\frac{p}{m}\\pi\\right) = -\\frac{\\beta}{m}\\pi - \\beta\\frac{p}{m}\\frac{\\partial \\pi}{\\partial p} = -\\frac{\\beta}{m}\\pi - \\beta\\frac{p}{m}\\left(-\\beta \\frac{p}{m}\\pi\\right) = \\left(-\\frac{\\beta}{m} + \\frac{\\beta^2 p^2}{m^2}\\right)\\pi\n$$\nSumming the terms:\n$$\n0 \\stackrel{?}{=} \\left(\\beta \\frac{p}{m}\\frac{\\partial U}{\\partial x}\\pi\\right) + \\left(-\\beta \\frac{p}{m}\\frac{\\partial U}{\\partial x}\\pi\\right) + b\\left(-\\frac{\\beta}{m} + \\frac{\\beta^2 p^2}{m^2}\\right)\\pi\n$$\n$$\n0 \\stackrel{?}{=} b\\left(-\\frac{\\beta}{m} + \\frac{\\beta^2 p^2}{m^2}\\right)\\pi\n$$\nSince $b > 0$, this equality does not hold for all $p$. Thus, $\\pi(x,p)$ is not a stationary solution.\n\nThe noisy forcing affects phase-space volume and detailed balance.\nPure Hamiltonian dynamics preserves phase-space volume, as expressed by Liouville's theorem, because the divergence of the Hamiltonian vector field is zero: $\\frac{\\partial}{\\partial x}(\\frac{p}{m}) + \\frac{\\partial}{\\partial p}(-\\frac{\\partial U}{\\partial x}) = 0$. The stochastic dynamics includes a diffusion term in the Fokker-Planck equation, $\\frac{\\partial^2}{\\partial p^2}(b \\rho)$, which causes the probability density to spread in the momentum direction. This diffusion process does not preserve the volume of a region in phase space.\nDetailed balance for the Boltzmann distribution $\\pi$ would require the net probability current between states to be zero. The stationary probability current is $\\mathbf{J} = \\mathbf{A}\\pi - \\frac{1}{2}\\nabla \\cdot (\\mathbf{D}\\pi)$. Since $\\pi$ is not stationary, detailed balance is not satisfied. The stochastic term continuously injects energy into the system by increasing momentum, acting as an effective \"heating\" source that is not balanced by any dissipative mechanism, preventing equilibration to the Boltzmann distribution.\n\n### Part 2: Analysis of the Augmented System\n\nThe augmented SDE is:\n$$\n\\mathrm{d}x = \\frac{p}{m}\\,\\mathrm{d}t, \n\\qquad\n\\mathrm{d}p = \\left(-\\frac{\\partial U}{\\partial x} - \\gamma p\\right)\\,\\mathrm{d}t + \\sqrt{2\\,\\alpha_{\\mathrm{th}}}\\,\\mathrm{d}B_t + \\sqrt{2\\,b}\\,\\mathrm{d}W_t\n$$\nThe drift vector is $\\mathbf{A'} = (\\frac{p}{m}, -\\frac{\\partial U}{\\partial x} - \\gamma p)^T$. Since $B_t$ and $W_t$ are independent, the variances of the noise terms add. The total diffusion in the $p$-direction has a coefficient of $\\alpha_{\\mathrm{th}} + b$. The diffusion tensor is $\\mathbf{D'} = \\begin{pmatrix} 0 & 0 \\\\ 0 & 2(\\alpha_{\\mathrm{th}} + b) \\end{pmatrix}$.\n\nThe Fokker-Planck equation becomes:\n$$\n\\frac{\\partial \\rho}{\\partial t} = -\\frac{\\partial}{\\partial x}\\left(\\frac{p}{m}\\rho\\right) - \\frac{\\partial}{\\partial p}\\left(\\left[-\\frac{\\partial U}{\\partial x} - \\gamma p\\right]\\rho\\right) + (\\alpha_{\\mathrm{th}} + b)\\frac{\\partial^2 \\rho}{\\partial p^2}\n$$\nWe require $\\pi(x,p)$ to be a stationary and detailed balance solution. The Fokker-Planck operator can be split into a Hamiltonian part and a thermostat part:\n$$\n\\frac{\\partial \\rho}{\\partial t} = \\left[-\\frac{p}{m}\\frac{\\partial \\rho}{\\partial x} + \\frac{\\partial U}{\\partial x}\\frac{\\partial \\rho}{\\partial p}\\right] + \\frac{\\partial}{\\partial p}\\left(\\gamma p \\rho + (\\alpha_{\\mathrm{th}} + b)\\frac{\\partial \\rho}{\\partial p}\\right)\n$$\nThe term in brackets is the Liouville operator, $L_H \\rho = -\\{H, \\rho\\}$. For $\\rho = \\pi$, which is a function of $H$, we have $\\{H, \\pi\\} = 0$. Therefore, for $\\pi$ to be a stationary solution, the second term must also be zero:\n$$\n\\frac{\\partial}{\\partial p}\\left(\\gamma p \\pi + (\\alpha_{\\mathrm{th}} + b)\\frac{\\partial \\pi}{\\partial p}\\right) = 0\n$$\nIntegrating with respect to $p$ and using the boundary condition that the probability current vanishes as $p \\to \\pm \\infty$, we find that the term in the parenthesis must be zero for all $p$:\n$$\n\\gamma p \\pi + (\\alpha_{\\mathrm{th}} + b)\\frac{\\partial \\pi}{\\partial p} = 0\n$$\nSubstituting $\\frac{\\partial \\pi}{\\partial p} = -\\beta \\frac{p}{m} \\pi$:\n$$\n\\gamma p \\pi + (\\alpha_{\\mathrm{th}} + b)\\left(-\\beta \\frac{p}{m} \\pi\\right) = 0\n$$\nFor this to hold for any $p \\neq 0$, the term in brackets must be zero:\n$$\n\\gamma - \\frac{\\beta}{m}(\\alpha_{\\mathrm{th}} + b) = 0\n$$\nThis condition ensures stationarity. It can be shown that it also ensures detailed balance. This is the fluctuation-dissipation relation for this system, which connects the friction $\\gamma$ (dissipation) to the total noise strength $\\alpha_{\\mathrm{th}} + b$ (fluctuation) and the temperature $T = 1/(k_B \\beta)$. The relation is:\n$$\n\\gamma = \\frac{\\alpha_{\\mathrm{th}} + b}{m k_B T}\n$$\n\n### Minimal Friction Coefficient $\\gamma_{\\min}$\n\nThe problem states that the thermostat diffusion coefficient must be non-negative, i.e., $\\alpha_{\\mathrm{th}} \\ge 0$. We need to find the minimal friction $\\gamma_{\\min}$ for which this condition can be satisfied. Rearranging the relation to solve for $\\alpha_{\\mathrm{th}}$:\n$$\n\\alpha_{\\mathrm{th}} = \\gamma m k_B T - b\n$$\nThe condition $\\alpha_{\\mathrm{th}} \\ge 0$ implies:\n$$\n\\gamma m k_B T - b \\ge 0\n$$\nSolving for $\\gamma$:\n$$\n\\gamma \\ge \\frac{b}{m k_B T}\n$$\nThe minimal value for the friction coefficient $\\gamma$ that allows one to choose a non-negative $\\alpha_{\\mathrm{th}}$ is therefore:\n$$\n\\gamma_{\\min} = \\frac{b}{m k_B T}\n$$\nThe units of this expression are indeed $\\mathrm{s}^{-1}$. This is the minimal friction required to dissipate the energy injected by the stochastic force noise of strength $b$ to maintain the target temperature $T$. A friction lower than this value would result in the system being \"hotter\" than the target temperature, a situation that cannot be remedied by adding more noise with a thermostat (since $\\alpha_{\\mathrm{th}}$ cannot be negative).", "answer": "$$\\boxed{\\frac{b}{m k_B T}}$$", "id": "3407518"}]}