{"hands_on_practices": [{"introduction": "The Born-Oppenheimer approximation provides a foundational separation of electronic and nuclear motion, but it is not an exact description of reality. This first exercise moves beyond the simplest approximation to explore the leading correction, the Diagonal Born-Oppenheimer Correction (DBOC). By deriving the scaling of the DBOC with nuclear mass for a diatomic molecule, you will gain a quantitative understanding of why the approximation is so effective for heavy nuclei and where its limitations become more apparent [@problem_id:3452076].", "problem": "Consider the non-relativistic molecular Hamiltonian for a diatomic molecule with nuclear coordinates $\\mathbf{R} = (\\mathbf{R}_A, \\mathbf{R}_B)$ and electronic coordinates $\\mathbf{r}$,\n$$\n\\hat{H} = \\hat{T}_{\\mathrm{e}} + \\hat{V}_{\\mathrm{ee}} + \\hat{V}_{\\mathrm{en}} + \\hat{V}_{\\mathrm{nn}} + \\hat{T}_{\\mathrm{n}},\n$$\nwhere $\\hat{T}_{\\mathrm{e}}$ is the electronic kinetic energy operator, $\\hat{T}_{\\mathrm{n}}$ is the nuclear kinetic energy operator, and the remaining terms are Coulomb interactions. The nuclear kinetic energy operator can be written as\n$$\n\\hat{T}_{\\mathrm{n}} = -\\sum_{A \\in \\{A,B\\}} \\frac{1}{2 M_A} \\nabla_{\\mathbf{R}_A}^{2},\n$$\nwith $M_A$ the mass of nucleus $A$. In the Born-Oppenheimer separation, the total wavefunction is represented as $\\Psi(\\mathbf{r},\\mathbf{R}) = \\psi_{\\mathrm{e}}(\\mathbf{r};\\mathbf{R})\\,\\chi(\\mathbf{R})$, where $\\psi_{\\mathrm{e}}(\\mathbf{r};\\mathbf{R})$ is an adiabatic electronic eigenfunction parametrized by the nuclear geometry, and $\\chi(\\mathbf{R})$ is the nuclear wavefunction. Beyond the leading Born-Oppenheimer approximation, a correction arises upon projecting the nuclear kinetic operator onto the electronic manifold, producing the so-called diagonal Born-Oppenheimer correction (DBOC). \n\nStarting from this setting and using only the definitions given above and first principles of projection onto the adiabatic electronic state, derive how the diagonal Born-Oppenheimer correction scales with nuclear masses and the square norm of electronic derivatives with respect to nuclear coordinates at the equilibrium bond length $R_{\\mathrm{e}}$. Restrict attention to the ground electronic state of a homonuclear diatomic molecule and assume the dominant contribution comes from derivatives along the one-dimensional internuclear separation coordinate $R$ near $R_{\\mathrm{e}}$.\n\nDefine an equilibrium electronic curvature factor for each species by\n$$\nC_{\\mathrm{e}}(X_{2}) \\equiv \\left\\langle \\partial_{R} \\psi_{\\mathrm{e}}(\\mathbf{r};R)\\,\\middle|\\,\\partial_{R} \\psi_{\\mathrm{e}}(\\mathbf{r};R)\\right\\rangle\\bigg|_{R=R_{\\mathrm{e}}}\n$$\nfor the homonuclear diatomic $X_{2}$ with nuclear mass $M_X$ per nucleus. Let $H_{2}$ be the hydrogen molecule with nuclear mass $m_{\\mathrm{H}}$ per nucleus, and let $I_{2}$ be the iodine molecule with nuclear mass $m_{\\mathrm{I}}$ per nucleus. Use the following masses expressed in unified atomic mass units (u):\n$$\nm_{\\mathrm{H}} = 1.007825\\ \\mathrm{u}, \\qquad m_{\\mathrm{I}} = 126.90447\\ \\mathrm{u}.\n$$\nAssume, for an order-of-magnitude estimate at equilibrium, that the ratio of electronic curvature factors satisfies\n$$\n\\frac{C_{\\mathrm{e}}(H_{2})}{C_{\\mathrm{e}}(I_{2})} \\approx 1.\n$$\n\nUnder these assumptions, determine the ratio\n$$\n\\frac{E_{\\mathrm{DBOC}}(H_{2};R_{\\mathrm{e}})}{E_{\\mathrm{DBOC}}(I_{2};R_{\\mathrm{e}})}\n$$\nas a single real-valued number. Express your final answer as a dimensionless number and round your answer to three significant figures.", "solution": "We begin from the non-relativistic Hamiltonian and the Born-Oppenheimer separation of electronic and nuclear degrees of freedom. The total wavefunction is written as $\\Psi(\\mathbf{r},\\mathbf{R}) = \\psi_{\\mathrm{e}}(\\mathbf{r};\\mathbf{R})\\,\\chi(\\mathbf{R})$, where $\\psi_{\\mathrm{e}}(\\mathbf{r};\\mathbf{R})$ solves the clamped-nuclei electronic problem\n$$\n\\hat{H}_{\\mathrm{e}}(\\mathbf{R})\\,\\psi_{\\mathrm{e}}(\\mathbf{r};\\mathbf{R}) = E_{\\mathrm{e}}(\\mathbf{R})\\,\\psi_{\\mathrm{e}}(\\mathbf{r};\\mathbf{R}),\n$$\nwith $\\hat{H}_{\\mathrm{e}}(\\mathbf{R}) = \\hat{T}_{\\mathrm{e}} + \\hat{V}_{\\mathrm{ee}} + \\hat{V}_{\\mathrm{en}} + \\hat{V}_{\\mathrm{nn}}$ treated parametrically in $\\mathbf{R}$. The nuclear kinetic energy operator is\n$$\n\\hat{T}_{\\mathrm{n}} = -\\sum_{A} \\frac{1}{2 M_A} \\nabla_{\\mathbf{R}_A}^{2},\n$$\nacting on the full wavefunction. When we substitute $\\Psi(\\mathbf{r},\\mathbf{R})$ into the full Schrödinger equation and project onto the adiabatic electronic state $\\psi_{\\mathrm{e}}(\\mathbf{r};\\mathbf{R})$, the action of $\\hat{T}_{\\mathrm{n}}$ generates terms involving derivatives of $\\psi_{\\mathrm{e}}(\\mathbf{r};\\mathbf{R})$ with respect to nuclear coordinates. The diagonal part of these non-adiabatic terms, obtained by integrating over electronic coordinates and retaining the norm of electronic derivatives, yields the diagonal Born-Oppenheimer correction (DBOC). In the single-state adiabatic representation, the diagonal correction at a geometry $\\mathbf{R}$ is\n$$\nE_{\\mathrm{DBOC}}(\\mathbf{R}) = \\sum_{A} \\frac{1}{2 M_A}\\,\\left\\langle \\partial_{\\mathbf{R}_A}\\psi_{\\mathrm{e}}(\\mathbf{r};\\mathbf{R})\\,\\middle|\\,\\partial_{\\mathbf{R}_A}\\psi_{\\mathrm{e}}(\\mathbf{r};\\mathbf{R})\\right\\rangle,\n$$\nwhere $\\partial_{\\mathbf{R}_A}$ denotes the gradient with respect to the nuclear coordinate of nucleus $A$, and the inner product is over electronic degrees of freedom. This expression follows from the projection of $\\hat{T}_{\\mathrm{n}}$ onto the adiabatic state and is positive definite, reflecting the kinetic energy associated with the parametric dependence of the electronic state on nuclear geometry.\n\nFor a homonuclear diatomic $X_{2}$ with equal nuclear masses $M_X$ and internuclear coordinate $R = |\\mathbf{R}_A - \\mathbf{R}_B|$, symmetry implies that the dominant contribution near equilibrium arises along the bond axis, and the two nuclei contribute equally to the derivative along $R$. Denoting the equilibrium bond length by $R_{\\mathrm{e}}$, we collect the derivative contributions into a one-dimensional curvature factor\n$$\nC_{\\mathrm{e}}(X_{2}) \\equiv \\left\\langle \\partial_{R}\\psi_{\\mathrm{e}}(\\mathbf{r};R)\\,\\middle|\\,\\partial_{R}\\psi_{\\mathrm{e}}(\\mathbf{r};R)\\right\\rangle\\bigg|_{R=R_{\\mathrm{e}}},\n$$\nso that the diagonal correction scales as\n$$\nE_{\\mathrm{DBOC}}(X_{2};R_{\\mathrm{e}}) \\propto \\frac{C_{\\mathrm{e}}(X_{2})}{M_X}.\n$$\nThe proportionality arises because the sum over the two identical nuclei in the full Cartesian derivative representation reduces, by symmetry and transformation to the bond coordinate, to an effective one-dimensional derivative whose squared norm is $C_{\\mathrm{e}}(X_{2})$, and the mass dependence enters through the inverse mass prefactor summed over nuclei, giving an overall $1/M_X$ scaling. An identical reasoning applies to $H_{2}$, with nuclear mass $m_{\\mathrm{H}}$ per nucleus, yielding\n$$\nE_{\\mathrm{DBOC}}(H_{2};R_{\\mathrm{e}}) \\propto \\frac{C_{\\mathrm{e}}(H_{2})}{m_{\\mathrm{H}}}, \\qquad\nE_{\\mathrm{DBOC}}(I_{2};R_{\\mathrm{e}}) \\propto \\frac{C_{\\mathrm{e}}(I_{2})}{m_{\\mathrm{I}}}.\n$$\nTherefore, the ratio of the diagonal corrections at equilibrium is\n$$\n\\frac{E_{\\mathrm{DBOC}}(H_{2};R_{\\mathrm{e}})}{E_{\\mathrm{DBOC}}(I_{2};R_{\\mathrm{e}})} \\approx \\frac{m_{\\mathrm{I}}}{m_{\\mathrm{H}}}\\,\\frac{C_{\\mathrm{e}}(H_{2})}{C_{\\mathrm{e}}(I_{2})}.\n$$\nFor an order-of-magnitude estimate, we are instructed to assume\n$$\n\\frac{C_{\\mathrm{e}}(H_{2})}{C_{\\mathrm{e}}(I_{2})} \\approx 1,\n$$\nwhich yields\n$$\n\\frac{E_{\\mathrm{DBOC}}(H_{2};R_{\\mathrm{e}})}{E_{\\mathrm{DBOC}}(I_{2};R_{\\mathrm{e}})} \\approx \\frac{m_{\\mathrm{I}}}{m_{\\mathrm{H}}}.\n$$\nUsing the provided masses in unified atomic mass units,\n$$\nm_{\\mathrm{H}} = 1.007825, \\qquad m_{\\mathrm{I}} = 126.90447,\n$$\nwe compute\n$$\n\\frac{m_{\\mathrm{I}}}{m_{\\mathrm{H}}} = \\frac{126.90447}{1.007825}.\n$$\nEvaluating this ratio,\n$$\n\\frac{126.90447}{1.007825} \\approx 125.919.\n$$\nRounding to three significant figures as required gives\n$$\n1.26 \\times 10^{2}.\n$$\nThis dimensionless number represents the order-of-magnitude by which the diagonal Born-Oppenheimer correction at equilibrium for $H_{2}$ exceeds that for $I_{2}$ under the stated assumptions.", "answer": "$$\\boxed{1.26 \\times 10^{2}}$$", "id": "3452076"}, {"introduction": "The validity of the Born-Oppenheimer approximation hinges on a significant energy gap between electronic states. This practice explores what happens when this condition is violated due to electronic degeneracy, a situation addressed by the Jahn-Teller theorem. You will construct a model Hamiltonian for a system with vibronic coupling and analyze the resulting potential energy surfaces to see firsthand how electronic degeneracy leads to symmetry breaking and the formation of a conical intersection, a key feature where non-adiabatic effects are dominant [@problem_id:3493325].", "problem": "Consider a coordination site in a crystalline material whose high-symmetry electronic ground state is twofold degenerate, transforming as the irreducible representation $E$ of the site point group. The lowest-energy vibrational distortion that couples to this electronic degeneracy is a doubly degenerate normal mode transforming as $e$, with mass-weighted normal coordinates $Q_{1}$ and $Q_{2}$ and a harmonic restoring force constant $K>0$. Work within the Born–Oppenheimer (BO) approximation, in which the electronic degrees of freedom adjust instantaneously to fixed nuclear positions, and treat the vibronic interaction to linear order in the nuclear displacements. Assume that the electronic reference energy at the high-symmetry geometry is set to zero.\n\nTasks:\n- Using symmetry considerations and the fact that the product representation $E \\otimes e$ contains the totally symmetric representation, construct the linear Jahn–Teller (JT) Hamiltonian for this $E \\otimes e$ problem. Your Hamiltonian should include the nuclear kinetic energy $T_{\\mathrm{nuc}}$, the harmonic potential $\\frac{1}{2}K(Q_{1}^{2}+Q_{2}^{2})$, and the lowest-order vibronic coupling term. In the electronic $E$ subspace, represent the linearly independent operators by two Pauli matrices $\\hat{\\tau}_{x}$ and $\\hat{\\tau}_{z}$.\n- Within the BO approximation, for fixed nuclear coordinates $(Q_{1},Q_{2})$, diagonalize the electronic part of the Hamiltonian to obtain the adiabatic electronic energies as functions of $(Q_{1},Q_{2})$, and write the two BO potential energy surfaces (PES) in terms of the polar coordinates $Q=\\sqrt{Q_{1}^{2}+Q_{2}^{2}}$ and $\\phi=\\arctan(Q_{2}/Q_{1})$.\n- Show explicitly that the lower BO PES has a symmetry-breaking minimum at a nonzero distortion amplitude due to the vibronic coupling, and determine the equilibrium distortion amplitude $Q_{0}$ in terms of the vibronic coupling constant $F$ and the force constant $K$.\n- Briefly explain, based on your derived PES, why the minimum is symmetry-breaking in the nuclear configuration space.\n\nReport the equilibrium distortion amplitude $Q_{0}$ as your final answer. Do not include units. No numerical evaluation is required.", "solution": "The total Hamiltonian $\\hat{H}$ for the system can be written as the sum of the nuclear kinetic energy, $T_{\\mathrm{nuc}}$, and the potential energy, which is a function of both nuclear coordinates $\\mathbf{Q} = (Q_1, Q_2)$ and electronic degrees of freedom. In the Born-Oppenheimer (BO) approximation, we first solve the electronic problem for fixed nuclei.\n\n**Part 1: Construction of the Hamiltonian**\n\nThe total Hamiltonian is given by $\\hat{H} = T_{\\mathrm{nuc}} + \\hat{H}_{\\mathrm{el}}(\\mathbf{Q})$, where $\\hat{H}_{\\mathrm{el}}(\\mathbf{Q})$ is the electronic Hamiltonian for a fixed nuclear configuration $\\mathbf{Q}$. The term $T_{\\mathrm{nuc}}$ is the kinetic energy operator for the nuclei. The electronic Hamiltonian is expanded around the high-symmetry geometry $\\mathbf{Q}=\\mathbf{0}$.\n$$\n\\hat{H}_{\\mathrm{el}}(\\mathbf{Q}) = \\hat{H}_{\\mathrm{el}}(\\mathbf{0}) + \\sum_{i=1,2} \\left(\\frac{\\partial \\hat{H}_{\\mathrm{el}}}{\\partial Q_i}\\right)_{\\mathbf{Q}=\\mathbf{0}} Q_i + \\frac{1}{2} \\sum_{i,j=1,2} \\left(\\frac{\\partial^2 E_0}{\\partial Q_i \\partial Q_j}\\right)_{\\mathbf{Q}=\\mathbf{0}} Q_i Q_j + \\dots\n$$\nThe first term, $\\hat{H}_{\\mathrm{el}}(\\mathbf{0})$, is the electronic Hamiltonian at the high-symmetry point. Its ground state is twofold degenerate, and we set its energy to $0$. The third term, involving the second derivatives of the ground-state energy, corresponds to the harmonic potential of the nuclei, which is given as $\\frac{1}{2}K(Q_1^2+Q_2^2)$. This term is a scalar operator in the electronic subspace, so it is proportional to the identity matrix $\\hat{I}$.\n\nThe second term is the linear vibronic coupling term, $\\hat{H}_{\\mathrm{vc}}$. For this term to be non-zero, the operator $\\left(\\frac{\\partial \\hat{H}_{\\mathrm{el}}}{\\partial Q_i}\\right)_{\\mathbf{Q}=\\mathbf{0}}$ must be totally symmetric. The operator transforms as the symmetric product $[E \\otimes E]_{\\mathrm{sym}}$, and the coordinates $(Q_1, Q_2)$ transform as $e$. The coupling term is a product of these, and for it to be non-zero (i.e., contain the totally symmetric representation), the direct product $[E \\otimes E]_{\\mathrm{sym}} \\otimes e$ must contain the totally symmetric representation. A more direct statement based on the Wigner-Eckart theorem is that a matrix element $\\langle \\psi_E | \\hat{H}_{\\mathrm{vc}} | \\psi_E' \\rangle$ is non-zero only if $E \\otimes e \\otimes E$ contains the totally symmetric representation, which is equivalent to $E \\otimes E$ containing $e$. The problem states that $E \\otimes e$ contains the totally symmetric representation, which implies the linear coupling is allowed.\n\nThe linear vibronic coupling Hamiltonian, $\\hat{H}_{\\mathrm{vc}}$, must be a linear combination of $Q_1$ and $Q_2$ and must be represented by a $2 \\times 2$ matrix in the degenerate $E$ subspace. The basis operators for $2 \\times 2$ Hermitian matrices are the identity $\\hat{I}$ and the three Pauli matrices. The problem specifies using $\\hat{\\tau}_z$ and $\\hat{\\tau}_x$. In the basis of the two degenerate electronic states, we can write:\n$$\n\\hat{\\tau}_z = \\begin{pmatrix} 1 & 0 \\\\ 0 & -1 \\end{pmatrix}, \\quad \\hat{\\tau}_x = \\begin{pmatrix} 0 & 1 \\\\ 1 & 0 \\end{pmatrix}\n$$\nThe most general linear vibronic coupling Hamiltonian is of the form $\\hat{H}_{\\mathrm{vc}} = F(Q_1\\hat{O}_1 + Q_2\\hat{O}_2)$, where $\\hat{O}_1$ and $\\hat{O}_2$ are electronic operators and $F$ is a coupling constant. By symmetry, the operators and coordinates must couple in a way that creates a scalar. The standard form for the $E \\otimes e$ problem is:\n$$\n\\hat{H}_{\\mathrm{vc}} = F(Q_1 \\hat{\\tau}_z + Q_2 \\hat{\\tau}_x)\n$$\nCombining all terms, the full Jahn-Teller Hamiltonian is:\n$$\n\\hat{H} = T_{\\mathrm{nuc}}\\hat{I} + \\frac{1}{2}K(Q_1^2+Q_2^2)\\hat{I} + F(Q_1\\hat{\\tau}_z + Q_2\\hat{\\tau}_x)\n$$\nThis is the Hamiltonian for the coupled vibronic system.\n\n**Part 2: Born-Oppenheimer Potential Energy Surfaces**\n\nWithin the BO approximation, we treat the nuclear coordinates $(Q_1, Q_2)$ as fixed parameters and diagonalize the electronic part of the Hamiltonian, $\\hat{H}_{\\mathrm{el}}(Q_1, Q_2)$. The eigenvalues of this matrix are the BO potential energy surfaces (PES).\n$$\n\\hat{H}_{\\mathrm{el}}(Q_1,Q_2) = \\frac{1}{2}K(Q_1^2+Q_2^2)\\hat{I} + F(Q_1\\hat{\\tau}_z + Q_2\\hat{\\tau}_x) = \\begin{pmatrix} \\frac{1}{2}K(Q_1^2+Q_2^2) + FQ_1 & FQ_2 \\\\ FQ_2 & \\frac{1}{2}K(Q_1^2+Q_2^2) - FQ_1 \\end{pmatrix}\n$$\nTo find the eigenvalues $E_{\\mathrm{el}}$, we solve the characteristic equation $\\det(\\hat{H}_{\\mathrm{el}} - E_{\\mathrm{el}}\\hat{I}) = 0$.\n$$\n\\left( \\frac{1}{2}K(Q_1^2+Q_2^2) + FQ_1 - E_{\\mathrm{el}} \\right) \\left( \\frac{1}{2}K(Q_1^2+Q_2^2) - FQ_1 - E_{\\mathrm{el}} \\right) - (FQ_2)^2 = 0\n$$\n$$\n\\left( \\frac{1}{2}K(Q_1^2+Q_2^2) - E_{\\mathrm{el}} \\right)^2 - (FQ_1)^2 - (FQ_2)^2 = 0\n$$\n$$\n\\left( E_{\\mathrm{el}} - \\frac{1}{2}K(Q_1^2+Q_2^2) \\right)^2 = F^2(Q_1^2+Q_2^2)\n$$\nTaking the square root of both sides gives:\n$$\nE_{\\mathrm{el}} - \\frac{1}{2}K(Q_1^2+Q_2^2) = \\pm \\sqrt{F^2(Q_1^2+Q_2^2)} = \\pm |F|\\sqrt{Q_1^2+Q_2^2}\n$$\nLet's assume $F > 0$ without loss of generality, as its sign can be absorbed into the definition of the electronic basis. The two BO potential energy surfaces are:\n$$\nE_{\\pm}(Q_1,Q_2) = \\frac{1}{2}K(Q_1^2+Q_2^2) \\pm F\\sqrt{Q_1^2+Q_2^2}\n$$\nIn polar coordinates, $Q = \\sqrt{Q_1^2+Q_2^2}$ and $\\phi = \\arctan(Q_2/Q_1)$, these surfaces become:\n$$\nE_{\\pm}(Q, \\phi) = \\frac{1}{2}KQ^2 \\pm FQ\n$$\nThe surfaces are independent of the angle $\\phi$, giving them a characteristic \"Mexican hat\" shape. The upper surface is $E_+(Q)$ and the lower surface is $E_-(Q)$.\n\n**Part 3: Equilibrium Distortion Amplitude**\n\nTo find a stable equilibrium geometry, we must find the minimum of the potential energy surfaces. The upper surface $E_+(Q)$ has its minimum at $Q=0$. The lower surface $E_-(Q) = \\frac{1}{2}KQ^2 - FQ$ is the one relevant for the ground state of the system. We find its minimum by taking the derivative with respect to $Q$ and setting it to zero.\n$$\n\\frac{dE_-}{dQ} = \\frac{d}{dQ}\\left(\\frac{1}{2}KQ^2 - FQ\\right) = KQ - F\n$$\nSetting the derivative to zero:\n$$\nKQ - F = 0 \\implies Q = \\frac{F}{K}\n$$\nLet's denote this equilibrium distortion amplitude as $Q_0$. So, $Q_0 = \\frac{F}{K}$. To confirm this is a minimum, we check the second derivative:\n$$\n\\frac{d^2E_-}{dQ^2} = K\n$$\nSince $K>0$ is given, this is indeed a minimum. The high-symmetry point $Q=0$ is no longer the minimum of the ground-state potential energy surface. The energy at this minimum is $E_-(Q_0) = \\frac{1}{2}K(F/K)^2 - F(F/K) = \\frac{F^2}{2K} - \\frac{F^2}{K} = -\\frac{F^2}{2K}$. This is the Jahn-Teller stabilization energy.\n\n**Part 4: Explanation of Symmetry Breaking**\n\nThe original, undistorted system has its nuclear configuration at $(Q_1, Q_2) = (0, 0)$, which corresponds to $Q=0$. This configuration possesses the full point group symmetry of the coordination site. At this point, a conical intersection of the two PESs occurs, $E_+(0) = E_-(0) = 0$, reflecting the electronic degeneracy.\nOur analysis showed that the minimum of the ground-state potential energy surface $E_-(Q)$ is not at $Q=0$, but at a finite distortion amplitude $Q_0 = F/K > 0$. This means the system can lower its energy by distorting away from the high-symmetry configuration.\nThe set of all minima is given by the condition $Q = \\sqrt{Q_1^2+Q_2^2} = Q_0$, which defines a continuous circular trough of minimum energy in the $(Q_1, Q_2)$ nuclear configuration space. Any particular point on this circle, such as $(Q_0, 0)$ or $(0, Q_0)$, corresponds to a specific distorted geometry. Such a distorted geometry will necessarily have a lower symmetry than the undistorted configuration at $(0, 0)$. For example, if the initial symmetry is octahedral ($O_h$) and the mode is of $e_g$ symmetry, a distortion along one of the coordinate axes in the $(Q_1,Q_2)$ space corresponds to a tetragonal distortion of the octahedron, which reduces the symmetry to $D_{4h}$. Because the system spontaneously adopts one of these lower-symmetry configurations to minimize its energy, we say that the symmetry of the nuclear framework is broken. This is a direct consequence of the vibronic coupling, as shown by the Jahn-Teller theorem.", "answer": "$$\n\\boxed{\\frac{F}{K}}\n$$", "id": "3493325"}, {"introduction": "To fully capture phenomena like photochemistry or charge transfer, we must model the dynamics of nuclei as they navigate regions where electronic states are strongly coupled. This comprehensive practice guides you through simulating a non-adiabatic event from start to finish, combining classical molecular dynamics with quantum mechanical principles [@problem_id:3452111]. You will compute the non-adiabatic coupling vectors along a trajectory passing through an avoided crossing, directly identifying the regions where the Born-Oppenheimer approximation fails and transitions between potential energy surfaces become probable.", "problem": "Consider a one-dimensional effective model for a linear triatomic system in the Born–Oppenheimer framework. The nuclear configuration is represented by a single mass-weighted reaction coordinate $R$ that approximates a symmetry-adapted stretching mode. The electronic Hamiltonian $\\hat{H}_e(R)$ acts on a two-dimensional diabatic electronic subspace spanned by fixed orthonormal diabatic basis states. The adiabatic electronic states $\\{ \\lvert \\phi_i(R) \\rangle \\}$ and adiabatic energies $\\{ E_i(R) \\}$ are defined as the normalized eigenvectors and eigenvalues of $\\hat{H}_e(R)$ at each $R$. The nonadiabatic coupling vector between adiabatic states $i$ and $j$ is defined by the Born–Oppenheimer separation as $d_{ij}(R) = \\langle \\phi_i(R) \\lvert \\nabla_R \\rvert \\phi_j(R) \\rangle$. In the one-dimensional model, $\\nabla_R$ reduces to $\\frac{d}{dR}$, so $d_{ij}(R)$ is a scalar function of $R$. This nonadiabatic coupling governs the breakdown of the Born–Oppenheimer approximation when $\\lvert d_{ij}(R) \\rvert$ becomes large in the region visited by a classical molecular dynamics trajectory.\n\nYou will work with the following specific model in a diabatic representation:\n- The diabatic Hamiltonian is\n$$\n\\hat{H}_e(R) = \n\\begin{pmatrix}\n\\varepsilon_1(R) & V(R) \\\\\nV(R) & \\varepsilon_2(R)\n\\end{pmatrix},\n$$\nwhere the diabatic energies are linear and antisymmetric about a crossing point $R_c$,\n$$\n\\varepsilon_1(R) = \\alpha \\, (R - R_c), \\quad \\varepsilon_2(R) = -\\alpha \\, (R - R_c),\n$$\nand the diabatic coupling is a localized Gaussian,\n$$\nV(R) = V_0 \\exp\\left( - \\frac{(R - R_c)^2}{2 \\sigma^2} \\right).\n$$\n- The system is propagated classically on the lower adiabatic surface $E_-(R)$ using Newton’s second law with a scalar nuclear mass $\\mu$, position $R(t)$, and velocity $v(t) = \\dot{R}(t)$. The force is $F(R) = - \\frac{d E_-(R)}{dR}$.\n\nAll physical quantities must be expressed in atomic units: energies in Hartree, lengths in Bohr, time in atomic time units, mass in electron-mass atomic units, and Planck’s constant reduced ($\\hbar$) equal to $1$.\n\nYour tasks are:\n1) Starting from the time-independent electronic Schrödinger equation $\\hat{H}_e(R) \\lvert \\phi_j(R) \\rangle = E_j(R) \\lvert \\phi_j(R) \\rangle$ and the definition of the nonadiabatic coupling, derive a computable expression for $d_{ij}(R)$ in terms of $\\frac{d \\hat{H}_e}{dR}$, $E_i(R)$, $E_j(R)$, and the adiabatic eigenvectors $\\lvert \\phi_i(R) \\rangle$, for $i \\neq j$. Implement the resulting expression to evaluate $d_{12}(R)$ at any $R$ for the model Hamiltonian above.\n2) Implement classical molecular dynamics on $E_-(R)$ using a second-order accurate symplectic integrator to compute a trajectory $R(t)$ and $v(t)$ for given initial conditions $(R_0, v_0)$, mass $\\mu$, total time $T$, and time step $\\Delta t$. Use a numerically stable and convergent approximation for $F(R)$ at each integration step.\n3) Along the computed trajectory, evaluate $\\lvert d_{12}(R) \\rvert$ at each visited $R$ and identify:\n   - The maximum value $\\max_t \\lvert d_{12}(R(t)) \\rvert$.\n   - The location $R^\\star$ where this maximum occurs, chosen as the $R$ value at the time step where the maximum is attained.\n   - A boolean indicator of Born–Oppenheimer breakdown along the trajectory, defined as $\\mathrm{breaks} = \\text{True}$ if $\\max_t \\lvert d_{12}(R(t)) \\rvert > \\tau$ and $\\text{False}$ otherwise, with threshold $\\tau = 1.0$ in units of $\\text{Bohr}^{-1}$.\n4) Using the Landau–Zener model for linear diabatic crossings with constant diabatic coupling near $R_c$, relate the computed trajectory to a nonadiabatic transition probability. Assume that near $R_c$ the diabatic energy difference is $\\Delta\\varepsilon(R) = \\varepsilon_1(R) - \\varepsilon_2(R) \\approx \\beta \\, (R - R_c)$ with slope $\\beta = 2 \\alpha$, and that the diabatic coupling is approximately constant and equal to $V_0$ at $R_c$. Let $v_c$ be the magnitude of the velocity evaluated at the point on the trajectory closest to $R_c$. Under these assumptions, compute the Landau–Zener nonadiabatic transition probability between adiabatic surfaces,\n$$\nP_{\\mathrm{LZ}} = \\exp\\left( - \\frac{2 \\pi \\, V_0^2}{\\hbar \\, \\lvert \\beta \\, v_c \\rvert} \\right),\n$$\nwith $\\hbar = 1$ in atomic units.\n\nNumerical and implementation requirements:\n- Use the adiabatic eigenpairs $\\{E_\\pm(R), \\lvert \\phi_\\pm(R) \\rangle\\}$ obtained by diagonalizing $\\hat{H}_e(R)$ to compute forces and nonadiabatic couplings.\n- For the force $F(R) = - \\frac{d E_-(R)}{dR}$, use a numerically stable central difference approximation that converges as the finite-difference step goes to zero.\n- For $d_{12}(R)$, use the expression you derived in step $1)$ and evaluate it exactly at the current $R$ via matrix elements of $\\frac{d \\hat{H}_e}{dR}$ and the adiabatic eigenvectors at that $R$.\n- Mapping Born–Oppenheimer breakdown: use the threshold $\\tau = 1.0$ in $\\text{Bohr}^{-1}$.\n- Angle units are not used. Any fraction must be expressed as a decimal number.\n- Express all lengths in Bohr, velocities in Bohr per atomic time unit, derivative couplings in $\\text{Bohr}^{-1}$, and probabilities as dimensionless decimals.\n\nTest suite:\nImplement your program to run the following three test cases, each defined by the parameter tuple $(\\alpha, R_c, V_0, \\sigma, \\mu, R_0, v_0, T, \\Delta t)$, all in the units specified above:\n- Case A (happy path): $(\\alpha, R_c, V_0, \\sigma, \\mu, R_0, v_0, T, \\Delta t) = (0.02, 3.0, 0.005, 0.5, 5000.0, 1.0, 0.05, 400.0, 0.2)$.\n- Case B (small coupling edge): $(\\alpha, R_c, V_0, \\sigma, \\mu, R_0, v_0, T, \\Delta t) = (0.02, 3.0, 0.0005, 0.5, 5000.0, 0.0, 0.1, 300.0, 0.2)$.\n- Case C (slow heavy mass, stronger coupling): $(\\alpha, R_c, V_0, \\sigma, \\mu, R_0, v_0, T, \\Delta t) = (0.02, 3.0, 0.02, 0.5, 20000.0, 1.0, 0.02, 500.0, 0.2)$.\n\nRequired outputs:\n- For each case, compute and return the list $[\\max \\lvert d_{12} \\rvert, R^\\star, P_{\\mathrm{LZ}}, \\mathrm{breaks}]$ with $\\max \\lvert d_{12} \\rvert$ in $\\text{Bohr}^{-1}$, $R^\\star$ in Bohr, $P_{\\mathrm{LZ}}$ dimensionless, and $\\mathrm{breaks}$ a boolean.\n- Your program should produce a single line of output containing the results for the three test cases as a list of lists, each inner list formatted as $[\\text{float with }6\\text{ decimals}, \\text{float with }6\\text{ decimals}, \\text{float with }6\\text{ decimals}, \\text{boolean}]$, and the entire collection enclosed in square brackets, for example: $[[x_1,y_1,z_1,b_1],[x_2,y_2,z_2,b_2],[x_3,y_3,z_3,b_3]]$. Do not print unit symbols; values must be in the units specified above.", "solution": "The solution requires a multi-step approach involving theoretical derivation, numerical implementation of classical dynamics, and analysis of nonadiabatic effects. Each task is addressed sequentially.\n\n### 1. Derivation and Implementation of the Nonadiabatic Coupling\n\nThe first task is to derive a computable expression for the nonadiabatic coupling vector, $d_{ij}(R)$, for a one-dimensional system where $i \\neq j$. The nonadiabatic coupling is defined as $d_{ij}(R) = \\langle \\phi_i(R) \\lvert \\frac{d}{dR} \\rvert \\phi_j(R) \\rangle$, where $\\lvert \\phi_i(R) \\rangle$ are the adiabatic electronic states.\n\nWe begin with the time-independent electronic Schrödinger equation for state $j$:\n$$\n\\hat{H}_e(R) \\lvert \\phi_j(R) \\rangle = E_j(R) \\lvert \\phi_j(R) \\rangle\n$$\nWe differentiate this equation with respect to the nuclear coordinate $R$:\n$$\n\\frac{d}{dR} \\left( \\hat{H}_e(R) \\lvert \\phi_j(R) \\rangle \\right) = \\frac{d}{dR} \\left( E_j(R) \\lvert \\phi_j(R) \\rangle \\right)\n$$\nApplying the product rule to both sides yields:\n$$\n\\left( \\frac{d\\hat{H}_e}{dR} \\right) \\lvert \\phi_j \\rangle + \\hat{H}_e \\left( \\frac{d}{dR} \\lvert \\phi_j \\rangle \\right) = \\left( \\frac{dE_j}{dR} \\right) \\lvert \\phi_j \\rangle + E_j \\left( \\frac{d}{dR} \\lvert \\phi_j \\rangle \\right)\n$$\nNext, we project this equation onto another adiabatic state $\\lvert \\phi_i \\rangle$ by taking the inner product with $\\langle \\phi_i \\rvert$ from the left, for $i \\neq j$:\n$$\n\\langle \\phi_i \\rvert \\left( \\frac{d\\hat{H}_e}{dR} \\right) \\lvert \\phi_j \\rangle + \\langle \\phi_i \\rvert \\hat{H}_e \\left( \\frac{d}{dR} \\lvert \\phi_j \\rangle \\right) = \\left( \\frac{dE_j}{dR} \\right) \\langle \\phi_i \\rvert \\phi_j \\rangle + E_j \\langle \\phi_i \\rvert \\left( \\frac{d}{dR} \\lvert \\phi_j \\rangle \\right)\n$$\nWe use the properties of the adiabatic eigenstates. Since they are eigenfunctions of the Hermitian operator $\\hat{H}_e$, we have $\\langle \\phi_i \\rvert \\hat{H}_e = E_i \\langle \\phi_i \\rvert$. Also, the eigenstates are orthonormal, so $\\langle \\phi_i \\rvert \\phi_j \\rangle = \\delta_{ij}$. For $i \\neq j$, this term is zero. Substituting these into the equation simplifies it to:\n$$\n\\langle \\phi_i \\rvert \\frac{d\\hat{H}_e}{dR} \\lvert \\phi_j \\rangle + E_i \\langle \\phi_i \\rvert \\frac{d}{dR} \\lvert \\phi_j \\rangle = (0) + E_j \\langle \\phi_i \\rvert \\frac{d}{dR} \\lvert \\phi_j \\rangle\n$$\nThe term $\\langle \\phi_i \\rvert \\frac{d}{dR} \\lvert \\phi_j \\rangle$ is precisely the nonadiabatic coupling $d_{ij}(R)$. Rearranging the equation to solve for $d_{ij}(R)$:\n$$\n\\langle \\phi_i \\rvert \\frac{d\\hat{H}_e}{dR} \\lvert \\phi_j \\rangle = (E_j(R) - E_i(R)) \\langle \\phi_i \\rvert \\frac{d}{dR} \\lvert \\phi_j \\rangle\n$$\n$$\nd_{ij}(R) = \\frac{\\langle \\phi_i(R) \\rvert \\frac{d\\hat{H}_e}{dR} \\lvert \\phi_j(R) \\rangle}{E_j(R) - E_i(R)}, \\quad \\text{for } i \\neq j\n$$\nThis is the off-diagonal Hellmann-Feynman theorem. To use this formula for the given model, we need the derivative of the diabatic Hamiltonian $\\hat{H}_e(R)$:\n$$\n\\hat{H}_e(R) = \n\\begin{pmatrix}\n\\alpha(R-R_c) & V_0 \\exp(-\\frac{(R-R_c)^2}{2\\sigma^2}) \\\\\nV_0 \\exp(-\\frac{(R-R_c)^2}{2\\sigma^2}) & -\\alpha(R-R_c)\n\\end{pmatrix}\n$$\nThe derivative with respect to $R$ is:\n$$\n\\frac{d\\hat{H}_e}{dR} = \n\\begin{pmatrix}\n\\alpha & -\\frac{R-R_c}{\\sigma^2} V(R) \\\\\n-\\frac{R-R_c}{\\sigma^2} V(R) & -\\alpha\n\\end{pmatrix}\n$$\nIn the implementation, for any given $R$, we first numerically diagonalize $\\hat{H}_e(R)$ to obtain the adiabatic energies $E_1(R)$ (lower, $E_-$) and $E_2(R)$ (upper, $E_+$) and their corresponding eigenvectors $\\lvert \\phi_1(R) \\rangle$ and $\\lvert \\phi_2(R) \\rangle$. We then construct the matrix $\\frac{d\\hat{H}_e}{dR}$ and compute the coupling $d_{12}(R)$ using the derived formula.\n\n### 2. Classical Molecular Dynamics\nThe nuclear motion evolves on the lower adiabatic potential energy surface $E_-(R)$, which we will denote as $E_1(R)$, according to Newton's second law:\n$$\n\\mu \\ddot{R}(t) = F(R(t)) = -\\frac{dE_1(R(t))}{dR}\n$$\nWe integrate this equation of motion using the Velocity Verlet algorithm, a second-order accurate and symplectic integrator. Given the state $(R(t), v(t))$, the state at time $t+\\Delta t$ is computed as:\n1.  $v(t + \\frac{\\Delta t}{2}) = v(t) + \\frac{F(R(t))}{2\\mu} \\Delta t$\n2.  $R(t + \\Delta t) = R(t) + v(t + \\frac{\\Delta t}{2}) \\Delta t$\n3.  Calculate the new force $F(R(t + \\Delta t))$ at the updated position.\n4.  $v(t + \\Delta t) = v(t + \\frac{\\Delta t}{2}) + \\frac{F(R(t + \\Delta t))}{2\\mu} \\Delta t$\n\nThe force $F(R) = -\\frac{dE_1(R)}{dR}$ is computed numerically using a central difference approximation for stability and accuracy:\n$$\nF(R) \\approx -\\frac{E_1(R+\\delta R) - E_1(R-\\delta R)}{2\\delta R}\n$$\nwhere $\\delta R$ is a small displacement (e.g., $10^{-6}$ Bohr). Computing $E_1(R)$ requires diagonalizing the Hamiltonian $\\hat{H}_e(R)$ at the specified coordinate.\n\n### 3. Trajectory Analysis for Nonadiabaticity\nA classical trajectory $\\{R(t_k), v(t_k)\\}$ is generated over the total time $T$. Along this trajectory, we assess the magnitude of the nonadiabatic coupling. At each point $R_k = R(t_k)$, we compute $d_{12}(R_k)$ using the method from Part 1. We then identify:\n-   $\\max_t \\lvert d_{12}(R(t)) \\rvert$: The maximum absolute value of the coupling observed during the simulation.\n-   $R^\\star$: The position $R(t)$ at which this maximum coupling occurs.\n-   $\\mathrm{breaks}$: A boolean flag, set to $\\text{True}$ if $\\max_t \\lvert d_{12}(R(t)) \\rvert > \\tau$ with the threshold $\\tau=1.0\\,\\text{Bohr}^{-1}$, and $\\text{False}$ otherwise.\n\n### 4. Landau–Zener Transition Probability\nThe Landau-Zener formula provides an estimate for the probability of a nonadiabatic transition (from the lower to the upper adiabatic surface) as the system passes through the avoided crossing region near $R_c$. The formula is:\n$$\nP_{\\mathrm{LZ}} = \\exp\\left( - \\frac{2 \\pi \\, V_0^2}{\\hbar \\, \\lvert \\beta \\, v_c \\rvert} \\right)\n$$\nIn this expression:\n-   $V_0$ is the diabatic coupling at the center of the interaction region, $R_c$.\n-   $\\beta = 2\\alpha$ is the magnitude of the difference in the slopes of the linear diabatic potentials at $R_c$.\n-   $v_c$ is the magnitude of the nuclear velocity at the point on the trajectory that is closest to $R_c$.\n-   $\\hbar=1$ in atomic units.\n\nTo compute $P_{\\mathrm{LZ}}$, we first search the generated trajectory $\\{R(t_k)\\}$ to find the time step where $\\lvert R(t_k) - R_c \\rvert$ is minimized. The velocity at this time step, $v(t_k)$, gives us $v_c = \\lvert v(t_k) \\rvert$. We then substitute the parameters into the formula. If $v_c$ is zero, the system spends infinite time at the crossing, ensuring an adiabatic transition, so $P_{\\mathrm{LZ}}=0$.\n\nThese four components are integrated into a single program to process the specified test cases and generate the required outputs.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the simulations for all test cases and print the results.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (alpha, Rc, V0, sigma, mu, R0, v0, T, dt)\n        (0.02, 3.0, 0.005, 0.5, 5000.0, 1.0, 0.05, 400.0, 0.2),\n        (0.02, 3.0, 0.0005, 0.5, 5000.0, 0.0, 0.1, 300.0, 0.2),\n        (0.02, 3.0, 0.02, 0.5, 20000.0, 1.0, 0.02, 500.0, 0.2),\n    ]\n\n    results = []\n    for case_params in test_cases:\n        result = run_simulation(*case_params)\n        results.append(result)\n\n    # Format the final output string\n    output_parts = []\n    for res in results:\n        max_d12, R_star, P_LZ, breaks = res\n        part = f\"[{max_d12:.6f},{R_star:.6f},{P_LZ:.6f},{str(breaks).capitalize()}]\"\n        output_parts.append(part)\n    \n    print(f\"[{','.join(output_parts)}]\")\n\ndef run_simulation(alpha, Rc, V0, sigma, mu, R0, v0, T, dt):\n    \"\"\"\n    Executes a single molecular dynamics simulation and analysis for a given set of parameters.\n    \"\"\"\n    \n    # Finite difference step for force calculation\n    FD_STEP = 1e-6\n    # Breakdown threshold for nonadiabatic coupling\n    BO_BREAKDOWN_THRESHOLD = 1.0\n\n    # --- Helper functions for the physical model ---\n    \n    def get_hamiltonian(R):\n        \"\"\"Returns the 2x2 diabatic Hamiltonian matrix at a given position R.\"\"\"\n        e1 = alpha * (R - Rc)\n        e2 = -alpha * (R - Rc)\n        V = V0 * np.exp(-(R - Rc)**2 / (2 * sigma**2))\n        return np.array([[e1, V], [V, e2]])\n\n    def get_hamiltonian_derivative(R):\n        \"\"\"Returns the derivative of the Hamiltonian matrix w.r.t. R.\"\"\"\n        V = V0 * np.exp(-(R - Rc)**2 / (2 * sigma**2))\n        dV_dR = -(R - Rc) / sigma**2 * V\n        return np.array([[alpha, dV_dR], [dV_dR, -alpha]])\n\n    def get_lower_adiabatic_energy(R):\n        \"\"\"Returns the lower adiabatic potential energy E_-(R).\"\"\"\n        H = get_hamiltonian(R)\n        # For a 2x2 matrix, eigenvalues can be found analytically or numerically.\n        # np.linalg.eigh is robust and returns sorted eigenvalues.\n        evals, _ = np.linalg.eigh(H)\n        return evals[0]\n\n    def get_force(R):\n        \"\"\"Computes the force on the lower adiabatic surface using central differences.\"\"\"\n        E_plus = get_lower_adiabatic_energy(R + FD_STEP)\n        E_minus = get_lower_adiabatic_energy(R - FD_STEP)\n        force = -(E_plus - E_minus) / (2 * FD_STEP)\n        return force\n\n    def compute_d12(R):\n        \"\"\"Computes the nonadiabatic coupling d_12(R) between the two adiabatic states.\"\"\"\n        H = get_hamiltonian(R)\n        evals, evecs = np.linalg.eigh(H)\n        \n        E1, E2 = evals[0], evals[1]\n        phi1, phi2 = evecs[:, 0], evecs[:, 1]\n        \n        energy_diff = E2 - E1\n        if np.isclose(energy_diff, 0):\n            # At a true crossing, coupling is infinite, but model has avoided crossing\n            return np.inf\n\n        dH_dR = get_hamiltonian_derivative(R)\n        \n        # Numerator: <phi1 | dH/dR | phi2>\n        # Note: evecs are column vectors, so phi1.T @ ...\n        numerator = phi1.T @ dH_dR @ phi2\n        \n        return numerator / energy_diff\n\n    # --- Molecular Dynamics Simulation ---\n    \n    num_steps = int(T / dt)\n    R_traj = np.zeros(num_steps + 1)\n    v_traj = np.zeros(num_steps + 1)\n    \n    R_traj[0] = R0\n    v_traj[0] = v0\n    \n    current_R = R0\n    current_v = v0\n    current_F = get_force(current_R)\n\n    # Velocity Verlet integrator\n    for i in range(num_steps):\n        v_half = current_v + 0.5 * current_F / mu * dt\n        current_R = current_R + v_half * dt\n        current_F = get_force(current_R)\n        current_v = v_half + 0.5 * current_F / mu * dt\n        \n        R_traj[i+1] = current_R\n        v_traj[i+1] = current_v\n        \n    # --- Post-Simulation Analysis ---\n    \n    # 1. Landau-Zener Probability (P_LZ)\n    closest_idx = np.argmin(np.abs(R_traj - Rc))\n    vc = np.abs(v_traj[closest_idx])\n    beta = 2 * alpha\n    \n    if np.isclose(vc, 0.0) or np.isclose(beta, 0.0):\n        P_LZ = 0.0\n    else:\n        exponent = -2 * np.pi * V0**2 / np.abs(beta * vc)\n        P_LZ = np.exp(exponent)\n        \n    # 2. Maximum Nonadiabatic Coupling and Breakdown Check\n    d12_traj = np.array([compute_d12(R) for R in R_traj])\n    abs_d12_traj = np.abs(d12_traj)\n    \n    max_d12_idx = np.argmax(abs_d12_traj)\n    max_d12 = abs_d12_traj[max_d12_idx]\n    R_star = R_traj[max_d12_idx]\n    \n    breaks = max_d12 > BO_BREAKDOWN_THRESHOLD\n\n    return max_d12, R_star, P_LZ, breaks\n\nif __name__ == '__main__':\n    solve()\n\n```", "id": "3452111"}]}