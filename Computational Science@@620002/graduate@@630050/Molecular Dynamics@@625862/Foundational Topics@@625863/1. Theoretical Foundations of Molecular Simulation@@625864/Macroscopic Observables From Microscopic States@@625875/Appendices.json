{"hands_on_practices": [{"introduction": "In statistical mechanics, temperature is a fundamental concept that bridges the microscopic and macroscopic worlds. This exercise explores the idea that temperature is not defined by a single microscopic quantity, but can be expressed through both kinetic degrees of freedom (momenta) and configurational degrees of freedom (forces and potential energy). By deriving estimators for both the kinetic temperature, $T_K$, and the configurational temperature, $T_C$, from first principles [@problem_id:3423095], you will gain a deeper understanding of the equipartition theorem and the rich structure of the canonical ensemble.", "problem": "Consider a classical Molecular Dynamics (MD) system of $N$ point particles in three spatial dimensions with positions $\\{\\mathbf{r}_i\\}_{i=1}^{N}$, momenta $\\{\\mathbf{p}_i\\}_{i=1}^{N}$, and masses $\\{m_i\\}_{i=1}^{N}$. The Hamiltonian is $H = K + U$, where the kinetic energy is $K = \\sum_{i=1}^{N} \\frac{|\\mathbf{p}_i|^2}{2 m_i}$ and the potential energy is $U(\\{\\mathbf{r}_i\\})$. The system is simulated under periodic boundary conditions with the center-of-mass (COM) momentum constrained to be zero. Assume the system is in the canonical ensemble at temperature $T$, and that macroscopic observables are estimated from instantaneous microscopic states.\n\nStarting from first principles appropriate to this context, specifically:\n- Hamiltonian mechanics and the definition of phase-space averages in the canonical ensemble, and\n- the equipartition theorem for quadratic degrees of freedom,\n\nperform the following:\n1. Derive an explicit instantaneous kinetic temperature estimator $T_{\\mathrm{K}}$ expressed purely in terms of the momenta $\\{\\mathbf{p}_i\\}$, masses $\\{m_i\\}$, and the number of unconstrained degrees of freedom. Do not assume identical masses.\n2. Using only the canonical ensemble definition of configurational averages and rigorous manipulations (e.g., Gauss' theorem or integration by parts on configuration space), derive an explicit instantaneous configurational temperature estimator $T_{\\mathrm{C}}$ in terms of $\\nabla U$ and $\\nabla^2 U$.\n3. Specialize $U$ to a pairwise additive Lennard–Jones potential in three dimensions,\n$$\nU(\\{\\mathbf{r}_i\\}) = \\sum_{1 \\leq i < j \\leq N} v(r_{ij}), \\quad v(r) = 4 \\varepsilon \\left[ \\left(\\frac{\\sigma}{r}\\right)^{12} - \\left(\\frac{\\sigma}{r}\\right)^{6} \\right], \\quad r_{ij} = |\\mathbf{r}_i - \\mathbf{r}_j|,\n$$\nand obtain a closed-form expression for the instantaneous configurational temperature $T_{\\mathrm{C}}$ for the specific microstate with $N = 2$, $\\mathbf{r}_1 = (\\sigma, 0, 0)$, $\\mathbf{r}_2 = (2\\sigma, 0, 0)$.\nProvide the explicit analytical expressions requested in parts (1) and (2), and the final computed expression from part (3). Express all temperatures in Kelvin. If any numerical approximation is required, round your answer to four significant figures; otherwise, provide exact closed-form expressions.", "solution": "The problem statement is found to be valid. It is scientifically grounded in the principles of classical statistical mechanics and molecular dynamics, is well-posed, objective, and internally consistent. We proceed with the derivations as requested.\n\nThe first part of the problem requires the derivation of the instantaneous kinetic temperature estimator, $T_{\\mathrm{K}}$. In the canonical ensemble, the equipartition theorem states that for a classical system in thermal equilibrium at temperature $T$, the average energy associated with any degree of freedom that appears quadratically in the Hamiltonian is $\\frac{1}{2} k_B T$, where $k_B$ is the Boltzmann constant. The kinetic energy of the system of $N$ particles in $3$ dimensions is given by:\n$$K = \\sum_{i=1}^{N} \\frac{|\\mathbf{p}_i|^2}{2 m_i} = \\sum_{i=1}^{N} \\left( \\frac{p_{ix}^2}{2 m_i} + \\frac{p_{iy}^2}{2 m_i} + \\frac{p_{iz}^2}{2 m_i} \\right)$$\nThis expression is a sum of $3N$ quadratic terms, one for each momentum component. The ensemble average of the kinetic energy is $\\langle K \\rangle$. According to the equipartition theorem, the average energy for each quadratic momentum term is $\\langle \\frac{p_{i\\alpha}^2}{2 m_i} \\rangle = \\frac{1}{2} k_B T$, for $\\alpha \\in \\{x, y, z\\}$. The problem specifies that the center-of-mass (COM) momentum is constrained to be zero:\n$$\\mathbf{P}_{\\mathrm{COM}} = \\sum_{i=1}^{N} \\mathbf{p}_i = \\mathbf{0}$$\nThis constitutes $3$ scalar constraints on the momentum components (i.e., $\\sum_{i=1}^{N} p_{ix} = 0$, $\\sum_{i=1}^{N} p_{iy} = 0$, $\\sum_{i=1}^{N} p_{iz} = 0$). Therefore, the number of independent, unconstrained quadratic degrees of freedom in the kinetic energy term is not $3N$, but $N_{\\mathrm{DOF}} = 3N - 3$. The total average kinetic energy is the sum of the average energies of these independent degrees of freedom:\n$$\\langle K \\rangle = (3N - 3) \\times \\frac{1}{2} k_B T$$\nAn instantaneous estimator for temperature is obtained by assuming that the instantaneous value of a macroscopic observable is equal to its ensemble average. Let $T_{\\mathrm{K}}$ be this instantaneous kinetic temperature. We set the instantaneous kinetic energy $K_{\\mathrm{inst}}$ equal to its expectation value:\n$$K_{\\mathrm{inst}} = \\sum_{i=1}^{N} \\frac{|\\mathbf{p}_i|^2}{2 m_i} = \\frac{3N-3}{2} k_B T_{\\mathrm{K}}$$\nSolving for $T_{\\mathrm{K}}$ yields the desired estimator:\n$$T_{\\mathrm{K}} = \\frac{2K_{\\mathrm{inst}}}{(3N - 3)k_B} = \\frac{1}{(3N - 3)k_B} \\sum_{i=1}^{N} \\frac{|\\mathbf{p}_i|^2}{m_i}$$\n\nThe second part of the problem requires the derivation of the instantaneous configurational temperature estimator, $T_{\\mathrm{C}}$. This is derived from properties of the potential energy function $U(\\{\\mathbf{r}_i\\})$ in the canonical ensemble. The ensemble average of an observable $A(\\{\\mathbf{r}_i\\})$, which depends only on particle positions $\\{\\mathbf{r}_i\\}$, is given by:\n$$\\langle A \\rangle = \\frac{\\int A(\\{\\mathbf{r}_i\\}) \\exp(-\\beta U(\\{\\mathbf{r}_i\\})) d^{3N}\\mathbf{r}}{\\int \\exp(-\\beta U(\\{\\mathbf{r}_i\\})) d^{3N}\\mathbf{r}}$$\nwhere $\\beta = 1/(k_B T)$ and the integral is over the $3N$-dimensional configuration space. Let $\\nabla = (\\nabla_{\\mathbf{r}_1}, \\dots, \\nabla_{\\mathbf{r}_N})$ be the gradient operator in this space. We consider the identity resulting from applying the divergence theorem (integration by parts) to the vector field $\\mathbf{V} = (\\nabla U) \\exp(-\\beta U)$. Its divergence is:\n$$\\nabla \\cdot \\mathbf{V} = (\\nabla^2 U) \\exp(-\\beta U) + (\\nabla U) \\cdot \\nabla[\\exp(-\\beta U)]$$\nUsing the chain rule, $\\nabla[\\exp(-\\beta U)] = -\\beta (\\nabla U) \\exp(-\\beta U)$, we get:\n$$\\nabla \\cdot [(\\nabla U) \\exp(-\\beta U)] = \\left[ \\nabla^2 U - \\beta |\\nabla U|^2 \\right] \\exp(-\\beta U)$$\nwhere $|\\nabla U|^2 = (\\nabla U) \\cdot (\\nabla U) = \\sum_{i=1}^{N} |\\nabla_{\\mathbf{r}_i} U|^2$ and $\\nabla^2 U = \\nabla \\cdot (\\nabla U) = \\sum_{i=1}^{N} \\nabla_{\\mathbf{r}_i}^2 U$. Integrating this divergence over the entire configuration space volume $\\Omega$ and applying the divergence theorem yields a boundary integral that vanishes for periodic or confined systems. Thus:\n$$0 = \\int_{\\Omega} \\left[ \\nabla^2 U - \\beta |\\nabla U|^2 \\right] \\exp(-\\beta U) d^{3N}\\mathbf{r}$$\nThis implies $\\int (\\nabla^2 U) \\exp(-\\beta U) d^{3N}\\mathbf{r} = \\beta \\int |\\nabla U|^2 \\exp(-\\beta U) d^{3N}\\mathbf{r}$, which in terms of ensemble averages is $\\langle \\nabla^2 U \\rangle = \\beta \\langle |\\nabla U|^2 \\rangle$. Substituting $\\beta = 1/(k_B T)$ gives $k_B T = \\frac{\\langle |\\nabla U|^2 \\rangle}{\\langle \\nabla^2 U \\rangle}$. The instantaneous configurational temperature estimator, $T_{\\mathrm{C}}$, is obtained by dropping the ensemble averages:\n$$T_{\\mathrm{C}} = \\frac{|\\nabla U|^2}{k_B \\nabla^2 U} = \\frac{\\sum_{i=1}^{N} |\\nabla_{\\mathbf{r}_i} U|^2}{k_B \\sum_{i=1}^{N} \\nabla_{\\mathbf{r}_i}^2 U}$$\n\nThe third part requires specializing $T_{\\mathrm{C}}$ for $N=2$ particles interacting via a Lennard-Jones potential, $v(r)$, for a specific configuration. For a two-particle system, $U(\\mathbf{r}_1, \\mathbf{r}_2) = v(r_{12})$ where $r_{12} = |\\mathbf{r}_1 - \\mathbf{r}_2|$. Let $r=r_{12}$. The required terms are:\n$$|\\nabla U|^2 = |\\nabla_{\\mathbf{r}_1} U|^2 + |\\nabla_{\\mathbf{r}_2} U|^2 = 2(v'(r))^2$$\n$$\\nabla^2 U = \\nabla_{\\mathbf{r}_1}^2 U + \\nabla_{\\mathbf{r}_2}^2 U = 2\\left(v''(r) + \\frac{2}{r} v'(r)\\right)$$\nThis gives an expression for $k_B T_{\\mathrm{C}}$ for a two-particle system:\n$$k_B T_{\\mathrm{C}} = \\frac{2(v'(r))^2}{2(v''(r) + \\frac{2}{r} v'(r))} = \\frac{(v'(r))^2}{v''(r) + \\frac{2}{r} v'(r)}$$\nThe Lennard-Jones potential is $v(r) = 4 \\varepsilon [ (\\frac{\\sigma}{r})^{12} - (\\frac{\\sigma}{r})^{6} ]$. Its derivatives are:\n$$v'(r) = \\frac{24\\varepsilon}{r}\\left[-2\\left(\\frac{\\sigma}{r}\\right)^{12} + \\left(\\frac{\\sigma}{r}\\right)^{6}\\right]$$\n$$v''(r) = \\frac{4\\varepsilon}{r^2}\\left[156\\left(\\frac{\\sigma}{r}\\right)^{12} - 42\\left(\\frac{\\sigma}{r}\\right)^{6}\\right]$$\nThe given microstate is $\\mathbf{r}_1 = (\\sigma, 0, 0)$ and $\\mathbf{r}_2 = (2\\sigma, 0, 0)$, so the distance is $r = |\\mathbf{r}_1 - \\mathbf{r}_2| = \\sigma$. We evaluate the derivatives at $r=\\sigma$:\n$$v'(\\sigma) = \\frac{24\\varepsilon}{\\sigma}[-2(1)^{12} + (1)^6] = -\\frac{24\\varepsilon}{\\sigma}$$\n$$v''(\\sigma) = \\frac{4\\varepsilon}{\\sigma^2}[156(1)^{12} - 42(1)^6] = \\frac{456\\varepsilon}{\\sigma^2}$$\nSubstituting these into the expression for $k_B T_{\\mathrm{C}}$:\n$$k_B T_{\\mathrm{C}} = \\frac{\\left(-\\frac{24\\varepsilon}{\\sigma}\\right)^2}{\\frac{456\\varepsilon}{\\sigma^2} + \\frac{2}{\\sigma}\\left(-\\frac{24\\varepsilon}{\\sigma}\\right)} = \\frac{\\frac{576\\varepsilon^2}{\\sigma^2}}{\\frac{456\\varepsilon}{\\sigma^2} - \\frac{48\\varepsilon}{\\sigma^2}} = \\frac{576\\varepsilon^2/\\sigma^2}{408\\varepsilon/\\sigma^2} = \\frac{576}{408}\\varepsilon$$\nThe fraction simplifies to $\\frac{576}{408} = \\frac{24 \\times 24}{24 \\times 17} = \\frac{24}{17}$.\nSo, $k_B T_{\\mathrm{C}} = \\frac{24}{17}\\varepsilon$. The final expression for the temperature is:\n$$T_{\\mathrm{C}} = \\frac{24\\varepsilon}{17k_B}$$\nThis completes the three parts of the problem.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{1}{(3N-3)k_B} \\sum_{i=1}^{N} \\frac{|\\mathbf{p}_i|^2}{m_i} & \\frac{\\sum_{i=1}^{N} |\\nabla_{\\mathbf{r}_i} U|^2}{k_B \\sum_{i=1}^{N} \\nabla_{\\mathbf{r}_i}^2 U} & \\frac{24\\varepsilon}{17k_B}\n\\end{pmatrix}\n}\n$$", "id": "3423095"}, {"introduction": "Calculating transport coefficients is a primary application of molecular dynamics, but the finite size and periodic boundary conditions of simulations can introduce systematic errors. This practice focuses on the self-diffusion coefficient, $D$, which is artificially reduced by the hydrodynamic interactions between a particle and its own periodic images. You will derive the leading-order correction for this effect [@problem_id:3423093], providing a powerful example of how to link discrete particle simulations with continuum theories to recover accurate macroscopic properties.", "problem": "A single spherical solute diffuses in a Newtonian, incompressible solvent simulated by Molecular Dynamics (MD) under periodic boundary conditions (PBC) in a cubic box of side length $L$. The solvent is at temperature $T$ and has shear viscosity $\\eta$. You measure a finite-size self-diffusion coefficient $D(L)$ from the long-time slope of the solute mean-squared displacement. The macroscopic observable $D(L)$ arises from microscopic dynamics via linear response and hydrodynamics.\n\nStarting from fundamental bases appropriate for this context, namely the Einstein relation for diffusion, the Fluctuation-Dissipation Theorem (FDT), and the Stokes flow limit of the Navier–Stokes equations, derive the leading-order finite-size correction to the self-mobility in a cubic periodically replicated fluid and use it to obtain an expression for the infinite-system self-diffusion coefficient $D_{\\infty}$ in terms of $D(L)$, $T$, $\\eta$, and $L$. You may use the known dimensionless lattice-sum constant for a cubic periodic array, $\\xi = 2.837297$, which arises from the Ewald summation of the Oseen tensor in the Stokes limit.\n\nThen, for the following scientifically realistic parameters:\n- Box length $L = 3.000 \\times 10^{-9}\\,\\mathrm{m}$,\n- Temperature $T = 298.0\\,\\mathrm{K}$,\n- Shear viscosity $\\eta = 8.90 \\times 10^{-4}\\,\\mathrm{Pa\\cdot s}$,\n- Measured finite-size diffusion coefficient $D(L) = 1.900 \\times 10^{-9}\\,\\mathrm{m^2/s}$,\n- Boltzmann constant $k_B = 1.380\\,649 \\times 10^{-23}\\,\\mathrm{J/K}$,\n\ncompute the infinite-system self-diffusion coefficient $D_{\\infty}$. Round your answer to four significant figures. Express the final diffusion coefficient in $\\mathrm{m^2/s}$.", "solution": "The problem is valid. It is a well-posed, scientifically grounded problem in computational statistical mechanics, asking for the derivation and application of the leading-order finite-size correction for the diffusion coefficient in a periodic system. All required information is provided, and the parameters are physically realistic.\n\nThe problem is to relate the diffusion coefficient $D(L)$ measured in a cubic box of side length $L$ to the diffusion coefficient in an infinitely large system, $D_{\\infty}$. This relationship can be derived by considering the effect of periodic boundary conditions on the hydrodynamic interactions of the diffusing solute with the solvent.\n\nWe begin with the Einstein relation, which connects the diffusion coefficient $D$ to the mobility $\\mu$ of the particle and the thermal energy $k_B T$:\n$$D = \\mu k_B T$$\nwhere $k_B$ is the Boltzmann constant and $T$ is the absolute temperature. This relation holds for both the finite-size system and the infinite system:\n$$D(L) = \\mu(L) k_B T$$\n$$D_{\\infty} = \\mu_{\\infty} k_B T$$\nThe task thus reduces to finding the relationship between the mobility in the finite system, $\\mu(L)$, and the mobility in the infinite system, $\\mu_{\\infty}$.\n\nMobility, $\\mu$, is a measure of a particle's velocity response to an external force. For a particle subject to a constant external force $\\mathbf{F}_{\\text{ext}}$, it reaches a terminal velocity $\\mathbf{v}$ proportional to the force: $\\mathbf{v} = \\mu \\mathbf{F}_{\\text{ext}}$. The proportionality constant is the mobility. The Fluctuation-Dissipation Theorem (FDT) provides the microscopic foundation for this linear response relationship and connects it to equilibrium fluctuations, but the core of this problem lies in a hydrodynamic argument.\n\nIn an infinite, incompressible Newtonian fluid of viscosity $\\eta$, a point-like particle experiencing a force $\\mathbf{F}$ moves with a velocity $\\mathbf{v}$. This motion induces a velocity field $\\mathbf{u}(\\mathbf{r})$ in the surrounding fluid. In the limit of low Reynolds number (Stokes flow), this is described by the Stokes equations. A point force $\\mathbf{F}$ at the origin generates a velocity field given by the Oseen tensor, $\\mathbf{T}(\\mathbf{r})$:\n$$\\mathbf{u}(\\mathbf{r}) = \\mathbf{T}(\\mathbf{r}) \\cdot \\mathbf{F}$$\nwhere\n$$\\mathbf{T}_{ij}(\\mathbf{r}) = \\frac{1}{8 \\pi \\eta r} \\left( \\delta_{ij} + \\frac{r_i r_j}{r^2} \\right)$$\nfor a position vector $\\mathbf{r}$ with magnitude $r$ and components $r_i, r_j$.\n\nThe mobility of the particle itself, $\\mu_{\\infty}$, is related to the friction it experiences. For a spherical particle of radius $a$, Stokes' law gives a friction coefficient $\\zeta_{\\infty} = 6 \\pi \\eta a$, and the mobility is $\\mu_{\\infty} = 1/\\zeta_{\\infty}$. While our derivation will be for a point particle, the concept of mobility holds.\n\nIn a system with periodic boundary conditions (PBC), the particle interacts not only with the surrounding fluid but also with its own periodic images. A force $\\mathbf{F}$ on the particle at the origin induces velocity fields from all its images located at lattice vectors $L\\mathbf{n}$, where $\\mathbf{n}$ is a vector of integers $(n_x, n_y, n_z)$. The velocity of the fluid at the particle's position ($\\mathbf{r}=\\mathbf{0}$) is affected by the flow fields generated by all its images ($\\mathbf{n} \\neq \\mathbf{0}$). This is the hydrodynamic backflow.\n\nThe velocity of the particle, $\\mathbf{v}(L)$, is its velocity in an infinite medium, $\\mathbf{v}_{\\infty} = \\mu_{\\infty} \\mathbf{F}$, minus this backflow velocity, $\\mathbf{v}_{\\text{backflow}}$:\n$$\\mathbf{v}(L) = \\mu_{\\infty}\\mathbf{F} - \\mathbf{v}_{\\text{backflow}}$$\nThe backflow velocity is the sum of the velocity fields induced by the force $\\mathbf{F}$ acting on each image particle, evaluated at the position of the central particle:\n$$\\mathbf{v}_{\\text{backflow}} = \\sum_{\\mathbf{n} \\in \\mathbb{Z}^3, \\mathbf{n} \\neq \\mathbf{0}} \\mathbf{T}(L\\mathbf{n}) \\cdot \\mathbf{F}$$\nHere, the sum is over all non-zero integer vectors $\\mathbf{n}$.\n\nCombining these, the velocity of the particle in the periodic system is:\n$$\\mathbf{v}(L) = \\left( \\mu_{\\infty}\\mathbf{I} - \\sum_{\\mathbf{n} \\neq \\mathbf{0}} \\mathbf{T}(L\\mathbf{n}) \\right) \\cdot \\mathbf{F}$$\nwhere $\\mathbf{I}$ is the identity tensor. The term in the parentheses is the effective mobility tensor in the finite system, $\\mathbf{M}(L)$. For a cubic lattice, symmetry dictates that this tensor is isotropic, i.e., $\\mathbf{M}(L) = \\mu(L)\\mathbf{I}$. The scalar mobility $\\mu(L)$ is one-third of its trace:\n$$\\mu(L) = \\frac{1}{3} \\text{Tr}(\\mathbf{M}(L)) = \\mu_{\\infty} - \\frac{1}{3} \\text{Tr}\\left( \\sum_{\\mathbf{n} \\neq \\mathbf{0}} \\mathbf{T}(L\\mathbf{n}) \\right)$$\n\nWe need to compute the trace of the Oseen tensor:\n$$\\text{Tr}(\\mathbf{T}(\\mathbf{r})) = \\sum_{i=1}^{3} \\mathbf{T}_{ii}(\\mathbf{r}) = \\frac{1}{8 \\pi \\eta r} \\sum_{i=1}^{3} \\left( \\delta_{ii} + \\frac{r_i^2}{r^2} \\right) = \\frac{1}{8 \\pi \\eta r} \\left( 3 + \\frac{r_1^2+r_2^2+r_3^2}{r^2} \\right) = \\frac{1}{8 \\pi \\eta r} (3 + 1) = \\frac{1}{2 \\pi \\eta r}$$\nSubstituting this into the expression for $\\mu(L)$:\n$$\\mu(L) = \\mu_{\\infty} - \\frac{1}{3} \\sum_{\\mathbf{n} \\neq \\mathbf{0}} \\frac{1}{2 \\pi \\eta |L\\mathbf{n}|} = \\mu_{\\infty} - \\frac{1}{6 \\pi \\eta L} \\sum_{\\mathbf{n} \\neq \\mathbf{0}} \\frac{1}{|\\mathbf{n}|}$$\nThe sum $\\sum_{\\mathbf{n} \\neq \\mathbf{0}} \\frac{1}{|\\mathbf{n}|}$ is a dimensionless lattice sum that depends on the geometry of the periodic cell. For a simple cubic lattice, this sum, evaluated using Ewald summation techniques to handle its conditional convergence, is given by the constant $\\xi$. The problem provides its value: $\\xi = 2.837297$.\n\nThus, the leading-order finite-size correction to the mobility is:\n$$\\mu(L) = \\mu_{\\infty} - \\frac{\\xi}{6 \\pi \\eta L}$$\nThis shows that the mobility in a finite periodic system is reduced compared to the infinite system due to the induced drag from periodic images.\n\nNow, we use the Einstein relations to convert this back to an expression for diffusion coefficients:\n$$\\frac{D(L)}{k_B T} = \\frac{D_{\\infty}}{k_B T} - \\frac{\\xi}{6 \\pi \\eta L}$$\nMultiplying by $k_B T$, we get the relation between the diffusion coefficients:\n$$D(L) = D_{\\infty} - \\frac{k_B T \\xi}{6 \\pi \\eta L}$$\nThis is the celebrated Dünweg-Kremer correction for the self-diffusion coefficient.\n\nThe problem asks for an expression for $D_{\\infty}$ in terms of the other quantities. Rearranging the equation, we obtain:\n$$D_{\\infty} = D(L) + \\frac{k_B T \\xi}{6 \\pi \\eta L}$$\nThis completes the derivation.\n\nNext, we compute the numerical value of $D_{\\infty}$ using the provided parameters.\nThe parameters are:\n- $L = 3.000 \\times 10^{-9}\\,\\mathrm{m}$\n- $T = 298.0\\,\\mathrm{K}$\n- $\\eta = 8.90 \\times 10^{-4}\\,\\mathrm{Pa\\cdot s}$\n- $D(L) = 1.900 \\times 10^{-9}\\,\\mathrm{m^2/s}$\n- $k_B = 1.380649 \\times 10^{-23}\\,\\mathrm{J/K}$\n- $\\xi = 2.837297$\n\nFirst, we calculate the correction term, $\\Delta D = \\frac{k_B T \\xi}{6 \\pi \\eta L}$. All values are in SI units, so the result will be in $\\mathrm{m^2/s}$.\nThe numerator is $k_B T \\xi$:\n$$k_B T \\xi = (1.380649 \\times 10^{-23}\\,\\mathrm{J/K}) \\times (298.0\\,\\mathrm{K}) \\times (2.837297) \\approx 1.167345 \\times 10^{-20}\\,\\mathrm{J}$$\nThe denominator is $6 \\pi \\eta L$:\n$$6 \\pi \\eta L = 6\\pi \\times (8.90 \\times 10^{-4}\\,\\mathrm{Pa\\cdot s}) \\times (3.000 \\times 10^{-9}\\,\\mathrm{m}) \\approx 5.032814 \\times 10^{-11}\\,\\mathrm{Pa\\cdot s \\cdot m}$$\nThe correction term is:\n$$\\Delta D = \\frac{1.167345 \\times 10^{-20}\\,\\mathrm{J}}{5.032814 \\times 10^{-11}\\,\\mathrm{Pa\\cdot s \\cdot m}} \\approx 2.321437 \\times 10^{-10}\\,\\mathrm{m^2/s} = 0.2321437 \\times 10^{-9}\\,\\mathrm{m^2/s}$$\nNow, we add this to the measured diffusion coefficient $D(L)$:\n$$D_{\\infty} = D(L) + \\Delta D = (1.900 \\times 10^{-9}\\,\\mathrm{m^2/s}) + (0.2321437 \\times 10^{-9}\\,\\mathrm{m^2/s})$$\n$$D_{\\infty} \\approx 2.1321437 \\times 10^{-9}\\,\\mathrm{m^2/s}$$\nThe problem requests the answer rounded to four significant figures.\n$$D_{\\infty} \\approx 2.132 \\times 10^{-9}\\,\\mathrm{m^2/s}$$", "answer": "$$\\boxed{2.132 \\times 10^{-9}}$$", "id": "3423093"}, {"introduction": "The fluctuation-dissipation theorem teaches us that a system's response to external perturbations is encoded in its spontaneous equilibrium fluctuations. This exercise provides a hands-on verification of this principle by focusing on the speed of sound, $c_s$. You will connect the dynamic structure factor, $S(k, \\omega)$, which describes collective density fluctuations, to the thermodynamic equation of state by calculating $c_s$ through two independent routes [@problem_id:3423073], thereby bridging the gap between microscopic dynamics and macroscopic thermodynamics.", "problem": "You are given a synthetic representation of the dynamic structure factor $S(k,\\omega)$ of a simple fluid in the hydrodynamic regime, where $S(k,\\omega)$ exhibits a central Rayleigh peak at $\\omega=0$ and a Brillouin doublet centered at $\\omega=\\pm \\omega_B$. In the hydrodynamic description, the Brillouin peaks reflect propagating sound modes, and their positions provide an estimate of the adiabatic speed of sound $c_s$ via $\\omega_B \\approx c_s k$ when $k$ is sufficiently small. Your task is to write a complete program that, for each test case, (i) constructs $S(k,\\omega)$ on a discrete frequency grid, (ii) extracts the speed of sound $c_s$ from the Brillouin peaks, and (iii) computes $c_s$ independently from the equation of state using thermodynamic relations starting from first principles. Finally, compare the two speeds of sound and report the absolute difference as a float in the specified units.\n\nFundamental base for this problem:\n- Newtonian microscopic dynamics of a fluid leads, in the long-wavelength limit, to hydrodynamic modes. In particular, density fluctuations produce a dynamic structure factor $S(k,\\omega)$ with a central diffusive peak (entropy mode) and two propagating peaks (sound modes).\n- Thermodynamics of a simple compressible system implies that the adiabatic speed of sound satisfies $c_s^2=(\\partial P/\\partial \\rho)_S$, where $P$ is pressure, $\\rho$ is mass density, and the derivative is taken at constant entropy $S$.\n\nSynthetic dynamic structure factor model:\nFor each test case, you must construct $S(k,\\omega)$ as a sum of three Lorentzian components on a uniform frequency grid $\\omega\\in[-\\omega_{\\max},\\omega_{\\max}]$:\n$$\nS(k,\\omega)=A_R L(\\omega;0,\\Gamma_R)+A_B \\left[ L(\\omega;\\omega_B,\\Gamma_B)+L(\\omega;-\\omega_B,\\Gamma_B)\\right],\n$$\nwith the Lorentzian defined by\n$$\nL(\\omega;\\omega_0,\\Gamma)=\\frac{1}{\\pi}\\frac{\\Gamma}{(\\omega-\\omega_0)^2+\\Gamma^2}.\n$$\nHere, $A_R$, $A_B$, $\\Gamma_R$, and $\\Gamma_B$ are given nonnegative parameters. The Brillouin frequency is $\\omega_B=c_s k$, where $c_s$ is to be computed from the equation of state for the given test case. All quantities in this problem are specified and must be handled in reduced units where $k_B=1$, mass $m$ is in the given reduced units, and time and length are consistent with these. Report all speeds in these reduced units.\n\nExtraction of $c_s$ from $S(k,\\omega)$:\n- On the constructed grid, detect the positive-frequency Brillouin peak by locating the most prominent local maximum of $S(k,\\omega)$ for $\\omega>0$ after excluding the central region $|\\omega|<\\omega_{\\mathrm{ex}}$, where $\\omega_{\\mathrm{ex}}=3\\max(\\Gamma_R,\\Gamma_B)$.\n- Use a simple and robust technique to refine the peak location (such as quadratic interpolation using the peak and its immediate neighbors) to estimate $\\omega_B$ to sub-grid precision.\n- Compute the sound speed from the spectral data as $c_s^{\\mathrm{spec}}=\\omega_B/k$.\n\nComputation of $c_s$ from the equation of state:\n- For each test case, an equation of state $P(\\rho,T)$ is provided together with the temperature $T$, mass density $\\rho$, and the ratio of specific heats $\\gamma=c_P/c_V$. Starting from the thermodynamic identity $c_s^2=(\\partial P/\\partial \\rho)_S$, derive an expression that can be evaluated from the provided quantities and the equation of state, without assuming any target formula. Use only standard thermodynamic definitions and identities connecting isothermal and adiabatic response functions and the ratio $\\gamma$.\n- Evaluate $c_s^{\\mathrm{eos}}$ from your derived expression using the given parameters of the equation of state.\n\nReturn value for each test case:\n- Compute the absolute difference $\\Delta c_s=|c_s^{\\mathrm{spec}}-c_s^{\\mathrm{eos}}|$.\n- Express $\\Delta c_s$ in the reduced speed units and round to six decimal places.\n\nFrequency grid construction:\n- For each test case, use the provided $\\omega_{\\max}$ and the number of grid points $N_\\omega$ to create a uniform grid containing $N_\\omega$ points spanning $[-\\omega_{\\max},\\omega_{\\max}]$.\n\nAngle units:\n- All frequencies $\\omega$ are in radians per unit time, and wave numbers $k$ are in inverse length. Therefore, speeds are in length per unit time in the reduced units specified.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[x1,x2,x3,x4]\"), where each $x_i$ is the rounded float $\\Delta c_s$ for test case $i$.\n\nTest suite:\nUse the following four scientifically consistent test cases. For each, construct $S(k,\\omega)$ with the given parameters, extract $c_s^{\\mathrm{spec}}$, compute $c_s^{\\mathrm{eos}}$ from the equation of state, and report $\\Delta c_s$ as instructed.\n\nCase 1 (ideal gas, monatomic-like):\n- Wave number: $k=0.5$.\n- Temperature: $T=1.2$.\n- Mass: $m=1.0$.\n- Specific heat ratio: $\\gamma=5/3$.\n- Equation of state: ideal gas $P(\\rho,T)=\\rho T/m$.\n- Density: $\\rho$ is not needed for the ideal-gas derivative in this case.\n- Spectral parameters: $A_R=0.3$, $A_B=0.35$, $\\Gamma_R=0.10$, $\\Gamma_B=0.05$.\n- Frequency grid: $\\omega_{\\max}=3.0$, $N_\\omega=8193$.\n\nCase 2 (ideal gas, higher temperature):\n- Wave number: $k=0.8$.\n- Temperature: $T=2.0$.\n- Mass: $m=1.0$.\n- Specific heat ratio: $\\gamma=5/3$.\n- Equation of state: ideal gas $P(\\rho,T)=\\rho T/m$.\n- Density: $\\rho$ is not needed for the ideal-gas derivative in this case.\n- Spectral parameters: $A_R=0.4$, $A_B=0.30$, $\\Gamma_R=0.12$, $\\Gamma_B=0.06$.\n- Frequency grid: $\\omega_{\\max}=5.0$, $N_\\omega=8193$.\n\nCase 3 (van der Waals fluid, moderate compressibility):\n- Wave number: $k=0.6$.\n- Temperature: $T=1.5$.\n- Mass: $m=1.0$.\n- Specific heat ratio: $\\gamma=1.25$.\n- Equation of state: van der Waals $P(\\rho,T)=\\dfrac{\\rho T}{m-b\\rho}-a\\rho^2$.\n- Parameters: $a=0.5$, $b=0.3$, $\\rho=0.5$.\n- Spectral parameters: $A_R=0.35$, $A_B=0.33$, $\\Gamma_R=0.08$, $\\Gamma_B=0.04$.\n- Frequency grid: $\\omega_{\\max}=3.0$, $N_\\omega=8193$.\n\nCase 4 (van der Waals fluid, near-soft mode at small $k$):\n- Wave number: $k=0.2$.\n- Temperature: $T=1.0$.\n- Mass: $m=1.0$.\n- Specific heat ratio: $\\gamma=1.1$.\n- Equation of state: van der Waals $P(\\rho,T)=\\dfrac{\\rho T}{m-b\\rho}-a\\rho^2$.\n- Parameters: $a=0.9$, $b=0.4$, $\\rho=0.7$.\n- Spectral parameters: $A_R=0.50$, $A_B=0.25$, $\\Gamma_R=0.03$, $\\Gamma_B=0.02$.\n- Frequency grid: $\\omega_{\\max}=1.5$, $N_\\omega=8193$.\n\nImportant notes:\n- For each case, construct $S(k,\\omega)$ using $\\omega_B=c_s k$, where $c_s$ must be computed from the equation of state as described.\n- Ensure that the peak-finding procedure excludes the central region $|\\omega|<\\omega_{\\mathrm{ex}}$ with $\\omega_{\\mathrm{ex}}=3\\max(\\Gamma_R,\\Gamma_B)$ to avoid the Rayleigh peak.\n- Your program must output a single line: a bracketed list of four floats, each rounded to six decimal places, corresponding to the four cases, in order.", "solution": "The problem statement has been analyzed and is determined to be **valid**. It is scientifically sound, well-posed, and self-contained. The problem is grounded in fundamental principles of statistical mechanics and thermodynamics, specifically the connection between microscopic fluctuations, represented by the dynamic structure factor $S(k,\\omega)$, and macroscopic thermodynamic properties, such as the speed of sound $c_s$. The task involves a standard, albeit non-trivial, combination of theoretical derivation and numerical data analysis. All required parameters are provided, and the constraints are consistent and physically plausible within the specified system of reduced units. The procedure of constructing a spectrum with a known theoretical value and then numerically extracting that value is a standard method for verifying the accuracy of a numerical algorithm, which is a meaningful exercise in computational physics.\n\nThe solution proceeds in four stages: (i) deriving an analytical expression for the adiabatic speed of sound, $c_s^{\\mathrm{eos}}$, from the provided equations of state; (ii) constructing the synthetic dynamic structure factor $S(k,\\omega)$ using $c_s^{\\mathrm{eos}}$; (iii) numerically extracting the spectral speed of sound, $c_s^{\\mathrm{spec}}$, from the constructed $S(k,\\omega)$; and (iv) computing the absolute difference $\\Delta c_s = |c_s^{\\mathrm{spec}} - c_s^{\\mathrm{eos}}|$.\n\n**1. Derivation of the Speed of Sound from the Equation of State ($c_s^{\\mathrm{eos}}$)**\n\nThe adiabatic speed of sound, $c_s$, is defined by the thermodynamic relation:\n$$\nc_s^2 = \\left( \\frac{\\partial P}{\\partial \\rho} \\right)_S\n$$\nwhere $P$ is the pressure, $\\rho$ is the mass density, and the derivative is taken at constant entropy $S$. This derivative is not convenient to calculate directly from an equation of state of the form $P(\\rho, T)$. We can relate it to more accessible quantities using standard thermodynamic identities. The ratio of the adiabatic compressibility, $K_S$, to the isothermal compressibility, $K_T$, is equal to the ratio of specific heats, $\\gamma = c_P/c_V$:\n$$\n\\frac{K_S}{K_T} = \\frac{1}{\\gamma}\n$$\nThe speed of sound is related to the adiabatic compressibility by $c_s^2 = 1/(\\rho K_S)$. The isothermal compressibility is defined as $K_T = -\\frac{1}{V}(\\frac{\\partial V}{\\partial P})_T$. Using the relation $V=M/\\rho$ for a constant mass $M$, we find $dV = -M/\\rho^2 d\\rho$, which gives $K_T = \\frac{1}{\\rho}(\\frac{\\partial \\rho}{\\partial P})_T$. Combining these relations yields:\n$$\nc_s^2 = \\frac{1}{\\rho K_S} = \\frac{\\gamma}{\\rho K_T} = \\frac{\\gamma}{\\rho \\left( \\frac{1}{\\rho} \\left( \\frac{\\partial \\rho}{\\partial P} \\right)_T \\right)} = \\gamma \\left( \\frac{\\partial P}{\\partial \\rho} \\right)_T\n$$\nThis final expression, $c_s^2 = \\gamma (\\partial P/\\partial \\rho)_T$, allows for the calculation of the speed of sound using the given equation of state $P(\\rho, T)$ and the specific heat ratio $\\gamma$.\n\n**a. Ideal Gas Law:**\nFor the ideal gas, the equation of state is $P(\\rho, T) = \\rho T / m$, with Boltzmann's constant $k_B=1$. The required partial derivative is:\n$$\n\\left( \\frac{\\partial P}{\\partial \\rho} \\right)_T = \\frac{T}{m}\n$$\nTherefore, the speed of sound squared is $c_s^2 = \\gamma T / m$, and the speed of sound is:\n$$\nc_s^{\\mathrm{eos}} = \\sqrt{\\frac{\\gamma T}{m}}\n$$\n\n**b. Van der Waals Equation of State:**\nFor the van der Waals fluid, the equation of state is given as $P(\\rho, T) = \\frac{\\rho T}{m - b\\rho} - a\\rho^2$. The partial derivative with respect to density at constant temperature is:\n$$\n\\left( \\frac{\\partial P}{\\partial \\rho} \\right)_T = T \\frac{\\partial}{\\partial \\rho} \\left( \\frac{\\rho}{m - b\\rho} \\right) - \\frac{\\partial}{\\partial \\rho} (a\\rho^2) = T \\left( \\frac{(m-b\\rho)(1) - \\rho(-b)}{(m-b\\rho)^2} \\right) - 2a\\rho = \\frac{mT}{(m-b\\rho)^2} - 2a\\rho\n$$\nThe speed of sound is then given by:\n$$\nc_s^{\\mathrm{eos}} = \\sqrt{\\gamma \\left( \\frac{mT}{(m-b\\rho)^2} - 2a\\rho \\right)}\n$$\n\n**2. Construction of the Dynamic Structure Factor $S(k,\\omega)$**\n\nFor each test case, the dynamic structure factor $S(k,\\omega)$ is synthesized as a sum of three Lorentzian functions on a discrete frequency grid. The grid consists of $N_\\omega$ points uniformly distributed over the interval $[-\\omega_{\\max}, \\omega_{\\max}]$. The general form of $S(k,\\omega)$ is:\n$$\nS(k,\\omega) = A_R L(\\omega; 0, \\Gamma_R) + A_B \\left[ L(\\omega; \\omega_B, \\Gamma_B) + L(\\omega; -\\omega_B, \\Gamma_B) \\right]\n$$\nwhere the Lorentzian function $L$ is defined as:\n$$\nL(\\omega; \\omega_0, \\Gamma) = \\frac{1}{\\pi} \\frac{\\Gamma}{(\\omega - \\omega_0)^2 + \\Gamma^2}\n$$\nThe parameters $A_R$, $A_B$, $\\Gamma_R$, and $\\Gamma_B$ are provided for each case. The central Rayleigh peak is centered at $\\omega=0$, and the two Brillouin peaks are at $\\omega = \\pm \\omega_B$. A crucial step is that the Brillouin peak frequency, $\\omega_B$, used to construct the spectrum is determined by the theoretically derived speed of sound, $c_s^{\\mathrm{eos}}$, and the given wave number $k$:\n$$\n\\omega_B = c_s^{\\mathrm{eos}} k\n$$\n\n**3. Extraction of the Speed of Sound from the Spectrum ($c_s^{\\mathrm{spec}}$)**\n\nAfter constructing the numerical spectrum $S(k,\\omega)$, the speed of sound is extracted from it by locating the Brillouin peak.\nFirst, to avoid mistaking the central Rayleigh peak for a Brillouin peak, the search is restricted to frequencies $\\omega > \\omega_{\\mathrm{ex}}$, where $\\omega_{\\mathrm{ex}} = 3\\max(\\Gamma_R, \\Gamma_B)$.\nWithin this search region, the algorithm identifies the grid point corresponding to the maximum value of $S(k,\\omega)$. Let this grid point have frequency $\\omega_i$ and value $S_i$.\n\nTo achieve sub-grid precision, quadratic interpolation is used. A parabola is fitted to the three points $( \\omega_{i-1}, S_{i-1} )$, $( \\omega_i, S_i )$, and $( \\omega_{i+1}, S_{i+1} )$, where $\\omega_{i\\pm 1} = \\omega_i \\pm \\Delta\\omega$ and $\\Delta\\omega$ is the frequency grid spacing. The frequency corresponding to the vertex of this parabola provides a refined estimate of the peak position, $\\omega_B^{\\mathrm{spec}}$:\n$$\n\\omega_B^{\\mathrm{spec}} = \\omega_i + \\frac{S_{i-1} - S_{i+1}}{2(S_{i-1} - 2S_i + S_{i+1})} \\Delta\\omega\n$$\nThis formula gives the interpolated position of the maximum. Finally, the spectrally-derived speed of sound is calculated as:\n$$\nc_s^{\\mathrm{spec}} = \\frac{\\omega_B^{\\mathrm{spec}}}{k}\n$$\n\n**4. Final Calculation and Comparison**\n\nThe objective is to compare the speed of sound calculated from the equation of state, $c_s^{\\mathrm{eos}}$, with the one extracted numerically from the spectrum, $c_s^{\\mathrm{spec}}$. The absolute difference is computed for each test case:\n$$\n\\Delta c_s = |c_s^{\\mathrm{spec}} - c_s^{\\mathrm{eos}}|\n$$\nThis value effectively measures the numerical error introduced by the grid discretization and the quadratic interpolation approximation of the Lorentzian peak shape. The final result for each case is this difference, rounded to six decimal places.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem for all test cases, calculating the difference between\n    the speed of sound derived from thermodynamics and from a synthetic spectrum.\n    \"\"\"\n\n    test_cases = [\n        # Case 1 (ideal gas, monatomic-like)\n        {\n            \"k\": 0.5, \"T\": 1.2, \"m\": 1.0, \"gamma\": 5/3, \"rho\": None,\n            \"eos\": \"ideal\", \"eos_params\": {},\n            \"spec_params\": {\"A_R\": 0.3, \"A_B\": 0.35, \"Gamma_R\": 0.10, \"Gamma_B\": 0.05},\n            \"grid_params\": {\"w_max\": 3.0, \"N_w\": 8193}\n        },\n        # Case 2 (ideal gas, higher temperature)\n        {\n            \"k\": 0.8, \"T\": 2.0, \"m\": 1.0, \"gamma\": 5/3, \"rho\": None,\n            \"eos\": \"ideal\", \"eos_params\": {},\n            \"spec_params\": {\"A_R\": 0.4, \"A_B\": 0.30, \"Gamma_R\": 0.12, \"Gamma_B\": 0.06},\n            \"grid_params\": {\"w_max\": 5.0, \"N_w\": 8193}\n        },\n        # Case 3 (van der Waals fluid, moderate compressibility)\n        {\n            \"k\": 0.6, \"T\": 1.5, \"m\": 1.0, \"gamma\": 1.25, \"rho\": 0.5,\n            \"eos\": \"vdw\", \"eos_params\": {\"a\": 0.5, \"b\": 0.3},\n            \"spec_params\": {\"A_R\": 0.35, \"A_B\": 0.33, \"Gamma_R\": 0.08, \"Gamma_B\": 0.04},\n            \"grid_params\": {\"w_max\": 3.0, \"N_w\": 8193}\n        },\n        # Case 4 (van der Waals fluid, near-soft mode at small k)\n        {\n            \"k\": 0.2, \"T\": 1.0, \"m\": 1.0, \"gamma\": 1.1, \"rho\": 0.7,\n            \"eos\": \"vdw\", \"eos_params\": {\"a\": 0.9, \"b\": 0.4},\n            \"spec_params\": {\"A_R\": 0.50, \"A_B\": 0.25, \"Gamma_R\": 0.03, \"Gamma_B\": 0.02},\n            \"grid_params\": {\"w_max\": 1.5, \"N_w\": 8193}\n        }\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        # Step 1: Compute speed of sound from equation of state (c_s_eos)\n        if case[\"eos\"] == \"ideal\":\n            cs_eos_sq = case[\"gamma\"] * case[\"T\"] / case[\"m\"]\n        elif case[\"eos\"] == \"vdw\":\n            m, T, rho = case[\"m\"], case[\"T\"], case[\"rho\"]\n            a = case[\"eos_params\"][\"a\"]\n            b = case[\"eos_params\"][\"b\"]\n            dP_drho_T = (m * T) / (m - b * rho)**2 - 2 * a * rho\n            cs_eos_sq = case[\"gamma\"] * dP_drho_T\n        \n        c_s_eos = np.sqrt(cs_eos_sq)\n\n        # Step 2: Construct the dynamic structure factor S(k, omega)\n        k = case[\"k\"]\n        w_b = c_s_eos * k\n        \n        w_max = case[\"grid_params\"][\"w_max\"]\n        N_w = case[\"grid_params\"][\"N_w\"]\n        omega_grid = np.linspace(-w_max, w_max, N_w)\n        \n        A_R = case[\"spec_params\"][\"A_R\"]\n        A_B = case[\"spec_params\"][\"A_B\"]\n        Gamma_R = case[\"spec_params\"][\"Gamma_R\"]\n        Gamma_B = case[\"spec_params\"][\"Gamma_B\"]\n\n        def lorentzian(w, w0, gamma):\n            return (1/np.pi) * gamma / ((w - w0)**2 + gamma**2)\n\n        S_k_omega = (A_R * lorentzian(omega_grid, 0, Gamma_R) +\n                     A_B * (lorentzian(omega_grid, w_b, Gamma_B) +\n                            lorentzian(omega_grid, -w_b, Gamma_B)))\n        \n        # Step 3: Extract speed of sound from the spectrum (c_s_spec)\n        w_ex = 3 * max(Gamma_R, Gamma_B)\n        \n        # Define search region for positive frequency peak\n        search_start_idx = np.searchsorted(omega_grid, w_ex, side='right')\n        \n        # Find the index of the maximum S(k,w) in the search region\n        peak_idx_relative = np.argmax(S_k_omega[search_start_idx:])\n        peak_idx = search_start_idx + peak_idx_relative\n\n        # Perform quadratic interpolation to refine peak position\n        # Ensure we are not at the boundaries of the array\n        if 1 = peak_idx  len(omega_grid) - 1:\n            y_m1 = S_k_omega[peak_idx - 1]\n            y_0 = S_k_omega[peak_idx]\n            y_p1 = S_k_omega[peak_idx + 1]\n            \n            # The denominator can be zero if the peak is perfectly flat, though unlikely.\n            # Add a small epsilon to avoid division by zero in pathological cases.\n            denominator = (y_m1 - 2*y_0 + y_p1)\n            if abs(denominator)  1e-15:\n                p = 0.0\n            else:\n                p = 0.5 * (y_m1 - y_p1) / denominator\n            \n            dw = omega_grid[1] - omega_grid[0]\n            w_b_spec = omega_grid[peak_idx] + p * dw\n        else: # Fallback if peak is at the edge (should not happen with this setup)\n            w_b_spec = omega_grid[peak_idx]\n\n        c_s_spec = w_b_spec / k\n\n        # Step 4: Compute the absolute difference and append to results\n        delta_cs = abs(c_s_spec - c_s_eos)\n        results.append(round(delta_cs, 6))\n\n    print(f\"[{','.join(f'{r:.6f}' for r in results)}]\")\n\nsolve()\n```", "id": "3423073"}]}