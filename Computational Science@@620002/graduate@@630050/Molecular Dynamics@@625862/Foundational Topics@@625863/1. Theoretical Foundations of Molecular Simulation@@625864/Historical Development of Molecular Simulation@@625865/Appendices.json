{"hands_on_practices": [{"introduction": "The single greatest challenge in early molecular dynamics was the computational cost of calculating forces, which scaled with the square of the number of particles, $O(N^2)$. This \"N-squared problem\" severely limited simulations to a few hundred particles. This practice invites you to recreate the pivotal algorithmic breakthrough—the use of neighbor lists—that reduced the complexity to $O(N)$ and enabled the large-scale simulations common today. By modeling the costs of both the naive and neighbor-list methods, you will determine the crossover point where the more sophisticated algorithm becomes superior, gaining a tangible sense of this historic leap in computational efficiency [@problem_id:3416011].", "problem": "Consider a system of $N$ identical particles of mass $m$ in a cubic box of side $L$ with number density $\\rho = N/L^3$. Particles interact via a short-ranged pair potential truncated at a cutoff distance $r_c$, and forces are computed under periodic boundary conditions. Historically, two major algorithmic strategies have been used for neighbor identification in molecular dynamics: (i) direct all-pairs evaluation, and (ii) neighbor lists (Verlet lists) accelerated by linked-cell lists. Your task is to derive, implement, and compare idealized operation-count cost models for these strategies and to quantify when the asymptotically linear strategy overtakes the quadratic one, as a function of system size $N$, skin distance $r_s$, and physical parameters that affect the neighbor list rebuild cadence.\n\nFundamental and well-tested bases:\n- Newton’s second law, $m\\,d^2 \\mathbf{r}/dt^2 = \\mathbf{F}$, governs particle motion and motivates time discretization using a time step $dt$.\n- The Maxwell–Boltzmann equilibrium speed distribution at temperature $T$ implies a root-mean-square speed $v_{\\mathrm{rms}} = \\sqrt{3 k_B T / m}$, where $k_B$ is the Boltzmann constant, and $m$ is the particle mass.\n- The average number of neighbors within distance $r_c$ in a uniform fluid is $z \\approx \\frac{4\\pi}{3} r_c^3 \\rho$, assuming a pair correlation function near unity in the cutoff shell.\n\nAssumptions and definitions for the cost model:\n- The direct all-pairs strategy computes pairwise separations and checks against $r_c$, incurring an operation cost $c_{\\mathrm{check}}$ per pair separation and cutoff check. If a pair is within $r_c$, the force is computed with cost $c_{\\mathrm{force}}$ per neighbor pair. The per-step operation count is modeled as\n$$\nC_{\\mathrm{naive}}(N) = \\frac{c_{\\mathrm{check}}}{2} N(N-1) + c_{\\mathrm{force}}\\, z\\, N \\approx \\frac{c_{\\mathrm{check}}}{2} N^2 + c_{\\mathrm{force}}\\, z\\, N.\n$$\n- The Verlet neighbor list strategy uses a linked-cell list to rebuild the neighbor list containing pairs within $r_c + r_s$. List rebuilds occur when the maximum particle displacement since the last rebuild exceeds $r_s/2$, to guarantee that no new neighbors within $r_c$ are missed. The cost to rebuild is modeled as linear in $N$, $c_{\\mathrm{build}} N$, capturing linked-cell binning and list construction with a constant average per-particle overhead. Per-step force computation over the current neighbor list has the same $c_{\\mathrm{force}}$ per neighbor pair cost. Thus, the per-step operation count is\n$$\nC_{\\mathrm{verlet}}(N) = c_{\\mathrm{force}}\\, z\\, N + \\frac{c_{\\mathrm{build}}\\, N}{k(N)},\n$$\nwhere $k(N)$ is the number of steps between rebuilds.\n- To estimate $k(N)$ from first principles, approximate the expected maximum speed using extreme-value theory for Gaussian-like components: $v_{\\max}(N) \\approx v_{\\mathrm{rms}} \\sqrt{2 \\ln N}$. Over $k$ time steps, the maximum displacement is $k\\, v_{\\max}(N)\\, dt$. Rebuild when $k\\, v_{\\max}(N)\\, dt \\ge r_s/2$, so we approximate the rebuild interval\n$$\nk(N) \\approx \\max\\left(1, \\frac{r_s}{2 v_{\\max}(N) dt}\\right) = \\max\\left(1, \\frac{r_s}{2 v_{\\mathrm{rms}} \\sqrt{2 \\ln N}\\, dt}\\right).\n$$\n- Comparing $C_{\\mathrm{naive}}(N)$ to $C_{\\mathrm{verlet}}(N)$ shows that the neighbor-force costs $c_{\\mathrm{force}} z N$ cancel in the inequality $C_{\\mathrm{naive}}(N) \\le C_{\\mathrm{verlet}}(N)$, leaving the crossover primarily determined by wasted far-pair checks versus amortized rebuilds:\n$$\n\\frac{c_{\\mathrm{check}}}{2} N^2 \\le \\frac{c_{\\mathrm{build}}\\, N}{k(N)}.\n$$\n\nYour tasks:\n1. Derive from the above bases an explicit algorithm to compute the minimal integer $N$ for which $C_{\\mathrm{naive}}(N) \\le C_{\\mathrm{verlet}}(N)$ holds, for given parameters $(c_{\\mathrm{check}}, c_{\\mathrm{force}}, c_{\\mathrm{build}}, r_s, r_c, \\rho, T, m, dt)$. You must treat both regimes $k(N)=1$ and $k(N)1$ rigorously and return the smallest integer $N \\ge 2$ satisfying the inequality.\n2. Implement a complete, runnable program that, for each test case below, computes this minimal $N$.\n3. Although your implementation does not need to simulate trajectories, you must base $k(N)$ on the physical estimate above and ensure consistent units. Use $k_B = 1.380649 \\times 10^{-23}~\\mathrm{J/K}$, convert $m$ from atomic mass units to kilograms using $1~\\mathrm{amu} = 1.66053906660 \\times 10^{-27}~\\mathrm{kg}$, and express speeds in $\\mathrm{nm/ps}$ by converting $1~\\mathrm{m/s} = 10^{-3}~\\mathrm{nm/ps}$. Distances $r_c$ and $r_s$ must be in $\\mathrm{nm}$, $dt$ in $\\mathrm{ps}$, and temperature $T$ in $\\mathrm{K}$. The outputs are dimensionless integers.\n4. The final output must be a single line with the results for all test cases as a comma-separated list enclosed in square brackets.\n\nTest suite:\nProvide results for the following eight parameter sets (intended to reflect historically plausible relative costs and to test both the $k(N)=1$ and $k(N)1$ regimes, as well as sensitivity to $r_s$):\n\n- Case 1 (1970s CPU): $(c_{\\mathrm{check}}=70,\\ c_{\\mathrm{force}}=60,\\ c_{\\mathrm{build}}=15000,\\ r_s=0.2\\ \\mathrm{nm},\\ r_c=0.85\\ \\mathrm{nm},\\ \\rho=0.8\\ \\mathrm{nm}^{-3},\\ T=120\\ \\mathrm{K},\\ m=39.948\\ \\mathrm{amu},\\ dt=0.002\\ \\mathrm{ps})$.\n- Case 2 (1980s vector): $(c_{\\mathrm{check}}=60,\\ c_{\\mathrm{force}}=60,\\ c_{\\mathrm{build}}=12000,\\ r_s=0.2\\ \\mathrm{nm},\\ r_c=0.85\\ \\mathrm{nm},\\ \\rho=0.8\\ \\mathrm{nm}^{-3},\\ T=120\\ \\mathrm{K},\\ m=39.948\\ \\mathrm{amu},\\ dt=0.002\\ \\mathrm{ps})$.\n- Case 3 (1990s workstation): $(c_{\\mathrm{check}}=50,\\ c_{\\mathrm{force}}=60,\\ c_{\\mathrm{build}}=9000,\\ r_s=0.3\\ \\mathrm{nm},\\ r_c=0.85\\ \\mathrm{nm},\\ \\rho=0.8\\ \\mathrm{nm}^{-3},\\ T=120\\ \\mathrm{K},\\ m=39.948\\ \\mathrm{amu},\\ dt=0.002\\ \\mathrm{ps})$.\n- Case 4 (2000s Central Processing Unit (CPU) with Single Instruction, Multiple Data (SIMD)): $(c_{\\mathrm{check}}=40,\\ c_{\\mathrm{force}}=60,\\ c_{\\mathrm{build}}=7000,\\ r_s=0.3\\ \\mathrm{nm},\\ r_c=0.85\\ \\mathrm{nm},\\ \\rho=0.8\\ \\mathrm{nm}^{-3},\\ T=120\\ \\mathrm{K},\\ m=39.948\\ \\mathrm{amu},\\ dt=0.002\\ \\mathrm{ps})$.\n- Case 5 (2010s Graphics Processing Unit (GPU)): $(c_{\\mathrm{check}}=100,\\ c_{\\mathrm{force}}=60,\\ c_{\\mathrm{build}}=5000,\\ r_s=0.3\\ \\mathrm{nm},\\ r_c=0.85\\ \\mathrm{nm},\\ \\rho=0.8\\ \\mathrm{nm}^{-3},\\ T=120\\ \\mathrm{K},\\ m=39.948\\ \\mathrm{amu},\\ dt=0.002\\ \\mathrm{ps})$.\n- Case 6 (2020s GPU): $(c_{\\mathrm{check}}=90,\\ c_{\\mathrm{force}}=60,\\ c_{\\mathrm{build}}=4000,\\ r_s=0.4\\ \\mathrm{nm},\\ r_c=0.85\\ \\mathrm{nm},\\ \\rho=0.8\\ \\mathrm{nm}^{-3},\\ T=120\\ \\mathrm{K},\\ m=39.948\\ \\mathrm{amu},\\ dt=0.002\\ \\mathrm{ps})$.\n- Case 7 (edge: small skin, hot fluid): $(c_{\\mathrm{check}}=50,\\ c_{\\mathrm{force}}=60,\\ c_{\\mathrm{build}}=5000,\\ r_s=0.01\\ \\mathrm{nm},\\ r_c=0.85\\ \\mathrm{nm},\\ \\rho=0.8\\ \\mathrm{nm}^{-3},\\ T=600\\ \\mathrm{K},\\ m=39.948\\ \\mathrm{amu},\\ dt=0.002\\ \\mathrm{ps})$.\n- Case 8 (edge: large skin, cold fluid with expensive rebuild): $(c_{\\mathrm{check}}=50,\\ c_{\\mathrm{force}}=60,\\ c_{\\mathrm{build}}=20000,\\ r_s=1.0\\ \\mathrm{nm},\\ r_c=0.85\\ \\mathrm{nm},\\ \\rho=0.8\\ \\mathrm{nm}^{-3},\\ T=120\\ \\mathrm{K},\\ m=39.948\\ \\mathrm{amu},\\ dt=0.002\\ \\mathrm{ps})$.\n\nFinal output format:\nYour program should produce a single line of output containing the eight minimal integers $N$ for the cases above as a comma-separated list enclosed in square brackets, for example, $[n_1,n_2,n_3,n_4,n_5,n_6,n_7,n_8]$. No other output is permitted.", "solution": "The problem requires the derivation and implementation of an algorithm to find the crossover point in computational cost between two molecular dynamics neighbor-finding strategies: direct all-pairs evaluation and Verlet lists.\n\n### Problem Validation\n\nFirst, I shall validate the problem statement. The givens are:\n- Cost of naive all-pairs strategy: $C_{\\mathrm{naive}}(N) = \\frac{c_{\\mathrm{check}}}{2} N(N-1) + c_{\\mathrm{force}}\\, z\\, N \\approx \\frac{c_{\\mathrm{check}}}{2} N^2 + c_{\\mathrm{force}}\\, z\\, N$.\n- Cost of Verlet list strategy: $C_{\\mathrm{verlet}}(N) = c_{\\mathrm{force}}\\, z\\, N + \\frac{c_{\\mathrm{build}}\\, N}{k(N)}$.\n- Rebuild interval: $k(N) = \\max\\left(1, \\frac{r_s}{2 v_{\\max}(N) dt}\\right)$.\n- Maximum speed approximation: $v_{\\max}(N) \\approx v_{\\mathrm{rms}} \\sqrt{2 \\ln N}$.\n- Root-mean-square speed: $v_{\\mathrm{rms}} = \\sqrt{3 k_B T / m}$.\n- The inequality to analyze is given as $C_{\\mathrm{naive}}(N) \\le C_{\\mathrm{verlet}}(N)$.\n- The task is to \"compute the minimal integer $N$ for which $C_{\\mathrm{naive}}(N) \\le C_{\\mathrm{verlet}}(N)$ holds\".\n- Physical constants and conversions are specified.\n\nThe problem, as stated, contains a significant logical inconsistency between its conceptual goal and its explicit mathematical instruction. This constitutes a flaw of type 5 (Ill-Posed or Poorly Structured) and 6 (Pseudo-Profound, Trivial, or Tautological).\n\n1.  **Conceptual Goal**: The problem asks to \"quantify when the asymptotically linear strategy overtakes the quadratic one\". \"Overtakes\" implies becoming more efficient, i.e., having a lower cost. This corresponds to the inequality $C_{\\mathrm{verlet}}(N)  C_{\\mathrm{naive}}(N)$.\n2.  **Explicit Instruction**: The problem explicitly directs the user to solve for the minimal integer $N \\ge 2$ satisfying $C_{\\mathrm{naive}}(N) \\le C_{\\mathrm{verlet}}(N)$.\n\nLet's analyze the explicitly stated inequality:\n$$\n\\frac{c_{\\mathrm{check}}}{2} N^2 \\le \\frac{c_{\\mathrm{build}}\\, N}{k(N)}\n$$\nFor $N \\ge 2$, we can divide by $N$:\n$$\n\\frac{c_{\\mathrm{check}}}{2} N \\le \\frac{c_{\\mathrm{build}}}{k(N)} \\implies N k(N) \\le \\frac{2 c_{\\mathrm{build}}}{c_{\\mathrm{check}}}\n$$\nLet's define the function $g(N) = N k(N)$ and the constant $B = \\frac{2 c_{\\mathrm{build}}}{c_{\\mathrm{check}}}$. The inequality is $g(N) \\le B$. The function $g(N)$ can be shown to be monotonically increasing for $N \\ge 2$. Consequently, the set of integer solutions for $N \\ge 2$ is of the form $\\{2, 3, \\dots, N_{\\max}\\}$. The minimal integer $N$ in this set is $2$, provided that $g(2) \\le B$. For all given test cases, this condition holds, making the answer trivially $2$ for many of them. This contradicts the spirit of finding a meaningful, non-trivial crossover point that depends on the parameters.\n\nTo resolve this inconsistency and address the core scientific question of the crossover point, I will proceed by solving the problem implied by the conceptual goal, which is finding the minimal integer $N$ for which the Verlet list method becomes at least as efficient as the naive method. This corresponds to the corrected inequality:\n$$\nC_{\\mathrm{verlet}}(N) \\le C_{\\mathrm{naive}}(N)\n$$\n\n### Mathematical Formulation and Algorithmic Derivation\n\nBased on the corrected premise, the inequality to solve is:\n$$\nc_{\\mathrm{force}}\\, z\\, N + \\frac{c_{\\mathrm{build}}\\, N}{k(N)} \\le \\frac{c_{\\mathrm{check}}}{2} N^2 + c_{\\mathrm{force}}\\, z\\, N\n$$\nThe term $c_{\\mathrm{force}}\\, z\\, N$, representing the cost of force calculations on actual neighbors, cancels out. This is appropriate, as the comparison focuses on the overhead of finding those neighbors. Note that the parameters $z$, $\\rho$, and $r_c$ are not required for the final calculation. Dividing by $N$ (since $N\\ge2$) yields:\n$$\n\\frac{c_{\\mathrm{build}}}{k(N)} \\le \\frac{c_{\\mathrm{check}}}{2} N \\implies \\frac{2 c_{\\mathrm{build}}}{c_{\\mathrm{check}}} \\le N k(N)\n$$\nWe define a dimensionless constant $B = \\frac{2 c_{\\mathrm{build}}}{c_{\\mathrm{check}}}$ and a function $g(N) = N k(N)$. The task is to find the minimum integer $N \\ge 2$ such that $g(N) \\ge B$.\n\nThe function $k(N)$ is given by:\n$$\nk(N) = \\max\\left(1, \\frac{r_s}{2 v_{\\mathrm{rms}} \\sqrt{2 \\ln N}\\, dt}\\right) = \\max\\left(1, \\frac{A}{\\sqrt{\\ln N}}\\right)\n$$\nwhere $A$ is a dimensionless constant incorporating all physical parameters:\n$$\nA = \\frac{r_s}{2 \\sqrt{2} \\, v_{\\mathrm{rms}} \\, dt}\n$$\nTo compute $A$, we first calculate $v_{\\mathrm{rms}}$ ensuring consistent units. The given parameters are in SI-standard derived units (K, amu) or common MD units (nm, ps).\n1.  Mass $m$: Convert from atomic mass units (amu) to kilograms (kg).\n    $m [\\mathrm{kg}] = m [\\mathrm{amu}] \\times (1.66053906660 \\times 10^{-27}\\ \\mathrm{kg/amu})$.\n2.  RMS speed $v_{\\mathrm{rms}}$: Using $k_B = 1.380649 \\times 10^{-23}\\ \\mathrm{J/K}$, calculate $v_{\\mathrm{rms}} = \\sqrt{3 k_B T / m}$. The result is in m/s.\n3.  Unit Conversion: Convert $v_{\\mathrm{rms}}$ to nm/ps using the conversion factor $1\\ \\mathrm{m/s} = 10^{-3}\\ \\mathrm{nm/ps}$.\n4.  Calculate $A$ using $r_s$ in nm and $dt$ in ps. The result for $A$ is dimensionless.\n\nThe function we must analyze is $g(N) = N \\cdot \\max\\left(1, \\frac{A}{\\sqrt{\\ln N}}\\right)$.\nThe derivative of the term $N/\\sqrt{\\ln N}$ is positive for $N > e^{1/2} \\approx 1.65$. Thus, for our domain $N \\ge 2$, $N/\\sqrt{\\ln N}$ is strictly increasing. This implies that $g(N)$ is a monotonically increasing function of $N$ for $N \\ge 2$.\n\nBecause $g(N)$ is monotonic, we can find the smallest integer $N$ satisfying $g(N) \\ge B$ using a simple iterative search. The algorithm is as follows:\n1.  For a given set of parameters, calculate the constants $A$ and $B$.\n2.  Initialize $N = 2$.\n3.  In a loop, calculate $g(N) = N \\cdot \\max\\left(1, A/\\sqrt{\\ln N}\\right)$.\n4.  If $g(N) \\ge B$, then the current $N$ is the minimal integer solution. Terminate the search and return $N$.\n5.  If $g(N)  B$, increment $N$ by $1$ and repeat from step 3.\n\nThis search is guaranteed to terminate because $g(N)$ grows at least linearly with $N$ for large $N$, and will eventually exceed any finite constant $B$. This algorithm will be implemented to solve for each of the provided test cases.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the minimal integer N for which the Verlet list strategy\n    overtakes the direct all-pairs evaluation strategy, for a series of test cases.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    # Format: (c_check, c_force, c_build, r_s, r_c, rho, T, m_amu, dt)\n    test_cases = [\n        (70, 60, 15000, 0.2, 0.85, 0.8, 120, 39.948, 0.002), # Case 1\n        (60, 60, 12000, 0.2, 0.85, 0.8, 120, 39.948, 0.002), # Case 2\n        (50, 60, 9000, 0.3, 0.85, 0.8, 120, 39.948, 0.002),  # Case 3\n        (40, 60, 7000, 0.3, 0.85, 0.8, 120, 39.948, 0.002),  # Case 4\n        (100, 60, 5000, 0.3, 0.85, 0.8, 120, 39.948, 0.002), # Case 5\n        (90, 60, 4000, 0.4, 0.85, 0.8, 120, 39.948, 0.002),  # Case 6\n        (50, 60, 5000, 0.01, 0.85, 0.8, 600, 39.948, 0.002), # Case 7\n        (50, 60, 20000, 1.0, 0.85, 0.8, 120, 39.948, 0.002)  # Case 8\n    ]\n\n    results = []\n    for params in test_cases:\n        result = find_minimal_n(params)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\ndef find_minimal_n(params):\n    \"\"\"\n    Calculates the crossover point N for a single parameter set.\n    \"\"\"\n    c_check, c_force, c_build, r_s, r_c, rho, T, m_amu, dt = params\n\n    # Physical constants\n    K_B = 1.380649e-23  # Boltzmann constant in J/K\n    AMU_TO_KG = 1.66053906660e-27  # Conversion from amu to kg\n    M_S_TO_NM_PS = 1e-3 # Conversion from m/s to nm/ps\n\n    # Step 1: Calculate v_rms in nm/ps\n    m_kg = m_amu * AMU_TO_KG\n    # v_rms^2 = 3 * k_B * T / m\n    v_rms_sq_ms = (3 * K_B * T) / m_kg\n    v_rms_ms = np.sqrt(v_rms_sq_ms)\n    v_rms_nmps = v_rms_ms * M_S_TO_NM_PS\n\n    # Step 2: Calculate dimensionless constants A and B from the model\n    # A = r_s / (2 * v_rms * sqrt(2) * dt)\n    A = r_s / (2 * np.sqrt(2) * v_rms_nmps * dt)\n    \n    # B = 2 * c_build / c_check\n    B = (2 * c_build) / c_check\n\n    # Step 3: Iteratively search for the minimal integer N = 2\n    # We solve g(N) = B, where g(N) = N * k(N).\n    n = 2\n    while True:\n        # k(N) = max(1, A / sqrt(ln N))\n        k_n = max(1.0, A / np.sqrt(np.log(n)))\n        # g(N) = N * k(N)\n        g_n = n * k_n\n        \n        if g_n = B:\n            return n\n        n += 1\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "3416011"}, {"introduction": "As simulations grew larger, ensuring their physical accuracy became a paramount concern. A common and necessary shortcut is to truncate the pair potential at a cutoff radius $r_c$, but this introduces systematic errors in calculated properties like pressure. This exercise places you in the role of an early practitioner tasked with fixing this issue, deriving the analytical \"tail corrections\" that account for the missing long-range interactions. You will quantify the bias from simple truncation and the more subtle effects of shifted-force potentials, developing a crucial skill for obtaining reliable results from simulations [@problem_id:3415973].", "problem": "Consider a homogeneous three-dimensional equilibrium fluid of identical particles interacting via a pair potential. The historical mechanical-route definition of pressure in Molecular Dynamics (MD) can be traced to the virial theorem, which relates the macroscopic pressure to the microscopic pair forces. Early molecular simulations frequently truncated pair potentials at a finite cutoff radius to reduce computational cost, and computed pressure by summing pair virials only up to that cutoff. Decades later, analytical long-range tail corrections were introduced to compensate for contributions from beyond the cutoff. In parallel, shifted-force truncations were adopted to reduce discontinuities in forces at the cutoff by subtracting a constant force, which changes the virial below the cutoff. Your task is to reconstruct these historical practices from first principles and quantify the bias that tail corrections eliminate, as well as the residual bias introduced by shifted-force truncations.\n\nStarting from fundamental laws and core definitions only, derive the expressions needed to compute the following quantities for the Lennard-Jones (LJ) pair potential, defined as $u(r) = 4 \\epsilon \\left[ \\left(\\dfrac{\\sigma}{r}\\right)^{12} - \\left(\\dfrac{\\sigma}{r}\\right)^{6} \\right]$, where $\\epsilon$ and $\\sigma$ are energy and length scales, respectively. Let $f(r)$ denote the scalar radial force defined by $f(r) = -\\dfrac{du}{dr}$.\n\n1. Begin from Newton's Second Law and the mechanical virial definition of pressure, $$P = \\dfrac{N k_{\\mathrm{B}} T}{V} + \\dfrac{1}{3V} \\left\\langle \\sum_{ij} \\mathbf{r}_{ij} \\cdot \\mathbf{F}_{ij} \\right\\rangle$$, and recast it into an isotropic continuum form for pairwise interactions involving the radial force $f(r)$ and the radial distribution function $g(r)$.\n\n2. Consider the practice of truncating the pair force at a cutoff $r_c$ without any shift, so that the truncated force is $f_{\\mathrm{trunc}}(r) = f(r)$ for $r  r_c$ and $f_{\\mathrm{trunc}}(r) = 0$ for $r \\ge r_c$. Under the historical mean-field assumption $g(r) = 1$ for $r > r_c$, derive the analytical long-range tail correction to the pressure that accounts for the contribution of $r \\in [r_c, \\infty)$ that was omitted by truncation. Do not start from or reference any pre-derived tail-correction formulas; derive the expression directly by performing the appropriate integral.\n\n3. Now consider the shifted-force (SF) truncation used to reduce force discontinuities, defined by $f_{\\mathrm{SF}}(r) = f(r) - f(r_c)$ for $r  r_c$ and $f_{\\mathrm{SF}}(r) = 0$ for $r \\ge r_c$. Show how the shifted-force modification changes the virial contribution below $r_c$ relative to the unshifted truncated case. In order to obtain a closed-form, reconstruct the historical mean-field estimate by taking $g(r) = 1$ over $r \\in [0, r_c]$ in the term that depends on the constant shift $f(r_c)$, and derive a formula for the resulting pressure bias introduced by the SF truncation relative to the unshifted truncation.\n\nDefine the signed “bias” of any computed pressure $P_{\\mathrm{comp}}$ relative to a baseline “later learned” corrected pressure $P_{\\mathrm{baseline}}$ as $B \\equiv P_{\\mathrm{comp}} - P_{\\mathrm{baseline}}$. Use the baseline $P_{\\mathrm{baseline}}$ that corresponds to the unshifted truncated computation corrected by your derived long-range tail term. With this convention:\n- The early-truncation bias without correction equals the negative of the tail correction (since $P_{\\mathrm{comp}} = P_{\\mathrm{trunc}}$ and $P_{\\mathrm{baseline}} = P_{\\mathrm{trunc}} + \\Delta P_{\\mathrm{tail}}$).\n- The early shifted-force bias without correction equals the early-truncation bias plus the additional SF virial-bias term.\n- The residual shifted-force bias after applying the same tail correction equals just the SF virial-bias term.\n\nAdopt reduced Lennard-Jones units with $\\epsilon = 1$, $\\sigma = 1$, and Boltzmann’s constant $k_{\\mathrm{B}} = 1$. Report all pressures and biases in reduced LJ pressure units $\\epsilon / \\sigma^3$. Angles do not appear and therefore do not require a specification. Temperatures are specified in reduced LJ units. Use $T = 1$ for all cases.\n\nTest Suite:\nCompute the three signed biases described above for each of the following parameter sets $(\\rho, r_c)$, where $\\rho$ is number density and $r_c$ is the cutoff radius:\n- Case $1$: $\\rho = 0.3$, $r_c = 2.5$.\n- Case $2$: $\\rho = 0.8$, $r_c = 2.5$.\n- Case $3$: $\\rho = 0.8$, $r_c = 1.5$.\n- Case $4$: $\\rho = 0.8$, $r_c = 2^{1/6}$.\n- Case $5$: $\\rho = 0.01$, $r_c = 4.0$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. The required format is a list of lists, one inner list per case, each inner list containing three floating-point numbers in the order\n$[B_{\\mathrm{early\\ trunc\\ no\\ tail}}, B_{\\mathrm{early\\ SF\\ no\\ tail}}, B_{\\mathrm{SF\\ residual\\ after\\ tail}}]$.\nFor example, the overall output must look like\n$[[b_{1,1}, b_{1,2}, b_{1,3}], [b_{2,1}, b_{2,2}, b_{2,3}], \\ldots, [b_{5,1}, b_{5,2}, b_{5,3}]]$\nwith all values expressed in reduced LJ pressure units $\\epsilon/\\sigma^3$ as floating-point numbers.", "solution": "The problem statement has been critically validated and is deemed valid. It is scientifically grounded in the principles of statistical mechanics, well-posed with all necessary constants and conditions, and objectively formulated. The task requires a direct derivation from first principles, which is a standard procedure in theoretical physics and chemistry, and the requested calculations are feasible and meaningful within the context of molecular simulation history.\n\nThe solution proceeds in four stages:\n1.  Recasting the virial definition of pressure into an isotropic continuum form.\n2.  Deriving the analytical long-range tail correction for pressure, $\\Delta P_{\\text{tail}}$.\n3.  Deriving the pressure bias introduced by the shifted-force truncation, $\\Delta P_{\\text{SF bias}}$.\n4.  Combining these results to calculate the three specified biases for the given test cases.\n\nThroughout this derivation, we use the Lennard-Jones (LJ) pair potential $u(r) = 4 \\epsilon \\left[ \\left(\\frac{\\sigma}{r}\\right)^{12} - \\left(\\frac{\\sigma}{r}\\right)^{6} \\right]$ and the corresponding radial force $f(r) = -\\frac{du}{dr}$.\n\n**1. Isotropic Continuum Form of Pressure**\n\nThe mechanical definition of pressure $P$ in a system of $N$ particles in a volume $V$ at temperature $T$ is given by the virial theorem:\n$$P = \\frac{N k_{\\mathrm{B}} T}{V} + \\frac{1}{3V} \\left\\langle \\sum_{ij} \\mathbf{r}_{ij} \\cdot \\mathbf{F}_{ij} \\right\\rangle$$\nwhere $k_{\\mathrm{B}}$ is the Boltzmann constant, $\\mathbf{r}_{ij} = \\mathbf{r}_j - \\mathbf{r}_i$ is the vector separating particles $i$ and $j$, $\\mathbf{F}_{ij}$ is the force exerted by particle $i$ on particle $j$, and $\\langle \\dots \\rangle$ denotes an ensemble average. The first term is the ideal gas pressure, with $\\rho = N/V$ being the number density.\n\nFor a homogeneous, isotropic fluid interacting via a pairwise potential, the sum over pairs can be converted into an integral. The ensemble-averaged sum can be expressed using the radial distribution function, $g(r)$, which gives the probability of finding a particle at a distance $r$ from a reference particle, relative to a uniform distribution.\n\nThe sum $\\sum_{ij}$ can be rewritten as $\\frac{1}{2} \\sum_{i} \\sum_{j \\neq i}$. For a large system, the sum over $j$ can be replaced by an integral over the volume, weighted by the local density $\\rho g(r)$:\n$$\\left\\langle \\sum_{ij} \\mathbf{r}_{ij} \\cdot \\mathbf{F}_{ij} \\right\\rangle = \\frac{N}{2} \\int_V \\rho g(r) (\\mathbf{r} \\cdot \\mathbf{F}(\\mathbf{r})) \\, d^3\\mathbf{r}$$\nThe force is central, $\\mathbf{F}(\\mathbf{r}) = f(r) \\frac{\\mathbf{r}}{r}$, where $f(r) = -\\frac{du}{dr}$ is the scalar radial force. Thus, $\\mathbf{r} \\cdot \\mathbf{F}(\\mathbf{r}) = r f(r)$. The volume element in spherical coordinates is $d^3\\mathbf{r} = 4\\pi r^2 dr$. Substituting these into the integral gives:\n$$\\left\\langle \\sum_{ij} \\mathbf{r}_{ij} \\cdot \\mathbf{F}_{ij} \\right\\rangle = \\frac{N \\rho}{2} \\int_0^\\infty g(r) (r f(r)) 4\\pi r^2 dr = 2\\pi N \\rho \\int_0^\\infty r^3 f(r) g(r) dr$$\nSubstituting this back into the pressure equation and using $\\rho = N/V$:\n$$P = \\rho k_{\\mathrm{B}} T + \\frac{1}{3V} \\left( 2\\pi N \\rho \\int_0^\\infty r^3 f(r) g(r) dr \\right) = \\rho k_{\\mathrm{B}} T + \\frac{2\\pi \\rho^2}{3} \\int_0^\\infty r^3 f(r) g(r) dr$$\nThis is the required isotropic continuum form of the pressure.\n\n**2. Long-Range Tail Correction**\n\nA truncated force calculation omits the virial contribution from pairs with separation $r > r_c$. The resulting pressure correction, $\\Delta P_{\\text{tail}}$, is the integral of the virial term from $r_c$ to infinity. We are instructed to use the historical mean-field approximation $g(r)=1$ for $r \\ge r_c$:\n$$\\Delta P_{\\text{tail}} = \\frac{2\\pi \\rho^2}{3} \\int_{r_c}^\\infty r^3 f(r) (1) dr$$\nFor the LJ potential, the force is:\n$$f(r) = -\\frac{d}{dr} \\left( 4\\epsilon \\left[ \\left(\\frac{\\sigma}{r}\\right)^{12} - \\left(\\frac{\\sigma}{r}\\right)^{6} \\right] \\right) = 4\\epsilon \\left[ 12\\frac{\\sigma^{12}}{r^{13}} - 6\\frac{\\sigma^6}{r^7} \\right]$$\nThe integral term is:\n$$\\int_{r_c}^\\infty r^3 f(r) dr = 4\\epsilon \\int_{r_c}^\\infty r^3 \\left[ 12\\frac{\\sigma^{12}}{r^{13}} - 6\\frac{\\sigma^6}{r^7} \\right] dr = 4\\epsilon \\int_{r_c}^\\infty \\left[ 12\\sigma^{12}r^{-10} - 6\\sigma^6r^{-4} \\right] dr$$\nPerforming the integration:\n$$= 4\\epsilon \\left[ 12\\sigma^{12} \\frac{r^{-9}}{-9} - 6\\sigma^6 \\frac{r^{-3}}{-3} \\right]_{r_c}^\\infty = 4\\epsilon \\left[ -\\frac{4}{3}\\sigma^{12}r^{-9} + 2\\sigma^6r^{-3} \\right]_{r_c}^\\infty$$\nEvaluating the limits (the expression is $0$ at $r=\\infty$):\n$$= 4\\epsilon \\left[ 0 - \\left( -\\frac{4}{3}\\frac{\\sigma^{12}}{r_c^9} + 2\\frac{\\sigma^6}{r_c^3} \\right) \\right] = 4\\epsilon \\left[ \\frac{4}{3}\\frac{\\sigma^{12}}{r_c^9} - 2\\frac{\\sigma^6}{r_c^3} \\right]$$\nSubstituting this into the expression for $\\Delta P_{\\text{tail}}$:\n$$\\Delta P_{\\text{tail}} = \\frac{2\\pi \\rho^2}{3} \\left( 4\\epsilon \\left[ \\frac{4}{3}\\frac{\\sigma^{12}}{r_c^9} - 2\\frac{\\sigma^6}{r_c^3} \\right] \\right) = \\frac{8\\pi \\rho^2 \\epsilon}{3} \\left[ \\frac{4}{3}\\frac{\\sigma^{12}}{r_c^9} - 2\\frac{\\sigma^6}{r_c^3} \\right] = \\frac{16\\pi \\rho^2 \\epsilon}{3} \\left[ \\frac{2}{3}\\frac{\\sigma^{12}}{r_c^9} - \\frac{\\sigma^6}{r_c^3} \\right]$$\nIn LJ reduced units where $\\epsilon=1$ and $\\sigma=1$, this simplifies to:\n$$\\Delta P_{\\text{tail}} = \\frac{16\\pi \\rho^2}{3} \\left( \\frac{2}{3r_c^9} - \\frac{1}{r_c^3} \\right)$$\n\n**3. Shifted-Force Virial Bias**\n\nThe shifted-force is $f_{\\text{SF}}(r) = f(r) - f(r_c)$ for $r  r_c$. The change in the virial contribution relative to the unshifted truncated calculation is due to the subtraction of the constant force $f(r_c)$. This change, denoted $\\Delta P_{\\text{SF bias}}$, is:\n$$\\Delta P_{\\text{SF bias}} = \\frac{2\\pi \\rho^2}{3} \\int_0^{r_c} r^3 \\left[ (f(r)-f(r_c)) - f(r) \\right] g(r) dr = -\\frac{2\\pi \\rho^2}{3} \\int_0^{r_c} r^3 f(r_c) g(r) dr$$\nSince $f(r_c)$ is a constant, we can take it out of the integral:\n$$\\Delta P_{\\text{SF bias}} = - \\frac{2\\pi \\rho^2 f(r_c)}{3} \\int_0^{r_c} r^3 g(r) dr$$\nUsing the historical approximation $g(r) = 1$ for $r \\in [0, r_c]$:\n$$\\int_0^{r_c} r^3 (1) dr = \\left[ \\frac{r^4}{4} \\right]_0^{r_c} = \\frac{r_c^4}{4}$$\nSubstituting this result:\n$$\\Delta P_{\\text{SF bias}} = - \\frac{2\\pi \\rho^2 f(r_c)}{3} \\left( \\frac{r_c^4}{4} \\right) = - \\frac{\\pi \\rho^2 f(r_c) r_c^4}{6}$$\nIn reduced units, $f(r_c) = 4\\left[ \\frac{12}{r_c^{13}} - \\frac{6}{r_c^7} \\right]$. The bias is:\n$$\\Delta P_{\\text{SF bias}} = - \\frac{\\pi \\rho^2 r_c^4}{6} \\left( 4\\left[ \\frac{12}{r_c^{13}} - \\frac{6}{r_c^7} \\right] \\right) = - \\frac{2\\pi \\rho^2 r_c^4}{3} \\left[ \\frac{12}{r_c^{13}} - \\frac{6}{r_c^7} \\right]$$\n$$\\Delta P_{\\text{SF bias}} = - 2\\pi \\rho^2 \\left[ \\frac{12}{r_c^9} - \\frac{6}{r_c^3} \\right] = -4\\pi \\rho^2 \\left( \\frac{6}{r_c^9} - \\frac{3}{r_c^3} \\right)$$\nUsing $f(r) = 24\\epsilon(\\frac{2\\sigma^{12}}{r^{13}}-\\frac{\\sigma^6}{r^7})$, the bias is:\n$$\\Delta P_{\\text{SF bias}} = -\\frac{\\pi \\rho^2 r_c^4}{6} \\left(24\\epsilon \\left[\\frac{2\\sigma^{12}}{r_c^{13}} - \\frac{\\sigma^6}{r_c^7}\\right]\\right) = -4\\pi \\rho^2\\epsilon r_c^4 \\left[\\frac{2\\sigma^{12}}{r_c^{13}} - \\frac{\\sigma^6}{r_c^7}\\right]$$\nIn reduced units:\n$$\\Delta P_{\\text{SF bias}} = -4\\pi \\rho^2 \\left( \\frac{2}{r_c^9} - \\frac{1}{r_c^3} \\right)$$\n\n**4. Bias Calculations**\n\nThe baseline pressure is $P_{\\text{baseline}} = P_{\\text{trunc}} + \\Delta P_{\\text{tail}}$. The biases are defined as $B = P_{\\text{comp}} - P_{\\text{baseline}}$.\n\n1.  **Early truncation bias ($B_{\\text{early trunc no tail}}$)**: The computed pressure is simply the truncated one, $P_{\\text{comp}} = P_{\\text{trunc}}$.\n    $$B_{\\text{early trunc no tail}} = P_{\\text{trunc}} - (P_{\\text{trunc}} + \\Delta P_{\\text{tail}}) = -\\Delta P_{\\text{tail}}$$\n\n2.  **Early shifted-force bias ($B_{\\text{early SF no tail}}$)**: The computed pressure is from the shifted-force potential without tail correction, $P_{\\text{comp}} = P_{\\text{SF}}$. The pressure from the shifted force is $P_{\\text{SF}} = P_{\\text{trunc}} + \\Delta P_{\\text{SF bias}}$.\n    $$B_{\\text{early SF no tail}} = P_{\\text{SF}} - P_{\\text{baseline}} = (P_{\\text{trunc}} + \\Delta P_{\\text{SF bias}}) - (P_{\\text{trunc}} + \\Delta P_{\\text{tail}}) = \\Delta P_{\\text{SF bias}} - \\Delta P_{\\text{tail}}$$\n\n3.  **Residual shifted-force bias ($B_{\\text{SF residual after tail}}$)**: The computed pressure is from the shifted-force potential with the standard tail correction applied, $P_{\\text{comp}} = P_{\\text{SF}} + \\Delta P_{\\text{tail}}$.\n    $$B_{\\text{SF residual after tail}} = (P_{\\text{SF}} + \\Delta P_{\\text{tail}}) - P_{\\text{baseline}} = (P_{\\text{trunc}} + \\Delta P_{\\text{SF bias}} + \\Delta P_{\\text{tail}}) - (P_{\\text{trunc}} + \\Delta P_{\\text{tail}}) = \\Delta P_{\\text{SF bias}}$$\n\nUsing the derived formulae for $\\Delta P_{\\text{tail}}$ and $\\Delta P_{\\text{SF bias}}$ in reduced units, we can compute these three biases for the given parameters.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes pressure biases in historical molecular dynamics simulations\n    based on derived analytical formulas for the Lennard-Jones potential.\n    \"\"\"\n\n    test_cases = [\n        # (rho, rc)\n        (0.3, 2.5),\n        (0.8, 2.5),\n        (0.8, 1.5),\n        (0.8, 2**(1/6)),\n        (0.01, 4.0),\n    ]\n\n    def calculate_delta_P_tail(rho, rc):\n        \"\"\"\n        Calculates the long-range pressure tail correction.\n        Formula derived in the solution:\n        ΔP_tail = (16πρ²/3) * (2/(3rc⁹) - 1/rc³)\n        \"\"\"\n        rho2 = rho * rho\n        rc3 = rc**3\n        rc9 = rc**9\n        term1 = 2.0 / (3.0 * rc9)\n        term2 = 1.0 / rc3\n        delta_p = (16.0 * np.pi * rho2 / 3.0) * (term1 - term2)\n        return delta_p\n\n    def calculate_delta_P_sf_bias(rho, rc):\n        \"\"\"\n        Calculates the pressure bias from using a shifted-force potential.\n        Formula derived in the solution:\n        ΔP_SF_bias = -4πρ² * (2/rc⁹ - 1/rc³)\n        \"\"\"\n        rho2 = rho * rho\n        rc3 = rc**3\n        rc9 = rc**9\n        term1 = 2.0 / rc9\n        term2 = 1.0 / rc3\n        delta_p = -4.0 * np.pi * rho2 * (term1 - term2)\n        return delta_p\n\n    results = []\n    for rho, rc in test_cases:\n        delta_p_tail = calculate_delta_P_tail(rho, rc)\n        delta_p_sf_bias = calculate_delta_P_sf_bias(rho, rc)\n\n        # 1. B_early_trunc_no_tail = -ΔP_tail\n        b1 = -delta_p_tail\n\n        # 2. B_early_SF_no_tail = ΔP_SF_bias - ΔP_tail\n        b2 = delta_p_sf_bias - delta_p_tail\n        \n        # 3. B_SF_residual_after_tail = ΔP_SF_bias\n        b3 = delta_p_sf_bias\n\n        results.append([b1, b2, b3])\n\n    # Format the output as a list of lists string\n    # E.g., [[b1, b2, b3], [b1, b2, b3], ...]\n    output_str = f\"[{','.join(map(str, results))}]\"\n    print(output_str)\n\nsolve()\n```", "id": "3415973"}, {"introduction": "For a simulation to be meaningful, it must remain stable over millions of time steps, faithfully representing the true dynamics without accumulating catastrophic numerical errors. The remarkable long-term energy conservation observed in modern simulations is not accidental; it is a direct consequence of using symplectic integrators like the velocity Verlet algorithm. This practice delves into the elegant theory behind this stability by having you apply backward error analysis to derive the \"shadow Hamiltonian\"—a slightly perturbed energy function that the integrator conserves exactly—thereby quantifying the bounded nature of energy fluctuations in a well-designed simulation [@problem_id:3416025].", "problem": "A central achievement in the historical development of Molecular Dynamics (MD) was the adoption of symplectic integrators, notably the velocity Verlet scheme introduced by Loup Verlet, which led to the modern concept of a conserved “shadow Hamiltonian” formalized via Backward Error Analysis (BEA). Consider a dilute argon system modeled by the Lennard-Jones (LJ) pair potential, where a typical interacting nearest-neighbor pair can be approximated near the potential minimum by a one-dimensional harmonic oscillator in the pair’s relative coordinate. Argon is characterized by LJ parameters $\\sigma=3.405\\times 10^{-10}~\\mathrm{m}$ and $\\varepsilon=k_{B}\\times 119.8~\\mathrm{K}$, where $k_{B}$ is the Boltzmann constant. Each argon atom has mass $m=39.948~\\mathrm{u}$, where $1~\\mathrm{u}=1.66053906660\\times 10^{-27}~\\mathrm{kg}$. The system is simulated at temperature $T=120~\\mathrm{K}$ using the velocity Verlet integrator with a fixed time step $\\Delta t=5~\\mathrm{fs}$. Assume the dynamics of one isolated LJ argon pair is dominated by small oscillations about the minimum separation $r_{\\mathrm{m}}=2^{1/6}\\sigma$, and approximate the pair interaction by a harmonic potential $V(r)\\approx \\frac{1}{2}k_{\\mathrm{eff}}(r-r_{\\mathrm{m}})^{2}$, where $k_{\\mathrm{eff}}=\\left.\\frac{d^{2}V_{\\mathrm{LJ}}}{dr^{2}}\\right|_{r=r_{\\mathrm{m}}}$ and $V_{\\mathrm{LJ}}(r)=4\\varepsilon\\left[(\\sigma/r)^{12}-(\\sigma/r)^{6}\\right]$. Treat the relative coordinate as a one-dimensional degree of freedom with reduced mass $\\mu=m/2$.\n\nStarting from Newton’s laws, the separable Hamiltonian $H=T(p)+V(x)$ for the harmonic approximation, and the definition of the velocity Verlet update as a symplectic method, use Backward Error Analysis to derive the leading-order shadow Hamiltonian $\\tilde{H}$ for this one-dimensional mode. From this, obtain the leading-order, long-time averaged discrepancy $\\langle\\tilde{H}-H\\rangle$ for a canonical ensemble at temperature $T$ by invoking equipartition of energy for the harmonic mode. Then, interpret this constant offset as the apparent “energy drift” one would observe after $10^{6}$ steps when monitoring the true Hamiltonian $H$ (i.e., neglecting roundoff and any thermostatting, so that the symplectic nature controls the long-time behavior). Compute this energy drift for the given argon LJ pair parameters.\n\nExpress your final numerical answer in Joules, and round to three significant figures.", "solution": "The user wants me to solve a problem from the field of molecular dynamics.\n\n### Step 1: Extract Givens\n- **System**: A dilute argon system, with an interacting pair approximated as a one-dimensional harmonic oscillator.\n- **Potential**: Lennard-Jones (LJ) pair potential $V_{\\mathrm{LJ}}(r)=4\\varepsilon\\left[(\\sigma/r)^{12}-(\\sigma/r)^{6}\\right]$.\n- **Harmonic Approximation**: $V(r)\\approx \\frac{1}{2}k_{\\mathrm{eff}}(r-r_{\\mathrm{m}})^{2}$ near the minimum $r_{\\mathrm{m}}=2^{1/6}\\sigma$.\n- **Effective Spring Constant**: $k_{\\mathrm{eff}}=\\left.\\frac{d^{2}V_{\\mathrm{LJ}}}{dr^{2}}\\right|_{r=r_{\\mathrm{m}}}$.\n- **LJ parameters for Argon**: $\\sigma=3.405\\times 10^{-10}~\\mathrm{m}$, $\\varepsilon=k_{B}\\times 119.8~\\mathrm{K}$.\n- **Mass of Argon atom**: $m=39.948~\\mathrm{u}$, where $1~\\mathrm{u}=1.66053906660\\times 10^{-27}~\\mathrm{kg}$.\n- **Reduced Mass**: The relative coordinate is treated with a reduced mass $\\mu=m/2$.\n- **System Temperature**: $T=120~\\mathrm{K}$.\n- **Integrator**: Velocity Verlet algorithm.\n- **Time Step**: $\\Delta t=5~\\mathrm{fs} = 5 \\times 10^{-15} \\, \\mathrm{s}$.\n- **Hamiltonian**: Separable form $H=T(p)+V(x)$.\n- **Goal**:\n    1. Derive the leading-order shadow Hamiltonian $\\tilde{H}$ for the harmonic approximation.\n    2. Obtain the long-time averaged discrepancy $\\langle\\tilde{H}-H\\rangle$ for a canonical ensemble at temperature $T$.\n    3. Interpret this as the \"energy drift\" after $10^{6}$ steps and compute its numerical value for the given parameters.\n\n### Step 2: Validate Using Extracted Givens\n1.  **Scientifically Grounded**: The problem is firmly rooted in the principles of statistical mechanics and computational physics. The Lennard-Jones potential, velocity Verlet integrator, Backward Error Analysis, and the concept of a shadow Hamiltonian are all standard and foundational topics in molecular simulation.\n2.  **Well-Posed**: The problem provides all necessary physical constants and parameters. It asks for a specific, computable quantity. The steps to the solution are logically outlined.\n3.  **Objective**: The problem is stated in precise, technical language, free from subjectivity or ambiguity.\n\n### Step 3: Verdict and Action\nThe problem is valid. The solution process may proceed.\n\n### Solution\nThe problem asks for the apparent energy drift in a molecular dynamics simulation of an argon pair, which can be understood as the leading-order systematic error in the energy due to the time-discretization of the velocity Verlet algorithm. This error is quantified by the ensemble average of the difference between the conserved shadow Hamiltonian and the true Hamiltonian.\n\nFirst, we determine the effective spring constant $k_{\\mathrm{eff}}$ from the Lennard-Jones potential $V_{\\mathrm{LJ}}(r)=4\\varepsilon\\left[(\\sigma/r)^{12}-(\\sigma/r)^{6}\\right]$. The spring constant is the second derivative of the potential evaluated at the minimum separation distance $r_{\\mathrm{m}}=2^{1/6}\\sigma$.\nThe first derivative is:\n$$ \\frac{dV_{\\mathrm{LJ}}}{dr} = 4\\varepsilon \\left[ -12\\frac{\\sigma^{12}}{r^{13}} + 6\\frac{\\sigma^6}{r^7} \\right] $$\nThe second derivative is:\n$$ \\frac{d^{2}V_{\\mathrm{LJ}}}{dr^{2}} = 4\\varepsilon \\left[ (-12)(-13)\\frac{\\sigma^{12}}{r^{14}} + (6)(-7)\\frac{\\sigma^6}{r^8} \\right] = 4\\varepsilon \\left[ 156\\frac{\\sigma^{12}}{r^{14}} - 42\\frac{\\sigma^6}{r^8} \\right] $$\nWe evaluate this at $r=r_{\\mathrm{m}}=2^{1/6}\\sigma$. At this distance, we have $(\\sigma/r_{\\mathrm{m}})^6 = 1/2$.\n$$ k_{\\mathrm{eff}} = \\left.\\frac{d^{2}V_{\\mathrm{LJ}}}{dr^{2}}\\right|_{r=r_{\\mathrm{m}}} = \\frac{4\\varepsilon}{r_{\\mathrm{m}}^2} \\left[ 156\\left(\\frac{\\sigma}{r_{\\mathrm{m}}}\\right)^{12} - 42\\left(\\frac{\\sigma}{r_{\\mathrm{m}}}\\right)^{6} \\right] $$\nSubstituting $(\\sigma/r_{\\mathrm{m}})^{12} = (1/2)^2 = 1/4$ and $r_{\\mathrm{m}}^2 = (2^{1/6}\\sigma)^2 = 2^{1/3}\\sigma^2$:\n$$ k_{\\mathrm{eff}} = \\frac{4\\varepsilon}{2^{1/3}\\sigma^2} \\left[ 156\\left(\\frac{1}{4}\\right) - 42\\left(\\frac{1}{2}\\right) \\right] = \\frac{4\\varepsilon}{2^{1/3}\\sigma^2} [39 - 21] = \\frac{4\\varepsilon(18)}{2^{1/3}\\sigma^2} = \\frac{72\\varepsilon}{2^{1/3}\\sigma^2} $$\nThe system is modeled as a 1D harmonic oscillator with potential $V(x) = \\frac{1}{2}k_{\\mathrm{eff}}x^2$, where $x=r-r_{\\mathrm{m}}$, and Hamiltonian $H = \\frac{p^2}{2\\mu} + V(x)$.\n\nFor a separable Hamiltonian and the velocity Verlet integrator, Backward Error Analysis shows that the integrator exactly conserves a shadow Hamiltonian $\\tilde{H}$, which differs from the true Hamiltonian $H$. The leading-order correction is of order $(\\Delta t)^2$:\n$$ \\tilde{H} = H + (\\Delta t)^2 H_2 + O((\\Delta t)^4) $$\nThe correction term $H_2$ is given by:\n$$ H_2 = \\frac{1}{24\\mu} (V'(x))^2 - \\frac{p^2}{12\\mu^2} V''(x) $$\nFor our harmonic oscillator, $V'(x) = k_{\\mathrm{eff}}x$ and $V''(x) = k_{\\mathrm{eff}}$. Substituting these into the expression for $H_2$:\n$$ \\tilde{H} - H \\approx (\\Delta t)^2 \\left[ \\frac{(k_{\\mathrm{eff}}x)^2}{24\\mu} - \\frac{p^2 k_{\\mathrm{eff}}}{12\\mu^2} \\right] $$\nThe problem asks for the long-time averaged discrepancy $\\langle\\tilde{H}-H\\rangle$. In the canonical ensemble at temperature $T$, we can evaluate this average using the equipartition theorem for a one-dimensional harmonic oscillator. The average potential energy and average kinetic energy are both equal to $\\frac{1}{2}k_B T$:\n$$ \\left\\langle \\frac{1}{2}k_{\\mathrm{eff}}x^2 \\right\\rangle = \\frac{1}{2}k_B T \\implies \\langle k_{\\mathrm{eff}}x^2 \\rangle = k_B T $$\n$$ \\left\\langle \\frac{p^2}{2\\mu} \\right\\rangle = \\frac{1}{2}k_B T \\implies \\langle p^2 \\rangle = \\mu k_B T $$\nNow we take the ensemble average of the discrepancy:\n$$ \\langle \\tilde{H} - H \\rangle = (\\Delta t)^2 \\left\\langle \\frac{k_{\\mathrm{eff}}^2 x^2}{24\\mu} - \\frac{p^2 k_{\\mathrm{eff}}}{12\\mu^2} \\right\\rangle = (\\Delta t)^2 \\left[ \\frac{k_{\\mathrm{eff}}}{24\\mu} \\langle k_{\\mathrm{eff}}x^2 \\rangle - \\frac{k_{\\mathrm{eff}}}{12\\mu^2} \\langle p^2 \\rangle \\right] $$\nSubstituting the equipartition results:\n$$ \\langle \\tilde{H} - H \\rangle = (\\Delta t)^2 \\left[ \\frac{k_{\\mathrm{eff}}}{24\\mu} (k_B T) - \\frac{k_{\\mathrm{eff}}}{12\\mu^2} (\\mu k_B T) \\right] = (\\Delta t)^2 \\frac{k_{\\mathrm{eff}}k_B T}{\\mu} \\left[ \\frac{1}{24} - \\frac{1}{12} \\right] $$\n$$ \\langle \\tilde{H} - H \\rangle = -(\\Delta t)^2 \\frac{k_{\\mathrm{eff}}k_B T}{24\\mu} $$\nThis constant offset represents the systematic difference between the conserved shadow energy and the average true energy. The problem's \"energy drift\" is a misnomer for this quantity, as symplectic integrators have bounded energy error, not secular drift. The mention of $10^6$ steps simply implies the long-time limit where this average is well-defined. We compute the magnitude of this offset. Let $\\omega^2 = k_{\\mathrm{eff}}/\\mu$ be the squared angular frequency of the oscillator.\n$$ |\\langle \\tilde{H} - H \\rangle| = \\frac{(\\omega \\Delta t)^2}{24} k_B T $$\nNow, we calculate the numerical value.\nGiven constants:\n- $k_B = 1.380649 \\times 10^{-23}~\\mathrm{J/K}$\n- $\\varepsilon=k_{B}\\times 119.8~\\mathrm{K} \\approx 1.654217 \\times 10^{-21}~\\mathrm{J}$\n- $\\sigma=3.405\\times 10^{-10}~\\mathrm{m}$\n- $m=39.948~\\mathrm{u} = 39.948 \\times 1.660539 \\times 10^{-27}~\\mathrm{kg} \\approx 6.63352 \\times 10^{-26}~\\mathrm{kg}$\n- $\\mu=m/2 \\approx 3.31676 \\times 10^{-26}~\\mathrm{kg}$\n- $T=120~\\mathrm{K}$\n- $\\Delta t = 5~\\mathrm{fs} = 5 \\times 10^{-15}~\\mathrm{s}$\n\nFirst, calculate $k_{\\mathrm{eff}}$:\n$$ k_{\\mathrm{eff}} = \\frac{72\\varepsilon}{2^{1/3}\\sigma^2} = \\frac{72 \\times (1.654217 \\times 10^{-21}~\\mathrm{J})}{2^{1/3} \\times (3.405 \\times 10^{-10}~\\mathrm{m})^2} \\approx \\frac{1.19104 \\times 10^{-19}~\\mathrm{J}}{1.46074 \\times 10^{-19}~\\mathrm{m^2}} \\approx 0.81537~\\mathrm{N/m} $$\nNext, calculate $\\omega^2 = k_{\\mathrm{eff}}/\\mu$:\n$$ \\omega^2 = \\frac{0.81537~\\mathrm{N/m}}{3.31676 \\times 10^{-26}~\\mathrm{kg}} \\approx 2.45833 \\times 10^{25}~\\mathrm{s}^{-2} $$\nThen, compute the dimensionless term $(\\omega \\Delta t)^2$:\n$$ (\\omega \\Delta t)^2 = \\omega^2 (\\Delta t)^2 \\approx (2.45833 \\times 10^{25}~\\mathrm{s}^{-2}) \\times (5 \\times 10^{-15}~\\mathrm{s})^2 = 6.14583 \\times 10^{-4} $$\nThe thermal energy is $k_B T$:\n$$ k_B T = (1.380649 \\times 10^{-23}~\\mathrm{J/K}) \\times 120~\\mathrm{K} \\approx 1.65678 \\times 10^{-21}~\\mathrm{J} $$\nFinally, compute the energy offset:\n$$ |\\langle \\tilde{H} - H \\rangle| = \\frac{(\\omega \\Delta t)^2}{24} k_B T \\approx \\frac{6.14583 \\times 10^{-4}}{24} \\times (1.65678 \\times 10^{-21}~\\mathrm{J}) $$\n$$ |\\langle \\tilde{H} - H \\rangle| \\approx (2.56076 \\times 10^{-5}) \\times (1.65678 \\times 10^{-21}~\\mathrm{J}) \\approx 4.2424 \\times 10^{-26}~\\mathrm{J} $$\nRounding to three significant figures, the result is $4.24 \\times 10^{-26}~\\mathrm{J}$.", "answer": "$$\\boxed{4.24 \\times 10^{-26}}$$", "id": "3416025"}]}