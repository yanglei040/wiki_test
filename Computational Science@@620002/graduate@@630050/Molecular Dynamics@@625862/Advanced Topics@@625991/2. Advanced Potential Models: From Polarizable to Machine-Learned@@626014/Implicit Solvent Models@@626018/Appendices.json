{"hands_on_practices": [{"introduction": "To accurately model biomolecular systems, we must first understand how the aqueous solvent environment modifies electrostatic interactions. In an electrolyte solution, mobile ions arrange themselves around charges, creating a screening effect. This practice guides you through the foundational principles of the linearized Poisson-Boltzmann theory to derive and calculate the Debye screening length, $\\lambda_D$, which is the characteristic length scale of this ionic screening. Mastering this calculation provides a concrete understanding of how bulk properties like salt concentration and temperature dictate electrostatic behavior at the molecular level [@problem_id:3417826].", "problem": "In implicit solvent models used in molecular dynamics, such as the Generalized Born (GB) approximation and the Poisson–Boltzmann (PB) framework, electrolyte screening is characterized by the Debye screening length $\\lambda_{D}$. Consider an aqueous solution of a monovalent $1:1$ electrolyte at ionic strength $I = 0.10$ M at temperature $T = 298$ K. The solvent is liquid water with relative dielectric constant $\\epsilon_{r} = 78.5$ at $298$ K. Assume the potential is sufficiently small that the linearized Poisson–Boltzmann description applies.\n\nStarting from the electrostatic Poisson equation and the Boltzmann distribution for mobile ions, derive the expression for the inverse Debye length $\\kappa$ in terms of fundamental constants and bulk number densities, and then compute the Debye screening length $\\lambda_{D} = \\kappa^{-1}$ for this solution. You must explicitly state the numerical values of the constants you use. Use the International System of Units throughout and convert molar concentrations to number densities consistently. Express the final $\\lambda_{D}$ in nanometers (nm) and round your answer to four significant figures.\n\nAll steps must be justified from first principles appropriate to the Poisson–Boltzmann framework, and every mathematical symbol must be presented in LaTeX.", "solution": "The problem requires the derivation of the expression for the inverse Debye length, $\\kappa$, and the calculation of the Debye screening length, $\\lambda_{D} = \\kappa^{-1}$, for a specified aqueous electrolyte solution. The derivation must start from the Poisson equation and the Boltzmann distribution for ions.\n\nThe foundation of the model is the Poisson equation, which relates the electrostatic potential, $\\phi(\\mathbf{r})$, to the total charge density, $\\rho(\\mathbf{r})$, at a position $\\mathbf{r}$:\n$$ \\nabla^2 \\phi(\\mathbf{r}) = -\\frac{\\rho(\\mathbf{r})}{\\epsilon} $$\nwhere $\\epsilon$ is the permittivity of the solvent medium. The permittivity is given by $\\epsilon = \\epsilon_0 \\epsilon_r$, where $\\epsilon_0$ is the vacuum permittivity and $\\epsilon_r$ is the relative dielectric constant of the solvent. The total charge density $\\rho(\\mathbf{r})$ is composed of charges from the mobile ions in the electrolyte solution. For an electrolyte containing multiple ion species indexed by $i$, the charge density is:\n$$ \\rho(\\mathbf{r}) = \\sum_{i} z_i e n_i(\\mathbf{r}) $$\nHere, $z_i$ is the valence of ion species $i$, $e$ is the elementary charge, and $n_i(\\mathbf{r})$ is the local number density of ion species $i$.\n\nThe local number density, $n_i(\\mathbf{r})$, is not uniform. It depends on the local electrostatic potential according to the Boltzmann distribution. The potential energy of an ion of charge $z_i e$ at a location with potential $\\phi(\\mathbf{r})$ is $U_i(\\mathbf{r}) = z_i e \\phi(\\mathbf{r})$. The Boltzmann distribution relates the local number density $n_i(\\mathbf{r})$ to the bulk number density $n_i^0$ (where the potential is taken to be zero):\n$$ n_i(\\mathbf{r}) = n_i^0 \\exp\\left(-\\frac{U_i(\\mathbf{r})}{k_B T}\\right) = n_i^0 \\exp\\left(-\\frac{z_i e \\phi(\\mathbf{r})}{k_B T}\\right) $$\nwhere $k_B$ is the Boltzmann constant and $T$ is the absolute temperature.\n\nSubstituting the expressions for $\\rho(\\mathbf{r})$ and $n_i(\\mathbf{r})$ into the Poisson equation yields the full Poisson-Boltzmann (PB) equation:\n$$ \\nabla^2 \\phi(\\mathbf{r}) = -\\frac{1}{\\epsilon} \\sum_{i} z_i e n_i^0 \\exp\\left(-\\frac{z_i e \\phi(\\mathbf{r})}{k_B T}\\right) $$\nThe problem states that the potential is sufficiently small to use the linearized PB description. This corresponds to the condition $|z_i e \\phi(\\mathbf{r})| \\ll k_B T$. We can therefore linearize the exponential term using a first-order Taylor expansion, $\\exp(-x) \\approx 1 - x$ for small $x$:\n$$ \\nabla^2 \\phi(\\mathbf{r}) \\approx -\\frac{e}{\\epsilon} \\sum_{i} z_i n_i^0 \\left(1 - \\frac{z_i e \\phi(\\mathbf{r})}{k_B T}\\right) $$\nDistributing the terms in the summation gives:\n$$ \\nabla^2 \\phi(\\mathbf{r}) \\approx -\\frac{e}{\\epsilon} \\left( \\sum_{i} z_i n_i^0 - \\frac{e \\phi(\\mathbf{r})}{k_B T} \\sum_{i} z_i^2 n_i^0 \\right) $$\nThe first term in the parentheses, $\\sum_{i} z_i n_i^0$, represents the net charge density in the bulk solution. Since the bulk solution is electrically neutral, this sum is zero. The equation thus simplifies to the linearized Poisson-Boltzmann equation:\n$$ \\nabla^2 \\phi(\\mathbf{r}) = \\left( \\frac{e^2}{\\epsilon k_B T} \\sum_{i} z_i^2 n_i^0 \\right) \\phi(\\mathbf{r}) $$\nThis is a Helmholtz-type equation of the form $\\nabla^2 \\phi = \\kappa^2 \\phi$. By comparison, we identify the square of the inverse Debye length, $\\kappa^2$:\n$$ \\kappa^2 = \\frac{e^2}{\\epsilon k_B T} \\sum_{i} z_i^2 n_i^0 $$\nThis is the required expression for $\\kappa^2$ in terms of fundamental constants and bulk number densities. The Debye screening length is then $\\lambda_D = \\kappa^{-1}$.\n\nNext, we compute the value of $\\lambda_D$ for the given conditions. The solution contains a monovalent $1:1$ electrolyte (e.g., NaCl) with ionic strength $I = 0.10$ M. For a $1:1$ electrolyte, we have a cation with $z_+ = +1$ and an anion with $z_- = -1$. The ionic strength is defined as $I = \\frac{1}{2} \\sum_{i} c_i z_i^2$, where $c_i$ is the molar concentration of ion $i$. For a $1:1$ electrolyte of concentration $C$, we have $c_+ = C$ and $c_- = C$, so $I = \\frac{1}{2}(C(1)^2 + C(-1)^2) = C$. Thus, the concentration of the electrolyte is $C = 0.10$ M.\n\nWe need to convert the molar ionic strength $I$ (in units of mol/L or M) to the term $\\sum_i z_i^2 n_i^0$ (in units of m$^{-3}$). The number density $n_i^0$ is related to the molar concentration $c_i$ by Avogadro's number, $N_A$, and a unit conversion factor for volume ($1$ L $= 10^{-3}$ m$^3$):\n$$ n_i^0 (\\text{m}^{-3}) = c_i (\\text{mol/L}) \\times 1000 (\\text{L/m}^3) \\times N_A (\\text{mol}^{-1}) $$\nThe summation term becomes:\n$$ \\sum_{i} z_i^2 n_i^0 = \\sum_{i} z_i^2 (1000 N_A c_i) = 1000 N_A \\sum_{i} z_i^2 c_i $$\nRecognizing that $\\sum_{i} z_i^2 c_i = 2I$, we obtain:\n$$ \\sum_{i} z_i^2 n_i^0 = 2000 N_A I $$\nSubstituting this into the expression for $\\kappa^2$:\n$$ \\kappa^2 = \\frac{2000 N_A I e^2}{\\epsilon_0 \\epsilon_r k_B T} $$\n\nWe now substitute the numerical values. The required constants and given parameters in SI units are:\n- Ionic strength, $I = 0.10$ mol/L\n- Temperature, $T = 298$ K\n- Relative dielectric constant, $\\epsilon_r = 78.5$\n- Elementary charge, $e = 1.602176634 \\times 10^{-19}$ C\n- Avogadro's number, $N_A = 6.02214076 \\times 10^{23}$ mol$^{-1}$\n- Vacuum permittivity, $\\epsilon_0 = 8.85418781 \\times 10^{-12}$ F/m\n- Boltzmann constant, $k_B = 1.380649 \\times 10^{-23}$ J/K\n\nFirst, we calculate the numerator term, $N = 2000 N_A I e^2$:\n$$ N = 2000 \\times (6.02214076 \\times 10^{23}) \\times (0.10) \\times (1.602176634 \\times 10^{-19})^2 $$\n$$ N \\approx 3.09211 \\times 10^{-12} \\text{ C}^2\\cdot\\text{m}^{-3} $$\nNext, we calculate the denominator term, $D = \\epsilon_0 \\epsilon_r k_B T$:\n$$ D = (8.85418781 \\times 10^{-12}) \\times (78.5) \\times (1.380649 \\times 10^{-23}) \\times (298) $$\n$$ D \\approx 2.86016 \\times 10^{-30} \\text{ F}\\cdot\\text{J}\\cdot\\text{m}^{-1} \\text{ (or } \\text{C}^2 \\cdot \\text{m}^{-1}) $$\nNow we can compute $\\kappa^2$:\n$$ \\kappa^2 = \\frac{N}{D} = \\frac{3.09211 \\times 10^{-12} \\text{ C}^2\\cdot\\text{m}^{-3}}{2.86016 \\times 10^{-30} \\text{ C}^2\\cdot\\text{m}^{-1}} \\approx 1.081096 \\times 10^{18} \\text{ m}^{-2} $$\nThe inverse Debye length $\\kappa$ is the square root:\n$$ \\kappa = \\sqrt{1.081096 \\times 10^{18} \\text{ m}^{-2}} \\approx 1.039757 \\times 10^9 \\text{ m}^{-1} $$\nFinally, the Debye screening length $\\lambda_D$ is the reciprocal of $\\kappa$:\n$$ \\lambda_D = \\frac{1}{\\kappa} = \\frac{1}{1.039757 \\times 10^9 \\text{ m}^{-1}} \\approx 0.961763 \\times 10^{-9} \\text{ m} $$\nTo express this value in nanometers (nm), where $1$ nm $= 10^{-9}$ m:\n$$ \\lambda_D \\approx 0.961763 \\text{ nm} $$\nRounding to four significant figures as requested:\n$$ \\lambda_D \\approx 0.9618 \\text{ nm} $$", "answer": "$$\\boxed{0.9618}$$", "id": "3417826"}, {"introduction": "Computational science often involves a trade-off between accuracy and speed. In implicit solvent modeling, the Poisson-Boltzmann (PB) model is considered a rigorous benchmark, while the Generalized Born (GB) model offers a much faster but more approximate alternative. An expert practitioner must know the limitations of their chosen method. This practice challenges you to think critically about the underlying assumptions of the GB model, asking you to identify specific geometric and electrostatic scenarios where its approximations, such as isotropic screening, are expected to fail in comparison to the more detailed PB description [@problem_id:3417875].", "problem": "Consider implicit solvent electrostatics for a biomolecular solute with interior dielectric constant $\\epsilon_{\\mathrm{in}}$ embedded in water of dielectric constant $\\epsilon_{\\mathrm{out}}$. Mobile ions are excluded from the solute interior, and the system is in the linear-response regime so that the Linearized Poisson–Boltzmann (PB) description is applicable in the solvent. The electrostatic solvation free energy is defined via the reaction potential at the solute charges. The Generalized Born (GB) approximation replaces the exact reaction field by an expression parameterized by effective Born radii and a pairwise descreening kernel that assumes isotropic screening and pair-additivity.\n\nFour geometrical and electrostatic scenarios (A–D) are described below. In all scenarios, take $\\epsilon_{\\mathrm{in}}=4$, $\\epsilon_{\\mathrm{out}}=80$, and assume no specific ion binding. Where a Debye length is specified, mobile ions are only in the solvent region with inverse Debye length $\\kappa$ and $\\kappa=0$ in the solute interior.\n\nA. A single point charge of magnitude $+e$ is placed at the exact center of a perfectly spherical, solvent-excluded cavity of radius $R=10\\,\\text{\\AA}$ in water, at very low ionic strength ($\\kappa \\to 0$).\n\nB. A single point charge of magnitude $+e$ is placed at the bottom of a narrow, deep, solvent-excluded concave pocket on the solute surface. The pocket has depth $d=12\\,\\text{\\AA}$ and is connected to bulk solvent by a single neck of circular cross-section with radius $a=2\\,\\text{\\AA}$ and length $L=6\\,\\text{\\AA}$. The solvent has Debye length $\\kappa^{-1}=10\\,\\text{\\AA}$.\n\nC. Two point charges of magnitudes $+e$ and $-e$ lie on a gently convex solute surface region with principal radii of curvature much larger than the charge separation. Their center-to-center separation is $r=8\\,\\text{\\AA}$, and each charge center is at a distance $s=2.5\\,\\text{\\AA}$ from the dielectric boundary on the solvent side. The solvent has Debye length $\\kappa^{-1}=10\\,\\text{\\AA}$.\n\nD. A cluster of $N=4$ point charges, each of magnitude $+e$, occupies a narrow, solvent-excluded groove on the solute surface. The groove has width $w=4\\,\\text{\\AA}$, depth $d=15\\,\\text{\\AA}$, and meanders such that local Gaussian curvature is negative (concave) along most of its length. Nearest-neighbor charge separations are in the range $r=4$–$6\\,\\text{\\AA}$. The solvent Debye length is $\\kappa^{-1}=8\\,\\text{\\AA}$. Mobile ions are excluded from the groove interior (low dielectric region), but present in the bulk solvent.\n\nQuestion: Which scenarios are expected to exhibit systematically poorer performance of the Generalized Born approximation relative to the Poisson–Boltzmann model for the electrostatic solvation free energy, and why, based on the approximation structure of GB? Select all that apply.\n\nOptions:\n\nA. Scenario A\n\nB. Scenario B\n\nC. Scenario C\n\nD. Scenario D", "solution": "The central task is to identify scenarios where the Generalized Born (GB) model is expected to provide a poor approximation of the electrostatic solvation free energy compared to the Poisson–Boltzmann (PB) model. The PB model, which involves solving the (linearized) PB partial differential equation on a grid, explicitly accounts for the detailed three-dimensional shape of the solute-solvent dielectric boundary and the concomitant spatial distribution of mobile ions. It is considered a more accurate, albeit computationally more expensive, benchmark.\n\nThe GB model approximates the solvation free energy, $\\Delta G_{solv}$, by simplifying the complex physics captured by the PB equation. The primary approximations inherent to the GB formalism that lead to inaccuracies are:\n\n1.  **Isotropic Screening Assumption:** The GB model calculates the interaction energy between two charges, $q_i$ and $q_j$, by modifying their vacuum interaction with a descreening function that typically depends only on the distance $r_{ij}$ between them and their effective Born radii, $R_i$ and $R_j$. This implicitly assumes that the dielectric screening provided by the solvent is isotropic (uniform in all directions). The PB model, by contrast, correctly captures the highly anisotropic screening that arises when charges are located near complex, non-spherical boundaries, such as in pockets or grooves.\n2.  **Effective Born Radii:** The self-energy of each charge is calculated using an effective Born radius, $R_i$, which represents the degree of burial of the charge. The calculation of $R_i$ is itself an approximation (often involving a volume integral) of the solution to the electrostatic problem for a single charge, and its accuracy can degrade for charges in highly convoluted geometric environments.\n3.  **Pairwise Additivity and Many-Body Effects:** The total GB energy is a sum of self-energies and pairwise-screened interactions. This pairwise decomposition can fail to capture collective, many-body polarization effects, which become significant in dense clusters of charges where the dielectric response of the solvent is a complex function of the total electric field from all charges.\n4.  **Ion Accessibility:** GB models typically account for salt effects by multiplying the pairwise interaction term by a screening factor like $e^{-\\kappa r_{eff}}$, where $r_{eff}$ is some effective distance. This isotropic screening function does not adequately represent the physics in situations where ion access to a charged site is geometrically restricted (e.g., by a narrow channel), a phenomenon that the PB model handles naturally by defining an ion-exclusion layer that follows the molecular surface.\n\nWith these principles in mind, we evaluate each scenario.\n\n**A. Scenario A**\nA single point charge is at the center of a perfect sphere. In the limit of zero ionic strength ($\\kappa \\to 0$), the PB equation reduces to the Poisson equation. For this perfectly symmetric geometry, the reaction potential is analytically solvable and given by the classic Born formula. The GB model is designed to reproduce this exact result; the effective Born radius for a charge at the center of a sphere is simply the sphere's radius. This is the idealized case for which the GB model is constructed and should perform exceptionally well, matching the PB result almost exactly. Therefore, this scenario is not an example of poor GB performance.\n\n**B. Scenario B**\nA single point charge is at the bottom of a deep, narrow concave pocket. This geometry is highly anisotropic. The charge is shielded from the high-dielectric solvent in most directions by the low-dielectric solute material, but it is exposed to the solvent through a single, narrow channel. The electric field lines are focused through this channel, and the resulting reaction field is funneled back through the same channel. The GB model, with its fundamental assumption of isotropic screening, is incapable of capturing this focusing effect and will misestimate the solvation energy. Furthermore, the narrow neck severely restricts the access of mobile ions. The PB model correctly captures this by solving the LPBE with the ion-exclusion boundary, resulting in weak screening by ions deep in the pocket. A simple exponential screening function used in most GB models cannot account for such a complex, geometry-dependent ion screening effect. This is a classic failure case for GB models.\n\n**C. Scenario C**\nTwo charges are located on a gently convex surface, which locally approximates a plane. The geometry is relatively simple, and the screening environment, while not perfectly isotropic, does not exhibit the extreme anisotropy of a deep pocket. Mobile ions have unrestricted access to the region around the charges. The GB model's pairwise descreening function is generally well-parameterized for such common surface interactions. While the GB result will not be perfect, it is not expected to be systematically and severely erroneous as in the case of a deep concavity.\n\n**D. Scenario D**\nA cluster of four like-charges occupies a narrow, concave groove. This scenario combines multiple factors that are known to cause GB models to fail.\n1.  **Anisotropic Geometry:** As in Scenario B, the concave groove creates a highly anisotropic environment where GB's isotropic screening assumption fails.\n2.  **Restricted Ion Access:** Ions are excluded from the groove and can only screen the charges from its mouth, which is far from the charges at the bottom. PB correctly captures this attenuated screening, while GB's simplified salt model will overestimate the screening effect and underestimate the repulsive energy.\n3.  **Many-Body Effects:** In this dense cluster of charges, the total electrostatic potential influencing the solvent is a strong superposition of the fields from all charges. The GB model's pairwise additive formulation neglects non-additive, many-body polarization effects that are significant in such a high charge-density environment.\nThe combination of extreme geometric anisotropy, restricted ion access, and strong many-body effects makes this scenario exceptionally challenging for a GB model, and its performance is expected to be systematically poor.\n\nIn summary, scenarios B and D present geometric and electrostatic conditions (deep concavities, restricted ion access, high charge density) that fundamentally violate the core approximations of the Generalized Born model, leading to systematically poor agreement with the more physically rigorous Poisson-Boltzmann model.", "answer": "$$\\boxed{BD}$$", "id": "3417875"}, {"introduction": "The ultimate test of an approximate model is to benchmark it against a known, exact solution. This hands-on coding exercise moves from the qualitative analysis of model limitations to a direct quantitative comparison. You will analyze a physically important system—a charge near a planar dielectric interface, which mimics a protein approaching a cell membrane—by deriving and implementing the energy calculations for the exact Poisson-Boltzmann (PB) model, an approximate Generalized Born (GB) model, and the analytical solution. This practice will solidify your understanding by revealing precisely how and when the different models diverge, bridging the gap between abstract theory and practical computational assessment [@problem_id:3417850].", "problem": "A single point charge resides in the upper half-space filled with a uniform solvent and is located at a distance $d$ above a planar interface that separates the upper medium from a lower medium with a different dielectric response. In implicit solvent models used in molecular dynamics, two widely used approaches are Generalized Born (GB) and Poisson-Boltzmann (PB). The goal is to benchmark the GB approximation and the linearized Poisson-Boltzmann (LPB) model against the exact analytic solution for electrostatics in the presence of a planar dielectric interface, and to explore how the interfacial polarization free energy depends on the separation $d$ and the dielectric contrast between media.\n\nYour program must compute, for each test case, three interfacial polarization energies in Joules: \n1. The exact electrostatic interfacial energy in the limit of no ions (the Poisson limit).\n2. The exact interfacial energy from the linearized Poisson-Boltzmann model with a nonzero Debye screening parameter in the upper medium and no ions in the lower medium.\n3. A Generalized Born-inspired approximate interfacial energy for a single charge enclosed in a spherical Born cavity, which regularizes the short-distance divergence via a finite Born radius.\n\nThe derivation must start from the governing field equations and boundary conditions. The fundamental base is:\n- Maxwell's equations in the electrostatic limit, implying the Poisson equation $\\nabla \\cdot \\left( \\epsilon(\\mathbf{r}) \\nabla \\phi(\\mathbf{r}) \\right) = -\\rho(\\mathbf{r})$.\n- The linearized Poisson-Boltzmann equation in the upper medium, $\\nabla \\cdot \\left( \\epsilon_1 \\nabla \\phi(\\mathbf{r}) \\right) - \\epsilon_1 \\kappa^2 \\phi(\\mathbf{r}) = -\\rho(\\mathbf{r})$, with $\\kappa$ the inverse Debye length.\n- Standard boundary conditions at a dielectric interface: continuity of the electrostatic potential and continuity of the normal component of the electric displacement field.\n\nYou must derive the exact analytic interfacial energy for the Poisson limit (zero ionic strength), and the exact LPB interfacial energy for finite screening in the upper medium (with no screening in the lower medium), using a physically sound method appropriate for a planar interface. Then, define a Generalized Born-inspired approximate interfacial energy that treats the charge as residing inside a spherical Born cavity of radius $a$ in the upper medium and models the interface effect via an effective image-charge separation. The program must implement numerical quadrature where necessary and produce finite results consistent with physical expectations.\n\nPhysical and numerical units and constraints:\n- The elementary charge is $e = 1.602176634 \\times 10^{-19} \\ \\mathrm{C}$.\n- The vacuum permittivity is $\\epsilon_0 = 8.854187817 \\times 10^{-12} \\ \\mathrm{F/m}$.\n- Dielectric constants are given as relative values $\\epsilon_{r}$ and must be converted to absolute permittivities via $\\epsilon = \\epsilon_r \\epsilon_0$.\n- Distances $d$ and the Born radius $a$ must be in meters.\n- The inverse Debye length $\\kappa$ must be in $\\mathrm{m}^{-1}$.\n- All energies must be expressed in Joules, and the final numeric outputs must be floats.\n\nTest suite specification:\nCompute the three energies described above for each of the following test cases, using the given parameters. In all cases, the charge is $q = +1 \\times e$.\n\n- Case 1 (happy path, strong contrast, screened):\n  - Upper medium relative dielectric constant $\\epsilon_{r1} = 80$.\n  - Lower medium relative dielectric constant $\\epsilon_{r2} = 2$.\n  - Separation $d = 1.0 \\ \\mathrm{nm}$.\n  - Born radius $a = 0.25 \\ \\mathrm{nm}$.\n  - Inverse Debye length $\\kappa = 1.0 \\ \\mathrm{nm}^{-1}$.\n\n- Case 2 (boundary condition, no contrast, screened):\n  - Upper medium relative dielectric constant $\\epsilon_{r1} = 80$.\n  - Lower medium relative dielectric constant $\\epsilon_{r2} = 80$.\n  - Separation $d = 1.0 \\ \\mathrm{nm}$.\n  - Born radius $a = 0.25 \\ \\mathrm{nm}$.\n  - Inverse Debye length $\\kappa = 1.0 \\ \\mathrm{nm}^{-1}$.\n\n- Case 3 (edge case, near perfect conductor below, no screening):\n  - Upper medium relative dielectric constant $\\epsilon_{r1} = 80$.\n  - Lower medium relative dielectric constant $\\epsilon_{r2} = 10^{6}$.\n  - Separation $d = 0.5 \\ \\mathrm{nm}$.\n  - Born radius $a = 0.25 \\ \\mathrm{nm}$.\n  - Inverse Debye length $\\kappa = 0.0 \\ \\mathrm{nm}^{-1}$.\n\n- Case 4 (edge case, very small separation, strong contrast, screened):\n  - Upper medium relative dielectric constant $\\epsilon_{r1} = 80$.\n  - Lower medium relative dielectric constant $\\epsilon_{r2} = 2$.\n  - Separation $d = 0.1 \\ \\mathrm{nm}$.\n  - Born radius $a = 0.25 \\ \\mathrm{nm}$.\n  - Inverse Debye length $\\kappa = 1.0 \\ \\mathrm{nm}^{-1}$.\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated list of lists, where each inner list corresponds to one test case and contains three floats in Joules in the order $[U_{\\mathrm{Poisson}}, U_{\\mathrm{LPB}}, U_{\\mathrm{GB}}]$. For example, the printed output must look like:\n\"[[value_case1_Poisson,value_case1_LPB,value_case1_GB],[value_case2_Poisson,value_case2_LPB,value_case2_GB],...]\".", "solution": "The problem requires the calculation of the interfacial polarization free energy for a single point charge near a planar dielectric interface using three different models: the exact Poisson model (no salt), the exact linearized Poisson-Boltzmann (LPB) model (with salt), and an approximate Generalized Born (GB) model. We will first derive the analytical or semi-analytical expressions for the energy in each case from fundamental principles.\n\nLet the planar interface be the $z=0$ plane. The upper half-space ($z>0$) is medium $1$ with absolute permittivity $\\epsilon_1 = \\epsilon_{r1}\\epsilon_0$, and the lower half-space ($z<0$) is medium $2$ with absolute permittivity $\\epsilon_2 = \\epsilon_{r2}\\epsilon_0$. A point charge $q$ is located at coordinates $\\mathbf{r}_q = (0, 0, d)$ with $d>0$. The interfacial polarization energy is the work done against the electric field created by the induced surface charges at the interface, which is equivalent to half the product of the charge $q$ and the reaction potential at its location.\n\n**1. Exact Poisson Model ($U_{\\mathrm{Poisson}}$)**\n\nIn the absence of mobile ions ($\\kappa=0$), the electrostatic potential $\\phi(\\mathbf{r})$ is governed by the Poisson equation:\n$$\n\\nabla \\cdot (\\epsilon(\\mathbf{r}) \\nabla \\phi(\\mathbf{r})) = -\\rho(\\mathbf{r})\n$$\nwhere $\\rho(\\mathbf{r}) = q\\delta(x)\\delta(y)\\delta(z-d)$. This can be solved using the method of images.\nFor the upper half-space ($z>0$), the potential $\\phi_1(\\mathbf{r})$ is the superposition of the potential from the original charge $q$ at $(0, 0, d)$ and an image charge $q'$ at $(0, 0, -d)$:\n$$\n\\phi_1(x,y,z) = \\frac{1}{4\\pi\\epsilon_1} \\left( \\frac{q}{\\sqrt{x^2+y^2+(z-d)^2}} + \\frac{q'}{\\sqrt{x^2+y^2+(z+d)^2}} \\right)\n$$\nFor the lower half-space ($z<0$), the potential $\\phi_2(\\mathbf{r})$ is described as originating from an effective charge $q''$ located at the position of the original charge $(0,0,d)$:\n$$\n\\phi_2(x,y,z) = \\frac{1}{4\\pi\\epsilon_2} \\frac{q''}{\\sqrt{x^2+y^2+(z-d)^2}}\n$$\nApplying the boundary conditions at the interface $z=0$:\n1.  Continuity of potential, $\\phi_1(x,y,0) = \\phi_2(x,y,0)$:\n    $$\n    \\frac{1}{\\epsilon_1} (q+q') = \\frac{1}{\\epsilon_2} q''\n    $$\n2.  Continuity of the normal component of the electric displacement field, $\\epsilon_1 \\frac{\\partial \\phi_1}{\\partial z}\\Big|_{z=0} = \\epsilon_2 \\frac{\\partial \\phi_2}{\\partial z}\\Big|_{z=0}$:\n    $$\n    q-q' = q''\n    $$\nSolving this system of two linear equations for $q'$ yields:\n$$\nq' = q \\frac{\\epsilon_1 - \\epsilon_2}{\\epsilon_1 + \\epsilon_2}\n$$\nThe interfacial polarization energy is the interaction energy of the charge $q$ with its own reaction field, which is generated by the image charge $q'$. This energy is given by $U = \\frac{1}{2} q \\phi_{\\text{reaction}}(\\mathbf{r}_q)$. The reaction potential at the location of the charge $q$ is the potential created by $q'$ at a distance of $2d$:\n$$\n\\phi_{\\text{reaction}}(\\mathbf{r}_q) = \\frac{q'}{4\\pi\\epsilon_1(2d)}\n$$\nTherefore, the interfacial energy is:\n$$\nU_{\\mathrm{Poisson}} = \\frac{1}{2} q \\left( \\frac{q'}{4\\pi\\epsilon_1(2d)} \\right) = \\frac{q^2}{16\\pi\\epsilon_1 d} \\frac{\\epsilon_1 - \\epsilon_2}{\\epsilon_1 + \\epsilon_2}\n$$\nExpressed in terms of relative permittivities $\\epsilon_r$:\n$$\nU_{\\mathrm{Poisson}} = \\frac{q^2}{16\\pi\\epsilon_0\\epsilon_{r1} d} \\frac{\\epsilon_{r1} - \\epsilon_{r2}}{\\epsilon_{r1} + \\epsilon_{r2}}\n$$\n\n**2. Exact Linearized Poisson-Boltzmann Model ($U_{\\mathrm{LPB}}$)**\n\nWhen mobile ions are present in the upper medium, the potential is governed by the LPB equation. We assume no ions in the lower medium.\nFor $z>0$: $\\nabla^2 \\phi_1 - \\kappa^2 \\phi_1 = -\\frac{q}{\\epsilon_1} \\delta(\\mathbf{r} - \\mathbf{r}_q)$.\nFor $z<0$: $\\nabla^2 \\phi_2 = 0$.\n\nThis problem is solved using a Hankel (or Fourier-Bessel) transform with respect to the cylindrical coordinate $\\rho=\\sqrt{x^2+y^2}$. The transformed potential $\\tilde{\\phi}(k, z) = \\int_0^\\infty \\phi(\\rho, z) J_0(k\\rho) \\rho d\\rho$. The transformed equations become ordinary differential equations in $z$:\n$$\n\\left(\\frac{d^2}{dz^2} - (k^2+\\kappa^2)\\right) \\tilde{\\phi}_1(k,z) = -\\frac{q}{2\\pi\\epsilon_1} \\delta(z-d)\n$$\n$$\n\\left(\\frac{d^2}{dz^2} - k^2\\right) \\tilde{\\phi}_2(k,z) = 0\n$$\nThe solution for $\\tilde{\\phi}_1(k,z)$ is composed of the source term (a Yukawa-like potential) and a homogeneous term representing the reaction field from the interface. Solving for the unknown coefficients using the boundary conditions (continuity of $\\tilde{\\phi}$ and $\\epsilon \\frac{d\\tilde{\\phi}}{dz}$ at $z=0$), we can find the reaction component of the potential. The inverse Hankel transform of this reaction potential, evaluated at the charge's location $(\\rho=0, z=d)$, gives the total reaction potential $\\phi_{\\text{reaction}}(\\mathbf{r}_q)$.\n\nThe resulting expression for the interfacial energy $U_{\\mathrm{LPB}} = \\frac{1}{2} q \\phi_{\\text{reaction}}(\\mathbf{r}_q)$ is given by the integral:\n$$\nU_{\\mathrm{LPB}} = \\frac{q^2}{8\\pi \\epsilon_1} \\int_0^\\infty \\frac{k e^{-2d\\sqrt{k^2+\\kappa^2}}}{\\sqrt{k^2+\\kappa^2}} \\left( \\frac{\\epsilon_1\\sqrt{k^2+\\kappa^2} - \\epsilon_2 k}{\\epsilon_1\\sqrt{k^2+\\kappa^2} + \\epsilon_2 k} \\right) dk\n$$\nThis integral must be evaluated numerically. In terms of relative permittivities:\n$$\nU_{\\mathrm{LPB}} = \\frac{q^2}{8\\pi \\epsilon_0 \\epsilon_{r1}} \\int_0^\\infty \\frac{k e^{-2d\\sqrt{k^2+\\kappa^2}}}{\\sqrt{k^2+\\kappa^2}} \\left( \\frac{\\epsilon_{r1}\\sqrt{k^2+\\kappa^2} - \\epsilon_{r2} k}{\\epsilon_{r1}\\sqrt{k^2+\\kappa^2} + \\epsilon_{r2} k} \\right) dk\n$$\nIn the limit $\\kappa \\to 0$, this integral correctly reduces to the Poisson expression $U_{\\mathrm{Poisson}}$.\n\n**3. Generalized Born (GB) Inspired Model ($U_{\\mathrm{GB}}$)**\n\nThe GB model is an approximation that avoids the explicit calculation of electrostatic fields. The problem statement specifies that the model should use a spherical Born cavity of radius $a$ to regularize the short-distance divergence inherent in the point-charge image formula. A common and physically motivated approach is to modify the interaction distance between the real charge and its image. The interaction is modeled not between two point charges, but in a way that reflects the finite size of the ion, embodied by the Born radius $a$.\n\nThe interfacial polarization energy is based on the image charge formula, but the distance in the denominator of the reaction potential, $2d$, is regularized.\n$$\nU_{\\mathrm{GB}} = \\frac{1}{2} q \\phi_{\\text{reaction, GB}}(\\mathbf{r}_q) = \\frac{1}{2} q \\left( \\frac{q'}{4\\pi\\epsilon_1 \\sqrt{(2d)^2 + a^2}} \\right)\n$$\nSubstituting $q' = q (\\epsilon_1-\\epsilon_2)/(\\epsilon_1+\\epsilon_2)$ and simplifying:\n$$\nU_{\\mathrm{GB}} = \\frac{q^2}{8\\pi\\epsilon_1 \\sqrt{4d^2+a^2}} \\frac{\\epsilon_1 - \\epsilon_2}{\\epsilon_1 + \\epsilon_2}\n$$\nIn the limit of large distance ($d \\gg a$), this correctly approaches the Poisson energy:\n$U_{\\mathrm{GB}} \\to \\frac{q^2}{8\\pi\\epsilon_1 (2d)} \\frac{\\epsilon_1 - \\epsilon_2}{\\epsilon_1 + \\epsilon_2} = \\frac{q^2}{16\\pi\\epsilon_1 d} \\frac{\\epsilon_1 - \\epsilon_2}{\\epsilon_1 + \\epsilon_2} = U_{\\mathrm{Poisson}}$.\n\nIn terms of relative permittivities:\n$$\nU_{\\mathrm{GB}} = \\frac{q^2}{8\\pi\\epsilon_0\\epsilon_{r1} \\sqrt{4d^2+a^2}} \\frac{\\epsilon_{r1} - \\epsilon_{r2}}{\\epsilon_{r1} + \\epsilon_{r2}}\n$$\nThis expression avoids the divergence at $d=0$ and correctly reduces to the point-charge Poisson energy $U_{\\mathrm{Poisson}}$ for large separations. The numerical implementation will use these three derived formulae with the constants and parameters provided, ensuring all units are converted to the base SI system (meters, Coulombs, etc.).", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nimport scipy.integrate\nfrom typing import List, Tuple\n\n# Define physical constants in SI units.\nE_CHARGE = 1.602176634e-19  # Elementary charge in C\nEPSILON_0 = 8.854187817e-12 # Vacuum permittivity in F/m\n\ndef calculate_U_poisson(q: float, eps_r1: float, eps_r2: float, d: float) -> float:\n    \"\"\"\n    Calculates the exact electrostatic interfacial energy (Poisson limit).\n    \n    Args:\n        q: Charge in Coulombs.\n        eps_r1: Relative dielectric constant of the upper medium.\n        eps_r2: Relative dielectric constant of the lower medium.\n        d: Separation distance from the interface in meters.\n        \n    Returns:\n        Interfacial energy in Joules.\n    \"\"\"\n    if eps_r1 == eps_r2:\n        return 0.0\n    if d <= 0:\n        # Avoid division by zero and handle non-physical input\n        return np.inf if (eps_r1 > eps_r2) else -np.inf\n\n    K = (eps_r1 - eps_r2) / (eps_r1 + eps_r2)\n    eps1 = eps_r1 * EPSILON_0\n    \n    energy = (q**2 * K) / (16 * np.pi * eps1 * d)\n    return energy\n\ndef calculate_U_gb(q: float, eps_r1: float, eps_r2: float, d: float, a: float) -> float:\n    \"\"\"\n    Calculates the Generalized Born-inspired approximate interfacial energy.\n    \n    Args:\n        q: Charge in Coulombs.\n        eps_r1: Relative dielectric constant of the upper medium.\n        eps_r2: Relative dielectric constant of the lower medium.\n        d: Separation distance from the interface in meters.\n        a: Born radius in meters.\n        \n    Returns:\n        Interfacial energy in Joules.\n    \"\"\"\n    if eps_r1 == eps_r2:\n        return 0.0\n\n    K = (eps_r1 - eps_r2) / (eps_r1 + eps_r2)\n    eps1 = eps_r1 * EPSILON_0\n    \n    effective_dist = np.sqrt(4 * d**2 + a**2)\n    \n    energy = (q**2 * K) / (8 * np.pi * eps1 * effective_dist)\n    return energy\n\ndef calculate_U_lpb(q: float, eps_r1: float, eps_r2: float, d: float, kappa: float) -> float:\n    \"\"\"\n    Calculates the exact interfacial energy from the linearized Poisson-Boltzmann model.\n    \n    Args:\n        q: Charge in Coulombs.\n        eps_r1: Relative dielectric constant of the upper medium.\n        eps_r2: Relative dielectric constant of the lower medium.\n        d: Separation distance from the interface in meters.\n        kappa: Inverse Debye length in m^-1.\n        \n    Returns:\n        Interfacial energy in Joules.\n    \"\"\"\n    if eps_r1 == eps_r2:\n        return 0.0\n    if kappa == 0.0:\n        return calculate_U_poisson(q, eps_r1, eps_r2, d)\n\n    eps1 = eps_r1 * EPSILON_0\n    prefactor = q**2 / (8 * np.pi * eps1)\n\n    # Define the integrand for the LPB energy calculation\n    def integrand(k, er1, er2, dist_d, kap_k):\n        # We integrate over k from 0 to infinity\n        if k < 0:\n            return 0.0\n        \n        # Avoid numerical issues at k=0, where the limit is 0\n        if k == 0:\n            return 0.0\n            \n        sqrt_term = np.sqrt(k**2 + kap_k**2)\n        \n        num = er1 * sqrt_term - er2 * k\n        den = er1 * sqrt_term + er2 * k\n        \n        # Check for division by zero, although unlikely with physical parameters\n        if den == 0.0:\n            return 0.0\n        \n        ratio = num / den\n        \n        return (k / sqrt_term) * np.exp(-2 * dist_d * sqrt_term) * ratio\n    \n    integral_val, _ = scipy.integrate.quad(\n        integrand, 0, np.inf, args=(eps_r1, eps_r2, d, kappa)\n    )\n    \n    return prefactor * integral_val\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print results.\n    \"\"\"\n    # Test cases in the format: (eps_r1, eps_r2, d_nm, a_nm, kappa_nm^-1)\n    test_cases = [\n        # Case 1 (happy path, strong contrast, screened)\n        (80.0, 2.0, 1.0, 0.25, 1.0),\n        # Case 2 (boundary condition, no contrast, screened)\n        (80.0, 80.0, 1.0, 0.25, 1.0),\n        # Case 3 (edge case, near perfect conductor below, no screening)\n        (80.0, 1e6, 0.5, 0.25, 0.0),\n        # Case 4 (edge case, very small separation, strong contrast, screened)\n        (80.0, 2.0, 0.1, 0.25, 1.0),\n    ]\n\n    results = []\n    q_val = 1 * E_CHARGE\n    \n    for case in test_cases:\n        eps_r1, eps_r2, d_nm, a_nm, kappa_nm_inv = case\n        \n        # Convert all units to base SI\n        d_m = d_nm * 1e-9\n        a_m = a_nm * 1e-9\n        kappa_m_inv = kappa_nm_inv * 1e9\n\n        # Calculate the three energy values for the current test case\n        u_poisson = calculate_U_poisson(q_val, eps_r1, eps_r2, d_m)\n        u_lpb = calculate_U_lpb(q_val, eps_r1, eps_r2, d_m, kappa_m_inv)\n        u_gb = calculate_U_gb(q_val, eps_r1, eps_r2, d_m, a_m)\n        \n        results.append([u_poisson, u_lpb, u_gb])\n\n    # Format the final output as a single-line string representation of a list of lists.\n    # e.g., \"[[val1,val2,val3],[val4,val5,val6]]\"\n    output_str = \"[\" + \",\".join([f\"[{e1},{e2},{e3}]\" for e1, e2, e3 in results]) + \"]\"\n    print(output_str)\n\nsolve()\n```", "id": "3417850"}]}