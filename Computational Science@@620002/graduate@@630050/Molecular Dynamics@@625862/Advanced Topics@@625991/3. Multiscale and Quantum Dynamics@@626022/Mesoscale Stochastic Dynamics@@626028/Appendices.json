{"hands_on_practices": [{"introduction": "This problem explores the intrinsic physical properties of the Dissipative Particle Dynamics (DPD) fluid itself. Because DPD uses soft, finite-range potentials, the resulting fluid is artificially compressible, a crucial feature to understand when modeling nearly incompressible liquids like water. This exercise [@problem_id:3424746] guides you through a first-principles derivation of the DPD equation of state, connecting it to macroscopic properties like the speed of sound and the magnitude of density fluctuations, which are key indicators of the model's physical realism.", "problem": "Consider an isothermal fluid simulated with Dissipative Particle Dynamics (DPD). DPD uses pairwise conservative forces of finite range and softness to mimic mesoscale behavior. In reduced DPD units, take the particle mass to be $m=1$ and assume a homogeneous fluid of average number density $\\rho$ confined in a subvolume $V$ of a much larger reservoir, such that number density fluctuations in $V$ are governed by equilibrium statistical mechanics. The conservative force has finite cutoff $r_c$ and amplitude $a$. The fluid experiences small uniform flow of speed $u$ relative to the thermal scale.\n\nYour task is to derive, from first-principles definitions and well-tested relations, a complete algorithm to compute the following for each given parameter set $(\\rho, a, k_B T, r_c, V, u)$ in reduced DPD units:\n1. The variance of the density fluctuations $\\langle \\delta \\rho^2 \\rangle$ in the subvolume $V$ at fixed temperature.\n2. The isothermal speed of sound $c_s$ of the fluid.\n3. The Mach number $\\mathrm{Ma}$ of the flow, defined as the ratio of the flow speed to the speed of sound.\n\nBegin from the following fundamental bases:\n- The grand canonical relation between number fluctuations, the static structure factor at zero wave number, and the isothermal compressibility.\n- The thermodynamic definition of isothermal compressibility and its connection to the slope of the equation of state.\n- The hydrodynamic definition of the isothermal sound speed in terms of the pressure-density derivative.\n- The definition of Mach number.\n\nAssume the standard DPD conservative force has linear radial weight with cutoff $r_c$, and approximate the equation of state by integrating the virial of the pairwise conservative force over an uncorrelated particle distribution. Use this to connect the softness parameter and cutoff to the density dependence of pressure. Then, use that to connect compressibility to density fluctuations, and finally to the speed of sound and Mach number under isothermal conditions.\n\nImplement your derivation as a program that, for each test case below, computes:\n- The density fluctuation variance $\\langle \\delta \\rho^2 \\rangle$.\n- The isothermal speed of sound $c_s$.\n- The Mach number $\\mathrm{Ma}$.\n\nAll quantities must be expressed in reduced DPD units. Angles are not involved. The final output must be a single line that aggregates the results for all test cases as a comma-separated list enclosed in square brackets, containing the sequence of floats ordered by test case, with each test case contributing three floats in the order $\\langle \\delta \\rho^2 \\rangle$, $c_s$, $\\mathrm{Ma}$.\n\nUse the following test suite to ensure coverage of typical behavior, limits, and edge cases:\n- Case 1 (typical DPD): $(\\rho, a, k_B T, r_c, V, u) = (3.0, 25.0, 1.0, 1.0, 100.0, 0.1)$.\n- Case 2 (ideal-gas limit for softness): $(\\rho, a, k_B T, r_c, V, u) = (3.0, 0.0, 1.0, 1.0, 100.0, 0.1)$.\n- Case 3 (finite-size amplification): $(\\rho, a, k_B T, r_c, V, u) = (3.0, 25.0, 1.0, 1.0, 10.0, 0.1)$.\n- Case 4 (softer conservative repulsion): $(\\rho, a, k_B T, r_c, V, u) = (3.0, 5.0, 1.0, 1.0, 100.0, 0.1)$.\n- Case 5 (longer interaction range): $(\\rho, a, k_B T, r_c, V, u) = (3.0, 25.0, 1.0, 1.5, 100.0, 0.1)$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[\\text{result1},\\text{result2},\\text{result3}]$), ordered as $[\\langle \\delta \\rho^2 \\rangle_1, c_{s,1}, \\mathrm{Ma}_1, \\langle \\delta \\rho^2 \\rangle_2, c_{s,2}, \\mathrm{Ma}_2, \\dots]$ for Cases $1$ through $5$ in sequence.", "solution": "The problem statement has been rigorously validated and is determined to be scientifically grounded, well-posed, and objective. It presents a clear, formalizable task based on established principles of statistical mechanics and fluid dynamics as applied to the Dissipative Particle Dynamics (DPD) model. The provided parameters and approximations are standard within the field. Therefore, a complete solution is warranted.\n\nThe derivation proceeds in a step-by-step manner, beginning from the fundamental definitions provided in the problem statement. All quantities are expressed in reduced DPD units, with particle mass $m=1$.\n\n**1. Equation of State for a DPD Fluid**\n\nThe pressure $P$ of a fluid composed of particles interacting via pairwise forces is given by the virial equation of state. In $d=3$ dimensions, this is:\n$$ P = \\rho k_B T + \\frac{1}{3V} \\left\\langle \\sum_{i<j} \\mathbf{r}_{ij} \\cdot \\mathbf{F}_{ij}^C \\right\\rangle $$\nwhere $\\rho = N/V$ is the number density, $k_B T$ is the thermal energy, $V$ is the volume, $\\mathbf{r}_{ij}$ is the vector from particle $j$ to particle $i$, and $\\mathbf{F}_{ij}^C$ is the conservative force between them. The first term, $\\rho k_B T$, is the ideal gas contribution, and the second term is the excess pressure $P_{\\text{ex}}$ arising from interactions.\n\nThe problem specifies the standard DPD conservative force:\n$$ \\mathbf{F}_{ij}^C = a \\left(1 - \\frac{r_{ij}}{r_c}\\right) \\hat{\\mathbf{r}}_{ij} \\quad \\text{for } r_{ij} < r_c $$\nand $\\mathbf{F}_{ij}^C = \\mathbf{0}$ for $r_{ij} \\ge r_c$. Here, $a$ is the repulsion amplitude, $r_{ij} = |\\mathbf{r}_{ij}|$ is the inter-particle distance, and $r_c$ is the cutoff radius.\n\nThe excess pressure term can be expressed as an integral involving the pair correlation function $g(r)$:\n$$ P_{\\text{ex}} = \\frac{1}{6V} \\frac{N(N-1)}{1} \\int (\\mathbf{r} \\cdot \\mathbf{F}^C(\\mathbf{r})) g(r) \\, d^3\\mathbf{r} \\approx \\frac{\\rho^2}{6} \\int_0^\\infty (\\mathbf{r} \\cdot \\mathbf{F}^C(\\mathbf{r})) g(r) 4\\pi r^2 \\, dr $$\nThe problem instructs to use the mean-field approximation of an uncorrelated particle distribution, which sets $g(r)=1$. The dot product is $\\mathbf{r} \\cdot \\mathbf{F}^C(\\mathbf{r}) = r \\cdot a(1 - r/r_c) = a(r-r^2/r_c)$. Integrating over the interaction range gives:\n$$ P_{\\text{ex}} = \\frac{4\\pi a \\rho^2}{6} \\int_0^{r_c} \\left(r - \\frac{r^2}{r_c}\\right) r^2 \\, dr = \\frac{2\\pi a \\rho^2}{3} \\int_0^{r_c} \\left(r^3 - \\frac{r^4}{r_c}\\right) \\, dr $$\n$$ P_{\\text{ex}} = \\frac{2\\pi a \\rho^2}{3} \\left[ \\frac{r^4}{4} - \\frac{r^5}{5r_c} \\right]_0^{r_c} = \\frac{2\\pi a \\rho^2}{3} \\left( \\frac{r_c^4}{4} - \\frac{r_c^4}{5} \\right) = \\frac{2\\pi a \\rho^2 r_c^4}{60} = \\frac{\\pi a r_c^4}{30} \\rho^2 $$\nThis defines a quadratic dependence on density. Let us define the interaction parameter $\\alpha = \\frac{\\pi a r_c^4}{30}$. The full equation of state (EOS) is then:\n$$ P(\\rho, T) = \\rho k_B T + \\alpha \\rho^2 $$\n\n**2. Isothermal Speed of Sound**\n\nThe isothermal speed of sound, $c_s$, is related to the derivative of pressure with respect to density at constant temperature. Its hydrodynamic definition is given by $c_s^2 = \\frac{1}{m} \\left( \\frac{\\partial P}{\\partial \\rho} \\right)_T$. The particle mass is given as $m=1$.\n\nFirst, we compute the derivative of our EOS:\n$$ \\left( \\frac{\\partial P}{\\partial \\rho} \\right)_T = \\frac{\\partial}{\\partial \\rho} \\left( \\rho k_B T + \\alpha \\rho^2 \\right)_T = k_B T + 2\\alpha\\rho $$\nSubstituting this into the definition for $c_s^2$ with $m=1$:\n$$ c_s^2 = k_B T + 2\\alpha\\rho = k_B T + 2 \\left( \\frac{\\pi a r_c^4}{30} \\right) \\rho = k_B T + \\frac{\\pi a r_c^4}{15} \\rho $$\nTherefore, the isothermal speed of sound is:\n$$ c_s = \\sqrt{k_B T + \\frac{\\pi a r_c^4}{15} \\rho} $$\n\n**3. Variance of Density Fluctuations**\n\nThe problem requires using the grand canonical ensemble relation between number fluctuations $\\langle (\\delta N)^2 \\rangle$ and isothermal compressibility $\\kappa_T$. This relation is:\n$$ \\frac{\\langle (\\delta N)^2 \\rangle}{\\langle N \\rangle} = \\rho k_B T \\kappa_T $$\nwhere $\\langle N \\rangle = \\rho V$. The isothermal compressibility is defined thermodynamically as $\\kappa_T = \\frac{1}{\\rho} \\left( \\frac{\\partial \\rho}{\\partial P} \\right)_T = \\frac{1}{\\rho (\\partial P/\\partial \\rho)_T}$.\n\nSubstituting the definition of $\\kappa_T$ into the fluctuation formula gives:\n$$ \\langle (\\delta N)^2 \\rangle = \\langle N \\rangle \\rho k_B T \\left( \\frac{1}{\\rho (\\partial P/\\partial \\rho)_T} \\right) = \\frac{\\langle N \\rangle k_B T}{(\\partial P/\\partial \\rho)_T} = \\frac{\\rho V k_B T}{(\\partial P/\\partial \\rho)_T} $$\nWe are interested in the variance of the density, $\\langle (\\delta \\rho)^2 \\rangle$. The density fluctuation $\\delta \\rho$ is related to the number fluctuation $\\delta N$ by $\\delta \\rho = \\delta N / V$. Thus, their variances are related by $\\langle (\\delta \\rho)^2 \\rangle = \\langle (\\delta N)^2 \\rangle / V^2$.\n$$ \\langle \\delta \\rho^2 \\rangle = \\frac{1}{V^2} \\left( \\frac{\\rho V k_B T}{(\\partial P/\\partial \\rho)_T} \\right) = \\frac{\\rho k_B T}{V (\\partial P/\\partial \\rho)_T} $$\nUsing our previously derived expression for $(\\partial P/\\partial \\rho)_T$:\n$$ \\langle \\delta \\rho^2 \\rangle = \\frac{\\rho k_B T}{V \\left( k_B T + 2\\alpha\\rho \\right)} = \\frac{\\rho k_B T}{V \\left( k_B T + \\frac{\\pi a r_c^4}{15} \\rho \\right)} $$\n\n**4. Mach Number**\n\nThe Mach number, $\\mathrm{Ma}$, is defined as the ratio of the flow speed $u$ to the speed of sound $c_s$.\n$$ \\mathrm{Ma} = \\frac{u}{c_s} $$\nUsing our result for $c_s$:\n$$ \\mathrm{Ma} = \\frac{u}{\\sqrt{k_B T + \\frac{\\pi a r_c^4}{15} \\rho}} $$\n\n**5. Summary of the Algorithm**\n\nFor each given parameter set $(\\rho, a, k_B T, r_c, V, u)$ and with $m=1$:\n1.  Calculate a common intermediate term related to the fluid's stiffness:\n    $$ S = k_B T + \\frac{\\pi a r_c^4}{15} \\rho $$\n2.  Compute the variance of density fluctuations:\n    $$ \\langle \\delta \\rho^2 \\rangle = \\frac{\\rho k_B T}{V S} $$\n3.  Compute the isothermal speed of sound:\n    $$ c_s = \\sqrt{S} $$\n4.  Compute the Mach number:\n    $$ \\mathrm{Ma} = \\frac{u}{c_s} $$\n\nThis algorithm provides a complete procedure to compute the required quantities based on the specified first principles and approximations.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes density fluctuation variance, isothermal speed of sound, and Mach number\n    for a DPD fluid based on a mean-field equation of state.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (rho, a, kT, rc, V, u)\n    test_cases = [\n        # Case 1 (typical DPD)\n        (3.0, 25.0, 1.0, 1.0, 100.0, 0.1),\n        # Case 2 (ideal-gas limit for softness)\n        (3.0, 0.0, 1.0, 1.0, 100.0, 0.1),\n        # Case 3 (finite-size amplification)\n        (3.0, 25.0, 1.0, 1.0, 10.0, 0.1),\n        # Case 4 (softer conservative repulsion)\n        (3.0, 5.0, 1.0, 1.0, 100.0, 0.1),\n        # Case 5 (longer interaction range)\n        (3.0, 25.0, 1.0, 1.5, 100.0, 0.1),\n    ]\n\n    results = []\n    \n    # Constants\n    m = 1.0  # Particle mass in reduced units\n\n    for case in test_cases:\n        rho, a, kT, rc, V, u = case\n\n        # The term (dP/d(rho))_T is central to all calculations.\n        # From the derivation, (dP/d(rho))_T = kT + 2*alpha*rho,\n        # where alpha = (pi * a * rc^4) / 30.\n        # So, (dP/d(rho))_T = kT + (pi * a * rc^4 / 15) * rho.\n        dp_drho = kT + (np.pi * a * rc**4 / 15.0) * rho\n\n        # 1. Variance of density fluctuations: <delta rho^2>\n        # <delta rho^2> = (rho * kT) / (V * (dP/d(rho))_T)\n        if V = 0 or dp_drho = 0:\n            # Avoid division by zero or physically meaningless results\n            delta_rho_sq = float('nan')\n        else:\n            delta_rho_sq = (rho * kT) / (V * dp_drho)\n\n        # 2. Isothermal speed of sound: c_s\n        # c_s^2 = (1/m) * (dP/d(rho))_T\n        if dp_drho  0:\n             # Unstable fluid, imaginary sound speed\n             cs = float('nan')\n        else:\n             cs = np.sqrt(dp_drho / m)\n\n        # 3. Mach number: Ma\n        # Ma = u / c_s\n        if cs = 0: # Includes cs being nan or zero\n            Ma = float('inf') if u > 0 else 0.0\n        else:\n            Ma = u / cs\n\n        results.extend([delta_rho_sq, cs, Ma])\n\n    # Format the final output as a comma-separated list of floats.\n    # The problem asks for the single-line format specified.\n    print(f\"[{','.join(f'{r:.8g}' for r in results)}]\")\n\nsolve()\n```", "id": "3424746"}, {"introduction": "A simulation is only as useful as its connection to the real world. This practice [@problem_id:3424787] provides a vital hands-on experience in bridging the gap between the dimensionless units of a DPD simulation and the physical units of an experimental system. By systematically applying dimensional analysis, you will learn how to map simulation parameters to a specific microfluidic setup, ensuring that essential dimensionless quantities like the Schmidt and Péclet numbers are correctly reproduced, thereby guaranteeing the physical relevance of your mesoscale model.", "problem": "A Dissipative Particle Dynamics (DPD) fluid is to be used as a mesoscale model for a Newtonian microfluidic flow. You will construct the mapping from DPD units to physical units by choosing the characteristic length, energy, and mass scales and then enforce dimensionless transport constraints. The DPD model uses a cutoff length equal to the DPD length unit, so the characteristic length is $l_0 = r_c$. The energy unit is chosen as the thermal energy at temperature $T$, so $e_0 = k_B T$. The characteristic mass $m_0$ is to be determined.\n\nA pre-calibrated DPD fluid at number density consistent with standard practice yields dimensionless kinematic viscosity $\\nu^{*}$ and tracer self-diffusivity $D^{*}$ (both measured in DPD units) under the intended operating conditions. The following measured dimensionless properties and geometric choices will be used:\n- $ \\nu^{*} = 0.75 $,\n- $ D^{*} = 0.05 $,\n- Channel height in the simulation is $ L^{*} = 20 $ (in units of $r_c$).\n\nYou will model a straight microchannel of physical height $ L_{\\text{phys}} = 100 \\ \\mathrm{\\mu m} $. The flow operates at temperature $ T = 300 \\ \\mathrm{K} $. The target physical kinematic viscosity is taken to be water-like, $ \\nu_{\\text{phys}} = 1.0 \\times 10^{-6} \\ \\mathrm{m^2/s} $. The target Péclet number for a passive scalar advected by the DPD fluid is $ \\text{Pe}_{\\text{target}} = 500 $. Assume that the average dimensionless flow speed $ U^{*} $ can be controlled by adjusting an imposed body force or pressure gradient in the DPD simulation.\n\nConstants: use Boltzmann’s constant $ k_B = 1.380649 \\times 10^{-23} \\ \\mathrm{J/K} $.\n\nStarting only from dimensional analysis of the base choices $l_0$, $e_0$, $m_0$ and the definitions of the Schmidt number and the Péclet number,\n- $ \\text{Sc} = \\nu / D $,\n- $ \\text{Pe} = U L / D $,\ndo the following:\n\n1) Derive the time unit $ t_0 $ implied by $ l_0 $, $ e_0 $, and $ m_0 $. Then express the physical kinematic viscosity $ \\nu_{\\text{phys}} $ and diffusivity $ D_{\\text{phys}} $ in terms of their DPD counterparts $ \\nu^{*} $, $ D^{*} $, and the base units $ l_0 $, $ e_0 $, $ m_0 $.\n\n2) Using your relations, show which combinations of $ \\{ \\nu^{*}, D^{*}, U^{*}, L^{*} \\} $ and $ \\{ l_0, e_0, m_0 \\} $ determine the Schmidt number and the Péclet number, and deduce the constraint required on $ U^{*} $ to realize $ \\text{Pe}_{\\text{target}} $ for the given $ D^{*} $ and $ L^{*} $.\n\n3) With $ L^{*} = 20 $ and $ L_{\\text{phys}} = 100 \\ \\mathrm{\\mu m} $, set $ l_0 $ by geometric similarity. Using $ e_0 = k_B T $ at $ T = 300 \\ \\mathrm{K} $ and the target $ \\nu_{\\text{phys}} = 1.0 \\times 10^{-6} \\ \\mathrm{m^2/s} $, compute the required mass unit $ m_0 $ (the DPD particle mass) in kilograms.\n\n4) Compute the required dimensionless mean speed $ U^{*} $ that achieves $ \\text{Pe}_{\\text{target}} = 500 $ for the given $ D^{*} $ and $ L^{*} $.\n\nAlso verify that the resulting Schmidt number is within a realistic mesoscale range by checking whether $ \\text{Sc} \\ge 10 $.\n\nProvide your final numerical results for $ m_0 $ and $ U^{*} $ rounded to four significant figures. Express $ m_0 $ in kilograms and $ U^{*} $ as a dimensionless number. Do not include any other quantities in your final answer.", "solution": "The problem is validated as scientifically grounded, well-posed, and objective. It presents a standard task in computational mesoscale physics: mapping simulation units to physical units. All provided data are consistent and sufficient for a unique solution.\n\nThe solution proceeds in four parts as requested.\n\n**1) Derivation of Time Unit and Scaling Relations**\n\nThe fundamental units are chosen for length ($l_0$), mass ($m_0$), and energy ($e_0$). The dimensions of energy are $[E] = [M][L]^2[T]^{-2}$, where $[M]$, $[L]$, and $[T]$ represent the dimensions of mass, length, and time, respectively. In terms of our base units, this relationship is:\n$$e_0 \\sim m_0 l_0^2 t_0^{-2}$$\nwhere $t_0$ is the characteristic time unit. We can solve for $t_0$:\n$$t_0^2 = \\frac{m_0 l_0^2}{e_0} \\implies t_0 = l_0 \\sqrt{\\frac{m_0}{e_0}}$$\nThe problem specifies that the energy unit is the thermal energy, $e_0 = k_B T$. Substituting this gives:\n$$t_0 = l_0 \\sqrt{\\frac{m_0}{k_B T}}$$\nNow we express the physical transport properties in terms of their dimensionless counterparts and the base units. Kinematic viscosity $\\nu$ and diffusivity $D$ both have dimensions of $[L]^2[T]^{-1}$. Therefore, the conversion from a dimensionless quantity (denoted with a superscript $*$) in DPD units to a physical quantity is given by multiplying by the characteristic unit for that quantity.\nThe characteristic unit for kinematic viscosity and diffusivity is $\\frac{l_0^2}{t_0}$.\n$$ \\nu_{\\text{phys}} = \\nu^{*} \\frac{l_0^2}{t_0} \\quad \\text{and} \\quad D_{\\text{phys}} = D^{*} \\frac{l_0^2}{t_0} $$\nSubstituting the derived expression for $t_0$:\n$$ \\frac{l_0^2}{t_0} = \\frac{l_0^2}{l_0 \\sqrt{\\frac{m_0}{e_0}}} = l_0 \\sqrt{\\frac{e_0}{m_0}} $$\nThus, the scaling relations are:\n$$ \\nu_{\\text{phys}} = \\nu^{*} l_0 \\sqrt{\\frac{e_0}{m_0}} $$\n$$ D_{\\text{phys}} = D^{*} l_0 \\sqrt{\\frac{e_0}{m_0}} $$\n\n**2) Schmidt and Péclet Number Analysis**\n\nThe Schmidt number, $\\text{Sc}$, is defined as the ratio of kinematic viscosity to diffusivity:\n$$ \\text{Sc} = \\frac{\\nu_{\\text{phys}}}{D_{\\text{phys}}} $$\nUsing the expressions derived above:\n$$ \\text{Sc} = \\frac{\\nu^{*} l_0 \\sqrt{\\frac{e_0}{m_0}}}{D^{*} l_0 \\sqrt{\\frac{e_0}{m_0}}} = \\frac{\\nu^{*}}{D^{*}} $$\nThis demonstrates that the Schmidt number is an invariant quantity under this scaling transformation. It is determined solely by the dimensionless properties $\\nu^{*}$ and $D^{*}$ obtained from the DPD simulation.\n\nThe Péclet number, $\\text{Pe}$, is defined as:\n$$ \\text{Pe} = \\frac{U_{\\text{phys}} L_{\\text{phys}}}{D_{\\text{phys}}} $$\nPhysical quantities are related to their dimensionless counterparts by their respective characteristic units:\n-   Physical velocity: $U_{\\text{phys}} = U^{*} \\frac{l_0}{t_0}$\n-   Physical length: $L_{\\text{phys}} = L^{*} l_0$\nSubstituting these and the expression for $D_{\\text{phys}}$ into the Péclet number definition:\n$$ \\text{Pe} = \\frac{\\left(U^{*} \\frac{l_0}{t_0}\\right) (L^{*} l_0)}{D^{*} \\frac{l_0^2}{t_0}} = \\frac{U^{*} L^{*} l_0^2 / t_0}{D^{*} l_0^2 / t_0} = \\frac{U^{*} L^{*}}{D^{*}} $$\nSimilar to the Schmidt number, the Péclet number is also determined entirely by the dimensionless parameters of the simulation: $U^{*}$, $L^{*}$, and $D^{*}$. To achieve a target Péclet number, $\\text{Pe}_{\\text{target}}$, for the given $D^{*}$ and $L^{*}$, the dimensionless flow speed $U^{*}$ must be constrained as follows:\n$$ \\text{Pe}_{\\text{target}} = \\frac{U^{*} L^{*}}{D^{*}} \\implies U^{*} = \\frac{\\text{Pe}_{\\text{target}} D^{*}}{L^{*}} $$\n\n**3) Calculation of Characteristic Mass $m_0$**\n\nFirst, we set the characteristic length scale $l_0$ by enforcing geometric similarity between the simulation and the physical system.\n$$ l_0 = \\frac{L_{\\text{phys}}}{L^{*}} = \\frac{100 \\times 10^{-6} \\ \\mathrm{m}}{20} = 5 \\times 10^{-6} \\ \\mathrm{m} $$\nNext, we use the scaling relation for kinematic viscosity to find the characteristic mass $m_0$.\n$$ \\nu_{\\text{phys}} = \\nu^{*} l_0 \\sqrt{\\frac{e_0}{m_0}} $$\nWe are given $e_0 = k_B T$. Rearranging the equation to solve for $m_0$:\n$$ \\frac{\\nu_{\\text{phys}}}{\\nu^{*} l_0} = \\sqrt{\\frac{k_B T}{m_0}} \\implies \\left(\\frac{\\nu_{\\text{phys}}}{\\nu^{*} l_0}\\right)^2 = \\frac{k_B T}{m_0} $$\n$$ m_0 = k_B T \\left(\\frac{\\nu^{*} l_0}{\\nu_{\\text{phys}}}\\right)^2 $$\nNow, we substitute the given numerical values:\n-   $k_B = 1.380649 \\times 10^{-23} \\ \\mathrm{J/K}$\n-   $T = 300 \\ \\mathrm{K}$\n-   $\\nu^{*} = 0.75$\n-   $l_0 = 5 \\times 10^{-6} \\ \\mathrm{m}$\n-   $\\nu_{\\text{phys}} = 1.0 \\times 10^{-6} \\ \\mathrm{m^2/s}$\n\nThe thermal energy is $e_0 = k_B T = (1.380649 \\times 10^{-23} \\ \\mathrm{J/K})(300 \\ \\mathrm{K}) = 4.141947 \\times 10^{-21} \\ \\mathrm{J}$.\n$$ m_0 = (4.141947 \\times 10^{-21} \\ \\mathrm{J}) \\left(\\frac{(0.75)(5 \\times 10^{-6} \\ \\mathrm{m})}{1.0 \\times 10^{-6} \\ \\mathrm{m^2/s}}\\right)^2 $$\n$$ m_0 = (4.141947 \\times 10^{-21} \\ \\mathrm{J}) \\left(\\frac{3.75 \\times 10^{-6} \\ \\mathrm{m}}{1.0 \\times 10^{-6} \\ \\mathrm{m^2/s}}\\right)^2 = (4.141947 \\times 10^{-21} \\ \\mathrm{J}) (3.75 \\ \\mathrm{s/m})^2 $$\n$$ m_0 = (4.141947 \\times 10^{-21}) (14.0625) \\ \\mathrm{J \\cdot s^2/m^2} $$\nThe units resolve to kilograms, since $1 \\ \\mathrm{J} = 1 \\ \\mathrm{kg \\cdot m^2/s^2}$.\n$$ m_0 \\approx 5.824618 \\times 10^{-20} \\ \\mathrm{kg} $$\nRounding to four significant figures, the required DPD particle mass is $m_0 = 5.825 \\times 10^{-20} \\ \\mathrm{kg}$.\n\n**4) Calculation of Dimensionless Speed $U^{*}$ and Schmidt Number Verification**\n\nUsing the constraint derived in part 2, we calculate the required dimensionless mean speed $U^{*}$ to achieve $\\text{Pe}_{\\text{target}} = 500$:\n$$ U^{*} = \\frac{\\text{Pe}_{\\text{target}} D^{*}}{L^{*}} $$\nSubstituting the given values:\n-   $\\text{Pe}_{\\text{target}} = 500$\n-   $D^{*} = 0.05$\n-   $L^{*} = 20$\n$$ U^{*} = \\frac{500 \\times 0.05}{20} = \\frac{25}{20} = 1.25 $$\nTo four significant figures, this is $1.250$.\n\nFinally, we verify that the Schmidt number is within a realistic range by checking if $\\text{Sc} \\ge 10$:\n$$ \\text{Sc} = \\frac{\\nu^{*}}{D^{*}} = \\frac{0.75}{0.05} = 15 $$\nSince $15 \\ge 10$, the condition is satisfied. The chosen DPD fluid parameters correctly reproduce a liquid-like Schmidt number.\n\nThe final results for the required DPD particle mass and dimensionless mean speed are $m_0 = 5.825 \\times 10^{-20} \\ \\mathrm{kg}$ and $U^{*} = 1.250$.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n5.825 \\times 10^{-20}  1.250\n\\end{pmatrix}\n}\n$$", "id": "3424787"}, {"introduction": "The theoretical model of DPD must be translated into a working algorithm, and the choice of numerical integrator is critical for the simulation's stability and accuracy. This exercise [@problem_id:3424754] delves into the heart of the DPD thermostat, comparing a simple, explicit integration scheme with the more robust Shardlow splitting method. By analyzing the stability conditions and potential for temperature artifacts, you will gain a deeper appreciation for why specific algorithms are preferred in modern DPD software and how numerical choices can impact physical fidelity.", "problem": "You are asked to analyze the numerical stability and temperature control of two time integrators for Dissipative Particle Dynamics (DPD): the Shardlow splitting integrator and a velocity-Verlet style explicit discretization of the dissipative and random pairwise thermostat. The analysis must start from first principles and culminate in implementable formulas. Then, implement these formulas in a complete program that, for a small test suite, reports both stability bounds on the time step and the predicted temperature drift at large time step.\n\nAssume pairwise dissipative and random forces in DPD act on the radial relative velocity between particles, with the dissipative force given by $F^{D}_{ij} = -\\gamma \\left(w^{D}(r_{ij})\\right)^{2} \\left(\\mathbf{v}_{ij}\\cdot \\hat{\\mathbf{r}}_{ij}\\right)\\hat{\\mathbf{r}}_{ij}$ and the random force chosen to satisfy the fluctuation-dissipation relation with $w^{R}(r) = w^{D}(r)$ and noise amplitude consistent with $2\\gamma k_{B}T$. Consider the scalar radial relative velocity $u = \\mathbf{v}_{ij}\\cdot \\hat{\\mathbf{r}}_{ij}$ for a fixed pair separation $r$ within the cutoff $r_{c}$, and define the weight function $w^{D}(r) = \\max\\left(0,1 - r/r_{c}\\right)$. Let the mass be $m$, the dissipative coefficient be $\\gamma$, the Boltzmann constant times temperature be $k_{B}T$, and define the effective friction rate $\\lambda = (\\gamma/m)\\left(w^{D}(r)\\right)^{2}$.\n\nStarting from the Ornstein-Uhlenbeck representation of the pairwise thermostat for $u$, with stochastic differential equation $du = -\\lambda u\\,dt + \\sqrt{2\\lambda\\,k_{B}T/m}\\,dW_{t}$, derive the deterministic stability condition on the time step $\\delta t$ for:\n- A velocity-Verlet style explicit treatment of the dissipative and random terms, modeled at the level of $u$ by the Euler-Maruyama update $u_{n+1} = \\left(1 - \\lambda \\delta t\\right)u_{n} + \\sqrt{2\\lambda\\,k_{B}T/m}\\,\\sqrt{\\delta t}\\,\\xi_{n}$ with $\\xi_{n}\\sim \\mathcal{N}(0,1)$.\n- The Shardlow splitting integrator that integrates the pairwise thermostat exactly as an Ornstein-Uhlenbeck process over the time step, modeled by $u_{n+1} = e^{-\\lambda \\delta t}u_{n} + \\sqrt{k_{B}T/m}\\,\\sqrt{1 - e^{-2\\lambda \\delta t}}\\,\\xi_{n}$.\n\nFrom first principles, determine what bound on $\\delta t$ ensures that the deterministic part contracts for each scheme, and then, for each scheme, compute the stationary variance $\\mathrm{Var}(u)$ implied by the discrete-time update when the scheme is stable. Define the dimensionless temperature drift ratio at time step $\\delta t$ as $\\Delta(\\delta t) = \\mathrm{Var}(u)/\\left(k_{B}T/m\\right) - 1$. If the scheme has no stationary variance because the deterministic factor does not contract, report the drift as not-a-number.\n\nAll quantities must be treated in reduced units with $m = 1$ and $k_{B}T = 1$, and time steps are in reduced time units. Your derivation must use only the definitions and laws stated in this problem statement, without introducing shortcut formulas not derived from them. Your program must implement the derived formulas for the bounds and the drift ratios.\n\nUse the following test suite of parameter tuples $(\\gamma, r, r_{c}, \\delta t)$:\n- $(4.0, 0.5, 1.0, 1.8)$ as a general stable case near the stability limit for the explicit scheme.\n- $(8.0, 0.9, 1.0, 20.0)$ as a case with a small weight and a large time step still within the explicit stability bound.\n- $(5.0, 0.2, 1.0, 0.7)$ as a case beyond the explicit stability bound.\n- $(1.0, 0.99, 1.0, 5000.0)$ as a case with extremely weak dissipation and very large time step.\n- $(10.0, 0.0, 1.0, 0.19)$ as a case close to the explicit stability threshold with maximum weight.\n\nFor each test case, compute:\n- The explicit velocity-Verlet style stability bound on the time step $b_{\\mathrm{VV}}$ in reduced time units.\n- The Shardlow splitting stability bound $b_{\\mathrm{Sh}}$ in reduced time units.\n- The temperature drift ratio at the given large time step for the explicit scheme $\\Delta_{\\mathrm{VV}}(\\delta t)$.\n- The temperature drift ratio at the given large time step for the Shardlow scheme $\\Delta_{\\mathrm{Sh}}(\\delta t)$.\n\nIf the explicit scheme is unstable at the given $\\delta t$ (no contraction), set $\\Delta_{\\mathrm{VV}}(\\delta t)$ to not-a-number. For the Shardlow scheme, if the dissipative part is integrated exactly, the drift ratio should be exactly zero for any $\\delta t \\ge 0$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. Append the four outputs for each test case sequentially, in the order $\\left[b_{\\mathrm{VV}}, b_{\\mathrm{Sh}}, \\Delta_{\\mathrm{VV}}(\\delta t), \\Delta_{\\mathrm{Sh}}(\\delta t)\\right]$. For example, a single-line output might look like $\\left[x_{1},x_{2},x_{3},x_{4},x_{5},x_{6},x_{7},x_{8},\\dots\\right]$, where every group of four corresponds to one test case.", "solution": "The objective is to analyze the numerical stability and thermostatting properties of two integrators for Dissipative Particle Dynamics (DPD) by modeling the pairwise thermostat as an Ornstein-Uhlenbeck (OU) process for the scalar radial relative velocity, $u = \\mathbf{v}_{ij}\\cdot \\hat{\\mathbf{r}}_{ij}$. The SDE governing this process is given as $du = -\\lambda u\\,dt + \\sqrt{2\\lambda\\,k_{B}T/m}\\,dW_{t}$, where $\\lambda = (\\gamma/m)(w^{D}(r))^{2}$ is the effective friction rate. We will derive the stability bounds and temperature drift ratios for a velocity-Verlet style explicit scheme and the Shardlow splitting integrator, working in reduced units where mass $m=1$ and thermal energy $k_{B}T=1$.\n\nA general one-dimensional discrete-time stochastic process of the form $u_{n+1} = C u_{n} + D \\xi_{n}$, where $\\xi_{n}$ are independent and identically distributed random variables with $\\mathbb{E}[\\xi_{n}]=0$ and $\\mathrm{Var}(\\xi_{n})=1$, is considered. For the process to reach a stationary state, the deterministic part must be contractile, which requires the amplification factor $C$ to satisfy $|C|  1$. If this condition holds, we can compute the stationary variance, $\\mathrm{Var}(u)$. At steady state, $\\mathrm{Var}(u_{n+1}) = \\mathrm{Var}(u_{n}) = \\mathrm{Var}(u)$. Taking the variance of the update equation and using the fact that $u_{n}$ and $\\xi_{n}$ are uncorrelated ($\\mathbb{E}[u_{n}\\xi_{n}] = \\mathbb{E}[u_{n}]\\mathbb{E}[\\xi_{n}] = 0$ since $\\mathbb{E}[u_{n}]=0$ from symmetry), we get:\n$$ \\mathrm{Var}(u_{n+1}) = \\mathrm{Var}(C u_{n} + D \\xi_{n}) = C^{2}\\mathrm{Var}(u_{n}) + D^{2}\\mathrm{Var}(\\xi_{n}) $$\n$$ \\mathrm{Var}(u) = C^{2}\\mathrm{Var}(u) + D^{2} $$\nSolving for $\\mathrm{Var}(u)$ yields:\n$$ \\mathrm{Var}(u) = \\frac{D^{2}}{1 - C^{2}} $$\nThis formula is valid only under the stability condition $|C|1$. The target variance for the variable $u$ that correctly represents the canonical ensemble is given by the equipartition theorem as $\\mathrm{Var}(u) = k_{B}T/m$. The dimensionless temperature drift ratio, $\\Delta(\\delta t)$, measures the deviation of the numerical scheme's stationary variance from this target value:\n$$ \\Delta(\\delta t) = \\frac{\\mathrm{Var}(u)}{k_{B}T/m} - 1 $$\nIn the specified reduced units ($m=1$, $k_{B}T=1$), the target variance is $1$, so the drift is simply $\\Delta(\\delta t) = \\mathrm{Var}(u) - 1$.\n\nWe now apply this general framework to the two specified integration schemes. First, we define the weight function $w^{D}(r) = \\max(0, 1 - r/r_{c})$ and the friction rate $\\lambda = \\gamma (w^{D}(r))^{2}$ in reduced units.\n\nAnalysis of the Explicit Velocity-Verlet Style Scheme:\nThe update rule is given as $u_{n+1} = \\left(1 - \\lambda \\delta t\\right)u_{n} + \\sqrt{2\\lambda\\,k_{B}T/m}\\,\\sqrt{\\delta t}\\,\\xi_{n}$.\nIn reduced units, this is $u_{n+1} = \\left(1 - \\lambda \\delta t\\right)u_{n} + \\sqrt{2\\lambda\\,\\delta t}\\,\\xi_{n}$.\nBy comparison with the general form, we identify the coefficients:\n$C_{\\mathrm{VV}} = 1 - \\lambda \\delta t$\n$D_{\\mathrm{VV}} = \\sqrt{2\\lambda\\,\\delta t}$\n\nThe stability condition is $|C_{\\mathrm{VV}}|  1$, which translates to $|1 - \\lambda \\delta t|  1$. This inequality expands to $-1  1 - \\lambda \\delta t  1$.\nThe right side, $1 - \\lambda \\delta t  1$, implies $-\\lambda \\delta t  0$, which is always true for $\\lambda  0$ and $\\delta t  0$.\nThe left side, $-1  1 - \\lambda \\delta t$, implies $\\lambda \\delta t  2$.\nThus, the condition for deterministic stability is $\\delta t  2/\\lambda$. The stability bound is the maximum time step for which this holds, so $b_{\\mathrm{VV}} = 2/\\lambda$. For any $\\delta t \\ge b_{\\mathrm{VV}}$, the scheme is unstable and a stationary variance does not exist.\n\nWhen the scheme is stable ($\\delta t  2/\\lambda$), the stationary variance is:\n$$ \\mathrm{Var}(u)_{\\mathrm{VV}} = \\frac{D_{\\mathrm{VV}}^{2}}{1 - C_{\\mathrm{VV}}^{2}} = \\frac{2\\lambda\\,\\delta t}{1 - (1 - \\lambda \\delta t)^{2}} = \\frac{2\\lambda\\,\\delta t}{1 - (1 - 2\\lambda \\delta t + \\lambda^{2} \\delta t^{2})} = \\frac{2\\lambda\\,\\delta t}{2\\lambda \\delta t - \\lambda^{2} \\delta t^{2}} $$\nAssuming $\\lambda \\delta t \\neq 0$, we can simplify this to:\n$$ \\mathrm{Var}(u)_{\\mathrm{VV}} = \\frac{2}{2 - \\lambda \\delta t} $$\nThe temperature drift ratio is then:\n$$ \\Delta_{\\mathrm{VV}}(\\delta t) = \\mathrm{Var}(u)_{\\mathrm{VV}} - 1 = \\frac{2}{2 - \\lambda \\delta t} - 1 = \\frac{2 - (2 - \\lambda \\delta t)}{2 - \\lambda \\delta t} = \\frac{\\lambda \\delta t}{2 - \\lambda \\delta t} $$\nThis formula is only valid for $\\delta t  2/\\lambda$. If $\\delta t \\ge 2/\\lambda$, the variance is undefined, and the drift must be reported as not-a-number (NaN).\n\nAnalysis of the Shardlow Splitting Scheme:\nThe update rule, corresponding to an exact integration of the OU process over a time step $\\delta t$, is $u_{n+1} = e^{-\\lambda \\delta t}u_{n} + \\sqrt{k_{B}T/m}\\,\\sqrt{1 - e^{-2\\lambda \\delta t}}\\,\\xi_{n}$.\nIn reduced units, this is $u_{n+1} = e^{-\\lambda \\delta t}u_{n} + \\sqrt{1 - e^{-2\\lambda \\delta t}}\\,\\xi_{n}$.\nThe coefficients are:\n$C_{\\mathrm{Sh}} = e^{-\\lambda \\delta t}$\n$D_{\\mathrm{Sh}} = \\sqrt{1 - e^{-2\\lambda \\delta t}}$\n\nThe stability condition is $|C_{\\mathrm{Sh}}|  1$, or $|e^{-\\lambda \\delta t}|  1$. For any $\\lambda  0$ and $\\delta t  0$, the exponent $-\\lambda \\delta t$ is negative, so $0  e^{-\\lambda \\delta t}  1$. The condition is always satisfied. Therefore, the Shardlow scheme is unconditionally stable for any positive time step. The stability bound is infinite, $b_{\\mathrm{Sh}} = \\infty$.\n\nThe stationary variance for the Shardlow scheme is:\n$$ \\mathrm{Var}(u)_{\\mathrm{Sh}} = \\frac{D_{\\mathrm{Sh}}^{2}}{1 - C_{\\mathrm{Sh}}^{2}} = \\frac{\\left(\\sqrt{1 - e^{-2\\lambda \\delta t}}\\right)^{2}}{1 - \\left(e^{-\\lambda \\delta t}\\right)^{2}} = \\frac{1 - e^{-2\\lambda \\delta t}}{1 - e^{-2\\lambda \\delta t}} = 1 $$\nThis holds for any $\\delta t  0$ (as long as $\\lambda  0$). The stationary variance is exactly equal to the target variance $k_{B}T/m = 1$.\nThe temperature drift ratio is therefore:\n$$ \\Delta_{\\mathrm{Sh}}(\\delta t) = \\mathrm{Var}(u)_{\\mathrm{Sh}} - 1 = 1 - 1 = 0 $$\nThis confirms that the Shardlow integrator, by construction, perfectly maintains the temperature of the subsystem it thermostats, regardless of the time step size. If $\\lambda=0$, there is no dissipation, and both schemes preserve the initial variance; in this case, the drift can be considered $0$.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Analyzes the numerical stability and temperature control of two DPD integrators.\n    \"\"\"\n    # Test suite of parameter tuples (gamma, r, r_c, delta_t)\n    test_cases = [\n        (4.0, 0.5, 1.0, 1.8),\n        (8.0, 0.9, 1.0, 20.0),\n        (5.0, 0.2, 1.0, 0.7),\n        (1.0, 0.99, 1.0, 5000.0),\n        (10.0, 0.0, 1.0, 0.19),\n    ]\n\n    results = []\n\n    for case in test_cases:\n        gamma, r, r_c, dt = case\n        \n        # In DPD reduced units, m=1 and k_B T = 1.\n\n        # 1. Calculate the weight function w^D(r)\n        # w^D(r) = max(0, 1 - r/r_c)\n        if r >= r_c:\n            w = 0.0\n        else:\n            w = 1.0 - r / r_c\n\n        # 2. Calculate the effective friction rate lambda\n        # lambda = (gamma/m) * (w^D(r))^2. With m=1, lambda = gamma * w^2\n        lambda_val = gamma * w**2\n        \n        # 3. Calculate stability bounds and drift ratios\n\n        # For the explicit velocity-Verlet style scheme\n        b_vv = 0.0\n        delta_vv = 0.0\n        \n        if lambda_val == 0:\n            # No dissipation: stable for any dt, no drift towards stationary state.\n            # The formulas for b_vv and delta_vv have lambda_val in the denominator.\n            # lim_{lambda->0} b_vv = inf\n            # lim_{lambda->0} delta_vv = 0\n            b_vv = np.inf\n            delta_vv = 0.0\n        else:\n            # Stability bound b_vv = 2 / lambda\n            b_vv = 2.0 / lambda_val\n            \n            # Check if the scheme is stable at the given dt\n            if dt  b_vv:\n                # Drift ratio Delta_vv = (lambda * dt) / (2 - lambda * dt)\n                delta_vv = (lambda_val * dt) / (2.0 - lambda_val * dt)\n            else:\n                # Unstable, stationary variance does not exist.\n                delta_vv = np.nan\n\n        # For the Shardlow splitting scheme\n        # Unconditionally stable, so the bound is infinite.\n        b_sh = np.inf\n        \n        # Perfect temperature control, so drift is exactly zero.\n        delta_sh = 0.0\n        \n        results.extend([b_vv, b_sh, delta_vv, delta_sh])\n\n    # Final print statement in the exact required format.\n    # The map(str,...) ensures appropriate string representation of inf and nan.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```", "id": "3424754"}]}