{"hands_on_practices": [{"introduction": "A cornerstone of structure-based coarse-graining is the principle of matching a model's structural properties, like the radial distribution function (RDF), to a known reference. This exercise provides hands-on practice with the Iterative Boltzmann Inversion (IBI) method, a powerful algorithm for achieving this goal. By working through a single update step, you will directly apply the fundamental link between the potential of mean force and the RDF to refine a coarse-grained potential, solidifying your understanding of how these models are systematically optimized [@problem_id:3402194].", "problem": "Consider a one-site coarse-grained mapping of a Lennard–Jones fluid, where each molecule is represented by a single interaction site. The system is simulated in the canonical ensemble at temperature $T = 300\\,\\mathrm{K}$ and number density $\\rho = 0.80\\,\\mathrm{nm}^{-3}$. You seek to optimize the coarse-grained pair potential $U(r)$ using Iterative Boltzmann Inversion (IBI), defined here as a procedure to iteratively adjust $U(r)$ so that the coarse-grained radial distribution function (RDF), denoted $g(r)$, matches a target RDF $g^{\\mathrm{target}}(r)$ obtained by mapping an all-atom reference trajectory.\n\nAt the $n$-th IBI iteration, the measured coarse-grained RDF at separation $r^{\\ast} = 0.80\\,\\mathrm{nm}$ is $g_{n}(r^{\\ast}) = 1.20$, while the target RDF at that separation is $g^{\\mathrm{target}}(r^{\\ast}) = 0.85$. The current pair potential at that separation is $U_{n}(r^{\\ast}) = 2.50\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$. Using only fundamental relations of the canonical ensemble and the definition of the potential of mean force $w(r)$ in terms of the RDF, derive the IBI update at the single separation $r^{\\ast}$ and compute the new potential value $U_{n+1}(r^{\\ast})$ numerically. Assume that the update is based on replacing changes in the coarse-grained pair potential by changes in the potential of mean force, that any additive constants in $w(r)$ are irrelevant to the update, and that energies are treated per mole so that Boltzmann’s constant $k_{B}$ is replaced by the molar gas constant $R = 8.314462618 \\times 10^{-3}\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$.\n\nExpress the final energy in $\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$ and round your answer to four significant figures.", "solution": "The problem is first validated against the specified criteria.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n- Ensemble: Canonical ensemble\n- Temperature: $T = 300\\,\\mathrm{K}$\n- Number density: $\\rho = 0.80\\,\\mathrm{nm}^{-3}$\n- Coarse-graining method: Iterative Boltzmann Inversion (IBI)\n- Iteration number: $n$\n- Separation of interest: $r^{\\ast} = 0.80\\,\\mathrm{nm}$\n- Measured RDF at $r^{\\ast}$: $g_{n}(r^{\\ast}) = 1.20$\n- Target RDF at $r^{\\ast}$: $g^{\\mathrm{target}}(r^{\\ast}) = 0.85$\n- Current pair potential at $r^{\\ast}$: $U_{n}(r^{\\ast}) = 2.50\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$\n- Molar gas constant: $R = 8.314462618 \\times 10^{-3}\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$\n- Premise 1: The update is based on replacing changes in the coarse-grained pair potential by changes in the potential of mean force.\n- Premise 2: Additive constants in the potential of mean force $w(r)$ are irrelevant.\n- Premise 3: Energies are treated per mole, so Boltzmann's constant $k_{B}$ is replaced by the molar gas constant $R$.\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientific Grounding**: The problem is well-grounded in the principles of statistical mechanics and computational chemistry, specifically coarse-grained modeling. Iterative Boltzmann Inversion is a standard and well-established technique.\n- **Well-Posedness**: The problem provides all necessary information to derive the update rule and compute the requested value. A unique numerical solution exists. The inclusion of the number density $\\rho$ is extraneous to the calculation but does not invalidate the problem.\n- **Objectivity**: The problem is stated in precise, quantitative, and unbiased language.\n\n**Step 3: Verdict and Action**\nThe problem is scientifically sound, self-contained, and well-posed. It is therefore deemed **valid**. A full solution will be provided.\n\n### Solution Derivation\n\nThe core of the Iterative Boltzmann Inversion (IBI) method lies in the relationship between the pair potential $U(r)$ that defines the interactions in a simulation and the resulting structure, as quantified by the radial distribution function (RDF), $g(r)$. This relationship is mediated by the potential of mean force (PMF), $w(r)$.\n\nFrom the principles of statistical mechanics in the canonical ensemble, the RDF is related to the PMF by:\n$$g(r) = \\exp\\left(-\\frac{w(r)}{k_{B}T}\\right)$$\nAs the problem specifies that energies are treated per mole, we replace Boltzmann's constant $k_{B}$ with the molar gas constant $R$:\n$$g(r) = \\exp\\left(-\\frac{w(r)}{RT}\\right)$$\nThis fundamental relation can be inverted to express the PMF as a function of the RDF:\n$$w(r) = -RT \\ln[g(r)]$$\nThe goal of IBI is to find a coarse-grained pair potential $U(r)$ that, when used in a simulation, reproduces a known target RDF, $g^{\\mathrm{target}}(r)$. The target RDF corresponds to a target PMF, $w^{\\mathrm{target}}(r)$:\n$$w^{\\mathrm{target}}(r) = -RT \\ln[g^{\\mathrm{target}}(r)]$$\nAt the $n$-th iteration of IBI, a simulation with the current potential guess, $U_n(r)$, yields a measured RDF, $g_n(r)$. The PMF corresponding to this measured RDF is:\n$$w_n(r) = -RT \\ln[g_n(r)]$$\nThe problem states that the update rule is derived by \"replacing changes in the coarse-grained pair potential by changes in the potential of mean force.\" This is a key heuristic of IBI, which can be formalized as a linear-response-like assumption. The required change in the potential to move from iteration $n$ to $n+1$, denoted $\\Delta U_n(r) = U_{n+1}(r) - U_n(r)$, is set to be equal to the required change in the PMF to match the target, i.e., $\\Delta w(r) = w^{\\mathrm{target}}(r) - w_n(r)$.\nTherefore, the potential update is:\n$$U_{n+1}(r) - U_n(r) = w^{\\mathrm{target}}(r) - w_n(r)$$\nSubstituting the expressions for the PMFs:\n$$U_{n+1}(r) - U_n(r) = \\left(-RT \\ln[g^{\\mathrm{target}}(r)]\\right) - \\left(-RT \\ln[g_n(r)]\\right)$$\n$$U_{n+1}(r) - U_n(r) = RT \\left(\\ln[g_n(r)] - \\ln[g^{\\mathrm{target}}(r)]\\right)$$\nThis simplifies using the properties of logarithms:\n$$U_{n+1}(r) - U_n(r) = RT \\ln\\left[\\frac{g_n(r)}{g^{\\mathrm{target}}(r)}\\right]$$\nRearranging for the new potential $U_{n+1}(r)$, we obtain the standard IBI update equation:\n$$U_{n+1}(r) = U_n(r) + RT \\ln\\left[\\frac{g_n(r)}{g^{\\mathrm{target}}(r)}\\right]$$\n\n### Numerical Calculation\n\nWe can now compute the value of the updated potential $U_{n+1}(r^{\\ast})$ at the specific separation $r^{\\ast} = 0.80\\,\\mathrm{nm}$ using the provided data:\n- $U_{n}(r^{\\ast}) = 2.50\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$\n- $T = 300\\,\\mathrm{K}$\n- $R = 8.314462618 \\times 10^{-3}\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$\n- $g_{n}(r^{\\ast}) = 1.20$\n- $g^{\\mathrm{target}}(r^{\\ast}) = 0.85$\n\nFirst, calculate the thermal energy term, $RT$:\n$$RT = (8.314462618 \\times 10^{-3}\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}) \\times (300\\,\\mathrm{K}) = 2.4943387854\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$$\nNext, substitute the values into the update equation:\n$$U_{n+1}(r^{\\ast}) = 2.50\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1} + (2.4943387854\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}) \\times \\ln\\left(\\frac{1.20}{0.85}\\right)$$\nThe argument of the natural logarithm is:\n$$\\frac{1.20}{0.85} \\approx 1.4117647$$\nThe natural logarithm of this value is:\n$$\\ln\\left(\\frac{1.20}{0.85}\\right) \\approx 0.344840486$$\nNow, calculate the potential correction term:\n$$\\Delta U_n(r^{\\ast}) = (2.4943387854\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}) \\times (0.344840486) \\approx 0.8599446\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$$\nFinally, add this correction to the current potential:\n$$U_{n+1}(r^{\\ast}) = 2.50\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1} + 0.8599446\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1} = 3.3599446\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$$\nThe problem requires rounding the final answer to four significant figures.\n$$U_{n+1}(r^{\\ast}) \\approx 3.360\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$$", "answer": "$$\\boxed{3.360}$$", "id": "3402194"}, {"introduction": "Once a coarse-grained potential has been derived to reproduce a target structure, the next critical step is validation. A robust model must also be thermodynamically consistent, accurately predicting properties such as pressure. This practice problem guides you through the application of the virial theorem to calculate pressure from a coarse-grained potential and RDF, and prompts you to critically evaluate the key assumptions—such as pairwise additivity—that determine the validity of this approach for coarse-grained systems [@problem_id:3402197].", "problem": "Consider a homogeneous, isotropic coarse-grained (CG) fluid of $N$ identical CG beads in volume $V$ at temperature $T$, where each CG bead interacts via a pairwise, central, conservative potential $u(r)$ that depends only on the interbead separation $r$. The coarse-graining maps atomistic configurations to bead coordinates such that the effective CG forces are pairwise additive and conservative. The system is in equilibrium and sampled ergodically, and the radial distribution function (RDF) $g(r)$ is well-defined. Starting from Newton’s second law and the mechanical definition of pressure via the virial route, derive the expression for the pressure $p$ of this homogeneous fluid in terms of the number density $\\rho$, the Boltzmann constant $k_B$, the temperature $T$, the RDF $g(r)$, and the pair potential $u(r)$.\n\nThen, evaluate the pressure for a CG fluid with the following specific forms for $u(r)$ and $g(r)$:\n- The pair potential is $u(r) = \\epsilon \\exp(-\\lambda r)$, with $\\epsilon = 1.5\\, k_B T$ and $\\lambda = 3~\\mathrm{nm}^{-1}$.\n- The radial distribution function is $g(r) = 1 + A \\exp(-\\alpha r)$, with $A = 0.4$ and $\\alpha = 1~\\mathrm{nm}^{-1}$.\n- The number density is $\\rho = 2~\\mathrm{nm}^{-3}$.\n\nExplicitly perform the required integration and provide the final numerical value of the pressure. Express your final numerical answer in units of $k_B T$ per $\\mathrm{nm}^3$, and round your answer to four significant figures.\n\nFinally, clearly state the physical conditions under which the derived virial expression for $p$ holds for coarse-grained models, including any assumptions about the mapping and force field that are necessary for validity.", "solution": "The problem asks for three components: first, the derivation of the virial expression for pressure for a homogeneous fluid with pairwise central interactions; second, the evaluation of this expression for a specific coarse-grained (CG) system; and third, a discussion of the physical conditions required for this expression to be valid for CG models.\n\n**Part 1: Derivation of the Virial Pressure Equation**\n\nWe begin with the Clausius virial, $\\mathcal{W}$, defined for a system of $N$ particles with position vectors $\\mathbf{r}_i$ and subject to total forces $\\mathbf{F}_i^{\\text{tot}}$:\n$$\n\\mathcal{W} = \\sum_{i=1}^{N} \\mathbf{r}_i \\cdot \\mathbf{F}_i^{\\text{tot}}\n$$\nThe virial theorem states that the time average of the virial is related to the time average of the total kinetic energy, $K = \\sum_{i=1}^N \\frac{1}{2} m_i v_i^2$, of the system:\n$$\n\\left\\langle \\sum_{i=1}^{N} \\mathbf{r}_i \\cdot \\frac{d\\mathbf{p}_i}{dt} \\right\\rangle = -2 \\langle K \\rangle\n$$\nwhere $\\mathbf{p}_i$ is the momentum of particle $i$. The left-hand side can be expanded as $\\frac{d}{dt} \\left( \\sum_i \\mathbf{r}_i \\cdot \\mathbf{p}_i \\right) - \\sum_i \\frac{d\\mathbf{r}_i}{dt} \\cdot \\mathbf{p}_i$. The time average of the total derivative term vanishes for a bounded system. The second term is $-\\sum_i \\mathbf{v}_i \\cdot (m_i\\mathbf{v}_i) = -\\sum_i m_i v_i^2 = -2K$. This establishes the identity.\n\nIn thermodynamic equilibrium at temperature $T$, the equipartition theorem states that the average kinetic energy is $\\langle K \\rangle = \\frac{3}{2} N k_B T$, where $k_B$ is the Boltzmann constant. Thus, the time average of the virial is:\n$$\n\\left\\langle \\mathcal{W} \\right\\rangle = \\left\\langle \\sum_{i=1}^{N} \\mathbf{r}_i \\cdot \\mathbf{F}_i^{\\text{tot}} \\right\\rangle = -3 N k_B T\n$$\nThe total force on particle $i$, $\\mathbf{F}_i^{\\text{tot}}$, can be separated into the sum of internal forces from other particles in the system, $\\mathbf{F}_i^{\\text{int}}$, and external forces from the container walls, $\\mathbf{F}_i^{\\text{ext}}$.\n$$\n\\left\\langle \\sum_{i=1}^{N} \\mathbf{r}_i \\cdot \\mathbf{F}_i^{\\text{ext}} \\right\\rangle + \\left\\langle \\sum_{i=1}^{N} \\mathbf{r}_i \\cdot \\mathbf{F}_i^{\\text{int}} \\right\\rangle = -3 N k_B T\n$$\nThe external force term is directly related to the pressure $p$ exerted by the fluid on the container of volume $V$. This term evaluates to $-3pV$.\n$$\n-3pV + \\left\\langle \\sum_{i=1}^{N} \\mathbf{r}_i \\cdot \\mathbf{F}_i^{\\text{int}} \\right\\rangle = -3 N k_B T\n$$\nSolving for the pressure $p$:\n$$\np = \\frac{N k_B T}{V} + \\frac{1}{3V} \\left\\langle \\sum_{i=1}^{N} \\mathbf{r}_i \\cdot \\mathbf{F}_i^{\\text{int}} \\right\\rangle\n$$\nThe first term is the ideal gas pressure, $\\rho k_B T$, where $\\rho = N/V$ is the number density.\n\nThe internal force on particle $i$ is the sum of pairwise forces from all other particles $j$: $\\mathbf{F}_i^{\\text{int}} = \\sum_{j \\ne i} \\mathbf{F}_{ij}$. The internal virial term is:\n$$\n\\left\\langle \\sum_{i=1}^{N} \\mathbf{r}_i \\cdot \\sum_{j \\ne i} \\mathbf{F}_{ij} \\right\\rangle = \\left\\langle \\sum_{i \\ne j} \\mathbf{r}_i \\cdot \\mathbf{F}_{ij} \\right\\rangle\n$$\nWe can rewrite the sum over distinct pairs $(i, j)$ as a sum over pairs with $i < j$. By Newton's third law, $\\mathbf{F}_{ij} = -\\mathbf{F}_{ji}$:\n$$\n\\sum_{i \\ne j} \\mathbf{r}_i \\cdot \\mathbf{F}_{ij} = \\sum_{i<j} (\\mathbf{r}_i \\cdot \\mathbf{F}_{ij} + \\mathbf{r}_j \\cdot \\mathbf{F}_{ji}) = \\sum_{i<j} (\\mathbf{r}_i \\cdot \\mathbf{F}_{ij} - \\mathbf{r}_j \\cdot \\mathbf{F}_{ij}) = \\sum_{i<j} (\\mathbf{r}_i - \\mathbf{r}_j) \\cdot \\mathbf{F}_{ij}\n$$\nLet $\\mathbf{r}_{ij} = \\mathbf{r}_i - \\mathbf{r}_j$ be the vector separation and $r = |\\mathbf{r}_{ij}|$ be the distance. For a central, conservative potential $u(r)$, the force is $\\mathbf{F}_{ij} = -\\nabla_{\\mathbf{r}_i} u(r) = -\\frac{du}{dr} \\frac{\\mathbf{r}_{ij}}{r}$. The dot product becomes:\n$$\n\\mathbf{r}_{ij} \\cdot \\mathbf{F}_{ij} = \\mathbf{r}_{ij} \\cdot \\left( -\\frac{du}{dr} \\frac{\\mathbf{r}_{ij}}{r} \\right) = -r \\frac{du}{dr}\n$$\nThe pressure expression is now:\n$$\np = \\rho k_B T + \\frac{1}{3V} \\left\\langle \\sum_{i<j} \\left( -r_{ij} \\frac{du(r_{ij})}{dr_{ij}} \\right) \\right\\rangle\n$$\nThe ensemble average of the sum over pairs can be converted to an integral over the radial distribution function $g(r)$. The probability of finding a particle in a spherical shell of volume $4\\pi r^2 dr$ at a distance $r$ from another particle is $\\rho g(r) 4\\pi r^2 dr$. Summing over all $\\frac{1}{2}N(N-1) \\approx \\frac{1}{2}N^2$ pairs in the system for large $N$:\n$$\n\\left\\langle \\sum_{i<j} f(r_{ij}) \\right\\rangle = \\frac{N}{2} \\int_0^\\infty f(r) \\left( \\rho g(r) 4\\pi r^2 \\right) dr = \\frac{N \\rho}{2} \\int_0^\\infty f(r) g(r) 4\\pi r^2 dr\n$$\nSubstituting $f(r) = -r \\frac{du}{dr}$ and $N = \\rho V$:\n$$\n\\left\\langle \\sum_{i<j} \\left( -r \\frac{du}{dr} \\right) \\right\\rangle = \\frac{(\\rho V) \\rho}{2} \\int_0^\\infty \\left(-r \\frac{du}{dr}\\right) g(r) 4\\pi r^2 dr = -2\\pi V \\rho^2 \\int_0^\\infty r^3 g(r) \\frac{du}{dr} dr\n$$\nPlugging this back into the pressure equation:\n$$\np = \\rho k_B T + \\frac{1}{3V} \\left( -2\\pi V \\rho^2 \\int_0^\\infty r^3 g(r) \\frac{du}{dr} dr \\right)\n$$\nThis simplifies to the final form of the virial equation for pressure:\n$$\np = \\rho k_B T - \\frac{2\\pi \\rho^2}{3} \\int_0^\\infty r^3 g(r) \\frac{du(r)}{dr} dr\n$$\n\n**Part 2: Evaluation for the Specific System**\n\nGiven:\n- Potential: $u(r) = \\epsilon \\exp(-\\lambda r)$, with $\\epsilon = 1.5\\, k_B T$ and $\\lambda = 3~\\mathrm{nm}^{-1}$.\n- RDF: $g(r) = 1 + A \\exp(-\\alpha r)$, with $A = 0.4$ and $\\alpha = 1~\\mathrm{nm}^{-1}$.\n- Number density: $\\rho = 2~\\mathrm{nm}^{-3}$.\n\nFirst, we find the derivative of the potential:\n$$\n\\frac{du(r)}{dr} = \\frac{d}{dr} [\\epsilon \\exp(-\\lambda r)] = -\\lambda \\epsilon \\exp(-\\lambda r)\n$$\nNext, we evaluate the integral term, which we call $I$:\n$$\nI = \\int_0^\\infty r^3 g(r) \\frac{du(r)}{dr} dr = \\int_0^\\infty r^3 [1 + A \\exp(-\\alpha r)] [-\\lambda \\epsilon \\exp(-\\lambda r)] dr\n$$\n$$\nI = -\\lambda \\epsilon \\int_0^\\infty r^3 [\\exp(-\\lambda r) + A \\exp(-(\\lambda+\\alpha)r)] dr\n$$\nWe use the standard integral formula $\\int_0^\\infty x^n \\exp(-ax) dx = \\frac{n!}{a^{n+1}}$. For our case, $n=3$.\n$$\nI = -\\lambda \\epsilon \\left[ \\int_0^\\infty r^3 \\exp(-\\lambda r) dr + A \\int_0^\\infty r^3 \\exp(-(\\lambda+\\alpha)r) dr \\right]\n$$\n$$\nI = -\\lambda \\epsilon \\left[ \\frac{3!}{\\lambda^{4}} + A \\frac{3!}{(\\lambda+\\alpha)^{4}} \\right] = -6 \\epsilon \\lambda \\left[ \\frac{1}{\\lambda^4} + \\frac{A}{(\\lambda+\\alpha)^4} \\right] = -6 \\epsilon \\left[ \\frac{1}{\\lambda^3} + \\frac{A \\lambda}{(\\lambda+\\alpha)^4} \\right]\n$$\nNow we substitute this back into the pressure expression:\n$$\np = \\rho k_B T - \\frac{2\\pi \\rho^2}{3} \\left( -6 \\epsilon \\left[ \\frac{1}{\\lambda^3} + \\frac{A \\lambda}{(\\lambda+\\alpha)^4} \\right] \\right)\n$$\n$$\np = \\rho k_B T + 4\\pi \\rho^2 \\epsilon \\left[ \\frac{1}{\\lambda^3} + \\frac{A \\lambda}{(\\lambda+\\alpha)^4} \\right]\n$$\nTo obtain the pressure in units of $k_B T / \\mathrm{nm}^3$, we divide by $k_B T$:\n$$\n\\frac{p}{k_B T} = \\rho + 4\\pi \\rho^2 \\frac{\\epsilon}{k_B T} \\left[ \\frac{1}{\\lambda^3} + \\frac{A \\lambda}{(\\lambda+\\alpha)^4} \\right]\n$$\nSubstitute the given values: $\\rho = 2$, $\\epsilon/(k_B T) = 1.5$, $\\lambda = 3$, $A=0.4$, $\\alpha=1$.\n$$\n\\lambda + \\alpha = 3 + 1 = 4\n$$\n$$\n\\frac{p}{k_B T} = 2 + 4\\pi (2^2) (1.5) \\left[ \\frac{1}{3^3} + \\frac{(0.4)(3)}{(4)^4} \\right]\n$$\n$$\n\\frac{p}{k_B T} = 2 + 24\\pi \\left[ \\frac{1}{27} + \\frac{1.2}{256} \\right]\n$$\nThe term in the brackets is:\n$$\n\\frac{1}{27} + \\frac{1.2}{256} = \\frac{1}{27} + \\frac{3}{640} = \\frac{640 + 3 \\times 27}{27 \\times 640} = \\frac{640 + 81}{17280} = \\frac{721}{17280}\n$$\nNow, substitute this back:\n$$\n\\frac{p}{k_B T} = 2 + 24\\pi \\left( \\frac{721}{17280} \\right) = 2 + \\pi \\left( \\frac{721}{720} \\right)\n$$\nNumerically evaluating this expression:\n$$\n\\frac{p}{k_B T} \\approx 2 + 3.14159265 \\times \\frac{721}{720} \\approx 2 + 3.1459556 \\approx 5.1459556\n$$\nRounding to four significant figures, we get $5.146$. The unit is $k_B T / \\mathrm{nm}^3$.\n\n**Part 3: Conditions for Validity in Coarse-Grained Models**\n\nThe derivation of the virial pressure expression relies on several fundamental assumptions. For this expression to be valid for a coarse-grained (CG) model, the effective interactions between the CG beads must conform to these assumptions. The key physical conditions are:\n\n1.  **Pairwise Additivity of the Potential of Mean Force (PMF):** The derivation assumes the total potential energy of the system can be written as a sum of pairwise interactions, $U(\\mathbf{R}^N) = \\sum_{i<j} u(r_{ij})$. In coarse-graining, the effective interaction between two CG beads, the PMF, is obtained by averaging over all the degrees of freedom of the underlying atoms. This process inherently introduces many-body effects. For the virial expression to hold, these many-body contributions must be negligible, allowing the PMF to be accurately approximated by a pairwise potential. This is a very strong condition that holds only for specific systems, typically at low densities.\n\n2.  **Conservative Effective Forces:** The derivation requires that the force between beads is the negative gradient of a potential, $\\mathbf{F}_{ij} = -\\nabla_{\\mathbf{r}_i} u(r_{ij})$. This implies that the coarse-graining procedure maps the original atomistic system onto a new system governed by a time-independent Hamiltonian. However, integrating out fast degrees of freedom often leads to non-conservative forces, including frictional (dissipative) forces and random forces that represent thermal fluctuations. If such forces are present (as in models like Dissipative Particle Dynamics), the simple virial expression derived here is incomplete and requires modification.\n\n3.  **Central and Isotropic Interactions:** The potential $u(r)$ and force $\\mathbf{F}_{ij}$ are assumed to depend only on the scalar distance $r_{ij}$ between CG sites. This is valid for CG models where the beads are a priori defined as simple, spherically symmetric interaction sites. It neglects any orientation-dependent interactions (torques) that would be present if the coarse-graining represents non-spherical molecules or molecular fragments.\n\nIn summary, the virial pressure expression is strictly valid for a CG model only if the coarse-graining procedure yields an effective potential that is representable as a sum of pairwise, central, conservative interactions. This condition of **pairwise representability of the PMF** is the most critical and often represents an approximation rather than a certainty.", "answer": "$$\n\\boxed{5.146}\n$$", "id": "3402197"}, {"introduction": "A frequent challenge in coarse-graining is that a model reproducing static, equilibrium properties may not correctly capture the system's dynamics. This advanced exercise confronts this issue by exploring the connection between the potential of mean force and the kinetics of barrier crossing. You will use the framework of the Generalized Langevin Equation and Kramers' theory to derive a time-rescaling factor, revealing how the \"memory\" effects of the underlying atomistic system can be accounted for to align the timescale of a conservative coarse-grained model with reality [@problem_id:3402208].", "problem": "Consider a one-dimensional collective variable $x(t)$ extracted from an atomistic all-atom (AA) system and a corresponding conservative coarse-grained (CG) model constructed to reproduce the potential of mean force (PMF) $F(x)$. The AA dynamics along $x$ is described by the Generalized Langevin Equation (GLE) in the overdamped limit for barrier-crossing kinetics, while the CG dynamics is governed by a Markovian Langevin equation with a white-noise friction. You are to quantify the effective time rescaling factor $\\alpha$ such that rescaling the CG time $t_{\\mathrm{CG}}$ by $\\alpha$ makes the mean first-passage time (MFPT) over a PMF barrier in the CG model match that of the AA model.\n\nUse the following fundamental base:\n- Newton’s laws and the definition of velocity $v(t) = dx/dt$.\n- The Generalized Langevin Equation (GLE) for the AA collective variable with additive memory friction and thermal noise consistent with the fluctuation-dissipation theorem.\n- The Smoluchowski description of overdamped barrier crossing and the classical high-friction Kramers theory for MFPT scaling with friction.\n- The definition of PMF barrier height $\\Delta F$ and local quadratic approximations near the well minimum and barrier top.\n\nDefine the AA effective friction as $\\zeta_{\\mathrm{eff}} = \\zeta_{0} + \\int_{0}^{\\infty} K(t)\\,dt$, where $\\zeta_{0}$ is the instantaneous (Markovian) friction component and $K(t)$ is the memory kernel. Define the CG friction as $\\zeta_{\\mathrm{CG}}$ (Markovian). Assume identical PMF $F(x)$ for AA and CG. In the high-friction overdamped regime with a well at $x_{\\mathrm{m}}$ and a barrier at $x_{\\mathrm{b}}$, the MFPT $T$ scales linearly with the friction and exponentially with the barrier height, with a prefactor determined by the local curvatures $F''(x_{\\mathrm{m}})$ and $F''(x_{\\mathrm{b}})$.\n\nYour task is to:\n1. Derive, from the fundamental base outlined above, an expression for the time rescaling factor $\\alpha$ that must be applied to the CG dynamics so that the MFPT over the PMF barrier matches that of the AA dynamics. Express $\\alpha$ in terms of $\\zeta_{0}$, $\\zeta_{\\mathrm{CG}}$, and $\\int_{0}^{\\infty} K(t)\\,dt$.\n2. Implement a program that, for each provided test case, computes $\\alpha$ by:\n   - Computing the integrated memory $\\int_{0}^{\\infty} K(t)\\,dt$ for the given $K(t)$,\n   - Computing $\\zeta_{\\mathrm{eff}} = \\zeta_{0} + \\int_{0}^{\\infty} K(t)\\,dt$,\n   - Matching MFPTs to obtain $\\alpha$.\n3. For verification, your implementation should also compute the AA and CG MFPTs using the overdamped high-friction Kramers scaling with the same PMF barrier and curvatures, and confirm that the ratio of MFPTs equals $\\alpha$. The MFPTs must be expressed in seconds.\n\nUnits and definitions:\n- Temperature $T$ is given in Kelvin, Boltzmann constant $k_{\\mathrm{B}}$ is $1.380649 \\times 10^{-23}$ Joules per Kelvin.\n- Barrier height is specified as a multiple of thermal energy: $\\Delta F = n \\, k_{\\mathrm{B}} T$ in Joules.\n- Curvatures $F''(x_{\\mathrm{m}})$ and $F''(x_{\\mathrm{b}})$ are given in $\\mathrm{kg/s^{2}}$, with $F''(x_{\\mathrm{b}}) < 0$; use $|F''(x_{\\mathrm{b}})|$ where appropriate.\n- Frictions $\\zeta_{\\mathrm{CG}}$ and $\\zeta_{0}$ are in $\\mathrm{kg/s}$.\n- The memory kernel is provided as a sum of exponentials $K(t) = \\sum_{i} a_{i} e^{-t/\\tau_{i}}$ with amplitudes $a_{i}$ in $\\mathrm{kg/s^{2}}$ and timescales $\\tau_{i}$ in $\\mathrm{s}$.\n\nTest suite:\nProvide computations for the following five test cases, each specified as a tuple $(T, n, F''(x_{\\mathrm{m}}), F''(x_{\\mathrm{b}}), \\zeta_{\\mathrm{CG}}, \\zeta_{0}, \\{(a_{i}, \\tau_{i})\\}_{i})$:\n- Case $1$: $T = 300$, $n = 12$, $F''(x_{\\mathrm{m}}) = 2.0$, $F''(x_{\\mathrm{b}}) = -3.0$, $\\zeta_{\\mathrm{CG}} = 1.0$, $\\zeta_{0} = 0.7$, memory terms $\\{(0.3, 2.0)\\}$.\n- Case $2$: $T = 300$, $n = 8$, $F''(x_{\\mathrm{m}}) = 1.2$, $F''(x_{\\mathrm{b}}) = -1.8$, $\\zeta_{\\mathrm{CG}} = 1.0$, $\\zeta_{0} = 1.0$, memory terms $\\{\\}$.\n- Case $3$: $T = 310$, $n = 15$, $F''(x_{\\mathrm{m}}) = 2.5$, $F''(x_{\\mathrm{b}}) = -2.0$, $\\zeta_{\\mathrm{CG}} = 0.9$, $\\zeta_{0} = 0.6$, memory terms $\\{(0.5, 0.5), (0.2, 3.0)\\}$.\n- Case $4$: $T = 280$, $n = 10$, $F''(x_{\\mathrm{m}}) = 1.0$, $F''(x_{\\mathrm{b}}) = -4.0$, $\\zeta_{\\mathrm{CG}} = 0.8$, $\\zeta_{0} = 0.8$, memory terms $\\{(50.0, 0.01)\\}$.\n- Case $5$: $T = 300$, $n = 20$, $F''(x_{\\mathrm{m}}) = 3.0$, $F''(x_{\\mathrm{b}}) = -6.0$, $\\zeta_{\\mathrm{CG}} = 1.5$, $\\zeta_{0} = 0.4$, memory terms $\\{(0.6, 1.0)\\}$.\n\nOutput specification:\n- For each test case, compute the time rescaling factor $\\alpha$ as a floating-point number.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, with each $\\alpha$ rounded to six decimal places (for example, $[1.234567,0.500000,2.000000]$).", "solution": "The central task is to determine the time-rescaling factor, $\\alpha$, that aligns the kinetics of a coarse-grained (CG) model with its corresponding all-atom (AA) parent model for a one-dimensional barrier-crossing process. The alignment requires that the mean first-passage time (MFPT) over a potential of mean force (PMF) barrier is identical in the rescaled CG dynamics and the AA dynamics. The PMF, denoted by $F(x)$, is assumed to be identical for both representations.\n\nThe dynamics of the CG model are described by a simple, Markovian overdamped Langevin equation for the collective variable $x(t)$:\n$$\n\\zeta_{\\mathrm{CG}} \\frac{dx(t)}{dt} = -\\frac{dF(x)}{dx} + R_{\\mathrm{CG}}(t)\n$$\nHere, $\\zeta_{\\mathrm{CG}}$ is the constant (Markovian) friction coefficient of the CG model, and $R_{\\mathrm{CG}}(t)$ is a white-noise thermal force satisfying the fluctuation-dissipation theorem: $\\langle R_{\\mathrm{CG}}(t) R_{\\mathrm{CG}}(t') \\rangle = 2 k_{\\mathrm{B}} T \\zeta_{\\mathrm{CG}} \\delta(t-t')$, where $k_{\\mathrm{B}}$ is the Boltzmann constant and $T$ is the temperature.\n\nThe dynamics of the AA model are described by the more complex Generalized Langevin Equation (GLE) in the overdamped limit, which includes memory effects:\n$$\n\\zeta_{0} \\frac{dx(t)}{dt} + \\int_{0}^{t} K(t-t') \\frac{dx(t')}{dt'} dt' = -\\frac{dF(x)}{dx} + R_{\\mathrm{AA}}(t)\n$$\nIn this equation, $\\zeta_{0}$ is the instantaneous friction component, and $K(t)$ is the memory kernel that accounts for time-correlated forces arising from the integrated-out degrees of freedom. The term $R_{\\mathrm{AA}}(t)$ represents the thermal noise, which is related to $\\zeta_0$ and $K(t)$ via the second fluctuation-dissipation theorem.\n\nFor slow processes such as the crossing of a high potential barrier, the velocity $\\frac{dx}{dt}$ changes on a timescale much longer than the decay time of the memory kernel $K(t)$. This allows for the so-called zero-frequency approximation, where the velocity $\\frac{dx(t')}{dt'}$ can be treated as constant over the duration of the memory integral and pulled out:\n$$\n\\int_{0}^{t} K(t-t') \\frac{dx(t')}{dt'} dt' \\approx \\frac{dx(t)}{dt} \\int_{0}^{t} K(\\tau) d\\tau\n$$\nFor a process that has been evolving for a long time, the upper limit of the integral can be extended to infinity. This simplifies the GLE to an effective Markovian Langevin equation:\n$$\n\\left( \\zeta_{0} + \\int_{0}^{\\infty} K(\\tau) d\\tau \\right) \\frac{dx(t)}{dt} \\approx -\\frac{dF(x)}{dx} + R_{\\mathrm{AA}}(t)\n$$\nThis equation has the same form as the simple Langevin equation, but with an effective friction coefficient $\\zeta_{\\mathrm{eff}}$ given by:\n$$\n\\zeta_{\\mathrm{eff}} = \\zeta_{0} + \\int_{0}^{\\infty} K(t) dt\n$$\nThe problem specifies the memory kernel as a sum of exponentials: $K(t) = \\sum_{i} a_{i} e^{-t/\\tau_{i}}$. The integral can be calculated analytically:\n$$\n\\int_{0}^{\\infty} K(t) dt = \\int_{0}^{\\infty} \\sum_{i} a_{i} e^{-t/\\tau_{i}} dt = \\sum_{i} a_{i} \\int_{0}^{\\infty} e^{-t/\\tau_{i}} dt\n$$\nThe integral of each exponential term is $\\int_{0}^{\\infty} e^{-t/\\tau_{i}} dt = [-\\tau_i e^{-t/\\tau_i}]_0^{\\infty} = \\tau_i$. Therefore, the integrated memory is:\n$$\n\\int_{0}^{\\infty} K(t) dt = \\sum_{i} a_{i} \\tau_{i}\n$$\nAnd the effective friction for the AA model is $\\zeta_{\\mathrm{eff}} = \\zeta_{0} + \\sum_{i} a_{i} \\tau_{i}$.\n\nThe MFPT for escaping a potential well over a barrier in the high-friction (overdamped) limit is given by Kramers' theory. For a potential well at $x_{\\mathrm{m}}$ and a barrier at $x_{\\mathrm{b}}$, the MFPT, $T_{\\mathrm{MFPT}}$, is:\n$$\nT_{\\mathrm{MFPT}} = \\frac{2 \\pi \\zeta}{\\sqrt{F''(x_{\\mathrm{m}}) |F''(x_{\\mathrm{b}})|}} \\exp\\left(\\frac{\\Delta F}{k_{\\mathrm{B}} T}\\right)\n$$\nwhere $\\zeta$ is the relevant friction coefficient, $\\Delta F$ is the barrier height, and $F''(x_{\\mathrm{m}})$ and $F''(x_{\\mathrm{b}})$ are the curvatures of the PMF at the minimum and barrier top, respectively.\n\nApplying this formula to our two models, we get the MFPT for the AA system using its effective friction $\\zeta_{\\mathrm{eff}}$:\n$$\nT_{\\mathrm{MFPT, AA}} = \\frac{2 \\pi \\zeta_{\\mathrm{eff}}}{\\sqrt{F''(x_{\\mathrm{m}}) |F''(x_{\\mathrm{b}})|}} \\exp\\left(\\frac{\\Delta F}{k_{\\mathrm{B}} T}\\right)\n$$\nAnd for the CG system, using its friction $\\zeta_{\\mathrm{CG}}$:\n$$\nT_{\\mathrm{MFPT, CG}} = \\frac{2 \\pi \\zeta_{\\mathrm{CG}}}{\\sqrt{F''(x_{\\mathrm{m}}) |F''(x_{\\mathrm{b}})|}} \\exp\\left(\\frac{\\Delta F}{k_{\\mathrm{B}} T}\\right)\n$$\nThe time rescaling factor $\\alpha$ relates the time in the AA simulation ($t_{\\mathrm{AA}}$) to the time in the CG simulation ($t_{\\mathrm{CG}}$) via $t_{\\mathrm{AA}} = \\alpha \\cdot t_{\\mathrm{CG}}$. To match the kinetics, the physical time to cross the barrier must be the same. The physical time for the AA system is $T_{\\mathrm{MFPT, AA}}$. The physical time corresponding to the CG simulation event is $\\alpha \\cdot T_{\\mathrm{MFPT, CG}}$. Setting them equal gives:\n$$\nT_{\\mathrm{MFPT, AA}} = \\alpha \\cdot T_{\\mathrm{MFPT, CG}}\n$$\nWe can now solve for $\\alpha$:\n$$\n\\alpha = \\frac{T_{\\mathrm{MFPT, AA}}}{T_{\\mathrm{MFPT, CG}}} = \\frac{\\frac{2 \\pi \\zeta_{\\mathrm{eff}}}{\\sqrt{F''(x_{\\mathrm{m}}) |F''(x_{\\mathrm{b}})|}} \\exp\\left(\\frac{\\Delta F}{k_{\\mathrm{B}} T}\\right)}{\\frac{2 \\pi \\zeta_{\\mathrm{CG}}}{\\sqrt{F''(x_{\\mathrm{m}}) |F''(x_{\\mathrm{b}})|}} \\exp\\left(\\frac{\\Delta F}{k_{\\mathrm{B}} T}\\right)}\n$$\nSince the PMF ($F(x)$) is the same for both models, the terms involving the barrier height $\\Delta F$ and the curvatures $F''$ cancel out completely, leaving a simple ratio of the friction coefficients:\n$$\n\\alpha = \\frac{\\zeta_{\\mathrm{eff}}}{\\zeta_{\\mathrm{CG}}}\n$$\nSubstituting the derived expression for $\\zeta_{\\mathrm{eff}}$:\n$$\n\\alpha = \\frac{\\zeta_{0} + \\sum_{i} a_{i} \\tau_{i}}{\\zeta_{\\mathrm{CG}}}\n$$\nThis is the final expression used for the computation. The program will calculate $\\sum_{i} a_{i} \\tau_{i}$ for each case, determine $\\zeta_{\\mathrm{eff}}$, and then compute $\\alpha$. The computation of the full MFPTs is performed as a verification step, confirming that their ratio indeed equals $\\alpha$.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the time rescaling factor alpha for five test cases based on\n    the principles of coarse-grained modeling and barrier-crossing kinetics.\n    \"\"\"\n    \n    # Define physical constants\n    K_B = 1.380649e-23  # Boltzmann constant in J/K\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (T, n, F_ddot_m, F_ddot_b, zeta_cg, zeta_0, memory_terms)\n    # where memory_terms is a list of (a_i, tau_i) tuples.\n    test_cases = [\n        (300, 12, 2.0, -3.0, 1.0, 0.7, [(0.3, 2.0)]),\n        (300, 8, 1.2, -1.8, 1.0, 1.0, []),\n        (310, 15, 2.5, -2.0, 0.9, 0.6, [(0.5, 0.5), (0.2, 3.0)]),\n        (280, 10, 1.0, -4.0, 0.8, 0.8, [(50.0, 0.01)]),\n        (300, 20, 3.0, -6.0, 1.5, 0.4, [(0.6, 1.0)]),\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        T, n, F_ddot_m, F_ddot_b, zeta_cg, zeta_0, memory_terms = case\n\n        # 1. Compute the integrated memory kernel\n        # integral(K(t) dt) = sum(a_i * tau_i)\n        integrated_memory = sum(a * tau for a, tau in memory_terms)\n\n        # 2. Compute the AA effective friction\n        zeta_eff = zeta_0 + integrated_memory\n\n        # 3. Match MFPTs to obtain alpha\n        # alpha = T_MFPT_AA / T_MFPT_CG = zeta_eff / zeta_cg\n        alpha = zeta_eff / zeta_cg\n        \n        results.append(alpha)\n\n        # 4. Verification step (as required by the problem statement)\n        # This part computes the MFPTs explicitly to confirm the ratio is alpha.\n        # These values are not part of the final output but are computed for validation.\n        \n        # PMF barrier height in Joules\n        delta_F = n * K_B * T\n        \n        # Geometric prefactor component (same for AA and CG)\n        # Note: F_ddot_b is negative.\n        geometric_factor = np.sqrt(F_ddot_m * abs(F_ddot_b))\n        \n        # Exponential term (same for AA and CG)\n        # Note: delta_F / (K_B * T) simply equals n\n        exp_term = np.exp(n)\n        \n        # Common factor in MFPT expression\n        common_mfpt_factor = (2 * np.pi / geometric_factor) * exp_term\n\n        # Calculate MFPT for AA and CG systems\n        T_mfpt_aa = common_mfpt_factor * zeta_eff\n        T_mfpt_cg = common_mfpt_factor * zeta_cg\n\n        # Confirm that the ratio of MFPTs equals alpha\n        # This confirms the correctness of the derivation and implementation.\n        # A small tolerance is used due to potential floating-point inaccuracies.\n        assert np.isclose(alpha, T_mfpt_aa / T_mfpt_cg), \"Verification failed: alpha != T_aa / T_cg\"\n        \n    # Format the results into the required string format\n    # Each alpha is rounded to six decimal places.\n    output_str = f\"[{','.join([f'{res:.6f}' for res in results])}]\"\n    \n    # Final print statement in the exact required format.\n    print(output_str)\n\nsolve()\n```", "id": "3402208"}]}