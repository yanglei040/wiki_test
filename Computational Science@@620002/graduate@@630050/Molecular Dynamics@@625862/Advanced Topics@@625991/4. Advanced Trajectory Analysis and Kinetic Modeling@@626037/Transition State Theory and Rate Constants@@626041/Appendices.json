{"hands_on_practices": [{"introduction": "Transition State Theory provides a powerful bridge between the microscopic details of a molecular system and its macroscopic reaction rate. This first practice exercise puts the theory to work by simulating a common workflow in computational chemistry: calculating a rate constant from data generated by molecular dynamics simulations. You will use a pre-computed potential of mean force (PMF) to determine the free energy barrier, $\\Delta F^\\ddagger$, and statistics of atomic velocities at the barrier top to find the kinetic prefactor, demonstrating how these two key components combine to yield the TST rate constant, $k_{\\mathrm{TST}}$ [@problem_id:3458168].", "problem": "You are asked to design a complete, runnable program that computes a transition state theory rate constant and validates it against an unbiased molecular dynamics measurement using data that emulates umbrella-sampling and constrained-velocity statistics. The derivation must start from fundamental principles of statistical mechanics and dynamics appropriate for molecular dynamics and transition state theory, and the algorithm must implement the derived expression without shortcut formulas provided in the statement. The program must implement the following steps for each test case: infer a barrier height from a one-dimensional potential of mean force, compute a constrained average of the absolute velocity at the dividing surface, and use equilibrium statistical mechanics to obtain a rate constant which is then compared to an observed rate from unbiased dynamics data. The objective is to test reasoning from first principles by deriving why a flux-based estimate relates the constrained velocity statistics and the equilibrium barrier height to a rate constant.\n\nDefine the reaction coordinate as a single, dimensionless coordinate $s$ with a discrete grid $s_i$ and a potential of mean force $F(s_i)$ in kilojoules per mole. The dividing surface is located at the barrier top along $s$. The temperature $T$ is specified in kelvin. The constrained-velocity statistics at the dividing surface is provided as samples of $\\dot{s}$ in inverse seconds collected while maintaining $s$ at the dividing surface. The unbiased molecular dynamics rate is inferred from an integer transition count over a total simulation time in seconds. All quantities are to be treated in a scientifically self-consistent manner.\n\nUse the universal gas constant $R$ in kilojoules per mole per kelvin, specifically $R = 8.314462618 \\times 10^{-3}$, so that the inverse thermal energy is $\\beta = 1 / (R T)$ when $F$ is a molar free energy in kilojoules per mole. The rate constant must be expressed in inverse seconds.\n\nYour program must implement the following steps for each test case:\n- Identify the dividing surface location $s^\\ddagger$ as the grid point with the maximum $F(s)$ over the provided grid.\n- Identify the reactant basin reference location $s_{\\mathrm{R}}$ as the grid point with the minimum $F(s)$ among those with $s \\leq s_{\\mathrm{cut}}$, where $s_{\\mathrm{cut}}$ is a supplied threshold that isolates the reactant side.\n- Compute the barrier height $\\Delta F^\\ddagger = F(s^\\ddagger) - F(s_{\\mathrm{R}})$ in kilojoules per mole.\n- Compute the constrained average of the absolute velocity at the dividing surface $\\langle |\\dot{s}| \\rangle^\\ddagger$ as the arithmetic mean of the absolute values of the provided $\\dot{s}$ samples in inverse seconds:\n$$\n\\langle |\\dot{s}| \\rangle^\\ddagger = \\frac{1}{N} \\sum_{j=1}^{N} \\left| \\dot{s}_j \\right| .\n$$\n- Using equilibrium statistical mechanics and the flux interpretation of the rate across the dividing surface, derive the transition state theory estimate for the rate constant in inverse seconds. Implement the resulting expression in your program using only the above computed quantities and fundamental constants, with $F$ treated as a molar free energy and $\\beta = 1 / (R T)$.\n- Compute the unbiased molecular dynamics rate $k_{\\mathrm{MD}}$ in inverse seconds as the observed integer transition count divided by the total simulation time in seconds.\n- Validate the transition state theory result against the unbiased molecular dynamics result by checking whether the absolute relative difference is at most a specified tolerance $\\varepsilon$ expressed as a decimal:\n$$\n\\left| \\frac{k_{\\mathrm{TST}} - k_{\\mathrm{MD}}}{k_{\\mathrm{MD}}} \\right| \\leq \\varepsilon .\n$$\n\nUnits and output requirements:\n- All rate constants must be in inverse seconds.\n- All energies must be in kilojoules per mole.\n- All velocities $\\dot{s}$ must be in inverse seconds.\n- All times must be in seconds.\n- Angles do not appear in this problem.\n- The validation tolerance is provided as a decimal.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element corresponds to one test case and is itself a list of three elements in the order $[k_{\\mathrm{TST}}, k_{\\mathrm{MD}}, \\text{pass}]$. For example, the output must have the shape $[[x_1,y_1,b_1],[x_2,y_2,b_2],[x_3,y_3,b_3]]$ with $x_i$ and $y_i$ floats and $b_i$ booleans.\n\nTest suite specification:\n- Use $R = 8.314462618 \\times 10^{-3}$ in kilojoules per mole per kelvin.\n- Tolerance $\\varepsilon = 0.1$.\n\nTest case $1$ (happy path, moderate barrier):\n- Temperature $T = 300$ kelvin.\n- Reactant-side cutoff $s_{\\mathrm{cut}} = -0.5$.\n- Grid $s$ values:\n$[-1.0, -0.8, -0.6, -0.4, -0.2, 0.0, 0.2, 0.4, 0.6, 0.8, 1.0]$.\n- Potential of mean force $F(s)$ in kilojoules per mole:\n$[2.0, 1.0, 0.0, 1.5, 6.0, 10.0, 6.0, 1.5, 0.5, 0.8, 1.8]$.\n- Constrained velocity samples at the dividing surface in inverse seconds:\n$[-8.0 \\times 10^{11}, 1.2 \\times 10^{12}, -5.5 \\times 10^{11}, 6.0 \\times 10^{11}, -1.0 \\times 10^{11}, 9.0 \\times 10^{11}, -1.1 \\times 10^{12}, 7.0 \\times 10^{11}, 3.0 \\times 10^{11}, -4.0 \\times 10^{11}]$.\n- Unbiased molecular dynamics observed transition count $= 3463$, total simulation time $= 5.0 \\times 10^{-7}$ seconds.\n\nTest case $2$ (boundary case, nearly barrierless):\n- Temperature $T = 300$ kelvin.\n- Reactant-side cutoff $s_{\\mathrm{cut}} = -0.5$.\n- Grid $s$ values:\n$[-1.0, -0.8, -0.6, -0.4, -0.2, 0.0, 0.2, 0.4, 0.6, 0.8, 1.0]$.\n- Potential of mean force $F(s)$ in kilojoules per mole:\n$[0.2, 0.1, 0.0, 0.1, 0.3, 0.5, 0.3, 0.1, 0.05, 0.08, 0.15]$.\n- Constrained velocity samples at the dividing surface in inverse seconds:\n$[-4.0 \\times 10^{11}, 6.0 \\times 10^{11}, -3.0 \\times 10^{11}, 5.5 \\times 10^{11}, -2.0 \\times 10^{11}, 5.0 \\times 10^{11}, -4.5 \\times 10^{11}, 4.0 \\times 10^{11}, 3.5 \\times 10^{11}, -3.2 \\times 10^{11}]$.\n- Unbiased molecular dynamics observed transition count $= 1665$, total simulation time $= 1.0 \\times 10^{-8}$ seconds.\n\nTest case $3$ (edge case, large barrier):\n- Temperature $T = 300$ kelvin.\n- Reactant-side cutoff $s_{\\mathrm{cut}} = -0.5$.\n- Grid $s$ values:\n$[-1.0, -0.8, -0.6, -0.4, -0.2, 0.0, 0.2, 0.4, 0.6, 0.8, 1.0]$.\n- Potential of mean force $F(s)$ in kilojoules per mole:\n$[4.0, 2.5, 0.0, 5.0, 15.0, 25.0, 15.0, 6.0, 3.0, 2.0, 3.5]$.\n- Constrained velocity samples at the dividing surface in inverse seconds:\n$[-9.0 \\times 10^{11}, 1.0 \\times 10^{12}, -7.5 \\times 10^{11}, 8.0 \\times 10^{11}, -6.0 \\times 10^{11}, 9.0 \\times 10^{11}, -1.1 \\times 10^{12}, 7.0 \\times 10^{11}, 5.0 \\times 10^{11}, -8.0 \\times 10^{11}]$.\n- Unbiased molecular dynamics observed transition count $= 179$, total simulation time $= 1.0 \\times 10^{-5}$ seconds.\n\nYour program should produce a single line of output containing a list of results for the three test cases in the exact format:\n$[[k_{\\mathrm{TST}}^{(1)}, k_{\\mathrm{MD}}^{(1)}, \\text{pass}^{(1)}],[k_{\\mathrm{TST}}^{(2)}, k_{\\mathrm{MD}}^{(2)}, \\text{pass}^{(2)}],[k_{\\mathrm{TST}}^{(3)}, k_{\\mathrm{MD}}^{(3)}, \\text{pass}^{(3)}]]$,\nwhere each $k$ is a float in inverse seconds and each $\\text{pass}$ is a boolean.", "solution": "The problem requires the derivation and implementation of a formula for the transition state theory (TST) rate constant, $k_{\\mathrm{TST}}$, using provided data from molecular simulations, and its validation against a direct molecular dynamics (MD) rate, $k_{\\mathrm{MD}}$. The derivation must be grounded in fundamental principles of statistical mechanics and dynamics.\n\nThe TST rate constant for a reaction describes the rate of population flow from a reactant state to a product state. In its common formulation, it is expressed as the product of an equilibrium constant for the formation of the transition state from reactants, $K^\\ddagger$, and a frequency factor, $\\nu$, that characterizes the rate of passage over the transition state barrier.\n$$\nk_{\\mathrm{TST}} = \\nu K^\\ddagger\n$$\nThis expression partitions the problem into an equilibrium component (statistical mechanics) and a dynamical component (kinetics).\n\nFirst, we address the equilibrium constant, $K^\\ddagger$. In statistical mechanics, for a reaction $R \\rightleftharpoons TS$ where $TS$ represents the transition state, the equilibrium constant is related to the change in the standard Gibbs free energy, $\\Delta G^\\ddagger$, or, in this context, the potential of mean force (PMF), $\\Delta F^\\ddagger$. The PMF, $F(s)$, represents the free energy of the system as a function of the reaction coordinate $s$. The equilibrium constant is given by:\n$$\nK^\\ddagger = \\frac{[TS]}{[R]} = e^{-\\Delta F^\\ddagger / (RT)} = e^{-\\beta \\Delta F^\\ddagger}\n$$\nHere, $[TS]$ and $[R]$ are the populations or partition functions of the transition state and reactant state, respectively. The term $\\Delta F^\\ddagger$ is the free energy barrier, calculated as the difference between the PMF at the transition state (the dividing surface, $s^\\ddagger$) and the PMF at the reactant state minimum ($s_R$). The problem provides the means to compute this directly.\n$$\n\\Delta F^\\ddagger = F(s^\\ddagger) - F(s_R)\n$$\nThe value $s^\\ddagger$ is the location of the maximum of $F(s)$, and $s_R$ is the location of the minimum of $F(s)$ in the reactant basin. The inverse thermal energy is $\\beta = 1/(RT)$, where $R$ is the molar gas constant, consistent with $F(s)$ being a molar free energy in $\\text{kJ/mol}$.\n\nNext, we must determine the frequency factor, $\\nu$, representing the rate of crossing the dividing surface for a system that has reached the transition state. The problem provides constrained-velocity samples, $\\dot{s}_j$, at the dividing surface $s^\\ddagger$. The reaction coordinate $s$ is dimensionless, so its time derivative, $\\dot{s}$, has units of inverse time ($s^{-1}$), which is a frequency. The one-way flux from reactants to products depends on the average velocity of systems moving in the forward direction ($\\dot{s} > 0$). This average forward velocity is denoted $\\langle \\dot{s} \\rangle_{\\dot{s}>0}^\\ddagger$. This quantity can be interpreted as the characteristic frequency for a system at the transition state to successfully cross into the product basin. Therefore, we identify $\\nu = \\langle \\dot{s} \\rangle_{\\dot{s}>0}^\\ddagger$.\n\nThe problem supplies samples of $\\dot{s}$ at $s^\\ddagger$ from which we can compute the constrained average of the absolute velocity, $\\langle |\\dot{s}| \\rangle^\\ddagger$. At the transition state, which is a point of unstable equilibrium, we assume there is no net flux, meaning the velocity distribution is symmetric around $\\dot{s}=0$. Consequently, the average forward velocity is half of the average speed:\n$$\n\\langle \\dot{s} \\rangle_{\\dot{s}>0}^\\ddagger = \\frac{1}{2} \\langle |\\dot{s}| \\rangle^\\ddagger\n$$\nwhere $\\langle |\\dot{s}| \\rangle^\\ddagger$ is computed as the arithmetic mean of the absolute values of the velocity samples:\n$$\n\\langle |\\dot{s}| \\rangle^\\ddagger = \\frac{1}{N} \\sum_{j=1}^{N} \\left| \\dot{s}_j \\right|\n$$\n\nBy combining these components, we arrive at the final expression for the TST rate constant, which connects the provided equilibrium and dynamical quantities as requested:\n$$\nk_{\\mathrm{TST}} = \\nu K^\\ddagger = \\left( \\frac{1}{2} \\langle |\\dot{s}| \\rangle^\\ddagger \\right) e^{-\\beta \\Delta F^\\ddagger}\n$$\nThis formula is dimensionally consistent, with $k_{\\mathrm{TST}}$ having units of $s^{-1}$, and it utilizes exclusively the quantities derived from the problem's input data: the barrier height $\\Delta F^\\ddagger$ and the average absolute velocity at the dividing surface $\\langle |\\dot{s}| \\rangle^\\ddagger$.\n\nThe algorithm implemented in the program proceeds as follows for each test case:\n1.  The value of $\\beta = 1/(RT)$ is computed using the given temperature $T$ and gas constant $R$.\n2.  The potential of mean force grid $F(s)$ is scanned to find its maximum value. The corresponding coordinate and energy are identified as $s^\\ddagger$ and $F(s^\\ddagger)$.\n3.  The reactant portion of the grid ($s \\leq s_{\\mathrm{cut}}$) is scanned to find the minimum value of $F(s)$. This defines the reactant reference state with coordinate $s_R$ and energy $F(s_R)$.\n4.  The free energy barrier is calculated as $\\Delta F^\\ddagger = F(s^\\ddagger) - F(s_R)$.\n5.  The constrained average absolute velocity, $\\langle |\\dot{s}| \\rangle^\\ddagger$, is computed from the provided velocity samples.\n6.  The TST rate constant, $k_{\\mathrm{TST}}$, is calculated using the derived formula: $k_{\\mathrm{TST}} = \\frac{1}{2} \\langle |\\dot{s}| \\rangle^\\ddagger e^{-\\beta \\Delta F^\\ddagger}$.\n7.  The unbiased molecular dynamics rate, $k_{\\mathrm{MD}}$, is calculated as the total number of observed transitions divided by the total simulation time.\n8.  Finally, the TST rate is validated against the MD rate by checking if the absolute relative difference is within the tolerance $\\varepsilon=0.1$: $|\\frac{k_{\\mathrm{TST}} - k_{\\mathrm{MD}}}{k_{\\mathrm{MD}}}| \\leq \\varepsilon$.\nThe results, comprising $k_{\\mathrm{TST}}$, $k_{\\mathrm{MD}}$, and a boolean indicating the validation outcome, are collected for all test cases and formatted into the required output.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes and validates TST rate constants against MD measurements.\n    \"\"\"\n    # Universal gas constant in kJ/(mol·K)\n    R = 8.314462618e-3\n    # Validation tolerance\n    TOLERANCE = 0.1\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"T\": 300,  # Kelvin\n            \"s_cut\": -0.5,\n            \"s_grid\": [-1.0, -0.8, -0.6, -0.4, -0.2, 0.0, 0.2, 0.4, 0.6, 0.8, 1.0],\n            \"F_s\": [2.0, 1.0, 0.0, 1.5, 6.0, 10.0, 6.0, 1.5, 0.5, 0.8, 1.8],  # kJ/mol\n            \"s_dot_samples\": [-8.0e11, 1.2e12, -5.5e11, 6.0e11, -1.0e11, 9.0e11, -1.1e12, 7.0e11, 3.0e11, -4.0e11],  # s^-1\n            \"md_transitions\": 3463,\n            \"md_time\": 5.0e-7  # seconds\n        },\n        {\n            \"T\": 300,\n            \"s_cut\": -0.5,\n            \"s_grid\": [-1.0, -0.8, -0.6, -0.4, -0.2, 0.0, 0.2, 0.4, 0.6, 0.8, 1.0],\n            \"F_s\": [0.2, 0.1, 0.0, 0.1, 0.3, 0.5, 0.3, 0.1, 0.05, 0.08, 0.15],\n            \"s_dot_samples\": [-4.0e11, 6.0e11, -3.0e11, 5.5e11, -2.0e11, 5.0e11, -4.5e11, 4.0e11, 3.5e11, -3.2e11],\n            \"md_transitions\": 1665,\n            \"md_time\": 1.0e-8\n        },\n        {\n            \"T\": 300,\n            \"s_cut\": -0.5,\n            \"s_grid\": [-1.0, -0.8, -0.6, -0.4, -0.2, 0.0, 0.2, 0.4, 0.6, 0.8, 1.0],\n            \"F_s\": [4.0, 2.5, 0.0, 5.0, 15.0, 25.0, 15.0, 6.0, 3.0, 2.0, 3.5],\n            \"s_dot_samples\": [-9.0e11, 1.0e12, -7.5e11, 8.0e11, -6.0e11, 9.0e11, -1.1e12, 7.0e11, 5.0e11, -8.0e11],\n            \"md_transitions\": 179,\n            \"md_time\": 1.0e-5\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        # Extract data for the current case\n        T = case[\"T\"]\n        s_cut = case[\"s_cut\"]\n        s_grid = np.array(case[\"s_grid\"])\n        F_s = np.array(case[\"F_s\"])\n        s_dot_samples = np.array(case[\"s_dot_samples\"])\n        md_transitions = case[\"md_transitions\"]\n        md_time = case[\"md_time\"]\n\n        # Step 1: Compute inverse thermal energy\n        beta = 1.0 / (R * T)  # (mol/kJ)\n\n        # Step 2: Identify dividing surface (transition state)\n        idx_ts = np.argmax(F_s)\n        F_ts = F_s[idx_ts]\n\n        # Step 3: Identify reactant basin reference\n        reactant_mask = s_grid <= s_cut\n        F_s_reactant_side = F_s[reactant_mask]\n        idx_r_local = np.argmin(F_s_reactant_side)\n        F_r = F_s_reactant_side[idx_r_local]\n        \n        # Step 4: Compute the barrier height\n        delta_F_ddagger = F_ts - F_r  # kJ/mol\n\n        # Step 5: Compute the constrained average of the absolute velocity\n        avg_abs_s_dot_ddagger = np.mean(np.abs(s_dot_samples))  # s^-1\n\n        # Step 6: Compute the TST rate constant\n        # k_TST = (1/2) * <|s_dot|`> * exp(-beta * dF`)\n        k_tst = 0.5 * avg_abs_s_dot_ddagger * np.exp(-beta * delta_F_ddagger)\n\n        # Step 7: Compute the unbiased molecular dynamics rate\n        k_md = md_transitions / md_time\n\n        # Step 8: Validate TST result against MD result\n        if k_md == 0:\n            # Avoid division by zero, though not expected for these test cases.\n            # If MD rate is zero, TST rate should also be zero for a match.\n            validation_passed = (k_tst == 0)\n        else:\n            rel_diff = np.abs((k_tst - k_md) / k_md)\n            validation_passed = rel_diff <= TOLERANCE\n            \n        results.append([k_tst, k_md, validation_passed])\n\n    # Final print statement in the exact required format.\n    # The format [[x1,y1,b1],[x2,y2,b2],...] requires converting Python list to string.\n    # Python's default str() for lists and booleans matches the requirement.\n    print(str(results).replace(\"'\", \"\"))\n\nsolve()\n\n```", "id": "3458168"}, {"introduction": "Having calculated a full rate constant, we now dissect the TST expression to better understand its components. This exercise focuses on the kinetic prefactor, which captures the dynamical character of barrier crossing and depends on the system's masses. By analytically solving a simple harmonic model, you will derive the concept of an 'effective mass', $m_{\\mathrm{eff}}$, along the reaction coordinate and verify the fundamental scaling relationship $k_{\\mathrm{TST}} \\propto 1/\\sqrt{m_{\\mathrm{eff}}}$, a principle that underlies phenomena such as kinetic isotope effects [@problem_id:3458183].", "problem": "Consider a classical system with $n=4$ Cartesian coordinates collected in the vector $\\mathbf{q}\\in\\mathbb{R}^4$. Define a linear reaction coordinate $s=\\hat{\\mathbf{a}}^\\top \\mathbf{q}$, where $\\hat{\\mathbf{a}}=\\mathbf{a}/\\lVert \\mathbf{a}\\rVert$ and $\\mathbf{a}=(1.0,-2.0,0.5,0.25)$. Complete $\\hat{\\mathbf{a}}$ to an orthonormal basis of $\\mathbb{R}^4$ to define transverse coordinates $\\mathbf{y}\\in\\mathbb{R}^3$ such that the orthogonal change of variables $\\mathbf{q}\\mapsto (s,\\mathbf{y})$ has unit Jacobian. The potential energy function is assumed to be separable in these coordinates and given by\n$$\nU(s,\\mathbf{y})=\\frac{1}{2}k_R\\,(s+s_0)^2+\\frac{1}{2}\\kappa_\\perp \\sum_{i=1}^{3} y_i^2,\n$$\nwith parameters $k_R=5.0$, $s_0=1.0$, and $\\kappa_\\perp=3.0$. The reactant region is defined by the indicator $h_R=\\Theta(-s)$ and the dividing surface by $s=0$, where $\\Theta(\\cdot)$ is the Heaviside step function. The system is coupled to a heat bath at absolute temperature $T=0.7$ in reduced units where the Boltzmann constant $k_B=1$ (that is, energies are in the same reduced unit as $k_B T$). The mass matrix in Cartesian coordinates is diagonal, $\\mathbf{M}=\\mathrm{diag}(m_1,m_2,m_3,m_4)$, with a base mass set $\\mathbf{m}^{(0)}=(1.0,2.0,3.0,4.0)$.\n\nYour task is to write a complete program that, starting from the canonical Transition State Theory (TST) definition of the rate constant as a phase-space average and from the Maxwell–Boltzmann statistics of velocities, performs the following steps:\n\n- Derive an expression for the effective mass along the reaction coordinate, $m_{\\mathrm{eff}}$, as a function of the mass matrix $\\mathbf{M}$ and the unit vector $\\hat{\\mathbf{a}}$.\n- Starting from the canonical TST definition with a delta-function constraint on the dividing surface and the characteristic function for the reactant region, derive a closed-form expression for the TST rate constant $k_{\\mathrm{TST}}$ for the given harmonic form of $U(s,\\mathbf{y})$.\n- Use these derivations to compute $k_{\\mathrm{TST}}$ and the barrier free energy $\\Delta F^\\ddagger$ defined by\n$$\n\\Delta F^\\ddagger = -T \\ln\\left(\\frac{\\int d\\mathbf{y}\\,e^{-U(0,\\mathbf{y})/T}}{\\int_{s<0} ds\\, d\\mathbf{y}\\,e^{-U(s,\\mathbf{y})/T}}\\right),\n$$\nfor multiple mass-scaling scenarios described below.\n\nScientific constraints and requirements:\n- Treat the canonical ensemble factorization of momentum and coordinate distributions as fundamental, and do not assume any result about $k_{\\mathrm{TST}}$ beyond what follows from this factorization and elementary Gaussian integrals.\n- The program must verify two properties for each mass-scaling case: (i) the $k_{\\mathrm{TST}}$ prefactor scales with the inverse square root of the effective mass along $s$ (that is, $k_{\\mathrm{TST}}\\propto \\sqrt{T/m_{\\mathrm{eff}}}$ at fixed potential and temperature), and (ii) the free-energy barrier $\\Delta F^\\ddagger$ is invariant under mass rescaling when the potential $U$ is unchanged.\n\nUse the following test suite of mass-scaling cases, each starting from the base mass vector $\\mathbf{m}^{(0)}$:\n- Case A (uniform scaling): multiply all masses by $\\alpha_A=0.5$.\n- Case B (single-coordinate scaling): multiply only the second mass by $\\alpha_B=4.0$ and leave the others unchanged.\n- Case C (uniform extreme scaling): multiply all masses by $\\alpha_C=10^6$.\n- Case D (uniform extreme scaling): multiply all masses by $\\alpha_D=10^{-6}$.\n\nFor each case $X\\in\\{A,B,C,D\\}$:\n- Compute the effective masses $m_{\\mathrm{eff}}^{(0)}$ (base) and $m_{\\mathrm{eff}}^{(X)}$ (scaled), and the corresponding TST rates $k_{\\mathrm{TST}}^{(0)}$ and $k_{\\mathrm{TST}}^{(X)}$, as well as $\\Delta F^{\\ddagger(0)}$ and $\\Delta F^{\\ddagger(X)}$.\n- Define a numerical tolerance $\\varepsilon=10^{-10}$.\n- Check the prefactor-scaling statement by verifying that\n$$\n\\left|\\frac{k_{\\mathrm{TST}}^{(X)}}{k_{\\mathrm{TST}}^{(0)}}-\\sqrt{\\frac{m_{\\mathrm{eff}}^{(0)}}{m_{\\mathrm{eff}}^{(X)}}}\\right|\\le \\varepsilon,\n$$\nand output a boolean for this check.\n- Check the mass-invariance of the barrier by verifying that\n$$\n\\left|\\Delta F^{\\ddagger(X)}-\\Delta F^{\\ddagger(0)}\\right|\\le \\varepsilon,\n$$\nand output a boolean for this check.\n\nAngle units are not involved. All internal computations are in the reduced unit system described above. The output must consist only of booleans, which are dimensionless.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, ordered as\n$$\n[\\text{prefactor\\_ok}^{(A)},\\text{barrier\\_ok}^{(A)},\\text{prefactor\\_ok}^{(B)},\\text{barrier\\_ok}^{(B)},\\text{prefactor\\_ok}^{(C)},\\text{barrier\\_ok}^{(C)},\\text{prefactor\\_ok}^{(D)},\\text{barrier\\_ok}^{(D)}].\n$$", "solution": "The problem requires the derivation and calculation of the Transition State Theory (TST) rate constant, $k_{\\mathrm{TST}}$, and the associated free-energy barrier, $\\Delta F^\\ddagger$, for a given classical system. The solution involves three primary theoretical steps followed by numerical computation and verification.\n\n### Theoretical Derivation\n\n#### 1. General Expression for the TST Rate Constant\n\nThe canonical TST rate constant, $k_{\\mathrm{TST}}$, is defined as the forward flux through the dividing surface $s=0$ normalized by the reactant population.\n$$\nk_{\\mathrm{TST}} = \\frac{\\text{Flux}_{\\text{forward}}(s=0)}{\\text{Population}_{\\text{reactants}}} = \\frac{\\langle \\delta(s) \\dot{s} \\Theta(\\dot{s}) \\rangle}{\\langle h_R \\rangle}\n$$\nwhere $\\langle \\cdot \\rangle$ denotes a canonical ensemble average, $s=\\hat{\\mathbf{a}}^\\top \\mathbf{q}$ is the reaction coordinate, $\\dot{s}$ is its time derivative, $\\delta(\\cdot)$ is the Dirac delta function, $\\Theta(\\cdot)$ is the Heaviside step function enforcing forward flux ($\\dot{s}>0$), and $h_R = \\Theta(-s)$ is the indicator function for the reactant region ($s<0$).\n\nThe Hamiltonian is separable, $H(\\mathbf{q}, \\mathbf{p}) = K(\\mathbf{p}) + U(\\mathbf{q})$, where $K(\\mathbf{p}) = \\frac{1}{2}\\mathbf{p}^\\top\\mathbf{M}^{-1}\\mathbf{p}$. Consequently, the ensemble average factorizes into momentum and coordinate parts.\n$$\nk_{\\mathrm{TST}} = \\frac{\\frac{1}{Z_p Z_q} \\left( \\int d\\mathbf{p} \\, \\dot{s} \\Theta(\\dot{s}) e^{-K(\\mathbf{p})/T} \\right) \\left( \\int d\\mathbf{q} \\, \\delta(s) e^{-U(\\mathbf{q})/T} \\right)}{\\frac{1}{Z_p Z_q} \\left( \\int d\\mathbf{p} \\, e^{-K(\\mathbf{p})/T} \\right) \\left( \\int d\\mathbf{q} \\, \\Theta(-s) e^{-U(\\mathbf{q})/T} \\right)}\n$$\nwhere $Z_p$ and $Z_q$ are the momentum and configuration partition functions, respectively, and the temperature $T$ is in units where $k_B=1$. This simplifies to a product of a kinetic prefactor and a configurational ratio:\n$$\nk_{\\mathrm{TST}} = \\left( \\frac{\\int d\\mathbf{p} \\, \\dot{s} \\Theta(\\dot{s}) e^{-K(\\mathbf{p})/T}}{\\int d\\mathbf{p} \\, e^{-K(\\mathbf{p})/T}} \\right) \\times \\left( \\frac{\\int d\\mathbf{q} \\, \\delta(s) e^{-U(\\mathbf{q})/T}}{\\int d\\mathbf{q} \\, \\Theta(-s) e^{-U(\\mathbf{q})/T}} \\right) = \\nu_{\\mathrm{kin}} \\times K_{\\mathrm{conf}}\n$$\n\n#### 2. Kinetic Prefactor ($\\nu_{\\mathrm{kin}}$) and Effective Mass ($m_{\\mathrm{eff}}$)\n\nThe velocity along the reaction coordinate is $\\dot{s} = \\hat{\\mathbf{a}}^\\top\\dot{\\mathbf{q}} = \\hat{\\mathbf{a}}^\\top\\mathbf{M}^{-1}\\mathbf{p}$. The Cartesian momenta $p_i$ are independent variables drawn from a Gaussian distribution with mean $0$ and variance $\\langle p_i^2 \\rangle = m_i T$. Therefore, $\\dot{s}$ is a Gaussian random variable with mean $\\langle \\dot{s} \\rangle = 0$ and variance:\n$$\n\\sigma_{\\dot{s}}^2 = \\langle \\dot{s}^2 \\rangle = \\langle (\\hat{\\mathbf{a}}^\\top\\mathbf{M}^{-1}\\mathbf{p})(\\mathbf{p}^\\top\\mathbf{M}^{-1}\\hat{\\mathbf{a}}) \\rangle = \\hat{\\mathbf{a}}^\\top\\mathbf{M}^{-1}\\langle \\mathbf{p}\\mathbf{p}^\\top \\rangle \\mathbf{M}^{-1}\\hat{\\mathbf{a}}\n$$\nSince $\\langle \\mathbf{p}\\mathbf{p}^\\top \\rangle = T\\mathbf{M}$, the variance is:\n$$\n\\sigma_{\\dot{s}}^2 = \\hat{\\mathbf{a}}^\\top\\mathbf{M}^{-1}(T\\mathbf{M})\\mathbf{M}^{-1}\\hat{\\mathbf{a}} = T(\\hat{\\mathbf{a}}^\\top\\mathbf{M}^{-1}\\hat{\\mathbf{a}})\n$$\nThe kinetic prefactor $\\nu_{\\mathrm{kin}} = \\langle \\dot{s} \\Theta(\\dot{s}) \\rangle_p$ is the average of positive velocities:\n$$\n\\nu_{\\mathrm{kin}} = \\int_0^\\infty \\dot{s} \\frac{1}{\\sqrt{2\\pi\\sigma_{\\dot{s}}^2}} e^{-\\dot{s}^2/(2\\sigma_{\\dot{s}}^2)} d\\dot{s} = \\frac{\\sigma_{\\dot{s}}}{\\sqrt{2\\pi}} = \\sqrt{\\frac{T}{2\\pi}} \\sqrt{\\hat{\\mathbf{a}}^\\top\\mathbf{M}^{-1}\\hat{\\mathbf{a}}}\n$$\nThe problem requires verifying that $k_{\\mathrm{TST}} \\propto \\sqrt{T/m_{\\mathrm{eff}}}$. Since $\\nu_{\\mathrm{kin}}$ is the only mass-dependent factor in $k_{\\mathrm{TST}}$, we identify the effective mass $m_{\\mathrm{eff}}$ such that $\\nu_{\\mathrm{kin}} = \\sqrt{T/(2\\pi m_{\\mathrm{eff}})}$. This implies $1/m_{\\mathrm{eff}} = \\hat{\\mathbf{a}}^\\top\\mathbf{M}^{-1}\\hat{\\mathbf{a}}$. The expression for the effective mass is thus:\n$$\nm_{\\mathrm{eff}} = \\left( \\hat{\\mathbf{a}}^\\top\\mathbf{M}^{-1}\\hat{\\mathbf{a}} \\right)^{-1} = \\left( \\sum_{i=1}^4 \\frac{\\hat{a}_i^2}{m_i} \\right)^{-1}\n$$\nwhere $\\hat{\\mathbf{a}} = \\mathbf{a}/\\lVert\\mathbf{a}\\rVert$ and $\\mathbf{M}=\\mathrm{diag}(m_1,m_2,m_3,m_4)$.\n\n#### 3. Configurational Ratio ($K_{\\mathrm{conf}}$) and Free Energy Barrier ($\\Delta F^\\ddagger$)\n\nWe use the orthogonal coordinate transformation $\\mathbf{q} \\to (s, \\mathbf{y})$ with unit Jacobian specified in the problem, so $d\\mathbf{q} = ds\\,d\\mathbf{y}$. The potential energy is separable: $U(s,\\mathbf{y})=U_s(s)+U_y(\\mathbf{y})$, with $U_s(s)=\\frac{1}{2}k_R(s+s_0)^2$ and $U_y(\\mathbf{y})=\\frac{1}{2}\\kappa_\\perp\\sum_{i=1}^3 y_i^2$.\n\nThe configurational ratio $K_{\\mathrm{conf}}$ becomes:\n$$\nK_{\\mathrm{conf}} = \\frac{\\int ds\\,d\\mathbf{y}\\,\\delta(s) e^{-(U_s(s)+U_y(\\mathbf{y}))/T}}{\\int ds\\,d\\mathbf{y}\\,\\Theta(-s) e^{-(U_s(s)+U_y(\\mathbf{y}))/T}} = \\frac{e^{-U_s(0)/T} \\int d\\mathbf{y}\\,e^{-U_y(\\mathbf{y})/T}}{(\\int_{-\\infty}^0 ds\\,e^{-U_s(s)/T}) (\\int d\\mathbf{y}\\,e^{-U_y(\\mathbf{y})/T})} = \\frac{e^{-U_s(0)/T}}{\\int_{-\\infty}^0 ds\\,e^{-U_s(s)/T}}\n$$\nSubstituting $U_s(s)$, we get $U_s(0) = \\frac{1}{2}k_R s_0^2$. The integral in the denominator is a truncated Gaussian integral:\n$$\n\\int_{-\\infty}^0 e^{-\\frac{k_R}{2T}(s+s_0)^2} ds = \\sqrt{\\frac{2\\pi T}{k_R}} \\frac{1}{2} \\left[1 + \\mathrm{erf}\\left(s_0\\sqrt{\\frac{k_R}{2T}}\\right)\\right]\n$$\nThe problem defines the free energy barrier as:\n$$\n\\Delta F^\\ddagger = -T \\ln\\left(\\frac{\\int d\\mathbf{y}\\,e^{-U(0,\\mathbf{y})/T}}{\\int_{s<0} ds\\, d\\mathbf{y}\\,e^{-U(s,\\mathbf{y})/T}}\\right)\n$$\nThis is precisely $-T \\ln(K_{\\mathrm{conf}})$. Thus, $\\Delta F^\\ddagger$ is purely dependent on the potential energy function and temperature, not on the masses. This confirms the expectation of mass-invariance.\n$$\n\\Delta F^\\ddagger = -T \\ln \\left( \\frac{e^{-k_R s_0^2 / (2T)}}{\\sqrt{\\frac{2\\pi T}{k_R}} \\frac{1}{2} \\left[1 + \\mathrm{erf}\\left(s_0\\sqrt{\\frac{k_R}{2T}}\\right)\\right]} \\right) = \\frac{k_R s_0^2}{2} + T \\ln\\left(\\sqrt{\\frac{2\\pi T}{k_R}} \\frac{1}{2} \\left[1 + \\mathrm{erf}\\left(s_0\\sqrt{\\frac{k_R}{2T}}\\right)\\right]\\right)\n$$\n\n### Final Expression for $k_{\\mathrm{TST}}$\n\nCombining the kinetic and configurational parts:\n$$\nk_{\\mathrm{TST}} = \\sqrt{\\frac{T}{2\\pi m_{\\mathrm{eff}}}} \\frac{e^{-k_R s_0^2 / (2T)}}{\\sqrt{\\frac{2\\pi T}{k_R}} \\frac{1}{2} \\left[1 + \\mathrm{erf}\\left(s_0\\sqrt{\\frac{k_R}{2T}}\\right)\\right]}\n$$\nSimplifying this expression yields:\n$$\nk_{\\mathrm{TST}} = \\frac{1}{2\\pi} \\sqrt{\\frac{k_R}{m_{\\mathrm{eff}}}} \\frac{e^{-k_R s_0^2 / (2T)}}{\\frac{1}{2} \\left[1 + \\mathrm{erf}\\left(s_0\\sqrt{\\frac{k_R}{2T}}\\right)\\right]}\n$$\nThis expression explicitly shows that $k_{\\mathrm{TST}} \\propto 1/\\sqrt{m_{\\mathrm{eff}}}$, confirming the scaling relationship to be tested.\n\nThese derived formulas will be implemented to compute the required quantities for the specified mass-scaling scenarios and verify the theoretical predictions.", "answer": "```python\nimport numpy as np\nfrom scipy.special import erf\n\ndef solve():\n    \"\"\"\n    Solves the transition state theory problem by deriving and computing\n    the rate constant and free energy barrier for various mass-scaling scenarios.\n    \"\"\"\n\n    #\n    # Step 1: Define givens from the problem statement\n    #\n    a_vec = np.array([1.0, -2.0, 0.5, 0.25])\n    k_R = 5.0\n    s_0 = 1.0\n    # kappa_perp is only needed for the derivation, not the final formulas for k_TST and delta_F\n    # kappa_perp = 3.0\n    T = 0.7\n    m0 = np.array([1.0, 2.0, 3.0, 4.0])\n    epsilon = 1e-10\n\n    # Define mass-scaling test cases\n    test_cases = [\n        ('A', lambda m: m * 0.5),         # Uniform scaling\n        ('B', lambda m: np.array([m[0], m[1] * 4.0, m[2], m[3]])), # Single-coordinate scaling\n        ('C', lambda m: m * 1e6),         # Uniform extreme scaling (large)\n        ('D', lambda m: m * 1e-6),        # Uniform extreme scaling (small)\n    ]\n\n    #\n    # Step 2: Implement the derived formulas\n    #\n\n    # Pre-calculate components that do not depend on mass\n    a_norm_sq = np.dot(a_vec, a_vec)\n    a_hat_sq_components = a_vec**2 / a_norm_sq\n    \n    s0_sqrt_arg = s_0 * np.sqrt(k_R / (2.0 * T))\n    erf_term_val = 0.5 * (1.0 + erf(s0_sqrt_arg))\n    exp_term_val = np.exp(-k_R * s_0**2 / (2.0 * T))\n\n    def calc_m_eff(m, a_hat_sq_comps):\n        \"\"\"Calculates the effective mass along the reaction coordinate.\"\"\"\n        m_eff_inv = np.sum(a_hat_sq_comps / m)\n        return 1.0 / m_eff_inv\n\n    def calc_k_tst(m_eff, k_R, exp_term, erf_term):\n        \"\"\"Calculates the TST rate constant.\"\"\"\n        prefactor = (1.0 / (2.0 * np.pi)) * np.sqrt(k_R / m_eff)\n        rate = prefactor * exp_term / erf_term\n        return rate\n\n    def calc_delta_F(k_R, s_0, T, erf_term):\n        \"\"\"Calculates the free energy barrier.\"\"\"\n        E_b = 0.5 * k_R * s_0**2\n        log_arg = np.sqrt(2.0 * np.pi * T / k_R) * erf_term\n        delta_F = E_b + T * np.log(log_arg)\n        return delta_F\n\n    #\n    # Step 3: Perform calculations for base case and test cases\n    #\n\n    # Calculate base case (0) values\n    m_eff_0 = calc_m_eff(m0, a_hat_sq_components)\n    k_tst_0 = calc_k_tst(m_eff_0, k_R, exp_term_val, erf_term_val)\n    delta_F_0 = calc_delta_F(k_R, s_0, T, erf_term_val)\n\n    results = []\n    for _name, scaling_func in test_cases:\n        # Apply mass scaling for the current case\n        m_X = scaling_func(m0)\n        \n        # Calculate quantities for the scaled case\n        m_eff_X = calc_m_eff(m_X, a_hat_sq_components)\n        k_tst_X = calc_k_tst(m_eff_X, k_R, exp_term_val, erf_term_val)\n        delta_F_X = calc_delta_F(k_R, s_0, T, erf_term_val)\n\n        #\n        # Step 4: Verify the scientific constraints\n        #\n\n        # Check 1: Prefactor scaling (k_TST proportional to 1/sqrt(m_eff))\n        ratio_k = k_tst_X / k_tst_0\n        ratio_m_sqrt = np.sqrt(m_eff_0 / m_eff_X)\n        prefactor_ok = np.abs(ratio_k - ratio_m_sqrt) <= epsilon\n        results.append(prefactor_ok)\n\n        # Check 2: Mass invariance of the free energy barrier\n        barrier_ok = np.abs(delta_F_X - delta_F_0) <= epsilon\n        results.append(barrier_ok)\n        \n    #\n    # Step 5: Format and print the final output\n    #\n    output_str = f\"[{','.join(map(str, results))}]\"\n    # Convert Python booleans to lowercase for the final output string.\n    print(output_str.lower())\n\nsolve()\n```", "id": "3458183"}, {"introduction": "Reaction rates are strongly dependent on temperature, and this dependence provides a window into the thermodynamics of the activation process. This final practice moves beyond calculating a rate at a single temperature to explore non-Arrhenius behavior, where the plot of $\\ln k$ versus $1/T$ is not a straight line. You will derive from first principles how curvature in an Arrhenius plot arises from a temperature-dependent activation entropy and is directly related to the activation heat capacity, $\\Delta C_p^\\ddagger$, linking a macroscopic observable to the properties of the transition state ensemble [@problem_id:3458151].", "problem": "Consider a one-dimensional Arrhenius plot, namely the graph of the natural logarithm of the rate constant $ \\ln k $ versus the inverse temperature $ x = 1/T $. In the framework of Transition State Theory (TST), the temperature dependence of the rate constant is modeled by the product of a dynamical prefactor and a Boltzmann factor for crossing a free energy barrier. Specifically, assume the base model\n$$\nk(T) = \\nu(T)\\,\\exp\\!\\left[-\\beta\\,\\Delta F^\\ddagger(T)\\right],\n$$\nwhere $ \\beta = 1/(k_B T) $, $ k_B $ is the Boltzmann constant, $ \\nu(T) $ is the dynamical prefactor, and $ \\Delta F^\\ddagger(T) $ is the activation free energy. The activation free energy decomposes as\n$$\n\\Delta F^\\ddagger(T) = \\Delta H^\\ddagger(T) - T\\,\\Delta S^\\ddagger(T),\n$$\nwhere $ \\Delta H^\\ddagger(T) $ and $ \\Delta S^\\ddagger(T) $ are the activation enthalpy and activation entropy, respectively.\n\nAssume a constant activation heat capacity $ \\Delta C_p^\\ddagger $ such that\n$$\n\\Delta H^\\ddagger(T) = \\Delta H^\\ddagger(T_0) + \\Delta C_p^\\ddagger\\,(T - T_0),\n\\qquad\n\\Delta S^\\ddagger(T) = \\Delta S^\\ddagger(T_0) + \\Delta C_p^\\ddagger \\,\\ln\\!\\left(\\frac{T}{T_0}\\right),\n$$\nwith $ T_0 $ a reference temperature. The prefactor may have its own temperature dependence due to dynamical effects; you will analyze two prefactor models:\n- Power-law prefactor: $ \\nu(T) = \\nu_0\\,T^\\alpha $ with exponent $ \\alpha $ and constant $ \\nu_0 $.\n- Exponential prefactor: $ \\nu(T) = \\nu_0 \\exp\\!\\left(\\frac{a}{T} + b T\\right) $ with parameters $ a $ and $ b $.\n\nYour tasks:\n1. Starting only from the base definitions above and the chain rule, derive the exact expression for the curvature of the Arrhenius plot $ \\ln k $ as a function of $ x = 1/T $, that is, the second derivative $ \\frac{d^2}{dx^2}\\ln k $. Express your result entirely in terms of $ T $, derivatives of $ \\ln \\nu(T) $ with respect to $ T $, and derivatives of $ \\Delta F^\\ddagger(T) $ with respect to $ T $. Do not introduce any unmotivated formulas beyond the base definitions, and justify each differentiation step from first principles.\n2. Using the constant activation heat capacity assumption for $ \\Delta H^\\ddagger(T) $ and $ \\Delta S^\\ddagger(T) $ given above, reduce your general expression to a simplified curvature formula. Emphasize how a temperature-dependent activation entropy $ \\Delta S^\\ddagger(T) $ produces curvature in the Arrhenius plot.\n3. Implement a program that evaluates the curvature using the simplified expression for the following test suite of parameter values. In all cases, use $ k_B = 1.380649 \\times 10^{-23} \\,\\text{J/K} $. For each case, compute the curvature $ \\frac{d^2}{dx^2}\\ln k $ at the specified temperature. Express the final numerical answers in units of $ \\text{K}^2 $.\n\nTest suite parameters (all temperatures in $ \\text{K} $, heat capacities in $ \\text{J/K} $, $ a $ in $ \\text{K} $, $ b $ in $ \\text{K}^{-1} $):\n- Case 1 (power-law prefactor): $ T = 300 $, $ \\alpha = 0 $, $ \\Delta C_p^\\ddagger = 0 $.\n- Case 2 (power-law prefactor): $ T = 300 $, $ \\alpha = 1 $, $ \\Delta C_p^\\ddagger = 0 $.\n- Case 3 (power-law prefactor): $ T = 300 $, $ \\alpha = 0 $, $ \\Delta C_p^\\ddagger = 2\\,k_B $.\n- Case 4 (power-law prefactor): $ T = 500 $, $ \\alpha = -0.5 $, $ \\Delta C_p^\\ddagger = 1\\,k_B $.\n- Case 5 (exponential prefactor): $ T = 250 $, $ a = 1000 $, $ b = 10^{-3} $, $ \\Delta C_p^\\ddagger = -1\\,k_B $.\n\nProgram output specification:\n- Your program should produce a single line of output containing the curvature values for Cases 1 through 5, in this exact order, as a comma-separated list enclosed in square brackets, with each value rounded to three decimal places, for example, $ [c_1,c_2,c_3,c_4,c_5] $.\n- Each reported curvature must be in units of $ \\text{K}^2 $.", "solution": "The problem asks for the derivation and calculation of the curvature of an Arrhenius plot, defined as the graph of $ \\ln k $ versus $ x = 1/T $. The curvature is the second derivative $ \\frac{d^2}{dx^2}\\ln k $. The derivation will be performed from first principles using the provided model for the rate constant $ k(T) $ within the framework of Transition State Theory (TST).\n\nThe rate constant is given by:\n$$\nk(T) = \\nu(T)\\,\\exp\\!\\left[-\\beta\\,\\Delta F^\\ddagger(T)\\right]\n$$\nTaking the natural logarithm, and substituting $ \\beta = 1/(k_B T) $, we obtain:\n$$\n\\ln k(T) = \\ln \\nu(T) - \\frac{\\Delta F^\\ddagger(T)}{k_B T}\n$$\nOur goal is to compute the second derivative of this expression with respect to $ x = 1/T $. We must use the chain rule, as $ \\ln k $ is given as a function of temperature $ T $. The relationship between the differentials is:\n$$\n\\frac{d}{dx} = \\frac{dT}{dx} \\frac{d}{dT}\n$$\nSince $ x = 1/T $, we have $ T = 1/x $, and therefore $ \\frac{dT}{dx} = -1/x^2 = -T^2 $. Thus, the differentiation operator becomes:\n$$\n\\frac{d}{dx} = -T^2 \\frac{d}{dT}\n$$\n\n### Task 1: General Curvature Expression\nFirst, we compute the first derivative of $ \\ln k $ with respect to $ x $.\n$$\n\\frac{d}{dx}\\ln k = -T^2 \\frac{d}{dT} \\left( \\ln \\nu(T) - \\frac{\\Delta F^\\ddagger(T)}{k_B T} \\right) = -T^2 \\frac{d\\ln\\nu}{dT} + \\frac{T^2}{k_B} \\frac{d}{dT}\\left(\\frac{\\Delta F^\\ddagger(T)}{T}\\right)\n$$\nThe derivative of $ \\Delta F^\\ddagger(T)/T $ can be evaluated using the Gibbs-Helmholtz equation. From the definition $ \\Delta F^\\ddagger = \\Delta H^\\ddagger - T\\Delta S^\\ddagger $ and the thermodynamic relation $ \\frac{d\\Delta F^\\ddagger}{dT} = -\\Delta S^\\ddagger $, we have:\n$$\n\\frac{d}{dT}\\left(\\frac{\\Delta F^\\ddagger}{T}\\right) = \\frac{T\\frac{d\\Delta F^\\ddagger}{dT} - \\Delta F^\\ddagger}{T^2} = \\frac{T(-\\Delta S^\\ddagger) - (\\Delta H^\\ddagger - T\\Delta S^\\ddagger)}{T^2} = -\\frac{\\Delta H^\\ddagger}{T^2}\n$$\nSubstituting this into the expression for the first derivative yields:\n$$\n\\frac{d}{dx}\\ln k = -T^2 \\frac{d\\ln\\nu}{dT} - \\frac{\\Delta H^\\ddagger(T)}{k_B}\n$$\nThis quantity is proportional to the apparent activation energy. Now, we compute the second derivative, the curvature, by applying the operator $ \\frac{d}{dx} = -T^2 \\frac{d}{dT} $ again:\n$$\n\\frac{d^2}{dx^2}\\ln k = -T^2 \\frac{d}{dT} \\left( -T^2 \\frac{d\\ln\\nu}{dT} - \\frac{\\Delta H^\\ddagger(T)}{k_B} \\right) = T^2 \\frac{d}{dT} \\left( T^2 \\frac{d\\ln\\nu}{dT} \\right) + \\frac{T^2}{k_B} \\frac{d\\Delta H^\\ddagger}{dT}\n$$\nUsing the product rule on the first term: $ \\frac{d}{dT}\\left(T^2 \\frac{d\\ln\\nu}{dT}\\right) = 2T\\frac{d\\ln\\nu}{dT} + T^2\\frac{d^2\\ln\\nu}{dT^2} $. The second term involves the derivative of the activation enthalpy, which is the activation heat capacity, $ \\frac{d\\Delta H^\\ddagger}{dT} = \\Delta C_p^\\ddagger(T) $.\nThe intermediate expression is thus:\n$$\n\\frac{d^2}{dx^2}\\ln k = T^2 \\left( 2T\\frac{d\\ln\\nu}{dT} + T^2\\frac{d^2\\ln\\nu}{dT^2} \\right) + \\frac{T^2}{k_B} \\Delta C_p^\\ddagger(T)\n$$\nTo express this entirely in terms of derivatives of $ \\Delta F^\\ddagger $, we use the thermodynamic identity $ \\Delta C_p^\\ddagger = -T\\frac{d^2\\Delta F^\\ddagger}{dT^2} $. This identity is derived from $ \\Delta H^\\ddagger = \\Delta F^\\ddagger - T\\frac{d\\Delta F^\\ddagger}{dT} $ by differentiating with respect to $ T $.\nSubstituting this into our expression gives the final general formula for the curvature:\n$$\n\\frac{d^2}{dx^2}\\ln k = 2T^3\\frac{d\\ln\\nu}{dT} + T^4\\frac{d^2\\ln\\nu}{dT^2} - \\frac{T^3}{k_B}\\frac{d^2\\Delta F^\\ddagger}{dT^2}\n$$\n\n### Task 2: Simplified Curvature Formula\nThe problem states to assume a constant activation heat capacity, $ \\Delta C_p^\\ddagger $. This simplifies the temperature dependence of the activation enthalpy and entropy as given:\n$$\n\\Delta H^\\ddagger(T) = \\Delta H^\\ddagger(T_0) + \\Delta C_p^\\ddagger\\,(T - T_0)\n$$\nFrom this, it follows directly that $ \\frac{d\\Delta H^\\ddagger}{dT} = \\Delta C_p^\\ddagger $, where $ \\Delta C_p^\\ddagger $ is a constant. We can substitute this into our intermediate curvature expression:\n$$\n\\frac{d^2}{dx^2}\\ln k = T^2 \\left( 2T\\frac{d\\ln\\nu}{dT} + T^2\\frac{d^2\\ln\\nu}{dT^2} \\right) + \\frac{T^2 \\Delta C_p^\\ddagger}{k_B}\n$$\nThis is the simplified curvature formula under the constant $ \\Delta C_p^\\ddagger $ assumption.\n\nThe problem asks to emphasize the role of a temperature-dependent activation entropy. The given model for $ \\Delta S^\\ddagger(T) $ is $ \\Delta S^\\ddagger(T) = \\Delta S^\\ddagger(T_0) + \\Delta C_p^\\ddagger \\ln(T/T_0) $. Differentiating this with respect to $ T $ gives $ \\frac{d\\Delta S^\\ddagger}{dT} = \\frac{\\Delta C_p^\\ddagger}{T} $. This is consistent with the general thermodynamic relation $ \\Delta C_p^\\ddagger = T \\frac{d\\Delta S^\\ddagger}{dT} $. Therefore, a temperature-dependent activation entropy (i.e., $ \\frac{d\\Delta S^\\ddagger}{dT} \\neq 0 $) implies a non-zero activation heat capacity $ \\Delta C_p^\\ddagger \\neq 0 $. In our simplified formula, the term $ \\frac{T^2 \\Delta C_p^\\ddagger}{k_B} $ is a direct contribution to the curvature. Thus, the temperature dependence of the activation entropy is a direct physical cause of curvature in the Arrhenius plot, leading to so-called non-Arrhenius behavior.\n\n### Task 3: Application to Specific Models\nWe now apply the simplified curvature formula to the two specified prefactor models.\n\n**Power-law prefactor:** $ \\nu(T) = \\nu_0\\,T^\\alpha $\nFirst, we find the derivatives of $ \\ln \\nu(T) = \\ln \\nu_0 + \\alpha \\ln T $:\n$$\n\\frac{d\\ln\\nu}{dT} = \\frac{\\alpha}{T} \\qquad \\text{and} \\qquad \\frac{d^2\\ln\\nu}{dT^2} = -\\frac{\\alpha}{T^2}\n$$\nSubstituting these into the simplified curvature formula:\n$$\n\\frac{d^2}{dx^2}\\ln k = T^2 \\left( 2T\\left(\\frac{\\alpha}{T}\\right) + T^2\\left(-\\frac{\\alpha}{T^2}\\right) \\right) + \\frac{T^2 \\Delta C_p^\\ddagger}{k_B} = T^2 (2\\alpha - \\alpha) + \\frac{T^2 \\Delta C_p^\\ddagger}{k_B}\n$$\nThis gives the final expression for the power-law case:\n$$\n\\frac{d^2}{dx^2}\\ln k = T^2 \\left( \\alpha + \\frac{\\Delta C_p^\\ddagger}{k_B} \\right)\n$$\n\n**Exponential prefactor:** $ \\nu(T) = \\nu_0 \\exp\\!\\left(\\frac{a}{T} + b T\\right) $\nThe derivatives of $ \\ln \\nu(T) = \\ln \\nu_0 + a/T + bT $ are:\n$$\n\\frac{d\\ln\\nu}{dT} = -\\frac{a}{T^2} + b \\qquad \\text{and} \\qquad \\frac{d^2\\ln\\nu}{dT^2} = \\frac{2a}{T^3}\n$$\nSubstituting these into the simplified curvature formula:\n$$\n\\frac{d^2}{dx^2}\\ln k = T^2 \\left( 2T\\left(-\\frac{a}{T^2} + b\\right) + T^2\\left(\\frac{2a}{T^3}\\right) \\right) + \\frac{T^2 \\Delta C_p^\\ddagger}{k_B} = T^2 \\left( -\\frac{2a}{T} + 2bT + \\frac{2a}{T} \\right) + \\frac{T^2 \\Delta C_p^\\ddagger}{k_B}\n$$\nThis gives the final expression for the exponential case:\n$$\n\\frac{d^2}{dx^2}\\ln k = 2bT^3 + \\frac{T^2 \\Delta C_p^\\ddagger}{k_B}\n$$\nThese two derived expressions are implemented below to compute the curvature for the specified test suite.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the curvature of an Arrhenius plot for several test cases based on\n    Transition State Theory (TST) models.\n    \"\"\"\n    # Define physical constants\n    k_B = 1.380649e-23  # Boltzmann constant in J/K\n\n    # Define the test cases from the problem statement.\n    # dCp represents the constant activation heat capacity ΔC_p^‡.\n    test_cases = [\n        # Case 1: power-law prefactor\n        {'model': 'power', 'T': 300, 'params': {'alpha': 0}, 'dCp': 0},\n        # Case 2: power-law prefactor\n        {'model': 'power', 'T': 300, 'params': {'alpha': 1}, 'dCp': 0},\n        # Case 3: power-law prefactor\n        {'model': 'power', 'T': 300, 'params': {'alpha': 0}, 'dCp': 2 * k_B},\n        # Case 4: power-law prefactor\n        {'model': 'power', 'T': 500, 'params': {'alpha': -0.5}, 'dCp': 1 * k_B},\n        # Case 5: exponential prefactor\n        {'model': 'exp', 'T': 250, 'params': {'a': 1000, 'b': 1e-3}, 'dCp': -1 * k_B}\n    ]\n\n    results = []\n    for case in test_cases:\n        T = case['T']\n        dCp = case['dCp']\n        model_type = case['model']\n        params = case['params']\n        \n        curvature = 0.0\n        \n        if model_type == 'power':\n            # Curvature formula for power-law prefactor: C = T^2 * (α + ΔC_p^‡ / k_B)\n            alpha = params['alpha']\n            curvature = T**2 * (alpha + dCp / k_B)\n        elif model_type == 'exp':\n            # Curvature formula for exponential prefactor: C = 2*b*T^3 + T^2 * ΔC_p^‡ / k_B\n            b = params['b']\n            curvature = 2 * b * T**3 + T**2 * (dCp / k_B)\n        \n        results.append(curvature)\n\n    # Format the final output as a comma-separated list of strings,\n    # with each value rounded to three decimal places.\n    formatted_results = [f\"{res:.3f}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "3458151"}]}