{"hands_on_practices": [{"introduction": "Before delving into the complexities of sublinear algorithms, it is essential to build a solid intuition for what sparsity in the frequency domain means. This first practice serves as a foundational exercise to connect the abstract concept of a sparse spectrum with a concrete signal representation. By constructing a time-domain signal from a few known frequency components and then applying the Discrete Fourier Transform (DFT), you will directly verify the principle that the transform recovers the original sparse coefficients, reinforcing the core idea that sFFT algorithms aim to exploit [@problem_id:3477177].", "problem": "Consider a length-$n$ discrete-time complex signal $x[t]$ with $t \\in \\{0,1,\\dots,n-1\\}$ and the Discrete Fourier Transform (DFT) defined by\n$$\nX[\\ell] \\;=\\; \\sum_{t=0}^{n-1} x[t] \\,\\exp\\!\\left(-\\frac{2\\pi \\mathrm{i}}{n}\\,\\ell t\\right), \\quad \\ell \\in \\{0,1,\\dots,n-1\\}.\n$$\nLet $n=17$, and suppose $x[t]$ is constructed as a superposition of $k=4$ complex tones supported on a known index set $S=\\{3,5,11,14\\}\\subset\\{0,1,\\dots,16\\}$:\n$$\nx[t] \\;=\\; \\frac{1}{n}\\sum_{m\\in S} \\alpha_m \\,\\exp\\!\\left(\\frac{2\\pi \\mathrm{i}}{n}\\, m t\\right),\n$$\nwith amplitudes\n$$\n\\alpha_{3}=2,\\quad \\alpha_{5}=-1+\\mathrm{i},\\quad \\alpha_{11}=\\frac{3}{2}\\,\\exp\\!\\left(\\frac{2\\pi \\mathrm{i}}{5}\\right),\\quad \\alpha_{14}=-\\mathrm{i}\\sqrt{2}.\n$$\nStarting from the core definitions and properties of the DFT, compute $X[\\ell]$ exactly for all $\\ell\\in\\{0,1,\\dots,16\\}$ and present the result as a single row matrix $\\big(X[0]\\;X[1]\\;\\dots\\;X[16]\\big)$. As a verification of $k$-sparsity relevant to the Sparse Fast Fourier Transform (SFFT), identify the nonzero support and their amplitudes implicitly through your computed $X[\\ell]$ values.\n\nNo rounding is required. Express the final answer as the exact analytic values in a single row matrix using the $\\mathrm{pmatrix}$ environment.", "solution": "The problem requires the computation of the Discrete Fourier Transform (DFT) for a discrete-time signal $x[t]$ of length $n=17$.\n\nThe DFT of the signal $x[t]$ is defined as:\n$$\nX[\\ell] = \\sum_{t=0}^{n-1} x[t] \\exp\\left(-\\frac{2\\pi \\mathrm{i}}{n} \\ell t\\right)\n$$\nfor the frequency index $\\ell \\in \\{0, 1, \\dots, n-1\\}$.\n\nThe signal $x[t]$ is given as a superposition of $k=4$ complex tones, with frequencies corresponding to the index set $S=\\{3, 5, 11, 14\\}$:\n$$\nx[t] = \\frac{1}{n} \\sum_{m \\in S} \\alpha_m \\exp\\left(\\frac{2\\pi \\mathrm{i}}{n} m t\\right)\n$$\nThe complex amplitudes $\\alpha_m$ are provided for each $m \\in S$.\n\nTo find $X[\\ell]$, we substitute the expression for $x[t]$ into the DFT definition:\n$$\nX[\\ell] = \\sum_{t=0}^{n-1} \\left[ \\frac{1}{n} \\sum_{m \\in S} \\alpha_m \\exp\\left(\\frac{2\\pi \\mathrm{i}}{n} m t\\right) \\right] \\exp\\left(-\\frac{2\\pi \\mathrm{i}}{n} \\ell t\\right)\n$$\nSince the summations are finite, we can interchange their order. We can also factor out the constant $\\frac{1}{n}$ and the terms $\\alpha_m$ which do not depend on the summation index $t$:\n$$\nX[\\ell] = \\frac{1}{n} \\sum_{m \\in S} \\alpha_m \\left[ \\sum_{t=0}^{n-1} \\exp\\left(\\frac{2\\pi \\mathrm{i}}{n} m t\\right) \\exp\\left(-\\frac{2\\pi \\mathrm{i}}{n} \\ell t\\right) \\right]\n$$\nCombining the exponential terms inside the inner summation gives:\n$$\nX[\\ell] = \\frac{1}{n} \\sum_{m \\in S} \\alpha_m \\left[ \\sum_{t=0}^{n-1} \\exp\\left(\\frac{2\\pi \\mathrm{i}}{n} (m - \\ell) t\\right) \\right]\n$$\nThe inner sum is a key property related to the orthogonality of the complex exponential basis functions of the DFT. Let $j = m - \\ell$. The sum is a geometric series $\\sum_{t=0}^{n-1} \\left(\\exp\\left(\\frac{2\\pi \\mathrm{i} j}{n}\\right)\\right)^t$. We analyze this sum in two cases:\n\nCase 1: $m = \\ell$.\nIn this case, $j = m - \\ell = 0$. The term inside the summation becomes $\\exp(0) = 1$. The sum is:\n$$\n\\sum_{t=0}^{n-1} 1 = n\n$$\n\nCase 2: $m \\neq \\ell$.\nIn this case, $j = m - \\ell \\neq 0$. Since $m, \\ell \\in \\{0, 1, \\dots, n-1\\}$, $m-\\ell$ is not a non-zero multiple of $n$. Let $r = \\exp\\left(\\frac{2\\pi \\mathrm{i} (m - \\ell)}{n}\\right)$. We have $r \\neq 1$. The sum of the geometric series is:\n$$\n\\sum_{t=0}^{n-1} r^t = \\frac{r^n - 1}{r - 1}\n$$\nThe term $r^n$ is:\n$$\nr^n = \\left(\\exp\\left(\\frac{2\\pi \\mathrm{i} (m - \\ell)}{n}\\right)\\right)^n = \\exp(2\\pi \\mathrm{i} (m - \\ell))\n$$\nSince $m - \\ell$ is an integer, $\\exp(2\\pi \\mathrm{i} (m - \\ell)) = \\cos(2\\pi (m-\\ell)) + \\mathrm{i}\\sin(2\\pi (m-\\ell)) = 1$.\nTherefore, the sum is:\n$$\n\\frac{1 - 1}{r - 1} = 0\n$$\n\nCombining these two cases, we can express the inner sum using the Kronecker delta, $\\delta_{m,\\ell}$:\n$$\n\\sum_{t=0}^{n-1} \\exp\\left(\\frac{2\\pi \\mathrm{i}}{n} (m - \\ell) t\\right) = n \\cdot \\delta_{m,\\ell}\n$$\nSubstituting this result back into the expression for $X[\\ell]$:\n$$\nX[\\ell] = \\frac{1}{n} \\sum_{m \\in S} \\alpha_m (n \\cdot \\delta_{m,\\ell}) = \\sum_{m \\in S} \\alpha_m \\delta_{m,\\ell}\n$$\nThis sum simplifies based on whether the frequency index $\\ell$ is in the support set $S$.\nIf $\\ell \\in S$, there is exactly one non-zero term in the sum, which occurs when $m = \\ell$. In this case, $\\delta_{m,\\ell} = 1$ and the sum evaluates to $\\alpha_\\ell$.\nIf $\\ell \\notin S$, then for every $m \\in S$, we have $m \\neq \\ell$, which means $\\delta_{m,\\ell} = 0$ for all terms. The sum is therefore $0$.\n\nSo, we have the direct relationship:\n$$\nX[\\ell] = \\begin{cases} \\alpha_\\ell & \\text{if } \\ell \\in S \\\\ 0 & \\text{if } \\ell \\notin S \\end{cases}\n$$\nThis result demonstrates that the DFT of a signal constructed as an Inverse DFT from a set of sparse coefficients simply recovers those same coefficients. The non-zero support of the DFT spectrum $X[\\ell]$ is the set $S=\\{3, 5, 11, 14\\}$, and the values at these indices are the given amplitudes $\\alpha_m$.\n\nFor $n=17$, we evaluate $X[\\ell]$ for $\\ell \\in \\{0, 1, \\dots, 16\\}$:\n- $X[0] = 0$\n- $X[1] = 0$\n- $X[2] = 0$\n- $X[3] = \\alpha_3 = 2$\n- $X[4] = 0$\n- $X[5] = \\alpha_5 = -1 + \\mathrm{i}$\n- $X[6] = 0$\n- $X[7] = 0$\n- $X[8] = 0$\n- $X[9] = 0$\n- $X[10] = 0$\n- $X[11] = \\alpha_{11} = \\frac{3}{2} \\exp\\left(\\frac{2\\pi \\mathrm{i}}{5}\\right)$\n- $X[12] = 0$\n- $X[13] = 0$\n- $X[14] = \\alpha_{14} = -\\mathrm{i}\\sqrt{2}$\n- $X[15] = 0$\n- $X[16] = 0$\n\nWe present these values as a single row matrix as requested.", "answer": "$$\n\\boxed{\\begin{pmatrix} 0 & 0 & 0 & 2 & 0 & -1+\\mathrm{i} & 0 & 0 & 0 & 0 & 0 & \\frac{3}{2}\\exp\\left(\\frac{2\\pi \\mathrm{i}}{5}\\right) & 0 & 0 & -\\mathrm{i}\\sqrt{2} & 0 & 0 \\end{pmatrix}}\n$$", "id": "3477177"}, {"introduction": "In many practical applications, from audio processing to medical imaging, the signals we analyze are real-valued. This property imposes a special structure on the signal's Fourier transform known as conjugate symmetry, where the spectral information becomes redundant. This exercise challenges you to think about how to leverage this redundancy, a critical step in designing efficient sFFT algorithms that avoid unnecessary computations by effectively halving the frequency search space [@problem_id:3477223].", "problem": "Consider a real-valued length-$N$ signal $x[n] \\in \\mathbb{R}$ for $n \\in \\{0,1,\\dots,N-1\\}$ with $N$ even, and its Discrete Fourier Transform (DFT) $X[k] = \\sum_{n=0}^{N-1} x[n] e^{-\\mathrm{i} 2 \\pi n k / N}$ for $k \\in \\{0,1,\\dots,N-1\\}$. Assume that $X[k]$ is $K$-sparse, i.e., the support set $S = \\{ k : X[k] \\neq 0 \\}$ has cardinality $|S| = K \\ll N$. A sparse fast Fourier transform (sFFT) algorithm uses hashed binning and shift-based decoding: it selects an integer $a$ coprime with $N$ to permute frequencies, partitions the permuted frequency indices into $B$ bins, and forms measurements\n$$\nb_s[r] = \\sum_{k \\in S : h(k) = r} X[k] \\, e^{\\mathrm{i} 2 \\pi s k / N}, \\quad r \\in \\{0,1,\\dots,B-1\\},\n$$\nfor several time shifts $s \\in \\mathcal{S}$, where $h(k)$ is a binning map that depends on $a$ and $B$. Under the singleton-bin assumption (i.e., for a bin $r$ there is exactly one $k^\\star \\in S$ with $h(k^\\star) = r$), the phase differences across two distinct shifts $s_1, s_2 \\in \\mathcal{S}$ yield an estimate of $k^\\star$ via the relation\n$$\n\\arg\\!\\left( \\frac{b_{s_2}[r]}{b_{s_1}[r]} \\right) \\approx \\frac{2 \\pi (s_2 - s_1) k^\\star}{N}.\n$$\n\nStarting from the DFT definition, the reality of $x[n]$, and the time-shift property of the DFT, analyze how conjugate symmetry in the DFT of real signals affects the search space and the decoding stage in sFFT. Specifically, determine the correct strategy to reduce the frequency search space by a factor of $2$ and adjust the decoding to avoid double-counting symmetric frequencies.\n\nWhich option correctly describes both the search-space reduction and the necessary decoding adjustment for real-valued signals?\n\nA. Restrict the search to indices $k \\in \\{0,1,\\dots,N/2\\}$; when a non-edge index $k$ with $1 \\le k \\le N/2 - 1$ is decoded, set $X[N - k] = \\overline{X[k]}$ without re-decoding $N - k$, and treat $X[0]$ and $X[N/2]$ as real-valued special cases. The phase-based index decoding uses the one-sided coefficient $X[k]$; the mirror coefficient is filled by conjugation, preventing double counting.\n\nB. Restrict the search to indices $k \\in \\{1,2,\\dots,N-1\\}$, discard $k = 0$ and $k = N/2$ since they do not carry phase information, and decode both $k$ and $N - k$ independently in all bins, then enforce conjugate symmetry by averaging their amplitudes post hoc.\n\nC. Restrict the search to indices $k \\in \\{0,1,\\dots,N/2\\}$; when a non-edge index $k$ with $1 \\le k \\le N/2 - 1$ is decoded, split the recovered amplitude equally, assigning $X[k]$ and $X[N - k]$ each to be half of the measured value, because their combined contribution explains the bin measurement; set $X[0] = X[N/2] = 0$ to avoid ambiguity.\n\nD. Do not reduce the search space; instead impose the constraint $X[k] = X[N - k]$ during decoding (e.g., by a Least Absolute Shrinkage and Selection Operator (LASSO) penalty that penalizes $|X[k] - X[N - k]|$), and decode all indices in $\\{0,1,\\dots,N-1\\}$, since equality of symmetric coefficients guarantees real signals without requiring special handling of $k = 0$ or $k = N/2$.", "solution": "The user wants me to solve a problem about Sparse Fast Fourier Transforms (sFFT), following a strict set of rules. I must first validate the problem statement, and if it's valid, provide a detailed derivation and evaluation of the options.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n\n*   **Signal:** A real-valued length-$N$ signal $x[n] \\in \\mathbb{R}$ for $n \\in \\{0, 1, \\dots, N-1\\}$.\n*   **Signal Length:** $N$ is an even integer.\n*   **DFT Definition:** $X[k] = \\sum_{n=0}^{N-1} x[n] e^{-\\mathrm{i} 2 \\pi n k / N}$ for $k \\in \\{0, 1, \\dots, N-1\\}$.\n*   **Sparsity:** The DFT $X[k]$ is $K$-sparse, meaning its support set $S = \\{ k : X[k] \\neq 0 \\}$ has cardinality $|S| = K \\ll N$.\n*   **sFFT Algorithm:** The algorithm uses hashed binning and shift-based decoding.\n    *   An integer $a$ coprime with $N$ is used to permute frequencies.\n    *   Permuted frequency indices are partitioned into $B$ bins using a binning map $h(k)$.\n    *   Measurements are formed as $b_s[r] = \\sum_{k \\in S : h(k) = r} X[k] \\, e^{\\mathrm{i} 2 \\pi s k / N}$ for shifts $s \\in \\mathcal{S}$ and bins $r \\in \\{0, 1, \\dots, B-1\\}$.\n*   **Decoding Assumption:** The singleton-bin assumption holds, meaning for a given bin $r$, there is exactly one frequency index $k^\\star \\in S$ such that $h(k^\\star) = r$.\n*   **Decoding Relation:** The frequency index $k^\\star$ is estimated from the phase difference between measurements at two shifts, $s_1$ and $s_2$: $\\arg\\!\\left( \\frac{b_{s_2}[r]}{b_{s_1}[r]} \\right) \\approx \\frac{2 \\pi (s_2 - s_1) k^\\star}{N}$.\n*   **Question:** Determine the correct strategy to (1) reduce the frequency search space by a factor of $2$ and (2) adjust the decoding to avoid double-counting, given that the input signal $x[n]$ is real-valued.\n\n**Step 2: Validate Using Extracted Givens**\n\n1.  **Scientifically Grounded:** The problem is firmly grounded in the principles of Digital Signal Processing (DSP) and Compressed Sensing. The Discrete Fourier Transform (DFT), its properties for real signals, and the high-level description of a Sparse Fast Fourier Transform (sFFT) algorithm are all standard and well-established concepts. The singleton-bin assumption is a common simplification used to explain the core mechanism of such algorithms.\n2.  **Well-Posed:** The problem is well-posed. It asks for the appropriate modification of a specific algorithm (sFFT) when a known property (real-valued input signal) is present. This has a logically derivable answer based on fundamental DFT properties.\n3.  **Objective:** The problem statement is objective, using precise mathematical and technical language. There are no subjective or opinion-based elements.\n4.  **Completeness and Consistency:** The problem provides all necessary information to reason about the implications of the signal's reality on the sFFT process. The elements described are internally consistent.\n5.  **Flaw Checklist:** The problem does not violate any of the specified invalidity criteria. It is not scientifically unsound, non-formalizable, incomplete, unrealistic, ill-posed, trivial, or unverifiable.\n\n**Step 3: Verdict and Action**\n\nThe problem statement is **valid**. The solution process will now proceed.\n\n### Derivation\n\nThe analysis begins with the fundamental property of the DFT for real-valued signals.\n\nLet $x[n]$ be a real-valued signal, i.e., $x[n] \\in \\mathbb{R}$ for all $n$. This means $x[n] = \\overline{x[n]}$, where the overbar denotes complex conjugation. The DFT is defined as:\n$$X[k] = \\sum_{n=0}^{N-1} x[n] e^{-\\mathrm{i} 2 \\pi n k / N}$$\nLet us compute the complex conjugate of $X[k]$:\n$$\\overline{X[k]} = \\overline{\\sum_{n=0}^{N-1} x[n] e^{-\\mathrm{i} 2 \\pi n k / N}} = \\sum_{n=0}^{N-1} \\overline{x[n]} \\overline{e^{-\\mathrm{i} 2 \\pi n k / N}}$$\nSince $x[n]$ is real, $\\overline{x[n]} = x[n]$. The conjugate of the exponential term is $\\overline{e^{-\\mathrm{i}\\theta}} = e^{\\mathrm{i}\\theta}$. Thus:\n$$\\overline{X[k]} = \\sum_{n=0}^{N-1} x[n] e^{\\mathrm{i} 2 \\pi n k / N}$$\nNow, consider the DFT coefficient at index $N-k$:\n$$X[N-k] = \\sum_{n=0}^{N-1} x[n] e^{-\\mathrm{i} 2 \\pi n (N-k) / N} = \\sum_{n=0}^{N-1} x[n] e^{-\\mathrm{i} 2 \\pi n} e^{\\mathrm{i} 2 \\pi n k / N}$$\nSince $n$ is an integer, $e^{-\\mathrm{i} 2 \\pi n} = \\cos(2\\pi n) - \\mathrm{i}\\sin(2\\pi n) = 1$. Therefore:\n$$X[N-k] = \\sum_{n=0}^{N-1} x[n] e^{\\mathrm{i} 2 \\pi n k / N}$$\nComparing the expressions for $\\overline{X[k]}$ and $X[N-k]$, we establish the property of **conjugate symmetry**:\n$$X[N-k] = \\overline{X[k]}$$\nThis relationship holds for $k \\in \\{0, 1, \\dots, N-1\\}$, with the understanding that indices are modulo $N$.\n\nThis symmetry has crucial implications for the support set $S$ and the values of the DFT coefficients:\n1.  If $X[k] \\neq 0$ for a \"non-edge\" index $k \\in \\{1, 2, \\dots, N/2 - 1\\}$, then it must be that $X[N-k] = \\overline{X[k]} \\neq 0$. This means that non-zero frequency components in this range always appear in symmetric pairs $(k, N-k)$.\n2.  The values of the coefficients for $k > N/2$ are entirely determined by the values for $k  N/2$. Specifically, $X[N/2+j] = \\overline{X[N/2-j]}$ for $j \\in \\{1, \\dots, N/2-1\\}$.\n3.  For the \"edge\" indices:\n    *   For $k=0$ (the DC component), the symmetry implies $X[0] = \\overline{X[0]}$, which means $X[0]$ must be a real number.\n    *   For $k=N/2$ (the Nyquist component, since $N$ is even), the symmetry implies $X[N/2] = \\overline{X[N/2]}$, meaning $X[N/2]$ must also be a real number.\n\nThis structure allows for a significant optimization in any algorithm searching for the non-zero DFT coefficients.\n\n**Application to sFFT:**\n\n1.  **Search Space Reduction:** Instead of searching for $K$ non-zero coefficients across the full frequency range $\\{0, 1, \\dots, N-1\\}$, we can limit the search to the unique half of the spectrum, i.e., indices $k \\in \\{0, 1, \\dots, N/2\\}$. All information about the spectrum is contained within these coefficients. This reduces the size of the set of candidate frequencies by approximately a factor of $2$.\n\n2.  **Decoding Adjustment:** The sFFT algorithm described decodes an index $k^\\star$ from a singleton bin $r$. The bin measurement is $b_s[r] = X[k^\\star] e^{\\mathrm{i} 2 \\pi s k^\\star / N}$. The decoding relies on the phase term $e^{\\mathrm{i} 2 \\pi s k^\\star / N}$ to find $k^\\star$. Once $k^\\star$ is found, the value $X[k^\\star]$ can be estimated (e.g., from $b_{s_1}[r] e^{-\\mathrm{i} 2 \\pi s_1 k^\\star / N}$).\n    *   If a decoded index $k^\\star$ is in the range $\\{1, \\dots, N/2 - 1\\}$, the algorithm must explicitly set the value for its symmetric partner: $X[N-k^\\star] = \\overline{X[k^\\star]}$.\n    *   The algorithm must be designed to not attempt to decode $N-k^\\star$ separately. Since the search space is restricted to $\\{0, \\dots, N/2\\}$, this is naturally avoided. If an sFFT implementation were to hash frequencies from the full range, it would need a mechanism to recognize that if bin $r_1$ contains $k^\\star$ and bin $r_2$ contains $N-k^\\star$, these are a dependent pair, not two independent coefficients. The most direct strategy is to only hash and decode from the first half of the spectrum.\n    *   This prevents \"double-counting\" where the algorithm would incorrectly identify $K$ coefficients in the first half and another $K$ in the second, leading to a false $2K$-sparse result.\n    *   The edge cases $k=0$ and $k=N/2$ are decoded just like any other frequency in the restricted range $\\{0, \\dots, N/2\\}$, with the additional constraint that their coefficient values must be real.\n\nThe correct strategy is therefore to restrict the search and decoding to $k \\in \\{0, 1, \\dots, N/2\\}$, and for each non-edge frequency $k$ found, to populate its symmetric counterpart $N-k$ by conjugation.\n\n### Option-by-Option Analysis\n\n**A. Restrict the search to indices $k \\in \\{0,1,\\dots,N/2\\}$; when a non-edge index $k$ with $1 \\le k \\le N/2 - 1$ is decoded, set $X[N - k] = \\overline{X[k]}$ without re-decoding $N - k$, and treat $X[0]$ and $X[N/2]$ as real-valued special cases. The phase-based index decoding uses the one-sided coefficient $X[k]$; the mirror coefficient is filled by conjugation, preventing double counting.**\nThis option accurately describes the entire procedure derived from first principles. It correctly identifies the reduced search space, the handling of non-edge symmetric pairs via conjugation, the avoidance of re-decoding (and thus double-counting), and the special nature of the real-valued coefficients at $k=0$ and $k=N/2$. The statement that decoding uses the one-sided coefficient $X[k]$ is consistent with the singleton-bin assumption provided in the problem.\n**Verdict: Correct.**\n\n**B. Restrict the search to indices $k \\in \\{1,2,\\dots,N-1\\}$, discard $k = 0$ and $k = N/2$ since they do not carry phase information, and decode both $k$ and $N - k$ independently in all bins, then enforce conjugate symmetry by averaging their amplitudes post hoc.**\nThis option is incorrect for several reasons. First, discarding $X[0]$ and $X[N/2]$ is unwarranted; these are potentially non-zero and significant components of the signal. Second, decoding $k$ and $N-k$ independently is computationally inefficient and fails to exploit the known structure of the problem. Third, \"averaging their amplitudes post hoc\" is a mathematically nonsensical way to enforce conjugate symmetry, which is a precise relationship involving both magnitude and phase ($|X[k]|=|X[N-k]|$ and $\\arg(X[k]) = -\\arg(X[N-k])$), not an averaging process.\n**Verdict: Incorrect.**\n\n**C. Restrict the search to indices $k \\in \\{0,1,\\dots,N/2\\}$; when a non-edge index $k$ with $1 \\le k \\le N/2 - 1$ is decoded, split the recovered amplitude equally, assigning $X[k]$ and $X[N - k]$ each to be half of the measured value, because their combined contribution explains the bin measurement; set $X[0] = X[N/2] = 0$ to avoid ambiguity.**\nThis option is built on false premises. The singleton-bin assumption states that only one frequency $k^\\star$ falls into the bin, so the measurement is not a \"combined contribution\" of $X[k]$ and $X[N-k]$. The idea of splitting the amplitude is incorrect. Furthermore, setting $X[0]$ and $X[N/2]$ to $0$ is an invalid assumption that would discard important signal information.\n**Verdict: Incorrect.**\n\n**D. Do not reduce the search space; instead impose the constraint $X[k] = X[N - k]$ during decoding (e.g., by a Least Absolute Shrinkage and Selection Operator (LASSO) penalty that penalizes $|X[k] - X[N - k]|$), and decode all indices in $\\{0,1,\\dots,N-1\\}$, since equality of symmetric coefficients guarantees real signals without requiring special handling of $k = 0$ or $k = N/2$.**\nThis option is fundamentally flawed. The property for real signals is conjugate symmetry, $X[N-k] = \\overline{X[k]}$, not equality, $X[k] = X[N-k]$. Enforcing equality is incorrect. Moreover, not reducing the search space is inefficient and goes against the principles of optimizing algorithms based on known signal properties. The introduction of a LASSO penalty describes a different class of algorithms (convex optimization-based sparse recovery) and is not relevant to the described sFFT method based on binning and phase decoding.\n**Verdict: Incorrect.**", "answer": "$$\\boxed{A}$$", "id": "3477223"}, {"introduction": "Real-world measurements are invariably corrupted by noise, and the performance of any signal processing algorithm ultimately depends on its robustness in a noisy environment. This practice moves our analysis from the ideal, noise-free domain into a more realistic setting. Here, you will model how a single Fourier coefficient (a \"singleton\") is estimated by an sFFT algorithm in the presence of Additive White Gaussian Noise (AWGN) and derive the variance of this estimator, providing a fundamental quantification of its precision and reliability [@problem_id:3477176].", "problem": "Consider a discrete-time complex signal with a sparse spectrum, where exactly one nonzero Fourier coefficient is present in a given hash bucket (a singleton). Let the signal length be $N$, and let the time-domain samples be\n$$\nx[n] = c_j \\exp\\!\\big(\\mathrm{i} 2 \\pi j n / N\\big) + \\eta[n], \\quad n = 0, 1, \\dots, N-1,\n$$\nwhere $c_j \\in \\mathbb{C}$ is the unknown amplitude at frequency index $j$, and $\\eta[n]$ are independent and identically distributed complex circularly symmetric Additive White Gaussian Noise (AWGN) samples with $\\eta[n] \\sim \\mathcal{CN}(0,\\sigma^2)$.\n\nIn a Sparse Fast Fourier Transform (sFFT) measurement for this singleton, a deterministic window $w[n]$ is applied and the bucket value at the demodulated index $j$ is formed as\n$$\nY = \\sum_{n=0}^{N-1} w[n] \\, x[n] \\, \\exp\\!\\big(-\\mathrm{i} 2 \\pi j n / N\\big).\n$$\nAssume the window induces a flat passband gain at the targeted frequency equal to\n$$\nG = \\sum_{n=0}^{N-1} w[n],\n$$\nso that in the absence of noise, the contribution of the singleton to the bucket equals $G \\, c_j$. Define the estimator of $c_j$ by dividing the bucket value by the passband gain,\n$$\n\\widehat{c}_j = \\frac{Y}{G}.\n$$\n\nStarting from fundamental properties of the Discrete Fourier Transform (DFT), linearity, and the second-order statistics of complex circularly symmetric Gaussian noise, derive the variance of $\\widehat{c}_j$ under the AWGN model described above. Express your final answer as a closed-form analytic expression in terms of $\\sigma^2$, $G$, and $w[n]$. No rounding is required, and no units are involved. The final answer must be a single closed-form expression.", "solution": "The objective is to derive the variance of the estimator $\\widehat{c}_j$, defined as $\\text{Var}(\\widehat{c}_j) = \\mathbb{E}\\left[ |\\widehat{c}_j - \\mathbb{E}[\\widehat{c}_j]|^2 \\right]$, where $\\mathbb{E}[\\cdot]$ denotes the expectation operator. The derivation proceeds in several steps, starting from the definition of the estimator and utilizing the statistical properties of the noise.\n\nFirst, we express the estimator $\\widehat{c}_j$ in terms of the signal components and the noise. The estimator is given by:\n$$\n\\widehat{c}_j = \\frac{Y}{G}\n$$\nwhere $Y$ is the bucket value:\n$$\nY = \\sum_{n=0}^{N-1} w[n] \\, x[n] \\, \\exp\\!\\big(-\\mathrm{i} 2 \\pi j n / N\\big)\n$$\nWe substitute the signal model $x[n] = c_j \\exp(\\mathrm{i} 2 \\pi j n / N) + \\eta[n]$ into the expression for $Y$:\n$$\nY = \\sum_{n=0}^{N-1} w[n] \\left( c_j \\exp(\\mathrm{i} 2 \\pi j n / N) + \\eta[n] \\right) \\exp(-\\mathrm{i} 2 \\pi j n / N)\n$$\nUsing the linearity of summation, we can separate the signal and noise contributions:\n$$\nY = \\sum_{n=0}^{N-1} w[n] c_j \\exp(\\mathrm{i} 2 \\pi j n / N) \\exp(-\\mathrm{i} 2 \\pi j n / N) + \\sum_{n=0}^{N-1} w[n] \\eta[n] \\exp(-\\mathrm{i} 2 \\pi j n / N)\n$$\nThe complex exponentials in the first term cancel, since $\\exp(z)\\exp(-z) = \\exp(0) = 1$. The constant $c_j$ can be factored out of the sum:\n$$\nY = c_j \\sum_{n=0}^{N-1} w[n] + \\sum_{n=0}^{N-1} w[n] \\eta[n] \\exp(-\\mathrm{i} 2 \\pi j n / N)\n$$\nUsing the given definition of the passband gain, $G = \\sum_{n=0}^{N-1} w[n]$, we have:\n$$\nY = c_j G + \\sum_{n=0}^{N-1} w[n] \\eta[n] \\exp(-\\mathrm{i} 2 \\pi j n / N)\n$$\nNow, we substitute this expression for $Y$ back into the definition of the estimator $\\widehat{c}_j$:\n$$\n\\widehat{c}_j = \\frac{c_j G + \\sum_{n=0}^{N-1} w[n] \\eta[n] \\exp(-\\mathrm{i} 2 \\pi j n / N)}{G} = c_j + \\frac{1}{G} \\sum_{n=0}^{N-1} w[n] \\eta[n] \\exp(-\\mathrm{i} 2 \\pi j n / N)\n$$\nThis expression shows that the estimator $\\widehat{c}_j$ is the sum of the true value $c_j$ and a random error term that depends on the noise $\\eta[n]$.\n\nNext, we compute the expected value of $\\widehat{c}_j$ to determine if the estimator is biased.\n$$\n\\mathbb{E}[\\widehat{c}_j] = \\mathbb{E}\\left[c_j + \\frac{1}{G} \\sum_{n=0}^{N-1} w[n] \\eta[n] \\exp(-\\mathrm{i} 2 \\pi j n / N)\\right]\n$$\nBy linearity of expectation, and since $c_j$, $G$, and $w[n]$ are deterministic:\n$$\n\\mathbb{E}[\\widehat{c}_j] = c_j + \\frac{1}{G} \\sum_{n=0}^{N-1} w[n] \\mathbb{E}[\\eta[n]] \\exp(-\\mathrm{i} 2 \\pi j n / N)\n$$\nThe noise is given as $\\eta[n] \\sim \\mathcal{CN}(0, \\sigma^2)$, which means it has zero mean, $\\mathbb{E}[\\eta[n]] = 0$ for all $n$. Therefore, the sum is zero:\n$$\n\\mathbb{E}[\\widehat{c}_j] = c_j + 0 = c_j\n$$\nThe estimator is unbiased.\n\nNow we can compute the variance of $\\widehat{c}_j$:\n$$\n\\text{Var}(\\widehat{c}_j) = \\mathbb{E}\\left[ |\\widehat{c}_j - \\mathbb{E}[\\widehat{c}_j]|^2 \\right] = \\mathbb{E}\\left[ |\\widehat{c}_j - c_j|^2 \\right]\n$$\nThe estimation error is $\\widehat{c}_j - c_j = \\frac{1}{G} \\sum_{n=0}^{N-1} w[n] \\eta[n] \\exp(-\\mathrm{i} 2 \\pi j n / N)$. Substituting this into the variance formula:\n$$\n\\text{Var}(\\widehat{c}_j) = \\mathbb{E}\\left[ \\left| \\frac{1}{G} \\sum_{n=0}^{N-1} w[n] \\eta[n] \\exp(-\\mathrm{i} 2 \\pi j n / N) \\right|^2 \\right]\n$$\nUsing the property $|z|^2 = z z^*$ for a complex number $z$, and letting $z$ be the error term:\n$$\n\\text{Var}(\\widehat{c}_j) = \\mathbb{E}\\left[ \\left(\\frac{1}{G} \\sum_{n=0}^{N-1} w[n] \\eta[n] e^{-\\mathrm{i} 2 \\pi j n / N}\\right) \\left(\\frac{1}{G^*} \\sum_{m=0}^{N-1} w[m]^* \\eta[m]^* e^{\\mathrm{i} 2 \\pi j m / N}\\right) \\right]\n$$\nwhere $G^*$ and $w[m]^*$ denote the complex conjugates. We can factor out the deterministic term $1/|G|^2$ and combine the sums:\n$$\n\\text{Var}(\\widehat{c}_j) = \\frac{1}{|G|^2} \\mathbb{E}\\left[ \\sum_{n=0}^{N-1} \\sum_{m=0}^{N-1} w[n] w[m]^* \\eta[n] \\eta[m]^* e^{-\\mathrm{i} 2 \\pi j (n-m) / N} \\right]\n$$\nMoving the expectation operator inside the sums:\n$$\n\\text{Var}(\\widehat{c}_j) = \\frac{1}{|G|^2} \\sum_{n=0}^{N-1} \\sum_{m=0}^{N-1} w[n] w[m]^* e^{-\\mathrm{i} 2 \\pi j (n-m) / N} \\mathbb{E}[\\eta[n] \\eta[m]^*]\n$$\nThe noise samples $\\eta[n]$ are independent and identically distributed, complex circularly symmetric with variance $\\sigma^2$. This implies that their auto-correlation is given by:\n$$\n\\mathbb{E}[\\eta[n] \\eta[m]^*] = \\sigma^2 \\delta_{nm}\n$$\nwhere $\\delta_{nm}$ is the Kronecker delta, equal to $1$ if $n=m$ and $0$ otherwise. Substituting this into the variance expression:\n$$\n\\text{Var}(\\widehat{c}_j) = \\frac{1}{|G|^2} \\sum_{n=0}^{N-1} \\sum_{m=0}^{N-1} w[n] w[m]^* e^{-\\mathrm{i} 2 \\pi j (n-m) / N} (\\sigma^2 \\delta_{nm})\n$$\nThe Kronecker delta collapses the inner sum over $m$, as terms are non-zero only when $m=n$:\n$$\n\\text{Var}(\\widehat{c}_j) = \\frac{\\sigma^2}{|G|^2} \\sum_{n=0}^{N-1} w[n] w[n]^* e^{-\\mathrm{i} 2 \\pi j (n-n) / N}\n$$\nSimplifying the expression, noting that $w[n]w[n]^* = |w[n]|^2$ and $e^0 = 1$:\n$$\n\\text{Var}(\\widehat{c}_j) = \\frac{\\sigma^2}{|G|^2} \\sum_{n=0}^{N-1} |w[n]|^2\n$$\nThis is the final closed-form expression for the variance of the estimator $\\widehat{c}_j$ in terms of $\\sigma^2$, $G$, and $w[n]$.", "answer": "$$\n\\boxed{\\frac{\\sigma^2 \\sum_{n=0}^{N-1} |w[n]|^2}{|G|^2}}\n$$", "id": "3477176"}]}