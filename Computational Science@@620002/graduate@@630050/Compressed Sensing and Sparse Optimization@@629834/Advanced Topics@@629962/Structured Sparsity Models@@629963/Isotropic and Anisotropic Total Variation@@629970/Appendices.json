{"hands_on_practices": [{"introduction": "To build a solid intuition for total variation (TV), it's best to start with a direct calculation. This exercise asks you to compute the isotropic and anisotropic TV for a small $3 \\times 3$ image patch from first principles. By working through the arithmetic, you will see exactly how the choice of the $\\ell_1$ norm versus the $\\ell_2$ norm for measuring gradients leads to different results and develop a pixel-level understanding of where these differences originate [@problem_id:3491268].", "problem": "Consider a discrete image model on a Cartesian grid with unit spacing. Let the discrete gradient at pixel $(i,j)$ be defined by the forward-difference operator with homogeneous Neumann boundary conditions (i.e., any forward difference that would access an out-of-bounds pixel is set to zero). Specifically, the discrete gradient at $(i,j)$ is the two-vector consisting of the forward horizontal and vertical differences at $(i,j)$. The anisotropic total variation (TV) of a discrete image is the sum, over all pixels, of the $\\ell_1$ norm of the discrete gradient vector at each pixel. The isotropic total variation is the sum, over all pixels, of the $\\ell_2$ norm of the discrete gradient vector at each pixel.\n\nYou are given the $3\\times 3$ image patch with pixel values\n$$\nU \\;=\\;\n\\begin{pmatrix}\n1 & 2 & 2 \\\\\n1 & 3 & 5 \\\\\n2 & 3 & 6\n\\end{pmatrix}.\n$$\nUsing only the above fundamental definitions and the stated boundary model, do the following:\n- Compute explicitly the anisotropic total variation and the isotropic total variation of $U$.\n- Explain concisely, from first principles of vector norms, why these two values differ numerically for this patch and identify the structural source of the difference at the pixel level.\n\nLet $D$ denote the exact difference between the anisotropic and isotropic total variations,\n$$\nD \\;=\\; \\mathrm{TV}_{\\mathrm{anisotropic}}(U) \\;-\\; \\mathrm{TV}_{\\mathrm{isotropic}}(U).\n$$\nReport $D$ as a single closed-form analytic expression. Do not round your answer.", "solution": "Let the discrete image be represented by the matrix $U$, where $U_{i,j}$ is the pixel value at row $i$ and column $j$. The grid is a $3 \\times 3$ Cartesian grid, so the indices $(i,j)$ range from $(1,1)$ to $(3,3)$. The given image is:\n$$\nU =\n\\begin{pmatrix}\n1 & 2 & 2 \\\\\n1 & 3 & 5 \\\\\n2 & 3 & 6\n\\end{pmatrix}\n$$\nThe discrete gradient at a pixel $(i,j)$ is a vector $\\nabla U_{i,j} = \\begin{pmatrix} (\\nabla_x U)_{i,j} \\\\ (\\nabla_y U)_{i,j} \\end{pmatrix}$. The components are defined by forward differences:\n$$\n(\\nabla_x U)_{i,j} = U_{i,j+1} - U_{i,j}\n$$\n$$\n(\\nabla_y U)_{i,j} = U_{i+1,j} - U_{i,j}\n$$\nThe homogeneous Neumann boundary conditions imply that any difference that requires an out-of-bounds pixel is set to zero. For a $3 \\times 3$ image, this means $(\\nabla_x U)_{i,3} = 0$ for $i \\in \\{1,2,3\\}$ and $(\\nabla_y U)_{3,j} = 0$ for $j \\in \\{1,2,3\\}$.\n\nFirst, we compute the discrete gradient vector for each of the $9$ pixels:\n- At $(1,1)$: $\\nabla U_{1,1} = \\begin{pmatrix} U_{1,2} - U_{1,1} \\\\ U_{2,1} - U_{1,1} \\end{pmatrix} = \\begin{pmatrix} 2 - 1 \\\\ 1 - 1 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$\n- At $(1,2)$: $\\nabla U_{1,2} = \\begin{pmatrix} U_{1,3} - U_{1,2} \\\\ U_{2,2} - U_{1,2} \\end{pmatrix} = \\begin{pmatrix} 2 - 2 \\\\ 3 - 2 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}$\n- At $(1,3)$: $\\nabla U_{1,3} = \\begin{pmatrix} 0 \\\\ U_{2,3} - U_{1,3} \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 5 - 2 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 3 \\end{pmatrix}$\n- At $(2,1)$: $\\nabla U_{2,1} = \\begin{pmatrix} U_{2,2} - U_{2,1} \\\\ U_{3,1} - U_{2,1} \\end{pmatrix} = \\begin{pmatrix} 3 - 1 \\\\ 2 - 1 \\end{pmatrix} = \\begin{pmatrix} 2 \\\\ 1 \\end{pmatrix}$\n- At $(2,2)$: $\\nabla U_{2,2} = \\begin{pmatrix} U_{2,3} - U_{2,2} \\\\ U_{3,2} - U_{2,2} \\end{pmatrix} = \\begin{pmatrix} 5 - 3 \\\\ 3 - 3 \\end{pmatrix} = \\begin{pmatrix} 2 \\\\ 0 \\end{pmatrix}$\n- At $(2,3)$: $\\nabla U_{2,3} = \\begin{pmatrix} 0 \\\\ U_{3,3} - U_{2,3} \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 6 - 5 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}$\n- At $(3,1)$: $\\nabla U_{3,1} = \\begin{pmatrix} U_{3,2} - U_{3,1} \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 3 - 2 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$\n- At $(3,2)$: $\\nabla U_{3,2} = \\begin{pmatrix} U_{3,3} - U_{3,2} \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 6 - 3 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 3 \\\\ 0 \\end{pmatrix}$\n- At $(3,3)$: $\\nabla U_{3,3} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}$\n\nNext, we compute the anisotropic total variation, $\\mathrm{TV}_{\\mathrm{anisotropic}}(U)$, which is the sum of the $\\ell_1$ norms of these gradient vectors. For a vector $v = \\begin{pmatrix} v_x \\\\ v_y \\end{pmatrix}$, its $\\ell_1$ norm is $\\|v\\|_1 = |v_x| + |v_y|$.\n$$\n\\mathrm{TV}_{\\mathrm{anisotropic}}(U) = \\sum_{i=1}^{3} \\sum_{j=1}^{3} \\|\\nabla U_{i,j}\\|_1\n$$\n$$\n\\mathrm{TV}_{\\mathrm{anisotropic}}(U) = (|1|+|0|) + (|0|+|1|) + (|0|+|3|) + (|2|+|1|) + (|2|+|0|) + (|0|+|1|) + (|1|+|0|) + (|3|+|0|) + (|0|+|0|)\n$$\n$$\n\\mathrm{TV}_{\\mathrm{anisotropic}}(U) = 1 + 1 + 3 + 3 + 2 + 1 + 1 + 3 + 0 = 15\n$$\n\nThen, we compute the isotropic total variation, $\\mathrm{TV}_{\\mathrm{isotropic}}(U)$, which is the sum of the $\\ell_2$ norms. For a vector $v = \\begin{pmatrix} v_x \\\\ v_y \\end{pmatrix}$, its $\\ell_2$ norm is $\\|v\\|_2 = \\sqrt{v_x^2 + v_y^2}$.\n$$\n\\mathrm{TV}_{\\mathrm{isotropic}}(U) = \\sum_{i=1}^{3} \\sum_{j=1}^{3} \\|\\nabla U_{i,j}\\|_2\n$$\n$$\n\\mathrm{TV}_{\\mathrm{isotropic}}(U) = \\sqrt{1^2+0^2} + \\sqrt{0^2+1^2} + \\sqrt{0^2+3^2} + \\sqrt{2^2+1^2} + \\sqrt{2^2+0^2} + \\sqrt{0^2+1^2} + \\sqrt{1^2+0^2} + \\sqrt{3^2+0^2} + \\sqrt{0^2+0^2}\n$$\n$$\n\\mathrm{TV}_{\\mathrm{isotropic}}(U) = 1 + 1 + 3 + \\sqrt{5} + 2 + 1 + 1 + 3 + 0 = 12 + \\sqrt{5}\n$$\n\nThe two values differ because of the fundamental properties of the $\\ell_1$ and $\\ell_2$ norms. For any vector $v$ in $\\mathbb{R}^n$, the inequality $\\|v\\|_1 \\ge \\|v\\|_2$ holds. In our case, for a $2$-dimensional gradient vector $v = \\begin{pmatrix} v_x \\\\ v_y \\end{pmatrix}$, we have $\\|v\\|_1 = |v_x|+|v_y|$ and $\\|v\\|_2 = \\sqrt{v_x^2+v_y^2}$. Equality, $|v_x|+|v_y| = \\sqrt{v_x^2+v_y^2}$, holds if and only if at least one component, $v_x$ or $v_y$, is zero. This corresponds to a gradient that is purely horizontal or purely vertical.\n\nThe numerical difference between $\\mathrm{TV}_{\\mathrm{anisotropic}}(U)$ and $\\mathrm{TV}_{\\mathrm{isotropic}}(U)$ arises from the sum of the differences $\\|\\nabla U_{i,j}\\|_1 - \\|\\nabla U_{i,j}\\|_2$ over all pixels. This difference is non-zero only at pixels where both components of the gradient vector are non-zero.\nExamining our computed gradients, only the pixel at $(2,1)$ has a gradient vector with two non-zero components: $\\nabla U_{2,1} = \\begin{pmatrix} 2 \\\\ 1 \\end{pmatrix}$. For all other pixels, the gradient vector has at least one zero component, meaning $\\|\\nabla U_{i,j}\\|_1 = \\|\\nabla U_{i,j}\\|_2$ for all $(i,j) \\neq (2,1)$.\nThe structural source of the difference is therefore located entirely at pixel $(2,1)$, which represents a corner or a point where the image intensity changes in both the horizontal and vertical directions simultaneously.\n\nFinally, we compute the exact difference $D$:\n$$\nD = \\mathrm{TV}_{\\mathrm{anisotropic}}(U) - \\mathrm{TV}_{\\mathrm{isotropic}}(U)\n$$\nThis difference is the sum of the term-by-term differences, which simplifies to the difference at the single contributing pixel:\n$$\nD = (\\|\\nabla U_{2,1}\\|_1 - \\|\\nabla U_{2,1}\\|_2) = (|2|+|1|) - \\sqrt{2^2+1^2} = 3 - \\sqrt{5}\n$$\nAlternatively, using the total computed values:\n$$\nD = 15 - (12 + \\sqrt{5}) = 3 - \\sqrt{5}\n$$\nThe result is consistent.", "answer": "$$\n\\boxed{3 - \\sqrt{5}}\n$$", "id": "3491268"}, {"introduction": "Moving from calculation to construction deepens our understanding. This practice challenges you to design two simple images: one with purely axis-aligned features and another with a diagonal feature, such that their isotropic TV values are identical. By then comparing their anisotropic TV values, you will actively demonstrate and quantify the core difference between the two regularizers: the anisotropic TV's preferential penalization of features that are not aligned with the grid axes [@problem_id:3453942]. This reveals the source of the \"anisotropy\" in its name.", "problem": "Consider two grayscale images defined on a $2 \\times 2$ grid with pixel intensities $u_{i,j}$ and $v_{i,j}$ for $i,j \\in \\{1,2\\}$. Use the standard forward-difference discretization of the gradient with no wrap-around: for an image $w$, define $D_{x} w_{i,j} = w_{i+1,j} - w_{i,j}$ if $i+1 \\leq 2$ and $D_{x} w_{i,j} = 0$ otherwise; similarly $D_{y} w_{i,j} = w_{i,j+1} - w_{i,j}$ if $j+1 \\leq 2$ and $D_{y} w_{i,j} = 0$ otherwise. The isotropic Total Variation (TV) is\n$$\n\\mathrm{TV}_{\\mathrm{iso}}(w) = \\sum_{i=1}^{2} \\sum_{j=1}^{2} \\sqrt{\\left(D_{x} w_{i,j}\\right)^{2} + \\left(D_{y} w_{i,j}\\right)^{2}},\n$$\nand the anisotropic Total Variation is\n$$\n\\mathrm{TV}_{\\mathrm{aniso}}(w) = \\sum_{i=1}^{2} \\sum_{j=1}^{2} \\left| D_{x} w_{i,j} \\right| + \\left| D_{y} w_{i,j} \\right|.\n$$\nConstruct the following two images parameterized by a fixed amplitude $A > 0$.\n- Image $u$: set $u_{1,1} = 0$, $u_{2,1} = A$, $u_{1,2} = 0$, and $u_{2,2} = A$.\n- Image $v$: set $v_{1,1} = 0$, $v_{2,1} = t$, $v_{1,2} = t$, and $v_{2,2} = t + s$, where $t > 0$ and $s > 0$ are to be chosen such that $t = s$ and $\\mathrm{TV}_{\\mathrm{iso}}(v) = \\mathrm{TV}_{\\mathrm{iso}}(u)$.\n\nStarting only from these definitions, first determine the value of $t$ that enforces $\\mathrm{TV}_{\\mathrm{iso}}(v) = \\mathrm{TV}_{\\mathrm{iso}}(u)$ under the constraint $t = s$. Then compute the ratio\n$$\nR \\equiv \\frac{\\mathrm{TV}_{\\mathrm{aniso}}(v)}{\\mathrm{TV}_{\\mathrm{aniso}}(u)}.\n$$\nGive your final answer for $R$ as an exact closed-form expression. Briefly, in your derivation, explain the structural feature of the two images that causes $\\mathrm{TV}_{\\mathrm{aniso}}$ to differ even when $\\mathrm{TV}_{\\mathrm{iso}}$ is matched. No rounding is required.", "solution": "The problem requires us to compute the ratio of the anisotropic total variations of two images, $u$ and $v$, under the constraint that their isotropic total variations are equal. We begin by analyzing each image separately.\n\nWe interpret the image $w$ as a matrix where the first index $i$ denotes the row and the second index $j$ denotes the column:\n$$\nw = \\begin{pmatrix} w_{1,1} & w_{1,2} \\\\ w_{2,1} & w_{2,2} \\end{pmatrix}\n$$\nBased on the provided definitions, the operator $D_x$ computes differences between rows (a vertical gradient component), and $D_y$ computes differences between columns (a horizontal gradient component).\n\n**1. Analysis of Image $u$**\nThe pixel values for image $u$ are given as $u_{1,1} = 0$, $u_{2,1} = A$, $u_{1,2} = 0$, and $u_{2,2} = A$. In matrix form:\n$$\nu = \\begin{pmatrix} 0 & 0 \\\\ A & A \\end{pmatrix}\n$$\nWe compute the gradient components $(D_x u_{i,j}, D_y u_{i,j})$ at each pixel $(i,j)$:\n-   At $(1,1)$: $D_x u_{1,1} = u_{2,1} - u_{1,1} = A - 0 = A$. $D_y u_{1,1} = u_{1,2} - u_{1,1} = 0 - 0 = 0$. Gradient: $(A, 0)$.\n-   At $(1,2)$: $D_x u_{1,2} = u_{2,2} - u_{1,2} = A - 0 = A$. $D_y u_{1,2} = 0$ (boundary). Gradient: $(A, 0)$.\n-   At $(2,1)$: $D_x u_{2,1} = 0$ (boundary). $D_y u_{2,1} = u_{2,2} - u_{2,1} = A - A = 0$. Gradient: $(0, 0)$.\n-   At $(2,2)$: $D_x u_{2,2} = 0$ (boundary). $D_y u_{2,2} = 0$ (boundary). Gradient: $(0, 0)$.\n\nNow we compute the total variation measures for $u$, given $A > 0$:\n$$\n\\mathrm{TV}_{\\mathrm{iso}}(u) = \\sqrt{A^2 + 0^2} + \\sqrt{A^2 + 0^2} + \\sqrt{0^2 + 0^2} + \\sqrt{0^2 + 0^2} = A + A = 2A\n$$\n$$\n\\mathrm{TV}_{\\mathrm{aniso}}(u) = (|A| + |0|) + (|A| + |0|) + (|0| + |0|) + (|0| + |0|) = A + A = 2A\n$$\n\n**2. Analysis of Image $v$**\nThe pixel values for image $v$ with the constraint $s=t$ are $v_{1,1} = 0$, $v_{2,1} = t$, $v_{1,2} = t$, and $v_{2,2} = 2t$. In matrix form:\n$$\nv = \\begin{pmatrix} 0 & t \\\\ t & 2t \\end{pmatrix}\n$$\nWe compute the gradient components $(D_x v_{i,j}, D_y v_{i,j})$ at each pixel $(i,j)$:\n-   At $(1,1)$: $D_x v_{1,1} = v_{2,1} - v_{1,1} = t - 0 = t$. $D_y v_{1,1} = v_{1,2} - v_{1,1} = t - 0 = t$. Gradient: $(t, t)$.\n-   At $(1,2)$: $D_x v_{1,2} = v_{2,2} - v_{1,2} = 2t - t = t$. $D_y v_{1,2} = 0$ (boundary). Gradient: $(t, 0)$.\n-   At $(2,1)$: $D_x v_{2,1} = 0$ (boundary). $D_y v_{2,1} = v_{2,2} - v_{2,1} = 2t - t = t$. Gradient: $(0, t)$.\n-   At $(2,2)$: $D_x v_{2,2} = 0$ (boundary). $D_y v_{2,2} = 0$ (boundary). Gradient: $(0, 0)$.\n\nFirst, we compute the isotropic TV for $v$. Given $t > 0$:\n$$\n\\mathrm{TV}_{\\mathrm{iso}}(v) = \\sqrt{t^2 + t^2} + \\sqrt{t^2 + 0^2} + \\sqrt{0^2 + t^2} + \\sqrt{0^2 + 0^2} = \\sqrt{2t^2} + \\sqrt{t^2} + \\sqrt{t^2} = \\sqrt{2}t + t + t = (2 + \\sqrt{2})t\n$$\n\n**3. Determine the parameter $t$**\nThe problem imposes the constraint $\\mathrm{TV}_{\\mathrm{iso}}(v) = \\mathrm{TV}_{\\mathrm{iso}}(u)$. Using our derived expressions:\n$$\n(2 + \\sqrt{2})t = 2A\n$$\nSolving for $t$ in terms of $A$:\n$$\nt = \\frac{2A}{2 + \\sqrt{2}} = \\frac{2A(2 - \\sqrt{2})}{(2 + \\sqrt{2})(2 - \\sqrt{2})} = \\frac{2A(2 - \\sqrt{2})}{4 - 2} = \\frac{2A(2 - \\sqrt{2})}{2} = A(2 - \\sqrt{2})\n$$\n\n**4. Compute the Ratio $R$**\nNext, we compute the anisotropic TV for $v$:\n$$\n\\mathrm{TV}_{\\mathrm{aniso}}(v) = (|t| + |t|) + (|t| + |0|) + (|0| + |t|) + (|0| + |0|) = 2t + t + t = 4t\n$$\nFinally, we compute the desired ratio $R$:\n$$\nR = \\frac{\\mathrm{TV}_{\\mathrm{aniso}}(v)}{\\mathrm{TV}_{\\mathrm{aniso}}(u)} = \\frac{4t}{2A} = \\frac{2t}{A}\n$$\nSubstituting the expression for $t$:\n$$\nR = \\frac{2 \\cdot A(2 - \\sqrt{2})}{A} = 2(2 - \\sqrt{2}) = 4 - 2\\sqrt{2}\n$$\n\n**Brief Explanation of Structural Difference**\nThe core reason for $R \\neq 1$ lies in how isotropic and anisotropic TV penalize different gradient orientations. $\\mathrm{TV}_{\\mathrm{iso}}$ computes the sum of $\\ell_2$ norms of the gradient vectors $(\\| \\nabla w_{i,j} \\|_2 = \\sqrt{(D_x w_{i,j})^2 + (D_y w_{i,j})^2})$, while $\\mathrm{TV}_{\\mathrm{aniso}}$ computes the sum of $\\ell_1$ norms $(\\| \\nabla w_{i,j} \\|_1 = |D_x w_{i,j}| + |D_y w_{i,j}|)$.\n\nThe ratio of these norms, $\\frac{\\| \\nabla w_{i,j} \\|_1}{\\| \\nabla w_{i,j} \\|_2}$, depends on the gradient's direction. For an axis-aligned gradient like $(g, 0)$, this ratio is $\\frac{|g|}{ \\sqrt{g^2}} = 1$. For a diagonal gradient like $(g, g)$, this ratio is $\\frac{|g| + |g|}{\\sqrt{g^2 + g^2}} = \\frac{2|g|}{\\sqrt{2}|g|} = \\sqrt{2}$.\n\nImage $u$ is constructed from purely axis-aligned gradients (specifically, vertical ones in our coordinate system), so for its non-zero gradient components, the $\\ell_1$ and $\\ell_2$ norms are identical. Consequently, $\\mathrm{TV}_{\\mathrm{aniso}}(u) = \\mathrm{TV}_{\\mathrm{iso}}(u) = 2A$.\n\nImage $v$, however, contains a mix of gradient orientations: one diagonal gradient at $(1,1)$, and two axis-aligned gradients. The diagonal gradient is penalized more heavily by the $\\ell_1$ norm (anisotropic TV) relative to its $\\ell_2$ norm contribution. By forcing the isotropic TVs (sum of $\\ell_2$ norms) to be equal, the differing penalty structure ensures that the anisotropic TVs (sum of $\\ell_1$ norms) will not be equal. Specifically, the presence of the diagonal feature in image $v$ elevates its anisotropic TV value relative to that of image $u$.", "answer": "$$\n\\boxed{4 - 2\\sqrt{2}}\n$$", "id": "3453942"}, {"introduction": "This advanced exercise bridges the gap from discrete pixel grids to the continuous domain, providing a more general and powerful perspective on anisotropy. You will analyze a classic test pattern—a rotated checkerboard—to determine how the ratio of anisotropic to isotropic TV behaves as a function of the image features' orientation. By taking the limit as the grid becomes infinitely fine, this practice [@problem_id:3453907] reveals a clean, analytical relationship that precisely quantifies the rotational variance of anisotropic TV, a fundamental concept in the theoretical analysis of image processing models.", "problem": "Consider a bounded square domain $\\Omega = [0,L] \\times [0,L]$ with periodic boundary conditions, where $L > 0$. Let $a > 0$ be such that $L/a \\in \\mathbb{N}$, so that an unrotated checkerboard of square tiles of side length $a$ fits perfectly in $\\Omega$. Define a binary image $u_{\\theta} : \\Omega \\to \\{0,A\\}$ with contrast amplitude $A > 0$ as the characteristic function of a rotated checkerboard: $u_{\\theta}(x,y) = A$ on alternating squares of side $a$ whose boundaries form two orthogonal families of parallel lines, each family rotated by an angle $\\theta \\in [0,\\pi/2]$ with respect to the $x$-axis, and $u_{\\theta}(x,y) = 0$ on the complementary squares. The boundary of the set $\\{(x,y) \\in \\Omega : u_{\\theta}(x,y) = A\\}$ is thus a union of straight line segments at orientations $\\theta$ and $\\theta + \\pi/2$, periodically tiling $\\Omega$.\n\nFor a uniform Cartesian grid of spacing $h = L/N$ with $N \\in \\mathbb{N}$, sample $u_{\\theta}$ at grid nodes $(i h, j h)$ with $i,j \\in \\{0,1,\\dots,N-1\\}$, and define the discrete forward differences with periodic wrap-around. The discrete anisotropic total variation is\n$$\nTV_{\\mathrm{aniso}}^{h}(u_{\\theta}) \\;=\\; \\sum_{i=0}^{N-1}\\sum_{j=0}^{N-1} \\Big( \\big|u_{\\theta}((i+1)h,jh) - u_{\\theta}(ih,jh)\\big| \\;+\\; \\big|u_{\\theta}(ih,(j+1)h) - u_{\\theta}(ih,jh)\\big| \\Big),\n$$\nand the discrete isotropic total variation is\n$$\nTV_{\\mathrm{iso}}^{h}(u_{\\theta}) \\;=\\; \\sum_{i=0}^{N-1}\\sum_{j=0}^{N-1} \\sqrt{ \\big(u_{\\theta}((i+1)h,jh) - u_{\\theta}(ih,jh)\\big)^{2} \\;+\\; \\big(u_{\\theta}(ih,(j+1)h) - u_{\\theta}(ih,jh)\\big)^{2} }.\n$$\n\nUsing only fundamental definitions of total variation and well-tested facts about the convergence of discrete total variation functionals to their continuum counterparts as $h \\to 0$, derive the continuum limits of these functionals for the rotated checkerboard configuration and compute the exact closed-form expression of the limit ratio\n$$\nR(\\theta) \\;=\\; \\lim_{h \\to 0} \\frac{TV_{\\mathrm{aniso}}^{h}(u_{\\theta})}{TV_{\\mathrm{iso}}^{h}(u_{\\theta})}\n$$\nas an analytic function of $\\theta$ for $\\theta \\in [0,\\pi/2]$. Your final answer must be a single closed-form expression for $R(\\theta)$, simplified as much as possible. No numerical rounding is required.", "solution": "The problem requires the calculation of the limit ratio of two discrete total variation (TV) functionals as the grid spacing $h$ approaches $0$. The core principle to be used is the convergence of these discrete functionals to their continuous counterparts.\n\nFor a function $u \\in L^1(\\Omega)$, the discrete functionals $TV_{\\mathrm{aniso}}^{h}(u)$ and $TV_{\\mathrm{iso}}^{h}(u)$ (after proper scaling) converge to continuous total variation functionals in the limit $h \\to 0$. The limiting functionals are defined based on the distributional gradient $\\nabla u$.\n\nThe continuous isotropic total variation, commonly denoted as $TV(u)$, corresponds to the $\\ell_2$-norm of the gradient. For a sufficiently smooth function $u$, it is given by $\\mathrm{TV}_{\\mathrm{iso}}(u) = \\int_{\\Omega} \\|\\nabla u\\|_2 \\,dx\\,dy = \\int_{\\Omega} \\sqrt{(\\frac{\\partial u}{\\partial x})^2 + (\\frac{\\partial u}{\\partial y})^2} \\,dx\\,dy$.\nThe continuous anisotropic total variation corresponds to the $\\ell_1$-norm of the gradient components: $\\mathrm{TV}_{\\mathrm{aniso}}(u) = \\int_{\\Omega} \\|\\nabla u\\|_1 \\,dx\\,dy = \\int_{\\Omega} (|\\frac{\\partial u}{\\partial x}| + |\\frac{\\partial u}{\\partial y}|) \\,dx\\,dy$.\n\nThe ratio $R(\\theta)$ is the ratio of these continuum functionals evaluated for the function $u_\\theta$:\n$$ R(\\theta) = \\frac{\\mathrm{TV}_{\\mathrm{aniso}}(u_{\\theta})}{\\mathrm{TV}_{\\mathrm{iso}}(u_{\\theta})} $$\n\nThe function $u_{\\theta}$ is a piecewise constant function, taking values $0$ and $A$. For such functions, which are of bounded variation (BV), the gradient $\\nabla u_\\theta$ is a measure concentrated on the set of discontinuities, which we denote as $S$. The set $S$ is the union of all boundary segments between the black and white regions of the checkerboard.\nFor a piecewise constant function with jump set $S$, the continuous TV functionals can be expressed using the coarea formula for BV functions:\n$$ \\mathrm{TV}_{\\mathrm{iso}}(u_{\\theta}) = \\int_S |[u_{\\theta}]| \\,d\\mathcal{H}^1 $$\n$$ \\mathrm{TV}_{\\mathrm{aniso}}(u_{\\theta}) = \\int_S |[u_{\\theta}]| (|\\nu_x| + |\\nu_y|) \\,d\\mathcal{H}^1 $$\nHere, $[u_{\\theta}]$ is the jump in the function value across the interface $S$, $\\nu = (\\nu_x, \\nu_y)$ is the unit normal vector to the interface, and $\\mathcal{H}^1$ is the $1$-dimensional Hausdorff measure, which corresponds to the arc length of the interface $S$.\n\nFor the given checkerboard function $u_{\\theta}$, the jump is constant along the entire interface $S$: $|[u_{\\theta}]| = |A - 0| = A$.\n\nThe next step is to analyze the geometry of the interface $S$. The interface consists of a periodic grid of line segments. Within the domain $\\Omega = [0,L] \\times [0,L]$, this grid is formed by two orthogonal families of parallel lines. The density of lines for an unrotated grid of spacing $a$ is $1/a$ in the x-direction and $1/a$ in the y-direction, yielding a total line length per unit area of $2/a$. Rotation does not change the total length of the line segments within a large area. Therefore, the total length of the interface $S$ within the domain $\\Omega$ is:\n$$ \\mathcal{L}(S) = \\int_S d\\mathcal{H}^1 = \\frac{2}{a} \\times (\\text{Area of } \\Omega) = \\frac{2L^2}{a} $$\n\nNow, we can calculate the continuum isotropic TV:\n$$ \\mathrm{TV}_{\\mathrm{iso}}(u_{\\theta}) = \\int_S A \\,d\\mathcal{H}^1 = A \\int_S d\\mathcal{H}^1 = A \\cdot \\mathcal{L}(S) = \\frac{2AL^2}{a} $$\nNotably, this value is independent of the rotation angle $\\theta$, as it only depends on the total length of the interface.\n\nNext, we calculate the continuum anisotropic TV. The interface $S$ is composed of two sets of segments:\n1. $S_1$: Segments with orientation $\\theta$. The normal vector to these segments is oriented at $\\theta \\pm \\pi/2$. Let's take $\\nu_1 = (\\cos(\\theta+\\pi/2), \\sin(\\theta+\\pi/2)) = (-\\sin\\theta, \\cos\\theta)$. The magnitudes of its components are $|\\nu_{1,x}| = |\\sin\\theta|$ and $|\\nu_{1,y}| = |\\cos\\theta|$.\n2. $S_2$: Segments with orientation $\\theta+\\pi/2$. The normal vector to these segments is oriented at $(\\theta+\\pi/2) \\pm \\pi/2$, i.e., at $\\theta$ or $\\theta+\\pi$. Let's take $\\nu_2 = (\\cos\\theta, \\sin\\theta)$. The magnitudes of its components are $|\\nu_{2,x}| = |\\cos\\theta|$ and $|\\nu_{2,y}| = |\\sin\\theta|$.\n\nSince the checkerboard is made of squares, the total length of segments in family $S_1$ is equal to the total length of segments in family $S_2$.\n$$ \\mathcal{L}(S_1) = \\mathcal{L}(S_2) = \\frac{1}{2}\\mathcal{L}(S) = \\frac{L^2}{a} $$\nThe anisotropic TV can be split into integrals over $S_1$ and $S_2$:\n$$ \\mathrm{TV}_{\\mathrm{aniso}}(u_{\\theta}) = \\int_{S_1} A (|\\nu_{1,x}| + |\\nu_{1,y}|) \\,d\\mathcal{H}^1 + \\int_{S_2} A (|\\nu_{2,x}| + |\\nu_{2,y}|) \\,d\\mathcal{H}^1 $$\nSince the normal vector components are constant on each family of segments, we can pull the integrands out of the integrals:\n$$ \\mathrm{TV}_{\\mathrm{aniso}}(u_{\\theta}) = A (|\\sin\\theta| + |\\cos\\theta|) \\int_{S_1} d\\mathcal{H}^1 + A (|\\cos\\theta| + |\\sin\\theta|) \\int_{S_2} d\\mathcal{H}^1 $$\n$$ \\mathrm{TV}_{\\mathrm{aniso}}(u_{\\theta}) = A (|\\sin\\theta| + |\\cos\\theta|) \\mathcal{L}(S_1) + A (|\\cos\\theta| + |\\sin\\theta|) \\mathcal{L}(S_2) $$\nSubstituting the lengths $\\mathcal{L}(S_1) = \\mathcal{L}(S_2) = L^2/a$:\n$$ \\mathrm{TV}_{\\mathrm{aniso}}(u_{\\theta}) = A (|\\sin\\theta| + |\\cos\\theta|) \\frac{L^2}{a} + A (|\\cos\\theta| + |\\sin\\theta|) \\frac{L^2}{a} $$\n$$ \\mathrm{TV}_{\\mathrm{aniso}}(u_{\\theta}) = 2A (|\\sin\\theta| + |\\cos\\theta|) \\frac{L^2}{a} $$\nThe problem specifies that $\\theta \\in [0, \\pi/2]$. In this interval, both $\\sin\\theta \\ge 0$ and $\\cos\\theta \\ge 0$. Thus, the absolute value signs can be removed.\n$$ \\mathrm{TV}_{\\mathrm{aniso}}(u_{\\theta}) = \\frac{2AL^2}{a} (\\sin\\theta + \\cos\\theta) $$\n\nFinally, we compute the ratio $R(\\theta)$:\n$$ R(\\theta) = \\frac{\\mathrm{TV}_{\\mathrm{aniso}}(u_{\\theta})}{\\mathrm{TV}_{\\mathrm{iso}}(u_{\\theta})} = \\frac{\\frac{2AL^2}{a} (\\sin\\theta + \\cos\\theta)}{\\frac{2AL^2}{a}} $$\nAll the constants $A$, $L$, and $a$ cancel out, yielding the final expression:\n$$ R(\\theta) = \\sin\\theta + \\cos\\theta $$\nThis function quantifies the degree of anisotropy of the $\\mathrm{TV}_{\\mathrm{aniso}}$ functional. It has a minimum value of $1$ at $\\theta=0$ and $\\theta=\\pi/2$ (axis-aligned features) and a maximum value of $\\sqrt{2}$ at $\\theta=\\pi/4$ (diagonal features), reflecting the fact that the anisotropic TV penalizes diagonal edges more heavily than axis-aligned ones.", "answer": "$$\\boxed{\\sin(\\theta) + \\cos(\\theta)}$$", "id": "3453907"}]}