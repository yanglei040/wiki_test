{"hands_on_practices": [{"introduction": "The foundation of any finite element is its set of degrees of freedom (DOFs), which uniquely determine the basis functions. Unlike standard nodal elements where DOFs are function values at vertices, first-order Nédélec elements are defined by the circulation of the vector field along each edge. This practice provides a direct, hands-on calculation of these edge-based DOFs for a given vector field, grounding the abstract definition in a concrete computational exercise. [@problem_id:3308339]", "problem": "Consider the reference triangle with vertices $\\mathbf{v}_{1}=(0,0)$, $\\mathbf{v}_{2}=(1,0)$, and $\\mathbf{v}_{3}=(0,1)$ in the plane. Let the vector field be $\\mathbf{u}(x,y)=(x+y,\\,1-x)$. Adopt the counterclockwise boundary orientation and define the oriented edges as $e_{1}:\\mathbf{v}_{1}\\to\\mathbf{v}_{2}$, $e_{2}:\\mathbf{v}_{2}\\to\\mathbf{v}_{3}$, and $e_{3}:\\mathbf{v}_{3}\\to\\mathbf{v}_{1}$, with $\\mathbf{t}_{i}$ denoting the corresponding unit tangent on $e_{i}$ for $i\\in\\{1,2,3\\}$.\n\nUsing the fundamental law that the tangential component of the electric field is continuous across interfaces in Maxwell’s equations and the definition of the first-family, first-order Nédélec (edge) element degrees of freedom on a triangle as line integrals of the tangential component along each oriented edge, compute the three circulations $\\int_{e_{i}}\\mathbf{u}\\cdot\\mathbf{t}_{i}\\,ds$ for $i=1,2,3$.\n\nInterpret these three values as the degrees of freedom for the first-order Nédélec edge element associated with $\\mathbf{u}$ on the given triangle. Report your final answer as a single row matrix in the order $\\left(e_{1},e_{2},e_{3}\\right)$. No rounding is required, and no physical units are to be included in the final answer.", "solution": "The problem statement is formally validated as sound. It is scientifically grounded in the theory of finite element methods for computational electromagnetics, specifically concerning first-order Nédélec edge elements. The problem is well-posed, providing all necessary information: the geometry of the element (a reference triangle), the vector field to be approximated, and the precise definition of the degrees of freedom to be computed. The data are self-contained and consistent, and the terminology is unambiguous.\n\nThe degrees of freedom (DoFs) for a first-order Nédélec edge element on a triangle are defined as the line integrals of the vector field's tangential component along each of the three oriented edges. These are also known as the circulations along the edges. We are tasked with computing these three values for the vector field $\\mathbf{u}(x,y)=(x+y, 1-x)$ on the reference triangle $K$ with vertices $\\mathbf{v}_{1}=(0,0)$, $\\mathbf{v}_{2}=(1,0)$, and $\\mathbf{v}_{3}=(0,1)$. The edges are oriented counterclockwise: $e_{1}$ from $\\mathbf{v}_{1}$ to $\\mathbf{v}_{2}$, $e_{2}$ from $\\mathbf{v}_{2}$ to $\\mathbf{v}_{3}$, and $e_{3}$ from $\\mathbf{v}_{3}$ to $\\mathbf{v}_{1}$.\n\nThe DoF associated with an edge $e_{i}$ is given by the integral $\\alpha_{i} = \\int_{e_{i}} \\mathbf{u} \\cdot \\mathbf{t}_{i} \\, ds$, where $\\mathbf{t}_{i}$ is the unit tangent vector. To compute this, we parameterize each edge $e_{i}$ by a vector function $\\mathbf{r}_{i}(t)$ for $t$ in a specified interval, typically $[0,1]$. The integral then becomes $\\int_{a}^{b} \\mathbf{u}(\\mathbf{r}_{i}(t)) \\cdot \\mathbf{r}'_{i}(t) \\, dt$.\n\n**Computation for edge $e_{1}$:**\nThe edge $e_{1}$ connects $\\mathbf{v}_{1}=(0,0)$ to $\\mathbf{v}_{2}=(1,0)$. We can parameterize this edge as $\\mathbf{r}_{1}(t) = (t,0)$ for $t \\in [0,1]$.\nThe corresponding tangent vector is $\\mathbf{r}'_{1}(t) = (1,0)$.\nThe vector field $\\mathbf{u}$ evaluated along this path is $\\mathbf{u}(\\mathbf{r}_{1}(t)) = \\mathbf{u}(t,0) = (t+0, 1-t) = (t, 1-t)$.\nThe integrand is the dot product $\\mathbf{u}(\\mathbf{r}_{1}(t)) \\cdot \\mathbf{r}'_{1}(t) = (t, 1-t) \\cdot (1,0) = t$.\nThe first degree of freedom is the integral:\n$$\n\\alpha_{1} = \\int_{0}^{1} t \\, dt = \\left[ \\frac{1}{2}t^{2} \\right]_{0}^{1} = \\frac{1}{2} - 0 = \\frac{1}{2}\n$$\n\n**Computation for edge $e_{2}$:**\nThe edge $e_{2}$ connects $\\mathbf{v}_{2}=(1,0)$ to $\\mathbf{v}_{3}=(0,1)$. A standard linear parameterization is $\\mathbf{r}_{2}(t) = (1-t)\\mathbf{v}_{2} + t\\mathbf{v}_{3} = (1-t)(1,0) + t(0,1) = (1-t, t)$ for $t \\in [0,1]$.\nThe tangent vector is $\\mathbf{r}'_{2}(t) = (-1,1)$.\nThe vector field along this path is $\\mathbf{u}(\\mathbf{r}_{2}(t)) = \\mathbf{u}(1-t, t) = ((1-t)+t, 1-(1-t)) = (1, t)$.\nThe integrand is the dot product $\\mathbf{u}(\\mathbf{r}_{2}(t)) \\cdot \\mathbf{r}'_{2}(t) = (1, t) \\cdot (-1,1) = -1 + t$.\nThe second degree of freedom is the integral:\n$$\n\\alpha_{2} = \\int_{0}^{1} (t-1) \\, dt = \\left[ \\frac{1}{2}t^{2} - t \\right]_{0}^{1} = \\left(\\frac{1}{2} - 1\\right) - (0) = -\\frac{1}{2}\n$$\n\n**Computation for edge $e_{3}$:**\nThe edge $e_{3}$ connects $\\mathbf{v}_{3}=(0,1)$ to $\\mathbf{v}_{1}=(0,0)$. This is parameterized as $\\mathbf{r}_{3}(t) = (1-t)\\mathbf{v}_{3} + t\\mathbf{v}_{1} = (1-t)(0,1) + t(0,0) = (0, 1-t)$ for $t \\in [0,1]$.\nThe tangent vector is $\\mathbf{r}'_{3}(t) = (0,-1)$.\nThe vector field along this path is $\\mathbf{u}(\\mathbf{r}_{3}(t)) = \\mathbf{u}(0, 1-t) = (0+(1-t), 1-0) = (1-t, 1)$.\nThe integrand is the dot product $\\mathbf{u}(\\mathbf{r}_{3}(t)) \\cdot \\mathbf{r}'_{3}(t) = (1-t, 1) \\cdot (0,-1) = -1$.\nThe third degree of freedom is the integral:\n$$\n\\alpha_{3} = \\int_{0}^{1} -1 \\, dt = \\left[ -t \\right]_{0}^{1} = -1 - 0 = -1\n$$\n\nThe computed degrees of freedom for the edges $e_{1}$, $e_{2}$, and $e_{3}$ are $\\frac{1}{2}$, $-\\frac{1}{2}$, and $-1$, respectively. These are to be reported as a single row matrix in this order.", "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{1}{2} & -\\frac{1}{2} & -1 \\end{pmatrix}}\n$$", "id": "3308339"}, {"introduction": "A defining characteristic of first-order Nédélec elements, and the primary reason for their use in electromagnetics, is that they naturally belong to the function space $H(\\mathbf{curl})$. This exercise explores the mathematical structure of the basis functions in three dimensions, guiding you through a derivation using standard vector calculus identities. By proving that the curl of a Nédélec basis function is a constant vector field, you will uncover the fundamental property that makes these elements essential for robustly discretizing curl-based equations. [@problem_id:3308336]", "problem": "Let $K \\subset \\mathbb{R}^3$ be a nondegenerate tetrahedral element with vertices $\\{\\mathbf{v}_1,\\mathbf{v}_2,\\mathbf{v}_3,\\mathbf{v}_4\\}$ and associated barycentric coordinates $\\{\\lambda_1,\\lambda_2,\\lambda_3,\\lambda_4\\}$ on $K$. Recall that each $\\lambda_a$ is an affine function on $K$ satisfying $\\lambda_a(\\mathbf{v}_b)=\\delta_{ab}$ and $\\sum_{a=1}^{4}\\lambda_a=1$, so that each gradient $\\nabla \\lambda_a$ is constant on $K$. Consider the first-order Nédélec (first kind) edge basis function on $K$ associated with the oriented edge from vertex $i$ to vertex $j$, defined by\n$$\n\\mathbf{N}_{ij} \\,=\\, \\lambda_i \\,\\nabla \\lambda_j \\;-\\; \\lambda_j \\,\\nabla \\lambda_i \\quad \\text{on } K,\n$$\nfor distinct $i,j \\in \\{1,2,3,4\\}$.\n\nStarting only from the definition of the barycentric coordinates, the definition of $\\mathbf{N}_{ij}$ above, and standard vector calculus identities, compute the vector curl $\\nabla \\times \\mathbf{N}_{ij}$ on the element $K$, and demonstrate from first principles that it is constant on $K$. Express your final result explicitly in terms of the barycentric gradients $\\nabla \\lambda_i$ and $\\nabla \\lambda_j$ only.\n\nAnswer specification:\n- Provide a single closed-form analytic vector expression for $\\nabla \\times \\mathbf{N}_{ij}$ in terms of $\\nabla \\lambda_i$ and $\\nabla \\lambda_j$ only.\n- No numerical evaluation is required.\n- Do not include units with your final answer.", "solution": "The user-provided problem is assessed to be valid. It is scientifically grounded, well-posed, and objective, with a complete and consistent setup based on established principles of computational electromagnetics and vector calculus. We may therefore proceed with the derivation.\n\nOur objective is to compute the vector curl of the first-order Nédélec edge basis function $\\mathbf{N}_{ij}$ on a tetrahedral element $K$. The basis function is defined as:\n$$\n\\mathbf{N}_{ij} = \\lambda_i \\nabla \\lambda_j - \\lambda_j \\nabla \\lambda_i\n$$\nwhere $\\lambda_i$ and $\\lambda_j$ are barycentric coordinate functions associated with vertices $i$ and $j$ of the tetrahedron, and $\\nabla \\lambda_i, \\nabla \\lambda_j$ are their respective gradients.\n\nWe seek to compute $\\nabla \\times \\mathbf{N}_{ij}$. The curl operator $\\nabla \\times$ is a linear differential operator. Applying it to the definition of $\\mathbf{N}_{ij}$, we get:\n$$\n\\nabla \\times \\mathbf{N}_{ij} = \\nabla \\times (\\lambda_i \\nabla \\lambda_j - \\lambda_j \\nabla \\lambda_i) = \\nabla \\times (\\lambda_i \\nabla \\lambda_j) - \\nabla \\times (\\lambda_j \\nabla \\lambda_i)\n$$\nTo evaluate each term, we use the standard vector calculus identity for the curl of a product of a scalar field $\\phi$ and a vector field $\\mathbf{A}$:\n$$\n\\nabla \\times (\\phi \\mathbf{A}) = (\\nabla \\phi) \\times \\mathbf{A} + \\phi (\\nabla \\times \\mathbf{A})\n$$\nLet us apply this identity to the first term, $\\nabla \\times (\\lambda_i \\nabla \\lambda_j)$, by setting the scalar field $\\phi = \\lambda_i$ and the vector field $\\mathbf{A} = \\nabla \\lambda_j$. This yields:\n$$\n\\nabla \\times (\\lambda_i \\nabla \\lambda_j) = (\\nabla \\lambda_i) \\times (\\nabla \\lambda_j) + \\lambda_i (\\nabla \\times (\\nabla \\lambda_j))\n$$\nA fundamental identity of vector calculus states that the curl of the gradient of any twice-differentiable scalar field is identically zero. Since the barycentric coordinates $\\lambda_j$ are affine functions, they are infinitely differentiable, and thus this identity holds. We have:\n$$\n\\nabla \\times (\\nabla \\lambda_j) = \\mathbf{0}\n$$\nSubstituting this into the expression for the first term gives:\n$$\n\\nabla \\times (\\lambda_i \\nabla \\lambda_j) = (\\nabla \\lambda_i) \\times (\\nabla \\lambda_j) + \\lambda_i (\\mathbf{0}) = \\nabla \\lambda_i \\times \\nabla \\lambda_j\n$$\nSimilarly, for the second term, $\\nabla \\times (\\lambda_j \\nabla \\lambda_i)$, we set $\\phi = \\lambda_j$ and $\\mathbf{A} = \\nabla \\lambda_i$. The product rule gives:\n$$\n\\nabla \\times (\\lambda_j \\nabla \\lambda_i) = (\\nabla \\lambda_j) \\times (\\nabla \\lambda_i) + \\lambda_j (\\nabla \\times (\\nabla \\lambda_i))\n$$\nAgain, the curl of the gradient of $\\lambda_i$ is zero:\n$$\n\\nabla \\times (\\nabla \\lambda_i) = \\mathbf{0}\n$$\nThis simplifies the second term to:\n$$\n\\nabla \\times (\\lambda_j \\nabla \\lambda_i) = (\\nabla \\lambda_j) \\times (\\nabla \\lambda_i)\n$$\nNow, we substitute these simplified expressions back into the equation for $\\nabla \\times \\mathbf{N}_{ij}$:\n$$\n\\nabla \\times \\mathbf{N}_{ij} = (\\nabla \\lambda_i \\times \\nabla \\lambda_j) - (\\nabla \\lambda_j \\times \\nabla \\lambda_i)\n$$\nThe vector cross product is anti-commutative, meaning for any two vectors $\\mathbf{u}$ and $\\mathbf{v}$, it holds that $\\mathbf{v} \\times \\mathbf{u} = -(\\mathbf{u} \\times \\mathbf{v})$. Applying this property with $\\mathbf{u} = \\nabla \\lambda_i$ and $\\mathbf{v} = \\nabla \\lambda_j$, we have:\n$$\n\\nabla \\lambda_j \\times \\nabla \\lambda_i = -(\\nabla \\lambda_i \\times \\nabla \\lambda_j)\n$$\nSubstituting this into our expression for the curl of $\\mathbf{N}_{ij}$:\n$$\n\\nabla \\times \\mathbf{N}_{ij} = (\\nabla \\lambda_i \\times \\nabla \\lambda_j) - (-(\\nabla \\lambda_i \\times \\nabla \\lambda_j)) = \\nabla \\lambda_i \\times \\nabla \\lambda_j + \\nabla \\lambda_i \\times \\nabla \\lambda_j\n$$\nCombining the identical terms, we arrive at the final result:\n$$\n\\nabla \\times \\mathbf{N}_{ij} = 2 (\\nabla \\lambda_i \\times \\nabla \\lambda_j)\n$$\nThe problem also requires a demonstration from first principles that this result is constant on the element $K$. The barycentric coordinates $\\{\\lambda_a\\}$ are defined as affine functions on $K$. An affine function $\\lambda_a(\\mathbf{x})$ over $\\mathbb{R}^3$ has the general form $\\lambda_a(\\mathbf{x}) = \\mathbf{c}_a \\cdot \\mathbf{x} + d_a$ for some constant vector $\\mathbf{c}_a \\in \\mathbb{R}^3$ and a constant scalar $d_a \\in \\mathbb{R}$. The gradient of such a function is $\\nabla \\lambda_a = \\mathbf{c}_a$, which is a constant vector, independent of the position $\\mathbf{x}$ within the element $K$. This property was given in the problem statement.\nOur derived expression for the curl, $\\nabla \\times \\mathbf{N}_{ij} = 2 (\\nabla \\lambda_i \\times \\nabla \\lambda_j)$, depends only on the scalar constant $2$ and the gradients $\\nabla \\lambda_i$ and $\\nabla \\lambda_j$. Since both $\\nabla \\lambda_i$ and $\\nabla \\lambda_j$ are constant vectors on $K$, their cross product, $\\nabla \\lambda_i \\times \\nabla \\lambda_j$, is also a constant vector on $K$. Therefore, $\\nabla \\times \\mathbf{N}_{ij}$ is a constant vector field across the entire domain of the element $K$. This result is a cornerstone property of first-order Nédélec elements, signifying that they belong to the function space $H(\\mathbf{curl})$.", "answer": "$$\\boxed{2 \\left(\\nabla \\lambda_i \\times \\nabla \\lambda_j\\right)}$$", "id": "3308336"}, {"introduction": "The theoretical properties of basis functions have direct, practical consequences for the efficiency and accuracy of the Finite Element Method (FEM). Building on the understanding that the curl of a first-order Nédélec basis is constant, this practice explores its impact on the assembly of the system matrix for a magnetostatic problem. You will demonstrate that the integrand for a curl-curl stiffness matrix entry becomes a constant, which proves that a simple and computationally inexpensive one-point quadrature rule is not merely an approximation but is, in fact, exact. [@problem_id:3308364]", "problem": "Consider the two-dimensional curl–curl formulation of Maxwell’s equations for magnetostatics with constant magnetic permeability $\\mu$ on a single triangular element $K$. In the Finite Element Method (FEM), using first-order Nédélec edge elements (first kind) on a triangle with vertices at $(0,0)$, $(1,0)$, and $(0,1)$, let the barycentric coordinates be $\\lambda_{1} = 1 - x - y$, $\\lambda_{2} = x$, and $\\lambda_{3} = y$. The oriented edges are $E_{1} = (1,2)$, $E_{2} = (2,3)$, and $E_{3} = (3,1)$, and the associated first-order Nédélec basis functions (first kind) on $K$ are given by\n$$\n\\mathbf{N}_{ij} = \\lambda_{i}\\,\\nabla \\lambda_{j} - \\lambda_{j}\\,\\nabla \\lambda_{i},\n$$\nfor each oriented edge $(i,j)$. In two dimensions, the scalar curl of a vector field $\\mathbf{v} = (v_{x}, v_{y})$ is defined by\n$$\n\\mathrm{curl}\\,\\mathbf{v} = \\frac{\\partial v_{y}}{\\partial x} - \\frac{\\partial v_{x}}{\\partial y}.\n$$\nThe stiffness matrix entry for the curl–curl bilinear form on $K$ is\n$$\nK_{ij} = \\int_{K} \\mu^{-1}\\, \\big(\\mathrm{curl}\\,\\mathbf{N}_{i}\\big)\\, \\big(\\mathrm{curl}\\,\\mathbf{N}_{j}\\big)\\,\\mathrm{d}x,\n$$\nwhere $\\mathbf{N}_{i}$ and $\\mathbf{N}_{j}$ denote the edge basis functions associated with edges $E_{i}$ and $E_{j}$. Using only the definitions above and first principles about barycentric coordinates, compute the single stiffness matrix entry $K_{23}$ for the pair $(E_{2}, E_{3})$, and explain why one-point quadrature at the centroid of $K$ is exact for this integral. Express your final answer as a closed-form analytic expression in terms of $\\mu$. No rounding is required.", "solution": "The problem asks us to compute the stiffness matrix entry $K_{23} = \\int_{K} \\mu^{-1}\\, (\\mathrm{curl}\\,\\mathbf{N}_{2})\\, (\\mathrm{curl}\\,\\mathbf{N}_{3})\\,\\mathrm{d}A$ for a specific pair of first-order Nédélec basis functions on a reference triangle, and to explain why one-point quadrature is exact for this integral.\n\nFirst, we identify the basis functions associated with the specified edges, $E_2 = (2,3)$ and $E_3 = (3,1)$. Using the definition $\\mathbf{N}_{ij} = \\lambda_{i}\\,\\nabla \\lambda_{j} - \\lambda_{j}\\,\\nabla \\lambda_{i}$, we have:\n- $\\mathbf{N}_2 = \\mathbf{N}_{23} = \\lambda_2 \\nabla \\lambda_3 - \\lambda_3 \\nabla \\lambda_2$\n- $\\mathbf{N}_3 = \\mathbf{N}_{31} = \\lambda_3 \\nabla \\lambda_1 - \\lambda_1 \\nabla \\lambda_3$\n\nNext, we compute the gradients of the barycentric coordinates. Given $\\lambda_{1} = 1 - x - y$, $\\lambda_{2} = x$, and $\\lambda_{3} = y$, their gradients are constant vectors:\n$$ \\nabla \\lambda_1 = \\begin{pmatrix} -1 \\\\ -1 \\end{pmatrix}, \\quad \\nabla \\lambda_2 = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}, \\quad \\nabla \\lambda_3 = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} $$\n\nThe scalar curl of a generic Nédélec basis function $\\mathbf{N}_{ij}$ is a constant given by the formula $\\mathrm{curl}\\,\\mathbf{N}_{ij} = 2 \\det(\\nabla\\lambda_i, \\nabla\\lambda_j)$. We apply this to our basis functions:\nFor $\\mathbf{N}_2 = \\mathbf{N}_{23}$ (with $i=2, j=3$):\n$$ \\mathrm{curl}\\,\\mathbf{N}_2 = 2 \\det(\\nabla\\lambda_2, \\nabla\\lambda_3) = 2 \\det\\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix} = 2(1 \\cdot 1 - 0 \\cdot 0) = 2 $$\nFor $\\mathbf{N}_3 = \\mathbf{N}_{31}$ (with $i=3, j=1$):\n$$ \\mathrm{curl}\\,\\mathbf{N}_3 = 2 \\det(\\nabla\\lambda_3, \\nabla\\lambda_1) = 2 \\det\\begin{pmatrix} 0 & -1 \\\\ 1 & -1 \\end{pmatrix} = 2(0 \\cdot (-1) - (-1) \\cdot 1) = 2 $$\n\nNow we can evaluate the integral for the stiffness matrix entry $K_{23}$. The integrand is $\\mu^{-1}\\, (\\mathrm{curl}\\,\\mathbf{N}_{2})\\, (\\mathrm{curl}\\,\\mathbf{N}_{3}) = \\mu^{-1} (2)(2) = 4\\mu^{-1}$. Since this is a constant, the integral is simply this constant multiplied by the area of the triangle $K$.\nThe triangle with vertices at $(0,0)$, $(1,0)$, and $(0,1)$ has an area of $\\frac{1}{2}$.\n$$ K_{23} = \\int_{K} 4\\mu^{-1}\\,\\mathrm{d}A = 4\\mu^{-1} \\cdot \\text{Area}(K) = 4\\mu^{-1} \\cdot \\frac{1}{2} = 2\\mu^{-1} $$\n\n**Explanation for the exactness of one-point quadrature:**\nA one-point quadrature rule at the centroid is exact for any integrand that is a linear polynomial (degree of precision 1). Our integrand, $f(x,y) = \\mu^{-1} (\\mathrm{curl}\\,\\mathbf{N}_{2}) (\\mathrm{curl}\\,\\mathbf{N}_{3}) = 4\\mu^{-1}$, is a constant function (a polynomial of degree 0). Because the integrand is constant over the entire element, any quadrature rule that correctly integrates constants will be exact. The one-point rule approximates the integral as $\\text{Area}(K) \\times f(\\text{centroid})$. For our constant function, this gives $\\frac{1}{2} \\times 4\\mu^{-1} = 2\\mu^{-1}$, which is precisely the exact value of the integral. The exactness is therefore a direct consequence of the fundamental property that the curl of a first-order Nédélec basis function is constant.", "answer": "$$ \\boxed{2\\mu^{-1}} $$", "id": "3308364"}]}