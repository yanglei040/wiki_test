{"hands_on_practices": [{"introduction": "The Finite Element Method (FEM) operates on the principle of \"divide and conquer,\" where complex domains are broken down into simpler, manageable pieces. This first practice takes you to the heart of this process by focusing on the fundamental building block in two dimensions: the reference triangle. Here, you will derive the local \"stiffness\" matrix $K$ and \"mass\" matrix $M$ for the lowest-order Nédélec vector elements, which are essential for discretizing Maxwell's equations. By completing this exercise [@problem_id:3334007], you will gain direct experience with the mathematical form of vector basis functions and see how their interactions, captured through integration, form the matrices that underpin FEM simulations.", "problem": "Consider the reference triangle $\\hat{K} = \\{(x,y) \\in \\mathbb{R}^{2} : x \\ge 0,\\, y \\ge 0,\\, x + y \\le 1\\}$ with barycentric coordinates $\\lambda_{1} = 1 - x - y$, $\\lambda_{2} = x$, and $\\lambda_{3} = y$. In computational electromagnetics using the Finite Element Method (FEM), the lowest-order Nédélec first-kind edge elements on $\\hat{K}$ are defined via the basis functions associated with the three edges:\n$$\\boldsymbol{\\phi}_{1} = \\lambda_{1} \\nabla \\lambda_{2} - \\lambda_{2} \\nabla \\lambda_{1}, \\quad \\boldsymbol{\\phi}_{2} = \\lambda_{2} \\nabla \\lambda_{3} - \\lambda_{3} \\nabla \\lambda_{2}, \\quad \\boldsymbol{\\phi}_{3} = \\lambda_{3} \\nabla \\lambda_{1} - \\lambda_{1} \\nabla \\lambda_{3}.$$\nAssume constant magnetic permeability $\\mu > 0$ and electric permittivity $\\epsilon > 0$ on $\\hat{K}$. In two spatial dimensions, for a planar vector field $\\boldsymbol{w}(x,y) = (w_{x}(x,y), w_{y}(x,y))$, define the scalar curl as\n$$\\nabla \\times \\boldsymbol{w} = \\frac{\\partial w_{y}}{\\partial x} - \\frac{\\partial w_{x}}{\\partial y}.$$\nStarting from the weak-form energy bilinear forms arising from Maxwell’s equations,\n$$a(\\boldsymbol{u}, \\boldsymbol{v}) = \\int_{\\hat{K}} \\mu^{-1} \\left(\\nabla \\times \\boldsymbol{u}\\right) \\left(\\nabla \\times \\boldsymbol{v}\\right) \\, \\mathrm{d}x\\,\\mathrm{d}y, \\qquad m(\\boldsymbol{u}, \\boldsymbol{v}) = \\int_{\\hat{K}} \\epsilon \\, \\boldsymbol{u} \\cdot \\boldsymbol{v} \\, \\mathrm{d}x\\,\\mathrm{d}y,$$\nderive the $3 \\times 3$ local element matrices $\\mathbf{K}$ and $\\mathbf{M}$ with entries\n$$K_{ij} = a(\\boldsymbol{\\phi}_{i}, \\boldsymbol{\\phi}_{j}), \\qquad M_{ij} = m(\\boldsymbol{\\phi}_{i}, \\boldsymbol{\\phi}_{j}), \\quad i,j \\in \\{1,2,3\\}.$$\nThen, consider the generalized eigenvalue problem on $\\hat{K}$,\n$$\\mathbf{K} \\mathbf{a} = \\lambda \\, \\mathbf{M} \\mathbf{a},$$\nand compute the largest eigenvalue $\\lambda_{\\max}$ as a closed-form analytic expression in $\\mu$ and $\\epsilon$. Express the final answer as a single closed-form expression. No rounding is required.", "solution": "We begin by specifying the barycentric coordinates on the reference triangle $\\hat{K}$:\n$$\\lambda_{1} = 1 - x - y, \\quad \\lambda_{2} = x, \\quad \\lambda_{3} = y,$$\nwith gradients\n$$\\nabla \\lambda_{1} = \\begin{pmatrix}-1 \\\\ -1\\end{pmatrix}, \\quad \\nabla \\lambda_{2} = \\begin{pmatrix}1 \\\\ 0\\end{pmatrix}, \\quad \\nabla \\lambda_{3} = \\begin{pmatrix}0 \\\\ 1\\end{pmatrix}.$$\nThe lowest-order Nédélec first-kind edge basis functions are\n\n$$\n\\boldsymbol{\\phi}_{1} = \\lambda_{1} \\nabla \\lambda_{2} - \\lambda_{2} \\nabla \\lambda_{1}, \\quad\n\\boldsymbol{\\phi}_{2} = \\lambda_{2} \\nabla \\lambda_{3} - \\lambda_{3} \\nabla \\lambda_{2}, \\quad\n\\boldsymbol{\\phi}_{3} = \\lambda_{3} \\nabla \\lambda_{1} - \\lambda_{1} \\nabla \\lambda_{3}.\n$$\n\nSubstituting the barycentric quantities, we obtain explicit forms:\n\n$$\n\\boldsymbol{\\phi}_{1} = \\lambda_{1} \\begin{pmatrix}1 \\\\ 0\\end{pmatrix} - \\lambda_{2} \\begin{pmatrix}-1 \\\\ -1\\end{pmatrix}\n= \\begin{pmatrix} \\lambda_{1} + \\lambda_{2} \\\\ \\lambda_{2} \\end{pmatrix}\n= \\begin{pmatrix} 1 - y \\\\ x \\end{pmatrix},\n$$\n\n\n$$\n\\boldsymbol{\\phi}_{2} = \\lambda_{2} \\begin{pmatrix}0 \\\\ 1\\end{pmatrix} - \\lambda_{3} \\begin{pmatrix}1 \\\\ 0\\end{pmatrix}\n= \\begin{pmatrix} - \\lambda_{3} \\\\ \\lambda_{2} \\end{pmatrix}\n= \\begin{pmatrix} - y \\\\ x \\end{pmatrix},\n$$\n\n\n$$\n\\boldsymbol{\\phi}_{3} = \\lambda_{3} \\begin{pmatrix}-1 \\\\ -1\\end{pmatrix} - \\lambda_{1} \\begin{pmatrix}0 \\\\ 1\\end{pmatrix}\n= \\begin{pmatrix} - \\lambda_{3} \\\\ -\\lambda_{3} - \\lambda_{1} \\end{pmatrix}\n= \\begin{pmatrix} - y \\\\ x - 1 \\end{pmatrix}.\n$$\n\nNext, we compute the scalar curl of each $\\boldsymbol{\\phi}_{i}$ using $\\nabla \\times \\boldsymbol{w} = \\partial w_{y}/\\partial x - \\partial w_{x}/\\partial y$:\n\n$$\n\\nabla \\times \\boldsymbol{\\phi}_{1} = \\frac{\\partial}{\\partial x}(x) - \\frac{\\partial}{\\partial y}(1 - y) = 1 - (-1) = 2,\n$$\n\n\n$$\n\\nabla \\times \\boldsymbol{\\phi}_{2} = \\frac{\\partial}{\\partial x}(x) - \\frac{\\partial}{\\partial y}(-y) = 1 - (-1) = 2,\n$$\n\n\n$$\n\\nabla \\times \\boldsymbol{\\phi}_{3} = \\frac{\\partial}{\\partial x}(x - 1) - \\frac{\\partial}{\\partial y}(-y) = 1 - (-1) = 2.\n$$\n\nTherefore, each curl is the constant $2$ on $\\hat{K}$. The local stiffness matrix entries are\n\n$$\nK_{ij} = \\int_{\\hat{K}} \\mu^{-1} \\left(\\nabla \\times \\boldsymbol{\\phi}_{i}\\right)\\left(\\nabla \\times \\boldsymbol{\\phi}_{j}\\right) \\, \\mathrm{d}x\\,\\mathrm{d}y\n= \\mu^{-1} \\int_{\\hat{K}} 4 \\, \\mathrm{d}x\\,\\mathrm{d}y\n= 4 \\mu^{-1} |\\hat{K}|.\n$$\n\nSince the area of the reference triangle is $|\\hat{K}| = \\frac{1}{2}$, we have\n\n$$\nK_{ij} = 2 \\mu^{-1} \\quad \\text{for all } i,j \\in \\{1,2,3\\}.\n$$\n\nThus $\\mathbf{K} = 2 \\mu^{-1} \\mathbf{J}$ where $\\mathbf{J}$ is the $3 \\times 3$ matrix of all ones.\n\nWe now derive the local mass matrix $\\mathbf{M}$ with entries $M_{ij} = \\int_{\\hat{K}} \\epsilon \\, \\boldsymbol{\\phi}_{i} \\cdot \\boldsymbol{\\phi}_{j} \\, \\mathrm{d}x\\,\\mathrm{d}y$. First compute the dot products:\n\n$$\n\\boldsymbol{\\phi}_{1} \\cdot \\boldsymbol{\\phi}_{1} = (1 - y)^{2} + x^{2} = 1 - 2y + y^{2} + x^{2},\n$$\n\n\n$$\n\\boldsymbol{\\phi}_{2} \\cdot \\boldsymbol{\\phi}_{2} = (-y)^{2} + x^{2} = y^{2} + x^{2},\n$$\n\n\n$$\n\\boldsymbol{\\phi}_{3} \\cdot \\boldsymbol{\\phi}_{3} = (-y)^{2} + (x - 1)^{2} = y^{2} + x^{2} - 2x + 1,\n$$\n\n\n$$\n\\boldsymbol{\\phi}_{1} \\cdot \\boldsymbol{\\phi}_{2} = (1 - y)(-y) + x x = -y + y^{2} + x^{2},\n$$\n\n\n$$\n\\boldsymbol{\\phi}_{1} \\cdot \\boldsymbol{\\phi}_{3} = (1 - y)(-y) + x(x - 1) = -y + y^{2} + x^{2} - x,\n$$\n\n\n$$\n\\boldsymbol{\\phi}_{2} \\cdot \\boldsymbol{\\phi}_{3} = (-y)(-y) + x(x - 1) = y^{2} + x^{2} - x.\n$$\n\nWe use the monomial integral identities over $\\hat{K}$:\n\n$$\n\\int_{\\hat{K}} 1 \\, \\mathrm{d}x\\,\\mathrm{d}y = \\frac{1}{2}, \\quad\n\\int_{\\hat{K}} x \\, \\mathrm{d}x\\,\\mathrm{d}y = \\int_{\\hat{K}} y \\, \\mathrm{d}x\\,\\mathrm{d}y = \\frac{1}{6}, \\quad\n\\int_{\\hat{K}} x^{2} \\, \\mathrm{d}x\\,\\mathrm{d}y = \\int_{\\hat{K}} y^{2} \\, \\mathrm{d}x\\,\\mathrm{d}y = \\frac{1}{12},\n$$\n\nwhich follow from the general formula for integers $p,q \\ge 0$:\n$$\n\\int_{\\hat{K}} x^{p} y^{q} \\, \\mathrm{d}x\\,\\mathrm{d}y = \\frac{p! q!}{(p+q+2)!}\n$$\n\nEvaluating each entry:\n\n$$\nM_{11} = \\epsilon \\int_{\\hat{K}} \\left(1 - 2y + y^{2} + x^{2}\\right) \\mathrm{d}x\\,\\mathrm{d}y\n= \\epsilon \\left( \\frac{1}{2} - 2 \\cdot \\frac{1}{6} + \\frac{1}{12} + \\frac{1}{12} \\right)\n= \\epsilon \\left( \\frac{1}{2} - \\frac{1}{3} + \\frac{1}{6} \\right)\n= \\epsilon \\cdot \\frac{1}{3},\n$$\n\n\n$$\nM_{22} = \\epsilon \\int_{\\hat{K}} \\left(y^{2} + x^{2}\\right) \\mathrm{d}x\\,\\mathrm{d}y\n= \\epsilon \\left( \\frac{1}{12} + \\frac{1}{12} \\right)\n= \\epsilon \\cdot \\frac{1}{6},\n$$\n\n\n$$\nM_{33} = \\epsilon \\int_{\\hat{K}} \\left(y^{2} + x^{2} - 2x + 1\\right) \\mathrm{d}x\\,\\mathrm{d}y\n= \\epsilon \\left( \\frac{1}{12} + \\frac{1}{12} - 2 \\cdot \\frac{1}{6} + \\frac{1}{2} \\right)\n= \\epsilon \\left( \\frac{1}{6} - \\frac{1}{3} + \\frac{1}{2} \\right)\n= \\epsilon \\cdot \\frac{1}{3},\n$$\n\n\n$$\nM_{12} = \\epsilon \\int_{\\hat{K}} \\left( -y + y^{2} + x^{2} \\right) \\mathrm{d}x\\,\\mathrm{d}y\n= \\epsilon \\left( -\\frac{1}{6} + \\frac{1}{12} + \\frac{1}{12} \\right)\n= \\epsilon \\cdot 0,\n$$\n\n\n$$\nM_{13} = \\epsilon \\int_{\\hat{K}} \\left( -y + y^{2} + x^{2} - x \\right) \\mathrm{d}x\\,\\mathrm{d}y\n= \\epsilon \\left( -\\frac{1}{6} + \\frac{1}{12} + \\frac{1}{12} - \\frac{1}{6} \\right)\n= \\epsilon \\cdot \\left( -\\frac{1}{6} \\right),\n$$\n\n\n$$\nM_{23} = \\epsilon \\int_{\\hat{K}} \\left( y^{2} + x^{2} - x \\right) \\mathrm{d}x\\,\\mathrm{d}y\n= \\epsilon \\left( \\frac{1}{12} + \\frac{1}{12} - \\frac{1}{6} \\right)\n= \\epsilon \\cdot 0.\n$$\n\nCollecting, the mass matrix is\n\n$$\n\\mathbf{M} = \\epsilon \\begin{pmatrix}\n\\frac{1}{3} & 0 & -\\frac{1}{6} \\\\\n0 & \\frac{1}{6} & 0 \\\\\n-\\frac{1}{6} & 0 & \\frac{1}{3}\n\\end{pmatrix}.\n$$\n\nWe now consider the generalized eigenvalue problem $\\mathbf{K} \\mathbf{a} = \\lambda \\mathbf{M} \\mathbf{a}$. Because $\\mathbf{K} = 2 \\mu^{-1} \\mathbf{J}$ has rank one with $\\mathbf{J}$ the all-ones matrix, any vector $\\mathbf{a}$ with components summing to zero lies in the nullspace of $\\mathbf{K}$, yielding $\\lambda = 0$ for those modes (since $\\mathbf{M}$ is positive definite). The nontrivial mode aligns with the eigenvector of $\\mathbf{J}$, namely $\\mathbf{a} = \\begin{pmatrix}1 \\\\ 1 \\\\ 1\\end{pmatrix}$. For this vector,\n\n$$\n\\mathbf{K} \\mathbf{a} = 2 \\mu^{-1} \\mathbf{J} \\begin{pmatrix}1 \\\\ 1 \\\\ 1\\end{pmatrix}\n= 2 \\mu^{-1} \\begin{pmatrix}3 \\\\ 3 \\\\ 3\\end{pmatrix}\n= 6 \\mu^{-1} \\begin{pmatrix}1 \\\\ 1 \\\\ 1\\end{pmatrix}.\n$$\n\nCompute $\\mathbf{M} \\mathbf{a}$:\n\n$$\n\\mathbf{M} \\begin{pmatrix}1 \\\\ 1 \\\\ 1\\end{pmatrix}\n= \\epsilon \\begin{pmatrix}\n\\frac{1}{3} - \\frac{1}{6} \\\\\n\\frac{1}{6} \\\\\n-\\frac{1}{6} + \\frac{1}{3}\n\\end{pmatrix}\n= \\epsilon \\begin{pmatrix}\n\\frac{1}{6} \\\\\n\\frac{1}{6} \\\\\n\\frac{1}{6}\n\\end{pmatrix}\n= \\frac{\\epsilon}{6} \\begin{pmatrix}1 \\\\ 1 \\\\ 1\\end{pmatrix}.\n$$\n\nTherefore, the corresponding generalized eigenvalue $\\lambda$ satisfies\n\n$$\n6 \\mu^{-1} \\begin{pmatrix}1 \\\\ 1 \\\\ 1\\end{pmatrix} = \\lambda \\cdot \\frac{\\epsilon}{6} \\begin{pmatrix}1 \\\\ 1 \\\\ 1\\end{pmatrix},\n$$\n\nso\n\n$$\n\\lambda = \\frac{6 \\mu^{-1}}{\\epsilon/6} = \\frac{36 \\mu^{-1}}{\\epsilon} = \\frac{36}{\\mu \\epsilon}.\n$$\n\nSince the other two generalized eigenvalues are zero, this is the largest eigenvalue:\n\n$$\n\\lambda_{\\max} = \\frac{36}{\\mu \\epsilon}.\n$$\n\nThis completes the derivation of the local element matrices and the computation of the largest generalized eigenvalue on the reference element.", "answer": "$$\\boxed{\\frac{36}{\\mu \\epsilon}}$$", "id": "3334007"}, {"introduction": "After mastering the calculations for a single element, the next logical step is to assemble these individual pieces into a cohesive whole that represents the entire problem domain. This practice addresses the critical process of local-to-global assembly, a cornerstone of all finite element codes. It specifically highlights the crucial role that orientation conventions play for vector elements in spaces like $H(\\mathrm{curl})$ and $H(\\mathrm{div})$. This exercise [@problem_id:3334058] will demonstrate, both conceptually and through a concrete calculation, why consistent orientation is necessary to enforce the physical continuity of fields across element boundaries and what happens when this rule is violated.", "problem": "Consider the lowest-order edge (vector) finite elements of Nédélec’s first kind on a two-dimensional mesh used for the Finite Element Method (FEM) discretization of fields in the Sobolev space $H(\\mathrm{curl})$. Degrees of Freedom (DOF) for these elements are associated with the line integral of the tangential component of the field along oriented edges. In parallel, consider the lowest-order normal flux elements of Raviart–Thomas type on $H(\\mathrm{div})$, where DOFs are associated with the integral of the normal component across oriented edges (in two dimensions) or faces (in three dimensions).\n\nPart I (conceptual): Starting from the definitions of $H(\\mathrm{curl})$ and $H(\\mathrm{div})$, explain how local-to-global orientation and sign conventions for edges (for $H(\\mathrm{curl})$ tangential DOFs) and edges/faces (for $H(\\mathrm{div})$ normal DOFs) ensure consistent assembly. In particular, justify why reversing the local orientation of an edge or face induces a sign change in the associated DOF and how this sign must be accounted for during assembly so that tangential or normal continuity is respected across element interfaces.\n\nPart II (computational): Consider a domain partitioned into two triangles\n$$\nK_{1}=\\mathrm{conv}\\{(0,0),(1,0),(0,1)\\}, \\qquad K_{2}=\\mathrm{conv}\\{(1,0),(1,1),(0,0)\\},\n$$\nsharing the edge $E=\\mathrm{conv}\\{(0,0),(1,0)\\}$, globally oriented from $(0,0)$ to $(1,0)$. On each triangle, use the lowest-order Nédélec basis given by Whitney $1$-forms. Let the local vertex labels on $K_{1}$ be $(1,2,3)=( (0,0),(1,0),(0,1) )$, and on $K_{2}$ be $(1,2,3)=( (1,0),(1,1),(0,0) )$. Denote the three local edge basis functions on a triangle $K$ by\n$$\n\\mathbf{w}_{ij}=\\lambda_{i}\\nabla\\lambda_{j}-\\lambda_{j}\\nabla\\lambda_{i}, \\quad (i,j)\\in\\{(1,2),(2,3),(3,1)\\},\n$$\nwhere $\\lambda_{i}$ are the barycentric coordinates on $K$ and $\\nabla\\lambda_{i}$ are constant on $K$.\n\nDefine the local $L^{2}$ mass matrix on each triangle by\n$$\nM_{ab}^{K}=\\int_{K}\\mathbf{w}_{a}\\cdot\\mathbf{w}_{b}\\,\\mathrm{d}x,\n$$\nwith $a,b$ indexing the local edges $(12),(23),(31)$ on $K$. Assemble the global mass matrix $M$ for the five global edge DOFs corresponding to the edges of the mesh, using the standard local-to-global map with orientation signs. Consider the global DOF vector $\\mathbf{x}\\in\\mathbb{R}^{5}$ whose entries are all equal to $1$.\n\nLet $R_{\\mathrm{good}}=\\mathbf{x}^{\\top}M_{\\mathrm{good}}\\mathbf{x}$ be the quadratic form value with consistent orientation on both elements, meaning the shared edge’s local orientation on $K_{2}$ is taken as $(3\\to 1)$ to match the global orientation $(0,0)\\to(1,0)$. Let $R_{\\mathrm{bad}}=\\mathbf{x}^{\\top}M_{\\mathrm{bad}}\\mathbf{x}$ be the value when the assembly on $K_{2}$ uses the opposite local orientation sign for the shared edge (i.e., mapping the shared edge with a sign inconsistent with the global orientation). Using only the definitions above and well-tested facts about barycentric coordinates, compute the exact difference\n$$\n\\Delta R=R_{\\mathrm{bad}}-R_{\\mathrm{good}}.\n$$\n\nExpress the final answer as an exact rational number. No rounding is required, and no units should be attached to the final scalar.", "solution": "The problem consists of two parts. Part I is a conceptual explanation of orientation conventions in finite element methods for $H(\\mathrm{curl})$ and $H(\\mathrm{div})$ spaces. Part II is a specific computation of the effect of an orientation error on a quadratic form involving the mass matrix.\n\n### Part I: Conceptual Explanation\n\nThe Sobolev spaces $H(\\mathrm{curl})$ and $H(\\mathrm{div})$ are fundamental in the variational formulation of Maxwell's equations. They are defined as:\n$$\nH(\\mathrm{curl}) = \\{ \\mathbf{u} \\in (L^2(\\Omega))^d \\mid \\nabla \\times \\mathbf{u} \\in (L^2(\\Omega))^{d'} \\}\n$$\n$$\nH(\\mathrm{div}) = \\{ \\mathbf{u} \\in (L^2(\\Omega))^d \\mid \\nabla \\cdot \\mathbf{u} \\in L^2(\\Omega) \\}\n$$\nwhere $\\Omega \\subset \\mathbb{R}^d$ is the domain. A key property of functions in $H(\\mathrm{curl})$ is the continuity of their tangential components across element interfaces. Specifically, for a vector field $\\mathbf{u} \\in H(\\mathrm{curl})$, the trace $\\mathbf{u} \\times \\mathbf{n}$ is single-valued across any interior edge or face with normal $\\mathbf{n}$. Similarly, for a vector field $\\mathbf{v} \\in H(\\mathrm{div})$, the normal component $\\mathbf{v} \\cdot \\mathbf{n}$ is continuous across interfaces.\n\nThe finite element methods for these spaces, such as Nédélec for $H(\\mathrm{curl})$ and Raviart–Thomas for $H(\\mathrm{div})$, are designed to enforce these continuity properties discretely. This is achieved through the choice of Degrees of Freedom (DOFs).\n\nFor lowest-order Nédélec edge elements ($H(\\mathrm{curl})$), the DOFs are the line integrals of the field's tangential component along each edge $e$ of the mesh:\n$$\n\\text{DOF}_e(\\mathbf{u}) = \\int_e \\mathbf{u} \\cdot \\boldsymbol{\\tau} \\, \\mathrm{d}s\n$$\nwhere $\\boldsymbol{\\tau}$ is a unit tangent vector defining the orientation of edge $e$.\n\nFor lowest-order Raviart–Thomas elements ($H(\\mathrm{div})$), the DOFs are the fluxes of the field's normal component across each edge $e$ (in 2D) or face $f$ (in 3D):\n$$\n\\text{DOF}_e(\\mathbf{v}) = \\int_e \\mathbf{v} \\cdot \\mathbf{n} \\, \\mathrm{d}s\n$$\nwhere $\\mathbf{n}$ is a unit normal vector defining the orientation of the edge/face.\n\nThe value of these DOFs is fundamentally tied to the chosen orientation. If the orientation of an edge is reversed, the corresponding tangent vector changes sign, $\\boldsymbol{\\tau} \\to -\\boldsymbol{\\tau}$, and the normal vector also changes sign, $\\mathbf{n} \\to -\\mathbf{n}$. By the linearity of the integral, this induces a sign change in the DOF value:\n$$\n\\int_e \\mathbf{u} \\cdot (-\\boldsymbol{\\tau}) \\, \\mathrm{d}s = - \\int_e \\mathbf{u} \\cdot \\boldsymbol{\\tau} \\, \\mathrm{d}s\n$$\nThus, reversing the local orientation of an edge or face flips the sign of the associated DOF.\n\nTo ensure global continuity of the tangential or normal components, a consistent assembly process is required. First, a unique global orientation is assigned to every edge (or face) in the mesh. Inside each element $K$, the local basis functions are defined with respect to local edge orientations (e.g., from vertex $i$ to vertex $j$). When assembling the global system from local contributions, one must compare the local orientation of an edge on element $K$ to its prescribed global orientation.\n\nLet an edge $e$ be shared by two elements, $K_1$ and $K_2$. The tangential continuity of $\\mathbf{u}$ requires that $\\mathbf{u}|_{K_1} \\cdot \\boldsymbol{\\tau} = \\mathbf{u}|_{K_2} \\cdot \\boldsymbol{\\tau}$ along $e$, where $\\boldsymbol{\\tau}$ is the tangent for the global orientation of $e$. This implies that the DOF associated with $e$ must have a single, well-defined value in the global system. Let a local edge $e_{loc}^{K_1}$ on $K_1$ and $e_{loc}^{K_2}$ on $K_2$ both correspond to the global edge $e$. The local DOF on $K_1$ maps to the global DOF for $e$. The local DOF on $K_2$ also maps to the same global DOF. To ensure this mapping is consistent, a sign factor, $\\sigma_e^K \\in \\{+1, -1\\}$, is introduced. This sign is $+1$ if the local orientation on element $K$ matches the global orientation of $e$, and $-1$ if it is opposite. The contribution of a local basis function $\\mathbf{w}_{loc}^K$ to the global basis function $\\boldsymbol{\\Psi}_e$ is then $\\sigma_e^K \\mathbf{w}_{loc}^K$. This sign correction ensures that the single global DOF correctly represents the physical quantity (tangential circulation or normal flux) shared at the interface, thereby enforcing the required continuity.\n\n### Part II: Computational Task\n\nWe are asked to compute $\\Delta R = R_{\\mathrm{bad}} - R_{\\mathrm{good}}$, where $R = \\mathbf{x}^{\\top}M\\mathbf{x}$ and $\\mathbf{x}$ is a column vector of all ones. When $\\mathbf{x}=\\mathbf{1}$, the quadratic form becomes the sum of all elements of the matrix $M$:\n$$\nR = \\mathbf{1}^{\\top}M\\mathbf{1} = \\sum_{i,j} M_{ij}\n$$\nThe global mass matrix $M$ is assembled from local mass matrices $M^K$ using local-to-global sign mappings. Let the global edges be indexed by $i, j$ and local edges on an element $K$ be indexed by $a, b$. The assembly rule is:\n$$\nM_{ij} = \\sum_{K} (\\sigma_i^K \\sigma_j^K) M_{\\text{loc}_K(i), \\text{loc}_K(j)}^K\n$$\nwhere $\\sigma_i^K$ is the sign of the local edge corresponding to global edge $i$ on element $K$ relative to the global orientation, and $\\text{loc}_K(i)$ is its local index. The sum is over all elements $K$ containing the relevant edges.\n\nThe quadratic form $R$ can be written as:\n$$\nR = \\sum_{i,j} \\sum_K (\\sigma_i^K \\sigma_j^K) M_{\\text{loc}_K(i), \\text{loc}_K(j)}^K = \\sum_K \\sum_{a, b \\in K} (\\sigma_a^K \\sigma_b^K) M_{ab}^K\n$$\nwhere the inner sum is over all pairs of local edges $\\{a,b\\}$ in element $K$.\n\nFor $M_{\\mathrm{good}}$, the standard assembly procedure is used. For $M_{\\mathrm{bad}}$, the sign for the shared edge on element $K_2$ is flipped. Let the shared edge be $e_s$. The signs for $M_{\\mathrm{bad}}$ are $\\sigma'_a{^K}$, where $\\sigma'_a{^K} = \\sigma_a^K$ for all edges except for $a=e_s$ on $K=K_2$, for which $\\sigma'_{e_s}{^{K_2}} = -\\sigma_{e_s}^{K_2}$.\n\nThe difference $\\Delta R$ is:\n$$\n\\Delta R = R_{\\mathrm{bad}} - R_{\\mathrm{good}} = \\sum_K \\sum_{a,b \\in K} (\\sigma'_a{^K}\\sigma'_b{^K} - \\sigma_a^K\\sigma_b^K) M_{ab}^K\n$$\nThe difference is zero for element $K_1$, as no signs are changed. The calculation reduces to the contribution from $K_2$:\n$$\n\\Delta R = \\sum_{a,b \\in K_2} (\\sigma'_a{^{K_2}}\\sigma'_b{^{K_2}} - \\sigma_a^{K_2}\\sigma_b^{K_2}) M_{ab}^{K_2}\n$$\nLet the local edges of $K_2$ be denoted $e_s$ (shared) and $e_{o1}, e_{o2}$ (other edges).\nThe term $(\\sigma'_a{^{K_2}}\\sigma'_b{^{K_2}} - \\sigma_a^{K_2}\\sigma_b^{K_2})$ is non-zero only when exactly one of the indices $a$ or $b$ corresponds to the shared edge $e_s$.\n- If $a=e_s, b=e_s$: term is $(-\\sigma_{e_s}^{K_2})^2 - (\\sigma_{e_s}^{K_2})^2 = 0$.\n- If $a,b \\neq e_s$: term is $\\sigma_a^{K_2}\\sigma_b^{K_2} - \\sigma_a^{K_2}\\sigma_b^{K_2} = 0$.\n- If $a=e_s, b \\neq e_s$: term is $(-\\sigma_{e_s}^{K_2})\\sigma_b^{K_2} - \\sigma_{e_s}^{K_2}\\sigma_b^{K_2} = -2 \\sigma_{e_s}^{K_2}\\sigma_b^{K_2}$.\nThis gives:\n$$\n\\Delta R = \\sum_{b \\neq e_s} (-2 \\sigma_{e_s}^{K_2} \\sigma_b^{K_2} M_{e_s,b}^{K_2}) + \\sum_{a \\neq e_s} (-2 \\sigma_a^{K_2} \\sigma_{e_s}^{K_2} M_{a,e_s}^{K_2})\n= -4 \\sum_{b \\in \\{e_{o1}, e_{o2}\\}} \\sigma_{e_s}^{K_2} \\sigma_b^{K_2} M_{e_s,b}^{K_2}\n$$\nThe quadratic form $R$ is invariant under the choice of global orientations. We can choose the global orientations for the non-shared edges to match a convenient local orientation, making their signs $\\sigma_b^{K_2} = +1$. The problem states that for the consistent assembly ($M_{\\mathrm{good}}$), the shared edge is oriented to match the global orientation, so $\\sigma_{e_s}^{K_2} = +1$. With these choices, the expression simplifies to:\n$$\n\\Delta R = -4 \\sum_{b \\in \\{e_{o1}, e_{o2}\\}} M_{e_s,b}^{K_2}\n$$\nNow we must compute the geometric properties and local mass matrix entries for triangle $K_2 = \\mathrm{conv}\\{(1,0),(1,1),(0,0)\\}$.\nThe local vertices are labeled $v_1=(1,0)$, $v_2=(1,1)$, $v_3=(0,0)$. The area is $|K_2| = 1/2$. The barycentric coordinates are $\\lambda_1(x,y) = x-y$, $\\lambda_2(x,y) = y$, and $\\lambda_3(x,y) = 1-x$. The gradients are:\n$$\n\\nabla\\lambda_1 = \\begin{pmatrix}1 \\\\ -1\\end{pmatrix}, \\quad \\nabla\\lambda_2 = \\begin{pmatrix}0 \\\\ 1\\end{pmatrix}, \\quad \\nabla\\lambda_3 = \\begin{pmatrix}-1 \\\\ 0\\end{pmatrix}\n$$\nThe Gram matrix of these gradients is $G_{ij} = \\nabla\\lambda_i \\cdot \\nabla\\lambda_j$:\n$$\nG = \\begin{pmatrix} \\nabla\\lambda_1 \\cdot \\nabla\\lambda_1 & \\nabla\\lambda_1 \\cdot \\nabla\\lambda_2 & \\nabla\\lambda_1 \\cdot \\nabla\\lambda_3 \\\\ \\nabla\\lambda_2 \\cdot \\nabla\\lambda_1 & \\nabla\\lambda_2 \\cdot \\nabla\\lambda_2 & \\nabla\\lambda_2 \\cdot \\nabla\\lambda_3 \\\\ \\nabla\\lambda_3 \\cdot \\nabla\\lambda_1 & \\nabla\\lambda_3 \\cdot \\nabla\\lambda_2 & \\nabla\\lambda_3 \\cdot \\nabla\\lambda_3 \\end{pmatrix} = \\begin{pmatrix} 2 & -1 & -1 \\\\ -1 & 1 & 0 \\\\ -1 & 0 & 1 \\end{pmatrix}\n$$\nThe local edges are defined by vertex pairs $(1,2)$, $(2,3)$, $(3,1)$. The shared edge $E$ corresponds to vertices $(0,0)$ and $(1,0)$, which are $v_3$ and $v_1$ on $K_2$. So, the shared local edge is $e_s = e_{31}$. The other edges are $e_{o1} = e_{12}$ and $e_{o2} = e_{23}$. We need to compute $M_{31,12}^{K_2}$ and $M_{31,23}^{K_2}$.\nThe generic formula for an off-diagonal mass matrix entry between edges sharing a vertex is:\n$$\nM_{ij,jk}^K = \\int_K (\\lambda_i \\nabla\\lambda_j - \\lambda_j \\nabla\\lambda_i) \\cdot (\\lambda_j \\nabla\\lambda_k - \\lambda_k \\nabla\\lambda_j) \\, \\mathrm{d}x = \\frac{|K|}{12}(G_{ij} + G_{jk} - G_{jj} - 2G_{ik})\n$$\nWe need $M_{31,12}^{K_2}$. The edges $e_{31}$ and $e_{12}$ share vertex $1$. This corresponds to the formula with $(i,j,k)=(3,1,2)$.\n$$\nM_{31,12}^{K_2} = \\frac{|K_2|}{12}(G_{31} + G_{12} - G_{11} - 2G_{32}) = \\frac{1/2}{12}(-1 + (-1) - 2 - 2(0)) = \\frac{1}{24}(-4) = -\\frac{1}{6}\n$$\nNext, we need $M_{31,23}^{K_2}$. The edges $e_{31}$ and $e_{23}$ share vertex $3$. To use the formula we write $e_{31}$ as $e_{13}$ and $e_{23}$ as $e_{32}$. This makes $M_{31,23}^{K_2} = M_{13,32}^{K_2}$. So we use $(i,j,k)=(1,3,2)$.\n$$\nM_{13,32}^{K_2} = \\frac{|K_2|}{12}(G_{13} + G_{32} - G_{33} - 2G_{12}) = \\frac{1/2}{12}(-1 + 0 - 1 - 2(-1)) = \\frac{1}{24}(-1-1+2) = 0\n$$\nThus, $\\Delta R = -4 (M_{31,12}^{K_2} + M_{31,23}^{K_2}) = -4(-\\frac{1}{6}+0) = \\frac{4}{6} = \\frac{2}{3}$.", "answer": "$$\\boxed{\\frac{2}{3}}$$", "id": "3334058"}, {"introduction": "To tackle the vast majority of real-world applications in electromagnetics, we must move from two-dimensional planes to three-dimensional space. This practice guides you through this transition by extending the concept of element matrix derivation to a 3D tetrahedral element. The central principle explored here is the covariant Piola transform, a mathematical tool that ensures vector basis functions and their curls are correctly mapped from a simple reference shape to a general physical element. By working through the derivation [@problem_id:3334027], you will develop a robust understanding of how geometric transformations are handled for vector fields in FEM, a key skill for analyzing and building 3D simulation tools.", "problem": "Consider the frequency-domain curl-curl formulation for electromagnetic fields in an isotropic, piecewise-constant medium. On a tetrahedral element $T$ obtained by an affine mapping from the reference tetrahedron $\\widehat{T}$ with vertices at $(0,0,0)$, $(1,0,0)$, $(0,1,0)$, $(0,0,1)$, use the lowest-order Nédélec (first kind) edge basis $\\{N_i\\}$ associated with the edges of $T$. Let $\\mu>0$ and $\\epsilon>0$ be constant on $T$ (nondimensionalized units). Starting from first principles, namely:\n- The definition of the lowest-order Nédélec basis on the reference tetrahedron in terms of barycentric coordinates $\\{\\lambda_a\\}_{a=1}^4$ and their gradients,\n- The affine map $F:\\widehat{T}\\to T$ given by $x = J \\,\\hat{x} + b$ with constant Jacobian $J\\in\\mathbb{R}^{3\\times 3}$ and translation $b\\in\\mathbb{R}^3$,\n- The covariant Piola transform that preserves tangential components for $H(\\mathrm{curl})$ fields and the induced transformation of the curl under affine maps,\nderive the element matrices\n$$\nK_{ij} \\;=\\; \\int_T \\mu^{-1}\\, (\\nabla\\times N_i)\\cdot(\\nabla\\times N_j)\\, dx,\n\\qquad\nM_{ij} \\;=\\; \\int_T \\epsilon\\, N_i\\cdot N_j\\, dx,\n$$\nin terms of integrals over $\\widehat{T}$, the Jacobian $J$, and its associated metric tensors. Your derivation must explicitly show how the basis functions and their curls transform, and how the determinants and metric tensors enter the mapped integrals. Then, clearly describe the algorithmic steps required to evaluate these matrices by mapped quadrature on $\\widehat{T}$.\n\nFinally, apply your formulas to the specific affine map with $J=\\mathrm{diag}(2,3,4)$ and any translation $b$ (which is irrelevant to the integrals), using the edge enumeration\n- edge $1$: $(1,2)$,\n- edge $2$: $(1,3)$,\n- edge $3$: $(1,4)$,\n- edge $4$: $(2,3)$,\n- edge $5$: $(2,4)$,\n- edge $6$: $(3,4)$,\nwhere $(a,b)$ denotes the oriented edge from vertex $a$ to vertex $b$ on $\\widehat{T}$.\n\nCompute the single stiffness entry $K_{12}$ in closed form as a function of $\\mu$. Express your final answer as a single closed-form symbolic expression in terms of $\\mu$ only. Do not include units. Do not approximate.", "solution": "Let the physical tetrahedral element be denoted by $T$ and the reference tetrahedron by $\\widehat{T}$. The reference element $\\widehat{T}$ has vertices $\\hat{v}_1=(0,0,0)$, $\\hat{v}_2=(1,0,0)$, $\\hat{v}_3=(0,1,0)$, and $\\hat{v}_4=(0,0,1)$. The volume of this reference element is $\\mathrm{vol}(\\widehat{T}) = \\frac{1}{6}$. The barycentric coordinates on $\\widehat{T}$ are linear functions $\\hat{\\lambda}_a(\\hat{x})$ for $a \\in \\{1,2,3,4\\}$, defined by $\\hat{\\lambda}_a(\\hat{v}_b) = \\delta_{ab}$, where $\\delta_{ab}$ is the Kronecker delta. They are given by:\n$$\n\\hat{\\lambda}_1(\\hat{x}) = 1 - \\hat{x}_1 - \\hat{x}_2 - \\hat{x}_3, \\quad \\hat{\\lambda}_2(\\hat{x}) = \\hat{x}_1, \\quad \\hat{\\lambda}_3(\\hat{x}) = \\hat{x}_2, \\quad \\hat{\\lambda}_4(\\hat{x}) = \\hat{x}_3\n$$\nThe gradients of these barycentric coordinates with respect to the reference coordinates $\\hat{x}$ are constant vectors:\n$$\n\\hat{\\nabla} \\hat{\\lambda}_1 = \\begin{pmatrix}-1 \\\\ -1 \\\\ -1\\end{pmatrix}, \\quad \\hat{\\nabla} \\hat{\\lambda}_2 = \\begin{pmatrix}1 \\\\ 0 \\\\ 0\\end{pmatrix}, \\quad \\hat{\\nabla} \\hat{\\lambda}_3 = \\begin{pmatrix}0 \\\\ 1 \\\\ 0\\end{pmatrix}, \\quad \\hat{\\nabla} \\hat{\\lambda}_4 = \\begin{pmatrix}0 \\\\ 0 \\\\ 1\\end{pmatrix}\n$$\nThe lowest-order Nédélec (first kind) basis functions on $\\widehat{T}$ are associated with the $6$ edges of the tetrahedron. For an edge $\\hat{e}_i$ connecting vertex $\\hat{v}_a$ to vertex $\\hat{v}_b$, the corresponding vector basis function is:\n$$\n\\widehat{N}_i(\\hat{x}) = \\widehat{N}_{ab}(\\hat{x}) = \\hat{\\lambda}_a(\\hat{x}) \\hat{\\nabla} \\hat{\\lambda}_b - \\hat{\\lambda}_b(\\hat{x}) \\hat{\\nabla} \\hat{\\lambda}_a\n$$\nThe curl of this basis function on the reference element is a constant vector:\n$$\n\\hat{\\nabla} \\times \\widehat{N}_{ab}(\\hat{x}) = \\hat{\\nabla} \\times (\\hat{\\lambda}_a \\hat{\\nabla} \\hat{\\lambda}_b) - \\hat{\\nabla} \\times (\\hat{\\lambda}_b \\hat{\\nabla} \\hat{\\lambda}_a) = (\\hat{\\nabla} \\hat{\\lambda}_a \\times \\hat{\\nabla} \\hat{\\lambda}_b) - (\\hat{\\nabla} \\hat{\\lambda}_b \\times \\hat{\\nabla} \\hat{\\lambda}_a) = 2 \\hat{\\nabla} \\hat{\\lambda}_a \\times \\hat{\\nabla} \\hat{\\lambda}_b\n$$\n\nThe physical element $T$ is related to $\\widehat{T}$ by an affine mapping $F(\\hat{x}) = x = J\\hat{x} + b$, where $J \\in \\mathbb{R}^{3\\times 3}$ is the constant Jacobian matrix and $b \\in \\mathbb{R}^3$ is a translation vector. The transformation rules for differential operators and integrals are as follows:\n1. Differential volume element: $dx = |\\det(J)| d\\hat{x}$. Assuming the mapping preserves orientation, this is $dx = \\det(J) d\\hat{x}$.\n2. Gradient operator: $\\nabla_x = (J^{-1})^T \\hat{\\nabla}_{\\hat{x}}$.\n3. Covariant Piola transform for $H(\\mathrm{curl})$ fields: A vector field $\\widehat{N}$ on $\\widehat{T}$ transforms to a field $N$ on $T$ as $N(x) = (J^{-1})^T \\widehat{N}(\\hat{x})$, where $\\hat{x} = F^{-1}(x)$. This transformation preserves the tangential components of the vector field along the edges of the element.\n4. Curl operator transformation: The curl of the transformed field is given by $\\nabla_x \\times N(x) = \\frac{1}{\\det(J)} J (\\hat{\\nabla}_{\\hat{x}} \\times \\widehat{N}(\\hat{x}))$.\n\nWith these rules, we can transform the integrals for the stiffness matrix $K_{ij}$ and mass matrix $M_{ij}$ from the physical domain $T$ to the reference domain $\\widehat{T}$.\n\nFirst, consider the mass matrix entry $M_{ij}$:\n$$\nM_{ij} = \\int_T \\epsilon N_i(x) \\cdot N_j(x) dx\n$$\nSubstituting the transformations for $N_i$, $N_j$, and $dx$:\n$$\nM_{ij} = \\int_{\\widehat{T}} \\epsilon \\left( (J^{-1})^T \\widehat{N}_i(\\hat{x}) \\right) \\cdot \\left( (J^{-1})^T \\widehat{N}_j(\\hat{x}) \\right) \\det(J) d\\hat{x}\n$$\nThe dot product can be rewritten as a quadratic form: $(A\\mathbf{u})\\cdot(A\\mathbf{v}) = \\mathbf{u}^T A^T A \\mathbf{v}$. Here, $A=(J^{-1})^T$. So $A^T A = (J^{-1}) (J^{-1})^T = (J^T J)^{-1}$. Let $G = J^T J$ be the metric tensor associated with the mapping. Then $(J^T J)^{-1} = G^{-1}$.\n$$\nM_{ij} = \\epsilon \\det(J) \\int_{\\widehat{T}} \\widehat{N}_i(\\hat{x})^T G^{-1} \\widehat{N}_j(\\hat{x}) d\\hat{x}\n$$\n\nNext, consider the stiffness matrix entry $K_{ij}$:\n$$\nK_{ij} = \\int_T \\mu^{-1} (\\nabla \\times N_i(x)) \\cdot (\\nabla \\times N_j(x)) dx\n$$\nSubstituting the curl transformation and the volume element transformation:\n$$\nK_{ij} = \\int_{\\widehat{T}} \\mu^{-1} \\left( \\frac{1}{\\det(J)} J (\\hat{\\nabla} \\times \\widehat{N}_i) \\right) \\cdot \\left( \\frac{1}{\\det(J)} J (\\hat{\\nabla} \\times \\widehat{N}_j) \\right) \\det(J) d\\hat{x}\n$$\n$$\nK_{ij} = \\frac{\\mu^{-1}}{\\det(J)} \\int_{\\widehat{T}} \\left( J (\\hat{\\nabla} \\times \\widehat{N}_i) \\right) \\cdot \\left( J (\\hat{\\nabla} \\times \\widehat{N}_j) \\right) d\\hat{x}\n$$\nThe dot product can be rewritten as $(\\hat{\\nabla} \\times \\widehat{N}_i)^T J^T J (\\hat{\\nabla} \\times \\widehat{N}_j) = (\\hat{\\nabla} \\times \\widehat{N}_i)^T G (\\hat{\\nabla} \\times \\widehat{N}_j)$.\nThe term $\\hat{\\nabla} \\times \\widehat{N}_i$ is a constant vector on $\\widehat{T}$. Therefore, the entire integrand is constant. The integral is simply the integrand multiplied by the volume of the reference element, $\\mathrm{vol}(\\widehat{T}) = \\frac{1}{6}$.\n$$\nK_{ij} = \\frac{\\mu^{-1}}{\\det(J)} \\left( (\\hat{\\nabla} \\times \\widehat{N}_i)^T G (\\hat{\\nabla} \\times \\widehat{N}_j) \\right) \\mathrm{vol}(\\widehat{T})\n$$\n$$\nK_{ij} = \\frac{\\mu^{-1}}{6\\det(J)} (\\hat{\\nabla} \\times \\widehat{N}_i) \\cdot (G (\\hat{\\nabla} \\times \\widehat{N}_j))\n$$\n\nThe algorithmic steps to compute these matrices are:\n1. For a given physical element $T$ with vertices $\\{v_k\\}_{k=1}^4$, determine the Jacobian $J$ of the affine map from $\\widehat{T}$ to $T$. If $\\hat{v}_1$ maps to $v_1$, the columns of $J$ are given by $v_2-v_1$, $v_3-v_1$, and $v_4-v_1$.\n2. Compute $\\det(J)$ and the metric tensor $G = J^T J$.\n3. Pre-compute and store the $6$ constant curl vectors $\\hat{C}_i = \\hat{\\nabla} \\times \\widehat{N}_i$ on the reference element.\n4. To compute the stiffness matrix $K$, for each entry $(i, j)$, calculate $K_{ij} = \\frac{\\mu^{-1}}{6\\det(J)} \\hat{C}_i^T G \\hat{C}_j$.\n5. To compute the mass matrix $M$, for each entry $(i, j)$, compute the integral $M_{ij} = \\epsilon \\det(J) \\int_{\\widehat{T}} \\widehat{N}_i^T G^{-1} \\widehat{N}_j d\\hat{x}$. This integral involves quadratic polynomials in barycentric coordinates and is typically evaluated using a numerical quadrature rule on $\\widehat{T}$ that is exact for polynomials of at least degree $2$.\n\nNow, we apply this to the specific case given. The Jacobian is $J = \\mathrm{diag}(2, 3, 4)$.\nThe determinant is $\\det(J) = 2 \\times 3 \\times 4 = 24$.\nThe metric tensor is $G = J^T J = \\mathrm{diag}(2, 3, 4) \\mathrm{diag}(2, 3, 4) = \\mathrm{diag}(4, 9, 16)$.\nThe translation vector $b$ is irrelevant as it disappears from all derivatives and transformations of the integrands.\n\nWe need to compute the stiffness entry $K_{12}$. This requires the basis functions for edge $1$ and edge $2$.\nEdge $1$ is $(\\hat{v}_1, \\hat{v}_2)$, so $i=1$ corresponds to the pair $(a,b)=(1,2)$.\nEdge $2$ is $(\\hat{v}_1, \\hat{v}_3)$, so $j=2$ corresponds to the pair $(a,b)=(1,3)$.\n\nThe curl for basis function $\\widehat{N}_1 = \\widehat{N}_{12}$ is:\n$$\n\\hat{\\nabla} \\times \\widehat{N}_1 = 2 (\\hat{\\nabla} \\hat{\\lambda}_1 \\times \\hat{\\nabla} \\hat{\\lambda}_2) = 2 \\left( \\begin{pmatrix}-1 \\\\ -1 \\\\ -1\\end{pmatrix} \\times \\begin{pmatrix}1 \\\\ 0 \\\\ 0\\end{pmatrix} \\right) = 2 \\begin{pmatrix}0 \\\\ -1 \\\\ 1\\end{pmatrix} = \\begin{pmatrix}0 \\\\ -2 \\\\ 2\\end{pmatrix}\n$$\nThe curl for basis function $\\widehat{N}_2 = \\widehat{N}_{13}$ is:\n$$\n\\hat{\\nabla} \\times \\widehat{N}_2 = 2 (\\hat{\\nabla} \\hat{\\lambda}_1 \\times \\hat{\\nabla} \\hat{\\lambda}_3) = 2 \\left( \\begin{pmatrix}-1 \\\\ -1 \\\\ -1\\end{pmatrix} \\times \\begin{pmatrix}0 \\\\ 1 \\\\ 0\\end{pmatrix} \\right) = 2 \\begin{pmatrix}1 \\\\ 0 \\\\ -1\\end{pmatrix} = \\begin{pmatrix}2 \\\\ 0 \\\\ -2\\end{pmatrix}\n$$\nNow we compute the matrix-vector product inside the formula for $K_{12}$:\n$$\n(\\hat{\\nabla} \\times \\widehat{N}_1)^T G (\\hat{\\nabla} \\times \\widehat{N}_2) = \\begin{pmatrix}0 & -2 & 2\\end{pmatrix} \\begin{pmatrix}4 & 0 & 0 \\\\ 0 & 9 & 0 \\\\ 0 & 0 & 16\\end{pmatrix} \\begin{pmatrix}2 \\\\ 0 \\\\ -2\\end{pmatrix}\n$$\n$$\n= \\begin{pmatrix}0 & -2 & 2\\end{pmatrix} \\begin{pmatrix}4 \\times 2 \\\\ 9 \\times 0 \\\\ 16 \\times (-2)\\end{pmatrix} = \\begin{pmatrix}0 & -2 & 2\\end{pmatrix} \\begin{pmatrix}8 \\\\ 0 \\\\ -32\\end{pmatrix}\n$$\n$$\n= (0)(8) + (-2)(0) + (2)(-32) = -64\n$$\nFinally, we substitute this value into the expression for $K_{12}$:\n$$\nK_{12} = \\frac{\\mu^{-1}}{6\\det(J)} (-64) = \\frac{\\mu^{-1}}{6 \\times 24} (-64) = \\frac{-64}{144} \\mu^{-1}\n$$\nSimplifying the fraction $\\frac{-64}{144}$ by dividing the numerator and denominator by their greatest common divisor, $16$:\n$$\n\\frac{-64 \\div 16}{144 \\div 16} = \\frac{-4}{9}\n$$\nThus, the stiffness matrix entry $K_{12}$ is:\n$$\nK_{12} = -\\frac{4}{9} \\mu^{-1} = -\\frac{4}{9\\mu}\n$$", "answer": "$$\\boxed{-\\frac{4}{9\\mu}}$$", "id": "3334027"}]}