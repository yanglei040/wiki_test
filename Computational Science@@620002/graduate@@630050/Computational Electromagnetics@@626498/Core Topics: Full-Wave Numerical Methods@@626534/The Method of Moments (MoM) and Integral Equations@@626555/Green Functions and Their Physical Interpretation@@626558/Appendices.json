{"hands_on_practices": [{"introduction": "Understanding the Green's function begins with its fundamental construction. This exercise guides you through the derivation of the spherical wave expansion of the free-space Helmholtz Green's function, a cornerstone of wave physics [@problem_id:3312732]. By applying the method of separation of variables and enforcing physical boundary conditions, you will see how the familiar form of the Green's function emerges directly from first principles.", "problem": "Consider the time-harmonic scalar Helmholtz Green’s function in a homogeneous, isotropic, source-free three-dimensional space, defined as the distributional solution of the boundary-value problem\n$$(\\nabla^{2}+k^{2})\\,G(\\mathbf{r},\\mathbf{r}')=-\\delta(\\mathbf{r}-\\mathbf{r}'),\\quad \\text{with the Sommerfeld radiation condition at infinity},$$\nwhere $k>0$ is the real wavenumber and $\\delta(\\mathbf{r}-\\mathbf{r}')$ is the three-dimensional Dirac delta distribution. Starting only from this definition, from the orthonormal completeness of spherical harmonics $Y_{\\ell m}(\\hat{\\mathbf{r}})$ on the unit sphere, and from regularity at the origin and radiation at infinity as physical conditions, perform the following steps:\n\n- Separate variables in spherical coordinates and expand $G(\\mathbf{r},\\mathbf{r}')$ over $Y_{\\ell m}(\\hat{\\mathbf{r}})$ so that each angular momentum channel $\\ell$ yields a radial Green’s function that satisfies the correct distributional jump condition implied by the Dirac delta source.\n- Use the two linearly independent homogeneous radial solutions that are, respectively, regular at the origin and purely outgoing at infinity, to construct the unique piecewise radial Green’s function. Determine the expansion coefficient exactly by enforcing the distributional jump condition across $r=r'$.\n- Reassemble the full solution and use the addition theorem for spherical harmonics to express the result in terms of the Legendre polynomials $P_{\\ell}(\\cos\\gamma)$, where $\\gamma$ is the angle between $\\hat{\\mathbf{r}}$ and $\\hat{\\mathbf{r}}'$.\n\nYour final answer must be a single, closed-form series expression for $G(\\mathbf{r},\\mathbf{r}')$ written in terms of $j_{\\ell}$, $h_{\\ell}^{(1)}$, and $P_{\\ell}$, with the explicit dependences on $r_{<}=\\min(r,r')$, $r_{>}=\\max(r,r')$, and $\\gamma=\\arccos(\\hat{\\mathbf{r}}\\cdot\\hat{\\mathbf{r}}')$. No numerical evaluation is required. Express the final result as a single analytic expression. Do not include any units in your final expression.", "solution": "We begin with the defining distributional partial differential equation for the time-harmonic scalar Green's function $G(\\mathbf{r},\\mathbf{r}')$ in a homogeneous, isotropic, three-dimensional space:\n$$(\\nabla^{2}+k^{2})\\,G(\\mathbf{r},\\mathbf{r}')=-\\delta(\\mathbf{r}-\\mathbf{r}')$$\nsubject to the Sommerfeld radiation condition at infinity. Here, $k>0$ is a real wavenumber, $\\mathbf{r}$ is the observation point, $\\mathbf{r}'$ is the source point, and $\\delta(\\mathbf{r}-\\mathbf{r}')$ is the three-dimensional Dirac delta distribution.\n\nTo solve this equation in spherical coordinates $(r, \\theta, \\phi)$, we utilize the method of separation of variables. The rotational invariance of the operator $(\\nabla^{2}+k^{2})$ and the source point implies that the Green's function depends only on the radial distances $r=|\\mathbf{r}|$, $r'=|\\mathbf{r}'|$, and the angle $\\gamma$ between the vectors $\\mathbf{r}$ and $\\mathbf{r}'$. We can thus expand $G(\\mathbf{r},\\mathbf{r}')$ in a basis that separates radial and angular dependence. The spherical harmonics $Y_{\\ell m}(\\hat{\\mathbf{r}})$ form a complete orthonormal basis on the unit sphere, satisfying $L^2 Y_{\\ell m} = \\ell(\\ell+1) Y_{\\ell m}$, where $L^2$ is the angular part of the Laplacian. We expand both the Green's function and the Dirac delta function in this basis.\n\nFirst, the Dirac delta function is expressed in spherical coordinates as:\n$$\\delta(\\mathbf{r}-\\mathbf{r}') = \\frac{\\delta(r-r')}{r^{2}} \\delta(\\hat{\\mathbf{r}}-\\hat{\\mathbf{r}}')$$\nThe angular delta function $\\delta(\\hat{\\mathbf{r}}-\\hat{\\mathbf{r}}')$ has the closure relation in terms of spherical harmonics:\n$$\\delta(\\hat{\\mathbf{r}}-\\hat{\\mathbf{r}}') = \\sum_{\\ell=0}^{\\infty} \\sum_{m=-\\ell}^{\\ell} Y_{\\ell m}(\\hat{\\mathbf{r}}) Y_{\\ell m}^{*}(\\hat{\\mathbf{r}}')$$\nCombining these gives the source term expansion:\n$$-\\delta(\\mathbf{r}-\\mathbf{r}') = -\\frac{\\delta(r-r')}{r^{2}} \\sum_{\\ell=0}^{\\infty} \\sum_{m=-\\ell}^{\\ell} Y_{\\ell m}(\\hat{\\mathbf{r}}) Y_{\\ell m}^{*}(\\hat{\\mathbf{r}}')$$\nNext, we posit a corresponding expansion for the Green's function. Due to the rotational symmetry, the coefficients of the expansion will not depend on the magnetic quantum number $m$. We write:\n$$G(\\mathbf{r},\\mathbf{r}') = \\sum_{\\ell=0}^{\\infty} \\sum_{m=-\\ell}^{\\ell} g_{\\ell}(r,r') Y_{\\ell m}(\\hat{\\mathbf{r}}) Y_{\\ell m}^{*}(\\hat{\\mathbf{r}}')$$\nThe Laplacian operator in spherical coordinates is $\\nabla^{2} = \\frac{1}{r^{2}}\\frac{\\partial}{\\partial r}\\left(r^{2} \\frac{\\partial}{\\partial r}\\right) - \\frac{L^{2}}{r^{2}}$. Substituting the expansions into the Helmholtz equation yields:\n$$\\sum_{\\ell,m} \\left[ \\left(\\frac{1}{r^{2}}\\frac{d}{dr}r^{2}\\frac{d}{dr} - \\frac{\\ell(\\ell+1)}{r^{2}} + k^{2}\\right)g_{\\ell}(r,r') \\right] Y_{\\ell m}(\\hat{\\mathbf{r}})Y_{\\ell m}^{*}(\\hat{\\mathbf{r}}') = -\\frac{\\delta(r-r')}{r^{2}} \\sum_{\\ell,m} Y_{\\ell m}(\\hat{\\mathbf{r}})Y_{\\ell m}^{*}(\\hat{\\mathbf{r}}')$$\nBy equating the coefficients of the basis functions $Y_{\\ell m}(\\hat{\\mathbf{r}})Y_{\\ell m}^{*}(\\hat{\\mathbf{r}}')$, we obtain a one-dimensional ordinary differential equation for the radial Green's function $g_{\\ell}(r,r')$ for each angular momentum channel $\\ell$:\n$$\\left[ \\frac{1}{r^{2}}\\frac{d}{dr}\\left(r^{2}\\frac{d}{dr}\\right) + k^{2} - \\frac{\\ell(\\ell+1)}{r^{2}} \\right] g_{\\ell}(r,r') = -\\frac{\\delta(r-r')}{r^{2}}$$\nThis can be rewritten in the standard Sturm-Liouville form $L[y] = -(1/p(x))\\delta(x-x')$ by multiplying by $r^2$:\n$$\\left[ \\frac{d}{dr}\\left(r^{2}\\frac{d}{dr}\\right) + (k^{2}r^{2} - \\ell(\\ell+1)) \\right] g_{\\ell}(r,r') = -\\delta(r-r')$$\nThe homogeneous part of this equation (for $r \\neq r'$) is the spherical Bessel equation. Its two linearly independent solutions are the spherical Bessel function of the first kind, $j_{\\ell}(kr)$, and the spherical Neumann function, $y_{\\ell}(kr)$.\nThe physical boundary conditions dictate the choice of solutions.\n$1$. For $r < r'$, the solution must be regular at the origin ($r=0$). The function $j_{\\ell}(kr)$ is regular, while $y_{\\ell}(kr)$ is singular. Thus, the solution in this region must be proportional to $j_{\\ell}(kr)$.\n$2$. For $r > r'$, the solution must satisfy the Sommerfeld radiation condition, representing a purely outgoing wave at infinity. The spherical Hankel function of the first kind, $h_{\\ell}^{(1)}(kr) = j_{\\ell}(kr) + i y_{\\ell}(kr)$, has the asymptotic behavior $\\sim \\frac{1}{kr} \\exp(i(kr - (\\ell+1)\\pi/2))$ and represents an outgoing wave. Thus, the solution in this region must be proportional to $h_{\\ell}^{(1)}(kr)$.\n\nBased on these conditions and requiring continuity at $r=r'$, we construct the piecewise radial Green's function. We introduce $r_{<} = \\min(r,r')$ and $r_{>} = \\max(r,r')$. The form that ensures continuity and symmetry ($g_{\\ell}(r,r')=g_{\\ell}(r',r)$) is:\n$$g_{\\ell}(r,r') = C_{\\ell} \\, j_{\\ell}(kr_{<}) \\, h_{\\ell}^{(1)}(kr_{>})$$\nwhere $C_{\\ell}$ is a constant to be determined. To find $C_{\\ell}$, we enforce the jump condition on the derivative of $g_{\\ell}$ at $r=r'$, which is derived by integrating the Sturm-Liouville equation across the singularity at $r=r'$:\n$$\\int_{r'-\\epsilon}^{r'+\\epsilon} \\left[ \\frac{d}{dr}\\left(r^{2}\\frac{dg_{\\ell}}{dr}\\right) + (k^{2}r^{2} - \\ell(\\ell+1)) g_{\\ell} \\right] dr = \\int_{r'-\\epsilon}^{r'+\\epsilon} (-\\delta(r-r')) dr = -1$$\nAs $\\epsilon \\to 0$, the integral of the term containing $g_{\\ell}$ vanishes due to continuity. The first term yields:\n$$\\left[ r^{2}\\frac{dg_{\\ell}}{dr} \\right]_{r=r'_{-}}^{r=r'_{+}} = -1$$\nSpecifically, $\\left(r'^{2} \\frac{d}{dr} [C_{\\ell} j_{\\ell}(kr') h_{\\ell}^{(1)}(kr)]_{r=r'}\\right) - \\left(r'^{2} \\frac{d}{dr} [C_{\\ell} j_{\\ell}(kr) h_{\\ell}^{(1)}(kr')]_{r=r'}\\right) = -1$.\n$$C_{\\ell} r'^{2} \\left[ j_{\\ell}(kr') k(h_{\\ell}^{(1)})'(kr') - h_{\\ell}^{(1)}(kr') k j'_{\\ell}(kr') \\right] = -1$$\nThe expression in brackets is $k$ times the Wronskian determinant $W[j_{\\ell}(z), h_{\\ell}^{(1)}(z)]$ evaluated at $z=kr'$.\nThe Wronskian of spherical Bessel functions $j_{\\ell}(z)$ and $y_{\\ell}(z)$ is $W[j_{\\ell}(z), y_{\\ell}(z)] = z^{-2}$. Therefore, the Wronskian we need is:\n$$W[j_{\\ell}(z), h_{\\ell}^{(1)}(z)] = W[j_{\\ell}(z), j_{\\ell}(z) + i y_{\\ell}(z)] = i W[j_{\\ell}(z), y_{\\ell}(z)] = \\frac{i}{z^{2}}$$\nSubstituting $z=kr'$, the jump condition becomes:\n$$C_{\\ell} r'^{2} k \\left( \\frac{i}{(kr')^{2}} \\right) = -1 \\implies C_{\\ell} \\frac{i}{k} = -1 \\implies C_{\\ell} = ik$$\nThe constant is independent of $\\ell$. The radial Green's function is therefore:\n$$g_{\\ell}(r,r') = ik \\, j_{\\ell}(kr_{<}) \\, h_{\\ell}^{(1)}(kr_{>})$$\nNow we reassemble the full Green's function by substituting this result back into its series expansion:\n$$G(\\mathbf{r},\\mathbf{r}') = \\sum_{\\ell=0}^{\\infty} \\sum_{m=-\\ell}^{\\ell} ik \\, j_{\\ell}(kr_{<}) \\, h_{\\ell}^{(1)}(kr_{>}) Y_{\\ell m}(\\hat{\\mathbf{r}}) Y_{\\ell m}^{*}(\\hat{\\mathbf{r}}')$$\n$$G(\\mathbf{r},\\mathbf{r}') = ik \\sum_{\\ell=0}^{\\infty} j_{\\ell}(kr_{<}) \\, h_{\\ell}^{(1)}(kr_{>}) \\left( \\sum_{m=-\\ell}^{\\ell} Y_{\\ell m}(\\hat{\\mathbf{r}}) Y_{\\ell m}^{*}(\\hat{\\mathbf{r}}') \\right)$$\nFinally, we use the addition theorem for spherical harmonics to simplify the sum over $m$:\n$$\\sum_{m=-\\ell}^{\\ell} Y_{\\ell m}(\\hat{\\mathbf{r}}) Y_{\\ell m}^{*}(\\hat{\\mathbf{r}}') = \\frac{2\\ell+1}{4\\pi} P_{\\ell}(\\cos\\gamma)$$\nwhere $P_{\\ell}$ is the Legendre polynomial of degree $\\ell$, and $\\gamma = \\arccos(\\hat{\\mathbf{r}}\\cdot\\hat{\\mathbf{r}}')$ is the angle between the observation and source directions.\nSubstituting this into the expression for $G(\\mathbf{r},\\mathbf{r}')$ gives the final result:\n$$G(\\mathbf{r},\\mathbf{r}') = ik \\sum_{\\ell=0}^{\\infty} \\frac{2\\ell+1}{4\\pi} j_{\\ell}(kr_{<})h_{\\ell}^{(1)}(kr_{>}) P_{\\ell}(\\cos\\gamma)$$\nThis is the spherical wave expansion of the free-space Helmholtz Green's function.", "answer": "$$\\boxed{\\frac{ik}{4\\pi} \\sum_{\\ell=0}^{\\infty} (2\\ell+1) j_{\\ell}(kr_{<}) h_{\\ell}^{(1)}(kr_{>}) P_{\\ell}(\\cos\\gamma)}$$", "id": "3312732"}, {"introduction": "While scalar Green's functions are foundational, electromagnetics is inherently a vector field theory. This practice challenges you to derive the more complex dyadic Green's function for the electric field and decompose it into its transverse and longitudinal components [@problem_id:3312799]. This derivation is crucial as it reveals how the singular longitudinal part of the Green's function is not a mathematical nuisance, but the very mechanism that enforces fundamental physical laws like charge conservation.", "problem": "Consider a homogeneous, isotropic, source-free background characterized by permittivity $\\varepsilon$ and permeability $\\mu$, and adopt the time-harmonic convention $\\exp(-i \\omega t)$. Let $\\mathbf{E}(\\mathbf{r})$ be the electric field produced by a time-harmonic impressed electric current density $\\mathbf{J}(\\mathbf{r})$ that is compactly supported and satisfies the charge-continuity equation $\\nabla \\cdot \\mathbf{J} = i \\omega \\rho$, where $\\rho$ is the time-harmonic charge density. Define the electric-field dyadic Green’s function $\\mathbf{G}_E(\\mathbf{r})$ as the distribution-valued dyadic that satisfies the vector Helmholtz equation with the outgoing-wave (Sommerfeld) radiation condition:\n$$\n\\nabla \\times \\nabla \\times \\mathbf{G}_E(\\mathbf{r}) - k^{2} \\mathbf{G}_E(\\mathbf{r}) = \\mathbf{I} \\, \\delta(\\mathbf{r}),\n$$\nwhere $k^{2} = \\omega^{2} \\mu \\varepsilon$ and $\\mathbf{I}$ is the identity dyadic. The physical field is represented by the volume potential\n$$\n\\mathbf{E}(\\mathbf{r}) = i \\omega \\mu \\int_{\\mathbb{R}^{3}} \\mathbf{G}_E(\\mathbf{r} - \\mathbf{r}') \\cdot \\mathbf{J}(\\mathbf{r}') \\, d^{3}\\mathbf{r}'.\n$$\n\nStarting from Maxwell’s equations and the above definitions:\n- Derive the explicit free-space expression (for $|\\mathbf{r}| \\neq 0$) of $\\mathbf{G}_E(\\mathbf{r})$ in closed form.\n- Decompose $\\mathbf{G}_E(\\mathbf{r})$ into a transverse part $\\mathbf{G}_E^{T}(\\mathbf{r})$ and a longitudinal part $\\mathbf{G}_E^{L}(\\mathbf{r})$ such that $\\nabla \\cdot \\mathbf{G}_E^{T} = \\mathbf{0}$ and $\\nabla \\times \\mathbf{G}_E^{L} = \\mathbf{0}$ in the distributional sense, and provide closed-form expressions for $\\mathbf{G}_E^{T}(\\mathbf{r})$ and $\\mathbf{G}_E^{L}(\\mathbf{r})$ for $|\\mathbf{r}| \\neq 0$.\n- Using only fundamental laws, explain how the longitudinal part enforces charge conservation through the identity for the divergence of $\\mathbf{G}_E$ and show that Gauss’s law $\\nabla \\cdot \\mathbf{E} = \\rho/\\varepsilon$ follows from the volume-potential representation.\n\nLet $r = |\\mathbf{r}|$ and $\\hat{\\mathbf{r}} = \\mathbf{r}/r$. Express your final answer as the single row matrix containing $\\mathbf{G}_E(\\mathbf{r})$, $\\mathbf{G}_E^{T}(\\mathbf{r})$, and $\\mathbf{G}_E^{L}(\\mathbf{r})$ in compact dyadic form, valid for $r \\neq 0$. The final answer must be a single closed-form analytic expression (no inequalities or equations, and do not include units inside the final box).", "solution": "The problem requires the derivation of the electric-field dyadic Green's function $\\mathbf{G}_E(\\mathbf{r})$ in free space, its decomposition into transverse and longitudinal parts, and a physical interpretation related to charge conservation.\n\n### Part 1: Derivation of the Electric-Field Dyadic Green's Function $\\mathbf{G}_E(\\mathbf{r})$\n\nWe start from the governing vector Helmholtz equation for the dyadic Green's function $\\mathbf{G}_E(\\mathbf{r})$:\n$$\n\\nabla \\times \\nabla \\times \\mathbf{G}_E(\\mathbf{r}) - k^{2} \\mathbf{G}_E(\\mathbf{r}) = \\mathbf{I} \\, \\delta(\\mathbf{r})\n$$\nwhere $k^2 = \\omega^2 \\mu \\varepsilon$. We will solve this equation in the sense of distributions. Taking the divergence of this equation, and using the identity $\\nabla \\cdot (\\nabla \\times \\mathbf{A}) = \\mathbf{0}$, we obtain:\n$$\n-k^2 \\nabla \\cdot \\mathbf{G}_E(\\mathbf{r}) = \\nabla \\cdot (\\mathbf{I} \\delta(\\mathbf{r})) = \\nabla \\delta(\\mathbf{r})\n$$\nThis gives the divergence of $\\mathbf{G}_E(\\mathbf{r})$:\n$$\n\\nabla \\cdot \\mathbf{G}_E(\\mathbf{r}) = -\\frac{1}{k^2} \\nabla \\delta(\\mathbf{r})\n$$\nNext, we use the vector identity $\\nabla \\times \\nabla \\times \\mathbf{A} = \\nabla(\\nabla \\cdot \\mathbf{A}) - \\nabla^2 \\mathbf{A}$, which is valid for distributions. Applying it to the governing equation for $\\mathbf{G}_E$:\n$$\n\\nabla(\\nabla \\cdot \\mathbf{G}_E) - \\nabla^2 \\mathbf{G}_E - k^2 \\mathbf{G}_E = \\mathbf{I} \\delta(\\mathbf{r})\n$$\nSubstituting the derived expression for $\\nabla \\cdot \\mathbf{G}_E$:\n$$\n\\nabla \\left(-\\frac{1}{k^2} \\nabla \\delta(\\mathbf{r})\\right) - (\\nabla^2 + k^2)\\mathbf{G}_E(\\mathbf{r}) = \\mathbf{I} \\delta(\\mathbf{r})\n$$\nRearranging the terms, we get a standard vector Helmholtz equation for $\\mathbf{G}_E(\\mathbf{r})$:\n$$\n(\\nabla^2 + k^2)\\mathbf{G}_E(\\mathbf{r}) = -\\mathbf{I} \\delta(\\mathbf{r}) - \\frac{1}{k^2} \\nabla \\nabla \\delta(\\mathbf{r})\n$$\nThe solution to this equation can be found by convolution with the scalar Green's function for the Helmholtz operator, $g_k(\\mathbf{r}) = \\frac{\\exp(ikr)}{4\\pi r}$, which satisfies $(\\nabla^2 + k^2)g_k(\\mathbf{r}) = -\\delta(\\mathbf{r})$ and the Sommerfeld radiation condition.\n$$\n\\mathbf{G}_E(\\mathbf{r}) = \\int_{\\mathbb{R}^3} g_k(\\mathbf{r}-\\mathbf{r}') \\left( \\mathbf{I} \\delta(\\mathbf{r}') + \\frac{1}{k^2} \\nabla' \\nabla' \\delta(\\mathbf{r}') \\right) d^3\\mathbf{r}'\n$$\nUsing the properties of the delta function and integration by parts, this yields:\n$$\n\\mathbf{G}_E(\\mathbf{r}) = \\mathbf{I} g_k(\\mathbf{r}) + \\frac{1}{k^2} \\nabla \\nabla g_k(\\mathbf{r})\n$$\nThis is the formal expression for $\\mathbf{G}_E(\\mathbf{r})$. To find the explicit form for $r = |\\mathbf{r}| \\neq 0$, we compute the Hessian $\\nabla \\nabla g_k(r)$:\n$\\nabla g_k(r) = \\frac{dg_k}{dr}\\hat{\\mathbf{r}}$\n$\\nabla \\nabla g_k(r) = \\frac{d^2 g_k}{dr^2} (\\hat{\\mathbf{r}} \\otimes \\hat{\\mathbf{r}}) + \\frac{1}{r} \\frac{dg_k}{dr} (\\mathbf{I} - \\hat{\\mathbf{r}} \\otimes \\hat{\\mathbf{r}})$\nThe derivatives of $g_k(r) = \\frac{\\exp(ikr)}{4\\pi r}$ are:\n$\\frac{dg_k}{dr} = \\frac{\\exp(ikr)}{4\\pi} \\left(\\frac{ik}{r} - \\frac{1}{r^2}\\right)$\n$\\frac{d^2g_k}{dr^2} = \\frac{\\exp(ikr)}{4\\pi} \\left(\\frac{-k^2}{r} - \\frac{2ik}{r^2} + \\frac{2}{r^3}\\right)$\nSubstituting these into the expression for $\\mathbf{G}_E(\\mathbf{r})$ and simplifying gives:\n$$\n\\mathbf{G}_E(\\mathbf{r}) = \\frac{\\exp(ikr)}{4 \\pi r} \\left[ \\left( 1 + \\frac{i}{kr} - \\frac{1}{(kr)^2} \\right) \\mathbf{I} + \\left( -1 - \\frac{3i}{kr} + \\frac{3}{(kr)^2} \\right) (\\hat{\\mathbf{r}} \\otimes \\hat{\\mathbf{r}}) \\right]\n$$\n\n### Part 2: Decomposition into Transverse and Longitudinal Parts\n\nWe seek a decomposition $\\mathbf{G}_E(\\mathbf{r}) = \\mathbf{G}_E^T(\\mathbf{r}) + \\mathbf{G}_E^L(\\mathbf{r})$ such that $\\nabla \\cdot \\mathbf{G}_E^T = \\mathbf{0}$ (transverse) and $\\nabla \\times \\mathbf{G}_E^L = \\mathbf{0}$ (longitudinal), in the distributional sense.\n\nThe longitudinal part $\\mathbf{G}_E^L$ is irrotational. Its divergence must be the same as that of $\\mathbf{G}_E$:\n$\\nabla \\cdot \\mathbf{G}_E^L = \\nabla \\cdot \\mathbf{G}_E = -\\frac{1}{k^2}\\nabla \\delta(\\mathbf{r})$.\nSince $\\mathbf{G}_E^L$ is irrotational, each of its columns can be written as the gradient of a scalar potential. Let $\\mathbf{G}_E^L = \\nabla \\otimes \\boldsymbol{\\psi}$ for some vector potential $\\boldsymbol{\\psi}$. The divergence is $(\\nabla \\cdot \\mathbf{G}_E^L)_j = \\nabla^2 \\psi_j$. Thus, we must solve:\n$\\nabla^2 \\psi_j(\\mathbf{r}) = -\\frac{1}{k^2} \\partial_j \\delta(\\mathbf{r})$.\nThe solution is found by convolving with the Green's function for the Laplacian, $g_0(r) = \\frac{1}{4\\pi r}$, which satisfies $\\nabla^2 g_0(r) = -\\delta(\\mathbf{r})$.\n$\\psi_j(\\mathbf{r}) = \\int g_0(\\mathbf{r}-\\mathbf{r}') \\left(\\frac{1}{k^2}\\partial'_j \\delta(\\mathbf{r}')\\right) d^3\\mathbf{r}' = \\frac{1}{k^2} \\partial_j g_0(\\mathbf{r})$.\nSo, the vector potential is $\\boldsymbol{\\psi}(\\mathbf{r}) = \\frac{1}{k^2}\\nabla g_0(\\mathbf{r})$. The longitudinal part is then:\n$\\mathbf{G}_E^L(\\mathbf{r}) = \\nabla \\otimes (\\frac{1}{k^2}\\nabla g_0(\\mathbf{r})) = \\frac{1}{k^2}\\nabla\\nabla g_0(\\mathbf{r})$.\nFor $r \\neq 0$:\n$\\nabla\\nabla g_0(r) = \\nabla\\nabla \\frac{1}{4\\pi r} = \\frac{1}{4\\pi} \\frac{3(\\hat{\\mathbf{r}} \\otimes \\hat{\\mathbf{r}}) - \\mathbf{I}}{r^3}$.\nSo, the longitudinal part for $r \\neq 0$ is:\n$$\n\\mathbf{G}_E^L(\\mathbf{r}) = \\frac{1}{4\\pi k^2 r^3} \\left( 3(\\hat{\\mathbf{r}} \\otimes \\hat{\\mathbf{r}}) - \\mathbf{I} \\right)\n$$\nThe transverse part $\\mathbf{G}_E^T(\\mathbf{r})$ is obtained by subtraction: $\\mathbf{G}_E^T = \\mathbf{G}_E - \\mathbf{G}_E^L$.\n$$\n\\mathbf{G}_E^T(\\mathbf{r}) = \\frac{\\exp(ikr)}{4 \\pi r} \\left[ \\left( 1 + \\frac{i}{kr} - \\frac{1}{(kr)^2} \\right) \\mathbf{I} + \\left( -1 - \\frac{3i}{kr} + \\frac{3}{(kr)^2} \\right) (\\hat{\\mathbf{r}} \\otimes \\hat{\\mathbf{r}}) \\right] - \\frac{1}{4\\pi k^2 r^3} \\left( 3(\\hat{\\mathbf{r}} \\otimes \\hat{\\mathbf{r}}) - \\mathbf{I} \\right)\n$$\nGrouping terms with $\\mathbf{I}$ and $\\hat{\\mathbf{r}} \\otimes \\hat{\\mathbf{r}}$ yields:\n$$\n\\mathbf{G}_E^T(\\mathbf{r}) = \\frac{1}{4\\pi} \\left[ \\left( \\frac{\\exp(ikr)}{r} + \\frac{i\\exp(ikr)}{kr^2} + \\frac{1-\\exp(ikr)}{k^2 r^3} \\right) \\mathbf{I} - \\left(\\frac{\\exp(ikr)}{r} + \\frac{3i\\exp(ikr)}{kr^2} + \\frac{3(1-\\exp(ikr))}{k^2 r^3} \\right) (\\hat{\\mathbf{r}} \\otimes \\hat{\\mathbf{r}}) \\right]\n$$\n\n### Part 3: Physical Interpretation and Gauss's Law\n\nThe longitudinal part of the Green's function, $\\mathbf{G}_E^L$, is directly responsible for enforcing charge conservation as embodied by Gauss's law. The transverse part $\\mathbf{G}_E^T$ is solenoidal ($\\nabla\\cdot\\mathbf{G}_E^T = \\mathbf{0}$) and thus does not contribute to the divergence of the electric field.\nTo derive Gauss's Law, we take the divergence of the volume potential representation for $\\mathbf{E}(\\mathbf{r})$:\n$$\n\\nabla \\cdot \\mathbf{E}(\\mathbf{r}) = \\nabla \\cdot \\left( i \\omega \\mu \\int_{\\mathbb{R}^{3}} \\mathbf{G}_E(\\mathbf{r} - \\mathbf{r}') \\cdot \\mathbf{J}(\\mathbf{r}') \\, d^{3}\\mathbf{r}' \\right) = i \\omega \\mu \\int_{\\mathbb{R}^{3}} (\\nabla \\cdot \\mathbf{G}_E(\\mathbf{r} - \\mathbf{r}')) \\cdot \\mathbf{J}(\\mathbf{r}') \\, d^{3}\\mathbf{r}'\n$$\nSince $\\nabla \\cdot \\mathbf{G}_E = \\nabla \\cdot \\mathbf{G}_E^L = -\\frac{1}{k^2} \\nabla \\delta(\\mathbf{r})$, we have:\n$$\n\\nabla \\cdot \\mathbf{E}(\\mathbf{r}) = i \\omega \\mu \\int_{\\mathbb{R}^{3}} \\left(-\\frac{1}{k^2} \\nabla_{\\mathbf{r}} \\delta(\\mathbf{r} - \\mathbf{r}')\\right) \\cdot \\mathbf{J}(\\mathbf{r}') \\, d^{3}\\mathbf{r}'\n$$\nUsing $\\nabla_{\\mathbf{r}} = -\\nabla_{\\mathbf{r}'}$ and integrating by parts (the boundary term vanishes for a compactly supported current density $\\mathbf{J}$):\n$$\n\\int_{\\mathbb{R}^{3}} (\\nabla_{\\mathbf{r}'} \\delta(\\mathbf{r} - \\mathbf{r}')) \\cdot \\mathbf{J}(\\mathbf{r}') \\, d^{3}\\mathbf{r}' = - \\int_{\\mathbb{R}^{3}} \\delta(\\mathbf{r} - \\mathbf{r}') \\nabla'_{\\mathbf{r}'} \\cdot \\mathbf{J}(\\mathbf{r}') \\, d^{3}\\mathbf{r}' = - (\\nabla \\cdot \\mathbf{J})(\\mathbf{r})\n$$\nSo the divergence of the electric field becomes:\n$$\n\\nabla \\cdot \\mathbf{E}(\\mathbf{r}) = i \\omega \\mu \\left(-\\frac{1}{k^2}\\right) \\int_{\\mathbb{R}^{3}} (-\\nabla_{\\mathbf{r}'} \\delta(\\mathbf{r} - \\mathbf{r}')) \\cdot \\mathbf{J}(\\mathbf{r}') \\, d^{3}\\mathbf{r}' = - \\frac{i \\omega \\mu}{k^2} (\\nabla \\cdot \\mathbf{J})(\\mathbf{r})\n$$\nUsing the charge continuity equation $\\nabla \\cdot \\mathbf{J} = i \\omega \\rho$ and the definition $k^2 = \\omega^2 \\mu \\varepsilon$:\n$$\n\\nabla \\cdot \\mathbf{E}(\\mathbf{r}) = - \\frac{i \\omega \\mu}{\\omega^2 \\mu \\varepsilon} (i \\omega \\rho) = - \\frac{i^2 \\omega^2 \\mu}{\\omega^2 \\mu \\varepsilon} \\rho = \\frac{\\rho}{\\varepsilon}\n$$\nThis is precisely Gauss's law for time-harmonic fields. The derivation demonstrates that the singular, irrotational (longitudinal) part of the Green's function is the mathematical mechanism that links the divergence of the current source to the divergence of the electric field, thereby ensuring consistency with charge conservation.\n\nThe final expressions for $\\mathbf{G}_E(\\mathbf{r})$, $\\mathbf{G}_E^T(\\mathbf{r})$, and $\\mathbf{G}_E^L(\\mathbf{r})$ for $r \\neq 0$ are provided in the final answer box.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{\\exp(ikr)}{4 \\pi r} \\left[ \\left( 1 + \\frac{i}{kr} - \\frac{1}{(kr)^2} \\right) \\mathbf{I} + \\left( -1 - \\frac{3i}{kr} + \\frac{3}{(kr)^2} \\right) (\\hat{\\mathbf{r}} \\otimes \\hat{\\mathbf{r}}) \\right] & \\frac{1}{4\\pi} \\left[ \\left( \\frac{\\exp(ikr)}{r} + \\frac{i\\exp(ikr)}{kr^2} + \\frac{1-\\exp(ikr)}{k^2 r^3} \\right) \\mathbf{I} - \\left(\\frac{exp(ikr)}{r} + \\frac{3i\\exp(ikr)}{kr^2} + \\frac{3(1-\\exp(ikr))}{k^2 r^3} \\right) (\\hat{\\mathbf{r}} \\otimes \\hat{\\mathbf{r}}) \\right] & \\frac{1}{4\\pi k^2 r^3} \\left( 3(\\hat{\\mathbf{r}} \\otimes \\hat{\\mathbf{r}}) - \\mathbf{I} \\right)\n\\end{pmatrix}\n}\n$$", "id": "3312799"}, {"introduction": "A theoretical model is only as good as its verifiable predictions. This final practice bridges theory and computation by asking you to validate a numerical implementation of the Green's function against two inviolable physical principles: energy conservation and reciprocity [@problem_id:3312781]. Successfully completing this task demonstrates a mastery of not only the analytical form of the Green's function but also its physical meaning and computational application.", "problem": "Consider free-space electromagnetic radiation in the frequency domain. Start from Maxwell’s equations in the frequency domain and the definition of a Green’s function as the outgoing solution of the corresponding vector Helmholtz equation for homogeneous isotropic media. Use these foundations to validate a numerical implementation of the free-space Green’s function by checking both energy conservation and reciprocity for canonical source-observer configurations. The validation should be performed in the following way.\n\n- Energy conservation validation:\n  - Model a Hertzian electric dipole source with uniform current amplitude $I_0$ and physical length $L$, located at the origin and oriented along the $\\hat{\\mathbf{z}}$-axis, radiating in free space with angular frequency $\\omega = 2\\pi f$ and wavenumber $k = \\omega/c$, where $c$ is the speed of light in vacuum, $\\epsilon_0$ is the vacuum permittivity, $\\mu_0$ is the vacuum permeability, and $\\eta_0 = \\sqrt{\\mu_0/\\epsilon_0}$ is the free-space wave impedance.\n  - Using the free-space Green’s function and the far-field approximation appropriate for a Hertzian dipole, derive the radiated electric and magnetic fields and the time-averaged Poynting flux on a sphere of radius $r_s$ centered at the source.\n  - Numerically compute the total radiated power by integrating the time-averaged radial component of the Poynting vector over the spherical observation surface. The surface integral must be expressed in terms of spherical coordinates $(\\theta,\\phi)$, with the solid angle element $d\\Omega = \\sin\\theta\\, d\\theta\\, d\\phi$, and all angles must be in radians. Use a rectangular midpoint rule over $\\theta \\in [0,\\pi]$ and $\\phi \\in [0,2\\pi)$ and ensure the numerical quadrature is scientifically sound.\n  - Compare the numerically integrated radiated power to the analytical free-space power radiated by a Hertzian dipole derived from first principles. Report the relative error as a float for each test case, computed as $|P_{\\mathrm{num}} - P_{\\mathrm{ana}}|/|P_{\\mathrm{ana}}|$, which is dimensionless. Internally, powers must be computed in watts, but only the relative errors need to be output.\n\n- Reciprocity validation:\n  - Implement the free-space scalar Green’s function $G(\\mathbf{r},\\mathbf{r}')$ for the scalar Helmholtz equation in homogeneous space, consistent with the radiation condition.\n  - For specified source and observer positions $\\mathbf{r}_s$ and $\\mathbf{r}_o$, numerically evaluate $G(\\mathbf{r}_o,\\mathbf{r}_s)$ and $G(\\mathbf{r}_s,\\mathbf{r}_o)$ using the same frequency-dependent wavenumber $k$. Check the reciprocity symmetry by verifying whether these two complex values agree to within a specified tolerance when normalized by their magnitude scale. Report a boolean for each test case: true if the symmetry holds within tolerance and false otherwise.\n\nAll quantities must use the International System of Units (SI): frequency $f$ in hertz, lengths in meters, currents in amperes, and power in watts. Angles must be in radians. Use the following test suite.\n\n- Energy conservation test cases (provide $f$, $I_0$, $L$, $r_s$, and the number of polar samples $N_\\theta$ for the midpoint quadrature; the azimuthal integral is analytic and must be performed exactly as a factor of $2\\pi$):\n  1. $f = 300 \\times 10^6$, $I_0 = 1.0$, $L = 0.05$, $r_s = 10.0$, $N_\\theta = 2000$.\n  2. $f = 2.4 \\times 10^9$, $I_0 = 0.5$, $L = 0.01$, $r_s = 10.0$, $N_\\theta = 2000$.\n  3. $f = 50 \\times 10^6$, $I_0 = 2.0$, $L = 0.10$, $r_s = 10.0$, $N_\\theta = 2000$.\n\n- Reciprocity test cases (provide $f$ and $(\\mathbf{r}_s,\\mathbf{r}_o)$):\n  1. $f = 1.0 \\times 10^9$, $\\mathbf{r}_s = (0.0, 0.0, 0.0)$, $\\mathbf{r}_o = (0.3, 0.4, 0.5)$, tolerance $= 10^{-12}$.\n  2. $f = 1.0 \\times 10^9$, $\\mathbf{r}_s = (1.0 \\times 10^{-9}, 0.0, 0.0)$, $\\mathbf{r}_o = (0.0, 0.0, 0.0)$, tolerance $= 10^{-12}$.\n  3. $f = 1.0 \\times 10^9$, $\\mathbf{r}_s = (10.0, 10.0, 10.0)$, $\\mathbf{r}_o = (-5.0, 7.0, -3.0)$, tolerance $= 10^{-12}$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the following order: the three energy conservation relative errors (floats) followed by the three reciprocity checks (booleans). For example, the output format must be exactly like\n\"[E1,E2,E3,R1,R2,R3]\"\nwhere $E_i$ are floats and $R_i$ are booleans.", "solution": "The problem statement describes validation procedures in computational electromagnetics: verifying energy conservation and reciprocity. The tasks are scientifically grounded in classical electromagnetism and are mathematically well-posed.\n\nThe solution is presented in two parts, corresponding to the two validation tasks.\n\n### I. Energy Conservation Validation\n\n#### A. Theoretical Foundation\nThe validation of energy conservation begins with Maxwell's equations for time-harmonic fields (with time dependence $e^{-i\\omega t}$) in a homogeneous, isotropic, and source-free medium:\n$$ \\nabla \\times \\mathbf{E} = i\\omega\\mu_0 \\mathbf{H} $$\n$$ \\nabla \\times \\mathbf{H} = -i\\omega\\epsilon_0 \\mathbf{E} $$\nThese lead to the vector Helmholtz equation:\n$$ \\nabla \\times (\\nabla \\times \\mathbf{E}) - k^2 \\mathbf{E} = \\mathbf{0} $$\nwhere $k = \\omega/c = 2\\pi f \\sqrt{\\mu_0\\epsilon_0}$ is the free-space wavenumber. For a current source $\\mathbf{J}$, the inhomogeneous equation is $\\nabla \\times (\\nabla \\times \\mathbf{E}) - k^2 \\mathbf{E} = -i\\omega\\mu_0 \\mathbf{J}$.\n\nThe problem models a Hertzian electric dipole of length $L$ and uniform current $I_0$, located at the origin and oriented along the $\\hat{\\mathbf{z}}$-axis. The current density is $\\mathbf{J}(\\mathbf{r}') = I_0 L \\delta(\\mathbf{r}') \\hat{\\mathbf{z}}$, where $\\delta(\\mathbf{r}')$ is the Dirac delta function. The term $I_0 L$ represents the dipole moment.\n\nIn the far-field (where distance $r \\gg \\lambda = 2\\pi/k$), the radiated electric and magnetic fields are given by:\n$$ \\mathbf{E}(\\mathbf{r}) \\approx -i \\frac{k \\eta_0 I_0 L}{4\\pi r} e^{ikr} (\\sin\\theta) \\hat{\\boldsymbol{\\theta}} $$\n$$ \\mathbf{H}(\\mathbf{r}) \\approx -i \\frac{k I_0 L}{4\\pi r} e^{ikr} (\\sin\\theta) \\hat{\\boldsymbol{\\phi}} $$\nHere, $\\eta_0 = \\sqrt{\\mu_0/\\epsilon_0}$ is the intrinsic impedance of free space, and $(\\hat{\\mathbf{r}}, \\hat{\\boldsymbol{\\theta}}, \\hat{\\boldsymbol{\\phi}})$ are the unit vectors in spherical coordinates.\n\nThe time-averaged Poynting vector, representing power flux density, is $\\mathbf{S}_{\\mathrm{avg}} = \\frac{1}{2} \\text{Re}\\{\\mathbf{E} \\times \\mathbf{H}^*\\}$. Substituting the far-field expressions:\n$$ \\mathbf{S}_{\\mathrm{avg}} = \\frac{1}{2} \\text{Re}\\left\\{ \\left(-i \\frac{k \\eta_0 I_0 L \\sin\\theta}{4\\pi r} e^{ikr} \\hat{\\boldsymbol{\\theta}}\\right) \\times \\left(i \\frac{k I_0 L \\sin\\theta}{4\\pi r} e^{-ikr} \\hat{\\boldsymbol{\\phi}}\\right) \\right\\} $$\n$$ \\mathbf{S}_{\\mathrm{avg}} = \\frac{1}{2} \\text{Re}\\left\\{ \\eta_0 \\left(\\frac{k I_0 L}{4\\pi r}\\right)^2 \\sin^2\\theta (\\hat{\\boldsymbol{\\theta}} \\times \\hat{\\boldsymbol{\\phi}}) \\right\\} = \\frac{\\eta_0}{2} \\left(\\frac{k I_0 L}{4\\pi r}\\right)^2 \\sin^2\\theta \\, \\hat{\\mathbf{r}} $$\nThe radial component is $S_r = |\\mathbf{S}_{\\mathrm{avg}}|$.\n\nThe total radiated power, $P_{\\mathrm{ana}}$, is found by integrating $S_r$ over the surface of a sphere of any radius $r_s$:\n$$ P_{\\mathrm{ana}} = \\oint_S \\mathbf{S}_{\\mathrm{avg}} \\cdot d\\mathbf{a} = \\int_0^{2\\pi} \\int_0^{\\pi} S_r(r_s, \\theta) r_s^2 \\sin\\theta d\\theta d\\phi $$\nSince the integrand is independent of $\\phi$, the azimuthal integral yields a factor of $2\\pi$:\n$$ P_{\\mathrm{ana}} = 2\\pi r_s^2 \\int_0^{\\pi} \\frac{\\eta_0}{2} \\left(\\frac{k I_0 L}{4\\pi r_s}\\right)^2 \\sin^2\\theta \\sin\\theta d\\theta $$\n$$ P_{\\mathrm{ana}} = \\pi r_s^2 \\frac{\\eta_0 k^2 (I_0 L)^2}{16 \\pi^2 r_s^2} \\int_0^{\\pi} \\sin^3\\theta d\\theta = \\frac{\\eta_0 k^2 (I_0 L)^2}{16\\pi} \\int_0^{\\pi} \\sin^3\\theta d\\theta $$\nThe definite integral evaluates to $\\int_0^\\pi \\sin^3\\theta d\\theta = 4/3$. Substituting this gives the analytical power:\n$$ P_{\\mathrm{ana}} = \\frac{\\eta_0 k^2 (I_0 L)^2}{16\\pi} \\left(\\frac{4}{3}\\right) = \\frac{\\eta_0 k^2 (I_0 L)^2}{12\\pi} $$\n\n#### B. Numerical Implementation\nThe numerical power, $P_{\\mathrm{num}}$, is computed by evaluating the integral $\\int_0^{\\pi} \\sin^3\\theta d\\theta$ using the rectangular midpoint rule with $N_\\theta$ intervals.\nThe interval $[0, \\pi]$ is divided into $N_\\theta$ subintervals of width $\\Delta\\theta = \\pi/N_\\theta$. The midpoints are $\\theta_i = (i - 0.5)\\Delta\\theta$ for $i = 1, 2, \\ldots, N_\\theta$.\nThe numerical integral is:\n$$ I_{\\mathrm{num}} = \\int_0^{\\pi} \\sin^3\\theta d\\theta \\approx \\sum_{i=1}^{N_\\theta} \\sin^3(\\theta_i) \\Delta\\theta $$\nThus, the numerically computed power is:\n$$ P_{\\mathrm{num}} = \\frac{\\eta_0 k^2 (I_0 L)^2}{16\\pi} I_{\\mathrm{num}} $$\nThe relative error is $E = |P_{\\mathrm{num}} - P_{\\mathrm{ana}}|/|P_{\\mathrm{ana}}|$. We can simplify this expression:\n$$ E = \\left| \\frac{P_{\\mathrm{num}}}{P_{\\mathrm{ana}}} - 1 \\right| = \\left| \\frac{\\frac{\\eta_0 k^2 (I_0 L)^2}{16\\pi} I_{\\mathrm{num}}}{\\frac{\\eta_0 k^2 (I_0 L)^2}{12\\pi}} - 1 \\right| = \\left| \\frac{12}{16} I_{\\mathrm{num}} - 1 \\right| = \\left| \\frac{3}{4} I_{\\mathrm{num}} - 1 \\right| $$\nThis simplified formula avoids the explicit calculation of power values and depends only on the accuracy of the numerical integration of the $\\sin^3\\theta$ term.\n\n### II. Reciprocity Validation\n\n#### A. Theoretical Foundation\nThe scalar Helmholtz equation is given by $(\\nabla^2 + k^2) \\psi(\\mathbf{r}) = -f(\\mathbf{r})$, where $\\psi$ is a scalar field and $f$ is a source. The scalar Green's function, $G(\\mathbf{r}, \\mathbf{r}')$, is the solution to this equation for a point source, i.e., $f(\\mathbf{r}) = \\delta(\\mathbf{r}-\\mathbf{r}')$:\n$$ (\\nabla^2 + k^2) G(\\mathbf{r}, \\mathbf{r}') = -\\delta(\\mathbf{r} - \\mathbf{r}') $$\nFor an outgoing wave in $3$D homogeneous free space (consistent with the $e^{-i\\omega t}$ time convention), the solution is:\n$$ G(\\mathbf{r}, \\mathbf{r}') = \\frac{e^{ik|\\mathbf{r} - \\mathbf{r}'|}}{4\\pi|\\mathbf{r} - \\mathbf{r}'|} $$\nThe Lorentz reciprocity theorem, in this context, implies that the Green's function is symmetric with respect to the exchange of its source and observation point arguments:\n$$ G(\\mathbf{r}_o, \\mathbf{r}_s) = G(\\mathbf{r}_s, \\mathbf{r}_o) $$\nThis is evident from the formula, as the Euclidean distance is symmetric: $|\\mathbf{r}_o - \\mathbf{r}_s| = |\\mathbf{r}_s - \\mathbf{r}_o|$.\n\n#### B. Numerical Implementation\nThe validation requires implementing the scalar Green's function $G$ and evaluating it for pairs of source and observer positions, $(\\mathbf{r}_s, \\mathbf{r}_o)$. The wavenumber $k=2\\pi f/c$ is calculated from the given frequency $f$.\nWe compute two values:\n$1$. $G_1 = G(\\mathbf{r}_o, \\mathbf{r}_s)$\n$2$. $G_2 = G(\\mathbf{r}_s, \\mathbf{r}_o)$\nAnalytically, $G_1 = G_2$. Numerically, a straightforward implementation will also yield bit-wise identical results because the operations (vector subtraction and norm) are computationally symmetric. The check for reciprocity becomes a check for numerical equality.\nThe problem requires verifying if the values agree within a tolerance. The phrase \"when normalized by their magnitude scale\" suggests a relative comparison, which is robust for values spanning different orders of magnitude. We use a check equivalent to a relative tolerance comparison by setting a relative tolerance and a zero absolute tolerance for the comparison. Since the implemented function will produce identical results for $G_1$ and $G_2$, their difference is $0$, and the test will pass for any positive tolerance.", "answer": "```python\nimport numpy as np\nimport scipy.constants as const\n\ndef solve():\n    \"\"\"\n    Solves the validation problem for energy conservation and reciprocity.\n    \"\"\"\n    \n    # Physical Constants from SciPy\n    c = const.c  # Speed of light in vacuum (m/s)\n    mu_0 = const.mu_0  # Vacuum permeability (H/m)\n    epsilon_0 = const.epsilon_0  # Vacuum permittivity (F/m)\n    eta_0 = np.sqrt(mu_0 / epsilon_0)  # Intrinsic impedance of free space (Ohms)\n\n    # --- Energy Conservation Validation ---\n    \n    # Test cases: (f in Hz, I0 in A, L in m, rs in m, N_theta)\n    energy_test_cases = [\n        (300e6, 1.0, 0.05, 10.0, 2000),\n        (2.4e9, 0.5, 0.01, 10.0, 2000),\n        (50e6, 2.0, 0.10, 10.0, 2000),\n    ]\n\n    energy_results = []\n    for f, I0, L, rs, N_theta in energy_test_cases:\n        # The analytical value of the integral of sin^3(theta) from 0 to pi is 4/3.\n        # The relative error E = | (3/4) * I_num - 1 |, where I_num is the\n        # numerical integral. This avoids calculating the full power values.\n\n        # Numerical integration using the rectangular midpoint rule\n        delta_theta = np.pi / N_theta\n        # Midpoint theta values\n        theta_i = (np.arange(N_theta) + 0.5) * delta_theta\n        \n        # Integrand is sin^3(theta)\n        integrand_values = np.sin(theta_i)**3\n        \n        # Calculate the numerical integral\n        integral_numeric = np.sum(integrand_values) * delta_theta\n        \n        # Calculate the relative error\n        relative_error = np.abs((3.0 / 4.0) * integral_numeric - 1.0)\n        energy_results.append(relative_error)\n\n    # --- Reciprocity Validation ---\n    \n    def scalar_green_function(r_obs, r_src, k):\n        \"\"\"\n        Calculates the scalar free-space Green's function G(r_obs, r_src).\n        This uses the e^{-iwt} convention, so the spatial part is e^{ikR}.\n        \"\"\"\n        r_obs_vec = np.array(r_obs)\n        r_src_vec = np.array(r_src)\n        R = np.linalg.norm(r_obs_vec - r_src_vec)\n        \n        # Avoid division by zero, though test cases do not have r_obs = r_src.\n        if R == 0:\n            return np.inf + 0j\n        \n        return np.exp(1j * k * R) / (4 * np.pi * R)\n\n    # Test cases: (f in Hz, r_s as tuple, r_o as tuple, tolerance)\n    reciprocity_test_cases = [\n        (1.0e9, (0.0, 0.0, 0.0), (0.3, 0.4, 0.5), 1e-12),\n        (1.0e9, (1.0e-9, 0.0, 0.0), (0.0, 0.0, 0.0), 1e-12),\n        (1.0e9, (10.0, 10.0, 10.0), (-5.0, 7.0, -3.0), 1e-12),\n    ]\n\n    reciprocity_results = []\n    for f, r_s, r_o, tolerance in reciprocity_test_cases:\n        k = 2 * np.pi * f / c\n        \n        # Evaluate Green's function for G(ro, rs) and G(rs, ro)\n        G_os = scalar_green_function(r_o, r_s, k)\n        G_so = scalar_green_function(r_s, r_o, k)\n        \n        # A standard symmetric implementation ensures G_os and G_so are\n        # numerically identical, so their difference is zero. The check will pass.\n        # We use np.isclose with a relative tolerance as it is the most\n        # robust interpretation of the problem's language.\n        # atol is set to 0.0 to enforce a purely relative comparison.\n        holds = np.isclose(G_os, G_so, rtol=tolerance, atol=0.0)\n        reciprocity_results.append(holds)\n\n    # Combine results and format output\n    all_results = energy_results + reciprocity_results\n    \n    def format_result(item):\n        if isinstance(item, (bool, np.bool_)):\n            return str(item).lower()\n        return str(item)\n\n    print(f\"[{','.join(map(format_result, all_results))}]\")\n\nsolve()\n```", "id": "3312781"}]}