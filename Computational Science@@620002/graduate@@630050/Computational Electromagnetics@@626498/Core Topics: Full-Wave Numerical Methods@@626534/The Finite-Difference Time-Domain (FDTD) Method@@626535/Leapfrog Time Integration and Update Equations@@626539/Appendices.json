{"hands_on_practices": [{"introduction": "The foundation of the Finite-Difference Time-Domain (FDTD) method lies in the direct discretization of Maxwell's equations. This first practice guides you through the process of deriving the fundamental 1D leapfrog update equations for a simple transverse electromagnetic (TE) wave, starting from the continuous curl equations [@problem_id:3323528]. By applying central differences in both space and time on a staggered Yee grid, you will not only construct the update rules but also analyze their accuracy and derive the numerical dispersion relation, revealing how the discretized grid affects wave propagation.", "problem": "Consider a source-free, homogeneous, lossless medium with constant permittivity $\\varepsilon$ and permeability $\\mu$. In a one-dimensional (1D) configuration, assume the only nonzero electromagnetic field components are $E_{z}(x,t)$ and $H_{y}(x,t)$, with spatial variation only along $x$ and time dependence $t$. Start from the curl equations of Maxwell’s equations in differential form for this scenario. Discretize space with uniform spacing $\\Delta x$ and time with uniform step $\\Delta t$ on a staggered Yee lattice (Finite-Difference Time-Domain (FDTD) scheme): sample $E_{z}$ at spatial nodes $x_{i} = i\\,\\Delta x$ and integer time steps $t^{n} = n\\,\\Delta t$, and sample $H_{y}$ at staggered spatial nodes $x_{i+\\frac{1}{2}} = \\left(i+\\frac{1}{2}\\right)\\Delta x$ and half-integer time steps $t^{n+\\frac{1}{2}} = \\left(n+\\frac{1}{2}\\right)\\Delta t$, where $i\\in\\mathbb{Z}$ and $n\\in\\mathbb{Z}$.\n\nTasks:\n1) Derive from first principles the two scalar leapfrog update equations for $E_{z}$ and $H_{y}$ with their precise index staggering, using central differences in both space and time and the stated Yee placement.\n\n2) Establish the formal consistency of your discrete updates with the continuous equations by performing Taylor expansions in $\\Delta x$ and $\\Delta t$. Identify the leading-order truncation error terms and their orders in $\\Delta x$ and $\\Delta t$.\n\n3) Assume discrete plane-wave solutions of the form\n$$\nE_{z}(i,n) = E_{0}\\,\\exp\\!\\Big(j\\big(i\\,k\\,\\Delta x - n\\,\\omega\\,\\Delta t\\big)\\Big),\\qquad\nH_{y}(i+\\tfrac{1}{2},n+\\tfrac{1}{2}) = H_{0}\\,\\exp\\!\\Big(j\\big((i+\\tfrac{1}{2})\\,k\\,\\Delta x - (n+\\tfrac{1}{2})\\,\\omega\\,\\Delta t\\big)\\Big),\n$$\nwith real wavenumber $k$ and angular frequency $\\omega$. Use your discrete updates to derive the corresponding discrete dispersion relation, and then solve it explicitly for the angular frequency $\\omega$ as a closed-form analytic function of $k$, $\\Delta x$, $\\Delta t$, $\\varepsilon$, and $\\mu$. Use radians for angles.\n\nProvide, as your final answer, the single closed-form expression $\\omega(k,\\Delta x,\\Delta t,\\varepsilon,\\mu)$.", "solution": "The analysis begins with Maxwell's curl equations for a source-free ($\\vec{J} = \\vec{0}$), homogeneous, and lossless medium with constant permittivity $\\varepsilon$ and permeability $\\mu$:\n$$\n\\nabla \\times \\vec{E} = -\\frac{\\partial \\vec{B}}{\\partial t} = -\\mu \\frac{\\partial \\vec{H}}{\\partial t} \\\\\n\\nabla \\times \\vec{H} = \\frac{\\partial \\vec{D}}{\\partial t} = \\varepsilon \\frac{\\partial \\vec{E}}{\\partial t}\n$$\nGiven a one-dimensional (1D) configuration where fields vary only with the spatial coordinate $x$ and time $t$, and the only nonzero components are $E_{z}(x,t)$ and $H_{y}(x,t)$, the vector fields are $\\vec{E} = E_{z}(x,t)\\hat{z}$ and $\\vec{H} = H_{y}(x,t)\\hat{y}$. Expanding the curl operator in Cartesian coordinates yields:\n$$\n\\nabla \\times \\vec{E} = \\left(\\frac{\\partial E_z}{\\partial y} - \\frac{\\partial E_y}{\\partial z}\\right)\\hat{x} + \\left(\\frac{\\partial E_x}{\\partial z} - \\frac{\\partial E_z}{\\partial x}\\right)\\hat{y} + \\left(\\frac{\\partial E_y}{\\partial x} - \\frac{\\partial E_x}{\\partial y}\\right)\\hat{z} = -\\frac{\\partial E_{z}}{\\partial x}\\hat{y}\n$$\n$$\n\\nabla \\times \\vec{H} = \\left(\\frac{\\partial H_z}{\\partial y} - \\frac{\\partial H_y}{\\partial z}\\right)\\hat{x} + \\left(\\frac{\\partial H_x}{\\partial z} - \\frac{\\partial H_z}{\\partial x}\\right)\\hat{y} + \\left(\\frac{\\partial H_y}{\\partial x} - \\frac{\\partial H_x}{\\partial y}\\right)\\hat{z} = \\frac{\\partial H_{y}}{\\partial x}\\hat{z}\n$$\nSubstituting these into Maxwell's equations and equating vector components results in the two scalar partial differential equations (PDEs) governing this system:\n$$\n\\varepsilon \\frac{\\partial E_{z}}{\\partial t} = \\frac{\\partial H_{y}}{\\partial x} \\\\\n\\mu \\frac{\\partial H_{y}}{\\partial t} = \\frac{\\partial E_{z}}{\\partial x}\n$$\n\n**1) Derivation of Leapfrog Update Equations**\n\nWe discretize these PDEs using central differences on the specified staggered Yee lattice. The electric field $E_{z}$ is sampled at integer spatial indices $i$ and integer time indices $n$, denoted $E_{z}|_{i}^{n}$. The magnetic field $H_{y}$ is sampled at half-integer spatial indices $i+\\frac{1}{2}$ and half-integer time indices $n+\\frac{1}{2}$, denoted $H_{y}|_{i+\\frac{1}{2}}^{n+\\frac{1}{2}}$.\n\nFor the magnetic field update (from the second PDE, $\\mu \\frac{\\partial H_{y}}{\\partial t} = \\frac{\\partial E_{z}}{\\partial x}$), we apply finite differences centered at the spatiotemporal location $(x_{i+\\frac{1}{2}}, t^n)$. The time derivative of $H_y$ is centered at $t^n$ and the space derivative of $E_z$ is centered at $x_{i+\\frac{1}{2}}$:\n$$\n\\mu \\frac{H_{y}|_{i+\\frac{1}{2}}^{n+\\frac{1}{2}} - H_{y}|_{i+\\frac{1}{2}}^{n-\\frac{1}{2}}}{\\Delta t} = \\frac{E_{z}|_{i+1}^{n} - E_{z}|_{i}^{n}}{\\Delta x}\n$$\nSolving for $H_{y}|_{i+\\frac{1}{2}}^{n+\\frac{1}{2}}$ gives the magnetic field update equation:\n$$\nH_{y}|_{i+\\frac{1}{2}}^{n+\\frac{1}{2}} = H_{y}|_{i+\\frac{1}{2}}^{n-\\frac{1}{2}} + \\frac{\\Delta t}{\\mu \\Delta x} \\left( E_{z}|_{i+1}^{n} - E_{z}|_{i}^{n} \\right)\n$$\nFor the electric field update (from the first PDE, $\\varepsilon \\frac{\\partial E_{z}}{\\partial t} = \\frac{\\partial H_{y}}{\\partial x}$), we apply finite differences centered at $(x_i, t^{n+\\frac{1}{2}})$. The time derivative of $E_z$ is centered at $t^{n+\\frac{1}{2}}$ and the space derivative of $H_y$ is also centered at $t^{n+\\frac{1}{2}}$:\n$$\n\\varepsilon \\frac{E_{z}|_{i}^{n+1} - E_{z}|_{i}^{n}}{\\Delta t} = \\frac{H_{y}|_{i+\\frac{1}{2}}^{n+\\frac{1}{2}} - H_{y}|_{i-\\frac{1}{2}}^{n+\\frac{1}{2}}}{\\Delta x}\n$$\nSolving for $E_{z}|_{i}^{n+1}$ gives the electric field update equation:\n$$\nE_{z}|_{i}^{n+1} = E_{z}|_{i}^{n} + \\frac{\\Delta t}{\\varepsilon \\Delta x} \\left( H_{y}|_{i+\\frac{1}{2}}^{n+\\frac{1}{2}} - H_{y}|_{i-\\frac{1}{2}}^{n+\\frac{1}{2}} \\right)\n$$\nThese two equations form the standard 1D leapfrog time integration scheme.\n\n**2) Consistency and Truncation Error**\n\nTo establish formal consistency, we perform Taylor series expansions of the terms in the discrete equations and show that they converge to the continuous PDEs as $\\Delta x \\rightarrow 0$ and $\\Delta t \\rightarrow 0$. The leading-order terms that do not cancel constitute the truncation error.\n\nFor the $H_y$ update equation, we expand all terms around its stencil center $(x_{i+\\frac{1}{2}}, t^{n})$:\n$$\n\\mu \\frac{H_{y}|_{i+\\frac{1}{2}}^{n+\\frac{1}{2}} - H_{y}|_{i+\\frac{1}{2}}^{n-\\frac{1}{2}}}{\\Delta t} = \\mu \\left( \\frac{\\partial H_y}{\\partial t} + \\frac{\\Delta t^2}{24} \\frac{\\partial^3 H_y}{\\partial t^3} + O(\\Delta t^4) \\right)\n$$\n$$\n\\frac{E_{z}|_{i+1}^{n} - E_{z}|_{i}^{n}}{\\Delta x} = \\left( \\frac{\\partial E_z}{\\partial x} + \\frac{\\Delta x^2}{24} \\frac{\\partial^3 E_z}{\\partial x^3} + O(\\Delta x^4) \\right)\n$$\nwhere all derivatives are evaluated at $(x_{i+\\frac{1}{2}}, t^{n})$. Equating the expansions shows that the update is consistent with $\\mu \\frac{\\partial H_{y}}{\\partial t} = \\frac{\\partial E_{z}}{\\partial x}$ with a leading-order truncation error of $O(\\Delta x^2, \\Delta t^2)$.\n\nFor the $E_z$ update equation, we expand all terms around the center point $(x_i, t^{n+\\frac{1}{2}})$:\n$$\n\\varepsilon \\frac{E_{z}|_{i}^{n+1} - E_{z}|_{i}^{n}}{\\Delta t} = \\varepsilon \\left( \\frac{\\partial E_z}{\\partial t} + \\frac{\\Delta t^2}{24} \\frac{\\partial^3 E_z}{\\partial t^3} + O(\\Delta t^4) \\right)\n$$\n$$\n\\frac{H_{y}|_{i+\\frac{1}{2}}^{n+\\frac{1}{2}} - H_{y}|_{i-\\frac{1}{2}}^{n+\\frac{1}{2}}}{\\Delta x} = \\left( \\frac{\\partial H_y}{\\partial x} + \\frac{\\Delta x^2}{24} \\frac{\\partial^3 H_y}{\\partial x^3} + O(\\Delta x^4) \\right)\n$$\nwhere all derivatives are evaluated at $(x_i, t^{n+\\frac{1}{2}})$. This shows consistency with $\\varepsilon \\frac{\\partial E_{z}}{\\partial t} = \\frac{\\partial H_{y}}{\\partial x}$, also with a leading-order truncation error of $O(\\Delta x^2, \\Delta t^2)$.\n\n**3) Discrete Dispersion Relation**\n\nWe substitute the given discrete plane-wave solutions into the two standard update equations. First, using the magnetic field update:\n$H_{y}|_{i+\\frac{1}{2}}^{n+\\frac{1}{2}} - H_{y}|_{i+\\frac{1}{2}}^{n-\\frac{1}{2}} = \\frac{\\Delta t}{\\mu \\Delta x} \\left( E_{z}|_{i+1}^{n} - E_{z}|_{i}^{n} \\right)$\nSubstituting the ansatz:\n$H_0 e^{j((i+\\frac{1}{2})k\\Delta x - (n+\\frac{1}{2})\\omega\\Delta t)} - H_0 e^{j((i+\\frac{1}{2})k\\Delta x - (n-\\frac{1}{2})\\omega\\Delta t)} = \\frac{\\Delta t}{\\mu \\Delta x} \\left( E_0 e^{j((i+1)k\\Delta x - n\\omega\\Delta t)} - E_0 e^{j(ik\\Delta x - n\\omega\\Delta t)} \\right)$\nDividing by the common factor $e^{j((i+\\frac{1}{2})k\\Delta x - n\\omega\\Delta t)}$:\n$H_0(e^{-j\\omega\\Delta t/2} - e^{j\\omega\\Delta t/2}) = \\frac{\\Delta t}{\\mu\\Delta x} E_0 (e^{jk\\Delta x/2} - e^{-jk\\Delta x/2})$\nUsing Euler's identity, $\\sin(\\theta) = \\frac{e^{j\\theta}-e^{-j\\theta}}{2j}$:\n$H_0(-2j\\sin(\\frac{\\omega\\Delta t}{2})) = \\frac{\\Delta t}{\\mu\\Delta x} E_0(2j\\sin(\\frac{k\\Delta x}{2}))$\n$-H_0 \\sin\\left(\\frac{\\omega\\Delta t}{2}\\right) = \\frac{\\Delta t}{\\mu\\Delta x} E_0 \\sin\\left(\\frac{k\\Delta x}{2}\\right)$ (Eq. 1)\n\nNext, using the electric field update:\n$E_{z}|_{i}^{n+1} - E_{z}|_{i}^{n} = \\frac{\\Delta t}{\\varepsilon \\Delta x} \\left( H_{y}|_{i+\\frac{1}{2}}^{n+\\frac{1}{2}} - H_{y}|_{i-\\frac{1}{2}}^{n+\\frac{1}{2}} \\right)$\nSubstituting the ansatz:\n$E_0 e^{j(ik\\Delta x - (n+1)\\omega\\Delta t)} - E_0 e^{j(ik\\Delta x - n\\omega\\Delta t)} = \\frac{\\Delta t}{\\varepsilon \\Delta x} \\left( H_0 e^{j((i+\\frac{1}{2})k\\Delta x - (n+\\frac{1}{2})\\omega\\Delta t)} - H_0 e^{j((i-\\frac{1}{2})k\\Delta x - (n+\\frac{1}{2})\\omega\\Delta t)} \\right)$\nDividing by the common factor $e^{j(ik\\Delta x - (n+\\frac{1}{2})\\omega\\Delta t)}$:\n$E_0(e^{-j\\omega\\Delta t/2} - e^{j\\omega\\Delta t/2}) = \\frac{\\Delta t}{\\varepsilon\\Delta x} H_0 (e^{jk\\Delta x/2} - e^{-jk\\Delta x/2})$\n$-E_0(2j\\sin(\\frac{\\omega\\Delta t}{2})) = \\frac{\\Delta t}{\\varepsilon\\Delta x} H_0 (2j\\sin(\\frac{k\\Delta x}{2}))$\n$-E_0 \\sin\\left(\\frac{\\omega\\Delta t}{2}\\right) = \\frac{\\Delta t}{\\varepsilon\\Delta x} H_0 \\sin\\left(\\frac{k\\Delta x}{2}\\right)$ (Eq. 2)\n\nWe have a homogeneous linear system for $E_0$ and $H_0$:\n$$\n\\frac{\\Delta t}{\\mu\\Delta x} \\sin\\left(\\frac{k\\Delta x}{2}\\right) E_0 + \\sin\\left(\\frac{\\omega\\Delta t}{2}\\right) H_0 = 0\n$$\n$$\n\\sin\\left(\\frac{\\omega\\Delta t}{2}\\right) E_0 + \\frac{\\Delta t}{\\varepsilon\\Delta x} \\sin\\left(\\frac{k\\Delta x}{2}\\right) H_0 = 0\n$$\nFor a non-trivial solution, the determinant of the coefficient matrix must be zero:\n$$\n\\begin{vmatrix} \\frac{\\Delta t}{\\mu\\Delta x} \\sin\\left(\\frac{k\\Delta x}{2}\\right) & \\sin\\left(\\frac{\\omega\\Delta t}{2}\\right) \\\\ \\sin\\left(\\frac{\\omega\\Delta t}{2}\\right) & \\frac{\\Delta t}{\\varepsilon\\Delta x} \\sin\\left(\\frac{k\\Delta x}{2}\\right) \\end{vmatrix} = 0\n$$\nThis gives the discrete dispersion relation:\n$$\n\\frac{\\Delta t^2}{\\mu\\varepsilon\\Delta x^2} \\sin^2\\left(\\frac{k\\Delta x}{2}\\right) - \\sin^2\\left(\\frac{\\omega\\Delta t}{2}\\right) = 0\n$$\nWe solve for $\\omega$. Taking the positive root (corresponding to forward propagation):\n$$\n\\sin\\left(\\frac{\\omega\\Delta t}{2}\\right) = \\frac{\\Delta t}{\\sqrt{\\mu\\varepsilon}\\Delta x} \\sin\\left(\\frac{k\\Delta x}{2}\\right)\n$$\nIsolating $\\omega$ gives the final expression:\n$$\n\\frac{\\omega\\Delta t}{2} = \\arcsin\\left(\\frac{\\Delta t}{\\sqrt{\\mu\\varepsilon}\\Delta x} \\sin\\left(\\frac{k\\Delta x}{2}\\right)\\right)\n$$\n$$\n\\omega = \\frac{2}{\\Delta t} \\arcsin\\left(\\frac{\\Delta t}{\\sqrt{\\mu\\varepsilon}\\Delta x} \\sin\\left(\\frac{k\\Delta x}{2}\\right)\\right)\n$$", "answer": "$$\n\\boxed{\\frac{2}{\\Delta t} \\arcsin\\left(\\frac{\\Delta t}{\\sqrt{\\mu\\varepsilon}\\Delta x} \\sin\\left(\\frac{k\\Delta x}{2}\\right)\\right)}\n$$", "id": "3323528"}, {"introduction": "While the basic leapfrog scheme is ideal for lossless media, practical simulations often involve materials with conductive losses. This exercise explores how to incorporate Ohmic conduction, governed by the term $\\mathbf{J} = \\sigma \\mathbf{E}$, into the electric field update equation [@problem_id:3323462]. You will learn a powerful technique that combines an explicit update for the wave propagation term with a semi-implicit Crank-Nicolson treatment for the loss term, resulting in a robust and accurate update formula for simulating fields in conductive materials.", "problem": "Consider a homogeneous, isotropic, linear, time-invariant medium with permittivity $\\epsilon$ and electrical conductivity $\\sigma$, and assume no impressed sources. Let $\\mathbf{E}(\\mathbf{r},t)$ and $\\mathbf{H}(\\mathbf{r},t)$ denote the electric and magnetic fields, respectively. Begin from the Ampère–Maxwell law,\n$$\n\\nabla \\times \\mathbf{H} = \\mathbf{J} + \\frac{\\partial \\mathbf{D}}{\\partial t},\n$$\nwith $\\mathbf{D} = \\epsilon \\mathbf{E}$ and Ohmic conduction $\\mathbf{J} = \\sigma \\mathbf{E}$. Consider a standard staggered-in-time leapfrog discretization used in the Finite-Difference Time-Domain (FDTD) method, where $\\mathbf{E}$ is defined at integer time indices $t^{n} = n \\Delta t$ and $\\mathbf{H}$ at half-time indices $t^{n+\\tfrac{1}{2}} = \\left(n+\\tfrac{1}{2}\\right)\\Delta t$. Let $\\nabla_{h} \\times$ denote the spatial finite-difference curl operator evaluated on the appropriate staggered Yee grid.\n\nYou are to construct the discrete electric-field update over one time step from $t^{n}$ to $t^{n+1}$ by:\n- Approximating the time integral of the curl term using the midpoint (leapfrog) evaluation at $t^{n+\\tfrac{1}{2}}$, i.e., assume $\\int_{t^{n}}^{t^{n+1}} \\nabla \\times \\mathbf{H}\\, dt \\approx \\Delta t \\left(\\nabla_{h} \\times \\mathbf{H}^{n+\\tfrac{1}{2}}\\right)$.\n- Treating the conduction current $\\mathbf{J} = \\sigma \\mathbf{E}$ with the trapezoidal (Crank–Nicolson) rule over the interval $[t^{n}, t^{n+1}]$, i.e., approximate $\\int_{t^{n}}^{t^{n+1}} \\mathbf{J}\\, dt \\approx \\tfrac{\\Delta t}{2}\\sigma\\left(\\mathbf{E}^{n+1} + \\mathbf{E}^{n}\\right)$.\n- Using the fundamental relation $\\int_{t^{n}}^{t^{n+1}} \\frac{\\partial \\mathbf{D}}{\\partial t}\\, dt = \\mathbf{D}^{n+1} - \\mathbf{D}^{n} = \\epsilon\\left(\\mathbf{E}^{n+1} - \\mathbf{E}^{n}\\right)$.\n\nDerive, from first principles and these discretizations, the effective leapfrog electric-field update in the form\n$$\n\\mathbf{E}^{n+1} = \\alpha\\, \\mathbf{E}^{n} + \\beta\\, \\left(\\nabla_{h} \\times \\mathbf{H}^{n+\\tfrac{1}{2}}\\right),\n$$\nand provide closed-form analytic expressions for the scalars $\\alpha$ and $\\beta$ solely in terms of $\\sigma$, $\\epsilon$, and $\\Delta t$. Your final answer must be the expressions for $\\alpha$ and $\\beta$ written as a single row matrix using LaTeX’s $pmatrix$ environment. No numerical evaluation is required. If you choose to simplify the expressions, do so exactly; no rounding is requested or permitted.", "solution": "The derivation of the electric-field update equation commences with the point form of the Ampère–Maxwell law for a source-free region:\n$$\n\\nabla \\times \\mathbf{H} = \\mathbf{J} + \\frac{\\partial \\mathbf{D}}{\\partial t}\n$$\nIn a homogeneous, isotropic, linear, time-invariant medium, the constitutive relations are given by $\\mathbf{D} = \\epsilon \\mathbf{E}$ and Ohm's law is $\\mathbf{J} = \\sigma \\mathbf{E}$, where $\\epsilon$ is the permittivity and $\\sigma$ is the electrical conductivity. Substituting these relations into the Ampère–Maxwell law yields:\n$$\n\\nabla \\times \\mathbf{H} = \\sigma \\mathbf{E} + \\epsilon \\frac{\\partial \\mathbf{E}}{\\partial t}\n$$\nThe goal is to find an update equation for the electric field, $\\mathbf{E}^{n+1}$, at time $t^{n+1} = (n+1)\\Delta t$ based on the fields at previous time steps. This is achieved by integrating the equation over a single time step from $t^{n} = n\\Delta t$ to $t^{n+1}$:\n$$\n\\int_{t^{n}}^{t^{n+1}} (\\nabla \\times \\mathbf{H}) \\, dt = \\int_{t^{n}}^{t^{n+1}} (\\sigma \\mathbf{E}) \\, dt + \\int_{t^{n}}^{t^{n+1}} \\left(\\epsilon \\frac{\\partial \\mathbf{E}}{\\partial t}\\right) \\, dt\n$$\nWe now apply the discrete approximations specified in the problem statement to each term in this integrated equation.\n\nFor the first term, the integral of the curl of the magnetic field, we use the midpoint rule. The magnetic field $\\mathbf{H}$ is evaluated at the half-time step $t^{n+\\tfrac{1}{2}}$, and the spatial curl operator $\\nabla \\times$ is replaced by its discrete counterpart, $\\nabla_{h} \\times$:\n$$\n\\int_{t^{n}}^{t^{n+1}} (\\nabla \\times \\mathbf{H}) \\, dt \\approx \\Delta t \\left(\\nabla_{h} \\times \\mathbf{H}^{n+\\tfrac{1}{2}}\\right)\n$$\n\nFor the second term, the integral of the conduction current density $\\mathbf{J} = \\sigma \\mathbf{E}$, we apply the trapezoidal (Crank–Nicolson) rule. This rule approximates the integral by averaging the integrand at the start and end of the interval $[t^{n}, t^{n+1}]$:\n$$\n\\int_{t^{n}}^{t^{n+1}} (\\sigma \\mathbf{E}) \\, dt \\approx \\sigma \\frac{\\Delta t}{2} \\left(\\mathbf{E}^{n+1} + \\mathbf{E}^{n}\\right)\n$$\n\nFor the third term, the integral of the displacement current density, we use the Fundamental Theorem of Calculus, which is exact:\n$$\n\\int_{t^{n}}^{t^{n+1}} \\left(\\epsilon \\frac{\\partial \\mathbf{E}}{\\partial t}\\right) \\, dt = \\epsilon \\int_{t^{n}}^{t^{n+1}} \\frac{\\partial \\mathbf{E}}{\\partial t} \\, dt = \\epsilon \\left(\\mathbf{E}^{n+1} - \\mathbf{E}^{n}\\right)\n$$\nSubstituting these three discrete approximations back into the integrated Ampère–Maxwell equation gives the fully discretized form:\n$$\n\\Delta t \\left(\\nabla_{h} \\times \\mathbf{H}^{n+\\tfrac{1}{2}}\\right) = \\sigma \\frac{\\Delta t}{2} \\left(\\mathbf{E}^{n+1} + \\mathbf{E}^{n}\\right) + \\epsilon \\left(\\mathbf{E}^{n+1} - \\mathbf{E}^{n}\\right)\n$$\nOur objective is to solve this equation for $\\mathbf{E}^{n+1}$. We begin by expanding the terms on the right-hand side:\n$$\n\\Delta t \\left(\\nabla_{h} \\times \\mathbf{H}^{n+\\tfrac{1}{2}}\\right) = \\frac{\\sigma\\Delta t}{2} \\mathbf{E}^{n+1} + \\frac{\\sigma\\Delta t}{2} \\mathbf{E}^{n} + \\epsilon \\mathbf{E}^{n+1} - \\epsilon \\mathbf{E}^{n}\n$$\nNext, we group terms involving $\\mathbf{E}^{n+1}$ on one side of the equation and all other terms on the other side.\n$$\n\\Delta t \\left(\\nabla_{h} \\times \\mathbf{H}^{n+\\tfrac{1}{2}}\\right) = \\left(\\epsilon + \\frac{\\sigma\\Delta t}{2}\\right) \\mathbf{E}^{n+1} + \\left(\\frac{\\sigma\\Delta t}{2} - \\epsilon\\right) \\mathbf{E}^{n}\n$$\nRearranging to isolate the term with $\\mathbf{E}^{n+1}$:\n$$\n\\left(\\epsilon + \\frac{\\sigma\\Delta t}{2}\\right) \\mathbf{E}^{n+1} = \\left(\\epsilon - \\frac{\\sigma\\Delta t}{2}\\right) \\mathbf{E}^{n} + \\Delta t \\left(\\nabla_{h} \\times \\mathbf{H}^{n+\\tfrac{1}{2}}\\right)\n$$\nFinally, we solve for $\\mathbf{E}^{n+1}$ by dividing through by the coefficient $\\left(\\epsilon + \\frac{\\sigma\\Delta t}{2}\\right)$:\n$$\n\\mathbf{E}^{n+1} = \\frac{\\epsilon - \\frac{\\sigma\\Delta t}{2}}{\\epsilon + \\frac{\\sigma\\Delta t}{2}} \\mathbf{E}^{n} + \\frac{\\Delta t}{\\epsilon + \\frac{\\sigma\\Delta t}{2}} \\left(\\nabla_{h} \\times \\mathbf{H}^{n+\\tfrac{1}{2}}\\right)\n$$\nTo simplify the coefficients and remove the fractions in the numerator and denominator, we can multiply the numerator and denominator of each coefficient by $2$:\n$$\n\\mathbf{E}^{n+1} = \\frac{2\\epsilon - \\sigma\\Delta t}{2\\epsilon + \\sigma\\Delta t} \\mathbf{E}^{n} + \\frac{2\\Delta t}{2\\epsilon + \\sigma\\Delta t} \\left(\\nabla_{h} \\times \\mathbf{H}^{n+\\tfrac{1}{2}}\\right)\n$$\nBy comparing this result to the target form $\\mathbf{E}^{n+1} = \\alpha\\, \\mathbf{E}^{n} + \\beta\\, \\left(\\nabla_{h} \\times \\mathbf{H}^{n+\\tfrac{1}{2}}\\right)$, we can identify the expressions for the scalar coefficients $\\alpha$ and $\\beta$:\n$$\n\\alpha = \\frac{2\\epsilon - \\sigma\\Delta t}{2\\epsilon + \\sigma\\Delta t}\n$$\n$$\n\\beta = \\frac{2\\Delta t}{2\\epsilon + \\sigma\\Delta t}\n$$\nThese expressions are solely in terms of the given physical constants $\\epsilon$, $\\sigma$, and the time step size $\\Delta t$, as required.", "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{2\\epsilon - \\sigma\\Delta t}{2\\epsilon + \\sigma\\Delta t} & \\frac{2\\Delta t}{2\\epsilon + \\sigma\\Delta t} \\end{pmatrix}}\n$$", "id": "3323462"}, {"introduction": "A stable and accurate FDTD simulation requires not only correct update equations but also a judicious choice of discretization parameters. This practice shifts the focus to a critical practical question: how small must the time step $\\Delta t$ be? [@problem_id:3323457]. By analyzing the spectrum of a common source waveform—a Gaussian-modulated sinusoid—you will determine the source's effective bandwidth and apply the Nyquist sampling principle to derive the maximum allowable time step that prevents temporal aliasing, ensuring the fidelity of your simulation.", "problem": "In a one-dimensional explicit time-domain simulation of Maxwell’s equations using the leapfrog scheme (second-order central differences in time), a point source current density is driven with temporal waveform $s(t)=\\exp\\!\\big[-(t-t_{0})^{2}/\\tau^{2}\\big]\\sin(\\omega_{0} t)$, where $t_{0}$, $\\tau$, and $\\omega_{0}$ are given constants, and the spatial discretization satisfies the Courant–Friedrichs–Lewy condition independently of the time-step. You are tasked with determining a time-step that prevents temporal aliasing of the source spectrum and resolves its effective bandwidth.\n\nStarting only from Faraday’s law and Ampère–Maxwell’s law in vacuum and the definition of the leapfrog central-difference time update, derive the mapping between a continuous-time angular frequency and its discrete-time representation implied by the central-difference operator, and from this deduce the upper bound on angular frequency that can be represented without aliasing for a given time-step $\\Delta t$. Then, for the given source $s(t)$, define the highest angular frequency $\\omega_{\\max}$ that must be represented as the frequency at which the magnitude of the positive-frequency Gaussian spectral lobe has fallen to a prescribed fraction $\\varepsilon \\in (0,1)$ of its peak at $+\\omega_{0}$. Use this definition to obtain a closed-form expression for the maximum allowable time-step $\\Delta t_{\\max}$ that avoids temporal aliasing of $s(t)$ while capturing its bandwidth down to the level $\\varepsilon$.\n\nExpress your final result as a single symbolic expression for $\\Delta t_{\\max}$ in terms of $\\omega_{0}$, $\\tau$, and $\\varepsilon$. Express the answer in seconds. Do not substitute numerical values.", "solution": "This derivation proceeds in several logical steps to determine the maximum time step, $\\Delta t_{\\max}$, based on the spectral properties of the source waveform.\n\n**1. Frequency Mapping of the Leapfrog Time-Derivative Operator**\n\nThe leapfrog time integration scheme approximates the time derivative of a field component $F(t)$ at time $t=n\\Delta t$ using a second-order central difference:\n$$ \\frac{\\partial F}{\\partial t}\\bigg|_{t=n\\Delta t} \\approx \\frac{F^{n+1/2} - F^{n-1/2}}{\\Delta t} $$\nwhere $F^{k} = F(k\\Delta t)$. To find the spectral properties of this operator, we examine its action on a harmonic component, $F(t) = F_{0}\\exp(i\\omega t)$. In the discrete domain, the operator yields:\n$$ \\frac{F_{0}\\exp\\big(i\\omega(n+1/2)\\Delta t\\big) - F_{0}\\exp\\big(i\\omega(n-1/2)\\Delta t\\big)}{\\Delta t} $$\nFactoring out $F_{0}\\exp(i\\omega n\\Delta t) = F(n\\Delta t)$, we get:\n$$ F(n\\Delta t) \\frac{\\exp(i\\omega\\Delta t/2) - \\exp(-i\\omega\\Delta t/2)}{\\Delta t} = F(n\\Delta t) \\frac{2i\\sin(\\omega\\Delta t/2)}{\\Delta t} $$\nBy comparing the discrete operator's effect with the continuous operator's effect (multiplication by $i\\omega$), we can define an effective discrete-time angular frequency, $\\tilde{\\omega}$:\n$$ \\tilde{\\omega}(\\omega) = \\frac{2}{\\Delta t}\\sin\\left(\\frac{\\omega \\Delta t}{2}\\right) $$\n\n**2. The Nyquist Criterion and Temporal Aliasing**\n\nTo avoid aliasing, where distinct continuous frequencies $\\omega$ map to the same discrete frequency $\\tilde{\\omega}$, the argument of the sine function must be restricted to its principal range, $[-\\pi/2, \\pi/2]$.\n$$ \\left|\\frac{\\omega \\Delta t}{2}\\right| \\le \\frac{\\pi}{2} \\implies |\\omega| \\le \\frac{\\pi}{\\Delta t} $$\nThe highest angular frequency that can be unambiguously represented is the Nyquist frequency, $\\omega_{\\text{Nyquist}} = \\pi/\\Delta t$. For an accurate simulation, the time step $\\Delta t$ must be chosen such that all significant frequencies $\\omega$ in the source spectrum satisfy $\\omega \\le \\pi/\\Delta t$.\n\n**3. Spectrum of the Source Signal**\n\nThe source temporal waveform is $s(t)=\\exp\\!\\big[-(t-t_{0})^{2}/\\tau^{2}\\big]\\sin(\\omega_{0} t)$. We must find its Fourier transform, $S(\\omega) = \\mathcal{F}\\{s(t)\\}$, to determine its bandwidth. Using Euler's formula, the signal can be written as a sum of two modulated Gaussians. The Fourier transform of a time-shifted Gaussian $g(t-t_0)=\\exp(-(t-t_0)^2/\\tau^2)$ is $G(\\omega) = \\tau\\sqrt{\\pi} \\exp(-i\\omega t_0) \\exp(-\\tau^2\\omega^2/4)$. Using the frequency-shifting property of the Fourier transform, the spectrum $S(\\omega)$ consists of two lobes centered at $\\pm\\omega_0$. The magnitude of the positive-frequency lobe is determined by the magnitude of $G(\\omega-\\omega_0)$:\n$$ |G(\\omega-\\omega_0)| = \\tau\\sqrt{\\pi} \\exp\\left(-\\frac{\\tau^2(\\omega-\\omega_0)^2}{4}\\right) $$\nThis lobe has a Gaussian shape centered at $\\omega=\\omega_0$.\n\n**4. Determining the Effective Maximum Frequency $\\omega_{\\max}$**\n\nThe problem defines $\\omega_{\\max}$ as the frequency where the magnitude of the positive-frequency lobe has decreased to a fraction $\\varepsilon$ of its peak value. The peak occurs at $\\omega = \\omega_0$, where the exponential term is 1. We must find $\\omega_{\\max}$ such that the magnitude at that frequency equals $\\varepsilon$ times the peak magnitude.\n$$ \\tau\\sqrt{\\pi} \\exp\\left(-\\frac{\\tau^2(\\omega_{\\max}-\\omega_0)^2}{4}\\right) = \\varepsilon \\left(\\tau\\sqrt{\\pi}\\right) $$\n$$ \\exp\\left(-\\frac{\\tau^2(\\omega_{\\max}-\\omega_0)^2}{4}\\right) = \\varepsilon $$\nTaking the natural logarithm of both sides:\n$$ -\\frac{\\tau^2(\\omega_{\\max}-\\omega_0)^2}{4} = \\ln(\\varepsilon) $$\nSince $\\varepsilon \\in (0,1)$, $\\ln(\\varepsilon)$ is negative. We can write $\\ln(\\varepsilon) = -\\ln(1/\\varepsilon)$.\n$$ \\frac{\\tau^2(\\omega_{\\max}-\\omega_0)^2}{4} = \\ln\\left(\\frac{1}{\\varepsilon}\\right) $$\nSolving for $(\\omega_{\\max}-\\omega_0)$:\n$$ (\\omega_{\\max}-\\omega_0)^2 = \\frac{4}{\\tau^2}\\ln\\left(\\frac{1}{\\varepsilon}\\right) $$\nWe take the positive root because we are interested in the frequency $\\omega_{\\max} > \\omega_0$ that defines the upper edge of the bandwidth.\n$$ \\omega_{\\max}-\\omega_0 = \\frac{2}{\\tau}\\sqrt{\\ln\\left(\\frac{1}{\\varepsilon}\\right)} $$\n$$ \\omega_{\\max} = \\omega_{0} + \\frac{2}{\\tau}\\sqrt{\\ln\\left(\\frac{1}{\\varepsilon}\\right)} $$\n\n**5. Deriving the Maximum Allowable Time Step $\\Delta t_{\\max}$**\n\nTo prevent aliasing, the effective highest frequency, $\\omega_{\\max}$, must be less than or equal to the Nyquist frequency. The maximum allowable time step, $\\Delta t_{\\max}$, corresponds to the equality:\n$$ \\omega_{\\max} = \\frac{\\pi}{\\Delta t_{\\max}} $$\nSubstituting our expression for $\\omega_{\\max}$:\n$$ \\omega_{0} + \\frac{2}{\\tau}\\sqrt{\\ln\\left(\\frac{1}{\\varepsilon}\\right)} = \\frac{\\pi}{\\Delta t_{\\max}} $$\nFinally, solving for $\\Delta t_{\\max}$ gives the desired closed-form expression:\n$$ \\Delta t_{\\max} = \\frac{\\pi}{\\omega_{0} + \\frac{2}{\\tau}\\sqrt{\\ln\\left(\\frac{1}{\\varepsilon}\\right)}} $$\nThis is the maximum time-step that ensures the source's spectral content up to the $\\varepsilon$-bandwidth point is represented without aliasing.", "answer": "$$\n\\boxed{\\frac{\\pi}{\\omega_{0} + \\frac{2}{\\tau}\\sqrt{\\ln\\left(\\frac{1}{\\varepsilon}\\right)}}}\n$$", "id": "3323457"}]}