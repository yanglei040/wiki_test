{"hands_on_practices": [{"introduction": "This problem addresses a fundamental aspect of any time-domain simulation: the initial state. For a dispersive medium modeled by Auxiliary Differential Equations (ADEs), we must ensure that the initial values of both the electromagnetic fields and the auxiliary material state variables are consistent with physical principles like causality and the system's quiescent state. This exercise guides you through reasoning from Maxwell's equations to establish the only physically valid initial conditions, a crucial first step for a stable and accurate simulation [@problem_id:3289844].", "problem": "A three-dimensional Finite-Difference Time-Domain (FDTD) simulation is to be initialized in a linear, passive, causal dispersive medium whose electric response is implemented using the Auxiliary Differential Equation (ADE) method. The electromagnetic field is initially quiescent, with $\\mathbf{E}(\\mathbf{r},0)=\\mathbf{0}$ and $\\mathbf{H}(\\mathbf{r},0)=\\mathbf{0}$. There are no free charges or currents at $t=0$, so $\\rho_{\\mathrm{f}}(\\mathbf{r},0)=0$ and $\\mathbf{J}_{\\mathrm{f}}(\\mathbf{r},0)=\\mathbf{0}$. The electric flux density satisfies $\\mathbf{D}=\\epsilon_0 \\mathbf{E}+\\mathbf{P}$, where $\\mathbf{P}$ is the polarization vector, and the polarization current density is $\\mathbf{J}_{\\mathrm{p}}=\\dot{\\mathbf{P}}$. The ADE representation of dispersion consists of a set of stable linear ordinary differential equations for internal material states that produce $\\mathbf{P}$ when driven by $\\mathbf{E}$, and is integrated in time with the same leapfrog staggering used for the Yee field update, with $\\mathbf{E}$ at integer times $t^n=n\\Delta t$ and $\\mathbf{H}$ at half-integer times $t^{n+\\frac{1}{2}}$.\n\nStarting from the macroscopic Maxwell equations in differential form,\n$$\n\\nabla\\times\\mathbf{H}=\\mathbf{J}_{\\mathrm{f}}+\\frac{\\partial \\mathbf{D}}{\\partial t},\\quad\n\\nabla\\cdot\\mathbf{D}=\\rho_{\\mathrm{f}},\\quad\n\\nabla\\times\\mathbf{E}=-\\frac{\\partial \\mathbf{B}}{\\partial t},\\quad\n\\nabla\\cdot\\mathbf{B}=0,\n$$\nwith $\\mathbf{D}=\\epsilon_0\\mathbf{E}+\\mathbf{P}$ and $\\mathbf{J}_{\\mathrm{p}}=\\dot{\\mathbf{P}}$, and assuming the ADE internal dynamics correspond to a passive stable equilibrium when $\\mathbf{E}=\\mathbf{0}$, determine which of the following prescriptions yields consistent initial conditions for the ADE variables $\\mathbf{P}$ and $\\dot{\\mathbf{P}}$ that do not violate Maxwell’s equations or the material’s state equations when the simulation starts from $\\mathbf{E}=\\mathbf{H}=\\mathbf{0}$.\n\nA. Set $\\mathbf{P}(\\mathbf{r},0)=\\mathbf{0}$ and $\\dot{\\mathbf{P}}(\\mathbf{r},0)=\\mathbf{0}$ everywhere. For any first-order ADE internal state variables $\\mathbf{q}_m$ associated with dispersive poles, initialize $\\mathbf{q}_m$ to the equilibrium value corresponding to $\\mathbf{E}(\\mathbf{r},0)=\\mathbf{0}$, which is $\\mathbf{q}_m(\\mathbf{r},0)=\\mathbf{0}$ in a linear passive medium.\n\nB. Pre-load the material with “static” polarization by setting $\\mathbf{P}(\\mathbf{r},0)$ equal to the zero-frequency susceptibility response and enforce damping by taking $\\dot{\\mathbf{P}}(\\mathbf{r},0)=-\\gamma\\,\\mathbf{P}(\\mathbf{r},0)\\neq\\mathbf{0}$, even though $\\mathbf{E}(\\mathbf{r},0)=\\mathbf{0}$, so that relaxation begins immediately.\n\nC. Choose any nonzero divergence-free polarization field, $\\nabla\\cdot\\mathbf{P}(\\mathbf{r},0)=0$ with $\\mathbf{P}(\\mathbf{r},0)\\not\\equiv\\mathbf{0}$, and set $\\dot{\\mathbf{P}}(\\mathbf{r},0)=\\mathbf{0}$. This guarantees $\\nabla\\cdot\\mathbf{D}(\\mathbf{r},0)=0$ without introducing initial polarization current.\n\nD. Respect the Yee time staggering by setting $\\mathbf{E}^0(\\mathbf{r})=\\mathbf{0}$ and $\\mathbf{H}^{-1/2}(\\mathbf{r})=\\mathbf{0}$, and choose $\\mathbf{P}^0(\\mathbf{r})=\\mathbf{0}$ and the polarization current $\\mathbf{J}_{\\mathrm{p}}^{1/2}(\\mathbf{r})=\\dot{\\mathbf{P}}^{1/2}(\\mathbf{r})=\\mathbf{0}$. Initialize any ADE first-order internal states at their equilibrium values given $\\mathbf{E}^0(\\mathbf{r})=\\mathbf{0}$, which is $\\mathbf{0}$ in a linear passive medium.\n\nSelect all options that are correct.", "solution": "The problem asks for consistent initial conditions for the state variables of a dispersive medium, described by the Auxiliary Differential Equation (ADE) method, within a Finite-Difference Time-Domain (FDTD) simulation. The simulation starts from an \"initially quiescent\" state, meaning the electromagnetic fields are zero at time $t=0$, and there are no free charges or currents.\n\nThe validation of the problem statement is performed first.\n\n**Step 1: Extract Givens**\n- Simulation: Three-dimensional FDTD.\n- Medium: Linear, passive, causal, dispersive.\n- Method: Auxiliary Differential Equation (ADE).\n- Initial EM Fields: $\\mathbf{E}(\\mathbf{r},0)=\\mathbf{0}$, $\\mathbf{H}(\\mathbf{r},0)=\\mathbf{0}$.\n- Initial Free Sources: $\\rho_{\\mathrm{f}}(\\mathbf{r},0)=0$, $\\mathbf{J}_{\\mathrm{f}}(\\mathbf{r},0)=\\mathbf{0}$.\n- Constitutive Relation: $\\mathbf{D}=\\epsilon_0 \\mathbf{E}+\\mathbf{P}$.\n- Polarization Current: $\\mathbf{J}_{\\mathrm{p}}=\\dot{\\mathbf{P}}$.\n- ADE Dynamics: Stable linear ODEs for internal states, producing $\\mathbf{P}$ from driver $\\mathbf{E}$. Corresponds to a passive stable equilibrium when $\\mathbf{E}=\\mathbf{0}$.\n- Yee Time Staggering: $\\mathbf{E}$ at integer times $t^n=n\\Delta t$, $\\mathbf{H}$ at half-integer times $t^{n+\\frac{1}{2}}$.\n- Governing Equations: Macroscopic Maxwell's equations.\n$$\n\\nabla\\times\\mathbf{H}=\\mathbf{J}_{\\mathrm{f}}+\\frac{\\partial \\mathbf{D}}{\\partial t} \\quad (1)\n$$\n$$\n\\nabla\\cdot\\mathbf{D}=\\rho_{\\mathrm{f}} \\quad (2)\n$$\n$$\n\\nabla\\times\\mathbf{E}=-\\frac{\\partial \\mathbf{B}}{\\partial t} \\quad (3)\n$$\n$$\n\\nabla\\cdot\\mathbf{B}=0 \\quad (4)\n$$\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is scientifically well-grounded, representing a standard scenario in computational electromagnetics. The concepts of linear, passive, causal dispersive media, the FDTD method, the ADE formulation, Maxwell's equations, and quiescent initial conditions are all standard and well-defined in physics and engineering. The problem is self-contained and presents no internal contradictions. The data provided are sufficient to determine the consistency of the proposed initial conditions. The language is objective and precise. The problem is therefore valid.\n\n**Step 3: Verdict and Action**\nThe problem is valid. We proceed to the solution.\n\n**Derivation of Consistent Initial Conditions**\n\nThe core principle is that the initial conditions for the material state variables ($\\mathbf{P}$, $\\dot{\\mathbf{P}}$, and any internal ADE states) must be consistent with both Maxwell's equations and the constitutive nature of the medium at the initial time $t=0$.\n\n1.  **Implications of a Linear, Passive, Causal Medium:**\n    The medium is specified as causal. Causality dictates that the response of a system cannot precede its cause. Here, the electric field $\\mathbf{E}$ is the cause (or driver), and the polarization $\\mathbf{P}$ is the effect (or response). The problem states the system is \"initially quiescent\" with $\\mathbf{E}(\\mathbf{r},0)=\\mathbf{0}$. This implies that for all times $t \\le 0$, the electric field has been zero. In a causal system, if $\\mathbf{E}(\\mathbf{r},t)=\\mathbf{0}$ for all $t \\le 0$, then the polarization must also be zero, $\\mathbf{P}(\\mathbf{r},t)=\\mathbf{0}$, for all $t \\le 0$. This leads to two direct conclusions:\n    -   The initial polarization must be zero: $\\mathbf{P}(\\mathbf{r},0)=\\mathbf{0}$.\n    -   The initial time derivative of polarization must also be zero: $\\dot{\\mathbf{P}}(\\mathbf{r},0) = \\frac{\\partial\\mathbf{P}}{\\partial t}\\Big|_{t=0} = \\mathbf{0}$.\n\n2.  **Implications of a Stable Equilibrium:**\n    The problem states that the ADE dynamics have a \"passive stable equilibrium when $\\mathbf{E}=\\mathbf{0}$.\" For a linear system, this unique stable equilibrium point is the zero state. Since the driving field is $\\mathbf{E}(\\mathbf{r},0)=\\mathbf{0}$, the material must be at this equilibrium. This confirms that not only must $\\mathbf{P}(\\mathbf{r},0)=\\mathbf{0}$, but any internal state variables of the ADE model, let us call them $\\mathbf{q}_m$, must also be at their equilibrium values, which are $\\mathbf{q}_m(\\mathbf{r},0)=\\mathbf{0}$.\n\n3.  **Consistency with Maxwell's Equations at $t=0$:**\n    Let us verify that these conditions are consistent with Maxwell's equations at $t=0$, given the initial fields and sources.\n    -   **Gauss's Law for $\\mathbf{D}$ (Eq. 2):** We must satisfy $\\nabla\\cdot\\mathbf{D}(\\mathbf{r},0) = \\rho_{\\mathrm{f}}(\\mathbf{r},0)$.\n        With $\\rho_{\\mathrm{f}}(\\mathbf{r},0)=0$, this requires $\\nabla\\cdot\\mathbf{D}(\\mathbf{r},0)=0$.\n        Substituting the constitutive relation: $\\nabla\\cdot(\\epsilon_0 \\mathbf{E}(\\mathbf{r},0) + \\mathbf{P}(\\mathbf{r},0))=0$.\n        Using the given $\\mathbf{E}(\\mathbf{r},0)=\\mathbf{0}$ and our derived $\\mathbf{P}(\\mathbf{r},0)=\\mathbf{0}$, we have $\\nabla\\cdot(\\mathbf{0}+\\mathbf{0})=0$, which is satisfied.\n\n    -   **Ampere's Law (Eq. 1):** We must satisfy $\\nabla\\times\\mathbf{H}(\\mathbf{r},0) = \\mathbf{J}_{\\mathrm{f}}(\\mathbf{r},0) + \\frac{\\partial \\mathbf{D}}{\\partial t}\\Big|_{t=0}$.\n        With $\\mathbf{H}(\\mathbf{r},0)=\\mathbf{0}$ and $\\mathbf{J}_{\\mathrm{f}}(\\mathbf{r},0)=\\mathbf{0}$, this requires $\\frac{\\partial \\mathbf{D}}{\\partial t}\\Big|_{t=0} = \\mathbf{0}$.\n        Expanding the time derivative of $\\mathbf{D}$: $\\frac{\\partial}{\\partial t}(\\epsilon_0 \\mathbf{E} + \\mathbf{P})\\Big|_{t=0} = \\epsilon_0 \\dot{\\mathbf{E}}(\\mathbf{r},0) + \\dot{\\mathbf{P}}(\\mathbf{r},0) = \\mathbf{0}$.\n        Our derived condition $\\dot{\\mathbf{P}}(\\mathbf{r},0)=\\mathbf{0}$ makes this equation simplify to $\\epsilon_0 \\dot{\\mathbf{E}}(\\mathbf{r},0) = \\mathbf{0}$, or $\\dot{\\mathbf{E}}(\\mathbf{r},0)=\\mathbf{0}$. This condition is self-consistent; in the absence of any driving sources that turn on at $t=0$, the fields should indeed have a zero initial time derivative and remain zero.\n\nThe only consistent set of initial conditions for a quiescent, linear, passive, and causal dispersive medium is that all field and material state variables are zero.\n\n**Option-by-Option Analysis**\n\nA. **Set $\\mathbf{P}(\\mathbf{r},0)=\\mathbf{0}$ and $\\dot{\\mathbf{P}}(\\mathbf{r},0)=\\mathbf{0}$ everywhere. For any first-order ADE internal state variables $\\mathbf{q}_m$ associated with dispersive poles, initialize $\\mathbf{q}_m$ to the equilibrium value corresponding to $\\mathbf{E}(\\mathbf{r},0)=\\mathbf{0}$, which is $\\mathbf{q}_m(\\mathbf{r},0)=\\mathbf{0}$ in a linear passive medium.**\nThis statement is a direct and precise consequence of our derivation from first principles. It correctly identifies that in a linear, causal, passive system starting from a quiescent state ($\\mathbf{E}=\\mathbf{0}, \\mathbf{H}=\\mathbf{0}$), all internal material states must also be at their zero equilibrium. This includes the polarization $\\mathbf{P}$, its time derivative $\\dot{\\mathbf{P}}$, and any underlying ADE state variables $\\mathbf{q}_m$. As shown above, this set of conditions is fully consistent with Maxwell's equations.\nVerdict: **Correct**.\n\nB. **Pre-load the material with “static” polarization by setting $\\mathbf{P}(\\mathbf{r},0)$ equal to the zero-frequency susceptibility response and enforce damping by taking $\\dot{\\mathbf{P}}(\\mathbf{r},0)=-\\gamma\\,\\mathbf{P}(\\mathbf{r},0)\\neq\\mathbf{0}$, even though $\\mathbf{E}(\\mathbf{r},0)=\\mathbf{0}$, so that relaxation begins immediately.**\nThis prescription violates the fundamental assumptions. Setting $\\mathbf{P}(\\mathbf{r},0)\\neq\\mathbf{0}$ contradicts the \"initially quiescent\" condition for a causal medium where $\\mathbf{E}(t)=\\mathbf{0}$ for $t\\le 0$. Such an initial state represents a medium with stored potential energy, which is not a quiescent state. This describes preparing the system in an excited state and observing its relaxation, which is a different physical problem.\nVerdict: **Incorrect**.\n\nC. **Choose any nonzero divergence-free polarization field, $\\nabla\\cdot\\mathbf{P}(\\mathbf{r},0)=0$ with $\\mathbf{P}(\\mathbf{r},0)\\not\\equiv\\mathbf{0}$, and set $\\dot{\\mathbf{P}}(\\mathbf{r},0)=\\mathbf{0}$. This guarantees $\\nabla\\cdot\\mathbf{D}(\\mathbf{r},0)=0$ without introducing initial polarization current.**\nThis option contains multiple inconsistencies. First, like option B, it proposes $\\mathbf{P}(\\mathbf{r},0)\\neq\\mathbf{0}$, which violates the quiescent and causal nature of the system. Second, it suggests setting $\\dot{\\mathbf{P}}(\\mathbf{r},0)=\\mathbf{0}$ while the material is in a non-equilibrium state ($\\mathbf{P}\\neq\\mathbf{0}$ while the equilibrium value for $\\mathbf{E}=\\mathbf{0}$ is $\\mathbf{P}=\\mathbf{0}$). A passive system in a non-equilibrium state will inherently begin to relax toward equilibrium, a process which implies $\\dot{\\mathbf{P}}\\neq\\mathbf{0}$. For a typical linear passive model (e.g., Debye), having $\\mathbf{P}\\neq\\mathbf{0}$ and $\\mathbf{E}=\\mathbf{0}$ forces $\\dot{\\mathbf{P}}\\neq\\mathbf{0}$. Therefore, setting both $\\mathbf{P}\\neq\\mathbf{0}$ and $\\dot{\\mathbf{P}}=\\mathbf{0}$ is inconsistent with the material's own state equations.\nVerdict: **Incorrect**.\n\nD. **Respect the Yee time staggering by setting $\\mathbf{E}^0(\\mathbf{r})=\\mathbf{0}$ and $\\mathbf{H}^{-1/2}(\\mathbf{r})=\\mathbf{0}$, and choose $\\mathbf{P}^0(\\mathbf{r})=\\mathbf{0}$ and the polarization current $\\mathbf{J}_{\\mathrm{p}}^{1/2}(\\mathbf{r})=\\dot{\\mathbf{P}}^{1/2}(\\mathbf{r})=\\mathbf{0}$. Initialize any ADE first-order internal states at their equilibrium values given $\\mathbf{E}^0(\\mathbf{r})=\\mathbf{0}$, which is $\\mathbf{0}$ in a linear passive medium.**\nThis option presents the same physical principles as option A but translated into the specific notation of the Yee FDTD algorithm.\n-   $\\mathbf{E}^0(\\mathbf{r})=\\mathbf{0}$ is the discrete form of $\\mathbf{E}(\\mathbf{r},0)=\\mathbf{0}$.\n-   $\\mathbf{H}^{-1/2}(\\mathbf{r})=\\mathbf{0}$ is the standard initialization for the magnetic field at the first half-time step in a leapfrog scheme to represent $\\mathbf{H}(\\mathbf{r},0)=\\mathbf{0}$.\n-   $\\mathbf{P}^0(\\mathbf{r})=\\mathbf{0}$ and initializing ADE states to $\\mathbf{0}$ are the discrete versions of setting the initial material state to its zero equilibrium, consistent with $\\mathbf{E}^0=\\mathbf{0}$.\n-   $\\mathbf{J}_{\\mathrm{p}}^{1/2}(\\mathbf{r})=\\mathbf{0}$ specifies that the polarization current at the first half-time step is zero. This is a necessary consequence of the other initial conditions. Since the system starts at equilibrium ($\\mathbf{E}^0=\\mathbf{0}$, $\\mathbf{P}^0=\\mathbf{0}$, ADE states are $\\mathbf{0}$), there is no driver to induce a polarization current in the first time interval.\nThis option provides a complete and correct prescription for initializing the FDTD simulation in discrete time and space, fully consistent with the continuous-time physics.\nVerdict: **Correct**.", "answer": "$$\\boxed{AD}$$", "id": "3289844"}, {"introduction": "A stable numerical simulation requires a careful choice of the time step, $\\Delta t$. In FDTD simulations of dispersive media, stability is governed not only by the electromagnetic Courant–Friedrichs–Lewy (CFL) condition but also by constraints arising from the material's own dynamics. This practice [@problem_id:3289828] challenges you to derive the stability limit imposed by the ADE for a multi-pole Lorentz model and combine it with the CFL limit, a task central to practical FDTD modeling.", "problem": "You are asked to formalize and compute the discrete-time stability constraint for a dispersive material modeled by multiple Lorentz oscillators when these poles are closely spaced near a target band. The context is Finite-Difference Time-Domain (FDTD, Finite-Difference Time-Domain) computational electromagnetics combined with Auxiliary Differential Equation (ADE, Auxiliary Differential Equation) methods for dispersion. The core goal is to derive, from first principles, the stability constraint for the ADE material subsystem and its interaction with the electromagnetic Courant–Friedrichs–Lewy (CFL, Courant–Friedrichs–Lewy) constraint, and then implement it numerically.\n\nStart from the following fundamental base, and derive the discrete-time stability constraint:\n- Maxwell’s equations in a linear dispersive medium modeled by the Lorentz polarization:\n$$\n\\nabla \\times \\mathbf{E} = -\\mu_0 \\frac{\\partial \\mathbf{H}}{\\partial t}, \\quad \\nabla \\times \\mathbf{H} = \\frac{\\partial \\mathbf{D}}{\\partial t},\n$$\nwith\n$$\n\\mathbf{D}(t) = \\epsilon_0 \\epsilon_{\\infty} \\mathbf{E}(t) + \\mathbf{P}(t), \\quad \\mathbf{P}(t) = \\sum_{j=1}^{N_p} \\mathbf{P}_j(t),\n$$\nand for each Lorentz pole $j$,\n$$\n\\frac{d^2 \\mathbf{P}_j}{dt^2} + \\gamma_j \\frac{d \\mathbf{P}_j}{dt} + \\omega_j^2 \\mathbf{P}_j = \\epsilon_0 \\Delta \\epsilon_j \\omega_j^2 \\mathbf{E}(t),\n$$\nwhere $\\epsilon_0$ is the vacuum permittivity, $\\mu_0$ is the vacuum permeability, $\\epsilon_{\\infty}$ is the high-frequency permittivity, $\\Delta \\epsilon_j$ is the strength of pole $j$, $\\gamma_j$ is its damping coefficient in $\\mathrm{s}^{-1}$, and $\\omega_j$ is its angular resonance frequency in $\\mathrm{rad/s}$.\n\nYou must discretize the Lorentz pole ordinary differential equation using an explicit second-order central-difference scheme consistent with the standard leapfrog FDTD time stepping, and determine the condition on the discrete time step $\\Delta t$ under which the homogeneous part of the discrete ADE update is stable. Stability must be assessed by linear discrete-time root location (for example, Jury stability conditions for second-order real polynomials). Then, for multiple poles, determine how clustering of poles near a target angular band frequency influences the selection of $\\Delta t$, and explain its interaction with the electromagnetic CFL constraint for the three-dimensional Yee scheme.\n\nFor the three-dimensional Yee grid, the CFL constraint is based on the speed of light in vacuum $c$ where $c = \\frac{1}{\\sqrt{\\mu_0 \\epsilon_0}} = 299792458\\,\\mathrm{m/s}$. The CFL bound for the time step in three dimensions with spatial steps $\\Delta x$, $\\Delta y$, and $\\Delta z$ is\n$$\n\\Delta t_{\\mathrm{EM}} \\le \\frac{1}{c \\sqrt{\\frac{1}{\\Delta x^2} + \\frac{1}{\\Delta y^2} + \\frac{1}{\\Delta z^2}}}.\n$$\nThe combined requirement is that the actual time step $\\Delta t$ must satisfy both the ADE material stability constraint and the electromagnetic CFL constraint. You must compute the maximum stable $\\Delta t$ as\n$$\n\\Delta t_{\\max} = \\min\\left(\\Delta t_{\\mathrm{material}}, \\Delta t_{\\mathrm{EM}}\\right),\n$$\nwhere $\\Delta t_{\\mathrm{material}}$ is the largest time step that keeps the discrete ADE subsystem for all poles $j$ stable.\n\nYour program must implement the derived constraints and compute $\\Delta t_{\\max}$ for each of the following test cases. All physical quantities must be handled in International System of Units, and the results must be expressed in seconds. The angle unit is radians for angular frequencies. Your program must produce a single line of output containing the results as a comma-separated list enclosed in square brackets, like $[\\Delta t_1, \\Delta t_2, \\Delta t_3]$. Each result must be a floating-point number in seconds.\n\nTest Suite:\n- Case $1$ (closely spaced cluster near a terahertz band, electromagnetic CFL non-limiting):\n  - Poles: three Lorentz poles with angular frequencies $\\omega_j = 2\\pi f_j$ where $f_1 = 1.00\\times 10^{12}\\,\\mathrm{Hz}$, $f_2 = 1.02\\times 10^{12}\\,\\mathrm{Hz}$, $f_3 = 0.98\\times 10^{12}\\,\\mathrm{Hz}$; damping coefficients $\\gamma_1 = 5.0\\times 10^{10}\\,\\mathrm{s}^{-1}$, $\\gamma_2 = 5.0\\times 10^{10}\\,\\mathrm{s}^{-1}$, $\\gamma_3 = 5.0\\times 10^{10}\\,\\mathrm{s}^{-1}$.\n  - Grid: $\\Delta x = 10^{-3}\\,\\mathrm{m}$, $\\Delta y = 10^{-3}\\,\\mathrm{m}$, $\\Delta z = 10^{-3}\\,\\mathrm{m}$.\n- Case $2$ (cluster near a gigahertz band, electromagnetic CFL highly limiting due to fine grid):\n  - Poles: three Lorentz poles with angular frequencies $\\omega_j = 2\\pi f_j$ where $f_1 = 1.00\\times 10^{9}\\,\\mathrm{Hz}$, $f_2 = 1.05\\times 10^{9}\\,\\mathrm{Hz}$, $f_3 = 0.95\\times 10^{9}\\,\\mathrm{Hz}$; damping coefficients $\\gamma_1 = 1.0\\times 10^{8}\\,\\mathrm{s}^{-1}$, $\\gamma_2 = 5.0\\times 10^{8}\\,\\mathrm{s}^{-1}$, $\\gamma_3 = 2.0\\times 10^{8}\\,\\mathrm{s}^{-1}$.\n  - Grid: $\\Delta x = 10^{-6}\\,\\mathrm{m}$, $\\Delta y = 10^{-6}\\,\\mathrm{m}$, $\\Delta z = 10^{-6}\\,\\mathrm{m}$.\n- Case $3$ (closely spaced cluster near a multi-terahertz band with high damping, electromagnetic CFL non-limiting due to coarse grid):\n  - Poles: three Lorentz poles with angular frequencies $\\omega_j = 2\\pi f_j$ where $f_1 = 3.00\\times 10^{12}\\,\\mathrm{Hz}$, $f_2 = 3.10\\times 10^{12}\\,\\mathrm{Hz}$, $f_3 = 2.90\\times 10^{12}\\,\\mathrm{Hz}$; damping coefficients $\\gamma_1 = 1.0\\times 10^{13}\\,\\mathrm{s}^{-1}$, $\\gamma_2 = 1.0\\times 10^{12}\\,\\mathrm{s}^{-1}$, $\\gamma_3 = 5.0\\times 10^{12}\\,\\mathrm{s}^{-1}$.\n  - Grid: $\\Delta x = 10^{-2}\\,\\mathrm{m}$, $\\Delta y = 10^{-2}\\,\\mathrm{m}$, $\\Delta z = 10^{-2}\\,\\mathrm{m}$.\n\nYour program should output a single line with the three computed maximum stable time steps in seconds as a comma-separated list enclosed in square brackets, in the order of the cases given above, for example $[v_1,v_2,v_3]$. No additional text should be printed. The outputs must be floating-point numbers.", "solution": "The problem is valid as it is scientifically grounded in classical electromagnetism and numerical analysis, is well-posed, and all necessary parameters for the derivation and computation are provided. The analysis focuses on the stability of the homogeneous part of the Auxiliary Differential Equation (ADE), for which the provided parameters $\\omega_j$ and $\\gamma_j$ are sufficient.\n\nThe objective is to derive the discrete-time stability constraint for a multi-pole Lorentz dispersive material model used in the Finite-Difference Time-Domain (FDTD) method. This requires analyzing the discretization of the governing Ordinary Differential Equation (ODE) for the material polarization.\n\nLet us consider the homogeneous part of the Lorentz model for a single polarization component $\\mathbf{P}_j(t)$, which we can analyze as a scalar equation for clarity, dropping the vector and pole index notation temporarily:\n$$\n\\frac{d^2 P}{dt^2} + \\gamma \\frac{d P}{dt} + \\omega^2 P = 0\n$$\nThis is a second-order linear homogeneous ODE. The problem specifies discretization using an explicit second-order central-difference scheme. We discretize time as $t = n\\Delta t$, and let $P^n$ denote $P(n\\Delta t)$. The central-difference approximations for the derivatives at time $t=n\\Delta t$ are:\n$$\n\\frac{d^2 P}{dt^2} \\bigg|_{n\\Delta t} \\approx \\frac{P^{n+1} - 2P^n + P^{n-1}}{(\\Delta t)^2}\n$$\n$$\n\\frac{d P}{dt} \\bigg|_{n\\Delta t} \\approx \\frac{P^{n+1} - P^{n-1}}{2\\Delta t}\n$$\nSubstituting these expressions into the homogeneous ODE yields the discrete-time equation:\n$$\n\\frac{P^{n+1} - 2P^n + P^{n-1}}{(\\Delta t)^2} + \\gamma \\left( \\frac{P^{n+1} - P^{n-1}}{2\\Delta t} \\right) + \\omega^2 P^n = 0\n$$\nTo analyze the stability of this linear recurrence relation, we rearrange the terms by their time-step index ($n+1$, $n$, $n-1$):\n$$\nP^{n+1} \\left( \\frac{1}{(\\Delta t)^2} + \\frac{\\gamma}{2\\Delta t} \\right) + P^n \\left( \\omega^2 - \\frac{2}{(\\Delta t)^2} \\right) + P^{n-1} \\left( \\frac{1}{(\\Delta t)^2} - \\frac{\\gamma}{2\\Delta t} \\right) = 0\n$$\nMultiplying through by $(\\Delta t)^2$, we obtain a more convenient form:\n$$\n\\left( 1 + \\frac{\\gamma \\Delta t}{2} \\right) P^{n+1} + \\left( (\\omega \\Delta t)^2 - 2 \\right) P^n + \\left( 1 - \\frac{\\gamma \\Delta t}{2} \\right) P^{n-1} = 0\n$$\nThis is a linear homogeneous difference equation. Its stability is determined by the roots of its characteristic polynomial. Assuming a solution of the form $P^n = z^n$ for some complex number $z$, we substitute it into the equation:\n$$\n\\left( 1 + \\frac{\\gamma \\Delta t}{2} \\right) z^2 + \\left( (\\omega \\Delta t)^2 - 2 \\right) z + \\left( 1 - \\frac{\\gamma \\Delta t}{2} \\right) = 0\n$$\nThis is a quadratic polynomial of the form $az^2 + bz + c = 0$, where:\n$a = 1 + \\frac{\\gamma \\Delta t}{2}$\n$b = (\\omega \\Delta t)^2 - 2$\n$c = 1 - \\frac{\\gamma \\Delta t}{2}$\n\nFor the discrete system to be stable, the magnitude of the roots $z$ must not exceed unity, i.e., $|z| \\le 1$. We apply the Jury stability criteria for a second-order polynomial with real coefficients. As the damping coefficient $\\gamma \\ge 0$ and the time step $\\Delta t > 0$, the coefficient $a$ is always positive ($a > 1$). The criteria for marginal stability ($|z| \\le 1$) are:\n1. $a+b+c \\ge 0$\n2. $a-b+c \\ge 0$\n3. $|c| \\le a$\n\nLet us evaluate each condition.\nCondition 1:\n$$\n\\left( 1 + \\frac{\\gamma \\Delta t}{2} \\right) + \\left( (\\omega \\Delta t)^2 - 2 \\right) + \\left( 1 - \\frac{\\gamma \\Delta t}{2} \\right) = (\\omega \\Delta t)^2 \\ge 0\n$$\nThis condition is always satisfied.\n\nCondition 3:\n$$\n|c| \\le a \\implies \\left| 1 - \\frac{\\gamma \\Delta t}{2} \\right| \\le 1 + \\frac{\\gamma \\Delta t}{2}\n$$\nThis inequality is equivalent to $- (1 + \\frac{\\gamma \\Delta t}{2}) \\le 1 - \\frac{\\gamma \\Delta t}{2} \\le 1 + \\frac{\\gamma \\Delta t}{2}$. The right-hand side simplifies to $0 \\le \\gamma \\Delta t$, which is true for $\\gamma \\ge 0$. The left-hand side simplifies to $-1 \\le 1$, which is always true. Thus, this condition is unconditionally satisfied for any physical damping.\n\nCondition 2:\n$$\n\\left( 1 + \\frac{\\gamma \\Delta t}{2} \\right) - \\left( (\\omega \\Delta t)^2 - 2 \\right) + \\left( 1 - \\frac{\\gamma \\Delta t}{2} \\right) \\ge 0\n$$\n$$\n1 + \\frac{\\gamma \\Delta t}{2} - (\\omega \\Delta t)^2 + 2 + 1 - \\frac{\\gamma \\Delta t}{2} \\ge 0\n$$\n$$\n4 - (\\omega \\Delta t)^2 \\ge 0 \\implies (\\omega \\Delta t)^2 \\le 4\n$$\nTaking the positive square root, as $\\omega$ and $\\Delta t$ are positive, yields the stability constraint:\n$$\n\\omega \\Delta t \\le 2 \\implies \\Delta t \\le \\frac{2}{\\omega}\n$$\nThis is the stability constraint for a single Lorentz pole. For a material described by multiple poles ($j = 1, \\dots, N_p$), the polarization is a sum $\\mathbf{P} = \\sum_j \\mathbf{P}_j$. The homogeneous equations for each $\\mathbf{P}_j$ are decoupled. Therefore, the single time step $\\Delta t$ used for the entire simulation must satisfy the stability condition for every pole simultaneously. This requires:\n$$\n\\Delta t \\le \\min_{j} \\left( \\frac{2}{\\omega_j} \\right)\n$$\nThis minimum is determined by the pole with the largest resonance frequency, $\\omega_{\\max} = \\max_j(\\omega_j)$. The resulting stability constraint for the material subsystem is:\n$$\n\\Delta t_{\\mathrm{material}} = \\frac{2}{\\max_j(\\omega_j)}\n$$\nThe clustering of poles only matters in that the pole with the highest frequency in the cluster dictates the limit. The damping coefficients $\\gamma_j$ do not affect the stability bound for this particular central-difference scheme.\n\nThis material stability constraint must be satisfied concurrently with the Courant–Friedrichs–Lewy (CFL) constraint for the electromagnetic field propagation. For the three-dimensional Yee grid with spatial steps $\\Delta x$, $\\Delta y$, and $\\Delta z$, the CFL constraint is:\n$$\n\\Delta t_{\\mathrm{EM}} = \\frac{1}{c \\sqrt{\\frac{1}{\\Delta x^2} + \\frac{1}{\\Delta y^2} + \\frac{1}{\\Delta z^2}}}\n$$\nwhere $c$ is the speed of light in vacuum. The overall maximum stable time step for the FDTD simulation is the more restrictive of these two conditions:\n$$\n\\Delta t_{\\max} = \\min\\left( \\Delta t_{\\mathrm{material}}, \\Delta t_{\\mathrm{EM}} \\right)\n$$\nThis general formula is now applied to the specific test cases. For the special case where $\\Delta x = \\Delta y = \\Delta z = \\Delta_s$, the CFL limit simplifies to $\\Delta t_{\\mathrm{EM}} = \\frac{\\Delta_s}{c\\sqrt{3}}$.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the maximum stable time step for FDTD simulations with\n    multi-pole Lorentz dispersive materials.\n    \"\"\"\n    \n    # Speed of light in vacuum (m/s)\n    c = 299792458.0\n\n    # Test cases defined in the problem statement.\n    # Each case is a tuple: (list of frequencies in Hz, list of damping coefficients in s^-1, grid spacing in m).\n    # The damping coefficients (gamma) are not used in the stability calculation\n    # derived for the central-difference scheme, but are retained for data integrity.\n    test_cases = [\n        # Case 1: Closely spaced cluster near a THz band, CFL non-limiting.\n        (\n            [1.00e12, 1.02e12, 0.98e12],     # frequencies f_j\n            [5.0e10, 5.0e10, 5.0e10],        # damping coefficients gamma_j\n            1.0e-3                           # grid spacing delta_s\n        ),\n        # Case 2: Cluster near a GHz band, CFL highly limiting.\n        (\n            [1.00e9, 1.05e9, 0.95e9],       # frequencies f_j\n            [1.0e8, 5.0e8, 2.0e8],          # damping coefficients gamma_j\n            1.0e-6                           # grid spacing delta_s\n        ),\n        # Case 3: Cluster near a multi-THz band, CFL non-limiting.\n        (\n            [3.00e12, 3.10e12, 2.90e12],     # frequencies f_j\n            [1.0e13, 1.0e12, 5.0e12],        # damping coefficients gamma_j\n            1.0e-2                           # grid spacing delta_s\n        )\n    ]\n\n    results = []\n\n    for case in test_cases:\n        frequencies_hz, _, delta_s = case\n\n        # 1. Calculate the material stability constraint (dt_material)\n        \n        # The stability constraint is dictated by the highest resonance frequency.\n        # First, find the maximum frequency f_max in Hz.\n        f_max = max(frequencies_hz)\n        \n        # Convert it to the maximum angular frequency omega_max in rad/s.\n        omega_max = 2 * np.pi * f_max\n        \n        # The ADE stability constraint derived from the central-difference scheme is:\n        # dt_material <= 2 / omega_max\n        dt_material = 2.0 / omega_max\n\n        # 2. Calculate the electromagnetic CFL constraint (dt_em)\n        \n        # For a 3D Yee grid with dx = dy = dz = delta_s, the CFL constraint is:\n        # dt_em <= delta_s / (c * sqrt(3))\n        dt_em = delta_s / (c * np.sqrt(3.0))\n\n        # 3. Determine the overall maximum stable time step\n        \n        # The actual time step must satisfy both constraints.\n        dt_max = min(dt_material, dt_em)\n        results.append(dt_max)\n\n    # Print the results in the specified single-line format.\n    # Using scientific notation to represent the small float values precisely.\n    print(f\"[{','.join(f'{r:.15e}' for r in results)}]\")\n\nsolve()\n```", "id": "3289828"}, {"introduction": "Beyond correctness and stability, the efficiency of a computational method is paramount. Modern high-performance computing relies on exploiting parallelism, and this exercise explores how the ADE formalism can be structured to do so effectively. By casting the multi-pole Lorentz model into a block-diagonal state-space form, you will see how the inherent independence of the auxiliary equations leads to a structure perfectly suited for Single Instruction, Multiple Data (SIMD) parallelization [@problem_id:3289886].", "problem": "Consider a linear, homogeneous, isotropic dispersive dielectric characterized in the frequency domain by a susceptibility that is a sum of $N$ Lorentz oscillator poles. In the time domain, this model can be represented by a set of $N$ coupled constitutive relations between the electric flux density $\\mathbf{D}$, the electric field $\\mathbf{E}$, and $N$ auxiliary polarization densities $\\{P_{m}\\}_{m=1}^{N}$, where for each pole $m$,\n$$\n\\mathbf{D}(t) = \\epsilon_{0}\\epsilon_{\\infty}\\mathbf{E}(t) + \\sum_{m=1}^{N} \\mathbf{P}_{m}(t),\n$$\nand each $\\mathbf{P}_{m}$ obeys the second-order ordinary differential equation\n$$\n\\ddot{\\mathbf{P}}_{m}(t) + \\gamma_{m}\\dot{\\mathbf{P}}_{m}(t) + \\omega_{0,m}^{2} \\mathbf{P}_{m}(t) = \\omega_{p,m}^{2} \\mathbf{E}(t),\n$$\nwith $\\epsilon_{0}$ the vacuum permittivity, $\\epsilon_{\\infty}$ the high-frequency relative permittivity, and, for each pole $m$, $\\gamma_{m}$ the damping rate, $\\omega_{0,m}$ the resonance frequency, and $\\omega_{p,m}$ the plasma frequency. Maxwell’s curl equations relate $\\mathbf{E}$ and the magnetic flux density $\\mathbf{B}$ as usual.\n\nDefine the auxiliary current $\\mathbf{J}_{m}(t) \\equiv \\dot{\\mathbf{P}}_{m}(t)$ and introduce the per-pole state vector $\\mathbf{x}_{m}(t) \\equiv \\begin{pmatrix} \\mathbf{P}_{m}(t) \\\\ \\mathbf{J}_{m}(t) \\end{pmatrix}$. Using this state, the per-pole constitutive dynamics can be written in first-order form,\n$$\n\\dot{\\mathbf{x}}_{m}(t) = F_{m}\\,\\mathbf{x}_{m}(t) + G_{m}\\,\\mathbf{E}(t),\n$$\nwhere $F_{m}$ and $G_{m}$ are constant matrices depending only on $\\gamma_{m}$, $\\omega_{0,m}$, and $\\omega_{p,m}$. Consider a uniform time step $\\Delta t$, and discretize the above first-order per-pole system using the trapezoidal rule (also known as the Crank–Nicolson method) to obtain a linear implicit time-update for $x_{m}^{n} \\equiv x_{m}(n\\Delta t)$ in terms of $x_{m}^{n+1}$, $x_{m}^{n}$, $\\mathbf{E}^{n+1}$, and $\\mathbf{E}^{n}$. Assemble the global state $X^{n} \\equiv \\begin{pmatrix} x_{1}^{n} \\\\ \\vdots \\\\ x_{N}^{n} \\end{pmatrix}$ and write the resulting $N$-pole auxiliary differential equation (ADE) update as a compact vector-matrix recursion in block-diagonal state-space form. Then, based on the derived structure, explain from first principles why the block-diagonal form enables Single Instruction Multiple Data (SIMD) updates across poles without data hazards.\n\nAnswer the following:\n\n- Starting from Maxwell’s equations and the given Lorentz pole constitutive law, derive the trapezoidal-rule time-discrete per-pole update and express the global $N$-pole recursion in the compact block-diagonal state-space form $X^{n+1} = \\mathcal{A}\\,X^{n} + \\mathcal{B}\\,\\mathbf{E}^{n+1} + \\mathcal{B}\\,\\mathbf{E}^{n}$, where $\\mathcal{A}$ and $\\mathcal{B}$ do not depend on time.\n- Provide, in closed form, the block-diagonal update matrix $\\mathcal{A}$ explicitly in terms of $\\Delta t$, $\\{\\gamma_{m}\\}$, and $\\{\\omega_{0,m}\\}$.\n- Explain how the block-diagonal structure and per-pole independence enable Single Instruction Multiple Data (SIMD) updates across the $N$ poles.\n\nYour final answer must be the single closed-form analytical expression for the matrix $\\mathcal{A}$, expressed only in terms of $\\Delta t$, $\\{\\gamma_{m}\\}$, and $\\{\\omega_{0,m}\\}$. Do not include any equality sign or additional commentary in the final answer. No numerical evaluation is required.", "solution": "The problem asks for the derivation of the trapezoidal-rule-based time-domain update equations for a multi-pole Lorentz dispersion model using the auxiliary differential equation (ADE) method, and an analysis of the resulting structure for parallel computation.\n\nFirst, we must formalize the state-space representation. The governing second-order ordinary differential equation (ODE) for each polarization density pole $m$ is given as:\n$$\n\\ddot{P}_{m}(t) + \\gamma_{m}\\dot{P}_{m}(t) + \\omega_{0,m}^{2} P_{m}(t) = \\omega_{p,m}^{2} \\mathbf{E}(t)\n$$\nThere is a notational inconsistency in the problem statement: $P_m$ is non-bold, implying a scalar, while $\\mathbf{E}(t)$ is bold, implying a vector. For a linear, isotropic medium, the vector components of the polarization depend only on the corresponding vector components of the electric field. For instance, the $x$-component ODE would be $\\ddot{P}_{m,x}(t) + \\gamma_{m}\\dot{P}_{m,x}(t) + \\omega_{0,m}^{2} P_{m,x}(t) = \\omega_{p,m}^{2} E_x(t)$. The equations for the $y$ and $z$ components are identical in form. Therefore, we can perform the derivation for a single scalar component, and the resulting update coefficients will be the same for all three spatial components. Let the scalar variables $P_m(t)$, $J_m(t)$, and $E(t)$ represent one such component.\n\nThe state vector for each pole $m$ is defined as $x_{m}(t) = \\begin{pmatrix} P_{m}(t) \\\\ J_{m}(t) \\end{pmatrix}$, where $J_{m}(t) = \\dot{P}_{m}(t)$. The first derivative of the state vector is $\\dot{x}_{m}(t) = \\begin{pmatrix} \\dot{P}_{m}(t) \\\\ \\ddot{P}_{m}(t) \\end{pmatrix}$. Using the definitions and the governing ODE, we can write:\n$$\n\\dot{x}_{m}(t) = \\begin{pmatrix} J_{m}(t) \\\\ -\\omega_{0,m}^{2} P_{m}(t) - \\gamma_{m} J_{m}(t) + \\omega_{p,m}^{2} E(t) \\end{pmatrix}\n$$\nThis can be expressed in the first-order matrix form $\\dot{x}_{m}(t) = F_{m}x_{m}(t) + G_{m}E(t)$ by identifying the constant matrices $F_m$ and $G_m$:\n$$\nF_{m} = \\begin{pmatrix} 0 & 1 \\\\ -\\omega_{0,m}^{2} & -\\gamma_{m} \\end{pmatrix}, \\quad G_{m} = \\begin{pmatrix} 0 \\\\ \\omega_{p,m}^{2} \\end{pmatrix}\n$$\nNext, we discretize this system using the trapezoidal rule (Crank-Nicolson method) over a time step $\\Delta t$. For a general first-order ODE $\\dot{y} = f(y,t)$, the rule is $y^{n+1} - y^{n} = \\frac{\\Delta t}{2} \\left[ f(y^{n+1}, t^{n+1}) + f(y^{n}, t^{n}) \\right]$. Applying this to our linear system:\n$$\nx_{m}^{n+1} - x_{m}^{n} = \\frac{\\Delta t}{2} \\left[ (F_{m}x_{m}^{n+1} + G_{m}E^{n+1}) + (F_{m}x_{m}^{n} + G_{m}E^{n}) \\right]\n$$\nTo find an explicit update rule for $x_{m}^{n+1}$, we rearrange the equation to group terms involving $x_{m}^{n+1}$ on the left-hand side and all other terms on the right-hand side:\n$$\n\\left(I - \\frac{\\Delta t}{2}F_{m}\\right) x_{m}^{n+1} = \\left(I + \\frac{\\Delta t}{2}F_{m}\\right) x_{m}^{n} + \\frac{\\Delta t}{2}G_{m} \\left(E^{n+1} + E^{n}\\right)\n$$\nwhere $I$ is the $2 \\times 2$ identity matrix. Solving for $x_{m}^{n+1}$ yields:\n$$\nx_{m}^{n+1} = \\left(I - \\frac{\\Delta t}{2}F_{m}\\right)^{-1} \\left(I + \\frac{\\Delta t}{2}F_{m}\\right) x_{m}^{n} + \\left(I - \\frac{\\Delta t}{2}F_{m}\\right)^{-1} \\frac{\\Delta t}{2}G_{m} \\left(E^{n+1} + E^{n}\\right)\n$$\nThis is the per-pole update equation. We can now identify the per-pole update matrices. Let $A_m = \\left(I - \\frac{\\Delta t}{2}F_{m}\\right)^{-1} \\left(I + \\frac{\\Delta t}{2}F_{m}\\right)$ and $B_m = \\left(I - \\frac{\\Delta t}{2}F_{m}\\right)^{-1} \\frac{\\Delta t}{2}G_{m}$. The update is $x_m^{n+1} = A_m x_m^n + B_m(E^{n+1} + E^n)$, which can be assembled into the global state-space form prescribed.\n\nThe global state vector is $X^n = \\begin{pmatrix} x_1^n \\\\ \\vdots \\\\ x_N^n \\end{pmatrix}$. Since the dynamics of each pole $m$ depend only on its own state $x_m$ and the common field $E$, the updates are uncoupled across poles. The global recursion is:\n$$\nX^{n+1} = \\mathcal{A} X^n + \\mathcal{B} (E^{n+1} + E^n)\n$$\nwhere the problem asks for the form $X^{n+1} = \\mathcal{A}X^{n} + \\mathcal{B}E^{n+1} + \\mathcal{B}E^{n}$.\nThe matrices $\\mathcal{A}$ and $\\mathcal{B}$ have the block structures:\n$$\n\\mathcal{A} = \\begin{pmatrix} A_1 & 0 & \\cdots & 0 \\\\ 0 & A_2 & \\cdots & 0 \\\\ \\vdots & \\vdots & \\ddots & \\vdots \\\\ 0 & 0 & \\cdots & A_N \\end{pmatrix}, \\quad \\mathcal{B} = \\begin{pmatrix} B_1 \\\\ B_2 \\\\ \\vdots \\\\ B_N \\end{pmatrix}\n$$\nThe problem requires the closed-form expression for $\\mathcal{A}$. To find this, we must compute the matrix $A_m$. First, we find the matrices to be multiplied and inverted:\n$$\nI - \\frac{\\Delta t}{2}F_{m} = \\begin{pmatrix} 1 & -\\frac{\\Delta t}{2} \\\\ \\frac{\\Delta t}{2}\\omega_{0,m}^{2} & 1 + \\frac{\\Delta t}{2}\\gamma_{m} \\end{pmatrix}\n$$\n$$\nI + \\frac{\\Delta t}{2}F_{m} = \\begin{pmatrix} 1 & \\frac{\\Delta t}{2} \\\\ -\\frac{\\Delta t}{2}\\omega_{0,m}^{2} & 1 - \\frac{\\Delta t}{2}\\gamma_{m} \\end{pmatrix}\n$$\nThe determinant of $\\left(I - \\frac{\\Delta t}{2}F_{m}\\right)$ is:\n$$\n\\det\\left(I - \\frac{\\Delta t}{2}F_{m}\\right) = (1)\\left(1 + \\frac{\\Delta t}{2}\\gamma_{m}\\right) - \\left(-\\frac{\\Delta t}{2}\\right)\\left(\\frac{\\Delta t}{2}\\omega_{0,m}^{2}\\right) = 1 + \\frac{\\Delta t}{2}\\gamma_{m} + \\frac{(\\Delta t)^2}{4}\\omega_{0,m}^{2}\n$$\nLet's denote this determinant as $D_m$. The inverse is:\n$$\n\\left(I - \\frac{\\Delta t}{2}F_{m}\\right)^{-1} = \\frac{1}{D_m} \\begin{pmatrix} 1 + \\frac{\\Delta t}{2}\\gamma_{m} & \\frac{\\Delta t}{2} \\\\ -\\frac{\\Delta t}{2}\\omega_{0,m}^{2} & 1 \\end{pmatrix}\n$$\nNow we compute $A_m = \\left(I - \\frac{\\Delta t}{2}F_{m}\\right)^{-1} \\left(I + \\frac{\\Delta t}{2}F_{m}\\right)$:\n$$\nA_m = \\frac{1}{D_m} \\begin{pmatrix} 1 + \\frac{\\Delta t}{2}\\gamma_{m} & \\frac{\\Delta t}{2} \\\\ -\\frac{\\Delta t}{2}\\omega_{0,m}^{2} & 1 \\end{pmatrix} \\begin{pmatrix} 1 & \\frac{\\Delta t}{2} \\\\ -\\frac{\\Delta t}{2}\\omega_{0,m}^{2} & 1 - \\frac{\\Delta t}{2}\\gamma_{m} \\end{pmatrix}\n$$\nPerforming the matrix multiplication gives the components of the numerator matrix:\n$$\n(A_m)_{11} = \\frac{1}{D_m} \\left[ \\left(1 + \\frac{\\Delta t}{2}\\gamma_{m}\\right) - \\frac{(\\Delta t)^2}{4}\\omega_{0,m}^{2} \\right] = \\frac{1}{D_m} \\left[ 1 + \\frac{\\Delta t}{2}\\gamma_{m} - \\frac{(\\Delta t)^2}{4}\\omega_{0,m}^{2} \\right]\n$$\n$$\n(A_m)_{12} = \\frac{1}{D_m} \\left[ \\left(1 + \\frac{\\Delta t}{2}\\gamma_{m}\\right)\\frac{\\Delta t}{2} + \\frac{\\Delta t}{2}\\left(1 - \\frac{\\Delta t}{2}\\gamma_{m}\\right) \\right] = \\frac{1}{D_m} \\left[ \\Delta t \\right]\n$$\n$$\n(A_m)_{21} = \\frac{1}{D_m} \\left[ -\\frac{\\Delta t}{2}\\omega_{0,m}^{2} - \\frac{\\Delta t}{2}\\omega_{0,m}^{2} \\right] = \\frac{1}{D_m} \\left[ -\\Delta t \\, \\omega_{0,m}^{2} \\right]\n$$\n$$\n(A_m)_{22} = \\frac{1}{D_m} \\left[ -\\frac{(\\Delta t)^2}{4}\\omega_{0,m}^{2} + \\left(1 - \\frac{\\Delta t}{2}\\gamma_{m}\\right) \\right] = \\frac{1}{D_m} \\left[ 1 - \\frac{\\Delta t}{2}\\gamma_{m} - \\frac{(\\Delta t)^2}{4}\\omega_{0,m}^{2} \\right]\n$$\nSo the block $A_m$ is:\n$$\nA_m = \\frac{1}{1 + \\frac{\\Delta t}{2}\\gamma_{m} + \\frac{(\\Delta t)^{2}}{4}\\omega_{0,m}^{2}} \\begin{pmatrix} 1 + \\frac{\\Delta t}{2}\\gamma_{m} - \\frac{(\\Delta t)^{2}}{4}\\omega_{0,m}^{2} & \\Delta t \\\\ -\\Delta t \\, \\omega_{0,m}^{2} & 1 - \\frac{\\Delta t}{2}\\gamma_{m} - \\frac{(\\Delta t)^{2}}{4}\\omega_{0,m}^{2} \\end{pmatrix}\n$$\nThe global matrix $\\mathcal{A}$ is the block-diagonal matrix formed by these $A_m$ blocks.\n\nFinally, we explain why this structure enables SIMD updates. SIMD stands for Single Instruction, Multiple Data, a parallel processing paradigm where the same operation is performed on multiple data points simultaneously.\nThe derived global update equation is $X^{n+1} = \\mathcal{A}X^{n} + \\mathcal{B}(E^{n+1} + E^{n})$. The crucial feature is that the matrix $\\mathcal{A}$ is block-diagonal. This structure mathematically represents the physical independence of the Lorentz poles. The update for the state of a single pole, $x_m^{n+1} = A_m x_m^n + B_m(E^{n+1} + E^n)$, depends only on its own previous state $x_m^n$ and the common driving field $E$. It does not depend on the state of any other pole, $x_k^n$ for $k \\neq m$.\nThis independence is the key to SIMD parallelization.\n1.  **Single Instruction**: The sequence of arithmetic operations required to compute $A_m x_m^n$ and add the field term is the same for every pole $m$. This sequence constitutes the \"single instruction\". Although the coefficients in $A_m$ (derived from $\\gamma_m$, $\\omega_{0,m}$) are different for each pole, the structure of the calculation is identical.\n2.  **Multiple Data**: The state vectors $\\{x_1^n, x_2^n, ..., x_N^n\\}$ for the $N$ different poles constitute the \"multiple data\".\nIn a SIMD architecture (e.g., using AVX instructions on a CPU or on a GPU), one can load the components of the state vectors for several poles into wide vector registers. For example, one register could hold the $P_m$ values for a set of different poles $m$, and another could hold the $J_m$ values. The same floating-point multiplications and additions defined by the update algorithm are then applied to all data lanes in the registers in parallel.\nBecause the update for pole $m$ does not require any information from pole $k$, there are no **data hazards** between the pole updates. All $N$ poles can be updated concurrently without waiting for results from each other. This lack of inter-pole data dependency makes the ADE-FDTD algorithm with a block-diagonal update matrix exceptionally efficient on modern parallel hardware.\nThe final answer is the closed-form expression for the matrix $\\mathcal{A}$.", "answer": "$$\n\\boxed{\n\\begin{pmatrix} A_1 & & & \\mathbf{0} \\\\ & A_2 & & \\\\ & & \\ddots & \\\\ \\mathbf{0} & & & A_N \\end{pmatrix} \\text{ where } A_m = \\frac{1}{1 + \\frac{\\Delta t}{2}\\gamma_{m} + \\frac{(\\Delta t)^{2}}{4}\\omega_{0,m}^{2}} \\begin{pmatrix} 1 + \\frac{\\Delta t}{2}\\gamma_{m} - \\frac{(\\Delta t)^{2}}{4}\\omega_{0,m}^{2} & \\Delta t \\\\ -\\Delta t \\, \\omega_{0,m}^{2} & 1 - \\frac{\\Delta t}{2}\\gamma_{m} - \\frac{(\\Delta t)^{2}}{4}\\omega_{0,m}^{2} \\end{pmatrix}\n}\n$$", "id": "3289886"}]}