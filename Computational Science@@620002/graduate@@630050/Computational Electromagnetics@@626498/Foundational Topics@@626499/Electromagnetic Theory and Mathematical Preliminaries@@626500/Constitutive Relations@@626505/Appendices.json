{"hands_on_practices": [{"introduction": "Understanding how constitutive relations dictate wave behavior is a cornerstone of electromagnetics. This first practice explores one of the most fundamental interactions: the propagation of a plane wave in a good conductor. By applying the constitutive relation for conduction current, $\\mathbf{J}=\\sigma \\mathbf{E}$, you will derive the complex propagation constant and the resulting skin depth, which quantifies the rapid attenuation of fields inside conductive materials. This essential derivation solidifies the link between Maxwell's equations and material properties, forming the basis for analyzing concepts like electromagnetic shielding and power loss in practical devices [@problem_id:3295112].", "problem": "Consider a time-harmonic, uniform plane electromagnetic (EM) wave of angular frequency $\\omega$ propagating in the $+z$ direction through a homogeneous, isotropic, linear medium characterized by the constitutive relations $\\mathbf{D}=\\epsilon \\mathbf{E}$, $\\mathbf{B}=\\mu \\mathbf{H}$, and $\\mathbf{J}=\\sigma \\mathbf{E}$, where $\\epsilon$ is the permittivity, $\\mu$ is the permeability, and $\\sigma$ is the electrical conductivity. Work in the phasor domain with the time dependence $\\exp(j\\omega t)$, where $j=\\sqrt{-1}$. Assume the medium is a good conductor such that $\\sigma \\gg \\omega \\epsilon$.\n\nStarting from Maxwell's equations in the frequency domain and the stated constitutive relations, derive the complex propagation constant $\\gamma=\\alpha+j\\beta$ for this plane wave and the corresponding skin depth $\\delta$, defined as $\\delta=1/\\alpha$. Express your final results for $\\gamma$ and $\\delta$ in closed form solely in terms of $\\omega$, $\\mu$, and $\\sigma$, under the stated good-conductor assumption. Provide the final answer as analytic expressions. Do not provide intermediate equations or identities as your final answer.", "solution": "The problem as stated is scientifically grounded, well-posed, and objective. It is a standard derivation in computational electromagnetics and wave propagation theory. All necessary givens and conditions are provided, and there are no contradictions or ambiguities. The problem is declared valid and a solution will be provided.\n\nThe objective is to derive the complex propagation constant, $\\gamma$, and the skin depth, $\\delta$, for a uniform plane wave in a good conductor, starting from Maxwell's equations.\n\nWe begin with Maxwell's equations in the frequency (phasor) domain for a linear, isotropic, homogeneous medium with no free charge sources ($\\rho_f = 0$):\n$$\n\\nabla \\times \\mathbf{E} = -j\\omega\\mathbf{B}\n$$\n$$\n\\nabla \\times \\mathbf{H} = \\mathbf{J} + j\\omega\\mathbf{D}\n$$\n$$\n\\nabla \\cdot \\mathbf{D} = 0\n$$\n$$\n\\nabla \\cdot \\mathbf{B} = 0\n$$\nHere, $\\mathbf{E}$, $\\mathbf{H}$, $\\mathbf{D}$, $\\mathbf{B}$, and $\\mathbf{J}$ are the phasor representations of the electric field intensity, magnetic field intensity, electric flux density, magnetic flux density, and electric current density, respectively. The angular frequency is $\\omega$, and $j = \\sqrt{-1}$.\n\nWe substitute the given constitutive relations, $\\mathbf{D}=\\epsilon \\mathbf{E}$, $\\mathbf{B}=\\mu \\mathbf{H}$, and $\\mathbf{J}=\\sigma \\mathbf{E}$, into Maxwell's curl equations:\n$$\n\\nabla \\times \\mathbf{E} = -j\\omega\\mu\\mathbf{H} \\quad (1)\n$$\n$$\n\\nabla \\times \\mathbf{H} = \\sigma\\mathbf{E} + j\\omega\\epsilon\\mathbf{E} = (\\sigma + j\\omega\\epsilon)\\mathbf{E} \\quad (2)\n$$\nTo derive the wave equation for the electric field, we take the curl of Equation (1):\n$$\n\\nabla \\times (\\nabla \\times \\mathbf{E}) = -j\\omega\\mu(\\nabla \\times \\mathbf{H})\n$$\nNext, we use the vector identity $\\nabla \\times (\\nabla \\times \\mathbf{A}) = \\nabla(\\nabla \\cdot \\mathbf{A}) - \\nabla^2\\mathbf{A}$. For the electric field $\\mathbf{E}$, this is $\\nabla \\times (\\nabla \\times \\mathbf{E}) = \\nabla(\\nabla \\cdot \\mathbf{E}) - \\nabla^2\\mathbf{E}$. From Maxwell's third equation, $\\nabla \\cdot \\mathbf{D} = 0$, and the constitutive relation $\\mathbf{D}=\\epsilon \\mathbf{E}$, we have $\\nabla \\cdot (\\epsilon\\mathbf{E}) = \\epsilon(\\nabla \\cdot \\mathbf{E}) = 0$. For a non-trivial medium where $\\epsilon \\neq 0$, it follows that $\\nabla \\cdot \\mathbf{E} = 0$. Thus, the vector identity simplifies to $\\nabla \\times (\\nabla \\times \\mathbf{E}) = -\\nabla^2\\mathbf{E}$.\n\nSubstituting this simplified identity and Equation (2) into the curled Equation (1), we get:\n$$\n-\\nabla^2\\mathbf{E} = -j\\omega\\mu(\\sigma + j\\omega\\epsilon)\\mathbf{E}\n$$\nRearranging this gives the vector Helmholtz equation for the electric field:\n$$\n\\nabla^2\\mathbf{E} - j\\omega\\mu(\\sigma + j\\omega\\epsilon)\\mathbf{E} = 0\n$$\nThis equation describes wave propagation and is of the general form $\\nabla^2\\mathbf{E} - \\gamma^2\\mathbf{E} = 0$. By comparison, we identify the complex propagation constant squared, $\\gamma^2$, as:\n$$\n\\gamma^2 = j\\omega\\mu(\\sigma + j\\omega\\epsilon) = j\\omega\\mu\\sigma - \\omega^2\\mu\\epsilon\n$$\nThe problem specifies that the medium is a good conductor, for which the condition $\\sigma \\gg \\omega\\epsilon$ holds. This means that the conduction current density is much greater than the displacement current density ($|\\mathbf{J}| = \\sigma|\\mathbf{E}| \\gg |j\\omega\\mathbf{D}| = \\omega\\epsilon|\\mathbf{E}|$). Under this approximation, the term $\\omega\\epsilon$ is negligible compared to $\\sigma$ in the expression for $\\gamma^2$:\n$$\n\\gamma^2 \\approx j\\omega\\mu\\sigma\n$$\nTo find $\\gamma$, we must take the square root of this complex number. We express the imaginary unit $j$ in polar form as $j = \\exp(j\\pi/2)$.\n$$\n\\gamma \\approx \\sqrt{\\omega\\mu\\sigma \\exp(j\\pi/2)} = \\sqrt{\\omega\\mu\\sigma} \\cdot \\left(\\exp(j\\pi/2)\\right)^{1/2} = \\sqrt{\\omega\\mu\\sigma} \\exp(j\\pi/4)\n$$\nUsing Euler's formula, $\\exp(j\\theta) = \\cos(\\theta) + j\\sin(\\theta)$, we convert the polar form back to rectangular form:\n$$\n\\exp(j\\pi/4) = \\cos(\\frac{\\pi}{4}) + j\\sin(\\frac{\\pi}{4}) = \\frac{1}{\\sqrt{2}} + j\\frac{1}{\\sqrt{2}} = \\frac{1+j}{\\sqrt{2}}\n$$\nSubstituting this result into the expression for $\\gamma$:\n$$\n\\gamma \\approx \\sqrt{\\omega\\mu\\sigma} \\left( \\frac{1+j}{\\sqrt{2}} \\right) = \\sqrt{\\frac{\\omega\\mu\\sigma}{2}}(1+j)\n$$\nThis is the final expression for the complex propagation constant $\\gamma$ under the good-conductor approximation.\n\nThe complex propagation constant is defined as $\\gamma = \\alpha + j\\beta$, where $\\alpha$ is the attenuation constant and $\\beta$ is the phase constant. By equating the real and imaginary parts of our derived expression for $\\gamma$, we find:\n$$\n\\alpha = \\sqrt{\\frac{\\omega\\mu\\sigma}{2}}\n$$\n$$\n\\beta = \\sqrt{\\frac{\\omega\\mu\\sigma}{2}}\n$$\nThe skin depth, $\\delta$, is defined as the depth at which the amplitude of the electric field decays to $1/e$ of its value at the surface. It is given by the reciprocal of the attenuation constant, $\\delta=1/\\alpha$.\n$$\n\\delta = \\frac{1}{\\alpha} = \\frac{1}{\\sqrt{\\frac{\\omega\\mu\\sigma}{2}}} = \\sqrt{\\frac{2}{\\omega\\mu\\sigma}}\n$$\nThis is the final expression for the skin depth $\\delta$. The problem requires the final analytic expressions for both $\\gamma$ and $\\delta$.", "answer": "$$\n\\boxed{\\begin{pmatrix} \\sqrt{\\frac{\\omega\\mu\\sigma}{2}} (1+j) & \\sqrt{\\frac{2}{\\omega\\mu\\sigma}} \\end{pmatrix}}\n$$", "id": "3295112"}, {"introduction": "While many materials can be approximated as isotropic, a vast and important class of materials, such as crystals used in optics, exhibit anisotropy. This practice moves beyond scalar constitutive relations to explore the profound physical consequences of a tensor permittivity, $\\mathbf{D}=\\bar{\\bar{\\epsilon}}\\mathbf{E}$. You will investigate why the electric field $\\mathbf{E}$ is not necessarily transverse to the direction of wave propagation, even in a source-free medium, and how this leads to phenomena like birefringent \"walk-off\" where energy flows in a different direction than the phase fronts. This analysis is critical for understanding and designing a wide range of optical components, from simple polarizers to advanced nonlinear devices [@problem_id:3341054].", "problem": "Consider a homogeneous, source-free, linear anisotropic dielectric whose electric flux density obeys the constitutive relation $\\mathbf{D}=\\bar{\\bar{\\epsilon}}\\,\\mathbf{E}$, where $\\bar{\\bar{\\epsilon}}$ is a real, symmetric, positive-definite permittivity tensor, and whose magnetic flux density is $\\mathbf{B}=\\mu\\,\\mathbf{H}$ with scalar permeability $\\mu>0$. A time-harmonic plane wave with angular frequency $\\omega$ has phasor fields that vary as $\\exp(j\\,\\mathbf{k}\\cdot\\mathbf{r})$, where $\\mathbf{k}$ is the wavevector. Starting from Maxwell’s equations and the given constitutive relations, analyze the transversality conditions and their implications for polarization.\n\nSelect all statements that are correct:\n\nA. In a source-free region, the divergence condition imposes $\\mathbf{k}\\cdot\\mathbf{D}=0$. In an anisotropic dielectric with non-scalar $\\bar{\\bar{\\epsilon}}$, this does not force $\\mathbf{k}\\cdot\\mathbf{E}=0$.\n\nB. For any homogeneous anisotropic dielectric, the electric field of a plane wave is purely transverse to the wavevector, so $\\mathbf{k}\\cdot\\mathbf{E}=0$ must hold.\n\nC. In a uniaxial dielectric with optic axis along $\\hat{\\mathbf{z}}$ and $\\bar{\\bar{\\epsilon}}=\\mathrm{diag}(\\epsilon_{\\mathrm{o}},\\epsilon_{\\mathrm{o}},\\epsilon_{\\mathrm{e}})$, for a wave with $\\mathbf{k}$ in the $x$-$z$ plane and not parallel to $\\hat{\\mathbf{z}}$, the extraordinary wave can have $\\mathbf{E}$ with a nonzero component along $\\mathbf{k}$ while still satisfying $\\mathbf{k}\\cdot\\mathbf{D}=0$.\n\nD. In any linear, lossless anisotropic dielectric, the time-average Poynting vector $\\mathbf{S}=\\tfrac{1}{2}\\mathrm{Re}\\{\\mathbf{E}\\times\\mathbf{H}^{*}\\}$ is strictly parallel to the wavevector $\\mathbf{k}$.\n\nE. Polarization eigenstates in anisotropic dielectrics arise from a homogeneous linear system for $\\mathbf{E}$ obtained by combining the curl equations with the constitutive relations, which is equivalent to a generalized eigenvalue problem in $\\mathbf{E}$ for a given propagation direction $\\hat{\\mathbf{k}}$.\n\nF. If $\\mathbf{k}\\cdot\\mathbf{E}\\neq 0$ in a source-free anisotropic dielectric, then Gauss’s law is violated and a nonzero free charge density $\\rho_{\\mathrm{f}}\\neq 0$ must be present.", "solution": "The problem statement is analyzed for validity.\n\n### Step 1: Extract Givens\n- Medium characteristics: homogeneous, source-free, linear anisotropic dielectric.\n- Electric constitutive relation: $\\mathbf{D}=\\bar{\\bar{\\epsilon}}\\,\\mathbf{E}$.\n- Permittivity tensor properties: $\\bar{\\bar{\\epsilon}}$ is a real, symmetric, positive-definite tensor.\n- Magnetic constitutive relation: $\\mathbf{B}=\\mu\\,\\mathbf{H}$.\n- Permeability properties: $\\mu$ is a positive scalar, $\\mu>0$.\n- Waveform: Time-harmonic plane wave with angular frequency $\\omega$.\n- Phasor representation: Fields vary spatially as $\\exp(j\\,\\mathbf{k}\\cdot\\mathbf{r})$, where $\\mathbf{k}$ is the wavevector.\n- Task: Analyze the transversality conditions for such a wave starting from Maxwell’s equations.\n\n### Step 2: Validate Using Extracted Givens\n- **Scientific Soundness**: The problem is scientifically sound. It describes plane wave propagation in a linear, lossless, non-gyrotropic anisotropic medium, which is a standard and fundamental topic in advanced electromagnetism and crystal optics. The properties of the permittivity tensor and permeability are physically realistic.\n- **Well-Posedness**: The problem is well-posed. It provides sufficient information (Maxwell's equations, constitutive relations, wave form) to uniquely determine the properties of the electromagnetic fields.\n- **Objectivity**: The problem is stated in precise, objective, and standard scientific language.\n\n### Step 3: Verdict and Action\nThe problem statement is valid. We proceed to derive the solution and evaluate the options.\n\n### Principle-Based Derivation\nWe begin with Maxwell's equations in phasor form for a source-free ($\\rho_f=0, \\mathbf{J}_f=0$) region:\n$$(1) \\quad \\nabla \\cdot \\mathbf{D} = 0$$\n$$(2) \\quad \\nabla \\cdot \\mathbf{B} = 0$$\n$$(3) \\quad \\nabla \\times \\mathbf{E} = -j\\omega \\mathbf{B}$$\n$$(4) \\quad \\nabla \\times \\mathbf{H} = j\\omega \\mathbf{D}$$\nFor a plane wave with spatial dependence $\\exp(j\\,\\mathbf{k}\\cdot\\mathbf{r})$, the del operator $\\nabla$ can be replaced by the vector $j\\mathbf{k}$. Applying this substitution to Maxwell's equations yields:\n$$(1') \\quad j\\mathbf{k} \\cdot \\mathbf{D} = 0 \\implies \\mathbf{k} \\cdot \\mathbf{D} = 0$$\n$$(2') \\quad j\\mathbf{k} \\cdot \\mathbf{B} = 0 \\implies \\mathbf{k} \\cdot \\mathbf{B} = 0$$\n$$(3') \\quad j\\mathbf{k} \\times \\mathbf{E} = -j\\omega \\mathbf{B} \\implies \\mathbf{k} \\times \\mathbf{E} = -\\omega \\mathbf{B}$$\n$$(4') \\quad j\\mathbf{k} \\times \\mathbf{H} = j\\omega \\mathbf{D} \\implies \\mathbf{k} \\times \\mathbf{H} = \\omega \\mathbf{D}$$\nThe constitutive relations are $\\mathbf{D}=\\bar{\\bar{\\epsilon}}\\,\\mathbf{E}$ and $\\mathbf{B}=\\mu\\,\\mathbf{H}$.\n\nFrom $(1')$, the electric flux density $\\mathbf{D}$ is always transverse (perpendicular) to the wavevector $\\mathbf{k}$.\nFrom $(2')$, the magnetic flux density $\\mathbf{B}$ is always transverse to $\\mathbf{k}$. Since $\\mathbf{B}=\\mu\\mathbf{H}$ and $\\mu$ is a scalar, the magnetic field $\\mathbf{H}$ is also always transverse to $\\mathbf{k}$: $\\mathbf{k} \\cdot \\mathbf{H} = 0$.\n\nLet us analyze the transversality of the electric field $\\mathbf{E}$. Using the relation $\\mathbf{D}=\\bar{\\bar{\\epsilon}}\\,\\mathbf{E}$ in $(1')$, we obtain:\n$$\\mathbf{k} \\cdot (\\bar{\\bar{\\epsilon}}\\,\\mathbf{E}) = 0$$\nIn general, for a tensor $\\bar{\\bar{\\epsilon}}$, the vector $\\bar{\\bar{\\epsilon}}\\,\\mathbf{E}$ is not parallel to $\\mathbf{E}$. Therefore, the condition that $\\mathbf{k}$ is orthogonal to $\\bar{\\bar{\\epsilon}}\\,\\mathbf{E}$ does not imply that $\\mathbf{k}$ is orthogonal to $\\mathbf{E}$. Consequently, $\\mathbf{k} \\cdot \\mathbf{E}$ is not necessarily zero in an anisotropic medium. $\\mathbf{E}$ can have a component along the direction of phase propagation $\\mathbf{k}$.\n\nTo find the equation governing the polarization states, we combine the curl equations. From $(3')$ and $(4')$:\n$$\\mathbf{k} \\times \\mathbf{E} = -\\omega \\mu \\mathbf{H}$$\n$$\\mathbf{k} \\times \\mathbf{H} = \\omega \\bar{\\bar{\\epsilon}} \\mathbf{E}$$\nSubstituting $\\mathbf{H}$ from the first equation into the second:\n$$\\mathbf{k} \\times \\left( -\\frac{1}{\\omega\\mu} (\\mathbf{k} \\times \\mathbf{E}) \\right) = \\omega \\bar{\\bar{\\epsilon}} \\mathbf{E}$$\n$$-\\frac{1}{\\omega\\mu} [\\mathbf{k}(\\mathbf{k} \\cdot \\mathbf{E}) - \\mathbf{E}(\\mathbf{k} \\cdot \\mathbf{k})] = \\omega \\bar{\\bar{\\epsilon}} \\mathbf{E}$$\nLetting $|\\mathbf{k}| = k$, we get $\\mathbf{k} \\cdot \\mathbf{k} = k^2$:\n$$\\mathbf{k}(\\mathbf{k} \\cdot \\mathbf{E}) - k^2 \\mathbf{E} = -\\omega^2\\mu \\bar{\\bar{\\epsilon}} \\mathbf{E}$$\nThis can be written as a homogeneous linear system for the vector $\\mathbf{E}$:\n$$[\\mathbf{k}\\otimes\\mathbf{k} - k^2\\mathbf{I} + \\omega^2\\mu \\bar{\\bar{\\epsilon}}] \\mathbf{E} = \\mathbf{0}$$\nwhere $\\mathbf{I}$ is the identity tensor and $\\mathbf{k}\\otimes\\mathbf{k}$ is the dyadic product. Non-trivial solutions for $\\mathbf{E}$ exist only if the determinant of the matrix operator is zero, which defines the dispersion relation for the medium.\n\nRegarding the energy flow, the time-average Poynting vector is $\\mathbf{S}=\\tfrac{1}{2}\\mathrm{Re}\\{\\mathbf{E}\\times\\mathbf{H}^{*}\\}$. For the given lossless medium ($\\bar{\\bar{\\epsilon}}$ real, $\\mu$ real), the fields can be taken as real (up to a phase factor), so $\\mathbf{S} = \\tfrac{1}{2}\\mathbf{E} \\times \\mathbf{H}$. We know $\\mathbf{k} \\cdot \\mathbf{H} = 0$. $\\mathbf{S}$ is perpendicular to $\\mathbf{H}$. Thus, $\\mathbf{S}$ lies in the plane defined by $\\mathbf{E}$ and $\\mathbf{k}$. If $\\mathbf{k} \\cdot \\mathbf{E} \\neq 0$, then $\\mathbf{E}$ is not perpendicular to $\\mathbf{k}$. Since $\\mathbf{S}$ is perpendicular to $\\mathbf{E}$, $\\mathbf{S}$ cannot be parallel to $\\mathbf{k}$. The direction of energy flow (ray direction, $\\mathbf{S}$) and phase propagation (wave normal, $\\mathbf{k}$) are generally different.\n\n### Option-by-Option Analysis\n\n**A. In a source-free region, the divergence condition imposes $\\mathbf{k}\\cdot\\mathbf{D}=0$. In an anisotropic dielectric with non-scalar $\\bar{\\bar{\\epsilon}}$, this does not force $\\mathbf{k}\\cdot\\mathbf{E}=0$.**\nAs shown in the derivation from Maxwell's equation $\\nabla \\cdot \\mathbf{D} = 0$, for a plane wave in a source-free region, it is required that $\\mathbf{k} \\cdot \\mathbf{D} = 0$. Using the constitutive relation $\\mathbf{D} = \\bar{\\bar{\\epsilon}}\\mathbf{E}$, this becomes $\\mathbf{k} \\cdot (\\bar{\\bar{\\epsilon}}\\mathbf{E}) = 0$. When $\\bar{\\bar{\\epsilon}}$ is a non-scalar tensor, the vector $\\bar{\\bar{\\epsilon}}\\mathbf{E}$ is not in general parallel to $\\mathbf{E}$. Thus, the orthogonality of $\\mathbf{k}$ to $\\bar{\\bar{\\epsilon}}\\mathbf{E}$ does not imply orthogonality of $\\mathbf{k}$ to $\\mathbf{E}$. A longitudinal component of the electric field ($\\mathbf{k} \\cdot \\mathbf{E} \\neq 0$) can exist. This statement is a correct description of wave propagation in anisotropic dielectrics.\n**Verdict: Correct.**\n\n**B. For any homogeneous anisotropic dielectric, the electric field of a plane wave is purely transverse to the wavevector, so $\\mathbf{k}\\cdot\\mathbf{E}=0$ must hold.**\nThis statement is the direct contradiction of the conclusion from the analysis of option A. While $\\mathbf{k}\\cdot\\mathbf{E}=0$ holds for isotropic media and for specific propagation directions or polarizations in anisotropic media (e.g., the ordinary wave in a uniaxial crystal, or propagation along an optic axis), it does not hold in general for any plane wave in an anisotropic medium. The extraordinary wave in a uniaxial crystal is a prime counterexample.\n**Verdict: Incorrect.**\n\n**C. In a uniaxial dielectric with optic axis along $\\hat{\\mathbf{z}}$ and $\\bar{\\bar{\\epsilon}}=\\mathrm{diag}(\\epsilon_{\\mathrm{o}},\\epsilon_{\\mathrm{o}},\\epsilon_{\\mathrm{e}})$, for a wave with $\\mathbf{k}$ in the $x$-$z$ plane and not parallel to $\\hat{\\mathbf{z}}$, the extraordinary wave can have $\\mathbf{E}$ with a nonzero component along $\\mathbf{k}$ while still satisfying $\\mathbf{k}\\cdot\\mathbf{D}=0$.**\nLet the optic axis be $\\hat{\\mathbf{z}}$. The permittivity tensor is $\\bar{\\bar{\\epsilon}} = \\epsilon_0 \\mathrm{diag}(\\epsilon_{\\mathrm{o}}, \\epsilon_{\\mathrm{o}}, \\epsilon_{\\mathrm{e}})$. Let $\\mathbf{k}$ be in the $x$-$z$ plane, making an angle $\\theta$ with the $z$-axis: $\\mathbf{k} = k(\\sin\\theta \\hat{\\mathbf{x}} + \\cos\\theta \\hat{\\mathbf{z}})$. The extraordinary wave has its $\\mathbf{E}$ field polarized in the principal plane (the plane containing $\\mathbf{k}$ and the optic axis), so $\\mathbf{E} = E_x\\hat{\\mathbf{x}} + E_z\\hat{\\mathbf{z}}$. The corresponding electric flux density is $\\mathbf{D} = \\bar{\\bar{\\epsilon}}\\mathbf{E} = \\epsilon_0(\\epsilon_{\\mathrm{o}}E_x\\hat{\\mathbf{x}} + \\epsilon_{\\mathrm{e}}E_z\\hat{\\mathbf{z}})$. The condition $\\mathbf{k}\\cdot\\mathbf{D}=0$ implies $k\\epsilon_0(\\epsilon_{\\mathrm{o}}E_x\\sin\\theta + \\epsilon_{\\mathrm{e}}E_z\\cos\\theta)=0$. The component of $\\mathbf{E}$ along $\\mathbf{k}$ is proportional to $\\mathbf{E}\\cdot\\mathbf{k} = k(E_x\\sin\\theta + E_z\\cos\\theta)$. From the $\\mathbf{k}\\cdot\\mathbf{D}=0$ condition, we have $E_x = -(\\epsilon_{\\mathrm{e}}/\\epsilon_{\\mathrm{o}}) E_z (\\cos\\theta/\\sin\\theta)$. Substituting this into $\\mathbf{E}\\cdot\\mathbf{k}$, we get $\\mathbf{E}\\cdot\\mathbf{k} = k(-\\frac{\\epsilon_{\\mathrm{e}}}{\\epsilon_{\\mathrm{o}}} E_z \\frac{\\cos\\theta}{\\sin\\theta} \\sin\\theta + E_z\\cos\\theta) = k E_z \\cos\\theta (1 - \\frac{\\epsilon_{\\mathrm{e}}}{\\epsilon_{\\mathrm{o}}})$. This is non-zero unless $\\theta=\\pi/2$, $E_z=0$, or $\\epsilon_{\\mathrm{e}}=\\epsilon_{\\mathrm{o}}$ (isotropic case). For a general direction where $\\cos\\theta \\neq 0$ and $\\epsilon_{\\mathrm{e}} \\neq \\epsilon_{\\mathrm{o}}$, $\\mathbf{E} \\cdot \\mathbf{k} \\neq 0$. Thus, the extraordinary wave has an electric field component along the wavevector while satisfying the fundamental requirement $\\mathbf{k}\\cdot\\mathbf{D}=0$.\n**Verdict: Correct.**\n\n**D. In any linear, lossless anisotropic dielectric, the time-average Poynting vector $\\mathbf{S}=\\tfrac{1}{2}\\mathrm{Re}\\{\\mathbf{E}\\times\\mathbf{H}^{*}\\}$ is strictly parallel to the wavevector $\\mathbf{k}$.**\nThe Poynting vector $\\mathbf{S}$ indicates the direction of energy flow (the ray direction), while $\\mathbf{k}$ indicates the direction of phase propagation. As established in the analysis of option A, $\\mathbf{k}\\cdot\\mathbf{E}$ is generally non-zero. The Poynting vector $\\mathbf{S}$ must be perpendicular to both $\\mathbf{E}$ and $\\mathbf{H}$. The field $\\mathbf{H}$ is perpendicular to the plane containing $\\mathbf{k}$ and $\\mathbf{E}$. Therefore, $\\mathbf{S}$ must lie in the plane of $\\mathbf{k}$ and $\\mathbf{E}$. If $\\mathbf{k}$ and $\\mathbf{E}$ are not perpendicular, $\\mathbf{S}$ (being perpendicular to $\\mathbf{E}$) cannot be parallel to $\\mathbf{k}$. This divergence between the ray and wave normal directions is known as \"walk-off\" and is a hallmark of anisotropic propagation.\n**Verdict: Incorrect.**\n\n**E. Polarization eigenstates in anisotropic dielectrics arise from a homogeneous linear system for $\\mathbf{E}$ obtained by combining the curl equations with the constitutive relations, which is equivalent to a generalized eigenvalue problem in $\\mathbf{E}$ for a given propagation direction $\\hat{\\mathbf{k}}$.**\nAs derived above, combining Maxwell's curl equations and the constitutive relations leads to the equation $\\mathbf{k} \\times (\\mathbf{k} \\times \\mathbf{E}) + \\omega^2\\mu\\bar{\\bar{\\epsilon}}\\mathbf{E} = 0$. This is a homogeneous linear system of equations for the components of the electric field $\\mathbf{E}$. For a fixed propagation direction $\\hat{\\mathbf{k}}$ (so $\\mathbf{k}=k\\hat{\\mathbf{k}}$) and a fixed wave number $k$, the equation can be written as $(\\frac{k^2}{\\mu}\\mathbf{P}_{\\hat{\\mathbf{k}}})\\mathbf{E} = \\omega^2 \\bar{\\bar{\\epsilon}}\\mathbf{E}$, where $\\mathbf{P}_{\\hat{\\mathbf{k}}}$ is a transverse projection operator. This is a generalized eigenvalue problem of the form $\\mathbf{A}\\mathbf{E} = \\lambda \\mathbf{B}\\mathbf{E}$, where the eigenvectors $\\mathbf{E}$ are the polarization states and the eigenvalues $\\lambda = \\omega^2$ determine the allowed frequencies. This statement accurately describes the mathematical origin of polarization eigenstates.\n**Verdict: Correct.**\n\n**F. If $\\mathbf{k}\\cdot\\mathbf{E}\\neq 0$ in a source-free anisotropic dielectric, then Gauss’s law is violated and a nonzero free charge density $\\rho_{\\mathrm{f}}\\neq 0$ must be present.**\nGauss's law in a dielectric medium is $\\nabla \\cdot \\mathbf{D} = \\rho_{\\mathrm{f}}$. For a source-free region ($\\rho_{\\mathrm{f}}=0$) and a plane wave, this law requires $\\mathbf{k}\\cdot\\mathbf{D}=0$. As established in options A and C, it is entirely possible for $\\mathbf{k}\\cdot\\mathbf{E}\\neq 0$ and $\\mathbf{k}\\cdot\\mathbf{D}=0$ to hold simultaneously in an anisotropic medium. The condition $\\mathbf{k}\\cdot\\mathbf{E}\\neq 0$ does not imply that $\\mathbf{k}\\cdot\\mathbf{D}\\neq 0$. Therefore, a non-transverse electric field $\\mathbf{E}$ does not violate Gauss's law in a source-free anisotropic medium. This statement incorrectly equates the behavior of $\\mathbf{E}$ with that of $\\mathbf{D}$.\n**Verdict: Incorrect.**", "answer": "$$\\boxed{ACE}$$", "id": "3341054"}, {"introduction": "The ultimate goal of computational electromagnetics is to accurately model real-world systems, which are often both anisotropic and lossy. This final exercise bridges the gap between continuous-domain theory and practical numerical implementation. You are tasked with designing a stable Finite-Difference Time-Domain (FDTD) scheme for a medium with a tensor permittivity $\\bar{\\bar{\\epsilon}}(\\mathbf{r})$ and a spatially varying conductivity $\\sigma(\\mathbf{r})$. By deriving a discrete energy conservation law, you will not only prove that the chosen numerical scheme is inherently stable but also determine the precise time-step constraint required for a convergent simulation. This capstone problem integrates the physics of complex media with the rigorous demands of numerical algorithm design, a crucial skill for any computational scientist [@problem_id:3295110].", "problem": "Consider Maxwell's equations in differential form and the constitutive relations for an anisotropic lossy medium. Let the electric flux density be $\\,\\mathbf{D} = \\bar{\\bar{\\epsilon}}(\\mathbf{r})\\,\\mathbf{E}\\,$, the magnetic flux density be $\\,\\mathbf{B} = \\mu\\,\\mathbf{H}\\,$, and the conduction current be $\\,\\mathbf{J}_c = \\sigma(\\mathbf{r})\\,\\mathbf{E}\\,$, with scalar $\\,\\sigma(\\mathbf{r}) \\ge 0\\,$. The evolution is governed by $\\,\\partial_t \\mathbf{D} + \\mathbf{J}_c = \\nabla \\times \\mathbf{H}\\,$ and $\\,\\partial_t \\mathbf{B} = -\\nabla \\times \\mathbf{E}\\,$.\n\nYou will design a finite-difference time-domain scheme based on a staggered Yee lattice for $\\,\\mathbf{E}\\,$ and $\\,\\mathbf{H}\\,$ that is stable for an anisotropic lossy medium with $\\,\\bar{\\bar{\\epsilon}}(\\mathbf{r})\\,$ and nonuniform $\\,\\sigma(\\mathbf{r})\\,$. In particular, you must:\n\n- Start from the fundamental laws and core definitions above and construct a leapfrog-in-time discretization for $\\,\\mathbf{H}\\,$ and a trapezoidal (time-centered) discretization of the conductive term for $\\,\\mathbf{E}\\,$ so that the update for $\\,\\mathbf{E}\\,$ at each cell involves the local inversion of $\\,\\bar{\\bar{\\epsilon}} + \\frac{\\Delta t}{2}\\sigma \\bar{\\bar{I}}\\,$, where $\\,\\bar{\\bar{I}}\\,$ is the identity tensor.\n- Derive a discrete Poynting theorem on the Yee grid that defines a discrete energy of the form $$W^n = \\frac{1}{2}\\sum_{\\text{cells}} \\mathbf{E}^n \\cdot \\bar{\\bar{\\epsilon}}\\,\\mathbf{E}^n + \\frac{1}{2}\\sum_{\\text{faces}} \\mu\\,|\\mathbf{H}^{n+\\frac{1}{2}}|^2,$$ and shows that the time increment $\\,W^{n+1} - W^n\\,$ equals the negative of a dissipation term involving $\\,\\sigma\\,|\\mathbf{E}|^2\\,$ plus a boundary flux term. Under periodic boundaries, the net flux must be shown to vanish.\n- From this discrete energy identity, obtain a sharp explicit time-step constraint for stability (energy non-increase) in terms of the maximum local wave speed and the Yee-grid discrete curl operator bound. The bound must depend on the minimum eigenvalue of $\\,\\bar{\\bar{\\epsilon}}\\,$ across the domain and the grid spacings $\\,\\Delta x\\,$, $\\,\\Delta y\\,$, and $\\,\\Delta z\\,$.\n\nAssume the magnetic permeability $\\,\\mu\\,$ is a spatially uniform positive scalar. Let $\\,\\lambda_{\\min}(\\bar{\\bar{\\epsilon}}(\\mathbf{r}))\\,$ denote the smallest eigenvalue of the tensor at position $\\,\\mathbf{r}\\,$, and define the global minimum $\\,\\epsilon_{\\min} = \\min_{\\mathbf{r}} \\lambda_{\\min}(\\bar{\\bar{\\epsilon}}(\\mathbf{r}))\\,$. The local characteristic speed is $\\,c(\\mathbf{r}) = 1/\\sqrt{\\mu\\,\\lambda_{\\min}(\\bar{\\bar{\\epsilon}}(\\mathbf{r}))}\\,$, and the worst-case $\\,c_{\\max} = 1/\\sqrt{\\mu\\,\\epsilon_{\\min}}\\,$. Your derivation must show that the explicit time-step constraint takes the sharp Yee-grid form $$\\Delta t \\le \\frac{1}{c_{\\max}\\,\\sqrt{\\left(\\frac{1}{\\Delta x}\\right)^2 + \\left(\\frac{1}{\\Delta y}\\right)^2 + \\left(\\frac{1}{\\Delta z}\\right)^2}}\\;,$$ and explain why $\\,\\sigma(\\mathbf{r})\\,$ handled by a trapezoidal (time-centered) term does not further restrict $\\,\\Delta t\\,$ but contributes strictly dissipative terms.\n\nYour program must implement the computed bound $\\,\\Delta t_{\\max}\\,$ for a set of test cases. For each test case, you will be given the grid spacings, a uniform scalar $\\,\\mu\\,$, a list of $\\,\\bar{\\bar{\\epsilon}}\\,$ tensors for representative cells in the domain, and a list of scalar conductivities $\\,\\sigma(\\mathbf{r})\\,$ (which may vary between cells). Your program should compute $\\,\\epsilon_{\\min}\\,$ as the minimum of the smallest eigenvalues of the provided tensors and then compute $\\,\\Delta t_{\\max}\\,$ using the derived bound. The output must be one line containing a comma-separated list of the results, enclosed in square brackets.\n\nAll answers must be expressed in seconds, as decimal numbers, and aggregated exactly as a single line in the output format described below.\n\nTest suite:\n\n- Case 1 (general 3D, moderate anisotropy, moderate conductivity): $\\,\\Delta x = 1.0\\times 10^{-3}\\,\\mathrm{m}\\,$, $\\,\\Delta y = 1.0\\times 10^{-3}\\,\\mathrm{m}\\,$, $\\,\\Delta z = 1.0\\times 10^{-3}\\,\\mathrm{m}\\,$; $\\,\\mu = \\mu_0\\,$; three tensors $\\,\\bar{\\bar{\\epsilon}}_1 = \\mathrm{diag}\\left(2\\epsilon_0,3\\epsilon_0,4\\epsilon_0\\right)\\,$, $\\,\\bar{\\bar{\\epsilon}}_2 = \\mathrm{diag}\\left(2.5\\epsilon_0,2.5\\epsilon_0,2.5\\epsilon_0\\right)\\,$, $\\,\\bar{\\bar{\\epsilon}}_3 = \\mathrm{diag}\\left(3\\epsilon_0,4\\epsilon_0,5\\epsilon_0\\right)\\,$; conductivities $\\,\\sigma = [0,10^3,5\\times 10^3]\\,\\mathrm{S/m}\\,$.\n- Case 2 (high conductivity, low permittivity extreme): $\\,\\Delta x = 1.0\\times 10^{-3}\\,\\mathrm{m}\\,$, $\\,\\Delta y = 1.0\\times 10^{-3}\\,\\mathrm{m}\\,$, $\\,\\Delta z = 1.0\\times 10^{-3}\\,\\mathrm{m}\\,$; $\\,\\mu = \\mu_0\\,$; tensors $\\,\\bar{\\bar{\\epsilon}}_1 = \\mathrm{diag}\\left(\\epsilon_0,2\\epsilon_0,5\\epsilon_0\\right)\\,$, $\\,\\bar{\\bar{\\epsilon}}_2 = \\mathrm{diag}\\left(1.2\\epsilon_0,3\\epsilon_0,4\\epsilon_0\\right)\\,$; conductivities $\\,\\sigma = [10^8,10^6]\\,\\mathrm{S/m}\\,$.\n- Case 3 (strong anisotropy with very small eigenvalue): $\\,\\Delta x = 2.0\\times 10^{-3}\\,\\mathrm{m}\\,$, $\\,\\Delta y = 2.0\\times 10^{-3}\\,\\mathrm{m}\\,$, $\\,\\Delta z = 2.0\\times 10^{-3}\\,\\mathrm{m}\\,$; $\\,\\mu = \\mu_0\\,$; tensors $\\,\\bar{\\bar{\\epsilon}}_1 = \\mathrm{diag}\\left(0.5\\epsilon_0,2\\epsilon_0,2\\epsilon_0\\right)\\,$, $\\,\\bar{\\bar{\\epsilon}}_2 = \\mathrm{diag}\\left(0.6\\epsilon_0,1.8\\epsilon_0,2.2\\epsilon_0\\right)\\,$; conductivities $\\,\\sigma = [10^4,10^5]\\,\\mathrm{S/m}\\,$.\n- Case 4 (highly nonuniform grid with thin layers): $\\,\\Delta x = 5.0\\times 10^{-4}\\,\\mathrm{m}\\,$, $\\,\\Delta y = 5.0\\times 10^{-4}\\,\\mathrm{m}\\,$, $\\,\\Delta z = 5.0\\times 10^{-5}\\,\\mathrm{m}\\,$; $\\,\\mu = \\mu_0\\,$; tensor $\\,\\bar{\\bar{\\epsilon}} = \\mathrm{diag}\\left(3\\epsilon_0,3\\epsilon_0,3\\epsilon_0\\right)\\,$; conductivity $\\,\\sigma = [10^3]\\,\\mathrm{S/m}\\,$.\n\nConstants: $\\,\\epsilon_0 = 8.854187817\\times 10^{-12}\\,\\mathrm{F/m}\\,$, $\\,\\mu_0 = 4\\pi\\times 10^{-7}\\,\\mathrm{H/m}\\,$.\n\nFinal output format:\n\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. For example, $\\,\\left[\\Delta t_1,\\Delta t_2,\\Delta t_3,\\Delta t_4\\right]\\,$.\n- Each $\\,\\Delta t_i\\,$ must be a float representing seconds.\n\nNo external inputs are required; the test suite is embedded in the program. The design and derivation must be grounded in first principles and avoid the use of shortcut formulas not derived from the discrete energy argument.", "solution": "The problem is valid as it is well-posed, scientifically grounded in Maxwell's theory and standard numerical methods, and provides a complete set of data and requirements for a unique solution. We proceed with the derivation and implementation.\n\nThe solution requires three main parts:\n1.  Formulation of the finite-difference time-domain (FDTD) update equations for the specified anisotropic, lossy medium.\n2.  Derivation of a discrete energy balance (Poynting's theorem) and explanation of how the implicit treatment of conductivity leads to dissipation without affecting the time-step constraint.\n3.  Derivation of the sharp time-step ($\\Delta t$) constraint for numerical stability from the system's energy dynamics.\n\n### FDTD Update Equations\n\nWe begin with Maxwell's equations in the time domain for an anisotropic, lossy medium:\n$$ \\partial_t \\mathbf{D} + \\mathbf{J}_c = \\nabla \\times \\mathbf{H} \\quad (1) $$\n$$ \\partial_t \\mathbf{B} = -\\nabla \\times \\mathbf{E} \\quad (2) $$\nThe constitutive relations are given by:\n$$ \\mathbf{D} = \\bar{\\bar{\\epsilon}}(\\mathbf{r})\\,\\mathbf{E} $$\n$$ \\mathbf{B} = \\mu\\,\\mathbf{H} $$\n$$ \\mathbf{J}_c = \\sigma(\\mathbf{r})\\,\\mathbf{E} $$\nSubstituting the constitutive relations into Maxwell's equations, and assuming $\\bar{\\bar{\\epsilon}}$, $\\mu$, and $\\sigma$ are time-invariant, we obtain:\n$$ \\bar{\\bar{\\epsilon}}(\\mathbf{r}) \\frac{\\partial \\mathbf{E}}{\\partial t} + \\sigma(\\mathbf{r}) \\mathbf{E} = \\nabla \\times \\mathbf{H} \\quad (3) $$\n$$ \\mu \\frac{\\partial \\mathbf{H}}{\\partial t} = -\\nabla \\times \\mathbf{E} \\quad (4) $$\nWe discretize these equations on a staggered Yee lattice. Time is discretized as $t = n \\Delta t$. The electric field $\\mathbf{E}$ is evaluated at integer time steps $n$, and the magnetic field $\\mathbf{H}$ is evaluated at half-integer time steps $n \\pm 1/2$. This leads to the leapfrog time-stepping scheme.\n\n**Magnetic Field (H) Update:**\nWe discretize Eq. (4) using a central difference for the time derivative centered at $t = (n+1)\\Delta t$:\n$$ \\mu \\frac{\\mathbf{H}^{n+3/2} - \\mathbf{H}^{n+1/2}}{\\Delta t} = -(\\nabla \\times \\mathbf{E})^{n+1} $$\nThis yields the standard explicit leapfrog update for $\\mathbf{H}$:\n$$ \\mathbf{H}^{n+3/2} = \\mathbf{H}^{n+1/2} - \\frac{\\Delta t}{\\mu} (\\nabla \\times \\mathbf{E})^{n+1} $$\n\n**Electric Field (E) Update:**\nWe discretize Eq. (3) by centering the time derivative at $t = (n+1/2)\\Delta t$. The problem specifies a trapezoidal (time-centered) rule for the conductive term $\\sigma \\mathbf{E}$. This means this term is evaluated as an average of its values at time steps $n$ and $n+1$.\n$$ \\bar{\\bar{\\epsilon}} \\frac{\\mathbf{E}^{n+1} - \\mathbf{E}^n}{\\Delta t} + \\sigma \\frac{\\mathbf{E}^{n+1} + \\mathbf{E}^n}{2} = (\\nabla \\times \\mathbf{H})^{n+1/2} $$\nTo obtain the update equation for $\\mathbf{E}^{n+1}$, we rearrange the terms:\n$$ \\left(\\frac{\\bar{\\bar{\\epsilon}}}{\\Delta t} + \\frac{\\sigma}{2}\\bar{\\bar{I}}\\right) \\mathbf{E}^{n+1} = \\left(\\frac{\\bar{\\bar{\\epsilon}}}{\\Delta t} - \\frac{\\sigma}{2}\\bar{\\bar{I}}\\right) \\mathbf{E}^n + (\\nabla \\times \\mathbf{H})^{n+1/2} $$\nMultiplying by $\\Delta t$, we get:\n$$ \\left(\\bar{\\bar{\\epsilon}} + \\frac{\\Delta t}{2}\\sigma\\bar{\\bar{I}}\\right) \\mathbf{E}^{n+1} = \\left(\\bar{\\bar{\\epsilon}} - \\frac{\\Delta t}{2}\\sigma\\bar{\\bar{I}}\\right) \\mathbf{E}^n + \\Delta t (\\nabla \\times \\mathbf{H})^{n+1/2} $$\nThis gives the semi-implicit update equation for $\\mathbf{E}^{n+1}$:\n$$ \\mathbf{E}^{n+1} = \\left(\\bar{\\bar{\\epsilon}} + \\frac{\\Delta t}{2}\\sigma\\bar{\\bar{I}}\\right)^{-1} \\left[ \\left(\\bar{\\bar{\\epsilon}} - \\frac{\\Delta t}{2}\\sigma\\bar{\\bar{I}}\\right) \\mathbf{E}^n + \\Delta t (\\nabla \\times \\mathbf{H})^{n+1/2} \\right] $$\nAs stipulated, this update involves the inversion of the matrix $\\left(\\bar{\\bar{\\epsilon}} + \\frac{\\Delta t}{2}\\sigma\\bar{\\bar{I}}\\right)$ at each cell where $\\mathbf{E}$ is defined. Since $\\bar{\\bar{\\epsilon}}$ is symmetric positive definite (SPD) and $\\sigma \\ge 0$, this matrix is always invertible.\n\n### Discrete Poynting Theorem and Role of Conductivity\n\nA discrete energy balance can be derived to analyze the stability of the scheme. The problem defines a discrete energy functional at time step $n$ as:\n$$ W^n = \\frac{1}{2}\\sum_{\\text{cells}} \\mathbf{E}^n \\cdot \\bar{\\bar{\\epsilon}}\\,\\mathbf{E}^n + \\frac{1}{2}\\sum_{\\text{faces}} \\mu\\,|\\mathbf{H}^{n+\\frac{1}{2}}|^2 $$\nwhere the sums are over all grid cells/faces, implicitly including the cell volume $\\Delta V$. The change in energy is $W^{n+1} - W^n$. We analyze this change term by term.\n$$ \\Delta W_E = \\frac{1}{2}\\sum \\left(\\mathbf{E}^{n+1}\\cdot\\bar{\\bar{\\epsilon}}\\mathbf{E}^{n+1} - \\mathbf{E}^n\\cdot\\bar{\\bar{\\epsilon}}\\mathbf{E}^n\\right) = \\frac{1}{2}\\sum (\\mathbf{E}^{n+1}-\\mathbf{E}^n)\\cdot\\bar{\\bar{\\epsilon}}(\\mathbf{E}^{n+1}+\\mathbf{E}^n) $$\nFrom the Ampere's law discretization, we have $\\bar{\\bar{\\epsilon}}(\\mathbf{E}^{n+1}-\\mathbf{E}^n) = \\Delta t (\\nabla\\times\\mathbf{H})^{n+1/2} - \\frac{\\Delta t \\sigma}{2}(\\mathbf{E}^{n+1}+\\mathbf{E}^n)$. Substituting this:\n$$ \\Delta W_E = \\frac{1}{2}\\sum \\left( \\Delta t (\\nabla\\times\\mathbf{H})^{n+1/2} - \\frac{\\Delta t \\sigma}{2}(\\mathbf{E}^{n+1}+\\mathbf{E}^n) \\right) \\cdot (\\mathbf{E}^{n+1}+\\mathbf{E}^n) $$\n$$ \\Delta W_E = \\Delta t \\sum (\\nabla\\times\\mathbf{H})^{n+1/2} \\cdot \\mathbf{E}^{n+1/2} - \\Delta t \\sum \\sigma |\\mathbf{E}^{n+1/2}|^2 $$\nwhere we use the shorthand $\\mathbf{E}^{n+1/2} = (\\mathbf{E}^{n+1}+\\mathbf{E}^n)/2$.\n\nThe change in magnetic energy is:\n$$ \\Delta W_H = \\frac{1}{2}\\sum \\mu \\left(|\\mathbf{H}^{n+3/2}|^2 - |\\mathbf{H}^{n+1/2}|^2\\right) = \\frac{1}{2}\\sum \\mu (\\mathbf{H}^{n+3/2}-\\mathbf{H}^{n+1/2})\\cdot(\\mathbf{H}^{n+3/2}+\\mathbf{H}^{n+1/2}) $$\nFrom Faraday's law, $\\mathbf{H}^{n+3/2}-\\mathbf{H}^{n+1/2} = -\\frac{\\Delta t}{\\mu}(\\nabla\\times\\mathbf{E})^{n+1}$. Substituting this:\n$$ \\Delta W_H = -\\Delta t \\sum (\\nabla\\times\\mathbf{E})^{n+1} \\cdot \\mathbf{H}^{n+1} $$\nwhere $\\mathbf{H}^{n+1} = (\\mathbf{H}^{n+3/2}+\\mathbf{H}^{n+1/2})/2$.\nThe total energy change is $W^{n+1}-W^n = \\Delta W_E + \\Delta W_H$. Using the discrete version of the vector identity $\\sum (\\nabla\\times\\mathbf{A})\\cdot\\mathbf{B} = \\sum \\mathbf{A}\\cdot(\\nabla\\times\\mathbf{B}) + \\text{flux terms}$, we get:\n$$ W^{n+1}-W^n = \\Delta t \\sum \\left[ \\mathbf{H}^{n+1/2}\\cdot(\\nabla\\times\\mathbf{E})^{n+1/2} - \\mathbf{H}^{n+1}\\cdot(\\nabla\\times\\mathbf{E})^{n+1} \\right] - \\Delta t \\sum \\sigma|\\mathbf{E}^{n+1/2}|^2 - \\text{Flux}^{n+1/2} $$\nUnder periodic boundary conditions, the flux term vanishes. The second term, $-\\Delta t \\sum \\sigma|\\mathbf{E}^{n+1/2}|^2$, is the energy dissipation due to conductivity, which is always non-positive as $\\sigma \\ge 0$. This term represents the energy lost as heat.\n\nThe implicit (trapezoidal) treatment of the conductivity term makes this part of the scheme unconditionally stable. The update can be written as $\\mathbf{E}^{n+1}_{\\text{lossy part}} = (\\bar{\\bar{\\epsilon}} + \\frac{\\Delta t\\sigma}{2}\\bar{\\bar{I}})^{-1}(\\bar{\\bar{\\epsilon}} - \\frac{\\Delta t\\sigma}{2}\\bar{\\bar{I}}) \\mathbf{E}^n$. Let $\\mathbf{M} = \\bar{\\bar{\\epsilon}}^{-1/2}(\\frac{\\Delta t\\sigma}{2}\\bar{\\bar{I}})\\bar{\\bar{\\epsilon}}^{-1/2}$. Since $\\bar{\\bar{\\epsilon}}$ is SPD, so is $\\bar{\\bar{\\epsilon}}^{-1/2}$, and $\\mathbf{M}$ is SPD with real, positive eigenvalues $\\lambda_M > 0$. The amplification operator is similar to $(\\mathbf{I}+\\mathbf{M})^{-1}(\\mathbf{I}-\\mathbf{M})$, a Cayley transform. Its eigenvalues are $\\frac{1-\\lambda_M}{1+\\lambda_M}$, which have magnitudes strictly less than $1$. Thus, the conductive step is a contraction mapping, ensuring dissipation and stability, and does not impose its own upper bound on $\\Delta t$.\n\n### Stability Constraint Derivation\n\nThe stability of the overall scheme is governed by the explicit, lossless part of the algorithm. The term $\\Delta t \\sum [ \\dots ]$ in the energy balance is non-zero due to the temporal staggering. To derive a sharp bound, a matrix stability analysis of the full second-order system is most rigorous. We consider the lossless case ($\\sigma=0$) first.\nThe two first-order update equations can be combined into a single second-order update for $\\mathbf{E}$:\n$$ \\bar{\\bar{\\epsilon}} \\frac{\\mathbf{E}^{n+1} - \\mathbf{E}^n}{\\Delta t} = \\nabla\\times\\mathbf{H}^{n+1/2} \\quad \\text{and} \\quad \\bar{\\bar{\\epsilon}} \\frac{\\mathbf{E}^{n} - \\mathbf{E}^{n-1}}{\\Delta t} = \\nabla\\times\\mathbf{H}^{n-1/2} $$\nSubtracting these gives:\n$$ \\frac{\\bar{\\bar{\\epsilon}}}{\\Delta t}(\\mathbf{E}^{n+1} - 2\\mathbf{E}^n + \\mathbf{E}^{n-1}) = \\frac{1}{\\Delta t}\\nabla\\times(\\mathbf{H}^{n+1/2} - \\mathbf{H}^{n-1/2}) $$\nSubstituting the H-update, $\\mathbf{H}^{n+1/2} - \\mathbf{H}^{n-1/2} = - \\frac{\\Delta t}{\\mu}(\\nabla\\times\\mathbf{E})^n$:\n$$ \\frac{\\bar{\\bar{\\epsilon}}}{\\Delta t}(\\mathbf{E}^{n+1} - 2\\mathbf{E}^n + \\mathbf{E}^{n-1}) = \\frac{1}{\\Delta t}\\nabla\\times\\left(-\\frac{\\Delta t}{\\mu}\\nabla\\times\\mathbf{E}^n\\right) $$\n$$ \\mathbf{E}^{n+1} - 2\\mathbf{E}^n + \\mathbf{E}^{n-1} = -\\frac{\\Delta t^2}{\\mu}\\bar{\\bar{\\epsilon}}^{-1}(\\nabla\\times\\nabla\\times\\mathbf{E}^n) $$\nLet $\\mathbf{E}^n(\\mathbf{r}) = \\mathbf{E}_0 e^{j(\\omega n\\Delta t - \\mathbf{k}\\cdot\\mathbf{r})}$. The discrete curl operator on the Yee grid corresponds to multiplication by $j\\tilde{\\mathbf{k}}$ in the Fourier domain, where $\\tilde{k}_x = \\frac{2}{\\Delta x}\\sin(k_x \\Delta x/2)$, etc. The central difference in time becomes $(e^{j\\omega\\Delta t} - 2 + e^{-j\\omega\\Delta t}) = -4\\sin^2(\\omega\\Delta t/2)$.\n$$ -4\\sin^2(\\omega\\Delta t/2)\\mathbf{E}_0 = -\\frac{\\Delta t^2}{\\mu}\\bar{\\bar{\\epsilon}}^{-1} (j\\tilde{\\mathbf{k}}\\times(j\\tilde{\\mathbf{k}}\\times\\mathbf{E}_0)) = -\\frac{\\Delta t^2}{\\mu}\\bar{\\bar{\\epsilon}}^{-1}(-\\tilde{k}^2 \\mathbf{E}_0 + \\tilde{\\mathbf{k}}(\\tilde{\\mathbf{k}}\\cdot\\mathbf{E}_0))$$\nFor numerical stability, $\\omega\\Delta t$ must be real, which implies $\\sin^2(\\omega\\Delta t/2) \\leq 1$.\n$$ \\sin^2(\\frac{\\omega\\Delta t}{2}) = \\frac{\\Delta t^2}{4\\mu} \\frac{\\mathbf{E}_0 \\cdot \\bar{\\bar{\\epsilon}}^{-1}(\\tilde{k}^2\\mathbf{E}_0 - \\tilde{\\mathbf{k}}(\\tilde{\\mathbf{k}}\\cdot\\mathbf{E}_0))}{\\mathbf{E}_0 \\cdot \\mathbf{E}_0} \\le 1 $$\nTo find the strictest constraint, we must maximize the right-hand side over all wave vectors $\\mathbf{k}$ and all field polarizations $\\mathbf{E}_0$. The polarization that maximizes the expression is the eigenvector of $\\bar{\\bar{\\epsilon}}^{-1}$ corresponding to its maximum eigenvalue, which is $1/\\lambda_{\\min}(\\bar{\\bar{\\epsilon}})$. Let this minimum eigenvalue over the entire domain be $\\epsilon_{\\min}$. The maximum value of the term is then bounded by:\n$$ \\max \\frac{\\lambda_{\\max}(\\bar{\\bar{\\epsilon}}^{-1}) \\cdot \\lambda_{\\max}(\\tilde{k}^2\\mathbf{I} - \\tilde{\\mathbf{k}}\\tilde{\\mathbf{k}}^T)}{\\mu} = \\frac{1}{\\mu\\epsilon_{\\min}} \\max_{\\mathbf{k}}(|\\tilde{\\mathbf{k}}|^2) = c_{\\max}^2 \\max_{\\mathbf{k}}(|\\tilde{\\mathbf{k}}|^2) $$\nwhere $c_{\\max} = 1/\\sqrt{\\mu\\epsilon_{\\min}}$. The maximum value for $|\\tilde{\\mathbf{k}}|^2$ occurs when $\\sin^2$ terms are $1$:\n$$ \\max(|\\tilde{\\mathbf{k}}|^2) = \\left(\\frac{2}{\\Delta x}\\right)^2 + \\left(\\frac{2}{\\Delta y}\\right)^2 + \\left(\\frac{2}{\\Delta z}\\right)^2 $$\nSubstituting this into the stability condition $\\sin^2(\\omega\\Delta t/2) \\le 1$:\n$$ \\frac{\\Delta t^2}{4} c_{\\max}^2 \\left( \\left(\\frac{2}{\\Delta x}\\right)^2 + \\left(\\frac{2}{\\Delta y}\\right)^2 + \\left(\\frac{2}{\\Delta z}\\right)^2 \\right) \\le 1 $$\n$$ \\Delta t^2 c_{\\max}^2 \\left( \\frac{1}{\\Delta x^2} + \\frac{1}{\\Delta y^2} + \\frac{1}{\\Delta z^2} \\right) \\le 1 $$\nThis yields the sharp Courant-Friedrichs-Lewy (CFL) stability condition for the anisotropic Yee scheme:\n$$ \\Delta t \\le \\frac{1}{c_{\\max} \\sqrt{\\left(\\frac{1}{\\Delta x}\\right)^2 + \\left(\\frac{1}{\\Delta y}\\right)^2 + \\left(\\frac{1}{\\Delta z}\\right)^2}} $$\nThis confirms the required expression. As shown before, the dissipative term from $\\sigma$ only removes energy, so this bound, derived for the lossless case, remains the constraint for the lossy case.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the maximum stable FDTD time step (Δt_max) for several test cases\n    of electromagnetic wave propagation in anisotropic, lossy media.\n    \"\"\"\n    \n    # Physical constants\n    epsilon_0 = 8.854187817e-12  # F/m\n    mu_0 = 4 * np.pi * 1e-7      # H/m\n    c_0 = 1 / np.sqrt(mu_0 * epsilon_0) # Speed of light in vacuum\n\n    test_cases = [\n        {\n            \"grid\": (1.0e-3, 1.0e-3, 1.0e-3),\n            \"mu\": mu_0,\n            \"epsilon_tensors\": [\n                np.diag([2*epsilon_0, 3*epsilon_0, 4*epsilon_0]),\n                np.diag([2.5*epsilon_0, 2.5*epsilon_0, 2.5*epsilon_0]),\n                np.diag([3*epsilon_0, 4*epsilon_0, 5*epsilon_0])\n            ],\n            \"sigmas\": [0, 1e3, 5e3] # Not used in stability calculation\n        },\n        {\n            \"grid\": (1.0e-3, 1.0e-3, 1.0e-3),\n            \"mu\": mu_0,\n            \"epsilon_tensors\": [\n                np.diag([epsilon_0, 2*epsilon_0, 5*epsilon_0]),\n                np.diag([1.2*epsilon_0, 3*epsilon_0, 4*epsilon_0])\n            ],\n            \"sigmas\": [1e8, 1e6]\n        },\n        {\n            \"grid\": (2.0e-3, 2.0e-3, 2.0e-3),\n            \"mu\": mu_0,\n            \"epsilon_tensors\": [\n                np.diag([0.5*epsilon_0, 2*epsilon_0, 2*epsilon_0]),\n                np.diag([0.6*epsilon_0, 1.8*epsilon_0, 2.2*epsilon_0])\n            ],\n            \"sigmas\": [1e4, 1e5]\n        },\n        {\n            \"grid\": (5.0e-4, 5.0e-4, 5.0e-5),\n            \"mu\": mu_0,\n            \"epsilon_tensors\": [\n                np.diag([3*epsilon_0, 3*epsilon_0, 3*epsilon_0])\n            ],\n            \"sigmas\": [1e3]\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        dx, dy, dz = case[\"grid\"]\n        mu = case[\"mu\"]\n        epsilon_tensors = case[\"epsilon_tensors\"]\n\n        # Find the global minimum of the smallest eigenvalues of the permittivity tensors.\n        # For diagonal tensors, eigenvalues are the diagonal elements.\n        min_eigenvalues = []\n        for tensor in epsilon_tensors:\n            # We can use np.linalg.eigvalsh for symmetric matrices,\n            # or just take the min of the diagonal for diagonal matrices.\n            # As the problem states the tensors are symmetric positive definite,\n            # eigenvalues are real and positive.\n            if np.count_nonzero(tensor - np.diag(np.diagonal(tensor))) == 0:\n                # Optimized for diagonal matrix\n                eigenvalues = np.diagonal(tensor)\n            else:\n                # General case for symmetric matrices\n                eigenvalues = np.linalg.eigvalsh(tensor)\n            \n            min_eigenvalues.append(np.min(eigenvalues))\n        \n        epsilon_min = np.min(min_eigenvalues)\n\n        # Calculate the maximum characteristic speed in the medium\n        c_max = 1 / np.sqrt(mu * epsilon_min)\n\n        # Calculate the geometric term from the grid spacings\n        grid_term = np.sqrt((1/dx)**2 + (1/dy)**2 + (1/dz)**2)\n\n        # Calculate the maximum stable time step from the derived CFL condition\n        dt_max = 1 / (c_max * grid_term)\n        \n        results.append(dt_max)\n\n    # Format the final output as a comma-separated list in brackets.\n    print(f\"[{','.join(f'{r:.12e}' for r in results)}]\")\n\nsolve()\n```", "id": "3295110"}]}