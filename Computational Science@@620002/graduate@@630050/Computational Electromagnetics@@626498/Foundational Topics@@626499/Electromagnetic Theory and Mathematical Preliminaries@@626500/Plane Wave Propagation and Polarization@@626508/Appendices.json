{"hands_on_practices": [{"introduction": "Understanding the polarization of an electromagnetic wave is fundamental to nearly all aspects of electromagnetics, from antenna design to optical communications. This first exercise [@problem_id:3341066] takes you back to first principles, asking you to derive the geometric properties of the polarization ellipse directly from the superposition of two orthogonal, time-harmonic field components. By connecting the component amplitudes ($E_{0x}, E_{0y}$) and their phase difference ($\\delta$) to the ellipse's shape, size, and rotational sense, you will solidify your understanding of how we mathematically describe and physically interpret wave polarization.", "problem": "A time-harmonic, source-free plane electromagnetic wave propagates in a homogeneous, isotropic, lossless medium along the $+z$ direction. At a fixed point in space, the instantaneous electric field vector in the transverse plane is given by the superposition of two orthogonal components\n$$\nE_{x}(t)=E_{0x}\\cos\\left(\\omega t-kz\\right),\\qquad E_{y}(t)=E_{0y}\\cos\\left(\\omega t-kz+\\delta\\right),\n$$\nwith $E_{0x}>0$, $E_{0y}>0$, and real phase difference $\\delta$. By the superposition of these two harmonic components, the tip of the electric field vector traces a polarization ellipse in the $xy$-plane.\n\nStarting from the representation above and only the fundamental laws that (i) Maxwell’s equations in a homogeneous medium admit plane-wave solutions with transverse fields and (ii) the instantaneous fields are the real parts of time-harmonic phasors, derive the implicit equation of the polarization ellipse as a quadratic form in $E_{x}$ and $E_{y}$. Then, by diagonalizing that quadratic form, obtain general expressions for the semi-major and semi-minor axis lengths in terms of $E_{0x}$, $E_{0y}$, and $\\delta$, and determine the sense of rotation of the field vector with increasing time at fixed $z$.\n\nSpecialize your result to the case $E_{0x}=2~\\text{V/m}$, $E_{0y}=1~\\text{V/m}$, and $\\delta=\\pi/2$. Report:\n- the semi-major axis length $a$,\n- the semi-minor axis length $b$,\n- and a scalar rotation-sense code $s$ defined as $s=+1$ for clockwise (right-handed under the Institute of Electrical and Electronics Engineers (IEEE) convention, i.e., when viewed looking in the direction of propagation $+z$) and $s=-1$ for counterclockwise (left-handed under the IEEE convention).\n\nExpress $a$ and $b$ in $\\text{V/m}$. Give your final result as a row matrix $\\begin{pmatrix}a & b & s\\end{pmatrix}$ with exact values (no rounding).", "solution": "The problem statement will first be validated for scientific soundness, consistency, and completeness.\n\n### Step 1: Extract Givens\n- **Wave Type**: Time-harmonic, source-free plane electromagnetic wave.\n- **Medium**: Homogeneous, isotropic, lossless.\n- **Propagation Direction**: Along the $+z$ direction.\n- **Electric Field Components**: At a fixed point in space, the instantaneous transverse electric field components are:\n  - $E_{x}(t)=E_{0x}\\cos\\left(\\omega t-kz\\right)$\n  - $E_{y}(t)=E_{0y}\\cos\\left(\\omega t-kz+\\delta\\right)$\n- **Parameters**: $E_{0x}>0$, $E_{0y}>0$, $\\delta$ is a real phase difference.\n- **Derivation Requirements**:\n  1. Derive the implicit equation of the polarization ellipse as a quadratic form in $E_{x}$ and $E_{y}$.\n  2. By diagonalizing the quadratic form, obtain general expressions for the semi-major ($a$) and semi-minor ($b$) axis lengths in terms of $E_{0x}$, $E_{0y}$, and $\\delta$.\n  3. Determine the sense of rotation of the field vector with increasing time at fixed $z$.\n- **Specific Case**:\n  - $E_{0x}=2~\\text{V/m}$\n  - $E_{0y}=1~\\text{V/m}$\n  - $\\delta=\\pi/2$\n- **Required Output**: For the specific case, report:\n  - Semi-major axis length $a$.\n  - Semi-minor axis length $b$.\n  - Rotation-sense code $s$, where $s=+1$ for clockwise (CW, right-handed) and $s=-1$ for counterclockwise (CCW, left-handed), viewed looking in the direction of propagation.\n- **Result Format**: A row matrix $\\begin{pmatrix}a & b & s\\end{pmatrix}$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is a standard exercise in the study of electromagnetic wave polarization, a core topic in physics and engineering.\n- **Scientifically Grounded**: The problem is based on Maxwell's equations and their plane-wave solutions, which are fundamental principles of classical electromagnetism. The representation of an elliptically polarized wave as a superposition of two orthogonal linearly polarized components is a standard and correct formulation.\n- **Well-Posed**: The problem provides all necessary information to derive the requested quantities. The relationships between the component amplitudes and phase difference, and the properties of the polarization ellipse, are well-defined. A unique, stable, and meaningful solution exists.\n- **Objective**: The language is precise and quantitative. The definitions for the rotation-sense code $s$ and the viewing convention (IEEE) are explicitly stated, removing ambiguity.\n\n### Step 3: Verdict and Action\nThe problem is **valid**. It is a well-defined, self-contained, and scientifically sound problem from the field of electromagnetics. I will proceed with the solution.\n\n### Derivation of the Polarization Ellipse Equation\nLet us analyze the field at a fixed plane, e.g., $z=0$. The dependence on $z$ can be absorbed into a phase shift of the time origin, so this choice does not affect the shape or orientation of the ellipse. Let $\\phi = \\omega t - kz$. The field components are:\n$$\nE_x = E_{0x}\\cos(\\phi) \\label{eq:1}\n$$\n$$\nE_y = E_{0y}\\cos(\\phi + \\delta) \\label{eq:2}\n$$\nFrom the first equation, we have $\\cos(\\phi) = \\frac{E_x}{E_{0x}}$. We also know that $\\sin(\\phi) = \\pm\\sqrt{1-\\cos^2(\\phi)} = \\pm\\sqrt{1-(\\frac{E_x}{E_{0x}})^2}$.\nExpanding the second equation using the cosine addition formula:\n$$\nE_y = E_{0y}(\\cos\\phi\\cos\\delta - \\sin\\phi\\sin\\delta)\n$$\nDividing by $E_{0y}$ and substituting for $\\cos\\phi$:\n$$\n\\frac{E_y}{E_{0y}} = \\frac{E_x}{E_{0x}}\\cos\\delta - \\sin\\phi\\sin\\delta\n$$\nIsolating the $\\sin\\phi$ term and squaring both sides:\n$$\n\\left(\\frac{E_y}{E_{0y}} - \\frac{E_x}{E_{0x}}\\cos\\delta\\right)^2 = (\\sin\\phi\\sin\\delta)^2 = \\sin^2\\phi\\sin^2\\delta\n$$\nSubstitute $\\sin^2\\phi = 1 - (\\frac{E_x}{E_{0x}})^2$:\n$$\n\\left(\\frac{E_y}{E_{0y}}\\right)^2 - 2\\frac{E_x E_y}{E_{0x}E_{0y}}\\cos\\delta + \\left(\\frac{E_x}{E_{0x}}\\right)^2\\cos^2\\delta = \\left(1 - \\left(\\frac{E_x}{E_{0x}}\\right)^2\\right)\\sin^2\\delta\n$$\n$$\n\\left(\\frac{E_y}{E_{0y}}\\right)^2 - 2\\frac{E_x E_y}{E_{0x}E_{0y}}\\cos\\delta + \\left(\\frac{E_x}{E_{0x}}\\right)^2\\cos^2\\delta = \\sin^2\\delta - \\left(\\frac{E_x}{E_{0x}}\\right)^2\\sin^2\\delta\n$$\nGrouping the terms involving $E_x^2$:\n$$\n\\left(\\frac{E_x}{E_{0x}}\\right)^2(\\cos^2\\delta + \\sin^2\\delta) + \\left(\\frac{E_y}{E_{0y}}\\right)^2 - 2\\frac{E_x E_y}{E_{0x}E_{0y}}\\cos\\delta = \\sin^2\\delta\n$$\nUsing the identity $\\cos^2\\delta + \\sin^2\\delta = 1$, we arrive at the implicit equation of the polarization ellipse:\n$$\n\\left(\\frac{E_x}{E_{0x}}\\right)^2 - 2\\frac{E_x E_y}{E_{0x}E_{0y}}\\cos\\delta + \\left(\\frac{E_y}{E_{0y}}\\right)^2 = \\sin^2\\delta\n$$\nThis is a quadratic form in $E_x$ and $E_y$, as requested.\n\n### Derivation of Semi-Major and Semi-Minor Axes\nThe problem requests deriving the semi-axes by diagonalizing the quadratic form. An equivalent and more physically intuitive method is to find the minimum and maximum values of the magnitude squared of the electric field vector, $E^2 = E_x^2 + E_y^2$, as time evolves. These extrema correspond to the squares of the semi-minor ($b$) and semi-major ($a$) axes, respectively. This procedure is mathematically equivalent to the geometric rotation that diagonalizes the system.\n\nLet $I(\\phi) = E^2(\\phi) = E_x^2(\\phi) + E_y^2(\\phi)$.\n$$\nI(\\phi) = E_{0x}^2\\cos^2\\phi + E_{0y}^2\\cos^2(\\phi+\\delta)\n$$\nUsing the identity $\\cos^2\\theta = \\frac{1+\\cos(2\\theta)}{2}$:\n$$\nI(\\phi) = \\frac{E_{0x}^2}{2}(1+\\cos(2\\phi)) + \\frac{E_{0y}^2}{2}(1+\\cos(2\\phi+2\\delta))\n$$\n$$\nI(\\phi) = \\frac{1}{2}(E_{0x}^2+E_{0y}^2) + \\frac{1}{2}[E_{0x}^2\\cos(2\\phi) + E_{0y}^2\\cos(2\\phi+2\\delta)]\n$$\nExpanding the last term:\n$$\nI(\\phi) = \\frac{1}{2}(E_{0x}^2+E_{0y}^2) + \\frac{1}{2}[E_{0x}^2\\cos(2\\phi) + E_{0y}^2(\\cos(2\\phi)\\cos(2\\delta) - \\sin(2\\phi)\\sin(2\\delta))]\n$$\n$$\nI(\\phi) = \\frac{1}{2}(E_{0x}^2+E_{0y}^2) + \\frac{1}{2}[\\cos(2\\phi)(E_{0x}^2+E_{0y}^2\\cos(2\\delta)) - \\sin(2\\phi)(E_{0y}^2\\sin(2\\delta))]\n$$\nThis expression is of the form $C_0 + C_1\\cos(2\\phi) - C_2\\sin(2\\phi)$, which describes a sinusoid. Its extrema are $C_0 \\pm \\sqrt{C_1^2+C_2^2}$. The amplitude of the time-varying part is:\n$$\nR = \\frac{1}{2}\\sqrt{(E_{0x}^2+E_{0y}^2\\cos(2\\delta))^2 + (E_{0y}^2\\sin(2\\delta))^2}\n$$\n$$\nR = \\frac{1}{2}\\sqrt{E_{0x}^4 + 2E_{0x}^2E_{0y}^2\\cos(2\\delta) + E_{0y}^4\\cos^2(2\\delta) + E_{0y}^4\\sin^2(2\\delta)}\n$$\n$$\nR = \\frac{1}{2}\\sqrt{E_{0x}^4 + E_{0y}^4 + 2E_{0x}^2E_{0y}^2\\cos(2\\delta)}\n$$\nThe maximum and minimum values of $I(\\phi)$ are the squares of the semi-axes, $a^2$ and $b^2$:\n$$\na^2 = I_{max} = \\frac{1}{2}(E_{0x}^2+E_{0y}^2) + R = \\frac{1}{2}\\left(E_{0x}^2+E_{0y}^2 + \\sqrt{E_{0x}^4 + E_{0y}^4 + 2E_{0x}^2E_{0y}^2\\cos(2\\delta)}\\right)\n$$\n$$\nb^2 = I_{min} = \\frac{1}{2}(E_{0x}^2+E_{0y}^2) - R = \\frac{1}{2}\\left(E_{0x}^2+E_{0y}^2 - \\sqrt{E_{0x}^4 + E_{0y}^4 + 2E_{0x}^2E_{0y}^2\\cos(2\\delta)}\\right)\n$$\nTaking the square root gives the lengths of the semi-major axis $a$ and semi-minor axis $b$.\n\n### Determination of the Sense of Rotation\nThe sense of rotation at a fixed position $z$ as time $t$ increases can be determined by examining the sign of the $z$-component of the cross product $\\mathbf{E}(t) \\times \\frac{d\\mathbf{E}(t)}{dt}$. The vector $\\frac{d\\mathbf{E}(t)}{dt}$ is tangent to the path of the tip of $\\mathbf{E}(t)$. A positive $z$-component corresponds to CCW rotation (from $+x$ to $+y$), and a negative $z$-component to CW rotation.\n\nLet $\\phi(t) = \\omega t - kz$. The velocity vector is $\\frac{d\\mathbf{E}}{dt} = \\omega\\frac{d\\mathbf{E}}{d\\phi}$.\n$\\frac{dE_x}{d\\phi} = -E_{0x}\\sin\\phi$ and $\\frac{dE_y}{d\\phi} = -E_{0y}\\sin(\\phi+\\delta)$.\nThe $z$-component of $\\mathbf{E} \\times \\frac{d\\mathbf{E}}{d\\phi}$ is:\n$$\n\\left(\\mathbf{E} \\times \\frac{d\\mathbf{E}}{d\\phi}\\right)_z = E_x \\frac{dE_y}{d\\phi} - E_y \\frac{dE_x}{d\\phi}\n$$\n$$\n= (E_{0x}\\cos\\phi)(-E_{0y}\\sin(\\phi+\\delta)) - (E_{0y}\\cos(\\phi+\\delta))(-E_{0x}\\sin\\phi)\n$$\n$$\n= -E_{0x}E_{0y}[\\cos\\phi\\sin(\\phi+\\delta) - \\cos(\\phi+\\delta)\\sin\\phi]\n$$\nUsing the trigonometric identity $\\sin(A-B) = \\sin A\\cos B - \\cos A\\sin B$ with $A = \\phi+\\delta$ and $B = \\phi$:\n$$\n\\left(\\mathbf{E} \\times \\frac{d\\mathbf{E}}{d\\phi}\\right)_z = -E_{0x}E_{0y}\\sin((\\phi+\\delta)-\\phi) = -E_{0x}E_{0y}\\sin\\delta\n$$\nThe corresponding component of $\\mathbf{E} \\times \\frac{d\\mathbf{E}}{dt}$ is $\\omega(-E_{0x}E_{0y}\\sin\\delta)$. Since $E_{0x}, E_{0y}, \\omega$ are positive, the sign is determined entirely by $-\\sin\\delta$.\n- If $\\sin\\delta > 0$, the cross product is in the $-z$ direction, indicating a **clockwise (CW)** rotation. This corresponds to $s=+1$.\n- If $\\sin\\delta < 0$, the cross product is in the $+z$ direction, indicating a **counterclockwise (CCW)** rotation. This corresponds to $s=-1$.\n- If $\\sin\\delta = 0$, the polarization is linear and there is no rotation.\n\nTherefore, the rotation-sense code is $s = \\text{sgn}(\\sin\\delta)$.\n\n### Specialization to the Given Case\nWe are given $E_{0x}=2~\\text{V/m}$, $E_{0y}=1~\\text{V/m}$, and $\\delta=\\pi/2$.\n\n**Semi-axes $a$ and $b$**:\nFor $\\delta = \\pi/2$, we have $2\\delta=\\pi$, so $\\cos(2\\delta) = \\cos(\\pi) = -1$.\n$$\na^2 = \\frac{1}{2}\\left(2^2+1^2 + \\sqrt{2^4+1^4+2(2^2)(1^2)(-1)}\\right)\n$$\n$$\na^2 = \\frac{1}{2}\\left(4+1 + \\sqrt{16+1-8}\\right) = \\frac{1}{2}\\left(5 + \\sqrt{9}\\right) = \\frac{1}{2}(5+3) = 4\n$$\n$$\na = \\sqrt{4} = 2~\\text{V/m}\n$$\n$$\nb^2 = \\frac{1}{2}\\left(2^2+1^2 - \\sqrt{2^4+1^4+2(2^2)(1^2)(-1)}\\right)\n$$\n$$\nb^2 = \\frac{1}{2}\\left(5 - \\sqrt{9}\\right) = \\frac{1}{2}(5-3) = 1\n$$\n$$\nb = \\sqrt{1} = 1~\\text{V/m}\n$$\nA simpler check for this special case: when $\\delta=\\pm\\pi/2$, $\\cos\\delta=0$, the ellipse equation becomes $\\left(\\frac{E_x}{E_{0x}}\\right)^2 + \\left(\\frac{E_y}{E_{0y}}\\right)^2 = 1$. This is the equation of an ellipse whose axes are aligned with the coordinate axes, with semi-axes equal to $E_{0x}$ and $E_{0y}$. The semi-major axis $a$ is the larger of the two, and the semi-minor axis $b$ is the smaller. Thus, $a = \\max(E_{0x}, E_{0y}) = 2~\\text{V/m}$ and $b = \\min(E_{0x}, E_{0y}) = 1~\\text{V/m}$. This confirms the result.\n\n**Rotation-sense code $s$**:\nThe sense of rotation is given by $s = \\text{sgn}(\\sin\\delta)$.\nFor $\\delta=\\pi/2$, $\\sin\\delta = \\sin(\\pi/2) = 1$.\n$$\ns = \\text{sgn}(1) = +1\n$$\nThis indicates a clockwise (right-handed) rotation.\n\nThe final result is the row matrix $\\begin{pmatrix}a & b & s\\end{pmatrix}$ with the calculated values.\n$a=2$, $b=1$, $s=1$.", "answer": "$$\\boxed{\\begin{pmatrix} 2 & 1 & 1 \\end{pmatrix}}$$", "id": "3341066"}, {"introduction": "When a wave interacts with an interface, its behavior can be more complex than simple ray optics suggests. This practice [@problem_id:3341028] delves into the Goos-Hänchen effect, a subtle but important phenomenon where a totally internally reflected beam experiences a lateral shift along the interface. By applying the stationary phase principle, you will derive this shift from the phase of the Fresnel reflection coefficient, revealing a deep connection between a wave's phase response and its spatial propagation path. This concept is crucial for accurately modeling wave beams in integrated optics and other waveguiding systems.", "problem": "A monochromatic Gaussian beam of free-space wavelength $\\lambda_{0}$ propagates in a lossless, homogeneous, isotropic, nonmagnetic dielectric of refractive index $n_{1}$ and impinges on a planar interface with a lower-index dielectric of refractive index $n_{2}$, with $n_{1} > n_{2}$. The polarization is transverse electric (TE), meaning the electric field is perpendicular to the plane of incidence. The angle of incidence $\\theta_{i}$ is slightly above the critical angle $\\theta_{c}$ defined by $\\sin(\\theta_{c}) = n_{2}/n_{1}$, specifically $\\theta_{i} = \\theta_{c} + 0.5$ degrees. All angles used in calculus operations must be in radians. Assume a narrow angular spectrum for the beam so that the stationary phase approximation applies to the reflected field.\n\nStarting from Maxwell’s equations in source-free media and the tangential-field boundary conditions at the interface, derive the TE Fresnel reflection coefficient under conditions of total internal reflection and its phase as a function of $\\theta_{i}$. Then, model the reflected beam as an angular superposition of plane waves and, using the stationary phase principle, obtain a closed-form analytic expression for the Goos–Hänchen lateral shift $\\Delta$ of the beam centroid along the interface, expressed in terms of $n_{1}$, $n_{2}$, $\\theta_{i}$, and the free-space wavenumber $k_{0} = 2\\pi/\\lambda_{0}$. Evaluate $\\Delta$ numerically for $n_{1} = 1.5$, $n_{2} = 1.0$, and $\\lambda_{0} = 633$ nm. Express the final lateral shift in micrometers and round your answer to two significant figures.", "solution": "The user has provided a valid problem statement in the field of computational electromagnetics, specifically concerning the Goos–Hänchen effect for a Gaussian beam undergoing total internal reflection (TIR). I will proceed with a full derivation and solution.\n\nThe problem is addressed in three parts:\n1.  Derivation of the TE Fresnel reflection coefficient $r_{TE}$ and its phase $\\phi_{TE}$ under TIR.\n2.  Derivation of the Goos–Hänchen lateral shift $\\Delta$ using the stationary phase approximation.\n3.  Numerical evaluation of $\\Delta$ for the given parameters.\n\n### Part 1: TE Fresnel Reflection Coefficient and Phase\n\nWe begin with the time-harmonic Maxwell's equations in a source-free, lossless, nonmagnetic, isotropic medium:\n$$ \\nabla \\times \\vec{E} = i\\omega\\mu_0 \\vec{H} $$\n$$ \\nabla \\times \\vec{H} = -i\\omega\\epsilon \\vec{E} $$\nThese combine to form the Helmholtz equation for the electric field $\\vec{E}$:\n$$ \\nabla^2 \\vec{E} + k^2 \\vec{E} = 0 $$\nwhere the wavenumber is $k = n k_0$, with $n$ being the refractive index and $k_0 = 2\\pi/\\lambda_0$ the free-space wavenumber.\n\nLet the interface between the two dielectric media be the plane $z=0$. Medium 1 ($n_1$) is in the region $z<0$ and medium 2 ($n_2$) is in the region $z>0$. The plane of incidence is the $xz$-plane. For Transverse Electric (TE) polarization, the electric field is perpendicular to the plane of incidence, i.e., $\\vec{E} = E_y \\hat{y}$.\n\nAt the interface, we consider an incident, a reflected, and a transmitted plane wave:\n-   Incident: $\\vec{E}_i = \\hat{y} E_{0i} \\exp[i(k_{ix}x + k_{iz}z)]$\n-   Reflected: $\\vec{E}_r = \\hat{y} E_{0r} \\exp[i(k_{rx}x + k_{rz}z)]$\n-   Transmitted: $\\vec{E}_t = \\hat{y} E_{0t} \\exp[i(k_{tx}x + k_{tz}z)]$\n\nThe associated magnetic fields are found from $\\vec{H} = (i\\omega\\mu_0)^{-1} \\nabla \\times \\vec{E}$. We only need the tangential component $H_x$:\n$$ H_x = \\frac{1}{i\\omega\\mu_0} \\frac{\\partial E_y}{\\partial z} $$\n\nThe boundary conditions at $z=0$ require the tangential components of $\\vec{E}$ and $\\vec{H}$ to be continuous. This implies phase matching along the interface, $k_{ix} = k_{rx} = k_{tx} \\equiv k_x$. From the geometry of incidence at angle $\\theta_i$, we have $k_x = k_1 \\sin\\theta_i = n_1 k_0 \\sin\\theta_i$. The $z$-components of the wavevectors are $k_{iz} = n_1 k_0 \\cos\\theta_i$, $k_{rz} = -n_1 k_0 \\cos\\theta_i$, and $k_{tz} = \\sqrt{k_2^2 - k_x^2} = k_0\\sqrt{n_2^2 - n_1^2 \\sin^2\\theta_i}$.\n\nApplying the boundary conditions at $z=0$:\n1.  Continuity of $E_y$: $E_{0i} + E_{0r} = E_{0t}$\n2.  Continuity of $H_x$: $k_{iz} E_{0i} + k_{rz} E_{0r} = k_{tz} E_{0t}$\n\nSubstituting $k_{iz} = -k_{rz} = n_1 k_0 \\cos\\theta_i$ into the second equation:\n$$ n_1 k_0 \\cos\\theta_i (E_{0i} - E_{0r}) = k_{tz} E_{0t} $$\nLetting $r_{TE} = E_{0r}/E_{0i}$ and $t_{TE} = E_{0t}/E_{0i}$, we get the system:\n1.  $1 + r_{TE} = t_{TE}$\n2.  $n_1 k_0 \\cos\\theta_i (1 - r_{TE}) = k_{tz} (1 + r_{TE})$\n\nSolving for $r_{TE}$:\n$$ r_{TE} = \\frac{n_1 k_0 \\cos\\theta_i - k_{tz}}{n_1 k_0 \\cos\\theta_i + k_{tz}} = \\frac{n_1 \\cos\\theta_i - \\sqrt{n_2^2 - n_1^2 \\sin^2\\theta_i}}{n_1 \\cos\\theta_i + \\sqrt{n_2^2 - n_1^2 \\sin^2\\theta_i}} $$\nTotal internal reflection (TIR) occurs when $\\theta_i > \\theta_c$, where $\\sin\\theta_c = n_2/n_1$. In this regime, $n_1 \\sin\\theta_i > n_2$, making the term inside the square root negative. The $z$-component of the transmitted wavevector becomes purely imaginary:\n$$ k_{tz} = i k_0 \\sqrt{n_1^2 \\sin^2\\theta_i - n_2^2} \\equiv i\\alpha $$\nwhere $\\alpha = k_0 \\sqrt{n_1^2 \\sin^2\\theta_i - n_2^2}$ is real and positive. The transmitted wave is an evanescent wave that decays exponentially in the $z>0$ region.\n\nSubstituting $k_{tz} = i\\alpha$ into the expression for $r_{TE}$:\n$$ r_{TE} = \\frac{n_1 k_0 \\cos\\theta_i - i\\alpha}{n_1 k_0 \\cos\\theta_i + i\\alpha} $$\nThis is a complex number of the form $(A-iB)/(A+iB)$, whose modulus is $|r_{TE}| = 1$, as expected for TIR in a lossless medium. The reflection is total, but it introduces a phase shift $\\phi_{TE}$. We can write $r_{TE} = \\exp(i\\phi_{TE})$.\nThe phase is given by:\n$$ \\phi_{TE} = \\arg(n_1 k_0 \\cos\\theta_i - i\\alpha) - \\arg(n_1 k_0 \\cos\\theta_i + i\\alpha) $$\nLetting $\\tan\\delta = \\alpha / (n_1 k_0 \\cos\\theta_i)$, we have $\\phi_{TE} = -\\delta - \\delta = -2\\delta$. Thus, the phase of the TE reflection coefficient is:\n$$ \\phi_{TE}(\\theta_i) = -2 \\arctan\\left(\\frac{\\alpha}{n_1 k_0 \\cos\\theta_i}\\right) = -2 \\arctan\\left(\\frac{\\sqrt{n_1^2 \\sin^2\\theta_i - n_2^2}}{n_1 \\cos\\theta_i}\\right) $$\n\n### Part 2: Goos–Hänchen Shift\n\nA spatially bounded beam, such as a Gaussian beam, can be represented as a superposition of plane waves, each with a slightly different angle of incidence and a corresponding wavevector component $k_x$. The reflected beam profile $E_r(x)$ at the interface $z=0$ is given by the Fourier integral:\n$$ E_r(x) = \\int \\tilde{E}_i(k_x) r_{TE}(k_x) e^{ik_x x} dk_x $$\nwhere $\\tilde{E}_i(k_x)$ is the angular spectrum of the incident beam, and $r_{TE}(k_x) = \\exp[i\\phi_{TE}(k_x)]$ is the reflection coefficient for each plane wave component.\n$$ E_r(x) = \\int \\tilde{E}_i(k_x) \\exp[i(k_x x + \\phi_{TE}(k_x))] dk_x $$\nThe stationary phase approximation states that for a narrow-band spectrum centered at $k_{x,0}$, the integral is dominated by the point where the phase is stationary. The centroid of the reflected beam is found at the position $x$ where the derivative of the total phase $\\Phi(k_x) = k_x x + \\phi_{TE}(k_x)$ with respect to $k_x$ is zero:\n$$ \\frac{d\\Phi}{dk_x} = x + \\frac{d\\phi_{TE}}{dk_x} = 0 $$\nThis gives the lateral shift of the beam centroid, $\\Delta$, as:\n$$ \\Delta = -\\left. \\frac{d\\phi_{TE}}{dk_x} \\right|_{k_x = k_{x,0}} $$\nwhere $k_{x,0} = n_1 k_0 \\sin\\theta_i$ corresponds to the central angle of incidence $\\theta_i$. We use the chain rule to evaluate the derivative:\n$$ \\Delta = -\\frac{d\\phi_{TE}}{d\\theta_i} \\frac{d\\theta_i}{dk_x} $$\nWe have $k_x = n_1 k_0 \\sin\\theta_i$, so $\\frac{dk_x}{d\\theta_i} = n_1 k_0 \\cos\\theta_i$. Therefore, $\\frac{d\\theta_i}{dk_x} = \\frac{1}{n_1 k_0 \\cos\\theta_i}$.\n\nNext, we differentiate $\\phi_{TE}(\\theta_i)$:\n$$ \\frac{d\\phi_{TE}}{d\\theta_i} = \\frac{d}{d\\theta_i} \\left[ -2 \\arctan\\left(\\frac{\\sqrt{n_1^2 \\sin^2\\theta_i - n_2^2}}{n_1 \\cos\\theta_i}\\right) \\right] $$\nUsing $\\frac{d}{dx}\\arctan(u) = \\frac{u'}{1+u^2}$, and after careful calculation, this derivative evaluates to:\n$$ \\frac{d\\phi_{TE}}{d\\theta_i} = - \\frac{2 n_1 \\sin\\theta_i}{\\sqrt{n_1^2 \\sin^2\\theta_i - n_2^2}} $$\nSubstituting these results into the expression for $\\Delta$:\n$$ \\Delta = - \\left( - \\frac{2 n_1 \\sin\\theta_i}{\\sqrt{n_1^2 \\sin^2\\theta_i - n_2^2}} \\right) \\left( \\frac{1}{n_1 k_0 \\cos\\theta_i} \\right) $$\nThe factor $n_1$ cancels, giving the closed-form expression for the Goos-Hänchen shift:\n$$ \\Delta = \\frac{2 \\sin\\theta_i}{k_0 \\cos\\theta_i \\sqrt{n_1^2 \\sin^2\\theta_i - n_2^2}} $$\nThis can also be written in terms of $\\lambda_0$ and $\\tan\\theta_i$:\n$$ \\Delta = \\frac{\\lambda_0}{\\pi} \\frac{\\tan\\theta_i}{\\sqrt{n_1^2 \\sin^2\\theta_i - n_2^2}} $$\n\n### Part 3: Numerical Evaluation\n\nWe are given the following parameters:\n-   $n_1 = 1.5$\n-   $n_2 = 1.0$\n-   $\\lambda_0 = 633 \\text{ nm} = 6.33 \\times 10^{-7} \\text{ m}$\n\nFirst, we calculate the critical angle $\\theta_c$:\n$$ \\sin\\theta_c = \\frac{n_2}{n_1} = \\frac{1.0}{1.5} = \\frac{2}{3} $$\n$$ \\theta_c = \\arcsin\\left(\\frac{2}{3}\\right) \\approx 41.8103^\\circ $$\nThe angle of incidence $\\theta_i$ is given as:\n$$ \\theta_i = \\theta_c + 0.5^\\circ \\approx 41.8103^\\circ + 0.5^\\circ = 42.3103^\\circ $$\nWe need the trigonometric values for this angle:\n$$ \\sin\\theta_i = \\sin(42.3103^\\circ) \\approx 0.67315 $$\n$$ \\cos\\theta_i = \\cos(42.3103^\\circ) \\approx 0.73943 $$\nThe free-space wavenumber is:\n$$ k_0 = \\frac{2\\pi}{\\lambda_0} = \\frac{2\\pi}{6.33 \\times 10^{-7} \\text{ m}} \\approx 9.926 \\times 10^6 \\text{ m}^{-1} $$\nNow we evaluate the denominator term $\\sqrt{n_1^2 \\sin^2\\theta_i - n_2^2}$:\n$$ \\sqrt{(1.5)^2 (0.67315)^2 - (1.0)^2} = \\sqrt{2.25 \\times 0.45313 - 1.0} = \\sqrt{1.01954 - 1.0} = \\sqrt{0.01954} \\approx 0.13978 $$\nFinally, we substitute these values into the expression for $\\Delta$:\n$$ \\Delta = \\frac{2 \\times 0.67315}{(9.926 \\times 10^6 \\text{ m}^{-1}) \\times 0.73943 \\times 0.13978} $$\n$$ \\Delta = \\frac{1.3463}{1.026 \\times 10^6 \\text{ m}^{-1}} \\approx 1.312 \\times 10^{-6} \\text{ m} $$\nThe problem asks for the result in micrometers, rounded to two significant figures.\n$$ \\Delta \\approx 1.312 \\text{ µm} $$\nRounding to two significant figures gives:\n$$ \\Delta \\approx 1.3 \\text{ µm} $$", "answer": "$$\n\\boxed{1.3}\n$$", "id": "3341028"}, {"introduction": "In computational electromagnetics, accurately simulating wave propagation in unbounded domains requires artificial absorbing boundaries. This practice [@problem_id:3341069] tackles an advanced, practical problem: the design of a Perfectly Matched Layer (PML) optimized to absorb evanescent waves without introducing numerical instabilities. You will derive the key PML equations from Maxwell's equations under a complex coordinate stretch and then develop an algorithm to optimize the layer's performance. This exercise provides direct, hands-on experience in balancing the competing demands of accuracy and stability that define state-of-the-art computational modeling.", "problem": "Consider a frequency-domain absorbing half-space based on a stretched-coordinate Perfectly Matched Layer (PML) for two-dimensional plane waves that vary as $\\exp\\!\\left(i\\,q_x x + i\\,k_y y\\right)$ with invariant $z$-direction ($k_z = 0$). Let free space occupy $x < 0$ and the PML occupy $x \\ge 0$. The free-space parameters are $ \\epsilon_0 $ (electric permittivity in F/m), $ \\mu_0 $ (magnetic permeability in H/m), and $ c = 1/\\sqrt{\\epsilon_0 \\mu_0} $ (speed of light in m/s). The angular frequency is $ \\omega = 2\\pi f $ with $ f $ in Hz. Inside the PML, adopt a diagonal complex coordinate stretching tensor $ \\mathbf{s} = \\mathrm{diag}(s_x, s_y, s_z) $, with each $ s_\\alpha $ dimensionless and possibly complex. The equivalent anisotropic material tensors in the PML (in the principal basis) are obtained from the complex-stretch transformation, producing diagonal tensors $ \\bar{\\bar{\\epsilon}} = \\mathrm{diag}(\\epsilon_x, \\epsilon_y, \\epsilon_z) $ and $ \\bar{\\bar{\\mu}} = \\mathrm{diag}(\\mu_x, \\mu_y, \\mu_z) $.\n\nYour tasks are as follows.\n\n1) Starting from the frequency-domain Maxwell equations and the complex-coordinate stretching transformation, derive:\n- The expressions for the PML material tensor components $ \\epsilon_x, \\epsilon_y, \\epsilon_z $ and $ \\mu_x, \\mu_y, \\mu_z $ in terms of $ \\epsilon_0, \\mu_0 $ and $ s_x, s_y, s_z $.\n- The dispersion relations for the normal wavenumber $ q_x $ in the PML for the two decoupled polarizations with $ k_z = 0 $:\n  - Transverse Electric with nonzero $ E_z $ (denote this polarization as TE$_z$).\n  - Transverse Magnetic with nonzero $ H_z $ (denote this polarization as TM$_z$).\n  The dispersion relations must be expressed only in terms of $ \\epsilon_0, \\mu_0, \\epsilon_\\alpha, \\mu_\\alpha, \\omega, k_y $ and $ q_x $.\n- For each polarization, an expression for the tangential-field reflection coefficient (defined with respect to the tangential electric field amplitude at $ x = 0 $) for a single interface between free space ($ x < 0 $) and the PML ($ x \\ge 0 $), where the evanescent incident wave in free space has $ q_{x1}^2 = k_0^2 - k_y^2 $, with $ k_0 = \\omega \\sqrt{\\epsilon_0 \\mu_0} $. The expression should be reduced to a closed form in terms of $ \\epsilon_0, \\mu_0, \\epsilon_\\alpha, \\mu_\\alpha, \\omega, k_y, q_{x1}, q_{x2} $ for each polarization, where $ q_{x2} $ is the appropriate normal wavenumber in the PML obtained from the corresponding dispersion relation.\n\n2) Using your derived expressions, design an algorithm that optimizes the tangential stretching parameters $ s_y $ and $ s_z $ (restricted to be real, strictly positive, and chosen from a discrete candidate set specified below) for a fixed given normal-stretch parameter $ s_x \\in \\mathbb{C} $. The objective is to minimize the worst-case (largest) magnitude of the two reflection coefficients (TE$_z$ and TM$_z$) at the single interface, subject to the following stability and physicality conditions:\n- The incident wave is evanescent in free space: $ k_y^2 > k_0^2 $.\n- The transmitted wave in the PML decays as $ x \\to +\\infty $ for each polarization, i.e., the selected branch of $ q_{x2} $ must satisfy $ \\operatorname{Im}(q_{x2}) > 0 $ for both TE$_z$ and TM$_z$.\n- The stretching factors $ s_y $ and $ s_z $ must lie in a prescribed discrete set $ \\mathcal{S} $ of real values greater than $ 1 $, which is provided below, reflecting a stability requirement imposed to mitigate evanescent-wave related late-time growth in time-domain implementations.\n\n3) Implement the algorithm as a complete, runnable program that, for each test case in the provided test suite, performs an exhaustive search over all pairs $ (s_y, s_z) \\in \\mathcal{S} \\times \\mathcal{S} $ and returns the triple consisting of the optimal $ s_y $, the optimal $ s_z $, and the minimized worst-case reflection magnitude $ J^\\star = \\min_{s_y,s_z \\in \\mathcal{S}} \\max\\{ |R_{\\mathrm{TE}_z}|, |R_{\\mathrm{TM}_z}| \\} $. A candidate pair is infeasible and must be skipped if the decay condition $ \\operatorname{Im}(q_{x2}) \\le 0 $ fails for either polarization. If multiple feasible candidates achieve the same minimal value of $ J^\\star $ within a numerical tolerance of $ 10^{-12} $, choose among them the pair minimizing $ |s_y - 1| + |s_z - 1| $. If a tie still persists, choose the pair with the smallest $ s_y $, and if still tied, the smallest $ s_z $.\n\nAll physical quantities must be expressed in International System of Units (SI). Frequencies are in Hz, $ k_y $ is in $\\mathrm{m}^{-1}$, and the final reflection magnitudes are dimensionless real numbers. Angles are not used. The final numerical outputs must be reported as decimal floats.\n\nTest suite:\n- Global constants to use in all cases:\n  - $ \\epsilon_0 = 8.854187817\\times 10^{-12} \\ \\mathrm{F/m} $\n  - $ \\mu_0 = 4\\pi\\times 10^{-7} \\ \\mathrm{H/m} $\n  - Candidate set for tangential stretching: $ \\mathcal{S} = \\{ 1.2,\\ 1.5,\\ 2.0,\\ 3.0 \\} $\n  - Branch selection rule for square roots: for any complex $ \\zeta $, define $ \\sqrt{\\zeta} $ using the principal branch, and if $ \\operatorname{Im}(\\sqrt{\\zeta}) < 0 $, replace it with its negative to enforce $ \\operatorname{Im}(\\sqrt{\\zeta}) \\ge 0 $. A candidate is infeasible if the final selected root has $ \\operatorname{Im}(\\sqrt{\\zeta}) \\le 0 $ when this $ \\sqrt{\\zeta} $ is interpreted as $ q_{x2} $.\n\n- Case 1 (happy-path): $ f = 10\\,\\mathrm{GHz} $, $ s_x = 1 + i\\,1.0 $, and $ k_y = 1.30\\,k_0 $.\n- Case 2 (near-cutoff evanescence): $ f = 6\\,\\mathrm{GHz} $, $ s_x = 1 + i\\,0.3 $, and $ k_y = 1.05\\,k_0 $.\n- Case 3 (strong evanescence with stronger normal stretch): $ f = 12\\,\\mathrm{GHz} $, $ s_x = 2.0 + i\\,2.0 $, and $ k_y = 2.50\\,k_0 $.\n\nRequired final output format:\n- Your program should produce a single line of output containing the results for the three test cases as a comma-separated list enclosed in square brackets, with each test contributing the three values $ [s_y^\\star, s_z^\\star, J^\\star] $ appended in order. That is, the output must be a flat list with nine floats: $ [s_{y,1}^\\star, s_{z,1}^\\star, J_1^\\star, s_{y,2}^\\star, s_{z,2}^\\star, J_2^\\star, s_{y,3}^\\star, s_{z,3}^\\star, J_3^\\star] $. Each float must be rounded to six decimal places.", "solution": "The problem requires the derivation of key formulas for plane wave propagation in a stretched-coordinate Perfectly Matched Layer (PML) and the subsequent design of an algorithm to optimize the PML's performance. The entire process is grounded in the principles of frequency-domain electromagnetism.\n\nWe begin with the time-harmonic Maxwell's curl equations, assuming an $e^{i\\omega t}$ time dependence, in a source-free, linear, and isotropic medium like free space:\n$$ \\nabla \\times \\mathbf{E} = -i\\omega\\mu_0 \\mathbf{H} $$\n$$ \\nabla \\times \\mathbf{H} = i\\omega\\epsilon_0 \\mathbf{E} $$\nThe PML is constructed by a complex coordinate-stretching transformation in the frequency domain. For a Cartesian system, this is equivalent to replacing the spatial derivatives $\\frac{\\partial}{\\partial \\alpha}$ for $\\alpha \\in \\{x, y, z\\}$ with a stretched version $\\frac{1}{s_\\alpha}\\frac{\\partial}{\\partial \\alpha}$, where $s_\\alpha$ are the complex stretching factors. This transforms the curl operator $\\nabla \\times$ into a modified operator $\\tilde{\\nabla} \\times$. The equations in the PML medium, written in the original Cartesian coordinates, become:\n$$ \\tilde{\\nabla} \\times \\mathbf{E} = -i\\omega\\mu_0 \\mathbf{H} $$\n$$ \\tilde{\\nabla} \\times \\mathbf{H} = i\\omega\\epsilon_0 \\mathbf{E} $$\nTo represent this as a standard Maxwell's system in an anisotropic medium, i.e., $\\nabla \\times \\mathbf{E} = -i\\omega\\bar{\\bar{\\mu}}\\cdot\\mathbf{H}$ and $\\nabla \\times \\mathbf{H} = i\\omega\\bar{\\bar{\\epsilon}}\\cdot\\mathbf{E}$, we can expand the components of the stretched curl equations and regroup terms. A more direct route is to use the established result from coordinate-stretching theory, which yields diagonal equivalent permittivity and permeability tensors, $\\bar{\\bar{\\epsilon}} = \\mathrm{diag}(\\epsilon_x, \\epsilon_y, \\epsilon_z)$ and $\\bar{\\bar{\\mu}} = \\mathrm{diag}(\\mu_x, \\mu_y, \\mu_z)$.\n\n**1. Derivation of PML Material Tensor Components**\n\nThe complex coordinate-stretching transformation with a diagonal stretching tensor $\\mathbf{s} = \\mathrm{diag}(s_x, s_y, s_z)$ results in an equivalent anisotropic medium with the following constitutive parameters:\n$$ \\bar{\\bar{\\epsilon}} = \\epsilon_0 \\mathbf{\\Lambda} \\quad \\text{and} \\quad \\bar{\\bar{\\mu}} = \\mu_0 \\mathbf{\\Lambda} $$\nwhere $\\mathbf{\\Lambda}$ is a diagonal matrix given by:\n$$ \\mathbf{\\Lambda} = \\mathrm{diag}\\left( \\frac{s_y s_z}{s_x}, \\frac{s_x s_z}{s_y}, \\frac{s_x s_y}{s_z} \\right) $$\nThus, the components of the material tensors are:\n$$ \\epsilon_x = \\epsilon_0 \\frac{s_y s_z}{s_x}, \\quad \\epsilon_y = \\epsilon_0 \\frac{s_x s_z}{s_y}, \\quad \\epsilon_z = \\epsilon_0 \\frac{s_x s_y}{s_z} $$\n$$ \\mu_x = \\mu_0 \\frac{s_y s_z}{s_x}, \\quad \\mu_y = \\mu_0 \\frac{s_x s_z}{s_y}, \\quad \\mu_z = \\mu_0 \\frac{s_x s_y}{s_z} $$\nThese are the required expressions for the PML material tensor components.\n\n**2. Derivation of Dispersion Relations**\n\nWe analyze plane waves of the form $\\exp(i q_x x + i k_y y)$, as the problem specifies $k_z=0$. The del operator becomes $\\nabla \\rightarrow i(q_x \\hat{x} + k_y \\hat{y})$. The Maxwell's equations in the PML medium are:\n$$ i(q_x \\hat{x} + k_y \\hat{y}) \\times \\mathbf{E} = -i\\omega \\bar{\\bar{\\mu}} \\cdot \\mathbf{H} \\implies (q_x \\hat{x} + k_y \\hat{y}) \\times \\mathbf{E} = -\\omega \\bar{\\bar{\\mu}} \\cdot \\mathbf{H} $$\n$$ i(q_x \\hat{x} + k_y \\hat{y}) \\times \\mathbf{H} = i\\omega \\bar{\\bar{\\epsilon}} \\cdot \\mathbf{E} \\implies (q_x \\hat{x} + k_y \\hat{y}) \\times \\mathbf{H} = \\omega \\bar{\\bar{\\epsilon}} \\cdot \\mathbf{E} $$\nWe consider the two decoupled polarizations.\n\nFor the **Transverse Electric (TE$_z$)** polarization, the non-zero fields are $E_z$, $H_x$, and $H_y$. The first curl equation, $(q_x \\hat{x} + k_y \\hat{y}) \\times (E_z \\hat{z}) = -\\omega(\\mu_x H_x \\hat{x} + \\mu_y H_y \\hat{y})$, yields:\n$$ k_y E_z = -\\omega \\mu_x H_x \\implies H_x = -\\frac{k_y}{\\omega \\mu_x} E_z $$\n$$ -q_x E_z = -\\omega \\mu_y H_y \\implies H_y = \\frac{q_x}{\\omega \\mu_y} E_z $$\nThe second curl equation, $(q_x \\hat{x} + k_y \\hat{y}) \\times (H_x \\hat{x} + H_y \\hat{y}) = \\omega \\epsilon_z E_z \\hat{z}$, gives the scalar relation:\n$$ q_x H_y - k_y H_x = \\omega \\epsilon_z E_z $$\nSubstituting the expressions for $H_x$ and $H_y$:\n$$ q_x \\left(\\frac{q_x}{\\omega \\mu_y} E_z\\right) - k_y \\left(-\\frac{k_y}{\\omega \\mu_x} E_z\\right) = \\omega \\epsilon_z E_z $$\nDividing by $E_z$ and multiplying by $\\omega$ gives the TE$_z$ dispersion relation:\n$$ \\frac{q_x^2}{\\mu_y} + \\frac{k_y^2}{\\mu_x} = \\omega^2 \\epsilon_z $$\n\nFor the **Transverse Magnetic (TM$_z$)** polarization, the non-zero fields are $H_z$, $E_x$, and $E_y$. A similar procedure is followed. The second curl equation, $(q_x \\hat{x} + k_y \\hat{y}) \\times (H_z \\hat{z}) = \\omega(\\epsilon_x E_x \\hat{x} + \\epsilon_y E_y \\hat{y})$, yields:\n$$ k_y H_z = \\omega \\epsilon_x E_x \\implies E_x = \\frac{k_y}{\\omega \\epsilon_x} H_z $$\n$$ -q_x H_z = \\omega \\epsilon_y E_y \\implies E_y = -\\frac{q_x}{\\omega \\epsilon_y} H_z $$\nThe first curl equation, $(q_x \\hat{x} + k_y \\hat{y}) \\times (E_x \\hat{x} + E_y \\hat{y}) = -\\omega \\mu_z H_z \\hat{z}$, gives:\n$$ q_x E_y - k_y E_x = -\\omega \\mu_z H_z $$\nSubstituting the expressions for $E_x$ and $E_y$:\n$$ q_x \\left(-\\frac{q_x}{\\omega \\epsilon_y} H_z\\right) - k_y \\left(\\frac{k_y}{\\omega \\epsilon_x} H_z\\right) = -\\omega \\mu_z H_z $$\nDividing by $H_z$ and multiplying by $-\\omega$ gives the TM$_z$ dispersion relation:\n$$ \\frac{q_x^2}{\\epsilon_y} + \\frac{k_y^2}{\\epsilon_x} = \\omega^2 \\mu_z $$\n\n**3. Derivation of Reflection Coefficients**\n\nThe interface is at $x=0$. Region $1$ ($x<0$) is free space ($\\epsilon_0, \\mu_0$) and region $2$ ($x \\ge 0$) is the PML. A plane wave is incident from region $1$. The boundary conditions require continuity of tangential components of $\\mathbf{E}$ and $\\mathbf{H}$ at $x=0$. The reflection coefficient $R$ is the ratio of the reflected to incident tangential electric field amplitude. In region $1$, the fields are a sum of incident (wavenumber $q_{x1}$) and reflected (wavenumber $-q_{x1}$) waves. In region $2$, there is only a transmitted wave (wavenumber $q_{x2}$). The free-space dispersion relation is $q_{x1}^2 + k_y^2 = k_0^2 = \\omega^2\\epsilon_0\\mu_0$.\n\nFor **TE$_z$ polarization**, the tangential fields are $E_z$ and $H_y$.\nContinuity of $E_z$: $E_{z,1}(0) = E_{z,2}(0) \\implies E_z^i + E_z^r = E_z^t$.\nContinuity of $H_y$: $H_{y,1}(0) = H_{y,2}(0)$.\nThe transverse wave admittance is $Y_{TE} = H_y/E_z$. In region $1$, $Y_{1,TE} = q_{x1}/(\\omega\\mu_0)$. In region $2$, $Y_{2,TE} = q_{x2,TE}/(\\omega\\mu_y)$.\n$H_y^i+H_y^r = H_y^t \\implies Y_{1,TE}E_z^i - Y_{1,TE}E_z^r = Y_{2,TE}E_z^t$.\nWith $R_{\\mathrm{TE}_z} = E_z^r/E_z^i$ and $T_{\\mathrm{TE}_z} = E_z^t/E_z^i = 1+R_{\\mathrm{TE}_z}$, we get $Y_{1,TE}(1-R_{\\mathrm{TE}_z}) = Y_{2,TE}(1+R_{\\mathrm{TE}_z})$.\nSolving for $R_{\\mathrm{TE}_z}$:\n$$ R_{\\mathrm{TE}_z} = \\frac{Y_{1,TE} - Y_{2,TE}}{Y_{1,TE} + Y_{2,TE}} = \\frac{q_{x1}/\\mu_0 - q_{x2,TE}/\\mu_y}{q_{x1}/\\mu_0 + q_{x2,TE}/\\mu_y} = \\frac{q_{x1}\\mu_y - q_{x2,TE}\\mu_0}{q_{x1}\\mu_y + q_{x2,TE}\\mu_0} $$\nwhere $q_{x2,TE}$ is the normal wavenumber in the PML for the TE$_z$ case.\n\nFor **TM$_z$ polarization**, the tangential fields are $E_y$ and $H_z$.\nContinuity of $E_y$: $E_{y,1}(0) = E_{y,2}(0) \\implies E_y^i + E_y^r = E_y^t$.\nContinuity of $H_z$: $H_{z,1}(0) = H_{z,2}(0_z)$.\nThe transverse wave admittance is $Y_{TM} = -H_z/E_y$. In region $1$, $Y_{1,TM} = \\omega\\epsilon_0/q_{x1}$. In region $2$, $Y_{2,TM} = \\omega\\epsilon_y/q_{x2,TM}$.\n$H_z^i + H_z^r = H_z^t \\implies -Y_{1,TM}E_y^i + Y_{1,TM}E_y^r = -Y_{2,TM}E_y^t$.\nWith $R_{\\mathrm{TM}_z} = E_y^r/E_y^i$ and $T_{\\mathrm{TM}_z} = E_y^t/E_y^i = 1+R_{\\mathrm{TM}_z}$, we get $Y_{1,TM}(-1+R_{\\mathrm{TM}_z}) = -Y_{2,TM}(1+R_{\\mathrm{TM}_z})$.\nThis simplifies to $Y_{1,TM}(1-R_{\\mathrm{TM}_z}) = Y_{2,TM}(1+R_{\\mathrm{TM}_z})$.\nSolving for $R_{\\mathrm{TM}_z}$:\n$$ R_{\\mathrm{TM}_z} = \\frac{Y_{1,TM} - Y_{2,TM}}{Y_{1,TM} + Y_{2,TM}} = \\frac{\\omega\\epsilon_0/q_{x1} - \\omega\\epsilon_y/q_{x2,TM}}{\\omega\\epsilon_0/q_{x1} + \\omega\\epsilon_y/q_{x2,TM}} = \\frac{\\epsilon_0/q_{x1} - \\epsilon_y/q_{x2,TM}}{\\epsilon_0/q_{x1} + \\epsilon_y/q_{x2,TM}} = \\frac{q_{x2,TM}\\epsilon_0 - q_{x1}\\epsilon_y}{q_{x2,TM}\\epsilon_0 + q_{x1}\\epsilon_y} $$\nwhere $q_{x2,TM}$ is the normal wavenumber in the PML for the TM$_z$ case.\n\n**Algorithmic Design**\n\nThe core of the algorithm is to implement the derived formulas and perform an exhaustive search. A key simplification arises from substituting the material parameters into the dispersion relations. For both TE$_z$ and TM$_z$ cases:\n$$ q_{x2}^2 = s_x^2 \\left(k_0^2 - \\frac{k_y^2}{s_y^2}\\right) $$\nThis shows that $q_{x2,TE} = q_{x2,TM} = q_{x2}$, and that the wavenumber $q_{x2}$ is independent of $s_z$. The feasibility condition, $\\operatorname{Im}(q_{x2}) > 0$, therefore only depends on $s_y$ (for fixed $s_x$ and $k_y$).\n\nLet's also simplify the reflection coefficients. Let $Z_{ratio} = s_x s_z / s_y$.\n$ \\mu_y = \\mu_0 Z_{ratio} $ and $ \\epsilon_y = \\epsilon_0 Z_{ratio} $.\n$$ R_{\\mathrm{TE}_z} = \\frac{q_{x1}(\\mu_0 Z_{ratio}) - q_{x2}\\mu_0}{q_{x1}(\\mu_0 Z_{ratio}) + q_{x2}\\mu_0} = \\frac{q_{x1} Z_{ratio} - q_{x2}}{q_{x1} Z_{ratio} + q_{x2}} $$\n$$ R_{\\mathrm{TM}_z} = \\frac{q_{x2}\\epsilon_0 - q_{x1}(\\epsilon_0 Z_{ratio})}{q_{x2}\\epsilon_0 + q_{x1}(\\epsilon_0 Z_{ratio})} = \\frac{q_{x2} - q_{x1} Z_{ratio}}{q_{x2} + q_{x1} Z_{ratio}} = -R_{\\mathrm{TE}_z} $$\nThis implies $|R_{\\mathrm{TM}_z}| = |R_{\\mathrm{TE}_z}|$. The objective function $J = \\max\\{ |R_{\\mathrm{TE}_z}|, |R_{\\mathrm{TM}_z}| \\}$ simplifies to $J = |R_{\\mathrm{TE}_z}|$.\n\nThe algorithm is as follows:\nFor each test case $(f, s_x, k_y/k_0)$:\n1.  Initialize `min_J_star` to infinity, and placeholders for `best_sy`, `best_sz`, and `best_tie_breaker`.\n2.  Calculate constants: $\\omega = 2\\pi f$, $k_0 = \\omega/c$, $k_y$, and $q_{x1} = \\sqrt{k_0^2 - k_y^2}$ (ensuring $\\operatorname{Im}(q_{x1}) \\ge 0$).\n3.  Iterate through each $s_y$ in the sorted candidate set $\\mathcal{S}$.\n    a. Calculate $q_{x2}^2 = s_x^2 (k_0^2 - k_y^2/s_y^2)$.\n    b. Compute $q_{x2} = \\sqrt{q_{x2}^2}$. Apply the branch selection rule: if $\\operatorname{Im}(q_{x2}) < 0$, set $q_{x2} = -q_{x2}$.\n    c. If $\\operatorname{Im}(q_{x2}) \\le 0$, this $s_y$ is infeasible. Continue to the next $s_y$.\n4.  For each feasible $s_y$, iterate through each $s_z$ in the sorted candidate set $\\mathcal{S}$.\n    a. Calculate $J = |R_{\\mathrm{TE}_z}|$ using the formula derived above.\n    b. Compare the current $J$ with `min_J_star` and apply the specified tie-breaking rules.\n        i. If $J$ is smaller than `min_J_star` by more than a tolerance of $10^{-12}$, we have a new best candidate. Update `min_J_star`, `best_sy`, `best_sz`, and the tie-breaker value $|s_y - 1| + |s_z - 1|$.\n        ii. If $J$ is within the tolerance of `min_J_star`, check the tie-breaker. If the current pair's tie-breaker value is smaller, update the best candidate.\n        iii. If the tie-breaker values are also equal, we do not update. Because the iteration is over sorted $s_y$ and $s_z$, the first-found candidate pair will always have the lexicographically smallest $(s_y, s_z)$ among all tied pairs.\n5.  After the loops complete, the stored `best_sy`, `best_sz`, and `min_J_star` form the result for the test case.\nThe final program implements this logic for all test cases and formats the output.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the PML optimization problem for the given test suite.\n    \"\"\"\n\n    # Global constants\n    EPS0 = 8.854187817e-12  # F/m\n    MU0 = 4 * np.pi * 1e-7  # H/m\n    C0 = 1 / np.sqrt(EPS0 * MU0) # m/s\n    S_CANDIDATES = [1.2, 1.5, 2.0, 3.0]\n    TOL = 1e-12\n\n    # Test suite\n    test_cases = [\n        # (f in Hz, s_x, k_y/k_0 ratio)\n        (10e9, 1.0 + 1.0j, 1.30),\n        (6e9, 1.0 + 0.3j, 1.05),\n        (12e9, 2.0 + 2.0j, 2.50),\n    ]\n\n    final_results = []\n\n    # Sort S_CANDIDATES to naturally handle tie-breaking on smallest sy, then sz\n    sorted_s_candidates = sorted(S_CANDIDATES)\n\n    for f, s_x, ky_k0_ratio in test_cases:\n        # Initialize optimal values for the current case\n        best_sy = -1.0\n        best_sz = -1.0\n        min_J_star = float('inf')\n        best_tie_breaker_val = float('inf')\n\n        # Calculate case-specific physical parameters\n        omega = 2 * np.pi * f\n        k0 = omega / C0\n        ky = ky_k0_ratio * k0\n\n        # Calculate free-space normal wavenumber q_x1\n        # Incident wave is evanescent, so k_y > k_0 and q_x1_sq is negative\n        q_x1_sq = k0**2 - ky**2\n        q_x1 = np.sqrt(complex(q_x1_sq)) # q_x1 is purely imaginary with Im(q_x1) > 0\n\n        # Exhaustive search over all (s_y, s_z) pairs\n        for sy in sorted_s_candidates:\n            # Calculate q_x2, which is independent of s_z\n            q_x2_sq = s_x**2 * (k0**2 - (ky/sy)**2)\n            q_x2 = np.sqrt(q_x2_sq)\n\n            # Apply branch selection rule: Im(q_x2) >= 0\n            if q_x2.imag < 0:\n                q_x2 = -q_x2\n\n            # Feasibility check: transmitted wave must decay, Im(q_x2) > 0\n            if q_x2.imag <= 0:\n                continue # This s_y is infeasible\n\n            for sz in sorted_s_candidates:\n                # Calculate the objective function J = max(|R_TEz|, |R_TMz|)\n                # Based on derivations, |R_TEz| = |R_TMz|, so J = |R_TEz|\n                Z_ratio = s_x * sz / sy\n                \n                numerator = q_x1 * Z_ratio - q_x2\n                denominator = q_x1 * Z_ratio + q_x2\n\n                if abs(denominator) < 1e-15:\n                    current_J = float('inf')\n                else:\n                    R_TEz = numerator / denominator\n                    current_J = abs(R_TEz)\n                \n                current_tie_breaker_val = abs(sy - 1) + abs(sz - 1)\n\n                # Update logic with tie-breaking rules\n                # Rule 1: Minimize J_star\n                if current_J < min_J_star - TOL:\n                    min_J_star = current_J\n                    best_sy = sy\n                    best_sz = sz\n                    best_tie_breaker_val = current_tie_breaker_val\n                # Rule 2: If J_star is tied, minimize tie-breaker\n                elif abs(current_J - min_J_star) <= TOL:\n                    # Using '<' here handles floating point comparisons safely\n                    if current_tie_breaker_val < best_tie_breaker_val - TOL:\n                        min_J_star = current_J\n                        best_sy = sy\n                        best_sz = sz\n                        best_tie_breaker_val = current_tie_breaker_val\n                    # Rule 3 & 4 (smallest sy, then sz) are handled implicitly\n                    # by iterating over sorted S_CANDIDATES and not updating\n                    # on a tie-breaker tie. The first pair found is kept.\n\n        final_results.extend([best_sy, best_sz, min_J_star])\n\n    # Format the output string as required\n    output_str = \",\".join(f\"{v:.6f}\" for v in final_results)\n    print(f\"[{output_str}]\")\n\nsolve()\n```", "id": "3341069"}]}