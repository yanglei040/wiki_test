{"hands_on_practices": [{"introduction": "To truly master the concept of input impedance, it is essential to move beyond merely using the standard formula and understand its origin. This exercise guides you through a foundational derivation of the input impedance $Z_{\\text{in}}$ for a lossless transmission line terminated in two canonical cases: a perfect short circuit and a perfect open circuit. By starting from the telegrapher's equations and applying the appropriate boundary conditions [@problem_id:3319452], you will solidify your understanding of how wave behavior dictates the impedance seen at the input port.", "problem": "A uniform, lossless transmission line supporting Transverse Electromagnetic (TEM) propagation is characterized by distributed inductance per unit length $L'$ and capacitance per unit length $C'$. The line has characteristic impedance $Z_{0}=\\sqrt{L'/C'}$ and phase constant $\\beta=\\omega\\sqrt{L'C'}$, where $\\omega$ is the angular frequency and $j$ denotes the unit imaginary number satisfying $j^2=-1$. Let the spatial coordinate $z$ run along the line with the load at $z=0$ and the input port at $z=-l$, where $l>0$ is the physical length of the line. Assume sinusoidal steady state with time dependence $\\exp(j\\omega t)$.\n\nStarting from the field-theoretic basis that leads to the lossless telegrapher’s equations for TEM lines and the corresponding wave equations for the voltage and current, derive expressions for the input impedance $Z_{\\text{in}}=V(-l)/I(-l)$ of the line for the two load terminations:\n- a perfect short circuit at the load, $Z_{L}=0$,\n- a perfect open circuit at the load, $Z_{L}\\to\\infty$.\n\nYour derivation must begin from the lossless telegrapher’s equations and apply the appropriate boundary conditions at $z=0$ for each termination. Do not use prederived input-impedance identities for arbitrary loads; instead, obtain the expressions directly from the voltage and current wave solutions and their relation through $Z_{0}$.\n\nProvide your final results as exact symbolic expressions in terms of $Z_{0}$, $\\beta$, and $l$. Assume all trigonometric function arguments are in radians. Express the impedance in ohms, but do not include units in the boxed final answer. No numerical rounding is required.", "solution": "The problem statement is deemed valid as it is scientifically grounded in the principles of transmission line theory, well-posed with a complete and consistent setup, and expressed in objective, formal language. The derivation of the input impedance for short- and open-circuit terminations from the lossless telegrapher's equations is a fundamental and solvable problem in electromagnetics.\n\nThe derivation proceeds as follows, starting from the lossless telegrapher's equations for a uniform transmission line. In the time domain, these equations are:\n$$\n\\frac{\\partial V(z,t)}{\\partial z} = -L' \\frac{\\partial I(z,t)}{\\partial t}\n$$\n$$\n\\frac{\\partial I(z,t)}{\\partial z} = -C' \\frac{\\partial V(z,t)}{\\partial t}\n$$\nwhere $V(z,t)$ and $I(z,t)$ are the instantaneous voltage and current, $L'$ is the inductance per unit length, and $C'$ is the capacitance per unit length.\n\nFor sinusoidal steady-state analysis, we assume a time dependence of the form $\\exp(j\\omega t)$. The voltage and current can be expressed in phasor form as $V(z,t) = \\text{Re}\\{V(z)\\exp(j\\omega t)\\}$ and $I(z,t) = \\text{Re}\\{I(z)\\exp(j\\omega t)\\}$. The time-derivative operator $\\frac{\\partial}{\\partial t}$ is replaced by multiplication with $j\\omega$. The telegrapher's equations in the frequency domain (phasor form) become:\n$$\n\\frac{dV(z)}{dz} = -j\\omega L' I(z) \\quad (1)\n$$\n$$\n\\frac{dI(z)}{dz} = -j\\omega C' V(z) \\quad (2)\n$$\n\nTo obtain the wave equations, we decouple these two first-order differential equations. Differentiating Eq. $(1)$ with respect to $z$ and substituting Eq. $(2)$ yields the wave equation for voltage:\n$$\n\\frac{d^2V(z)}{dz^2} = -j\\omega L' \\frac{dI(z)}{dz} = -j\\omega L' (-j\\omega C' V(z)) = -\\omega^2 L'C' V(z)\n$$\nRearranging this gives the Helmholtz equation for voltage:\n$$\n\\frac{d^2V(z)}{dz^2} + \\beta^2 V(z) = 0\n$$\nwhere the phase constant is defined as $\\beta = \\omega\\sqrt{L'C'}$. A similar procedure yields the same wave equation for current:\n$$\n\\frac{d^2I(z)}{dz^2} + \\beta^2 I(z) = 0\n$$\nThe general solution for the voltage wave equation is a superposition of forward-propagating (in the $+z$ direction, from source to load) and backward-propagating (in the $-z$ direction, from load to source) waves:\n$V(z) = V_0^+ \\exp(-j\\beta z) + V_0^- \\exp(j\\beta z)$\nwhere $V_0^+$ and $V_0^-$ are complex amplitudes. The corresponding current can be found from Eq. $(1)$:\n$I(z) = -\\frac{1}{j\\omega L'} \\frac{dV(z)}{dz} = -\\frac{1}{j\\omega L'} (-j\\beta V_0^+ \\exp(-j\\beta z) + j\\beta V_0^- \\exp(j\\beta z))$\n$$\nI(z) = \\frac{\\beta}{\\omega L'} V_0^+ \\exp(-j\\beta z) - \\frac{\\beta}{\\omega L'} V_0^- \\exp(j\\beta z)\n$$\nUsing the definitions $\\beta = \\omega\\sqrt{L'C'}$ and the characteristic impedance $Z_0 = \\sqrt{L'/C'}$, the pre-factor becomes:\n$$\n\\frac{\\beta}{\\omega L'} = \\frac{\\omega\\sqrt{L'C'}}{\\omega L'} = \\sqrt{\\frac{C'}{L'}} = \\frac{1}{Z_0}\n$$\nThus, the general solution for the current is:\n$I(z) = \\frac{V_0^+}{Z_0} \\exp(-j\\beta z) - \\frac{V_0^-}{Z_0} \\exp(j\\beta z)$\n\nWe now apply the boundary conditions at the load ($z=0$) for the two specified cases.\n\n**Case 1: Short Circuit Termination ($Z_{L}=0$)**\n\nFor a perfect short circuit, the voltage at the load must be zero. The boundary condition is $V(0) = 0$.\n$$\nV(0) = V_0^+ \\exp(0) + V_0^- \\exp(0) = V_0^+ + V_0^- = 0\n$$\nThis implies $V_0^- = -V_0^+$. Substituting this relationship into the general solutions for $V(z)$ and $I(z)$:\n$V_{sc}(z) = V_0^+ \\exp(-j\\beta z) - V_0^+ \\exp(j\\beta z) = V_0^+ (\\exp(-j\\beta z) - \\exp(j\\beta z)) = -2j V_0^+ \\sin(\\beta z)$\n$I_{sc}(z) = \\frac{V_0^+}{Z_0} \\exp(-j\\beta z) - \\frac{-V_0^+}{Z_0} \\exp(j\\beta z) = \\frac{V_0^+}{Z_0} (\\exp(-j\\beta z) + \\exp(j\\beta z)) = \\frac{2 V_0^+}{Z_0} \\cos(\\beta z)$\nThe input impedance $Z_{\\text{in}}$ is defined at the input port $z=-l$.\n$$\nZ_{\\text{in,sc}} = \\frac{V_{sc}(-l)}{I_{sc}(-l)} = \\frac{-2j V_0^+ \\sin(-\\beta l)}{\\frac{2 V_0^+}{Z_0} \\cos(-\\beta l)}\n$$\nUsing the identities $\\sin(-x) = -\\sin(x)$ and $\\cos(-x) = \\cos(x)$:\n$$\nZ_{\\text{in,sc}} = \\frac{-2j V_0^+ (-\\sin(\\beta l))}{\\frac{2 V_0^+}{Z_0} \\cos(\\beta l)} = \\frac{2j V_0^+ \\sin(\\beta l)}{\\frac{2 V_0^+}{Z_0} \\cos(\\beta l)} = j Z_0 \\frac{\\sin(\\beta l)}{\\cos(\\beta l)}\n$$\n$$\nZ_{\\text{in,sc}} = j Z_0 \\tan(\\beta l)\n$$\n\n**Case 2: Open Circuit Termination ($Z_{L}\\to\\infty$)**\n\nFor a perfect open circuit, the current at the load must be zero. The boundary condition is $I(0) = 0$.\n$$\nI(0) = \\frac{V_0^+}{Z_0} \\exp(0) - \\frac{V_0^-}{Z_0} \\exp(0) = \\frac{1}{Z_0} (V_0^+ - V_0^-) = 0\n$$\nThis implies $V_0^- = V_0^+$. Substituting this relationship into the general solutions for $V(z)$ and $I(z)$:\n$V_{oc}(z) = V_0^+ \\exp(-j\\beta z) + V_0^+ \\exp(j\\beta z) = V_0^+ (\\exp(-j\\beta z) + \\exp(j\\beta z)) = 2 V_0^+ \\cos(\\beta z)$\n$I_{oc}(z) = \\frac{V_0^+}{Z_0} \\exp(-j\\beta z) - \\frac{V_0^+}{Z_0} \\exp(j\\beta z) = \\frac{V_0^+}{Z_0} (\\exp(-j\\beta z) - \\exp(j\\beta z)) = -\\frac{2j V_0^+}{Z_0} \\sin(\\beta z)$\nThe input impedance $Z_{\\text{in}}$ at the port $z=-l$ is:\n$$\nZ_{\\text{in,oc}} = \\frac{V_{oc}(-l)}{I_{oc}(-l)} = \\frac{2 V_0^+ \\cos(-\\beta l)}{-\\frac{2j V_0^+}{Z_0} \\sin(-\\beta l)}\n$$\nAgain, using $\\sin(-x) = -\\sin(x)$ and $\\cos(-x) = \\cos(x)$:\n$$\nZ_{\\text{in,oc}} = \\frac{2 V_0^+ \\cos(\\beta l)}{-\\frac{2j V_0^+}{Z_0} (-\\sin(\\beta l))} = \\frac{2 V_0^+ \\cos(\\beta l)}{\\frac{2j V_0^+}{Z_0} \\sin(\\beta l)} = \\frac{Z_0}{j} \\frac{\\cos(\\beta l)}{\\sin(\\beta l)}\n$$\nSince $1/j = -j$:\n$$\nZ_{\\text{in,oc}} = -j Z_0 \\cot(\\beta l)\n$$\nThe derived expressions provide the input impedances for a short-circuited and an open-circuited lossless transmission line, respectively, in terms of the line's characteristic impedance $Z_0$, phase constant $\\beta$, and length $l$.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\nj Z_{0} \\tan(\\beta l) & -j Z_{0} \\cot(\\beta l)\n\\end{pmatrix}\n}\n$$", "id": "3319452"}, {"introduction": "Reflections are a fundamental consequence of a wave encountering a change in the medium, and minimizing them is key to efficient power transfer in electromagnetic systems. This practice delves into the physics of reflection at a normal-incidence boundary between two different materials, deriving the reflection coefficient $\\Gamma$ directly from Maxwell's equations. By analyzing the condition for zero reflection [@problem_id:3319417], you will gain a deep, physical intuition for the principle of impedance matching.", "problem": "A time-harmonic plane electromagnetic wave with angular frequency $\\omega$ is normally incident from a homogeneous, isotropic, lossless medium $\\text{medium }1$ onto a homogeneous, isotropic, lossless, semi-infinite $\\text{medium }2$. The constitutive parameters are $(\\mu_{1}, \\epsilon_{1})$ in $\\text{medium }1$ and $(\\mu_{2}, \\epsilon_{2})$ in $\\text{medium }2$, with $\\mu_{i} > 0$ and $\\epsilon_{i} > 0$ for $i \\in \\{1, 2\\}$. The time dependence is $\\exp(\\jmath \\omega t)$. The fields in each medium are plane waves characterized by wavenumber $k_{i} = \\omega \\sqrt{\\mu_{i} \\epsilon_{i}}$ and a medium-dependent ratio of tangential electric to tangential magnetic field, which we denote by the input (or intrinsic) impedance $Z_{i}$, defined as $Z_{i} = E_{t}/H_{t}$ for the plane wave in $\\text{medium }i$.\n\nStarting only from Maxwell’s equations in the frequency domain, the plane-wave relations in homogeneous isotropic media, and the electromagnetic boundary conditions at a planar interface, derive the reflection coefficient $\\Gamma$ for the tangential electric field at normal incidence in terms of $Z_{1}$ and $Z_{2}$. Provide a clear explanation of the mathematical and physical reason why setting $Z_{1} = Z_{2}$ eliminates reflection at normal incidence.\n\nThen, specializing your general result, compute $\\Gamma$ in the two cases:\n- $(\\text{i})$ only the permeabilities are matched, meaning $\\mu_{2} = \\mu_{1}$ while $\\epsilon_{2}$ may differ from $\\epsilon_{1}$,\n- $(\\text{ii})$ only the permittivities are matched, meaning $\\epsilon_{2} = \\epsilon_{1}$ while $\\mu_{2}$ may differ from $\\mu_{1}$.\n\nExpress the final reflection coefficients as dimensionless analytic expressions. Report the two values as a single row matrix in the order $\\left(\\Gamma_{\\text{permeability matched}} \\;\\; \\Gamma_{\\text{permittivity matched}}\\right)$. No numerical approximation or rounding is required.", "solution": "The problem statement is evaluated to be scientifically grounded, well-posed, objective, and complete. It represents a standard problem in electromagnetic wave theory. Therefore, a solution will be provided.\n\nThe problem requires the derivation of the reflection coefficient $\\Gamma$ for a normally incident plane wave at the interface between two lossless media, starting from first principles. Let the interface be the plane $z=0$. Medium $1$ occupies the half-space $z<0$ and medium $2$ occupies the half-space $z>0$. The wave is incident from medium $1$.\n\nWe begin with Maxwell's curl equations in the frequency domain for a source-free, homogeneous, and isotropic medium, assuming a time-dependence of $\\exp(\\jmath \\omega t)$:\n$$ \\nabla \\times \\vec{E} = -\\jmath \\omega \\mu \\vec{H} $$\n$$ \\nabla \\times \\vec{H} = \\jmath \\omega \\epsilon \\vec{E} $$\n\nFor a plane wave propagating in the $+z$ direction, with the electric field polarized along the $x$-axis, we have $\\vec{E}(\\vec{r}) = \\hat{x} E_x(z)$. The curl of $\\vec{E}$ becomes:\n$$ \\nabla \\times \\vec{E} = \\hat{y} \\frac{\\partial E_x}{\\partial z} $$\nSubstituting this into the first Maxwell equation gives:\n$$ \\hat{y} \\frac{\\partial E_x}{\\partial z} = -\\jmath \\omega \\mu \\vec{H} $$\nThis implies that the magnetic field $\\vec{H}$ is polarized along the $y$-axis, $\\vec{H} = \\hat{y} H_y(z)$. The equation becomes $\\frac{dE_x}{dz} = -\\jmath \\omega \\mu H_y$.\n\nSimilarly, for the second Maxwell equation with $\\vec{H} = \\hat{y} H_y(z)$:\n$$ \\nabla \\times \\vec{H} = -\\hat{x} \\frac{\\partial H_y}{\\partial z} $$\n$$ -\\hat{x} \\frac{\\partial H_y}{\\partial z} = \\jmath \\omega \\epsilon \\hat{x} E_x \\implies \\frac{dH_y}{dz} = -\\jmath \\omega \\epsilon E_x $$\n\nWe can combine these two first-order differential equations by differentiating the first with respect to $z$:\n$$ \\frac{d^2 E_x}{dz^2} = -\\jmath \\omega \\mu \\frac{dH_y}{dz} $$\nSubstituting the expression for $dH_y/dz$:\n$$ \\frac{d^2 E_x}{dz^2} = -\\jmath \\omega \\mu (-\\jmath \\omega \\epsilon E_x) = -\\omega^2 \\mu \\epsilon E_x $$\nThis is the one-dimensional wave equation:\n$$ \\frac{d^2 E_x}{dz^2} + k^2 E_x = 0 $$\nwhere $k^2 = \\omega^2 \\mu \\epsilon$. The problem defines the wavenumber as $k = \\omega \\sqrt{\\mu \\epsilon}$, which is the positive root corresponding to propagation.\n\nThe general solutions are of the form $E_x(z) = A \\exp(-\\jmath k z) + B \\exp(+\\jmath k z)$, representing forward and backward propagating waves, respectively.\nFor a forward-propagating wave $E_x(z) = E_0 \\exp(-\\jmath k z)$, we find the corresponding magnetic field:\n$$ H_y = -\\frac{1}{\\jmath \\omega \\mu} \\frac{dE_x}{dz} = -\\frac{1}{\\jmath \\omega \\mu} (-\\jmath k E_0 \\exp(-\\jmath k z)) = \\frac{k}{\\omega \\mu} E_x = \\frac{\\omega \\sqrt{\\mu \\epsilon}}{\\omega \\mu} E_x = \\sqrt{\\frac{\\epsilon}{\\mu}} E_x $$\nThe ratio of the tangential electric field to the tangential magnetic field for this wave is defined as the intrinsic impedance $Z$:\n$$ Z = \\frac{E_x}{H_y} = \\sqrt{\\frac{\\mu}{\\epsilon}} $$\nThe problem correctly defines $Z_i$ as this ratio for a plane wave in medium $i$. Therefore, $Z_1 = \\sqrt{\\mu_1/\\epsilon_1}$ and $Z_2 = \\sqrt{\\mu_2/\\epsilon_2}$. For a backward-propagating wave, the ratio is $E_x/H_y = -Z$.\n\nAt the interface $z=0$, the total fields in each medium are:\nIn medium $1$ ($z<0$):\nThe total electric field is the sum of the incident and reflected waves:\n$\\vec{E}_1(z) = \\hat{x} \\left( E_i \\exp(-\\jmath k_1 z) + E_r \\exp(+\\jmath k_1 z) \\right)$\nThe total magnetic field is:\n$\\vec{H}_1(z) = \\hat{y} \\left( \\frac{E_i}{Z_1} \\exp(-\\jmath k_1 z) - \\frac{E_r}{Z_1} \\exp(+\\jmath k_1 z) \\right)$\n\nIn medium $2$ ($z>0$):\nThere is only a transmitted wave propagating in the $+z$ direction:\n$\\vec{E}_2(z) = \\hat{x} E_t \\exp(-\\jmath k_2 z)$\n$\\vec{H}_2(z) = \\hat{y} \\frac{E_t}{Z_2} \\exp(-\\jmath k_2 z)$\n\nThe electromagnetic boundary conditions at the interface $z=0$ state that the tangential components of $\\vec{E}$ and $\\vec{H}$ must be continuous.\nContinuity of tangential $\\vec{E}$ at $z=0$:\n$E_i \\exp(0) + E_r \\exp(0) = E_t \\exp(0) \\implies E_i + E_r = E_t \\quad (1)$\nContinuity of tangential $\\vec{H}$ at $z=0$:\n$\\frac{E_i}{Z_1} - \\frac{E_r}{Z_1} = \\frac{E_t}{Z_2} \\quad (2)$\nThe reflection coefficient for the electric field is defined as $\\Gamma = E_r/E_i$. We can rewrite the equations in terms of $\\Gamma$ and the transmission coefficient $T = E_t/E_i$:\nFrom $(1)$: $1 + \\Gamma = T$.\nFrom $(2)$: $\\frac{1}{Z_1}(1 - \\Gamma) = \\frac{T}{Z_2}$.\n\nSubstitute $T$ from the first equation into the second:\n$$ \\frac{1}{Z_1}(1 - \\Gamma) = \\frac{1 + \\Gamma}{Z_2} $$\n$$ Z_2(1 - \\Gamma) = Z_1(1 + \\Gamma) $$\n$$ Z_2 - Z_2 \\Gamma = Z_1 + Z_1 \\Gamma $$\n$$ Z_2 - Z_1 = \\Gamma (Z_1 + Z_2) $$\nSolving for $\\Gamma$ yields the general expression:\n$$ \\Gamma = \\frac{Z_2 - Z_1}{Z_2 + Z_1} $$\n\nNow, we explain why setting $Z_1 = Z_2$ eliminates reflection.\nMathematically, the reason is immediately evident from the derived formula for $\\Gamma$. If $Z_1 = Z_2$, the numerator becomes $Z_2 - Z_1 = 0$. Since the media are physical, $\\mu_i > 0$ and $\\epsilon_i > 0$, hence $Z_i = \\sqrt{\\mu_i/\\epsilon_i}$ is a positive real number. Thus, the denominator $Z_1+Z_2 = 2 Z_1$ is non-zero. This leads to $\\Gamma = 0 / (2Z_1) = 0$.\nPhysically, the intrinsic impedance $Z$ represents the ratio of transverse electric to magnetic fields that a medium can support for a propagating plane wave. A reflection is generated at an interface precisely to satisfy the boundary conditions when the two media support different field ratios. The incident wave arrives with a ratio $E_i/H_i = Z_1$. If medium $2$ has the same impedance, $Z_2 = Z_1$, the transmitted wave can satisfy the boundary conditions on its own without requiring a reflected wave. The field relationships are continuous across the boundary, which appears \"transparent\" to the incident wave since there is no impedance mismatch. The wave propagates from medium $1$ into medium $2$ as if the boundary did not exist.\n\nFinally, we compute $\\Gamma$ for the two specified cases using the full expression in terms of constitutive parameters:\n$$ \\Gamma = \\frac{\\sqrt{\\mu_2/\\epsilon_2} - \\sqrt{\\mu_1/\\epsilon_1}}{\\sqrt{\\mu_2/\\epsilon_2} + \\sqrt{\\mu_1/\\epsilon_1}} $$\n\nCase (i): Permeability is matched, $\\mu_2 = \\mu_1$.\nUnder this condition, the impedances become $Z_1 = \\sqrt{\\mu_1/\\epsilon_1}$ and $Z_2 = \\sqrt{\\mu_1/\\epsilon_2}$.\n$$ \\Gamma_{\\text{permeability matched}} = \\frac{\\sqrt{\\mu_1/\\epsilon_2} - \\sqrt{\\mu_1/\\epsilon_1}}{\\sqrt{\\mu_1/\\epsilon_2} + \\sqrt{\\mu_1/\\epsilon_1}} = \\frac{\\sqrt{\\mu_1}(1/\\sqrt{\\epsilon_2} - 1/\\sqrt{\\epsilon_1})}{\\sqrt{\\mu_1}(1/\\sqrt{\\epsilon_2} + 1/\\sqrt{\\epsilon_1})} $$\n$$ \\Gamma_{\\text{permeability matched}} = \\frac{\\frac{1}{\\sqrt{\\epsilon_2}} - \\frac{1}{\\sqrt{\\epsilon_1}}}{\\frac{1}{\\sqrt{\\epsilon_2}} + \\frac{1}{\\sqrt{\\epsilon_1}}} = \\frac{\\frac{\\sqrt{\\epsilon_1} - \\sqrt{\\epsilon_2}}{\\sqrt{\\epsilon_1}\\sqrt{\\epsilon_2}}}{\\frac{\\sqrt{\\epsilon_1} + \\sqrt{\\epsilon_2}}{\\sqrt{\\epsilon_1}\\sqrt{\\epsilon_2}}} = \\frac{\\sqrt{\\epsilon_1} - \\sqrt{\\epsilon_2}}{\\sqrt{\\epsilon_1} + \\sqrt{\\epsilon_2}} $$\n\nCase (ii): Permittivity is matched, $\\epsilon_2 = \\epsilon_1$.\nUnder this condition, the impedances become $Z_1 = \\sqrt{\\mu_1/\\epsilon_1}$ and $Z_2 = \\sqrt{\\mu_2/\\epsilon_1}$.\n$$ \\Gamma_{\\text{permittivity matched}} = \\frac{\\sqrt{\\mu_2/\\epsilon_1} - \\sqrt{\\mu_1/\\epsilon_1}}{\\sqrt{\\mu_2/\\epsilon_1} + \\sqrt{\\mu_1/\\epsilon_1}} = \\frac{(1/\\sqrt{\\epsilon_1})(\\sqrt{\\mu_2} - \\sqrt{\\mu_1})}{(1/\\sqrt{\\epsilon_1})(\\sqrt{\\mu_2} + \\sqrt{\\mu_1})} $$\n$$ \\Gamma_{\\text{permittivity matched}} = \\frac{\\sqrt{\\mu_2} - \\sqrt{\\mu_1}}{\\sqrt{\\mu_2} + \\sqrt{\\mu_1}} $$\nThese are the final dimensionless analytic expressions for the reflection coefficients in the two specialized cases.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{\\sqrt{\\epsilon_1} - \\sqrt{\\epsilon_2}}{\\sqrt{\\epsilon_1} + \\sqrt{\\epsilon_2}} & \\frac{\\sqrt{\\mu_2} - \\sqrt{\\mu_1}}{\\sqrt{\\mu_2} + \\sqrt{\\mu_1}}\n\\end{pmatrix}\n}\n$$", "id": "3319417"}, {"introduction": "Analytical formulas provide an idealized view, but in computational electromagnetics, numerical artifacts can significantly impact results. This computational practice challenges you to investigate how simulated input impedance and reflection coefficient values are affected by common sources of numerical error: mesh discretization and finite port truncation. By implementing a convergence study [@problem_id:3319405], you will develop essential skills for verifying the accuracy and reliability of your numerical models, a critical aspect of professional simulation work.", "problem": "You will analyze the sensitivity of the computed input impedance and reflection coefficient of a one-dimensional, lossless transmission line to numerical mesh refinement and to finite port truncation. The computational model must be derived from fundamental definitions in electromagnetics and must quantify convergence with respect to discretization parameters. All quantities and numerical values must be treated consistently using explicit physical units where applicable.\n\nConsider a lossless transmission line of characteristic impedance $Z_0$ terminated by a complex load impedance $Z_L$. The line occupies the interval $z \\in [-l,0]$ with the load at $z=0$ and the port reference plane at $z=-l$. The fields are time-harmonic with angular frequency $\\omega$. Use the Telegrapher's equations for a uniform line and the definition of input impedance as the ratio of phasor voltage to phasor current at the port, together with appropriate boundary conditions at the load, to derive the exact input impedance $Z_{in}$ as a function of the characteristic impedance $Z_0$, the propagation constant $\\beta$, the physical length $l$, and the load impedance $Z_L$. The reflection coefficient at the port with reference impedance $Z_{\\mathrm{ref}}$ is defined by the ratio of reflected to incident wave amplitudes and must be related to $Z_{in}$ by the standard boundary relation at the port.\n\nTo emulate numerical effects without using an external solver, define a physically plausible computational model for the \"computed\" input impedance $Z_{in}^{\\mathrm{comp}}(h, L_t)$ that includes the following two perturbations:\n- Mesh refinement effect: The computed propagation constant and characteristic impedance are perturbed from their exact values due to discretization error of order $p$, modeled as\n$$\\beta_h = \\beta \\left( 1 - a \\left( \\frac{h}{\\lambda_0} \\right)^p \\right), \\quad Z_{0,h} = Z_0 \\left( 1 + b \\left( \\frac{h}{\\lambda_0} \\right)^p \\right),$$\nwhere $h$ is the mesh size in meters, $\\lambda_0$ is the free-space wavelength, and $a$ and $b$ are dimensionless constants.\n- Port truncation effect: A finite port extent produces additional localized reactive energy storage that we model as an additive series reactance with magnitude decaying exponentially with port length,\n$X_s(L_t) = K \\exp\\left( - \\frac{L_t}{\\lambda_0} \\right),$\nso that the computed input impedance is\n$Z_{in}^{\\mathrm{comp}}(h, L_t) = Z_{in}\\big(Z_{0,h}, \\beta_h, l, Z_L\\big) + j X_s(L_t).$\n\nThe reflection coefficient at the port is taken with respect to the reference impedance equal to the exact characteristic impedance, $Z_{\\mathrm{ref}} = Z_0$, and must be computed as\n$\\Gamma(h, L_t) = \\frac{Z_{in}^{\\mathrm{comp}}(h, L_t) - Z_{\\mathrm{ref}}}{Z_{in}^{\\mathrm{comp}}(h, L_t) + Z_{\\mathrm{ref}}}.$\nYou must assess sensitivity by performing two convergence studies:\n- Mesh refinement study: hold $L_t$ at its largest value and vary $h$ from coarse to fine. Quantify the maximum absolute change between successive refinements in the real and imaginary parts of $Z_{in}^{\\mathrm{comp}}$, and in the magnitude of $\\Gamma$, each expressed as a float. Changes in $\\Re\\{Z_{in}^{\\mathrm{comp}}\\}$ and $\\Im\\{Z_{in}^{\\mathrm{comp}}\\}$ must be expressed in $\\mathrm{\\Omega}$, and changes in $\\lvert \\Gamma \\rvert$ are dimensionless.\n- Port truncation study: hold $h$ at its finest value and vary $L_t$ from short to long. Quantify the maximum absolute change between successive truncations in the same three quantities, with the same units.\n\nAssume a Transverse Electromagnetic (TEM) line in free space so that the phase velocity is $v_p = c$ where $c$ is the speed of light. Use $c = 299792458\\,\\mathrm{m/s}$. For a lossless line, you must use appropriate relations to link $\\beta$ to $f$ and $c$. For all scenarios, the line is lossless and uniform, and $Z_0$ is real. For numerical stability, avoid singular configurations such as exact quarter-wave or half-wave resonances with purely reactive $Z_L$.\n\nUse the following parameter values for the convergence studies. All physical quantities must be handled with the given units.\n\nConstants and model coefficients:\n- $a = 0.5$ (dimensionless), $b = 0.2$ (dimensionless), $p = 2$ (integer), $K = 5\\,\\mathrm{\\Omega}$ (ohms).\n- $Z_0 = 50\\,\\mathrm{\\Omega}$ (ohms).\n- Mesh sizes $h \\in \\{5 \\times 10^{-3}\\,\\mathrm{m}, 2.5 \\times 10^{-3}\\,\\mathrm{m}, 1.25 \\times 10^{-3}\\,\\mathrm{m}\\}$.\n- Port truncation lengths $L_t \\in \\{0.02\\,\\mathrm{m}, 0.04\\,\\mathrm{m}, 0.08\\,\\mathrm{m}\\}$.\n\nTest suite with three independent cases to ensure coverage of different electromagnetic regimes:\n- Case $1$ (happy path): frequency $f = 3.0\\,\\mathrm{GHz}$, length $l = 0.03\\,\\mathrm{m}$, load $Z_L = 25 - j\\,15\\,\\mathrm{\\Omega}$.\n- Case $2$ (near but not at resonance): frequency $f = 2.7\\,\\mathrm{GHz}$, length $l = 0.027\\,\\mathrm{m}$, load $Z_L = 100 + j\\,30\\,\\mathrm{\\Omega}$.\n- Case $3$ (electrically short line): frequency $f = 1.0\\,\\mathrm{GHz}$, length $l = 0.005\\,\\mathrm{m}$, load $Z_L = 50 - j\\,120\\,\\mathrm{\\Omega}$.\n\nFor each case, perform:\n- Mesh refinement study with $L_t = 0.08\\,\\mathrm{m}$ fixed, $h$ varying as listed.\n- Port truncation study with $h = 1.25 \\times 10^{-3}\\,\\mathrm{m}$ fixed, $L_t$ varying as listed.\n\nFor each case, your program must output a list of six floats:\n- The maximum absolute change in $\\Re\\{Z_{in}^{\\mathrm{comp}}\\}$ between successive refinements in the mesh study, in $\\mathrm{\\Omega}$.\n- The maximum absolute change in $\\Im\\{Z_{in}^{\\mathrm{comp}}\\}$ between successive refinements in the mesh study, in $\\mathrm{\\Omega}$.\n- The maximum absolute change in $\\lvert \\Gamma \\rvert$ between successive refinements in the mesh study, dimensionless.\n- The maximum absolute change in $\\Re\\{Z_{in}^{\\mathrm{comp}}\\}$ between successive truncations in the port study, in $\\mathrm{\\Omega}$.\n- The maximum absolute change in $\\Im\\{Z_{in}^{\\mathrm{comp}}\\}$ between successive truncations in the port study, in $\\mathrm{\\Omega}$.\n- The maximum absolute change in $\\lvert \\Gamma \\rvert$ between successive truncations in the port study, dimensionless.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element corresponds to one case and is itself a list of the six floats in the order specified above. For example, the output format must be exactly like\n$$[ [x_{11},x_{12},x_{13},x_{14},x_{15},x_{16}], [x_{21},x_{22},x_{23},x_{24},x_{25},x_{26}], [x_{31},x_{32},x_{33},x_{34},x_{35},x_{36}] ]$$\nwith no additional text. All impedance-related outputs must be understood to be in $\\mathrm{\\Omega}$, and all reflection coefficient outputs are dimensionless. Angles are not used in the output; if used internally, all angles must be in radians.", "solution": "The user has requested a solution to a problem in computational electromagnetics concerning the sensitivity of transmission line parameters to numerical modeling artifacts. The problem has been validated and found to be scientifically sound, well-posed, and complete.\n\nThe solution proceeds in two stages. First, the requisite theoretical formulas are derived from fundamental principles. Second, these formulas are employed in a computational algorithm to perform the specified sensitivity studies.\n\n**1. Theoretical Formulation**\n\nThe analysis begins with the time-harmonic Telegrapher's equations for voltage $V(z)$ and current $I(z)$ phasors on a uniform, lossless transmission line:\n$$\n\\frac{dV(z)}{dz} = -j \\omega L' I(z) \\\\\n\\frac{dI(z)}{dz} = -j \\omega C' V(z)\n$$\nwhere $L'$ and $C'$ are the per-unit-length inductance and capacitance, respectively, and $\\omega$ is the angular frequency. The solutions to these coupled equations are traveling waves:\n$$\nV(z) = V_0^+ e^{-j\\beta z} + V_0^- e^{+j\\beta z} \\\\\nI(z) = \\frac{1}{Z_0} \\left( V_0^+ e^{-j\\beta z} - V_0^- e^{+j\\beta z} \\right)\n$$\nHere, $V_0^+$ and $V_0^-$ are the complex amplitudes of the forward- and backward-propagating voltage waves. The propagation constant for a lossless line is $\\beta = \\omega \\sqrt{L'C'}$, and the characteristic impedance is $Z_0 = \\sqrt{L'/C'}$. The coordinate system is defined with the load at $z=0$ and the input port at $z=-l$.\n\nThe input impedance $Z_{in}$ at $z=-l$ is the ratio of the total voltage to the total current at that plane:\n$$\nZ_{in} = \\frac{V(-l)}{I(-l)} = Z_0 \\frac{V_0^+ e^{j\\beta l} + V_0^- e^{-j\\beta l}}{V_0^+ e^{j\\beta l} - V_0^- e^{-j\\beta l}}\n$$\nThe wave amplitudes are related by the load reflection coefficient $\\Gamma_L$ at $z=0$, defined as $\\Gamma_L = (Z_L - Z_0) / (Z_L + Z_0)$, where $Z_L$ is the load impedance. The relation is $V_0^- = \\Gamma_L V_0^+$. Substituting this into the expression for $Z_{in}$ yields:\n$$\nZ_{in} = Z_0 \\frac{e^{j\\beta l} + \\Gamma_L e^{-j\\beta l}}{e^{j\\beta l} - \\Gamma_L e^{-j\\beta l}}\n$$\nSubstituting the definition of $\\Gamma_L$ and using the identities $\\cos(x) = (e^{jx}+e^{-jx})/2$ and $\\sin(x) = (e^{jx}-e^{-jx})/(2j)$, the expression simplifies to the standard form:\n$$\nZ_{in}(Z_0, \\beta, l, Z_L) = Z_0 \\frac{Z_L + j Z_0 \\tan(\\beta l)}{Z_0 + j Z_L \\tan(\\beta l)}\n$$\nThis is the analytical formula for the input impedance of a lossless transmission line of length $l$. For a Transverse Electromagnetic (TEM) wave propagating in free space, the phase velocity is the speed of light, $v_p = c$. The propagation constant is thus $\\beta = \\omega/c = 2\\pi f/c$, where $f$ is the frequency. The free-space wavelength is $\\lambda_0 = c/f$.\n\n**2. Computational Model of Numerical Artifacts**\n\nThe problem defines a computational model that introduces physically plausible perturbations to simulate numerical errors.\n\nThe \"computed\" input impedance, $Z_{in}^{\\mathrm{comp}}(h, L_t)$, is based on perturbed versions of the physical parameters. Discretization of the spatial domain with a mesh of size $h$ introduces numerical dispersion and alters the effective impedance. This is modeled by perturbing $\\beta$ and $Z_0$:\n$$\n\\beta_h = \\beta \\left( 1 - a \\left( \\frac{h}{\\lambda_0} \\right)^p \\right) \\\\\nZ_{0,h} = Z_0 \\left( 1 + b \\left( \\frac{h}{\\lambda_0} \\right)^p \\right)\n$$\nHere, $a$ and $b$ are dimensionless constants, and $p$ is the order of accuracy of the notional numerical method.\n\nThe finite extent of a numerical port, $L_t$, is modeled as an additional series reactance $X_s$ due to localized reactive fields not accounted for in the 1D line model:\n$$\nX_s(L_t) = K \\exp\\left( - \\frac{L_t}{\\lambda_0} \\right)\n$$\nwhere $K$ is a constant with units of impedance.\n\nThe total computed input impedance is the combination of these effects:\n$$\nZ_{in}^{\\mathrm{comp}}(h, L_t) = Z_{in}(Z_{0,h}, \\beta_h, l, Z_L) + j X_s(L_t)\n$$\nThe reflection coefficient at the input port, $\\Gamma(h, L_t)$, is calculated with respect to a reference impedance $Z_{\\mathrm{ref}} = Z_0$ (the unperturbed characteristic impedance):\n$$\n\\Gamma(h, L_t) = \\frac{Z_{in}^{\\mathrm{comp}}(h, L_t) - Z_0}{Z_{in}^{\\mathrm{comp}}(h, L_t) + Z_0}\n$$\n\n**3. Sensitivity Studies and Algorithm**\n\nThe core of the task is to perform two convergence studies for each given test case $(f, l, Z_L)$.\n\nFirst, a **mesh refinement study** is conducted. The port truncation length is held constant at its maximum given value, $L_t^{\\mathrm{max}} = 0.08\\,\\mathrm{m}$, to minimize its influence. The mesh size $h$ is varied through the sequence $\\{h_1, h_2, h_3\\} = \\{5 \\times 10^{-3}, 2.5 \\times 10^{-3}, 1.25 \\times 10^{-3}\\}\\,\\mathrm{m}$. For each $h_i$, the quantities $Z_{in,i}^{\\mathrm{comp}} = Z_{in}^{\\mathrm{comp}}(h_i, L_t^{\\mathrm{max}})$ and $\\Gamma_i = \\Gamma(h_i, L_t^{\\mathrm{max}})$ are computed. The maximum absolute change between successive refinements is then found for three metrics:\n- $\\Delta\\Re\\{Z_{in}^{\\mathrm{comp}}\\}_{\\mathrm{mesh}} = \\max \\left( \\lvert \\Re\\{Z_{in,2}^{\\mathrm{comp}}\\} - \\Re\\{Z_{in,1}^{\\mathrm{comp}}\\} \\rvert, \\lvert \\Re\\{Z_{in,3}^{\\mathrm{comp}}\\} - \\Re\\{Z_{in,2}^{\\mathrm{comp}}\\} \\rvert \\right)$\n- $\\Delta\\Im\\{Z_{in}^{\\mathrm{comp}}\\}_{\\mathrm{mesh}} = \\max \\left( \\lvert \\Im\\{Z_{in,2}^{\\mathrm{comp}}\\} - \\Im\\{Z_{in,1}^{\\mathrm{comp}}\\} \\rvert, \\lvert \\Im\\{Z_{in,3}^{\\mathrm{comp}}\\} - \\Im\\{Z_{in,2}^{\\mathrm{comp}}\\} \\rvert \\right)$\n- $\\Delta\\lvert\\Gamma\\rvert_{\\mathrm{mesh}} = \\max \\left( \\lvert \\lvert\\Gamma_2\\rvert - \\lvert\\Gamma_1\\rvert \\rvert, \\lvert \\lvert\\Gamma_3\\rvert - \\lvert\\Gamma_2\\rvert \\rvert \\right)$\n\nSecond, a **port truncation study** is performed. The mesh size is fixed at its finest value, $h^{\\mathrm{min}} = 1.25 \\times 10^{-3}\\,\\mathrm{m}$, to minimize discretization error. The port length $L_t$ is varied through the sequence $\\{L_{t1}, L_{t2}, L_{t3}\\} = \\{0.02, 0.04, 0.08\\}\\,\\mathrm{m}$. For each $L_{tj}$, the quantities $Z_{in,j}^{\\mathrm{comp}} = Z_{in}^{\\mathrm{comp}}(h^{\\mathrm{min}}, L_{tj})$ and $\\Gamma_j = \\Gamma(h^{\\mathrm{min}}, L_{tj})$ are computed. The maximum absolute changes are calculated similarly:\n- $\\Delta\\Re\\{Z_{in}^{\\mathrm{comp}}\\}_{\\mathrm{port}} = \\max \\left( \\lvert \\Re\\{Z_{in,2}^{\\mathrm{comp}}\\} - \\Re\\{Z_{in,1}^{\\mathrm{comp}}\\} \\rvert, \\lvert \\Re\\{Z_{in,3}^{\\mathrm{comp}}\\} - \\Re\\{Z_{in,2}^{\\mathrm{comp}}\\} \\rvert \\right)$\n- $\\Delta\\Im\\{Z_{in}^{\\mathrm{comp}}\\}_{\\mathrm{port}} = \\max \\left( \\lvert \\Im\\{Z_{in,2}^{\\mathrm{comp}}\\} - \\Im\\{Z_{in,1}^{\\mathrm{comp}}\\} \\rvert, \\lvert \\Im\\{Z_{in,3}^{\\mathrm{comp}}\\} - \\Im\\{Z_{in,2}^{\\mathrm{comp}}\\} \\rvert \\right)$\n- $\\Delta\\lvert\\Gamma\\rvert_{\\mathrm{port}} = \\max \\left( \\lvert \\lvert\\Gamma_2\\rvert - \\lvert\\Gamma_1\\rvert \\rvert, \\lvert \\lvert\\Gamma_3\\rvert - \\lvert\\Gamma_2\\rvert \\rvert \\right)$\n\nThese six values comprise the result for a single test case. The procedure is repeated for all three test cases provided. All calculations use complex numbers as defined in the `numpy` library.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Analyzes the sensitivity of computed input impedance and reflection coefficient\n    of a 1D lossless transmission line to numerical mesh refinement and port truncation.\n    \"\"\"\n\n    # --- Constants and Model Coefficients ---\n    C = 299792458.0  # Speed of light in m/s\n    A = 0.5          # Dimensionless coefficient for beta perturbation\n    B = 0.2          # Dimensionless coefficient for Z0 perturbation\n    P = 2            # Order of discretization error\n    K = 5.0          # Series reactance coefficient in Ohms\n    Z0 = 50.0        # Exact characteristic impedance in Ohms\n\n    # --- Convergence Study Parameters ---\n    mesh_sizes = [5.0e-3, 2.5e-3, 1.25e-3] # h in meters, coarse to fine\n    port_lengths = [0.02, 0.04, 0.08]     # Lt in meters, short to long\n\n    # --- Test Cases ---\n    test_cases = [\n        # (frequency f in Hz, length l in m, load ZL in Ohms)\n        (3.0e9, 0.03, 25 - 15j),\n        (2.7e9, 0.027, 100 + 30j),\n        (1.0e9, 0.005, 50 - 120j),\n    ]\n\n    def compute_perturbed_quantities(f, l, ZL, h, Lt):\n        \"\"\"\n        Computes the perturbed input impedance and reflection coefficient.\n        \"\"\"\n        # Base physical quantities\n        lambda0 = C / f\n        beta = 2 * np.pi / lambda0\n\n        # Perturbed parameters based on mesh size h\n        h_over_lambda_p = (h / lambda0)**P\n        beta_h = beta * (1 - A * h_over_lambda_p)\n        Z0_h = Z0 * (1 + B * h_over_lambda_p)\n\n        # Base perturbed input impedance using the standard tangent formula\n        tan_bl = np.tan(beta_h * l)\n        numerator = ZL + 1j * Z0_h * tan_bl\n        denominator = Z0_h + 1j * ZL * tan_bl\n        Zin_perturbed = Z0_h * (numerator / denominator)\n\n        # Port truncation effect\n        Xs_Lt = K * np.exp(-Lt / lambda0)\n\n        # Total computed input impedance\n        Zin_comp = Zin_perturbed + 1j * Xs_Lt\n\n        # Reflection coefficient with respect to exact Z0\n        Z_ref = Z0\n        Gamma = (Zin_comp - Z_ref) / (Zin_comp + Z_ref)\n\n        return Zin_comp, Gamma\n\n    all_results = []\n    for case in test_cases:\n        f, l, ZL = case\n        case_results = []\n\n        # --- Mesh Refinement Study ---\n        lt_fixed = port_lengths[-1]  # Use largest port length\n        mesh_study_outputs = []\n        for h in mesh_sizes:\n            Zin_comp, Gamma = compute_perturbed_quantities(f, l, ZL, h, lt_fixed)\n            mesh_study_outputs.append((Zin_comp.real, Zin_comp.imag, np.abs(Gamma)))\n        \n        # Calculate max absolute changes between successive refinements\n        # Change between h=5e-3 and h=2.5e-3\n        d_real_z1 = abs(mesh_study_outputs[1][0] - mesh_study_outputs[0][0])\n        d_imag_z1 = abs(mesh_study_outputs[1][1] - mesh_study_outputs[0][1])\n        d_mag_g1 = abs(mesh_study_outputs[1][2] - mesh_study_outputs[0][2])\n        # Change between h=2.5e-3 and h=1.25e-3\n        d_real_z2 = abs(mesh_study_outputs[2][0] - mesh_study_outputs[1][0])\n        d_imag_z2 = abs(mesh_study_outputs[2][1] - mesh_study_outputs[1][1])\n        d_mag_g2 = abs(mesh_study_outputs[2][2] - mesh_study_outputs[1][2])\n\n        case_results.append(max(d_real_z1, d_real_z2))\n        case_results.append(max(d_imag_z1, d_imag_z2))\n        case_results.append(max(d_mag_g1, d_mag_g2))\n\n        # --- Port Truncation Study ---\n        h_fixed = mesh_sizes[-1] # Use finest mesh size\n        port_study_outputs = []\n        for Lt in port_lengths:\n            Zin_comp, Gamma = compute_perturbed_quantities(f, l, ZL, h_fixed, Lt)\n            port_study_outputs.append((Zin_comp.real, Zin_comp.imag, np.abs(Gamma)))\n\n        # Calculate max absolute changes between successive truncations\n        # Change between Lt=0.02 and Lt=0.04\n        d_real_z1 = abs(port_study_outputs[1][0] - port_study_outputs[0][0])\n        d_imag_z1 = abs(port_study_outputs[1][1] - port_study_outputs[0][1])\n        d_mag_g1 = abs(port_study_outputs[1][2] - port_study_outputs[0][2])\n        # Change between Lt=0.04 and Lt=0.08\n        d_real_z2 = abs(port_study_outputs[2][0] - port_study_outputs[1][0])\n        d_imag_z2 = abs(port_study_outputs[2][1] - port_study_outputs[1][1])\n        d_mag_g2 = abs(port_study_outputs[2][2] - port_study_outputs[1][2])\n\n        case_results.append(max(d_real_z1, d_real_z2))\n        case_results.append(max(d_imag_z1, d_imag_z2))\n        case_results.append(max(d_mag_g1, d_mag_g2))\n        \n        all_results.append(case_results)\n\n    # Final print statement in the exact required format.\n    # The string representation of a list of floats includes spaces, which we will keep\n    # to match the example format [x, y, z] implicitly.\n    print(f\"[{','.join(map(str, all_results))}]\")\n\nsolve()\n```", "id": "3319405"}]}