{"hands_on_practices": [{"introduction": "The first-order Born approximation simplifies the complex physics of wave scattering by treating each point in an object as an independent scatterer, ignoring how they influence one another. This practice delves into the breakdown of this core assumption by examining the simplest case of multiple scattering: the interaction between two point scatterers. By deriving and computing the second-order term in the Born series, you will directly model this coherent interaction and quantify its impact on the final interference pattern, building fundamental intuition for when and why linear approximations fail. [@problem_id:3290130]", "problem": "You are to study multiple scattering and coherent interaction between two identical point scatterers in the scalar time-harmonic Helmholtz setting and quantify the onset of breakdown of the Born approximation observed via an interference pattern on a detector line. Start from the scalar Helmholtz equation in two spatial dimensions for the total field $E(\\mathbf{r})$,\n$$\n\\nabla^2 E(\\mathbf{r}) + k_0^2 \\bigl(1 + \\chi(\\mathbf{r})\\bigr) E(\\mathbf{r}) = 0,\n$$\nwhere $k_0 = 2\\pi/\\lambda$ is the free-space wavenumber for wavelength $\\lambda$, and $\\chi(\\mathbf{r})$ is a dimensionless scattering contrast. The associated Lippmann–Schwinger integral equation is\n$$\nE(\\mathbf{r}) = E_{\\mathrm{inc}}(\\mathbf{r}) + k_0^2 \\int_{\\mathbb{R}^2} G(\\mathbf{r},\\mathbf{r}') \\chi(\\mathbf{r}') E(\\mathbf{r}') \\,\\mathrm{d}\\mathbf{r}',\n$$\nwhere $E_{\\mathrm{inc}}(\\mathbf{r})$ is the incident field and $G(\\mathbf{r},\\mathbf{r}')$ is the two-dimensional free-space Green's function defined by\n$$\nG(\\mathbf{r},\\mathbf{r}') = \\frac{i}{4} H_0^{(1)}\\!\\big(k_0 \\lVert \\mathbf{r}-\\mathbf{r}' \\rVert\\big),\n$$\nwith $H_0^{(1)}$ the Hankel function of the first kind of order zero. Consider two identical point scatterers with contrast $\\chi_0$ located at $\\mathbf{r}_1 = (-d/2,0)$ and $\\mathbf{r}_2 = (d/2,0)$, so that the contrast distribution is\n$$\n\\chi(\\mathbf{r}) = \\chi_0 \\delta(\\mathbf{r}-\\mathbf{r}_1) + \\chi_0 \\delta(\\mathbf{r}-\\mathbf{r}_2).\n$$\nAssume a plane wave incident field propagating along the $x$-axis, $E_{\\mathrm{inc}}(\\mathbf{r}) = e^{i k_0 x}$. The first-order Born approximation replaces $E(\\mathbf{r}')$ by $E_{\\mathrm{inc}}(\\mathbf{r}')$ in the Lippmann–Schwinger integral. The second-order Born term arises when $E(\\mathbf{r}')$ is replaced in the integrand by its first-order Born field, producing a double integral term. Using the distributional representation of $\\chi(\\mathbf{r})$, the double integral simplifies to a discrete sum. In this setting, you must model coherent interaction between the two scatterers by retaining only the cross-scattering terms, that is, terms proportional to $G(\\mathbf{r}_1,\\mathbf{r}_2)$ or $G(\\mathbf{r}_2,\\mathbf{r}_1)$, and neglect self-interaction terms $G(\\mathbf{r}_j,\\mathbf{r}_j)$ to avoid singular self-terms in the point-scatterer model. This corresponds to the usual principal value interpretation that excludes self-energy in multiple scattering approximations.\n\nYour tasks are:\n- Derive expressions for the first-order Born scattered field $E^{(1)}(\\mathbf{r})$ and the second-order Born cross-scattering field $E^{(2)}_{\\mathrm{cross}}(\\mathbf{r})$ on a detector line at $y=L$ as functions of the observation coordinate $x$ and the separation $d$, using the two-dimensional Green's function defined above.\n- Show how the second-order Born cross term encodes coherent interaction through $G(\\mathbf{r}_1,\\mathbf{r}_2)$ as $d$ varies.\n- Design a quantitative, interference-based indicator that detects the onset of Born breakdown: define the detector intensity under the first-order Born model,\n$$\nI_1(x) = \\big\\lvert E^{(1)}(x,L)\\big\\rvert^2,\n$$\nand the intensity with first and second-order cross terms included,\n$$\nI_{12}(x) = \\big\\lvert E^{(1)}(x,L) + E^{(2)}_{\\mathrm{cross}}(x,L)\\big\\rvert^2.\n$$\nDefine the maximum fractional deviation\n$$\nR = \\frac{\\max_{x\\in[-X_{\\max},X_{\\max}]} \\big\\lvert I_{12}(x) - I_1(x)\\big\\rvert}{\\max_{x\\in[-X_{\\max},X_{\\max}]} I_1(x)},\n$$\nwhich is a unitless decimal. This indicator reflects the strength of coherent multiple scattering relative to the first-order Born prediction. You will compute $R$ for several parameter sets and thereby design an experiment that detects the onset of Born breakdown as $d$ varies and as $\\chi_0$ increases, using the criterion that larger $R$ indicates stronger departure from the first-order Born interference pattern.\n\nPhysical units and numerical conventions:\n- All lengths ($\\lambda$, $d$, $L$, $X_{\\max}$) are to be specified in meters (m).\n- The angle of incidence is measured in radians; here it is $0$ radians along the $x$-axis.\n- The output $R$ is unitless and must be expressed as a decimal.\n\nImplement a complete, runnable program that:\n- Uses the two-dimensional Green’s function $G(\\mathbf{r},\\mathbf{r}')$ as given above.\n- Computes $E^{(1)}(x,L)$ and $E^{(2)}_{\\mathrm{cross}}(x,L)$ for an array of detector points $x$ uniformly spanning $\\left[-X_{\\max},X_{\\max}\\right]$ with $N_x$ points.\n- Computes the indicator $R$ defined above for each test case listed below.\n- Produces a single line of output containing the results as a comma-separated list enclosed in square brackets, for example, $\\left[0.12345,0.06789\\right]$.\n\nTest suite:\n- Case $1$: $\\lambda = 0.5$ m, $\\chi_0 = 0.05$, $d = 0.05$ m, $L = 2.0$ m, $X_{\\max} = 1.0$ m, $N_x = 1001$.\n- Case $2$: $\\lambda = 0.5$ m, $\\chi_0 = 0.20$, $d = 0.05$ m, $L = 2.0$ m, $X_{\\max} = 1.0$ m, $N_x = 1001$.\n- Case $3$: $\\lambda = 0.5$ m, $\\chi_0 = 0.05$, $d = 0.5$ m, $L = 2.0$ m, $X_{\\max} = 1.0$ m, $N_x = 1001$.\n- Case $4$: $\\lambda = 0.5$ m, $\\chi_0 = 0.05$, $d = 5.0$ m, $L = 2.0$ m, $X_{\\max} = 1.0$ m, $N_x = 1001$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets in the order of the cases listed above, for example, $\\left[r_1,r_2,r_3,r_4\\right]$, where each $r_j$ is the computed decimal value of $R$ for Case $j$.", "solution": "The problem requires an analysis of multiple scattering between two point scatterers in two dimensions using the Born series expansion of the Lippmann-Schwinger integral equation. The objective is to derive the first-order and second-order (cross-term only) scattered fields, and then use these to construct a quantitative indicator, $R$, that measures the deviation from the first-order Born approximation. This indicator will be computed for several parameter sets.\n\nThe analysis begins with the time-harmonic scalar Helmholtz equation for the total field $E(\\mathbf{r})$ in a medium with scattering contrast $\\chi(\\mathbf{r})$:\n$$\n\\nabla^2 E(\\mathbf{r}) + k_0^2 \\bigl(1 + \\chi(\\mathbf{r})\\bigr) E(\\mathbf{r}) = 0,\n$$\nwhere $k_0 = 2\\pi/\\lambda$ is the free-space wavenumber. This differential equation can be reformulated as the Lippmann-Schwinger integral equation:\n$$\nE(\\mathbf{r}) = E_{\\mathrm{inc}}(\\mathbf{r}) + k_0^2 \\int_{\\mathbb{R}^2} G(\\mathbf{r},\\mathbf{r}') \\chi(\\mathbf{r}') E(\\mathbf{r}') \\,\\mathrm{d}\\mathbf{r}',\n$$\nwhere $E_{\\mathrm{inc}}(\\mathbf{r})$ is the incident field and $G(\\mathbf{r},\\mathbf{r}')$ is the free-space Green's function. In two dimensions, $G(\\mathbf{r},\\mathbf{r}') = \\frac{i}{4} H_0^{(1)}\\!\\big(k_0 \\lVert \\mathbf{r}-\\mathbf{r}' \\rVert\\big)$, where $H_0^{(1)}$ is the Hankel function of the first kind of order zero.\n\nThe problem considers two identical point scatterers of strength $\\chi_0$ located at $\\mathbf{r}_1 = (-d/2, 0)$ and $\\mathbf{r}_2 = (d/2, 0)$. The scattering contrast is thus modeled by a sum of Dirac delta functions:\n$$\n\\chi(\\mathbf{r}) = \\chi_0 \\delta(\\mathbf{r}-\\mathbf{r}_1) + \\chi_0 \\delta(\\mathbf{r}-\\mathbf{r}_2).\n$$\nThe incident field is a plane wave propagating along the $x$-axis, $E_{\\mathrm{inc}}(\\mathbf{r}) = e^{i k_0 x}$.\n\n**Derivation of the First-Order Born Scattered Field, $E^{(1)}(\\mathbf{r})$**\n\nThe first-order Born approximation, $E^{(1)}(\\mathbf{r})$, is found by replacing the total field $E(\\mathbf{r}')$ inside the integral with the incident field $E_{\\mathrm{inc}}(\\mathbf{r}')$. This represents single scattering events.\n$$\nE^{(1)}(\\mathbf{r}) = k_0^2 \\int_{\\mathbb{R}^2} G(\\mathbf{r},\\mathbf{r}') \\chi(\\mathbf{r}') E_{\\mathrm{inc}}(\\mathbf{r}') \\,\\mathrm{d}\\mathbf{r}'.\n$$\nSubstituting the expression for $\\chi(\\mathbf{r}')$ and using the sifting property of the delta function, we get:\n$$\nE^{(1)}(\\mathbf{r}) = k_0^2 \\int_{\\mathbb{R}^2} G(\\mathbf{r},\\mathbf{r}') \\left[ \\chi_0 \\delta(\\mathbf{r}'-\\mathbf{r}_1) + \\chi_0 \\delta(\\mathbf{r}'-\\mathbf{r}_2) \\right] E_{\\mathrm{inc}}(\\mathbf{r}') \\,\\mathrm{d}\\mathbf{r}' \\\\\n= k_0^2 \\chi_0 \\left[ G(\\mathbf{r},\\mathbf{r}_1) E_{\\mathrm{inc}}(\\mathbf{r}_1) + G(\\mathbf{r},\\mathbf{r}_2) E_{\\mathrm{inc}}(\\mathbf{r}_2) \\right].\n$$\nThe incident field values at the scatterer locations are $E_{\\mathrm{inc}}(\\mathbf{r}_1) = e^{i k_0 (-d/2)} = e^{-i k_0 d/2}$ and $E_{\\mathrm{inc}}(\\mathbf{r}_2) = e^{i k_0 (d/2)} = e^{i k_0 d/2}$. Thus, the first-order scattered field is:\n$$\nE^{(1)}(\\mathbf{r}) = k_0^2 \\chi_0 \\left[ G(\\mathbf{r},\\mathbf{r}_1) e^{-i k_0 d/2} + G(\\mathbf{r},\\mathbf{r}_2) e^{i k_0 d/2} \\right].\n$$\n\n**Derivation of the Second-Order Born Cross-Scattering Field, $E^{(2)}_{\\mathrm{cross}}(\\mathbf{r})$**\n\nThe second-order Born term, $E^{(2)}(\\mathbf{r})$, is obtained by using the first-order scattered field $E^{(1)}(\\mathbf{r}')$ in the Lippmann-Schwinger integral. This accounts for double scattering events.\n$$\nE^{(2)}(\\mathbf{r}) = k_0^2 \\int_{\\mathbb{R}^2} G(\\mathbf{r},\\mathbf{r}') \\chi(\\mathbf{r}') E^{(1)}(\\mathbf{r}') \\,\\mathrm{d}\\mathbf{r}'.\n$$\nSubstituting the integral form of $E^{(1)}(\\mathbf{r}')$ gives a double integral:\n$$\nE^{(2)}(\\mathbf{r}) = (k_0^2)^2 \\iint G(\\mathbf{r}, \\mathbf{r}') \\chi(\\mathbf{r}') G(\\mathbf{r}',\\mathbf{r}'') \\chi(\\mathbf{r}'') E_{\\mathrm{inc}}(\\mathbf{r}'') \\,\\mathrm{d}\\mathbf{r}'' \\mathrm{d}\\mathbf{r}'.\n$$\nUsing the delta-function model for $\\chi$ resolves the integrals into a discrete sum over the scatterer indices $j,k \\in \\{1,2\\}$:\n$$\nE^{(2)}(\\mathbf{r}) = (k_0^2 \\chi_0)^2 \\sum_{j=1}^{2} \\sum_{k=1}^{2} G(\\mathbf{r},\\mathbf{r}_j) G(\\mathbf{r}_j,\\mathbf{r}_k) E_{\\mathrm{inc}}(\\mathbf{r}_k).\n$$\nThe problem specifies to retain only the cross-scattering terms, where $j \\neq k$. This is a standard procedure to avoid the non-physical singularities associated with a point scatterer's self-interaction (the $G(\\mathbf{r}_j,\\mathbf{r}_j)$ terms). This corresponds to wave propagation from scatterer $k$ to scatterer $j$ and then to the observer. The cross-scattering field is therefore:\n$$\nE^{(2)}_{\\mathrm{cross}}(\\mathbf{r}) = (k_0^2 \\chi_0)^2 \\left[ G(\\mathbf{r},\\mathbf{r}_1) G(\\mathbf{r}_1,\\mathbf{r}_2) E_{\\mathrm{inc}}(\\mathbf{r}_2) + G(\\mathbf{r},\\mathbf{r}_2) G(\\mathbf{r}_2,\\mathbf{r}_1) E_{\\mathrm{inc}}(\\mathbf{r}_1) \\right].\n$$\nUsing the reciprocity of the Green's function, $G(\\mathbf{r}_1,\\mathbf{r}_2) = G(\\mathbf{r}_2,\\mathbf{r}_1) = \\frac{i}{4} H_0^{(1)}(k_0 d)$, and the incident field values, we get:\n$$\nE^{(2)}_{\\mathrm{cross}}(\\mathbf{r}) = (k_0^2 \\chi_0)^2 G(\\mathbf{r}_1,\\mathbf{r}_2) \\left[ G(\\mathbf{r},\\mathbf{r}_1) e^{i k_0 d/2} + G(\\mathbf{r},\\mathbf{r}_2) e^{-i k_0 d/2} \\right].\n$$\nThis term explicitly contains the factor $G(\\mathbf{r}_1,\\mathbf{r}_2)$, which mediates the coherent interaction between the two scatterers. Its magnitude depends on the separation $d$.\n\n**Final Expressions and Quantitative Indicator**\n\nFor numerical computation, we evaluate the fields at an observation point $\\mathbf{r} = (x, L)$ on the detector line. Let $G_j(x,L) = G((x,L), \\mathbf{r}_j)$. The required fields are:\n$$\nE^{(1)}(x,L) = k_0^2 \\chi_0 \\left[ G_1(x,L) e^{-i k_0 d/2} + G_2(x,L) e^{i k_0 d/2} \\right]\n$$\n$$\nE^{(2)}_{\\mathrm{cross}}(x,L) = (k_0^2 \\chi_0)^2 G(\\mathbf{r}_1,\\mathbf{r}_2) \\left[ G_1(x,L) e^{i k_0 d/2} + G_2(x,L) e^{-i k_0 d/2} \\right]\n$$\nwhere\n$G_1(x,L) = \\frac{i}{4} H_0^{(1)}\\!\\left(k_0 \\sqrt{(x+d/2)^2 + L^2}\\right)$,\n$G_2(x,L) = \\frac{i}{4} H_0^{(1)}\\!\\left(k_0 \\sqrt{(x-d/2)^2 + L^2}\\right)$,\nand $G(\\mathbf{r}_1,\\mathbf{r}_2) = \\frac{i}{4} H_0^{(1)}(k_0 d)$.\n\nThe intensities are calculated as $I_1(x) = \\big\\lvert E^{(1)}(x,L)\\big\\rvert^2$ and $I_{12}(x) = \\big\\lvert E^{(1)}(x,L) + E^{(2)}_{\\mathrm{cross}}(x,L)\\big\\rvert^2$. The indicator $R$ measures the maximum fractional change in the intensity pattern due to the inclusion of the second-order multiple scattering term:\n$$\nR = \\frac{\\max_{x\\in[-X_{\\max},X_{\\max}]} \\big\\lvert I_{12}(x) - I_1(x)\\big\\rvert}{\\max_{x\\in[-X_{\\max},X_{\\max}]} I_1(x)}.\n$$\n\n**Numerical Strategy**\n\nThe computation proceeds by first defining the grid of $N_x$ points for $x$ in $[-X_{\\max}, X_{\\max}]$. Then, for each parameter set $(\\lambda, \\chi_0, d, L, X_{\\max})$:\n1.  Calculate the wavenumber $k_0 = 2\\pi/\\lambda$.\n2.  Compute the arguments of the Hankel functions for $G_1$, $G_2$, and $G(\\mathbf{r}_1,\\mathbf{r}_2)$ as NumPy arrays.\n3.  Evaluate the Green's functions using `scipy.special.hankel1`.\n4.  Assemble the complex-valued fields $E^{(1)}(x,L)$ and $E^{(2)}_{\\mathrm{cross}}(x,L)$ vectorially over the $x$-grid.\n5.  Calculate the intensities $I_1(x)$ and $I_{12}(x)$.\n6.  Find the maximum values required for the numerator and denominator of $R$ and compute their ratio.\nThis procedure is repeated for each test case.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import special\n\ndef solve():\n    \"\"\"\n    Computes the Born breakdown indicator R for a series of test cases\n    in a 2D scalar multiple scattering problem.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Format: (lambda (m), chi_0, d (m), L (m), X_max (m), N_x)\n    test_cases = [\n        (0.5, 0.05, 0.05, 2.0, 1.0, 1001),\n        (0.5, 0.20, 0.05, 2.0, 1.0, 1001),\n        (0.5, 0.05, 0.5, 2.0, 1.0, 1001),\n        (0.5, 0.05, 5.0, 2.0, 1.0, 1001),\n    ]\n\n    results = []\n    for case in test_cases:\n        # Unpack parameters for the current case\n        lambda_val, chi_0, d, L, X_max, N_x = case\n\n        # --- Initial Setup ---\n        # Free-space wavenumber\n        k_0 = 2.0 * np.pi / lambda_val\n        \n        # Detector coordinates\n        x_coords = np.linspace(-X_max, X_max, N_x)\n\n        # --- Green's Function Components ---\n        # Distances from each scatterer to the detector points\n        dist_1 = np.sqrt((x_coords + d / 2.0)**2 + L**2)\n        dist_2 = np.sqrt((x_coords - d / 2.0)**2 + L**2)\n\n        # Green's functions from scatterers to detector points\n        # G_j(x, L) = (i/4) * H_0^(1) (k_0 * ||r - r_j||)\n        G_1 = (1j / 4.0) * special.hankel1(0, k_0 * dist_1)\n        G_2 = (1j / 4.0) * special.hankel1(0, k_0 * dist_2)\n\n        # --- Field Calculations ---\n        # Incident field phase factors at the scatterer locations\n        # E_inc(r_1) = exp(-i*k_0*d/2) and E_inc(r_2) = exp(i*k_0*d/2)\n        phase_inc_at_r1 = np.exp(-1j * k_0 * d / 2.0)\n        phase_inc_at_r2 = np.exp(1j * k_0 * d / 2.0)\n\n        # --- First-Order Born Scattered Field E^(1) ---\n        # E^(1) = k_0^2 * chi_0 * [G_1 * E_inc(r_1) + G_2 * E_inc(r_2)]\n        E1_field = (k_0**2 * chi_0) * (G_1 * phase_inc_at_r1 + G_2 * phase_inc_at_r2)\n\n        # --- Second-Order Cross-Scattering Field E^(2)_cross ---\n        # Green's function between scatterers G(r_1, r_2)\n        # The argument is k_0 * ||r_1 - r_2|| = k_0 * d\n        G_12 = (1j / 4.0) * special.hankel1(0, k_0 * d)\n        \n        # E^(2)_cross = (k_0^2 * chi_0)^2 * G_12 * [G_1 * E_inc(r_2) + G_2 * E_inc(r_1)]\n        # Note the swapped phase factors corresponding to the interaction path\n        E2_cross_field = ((k_0**2 * chi_0)**2) * G_12 * (G_1 * phase_inc_at_r2 + G_2 * phase_inc_at_r1)\n\n        # --- Intensity Calculations ---\n        # I_1 = |E^(1)|^2\n        I_1 = np.abs(E1_field)**2\n        # I_12 = |E^(1) + E^(2)_cross|^2\n        I_12 = np.abs(E1_field + E2_cross_field)**2\n\n        # --- Quantitative Indicator R ---\n        # R = max|I_12 - I_1| / max|I_1|\n        numerator = np.max(np.abs(I_12 - I_1))\n        denominator = np.max(I_1)\n        \n        if denominator == 0:\n            # This case is physically unexpected for this problem setup.\n            # If max I_1 is 0, the first-order field is null everywhere.\n            # Assign inf if numerator is non-zero, otherwise 0.\n            R = np.inf if numerator > 0 else 0.0\n        else:\n            R = numerator / denominator\n        \n        results.append(R)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3290130"}, {"introduction": "While the Born approximation linearizes the field itself, the Rytov approximation linearizes its complex phase, often providing a more accurate model for strong phase objects or when the total phase shift is large. This exercise guides you through designing a numerical experiment where a common artifact—an unknown instrument calibration gain—causes the Born model to produce non-physical results like negative absorption. You will then demonstrate how the Rytov approximation, when combined with the physical principle of causality through the Kramers-Kronig relations, can successfully diagnose and correct for this error to yield a physically meaningful reconstruction. [@problem_id:3290082]", "problem": "Consider the scalar electromagnetic scattering of a monochromatic plane wave in a one-dimensional slab geometry governed by the scalar Helmholtz equation for the total field. Let the time-harmonic convention be $e^{-i\\omega t}$ and the scalar field be $u(x,\\omega)$ that satisfies\n$$\n\\frac{d^2 u}{dx^2} + k_0^2 n^2(\\omega)\\,u = 0,\n$$\nwhere $k_0 = \\omega/c$, $c$ is the speed of light in vacuum in $\\mathrm{m/s}$, and $n(\\omega)$ is the complex refractive index. Define a background refractive index $n_0 = \\sqrt{\\varepsilon_\\infty}$ with $\\varepsilon_\\infty > 0$ real, and a slab of thickness $L$ with causal, passive relative permittivity $\\varepsilon_r(\\omega)$ such that $\\operatorname{Im}\\{\\varepsilon_r(\\omega)\\} \\ge 0$ for all angular frequencies $\\omega$ in the band of interest (passivity). The complex refractive index is $n(\\omega) = \\sqrt{\\varepsilon_r(\\omega)}$ chosen on the principal branch with $\\operatorname{Im}\\{n(\\omega)\\} \\ge 0$. The incident field is a plane wave propagating in the $+x$ direction.\n\nDefine the transmitted field at $x=L$ normalized by the transmitted field through a background slab of the same thickness as\n$$\nd(\\omega) = \\exp\\big( i k_0 L\\,(n(\\omega) - n_0)\\big),\n$$\nwhich is the exact transmission ratio when internal reflections are negligible. In practice, instrumentation often introduces an unknown, frequency-dependent calibration gain $g(\\omega) > 0$ affecting the measured data, so the measured transmission ratio is\n$$\nd_{\\mathrm{meas}}(\\omega) = g(\\omega)\\,d(\\omega).\n$$\n\nWe wish to recover the complex contrast $\\Delta m(\\omega) = n(\\omega) - n_0 = \\Delta n(\\omega) + i\\,\\kappa(\\omega)$ from the measured data by linearized models. Two common linearizations are:\n\n1. The Born approximation (linearization of the field):\n$$\n\\Delta m_{\\mathrm{Born}}(\\omega) \\approx \\frac{d_{\\mathrm{meas}}(\\omega) - 1}{i\\,k_0\\,L}.\n$$\n\n2. The Rytov approximation (linearization of the complex logarithm of the field):\n$$\n\\psi(\\omega) = \\ln d_{\\mathrm{meas}}(\\omega), \\quad \\Delta m_{\\mathrm{Rytov}}(\\omega) \\approx \\frac{\\psi(\\omega)}{i\\,k_0\\,L}.\n$$\n\nDefine the absorption coefficient $\\alpha(\\omega)$ in units of $\\mathrm{m^{-1}}$ as\n$$\n\\alpha(\\omega) = 2\\,k_0\\,\\kappa(\\omega).\n$$\nPassivity requires $\\alpha(\\omega) \\ge 0$ for all $\\omega$.\n\nThe Kramers–Kronig relations (KK; named after Hendrik Anthony Kramers and Ralph Kronig) for minimum-phase transmission relate the phase $\\phi(\\omega) = \\arg d(\\omega)$ and the magnitude $A(\\omega) = |d(\\omega)|$ via a Hilbert transform. Under the assumptions of causality and minimum-phase, the following relation holds (up to an additive constant due to unknown absolute calibration gain):\n$$\n\\phi(\\omega) = -\\mathcal{H}\\left[\\ln A(\\omega)\\right](\\omega) + \\phi_0,\n$$\nwhere $\\mathcal{H}[\\cdot]$ denotes the Hilbert transform on the frequency axis, and $\\phi_0$ is a real constant. Equivalently,\n$$\n\\ln A(\\omega) = \\mathcal{H}\\left[\\phi(\\omega)\\right](\\omega) + \\ln A_0,\n$$\nwith a constant $\\ln A_0$ reflecting the unknown absolute gain.\n\nYou are to design a benchmark phantom (i.e., a frequency-dependent $\\varepsilon_r(\\omega)$ and measurement model with a calibration gain $g(\\omega)$) such that the Born approximation predicts non-physical negative absorption $\\alpha_{\\mathrm{Born}}(\\omega) < 0$ at some frequencies, while the Kramers–Kronig-consistent Rytov reconstruction does not. Use a physically-plausible Debye dispersion model for $\\varepsilon_r(\\omega)$:\n$$\n\\varepsilon_r(\\omega) = \\varepsilon_\\infty + \\frac{\\Delta\\varepsilon}{1 - i\\,\\omega\\,\\tau} + i\\,\\frac{\\sigma}{\\varepsilon_0\\,\\omega},\n$$\nwhere $\\varepsilon_0$ is the vacuum permittivity in $\\mathrm{F/m}$, $\\Delta\\varepsilon > 0$, $\\tau > 0$, and $\\sigma \\ge 0$. Choose parameters so that $\\operatorname{Im}\\{\\varepsilon_r(\\omega)\\} \\ge 0$ for all $\\omega$ in the band.\n\nTo stress the linearization, define a smooth, real calibration gain profile\n$$\ng(\\omega) = 1 + b\\,\\exp\\Big(-\\frac{(\\omega - \\omega_c)^2}{2\\,\\sigma_\\omega^2}\\Big),\n$$\nwith $b \\ge 0$, $\\omega_c$ in the band, and $\\sigma_\\omega > 0$. This calibration gain is not part of the physics and can lead to apparent violations of passivity under the Born linearization. The Rytov method should be used together with Kramers–Kronig consistency to diagnose and correct this calibration bias: reconstruct $\\ln A(\\omega)$ from the measured phase $\\phi_{\\mathrm{meas}}(\\omega) = \\arg d_{\\mathrm{meas}}(\\omega)$ using a discrete Hilbert transform on the sampled frequency axis, then choose the additive constant to enforce passivity, and form $\\psi(\\omega) = \\ln A_{\\mathrm{KK}}(\\omega) + i\\,\\phi_{\\mathrm{meas}}(\\omega)$ to obtain $\\Delta m_{\\mathrm{Rytov}}(\\omega)$ and hence $\\alpha_{\\mathrm{Rytov}}(\\omega)$.\n\nImplementation constraints:\n\n- Use angular frequency $\\omega$ in $\\mathrm{rad/s}$, slab thickness $L$ in $\\mathrm{m}$, and report absorption in $\\mathrm{m^{-1}}$.\n- Use angles in radians.\n- Construct a frequency grid that is uniformly sampled over a finite band $[\\omega_{\\min},\\omega_{\\max}]$. Apply a suitable windowing to the data before the discrete Hilbert transform to reduce edge artifacts, and account for the unknown additive constant in the Kramers–Kronig amplitude reconstruction by enforcing passivity $\\ln A(\\omega) \\le 0$.\n- Use $n(\\omega) = \\sqrt{\\varepsilon_r(\\omega)}$ with the principal branch of the complex square root.\n\nTest Suite:\n\nLet $c = 3.0\\times 10^8\\,\\mathrm{m/s}$, $\\varepsilon_\\infty = 2.25$, $\\Delta\\varepsilon = 0.75$, $\\tau = 1.0\\times 10^{-12}\\,\\mathrm{s}$, $\\sigma = 0$, $L = 0.01\\,\\mathrm{m}$, $\\omega_{\\min} = 1.0\\times 10^{13}\\,\\mathrm{rad/s}$, $\\omega_{\\max} = 3.0\\times 10^{14}\\,\\mathrm{rad/s}$, $\\omega_c = 1.5\\times 10^{14}\\,\\mathrm{rad/s}$, and $\\sigma_\\omega = 2.0\\times 10^{13}\\,\\mathrm{rad/s}$. Consider the following three calibration gains:\n- Case 1 (happy path): $b = 0.0$.\n- Case 2 (moderate bias): $b = 0.03$.\n- Case 3 (strong bias): $b = 0.08$.\n\nFor each case, compute\n$$\n\\alpha_{\\mathrm{Born}}(\\omega) = 2\\,k_0\\,\\operatorname{Im}\\{\\Delta m_{\\mathrm{Born}}(\\omega)\\},\n\\quad\n\\alpha_{\\mathrm{Rytov}}(\\omega) = 2\\,k_0\\,\\operatorname{Im}\\{\\Delta m_{\\mathrm{Rytov}}(\\omega)\\}.\n$$\nReturn, for each case, a boolean indicating whether there exists any $\\omega$ in the band such that $\\alpha_{\\mathrm{Born}}(\\omega) < 0$ and whether there exists any $\\omega$ such that $\\alpha_{\\mathrm{Rytov}}(\\omega) < 0$ after Kramers–Kronig amplitude reconstruction and passivity enforcement. Your program should produce a single line of output containing the six booleans for the three cases, in order and aggregated as a comma-separated list enclosed in square brackets (e.g., \"[b1,b2,b3,r1,r2,r3]\").", "solution": "The user has provided a valid, well-posed problem in computational electromagnetics. The task is to construct a numerical phantom to demonstrate a key difference between the Born and Rytov approximations for inverse scattering, particularly in the presence of measurement calibration errors. I will proceed with a full, reasoned solution.\n\nThe problem requires a comparison of two linearized models, the Born and Rytov approximations, for reconstructing the material properties of a slab from its transmission response. We are asked to design a scenario where the simpler Born approximation yields a non-physical result (negative absorption), while a more sophisticated approach combining the Rytov approximation with Kramers–Kronig (KK) consistency enforcement produces a physically valid result.\n\nThe solution proceeds in four main steps for each test case:\n1.  **Ground Truth Simulation**: We first compute the \"true\" physical quantities. The frequency-dependent relative permittivity $\\varepsilon_r(\\omega)$ is defined by the Debye model.\n    $$\n    \\varepsilon_r(\\omega) = \\varepsilon_\\infty + \\frac{\\Delta\\varepsilon}{1 - i\\,\\omega\\,\\tau}\n    $$\n    The term involving conductivity $\\sigma$ is omitted as $\\sigma=0$ is specified. The complex refractive index $n(\\omega)$ is then found using the principal branch of the square root, $n(\\omega) = \\sqrt{\\varepsilon_r(\\omega)}$, ensuring that the imaginary part is non-negative, $\\operatorname{Im}\\{n(\\omega)\\} \\ge 0$, which corresponds to a passive medium. The true single-pass transmission ratio $d(\\omega)$ through the slab of thickness $L$ is given by:\n    $$\n    d(\\omega) = \\exp\\big( i k_0 L\\,(n(\\omega) - n_0)\\big)\n    $$\n    where $k_0 = \\omega/c$ is the vacuum wavenumber and $n_0 = \\sqrt{\\varepsilon_\\infty}$ is the background refractive index.\n\n2.  **Measurement Model**: The simulated \"measured\" data, $d_{\\mathrm{meas}}(\\omega)$, includes a frequency-dependent real-valued calibration gain $g(\\omega) > 0$.\n    $$\n    g(\\omega) = 1 + b\\,\\exp\\Big(-\\frac{(\\omega - \\omega_c)^2}{2\\,\\sigma_\\omega^2}\\Big)\n    $$\n    $$\n    d_{\\mathrm{meas}}(\\omega) = g(\\omega)\\,d(\\omega)\n    $$\n    This gain corrupts the magnitude of the measurement, $|d_{\\mathrm{meas}}| = g(\\omega)|d(\\omega)|$, but leaves the phase unchanged, $\\arg(d_{\\mathrm{meas}}) = \\arg(d(\\omega))$, since $g(\\omega)$ is real and positive.\n\n3.  **Born Approximation Reconstruction**: The Born approximation linearizes the scattered field. The reconstructed material contrast $\\Delta m_{\\mathrm{Born}}(\\omega)$ and the corresponding absorption coefficient $\\alpha_{\\mathrm{Born}}(\\omega)$ are calculated from the measured data.\n    $$\n    \\Delta m_{\\mathrm{Born}}(\\omega) \\approx \\frac{d_{\\mathrm{meas}}(\\omega) - 1}{i\\,k_0\\,L}\n    $$\n    The absorption coefficient is $\\alpha(\\omega) = 2\\,k_0\\,\\operatorname{Im}\\{\\Delta m(\\omega)\\}$. A careful derivation yields:\n    $$\n    \\alpha_{\\mathrm{Born}}(\\omega) = 2\\,k_0\\,\\operatorname{Im}\\left\\{\\frac{d_{\\mathrm{meas}}(\\omega) - 1}{i\\,k_0\\,L}\\right\\} = \\frac{2}{L}\\left(1 - \\operatorname{Re}\\{d_{\\mathrm{meas}}(\\omega)\\}\\right) = \\frac{2}{L}\\left(1 - g(\\omega)\\operatorname{Re}\\{d(\\omega)\\}\\right)\n    $$\n    The term $\\operatorname{Re}\\{d(\\omega)\\}$ oscillates, and amplification by $g(\\omega) > 1$ can easily cause $g(\\omega)\\operatorname{Re}\\{d(\\omega)\\} > 1$, leading to the non-physical prediction of an active medium, $\\alpha_{\\mathrm{Born}}(\\omega) < 0$. This failure is exacerbated in this problem because the slab is electrically very thick (large $k_0 L$), which pushes the system far outside the regime of validity for the Born approximation.\n\n4.  **Kramers–Kronig-Consistent Rytov Reconstruction**: The Rytov approximation linearizes the complex phase (logarithm) of the field.\n    $$\n    \\Delta m_{\\mathrm{Rytov}}(\\omega) \\approx \\frac{\\ln d_{\\mathrm{meas}}(\\omega)}{i\\,k_0\\,L}\n    $$\n    The key insight is to not use $\\ln d_{\\mathrm{meas}}(\\omega)$ directly, as its real part, $\\ln|d_{\\mathrm{meas}}| = \\ln g(\\omega) + \\ln|d(\\omega)|$, is corrupted by the gain. Instead, we leverage the Kramers–Kronig relations, which connect the real and imaginary parts of the logarithm of a causal, minimum-phase function. The transmission function $d(\\omega)$ is such a function. Its phase, $\\phi(\\omega) = \\arg d(\\omega)$, is immune to the gain, i.e., $\\phi_{\\mathrm{meas}}(\\omega) = \\phi(\\omega)$. We can therefore reconstruct a physically consistent log-amplitude, $\\ln A_{\\mathrm{KK}}(\\omega)$, from the measured phase $\\phi_{\\mathrm{meas}}(\\omega)$ using the Hilbert transform:\n    $$\n    \\ln A_{\\mathrm{KK}}(\\omega) = \\mathcal{H}[\\phi_{\\mathrm{meas}}](\\omega) + C\n    $$\n    where $\\mathcal{H}[\\cdot]$ denotes the Hilbert transform and $C$ is a constant. The problem specifies numerically implementing the Hilbert transform on a finite frequency grid, for which we apply a Tukey window to $\\phi_{\\mathrm{meas}}$ to mitigate edge-effect artifacts. The constant $C$ is determined by enforcing the physical passivity constraint $\\alpha(\\omega) \\ge 0$. The Rytov-reconstructed absorption is:\n    $$\n    \\alpha_{\\mathrm{Rytov}}(\\omega) = 2\\,k_0\\,\\operatorname{Im}\\left\\{\\frac{\\ln A_{\\mathrm{KK}}(\\omega) + i\\,\\phi_{\\mathrm{meas}}(\\omega)}{i\\,k_0\\,L}\\right\\} = -\\frac{2}{L}\\ln A_{\\mathrm{KK}}(\\omega)\n    $$\n    Passivity $\\alpha_{\\mathrm{Rytov}} \\ge 0$ implies $\\ln A_{\\mathrm{KK}}(\\omega) \\le 0$. We enforce this by setting the unknown constant $C$ such that the maximum value of the reconstructed log-amplitude is zero: $C = -\\max(\\mathcal{H}[\\phi_{\\mathrm{meas}}](\\omega))$. By this construction, $\\ln A_{\\mathrm{KK}}(\\omega) \\le 0$ for all $\\omega$, which guarantees that the reconstructed absorption coefficient $\\alpha_{\\mathrm{Rytov}}(\\omega)$ will be non-negative. This procedure diagnoses and corrects for the unknown frequency-dependent gain $g(\\omega)$, yielding a physically valid reconstruction.\n\nThe implementation will compute $\\alpha_{\\mathrm{Born}}(\\omega)$ and $\\alpha_{\\mathrm{Rytov}}(\\omega)$ for each test case and check if any values are negative. We expect the Born approximation to fail (predict $\\alpha < 0$) for all cases, while the KK-corrected Rytov method will succeed (maintain $\\alpha \\ge 0$) for all cases.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.signal import hilbert\nfrom scipy.signal.windows import tukey\n\ndef solve():\n    \"\"\"\n    Solves the electromagnetics problem by comparing Born and Rytov approximations.\n\n    This function sets up a physical model of a dielectric slab, simulates a\n    \"measured\" transmission signal with a calibration gain, and then applies\n    two different reconstruction algorithms (Born and Rytov/Kramers-Kronig)\n    to recover the slab's absorption profile. It then checks each reconstruction\n    for a non-physical artifact (negative absorption).\n    \"\"\"\n\n    # Define physical constants and problem parameters from the statement.\n    c = 3.0e8  # Speed of light in vacuum, m/s\n    eps_inf = 2.25\n    delta_eps = 0.75\n    tau = 1.0e-12  # Debye relaxation time, s\n    sigma = 0.0  # Electrical conductivity, S/m\n    L = 0.01  # Slab thickness, m\n    w_min = 1.0e13  # Minimum angular frequency, rad/s\n    w_max = 3.0e14  # Maximum angular frequency, rad/s\n    w_c = 1.5e14  # Center frequency of gain profile, rad/s\n    sigma_w = 2.0e13  # Width of gain profile, rad/s\n\n    # Define the test cases for the calibration gain amplitude 'b'.\n    test_cases_b = [\n        0.0,   # Case 1: No calibration bias\n        0.03,  # Case 2: Moderate bias\n        0.08,  # Case 3: Strong bias\n    ]\n\n    # Set up the computational grid.\n    n0 = np.sqrt(eps_inf)\n    N = 4096  # Number of frequency points for high resolution.\n    omega = np.linspace(w_min, w_max, N)\n    k0 = omega / c\n\n    born_results = []\n    rytof_results = []\n\n    for b in test_cases_b:\n        # Step 1: Simulate the ground truth physics.\n        # Debye model for relative permittivity.\n        # The term with sigma is zero as per the problem statement.\n        eps_r = eps_inf + delta_eps / (1.0 - 1j * omega * tau)\n\n        # Complex refractive index (principal branch is default for np.sqrt).\n        n = np.sqrt(eps_r)\n\n        # Step 2: Simulate the measurement process.\n        # Ideal transmission ratio d(omega) neglecting internal reflections.\n        d = np.exp(1j * k0 * L * (n - n0))\n\n        # Frequency-dependent calibration gain g(omega).\n        g = 1.0 + b * np.exp(-((omega - w_c)**2) / (2.0 * sigma_w**2))\n\n        # \"Measured\" transmission ratio including the gain.\n        d_meas = g * d\n\n        # Step 3: Reconstruction using the Born approximation.\n        # The absorption coefficient from the Born model is alpha = (2/L)*(1 - Re{d_meas}).\n        alpha_born = (2.0 / L) * (1.0 - np.real(d_meas))\n        born_neg_alpha = np.any(alpha_born  0)\n        born_results.append(born_neg_alpha)\n\n        # Step 4: Reconstruction using the Kramers-Kronig-consistent Rytov approximation.\n        # The measured phase is immune to the real-valued gain g > 0.\n        phi_meas = np.angle(d_meas)\n        \n        # Apply a Tukey window to the phase data to reduce spectral leakage artifacts\n        # in the discrete Hilbert transform (FFT-based).\n        win = tukey(N, alpha=0.25)\n        phi_windowed = phi_meas * win\n        \n        # Reconstruct log-amplitude via the discrete Hilbert transform of the phase.\n        # ln(A) = H[phi]. The imaginary part of scipy's hilbert() is the transform.\n        ln_A_KK_raw = np.imag(hilbert(phi_windowed))\n\n        # Enforce passivity (alpha >= 0, which implies ln(A) = 0) by shifting\n        # the reconstructed log-amplitude so its maximum is 0.\n        ln_A_KK = ln_A_KK_raw - np.max(ln_A_KK_raw)\n        \n        # Calculate the Rytov absorption coefficient from the KK-reconstructed amplitude.\n        # alpha = -(2/L)*ln(A_KK).\n        alpha_rytof = (-2.0 / L) * ln_A_KK\n\n        # Check for non-physical negative absorption. By construction, we expect\n        # alpha_rytof >= 0, so this should be False barring numerical noise.\n        rytof_neg_alpha = np.any(alpha_rytof  0)\n        rytof_results.append(rytof_neg_alpha)\n\n    # Aggregate results in the specified order: [b1, b2, b3, r1, r2, r3].\n    final_results = born_results + rytof_results\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, final_results))}]\")\n\nsolve()\n\n```", "id": "3290082"}, {"introduction": "A significant advantage of the Rytov approximation is its direct connection to the phase of the scattered field, which can be related to an object's refractive index. However, in practice, phase can only be measured modulo $2\\pi$, leading to ambiguities known as phase wrapping when the true phase exceeds this range. This practice tackles this critical implementation challenge by showing how to leverage the physics of the Rytov model—specifically, its predictable scaling with wavenumber $k$—to unwrap the phase using multi-frequency data, a crucial technique for robust quantitative imaging. [@problem_id:3290093]", "problem": "Consider a scalar, time-harmonic electromagnetic field governed by the scalar Helmholtz equation in a homogeneous background with wavenumber $k$ (in radians per meter). Let an incident plane wave $E_{\\mathrm{inc}}(\\mathbf{r};k)$ illuminate a weakly scattering, thin, phase-only object with small refractive index perturbation $\\delta n(\\mathbf{r})$ and thickness $T$ (in meters) along the propagation direction. Under the Rytov approximation, define the Rytov variable $\\psi(\\mathbf{r};k) = \\ln\\left(E(\\mathbf{r};k)/E_{\\mathrm{inc}}(\\mathbf{r};k)\\right)$, where $E(\\mathbf{r};k)$ is the total field. For a thin, purely phase object in the paraxial regime, the imaginary part of $\\psi$ is the phase delay relative to the incident field and is approximately linear in $k$, i.e., $\\phi(\\mathbf{r};k) = \\mathrm{Im}\\,\\psi(\\mathbf{r};k) \\approx \\eta(\\mathbf{r})\\,k$, where $\\eta(\\mathbf{r}) = \\int \\delta n(\\mathbf{r})\\,\\mathrm{d}\\ell$ is an effective optical path length perturbation (in meters) along the line of sight at the observation point $\\mathbf{r}$. The real part $\\mathrm{Re}\\,\\psi$ is the log-amplitude, which we assume remains within a limited dynamic range.\n\nIn measurement, the complex phase is only accessible modulo $2\\pi$ due to the principal argument limitation of the complex logarithm or phase extraction, so the measured wrapped phase is $\\tilde{\\phi}(\\mathbf{r};k) = \\mathrm{wrap}\\left(\\phi(\\mathbf{r};k)\\right)$, confined to the interval $(-\\pi,\\pi]$ (in radians). This constitutes a phase-wrapping problem when $\\lvert \\phi(\\mathbf{r};k) \\rvert$ exceeds $\\pi$. One can leverage multi-wavenumber data to unwrap phase by enforcing cross-$k$ consistency derived from the Rytov/Born linearization: the difference in the Rytov variable across two nearby wavenumbers $k_1$ and $k_2$ satisfies $\\Delta \\psi(\\mathbf{r}) \\approx (k_2-k_1)\\,\\partial_k \\psi(\\mathbf{r};k)$, so that the imaginary part obeys $\\Delta \\phi(\\mathbf{r}) \\approx (k_2-k_1)\\,\\partial_k \\phi(\\mathbf{r};k)$. For a thin phase object with $\\phi(\\mathbf{r};k) \\approx \\eta(\\mathbf{r})\\,k$, one has $\\partial_k \\phi(\\mathbf{r};k) \\approx \\eta(\\mathbf{r})$.\n\nYou must construct a computational scenario that:\n1. Simulates the true unwrapped phases $\\phi(\\mathbf{r};k_i) = \\eta\\,k_i$ for a scalar, single-point receiver at a fixed observation point (drop explicit $\\mathbf{r}$ notation and treat $\\eta$ as a constant), given pairs of wavenumbers $k_1$ and $k_2$.\n2. Produces wrapped measurements $\\tilde{\\phi}(k_i) = \\mathrm{wrap}(\\phi(k_i)) \\in (-\\pi,\\pi]$ and optionally adds small deterministic perturbations to emulate limited dynamic range and quantization effects.\n3. Implements a multi-$k$ unwrapping strategy that enforces the Rytov cross-wavenumber consistency using\n$$\n\\Delta \\phi_{\\mathrm{unwrapped}} = \\mathrm{wrap}\\big(\\tilde{\\phi}(k_2) - \\tilde{\\phi}(k_1)\\big) + 2\\pi\\,m,\n$$\nwhere $m \\in \\mathbb{Z}$ is chosen to minimize $\\left\\lvert \\Delta \\phi_{\\mathrm{unwrapped}} - (k_2-k_1)\\,\\eta \\right\\rvert$. This is the enforcement of $\\Delta \\psi \\approx (k_2 - k_1)\\,\\partial_k \\psi$ on the phase component with $\\partial_k \\phi \\approx \\eta$.\n\nYour task is to implement a program that, for each test case below, computes:\n- The true phase difference $\\Delta \\phi_{\\mathrm{true}} = \\phi(k_2) - \\phi(k_1) = \\eta\\,(k_2-k_1)$.\n- The wrapped phase difference $\\Delta \\tilde{\\phi} = \\mathrm{wrap}\\left(\\tilde{\\phi}(k_2) - \\tilde{\\phi}(k_1)\\right)$.\n- The unwrapped phase difference $\\Delta \\phi_{\\mathrm{unwrapped}}$ by selecting the integer $m$ that minimizes the mismatch to $\\Delta \\phi_{\\mathrm{true}}$.\n- The absolute error $e = \\left\\lvert \\Delta \\phi_{\\mathrm{unwrapped}} - \\Delta \\phi_{\\mathrm{true}} \\right\\rvert$.\n\nAll angles must be expressed in radians. The output for each test case must be the absolute error $e$ (a float). Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[e1,e2,e3,e4]\").\n\nUse the following test suite (all $k$ in radians per meter, $\\eta$ in meters, and angles in radians):\n- Test 1 (happy path with wrapping but no perturbation): $k_1 = 20.0$, $k_2 = 22.0$, $\\eta = 0.8$, no perturbation.\n- Test 2 (significant wrapping with no perturbation): $k_1 = 12.5$, $k_2 = 15.0$, $\\eta = 1.7$, no perturbation.\n- Test 3 (near-boundary wrapped phases with small deterministic perturbations): $k_1 = 30.0$, $k_2 = 32.8$, $\\eta = 3.05$, add $-0.05$ to $\\tilde{\\phi}(k_1)$ and $+0.05$ to $\\tilde{\\phi}(k_2)$ before differencing.\n- Test 4 (small $k$ spacing, minimal wrapping): $k_1 = 100.0$, $k_2 = 100.5$, $\\eta = 2.7$, no perturbation.\n\nThe final numeric outputs must be the absolute errors $e$ for each test case, in radians, in the order of the tests above.\n\nYour program must be a complete, runnable implementation that:\n- Computes $\\phi(k_i)$, wraps to $\\tilde{\\phi}(k_i)$, applies the specified perturbation if any, computes $\\Delta \\tilde{\\phi}$, performs unwrapping using the cross-$k$ consistency with $\\partial_k \\phi \\approx \\eta$, and returns the absolute error $e$ per test case.\n- Uses the angle-wrapping convention $\\mathrm{wrap}(\\alpha) \\in (-\\pi,\\pi]$.\n- Prints a single line in the exact format \"[e1,e2,e3,e4]\".", "solution": "The problem statement is subjected to validation prior to any attempt at a solution.\n\n### Step 1: Extract Givens\n- **Governing Equation**: Scalar Helmholtz equation for a time-harmonic electromagnetic field.\n- **Background Medium**: Homogeneous with wavenumber $k$ (in rad/m).\n- **Object**: Weakly scattering, thin, phase-only object with small refractive index perturbation $\\delta n(\\mathbf{r})$ and thickness $T$ (in m).\n- **Incident Field**: Plane wave $E_{\\mathrm{inc}}(\\mathbf{r};k)$.\n- **Total Field**: $E(\\mathbf{r};k)$.\n- **Rytov Variable**: $\\psi(\\mathbf{r};k) = \\ln\\left(E(\\mathbf{r};k)/E_{\\mathrm{inc}}(\\mathbf{r};k)\\right)$.\n- **Phase Model**: For a thin, purely phase object in the paraxial regime, the phase delay $\\phi(\\mathbf{r};k) = \\mathrm{Im}\\,\\psi(\\mathbf{r};k)$ is approximately linear in $k$: $\\phi(\\mathbf{r};k) \\approx \\eta(\\mathbf{r})\\,k$.\n- **Optical Path Length Perturbation**: $\\eta(\\mathbf{r}) = \\int \\delta n(\\mathbf{r})\\,\\mathrm{d}\\ell$ (in m). For the given problem, this is treated as a scalar constant $\\eta$ at a single observation point.\n- **Wrapped Phase Measurement**: $\\tilde{\\phi}(\\mathbf{r};k) = \\mathrm{wrap}\\left(\\phi(\\mathbf{r};k)\\right)$, where the `wrap` function maps its argument to the interval $(-\\pi,\\pi]$.\n- **Cross-Wavenumber Consistency**: The phase difference between two wavenumbers $k_1$ and $k_2$ is approximated as $\\Delta \\phi(\\mathbf{r}) \\approx (k_2-k_1)\\,\\partial_k \\phi(\\mathbf{r};k)$. With the given phase model, this becomes $\\Delta \\phi(\\mathbf{r}) \\approx (k_2-k_1)\\,\\eta(\\mathbf{r})$.\n- **Unwrapping Formula**: $\\Delta \\phi_{\\mathrm{unwrapped}} = \\mathrm{wrap}\\big(\\tilde{\\phi}(k_2) - \\tilde{\\phi}(k_1)\\big) + 2\\pi\\,m$, where $m \\in \\mathbb{Z}$.\n- **Unwrapping Criterion**: The integer $m$ is chosen to minimize $\\left\\lvert \\Delta \\phi_{\\mathrm{unwrapped}} - (k_2-k_1)\\,\\eta \\right\\rvert$.\n- **Task**: For each test case, compute the absolute error $e = \\left\\lvert \\Delta \\phi_{\\mathrm{unwrapped}} - \\Delta \\phi_{\\mathrm{true}} \\right\\rvert$, where $\\Delta \\phi_{\\mathrm{true}} = \\eta\\,(k_2-k_1)$.\n- **Test Cases**:\n  1. $k_1 = 20.0$, $k_2 = 22.0$, $\\eta = 0.8$, no perturbation.\n  2. $k_1 = 12.5$, $k_2 = 15.0$, $\\eta = 1.7$, no perturbation.\n  3. $k_1 = 30.0$, $k_2 = 32.8$, $\\eta = 3.05$, perturbation on $\\tilde{\\phi}(k_1)$ is $-0.05$, on $\\tilde{\\phi}(k_2)$ is $+0.05$.\n  4. $k_1 = 100.0$, $k_2 = 100.5$, $\\eta = 2.7$, no perturbation.\n\n### Step 2: Validate Using Extracted Givens\n1.  **Scientifically Grounded**: The problem is based on the Rytov approximation, a widely used and valid linearization of the wave equation for solving electromagnetic inverse scattering problems. The concepts of phase wrapping, multi-wavenumber measurements, and phase unwrapping via consistency checks are standard in coherent imaging and signal processing. The phase model $\\phi(k) \\approx \\eta k$ is a direct and valid consequence of the thin-object and Born/Rytov approximations. The problem is scientifically sound.\n2.  **Well-Posed**: The problem specifies a clear computational task with all necessary inputs ($k_1$, $k_2$, $\\eta$, and any perturbations) provided for each test case. The objective function to be minimized for finding the unwrapping integer $m$ is well-defined, leading to a unique solution. The required output is unambiguously defined.\n3.  **Objective**: The problem is stated in precise, quantitative, and objective scientific language. There are no subjective or opinion-based clauses.\n4.  **Incomplete or Contradictory Setup**: The problem is self-contained. All variables, functions, and constraints are defined. The provided data are sufficient and consistent.\n5.  **Unrealistic or Infeasible**: The physical parameters and proposed measurements, while simplified for a computational exercise, are physically plausible within the context of a simulation.\n6.  **Ill-Posed or Poorly Structured**: The problem is well-structured, guiding the user from the physical model to a specific algorithm and its test cases. The minimization procedure for $m$ is explicit and ensures a unique solution exists.\n7.  **Pseudo-Profound, Trivial, or Tautological**: The problem is a non-trivial implementation task that correctly models the core challenge of ambiguity resolution (finding $m$) in phase unwrapping by using side-information from a physical model.\n8.  **Outside Scientific Verifiability**: The problem is a computational task that is perfectly verifiable by implementing the described algorithm.\n\n### Step 3: Verdict and Action\nThe problem is valid as it is scientifically grounded, well-posed, objective, and complete. A solution will be provided.\n\n---\n\n### Solution\nThe problem requires the implementation of a multi-wavenumber phase unwrapping algorithm. The algorithm leverages the physical model of phase accumulation in a thin, weakly scattering object, which is governed by the Rytov approximation. We will first formalize the steps of the algorithm and then apply them to the specified test cases.\n\n**1. Physical Model and Measurement Process**\n\nThe true, unwrapped phase at a specific observation point for a given wavenumber $k$ is modeled by the linear relationship:\n$$\n\\phi(k) = \\eta k\n$$\nwhere $\\eta$ is the effective optical path length perturbation. This is the ground-truth phase.\n\nIn a measurement, the phase is typically extracted as the argument of a complex-valued signal, which restricts its value to a principal range. The problem specifies this range as $(-\\pi, \\pi]$. This process is known as phase wrapping. The measured, wrapped phase $\\tilde{\\phi}(k)$ is given by:\n$$\n\\tilde{\\phi}(k) = \\mathrm{wrap}(\\phi(k))\n$$\nThe wrapping function, $\\mathrm{wrap}(\\alpha)$, maps an arbitrary real-valued angle $\\alpha$ to the interval $(-\\pi, \\pi]$ by adding or subtracting an integer multiple of $2\\pi$. Mathematically, this can be expressed as:\n$$\n\\mathrm{wrap}(\\alpha) = \\alpha - 2\\pi N \\quad \\text{where} \\quad N = \\left\\lfloor \\frac{\\alpha + \\pi}{2\\pi} \\right\\rfloor \\in \\mathbb{Z}\n$$\nor equivalently, using the floor function, or more computationally, as `(alpha + pi) % (2*pi) - pi`.\n\nIn some cases, the measurement process may introduce perturbations. For a given test case, we consider deterministic perturbations $p_1$ and $p_2$ added to the wrapped phases $\\tilde{\\phi}(k_1)$ and $\\tilde{\\phi}(k_2)$, respectively.\n\n**2. Phase Unwrapping Algorithm**\n\nThe core of the problem is to determine the true phase difference, $\\Delta\\phi_{\\mathrm{true}}$, between two wavenumbers, $k_1$ and $k_2$, using only the wrapped measurements. The true difference is:\n$$\n\\Delta\\phi_{\\mathrm{true}} = \\phi(k_2) - \\phi(k_1) = \\eta(k_2 - k_1)\n$$\nThe measurements provide two wrapped phases, $\\tilde{\\phi}(k_1)$ and $\\tilde{\\phi}(k_2)$ (including any specified perturbations). The naive difference of these wrapped phases, $\\tilde{\\phi}(k_2) - \\tilde{\\phi}(k_1)$, is itself subject to wrapping ambiguity. We first compute the wrapped phase difference:\n$$\n\\Delta\\tilde{\\phi} = \\mathrm{wrap}(\\tilde{\\phi}(k_2) - \\tilde{\\phi}(k_1))\n$$\nThe true phase difference $\\Delta\\phi_{\\mathrm{true}}$ and the wrapped phase difference $\\Delta\\tilde{\\phi}$ are related by an unknown integer multiple of $2\\pi$:\n$$\n\\Delta\\phi_{\\mathrm{true}} = \\Delta\\tilde{\\phi} + 2\\pi m^*\n$$\nfor some integer $m^* \\in \\mathbb{Z}$. Our goal is to find an estimate for $\\Delta\\phi_{\\mathrm{true}}$, which we call $\\Delta\\phi_{\\mathrm{unwrapped}}$. This is achieved by finding the correct integer, which we denote as $m$.\n$$\n\\Delta\\phi_{\\mathrm{unwrapped}} = \\Delta\\tilde{\\phi} + 2\\pi m\n$$\nThe problem specifies that $m$ should be chosen to enforce consistency with the known physical model. Specifically, $m$ is selected to minimize the magnitude of the difference between the estimated unwrapped phase difference and the theoretically predicted true phase difference:\n$$\n\\min_{m \\in \\mathbb{Z}} \\left| \\Delta\\phi_{\\mathrm{unwrapped}} - \\Delta\\phi_{\\mathrm{true}} \\right| = \\min_{m \\in \\mathbb{Z}} \\left| (\\Delta\\tilde{\\phi} + 2\\pi m) - \\eta(k_2 - k_1) \\right|\n$$\nTo find the integer $m$ that minimizes this expression, we wish for the term inside the absolute value to be as close to zero as possible:\n$$\n\\Delta\\tilde{\\phi} + 2\\pi m \\approx \\eta(k_2 - k_1)\n$$\n$$\n2\\pi m \\approx \\eta(k_2 - k_1) - \\Delta\\tilde{\\phi}\n$$\n$$\nm \\approx \\frac{\\eta(k_2 - k_1) - \\Delta\\tilde{\\phi}}{2\\pi}\n$$\nThe integer $m$ that is closest to this real value is found by rounding to the nearest integer:\n$$\nm = \\mathrm{round}\\left( \\frac{\\Delta\\phi_{\\mathrm{true}} - \\Delta\\tilde{\\phi}}{2\\pi} \\right)\n$$\n\n**3. Computational Steps and Error Metric**\n\nFor each test case with parameters $(k_1, k_2, \\eta, p_1, p_2)$, the procedure is as follows:\n1.  Calculate the true phases: $\\phi(k_1) = \\eta k_1$ and $\\phi(k_2) = \\eta k_2$.\n2.  Calculate the true phase difference: $\\Delta\\phi_{\\mathrm{true}} = \\phi(k_2) - \\phi(k_1)$.\n3.  Calculate the raw wrapped phases: $\\tilde{\\phi}_0(k_1) = \\mathrm{wrap}(\\phi(k_1))$ and $\\tilde{\\phi}_0(k_2) = \\mathrm{wrap}(\\phi(k_2))$.\n4.  Apply perturbations to get the final measured phases: $\\tilde{\\phi}(k_1) = \\tilde{\\phi}_0(k_1) + p_1$ and $\\tilde{\\phi}(k_2) = \\tilde{\\phi}_0(k_2) + p_2$. For cases with no perturbation, $p_1=0$ and $p_2=0$.\n5.  Calculate the wrapped phase difference from measurements: $\\Delta\\tilde{\\phi} = \\mathrm{wrap}(\\tilde{\\phi}(k_2) - \\tilde{\\phi}(k_1))$.\n6.  Determine the optimal unwrapping integer $m$ using the rounding formula derived above.\n7.  Compute the unwrapped phase difference estimate: $\\Delta\\phi_{\\mathrm{unwrapped}} = \\Delta\\tilde{\\phi} + 2\\pi m$.\n8.  Finally, calculate the absolute error, $e$, which is the required output for each test case:\n    $$\n    e = \\left| \\Delta\\phi_{\\mathrm{unwrapped}} - \\Delta\\phi_{\\mathrm{true}} \\right|\n    $$\nThis procedure will be implemented for the four given test cases. The perturbations in Case $3$ introduce an error that the physical model consistency check cannot correct, and the resulting non-zero error $e$ quantifies the impact of this measurement noise on the unwrapping result. For the other cases without perturbation, the error $e$ is expected to be zero or close to machine precision.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Implements a multi-wavenumber phase unwrapping algorithm for a series of test cases.\n\n    The algorithm is based on the Rytov approximation for a thin phase object, where\n    the unwrapped phase is linear with the wavenumber k: phi(k) = eta * k.\n    The goal is to recover the true phase difference between two wavenumbers,\n    delta_phi_true = eta * (k2 - k1), from wrapped measurements.\n\n    The core of the method is to find an integer `m` that unwraps the phase difference\n    by minimizing the mismatch with the physically predicted phase difference.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (k1, k2, eta, perturbation1, perturbation2)\n    test_cases = [\n        (20.0, 22.0, 0.8, 0.0, 0.0),      # Test 1\n        (12.5, 15.0, 1.7, 0.0, 0.0),      # Test 2\n        (30.0, 32.8, 3.05, -0.05, 0.05),  # Test 3\n        (100.0, 100.5, 2.7, 0.0, 0.0)     # Test 4\n    ]\n\n    results = []\n\n    def wrap_to_pi(angle):\n        \"\"\"\n        Wraps an angle in radians to the interval (-pi, pi].\n        \"\"\"\n        return (angle + np.pi) % (2 * np.pi) - np.pi\n\n    for case in test_cases:\n        k1, k2, eta, p1, p2 = case\n\n        # Step 1 and 2: Calculate true phases and their difference.\n        # phi(k) = eta * k\n        phi_k1 = eta * k1\n        phi_k2 = eta * k2\n        delta_phi_true = phi_k2 - phi_k1\n\n        # Step 3 and 4: Calculate wrapped phases and apply perturbations.\n        tilde_phi_k1_raw = wrap_to_pi(phi_k1)\n        tilde_phi_k2_raw = wrap_to_pi(phi_k2)\n        \n        tilde_phi_k1 = tilde_phi_k1_raw + p1\n        tilde_phi_k2 = tilde_phi_k2_raw + p2\n        \n        # Step 5: Calculate the wrapped phase difference from measurements.\n        delta_tilde_phi = wrap_to_pi(tilde_phi_k2 - tilde_phi_k1)\n\n        # Step 6: Determine the optimal unwrapping integer 'm'.\n        # m is chosen to minimize | (delta_tilde_phi + 2*pi*m) - delta_phi_true |\n        # This is equivalent to rounding (delta_phi_true - delta_tilde_phi) / (2*pi).\n        m_float = (delta_phi_true - delta_tilde_phi) / (2 * np.pi)\n        m = np.round(m_float)\n\n        # Step 7: Compute the unwrapped phase difference.\n        delta_phi_unwrapped = delta_tilde_phi + 2 * np.pi * m\n\n        # Step 8: Compute the absolute error.\n        error = np.abs(delta_phi_unwrapped - delta_phi_true)\n        results.append(error)\n\n    # Format and print the final results\n    # Use '.16g' to ensure sufficient precision without trailing zeros.\n    print(f\"[{','.join(f'{r:.16g}' for r in results)}]\")\n\nsolve()\n```", "id": "3290093"}]}