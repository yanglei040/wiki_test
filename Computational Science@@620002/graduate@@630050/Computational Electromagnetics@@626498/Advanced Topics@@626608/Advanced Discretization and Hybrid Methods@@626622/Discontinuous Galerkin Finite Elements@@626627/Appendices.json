{"hands_on_practices": [{"introduction": "This practice introduces the core mechanics of the discontinuous Galerkin method at an element interface. By computing the jump and average operators and deriving an upwind numerical flux in a simple one-dimensional setting, you will gain hands-on experience with the fundamental building blocks that allow communication between discontinuous solution spaces. This exercise is foundational for understanding how local element solutions are coupled together to form a global solution. [@problem_id:3300213]", "problem": "Consider the one-dimensional transverse electric (TE) polarization of Maxwell’s equations for fields $E_{y}(x,t)$ and $H_{z}(x,t)$ in a homogeneous, isotropic, source-free medium with permittivity $\\varepsilon$ and permeability $\\mu$. The governing equations can be written in conservative form as\n$$\n\\partial_{t}\\big(\\varepsilon E_{y}\\big) + \\partial_{x} H_{z} = 0,\\qquad\n\\partial_{t}\\big(\\mu H_{z}\\big) + \\partial_{x} E_{y} = 0.\n$$\nIn a Discontinuous Galerkin (DG) finite element formulation, the domain is partitioned into elements and interface fluxes are introduced at shared faces. Consider two neighboring elements $K_{L}=[-\\,\\ell,0]$ and $K_{R}=[0,\\ell]$ sharing the face at $x=0$. Let the outward unit normal on $K_{L}$ be $n_{L}=+\\,1$ and on $K_{R}$ be $n_{R}=-\\,1$. The tangential electric field on the face is $E_{t}=E_{y}$ in this one-dimensional setting.\n\nOn each element, the polynomial approximations of the fields are given by\n$$\nE_{y}^{L}(x)=1+2x+3x^{2},\\quad H_{z}^{L}(x)=\\tfrac{1}{2}-x,\\qquad x\\in K_{L},\n$$\n$$\nE_{y}^{R}(x)=2-x+x^{2},\\quad H_{z}^{R}(x)=1+2x,\\qquad x\\in K_{R}.\n$$\nThe material parameters are\n$$\n\\varepsilon=2,\\qquad \\mu=8,\n$$\nso that the wave impedance and admittance are $Z=\\sqrt{\\mu/\\varepsilon}$ and $Y=1/Z$, respectively.\n\nUsing the DG interface operators for a scalar trace $u$,\n$$\n\\{u\\}=\\frac{u^{L}+u^{R}}{2},\\qquad [u]=u^{L}n_{L}+u^{R}n_{R}=u^{L}-u^{R},\n$$\ndo the following at the shared face $x=0$:\n- Compute the average $\\{E_{t}\\}$ and the jump $[E_{t}]$ of the tangential electric field.\n- Starting from the conservative form of Maxwell’s equations above and the definition of the exact upwind flux for linear hyperbolic systems, derive the expression of the numerical magnetic flux $H_{z}^{*}$ at the interface that enters the semi-discrete weak form of the $E_{y}$-equation, in terms of $\\{H_{t}\\}$, $[E_{t}]$, and the material parameters. Then evaluate $H_{z}^{*}$ at $x=0$ using the given polynomial traces and material constants.\n\nExpress the final numerical flux value $H_{z}^{*}$ in amperes per meter $\\big(\\text{A/m}\\big)$. Provide the exact value; do not round.", "solution": "The problem requires the calculation of interface quantities for a Discontinuous Galerkin (DG) time-domain formulation for one-dimensional Maxwell's equations. We must first validate the problem, which has been found to be well-posed, scientifically grounded, and self-contained. We proceed with the solution in two main parts: first, computing the average and jump of the tangential electric field, and second, deriving and evaluating the upwind numerical flux for the magnetic field.\n\nThe tangential electric field at the interface $x=0$ has contributions from the left element $K_L$ and the right element $K_R$. The trace of a field is its value at the boundary of an element.\nGiven the polynomial approximations for the electric field:\n$$\nE_{y}^{L}(x) = 1+2x+3x^{2} \\quad \\text{for } x \\in K_{L}\n$$\n$$\nE_{y}^{R}(x) = 2-x+x^{2} \\quad \\text{for } x \\in K_{R}\n$$\nWe evaluate these at the interface $x=0$. In this one-dimensional problem, the tangential electric field is $E_t = E_y$.\nThe trace from the left element is:\n$$\nE_{t}^{L} = E_{y}^{L}(0) = 1+2(0)+3(0)^{2} = 1\n$$\nThe trace from the right element is:\n$$\nE_{t}^{R} = E_{y}^{R}(0) = 2-(0)+(0)^{2} = 2\n$$\nUsing the provided definitions for the average $\\{u\\}$ and jump $[u]$ operators on a scalar trace $u$:\n$$\n\\{u\\} = \\frac{u^{L}+u^{R}}{2}, \\qquad [u] = u^{L}n_{L}+u^{R}n_{R} = u^{L}-u^{R}\n$$\nwe compute the average and jump of the tangential electric field trace:\n$$\n\\{E_{t}\\} = \\frac{E_{t}^{L}+E_{t}^{R}}{2} = \\frac{1+2}{2} = \\frac{3}{2}\n$$\n$$\n[E_{t}] = E_{t}^{L} - E_{t}^{R} = 1 - 2 = -1\n$$\nThese are the first two quantities requested.\n\nNext, we derive the expression for the numerical magnetic flux $H_{z}^{*}$ at the interface. The governing equations are:\n$$\n\\partial_{t}\\big(\\varepsilon E_{y}\\big) + \\partial_{x} H_{z} = 0\n$$\n$$\n\\partial_{t}\\big(\\mu H_{z}\\big) + \\partial_{x} E_{y} = 0\n$$\nDividing by the material constants $\\varepsilon$ and $\\mu$ respectively, we obtain the system in non-conservative form:\n$$\n\\partial_{t} E_{y} + \\frac{1}{\\varepsilon} \\partial_{x} H_{z} = 0\n$$\n$$\n\\partial_{t} H_{z} + \\frac{1}{\\mu} \\partial_{x} E_{y} = 0\n$$\nThis can be written in matrix form as $\\partial_{t}\\mathbf{q} + \\mathbf{A} \\partial_{x}\\mathbf{q} = 0$, where the state vector is $\\mathbf{q} = \\begin{pmatrix} E_y \\\\ H_z \\end{pmatrix}$ and the system matrix is $\\mathbf{A} = \\begin{pmatrix} 0 & 1/\\varepsilon \\\\ 1/\\mu & 0 \\end{pmatrix}$.\n\nThe upwind flux is determined by the characteristics of the hyperbolic system, which requires the eigen-decomposition of $\\mathbf{A}$. The eigenvalues $\\lambda$ are found from $\\det(\\mathbf{A} - \\lambda\\mathbf{I}) = 0$:\n$$\n\\det \\begin{pmatrix} -\\lambda & 1/\\varepsilon \\\\ 1/\\mu & -\\lambda \\end{pmatrix} = \\lambda^{2} - \\frac{1}{\\mu\\varepsilon} = 0\n$$\nThe eigenvalues are $\\lambda = \\pm 1/\\sqrt{\\mu\\varepsilon}$. Let $c = 1/\\sqrt{\\mu\\varepsilon}$ be the wave speed. The eigenvalues are $\\lambda_1 = -c$ and $\\lambda_2 = +c$.\nThe corresponding right eigenvectors $\\mathbf{v}$ are found by solving $(\\mathbf{A} - \\lambda\\mathbf{I})\\mathbf{v} = 0$.\nFor $\\lambda_1 = -c$:\n$$\n\\begin{pmatrix} c & 1/\\varepsilon \\\\ 1/\\mu & c \\end{pmatrix} \\begin{pmatrix} v_{11} \\\\ v_{12} \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix} \\implies c v_{11} + \\frac{1}{\\varepsilon} v_{12} = 0\n$$\nChoosing $v_{11}=1$, we get $v_{12} = -c\\varepsilon = -\\varepsilon/\\sqrt{\\mu\\varepsilon} = -\\sqrt{\\varepsilon/\\mu} = -Y$, where $Y=1/Z=\\sqrt{\\varepsilon/\\mu}$ is the wave admittance. The eigenvector is $\\mathbf{v}_1 = \\begin{pmatrix} 1 \\\\ -Y \\end{pmatrix}$.\nFor $\\lambda_2 = +c$:\n$$\n\\begin{pmatrix} -c & 1/\\varepsilon \\\\ 1/\\mu & -c \\end{pmatrix} \\begin{pmatrix} v_{21} \\\\ v_{22} \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix} \\implies -c v_{21} + \\frac{1}{\\varepsilon} v_{22} = 0\n$$\nChoosing $v_{21}=1$, we get $v_{22} = c\\varepsilon = \\sqrt{\\varepsilon/\\mu} = Y$. The eigenvector is $\\mathbf{v}_2 = \\begin{pmatrix} 1 \\\\ Y \\end{pmatrix}$.\n\nThe upwind flux is constructed from the characteristic variables, which are the projections of the state vector onto the left eigenvectors. The eigenvalue $\\lambda_1 = -c$ signifies information propagating to the left (in the $-x$ direction), so at the interface, the corresponding characteristic variable must be taken from the right state, $\\mathbf{q}^R$. The eigenvalue $\\lambda_2 = +c$ signifies propagation to the right (in the $+x$ direction), so its characteristic variable is taken from the left state, $\\mathbf{q}^L$.\nThe state vector at the interface, $\\mathbf{q}^* = \\begin{pmatrix} E_y^* \\\\ H_z^* \\end{pmatrix}$, is a linear combination of the eigenvectors: $\\mathbf{q}^* = w_1^* \\mathbf{v}_1 + w_2^* \\mathbf{v}_2$. The characteristic variables at the interface, $w_1^*$ and $w_2^*$, are determined by upwinding. The full characteristic decomposition is $\\mathbf{q}=w_1\\mathbf{v}_1+w_2\\mathbf{v}_2$. From this, we can solve for $w_1, w_2$ in terms of $E_y, H_z$:\n$$\n\\begin{pmatrix} E_y \\\\ H_z \\end{pmatrix} = w_1 \\begin{pmatrix} 1 \\\\ -Y \\end{pmatrix} + w_2 \\begin{pmatrix} 1 \\\\ Y \\end{pmatrix} = \\begin{pmatrix} w_1+w_2 \\\\ -Yw_1+Yw_2 \\end{pmatrix}\n$$\nSolving this system gives $w_1 = \\frac{1}{2Y}(Y E_y - H_z)$ and $w_2 = \\frac{1}{2Y}(Y E_y + H_z)$.\nApplying the upwinding principle:\n$w_1^* = w_1(\\mathbf{q}^R) = \\frac{1}{2Y}(Y E_y^R - H_z^R)$\n$w_2^* = w_2(\\mathbf{q}^L) = \\frac{1}{2Y}(Y E_y^L + H_z^L)$\n\nWe reconstruct the numerical flux state $\\mathbf{q}^*$ using these upwinded characteristic variables:\n$$\n\\mathbf{q}^* = w_1^* \\mathbf{v}_1 + w_2^* \\mathbf{v}_2 = \\frac{1}{2Y}(Y E_y^R - H_z^R)\\begin{pmatrix} 1 \\\\ -Y \\end{pmatrix} + \\frac{1}{2Y}(Y E_y^L + H_z^L)\\begin{pmatrix} 1 \\\\ Y \\end{pmatrix}\n$$\nThe problem asks for $H_z^*$, which is the second component of $\\mathbf{q}^*$:\n$$\nH_z^* = \\frac{1}{2Y}\\left[ (-Y)(Y E_y^R - H_z^R) + (Y)(Y E_y^L + H_z^L) \\right]\n$$\n$$\nH_z^* = \\frac{1}{2}\\left[ -(Y E_y^R - H_z^R) + (Y E_y^L + H_z^L) \\right]\n$$\n$$\nH_z^* = \\frac{1}{2}\\left[ (H_z^L + H_z^R) + Y(E_y^L - E_y^R) \\right]\n$$\nUsing the average and jump operators, and recalling that $E_t=E_y$ and $H_t=H_z$ at the interface, we get the derived expression for the numerical magnetic flux:\n$$\nH_z^* = \\{H_t\\} + \\frac{Y}{2}[E_t]\n$$\nNow, we evaluate this expression. The material parameters are $\\varepsilon=2$ and $\\mu=8$.\nThe wave admittance is $Y = \\sqrt{\\varepsilon/\\mu} = \\sqrt{2/8} = \\sqrt{1/4} = 1/2$.\nThe magnetic field traces at $x=0$ are:\n$$\nH_t^L = H_z^L(0) = \\frac{1}{2}-0 = \\frac{1}{2}\n$$\n$$\nH_t^R = H_z^R(0) = 1+2(0) = 1\n$$\nThe average of the magnetic field trace is:\n$$\n\\{H_t\\} = \\frac{H_t^L + H_t^R}{2} = \\frac{1/2 + 1}{2} = \\frac{3/2}{2} = \\frac{3}{4}\n$$\nWe previously found $[E_t] = -1$.\nSubstituting these values into the expression for $H_z^*$:\n$$\nH_z^* = \\frac{3}{4} + \\frac{1/2}{2}(-1) = \\frac{3}{4} - \\frac{1}{4} = \\frac{2}{4} = \\frac{1}{2}\n$$\nThe numerical magnetic flux at the interface is $1/2$.", "answer": "$$\n\\boxed{\\frac{1}{2}}\n$$", "id": "3300213"}, {"introduction": "Real-world applications require meshes that conform to complex geometries, which often involves using curved, isoparametric elements. This exercise demonstrates how to compute spatial derivatives on such elements by mapping them to a simple reference domain, a crucial technique in finite element methods. You will apply the chain rule using the Jacobian of the transformation to evaluate the curl of a vector field, a common operation in Maxwell's equations. [@problem_id:3300276]", "problem": "In computational electromagnetics, consider the two-dimensional transverse magnetic formulation derived from Maxwell’s equations, where the scalar magnetic field $H_{z}$ evolves according to the curl of the electric field $\\mathbf{E} = (E_{x}, E_{y})$. In a discontinuous Galerkin (DG) finite element method on curved, isoparametric quadrilateral elements, differential operators are evaluated in physical coordinates via reference-to-physical mappings. The element mapping is defined on the reference square $\\{(\\xi,\\eta) : -1 \\le \\xi \\le 1, -1 \\le \\eta \\le 1\\}$ by\n$$\nx(\\xi,\\eta) = \\xi + 0.2\\,\\xi^{2} + 0.1\\,\\xi\\,\\eta,\\qquad y(\\xi,\\eta) = \\eta + 0.3\\,\\xi\\,\\eta + 0.15\\,\\eta^{2}.\n$$\nAssume the DG approximation represents the electric field components as functions of the reference coordinates composed with the inverse mapping, i.e., $E_{x}(x(\\xi,\\eta),y(\\xi,\\eta)) = \\widehat{E}_{x}(\\xi,\\eta)$ and $E_{y}(x(\\xi,\\eta),y(\\xi,\\eta)) = \\widehat{E}_{y}(\\xi,\\eta)$, with the reference fields\n$$\n\\widehat{E}_{x}(\\xi,\\eta) = \\xi^{2} + \\eta,\\qquad \\widehat{E}_{y}(\\xi,\\eta) = \\xi\\,\\eta + 1.\n$$\nStarting from the governing laws of electromagnetism and the definition of isoparametric mappings for curved elements, derive the appropriate physical-coordinate expression for the scalar curl $\\omega = \\partial_{x}E_{y} - \\partial_{y}E_{x}$ and evaluate it at the midpoint of the curved top edge of the element, corresponding to the reference point $(\\xi^{\\star},\\eta^{\\star}) = (0,1)$. Provide your final answer as a single exact number (for example, a rational number). No units are required, and no rounding should be applied.", "solution": "The problem is validated as scientifically grounded, well-posed, and objective. It represents a standard application of differential calculus within the framework of the finite element method for computational electromagnetics. All necessary information is provided, and the problem is self-consistent.\n\nThe objective is to compute the scalar curl $\\omega = \\partial_{x}E_{y} - \\partial_{y}E_{x}$ at a specific point on a curved, isoparametric quadrilateral element. The electric field components $E_{x}$ and $E_{y}$ are defined in the physical coordinate system $(x,y)$, but their approximations are given as functions $\\widehat{E}_{x}$ and $\\widehat{E}_{y}$ in the reference coordinate system $(\\xi,\\eta)$. To compute the derivatives with respect to $x$ and $y$, we must employ the chain rule for multivariable functions.\n\nThe relationship between the physical and reference coordinate systems is given by the mapping:\n$$\nx(\\xi,\\eta) = \\xi + \\frac{1}{5}\\xi^{2} + \\frac{1}{10}\\xi\\eta\n$$\n$$\ny(\\xi,\\eta) = \\eta + \\frac{3}{10}\\xi\\eta + \\frac{3}{20}\\eta^{2}\n$$\nwhere the decimal coefficients $0.2$, $0.1$, $0.3$, and $0.15$ have been converted to their exact fractional forms $\\frac{1}{5}$, $\\frac{1}{10}$, $\\frac{3}{10}$, and $\\frac{3}{20}$, respectively.\n\nThe gradient operators in the physical and reference frames are related via the Jacobian matrix $\\mathbf{J}$ of the transformation from $(\\xi,\\eta)$ to $(x,y)$. The relationship is given by:\n$$\n\\begin{pmatrix} \\frac{\\partial}{\\partial x} \\\\ \\frac{\\partial}{\\partial y} \\end{pmatrix} = (\\mathbf{J}^{-1})^{T} \\begin{pmatrix} \\frac{\\partial}{\\partial \\xi} \\\\ \\frac{\\partial}{\\partial \\eta} \\end{pmatrix}\n$$\nThe Jacobian matrix $\\mathbf{J}$ is defined as:\n$$\n\\mathbf{J} = \\begin{pmatrix} \\frac{\\partial x}{\\partial \\xi} & \\frac{\\partial x}{\\partial \\eta} \\\\ \\frac{\\partial y}{\\partial \\xi} & \\frac{\\partial y}{\\partial \\eta} \\end{pmatrix}\n$$\nIts inverse is:\n$$\n\\mathbf{J}^{-1} = \\frac{1}{\\det(\\mathbf{J})} \\begin{pmatrix} \\frac{\\partial y}{\\partial \\eta} & -\\frac{\\partial x}{\\partial \\eta} \\\\ -\\frac{\\partial y}{\\partial \\xi} & \\frac{\\partial x}{\\partial \\xi} \\end{pmatrix}\n$$\nwhere $\\det(\\mathbf{J}) = \\frac{\\partial x}{\\partial \\xi}\\frac{\\partial y}{\\partial \\eta} - \\frac{\\partial x}{\\partial \\eta}\\frac{\\partial y}{\\partial \\xi}$.\n\nFrom the relation $(\\mathbf{J}^{-1})^{T}$, we can express the physical partial derivative operators in terms of the reference partial derivative operators:\n$$\n\\frac{\\partial}{\\partial x} = \\frac{1}{\\det(\\mathbf{J})} \\left( \\frac{\\partial y}{\\partial \\eta} \\frac{\\partial}{\\partial \\xi} - \\frac{\\partial y}{\\partial \\xi} \\frac{\\partial}{\\partial \\eta} \\right)\n$$\n$$\n\\frac{\\partial}{\\partial y} = \\frac{1}{\\det(\\mathbf{J})} \\left( -\\frac{\\partial x}{\\partial \\eta} \\frac{\\partial}{\\partial \\xi} + \\frac{\\partial x}{\\partial \\xi} \\frac{\\partial}{\\partial \\eta} \\right)\n$$\nApplying these operators to the fields $E_{y}$ and $E_{x}$ (which are $\\widehat{E}_{y}$ and $\\widehat{E}_{x}$ in the reference frame), we get:\n$$\n\\partial_{x}E_{y} = \\frac{1}{\\det(\\mathbf{J})} \\left( \\frac{\\partial y}{\\partial \\eta} \\frac{\\partial \\widehat{E}_{y}}{\\partial \\xi} - \\frac{\\partial y}{\\partial \\xi} \\frac{\\partial \\widehat{E}_{y}}{\\partial \\eta} \\right)\n$$\n$$\n\\partial_{y}E_{x} = \\frac{1}{\\det(\\mathbf{J})} \\left( -\\frac{\\partial x}{\\partial \\eta} \\frac{\\partial \\widehat{E}_{x}}{\\partial \\xi} + \\frac{\\partial x}{\\partial \\xi} \\frac{\\partial \\widehat{E}_{x}}{\\partial \\eta} \\right)\n$$\nThe scalar curl $\\omega$ is then:\n$$\n\\omega = \\partial_{x}E_{y} - \\partial_{y}E_{x} = \\frac{1}{\\det(\\mathbf{J})} \\left[ \\left( \\frac{\\partial y}{\\partial \\eta} \\frac{\\partial \\widehat{E}_{y}}{\\partial \\xi} - \\frac{\\partial y}{\\partial \\xi} \\frac{\\partial \\widehat{E}_{y}}{\\partial \\eta} \\right) - \\left( -\\frac{\\partial x}{\\partial \\eta} \\frac{\\partial \\widehat{E}_{x}}{\\partial \\xi} + \\frac{\\partial x}{\\partial \\xi} \\frac{\\partial \\widehat{E}_{x}}{\\partial \\eta} \\right) \\right]\n$$\nNext, we compute the necessary partial derivatives.\nFor the mapping:\n$$\n\\frac{\\partial x}{\\partial \\xi} = 1 + \\frac{2}{5}\\xi + \\frac{1}{10}\\eta, \\qquad \\frac{\\partial x}{\\partial \\eta} = \\frac{1}{10}\\xi\n$$\n$$\n\\frac{\\partial y}{\\partial \\xi} = \\frac{3}{10}\\eta, \\qquad \\frac{\\partial y}{\\partial \\eta} = 1 + \\frac{3}{10}\\xi + \\frac{3}{10}\\eta\n$$\nFor the reference fields $\\widehat{E}_{x}(\\xi,\\eta) = \\xi^{2} + \\eta$ and $\\widehat{E}_{y}(\\xi,\\eta) = \\xi\\eta + 1$:\n$$\n\\frac{\\partial \\widehat{E}_{x}}{\\partial \\xi} = 2\\xi, \\qquad \\frac{\\partial \\widehat{E}_{x}}{\\partial \\eta} = 1\n$$\n$$\n\\frac{\\partial \\widehat{E}_{y}}{\\partial \\xi} = \\eta, \\qquad \\frac{\\partial \\widehat{E}_{y}}{\\partial \\eta} = \\xi\n$$\nWe must evaluate these expressions at the specified reference point $(\\xi^{\\star},\\eta^{\\star}) = (0,1)$.\nEvaluating the mapping derivatives at $(0,1)$:\n$$\n\\frac{\\partial x}{\\partial \\xi}\\bigg|_{(0,1)} = 1 + \\frac{2}{5}(0) + \\frac{1}{10}(1) = \\frac{11}{10}\n$$\n$$\n\\frac{\\partial x}{\\partial \\eta}\\bigg|_{(0,1)} = \\frac{1}{10}(0) = 0\n$$\n$$\n\\frac{\\partial y}{\\partial \\xi}\\bigg|_{(0,1)} = \\frac{3}{10}(1) = \\frac{3}{10}\n$$\n$$\n\\frac{\\partial y}{\\partial \\eta}\\bigg|_{(0,1)} = 1 + \\frac{3}{10}(0) + \\frac{3}{10}(1) = \\frac{13}{10}\n$$\nThe determinant of the Jacobian at $(0,1)$ is:\n$$\n\\det(\\mathbf{J})\\bigg|_{(0,1)} = \\left(\\frac{11}{10}\\right)\\left(\\frac{13}{10}\\right) - (0)\\left(\\frac{3}{10}\\right) = \\frac{143}{100}\n$$\nEvaluating the field derivatives at $(0,1)$:\n$$\n\\frac{\\partial \\widehat{E}_{x}}{\\partial \\xi}\\bigg|_{(0,1)} = 2(0) = 0, \\qquad \\frac{\\partial \\widehat{E}_{x}}{\\partial \\eta}\\bigg|_{(0,1)} = 1\n$$\n$$\n\\frac{\\partial \\widehat{E}_{y}}{\\partial \\xi}\\bigg|_{(0,1)} = 1, \\qquad \\frac{\\partial \\widehat{E}_{y}}{\\partial \\eta}\\bigg|_{(0,1)} = 0\n$$\nNow, substitute these values into the expressions for $\\partial_{x}E_{y}$ and $\\partial_{y}E_{x}$:\n$$\n\\partial_{x}E_{y}\\bigg|_{(0,1)} = \\frac{1}{143/100} \\left( \\left(\\frac{13}{10}\\right)(1) - \\left(\\frac{3}{10}\\right)(0) \\right) = \\frac{100}{143} \\left(\\frac{13}{10}\\right) = \\frac{130}{143}\n$$\n$$\n\\partial_{y}E_{x}\\bigg|_{(0,1)} = \\frac{1}{143/100} \\left( -(0)(0) + \\left(\\frac{11}{10}\\right)(1) \\right) = \\frac{100}{143} \\left(\\frac{11}{10}\\right) = \\frac{110}{143}\n$$\nFinally, the scalar curl $\\omega$ at the point is the difference between these two values:\n$$\n\\omega\\bigg|_{(0,1)} = \\frac{130}{143} - \\frac{110}{143} = \\frac{20}{143}\n$$\nThe fraction $\\frac{20}{143}$ is in its simplest form, as the prime factorization of the denominator is $143 = 11 \\times 13$, and neither $11$ nor $13$ are factors of the numerator $20 = 2^2 \\times 5$.", "answer": "$$\\boxed{\\frac{20}{143}}$$", "id": "3300276"}, {"introduction": "A key challenge in time-domain electromagnetics is ensuring the numerical solution satisfies physical constraints like Gauss's law over long simulations. This advanced practice explores a powerful technique known as Generalized Lagrange Multiplier (GLM) hyperbolic cleaning, which dynamically corrects divergence errors. You will derive a stable Lax-Friedrichs numerical flux for this augmented system, providing insight into how DG methods can be adapted to enforce fundamental physical laws. [@problem_id:3300279]", "problem": "Consider a linear, isotropic, piecewise-constant permittivity field $\\epsilon(\\mathbf{x})$ on a bounded Lipschitz domain $\\Omega \\subset \\mathbb{R}^{3}$ that is partitioned into a shape-regular mesh of non-overlapping elements. Let $\\mathbf{n}$ denote the unit normal on an interior face $\\mathcal{F}$, oriented from the element $K^{-}$ to the neighboring element $K^{+}$. In computational electromagnetics, Gauss's law is the constraint $\\nabla \\cdot (\\epsilon \\mathbf{E}) = \\rho$, where $\\mathbf{E}$ is the electric field and $\\rho$ is the free charge density, and $\\mathbf{D} \\equiv \\epsilon \\mathbf{E}$ is the electric displacement field.\n\nTo dynamically enforce the constraint $\\nabla \\cdot \\mathbf{D} = \\rho$ in a Discontinuous Galerkin (DG) discretization, consider the Generalized Lagrange Multiplier (GLM) augmentation that introduces an auxiliary scalar field $\\psi(\\mathbf{x},t)$ and couples it to the normal component of $\\mathbf{D}$ via a hyperbolic cleaning system in the normal direction:\n$$\n\\partial_{t} D_{n} + \\partial_{n} \\psi = 0, \\qquad \\partial_{t} \\psi + \\chi^{2} \\, \\partial_{n} D_{n} = 0,\n$$\nwhere $D_{n} \\equiv \\mathbf{D} \\cdot \\mathbf{n}$ is the face-normal component of $\\mathbf{D}$ and $\\chi>0$ is a cleaning speed. Assume that the remaining Maxwell equations are treated consistently elsewhere and that the source $\\rho$ enters through volumetric terms; here, focus only on the interelement face terms associated with the above GLM pair.\n\nLet the DG weak form for this pair on an element $K$ be constructed by multiplying the equations by test functions and integrating by parts, so that the interelement coupling requires specifying numerical fluxes across an interior face $\\mathcal{F}$ in terms of the traces from $K^{-}$ and $K^{+}$. Define the average and jump of a scalar quantity $q$ on $\\mathcal{F}$ by\n$$\n\\{ q \\} \\equiv \\frac{1}{2}\\left(q^{-} + q^{+}\\right), \\qquad [ q ] \\equiv q^{+} - q^{-},\n$$\nwhere $q^{-}$ and $q^{+}$ denote the interior trace from $K^{-}$ and the exterior trace from $K^{+}$, respectively. Likewise, define $D_{n}^{-} \\equiv \\mathbf{D}^{-} \\cdot \\mathbf{n}$ and $D_{n}^{+} \\equiv \\mathbf{D}^{+} \\cdot \\mathbf{n}$.\n\nStarting from the fundamental laws of Maxwell's equations and the GLM augmentation above, derive the oriented one-dimensional Riemann problem in the normal direction for the state $U \\equiv (D_{n}, \\psi)^{\\top}$, and formulate an energy-stable numerical flux on $\\mathcal{F}$ that penalizes jumps in the face-normal component $D_{n}$ to enforce the continuity of $\\epsilon \\mathbf{E} \\cdot \\mathbf{n}$ weakly. Use a Lax–Friedrichs (Rusanov) penalty parameter $\\alpha \\ge \\chi$ to ensure stability.\n\nYour task is to specify the closed-form analytic expressions for the face-normal numerical flux components $F_{D_{n}}^{\\ast}$ and $F_{\\psi}^{\\ast}$ that enter the DG surface integrals on $\\mathcal{F}$, written solely in terms of $\\{ \\cdot \\}$ and $[ \\cdot ]$, the traces $D_{n}^{\\pm}$ and $\\psi^{\\pm}$, and the parameters $\\chi$ and $\\alpha$.\n\nProvide the final answer as analytic expressions. No numerical evaluation is required. Do not include any units in the final answer. If multiple expressions are needed, present them together using a single row matrix.", "solution": "The problem requires the derivation of the numerical flux components for a Generalized Lagrange Multiplier (GLM) hyperbolic cleaning system used in a Discontinuous Galerkin (DG) framework for Maxwell's equations. The specific task is to formulate an energy-stable numerical flux using the Lax-Friedrichs (or Rusanov) method for the one-dimensional system governing the evolution of the face-normal electric displacement component, $D_n$, and an auxiliary cleaning field, $\\psi$.\n\nThe governing system, as provided, is a pair of coupled partial differential equations describing the dynamics in the direction normal to an inter-element face $\\mathcal{F}$:\n$$\n\\partial_{t} D_{n} + \\partial_{n} \\psi = 0\n$$\n$$\n\\partial_{t} \\psi + \\chi^{2} \\, \\partial_{n} D_{n} = 0\n$$\nwhere $\\partial_n$ represents the spatial derivative along the normal direction $\\mathbf{n}$, $D_n = \\mathbf{D} \\cdot \\mathbf{n}$, and $\\chi > 0$ is a constant wave speed.\n\nTo derive the numerical flux, we first express this system in the canonical form of a hyperbolic system of conservation laws, $\\partial_t U + \\partial_n F(U) = 0$. Let the state vector be $U \\equiv \\begin{pmatrix} D_n \\\\ \\psi \\end{pmatrix}$. The system can be rewritten as:\n$$\n\\partial_t \\begin{pmatrix} D_n \\\\ \\psi \\end{pmatrix} + \\partial_n \\begin{pmatrix} \\psi \\\\ \\chi^2 D_n \\end{pmatrix} = 0\n$$\nFrom this form, we identify the physical flux vector $F(U)$ as:\n$$\nF(U) = \\begin{pmatrix} \\psi \\\\ \\chi^2 D_n \\end{pmatrix}\n$$\nThis is a linear hyperbolic system, as the flux $F(U)$ is a linear function of the state $U$. The system can also be written as $\\partial_t U + A \\, \\partial_n U = 0$, where $A$ is the flux Jacobian matrix:\n$$\nA = \\frac{\\partial F}{\\partial U} = \\begin{pmatrix} \\frac{\\partial(\\psi)}{\\partial D_n} & \\frac{\\partial(\\psi)}{\\partial \\psi} \\\\ \\frac{\\partial(\\chi^2 D_n)}{\\partial D_n} & \\frac{\\partial(\\chi^2 D_n)}{\\partial \\psi} \\end{pmatrix} = \\begin{pmatrix} 0 & 1 \\\\ \\chi^2 & 0 \\end{pmatrix}\n$$\nThe eigenvalues of the matrix $A$ determine the characteristic speeds of wave propagation for the system. They are the roots of the characteristic equation $\\det(A - \\lambda I) = 0$:\n$$\n\\det\\begin{pmatrix} -\\lambda & 1 \\\\ \\chi^2 & -\\lambda \\end{pmatrix} = \\lambda^2 - \\chi^2 = 0\n$$\nThis yields eigenvalues $\\lambda_{1,2} = \\pm \\chi$. The maximum absolute eigenvalue, which represents the fastest signal speed in the system, is $|\\lambda|_{\\max} = \\chi$.\n\nIn a DG method, the solution is discontinuous across element faces. The coupling between elements is achieved through a numerical flux function, $F^*(U^-, U^+)$, which approximates the solution to the local Riemann problem at the interface. The states $U^-$ and $U^+$ are the traces of the solution from the \"left\" ($K^-$) and \"right\" ($K^+$) elements, respectively, relative to the normal vector $\\mathbf{n}$.\n\nThe problem specifies the use of a Lax-Friedrichs (or central/Rusanov) flux. This flux is defined as the average of the physical fluxes plus a penalty term proportional to the jump in the state variables. Its general form is:\n$$\nF^*(U^-, U^+) = \\frac{1}{2} \\left( F(U^-) + F(U^+) \\right) - \\frac{\\alpha}{2} \\left( U^+ - U^- \\right)\n$$\nwhere $\\alpha$ is a dissipation parameter. For stability, $\\alpha$ must be greater than or equal to the maximum absolute eigenvalue of the flux Jacobian. The problem states that we should use a parameter $\\alpha \\ge \\chi$, which satisfies this stability condition.\n\nLet's apply this formula to our specific system. The state vectors at the interface are $U^- = \\begin{pmatrix} D_n^- \\\\ \\psi^- \\end{pmatrix}$ and $U^+ = \\begin{pmatrix} D_n^+ \\\\ \\psi^+ \\end{pmatrix}$. The corresponding physical fluxes are $F(U^-) = \\begin{pmatrix} \\psi^- \\\\ \\chi^2 D_n^- \\end{pmatrix}$ and $F(U^+) = \\begin{pmatrix} \\psi^+ \\\\ \\chi^2 D_n^+ \\end{pmatrix}$.\nSubstituting these into the Lax-Friedrichs formula gives the numerical flux vector $F^* = \\begin{pmatrix} F_{D_n}^* \\\\ F_{\\psi}^* \\end{pmatrix}$:\n$$\nF^* = \\frac{1}{2} \\left( \\begin{pmatrix} \\psi^- \\\\ \\chi^2 D_n^- \\end{pmatrix} + \\begin{pmatrix} \\psi^+ \\\\ \\chi^2 D_n^+ \\end{pmatrix} \\right) - \\frac{\\alpha}{2} \\left( \\begin{pmatrix} D_n^+ \\\\ \\psi^+ \\end{pmatrix} - \\begin{pmatrix} D_n^- \\\\ \\psi^- \\end{pmatrix} \\right)\n$$\n$$\nF^* = \\frac{1}{2} \\begin{pmatrix} \\psi^- + \\psi^+ \\\\ \\chi^2 (D_n^- + D_n^+) \\end{pmatrix} - \\frac{\\alpha}{2} \\begin{pmatrix} D_n^+ - D_n^- \\\\ \\psi^+ - \\psi^- \\end{pmatrix}\n$$\nWe can now extract the individual components of the numerical flux, $F_{D_n}^*$ and $F_{\\psi}^*$.\nFor the first component, $F_{D_n}^*$:\n$$\nF_{D_n}^* = \\frac{1}{2} (\\psi^- + \\psi^+) - \\frac{\\alpha}{2} (D_n^+ - D_n^-)\n$$\nFor the second component, $F_{\\psi}^*$:\n$$\nF_{\\psi}^* = \\frac{1}{2} \\chi^2 (D_n^- + D_n^+) - \\frac{\\alpha}{2} (\\psi^+ - \\psi^-)\n$$\nFinally, we express these results using the provided average $\\{ \\cdot \\}$ and jump $[ \\cdot ]$ operators, where $\\{q\\} = \\frac{1}{2}(q^- + q^+)$ and $[q] = q^+ - q^-$.\nThe numerical flux for the $D_n$ equation becomes:\n$$\nF_{D_n}^* = \\{\\psi\\} - \\frac{\\alpha}{2} [D_n]\n$$\nThe numerical flux for the $\\psi$ equation becomes:\n$$\nF_{\\psi}^* = \\chi^2 \\{D_n\\} - \\frac{\\alpha}{2} [\\psi]\n$$\nThese are the required closed-form analytic expressions for the numerical flux components. The term proportional to $[D_n]$ in $F_{D_n}^*$ acts as a penalty that weakly enforces the physical continuity condition $[D_n]=0$ across a source-free interface, which is a key goal of the GLM method. The choice of $\\alpha \\ge \\chi$ ensures that the numerical scheme is dissipative and stable.", "answer": "$$\n\\boxed{\\begin{pmatrix} \\{\\psi\\} - \\frac{\\alpha}{2} [D_n] & \\chi^2 \\{D_n\\} - \\frac{\\alpha}{2} [\\psi] \\end{pmatrix}}\n$$", "id": "3300279"}]}