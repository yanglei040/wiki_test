{"hands_on_practices": [{"introduction": "Understanding the distinction between energy dissipation and energy storage is fundamental in wakefield analysis. This practice serves as a crucial conceptual check on the definition of the loss factor, $k$, which quantifies irreversible energy loss. By applying the definition to a hypothetical structure with a purely inductive impedance, you will demonstrate from first principles that reactive impedances, while inducing voltage, do not contribute to the net energy loss of the bunch [@problem_id:3360476].", "problem": "Consider a single, rigid ultra-relativistic bunch traversing a linear, time-invariant accelerator structure. Let the bunch temporal current be described by a normalized Gaussian profile $i(t)$ of root-mean-square duration $\\sigma_{t}$, with total bunch charge $q$ so that $I(t)=q\\,i(t)$ and $\\int_{-\\infty}^{\\infty} i(t)\\,\\mathrm{d}t = 1$. The root-mean-square bunch length in space is $\\sigma_{z}=c\\,\\sigma_{t}$, where $c$ is the speed of light in vacuum. The longitudinal beam-coupling impedance $Z_{\\parallel}(\\omega)$ of the structure is defined in the frequency domain by the standard linear response relation between the beam current spectrum $I(\\omega)$ and the induced voltage spectrum $V(\\omega)$, namely $V(\\omega)=Z_{\\parallel}(\\omega)\\,I(\\omega)$. The energy dissipated in the structure by a single passage of the bunch is the integral of the instantaneous power $P(t)=I(t)\\,V(t)$ over time. The loss factor $k$ is defined as the dissipated energy per unit charge squared, $k \\equiv W_{\\mathrm{diss}}/q^{2}$, and serves as a measure of the irreversible energy loss experienced by the bunch due to the structure’s resistive response. Starting from these definitions, the Poynting theorem, and the property that only the resistive (real) part of the impedance contributes to net energy dissipation in a linear passive system, derive an expression for $k$ in terms of the bunch spectrum and the impedance. Then, for a structure with purely inductive longitudinal impedance $Z_{\\parallel}(\\omega)=i\\,L\\,\\omega$, where $L$ is a real, positive inductance parameter and $\\omega$ is the angular frequency, compute how $k$ scales with the bunch root-mean-square length $\\sigma_{z}$. Your final answer must be a single closed-form expression for $k$ as a function of $\\sigma_{z}$, and it must be expressed without units. No numerical evaluation is required. In addition, explain the physical origin of the scaling you obtain. If any rounding were required, round to four significant figures; otherwise, provide the exact expression. Express all mathematical entities in LaTeX.", "solution": "The problem asks for a derivation of the loss factor $k$ and its scaling with the bunch length $\\sigma_z$ for a specific case of a purely inductive longitudinal impedance. The solution will proceed in three stages: first, a general expression for the loss factor $k$ will be derived from the provided definitions; second, this expression will be evaluated for the given impedance model; third, the physical meaning of the result and its scaling will be explained.\n\nFirst, we derive the general expression for the loss factor, $k$. The total energy dissipated in the structure, $W_{\\mathrm{diss}}$, is given by the time integral of the instantaneous power, $P(t)=I(t)V(t)$:\n$$\nW_{\\mathrm{diss}} = \\int_{-\\infty}^{\\infty} P(t) \\, \\mathrm{d}t = \\int_{-\\infty}^{\\infty} I(t) V(t) \\, \\mathrm{d}t\n$$\nHere, $I(t)$ is the bunch current and $V(t)$ is the longitudinal voltage induced by this current. Both $I(t)$ and $V(t)$ are real-valued physical quantities. To analyze this in the frequency domain, we employ Parseval's theorem. Let $I(\\omega)$ and $V(\\omega)$ be the Fourier transforms of $I(t)$ and $V(t)$, respectively, using the convention $F(\\omega) = \\int_{-\\infty}^{\\infty} f(t) \\exp(-i\\omega t) \\, \\mathrm{d}t$. The corresponding inverse transform is $f(t) = \\frac{1}{2\\pi} \\int_{-\\infty}^{\\infty} F(\\omega) \\exp(i\\omega t) \\, \\mathrm{d}\\omega$.\nUsing this convention, Parseval's theorem gives:\n$$\n\\int_{-\\infty}^{\\infty} I(t) V(t) \\, \\mathrm{d}t = \\frac{1}{2\\pi} \\int_{-\\infty}^{\\infty} I(-\\omega) V(\\omega) \\, \\mathrm{d}\\omega\n$$\nSince $I(t)$ is a real function, its Fourier transform satisfies the property $I(-\\omega) = I^*(\\omega)$, where the asterisk denotes complex conjugation. Thus, the expression for dissipated energy becomes:\n$$\nW_{\\mathrm{diss}} = \\frac{1}{2\\pi} \\int_{-\\infty}^{\\infty} I^*(\\omega) V(\\omega) \\, \\mathrm{d}\\omega\n$$\nThe problem provides the linear response relation in the frequency domain: $V(\\omega) = Z_{\\parallel}(\\omega) I(\\omega)$. Substituting this into the expression for $W_{\\mathrm{diss}}$ yields:\n$$\nW_{\\mathrm{diss}} = \\frac{1}{2\\pi} \\int_{-\\infty}^{\\infty} I^*(\\omega) Z_{\\parallel}(\\omega) I(\\omega) \\, \\mathrm{d}\\omega = \\frac{1}{2\\pi} \\int_{-\\infty}^{\\infty} Z_{\\parallel}(\\omega) |I(\\omega)|^2 \\, \\mathrm{d}\\omega\n$$\nThe problem correctly states that only the resistive (real) part of the impedance contributes to net energy dissipation. We can demonstrate this mathematically. For a real valued wake function, the impedance must satisfy $Z_{\\parallel}(\\omega) = Z_{\\parallel}^*(-\\omega)$. This implies that the real part, $\\text{Re}[Z_{\\parallel}(\\omega)]$, is an even function of $\\omega$, and the imaginary part, $\\text{Im}[Z_{\\parallel}(\\omega)]$, is an odd function of $\\omega$. The term $|I(\\omega)|^2$ is necessarily real and even.\nWe can split the integral for $W_{\\mathrm{diss}}$:\n$$\nW_{\\mathrm{diss}} = \\frac{1}{2\\pi} \\int_{-\\infty}^{\\infty} \\left( \\text{Re}[Z_{\\parallel}(\\omega)] + i \\, \\text{Im}[Z_{\\parallel}(\\omega)] \\right) |I(\\omega)|^2 \\, \\mathrm{d}\\omega\n$$\n$$\nW_{\\mathrm{diss}} = \\frac{1}{2\\pi} \\int_{-\\infty}^{\\infty} \\text{Re}[Z_{\\parallel}(\\omega)] |I(\\omega)|^2 \\, \\mathrm{d}\\omega + \\frac{i}{2\\pi} \\int_{-\\infty}^{\\infty} \\text{Im}[Z_{\\parallel}(\\omega)] |I(\\omega)|^2 \\, \\mathrm{d}\\omega\n$$\nIn the second term, the integrand is the product of an odd function, $\\text{Im}[Z_{\\parallel}(\\omega)]$, and an even function, $|I(\\omega)|^2$. The resulting integrand is odd, and its integral over the symmetric interval $(-\\infty, \\infty)$ is zero. Thus, the dissipated energy is determined solely by the real part of the impedance:\n$$\nW_{\\mathrm{diss}} = \\frac{1}{2\\pi} \\int_{-\\infty}^{\\infty} \\text{Re}[Z_{\\parallel}(\\omega)] |I(\\omega)|^2 \\, \\mathrm{d}\\omega\n$$\nThe loss factor $k$ is defined as $k \\equiv W_{\\mathrm{diss}}/q^2$. The bunch current spectrum is $I(\\omega) = q \\, i(\\omega)$, where $i(\\omega)$ is the Fourier transform of the normalized current profile $i(t)$. Therefore, $|I(\\omega)|^2 = q^2 |i(\\omega)|^2$. Substituting this into the expression for $W_{\\mathrm{diss}}$ and dividing by $q^2$:\n$$\nk = \\frac{1}{q^2} \\left( \\frac{q^2}{2\\pi} \\int_{-\\infty}^{\\infty} \\text{Re}[Z_{\\parallel}(\\omega)] |i(\\omega)|^2 \\, \\mathrm{d}\\omega \\right) = \\frac{1}{2\\pi} \\int_{-\\infty}^{\\infty} \\text{Re}[Z_{\\parallel}(\\omega)] |i(\\omega)|^2 \\, \\mathrm{d}\\omega\n$$\nThis is the general expression for the loss factor in terms of the bunch spectrum and the impedance, as required.\n\nNext, we apply this result to the specific case of a purely inductive longitudinal impedance, $Z_{\\parallel}(\\omega) = i L \\omega$, where $L$ is a real, positive constant. The real part of this impedance is:\n$$\n\\text{Re}[Z_{\\parallel}(\\omega)] = \\text{Re}[i L \\omega] = 0 \\quad \\text{for all } \\omega\n$$\nSubstituting this into our derived expression for the loss factor $k$:\n$$\nk = \\frac{1}{2\\pi} \\int_{-\\infty}^{\\infty} (0) \\cdot |i(\\omega)|^2 \\, \\mathrm{d}\\omega = 0\n$$\nThe loss factor for a purely inductive impedance is identically zero.\n\nFinally, we address the question of how $k$ scales with the bunch root-mean-square length $\\sigma_z$. Since $k=0$, it is a constant and has no dependence on any bunch parameter, including $\\sigma_z$. The expression for $k$ as a function of $\\sigma_z$ is simply $k(\\sigma_z) = 0$.\n\nThe physical origin of this result lies in the definition of impedance and energy dissipation. The loss factor $k$ quantifies the irreversible energy loss of the bunch, which is energy dissipated as heat in the accelerator structure. In a linear, time-invariant system, such dissipation is exclusively associated with the resistive (real) part of the impedance. The given impedance, $Z_{\\parallel}(\\omega) = i L \\omega$, is purely imaginary, representing an ideal inductor. An ideal inductor is a reactive, not a resistive, component. It stores energy in its magnetic field when the current changes and returns this energy to the system perfectly. While there is an energy exchange between the bunch and the fields, there is no net energy dissipation. The energy lost by the front of the bunch in building up the fields is completely regained by the tail of the bunch as the fields collapse. Consequently, the total dissipated energy $W_{\\mathrm{diss}}$ is zero, and thus the loss factor $k$ is zero, regardless of the bunch's shape or duration $\\sigma_t$ (and thus its length $\\sigma_z$).", "answer": "$$\n\\boxed{0}\n$$", "id": "3360476"}, {"introduction": "Beyond total energy loss, the distribution of energy change within the bunch itself is a critical factor for beam stability. This exercise explores how the peak wake-induced energy spread scales with the bunch length $\\sigma_z$ for two canonical impedance models: a purely inductive impedance and a resistive-wall impedance. By deriving these scaling laws, you will gain valuable physical intuition into how reactive and resistive structures differently impact the beam's longitudinal phase space [@problem_id:3360475].", "problem": "An ultra-relativistic charged bunch of total charge $Q$ traverses a cylindrically symmetric, azimuthally smooth accelerator structure of length $L$. The wakefield induced by the bunch is characterized in the frequency domain by the longitudinal coupling impedance $Z_{\\parallel}(\\omega)$. The wake-induced energy deviation at longitudinal position $z$ within the bunch can be written in terms of the wake voltage $V_{\\text{wake}}(z)$ as $\\Delta \\mathcal{E}(z) = - e\\, V_{\\text{wake}}(z)$, where $e$ is the elementary charge. For ultra-relativistic motion, the wake voltage can be related to the impedance through the convolution in the frequency domain, $V_{\\text{wake}}(z) = \\frac{1}{2\\pi} \\int_{-\\infty}^{\\infty} Z_{\\parallel}(\\omega)\\, \\tilde{I}(\\omega)\\, \\exp\\!\\left(i \\frac{\\omega z}{c}\\right)\\, d\\omega$, with $c$ the speed of light and $\\tilde{I}(\\omega)$ the Fourier transform of the bunch current profile $I(z) = Q c\\, \\lambda(z)$, where $\\lambda(z)$ is the line-density distribution normalized to $\\int \\lambda(z)\\, dz = 1$.\n\nAssume a Gaussian line-density $\\lambda(z) = \\frac{1}{\\sqrt{2\\pi}\\, \\sigma_{z}} \\exp\\!\\left(-\\frac{z^{2}}{2\\sigma_{z}^{2}}\\right)$ of root-mean-square length $\\sigma_{z}$, and use the standard Fourier transform $\\tilde{\\lambda}(\\omega) = \\int_{-\\infty}^{\\infty} \\lambda(z)\\, \\exp\\!\\left(- i \\frac{\\omega z}{c}\\right)\\, dz$. Consider two asymptotic impedance models over the frequency range that contributes dominantly to the bunch spectrum:\n\n1. A purely inductive impedance $Z_{\\parallel}(\\omega) = i L_{k}\\, \\omega$, where $L_{k}$ is a real constant that does not depend on $\\omega$ or $\\sigma_{z}$.\n\n2. A resistive-wall impedance with high-frequency scaling $Z_{\\parallel}(\\omega) = A\\, \\omega^{-1/2}$, where $A$ is a real, positive constant independent of $\\omega$ and $\\sigma_{z}$.\n\nStarting from the definitions above and without introducing any empirical shortcut formulas, determine the scaling of the peak wake-induced energy spread across the bunch, defined as $\\Delta \\mathcal{E}_{\\text{peak}} = \\max_{z} |\\Delta \\mathcal{E}(z) - \\langle \\Delta \\mathcal{E} \\rangle|$, with respect to $\\sigma_{z}$, for each impedance model. You may treat multiplicative constants that do not depend on $\\sigma_{z}$ (such as $Q$, $L$, $L_{k}$, $A$, and $c$) as overall prefactors and focus on the asymptotic power-law dependence on $\\sigma_{z}$. Provide the two scaling exponents $a_{\\text{ind}}$ and $a_{\\text{rw}}$ such that $\\Delta \\mathcal{E}_{\\text{peak}} \\sim \\sigma_{z}^{a_{\\text{ind}}}$ for the inductive case and $\\Delta \\mathcal{E}_{\\text{peak}} \\sim \\sigma_{z}^{a_{\\text{rw}}}$ for the resistive-wall case. Express your final answer as a row matrix containing the two exponents. No rounding is required, and no units should be included in the final answer.", "solution": "The problem asks for the scaling exponents of the peak wake-induced energy spread with respect to the bunch length $\\sigma_{z}$ for two different impedance models.\n\n### Step 1: Extract Givens\n- Total bunch charge: $Q$\n- Accelerator structure length: $L$\n- Longitudinal coupling impedance: $Z_{\\parallel}(\\omega)$\n- Wake-induced energy deviation: $\\Delta \\mathcal{E}(z) = -e V_{\\text{wake}}(z)$, with $e$ as the elementary charge.\n- Wake voltage: $V_{\\text{wake}}(z) = \\frac{1}{2\\pi} \\int_{-\\infty}^{\\infty} Z_{\\parallel}(\\omega) \\tilde{I}(\\omega) \\exp\\left(i \\frac{\\omega z}{c}\\right) d\\omega$, with $c$ as the speed of light.\n- Bunch current Fourier transform: $\\tilde{I}(\\omega)$\n- Bunch current profile: $I(z) = Q c \\lambda(z)$\n- Normalized line-density distribution: $\\lambda(z)$, with $\\int \\lambda(z) dz = 1$.\n- Specific line-density: Gaussian, $\\lambda(z) = \\frac{1}{\\sqrt{2\\pi} \\sigma_{z}} \\exp\\left(-\\frac{z^2}{2\\sigma_{z}^2}\\right)$, with RMS length $\\sigma_{z}$.\n- Fourier transform definition for the line density: $\\tilde{\\lambda}(\\omega) = \\int_{-\\infty}^{\\infty} \\lambda(z) \\exp\\left(-i \\frac{\\omega z}{c}\\right) dz$.\n- Impedance Model 1 (Inductive): $Z_{\\parallel}(\\omega) = i L_k \\omega$, with $L_k$ a real constant.\n- Impedance Model 2 (Resistive-Wall): $Z_{\\parallel}(\\omega) = A \\omega^{-1/2}$, with $A$ a real, positive constant.\n- Quantity to be determined: Peak wake-induced energy spread, $\\Delta \\mathcal{E}_{\\text{peak}} = \\max_{z} |\\Delta \\mathcal{E}(z) - \\langle \\Delta \\mathcal{E} \\rangle|$, where $\\langle \\Delta \\mathcal{E} \\rangle$ is the average over the bunch distribution.\n- Goal: Find the exponents $a_{\\text{ind}}$ and $a_{\\text{rw}}$ in the scaling relations $\\Delta \\mathcal{E}_{\\text{peak}} \\sim \\sigma_{z}^{a_{\\text{ind}}}$ and $\\Delta \\mathcal{E}_{\\text{peak}} \\sim \\sigma_{z}^{a_{\\text{rw}}}$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is well-defined within the context of accelerator physics and computational electromagnetics. It uses standard definitions for wake voltage, impedance, and bunch distributions. The Gaussian bunch profile and the inductive and resistive-wall impedance models are canonical examples used in the field. The provided formulas are internally consistent. The definition of the Fourier transform is explicitly given, removing ambiguity. The definition for the resistive-wall impedance, $Z_{\\parallel}(\\omega) = A \\omega^{-1/2}$, is a simplification of the full form, particularly concerning its behavior for $\\omega < 0$. However, this is described as a high-frequency scaling, and the problem can be solved by focusing on the scaling properties rather than the exact functional form, which makes the simplification acceptable for the intended purpose. The problem is thus scientifically grounded, well-posed, and objective.\n\n### Step 3: Verdict and Action\nThe problem is valid. A complete solution will be developed.\n\n### Solution Derivation\n\nFirst, we determine the Fourier transform of the bunch current, $\\tilde{I}(\\omega)$. The current is $I(z) = Q c \\lambda(z)$, so its Fourier transform is $\\tilde{I}(\\omega) = Q c \\tilde{\\lambda}(\\omega)$.\nWe calculate $\\tilde{\\lambda}(\\omega)$ for the given Gaussian distribution:\n$$\n\\tilde{\\lambda}(\\omega) = \\int_{-\\infty}^{\\infty} \\frac{1}{\\sqrt{2\\pi} \\sigma_{z}} \\exp\\left(-\\frac{z'^2}{2\\sigma_{z}^2}\\right) \\exp\\left(-i \\frac{\\omega z'}{c}\\right) dz'\n$$\nThis is a standard Fourier transform of a Gaussian function. The integral of $\\exp(-ax^2)$ is $\\sqrt{\\pi/a}$. Completing the square in the exponent gives:\n$$\n-\\frac{z'^2}{2\\sigma_{z}^2} - i \\frac{\\omega z'}{c} = -\\frac{1}{2\\sigma_{z}^2}\\left(z'^2 + 2i \\frac{\\omega \\sigma_{z}^2}{c} z'\\right) = -\\frac{1}{2\\sigma_{z}^2}\\left(z' + i \\frac{\\omega \\sigma_{z}^2}{c}\\right)^2 - \\frac{\\omega^2 \\sigma_{z}^2}{2c^2}\n$$\nThe integral becomes:\n$$\n\\tilde{\\lambda}(\\omega) = \\frac{1}{\\sqrt{2\\pi} \\sigma_{z}} \\exp\\left(-\\frac{\\omega^2 \\sigma_{z}^2}{2c^2}\\right) \\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{1}{2\\sigma_{z}^2}\\left(z' + i \\frac{\\omega \\sigma_{z}^2}{c}\\right)^2\\right) dz'\n$$\nThe integral is over a shifted variable in the complex plane, but for a Gaussian, the value is invariant and equals $\\sqrt{2\\pi \\sigma_{z}^2} = \\sqrt{2\\pi}\\sigma_{z}$.\n$$\n\\tilde{\\lambda}(\\omega) = \\frac{1}{\\sqrt{2\\pi} \\sigma_{z}} \\exp\\left(-\\frac{\\omega^2 \\sigma_{z}^2}{2c^2}\\right) (\\sqrt{2\\pi} \\sigma_{z}) = \\exp\\left(-\\frac{\\omega^2 \\sigma_{z}^2}{2c^2}\\right)\n$$\nThus, the Fourier transform of the current is:\n$$\n\\tilde{I}(\\omega) = Q c \\exp\\left(-\\frac{\\omega^2 \\sigma_{z}^2}{2c^2}\\right)\n$$\n\nNow we can calculate the wake voltage and energy spread for each case.\n\n#### Case 1: Inductive Impedance, $Z_{\\parallel}(\\omega) = i L_{k} \\omega$\n\nThe wake voltage is:\n$$\nV_{\\text{wake}}(z) = \\frac{1}{2\\pi} \\int_{-\\infty}^{\\infty} (i L_{k} \\omega) \\left(Q c \\exp\\left(-\\frac{\\omega^2 \\sigma_{z}^2}{2c^2}\\right)\\right) \\exp\\left(i \\frac{\\omega z}{c}\\right) d\\omega\n$$\n$$\nV_{\\text{wake}}(z) = \\frac{i Q c L_{k}}{2\\pi} \\int_{-\\infty}^{\\infty} \\omega \\exp\\left(-\\frac{\\sigma_{z}^2}{2c^2}\\omega^2 + i \\frac{z}{c}\\omega \\right) d\\omega\n$$\nWe can evaluate this integral by noting the relationship between Fourier transforms and derivatives. The inverse Fourier transform of $i\\omega \\tilde{F}(\\omega)$ is $\\frac{d}{dt} f(t)$. Here, the variable is $z/c$. The inverse transform of $\\tilde{I}(\\omega)$ gives $I(z)$, so the inverse transform of $i\\omega \\tilde{I}(\\omega)$ is proportional to $\\frac{d}{dz}I(z)$.\nSpecifically, $V_{\\text{wake}}(z)$ is the convolution of the wake function $W(z)$ and the current $I(z)$. The wake function is the inverse FT of $Z_\\parallel(\\omega)$. $W(z) = \\text{IFT}[iL_k\\omega] = L_k c^2 \\delta'(z)$, where $\\delta'$ is the derivative of the Dirac delta function.\nSo $V_{\\text{wake}}(z) = \\int W(z-z') I(z') dz' = \\int L_k c^2 \\delta'(z-z') I(z') dz' = -L_k c^2 I'(z)$.\n$$\nI'(z) = \\frac{d}{dz} \\left( Q c \\frac{1}{\\sqrt{2\\pi} \\sigma_{z}} \\exp\\left(-\\frac{z^2}{2\\sigma_{z}^2}\\right) \\right) = \\frac{Q c}{\\sqrt{2\\pi} \\sigma_{z}} \\left(-\\frac{z}{\\sigma_z^2}\\right) \\exp\\left(-\\frac{z^2}{2\\sigma_{z}^2}\\right)\n$$\n$$\nV_{\\text{wake}}(z) = -L_k c^2 \\left( -\\frac{Q c z}{\\sqrt{2\\pi}\\sigma_z^3} \\exp\\left(-\\frac{z^2}{2\\sigma_z^2}\\right) \\right) = \\frac{L_k c^3 Q}{\\sqrt{2\\pi}\\sigma_z^3} z \\exp\\left(-\\frac{z^2}{2\\sigma_z^2}\\right)\n$$\nThe energy deviation is $\\Delta\\mathcal{E}(z) = -e V_{\\text{wake}}(z)$.\nTo find $\\Delta\\mathcal{E}_{\\text{peak}}$, we first need $\\langle \\Delta\\mathcal{E} \\rangle = \\int_{-\\infty}^{\\infty} \\Delta\\mathcal{E}(z) \\lambda(z) dz$.\n$$\n\\langle \\Delta\\mathcal{E} \\rangle \\propto \\int_{-\\infty}^{\\infty} z \\exp\\left(-\\frac{z^2}{2\\sigma_z^2}\\right) \\frac{1}{\\sigma_z} \\exp\\left(-\\frac{z^2}{2\\sigma_z^2}\\right) dz \\propto \\int_{-\\infty}^{\\infty} z \\exp\\left(-\\frac{z^2}{\\sigma_z^2}\\right) dz\n$$\nThe integrand is an odd function of $z$, so the integral over a symmetric interval is zero. Thus, $\\langle \\Delta\\mathcal{E} \\rangle = 0$.\nThen $\\Delta\\mathcal{E}_{\\text{peak}} = \\max_z |\\Delta\\mathcal{E}(z)|$. We must find the maximum of $|z \\exp(-\\frac{z^2}{2\\sigma_z^2})|$.\nLet $f(z) = z \\exp(-\\frac{z^2}{2\\sigma_z^2})$. Differentiating with respect to $z$ and setting to zero:\n$$\n\\frac{df}{dz} = \\exp\\left(-\\frac{z^2}{2\\sigma_z^2}\\right) + z \\left(-\\frac{z}{\\sigma_z^2}\\right) \\exp\\left(-\\frac{z^2}{2\\sigma_z^2}\\right) = \\left(1 - \\frac{z^2}{\\sigma_z^2}\\right) \\exp\\left(-\\frac{z^2}{2\\sigma_z^2}\\right) = 0\n$$\nThis gives $z_{max} = \\pm \\sigma_z$. The peak value of $|f(z)|$ is $|\\pm \\sigma_z \\exp(-(\\pm \\sigma_z)^2 / (2\\sigma_z^2))| = \\sigma_z \\exp(-1/2)$.\nSubstituting this into the expression for $|\\Delta\\mathcal{E}(z)|$:\n$$\n\\Delta\\mathcal{E}_{\\text{peak}} = \\left| -e \\left(\\frac{L_k c^3 Q}{\\sqrt{2\\pi}\\sigma_z^3}\\right) (\\sigma_z \\exp(-1/2)) \\right| \\propto \\frac{\\sigma_z}{\\sigma_z^3} = \\frac{1}{\\sigma_z^2}\n$$\nSo, $\\Delta\\mathcal{E}_{\\text{peak}} \\sim \\sigma_z^{-2}$. This means $a_{\\text{ind}} = -2$.\n\n#### Case 2: Resistive-Wall Impedance, $Z_{\\parallel}(\\omega) = A \\omega^{-1/2}$\n\nFor the wake function to be a real-valued function of time/position, the impedance in the frequency domain must satisfy $Z_{\\parallel}(-\\omega) = Z_{\\parallel}^*(\\omega)$. The provided form $Z_{\\parallel}(\\omega) = A \\omega^{-1/2}$ is real for $\\omega>0$. For the hermiticity condition to hold, $Z_{\\parallel}(\\omega)$ must be an even function if the wake is real, so we should use $Z_{\\parallel}(\\omega) = A|\\omega|^{-1/2}$. This form is singular at $\\omega = 0$, but the integral is regularized by the Gaussian spectrum of the bunch.\nThe wake voltage is:\n$$\nV_{\\text{wake}}(z) = \\frac{1}{2\\pi} \\int_{-\\infty}^{\\infty} A |\\omega|^{-1/2} \\left(Q c \\exp\\left(-\\frac{\\omega^2 \\sigma_{z}^2}{2c^2}\\right)\\right) \\exp\\left(i \\frac{\\omega z}{c}\\right) d\\omega\n$$\nTo find the scaling with $\\sigma_z$, we perform a change of variables in the integral. Let $u = \\omega \\sigma_z / c$. Then $\\omega = u c / \\sigma_z$ and $d\\omega = (c/\\sigma_z) du$.\n$$\nV_{\\text{wake}}(z) = \\frac{A Q c}{2\\pi} \\int_{-\\infty}^{\\infty} \\left|\\frac{uc}{\\sigma_z}\\right|^{-1/2} \\exp\\left(-\\frac{u^2}{2}\\right) \\exp\\left(i u \\frac{z}{\\sigma_z}\\right) \\frac{c}{\\sigma_z} du\n$$\nWe group the terms dependent on $\\sigma_z$:\n$$\nV_{\\text{wake}}(z) = \\frac{A Q c}{2\\pi} \\left(\\frac{c}{\\sigma_z}\\right)^{-1/2} \\left(\\frac{c}{\\sigma_z}\\right) \\int_{-\\infty}^{\\infty} |u|^{-1/2} \\exp\\left(-\\frac{u^2}{2}\\right) \\exp\\left(i u \\frac{z}{\\sigma_z}\\right) du\n$$\n$$\nV_{\\text{wake}}(z) = \\frac{A Q c}{2\\pi} c^{1/2} \\sigma_z^{-1/2} \\int_{-\\infty}^{\\infty} |u|^{-1/2} \\exp\\left(-\\frac{u^2}{2}\\right) \\exp\\left(i u \\frac{z}{\\sigma_z}\\right) du\n$$\nThe integral is a function of the dimensionless variable $\\zeta = z/\\sigma_z$. Let's call it $G(\\zeta)$.\nSo, $V_{\\text{wake}}(z)$ has the form $V_{\\text{wake}}(z) = C_{\\text{rw}} \\sigma_z^{-1/2} G(z/\\sigma_z)$, where $C_{\\text{rw}}$ is a constant independent of $\\sigma_z$.\nThe energy deviation is $\\Delta\\mathcal{E}(z) = -e C_{\\text{rw}} \\sigma_z^{-1/2} G(z/\\sigma_z)$.\nNext, we compute the average energy deviation $\\langle\\Delta\\mathcal{E}\\rangle$:\n$$\n\\langle\\Delta\\mathcal{E}\\rangle = \\int_{-\\infty}^{\\infty} \\Delta\\mathcal{E}(z) \\lambda(z) dz = \\int_{-\\infty}^{\\infty} \\left(-e C_{\\text{rw}} \\sigma_z^{-1/2} G\\left(\\frac{z}{\\sigma_z}\\right)\\right) \\frac{1}{\\sqrt{2\\pi}\\sigma_z} \\exp\\left(-\\frac{z^2}{2\\sigma_z^2}\\right) dz\n$$\nLet $y = z/\\sigma_z$, so $dz = \\sigma_z dy$.\n$$\n\\langle\\Delta\\mathcal{E}\\rangle = -e C_{\\text{rw}} \\sigma_z^{-1/2} \\int_{-\\infty}^{\\infty} G(y) \\frac{1}{\\sqrt{2\\pi}\\sigma_z} \\exp\\left(-\\frac{y^2}{2}\\right) \\sigma_z dy = -e C_{\\text{rw}} \\sigma_z^{-1/2} \\left( \\frac{1}{\\sqrt{2\\pi}} \\int_{-\\infty}^{\\infty} G(y) e^{-y^2/2} dy \\right)\n$$\nThe integral in the parenthesis is a constant number, let's call it $\\langle G \\rangle$. So, $\\langle\\Delta\\mathcal{E}\\rangle \\propto \\sigma_z^{-1/2}$.\nThe peak energy spread is $\\Delta\\mathcal{E}_{\\text{peak}} = \\max_z |\\Delta\\mathcal{E}(z) - \\langle\\Delta\\mathcal{E}\\rangle|$.\n$$\n\\Delta\\mathcal{E}(z) - \\langle\\Delta\\mathcal{E}\\rangle = -e C_{\\text{rw}} \\sigma_z^{-1/2} G(z/\\sigma_z) - (-e C_{\\text{rw}} \\sigma_z^{-1/2} \\langle G \\rangle) = -e C_{\\textrw}} \\sigma_z^{-1/2} \\left[ G(z/\\sigma_z) - \\langle G \\rangle \\right]\n$$\nThe peak value is found by maximizing the expression with respect to $z$:\n$$\n\\Delta\\mathcal{E}_{\\text{peak}} = \\left|-e C_{\\text{rw}} \\sigma_z^{-1/2}\\right| \\max_z \\left| G(z/\\sigma_z) - \\langle G \\rangle \\right|\n$$\nThe maximization is over the dimensionless variable $\\zeta = z/\\sigma_z$, so the result $\\max_\\zeta|G(\\zeta) - \\langle G \\rangle|$ is a constant number independent of $\\sigma_z$.\nTherefore, the scaling is determined entirely by the prefactor:\n$$\n\\Delta\\mathcal{E}_{\\text{peak}} \\sim \\sigma_z^{-1/2}\n$$\nThis gives the second exponent $a_{\\text{rw}} = -1/2$.\n\nThe two scaling exponents are $a_{\\text{ind}} = -2$ and $a_{\\text{rw}} = -1/2$.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n-2 & -\\frac{1}{2}\n\\end{pmatrix}\n}\n$$", "id": "3360475"}, {"introduction": "This final practice is a comprehensive exercise that bridges fundamental electromagnetic theory with numerical implementation, a core skill in computational science. You will derive the high-frequency asymptotic expression for the resistive-wall impedance—a cornerstone model in accelerator physics—directly from the Leontovich boundary condition. Subsequently, you will implement a numerical model to verify your analytical formula, a workflow that directly mirrors modern research and development in the field [@problem_id:3360518].", "problem": "You will derive and verify the high-frequency asymptotics of the longitudinal coupling impedance per unit length, denoted by $Z_{\\parallel}(\\omega)/L$, for an ultra-relativistic beam in a round, straight, resistive beam pipe of radius $a$ using the Leontovich surface-impedance boundary condition. You will then compare this asymptotics with a numerical extraction that models the boundary condition in the time domain and evaluates its discrete-time Fourier response up to the mesh Nyquist limit.\n\nAll computations must be performed in the International System of Units (SI). Any angular quantity must be in radians. The final numerical results to be output by your program must be unitless relative errors.\n\nStarting point and physical setting:\n- The wall material is a good conductor with conductivity $\\sigma$ and magnetic permeability $\\mu_0$ (assume vacuum permeability $\\mu_0 = 4\\pi \\times 10^{-7}\\ \\mathrm{H/m}$). The free-space permittivity is $\\varepsilon_0$, and the speed of light is $c = 1/\\sqrt{\\mu_0 \\varepsilon_0}$.\n- The Leontovich boundary condition relates the tangential electric and magnetic fields at a good-conductor surface via the surface impedance $Z_s(\\omega)$, namely $\\mathbf{E}_t(\\omega) = Z_s(\\omega)\\, \\big(\\hat{\\mathbf{n}} \\times \\mathbf{H}_t(\\omega)\\big)$, where for a good conductor $Z_s(\\omega) = (1 + i)\\, \\sqrt{\\omega \\mu_0/(2 \\sigma)}$.\n- Consider an ultra-relativistic, on-axis beam current $I(\\omega)$ in the circular pipe of radius $a$ such that in the vacuum region the dominant axisymmetric field near the wall is the azimuthal magnetic field $H_{\\phi}(r \\approx a,\\omega) \\approx I(\\omega)/(2\\pi a)$ (leading-order in the good-conductor, high-frequency limit). Use Maxwell’s equations, Poynting’s theorem, and the Leontovich boundary condition to derive a leading-order, high-frequency asymptotic expression for $Z_{\\parallel}(\\omega)/L$ in terms of $Z_s(\\omega)$ and the pipe radius $a$. Do not assume any specialized accelerator-physics formula for $Z_{\\parallel}(\\omega)/L$; derive it from the stated fundamental relations.\n\nNumerical extraction to verify the asymptotics:\n- The Leontovich boundary condition in the time domain for a good conductor can be expressed as a causal convolution between the wall electric field and the time-derivative of the wall magnetic field. In particular, if $E_z(a,t)$ is the axial electric field at the inner wall and $H_{\\phi}(a,t)$ is the azimuthal magnetic field at the inner wall, then for $t > 0$ the relation can be written in the form\n$$\nE_z(a,t) \\;=\\; \\sqrt{\\frac{\\mu_0}{\\pi \\sigma}} \\int_0^t \\frac{\\partial H_{\\phi}(a,\\tau)}{\\partial \\tau}\\, \\frac{\\mathrm{d}\\tau}{\\sqrt{t - \\tau}}.\n$$\n- Discretize this convolution on a uniform time grid with time step $\\Delta t$, using a backward finite-difference approximation for the time derivative and the Riemann-sum approximation for the integral. Let $g[n] = \\sqrt{\\mu_0/(\\pi \\sigma)}\\, (n \\Delta t)^{-1/2}$ for integers $n \\ge 1$ (and $g[0]=0$). If $H[n] \\approx H_{\\phi}(a, n \\Delta t)$, approximate\n$$\nE[n] \\;\\approx\\; \\sum_{m=1}^{n} g[n-m+1]\\; \\frac{H[m] - H[m-1]}{\\Delta t},\n$$\nwith $H[-1] = 0$. For the on-axis beam, use $H[n] = I[n]/(2\\pi a)$, where $I[n]$ is the discretized beam current waveform at the wall.\n- Instead of explicitly forming $E[n]$ by time-domain convolution, perform a frequency-domain extraction based on the discrete-time Fourier response of the above discrete operator. For an angular frequency $\\omega$, define the discrete-time angular frequency $\\Omega = \\omega \\Delta t$. Denote by $G(\\Omega)$ the discrete-time Fourier transform (DTFT) of the kernel $g[n]$ and by $D(\\Omega)$ the DTFT symbol of the backward difference, i.e., $D(\\Omega) = \\big(1 - e^{-i \\Omega}\\big)/\\Delta t$. Then the numerical extraction of the wall transfer function gives\n$$\n\\frac{E(\\omega)}{I(\\omega)} \\;\\approx\\; \\frac{G(\\Omega)\\, D(\\Omega)}{2\\pi a},\n$$\nwhere\n$$\nG(\\Omega) \\;\\approx\\; \\Delta t \\sum_{n=1}^{N-1} g[n]\\, e^{-i \\Omega n}.\n$$\n- The discrete-time Nyquist angular frequency is $\\omega_{\\mathrm{N}} = \\pi/\\Delta t$. Evaluate the numerical $Z_{\\parallel}(\\omega)/L$ via $Z_{\\parallel}^{\\mathrm{num}}(\\omega)/L := E(\\omega)/I(\\omega)$ at several angular frequencies below $\\omega_{\\mathrm{N}}$ and compare it against your derived high-frequency asymptotic formula $Z_{\\parallel}^{\\mathrm{asy}}(\\omega)/L$ evaluated at the same $\\omega$.\n- Define the relative complex error at frequency $\\omega$ as\n$$\n\\epsilon(\\omega) \\;=\\; \\frac{\\left| Z_{\\parallel}^{\\mathrm{num}}(\\omega)/L \\;-\\; Z_{\\parallel}^{\\mathrm{asy}}(\\omega)/L \\right|}{\\left| Z_{\\parallel}^{\\mathrm{asy}}(\\omega)/L \\right|}.\n$$\n\nTest suite and required outputs:\n- Use the following three test cases, all in SI units, each with its own time step $\\Delta t$, number of time samples $N$, pipe radius $a$, and conductivity $\\sigma$. For each case, evaluate the relative error $\\epsilon(\\omega)$ at angular frequencies $\\omega = \\alpha\\, \\omega_{\\mathrm{N}}$ with $\\alpha \\in \\{0.2, 0.5, 0.8\\}$, and report the maximum of the three errors for that case as a single float.\n    1. Case A (happy path): $a = 1.0 \\times 10^{-2}\\ \\mathrm{m}$, $\\sigma = 5.8 \\times 10^{7}\\ \\mathrm{S/m}$, $\\Delta t = 2.0 \\times 10^{-13}\\ \\mathrm{s}$, $N = 8192$.\n    2. Case B (coarser temporal mesh): $a = 1.0 \\times 10^{-2}\\ \\mathrm{m}$, $\\sigma = 5.8 \\times 10^{7}\\ \\mathrm{S/m}$, $\\Delta t = 1.0 \\times 10^{-12}\\ \\mathrm{s}$, $N = 4096$.\n    3. Case C (lower conductivity, larger pipe): $a = 5.0 \\times 10^{-2}\\ \\mathrm{m}$, $\\sigma = 1.4 \\times 10^{6}\\ \\mathrm{S/m}$, $\\Delta t = 5.0 \\times 10^{-13}\\ \\mathrm{s}$, $N = 8192$.\n- For each case, compute and return a single float equal to the maximum relative error over the three evaluation frequencies.\n- Your program should produce a single line of output containing the three results as a comma-separated list enclosed in square brackets (e.g., \"[resultA,resultB,resultC]\"). Round nothing; output raw floating-point values.\n\nAll symbols stated in this problem must be interpreted as follows: $Z_{\\parallel}(\\omega)/L$ is the longitudinal impedance per unit length, $Z_s(\\omega)$ is the surface impedance, $\\mu_0$ is the vacuum permeability, $\\varepsilon_0$ is the vacuum permittivity, $c$ is the speed of light in vacuum, $\\sigma$ is the wall conductivity, $a$ is the pipe radius, $\\Delta t$ is the uniform time step, $N$ is the number of time samples, $\\omega$ is the angular frequency at which $Z_{\\parallel}(\\omega)/L$ is evaluated, and $\\omega_{\\mathrm{N}}$ is the discrete-time Nyquist angular frequency. Ensure all computations are in SI units and all angles are in radians. The final outputs must be unitless floats as defined above.", "solution": "The problem requires the derivation of the high-frequency asymptotic expression for the longitudinal coupling impedance per unit length, $Z_{\\parallel}(\\omega)/L$, for an ultra-relativistic beam in a circular resistive pipe. This analytical result must then be compared against a numerical extraction based on a discrete time-domain model of the wall's electromagnetic response. The validation process confirms that the problem is scientifically sound, well-posed, and contains all necessary information to proceed.\n\n### Part 1: Derivation of the Asymptotic Longitudinal Impedance Per Unit Length\n\nThe primary goal is to find an expression for $Z_{\\parallel}^{\\mathrm{asy}}(\\omega)/L$. The problem provides context for the numerical evaluation that defines the longitudinal impedance per unit length as the transfer function relating the axial electric field at the pipe wall, $E_z(r=a, \\omega)$, to the beam current, $I(\\omega)$. We adopt this definition for a consistent analytical derivation:\n$$\n\\frac{Z_{\\parallel}(\\omega)}{L} \\equiv \\frac{E_z(r=a, \\omega)}{I(\\omega)}\n$$\n\nThe derivation proceeds in three steps, based on the provided physical principles.\n\n1.  **Application of the Leontovich Boundary Condition**: The Leontovich boundary condition provides a relationship between the tangential components of the electric field $\\mathbf{E}_t$ and magnetic field $\\mathbf{H}_t$ at the surface of a good conductor. It is given by $\\mathbf{E}_t(\\omega) = Z_s(\\omega)\\, \\big(\\hat{\\mathbf{n}} \\times \\mathbf{H}_t(\\omega)\\big)$, where $Z_s(\\omega)$ is the surface impedance and $\\hat{\\mathbf{n}}$ is the normal vector. We adopt the standard convention where the tangential fields are evaluated just inside the vacuum ($r=a^-$) and the normal vector $\\hat{\\mathbf{n}}$ points from the vacuum into the conductor, so $\\hat{\\mathbf{n}} = \\hat{\\mathbf{r}}$.\n\n    For an axisymmetric TM-like mode, the only non-zero tangential field components at the wall ($r=a$) are the axial electric field $E_z$ and the azimuthal magnetic field $H_{\\phi}$. Thus, $\\mathbf{E}_t = E_z \\hat{\\mathbf{z}}$ and $\\mathbf{H}_t = H_{\\phi} \\hat{\\mathbf{\\phi}}$.\n\n    Substituting these into the boundary condition:\n    $$\n    E_z \\hat{\\mathbf{z}} = Z_s(\\omega) \\left( \\hat{\\mathbf{r}} \\times (H_{\\phi} \\hat{\\mathbf{\\phi}}) \\right)\n    $$\n    Using the cylindrical coordinate relation $\\hat{\\mathbf{r}} \\times \\hat{\\mathbf{\\phi}} = \\hat{\\mathbf{z}}$, this simplifies to:\n    $$\n    E_z \\hat{\\mathbf{z}} = Z_s(\\omega) H_{\\phi} \\hat{\\mathbf{z}}\n    $$\n    Equating the vector components yields a direct relation between the field magnitudes at the wall:\n    $$\n    E_z(a, \\omega) = Z_s(\\omega) H_{\\phi}(a, \\omega)\n    $$\n\n2.  **High-Frequency Field Approximation**: For an ultra-relativistic beam traveling on the axis of the pipe, the electromagnetic fields it generates at the wall can be approximated, in the high-frequency limit, by the fields of a simple line current $I(\\omega)$. Applying Ampere's law in integral form to a circular loop of radius $a$ concentric with the beam gives:\n    $$\n    \\oint \\mathbf{H} \\cdot d\\mathbf{l} = I_{enc} \\implies H_{\\phi}(a, \\omega) \\cdot (2\\pi a) = I(\\omega)\n    $$\n    This yields the approximation for the azimuthal magnetic field at the wall:\n    $$\n    H_{\\phi}(a, \\omega) \\approx \\frac{I(\\omega)}{2\\pi a}\n    $$\n\n3.  **Final Expression for Impedance**: By substituting the expression for $H_{\\phi}(a, \\omega)$ into the result from the boundary condition, we obtain:\n    $$\n    E_z(a, \\omega) = Z_s(\\omega) \\frac{I(\\omega)}{2\\pi a}\n    $$\n    Using our working definition of impedance per unit length, we find the asymptotic expression:\n    $$\n    \\frac{Z_{\\parallel}^{\\mathrm{asy}}(\\omega)}{L} = \\frac{E_z(a, \\omega)}{I(\\omega)} = \\frac{Z_s(\\omega)}{2\\pi a}\n    $$\n    Finally, substituting the given formula for the surface impedance of a good conductor, $Z_s(\\omega) = (1 + i)\\, \\sqrt{\\frac{\\omega \\mu_0}{2 \\sigma}}$, we arrive at the final analytical expression to be used in the computation:\n    $$\n    \\frac{Z_{\\parallel}^{\\mathrm{asy}}(\\omega)}{L} = \\frac{1+i}{2\\pi a} \\sqrt{\\frac{\\omega \\mu_0}{2 \\sigma}}\n    $$\n\n### Part 2: Numerical Verification Algorithm\n\nThe problem specifies a numerical method to verify the asymptotic formula. This method computes the same quantity, $Z_{\\parallel}^{\\mathrm{num}}(\\omega)/L = E(a, \\omega)/I(\\omega)$, but starts from a discrete time-domain convolution representing the wall's response. The frequency response is then obtained via the Discrete-Time Fourier Transform (DTFT).\n\nThe numerical impedance per unit length is given by:\n$$\n\\frac{Z_{\\parallel}^{\\mathrm{num}}(\\omega)}{L} = \\frac{G(\\Omega)\\, D(\\Omega)}{2\\pi a}\n$$\nwhere $\\Omega = \\omega \\Delta t$ is the discrete-time angular frequency. The components $D(\\Omega)$ and $G(\\Omega)$ represent the frequency-domain responses of the discrete operators used in the time-domain model.\n\n1.  **Backward Difference Operator, $D(\\Omega)$**: The time derivative $\\partial H_{\\phi}/\\partial \\tau$ is approximated by a backward finite difference, $(H[m] - H[m-1])/\\Delta t$. The DTFT of this operation corresponds to multiplication by the symbol $D(\\Omega)$:\n    $$\n    D(\\Omega) = \\frac{1 - e^{-i \\Omega}}{\\Delta t}\n    $$\n\n2.  **Convolution Kernel, $G(\\Omega)$**: The time-domain convolution involves the kernel $\\sqrt{\\mu_0/(\\pi\\sigma)} (t-\\tau)^{-1/2}$. After discretization, this becomes the sequence $g[n] = \\sqrt{\\mu_0/(\\pi \\sigma)}\\, (n \\Delta t)^{-1/2}$ for $n \\ge 1$. The numerical procedure approximates the DTFT of $g[n]$ with a finite sum over $N-1$ terms:\n    $$\n    G(\\Omega) \\approx \\Delta t \\sum_{n=1}^{N-1} g[n]\\, e^{-i \\Omega n}\n    $$\n    Substituting the expression for $g[n]$ and simplifying the constants:\n    $$\n    G(\\Omega) \\approx \\Delta t \\sum_{n=1}^{N-1} \\left(\\sqrt{\\frac{\\mu_0}{\\pi \\sigma n \\Delta t}}\\right) e^{-i \\Omega n} = \\sqrt{\\frac{\\mu_0 \\Delta t}{\\pi \\sigma}} \\sum_{n=1}^{N-1} \\frac{e^{-i \\Omega n}}{\\sqrt{n}}\n    $$\n    This sum is computed directly for each required frequency.\n\n### Part 3: Computational Procedure\n\nFor each test case defined by parameters $\\{a, \\sigma, \\Delta t, N\\}$:\n1.  Define the physical constants, primarily the vacuum permeability $\\mu_0 = 4\\pi \\times 10^{-7}\\ \\mathrm{H/m}$.\n2.  Calculate the Nyquist angular frequency, $\\omega_{\\mathrm{N}} = \\pi/\\Delta t$.\n3.  Initialize an empty list to store the errors for the current case.\n4.  Iterate through the specified frequency scaling factors $\\alpha \\in \\{0.2, 0.5, 0.8\\}$. In each iteration:\n    a.  Calculate the evaluation angular frequency $\\omega = \\alpha \\omega_{\\mathrm{N}}$.\n    b.  Compute the complex value of the asymptotic impedance $Z_{\\parallel}^{\\mathrm{asy}}(\\omega)/L$ using the derived formula.\n    c.  Compute the complex value of the numerical impedance $Z_{\\parallel}^{\\mathrm{num}}(\\omega)/L$. This involves:\n        i.  Calculating the discrete-time frequency $\\Omega = \\omega \\Delta t$.\n        ii. Calculating the term $D(\\Omega)$.\n        iii. Calculating the term $G(\\Omega)$ by performing the summation from $n=1$ to $N-1$.\n        iv. Combining these components to get $Z_{\\parallel}^{\\mathrm{num}}(\\omega)/L$.\n    d.  Calculate the relative complex error $\\epsilon(\\omega)$ using the provided formula:\n        $$\n        \\epsilon(\\omega) = \\frac{\\left| Z_{\\parallel}^{\\mathrm{num}}(\\omega)/L - Z_{\\parallel}^{\\mathrm{asy}}(\\omega)/L \\right|}{\\left| Z_{\\parallel}^{\\mathrm{asy}}(\\omega)/L \\right|}\n        $$\n    e.  Append the calculated error $\\epsilon(\\omega)$ to the list of errors.\n5.  After the loop over $\\alpha$ is complete, find the maximum value in the list of errors. This maximum error is the result for the test case.\n6.  Repeat for all test cases and format the final results as a comma-separated list in brackets.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Derives and verifies the high-frequency asymptotics of the longitudinal\n    coupling impedance for a resistive beam pipe.\n    \"\"\"\n    # Define physical constants. All calculations are in SI units.\n    # Vacuum permeability (H/m)\n    mu_0 = 4.0 * np.pi * 1e-7\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case A (happy path)\n        {'a': 1.0e-2, 'sigma': 5.8e7, 'dt': 2.0e-13, 'N': 8192},\n        # Case B (coarser temporal mesh)\n        {'a': 1.0e-2, 'sigma': 5.8e7, 'dt': 1.0e-12, 'N': 4096},\n        # Case C (lower conductivity, larger pipe)\n        {'a': 5.0e-2, 'sigma': 1.4e6, 'dt': 5.0e-13, 'N': 8192},\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        a = case['a']\n        sigma = case['sigma']\n        dt = case['dt']\n        N = case['N']\n\n        # Discrete-time Nyquist angular frequency\n        omega_nyquist = np.pi / dt\n        \n        # evaluation frequencies are specified as fractions of the Nyquist frequency\n        alphas = [0.2, 0.5, 0.8]\n        \n        case_errors = []\n\n        for alpha in alphas:\n            # Current angular frequency for evaluation\n            omega = alpha * omega_nyquist\n\n            # 1. Calculate the analytical asymptotic impedance per unit length\n            # Zs = (1+i) * sqrt(omega * mu_0 / (2 * sigma))\n            Z_s = (1.0 + 1.0j) * np.sqrt(omega * mu_0 / (2.0 * sigma))\n            # Z_asy/L = Zs / (2*pi*a)\n            Z_asy_per_L = Z_s / (2.0 * np.pi * a)\n\n            # 2. Calculate the numerical impedance per unit length\n            # Discrete-time angular frequency\n            Omega = omega * dt\n\n            # Calculate D(Omega), the DTFT symbol of the backward difference operator\n            D_Omega = (1.0 - np.exp(-1.0j * Omega)) / dt\n\n            # Calculate G(Omega), the DTFT of the discrete convolution kernel g[n]\n            # G(Omega) = dt * sum_{n=1}^{N-1} g[n] * exp(-i*Omega*n)\n            # g[n] = sqrt(mu_0/(pi*sigma)) / sqrt(n*dt)\n            \n            # The summation runs from n=1 to N-1\n            n_vals = np.arange(1, N)\n            \n            # Vectorized computation of the sum_terms\n            sum_terms = np.exp(-1.0j * Omega * n_vals) / np.sqrt(n_vals)\n            G_Omega_sum = np.sum(sum_terms)\n\n            G_Omega_prefactor = dt * np.sqrt(mu_0 / (np.pi * sigma * dt))\n            G_Omega = G_Omega_prefactor * G_Omega_sum\n            \n            # Combine to get the numerical impedance\n            Z_num_per_L = (G_Omega * D_Omega) / (2.0 * np.pi * a)\n            \n            # 3. Calculate the relative complex error\n            # error = |Z_num/L - Z_asy/L| / |Z_asy/L|\n            error = np.abs(Z_num_per_L - Z_asy_per_L) / np.abs(Z_asy_per_L)\n            case_errors.append(error)\n        \n        # The result for the case is the maximum error over the evaluated frequencies\n        results.append(max(case_errors))\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3360518"}]}