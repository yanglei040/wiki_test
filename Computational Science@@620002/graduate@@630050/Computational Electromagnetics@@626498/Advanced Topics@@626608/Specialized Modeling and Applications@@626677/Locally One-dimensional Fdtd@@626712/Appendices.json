{"hands_on_practices": [{"introduction": "The Locally One-Dimensional (LOD) FDTD method is prized for its unconditional stability, which allows the use of time steps exceeding the Courant-Friedrichs-Lewy (CFL) limit of explicit schemes. However, this stability comes with a trade-off in accuracy, primarily in the form of numerical dispersion. This first practice provides a foundational analysis of this trade-off by examining the inherent dispersion of the one-dimensional implicit scheme that forms the basis of LOD-FDTD. By seeking the time step that minimizes the integrated dispersion error, you will uncover a fundamental characteristic of the method and contrast it with the well-known behavior of explicit FDTD schemes [@problem_id:3325286].", "problem": "Consider a lossless, homogeneous, source-free, one-dimensional electromagnetic medium with permittivity $\\varepsilon$, permeability $\\mu$, and wave speed $c = 1/\\sqrt{\\varepsilon \\mu}$. Let the spatial grid be uniform with spacing $\\Delta$, and consider a Locally One-Dimensional Finite-Difference Time-Domain (LOD-FDTD) discretization in one dimension, which reduces to a trapezoidal (Crank–Nicolson) time discretization of the first-order Maxwell curl equations with centered spatial differences on the standard staggered Yee grid. Assume an infinitely extended periodic grid so that Fourier (von Neumann) analysis applies, and consider plane-wave solutions with wavenumber magnitude $k$ in the first Brillouin zone $k \\in [0, \\pi/\\Delta]$.\n\nDefine the numerical angular frequency $\\omega_{\\text{num}}(k; \\Delta t, \\Delta)$ implied by the LOD-FDTD scheme, and the physical angular frequency $\\omega_{\\text{phys}}(k) = c\\,k$. Define the integrated dispersion error functional over the Brillouin zone\n$$\n\\mathcal{E}(\\Delta t) = \\int_{-\\pi/\\Delta}^{\\pi/\\Delta} \\left(\\omega_{\\text{num}}(k; \\Delta t, \\Delta) - \\omega_{\\text{phys}}(k)\\right)^{2} \\, \\mathrm{d}k.\n$$\nStarting from Maxwell’s equations and the stated LOD-FDTD discretization, derive $\\omega_{\\text{num}}(k; \\Delta t, \\Delta)$ via von Neumann analysis and determine the value of the time step $\\Delta t$ that minimizes $\\mathcal{E}(\\Delta t)$ for fixed $\\Delta$. If the minimum is only achieved in a limit, report that limiting value. Express your final answer as a single closed-form value for the optimal $\\Delta t$ in seconds.\n\nThen, briefly contrast this optimal choice with the accuracy-driven choice of time step in the explicit Yee Finite-Difference Time-Domain (FDTD) method in one dimension, discussing how the Courant ratio affects numerical dispersion within the same Brillouin zone. Your final answer must be a single number or closed-form expression for the optimal $\\Delta t$ that minimizes $\\mathcal{E}(\\Delta t)$; do not include any units inside the final answer box.", "solution": "The problem asks for the value of the time step $\\Delta t$ that minimizes a given integrated dispersion error functional for a one-dimensional Locally One-Dimensional Finite-Difference Time-Domain (LOD-FDTD) scheme.\n\n### Step 1: Problem Validation\n\n**1.1. Extract Givens:**\n- **Medium:** Lossless, homogeneous, source-free, one-dimensional electromagnetic medium.\n- **Constants:** Permittivity $\\varepsilon$, permeability $\\mu$, wave speed $c = 1/\\sqrt{\\varepsilon \\mu}$.\n- **Grid:** Uniform spatial grid with spacing $\\Delta$. Infinitely extended periodic grid.\n- **Discretization Scheme:** LOD-FDTD in 1D, which is specified as a trapezoidal (Crank–Nicolson) time discretization of the first-order Maxwell curl equations with centered spatial differences on a standard staggered Yee grid.\n- **Analysis:** Fourier (von Neumann) analysis for plane-wave solutions with wavenumber magnitude $k$ in the first Brillouin zone, $k \\in [0, \\pi/\\Delta]$.\n- **Definitions:**\n    - Numerical angular frequency: $\\omega_{\\text{num}}(k; \\Delta t, \\Delta)$.\n    - Physical angular frequency: $\\omega_{\\text{phys}}(k) = c\\,k$.\n- **Error Functional:**\n$$ \\mathcal{E}(\\Delta t) = \\int_{-\\pi/\\Delta}^{\\pi/\\Delta} \\left(\\omega_{\\text{num}}(k; \\Delta t, \\Delta) - \\omega_{\\text{phys}}(k)\\right)^{2} \\, \\mathrm{d}k $$\n- **Objective:**\n    1. Derive $\\omega_{\\text{num}}(k; \\Delta t, \\Delta)$.\n    2. Determine the value of $\\Delta t$ that minimizes $\\mathcal{E}(\\Delta t)$ for a fixed $\\Delta$.\n    3. Briefly contrast this optimal $\\Delta t$ with that of the explicit 1D Yee FDTD method.\n\n**1.2. Validate Using Extracted Givens:**\n- **Scientific Grounding:** The problem is based on Maxwell's equations and their numerical solution via the FDTD method, a cornerstone of computational electromagnetics. The concepts of numerical dispersion, von Neumann analysis, and error functionals are standard and scientifically sound.\n- **Well-Posedness:** The problem sets up a clear optimization task: minimizing a well-defined functional. The definitions are precise.\n- **Objectivity:** The problem is stated in precise, objective mathematical and physical language.\n\n**1.3. Verdict:**\nThe problem statement is scientifically grounded, self-contained, and well-posed. It is a valid problem in computational physics.\n\n### Step 2: Derivation of the Numerical Dispersion Relation\n\nWe begin with the 1D Maxwell's equations for a TEz polarization (with field components $E_z$ and $H_y$):\n$$ \\frac{\\partial E_z}{\\partial t} = -\\frac{1}{\\varepsilon} \\frac{\\partial H_y}{\\partial x} $$\n$$ \\frac{\\partial H_y}{\\partial t} = -\\frac{1}{\\mu} \\frac{\\partial E_z}{\\partial x} $$\nOn a staggered Yee grid, we denote $E_z(i\\Delta, n\\Delta t) \\equiv E_{z,i}^n$ and $H_y((i+1/2)\\Delta, n\\Delta t) \\equiv H_{y,i+1/2}^n$. The Crank-Nicolson discretization (trapezoidal rule in time) combined with centered spatial differences gives:\n$$ \\frac{E_{z,i}^{n+1} - E_{z,i}^n}{\\Delta t} = -\\frac{1}{2\\varepsilon\\Delta} \\left[ (H_{y,i+1/2}^{n+1} - H_{y,i-1/2}^{n+1}) + (H_{y,i+1/2}^n - H_{y,i-1/2}^n) \\right] $$\n$$ \\frac{H_{y,i+1/2}^{n+1} - H_{y,i+1/2}^n}{\\Delta t} = -\\frac{1}{2\\mu\\Delta} \\left[ (E_{z,i+1}^{n+1} - E_{z,i}^{n+1}) + (E_{z,i+1}^n - E_{z,i}^n) \\right] $$\nWe perform a von Neumann analysis by substituting the plane-wave ansatz:\n$$ E_{z,i}^n = \\hat{E}_z \\exp[j(k i\\Delta - \\omega_{\\text{num}} n\\Delta t)] $$\n$$ H_{y,i+1/2}^n = \\hat{H}_y \\exp[j(k(i+1/2)\\Delta - \\omega_{\\text{num}} n\\Delta t)] $$\nwhere $j = \\sqrt{-1}$. Let the amplification factor be $G = \\exp(-j\\omega_{\\text{num}}\\Delta t)$. Substituting the ansatz into the discretized equations yields a system of linear equations for the amplitudes $\\hat{E}_z$ and $\\hat{H}_y$:\n$$ \\hat{E}_z (G-1) = -\\frac{\\Delta t}{2\\varepsilon\\Delta} \\left( \\hat{H}_y \\exp(j k\\Delta/2) - \\hat{H}_y \\exp(-j k\\Delta/2) \\right) (G+1) $$\n$$ \\hat{H}_y (G-1) = -\\frac{\\Delta t}{2\\mu\\Delta} \\left( \\hat{E}_z \\exp(j k\\Delta/2) - \\hat{E}_z \\exp(-j k\\Delta/2) \\right) (G+1) $$\nSimplifying using $\\exp(j\\theta) - \\exp(-j\\theta) = 2j\\sin(\\theta)$:\n$$ \\hat{E}_z (G-1) = -\\frac{j\\Delta t}{\\varepsilon\\Delta} \\sin\\left(\\frac{k\\Delta}{2}\\right) (G+1) \\hat{H}_y $$\n$$ \\hat{H}_y (G-1) = -\\frac{j\\Delta t}{\\mu\\Delta} \\sin\\left(\\frac{k\\Delta}{2}\\right) (G+1) \\hat{E}_z $$\nFor a non-trivial solution, we multiply these two equations and cancel $\\hat{E}_z \\hat{H}_y$:\n$$ (G-1)^2 = (j^2) \\frac{(\\Delta t)^2}{\\varepsilon\\mu\\Delta^2} \\sin^2\\left(\\frac{k\\Delta}{2}\\right) (G+1)^2 $$\nUsing $c=1/\\sqrt{\\varepsilon\\mu}$, we get:\n$$ (G-1)^2 = -\\frac{c^2(\\Delta t)^2}{\\Delta^2} \\sin^2\\left(\\frac{k\\Delta}{2}\\right) (G+1)^2 $$\nTaking the square root and rearranging for $G$:\n$$ \\frac{G-1}{G+1} = \\pm j \\frac{c\\Delta t}{\\Delta} \\sin\\left(\\frac{k\\Delta}{2}\\right) $$\nFrom the definition $G = \\exp(-j\\omega_{\\text{num}}\\Delta t)$ and the identity $\\frac{\\exp(-j\\phi)-1}{\\exp(-j\\phi)+1} = -j\\tan(\\phi/2)$:\n$$ -j\\tan\\left(\\frac{\\omega_{\\text{num}}\\Delta t}{2}\\right) = \\pm j \\frac{c\\Delta t}{\\Delta} \\sin\\left(\\frac{k\\Delta}{2}\\right) $$\nChoosing the physically relevant positive frequency solution:\n$$ \\tan\\left(\\frac{\\omega_{\\text{num}}\\Delta t}{2}\\right) = \\frac{c\\Delta t}{\\Delta} \\sin\\left(\\frac{k\\Delta}{2}\\right) $$\nSolving for $\\omega_{\\text{num}}$ gives the numerical dispersion relation:\n$$ \\omega_{\\text{num}}(k; \\Delta t, \\Delta) = \\frac{2}{\\Delta t} \\arctan\\left(\\frac{c \\Delta t}{\\Delta} \\sin\\left(\\frac{k\\Delta}{2}\\right)\\right) $$\n\n### Step 3: Minimization of the Error Functional\n\nThe dispersion error functional is given by:\n$$ \\mathcal{E}(\\Delta t) = \\int_{-\\pi/\\Delta}^{\\pi/\\Delta} \\left[ \\frac{2}{\\Delta t} \\arctan\\left(\\frac{c \\Delta t}{\\Delta} \\sin\\left(\\frac{k\\Delta}{2}\\right)\\right) - ck \\right]^{2} \\, \\mathrm{d}k $$\nThe integrand is non-negative, so $\\mathcal{E}(\\Delta t) \\ge 0$. The minimum value of $\\mathcal{E}(\\Delta t)$ is sought. We investigate the behavior of the integrand as a function of $\\Delta t$.\nLet us introduce dimensionless variables for clarity. Let $S = c\\Delta t/\\Delta$ be the Courant number and $u = k\\Delta/2$. The integration variable $k$ spans $[-\\pi/\\Delta, \\pi/\\Delta]$, so $u$ spans $[-\\pi/2, \\pi/2]$. The physical frequency is $\\omega_{\\text{phys}} = ck = c(2u/\\Delta)$. The expression inside the square becomes:\n$$ \\frac{2c}{S\\Delta} \\arctan(S \\sin u) - \\frac{2cu}{\\Delta} = \\frac{2c}{\\Delta} \\left( \\frac{\\arctan(S \\sin u)}{S} - u \\right) $$\nThe functional can be rewritten as:\n$$ \\mathcal{E}(S) = \\int_{-\\pi/2}^{\\pi/2} \\left[ \\frac{2c}{\\Delta} \\left( \\frac{\\arctan(S \\sin u)}{S} - u \\right) \\right]^2 \\frac{2}{\\Delta} \\mathrm{d}u = \\frac{8c^2}{\\Delta^3} \\int_{-\\pi/2}^{\\pi/2} \\left( \\frac{\\arctan(S \\sin u)}{S} - u \\right)^2 \\mathrm{d}u $$\nWe seek to minimize $\\mathcal{E}(S)$ with respect to $S > 0$. This is equivalent to minimizing the squared error term in the integrand for each $u$. Let's analyze the function $g(S, u) = \\frac{\\arctan(S \\sin u)}{S} - u$.\n\nConsider a fixed $u \\in (0, \\pi/2]$. Let $x = \\sin u$, so $x \\in (0, 1]$. We analyze the behavior of the function $h(S) = \\frac{\\arctan(Sx)}{S}$ as a function of $S > 0$.\nThe derivative of $h(S)$ with respect to $S$ is:\n$$ \\frac{\\mathrm{d}h}{\\mathrm{d}S} = \\frac{\\frac{x}{1+(Sx)^2}S - \\arctan(Sx)}{S^2} = \\frac{1}{S^2} \\left( \\frac{Sx}{1+(Sx)^2} - \\arctan(Sx) \\right) $$\nLet $z = Sx$. For $z>0$, we analyze the sign of the term $p(z) = \\frac{z}{1+z^2} - \\arctan(z)$.\nThe derivative is $p'(z) = \\frac{(1+z^2) - z(2z)}{(1+z^2)^2} - \\frac{1}{1+z^2} = \\frac{1-z^2-(1+z^2)}{(1+z^2)^2} = \\frac{-2z^2}{(1+z^2)^2}$.\nFor $z > 0$, $p'(z)  0$. Since $p(0)=0$, it follows that $p(z)  0$ for all $z > 0$.\nThis implies $\\frac{\\mathrm{d}h}{\\mathrm{d}S}  0$ for all $S>0$. Thus, for any fixed $u \\in (0, \\pi/2]$, $h(S)$ is a strictly decreasing function of $S$.\nThe full error term is $g(S, u) = h(S) - u$. Since $h(S)$ is strictly decreasing in $S$, so is $g(S, u)$.\nLet's check the value of the error at $S \\to 0$:\n$$ \\lim_{S\\to 0} g(S, u) = \\lim_{S\\to 0} \\frac{\\arctan(S \\sin u)}{S} - u = \\sin u - u $$\nFor $u \\in (0, \\pi/2]$, we know $\\sin u  u$, so this limiting error is negative.\nSince $g(S, u)$ is strictly decreasing from a negative initial value, $g(S, u)$ is negative for all $S > 0$ and $u \\in (0, \\pi/2]$.\nThe magnitude of the error, $|g(S, u)|$, is therefore a strictly increasing function of $S$. Consequently, the integrand, which is proportional to $g(S, u)^2 = |g(S, u)|^2$, is a strictly increasing function of $S$ (and thus $\\Delta t$) for any $u \\in (0, \\pi/2]$.\nThe total integrated error $\\mathcal{E}(\\Delta t)$ is therefore a monotonically increasing function of $\\Delta t$ for $\\Delta t \\ge 0$.\nThe minimum of a monotonically increasing function on the domain $[0, \\infty)$ occurs at the boundary, i.e., in the limit $\\Delta t \\to 0$.\n\nThe value of the time step that minimizes the integrated dispersion error functional is $\\Delta t = 0$.\n\n### Step 4: Contrast with Explicit Yee FDTD\n\nThe finding that the optimal time step is $\\Delta t = 0$ for the LOD-FDTD (Crank-Nicolson) scheme provides a stark contrast to the behavior of the standard explicit leapfrog Yee FDTD scheme in one dimension.\n\nFor the 1D explicit Yee scheme, the numerical dispersion relation is:\n$$ \\omega_{\\text{num,Yee}} = \\frac{2}{\\Delta t} \\arcsin\\left(\\frac{c \\Delta t}{\\Delta} \\sin\\left(\\frac{k\\Delta}{2}\\right)\\right) $$\nThis scheme is conditionally stable, requiring the Courant number $S = c\\Delta t/\\Delta \\le 1$.\nThe dispersion error for the Yee scheme is $\\omega_{\\text{num,Yee}} - \\omega_{\\text{phys}}$. We can ask if this error can be made zero for all $k$. This would require:\n$$ \\frac{2}{\\Delta t} \\arcsin\\left(S \\sin\\left(\\frac{k\\Delta}{2}\\right)\\right) = ck $$\nSubstituting $S = c\\Delta t/\\Delta$ and $u=k\\Delta/2$:\n$$ \\frac{c}{S\\Delta} \\arcsin(S\\sin u) = \\frac{cu}{\\Delta} \\implies \\arcsin(S\\sin u) = Su $$\nThis equation holds for all $u \\in [-\\pi/2, \\pi/2]$ if and only if $S=1$. At this specific value, $\\arcsin(\\sin u) = u$, and the numerical dispersion relation becomes $\\omega_{\\text{num,Yee}} = ck = \\omega_{\\text{phys}}$.\nThis means for the explicit 1D Yee scheme, choosing the time step $\\Delta t = \\Delta/c$ (i.e., operating at the Courant stability limit $S=1$) completely eliminates numerical dispersion. The functional $\\mathcal{E}(\\Delta t)$ would be identically zero for this choice.\n\n**In summary:**\n- The implicit **LOD-FDTD (Crank-Nicolson) scheme** is unconditionally stable but is always dispersive for any $\\Delta t > 0$. The integrated dispersion error is minimized only in the limit $\\Delta t \\to 0$.\n- The explicit **Yee FDTD scheme** is conditionally stable ($c\\Delta t/\\Delta \\le 1$) but possesses a \"magic time step\" $\\Delta t = \\Delta/c$ at which it becomes completely free of numerical dispersion. This represents a finite, non-zero optimal choice for accuracy.\n\nThis highlights a fundamental trade-off: the implicit scheme offers unconditional stability at the cost of inherent dispersion, whereas the explicit scheme can achieve perfect accuracy (no dispersion) but is subject to a stability constraint on the time step.", "answer": "$$ \\boxed{0} $$", "id": "3325286"}, {"introduction": "Moving from one to multiple dimensions, the core idea of the LOD-FDTD method is to \"split\" the multi-dimensional Maxwell operator into a sequence of one-dimensional updates. While this preserves unconditional stability, the fact that these directional operators do not commute introduces a \"splitting error,\" which is a dominant source of inaccuracy. This exercise provides a direct, hands-on way to quantify this error by designing a numerical experiment in a 2D periodic domain. You will implement the Strang-splitting operator and measure the accumulated phase error, directly linking the abstract operator formalism to a concrete computational result [@problem_id:3325222].", "problem": "Consider Maxwell's equations in vacuum for a two-dimensional transverse magnetic polarization about the $z$-axis, where the nonzero field components are $H_x$, $H_y$, and $E_z$. The governing equations are\n$$\n\\frac{\\partial H_x}{\\partial t} = -\\frac{1}{\\mu_0}\\frac{\\partial E_z}{\\partial y},\\quad \\frac{\\partial H_y}{\\partial t} = \\frac{1}{\\mu_0}\\frac{\\partial E_z}{\\partial x},\\quad \\frac{\\partial E_z}{\\partial t} = \\frac{1}{\\varepsilon_0}\\left(\\frac{\\partial H_y}{\\partial x} - \\frac{\\partial H_x}{\\partial y}\\right),\n$$\nwith vacuum permittivity $\\varepsilon_0$ and vacuum permeability $\\mu_0$. Let the speed of light be $c = 1/\\sqrt{\\varepsilon_0 \\mu_0}$. On a rectangular periodic domain (a \"periodic box\") with lengths $L_x$ and $L_y$, the admissible spatial Fourier modes have wavenumbers\n$$\nk_x = \\frac{2\\pi n_x}{L_x},\\quad k_y = \\frac{2\\pi n_y}{L_y},\n$$\nwhere $n_x$ and $n_y$ are integers. For a single Fourier mode, the fields evolve according to a linear ordinary differential equation\n$$\n\\frac{d}{dt}\\begin{bmatrix}H_x \\\\ H_y \\\\ E_z\\end{bmatrix} = \\mathbf{M}\\begin{bmatrix}H_x \\\\ H_y \\\\ E_z\\end{bmatrix},\n$$\nwith\n$$\n\\mathbf{M} = \\mathbf{M}_x + \\mathbf{M}_y, \\quad \\mathbf{M}_x = \\begin{bmatrix}0  0  0 \\\\ 0  0  \\frac{i k_x}{\\mu_0} \\\\ 0  \\frac{i k_x}{\\varepsilon_0}  0\\end{bmatrix},\\quad \\mathbf{M}_y = \\begin{bmatrix}0  0  -\\frac{i k_y}{\\mu_0} \\\\ 0  0  0 \\\\ -\\frac{i k_y}{\\varepsilon_0}  0  0\\end{bmatrix}.\n$$\nThe exact solution for a plane wave with angular frequency $\\omega = c \\sqrt{k_x^2 + k_y^2}$ is a rotation in the invariant subspace associated with the eigenvalues $\\lambda_\\pm = \\pm i \\omega$ of $\\mathbf{M}$, and its one-step evolution over a time increment $\\Delta t$ is given by the matrix exponential $\\exp(\\Delta t\\,\\mathbf{M})$. In a Locally One-Dimensional (LOD) split-operator scheme, the time-update operator over $\\Delta t$ is approximated by a Strang-type product\n$$\n\\mathbf{G}_\\text{LOD}(\\Delta t) = \\exp\\!\\left(\\frac{\\Delta t}{2}\\mathbf{M}_x\\right)\\,\\exp\\!\\left(\\Delta t\\,\\mathbf{M}_y\\right)\\,\\exp\\!\\left(\\frac{\\Delta t}{2}\\mathbf{M}_x\\right),\n$$\nwhich corresponds to a second-order Locally One-Dimensional (LOD) Finite-Difference Time-Domain (FDTD) operator splitting in time for the semi-discrete Fourier mode.\n\nDesign a periodic-box experiment that starts from the physical plane-wave eigenvector associated with the eigenvalue $\\lambda_- = -i \\omega$, initializes the fields consistently with this eigenvector, and performs $N$ cycles of time evolution under the LOD split operator with a fixed number $m$ of steps per period. One period is $T = 2\\pi/\\omega$, and the time step is $\\Delta t = T/m$. After $N$ periods, define the accumulated phase as the total argument of the dominant complex eigenvalue of $\\mathbf{G}_\\text{LOD}(\\Delta t)$ multiplied by the total number of steps $N m$. The exact accumulated phase after $N$ cycles is $-2\\pi N$ radians. The accumulated phase error is the difference between the numerically accumulated phase and the exact accumulated phase, expressed in radians.\n\nYou must relate the error to the operator-splitting structure by using the decomposition $\\mathbf{M} = \\mathbf{M}_x + \\mathbf{M}_y$ as specified, but your program should compute the accumulated phase error numerically from the split operator. All angles must be expressed in radians. Use $\\varepsilon_0 = 8.854187817\\times 10^{-12}\\,\\mathrm{F/m}$, $\\mu_0 = 4\\pi\\times 10^{-7}\\,\\mathrm{H/m}$, and $c = 1/\\sqrt{\\varepsilon_0 \\mu_0}$ in SI units.\n\nImplement a program that, for each test case below, constructs $\\mathbf{M}_x$ and $\\mathbf{M}_y$ for the specified periodic box, computes $\\mathbf{G}_\\text{LOD}(\\Delta t)$, identifies the eigenvalue of $\\mathbf{G}_\\text{LOD}(\\Delta t)$ closest to the exact one-step phase factor $\\exp(-i\\omega\\Delta t)$, and reports the accumulated phase error after $N$ cycles as a single float in radians.\n\nTest suite parameter sets (each tuple lists $(L_x\\,\\mathrm{[m]}, L_y\\,\\mathrm{[m]}, n_x, n_y, N, m)$):\n1. $(L_x = 1.0, L_y = 1.0, n_x = 1, n_y = 0, N = 5, m = 20)$\n2. $(L_x = 1.0, L_y = 1.0, n_x = 1, n_y = 1, N = 10, m = 20)$\n3. $(L_x = 0.5, L_y = 0.75, n_x = 2, n_y = 1, N = 5, m = 6)$\n4. $(L_x = 1.2, L_y = 0.8, n_x = 0, n_y = 1, N = 3, m = 12)$\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (for example, $[r_1,r_2,r_3,r_4]$), where each $r_j$ is the accumulated phase error in radians for the corresponding test case.", "solution": "The starting point is Maxwell's equations in vacuum for the two-dimensional transverse magnetic polarization about the $z$-axis. These are\n$$\n\\frac{\\partial H_x}{\\partial t} = -\\frac{1}{\\mu_0}\\frac{\\partial E_z}{\\partial y},\\quad \\frac{\\partial H_y}{\\partial t} = \\frac{1}{\\mu_0}\\frac{\\partial E_z}{\\partial x},\\quad \\frac{\\partial E_z}{\\partial t} = \\frac{1}{\\varepsilon_0}\\left(\\frac{\\partial H_y}{\\partial x} - \\frac{\\partial H_x}{\\partial y}\\right).\n$$\nOn a periodic box of lengths $L_x$ and $L_y$, a single spatial Fourier mode with wavenumbers $k_x = 2\\pi n_x/L_x$ and $k_y = 2\\pi n_y/L_y$ converts the partial differential equations into a linear ordinary differential equation in time for the Fourier amplitudes. Using the complex representation, the time derivative acts on the vector of field amplitudes and derivatives map to multiplication by $i k_x$ and $i k_y$. This yields the compact form\n$$\n\\frac{d}{dt}\\begin{bmatrix}H_x \\\\ H_y \\\\ E_z\\end{bmatrix} = \\mathbf{M}\\begin{bmatrix}H_x \\\\ H_y \\\\ E_z\\end{bmatrix},\\quad \\mathbf{M} = \\begin{bmatrix}0  0  -\\frac{i k_y}{\\mu_0} \\\\ 0  0  \\frac{i k_x}{\\mu_0} \\\\ -\\frac{i k_y}{\\varepsilon_0}  \\frac{i k_x}{\\varepsilon_0}  0\\end{bmatrix}.\n$$\nIt is natural to decompose $\\mathbf{M}$ into $\\mathbf{M}_x$ and $\\mathbf{M}_y$ that isolate the $x$ and $y$ directional couplings:\n$$\n\\mathbf{M}_x = \\begin{bmatrix}0  0  0 \\\\ 0  0  \\frac{i k_x}{\\mu_0} \\\\ 0  \\frac{i k_x}{\\varepsilon_0}  0\\end{bmatrix},\\quad \\mathbf{M}_y = \\begin{bmatrix}0  0  -\\frac{i k_y}{\\mu_0} \\\\ 0  0  0 \\\\ -\\frac{i k_y}{\\varepsilon_0}  0  0\\end{bmatrix},\\quad \\mathbf{M} = \\mathbf{M}_x + \\mathbf{M}_y.\n$$\nThe continuous-time exact evolution over one time step $\\Delta t$ is $\\exp(\\Delta t\\,\\mathbf{M})$. The Locally One-Dimensional (LOD) split-operator scheme we consider applies a Strang symmetric splitting\n$$\n\\mathbf{G}_\\text{LOD}(\\Delta t) = \\exp\\!\\left(\\frac{\\Delta t}{2}\\mathbf{M}_x\\right)\\,\\exp\\!\\left(\\Delta t\\,\\mathbf{M}_y\\right)\\,\\exp\\!\\left(\\frac{\\Delta t}{2}\\mathbf{M}_x\\right).\n$$\nThis operator is second-order accurate in time. The Strang product is constructed by alternating half-steps in the $x$-directional operator and a full step in the $y$-directional operator. The deviation of $\\mathbf{G}_\\text{LOD}(\\Delta t)$ from the exact $\\exp(\\Delta t\\,\\mathbf{M})$ is governed by the noncommutativity of $\\mathbf{M}_x$ and $\\mathbf{M}_y$. The Baker–Campbell–Hausdorff expansion yields for Strang splitting that\n$$\n\\mathbf{G}_\\text{LOD}(\\Delta t) = \\exp\\left(\\Delta t\\,\\mathbf{M} + \\frac{\\Delta t^3}{24}\\left([\\,\\mathbf{M}_x,[\\,\\mathbf{M}_x,\\mathbf{M}_y]\\,] + 2[\\,\\mathbf{M}_y,[\\,\\mathbf{M}_x,\\mathbf{M}_y]\\,]\\right) + O(\\Delta t^5)\\right),\n$$\nwhere $[\\,\\cdot,\\cdot\\,]$ denotes the commutator. The presence of the commutator terms indicates that if either $k_x = 0$ or $k_y = 0$, then $\\mathbf{M}_x$ or $\\mathbf{M}_y$ vanishes, the commutators vanish, and the split operator matches the exact operator, eliminating the splitting-induced phase error. When both $k_x \\neq 0$ and $k_y \\neq 0$, the commutators are nonzero and the leading local error scales as $O(\\Delta t^3)$; globally over a fixed total duration (for example, a fixed number of periods $N$ with total time $N T$), the error accumulates as $O(\\Delta t^2)$.\n\nFor a plane wave, the angular frequency is $\\omega = c \\sqrt{k_x^2 + k_y^2}$ with $c = 1/\\sqrt{\\varepsilon_0 \\mu_0}$. A consistent initial condition that lies on the exact physical eigenvector corresponding to the eigenvalue $\\lambda_- = -i \\omega$ is given by choosing $E_z(0)$ arbitrarily (for example, $E_z(0) = 1$) and setting\n$$\nH_x(0) = \\frac{k_y}{\\mu_0 \\omega} E_z(0),\\quad H_y(0) = -\\frac{k_x}{\\mu_0 \\omega} E_z(0),\n$$\nwhich ensures that $\\frac{d}{dt}[H_x,H_y,E_z]^T = -i\\omega[H_x,H_y,E_z]^T$ under the exact operator.\n\nTo compute the accumulated phase error under the LOD splitting after $N$ cycles with $m$ steps per period, we define the time step $\\Delta t = \\frac{2\\pi}{\\omega m}$ and the total number of steps $n = N m$. The exact one-step phase factor for the physical mode is $\\exp(-i\\omega\\Delta t)$. The split operator $\\mathbf{G}_\\text{LOD}(\\Delta t)$ is a $3\\times 3$ complex matrix whose eigenvalues approximate the exact factors. The physically relevant split eigenvalue is the one closest to $\\exp(-i\\omega\\Delta t)$. Its complex argument, denoted $\\theta_\\text{LOD} = \\arg(\\lambda_\\text{LOD})$, approximates $-\\omega\\Delta t$. The numerically accumulated phase over $n$ steps is then $n\\,\\theta_\\text{LOD}$. The exact accumulated phase is $-\\omega \\Delta t\\,n = -2\\pi N$. The accumulated phase error is\n$$\n\\Delta\\phi = n\\,\\theta_\\text{LOD} - (-2\\pi N),\n$$\nexpressed in radians.\n\nThe algorithmic procedure is:\n1. For each test case $(L_x, L_y, n_x, n_y, N, m)$, compute $k_x = 2\\pi n_x/L_x$, $k_y = 2\\pi n_y/L_y$, $\\omega = c \\sqrt{k_x^2 + k_y^2}$, and $\\Delta t = 2\\pi/(\\omega m)$.\n2. Form $\\mathbf{M}_x$ and $\\mathbf{M}_y$ as given above and compute the split operator $\\mathbf{G}_\\text{LOD}(\\Delta t)$ using matrix exponentials.\n3. Compute the eigenvalues of $\\mathbf{G}_\\text{LOD}(\\Delta t)$ and select the one closest in the complex plane to $\\exp(-i\\omega\\Delta t)$.\n4. Compute $\\theta_\\text{LOD} = \\arg(\\lambda_\\text{LOD})$ and then $\\Delta\\phi = (N m)\\,\\theta_\\text{LOD} - (-2\\pi N)$ in radians.\n5. Report $\\Delta\\phi$.\n\nThe relationship to the operator-splitting structure is manifested through the decomposition $\\mathbf{M} = \\mathbf{M}_x + \\mathbf{M}_y$ and the nonzero commutators $[\\,\\mathbf{M}_x,\\mathbf{M}_y\\,]$ when both $k_x$ and $k_y$ are nonzero, which generate the leading phase error. When one wavenumber vanishes, the commutator vanishes and the split operator becomes exact, yielding zero accumulated phase error for all $N$.\n\nThe test suite comprises the following parameter sets:\n1. $(L_x = 1.0\\,\\mathrm{m}, L_y = 1.0\\,\\mathrm{m}, n_x = 1, n_y = 0, N = 5, m = 20)$ to verify the vanishing error when $k_y = 0$.\n2. $(L_x = 1.0\\,\\mathrm{m}, L_y = 1.0\\,\\mathrm{m}, n_x = 1, n_y = 1, N = 10, m = 20)$ as a general case with moderate time resolution.\n3. $(L_x = 0.5\\,\\mathrm{m}, L_y = 0.75\\,\\mathrm{m}, n_x = 2, n_y = 1, N = 5, m = 6)$ to probe larger time steps and stronger splitting error accumulation.\n4. $(L_x = 1.2\\,\\mathrm{m}, L_y = 0.8\\,\\mathrm{m}, n_x = 0, n_y = 1, N = 3, m = 12)$ to verify the vanishing error when $k_x = 0$.\n\nThe required output format is a single line containing the results as a comma-separated list enclosed in square brackets, for example $[r_1,r_2,r_3,r_4]$, where each $r_j$ is the accumulated phase error in radians corresponding to the $j$-th test case.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import expm\n\ndef compute_phase_error(Lx, Ly, nx, ny, N_cycles, m_steps_per_period):\n    # Physical constants (SI units)\n    eps0 = 8.854187817e-12  # F/m\n    mu0 = 4.0 * np.pi * 1e-7  # H/m\n    c = 1.0 / np.sqrt(eps0 * mu0)\n\n    # Wavenumbers for periodic box\n    kx = 2.0 * np.pi * nx / Lx\n    ky = 2.0 * np.pi * ny / Ly\n    k_mag = np.sqrt(kx**2 + ky**2)\n    if k_mag == 0.0:\n        # No wave (DC mode); define zero error\n        return 0.0\n\n    # Angular frequency and time step\n    omega = c * k_mag\n    dt = (2.0 * np.pi) / (omega * m_steps_per_period)\n    n_steps = N_cycles * m_steps_per_period\n\n    # Construct Mx and My matrices (3x3 complex)\n    i = 1j\n    Mx = np.array([[0.0+0.0j, 0.0+0.0j, 0.0+0.0j],\n                   [0.0+0.0j, 0.0+0.0j, (i * kx) / mu0],\n                   [0.0+0.0j, (i * kx) / eps0, 0.0+0.0j]], dtype=np.complex128)\n\n    My = np.array([[0.0+0.0j, 0.0+0.0j, -(i * ky) / mu0],\n                   [0.0+0.0j, 0.0+0.0j, 0.0+0.0j],\n                   [-(i * ky) / eps0, 0.0+0.0j, 0.0+0.0j]], dtype=np.complex128)\n\n    # Strang LOD step operator\n    G = expm(0.5 * dt * Mx) @ expm(dt * My) @ expm(0.5 * dt * Mx)\n\n    # Exact one-step phase factor for the physical mode\n    lambda_exact = np.exp(-1j * omega * dt)\n\n    # Eigenvalues of the split operator\n    eigvals = np.linalg.eigvals(G)\n\n    # Select eigenvalue closest to exact one-step factor\n    idx = np.argmin(np.abs(eigvals - lambda_exact))\n    lambda_lod = eigvals[idx]\n\n    # Accumulated phases\n    theta_lod = np.angle(lambda_lod)          # radians per step (LOD)\n    total_phase_lod = n_steps * theta_lod     # radians after N cycles\n    total_phase_exact = -omega * dt * n_steps # equals -2*pi*N\n\n    # Phase error in radians\n    phase_error = total_phase_lod - total_phase_exact\n    return float(phase_error)\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each case: (Lx [m], Ly [m], nx, ny, N, m)\n    test_cases = [\n        (1.0, 1.0, 1, 0, 5, 20),\n        (1.0, 1.0, 1, 1, 10, 20),\n        (0.5, 0.75, 2, 1, 5, 6),\n        (1.2, 0.8, 0, 1, 3, 12),\n    ]\n\n    results = []\n    for case in test_cases:\n        Lx, Ly, nx, ny, N, m = case\n        result = compute_phase_error(Lx, Ly, nx, ny, N, m)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3325222"}, {"introduction": "After exploring the fundamental dispersion and splitting errors, this final practice investigates their tangible consequences on a propagating signal. The numerical dispersion inherent in the LOD-FDTD scheme, especially when using the large time steps it permits, causes different frequency components of a wave packet to travel at different speeds. This exercise challenges you to quantify these effects on a Gaussian-modulated plane wave. By computing the change in arrival time (group delay) and the broadening of the pulse envelope, you will gain practical insight into the performance limitations of the LOD-FDTD method and the importance of analyzing its dispersion relation [@problem_id:3325272].", "problem": "You are tasked with designing a Gaussian-modulated plane-wave excitation and computing the expected arrival time and amplitude at a probe in a one-dimensional uniform medium, using the Locally One-Dimensional Finite-Difference Time-Domain (LOD-FDTD) discretization. The objective is to highlight how numerical dispersion from the LOD scheme alters the group delay and envelope amplitude for a large time step $\\,\\Delta t\\,$. Work in free space with speed of light $\\,c = 299{,}792{,}458\\,$ m/s. The excitation is a temporally Gaussian envelope $\\,g(t) = \\exp\\big(-\\frac{t^2}{2\\sigma_t^2}\\big)\\,$ modulating a monochromatic carrier of angular frequency $\\,\\omega_0 = 2\\pi f_0\\,$, with peak amplitude $\\,A_0 = 1\\,$.\n\nBase your derivation on:\n- Maxwell’s equations in one dimension for a plane wave in a lossless, isotropic, homogeneous medium, where $\\,\\partial_t E = \\frac{1}{\\varepsilon}\\partial_x H\\,$ and $\\,\\partial_t H = \\frac{1}{\\mu}\\partial_x E\\,$, with $\\,c = \\frac{1}{\\sqrt{\\varepsilon\\mu}}\\,$.\n- A Locally One-Dimensional (LOD) time-centered implicit discretization in one spatial dimension that, under a plane-wave ansatz, yields a numerical dispersion relation of the form\n$$\n\\tan\\left(\\frac{\\omega\\,\\Delta t}{2}\\right) = \\left(\\frac{c\\,\\Delta t}{\\Delta x}\\right)\\,\\sin\\left(\\frac{k\\,\\Delta x}{2}\\right),\n$$\nwhere $\\,\\Delta x\\,$ is the uniform spatial step, $\\,\\Delta t\\,$ is the time step, $\\,\\omega\\,$ is the angular frequency, and $\\,k\\,$ is the wavenumber.\n\nFrom this dispersion relation, compute:\n1. The group delay $\\,t_{\\text{arr}}\\,$ at a probe located at distance $\\,L\\,$ from the source, defined as the derivative of accumulated phase with respect to angular frequency,\n$$\nt_{\\text{arr}} = L\\,\\frac{d k}{d\\omega},\n$$\nwhere $\\,\\frac{d k}{d\\omega}\\,$ is the inverse group velocity induced by the LOD scheme at the carrier frequency $\\,\\omega_0\\,$.\n\n2. The amplitude ratio $\\,R = \\frac{A_{\\text{out}}}{A_0}\\,$ at the probe due to envelope broadening from numerical dispersion. For a narrowband Gaussian envelope, assume the output temporal standard deviation satisfies\n$$\n\\sigma_{\\text{out}}^2 = \\sigma_t^2 + \\frac{\\big(\\beta_2\\,L\\big)^2}{\\sigma_t^2},\n$$\nwhere $\\,\\beta_2 = \\frac{d^2 k}{d\\omega^2}\\,$ is the second derivative of wavenumber with respect to angular frequency, evaluated at $\\,\\omega_0\\,$. The amplitude ratio then follows from energy conservation of the envelope,\n$$\nR = \\frac{\\sigma_t}{\\sigma_{\\text{out}}}.\n$$\n\nUse the LOD dispersion relation to compute $\\,\\frac{d k}{d\\omega}\\,$ and $\\,\\frac{d^2 k}{d\\omega^2}\\,$ in terms of $\\,\\Delta x\\,$, $\\,\\Delta t\\,$, and $\\,\\omega_0\\,$. Introduce the dimensionless variables $\\,\\Omega_0 = \\frac{\\omega_0 \\Delta t}{2}\\,$ and $\\,K_0 = k_0 \\Delta x\\,$ defined implicitly by\n$$\nK_0 = 2\\,\\arcsin\\left(\\frac{1}{S}\\,\\tan(\\Omega_0)\\right), \\quad S = \\frac{c\\,\\Delta t}{\\Delta x},\n$$\nprovided that $\\,\\left|\\frac{1}{S}\\tan(\\Omega_0)\\right| \\leq 1\\,$. Then compute\n$$\n\\frac{d k}{d\\omega} = \\frac{1}{c}\\,\\frac{\\sec^2(\\Omega_0)}{\\cos\\left(\\frac{K_0}{2}\\right)},\n$$\nand\n$$\n\\frac{d^2 k}{d\\omega^2} = \\frac{1}{c}\\,\\frac{\\sec^2(\\Omega_0)\\,\\tan(\\Omega_0)\\,\\Delta t}{\\cos\\left(\\frac{K_0}{2}\\right)} \\;+\\; \\frac{1}{c}\\,\\frac{\\sec^2(\\Omega_0)\\,\\sin\\left(\\frac{K_0}{2}\\right)}{2\\,\\cos^2\\left(\\frac{K_0}{2}\\right)} \\cdot \\left[\\frac{\\Delta x}{c}\\,\\frac{\\sec^2(\\Omega_0)}{\\cos\\left(\\frac{K_0}{2}\\right)}\\right].\n$$\n\nYour program must evaluate $\\,t_{\\text{arr}}\\,$ and $\\,R\\,$ for the following four test cases and produce the final results in a single line as a comma-separated list enclosed in square brackets. The arrival time must be expressed in nanoseconds and the amplitude ratio must be unitless as a decimal. The output must contain the eight floats in the order $[t_1,R_1,t_2,R_2,t_3,R_3,t_4,R_4]$, each rounded to six decimal places.\n\nTest Suite:\n- Case 1 (happy path, moderate $\\,\\Delta t\\,$):\n    - $\\,\\Delta x = 1.0\\times 10^{-2}\\,$ m,\n    - $\\,L = 1.0\\,$ m,\n    - $\\,f_0 = 5.0\\times 10^{9}\\,$ Hz,\n    - $\\,\\sigma_t = 5.0\\times 10^{-10}\\,$ s,\n    - Courant-like number $\\,S = \\frac{c\\,\\Delta t}{\\Delta x} = 0.5\\,$.\n\n- Case 2 (large $\\,\\Delta t\\,$, same carrier):\n    - $\\,\\Delta x = 1.0\\times 10^{-2}\\,$ m,\n    - $\\,L = 1.0\\,$ m,\n    - $\\,f_0 = 5.0\\times 10^{9}\\,$ Hz,\n    - $\\,\\sigma_t = 5.0\\times 10^{-10}\\,$ s,\n    - $\\,S = 2.0\\,$.\n\n- Case 3 (larger $\\,\\Delta t\\,$ with lower carrier to maintain propagating mode):\n    - $\\,\\Delta x = 1.0\\times 10^{-2}\\,$ m,\n    - $\\,L = 1.0\\,$ m,\n    - $\\,f_0 = 3.0\\times 10^{9}\\,$ Hz,\n    - $\\,\\sigma_t = 2.0\\times 10^{-10}\\,$ s,\n    - $\\,S = 3.0\\,$.\n\n- Case 4 (coarser grid and very large $\\,\\Delta t\\,$, low carrier):\n    - $\\,\\Delta x = 2.0\\times 10^{-2}\\,$ m,\n    - $\\,L = 2.0\\,$ m,\n    - $\\,f_0 = 1.5\\times 10^{9}\\,$ Hz,\n    - $\\,\\sigma_t = 3.0\\times 10^{-10}\\,$ s,\n    - $\\,S = 4.0\\,$.\n\nAngle quantities such as $\\,\\Omega_0\\,$ and $\\,K_0\\,$ must be handled in radians. If the argument $\\,\\left|\\frac{1}{S}\\tan(\\Omega_0)\\right|\\,$ exceeds $\\,1\\,$ for any test case, treat that case as non-propagating and return $\\,\\text{NaN}\\,$ for both the arrival time and amplitude ratio.\n\nFinal Output Format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order $[t_1,R_1,t_2,R_2,t_3,R_3,t_4,R_4]$, where each $\\,t_i\\,$ is in nanoseconds and each $\\,R_i\\,$ is a unitless decimal, all rounded to six decimal places.", "solution": "The problem requires the calculation of the group delay and amplitude attenuation for a Gaussian-modulated plane wave propagating in a one-dimensional medium simulated using a a Locally One-Dimensional Finite-Difference Time-Domain (LOD-FDTD) scheme. The analysis is based on the numerical dispersion relation inherent to this method.\n\nThe problem is deemed valid as it is scientifically grounded in the principles of computational electromagnetics and wave propagation, is well-posed with all necessary information and formulas provided, and is expressed in objective, formal language. The provided formulas for the first and second derivatives of the wavenumber with respect to angular frequency have been verified through differentiation of the given dispersion relation and found to be correct. We may therefore proceed with a full solution.\n\nThe fundamental physical principle at play is numerical dispersion. In an ideal vacuum, all frequency components of a plane wave travel at the speed of light, $c$. The relationship between the angular frequency $\\omega$ and the wavenumber $k$ is linear: $k = \\omega/c$. Consequently, the group velocity, $v_g = (dk/d\\omega)^{-1}$, is constant and equal to $c$. This means a pulse shape is preserved as it propagates.\n\nNumerical discretization methods, such as FDTD, approximate the continuous Maxwell's equations on a discrete spatio-temporal grid. This approximation introduces a non-linear relationship between the numerical frequency $\\omega$ and the numerical wavenumber $k$, which is captured by a numerical dispersion relation. For the specified LOD-FDTD scheme, this relation is:\n$$\n\\tan\\left(\\frac{\\omega\\,\\Delta t}{2}\\right) = S\\,\\sin\\left(\\frac{k\\,\\Delta x}{2}\\right)\n$$\nwhere $\\Delta x$ is the spatial step, $\\Delta t$ is the time step, and $S = c\\,\\Delta t/\\Delta x$ is a Courant-like number. A key advantage of the LOD-FDTD method is its unconditional stability, allowing for $S > 1$, which is prohibited in standard explicit FDTD methods. However, using a large time step (large $S$) comes at the cost of significant numerical dispersion, which this problem aims to quantify.\n\nThe effects of numerical dispersion on a pulse are twofold:\n$1$. The pulse envelope travels at the group velocity, $v_g = (dk/d\\omega)^{-1}$, evaluated at the carrier frequency $\\omega_0$. The arrival time $t_{\\text{arr}}$ at a distance $L$ is therefore given by the group delay, $t_{\\text{arr}} = L/v_g = L\\,(dk/d\\omega)|_{\\omega_0}$.\n$2$. Different frequency components of the pulse travel at slightly different speeds, causing the pulse to spread out or \"disperse\" over time. This phenomenon is quantified by the Group Delay Dispersion (GDD) parameter, $\\beta_2 = d^2k/d\\omega^2|_{\\omega_0}$. For an initially Gaussian pulse with temporal standard deviation $\\sigma_t$, the output pulse width $\\sigma_{\\text{out}}$ after propagating a distance $L$ is given by $\\sigma_{\\text{out}}^2 = \\sigma_t^2 + (\\beta_2 L)^2/\\sigma_t^2$. Assuming conservation of the pulse's energy, the peak amplitude must decrease as the pulse broadens. The ratio of output to input amplitude, $R$, is given by $R = \\sigma_t / \\sigma_{\\text{out}}$.\n\nThe calculation procedure for each test case is as follows:\n\n**Step 1: Calculate Derived Parameters**\nGiven the base parameters $\\Delta x$, $L$, $f_0$, $\\sigma_t$, and $S$ for each test case, we first compute the ancillary parameters.\n- Speed of light, $c = 299792458 \\, \\text{m/s}$.\n- Carrier angular frequency, $\\omega_0 = 2\\pi f_0$.\n- Time step, $\\Delta t = S \\cdot \\Delta x / c$.\n\n**Step 2: Check for Propagating Mode**\nThe numerical dispersion relation can be rearranged to solve for the wavenumber $k$.\n$$\nk = \\frac{2}{\\Delta x} \\arcsin\\left(\\frac{1}{S} \\tan\\left(\\frac{\\omega \\Delta t}{2}\\right)\\right)\n$$\nFor a real-valued wavenumber $k$, which corresponds to a propagating wave, the argument of the $\\arcsin$ function must be within the interval $[-1, 1]$. We define the dimensionless frequency $\\Omega_0 = \\omega_0 \\Delta t / 2$ and evaluate the argument at the carrier frequency:\n$$\n\\text{arg} = \\frac{1}{S} \\tan(\\Omega_0)\n$$\nIf $|\\text{arg}| > 1$, the wavenumber becomes complex, representing an evanescent (non-propagating) mode. For such cases, the arrival time and amplitude are undefined, and we report `NaN`.\n\n**Step 3: Compute Numerical Wavenumber and Derivatives**\nIf the mode is propagating, we proceed to calculate the dimensionless wavenumber $K_0 = k_0 \\Delta x$ at the carrier frequency:\n$$\nK_0 = 2 \\arcsin\\left(\\frac{1}{S} \\tan(\\Omega_0)\\right)\n$$\nWith $\\Omega_0$ and $K_0$ determined, we use the provided, pre-derived formulas to compute the first and second derivatives of $k$ with respect to $\\omega$:\n- Inverse group velocity:\n$$\n\\frac{dk}{d\\omega} = \\frac{1}{c}\\,\\frac{\\sec^2(\\Omega_0)}{\\cos(K_0/2)}\n$$\n- GDD parameter, $\\beta_2 = \\frac{d^2k}{d\\omega^2}$:\n$$\n\\beta_2 = \\frac{1}{c}\\,\\frac{\\sec^2(\\Omega_0)\\,\\tan(\\Omega_0)\\,\\Delta t}{\\cos(K_0/2)} + \\frac{1}{c}\\,\\frac{\\sec^2(\\Omega_0)\\,\\sin(K_0/2)}{2\\,\\cos^2(K_0/2)} \\left[\\frac{\\Delta x}{c}\\,\\frac{\\sec^2(\\Omega_0)}{\\cos(K_0/2)}\\right]\n$$\n\n**Step 4: Calculate Final Quantities**\n- The group delay (arrival time) is computed and converted to nanoseconds:\n$$\nt_{\\text{arr}} = L \\cdot \\frac{dk}{d\\omega} \\quad (\\text{in seconds}) \\implies t_{\\text{arr, ns}} = t_{\\text{arr}} \\cdot 10^9\n$$\n- The output temporal standard deviation is calculated:\n$$\n\\sigma_{\\text{out}} = \\sqrt{\\sigma_t^2 + \\frac{(\\beta_2 L)^2}{\\sigma_t^2}}\n$$\n- The amplitude ratio is then found:\n$$\nR = \\frac{\\sigma_t}{\\sigma_{\\text{out}}}\n$$\nThis process is executed for each of the four test cases, and the results are compiled into the specified output format.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the group delay and amplitude ratio for a Gaussian pulse in a 1D\n    LOD-FDTD simulation based on its numerical dispersion relation.\n    \"\"\"\n    # Define physical constant\n    c = 299792458.0  # Speed of light in m/s\n\n    # Test cases from the problem statement\n    # Each tuple: (Δx, L, f₀, σₜ, S)\n    test_cases = [\n        # Case 1: happy path, moderate Δt\n        (1.0e-2, 1.0, 5.0e9, 5.0e-10, 0.5),\n        # Case 2: large Δt, same carrier\n        (1.0e-2, 1.0, 5.0e9, 5.0e-10, 2.0),\n        # Case 3: larger Δt with lower carrier\n        (1.0e-2, 1.0, 3.0e9, 2.0e-10, 3.0),\n        # Case 4: coarser grid and very large Δt\n        (2.0e-2, 2.0, 1.5e9, 3.0e-10, 4.0),\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        dx, L, f0, sigma_t, S = case\n        \n        # Step 1: Calculate derived parameters\n        omega0 = 2.0 * np.pi * f0\n        dt = S * dx / c\n        \n        # Step 2: Check for propagating mode\n        Omega_0 = omega0 * dt / 2.0\n        \n        # Argument for the arcsin function\n        arg_arcsin = np.tan(Omega_0) / S\n        \n        if abs(arg_arcsin) > 1.0:\n            # Non-propagating (evanescent) mode\n            t_ns = np.nan\n            R = np.nan\n            results.extend([t_ns, R])\n            continue\n\n        # Step 3: Compute numerical wavenumber and derivatives\n        # Dimensionless wavenumber\n        K_0 = 2.0 * np.arcsin(arg_arcsin)\n        \n        # Pre-calculate trigonometric terms for efficiency and clarity\n        cos_Omega_0 = np.cos(Omega_0)\n        tan_Omega_0 = np.tan(Omega_0)\n        sec_sq_Omega_0 = 1.0 / (cos_Omega_0**2)\n        cos_K0_half = np.cos(K_0 / 2.0)\n        sin_K0_half = np.sin(K_0 / 2.0)\n\n        # Inverse group velocity (dk/dω)\n        dk_domega = (1.0 / c) * sec_sq_Omega_0 / cos_K0_half\n        \n        # GDD parameter (d²k/dω²)\n        # This parameter is beta_2 in the problem description.\n        beta2_term1 = (1.0 / c) * (sec_sq_Omega_0 * tan_Omega_0 * dt) / cos_K0_half\n        \n        # The expression in square brackets in the problem statement\n        beta2_term2_factor = (dx / c) * sec_sq_Omega_0 / cos_K0_half\n        beta2_term2 = (1.0 / c) * (sec_sq_Omega_0 * sin_K0_half) / (2.0 * cos_K0_half**2) * beta2_term2_factor\n        \n        beta2 = beta2_term1 + beta2_term2\n        \n        # Step 4: Calculate final quantities\n        # Arrival time (group delay) in seconds\n        t_arr = L * dk_domega\n        # Convert to nanoseconds\n        t_ns = t_arr * 1e9\n\n        # Output pulse temporal standard deviation squared\n        sigma_out_sq = sigma_t**2 + ((beta2 * L)**2) / sigma_t**2\n        sigma_out = np.sqrt(sigma_out_sq)\n        \n        # Amplitude ratio\n        R = sigma_t / sigma_out\n        \n        results.extend([t_ns, R])\n\n    # Format the final output as specified\n    formatted_results = [f\"{val:.6f}\" if not np.isnan(val) else \"nan\" for val in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "3325272"}]}