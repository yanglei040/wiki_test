{"hands_on_practices": [{"introduction": "The cornerstone of predicting material stability is determining a compound's thermodynamic viability at zero Kelvin. This is accomplished by constructing the convex hull of formation energies, a geometric representation of the ground-state phase diagram. This exercise [@problem_id:3441315] provides foundational practice in quantifying a material's stability by calculating its energy above the hull, $\\Delta E_{\\mathrm{hull}}$, which is the energetic penalty for its existence relative to the most stable combination of competing phases. You will translate this physical concept into a constrained linear programming problem, a critical skill for high-throughput materials screening and discovery.", "problem": "You are given a target phase with a composition vector and a total energy per atom, and a list of competing phases (excluding the target) each with its own composition vector and total energy per atom. Assume the thermodynamic temperature is effectively zero Kelvin so that Helmholtz free energy reduces to internal energy, and approximate the internal energy by the Density Functional Theory (DFT) total energy per atom. Use the following base principles to formalize the problem: (i) the convex hull of energy versus composition at zero Kelvin is the set of all convex combinations of competing phase energies as a function of composition, (ii) a phase is stable if and only if its energy lies on the lower convex envelope at its composition, and (iii) the energy above hull is the nonnegative difference between the phase energy and the hull energy at the same composition.\n\nFormally, let the target have composition vector $\\mathbf{x}_{t}\\in\\mathbb{R}^{d}$ with nonnegative components that sum to $1$, and energy per atom $E_{t}$ in electronvolts per atom. Let there be $n$ competing phases indexed by $i\\in\\{1,\\dots,n\\}$, each with composition vector $\\mathbf{x}_{i}\\in\\mathbb{R}^{d}$ with nonnegative components summing to $1$, and energy per atom $E_{i}$ in electronvolts per atom. Define the hull energy at composition $\\mathbf{x}_{t}$ as the optimal value of the linear program\n$$\n\\min_{\\mathbf{c}\\in\\mathbb{R}^{n}} \\sum_{i=1}^{n} c_{i} E_{i}\n$$\nsubject to the constraints\n$$\n\\sum_{i=1}^{n} c_{i} \\mathbf{x}_{i} = \\mathbf{x}_{t},\\quad \\sum_{i=1}^{n} c_{i} = 1,\\quad c_{i} \\ge 0\\ \\ \\forall i.\n$$\nDefine the energy above hull as\n$$\n\\Delta E_{\\mathrm{hull}} = \\max\\left(0,\\, E_{t} - \\min_{\\mathbf{c}} \\sum_{i=1}^{n} c_{i} E_{i}\\right).\n$$\nIf $\\Delta E_{\\mathrm{hull}} = 0$, the target is stable on the convex hull and the decomposition reaction is the null decomposition; in that case, report all decomposition coefficients as zeros. If $\\Delta E_{\\mathrm{hull}} > 0$, the optimal decomposition reaction coefficients are the components of the optimizer $\\mathbf{c}^{\\star}$ of the linear program above that attains the minimum.\n\nYour task is to write a program that, for each test case in the suite below, computes $\\Delta E_{\\mathrm{hull}}$ in millielectronvolts per atom and the corresponding optimal decomposition reaction coefficients. All energies $E$ are given in electronvolts per atom. Report $\\Delta E_{\\mathrm{hull}}$ in millielectronvolts per atom (meV/atom) as an integer rounded to the nearest integer. Report the decomposition coefficient vector as a list of floating-point numbers rounded to $6$ decimal places, ordered in the same sequence as the competing phases are provided in the test case. If the target is stable (i.e., $\\Delta E_{\\mathrm{hull}}=0$ within numerical tolerance), report a vector of zeros of length $n$.\n\nUse the following test suite. Each test case specifies a target and a list of competing phases. Each phase lists a composition vector and an energy per atom. All compositions are given as normalized fractions whose components sum to $1$.\n\nTest case $\\mathbf{1}$ (binary system $\\mathrm{A}$–$\\mathrm{B}$, stable target):\n- Target: composition $\\left[0.5,\\,0.5\\right]$, energy $-0.6\\ \\mathrm{eV/atom}$.\n- Competing phases in order: \n  $1$: $\\mathrm{A}$, composition $\\left[1.0,\\,0.0\\right]$, energy $0.0\\ \\mathrm{eV/atom}$;\n  $2$: $\\mathrm{B}$, composition $\\left[0.0,\\,1.0\\right]$, energy $0.0\\ \\mathrm{eV/atom}$.\n\nTest case $\\mathbf{2}$ (binary system $\\mathrm{A}$–$\\mathrm{B}$, unstable target $\\mathrm{A}_{2}\\mathrm{B}$):\n- Target: composition $\\left[\\frac{2}{3},\\,\\frac{1}{3}\\right]$, energy $-0.3\\ \\mathrm{eV/atom}$.\n- Competing phases in order:\n  $1$: $\\mathrm{A}$, composition $\\left[1.0,\\,0.0\\right]$, energy $0.0\\ \\mathrm{eV/atom}$;\n  $2$: $\\mathrm{B}$, composition $\\left[0.0,\\,1.0\\right]$, energy $0.0\\ \\mathrm{eV/atom}$;\n  $3$: $\\mathrm{AB}$, composition $\\left[0.5,\\,0.5\\right]$, energy $-0.6\\ \\mathrm{eV/atom}$.\n\nTest case $\\mathbf{3}$ (ternary system $\\mathrm{A}$–$\\mathrm{B}$–$\\mathrm{C}$, stable ternary target):\n- Target: composition $\\left[\\frac{1}{3},\\,\\frac{1}{3},\\,\\frac{1}{3}\\right]$, energy $-0.65\\ \\mathrm{eV/atom}$.\n- Competing phases in order:\n  $1$: $\\mathrm{A}$, composition $\\left[1.0,\\,0.0,\\,0.0\\right]$, energy $0.0\\ \\mathrm{eV/atom}$;\n  $2$: $\\mathrm{B}$, composition $\\left[0.0,\\,1.0,\\,0.0\\right]$, energy $0.0\\ \\mathrm{eV/atom}$;\n  $3$: $\\mathrm{C}$, composition $\\left[0.0,\\,0.0,\\,1.0\\right]$, energy $0.0\\ \\mathrm{eV/atom}$;\n  $4$: $\\mathrm{AB}$, composition $\\left[0.5,\\,0.5,\\,0.0\\right]$, energy $-0.6\\ \\mathrm{eV/atom}$;\n  $5$: $\\mathrm{AC}$, composition $\\left[0.5,\\,0.0,\\,0.5\\right]$, energy $-0.5\\ \\mathrm{eV/atom}$;\n  $6$: $\\mathrm{BC}$, composition $\\left[0.0,\\,0.5,\\,0.5\\right]$, energy $-0.55\\ \\mathrm{eV/atom}$.\n\nTest case $\\mathbf{4}$ (binary system $\\mathrm{A}$–$\\mathrm{B}$, unstable target at an endmember composition):\n- Target: composition $\\left[1.0,\\,0.0\\right]$, energy $0.05\\ \\mathrm{eV/atom}$.\n- Competing phases in order:\n  $1$: $\\mathrm{A}$, composition $\\left[1.0,\\,0.0\\right]$, energy $0.0\\ \\mathrm{eV/atom}$;\n  $2$: $\\mathrm{B}$, composition $\\left[0.0,\\,1.0\\right]$, energy $0.0\\ \\mathrm{eV/atom}$.\n\nYour program must:\n- For each test case, set up and solve the linear program to obtain the minimum mixture energy at the target composition and the associated coefficients.\n- Compute $\\Delta E_{\\mathrm{hull}}$ in millielectronvolts per atom as an integer (round to the nearest integer).\n- For stable targets, report a decomposition coefficient vector of zeros; for unstable targets, report the optimal coefficients, each rounded to $6$ decimal places, ordered as specified.\n\nFinal output format: Your program should produce a single line of output containing a list of results, one per test case, with no extra spaces. Each result must be a two-element list of the form $\\left[\\Delta E_{\\mathrm{hull}}^{\\mathrm{meV/atom}},\\,[c_{1},c_{2},\\dots,c_{n}]\\right]$, where $\\Delta E_{\\mathrm{hull}}^{\\mathrm{meV/atom}}$ is an integer and the $c_{i}$ are floating-point numbers rounded to $6$ decimal places. For example, a line with two results would look like $\\left[[100,[0.333333,0.666667]],\\,[0,[0.000000,0.000000]]\\right]$.\n\nAssume numerical feasibility for each case, and use a nonnegativity tolerance of $10^{-9}$ and an equality constraint tolerance of $10^{-8}$ in deciding stability and rounding of coefficients.", "solution": "The problem is scientifically valid, well-posed, and formalizes a cornerstone concept in computational materials science: the prediction of thermodynamic phase stability. The task is to compute the energy above the convex hull, $\\Delta E_{\\mathrm{hull}}$, for a target phase relative to a set of competing phases. This quantity determines whether the target phase is stable or will decompose into a mixture of the competing phases at a temperature of $0\\ \\mathrm{K}$. The problem is reducible to solving a linear program (LP).\n\nThe state of a system at constant volume and a temperature of $0\\ \\mathrm{K}$ is described by its internal energy, $U$. A phase is thermodynamically stable if and only if it has the lowest possible energy for its given composition. We can visualize this by plotting energy versus composition. The set of all stable phases and their mixtures forms a \"lower convex envelope\" or \"convex hull\". Any phase whose energy-composition point lies on this hull is stable; any phase lying above it is unstable or metastable and has a driving force to decompose into the stable phases on the hull directly below it.\n\nThe problem defines the hull energy at a specific target composition $\\mathbf{x}_{t}$ as the minimum energy of any mixture of the $n$ competing phases that has the composition $\\mathbf{x}_{t}$. This is a classic constrained optimization problem. Let the coefficients of the mixture be $c_{1}, c_{2}, \\dots, c_{n}$, representing the molar fraction of each competing phase $i$ in the mixture. The mixture must satisfy three conditions:\n$1$. The overall composition of the mixture must equal the target composition: $\\sum_{i=1}^{n} c_{i} \\mathbf{x}_{i} = \\mathbf{x}_{t}$.\n$2$. The coefficients must sum to one, as they are fractions: $\\sum_{i=1}^{n} c_{i} = 1$.\n$3$. The coefficients must be non-negative, as we cannot have a negative amount of a phase: $c_{i} \\ge 0$ for all $i$.\n\nThe total energy of such a mixture is a weighted average of the energies of the competing phases: $E_{\\mathrm{mixture}} = \\sum_{i=1}^{n} c_{i} E_{i}$. Our goal is to find the set of coefficients $\\mathbf{c} = (c_1, \\dots, c_n)$ that satisfies the constraints while minimizing this energy. This is precisely the definition of the linear program provided:\n$$\nE_{\\mathrm{hull}}(\\mathbf{x}_t) = \\min_{\\mathbf{c}} \\sum_{i=1}^{n} c_{i} E_{i}\n$$\nsubject to:\n$$\n\\sum_{i=1}^{n} c_{i} \\mathbf{x}_{i} = \\mathbf{x}_{t}\n$$\n$$\n\\sum_{i=1}^{n} c_{i} = 1\n$$\n$$\nc_{i} \\ge 0\\ \\ \\forall i=1,\\dots,n\n$$\nAs detailed in the problem validation, because all composition vectors $\\mathbf{x}_{i}$ and $\\mathbf{x}_{t}$ are normalized (their components sum to $1$), the constraint $\\sum_{i=1}^{n} c_{i} = 1$ is mathematically redundant, as it is implied by the compositional constraint $\\sum_{i=1}^{n} c_{i} \\mathbf{x}_{i} = \\mathbf{x}_{t}$. However, when implementing a numerical solution, it is standard practice to work with a reduced set of composition variables to avoid linear dependencies. For a $d$-component system, we use the first $d-1$ components of each composition vector. In this reduced space, the constraint $\\sum_{i=1}^{n} c_{i} = 1$ is no longer redundant and must be explicitly included. This leads to a numerically stable and well-conditioned LP.\n\nThe LP is thus formulated as follows for a $d$-component system with $n$ competing phases:\nLet $\\mathbf{c}$ be the $n$-element vector of unknown coefficients.\nThe objective function to minimize is $\\mathbf{E}^T \\mathbf{c}$, where $\\mathbf{E}$ is the vector of energies $E_i$ of the competing phases.\nThe equality constraints are written as $A_{eq} \\mathbf{c} = \\mathbf{b}_{eq}$. We construct the $d \\times n$ matrix $A_{eq}$ and $d$-element vector $\\mathbf{b}_{eq}$ as:\n- The first $d-1$ rows of $A_{eq}$ are populated with the first $d-1$ components of the composition vectors $\\mathbf{x}_i$ of the competing phases.\n- The last row of $A_eq$ is composed of all ones.\n- The first $d-1$ elements of $\\mathbf{b}_{eq}$ are the first $d-1$ components of the target composition vector $\\mathbf{x}_t$.\n- The last element of $\\mathbf{b}_{eq}$ is $1$.\nThe non-negativity constraint is $c_i \\ge 0$, which defines the bounds for each variable.\n\nWe utilize the `scipy.optimize.linprog` function to solve this LP. The function returns the optimal value of the objective function, which is the hull energy $E_{\\mathrm{hull}}(\\mathbf{x}_t)$, and the optimal coefficient vector $\\mathbf{c}^{\\star}$ that achieves this minimum.\n\nThe energy above the hull is then calculated as $\\Delta E = E_{t} - E_{\\mathrm{hull}}(\\mathbf{x}_t)$. According to the problem's definition, we must report $\\Delta E_{\\mathrm{hull}} = \\max(0, \\Delta E)$. A numerical tolerance of $10^{-8}$ is used to assess stability: if $\\Delta E \\le 10^{-8}$, the phase is considered stable.\n- If stable, $\\Delta E_{\\mathrm{hull}}$ is reported as $0\\ \\mathrm{meV/atom}$, and the decomposition coefficients are reported as a vector of zeros, signifying a null decomposition.\n- If unstable ($\\Delta E > 10^{-8}$), $\\Delta E_{\\mathrm{hull}}$ is reported in meV/atom, rounded to the nearest integer. The decomposition coefficients are given by the optimizer $\\mathbf{c}^{\\star}$ from the LP, with each component rounded to $6$ decimal places. Small negative values in $\\mathbf{c}^{\\star}$ arising from floating-point inaccuracies are clipped to zero before rounding.\n\nThis systematic procedure is applied to each test case to generate the final results.", "answer": "```python\nimport numpy as np\nfrom scipy.optimize import linprog\n\ndef solve():\n    \"\"\"\n    Main function to solve the phase stability problem for all test cases.\n    \"\"\"\n    # Tolerances specified in the problem\n    STABILITY_TOLERANCE = 1e-8\n\n    test_cases = [\n        # Test case 1 (binary system A–B, stable target)\n        {\n            \"target\": (np.array([0.5, 0.5]), -0.6),\n            \"competitors\": [\n                (np.array([1.0, 0.0]), 0.0),\n                (np.array([0.0, 1.0]), 0.0),\n            ]\n        },\n        # Test case 2 (binary system A–B, unstable target A2B)\n        {\n            \"target\": (np.array([2/3, 1/3]), -0.3),\n            \"competitors\": [\n                (np.array([1.0, 0.0]), 0.0),\n                (np.array([0.0, 1.0]), 0.0),\n                (np.array([0.5, 0.5]), -0.6),\n            ]\n        },\n        # Test case 3 (ternary system A–B–C, stable ternary target)\n        {\n            \"target\": (np.array([1/3, 1/3, 1/3]), -0.65),\n            \"competitors\": [\n                (np.array([1.0, 0.0, 0.0]), 0.0),\n                (np.array([0.0, 1.0, 0.0]), 0.0),\n                (np.array([0.0, 0.0, 1.0]), 0.0),\n                (np.array([0.5, 0.5, 0.0]), -0.6),\n                (np.array([0.5, 0.0, 0.5]), -0.5),\n                (np.array([0.0, 0.5, 0.5]), -0.55),\n            ]\n        },\n        # Test case 4 (binary system A–B, unstable target at an endmember composition)\n        {\n            \"target\": (np.array([1.0, 0.0]), 0.05),\n            \"competitors\": [\n                (np.array([1.0, 0.0]), 0.0),\n                (np.array([0.0, 1.0]), 0.0),\n            ]\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        target_comp, target_energy = case[\"target\"]\n        competitor_comps = [c[0] for c in case[\"competitors\"]]\n        competitor_energies = [c[1] for c in case[\"competitors\"]]\n\n        # --- Set up the linear program ---\n        # Number of competing phases\n        n_competitors = len(competitor_energies)\n        # Number of components in the chemical system\n        d_components = len(target_comp)\n\n        # Objective function vector (energies of competing phases)\n        c_obj = np.array(competitor_energies)\n\n        # Equality constraint matrix A_eq\n        # For a d-component system, we use d-1 composition constraints\n        # and 1 constraint for the sum of coefficients.\n        A_eq = np.zeros((d_components, n_competitors))\n        if d_components > 1:\n            A_eq[:-1, :] = np.array(competitor_comps)[:, :-1].T\n        A_eq[-1, :] = 1.0\n\n        # Equality constraint vector b_eq\n        b_eq = np.zeros(d_components)\n        if d_components > 1:\n            b_eq[:-1] = target_comp[:-1]\n        b_eq[-1] = 1.0\n\n        # Bounds for coefficients c_i >= 0\n        bounds = [(0, None) for _ in range(n_competitors)]\n        \n        # --- Solve the linear program ---\n        # The 'highs' method is robust and is the default in recent SciPy.\n        lp_result = linprog(c=c_obj, A_eq=A_eq, b_eq=b_eq, bounds=bounds, method='highs')\n\n        if not lp_result.success:\n            # Problem statement guarantees feasibility. If this happens, it's an unexpected issue.\n            raise RuntimeError(\"Linear program solver failed for a test case.\")\n\n        hull_energy = lp_result.fun\n        optimal_coeffs = lp_result.x\n        \n        # --- Calculate energy above hull and determine stability ---\n        delta_E = target_energy - hull_energy\n\n        if delta_E = STABILITY_TOLERANCE:\n            # Phase is stable or on the hull\n            dE_mev = 0\n            # Per problem spec, report zero coefficients for stable phases\n            decomp_coeffs = [0.0] * n_competitors\n        else:\n            # Phase is unstable\n            # Convert to meV/atom and round to nearest integer\n            dE_mev = int(round(delta_E * 1000))\n            # Use the optimizer from the LP as decomposition coefficients.\n            # Clip small negative values due to float precision before rounding.\n            decomp_coeffs = np.round(np.maximum(0, optimal_coeffs), 6).tolist()\n            \n        results.append([dE_mev, decomp_coeffs])\n\n    # --- Format and print the final output string ---\n    # The output format must be a single line with no spaces.\n    formatted_results = []\n    for res in results:\n        dE_val, coeffs_list = res\n        coeffs_str = f\"[{','.join([f'{c:.6f}' for c in coeffs_list])}]\"\n        formatted_results.append(f\"[{dE_val},{coeffs_str}]\")\n    \n    final_output_string = f\"[{','.join(formatted_results)}]\"\n    print(final_output_string)\n\nsolve()\n```", "id": "3441315"}, {"introduction": "Identifying a material as metastable is often just the beginning of the analysis; the crucial next step is to predict how it will decompose. This practice [@problem_id:3441322] builds directly on the concept of the convex hull by challenging you to determine the specific decomposition pathway for a metastable ternary compound. By solving a linear program, you will find the combination of stable product phases that minimizes the reaction energy and then convert these results into a stoichiometrically balanced chemical equation with minimal integer coefficients. This exercise bridges the gap between the abstract geometry of the hull and the concrete language of chemical reactions, a vital skill for communicating computational predictions.", "problem": "You are given a fixed set of candidate product phases in a three-component chemical system comprised of elements labeled $A$, $B$, and $C$. Each phase is specified by its composition vector, its formula-unit size, and its formation energy per atom. A single metastable ternary reactant is to be decomposed into a non-negative linear combination of these candidate products. Your task is to compute the stoichiometrically balanced reaction coefficients that minimize the reaction energy per atom, and then report the minimized reaction energy per atom together with the minimal integer reaction coefficients.\n\nThe fundamental base for this problem is as follows. In a three-component system, a phase with composition vector $\\mathbf{y} = (y_A,y_B,y_C)$ per atom lies on the Gibbs composition simplex defined by $y_A \\ge 0$, $y_B \\ge 0$, $y_C \\ge 0$, and $y_A + y_B + y_C = 1$. For a given metastable reactant with composition $\\mathbf{c}_R$ and formation energy per atom $E_R$, and a set of product phases indexed by $i$ with compositions $\\mathbf{y}_i$ and formation energies per atom $E_i$, the decomposition that minimizes the reaction energy per atom is obtained by solving the convex optimization problem\n$$\n\\min_{\\{w_i\\}_{i=1}^M} \\sum_{i=1}^M w_i E_i \\quad \\text{subject to} \\quad \\sum_{i=1}^M w_i \\mathbf{y}_i = \\mathbf{c}_R,\\; w_i \\ge 0,\n$$\nwhere $M$ is the number of candidate products and the equality is componentwise for $A$, $B$, and $C$. The reaction energy per atom is then\n$$\n\\Delta E = \\left(\\sum_{i=1}^M w_i E_i\\right) - E_R,\n$$\nwhich is minimized by the solution above. The non-negativity of the weights $w_i$ ensures that the products lie on the convex hull that maps the lowest energy combination of phases at the reactant composition.\n\nTo convert the continuous solution to stoichiometrically balanced integer reaction coefficients, let the reactant have a formula-unit size $s_R$ equal to the total number of atoms in its simplest integer formula representation, and let product $i$ have formula-unit size $s_i$ equal to the total number of atoms in its simplest integer formula. If $\\{w_i\\}$ is the optimal solution, then any positive integer $m$ produces a balanced reaction\n$$\n\\alpha \\cdot R \\to \\sum_{i=1}^M \\beta_i \\cdot P_i,\n$$\nwith $\\alpha = m$ and\n$$\n\\beta_i = m \\cdot \\frac{s_R}{s_i} \\, w_i.\n$$\nThe primitive integer reaction coefficients are obtained by choosing the smallest positive integer $m$ that makes all $\\beta_i$ integers, and then dividing all coefficients $(\\alpha,\\beta_1,\\dots,\\beta_M)$ by their greatest common divisor. This produces stoichiometrically balanced integer coefficients.\n\nAll energies are in electronvolts per atom (eV/atom). All composition vectors must be interpreted as atomic fractions. You must express the final reaction energy per atom in eV/atom, rounded to six decimal places.\n\nThe candidate product phases are fixed across all test cases and listed below. Each phase is specified by $(\\text{name}, \\mathbf{y}, s, E)$:\n- $A$: $(A, (1,0,0), 1, 0.0)$\n- $B$: $(B, (0,1,0), 1, 0.0)$\n- $C$: $(C, (0,0,1), 1, 0.0)$\n- $AB$: $(AB, (0.5,0.5,0), 2, -0.60)$\n- $AC$: $(AC, (0.5,0,0.5), 2, -0.50)$\n- $BC$: $(BC, (0,0.5,0.5), 2, -0.55)$\n\nYour program must solve the linear program for each test case, convert to the minimal integer reaction coefficients including the reactant coefficient, and output the results in the specified format. For each test case, you must output a list with two entries: the minimized reaction energy per atom $\\Delta E$ in eV/atom rounded to six decimal places, and the list of minimal integer reaction coefficients in the fixed order $[\\alpha, \\beta_{AB}, \\beta_{AC}, \\beta_{BC}, \\beta_{A}, \\beta_{B}, \\beta_{C}]$, where $\\alpha$ is the reactant coefficient and the remaining entries are the product coefficients.\n\nTest suite:\n- Case $1$: Reactant $A_2B_1C_1$ with $s_R = 4$, composition $\\mathbf{c}_R = (0.5,0.25,0.25)$, and $E_R = -0.40$.\n- Case $2$: Reactant $A_1B_1C_2$ with $s_R = 4$, composition $\\mathbf{c}_R = (0.25,0.25,0.5)$, and $E_R = -0.47$.\n- Case $3$: Reactant $A_3B_1C_1$ with $s_R = 5$, composition $\\mathbf{c}_R = (0.6,0.2,0.2)$, and $E_R = -0.40$.\n- Case $4$: Reactant $A_4B_3C_3$ with $s_R = 10$, composition $\\mathbf{c}_R = (0.4,0.3,0.3)$, and $E_R = -0.52$.\n\nFinal output format:\n- Your program should produce a single line of output containing the results for all four cases as a comma-separated list enclosed in square brackets. Each case result must itself be a list of the form $[\\Delta E, [\\alpha, \\beta_{AB}, \\beta_{AC}, \\beta_{BC}, \\beta_{A}, \\beta_{B}, \\beta_{C}]]$. For example, the overall output should look like $[[\\Delta E_1,[\\alpha_1,\\dots]],[\\Delta E_2,[\\alpha_2,\\dots]],[\\Delta E_3,[\\alpha_3,\\dots]],[\\Delta E_4,[\\alpha_4,\\dots]]]$, with $\\Delta E_i$ rounded to six decimal places and all coefficients integers.", "solution": "The problem requires finding the thermodynamically most favorable decomposition reaction for a given metastable reactant. This is achieved by identifying the mixture of stable product phases that has the same overall composition as the reactant but the lowest possible formation energy. This is a classic application of convex hull principles and can be solved efficiently using linear programming (LP).\n\nThe core of the method is to solve the following optimization problem for the weights $\\{w_i\\}$ of the candidate product phases:\n$$\n\\min_{\\{w_i\\}} \\sum_{i=1}^M w_i E_i \\quad \\text{subject to} \\quad \\sum_{i=1}^M w_i \\mathbf{y}_i = \\mathbf{c}_R,\\; w_i \\ge 0\n$$\nHere, $E_i$ and $\\mathbf{y}_i$ are the formation energy per atom and composition vector of product phase $i$, while $\\mathbf{c}_R$ is the composition vector of the reactant. The first constraint enforces conservation of elements (mass balance), and the second ensures that products are only formed, not consumed. This LP problem is solved using `scipy.optimize.linprog`. The set of candidate products includes the pure elements, which guarantees that a feasible solution always exists.\n\nThe minimum energy of the product mixture is the optimal value returned by the LP solver, $E_{products} = \\min \\sum w_i E_i$. The reaction energy per atom is then calculated as the difference between the product and reactant energies:\n$$\n\\Delta E = E_{products} - E_R\n$$\nA negative $\\Delta E$ indicates an energetically favorable decomposition.\n\nThe final step is to convert the optimal continuous weights $\\{w_i^*\\}$ into minimal integer stoichiometric coefficients for a balanced chemical reaction: $\\alpha \\cdot R \\to \\sum_{i} \\beta_i \\cdot P_i$. This is done by first calculating unscaled rational coefficients for the products, $q_i = w_i^* \\cdot (s_R / s_i)$, where $s_R$ and $s_i$ are the number of atoms in the formula units of the reactant and products, respectively. A common multiplier, determined by the least common multiple (LCM) of the denominators of the rational coefficients, is used to convert all coefficients to integers. Finally, all integer coefficients (for both reactant and products) are divided by their greatest common divisor (GCD) to obtain the minimal set.", "answer": "```python\nimport numpy as np\nfrom scipy.optimize import linprog\nfrom fractions import Fraction\nimport math\n\ndef solve():\n    \"\"\"\n    Solves for the minimum reaction energy and stoichiometric coefficients for\n    the decomposition of metastable ternary compounds.\n    \"\"\"\n\n    # Define the fixed set of candidate product phases\n    # Order: [AB, AC, BC, A, B, C]\n    products = {\n        'names': ['AB', 'AC', 'BC', 'A', 'B', 'C'],\n        'energies': np.array([-0.60, -0.50, -0.55, 0.0, 0.0, 0.0]),  # E_i in eV/atom\n        'sizes': np.array([2, 2, 2, 1, 1, 1]),  # s_i\n        'compositions': np.array([ # y_i\n            [0.5, 0.5, 0.0],  # AB\n            [0.5, 0.0, 0.5],  # AC\n            [0.0, 0.5, 0.5],  # BC\n            [1.0, 0.0, 0.0],  # A\n            [0.0, 1.0, 0.0],  # B\n            [0.0, 0.0, 1.0],  # C\n        ])\n    }\n    \n    # A_eq matrix for the linear program (conservation of elements A, B, C)\n    A_eq = products['compositions'].T\n\n    # Define the test cases for the reactants\n    test_cases = [\n        # (s_R, c_R, E_R)\n        (4, np.array([0.5, 0.25, 0.25]), -0.40),    # Case 1: A2B1C1\n        (4, np.array([0.25, 0.25, 0.5]), -0.47),     # Case 2: A1B1C2\n        (5, np.array([0.6, 0.2, 0.2]), -0.40),       # Case 3: A3B1C1\n        (10, np.array([0.4, 0.3, 0.3]), -0.52),      # Case 4: A4B3C3\n    ]\n\n    results = []\n    \n    # Tolerance for treating a float as zero\n    TOL = 1e-9\n\n    for s_R, c_R, E_R in test_cases:\n        # Solve the linear program to find the optimal weights w_i\n        # min c*x s.t. A_eq*x = b_eq, x >= 0\n        res = linprog(c=products['energies'], A_eq=A_eq, b_eq=c_R, bounds=(0, None), method='highs')\n\n        if not res.success:\n            # This should not happen for this well-posed problem\n            raise RuntimeError(\"Linear programming failed to find a solution.\")\n\n        # The optimal weights for the products\n        w = res.x\n        \n        # The minimized formation energy of the product mixture\n        E_products = res.fun\n        \n        # The minimized reaction energy per atom\n        delta_E = E_products - E_R\n\n        # --- Convert continuous weights to minimal integer stoichiometric coefficients ---\n        \n        q_fractions = []\n        denominators = [1]\n        \n        for i in range(len(w)):\n            if w[i] > TOL:\n                # Convert float weight to a rational number\n                w_frac = Fraction.from_float(w[i]).limit_denominator()\n                \n                # Calculate the unscaled rational coefficient q_i\n                q_i = (Fraction(s_R) / Fraction(products['sizes'][i])) * w_frac\n                q_fractions.append(q_i)\n                denominators.append(q_i.denominator)\n            else:\n                q_fractions.append(Fraction(0))\n\n        # The multiplier m is the LCM of the denominators\n        m = math.lcm(*denominators)\n        \n        # The reactant coefficient\n        alpha = m\n        \n        # The product coefficients\n        betas = np.array([int(m * q) for q in q_fractions])\n\n        # Find the greatest common divisor (GCD) of all non-zero coefficients\n        all_coeffs = [alpha] + list(b for b in betas if b > 0)\n        common_divisor = math.gcd(*all_coeffs)\n        \n        # Reduce coefficients to their minimal integer form\n        final_alpha = alpha // common_divisor\n        final_betas = (betas // common_divisor).tolist()\n\n        # Assemble the final result for this case\n        case_result = [\n            round(delta_E, 6),\n            [final_alpha] + final_betas\n        ]\n        results.append(case_result)\n\n    # Format the final output string exactly as specified\n    # The default str() for lists uses spaces, which is fine, but we can be explicit\n    # by replacing ', ' with ',' if needed. For this problem, it's not critical.\n    # The template format will produce \"[-0.15, [1, 1, 1, 0, 0, 0, 0]]\" etc.\n    # which is the standard representation and perfectly readable.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```", "id": "3441322"}, {"introduction": "While zero-Kelvin calculations provide a baseline for stability, real-world material processing and behavior occur at finite temperatures, where entropy plays a decisive role. This advanced exercise [@problem_id:3441339] introduces temperature into the stability analysis using the Gibbs free energy, $G(T) = H_0 - T S k_B$. You will investigate the dynamic \"breathing\" of the convex hull as temperature changes, driven by the differing entropies of competing phases. By computationally measuring the rate of change of the hull's volume with temperature, $\\frac{\\partial V}{\\partial T}$, you will develop a powerful, intuitive understanding of how entropy governs phase equilibria at elevated temperatures.", "problem": "You are given a ternary alloy system with discrete candidate phases indexed by an integer label. Each phase is characterized by a composition point in the ternary composition simplex and its thermodynamic descriptors at zero temperature. For a phase with composition $(x_A,x_B)$, the stoichiometric constraint is $x_A \\ge 0$, $x_B \\ge 0$, $x_A + x_B \\le 1$, and $x_C = 1 - x_A - x_B$. The Gibbs free energy per atom at absolute temperature $T$ is modeled as $G(T) = H_0 - T S k_B$, where $H_0$ is the formation enthalpy per atom at $T=0\\,\\mathrm{K}$, $S$ is the configurational entropy per atom expressed in units of the Boltzmann constant per atom, and $k_B$ is the Boltzmann constant. This model is a standard linear-in-temperature approximation in computational materials science for assessing phase stability and is consistent with the definition of Gibbs free energy. Consider the three-dimensional point cloud formed by $(x_A,x_B,G(T))$ over all phases at a fixed temperature $T$. Define the convex hull volume $V(T)$ as the usual Euclidean volume of the convex hull of this point set in $\\mathbb{R}^3$.\n\nYour task is to compute the rate of convex hull “breathing” with respect to temperature, namely the derivative $\\partial V/\\partial T$, and to relate its sign to entropy differences between phases that are the vertices of the convex hull and the entire set of phases.\n\nUse the following data. The Boltzmann constant is $k_B = 8.617333262145 \\times 10^{-5}\\,\\mathrm{eV/K}$. Each phase $i$ is specified by $(x_A,x_B,H_0,S)$ with $H_0$ in $\\mathrm{eV/atom}$ and $S$ in units of $k_B/\\mathrm{atom}$:\n- Phase $1$: $(x_A,x_B,H_0,S) = (0.95,0.03,-0.20,0.50)$\n- Phase $2$: $(x_A,x_B,H_0,S) = (0.03,0.95,-0.19,0.55)$\n- Phase $3$: $(x_A,x_B,H_0,S) = (0.02,0.02,-0.18,0.30)$\n- Phase $4$: $(x_A,x_B,H_0,S) = (0.60,0.35,-0.32,0.80)$\n- Phase $5$: $(x_A,x_B,H_0,S) = (0.60,0.05,-0.28,0.60)$\n- Phase $6$: $(x_A,x_B,H_0,S) = (0.05,0.60,-0.27,0.65)$\n- Phase $7$: $(x_A,x_B,H_0,S) = (0.33,0.33,-0.35,0.90)$\n- Phase $8$: $(x_A,x_B,H_0,S) = (0.20,0.50,-0.31,0.75)$\n- Phase $9$: $(x_A,x_B,H_0,S) = (0.50,0.20,-0.30,0.70)$\n- Phase $10$: $(x_A,x_B,H_0,S) = (0.20,0.20,-0.29,0.50)$\n\nFollow these precise steps for each given temperature $T$:\n- Form the three-dimensional point set $\\{(x_A^{(i)},x_B^{(i)},G^{(i)}(T))\\}_{i=1}^{10}$ with $G^{(i)}(T) = H_0^{(i)} - T\\,S^{(i)}\\,k_B$.\n- Compute the convex hull volume $V(T)$ of this point set in $\\mathbb{R}^3$.\n- Approximate the temperature derivative using a central finite difference with a small temperature step $\\Delta T$: $\\partial V/\\partial T \\approx \\left[V(T+\\Delta T)-V(T-\\Delta T)\\right]/(2\\,\\Delta T)$.\n\nTo connect the breathing rate to entropy differences, define the set of convex hull vertices $\\mathcal{V}(T)$ at temperature $T$ as the subset of phases whose points are vertices of the convex hull at $T$. Let $\\bar{S}_{\\mathrm{vert}}(T)$ be the arithmetic mean of $S^{(i)}$ over $i \\in \\mathcal{V}(T)$, and let $\\bar{S}_{\\mathrm{all}}$ be the arithmetic mean over all phases $i \\in \\{1,\\dots,10\\}$. Define the entropy difference $\\Delta S(T) = \\bar{S}_{\\mathrm{vert}}(T) - \\bar{S}_{\\mathrm{all}}$. Determine whether the sign of $\\partial V/\\partial T$ matches the sign of $\\Delta S(T)$ at each temperature, with the following tie-breaking convention: treat a quantity as zero if its absolute value is less than a tolerance $\\varepsilon$, and assign it a zero sign. Use $\\varepsilon_V = 10^{-9}$ for $\\partial V/\\partial T$ (in $\\mathrm{eV/(atom\\cdot K)}$) and $\\varepsilon_S = 10^{-12}$ for $\\Delta S(T)$ (dimensionless, in units of $k_B/\\mathrm{atom}$). The sign agreement is true if both signs are positive, both are negative, or both are zero; otherwise false.\n\nUse the following test suite:\n- Temperatures: $T \\in \\{300, 800, 1200\\}\\,\\mathrm{K}$.\n- Central difference step: $\\Delta T = 1\\,\\mathrm{K}$.\n\nYour program should compute, for each $T$ in the test suite, the finite-difference approximation of $\\partial V/\\partial T$ in $\\mathrm{eV/(atom\\cdot K)}$, rounded to six decimal places, and the boolean sign agreement with $\\Delta S(T)$ as defined above. The final output format must be a single line containing a comma-separated Python-style list with entries in the following order: $[\\partial V/\\partial T \\text{ at } 300\\,\\mathrm{K}, \\text{agreement at } 300\\,\\mathrm{K}, \\partial V/\\partial T \\text{ at } 800\\,\\mathrm{K}, \\text{agreement at } 800\\,\\mathrm{K}, \\partial V/\\partial T \\text{ at } 1200\\,\\mathrm{K}, \\text{agreement at } 1200\\,\\mathrm{K}]$. Each derivative must be in $\\mathrm{eV/(atom\\cdot K)}$ and rounded to six decimal places, and each agreement must be a boolean literal, with no additional text.", "solution": "We base the solution on the definition of Gibbs free energy and on geometric properties of convex hulls. The Gibbs free energy per atom for a phase with enthalpy $H_0$ and entropy $S$ at absolute temperature $T$ is $G(T) = H_0 - T S k_B$, where $k_B$ is the Boltzmann constant. This is a fundamental thermodynamic relation connecting free energy to enthalpy and entropy. Because $G(T)$ depends affinely on $T$ for each phase, the point cloud in $\\mathbb{R}^3$ defined by $(x_A,x_B,G(T))$ is a set of points whose third coordinate moves linearly with $T$, each with its own slope determined by $-S k_B$.\n\nThe convex hull volume $V(T)$ is the Euclidean volume enclosed by the convex hull of these points in $\\mathbb{R}^3$. As $T$ changes, this convex polytope deforms because the third coordinate of each point moves linearly in $T$ at a rate set by $S$. Since the combinatorial structure (which points are vertices) can change only at isolated temperatures where facets flip, and since between such changes the volume is a smooth function of $T$, the derivative $\\partial V/\\partial T$ is well-defined almost everywhere. Numerically, we approximate it by a central finite difference $[V(T+\\Delta T) - V(T-\\Delta T)]/(2\\,\\Delta T)$ with a small temperature increment $\\Delta T$.\n\nTo relate the breathing rate to entropy differences, consider which points control $V(T)$. The convex hull volume is determined by its facets, which are convex combinations of the hull’s vertices. In our setting, the hull’s vertices at temperature $T$ are those phases whose points become extreme points in $(x_A,x_B,G(T))$ space. Those vertices’ free energy coordinates shift with $T$ at rates proportional to their entropies $S$. If, on average, the vertices have higher $S$ than the system-wide average, increasing $T$ tends to increase the spread in $G$ among vertices and, consequently, tends to increase the convex hull volume. Conversely, if vertices have lower $S$ on average, the hull tends to compress along the energy axis. This motivates comparing the sign of $\\partial V/\\partial T$ with the sign of $\\Delta S(T) = \\bar{S}_{\\mathrm{vert}}(T) - \\bar{S}_{\\mathrm{all}}$, where $\\bar{S}_{\\mathrm{vert}}(T)$ is the average $S$ over hull vertices at temperature $T$ and $\\bar{S}_{\\mathrm{all}}$ is the average over all phases. We assess “agreement” if these signs match under tolerances.\n\nAlgorithmically:\n- For each temperature $T$ in the test suite, compute $G^{(i)}(T) = H_0^{(i)} - T S^{(i)} k_B$ for each phase $i$ to obtain the point cloud $(x_A^{(i)}, x_B^{(i)}, G^{(i)}(T))$.\n- Compute the convex hull in $\\mathbb{R}^3$ for this point set and record its volume $V(T)$. Use $\\Delta T = 1\\,\\mathrm{K}$ and compute $V(T+\\Delta T)$ and $V(T-\\Delta T)$ similarly to estimate $\\partial V/\\partial T$ as a central difference.\n- Extract the vertex indices of the convex hull at temperature $T$ and compute $\\bar{S}_{\\mathrm{vert}}(T)$ as the arithmetic mean of $S^{(i)}$ over those indices. Compute $\\bar{S}_{\\mathrm{all}}$ once over all phases. Form $\\Delta S(T) = \\bar{S}_{\\mathrm{vert}}(T) - \\bar{S}_{\\mathrm{all}}$.\n- Determine the sign of $\\partial V/\\partial T$ with tolerance $\\varepsilon_V = 10^{-9}$ in $\\mathrm{eV/(atom\\cdot K)}$: values with absolute magnitude less than $\\varepsilon_V$ are treated as zero. Determine the sign of $\\Delta S(T)$ with tolerance $\\varepsilon_S = 10^{-12}$. The sign agreement boolean is true if both signs are positive, both negative, or both zero.\n- For each temperature, report the finite-difference estimate of $\\partial V/\\partial T$ in $\\mathrm{eV/(atom\\cdot K)}$ rounded to six decimal places, followed by the boolean agreement. Aggregate all results into a single list ordered by temperature as specified.\n\nThis procedure leverages the linear-in-temperature free energy model and convex hull construction from computational materials science to quantify the “breathing” of the hull and connects its rate to the relative entropies of phases that define the hull at each temperature. The use of a central finite difference ensures a second-order accurate local approximation provided $\\Delta T$ is small, and the tolerances control numerical noise and potential topological changes in the hull near the evaluation temperatures.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.spatial import ConvexHull\n\nKB_eV_per_K = 8.617333262145e-5  # eV/K\n\ndef phase_data():\n    # Returns arrays for compositions, enthalpies, entropies\n    # Each row: (xA, xB, H0 [eV/atom], S [k_B/atom])\n    data = np.array([\n        [0.95, 0.03, -0.20, 0.50],\n        [0.03, 0.95, -0.19, 0.55],\n        [0.02, 0.02, -0.18, 0.30],\n        [0.60, 0.35, -0.32, 0.80],\n        [0.60, 0.05, -0.28, 0.60],\n        [0.05, 0.60, -0.27, 0.65],\n        [0.33, 0.33, -0.35, 0.90],\n        [0.20, 0.50, -0.31, 0.75],\n        [0.50, 0.20, -0.30, 0.70],\n        [0.20, 0.20, -0.29, 0.50],\n    ], dtype=float)\n    xA = data[:, 0]\n    xB = data[:, 1]\n    H0 = data[:, 2]\n    S_kB = data[:, 3]\n    return xA, xB, H0, S_kB\n\ndef compute_points(T, xA, xB, H0, S_kB):\n    # G(T) = H0 - T * S * k_B\n    G = H0 - T * (S_kB * KB_eV_per_K)\n    pts = np.column_stack([xA, xB, G])\n    return pts\n\ndef hull_volume(points):\n    # Compute convex hull volume in 3D\n    # If points are co-linear/planar in a degenerate way (unlikely here), handle gracefully\n    hull = ConvexHull(points, qhull_options='QJ')  # joggled input to avoid degeneracy\n    return hull.volume, hull\n\ndef finite_difference_dVdT(T, dT, xA, xB, H0, S_kB):\n    pts_plus = compute_points(T + dT, xA, xB, H0, S_kB)\n    V_plus, _ = hull_volume(pts_plus)\n    pts_minus = compute_points(T - dT, xA, xB, H0, S_kB)\n    V_minus, _ = hull_volume(pts_minus)\n    dVdT = (V_plus - V_minus) / (2.0 * dT)\n    return dVdT\n\ndef sign_with_tol(val, tol):\n    if abs(val)  tol:\n        return 0\n    return 1 if val > 0 else -1\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_temperatures = [300.0, 800.0, 1200.0]  # K\n    dT = 1.0  # K\n    eps_V = 1e-9\n    eps_S = 1e-12\n\n    xA, xB, H0, S_kB = phase_data()\n    S_all_avg = float(np.mean(S_kB))\n\n    results = []\n    for T in test_temperatures:\n        # Compute derivative dV/dT via central difference\n        dVdT = finite_difference_dVdT(T, dT, xA, xB, H0, S_kB)\n\n        # Compute current hull and its vertex set\n        pts = compute_points(T, xA, xB, H0, S_kB)\n        V_T, hull = hull_volume(pts)\n        vertex_indices = np.unique(hull.vertices)\n        S_vert_avg = float(np.mean(S_kB[vertex_indices]))\n        delta_S = S_vert_avg - S_all_avg  # in k_B/atom\n\n        # Determine sign agreement\n        sgn_dV = sign_with_tol(dVdT, eps_V)\n        sgn_dS = sign_with_tol(delta_S, eps_S)\n        agreement = (sgn_dV == sgn_dS)\n\n        # Round derivative to six decimal places\n        dVdT_rounded = float(f\"{dVdT:.6f}\")\n        results.append(dVdT_rounded)\n        results.append(agreement)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "3441339"}]}