{"hands_on_practices": [{"introduction": "To master the Climbing-Image Nudged Elastic Band (CI-NEB) method, we first begin with its foundation: the standard NEB algorithm. This initial practice [@problem_id:3437572] strips the problem down to a simple one-dimensional potential, allowing you to manually compute the forces that govern the motion of the images. By calculating the spring and potential force components, you will gain direct insight into how the \"nudging\" process works and uncover a key limitation that necessitates the \"climbing-image\" enhancement.", "problem": "Consider a one-dimensional configuration coordinate $x$ for a transition between two symmetry-related minima of the double-well potential $V(x) = x^{4} - x^{2}$. The minima occur at $x = -1/\\sqrt{2}$ and $x = +1/\\sqrt{2}$. A discretized path is defined by $N = 5$ images, indexed $i = 0, 1, 2, 3, 4$, with fixed endpoints $x_{0} = -1/\\sqrt{2}$ and $x_{4} = +1/\\sqrt{2}$. The initial positions of the intermediate images are $x_{1}^{(0)} = -0.35$, $x_{2}^{(0)} = 0.02$, and $x_{3}^{(0)} = 0.40$. For this path, perform one iteration of the Nudged Elastic Band (NEB) method as follows.\n\nUse the core NEB definitions:\n- The tangent $\\hat{\\tau}_{i}$ at image $i$ is taken along the path and, in one dimension for a monotonically increasing path, can be treated as $\\hat{\\tau}_{i} = +1$ for $i = 1, 2, 3$.\n- The potential (true) force at image $i$ is $F_{i}^{V} = -\\nabla V(x_{i}) = -\\frac{dV}{dx}\\big|_{x_{i}}$.\n- The perpendicular component of the potential force is $F_{i}^{\\perp} = F_{i}^{V} - \\left(F_{i}^{V} \\cdot \\hat{\\tau}_{i}\\right)\\hat{\\tau}_{i}$.\n- The parallel component of the spring force is $F_{i}^{\\text{spr},\\parallel} = k\\left(\\left|x_{i+1} - x_{i}\\right| - \\left|x_{i} - x_{i-1}\\right|\\right)\\hat{\\tau}_{i}$, with spring constant $k = 1$.\n\nAdopt a simple steepest-descent update $x_{i}^{(1)} = x_{i}^{(0)} + \\eta\\left(F_{i}^{\\perp} + F_{i}^{\\text{spr},\\parallel}\\right)$ with step size $\\eta = 0.2$, for $i = 1, 2, 3$. Keep the endpoints fixed, $x_{0}^{(1)} = x_{0}^{(0)}$ and $x_{4}^{(1)} = x_{4}^{(0)}$. Although the topic is Climbing-Image Nudged Elastic Band (CI-NEB), do not apply the climbing-image modification in this iteration; use the standard NEB forces as defined above.\n\nCompute $F_{i}^{\\perp}$ and $F_{i}^{\\text{spr},\\parallel}$ for $i = 1, 2, 3$, and then compute the updated positions $x_{i}^{(1)}$ for $i = 0, 1, 2, 3, 4$. Round your final updated positions to eight significant figures. Express the final answer as a single row matrix containing the five updated positions in the order $\\left(x_{0}^{(1)}, x_{1}^{(1)}, x_{2}^{(1)}, x_{3}^{(1)}, x_{4}^{(1)}\\right)$.", "solution": "The problem asks for the computation of a single iteration of the Nudged Elastic Band (NEB) method for a given one-dimensional potential and initial path discretization.\n\nThe potential is given by $V(x) = x^{4} - x^{2}$. The path is discretized into $N = 5$ images, indexed $i = 0, 1, 2, 3, 4$. The endpoints are fixed at the potential minima, $x_{0} = -1/\\sqrt{2}$ and $x_{4} = +1/\\sqrt{2}$. The initial positions of the three intermediate images are $x_{1}^{(0)} = -0.35$, $x_{2}^{(0)} = 0.02$, and $x_{3}^{(0)} = 0.40$. The update rule for the positions is a steepest-descent step: $x_{i}^{(1)} = x_{i}^{(0)} + \\eta\\mathbf{F}_{i}^{\\text{tot}}$, where the total force is $\\mathbf{F}_{i}^{\\text{tot}} = F_{i}^{\\perp} + F_{i}^{\\text{spr},\\parallel}$ and the step size is $\\eta = 0.2$. We will perform this update for the movable images $i = 1, 2, 3$.\n\nFirst, we define the forces acting on each image. The potential (or \"true\") force is given by the negative gradient of the potential:\n$$F_{i}^{V} = -\\frac{dV}{dx}\\bigg|_{x_{i}} = -\\left(4x_{i}^{3} - 2x_{i}\\right) = 2x_{i} - 4x_{i}^{3}$$\nThe problem defines two components of the force used in the NEB update: the perpendicular component of the potential force, $F_{i}^{\\perp}$, and the parallel component of the spring force, $F_{i}^{\\text{spr},\\parallel}$.\n\nLet's analyze the perpendicular force component, $F_{i}^{\\perp} = F_{i}^{V} - \\left(F_{i}^{V} \\cdot \\hat{\\tau}_{i}\\right)\\hat{\\tau}_{i}$. In a one-dimensional system, all vectors (positions, forces, tangents) are collinear. The tangent vector $\\hat{\\tau}_{i}$ points along the path. Since the initial path coordinates are monotonically increasing ($x_{0}^{(0)} < x_{1}^{(0)} < x_{2}^{(0)} < x_{3}^{(0)} < x_{4}^{(0)}$), the tangent vector for each image can be represented by the scalar $\\hat{\\tau}_{i} = +1$. The potential force $F_{i}^{V}$ is also a scalar in this one-dimensional context. The dot product $\\left(F_{i}^{V} \\cdot \\hat{\\tau}_{i}\\right)$ becomes simple scalar multiplication: $F_{i}^{V} \\times 1 = F_{i}^{V}$.\nTherefore, the perpendicular component of the potential force is:\n$$F_{i}^{\\perp} = F_{i}^{V} - (F_{i}^{V})(1) = 0$$\nThis is a known consequence of the standard NEB formulation in one dimension: the potential force is entirely projected out, and the images move only under the influence of the spring force component, which acts to equalize the spacing between images. Although the problem is under the topic of CI-NEB, we are instructed not to use the climbing image modification, which is a mechanism to overcome this specific behavior at the saddle point.\n\nThe second force component is the parallel component of the spring force:\n$$F_{i}^{\\text{spr},\\parallel} = k\\left(\\left|x_{i+1} - x_{i}\\right| - \\left|x_{i} - x_{i-1}\\right|\\right)\\hat{\\tau}_{i}$$\nWith the spring constant $k = 1$ and tangent $\\hat{\\tau}_{i} = 1$, this simplifies to:\n$$F_{i}^{\\text{spr},\\parallel} = \\left|x_{i+1} - x_{i}\\right| - \\left|x_{i} - x_{i-1}\\right|$$\n\nNow we can calculate the forces and updated positions for each movable image. The initial path is:\n$x_{0}^{(0)} = -1/\\sqrt{2} \\approx -0.70710678$\n$x_{1}^{(0)} = -0.35$\n$x_{2}^{(0)} = 0.02$\n$x_{3}^{(0)} = 0.40$\n$x_{4}^{(0)} = +1/\\sqrt{2} \\approx 0.70710678$\n\nFor image $i=1$:\nThe neighbors are $x_{0}^{(0)} = -1/\\sqrt{2}$ and $x_{2}^{(0)} = 0.02$.\nThe perpendicular force is $F_{1}^{\\perp} = 0$.\nThe spring force is:\n$$F_{1}^{\\text{spr},\\parallel} = \\left|x_{2}^{(0)} - x_{1}^{(0)}\\right| - \\left|x_{1}^{(0)} - x_{0}^{(0)}\\right|$$\n$$F_{1}^{\\text{spr},\\parallel} = |0.02 - (-0.35)| - |-0.35 - (-1/\\sqrt{2})|$$\n$$F_{1}^{\\text{spr},\\parallel} = |0.37| - |-0.35 + 0.70710678| = 0.37 - 0.35710678 = 0.01289322$$\nThe total force for the update is $F_{1}^{\\text{tot}} = F_{1}^{\\perp} + F_{1}^{\\text{spr},\\parallel} = 0.01289322$.\nThe updated position is:\n$$x_{1}^{(1)} = x_{1}^{(0)} + \\eta F_{1}^{\\text{tot}} = -0.35 + 0.2 \\times (0.01289322) = -0.35 + 0.002578644 = -0.347421356$$\n\nFor image $i=2$:\nThe neighbors are $x_{1}^{(0)} = -0.35$ and $x_{3}^{(0)} = 0.40$.\nThe perpendicular force is $F_{2}^{\\perp} = 0$.\nThe spring force is:\n$$F_{2}^{\\text{spr},\\parallel} = \\left|x_{3}^{(0)} - x_{2}^{(0)}\\right| - \\left|x_{2}^{(0)} - x_{1}^{(0)}\\right|$$\n$$F_{2}^{\\text{spr},\\parallel} = |0.40 - 0.02| - |0.02 - (-0.35)| = |0.38| - |0.37| = 0.01$$\nThe total force for the update is $F_{2}^{\\text{tot}} = F_{2}^{\\perp} + F_{2}^{\\text{spr},\\parallel} = 0.01$.\nThe updated position is:\n$$x_{2}^{(1)} = x_{2}^{(0)} + \\eta F_{2}^{\\text{tot}} = 0.02 + 0.2 \\times (0.01) = 0.02 + 0.002 = 0.022$$\n\nFor image $i=3$:\nThe neighbors are $x_{2}^{(0)} = 0.02$ and $x_{4}^{(0)} = 1/\\sqrt{2}$.\nThe perpendicular force is $F_{3}^{\\perp} = 0$.\nThe spring force is:\n$$F_{3}^{\\text{spr},\\parallel} = \\left|x_{4}^{(0)} - x_{3}^{(0)}\\right| - \\left|x_{3}^{(0)} - x_{2}^{(0)}\\right|$$\n$$F_{3}^{\\text{spr},\\parallel} = |(1/\\sqrt{2}) - 0.40| - |0.40 - 0.02|$$\n$$F_{3}^{\\text{spr},\\parallel} = |0.70710678 - 0.40| - |0.38| = 0.30710678 - 0.38 = -0.07289322$$\nThe total force for the update is $F_{3}^{\\text{tot}} = F_{3}^{\\perp} + F_{3}^{\\text{spr},\\parallel} = -0.07289322$.\nThe updated position is:\n$$x_{3}^{(1)} = x_{3}^{(0)} + \\eta F_{3}^{\\text{tot}} = 0.40 + 0.2 \\times (-0.07289322) = 0.40 - 0.014578644 = 0.385421356$$\n\nThe endpoints remain fixed:\n$x_{0}^{(1)} = x_{0}^{(0)} = -1/\\sqrt{2} \\approx -0.70710678$\n$x_{4}^{(1)} = x_{4}^{(0)} = 1/\\sqrt{2} \\approx 0.70710678$\n\nThe problem requires rounding the final updated positions to eight significant figures.\n$x_{0}^{(1)} \\approx -0.70710678$\n$x_{1}^{(1)} = -0.347421356 \\approx -0.34742136$\n$x_{2}^{(1)} = 0.022 \\approx 0.022000000$\n$x_{3}^{(1)} = 0.385421356 \\approx 0.38542136$\n$x_{4}^{(1)} \\approx 0.70710678$\n\nThe final updated path after one iteration is given by the set of coordinates $(x_{0}^{(1)}, x_{1}^{(1)}, x_{2}^{(1)}, x_{3}^{(1)}, x_{4}^{(1)})$.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n-0.70710678 & -0.34742136 & 0.022000000 & 0.38542136 & 0.70710678\n\\end{pmatrix}\n}\n$$", "id": "3437572"}, {"introduction": "Having seen the limitations of the standard NEB, we now introduce the \"climbing\" modification that defines the CI-NEB method. This practice [@problem_id:3437606] focuses on the highest-energy image, which is designated to \"climb\" the potential energy surface. You will calculate the special force applied to this image, where the component along the path is inverted, actively pushing it toward the exact saddle point instead of letting it slide down.", "problem": "Consider a two-dimensional potential energy surface used as a simplified model for a diffusion barrier, defined by the scalar field $V(x,y) = (x^{2} - 1)^{2} + y^{2}$ in electronvolts (eV). Two minima are located at $(-1,0)$ and $(1,0)$, separated by a first-order saddle at $(0,0)$. A discrete path between the minima is represented by five images $\\{\\mathbf{r}_{0},\\mathbf{r}_{1},\\mathbf{r}_{2},\\mathbf{r}_{3},\\mathbf{r}_{4}\\}$, with fixed endpoints $\\mathbf{r}_{0} = (-1,0)$ and $\\mathbf{r}_{4} = (1,0)$, and current interior positions\n$\\mathbf{r}_{1} = (-0.4, 0.2)$, $\\mathbf{r}_{2} = (0.0, 0.1)$, and $\\mathbf{r}_{3} = (0.3, -0.1)$.\nYou will execute one iteration of the climbing-image variant of the Nudged Elastic Band method (Climbing-Image Nudged Elastic Band (CI-NEB)) on the highest-energy image, starting from first principles and core definitions.\n\nAssume the following modeling assumptions:\n- The path tangent at an interior image $i$ is the unit vector obtained by normalizing the chord joining its two neighbors, $\\hat{\\boldsymbol{\\tau}}_{i} = \\dfrac{\\mathbf{r}_{i+1} - \\mathbf{r}_{i-1}}{\\lVert \\mathbf{r}_{i+1} - \\mathbf{r}_{i-1}\\rVert}$.\n- The true force due to the potential is $-\\nabla V$.\n- Vector components parallel and perpendicular to a unit direction $\\hat{\\boldsymbol{\\tau}}$ are defined by orthogonal projection: for any vector $\\mathbf{A}$, $\\mathbf{A}^{\\parallel} = (\\mathbf{A}\\cdot \\hat{\\boldsymbol{\\tau}})\\hat{\\boldsymbol{\\tau}}$ and $\\mathbf{A}^{\\perp} = \\mathbf{A} - \\mathbf{A}^{\\parallel}$.\n\nTreat the interior image with the highest potential energy as the climbing image. For that image, construct the parallel and perpendicular components of the true force and apply the climbing-image modification consistent with the definition of the method. Then perform a single explicit Euler positional update of the climbing image using the step parameter $h = 0.5$:\n$\\mathbf{r}_{i}^{\\text{new}} = \\mathbf{r}_{i}^{\\text{old}} + h\\,\\mathbf{F}_{i}^{\\text{CI}}$,\nwhere $\\mathbf{F}_{i}^{\\text{CI}}$ is the total climbing-image force you construct from the above principles.\n\nStarting from the given positions, carry out the following for the highest-energy image $i$:\n1. Identify the climbing image index $i$ by evaluating $V(\\mathbf{r}_{i})$ at the interior images.\n2. Compute the tangent $\\hat{\\boldsymbol{\\tau}}_{i}$ from its neighbors.\n3. Evaluate the gradient $\\nabla V$ at $\\mathbf{r}_{i}$, then decompose the true force $-\\nabla V$ into $\\mathbf{F}_{i}^{\\parallel}$ and $\\mathbf{F}_{i}^{\\perp}$ using the projection definitions above.\n4. Construct the climbing-image force $\\mathbf{F}_{i}^{\\text{CI}}$ for that image according to the climbing-image modification.\n5. Update the climbing image position with the given Euler step.\n6. Evaluate the updated energy $V(\\mathbf{r}_{i}^{\\text{new}})$.\n\nReport as your final answer the updated energy of the climbing image, $V(\\mathbf{r}_{i}^{\\text{new}})$, in eV. Round your answer to four significant figures. Express the final energy in eV.", "solution": "The problem is subjected to validation before a solution is attempted.\n\n### Step 1: Extract Givens\n-   Potential energy surface: $V(x,y) = (x^{2} - 1)^{2} + y^{2}$ in units of electronvolts (eV).\n-   Discrete path images: $\\{\\mathbf{r}_{0},\\mathbf{r}_{1},\\mathbf{r}_{2},\\mathbf{r}_{3},\\mathbf{r}_{4}\\}$.\n-   Fixed endpoints: $\\mathbf{r}_{0} = (-1,0)$, $\\mathbf{r}_{4} = (1,0)$.\n-   Interior image positions: $\\mathbf{r}_{1} = (-0.4, 0.2)$, $\\mathbf{r}_{2} = (0.0, 0.1)$, $\\mathbf{r}_{3} = (0.3, -0.1)$.\n-   Path tangent definition: $\\hat{\\boldsymbol{\\tau}}_{i} = \\dfrac{\\mathbf{r}_{i+1} - \\mathbf{r}_{i-1}}{\\lVert \\mathbf{r}_{i+1} - \\mathbf{r}_{i-1}\\rVert}$.\n-   True force definition: $-\\nabla V$.\n-   Force component definitions: $\\mathbf{A}^{\\parallel} = (\\mathbf{A}\\cdot \\hat{\\boldsymbol{\\tau}})\\hat{\\boldsymbol{\\tau}}$ and $\\mathbf{A}^{\\perp} = \\mathbf{A} - \\mathbf{A}^{\\parallel}$.\n-   Climbing image identification: The interior image with the highest potential energy.\n-   Position update rule: $\\mathbf{r}_{i}^{\\text{new}} = \\mathbf{r}_{i}^{\\text{old}} + h\\,\\mathbf{F}_{i}^{\\text{CI}}$.\n-   Step parameter: $h = 0.5$.\n-   Objective: Calculate the updated energy $V(\\mathbf{r}_{i}^{\\text{new}})$ for the climbing image, rounded to four significant figures.\n\n### Step 2: Validate Using Extracted Givens\n-   **Scientifically Grounded**: The problem describes the Climbing-Image Nudged Elastic Band (CI-NEB) method, a standard and widely used algorithm in computational chemistry and materials science for finding transition states. The potential $V(x,y)$ is a classic double-well potential, a common model system for such problems. The definitions of the tangent, forces, and the update rule are consistent with the established formulation of the CI-NEB method. The problem is scientifically sound.\n-   **Well-Posed**: All necessary information is provided: the potential function, the initial coordinates of all images, the definitions for all computed quantities (tangent, forces), and the parameters for the update step ($h$). The objective is stated clearly and is achievable with the given data. The problem is self-contained and unambiguous.\n-   **Objective**: The problem is formulated in precise mathematical language and is free of subjective or opinion-based statements.\n\n### Step 3: Verdict and Action\nThe problem is deemed **valid**. A solution will be provided by following the prescribed steps.\n\nThe solution proceeds by following the six steps outlined in the problem statement.\n\n**1. Identify the climbing image**\nThe potential energy $V(\\mathbf{r}_i)$ is calculated for each interior image $\\mathbf{r}_i = (x_i, y_i)$.\nThe potential energy function is $V(x,y) = (x^{2} - 1)^{2} + y^{2}$.\n\nFor image $\\mathbf{r}_{1} = (-0.4, 0.2)$:\n$$V(\\mathbf{r}_{1}) = ((-0.4)^{2} - 1)^{2} + (0.2)^{2} = (0.16 - 1)^{2} + 0.04 = (-0.84)^{2} + 0.04 = 0.7056 + 0.04 = 0.7456 \\, \\text{eV}$$\n\nFor image $\\mathbf{r}_{2} = (0.0, 0.1)$:\n$$V(\\mathbf{r}_{2}) = ((0.0)^{2} - 1)^{2} + (0.1)^{2} = (-1)^{2} + 0.01 = 1 + 0.01 = 1.01 \\, \\text{eV}$$\n\nFor image $\\mathbf{r}_{3} = (0.3, -0.1)$:\n$$V(\\mathbf{r}_{3}) = ((0.3)^{2} - 1)^{2} + (-0.1)^{2} = (0.09 - 1)^{2} + 0.01 = (-0.91)^{2} + 0.01 = 0.8281 + 0.01 = 0.8381 \\, \\text{eV}$$\n\nComparing the energies, $V(\\mathbf{r}_2) > V(\\mathbf{r}_3) > V(\\mathbf{r}_1)$. The image with the highest potential energy is $\\mathbf{r}_{2}$. Thus, the climbing image is image $i=2$.\n\n**2. Compute the tangent $\\hat{\\boldsymbol{\\tau}}_{2}$**\nThe tangent at $\\mathbf{r}_2$ is determined by its neighbors, $\\mathbf{r}_1$ and $\\mathbf{r}_3$.\n$$\\mathbf{r}_{3} - \\mathbf{r}_{1} = (0.3 - (-0.4), -0.1 - 0.2) = (0.7, -0.3)$$\nThe norm of this vector is:\n$$\\lVert \\mathbf{r}_{3} - \\mathbf{r}_{1} \\rVert = \\sqrt{(0.7)^{2} + (-0.3)^{2}} = \\sqrt{0.49 + 0.09} = \\sqrt{0.58}$$\nThe unit tangent vector is:\n$$\\hat{\\boldsymbol{\\tau}}_{2} = \\frac{\\mathbf{r}_{3} - \\mathbf{r}_{1}}{\\lVert \\mathbf{r}_{3} - \\mathbf{r}_{1} \\rVert} = \\frac{1}{\\sqrt{0.58}}(0.7, -0.3)$$\n\n**3. Evaluate the gradient and decompose the true force**\nThe gradient of the potential $V(x,y) = (x^2-1)^2+y^2 = x^4-2x^2+1+y^2$ is:\n$$\\nabla V = \\left( \\frac{\\partial V}{\\partial x}, \\frac{\\partial V}{\\partial y} \\right) = (4x^{3} - 4x, 2y)$$\nAt the position of the climbing image $\\mathbf{r}_{2} = (0.0, 0.1)$:\n$$\\nabla V |_{\\mathbf{r}_2} = (4(0.0)^{3} - 4(0.0), 2(0.1)) = (0, 0.2)$$\nThe true force is $\\mathbf{F}_{\\text{true}} = -\\nabla V |_{\\mathbf{r}_2}$:\n$$\\mathbf{F}_{\\text{true}} = (0, -0.2)$$\nThis force is decomposed into components parallel ($\\mathbf{F}_{2}^{\\parallel}$) and perpendicular ($\\mathbf{F}_{2}^{\\perp}$) to the tangent $\\hat{\\boldsymbol{\\tau}}_{2}$. We only need the parallel component for the next step.\n$$\\mathbf{F}_{2}^{\\parallel} = (\\mathbf{F}_{\\text{true}} \\cdot \\hat{\\boldsymbol{\\tau}}_{2}) \\hat{\\boldsymbol{\\tau}}_{2}$$\nFirst, compute the dot product:\n$$\\mathbf{F}_{\\text{true}} \\cdot \\hat{\\boldsymbol{\\tau}}_{2} = (0, -0.2) \\cdot \\frac{1}{\\sqrt{0.58}}(0.7, -0.3) = \\frac{1}{\\sqrt{0.58}} [0 \\cdot (0.7) + (-0.2) \\cdot (-0.3)] = \\frac{0.06}{\\sqrt{0.58}}$$\nNow, construct the parallel force vector:\n$$\\mathbf{F}_{2}^{\\parallel} = \\left(\\frac{0.06}{\\sqrt{0.58}}\\right) \\left(\\frac{1}{\\sqrt{0.58}}(0.7, -0.3)\\right) = \\frac{0.06}{0.58}(0.7, -0.3) = \\frac{6}{58}(0.7, -0.3) = \\frac{3}{29}(0.7, -0.3)$$\n$$\\mathbf{F}_{2}^{\\parallel} = \\left(\\frac{2.1}{29}, -\\frac{0.9}{29}\\right)$$\n\n**4. Construct the climbing-image force $\\mathbf{F}_{2}^{\\text{CI}}$**\nFor the climbing image, the force is modified to remove the spring force component along the tangent and invert the true force component along the tangent, driving the image up the potential energy surface towards the saddle point. The force is given by $\\mathbf{F}_{i}^{\\text{CI}} = \\mathbf{F}_{\\text{true}} - 2 \\mathbf{F}_{i}^{\\parallel}$.\n$$\\mathbf{F}_{2}^{\\text{CI}} = (0, -0.2) - 2 \\left(\\frac{2.1}{29}, -\\frac{0.9}{29}\\right) = (0, -0.2) - \\left(\\frac{4.2}{29}, -\\frac{1.8}{29}\\right)$$\n$$\\mathbf{F}_{2}^{\\text{CI}} = \\left(-\\frac{4.2}{29}, -0.2 + \\frac{1.8}{29}\\right) = \\left(-\\frac{4.2}{29}, -\\frac{5.8}{29} + \\frac{1.8}{29}\\right) = \\left(-\\frac{4.2}{29}, -\\frac{4.0}{29}\\right)$$\n\n**5. Update the climbing image position**\nThe position is updated using an explicit Euler step with $h=0.5$.\n$$\\mathbf{r}_{2}^{\\text{new}} = \\mathbf{r}_{2}^{\\text{old}} + h\\,\\mathbf{F}_{2}^{\\text{CI}}$$\n$$\\mathbf{r}_{2}^{\\text{new}} = (0.0, 0.1) + 0.5 \\left(-\\frac{4.2}{29}, -\\frac{4.0}{29}\\right) = (0, 0.1) + \\left(-\\frac{2.1}{29}, -\\frac{2.0}{29}\\right)$$\nThe new coordinates are:\n$$x_{2}^{\\text{new}} = -\\frac{2.1}{29}$$\n$$y_{2}^{\\text{new}} = 0.1 - \\frac{2.0}{29} = \\frac{1}{10} - \\frac{2}{29} = \\frac{29 - 20}{290} = \\frac{9}{290}$$\nSo, the new position is $\\mathbf{r}_{2}^{\\text{new}} = \\left(-\\frac{2.1}{29}, \\frac{9}{290}\\right)$.\n\n**6. Evaluate the updated energy $V(\\mathbf{r}_{2}^{\\text{new}})$**\nThe energy at the new position is calculated:\n$$V(\\mathbf{r}_{2}^{\\text{new}}) = \\left( \\left(x_{2}^{\\text{new}}\\right)^{2} - 1 \\right)^{2} + \\left(y_{2}^{\\text{new}}\\right)^{2}$$\n$$V(\\mathbf{r}_{2}^{\\text{new}}) = \\left( \\left(-\\frac{2.1}{29}\\right)^{2} - 1 \\right)^{2} + \\left(\\frac{9}{290}\\right)^{2}$$\nNumerically evaluating the terms:\n$$x_{2}^{\\text{new}} = -\\frac{2.1}{29} \\approx -0.07241379$$\n$$y_{2}^{\\text{new}} = \\frac{9}{290} \\approx 0.03103448$$\n$$V(\\mathbf{r}_{2}^{\\text{new}}) \\approx ((-0.07241379)^{2} - 1)^{2} + (0.03103448)^{2}$$\n$$V(\\mathbf{r}_{2}^{\\text{new}}) \\approx (0.00524376 - 1)^{2} + 0.00096314$$\n$$V(\\mathbf{r}_{2}^{\\text{new}}) \\approx (-0.99475624)^{2} + 0.00096314$$\n$$V(\\mathbf{r}_{2}^{\\text{new}}) \\approx 0.98954002 + 0.00096314 = 0.99050316 \\, \\text{eV}$$\nRounding the result to four significant figures gives $0.9905$.", "answer": "$$\n\\boxed{0.9905}\n$$", "id": "3437606"}, {"introduction": "Once a CI-NEB calculation converges, a crucial final step is to verify that the identified climbing image is indeed a true first-order saddle point. This practice [@problem_id:3471062] guides you through implementing the definitive test: computing the Hessian matrix at the converged geometry and analyzing its eigenvalues. By confirming the existence of exactly one negative eigenvalue, you will rigorously validate the nature of the transition state, transitioning from algorithmic execution to physical analysis.", "problem": "Design and implement a complete, runnable program that, for a set of prescribed climbing-image geometries after convergence of the Climbing Image–Nudged Elastic Band (CI-NEB) method, computes the Hessian matrix of the potential energy at the climbing image and verifies that exactly one eigenvalue is negative and the remaining $3N-1$ eigenvalues are non-negative for an $N$-atom system. The program must rely on first principles: the Hessian is defined as the matrix of second partial derivatives of the potential energy function with respect to all Cartesian coordinates. Use the following foundational bases: (i) the potential energy surface is a scalar field $V(\\mathbf{x})$ on $\\mathbb{R}^{3N}$, (ii) the gradient is $\\nabla V$, (iii) the Hessian is the Jacobian of the gradient, and (iv) the second-order Taylor expansion characterizes local curvature through the Hessian. You must not assume any special symmetries beyond those explicitly defined by the potentials below. Treat all quantities as dimensionless.\n\nImplement the Hessian numerically via symmetric central finite differences applied directly to the energy:\n- For diagonal entries, use\n$$\nH_{ii} \\approx \\frac{V(\\mathbf{x}+h\\mathbf{e}_i) - 2 V(\\mathbf{x}) + V(\\mathbf{x}-h\\mathbf{e}_i)}{h^2}.\n$$\n- For off-diagonal entries, use\n$$\nH_{ij} \\approx \\frac{V(\\mathbf{x}+h\\mathbf{e}_i+h\\mathbf{e}_j) - V(\\mathbf{x}+h\\mathbf{e}_i-h\\mathbf{e}_j) - V(\\mathbf{x}-h\\mathbf{e}_i+h\\mathbf{e}_j) + V(\\mathbf{x}-h\\mathbf{e}_i-h\\mathbf{e}_j)}{4h^2}, \\quad i\\neq j.\n$$\nUse a fixed step size $h=10^{-4}$ for all test cases. After obtaining the symmetric Hessian, compute all its eigenvalues. Classify an eigenvalue $\\lambda$ as negative if $\\lambda &lt; -\\tau$ and non-negative otherwise, where $\\tau=10^{-6}$ is a fixed numerical tolerance to robustly treat near-zero modes.\n\nYour program must verify, for each test case, whether there is exactly $1$ negative eigenvalue and exactly $3N-1$ non-negative eigenvalues. Note that non-negative eigenvalues include zero eigenvalues, which can arise from continuous symmetries such as overall translations and rotations. The final per-test result must be a boolean.\n\nTest Suite. Implement the following four independent test cases. In each case, $\\mathbf{x}\\in \\mathbb{R}^{3N}$ stacks all atomic Cartesian coordinates as $(x_1,y_1,z_1,\\ldots,x_N,y_N,z_N)$, and the provided geometry is the converged climbing image (a stationary point on $V$). All energies and coordinates are dimensionless.\n\n- Test $1$ (single-atom quartic saddle, happy path):\n  - $N=1$.\n  - Potential $V(\\mathbf{x}) = a x^4 - b x^2 + \\frac{k}{2}(y^2+z^2)$ with parameters $a=1.0$, $b=1.5$, $k=2.0$.\n  - Climbing image geometry $\\mathbf{x}=(0,0,0)$.\n\n- Test $2$ (two-atom central potential with a radial quartic barrier, translational and rotational zero modes):\n  - $N=2$.\n  - Let $\\mathbf{r}=\\mathbf{r}_2-\\mathbf{r}_1$, $r=\\|\\mathbf{r}\\|$. Potential $V(\\mathbf{x})=a(r-r_c)^4 - b(r-r_c)^2$ with $a=1.0$, $b=2.0$, $r_c=1.0$.\n  - Climbing image geometry $\\mathbf{r}_1=(0,0,0)$, $\\mathbf{r}_2=(1.0,0,0)$, so $r=r_c$.\n\n- Test $3$ (three-atom index-$1$ saddle built from a linear reaction coordinate):\n  - $N=3$.\n  - Let a fixed unit vector $\\mathbf{w}\\in\\mathbb{R}^{9}$ define the reaction coordinate $s=\\mathbf{w}^\\top \\mathbf{x}$, and define the orthogonal projection $\\mathbf{P}_\\perp=\\mathbf{I}-\\mathbf{w}\\mathbf{w}^\\top$, so that $\\mathbf{P}_\\perp \\mathbf{x}$ extracts components orthogonal to $\\mathbf{w}$. Potential\n    $$\n    V(\\mathbf{x}) = a s^4 - b s^2 + \\frac{k}{2}\\|\\mathbf{P}_\\perp \\mathbf{x}\\|^2,\n    $$\n    with $a=1.0$, $b=1.0$, $k=0.7$. Use the explicit vector\n    $$\n    \\mathbf{w}=\\frac{1}{\\sqrt{4}}\\,[1,\\,-1,\\,0,\\,0,\\,0,\\,1,\\,0,\\,0,\\,-1]^\\top,\n    $$\n    which is already normalized. Climbing image geometry $\\mathbf{x}=\\mathbf{0}\\in\\mathbb{R}^9$.\n\n- Test $4$ (single-atom saddle with near-zero transverse stiffness, edge case for tolerance):\n  - $N=1$.\n  - Potential $V(\\mathbf{x}) = a x^4 - b x^2 + \\frac{k_\\perp}{2}(y^2+z^2)$ with $a=1.0$, $b=1.0$, $k_\\perp=10^{-8}$.\n  - Climbing image geometry $\\mathbf{x}=(0,0,0)$.\n\nRequired Output. Your program should produce a single line of output containing the results as a comma-separated list of lowercase boolean literals enclosed in square brackets (for example, $[\\text{true},\\text{false},\\text{true},\\text{true}]$), corresponding in order to Tests $1$ through $4$.\n\nScoring Criterion. For each test, return $\\text{true}$ if and only if there is exactly $1$ negative eigenvalue and exactly $3N-1$ non-negative eigenvalues; otherwise return $\\text{false}$. The program must be self-contained, require no user input, and use the specified numerical parameters $h=10^{-4}$ and $\\tau=10^{-6}$.", "solution": "The user has provided a valid, well-posed, and scientifically grounded problem.\n\n### Introduction to First-Order Saddle Point Verification\n\nThe problem requires us to verify that specific points on a given potential energy surface $V(\\mathbf{x})$ are first-order saddle points. In the context of computational chemistry and materials science, a first-order saddle point, or transition state, represents the maximum energy barrier along a minimum energy path (MEP) between two local minima. The Climbing Image–Nudged Elastic Band (CI-NEB) method is an algorithm designed to converge one \"image\" (a discrete representation of the system's geometry) to such a saddle point.\n\nA stationary point $\\mathbf{x}_0$ on a potential energy surface $V(\\mathbf{x})$ is defined by the condition that the gradient is zero: $\\nabla V(\\mathbf{x}_0) = \\mathbf{0}$. The nature of this stationary point (minimum, maximum, or saddle point) is determined by the curvature of the surface at that point. This curvature is mathematically described by the Hessian matrix, $\\mathbf{H}$, which is the matrix of all second-order partial derivatives of the potential energy with respect to the system's $D=3N$ Cartesian coordinates:\n$$\nH_{ij} = \\frac{\\partial^2 V}{\\partial x_i \\partial x_j}\n$$\nA first-order saddle point is a stationary point where the Hessian matrix has exactly one negative eigenvalue. The eigenvector corresponding to this negative eigenvalue indicates the direction of the reaction coordinate, i.e., the path of steepest descent leading away from the saddle point toward the connected minima. The remaining $D-1 = 3N-1$ eigenvalues are non-negative, corresponding to directions where the potential energy is at a local minimum. Zero eigenvalues, or \"zero modes,\" correspond to directions in configuration space, such as overall translation and rotation of the entire system, along which the potential energy is invariant.\n\n### Numerical Hessian Calculation\n\nSince an analytical form of the Hessian may be complex or unavailable, we are tasked with computing it numerically using finite differences. The Hessian is a symmetric matrix, $\\mathbf{H} = \\mathbf{H}^\\top$. The problem provides specific, second-order accurate central difference formulas.\n\nFor the diagonal elements ($i=j$), the formula is:\n$$\nH_{ii} \\approx \\frac{V(\\mathbf{x}+h\\mathbf{e}_i) - 2 V(\\mathbf{x}) + V(\\mathbf{x}-h\\mathbf{e}_i)}{h^2}\n$$\nwhere $\\mathbf{x}$ is the coordinate vector of the stationary point, $h$ is a small step size, and $\\mathbf{e}_i$ is the unit vector along the $i$-th coordinate axis.\n\nFor the off-diagonal elements ($i \\neq j$), the formula is:\n$$\nH_{ij} \\approx \\frac{V(\\mathbf{x}+h\\mathbf{e}_i+h\\mathbf{e}_j) - V(\\mathbf{x}+h\\mathbf{e}_i-h\\mathbf{e}_j) - V(\\mathbf{x}-h\\mathbf{e}_i+h\\mathbf{e}_j) + V(\\mathbf{x}-h\\mathbf{e}_i-h\\mathbf{e}_j)}{4h^2}\n$$\nThese formulas are derived from Taylor series expansions of the multi-variable function $V(\\mathbf{x})$. A fixed step size of $h=10^{-4}$ is used for the numerical differentiation.\n\n### Eigenvalue Analysis and Verification\n\nOnce the $3N \\times 3N$ symmetric Hessian matrix $\\mathbf{H}$ is constructed, its eigenvalues $\\{\\lambda_k\\}_{k=1}^{3N}$ are computed. The problem defines a robust criterion for classifying these eigenvalues. Due to numerical precision limitations, eigenvalues that should be exactly zero (e.g., for translational or rotational modes) might compute as very small positive or negative numbers. To account for this, a tolerance $\\tau=10^{-6}$ is introduced.\n- An eigenvalue $\\lambda$ is classified as **negative** if $\\lambda < -\\tau$.\n- An eigenvalue $\\lambda$ is classified as **non-negative** if $\\lambda \\ge -\\tau$.\n\nThe verification for each test case consists of computing all $3N$ eigenvalues and confirming that the number of negative eigenvalues is exactly one. If this condition holds, the point is a valid first-order saddle point.\n\n### Algorithmic Implementation Strategy\n\nThe program is structured to solve each of the four test cases sequentially.\n\n1.  **Main Loop**: A primary function iterates through the four test cases. For each case, it defines the specific potential energy function $V(\\mathbf{x})$, the number of atoms $N$, and the coordinates of the climbing image $\\mathbf{x}_0$.\n\n2.  **Potential Energy Functions**: For each test case, a dedicated Python function implements the potential energy $V(\\mathbf{x})$. These functions take a single NumPy array representing the system's coordinates and return a scalar energy value.\n\n3.  **Hessian Construction**: A general-purpose function, `calculate_hessian`, is implemented. It takes $V(\\mathbf{x})$, $\\mathbf{x}_0$, $N$, and $h$ as input. It constructs the $3N \\times 3N$ Hessian matrix by systematically applying the provided finite difference formulas for both diagonal and off-diagonal elements. To ensure correctness, it iterates through all pairs of indices $(i, j)$ and evaluates $V$ at the required displaced coordinates.\n\n4.  **Verification**: After the Hessian is built, its eigenvalues are computed using `numpy.linalg.eigh`, which is optimized for symmetric matrices. The eigenvalues are then counted against the condition $\\lambda < -\\tau$. The function returns `True` if the count of negative eigenvalues is exactly $1$, and `False` otherwise.\n\n5.  **Output Formatting**: The boolean results from each test case are collected into a list, converted to lowercase strings, and printed in the required format `[result1,result2,result3,result4]`.\n\n### Analysis of Test Cases\n\n- **Test 1 ($N=1$ quartic saddle)**: A simple 3D potential. The analytical Hessian at $\\mathbf{x}=(0,0,0)$ is diagonal with eigenvalues $\\{-3, 2, 2\\}$. This is a classic first-order saddle, and the expected result is `True`.\n\n- **Test 2 ($N=2$ central potential)**: This potential depends only on the interatomic distance $r$. The system has translational and rotational symmetries. At the given geometry where $r=r_c=1.0$, the curvature along the bond-stretching direction is negative. We expect one negative eigenvalue corresponding to this mode, and five zero eigenvalues (three for translation, two for rotation of the linear dimer). The remaining `3N-1=5` eigenvalues should be non-negative. The expected result is `True`.\n\n- **Test 3 ($N=3$ linear reaction coordinate)**: This is a more abstract $9$-dimensional potential constructed using a projection operator. The potential is made unstable along a specific direction $\\mathbf{w}$ and stable in the $8$-dimensional subspace orthogonal to $\\mathbf{w}$. We expect one negative eigenvalue and eight positive eigenvalues. The expected result is `True`.\n\n- **Test 4 ($N=1$ with near-zero stiffness)**: This is similar to Test 1, but the stiffness in the $y$ and $z$ directions, $k_\\perp$, is very small ($10^{-8}$). The eigenvalues will be approximately $\\{-2, 10^{-8}, 10^{-8}\\}$. This tests the implementation of the tolerance $\\tau=10^{-6}$. Since $10^{-8} > -10^{-6}$, these eigenvalues are correctly classified as non-negative. The expected result is `True`.\n\nThis systematic approach ensures that the implementation is a direct and faithful execution of the first-principles-based validation procedure described in the problem statement.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the Hessian verification for all test cases.\n    \"\"\"\n    \n    # Global parameters as defined in the problem statement\n    H_STEP = 1e-4\n    EIG_TOLERANCE = 1e-6\n\n    def calculate_hessian(V_func, x0, D, h):\n        \"\"\"\n        Calculates the Hessian matrix for a potential V_func at point x0.\n\n        Args:\n            V_func (callable): The potential energy function V(x).\n            x0 (np.ndarray): The point at which to calculate the Hessian.\n            D (int): The dimension of the coordinate space (3*N).\n            h (float): The step size for finite differences.\n\n        Returns:\n            np.ndarray: The D x D Hessian matrix.\n        \"\"\"\n        H = np.zeros((D, D))\n        V0 = V_func(x0)\n\n        # Diagonal elements H_ii\n        for i in range(D):\n            x_p = x0.copy()\n            x_m = x0.copy()\n            x_p[i] += h\n            x_m[i] -= h\n            V_p = V_func(x_p)\n            V_m = V_func(x_m)\n            H[i, i] = (V_p - 2 * V0 + V_m) / (h**2)\n\n        # Off-diagonal elements H_ij\n        for i in range(D):\n            for j in range(i + 1, D):\n                x_pp = x0.copy()\n                x_pm = x0.copy()\n                x_mp = x0.copy()\n                x_mm = x0.copy()\n\n                x_pp[i] += h\n                x_pp[j] += h\n\n                x_pm[i] += h\n                x_pm[j] -= h\n\n                x_mp[i] -= h\n                x_mp[j] += h\n\n                x_mm[i] -= h\n                x_mm[j] -= h\n\n                V_pp = V_func(x_pp)\n                V_pm = V_func(x_pm)\n                V_mp = V_func(x_mp)\n                V_mm = V_func(x_mm)\n                \n                val = (V_pp - V_pm - V_mp + V_mm) / (4 * h**2)\n                H[i, j] = val\n                H[j, i] = val\n        \n        return H\n\n    def verify_saddle_point(V_func, x0, N, h, tau):\n        \"\"\"\n        Verifies if a point is a first-order saddle point.\n        \n        Args:\n            V_func (callable): The potential energy function V(x).\n            x0 (np.ndarray): The geometry of the climbing image.\n            N (int): The number of atoms.\n            h (float): The finite difference step size.\n            tau (float): The tolerance for classifying eigenvalues.\n            \n        Returns:\n            bool: True if there is exactly 1 negative eigenvalue, False otherwise.\n        \"\"\"\n        D = 3 * N\n        hessian = calculate_hessian(V_func, x0, D, h)\n        \n        # Use np.linalg.eigh for symmetric matrices\n        eigenvalues = np.linalg.eigvalsh(hessian)\n        \n        negative_eigenvalue_count = np.sum(eigenvalues < -tau)\n        \n        # The condition for a first-order saddle point is exactly one negative eigenvalue.\n        # The total number of eigenvalues is 3N. If one is negative, the other 3N-1 must\n        # be non-negative, so this single check is sufficient.\n        return negative_eigenvalue_count == 1\n\n    # --- Test Cases ---\n    \n    test_suite = []\n\n    # Test 1: Single-atom quartic saddle\n    def setup_test1():\n        N = 1\n        a, b, k = 1.0, 1.5, 2.0\n        x0 = np.array([0.0, 0.0, 0.0])\n        def V_func(x_vec):\n            x, y, z = x_vec[0], x_vec[1], x_vec[2]\n            return a * x**4 - b * x**2 + 0.5 * k * (y**2 + z**2)\n        return V_func, x0, N\n    test_suite.append(setup_test1())\n\n    # Test 2: Two-atom central potential\n    def setup_test2():\n        N = 2\n        a, b, rc = 1.0, 2.0, 1.0\n        x0 = np.array([0.0, 0.0, 0.0, 1.0, 0.0, 0.0])\n        def V_func(x_vec):\n            r1 = x_vec[0:3]\n            r2 = x_vec[3:6]\n            r_vec = r2 - r1\n            r = np.linalg.norm(r_vec)\n            return a * (r - rc)**4 - b * (r - rc)**2\n        return V_func, x0, N\n    test_suite.append(setup_test2())\n    \n    # Test 3: Three-atom index-1 saddle\n    def setup_test3():\n        N = 3\n        a, b, k = 1.0, 1.0, 0.7\n        x0 = np.zeros(9)\n        w = np.array([1.0, -1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, -1.0]) / np.sqrt(4.0)\n        def V_func(x_vec):\n            s = np.dot(w, x_vec)\n            # P_perp_x = x - (w^T x)w\n            P_perp_x = x_vec - s * w\n            norm_sq_P_perp_x = np.dot(P_perp_x, P_perp_x)\n            return a * s**4 - b * s**2 + 0.5 * k * norm_sq_P_perp_x\n        return V_func, x0, N\n    test_suite.append(setup_test3())\n\n    # Test 4: Single-atom saddle with near-zero transverse stiffness\n    def setup_test4():\n        N = 1\n        a, b, k_perp = 1.0, 1.0, 1e-8\n        x0 = np.array([0.0, 0.0, 0.0])\n        def V_func(x_vec):\n            x, y, z = x_vec[0], x_vec[1], x_vec[2]\n            return a * x**4 - b * x**2 + 0.5 * k_perp * (y**2 + z**2)\n        return V_func, x0, N\n    test_suite.append(setup_test4())\n\n    # Run all tests and collect results\n    results = []\n    for V_f, x_0, n_atoms in test_suite:\n        is_saddle = verify_saddle_point(V_f, x_0, n_atoms, H_STEP, EIG_TOLERANCE)\n        results.append(str(is_saddle).lower())\n        \n    # Print results in the specified format\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "3471062"}]}