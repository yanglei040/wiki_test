{"hands_on_practices": [{"introduction": "The use of finite basis sets in quantum chemistry calculations inevitably introduces errors into the computed energies. This practice provides a foundational understanding of these inaccuracies by guiding you to dissect the total error in an interaction energy into its two distinct components. You will quantitatively isolate the Basis Set Superposition Error (BSSE), an artificial stabilization arising from basis function \"borrowing\" between fragments, and the intrinsic Basis Set Incompleteness Error (BSIE), which reflects the limitations of the basis itself [@problem_id:3434474]. Mastering this decomposition is the first step toward diagnosing and mitigating errors in your own research calculations.", "problem": "You are asked to formalize and implement the decomposition of the total basis error in an interaction energy into Basis Set Incompleteness Error (BSIE) and Basis Set Superposition Error (BSSE) within the framework of computational materials science, using the principles underpinning wavefunction-based electronic structure theory. Your derivation must begin from a valid foundational base: the non-relativistic electronic Schrödinger equation in the Born–Oppenheimer approximation, the Rayleigh–Ritz variational principle for Hermitian operators, and the definition of interaction energy in a finite basis. The goal is to derive what the decomposition is, why it holds, and how one isolates each component through targeted calculations with fragment-only and supermolecule bases, followed by implementing the resulting formulas in code. All energies are to be expressed in Hartree, and all results must be output in Hartree.\n\nUse the following base facts and definitions:\n- The electronic Schrödinger equation yields the ground-state energy $E$ that is approximated in practice by projecting onto a finite basis $\\mathcal{B}$, leading to an energy $E^\\mathcal{B}$.\n- The Rayleigh–Ritz variational principle ensures $E^\\mathcal{B} \\geq E^\\infty$ under appropriate conditions, where $E^\\infty$ denotes the complete basis limit.\n- For a dimer formed by fragments $A$ and $B$, the interaction energy in a finite basis is defined as\n$$\nE_{\\mathrm{int}}^\\mathcal{B} = E_{AB}^{\\mathcal{B}_{AB}} - E_A^{\\mathcal{B}_A} - E_B^{\\mathcal{B}_B},\n$$\nwhere $E_{AB}^{\\mathcal{B}_{AB}}$ is the dimer energy in the supermolecule basis $\\mathcal{B}_{AB}$, and $E_X^{\\mathcal{B}_X}$ are monomer energies in their fragment-only bases $\\mathcal{B}_X$ for $X \\in \\{A,B\\}$.\n- Basis Set Superposition Error (BSSE) arises because $A$ and $B$ can variationally lower their energies by borrowing basis functions from each other within the supermolecule basis. To quantify this, compute $E_A^{\\mathcal{B}_{AB}}$ and $E_B^{\\mathcal{B}_{AB}}$ as the monomer energies in the supermolecule basis with ghost functions of the other fragment present (no electrons or nuclei from the other fragment), then form the counterpoise-corrected interaction energy\n$$\nE_{\\mathrm{int}}^{\\mathrm{CP}} = E_{AB}^{\\mathcal{B}_{AB}} - E_A^{\\mathcal{B}_{AB}} - E_B^{\\mathcal{B}_{AB}}.\n$$\n\nTasks:\n- Derive a formal decomposition of the total interaction energy error\n$$\n\\Delta E_{\\mathrm{int}}^{\\mathrm{tot}} = E_{\\mathrm{int}}^\\mathcal{B} - E_{\\mathrm{int}}^\\infty\n$$\ninto two additive components corresponding to Basis Set Superposition Error (BSSE) and Basis Set Incompleteness Error (BSIE). The derivation must start from the above definitions and fundamental principles, and must not introduce any shortcut formulas without justification.\n- Based on the decomposition, design and implement an algorithm that, given the targeted calculations with fragment-only and supermolecule bases, isolates numerical values for BSSE and BSIE:\n  - Compute $E_{\\mathrm{int}}^\\mathcal{B}$ from $E_{AB}^{\\mathcal{B}_{AB}}, E_A^{\\mathcal{B}_A}, E_B^{\\mathcal{B}_B}$.\n  - Compute $E_{\\mathrm{int}}^{\\mathrm{CP}}$ from $E_{AB}^{\\mathcal{B}_{AB}}, E_A^{\\mathcal{B}_{AB}}, E_B^{\\mathcal{B}_{AB}}$.\n  - Use a provided reference $E_{\\mathrm{int}}^\\infty$ (from a near-complete basis) to numerically isolate BSIE and BSSE without ambiguity.\n\nInput data for the test suite:\nFor each test case $i$, you are given six real numbers in Hartree:\n- $E_{AB}^{\\mathcal{B}_{AB}}$,\n- $E_A^{\\mathcal{B}_A}$,\n- $E_B^{\\mathcal{B}_B}$,\n- $E_A^{\\mathcal{B}_{AB}}$,\n- $E_B^{\\mathcal{B}_{AB}}$,\n- $E_{\\mathrm{int}}^\\infty$.\n\nUse the following parameter sets (all values in Hartree):\n- Test case $1$ (moderate Basis Set Superposition Error):\n  - $E_{AB}^{\\mathcal{B}_{AB}} = -152.345678$\n  - $E_A^{\\mathcal{B}_A} = -76.123456$\n  - $E_B^{\\mathcal{B}_B} = -76.200000$\n  - $E_A^{\\mathcal{B}_{AB}} = -76.130000$\n  - $E_B^{\\mathcal{B}_{AB}} = -76.205000$\n  - $E_{\\mathrm{int}}^\\infty = -0.012000$\n- Test case $2$ (near-complete basis, negligible Basis Set Superposition Error):\n  - $E_{AB}^{\\mathcal{B}_{AB}} = -20.000010$\n  - $E_A^{\\mathcal{B}_A} = -10.000000$\n  - $E_B^{\\mathcal{B}_B} = -10.000000$\n  - $E_A^{\\mathcal{B}_{AB}} = -10.000001$\n  - $E_B^{\\mathcal{B}_{AB}} = -10.000001$\n  - $E_{\\mathrm{int}}^\\infty = -0.000008$\n- Test case $3$ (severe Basis Set Superposition Error with minimal basis):\n  - $E_{AB}^{\\mathcal{B}_{AB}} = -30.080000$\n  - $E_A^{\\mathcal{B}_A} = -15.000000$\n  - $E_B^{\\mathcal{B}_B} = -15.000000$\n  - $E_A^{\\mathcal{B}_{AB}} = -15.050000$\n  - $E_B^{\\mathcal{B}_{AB}} = -15.020000$\n  - $E_{\\mathrm{int}}^\\infty = -0.015000$\n- Test case $4$ (asymmetric Basis Set Superposition Error, fragment $A$ only):\n  - $E_{AB}^{\\mathcal{B}_{AB}} = -21.120000$\n  - $E_A^{\\mathcal{B}_A} = -12.345600$\n  - $E_B^{\\mathcal{B}_B} = -8.765400$\n  - $E_A^{\\mathcal{B}_{AB}} = -12.349000$\n  - $E_B^{\\mathcal{B}_{AB}} = -8.765400$\n  - $E_{\\mathrm{int}}^\\infty = -0.006000$\n\nRequired outputs per test case (all in Hartree):\n- The Basis Set Superposition Error contribution to the interaction energy error, defined by the monomer energy lowering in the supermolecule basis relative to fragment-only bases.\n- The Basis Set Incompleteness Error contribution in the counterpoise-corrected interaction energy relative to the reference complete basis interaction energy.\n- The total interaction energy error relative to the complete basis reference.\n- A boolean that is true if the decomposition holds to numerical tolerance and false otherwise.\n\nYour program must produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each test case result is itself a list in the order [$\\mathrm{BSSE}$, $\\mathrm{BSIE}$, $\\Delta E_{\\mathrm{int}}^{\\mathrm{tot}}$, consistency boolean]. Example shape: $[[\\cdots],[\\cdots],[\\cdots],[\\cdots]]$. All quantities must be reported in Hartree. Angles are not involved. Percentages must not be used.", "solution": "The problem requires a formal derivation and computational implementation for the decomposition of the total interaction energy error in electronic structure calculations into Basis Set Superposition Error (BSSE) and Basis Set Incompleteness Error (BSIE). The derivation must be built upon the fundamental principles and definitions provided.\n\nLet us begin by establishing the theoretical foundation. The ground-state energy of a molecular system is the lowest eigenvalue of the electronic Hamiltonian operator, $\\hat{H}$, as given by the time-independent Schrödinger equation. In practice, we employ the Rayleigh-Ritz variational principle, which states that for any trial wavefunction $\\Psi$ in the appropriate Hilbert space, the expectation value of the energy, $\\langle \\Psi | \\hat{H} | \\Psi \\rangle / \\langle \\Psi | \\Psi \\rangle$, is an upper bound to the true ground-state energy, $E^\\infty$. When we represent the wavefunction as a linear combination of functions from a finite basis set $\\mathcal{B}$, the principle guarantees that the calculated energy, $E^\\mathcal{B}$, is an upper bound to the exact energy in the complete basis set limit, $E^\\infty$. That is, $E^\\mathcal{B} \\ge E^\\infty$.\n\nFor a system composed of two interacting fragments, $A$ and $B$, the interaction energy at the complete basis set (CBS) limit, $E_{\\mathrm{int}}^\\infty$, is the true physical interaction energy, defined as:\n$$\nE_{\\mathrm{int}}^\\infty = E_{AB}^\\infty - E_A^\\infty - E_B^\\infty\n$$\nwhere $E_{AB}^\\infty$, $E_A^\\infty$, and $E_B^\\infty$ are the respective CBS-limit energies of the dimer $AB$ and monomers $A$ and $B$.\n\nIn a practical calculation with a finite basis set $\\mathcal{B}$, the uncorrected or \"raw\" interaction energy is defined as:\n$$\nE_{\\mathrm{int}}^\\mathcal{B} = E_{AB}^{\\mathcal{B}_{AB}} - E_A^{\\mathcal{B}_A} - E_B^{\\mathcal{B}_B}\n$$\nHere, $E_{AB}^{\\mathcal{B}_{AB}}$ is the energy of the dimer calculated in the supermolecule basis $\\mathcal{B}_{AB} = \\mathcal{B}_A \\cup \\mathcal{B}_B$. The monomer energies, $E_A^{\\mathcal{B}_A}$ and $E_B^{\\mathcal{B}_B}$, are calculated using only their respective fragment-centered basis sets, $\\mathcal{B}_A$ and $\\mathcal{B}_B$.\n\nThe total error in the interaction energy calculated with basis $\\mathcal{B}$ is the deviation from the CBS limit:\n$$\n\\Delta E_{\\mathrm{int}}^{\\mathrm{tot}} = E_{\\mathrm{int}}^\\mathcal{B} - E_{\\mathrm{int}}^\\infty\n$$\n\nOur objective is to decompose this total error into two physically meaningful, additive components. The key insight is to introduce the counterpoise-corrected interaction energy, $E_{\\mathrm{int}}^{\\mathrm{CP}}$, which is designed to mitigate a specific type of error. The counterpoise (CP) correction method of Boys and Bernardi (1970) proposes that a more balanced description is achieved if the monomer energies are also calculated in the full supermolecule basis, $\\mathcal{B}_{AB}$. This is done by performing calculations on each monomer in the presence of the other's basis functions (termed \"ghost\" functions), but without its nuclei or electrons. These energies are denoted $E_A^{\\mathcal{B}_{AB}}$ and $E_B^{\\mathcal{B}_{AB}}$. The CP-corrected interaction energy is then:\n$$\nE_{\\mathrm{int}}^{\\mathrm{CP}} = E_{AB}^{\\mathcal{B}_{AB}} - E_A^{\\mathcal{B}_{AB}} - E_B^{\\mathcal{B}_{AB}}\n$$\n\nWith $E_{\\mathrm{int}}^{\\mathrm{CP}}$ defined, we can decompose the total error by adding and subtracting this term:\n$$\n\\Delta E_{\\mathrm{int}}^{\\mathrm{tot}} = (E_{\\mathrm{int}}^\\mathcal{B} - E_{\\mathrm{int}}^{\\mathrm{CP}}) + (E_{\\mathrm{int}}^{\\mathrm{CP}} - E_{\\mathrm{int}}^\\infty)\n$$\nThis is a purely algebraic manipulation that partitions the total error into two components. Let us analyze each component.\n\nThe first component, $(E_{\\mathrm{int}}^\\mathcal{B} - E_{\\mathrm{int}}^{\\mathrm{CP}})$, represents the difference between the uncorrected and counterpoise-corrected interaction energies. Let's expand this term using their definitions:\n$$\nE_{\\mathrm{int}}^\\mathcal{B} - E_{\\mathrm{int}}^{\\mathrm{CP}} = (E_{AB}^{\\mathcal{B}_{AB}} - E_A^{\\mathcal{B}_A} - E_B^{\\mathcal{B}_B}) - (E_{AB}^{\\mathcal{B}_{AB}} - E_A^{\\mathcal{B}_{AB}} - E_B^{\\mathcal{B}_{AB}})\n$$\n$$\nE_{\\mathrm{int}}^\\mathcal{B} - E_{\\mathrm{int}}^{\\mathrm{CP}} = (E_A^{\\mathcal{B}_{AB}} - E_A^{\\mathcal{B}_A}) + (E_B^{\\mathcal{B}_{AB}} - E_B^{\\mathcal{B}_B})\n$$\nThe term $(E_A^{\\mathcal{B}_{AB}} - E_A^{\\mathcal{B}_A})$ is the energy lowering of monomer $A$ when its description is improved by the availability of basis functions from fragment $B$. According to the variational principle, since $\\mathcal{B}_A \\subseteq \\mathcal{B}_{AB}$, the energy $E_A^{\\mathcal{B}_{AB}}$ must be less than or equal to $E_A^{\\mathcal{B}_A}$. Thus, this difference is negative or zero. This spurious energy lowering is an artifact of the unbalanced basis sets used in the definition of $E_{\\mathrm{int}}^\\mathcal{B}$; monomer $A$ \"borrows\" functions from $B$ to better describe its own electron density. This artificial stabilization is the Basis Set Superposition Error (BSSE). The contribution of BSSE to the total error in the interaction energy is therefore this very quantity. We define this contribution as:\n$$\n\\delta_{\\mathrm{BSSE}} = (E_A^{\\mathcal{B}_{AB}} - E_A^{\\mathcal{B}_A}) + (E_B^{\\mathcal{B}_{AB}} - E_B^{\\mathcal{B}_B})\n$$\n\nThe second component, $(E_{\\mathrm{int}}^{\\mathrm{CP}} - E_{\\mathrm{int}}^\\infty)$, represents the remaining error. The quantity $E_{\\mathrm{int}}^{\\mathrm{CP}}$ is considered a better approximation of $E_{\\mathrm{int}}^\\infty$ than $E_{\\mathrm{int}}^\\mathcal{B}$ because the BSSE has been removed. The error that remains in $E_{\\mathrm{int}}^{\\mathrm{CP}}$ is due to the inherent inadequacy, or incompleteness, of the entire supermolecule basis set $\\mathcal{B}_{AB}$ to describe the full physics of the interacting system, even after correcting for the superposition artifact. This is therefore the Basis Set Incompleteness Error (BSIE). We define it as:\n$$\n\\delta_{\\mathrm{BSIE}} = E_{\\mathrm{int}}^{\\mathrm{CP}} - E_{\\mathrm{int}}^\\infty\n$$\n\nThus, the formal decomposition of the total error is:\n$$\n\\Delta E_{\\mathrm{int}}^{\\mathrm{tot}} = \\delta_{\\mathrm{BSSE}} + \\delta_{\\mathrm{BSIE}}\n$$\nThis decomposition is arithmetically exact by construction and separates the error into a component arising from an unbalanced basis description (BSSE) and a component from the intrinsic limitations of the finite basis itself (BSIE).\n\nTo implement an algorithm based on this derivation, we will compute the following quantities from the six input energies ($E_{AB}^{\\mathcal{B}_{AB}}$, $E_A^{\\mathcal{B}_A}$, $E_B^{\\mathcal{B}_B}$, $E_A^{\\mathcal{B}_{AB}}$, $E_B^{\\mathcal{B}_{AB}}$, $E_{\\mathrm{int}}^\\infty$):\n\n1.  Calculate the uncorrected interaction energy: $E_{\\mathrm{int}}^\\mathcal{B} = E_{AB}^{\\mathcal{B}_{AB}} - E_A^{\\mathcal{B}_A} - E_B^{\\mathcal{B}_B}$.\n2.  Calculate the counterpoise-corrected interaction energy: $E_{\\mathrm{int}}^{\\mathrm{CP}} = E_{AB}^{\\mathcal{B}_{AB}} - E_A^{\\mathcal{B}_{AB}} - E_B^{\\mathcal{B}_{AB}}$.\n3.  Calculate the total error: $\\Delta E_{\\mathrm{int}}^{\\mathrm{tot}} = E_{\\mathrm{int}}^\\mathcal{B} - E_{\\mathrm{int}}^\\infty$.\n4.  Calculate the BSSE contribution to the error: $\\delta_{\\mathrm{BSSE}} = E_{\\mathrm{int}}^\\mathcal{B} - E_{\\mathrm{int}}^{\\mathrm{CP}}$. This is equivalent to $(E_A^{\\mathcal{B}_{AB}} - E_A^{\\mathcal{B}_A}) + (E_B^{\\mathcal{B}_{AB}} - E_B^{\\mathcal{B}_B})$. As requested, this quantity will be reported as the BSSE.\n5.  Calculate the BSIE contribution: $\\delta_{\\mathrm{BSIE}} = E_{\\mathrm{int}}^{\\mathrm{CP}} - E_{\\mathrm{int}}^\\infty$.\n6.  Verify the decomposition: Check if $\\Delta E_{\\mathrm{int}}^{\\mathrm{tot}} = \\delta_{\\mathrm{BSSE}} + \\delta_{\\mathrm{BSIE}}$ holds to within standard floating-point tolerance. This provides a consistency check on the calculations.\n\nThis procedure will be applied to each test case to yield the required numerical results.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem of decomposing the total basis error in an interaction\n    energy into Basis Set Incompleteness Error (BSIE) and Basis Set\n    Superposition Error (BSSE).\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    # Each tuple contains:\n    # (E_AB_dimer, E_A_mono, E_B_mono, E_A_ghost, E_B_ghost, E_int_inf)\n    # All values are in Hartree.\n    test_cases = [\n        # Test case 1: moderate Basis Set Superposition Error\n        (\n            -152.345678,  # E_AB_dimer\n            -76.123456,   # E_A_mono\n            -76.200000,   # E_B_mono\n            -76.130000,   # E_A_ghost\n            -76.205000,   # E_B_ghost\n            -0.012000     # E_int_inf\n        ),\n        # Test case 2: near-complete basis, negligible Basis Set Superposition Error\n        (\n            -20.000010,   # E_AB_dimer\n            -10.000000,   # E_A_mono\n            -10.000000,   # E_B_mono\n            -10.000001,   # E_A_ghost\n            -10.000001,   # E_B_ghost\n            -0.000008     # E_int_inf\n        ),\n        # Test case 3: severe Basis Set Superposition Error with minimal basis\n        (\n            -30.080000,   # E_AB_dimer\n            -15.000000,   # E_A_mono\n            -15.000000,   # E_B_mono\n            -15.050000,   # E_A_ghost\n            -15.020000,   # E_B_ghost\n            -0.015000     # E_int_inf\n        ),\n        # Test case 4: asymmetric Basis Set Superposition Error, fragment A only\n        (\n            -21.120000,   # E_AB_dimer\n            -12.345600,   # E_A_mono\n            -8.765400,    # E_B_mono\n            -12.349000,   # E_A_ghost\n            -8.765400,    # E_B_ghost\n            -0.006000     # E_int_inf\n        ),\n    ]\n\n    results = []\n    for case in test_cases:\n        E_AB_dimer, E_A_mono, E_B_mono, E_A_ghost, E_B_ghost, E_int_inf = case\n\n        # 1. Calculate the uncorrected interaction energy in the finite basis (E_int^B)\n        # E_int^B = E_AB^(B_AB) - E_A^(B_A) - E_B^(B_B)\n        e_int_b = E_AB_dimer - E_A_mono - E_B_mono\n\n        # 2. Calculate the counterpoise-corrected interaction energy (E_int^CP)\n        # E_int^CP = E_AB^(B_AB) - E_A^(B_AB) - E_B^(B_AB)\n        e_int_cp = E_AB_dimer - E_A_ghost - E_B_ghost\n\n        # 3. Calculate the total interaction energy error (Delta E_int^tot)\n        # Delta E_int^tot = E_int^B - E_int^inf\n        total_error = e_int_b - E_int_inf\n\n        # 4. Calculate the Basis Set Superposition Error (BSSE) contribution to the total error.\n        # This is the artificial stabilization from monomer basis functions borrowing.\n        # delta_BSSE = E_int^B - E_int^CP = (E_A^(B_AB) - E_A^(B_A)) + (E_B^(B_AB) - E_B^(B_B))\n        # Note: This contribution is negative, representing an artificial over-binding.\n        bsse_contribution = (E_A_ghost - E_A_mono) + (E_B_ghost - E_B_mono)\n\n        # 5. Calculate the Basis Set Incompleteness Error (BSIE) contribution.\n        # This is the remaining error in the CP-corrected energy.\n        # delta_BSIE = E_int^CP - E_int^inf\n        bsie_contribution = e_int_cp - E_int_inf\n\n        # 6. Perform a consistency check to verify the decomposition.\n        # The decomposition is Delta E_int^tot = delta_BSSE + delta_BSIE.\n        # We use np.isclose for robust floating-point comparison.\n        is_consistent = np.isclose(total_error, bsse_contribution + bsie_contribution)\n\n        # Append the results for the current test case.\n        # Order: [BSSE, BSIE, TotalError, ConsistencyBoolean]\n        results.append([bsse_contribution, bsie_contribution, total_error, is_consistent])\n\n    # Convert the boolean to lowercase string 'true'/'false' for the output.\n    # Then join all results into the final formatted string.\n    formatted_results = []\n    for res in results:\n        # Convert NumPy boolean to Python boolean for json-like string representation\n        bool_val = bool(res[3])\n        formatted_res = f\"[{res[0]},{res[1]},{res[2]},{str(bool_val).lower()}]\"\n        formatted_results.append(formatted_res)\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(formatted_results)}]\")\n\n\nsolve()\n```", "id": "3434474"}, {"introduction": "Once we understand the sources of basis set error, the next step is to correct for them. This exercise contrasts two powerful techniques: the counterpoise (CP) correction, which directly targets BSSE, and Complete Basis Set (CBS) extrapolation, which aims to eliminate the residual BSIE by modeling the energy's convergence toward an infinite basis limit [@problem_id:3434543]. By implementing a two-point extrapolation scheme and comparing its results to CP-corrected values, you will gain practical insight into the performance of these methods and learn to critically assess when a given correction might be sufficient, or when it could even overcorrect the binding energy.", "problem": "You are asked to formalize and implement a comparison between counterpoise-corrected adsorption energies and complete-basis-set limits in a way that is mathematically precise and algorithmically testable. Begin from the following fundamental base appropriate to computational materials science: the Born-Oppenheimer electronic energy is variational with respect to the wavefunction, and truncations in the basis set introduce a systematic basis set incompleteness error. For a cardinal sequence of Gaussian atom-centered orbital bases with increasing integer size parameter $M$, the asymptotic convergence for a total energy $E(M)$ can be modeled by the well-tested empirical form $E(M)=E_{\\infty}+A M^{-p}$, where $E_{\\infty}$ is the complete-basis-set limit, $A$ is a system-dependent prefactor, and $p>0$ is an exponent characterizing the rate of convergence. This behavior is consistent with the variational principle because $E(M)\\ge E_{\\infty}$ for bound states.\n\nDefinitions to be used:\n- Adsorption energy at a given basis cardinal $M$ is defined as $E_{\\text{ads}}(M)=E_{\\text{AB}}(M)-E_{\\text{A}}(M)-E_{\\text{B}}(M)$, where $E_{\\text{AB}}$ is the total energy of the adsorbate-surface system, $E_{\\text{A}}$ is the energy of the surface fragment, and $E_{\\text{B}}$ is the energy of the adsorbate fragment.\n- The Boys-Bernardi counterpoise correction (counterpoise, CP) computes monomer fragment energies in the presence of the other fragment’s basis functions (ghost functions) to mitigate basis superposition error. At fixed $M$, the counterpoise-corrected adsorption energy is $E_{\\text{ads}}^{\\text{CP}}(M)=E_{\\text{AB}}(M)-E_{\\text{A}}^{\\text{ghost}}(M)-E_{\\text{B}}^{\\text{ghost}}(M)$, where $E_{\\text{A}}^{\\text{ghost}}(M)$ and $E_{\\text{B}}^{\\text{ghost}}(M)$ are monomer energies computed in the dimer basis (without the other fragment’s electrons).\n- The complete-basis-set (CBS) adsorption energy is $E_{\\text{ads}}^{\\text{CBS}}=E_{\\text{AB},\\infty}-E_{\\text{A},\\infty}-E_{\\text{B},\\infty}$, where $E_{X,\\infty}$ denotes the CBS limit for system $X\\in\\{\\text{AB},\\text{A},\\text{B}\\}$.\n\nYour tasks:\n1. Given two basis cardinal numbers $M_1$ and $M_2$ and their corresponding total energies $E(M_1)$ and $E(M_2)$ for each of $\\text{AB}$, $\\text{A}$, and $\\text{B}$, derive from first principles how to eliminate the unknown prefactor $A$ and infer the CBS limit $E_{\\infty}$ using only the empirical asymptotic form $E(M)=E_{\\infty}+A M^{-p}$, the variational property, and algebraic manipulation of two equations. You must not rely on any shortcut formulas; instead, express the logical steps required to isolate $E_{\\infty}$.\n2. Implement a program that, for each test case, extrapolates $E_{\\text{AB},\\infty}$, $E_{\\text{A},\\infty}$, and $E_{\\text{B},\\infty}$ using the two energies at $M_1$ and $M_2$ and a given exponent $p$, then computes $E_{\\text{ads}}^{\\text{CBS}}$.\n3. Using provided ghost-basis monomer energies at $M_2$, compute $E_{\\text{ads}}^{\\text{CP}}(M_2)$ and evaluate the difference $\\Delta E_{\\text{ads}}=E_{\\text{ads}}^{\\text{CP}}(M_2)-E_{\\text{ads}}^{\\text{CBS}}$. Interpret the sign of $\\Delta E_{\\text{ads}}$ as a regime map: if $\\Delta E_{\\text{ads}}>0$ then counterpoise over-corrects (the corrected adsorption energy is less negative than the CBS limit for typically exothermic adsorption), if $\\Delta E_{\\text{ads}}<0$ then counterpoise under-corrects (the corrected adsorption energy is more negative than the CBS limit), and if $\\Delta E_{\\text{ads}}=0$ then the correction is balanced.\n4. All energies must be treated and reported in electronvolts (eV). Your program must produce as final output a single line containing a comma-separated list of the $\\Delta E_{\\text{ads}}$ values for the test suite, rounded to six decimal places, enclosed in square brackets, for example, $[x_1,x_2,x_3,x_4]$.\n\nTest suite (each case provides $p$, $M_1$, $M_2$, two-point energies for $\\text{AB}$, $\\text{A}$, $\\text{B}$ at $M_1$ and $M_2$, and ghost monomer energies at $M_2$; all energies are in eV):\n\n- Case 1 (typical convergence, mild over-correction):\n  - $p=4$, $M_1=3$, $M_2=4$,\n  - $E_{\\text{AB}}(M_1)=-21.117037037037$, $E_{\\text{AB}}(M_2)=-21.1190625$,\n  - $E_{\\text{A}}(M_1)=-19.796296296296$, $E_{\\text{A}}(M_2)=-19.798828125$,\n  - $E_{\\text{B}}(M_1)=-1.249259259259$, $E_{\\text{B}}(M_2)=-1.249765625$,\n  - $E_{\\text{A}}^{\\text{ghost}}(M_2)=-19.799628125$, $E_{\\text{B}}^{\\text{ghost}}(M_2)=-1.249965625$.\n\n- Case 2 (typical convergence, slight under-correction):\n  - $p=4$, $M_1=3$, $M_2=4$,\n  - $E_{\\text{AB}}(M_1)=-15.198148148148$, $E_{\\text{AB}}(M_2)=-15.1994140625$,\n  - $E_{\\text{A}}(M_1)=-13.997777777778$, $E_{\\text{A}}(M_2)=-13.999296875$,\n  - $E_{\\text{B}}(M_1)=-1.11962962963$, $E_{\\text{B}}(M_2)=-1.1198828125$,\n  - $E_{\\text{A}}^{\\text{ghost}}(M_2)=-13.999396875$, $E_{\\text{B}}^{\\text{ghost}}(M_2)=-1.1199028125$.\n\n- Case 3 (boundary regime, near-balanced correction):\n  - $p=5$, $M_1=3$, $M_2=5$,\n  - $E_{\\text{AB}}(M_1)=-7.319670781893$, $E_{\\text{AB}}(M_2)=-7.3199744$,\n  - $E_{\\text{A}}(M_1)=-6.19975308642$, $E_{\\text{A}}(M_2)=-6.1999808$,\n  - $E_{\\text{B}}(M_1)=-1.09991736227$, $E_{\\text{B}}(M_2)=-1.0999936$,\n  - $E_{\\text{A}}^{\\text{ghost}}(M_2)=-6.1999958$, $E_{\\text{B}}^{\\text{ghost}}(M_2)=-1.0999976$.\n\n- Case 4 (edge case, faster apparent convergence of the dimer than monomers leading to under-correction):\n  - $p=3$, $M_1=2$, $M_2=3$,\n  - $E_{\\text{AB}}(M_1)=-34.95$, $E_{\\text{AB}}(M_2)=-34.9851851852$,\n  - $E_{\\text{A}}(M_1)=-33.425$, $E_{\\text{A}}(M_2)=-33.4777777778$,\n  - $E_{\\text{B}}(M_1)=-1.3625$, $E_{\\text{B}}(M_2)=-1.3888888889$,\n  - $E_{\\text{A}}^{\\text{ghost}}(M_2)=-33.4817778$, $E_{\\text{B}}^{\\text{ghost}}(M_2)=-1.3894889$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, with each $\\Delta E_{\\text{ads}}$ in eV rounded to six decimal places, for example, $[x_1,x_2,x_3,x_4]$.", "solution": "The problem is centered on the analysis of electronic energy convergence with respect to the size of the basis set. The total energy $E(M)$ for a system, calculated using a basis set of cardinal number $M$, is modeled by the empirical asymptotic formula:\n$$E(M) = E_{\\infty} + A M^{-p}$$\nIn this equation, $E_{\\infty}$ represents the complete-basis-set (CBS) limit energy, which is the theoretical energy that would be obtained with an infinitely large basis set. $A$ is a system-specific prefactor, and $p$ is an exponent that characterizes the rate of convergence. The variational principle of quantum mechanics underpins this model, ensuring that for a ground state, the calculated energy is always an upper bound to the true energy, i.e., $E(M) \\ge E_{\\infty}$.\n\n**1. Derivation of the Complete-Basis-Set (CBS) Extrapolation Formula**\n\nWe are tasked to derive an expression for $E_{\\infty}$ using two energy calculations, $E(M_1)$ and $E(M_2)$, performed with basis sets of cardinal numbers $M_1$ and $M_2$ respectively, given a known exponent $p$.\n\nThese two calculations provide a system of two equations with two unknowns, $E_{\\infty}$ and $A$:\n$$E(M_1) = E_{\\infty} + A M_1^{-p} \\quad (1)$$\n$$E(M_2) = E_{\\infty} + A M_2^{-p} \\quad (2)$$\n\nOur objective is to eliminate the unknown prefactor $A$ and solve for $E_{\\infty}$. We can achieve this by first rearranging both equations to isolate the term with $A$:\nFrom equation (1):\n$$A M_1^{-p} = E(M_1) - E_{\\infty}$$\n$$A = (E(M_1) - E_{\\infty}) M_1^p \\quad (3)$$\n\nFrom equation (2):\n$$A M_2^{-p} = E(M_2) - E_{\\infty}$$\n$$A = (E(M_2) - E_{\\infty}) M_2^p \\quad (4)$$\n\nSince both expressions (3) and (4) are equal to $A$, we can set them equal to each other:\n$$(E(M_1) - E_{\\infty}) M_1^p = (E(M_2) - E_{\\infty}) M_2^p$$\n\nNext, we expand the terms and rearrange the equation to group terms involving $E_{\\infty}$:\n$$E(M_1) M_1^p - E_{\\infty} M_1^p = E(M_2) M_2^p - E_{\\infty} M_2^p$$\n\nMoving all terms containing $E_{\\infty}$ to the left-hand side and all other terms to the right-hand side yields:\n$$E_{\\infty} M_2^p - E_{\\infty} M_1^p = E(M_2) M_2^p - E(M_1) M_1^p$$\n\nWe can then factor out $E_{\\infty}$:\n$$E_{\\infty} (M_2^p - M_1^p) = E(M_2) M_2^p - E(M_1) M_1^p$$\n\nFinally, assuming $M_1 \\neq M_2$, we can isolate $E_{\\infty}$ by dividing by the factor $(M_2^p - M_1^p)$:\n$$E_{\\infty} = \\frac{E(M_2) M_2^p - E(M_1) M_1^p}{M_2^p - M_1^p}$$\nThis is the well-established two-point extrapolation formula used to estimate the CBS limit energy from two finite-basis-set calculations.\n\n**2. Computational Procedure**\n\nThe overall task is to compute the quantity $\\Delta E_{\\text{ads}} = E_{\\text{ads}}^{\\text{CP}}(M_2) - E_{\\text{ads}}^{\\text{CBS}}$ for each test case. This involves calculating two distinct adsorption energies: the counterpoise-corrected energy at basis size $M_2$ and the estimated CBS limit energy.\n\nFirst, we compute the CBS limit of the adsorption energy, $E_{\\text{ads}}^{\\text{CBS}}$. By its definition:\n$$E_{\\text{ads}}^{\\text{CBS}} = E_{\\text{AB},\\infty} - E_{\\text{A},\\infty} - E_{\\text{B},\\infty}$$\nFor each species $X \\in \\{\\text{AB}, \\text{A}, \\text{B}\\}$, we employ the derived extrapolation formula to determine its CBS limit energy, $E_{X,\\infty}$:\n$$E_{X,\\infty} = \\frac{E_X(M_2) M_2^p - E_X(M_1) M_1^p}{M_2^p - M_1^p}$$\nThis calculation requires the energies $E_X(M_1)$ and $E_X(M_2)$, the basis cardinal numbers $M_1$ and $M_2$, and the exponent $p$, all of which are provided for each test case.\n\nSecond, we compute the counterpoise-corrected adsorption energy, $E_{\\text{ads}}^{\\text{CP}}(M_2)$, at the larger basis set level $M_2$. Its definition is given as:\n$$E_{\\text{ads}}^{\\text{CP}}(M_2) = E_{\\text{AB}}(M_2) - E_{\\text{A}}^{\\text{ghost}}(M_2) - E_{\\text{B}}^{\\text{ghost}}(M_2)$$\nAll required energies on the right-hand side—$E_{\\text{AB}}(M_2)$, $E_{\\text{A}}^{\\text{ghost}}(M_2)$, and $E_{\\text{B}}^{\\text{ghost}}(M_2)$—are directly provided in the problem statement for each test case. The \"ghost\" basis calculation is a standard technique (the Boys-Bernardi counterpoise correction) designed to mitigate the basis set superposition error (BSSE), which is an artificial stabilization of the adsorbate-surface complex arising from the monomers \"borrowing\" basis functions from each other in the dimer calculation.\n\nFinally, we compute the difference $\\Delta E_{\\text{ads}}$:\n$$\\Delta E_{\\text{ads}} = E_{\\text{ads}}^{\\text{CP}}(M_2) - E_{\\text{ads}}^{\\text{CBS}}$$\nThe sign of $\\Delta E_{\\text{ads}}$ provides insight into whether the counterpoise correction at level $M_2$ over-corrects or under-corrects the BSSE relative to the true CBS limit.\n- If $\\Delta E_{\\text{ads}} > 0$, then $E_{\\text{ads}}^{\\text{CP}}(M_2) > E_{\\text{ads}}^{\\text{CBS}}$. Since adsorption energies are typically negative, this means the corrected energy is less negative (weaker binding) than the CBS limit, a situation referred to as \"over-correction\".\n- If $\\Delta E_{\\text{ads}}  0$, then $E_{\\text{ads}}^{\\text{CP}}(M_2)  E_{\\text{ads}}^{\\text{CBS}}$. The corrected energy is more negative (stronger binding) than the CBS limit, referred to as \"under-correction\".\n- If $\\Delta E_{\\text{ads}} = 0$, the correction perfectly balances the residual basis set incompleteness error at level $M_2$.\n\nAn algorithm will be implemented to apply this entire procedure to each test case, calculate $\\Delta E_{\\text{ads}}$, round the result to six decimal places, and format the collective results into the specified output string.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the difference between counterpoise-corrected and CBS-extrapolated\n    adsorption energies for a given test suite.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1: p=4, M1=3, M2=4\n        {\n            'p': 4, 'M1': 3, 'M2': 4,\n            'E_AB_pts': (-21.117037037037, -21.1190625),\n            'E_A_pts': (-19.796296296296, -19.798828125),\n            'E_B_pts': (-1.249259259259, -1.249765625),\n            'E_A_ghost_M2': -19.799628125,\n            'E_B_ghost_M2': -1.249965625\n        },\n        # Case 2: p=4, M1=3, M2=4\n        {\n            'p': 4, 'M1': 3, 'M2': 4,\n            'E_AB_pts': (-15.198148148148, -15.1994140625),\n            'E_A_pts': (-13.997777777778, -13.999296875),\n            'E_B_pts': (-1.11962962963, -1.1198828125),\n            'E_A_ghost_M2': -13.999396875,\n            'E_B_ghost_M2': -1.1199028125\n        },\n        # Case 3: p=5, M1=3, M2=5\n        {\n            'p': 5, 'M1': 3, 'M2': 5,\n            'E_AB_pts': (-7.319670781893, -7.3199744),\n            'E_A_pts': (-6.19975308642, -6.1999808),\n            'E_B_pts': (-1.09991736227, -1.0999936),\n            'E_A_ghost_M2': -6.1999958,\n            'E_B_ghost_M2': -1.0999976\n        },\n        # Case 4: p=3, M1=2, M2=3\n        {\n            'p': 3, 'M1': 2, 'M2': 3,\n            'E_AB_pts': (-34.95, -34.9851851852),\n            'E_A_pts': (-33.425, -33.4777777778),\n            'E_B_pts': (-1.3625, -1.3888888889),\n            'E_A_ghost_M2': -33.4817778,\n            'E_B_ghost_M2': -1.3894889\n        }\n    ]\n\n    def extrapolate_cbs(e1, m1, e2, m2, p):\n        \"\"\"\n        Calculates the CBS limit energy using the two-point extrapolation formula.\n        E_inf = (E(M2)*M2^p - E(M1)*M1^p) / (M2^p - M1^p)\n        \"\"\"\n        m1_p = np.power(float(m1), float(p))\n        m2_p = np.power(float(m2), float(p))\n        numerator = e2 * m2_p - e1 * m1_p\n        denominator = m2_p - m1_p\n        return numerator / denominator\n\n    results = []\n    for case in test_cases:\n        p = case['p']\n        m1 = case['M1']\n        m2 = case['M2']\n\n        # Unpack energy points\n        e_ab_m1, e_ab_m2 = case['E_AB_pts']\n        e_a_m1, e_a_m2 = case['E_A_pts']\n        e_b_m1, e_b_m2 = case['E_B_pts']\n\n        # 1. Extrapolate to find CBS limit for each component\n        e_ab_inf = extrapolate_cbs(e_ab_m1, m1, e_ab_m2, m2, p)\n        e_a_inf = extrapolate_cbs(e_a_m1, m1, e_a_m2, m2, p)\n        e_b_inf = extrapolate_cbs(e_b_m1, m1, e_b_m2, m2, p)\n\n        # 2. Compute CBS adsorption energy\n        # E_ads_CBS = E_AB_inf - E_A_inf - E_B_inf\n        e_ads_cbs = e_ab_inf - e_a_inf - e_b_inf\n\n        # 3. Compute counterpoise-corrected adsorption energy at M2\n        # E_ads_CP(M2) = E_AB(M2) - E_A_ghost(M2) - E_B_ghost(M2)\n        e_a_ghost_m2 = case['E_A_ghost_M2']\n        e_b_ghost_m2 = case['E_B_ghost_M2']\n        e_ads_cp_m2 = e_ab_m2 - e_a_ghost_m2 - e_b_ghost_m2\n\n        # 4. Compute the difference Delta_E_ads\n        # Delta_E_ads = E_ads_CP(M2) - E_ads_CBS\n        delta_e_ads = e_ads_cp_m2 - e_ads_cbs\n        results.append(delta_e_ads)\n\n    # Final print statement in the exact required format.\n    # The output format string \"{:.6f}\" handles rounding to 6 decimal places.\n    formatted_results = [f\"{res:.6f}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "3434543"}, {"introduction": "The principles of basis set error extend directly to solid-state simulations, where they can affect key material properties like defect formation energies. This final practice applies your knowledge to a periodic supercell calculation, a standard technique in computational materials science, to explore how BSSE scales with the size of the simulation cell [@problem_id:3434554]. You will perform a scaling analysis to extract a power-law decay exponent, connecting the magnitude of the BSSE to the spatial localization of the defect's electronic state. This exercise develops a crucial skill for ensuring the convergence and reliability of calculations in periodic systems.", "problem": "Consider a periodic supercell calculation of a point defect in a crystalline solid using atom-centered basis functions. Basis set incompleteness leads to Basis Set Superposition Error (BSSE), which can bias the computed total energy when fragments or sites borrow basis functions from each other. In the counterpoise method adapted to periodic solids, ghost basis functions (basis functions placed at lattice sites without associated electrons or nuclei) are introduced to quantify this bias. The defect formation energy $E_f$ is defined from total energy differences, and BSSE is isolated by comparing $E_f$ computed with and without ghost basis functions placed at the defect site. For a localized defect state, the BSSE contribution is expected to decay with supercell linear size $L$ due to the spatial confinement of the localized region and the diminishing overlap with basis functions at increasingly distant lattice sites.\n\nStarting from the definition of formation energy as a difference of total energies and the principle that linear size scaling enters through the spatial domain available for basis-set borrowing in a supercell, you must write a program that, for each test case, performs the following steps:\n\n1. Compute the BSSE contribution to the defect formation energy for each supercell size $L$ by taking the difference between the formation energy without ghost basis functions and the formation energy with ghost basis functions, i.e., $\\Delta E_f^{\\text{BSSE}}(L) = E_f^{\\text{no-ghost}}(L) - E_f^{\\text{ghost}}(L)$. Use the absolute value $|\\Delta E_f^{\\text{BSSE}}(L)|$ in the analysis.\n2. Model the scaling $|\\Delta E_f^{\\text{BSSE}}(L)|$ as a power law $c L^{-\\alpha}$ that may arise from localization effects of defect states and diminishing basis-set borrowing with distance.\n3. Estimate the scaling exponent $\\alpha$ from the provided data for $L$ by using a principled transformation consistent with power-law models and report the resulting $\\alpha$ for each test case.\n4. All energies are provided and must be treated in electronvolts (eV). The supercell size parameter $L$ is a dimensionless linear replication factor (number of primitive cells along one lattice vector).\n5. Your program must produce a single line of output containing the estimated exponents for all test cases, formatted as a comma-separated list enclosed in square brackets, with each float rounded to three decimal places, e.g., \"[$\\alpha_1$,$\\alpha_2$,$\\alpha_3$]\".\n\nUse the following test suite, each comprising a set of $L$ values and corresponding formation energies with and without ghost basis functions:\n\n- Test case A (localized defect with three-dimensional decay):\n  - Supercell sizes: $L \\in \\{2,3,4,5,6\\}$.\n  - Formation energies with ghost basis functions: $E_f^{\\text{ghost}}(L) = 3.250 \\text{ eV}$ for all $L$.\n  - Formation energies without ghost basis functions: $E_f^{\\text{no-ghost}}(2) = 3.2625 \\text{ eV}$, $E_f^{\\text{no-ghost}}(3) = 3.2537037 \\text{ eV}$, $E_f^{\\text{no-ghost}}(4) = 3.2515625 \\text{ eV}$, $E_f^{\\text{no-ghost}}(5) = 3.2508 \\text{ eV}$, $E_f^{\\text{no-ghost}}(6) = 3.250462962963 \\text{ eV}$.\n\n- Test case B (milder decay characteristic of extended elastic fields):\n  - Supercell sizes: $L \\in \\{4,8,12,16,20\\}$.\n  - Formation energies with ghost basis functions: $E_f^{\\text{ghost}}(L) = 5.100 \\text{ eV}$ for all $L$.\n  - Formation energies without ghost basis functions: $E_f^{\\text{no-ghost}}(4) = 5.1125 \\text{ eV}$, $E_f^{\\text{no-ghost}}(8) = 5.10625 \\text{ eV}$, $E_f^{\\text{no-ghost}}(12) = 5.104166666667 \\text{ eV}$, $E_f^{\\text{no-ghost}}(16) = 5.103125 \\text{ eV}$, $E_f^{\\text{no-ghost}}(20) = 5.1025 \\text{ eV}$.\n\n- Test case C (very small BSSE with alternating sign due to subtle basis-set interference; analysis uses absolute values):\n  - Supercell sizes: $L \\in \\{3,5,7,9,11\\}$.\n  - Formation energies with ghost basis functions: $E_f^{\\text{ghost}}(L) = 2.000 \\text{ eV}$ for all $L$.\n  - Formation energies without ghost basis functions: $E_f^{\\text{no-ghost}}(3) = 2.00024691358 \\text{ eV}$, $E_f^{\\text{no-ghost}}(5) = 1.999968 \\text{ eV}$, $E_f^{\\text{no-ghost}}(7) = 2.00000832903 \\text{ eV}$, $E_f^{\\text{no-ghost}}(9) = 1.999996952 \\text{ eV}$, $E_f^{\\text{no-ghost}}(11) = 2.000001366 \\text{ eV}$.\n\nAlgorithmic constraints:\n\n- Treat any $|\\Delta E_f^{\\text{BSSE}}(L)|$ values smaller than $10^{-12} \\text{ eV}$ as numerically negligible and exclude them from the scaling analysis to avoid taking logarithms of zero.\n- Use a deterministic method that does not depend on random choices.\n- Express the final output in the required single-line format. Each reported $\\alpha$ must be a float rounded to three decimal places.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[$\\alpha_{\\text{A}}$,$\\alpha_{\\text{B}}$,$\\alpha_{\\text{C}}$]\").", "solution": "The core of the problem is to determine the scaling exponent $\\alpha$ for the Basis Set Superposition Error (BSSE) as a function of the supercell linear size $L$. The BSSE is modeled by a power law:\n$$\n|\\Delta E_f^{\\text{BSSE}}(L)| = c L^{-\\alpha}\n$$\nwhere $|\\Delta E_f^{\\text{BSSE}}(L)|$ is the magnitude of the BSSE contribution to the defect formation energy, $c$ is a constant, and $\\alpha$ is the scaling exponent to be determined.\n\nTo find $\\alpha$, we can linearize this power-law relationship by taking the natural logarithm of both sides of the equation:\n$$\n\\ln\\left(|\\Delta E_f^{\\text{BSSE}}(L)|\\right) = \\ln\\left(c L^{-\\alpha}\\right)\n$$\nUsing the properties of logarithms, this expression simplifies to:\n$$\n\\ln\\left(|\\Delta E_f^{\\text{BSSE}}(L)|\\right) = \\ln(c) - \\alpha \\ln(L)\n$$\nThis equation is in the form of a straight line, $y = mx + b$, where:\n- The dependent variable is $y = \\ln(|\\Delta E_f^{\\text{BSSE}}(L)|)$.\n- The independent variable is $x = \\ln(L)$.\n- The slope of the line is $m = -\\alpha$.\n- The y-intercept is $b = \\ln(c)$.\n\nTherefore, the scaling exponent $\\alpha$ can be determined by performing a linear regression on the data points $(\\ln(L), \\ln(|\\Delta E_f^{\\text{BSSE}}(L)|))$ and calculating $\\alpha$ from the resulting slope $m$ as $\\alpha = -m$.\n\nThe procedure for each test case is as follows:\n\n1.  **Compute the BSSE Contribution**: For each supercell size $L_i$ in a given test case, calculate the BSSE contribution to the formation energy using the provided data:\n    $$\n    \\Delta E_f^{\\text{BSSE}}(L_i) = E_f^{\\text{no-ghost}}(L_i) - E_f^{\\text{ghost}}(L_i)\n    $$\n\n2.  **Prepare Data for Regression**:\n    - Take the absolute value of the BSSE, $y'_i = |\\Delta E_f^{\\text{BSSE}}(L_i)|$.\n    - According to the problem's constraint, filter out any data pairs $(L_i, y'_i)$ for which $y'_i  10^{-12} \\text{ eV}$.\n    - Transform the remaining data points by taking the natural logarithm to create the sets for linear regression: $x_i = \\ln(L_i)$ and $y_i = \\ln(y'_i)$.\n\n3.  **Perform Linear Regression**: Use a standard numerical method to find the slope $m$ of the best-fit line for the data points $(x_i, y_i)$. The `numpy.polyfit` function is suitable for this task, fitting a polynomial of degree $1$. It returns the coefficients $[m, b]$ for the line $y = mx + b$.\n\n4.  **Calculate the Exponent**: The scaling exponent is then found by taking the negative of the slope:\n    $$\n    \\alpha = -m\n    $$\n\nThis procedure is applied to each of the three test cases provided.\n\n**Test Case A: Localized defect with three-dimensional decay**\n- Supercell sizes: $L \\in \\{2, 3, 4, 5, 6\\}$.\n- $E_f^{\\text{ghost}}(L) = 3.250 \\text{ eV}$.\n- The values for $|\\Delta E_f^{\\text{BSSE}}(L)|$ are calculated as $|\\Delta E_f^{\\text{BSSE}}(2)| = |3.2625 - 3.250| = 0.0125 \\text{ eV}$, $|\\Delta E_f^{\\text{BSSE}}(3)| = |3.2537037 - 3.250| \\approx 0.0037037 \\text{ eV}$, and so on. All calculated values are greater than $10^{-12} \\text{ eV}$ and are included in the fit. Linear regression on $(\\ln(L), \\ln(|\\Delta E_f^{\\text{BSSE}}(L)|))$ is performed to find the slope, and $\\alpha_A$ is computed.\n\n**Test Case B: Milder decay characteristic of extended elastic fields**\n- Supercell sizes: $L \\in \\{4, 8, 12, 16, 20\\}$.\n- $E_f^{\\text{ghost}}(L) = 5.100 \\text{ eV}$.\n- The values for $|\\Delta E_f^{\\text{BSSE}}(L)|$ are calculated, e.g., $|\\Delta E_f^{\\text{BSSE}}(4)| = |5.1125 - 5.100| = 0.0125 \\text{ eV}$. All values are greater than $10^{-12} \\text{ eV}$. Linear regression is performed to find the slope, and $\\alpha_B$ is computed.\n\n**Test Case C: Small BSSE with alternating sign**\n- Supercell sizes: $L \\in \\{3, 5, 7, 9, 11\\}$.\n- $E_f^{\\text{ghost}}(L) = 2.000 \\text{ eV}$.\n- The values for $|\\Delta E_f^{\\text{BSSE}}(L)|$ are calculated, e.g., $|\\Delta E_f^{\\text{BSSE}}(3)| = |2.00024691358 - 2.000| \\approx 2.47 \\times 10^{-4} \\text{ eV}$ and $|\\Delta E_f^{\\text{BSSE}}(5)| = |1.999968 - 2.000| = 3.2 \\times 10^{-5} \\text{ eV}$. All absolute values are greater than $10^{-12} \\text{ eV}$. Linear regression is used to find the slope, and $\\alpha_C$ is computed.\n\nThe final output will compile the computed exponents $[\\alpha_A, \\alpha_B, \\alpha_C]$, formatted as requested.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the scaling exponent alpha for BSSE decay in supercell calculations.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"name\": \"Case A\",\n            \"L\": np.array([2, 3, 4, 5, 6]),\n            \"E_ghost\": np.array([3.250, 3.250, 3.250, 3.250, 3.250]),\n            \"E_noghost\": np.array([3.2625, 3.2537037, 3.2515625, 3.2508, 3.250462962963])\n        },\n        {\n            \"name\": \"Case B\",\n            \"L\": np.array([4, 8, 12, 16, 20]),\n            \"E_ghost\": np.array([5.100, 5.100, 5.100, 5.100, 5.100]),\n            \"E_noghost\": np.array([5.1125, 5.10625, 5.104166666667, 5.103125, 5.1025])\n        },\n        {\n            \"name\": \"Case C\",\n            \"L\": np.array([3, 5, 7, 9, 11]),\n            \"E_ghost\": np.array([2.000, 2.000, 2.000, 2.000, 2.000]),\n            \"E_noghost\": np.array([2.00024691358, 1.999968, 2.00000832903, 1.999996952, 2.000001366])\n        }\n    ]\n\n    results = []\n    \n    # Numerical tolerance for filtering data\n    tolerance = 1e-12\n\n    for case in test_cases:\n        # Step 1: Compute the BSSE contribution and take its absolute value\n        delta_E_bsse = np.abs(case[\"E_noghost\"] - case[\"E_ghost\"])\n        L_vals = case[\"L\"]\n\n        # Step 2: Filter out numerically negligible values\n        mask = delta_E_bsse = tolerance\n        \n        filtered_L = L_vals[mask]\n        filtered_delta_E = delta_E_bsse[mask]\n\n        # Prepare for linear regression by taking logarithms\n        # x = ln(L), y = ln(|delta_E|)\n        log_L = np.log(filtered_L)\n        log_delta_E = np.log(filtered_delta_E)\n\n        # Step 3: Perform linear regression to find the slope m\n        # The model is ln(|delta_E|) = ln(c) - alpha * ln(L)\n        # This is a line y = mx + b, where y = ln(|delta_E|), x = ln(L), and slope m = -alpha.\n        # np.polyfit(x, y, 1) returns [slope, intercept]\n        slope, _ = np.polyfit(log_L, log_delta_E, 1)\n\n        # Step 4: Calculate the scaling exponent alpha\n        alpha = -slope\n        results.append(alpha)\n\n    # Final print statement in the exact required format.\n    # Format each float to three decimal places.\n    formatted_results = [f\"{res:.3f}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "3434554"}]}