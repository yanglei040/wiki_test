{"hands_on_practices": [{"introduction": "This first exercise grounds our understanding of the quasiharmonic approximation by connecting the macroscopic thermal expansion coefficient to microscopic vibrational properties. You will perform an analytical derivation in the high-temperature classical limit, building intuition for how the Grüneisen parameter, $\\gamma$, acts as the crucial link between volume change and vibrational energy. This practice solidifies the core thermodynamic relationships that underpin the QHA model. [@problem_id:440973]", "problem": "A simple isotropic crystalline solid is modeled using the quasiharmonic approximation. In this model, the phonon frequencies $\\omega_i$ depend on the crystal volume $V$. This dependence is characterized by a single, mode-independent Grüneisen parameter, $\\gamma$, defined as $\\gamma = -\\frac{d(\\ln \\omega_i)}{d(\\ln V)}$. The crystal is composed of $N$ atoms in a volume $V$, has an isothermal bulk modulus $B_T$, and is maintained at a temperature $T$ that is high enough for the classical Dulong-Petit law for the heat capacity to be a valid approximation. The behavior of the crystal is governed by the principles of statistical mechanics and thermodynamics. What is the linear thermal expansion coefficient $\\alpha_L$ of this solid? Express your answer in terms of $\\gamma$, $B_T$, the atomic number density $n=N/V$, and the Boltzmann constant $k_B$.", "solution": "1. Vibrational free energy in the classical limit for 3N modes:\n$$F_{\\mathrm{vib}}=-k_BT\\sum_{i=1}^{3N}\\ln\\frac{k_BT}{\\hbar\\omega_i}.$$\n2. Thermal pressure \n$$p_{\\mathrm{th}}=-\\Bigl(\\frac{\\partial F_{\\mathrm{vib}}}{\\partial V}\\Bigr)_T\n=-k_BT\\sum_i\\frac{\\partial\\ln\\omega_i}{\\partial V}.$$\n3. Using $\\gamma=-\\dfrac{d\\ln\\omega_i}{d\\ln V}=-V\\frac{d\\ln\\omega_i}{dV}$ gives \n$$\\frac{\\partial\\ln\\omega_i}{\\partial V}=-\\frac{\\gamma}{V},$$\nso\n$$p_{\\mathrm{th}}=-k_BT\\,(3N)\\Bigl(-\\frac{\\gamma}{V}\\Bigr)\n=\\frac{3N\\gamma k_BT}{V}.$$\n4. Volumetric expansion coefficient \n$$\\alpha_V=\\frac{1}{B_T}\\Bigl(\\frac{\\partial p_{\\mathrm{th}}}{\\partial T}\\Bigr)_V\n=\\frac{1}{B_T}\\frac{3N\\gamma k_B}{V}\n=\\frac{3\\gamma n k_B}{B_T},$$\nwhere $n=N/V$.\n5. Linear expansion coefficient \n$$\\alpha_L=\\frac{\\alpha_V}{3}=\\frac{\\gamma n k_B}{B_T}.$$", "answer": "$$\\boxed{\\frac{\\gamma n k_B}{B_T}}$$", "id": "440973"}, {"introduction": "Moving beyond the classical picture, this computational practice explores the quantum nature of lattice vibrations at low temperatures. You will investigate the role of zero-point energy in determining a material's equilibrium volume even at absolute zero, a purely quantum effect that the classical model misses. This exercise demonstrates the predictive power of the QHA in capturing phenomena driven by quantum mechanics and prepares you to analyze materials in the low-temperature regime. [@problem_id:3483269]", "problem": "Consider a crystalline solid modeled within the Quasi-Harmonic Approximation (QHA), where the Helmholtz free energy $F(V,T)$ is written as the sum of a static lattice contribution and a vibrational contribution. The fundamental base is the thermodynamic definition of Helmholtz free energy $F(V,T)=U(V,T)-T S(V,T)$, the definition of equilibrium at zero external pressure as the condition that minimizes $F$ with respect to volume $V$ at fixed temperature $T$, and the Debye model for lattice vibrations. In the Debye model, the zero-point energy $E_{\\mathrm{ZP}}(V)$ is the $T=0$ limit of the vibrational energy, and the zero-point pressure is defined as $P_{\\mathrm{ZP}}(V)=-\\partial E_{\\mathrm{ZP}}(V)/\\partial V$. In the Grüneisen approximation, the Debye temperature scales with volume as $\\theta_{\\mathrm{D}}(V)=\\theta_{\\mathrm{D},0}\\left(V/V_{\\mathrm{el},0}\\right)^{-\\gamma}$, where $\\gamma$ is the (volume-independent) Grüneisen parameter and $V_{\\mathrm{el},0}$ is the static-lattice equilibrium volume at $T=0$ ignoring vibrations.\n\nYou are to implement a computational procedure that:\n- Derives, from first principles, the effect of the zero-point pressure on the equilibrium volume $V_0$ at $T=0$ by solving the equilibrium condition $\\partial F(V,0)/\\partial V=0$ with $F(V,0)=E_{\\mathrm{el}}(V)+E_{\\mathrm{ZP}}(V)$, where $E_{\\mathrm{el}}(V)$ is the static lattice energy approximated near $V_{\\mathrm{el},0}$ by a quadratic form consistent with the bulk modulus.\n- Determines the leading low-temperature coefficient for the volumetric thermal expansion $\\alpha(T)$ as $T\\to 0$ based on QHA and the Debye low-temperature asymptotics. Specifically, define a coefficient $A$ such that $\\alpha(T)\\sim A\\,T^3$ as $T\\to 0$; compute $A$ at the zero-point-renormalized $V_0$.\n\nModel assumptions and data to be used:\n1. The static lattice energy near its minimum is approximated as $E_{\\mathrm{el}}(V)\\approx E_{\\mathrm{ref}}+\\dfrac{K_0}{2 V_{\\mathrm{el},0}}\\left(V-V_{\\mathrm{el},0}\\right)^2$ and is to be evaluated in electronvolts per atom, where $K_0$ is the isothermal bulk modulus at $T=0$ (assumed constant in the narrow range of volumes considered). To ensure unit consistency, use the conversion factor $c_{\\mathrm{PV}\\to E}=$ $0.006241509074$ electronvolts per atom per $(\\mathrm{GPa}\\cdot\\text{\\AA}^3)$, so that pressure-volume products in $(\\mathrm{GPa}\\cdot\\text{\\AA}^3)$ are converted to electronvolts per atom by multiplying by $c_{\\mathrm{PV}\\to E}$.\n2. The zero-point energy in the Debye model per atom is $E_{\\mathrm{ZP}}(V)=\\dfrac{9}{8} k_{\\mathrm{B}}\\,\\theta_{\\mathrm{D}}(V)$, with $k_{\\mathrm{B}}=$ $8.617333262\\times 10^{-5}$ electronvolts per Kelvin.\n3. The Grüneisen parameter $\\gamma$ is treated as volume-independent, and the Debye temperature scales as $\\theta_{\\mathrm{D}}(V)=\\theta_{\\mathrm{D},0}\\left(V/V_{\\mathrm{el},0}\\right)^{-\\gamma}$.\n4. The leading low-temperature behavior of the constant-volume specific heat in the Debye model is $C_V(T)\\sim \\dfrac{12\\pi^4}{5}\\,k_{\\mathrm{B}}\\left(\\dfrac{T}{\\theta_{\\mathrm{D}}(V)}\\right)^3$ per atom as $T\\to 0$.\n\nYour program must, for each parameter set, perform the following steps:\n- Compute the $T=0$ equilibrium volume $V_0$ by solving $\\partial E_{\\mathrm{el}}(V)/\\partial V+\\partial E_{\\mathrm{ZP}}(V)/\\partial V=0$ for $V$, using the energy forms specified above and ensuring unit consistency. Work per atom, with $V$ in $\\text{\\AA}^3$ per atom, $E$ in electronvolts per atom, and pressure in electronvolts per atom per $\\text{\\AA}^3$.\n- Compute the fractional volume change $\\Delta V/V_{\\mathrm{el},0}=\\left(V_0-V_{\\mathrm{el},0}\\right)/V_{\\mathrm{el},0}$ induced by zero-point pressure at $T=0$.\n- Derive and compute the low-temperature coefficient $A$ such that $\\alpha(T)\\sim A\\,T^3$ as $T\\to 0$, expressed in $\\mathrm{K}^{-4}$. Use the QHA relation between thermal expansion and thermodynamic derivatives, together with the Debye low-temperature asymptotics, evaluated at the zero-point-renormalized $V_0$ with $\\theta_{\\mathrm{D}}(V_0)$, and take the isothermal bulk modulus entering the coefficient as $K_0$ (in $\\mathrm{GPa}$) converted appropriately through $K_0 V_0 c_{\\mathrm{PV}\\to E}$ to maintain units in electronvolts per atom.\n\nPhysical units and output requirements:\n- Volumes must be in $\\text{\\AA}^3$ per atom.\n- The coefficient $A$ must be reported in $\\mathrm{K}^{-4}$.\n- The fractional change $\\Delta V/V_{\\mathrm{el},0}$ is dimensionless and should be reported as a decimal.\n- Round $\\Delta V/V_{\\mathrm{el},0}$ to $6$ decimal places, $V_0$ to $6$ decimal places, and $A$ to $12$ decimal places.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each test case contributes a sublist of the form $[\\Delta V/V_{\\mathrm{el},0},V_0,A]$ with no spaces (e.g., $[[0.001234,5.123456,1.234567890123e-12],[...]]$).\n\nTest suite:\nUse the following four parameter sets, covering different regimes relevant to light elements and edge cases; all values are per atom:\n- Case $1$ (happy path, light element-like): $\\theta_{\\mathrm{D},0}=$ $1000$ $\\mathrm{K}$, $\\gamma=$ $1.2$, $K_0=$ $70$ $\\mathrm{GPa}$, $V_{\\mathrm{el},0}=$ $5.0$ $\\text{\\AA}^3$.\n- Case $2$ (heavier element-like): $\\theta_{\\mathrm{D},0}=$ $200$ $\\mathrm{K}$, $\\gamma=$ $1.5$, $K_0=$ $150$ $\\mathrm{GPa}$, $V_{\\mathrm{el},0}=$ $15.0$ $\\text{\\AA}^3$.\n- Case $3$ (boundary condition $\\gamma\\to 0$): $\\theta_{\\mathrm{D},0}=$ $600$ $\\mathrm{K}$, $\\gamma=$ $0.05$, $K_0=$ $100$ $\\mathrm{GPa}$, $V_{\\mathrm{el},0}=$ $10.0$ $\\text{\\AA}^3$.\n- Case $4$ (very stiff, very high Debye temperature): $\\theta_{\\mathrm{D},0}=$ $1200$ $\\mathrm{K}$, $\\gamma=$ $1.2$, $K_0=$ $300$ $\\mathrm{GPa}$, $V_{\\mathrm{el},0}=$ $5.0$ $\\text{\\AA}^3$.\n\nYour program must solve the equilibrium equation numerically for $V_0$ for each case, compute the requested quantities, and print the results in the exact format specified above.", "solution": "The problem requires the derivation and implementation of a computational procedure to analyze the effects of zero-point energy on the equilibrium volume and low-temperature thermal expansion of a crystalline solid within the Quasi-Harmonic Approximation (QHA). The derivation is performed from first principles as laid out in the problem statement.\n\n### Part 1: Derivation of the Equilibrium Volume at $T=0$\n\nThe equilibrium state of the crystal at zero temperature ($T=0$) and zero external pressure is determined by the minimum of the total energy per atom, $E(V)$, with respect to the volume per atom, $V$. The total energy is the sum of the static-lattice electronic energy, $E_{\\mathrm{el}}(V)$, and the vibrational zero-point energy, $E_{\\mathrm{ZP}}(V)$:\n$$\nF(V, T=0) = E(V) = E_{\\mathrm{el}}(V) + E_{\\mathrm{ZP}}(V)\n$$\nThe equilibrium condition is that the total pressure $P_{\\mathrm{tot}} = - \\partial E(V) / \\partial V$ is zero. This implies:\n$$\n\\frac{\\partial E(V)}{\\partial V} = \\frac{\\partial E_{\\mathrm{el}}(V)}{\\partial V} + \\frac{\\partial E_{\\mathrm{ZP}}(V)}{\\partial V} = 0\n$$\nThis equation can be expressed as the balance of the static-lattice pressure, $P_{\\mathrm{el}}(V) = -\\partial E_{\\mathrm{el}}/\\partial V$, and the zero-point pressure, $P_{\\mathrm{ZP}}(V) = -\\partial E_{\\mathrm{ZP}}/\\partial V$:\n$$\nP_{\\mathrm{el}}(V) + P_{\\mathrm{ZP}}(V) = 0\n$$\nWe derive the expressions for these two pressure components based on the provided models.\n\n**1. Static-Lattice Pressure, $P_{\\mathrm{el}}(V)$**\nThe static lattice energy is given by a quadratic approximation around its minimum at $V_{\\mathrm{el},0}$:\n$$\nE_{\\mathrm{el}}(V) \\approx E_{\\mathrm{ref}} + \\frac{K_0}{2 V_{\\mathrm{el},0}} (V-V_{\\mathrm{el},0})^2\n$$\nFor unit consistency, with energy in electronvolts (eV), volume in cubic angstroms ($\\text{\\AA}^3$), and the bulk modulus $K_0$ in gigapascals (GPa), the energy expression must incorporate the conversion factor $c_{\\mathrm{PV}\\to E} = 0.006241509074 \\, \\text{eV}/(\\text{GPa}\\cdot\\text{\\AA}^3)$. The term $K_0 \\cdot \\text{volume}$ has units of GPa$\\cdot\\text{\\AA}^3$, which is a pressure-volume product. The provided energy expression has units of $\\text{GPa} \\cdot \\text{\\AA}^3$. To convert it to eV per atom, we must multiply by $c_{\\mathrm{PV}\\to E}$:\n$$\nE_{\\mathrm{el}}(V) = E_{\\mathrm{ref}} + \\frac{K_0 c_{\\mathrm{PV}\\to E}}{2 V_{\\mathrm{el},0}} (V-V_{\\mathrm{el},0})^2\n$$\nThe static-lattice pressure is the negative derivative of this energy with respect to volume:\n$$\nP_{\\mathrm{el}}(V) = -\\frac{\\partial E_{\\mathrm{el}}}{\\partial V} = -\\frac{K_0 c_{\\mathrm{PV}\\to E}}{V_{\\mathrm{el},0}}(V-V_{\\mathrm{el},0})\n$$\nThe units of this pressure are $\\text{eV}/\\text{\\AA}^3$.\n\n**2. Zero-Point Pressure, $P_{\\mathrm{ZP}}(V)$**\nThe zero-point energy per atom in the Debye model is given by:\n$$\nE_{\\mathrm{ZP}}(V) = \\frac{9}{8} k_{\\mathrm{B}} \\theta_{\\mathrm{D}}(V)\n$$\nwhere $k_{\\mathrm{B}}$ is the Boltzmann constant and $\\theta_{\\mathrm{D}}(V)$ is the volume-dependent Debye temperature. Using the Grüneisen approximation, $\\theta_{\\mathrm{D}}(V)$ is given by:\n$$\n\\theta_{\\mathrm{D}}(V) = \\theta_{\\mathrm{D},0} \\left(\\frac{V}{V_{\\mathrm{el},0}}\\right)^{-\\gamma}\n$$\nwhere $\\gamma$ is the Grüneisen parameter. Substituting this into the energy expression:\n$$\nE_{\\mathrm{ZP}}(V) = \\frac{9}{8} k_{\\mathrm{B}} \\theta_{\\mathrm{D},0} \\left(\\frac{V}{V_{\\mathrm{el},0}}\\right)^{-\\gamma} = \\frac{9}{8} k_{\\mathrm{B}} \\theta_{\\mathrm{D},0} V_{\\mathrm{el},0}^{\\gamma} V^{-\\gamma}\n$$\nThe zero-point pressure is then:\n$$\nP_{\\mathrm{ZP}}(V) = -\\frac{\\partial E_{\\mathrm{ZP}}}{\\partial V} = -\\frac{9}{8} k_{\\mathrm{B}} \\theta_{\\mathrm{D},0} V_{\\mathrm{el},0}^{\\gamma} \\frac{d}{dV}(V^{-\\gamma}) = -\\frac{9}{8} k_{\\mathrm{B}} \\theta_{\\mathrm{D},0} V_{\\mathrm{el},0}^{\\gamma} (-\\gamma V^{-\\gamma-1})\n$$\n$$\nP_{\\mathrm{ZP}}(V) = \\frac{9 \\gamma k_{\\mathrm{B}} \\theta_{\\mathrm{D},0} V_{\\mathrm{el},0}^{\\gamma}}{8} V^{-\\gamma-1}\n$$\nThis expression can also be written compactly as $P_{\\mathrm{ZP}}(V) = \\gamma E_{\\mathrm{ZP}}(V) / V$.\n\n**3. Equilibrium Equation for $V_0$**\nThe equilibrium volume at $T=0$, denoted $V_0$, is the solution to $P_{\\mathrm{el}}(V_0) + P_{\\mathrm{ZP}}(V_0) = 0$:\n$$\n-\\frac{K_0 c_{\\mathrm{PV}\\to E}}{V_{\\mathrm{el},0}}(V_0-V_{\\mathrm{el},0}) + \\frac{9 \\gamma k_{\\mathrm{B}} \\theta_{\\mathrm{D},0} V_{\\mathrm{el},0}^{\\gamma}}{8} V_0^{-\\gamma-1} = 0\n$$\nThis is a nonlinear equation in $V_0$ that must be solved numerically. The zero-point pressure term is typically positive for $\\gamma>0$, which counteracts the negative static pressure for $V > V_{\\mathrm{el},0}$, leading to an equilibrium volume $V_0 > V_{\\mathrm{el},0}$.\n\n### Part 2: Derivation of the Low-Temperature Thermal Expansion Coefficient\n\nThe volumetric thermal expansion coefficient $\\alpha(T)$ is defined as $\\alpha(T) = \\frac{1}{V} \\left( \\frac{\\partial V}{\\partial T} \\right)_P$. Using a standard Maxwell relation and thermodynamic identities, it can be expressed as:\n$$\n\\alpha(T) = \\frac{1}{K_T} \\left( \\frac{\\partial S}{\\partial V} \\right)_T\n$$\nwhere $K_T = -V(\\partial P/\\partial V)_T$ is the isothermal bulk modulus and $S$ is the entropy. Within the QHA, the vibrational entropy $S(V,T)$ depends on volume only through the scaling of phonon frequencies, encapsulated by $\\theta_{\\mathrm{D}}(V)$. This dependency leads to the general relation:\n$$\n\\left( \\frac{\\partial S}{\\partial V} \\right)_T = \\frac{\\gamma C_V}{V}\n$$\nwhere $C_V = T(\\partial S/\\partial T)_V$ is the constant-volume heat capacity. Substituting this into the expression for $\\alpha(T)$ gives the Grüneisen equation of state:\n$$\n\\alpha(T) = \\frac{\\gamma C_V(V,T)}{V K_T(V,T)}\n$$\nWe are interested in the low-temperature limit ($T \\to 0$). In this limit, the Debye model provides the asymptotic behavior of the heat capacity per atom:\n$$\nC_V(T) \\sim \\frac{12\\pi^4}{5} k_{\\mathrm{B}} \\left( \\frac{T}{\\theta_{\\mathrm{D}}(V)} \\right)^3\n$$\nSubstituting this into the expression for $\\alpha(T)$, and evaluating at the zero-point renormalized volume $V_0$ and corresponding zero-temperature bulk modulus $K_0$:\n$$\n\\alpha(T) \\sim \\frac{\\gamma}{V_0 K_0} \\left[ \\frac{12\\pi^4}{5} k_{\\mathrm{B}} \\left( \\frac{T}{\\theta_{\\mathrm{D}}(V_0)} \\right)^3 \\right] = \\left[ \\frac{\\gamma}{V_0 K_0} \\frac{12\\pi^4 k_{\\mathrm{B}}}{5 \\, \\theta_{\\mathrm{D}}(V_0)^3} \\right] T^3\n$$\nThe problem specifies that $\\alpha(T) \\sim A T^3$. By comparison, the coefficient $A$ is:\n$$\nA = \\frac{\\gamma}{V_0 K_0} \\frac{12\\pi^4 k_{\\mathrm{B}}}{5 \\, \\theta_{\\mathrm{D}}(V_0)^3}\n$$\nTo ensure correct units of $\\text{K}^{-4}$ for $A$, the denominator term $V_0 K_0$, which has units of energy, must be expressed in eV. As instructed, this is achieved by computing it as $K_0 V_0 c_{\\mathrm{PV}\\to E}$, where $K_0$ is in GPa and $V_0$ in $\\text{\\AA}^3$.\n$$\nA = \\frac{\\gamma}{K_0 V_0 c_{\\mathrm{PV}\\to E}} \\frac{12\\pi^4 k_{\\mathrm{B}}}{5 \\, \\theta_{\\mathrm{D}}(V_0)^3}\n$$\nIn this expression, $\\theta_{\\mathrm{D}}(V_0)$ is the Debye temperature evaluated at the previously computed equilibrium volume $V_0$:\n$$\n\\theta_{\\mathrm{D}}(V_0) = \\theta_{\\mathrm{D},0} \\left(\\frac{V_0}{V_{\\mathrm{el},0}}\\right)^{-\\gamma}\n$$\nThe computational procedure will first solve for $V_0$ numerically and then substitute it into the derived formula for $A$.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import optimize\n\ndef solve():\n    \"\"\"\n    Solves the quasiharmonic approximation problem for several test cases.\n    \"\"\"\n    # Define physical constants\n    k_B = 8.617333262e-5  # Boltzmann constant in eV/K\n    c_PV_to_E = 0.006241509074  # Conversion factor from GPa*A^3 to eV\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (theta_D_0 [K], gamma, K0 [GPa], V_el_0 [A^3/atom])\n        (1000.0, 1.2, 70.0, 5.0),   # Case 1\n        (200.0, 1.5, 150.0, 15.0),  # Case 2\n        (600.0, 0.05, 100.0, 10.0), # Case 3\n        (1200.0, 1.2, 300.0, 5.0),  # Case 4\n    ]\n\n    results = []\n    for params in test_cases:\n        theta_D_0, gamma, K0, V_el_0 = params\n\n        # Part 1: Compute the T=0 equilibrium volume V0\n        \n        # Define the function whose root we need to find.\n        # This function represents P_el(V) + P_zp(V) = 0\n        def total_pressure_equation(V):\n            # Static lattice pressure in eV/A^3\n            P_el = - (K0 * c_PV_to_E / V_el_0) * (V - V_el_0)\n\n            # Zero-point pressure in eV/A^3\n            if gamma == 0:\n                P_zp = 0.0\n            else:\n                # P_zp = gamma * E_zp / V\n                # E_zp = (9/8) * k_B * theta_D_0 * (V / V_el_0)^(-gamma)\n                P_zp_term1 = 9.0 / 8.0 * k_B * theta_D_0 * gamma\n                P_zp_term2 = (V / V_el_0)**(-gamma)\n                P_zp = P_zp_term1 * P_zp_term2 / V\n                \n                # Alternate formulation from derivation:\n                P_zp_alt = (9.0 * gamma * k_B * theta_D_0 * (V_el_0**gamma)) / (8.0 * V**(gamma + 1.0))\n                # Using the alternate formulation to avoid V/V issues numerically\n                # and to be explicit.\n                P_zp = P_zp_alt\n\n\n            return P_el + P_zp\n\n        # The root must be slightly larger than V_el_0 for gamma  0.\n        # For gamma=0, V0 = V_el_0.\n        # We need a safe bracket for the root finder.\n        # At V=V_el_0, the function is negative (or zero if gamma=0).\n        # We need an upper bound where the function is positive.\n        v_low = V_el_0\n        v_high = V_el_0 * 1.5  # A large, safe upper bound\n\n        # Handle the edge case of gamma = 0, where V0 = V_el_0.\n        if gamma == 0.0:\n            V0 = V_el_0\n        else:\n            # Solve for V0 numerically\n            sol = optimize.root_scalar(total_pressure_equation, bracket=[v_low, v_high], method='brentq')\n            V0 = sol.root\n\n        # Part 2: Compute fractional volume change\n        dV_V = (V0 - V_el_0) / V_el_0\n\n        # Part 3: Compute low-temperature thermal expansion coefficient A\n\n        # Debye temperature at the new equilibrium volume V0\n        theta_D_V0 = theta_D_0 * (V0 / V_el_0)**(-gamma)\n        \n        # Denominator term K*V in units of eV\n        K_V_energy = K0 * V0 * c_PV_to_E\n\n        if gamma == 0.0 or K_V_energy == 0.0:\n            # If gamma is zero, thermal expansion is zero.\n            A = 0.0\n        else:\n            # Numerator constant part\n            num_consts = 12.0 * (np.pi**4) * k_B / 5.0\n            \n            # Combine to calculate A\n            A = (gamma / K_V_energy) * (num_consts / (theta_D_V0**3))\n\n        # Store the formatted results for this case.\n        # Rounding/formatting is done here as per output requirements.\n        sublist = [\n            f\"{dV_V:.6f}\",\n            f\"{V0:.6f}\",\n            f\"{A:.12e}\"\n        ]\n        results.append(f\"[{','.join(sublist)}]\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "3483269"}, {"introduction": "Real materials have complex vibrational spectra where each mode can respond differently to volume changes. This final practice challenges the simplifying assumption of a single Grüneisen parameter, which was used in the previous exercises. By computationally exploring materials with diverse mode-specific Grüneisen parameters ($\\gamma_i$), you will quantify the error of the single-parameter approximation and develop a critical understanding of the model's limitations and applicability. [@problem_id:3483228]", "problem": "You are tasked with designing and implementing a complete, runnable program that evaluates when the single-mode Grüneisen parameter approximation fails in the Quasi-Harmonic Approximation (QHA) for thermal expansion in computational materials science. The objective is to demonstrate that a broad distribution of mode Grüneisen parameters leads to significant errors when using a single averaged Grüneisen parameter to predict the volumetric thermal expansion coefficient.\n\nStarting point and fundamental base:\n- Consider a crystalline solid modeled as a set of non-interacting quantum harmonic oscillators at fixed volume. The Helmholtz free energy for phonons is given by\n$$F_{\\mathrm{ph}}(V,T) = \\sum_{i} \\left( \\frac{1}{2}\\hbar \\omega_{i}(V) + k_{\\mathrm{B}} T \\ln\\left(1 - e^{-\\hbar \\omega_{i}(V)/(k_{\\mathrm{B}} T)}\\right) \\right),$$\nwhere $V$ is the volume, $T$ is the temperature, $\\hbar$ is the reduced Planck constant, $k_{\\mathrm{B}}$ is the Boltzmann constant, and $\\omega_{i}(V)$ are the vibrational mode frequencies that depend on $V$ in the Quasi-Harmonic Approximation (QHA).\n- The thermal pressure is defined as $$P_{\\mathrm{th}}(V,T) = -\\left(\\frac{\\partial F_{\\mathrm{ph}}}{\\partial V}\\right)_{T}.$$\n- The isothermal bulk modulus $B_{T}$ is defined at the reference volume $V_{0}$ as $$B_{T} = -V \\left( \\frac{\\partial P}{\\partial V} \\right)_{T},$$ and is treated as a constant in this problem.\n- The mode Grüneisen parameter is defined as $$\\gamma_{i}(V) = - \\frac{V}{\\omega_{i}(V)} \\left( \\frac{\\partial \\omega_{i}}{\\partial V} \\right)_{T}.$$\n- The volumetric thermal expansion coefficient is defined as $$\\alpha(T) = \\frac{1}{V} \\left( \\frac{\\partial V}{\\partial T} \\right)_{P}.$$\n- The single-$\\bar{\\gamma}$ approximation replaces the full distribution $\\{\\gamma_{i}\\}$ by a constant average $\\bar{\\gamma}$ to estimate $\\alpha(T)$.\n\nRequirements:\n1. Starting from the given fundamental definitions and the QHA framework, derive a computable expression for the volumetric thermal expansion coefficient $\\alpha(T)$ at fixed volume $V_{0}$ in terms of the phonon spectrum and mode Grüneisen parameters, and implement it in code.\n2. Construct the single-$\\bar{\\gamma}$ approximation by defining $\\bar{\\gamma}$ as the heat-capacity-weighted average of $\\gamma_{i}$ at a reference temperature $T_{\\mathrm{ref}}$, hold it constant for all temperatures, and implement the corresponding approximate $\\alpha(T)$.\n3. Quantify the error of the single-$\\bar{\\gamma}$ approximation by computing the relative error at each temperature $T$ as $$\\mathrm{err}(T) = \\frac{|\\alpha_{\\mathrm{full}}(T) - \\alpha_{\\mathrm{single}}(T)|}{|\\alpha_{\\mathrm{full}}(T)|}.$$\n4. Demonstrate the breadth of the $\\gamma_{i}$ distribution at $T_{\\mathrm{ref}}$ using the heat-capacity-weighted standard deviation of $\\gamma_{i}$, defined by the weights $w_{i}(T_{\\mathrm{ref}})$ proportional to the mode heat capacities $c_{V,i}(T_{\\mathrm{ref}})$, and report this standard deviation.\n\nImplementation details:\n- Use the Einstein oscillator expression for the constant-volume mode heat capacity at fixed volume,\n$$c_{V,i}(T) = k_{\\mathrm{B}} \\frac{x_{i}(T)^{2} e^{x_{i}(T)}}{(e^{x_{i}(T)} - 1)^{2}}, \\quad x_{i}(T) = \\frac{\\hbar \\omega_{i}(V_{0})}{k_{\\mathrm{B}} T}.$$\n- Use the following constants: $\\hbar = 1.054571817 \\times 10^{-34}$ $\\mathrm{J \\cdot s}$, $k_{\\mathrm{B}} = 1.380649 \\times 10^{-23}$ $\\mathrm{J/K}$, $B_{T} = 1.0 \\times 10^{11}$ $\\mathrm{Pa}$, and $V_{0} = 1.0 \\times 10^{-28}$ $\\mathrm{m^{3}}$.\n- Frequencies are given in terahertz and must be converted to angular frequencies in radians per second using $\\omega = 2\\pi f$ with $f$ in hertz.\n- Temperatures are in kelvin.\n\nTest suite:\nEvaluate the following three synthetic materials that are scientifically plausible and designed to test broad and narrow distributions of $\\gamma_{i}$, as well as the temperature dependence of mode weighting.\n\n- Material $1$ (bimodal $\\gamma_{i}$ distribution; low-frequency negative $\\gamma_{i}$ and high-frequency positive $\\gamma_{i}$):\n  - Frequencies in terahertz: $[2.0, 2.5, 3.0, 1.5, 1.2, 0.8, 10.0, 12.0, 15.0, 18.0, 11.0, 13.0, 16.0, 20.0]$.\n  - Mode Grüneisen parameters: $[-1.2, -1.1, -1.0, -0.8, -0.6, -0.5, 2.5, 2.6, 2.4, 2.7, 2.3, 2.8, 2.5, 2.6]$.\n\n- Material $2$ (heavy-tail $\\gamma_{i}$ concentrated in low-frequency modes):\n  - Frequencies in terahertz: $[0.7, 0.9, 1.0, 1.5, 2.0, 3.0, 5.0, 8.0, 12.0, 15.0, 18.0, 20.0]$.\n  - Mode Grüneisen parameters: $[5.0, 4.5, 4.0, 3.0, 2.0, 1.5, 1.2, 1.1, 1.0, 0.9, 0.8, 0.7]$.\n\n- Material $3$ (narrow $\\gamma_{i}$ distribution):\n  - Frequencies in terahertz: $[2.0, 3.0, 4.0, 6.0, 8.0, 10.0, 12.0, 14.0]$.\n  - Mode Grüneisen parameters: $[1.5, 1.6, 1.4, 1.5, 1.5, 1.6, 1.4, 1.5]$.\n\nTemperatures to evaluate:\n- $T$ values: $[50, 300, 800]$ $\\mathrm{K}$.\n- Reference temperature: $T_{\\mathrm{ref}} = 300$ $\\mathrm{K}$.\n\nOutput specification:\n- For each material, compute:\n  - The heat-capacity-weighted standard deviation of $\\gamma_{i}$ at $T_{\\mathrm{ref}}$ (dimensionless).\n  - The relative errors $\\mathrm{err}(T)$ at $T = 50$ $\\mathrm{K}$, $300$ $\\mathrm{K}$, and $800$ $\\mathrm{K}$ (dimensionless).\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each material is represented by a list of four floats in the order $[\\mathrm{std}_{\\gamma}(T_{\\mathrm{ref}}), \\mathrm{err}(50\\,\\mathrm{K}), \\mathrm{err}(300\\,\\mathrm{K}), \\mathrm{err}(800\\,\\mathrm{K})]$. For example, the output format is\n$$[[a_{1},b_{1},c_{1},d_{1}],[a_{2},b_{2},c_{2},d_{2}],[a_{3},b_{3},c_{3},d_{3}]],$$\nwith no spaces anywhere in the printed string.\nAll reported quantities are dimensionless and must be expressed as decimal floats.", "solution": "The supplied problem is evaluated as scientifically sound, well-posed, objective, and complete. It presents a standard, yet insightful, numerical experiment within the domain of computational materials science, based on the fundamental principles of the quasi-harmonic approximation (QHA). All provided definitions, constants, and data are consistent and physically plausible. The task is to derive and implement a model to demonstrate a key limitation of a common approximation, which constitutes a valid scientific inquiry. Therefore, a full solution is warranted.\n\nThe solution is structured into four main parts:\n1.  Derivation of the exact volumetric thermal expansion coefficient, $\\alpha_{\\mathrm{full}}(T)$, within the QHA framework.\n2.  Formulation of the single-averaged Grüneisen parameter approximation, $\\alpha_{\\mathrm{single}}(T)$.\n3.  Definition of the metrics for quantifying the breadth of the mode Grüneisen parameter distribution and the error of the approximation.\n4.  Description of the algorithm to implement the calculations.\n\nThroughout this derivation, every mathematical entity is typeset in LaTeX as per the specified mandatory formatting rule.\n\nThe problem asks to analyze the volumetric thermal expansion coefficient, $\\alpha(T)$, defined as:\n$$\n\\alpha(T) = \\frac{1}{V} \\left( \\frac{\\partial V}{\\partial T} \\right)_{P}\n$$\nwhere $V$ is the volume, $T$ is the temperature, and $P$ is the pressure.\n\n**1. Derivation of the Full Volumetric Thermal Expansion Coefficient $\\alpha_{\\mathrm{full}}(T)$**\n\nTo derive a computable expression for $\\alpha(T)$, we employ a thermodynamic identity derived from the triple product rule:\n$$\n\\left( \\frac{\\partial V}{\\partial T} \\right)_{P} \\left( \\frac{\\partial T}{\\partial P} \\right)_{V} \\left( \\frac{\\partial P}{\\partial V} \\right)_{T} = -1\n$$\nRearranging to solve for the term in the definition of $\\alpha(T)$:\n$$\n\\left( \\frac{\\partial V}{\\partial T} \\right)_{P} = - \\left( \\frac{\\partial V}{\\partial P} \\right)_{T} \\left( \\frac{\\partial P}{\\partial T} \\right)_{V}\n$$\nSubstituting this into the definition of $\\alpha(T)$ yields:\n$$\n\\alpha(T) = \\frac{1}{V} \\left[ - \\left( \\frac{\\partial V}{\\partial P} \\right)_{T} \\left( \\frac{\\partial P}{\\partial T} \\right)_{V} \\right]\n$$\nWe identify the terms in this expression. The isothermal bulk modulus, $B_T$, is defined as $B_T = -V (\\frac{\\partial P}{\\partial V})_T$. Its reciprocal gives us $-\\left(\\frac{\\partial V}{\\partial P}\\right)_T = \\frac{V}{B_T}$. The total pressure $P$ is a sum of the static pressure at $0$ K and the thermal pressure from phonons, $P(V,T) = P_{0\\mathrm{K}}(V) + P_{\\mathrm{th}}(V,T)$. Since $P_{0\\mathrm{K}}$ does not depend on $T$, we have $(\\frac{\\partial P}{\\partial T})_V = (\\frac{\\partial P_{\\mathrm{th}}}{\\partial T})_V$.\nSubstituting these into the equation for $\\alpha(T)$ gives the well-known Grüneisen relation:\n$$\n\\alpha(T) = \\frac{1}{B_T} \\left( \\frac{\\partial P_{\\mathrm{th}}}{\\partial T} \\right)_{V}\n$$\nNext, we derive an expression for the thermal pressure, $P_{\\mathrm{th}}(V,T)$, from the phonon Helmholtz free energy, $F_{\\mathrm{ph}}$:\n$$\nF_{\\mathrm{ph}}(V,T) = \\sum_{i} \\left( \\frac{1}{2}\\hbar \\omega_{i}(V) + k_{\\mathrm{B}} T \\ln\\left(1 - e^{-\\hbar \\omega_{i}(V)/(k_{\\mathrm{B}} T)}\\right) \\right)\n$$\nThe thermal pressure is $P_{\\mathrm{th}}(V,T) = -(\\frac{\\partial F_{\\mathrm{ph}}}{\\partial V})_T$. Applying the derivative and using the definition of the mode Grüneisen parameter, $\\gamma_{i} = -\\frac{V}{\\omega_{i}} \\frac{\\partial \\omega_{i}}{\\partial V}$, we obtain:\n$$\nP_{\\mathrm{th}}(V,T) = \\frac{1}{V} \\sum_{i} \\gamma_{i} \\left( \\frac{1}{2}\\hbar \\omega_{i} + \\frac{\\hbar \\omega_{i}}{e^{\\hbar \\omega_{i}/(k_{\\mathrm{B}}T)} - 1} \\right) = \\frac{1}{V} \\sum_{i} \\gamma_{i} E_{i}(T)\n$$\nwhere $E_{i}(T)$ is the total mean energy of the $i$-th oscillator. Standard convention in thermal expansion theory considers the pressure arising purely from thermal excitations. The derivative $(\\frac{\\partial P_{\\mathrm{th}}}{\\partial T})_V$ isolates this contribution automatically:\n$$\n\\left(\\frac{\\partial P_{\\mathrm{th}}}{\\partial T}\\right)_{V} = \\frac{\\partial}{\\partial T} \\left( \\frac{1}{V} \\sum_{i} \\gamma_{i} E_{i}(T) \\right) = \\frac{1}{V} \\sum_{i} \\gamma_{i} \\left(\\frac{\\partial E_{i}}{\\partial T}\\right)_{V}\n$$\nThe term $(\\frac{\\partial E_i}{\\partial T})_V$ is the definition of the constant-volume mode heat capacity, $c_{V,i}(T)$. The problem provides its explicit form:\n$$\nc_{V,i}(T) = k_{\\mathrm{B}} \\frac{x_{i}(T)^{2} e^{x_{i}(T)}}{(e^{x_{i}(T)} - 1)^{2}}, \\quad \\text{where } x_{i}(T) = \\frac{\\hbar \\omega_{i}(V_{0})}{k_{\\mathrm{B}} T}\n$$\nTherefore, we have $(\\frac{\\partial P_{\\mathrm{th}}}{\\partial T})_V = \\frac{1}{V} \\sum_{i} \\gamma_{i} c_{V,i}(T)$. The final expression for the full thermal expansion coefficient, evaluated at the reference volume $V_0$ as specified, is:\n$$\n\\alpha_{\\mathrm{full}}(T) = \\frac{1}{B_T V_0} \\sum_{i} \\gamma_{i} c_{V,i}(T)\n$$\n\n**2. The Single-$\\bar{\\gamma}$ Approximation**\n\nThis approximation simplifies the above expression by replacing the mode-specific $\\gamma_i$ with a single, effective, temperature-independent value, $\\bar{\\gamma}_{\\mathrm{approx}}$. A physically-motivated choice for $\\bar{\\gamma}_{\\mathrm{approx}}$ is the heat-capacity-weighted average of the $\\gamma_i$ evaluated at a single reference temperature, $T_{\\mathrm{ref}}$:\n$$\n\\bar{\\gamma}_{\\mathrm{approx}} \\equiv \\bar{\\gamma}(T_{\\mathrm{ref}}) = \\frac{\\sum_{i} \\gamma_{i} c_{V,i}(T_{\\mathrm{ref}})}{\\sum_{i} c_{V,i}(T_{\\mathrm{ref}})}\n$$\nUsing this constant $\\bar{\\gamma}_{\\mathrm{approx}}$, the thermal expansion coefficient at any temperature $T$ is approximated as:\n$$\n\\alpha_{\\mathrm{single}}(T) = \\frac{1}{B_T V_0} \\sum_{i} \\bar{\\gamma}_{\\mathrm{approx}} c_{V,i}(T) = \\frac{\\bar{\\gamma}_{\\mathrm{approx}}}{B_T V_0} \\sum_{i} c_{V,i}(T) = \\frac{\\bar{\\gamma}_{\\mathrm{approx}} C_V(T)}{B_T V_0}\n$$\nwhere $C_V(T) = \\sum_i c_{V,i}(T)$ is the total phonon heat capacity at constant volume. This approximation is exact only if all $\\gamma_i$ are equal, or if the relative contributions of $c_{V,i}(T)$ to the total $C_V(T)$ are independent of temperature, which is not true in general.\n\n**3. Quantification of Distribution Breadth and Approximation Error**\n\nTo assess the validity of the single-$\\bar{\\gamma}$ approximation, we must quantify two things: the breadth of the underlying $\\gamma_i$ distribution and the resulting error in $\\alpha(T)$.\n\nThe breadth of the $\\gamma_i$ distribution is measured by its heat-capacity-weighted standard deviation at the reference temperature $T_{\\mathrm{ref}}$. The weights are defined as $w_i(T_{\\mathrm{ref}}) = c_{V,i}(T_{\\mathrm{ref}}) / C_V(T_{\\mathrm{ref}})$. The weighted standard deviation is:\n$$\n\\mathrm{std}_{\\gamma}(T_{\\mathrm{ref}}) = \\sqrt{\\sum_{i=1}^{N} w_i(T_{\\mathrm{ref}}) \\left(\\gamma_i - \\bar{\\gamma}(T_{\\mathrm{ref}})\\right)^2}\n$$\nThe relative error of the approximation at a given temperature $T$ is defined as:\n$$\n\\mathrm{err}(T) = \\frac{|\\alpha_{\\mathrm{full}}(T) - \\alpha_{\\mathrm{single}}(T)|}{|\\alpha_{\\mathrm{full}}(T)|}\n$$\nA large value of $\\mathrm{std}_{\\gamma}$ is expected to correlate with a large error, particularly at temperatures far from $T_{\\mathrm{ref}}$, because the temperature dependence of the true weighted average $\\bar{\\gamma}(T)$ is ignored in the approximation.\n\n**4. Algorithmic Implementation**\n\nThe computational procedure for each synthetic material is as follows:\n1.  Define the physical constants: $\\hbar = 1.054571817 \\times 10^{-34}$ $\\mathrm{J \\cdot s}$, $k_{\\mathrm{B}} = 1.380649 \\times 10^{-23}$ $\\mathrm{J/K}$, $B_{T} = 1.0 \\times 10^{11}$ $\\mathrm{Pa}$, and $V_{0} = 1.0 \\times 10^{-28}$ $\\mathrm{m^{3}}$.\n2.  For a given material, take the array of frequencies $f_i$ (in THz) and mode Grüneisen parameters $\\gamma_i$. Convert frequencies to angular frequencies: $\\omega_i = 2 \\pi f_i \\times 10^{12}$ rad/s.\n3.  Implement a function to calculate the mode heat capacities $c_{V,i}(T)$ for an array of frequencies $\\omega_i$ at a temperature $T$.\n4.  At $T = T_{\\mathrm{ref}} = 300$ K, compute the array of mode heat capacities, $c_{V,i}(T_{\\mathrm{ref}})$.\n5.  Use $c_{V,i}(T_{\\mathrm{ref}})$ to calculate the weights $w_i(T_{\\mathrm{ref}})$, the average $\\bar{\\gamma}_{\\mathrm{approx}} = \\bar{\\gamma}(T_{\\mathrm{ref}})$, and the standard deviation $\\mathrm{std}_{\\gamma}(T_{\\mathrm{ref}})$. This standard deviation is the first required output for the material.\n6.  Iterate through the evaluation temperatures $T \\in [50, 300, 800]$ K. For each $T$:\n    a. Calculate the mode heat capacities $c_{V,i}(T)$.\n    b. Calculate $\\alpha_{\\mathrm{full}}(T) = \\frac{1}{B_T V_0} \\sum_i \\gamma_i c_{V,i}(T)$.\n    c. Calculate $\\alpha_{\\mathrm{single}}(T) = \\frac{\\bar{\\gamma}_{\\mathrm{approx}}}{B_T V_0} \\sum_i c_{V,i}(T)$.\n    d. Compute the relative error $\\mathrm{err}(T)$. If $\\alpha_{\\mathrm{full}}(T)$ is zero or numerically very close to zero, the relative error can be considered infinite or undefined; however, the chosen test cases avoid this specific issue at the evaluation points.\n7.  Collect the four output values for the material: $[\\mathrm{std}_{\\gamma}(T_{\\mathrm{ref}}), \\mathrm{err}(50 \\text{ K}), \\mathrm{err}(300 \\text{ K}), \\mathrm{err}(800 \\text{ K})]$.\n8.  Repeat for all materials and format the final results as specified.", "answer": "```python\nimport numpy as np\nfrom typing import List, Tuple\n\ndef solve():\n    \"\"\"\n    Computes the failure of the single-mode Grüneisen parameter approximation\n    in the Quasi-Harmonic Approximation (QHA) for thermal expansion.\n    \"\"\"\n    \n    # Define physical constants\n    HBAR = 1.054571817e-34  # J·s\n    KB = 1.380649e-23        # J/K\n    BT = 1.0e11               # Pa\n    V0 = 1.0e-28              # m^3\n    \n    # Pre-calculated constant factors\n    HBAR_OVER_KB = HBAR / KB  # K·s\n    PREFACTOR_ALPHA = 1.0 / (BT * V0) # 1/J\n\n    # Define the temperature points for evaluation\n    T_VALS = np.array([50.0, 300.0, 800.0])  # K\n    T_REF = 300.0  # K\n\n    # Test suite: Frequencies in THz, Grüneisen parameters are dimensionless\n    test_cases: List[Tuple[np.ndarray, np.ndarray]] = [\n        (  # Material 1: Bimodal distribution\n            np.array([2.0, 2.5, 3.0, 1.5, 1.2, 0.8, 10.0, 12.0, 15.0, 18.0, 11.0, 13.0, 16.0, 20.0]),\n            np.array([-1.2, -1.1, -1.0, -0.8, -0.6, -0.5, 2.5, 2.6, 2.4, 2.7, 2.3, 2.8, 2.5, 2.6])\n        ),\n        (  # Material 2: Heavy-tail distribution\n            np.array([0.7, 0.9, 1.0, 1.5, 2.0, 3.0, 5.0, 8.0, 12.0, 15.0, 18.0, 20.0]),\n            np.array([5.0, 4.5, 4.0, 3.0, 2.0, 1.5, 1.2, 1.1, 1.0, 0.9, 0.8, 0.7])\n        ),\n        (  # Material 3: Narrow distribution\n            np.array([2.0, 3.0, 4.0, 6.0, 8.0, 10.0, 12.0, 14.0]),\n            np.array([1.5, 1.6, 1.4, 1.5, 1.5, 1.6, 1.4, 1.5])\n        ),\n    ]\n\n    def calculate_c_V_i(T: float, omegas: np.ndarray) - np.ndarray:\n        \"\"\"\n        Calculates the Einstein model heat capacity for each mode.\n        T: Temperature in Kelvin\n        omegas: Array of angular frequencies in rad/s\n        \"\"\"\n        if T == 0.0:\n            return np.zeros_like(omegas)\n        \n        x = HBAR_OVER_KB * omegas / T\n        \n        # Handle large x to avoid overflow in exp(x)\n        # For large x, c_V_i - k_B * x**2 * exp(-x), which is numerically stable\n        # and tends to 0. A cutoff of x=100 is safe.\n        c_v = np.zeros_like(x)\n        \n        # Standard calculation for moderate x\n        mask_std = x  100\n        x_std = x[mask_std]\n        exp_x = np.exp(x_std)\n        # Using np.subtract(exp_x, 1, out=...) can be slightly more precise for small x_std,\n        # but here the formula is stable enough given standard float64 precision.\n        c_v[mask_std] = KB * x_std**2 * exp_x / (exp_x - 1)**2\n\n        # Approximation for large x\n        mask_large = ~mask_std\n        x_large = x[mask_large]\n        c_v[mask_large] = KB * x_large**2 * np.exp(-x_large)\n\n        return c_v\n\n    results = []\n    for freqs_thz, gammas in test_cases:\n        # 1. Convert frequencies to angular frequencies\n        omegas = 2 * np.pi * freqs_thz * 1e12  # rad/s\n\n        # 2. Calculate quantities at the reference temperature T_ref\n        c_v_i_ref = calculate_c_V_i(T_REF, omegas)\n        c_v_total_ref = np.sum(c_v_i_ref)\n\n        if c_v_total_ref == 0:\n            # Handle case where no modes are excited at T_ref\n            gamma_bar_approx = np.mean(gammas) # Fallback to simple average\n            std_gamma = np.std(gammas)\n        else:\n            weights_ref = c_v_i_ref / c_v_total_ref\n            # Heat-capacity-weighted average Grüneisen parameter at T_ref\n            gamma_bar_approx = np.sum(weights_ref * gammas)\n            # Heat-capacity-weighted standard deviation of Grüneisen parameters at T_ref\n            var_gamma = np.sum(weights_ref * (gammas - gamma_bar_approx)**2)\n            std_gamma = np.sqrt(var_gamma)\n        \n        errors = []\n        for T in T_VALS:\n            # 3. Calculate heat capacities at the evaluation temperature T\n            c_v_i_T = calculate_c_V_i(T, omegas)\n            c_v_total_T = np.sum(c_v_i_T)\n\n            # 4. Calculate alpha_full and alpha_single\n            alpha_full = PREFACTOR_ALPHA * np.sum(gammas * c_v_i_T)\n            alpha_single = PREFACTOR_ALPHA * gamma_bar_approx * c_v_total_T\n            \n            # 5. Calculate relative error\n            if np.isclose(alpha_full, 0.0):\n                # If the true alpha is zero, any non-zero approximation has infinite relative error.\n                # If the approximation is also zero, the error is zero.\n                if np.isclose(alpha_single, 0.0):\n                    err = 0.0\n                else:\n                    err = np.inf\n            else:\n                err = np.abs(alpha_full - alpha_single) / np.abs(alpha_full)\n            errors.append(err)\n            \n        material_results = [std_gamma] + errors\n        results.append(material_results)\n\n    # Format the final output string according to the specification\n    # e.g., [[val1,val2],[val3,val4]]\n    outer_parts = []\n    for res_list in results:\n        inner_str = ','.join(map(str, res_list))\n        outer_parts.append(f\"[{inner_str}]\")\n    \n    final_output = f\"[{','.join(outer_parts)}]\"\n    print(final_output)\n\nsolve()\n```", "id": "3483228"}]}