{"hands_on_practices": [{"introduction": "To begin our hands-on exploration, we will build the celebrated Debye model for heat capacity from the ground up. This foundational exercise reinforces the connection between the phonon density of states, Bose-Einstein statistics, and macroscopic thermodynamic properties. By deriving the model from first principles and then implementing it numerically, you will gain practical skills in applying numerical quadrature and verifying one of the key predictions of solid-state theory: the $T^3$ law for heat capacity at low temperatures [@problem_id:3477867].", "problem": "Consider a crystalline solid modeled within the Debye approximation for phonons. Assume an isotropic linear acoustic dispersion relation $\\,\\omega = v\\,k\\,$ with a cutoff angular frequency $\\,\\omega_D\\,$ such that the total number of vibrational modes equals $\\,3N\\,$ for a system of $\\,N\\,$ atoms. Let the Debye temperature $\\,\\Theta_D\\,$ be defined by $\\,k_{\\mathrm{B}}\\Theta_D = \\hbar \\omega_D\\,$, where $\\,k_{\\mathrm{B}}\\,$ is the Boltzmann constant and $\\,\\hbar\\,$ is the reduced Planck constant. The phonon occupation follows the Bose–Einstein (BE) distribution $\\,n_{\\mathrm{BE}}(\\omega,T) = \\left[\\exp\\!\\left(\\hbar\\omega / (k_{\\mathrm{B}} T)\\right)-1\\right]^{-1}\\,$. The vibrational internal energy is given by integrating the product of the Density of States (DOS), the energy per mode, and the BE occupation over frequency. The constant-volume heat capacity $\\,C_V\\,$ is defined by $\\,C_V = \\left(\\partial U/\\partial T\\right)_V\\,$. Work in the thermodynamic limit and report the molar heat capacity, that is, per mole of atoms.\n\nTasks:\n1. Starting from the above fundamental definitions only, derive an expression for the molar heat capacity $\\,C_V\\,$ as a function of temperature $\\,T\\,$ and Debye temperature $\\,\\Theta_D\\,$ within the Debye model. Your derivation should not assume any pre-tabulated Debye function; it must proceed from the DOS implied by the linear dispersion and the BE statistics, enforcing the cutoff at $\\,\\omega_D\\,$ by the mode-counting constraint.\n2. Implement a numerical quadrature to evaluate the molar heat capacity $\\,C_V\\,$ in units of $\\mathrm{J\\,mol^{-1}\\,K^{-1}}$ for Debye temperature $\\,\\Theta_D = 300\\,\\mathrm{K}\\,$ at the following temperatures: $\\,T = 5\\,\\mathrm{K},\\,30\\,\\mathrm{K},\\,100\\,\\mathrm{K},\\,300\\,\\mathrm{K}\\,$. Round each reported value to $6$ decimal places and express all results in $\\mathrm{J\\,mol^{-1}\\,K^{-1}}$.\n3. Verify the low-temperature $\\,T^3\\,$ law by computing the best-fit slope of $\\,\\ln C_V\\,$ versus $\\,\\ln T\\,$ over the low-temperature set $\\,T \\in \\{2\\,\\mathrm{K},3\\,\\mathrm{K},5\\,\\mathrm{K},8\\,\\mathrm{K},12\\,\\mathrm{K}\\}\\,$ using ordinary least squares. Report the slope as a float rounded to $3$ decimal places. Also report a boolean that is true if the fitted slope deviates from $\\,3\\,$ by no more than $\\,0.05\\,$, and false otherwise.\n\nNumerical and physical details:\n- Use the gas constant $\\,R = 8.314462618\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}\\,$.\n- All temperatures $\\,T\\,$ and $\\,\\Theta_D\\,$ are in $\\mathrm{K}$.\n- The final answers for heat capacities must be in $\\mathrm{J\\,mol^{-1}\\,K^{-1}}$.\n- All logarithms for the slope fitting must use the natural logarithm.\n\nTest suite and required output:\n- Debye temperature: $\\,\\Theta_D = 300\\,\\mathrm{K}\\,$.\n- Heat capacity evaluation temperatures: $\\,T = 5\\,\\mathrm{K},\\,30\\,\\mathrm{K},\\,100\\,\\mathrm{K},\\,300\\,\\mathrm{K}\\,$.\n- Low-temperature slope-fit temperatures: $\\,T = 2\\,\\mathrm{K},\\,3\\,\\mathrm{K},5\\,\\mathrm{K},8\\,\\mathrm{K},12\\,\\mathrm{K}\\,$.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the following order: $\\left[C_V(5\\,\\mathrm{K}),\\,C_V(30\\,\\mathrm{K}),\\,C_V(100\\,\\mathrm{K}),\\,C_V(300\\,\\mathrm{K}),\\,\\text{slope},\\,\\text{boolean}\\right]$. The first four entries must be rounded to $6$ decimal places, the slope rounded to $3$ decimal places, and the boolean must be either true or false in standard programming language capitalization (that is, True or False). For example, an output could look like $\\,[24.000000,24.500000,24.900000,24.943388,2.999,True]\\,$. This is only an example format; your program must compute the actual values for the specified parameters.", "solution": "The problem requires a first-principles derivation of the molar heat capacity $C_V$ within the Debye model, followed by its numerical evaluation and a verification of the low-temperature $T^3$ law.\n\nThe derivation begins with the phonon density of states (DOS) in a three-dimensional isotropic solid. The number of allowed wavevectors $\\mathbf{k}$ within a sphere of radius $k = |\\mathbf{k}|$ in $k$-space is proportional to the volume of the sphere. For a crystal of volume $V$ containing $N$ atoms, and accounting for three polarization modes (one longitudinal, two transverse) assumed to have the same sound velocity $v$, the number of modes $G(k)$ with wavevector magnitude up to $k$ is:\n$$ G(k) = 3 \\times \\frac{V}{(2\\pi)^3} \\left(\\frac{4}{3}\\pi k^3\\right) = \\frac{V k^3}{2\\pi^2} $$\nThe density of states in $k$-space is the derivative of $G(k)$ with respect to $k$:\n$$ g(k) = \\frac{dG(k)}{dk} = \\frac{3Vk^2}{2\\pi^2} $$\nUsing the linear acoustic dispersion relation $\\omega = vk$, we can transform the DOS from $k$-space to frequency space. Since $k = \\omega/v$ and $dk = d\\omega/v$, the DOS in terms of angular frequency $\\omega$, denoted $g(\\omega)$, is found by the relation $g(\\omega)d\\omega = g(k)dk$:\n$$ g(\\omega) = g(k(\\omega)) \\frac{dk}{d\\omega} = \\left(\\frac{3V( \\omega/v )^2}{2\\pi^2}\\right) \\frac{1}{v} = \\frac{3V}{2\\pi^2 v^3} \\omega^2 $$\nThe Debye model imposes a cutoff frequency, $\\omega_D$, such that the total number of vibrational modes equals $3N$. This normalization condition is:\n$$ \\int_0^{\\omega_D} g(\\omega) d\\omega = \\int_0^{\\omega_D} \\frac{3V}{2\\pi^2 v^3} \\omega^2 d\\omega = \\frac{V \\omega_D^3}{2\\pi^2 v^3} = 3N $$\nFrom this, we find $\\omega_D^3 = 6\\pi^2 N v^3 / V$. We can substitute this back into the DOS expression to eliminate $V$ and $v$:\n$$ g(\\omega) = \\frac{9N}{\\omega_D^3} \\omega^2, \\quad \\text{for } 0 \\le \\omega \\le \\omega_D $$\nand $g(\\omega) = 0$ for $\\omega  \\omega_D$.\n\nThe vibrational internal energy $U$ of the solid is the sum of the energies of all phonon modes. The mean energy of a quantum harmonic oscillator of frequency $\\omega$ at temperature $T$ is given by $\\hbar\\omega$ times the Bose-Einstein occupation number $n_{\\mathrm{BE}}(\\omega, T) = (\\exp(\\hbar\\omega / (k_B T)) - 1)^{-1}$. The zero-point energy term is omitted as it is a constant that vanishes when computing the heat capacity. The total internal energy is thus:\n$$ U = \\int_0^{\\omega_D} \\hbar\\omega \\, n_{\\mathrm{BE}}(\\omega, T) \\, g(\\omega) d\\omega = \\int_0^{\\omega_D} \\frac{\\hbar\\omega}{e^{\\hbar\\omega/k_B T} - 1} \\left(\\frac{9N\\omega^2}{\\omega_D^3}\\right) d\\omega $$\n$$ U = \\frac{9N\\hbar}{\\omega_D^3} \\int_0^{\\omega_D} \\frac{\\omega^3}{e^{\\hbar\\omega/k_B T} - 1} d\\omega $$\nThe constant-volume heat capacity is $C_V = (\\partial U / \\partial T)_V$. We differentiate the integral with respect to $T$:\n$$ C_V = \\frac{\\partial}{\\partial T} \\left( \\frac{9N\\hbar}{\\omega_D^3} \\int_0^{\\omega_D} \\frac{\\omega^3}{e^{\\hbar\\omega/k_B T} - 1} d\\omega \\right) $$\nDifferentiating under the integral sign is the most direct method:\n$$ C_V = \\frac{9N\\hbar}{\\omega_D^3} \\int_0^{\\omega_D} \\omega^3 \\frac{\\partial}{\\partial T} \\left( \\frac{1}{e^{\\hbar\\omega/k_B T} - 1} \\right) d\\omega $$\nThe derivative of the thermal factor is:\n$$ \\frac{\\partial}{\\partial T} \\left(e^{\\hbar\\omega/k_B T} - 1\\right)^{-1} = -1 \\cdot \\left(e^{\\hbar\\omega/k_B T} - 1\\right)^{-2} \\cdot e^{\\hbar\\omega/k_B T} \\cdot \\left(-\\frac{\\hbar\\omega}{k_B T^2}\\right) = \\frac{\\hbar\\omega}{k_B T^2} \\frac{e^{\\hbar\\omega/k_B T}}{\\left(e^{\\hbar\\omega/k_B T} - 1\\right)^2} $$\nSubstituting this back into the expression for $C_V$:\n$$ C_V = \\frac{9N\\hbar}{\\omega_D^3} \\int_0^{\\omega_D} \\omega^3 \\left( \\frac{\\hbar\\omega}{k_B T^2} \\frac{e^{\\hbar\\omega/k_B T}}{\\left(e^{\\hbar\\omega/k_B T} - 1\\right)^2} \\right) d\\omega = \\frac{9N\\hbar^2}{k_B T^2 \\omega_D^3} \\int_0^{\\omega_D} \\frac{\\omega^4 e^{\\hbar\\omega/k_B T}}{\\left(e^{\\hbar\\omega/k_B T} - 1\\right)^2} d\\omega $$\nTo simplify, we introduce the dimensionless variable $x = \\hbar\\omega/(k_B T)$. This implies $\\omega = k_B T x / \\hbar$ and $d\\omega = (k_B T / \\hbar) dx$. The upper limit of integration becomes $x_D = \\hbar\\omega_D/(k_B T)$. We use the definition of the Debye temperature, $\\Theta_D = \\hbar\\omega_D/k_B$, so $x_D = \\Theta_D/T$. Substituting these into the $C_V$ expression and simplifying the constants yields:\n$$ C_V = 9N k_B \\left(\\frac{T}{\\Theta_D}\\right)^3 \\int_0^{\\Theta_D/T} \\frac{x^4 e^x}{(e^x - 1)^2} dx $$\nFor the molar heat capacity, $C_{V,m}$, we consider one mole of atoms, so $N = N_A$, where $N_A$ is Avogadro's number. Using the relation $R = N_A k_B$, where $R$ is the molar gas constant, we arrive at the final expression:\n$$ C_{V,m}(T, \\Theta_D) = 9R \\left(\\frac{T}{\\Theta_D}\\right)^3 \\int_0^{\\Theta_D/T} \\frac{x^4 e^x}{(e^x - 1)^2} dx $$\nThis expression is to be evaluated numerically. The integral is proper, as the integrand $f(x) = x^4 e^x / (e^x-1)^2$ approaches $x^2$ as $x \\to 0$, and is therefore zero at the lower limit of integration. We use numerical quadrature, specifically the `scipy.integrate.quad` function, which is well-suited for this type of definite integral. The calculations are performed for $\\Theta_D = 300\\,\\mathrm{K}$ and the specified temperatures.\n\nFor the verification of the low-temperature $T^3$ law, we analyze the behavior of $C_{V,m}$ as $T \\to 0$. In this limit, the upper bound of integration $\\Theta_D/T \\to \\infty$. The expression for $C_{V,m}$ becomes proportional to $T^3$:\n$$ C_{V,m}(T) \\approx 9R \\left(\\frac{T}{\\Theta_D}\\right)^3 \\int_0^{\\infty} \\frac{x^4 e^x}{(e^x - 1)^2} dx = A \\cdot T^3 $$\nwhere $A = \\frac{9R}{\\Theta_D^3} \\int_0^{\\infty} \\frac{x^4 e^x}{(e^x - 1)^2} dx$ is a constant. The definite integral evaluates to $4\\pi^4/15$.\nTo verify this relationship numerically, we fit a linear model to the logarithm of the data:\n$$ \\ln(C_{V,m}) = \\ln(A) + 3 \\ln(T) $$\nThis is a linear equation of the form $y = m x + c$, with $y = \\ln(C_{V,m})$, $x = \\ln(T)$, slope $m = 3$, and intercept $c = \\ln(A)$. We compute $C_{V,m}$ for the given low-temperature set $T \\in \\{2\\,\\mathrm{K},3\\,\\mathrm{K},5\\,\\mathrm{K},8\\,\\mathrm{K},12\\,\\mathrm{K}\\}$, take the natural logarithm of both $T$ and $C_{V,m}$, and perform an ordinary least squares linear regression to find the best-fit slope. The problem requires reporting this slope and checking if its absolute deviation from $3$ is no more than $0.05$.", "answer": "```python\nimport numpy as np\nfrom scipy.integrate import quad\n\ndef solve():\n    \"\"\"\n    This function solves the entire problem as stated.\n    It calculates molar heat capacities, performs a linear fit to verify\n    the T^3 law, and prints the results in the required format.\n    \"\"\"\n\n    # --- Problem Parameters ---\n    THETA_D = 300.0      # Debye temperature in K\n    R = 8.314462618      # Molar gas constant in J mol^-1 K^-1\n\n    # --- Core Physics Implementation ---\n    def integrand(x):\n        \"\"\"\n        The integrand for the Debye heat capacity integral: x^4 * e^x / (e^x - 1)^2.\n        This implementation is numerically stable.\n        \"\"\"\n        # For x=0, the limit is 0.\n        if x == 0:\n            return 0.0\n        # Use np.expm1 for better precision with small x, where exp(x)-1 would suffer from catastrophic cancellation.\n        denominator = np.expm1(x)\n        if denominator == 0:  # Should not happen for x  0\n            return 0.0\n        return (x**4 * np.exp(x)) / (denominator**2)\n\n    def calculate_cv(T, theta_d):\n        \"\"\"\n        Calculates the molar heat capacity Cv at a given temperature T and Debye temperature.\n        \"\"\"\n        if T = 0:\n            return 0.0\n        \n        # Upper limit of integration\n        x_d = theta_d / T\n        \n        # Perform numerical integration\n        integral_val, _ = quad(integrand, 0, x_d)\n        \n        # Calculate molar heat capacity\n        prefactor = 9 * R * (T / theta_d)**3\n        cv = prefactor * integral_val\n        return cv\n\n    # --- Task 2: Calculate Molar Heat Capacity ---\n    temps_cv = [5.0, 30.0, 100.0, 300.0]\n    cv_results = [calculate_cv(T, THETA_D) for T in temps_cv]\n    \n    # --- Task 3: Verify Low-Temperature T^3 Law ---\n    temps_low = np.array([2.0, 3.0, 5.0, 8.0, 12.0])\n    \n    # Calculate Cv values for the low-temperature range\n    cv_low = np.array([calculate_cv(T, THETA_D) for T in temps_low])\n    \n    # Perform ordinary least squares fit on the log-log data\n    # ln(Cv) = slope * ln(T) + intercept\n    log_T = np.log(temps_low)\n    log_cv = np.log(cv_low)\n    \n    # np.polyfit returns [slope, intercept] for a degree 1 polynomial\n    slope, _ = np.polyfit(log_T, log_cv, 1)\n    \n    # Check if the slope is within the specified tolerance\n    is_slope_valid = abs(slope - 3.0) = 0.05\n    \n    # --- Format and Print Final Output ---\n    # Collate all results\n    all_results = [\n        cv_results[0],\n        cv_results[1],\n        cv_results[2],\n        cv_results[3],\n        slope,\n        is_slope_valid\n    ]\n\n    # Format the list into the required string output\n    # Using f-strings for float formatting to ensure trailing zeros\n    # And str() for the boolean\n    formatted_results = [\n        f\"{all_results[0]:.6f}\",\n        f\"{all_results[1]:.6f}\",\n        f\"{all_results[2]:.6f}\",\n        f\"{all_results[3]:.6f}\",\n        f\"{all_results[4]:.3f}\",\n        str(all_results[5])\n    ]\n    \n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "3477867"}, {"introduction": "While the Debye model provides excellent insight, the phonon spectra of real materials are often more complex, featuring distinct optical branches in addition to acoustic ones. This practice moves toward a more realistic description by considering a composite density of states (DOS) that includes both a Debye-like acoustic continuum and a sharp peak representing optical modes [@problem_id:3477839]. This exercise will allow you to explore how different features of the phonon DOS are \"activated\" at different energy scales, providing a deeper understanding of how the full vibrational spectrum of a material governs its temperature-dependent heat capacity.", "problem": "You are given a crystalline solid modeled by a phonon density of states consisting of two parts: an acoustic continuum and a sharp optical peak. The density of states is defined per mole of primitive cells, so that integration over angular frequency counts the number of phonon modes per mole. The acoustic part is modeled as a Debye-like continuum of the form $g_{\\mathrm{ac}}(\\omega)=A\\,\\omega^{2}$ on the interval $0 \\le \\omega \\le \\omega_{\\mathrm{D}}$, and the optical part is modeled as a narrow Gaussian centered at an optical angular frequency $\\omega_{\\mathrm{E}}$ with standard deviation $\\sigma$, namely $g_{\\mathrm{op}}(\\omega)=\\dfrac{N_{\\mathrm{op}}}{\\sigma\\sqrt{2\\pi}}\\exp\\!\\left(-\\dfrac{(\\omega-\\omega_{\\mathrm{E}})^{2}}{2\\sigma^{2}}\\right)$ for $\\omega \\ge 0$. Here $A$ is chosen such that $\\int_{0}^{\\omega_{\\mathrm{D}}}g_{\\mathrm{ac}}(\\omega)\\,d\\omega=N_{\\mathrm{ac}}$, where $N_{\\mathrm{ac}}$ is the number of acoustic modes per mole and $N_{\\mathrm{op}}$ is the number of optical modes per mole. The total density of states is $g(\\omega)=g_{\\mathrm{ac}}(\\omega)+g_{\\mathrm{op}}(\\omega)$.\n\nStarting from the Bose–Einstein distribution for non-interacting phonons and the definition of internal energy and heat capacity at constant volume, derive an expression for the molar constant-volume heat capacity $C_{V}(T)$ as an integral over $\\omega$ involving $g(\\omega)$. Then, using that expression, compute numerically the molar heat capacity for the parameter sets listed below.\n\nNormalization and parameters:\n- The acoustic density of states is $g_{\\mathrm{ac}}(\\omega)=A\\,\\omega^{2}$ on $[0,\\omega_{\\mathrm{D}}]$, with $A$ fixed by $\\int_{0}^{\\omega_{\\mathrm{D}}}g_{\\mathrm{ac}}(\\omega)\\,d\\omega=N_{\\mathrm{ac}}$, which implies $A=\\dfrac{3N_{\\mathrm{ac}}}{\\omega_{\\mathrm{D}}^{3}}$.\n- The optical peak is $g_{\\mathrm{op}}(\\omega)=\\dfrac{N_{\\mathrm{op}}}{\\sigma\\sqrt{2\\pi}}\\exp\\!\\left(-\\dfrac{(\\omega-\\omega_{\\mathrm{E}})^{2}}{2\\sigma^{2}}\\right)$ for $\\omega \\ge 0$.\n- Use $\\omega_{\\mathrm{D}}=\\dfrac{k_{\\mathrm{B}}\\Theta_{\\mathrm{D}}}{\\hbar}$ and $\\omega_{\\mathrm{E}}=\\dfrac{k_{\\mathrm{B}}\\Theta_{\\mathrm{E}}}{\\hbar}$, where $\\Theta_{\\mathrm{D}}$ and $\\Theta_{\\mathrm{E}}$ are characteristic temperatures.\n- Use $\\sigma=\\alpha\\,\\omega_{\\mathrm{E}}$, with a given dimensionless width $\\alpha$.\n- The number of modes per mole is $N_{\\mathrm{ac}}=(n_{\\mathrm{ac}})N_{\\mathrm{A}}$ and $N_{\\mathrm{op}}=(n_{\\mathrm{op}})N_{\\mathrm{A}}$, where $n_{\\mathrm{ac}}$ and $n_{\\mathrm{op}}$ are the counts of acoustic and optical branches per primitive cell, respectively, and $N_{\\mathrm{A}}$ is Avogadro’s number.\n\nConstants:\n- Boltzmann constant $k_{\\mathrm{B}}=1.380649\\times 10^{-23}\\,\\mathrm{J/K}$.\n- Reduced Planck constant $\\hbar=1.054571817\\times 10^{-34}\\,\\mathrm{J\\cdot s}$.\n- Avogadro constant $N_{\\mathrm{A}}=6.02214076\\times 10^{23}\\,\\mathrm{mol^{-1}}$.\n\nClassification of temperature regimes:\n- For each case, compute the separate acoustic and optical contributions to $C_{V}(T)$ by integrating with $g_{\\mathrm{ac}}(\\omega)$ and $g_{\\mathrm{op}}(\\omega)$, respectively. Define the dominance threshold fraction $f_{\\mathrm{dom}}=0.7$. If the acoustic contribution is at least a fraction $f_{\\mathrm{dom}}$ of the total, label the regime as acoustic-dominated. If the optical contribution is at least a fraction $f_{\\mathrm{dom}}$ of the total, label the regime as optical-dominated. Otherwise, label it as mixed. Encode the label as an integer: $0$ for acoustic-dominated, $1$ for optical-dominated, and $2$ for mixed. In cases where the total heat capacity is numerically indistinguishable from zero (for example at extremely low temperature), adopt the convention that the acoustic contribution dominates.\n\nUnits and output:\n- Express all temperatures in $\\mathrm{K}$, all angular frequencies in $\\mathrm{rad/s}$, and the final molar heat capacities in $\\mathrm{J/(mol\\cdot K)}$.\n- Your program must output, for each test case, a two-element list containing the molar heat capacity rounded to six decimal places and the dominance code as an integer. Aggregate the results into a single line printed as a list of such two-element lists, for example, $[[C_{1},d_{1}],[C_{2},d_{2}],\\dots]$.\n\nTest suite:\n- Case A parameters: $\\Theta_{\\mathrm{D}}=400\\,\\mathrm{K}$, $\\Theta_{\\mathrm{E}}=800\\,\\mathrm{K}$, $\\alpha=0.03$, $n_{\\mathrm{ac}}=3$, $n_{\\mathrm{op}}=3$.\n  - A1: $T=5\\,\\mathrm{K}$.\n  - A2: $T=200\\,\\mathrm{K}$.\n  - A3: $T=1500\\,\\mathrm{K}$.\n- Case B parameters: $\\Theta_{\\mathrm{D}}=300\\,\\mathrm{K}$, $\\Theta_{\\mathrm{E}}=900\\,\\mathrm{K}$, $\\alpha=0.03$, $n_{\\mathrm{ac}}=3$, $n_{\\mathrm{op}}=9$.\n  - B1: $T=600\\,\\mathrm{K}$.\n  - B2: $T=50\\,\\mathrm{K}$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element is itself a two-element list $[C_{V},d]$ with $C_{V}$ in $\\mathrm{J/(mol\\cdot K)}$ rounded to six decimal places and $d\\in\\{0,1,2\\}$, for the cases ordered as A1, A2, A3, B1, B2.", "solution": "The problem is valid as it is scientifically grounded in the principles of solid-state physics and statistical mechanics, well-posed with all necessary data and definitions, and objective in its formulation. The model, combining a Debye-like continuum for acoustic phonons with a Gaussian peak for optical phonons, is a standard and physically reasonable approximation used in materials science.\n\nThe solution proceeds in two stages: first, the derivation of the theoretical expression for the molar heat capacity at constant volume, $C_V(T)$; and second, the description of the numerical algorithm to compute $C_V(T)$ for the given parameters.\n\n**1. Theoretical Derivation of Molar Heat Capacity**\n\nThe crystalline solid is modeled as a gas of non-interacting quasi-particles, the phonons. As bosons, the average number of phonons in a mode of angular frequency $\\omega$ at thermal equilibrium at temperature $T$ is given by the Bose-Einstein distribution, $n(\\omega, T)$:\n$$n(\\omega, T) = \\frac{1}{\\exp\\left(\\frac{\\hbar \\omega}{k_{\\mathrm{B}} T}\\right) - 1}$$\nwhere $\\hbar$ is the reduced Planck constant and $k_{\\mathrm{B}}$ is the Boltzmann constant.\n\nThe average energy of a single phonon mode, including the zero-point energy, is $\\langle E(\\omega) \\rangle = \\hbar \\omega \\left(n(\\omega, T) + \\frac{1}{2}\\right)$. The total internal energy per mole, $U(T)$, is found by integrating the energy of each mode over the molar phonon density of states, $g(\\omega)$:\n$$U(T) = \\int_{0}^{\\infty} g(\\omega) \\langle E(\\omega) \\rangle d\\omega = \\int_{0}^{\\infty} g(\\omega) \\hbar \\omega \\left( \\frac{1}{\\exp\\left(\\frac{\\hbar \\omega}{k_{\\mathrm{B}} T}\\right) - 1} + \\frac{1}{2} \\right) d\\omega$$\nThe molar heat capacity at constant volume, $C_V(T)$, is the derivative of the internal energy with respect to temperature: $C_V(T) = \\left(\\frac{\\partial U}{\\partial T}\\right)_V$. The zero-point energy term, $\\int_{0}^{\\infty} g(\\omega) \\frac{\\hbar \\omega}{2} d\\omega$, is independent of temperature and thus its derivative is zero. We can interchange the order of differentiation and integration:\n$$C_V(T) = \\int_{0}^{\\infty} g(\\omega) \\frac{\\partial}{\\partial T} \\left( \\frac{\\hbar \\omega}{\\exp\\left(\\frac{\\hbar \\omega}{k_{\\mathrm{B}} T}\\right) - 1} \\right) d\\omega$$\nPerforming the differentiation with respect to $T$ yields:\n$$\\frac{\\partial}{\\partial T} \\left( \\frac{\\hbar \\omega}{\\exp\\left(\\frac{\\hbar \\omega}{k_{\\mathrm{B}} T}\\right) - 1} \\right) = \\hbar \\omega \\left( - \\frac{1}{\\left(\\exp\\left(\\frac{\\hbar \\omega}{k_{\\mathrm{B}} T}\\right) - 1\\right)^2} \\right) \\exp\\left(\\frac{\\hbar \\omega}{k_{\\mathrm{B}} T}\\right) \\left( -\\frac{\\hbar \\omega}{k_{\\mathrm{B}} T^2} \\right) = k_{\\mathrm{B}} \\left(\\frac{\\hbar \\omega}{k_{\\mathrm{B}} T}\\right)^2 \\frac{\\exp\\left(\\frac{\\hbar \\omega}{k_{\\mathrm{B}} T}\\right)}{\\left(\\exp\\left(\\frac{\\hbar \\omega}{k_{\\mathrm{B}} T}\\right) - 1\\right)^2}$$\nSubstituting this back into the integral for $C_V(T)$, we obtain the final expression:\n$$C_V(T) = \\int_{0}^{\\infty} g(\\omega) k_{\\mathrm{B}} \\left( \\frac{\\hbar \\omega}{k_{\\mathrm{B}} T} \\right)^2 \\frac{\\exp\\left(\\frac{\\hbar \\omega}{k_{\\mathrm{B}} T}\\right)}{\\left(\\exp\\left(\\frac{\\hbar \\omega}{k_{\\mathrm{B}} T}\\right) - 1\\right)^2} d\\omega$$\n\n**2. Numerical Implementation Strategy**\n\nThe total density of states is the sum of acoustic and optical contributions, $g(\\omega) = g_{\\mathrm{ac}}(\\omega) + g_{\\mathrm{op}}(\\omega)$. Consequently, the total heat capacity is the sum of the contributions from each branch: $C_V(T) = C_{V,\\mathrm{ac}}(T) + C_{V,\\mathrm{op}}(T)$.\n\nThe acoustic contribution, $C_{V,\\mathrm{ac}}(T)$, is calculated using the Debye-like DOS, $g_{\\mathrm{ac}}(\\omega) = A\\omega^2$, which is non-zero only for $0 \\le \\omega \\le \\omega_{\\mathrm{D}}$. The normalization constant $A$ is determined by the condition $\\int_{0}^{\\omega_{\\mathrm{D}}} A\\omega^2 d\\omega = N_{\\mathrm{ac}}$, which gives $A = \\frac{3N_{\\mathrm{ac}}}{\\omega_{\\mathrm{D}}^3}$. The number of acoustic modes per mole is $N_{\\mathrm{ac}} = n_{\\mathrm{ac}}N_{\\mathrm{A}}$. The cutoff frequency is $\\omega_{\\mathrm{D}} = \\frac{k_{\\mathrm{B}}\\Theta_{\\mathrm{D}}}{\\hbar}$. So, the acoustic contribution is:\n$$C_{V,\\mathrm{ac}}(T) = \\int_{0}^{\\omega_{\\mathrm{D}}} \\left(\\frac{3N_{\\mathrm{ac}}}{\\omega_{\\mathrm{D}}^3}\\omega^2\\right) k_{\\mathrm{B}} \\left( \\frac{\\hbar \\omega}{k_{\\mathrm{B}} T} \\right)^2 \\frac{\\exp\\left(\\frac{\\hbar \\omega}{k_{\\mathrm{B}} T}\\right)}{\\left(\\exp\\left(\\frac{\\hbar \\omega}{k_{\\mathrm{B}} T}\\right) - 1\\right)^2} d\\omega$$\n\nThe optical contribution, $C_{V,\\mathrm{op}}(T)$, is calculated using the Gaussian DOS, $g_{\\mathrm{op}}(\\omega) = \\frac{N_{\\mathrm{op}}}{\\sigma\\sqrt{2\\pi}}\\exp\\left(-\\frac{(\\omega-\\omega_{\\mathrm{E}})^2}{2\\sigma^2}\\right)$, integrated over $\\omega \\ge 0$. The parameters are $N_{\\mathrm{op}} = n_{\\mathrm{op}}N_{\\mathrm{A}}$, $\\omega_{\\mathrm{E}} = \\frac{k_{\\mathrm{B}}\\Theta_{\\mathrm{E}}}{\\hbar}$, and $\\sigma = \\alpha\\omega_{\\mathrm{E}}$.\n$$C_{V,\\mathrm{op}}(T) = \\int_{0}^{\\infty} \\left(\\frac{N_{\\mathrm{op}}}{\\sigma\\sqrt{2\\pi}}\\exp\\left(-\\frac{(\\omega-\\omega_{\\mathrm{E}})^2}{2\\sigma^2}\\right)\\right) k_{\\mathrm{B}} \\left( \\frac{\\hbar \\omega}{k_{\\mathrm{B}} T} \\right)^2 \\frac{\\exp\\left(\\frac{\\hbar \\omega}{k_{\\mathrm{B}} T}\\right)}{\\left(\\exp\\left(\\frac{\\hbar \\omega}{k_{\\mathrm{B}} T}\\right) - 1\\right)^2} d\\omega$$\n\nThese definite integrals are computed numerically. For numerical stability, the integrand kernel term is rewritten. Let $x = \\frac{\\hbar \\omega}{k_{\\mathrm{B}} T}$ and $y = x/2$. The kernel becomes:\n$$k_{\\mathrm{B}} x^2 \\frac{e^x}{(e^x-1)^2} = k_{\\mathrm{B}} x^2 \\frac{e^x}{(e^{x/2}(e^{x/2}-e^{-x/2}))^2} = k_{\\mathrm{B}} x^2 \\frac{e^x}{e^x(2\\sinh(x/2))^2} = k_{\\mathrm{B}} \\frac{(2y)^2}{4\\sinh^2(y)} = k_{\\mathrm{B}} \\left(\\frac{y}{\\sinh(y)}\\right)^2$$\nThis form avoids the numerical overflow associated with $\\exp(x)$ for large $x$ and is well-behaved for $y \\to 0$, where it correctly approaches $k_{\\mathrm{B}}$.\n\nThe numerical solution is implemented by defining functions for $g_{\\mathrm{ac}}(\\omega)$, $g_{\\mathrm{op}}(\\omega)$, and the stabilized kernel. The `scipy.integrate.quad` function is used to evaluate the integrals for $C_{V,\\mathrm{ac}}(T)$ and $C_{V,\\mathrm{op}}(T)$.\n\nFinally, the dominance regime is classified based on the relative contributions. Given the threshold fraction $f_{\\mathrm{dom}}=0.7$:\n- If $C_V(T)$ is numerically close to zero, the regime is coded as $0$ (acoustic-dominated) by convention.\n- If $\\frac{C_{V,\\mathrm{ac}}(T)}{C_V(T)} \\ge f_{\\mathrm{dom}}$, the code is $0$ (acoustic-dominated).\n- If $\\frac{C_{V,\\mathrm{op}}(T)}{C_V(T)} \\ge f_{\\mathrm{dom}}$, the code is $1$ (optical-dominated).\n- Otherwise, the code is $2$ (mixed).\n\nThe final molar heat capacity $C_V(T)$ is presented in $\\mathrm{J/(mol\\cdot K)}$ rounded to six decimal places, along with the integer dominance code.", "answer": "```python\nimport numpy as np\nfrom scipy.integrate import quad\n\ndef solve():\n    \"\"\"\n    Calculates the molar heat capacity of a solid with a composite phonon DOS\n    and determines the dominant contribution (acoustic or optical).\n    \"\"\"\n\n    # Physical Constants\n    KB = 1.380649e-23  # Boltzmann constant in J/K\n    HBAR = 1.054571817e-34  # Reduced Planck constant in J.s\n    NA = 6.02214076e23  # Avogadro constant in mol^-1\n    R = KB * NA  # Molar gas constant in J/(mol.K)\n    \n    # Dominance threshold\n    F_DOM = 0.7\n\n    test_cases = [\n        # Case A: Theta_D=400, Theta_E=800, alpha=0.03, n_ac=3, n_op=3\n        {'T': 5, 'Theta_D': 400, 'Theta_E': 800, 'alpha': 0.03, 'n_ac': 3, 'n_op': 3},  # A1\n        {'T': 200, 'Theta_D': 400, 'Theta_E': 800, 'alpha': 0.03, 'n_ac': 3, 'n_op': 3}, # A2\n        {'T': 1500, 'Theta_D': 400, 'Theta_E': 800, 'alpha': 0.03, 'n_ac': 3, 'n_op': 3},# A3\n        # Case B: Theta_D=300, Theta_E=900, alpha=0.03, n_ac=3, n_op=9\n        {'T': 600, 'Theta_D': 300, 'Theta_E': 900, 'alpha': 0.03, 'n_ac': 3, 'n_op': 9}, # B1\n        {'T': 50, 'Theta_D': 300, 'Theta_E': 900, 'alpha': 0.03, 'n_ac': 3, 'n_op': 9},  # B2\n    ]\n\n    def integrand_kernel(omega, T):\n        \"\"\"\n        Calculates the numerically stable kernel of the heat capacity integral.\n        Kernel: k_B * (y/sinh(y))^2 where y = hbar*omega/(2*k_B*T).\n        \"\"\"\n        if T == 0.0 or omega == 0.0:\n            return 0.0 # No contribution at T=0 or omega=0\n        \n        y = HBAR * omega / (2 * KB * T)\n        \n        # for y - 0, (y/sinh(y))^2 - 1.\n        # for y  700, sinh(y) overflows. We can use an asymptotic form\n        # but for the parameters in this problem, y does not reach this limit.\n        if y  1e-6:\n             return KB\n\n        return KB * (y / np.sinh(y))**2\n\n    def calculate_cv_for_case(params):\n        \"\"\"\n        Computes CV and dominance code for a single parameter set.\n        \"\"\"\n        T = params['T']\n        Theta_D = params['Theta_D']\n        Theta_E = params['Theta_E']\n        alpha = params['alpha']\n        n_ac = params['n_ac']\n        n_op = params['n_op']\n\n        # Derived parameters\n        w_D = KB * Theta_D / HBAR\n        w_E = KB * Theta_E / HBAR\n        sigma = alpha * w_E\n        N_ac = n_ac * NA\n        N_op = n_op * NA\n        A = 3 * N_ac / (w_D**3)\n\n        # 1. Acoustic Contribution\n        def g_ac(omega):\n            return A * omega**2\n\n        def ac_integrand(omega):\n            return g_ac(omega) * integrand_kernel(omega, T)\n\n        # Integrate over [0, w_D] for the acoustic part\n        cv_ac, _ = quad(ac_integrand, 0, w_D)\n\n        # 2. Optical Contribution\n        def g_op(omega):\n            norm = N_op / (sigma * np.sqrt(2 * np.pi))\n            return norm * np.exp(-0.5 * ((omega - w_E) / sigma)**2)\n\n        def op_integrand(omega):\n            return g_op(omega) * integrand_kernel(omega, T)\n\n        # Integrate over [0, inf) for the optical part.\n        # The Gaussian is sharply peaked, so numerical integration is efficient.\n        cv_op, _ = quad(op_integrand, 0, np.inf)\n\n        # 3. Total CV and dominance classification\n        cv_total = cv_ac + cv_op\n        \n        # Dominance code determination\n        dominance_code = 2  # Default to mixed\n        \n        if np.isclose(cv_total, 0.0, atol=1e-9):\n            # Convention for numerically zero CV (e.g., at very low T)\n            dominance_code = 0\n        elif cv_ac / cv_total = F_DOM:\n            dominance_code = 0  # Acoustic-dominated\n        elif cv_op / cv_total = F_DOM:\n            dominance_code = 1  # Optical-dominated\n        \n        return [round(cv_total, 6), dominance_code]\n\n    results = []\n    for case in test_cases:\n        result = calculate_cv_for_case(case)\n        results.append(result)\n\n    # Format output as a list of lists string. e.g., [[C1,d1],[C2,d2]]\n    results_str = [f\"[{res[0]},{res[1]}]\" for res in results]\n    print(f\"[{','.join(results_str)}]\")\n\nsolve()\n```", "id": "3477839"}, {"introduction": "A crucial step in becoming a computational materials scientist is bridging the gap between continuous theoretical models and the discrete approximations used in actual first-principles calculations. This practice directly addresses this by comparing the continuous Debye integral with a heat capacity calculated by summing over a discrete grid of wavevectors, mimicking how real software packages sample the Brillouin zone [@problem_id:3477869]. Through this comparison, you will investigate the critical concept of numerical convergence and quantify how the accuracy of a computed thermodynamic property depends on the density of the sampling grid.", "problem": "You are to write a complete and runnable program that, from first principles, compares the constant-volume heat capacity per atom predicted by the Debye model to a discretized lattice-dynamics estimate obtained by finite-displacement supercell sampling of reciprocal space. Your program must implement the two routes below and quantify sampling-induced errors as a function of the reciprocal-space sampling density. All physical quantities must be treated in a scientifically realistic and self-consistent way, and numerical answers must be computed in dimensionless form as specified.\n\nBegin from the following principles.\n\n- A crystalline solid supports quantized lattice vibrations (phonons). Each normal mode of angular frequency $\\omega$ carries an average thermal energy determined by Bose–Einstein statistics, where the occupation number is $n(\\omega,T)=\\left(\\exp\\{\\hbar\\omega/(k_{\\mathrm{B}}T)\\}-1\\right)^{-1}$ and the mode’s thermal energy contribution excludes the zero-point term. The constant-volume heat capacity of a single mode is the temperature derivative of its thermal energy with respect to $T$.\n- In the Debye model for an isotropic monatomic crystal, the three acoustic branches are approximated by a linear dispersion $\\omega=v\\lvert\\mathbf{q}\\rvert$ up to a cutoff wavevector magnitude $q_{\\mathrm{D}}$ chosen so that the total number of modes equals $3N$ for $N$ atoms. The Debye temperature is defined by $\\Theta_{\\mathrm{D}}=\\hbar\\omega_{\\mathrm{D}}/k_{\\mathrm{B}}$, where $\\omega_{\\mathrm{D}}=v q_{\\mathrm{D}}$.\n- The Brillouin-zone summation over wavevectors $\\mathbf{q}$ may be replaced by an integral over a sphere of radius $q_{\\mathrm{D}}$ with uniform measure in $\\mathbf{q}$, and the Debye prediction for the heat capacity per atom arises from integrating the per-mode heat capacity over this sphere with appropriate normalization.\n- A finite-displacement supercell of linear size $S$ samples the Brillouin zone on a $\\Gamma$-centered regular grid with $S$ points along each reciprocal lattice direction. In the isotropic Debye approximation, you may idealize this sampling by placing a regular $\\Gamma$-centered grid of $S\\times S\\times S$ points in the cube $[-q_{\\mathrm{D}},q_{\\mathrm{D}}]^3$ and retaining only those grid points inside the Debye sphere $\\lvert\\mathbf{q}\\rvert\\le q_{\\mathrm{D}}$. The lattice-dynamics heat capacity per atom is then approximated by the uniform average over the retained $\\mathbf{q}$ points of the three identical acoustic-mode contributions computed at $\\omega=v\\lvert\\mathbf{q}\\rvert$.\n\nTasks to implement.\n\n1) Implement a function that returns the Debye-model heat capacity per atom, as a dimensionless ratio $C_V/k_{\\mathrm{B}}$, at temperature $T$ for a given Debye temperature $\\Theta_{\\mathrm{D}}$. This function must be obtained by starting from the per-mode Bose–Einstein occupation and integrating over the Debye sphere as described above. The final expression involves the dimensionless Debye integral in terms of $x=\\hbar\\omega/(k_{\\mathrm{B}}T)$ and depends only on the ratio $T/\\Theta_{\\mathrm{D}}$. Do not introduce any phenomenological fitting parameters.\n\n2) Implement a function that returns the finite-displacement lattice-dynamics estimate of the heat capacity per atom, again as the dimensionless ratio $C_V/k_{\\mathrm{B}}$, using a $\\Gamma$-centered $S\\times S\\times S$ grid in the cube $[-q_{\\mathrm{D}},q_{\\mathrm{D}}]^3$, retaining only points with $\\lvert\\mathbf{q}\\rvert\\le q_{\\mathrm{D}}$, and averaging the three acoustic-mode contributions per wavevector. Use the same per-mode Bose–Einstein expression as in (1), with the linear dispersion $\\omega=v\\lvert\\mathbf{q}\\rvert$ and $v q_{\\mathrm{D}}=\\omega_{\\mathrm{D}}$ so that the dimensionless frequency is $\\lvert\\mathbf{q}\\rvert/q_{\\mathrm{D}}$ and the upper limit is $x_{\\mathrm{D}}=\\Theta_{\\mathrm{D}}/T$. Handle the $\\mathbf{q}=\\mathbf{0}$ mode by taking the appropriate zero-frequency limit of the per-mode heat capacity integrand.\n\n3) Using the two functions above, compute the following test suite of metrics. All temperatures must be treated in Kelvin, all Debye temperatures $\\Theta_{\\mathrm{D}}$ are given in Kelvin, and the final reported metrics must be dimensionless decimal numbers.\n\n- Case A (happy path, mixed-temperature coverage): $\\Theta_{\\mathrm{D}}=400\\,\\mathrm{K}$, temperatures $T\\in\\{20,80,400,2000\\}\\,\\mathrm{K}$, sampling size $S=6$. Compute the maximum absolute relative error over the temperature list between the finite-displacement estimate and the Debye prediction,\n$$\\max_{T}\\left\\lvert \\frac{\\left(C_V^{\\mathrm{FD}}/k_{\\mathrm{B}}\\right)-\\left(C_V^{\\mathrm{Debye}}/k_{\\mathrm{B}}\\right)}{\\left(C_V^{\\mathrm{Debye}}/k_{\\mathrm{B}}\\right)}\\right\\rvert,$$\nand return it as a decimal number.\n\n- Case B (refinement comparison): $\\Theta_{\\mathrm{D}}=400\\,\\mathrm{K}$, temperatures $T\\in\\{20,80,400,2000\\}\\,\\mathrm{K}$, sampling size $S=12$. Compute the same maximum absolute relative error as in Case A and return it as a decimal number.\n\n- Case C (low-temperature scaling stress test): $\\Theta_{\\mathrm{D}}=300\\,\\mathrm{K}$, temperatures $T\\in\\{3,6,9,12,15\\}\\,\\mathrm{K}$, sampling size $S=8$. Using only the finite-displacement estimates, estimate the low-temperature scaling exponent $p$ by a least-squares fit of $\\ln\\left(C_V^{\\mathrm{FD}}/k_{\\mathrm{B}}\\right)$ versus $\\ln T$ over the provided temperatures and return the absolute deviation $\\lvert p-3\\rvert$ as a decimal number.\n\n- Case D (observed sampling-convergence order at a representative temperature): $\\Theta_{\\mathrm{D}}=400\\,\\mathrm{K}$, fixed temperature $T=\\Theta_{\\mathrm{D}}$, two sampling sizes $S_1=6$ and $S_2=12$. Compute the absolute relative errors $e(S_1)$ and $e(S_2)$ at this single temperature as defined in Case A and return the observed convergence order\n$$\\alpha=\\frac{\\ln\\left(e(S_1)/e(S_2)\\right)}{\\ln\\left(S_2/S_1\\right)}$$\nas a decimal number.\n\nFinal output format.\n\n- Your program should produce a single line of output containing the results of Cases A–D, in that order, as a comma-separated list enclosed in square brackets, for example, $\\left[\\text{A},\\text{B},\\text{C},\\text{D}\\right]$, where each entry is a decimal number. No other output is permitted.\n\nNotes and constraints.\n\n- Use $k_{\\mathrm{B}}$ only as a symbolic unit to form the dimensionless ratio $C_V/k_{\\mathrm{B}}$. All final reported quantities must be unitless decimals.\n- All integration and summation routines must be numerically stable across the specified ranges. Treat the $x\\to 0$ limit of the per-mode heat capacity using its correct limiting value.\n- Do not introduce any external inputs; all parameters are as specified above and must be hard-coded according to the test suite.", "solution": "The problem requires a comparative analysis of the constant-volume heat capacity of a monatomic crystalline solid as predicted by the continuous Debye model and a discretized lattice-dynamics approximation. The analysis will be performed by implementing both models from first principles and evaluating their agreement and behavior across a specified suite of test cases.\n\n### 1. Foundational Principles: Phonon Heat Capacity\n\nThe thermal properties of a crystalline solid are largely determined by its lattice vibrations, which can be quantized as phonons. Each phonon mode, corresponding to a normal mode of vibration with a specific angular frequency $\\omega$ and wavevector $\\mathbf{q}$, behaves as a quantum harmonic oscillator. The average thermal energy $\\langle E \\rangle$ of a single mode at temperature $T$, excluding the constant zero-point energy, is given by the product of the energy quantum $\\hbar\\omega$ and the average occupation number from Bose-Einstein statistics, $n(\\omega, T)$:\n$$\n\\langle E \\rangle = \\hbar\\omega \\, n(\\omega, T) = \\frac{\\hbar\\omega}{\\exp\\left(\\frac{\\hbar\\omega}{k_{\\mathrm{B}}T}\\right) - 1}\n$$\nwhere $\\hbar$ is the reduced Planck constant and $k_{\\mathrm{B}}$ is the Boltzmann constant. The constant-volume heat capacity of this single mode, $C_{V, \\text{mode}}$, is the derivative of its average energy with respect to temperature:\n$$\nC_{V, \\text{mode}} = \\frac{\\partial \\langle E \\rangle}{\\partial T}\n$$\n\nTo facilitate the derivation, we introduce the dimensionless variable $x = \\hbar\\omega/(k_{\\mathrm{B}}T)$. The partial derivative with respect to $T$ can be expressed in terms of $x$: $\\frac{\\partial}{\\partial T} = \\frac{\\partial x}{\\partial T}\\frac{d}{dx} = -\\frac{\\hbar\\omega}{k_{\\mathrm{B}}T^2}\\frac{d}{dx} = -\\frac{x}{T}\\frac{d}{dx}$.\nApplying this to the energy expression $\\langle E \\rangle = k_{\\mathrm{B}}T \\frac{x}{e^x - 1}$ would be cumbersome. Instead, we differentiate directly:\n$$\nC_{V, \\text{mode}} = \\frac{\\partial}{\\partial T} \\left( \\frac{\\hbar\\omega}{e^{\\hbar\\omega/(k_{\\mathrm{B}}T)} - 1} \\right) = \\hbar\\omega \\left( - \\frac{1}{(e^{\\hbar\\omega/(k_{\\mathrm{B}}T)} - 1)^2} \\right) \\left( e^{\\hbar\\omega/(k_{\\mathrm{B}}T)} \\right) \\left( -\\frac{\\hbar\\omega}{k_{\\mathrm{B}}T^2} \\right)\n$$\nSimplifying and expressing this in dimensionless form gives the heat capacity contribution per mode, which is the fundamental building block for both models:\n$$\n\\frac{C_{V, \\text{mode}}}{k_{\\mathrm{B}}} = \\left(\\frac{\\hbar\\omega}{k_{\\mathrm{B}}T}\\right)^2 \\frac{\\exp\\left(\\frac{\\hbar\\omega}{k_{\\mathrm{B}}T}\\right)}{\\left(\\exp\\left(\\frac{\\hbar\\omega}{k_{\\mathrm{B}}T}\\right) - 1\\right)^2} = \\frac{x^2 e^x}{(e^x - 1)^2}\n$$\nIn the low-frequency limit, as $\\omega \\to 0$ (and thus $x \\to 0$), we use the Taylor expansion $e^x \\approx 1 + x + x^2/2$, which gives $(e^x - 1)^2 \\approx x^2$. The expression simplifies to $\\frac{x^2(1+x)}{x^2} \\approx 1+x$, and the limit is $1$:\n$$\n\\lim_{x \\to 0} \\frac{C_{V, \\text{mode}}}{k_{\\mathrm{B}}} = 1\n$$\nThis limit is crucial for handling the acoustic mode at $\\mathbf{q}=\\mathbf{0}$.\n\n### 2. The Debye Model for Heat Capacity ($C_V^{\\text{Debye}}$)\n\nThe Debye model approximates the phonon spectrum of a solid to calculate the total heat capacity. It assumes a linear, isotropic dispersion relation $\\omega = v|\\mathbf{q}|$ for all three acoustic modes up to a cutoff frequency $\\omega_{\\mathrm{D}}$. This cutoff is chosen to ensure the correct total number of modes, $3N$ for a solid with $N$ atoms. This leads to a density of states (number of modes per unit frequency) given by $g(\\omega) = \\frac{9N\\omega^2}{\\omega_{\\mathrm{D}}^3}$ for $\\omega \\le \\omega_{\\mathrm{D}}$ and $g(\\omega)=0$ otherwise.\n\nThe total heat capacity per atom, $C_V^{\\text{Debye}}$, is found by integrating the single-mode heat capacity weighted by the normalized density of states over all allowed frequencies:\n$$\n\\frac{C_V^{\\text{Debye}}}{k_{\\mathrm{B}}} = \\frac{1}{N} \\int_0^{\\omega_{\\mathrm{D}}} \\frac{C_{V, \\text{mode}}}{k_{\\mathrm{B}}} g(\\omega) \\, d\\omega = \\int_0^{\\omega_{\\mathrm{D}}} \\frac{x^2 e^x}{(e^x - 1)^2} \\frac{9\\omega^2}{\\omega_{\\mathrm{D}}^3} \\, d\\omega\n$$\nTo evaluate this integral, we change the variable of integration from $\\omega$ to the dimensionless $y = \\hbar\\omega/(k_{\\mathrm{B}}T)$. This gives $\\omega = \\frac{k_{\\mathrm{B}}T}{\\hbar}y$ and $d\\omega = \\frac{k_{\\mathrm{B}}T}{\\hbar}dy$. The upper integration limit becomes $y_D = \\hbar\\omega_{\\mathrm{D}}/(k_{\\mathrm{B}}T) = \\Theta_{\\mathrm{D}}/T$, where $\\Theta_{\\mathrm{D}}$ is the Debye temperature. The expression becomes:\n$$\n\\frac{C_V^{\\text{Debye}}}{k_{\\mathrm{B}}} = \\frac{9}{\\omega_{\\mathrm{D}}^3} \\int_0^{\\Theta_{\\mathrm{D}}/T} \\frac{y^2 e^y}{(e^y - 1)^2} \\left( \\frac{k_{\\mathrm{B}}T}{\\hbar}y \\right)^2 \\left( \\frac{k_{\\mathrm{B}}T}{\\hbar} \\right) \\, dy\n$$\nSubstituting $\\omega_{\\mathrm{D}} = k_{\\mathrm{B}}\\Theta_{\\mathrm{D}}/\\hbar$, we arrive at the standard form for the Debye heat capacity:\n$$\n\\frac{C_V^{\\text{Debye}}}{k_{\\mathrm{B}}} = 9 \\left( \\frac{T}{\\Theta_{\\mathrm{D}}} \\right)^3 \\int_0^{\\Theta_{\\mathrm{D}}/T} \\frac{y^4 e^y}{(e^y - 1)^2} \\, dy\n$$\nThis definite integral must be evaluated numerically.\n\n### 3. The Finite-Displacement (FD) Model ($C_V^{\\text{FD}}$)\n\nThe finite-displacement approach approximates the integral over the Brillouin zone with a discrete sum over a grid of wavevectors $\\mathbf{q}$. The problem specifies an idealized sampling scheme: a regular, $\\Gamma$-centered grid of $S \\times S \\times S$ points is placed within the cube $[-q_{\\mathrm{D}}, q_{\\mathrm{D}}]^3$.\n\nTo construct this grid, we define $S$ points along each Cartesian axis spanning the interval $[-q_{\\mathrm{D}}, q_{\\mathrm{D}}]$. For $S  1$, the coordinates along one dimension are given by $q_i = q_{\\mathrm{D}} \\left(-1 + \\frac{2k}{S-1}\\right)$ for $k \\in \\{0, 1, \\dots, S-1\\}$. This creates a grid that includes the boundaries of the cube. The full $3$D grid consists of all points $\\mathbf{q} = (q_x, q_y, q_z)$ formed by combinations of these coordinates.\n\nFrom this grid, only the points that lie within the Debye sphere, i.e., those satisfying $|\\mathbf{q}| \\le q_{\\mathrm{D}}$, are retained for the calculation.\n\nThe heat capacity per atom, $C_V^{\\text{FD}}/k_{\\mathrm{B}}$, is defined as the \"uniform average over the retained $\\mathbf{q}$ points of the three identical acoustic-mode contributions\". Let $N_q$ be the number of retained grid points. For each retained point $\\mathbf{q}_i$, we calculate the dimensionless frequency variable $x_i = \\hbar\\omega_i/(k_{\\mathrm{B}}T)$. Using the linear dispersion $\\omega_i = v|\\mathbf{q}_i|$ and the relation $\\Theta_{\\mathrm{D}} = \\hbar v q_{\\mathrm{D}}/k_{\\mathrm{B}}$, this becomes $x_i = \\frac{|\\mathbf{q}_i|}{q_{\\mathrm{D}}} \\frac{\\Theta_{\\mathrm{D}}}{T}$. The contribution of the three modes at $\\mathbf{q}_i$ is $3 \\cdot (C_{V, \\text{mode}}/k_{\\mathrm{B}})$. Averaging these contributions over the $N_q$ points gives:\n$$\n\\frac{C_V^{\\text{FD}}}{k_{\\mathrm{B}}} = \\frac{1}{N_q} \\sum_{i=1}^{N_q} 3 \\cdot \\frac{C_{V, \\text{mode}}(x_i)}{k_{\\mathrm{B}}} = \\frac{3}{N_q} \\sum_{i=1}^{N_q} \\frac{x_i^2 e^{x_i}}{(e^{x_i} - 1)^2}\n$$\nThis formulation correctly yields the Dulong-Petit limit of $3$ as $T \\to \\infty$ (since $x_i \\to 0$ and the per-mode contribution approaches $1$). For the even values of $S$ used in the test cases, the grid does not include the $\\mathbf{q}=\\mathbf{0}$ point, so the $x \\to 0$ limit is not strictly needed for those specific calculations, but a robust algorithm must handle it.\n\n### 4. Computational Strategy and Test Cases\n\nThe solution is implemented as a Python program utilizing the `numpy` and `scipy` libraries.\n\n- **`debye_cv` function**: Implements the Debye model. It takes $T$ and $\\Theta_{\\mathrm{D}}$ as input and uses `scipy.integrate.quad` to numerically evaluate the definite integral for $C_V^{\\text{Debye}}/k_{\\mathrm{B}}$.\n- **`fd_cv` function**: Implements the finite-displacement model. It takes $T$, $\\Theta_{\\mathrm{D}}$, and the grid size $S$ as input. It programmatically generates the $S \\times S \\times S$ grid, filters the points inside the Debye sphere, calculates the per-mode contributions for all retained points, and computes the final average as specified. Numerical stability for small $x$ is ensured by using `numpy.expm1`.\n\nThe main program then executes the four test cases as specified:\n- **Case A  B**: For a set of temperatures ($T \\in \\{20, 80, 400, 2000\\}\\,\\mathrm{K}$) and a given $\\Theta_{\\mathrm{D}}=400\\,\\mathrm{K}$, both `debye_cv` and `fd_cv` (with $S=6$ for A, $S=12$ for B) are called. The maximum absolute relative error, $\\max_T |(C_V^{\\mathrm{FD}} - C_V^{\\mathrm{Debye}})/C_V^{\\mathrm{Debye}}|$, is calculated.\n- **Case C**: For a set of low temperatures ($T \\in \\{3, 6, 9, 12, 15\\}\\,\\mathrm{K}$) with $\\Theta_{\\mathrm{D}}=300\\,\\mathrm{K}$ and $S=8$, the `fd_cv` function is used to compute heat capacities. A linear least-squares fit (`numpy.polyfit`) is performed on $\\ln(C_V^{\\mathrm{FD}}/k_{\\mathrm{B}})$ versus $\\ln(T)$. The slope of this line, $p$, is an estimate of the low-temperature scaling exponent. The absolute deviation $|p-3|$ is reported, testing the model's ability to reproduce the expected $T^3$ law.\n- **Case D**: The convergence of the FD approximation with respect to grid density is analyzed. At a fixed temperature $T=\\Theta_{\\mathrm{D}}=400\\,\\mathrm{K}$, the absolute relative errors $e(S)$ are computed for $S_1=6$ and $S_2=12$. The observed order of convergence, $\\alpha = \\ln(e(S_1)/e(S_2))/\\ln(S_2/S_1)$, is then calculated.\n\nThe final output is a list of the four resulting decimal numbers.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import integrate\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem by implementing Debye and Finite-Displacement\n    models for heat capacity and evaluating the specified test cases.\n    \"\"\"\n\n    def debye_cv(T, Theta_D):\n        \"\"\"\n        Calculates the Debye model heat capacity per atom (dimensionless C_V/k_B).\n\n        Args:\n            T (float): Temperature in Kelvin.\n            Theta_D (float): Debye temperature in Kelvin.\n\n        Returns:\n            float: Dimensionless heat capacity C_V / k_B.\n        \"\"\"\n        if T == 0.0:\n            return 0.0\n        \n        # Upper limit for the Debye integral\n        x_D = Theta_D / T\n\n        def integrand(y):\n            \"\"\"The integrand of the Debye heat capacity integral.\"\"\"\n            if np.isclose(y, 0.0):\n                # The integrand behaves as y**2 near 0, but is 0 at y=0.\n                return 0.0\n            # Use np.expm1 for numerical stability for small y\n            return (y**4 * np.exp(y)) / (np.expm1(y))**2\n\n        integral_val, _ = integrate.quad(integrand, 0, x_D, epsabs=1e-12, epsrel=1e-12)\n        \n        return 9.0 * (T / Theta_D)**3 * integral_val\n\n    def fd_cv(T, Theta_D, S):\n        \"\"\"\n        Calculates the finite-displacement heat capacity per atom (dimensionless C_V/k_B).\n\n        Args:\n            T (float): Temperature in Kelvin.\n            Theta_D (float): Debye temperature in Kelvin.\n            S (int): Linear size of the reciprocal-space sampling grid.\n\n        Returns:\n            float: Dimensionless heat capacity C_V / k_B.\n        \"\"\"\n        if T == 0.0:\n            return 0.0\n\n        # 1. Generate dimensionless q-grid coordinates in the cube [-1, 1]^3\n        if S == 1:\n            q_coords_1d = np.array([0.0])\n        else:\n            k = np.arange(S)\n            q_coords_1d = -1.0 + 2.0 * k / (S - 1.0)\n        \n        qx, qy, qz = np.meshgrid(q_coords_1d, q_coords_1d, q_coords_1d, indexing='ij')\n        \n        # 2. Filter points inside the Debye sphere (|q'| = 1)\n        q_mag_sq = qx**2 + qy**2 + qz**2\n        retained_mask = q_mag_sq = 1.0\n        \n        q_mag_retained = np.sqrt(q_mag_sq[retained_mask])\n        num_retained_q = q_mag_retained.size\n        \n        if num_retained_q == 0:\n            return 0.0\n\n        # 3. Calculate heat capacity contributions\n        x_D_factor = Theta_D / T\n        x_values = q_mag_retained * x_D_factor\n        \n        # Get per-mode contributions, C_V,mode / k_B\n        cv_contributions = np.zeros_like(x_values)\n        \n        nonzero_mask = ~np.isclose(x_values, 0.0)\n        \n        # For q=0, x=0, contribution is 1.0\n        cv_contributions[~nonzero_mask] = 1.0\n        \n        x_nz = x_values[nonzero_mask]\n        cv_contributions[nonzero_mask] = (x_nz**2 * np.exp(x_nz)) / (np.expm1(x_nz))**2\n        \n        # 4. Compute the average as per the problem statement\n        # C_V/k_B = (1/Nq) * sum(3 * per_mode_cv) = 3 * mean(per_mode_cv)\n        total_cv_per_kB = 3.0 * np.mean(cv_contributions)\n        \n        return total_cv_per_kB\n\n    # --- Test Case Execution ---\n    \n    # Case A: Max relative error for S=6\n    Theta_D_A = 400.0\n    T_A = np.array([20.0, 80.0, 400.0, 2000.0])\n    S_A = 6\n    errors_A = []\n    for T in T_A:\n        cv_debye_val = debye_cv(T, Theta_D_A)\n        cv_fd_val = fd_cv(T, Theta_D_A, S_A)\n        if cv_debye_val  1e-12:\n            errors_A.append(np.abs((cv_fd_val - cv_debye_val) / cv_debye_val))\n        else:\n            errors_A.append(np.abs(cv_fd_val - cv_debye_val))\n    result_A = np.max(errors_A)\n    \n    # Case B: Max relative error for S=12\n    Theta_D_B = 400.0\n    T_B = np.array([20.0, 80.0, 400.0, 2000.0])\n    S_B = 12\n    errors_B = []\n    for T in T_B:\n        cv_debye_val = debye_cv(T, Theta_D_B)\n        cv_fd_val = fd_cv(T, Theta_D_B, S_B)\n        if cv_debye_val  1e-12:\n            errors_B.append(np.abs((cv_fd_val - cv_debye_val) / cv_debye_val))\n        else:\n            errors_B.append(np.abs(cv_fd_val - cv_debye_val))\n    result_B = np.max(errors_B)\n    \n    # Case C: Low-temperature scaling exponent\n    Theta_D_C = 300.0\n    T_C = np.array([3.0, 6.0, 9.0, 12.0, 15.0])\n    S_C = 8\n    cv_fd_C = np.array([fd_cv(T, Theta_D_C, S_C) for T in T_C])\n    \n    p = np.polyfit(np.log(T_C), np.log(cv_fd_C), 1)[0]\n    result_C = np.abs(p - 3.0)\n\n    # Case D: Observed convergence order\n    Theta_D_D = 400.0\n    T_D = Theta_D_D\n    S1, S2 = 6, 12\n    \n    cv_debye_D = debye_cv(T_D, Theta_D_D)\n    \n    cv_fd_S1 = fd_cv(T_D, Theta_D_D, S1)\n    e_S1 = np.abs((cv_fd_S1 - cv_debye_D) / cv_debye_D)\n\n    cv_fd_S2 = fd_cv(T_D, Theta_D_D, S2)\n    e_S2 = np.abs((cv_fd_S2 - cv_debye_D) / cv_debye_D)\n    \n    if e_S2 == 0:\n        # Handle case of perfect convergence for simplicity, though unlikely\n        result_D = np.inf\n    else:\n        result_D = np.log(e_S1 / e_S2) / np.log(S2 / S1)\n    \n    # --- Final Output ---\n    \n    # Collect results and print in the required format\n    results = [result_A, result_B, result_C, result_D]\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3477869"}]}