{"hands_on_practices": [{"introduction": "The parameters of an empirical potential like the Lennard-Jones model are not arbitrary; they must be grounded in physical reality. This exercise demonstrates the fundamental process of parameterization, where the abstract energy ($\\epsilon$) and length ($\\sigma$) scales of the potential are derived from more tangible physical observables. By connecting the model to the known long-range van der Waals interaction and the equilibrium separation distance, you will practice the essential skill of ensuring a potential model quantitatively reproduces key experimental or first-principles data. [@problem_id:3472763]", "problem": "In computational materials science, empirical pair potentials are often parameterized to reproduce known long-range behavior and equilibrium properties. Consider the generalized $m$-$6$ Lennard-Jones (LJ) pair potential for two identical neutral atoms, defined as\n$$\nu(r) \\;=\\; \\epsilon \\left[ \\left( \\frac{\\sigma}{r} \\right)^{m} \\;-\\; \\left( \\frac{\\sigma}{r} \\right)^{6} \\right],\n$$\nwhere $r$ is the scalar separation, $\\epsilon$ is the energy scale, $\\sigma$ is the characteristic length scale, and $m$ is a repulsion exponent satisfying $m>6$. The asymptotic van der Waals interaction between neutral atoms yields a long-range tail $u(r) \\sim -C_{6}/r^{6}$ as $r \\to \\infty$, where $C_{6} > 0$ is the dispersion coefficient. Additionally, the equilibrium separation $r_{m} > 0$ is defined as the location of the minimum of $u(r)$.\n\nStarting from the given model definition, the asymptotic tail $u(r) \\sim -C_{6}/r^{6}$, and the condition that $r_{m}$ is the minimizer of $u(r)$, derive closed-form expressions for $\\epsilon$ and $\\sigma$ in terms of $C_{6}$, $r_{m}$, and $m$. Express your final answer as a single analytical expression containing both $\\epsilon$ and $\\sigma$ arranged as a row vector. No numerical rounding is required, and no units should be included in the final expression.", "solution": "The problem is to determine the parameters $\\epsilon$ and $\\sigma$ of the generalized $m$-$6$ Lennard-Jones potential in terms of the dispersion coefficient $C_6$, the equilibrium separation $r_m$, and the repulsion exponent $m$. The potential is given by\n$$\nu(r) \\;=\\; \\epsilon \\left[ \\left( \\frac{\\sigma}{r} \\right)^{m} \\;-\\; \\left( \\frac{\\sigma}{r} \\right)^{6} \\right]\n$$\nwith the constraints that $m>6$, $C_6 > 0$, and $r_m > 0$. We are provided with two conditions to determine the two unknowns, $\\epsilon$ and $\\sigma$.\n\nFirst, we utilize the condition on the long-range asymptotic behavior of the potential. For large separations $r \\to \\infty$, the potential is given to approach the form $u(r) \\sim -C_{6}/r^{6}$. Let us analyze the given potential in this limit. The potential can be expanded as:\n$$\nu(r) \\;=\\; \\frac{\\epsilon \\sigma^m}{r^m} \\;-\\; \\frac{\\epsilon \\sigma^6}{r^6}\n$$\nSince the exponent $m$ is greater than $6$, the term $r^{-m}$ decays faster than the term $r^{-6}$ as $r \\to \\infty$. Therefore, for large $r$, the potential is dominated by the $r^{-6}$ term:\n$$\nu(r) \\;\\sim\\; -\\frac{\\epsilon \\sigma^6}{r^6} \\quad \\text{as} \\quad r \\to \\infty\n$$\nBy comparing this with the given asymptotic form $u(r) \\sim -C_{6}/r^{6}$, we can equate the coefficients:\n$$\n-\\frac{\\epsilon \\sigma^6}{r^6} \\;=\\; -\\frac{C_6}{r^6}\n$$\nThis yields our first equation relating the parameters:\n$$\n\\epsilon \\sigma^6 \\;=\\; C_6\n$$\n\nSecond, we use the condition that $r_{m}$ is the equilibrium separation, which corresponds to the minimum of the potential energy function $u(r)$. At a minimum, the first derivative of the potential with respect to the separation $r$ must be zero. We compute the derivative of $u(r)$:\n$$\n\\frac{du}{dr} \\;=\\; \\frac{d}{dr} \\left( \\epsilon \\sigma^m r^{-m} - \\epsilon \\sigma^6 r^{-6} \\right)\n$$\n$$\n\\frac{du}{dr} \\;=\\; \\epsilon \\sigma^m (-m r^{-m-1}) - \\epsilon \\sigma^6 (-6 r^{-6-1})\n$$\n$$\n\\frac{du}{dr} \\;=\\; -m \\epsilon \\frac{\\sigma^m}{r^{m+1}} + 6 \\epsilon \\frac{\\sigma^6}{r^{7}}\n$$\nWe set this derivative to zero at $r = r_m$:\n$$\n\\frac{du}{dr}\\bigg|_{r=r_m} \\;=\\; -m \\epsilon \\frac{\\sigma^m}{r_m^{m+1}} + 6 \\epsilon \\frac{\\sigma^6}{r_m^{7}} \\;=\\; 0\n$$\nSince $\\epsilon > 0$ (as it represents the depth of the potential well, and $C_6 > 0$), we can divide by $\\epsilon$:\n$$\nm \\frac{\\sigma^m}{r_m^{m+1}} \\;=\\; 6 \\frac{\\sigma^6}{r_m^{7}}\n$$\nWe can rearrange this equation to solve for $\\sigma$. Assuming $\\sigma>0$ and $r_m>0$, we can divide by $\\sigma^6$ and multiply by $r_m^{m+1}$:\n$$\nm \\sigma^{m-6} \\;=\\; 6 r_m^{m-6}\n$$\n$$\n\\frac{\\sigma^{m-6}}{r_m^{m-6}} \\;=\\; \\frac{6}{m}\n$$\n$$\n\\left( \\frac{\\sigma}{r_m} \\right)^{m-6} \\;=\\; \\frac{6}{m}\n$$\nTaking the $(m-6)$-th root of both sides gives the ratio $\\sigma/r_m$:\n$$\n\\frac{\\sigma}{r_m} \\;=\\; \\left( \\frac{6}{m} \\right)^{\\frac{1}{m-6}}\n$$\nThis allows us to express $\\sigma$ in terms of $r_m$ and $m$:\n$$\n\\sigma \\;=\\; r_m \\left( \\frac{6}{m} \\right)^{\\frac{1}{m-6}}\n$$\nThis is the closed-form expression for $\\sigma$. For this to be a minimum, the second derivative $d^2u/dr^2$ must be positive at $r=r_m$. The second derivative is\n$$\n\\frac{d^2u}{dr^2} = m(m+1)\\epsilon\\frac{\\sigma^m}{r^{m+2}} - 42\\epsilon\\frac{\\sigma^6}{r^8}\n$$\nAt $r=r_m$, using $m \\sigma^m / r_m^{m+1} = 6 \\sigma^6 / r_m^7$, we get $\\sigma^m / r_m^m = (6/m) \\sigma^6 / r_m^6$. Substituting this into the second derivative at $r_m$:\n$$\n\\frac{d^2u}{dr^2}\\bigg|_{r=r_m} = \\frac{\\epsilon\\sigma^6}{r_m^8}\\left( m(m+1)\\frac{\\sigma^{m-6}}{r_m^{m-6}} - 42 \\right) = \\frac{\\epsilon\\sigma^6}{r_m^8}\\left( m(m+1)\\frac{6}{m} - 42 \\right) = \\frac{\\epsilon\\sigma^6}{r_m^8}\\left( 6(m+1) - 42 \\right) = \\frac{6\\epsilon\\sigma^6}{r_m^8}(m-6)\n$$\nSince $\\epsilon > 0$, $\\sigma > 0$, $r_m > 0$, and we are given $m>6$, the second derivative is positive, confirming that $r_m$ is a location of a minimum.\n\nNow we can find the expression for $\\epsilon$. From our first derived relation, $\\epsilon = C_6 / \\sigma^6$. We substitute our expression for $\\sigma$:\n$$\n\\sigma^6 \\;=\\; \\left[ r_m \\left( \\frac{6}{m} \\right)^{\\frac{1}{m-6}} \\right]^6 \\;=\\; r_m^6 \\left( \\frac{6}{m} \\right)^{\\frac{6}{m-6}}\n$$\nSubstituting this into the expression for $\\epsilon$:\n$$\n\\epsilon \\;=\\; \\frac{C_6}{\\sigma^6} \\;=\\; \\frac{C_6}{r_m^6 \\left( \\frac{6}{m} \\right)^{\\frac{6}{m-6}}}\n$$\nThis can be rewritten as:\n$$\n\\epsilon \\;=\\; \\frac{C_6}{r_m^6} \\left( \\frac{m}{6} \\right)^{\\frac{6}{m-6}}\n$$\nThis is the closed-form expression for $\\epsilon$.\n\nIn summary, the derived expressions for $\\epsilon$ and $\\sigma$ are:\n$$\n\\epsilon \\;=\\; \\frac{C_6}{r_m^6} \\left( \\frac{m}{6} \\right)^{\\frac{6}{m-6}}\n$$\n$$\n\\sigma \\;=\\; r_m \\left( \\frac{6}{m} \\right)^{\\frac{1}{m-6}}\n$$\nThe problem asks for these to be arranged as a row vector.", "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{C_6}{r_m^6} \\left( \\frac{m}{6} \\right)^{\\frac{6}{m-6}} & r_m \\left( \\frac{6}{m} \\right)^{\\frac{1}{m-6}} \\end{pmatrix}}\n$$", "id": "3472763"}, {"introduction": "In molecular simulations, the computational cost of evaluating long-range interactions is often prohibitive, necessitating the use of a cutoff radius beyond which interactions are ignored. However, simply truncating a potential creates discontinuities in the force, which can lead to poor energy conservation and unstable simulations. This practice guides you through the rigorous construction of a smooth switching function that ensures the potential, its corresponding force, and the force's derivative ($C^2$ continuity) all go to zero gracefully at the cutoff, a critical technique for developing robust and accurate simulation protocols. [@problem_id:3472801]", "problem": "Consider the Lennard-Jones pair potential (LJ) used in molecular simulations, defined by $u(r) = 4 \\epsilon \\left[ \\left( \\frac{\\sigma}{r} \\right)^{12} - \\left( \\frac{\\sigma}{r} \\right)^{6} \\right]$, where $\\epsilon > 0$ sets the energy scale and $\\sigma > 0$ sets the characteristic length scale. In computational materials science, it is common to truncate and smoothly switch off the interaction beyond a cutoff radius to mitigate artifacts, while preserving differentiability needed for stable energy conservation and accurate force and Hessian evaluation. Let $r_s$ and $r_c$ be radii such that $0 < r_s < r_c$, where the switch begins at $r = r_s$ and ends at $r = r_c$, with the potential being fully off for $r \\geq r_c$.\n\nConstruct a switching function $S(r)$ and formulate the switched potential $u_S(r) = S(r)\\,u(r)$ such that:\n- $S(r)$ is constant for $r \\leq r_s$ and exactly zero for $r \\geq r_c$,\n- the switched potential $u_S(r)$ has continuous value, first derivative, and second derivative at both $r = r_s$ and $r = r_c$.\n\nBegin from first principles by enforcing the necessary endpoint continuity conditions implied by the product rule for derivatives of $u_S(r) = S(r)\\,u(r)$ and by expressing the switch in terms of a rescaled coordinate $t(r)$ over the interval $[r_s, r_c]$. Derive the minimal-degree polynomial form of $S(r)$ on $(r_s, r_c)$ that satisfies all constraints, and provide the final analytic expression for the piecewise-defined switched Lennard-Jones potential $u_S(r)$ in terms of $\\epsilon$, $\\sigma$, $r_s$, $r_c$, and $r$. Your final answer must be a single closed-form expression for $u_S(r)$ written using a single auxiliary variable $t(r)$ defined in terms of $r$, and must include the expressions applicable to all $r$. No numerical evaluation is required.", "solution": "The switched potential $u_S(r)$ is defined piecewise.\nFor $r \\leq r_s$, the potential is the un-switched Lennard-Jones potential. Since $S(r)$ is constant in this region, and for $u_S(r)$ to match $u(r)$, we must have $S(r) = 1$. The derivatives are $u_S'(r) = u'(r)$ and $u_S''(r) = u''(r)$.\nFor $r \\geq r_c$, the potential is zero, so $u_S(r) = 0$. Consequently, $u_S'(r) = 0$ and $u_S''(r) = 0$. This is consistent with the given condition that $S(r) = 0$ for $r \\ge r_c$.\nFor the intermediate region $r_s < r < r_c$, the switched potential is $u_S(r) = S(r)u(r)$. We must determine the form of $S(r)$ to ensure $C^2$ continuity at the boundaries $r_s$ and $r_c$.\n\nTo enforce continuity, we evaluate $u_S(r)$ and its derivatives on both sides of the boundaries.\nThe derivatives of $u_S(r) = S(r)u(r)$ are found using the product rule:\n$u_S'(r) = S'(r)u(r) + S(r)u'(r)$\n$u_S''(r) = S''(r)u(r) + 2S'(r)u'(r) + S(r)u''(r)$\n\nFirst, we establish the conditions on $S(r)$ at $r = r_s$. The behavior for $r > r_s$ must match the behavior for $r < r_s$.\n1.  Continuity of value: $\\lim_{r \\to r_s^+} u_S(r) = u_S(r_s^-) \\implies S(r_s)u(r_s) = u(r_s)$. Assuming $u(r_s) \\neq 0$, this implies $S(r_s) = 1$.\n2.  Continuity of first derivative: $\\lim_{r \\to r_s^+} u_S'(r) = u_S'(r_s^-) \\implies S'(r_s)u(r_s) + S(r_s)u'(r_s) = u'(r_s)$. Substituting $S(r_s) = 1$, we get $S'(r_s)u(r_s) + u'(r_s) = u'(r_s)$, which simplifies to $S'(r_s)u(r_s) = 0$. This implies $S'(r_s) = 0$.\n3.  Continuity of second derivative: $\\lim_{r \\to r_s^+} u_S''(r) = u_S''(r_s^-) \\implies S''(r_s)u(r_s) + 2S'(r_s)u'(r_s) + S(r_s)u''(r_s) = u''(r_s)$. Substituting $S(r_s) = 1$ and $S'(r_s) = 0$, we get $S''(r_s)u(r_s) + u''(r_s) = u''(r_s)$, which simplifies to $S''(r_s)u(r_s) = 0$. This implies $S''(r_s) = 0$.\n\nNext, we establish the conditions on $S(r)$ at $r = r_c$. The behavior for $r < r_c$ must match the behavior for $r > r_c$.\n1.  Continuity of value: $\\lim_{r \\to r_c^-} u_S(r) = u_S(r_c^+) \\implies S(r_c)u(r_c) = 0$. Assuming $u(r_c) \\neq 0$, this implies $S(r_c) = 0$.\n2.  Continuity of first derivative: $\\lim_{r \\to r_c^-} u_S'(r) = u_S'(r_c^+) \\implies S'(r_c)u(r_c) + S(r_c)u'(r_c) = 0$. Substituting $S(r_c) = 0$, we get $S'(r_c)u(r_c) = 0$, which implies $S'(r_c) = 0$.\n3.  Continuity of second derivative: $\\lim_{r \\to r_c^-} u_S''(r) = u_S''(r_c^+) \\implies S''(r_c)u(r_c) + 2S'(r_c)u'(r_c) + S(r_c)u''(r_c) = 0$. Substituting $S(r_c) = 0$ and $S'(r_c) = 0$, we get $S''(r_c)u(r_c) = 0$, which implies $S''(r_c) = 0$.\n\nIn summary, we have six conditions that the switching function $S(r)$ must satisfy in the interval $(r_s, r_c)$:\nAt $r = r_s$: $S(r_s) = 1$, $S'(r_s) = 0$, $S''(r_s) = 0$.\nAt $r = r_c$: $S(r_c) = 0$, $S'(r_c) = 0$, $S''(r_c) = 0$.\n\nTo simplify the problem, we introduce a rescaled coordinate $t$ that maps the interval $[r_s, r_c]$ to $[0, 1]$:\n$t(r) = \\frac{r - r_s}{r_c - r_s}$.\nLet $S(r) = P(t(r))$. We transform the derivative conditions from $r$ to $t$. Using the chain rule, $\\frac{d}{dr} = \\frac{dt}{dr}\\frac{d}{dt} = \\frac{1}{r_c - r_s}\\frac{d}{dt}$.\nThe conditions on the polynomial $P(t)$ are:\nAt $t = 0$ (corresponding to $r=r_s$): $P(0) = 1$, $P'(0) = 0$, $P''(0) = 0$.\nAt $t = 1$ (corresponding to $r=r_c$): $P(1) = 0$, $P'(1) = 0$, $P''(1) = 0$.\n\nA polynomial with $6$ coefficients (degree $5$) is the minimal-degree polynomial that can satisfy these $6$ conditions. Let the quintic polynomial be $P(t) = a_5 t^5 + a_4 t^4 + a_3 t^3 + a_2 t^2 + a_1 t + a_0$.\nIts derivatives are:\n$P'(t) = 5a_5 t^4 + 4a_4 t^3 + 3a_3 t^2 + 2a_2 t + a_1$\n$P''(t) = 20a_5 t^3 + 12a_4 t^2 + 6a_3 t + 2a_2$\n\nApplying the conditions at $t=0$:\n$P(0) = a_0 = 1$\n$P'(0) = a_1 = 0$\n$P''(0) = 2a_2 = 0 \\implies a_2 = 0$\n\nSo the polynomial simplifies to $P(t) = a_5 t^5 + a_4 t^4 + a_3 t^3 + 1$.\nNow we apply the conditions at $t=1$:\n1. $P(1) = a_5 + a_4 + a_3 + 1 = 0 \\implies a_5 + a_4 + a_3 = -1$\n2. $P'(1) = 5a_5 + 4a_4 + 3a_3 = 0$\n3. $P''(1) = 20a_5 + 12a_4 + 6a_3 = 0 \\implies 10a_5 + 6a_4 + 3a_3 = 0$\n\nWe solve this system of three linear equations.\nSubtracting (2) from (3): $(10-5)a_5 + (6-4)a_4 + (3-3)a_3 = 0 \\implies 5a_5 + 2a_4 = 0 \\implies a_4 = -\\frac{5}{2}a_5$.\nMultiplying (2) by $1$ and (1) by $-3$: $(5-3)a_5 + (4-3)a_4 = 3 \\implies 2a_5 + a_4 = 3$.\nSubstitute $a_4 = -\\frac{5}{2}a_5$ into this new equation:\n$2a_5 + \\left(-\\frac{5}{2}a_5\\right) = 3 \\implies -\\frac{1}{2}a_5 = 3 \\implies a_5 = -6$.\nNow we find the other coefficients:\n$a_4 = -\\frac{5}{2}(-6) = 15$.\nFrom $a_5 + a_4 + a_3 = -1$: $-6 + 15 + a_3 = -1 \\implies 9 + a_3 = -1 \\implies a_3 = -10$.\n\nThe coefficients are $a_5 = -6$, $a_4 = 15$, $a_3 = -10$, $a_2 = 0$, $a_1 = 0$, $a_0 = 1$.\nThe polynomial for the switching function in terms of $t$ is:\n$P(t) = -6t^5 + 15t^4 - 10t^3 + 1$.\n\nThe final expression for the piecewise-defined switched potential $u_S(r)$ is:\n- For $r \\leq r_s$: $u_S(r) = u(r) = 4 \\epsilon \\left[ \\left( \\frac{\\sigma}{r} \\right)^{12} - \\left( \\frac{\\sigma}{r} \\right)^{6} \\right]$.\n- For $r_s < r < r_c$: $u_S(r) = S(r)u(r) = \\left(-6t(r)^5 + 15t(r)^4 - 10t(r)^3 + 1\\right) u(r)$, where $t(r) = \\frac{r - r_s}{r_c - r_s}$.\n- For $r \\geq r_c$: $u_S(r) = 0$.\nThis constitutes the complete analytical solution to the problem.", "answer": "$$\n\\boxed{\nu_S(r) = \n\\begin{cases} \n4 \\epsilon \\left[ \\left( \\frac{\\sigma}{r} \\right)^{12} - \\left( \\frac{\\sigma}{r} \\right)^{6} \\right] & r \\le r_s \\\\\n\\left( -6 t(r)^5 + 15 t(r)^4 - 10 t(r)^3 + 1 \\right) \\left( 4 \\epsilon \\left[ \\left( \\frac{\\sigma}{r} \\right)^{12} - \\left( \\frac{\\sigma}{r} \\right)^{6} \\right] \\right) & r_s < r < r_c \\\\\n0 & r \\ge r_c \n\\end{cases}\n,\\quad \\text{where } t(r) = \\frac{r - r_s}{r_c - r_s}\n}\n$$", "id": "3472801"}, {"introduction": "While truncating a potential is a computational necessity, it introduces systematic errors by neglecting the long-range tail of the interaction, which can significantly affect bulk thermodynamic properties. This hands-on problem bridges theory and practice by having you first derive the analytical \"tail corrections\" for energy and pressure that account for these missing interactions under a mean-field approximation. You will then implement these corrections in a program to see firsthand how they are essential for reconciling simulation results with macroscopic properties and for accurately describing phenomena like liquid-vapor phase coexistence. [@problem_id:3472773]", "problem": "A single-component fluid is modeled using the Lennard-Jones pair potential, defined for two particles separated by distance $r$ as $u(r) = 4 \\varepsilon \\left[\\left(\\dfrac{\\sigma}{r}\\right)^{12} - \\left(\\dfrac{\\sigma}{r}\\right)^{6}\\right]$, where $\\varepsilon$ is the depth of the potential well and $\\sigma$ is the characteristic length scale. In computational practice, one often employs the truncated-shifted Lennard-Jones potential, which sets $u_{\\mathrm{TS}}(r) = u(r) - u(r_c)$ for $r < r_c$ and $u_{\\mathrm{TS}}(r) = 0$ for $r \\ge r_c$, where $r_c$ is the cutoff radius. Consider a homogeneous fluid of number density $\\rho$ in the thermodynamic limit, and assume the standard mean-field approximation $g(r) = 1$ for $r > r_c$, where $g(r)$ is the radial distribution function.\n\nStarting only from the following foundational relations:\n- The configurational contribution to the internal energy per particle for a pair potential in a uniform fluid is given by $u_{\\text{conf}}/N = 2 \\pi \\rho \\int_{0}^{\\infty} r^2 u(r) g(r) \\, dr$.\n- The mechanical (virial) equation of state for a pair potential in a uniform fluid is $p = \\rho k_{\\mathrm{B}} T - \\dfrac{2 \\pi \\rho^2}{3} \\int_{0}^{\\infty} r^3 \\dfrac{du(r)}{dr} g(r) \\, dr$, where $p$ is the pressure, $k_{\\mathrm{B}}$ is the Boltzmann constant, and $T$ is the absolute temperature.\n- The Helmholtz free energy density $a$ satisfies $\\mu = \\dfrac{\\partial a}{\\partial \\rho}\\big|_{T}$ for the chemical potential $\\mu$.\n\nDerive closed-form analytical expressions for:\n1. The tail correction to the configurational internal energy per particle, $\\Delta u_{\\text{tail}}/N$, that accounts for the missing interactions beyond $r_c$ when using the truncated-shifted Lennard-Jones potential.\n2. The tail correction to the virial pressure, $\\Delta p_{\\text{tail}}$, that accounts for the missing virial contribution beyond $r_c$.\n3. The corresponding mean-field tail correction to the chemical potential, $\\Delta \\mu_{\\text{tail}}$, derived from the tail contribution to the Helmholtz free energy density.\n\nYou must perform the derivation explicitly from the provided foundational relations and the definition of the Lennard-Jones potential. Assume $g(r) = 1$ for $r > r_c$ and neglect contributions from $r < r_c$ for the tail corrections. Use the truncated-shifted scheme only to motivate the need for these corrections; the shift inside $r < r_c$ does not affect the missing long-range tail.\n\nAfter deriving the formulas, implement them in a program that computes, for each test case, the following six quantities in reduced Lennard-Jones units (i.e., set $\\varepsilon = 1$, $\\sigma = 1$, and express energies in units of $\\varepsilon$, pressures in units of $\\varepsilon/\\sigma^3$, and chemical potentials in units of $\\varepsilon$):\n- $\\Delta u_{\\text{tail}}^{\\ell}/N$ for the liquid density $\\rho_{\\ell}$,\n- $\\Delta u_{\\text{tail}}^{v}/N$ for the vapor density $\\rho_{v}$,\n- $\\Delta p_{\\text{tail}}^{\\ell}$ for $\\rho_{\\ell}$,\n- $\\Delta p_{\\text{tail}}^{v}$ for $\\rho_{v}$,\n- $\\Delta p_{\\text{mismatch}} = \\Delta p_{\\text{tail}}^{\\ell} - \\Delta p_{\\text{tail}}^{v}$ as the pressure mismatch introduced when mapping truncated-shifted coexistence to full Lennard-Jones via tail corrections,\n- $\\Delta \\mu_{\\text{mismatch}} = \\Delta \\mu_{\\text{tail}}^{\\ell} - \\Delta \\mu_{\\text{tail}}^{v}$ as the chemical potential mismatch.\n\nInterpret $\\Delta p_{\\text{mismatch}}$ and $\\Delta \\mu_{\\text{mismatch}}$ as indicators of how the liquid-vapor coexistence line would shift when including long-range attractions via tail corrections.\n\nUse the cutoff $r_c = k \\sigma$ for a given dimensionless $k$ in each test. All inputs and outputs are in reduced Lennard-Jones units as specified. Angles do not appear in this problem, so no angle unit is required.\n\nTest Suite:\n- Case $1$: $T^\\ast = 0.85$, $k = 2.5$, $\\rho_{\\ell} = 0.65$, $\\rho_{v} = 0.032$.\n- Case $2$: $T^\\ast = 0.90$, $k = 3.0$, $\\rho_{\\ell} = 0.60$, $\\rho_{v} = 0.050$.\n- Case $3$: $T^\\ast = 0.70$, $k = 2.0$, $\\rho_{\\ell} = 0.73$, $\\rho_{v} = 0.005$.\n- Case $4$: $T^\\ast = 0.95$, $k = 6.0$, $\\rho_{\\ell} = 0.55$, $\\rho_{v} = 0.070$.\n\nFor each case, your program should produce a single line of output containing a list of lists. Each inner list must be ordered as $[\\Delta u_{\\text{tail}}^{\\ell}/N,\\Delta u_{\\text{tail}}^{v}/N,\\Delta p_{\\text{tail}}^{\\ell},\\Delta p_{\\text{tail}}^{v},\\Delta p_{\\text{mismatch}},\\Delta \\mu_{\\text{mismatch}}]$ for that case. The final output format must be exactly a single line with the nested lists enclosed in square brackets, for example $[[x_1,x_2,x_3,x_4,x_5,x_6],[\\ldots],\\ldots]$, where all entries are floating-point numbers in the specified reduced units.", "solution": "The task is to derive analytical expressions for the tail corrections to the configurational internal energy, pressure, and chemical potential for a Lennard-Jones fluid, and then to compute these quantities for a given set of test cases. The derivations will be performed in general units and then specialized to reduced Lennard-Jones units for the computation.\n\nThe Lennard-Jones (LJ) pair potential $u(r)$ is given by:\n$$\nu(r) = 4 \\varepsilon \\left[ \\left(\\frac{\\sigma}{r}\\right)^{12} - \\left(\\frac{\\sigma}{r}\\right)^{6} \\right]\n$$\nwhere $\\varepsilon$ is the potential well depth and $\\sigma$ is the finite distance at which the potential is zero. The tail corrections account for the contributions to thermodynamic properties from particle pairs separated by distances $r$ greater than a specified cutoff radius, $r_c$. The standard mean-field approximation assumes the radial distribution function $g(r) = 1$ for all $r \\ge r_c$.\n\n**1. Derivation of the Tail Correction to the Configurational Internal Energy ($\\Delta u_{\\text{tail}}/N$)**\n\nThe configurational internal energy per particle, $u_{\\text{conf}}/N$, is given by the foundational relation:\n$$\n\\frac{u_{\\text{conf}}}{N} = 2 \\pi \\rho \\int_{0}^{\\infty} r^2 u(r) g(r) \\, dr\n$$\nThe tail correction, $\\Delta u_{\\text{tail}}/N$, is the contribution from the integral over the domain $[r_c, \\infty)$. Applying the mean-field approximation $g(r)=1$ for $r \\ge r_c$:\n$$\n\\frac{\\Delta u_{\\text{tail}}}{N} = 2 \\pi \\rho \\int_{r_c}^{\\infty} r^2 u(r) \\cdot (1) \\, dr\n$$\nSubstituting the LJ potential into this expression:\n$$\n\\frac{\\Delta u_{\\text{tail}}}{N} = 2 \\pi \\rho \\int_{r_c}^{\\infty} r^2 \\left( 4 \\varepsilon \\left[ \\left(\\frac{\\sigma}{r}\\right)^{12} - \\left(\\frac{\\sigma}{r}\\right)^{6} \\right] \\right) \\, dr = 8 \\pi \\rho \\varepsilon \\int_{r_c}^{\\infty} \\left( \\sigma^{12} r^{-10} - \\sigma^6 r^{-4} \\right) \\, dr\n$$\nWe now evaluate the integral:\n$$\n\\int_{r_c}^{\\infty} \\left( \\sigma^{12} r^{-10} - \\sigma^6 r^{-4} \\right) \\, dr = \\left[ \\sigma^{12} \\frac{r^{-9}}{-9} - \\sigma^6 \\frac{r^{-3}}{-3} \\right]_{r_c}^{\\infty} = \\left[ -\\frac{\\sigma^{12}}{9r^9} + \\frac{\\sigma^6}{3r^3} \\right]_{r_c}^{\\infty}\n$$\nEvaluating the limits gives:\n$$\n= \\left( \\lim_{r \\to \\infty} \\left( -\\frac{\\sigma^{12}}{9r^9} + \\frac{\\sigma^6}{3r^3} \\right) \\right) - \\left( -\\frac{\\sigma^{12}}{9r_c^9} + \\frac{\\sigma^6}{3r_c^3} \\right) = (0 - 0) - \\left( -\\frac{\\sigma^{12}}{9r_c^9} + \\frac{\\sigma^6}{3r_c^3} \\right) = \\frac{\\sigma^{12}}{9r_c^9} - \\frac{\\sigma^6}{3r_c^3}\n$$\nSubstituting this result back, we obtain the closed-form expression for the energy tail correction per particle:\n$$\n\\frac{\\Delta u_{\\text{tail}}}{N} = 8 \\pi \\rho \\varepsilon \\left( \\frac{\\sigma^{12}}{9r_c^9} - \\frac{\\sigma^6}{3r_c^3} \\right)\n$$\n\n**2. Derivation of the Tail Correction to the Virial Pressure ($\\Delta p_{\\text{tail}}$)**\n\nThe virial equation of state is:\n$$\np = \\rho k_{\\mathrm{B}} T - \\frac{2 \\pi \\rho^2}{3} \\int_{0}^{\\infty} r^3 \\frac{du(r)}{dr} g(r) \\, dr\n$$\nThe tail correction to the pressure, $\\Delta p_{\\text{tail}}$, arises from the integral part for $r \\ge r_c$:\n$$\n\\Delta p_{\\text{tail}} = - \\frac{2 \\pi \\rho^2}{3} \\int_{r_c}^{\\infty} r^3 \\frac{du(r)}{dr} g(r) \\, dr \\approx - \\frac{2 \\pi \\rho^2}{3} \\int_{r_c}^{\\infty} r^3 \\frac{du(r)}{dr} \\, dr\n$$\nFirst, we find the derivative of the LJ potential:\n$$\n\\frac{du(r)}{dr} = \\frac{d}{dr} \\left[ 4 \\varepsilon \\left( \\sigma^{12}r^{-12} - \\sigma^6r^{-6} \\right) \\right] = 4 \\varepsilon \\left( -12\\sigma^{12}r^{-13} + 6\\sigma^6r^{-7} \\right) = 24 \\varepsilon \\left( -\\frac{2\\sigma^{12}}{r^{13}} + \\frac{\\sigma^6}{r^7} \\right)\n$$\nSubstituting the derivative into the integral for $\\Delta p_{\\text{tail}}$:\n$$\n\\Delta p_{\\text{tail}} = - \\frac{2 \\pi \\rho^2}{3} \\int_{r_c}^{\\infty} r^3 \\cdot 24 \\varepsilon \\left( -\\frac{2\\sigma^{12}}{r^{13}} + \\frac{\\sigma^6}{r^7} \\right) \\, dr = -16 \\pi \\rho^2 \\varepsilon \\int_{r_c}^{\\infty} \\left( -2\\sigma^{12}r^{-10} + \\sigma^6r^{-4} \\right) \\, dr\n$$\nEvaluating the integral:\n$$\n\\int_{r_c}^{\\infty} \\left( -2\\sigma^{12}r^{-10} + \\sigma^6r^{-4} \\right) \\, dr = \\left[ -2\\sigma^{12}\\frac{r^{-9}}{-9} + \\sigma^6\\frac{r^{-3}}{-3} \\right]_{r_c}^{\\infty} = \\left[ \\frac{2\\sigma^{12}}{9r^9} - \\frac{\\sigma^6}{3r^3} \\right]_{r_c}^{\\infty}\n$$\n$$\n= (0 - 0) - \\left( \\frac{2\\sigma^{12}}{9r_c^9} - \\frac{\\sigma^6}{3r_c^3} \\right) = -\\frac{2\\sigma^{12}}{9r_c^9} + \\frac{\\sigma^6}{3r_c^3}\n$$\nSubstituting this result back yields the pressure tail correction:\n$$\n\\Delta p_{\\text{tail}} = -16 \\pi \\rho^2 \\varepsilon \\left( -\\frac{2\\sigma^{12}}{9r_c^9} + \\frac{\\sigma^6}{3r_c^3} \\right) = \\frac{32 \\pi \\rho^2 \\varepsilon}{9} \\frac{\\sigma^{12}}{r_c^9} - \\frac{16 \\pi \\rho^2 \\varepsilon}{3} \\frac{\\sigma^6}{r_c^3}\n$$\n\n**3. Derivation of the Tail Correction to the Chemical Potential ($\\Delta \\mu_{\\text{tail}}$)**\n\nThe chemical potential $\\mu$ is related to the Helmholtz free energy density $a = A/V$ via $\\mu = \\left(\\frac{\\partial a}{\\partial \\rho}\\right)_T$. The tail correction to the free energy, $A_{\\text{tail}}$, is approximated by the tail correction to the internal energy, $U_{\\text{tail}}$, in the mean-field limit ($A_{\\text{tail}} \\approx U_{\\text{tail}}$).\nThe total internal energy correction is $U_{\\text{tail}} = N (\\Delta u_{\\text{tail}}/N)$. Using our previous result:\n$$\nU_{\\text{tail}} = N \\left[ 8 \\pi \\rho \\varepsilon \\left( \\frac{\\sigma^{12}}{9r_c^9} - \\frac{\\sigma^6}{3r_c^3} \\right) \\right]\n$$\nSubstituting $N = \\rho V$:\n$$\nU_{\\text{tail}} = (\\rho V) \\left[ 8 \\pi \\rho \\varepsilon \\left( \\frac{\\sigma^{12}}{9r_c^9} - \\frac{\\sigma^6}{3r_c^3} \\right) \\right] = 8 \\pi V \\rho^2 \\varepsilon \\left( \\frac{\\sigma^{12}}{9r_c^9} - \\frac{\\sigma^6}{3r_c^3} \\right)\n$$\nThe corresponding free energy density correction is $a_{\\text{tail}} = U_{\\text{tail}} / V$:\n$$\na_{\\text{tail}} = 8 \\pi \\rho^2 \\varepsilon \\left( \\frac{\\sigma^{12}}{9r_c^9} - \\frac{\\sigma^6}{3r_c^3} \\right)\n$$\nDifferentiating with respect to $\\rho$ gives the chemical potential tail correction:\n$$\n\\Delta \\mu_{\\text{tail}} = \\frac{\\partial a_{\\text{tail}}}{\\partial \\rho} = \\frac{\\partial}{\\partial \\rho} \\left[ 8 \\pi \\rho^2 \\varepsilon \\left( \\frac{\\sigma^{12}}{9r_c^9} - \\frac{\\sigma^6}{3r_c^3} \\right) \\right] = 16 \\pi \\rho \\varepsilon \\left( \\frac{\\sigma^{12}}{9r_c^9} - \\frac{\\sigma^6}{3r_c^3} \\right)\n$$\nThis shows that $\\Delta \\mu_{\\text{tail}} = 2 (\\Delta u_{\\text{tail}}/N)$, a common result in mean-field theories.\n\n**Summary of Formulas in Reduced Units**\nFor the computation, we use reduced Lennard-Jones units, where $\\varepsilon = 1$, $\\sigma = 1$, energies are in units of $\\varepsilon$, pressures in units of $\\varepsilon/\\sigma^3$, density in units of $\\sigma^{-3}$, and temperature in units of $\\varepsilon/k_B$. The cutoff radius is $r_c = k\\sigma = k$. The formulas become:\n1.  Energy correction per particle: $\\frac{\\Delta u^*_{\\text{tail}}}{N} = 8 \\pi \\rho^* \\left( \\frac{1}{9k^9} - \\frac{1}{3k^3} \\right)$\n2.  Pressure correction: $\\Delta p^*_{\\text{tail}} = \\frac{32 \\pi (\\rho^*)^2}{9} \\frac{1}{k^9} - \\frac{16 \\pi (\\rho^*)^2}{3} \\frac{1}{k^3}$\n3.  Chemical potential correction: $\\Delta \\mu^*_{\\text{tail}} = 16 \\pi \\rho^* \\left( \\frac{1}{9k^9} - \\frac{1}{3k^3} \\right)$\nThese are the equations implemented in the following program.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem of calculating Lennard-Jones tail corrections.\n    \"\"\"\n    \n    # Test cases from the problem statement.\n    # Each case is a tuple: (T_star, k, rho_l, rho_v)\n    # T_star is provided for context but not used in the mean-field tail correction formulas.\n    test_cases = [\n        # (T*, k, rho_liquid, rho_vapor)\n        (0.85, 2.5, 0.65, 0.032),\n        (0.90, 3.0, 0.60, 0.050),\n        (0.70, 2.0, 0.73, 0.005),\n        (0.95, 6.0, 0.55, 0.070),\n    ]\n\n    def calculate_corrections(rho, k):\n        \"\"\"\n        Calculates tail corrections for energy, pressure, and chemical potential.\n        \n        Args:\n            rho (float): Reduced density (rho*).\n            k (float): Dimensionless cutoff radius (rc/sigma).\n            \n        Returns:\n            tuple: (delta_u_per_N, delta_p, delta_mu) in reduced units.\n        \"\"\"\n        # Pre-compute powers of k for efficiency\n        k3 = k**3\n        k9 = k**9\n        \n        # Term common to energy and chemical potential corrections\n        term_u_mu = (1.0 / (9.0 * k9)) - (1.0 / (3.0 * k3))\n        \n        # 1. Energy correction per particle\n        # delta_u*/N = 8 * pi * rho* * (1/(9*k^9) - 1/(3*k^3))\n        delta_u_per_N = 8.0 * np.pi * rho * term_u_mu\n        \n        # 2. Pressure correction\n        # delta_p* = (32*pi*(rho*)^2)/(9*k^9) - (16*pi*(rho*)^2)/(3*k^3)\n        delta_p = (32.0 * np.pi * rho**2 / (9.0 * k9)) - (16.0 * np.pi * rho**2 / (3.0 * k3))\n        \n        # 3. Chemical potential correction\n        # delta_mu* = 16 * pi * rho* * (1/(9*k^9) - 1/(3*k^3))\n        # This is exactly 2 * delta_u_per_N\n        delta_mu = 2.0 * delta_u_per_N\n        \n        return delta_u_per_N, delta_p, delta_mu\n\n    results_per_case = []\n    for case in test_cases:\n        _, k, rho_l, rho_v = case\n        \n        # Calculate corrections for the liquid phase\n        u_tail_l, p_tail_l, mu_tail_l = calculate_corrections(rho_l, k)\n        \n        # Calculate corrections for the vapor phase\n        u_tail_v, p_tail_v, mu_tail_v = calculate_corrections(rho_v, k)\n        \n        # Calculate the pressure and chemical potential mismatches\n        p_mismatch = p_tail_l - p_tail_v\n        mu_mismatch = mu_tail_l - mu_tail_v\n        \n        # Assemble the list of results for this case in the specified order\n        case_results = [\n            u_tail_l,\n            u_tail_v,\n            p_tail_l,\n            p_tail_v,\n            p_mismatch,\n            mu_mismatch\n        ]\n        results_per_case.append(case_results)\n\n    # Final print statement in the exact required format.\n    # The default string representation of a list of lists matches the required format.\n    print(results_per_case)\n\nsolve()\n```", "id": "3472773"}]}