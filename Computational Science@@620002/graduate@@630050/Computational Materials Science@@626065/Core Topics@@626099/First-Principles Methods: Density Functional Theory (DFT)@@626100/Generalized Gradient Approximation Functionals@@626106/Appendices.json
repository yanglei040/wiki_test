{"hands_on_practices": [{"introduction": "The reduced density gradient, $s(\\mathbf{r})$, is the central variable in any Generalized Gradient Approximation, quantifying the local inhomogeneity of the electron density relative to the local density itself. This exercise provides foundational practice in calculating $s(\\mathbf{r})$ for a simple, analytically tractable system—a uniform electron gas with a weak sinusoidal perturbation. By working through this derivation, you will develop a concrete intuition for where the reduced gradient is large (regions of rapid density change) versus where it is small (at density maxima and minima), a key skill for interpreting GGA calculations [@problem_id:3454011].", "problem": "In Kohn–Sham density functional theory, generalized gradient approximation (GGA) functionals for a spin-unpolarized system use the exchange reduced gradient defined by $s(\\mathbf{r}) \\equiv \\dfrac{|\\nabla n(\\mathbf{r})|}{2\\,k_{F}(n(\\mathbf{r}))\\,n(\\mathbf{r})}$, where $k_{F}(n) \\equiv \\left(3\\pi^{2} n\\right)^{1/3}$ is the local Fermi wavevector. Consider a one-dimensional modulation of a uniform electron density given by $n(x) = n_{0}\\left(1+\\delta \\cos(k x)\\right)$ with $\\delta \\ll 1$. Starting from the stated definitions and retaining terms consistently to first order in $\\delta$, derive an explicit expression for $s(x)$ in terms of $n_{0}$, $\\delta$, and $k$. Based on the resulting expression, identify within one spatial period where $s(x)$ is smallest and where it is largest. Express your final answer as a single closed-form analytic expression for $s(x)$; no numerical evaluation is required and no units should be included. The qualitative identification of regions should appear in your derivation, not in the final boxed answer.", "solution": "The problem has been validated and is determined to be a well-posed, scientifically grounded problem within the domain of computational materials science. The derivation proceeds as follows.\n\nThe problem asks for an expression for the exchange reduced gradient, $s(\\mathbf{r})$, for a specific one-dimensional electron density modulation. The given definitions are:\n$1$. The reduced gradient for a spin-unpolarized system:\n$$s(\\mathbf{r}) \\equiv \\dfrac{|\\nabla n(\\mathbf{r})|}{2\\,k_{F}(n(\\mathbf{r}))\\,n(\\mathbf{r})}$$\n$2$. The local Fermi wavevector:\n$$k_{F}(n) \\equiv \\left(3\\pi^{2} n\\right)^{1/3}$$\n$3$. The one-dimensional electron density modulation:\n$$n(x) = n_{0}\\left(1+\\delta \\cos(k x)\\right)$$\nThe condition $\\delta \\ll 1$ implies that we can use linear approximations (Taylor series expansion to first order in $\\delta$).\n\nFirst, we adapt the general $3D$ definition of $s(\\mathbf{r})$ to the given $1D$ case. For a function $n(x)$ that only varies along the $x$-direction, the gradient $\\nabla n(x)$ simplifies to $\\frac{dn(x)}{dx}\\hat{\\mathbf{x}}$. The magnitude of the gradient is therefore $|\\nabla n(x)| = \\left|\\frac{dn(x)}{dx}\\right|$. The expression for $s(x)$ becomes:\n$$s(x) = \\dfrac{\\left|\\frac{dn(x)}{dx}\\right|}{2\\,k_{F}(n(x))\\,n(x)}$$\n\nNext, we calculate the numerator, which is the magnitude of the density gradient. We differentiate $n(x)$ with respect to $x$:\n$$\\frac{dn(x)}{dx} = \\frac{d}{dx} \\left[ n_{0}\\left(1+\\delta \\cos(k x)\\right) \\right] = n_{0} \\left( -\\delta k \\sin(k x) \\right) = -n_{0}\\delta k \\sin(k x)$$\nThe magnitude is:\n$$\\left|\\frac{dn(x)}{dx}\\right| = |-n_{0}\\delta k \\sin(k x)| = n_{0}\\delta k |\\sin(k x)|$$\nHere, we assume $n_{0} > 0$, $\\delta > 0$, and $k > 0$ as they represent a background density, a small positive amplitude, and a wavevector magnitude, respectively.\n\nNow, we analyze the denominator, $2\\,k_{F}(n(x))\\,n(x)$. Substituting the definition of $k_{F}(n)$ into this expression gives:\n$$2\\,k_{F}(n(x))\\,n(x) = 2 \\left(3\\pi^{2} n(x)\\right)^{1/3} n(x) = 2 \\left(3\\pi^{2}\\right)^{1/3} n(x)^{1/3} n(x) = 2 \\left(3\\pi^{2}\\right)^{1/3} n(x)^{4/3}$$\nNext, we substitute the expression for $n(x)$:\n$$n(x)^{4/3} = \\left[n_{0}\\left(1+\\delta \\cos(k x)\\right)\\right]^{4/3} = n_{0}^{4/3} \\left(1+\\delta \\cos(k x)\\right)^{4/3}$$\nSince $\\delta \\ll 1$, we can use the binomial approximation $(1+u)^{p} \\approx 1+pu$ for small $u$. Here, $u = \\delta \\cos(k x)$ and $p = 4/3$.\n$$\\left(1+\\delta \\cos(k x)\\right)^{4/3} \\approx 1 + \\frac{4}{3}\\delta \\cos(k x)$$\nThus, the denominator is approximated as:\n$$2\\,k_{F}(n(x))\\,n(x) \\approx 2 \\left(3\\pi^{2}\\right)^{1/3} n_{0}^{4/3} \\left(1 + \\frac{4}{3}\\delta \\cos(k x)\\right)$$\n\nNow we assemble the full expression for $s(x)$:\n$$s(x) \\approx \\dfrac{n_{0}\\delta k |\\sin(k x)|}{2 \\left(3\\pi^{2}\\right)^{1/3} n_{0}^{4/3} \\left(1 + \\frac{4}{3}\\delta \\cos(k x)\\right)}$$\nWe can simplify the terms involving $n_{0}$:\n$$s(x) \\approx \\dfrac{\\delta k |\\sin(k x)|}{2 \\left(3\\pi^{2}\\right)^{1/3} n_{0}^{1/3}} \\left(1 + \\frac{4}{3}\\delta \\cos(k x)\\right)^{-1}$$\nThe term in the denominator can be rewritten in terms of the Fermi wavevector of the uniform density, $k_{F}(n_{0}) = (3\\pi^2 n_{0})^{1/3}$:\n$$s(x) \\approx \\dfrac{\\delta k |\\sin(k x)|}{2 k_{F}(n_{0})} \\left(1 + \\frac{4}{3}\\delta \\cos(k x)\\right)^{-1}$$\nWe again use the binomial approximation, this time $(1+v)^{-1} \\approx 1-v$ for small $v$, where $v = \\frac{4}{3}\\delta \\cos(k x)$.\n$$s(x) \\approx \\dfrac{\\delta k |\\sin(k x)|}{2 k_{F}(n_{0})} \\left(1 - \\frac{4}{3}\\delta \\cos(k x)\\right)$$\nThe problem requires retaining terms consistently to first order in $\\delta$. We expand the expression:\n$$s(x) \\approx \\dfrac{\\delta k |\\sin(k x)|}{2 k_{F}(n_{0})} - \\dfrac{4}{3} \\dfrac{\\delta^2 k |\\sin(k x)|\\cos(k x)}{2 k_{F}(n_{0})}$$\nThe first term is of order $\\mathcal{O}(\\delta)$, while the second term is of order $\\mathcal{O}(\\delta^2)$. To be consistent to first order in $\\delta$, we must drop the second term. The final expression for $s(x)$ is therefore:\n$$s(x) \\approx \\dfrac{\\delta k |\\sin(k x)|}{2 k_{F}(n_{0})}$$\nSubstituting the explicit form of $k_{F}(n_{0})$ gives the expression in terms of the requested parameters $n_{0}$, $\\delta$, and $k$:\n$$s(x) = \\dfrac{\\delta k |\\sin(k x)|}{2 \\left(3\\pi^{2} n_{0}\\right)^{1/3}}$$\nNote that the approximation becomes an equality in the analytic expression for the first-order term.\n\nFinally, we identify where $s(x)$ is largest and smallest within one spatial period, for example $x \\in [0, 2\\pi/k]$. The value of $s(x)$ is directly proportional to $|\\sin(k x)|$.\n- $s(x)$ is smallest where $|\\sin(k x)|$ is minimal. The minimum value of $|\\sin(k x)|$ is $0$, which occurs when $k x = m\\pi$ for any integer $m$. For the interval $x \\in [0, 2\\pi/k]$, this corresponds to $x=0$, $x=\\pi/k$, and $x=2\\pi/k$. At these points, the density $n(x) = n_{0}(1 \\pm \\delta)$ is at its maximum or minimum value, and the density gradient $\\frac{dn}{dx}$ is zero.\n- $s(x)$ is largest where $|\\sin(k x)|$ is maximal. The maximum value of $|\\sin(k x)|$ is $1$, which occurs when $k x = \\frac{\\pi}{2} + m\\pi$ for any integer $m$. For the interval $x \\in [0, 2\\pi/k]$, this corresponds to $x=\\pi/(2k)$ and $x=3\\pi/(2k)$. At these points, $\\cos(kx)=0$, so the density $n(x)=n_{0}$ is equal to its average value. These are the locations of the steepest density gradient.", "answer": "$$\\boxed{\\frac{\\delta k |\\sin(kx)|}{2 \\left(3\\pi^{2} n_{0}\\right)^{1/3}}}$$", "id": "3454011"}, {"introduction": "While many distinct GGA functionals exist, their behavior in the limit of slowly varying densities is governed by the universal second-order gradient expansion (GE2). This practice demonstrates how to rigorously connect the specific parameters of a given model enhancement factor, $F_x(s)$, to the formal GE2 coefficient using a periodic density wave as a mathematical probe. Completing this analytical exercise reveals the theoretical underpinning of the parameters used in common GGA functionals, clarifying how they are designed to perform for systems with weak density variations [@problem_id:3453992].", "problem": "Consider a quasi-one-dimensional electron density variation in a three-dimensional system of cross-sectional area $A$ and length $L$ (periodic in $x$) given by\n$$\nn(x)=n_{0}\\left(1+\\eta\\cos(kx)\\right),\n$$\nwith $|\\eta|\\ll 1$. Work within Kohn–Sham density functional theory, using the Generalized Gradient Approximation (GGA) for exchange written in the standard “enhancement-factor” form\n$$\nE_{x}^{\\mathrm{GGA}}=\\int d^{3}r\\, e_{x}^{\\mathrm{LDA}}\\!\\left(n(\\mathbf{r})\\right)\\,F_{x}\\!\\left(s(\\mathbf{r})\\right),\n$$\nwhere the Local Density Approximation (LDA) exchange energy density per volume is\n$$\ne_{x}^{\\mathrm{LDA}}(n)=-C_{x}\\,n^{4/3},\\quad C_{x}=\\frac{3}{4}\\left(\\frac{3}{\\pi}\\right)^{1/3},\n$$\nand the reduced density gradient is\n$$\ns(\\mathbf{r})=\\frac{|\\nabla n(\\mathbf{r})|}{2\\,k_{F}(n)\\,n(\\mathbf{r})},\\quad k_{F}(n)=\\left(3\\pi^{2}n\\right)^{1/3}.\n$$\nAssume the following specific exchange enhancement factor:\n$$\nF_{x}(s)=1+\\kappa\\left[1-\\frac{1}{\\sqrt{1+\\frac{\\mu\\,s^{2}}{\\kappa}}}\\right],\n$$\nwith positive parameters $\\kappa$ and $\\mu$. \n\n(a) Compute $E_{x}^{\\mathrm{GGA}}$ up to and including terms of order $\\mathcal{O}(\\eta^{2})$ for the density $n(x)$ given above. Your derivation must explicitly show how the contributions from the LDA baseline and the gradient correction arise, and you must justify any series expansion you use.\n\n(b) Write the analytic second-order gradient expansion form as\n$$\nE_{x}\\approx \\int d^{3}r\\, e_{x}^{\\mathrm{LDA}}(n)\\left[1+\\mu_{\\mathrm{GE}}\\,s^{2}\\right],\n$$\nwith a constant second-order coefficient $\\mu_{\\mathrm{GE}}$. By comparing your result from part (a) to this analytic gradient expansion, extract the implied second-order gradient coefficient $\\mu_{\\mathrm{eff}}$ associated with the given $F_{x}(s)$. \n\nProvide your final answer for the implied coefficient $\\mu_{\\mathrm{eff}}$ as a closed-form analytic expression in terms of the parameter(s) appearing in $F_{x}(s)$. No numerical evaluation or rounding is required. State no units for the final answer.", "solution": "The problem is first validated to ensure it is scientifically grounded, well-posed, and objective.\n\n### Step 1: Extract Givens\n-   Electron density: $n(x)=n_{0}\\left(1+\\eta\\cos(kx)\\right)$\n-   System geometry: Cross-sectional area $A$, length $L$, periodic in $x$. Total volume $V=AL$.\n-   Condition: $|\\eta|\\ll 1$.\n-   GGA exchange energy functional: $E_{x}^{\\mathrm{GGA}}=\\int d^{3}r\\, e_{x}^{\\mathrm{LDA}}\\!\\left(n(\\mathbf{r})\\right)\\,F_{x}\\!\\left(s(\\mathbf{r})\\right)$.\n-   LDA exchange energy density: $e_{x}^{\\mathrm{LDA}}(n)=-C_{x}\\,n^{4/3}$, with $C_{x}=\\frac{3}{4}\\left(\\frac{3}{\\pi}\\right)^{1/3}$.\n-   Reduced density gradient: $s(\\mathbf{r})=\\frac{|\\nabla n(\\mathbf{r})|}{2\\,k_{F}(n)\\,n(\\mathbf{r})}$.\n-   Fermi wavevector: $k_{F}(n)=\\left(3\\pi^{2}n\\right)^{1/3}$.\n-   Exchange enhancement factor: $F_{x}(s)=1+\\kappa\\left[1-\\frac{1}{\\sqrt{1+\\frac{\\mu\\,s^{2}}{\\kappa}}}\\right]$, with $\\kappa > 0$ and $\\mu > 0$.\n-   Task (a): Compute $E_{x}^{\\mathrm{GGA}}$ up to order $\\mathcal{O}(\\eta^{2})$.\n-   Task (b): Compare the result from (a) with the analytic form $E_{x}\\approx \\int d^{3}r\\, e_{x}^{\\mathrm{LDA}}(n)\\left[1+\\mu_{\\mathrm{GE}}\\,s^{2}\\right]$ to find the implied coefficient $\\mu_{\\mathrm{eff}}$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is set within the standard framework of Kohn-Sham density functional theory, a cornerstone of modern computational physics and chemistry. The functional forms for the LDA energy density, the reduced gradient $s$, and the GGA enhancement factor are all standard or physically plausible models. The density variation is a simple sinusoidal wave, a common test case for analyzing the behavior of density functionals. The requirement to perform a Taylor expansion in the small parameter $\\eta$ is a standard and well-defined mathematical procedure. The problem is self-contained, with all necessary definitions provided. There are no scientific contradictions, ambiguities, or subjective elements.\n\n### Step 3: Verdict and Action\nThe problem is valid. A complete solution will be provided.\n\n***\n\n### Part (a): Computation of $E_{x}^{\\mathrm{GGA}}$ to $\\mathcal{O}(\\eta^2)$\n\nThe total GGA exchange energy is given by the integral over the system volume $V=AL$. Since the density $n(x)$ depends only on the $x$ coordinate, the integral over the cross-sectional area $A$ can be performed trivially.\n$$\nE_{x}^{\\mathrm{GGA}} = \\int d^3 r \\, e_{x}^{\\mathrm{LDA}}(n(x)) F_x(s(x)) = A \\int_{0}^{L} dx \\, e_{x}^{\\mathrm{LDA}}(n(x)) F_x(s(x))\n$$\nTo evaluate this integral up to order $\\mathcal{O}(\\eta^2)$, we must expand the terms in the integrand, $e_{x}^{\\mathrm{LDA}}(n(x))$ and $F_x(s(x))$, in powers of $\\eta$. The expansion is justified because the problem states $|\\eta| \\ll 1$.\n\nLet's denote $g(x) = \\eta \\cos(kx)$, so $n(x) = n_0(1+g(x))$.\n\nFirst, we expand the LDA energy density, $e_{x}^{\\mathrm{LDA}}(n) = -C_x n^{4/3}$:\n$$\ne_{x}^{\\mathrm{LDA}}(n(x)) = -C_x \\left[n_0(1+g(x))\\right]^{4/3} = -C_x n_0^{4/3} (1+g(x))^{4/3}\n$$\nUsing the binomial expansion $(1+u)^\\alpha \\approx 1 + \\alpha u + \\frac{\\alpha(\\alpha-1)}{2}u^2$ for small $u=g(x)$, with $\\alpha=4/3$:\n$$\ne_{x}^{\\mathrm{LDA}}(n(x)) \\approx e_{x}^{\\mathrm{LDA}}(n_0) \\left[1 + \\frac{4}{3}g(x) + \\frac{1}{2}\\frac{4}{3}\\left(\\frac{4}{3}-1\\right)g(x)^2\\right] = e_{x}^{\\mathrm{LDA}}(n_0) \\left[1 + \\frac{4}{3}\\eta\\cos(kx) + \\frac{2}{9}\\eta^2\\cos^2(kx)\\right]\n$$\nThis expansion is correct up to order $\\mathcal{O}(\\eta^2)$.\n\nNext, we compute the reduced gradient $s(x)$. The gradient of the density is:\n$$\n\\nabla n(x) = \\frac{dn}{dx}\\hat{x} = -n_0 \\eta k \\sin(kx) \\hat{x} \\implies |\\nabla n(x)| = n_0 |\\eta k \\sin(kx)|\n$$\nThe Fermi wavevector is $k_F(n(x)) = (3\\pi^2n(x))^{1/3} = (3\\pi^2n_0)^{1/3}(1+g(x))^{1/3} = k_F(n_0)(1+g(x))^{1/3}$.\nThe expression for $s(x)$ is:\n$$\ns(x) = \\frac{|\\nabla n(x)|}{2 k_F(n(x)) n(x)} = \\frac{n_0 |\\eta k \\sin(kx)|}{2 k_F(n_0)(1+g(x))^{1/3} n_0(1+g(x))} = \\frac{|\\eta k \\sin(kx)|}{2 k_F(n_0)} (1+g(x))^{-4/3}\n$$\nSince $s(x)$ is of order $\\mathcal{O}(\\eta)$, $s^2(x)$ is of order $\\mathcal{O}(\\eta^2)$. For the subsequent expansion of $F_x(s)$, we will need $s^2(x)$ to leading order in $\\eta$:\n$$\ns^2(x) = \\frac{\\eta^2 k^2 \\sin^2(kx)}{4 k_F(n_0)^2} (1+g(x))^{-8/3} \\approx \\frac{\\eta^2 k^2 \\sin^2(kx)}{4 k_F(n_0)^2} + \\mathcal{O}(\\eta^3)\n$$\nNow, we expand the enhancement factor $F_x(s)$. Since $s^2 = \\mathcal{O}(\\eta^2)$ is a small quantity, we can expand $F_x(s)$ for small $s^2$.\n$$\nF_x(s) = 1 + \\kappa \\left[1 - \\left(1 + \\frac{\\mu s^2}{\\kappa}\\right)^{-1/2}\\right]\n$$\nUsing $(1+u)^{-1/2} \\approx 1 - \\frac{1}{2}u$ for small $u = \\mu s^2/\\kappa$:\n$$\nF_x(s) \\approx 1 + \\kappa \\left[1 - \\left(1 - \\frac{1}{2}\\frac{\\mu s^2}{\\kappa}\\right)\\right] = 1 + \\kappa \\left(\\frac{\\mu s^2}{2\\kappa}\\right) = 1 + \\frac{\\mu}{2}s^2\n$$\nSubstituting the expression for $s^2(x)$ to order $\\mathcal{O}(\\eta^2)$:\n$$\nF_x(s(x)) \\approx 1 + \\frac{\\mu}{2} \\left[ \\frac{\\eta^2 k^2 \\sin^2(kx)}{4 k_F(n_0)^2} \\right] = 1 + \\frac{\\mu k^2}{8 k_F(n_0)^2} \\eta^2 \\sin^2(kx)\n$$\nThis is the expansion of $F_x(s)$ up to order $\\mathcal{O}(\\eta^2)$.\n\nNow we combine the expansions of $e_{x}^{\\mathrm{LDA}}(n)$ and $F_x(s)$ to form the integrand, keeping terms up to $\\mathcal{O}(\\eta^2)$:\n\\begin{align*}\n\\text{Integrand} &= e_{x}^{\\mathrm{LDA}}(n(x)) F_x(s(x)) \\\\\n&\\approx e_{x}^{\\mathrm{LDA}}(n_0) \\left[1 + \\frac{4}{3}\\eta\\cos(kx) + \\frac{2}{9}\\eta^2\\cos^2(kx)\\right] \\left[1 + \\frac{\\mu k^2}{8 k_F(n_0)^2} \\eta^2 \\sin^2(kx)\\right] \\\\\n&\\approx e_{x}^{\\mathrm{LDA}}(n_0) \\left[1 + \\frac{4}{3}\\eta\\cos(kx) + \\frac{2}{9}\\eta^2\\cos^2(kx) + \\frac{\\mu k^2}{8 k_F(n_0)^2} \\eta^2 \\sin^2(kx)\\right]\n\\end{align*}\nThe cross-term of order $\\mathcal{O}(\\eta) \\times \\mathcal{O}(\\eta^2)$ has been dropped as it is of order $\\mathcal{O}(\\eta^3)$.\n\nFinally, we integrate over $x$ from $0$ to $L$. The periodicity of $n(x)$ implies $k = 2\\pi m/L$ for some integer $m$. We use the following well-known integrals over one period $L$:\n$$\n\\int_0^L \\cos(kx) dx = 0, \\quad \\int_0^L \\cos^2(kx) dx = \\frac{L}{2}, \\quad \\int_0^L \\sin^2(kx) dx = \\frac{L}{2}\n$$\nIntegrating the expression for the integrand:\n$$\nE_{x}^{\\mathrm{GGA}} \\approx A \\int_0^L e_{x}^{\\mathrm{LDA}}(n_0) \\left[1 + \\frac{4}{3}\\eta\\cos(kx) + \\frac{2}{9}\\eta^2\\cos^2(kx) + \\frac{\\mu k^2}{8 k_F(n_0)^2} \\eta^2 \\sin^2(kx)\\right] dx\n$$\n$$\nE_{x}^{\\mathrm{GGA}} \\approx A e_{x}^{\\mathrm{LDA}}(n_0) \\left[L + 0 + \\frac{2}{9}\\eta^2\\frac{L}{2} + \\frac{\\mu k^2}{8 k_F(n_0)^2} \\eta^2\\frac{L}{2}\\right]\n$$\nUsing $V=AL$, we get the final expression for part (a):\n$$\nE_{x}^{\\mathrm{GGA}} \\approx V e_{x}^{\\mathrm{LDA}}(n_0) \\left[1 + \\frac{1}{9}\\eta^2 + \\frac{\\mu k^2}{16 k_F(n_0)^2}\\eta^2\\right] = V e_{x}^{\\mathrm{LDA}}(n_0) \\left[1 + \\left(\\frac{1}{9} + \\frac{\\mu k^2}{16 k_F(n_0)^2}\\right)\\eta^2\\right]\n$$\n\n### Part (b): Extraction of the Effective Gradient Coefficient $\\mu_{\\mathrm{eff}}$\n\nThe analytic second-order gradient expansion (GE2) is given by:\n$$\nE_x^{\\mathrm{GE2}} = \\int d^3 r \\, e_x^{\\mathrm{LDA}}(n) [1 + \\mu_{\\mathrm{eff}} s^2]\n$$\nwhere $\\mu_{\\mathrm{eff}}$ is the effective coefficient we need to determine. To compare with our result from part (a), we expand this expression to order $\\mathcal{O}(\\eta^2)$ for the given density wave.\n$$\nE_x^{\\mathrm{GE2}} = \\int d^3 r \\, e_x^{\\mathrm{LDA}}(n) + \\int d^3 r \\, \\mu_{\\mathrm{eff}} e_x^{\\mathrm{LDA}}(n) s^2\n$$\nThe first term is the LDA exchange energy, $E_x^{\\mathrm{LDA}}$. We have already expanded this to $\\mathcal{O}(\\eta^2)$ in part (a):\n$$\nE_x^{\\mathrm{LDA}} = \\int d^3 r \\, e_x^{\\mathrm{LDA}}(n(x)) = V e_{x}^{\\mathrm{LDA}}(n_0) \\left[1 + \\frac{1}{9}\\eta^2\\right]\n$$\nThe second term is the gradient correction. Since $s^2 = \\mathcal O(\\eta^2)$, to evaluate this term to $\\mathcal O(\\eta^2)$, we only need the leading order part of $e_x^{\\mathrm{LDA}}(n)$, which is $e_x^{\\mathrm{LDA}}(n_0)$:\n$$\n\\int d^3 r \\, \\mu_{\\mathrm{eff}} e_x^{\\mathrm{LDA}}(n) s^2 \\approx \\int d^3 r \\, \\mu_{\\mathrm{eff}} e_x^{\\mathrm{LDA}}(n_0) s^2(x)\n$$\nUsing $s^2(x) \\approx \\frac{\\eta^2 k^2 \\sin^2(kx)}{4 k_F(n_0)^2}$:\n$$\n\\int d^3 r \\, \\mu_{\\mathrm{eff}} e_x^{\\mathrm{LDA}}(n_0) \\frac{\\eta^2 k^2 \\sin^2(kx)}{4 k_F(n_0)^2} = \\mu_{\\mathrm{eff}} e_x^{\\mathrm{LDA}}(n_0) \\frac{\\eta^2 k^2}{4 k_F(n_0)^2} \\left( A \\int_0^L \\sin^2(kx) dx \\right)\n$$\n$$\n= \\mu_{\\mathrm{eff}} V e_x^{\\mathrm{LDA}}(n_0) \\frac{\\eta^2 k^2}{4 k_F(n_0)^2} \\frac{1}{2} = V e_x^{\\mathrm{LDA}}(n_0) \\frac{\\mu_{\\mathrm{eff}} k^2}{8 k_F(n_0)^2} \\eta^2\n$$\nCombining the two terms, the GE2 energy to order $\\mathcal{O}(\\eta^2)$ is:\n$$\nE_x^{\\mathrm{GE2}} \\approx V e_{x}^{\\mathrm{LDA}}(n_0) \\left[1 + \\frac{1}{9}\\eta^2\\right] + V e_x^{\\mathrm{LDA}}(n_0) \\frac{\\mu_{\\mathrm{eff}} k^2}{8 k_F(n_0)^2} \\eta^2 = V e_{x}^{\\mathrm{LDA}}(n_0) \\left[1 + \\left(\\frac{1}{9} + \\frac{\\mu_{\\mathrm{eff}} k^2}{8 k_F(n_0)^2}\\right)\\eta^2\\right]\n$$\nWe now equate this expression with the result for $E_x^{\\mathrm{GGA}}$ from part (a):\n$$\nV e_{x}^{\\mathrm{LDA}}(n_0) \\left[1 + \\left(\\frac{1}{9} + \\frac{\\mu k^2}{16 k_F(n_0)^2}\\right)\\eta^2\\right] = V e_{x}^{\\mathrm{LDA}}(n_0) \\left[1 + \\left(\\frac{1}{9} + \\frac{\\mu_{\\mathrm{eff}} k^2}{8 k_F(n_0)^2}\\right)\\eta^2\\right]\n$$\nBy comparing the coefficients of the $\\eta^2$ term, we can equate the gradient-dependent parts:\n$$\n\\frac{\\mu k^2}{16 k_F(n_0)^2} = \\frac{\\mu_{\\mathrm{eff}} k^2}{8 k_F(n_0)^2}\n$$\nThe factors of $k^2$ and $k_F(n_0)^2$ cancel, yielding:\n$$\n\\frac{\\mu}{16} = \\frac{\\mu_{\\mathrm{eff}}}{8}\n$$\nSolving for $\\mu_{\\mathrm{eff}}$ gives:\n$$\n\\mu_{\\mathrm{eff}} = \\frac{8\\mu}{16} = \\frac{\\mu}{2}\n$$\nThis result could also have been obtained directly by Taylor-expanding the enhancement factor $F_x(s)$ in powers of $s^2$, $F_x(s) \\approx 1 + \\mu_{\\mathrm{eff}} s^2 + \\mathcal{O}(s^4)$, and identifying the coefficient of $s^2$. The calculation performed using the density wave confirms this result through a concrete physical example. The coefficient $\\mu_{\\mathrm{eff}}$ does not depend on $\\kappa$, as $\\kappa$ appears in the expansion of $F_x(s)$ only at order $s^4$ and higher.\nThe implied second-order gradient coefficient is $\\mu/2$.", "answer": "$$\\boxed{\\frac{\\mu}{2}}$$", "id": "3453992"}, {"introduction": "A primary goal of computational materials science is to predict measurable quantities, and the work function is a fundamental surface property that is highly sensitive to the choice of exchange-correlation functional. This hands-on coding exercise guides you through the implementation of a simplified but physically insightful model of a metal surface to compute orientation-dependent work functions. By applying different GGA functionals, you will see how their distinct mathematical forms lead to different predictions, bridging abstract theory with the tangible, experimentally relevant properties of materials [@problem_id:3454004].", "problem": "You will implement a physically motivated, orientation-dependent, exchange-only Generalized Gradient Approximation (GGA) model to estimate the metallic work function for specific Miller-indexed surfaces of tungsten and aluminum. The task is to compute the predicted work functions $\\Phi_{hkl}$ in electronvolts for each test case, and to quantify how anisotropy arises from the surface-layer reduced gradient profile $s(z)$ and the decay of the exchange-correlation potential $v_{xc}(z)$ into the vacuum.\n\nStarting point and modeling assumptions:\n- Use Kohn–Sham Density Functional Theory (DFT) at the level of exchange-only Generalized Gradient Approximation (GGA). Neglect correlation for this exercise; this must be stated and kept consistent throughout.\n- Model the surface as a one-dimensional semi-infinite jellium, with a planar interface at $z = 0$:\n  - Bulk electron density $n_b$ for $z < 0$ (constant).\n  - Exponential tail for $z \\ge 0$ given by $n(z) = n_b e^{-\\kappa z}$ where $\\kappa$ is an orientation-dependent decay parameter.\n- Approximate the metallic work function by the exchange-only relation\n  $$ \\Phi_{hkl} \\approx \\varepsilon_F(n_b) + v_{x}^{\\mathrm{eff}}, $$\n  where $\\varepsilon_F(n_b)$ is the Fermi energy of the bulk jellium (in atomic units) and $v_x^{\\mathrm{eff}}$ is an effective exchange-only Kohn–Sham potential drop associated with the surface-layer density tail.\n- In atomic units (Hartree atomic units), the Fermi energy is\n  $$ \\varepsilon_F(n) = \\frac{1}{2} \\left(3 \\pi^2 n\\right)^{2/3}. $$\n- Use the Local Density Approximation (LDA) exchange potential,\n  $$ v_x^{\\mathrm{LDA}}(n) = - C_x n^{1/3}, \\quad C_x = \\left(\\frac{3}{\\pi}\\right)^{1/3}. $$\n- Use the reduced gradient\n  $$ s(z) = \\frac{|\\nabla n(z)|}{2 k_F(z) n(z)}, \\quad k_F(z) = \\left(3 \\pi^2 n(z)\\right)^{1/3}. $$\n- Approximate the GGA exchange-only potential as\n  $$ v_x^{\\mathrm{GGA}}(n, s) \\approx v_x^{\\mathrm{LDA}}(n) \\, F_x(s), $$\n  where $F_x(s)$ is the GGA exchange enhancement factor.\n- Define the effective exchange potential drop as a surface-layer weighted average,\n  $$ v_{x}^{\\mathrm{eff}} = \\frac{\\displaystyle \\int_0^{z_{\\max}} w(z) \\, v_x^{\\mathrm{GGA}}\\!\\left(n(z), s(z)\\right) \\, dz}{\\displaystyle \\int_0^{z_{\\max}} w(z) \\, dz}, \\quad w(z) = \\kappa e^{-\\kappa z}, $$\n  with $z_{\\max} = 12/\\kappa$ to ensure numerical convergence of the tail integrals.\n\nOrientation-dependent decay parameter:\n- For a cubic lattice with lattice constant $a$ (in Bohr radii), the interplanar spacing for Miller indices $(hkl)$ is\n  $$ d_{hkl} = \\frac{a}{\\sqrt{h^2 + k^2 + l^2}}. $$\n- Use a material-specific scale factor $\\alpha$ to set\n  $$ \\kappa_{hkl} = \\frac{\\alpha}{d_{hkl}}, $$\n  with $\\kappa$ in inverse Bohr radii.\n\nGGA exchange enhancement factors:\n- Implement the following enhancement factor family that satisfies the small-$s$ expansion $F_x(s) = 1 + \\mu s^2 + O(s^4)$ and saturates to $1 + \\kappa$ as $s \\to \\infty$:\n  $$ F_x(s) = 1 + \\kappa - \\frac{\\kappa}{1 + \\mu s^2 / \\kappa}. $$\n- Parameters for the chosen functionals:\n  - Perdew–Burke–Ernzerhof (PBE): use $\\mu = 0.21951$, $\\kappa = 0.804$.\n  - Perdew–Wang 1991 (PW91): use $\\mu = 0.19645$, $\\kappa = 0.804$.\n  - Revised Perdew–Burke–Ernzerhof for solids (PBEsol): use $\\mu = 10/81$, $\\kappa = 0.804$.\n\nMaterial parameters:\n- Lattice constants (in angstroms), to be converted to Bohr radii ($1 \\, \\mathrm{\\AA} = 1.889726125 \\, a_0$):\n  - Tungsten (W): $a_{\\mathrm{W}} = 3.165 \\, \\mathrm{\\AA}$.\n  - Aluminum (Al): $a_{\\mathrm{Al}} = 4.049 \\, \\mathrm{\\AA}$.\n- Jellium density parameters (Wigner–Seitz radius in Bohr radii) for the bulk electron density $n_b$:\n  $$ n_b = \\frac{3}{4 \\pi r_s^3}. $$\n  - Tungsten (W): $r_{s,\\mathrm{W}} = 2.30$.\n  - Aluminum (Al): $r_{s,\\mathrm{Al}} = 2.07$.\n- Surface decay scale factors (dimensionless) for the exponential tail:\n  - Tungsten (W): $\\alpha_{\\mathrm{W}} = 2.0$.\n  - Aluminum (Al): $\\alpha_{\\mathrm{Al}} = 1.2$.\n\nUnits and numerical details:\n- Compute all internal quantities in atomic units, then convert the final $\\Phi_{hkl}$ to electronvolts using $1 \\, \\mathrm{Hartree} = 27.211386245988 \\, \\mathrm{eV}$.\n- Use a uniform grid for $z \\in [0, z_{\\max}]$, with at least $N = 4096$ points for numerical integration.\n- For each test case, report the work function in eV, rounded to three decimal places.\n\nTest suite:\n- Case 1: W, $(110)$, PBE.\n- Case 2: W, $(100)$, PBEsol.\n- Case 3: W, $(111)$, PW91.\n- Case 4: W, $(210)$, PBE.\n- Case 5: Al, $(111)$, PBEsol.\n- Case 6: Al, $(100)$, PBE.\n- Case 7: Al, $(110)$, PW91.\n- Case 8: Al, $(311)$, PBE.\n\nFinal output format:\n- Your program should produce a single line of output containing the eight computed work functions in eV as a comma-separated list enclosed in square brackets, in the order of the test suite above. For example, an output line must look like\n  $$ [\\phi_1,\\phi_2,\\phi_3,\\phi_4,\\phi_5,\\phi_6,\\phi_7,\\phi_8] $$\n  where each $\\phi_i$ is a decimal rounded to three places. The output must be the only printed line.", "solution": "The problem posed is a valid exercise in computational materials physics. It defines a self-contained, simplified model for calculating the work function of metallic surfaces based on exchange-only Density Functional Theory (DFT) within the Generalized Gradient Approximation (GGA). All necessary physical parameters, mathematical formulas, and computational instructions are provided, constituting a well-posed problem. The use of a single symbol, $\\kappa$, for two distinct physical quantities—the density decay parameter and a GGA functional parameter—is a minor notational ambiguity that can be resolved by context and careful implementation. We shall proceed with a detailed solution.\n\nThe objective is to compute the work function $\\Phi_{hkl}$ for specified metallic surfaces using the provided model. The solution is constructed by systematically evaluating each component of the model in atomic units (Hartree units: $\\hbar=m_e=e=4\\pi\\epsilon_0=1$) and then converting the final result to electronvolts (eV).\n\nThe work function within this model is approximated as:\n$$ \\Phi_{hkl} \\approx \\varepsilon_F(n_b) + v_{x}^{\\mathrm{eff}} $$\nHere, $\\varepsilon_F(n_b)$ is the Fermi energy of the bulk material, which depends on the bulk electron density $n_b$. The term $v_{x}^{\\mathrm{eff}}$ is an effective surface potential, representing the exchange-only contribution to the potential step at the metal-vacuum interface. This term introduces the orientation dependence of the work function via the surface electron density profile. Note that correlation effects are explicitly neglected as per the problem statement.\n\nThe calculation proceeds in the following steps:\n\n1.  **Determination of Material and Geometric Parameters**:\n    The model's anisotropy arises from the orientation-dependent decay of the electron density into the vacuum. This is governed by the decay parameter $\\kappa_{hkl}$, which depends on the interplanar spacing $d_{hkl}$ for a given Miller index $(h,k,l)$. For a cubic lattice with lattice constant $a$, this spacing is:\n    $$ d_{hkl} = \\frac{a}{\\sqrt{h^2 + k^2 + l^2}} $$\n    The decay parameter is then defined as:\n    $$ \\kappa_{hkl} = \\frac{\\alpha}{d_{hkl}} $$\n    where $\\alpha$ is a material-specific dimensionless scale factor. The lattice constant $a$ must be converted from angstroms ($\\mathrm{\\AA}$) to Bohr radii ($a_0$) using the conversion factor $1 \\, \\mathrm{\\AA} = 1.889726125 \\, a_0$.\n\n2.  **Calculation of Bulk Electronic Properties**:\n    The bulk properties are determined from the Wigner-Seitz radius $r_s$, which defines the bulk electron density $n_b$ in the jellium model:\n    $$ n_b = \\frac{3}{4 \\pi r_s^3} $$\n    From the bulk density, we calculate the bulk Fermi wave vector $k_{F,b}$ and the corresponding kinetic Fermi energy $\\varepsilon_F(n_b)$:\n    $$ k_{F,b} = (3 \\pi^2 n_b)^{1/3} $$\n    $$ \\varepsilon_F(n_b) = \\frac{1}{2} k_{F,b}^2 $$\n\n3.  **Modeling the Surface Density and Gradient**:\n    The electron density $n(z)$ is modeled as constant in the bulk ($z < 0$) and decaying exponentially into the vacuum ($z \\ge 0$):\n    $$ n(z) = n_b e^{-\\kappa_{hkl} z} $$\n    A key ingredient for GGA functionals is the reduced density gradient, $s(z)$. It is defined as:\n    $$ s(z) = \\frac{|\\nabla n(z)|}{2 k_F(z) n(z)} $$\n    where $k_F(z) = (3 \\pi^2 n(z))^{1/3}$. For our exponential density profile, the gradient magnitude is $|\\nabla n(z)| = \\kappa_{hkl} n(z)$. The local Fermi vector becomes $k_F(z) = k_{F,b} e^{-\\kappa_{hkl} z / 3}$. Substituting these into the definition of $s(z)$ yields a simplified expression that grows exponentially with distance $z$ from the surface:\n    $$ s(z) = \\frac{\\kappa_{hkl} n(z)}{2 (k_{F,b} e^{-\\kappa_{hkl} z/3}) n(z)} = \\frac{\\kappa_{hkl}}{2 k_{F,b}} e^{\\kappa_{hkl} z / 3} $$\n\n4.  **Evaluation of the Exchange Potential**:\n    The GGA exchange potential $v_x^{\\mathrm{GGA}}$ is constructed by applying an enhancement factor $F_x(s)$ to the Local Density Approximation (LDA) potential, $v_x^{\\mathrm{LDA}}$. The LDA potential depends only on the local density:\n    $$ v_x^{\\mathrm{LDA}}(n) = -C_x n^{1/3}, \\quad \\text{where} \\quad C_x = \\left(\\frac{3}{\\pi}\\right)^{1/3} $$\n    For our surface profile, this becomes $v_x^{\\mathrm{LDA}}(z) = v_x^{\\mathrm{LDA}}(n_b) e^{-\\kappa_{hkl} z / 3}$.\n\n    The enhancement factor $F_x(s)$ introduces the gradient correction. The problem specifies the following functional form, where we use $\\kappa_{GGA}$ to denote the GGA parameter to distinguish it from the decay constant $\\kappa_{hkl}$:\n    $$ F_x(s) = 1 + \\kappa_{GGA} - \\frac{\\kappa_{GGA}}{1 + \\mu s^2 / \\kappa_{GGA}} $$\n    The parameters $\\mu$ and $\\kappa_{GGA}$ are specific to the chosen functional (PBE, PW91, or PBEsol). The full GGA exchange potential as a function of $z$ is then:\n    $$ v_x^{\\mathrm{GGA}}(z) = v_x^{\\mathrm{LDA}}(n(z)) \\, F_x(s(z)) $$\n\n5.  **Computation of the Effective Surface Potential**:\n    The term $v_x^{\\mathrm{eff}}$ is defined as a weighted average of the GGA exchange potential over the surface region, from $z=0$ to a cutoff $z_{\\max} = 12/\\kappa_{hkl}$:\n    $$ v_{x}^{\\mathrm{eff}} = \\frac{\\displaystyle \\int_0^{z_{\\max}} w(z) \\, v_x^{\\mathrm{GGA}}(z) \\, dz}{\\displaystyle \\int_0^{z_{\\max}} w(z) \\, dz} $$\n    The weighting function is given as $w(z) = \\kappa_{hkl} e^{-\\kappa_{hkl} z}$. The integral in the denominator can be evaluated analytically:\n    $$ \\int_0^{z_{\\max}} \\kappa_{hkl} e^{-\\kappa_{hkl} z} \\, dz = \\left[-e^{-\\kappa_{hkl} z}\\right]_0^{z_{\\max}} = 1 - e^{-\\kappa_{hkl} z_{\\max}} = 1 - e^{-12} $$\n    The integral in the numerator involves the complicated $v_x^{\\mathrm{GGA}}(z)$ term and must be evaluated numerically. We establish a uniform grid of $N=4096$ points for $z$ in the interval $[0, z_{\\max}]$ and use the trapezoidal rule for integration.\n\n6.  **Final Assembly and Unit Conversion**:\n    With all components calculated in atomic units, the work function is:\n    $$ \\Phi_{hkl} [\\text{Hartree}] = \\varepsilon_F(n_b) + v_x^{\\mathrm{eff}} $$\n    The final result is converted to electronvolts using the conversion factor $1 \\, \\text{Hartree} = 27.211386245988 \\, \\text{eV}$. The value is then rounded to three decimal places as required. The entire procedure is repeated for each of the eight test cases.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the metallic work function for specified surfaces using a simplified\n    exchange-only GGA model.\n    \"\"\"\n\n    # --- Constants and Conversion Factors (in atomic units) ---\n    A_to_BOHR = 1.889726125\n    HARTREE_to_EV = 27.211386245988\n    \n    # --- Material and Functional Parameters ---\n    \n    # Material properties\n    MATERIALS = {\n        'W': {'a_A': 3.165, 'rs': 2.30, 'alpha': 2.0},\n        'Al': {'a_A': 4.049, 'rs': 2.07, 'alpha': 1.2},\n    }\n\n    # GGA functional parameters (mu, kappa_gga)\n    # Using 'kappa_gga' to distinguish from the density decay parameter 'kappa_decay'.\n    FUNCTIONALS = {\n        'PBE': {'mu': 0.21951, 'kappa_gga': 0.804},\n        'PW91': {'mu': 0.19645, 'kappa_gga': 0.804},\n        'PBEsol': {'mu': 10.0 / 81.0, 'kappa_gga': 0.804},\n    }\n\n    # --- Test Suite ---\n    test_cases = [\n        # (Material, Miller indices (h,k,l), Functional name)\n        ('W', (1, 1, 0), 'PBE'),\n        ('W', (1, 0, 0), 'PBEsol'),\n        ('W', (1, 1, 1), 'PW91'),\n        ('W', (2, 1, 0), 'PBE'),\n        ('Al', (1, 1, 1), 'PBEsol'),\n        ('Al', (1, 0, 0), 'PBE'),\n        ('Al', (1, 1, 0), 'PW91'),\n        ('Al', (3, 1, 1), 'PBE'),\n    ]\n\n    # --- Numerical Parameters ---\n    N_POINTS = 4096\n\n    results = []\n    \n    for material, hkl, functional_name in test_cases:\n        \n        # 1. Select parameters for the current case\n        mat_props = MATERIALS[material]\n        func_params = FUNCTIONALS[functional_name]\n        \n        a_bohr = mat_props['a_A'] * A_to_BOHR\n        rs = mat_props['rs']\n        alpha = mat_props['alpha']\n        mu = func_params['mu']\n        kappa_gga = func_params['kappa_gga']\n        \n        h, k, l = hkl\n        \n        # 2. Calculate geometric and decay parameters\n        if h == 0 and k == 0 and l == 0:\n            # Avoid division by zero, though not present in test cases\n            d_hkl = np.inf \n        else:\n            d_hkl = a_bohr / np.sqrt(h**2 + k**2 + l**2)\n\n        kappa_decay = alpha / d_hkl\n        \n        # 3. Calculate bulk electronic properties\n        n_b = 3.0 / (4.0 * np.pi * rs**3)\n        kF_b = (3.0 * np.pi**2 * n_b)**(1.0 / 3.0)\n        epsilon_F = 0.5 * kF_b**2\n        \n        # 4. Set up numerical integration grid\n        z_max = 12.0 / kappa_decay\n        z = np.linspace(0, z_max, N_POINTS)\n        \n        # 5. Define and evaluate z-dependent functions on the grid\n        \n        # Reduced density gradient, s(z)\n        s_z = (kappa_decay / (2.0 * kF_b)) * np.exp(kappa_decay * z / 3.0)\n        \n        # LDA exchange potential, v_x^LDA(z)\n        C_x = (3.0 / np.pi)**(1.0 / 3.0)\n        vx_lda_z = -C_x * (n_b)**(1.0 / 3.0) * np.exp(-kappa_decay * z / 3.0)\n        \n        # GGA enhancement factor, F_x(s)\n        Fx_s = 1.0 + kappa_gga - kappa_gga / (1.0 + mu * s_z**2 / kappa_gga)\n        \n        # GGA exchange potential, v_x^GGA(z)\n        vx_gga_z = vx_lda_z * Fx_s\n        \n        # 6. Calculate the effective exchange potential v_x^eff\n        \n        # Weighting function w(z)\n        w_z = kappa_decay * np.exp(-kappa_decay * z)\n        \n        # Numerator of v_x^eff is the integral of w(z) * v_x^GGA(z)\n        numerator_integral = np.trapz(w_z * vx_gga_z, z)\n        \n        # Denominator of v_x^eff is the integral of w(z)\n        denominator_integral = 1.0 - np.exp(-12.0)\n        \n        vx_eff = numerator_integral / denominator_integral\n        \n        # 7. Calculate the work function and convert to eV\n        phi_hkl_hartree = epsilon_F + vx_eff\n        phi_hkl_ev = phi_hkl_hartree * HARTREE_to_EV\n        \n        results.append(round(phi_hkl_ev, 3))\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.3f}' for r in results)}]\")\n\nsolve()\n```", "id": "3454004"}]}