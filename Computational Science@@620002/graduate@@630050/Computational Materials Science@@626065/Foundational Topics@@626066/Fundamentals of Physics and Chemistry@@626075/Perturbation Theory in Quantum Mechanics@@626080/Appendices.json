{"hands_on_practices": [{"introduction": "Standard perturbation theory fails when states are degenerate, a common occurrence in systems with high symmetry. This exercise tackles this fundamental challenge head-on by applying degenerate perturbation theory to a model molecular crystal [@problem_id:3474534]. You will construct and diagonalize an effective Hamiltonian within the degenerate subspace to calculate energy splittings, providing a crucial test of the theory's predictions against exact results and building intuition for its application.", "problem": "Consider a tight-binding surrogate of a highly symmetric molecular crystal used to model the single-particle Kohn-Sham operator from Density Functional Theory (DFT). The unperturbed Hamiltonian is a Hermitian matrix $H_0 \\in \\mathbb{R}^{4 \\times 4}$ with exact twofold degeneracy, and a symmetry-lowering perturbation $V \\in \\mathbb{R}^{4 \\times 4}$ is introduced. The total Hamiltonian is defined as $H(\\lambda) = H_0 + \\lambda V$ with $\\lambda \\in \\mathbb{R}$ a dimensionless parameter controlling the perturbation strength. All energies are to be treated in electronvolts (eV).\n\nThe matrices are specified as follows. The unperturbed Hamiltonian $H_0$ is diagonal:\n$$\nH_0 = \\mathrm{diag}(0.8,\\, 1.0,\\, 1.0,\\, 1.6)\\,,\n$$\nwhich contains an exact twofold degeneracy at $E_0 = 1.0\\,\\mathrm{eV}$ in the subspace spanned by the canonical basis vectors corresponding to indices $1$ and $2$ (using zero-based indexing). The perturbation $V$ is a Hermitian matrix that lowers symmetry by coupling the degenerate states and mixing them with the non-degenerate states:\n$$\nV =\n\\begin{pmatrix}\n0 & 0.1 & -0.1 & 0.02 \\\\\n0.1 & 0.05 & 0.2 & 0.05 \\\\\n-0.1 & 0.2 & -0.05 & 0.07 \\\\\n0.02 & 0.05 & 0.07 & 0\n\\end{pmatrix}\\,.\n$$\n\nStarting from the time-independent Schrödinger equation $H(\\lambda)\\ket{\\psi} = E(\\lambda)\\ket{\\psi}$ and the standard postulates of quantum mechanics for Hermitian operators, implement degenerate perturbation theory up to second order inside the degenerate manifold of $H_0$ to predict the splitting of the formerly degenerate energy level, and then compare it to benchmark “symmetry-adapted DFT” results taken here to be the exact eigenvalue splitting of $H(\\lambda)$ obtained by direct diagonalization.\n\nYour program must perform the following tasks for each given $\\lambda$:\n1. Identify the twofold degenerate subspace of $H_0$ at energy $E_0 = 1.0\\,\\mathrm{eV}$ and construct the projector $P$ onto this subspace, and the complementary projector $Q = I - P$.\n2. Compute the first-order effective Hamiltonian restricted to the degenerate manifold, $H_{\\mathrm{eff}}^{(1)}(\\lambda) = \\lambda\\,PVP$, and its eigenvalues to obtain the first-order energy corrections inside the degenerate subspace.\n3. Compute the second-order contribution to the effective Hamiltonian inside the degenerate manifold using the resolvent of $H_0$ restricted to the complementary subspace:\n$$\nH_{\\mathrm{eff}}^{(2)}(\\lambda) = \\lambda^2\\,PVQ\\,(E_0 I_Q - QH_0Q)^{-1}\\,QVP\\,,\n$$\nand form the total effective Hamiltonian $H_{\\mathrm{eff}}(\\lambda) = H_{\\mathrm{eff}}^{(1)}(\\lambda) + H_{\\mathrm{eff}}^{(2)}(\\lambda)$. Diagonalize $H_{\\mathrm{eff}}(\\lambda)$ to obtain the two energies within the degenerate subspace up to second order, and define the predicted splitting $\\Delta_{\\mathrm{PT}}(\\lambda)$ as the absolute difference of these two energies.\n4. Obtain the exact benchmark splitting $\\Delta_{\\mathrm{exact}}(\\lambda)$ by diagonalizing $H(\\lambda)$ directly and selecting the two eigenvalues whose eigenvectors have the largest total weight within the degenerate subspace (sum of squared magnitudes on indices $1$ and $2$). Define $\\Delta_{\\mathrm{exact}}(\\lambda)$ as the absolute difference of these two selected eigenvalues.\n5. Compute the relative error as a dimensionless decimal:\n$$\n\\varepsilon(\\lambda) =\n\\begin{cases}\n0.0 & \\text{if } \\Delta_{\\mathrm{exact}}(\\lambda) = 0,\\\\\n\\left|\\Delta_{\\mathrm{PT}}(\\lambda) - \\Delta_{\\mathrm{exact}}(\\lambda)\\right| \\big/ \\Delta_{\\mathrm{exact}}(\\lambda) & \\text{otherwise.}\n\\end{cases}\n$$\n\nUse the following test suite of perturbation strengths:\n$$\n\\lambda \\in \\{0.0,\\, 0.1,\\, 0.5,\\, 1.0\\}\\,.\n$$\n\nAll energies must be treated in $\\mathrm{eV}$, while the final reported quantities are dimensionless decimals. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, ordered in the same sequence of the test suite values. For example: “[result\\_for\\_0.0,result\\_for\\_0.1,result\\_for\\_0.5,result\\_for\\_1.0]”.", "solution": "### 1. Theoretical Framework\n\nThe core of the problem is to compute the splitting of a degenerate energy level under a small perturbation, using two different methods: degenerate perturbation theory and exact diagonalization.\n\n**a. Unperturbed System and Degeneracy**\nThe unperturbed Hamiltonian, $H_0$, is given as a diagonal matrix:\n$$\nH_0 = \\mathrm{diag}(0.8,\\, 1.0,\\, 1.0,\\, 1.6)\n$$\nThe eigenvalues are the diagonal entries. There is a twofold degeneracy at energy $E_0 = 1.0 \\, \\mathrm{eV}$, corresponding to the basis states $\\ket{1}$ and $\\ket{2}$ (using zero-based indexing). The degenerate subspace, $D$, is spanned by $\\{\\ket{1}, \\ket{2}\\}$. The complementary subspace, $D_{\\perp}$, is spanned by $\\{\\ket{0}, \\ket{3}\\}$.\n\nWe define the projector onto the degenerate subspace $D$ as $P$, and onto the complementary subspace $D_{\\perp}$ as $Q$. In the canonical basis, these are:\n$$\nP = \\begin{pmatrix} 0 & 0 & 0 & 0 \\\\ 0 & 1 & 0 & 0 \\\\ 0 & 0 & 1 & 0 \\\\ 0 & 0 & 0 & 0 \\end{pmatrix}, \\quad Q = I - P = \\begin{pmatrix} 1 & 0 & 0 & 0 \\\\ 0 & 0 & 0 & 0 \\\\ 0 & 0 & 0 & 0 \\\\ 0 & 0 & 0 & 1 \\end{pmatrix}\n$$\n\n**b. Degenerate Perturbation Theory**\nThe total Hamiltonian is $H(\\lambda) = H_0 + \\lambda V$. We seek the corrections to the degenerate energy level $E_0$ by constructing an effective Hamiltonian, $H_{\\mathrm{eff}}$, that acts solely within the degenerate subspace $D$. The problem asks to compute this up to second order in $\\lambda$. The eigenvalues of $H_{\\mathrm{eff}}$ will be the energy corrections $\\Delta E$.\n\nThe effective Hamiltonian is given by $H_{\\mathrm{eff}}(\\lambda) = H_{\\mathrm{eff}}^{(1)}(\\lambda) + H_{\\mathrm{eff}}^{(2)}(\\lambda)$.\n\n**First-Order Contribution:**\nThe first-order term is $H_{\\mathrm{eff}}^{(1)}(\\lambda) = \\lambda\\,PVP$. This operator, when restricted to the degenerate subspace $D$, is represented by a $2 \\times 2$ matrix, $W_1$, whose elements are $(\\boldsymbol{W}_1)_{ij} = \\bra{i}V\\ket{j}$ for $i, j \\in \\{1, 2\\}$.\n$$\n\\boldsymbol{W}_1 = \\begin{pmatrix} V_{11} & V_{12} \\\\ V_{21} & V_{22} \\end{pmatrix} = \\begin{pmatrix} 0.05 & 0.2 \\\\ 0.2 & -0.05 \\end{pmatrix}\n$$\n\n**Second-Order Contribution:**\nThe second-order term is $H_{\\mathrm{eff}}^{(2)}(\\lambda) = \\lambda^2\\,PVQ\\,(E_0 I_Q - QH_0Q)^{-1}\\,QVP$. This operator also acts within $D$. Its $2 \\times 2$ matrix representation, $\\boldsymbol{W}_2$, can be calculated by summing over the intermediate states $\\ket{k}$ in the complementary subspace $D_{\\perp}$:\n$$\n(\\boldsymbol{W}_2)_{ij} = \\sum_{k \\in D_{\\perp}} \\frac{\\bra{i}V\\ket{k}\\bra{k}V\\ket{j}}{E_0 - E_k} \\quad \\text{for } i, j \\in D\n$$\nThe states in $D_{\\perp}$ are $\\ket{0}$ and $\\ket{3}$, with unperturbed energies $E_0^{(0)} = 0.8 \\, \\mathrm{eV}$ and $E_3^{(0)} = 1.6 \\, \\mathrm{eV}$.\nThe components of $\\boldsymbol{W}_2$ are:\n$$\n(\\boldsymbol{W}_2)_{ij} = \\frac{V_{i0}V_{0j}}{E_0-E_0^{(0)}} + \\frac{V_{i3}V_{3j}}{E_0-E_3^{(0)}}\n$$\nFor $i, j \\in \\{1, 2\\}$ and using $E_0=1.0$, this yields:\n$$\n(\\boldsymbol{W}_2)_{11} = \\frac{V_{10}^2}{1.0-0.8} + \\frac{V_{13}^2}{1.0-1.6} = \\frac{0.1^2}{0.2} + \\frac{0.05^2}{-0.6} \\approx 0.045833\n$$\n$$\n(\\boldsymbol{W}_2)_{12} = \\frac{V_{10}V_{02}}{0.2} + \\frac{V_{13}V_{32}}{-0.6} = \\frac{(0.1)(-0.1)}{0.2} + \\frac{(0.05)(0.07)}{-0.6} \\approx -0.055833\n$$\n$$\n(\\boldsymbol{W}_2)_{21} = (\\boldsymbol{W}_2)_{12} \\quad (\\text{since } V \\text{ is Hermitian})\n$$\n$$\n(\\boldsymbol{W}_2)_{22} = \\frac{V_{20}^2}{0.2} + \\frac{V_{23}^2}{-0.6} = \\frac{(-0.1)^2}{0.2} + \\frac{0.07^2}{-0.6} \\approx 0.041833\n$$\n\n**Total Effective Hamiltonian:**\nThe total $2 \\times 2$ effective Hamiltonian matrix on the degenerate subspace $D$ is:\n$$\n\\boldsymbol{H}_{\\mathrm{eff,2\\times2}}(\\lambda) = \\lambda \\boldsymbol{W}_1 + \\lambda^2 \\boldsymbol{W}_2\n$$\nWe find the eigenvalues of this matrix, $\\Delta E_1(\\lambda)$ and $\\Delta E_2(\\lambda)$. The predicted energy splitting is then:\n$$\n\\Delta_{\\mathrm{PT}}(\\lambda) = |\\Delta E_1(\\lambda) - \\Delta E_2(\\lambda)|\n$$\n\n**c. Exact Diagonalization**\nThe benchmark splitting is obtained by direct numerical diagonalization of the full Hamiltonian $H(\\lambda) = H_0 + \\lambda V$. This yields four eigenvalues $E_i(\\lambda)$ and corresponding eigenvectors $\\ket{\\psi_i(\\lambda)}$.\nTo identify the two energies that evolved from the original degenerate level, we calculate the \"weight\" of each eigenvector $\\ket{\\psi_i}$ within the original degenerate subspace $D$:\n$$\nw_i = |\\braket{1|\\psi_i}|^2 + |\\braket{2|\\psi_i}|^2 = |\\psi_{i,1}|^2 + |\\psi_{i,2}|^2\n$$\nwhere $\\psi_{i,j}$ is the $j$-th component of the eigenvector $\\ket{\\psi_i}$. We select the two eigenvalues whose eigenvectors have the two largest weights. Let these eigenvalues be $E_a(\\lambda)$ and $E_b(\\lambda)$. The exact splitting is:\n$$\n\\Delta_{\\mathrm{exact}}(\\lambda) = |E_a(\\lambda) - E_b(\\lambda)|\n$$\n\n**d. Relative Error**\nFinally, the relative error between the perturbation theory result and the exact result is computed as:\n$$\n\\varepsilon(\\lambda) = \\left|\\Delta_{\\mathrm{PT}}(\\lambda) - \\Delta_{\\mathrm{exact}}(\\lambda)\\right| \\big/ \\Delta_{\\mathrm{exact}}(\\lambda)\n$$\nwith a special case for $\\Delta_{\\mathrm{exact}}(\\lambda) = 0$.\n\n### 2. Algorithmic Implementation\n\nThe Python implementation will follow these steps for each given value of $\\lambda$:\n\n1.  **Initialization**: Define the matrices $H_0$ and $V$ using `numpy` arrays. Define the degenerate energy $E_0$ and the indices for the degenerate ($P_{idx}$) and complementary ($Q_{idx}$) subspaces.\n2.  **Perturbation Theory Calculation**:\n    a. Construct the $2 \\times 2$ matrices $\\boldsymbol{W}_1$ and $\\boldsymbol{W}_2$ using the sub-blocks of $V$ and the energy denominators as derived above.\n    b. Form the $2 \\times 2$ effective Hamiltonian matrix $\\boldsymbol{H}_{\\mathrm{eff,2\\times2}}(\\lambda) = \\lambda \\boldsymbol{W}_1 + \\lambda^2 \\boldsymbol{W}_2$.\n    c. Compute its eigenvalues using `numpy.linalg.eigh`. The splitting $\\Delta_{\\mathrm{PT}}(\\lambda)$ is the absolute difference of these eigenvalues.\n3.  **Exact Diagonalization**:\n    a. Construct the full $4 \\times 4$ Hamiltonian matrix $H(\\lambda) = H_0 + \\lambda V$.\n    b. Compute its eigenvalues and eigenvectors using `numpy.linalg.eigh`.\n    c. For each eigenvector, calculate its weight in the degenerate subspace.\n    d. Identify the indices of the two eigenvectors with the largest weights.\n    e. The corresponding eigenvalues are the ones of interest. The splitting $\\Delta_{\\mathrm{exact}}(\\lambda)$ is their absolute difference.\n4.  **Error Calculation**: Compute the relative error $\\varepsilon(\\lambda)$ according to the given formula.\n5.  **Iteration**: Repeat for all values in the test suite for $\\lambda$ and store the results.\n6.  **Output**: Format the collected results into the specified string format.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the degenerate perturbation theory problem for a given set of parameters.\n    \"\"\"\n    # Define the unperturbed Hamiltonian H_0 as a diagonal matrix.\n    # Eigenenergies are in eV.\n    H0 = np.diag([0.8, 1.0, 1.0, 1.6])\n\n    # Define the perturbation matrix V.\n    V = np.array([\n        [0.0,  0.1, -0.1,  0.02],\n        [0.1,  0.05,  0.2,  0.05],\n        [-0.1,  0.2, -0.05,  0.07],\n        [0.02, 0.05,  0.07,  0.0]\n    ])\n\n    # Parameters for the degenerate-subspace calculation.\n    E0 = 1.0  # Degenerate energy level in eV.\n    p_indices = [1, 2]  # Indices of the degenerate subspace (P-space).\n    q_indices = [0, 3]  # Indices of the complementary subspace (Q-space).\n\n    # Test suite for the perturbation strength lambda.\n    test_cases = [0.0, 0.1, 0.5, 1.0]\n\n    results = []\n    for lam in test_cases:\n        # --- Degenerate Perturbation Theory Calculation ---\n\n        # W1 is the 2x2 matrix of the perturbation V restricted to the P-space.\n        # This corresponds to the first-order correction.\n        W1 = V[np.ix_(p_indices, p_indices)]\n\n        # W2 is the 2x2 matrix for the second-order correction.\n        # It is calculated using the formula derived from perturbation theory.\n        \n        # V_PQ block connects P-space to Q-space.\n        V_PQ = V[np.ix_(p_indices, q_indices)] \n        # V_QP block connects Q-space to P-space.\n        V_QP = V[np.ix_(q_indices, p_indices)]\n\n        # Energy denominators for the states in the Q-space.\n        E_q = H0.diagonal()[q_indices]\n        energy_denominators = E0 - E_q\n        \n        # The resolvent matrix (diagonal in this basis).\n        # We must handle the case of zero denominators, though not expected here.\n        with np.errstate(divide='raise'):\n            resolvent_diag = 1.0 / energy_denominators\n        \n        # Calculate W2 = V_PQ @ Resolvent @ V_QP\n        W2 = V_PQ @ np.diag(resolvent_diag) @ V_QP\n\n        # Form the 2x2 effective Hamiltonian matrix up to second order.\n        H_eff_2x2 = lam * W1 + lam**2 * W2\n\n        # Eigenvalues of the effective Hamiltonian are the energy shifts.\n        energy_shifts_pt = np.linalg.eigvalsh(H_eff_2x2)\n\n        # The predicted splitting is the difference between these energy shifts.\n        delta_pt = np.abs(energy_shifts_pt[1] - energy_shifts_pt[0])\n\n        # --- Exact Diagonalization Calculation ---\n        \n        # Construct the full Hamiltonian H(lambda) = H0 + lambda * V.\n        H_lam = H0 + lam * V\n\n        # Diagonalize the full Hamiltonian. eigh is used for Hermitian matrices.\n        exact_energies, exact_evecs = np.linalg.eigh(H_lam)\n\n        # Identify the two states that evolved from the degenerate subspace.\n        # These are the states whose eigenvectors have the largest weight in the P-space.\n        weights = np.sum(np.abs(exact_evecs[p_indices, :])**2, axis=0)\n        \n        # Get the indices of the two largest weights.\n        top_two_indices = np.argsort(weights)[-2:]\n        \n        # Select the corresponding exact energies.\n        relevant_energies = exact_energies[top_two_indices]\n\n        # The exact splitting is the difference between these two energies.\n        delta_exact = np.abs(relevant_energies[1] - relevant_energies[0])\n\n        # --- Relative Error Calculation ---\n\n        if delta_exact == 0.0:\n            # If there is no splitting, the perturbation theory should also predict none.\n            # In this case, relative error is 0.\n            relative_error = 0.0\n        else:\n            relative_error = np.abs(delta_pt - delta_exact) / delta_exact\n            \n        results.append(relative_error)\n\n    # Format the final output as a comma-separated list in brackets.\n    output_str = f\"[{','.join(map(str, results))}]\"\n    print(output_str)\n\nsolve()\n```", "id": "3474534"}, {"introduction": "Often, the most interesting physics is not revealed at first order, especially when symmetry constraints are at play. This practice explores a scenario where first-order energy shifts are forbidden, forcing us to look at higher-order corrections to explain physical phenomena [@problem_id:3474558]. By modeling the technologically important phenomenon of valley splitting, you will see how second-order perturbation theory, involving virtual transitions to remote states, correctly captures the dominant physics.", "problem": "Consider a minimal, symmetry-consistent near-degenerate perturbation theory model for valley splitting in strained silicon within the conduction-band manifold relevant to computational materials science. The physical base is the time-independent Schrödinger equation and standard perturbation theory. Let the unperturbed Hamiltonian be $H_0$ with a two-dimensional degenerate subspace spanned by $\\{ \\lvert 1 \\rangle, \\lvert 2 \\rangle \\}$ at energy $E_0$ and a single remote state $\\lvert r \\rangle$ at energy $E_r$, with $E_r > E_0$. The perturbation is linear in the uniaxial strain magnitude $\\lambda$ and is given by $V(\\lambda) = \\lambda W$, where $W$ is a strain-induced operator. Assume that first-order intra-subspace matrix elements vanish by symmetry, namely $W_{11} = W_{22} = W_{12} = W_{21} = 0$, and that the only nonzero couplings are between the valley subspace and the remote state with $W_{1r} = g$ and $W_{2r} = -g$, where $g$ is a real deformation potential amplitude. This captures the physically relevant situation in which symmetry forbids first-order splitting in the valley subspace, and the leading splitting arises at second order via virtual transitions through $\\lvert r \\rangle$.\n\nUsing degenerate perturbation theory, define the projector $P$ onto the valley subspace and $Q = I - P$. The effective Hamiltonian in the valley subspace up to second order in $\\lambda$ is\n$$\nH_{\\mathrm{eff}}^{(2)}(\\lambda) = E_0 I + \\lambda P W P + \\lambda^2 P W Q \\left( E_0 I - Q H_0 Q \\right)^{-1} Q W P,\n$$\nwhere $I$ is the identity operator on the appropriate space. In this model, $P W P = 0$ and the second-order term is nonzero due to $W_{ir}$, $i \\in \\{1,2\\}$.\n\nYour tasks are:\n- Derive the valley splitting $\\Delta E(\\lambda)$, defined as the difference between the two eigenvalues of $H_{\\mathrm{eff}}^{(2)}(\\lambda)$ in the valley subspace, keeping terms up to second order in $\\lambda$.\n- Benchmark this perturbative $\\Delta E(\\lambda)$ against the exact splitting obtained by diagonalizing the full Hamiltonian\n$$\nH(\\lambda) =\n\\begin{pmatrix}\nE_0 & 0 & \\lambda g \\\\\n0 & E_0 & -\\lambda g \\\\\n\\lambda g & -\\lambda g & E_r\n\\end{pmatrix},\n$$\nwhich is a $3 \\times 3$ matrix in the basis $\\{ \\lvert 1 \\rangle, \\lvert 2 \\rangle, \\lvert r \\rangle \\}$.\n\nUse the following scientifically plausible constants, expressed in electronvolts (eV):\n- $E_0 = 0.00 \\ \\text{eV}$,\n- $E_r = 0.20 \\ \\text{eV}$,\n- $g = 0.10 \\ \\text{eV}$.\n\nConstruct a test suite over four strain magnitudes:\n- $\\lambda = 0.00$,\n- $\\lambda = 0.001$,\n- $\\lambda = 0.020$,\n- $\\lambda = 0.050$.\n\nFor each $\\lambda$ in the test suite:\n- Compute the perturbative splitting $\\Delta E_{\\mathrm{pert}}(\\lambda)$ using the effective Hamiltonian up to second order in $\\lambda$ as derived.\n- Compute the exact splitting $\\Delta E_{\\mathrm{exact}}(\\lambda)$ by diagonalizing $H(\\lambda)$ and taking the difference between its two lowest eigenvalues.\n\nAll energies must be expressed in electronvolts (eV), rounded to six decimal places. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each entry is a two-element list $[\\Delta E_{\\mathrm{pert}}(\\lambda), \\Delta E_{\\mathrm{exact}}(\\lambda)]$ corresponding to one $\\lambda$ in the test suite, in the same order. For example, an output for two test cases would look like $[[x_1,y_1],[x_2,y_2]]$, where $x_i$ and $y_i$ are floats in eV rounded to six decimal places.\n\nThe problem must be solved from first principles, starting with the definitions and laws described above and using standard results from perturbation theory. No shortcut formulas for the final splitting should be given in the problem statement. In absence of external first-principles data such as those from Density Functional Theory (DFT), use exact diagonalization of the minimal Hamiltonian $H(\\lambda)$ as the benchmark reference.", "solution": "### 1. Derivation of Perturbative Valley Splitting, $\\Delta E_{\\mathrm{pert}}(\\lambda)$\n\nWe begin with the provided formula for the effective Hamiltonian in the degenerate valley subspace $\\{\\lvert 1 \\rangle, \\lvert 2 \\rangle\\}$ up to second order in the strain parameter $\\lambda$:\n$$\nH_{\\mathrm{eff}}^{(2)}(\\lambda) = E_0 I + \\lambda P W P + \\lambda^2 P W Q ( E_0 I - Q H_0 Q )^{-1} Q W P\n$$\nHere, $P = \\lvert 1 \\rangle\\langle 1 \\rvert + \\lvert 2 \\rangle\\langle 2 \\rvert$ is the projector onto the degenerate subspace, and $Q = I - P = \\lvert r \\rangle\\langle r \\rvert$ is the projector onto the remote state subspace, as the total Hilbert space is spanned by $\\{\\lvert 1 \\rangle, \\lvert 2 \\rangle, \\lvert r \\rangle\\}$.\n\nWe evaluate each term's contribution to the $2 \\times 2$ matrix representation of $H_{\\mathrm{eff}}^{(2)}(\\lambda)$ in the $\\{\\lvert 1 \\rangle, \\lvert 2 \\rangle\\}$ basis.\n\n- **Zeroth-order term**: $E_0 I$ is represented by the matrix $\\begin{pmatrix} E_0 & 0 \\\\ 0 & E_0 \\end{pmatrix}$.\n\n- **First-order term**: $\\lambda P W P$. The matrix elements are $\\lambda \\langle i | W | j \\rangle = \\lambda W_{ij}$ for $i,j \\in \\{1,2\\}$. The problem states that by symmetry, $W_{11} = W_{22} = W_{12} = W_{21} = 0$. Therefore, this term is the zero matrix: $\\lambda \\begin{pmatrix} 0 & 0 \\\\ 0 & 0 \\end{pmatrix}$.\n\n- **Second-order term**: $H^{(2)} = \\lambda^2 P W Q ( E_0 I - Q H_0 Q )^{-1} Q W P$. Its matrix elements $(H^{(2)})_{ij}$ for $i,j \\in \\{1,2\\}$ are given by:\n$$\n(H^{(2)})_{ij} = \\lambda^2 \\langle i | W Q ( E_0 I - Q H_0 Q )^{-1} Q W | j \\rangle\n$$\nInserting a complete set of states, which is just $\\lvert r \\rangle$ for the subspace projected by $Q$, we get:\n$$\n(H^{(2)})_{ij} = \\lambda^2 \\langle i | W | r \\rangle \\langle r | ( E_0 I - Q H_0 Q )^{-1} | r \\rangle \\langle r | W | j \\rangle\n$$\nThe operator in the middle acts on the eigenstate $\\lvert r \\rangle$. Since $H_0 \\lvert r \\rangle = E_r \\lvert r \\rangle$ and $Q \\lvert r \\rangle = \\lvert r \\rangle$, we have $(E_0 I - Q H_0 Q) \\lvert r \\rangle = (E_0 - E_r)\\lvert r \\rangle$. The inverse operator thus yields $(E_0 - E_r)^{-1}$. The expression simplifies to:\n$$\n(H^{(2)})_{ij} = \\lambda^2 W_{ir} \\frac{1}{E_0 - E_r} W_{rj}\n$$\nUsing the given non-zero couplings $W_{1r} = g$, $W_{2r} = -g$, and noting that $W_{rj} = \\langle r | W | j \\rangle = \\langle j | W | r \\rangle^* = W_{jr}^* = W_{jr}$ because $g$ is real, we find the matrix elements:\n- $(H^{(2)})_{11} = \\lambda^2 \\frac{W_{1r} W_{r1}}{E_0 - E_r} = \\lambda^2 \\frac{g \\cdot g}{E_0 - E_r} = \\frac{\\lambda^2 g^2}{E_0 - E_r}$\n- $(H^{(2)})_{22} = \\lambda^2 \\frac{W_{2r} W_{r2}}{E_0 - E_r} = \\lambda^2 \\frac{(-g) \\cdot (-g)}{E_0 - E_r} = \\frac{\\lambda^2 g^2}{E_0 - E_r}$\n- $(H^{(2)})_{12} = \\lambda^2 \\frac{W_{1r} W_{r2}}{E_0 - E_r} = \\lambda^2 \\frac{g \\cdot (-g)}{E_0 - E_r} = -\\frac{\\lambda^2 g^2}{E_0 - E_r}$\n- $(H^{(2)})_{21} = (H^{(2)})_{12} = -\\frac{\\lambda^2 g^2}{E_0 - E_r}$\n\nCombining all terms, the effective Hamiltonian is:\n$$\nH_{\\mathrm{eff}}^{(2)}(\\lambda) = \\begin{pmatrix} E_0 + \\frac{\\lambda^2 g^2}{E_0 - E_r} & -\\frac{\\lambda^2 g^2}{E_0 - E_r} \\\\ -\\frac{\\lambda^2 g^2}{E_0 - E_r} & E_0 + \\frac{\\lambda^2 g^2}{E_0 - E_r} \\end{pmatrix}\n$$\nThe eigenvalues $E'$ of a $2 \\times 2$ matrix of the form $\\begin{pmatrix} A & B \\\\ B & A \\end{pmatrix}$ are $A \\pm B$. Here, $A = E_0 + \\frac{\\lambda^2 g^2}{E_0 - E_r}$ and $B = -\\frac{\\lambda^2 g^2}{E_0 - E_r}$.\nThe eigenvalues are:\n- $E'_1 = A+B = E_0 + \\frac{\\lambda^2 g^2}{E_0 - E_r} - \\frac{\\lambda^2 g^2}{E_0 - E_r} = E_0$\n- $E'_2 = A-B = E_0 + \\frac{\\lambda^2 g^2}{E_0 - E_r} - (-\\frac{\\lambda^2 g^2}{E_0 - E_r}) = E_0 + \\frac{2\\lambda^2 g^2}{E_0 - E_r}$\n\nThe valley splitting $\\Delta E_{\\mathrm{pert}}(\\lambda)$ is the absolute difference between these eigenvalues:\n$$\n\\Delta E_{\\mathrm{pert}}(\\lambda) = |E'_1 - E'_2| = \\left| -\\frac{2\\lambda^2 g^2}{E_0 - E_r} \\right| = \\frac{2\\lambda^2 g^2}{E_r - E_0}\n$$\nThis is the final expression for the perturbative splitting up to second order.\n\n### 2. Derivation of Exact Valley Splitting, $\\Delta E_{\\mathrm{exact}}(\\lambda)$\n\nThe exact splitting is found by diagonalizing the full $3 \\times 3$ Hamiltonian:\n$$\nH(\\lambda) =\n\\begin{pmatrix}\nE_0 & 0 & \\lambda g \\\\\n0 & E_0 & -\\lambda g \\\\\n\\lambda g & -\\lambda g & E_r\n\\end{pmatrix}\n$$\nThe eigenvalues $E$ are the roots of the characteristic equation $\\det(H(\\lambda) - E I) = 0$:\n$$\n\\det \\begin{pmatrix} E_0 - E & 0 & \\lambda g \\\\ 0 & E_0 - E & -\\lambda g \\\\ \\lambda g & -\\lambda g & E_r - E \\end{pmatrix} = 0\n$$\nExpanding the determinant along the first row:\n$$\n(E_0 - E) \\left[ (E_0 - E)(E_r - E) - (-\\lambda g)(-\\lambda g) \\right] - 0 + (\\lambda g) \\left[ 0 - (E_0 - E)(\\lambda g) \\right] = 0\n$$\n$$\n(E_0 - E) \\left[ (E_0 - E)(E_r - E) - \\lambda^2 g^2 \\right] - \\lambda^2 g^2 (E_0 - E) = 0\n$$\n$$\n(E_0 - E) \\left[ (E_0 - E)(E_r - E) - 2\\lambda^2 g^2 \\right] = 0\n$$\nThis equation yields one root immediately: $E_1 = E_0$. The other two roots come from the quadratic equation:\n$$\n(E_0 - E)(E_r - E) - 2\\lambda^2 g^2 = 0 \\implies E^2 - (E_0 + E_r)E + E_0 E_r - 2\\lambda^2 g^2 = 0\n$$\nUsing the quadratic formula, the other two eigenvalues are:\n$$\nE = \\frac{(E_0 + E_r) \\pm \\sqrt{(E_0 + E_r)^2 - 4(E_0 E_r - 2\\lambda^2 g^2)}}{2}\n$$\n$$\nE = \\frac{(E_0 + E_r) \\pm \\sqrt{E_0^2 + 2E_0E_r + E_r^2 - 4E_0E_r + 8\\lambda^2 g^2}}{2} = \\frac{(E_0 + E_r) \\pm \\sqrt{(E_r - E_0)^2 + 8\\lambda^2 g^2}}{2}\n$$\nIn the limit $\\lambda \\to 0$, the roots of the quadratic become $E_0$ and $E_r$. Thus, the two lowest eigenvalues of $H(\\lambda)$, corresponding to the perturbed valley states, are:\n- $E_1 = E_0$\n- $E_2 = \\frac{(E_0 + E_r) - \\sqrt{(E_r - E_0)^2 + 8\\lambda^2 g^2}}{2}$\n\nThe exact valley splitting $\\Delta E_{\\mathrm{exact}}(\\lambda)$ is the absolute difference between these two lowest eigenvalues:\n$$\n\\Delta E_{\\mathrm{exact}}(\\lambda) = |E_1 - E_2| = \\left| E_0 - \\frac{E_0 + E_r - \\sqrt{(E_r - E_0)^2 + 8\\lambda^2 g^2}}{2} \\right|\n$$\n$$\n\\Delta E_{\\mathrm{exact}}(\\lambda) = \\left| \\frac{2E_0 - E_0 - E_r + \\sqrt{(E_r - E_0)^2 + 8\\lambda^2 g^2}}{2} \\right|\n$$\n$$\n\\Delta E_{\\mathrm{exact}}(\\lambda) = \\left| \\frac{-(E_r - E_0) + \\sqrt{(E_r - E_0)^2 + 8\\lambda^2 g^2}}{2} \\right|\n$$\nSince $\\sqrt{(E_r - E_0)^2 + 8\\lambda^2 g^2} > (E_r - E_0)$, the numerator is positive.\n$$\n\\Delta E_{\\mathrm{exact}}(\\lambda) = \\frac{\\sqrt{(E_r - E_0)^2 + 8\\lambda^2 g^2} - (E_r - E_0)}{2}\n$$\nThis is the final expression for the exact splitting.\n\n### 3. Numerical Calculation\nThe derived formulas will be used to compute the splittings for the specified parameters: $E_0 = 0.00 \\ \\text{eV}$, $E_r = 0.20 \\ \\text{eV}$, $g = 0.10 \\ \\text{eV}$, and for each $\\lambda \\in \\{0.00, 0.001, 0.020, 0.050\\}$. The results will be rounded to six decimal places as requested.\n\nThe implementation will calculate:\n- $\\Delta E_{\\mathrm{pert}}(\\lambda) = \\frac{2\\lambda^2 (0.10)^2}{0.20 - 0.00} = \\frac{0.02 \\lambda^2}{0.20} = 0.1 \\lambda^2$\n- $\\Delta E_{\\mathrm{exact}}(\\lambda) = \\frac{\\sqrt{(0.20)^2 + 8\\lambda^2 (0.10)^2} - 0.20}{2} = \\frac{\\sqrt{0.04 + 0.08 \\lambda^2} - 0.20}{2}$\n\nThe results for each $\\lambda$ will be compiled into the final output format.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for and compares perturbative and exact valley splitting in a minimal\n    3-level quantum system model.\n    \"\"\"\n    # Define the scientifically plausible constants in units of electronvolts (eV).\n    E0 = 0.00\n    Er = 0.20\n    g = 0.10\n\n    # Define the test suite of strain magnitudes.\n    test_cases = [0.00, 0.001, 0.020, 0.050]\n\n    results = []\n    for lam in test_cases:\n        # Calculate perturbative splitting using the derived formula:\n        # delta_E_pert = 2 * lambda^2 * g^2 / (Er - E0)\n        pert_split = (2 * lam**2 * g**2) / (Er - E0)\n\n        # Calculate exact splitting using the derived formula:\n        # delta_E_exact = (sqrt((Er - E0)^2 + 8 * lambda^2 * g^2) - (Er - E0)) / 2\n        # Use numpy.sqrt for numerical stability and correctness.\n        er_minus_e0 = Er - E0\n        exact_split = (np.sqrt(er_minus_e0**2 + 8 * lam**2 * g**2) - er_minus_e0) / 2\n        \n        # Store the pair of results for the current lambda.\n        # The problem requires the output numbers to be rounded to six decimal places,\n        # and formatted as a list of lists of floats without extra spaces.\n        # We format the numbers into strings with the required precision.\n        result_pair_str = f\"[{pert_split:.6f},{exact_split:.6f}]\"\n        results.append(result_pair_str)\n\n    # Final print statement in the exact required format: [[x1,y1],[x2,y2],...]\n    # The list `results` contains strings that are already formatted as \"[n1,n2]\",\n    # so we join them with commas and enclose in an outer pair of brackets.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "3474558"}, {"introduction": "Perturbation theory extends beyond calculating energy shifts; it is a powerful tool for systematically constructing effective Hamiltonians that capture the essential low-energy physics of a system. In this advanced practice, you will use the celebrated $k \\cdot p$ method, a perturbative expansion in crystal momentum $\\boldsymbol{k}$, to build a model for the electronic bands of a strained two-dimensional Dirac material [@problem_id:3474565]. This exercise mirrors how researchers create predictive models of novel materials and helps develop a critical understanding of a theory's domain of validity by comparing different orders of approximation.", "problem": "Consider a two-dimensional crystalline material that exhibits a linear band crossing (a Dirac point) at a high-symmetry wavevector. Near the crossing, the conduction and valence bands can be described by a two-band effective Hamiltonian constructed by the $k\\cdot p$ method. Let $\\boldsymbol{k}=(k_x,k_y)$ be the crystal momentum measured relative to the Dirac point, and let the small homogeneous strain tensor be $\\boldsymbol{\\varepsilon}=\\begin{pmatrix}\\varepsilon_{xx} & \\varepsilon_{xy} \\\\ \\varepsilon_{xy} & \\varepsilon_{yy}\\end{pmatrix}$. Use perturbation theory in quantum mechanics to construct symmetry-allowed terms up to a specified order in $\\boldsymbol{\\varepsilon}$ and assess the regime where higher-order terms are essential by comparing with a surrogate of first-principles strained band energies.\n\nFundamental base:\n- The time-independent Schrödinger equation is $H\\psi=E\\psi$. For Bloch electrons near a degeneracy, the $k\\cdot p$ method asserts a Taylor-like expansion of the Bloch Hamiltonian in small $\\boldsymbol{k}$ around the degeneracy point, constrained by crystal symmetry, which to leading order yields a linear-in-$\\boldsymbol{k}$ Dirac-type Hamiltonian with Pauli matrices $\\sigma_x,\\sigma_y,\\sigma_z$ acting in the two-band subspace.\n- Strain couples to the electronic structure via symmetry-allowed scalar, vector, and mass-like terms. To lowest orders in $\\boldsymbol{\\varepsilon}$, these perturbations can renormalize velocities, generate tilt terms proportional to $\\boldsymbol{k}$, open a gap via a mass term, and create pseudogauge-like shifts that enter as $\\sigma_x$ and $\\sigma_y$ terms independent of $\\boldsymbol{k}$.\n\nDefinitions and invariants of strain:\n- Define the trace $t=\\mathrm{Tr}\\,\\boldsymbol{\\varepsilon}=\\varepsilon_{xx}+\\varepsilon_{yy}$.\n- Define the deviatoric component $d=\\varepsilon_{xx}-\\varepsilon_{yy}$ and the shear $\\varepsilon_{xy}$.\n- Define the vector $\\boldsymbol{g}(\\boldsymbol{\\varepsilon})=(d,\\,-2\\varepsilon_{xy})$.\n- Define the squared norm $n=\\varepsilon_{xx}^2+\\varepsilon_{yy}^2+2\\varepsilon_{xy}^2$.\n\nEffective Hamiltonians to be implemented:\n- The unstrained Dirac Hamiltonian is $H_0(\\boldsymbol{k})=\\hbar v_0\\,(\\sigma_x k_x+\\sigma_y k_y)$ with $\\hbar v_0$ treated as a constant prefactor in electronvolt–angstrom units so that energies are in electronvolts when $\\boldsymbol{k}$ is in inverse angstroms.\n- A first-order-in-strain effective Hamiltonian $H^{(1)}(\\boldsymbol{k},\\boldsymbol{\\varepsilon})$ includes only terms linear in $\\boldsymbol{\\varepsilon}$:\n  1) Velocity renormalization with isotropic and anisotropic contributions: $\\hbar v_x^{(1)}=\\hbar v_0\\left(1+\\alpha_1 t+\\alpha_a d\\right)$, $\\hbar v_y^{(1)}=\\hbar v_0\\left(1+\\alpha_1 t-\\alpha_a d\\right)$.\n  2) A pseudogauge-like shift entering as $G_x=\\gamma_g\\,g_x$, $G_y=\\gamma_g\\,g_y$, coupled via $\\sigma_x G_x+\\sigma_y G_y$.\n  3) A mass term $m^{(1)}=\\beta_1 t$ coupled via $\\sigma_z m^{(1)}$.\n  4) A scalar deformation potential $U^{(1)}=\\delta_1 t$ coupled via the identity matrix $\\sigma_0$.\n  5) A tilt term linear in $\\boldsymbol{k}$ via the identity: $T^{(1)}(\\boldsymbol{k})=\\tau_1\\,(g_x k_x+g_y k_y)$.\n  The resulting Hamiltonian is\n  $$H^{(1)}=\\sigma_0\\,U^{(1)}+\\sigma_0\\,T^{(1)}+\\sigma_x\\left(\\hbar v_x^{(1)}k_x+G_x\\right)+\\sigma_y\\left(\\hbar v_y^{(1)}k_y+G_y\\right)+\\sigma_z m^{(1)}.$$\n- A second-order-in-strain effective Hamiltonian $H^{(2)}(\\boldsymbol{k},\\boldsymbol{\\varepsilon})$ augments $H^{(1)}$ by including quadratic-in-strain corrections:\n  1) Velocity renormalization with quadratic isotropic correction: $\\hbar v_x^{(2)}=\\hbar v_0\\left(1+\\alpha_1 t+\\alpha_2 n+\\alpha_a d\\right)$, $\\hbar v_y^{(2)}=\\hbar v_0\\left(1+\\alpha_1 t+\\alpha_2 n-\\alpha_a d\\right)$.\n  2) Mass term $m^{(2)}=\\beta_1 t+\\beta_2 t^2$.\n  3) Scalar deformation potential $U^{(2)}=\\delta_1 t+\\delta_2 t^2$.\n  4) Keep $\\gamma_g$ and $\\tau_1$ as in first order (no new quadratic pseudogauge term).\n  The second-order Hamiltonian is\n  $$H^{(2)}=\\sigma_0\\,U^{(2)}+\\sigma_0\\,T^{(1)}+\\sigma_x\\left(\\hbar v_x^{(2)}k_x+G_x\\right)+\\sigma_y\\left(\\hbar v_y^{(2)}k_y+G_y\\right)+\\sigma_z m^{(2)}.$$\n\nSurrogate of first-principles strained conduction band:\n- To emulate the nonlinear behavior found in first-principles calculations, use an augmented model that includes a third-order-in-strain velocity correction, a quadratic-in-strain tilt enhancement, and a weak cubic-in-$\\boldsymbol{k}$ warping contribution to the conduction band energy. Define\n  $$\\hbar v_x^{\\mathrm{ref}}=\\hbar v_0\\left(1+\\alpha_1 t+\\alpha_2 n+\\alpha_3 t^3+\\alpha_a d\\right),\\quad \\hbar v_y^{\\mathrm{ref}}=\\hbar v_0\\left(1+\\alpha_1 t+\\alpha_2 n+\\alpha_3 t^3-\\alpha_a d\\right),$$\n  $$m^{\\mathrm{ref}}=\\beta_1 t+\\beta_2 t^2+\\beta_3 t\\,n,\\quad U^{\\mathrm{ref}}=\\delta_1 t+\\delta_2 t^2,$$\n  $$T^{\\mathrm{ref}}(\\boldsymbol{k})=(\\tau_1+\\tau_2 n)\\,(g_x k_x+g_y k_y),\\quad G_x=\\gamma_g g_x,\\quad G_y=\\gamma_g g_y.$$\n  Construct\n  $$H^{\\mathrm{ref}}=\\sigma_0\\,U^{\\mathrm{ref}}+\\sigma_0\\,T^{\\mathrm{ref}}+\\sigma_x\\left(\\hbar v_x^{\\mathrm{ref}}k_x+G_x\\right)+\\sigma_y\\left(\\hbar v_y^{\\mathrm{ref}}k_y+G_y\\right)+\\sigma_z m^{\\mathrm{ref}}.$$\n  Let the conduction band energy be the larger eigenvalue $E_+^{\\mathrm{ref}}(\\boldsymbol{k},\\boldsymbol{\\varepsilon})$ of $H^{\\mathrm{ref}}$, augmented by a warping shift\n  $$\\Delta E_{\\mathrm{warp}}=w\\,n\\,(k_x^3-3k_x k_y^2),$$\n  so the final surrogate conduction energy is $E_+^{\\mathrm{ref}}+\\Delta E_{\\mathrm{warp}}$.\n\nNumerical constants and units:\n- Use $\\hbar v_0=6.5$ electronvolt–angstrom ($\\mathrm{eV\\cdot \\mathring{A}}$), so that $\\hbar v_0 k$ is in electronvolts when $k$ is in inverse angstrom ($\\mathrm{\\mathring{A}^{-1}}$). All energies must be computed and reported in electronvolts. Wavevectors must be in inverse angstrom.\n- Coupling constants: $\\alpha_1=1.0$, $\\alpha_2=100.0$, $\\alpha_3=800.0$, $\\alpha_a=3.0$, $\\gamma_g=0.15$ electronvolt, $\\beta_1=0.25$ electronvolt, $\\beta_2=4.0$ electronvolt, $\\beta_3=8.0$ electronvolt, $\\delta_1=0.05$ electronvolt, $\\delta_2=1.0$ electronvolt, $\\tau_1=1.5$ electronvolt–angstrom, $\\tau_2=4.0$ electronvolt–angstrom, $w=1.0$ electronvolt–angstrom$^3$.\n- Sampling of $\\boldsymbol{k}$: restrict to a one-dimensional cut $k_y=0$ and sample $k_x$ uniformly in $[-k_{\\max},k_{\\max}]$ with $k_{\\max}=0.1\\,\\mathrm{\\mathring{A}^{-1}}$. Use $N=101$ equally spaced points.\n\nAssessment criterion:\n- For a given $\\boldsymbol{\\varepsilon}$, define the maximum absolute deviation between the first-order effective conduction band $E_+^{(1)}$ and the surrogate $E_+^{\\mathrm{ref}}$ over the sampled $\\boldsymbol{k}$ as $\\Delta_1=\\max_{\\boldsymbol{k}}|E_+^{(1)}-E_+^{\\mathrm{ref}}|$, and similarly the second-order deviation $\\Delta_2=\\max_{\\boldsymbol{k}}|E_+^{(2)}-E_+^{\\mathrm{ref}}|$.\n- With a tolerance $\\Theta=0.01$ electronvolt (that is $10$ millielectronvolt), classify the regime for each test case by the integer\n  $$C=\\begin{cases}\n  0, & \\Delta_1\\le \\Theta\\quad \\text{(first-order sufficient)},\\\\\n  1, & \\Delta_1>\\Theta\\ \\text{and}\\ \\Delta_2\\le \\Theta\\quad \\text{(second-order essential and sufficient)},\\\\\n  2, & \\Delta_2>\\Theta\\quad \\text{(even second-order insufficient)}.\n  \\end{cases}$$\n\nTest suite:\n- Four strain tensors, each specified as a list-of-lists in the order $\\begin{pmatrix}\\varepsilon_{xx}&\\varepsilon_{xy}\\\\\\varepsilon_{xy}&\\varepsilon_{yy}\\end{pmatrix}$, with dimensionless strain components:\n  1) Small hydrostatic strain: $\\boldsymbol{\\varepsilon}_\\mathrm{H}=\\begin{pmatrix}0.002&0.0\\\\0.0&0.002\\end{pmatrix}$.\n  2) Shear-dominant strain with zero trace: $\\boldsymbol{\\varepsilon}_\\mathrm{S}=\\begin{pmatrix}0.01&0.005\\\\0.005&-0.01\\end{pmatrix}$.\n  3) Larger biaxial strain: $\\boldsymbol{\\varepsilon}_\\mathrm{B}=\\begin{pmatrix}0.02&0.0\\\\0.0&0.02\\end{pmatrix}$.\n  4) Zero strain boundary case: $\\boldsymbol{\\varepsilon}_\\mathrm{Z}=\\begin{pmatrix}0.0&0.0\\\\0.0&0.0\\end{pmatrix}$.\n\nRequired output:\n- Your program must compute $C$ for each of the four test cases in the specified order and produce a single line of output containing the results as a comma-separated list enclosed in square brackets (for example, \"[0,1,2,0]\"). The outputs are integers with no additional text. Energies and tolerances must be handled in electronvolts, wavevectors in inverse angstrom.", "solution": "The core of the problem revolves around calculating the eigenvalues of a generic $2 \\times 2$ matrix Hamiltonian. Any such Hamiltonian can be expressed in the basis of the identity matrix $\\sigma_0$ and the three Pauli matrices $\\boldsymbol{\\sigma} = (\\sigma_x, \\sigma_y, \\sigma_z)$ as:\n$$H = h_0\\sigma_0 + h_x\\sigma_x + h_y\\sigma_y + h_z\\sigma_z = \\begin{pmatrix} h_0 + h_z & h_x - ih_y \\\\ h_x + ih_y & h_0 - h_z \\end{pmatrix}$$\nThe eigenvalues of this Hamiltonian are given by $E_\\pm(\\boldsymbol{k}, \\boldsymbol{\\varepsilon}) = h_0 \\pm \\sqrt{h_x^2 + h_y^2 + h_z^2}$. The problem concerns the conduction band, which corresponds to the larger eigenvalue, $E_+ = h_0 + \\sqrt{h_x^2 + h_y^2 + h_z^2}$.\n\nThe solution proceeds by implementing a computational procedure that, for each given strain tensor $\\boldsymbol{\\varepsilon}$, executes the following steps:\n\n1.  **Calculate Strain-Derived Invariants**: From the components of the given strain tensor $\\boldsymbol{\\varepsilon}=\\begin{pmatrix}\\varepsilon_{xx} & \\varepsilon_{xy} \\\\ \\varepsilon_{xy} & \\varepsilon_{yy}\\end{pmatrix}$, we first compute the necessary scalar and vector quantities that appear in the Hamiltonians. These are the trace $t=\\varepsilon_{xx}+\\varepsilon_{yy}$, the deviatoric component $d=\\varepsilon_{xx}-\\varepsilon_{yy}$, the vector $\\boldsymbol{g}=(d, -2\\varepsilon_{xy})$ with components $g_x=d$ and $g_y=-2\\varepsilon_{xy}$, and the squared norm $n=\\varepsilon_{xx}^2+\\varepsilon_{yy}^2+2\\varepsilon_{xy}^2$. These quantities are invariant under the symmetries of the crystal lattice and form the basis for constructing the perturbation terms.\n\n2.  **Construct Hamiltonian Components**: For each of the three models—the first-order model $H^{(1)}$, the second-order model $H^{(2)}$, and the reference surrogate model $H^{\\text{ref}}$—we construct the coefficients $h_0$, $h_x$, $h_y$, and $h_z$ as functions of the strain invariants and the wavevector $\\boldsymbol{k}$. The problem specifies a one-dimensional sampling path where $k_y=0$ and $k_x$ varies.\n\n    -   **First-Order Model ($H^{(1)}$)**:\n        $h_0 = U^{(1)} + T^{(1)}(\\boldsymbol{k}) = \\delta_1 t + \\tau_1(g_x k_x)$\n        $h_x = \\hbar v_x^{(1)}k_x + G_x = \\hbar v_0(1+\\alpha_1 t+\\alpha_a d)k_x + \\gamma_g g_x$\n        $h_y = \\hbar v_y^{(1)}k_y + G_y = \\gamma_g g_y$ (since $k_y=0$)\n        $h_z = m^{(1)} = \\beta_1 t$\n\n    -   **Second-Order Model ($H^{(2)}$)**: This model augments $H^{(1)}$ with quadratic strain terms.\n        $h_0 = U^{(2)} + T^{(1)}(\\boldsymbol{k}) = (\\delta_1 t + \\delta_2 t^2) + \\tau_1(g_x k_x)$\n        $h_x = \\hbar v_x^{(2)}k_x + G_x = \\hbar v_0(1+\\alpha_1 t+\\alpha_2 n+\\alpha_a d)k_x + \\gamma_g g_x$\n        $h_y = \\gamma_g g_y$\n        $h_z = m^{(2)} = \\beta_1 t + \\beta_2 t^2$\n\n    -   **Reference Surrogate Model ($H^{\\text{ref}}$ with warping)**: This model includes yet higher-order terms to emulate a more realistic band structure.\n        $h_0^{\\text{ref}} = U^{\\text{ref}} + T^{\\text{ref}}(\\boldsymbol{k}) = (\\delta_1 t+\\delta_2 t^2) + (\\tau_1+\\tau_2 n)(g_x k_x)$\n        $h_x^{\\text{ref}} = \\hbar v_x^{\\text{ref}}k_x + G_x = \\hbar v_0(1+\\alpha_1 t+\\alpha_2 n+\\alpha_3 t^3+\\alpha_a d)k_x + \\gamma_g g_x$\n        $h_y^{\\text{ref}} = \\gamma_g g_y$\n        $h_z^{\\text{ref}} = m^{\\text{ref}} = \\beta_1 t+\\beta_2 t^2+\\beta_3 t n$\n        The final surrogate energy also includes a warping term: $E_{+, \\text{surrogate}} = E_+^{\\text{ref}} + \\Delta E_{\\text{warp}}$, where $\\Delta E_{\\text{warp}} = w\\,n\\,k_x^3$.\n\n3.  **Compute Energy Bands**: The wavevector $k_x$ is sampled at $N=101$ points in the interval $[-0.1, 0.1]\\, \\mathrm{\\mathring{A}^{-1}}$. For each model, we compute the conduction band energy $E_+$ at each sampled $k_x$ point, resulting in three energy bands: $E_+^{(1)}(k_x)$, $E_+^{(2)}(k_x)$, and $E_{+, \\text{surrogate}}(k_x)$.\n\n4.  **Assess Deviations**: The accuracy of the first- and second-order models is quantified by the maximum absolute deviation from the surrogate model over the sampled $k_x$ points.\n    $\\Delta_1 = \\max_{k_x} |E_+^{(1)}(k_x) - E_{+, \\text{surrogate}}(k_x)|$\n    $\\Delta_2 = \\max_{k_x} |E_+^{(2)}(k_x) - E_{+, \\text{surrogate}}(k_x)|$\n\n5.  **Classify the Regime**: Based on the computed deviations and a given tolerance $\\Theta=0.01\\,\\mathrm{eV}$, we classify the applicability of the models for the given strain according to the integer-valued function $C$:\n    $$C=\\begin{cases}\n    0, & \\Delta_1\\le \\Theta\\quad \\text{(first-order sufficient)},\\\\\n    1, & \\Delta_1>\\Theta\\ \\text{and}\\ \\Delta_2\\le \\Theta\\quad \\text{(second-order essential and sufficient)},\\\\\n    2, & \\Delta_2>\\Theta\\quad \\text{(even second-order insufficient)}.\n    \\end{cases}$$\n\nThis procedure is repeated for each of the four specified strain tensors, and the resulting classification integers are collected to form the final output.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for the given test cases.\n    It orchestrates the calculation of the classification integer C for each strain.\n    \"\"\"\n    \n    # Numerical constants and parameters\n    hbar_v0 = 6.5  # eV*A\n    alpha1 = 1.0\n    alpha2 = 100.0\n    alpha3 = 800.0\n    alpha_a = 3.0\n    gamma_g = 0.15  # eV\n    beta1 = 0.25   # eV\n    beta2 = 4.0    # eV\n    beta3 = 8.0    # eV\n    delta1 = 0.05   # eV\n    delta2 = 1.0    # eV\n    tau1 = 1.5     # eV*A\n    tau2 = 4.0     # eV*A\n    w = 1.0      # eV*A^3\n    \n    k_max = 0.1    # A^-1\n    N = 101\n    Theta = 0.01   # eV\n\n    # Test suite of strain tensors\n    test_cases = [\n        np.array([[0.002, 0.0], [0.0, 0.002]]),  # Small hydrostatic strain\n        np.array([[0.01, 0.005], [0.005, -0.01]]), # Shear-dominant strain\n        np.array([[0.02, 0.0], [0.0, 0.02]]),   # Larger biaxial strain\n        np.array([[0.0, 0.0], [0.0, 0.0]])      # Zero strain\n    ]\n\n    results = []\n    \n    # k-space sampling grid\n    k_x = np.linspace(-k_max, k_max, num=N)\n    k_y = 0.0\n\n    for eps_tensor in test_cases:\n        # 1. Calculate strain-derived quantities\n        exx = eps_tensor[0, 0]\n        exy = eps_tensor[0, 1]\n        eyy = eps_tensor[1, 1]\n\n        t = exx + eyy\n        d = exx - eyy\n        gx = d\n        gy = -2 * exy\n        n = exx**2 + eyy**2 + 2 * exy**2\n\n        # 2. Calculate conduction band energies for each model\n        \n        # Model 1: First-order in strain\n        vx1 = hbar_v0 * (1.0 + alpha1 * t + alpha_a * d)\n        Gx = gamma_g * gx\n        Gy = gamma_g * gy\n        m1 = beta1 * t\n        U1 = delta1 * t\n        T1_k = tau1 * (gx * k_x + gy * k_y)\n        \n        h0_1 = U1 + T1_k\n        hx_1 = vx1 * k_x + Gx\n        hy_1 = np.full_like(k_x, Gy)\n        hz_1 = np.full_like(k_x, m1)\n        E_plus_1 = h0_1 + np.sqrt(hx_1**2 + hy_1**2 + hz_1**2)\n\n        # Model 2: Second-order in strain\n        vx2 = hbar_v0 * (1.0 + alpha1 * t + alpha2 * n + alpha_a * d)\n        m2 = beta1 * t + beta2 * t**2\n        U2 = delta1 * t + delta2 * t**2\n        \n        h0_2 = U2 + T1_k  # NOTE: uses T1, not a higher-order T\n        hx_2 = vx2 * k_x + Gx\n        hy_2 = np.full_like(k_x, Gy)\n        hz_2 = np.full_like(k_x, m2)\n        E_plus_2 = h0_2 + np.sqrt(hx_2**2 + hy_2**2 + hz_2**2)\n\n        # Reference Surrogate Model\n        vx_ref = hbar_v0 * (1.0 + alpha1 * t + alpha2 * n + alpha3 * t**3 + alpha_a * d)\n        m_ref = beta1 * t + beta2 * t**2 + beta3 * t * n\n        U_ref = delta1 * t + delta2 * t**2 # Same as U2\n        T_ref_k = (tau1 + tau2 * n) * (gx * k_x + gy * k_y)\n\n        h0_ref = U_ref + T_ref_k\n        hx_ref = vx_ref * k_x + Gx\n        hy_ref = np.full_like(k_x, Gy)\n        hz_ref = np.full_like(k_x, m_ref)\n        \n        E_plus_ref_no_warp = h0_ref + np.sqrt(hx_ref**2 + hy_ref**2 + hz_ref**2)\n        delta_E_warp = w * n * (k_x**3 - 3 * k_x * k_y**2)\n        E_plus_surrogate = E_plus_ref_no_warp + delta_E_warp\n        \n        # 3. Assess deviations\n        delta1_val = np.max(np.abs(E_plus_1 - E_plus_surrogate))\n        delta2_val = np.max(np.abs(E_plus_2 - E_plus_surrogate))\n        \n        # 4. Classify the regime\n        if delta1_val <= Theta:\n            C = 0\n        elif delta2_val <= Theta:\n            C = 1\n        else:\n            C = 2\n        \n        results.append(C)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3474565"}]}