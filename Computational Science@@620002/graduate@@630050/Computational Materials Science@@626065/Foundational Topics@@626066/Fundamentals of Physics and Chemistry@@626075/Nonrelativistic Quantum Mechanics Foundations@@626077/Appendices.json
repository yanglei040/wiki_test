{"hands_on_practices": [{"introduction": "The variational principle is a cornerstone of quantum mechanics, providing a powerful method for approximating the ground-state energy of a system. It states that the expectation value of the energy for any trial wavefunction is always greater than or equal to the true ground-state energy. This principle's validity, however, critically depends on the Hamiltonian operator being Hermitian. This exercise [@problem_id:3469751] provides a direct numerical test of the variational principle, exploring the consequences of using non-Hermitian projections—a situation that can arise in advanced computational methods—and demonstrates how to diagnose the resulting unphysical energy estimates.", "problem": "Consider a finite-dimensional approximation to a nonrelativistic quantum mechanical system relevant to computational materials science, where the Hamiltonian matrix acts on a real vector space representing a truncated basis. Let $H\\in\\mathbb{R}^{2\\times 2}$ be a symmetric (Hermitian, self-adjoint) Hamiltonian with eigenvalues representing energy levels. The foundational variational principle states that for any normalized trial state $\\lvert \\psi \\rangle$ and Hermitian $H$, the Rayleigh quotient $E_{\\text{var}}=\\frac{\\langle \\psi \\rvert H \\lvert \\psi \\rangle}{\\langle \\psi \\rvert \\psi \\rangle}$ satisfies $E_{\\text{var}}\\ge E_0$, where $E_0$ is the ground-state energy of $H$. However, non-Hermitian truncations (for example, using unequal left and right trial vectors forming an incomplete biorthogonal set) can bias energy estimates and cause violations of the inequality. A diagnostic remedy involves Hermitizing the operator via the Effective Hamiltonian (H_eff), defined by $H_{\\text{eff}}=\\frac{1}{2}(H+H^\\dagger)$, and evaluating a canonical Rayleigh quotient with a consistent inner product.\n\nStarting from the fundamental definition of the Rayleigh quotient and the requirement of Hermiticity for the variational bound, implement a verification that detects violations caused by non-Hermitian truncations. Use the following purely mathematical setup:\n- Let $H=\\begin{pmatrix}0.5 & 0\\\\ 0 & 1.5\\end{pmatrix}$ be the Hamiltonian. Its ground-state energy is $E_0=0.5$ in dimensionless units.\n- For a right trial vector $\\lvert r \\rangle$ and a left trial vector $\\langle l \\rvert$ (not necessarily equal), define the biorthogonal Rayleigh quotient\n$$E_{\\text{bi}}=\\frac{\\langle l \\rvert H \\lvert r \\rangle}{\\langle l \\rvert r \\rangle},$$\nand the canonical (Hermitian) Rayleigh quotient using the Hermitized operator\n$$E_{\\text{eff}}=\\frac{\\langle r \\rvert H_{\\text{eff}} \\lvert r \\rangle}{\\langle r \\rvert r \\rangle},\\quad H_{\\text{eff}}=\\frac{1}{2}(H+H^\\dagger).$$\nFor real symmetric $H$, one has $H_{\\text{eff}}=H$.\n\nYour program must compute $E_{\\text{bi}}$ and $E_{\\text{eff}}$ for each test case below, compare each to $E_0$, and report violations of the inequality $E_{\\text{var}}\\ge E_0$ using a numerical tolerance $\\tau=10^{-9}$. A violation occurs if the computed energy is strictly less than $E_0-\\tau$.\n- Test Suite (dimensionless units):\n    1. Case A (Hermitian truncation \"happy path\"): $\\lvert r \\rangle=\\begin{pmatrix}0\\\\1\\end{pmatrix}$ and $\\langle l \\rvert=\\begin{pmatrix}0&1\\end{pmatrix}$.\n    2. Case B (non-Hermitian truncation, moderate obliqueness): $\\lvert r \\rangle=\\begin{pmatrix}1\\\\0.6\\end{pmatrix}$ and $\\langle l \\rvert=\\begin{pmatrix}1&-0.6\\end{pmatrix}$.\n    3. Case C (non-Hermitian truncation, severe obliqueness near singular overlap): $\\lvert r \\rangle=\\begin{pmatrix}1\\\\0.95\\end{pmatrix}$ and $\\langle l \\rvert=\\begin{pmatrix}1&-0.95\\end{pmatrix}$.\n\nFor each case, compute and report:\n- $E_{\\text{bi}}$ rounded to six decimal places,\n- a boolean indicating whether $E_{\\text{bi}}<E_0-\\tau$,\n- $E_{\\text{eff}}$ rounded to six decimal places,\n- a boolean indicating whether $E_{\\text{eff}}<E_0-\\tau$.\n\nYour program should produce a single line of output containing the results aggregated in a comma-separated list enclosed in square brackets, in the following order:\n$$[E_0,\\; E_{\\text{bi}}^{\\text{A}},\\; \\text{viol}_{\\text{bi}}^{\\text{A}},\\; E_{\\text{eff}}^{\\text{A}},\\; \\text{viol}_{\\text{eff}}^{\\text{A}},\\; E_{\\text{bi}}^{\\text{B}},\\; \\text{viol}_{\\text{bi}}^{\\text{B}},\\; E_{\\text{eff}}^{\\text{B}},\\; \\text{viol}_{\\text{eff}}^{\\text{B}},\\; E_{\\text{bi}}^{\\text{C}},\\; \\text{viol}_{\\text{bi}}^{\\text{C}},\\; E_{\\text{eff}}^{\\text{C}},\\; \\text{viol}_{\\text{eff}}^{\\text{C}}].$$\nAll energies must be expressed in dimensionless units and rounded to six decimal places. The booleans must be literal values. This test suite covers a Hermitian \"happy path,\" a moderate non-Hermitian mismatch, and a severe oblique mismatch approaching a near-singular overlap, which together probe the sensitivity of the variational inequality to truncation-induced non-Hermiticity and the diagnostic role of Hermitization.", "solution": "The problem requires an analysis of the variational principle in quantum mechanics, specifically its behavior under Hermitian and non-Hermitian projections within a finite-dimensional vector space. The core of the problem is to compute two forms of the Rayleigh quotient for a given Hamiltonian and different trial vectors, and to verify whether the variational inequality is satisfied.\n\nThe foundational variational principle states that for any normalized trial state vector $\\lvert \\psi \\rangle$ and a Hermitian Hamiltonian operator $H$, the expectation value of the energy, given by the Rayleigh quotient $E_{\\text{var}}$, is an upper bound to the true ground-state energy $E_0$. Mathematically, this is expressed as:\n$$E_{\\text{var}} = \\frac{\\langle \\psi \\rvert H \\lvert \\psi \\rangle}{\\langle \\psi \\rvert \\psi \\rangle} \\ge E_0$$\nThis principle is fundamental to many approximation methods in quantum chemistry and materials science. Its validity rests critically on the Hermiticity of the operator $H$ (i.e., $H = H^\\dagger$, where $H^\\dagger$ is the conjugate transpose of $H$).\n\nThe problem introduces a situation where this condition might be violated through the use of non-Hermitian projections. This is formalized by defining a \"biorthogonal\" Rayleigh quotient, $E_{\\text{bi}}$, which uses distinct left $\\langle l \\rvert$ and right $\\lvert r \\rangle$ trial vectors:\n$$E_{\\text{bi}} = \\frac{\\langle l \\rvert H \\lvert r \\rangle}{\\langle l \\rvert r \\rangle}$$\nWhen $\\langle l \\rvert$ is not the conjugate transpose of $\\lvert r \\rangle$, the quantity $E_{\\text{bi}}$ is not a true expectation value and is not guaranteed to be bounded from below by $E_0$. It can yield energy estimates below the ground state, which is physically unrealistic.\n\nTo remedy this, a \"Hermitized\" effective Hamiltonian, $H_{\\text{eff}}$, is defined as $H_{\\text{eff}} = \\frac{1}{2}(H + H^\\dagger)$. A canonical Rayleigh quotient is then constructed using this guaranteed-Hermitian operator and a single trial vector $\\lvert r \\rangle$:\n$$E_{\\text{eff}} = \\frac{\\langle r \\rvert H_{\\text{eff}} \\lvert r \\rangle}{\\langle r \\rvert r \\rangle}$$\nBy construction, $H_{\\text{eff}}$ is Hermitian, so the variational principle applies, and we must have $E_{\\text{eff}} \\ge E_{0,\\text{eff}}$, where $E_{0,\\text{eff}}$ is the lowest eigenvalue of $H_{\\text{eff}}$.\n\nIn this specific problem, the Hamiltonian is given as a real, symmetric $2 \\times 2$ matrix:\n$$H = \\begin{pmatrix} 0.5 & 0 \\\\ 0 & 1.5 \\end{pmatrix}$$\nFor a real matrix, the conjugate transpose $H^\\dagger$ is simply its transpose $H^T$. Since $H$ is symmetric, $H^T = H$. Therefore, the effective Hamiltonian simplifies to:\n$$H_{\\text{eff}} = \\frac{1}{2}(H + H^T) = \\frac{1}{2}(H + H) = H$$\nThis implies that the ground-state energy of $H_{\\text{eff}}$ is the same as that of $H$, i.e., $E_{0,\\text{eff}} = E_0 = 0.5$. Consequently, the canonical Rayleigh quotient $E_{\\text{eff}}$ is expected to satisfy the standard variational inequality, $E_{\\text{eff}} \\ge E_0$.\n\nThe task is to compute $E_{\\text{bi}}$ and $E_{\\text{eff}}$ for three distinct cases defined by different pairs of $\\langle l \\rvert$ and $\\lvert r \\rangle$. A violation of the variational principle is flagged if a computed energy is strictly less than $E_0 - \\tau$, where $E_0=0.5$ and the numerical tolerance $\\tau=10^{-9}$.\n\nThe computational steps for each case $(\\langle l \\rvert, \\lvert r \\rangle)$ are as follows:\n1.  Compute the biorthogonal energy $E_{\\text{bi}}$:\n    -   Calculate the numerator: $N_{\\text{bi}} = \\langle l \\rvert H \\lvert r \\rangle$.\n    -   Calculate the denominator: $D_{\\text{bi}} = \\langle l \\rvert r \\rangle$. The denominator must be non-zero.\n    -   Compute the quotient: $E_{\\text{bi}} = N_{\\text{bi}} / D_{\\text{bi}}$.\n\n2.  Check for violation by $E_{\\text{bi}}$:\n    -   Evaluate the boolean condition $\\text{viol}_{\\text{bi}} = (E_{\\text{bi}} < E_0 - \\tau)$.\n\n3.  Compute the effective energy $E_{\\text{eff}}$:\n    -   Calculate the numerator: $N_{\\text{eff}} = \\langle r \\rvert H_{\\text{eff}} \\lvert r \\rangle = \\langle r \\rvert H \\lvert r \\rangle$.\n    -   Calculate the denominator: $D_{\\text{eff}} = \\langle r \\rvert r \\rangle$.\n    -   Compute the quotient: $E_{\\text{eff}} = N_{\\text{eff}} / D_{\\text{eff}}$.\n\n4.  Check for violation by $E_{\\text{eff}}$:\n    -   Evaluate the boolean condition $\\text{viol}_{\\text{eff}} = (E_{\\text{eff}} < E_0 - \\tau)$.\n\nThese calculations will be performed for each of the three test cases specified, and the results will be aggregated and formatted as required.\n- Case A: $\\lvert r \\rangle = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}$, $\\langle l \\rvert = \\begin{pmatrix} 0 & 1 \\end{pmatrix}$. Here $\\langle l \\rvert$ is the transpose of $\\lvert r \\rangle$, representing a standard Hermitian projection.\n- Case B: $\\lvert r \\rangle = \\begin{pmatrix} 1 \\\\ 0.6 \\end{pmatrix}$, $\\langle l \\rvert = \\begin{pmatrix} 1 & -0.6 \\end{pmatrix}$. This is a non-Hermitian projection with moderate \"obliqueness\" (non-orthogonality) between the vector corresponding to $\\langle l \\rvert$ and the vector $\\lvert r \\rangle$.\n- Case C: $\\lvert r \\rangle = \\begin{pmatrix} 1 \\\\ 0.95 \\end{pmatrix}$, $\\langle l \\rvert = \\begin{pmatrix} 1 & -0.95 \\end{pmatrix}$. This case features a severe non-Hermitian projection where the overlap $\\langle l \\rvert r \\rangle$ is close to zero, amplifying the pathological behavior of $E_{\\text{bi}}$.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes biorthogonal and effective Rayleigh quotients to test the\n    variational principle for a 2x2 quantum system.\n    \"\"\"\n    # Define constants and the Hamiltonian matrix\n    H = np.array([[0.5, 0.0], [0.0, 1.5]])\n    E0 = 0.5\n    tau = 1e-9\n\n    # The problem specifies a real symmetric H, so H_eff = 1/2*(H + H.T) = H.\n    # We will use H for both calculations.\n    H_eff = H\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple (name, l_vec_T, r_vec).\n    # l_vec_T is a row vector (1x2), r_vec is a column vector (2x1).\n    test_cases = [\n        # Case A: Hermitian truncation \"happy path\"\n        ('A', np.array([[0.0, 1.0]]), np.array([[0.0], [1.0]])),\n        # Case B: Non-Hermitian truncation, moderate obliqueness\n        ('B', np.array([[1.0, -0.6]]), np.array([[1.0], [0.6]])),\n        # Case C: Non-Hermitian truncation, severe obliqueness\n        ('C', np.array([[1.0, -0.95]]), np.array([[1.0], [0.95]])),\n    ]\n\n    all_results = [f\"{E0:.6f}\"]\n\n    for name, l_vec_T, r_vec in test_cases:\n        # --- Biorthogonal Calculation ---\n        # Numerator: <l|H|r>\n        num_bi = (l_vec_T @ H @ r_vec).item()\n        # Denominator: <l|r>\n        den_bi = (l_vec_T @ r_vec).item()\n        \n        if abs(den_bi) < 1e-12:\n            # Handle division by zero, though not expected for these test cases\n            E_bi = np.inf\n        else:\n            E_bi = num_bi / den_bi\n        \n        # Check for violation\n        viol_bi = E_bi < E0 - tau\n        \n        # --- Effective (Canonical) Calculation ---\n        # Numerator: <r|H_eff|r>\n        # Note: r_vec is (2,1), so r_vec.T is (1,2)\n        num_eff = (r_vec.T @ H_eff @ r_vec).item()\n        # Denominator: <r|r>\n        den_eff = (r_vec.T @ r_vec).item()\n\n        if abs(den_eff) < 1e-12:\n            E_eff = np.inf\n        else:\n            E_eff = num_eff / den_eff\n            \n        # Check for violation\n        viol_eff = E_eff < E0 - tau\n        \n        # Append results for this case to the main list\n        all_results.append(f\"{E_bi:.6f}\")\n        all_results.append(str(viol_bi))\n        all_results.append(f\"{E_eff:.6f}\")\n        all_results.append(str(viol_eff))\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(all_results)}]\")\n\nsolve()\n```", "id": "3469751"}, {"introduction": "Moving from static properties to quantum dynamics, the adiabatic theorem describes how a quantum system evolves when its governing Hamiltonian changes slowly over time. This principle is fundamental to understanding a vast range of phenomena, from chemical reactions to the operation of quantum computers. In this practice [@problem_id:3469688], you will numerically solve the time-dependent Schrödinger equation for the Landau-Zener model, a canonical system featuring an \"avoided crossing.\" By comparing your simulation results to the exact analytical formula, you will gain hands-on experience with the concepts of adiabatic and diabatic evolution and the conditions that distinguish them.", "problem": "You are asked to design and implement a numerical experiment that tests the adiabatic theorem from first principles in a minimal two-level avoided-crossing model that is widely used in computational materials science. The fundamental starting point is the Time-Dependent Schrödinger Equation (TDSE), written in reduced units where the reduced Planck constant is set to $1$, as $i\\,\\partial_t|\\psi(t)\\rangle=\\hat{H}(t)|\\psi(t)\\rangle$. Consider the following parameterized two-level Hamiltonian that produces a single avoided crossing:\n$$\n\\hat{H}(t) = v\\,t\\,\\sigma_z + \\Delta\\,\\sigma_x,\n$$\nwhere $v&gt;0$ is a constant sweep rate, $\\Delta&gt;0$ is a constant coupling that sets the minimum energy gap at the avoided crossing, and $\\sigma_x$ and $\\sigma_z$ are the Pauli matrices. This Hamiltonian is motivated by linear parameter sweeps in materials Hamiltonians near an avoided crossing and serves as a canonical model to test adiabatic following and diabatic transitions. Your task is to numerically propagate the TDSE from $t=-T$ to $t=+T$ with $T=L\\,\\Delta/v$, where $L$ is a dimensionless scale factor ensuring that the evolution begins and ends well outside the coupling-dominated region. The initial state at $t=-T$ is the instantaneous ground adiabatic eigenstate of $\\hat{H}(-T)$, and the observable of interest is the final probability to be in the instantaneous excited adiabatic eigenstate of $\\hat{H}(+T)$ at $t=+T$. This quantity is the diabatic transition probability predicted in closed form for this model by the Landau–Zener theory (Landau–Zener (LZ)), which you should compute for comparison using the known closed-form for this specific Hamiltonian. You must calibrate the maximum stable time step $\\delta t$ for a second-order midpoint piecewise-constant propagator that approximates the time-ordered exponential by composing short-time unitary propagators $\\exp\\!\\left(-i\\,\\hat{H}(t+\\delta t/2)\\,\\delta t\\right)$.\n\nYour program must:\n- Implement a unitary short-time propagator based on the midpoint Hamiltonian, ensuring numerical unitarity at each step.\n- Use $T=L\\,\\Delta/v$ and a uniform time grid from $-T$ to $+T$ with a candidate time step $\\delta t$.\n- Initialize $|\\psi(-T)\\rangle$ as the instantaneous ground adiabatic eigenstate of $\\hat{H}(-T)$ and compute the final state $|\\psi(+T)\\rangle$ by successive application of the midpoint propagators.\n- Compute the final diabatic transition probability $P_{\\text{num}}$ as the population in the instantaneous excited adiabatic eigenstate of $\\hat{H}(+T)$.\n- Compute the corresponding closed-form $P_{\\text{LZ}}$ for this specific Hamiltonian and compare it to $P_{\\text{num}}$.\n- For each test case, determine the largest candidate time step $\\delta t$ in a provided discrete set that satisfies the following accuracy criterion when comparing $P_{\\text{num}}$ to $P_{\\text{LZ}}$:\n  - If $P_{\\text{LZ}} &lt; 10^{-3}$, enforce an absolute error bound $\\lvert P_{\\text{num}}-P_{\\text{LZ}}\\rvert \\le 5\\times 10^{-5}$.\n  - Otherwise, enforce a relative error bound $\\lvert P_{\\text{num}}-P_{\\text{LZ}}\\rvert / P_{\\text{LZ}} \\le 10^{-3}$.\n- If no candidate time step satisfies the criterion, return the value $0.0$ for that test case.\n\nYou must express all probabilities as dimensionless numbers. Angles, if any, are to be treated in radians. All parameters are dimensionless in the chosen reduced-unit system with $\\hbar=1$.\n\nTest suite:\nFor each case, use $L=10$ and the candidate set $\\{\\delta t\\} = [0.5,\\,0.2,\\,0.1,\\,0.05,\\,0.02]$.\n- Case $1$ (strongly adiabatic passage): $\\Delta=0.2$, $v=0.02$. Use $T=L\\,\\Delta/v$ as specified.\n- Case $2$ (intermediate passage): $\\Delta=0.2$, $v=0.1$.\n- Case $3$ (nonadiabatic passage): $\\Delta=0.2$, $v=1.0$.\n- Case $4$ (altered gap-to-sweep ratio): $\\Delta=0.5$, $v=0.2$.\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[r1,r2,r3,r4]\"), where each entry is the selected largest $\\delta t$ (a float) satisfying the accuracy criterion for the corresponding test case in the order given above.", "solution": "The posed problem requires a numerical investigation of the adiabatic theorem within the context of the Landau-Zener model, a canonical two-level system in quantum mechanics. The core of the task is to solve the Time-Dependent Schrödinger Equation (TDSE) for a specific time-varying Hamiltonian and compare the numerical outcome against a known analytical result. This validation process involves several steps, from analyzing the Hamiltonian's properties to implementing a stable numerical propagator.\n\nThe governing equation is the TDSE, which in reduced units where $\\hbar=1$, is given by:\n$$\ni \\frac{\\partial}{\\partial t} |\\psi(t)\\rangle = \\hat{H}(t) |\\psi(t)\\rangle\n$$\n\nThe Hamiltonian for this problem is the Landau-Zener Hamiltonian:\n$$\n\\hat{H}(t) = v t \\sigma_z + \\Delta \\sigma_x\n$$\nwhere $v > 0$ is the sweep rate, $\\Delta > 0$ is the coupling, and $\\sigma_x, \\sigma_z$ are the Pauli matrices. In the standard basis of $\\sigma_z$ eigenstates, $\\{|\\uparrow\\rangle = (1, 0)^T, |\\downarrow\\rangle = (0, 1)^T\\}$, the Hamiltonian is represented by the matrix:\n$$\n\\hat{H}(t) = \\begin{pmatrix} v t & \\Delta \\\\ \\Delta & -v t \\end{pmatrix}\n$$\nThe instantaneous (adiabatic) eigenvalues of this Hamiltonian are found by solving the characteristic equation, yielding:\n$$\nE_{\\pm}(t) = \\pm \\sqrt{(v t)^2 + \\Delta^2}\n$$\nThe corresponding instantaneous eigenvectors, denoted $|\\phi_{\\pm}(t)\\rangle$, form the adiabatic basis. The state $|\\phi_-(t)\\rangle$ corresponds to the lower energy eigenvalue $E_-(t)$ and is the instantaneous ground state. The state $|\\phi_+(t)\\rangle$ corresponds to the higher energy $E_+(t)$ and is the instantaneous excited state. The energy gap between these states, $\\Delta E(t) = E_+(t) - E_-(t) = 2\\sqrt{(v t)^2 + \\Delta^2}$, is minimum at $t=0$, where $\\Delta E(0) = 2\\Delta$.\n\nThe problem is set up to test the adiabatic theorem. The system starts at time $t=-T$ in the instantaneous ground state of $\\hat{H}(-T)$, which is $|\\psi(-T)\\rangle = |\\phi_-(-T)\\rangle$. As $t \\to -\\infty$, the term $v t \\sigma_z$ dominates, with $v t < 0$. The ground state of $\\hat{H}(t)$ asymptotically approaches the $|\\uparrow\\rangle$ state. Conversely, as $t \\to +\\infty$, the term $v t \\sigma_z$ again dominates, but with $v t > 0$, and the ground state of $\\hat{H}(t)$ asymptotically approaches the $|\\downarrow\\rangle$ state.\nIf the evolution is perfectly adiabatic (i.e., infinitely slow, $v \\to 0$), the system remains in the instantaneous ground state: $|\\psi(t)\\rangle$ follows $|\\phi_-(t)\\rangle$ for all $t$. Thus, a system starting in $|\\phi_-(-T)\\rangle$ would end in $|\\phi_-(+T)\\rangle$. A non-adiabatic or diabatic transition is the event where the system transitions to the \"other\" adiabatic state, ending up in $|\\phi_+(+T)\\rangle$. The probability of this transition is what we must calculate.\n\nFor this specific Hamiltonian, the probability of a diabatic transition is given by the Landau-Zener formula, which provides an analytical benchmark, $P_{\\text{LZ}}$:\n$$\nP_{\\text{LZ}} = \\exp\\left(-\\frac{2\\pi \\Delta^2}{v}\\right)\n$$\nThis formula is derived for an evolution from $t=-\\infty$ to $t=+\\infty$. The problem sets the evolution time to be from $t=-T$ to $t=+T$ where $T=L\\Delta/v$ with a large scale factor $L=10$. This choice ensures that the dynamics start and end in the asymptotic regions where the coupling $\\Delta$ is small compared to $|vt|$, making the comparison to the idealized Landau-Zener formula meaningful.\n\nThe numerical solution involves integrating the TDSE. Since $\\hat{H}(t)$ is time-dependent, the evolution operator $\\hat{U}(t_f, t_i)$ is given by a time-ordered exponential. We approximate this operator over a small time step $\\delta t$ using a second-order midpoint rule. The state is evolved from an initial time $t_k$ to $t_{k+1} = t_k + \\delta t$ via:\n$$\n|\\psi(t_{k+1})\\rangle \\approx \\hat{U}_{\\text{mid}} |\\psi(t_k)\\rangle = \\exp\\left(-i \\hat{H}(t_k + \\delta t/2) \\delta t\\right) |\\psi(t_k)\\rangle\n$$\nThe full evolution from $-T$ to $+T$ is obtained by discretizing the time interval into $N$ steps of size $\\delta t = 2T/N$ and successively applying this short-time propagator.\n\nTo implement the propagator $\\hat{U}_{\\text{mid}}$, we need to compute the matrix exponential. For any $2\\times2$ matrix of the form $\\hat{M} = a \\sigma_x + c \\sigma_z$, one can show that $\\hat{M}^2 = (a^2+c^2)I$. For our propagator, the matrix in the exponent is $-i \\hat{H}(t')\\delta t$, where $t' = t_k + \\delta t/2$. Let $E(t') = \\sqrt{(vt')^2+\\Delta^2}$ be the magnitude of the energy at the midpoint. Then $(\\hat{H}(t'))^2 = E(t')^2 I$. Using the Taylor series expansion of the exponential, one finds a closed-form expression:\n$$\n\\exp(-i \\hat{H}(t') \\delta t) = \\cos(E(t') \\delta t) I - i \\frac{\\sin(E(t') \\delta t)}{E(t')} \\hat{H}(t')\n$$\nwhere $I$ is the $2\\times2$ identity matrix. This formula is numerically stable since $\\Delta > 0$ implies $E(t') \\ge \\Delta > 0$, preventing division by zero. It also manifestly produces a unitary propagator, ensuring the norm of the state vector is conserved throughout the simulation, a critical feature for numerical stability.\n\nThe complete algorithm for each test case is as follows:\n1.  Define parameters $\\Delta$ and $v$ for the case, and set $L=10$.\n2.  Calculate the evolution time extent $T = L\\Delta/v$ and the analytical Landau-Zener probability $P_{\\text{LZ}} = \\exp(-2\\pi \\Delta^2/v)$.\n3.  Iterate through the candidate time steps $\\delta t$ from the provided set $\\{0.5, 0.2, 0.1, 0.05, 0.02\\}$, ordered from largest to smallest.\n4.  For a chosen $\\delta t$, set up a uniform time grid from $-T$ to $+T$. Let the number of steps be $N = \\lceil 2T/\\delta t \\rceil$ and the actual time step be $\\delta t_{\\text{eff}} = 2T/N$.\n5.  Determine the initial state $|\\psi(-T)\\rangle$ by numerically finding the ground state eigenvector of $\\hat{H}(-T)$.\n6.  Propagate the state $|\\psi(t)\\rangle$ from $-T$ to $+T$ by applying the midpoint propagator $N$ times.\n7.  At the final time $T$, determine the instantaneous excited state $|\\phi_+(+T)\\rangle$ by finding the corresponding eigenvector of $\\hat{H}(+T)$.\n8.  Calculate the numerical diabatic transition probability $P_{\\text{num}} = |\\langle \\phi_+(+T) | \\psi(+T) \\rangle|^2$.\n9.  Compare $P_{\\text{num}}$ with $P_{\\text{LZ}}$ using the specified error criterion. If $P_{\\text{LZ}} < 10^{-3}$, the absolute error must be $\\le 5\\times 10^{-5}$. Otherwise, the relative error must be $\\le 10^{-3}$.\n10. If the criterion is met, the current $\\delta t$ is the desired result for the case. Record it and proceed to the next case.\n11. If the loop over all candidate $\\delta t$ values completes without meeting the criterion, the result for the case is $0.0$.\n\nThis procedure is implemented in the provided Python code, utilizing `numpy` for efficient linear algebra operations.", "answer": "```python\nimport numpy as np\nfrom numpy.linalg import eigh\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for the given test cases.\n    \"\"\"\n    test_cases = [\n        (0.2, 0.02),  # Case 1 (strongly adiabatic)\n        (0.2, 0.1),   # Case 2 (intermediate)\n        (0.2, 1.0),   # Case 3 (nonadiabatic)\n        (0.5, 0.2),   # Case 4 (altered ratio)\n    ]\n    \n    L = 10.0\n    dt_candidates = [0.5, 0.2, 0.1, 0.05, 0.02]\n\n    results = []\n\n    # Pauli matrices (complex type for calculations)\n    sigma_x = np.array([[0, 1], [1, 0]], dtype=complex)\n    sigma_z = np.array([[1, 0], [0, -1]], dtype=complex)\n    identity = np.identity(2, dtype=complex)\n\n    for Delta, v in test_cases:\n        T = L * Delta / v\n        \n        # Calculate analytical Landau-Zener probability\n        p_lz = np.exp(-2.0 * np.pi * Delta**2 / v)\n\n        best_dt_for_case = 0.0\n        \n        # Iterate through candidate dt values from largest to smallest\n        for dt_candidate in dt_candidates:\n            # Set up a uniform time grid to exactly span [-T, T]\n            num_steps = int(np.ceil(2 * T / dt_candidate))\n            if num_steps == 0: continue\n            \n            actual_dt = 2.0 * T / num_steps\n            times = np.linspace(-T, T, num_steps + 1)\n            \n            # --- Simulation ---\n            \n            # 1. Initial State: Ground state of H(-T)\n            H_initial = v * (-T) * sigma_z + Delta * sigma_x\n            evals_i, evecs_i = eigh(H_initial)\n            psi = evecs_i[:, 0]  # eigh sorts eigenvalues, so 0 is ground state\n\n            # 2. Time Propagation\n            for i in range(num_steps):\n                t_mid = times[i] + actual_dt / 2.0\n                H_mid = v * t_mid * sigma_z + Delta * sigma_x\n                \n                # Energy at midpoint: E = sqrt((v*t)^2 + Delta^2)\n                E_mid = np.sqrt((v * t_mid)**2 + Delta**2)\n                \n                # Propagator U = exp(-i*H_mid*dt) using closed-form expression\n                # U = cos(E*dt)*I - i*sin(E*dt)/E * H\n                cos_term = np.cos(E_mid * actual_dt)\n                sin_term = np.sin(E_mid * actual_dt) / E_mid\n                \n                U = cos_term * identity - 1j * sin_term * H_mid\n                \n                psi = U @ psi\n                \n            # 3. Final Probability Calculation\n            H_final = v * T * sigma_z + Delta * sigma_x\n            evals_f, evecs_f = eigh(H_final)\n            # Excited state corresponds to the higher eigenvalue (index 1)\n            excited_state_final = evecs_f[:, 1]\n            \n            p_num = np.abs(np.vdot(excited_state_final, psi))**2\n\n            # 4. Check Accuracy Criterion\n            passed = False\n            if p_lz < 1e-3:\n                # Absolute error bound for small probabilities\n                if np.abs(p_num - p_lz) <= 5e-5:\n                    passed = True\n            else:\n                # Relative error bound otherwise\n                if p_lz > 0 and np.abs(p_num - p_lz) / p_lz <= 1e-3:\n                    passed = True\n            \n            if passed:\n                best_dt_for_case = dt_candidate\n                break  # Found largest valid dt, move to next case\n                \n        results.append(best_dt_for_case)\n\n    # Format and print the final output\n    print(f\"[{','.join(f'{r:.2f}' for r in results)}]\")\n\nsolve()\n```", "id": "3469688"}, {"introduction": "Density Functional Theory (DFT) is the most widely used electronic structure method in computational materials science, and its theoretical foundation rests on the Hohenberg-Kohn theorems. A key consequence is that the effective Kohn-Sham potential, $v_{\\text{KS}}(\\mathbf{r})$, which generates the true ground-state density of an interacting system, is unique up to an arbitrary constant. This final practice [@problem_id:3469774] allows you to verify this fundamental property directly. By implementing a plane-wave DFT calculation for a simple periodic system, you will demonstrate that shifting the potential by a constant value rigidly shifts the energy eigenvalues while leaving the electron density, a physical observable, invariant.", "problem": "Consider nonrelativistic single-particle Kohn-Sham (KS) theory from Density Functional Theory (DFT) in one spatial dimension with periodic boundary conditions. The foundational base is the time-independent nonrelativistic Schrödinger equation for the KS orbitals, the Born rule for density, and Bloch’s theorem. The Schrödinger operator is the KS Hamiltonian. Let the KS Hamiltonian be written as $$\\hat{H}_{\\text{KS}} = -\\frac{1}{2}\\frac{d^{2}}{dx^{2}} + v_{\\text{KS}}(x),$$ where $x$ is the crystal coordinate in a unit cell of length $a$, energies are in Hartree atomic units, and lengths are in Bohr atomic units. Bloch’s theorem states that eigenfunctions can be labeled by a crystal momentum $k$ in the first Brillouin zone, and expanded in a plane-wave basis. Consider a one-dimensional periodic potential $$v_{\\text{KS}}(x) = V_{0}\\cos(G_{0}x),$$ where $G_{0} = \\frac{2\\pi}{a}$. The plane-wave basis consists of reciprocal lattice vectors $$G \\in \\{-M G_{0}, -(M-1)G_{0}, \\dots, -G_{0}, 0, G_{0}, \\dots, (M-1)G_{0}, M G_{0}\\},$$ where $M$ is a positive integer truncation index. In this basis, the Hamiltonian matrix at a given crystal momentum $k$ is $$H_{G,G'}(k) = \\frac{1}{2}(k+G)^{2}\\delta_{G,G'} + v_{G-G'},$$ where $v_{Q}$ are the Fourier components of $v_{\\text{KS}}(x)$, with $v_{\\pm G_{0}} = \\frac{V_{0}}{2}$ and all other $v_{Q}$ equal to zero. The electron density in the unit cell is built from occupied KS states as $$\\rho(x) = \\sum_{k\\in \\mathcal{K}} w_{k}\\sum_{n \\in \\text{occ}} \\left|\\psi_{n k}(x)\\right|^{2},$$ where $\\mathcal{K}$ is a finite uniform sampling of the Brillouin zone, $w_{k}$ are equal $k$-point weights that sum to $1$, $n$ indexes bands, and $\\psi_{n k}(x)$ are the KS orbitals expanded in the plane-wave basis as $$\\psi_{n k}(x) = \\frac{1}{\\sqrt{a}}\\sum_{G} c_{n k}(G)\\, e^{i(k+G)x},$$ with coefficients $c_{n k}(G)$ obtained from diagonalizing $H(k)$.\n\nYou are tasked to evaluate the uniqueness of $v_{\\text{KS}}(x)$ up to an additive constant under periodic boundary conditions by explicitly adding a uniform shift $\\Delta v$ to the potential, $$v'_{\\text{KS}}(x) = v_{\\text{KS}}(x) + \\Delta v,$$ and confirming the invariance of $\\rho(x)$ while tracking changes in the eigenvalues $\\epsilon_{n k}$. The fundamental laws to use are the nonrelativistic KS Hamiltonian, Bloch’s theorem, and the Born rule for the density. No additional shortcuts are permitted. Occupations are at zero temperature and fixed electron count per unit cell, so the lowest band is fully occupied for each $k$-point.\n\nImplement a program that:\n- Constructs the Hamiltonian matrix $H(k)$ in the plane-wave basis described above for a uniform grid of $k$-points in the first Brillouin zone $\\left[-\\frac{\\pi}{a},\\frac{\\pi}{a}\\right)$.\n- Diagonalizes $H(k)$ to obtain eigenvalues $\\epsilon_{n k}$ and eigenvectors $c_{n k}(G)$.\n- Computes the unit-cell electron density $\\rho(x)$ on a uniform real-space grid using the lowest occupied band for each $k$-point with equal weights $w_{k}$.\n- Repeats the calculation for the shifted potential $v'_{\\text{KS}}(x)$ and computes $\\rho'(x)$, the corresponding density, as well as the shifted eigenvalues $\\epsilon'_{n k}$.\n- Verifies two properties with explicit tolerances: \n  (i) density invariance, quantified by the maximum absolute difference $\\max_{x}|\\rho'(x)-\\rho(x)|$ being less than a user-specified tolerance; \n  (ii) rigid eigenvalue shift, quantified by the maximum absolute deviation $\\max_{n,k}|\\left(\\epsilon'_{n k} - \\epsilon_{n k}\\right) - \\Delta v|$ being less than the same tolerance.\n\nUse Hartree atomic units for energies and Bohr atomic units for lengths; use radians for angles. Your program must output a list of boolean results for each test case, where each element is a two-entry list $[\\text{density\\_invariant}, \\text{eigenvalue\\_shift\\_rigid}]$ corresponding to the two verifications above, with each boolean indicating whether the property holds within the prescribed tolerance.\n\nTest suite:\n- Case A (general nontrivial periodic potential, positive uniform shift): $a = 5.0$, $V_{0} = 0.5$, $M = 2$, number of $k$-points $N_{k} = 5$, number of real-space grid points $N_{x} = 200$, electrons per unit cell $N_{e} = 1$, uniform shift $\\Delta v = 0.3$, tolerance $\\tau = 10^{-10}$.\n- Case B (free electrons, degeneracy present, negative uniform shift): $a = 6.0$, $V_{0} = 0.0$, $M = 3$, number of $k$-points $N_{k} = 7$, number of real-space grid points $N_{x} = 256$, electrons per unit cell $N_{e} = 1$, uniform shift $\\Delta v = -0.25$, tolerance $\\tau = 10^{-10}$.\n- Case C (nontrivial periodic potential, zero uniform shift as a boundary condition): $a = 4.0$, $V_{0} = 0.3$, $M = 1$, number of $k$-points $N_{k} = 9$, number of real-space grid points $N_{x} = 128$, electrons per unit cell $N_{e} = 1$, uniform shift $\\Delta v = 0.0$, tolerance $\\tau = 10^{-10}$.\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each test case contributes a two-element list of booleans as described above. For example, the output should look like $$[[\\text{True},\\text{True}],[\\text{True},\\text{True}],[\\text{True},\\text{True}]].$$", "solution": "The problem statement is assessed as valid. It is scientifically grounded in the principles of nonrelativistic quantum mechanics and Density Functional Theory, is well-posed with all necessary parameters provided, and is objective in its formulation. The task is to perform a numerical verification of a fundamental concept: the invariance of physical observables (like electron density) and the rigid shift of energy eigenvalues under the addition of a constant potential. This is a standard and meaningful exercise in computational physics.\n\nThe solution proceeds by implementing a one-dimensional plane-wave Kohn-Sham calculation. The algorithm is executed for each set of test parameters $\\{a, V_0, M, N_k, N_x, \\Delta v, \\tau\\}$.\n\n1.  **System and Grid Definition**: The physical system is a one-dimensional crystal with lattice constant $a$.\n    - A real-space grid of $N_x$ uniform points is defined within the unit cell, $x_j = j \\frac{a}{N_x}$ for $j \\in \\{0, 1, \\dots, N_x-1\\}$.\n    - The dual space is the reciprocal space, with the fundamental reciprocal lattice vector $G_0 = \\frac{2\\pi}{a}$. The plane-wave basis for expanding the Kohn-Sham orbitals is truncated, including $2M+1$ vectors: $G_m = m G_0$ for $m \\in \\{-M, \\dots, M\\}$.\n    - The first Brillouin zone, spanning $[-\\frac{\\pi}{a}, \\frac{\\pi}{a})$, is sampled using a uniform grid of $N_k$ crystal momentum points ($k$-points): $k_p = -\\frac{\\pi}{a} + p \\frac{2\\pi}{a N_k}$ for $p \\in \\{0, 1, \\dots, N_k-1\\}$.\n\n2.  **Hamiltonian Matrix Construction**: For each $k$-point $k_p$, the Kohn-Sham Hamiltonian $\\hat{H}_{\\text{KS}}$ is represented as a $(2M+1) \\times (2M+1)$ matrix in the specified plane-wave basis. The matrix elements are:\n    $$H_{m,m'}(k_p) = \\frac{1}{2}(k_p + G_m)^2 \\delta_{m,m'} + v_{G_m - G_{m'}}$$\n    where the indices $m, m'$ range from $-M$ to $M$.\n    - The first term represents the kinetic energy and contributes only to the diagonal of the matrix.\n    - The second term, $v_{G_m - G_{m'}}$, represents the Fourier transform components of the periodic potential $v_{\\text{KS}}(x) = V_0 \\cos(G_0 x)$. The Fourier series for this potential is $v_{\\text{KS}}(x) = \\frac{V_0}{2}(e^{iG_0x} + e^{-iG_0x})$. The only non-zero Fourier coefficients $v_Q$ are $v_{G_0} = v_{-G_0} = \\frac{V_0}{2}$.\n    - Consequently, the potential term contributes $\\frac{V_0}{2}$ to the matrix elements where $G_m - G_{m'} = \\pm G_0$, which corresponds to $m-m'=\\pm 1$. This makes the Hamiltonian matrix a real, symmetric, tridiagonal matrix.\n\n3.  **Diagonalization and Orbital Calculation**: The Hamiltonian matrix $H(k_p)$ for each $k_p$ is diagonalized. This is a standard eigenvalue problem for a Hermitian matrix, solved numerically.\n    $$H(k_p) c_{n,k_p} = \\epsilon_{n,k_p} c_{n,k_p}$$\n    The diagonalization yields a set of real eigenvalues $\\epsilon_{n,k_p}$ (band energies) and their corresponding eigenvectors $c_{n,k_p}$. The eigenvectors contain the coefficients for the plane-wave expansion of the Kohn-Sham orbitals $\\psi_{n,k_p}(x)$. We are interested in the lowest energy band, which corresponds to the smallest eigenvalue for each $k_p$, denoted by $n=0$.\n\n4.  **Electron Density Calculation**: The electron density $\\rho(x)$ is constructed according to the Born rule, summing the probability densities of all occupied states. With the lowest band fully occupied, the density at each real-space grid point $x_j$ is:\n    $$\\rho(x_j) = \\sum_{p=0}^{N_k-1} w_{k_p} |\\psi_{0,k_p}(x_j)|^2$$\n    where $w_{k_p} = 1/N_k$ are the uniform weights for the $k$-point sampling. The orbital for the lowest band at each $k_p$ is constructed from its coefficients:\n    $$\\psi_{0,k_p}(x_j) = \\frac{1}{\\sqrt{a}} \\sum_{m=-M}^{M} c_{0,k_p}(G_m) \\, e^{i(k_p+G_m)x_j}$$\n\n5.  **Procedure for Shifted Potential**: The entire calculation is repeated for the shifted potential $v'_{\\text{KS}}(x) = v_{\\text{KS}}(x) + \\Delta v$. The addition of a constant $\\Delta v$ only modifies the $Q=0$ Fourier component of the potential, $v'_0 = v_0 + \\Delta v$. For the given cosine potential, $v_0=0$, so $v'_0=\\Delta v$. The Hamiltonian matrix for the shifted potential becomes:\n    $$H'_{m,m'}(k_p) = H_{m,m'}(k_p) + \\Delta v \\, \\delta_{m,m'}$$\n    This means $H'(k_p) = H(k_p) + \\Delta v I$, where $I$ is the identity matrix. This new matrix is diagonalized to find the new eigenvalues $\\epsilon'_{n,k_p}$ and eigenvectors $c'_{n,k_p}$, from which the new density $\\rho'(x)$ is calculated.\n\n6.  **Numerical Verification**: The final step is to verify the two key properties based on the numerical results.\n    - **Density Invariance**: The maximum absolute difference between the original and shifted densities, $\\max_{j} |\\rho'(x_j) - \\rho(x_j)|$, is computed and compared against the tolerance $\\tau$. The proposition holds if this difference is less than $\\tau$.\n    - **Rigid Eigenvalue Shift**: The deviation from a perfect, rigid shift is quantified by computing the maximum absolute difference $\\max_{n,p} |(\\epsilon'_{n,k_p} - \\epsilon_{n,k_p}) - \\Delta v|$ across all bands and $k$-points. The proposition holds if this difference is less than $\\tau$.\n    \nThe final output for each test case is a list of two booleans, representing the outcome of these two verification tests.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef run_one_case(a, V0, M, Nk, Nx, delta_v, tol):\n    \"\"\"\n    Solves the Kohn-Sham equations for one-dimensional periodic potential\n    for both the original and a uniformly shifted potential, and verifies\n    density invariance and rigid eigenvalue shift.\n\n    Args:\n        a (float): Lattice constant in Bohr.\n        V0 (float): Amplitude of the cosine potential in Hartree.\n        M (int): Truncation index for the plane-wave basis.\n        Nk (int): Number of k-points for Brillouin zone sampling.\n        Nx (int): Number of grid points for real-space density.\n        delta_v (float): Uniform shift applied to the potential in Hartree.\n        tol (float): Tolerance for verification checks.\n\n    Returns:\n        list[bool, bool]: A list containing two booleans for\n                          [density_invariant, eigenvalue_shift_rigid].\n    \"\"\"\n    # 1. Define grids\n    G0 = 2.0 * np.pi / a\n    # Reciprocal space grid (G-vectors)\n    G_vec = np.arange(-M, M + 1) * G0\n    # Crystal momentum grid (k-points)\n    k_vec = -np.pi / a + np.arange(Nk) * (2.0 * np.pi / (a * Nk))\n    # Real-space grid\n    x_vec = np.arange(Nx) * a / Nx\n    \n    # Dimension of the Hamiltonian matrix\n    dim = 2 * M + 1\n    \n    # Initialize arrays for storing results\n    all_eps = np.zeros((Nk, dim))\n    all_eps_prime = np.zeros((Nk, dim))\n    rho = np.zeros(Nx, dtype=float)\n    rho_prime = np.zeros(Nx, dtype=float)\n    \n    # 2. Iterate over all k-points in the Brillouin zone\n    for p, k in enumerate(k_vec):\n        # 3. Construct the Hamiltonian matrix H(k)\n        H = np.zeros((dim, dim), dtype=float)\n        \n        # Kinetic energy term (diagonal)\n        diag_indices = np.arange(dim)\n        H[diag_indices, diag_indices] = 0.5 * (k + G_vec)**2\n        \n        # Potential energy term (off-diagonal)\n        if V0 != 0.0:\n            off_diag_val = V0 / 2.0\n            if dim > 1:\n                # Super-diagonal\n                H[diag_indices[:-1], diag_indices[1:]] = off_diag_val\n                # Sub-diagonal\n                H[diag_indices[1:], diag_indices[:-1]] = off_diag_val\n        \n        # 4. Diagonalize H(k) to get eigenvalues and eigenvectors\n        eps, C = np.linalg.eigh(H)\n        all_eps[p, :] = eps\n        c0k = C[:, 0]  # Eigenvector for the lowest energy band (n=0)\n        \n        # 5. Repeat for the shifted potential v'(x) = v(x) + delta_v\n        # The new Hamiltonian is H'(k) = H(k) + delta_v * I\n        H_prime = H + np.eye(dim) * delta_v\n        eps_prime, C_prime = np.linalg.eigh(H_prime)\n        all_eps_prime[p, :] = eps_prime\n        c0k_prime = C_prime[:, 0]\n        \n        # 6. Compute density contributions from this k-point\n        # Construct matrix of plane-wave phase factors, shape (Nx, dim)\n        phase_factor_matrix = np.exp(1j * np.outer(x_vec, k + G_vec))\n        \n        # Calculate orbitals on the real-space grid via matrix-vector product\n        psi_k = (1.0 / np.sqrt(a)) * (phase_factor_matrix @ c0k)\n        psi_k_prime = (1.0 / np.sqrt(a)) * (phase_factor_matrix @ c0k_prime)\n        \n        # Accumulate density with uniform k-point weight\n        w_k = 1.0 / Nk\n        rho += w_k * np.abs(psi_k)**2\n        rho_prime += w_k * np.abs(psi_k_prime)**2\n        \n    # 7. Verify the two required properties\n    # (i) Density invariance\n    max_rho_diff = np.max(np.abs(rho_prime - rho))\n    density_invariant = max_rho_diff < tol\n    \n    # (ii) Rigid eigenvalue shift\n    max_eps_diff = np.max(np.abs((all_eps_prime - all_eps) - delta_v))\n    eigenvalue_shift_rigid = max_eps_diff < tol\n    \n    return [density_invariant, eigenvalue_shift_rigid]\n\ndef solve():\n    \"\"\"\n    Main function to run the defined test suite and print results.\n    \"\"\"\n    test_cases = [\n        # Case A: general nontrivial periodic potential, positive uniform shift\n        {'a': 5.0, 'V0': 0.5, 'M': 2, 'Nk': 5, 'Nx': 200, 'delta_v': 0.3, 'tol': 1e-10},\n        # Case B: free electrons, degeneracy present, negative uniform shift\n        {'a': 6.0, 'V0': 0.0, 'M': 3, 'Nk': 7, 'Nx': 256, 'delta_v': -0.25, 'tol': 1e-10},\n        # Case C: nontrivial periodic potential, zero uniform shift as a boundary condition\n        {'a': 4.0, 'V0': 0.3, 'M': 1, 'Nk': 9, 'Nx': 128, 'delta_v': 0.0, 'tol': 1e-10},\n    ]\n\n    results = []\n    for case in test_cases:\n        result = run_one_case(case['a'], case['V0'], case['M'], case['Nk'], case['Nx'], case['delta_v'], case['tol'])\n        results.append(result)\n\n    # Final print statement in the exact required format: [[True,True],[True,True],...]\n    print(f\"[{','.join(map(str, results))}]\".replace(\" \", \"\"))\n\nsolve()\n```", "id": "3469774"}]}