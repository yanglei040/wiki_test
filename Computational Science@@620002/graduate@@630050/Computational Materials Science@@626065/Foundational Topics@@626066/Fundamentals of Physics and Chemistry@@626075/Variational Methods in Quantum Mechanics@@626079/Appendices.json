{"hands_on_practices": [{"introduction": "The variational principle is a cornerstone of quantum mechanics, stating that the energy expectation value of any trial wavefunction is an upper bound to the true ground state energy. This exercise [@problem_id:2144210] offers foundational practice with the mechanics of this method, including normalization, calculating the expectation value of the Hamiltonian $\\langle \\hat{H} \\rangle$, and minimization with respect to a variational parameter. By applying these steps to a simple harmonic oscillator with a non-standard triangular trial function, you will gain a deeper intuition for how the flexibility of your \"guess\" impacts the accuracy of the energy estimate.", "problem": "The variational principle in quantum mechanics provides a powerful method for estimating the ground state energy of a system without solving the Schrödinger equation exactly. The principle states that for any normalized trial wavefunction $\\psi$, the expectation value of the Hamiltonian, $\\langle H \\rangle = \\int \\psi^* \\hat{H} \\psi \\, dx$, is always greater than or equal to the true ground state energy $E_0$. By choosing a trial wavefunction with adjustable parameters and minimizing $\\langle H \\rangle$ with respect to these parameters, we can obtain an upper-bound estimate for $E_0$.\n\nConsider a particle of mass $m$ in a one-dimensional simple harmonic oscillator potential, given by $V(x) = \\frac{1}{2}m\\omega^2x^2$, where $\\omega$ is the angular frequency.\n\nWe propose a simple, real-valued triangular trial wavefunction, $\\psi(x)$, defined as:\n$$\n\\psi(x) =\n\\begin{cases}\nN(a - |x|) & \\text{if } |x| \\le a \\\\\n0 & \\text{if } |x| > a\n\\end{cases}\n$$\nHere, $N$ is a normalization constant and $a > 0$ is a variational parameter that characterizes the spatial extent of the wavefunction.\n\nYour task is to use the variational principle to find the best possible estimate for the ground state energy of the simple harmonic oscillator using this triangular trial wavefunction. Express your final answer as an analytic expression in terms of $\\hbar$, $m$, and $\\omega$.", "solution": "We apply the variational principle with the real, even, triangular trial function\n$$\n\\psi(x)=\n\\begin{cases}\nN(a-|x|), & |x|\\le a,\\\\\n0, & |x|>a,\n\\end{cases}\n$$\nwhere $a>0$ is the variational parameter and $N$ is the normalization constant.\n\nNormalization requires\n$$\n\\int_{-\\infty}^{\\infty}|\\psi(x)|^{2}\\,dx=1.\n$$\nSince $\\psi$ is supported on $[-a,a]$ and even,\n$$\n1=2N^{2}\\int_{0}^{a}(a-x)^{2}\\,dx=2N^{2}\\left[\\frac{a^{3}}{3}\\right]=\\frac{2}{3}N^{2}a^{3},\n$$\nso\n$$\nN^{2}=\\frac{3}{2a^{3}}.\n$$\n\nThe Hamiltonian is $\\hat{H}=-\\frac{\\hbar^{2}}{2m}\\frac{d^{2}}{dx^{2}}+\\frac{1}{2}m\\omega^{2}x^{2}$. Because the trial function has a cusp at $x=0$ and is only piecewise differentiable, the appropriate kinetic-energy quadratic form is\n$$\nT[\\psi]=\\frac{\\hbar^{2}}{2m}\\int_{-\\infty}^{\\infty}|\\psi'(x)|^{2}\\,dx.\n$$\nFor $x\\in(0,a)$, $\\psi(x)=N(a-x)$ so $\\psi'(x)=-N$; for $x\\in(-a,0)$, $\\psi(x)=N(a+x)$ so $\\psi'(x)=N$. Therefore,\n$$\n\\int_{-\\infty}^{\\infty}|\\psi'(x)|^{2}\\,dx=\\int_{-a}^{a}N^{2}\\,dx=2aN^{2}.\n$$\nHence\n$$\nT(a)=\\frac{\\hbar^{2}}{2m}\\cdot 2aN^{2}=\\frac{\\hbar^{2}}{2m}\\cdot 2a\\cdot\\frac{3}{2a^{3}}=\\frac{3\\hbar^{2}}{2ma^{2}}.\n$$\n\nThe potential-energy expectation is\n$$\nV(a)=\\int_{-\\infty}^{\\infty}\\frac{1}{2}m\\omega^{2}x^{2}|\\psi(x)|^{2}\\,dx=\\frac{1}{2}m\\omega^{2}\\cdot 2N^{2}\\int_{0}^{a}x^{2}(a-x)^{2}\\,dx.\n$$\nCompute\n$$\n\\int_{0}^{a}x^{2}(a-x)^{2}\\,dx=\\int_{0}^{a}\\left(a^{2}x^{2}-2ax^{3}+x^{4}\\right)\\,dx=\\left[\\frac{a^{2}x^{3}}{3}-\\frac{2ax^{4}}{4}+\\frac{x^{5}}{5}\\right]_{0}^{a}=\\frac{a^{5}}{30}.\n$$\nThus\n$$\nV(a)=m\\omega^{2}N^{2}\\cdot\\frac{a^{5}}{30}=m\\omega^{2}\\cdot\\frac{3}{2a^{3}}\\cdot\\frac{a^{5}}{30}=\\frac{m\\omega^{2}a^{2}}{20}.\n$$\n\nThe variational energy is\n$$\nE(a)=T(a)+V(a)=\\frac{3\\hbar^{2}}{2ma^{2}}+\\frac{m\\omega^{2}a^{2}}{20}.\n$$\nTo minimize with respect to $a>0$, differentiate and set to zero:\n$$\n\\frac{dE}{da}=-\\frac{3\\hbar^{2}}{m}a^{-3}+\\frac{m\\omega^{2}}{10}a=0\n\\quad\\Longrightarrow\\quad\nm^{2}\\omega^{2}a^{4}=30\\hbar^{2}\n\\quad\\Longrightarrow\\quad\na^{2}=\\frac{\\sqrt{30}\\,\\hbar}{m\\omega}.\n$$\nEvaluating the minimum energy (equivalently using $E_{\\min}=2\\sqrt{AB}$ for $E(a)=A a^{-2}+B a^{2}$ with $A=\\frac{3\\hbar^{2}}{2m}$ and $B=\\frac{m\\omega^{2}}{20}$) gives\n$$\nE_{\\min}=2\\sqrt{\\frac{3\\hbar^{2}}{2m}\\cdot\\frac{m\\omega^{2}}{20}}=\\hbar\\omega\\sqrt{\\frac{3}{10}}.\n$$\nBy the variational principle, this is an upper bound on the true ground-state energy.", "answer": "$$\\boxed{\\hbar\\omega\\sqrt{\\frac{3}{10}}}$$", "id": "2144210"}, {"introduction": "Beyond estimating only the ground state, the variational method can be generalized to approximate multiple energy levels using the Rayleigh-Ritz procedure. This practice [@problem_id:3501584] transitions from simple parameter minimization to the matrix-based approach that forms the backbone of modern computational methods. You will construct the Hamiltonian ($\\mathbf{H}$) and Overlap ($\\mathbf{S}$) matrices for the harmonic oscillator in a small basis and solve the generalized eigenvalue problem $\\mathbf{H} \\mathbf{c} = E \\mathbf{S} \\mathbf{c}$, directly observing how a finite basis provides upper-bound estimates for both the ground and excited states.", "problem": "Consider the one-dimensional (1D) quantum harmonic oscillator with Hamiltonian operator $H = -\\dfrac{1}{2}\\dfrac{d^{2}}{dx^{2}} + \\dfrac{1}{2}\\,\\omega^{2} x^{2}$, where $\\hbar = 1$ and $m = 1$ are used to set the unit system, so all energies are dimensionless. The goal is to use the Rayleigh–Ritz variational method in a two-dimensional (2D) trial subspace to estimate the lowest two eigen-energies and to verify the min–max principle bounds. Use the following fundamental bases: the time-independent Schrödinger equation $H \\psi = E \\psi$, the Rayleigh quotient and Rayleigh–Ritz principle for Hermitian operators, and Gaussian quadrature identities or analytic Gaussian integration. No shortcut formulas for the final answers should be assumed; they must be derived from the definitions.\n \nYou are given the non-orthonormal trial functions $\\phi_{0}(x) = e^{-a x^{2}}$ and $\\phi_{1}(x) = x\\,e^{-a x^{2}}$ defined on the real line $(-\\infty, \\infty)$ with $a > 0$. Construct the overlap matrix $S$ with entries $S_{ij} = \\int_{-\\infty}^{\\infty} \\phi_{i}(x)\\phi_{j}(x)\\,dx$ and the Hamiltonian matrix $H$ with entries $H_{ij} = \\int_{-\\infty}^{\\infty} \\phi_{i}(x)\\, H\\, \\phi_{j}(x)\\,dx$. Solve the generalized Hermitian eigenvalue problem $H \\mathbf{c} = E\\, S \\mathbf{c}$ to obtain two Ritz estimates $E_{0}^{(\\text{sub})}$ and $E_{1}^{(\\text{sub})}$ for the ground and first excited energies, respectively. Use the well-tested exact spectrum of the harmonic oscillator $E_{n}^{(\\text{exact})} = \\left(n + \\dfrac{1}{2}\\right)\\,\\omega$ for $n \\in \\{0,1\\}$ to verify the min–max (Courant–Fischer) bounds $E_{0}^{(\\text{sub})} \\ge E_{0}^{(\\text{exact})}$ and $E_{1}^{(\\text{sub})} \\ge E_{1}^{(\\text{exact})}$.\n \nYour program must:\n- Assemble the matrices $H$ and $S$ from first principles using the given $\\phi_{0}$ and $\\phi_{1}$ and the operator $H$. You may evaluate the integrals exactly using Gaussian integral identities or numerically using reliable quadrature, provided the results are accurate and reproducible.\n- Solve the generalized eigenproblem to obtain the two subspace energies $E_{0}^{(\\text{sub})}$ and $E_{1}^{(\\text{sub})}$ sorted in ascending order.\n- Verify the min–max bounds by comparing with $E_{0}^{(\\text{exact})} = \\dfrac{1}{2}\\,\\omega$ and $E_{1}^{(\\text{exact})} = \\dfrac{3}{2}\\,\\omega$.\n- Express the energies as dimensionless numbers, since $\\hbar = 1$ and $m = 1$ have been chosen.\n \nTest Suite:\nUse the following parameter sets $(\\omega, a)$:\n- Case $1$: $(\\omega, a) = (1, 0.3)$.\n- Case $2$: $(\\omega, a) = (1, 0.5)$.\n- Case $3$: $(\\omega, a) = (2.5, 1.7)$.\n- Case $4$: $(\\omega, a) = (1, 0.05)$.\n \nFor each case, compute the two Ritz energies and a boolean indicating whether both min–max inequalities hold. The final output must be a single line consisting of a comma-separated list enclosed in square brackets, containing, for each case in the order listed above, three consecutive entries: the ground-state Ritz energy $E_{0}^{(\\text{sub})}$ rounded to $8$ decimal places, the first-excited-state Ritz energy $E_{1}^{(\\text{sub})}$ rounded to $8$ decimal places, and a boolean that is $True$ if both min–max inequalities hold and $False$ otherwise. Therefore, the overall output is a flat list with $12$ entries corresponding to the $4$ cases, in the order $[E_{0}^{(\\text{sub})}, E_{1}^{(\\text{sub})}, \\text{bounds\\_ok}, \\ldots]$.", "solution": "The core of this problem is the application of the Rayleigh-Ritz variational method to estimate the low-lying energy eigenvalues of the one-dimensional quantum harmonic oscillator. The Hamiltonian is given in dimensionless units ($\\hbar=1$, $m=1$) as:\n$$\nH = -\\frac{1}{2}\\frac{d^2}{dx^2} + \\frac{1}{2}\\omega^2 x^2\n$$\nThe variational method seeks approximate solutions to the time-independent Schrödinger equation $H \\psi = E \\psi$. We use a trial wavefunction $\\psi_t$ which is a linear combination of a set of basis functions $\\{\\phi_i\\}$. In this case, the trial subspace is two-dimensional, spanned by the non-orthonormal functions $\\phi_0(x) = e^{-ax^2}$ and $\\phi_1(x) = x e^{-ax^2}$, where $a > 0$. The trial wavefunction is:\n$$\n\\psi_t(x) = c_0 \\phi_0(x) + c_1 \\phi_1(x)\n$$\nThe Rayleigh-Ritz principle transforms the Schrödinger equation into a generalized eigenvalue problem for the coefficients $\\mathbf{c} = (c_0, c_1)^T$:\n$$\n\\mathbf{H} \\mathbf{c} = E \\mathbf{S} \\mathbf{c}\n$$\nHere, $\\mathbf{S}$ is the overlap matrix and $\\mathbf{H}$ is the Hamiltonian matrix in the basis $\\{\\phi_0, \\phi_1\\}$. Their elements are defined by the integrals:\n$$\nS_{ij} = \\int_{-\\infty}^{\\infty} \\phi_i^*(x) \\phi_j(x) \\,dx\n$$\n$$\nH_{ij} = \\int_{-\\infty}^{\\infty} \\phi_i^*(x) H \\phi_j(x) \\,dx\n$$\nSince the basis functions are real, the complex conjugation can be omitted. The eigenvalues $E$ of this system, denoted $E_k^{(\\text{sub})}$, are the Rayleigh-Ritz estimates for the true energy eigenvalues $E_k^{(\\text{exact})}$. The Courant-Fischer min-max principle guarantees that these estimates are upper bounds on the true eigenvalues: $E_k^{(\\text{sub})} \\ge E_k^{(\\text{exact})}$ for $k=0, 1$.\n\nOur first task is to compute the matrix elements $S_{ij}$ and $H_{ij}$. This requires evaluating several Gaussian integrals. We will use the standard definite integrals for $b>0$:\n$$\n\\int_{-\\infty}^{\\infty} e^{-bx^2} \\,dx = \\sqrt{\\frac{\\pi}{b}}\n$$\n$$\n\\int_{-\\infty}^{\\infty} x^{2n} e^{-bx^2} \\,dx = \\frac{(2n-1)!!}{2^n b^n} \\sqrt{\\frac{\\pi}{b}} \\quad (n \\ge 1)\n$$\n$$\n\\int_{-\\infty}^{\\infty} x^{2n+1} e^{-bx^2} \\,dx = 0\n$$\n\n**1. Calculation of the Overlap Matrix S**\n\nThe basis functions are $\\phi_0(x) = e^{-ax^2}$ (even parity) and $\\phi_1(x) = x e^{-ax^2}$ (odd parity).\n$$\nS_{00} = \\int_{-\\infty}^{\\infty} (e^{-ax^2})(e^{-ax^2}) \\,dx = \\int_{-\\infty}^{\\infty} e^{-2ax^2} \\,dx = \\sqrt{\\frac{\\pi}{2a}}\n$$\n$$\nS_{11} = \\int_{-\\infty}^{\\infty} (x e^{-ax^2})(x e^{-ax^2}) \\,dx = \\int_{-\\infty}^{\\infty} x^2 e^{-2ax^2} \\,dx\n$$\nUsing the formula for $n=1$ and $b=2a$, we get:\n$$\nS_{11} = \\frac{1}{2(2a)} \\sqrt{\\frac{\\pi}{2a}} = \\frac{1}{4a} \\sqrt{\\frac{\\pi}{2a}}\n$$\n$$\nS_{01} = S_{10} = \\int_{-\\infty}^{\\infty} (e^{-ax^2})(x e^{-ax^2}) \\,dx = \\int_{-\\infty}^{\\infty} x e^{-2ax^2} \\,dx = 0\n$$\nThe off-diagonal elements are zero because the integrand is an odd function (a product of an even and an odd function). Thus, the overlap matrix is diagonal:\n$$\n\\mathbf{S} = \\begin{pmatrix} \\sqrt{\\frac{\\pi}{2a}} & 0 \\\\ 0 & \\frac{1}{4a}\\sqrt{\\frac{\\pi}{2a}} \\end{pmatrix}\n$$\n\n**2. Calculation of the Hamiltonian Matrix H**\n\nFirst, we apply the Hamiltonian operator $H$ to each basis function.\nFor $\\phi_0(x)$:\n$$\n\\frac{d}{dx} \\phi_0 = -2ax e^{-ax^2} \\implies \\frac{d^2}{dx^2} \\phi_0 = (-2a + 4a^2x^2) e^{-ax^2}\n$$\n$$\nH \\phi_0(x) = \\left[-\\frac{1}{2}(-2a + 4a^2x^2) + \\frac{1}{2}\\omega^2x^2\\right] e^{-ax^2} = \\left[a + \\left(\\frac{1}{2}\\omega^2 - 2a^2\\right)x^2\\right] e^{-ax^2}\n$$\nFor $\\phi_1(x)$:\n$$\n\\frac{d}{dx} \\phi_1 = (1 - 2ax^2) e^{-ax^2} \\implies \\frac{d^2}{dx^2} \\phi_1 = (-6ax + 4a^2x^3) e^{-ax^2}\n$$\n$$\nH \\phi_1(x) = \\left[-\\frac{1}{2}(-6ax + 4a^2x^3) + \\frac{1}{2}\\omega^2x^3\\right] e^{-ax^2} = \\left[3ax + \\left(\\frac{1}{2}\\omega^2 - 2a^2\\right)x^3\\right] e^{-ax^2}\n$$\nNow we can compute the matrix elements $H_{ij}$:\n$$\nH_{00} = \\int_{-\\infty}^{\\infty} \\phi_0(x) H \\phi_0(x) \\,dx = \\int_{-\\infty}^{\\infty} e^{-ax^2} \\left[a + \\left(\\frac{1}{2}\\omega^2 - 2a^2\\right)x^2\\right] e^{-ax^2} \\,dx\n$$\n$$\nH_{00} = a \\int_{-\\infty}^{\\infty} e^{-2ax^2} \\,dx + \\left(\\frac{\\omega^2}{2} - 2a^2\\right) \\int_{-\\infty}^{\\infty} x^2 e^{-2ax^2} \\,dx\n$$\n$$\nH_{00} = a \\sqrt{\\frac{\\pi}{2a}} + \\left(\\frac{\\omega^2}{2} - 2a^2\\right) \\left(\\frac{1}{4a}\\sqrt{\\frac{\\pi}{2a}}\\right) = \\sqrt{\\frac{\\pi}{2a}} \\left(a + \\frac{\\omega^2}{8a} - \\frac{a}{2}\\right) = \\left(\\frac{a}{2} + \\frac{\\omega^2}{8a}\\right)\\sqrt{\\frac{\\pi}{2a}}\n$$\n$$\nH_{11} = \\int_{-\\infty}^{\\infty} \\phi_1(x) H \\phi_1(x) \\,dx = \\int_{-\\infty}^{\\infty} x e^{-ax^2} \\left[3ax + \\left(\\frac{1}{2}\\omega^2 - 2a^2\\right)x^3\\right] e^{-ax^2} \\,dx\n$$\n$$\nH_{11} = 3a \\int_{-\\infty}^{\\infty} x^2 e^{-2ax^2} \\,dx + \\left(\\frac{\\omega^2}{2} - 2a^2\\right) \\int_{-\\infty}^{\\infty} x^4 e^{-2ax^2} \\,dx\n$$\nUsing the integral formulas for $b=2a$, $n=1$ and $n=2$:\n$$\n\\int x^2e^{-2ax^2}dx = \\frac{1}{4a}\\sqrt{\\frac{\\pi}{2a}} \\quad , \\quad \\int x^4e^{-2ax^2}dx = \\frac{3}{16a^2}\\sqrt{\\frac{\\pi}{2a}}\n$$\n$$\nH_{11} = 3a\\left(\\frac{1}{4a}\\sqrt{\\frac{\\pi}{2a}}\\right) + \\left(\\frac{\\omega^2}{2} - 2a^2\\right)\\left(\\frac{3}{16a^2}\\sqrt{\\frac{\\pi}{2a}}\\right) = \\sqrt{\\frac{\\pi}{2a}}\\left(\\frac{3}{4} + \\frac{3\\omega^2}{32a^2} - \\frac{6a^2}{16a^2}\\right)\n$$\n$$\nH_{11} = \\sqrt{\\frac{\\pi}{2a}}\\left(\\frac{3}{8} + \\frac{3\\omega^2}{32a^2}\\right)\n$$\nThe off-diagonal elements $H_{01}$ and $H_{10}$ are zero due to parity, as the integrands $\\phi_0 H \\phi_1$ and $\\phi_1 H \\phi_0$ are odd functions.\nThe Hamiltonian matrix is also diagonal:\n$$\n\\mathbf{H} = \\begin{pmatrix} \\left(\\frac{a}{2} + \\frac{\\omega^2}{8a}\\right)\\sqrt{\\frac{\\pi}{2a}} & 0 \\\\ 0 & \\left(\\frac{3}{8} + \\frac{3\\omega^2}{32a^2}\\right)\\sqrt{\\frac{\\pi}{2a}} \\end{pmatrix}\n$$\n\n**3. Solving the Generalized Eigenvalue Problem**\n\nSince both $\\mathbf{H}$ and $\\mathbf{S}$ are diagonal, the generalized eigenvalue problem decouples into two independent equations. The eigenvalues $E$ are simply the ratios of the corresponding diagonal elements:\n$$\nE_0^{(\\text{sub})} = \\frac{H_{00}}{S_{00}} = \\frac{\\left(\\frac{a}{2} + \\frac{\\omega^2}{8a}\\right)\\sqrt{\\frac{\\pi}{2a}}}{\\sqrt{\\frac{\\pi}{2a}}} = \\frac{a}{2} + \\frac{\\omega^2}{8a}\n$$\n$$\nE_1^{(\\text{sub})} = \\frac{H_{11}}{S_{11}} = \\frac{\\left(\\frac{3}{8} + \\frac{3\\omega^2}{32a^2}\\right)\\sqrt{\\frac{\\pi}{2a}}}{\\frac{1}{4a}\\sqrt{\\frac{\\pi}{2a}}} = 4a\\left(\\frac{3}{8} + \\frac{3\\omega^2}{32a^2}\\right) = \\frac{3a}{2} + \\frac{3\\omega^2}{8a}\n$$\nThe even basis function $\\phi_0$ approximates the even-parity ground state, so its associated energy $E_0^{(\\text{sub})}$ is the estimate for the ground state energy. The odd basis function $\\phi_1$ approximates the odd-parity first excited state, so $E_1^{(\\text{sub})}$ is the estimate for its energy. As shown earlier, $E_1^{(\\text{sub})}-E_0^{(\\text{sub})} = a + \\frac{\\omega^2}{4a} > 0$, so the eigenvalues are naturally ordered.\n\n**4. Verification of the Min-Max Principle**\n\nThe exact energy spectrum of the quantum harmonic oscillator is $E_n^{(\\text{exact})} = (n + 1/2)\\omega$. Thus, for the lowest two states:\n$$\nE_0^{(\\text{exact})} = \\frac{1}{2}\\omega \\quad , \\quad E_1^{(\\text{exact})} = \\frac{3}{2}\\omega\n$$\nThe min-max principle requires that $E_0^{(\\text{sub})} \\ge E_0^{(\\text{exact})}$ and $E_1^{(\\text{sub})} \\ge E_1^{(\\text{exact})}$.\nLet's analyze $E_0^{(\\text{sub})}$ as a function of $a$. The minimum value is found where the derivative is zero:\n$$\n\\frac{dE_0^{(\\text{sub})}}{da} = \\frac{1}{2} - \\frac{\\omega^2}{8a^2} = 0 \\implies 4a^2 = \\omega^2 \\implies a = \\frac{\\omega}{2}\n$$\nAt this optimal value of $a$, the subspace energy is minimized:\n$$\nE_0^{(\\text{sub})}\\left(a=\\frac{\\omega}{2}\\right) = \\frac{1}{2}\\left(\\frac{\\omega}{2}\\right) + \\frac{\\omega^2}{8\\left(\\frac{\\omega}{2}\\right)} = \\frac{\\omega}{4} + \\frac{\\omega}{4} = \\frac{\\omega}{2} = E_0^{(\\text{exact})}\n$$\nFor any other $a>0$, the energy will be greater. This confirms $E_0^{(\\text{sub})} \\ge E_0^{(\\text{exact})}$ is always true. The inequality becomes an equality when the trial function matches the exact eigenfunction, which occurs at $a=\\omega/2$.\n\nSimilarly, for $E_1^{(\\text{sub})}$:\n$$\n\\frac{dE_1^{(\\text{sub})}}{da} = \\frac{3}{2} - \\frac{3\\omega^2}{8a^2} = 0 \\implies 4a^2 = \\omega^2 \\implies a = \\frac{\\omega}{2}\n$$\nThe minimum is also at $a=\\omega/2$:\n$$\nE_1^{(\\text{sub})}\\left(a=\\frac{\\omega}{2}\\right) = \\frac{3}{2}\\left(\\frac{\\omega}{2}\\right) + \\frac{3\\omega^2}{8\\left(\\frac{\\omega}{2}\\right)} = \\frac{3\\omega}{4} + \\frac{3\\omega}{4} = \\frac{3\\omega}{2} = E_1^{(\\text{exact})}\n$$\nThis confirms that $E_1^{(\\text{sub})} \\ge E_1^{(\\text{exact})}$ is also always true.\nTherefore, for any given parameters $(\\omega, a)$ with $\\omega > 0$ and $a > 0$, both min-max inequalities will hold. The boolean check for the bounds must always yield `True`.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import eigh\n\ndef solve():\n    \"\"\"\n    Solves the Rayleigh-Ritz problem for the 1D quantum harmonic oscillator.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        (1.0, 0.3),  # Case 1: (omega, a)\n        (1.0, 0.5),  # Case 2\n        (2.5, 1.7),  # Case 3\n        (1.0, 0.05), # Case 4\n    ]\n\n    results = []\n    for omega, a in test_cases:\n        # Assemble the scaled overlap and Hamiltonian matrices.\n        # The common factor sqrt(pi/(2a)) is canceled from all elements.\n        \n        # S_prime matrix\n        S_prime = np.zeros((2, 2))\n        S_prime[0, 0] = 1.0\n        S_prime[1, 1] = 1.0 / (4.0 * a)\n\n        # H_prime matrix\n        H_prime = np.zeros((2, 2))\n        H_prime[0, 0] = a / 2.0 + omega**2 / (8.0 * a)\n        H_prime[1, 1] = 3.0 / 8.0 + 3.0 * omega**2 / (32.0 * a**2)\n\n        # Solve the generalized eigenvalue problem H' c = E S' c.\n        # eigh returns eigenvalues in ascending order, which is what we need.\n        # For diagonal matrices, this is equivalent to H'_ii / S'_ii.\n        # But using eigh demonstrates the general numerical method.\n        eigenvalues = eigh(H_prime, S_prime, eigvals_only=True)\n        \n        e0_sub = eigenvalues[0]\n        e1_sub = eigenvalues[1]\n\n        # Calculate exact energies\n        e0_exact = 0.5 * omega\n        e1_exact = 1.5 * omega\n\n        # Verify the min-max principle bounds\n        # Using a small tolerance for floating point comparisons, though direct\n        # comparison works here since the variational principle guarantees >=.\n        tolerance = 1e-12\n        bounds_ok = (e0_sub >= e0_exact - tolerance) and \\\n                    (e1_sub >= e1_exact - tolerance)\n\n        # Append results for this case.\n        # round() is used as per the output specification.\n        results.extend([\n            round(e0_sub, 8),\n            round(e1_sub, 8),\n            bounds_ok\n        ])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3501584"}, {"introduction": "This final practice applies the full power of the Rayleigh-Ritz method to a core problem in computational materials science: calculating the electronic band structure of a periodic crystal. In this exercise [@problem_id:3501585], you will use a plane-wave basis, the standard for many solid-state calculations, and explore the critical concept of basis set convergence. By systematically enlarging the basis by increasing a kinetic energy cutoff, $E_{\\text{cut}}$, you will numerically verify the variational convergence and Rayleigh monotonicity of the calculated band energies, two essential checks for any production-level simulation.", "problem": "Consider a single spinless electron moving in one spatial dimension under a periodic cosine potential with period $a$ in atomic units, where the reduced Planck constant $\\hbar$, electron mass $m_{\\mathrm{e}}$, and elementary charge $e$ are set to unity. The Hamiltonian operator is given by the time-independent Schrödinger equation for a periodic potential. The cosine potential is $V(x) = V_{0} \\cos(G_{0} x)$ with $G_{0} = 2\\pi/a$, and the crystal momentum $k$ lies within the first Brillouin zone. In a plane-wave basis labeled by reciprocal lattice vectors $G = n G_{0}$ with integer $n$, and subject to a kinetic energy cutoff $E_{\\text{cut}}$ (Hartree), construct the finite-dimensional Hermitian Hamiltonian matrix at fixed $k$ by including only those basis functions whose free-electron kinetic energy does not exceed $E_{\\text{cut}}$. For a given set of increasing cutoff values $E_{\\text{cut}}$, compute the band energies by diagonalizing the truncated Hamiltonian and analyze the variational convergence and Rayleigh monotonicity for the lowest two bands as the basis is enlarged.\n\nYour program must:\n- Use atomic units throughout. Energies must be expressed in Hartree, and lengths in Bohr. No angle units are required beyond the definition of $k$ and $G$ in reciprocal space.\n- For each specified test case, construct the nested plane-wave subspaces by including all integers $n$ such that the free-electron kinetic energy of the plane wave at wave number $k + n G_{0}$, namely $(1/2)|k + n G_{0}|^{2}$, is less than or equal to $E_{\\text{cut}}$, for each $E_{\\text{cut}}$ in the provided ordered list.\n- For each truncated Hamiltonian, compute the eigenvalues (band energies) and sort them in ascending order.\n- For the lowest two bands (band indices $0$ and $1$), verify Rayleigh monotonicity across the sequence of cutoffs by checking that the band energy sequences are monotonically non-increasing as $E_{\\text{cut}}$ increases.\n- Assess variational convergence for the same bands by checking whether the absolute difference between the last two energies in the sequence is smaller than a given tolerance.\n- Return, for each test case, a list containing six items: a boolean indicating monotonicity for band $0$, a boolean indicating monotonicity for band $1$, a boolean indicating convergence for band $0$, a boolean indicating convergence for band $1$, the final energy (Hartree) for band $0$ at the largest cutoff, and the final energy (Hartree) for band $1$ at the largest cutoff.\n\nFundamental basis to be used in constructing your solution must be limited to the stationary Schrödinger equation for a periodic potential, Bloch’s theorem, the plane-wave expansion of periodic functions, and the Rayleigh-Ritz variational principle for Hermitian operators. Shortcut formulas not derived from these bases are not permitted in the solution.\n\nTest Suite:\n- Case $1$ (zone center): $a = 3.0$ Bohr, $V_{0} = 0.6$ Hartree, $k = 0.0$, $E_{\\text{cut}}$ list $[2.5, 6.0, 18.0, 40.0, 80.0, 200.0]$, convergence tolerance $1.0\\times 10^{-4}$ Hartree.\n- Case $2$ (zone boundary): $a = 3.0$ Bohr, $V_{0} = 0.6$ Hartree, $k = G_{0}/2$, $E_{\\text{cut}}$ list $[2.5, 6.0, 18.0, 40.0, 80.0, 200.0]$, convergence tolerance $1.0\\times 10^{-4}$ Hartree.\n- Case $3$ (weak potential, off-center $k$): $a = 2.5$ Bohr, $V_{0} = 0.05$ Hartree, $k = 0.3\\, G_{0}$, $E_{\\text{cut}}$ list $[1.6, 4.0, 12.0, 30.0, 60.0, 200.0]$, convergence tolerance $1.0\\times 10^{-4}$ Hartree.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each test case contributes a sublist in the same order as the test suite and each sublist has the six items specified above. For example, the output format must be of the form $[[b_{00}, b_{01}, b_{10}, b_{11}, e_{0}, e_{1}],[\\dots],[\\dots]]$, where $b_{ij}$ are booleans and $e_{m}$ are floats in Hartree.", "solution": "The problem requires us to compute the electronic band structure of a one-dimensional crystal and analyze the convergence properties of the plane-wave variational method. We are given a spinless electron moving in a periodic potential $V(x) = V_{0} \\cos(G_{0} x)$, where $G_{0} = 2\\pi/a$ is the fundamental reciprocal lattice vector and $a$ is the lattice period. All calculations are performed in atomic units, where $\\hbar = m_{\\mathrm{e}} = 1$.\n\nThe governing equation is the time-independent Schrödinger equation:\n$$\n\\hat{H} \\psi(x) = E \\psi(x)\n$$\nwhere the Hamiltonian operator is given by $\\hat{H} = \\hat{T} + \\hat{V}$, with the kinetic energy operator $\\hat{T} = -\\frac{1}{2}\\frac{d^2}{dx^2}$ and the potential energy operator $\\hat{V} = V(x)$.\n\nAccording to Bloch's theorem, for a periodic potential $V(x) = V(x+a)$, the eigenfunctions of the Hamiltonian can be written in the form of a Bloch wave:\n$$\n\\psi_k(x) = e^{ikx} u_k(x)\n$$\nHere, $k$ is the crystal momentum, a conserved quantity, which is restricted to the first Brillouin zone, $k \\in [-\\pi/a, \\pi/a] = [-G_{0}/2, G_{0}/2]$. The function $u_k(x)$ has the same periodicity as the lattice, $u_k(x) = u_k(x+a)$.\n\nBecause $u_k(x)$ is periodic, it can be expanded as a Fourier series over the reciprocal lattice vectors $G = n G_{0}$ for integer $n$:\n$$\nu_k(x) = \\sum_{G} c_{k,G} e^{iGx}\n$$\nSubstituting this into the Bloch wave form, we obtain an expansion for the full wavefunction $\\psi_k(x)$ in a basis of plane waves $\\{e^{i(k+G)x}\\}$:\n$$\n\\psi_k(x) = \\sum_{G} c_{k,G} e^{i(k+G)x}\n$$\nThe coefficients $c_{k,G}$ and the corresponding energy eigenvalues $E_k$ are found by solving the Schrödinger equation in this plane-wave basis. Substituting the expansion for $\\psi_k(x)$ into the Schrödinger equation yields:\n$$\n\\sum_{G} c_{k,G} \\left( -\\frac{1}{2}\\frac{d^2}{dx^2} + V(x) \\right) e^{i(k+G)x} = E_k \\sum_{G} c_{k,G} e^{i(k+G)x}\n$$\nThe action of the kinetic energy operator on a plane wave is straightforward:\n$$\n-\\frac{1}{2}\\frac{d^2}{dx^2} e^{i(k+G)x} = \\frac{1}{2}(k+G)^2 e^{i(k+G)x}\n$$\nTo form a matrix eigenvalue equation, we project onto a particular basis function $\\langle e^{i(k+G')x} |$, which involves multiplying by $e^{-i(k+G')x}$ and integrating over space. This yields the matrix elements $H_{G',G}$ of the Hamiltonian:\n$$\nH_{G',G} = \\frac{1}{\\mathcal{L}} \\int_0^{\\mathcal{L}} e^{-i(k+G')x} \\hat{H} e^{i(k+G)x} dx\n$$\nwhere the integral is over the length of the crystal $\\mathcal{L}$.\n\nThe kinetic energy term is diagonal in this basis:\n$$\n\\langle e^{i(k+G')x} | \\hat{T} | e^{i(k+G)x} \\rangle = \\frac{1}{2}(k+G)^2 \\delta_{G',G}\n$$\nThe potential energy term couples different plane waves:\n$$\n\\langle e^{i(k+G')x} | \\hat{V} | e^{i(k+G)x} \\rangle = \\frac{1}{\\mathcal{L}} \\int_0^{\\mathcal{L}} V(x) e^{-i(G'-G)x} dx = V_{G'-G}\n$$\nwhere $V_{G'-G}$ is the Fourier coefficient of the potential $V(x)$ corresponding to the reciprocal lattice vector $G'-G$. The potential is given as $V(x) = V_{0}\\cos(G_{0}x) = \\frac{V_{0}}{2}(e^{iG_{0}x} + e^{-iG_{0}x})$. The only non-zero Fourier coefficients are $V_{G_0} = V_0/2$ and $V_{-G_0} = V_0/2$.\n\nThus, the potential term $V_{G'-G}$ is non-zero only if $G'-G = \\pm G_{0}$. With $G = nG_0$ and $G' = mG_0$, this means $m-n = \\pm 1$. The Hamiltonian matrix elements $H_{m,n}$ (indexed by the integers $m$ and $n$) are:\n$$\nH_{m,n} = \\frac{1}{2}(k+nG_{0})^2 \\delta_{m,n} + \\frac{V_{0}}{2}(\\delta_{m,n+1} + \\delta_{m,n-1})\n$$\nIn principle, the basis is infinite. For a numerical solution, we must truncate it. The problem specifies a kinetic energy cutoff $E_{\\text{cut}}$. The basis set is constructed by including all integers $n$ for which the free-electron kinetic energy is below this cutoff:\n$$\n\\frac{1}{2}(k+nG_0)^2 \\le E_{\\text{cut}}\n$$\nThis defines a finite set of integers $\\{n\\}$, which in turn defines a finite-dimensional Hamiltonian matrix. Since the kinetic energy is a quadratic function of $n$, the included integers form a contiguous block, $n \\in [n_{\\text{min}}, n_{\\text{max}}]$. If we order these integers, the resulting Hamiltonian matrix is tridiagonal.\n\nThe Rayleigh-Ritz variational principle states that the eigenvalues obtained from a finite-dimensional matrix representation of the Hamiltonian in a subspace are upper bounds to the true eigenvalues. Furthermore, the min-max theorem guarantees that if we have two basis sets $S_1$ and $S_2$ such that $S_1 \\subset S_2$, the sorted eigenvalues satisfy $E_i^{(2)} \\le E_i^{(1)}$ for all band indices $i$. The problem specifies an increasing sequence of $E_{\\text{cut}}$ values, which generates a sequence of nested basis sets. Consequently, the calculated energy for any given band must be a monotonically non-increasing function of $E_{\\text{cut}}$. This is the Rayleigh monotonicity that must be verified.\n\nAs $E_{\\text{cut}}$ increases, the basis set becomes more complete, and the calculated eigenvalues converge towards the exact values. Convergence is assessed by checking if the absolute difference in energy for a given band, calculated using the two largest cutoffs in the sequence, is below a specified tolerance $\\epsilon$. Let the sequence of energies for band $i$ be $E_i(E_{\\text{cut, 1}}), \\dots, E_i(E_{\\text{cut, M}})$. We check if $|E_i(E_{\\text{cut, M}}) - E_i(E_{\\text{cut, M-1}})| < \\epsilon$.\n\nThe algorithm is as follows:\n1. For each test case, define parameters $a, V_0, k$, the list of $E_{\\text{cut}}$ values, and the tolerance $\\epsilon$. Calculate $G_0 = 2\\pi/a$.\n2. For each $E_{\\text{cut}}$ in the list:\n    a. Determine the range of integers $[n_{\\text{min}}, n_{\\text{max}}]$ satisfying $\\frac{1}{2}(k+nG_0)^2 \\le E_{\\text{cut}}$.\n    b. Construct the tridiagonal Hamiltonian matrix $H$ of size $N \\times N$, where $N = n_{\\text{max}} - n_{\\text{min}} + 1$. The diagonal elements are $H_{i,i} = \\frac{1}{2}(k + (n_{\\text{min}}+i)G_0)^2$ and the super/sub-diagonal elements are $H_{i, i\\pm 1} = V_0/2$.\n    c. Diagonalize this Hermitian matrix to find its eigenvalues (the band energies). Since it is tridiagonal, a specialized and efficient eigensolver can be used.\n    d. Store the two lowest eigenvalues (for band $0$ and band $1$) in separate lists, corresponding to their evolution with increasing $E_{\\text{cut}}$.\n3. After iterating through all $E_{\\text{cut}}$ values:\n    a. Verify Rayleigh monotonicity for band $0$ and band $1$ by checking if their respective energy sequences are non-increasing.\n    b. Verify convergence for band $0$ and band $1$ by comparing the last two energies in each sequence against the tolerance $\\epsilon$.\n    c. Extract the final energies for both bands, which are the ones computed with the largest $E_{\\text{cut}}$.\n4. Collate the six results (four booleans and two final energies) for each test case and format the output as specified.", "answer": "```python\nimport numpy as np\nfrom scipy.linalg import eigh_tridiagonal\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print results.\n    \"\"\"\n    test_cases = [\n        {\n            \"a\": 3.0, \"V0\": 0.6, \"k_factor\": 0.0,\n            \"E_cut_list\": [2.5, 6.0, 18.0, 40.0, 80.0, 200.0],\n            \"tol\": 1.0e-4\n        },\n        {\n            \"a\": 3.0, \"V0\": 0.6, \"k_factor\": 0.5,\n            \"E_cut_list\": [2.5, 6.0, 18.0, 40.0, 80.0, 200.0],\n            \"tol\": 1.0e-4\n        },\n        {\n            \"a\": 2.5, \"V0\": 0.05, \"k_factor\": 0.3,\n            \"E_cut_list\": [1.6, 4.0, 12.0, 30.0, 60.0, 200.0],\n            \"tol\": 1.0e-4\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        result = calculate_bands(\n            case[\"a\"], case[\"V0\"], case[\"k_factor\"],\n            case[\"E_cut_list\"], case[\"tol\"]\n        )\n        results.append(result)\n\n    # Format the output string as per the problem specification\n    # e.g., [[True,True,True,True,0.23,0.85],[...],[...]]\n    outer_parts = []\n    for res in results:\n        inner_parts = []\n        for item in res:\n            if isinstance(item, bool):\n                inner_parts.append(str(item))\n            else:\n                inner_parts.append(f\"{item}\")\n        outer_parts.append(f\"[{','.join(inner_parts)}]\")\n    final_string = f\"[{','.join(outer_parts)}]\"\n    print(final_string)\n\ndef calculate_bands(a, V0, k_factor, E_cut_list, tol):\n    \"\"\"\n    Calculates band energies and checks for convergence and monotonicity.\n\n    Args:\n        a (float): Lattice constant in Bohr.\n        V0 (float): Potential amplitude in Hartree.\n        k_factor (float): Crystal momentum as a factor of G0.\n        E_cut_list (list of float): List of kinetic energy cutoffs in Hartree.\n        tol (float): Convergence tolerance in Hartree.\n\n    Returns:\n        list: A list containing six items: monotonicity bools for bands 0 and 1,\n              convergence bools for bands 0 and 1, and final energies for bands 0 and 1.\n    \"\"\"\n    # Define constants in atomic units\n    G0 = 2.0 * np.pi / a\n    k = k_factor * G0\n    \n    band_energies = {0: [], 1: []}\n\n    for E_cut in E_cut_list:\n        # Determine the range of integers n for the plane-wave basis\n        # (1/2) * (k + n*G0)^2 <= E_cut  => |k + n*G0| <= sqrt(2*E_cut)\n        # -sqrt(2*E_cut) <= k + n*G0 <= sqrt(2*E_cut)\n        # (-k - sqrt(2*E_cut))/G0 <= n <= (-k + sqrt(2*E_cut))/G0\n        sqrt_2E_cut = np.sqrt(2.0 * E_cut)\n        n_min_float = (-k - sqrt_2E_cut) / G0\n        n_max_float = (-k + sqrt_2E_cut) / G0\n        \n        n_min = int(np.ceil(n_min_float))\n        n_max = int(np.floor(n_max_float))\n        \n        n_list = np.arange(n_min, n_max + 1)\n        N = len(n_list)\n\n        # Construct the tridiagonal Hamiltonian matrix\n        # Diagonal elements: kinetic energy\n        diag_elements = 0.5 * (k + n_list * G0)**2\n        \n        # Off-diagonal elements: potential coupling\n        off_diag_elements = np.full(N - 1, V0 / 2.0)\n\n        # Diagonalize the Hamiltonian to find eigenvalues (band energies)\n        # Using eigh_tridiagonal is efficient for this matrix structure.\n        # It returns eigenvalues sorted in ascending order.\n        if N > 0:\n            eigvals = eigh_tridiagonal(diag_elements, off_diag_elements, eigvals_only=True)\n        else: # Handle cases where E_cut is too small to include any basis functions\n            eigvals = []\n\n        if len(eigvals) >= 2:\n            band_energies[0].append(eigvals[0])\n            band_energies[1].append(eigvals[1])\n        elif len(eigvals) == 1: # If only one basis function, only one band\n            band_energies[0].append(eigvals[0])\n\n    # Analyze variational convergence and Rayleigh monotonicity\n    # Ensure there are enough data points to perform checks\n    if len(band_energies[0]) < 2 or len(band_energies[1]) < 2:\n        return [False, False, False, False, np.nan, np.nan] # Not enough data to check\n\n    # 1. Rayleigh Monotonicity check\n    # Energies must be non-increasing as the basis set expands.\n    seq_b0 = band_energies[0]\n    is_monotonic_b0 = all(seq_b0[i] >= seq_b0[i+1] - 1e-12 for i in range(len(seq_b0) - 1))\n    \n    seq_b1 = band_energies[1]\n    is_monotonic_b1 = all(seq_b1[i] >= seq_b1[i+1] - 1e-12 for i in range(len(seq_b1) - 1))\n    # A small tolerance 1e-12 is added to handle potential floating-point inaccuracies\n    # where theoretically equal values might differ by machine epsilon.\n\n    # 2. Variational Convergence check\n    # Absolute difference between last two energies must be below tolerance.\n    is_converged_b0 = abs(seq_b0[-1] - seq_b0[-2]) < tol\n    is_converged_b1 = abs(seq_b1[-1] - seq_b1[-2]) < tol\n\n    # 3. Final energies\n    final_energy_b0 = seq_b0[-1]\n    final_energy_b1 = seq_b1[-1]\n    \n    return [\n        is_monotonic_b0, is_monotonic_b1,\n        is_converged_b0, is_converged_b1,\n        final_energy_b0, final_energy_b1\n    ]\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "3501585"}]}