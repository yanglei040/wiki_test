{"hands_on_practices": [{"introduction": "Understanding the classification of a Partial Differential Equation (PDE) is analogous to identifying a conic section; the process of transforming it to its canonical form is like rotating the coordinate axes to align with the object's principal directions. This fundamental exercise [@problem_id:3371555] provides direct, hands-on practice in this algebraic manipulation. By diagonalizing the principal part of the operator, you will make the abstract concept of an equation's 'type' concrete and connect it to the geometric interpretation of coordinate transformation.", "problem": "Consider the principal part of a second-order linear Partial Differential Equation (PDE) given by $u_{xx}-4u_{xy}-3u_{yy}$. The classification of a second-order linear PDE is based on the symmetric $2 \\times 2$ matrix of its principal coefficients and the signs of its eigenvalues. Orthogonal changes of variables correspond to rotations of the coordinate axes and preserve the type while enabling diagonalization of the principal part.\n\nStarting from these definitions and facts alone, do the following:\n\n1. Classify the PDE $u_{xx}-4u_{xy}-3u_{yy}$ by determining the signs of the eigenvalues of the symmetric coefficient matrix of its quadratic form, and state the equation type.\n2. Perform an orthogonal rotation of the spatial coordinates, $(x,y) \\mapsto (\\xi,\\eta)$, that eliminates the mixed derivative term. Determine the rotation angle $\\theta$ explicitly in radians, choosing the principal value $\\theta \\in (-\\pi/2,\\pi/2)$.\n3. Using this rotation, write the principal part in canonical form with no mixed derivative, and then rescale the rotated coordinates so that the canonical hyperbolic form has unit coefficients, i.e., of the form $u_{\\tilde{\\xi}\\tilde{\\xi}} - u_{\\tilde{\\eta}\\tilde{\\eta}}$.\n\nExpress your final answer as the exact value of the rotation angle $\\theta$ in radians. No rounding is required, and the angle should be given in radians.", "solution": "The problem requires the classification and transformation to canonical form of a given second-order linear partial differential equation (PDE). The analysis is based on the principal part of the PDE, which is given as $u_{xx}-4u_{xy}-3u_{yy}$.\n\nThe general form of the principal part of a second-order linear PDE in two variables $x$ and $y$ is $A u_{xx} + B u_{xy} + C u_{yy}$. For the given equation, we identify the coefficients:\n$A = 1$\n$B = -4$\n$C = -3$\n\nThe classification of the PDE depends on the properties of the symmetric coefficient matrix associated with this quadratic form. The matrix, denoted by $M$, is constructed as:\n$$\nM = \\begin{pmatrix} A  \\frac{B}{2} \\\\ \\frac{B}{2}  C \\end{pmatrix} = \\begin{pmatrix} 1  -2 \\\\ -2  -3 \\end{pmatrix}\n$$\n\n**1. Classification of the PDE**\n\nThe type of the PDE is determined by the signs of the eigenvalues of the matrix $M$. The eigenvalues, denoted by $\\lambda$, are the roots of the characteristic equation $\\det(M - \\lambda I) = 0$, where $I$ is the $2 \\times 2$ identity matrix.\n$$\n\\det \\begin{pmatrix} 1-\\lambda  -2 \\\\ -2  -3-\\lambda \\end{pmatrix} = 0\n$$\nExpanding the determinant gives the characteristic polynomial:\n$$\n(1-\\lambda)(-3-\\lambda) - (-2)(-2) = 0\n$$\n$$\n-3 - \\lambda + 3\\lambda + \\lambda^2 - 4 = 0\n$$\n$$\n\\lambda^2 + 2\\lambda - 7 = 0\n$$\nWe solve for $\\lambda$ using the quadratic formula:\n$$\n\\lambda = \\frac{-2 \\pm \\sqrt{2^2 - 4(1)(-7)}}{2(1)} = \\frac{-2 \\pm \\sqrt{4 + 28}}{2} = \\frac{-2 \\pm \\sqrt{32}}{2} = \\frac{-2 \\pm 4\\sqrt{2}}{2}\n$$\nThe two eigenvalues are:\n$$\n\\lambda_1 = -1 + 2\\sqrt{2} \\quad \\text{and} \\quad \\lambda_2 = -1 - 2\\sqrt{2}\n$$\nTo determine their signs, we note that $\\sqrt{2} \\approx 1.414$, so $2\\sqrt{2} = \\sqrt{8} \\approx 2.828$.\nThus, $\\lambda_1 = -1 + 2\\sqrt{2}  0$ and $\\lambda_2 = -1 - 2\\sqrt{2}  0$.\nSince the eigenvalues have opposite signs ($\\lambda_1 \\lambda_2 = \\det(M) = (1)(-3) - (-2)(-2) = -7  0$), the PDE is classified as **hyperbolic**.\n\nThis result can be confirmed using the discriminant $\\Delta = B^2 - 4AC$:\n$$\n\\Delta = (-4)^2 - 4(1)(-3) = 16 + 12 = 28  0\n$$\nA positive discriminant also indicates a hyperbolic equation.\n\n**2. Orthogonal Rotation to Eliminate the Mixed Derivative**\n\nAn orthogonal rotation of the coordinate system $(x,y)$ to a new system $(\\xi,\\eta)$ can diagonalize the matrix $M$. This corresponds to finding a coordinate system aligned with the eigenvectors of $M$, thereby eliminating the mixed partial derivative term $u_{\\xi\\eta}$. The rotation angle $\\theta$ required to achieve this is given by the formula:\n$$\n\\tan(2\\theta) = \\frac{B}{A-C}\n$$\nSubstituting the coefficients $A=1$, $B=-4$, and $C=-3$:\n$$\n\\tan(2\\theta) = \\frac{-4}{1 - (-3)} = \\frac{-4}{4} = -1\n$$\nWe need to find $\\theta$ in the principal value interval $(-\\frac{\\pi}{2}, \\frac{\\pi}{2})$. This implies $2\\theta$ must be in the interval $(-\\pi, \\pi)$. The principal value for the arctangent function gives:\n$$\n2\\theta = \\arctan(-1) = -\\frac{\\pi}{4}\n$$\nSolving for $\\theta$:\n$$\n\\theta = -\\frac{\\pi}{8}\n$$\nThis value lies within the specified interval $(-\\frac{\\pi}{2}, \\frac{\\pi}{2})$.\n\n**3. Canonical Form**\n\nThe rotation of coordinates is given by:\n$$\n\\begin{pmatrix} \\xi \\\\ \\eta \\end{pmatrix} = \\begin{pmatrix} \\cos\\theta  \\sin\\theta \\\\ -\\sin\\theta  \\cos\\theta \\end{pmatrix} \\begin{pmatrix} x \\\\ y \\end{pmatrix}\n$$\nUnder this transformation, the principal part of the PDE transforms to:\n$$\nA u_{xx} + B u_{xy} + C u_{yy} \\longrightarrow \\lambda_{\\xi} u_{\\xi\\xi} + \\lambda_{\\eta} u_{\\eta\\eta}\n$$\nwhere $\\lambda_{\\xi}$ and $\\lambda_{\\eta}$ are the eigenvalues of $M$. The specific assignment of eigenvalues to the new axes depends on the choice of rotation. With our choice of $\\theta = -\\frac{\\pi}{8}$, the new coefficients are the eigenvalues $\\lambda_1$ and $\\lambda_2$. The operator becomes:\n$$\n(-1+2\\sqrt{2}) u_{\\xi\\xi} + (-1-2\\sqrt{2}) u_{\\eta\\eta}\n$$\nThis is the canonical form with no mixed derivative.\n\nThe final step is to rescale the coordinates $(\\xi, \\eta)$ to new coordinates $(\\tilde{\\xi}, \\tilde{\\eta})$ to make the coefficients have unit magnitude, achieving the form $u_{\\tilde{\\xi}\\tilde{\\xi}} - u_{\\tilde{\\eta}\\tilde{\\eta}}$.\nLet the canonical form be written as $\\lambda_1 u_{\\xi\\xi} + \\lambda_2 u_{\\eta\\eta}$, where $\\lambda_1 = 2\\sqrt{2}-1  0$ and $\\lambda_2 = -1-2\\sqrt{2}  0$.\nWe define the rescaling:\n$$\n\\tilde{\\xi} = \\sqrt{\\lambda_1} \\xi = \\sqrt{2\\sqrt{2}-1} \\xi\n$$\n$$\n\\tilde{\\eta} = \\sqrt{|\\lambda_2|} \\eta = \\sqrt{1+2\\sqrt{2}} \\eta\n$$\nThe chain rule gives:\n$u_{\\xi} = \\frac{d\\tilde{\\xi}}{d\\xi} u_{\\tilde{\\xi}} = \\sqrt{2\\sqrt{2}-1} \\ u_{\\tilde{\\xi}} \\implies u_{\\xi\\xi} = (2\\sqrt{2}-1) u_{\\tilde{\\xi}\\tilde{\\xi}}$\n$u_{\\eta} = \\frac{d\\tilde{\\eta}}{d\\eta} u_{\\tilde{\\eta}} = \\sqrt{1+2\\sqrt{2}} \\ u_{\\tilde{\\eta}} \\implies u_{\\eta\\eta} = (1+2\\sqrt{2}) u_{\\tilde{\\eta}\\tilde{\\eta}}$\n\nSubstituting these into the canonical form:\n$$\n(2\\sqrt{2}-1) u_{\\xi\\xi} - (1+2\\sqrt{2}) u_{\\eta\\eta} = (2\\sqrt{2}-1) \\frac{u_{\\tilde{\\xi}\\tilde{\\xi}}}{2\\sqrt{2}-1} - (1+2\\sqrt{2}) \\frac{u_{\\tilde{\\eta}\\tilde{\\eta}}}{1+2\\sqrt{2}}\n$$\nThis simplifies to the target hyperbolic form with unit coefficients:\n$$\nu_{\\tilde{\\xi}\\tilde{\\xi}} - u_{\\tilde{\\eta}\\tilde{\\eta}}\n$$\nThe problem asks for the explicit value of the rotation angle $\\theta$. Based on our derivation, this angle is $-\\frac{\\pi}{8}$ radians.", "answer": "$$\n\\boxed{-\\frac{\\pi}{8}}\n$$", "id": "3371555"}, {"introduction": "Building upon constant-coefficient cases, many physical phenomena are described by PDEs whose character changes within the domain, such as the transition from subsonic (elliptic) to supersonic (hyperbolic) flow. This exercise [@problem_id:3371537] challenges you to confront this reality by analyzing a PDE with variable coefficients. You will derive the discriminant as a function of position, allowing you to map out the regions where the equation exhibits hyperbolic, parabolic, or elliptic behavior and understand the implications for the solution's structure.", "problem": "Consider the second-order linear partial differential equation (PDE) in two spatial variables,\n$$u_{xx}+2\\,(1-x)\\,u_{xy}-(1+x^{2})\\,u_{yy}=0,$$\nposed on the plane $\\mathbb{R}^{2}$ with coordinates $(x,y)$. Starting from the core definition of type classification for a second-order linear PDE in two variables—namely, for a principal part written in the form $A\\,u_{xx}+2\\,B\\,u_{xy}+C\\,u_{yy}$, the discriminant $D$ is defined by $D=B^{2}-A\\,C$—perform the following:\n\n(1) Identify the principal coefficients $A$, $B$, and $C$ for the given PDE, and derive the discriminant $D(x)$ as an explicit analytic expression in $x$.\n\n(2) Using only the sign of $D(x)$ and the standard definition of PDE type (elliptic if $D0$, parabolic if $D=0$, hyperbolic if $D0$), construct a piecewise classification map over the $(x,y)$-plane, indicating precisely which regions are elliptic, parabolic, or hyperbolic. State clearly whether the type depends on $x$ and/or $y$.\n\n(3) Identify all real curves in the plane where $D(x)=0$ holds (if any), which would signal parabolic degeneracy. If no such curves exist, justify that conclusion directly from your expression for $D(x)$.\n\n(4) Briefly explain the implication of your classification map for the qualitative structure of characteristic curves and the choice of numerical schemes for hyperbolic versus elliptic problems, grounding your discussion in the sign of $D(x)$ and the principal part.\n\nYour final reported answer must be the simplified analytic expression for the discriminant $D(x)$. No rounding is required. Do not include units in your final answer.", "solution": "The analysis is structured according to the four parts of the problem statement.\n\n**(1) Identification of Coefficients and Derivation of the Discriminant**\n\nThe given PDE is:\n$$u_{xx}+2\\,(1-x)\\,u_{xy}-(1+x^{2})\\,u_{yy}=0$$\nTo classify this equation, we compare it to the general form for the principal part of a second-order linear PDE in two variables:\n$$A(x,y)\\,u_{xx}+2\\,B(x,y)\\,u_{xy}+C(x,y)\\,u_{yy} + \\text{lower order terms} = 0$$\nBy direct comparison, we identify the coefficients $A$, $B$, and $C$ for the given PDE:\n- The coefficient of $u_{xx}$ is $A = 1$.\n- The coefficient of $u_{xy}$ is $2(1-x)$, so $2B = 2(1-x)$, which gives $B = 1-x$.\n- The coefficient of $u_{yy}$ is $-(1+x^2)$, so $C = -(1+x^2)$.\n\nThe discriminant, $D$, is defined as $D = B^{2} - A\\,C$. Substituting the identified coefficients, we derive the discriminant as a function of $x$:\n$$D(x) = (1-x)^{2} - (1)\\left(-(1+x^{2})\\right)$$\nExpanding the terms, we get:\n$$D(x) = (1 - 2x + x^{2}) + (1+x^{2})$$\nCombining like terms yields the simplified analytic expression for the discriminant:\n$$D(x) = 2x^{2} - 2x + 2$$\nThis can also be written in the factored form $D(x) = 2(x^2 - x + 1)$.\n\n**(2) Classification Map over the $(x,y)$-Plane**\n\nThe type of the PDE (elliptic, parabolic, or hyperbolic) is determined by the sign of the discriminant $D(x) = 2x^{2} - 2x + 2$. The coefficients $A$, $B$, and $C$ depend only on the variable $x$, thus the discriminant $D$ and the PDE type also depend only on $x$, not on $y$.\n\nTo determine the sign of $D(x)$, we analyze the quadratic polynomial $p(x) = x^{2} - x + 1$. The sign of $D(x)$ is the same as the sign of $p(x)$, since $D(x)=2p(x)$ and $20$. We can determine the sign of $p(x)$ by checking for its real roots using the quadratic formula, where the discriminant of the polynomial itself (not the PDE) is $\\Delta = b^2 - 4ac$. For $p(x)=x^2-x+1$, we have $a=1$, $b=-1$, and $c=1$.\n$$\\Delta = (-1)^{2} - 4(1)(1) = 1 - 4 = -3$$\nSince $\\Delta  0$ and the leading coefficient $a=1$ is positive, the quadratic polynomial $p(x)$ has no real roots and is strictly positive for all real values of $x$.\n\nAlternatively, we can complete the square for $p(x)$:\n$$p(x) = x^{2} - x + 1 = \\left(x^{2} - x + \\frac{1}{4}\\right) - \\frac{1}{4} + 1 = \\left(x - \\frac{1}{2}\\right)^{2} + \\frac{3}{4}$$\nSince $\\left(x-\\frac{1}{2}\\right)^2 \\ge 0$ for all $x \\in \\mathbb{R}$, the minimum value of $p(x)$ is $\\frac{3}{4}$, which occurs at $x=\\frac{1}{2}$. Thus, $p(x)  0$ for all $x$.\n\nConsequently, the discriminant of the PDE, $D(x) = 2 p(x) = 2\\left(\\left(x - \\frac{1}{2}\\right)^{2} + \\frac{3}{4}\\right)$, is strictly positive for all $x \\in \\mathbb{R}$.\n$$D(x)  0 \\quad \\forall (x,y) \\in \\mathbb{R}^{2}$$\nBased on the classification criteria:\n- **Elliptic ($D  0$)**: The PDE is never elliptic.\n- **Parabolic ($D = 0$)**: The PDE is never parabolic.\n- **Hyperbolic ($D  0$)**: The PDE is hyperbolic for all points $(x,y)$ in the plane $\\mathbb{R}^{2}$.\n\nThe classification map is uniform: the entire $(x,y)$-plane is a hyperbolic region.\n\n**(3) Curves of Parabolic Degeneracy**\n\nParabolic degeneracy occurs at points where the discriminant is zero, i.e., $D(x) = 0$.\n$$2x^{2} - 2x + 2 = 0$$\nDividing by $2$, we get the equation:\n$$x^{2} - x + 1 = 0$$\nAs established in part (2), this quadratic equation has no real solutions for $x$. Therefore, there are no real curves in the $(x,y)$-plane where $D(x)=0$. The PDE is never parabolic and does not exhibit any parabolic degeneracy.\n\n**(4) Implications for Characteristic Curves and Numerical Schemes**\n\nThe fact that the discriminant $D(x)$ is always positive has significant implications for the behavior of solutions and the choice of numerical methods.\n\n- **Characteristic Curves**: Since the PDE is hyperbolic everywhere ($D  0$), there exist two distinct families of real characteristic curves passing through any point in the $(x,y)$-plane. These curves represent paths along which information (or discontinuities in derivatives) propagates. The equation for the characteristic curves is given by $A\\,(dy)^2 - 2B\\,dy\\,dx + C\\,(dx)^2 = 0$. Substituting our coefficients:\n$$(1)(dy)^2 - 2(1-x)\\,dy\\,dx + (-(1+x^2))(dx)^2 = 0$$\nThe slopes of the characteristics, $\\frac{dy}{dx}$, are the roots of the quadratic equation:\n$$\\left(\\frac{dy}{dx}\\right)^2 - 2(1-x)\\frac{dy}{dx} - (1+x^2) = 0$$\nThe solutions for the slopes are $\\frac{dy}{dx} = (1-x) \\pm \\sqrt{(1-x)^2 + (1+x^2)} = (1-x) \\pm \\sqrt{2x^2-2x+2}$. Since the term under the radical is precisely the discriminant $D(x) = 2x^2-2x+2$, which is always positive, there are always two distinct real slopes. This structure is typical of wave-like phenomena.\n\n- **Numerical Schemes**: The classification dictates the appropriate class of numerical algorithms. For **hyperbolic** equations like this one, initial value problems are typically posed (e.g., specifying $u$ and its time derivative at an initial time). Numerical methods must respect the direction of information flow along characteristics. Suitable schemes include explicit finite difference methods (like upwind, Lax-Friedrichs, or MacCormack schemes) or method of characteristics. These explicit methods are often subject to a stability constraint, the Courant-Friedrichs-Lewy (CFL) condition, which limits the size of the time step relative to the spatial grid spacing to ensure the numerical domain of dependence captures the true physical domain of dependence.\n\nIn contrast, had the PDE been **elliptic** ($D  0$), it would model a steady-state process, and solutions would be determined by boundary conditions on a closed domain. Appropriate numerical methods would be iterative solvers like Jacobi or Gauss-Seidel for the resulting system of linear equations.\n\nSince the given PDE is hyperbolic everywhere, a numerical scheme designed for hyperbolic systems can be applied uniformly across the entire computational domain. There is no need for hybrid schemes that switch between elliptic and hyperbolic solvers, which would be necessary for a mixed-type PDE.", "answer": "$$\\boxed{2x^{2} - 2x + 2}$$", "id": "3371537"}, {"introduction": "The classification based on the discriminant $B^2 - AC$ is not merely an analytical artifact; it makes a profound prediction about the qualitative behavior of the system's solutions and the stability of its numerical discretizations. This practice [@problem_id:3371504] provides a powerful computational validation of this principle. You will numerically compute the full spectrum of eigenvalues for a discretized PDE operator and demonstrate how the signs of these eigenvalues directly correspond to the analytically predicted elliptic, parabolic, or hyperbolic nature of the equation.", "problem": "Consider the family of constant-coefficient second-order linear partial differential operators in two spatial dimensions, parameterized by an angle $\\,\\theta\\,$:\n$$\nL_{\\theta} u \\;=\\; \\cos\\theta\\;u_{xx} \\;+\\; 2\\sin\\theta\\;u_{xy} \\;+\\; (1-\\cos\\theta)\\;u_{yy}.\n$$\nThe classification of a second-order linear partial differential equation in two variables in nondivergence form with principal part $\\,A\\,u_{xx} + 2B\\,u_{xy} + C\\,u_{yy}\\,$ is determined by the signature of the associated quadratic form, equivalently by the principal coefficient matrix\n$$\n\\mathbf{P} \\;=\\; \\begin{pmatrix} A  B \\\\ B  C \\end{pmatrix}\n$$\nvia the definiteness of $\\,\\mathbf{P}\\,$ or the sign of $\\,B^2 - A\\,C\\,$. The types are defined as follows:\n- Elliptic if the quadratic form is definite (both eigenvalues of $\\,\\mathbf{P}\\,$ have the same sign, equivalently $\\,B^2 - AC  0\\,$).\n- Hyperbolic if the quadratic form is indefinite (the eigenvalues have opposite signs, equivalently $\\,B^2 - AC  0\\,$).\n- Parabolic if the quadratic form is semidefinite and not definite (one eigenvalue is zero and the other nonzero, equivalently $\\,B^2 - AC = 0\\,$).\n\nYour task is to build a numerical benchmark that validates this classification by examining discrete spectrum signatures of a consistent centered-difference discretization on a periodic grid. Use the following requirements.\n\n1) Analytical classification from first principles:\n- Starting from the principal matrix $\\,\\mathbf{P}\\,$ associated with $\\,L_{\\theta}\\,$, deduce the type as a function of $\\,\\theta\\,$ by evaluating $\\,B^2 - A C\\,$. The derivation must begin from the definition above and not from any pre-memorized shortcut.\n\n2) Numerical validation via discrete spectrum signatures:\n- Work on the unit periodic square $[0,1)\\times[0,1)$ with an $\\,N\\times N\\,$ uniform grid, where $\\,N\\,$ is a positive integer. Use equal mesh spacings in both directions. Implement the centered-difference approximations for $\\,u_{xx}\\,$, $\\,u_{yy}\\,$, and $\\,u_{xy}\\,$ with periodic wrap-around (periodic boundary conditions). Then, use the discrete Fourier diagonalization of the resulting circulant operators to obtain the full set of discrete eigenvalues. The computation must be completely self-contained and cannot rely on any external files or user input.\n- Define the discrete spectrum signature-based classification as follows, using a numerical tolerance $\\,\\tau  0\\,$ to identify near-zeros:\n  - Hyperbolic-like if there exist at least one strictly positive and at least one strictly negative discrete eigenvalue (positivity/negativity tested relative to $\\,\\tau\\,$).\n  - Parabolic-like if all discrete eigenvalues are of one sign or zero and there exists at least one eigenvalue whose absolute value is at or below $\\,\\tau\\,$ (i.e., semidefinite with nontrivial nullspace).\n  - Elliptic-like if all discrete eigenvalues are strictly positive or all are strictly negative relative to $\\,\\tau\\,$ and none are at or below $\\,\\tau\\,$ in magnitude.\n\n3) Test suite and verification:\n- Use $\\,N = 129\\,$ grid points in each direction.\n- Use the numerical zero tolerance $\\,\\tau = 10^{-12}\\,$.\n- Angles must be expressed in radians. The test suite of angle parameters is:\n  - $\\,\\theta_1 = 0.0\\,$,\n  - $\\,\\theta_2 = \\pi/4\\,$,\n  - $\\,\\theta_3 = \\pi\\,$,\n  - $\\,\\theta_4 = 2\\pi - 0.08\\,$,\n  - $\\,\\theta_5 = 0.08\\,$.\n- For each $\\,\\theta_i\\,$:\n  1. Predict the type (elliptic, hyperbolic, parabolic) analytically from first principles.\n  2. Compute the discrete eigenvalues on the $\\,N\\times N\\,$ periodic grid using the centered-difference stencils for $\\,u_{xx}\\,$, $\\,u_{yy}\\,$, and $\\,u_{xy}\\,$ as described. Classify the discrete spectrum into hyperbolic-like, parabolic-like, or elliptic-like using the above rules.\n  3. Output a boolean indicating whether the discrete classification matches the analytic prediction.\n\n4) Final output format:\n- Your program should produce a single line of output containing the results for the five test angles as a comma-separated list enclosed in square brackets. For example, the output must have the form\n$$\n[\\text{result}_1,\\text{result}_2,\\text{result}_3,\\text{result}_4,\\text{result}_5],\n$$\nwhere each $\\,\\text{result}_i\\,$ is either True or False. Angles are in radians. No physical units other than radians appear in the problem. There are no percentage expressions; all comparisons are direct boolean assertions.", "solution": "The problem requires a two-part analysis for a given family of second-order linear partial differential operators, $L_{\\theta}$, parameterized by an angle $\\theta$. First, we must classify the operator analytically based on its principal coefficients. Second, we must perform a numerical classification based on the spectrum of a finite difference discretization and verify that the two classifications agree for a set of test parameters.\n\nThe operator is given by:\n$$\nL_{\\theta} u \\;=\\; \\cos\\theta\\;u_{xx} \\;+\\; 2\\sin\\theta\\;u_{xy} \\;+\\; (1-\\cos\\theta)\\;u_{yy}\n$$\n\n### Part 1: Analytical Classification\n\nThe classification of a second-order linear PDE with the principal part $A\\,u_{xx} + 2B\\,u_{xy} + C\\,u_{yy}$ depends on the sign of the discriminant $D = B^2 - AC$.\nFrom the definition of $L_{\\theta}u$, we identify the coefficients:\n- $A = \\cos\\theta$\n- $B = \\sin\\theta$\n- $C = 1 - \\cos\\theta$\n\nNow, we compute the discriminant $D$ as a function of $\\theta$:\n$$\nD(\\theta) = B^2 - AC = (\\sin\\theta)^2 - (\\cos\\theta)(1 - \\cos\\theta)\n$$\nExpanding the expression:\n$$\nD(\\theta) = \\sin^2\\theta - \\cos\\theta + \\cos^2\\theta\n$$\nUsing the fundamental trigonometric identity $\\sin^2\\theta + \\cos^2\\theta = 1$, the discriminant simplifies to:\n$$\nD(\\theta) = 1 - \\cos\\theta\n$$\nThe classification is then determined by the value of $\\cos\\theta$:\n1.  **Elliptic**: $D(\\theta)  0 \\implies 1 - \\cos\\theta  0 \\implies \\cos\\theta  1$. This condition is never met for any real $\\theta$. Therefore, the operator $L_{\\theta}$ is never elliptic.\n2.  **Parabolic**: $D(\\theta) = 0 \\implies 1 - \\cos\\theta = 0 \\implies \\cos\\theta = 1$. This occurs when $\\theta = 2k\\pi$ for any integer $k$.\n3.  **Hyperbolic**: $D(\\theta)  0 \\implies 1 - \\cos\\theta  0 \\implies \\cos\\theta  1$. This is true for all $\\theta$ that are not integer multiples of $2\\pi$.\n\nBased on this analysis, we can predict the type for each test angle:\n- $\\theta_1 = 0.0$: $\\cos(0) = 1$, so $D(0) = 0$. The type is **Parabolic**.\n- $\\theta_2 = \\pi/4$: $\\cos(\\pi/4) = 1/\\sqrt{2}  1$, so $D(\\pi/4)  0$. The type is **Hyperbolic**.\n- $\\theta_3 = \\pi$: $\\cos(\\pi) = -1  1$, so $D(\\pi)  0$. The type is **Hyperbolic**.\n- $\\theta_4 = 2\\pi - 0.08$: $\\cos(2\\pi - 0.08) = \\cos(0.08)  1$, so $D(2\\pi - 0.08)  0$. The type is **Hyperbolic**.\n- $\\theta_5 = 0.08$: $\\cos(0.08)  1$, so $D(0.08)  0$. The type is **Hyperbolic**.\n\n### Part 2: Numerical Validation via Discrete Spectrum\n\nThe numerical validation uses a centered finite difference scheme on an $N \\times N$ periodic grid over the unit square $[0, 1) \\times [0, 1)$. The mesh size is $h = 1/N$. The discrete Fourier basis functions, $v_{m,n}(x_j, y_k) = e^{i(2\\pi m x_j + 2\\pi n y_k)} = e^{i(2\\pi m j h + 2\\pi n k h)}$, are eigenfunctions of any linear, constant-coefficient finite difference operator on such a grid. Here, $(x_j, y_k) = (jh, kh)$ are the grid points for $j, k \\in \\{0, 1, \\dots, N-1\\}$, and the integer wavenumbers $m, n$ also range from $0$ to $N-1$.\n\nThe eigenvalues of the standard second-order centered difference operators are:\n- For $\\partial_{xx}$: $\\hat{L}_{xx}(m) = \\frac{e^{i 2\\pi m h} - 2 + e^{-i 2\\pi m h}}{h^2} = \\frac{2\\cos(2\\pi m/N) - 2}{(1/N)^2} = N^2(2\\cos(2\\pi m/N) - 2)$.\n- For $\\partial_{yy}$: $\\hat{L}_{yy}(n) = N^2(2\\cos(2\\pi n/N) - 2)$.\n- For $\\partial_{xy}$: $\\hat{L}_{xy}(m, n) = \\frac{(e^{i 2\\pi m h} - e^{-i 2\\pi m h})(e^{i 2\\pi n h} - e^{-i 2\\pi n h})}{(2h)^2} = \\frac{(2i\\sin(2\\pi m/N))(2i\\sin(2\\pi n/N))}{4(1/N)^2} = -N^2 \\sin(2\\pi m/N)\\sin(2\\pi n/N)$.\n\nThe eigenvalue $\\lambda_{m,n}(\\theta)$ of the discrete operator $L_{\\theta,h}$ corresponding to the Fourier mode $(m, n)$ is a linear combination of the eigenvalues of the component operators:\n$$\n\\lambda_{m,n}(\\theta) = A \\cdot \\hat{L}_{xx}(m) + 2B \\cdot \\hat{L}_{xy}(m,n) + C \\cdot \\hat{L}_{yy}(n)\n$$\nSubstituting the coefficients $A, B, C$ and the operator eigenvalues:\n$$\n\\lambda_{m,n}(\\theta) = \\cos\\theta \\cdot \\hat{L}_{xx}(m) + 2\\sin\\theta \\cdot \\hat{L}_{xy}(m,n) + (1-\\cos\\theta) \\cdot \\hat{L}_{yy}(n)\n$$\n$$\n\\lambda_{m,n}(\\theta) = N^2 \\left[ \\cos\\theta(2\\cos(\\tfrac{2\\pi m}{N}) - 2) - 2\\sin\\theta \\sin(\\tfrac{2\\pi m}{N})\\sin(\\tfrac{2\\pi n}{N}) + (1-\\cos\\theta)(2\\cos(\\tfrac{2\\pi n}{N}) - 2) \\right]\n$$\nWe compute the full spectrum of $N^2$ eigenvalues by evaluating this formula for all $m, n \\in \\{0, 1, \\dots, N-1\\}$.\n\nThe numerical classification is then performed on the set of all eigenvalues $\\{\\lambda_{m,n}\\}$ using the tolerance $\\tau = 10^{-12}$:\n- Let `has_pos` be true if there is an eigenvalue $\\lambda  \\tau$.\n- Let `has_neg` be true if there is an eigenvalue $\\lambda  -\\tau$.\n- Let `has_near_zero` be true if there is an eigenvalue $|\\lambda| \\le \\tau$.\n\nThe rules are:\n- **Hyperbolic-like**: `has_pos` and `has_neg`.\n- **Parabolic-like**: not (`has_pos` and `has_neg`) and `has_near_zero`.\n- **Elliptic-like**: not (`has_pos` and `has_neg`) and not `has_near_zero`.\n\nFor each test angle, we will generate the analytical type string ('parabolic', 'hyperbolic') and the numerical type string ('parabolic-like', 'hyperbolic-like', 'elliptic-like'). A match occurs if the base names are identical (e.g., 'parabolic' matches 'parabolic-like'). The final output will be a list of booleans indicating this match for each angle. Based on our analysis, we expect the numerical classification to align perfectly with the analytical one for all test cases.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem by performing analytical and numerical classification\n    of a second-order linear PDE and comparing the results.\n    \"\"\"\n    \n    # Define the problem parameters from the statement.\n    N = 129\n    tau = 1e-12\n    test_angles = [\n        0.0,\n        np.pi / 4.0,\n        np.pi,\n        2.0 * np.pi - 0.08,\n        0.08,\n    ]\n\n    def get_analytical_type(theta):\n        \"\"\"\n        Classifies the PDE analytically based on the discriminant B^2 - AC.\n        The discriminant for the given operator is 1 - cos(theta).\n        \"\"\"\n        discriminant = 1.0 - np.cos(theta)\n        # Use a small tolerance for floating point comparison to zero\n        if np.isclose(discriminant, 0.0):\n            return \"parabolic\"\n        elif discriminant > 0.0:\n            return \"hyperbolic\"\n        else: # discriminant  0\n            return \"elliptic\"\n\n    def get_numerical_type(theta, N, tau):\n        \"\"\"\n        Classifies the PDE numerically based on the spectrum of the\n        finite difference operator on a periodic grid.\n        \"\"\"\n        # Create 2D grids for wavenumbers m and n\n        m_vals = np.arange(N)\n        n_vals = np.arange(N)\n        m, n = np.meshgrid(m_vals, n_vals, indexing='ij')\n\n        # Angular frequencies for Fourier modes\n        omega_m = 2.0 * np.pi * m / N\n        omega_n = 2.0 * np.pi * n / N\n\n        # Eigenvalues of the discrete operators for u_xx, u_xy, u_yy\n        eig_xx = N**2 * (2.0 * np.cos(omega_m) - 2.0)\n        eig_xy = -N**2 * np.sin(omega_m) * np.sin(omega_n)\n        eig_yy = N**2 * (2.0 * np.cos(omega_n) - 2.0)\n        \n        # Coefficients of the PDE\n        A = np.cos(theta)\n        B = np.sin(theta)\n        C = 1.0 - np.cos(theta)\n\n        # Full spectrum of the discrete operator L_theta\n        eigenvalues = (A * eig_xx + 2.0 * B * eig_xy + C * eig_yy).flatten()\n        \n        # Classify the spectrum based on the problem's rules\n        has_pos = np.any(eigenvalues > tau)\n        has_neg = np.any(eigenvalues  -tau)\n        has_near_zero = np.any(np.abs(eigenvalues) = tau)\n\n        if has_pos and has_neg:\n            return \"hyperbolic-like\"\n        elif has_near_zero:\n            # This branch is taken if not hyperbolic, but has near-zero eigenvalues.\n            # This implies all eigenvalues are of one sign (or zero).\n            return \"parabolic-like\"\n        else:\n            # This branch is taken if not hyperbolic and no near-zero eigenvalues.\n            # This implies all eigenvalues are strictly positive or strictly negative.\n            return \"elliptic-like\"\n\n    results = []\n    for theta in test_angles:\n        analytical_type = get_analytical_type(theta)\n        numerical_type = get_numerical_type(theta, N, tau)\n        \n        # The verification check requires matching the base type\n        # e.g., \"hyperbolic\" should match \"hyperbolic-like\"\n        match = (analytical_type == numerical_type.replace('-like', ''))\n        results.append(match)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```", "id": "3371504"}]}