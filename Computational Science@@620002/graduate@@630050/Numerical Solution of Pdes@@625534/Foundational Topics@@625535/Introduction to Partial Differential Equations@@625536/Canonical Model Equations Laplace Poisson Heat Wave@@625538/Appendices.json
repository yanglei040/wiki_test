{"hands_on_practices": [{"introduction": "Before we can effectively solve a partial differential equation numerically, it is invaluable to understand the intrinsic character of its solutions. This practice delves into the analytical core of the one-dimensional heat equation using the classic method of separation of variables. By decomposing the solution into a series of fundamental modes, you will gain direct insight into how heat diffuses over time, with each mode decaying at a specific rate [@problem_id:3367932].", "problem": "Consider the one-dimensional heat conduction governed by the heat equation, derived from conservation of energy and Fourier’s law of heat conduction, on the spatial interval $(0,L)$:\n$$\nu_{t}(x,t) = \\kappa\\, u_{xx}(x,t), \\quad x \\in (0,L), \\ t > 0,\n$$\nwith homogeneous Dirichlet boundary conditions\n$$\nu(0,t) = 0, \\quad u(L,t) = 0, \\quad t > 0,\n$$\nand an initial temperature distribution\n$$\nu(x,0) = f(x), \\quad x \\in (0,L),\n$$\nwhere $\\kappa > 0$ is a constant thermal diffusivity and $f$ is square-integrable on $(0,L)$. Starting from the fundamental definitions and laws (conservation of energy and Fourier’s law) that lead to the heat equation, use separation of variables to derive the spatial eigenvalue problem implied by the boundary conditions, obtain the complete orthogonal eigenbasis on $(0,L)$, and then express the solution $u(x,t)$ as a sine series with time-dependent coefficients exhibiting exponential decay. From this derivation, compute the general expression for the modal decay rate associated with the $n$-th sine mode. Your final reported quantity should be the closed-form analytic expression for the $n$-th modal decay rate as a function of $n$, $L$, and $\\kappa$. No numerical rounding is required, and no physical units should be included in your reported final expression.", "solution": "The problem asks for the modal decay rate of the 1D heat equation, which can be found using the method of separation of variables.\n\n1.  **Assume a Separable Solution**: We assume the solution can be written as a product of a function of space only and a function of time only: $u(x,t) = X(x)T(t)$.\n\n2.  **Substitute into the PDE**: Substituting this form into the heat equation $u_t = \\kappa u_{xx}$ gives $X(x)T'(t) = \\kappa X''(x)T(t)$.\n\n3.  **Separate Variables**: We rearrange the equation to group terms by variable:\n    $$\\frac{T'(t)}{\\kappa T(t)} = \\frac{X''(x)}{X(x)}$$\n    Since the left side depends only on $t$ and the right side only on $x$, both must be equal to a separation constant. For solutions to decay in time, this constant must be negative, which we denote as $-\\lambda^2$.\n\n4.  **Formulate Ordinary Differential Equations (ODEs)**: This leads to two ODEs:\n    -   Temporal ODE: $T'(t) = -\\lambda^2 \\kappa T(t)$\n    -   Spatial ODE (Eigenvalue Problem): $X''(x) + \\lambda^2 X(x) = 0$\n\n5.  **Solve the Spatial Problem**: We solve the spatial ODE with the given boundary conditions $u(0,t)=0 \\implies X(0)=0$ and $u(L,t)=0 \\implies X(L)=0$. The general solution for $X(x)$ is $X(x) = A \\cos(\\lambda x) + B \\sin(\\lambda x)$.\n    -   Applying $X(0)=0$ gives $A \\cos(0) + B \\sin(0) = A = 0$.\n    -   The solution becomes $X(x) = B \\sin(\\lambda x)$.\n    -   Applying $X(L)=0$ gives $B \\sin(\\lambda L) = 0$. For a non-trivial solution ($B \\neq 0$), we must have $\\sin(\\lambda L) = 0$, which implies $\\lambda L = n\\pi$ for integers $n = 1, 2, 3, \\ldots$.\n    -   This defines the eigenvalues $\\lambda_n = \\frac{n\\pi}{L}$, and the corresponding eigenfunctions are $X_n(x) = \\sin(\\frac{n\\pi x}{L})$.\n\n6.  **Solve the Temporal Problem**: For each eigenvalue $\\lambda_n$, the temporal ODE is:\n    $$T_n'(t) = -\\lambda_n^2 \\kappa T_n(t) = -\\left(\\frac{n\\pi}{L}\\right)^2 \\kappa T_n(t)$$\n    The solution is an exponential decay:\n    $$T_n(t) = C_n \\exp\\left(-\\kappa \\left(\\frac{n\\pi}{L}\\right)^2 t\\right)$$\n    where $C_n$ are constants determined by the initial condition $f(x)$.\n\n7.  **Identify the Modal Decay Rate**: The full solution is a superposition of these modes: $u(x,t) = \\sum_{n=1}^{\\infty} C_n X_n(x) T_n(t)$. The time-dependent part of the $n$-th mode, $T_n(t)$, has the form $C_n e^{-\\gamma_n t}$. The quantity $\\gamma_n$ is the decay rate for that mode. By inspection, this rate is:\n    $$\\gamma_n = \\kappa \\left(\\frac{n\\pi}{L}\\right)^2 = \\kappa \\frac{n^2 \\pi^2}{L^2}$$\nThis is the required expression.", "answer": "$$\\boxed{\\kappa \\frac{n^2 \\pi^2}{L^2}}$$", "id": "3367932"}, {"introduction": "Many numerical algorithms are most easily applied to problems with homogeneous boundary conditions, yet real-world scenarios often present inhomogeneous data. This exercise introduces the powerful and practical technique of 'lifting' to bridge this gap for the Poisson equation. You will learn to transform a problem with non-zero Dirichlet boundary data into an equivalent one with zero boundary data by constructing a suitable function and modifying the equation's source term, a crucial pre-processing step in computational science [@problem_id:3367912].", "problem": "Consider the Poisson equation on the unit square domain $\\Omega = (0,1) \\times (0,1)$ with inhomogeneous Dirichlet boundary data:\n$$\n-\\Delta u = f \\quad \\text{in } \\Omega, \\qquad u = g \\quad \\text{on } \\partial \\Omega,\n$$\nwhere $f(x,y) = x + y^{2}$ and $g(x,y) = x^{2} + y$. Without invoking any pre-packaged boundary-reduction formulas, proceed from the linearity of the Laplacian operator and the definition of weak derivatives to eliminate the inhomogeneous Dirichlet boundary condition by constructing an explicit lifting function $\\ell$ that matches the boundary values, and defining a new unknown $v$ with homogeneous Dirichlet boundary condition. Derive the strong-form equation satisfied by $v$ in $\\Omega$ and compute the modified right-hand side as an explicit analytic function of $x$ and $y$. Your final answer must be the single analytic expression for the modified right-hand side (no units; no rounding required).", "solution": "The problem requires us to transform the given Poisson equation with inhomogeneous Dirichlet boundary conditions into an equivalent problem with homogeneous Dirichlet boundary conditions. The original problem is:\n$$\n-\\Delta u = f \\quad \\text{in } \\Omega = (0,1) \\times (0,1)\n$$\n$$\nu = g \\quad \\text{on } \\partial \\Omega\n$$\nwhere the source term is $f(x,y) = x + y^{2}$ and the boundary data is $g(x,y) = x^{2} + y$.\n\nThe method involves decomposing the solution $u(x,y)$ into the sum of two functions:\n$$\nu(x,y) = v(x,y) + \\ell(x,y)\n$$\nHere, $\\ell(x,y)$ is a \"lifting function\" that we must construct, and $v(x,y)$ is the new unknown function. The goal is to define $v$ and $\\ell$ such that the problem for $v$ features homogeneous Dirichlet boundary conditions.\n\nLet us impose the condition that $v=0$ on the boundary $\\partial\\Omega$. Evaluating the decomposition on the boundary, we have:\n$$\nu|_{\\partial\\Omega} = v|_{\\partial\\Omega} + \\ell|_{\\partial\\Omega}\n$$\nSubstituting the known boundary conditions $u|_{\\partial\\Omega} = g$ and our desired condition $v|_{\\partial\\Omega} = 0$, we obtain the necessary condition for the lifting function $\\ell$:\n$$\ng = 0 + \\ell|_{\\partial\\Omega} \\implies \\ell(x,y) = g(x,y) \\quad \\text{for } (x,y) \\in \\partial\\Omega\n$$\nWe need to construct a function $\\ell(x,y)$ defined over the entire domain $\\Omega$ that is sufficiently smooth and matches the boundary data $g(x,y) = x^{2} + y$ on $\\partial\\Omega$. There are infinitely many such functions. The problem asks for an explicit construction. The simplest choice is to extend the function $g(x,y)$ itself over the whole domain. Let us define our lifting function as:\n$$\n\\ell(x,y) = x^{2} + y\n$$\nThis function is a polynomial, and thus is infinitely differentiable (i.e., $C^{\\infty}$) on $\\Omega$. By its very definition, it matches $g(x,y)$ on the boundary $\\partial\\Omega$.\n\nNow, we derive the strong-form equation for $v$. We substitute the decomposition $u = v + \\ell$ into the original Poisson equation:\n$$\n-\\Delta(v + \\ell) = f\n$$\nThe Laplacian operator, $\\Delta = \\frac{\\partial^{2}}{\\partial x^{2}} + \\frac{\\partial^{2}}{\\partial y^{2}}$, is a linear operator. Therefore, we can distribute it over the sum:\n$$\n-(\\Delta v + \\Delta \\ell) = f\n$$\n$$\n-\\Delta v - \\Delta \\ell = f\n$$\nRearranging this equation to isolate the term involving the new unknown $v$, we obtain the Poisson equation for $v$:\n$$\n-\\Delta v = f + \\Delta \\ell\n$$\nThis new equation for $v$ is defined on the same domain $\\Omega$, but it is now paired with a homogeneous Dirichlet boundary condition, $v=0$ on $\\partial\\Omega$.\n\nThe task is to find the modified right-hand side, which we can denote as $f_{\\text{mod}}$. This is given by:\n$$\nf_{\\text{mod}}(x,y) = f(x,y) + \\Delta \\ell(x,y)\n$$\nWe need to compute the Laplacian of our chosen lifting function, $\\Delta \\ell$.\nGiven $\\ell(x,y) = x^{2} + y$, we find its second partial derivatives:\nThe first partial derivatives are:\n$$\n\\frac{\\partial \\ell}{\\partial x} = \\frac{\\partial}{\\partial x}(x^{2} + y) = 2x\n$$\n$$\n\\frac{\\partial \\ell}{\\partial y} = \\frac{\\partial}{\\partial y}(x^{2} + y) = 1\n$$\nThe second partial derivatives are:\n$$\n\\frac{\\partial^{2} \\ell}{\\partial x^{2}} = \\frac{\\partial}{\\partial x}(2x) = 2\n$$\n$$\n\\frac{\\partial^{2} \\ell}{\\partial y^{2}} = \\frac{\\partial}{\\partial y}(1) = 0\n$$\nThe Laplacian of $\\ell$ is the sum of these pure second partial derivatives:\n$$\n\\Delta \\ell = \\frac{\\partial^{2} \\ell}{\\partial x^{2}} + \\frac{\\partial^{2} \\ell}{\\partial y^{2}} = 2 + 0 = 2\n$$\nNow we can compute the modified right-hand side, $f_{\\text{mod}}(x,y)$, by substituting the given function $f(x,y)$ and the calculated $\\Delta \\ell$:\n$$\nf_{\\text{mod}}(x,y) = (x + y^{2}) + 2\n$$\n$$\nf_{\\text{mod}}(x,y) = x + y^{2} + 2\n$$\nThis is the explicit analytic function for the modified right-hand side of the new Poisson equation for $v$.", "answer": "$$\\boxed{x + y^{2} + 2}$$", "id": "3367912"}, {"introduction": "In many physical applications, from fluid dynamics to electromagnetism, accurately capturing and conserving fluxes is paramount. This advanced practice guides you through the implementation of a mixed finite volume method for the Poisson equation, where the flux itself is treated as a primary unknown alongside the pressure. This approach [@problem_id:3367898] leads to a numerical scheme that enforces local conservation by design, providing a robust foundation for building physically faithful simulation tools.", "problem": "Consider the canonical Poisson equation on a bounded Lipschitz domain $\\Omega \\subset \\mathbb{R}^2$ with outward unit normal $\\boldsymbol{n}$, written in the mixed form by introducing the flux $\\boldsymbol{\\sigma} = -\\nabla u$ (with $u$ interpreted as pressure):\n$$\n\\boldsymbol{\\sigma} + \\nabla u = \\boldsymbol{0} \\quad \\text{in } \\Omega, \\qquad \\nabla \\cdot \\boldsymbol{\\sigma} = f \\quad \\text{in } \\Omega,\n$$\nwith Neumann boundary condition\n$$\n\\boldsymbol{\\sigma} \\cdot \\boldsymbol{n} = g \\quad \\text{on } \\partial \\Omega.\n$$\nAssume the global compatibility condition $\\int_{\\Omega} f\\, \\mathrm{d}\\boldsymbol{x} = \\int_{\\partial \\Omega} g\\, \\mathrm{d}s$ holds, and set the pressure mean to zero to remove the nullspace ambiguity. The mixed weak formulation seeks $\\boldsymbol{\\sigma} \\in H(\\mathrm{div};\\Omega)$ and $u \\in L^2(\\Omega)$ such that local conservation is enforced cellwise.\n\nYour task is to:\n- Start from the fundamental definitions of the Sobolev space $H(\\mathrm{div};\\Omega)$, the divergence operator, and the mixed formulation of the Poisson equation.\n- Design $H(\\mathrm{div})$-conforming lowest-order Raviart–Thomas elements (also known as $\\mathrm{RT}_0$) on a Cartesian partition of the unit square domain $\\Omega = [0,1]^2$ into $N_x \\times N_y$ rectangles, where the $H(\\mathrm{div})$ conformity enforces continuity of the normal flux across inter-element faces.\n- Derive a discrete scheme that enforces exact local conservation of fluxes on each cell, expressed as the equality between the sum of outward normal fluxes through the cell faces and the cellwise integral of the source $f$, under the Neumann boundary prescription $\\boldsymbol{\\sigma}\\cdot \\boldsymbol{n} = g$ on boundary faces.\n- Implement this scheme on orthogonal uniform Cartesian grids for isotropic unit conductivity, which reduces to a cell-centered two-point flux approximation consistent with the mixed $\\mathrm{RT}_0$ method on such grids.\n- Enforce a zero-mean condition for $u$ through an algebraic constraint to ensure uniqueness.\n\nProgram requirements:\n- Implement the described method for the unit square $\\Omega = [0,1]^2$ with uniform spacings $\\Delta x = 1/N_x$, $\\Delta y = 1/N_y$.\n- Use midpoint quadrature to approximate $\\int_{\\text{cell}} f\\,\\mathrm{d}\\boldsymbol{x}$ and exact face-length scaling for the boundary flux contribution $\\int_{\\text{face}} g\\,\\mathrm{d}s$ via $g$ evaluated at the face midpoint times the face length.\n- Assemble a symmetric linear system in the cell pressures with an additional Lagrange multiplier to enforce the zero-mean pressure constraint, solve it, and then compute the cellwise net flux imbalance defined by the absolute value of\n$$\n\\left(\\sum_{\\text{faces of the cell}} \\text{outward flux}\\right) - \\left(\\int_{\\text{cell}} f\\,\\mathrm{d}\\boldsymbol{x}\\right).\n$$\n\nTest suite:\nFor each of the following parameter sets, construct the grid, source $f$, and boundary flux $g$, compute the solution, and report the maximum absolute local conservation residual over all cells as a floating-point number.\n\n- Test Case 1 (happy path with nontrivial boundary flux):\n  - Grid: $N_x = N_y = 8$.\n  - Source: $f(x,y) = 0$.\n  - Boundary flux from a linear pressure $u(x,y) = x + y$ yielding $\\boldsymbol{\\sigma} = -\\nabla u = (-1,-1)$:\n    - Left boundary ($x=0$): $g = 1$.\n    - Right boundary ($x=1$): $g = -1$.\n    - Bottom boundary ($y=0$): $g = 1$.\n    - Top boundary ($y=1$): $g = -1$.\n- Test Case 2 (constant source consistent with uniform boundary flux):\n  - Grid: $N_x = N_y = 16$.\n  - Source: $f(x,y) = 1$ for all $(x,y)$.\n  - Boundary flux: constant $g = 0.25$ on all boundaries, which satisfies $\\int_{\\Omega} f\\,\\mathrm{d}\\boldsymbol{x} = 1$ and $\\int_{\\partial \\Omega} g\\,\\mathrm{d}s = 4 \\times 0.25 = 1$.\n- Test Case 3 (edge case single cell):\n  - Grid: $N_x = N_y = 1$.\n  - Source: $f(x,y) = 0.5$ for all $(x,y)$.\n  - Boundary flux: constant $g = 0.125$ on all boundaries, which satisfies $\\int_{\\Omega} f\\,\\mathrm{d}\\boldsymbol{x} = 0.5$ and $\\int_{\\partial \\Omega} g\\,\\mathrm{d}s = 4 \\times 0.125 = 0.5$.\n\nFinal output specification:\n- Your program should produce a single line of output containing the results of the three test cases as a comma-separated list enclosed in square brackets, in the order given above, i.e., $[\\text{residual}_1,\\text{residual}_2,\\text{residual}_3]$.\n- Each residual must be a floating-point number.", "solution": "The user wants to solve the Poisson equation in mixed form using a cell-centered finite volume method, which is equivalent to the lowest-order Raviart-Thomas ($\\mathrm{RT}_0$) mixed finite element method on a uniform Cartesian grid. The solution must enforce local mass conservation and handle the null-space of the pure Neumann problem by enforcing a zero-mean pressure condition.\n\n### 1. Mathematical Formulation\n\nThe governing equations are the mixed form of the Poisson equation on a domain $\\Omega \\subset \\mathbb{R}^2$:\n$$\n\\boldsymbol{\\sigma} + \\nabla u = \\boldsymbol{0} \\quad \\text{in } \\Omega,\n$$\n$$\n\\nabla \\cdot \\boldsymbol{\\sigma} = f \\quad \\text{in } \\Omega.\n$$\nHere, $u$ is the scalar potential (pressure), $\\boldsymbol{\\sigma}$ is the flux vector, and $f$ is a source term. The problem assumes unit isotropic conductivity, which is why the coefficient in front of $\\nabla u$ is $1$. The system is subject to the Neumann boundary condition:\n$$\n\\boldsymbol{\\sigma} \\cdot \\boldsymbol{n} = g \\quad \\text{on } \\partial \\Omega,\n$$\nwhere $\\boldsymbol{n}$ is the outward unit normal to the boundary $\\partial \\Omega$. For a solution to exist, the problem must satisfy the compatibility condition:\n$$\n\\int_{\\Omega} f\\, \\mathrm{d}\\boldsymbol{x} = \\int_{\\partial \\Omega} g\\, \\mathrm{d}s.\n$$\nThis condition states that the total source within the domain must equal the total flux across its boundary.\n\n### 2. Discretization: Cell-Centered Finite Volume Method\n\nWe discretize the domain $\\Omega = [0,1]^2$ into a grid of $N_x \\times N_y$ rectangular cells, indexed by $(i,j)$ for $i \\in \\{0, \\dots, N_x-1\\}$ and $j \\in \\{0, \\dots, N_y-1\\}$. Each cell $K_{i,j}$ has dimensions $\\Delta x = 1/N_x$ and $\\Delta y = 1/N_y$. The pressure $u$ is approximated as a piecewise constant function, with a single value $u_{i,j}$ at the center of each cell $(x_i, y_j)$.\n\nThe core principle of the finite volume method is to enforce conservation locally on each cell. We integrate the divergence equation $\\nabla \\cdot \\boldsymbol{\\sigma} = f$ over a cell $K_{i,j}$:\n$$\n\\int_{K_{i,j}} \\nabla \\cdot \\boldsymbol{\\sigma} \\, \\mathrm{d}\\boldsymbol{x} = \\int_{K_{i,j}} f \\, \\mathrm{d}\\boldsymbol{x}.\n$$\nApplying the Divergence Theorem to the left-hand side transforms the volume integral into a surface integral over the cell's boundary $\\partial K_{i,j}$:\n$$\n\\oint_{\\partial K_{i,j}} \\boldsymbol{\\sigma} \\cdot \\boldsymbol{n}_{K} \\, \\mathrm{d}s = \\int_{K_{i,j}} f \\, \\mathrm{d}\\boldsymbol{x},\n$$\nwhere $\\boldsymbol{n}_{K}$ is the outward normal for cell $K_{i,j}$. The left-hand side represents the total outward flux from the cell, and the right-hand side is the total source within the cell.\n\nThe flux $\\boldsymbol{\\sigma}$ is related to the pressure $u$ by $\\boldsymbol{\\sigma} = -\\nabla u$. We approximate the normal flux across the face between two adjacent cells using a two-point flux approximation. For instance, the flux density in the x-direction across the vertical face between cell $(i,j)$ and $(i+1,j)$ is approximated by:\n$$\n\\sigma_x \\approx - \\frac{u_{i+1,j} - u_{i,j}}{\\Delta x}.\n$$\nThe total flux from cell $(i,j)$ to $(i+1,j)$ is this density multiplied by the face length $\\Delta y$. The term $\\frac{\\Delta y}{\\Delta x}$ is the transmissibility $T_x$ of the face. Similarly, $T_y = \\frac{\\Delta x}{\\Delta y}$ for horizontal faces.\n\nThe conservation equation for an interior cell $(i,j)$ becomes:\n$$\nT_x(u_{i,j} - u_{i+1,j}) + T_x(u_{i,j} - u_{i-1,j}) + T_y(u_{i,j} - u_{i,j+1}) + T_y(u_{i,j} - u_{i,j-1}) = f(x_i, y_j) \\Delta x \\Delta y.\n$$\nThe source integral is approximated using the midpoint rule. This equation relates the pressure in cell $(i,j)$ to that of its four neighbors.\n\nFor a cell on the domain boundary, one or more flux terms are given by the Neumann condition $\\boldsymbol{\\sigma} \\cdot \\boldsymbol{n} = g$. For example, for a cell $(0,j)$ on the left boundary, the outward flux through the left face is $\\int g \\, \\mathrm{d}s \\approx g(0, y_j) \\Delta y$. The conservation equation is modified accordingly.\n\n### 3. Linear System and Uniqueness\n\nAssembling the conservation equations for all $N = N_x N_y$ cells results in a linear system of the form $A\\boldsymbol{u} = \\boldsymbol{b}$, where $\\boldsymbol{u}$ is the vector of unknown cell pressures. The matrix $A$ is symmetric but singular; its null-space is spanned by the vector $\\boldsymbol{1} = (1, 1, \\dots, 1)^T$, reflecting that the pressure is only determined up to an additive constant.\n\nTo obtain a unique solution, we enforce the constraint that the mean pressure is zero. For a uniform grid, this is equivalent to $\\sum_{k=0}^{N-1} u_k = 0$. We incorporate this constraint using a Lagrange multiplier $\\lambda$, which leads to the augmented block matrix system:\n$$\n\\begin{pmatrix} A & \\boldsymbol{1} \\\\ \\boldsymbol{1}^T & 0 \\end{pmatrix} \\begin{pmatrix} \\boldsymbol{u} \\\\ \\lambda \\end{pmatrix} = \\begin{pmatrix} \\boldsymbol{b} \\\\ 0 \\end{pmatrix}.\n$$\nThis $(N+1) \\times (N+1)$ system is non-singular and can be solved to find the unique pressure vector $\\boldsymbol{u}$ and the Lagrange multiplier $\\lambda$.\n\n### 4. Local Conservation Residual\n\nThe problem requires calculating the cellwise flux imbalance, or local conservation residual, $R_k$ for each cell $k$:\n$$\nR_k = \\left| \\left(\\sum_{\\text{faces of cell } k} \\text{outward flux}\\right) - \\left(\\int_{\\text{cell } k} f\\,\\mathrm{d}\\boldsymbol{x}\\right) \\right|.\n$$\nThe linear system we constructed, $A\\boldsymbol{u} = \\boldsymbol{b}$, directly represents the conservation laws, i.e., $(\\text{net internal flux}) = (\\text{source}) - (\\text{boundary flux})$. The equation for cell $k$ is precisely $(\\text{Total outward flux})_k = (\\text{Integrated source})_k$. However, the solution $(\\boldsymbol{u}, \\lambda)$ in the augmented system satisfies $A\\boldsymbol{u} + \\boldsymbol{1}\\lambda = \\boldsymbol{b}$, which means $A\\boldsymbol{u} - \\boldsymbol{b} = -\\boldsymbol{1}\\lambda$.\n\nThe vector $A\\boldsymbol{u}-\\boldsymbol{b}$ represents the numerical residuals of the conservation laws. Thus, the residual for each cell $k$ is given by $(A\\boldsymbol{u} - \\boldsymbol{b})_k = -\\lambda$. The absolute local conservation residual is therefore uniform across all cells and is equal to $|\\lambda|$. The maximum residual is simply $|\\lambda|$. The value of $\\lambda$ represents the adjustment needed to satisfy the discrete compatibility condition, which may be non-zero due to numerical quadrature errors. For the given test cases with constant source and boundary data, quadrature is exact and we expect $\\lambda$ to be zero up to machine precision.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print results.\n    \"\"\"\n    test_cases = [\n        {\n            \"grid\": (8, 8),\n            \"f_func\": lambda x, y: 0.0,\n            \"g_func\": lambda x, y: 1.0 if np.isclose(x, 0.0) or np.isclose(y, 0.0) else -1.0\n        },\n        {\n            \"grid\": (16, 16),\n            \"f_func\": lambda x, y: 1.0,\n            \"g_func\": lambda x, y: 0.25\n        },\n        {\n            \"grid\": (1, 1),\n            \"f_func\": lambda x, y: 0.5,\n            \"g_func\": lambda x, y: 0.125\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        Nx, Ny = case[\"grid\"]\n        f_func = case[\"f_func\"]\n        g_func = case[\"g_func\"]\n        \n        dx = 1.0 / Nx\n        dy = 1.0 / Ny\n        N = Nx * Ny\n        \n        cell_centers_x = np.linspace(dx / 2.0, 1.0 - dx / 2.0, Nx)\n        cell_centers_y = np.linspace(dy / 2.0, 1.0 - dy / 2.0, Ny)\n        \n        # Assemble the N x N matrix A and N x 1 vector b for Au = b\n        A = np.zeros((N, N))\n        b = np.zeros(N)\n\n        T_x = dy / dx  # Transmissibility in x-direction\n        T_y = dx / dy  # Transmissibility in y-direction\n\n        for i in range(Nx):\n            for j in range(Ny):\n                k = i * Ny + j\n                \n                # Right-hand side source term\n                b[k] = f_func(cell_centers_x[i], cell_centers_y[j]) * dx * dy\n                \n                # Flux contributions to matrix A and RHS b\n                # Right face\n                if i < Nx - 1:\n                    kr = (i + 1) * Ny + j\n                    A[k, k] += T_x\n                    A[k, kr] -= T_x\n                else:  # Right boundary\n                    b[k] -= g_func(1.0, cell_centers_y[j]) * dy\n\n                # Left face\n                if i > 0:\n                    kl = (i - 1) * Ny + j\n                    A[k, k] += T_x\n                    A[k, kl] -= T_x\n                else:  # Left boundary\n                    b[k] -= g_func(0.0, cell_centers_y[j]) * dy\n                    \n                # Top face\n                if j < Ny - 1:\n                    kt = i * Ny + (j + 1)\n                    A[k, k] += T_y\n                    A[k, kt] -= T_y\n                else:  # Top boundary\n                    b[k] -= g_func(cell_centers_x[i], 1.0) * dx\n\n                # Bottom face\n                if j > 0:\n                    kb = i * Ny + (j - 1)\n                    A[k, k] += T_y\n                    A[k, kb] -= T_y\n                else:  # Bottom boundary\n                    b[k] -= g_func(cell_centers_x[i], 0.0) * dx\n\n        # Assemble the augmented (N+1)x(N+1) system\n        M = np.zeros((N + 1, N + 1))\n        rhs_aug = np.zeros(N + 1)\n\n        M[:N, :N] = A\n        M[:N, N] = 1.0  # Lagrange multiplier column (C^T)\n        M[N, :N] = 1.0  # Zero-mean constraint row (C)\n        \n        rhs_aug[:N] = b\n\n        # Solve the augmented system M * sol_aug = rhs_aug\n        sol_aug = np.linalg.solve(M, rhs_aug)\n        \n        # The last element of the solution is the Lagrange multiplier lambda\n        lambda_val = sol_aug[-1]\n        \n        # The maximum absolute local conservation residual is |lambda|\n        results.append(abs(lambda_val))\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3367898"}]}