{"hands_on_practices": [{"introduction": "The first step in analyzing a numerical scheme is to understand how accurately it approximates the target partial differential equation. This exercise introduces the powerful technique of the modified equation, which reveals the PDE that a scheme *actually* solves to a higher order. By performing a detailed Taylor series expansion of the Lax-Wendroff scheme, you will learn to identify and quantify the scheme's leading error terms, distinguishing between numerical dissipation and dispersion, which are crucial for understanding the scheme's qualitative behavior [@problem_id:3373281].", "problem": "Consider the constant-coefficient linear advection partial differential equation (PDE) $u_{t} + a\\,u_{x} = 0$ with $a \\in \\mathbb{R}$, $a \\neq 0$, posed on a uniform spatial grid with spacing $\\Delta x$ and time step $\\Delta t$. Let $u^{n}_{j}$ denote the numerical approximation to $u(x_{j}, t^{n})$ with $x_{j} = j \\,\\Delta x$ and $t^{n} = n\\,\\Delta t$. The two-step Taylor-based Lax–Wendroff scheme for this PDE updates $u^{n}_{j}$ by\n$$\nu^{n+1}_{j} \\;=\\; u^{n}_{j}\n\\;-\\;\\frac{a\\,\\Delta t}{2\\,\\Delta x}\\,\\bigl(u^{n}_{j+1} - u^{n}_{j-1}\\bigr)\n\\;+\\;\\frac{a^{2}\\,\\Delta t^{2}}{2\\,\\Delta x^{2}}\\,\\bigl(u^{n}_{j+1} - 2\\,u^{n}_{j} + u^{n}_{j-1}\\bigr).\n$$\nUsing only the fundamental definitions of consistency via Taylor expansion and the notion of a modified equation (an equivalent continuous PDE whose smooth solutions agree with the scheme up to a specified order), derive the modified equation satisfied by a smooth function $u(x,t)$ up to and including the lowest-order nonvanishing even- and odd-derivative correction terms beyond $u_{t}+a\\,u_{x}$. Express your result in the normalized form\n$$\nu_{t} + a\\,u_{x} \\;=\\; \\Delta x\\,\\alpha_{2}\\,u_{xx} \\;+\\; \\Delta x^{2}\\,\\alpha_{3}\\,u_{xxx} \\;+\\; \\text{higher-order terms},\n$$\nwhere the coefficients $\\alpha_{2}$ and $\\alpha_{3}$ depend on $a$, $\\Delta t$, and $\\Delta x$. Identify which of these terms are dissipative (even derivatives) and which are dispersive (odd derivatives), and determine $\\alpha_{2}$ and $\\alpha_{3}$ explicitly. You may introduce the Courant number $r = a\\,\\Delta t/\\Delta x$ provided your final expressions for $\\alpha_{2}$ and $\\alpha_{3}$ are quantified in terms of $a$, $\\Delta t$, and $\\Delta x$.\n\nReport, as your final answer, the row matrix containing $\\alpha_{2}$ and $\\alpha_{3}$ in that order. No numerical evaluation is required.", "solution": "The problem requires the derivation of the modified equation for the two-step Lax-Wendroff scheme applied to the linear advection equation $u_t + a u_x = 0$. The objective is to find the coefficients $\\alpha_2$ and $\\alpha_3$ in the normalized form of the modified equation:\n$$\nu_{t} + a\\,u_{x} \\;=\\; \\Delta x\\,\\alpha_{2}\\,u_{xx} \\;+\\; \\Delta x^{2}\\,\\alpha_{3}\\,u_{xxx} \\;+\\; \\text{higher-order terms}.\n$$\nThe derivation proceeds by performing a Taylor series expansion of each term in the numerical scheme around the point $(x_j, t_n)$, assuming that the numerical solution $u^n_j$ corresponds to a smooth function $u(x,t)$ at that point.\n\nThe given Lax-Wendroff scheme is:\n$$\nu^{n+1}_{j} \\;=\\; u^{n}_{j}\n\\;-\\;\\frac{a\\,\\Delta t}{2\\,\\Delta x}\\,\\bigl(u^{n}_{j+1} - u^{n}_{j-1}\\bigr)\n\\;+\\;\\frac{a^{2}\\,\\Delta t^{2}}{2\\,\\Delta x^{2}}\\,\\bigl(u^{n}_{j+1} - 2\\,u^{n}_{j} + u^{n}_{j-1}\\bigr).\n$$\nTo facilitate the analysis, we rearrange the scheme by dividing by $\\Delta t$:\n$$\n\\frac{u^{n+1}_{j} - u^{n}_{j}}{\\Delta t} \\;=\\; -\\frac{a}{2\\,\\Delta x}\\,\\bigl(u^{n}_{j+1} - u^{n}_{j-1}\\bigr)\n\\;+\\;\\frac{a^{2}\\,\\Delta t}{2\\,\\Delta x^{2}}\\,\\bigl(u^{n}_{j+1} - 2\\,u^{n}_{j} + u^{n}_{j-1}\\bigr).\n$$\nWe now expand each term as a Taylor series around $(x_j, t_n)$, where $u$ and its derivatives are evaluated.\n\nThe left-hand side (LHS) is the forward difference approximation for the time derivative:\n$$\n\\frac{u^{n+1}_{j} - u^{n}_{j}}{\\Delta t} = \\frac{u(x_j, t_n+\\Delta t) - u(x_j, t_n)}{\\Delta t} = u_t + \\frac{\\Delta t}{2}u_{tt} + \\frac{\\Delta t^2}{6}u_{ttt} + \\mathcal{O}(\\Delta t^3).\n$$\nThe right-hand side (RHS) consists of two terms involving spatial differences. The first term is the central difference approximation for $u_x$:\n$$\n-\\frac{a}{2\\,\\Delta x}\\,\\bigl(u^{n}_{j+1} - u^{n}_{j-1}\\bigr) = -\\frac{a}{2\\,\\Delta x} \\left[ \\left(u + \\Delta x u_x + \\frac{\\Delta x^2}{2}u_{xx} + \\frac{\\Delta x^3}{6}u_{xxx} + \\dots \\right) - \\left(u - \\Delta x u_x + \\frac{\\Delta x^2}{2}u_{xx} - \\frac{\\Delta x^3}{6}u_{xxx} + \\dots \\right) \\right]\n$$\n$$\n= -\\frac{a}{2\\,\\Delta x} \\left( 2\\Delta x u_x + \\frac{\\Delta x^3}{3}u_{xxx} + \\dots \\right) = -a u_x - \\frac{a \\Delta x^2}{6}u_{xxx} + \\mathcal{O}(\\Delta x^4).\n$$\nThe second term on the RHS is the central difference approximation for $u_{xx}$:\n$$\n\\frac{a^{2}\\,\\Delta t}{2\\,\\Delta x^{2}}\\,\\bigl(u^{n}_{j+1} - 2\\,u^{n}_{j} + u^{n}_{j-1}\\bigr) = \\frac{a^{2}\\,\\Delta t}{2\\,\\Delta x^{2}} \\left[ \\left(u + \\Delta x u_x + \\frac{\\Delta x^2}{2}u_{xx} + \\dots \\right) - 2u + \\left(u - \\Delta x u_x + \\frac{\\Delta x^2}{2}u_{xx} - \\dots \\right) \\right]\n$$\n$$\n= \\frac{a^{2}\\,\\Delta t}{2\\,\\Delta x^{2}} \\left( \\Delta x^2 u_{xx} + \\frac{\\Delta x^4}{12}u_{xxxx} + \\dots \\right) = \\frac{a^2 \\Delta t}{2}u_{xx} + \\frac{a^2 \\Delta t \\Delta x^2}{24}u_{xxxx} + \\mathcal{O}(\\Delta t \\Delta x^4).\n$$\nEquating the expanded LHS and RHS gives the expression for the local truncation error:\n$$\nu_t + \\frac{\\Delta t}{2}u_{tt} + \\frac{\\Delta t^2}{6}u_{ttt} + \\dots = -a u_x + \\frac{a^2 \\Delta t}{2}u_{xx} - \\frac{a \\Delta x^2}{6}u_{xxx} + \\dots\n$$\nRearranging to match the form of the original PDE, we get:\n$$\nu_t + a u_x = \\left(\\frac{a^2 \\Delta t}{2}u_{xx} - \\frac{\\Delta t}{2}u_{tt}\\right) - \\frac{a \\Delta x^2}{6}u_{xxx} - \\frac{\\Delta t^2}{6}u_{ttt} + \\text{h.o.t.}\n$$\nTo obtain the modified equation, we must express all time derivatives on the RHS in terms of spatial derivatives. This is done by repeatedly differentiating the modified equation itself. To the lowest order, the modified equation is $u_t = -a u_x$. We use this to substitute for higher time derivatives.\nThe operator relationship is $\\frac{\\partial}{\\partial t} \\approx -a \\frac{\\partial}{\\partial x}$.\nApplying this to $u_{tt}$ and $u_{ttt}$:\n$$\nu_{tt} = \\frac{\\partial}{\\partial t} u_t \\approx (-a\\frac{\\partial}{\\partial x})(-a u_x) = a^2 u_{xx}.\n$$\n$$\nu_{ttt} = \\frac{\\partial}{\\partial t} u_{tt} \\approx (-a\\frac{\\partial}{\\partial x})(a^2 u_{xx}) = -a^3 u_{xxx}.\n$$\nSubstituting these approximations back into the equation for $u_t+au_x$:\n$$\nu_t + a u_x \\approx \\left(\\frac{a^2 \\Delta t}{2}u_{xx} - \\frac{\\Delta t}{2}(a^2 u_{xx})\\right) - \\frac{a \\Delta x^2}{6}u_{xxx} - \\frac{\\Delta t^2}{6}(-a^3 u_{xxx}).\n$$\nWe group terms by the order of the spatial derivative:\nThe coefficient of the second derivative term, $u_{xx}$, is:\n$$\n\\frac{a^2 \\Delta t}{2} - \\frac{a^2 \\Delta t}{2} = 0.\n$$\nThe coefficient of the third derivative term, $u_{xxx}$, is:\n$$\n-\\frac{a \\Delta x^2}{6} - \\frac{\\Delta t^2(-a^3)}{6} = -\\frac{a \\Delta x^2}{6} + \\frac{a^3 \\Delta t^2}{6}.\n$$\nThus, the modified equation up to the third-order derivative term is:\n$$\nu_t + a u_x = \\left( -\\frac{a \\Delta x^2}{6} + \\frac{a^3 \\Delta t^2}{6} \\right) u_{xxx} + \\text{h.o.t.}\n$$\nThis equation reveals the nature of the leading-order error. The even-derivative term ($u_{xx}$), which corresponds to numerical dissipation, has a zero coefficient. The odd-derivative term ($u_{xxx}$), which corresponds to numerical dispersion, has a non-zero coefficient (unless the Courant number $r = a\\Delta t / \\Delta x$ has magnitude $1$). This indicates the scheme is dispersive. The lowest-order non-vanishing even-derivative term is of fourth order ($u_{xxxx}$), which ensures the scheme is dissipative for $|r|<1$.\n\nWe now match our result to the specified normalized form:\n$$\nu_{t} + a\\,u_{x} \\;=\\; \\Delta x\\,\\alpha_{2}\\,u_{xx} \\;+\\; \\Delta x^{2}\\,\\alpha_{3}\\,u_{xxx} \\;+\\; \\text{h.o.t.}\n$$\nBy comparing the coefficients, we find $\\alpha_2$ and $\\alpha_3$.\nFor the $u_{xx}$ term:\n$$\n\\Delta x\\,\\alpha_{2} = 0 \\quad \\implies \\quad \\alpha_{2} = 0.\n$$\nFor the $u_{xxx}$ term:\n$$\n\\Delta x^{2}\\,\\alpha_{3} = -\\frac{a \\Delta x^2}{6} + \\frac{a^3 \\Delta t^2}{6}.\n$$\nSolving for $\\alpha_3$:\n$$\n\\alpha_{3} = \\frac{1}{\\Delta x^2} \\left( -\\frac{a \\Delta x^2}{6} + \\frac{a^3 \\Delta t^2}{6} \\right) = -\\frac{a}{6} + \\frac{a^3 \\Delta t^2}{6 \\Delta x^2}.\n$$\nThe coefficients are thus determined. $\\alpha_2$ is zero, indicating an absence of second-order numerical dissipation. $\\alpha_3$ is non-zero in general, indicating the presence of third-order numerical dispersion.\n\nFinal expressions for the coefficients are:\n$\\alpha_2 = 0$.\n$\\alpha_3 = \\frac{a^3 \\Delta t^2}{6 \\Delta x^2} - \\frac{a}{6}$.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0 & \\frac{a^{3} \\Delta t^{2}}{6 \\Delta x^{2}} - \\frac{a}{6}\n\\end{pmatrix}\n}\n$$", "id": "3373281"}, {"introduction": "While consistency measures local accuracy, stability ensures that errors do not grow unboundedly as the computation proceeds, a requirement for convergence. This practice guides you through a foundational von Neumann stability analysis for a Discontinuous Galerkin scheme, which is equivalent to the classic first-order upwind method. By deriving the eigenvalues of the semi-discrete operator and analyzing the amplification factor of the time-stepping scheme, you will determine the precise Courant-Friedrichs-Lewy (CFL) condition required for a stable simulation [@problem_id:3373290].", "problem": "Consider the linear advection equation $u_{t} + a\\,u_{x} = 0$ on the periodic interval $[0,L]$, with constant speed $a>0$. Discretize the spatial domain with a uniform partition into $N$ cells of width $h = L/N$, and approximate the solution with the Discontinuous Galerkin (DG) method of polynomial degree $p=0$ (piecewise constants). Use the standard upwind numerical flux. Let $U_{j}(t)$ denote the cell average on cell $I_{j} = (x_{j-\\frac{1}{2}}, x_{j+\\frac{1}{2}})$.\n\nStarting from the weak form and the definition of the upwind numerical flux, derive the semi-discrete system satisfied by the vector of cell averages $\\{U_{j}(t)\\}_{j=1}^{N}$ and perform a discrete Fourier (modal) analysis on the periodic grid to obtain the eigenvalues of the semi-discrete advection operator as a function of the non-dimensional wavenumber $\\theta \\in [-\\pi,\\pi]$. Then, using these eigenvalues, determine the largest Courant number $\\nu = a\\,\\Delta t/h$ for which the explicit forward Euler time discretization is stable in the discrete $L^{2}$ norm on the grid.\n\nExpress your final answer as a single real number for the maximum admissible $\\nu$; no rounding is required.", "solution": "The user wants me to solve a problem about the stability of the Discontinuous Galerkin (DG) method for the linear advection equation.\n\n### Step 1: Problem Validation\n\n**1.1. Extract Givens**\n-   **Partial Differential Equation (PDE):** $u_{t} + a\\,u_{x} = 0$, with constant advection speed $a>0$.\n-   **Domain:** Periodic interval $[0,L]$.\n-   **Spatial Discretization:** Uniform partition into $N$ cells of width $h = L/N$. Cell $I_j$ is defined as $(x_{j-\\frac{1}{2}}, x_{j+\\frac{1}{2}})$.\n-   **Numerical Method:** Discontinuous Galerkin (DG) method with polynomial degree $p=0$. The discrete solution on cell $I_j$ is a constant, equal to the cell average $U_j(t)$.\n-   **Numerical Flux:** Standard upwind numerical flux.\n-   **Time Discretization:** Explicit forward Euler method.\n-   **Objective:**\n    1.  Derive the semi-discrete system for the cell averages $U_j(t)$.\n    2.  Perform a discrete Fourier analysis to find the eigenvalues of the semi-discrete operator as a function of the non-dimensional wavenumber $\\theta \\in [-\\pi,\\pi]$.\n    3.  Determine the largest Courant number $\\nu = a\\,\\Delta t/h$ for which the forward Euler scheme is stable in the discrete $L^2$ norm.\n\n**1.2. Validate Using Extracted Givens**\n-   **Scientifically Grounded:** The problem is a standard application of numerical analysis techniques (DG method, Fourier stability analysis) to a fundamental model equation (linear advection). All concepts are well-established in the field of numerical solutions for PDEs.\n-   **Well-Posed:** The problem is clearly stated and provides all necessary information to derive a unique, meaningful solution for the stability limit.\n-   **Objective:** The problem statement is precise, using standard mathematical and numerical analysis terminology. It is free of ambiguity and subjective claims.\n-   **Completeness and Consistency:** The problem is self-contained. The specified method (DG with $p=0$, upwind flux) is known to lead to a well-defined semi-discrete system. The request to use Fourier analysis is appropriate for the periodic boundary conditions. No contradictions are present.\n\n**1.3. Verdict and Action**\nThe problem is valid. I will now proceed with the solution.\n\n### Step 2: Derivation of the Semi-discrete System\n\nWe begin with the linear advection equation $u_t + a u_x = 0$. To derive the DG formulation, we multiply the PDE by a test function $v_h(x)$ and integrate over a single computational cell $I_j = [x_{j-1/2}, x_{j+1/2}]$.\n$$ \\int_{I_j} u_t v_h \\,dx + \\int_{I_j} a u_x v_h \\,dx = 0 $$\nFor the DG method with polynomial degree $p=0$, the approximate solution $u_h(x,t)$ is a piecewise constant function. On cell $I_j$, we have $u_h(x,t) = U_j(t)$. Similarly, the test function $v_h(x)$ is a piecewise constant, and we choose $v_h(x) = 1$ for $x \\in I_j$ and $v_h(x)=0$ otherwise.\n\nThe first term becomes:\n$$ \\int_{I_j} \\frac{\\partial U_j(t)}{\\partial t} (1) \\,dx = \\frac{d U_j}{dt} \\int_{I_j} \\,dx = h \\frac{d U_j}{dt} $$\nFor the second term, we integrate by parts:\n$$ \\int_{I_j} a u_x v_h \\,dx = a [u_h v_h]_{x_{j-1/2}}^{x_{j+1/2}} - \\int_{I_j} a u_h \\frac{dv_h}{dx} \\,dx $$\nSince the test function $v_h$ is constant on $I_j$, its derivative $\\frac{dv_h}{dx}$ is zero, so the integral on the right-hand side vanishes. The boundary term is:\n$$ a [u_h(x,t) v_h(x)]_{x_{j-1/2}}^{x_{j+1/2}} = a u_h(x_{j+1/2},t) v_h(x_{j+1/2}) - a u_h(x_{j-1/2},t) v_h(x_{j-1/2}) $$\nThe solution $u_h$ is discontinuous at cell interfaces. We must replace the value of $u_h$ at the interface with a single-valued numerical flux, denoted by $\\hat{u}$. The numerical flux for the term $au_x$ is $a\\hat{u}$.\nThe boundary term is therefore replaced by:\n$$ a \\hat{u}_{j+1/2} - a \\hat{u}_{j-1/2} $$\nwhere $\\hat{u}_{j+1/2}$ and $\\hat{u}_{j-1/2}$ are the numerical fluxes at the cell interfaces $x_{j+1/2}$ and $x_{j-1/2}$ respectively.\n\nThe semi-discrete formulation for cell $I_j$ is:\n$$ h \\frac{d U_j}{dt} + a \\hat{u}_{j+1/2} - a \\hat{u}_{j-1/2} = 0 $$\nThe problem specifies the upwind flux. Since the advection speed $a > 0$, information propagates from left to right. The \"upwind\" direction is the left side of any interface.\n-   At interface $x_{j+1/2}$, the state to the left is $U_j$ and the state to the right is $U_{j+1}$. The upwind choice is thus $\\hat{u}_{j+1/2} = U_j$.\n-   At interface $x_{j-1/2}$, the state to the left is $U_{j-1}$ and the state to the right is $U_j$. The upwind choice is thus $\\hat{u}_{j-1/2} = U_{j-1}$.\n\nSubstituting these fluxes into the semi-discrete equation gives:\n$$ h \\frac{d U_j}{dt} + a U_j - a U_{j-1} = 0 $$\nRearranging this yields the semi-discrete system of ordinary differential equations:\n$$ \\frac{d U_j}{dt} = -\\frac{a}{h} (U_j - U_{j-1}) $$\nThis is equivalent to the first-order upwind finite difference scheme.\n\n### Step 3: Discrete Fourier Analysis and Eigenvalues\n\nWe analyze the stability of this system on a periodic grid by seeking a modal solution of the form:\n$$ U_j(t) = \\hat{U}_\\theta(t) e^{i k x_j} $$\nwhere $x_j=jh$ is the coordinate of the cell center, $k$ is the wavenumber, and $\\theta = kh$ is the non-dimensional wavenumber. The ansatz becomes $U_j(t) = \\hat{U}_\\theta(t) e^{ij\\theta}$. Substituting this into the semi-discrete system:\n$$ \\frac{d}{dt} (\\hat{U}_\\theta e^{ij\\theta}) = -\\frac{a}{h} (\\hat{U}_\\theta e^{ij\\theta} - \\hat{U}_\\theta e^{i(j-1)\\theta}) $$\n$$ e^{ij\\theta} \\frac{d\\hat{U}_\\theta}{dt} = -\\frac{a}{h} \\hat{U}_\\theta e^{ij\\theta} (1 - e^{-i\\theta}) $$\nCanceling the common factor $\\hat{U}_\\theta e^{ij\\theta}$ yields the ODE for the modal amplitude $\\hat{U}_\\theta(t)$:\n$$ \\frac{d\\hat{U}_\\theta}{dt} = \\lambda(\\theta) \\hat{U}_\\theta $$\nwhere $\\lambda(\\theta)$ are the eigenvalues of the semi-discrete spatial operator.\n$$ \\lambda(\\theta) = -\\frac{a}{h} (1 - e^{-i\\theta}) $$\nFor $\\theta \\in [-\\pi, \\pi]$, these eigenvalues trace a curve in the complex plane.\n\n### Step 4: Stability of Forward Euler Time Discretization\n\nThe explicit forward Euler method applied to the semi-discrete system is:\n$$ \\frac{U_j^{n+1} - U_j^n}{\\Delta t} = -\\frac{a}{h} (U_j^n - U_{j-1}^n) $$\nApplying the Fourier mode analysis to this fully discrete scheme gives:\n$$ \\hat{U}_\\theta^{n+1} = \\hat{U}_\\theta^n + \\Delta t \\lambda(\\theta) \\hat{U}_\\theta^n = (1 + \\Delta t \\lambda(\\theta)) \\hat{U}_\\theta^n $$\nThe amplification factor is $g(\\theta) = 1 + \\Delta t \\lambda(\\theta)$. For stability in the discrete $L^2$ norm, we require $|g(\\theta)| \\le 1$ for all $\\theta \\in [-\\pi, \\pi]$.\nLet's substitute the expression for $\\lambda(\\theta)$ and the definition of the Courant number $\\nu = a \\Delta t / h$:\n$$ g(\\theta) = 1 + \\Delta t \\left( -\\frac{a}{h} (1 - e^{-i\\theta}) \\right) = 1 - \\nu (1 - e^{-i\\theta}) $$\nThe stability condition is $|1 - \\nu (1 - e^{-i\\theta})| \\le 1$.\nLet $z(\\theta) = \\Delta t \\lambda(\\theta) = -\\nu(1-e^{-i\\theta})$. The stability condition for forward Euler is that $z$ must lie within the region $|1+z| \\le 1$. This region is a circular disk in the complex plane centered at $(-1, 0)$ with radius $1$.\n\nLet's analyze the locus of points $z(\\theta)$ for $\\theta \\in [-\\pi, \\pi]$. The term $e^{-i\\theta}$ traces the unit circle clockwise. The term $1-e^{-i\\theta}$ traces a circle of radius $1$ centered at $(1,0)$. Multiplying by $-\\nu$ (for $\\nu > 0$) rotates and scales this circle. The resulting locus of $z(\\theta)$ is a circle centered at $(-\\nu, 0)$ with radius $\\nu$. This can be shown formally:\n$$ |z(\\theta) - (-\\nu)| = |-\\nu(1-e^{-i\\theta}) + \\nu| = |-\\nu + \\nu e^{-i\\theta} + \\nu| = |\\nu e^{-i\\theta}| = \\nu |e^{-i\\theta}| = \\nu $$\nSo, the eigenvalues scaled by $\\Delta t$ lie on a circle $|z+\\nu|=\\nu$.\n\nFor the scheme to be stable, this circle of eigenvalues, $|z+\\nu|=\\nu$, must be entirely contained within the stability region of the forward Euler method, $|1+z|\\le1$.\nThe stability region is a disk centered at $(-1,0)$ with radius $1$. It occupies the region of the complex plane with real parts between $-2$ and $0$.\nThe eigenvalue locus is a disk centered at $(-\\nu,0)$ with radius $\\nu$. It occupies the region of the complex plane with real parts between $-2\\nu$ and $0$.\n\nBoth regions are tangent at the origin $z=0$ (which corresponds to $\\theta=0$). The most restrictive condition comes from the leftmost point of the eigenvalue circle, which is at $z = -\\nu - \\nu = -2\\nu$. This point must lie within the stability region. The leftmost point of the stability region is $-1-1 = -2$.\nTherefore, we must have:\n$$ -2\\nu \\ge -2 $$\nDividing by $-2$ reverses the inequality:\n$$ \\nu \\le 1 $$\nSince $\\nu = a \\Delta t / h$ must be non-negative, the full condition is $0 \\le \\nu \\le 1$.\nThe largest admissible Courant number for stability is $1$.", "answer": "$$\\boxed{1}$$", "id": "3373290"}, {"introduction": "The Lax-Richtmyer Equivalence Theorem states that for a consistent linear scheme, stability is the necessary and sufficient condition for convergence. For nonlinear conservation laws, the story is more complex; consistency and conservation alone are not enough to ensure convergence to the physically relevant weak solution. This challenging exercise demonstrates this principle by having you construct a conservative and consistent scheme for Burgers' equation that is nevertheless unstable, showing how it converges to an entropy-violating, non-physical shock and highlighting the crucial role of stability in selecting the correct physical solution [@problem_id:3373303].", "problem": "Let $u(x,t)$ denote the solution of the scalar conservation law (Burgers' equation) $u_t + \\left(\\frac{1}{2}u^2\\right)_x = 0$ on $\\mathbb{R} \\times (0,\\infty)$, with Riemann initial data $u(x,0) = u_L$ for $x0$ and $u(x,0)=u_R$ for $x>0$. Consider a uniform mesh with spatial step $\\Delta x>0$ and time step $\\Delta t>0$, and denote $\\lambda = \\Delta t/\\Delta x$. A finite volume method is called conservative if it updates cell averages $\\{u_j^n\\}_{j \\in \\mathbb{Z}}$ via the flux-difference form $u_j^{n+1} = u_j^n - \\lambda \\left(F_{j+1/2}^n - F_{j-1/2}^n\\right)$, where $F_{j+1/2}^n$ is a two-argument numerical flux depending only on the adjacent states. A numerical flux $F(u_L,u_R)$ is called consistent with the physical flux $f(u) = \\frac{1}{2}u^2$ if $F(u,u) = f(u)$ for all $u \\in \\mathbb{R}$. A scheme is $L^1$-stable if there exists a constant $C$ independent of $\\Delta x$, $\\Delta t$, and $n$, such that $\\sum_{j \\in \\mathbb{Z}} |u_j^n - v_j^n| \\le C \\sum_{j \\in \\mathbb{Z}} |u_j^0 - v_j^0|$ for all $n \\ge 0$ and for any two solutions generated by the scheme from initial data $\\{u_j^0\\}$ and $\\{v_j^0\\}$. A weak solution to the conservation law is entropy-admissible if it satisfies the Lax entropy condition for shocks, or equivalently, if it is the vanishing-viscosity limit of $u_t + \\left(\\frac{1}{2}u^2\\right)_x = \\epsilon u_{xx}$ as $\\epsilon \\to 0^+$.\n\nYour tasks are:\n\n1. Starting from the conservation law structure and the definition of consistency, construct an explicit conservative finite volume scheme for Burgers' equation that is consistent but whose leading modified-equation correction acts as a negative viscosity. Carefully justify that your constructed scheme is conservative and consistent, and derive its leading modified equation using Taylor expansions and difference approximations to identify the sign of the viscosity term.\n\n2. Using definitions of monotonicity and the $L^1$ stability concept, prove that your constructed scheme is not $L^1$-stable by showing that it is not monotone and that its linearized amplification factor exceeds $1$ for some Fourier mode in a neighborhood of a constant state. Connect this to the sign of the viscosity term in the modified equation.\n\n3. Consider the Riemann problem with $u_L=0$ and $u_R=1$. Explain why the entropy solution of Burgers' equation for this data is a rarefaction fan and why any shock connecting $u_L$ to $u_R$ is non-admissible. Then, analyze the weak limit selected by your scheme in the presence of negative viscosity by invoking the conservative form and the Rankine–Hugoniot relation. Determine the speed $s$ of the discontinuity that the scheme selects for this Riemann problem and provide this $s$ as your final answer. The final answer must be a single real number without units. No rounding is required; provide the exact value.", "solution": "This problem is composed of three tasks concerning a finite volume scheme for Burgers' equation. We shall address each task in sequence after constructing the required numerical scheme.\n\n### Part 1: Construction and Analysis of a Scheme with Negative Viscosity\n\nThe problem requires the construction of a conservative finite volume scheme that is consistent but exhibits negative viscosity. A finite volume scheme is given in the conservative flux-difference form:\n$$ u_j^{n+1} = u_j^n - \\lambda \\left(F_{j+1/2}^n - F_{j-1/2}^n\\right) $$\nwhere $\\lambda = \\frac{\\Delta t}{\\Delta x}$, $u_j^n$ is the cell-average of the solution in cell $j$ at time $n$, and $F_{j+1/2}^n = F(u_j^n, u_{j+1}^n)$ is the numerical flux at the interface between cells $j$ and $j+1$. The physical flux for Burgers' equation is $f(u) = \\frac{1}{2}u^2$, with characteristic speed $f'(u) = u$.\n\nA standard stable scheme, like the upwind scheme, uses information from the direction of the flow. To construct a scheme with negative viscosity, which typically leads to instability, we can design a flux that uses information from the \"downwind\" direction. This is an anti-upwind or downwind scheme.\n\nLet us define the numerical flux $F(u_L, u_R)$ based on the sign of the characteristic speed, approximated at the interface, for instance by $(u_L+u_R)/2$:\n$$ F(u_L, u_R) = \\begin{cases} f(u_R)  \\text{if } (u_L+u_R)/2 > 0 \\\\ f(u_L)  \\text{if } (u_L+u_R)/2  0 \\end{cases} $$\nFor the case $(u_L+u_R)/2 = 0$, the flux can be defined as $F(u_L, u_R) = f(0) = 0$, which is consistent with both branches as $u_L \\to 0^-$ and $u_R \\to 0^+$.\n\nWe verify the properties of this scheme:\n1.  **Conservative:** The scheme is defined in the flux-difference form $u_j^{n+1} = u_j^n - \\lambda (F(u_j^n, u_{j+1}^n) - F(u_{j-1}^n, u_j^n))$. This form guarantees conservation of the integrated quantity $\\sum_j u_j^n \\Delta x$, as can be seen by summing over $j$, which results in a telescoping sum of fluxes.\n2.  **Consistent:** A flux $F(u_L, u_R)$ is consistent with $f(u)$ if $F(u, u) = f(u)$. For our defined flux, if we set $u_L = u_R = u$, then $(u_L+u_R)/2 = u$. If $u>0$, $F(u,u) = f(u)$. If $u0$, $F(u,u) = f(u)$. If $u=0$, $F(0,0)=f(0)$. Thus, the flux is consistent.\n\nNow, we derive the leading term of the modified equation for this scheme. Let us consider a region where the solution is positive, $u > 0$. In this case, $F(u_L, u_R) = f(u_R) = \\frac{1}{2}u_R^2$. The scheme becomes:\n$$ u_j^{n+1} = u_j^n - \\lambda \\left( f(u_{j+1}^n) - f(u_j^n) \\right) $$\nWe perform a Taylor series expansion of this equation around the point $(x_j, t_n)$.\n$$ \\frac{u_j^{n+1} - u_j^n}{\\Delta t} + \\frac{f(u_{j+1}^n) - f(u_j^n)}{\\Delta x} = 0 $$\nThe first term is expanded in time:\n$$ \\frac{u(x_j, t_n+\\Delta t) - u(x_j, t_n)}{\\Delta t} = u_t + \\frac{\\Delta t}{2}u_{tt} + O((\\Delta t)^2) $$\nThe second term is expanded in space:\n$$ \\frac{f(u(x_j+\\Delta x, t_n)) - f(u(x_j, t_n))}{\\Delta x} = f_x + \\frac{\\Delta x}{2}f_{xx} + O((\\Delta x)^2) $$\nwhere all derivatives are evaluated at $(x_j, t_n)$. Substituting these into the scheme gives:\n$$ u_t + f_x + \\frac{\\Delta t}{2}u_{tt} + \\frac{\\Delta x}{2}f_{xx} + \\dots = 0 $$\nTo find the leading-order correction, we express higher-order derivatives in terms of spatial derivatives using the original PDE, $u_t + f_x = 0$, as a first approximation. From $u_t = -f_x$, we find $u_{tt} = \\partial_t(-f_x) = - (f_t)_x = -(f'(u)u_t)_x = -(f'(u)(-f_x))_x = (f'(u)f_x)_x$.\nSubstituting this into the expanded scheme:\n$$ u_t + f_x = -\\frac{\\Delta t}{2}(f'(u)f_x)_x - \\frac{\\Delta x}{2}f_{xx} + O(\\Delta t^2, \\Delta x^2) $$\nUsing $f_x = f'(u)u_x$ and $f_{xx} = (f'(u)u_x)_x$, we get:\n$$ u_t + f_x = -\\frac{\\Delta t}{2}((f')^2 u_x)_x - \\frac{\\Delta x}{2}(f'u_x)_x + \\dots $$\nThe dominant error term involves the highest spatial derivative, which is $u_{xx}$. Extracting the coefficient of $u_{xx}$:\n$$ u_t + f_x = -\\left[ \\frac{\\Delta t}{2}(f')^2 + \\frac{\\Delta x}{2}f' \\right] u_{xx} + \\dots $$\n$$ u_t + f_x = -\\frac{\\Delta x}{2} \\left[ \\lambda (f')^2 + f' \\right] u_{xx} + \\dots $$\nThe standard form of a viscous conservation law is $u_t + f_x = \\nu u_{xx}$, where $\\nu$ is the viscosity coefficient. Our modified equation reveals an effective numerical viscosity of $\\nu_{num} = -\\frac{\\Delta x}{2}(\\lambda (f')^2 + f')$.\nFor Burgers' equation, $f'(u)=u$:\n$$ \\nu_{num} = -\\frac{\\Delta x}{2}(\\lambda u^2 + u) $$\nThis is a negative viscosity when $\\lambda u^2 + u > 0$. For the assumed case $u>0$, this condition is always met since $\\lambda>0$. Thus, our scheme introduces a negative viscosity term, which acts as an anti-diffusion.\n\n### Part 2: Instability of the Constructed Scheme\n\nWe now demonstrate that the scheme is not $L^1$-stable. We do this by showing it is not monotone and by analyzing its linearized amplification factor. A scheme $u_j^{n+1} = H(u_{j-k}^n, \\dots, u_{j+k}^n)$ is monotone if $\\frac{\\partial H}{\\partial u_i^n} \\ge 0$ for all its arguments $u_i^n$.\nFor our scheme with $u>0$, $u_j^{n+1} = H(u_j^n, u_{j+1}^n) = u_j^n - \\lambda(f(u_{j+1}^n) - f(u_j^n))$.\nLet us compute the partial derivatives:\n$$ \\frac{\\partial H}{\\partial u_j^n} = 1 - \\lambda \\frac{\\partial}{\\partial u_j^n}(-f(u_j^n)) = 1 + \\lambda f'(u_j^n) = 1 + \\lambda u_j^n $$\nFor $u_j^n>0$ and $\\lambda>0$, this is positive.\n$$ \\frac{\\partial H}{\\partial u_{j+1}^n} = -\\lambda \\frac{\\partial}{\\partial u_{j+1}^n}(f(u_{j+1}^n)) = -\\lambda f'(u_{j+1}^n) = -\\lambda u_{j+1}^n $$\nFor $u_{j+1}^n>0$ and $\\lambda>0$, this derivative is strictly negative. Since one of the partial derivatives is negative, the scheme is not monotone. By the theorems of Harten, Lax, and van Leer, a non-monotone scheme cannot be total variation diminishing (TVD) in the nonlinear case. For scalar conservation laws, $L^1$-contraction is closely related to the TVD property, suggesting a lack of $L^1$-stability.\n\nTo prove instability rigorously, we perform a von Neumann stability analysis on the linearized version of the scheme. Let's linearize around a constant state $\\bar{u}>0$. The scheme for a perturbation $\\delta_j^n$ is:\n$$ \\delta_j^{n+1} = \\delta_j^n - \\lambda \\bar{u} (\\delta_{j+1}^n - \\delta_j^n) $$\nWe look for solutions of the form $\\delta_j^n = G^n e^{i k j \\Delta x}$, where $k$ is the wavenumber and $G$ is the amplification factor.\n$$ G = 1 - c\\lambda (e^{i\\theta} - 1) $$\nwhere $c=\\bar{u}>0$ and $\\theta = k\\Delta x$. The squared modulus of $G$ is:\n$$ |G|^2 = \\left| 1 - c\\lambda(\\cos\\theta - 1) - i c\\lambda\\sin\\theta \\right|^2 $$\n$$ |G|^2 = (1 - c\\lambda(\\cos\\theta - 1))^2 + (c\\lambda\\sin\\theta)^2 $$\n$$ |G|^2 = 1 - 2c\\lambda(\\cos\\theta - 1) + c^2\\lambda^2(\\cos\\theta-1)^2 + c^2\\lambda^2\\sin^2\\theta $$\n$$ |G|^2 = 1 + 2c\\lambda(1-\\cos\\theta) + c^2\\lambda^2(\\cos^2\\theta-2\\cos\\theta+1+\\sin^2\\theta) $$\n$$ |G|^2 = 1 + (2c\\lambda + 2c^2\\lambda^2)(1-\\cos\\theta) $$\nSince $c=\\bar{u}>0$, $\\lambda>0$, the term $2c\\lambda + 2c^2\\lambda^2$ is positive. Also, $1-\\cos\\theta \\ge 0$. For any mode where $\\theta \\neq 2m\\pi$ (for $m \\in \\mathbb{Z}$), we have $1-\\cos\\theta > 0$, which implies $|G|^2 > 1$.\nAn amplification factor greater than $1$ means that certain Fourier modes of the solution grow exponentially in time. This unbounded growth violates the definition of $L^1$-stability, which requires the $L^1$-norm of the difference between two solutions to be bounded by a constant times the initial difference. The exponential growth is a direct manifestation of the negative viscosity derived in Part 1, which corresponds to an ill-posed backward-in-time heat equation.\n\n### Part 3: Riemann Problem Solution Selected by the Scheme\n\nWe consider the Riemann problem for Burgers' equation with initial data $u(x,0)=u_L=0$ for $x0$ and $u(x,0)=u_R=1$ for $x>0$.\nThe characteristic speeds are $f'(u_L)=0$ and $f'(u_R)=1$. Since $f'(u_L)  f'(u_R)$, characteristics starting from the left half-axis are slower than those from the right half-axis. The characteristics diverge from the origin, creating a fan-like region. The entropy-admissible weak solution is a continuous rarefaction wave:\n$$ u(x,t) = \\begin{cases} 0  \\text{if } x/t  0 \\\\ x/t  \\text{if } 0 \\le x/t \\le 1 \\\\ 1  \\text{if } x/t > 1 \\end{cases} $$\nA discontinuous shock solution connecting $u_L=0$ to $u_R=1$ would have a speed $s$ given by the Rankine-Hugoniot condition:\n$$ s = \\frac{f(u_R) - f(u_L)}{u_R - u_L} = \\frac{\\frac{1}{2}(1)^2 - \\frac{1}{2}(0)^2}{1 - 0} = \\frac{1}{2} $$\nFor this shock to be entropy-admissible, it must satisfy the Lax entropy condition: $f'(u_L) > s > f'(u_R)$. With $f'(u)=u$, this becomes $0 > 1/2 > 1$, which is false. Therefore, this shock is non-physical.\n\nThe constructed numerical scheme is conservative. According to the Lax-Wendroff theorem, if the numerical solutions generated by a conservative scheme converge as $\\Delta x, \\Delta t \\to 0$, the limit must be a weak solution of the PDE, meaning it satisfies the Rankine-Hugoniot condition across any discontinuities.\nOur scheme has negative numerical viscosity for $u>0$. The vanishing viscosity method for selecting the entropy solution relies on adding a term $\\epsilon u_{xx}$ with $\\epsilon > 0$ and taking the limit $\\epsilon \\to 0^+$. Our scheme's modified equation corresponds to a limit with $\\epsilon  0$. This process selects entropy-violating solutions. Specifically, it selects shocks that satisfy the anti-Lax condition $f'(u_L)  s  f'(u_R)$. For our problem, this condition is $0  1/2  1$, which is true.\nConsequently, the constructed scheme will not converge to the rarefaction wave. Instead, it will attempt to form the non-physical discontinuous solution. The speed of this discontinuity, being determined by the conservation property of the scheme, must be the one given by the Rankine-Hugoniot condition.\nTherefore, the speed $s$ of the discontinuity selected by the scheme is:\n$$ s = \\frac{1}{2} $$", "answer": "$$ \\boxed{\\frac{1}{2}} $$", "id": "3373303"}]}