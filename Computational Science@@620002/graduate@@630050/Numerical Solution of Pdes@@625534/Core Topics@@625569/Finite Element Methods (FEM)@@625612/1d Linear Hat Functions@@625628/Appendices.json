{"hands_on_practices": [{"introduction": "The stiffness matrix is central to the finite element method, particularly for problems involving diffusion or elasticity, as it discretizes differential operators. Its entries represent the interaction between basis functions' gradients. This first exercise [@problem_id:3359148] provides foundational practice in computing a diagonal entry of the stiffness matrix, which requires working with the derivatives of piecewise-linear hat functions and integrating them over their local support.", "problem": "Consider the standard conforming piecewise-linear finite element method (FEM) for a second-order scalar elliptic model problem on a one-dimensional closed interval. Let the domain be the closed interval $\\left[a,b\\right]$ with a strictly increasing mesh of nodes $\\{x_j\\}_{j=0}^{N}$ satisfying $x_0=a$, $x_N=b$, and $x_{j-1}x_j$ for all $j\\in\\{1,\\dots,N\\}$. Define the local mesh sizes by $h_j:=x_j-x_{j-1}$ for all $j\\in\\{1,\\dots,N\\}$. For an interior node index $i\\in\\{1,\\dots,N-1\\}$, let $\\varphi_i$ denote the canonical one-dimensional linear \"hat\" basis function associated with the node $x_i$, defined by the conditions $\\varphi_i(x_i)=1$, $\\varphi_i(x_j)=0$ for $j\\neq i$, and $\\operatorname{supp}(\\varphi_i)=[x_{i-1},x_{i+1}]$, with $\\varphi_i$ linear on each subinterval $[x_{i-1},x_i]$ and $[x_i,x_{i+1}]$. The symmetric bilinear form corresponding to the diffusion operator with unit coefficient is $a(u,v):=\\int_{a}^{b} u'(x)\\,v'(x)\\,dx$, and the associated stiffness matrix entry on the diagonal for node $i$ is\n$$\nK_{ii}:=\\int_{x_{i-1}}^{x_{i+1}}\\left(\\varphi_i'(x)\\right)^{2}\\,dx.\n$$\nStarting from the definitions above and basic properties of piecewise-linear hat functions, compute $K_{ii}$ in closed form in terms of $h_i$ and $h_{i+1}$. Express your final result as a single simplified symbolic expression. No numerical approximation is required, and no units are involved.", "solution": "The problem statement is subjected to validation and is found to be valid. It is a well-posed, scientifically grounded, and objective problem from the field of numerical analysis, specifically the Finite Element Method. All terms are standard and well-defined, and sufficient information is provided to derive a unique solution.\n\nThe objective is to compute the stiffness matrix diagonal entry $K_{ii}$ associated with an interior node $x_i$. The entry is defined by the integral:\n$$\nK_{ii} := \\int_{x_{i-1}}^{x_{i+1}}\\left(\\varphi_i'(x)\\right)^{2}\\,dx\n$$\nwhere $\\varphi_i(x)$ is the piecewise-linear hat function centered at node $x_i$.\n\nFirst, we must determine the analytical expression for the hat function $\\varphi_i(x)$ and its derivative, $\\varphi_i'(x)$. The function $\\varphi_i(x)$ is defined by the conditions $\\varphi_i(x_i)=1$, $\\varphi_i(x_j)=0$ for $j \\neq i$, and its support being the interval $[x_{i-1}, x_{i+1}]$. It is linear on the subintervals $[x_{i-1}, x_i]$ and $[x_i, x_{i+1}]$.\n\nOn the interval $[x_{i-1}, x_i]$, $\\varphi_i(x)$ is a line segment connecting the points $(x_{i-1}, 0)$ and $(x_i, 1)$. The equation of this line is given by:\n$$\n\\varphi_i(x) = \\frac{x - x_{i-1}}{x_i - x_{i-1}}\n$$\nUsing the definition of the local mesh size, $h_j = x_j - x_{j-1}$, we have $h_i = x_i - x_{i-1}$. Thus, for $x \\in [x_{i-1}, x_i]$:\n$$\n\\varphi_i(x) = \\frac{x - x_{i-1}}{h_i}\n$$\nOn the interval $[x_i, x_{i+1}]$, $\\varphi_i(x)$ is a line segment connecting the points $(x_i, 1)$ and $(x_{i+1}, 0)$. The equation of this line is:\n$$\n\\varphi_i(x) = \\frac{x_{i+1} - x}{x_{i+1} - x_i}\n$$\nUsing the local mesh size $h_{i+1} = x_{i+1} - x_i$, we have for $x \\in [x_i, x_{i+1}]$:\n$$\n\\varphi_i(x) = \\frac{x_{i+1} - x}{h_{i+1}}\n$$\nOutside the support interval $[x_{i-1}, x_{i+1}]$, $\\varphi_i(x) = 0$.\n\nNext, we compute the derivative, $\\varphi_i'(x)$. As $\\varphi_i(x)$ is piecewise linear, its derivative is piecewise constant.\nFor $x \\in (x_{i-1}, x_i)$, the derivative is:\n$$\n\\varphi_i'(x) = \\frac{d}{dx}\\left(\\frac{x - x_{i-1}}{h_i}\\right) = \\frac{1}{h_i}\n$$\nFor $x \\in (x_i, x_{i+1})$, the derivative is:\n$$\n\\varphi_i'(x) = \\frac{d}{dx}\\left(\\frac{x_{i+1} - x}{h_{i+1}}\\right) = -\\frac{1}{h_{i+1}}\n$$\nFor $x \\notin [x_{i-1}, x_{i+1}]$, $\\varphi_i'(x) = 0$. The derivative is undefined at the nodes, but this does not affect the value of the integral.\n\nNow, we can evaluate the integral for $K_{ii}$. The domain of integration $(x_{i-1}, x_{i+1})$ is the support of $\\varphi_i'(x)$. We split the integral into two parts, corresponding to the two subintervals where $\\varphi_i'(x)$ is non-zero:\n$$\nK_{ii} = \\int_{x_{i-1}}^{x_i} (\\varphi_i'(x))^2 \\,dx + \\int_{x_i}^{x_{i+1}} (\\varphi_i'(x))^2 \\,dx\n$$\nWe evaluate each integral separately. For the first integral:\n$$\n\\int_{x_{i-1}}^{x_i} (\\varphi_i'(x))^2 \\,dx = \\int_{x_{i-1}}^{x_i} \\left(\\frac{1}{h_i}\\right)^2 \\,dx = \\frac{1}{h_i^2} \\int_{x_{i-1}}^{x_i} 1 \\,dx\n$$\nThe value of this integral is the constant integrand multiplied by the length of the interval, which is $x_i - x_{i-1} = h_i$:\n$$\n\\frac{1}{h_i^2} \\cdot (x_i - x_{i-1}) = \\frac{1}{h_i^2} \\cdot h_i = \\frac{1}{h_i}\n$$\nFor the second integral:\n$$\n\\int_{x_i}^{x_{i+1}} (\\varphi_i'(x))^2 \\,dx = \\int_{x_i}^{x_{i+1}} \\left(-\\frac{1}{h_{i+1}}\\right)^2 \\,dx = \\frac{1}{h_{i+1}^2} \\int_{x_i}^{x_{i+1}} 1 \\,dx\n$$\nThe value of this integral is the constant integrand multiplied by the length of the interval, which is $x_{i+1} - x_i = h_{i+1}$:\n$$\n\\frac{1}{h_{i+1}^2} \\cdot (x_{i+1} - x_i) = \\frac{1}{h_{i+1}^2} \\cdot h_{i+1} = \\frac{1}{h_{i+1}}\n$$\nFinally, we sum the results of the two integrals to obtain $K_{ii}$:\n$$\nK_{ii} = \\frac{1}{h_i} + \\frac{1}{h_{i+1}}\n$$\nThis expression represents the diagonal entry of the stiffness matrix for an interior node $i$ in terms of the adjacent local mesh sizes $h_i$ and $h_{i+1}$.", "answer": "$$\n\\boxed{\\frac{1}{h_i} + \\frac{1}{h_{i+1}}}\n$$", "id": "3359148"}, {"introduction": "Complementing the stiffness matrix, the mass matrix arises in problems with time derivatives or source terms, representing the inner products of basis functions themselves. This practice [@problem_id:3359130] involves calculating both diagonal and off-diagonal entries of the mass matrix. The exercise reinforces understanding of how the overlapping supports of adjacent hat functions lead to the sparse, banded structure of these fundamental matrices.", "problem": "Consider the semi-discretization in space, using the Galerkin approach of the Finite Element Method (FEM), of a one-dimensional linear partial differential equation (PDE) on the interval $[0,L]$. Let the interval be partitioned into a uniform mesh with nodes $x_{i}=ih$ for $i=0,1,\\dots,N$, where $h=L/N$. On this mesh, let $\\{\\varphi_{i}\\}_{i=0}^{N}$ denote the standard one-dimensional piecewise-linear hat basis functions associated with the nodes $\\{x_{i}\\}$. The mass matrix $M$ is defined by the inner products\n$$\nM_{ij}=\\int_{0}^{L}\\varphi_{i}(x)\\,\\varphi_{j}(x)\\,\\mathrm{d}x,\n$$\nfor all indices $i,j$ corresponding to the interior degrees of freedom. Starting from the definitions of the basis functions and the uniform mesh, derive closed-form expressions in terms of $h$ for the diagonal entry $M_{ii}$ and the immediate off-diagonal entry $M_{i,i+1}$ for an interior index $i$ (that is, $1\\leq i\\leq N-1$). Express your final answer as the pair $\\left(M_{ii},M_{i,i+1}\\right)$ as a single analytic expression. No rounding is required.", "solution": "The problem requires the derivation of the diagonal and off-diagonal entries of the mass matrix for a one-dimensional finite element discretization using piecewise-linear basis functions on a uniform mesh.\n\nFirst, we must define the basis functions. The problem is set on the interval $[0,L]$, which is divided into $N$ subintervals of equal length $h=L/N$. The nodes are located at positions $x_i = ih$ for $i=0, 1, \\dots, N$. The standard piecewise-linear (or \"hat\") basis function $\\varphi_i(x)$ associated with an interior node $x_i$ (where $1 \\le i \\le N-1$) is defined by the properties:\n$1$. $\\varphi_i(x_j) = \\delta_{ij}$, where $\\delta_{ij}$ is the Kronecker delta.\n$2$. $\\varphi_i(x)$ is continuous and linear on each subinterval $[x_j, x_{j+1}]$.\n\nFrom these properties, the explicit formula for $\\varphi_i(x)$ for an interior node $i$ is:\n$$\n\\varphi_i(x) =\n\\begin{cases}\n    \\frac{x - x_{i-1}}{x_i - x_{i-1}} = \\frac{x - (i-1)h}{h}  \\text{if } x \\in [x_{i-1}, x_i] \\\\\n    \\frac{x_{i+1} - x}{x_{i+1} - x_i} = \\frac{(i+1)h - x}{h}  \\text{if } x \\in [x_i, x_{i+1}] \\\\\n    0  \\text{otherwise}\n\\end{cases}\n$$\nThe support of $\\varphi_i(x)$, i.e., the region where it is non-zero, is the interval $[x_{i-1}, x_{i+1}]$.\n\nThe entries of the mass matrix $M$ are given by the formula $M_{ij} = \\int_{0}^{L} \\varphi_i(x) \\varphi_j(x) \\, dx$. We need to compute the diagonal entry $M_{ii}$ and the off-diagonal entry $M_{i,i+1}$ for an interior index $i$.\n\nTo compute the diagonal entry $M_{ii}$, we evaluate the integral:\n$$\nM_{ii} = \\int_{0}^{L} \\varphi_i(x)^2 \\, dx\n$$\nSince $\\varphi_i(x)$ is only non-zero on the interval $[x_{i-1}, x_{i+1}]$, the integral is restricted to this domain:\n$$\nM_{ii} = \\int_{x_{i-1}}^{x_{i+1}} \\varphi_i(x)^2 \\, dx\n$$\nWe can split this integral into two parts, corresponding to the two subintervals where $\\varphi_i(x)$ is defined by different linear functions:\n$$\nM_{ii} = \\int_{x_{i-1}}^{x_i} \\left(\\frac{x - x_{i-1}}{h}\\right)^2 \\, dx + \\int_{x_i}^{x_{i+1}} \\left(\\frac{x_{i+1} - x}{h}\\right)^2 \\, dx\n$$\nFor the first integral, we perform a change of variables. Let $u = x - x_{i-1}$. Then $du = dx$. The limits of integration become $u=0$ when $x=x_{i-1}$ and $u=h$ when $x=x_i$.\n$$\n\\int_{x_{i-1}}^{x_i} \\left(\\frac{x - x_{i-1}}{h}\\right)^2 \\, dx = \\frac{1}{h^2} \\int_{0}^{h} u^2 \\, du = \\frac{1}{h^2} \\left[ \\frac{u^3}{3} \\right]_0^h = \\frac{1}{h^2} \\frac{h^3}{3} = \\frac{h}{3}\n$$\nFor the second integral, we let $v = x_{i+1} - x$. Then $dv = -dx$. The limits become $v=h$ when $x=x_i$ and $v=0$ when $x=x_{i+1}$.\n$$\n\\int_{x_i}^{x_{i+1}} \\left(\\frac{x_{i+1} - x}{h}\\right)^2 \\, dx = \\frac{1}{h^2} \\int_{h}^{0} v^2 \\, (-dv) = \\frac{1}{h^2} \\int_{0}^{h} v^2 \\, dv = \\frac{1}{h^2} \\left[ \\frac{v^3}{3} \\right]_0^h = \\frac{1}{h^2} \\frac{h^3}{3} = \\frac{h}{3}\n$$\nSumming these two results gives the value for the diagonal entry:\n$$\nM_{ii} = \\frac{h}{3} + \\frac{h}{3} = \\frac{2h}{3}\n$$\n\nNext, we compute the off-diagonal entry $M_{i,i+1}$. The integral is:\n$$\nM_{i,i+1} = \\int_{0}^{L} \\varphi_i(x) \\varphi_{i+1}(x) \\, dx\n$$\nThe integrand $\\varphi_i(x) \\varphi_{i+1}(x)$ is non-zero only where the supports of $\\varphi_i(x)$ and $\\varphi_{i+1}(x)$ overlap. The support of $\\varphi_i(x)$ is $[x_{i-1}, x_{i+1}]$ and the support of $\\varphi_{i+1}(x)$ is $[x_i, x_{i+2}]$. The intersection of these two supports is the interval $[x_i, x_{i+1}]$. Therefore, the integral is non-zero only over this interval.\n$$\nM_{i,i+1} = \\int_{x_i}^{x_{i+1}} \\varphi_i(x) \\varphi_{i+1}(x) \\, dx\n$$\nOn the interval $[x_i, x_{i+1}]$, the basis functions are given by:\n- $\\varphi_i(x) = \\frac{x_{i+1} - x}{h}$ (descending part of the hat function $\\varphi_i$)\n- $\\varphi_{i+1}(x) = \\frac{x - x_{i}}{h}$ (ascending part of the hat function $\\varphi_{i+1}$)\n\nSubstituting these into the integral:\n$$\nM_{i,i+1} = \\int_{x_i}^{x_{i+1}} \\left(\\frac{x_{i+1} - x}{h}\\right) \\left(\\frac{x - x_i}{h}\\right) \\, dx = \\frac{1}{h^2} \\int_{x_i}^{x_{i+1}} (x_{i+1} - x)(x - x_i) \\, dx\n$$\nWe use the substitution $u = x - x_i$, which implies $du=dx$. The term $x_{i+1} - x$ becomes $x_{i+1} - (u+x_i) = (x_{i+1}-x_i) - u = h-u$. The limits of integration change from $x_i, x_{i+1}$ to $u=0, u=h$.\n$$\nM_{i,i+1} = \\frac{1}{h^2} \\int_{0}^{h} (h-u)u \\, du = \\frac{1}{h^2} \\int_{0}^{h} (hu - u^2) \\, du\n$$\nEvaluating the integral:\n$$\nM_{i,i+1} = \\frac{1}{h^2} \\left[ \\frac{hu^2}{2} - \\frac{u^3}{3} \\right]_0^h = \\frac{1}{h^2} \\left( \\frac{h(h^2)}{2} - \\frac{h^3}{3} \\right) = \\frac{1}{h^2} \\left( \\frac{h^3}{2} - \\frac{h^3}{3} \\right)\n$$\n$$\nM_{i,i+1} = \\frac{1}{h^2} \\left( \\frac{3h^3 - 2h^3}{6} \\right) = \\frac{1}{h^2} \\left( \\frac{h^3}{6} \\right) = \\frac{h}{6}\n$$\nThus, for an interior node $i$, the diagonal entry of the mass matrix is $M_{ii} = \\frac{2h}{3}$ and the immediate off-diagonal entry is $M_{i,i+1} = \\frac{h}{6}$. By symmetry of the integral definition, $M_{i+1,i} = M_{i,i+1} = \\frac{h}{6}$. All other entries $M_{ij}$ where $|i-j|1$ are zero because the supports of $\\varphi_i(x)$ and $\\varphi_j(x)$ are disjoint.\n\nThe problem asks for the pair $(M_{ii}, M_{i,i+1})$. The derived closed-form expressions are $M_{ii} = \\frac{2h}{3}$ and $M_{i,i+1} = \\frac{h}{6}$.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{2h}{3}  \\frac{h}{6}\n\\end{pmatrix}\n}\n$$", "id": "3359130"}, {"introduction": "While analytical integration is feasible for simple 1D problems, most real-world finite element applications rely on numerical quadrature to assemble the system matrices. This exercise [@problem_id:3359143] addresses the crucial question of how to choose a quadrature rule that is both perfectly accurate for a given polynomial basis and computationally efficient. Mastering this connection is key to translating theoretical FEM concepts into practical, robust code.", "problem": "Consider a single spatial dimension ($1$D) finite element discretization of a scalar partial differential equation (PDE) on an interval partitioned into elements $K_e=[x_e,x_{e+1}]$ with an affine mapping from the reference element. On each element, let the local linear shape functions be defined on the reference interval $\\hat{K}=[-1,1]$ by $N_1(\\xi)=\\tfrac{1-\\xi}{2}$ and $N_2(\\xi)=\\tfrac{1+\\xi}{2}$, and let the element mapping be $x(\\xi)=\\tfrac{1}{2}\\big((1-\\xi)x_e+(1+\\xi)x_{e+1}\\big)$ so that the Jacobian is constant $J_e=\\tfrac{x_{e+1}-x_e}{2}=\\tfrac{h_e}{2}$. For local mass-type entries, define\n$$\nI_{ij}^{(e)}=\\int_{K_e} N_i(x)\\,N_j(x)\\,dx=\\int_{-1}^{1} N_i(\\xi)\\,N_j(\\xi)\\,J_e\\,d\\xi,\\quad i,j\\in\\{1,2\\}.\n$$\nYour task is to determine a quadrature rule on each element that integrates exactly these products of local linear shape functions and to assess the sufficiency of using the Gauss–Legendre quadrature with $2$ points.\n\nWhich of the following statements are correct? Select all that apply.\n\nA. Using the $1$-point Gauss rule (midpoint rule) on each element, namely one node at the element center with weight equal to the element length, integrates each $I_{ij}^{(e)}$ exactly, because $N_iN_j$ is linear on $K_e$.\n\nB. Using the $2$-point Gauss–Legendre rule on the reference element with nodes at $\\xi=\\pm 1/\\sqrt{3}$ and weights equal to $1$, mapped by $x(\\xi)$ with the constant Jacobian factor $J_e$, integrates each $I_{ij}^{(e)}$ exactly; it is sufficient because $N_iN_j$ is a polynomial of degree at most $2$ and the $2$-point Gauss–Legendre rule is exact for all polynomials up to degree $3$.\n\nC. Using the trapezoidal rule on each element (endpoints only, each with weight $h_e/2$) yields exact values for $I_{12}^{(e)}$, because $N_1N_2$ vanishes at both endpoints.\n\nD. Using the $3$-point Gauss–Legendre rule on the reference element with nodes at $\\xi=0,\\ \\pm\\sqrt{3/5}$ and weights $8/9,\\ 5/9,\\ 5/9$, mapped by $x(\\xi)$, integrates each $I_{ij}^{(e)}$ exactly; however, it is not necessary since a lower-order exact rule exists.\n\nE. No fixed-number Gauss rule can be exact for $I_{ij}^{(e)}$ on all elements, because the affine mapping makes the Jacobian $J_e$ vary with $\\xi$, so the integrand is not a polynomial on $\\hat{K}$.", "solution": "The problem statement is first validated to ensure it is scientifically sound, well-posed, and objective.\n\n**Step 1: Extract Givens**\n- **Spatial Dimension:** $1$D.\n- **Domain Partition:** The interval is partitioned into elements $K_e=[x_e,x_{e+1}]$.\n- **Reference Element:** $\\hat{K}=[-1,1]$.\n- **Reference Shape Functions:** $N_1(\\xi)=\\tfrac{1-\\xi}{2}$ and $N_2(\\xi)=\\tfrac{1+\\xi}{2}$ for $\\xi \\in \\hat{K}$. These are linear polynomials.\n- **Element Mapping:** An affine mapping $x(\\xi)=\\tfrac{1}{2}\\big((1-\\xi)x_e+(1+\\xi)x_{e+1}\\big)$.\n- **Jacobian:** The Jacobian of the mapping is $J_e=\\tfrac{dx}{d\\xi}=\\tfrac{x_{e+1}-x_e}{2}=\\tfrac{h_e}{2}$, where $h_e$ is the length of element $K_e$. The Jacobian $J_e$ is a constant for each element.\n- **Integral Definition:** The local mass-type entries are defined by $I_{ij}^{(e)}=\\int_{K_e} N_i(x)\\,N_j(x)\\,dx$.\n- **Transformed Integral:** This integral is transformed to the reference element as $I_{ij}^{(e)}=\\int_{-1}^{1} N_i(\\xi)\\,N_j(\\xi)\\,J_e\\,d\\xi$, for $i,j\\in\\{1,2\\}$.\n- **Task:** Determine a quadrature rule for the exact integration of $I_{ij}^{(e)}$ and assess the sufficiency of a $2$-point Gauss-Legendre rule.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem statement is a standard formulation found in introductory texts on the Finite Element Method (FEM). The definitions of the $1$D linear (\"hat\") shape functions, the affine mapping from a reference element, the calculation of the Jacobian, and the change of variables for the integral are all correct and standard practice. The problem is scientifically grounded in numerical analysis, is self-contained, and contains no contradictory or ambiguous information. The language is objective and precise. Therefore, the problem is valid.\n\n**Step 3: Verdict and Action**\nThe problem is valid. We proceed to derive the solution and evaluate the options.\n\n**Derivation of the Solution**\nThe integral to be evaluated is $I_{ij}^{(e)}=\\int_{-1}^{1} N_i(\\xi)\\,N_j(\\xi)\\,J_e\\,d\\xi$.\nThe integrand on the reference element for a given element $K_e$ is $f_{ij}(\\xi) = N_i(\\xi)\\,N_j(\\xi)\\,J_e$.\nThe shape functions $N_1(\\xi)$ and $N_2(\\xi)$ are polynomials of degree $1$ in the variable $\\xi$.\nConsequently, their product, $N_i(\\xi)\\,N_j(\\xi)$, is a polynomial of degree at most $1+1=2$ in $\\xi$.\nThe Jacobian, $J_e = h_e/2$, is a constant for the given element.\nTherefore, the full integrand $f_{ij}(\\xi)$ is a polynomial in $\\xi$ of degree at most $2$.\n\nA quadrature rule is said to be exact for a certain class of functions if it computes their integral without error. The Gauss-Legendre quadrature rule with $n$ points is exact for all polynomials of degree up to $2n-1$.\n\nTo find the minimum number of Gauss points, $n$, required for exact integration of $I_{ij}^{(e)}$, we must satisfy the condition that the degree of precision is at least the degree of the integrand polynomial.\nDegree of integrand: $\\text{deg}(f_{ij}(\\xi)) \\le 2$.\nDegree of precision for $n$-point Gauss-Legendre rule: $2n-1$.\nWe require $2n-1 \\ge 2$.\n- For $n=1$, the degree of precision is $2(1)-1=1$. This is insufficient as $1  2$.\n- For $n=2$, the degree of precision is $2(2)-1=3$. This is sufficient as $3 \\ge 2$.\n- For any $n  2$, the degree of precision $2n-1$ will also be greater than $2$, so any Gauss-Legendre rule with $2$ or more points will integrate $I_{ij}^{(e)}$ exactly.\n\nTherefore, the $2$-point Gauss-Legendre rule is sufficient for exact integration, and it is the lowest-order Gauss-Legendre rule that achieves this.\n\n**Evaluation of Options**\n\n**A. Using the $1$-point Gauss rule (midpoint rule) on each element, namely one node at the element center with weight equal to the element length, integrates each $I_{ij}^{(e)}$ exactly, because $N_iN_j$ is linear on $K_e$.**\nThe reason provided, \"$N_iN_j$ is linear on $K_e$\", is incorrect. The shape functions $N_i(x)$ are linear in $x$, so their product $N_i(x)N_j(x)$ is a quadratic function of $x$. On the reference element, $N_i(\\xi)N_j(\\xi)$ is a quadratic polynomial in $\\xi$. The $1$-point Gauss rule is exact only for polynomials of degree up to $1$. Since the integrand is quadratic, this rule is generally not exact. For instance, consider $I_{11}^{(e)}$:\nThe exact value is $I_{11}^{(e)} = \\int_{-1}^{1} (\\frac{1-\\xi}{2})^2 J_e d\\xi = J_e \\int_{-1}^{1} \\frac{1-2\\xi+\\xi^2}{4} d\\xi = \\frac{J_e}{4}[\\xi - \\xi^2 + \\frac{\\xi^3}{3}]_{-1}^{1} = \\frac{J_e}{4} ( (1-1+1/3) - (-1-1-1/3) ) = \\frac{J_e}{4} (\\frac{1}{3} + \\frac{7}{3}) = \\frac{J_e}{4}\\frac{8}{3} = \\frac{2J_e}{3} = \\frac{h_e}{3}$.\nThe $1$-point Gauss rule on $\\hat{K}=[-1,1]$ uses node $\\xi_1=0$ and weight $w_1=2$. The approximation is $I_{11}^{(e)} \\approx w_1 \\cdot (N_1(0))^2 J_e = 2 \\cdot (\\frac{1}{2})^2 J_e = 2 \\cdot \\frac{1}{4} J_e = \\frac{J_e}{2} = \\frac{h_e}{4}$.\nSince $\\frac{h_e}{3} \\neq \\frac{h_e}{4}$, the rule is not exact.\nVerdict: **Incorrect**.\n\n**B. Using the $2$-point Gauss–Legendre rule on the reference element with nodes at $\\xi=\\pm 1/\\sqrt{3}$ and weights equal to $1$, mapped by $x(\\xi)$ with the constant Jacobian factor $J_e$, integrates each $I_{ij}^{(e)}$ exactly; it is sufficient because $N_iN_j$ is a polynomial of degree at most $2$ and the $2$-point Gauss–Legendre rule is exact for all polynomials up to degree $3$.**\nThis statement accurately describes the situation. The integrand $N_i(\\xi)N_j(\\xi)J_e$ is a polynomial of degree at most $2$. The $2$-point Gauss-Legendre rule is exact for polynomials of degree up to $2(2)-1=3$. Since $2 \\le 3$, the rule gives the exact integral. The reasoning provided is entirely correct.\nVerdict: **Correct**.\n\n**C. Using the trapezoidal rule on each element (endpoints only, each with weight $h_e/2$) yields exact values for $I_{12}^{(e)}$, because $N_1N_2$ vanishes at both endpoints.**\nThe trapezoidal rule for an integral $\\int_{x_e}^{x_{e+1}} g(x) dx$ is $\\frac{h_e}{2}(g(x_e) + g(x_{e+1}))$. Here, $g(x) = N_1(x)N_2(x)$.\nThe shape functions have the property that at the element nodes, $N_1(x_e)=1$, $N_1(x_{e+1})=0$, $N_2(x_e)=0$, and $N_2(x_{e+1})=1$.\nThus, the integrand $N_1(x)N_2(x)$ vanishes at both endpoints: $N_1(x_e)N_2(x_e) = 1 \\cdot 0 = 0$ and $N_1(x_{e+1})N_2(x_{e+1}) = 0 \\cdot 1 = 0$.\nThe trapezoidal rule approximation for $I_{12}^{(e)}$ is $\\frac{h_e}{2}(0+0) = 0$.\nThe exact value is $I_{12}^{(e)} = \\int_{-1}^{1} (\\frac{1-\\xi}{2})(\\frac{1+\\xi}{2}) J_e d\\xi = \\frac{J_e}{4} \\int_{-1}^{1} (1-\\xi^2) d\\xi = \\frac{J_e}{4} [\\xi - \\frac{\\xi^3}{3}]_{-1}^{1} = \\frac{J_e}{4} (\\frac{2}{3} - (-\\frac{2}{3})) = \\frac{J_e}{3} = \\frac{h_e}{6}$.\nSince $0 \\neq \\frac{h_e}{6}$ (for any non-degenerate element $h_e  0$), the trapezoidal rule is not exact for $I_{12}^{(e)}$. The fact that the integrand vanishes at the endpoints does not mean its integral is zero. This numerical integration scheme is known as mass lumping and is an approximation, not an exact integration.\nVerdict: **Incorrect**.\n\n**D. Using the $3$-point Gauss–Legendre rule on the reference element with nodes at $\\xi=0,\\ \\pm\\sqrt{3/5}$ and weights $8/9,\\ 5/9,\\ 5/9$, mapped by $x(\\xi)$, integrates each $I_{ij}^{(e)}$ exactly; however, it is not necessary since a lower-order exact rule exists.**\nThe $3$-point Gauss-Legendre rule is exact for all polynomials of degree up to $2(3)-1=5$. Since the integrand is a polynomial of degree at most $2$, and $2 \\le 5$, this rule will indeed compute the integral exactly. The first part of the statement is correct. The second part states that it is \"not necessary\". This is also correct in the sense of minimality, because, as established in B, the $2$-point rule is sufficient for exactness. Using a $3$-point rule is computationally more expensive but yields the same exact result.\nVerdict: **Correct**.\n\n**E. No fixed-number Gauss rule can be exact for $I_{ij}^{(e)}$ on all elements, because the affine mapping makes the Jacobian $J_e$ vary with $\\xi$, so the integrand is not a polynomial on $\\hat{K}$.**\nThe reason provided in this statement is fundamentally flawed. For an affine mapping, $x(\\xi)$, the Jacobian $J_e = dx/d\\xi$ is a constant, as explicitly stated and derived in the problem setup: $J_e = (x_{e+1}-x_e)/2$. The Jacobian does not vary with $\\xi$. Because the Jacobian is constant and the shape functions $N_i(\\xi)$ are polynomials, the integrand $N_i(\\xi)N_j(\\xi)J_e$ is a polynomial in $\\xi$. Gauss quadrature is specifically designed to exactly integrate polynomials up to a certain degree. As shown in B and D, fixed-number Gauss rules (e.g., $2$-point and $3$-point) are exact. Thus, the entire statement is false.\nVerdict: **Incorrect**.", "answer": "$$\\boxed{BD}$$", "id": "3359143"}]}