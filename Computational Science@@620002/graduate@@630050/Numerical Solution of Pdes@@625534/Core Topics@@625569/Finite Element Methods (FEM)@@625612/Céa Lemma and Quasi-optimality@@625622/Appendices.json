{"hands_on_practices": [{"introduction": "A deep understanding of Céa's lemma begins with mastering the derivation of its core components, the continuity ($M$) and coercivity ($\\alpha$) constants. This foundational practice connects these abstract mathematical values to a tangible property of the physical system: the material contrast. By deriving the quasi-optimality constant from first principles, you will see precisely how the quality of the Galerkin approximation depends on the physical characteristics of the problem [@problem_id:3368751].", "problem": "Let $\\Omega \\subset \\mathbb{R}^{d}$ be a bounded Lipschitz domain and let $V := H^{1}_{0}(\\Omega)$ be the Sobolev space of functions with square-integrable weak gradients that vanish on $\\partial \\Omega$, equipped with the norm $\\|v\\|_{V} := \\|\\nabla v\\|_{L^{2}(\\Omega)^{d}}$. Consider the bilinear form\n$$\na(u,v) := \\int_{\\Omega} A(x)\\,\\nabla u(x) \\cdot \\nabla v(x)\\,dx,\n$$\nwhere $A:\\Omega \\to \\mathbb{R}^{d \\times d}$ is a symmetric positive definite (SPD) matrix field that is piecewise constant on a shape-regular partition of $\\Omega$. Assume that there exist positive constants $\\lambda_{\\min}$ and $\\lambda_{\\max}$ such that, for almost every $x \\in \\Omega$, all eigenvalues of $A(x)$ lie in the interval $[\\lambda_{\\min},\\lambda_{\\max}]$. Define the contrast $\\kappa := \\lambda_{\\max}/\\lambda_{\\min}$, which may be large (high-contrast regime). Let $u \\in V$ be the unique solution to the variational problem $a(u,v) = \\ell(v)$ for all $v \\in V$, where $\\ell \\in V^{\\ast}$ is a bounded linear functional, and let $V_{h} \\subset V$ be any conforming finite-dimensional subspace with Galerkin approximation $u_{h} \\in V_{h}$ satisfying $a(u_{h},v_{h}) = \\ell(v_{h})$ for all $v_{h} \\in V_{h}$.\n\nUsing only the SPD property of $A$ and the definitions of continuity and coercivity of bilinear forms on $V$ with respect to the norm $\\|\\cdot\\|_{V}$, derive explicit constants $M$ and $\\alpha$ such that\n$$\n|a(u,v)| \\le M\\,\\|u\\|_{V}\\,\\|v\\|_{V} \\quad \\text{for all } u,v \\in V,\n$$\nand\n$$\na(v,v) \\ge \\alpha\\,\\|v\\|_{V}^{2} \\quad \\text{for all } v \\in V.\n$$\nThen, based on the standard form of Céa's lemma, identify the quasi-optimality constant and analyze its dependence on the contrast $\\kappa$. Provide your final answer as a single closed-form analytic expression for the quasi-optimality constant in terms of $\\kappa$. No numerical approximation is required.", "solution": "The user-provided text is a valid problem statement.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n- **Domain and Function Space**: $\\Omega \\subset \\mathbb{R}^{d}$ is a bounded Lipschitz domain. The function space is $V := H^{1}_{0}(\\Omega)$.\n- **Norm**: The space $V$ is equipped with the norm $\\|v\\|_{V} := \\|\\nabla v\\|_{L^{2}(\\Omega)^{d}}$.\n- **Bilinear Form**: $a(u,v) := \\int_{\\Omega} A(x)\\,\\nabla u(x) \\cdot \\nabla v(x)\\,dx$.\n- **Coefficient Matrix**: $A:\\Omega \\to \\mathbb{R}^{d \\times d}$ is a symmetric positive definite (SPD) matrix field that is piecewise constant.\n- **Eigenvalue Bounds**: There exist positive constants $\\lambda_{\\min}$ and $\\lambda_{\\max}$ such that for almost every $x \\in \\Omega$, all eigenvalues of $A(x)$ lie in the interval $[\\lambda_{\\min},\\lambda_{\\max}]$.\n- **Contrast**: The contrast is defined as $\\kappa := \\lambda_{\\max}/\\lambda_{\\min}$.\n- **Variational Problem**: The exact solution $u \\in V$ satisfies $a(u,v) = \\ell(v)$ for all $v \\in V$, where $\\ell \\in V^{\\ast}$ is a bounded linear functional.\n- **Galerkin Approximation**: $V_{h} \\subset V$ is a conforming finite-dimensional subspace. The approximate solution $u_{h} \\in V_{h}$ satisfies $a(u_{h},v_{h}) = \\ell(v_{h})$ for all $v_{h} \\in V_{h}$.\n- **Objective**: Derive the continuity constant $M$ and coercivity constant $\\alpha$ for the bilinear form $a(\\cdot,\\cdot)$ with respect to the norm $\\|\\cdot\\|_{V}$. Then, identify the quasi-optimality constant from Céa's lemma and express it in terms of the contrast $\\kappa$.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is scientifically and mathematically sound. It describes a standard framework for the finite element analysis of a second-order elliptic partial differential equation. The assumptions (bounded Lipschitz domain, $H^1_0(\\Omega)$ space, SPD coefficient matrix) are standard for ensuring well-posedness via the Lax-Milgram theorem. The problem is well-posed, objective, complete, consistent, and poses a non-trivial question central to the numerical analysis of PDEs. It is therefore deemed **valid**.\n\n**Step 3: Verdict and Action**\nThe problem is valid. A complete solution will be provided.\n\n### Solution\n\nThe solution is presented in three parts: first, the derivation of the continuity constant $M$; second, the derivation of the coercivity constant $\\alpha$; and third, the application of these constants to Céa's lemma to find the quasi-optimality constant in terms of the contrast $\\kappa$.\n\n**1. Derivation of the Continuity Constant $M$**\n\nThe continuity of the bilinear form $a(u,v)$ requires finding a constant $M > 0$ such that $|a(u,v)| \\le M \\|u\\|_{V} \\|v\\|_{V}$ for all $u, v \\in V$.\n\nWe begin with the definition of the bilinear form:\n$$\na(u,v) = \\int_{\\Omega} A(x)\\,\\nabla u(x) \\cdot \\nabla v(x)\\,dx\n$$\nTaking the absolute value, we have:\n$$\n|a(u,v)| = \\left| \\int_{\\Omega} \\nabla v(x)^{T} A(x) \\nabla u(x) \\,dx \\right|\n$$\nUsing the triangle inequality for integrals (a specific case of the $L^1$ norm property), we move the absolute value inside the integral:\n$$\n|a(u,v)| \\le \\int_{\\Omega} |\\nabla v(x)^{T} A(x) \\nabla u(x)| \\,dx\n$$\nFor each $x \\in \\Omega$, $\\nabla u(x)$ and $\\nabla v(x)$ are vectors in $\\mathbb{R}^{d}$. We can apply the Cauchy-Schwarz inequality for the Euclidean dot product in $\\mathbb{R}^{d}$: for vectors $\\mathbf{p}, \\mathbf{q} \\in \\mathbb{R}^d$, $|\\mathbf{p} \\cdot \\mathbf{q}| \\le \\|\\mathbf{p}\\|_{\\mathbb{R}^d} \\|\\mathbf{q}\\|_{\\mathbb{R}^d}$. Let $\\mathbf{p} = A(x)\\nabla u(x)$ and $\\mathbf{q} = \\nabla v(x)$.\n$$\n|\\nabla v(x)^{T} A(x) \\nabla u(x)| \\le \\|A(x)\\nabla u(x)\\|_{\\mathbb{R}^d} \\|\\nabla v(x)\\|_{\\mathbb{R}^d}\n$$\nThe norm of the matrix-vector product $\\|A(x)\\nabla u(x)\\|_{\\mathbb{R}^d}$ can be bounded by the operator norm of $A(x)$ (induced by the vector Euclidean norm), which for a symmetric matrix is its largest eigenvalue in magnitude. Since $A(x)$ is positive definite, its eigenvalues are all positive. The largest eigenvalue of $A(x)$ is denoted $\\lambda_{\\max}(A(x))$.\n$$\n\\|A(x)\\nabla u(x)\\|_{\\mathbb{R}^d} \\le \\lambda_{\\max}(A(x)) \\|\\nabla u(x)\\|_{\\mathbb{R}^d}\n$$\nBy assumption, $\\lambda_{\\max}(A(x)) \\le \\lambda_{\\max}$ for almost every $x \\in \\Omega$. Therefore,\n$$\n|\\nabla v(x)^{T} A(x) \\nabla u(x)| \\le \\lambda_{\\max} \\|\\nabla u(x)\\|_{\\mathbb{R}^d} \\|\\nabla v(x)\\|_{\\mathbb{R}^d}\n$$\nSubstituting this back into the integral inequality:\n$$\n|a(u,v)| \\le \\int_{\\Omega} \\lambda_{\\max} \\|\\nabla u(x)\\|_{\\mathbb{R}^d} \\|\\nabla v(x)\\|_{\\mathbb{R}^d} \\,dx\n$$\nWe can pull the constant $\\lambda_{\\max}$ outside the integral. The remaining integral is of the form $\\int_{\\Omega} f(x)g(x)\\,dx$, where $f(x) = \\|\\nabla u(x)\\|_{\\mathbb{R}^d}$ and $g(x) = \\|\\nabla v(x)\\|_{\\mathbb{R}^d}$. We apply the Cauchy-Schwarz inequality for $L^{2}(\\Omega)$ functions:\n$$\n\\int_{\\Omega} f(x)g(x)\\,dx \\le \\left(\\int_{\\Omega} f(x)^2\\,dx\\right)^{1/2} \\left(\\int_{\\Omega} g(x)^2\\,dx\\right)^{1/2}\n$$\nApplying this gives:\n$$\n|a(u,v)| \\le \\lambda_{\\max} \\left(\\int_{\\Omega} \\|\\nabla u(x)\\|_{\\mathbb{R}^d}^2 \\,dx\\right)^{1/2} \\left(\\int_{\\Omega} \\|\\nabla v(x)\\|_{\\mathbb{R}^d}^2 \\,dx\\right)^{1/2}\n$$\nBy definition, $\\|\\nabla w\\|_{L^2(\\Omega)^d} = \\left(\\int_{\\Omega} \\|\\nabla w(x)\\|_{\\mathbb{R}^d}^2 \\,dx\\right)^{1/2}$. This is precisely the norm $\\|w\\|_{V}$. Thus, we have:\n$$\n|a(u,v)| \\le \\lambda_{\\max} \\|\\nabla u\\|_{L^{2}(\\Omega)^{d}} \\|\\nabla v\\|_{L^{2}(\\Omega)^{d}} = \\lambda_{\\max} \\|u\\|_{V} \\|v\\|_{V}\n$$\nSo, the continuity constant is $M = \\lambda_{\\max}$.\n\n**2. Derivation of the Coercivity Constant $\\alpha$**\n\nThe coercivity (or V-ellipticity) of the bilinear form $a(v,v)$ requires finding a constant $\\alpha > 0$ such that $a(v,v) \\ge \\alpha \\|v\\|_{V}^{2}$ for all $v \\in V$.\n\nWe start with the definition of $a(v,v)$:\n$$\na(v,v) = \\int_{\\Omega} \\nabla v(x)^{T} A(x) \\nabla v(x) \\,dx\n$$\nFor a symmetric matrix $A(x)$, the quadratic form $\\mathbf{p}^{T}A(x)\\mathbf{p}$ is bounded below by its smallest eigenvalue. Specifically, $\\mathbf{p}^{T}A(x)\\mathbf{p} \\ge \\lambda_{\\min}(A(x)) \\|\\mathbf{p}\\|_{\\mathbb{R}^d}^2$, where $\\lambda_{\\min}(A(x))$ is the smallest eigenvalue of $A(x)$.\nLetting $\\mathbf{p} = \\nabla v(x)$, we have:\n$$\n\\nabla v(x)^{T} A(x) \\nabla v(x) \\ge \\lambda_{\\min}(A(x)) \\|\\nabla v(x)\\|_{\\mathbb{R}^d}^2\n$$\nBy assumption, $\\lambda_{\\min}(A(x)) \\ge \\lambda_{\\min}$ for almost every $x \\in \\Omega$. Therefore,\n$$\n\\nabla v(x)^{T} A(x) \\nabla v(x) \\ge \\lambda_{\\min} \\|\\nabla v(x)\\|_{\\mathbb{R}^d}^2\n$$\nIntegrating this inequality over the domain $\\Omega$:\n$$\na(v,v) = \\int_{\\Omega} \\nabla v(x)^{T} A(x) \\nabla v(x) \\,dx \\ge \\int_{\\Omega} \\lambda_{\\min} \\|\\nabla v(x)\\|_{\\mathbb{R}^d}^2 \\,dx\n$$\nWe pull the constant $\\lambda_{\\min}$ out of the integral:\n$$\na(v,v) \\ge \\lambda_{\\min} \\int_{\\Omega} \\|\\nabla v(x)\\|_{\\mathbb{R}^d}^2 \\,dx\n$$\nThe integral is the squared norm of the gradient in $L^{2}(\\Omega)^{d}$, which is the definition of $\\|v\\|_{V}^2$:\n$$\na(v,v) \\ge \\lambda_{\\min} \\|v\\|_{V}^2\n$$\nSo, the coercivity constant is $\\alpha = \\lambda_{\\min}$.\n\n**3. Céa's Lemma and the Quasi-Optimality Constant**\n\nCéa's lemma provides an upper bound on the error of the Galerkin approximation $u_h$ in the energy norm induced by the bilinear form. In our case, this is the norm $\\|\\cdot\\|_V$. The standard form of the lemma is:\n$$\n\\|u - u_h\\|_{V} \\le C \\inf_{v_h \\in V_h} \\|u - v_h\\|_{V}\n$$\nThe constant $C$ is the quasi-optimality constant. We derive it using the constants $M$ and $\\alpha$.\n\nFrom the definition of the exact solution $u$ and the Galerkin solution $u_h$, we have the Galerkin orthogonality property:\n$$\na(u - u_h, v_h) = a(u, v_h) - a(u_h, v_h) = \\ell(v_h) - \\ell(v_h) = 0 \\quad \\text{for all } v_h \\in V_h.\n$$\nNow, we use coercivity for the error $e = u - u_h$:\n$$\n\\alpha \\|u - u_h\\|_{V}^2 \\le a(u - u_h, u - u_h)\n$$\nFor any arbitrary $v_h \\in V_h$, we can write $u - u_h = (u - v_h) + (v_h - u_h)$. Using the bilinearity of $a(\\cdot,\\cdot)$:\n$$\na(u - u_h, u - u_h) = a(u - u_h, (u - v_h) + (v_h - u_h)) = a(u - u_h, u - v_h) + a(u - u_h, v_h - u_h)\n$$\nSince $v_h - u_h \\in V_h$, the Galerkin orthogonality implies that the second term is zero. Thus,\n$$\na(u-u_h, u-u_h) = a(u-u_h, u-v_h)\n$$\nCombining this with the coercivity inequality:\n$$\n\\alpha \\|u - u_h\\|_{V}^2 \\le a(u - u_h, u - v_h)\n$$\nNext, we apply the continuity property to the right-hand side:\n$$\na(u - u_h, u - v_h) \\le M \\|u - u_h\\|_{V} \\|u - v_h\\|_{V}\n$$\nCombining the last two inequalities, we get:\n$$\n\\alpha \\|u - u_h\\|_{V}^2 \\le M \\|u - u_h\\|_{V} \\|u - v_h\\|_{V}\n$$\nIf $\\|u - u_h\\|_{V} \\neq 0$, we can divide both sides by $\\alpha \\|u - u_h\\|_{V}$:\n$$\n\\|u - u_h\\|_{V} \\le \\frac{M}{\\alpha} \\|u - v_h\\|_{V}\n$$\nThis inequality holds for any $v_h \\in V_h$. Since the left side is independent of the choice of $v_h$, we can take the infimum over all $v_h \\in V_h$ on the right side to obtain the tightest possible bound:\n$$\n\\|u - u_h\\|_{V} \\le \\frac{M}{\\alpha} \\inf_{v_h \\in V_h} \\|u - v_h\\|_{V}\n$$\nComparing this with the standard form of Céa's lemma, the quasi-optimality constant is $C = \\frac{M}{\\alpha}$.\n\nFinally, we express this constant in terms of the contrast $\\kappa$. We found that $M = \\lambda_{\\max}$ and $\\alpha = \\lambda_{\\min}$. The problem defines the contrast as $\\kappa = \\lambda_{\\max}/\\lambda_{\\min}$.\nTherefore, the quasi-optimality constant is:\n$$\nC = \\frac{\\lambda_{\\max}}{\\lambda_{\\min}} = \\kappa\n$$\nThe analysis shows that the quasi-optimality constant is equal to the contrast of the diffusion coefficient. A high-contrast problem (large $\\kappa$) leads to a large quasi-optimality constant, indicating that the Galerkin solution may not be as close to the best approximation in $V_h$ in the energy norm.", "answer": "$$\\boxed{\\kappa}$$", "id": "3368751"}, {"introduction": "Theoretical guarantees like Céa's lemma are built upon a foundation of critical assumptions. This practice provides a hands-on exploration of what occurs when one of these pillars—the conformity of the discrete approximation space—is removed. By deliberately using a nonconforming trial space and calculating the resulting error, you will gain a deeper appreciation for why conformity is essential for the quasi-optimality guarantee to hold [@problem_id:3368752].", "problem": "Consider the one-dimensional model Partial Differential Equation (PDE) on the interval $(0,1)$: find $u \\in H^{1}_{0}(0,1)$ such that\n$$\n\\int_{0}^{1} u'(x)\\,v'(x)\\,\\mathrm{d}x \\;=\\; \\int_{0}^{1} v(x)\\,\\mathrm{d}x \\quad \\text{for all } v \\in H^{1}_{0}(0,1),\n$$\nwhere $H^{1}_{0}(0,1)$ is the usual Sobolev space of functions with square-integrable derivatives that vanish at the endpoints, and the bilinear form is $a(u,v)=\\int_{0}^{1} u'(x)\\,v'(x)\\,\\mathrm{d}x$ with the energy norm $\\|w\\|_{a}=\\big(a(w,w)\\big)^{1/2}=\\|w'\\|_{L^{2}(0,1)}$. This variational formulation arises from the strong form $-u''(x)=1$ on $(0,1)$ with $u(0)=0$ and $u(1)=0$.\n\nA known sufficient condition ensuring quasi-optimality of Galerkin approximations is the conformity of the discrete trial space to the continuous space. To explore a failure mode, deliberately violate conformity by using the nonconforming one-dimensional trial space\n$$\nW_{h} \\;=\\; \\operatorname{span}\\{\\,\\varphi\\,\\}, \\quad \\varphi(x)=x,\n$$\nwhich is not a subspace of $H^{1}_{0}(0,1)$ because $\\varphi(1)\\neq 0$. Define the discrete approximation $u_{h}\\in W_{h}$ by the nonconforming Galerkin equations\n$$\n\\int_{0}^{1} u_{h}'(x)\\,w'(x)\\,\\mathrm{d}x \\;=\\; \\int_{0}^{1} w(x)\\,\\mathrm{d}x \\quad \\text{for all } w \\in W_{h}.\n$$\nMeasure errors in the energy norm $\\|\\cdot\\|_{a}$. Compute the exact value of the ratio\n$$\nR \\;=\\; \\frac{\\|u - u_{h}\\|_{a}}{\\displaystyle \\inf_{w \\in W_{h}} \\|u - w\\|_{a}}\\,.\n$$\nExpress your final answer as an exact value; no rounding is required.", "solution": "The objective is to compute the ratio $R = \\frac{\\|u - u_{h}\\|_{a}}{\\displaystyle \\inf_{w \\in W_{h}} \\|u - w\\|_{a}}$. This requires several steps: first, finding the exact solution $u$ to the continuous problem; second, finding the discrete approximation $u_h$ from the nonconforming Galerkin method; third, computing the error $\\|u - u_h\\|_a$; and fourth, computing the best approximation error $\\inf_{w \\in W_{h}} \\|u - w\\|_{a}$.\n\nStep 1: Find the exact solution $u(x)$.\nThe problem is given in its weak form. The corresponding strong form is the Poisson equation $-u''(x) = 1$ on the interval $(0,1)$, with homogeneous Dirichlet boundary conditions $u(0)=0$ and $u(1)=0$.\nIntegrating the differential equation $-u''(x) = 1$ once with respect to $x$ yields:\n$$\n-u'(x) = x + C_1\n$$\nwhere $C_1$ is a constant of integration.\nIntegrating a second time yields:\n$$\n-u(x) = \\frac{1}{2}x^2 + C_1 x + C_2\n$$\nso $u(x) = -\\frac{1}{2}x^2 - C_1 x - C_2$.\nWe apply the boundary conditions to determine the constants $C_1$ and $C_2$.\nThe condition $u(0)=0$ implies:\n$$\nu(0) = -\\frac{1}{2}(0)^2 - C_1(0) - C_2 = 0 \\implies C_2 = 0\n$$\nThe condition $u(1)=0$ implies:\n$$\nu(1) = -\\frac{1}{2}(1)^2 - C_1(1) - 0 = 0 \\implies -\\frac{1}{2} - C_1 = 0 \\implies C_1 = -\\frac{1}{2}\n$$\nSubstituting the values of $C_1$ and $C_2$, the exact solution is:\n$$\nu(x) = -\\frac{1}{2}x^2 - \\left(-\\frac{1}{2}\\right)x - 0 = \\frac{1}{2}x - \\frac{1}{2}x^2 = \\frac{1}{2}x(1-x)\n$$\nThe derivative of the exact solution is:\n$$\nu'(x) = \\frac{1}{2} - x\n$$\n\nStep 2: Find the discrete approximation $u_h(x)$.\nThe discrete trial space is $W_h = \\operatorname{span}\\{\\varphi\\}$ with $\\varphi(x)=x$. An element $u_h \\in W_h$ can be written as $u_h(x) = c \\, \\varphi(x) = cx$ for some constant coefficient $c \\in \\mathbb{R}$. The derivative is $u_h'(x) = c$.\nThe nonconforming Galerkin equation is:\n$$\n\\int_{0}^{1} u_{h}'(x)\\,w'(x)\\,\\mathrm{d}x \\;=\\; \\int_{0}^{1} w(x)\\,\\mathrm{d}x \\quad \\text{for all } w \\in W_h\n$$\nSince $W_h$ is a one-dimensional space, it suffices to test with the basis function $w(x) = \\varphi(x) = x$. Its derivative is $w'(x) = 1$.\nSubstituting $u_h'(x)=c$ and $w(x)=x, w'(x)=1$ into the Galerkin equation gives:\n$$\n\\int_{0}^{1} c \\cdot 1 \\,\\mathrm{d}x \\;=\\; \\int_{0}^{1} x\\,\\mathrm{d}x\n$$\nEvaluating the integrals:\nThe left-hand side (LHS) is:\n$$\n\\int_{0}^{1} c \\,\\mathrm{d}x = c [x]_{0}^{1} = c\n$$\nThe right-hand side (RHS) is:\n$$\n\\int_{0}^{1} x\\,\\mathrm{d}x = \\left[\\frac{1}{2}x^2\\right]_{0}^{1} = \\frac{1}{2}\n$$\nEquating the LHS and RHS gives $c = \\frac{1}{2}$.\nThus, the discrete approximation is $u_h(x) = \\frac{1}{2}x$, and its derivative is $u_h'(x) = \\frac{1}{2}$.\n\nStep 3: Compute the numerator $\\|u - u_h\\|_a$.\nThe numerator is the error of the discrete solution measured in the energy norm. By definition, $\\|v\\|_a^2 = \\int_0^1 (v'(x))^2 \\mathrm{d}x$.\n$$\n\\|u - u_h\\|_a^2 = \\int_{0}^{1} (u'(x) - u_h'(x))^2\\,\\mathrm{d}x\n$$\nThe difference in the derivatives is:\n$$\nu'(x) - u_h'(x) = \\left(\\frac{1}{2} - x\\right) - \\frac{1}{2} = -x\n$$\nSubstituting this into the integral:\n$$\n\\|u - u_h\\|_a^2 = \\int_{0}^{1} (-x)^2\\,\\mathrm{d}x = \\int_{0}^{1} x^2\\,\\mathrm{d}x = \\left[\\frac{1}{3}x^3\\right]_{0}^{1} = \\frac{1}{3}\n$$\nTherefore, the error is:\n$$\n\\|u - u_h\\|_a = \\sqrt{\\frac{1}{3}} = \\frac{1}{\\sqrt{3}}\n$$\n\nStep 4: Compute the denominator $\\inf_{w \\in W_{h}} \\|u - w\\|_{a}$.\nThe denominator is the best approximation error, i.e., the smallest possible error in the energy norm between the exact solution $u$ and any function $w$ in the discrete space $W_h$.\nAn arbitrary function $w \\in W_h$ has the form $w(x) = \\alpha x$ for some $\\alpha \\in \\mathbb{R}$, so $w'(x) = \\alpha$.\nWe want to find the value of $\\alpha$ that minimizes $\\|u-w\\|_a$. This is equivalent to minimizing the squared norm $\\|u-w\\|_a^2$.\n$$\n\\|u - w\\|_a^2 = \\int_{0}^{1} (u'(x) - w'(x))^2\\,\\mathrm{d}x = \\int_{0}^{1} \\left(\\left(\\frac{1}{2} - x\\right) - \\alpha\\right)^2\\,\\mathrm{d}x\n$$\nLet $E(\\alpha) = \\|u - w\\|_a^2$. To find the minimum, we differentiate $E(\\alpha)$ with respect to $\\alpha$ and set the derivative to zero.\n$$\n\\frac{\\mathrm{d}E}{\\mathrm{d}\\alpha} = \\frac{\\mathrm{d}}{\\mathrm{d}\\alpha} \\int_{0}^{1} \\left(\\frac{1}{2} - \\alpha - x\\right)^2\\,\\mathrm{d}x = \\int_{0}^{1} 2\\left(\\frac{1}{2} - \\alpha - x\\right)(-1)\\,\\mathrm{d}x = -2 \\int_{0}^{1} \\left(\\frac{1}{2} - \\alpha - x\\right)\\,\\mathrm{d}x\n$$\nSetting $\\frac{\\mathrm{d}E}{\\mathrm{d}\\alpha} = 0$:\n$$\n\\int_{0}^{1} \\left(\\frac{1}{2} - \\alpha - x\\right)\\,\\mathrm{d}x = 0\n$$\n$$\n\\left[\\frac{1}{2}x - \\alpha x - \\frac{1}{2}x^2\\right]_{0}^{1} = 0\n$$\n$$\n\\left(\\frac{1}{2} - \\alpha - \\frac{1}{2}\\right) - 0 = 0 \\implies -\\alpha = 0 \\implies \\alpha = 0\n$$\nThe infimum is achieved when $\\alpha=0$, which corresponds to the best approximation being $w(x)=0$.\nThe value of the infimum is then $\\|u - 0\\|_a = \\|u\\|_a$.\nWe compute $\\|u\\|_a^2$:\n$$\n\\|u\\|_a^2 = \\int_{0}^{1} (u'(x))^2\\,\\mathrm{d}x = \\int_{0}^{1} \\left(\\frac{1}{2} - x\\right)^2\\,\\mathrm{d}x = \\int_{0}^{1} \\left(\\frac{1}{4} - x + x^2\\right)\\,\\mathrm{d}x\n$$\n$$\n\\|u\\|_a^2 = \\left[\\frac{1}{4}x - \\frac{1}{2}x^2 + \\frac{1}{3}x^3\\right]_{0}^{1} = \\frac{1}{4} - \\frac{1}{2} + \\frac{1}{3} = \\frac{3 - 6 + 4}{12} = \\frac{1}{12}\n$$\nSo, the best approximation error is:\n$$\n\\inf_{w \\in W_{h}} \\|u - w\\|_{a} = \\sqrt{\\frac{1}{12}} = \\frac{1}{\\sqrt{4 \\cdot 3}} = \\frac{1}{2\\sqrt{3}}\n$$\n\nStep 5: Compute the ratio $R$.\nFinally, we compute the ratio $R$:\n$$\nR = \\frac{\\|u - u_{h}\\|_{a}}{\\displaystyle \\inf_{w \\in W_{h}} \\|u - w\\|_{a}} = \\frac{1/\\sqrt{3}}{1/(2\\sqrt{3})} = \\frac{1}{\\sqrt{3}} \\cdot \\frac{2\\sqrt{3}}{1} = 2\n$$\nThe value of the ratio is $2$. This result, being greater than $1$, demonstrates the loss of quasi-optimality due to the use of a nonconforming trial space. For a conforming method with a symmetric bilinear form, Céa's lemma would guarantee this ratio to be exactly $1$.", "answer": "$$\\boxed{2}$$", "id": "3368752"}, {"introduction": "The quasi-optimality constant $M/\\alpha$ provides a worst-case scenario, but is this theoretical limit ever actually approached in practice? This numerical investigation challenges you to build an extremal configuration where the Galerkin error nearly saturates the bound predicted by Céa's lemma. By engineering a problem that exposes the difference between the solution's projection in the energy norm versus the problem-specific bilinear form, you will gain insight into the sharpness of this fundamental result [@problem_id:3368757].", "problem": "Consider the following variational problem posed on the Sobolev space $H_0^1(0,1)$: find $u \\in H_0^1(0,1)$ such that for all $v \\in H_0^1(0,1)$,\n$$\na(u,v) = \\ell(v),\n$$\nwhere the bilinear form $a(\\cdot,\\cdot)$ and the linear functional $\\ell(\\cdot)$ are given by\n$$\na(u,v) := \\int_0^1 \\left( \\varepsilon\\, u'(x)\\, v'(x) + \\kappa\\, u(x)\\, v(x) \\right)\\, dx,\n\\quad\n\\ell(v) := \\int_0^1 f(x)\\, v(x)\\, dx,\n$$\nwith positive parameters $\\varepsilon > 0$ and $\\kappa > 0$, and where $f$ is chosen to produce a prescribed exact solution $u$. Let the Hilbert space norm be\n$$\n\\|w\\|_V := \\left( \\int_0^1 \\left( w'(x)^2 + w(x)^2 \\right)\\, dx \\right)^{1/2}.\n$$\nAssume the conforming Galerkin method with a Finite Element Method (FEM) subspace $V_h \\subset H_0^1(0,1)$ consisting of continuous, piecewise-linear functions relative to a mesh $\\mathcal{T}_h$ on $[0,1]$ with homogeneous Dirichlet boundary conditions. The Galerkin solution $u_h \\in V_h$ satisfies\n$$\na(u_h, v_h) = \\ell(v_h) \\quad \\text{for all } v_h \\in V_h.\n$$\nRecall Céa’s lemma: if $a(\\cdot,\\cdot)$ is continuous and coercive on $H_0^1(0,1)$ with respect to $\\|\\cdot\\|_V$, that is,\n$$\n|a(w,v)| \\le M\\, \\|w\\|_V\\, \\|v\\|_V \\quad \\text{and} \\quad a(w,w) \\ge \\alpha\\, \\|w\\|_V^2 \\quad \\text{for all } w,v \\in H_0^1(0,1),\n$$\nthen\n$$\n\\|u - u_h\\|_V \\le \\frac{M}{\\alpha} \\inf_{v_h \\in V_h} \\|u - v_h\\|_V.\n$$\nFor the given $a(\\cdot,\\cdot)$ and $\\|\\cdot\\|_V$, one can verify that the continuity and coercivity constants satisfy\n$$\nM = \\max\\{\\varepsilon, \\kappa\\}, \\qquad \\alpha = \\min\\{\\varepsilon, \\kappa\\}.\n$$\nYour task is to numerically explore the sharpness of the constant $M/\\alpha$ in Céa’s lemma by constructing configurations in which\n$$\n\\|u - u_h\\|_V \\approx \\frac{M}{\\alpha} \\inf_{v_h \\in V_h} \\|u - v_h\\|_V.\n$$\nWork in one spatial dimension on the interval $[0,1]$. Use the exact solution\n$$\nu(x) = \\sin(\\pi x) + \\sigma \\sin(K \\pi x),\n$$\nwith $\\sigma = 1$ and an integer frequency parameter $K \\ge 1$. Choose $f$ so that $u$ solves the strong form of the partial differential equation\n$$\n- \\varepsilon\\, u''(x) + \\kappa\\, u(x) = f(x),\n$$\nwith homogeneous Dirichlet boundary conditions $u(0) = u(1) = 0$. Assemble the FEM system using standard piecewise-linear nodal basis functions on a mesh $\\mathcal{T}_h$ that is either uniform or graded, and compute:\n- the Galerkin solution $u_h \\in V_h$,\n- the best approximation $p_h \\in V_h$ in the $V$-norm, defined as the unique solution of\n$$\n(p_h, w_h)_V = (u, w_h)_V \\quad \\text{for all } w_h \\in V_h,\n$$\nwhere $(\\cdot,\\cdot)_V$ denotes the inner product associated with $\\|\\cdot\\|_V$,\n- the errors $\\|u - u_h\\|_V$ and $\\inf_{v_h \\in V_h} \\|u - v_h\\|_V = \\|u - p_h\\|_V$,\n- the saturation factor\n$$\nS := \\frac{\\|u - u_h\\|_V}{\\|u - p_h\\|_V} \\cdot \\frac{\\alpha}{M},\n$$\nwhich ideally is close to $1$ when the Céa bound is nearly sharp.\n\nImplement a program that, for each test case below, assembles the FEM matrices for $a(\\cdot,\\cdot)$ and $(\\cdot,\\cdot)_V$, constructs the right-hand side from the exact solution $u$, solves for $u_h$ and $p_h$, evaluates the $V$-norm errors using numerical quadrature, and outputs the saturation factors $S$.\n\nYou must treat the following test suite of parameter values, which tests distinct regimes and meshes:\n1. Happy path (moderate contrast, uniform mesh): ($\\varepsilon, \\kappa, K, N$, mesh) = (0.05, 1.0, 12, 64, uniform).\n2. High contrast with small diffusion (uniform mesh): ($\\varepsilon, \\kappa, K, N$, mesh) = ($10^{-3}$, 1.0, 30, 128, uniform).\n3. High contrast with small diffusion (graded mesh): ($\\varepsilon, \\kappa, K, N$, mesh) = ($10^{-3}$, 1.0, 30, 128, graded) where the graded mesh has nodes $x_i = (i/N)^\\gamma$ with grading exponent $\\gamma = 2$.\n4. High contrast with small reaction (uniform mesh): ($\\varepsilon, \\kappa, K, N$, mesh) = (1.0, $10^{-3}$, 2, 64, uniform).\n5. High contrast with small reaction (graded mesh): ($\\varepsilon, \\kappa, K, N$, mesh) = (1.0, $10^{-3}$, 2, 64, graded) with $\\gamma = 2$.\n\nAll quantities are dimensionless. Your program should produce a single line of output containing the saturation factors for the five test cases as a comma-separated list enclosed in square brackets (e.g., \"[s1,s2,s3,s4,s5]\"). Each $s_i$ must be a floating-point number. Use sufficient numerical quadrature to ensure accurate evaluation of the $V$-norms for the chosen frequencies $K$.", "solution": "The starting point is the variational formulation for a strongly elliptic second-order partial differential equation on the interval $[0,1]$ with homogeneous Dirichlet boundary conditions. The space is $H_0^1(0,1)$, and the bilinear form and linear functional are\n$$\na(u,v) = \\int_0^1 \\left( \\varepsilon\\, u'(x)\\, v'(x) + \\kappa\\, u(x)\\, v(x) \\right)\\, dx, \\quad \\ell(v) = \\int_0^1 f(x)\\, v(x)\\, dx,\n$$\nwhere $\\varepsilon > 0$ and $\\kappa > 0$. We choose the Hilbert space norm\n$$\n\\|w\\|_V := \\left( \\int_0^1 \\left( w'(x)^2 + w(x)^2 \\right)\\, dx \\right)^{1/2},\n$$\nwith associated inner product\n$$\n(w,v)_V := \\int_0^1 \\left( w'(x)\\, v'(x) + w(x)\\, v(x) \\right)\\, dx.\n$$\nBy Cauchy–Schwarz inequality and positivity of $\\varepsilon$ and $\\kappa$, the bilinear form $a(\\cdot,\\cdot)$ is continuous and coercive with respect to $\\|\\cdot\\|_V$:\n$$\n|a(w,v)| \\le \\max\\{\\varepsilon, \\kappa\\}\\, \\|w\\|_V\\, \\|v\\|_V = M\\, \\|w\\|_V\\, \\|v\\|_V,\n$$\nand\n$$\na(w,w) = \\varepsilon \\int_0^1 w'(x)^2\\, dx + \\kappa \\int_0^1 w(x)^2\\, dx \\ge \\min\\{\\varepsilon, \\kappa\\} \\left( \\int_0^1 w'(x)^2\\, dx + \\int_0^1 w(x)^2\\, dx \\right) = \\alpha\\, \\|w\\|_V^2.\n$$\nTherefore, Céa’s lemma applies and yields\n$$\n\\|u - u_h\\|_V \\le \\frac{M}{\\alpha} \\inf_{v_h \\in V_h} \\|u - v_h\\|_V.\n$$\nThe core idea to assess sharpness is that the proof of Céa’s lemma uses inequalities that become near-equalities in certain extremal configurations. Specifically:\n- The lower bound $a(w,w) \\ge \\alpha \\|w\\|_V^2$ is nearly an equality when the portion of $\\|w\\|_V$ corresponding to the weaker coefficient dominates. For instance, if $\\varepsilon \\ll \\kappa$, then the bound is nearly sharp for functions with negligible $L^2$ contribution compared to their $H^1$ seminorm, such as highly oscillatory functions.\n- The upper bound $|a(w,w)| \\le M \\|w\\|_V^2$ is nearly an equality when the portion of $\\|w\\|_V$ corresponding to the stronger coefficient dominates.\n\nThe Galerkin solution $u_h$ is the $a(\\cdot,\\cdot)$-orthogonal projection of $u$ onto $V_h$, while the best approximation $p_h$ is the $(\\cdot,\\cdot)_V$-orthogonal projection of $u$ onto $V_h$. If $a(\\cdot,\\cdot)$ and $(\\cdot,\\cdot)_V$ have significantly different weights (e.g., $\\varepsilon \\ll \\kappa$ or $\\kappa \\ll \\varepsilon$), then these projections can differ substantially, and the ratio $\\|u-u_h\\|_V / \\|u - p_h\\|_V$ can be close to the extremal factor $M/\\alpha$.\n\nWe operationalize this with the following construction:\n1. Choose the exact solution\n$$\nu(x) = \\sin(\\pi x) + \\sigma \\sin(K \\pi x),\n$$\nwith $\\sigma = 1$ and frequency $K \\in \\mathbb{N}$. This combines a low-frequency mode and a high-frequency mode, enabling the derivative term to dominate for large $K$.\n2. Compute $f$ via the strong form $- \\varepsilon u'' + \\kappa u = f$. Since $u''(x) = -\\pi^2 \\sin(\\pi x) - \\sigma K^2 \\pi^2 \\sin(K \\pi x)$, one obtains\n$$\nf(x) = (\\varepsilon \\pi^2 + \\kappa)\\, \\sin(\\pi x) + \\sigma (\\varepsilon K^2 \\pi^2 + \\kappa)\\, \\sin(K \\pi x).\n$$\n3. Discretize $[0,1]$ with a mesh $\\mathcal{T}_h$, uniform or graded with nodes $x_i = (i/N)^\\gamma$ for a grading exponent $\\gamma = 2$. Let $V_h$ be the space of piecewise-linear functions vanishing at $0$ and $1$.\n4. Assemble the global FEM matrices:\n- The stiffness matrix $K_h$ with entries\n$$\n(K_h)_{ij} = \\int_0^1 \\varphi_i'(x)\\, \\varphi_j'(x)\\, dx,\n$$\n- The mass matrix $M_h$ with entries\n$$\n(M_h)_{ij} = \\int_0^1 \\varphi_i(x)\\, \\varphi_j(x)\\, dx,\n$$\nfor nodal basis functions $\\{\\varphi_i\\}$ associated with internal nodes.\nThese are computed element-wise using the standard local formulas for piecewise-linear elements on each interval $[x_a, x_b]$:\n$$\nK_e = \\frac{1}{h} \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix}, \\quad\nM_e = \\frac{h}{6} \\begin{pmatrix} 2 & 1 \\\\ 1 & 2 \\end{pmatrix},\n$$\nwhere $h = x_b - x_a$.\n5. Construct the load vector $\\mathbf{F}_h$ for the Galerkin problem by numerical quadrature:\n$$\n(\\mathbf{F}_h)_i = \\int_0^1 f(x)\\, \\varphi_i(x)\\, dx.\n$$\n6. Solve the Galerkin linear system\n$$\nA_h\\, \\mathbf{u}_h = \\mathbf{F}_h, \\quad \\text{where } A_h = \\varepsilon K_h + \\kappa M_h,\n$$\nto obtain the coefficient vector $\\mathbf{u}_h$ of $u_h$ in the basis $\\{\\varphi_i\\}$.\n7. Compute the $(\\cdot,\\cdot)_V$-orthogonal projection $p_h$ by solving\n$$\nS_h\\, \\mathbf{p}_h = \\mathbf{b}_h, \\quad \\text{where } S_h = K_h + M_h, \\quad (\\mathbf{b}_h)_i = \\int_0^1 \\left( u'(x)\\, \\varphi_i'(x) + u(x)\\, \\varphi_i(x) \\right)\\, dx.\n$$\n8. Evaluate the $V$-norm errors $\\|u - u_h\\|_V$ and $\\|u - p_h\\|_V$ with numerical quadrature over each element:\n$$\n\\|u - w_h\\|_V^2 = \\int_0^1 \\left( (u'(x) - w_h'(x))^2 + (u(x) - w_h(x))^2 \\right)\\, dx,\n$$\nwhere $w_h$ is either $u_h$ or $p_h$, and $w_h'$ is piecewise constant on each element for linear elements. A high-order Gauss–Legendre quadrature is employed with a number of points proportional to $K$ to resolve oscillations.\n9. Compute the saturation factor\n$$\nS = \\frac{\\|u - u_h\\|_V}{\\|u - p_h\\|_V} \\cdot \\frac{\\alpha}{M}, \\quad \\alpha = \\min\\{\\varepsilon,\\kappa\\}, \\quad M = \\max\\{\\varepsilon,\\kappa\\}.\n$$\nBy Céa’s lemma, one has $S \\le 1$. Values of $S$ close to $1$ indicate near-sharpness of the constant $M/\\alpha$ under the chosen bilinear form and mesh.\n\nAlgorithmic notes:\n- The assembly of $K_h$ and $M_h$ uses the canonical local element matrices for linear finite elements with homogeneous Dirichlet boundary conditions, skipping boundary nodes.\n- For load and error integrals, Gauss–Legendre quadrature with a sufficiently large number of points per element ensures accurate integration of products involving trigonometric functions and linear basis functions. A choice such as $n_q = \\max\\{16, 2K\\}$ points per element balances efficiency and accuracy for the given test suite.\n- The linear systems are symmetric positive definite and solved with standard dense solvers due to the small problem sizes in the test suite.\n\nThe program implements these steps and outputs the saturation factors for the specified five test cases as a single comma-separated list enclosed in square brackets, providing numerical evidence of how different bilinear forms (controlled by $\\varepsilon$ and $\\kappa$) and meshes (uniform versus graded) can nearly saturate Céa’s constant in the quasi-optimality bound.", "answer": "```python\nimport numpy as np\n\n# We will not use SciPy to keep dependencies minimal, numpy suffices for small systems.\n\ndef gauss_legendre(n, a, b):\n    # Returns nodes and weights for Gauss-Legendre quadrature on [a, b]\n    x, w = np.polynomial.legendre.leggauss(n)\n    # map from [-1,1] to [a,b]\n    xm = 0.5 * (b - a) * x + 0.5 * (a + b)\n    wm = 0.5 * (b - a) * w\n    return xm, wm\n\ndef make_mesh(N, mesh_type='uniform', gamma=2.0):\n    if mesh_type == 'uniform':\n        nodes = np.linspace(0.0, 1.0, N + 1)\n    elif mesh_type == 'graded':\n        i = np.arange(N + 1)\n        nodes = (i / N) ** gamma\n    else:\n        raise ValueError(\"Unknown mesh_type\")\n    return nodes\n\ndef assemble_matrices(nodes):\n    # Assemble global stiffness K_h and mass M_h for linear FEM on [0,1]\n    N = len(nodes) - 1\n    n_internal = N - 1\n    K = np.zeros((n_internal, n_internal))\n    M = np.zeros((n_internal, n_internal))\n    for e in range(N):\n        xa = nodes[e]\n        xb = nodes[e + 1]\n        h = xb - xa\n        # local matrices\n        Ke = (1.0 / h) * np.array([[1.0, -1.0], [-1.0, 1.0]])\n        Me = (h / 6.0) * np.array([[2.0, 1.0], [1.0, 2.0]])\n        # global indices for internal nodes: 0..N\n        # internal nodes are 1..N-1\n        g0 = e      # left node index in global numbering\n        g1 = e + 1  # right node index\n        # map to internal index (0..n_internal-1), skip boundaries\n        idx = []\n        if 1 <= g0 <= N - 1:\n            idx.append(g0 - 1)\n        else:\n            idx.append(None)\n        if 1 <= g1 <= N - 1:\n            idx.append(g1 - 1)\n        else:\n            idx.append(None)\n        # assemble\n        for i_local in range(2):\n            gi = idx[i_local]\n            if gi is None:\n                continue\n            for j_local in range(2):\n                gj = idx[j_local]\n                if gj is None:\n                    continue\n                K[gi, gj] += Ke[i_local, j_local]\n                M[gi, gj] += Me[i_local, j_local]\n    return K, M\n\ndef u_exact(x, Kfreq, sigma=1.0):\n    return np.sin(np.pi * x) + sigma * np.sin(Kfreq * np.pi * x)\n\ndef du_exact(x, Kfreq, sigma=1.0):\n    return np.pi * np.cos(np.pi * x) + sigma * Kfreq * np.pi * np.cos(Kfreq * np.pi * x)\n\ndef f_rhs(x, eps, kap, Kfreq, sigma=1.0):\n    # f = -eps u'' + kap u\n    # u'' = -pi^2 sin(pi x) - sigma * K^2 * pi^2 * sin(K pi x)\n    term1 = (eps * (np.pi ** 2) + kap) * np.sin(np.pi * x)\n    term2 = sigma * (eps * (Kfreq ** 2) * (np.pi ** 2) + kap) * np.sin(Kfreq * np.pi * x)\n    return term1 + term2\n\ndef assemble_load(nodes, eps, kap, Kfreq, sigma=1.0):\n    # Assemble load vector F_h with (F)_i = \\int f(x) * phi_i(x)\n    N = len(nodes) - 1\n    n_internal = N - 1\n    F = np.zeros(n_internal)\n    # Quadrature points per element, scale with frequency to capture oscillations\n    nq = max(16, 2 * Kfreq)\n    for e in range(N):\n        xa = nodes[e]\n        xb = nodes[e + 1]\n        h = xb - xa\n        xq, wq = gauss_legendre(nq, xa, xb)\n        # local basis functions N1 and N2 on element\n        # N1(xa)=1,N1(xb)=0 ; N2(xa)=0,N2(xb)=1\n        N1 = (xb - xq) / h\n        N2 = (xq - xa) / h\n        fq = f_rhs(xq, eps, kap, Kfreq, sigma)\n        # contributions to local load vector\n        Fe_local = np.array([np.dot(wq, fq * N1), np.dot(wq, fq * N2)])\n        # global indices\n        g0 = e\n        g1 = e + 1\n        idx0 = g0 - 1 if 1 <= g0 <= N - 1 else None\n        idx1 = g1 - 1 if 1 <= g1 <= N - 1 else None\n        if idx0 is not None:\n            F[idx0] += Fe_local[0]\n        if idx1 is not None:\n            F[idx1] += Fe_local[1]\n    return F\n\ndef assemble_V_rhs(nodes, Kfreq, sigma=1.0):\n    # Assemble b_V with (b)_i = \\int [ u'(x) * phi_i'(x) + u(x) * phi_i(x) ] dx\n    N = len(nodes) - 1\n    n_internal = N - 1\n    b = np.zeros(n_internal)\n    nq = max(16, 2 * Kfreq)\n    for e in range(N):\n        xa = nodes[e]\n        xb = nodes[e + 1]\n        h = xb - xa\n        # phi' are constants on element:\n        # local derivatives: dN1/dx = -1/h, dN2/dx = 1/h\n        dN_local = np.array([-1.0 / h, 1.0 / h])\n        xq, wq = gauss_legendre(nq, xa, xb)\n        uq = u_exact(xq, Kfreq, sigma)\n        # local N1, N2 values\n        N1 = (xb - xq) / h\n        N2 = (xq - xa) / h\n        # local contributions: integrate u' * phi_i' + u * phi_i\n        # u' term: \\int u'(x) dx * phi_i' is exact integral of u' times constant, but we do quadrature for uniformity\n        duq = du_exact(xq, Kfreq, sigma)\n        # local vector\n        b_local = np.zeros(2)\n        b_local[0] = np.dot(wq, duq * dN_local[0] + uq * N1)\n        b_local[1] = np.dot(wq, duq * dN_local[1] + uq * N2)\n        # global indices\n        g0 = e\n        g1 = e + 1\n        idx0 = g0 - 1 if 1 <= g0 <= N - 1 else None\n        idx1 = g1 - 1 if 1 <= g1 <= N - 1 else None\n        if idx0 is not None:\n            b[idx0] += b_local[0]\n        if idx1 is not None:\n            b[idx1] += b_local[1]\n    return b\n\ndef eval_fem_function_on_element(x, xa, xb, c_left, c_right):\n    # Evaluate piecewise linear FEM function at points x in [xa,xb]\n    h = xb - xa\n    N1 = (xb - x) / h\n    N2 = (x - xa) / h\n    return c_left * N1 + c_right * N2\n\ndef eval_fem_derivative_on_element(xa, xb, c_left, c_right):\n    # Derivative is constant on element\n    h = xb - xa\n    return (-c_left + c_right) / h\n\ndef compute_V_error(nodes, coeff, Kfreq, sigma=1.0):\n    # Compute ||u - w_h||_V with w_h represented by coeff on internal nodes\n    N = len(nodes) - 1\n    n_internal = N - 1\n    err_sq = 0.0\n    # quadrature points per element\n    nq = max(16, 2 * Kfreq)\n    for e in range(N):\n        xa = nodes[e]\n        xb = nodes[e + 1]\n        # coefficients at element nodes, apply Dirichlet at boundaries\n        g0 = e\n        g1 = e + 1\n        if g0 == 0:\n            c0 = 0.0\n        else:\n            c0 = coeff[g0 - 1]\n        if g1 == N:\n            c1 = 0.0\n        else:\n            c1 = coeff[g1 - 1]\n        xq, wq = gauss_legendre(nq, xa, xb)\n        uh = eval_fem_function_on_element(xq, xa, xb, c0, c1)\n        duh = eval_fem_derivative_on_element(xa, xb, c0, c1)\n        ue = u_exact(xq, Kfreq, sigma)\n        due = du_exact(xq, Kfreq, sigma)\n        diff = ue - uh\n        ddiff = due - duh\n        err_sq += np.dot(wq, ddiff * ddiff + diff * diff)\n    return np.sqrt(err_sq)\n\ndef run_case(eps, kap, Kfreq, N, mesh_type):\n    nodes = make_mesh(N, mesh_type=mesh_type, gamma=2.0)\n    Kmat, Mmat = assemble_matrices(nodes)\n    F = assemble_load(nodes, eps, kap, Kfreq, sigma=1.0)\n    A = eps * Kmat + kap * Mmat\n    # Solve Galerkin system\n    uh_coeff = np.linalg.solve(A, F)\n    # Solve V-projection system\n    S_mat = Kmat + Mmat\n    bV = assemble_V_rhs(nodes, Kfreq, sigma=1.0)\n    ph_coeff = np.linalg.solve(S_mat, bV)\n    # Compute errors\n    e_gal = compute_V_error(nodes, uh_coeff, Kfreq, sigma=1.0)\n    e_best = compute_V_error(nodes, ph_coeff, Kfreq, sigma=1.0)\n    # Compute M/alpha and saturation factor S = (e_gal/e_best) * (alpha/M)\n    M = max(eps, kap)\n    alpha = min(eps, kap)\n    sat = (e_gal / e_best) * (alpha / M)\n    return sat\n\ndef solve():\n    test_cases = [\n        (0.05, 1.0, 12, 64, 'uniform'),    # Case 1\n        (1e-3, 1.0, 30, 128, 'uniform'),   # Case 2\n        (1e-3, 1.0, 30, 128, 'graded'),    # Case 3\n        (1.0, 1e-3, 2, 64, 'uniform'),     # Case 4\n        (1.0, 1e-3, 2, 64, 'graded'),      # Case 5\n    ]\n    results = []\n    for eps, kap, Kfreq, N, mesh_type in test_cases:\n        sat = run_case(eps, kap, Kfreq, N, mesh_type)\n        results.append(sat)\n    # Print as single line with comma-separated floats in list format\n    print(f\"[{results[0]},{results[1]},{results[2]},{results[3]},{results[4]}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "3368757"}]}