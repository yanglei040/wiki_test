{"hands_on_practices": [{"introduction": "Understanding the finite element method begins with mastering its fundamental mechanics. This exercise walks you through the essential process of constructing a local operator matrix for the advection equation, starting from the canonical basis functions on a reference element [@problem_id:3441775]. By performing this step-by-step derivation, you will solidify your understanding of isoparametric mapping, the role of the Jacobian in transforming gradients, and how these components come together to form the semi-discrete system.", "problem": "Consider the constant-coefficient linear hyperbolic partial differential equation (PDE) $u_{t} + \\boldsymbol{c}\\cdot \\nabla u = 0$ on a two-dimensional polygonal domain, where $\\boldsymbol{c} = (a,b)$ is constant. Let a conforming triangulation be given, and consider a single triangular element $K$ with vertices $\\boldsymbol{x}_{1} = (x_{1},y_{1})$, $\\boldsymbol{x}_{2} = (x_{2},y_{2})$, and $\\boldsymbol{x}_{3} = (x_{3},y_{3})$. Assume the vertices are labeled so that the element mapping defined below is orientation preserving.\n\nYou will use the continuous piecewise-linear Lagrange finite element space $\\mathbb{P}_{1}$ on $K$. Let the reference triangle be $\\widehat{K} = \\{(\\xi,\\eta)\\,:\\,\\xi \\ge 0,\\ \\eta \\ge 0,\\ \\xi+\\eta \\le 1\\}$ with vertices at $(0,0)$, $(1,0)$, and $(0,1)$.\n\nTasks:\n1) Construct the canonical nodal Lagrange basis functions on the reference element $\\widehat{K}$ for $\\mathbb{P}_{1}$ and justify their form from first principles (interpolation conditions at reference vertices).\n2) Describe the isoparametric mapping from $\\widehat{K}$ to the physical element $K$ that is affine and nodally exact. Define its Jacobian matrix and interpret it geometrically.\n3) Using only the multivariable chain rule for differentiable mappings as your base principle, state precisely how gradients of basis functions transform under the element mapping and express the physical gradients of the $\\mathbb{P}_{1}$ basis on $K$ in terms of the Jacobian.\n4) In the standard Galerkin semi-discretization of the PDE on $K$, the local advection matrix $A_{e}$ has entries $(A_{e})_{ij} = \\int_{K} (\\boldsymbol{c}\\cdot \\nabla \\varphi_{j})\\,\\varphi_{i}\\, \\mathrm{d}\\boldsymbol{x}$, where $\\{\\varphi_{i}\\}_{i=1}^{3}$ are the physical $\\mathbb{P}_{1}$ basis functions associated with the vertices $\\boldsymbol{x}_{i}$. Using the ingredients from parts 1)â€“3), derive a closed-form expression for the specific entry $(A_{e})_{12}$ in terms of $a$, $b$, and the vertex coordinates $(x_{1},y_{1})$, $(x_{2},y_{2})$, $(x_{3},y_{3})$ only.\n\nExpress your final answer as a single closed-form analytic expression. No rounding is required and no units are needed.", "solution": "The problem as stated is scientifically grounded, well-posed, objective, and self-contained. It presents a standard, multi-part derivation in the field of numerical analysis for partial differential equations, specifically the Finite Element Method (FEM) for linear hyperbolic problems. All terms are standard and unambiguously defined. The problem is therefore valid, and a solution will be furnished. The derivation will proceed through the four specified tasks.\n\nThe governing partial differential equation is the linear advection equation, $u_{t} + \\boldsymbol{c}\\cdot \\nabla u = 0$, where the advection velocity $\\boldsymbol{c}=(a,b)$ is a constant vector in $\\mathbb{R}^{2}$. We analyze the spatial discretization on a single triangular element $K$ with vertices $\\boldsymbol{x}_{1} = (x_{1},y_{1})$, $\\boldsymbol{x}_{2} = (x_{2},y_{2})$, and $\\boldsymbol{x}_{3} = (x_{3},y_{3})$. The finite element space is the space of continuous piecewise-linear polynomials, denoted $\\mathbb{P}_{1}(K)$.\n\n**1) Canonical Nodal Basis Functions on the Reference Element**\n\nThe reference finite element is the triangle $\\widehat{K} = \\{(\\xi,\\eta) \\in \\mathbb{R}^{2} \\,:\\, \\xi \\ge 0,\\ \\eta \\ge 0,\\ \\xi+\\eta \\le 1\\}$, with vertices $\\widehat{\\boldsymbol{x}}_{1}=(0,0)$, $\\widehat{\\boldsymbol{x}}_{2}=(1,0)$, and $\\widehat{\\boldsymbol{x}}_{3}=(0,1)$. A function $\\widehat{\\varphi}(\\xi,\\eta)$ in the space $\\mathbb{P}_{1}(\\widehat{K})$ must be a linear polynomial of the form $\\widehat{\\varphi}(\\xi,\\eta) = C_{1} + C_{2}\\xi + C_{3}\\eta$ for some constants $C_{1}, C_{2}, C_{3} \\in \\mathbb{R}$.\n\nThe canonical nodal basis functions $\\{\\widehat{\\varphi}_{i}\\}_{i=1}^{3}$ are defined by the interpolatory (or \"nodal\") property $\\widehat{\\varphi}_{i}(\\widehat{\\boldsymbol{x}}_{j}) = \\delta_{ij}$, where $\\delta_{ij}$ is the Kronecker delta. We construct each basis function by solving a small system of linear equations.\n\nFor $\\widehat{\\varphi}_{1}(\\xi,\\eta)$:\n- $\\widehat{\\varphi}_{1}(\\widehat{\\boldsymbol{x}}_{1}) = \\widehat{\\varphi}_{1}(0,0) = 1 \\implies C_{1} + C_{2}(0) + C_{3}(0) = 1 \\implies C_{1}=1$.\n- $\\widehat{\\varphi}_{1}(\\widehat{\\boldsymbol{x}}_{2}) = \\widehat{\\varphi}_{1}(1,0) = 0 \\implies C_{1} + C_{2}(1) + C_{3}(0) = 0 \\implies 1+C_{2}=0 \\implies C_{2}=-1$.\n- $\\widehat{\\varphi}_{1}(\\widehat{\\boldsymbol{x}}_{3}) = \\widehat{\\varphi}_{1}(0,1) = 0 \\implies C_{1} + C_{2}(0) + C_{3}(1) = 0 \\implies 1+C_{3}=0 \\implies C_{3}=-1$.\nThus, $\\widehat{\\varphi}_{1}(\\xi,\\eta) = 1 - \\xi - \\eta$.\n\nFor $\\widehat{\\varphi}_{2}(\\xi,\\eta)$:\n- $\\widehat{\\varphi}_{2}(\\widehat{\\boldsymbol{x}}_{1}) = \\widehat{\\varphi}_{2}(0,0) = 0 \\implies C_{1} = 0$.\n- $\\widehat{\\varphi}_{2}(\\widehat{\\boldsymbol{x}}_{2}) = \\widehat{\\varphi}_{2}(1,0) = 1 \\implies C_{1} + C_{2} = 1 \\implies C_{2}=1$.\n- $\\widehat{\\varphi}_{2}(\\widehat{\\boldsymbol{x}}_{3}) = \\widehat{\\varphi}_{2}(0,1) = 0 \\implies C_{1} + C_{3} = 0 \\implies C_{3}=0$.\nThus, $\\widehat{\\varphi}_{2}(\\xi,\\eta) = \\xi$.\n\nFor $\\widehat{\\varphi}_{3}(\\xi,\\eta)$:\n- $\\widehat{\\varphi}_{3}(\\widehat{\\boldsymbol{x}}_{1}) = \\widehat{\\varphi}_{3}(0,0) = 0 \\implies C_{1} = 0$.\n- $\\widehat{\\varphi}_{3}(\\widehat{\\boldsymbol{x}}_{2}) = \\widehat{\\varphi}_{3}(1,0) = 0 \\implies C_{1} + C_{2} = 0 \\implies C_{2}=0$.\n- $\\widehat{\\varphi}_{3}(\\widehat{\\boldsymbol{x}}_{3}) = \\widehat{\\varphi}_{3}(0,1) = 1 \\implies C_{1} + C_{3} = 1 \\implies C_{3}=1$.\nThus, $\\widehat{\\varphi}_{3}(\\xi,\\eta) = \\eta$.\n\nThese three functions, $\\widehat{\\varphi}_{1}(\\xi,\\eta)=1-\\xi-\\eta$, $\\widehat{\\varphi}_{2}(\\xi,\\eta)=\\xi$, and $\\widehat{\\varphi}_{3}(\\xi,\\eta)=\\eta$, constitute the basis for $\\mathbb{P}_{1}(\\widehat{K})$. They are also known as the barycentric coordinates on the reference element.\n\n**2) Isoparametric Mapping and its Jacobian**\n\nThe isoparametric mapping $\\boldsymbol{F}: \\widehat{K} \\to K$ relates points $\\widehat{\\boldsymbol{x}}=(\\xi,\\eta)$ in the reference element to points $\\boldsymbol{x}=(x,y)$ in the physical element. It uses the same basis functions for mapping the geometry as for representing the solution. The mapping is defined by\n$$\n\\boldsymbol{x} = \\boldsymbol{F}(\\widehat{\\boldsymbol{x}}) = \\sum_{i=1}^{3} \\boldsymbol{x}_{i} \\widehat{\\varphi}_{i}(\\widehat{\\boldsymbol{x}})\n$$\nSubstituting the basis functions from part 1, we obtain\n$$\n\\boldsymbol{x} = \\boldsymbol{x}_{1}(1-\\xi-\\eta) + \\boldsymbol{x}_{2}\\xi + \\boldsymbol{x}_{3}\\eta\n$$\nThis can be rearranged into an affine transformation:\n$$\n\\boldsymbol{x} = \\boldsymbol{x}_{1} + (\\boldsymbol{x}_{2}-\\boldsymbol{x}_{1})\\xi + (\\boldsymbol{x}_{3}-\\boldsymbol{x}_{1})\\eta\n$$\nThe Jacobian matrix of this mapping, $J$, is the matrix of its first-order partial derivatives:\n$$\nJ = \\frac{\\partial \\boldsymbol{x}}{\\partial \\widehat{\\boldsymbol{x}}} = \\begin{pmatrix} \\frac{\\partial x}{\\partial \\xi} & \\frac{\\partial x}{\\partial \\eta} \\\\ \\frac{\\partial y}{\\partial \\xi} & \\frac{\\partial y}{\\partial \\eta} \\end{pmatrix}\n$$\nFrom the affine form of the mapping, we compute the partial derivatives:\n$\\frac{\\partial \\boldsymbol{x}}{\\partial \\xi} = \\boldsymbol{x}_{2} - \\boldsymbol{x}_{1}$ and $\\frac{\\partial \\boldsymbol{x}}{\\partial \\eta} = \\boldsymbol{x}_{3} - \\boldsymbol{x}_{1}$.\nIn matrix form, this gives the constant Jacobian matrix:\n$$\nJ = \\begin{pmatrix} x_2 - x_1 & x_3 - x_1 \\\\ y_2 - y_1 & y_3 - y_1 \\end{pmatrix}\n$$\nGeometrically, the columns of the Jacobian matrix $J$ are the vectors that form two of the edges of the physical triangle $K$, specifically the edges originating from vertex $\\boldsymbol{x}_{1}$. The determinant of the Jacobian, $\\det(J)$, is twice the signed area of the triangle $K$. The problem statement specifies that the mapping is orientation-preserving, which implies $\\det(J) > 0$.\n\n**3) Transformation of Gradients**\n\nLet $\\varphi$ be a scalar function on the physical element $K$ and let $\\widehat{\\varphi}$ be its corresponding function on the reference element $\\widehat{K}$, such that $\\varphi(\\boldsymbol{x})=\\widehat{\\varphi}(\\boldsymbol{F}^{-1}(\\boldsymbol{x}))$. The gradient of $\\varphi$ with respect to physical coordinates $\\boldsymbol{x}=(x,y)$ is $\\nabla_{\\boldsymbol{x}}\\varphi$, and the gradient of $\\widehat{\\varphi}$ with respect to reference coordinates $\\widehat{\\boldsymbol{x}}=(\\xi,\\eta)$ is $\\nabla_{\\widehat{\\boldsymbol{x}}}\\widehat{\\varphi}$.\n\nBy the multivariable chain rule, the derivatives are related as follows:\n$$\n\\begin{pmatrix} \\frac{\\partial \\widehat{\\varphi}}{\\partial \\xi} \\\\ \\frac{\\partial \\widehat{\\varphi}}{\\partial \\eta} \\end{pmatrix} = \\begin{pmatrix} \\frac{\\partial x}{\\partial \\xi} & \\frac{\\partial y}{\\partial \\xi} \\\\ \\frac{\\partial x}{\\partial \\eta} & \\frac{\\partial y}{\\partial \\eta} \\end{pmatrix} \\begin{pmatrix} \\frac{\\partial \\varphi}{\\partial x} \\\\ \\frac{\\partial \\varphi}{\\partial y} \\end{pmatrix}\n$$\nThis is precisely $\\nabla_{\\widehat{\\boldsymbol{x}}}\\widehat{\\varphi} = J^{T} \\nabla_{\\boldsymbol{x}}\\varphi$. To express the physical gradient in terms of the reference gradient, we invert this relation:\n$$\n\\nabla_{\\boldsymbol{x}}\\varphi = (J^{T})^{-1} \\nabla_{\\widehat{\\boldsymbol{x}}}\\widehat{\\varphi} = (J^{-1})^{T} \\nabla_{\\widehat{\\boldsymbol{x}}}\\widehat{\\varphi}\n$$\nFor the $\\mathbb{P}_{1}$ basis functions $\\varphi_i$ on $K$, this formula applies directly. The gradients of the reference basis functions $\\widehat{\\varphi}_i$ are constant vectors:\n$\\nabla_{\\widehat{\\boldsymbol{x}}}\\widehat{\\varphi}_{1} = \\begin{pmatrix} -1 \\\\ -1 \\end{pmatrix}$,\n$\\nabla_{\\widehat{\\boldsymbol{x}}}\\widehat{\\varphi}_{2} = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$,\n$\\nabla_{\\widehat{\\boldsymbol{x}}}\\widehat{\\varphi}_{3} = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}$.\nSince $J$ is constant, the physical gradients $\\nabla_{\\boldsymbol{x}}\\varphi_i$ are also constant vectors over the element $K$.\n\n**4) Derivation of the Advection Matrix Entry $(A_{e})_{12}$**\n\nThe entry $(A_{e})_{12}$ of the local advection matrix is given by the integral:\n$$\n(A_{e})_{12} = \\int_{K} (\\boldsymbol{c}\\cdot \\nabla_{\\boldsymbol{x}} \\varphi_{2})\\,\\varphi_{1}\\, \\mathrm{d}\\boldsymbol{x}\n$$\nWe evaluate the terms in the integrand. First, we compute the physical gradient $\\nabla_{\\boldsymbol{x}}\\varphi_{2}$ using the transformation rule from part 3.\n$$\n\\nabla_{\\boldsymbol{x}}\\varphi_{2} = (J^{-1})^{T} \\nabla_{\\widehat{\\boldsymbol{x}}}\\widehat{\\varphi}_{2}\n$$\nWe need the inverse of the Jacobian $J$.\n$$\nJ^{-1} = \\frac{1}{\\det(J)} \\begin{pmatrix} y_3 - y_1 & -(x_3 - x_1) \\\\ -(y_2 - y_1) & x_2 - x_1 \\end{pmatrix}\n$$\nwhere $\\det(J) = (x_2 - x_1)(y_3 - y_1) - (x_3 - x_1)(y_2 - y_1)$.\nThe transpose of the inverse is:\n$$\n(J^{-1})^{T} = \\frac{1}{\\det(J)} \\begin{pmatrix} y_3 - y_1 & -(y_2 - y_1) \\\\ -(x_3 - x_1) & x_2 - x_1 \\end{pmatrix}\n$$\nSubstituting $\\nabla_{\\widehat{\\boldsymbol{x}}}\\widehat{\\varphi}_{2} = (1, 0)^{T}$:\n$$\n\\nabla_{\\boldsymbol{x}}\\varphi_{2} = \\frac{1}{\\det(J)} \\begin{pmatrix} y_3 - y_1 & -(y_2 - y_1) \\\\ -(x_3 - x_1) & x_2 - x_1 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} = \\frac{1}{\\det(J)} \\begin{pmatrix} y_3 - y_1 \\\\ -(x_3 - x_1) \\end{pmatrix}\n$$\nThis gradient is constant on $K$. Now we compute the dot product with $\\boldsymbol{c}=(a,b)$:\n$$\n\\boldsymbol{c} \\cdot \\nabla_{\\boldsymbol{x}}\\varphi_{2} = \\begin{pmatrix} a \\\\ b \\end{pmatrix} \\cdot \\frac{1}{\\det(J)} \\begin{pmatrix} y_3 - y_1 \\\\ -(x_3 - x_1) \\end{pmatrix} = \\frac{a(y_3 - y_1) - b(x_3 - x_1)}{\\det(J)}\n$$\nSince this entire term is a constant, it can be factored out of the integral:\n$$\n(A_{e})_{12} = \\left( \\frac{a(y_3 - y_1) - b(x_3 - x_1)}{\\det(J)} \\right) \\int_{K} \\varphi_{1}\\, \\mathrm{d}\\boldsymbol{x}\n$$\nTo evaluate the remaining integral, we change variables to the reference element, using $\\mathrm{d}\\boldsymbol{x} = \\det(J)\\mathrm{d}\\widehat{\\boldsymbol{x}}$:\n$$\n\\int_{K} \\varphi_{1}\\, \\mathrm{d}\\boldsymbol{x} = \\int_{\\widehat{K}} \\widehat{\\varphi}_{1}(\\widehat{\\boldsymbol{x}})\\, \\det(J) \\, \\mathrm{d}\\widehat{\\boldsymbol{x}} = \\det(J) \\int_{0}^{1}\\int_{0}^{1-\\xi} (1-\\xi-\\eta)\\,\\mathrm{d}\\eta\\,\\mathrm{d}\\xi\n$$\nWe evaluate the inner integral with respect to $\\eta$:\n$$\n\\int_{0}^{1-\\xi} (1-\\xi-\\eta)\\,\\mathrm{d}\\eta = \\left[(1-\\xi)\\eta - \\frac{\\eta^2}{2}\\right]_{0}^{1-\\xi} = (1-\\xi)^2 - \\frac{(1-\\xi)^2}{2} = \\frac{1}{2}(1-\\xi)^2\n$$\nNow we evaluate the outer integral with respect to $\\xi$:\n$$\n\\int_{0}^{1} \\frac{1}{2}(1-\\xi)^2\\,\\mathrm{d}\\xi = \\frac{1}{2} \\left[ -\\frac{(1-\\xi)^3}{3} \\right]_{0}^{1} = \\frac{1}{2}\\left(0 - \\left(-\\frac{1}{3}\\right)\\right) = \\frac{1}{6}\n$$\nTherefore, $\\int_{K} \\varphi_{1}\\, \\mathrm{d}\\boldsymbol{x} = \\frac{1}{6}\\det(J)$. This result corresponds to the general formula that the integral of a barycentric coordinate function over a triangle is one-third of the triangle's area, since $\\text{Area}(K) = \\frac{1}{2}\\det(J)$.\n\nSubstituting this result back into the expression for $(A_{e})_{12}$:\n$$\n(A_{e})_{12} = \\left( \\frac{a(y_3 - y_1) - b(x_3 - x_1)}{\\det(J)} \\right) \\left( \\frac{1}{6}\\det(J) \\right)\n$$\nThe $\\det(J)$ terms cancel, yielding the final closed-form expression:\n$$\n(A_{e})_{12} = \\frac{1}{6} \\left( a(y_3 - y_1) - b(x_3 - x_1) \\right)\n$$\nThis expression depends only on the advection coefficients and the coordinates of vertices $\\boldsymbol{x}_{1}$ and $\\boldsymbol{x}_{3}$, as required.", "answer": "$$\n\\boxed{\\frac{a(y_{3} - y_{1}) - b(x_{3} - x_{1})}{6}}\n$$", "id": "3441775"}, {"introduction": "The success of the Discontinuous Galerkin (DG) method for hyperbolic problems hinges on its inherent local conservation properties, a feature not present in standard Continuous Galerkin methods. This practice provides a sharp, conceptual check of this fundamental principle [@problem_id:3441789]. By applying the DG formulation to a constant test function, you will see how the complex integral equation elegantly simplifies to a statement that the rate of change within an element is perfectly balanced by the numerical fluxes at its boundaries.", "problem": "Consider the scalar linear advection equation in one spatial dimension,\n$$\n\\partial_t u(x,t) + a\\,\\partial_x u(x,t) = 0 \\quad \\text{for } x \\in [0,2h],\\ t>0,\n$$\nwith constant advection speed $a>0$ and prescribed inflow boundary data $u(0,t)=g(t)$. Partition the domain into the simple mesh with two elements $K_1=[0,h]$ and $K_2=[h,2h]$. Let $u_h(\\cdot,t)$ be the discontinuous Galerkin (DG) semi-discrete approximation in the space of polynomials of degree at most $1$ on each element.\n\nAdopt the standard upwind numerical flux for linear advection,\n$$\n\\widehat{f}(u^-,u^+) = a\\,u^{\\text{up}}=\n\\begin{cases}\na\\,u^- & \\text{if } a>0,\\\\\na\\,u^+ & \\text{if } a<0,\n\\end{cases}\n$$\nand use the outward unit normal $n_{K}(x)$ on $\\partial K$ so that, in $1$D, $n_{K_1}(0)=-1$ and $n_{K_1}(h)=+1$. The semi-discrete DG formulation on an element $K$ reads: find $u_h$ such that for all test functions $v_h$ in the local polynomial space,\n$$\n\\int_{K} \\partial_t u_h\\, v_h\\, dx \\;-\\; \\int_{K} a\\, u_h\\, \\partial_x v_h\\, dx \\;+\\; \\int_{\\partial K} \\widehat{f}\\big(u_h^-,u_h^+\\big)\\, v_h\\, n_{K}\\, ds \\;=\\; 0.\n$$\n\nFocus on the left element $K_1$ and the constant test function $v_h \\equiv 1$ on $K_1$. Define the elementwise residual\n$$\nR_{K_1}(t) := \\int_{K_1} \\partial_t u_h(x,t)\\, dx,\n$$\nand the net numerical flux across the boundary $\\partial K_1$,\n$$\nB_{K_1}(t) := \\int_{\\partial K_1} \\widehat{f}\\big(u_h^-(x,t),u_h^+(x,t)\\big)\\, n_{K_1}(x)\\, ds.\n$$\n\nStarting from the semi-discrete DG formulation above and the given numerical flux, evaluate the quantity\n$$\nD(t) := R_{K_1}(t) + B_{K_1}(t)\n$$\nin closed form, expressed purely in terms of $a$ and $g(t)$ if needed, and simplify it completely. Your final answer must be a single real number or a single closed-form analytic expression. No rounding is required, and no units are needed.", "solution": "The problem asks for the evaluation of the quantity $D(t) := R_{K_1}(t) + B_{K_1}(t)$. We begin by performing a validation of the problem statement.\n\n### Problem Validation\n**Step 1: Extract Givens**\n-   **Partial Differential Equation (PDE):** $\\partial_t u(x,t) + a\\,\\partial_x u(x,t) = 0$ for $x \\in [0,2h]$, $t>0$.\n-   **Advection Speed:** $a>0$.\n-   **Boundary Condition:** $u(0,t)=g(t)$.\n-   **Mesh:** Element $K_1=[0,h]$ and $K_2=[h,2h]$.\n-   **Approximation Space:** The space of polynomials of degree at most $1$ on each element.\n-   **Numerical Flux:** $\\widehat{f}(u^-,u^+) = a\\,u^{\\text{up}}$, which for $a>0$ is $\\widehat{f}(u^-,u^+) = a\\,u^-$.\n-   **Outward Normals for $K_1$:** $n_{K_1}(0)=-1$ and $n_{K_1}(h)=+1$.\n-   **Semi-discrete DG Formulation:** For an element $K$ and a test function $v_h$ from the local polynomial space, the formulation is:\n    $$\n    \\int_{K} \\partial_t u_h\\, v_h\\, dx \\;-\\; \\int_{K} a\\, u_h\\, \\partial_x v_h\\, dx \\;+\\; \\int_{\\partial K} \\widehat{f}\\big(u_h^-,u_h^+\\big)\\, v_h\\, n_{K}\\, ds \\;=\\; 0.\n    $$\n-   **Definitions:**\n    -   Elementwise residual: $R_{K_1}(t) := \\int_{K_1} \\partial_t u_h(x,t)\\, dx$.\n    -   Net numerical flux: $B_{K_1}(t) := \\int_{\\partial K_1} \\widehat{f}\\big(u_h^-(x,t),u_h^+(x,t)\\big)\\, n_{K_1}(x)\\, ds$.\n-   **Quantity to Evaluate:** $D(t) := R_{K_1}(t) + B_{K_1}(t)$.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is scientifically grounded, being a standard exercise in the numerical analysis of PDEs using the Discontinuous Galerkin method. It is well-posed, providing all necessary definitions and equations. The language is objective and formal. The setup is internally consistent and complete for the question being asked. The problem is not trivial, as it requires recognizing the relationship between the defined quantities and the governing discrete equation, testing a fundamental concept rather than rote calculation. Therefore, the problem is deemed valid.\n\n**Step 3: Verdict and Action**\nThe problem is valid. We proceed with the solution.\n\n### Solution\nThe foundation of the solution lies in the semi-discrete Discontinuous Galerkin (DG) formulation provided in the problem statement. This formulation must hold true for any choice of test function $v_h$ within the specified approximation space.\n\nThe problem specifies that the approximation space for $u_h$ consists of polynomials of degree at most $1$ on each element $K$. The space of test functions $v_h$ is the same. This space, denoted $\\mathcal{P}^1(K)$, includes all constant functions. The problem directs our focus to the specific constant test function $v_h(x) \\equiv 1$ for all $x \\in K_1$.\n\nThe semi-discrete DG formulation on the element $K_1=[0,h]$ is:\n$$\n\\int_{K_1} \\partial_t u_h\\, v_h\\, dx \\;-\\; \\int_{K_1} a\\, u_h\\, \\partial_x v_h\\, dx \\;+\\; \\int_{\\partial K_1} \\widehat{f}\\big(u_h^-,u_h^+\\big)\\, v_h\\, n_{K_1}\\, ds \\;=\\; 0.\n$$\nWe substitute the chosen test function $v_h \\equiv 1$ into this equation. Let's analyze each term separately.\n\n1.  **First Term:** The first integral becomes:\n    $$\n    \\int_{K_1} \\partial_t u_h(x,t) \\cdot 1 \\, dx.\n    $$\n    By the problem's definition, this is precisely the elementwise residual $R_{K_1}(t)$.\n\n2.  **Second Term:** The second integral involves the spatial derivative of the test function, $\\partial_x v_h$:\n    $$\n    -\\int_{K_1} a\\, u_h(x,t)\\, \\partial_x(1)\\, dx.\n    $$\n    Since $v_h(x) = 1$ is a constant function, its derivative is $\\partial_x v_h = 0$. Consequently, this entire term evaluates to zero:\n    $$\n    -\\int_{K_1} a\\, u_h(x,t) \\cdot 0 \\, dx = 0.\n    $$\n\n3.  **Third Term:** The third integral is the boundary term:\n    $$\n    \\int_{\\partial K_1} \\widehat{f}\\big(u_h^-(x,t),u_h^+(x,t)\\big) \\cdot 1 \\cdot n_{K_1}(x)\\, ds.\n    $$\n    By the problem's definition, this is precisely the net numerical flux $B_{K_1}(t)$.\n\nSubstituting these results back into the semi-discrete DG formulation, we obtain:\n$$\nR_{K_1}(t) - 0 + B_{K_1}(t) = 0,\n$$\nwhich simplifies to:\n$$\nR_{K_1}(t) + B_{K_1}(t) = 0.\n$$\nThe problem asks for the evaluation of the quantity $D(t)$, which is defined as:\n$$\nD(t) := R_{K_1}(t) + B_{K_1}(t).\n$$\nFrom our derivation, it is clear that this sum is equal to $0$.\n\nThis result is a direct consequence of the definition of the DG method. By choosing a constant test function, the formulation reduces to a statement about the rate of change of the cell average of $u_h$ being balanced by the numerical fluxes at the cell boundaries. The problem is constructed such that the quantity to be evaluated, $D(t)$, is exactly the left-hand side of this local conservation law, which must be zero by definition of the numerical scheme. The specific form of the numerical flux, the value of the advection speed $a$, and the boundary data $g(t)$ are not required to reach this conclusion.", "answer": "$$\n\\boxed{0}\n$$", "id": "3441789"}, {"introduction": "A crucial test for any numerical method is its ability to accurately capture physical wave phenomena. This exercise places the Continuous and Discontinuous Galerkin methods in a classic physics scenario: wave reflection and transmission at a material interface [@problem_id:3441760]. Your task is to show that the DG method, equipped with an upwind flux, can precisely reproduce the analytical Fresnel coefficients, a result that is remarkably independent of the discretization. This provides a powerful demonstration of DG's suitability for wave problems and highlights the challenges, like numerical dispersion, faced by standard CG methods.", "problem": "Consider one-dimensional linear acoustics in two homogeneous, lossless media occupying the half-lines $x<0$ and $x>0$, respectively. Let the left medium have density $\\rho_{1}$ and bulk modulus $\\kappa_{1}$, and the right medium have density $\\rho_{2}$ and bulk modulus $\\kappa_{2}$. The pressure $p(x,t)$ and particle velocity $u(x,t)$ satisfy the first-order hyperbolic system\n$$\np_{t} + \\kappa\\,u_{x} = 0,\\qquad u_{t} + \\frac{1}{\\rho}\\,p_{x} = 0,\n$$\nwith $(\\rho,\\kappa)=(\\rho_{1},\\kappa_{1})$ for $x<0$ and $(\\rho,\\kappa)=(\\rho_{2},\\kappa_{2})$ for $x>0$. Define the sound speed $c=\\sqrt{\\kappa/\\rho}$ and the characteristic (acoustic) impedance $Z=\\sqrt{\\kappa\\,\\rho}$ in each medium, yielding $c_{j}=\\sqrt{\\kappa_{j}/\\rho_{j}}$ and $Z_{j}=\\sqrt{\\kappa_{j}\\rho_{j}}$ for $j\\in\\{1,2\\}$. At the interface $x=0$, the physical transmission conditions are continuity of pressure and velocity.\n\nA time-harmonic plane wave of angular frequency $\\omega>0$ is incident from $x=-\\infty$ in the left medium. In the continuous problem, the incident, reflected, and transmitted waves are assumed to be of the form\n$$\np_{i}(x,t)=P_{i}\\exp\\!\\big(i(\\omega t-k_{1}x)\\big),\\quad p_{r}(x,t)=P_{r}\\exp\\!\\big(i(\\omega t+k_{1}x)\\big),\\quad p_{t}(x,t)=P_{t}\\exp\\!\\big(i(\\omega t-k_{2}x)\\big),\n$$\nwith $k_{j}=\\omega/c_{j}$ in medium $j$. The corresponding velocity amplitudes $U_{i}$, $U_{r}$, and $U_{t}$ satisfy the plane-wave relations derived from the field equations in each medium.\n\nNow semi-discretize in space using the Finite Element Method (FEM) while keeping time continuous (semi-discrete formulation). On each side of the interface, use a uniform mesh of size $h>0$ and a polynomial space of degree $p\\geq 0$: either a Continuous Galerkin (CG) space of globally continuous, piecewise polynomials of degree $p$, or a Discontinuous Galerkin (DG) space of broken piecewise polynomials of degree $p$. Impose the interface transmission conditions weakly. For the DG discretization, use an upwind numerical flux consistent with the exact characteristic decomposition of the hyperbolic system and the material impedances $Z_{1}$ and $Z_{2}$.\n\nDefine the complex reflection and transmission coefficients for pressure amplitudes by\n$$\nR=\\frac{P_{r}}{P_{i}},\\qquad T=\\frac{P_{t}}{P_{i}}.\n$$\nUsing only the governing equations, the physical interface conditions, and the semi-discrete formulation with the specified flux choice, derive the discrete interface relations for the DG semi-discretization that determine $R$ and $T$. Show that they coincide with the continuous plane-wave matching conditions and hence with the continuous Fresnel coefficients, and explain qualitatively how and why the dependence on the polynomial degree $p$ cancels out in the DG case. Contrast this with the CG semi-discretization and argue rigorously from first principles how the discrete dispersion relation in CG affects the local plane-wave impedance ratio, leading to an $h$- and $p$-dependent perturbation of the continuous Fresnel coefficients, with a leading-order error that vanishes as the mesh is refined with a rate that depends on $p$.\n\nYour final task is to provide a single closed-form analytic expression for the DG semi-discrete reflection and transmission coefficients $(R,T)$ in terms of the material impedances $Z_{1}$ and $Z_{2}$ only, written as a row vector. No numerical evaluation is required. Express the final answer without units.", "solution": "The problem is first validated against the established criteria.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n- **Governing Equations:** $p_{t} + \\kappa\\,u_{x} = 0$, $u_{t} + \\frac{1}{\\rho}\\,p_{x} = 0$.\n- **Media:** Medium $1$ for $x<0$ with $(\\rho_{1},\\kappa_{1})$; Medium $2$ for $x>0$ with $(\\rho_{2},\\kappa_{2})$.\n- **Definitions:** Sound speed $c_{j}=\\sqrt{\\kappa_{j}/\\rho_{j}}$, characteristic impedance $Z_{j}=\\sqrt{\\kappa_{j}\\rho_{j}}$ for $j\\in\\{1,2\\}$.\n- **Interface Conditions:** Continuity of pressure $p$ and velocity $u$ at $x=0$.\n- **Wave Forms:**\n  - Incident: $p_{i}(x,t)=P_{i}\\exp(i(\\omega t-k_{1}x))$.\n  - Reflected: $p_{r}(x,t)=P_{r}\\exp(i(\\omega t+k_{1}x))$.\n  - Transmitted: $p_{t}(x,t)=P_{t}\\exp(i(\\omega t-k_{2}x))$.\n  - Wavenumber: $k_{j}=\\omega/c_{j}$.\n- **Semi-Discretization:**\n  - Finite Element Method (FEM) in space, continuous in time.\n  - Uniform mesh size $h>0$.\n  - Continuous Galerkin (CG) of degree $p \\geq 0$ or Discontinuous Galerkin (DG) of degree $p \\geq 0$.\n  - DG uses an upwind numerical flux consistent with the exact characteristic decomposition.\n- **Quantities to Find:** Reflection coefficient $R=P_{r}/P_{i}$ and transmission coefficient $T=P_{t}/P_{i}$ for the DG semi-discretization.\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientifically Grounded:** The problem statement is based on the fundamental principles of linear acoustics and wave propagation in one dimension. The use of Finite Element Methods (CG and DG) and specific numerical fluxes (upwind/Riemann solver) are standard, well-established topics in the numerical analysis of partial differential equations. The setup is scientifically and mathematically sound.\n- **Well-Posed:** The problem is well-defined, providing all necessary physical and numerical parameters to perform the requested derivations and comparisons. It asks for a specific analytical result and a rigorous explanation, which are achievable within the given framework.\n- **Objective:** The language is formal, precise, and unambiguous, using standard terminology from physics and computational mathematics.\n\n**Step 3: Verdict and Action**\nThe problem is valid. A complete solution is warranted.\n\n### Solution Derivation\n\nThe analysis proceeds in three parts: first, the derivation of the continuous reflection and transmission coefficients as a baseline; second, the derivation for the Discontinuous Galerkin (DG) semi-discretization; and third, a contrasting analysis for the Continuous Galerkin (CG) method.\n\n**1. Continuous Case: Fresnel Coefficients**\nThe governing equations can be written in vector form $\\mathbf{q}_t + \\mathbf{A} \\mathbf{q}_x = \\mathbf{0}$, where $\\mathbf{q} = [p, u]^T$ and $\\mathbf{A} = \\begin{pmatrix} 0 & \\kappa \\\\ 1/\\rho & 0 \\end{pmatrix}$.\nFor a time-harmonic plane wave $\\mathbf{q}(x,t) = \\mathbf{Q} \\exp(i(\\omega t - kx))$, the equations become $i\\omega \\mathbf{Q} - ik \\mathbf{A} \\mathbf{Q} = \\mathbf{0}$, or $\\mathbf{A} \\mathbf{Q} = \\frac{\\omega}{k} \\mathbf{Q} = c \\mathbf{Q}$. This is an eigenvalue problem for $\\mathbf{A}$. The eigenvalues of $\\mathbf{A}$ are $\\pm\\sqrt{\\kappa/\\rho} = \\pm c$, corresponding to right- and left-propagating waves.\n\nFor a right-propagating wave ($p(x,t) = P \\exp(i(\\omega t - kx))$), the first governing equation $p_t + \\kappa u_x = 0$ yields $i\\omega P + \\kappa (-ik) U = 0$, so $P = (\\kappa k/\\omega) U = (\\kappa/c) U$. Since $Z=\\sqrt{\\kappa\\rho}$ and $c=\\sqrt{\\kappa/\\rho}$, we have $Z = \\kappa/c$. Thus, for a right-propagating wave, $P = ZU$.\nFor a left-propagating wave ($p(x,t) = P \\exp(i(\\omega t + kx))$), we get $i\\omega P + \\kappa (ik) U = 0$, which implies $P = -ZU$.\n\nAt the interface $x=0$, the total field in medium $1$ is the sum of the incident and reflected waves, while in medium $2$ it is just the transmitted wave.\n$p_1(0,t) = (P_i + P_r) \\exp(i\\omega t)$\n$u_1(0,t) = (U_i + U_r) \\exp(i\\omega t) = (P_i/Z_1 - P_r/Z_1) \\exp(i\\omega t)$\n$p_2(0,t) = P_t \\exp(i\\omega t)$\n$u_2(0,t) = U_t \\exp(i\\omega t) = (P_t/Z_2) \\exp(i\\omega t)$\n\nApplying the physical interface conditions:\nContinuity of pressure: $p_1(0,t) = p_2(0,t) \\implies P_i + P_r = P_t$.\nContinuity of velocity: $u_1(0,t) = u_2(0,t) \\implies \\frac{P_i-P_r}{Z_1} = \\frac{P_t}{Z_2}$.\n\nDividing by $P_i$ and using the definitions $R=P_r/P_i$ and $T=P_t/P_i$:\n$1 + R = T$\n$\\frac{1-R}{Z_1} = \\frac{T}{Z_2}$\n\nSubstituting the first equation into the second gives $\\frac{1-R}{Z_1} = \\frac{1+R}{Z_2}$, which yields $Z_2(1-R) = Z_1(1+R)$.\nRearranging for $R$: $Z_2 - Z_1 = (Z_1+Z_2)R \\implies R = \\frac{Z_2 - Z_1}{Z_1 + Z_2}$.\nSubstituting $R$ back into the first equation: $T = 1+R = 1 + \\frac{Z_2 - Z_1}{Z_1 + Z_2} = \\frac{Z_1+Z_2+Z_2-Z_1}{Z_1+Z_2} = \\frac{2Z_2}{Z_1+Z_2}$.\nThese are the continuous Fresnel coefficients.\n\n**2. Discontinuous Galerkin (DG) Semi-Discretization**\nThe DG method couples adjacent elements through a numerical flux at the interface. The problem specifies an upwind flux consistent with the exact characteristic decomposition. For a hyperbolic system, this is equivalent to using an exact Riemann solver for the flux.\nLet $\\mathbf{q}_L$ and $\\mathbf{q}_R$ be the states at the interface approached from the left ($x=0^-$) and right ($x=0^+$), respectively. The state $\\mathbf{q}^* = [p^*, u^*]^T$ on the interface, as determined by the solution of the Riemann problem, must satisfy the characteristic relations connecting it to the left and right states.\nThe characteristic variables, $w_{\\pm} = p \\pm Zu$, propagate along characteristics $dx/dt = \\mp c$.\nThe right-propagating information from the left state $\\mathbf{q}_L$ determines the right-propagating part of the interface state $\\mathbf{q}^*$.\nThe left-propagating information from the right state $\\mathbf{q}_R$ determines the left-propagating part of the interface state $\\mathbf{q}^*$.\nThis yields the interface conditions:\n$p^* + Z_1 u^* = p_L + Z_1 u_L$\n$p^* - Z_2 u^* = p_R - Z_2 u_R$\n\nThe plane wave forms are used for the states $\\mathbf{q}_L$ and $\\mathbf{q}_R$:\nAt $x=0^-$, $p_L = P_i+P_r$ and $u_L = U_i+U_r = (P_i-P_r)/Z_1$.\nAt $x=0^+$, $p_R = P_t$ and $u_R = U_t = P_t/Z_2$. There is no incident wave from the right.\n\nSubstituting these into the characteristic relations:\n$p_L + Z_1 u_L = (P_i+P_r) + Z_1 \\frac{P_i-P_r}{Z_1} = 2P_i$.\n$p_R - Z_2 u_R = P_t - Z_2 \\frac{P_t}{Z_2} = 0$.\n\nThe Riemann solver provides an interface state $(p^*, u^*)$ that satisfies:\n$p^* + Z_1 u^* = 2P_i$\n$p^* - Z_2 u^* = 0$\n\nSolving this system for $(p^*, u^*)$: from the second equation, $p^* = Z_2 u^*$. Substituting into the first gives $Z_2 u^* + Z_1 u^* = 2P_i$, so $u^* = \\frac{2P_i}{Z_1+Z_2}$. Then, $p^* = \\frac{2Z_2 P_i}{Z_1+Z_2}$.\nThe DG method enforces that the solution on each side matches this interface state. The transmitted wave is determined by the state propagated into medium $2$, so we must have $P_t = p^*$ and $U_t=u^*$.\nThis directly gives the transmission coefficient:\n$T = \\frac{P_t}{P_i} = \\frac{p^*}{P_i} = \\frac{2Z_2}{Z_1+Z_2}$.\n\nThe total field on the left must also be consistent with the interface state, meaning $p_L = p^*$ and $u_L=u^*$. Thus, $P_i + P_r = p^*$.\n$P_i + P_r = \\frac{2Z_2 P_i}{Z_1+Z_2}$.\nDividing by $P_i$: $1+R = \\frac{2Z_2}{Z_1+Z_2}$.\nThis gives the reflection coefficient:\n$R = \\frac{2Z_2}{Z_1+Z_2} - 1 = \\frac{2Z_2 - (Z_1+Z_2)}{Z_1+Z_2} = \\frac{Z_2 - Z_1}{Z_1+Z_2}$.\n\nThe derived discrete coefficients $(R,T)$ for the DG method are identical to the continuous Fresnel coefficients. This result is independent of the mesh size $h$ and the polynomial degree $p$. This occurs because:\n(1) For the linear advection equation, the DG semi-discretization with an upwind flux on a uniform mesh is superconvergent in its dispersion relation: the numerical wavenumber $k_h$ is exactly the continuous wavenumber $k = \\omega/c$. Consequently, the plane wave forms are exact solutions to the semi-discrete equations within each homogeneous medium.\n(2) The DG interface coupling is handled by the numerical flux, which is a local calculation depending only on the states immediately adjacent to the interface ($\\mathbf{q}_L$, $\\mathbf{q}_R$) and the local material properties ($Z_1$, $Z_2$). It does not involve the interior structure of the elements, and hence is independent of $h$ and $p$.\nBecause the wave representation within elements is exact and the coupling machinery is local and independent of the basis, the resulting relations for the wave amplitudes are exact.\n\n**3. Contrast with Continuous Galerkin (CG) Semi-Discretization**\nIn a CG method, continuity is enforced strongly by the choice of a globally $C^0$ basis. However, the variational formulation couples all degrees of freedom, leading to a discrete dispersion relation where the numerical wavenumber $k_{h,j}$ in medium $j$ is not equal to the continuous one $k_j$. The error $k_{h,j} - k_j$ is a function of $h$, $p$, and $\\omega$.\nThis numerical dispersion means that a plane wave in the discrete system propagates at a phase a velocity $c_h = \\omega/k_h \\neq c$. This effectively modifies the impedance of the medium. The numerical impedance becomes $Z_{h,j} = \\kappa_j \\frac{k_{h,j}}{\\omega} = Z_j \\frac{c_j k_{h,j}}{\\omega} = Z_j \\frac{k_{h,j}}{k_j}$.\nFor a CG($p$) method, the dispersion error is known to be of the form $\\frac{k_{h,j}}{k_j} = 1 + C_p(k_j h)^{2p+2} + O((k_j h)^{2p+4})$.\nThe discrete reflection and transmission coefficients are then given by the continuous formulas, but with the numerical impedances $Z_{h,j}$:\n$R_h = \\frac{Z_{h,2} - Z_{h,1}}{Z_{h,1} + Z_{h,2}}$.\nSubstituting the expansion for $Z_{h,j}$ shows that $R_h$ will differ from the continuous $R$.\n$R_h - R = \\frac{Z_{h,2} - Z_{h,1}}{Z_{h,1} + Z_{h,2}} - \\frac{Z_2 - Z_1}{Z_1 + Z_2} \\approx \\frac{2Z_1 Z_2}{(Z_1+Z_2)^2} \\left(\\frac{k_{h,2}}{k_2} - \\frac{k_{h,1}}{k_1}\\right)$.\nSince the error term $\\frac{k_{h,j}}{k_j}-1$ is proportional to $(k_j h)^{2p+2}$, the leading-order error in the reflection coefficient for CG is $R_h - R = \\mathcal{O}(h^{2p+2})$. This demonstrates a clear dependence of the discrete coefficients on both mesh size $h$ and polynomial degree $p$, in stark contrast to the exact result obtained with DG.\n\nThe final answer requested is the row vector of the DG coefficients $(R, T)$.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{Z_{2} - Z_{1}}{Z_{1} + Z_{2}} & \\frac{2Z_{2}}{Z_{1} + Z_{2}}\n\\end{pmatrix}\n}\n$$", "id": "3441760"}]}