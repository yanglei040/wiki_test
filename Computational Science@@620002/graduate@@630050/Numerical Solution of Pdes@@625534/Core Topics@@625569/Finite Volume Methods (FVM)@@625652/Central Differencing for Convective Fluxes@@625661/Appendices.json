{"hands_on_practices": [{"introduction": "To understand how a numerical scheme performs, it's essential to analyze its effect on basic building blocks, like a simple wave. This first exercise uses Fourier analysis to examine how the central differencing scheme approximates the convective derivative of a sine wave [@problem_id:3369209]. By deriving an analytical expression for the discretized term, you will gain direct insight into the scheme's dispersive properties and how numerical error depends on the wave's length relative to the grid size.", "problem": "Consider the one-dimensional linear advection partial differential equation (PDE) $\\frac{\\partial \\phi}{\\partial t} + \\frac{\\partial (a \\phi)}{\\partial x} = 0$ with constant velocity $a>0$ on a periodic domain. Using the Finite Volume Method (FVM) on a uniform grid with cell centers at $x_i$ and spacing $\\Delta x>0$, define the convective face flux at face $i+\\tfrac{1}{2}$ as $F_{i+\\tfrac{1}{2}} = a\\,\\phi_{i+\\tfrac{1}{2}}$, where the face value $\\phi_{i+\\tfrac{1}{2}}$ is given by the central interpolation $\\phi_{i+\\tfrac{1}{2}} = \\tfrac{1}{2}(\\phi_i + \\phi_{i+1})$; analogously for $i-\\tfrac{1}{2}$. The semidiscrete convective term in the cell balance is $\\left(F_{i+\\tfrac{1}{2}} - F_{i-\\tfrac{1}{2}}\\right)/\\Delta x$.\n\nSuppose that the cell-centered solution is a single Fourier mode $\\phi_i = \\sin(k x_i)$, where $k$ is a real wavenumber. Starting from the conservation-law cell balance and the central interpolation defined above, derive closed-form expressions for:\n- the central face fluxes $F_{i-\\tfrac{1}{2}}$ and $F_{i+\\tfrac{1}{2}}$, and\n- the resulting discrete convective term at cell $i$, $C_i = \\left(F_{i+\\tfrac{1}{2}} - F_{i-\\tfrac{1}{2}}\\right)/\\Delta x$,\n\nall expressed in terms of $a$, $k$, $x_i$, and $\\Delta x$ only.\n\nExpress your final answer as a single row matrix in the order $\\big[F_{i-\\tfrac{1}{2}},\\,F_{i+\\tfrac{1}{2}},\\,C_i\\big]$. No units are required. No numerical rounding is required; provide exact closed-form expressions.", "solution": "The problem is validated as scientifically grounded, well-posed, objective, and complete. All necessary definitions for the Finite Volume Method discretization of the linear advection equation are provided. The task is a standard exercise in numerical analysis, specifically the Fourier analysis of a numerical scheme.\n\nThe problem asks for the derivation of the face fluxes $F_{i-\\tfrac{1}{2}}$ and $F_{i+\\tfrac{1}{2}}$, and the resulting discrete convective term $C_i$, for a one-dimensional linear advection equation. The derivation proceeds from the given definitions.\n\nThe governing partial differential equation is:\n$$ \\frac{\\partial \\phi}{\\partial t} + \\frac{\\partial (a \\phi)}{\\partial x} = 0 $$\nwhere $a > 0$ is a constant velocity.\n\nThe cell-centered solution at grid point $i$ is given as a single Fourier mode:\n$$ \\phi_i = \\sin(k x_i) $$\nwhere $k$ is the wavenumber and $x_i$ is the coordinate of the cell center $i$. The grid is uniform with spacing $\\Delta x > 0$, so the coordinates of the adjacent cell centers are $x_{i+1} = x_i + \\Delta x$ and $x_{i-1} = x_i - \\Delta x$.\n\nThe values of the solution at the neighboring cell centers are therefore:\n$$ \\phi_{i+1} = \\sin(k x_{i+1}) = \\sin(k(x_i + \\Delta x)) $$\n$$ \\phi_{i-1} = \\sin(k x_{i-1}) = \\sin(k(x_i - \\Delta x)) $$\n\nFirst, we derive the expression for the face flux $F_{i+\\tfrac{1}{2}}$.\nThe convective flux at face $i+\\tfrac{1}{2}$ is defined as $F_{i+\\tfrac{1}{2}} = a\\,\\phi_{i+\\tfrac{1}{2}}$. The face value $\\phi_{i+\\tfrac{1}{2}}$ is obtained by central interpolation:\n$$ \\phi_{i+\\tfrac{1}{2}} = \\frac{1}{2}(\\phi_i + \\phi_{i+1}) $$\nSubstituting the expressions for $\\phi_i$ and $\\phi_{i+1}$:\n$$ \\phi_{i+\\tfrac{1}{2}} = \\frac{1}{2} \\left[ \\sin(k x_i) + \\sin(k(x_i + \\Delta x)) \\right] $$\nWe use the sum-to-product trigonometric identity $\\sin(A) + \\sin(B) = 2 \\sin\\left(\\frac{A+B}{2}\\right) \\cos\\left(\\frac{A-B}{2}\\right)$. Let $A = k(x_i + \\Delta x)$ and $B = k x_i$.\n$$ \\frac{A+B}{2} = \\frac{k x_i + k \\Delta x + k x_i}{2} = k x_i + \\frac{k \\Delta x}{2} $$\n$$ \\frac{A-B}{2} = \\frac{k x_i + k \\Delta x - k x_i}{2} = \\frac{k \\Delta x}{2} $$\nApplying the identity, we get:\n$$ \\sin(k x_i) + \\sin(k(x_i + \\Delta x)) = 2 \\sin\\left(k x_i + \\frac{k \\Delta x}{2}\\right) \\cos\\left(\\frac{k \\Delta x}{2}\\right) $$\nSubstituting this back into the expression for $\\phi_{i+\\tfrac{1}{2}}$:\n$$ \\phi_{i+\\tfrac{1}{2}} = \\frac{1}{2} \\left[ 2 \\sin\\left(k x_i + \\frac{k \\Delta x}{2}\\right) \\cos\\left(\\frac{k \\Delta x}{2}\\right) \\right] = \\cos\\left(\\frac{k \\Delta x}{2}\\right) \\sin\\left(k x_i + \\frac{k \\Delta x}{2}\\right) $$\nThe flux is then:\n$$ F_{i+\\tfrac{1}{2}} = a\\,\\phi_{i+\\tfrac{1}{2}} = a \\cos\\left(\\frac{k \\Delta x}{2}\\right) \\sin\\left(k x_i + \\frac{k \\Delta x}{2}\\right) $$\n\nNext, we derive the expression for the face flux $F_{i-\\tfrac{1}{2}}$.\nThe process is analogous. The flux is $F_{i-\\tfrac{1}{2}} = a\\,\\phi_{i-\\tfrac{1}{2}}$, with the face value given by:\n$$ \\phi_{i-\\tfrac{1}{2}} = \\frac{1}{2}(\\phi_{i-1} + \\phi_i) $$\nSubstituting the expressions for $\\phi_{i-1}$ and $\\phi_i$:\n$$ \\phi_{i-\\tfrac{1}{2}} = \\frac{1}{2} \\left[ \\sin(k(x_i - \\Delta x)) + \\sin(k x_i) \\right] $$\nUsing the same sum-to-product identity with $A = k x_i$ and $B = k(x_i - \\Delta x)$:\n$$ \\frac{A+B}{2} = \\frac{k x_i + k x_i - k \\Delta x}{2} = k x_i - \\frac{k \\Delta x}{2} $$\n$$ \\frac{A-B}{2} = \\frac{k x_i - (k x_i - k \\Delta x)}{2} = \\frac{k \\Delta x}{2} $$\nApplying the identity:\n$$ \\sin(k(x_i - \\Delta x)) + \\sin(k x_i) = 2 \\sin\\left(k x_i - \\frac{k \\Delta x}{2}\\right) \\cos\\left(\\frac{k \\Delta x}{2}\\right) $$\nSubstituting this back:\n$$ \\phi_{i-\\tfrac{1}{2}} = \\frac{1}{2} \\left[ 2 \\sin\\left(k x_i - \\frac{k \\Delta x}{2}\\right) \\cos\\left(\\frac{k \\Delta x}{2}\\right) \\right] = \\cos\\left(\\frac{k \\Delta x}{2}\\right) \\sin\\left(k x_i - \\frac{k \\Delta x}{2}\\right) $$\nThe flux is then:\n$$ F_{i-\\tfrac{1}{2}} = a\\,\\phi_{i-\\tfrac{1}{2}} = a \\cos\\left(\\frac{k \\Delta x}{2}\\right) \\sin\\left(k x_i - \\frac{k \\Delta x}{2}\\right) $$\n\nFinally, we derive the discrete convective term $C_i$.\nThis term is defined as the divergence of the flux over the cell volume:\n$$ C_i = \\frac{F_{i+\\tfrac{1}{2}} - F_{i-\\tfrac{1}{2}}}{\\Delta x} $$\nSubstituting the derived expressions for the fluxes:\n$$ C_i = \\frac{a}{\\Delta x} \\left[ \\cos\\left(\\frac{k \\Delta x}{2}\\right) \\sin\\left(k x_i + \\frac{k \\Delta x}{2}\\right) - \\cos\\left(\\frac{k \\Delta x}{2}\\right) \\sin\\left(k x_i - \\frac{k \\Delta x}{2}\\right) \\right] $$\nFactoring out the common term $a \\cos\\left(\\frac{k \\Delta x}{2}\\right)$:\n$$ C_i = \\frac{a \\cos\\left(\\frac{k \\Delta x}{2}\\right)}{\\Delta x} \\left[ \\sin\\left(k x_i + \\frac{k \\Delta x}{2}\\right) - \\sin\\left(k x_i - \\frac{k \\Delta x}{2}\\right) \\right] $$\nWe now use the difference-to-product trigonometric identity $\\sin(A) - \\sin(B) = 2 \\cos\\left(\\frac{A+B}{2}\\right) \\sin\\left(\\frac{A-B}{2}\\right)$. Let $A = k x_i + \\frac{k \\Delta x}{2}$ and $B = k x_i - \\frac{k \\Delta x}{2}$.\n$$ \\frac{A+B}{2} = \\frac{k x_i + \\frac{k \\Delta x}{2} + k x_i - \\frac{k \\Delta x}{2}}{2} = k x_i $$\n$$ \\frac{A-B}{2} = \\frac{k x_i + \\frac{k \\Delta x}{2} - (k x_i - \\frac{k \\Delta x}{2})}{2} = \\frac{k \\Delta x}{2} $$\nApplying the identity, the term in the brackets becomes:\n$$ \\sin\\left(k x_i + \\frac{k \\Delta x}{2}\\right) - \\sin\\left(k x_i - \\frac{k \\Delta x}{2}\\right) = 2 \\cos(k x_i) \\sin\\left(\\frac{k \\Delta x}{2}\\right) $$\nSubstituting this into the expression for $C_i$:\n$$ C_i = \\frac{a \\cos\\left(\\frac{k \\Delta x}{2}\\right)}{\\Delta x} \\left[ 2 \\cos(k x_i) \\sin\\left(\\frac{k \\Delta x}{2}\\right) \\right] $$\nRearranging the terms:\n$$ C_i = \\frac{a}{\\Delta x} \\left[ 2 \\sin\\left(\\frac{k \\Delta x}{2}\\right) \\cos\\left(\\frac{k \\Delta x}{2}\\right) \\right] \\cos(k x_i) $$\nUsing the double-angle identity for sine, $\\sin(2\\theta) = 2 \\sin(\\theta) \\cos(\\theta)$, where $\\theta = \\frac{k \\Delta x}{2}$:\n$$ 2 \\sin\\left(\\frac{k \\Delta x}{2}\\right) \\cos\\left(\\frac{k \\Delta x}{2}\\right) = \\sin\\left(2 \\cdot \\frac{k \\Delta x}{2}\\right) = \\sin(k \\Delta x) $$\nThe final expression for $C_i$ is:\n$$ C_i = \\frac{a \\sin(k \\Delta x)}{\\Delta x} \\cos(k x_i) $$\n\nThe three required expressions are:\n1.  $F_{i-\\tfrac{1}{2}} = a \\cos\\left(\\frac{k \\Delta x}{2}\\right) \\sin\\left(k x_i - \\frac{k \\Delta x}{2}\\right)$\n2.  $F_{i+\\tfrac{1}{2}} = a \\cos\\left(\\frac{k \\Delta x}{2}\\right) \\sin\\left(k x_i + \\frac{k \\Delta x}{2}\\right)$\n3.  $C_i = \\frac{a \\sin(k \\Delta x)}{\\Delta x} \\cos(k x_i)$", "answer": "$$\n\\boxed{\\begin{pmatrix} a \\cos\\left(\\frac{k \\Delta x}{2}\\right) \\sin\\left(k x_i - \\frac{k \\Delta x}{2}\\right) & a \\cos\\left(\\frac{k \\Delta x}{2}\\right) \\sin\\left(k x_i + \\frac{k \\Delta x}{2}\\right) & \\frac{a \\sin(k \\Delta x)}{\\Delta x} \\cos(k x_i) \\end{pmatrix}}\n$$", "id": "3369209"}, {"introduction": "While central differencing is accurate for smooth functions, its behavior changes dramatically in the presence of sharp gradients or discontinuities. This practice demonstrates a critical failure mode of the scheme by applying it to a step function, a common feature in advection problems [@problem_id:3369239]. You will calculate, by hand, the emergence of non-physical oscillations after just one time step, providing a clear and memorable illustration of why pure central differencing is often unsuitable for convection-dominated flows.", "problem": "Consider the linear advection (convection) equation for a passive scalar,\n$$\n\\frac{\\partial \\phi}{\\partial t} + a \\frac{\\partial \\phi}{\\partial x} = 0,\n$$\nwith constant advection speed $a>0$ on a uniform grid with cell centers $x_i = i\\,\\Delta x$, $i \\in \\mathbb{Z}$. Adopt a conservative finite volume discretization with central interpolation for the convective fluxes at faces and forward Euler time integration. That is, approximate the face value by the arithmetic average of adjacent cell-centered values and advance one explicit time step of size $\\Delta t$.\n\nThe initial condition is a single discontinuous step located at the face $x_{1/2} = \\Delta x/2$ between cells $i=0$ and $i=1$:\n$$\n\\phi(x,0) = \\begin{cases}\n\\phi_L, & x < \\Delta x/2,\\\\\n\\phi_R, & x > \\Delta x/2,\n\\end{cases}\n$$\nwith $\\phi_L = 1$ and $\\phi_R = 0$.\n\nLet the Courant number (also known as the Courant–Friedrichs–Lewy (CFL) number) be\n$$\nC \\equiv \\frac{a\\,\\Delta t}{\\Delta x} = \\frac{7}{10}.\n$$\n\nUsing only the governing conservation law, the stated discretization choices, and the given initial data, determine after one time step the magnitude and the location of the first spurious overshoot above the initial maximum introduced by the central discretization. Define “magnitude” as the amount by which the updated value exceeds $\\max(\\phi_L,\\phi_R)$, and define the “location” as the cell index $i$ at which this first overshoot occurs. Report your final answer as a row vector $\\big(i,\\ \\text{magnitude}\\big)$ with exact values and do not round. No physical units are required.", "solution": "The problem is valid as it is scientifically grounded in the numerical analysis of partial differential equations, is well-posed for a single time step, and all terms and conditions are specified without ambiguity or contradiction.\n\nThe governing equation is the linear advection equation in one spatial dimension,\n$$\n\\frac{\\partial \\phi}{\\partial t} + a \\frac{\\partial \\phi}{\\partial x} = 0,\n$$\nwhere $\\phi = \\phi(x,t)$ is a scalar quantity and $a > 0$ is a constant advection speed.\n\nWe use a conservative finite volume method on a uniform grid with cell width $\\Delta x$. The cells are centered at $x_i = i\\,\\Delta x$. The cell $i$ spans the interval $[x_{i-1/2}, x_{i+1/2}]$, where $x_{i+1/2} = (i+1/2)\\,\\Delta x$. The cell-averaged value of $\\phi$ in cell $i$ at time $t$ is denoted by $\\phi_i(t)$. Integrating the governing equation over cell $i$ gives the exact conservation law for the cell average:\n$$\n\\frac{d}{dt} \\int_{x_{i-1/2}}^{x_{i+1/2}} \\phi(x,t) dx + [a\\phi(x,t)]_{x_{i-1/2}}^{x_{i+1/2}} = 0.\n$$\nIn terms of cell averages $\\phi_i = \\frac{1}{\\Delta x} \\int_{x_{i-1/2}}^{x_{i+1/2}} \\phi(x,t) dx$, this becomes:\n$$\n\\frac{d\\phi_i}{dt} + \\frac{a}{\\Delta x} (\\phi_{i+1/2} - \\phi_{i-1/2}) = 0,\n$$\nwhere $\\phi_{i \\pm 1/2}$ represents the value of $\\phi$ at the cell faces.\n\nThe problem specifies central interpolation for the convective fluxes. This means the value at a cell face is approximated by the arithmetic mean of the values in the two adjacent cells:\n$$\n\\phi_{i+1/2} \\approx \\frac{\\phi_i + \\phi_{i+1}}{2}.\n$$\nSubstituting this approximation into the semi-discrete equation yields:\n$$\n\\frac{d\\phi_i}{dt} + \\frac{a}{\\Delta x} \\left( \\frac{\\phi_i + \\phi_{i+1}}{2} - \\frac{\\phi_{i-1} + \\phi_i}{2} \\right) = 0,\n$$\nwhich simplifies to the standard central difference approximation for the spatial derivative:\n$$\n\\frac{d\\phi_i}{dt} + \\frac{a}{2\\Delta x} (\\phi_{i+1} - \\phi_{i-1}) = 0.\n$$\nNext, we apply the forward Euler method for time integration. Let $\\phi_i^n$ be the approximation of $\\phi_i$ at time $t_n = n\\,\\Delta t$. The time derivative is approximated as:\n$$\n\\frac{\\phi_i^{n+1} - \\phi_i^n}{\\Delta t} = - \\frac{a}{2\\Delta x} (\\phi_{i+1}^n - \\phi_{i-1}^n).\n$$\nRearranging for $\\phi_i^{n+1}$, we obtain the fully discrete update scheme:\n$$\n\\phi_i^{n+1} = \\phi_i^n - \\frac{a\\Delta t}{2\\Delta x} (\\phi_{i+1}^n - \\phi_{i-1}^n).\n$$\nUsing the definition of the Courant number, $C \\equiv \\frac{a\\Delta t}{\\Delta x}$, the update scheme is:\n$$\n\\phi_i^{n+1} = \\phi_i^n - \\frac{C}{2} (\\phi_{i+1}^n - \\phi_{i-1}^n).\n$$\nThe problem provides the initial condition as a step function:\n$$\n\\phi(x,0) = \\begin{cases}\n1, & x < \\frac{\\Delta x}{2},\\\\\n0, & x > \\frac{\\Delta x}{2}.\n\\end{cases}\n$$\nThe discontinuity is located at the face $x_{1/2} = \\frac{\\Delta x}{2}$ between cell $i=0$ and cell $i=1$. We determine the initial cell-averaged values $\\phi_i^0$ by integrating $\\phi(x,0)$ over each cell:\nFor any cell with index $i \\le 0$, its domain $[(i-\\frac{1}{2})\\Delta x, (i+\\frac{1}{2})\\Delta x]$ lies entirely in the region $x < \\frac{\\Delta x}{2}$. Thus, for $i \\le 0$:\n$$\n\\phi_i^0 = \\frac{1}{\\Delta x} \\int_{(i-1/2)\\Delta x}^{(i+1/2)\\Delta x} 1 \\, dx = 1.\n$$\nFor any cell with index $i \\ge 1$, its domain $[(i-\\frac{1}{2})\\Delta x, (i+\\frac{1}{2})\\Delta x]$ lies entirely in the region $x > \\frac{\\Delta x}{2}$. Thus, for $i \\ge 1$:\n$$\n\\phi_i^0 = \\frac{1}{\\Delta x} \\int_{(i-1/2)\\Delta x}^{(i+1/2)\\Delta x} 0 \\, dx = 0.\n$$\nSo, the discrete initial state at $n=0$ is:\n$$\n\\phi_i^0 = \\begin{cases}\n1, & i \\le 0, \\\\\n0, & i \\ge 1.\n\\end{cases}\n$$\nWe now compute the solution at the next time step, $n=1$, using $C=\\frac{7}{10}$.\n$$\n\\phi_i^1 = \\phi_i^0 - \\frac{1}{2} \\left(\\frac{7}{10}\\right) (\\phi_{i+1}^0 - \\phi_{i-1}^0) = \\phi_i^0 - \\frac{7}{20} (\\phi_{i+1}^0 - \\phi_{i-1}^0).\n$$\nWe evaluate $\\phi_i^1$ for each cell index $i$:\n- For $i \\le -1$: $\\phi_{i-1}^0 = 1$, $\\phi_i^0 = 1$, $\\phi_{i+1}^0 = 1$.\n  $$\n  \\phi_i^1 = 1 - \\frac{7}{20}(1 - 1) = 1.\n  $$\n- For $i=0$: $\\phi_{-1}^0=1$, $\\phi_0^0=1$, $\\phi_1^0=0$.\n  $$\n  \\phi_0^1 = 1 - \\frac{7}{20}(0 - 1) = 1 + \\frac{7}{20} = \\frac{27}{20}.\n  $$\n- For $i=1$: $\\phi_0^0=1$, $\\phi_1^0=0$, $\\phi_2^0=0$.\n  $$\n  \\phi_1^1 = 0 - \\frac{7}{20}(0 - 1) = \\frac{7}{20}.\n  $$\n- For $i \\ge 2$: $\\phi_{i-1}^0 = 0$, $\\phi_i^0 = 0$, $\\phi_{i+1}^0 = 0$.\n  $$\n  \\phi_i^1 = 0 - \\frac{7}{20}(0 - 0) = 0.\n  $$\nThe initial maximum value is $\\max(\\phi_L, \\phi_R) = \\max(1, 0) = 1$. The problem defines an overshoot as a value exceeding this maximum.\nThe updated values are:\n$$\n\\phi_i^1 = \\begin{cases}\n1, & i \\le -1, \\\\\n\\frac{27}{20}, & i = 0, \\\\\n\\frac{7}{20}, & i = 1, \\\\\n0, & i \\ge 2.\n\\end{cases}\n$$\nThe value $\\phi_0^1 = \\frac{27}{20} = 1.35$, which is greater than $1$. This is an overshoot.\nThe value $\\phi_1^1 = \\frac{7}{20} = 0.35$, which is within the initial range $[0, 1]$. All other values are either $0$ or $1$.\nThus, the only overshoot occurs in cell $i=0$. This is, by definition, the first spurious overshoot.\n\nThe location of this overshoot is the cell index $i=0$.\nThe magnitude of the overshoot is defined as the amount by which the updated value exceeds the initial maximum:\n$$\n\\text{Magnitude} = \\phi_0^1 - \\max(\\phi_L, \\phi_R) = \\frac{27}{20} - 1 = \\frac{7}{20}.\n$$\nThe requested answer is the row vector $(i, \\text{magnitude})$.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0 & \\frac{7}{20}\n\\end{pmatrix}\n}\n$$", "id": "3369239"}, {"introduction": "Our final practice synthesizes these concepts in the context of the steady convection-diffusion equation, a foundational model in transport phenomena. By writing a short program, you will explore the stability of the central differencing scheme and its relationship to the grid Peclet number, $Pe$, which measures the relative strength of convection to diffusion [@problem_id:3365178]. This hands-on coding exercise will solidify your understanding of when and why central differencing can produce unphysical, oscillatory solutions and connects the theoretical stability condition $|Pe| \\le 2$ to tangible numerical results.", "problem": "Consider the one-dimensional, steady, linear convection–diffusion boundary value problem for a passive scalar field $\\phi(x)$ on the domain $[0,1]$ with constant material properties and constant velocity. The continuous governing equation is the balance of diffusive and convective fluxes written in conservative form,\n$$\n-\\frac{\\mathrm{d}}{\\mathrm{d}x}\\left(\\Gamma \\frac{\\mathrm{d}\\phi}{\\mathrm{d}x}\\right) + \\frac{\\mathrm{d}}{\\mathrm{d}x}\\left(\\rho u \\, \\phi\\right) = 0,\n$$\nwhere $\\Gamma>0$ is the diffusion coefficient, $\\rho>0$ is the density, and $u$ is a constant velocity that may be positive or negative. Dirichlet boundary conditions $\\phi(0)=\\phi_L$ and $\\phi(1)=\\phi_R$ are imposed. All quantities are to be treated as dimensionless. You must work entirely in dimensionless units.\n\nYour task is to construct a numerical example using the cell-centered finite volume method on a uniform grid of $N$ equal control volumes (with cell faces at $x_i = i \\Delta x$, where $\\Delta x = 1/N$ and $i=0,1,\\ldots,N$) and central differencing for the convective flux that illustrates the well-known stability issue: for grid Peclet number with magnitude greater than $2$, i.e., $|Pe| > 2$, the central differencing scheme produces non-monotone interior oscillations even though the resulting linear system remains solvable.\n\nStarting from conservation over each control volume, discretize the equation using:\n- A second-order central difference for the diffusive fluxes at faces.\n- A second-order central difference for the convective mass fluxes at faces.\n\nDerive the resulting tri-diagonal linear system for interior cell-center values $\\phi_1,\\ldots,\\phi_{N-1}$ in terms of the diffusion conductance $D=\\Gamma/\\Delta x$, the mass flux $F=\\rho u$, and the grid Peclet number $Pe = F \\Delta x/\\Gamma$. Do not introduce any artificial dissipation or upwinding; use pure central differencing for both fluxes. Assemble the linear system with the Dirichlet boundary conditions incorporated into the right-hand side.\n\nDefine a quantitative detector of non-monotone interior oscillations as follows. Given the computed discrete solution $\\{\\phi_i\\}_{i=0}^N$ including boundaries, declare that an interior oscillation is present if at least one of the following conditions holds:\n- There exists an index $j \\in \\{1,\\ldots,N-1\\}$ such that $\\phi_j$ lies strictly outside the closed interval with endpoints $\\phi_L$ and $\\phi_R$.\n- There exists an index $j \\in \\{1,\\ldots,N-2\\}$ such that the product $(\\phi_{j+1}-\\phi_j)(\\phi_j-\\phi_{j-1}) < 0$, i.e., the first difference changes sign, indicating a discrete interior extremum.\n\nImplement a program that:\n- Constructs and solves the linear system for the central-differencing finite volume scheme on a uniform grid as described above, for each specified test case.\n- Reports, for each case, a boolean indicating whether a non-monotone interior oscillation is detected by the above criterion.\n\nUse the following five test cases, each specified by the tuple $(N, Pe, \\phi_L, \\phi_R)$:\n- Case $1$: $(N, Pe, \\phi_L, \\phi_R) = (10, 0.5, 1, 0)$.\n- Case $2$: $(N, Pe, \\phi_L, \\phi_R) = (10, 4.0, 1, 0)$.\n- Case $3$: $(N, Pe, \\phi_L, \\phi_R) = (40, 4.0, 1, 0)$.\n- Case $4$: $(N, Pe, \\phi_L, \\phi_R) = (10, 2.0, 1, 0)$.\n- Case $5$: $(N, Pe, \\phi_L, \\phi_R) = (10, -4.0, 0, 1)$.\n\nNotes:\n- Fix $\\Gamma=1$ and $\\rho=1$ to make all quantities dimensionless. Then $D = 1/\\Delta x$ and $F = Pe/\\Delta x$. The uniform mesh spacing is $\\Delta x = 1/N$.\n- You must use the sign of $Pe$ consistently to determine the sign of the mass flux $F$.\n- The final linear system must be assembled exactly from the central-differencing finite volume formulation; do not regularize, limit, or modify coefficients.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order of the above five cases. For example, the output should be of the form $[r_1,r_2,r_3,r_4,r_5]$ where each $r_k$ is a boolean indicating whether an interior oscillation was detected for case $k$. No angles or physical units occur in this problem; all quantities are dimensionless. The only required output is this one line in the specified format.", "solution": "The user wants to analyze the stability of a central-differencing finite volume scheme for a 1D steady convection-diffusion problem.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n\n*   **Governing Equation:** $-\\frac{\\mathrm{d}}{\\mathrm{d}x}\\left(\\Gamma \\frac{\\mathrm{d}\\phi}{\\mathrm{d}x}\\right) + \\frac{\\mathrm{d}}{\\mathrm{d}x}\\left(\\rho u \\, \\phi\\right) = 0$ on the domain $x \\in [0,1]$.\n*   **Parameters:** Diffusion coefficient $\\Gamma > 0$, density $\\rho > 0$, and velocity $u$ are constant. All quantities are dimensionless.\n*   **Boundary Conditions (BCs):** Dirichlet, $\\phi(0)=\\phi_L$ and $\\phi(1)=\\phi_R$.\n*   **Numerical Discretization:**\n    *   Finite volume method on a uniform grid of $N$ control volumes.\n    *   Grid nodes are at $x_i = i \\Delta x$ for $i=0, \\ldots, N$, with $\\Delta x = 1/N$. The interior unknowns are $\\phi_1, \\ldots, \\phi_{N-1}$. This implies a vertex-centered scheme where $\\phi_i$ is the value at node $x_i$.\n    *   A second-order central difference is specified for both diffusive and convective fluxes at control volume faces.\n*   **Definitions:**\n    *   Diffusion conductance: $D = \\Gamma / \\Delta x$.\n    *   Mass flux: $F = \\rho u$.\n    *   Grid Peclet number: $Pe = F \\Delta x / \\Gamma$.\n*   **Constants:** Fixed values $\\Gamma=1$ and $\\rho=1$ are specified for the implementation.\n*   **Oscillation Detection:** An interior oscillation is present if at least one of two conditions is met:\n    1.  An interior solution value $\\phi_j$ (for $j \\in \\{1, \\ldots, N-1\\}$) is strictly outside the range $[\\min(\\phi_L, \\phi_R), \\max(\\phi_L, \\phi_R)]$.\n    2.  A discrete interior extremum exists, defined as $(\\phi_{j+1}-\\phi_j)(\\phi_j-\\phi_{j-1}) < 0$ for some index $j \\in \\{1, \\ldots, N-2\\}$.\n*   **Test Cases:**\n    1.  $(N, Pe, \\phi_L, \\phi_R) = (10, 0.5, 1, 0)$\n    2.  $(N, Pe, \\phi_L, \\phi_R) = (10, 4.0, 1, 0)$\n    3.  $(N, Pe, \\phi_L, \\phi_R) = (40, 4.0, 1, 0)$\n    4.  $(N, Pe, \\phi_L, \\phi_R) = (10, 2.0, 1, 0)$\n    5.  $(N, Pe, \\phi_L, \\phi_R) = (10, -4.0, 0, 1)$\n\n**Step 2: Validate Using Extracted Givens**\n\n*   **Scientific Grounding:** The problem is based on the canonical 1D convection-diffusion equation and standard finite volume methods, a fundamental topic in computational fluid dynamics. The investigation of numerical stability as a function of the grid Peclet number is a classic and crucial subject. The problem is scientifically sound.\n*   **Well-Posed:** The continuous problem is a well-posed linear boundary value problem. The discretization leads to a tridiagonal linear system. For the specified schemes and parameters, this system is non-singular, guaranteeing a unique solution. The question is well-posed.\n*   **Objective:** The problem is formulated with precise mathematical definitions, quantitative criteria, and specific numerical parameters. It is free from subjectivity and ambiguity.\n*   **Completeness:** All necessary information, including the governing equation, boundary conditions, discretization scheme, parameter definitions, and test cases, is provided. The problem is self-contained.\n*   **Consistency:** There are no contradictions. The definitions of $D$, $F$, and $Pe$ are mutually consistent. The structure of the desired linear system (for $\\phi_1, \\ldots, \\phi_{N-1}$) is consistent with a vertex-centered grid interpretation, despite the \"cell-centered\" terminology, which is a common point of mild terminological confusion but does not create a formal contradiction in the setup.\n\n**Step 3: Verdict and Action**\n\nThe problem is valid. A reasoned solution will be developed.\n\n### Principle-Based Solution\n\nThe task is to derive and solve the discretized form of the 1D steady convection-diffusion equation and to check the solution for non-physical oscillations.\n\n**1. Discretization via Finite Volume Method**\nThe governing equation in conservative form is $\\frac{\\mathrm{d}}{\\mathrm{d}x} J(x) = 0$, where $J(x)$ is the total flux, given by $J = -\\Gamma \\frac{\\mathrm{d}\\phi}{\\mathrm{d}x} + F\\phi$, with $F = \\rho u$. This implies that the total flux is constant throughout the domain.\n\nWe use a vertex-centered finite volume approach. The domain $[0,1]$ is divided into $N$ segments by $N+1$ nodes at locations $x_i = i\\Delta x$ for $i=0, 1, \\ldots, N$, where $\\Delta x = 1/N$. The unknowns are the values $\\phi_i$ at the interior nodes $i=1, \\ldots, N-1$. The boundary values are given: $\\phi_0 = \\phi_L$ and $\\phi_N = \\phi_R$.\n\nWe integrate the governing equation over a control volume (CV) centered around an interior node $x_i$. The CV extends from face $w$ at $x_i - \\Delta x/2$ to face $e$ at $x_i + \\Delta x/2$.\n$$ \\int_{x_i - \\Delta x/2}^{x_i + \\Delta x/2} \\frac{\\mathrm{d}J}{\\mathrm{d}x} \\mathrm{d}x = 0 $$\n$$ J_e - J_w = 0 $$\nwhere $J_e$ and $J_w$ are the total fluxes at the east and west faces of the CV, respectively.\n\n**2. Flux Approximation using Central Differencing**\nThe fluxes at the faces are approximated using second-order central differences for both diffusion and convection.\n\nAt the east face $e$ (midway between nodes $i$ and $i+1$):\nThe diffusive flux is approximated as:\n$$ \\left(-\\Gamma \\frac{\\mathrm{d}\\phi}{\\mathrm{d}x}\\right)_e \\approx -\\Gamma \\frac{\\phi_{i+1} - \\phi_i}{\\Delta x} = -D(\\phi_{i+1} - \\phi_i) $$\nwhere $D=\\Gamma/\\Delta x$.\nThe convective flux requires the value of $\\phi$ at the face, which is found by linear interpolation:\n$$ (F\\phi)_e \\approx F \\phi_e = F \\frac{\\phi_i + \\phi_{i+1}}{2} $$\nThe total flux at face $e$ is:\n$$ J_e \\approx F \\frac{\\phi_i + \\phi_{i+1}}{2} - D(\\phi_{i+1} - \\phi_i) = \\left(\\frac{F}{2} + D\\right)\\phi_i - \\left(D - \\frac{F}{2}\\right)\\phi_{i+1} $$\n\nSimilarly, at the west face $w$ (midway between nodes $i-1$ and $i$):\n$$ J_w \\approx F \\frac{\\phi_{i-1} + \\phi_i}{2} - D(\\phi_i - \\phi_{i-1}) = \\left(\\frac{F}{2} - D\\right)\\phi_i + \\left(\\frac{F}{2} + D\\right)\\phi_{i-1} $$\n\n**3. Derivation of the Algebraic Equation**\nSubstituting the flux approximations into the balance equation $J_e - J_w = 0$:\n$$ \\left[\\left(\\frac{F}{2} + D\\right)\\phi_i - \\left(D - \\frac{F}{2}\\right)\\phi_{i+1}\\right] - \\left[\\left(\\frac{F}{2} - D\\right)\\phi_i + \\left(\\frac{F}{2} + D\\right)\\phi_{i-1}\\right] = 0 $$\nCollecting terms for $\\phi_{i-1}$, $\\phi_i$, and $\\phi_{i+1}$:\n$$ -\\left(D + \\frac{F}{2}\\right)\\phi_{i-1} + \\left(2D\\right)\\phi_i - \\left(D - \\frac{F}{2}\\right)\\phi_{i+1} = 0 $$\nTo express this in terms of the grid Peclet number, $Pe = F\\Delta x/\\Gamma = F/D$, we divide the entire equation by $D$:\n$$ -\\left(1 + \\frac{Pe}{2}\\right)\\phi_{i-1} + 2\\phi_i - \\left(1 - \\frac{Pe}{2}\\right)\\phi_{i+1} = 0 $$\nThis algebraic equation relates the value at node $i$ to its immediate neighbors.\n\n**4. Assembly of the Linear System**\nThis equation holds for all interior nodes $i=1, \\ldots, N-1$. We assemble a tridiagonal linear system of the form $A\\vec{\\phi} = \\vec{b}$ for the vector of unknowns $\\vec{\\phi} = [\\phi_1, \\ldots, \\phi_{N-1}]^T$.\n\nThe matrix $A$ is an $(N-1) \\times (N-1)$ tridiagonal matrix with the following coefficients:\n-   Main diagonal ($d_i$): $2$\n-   Lower diagonal ($a_i$): $-\\left(1 + \\frac{Pe}{2}\\right)$\n-   Upper diagonal ($c_i$): $-\\left(1 - \\frac{Pe}{2}\\right) = \\frac{Pe}{2} - 1$\n\nThe boundary conditions $\\phi_0 = \\phi_L$ and $\\phi_N = \\phi_R$ are incorporated into the right-hand side vector $\\vec{b}$.\nFor the first equation ($i=1$):\n$$ 2\\phi_1 - \\left(1 - \\frac{Pe}{2}\\right)\\phi_2 = \\left(1 + \\frac{Pe}{2}\\right)\\phi_0 = \\left(1 + \\frac{Pe}{2}\\right)\\phi_L $$\nThus, $b_1 = (1 + Pe/2)\\phi_L$.\n\nFor the last equation ($i=N-1$):\n$$ -\\left(1 + \\frac{Pe}{2}\\right)\\phi_{N-2} + 2\\phi_{N-1} = \\left(1 - \\frac{Pe}{2}\\right)\\phi_N = \\left(1 - \\frac{Pe}{2}\\right)\\phi_R $$\nThus, $b_{N-1} = (1 - Pe/2)\\phi_R$.\n\nFor all other equations ($i=2, \\ldots, N-2$), the right-hand side is zero, $b_i = 0$.\n\n**5. Stability and Oscillations**\nThe central differencing scheme is known to be stable and produce monotonic solutions only when the matrix $A$ is diagonally dominant. This requires $|d_i| \\geq |a_i| + |c_i|$, which translates to:\n$$ |2| \\geq \\left|-\\left(1 + \\frac{Pe}{2}\\right)\\right| + \\left|-\\left(1 - \\frac{Pe}{2}\\right)\\right| $$\n$$ 2 \\geq \\left|1 + \\frac{Pe}{2}\\right| + \\left|1 - \\frac{Pe}{2}\\right| $$\nThis inequality holds only if $|Pe/2| \\leq 1$, or $|Pe| \\leq 2$. When $|Pe| > 2$, diagonal dominance is lost, and the coefficients of the neighboring nodes in the stencil can become negative, leading to non-physical, oscillatory solutions. The problem asks to demonstrate this behavior.\n\n**6. Computational Procedure**\nThe program will implement the following steps for each test case:\n1.  Given $N$, $Pe$, $\\phi_L$, and $\\phi_R$.\n2.  Construct the $(N-1) \\times (N-1)$ tridiagonal matrix $A$ and the RHS vector $\\vec{b}$ as derived above.\n3.  Solve the linear system $A\\vec{\\phi} = \\vec{b}$ to find the interior solution values $\\phi_1, \\ldots, \\phi_{N-1}$.\n4.  Create the full solution array $\\{\\phi_i\\}_{i=0}^N$ by prepending $\\phi_L$ and appending $\\phi_R$.\n5.  Apply the two specified criteria to detect oscillations:\n    *   Check if any interior $\\phi_j$ is strictly outside $[\\min(\\phi_L, \\phi_R), \\max(\\phi_L, \\phi_R)]$.\n    *   Check if $(\\phi_{j+1}-\\phi_j)(\\phi_j-\\phi_{j-1}) < 0$ for any $j \\in \\{1, \\ldots, N-2\\}$.\n6.  Report `True` if an oscillation is detected, and `False` otherwise.", "answer": "[False,True,True,False,True]", "id": "3365178"}]}