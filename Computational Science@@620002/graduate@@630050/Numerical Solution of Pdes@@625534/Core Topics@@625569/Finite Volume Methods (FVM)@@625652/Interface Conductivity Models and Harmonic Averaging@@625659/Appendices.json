{"hands_on_practices": [{"introduction": "The foundation of a robust numerical method lies in its physical consistency. This first practice takes you back to basics, tasking you with deriving the correct expression for diffusive flux across an interface between two cells with different conductivities [@problem_id:3409996]. By enforcing the continuity of flux and temperature at the interface—a fundamental physical requirement—you will see how the weighted harmonic average for interface conductivity emerges naturally, providing a solid physical justification for its use in finite volume schemes.", "problem": "Consider steady heat conduction of a scalar temperature field $u(x)$ governed by Fourier’s law in one spatial dimension along the $x$-axis, on a Cartesian finite volume mesh comprising rectangular control volumes. Two adjacent cells, denoted $W$ (west) and $E$ (east), share an internal vertical face at location $x=x_{f}$. Let the cell centers be at $x=x_{W}$ and $x=x_{E}$ with distances $d_{W}=x_{f}-x_{W}$ and $d_{E}=x_{E}-x_{f}$. Assume isotropic thermal conductivity that is piecewise constant in each cell, equal to $k_{W}$ within cell $W$ and $k_{E}$ within cell $E$. The normal heat flux density across the shared face, $q_{f}$, is defined positive from $W$ to $E$.\n\nStarting only from Fourier’s law $q=-k\\,\\partial u/\\partial x$ and the continuity of normal heat flux at an internal face, derive a consistent discrete expression for $q_{f}$ in terms of $u_{W}$, $u_{E}$, $d_{W}$, $d_{E}$, $k_{W}$, and $k_{E}$, and justify why the resulting interface conductivity is a harmonic average with geometric weights set by the distances $d_{W}$ and $d_{E}$ to the cell centers.\n\nThen, evaluate $q_{f}$ for the following data:\n- Cell widths $\\Delta x_{W}=0.6\\,\\mathrm{m}$ and $\\Delta x_{E}=0.2\\,\\mathrm{m}$, so that $d_{W}=\\Delta x_{W}/2$ and $d_{E}=\\Delta x_{E}/2$.\n- Conductivities $k_{W}=2.5\\,\\mathrm{W}\\,\\mathrm{m}^{-1}\\,\\mathrm{K}^{-1}$ and $k_{E}=15\\,\\mathrm{W}\\,\\mathrm{m}^{-1}\\,\\mathrm{K}^{-1}$.\n- Cell-centered temperatures $u_{W}=400\\,\\mathrm{K}$ and $u_{E}=300\\,\\mathrm{K}$.\n\nRound your final numerical value of $q_{f}$ to four significant figures. Express the flux density in $\\mathrm{W}\\,\\mathrm{m}^{-2}$.", "solution": "The problem statement has been validated and is deemed sound. It is scientifically grounded in Fourier's law of heat conduction, a fundamental principle in physics and engineering. The problem is well-posed, providing all necessary definitions, constants, and boundary conditions to derive a unique and meaningful solution for the interface heat flux. The language is objective and precise, and the numerical values provided are physically consistent and plausible. Therefore, a solution will be provided.\n\nThe primary objective is to derive a discrete expression for the normal heat flux density, $q_{f}$, across the face shared by two adjacent control volumes, $W$ and $E$. The derivation begins with Fourier's law for one-dimensional steady heat conduction:\n$$\nq = -k \\frac{du}{dx}\n$$\nwhere $q$ is the heat flux density, $k$ is the thermal conductivity, and $u$ is the temperature. For steady-state conduction in a source-free medium, the heat flux $q$ must be constant throughout the domain. Let this constant flux from cell $W$ to cell $E$ be denoted $q_{f}$.\n\nThe finite volume method discretizes the domain and assumes that the piecewise constant conductivity applies within each cell. To find the flux at the interface $x=x_{f}$, we integrate Fourier's law across the two half-cells adjacent to the face. The key physical assumptions are the continuity of temperature and the continuity of normal heat flux at the interface. Let the temperature at the interface $x_f$ be $u_f$.\n\nFirst, we consider the region between the cell center $x_W$ and the interface $x_f$. In this region, the conductivity is constant at $k=k_W$. We can rearrange Fourier's law and integrate from $x_W$ to $x_f$:\n$$\n\\int_{u(x_W)}^{u(x_f)} du = \\int_{x_W}^{x_f} -\\frac{q}{k} dx\n$$\nSince $q=q_f$ (constant) and $k=k_W$ (constant) in this interval, we have:\n$$\nu(x_f) - u(x_W) = -\\frac{q_f}{k_W} (x_f - x_W)\n$$\nUsing the provided notation, where $u_f = u(x_f)$, $u_W = u(x_W)$, and $d_W = x_f - x_W$, this becomes:\n$$\nu_f - u_W = -\\frac{q_f d_W}{k_W}\n$$\nThis equation can be rearranged to express the interface temperature $u_f$ in terms of the cell-center temperature $u_W$ and the flux $q_f$:\n$$\nu_f = u_W - \\frac{q_f d_W}{k_W}\n$$\nNext, we perform the same procedure for the region between the interface $x_f$ and the cell center $x_E$. In this region, the conductivity is constant at $k=k_E$. Integrating Fourier's law from $x_f$ to $x_E$:\n$$\n\\int_{u(x_f)}^{u(x_E)} du = \\int_{x_f}^{x_E} -\\frac{q}{k} dx\n$$\nWith $q=q_f$ and $k=k_E$, the integration yields:\n$$\nu(x_E) - u(x_f) = -\\frac{q_f}{k_E} (x_E - x_f)\n$$\nUsing the notation $u_E = u(x_E)$ and $d_E = x_E - x_f$:\n$$\nu_E - u_f = -\\frac{q_f d_E}{k_E}\n$$\nThis provides a second expression for the interface temperature $u_f$:\n$$\nu_f = u_E + \\frac{q_f d_E}{k_E}\n$$\nNow, we enforce the continuity of temperature at the interface by equating the two expressions for $u_f$. This eliminates the unknown interface temperature from the system.\n$$\nu_W - \\frac{q_f d_W}{k_W} = u_E + \\frac{q_f d_E}{k_E}\n$$\nWe can now solve for the heat flux $q_f$. Rearranging the terms to group $q_f$:\n$$\nu_W - u_E = q_f \\left( \\frac{d_W}{k_W} + \\frac{d_E}{k_E} \\right)\n$$\nFinally, the discrete expression for the heat flux density at the face is:\n$$\nq_f = \\frac{u_W - u_E}{\\frac{d_W}{k_W} + \\frac{d_E}{k_E}}\n$$\nThis expression is consistent because if $u_W > u_E$, the flux $q_f$ is positive, corresponding to heat flow from $W$ to $E$ as defined in the problem.\n\nTo justify why this formulation involves a harmonic average, we can compare our result to a standard finite difference approximation of Fourier's law, $q_f = -k_f \\frac{u_E - u_W}{d_W + d_E}$, where $k_f$ is an effective interface conductivity.\nBy rewriting our derived expression for $q_f$:\n$$\nq_f = - \\frac{u_E - u_W}{\\frac{d_W}{k_W} + \\frac{d_E}{k_E}}\n$$\nComparing the two forms for $q_f$, we can equate the coefficients of the temperature difference term, $-(u_E-u_W)$:\n$$\n\\frac{k_f}{d_W + d_E} = \\frac{1}{\\frac{d_W}{k_W} + \\frac{d_E}{k_E}}\n$$\nSolving for $k_f$ gives:\n$$\nk_f = \\frac{d_W + d_E}{\\frac{d_W}{k_W} + \\frac{d_E}{k_E}}\n$$\nThis is the definition of the weighted harmonic average of the conductivities $k_W$ and $k_E$, with the weights being the respective distances $d_W$ and $d_E$. This averaging scheme naturally arises from the physical model of two thermal resistors in series. The thermal resistance per unit area of a slab of thickness $\\Delta x$ and conductivity $k$ is $R' = \\frac{\\Delta x}{k}$. The total resistance from the center of cell $W$ to the center of cell $E$ is the sum of the resistances of the two segments: $R'_{total} = R'_W + R'_E = \\frac{d_W}{k_W} + \\frac{d_E}{k_E}$. The heat flux is the temperature difference across the total resistance, $q_f = \\frac{\\Delta u}{R'_{total}} = \\frac{u_W - u_E}{R'_{total}}$, which is precisely the derived expression.\n\nNow, we evaluate $q_f$ using the given numerical data:\n- Cell widths: $\\Delta x_{W}=0.6\\,\\mathrm{m}$ and $\\Delta x_{E}=0.2\\,\\mathrm{m}$.\n- Distances to cell centers: $d_{W}=\\frac{\\Delta x_{W}}{2}=\\frac{0.6}{2}=0.3\\,\\mathrm{m}$ and $d_{E}=\\frac{\\Delta x_{E}}{2}=\\frac{0.2}{2}=0.1\\,\\mathrm{m}$.\n- Conductivities: $k_{W}=2.5\\,\\mathrm{W}\\,\\mathrm{m}^{-1}\\,\\mathrm{K}^{-1}$ and $k_{E}=15\\,\\mathrm{W}\\,\\mathrm{m}^{-1}\\,\\mathrm{K}^{-1}$.\n- Cell-centered temperatures: $u_{W}=400\\,\\mathrm{K}$ and $u_{E}=300\\,\\mathrm{K}$.\n\nSubstituting these values into the derived expression for $q_f$:\n$$\nq_f = \\frac{400 - 300}{\\frac{0.3}{2.5} + \\frac{0.1}{15}}\n$$\nFirst, calculate the terms in the denominator:\n$$\n\\frac{d_W}{k_W} = \\frac{0.3}{2.5} = 0.12 \\, \\mathrm{m}^2\\,\\mathrm{K}\\,\\mathrm{W}^{-1}\n$$\n$$\n\\frac{d_E}{k_E} = \\frac{0.1}{15} = \\frac{1}{150} \\approx 0.00666\\overline{6} \\, \\mathrm{m}^2\\,\\mathrm{K}\\,\\mathrm{W}^{-1}\n$$\nThe denominator is the sum of these two resistances:\n$$\n\\frac{d_W}{k_W} + \\frac{d_E}{k_E} = 0.12 + \\frac{1}{150} = \\frac{12}{100} + \\frac{1}{150} = \\frac{3}{25} + \\frac{1}{150} = \\frac{18}{150} + \\frac{1}{150} = \\frac{19}{150} \\, \\mathrm{m}^2\\,\\mathrm{K}\\,\\mathrm{W}^{-1}\n$$\nThe temperature difference is $\\Delta u = u_W - u_E = 400 - 300 = 100 \\, \\mathrm{K}$.\nNow, we calculate the flux density:\n$$\nq_f = \\frac{100}{\\frac{19}{150}} = \\frac{100 \\times 150}{19} = \\frac{15000}{19} \\, \\mathrm{W}\\,\\mathrm{m}^{-2}\n$$\nPerforming the division:\n$$\nq_f \\approx 789.473684... \\, \\mathrm{W}\\,\\mathrm{m}^{-2}\n$$\nRounding the result to four significant figures as requested:\n$$\nq_f \\approx 789.5 \\, \\mathrm{W}\\,\\mathrm{m}^{-2}\n$$\nThe positive sign indicates that the heat flux is directed from cell $W$ to cell $E$, consistent with the higher temperature in cell $W$.", "answer": "$$\n\\boxed{789.5}\n$$", "id": "3409996"}, {"introduction": "A theoretical justification is powerful, but empirical evidence is conclusive. In this computational exercise, you will put the theory to the test by implementing and comparing two different numerical schemes for a diffusion problem with sharp, discontinuous conductivity jumps arranged in a checkerboard pattern [@problem_id:3409997]. By measuring the convergence rates, you will directly observe the superior accuracy and robustness of the physically-derived harmonic averaging scheme compared to a naive arithmetic average, especially in high-contrast scenarios.", "problem": "Consider the stationary diffusion equation with spatially varying isotropic conductivity,\n$$\n-\\nabla \\cdot \\left(k(\\mathbf{x}) \\nabla u(\\mathbf{x})\\right) = f(\\mathbf{x}) \\quad \\text{in } \\Omega = (0,1)\\times(0,1),\n$$\nsubject to homogeneous Dirichlet boundary conditions,\n$$\nu(\\mathbf{x}) = 0 \\quad \\text{on } \\partial\\Omega.\n$$\nAssume a uniform Cartesian partition of $\\Omega$ into $N\\times N$ square control volumes of side length $h = 1/N$ with scalar cell-centered unknowns $u_{i,j}$ interpreted as cell averages over cell $(i,j)$ for $i,j \\in \\{0,\\dots,N-1\\}$. Let the source be constant $f(\\mathbf{x}) \\equiv f_0$ for a specified scalar $f_0$. The conductivity $k(\\mathbf{x})$ is piecewise constant per cell, forming a checkerboard pattern with two positive constants $k_{\\mathrm{high}}$ and $k_{\\mathrm{low}}$ alternating by parity of the cell indices, i.e., the cell conductivity $k_{i,j}$ equals $k_{\\mathrm{high}}$ if $i+j$ is even and $k_{\\mathrm{low}}$ if $i+j$ is odd. This arrangement models a strongly heterogeneous medium with discontinuous interfaces aligned to the grid.\n\nStarting from the local conservation law and the definition of diffusive flux through cell faces, discretize the operator using two distinct face conductivity models:\n- A physically consistent finite volume discretization that uses a face-centered conductivity derived from an interface model appropriate for series conduction across abutting half-cells. For interior faces between two neighboring cells, use the conductivity implied by the interface model. For boundary-adjacent faces, treat the homogeneous Dirichlet boundary condition located at the cell face and derive the correct face transmissibility from first principles.\n- A centered difference scheme that uses an arithmetic average of the two cell conductivities at each interior face. Treat boundary-adjacent faces consistently with the centered difference stencil and the homogeneous Dirichlet boundary condition placed at the cell face.\n\nOn the uniform grid, both schemes produce a five-point stencil in two dimensions. Assemble the resulting linear system\n$$\nA u = b,\n$$\nwhere $u \\in \\mathbb{R}^{N^2}$ collects $\\{u_{i,j}\\}$ in lexicographic order, and $b \\in \\mathbb{R}^{N^2}$ is the discretized source term. Solve this system to obtain numerical solutions for both schemes.\n\nTo quantify convergence, define the discrete $L^2$ norm of a cell-centered field $w_{i,j}$ by\n$$\n\\|w\\|_{L^2_h} \\coloneqq \\left( \\sum_{i=0}^{N-1} \\sum_{j=0}^{N-1} w_{i,j}^2 \\, h^2 \\right)^{1/2}.\n$$\nSince a closed-form exact solution $u(\\mathbf{x})$ is generally not available for discontinuous coefficient fields, use a reference solution computed on a much finer grid for the physically consistent finite volume discretization. Specifically, compute a reference solution on a grid with $N_{\\mathrm{ref}} = 128$ using the finite volume scheme and restrict it to coarser grids by block averaging over non-overlapping $s \\times s$ blocks, where $s = N_{\\mathrm{ref}}/N$ is an integer. For a given coarse grid solution $u^{(N)}$ and the corresponding restricted reference $u^{\\mathrm{ref}\\to N}$, define the error\n$$\nE(N) \\coloneqq \\left\\| u^{(N)} - u^{\\mathrm{ref}\\to N} \\right\\|_{L^2_h}.\n$$\nFor each scheme, estimate the empirical convergence rate $p$ by fitting a straight line to the data $\\left\\{ \\left(\\log h, \\log E(N)\\right) \\right\\}$ across multiple grid sizes, where $h = 1/N$. Use linear least squares to obtain the slope $p$.\n\nYour task is to implement this benchmark and produce empirical convergence rates for both schemes over a small test suite comprising different conductivity contrasts. Use the following test suite:\n- Case $1$: $k_{\\mathrm{high}} = 10$, $k_{\\mathrm{low}} = 1$, $f_0 = 1$, coarse grid sizes $N \\in \\{16, 32, 64\\}$.\n- Case $2$: $k_{\\mathrm{high}} = 1000$, $k_{\\mathrm{low}} = 1$, $f_0 = 1$, coarse grid sizes $N \\in \\{16, 32, 64\\}$.\n- Case $3$: $k_{\\mathrm{high}} = 1$, $k_{\\mathrm{low}} = 10^{-3}$, $f_0 = 1$, coarse grid sizes $N \\in \\{16, 32, 64\\}$.\n\nFor each case, compute a single reference solution on the fine grid with $N_{\\mathrm{ref}} = 128$ using the finite volume scheme with the physically consistent face conductivity model. Then, for each coarse grid in the set, solve both schemes and compute the error relative to the restricted reference. Estimate the convergence rate $p_{\\mathrm{FV}}$ for the finite volume scheme and $p_{\\mathrm{CD}}$ for the centered difference scheme by linear regression of $\\log E(N)$ against $\\log h$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, ordered as\n$$\n\\left[ p_{\\mathrm{FV}}^{(1)},\\, p_{\\mathrm{CD}}^{(1)},\\, p_{\\mathrm{FV}}^{(2)},\\, p_{\\mathrm{CD}}^{(2)},\\, p_{\\mathrm{FV}}^{(3)},\\, p_{\\mathrm{CD}}^{(3)} \\right],\n$$\nwhere the superscript indicates the case index. Each entry must be a floating-point number.\n\nNo external input is required. All physical quantities are nondimensional in this benchmark, so no physical units are to be reported. Angles are not used. Percentages are not used. The final output must adhere exactly to the required format.", "solution": "We begin from the fundamental conservation principle for steady diffusion. For a control volume $V_{i,j}$ surrounding a cell center $(i,j)$ with volume $|V_{i,j}| = h^2$, integrating the partial differential equation yields\n$$\n\\int_{V_{i,j}} -\\nabla \\cdot \\left(k \\nabla u\\right) \\, \\mathrm{d}\\mathbf{x} = \\int_{V_{i,j}} f \\, \\mathrm{d}\\mathbf{x}.\n$$\nBy the divergence theorem, the left-hand side equals the net diffusive flux through the boundary of the volume,\n$$\n\\sum_{\\text{faces } F \\subset \\partial V_{i,j}} \\int_{F} \\left( -k \\nabla u \\cdot \\mathbf{n}_F \\right) \\, \\mathrm{d}S = \\int_{V_{i,j}} f \\, \\mathrm{d}\\mathbf{x}.\n$$\nOn a uniform Cartesian grid with side length $h$, each interior face has area $h$ and the distance between adjacent cell centers is $h$. Approximating the normal derivative across a face between two adjacent cell centers by a centered difference, the diffusive flux across an interior face $F$ between cells $(i,j)$ and $(i',j')$ can be written as\n$$\n\\Phi_F \\approx -k_F \\frac{u_{i',j'} - u_{i,j}}{h} \\cdot h = -k_F\\,(u_{i',j'} - u_{i,j}),\n$$\nwhere $k_F$ is an effective face conductivity. Substituting into the integrated balance and dividing both sides by the cell volume $h^2$ yields a discrete equation in the standard five-point form,\n$$\n\\sum_{\\text{neighbors } (i',j')} \\frac{k_F}{h^2}\\left(u_{i,j} - u_{i',j'}\\right) + \\sum_{\\text{boundary faces}} \\frac{k_{F,\\partial}}{h^2}\\left(u_{i,j} - u_{\\mathrm{bc}}\\right) = f_{i,j}.\n$$\nHere, the second sum accounts for boundary-adjacent faces. For a homogeneous Dirichlet boundary condition $u_{\\mathrm{bc}} = 0$ placed directly at the cell face, the distance from the cell center to the boundary is $h/2$, and the normal derivative approximation becomes\n$$\n\\frac{u_{\\mathrm{bc}} - u_{i,j}}{h/2},\n$$\nso the boundary face flux magnitude is\n$$\n\\Phi_{F,\\partial} \\approx -k_{i,j} \\frac{u_{\\mathrm{bc}} - u_{i,j}}{h/2} \\cdot h = -2 k_{i,j} (u_{\\mathrm{bc}} - u_{i,j}).\n$$\nDividing by $h^2$, the boundary face transmissibility is\n$$\nT_{F,\\partial} = \\frac{2 k_{i,j}}{h^2}.\n$$\n\nThe crucial modeling choice is the effective face conductivity $k_F$ for interior faces. Consider two adjacent cells with conductivities $k_L$ and $k_R$ in the normal direction, abutting along a common face. Modeling the composite medium normal to the face as two layers of thickness $h/2$ in series, the equivalent resistance per unit area in the normal direction is\n$$\nR_{\\mathrm{eq}} = \\frac{h/2}{k_L} + \\frac{h/2}{k_R} = \\frac{h}{2}\\left(\\frac{1}{k_L} + \\frac{1}{k_R}\\right).\n$$\nThe equivalent conductivity $k_F$ that produces the same normal flux for a unit jump in $u$ across the distance $h$ satisfies\n$$\n\\Phi_F = -k_F \\frac{\\Delta u}{h} \\cdot h = -k_F \\Delta u,\n$$\nand by equating to the series flux through the two half-cells,\n$$\n\\Phi_F = -\\frac{\\Delta u}{R_{\\mathrm{eq}}}.\n$$\nThus,\n$$\nk_F = \\frac{h}{R_{\\mathrm{eq}}} = \\frac{h}{\\frac{h}{2}\\left(\\frac{1}{k_L} + \\frac{1}{k_R}\\right)} = \\frac{2}{\\frac{1}{k_L} + \\frac{1}{k_R}}.\n$$\nThis is the harmonic average of $k_L$ and $k_R$, and it arises from the fundamental series conduction model at an interface. Using this $k_F$ in the discrete flux yields a physically consistent finite volume scheme across discontinuous interfaces.\n\nIn contrast, a commonly used centered difference approximation in heterogeneous media often replaces $k_F$ with the arithmetic average,\n$$\nk_F^{\\mathrm{arith}} = \\frac{k_L + k_R}{2},\n$$\nwhich is exact for uniform $k$ but inconsistent for sharp jumps; it misrepresents series conduction and tends to smear interface effects, resulting in reduced accuracy and potentially grid-dependent artifacts.\n\nFor both schemes, the assembled matrix $A$ is symmetric positive definite with diagonal entries equal to the sum of transmissibilities to neighbors and boundary faces, and off-diagonal entries equal to negative transmissibilities connecting adjacent cells. The right-hand side $b$ uses the cell-centered source $f_{i,j} = f_0$.\n\nBecause a closed-form solution is not available for discontinuous checkerboard conductivity, we adopt the method of manufactured reference by computing a high-resolution solution using the physically consistent finite volume scheme on a fine grid with $N_{\\mathrm{ref}} = 128$. To compare coarse grid solutions against this reference, we restrict the fine solution to each coarse grid by block averaging over non-overlapping $s \\times s$ blocks, where $s = N_{\\mathrm{ref}}/N$ is an integer. This restriction produces a coarse field $u^{\\mathrm{ref}\\to N}$ aligned to the coarse cell averages.\n\nWe then compute the discrete $L^2$ error\n$$\nE(N) = \\left( \\sum_{i=0}^{N-1} \\sum_{j=0}^{N-1} \\left(u^{(N)}_{i,j} - u^{\\mathrm{ref}\\to N}_{i,j}\\right)^2 \\, h^2 \\right)^{1/2}.\n$$\nAssuming an asymptotic error model $E(N) \\approx C h^p$ for sufficiently fine grids, taking logarithms yields\n$$\n\\log E(N) \\approx \\log C + p \\log h.\n$$\nWe estimate the rate $p$ by linear least squares fitting of the slope of $\\log E(N)$ versus $\\log h$ across the grid sizes $N \\in \\{16, 32, 64\\}$.\n\nThe test suite explores three contrasts: Case $1$ with moderate contrast $k_{\\mathrm{high}} = 10$, $k_{\\mathrm{low}} = 1$, Case $2$ with strong contrast $k_{\\mathrm{high}} = 1000$, $k_{\\mathrm{low}} = 1$, and Case $3$ with reverse contrast including a very small conductivity $k_{\\mathrm{low}} = 10^{-3}$ relative to $k_{\\mathrm{high}} = 1$. In all cases, the source is $f_0 = 1$. We expect the physically consistent finite volume scheme to exhibit better accuracy and more stable convergence behavior near discontinuities than the centered difference scheme with arithmetic averaging, particularly at high contrast where interface modeling is critical.\n\nAlgorithmically, the program performs the following steps for each case:\n- Construct the $N_{\\mathrm{ref}}\\times N_{\\mathrm{ref}}$ checkerboard conductivity field.\n- Assemble and solve the finite volume system with harmonic face conductivities to obtain the fine reference solution.\n- For each coarse grid size $N \\in \\{16, 32, 64\\}$:\n  - Assemble and solve the finite volume system with harmonic face conductivities.\n  - Assemble and solve the centered difference system with arithmetic face conductivities.\n  - Restrict the fine reference solution onto the coarse grid by block averaging.\n  - Compute the discrete $L^2$ error for each scheme relative to the restricted reference.\n- Estimate the convergence rates $p_{\\mathrm{FV}}$ and $p_{\\mathrm{CD}}$ by linear regression in $\\log$-$\\log$ space.\n\nFinally, the program prints a single line with the six floating-point numbers in the order\n$$\n\\left[ p_{\\mathrm{FV}}^{(1)},\\, p_{\\mathrm{CD}}^{(1)},\\, p_{\\mathrm{FV}}^{(2)},\\, p_{\\mathrm{CD}}^{(2)},\\, p_{\\mathrm{FV}}^{(3)},\\, p_{\\mathrm{CD}}^{(3)} \\right].\n$$", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.sparse import lil_matrix, csr_matrix\nfrom scipy.sparse.linalg import spsolve\n\ndef build_checkerboard_k(N: int, k_high: float, k_low: float) -> np.ndarray:\n    \"\"\"\n    Build an N x N checkerboard conductivity field with k_high and k_low alternating\n    by parity of (i + j).\n    \"\"\"\n    k = np.empty((N, N), dtype=float)\n    for i in range(N):\n        for j in range(N):\n            k[i, j] = k_high if ((i + j) % 2 == 0) else k_low\n    return k\n\ndef face_conductivity(k_left: float, k_right: float, scheme: str) -> float:\n    \"\"\"\n    Compute face conductivity between two adjacent cells given their conductivities.\n    scheme: 'harmonic' or 'arithmetic'\n    \"\"\"\n    if scheme == 'harmonic':\n        # Harmonic average: 2 / (1/k_left + 1/k_right)\n        # Guard against division by zero (though k are positive by construction)\n        return 2.0 / (1.0 / k_left + 1.0 / k_right)\n    elif scheme == 'arithmetic':\n        return 0.5 * (k_left + k_right)\n    else:\n        raise ValueError(\"Unknown scheme: {}\".format(scheme))\n\ndef assemble_system(N: int, k: np.ndarray, scheme: str, f0: float) -> tuple:\n    \"\"\"\n    Assemble the sparse linear system A u = b for the variable-coefficient diffusion\n    problem on an N x N cell-centered grid with homogeneous Dirichlet boundary conditions.\n    Interior faces use either harmonic or arithmetic averaging depending on 'scheme'.\n    Boundary faces use a transmissibility of 2*k_cell/h^2 corresponding to a boundary at the face.\n    Returns (A_csr, b) where A_csr is a csr_matrix of size (N^2, N^2) and b is an ndarray of length N^2.\n    \"\"\"\n    h = 1.0 / N\n    # Using LIL for assembly efficiency, then convert to CSR.\n    A = lil_matrix((N * N, N * N), dtype=float)\n    b = np.full(N * N, f0, dtype=float)\n\n    def idx(i: int, j: int) -> int:\n        return i * N + j\n\n    for i in range(N):\n        for j in range(N):\n            p = idx(i, j)\n            diag = 0.0\n            k_ij = k[i, j]\n\n            # Left face (neighbor at j-1 or boundary)\n            if j > 0:\n                k_face = face_conductivity(k_ij, k[i, j - 1], scheme)\n                T = k_face / (h * h)\n                diag += T\n                A[p, idx(i, j - 1)] -= T\n            else:\n                # Boundary at left face: distance h/2\n                T = 2.0 * k_ij / (h * h)\n                diag += T\n                # u_bc = 0, so no RHS contribution needed\n\n            # Right face (neighbor at j+1 or boundary)\n            if j < N - 1:\n                k_face = face_conductivity(k_ij, k[i, j + 1], scheme)\n                T = k_face / (h * h)\n                diag += T\n                A[p, idx(i, j + 1)] -= T\n            else:\n                T = 2.0 * k_ij / (h * h)\n                diag += T\n\n            # Bottom face (neighbor at i-1 or boundary)\n            if i > 0:\n                k_face = face_conductivity(k_ij, k[i - 1, j], scheme)\n                T = k_face / (h * h)\n                diag += T\n                A[p, idx(i - 1, j)] -= T\n            else:\n                T = 2.0 * k_ij / (h * h)\n                diag += T\n\n            # Top face (neighbor at i+1 or boundary)\n            if i < N - 1:\n                k_face = face_conductivity(k_ij, k[i + 1, j], scheme)\n                T = k_face / (h * h)\n                diag += T\n                A[p, idx(i + 1, j)] -= T\n            else:\n                T = 2.0 * k_ij / (h * h)\n                diag += T\n\n            A[p, p] += diag\n\n    return csr_matrix(A), b\n\ndef solve_system(A: csr_matrix, b: np.ndarray) -> np.ndarray:\n    \"\"\"\n    Solve the sparse linear system A u = b using a direct solver.\n    \"\"\"\n    return spsolve(A, b)\n\ndef restrict_block_average(u_ref: np.ndarray, N_ref: int, N: int) -> np.ndarray:\n    \"\"\"\n    Restrict a fine-grid solution u_ref (flattened length N_ref^2) to a coarse grid of size N x N\n    by block averaging over non-overlapping s x s blocks, where s = N_ref // N.\n    Returns a flattened coarse solution of length N^2.\n    \"\"\"\n    s = N_ref // N\n    assert N_ref % N == 0, \"N_ref must be divisible by N for block averaging.\"\n    # Reshape fine solution to 2D\n    u2d = u_ref.reshape(N_ref, N_ref)\n    # Average over s x s blocks\n    u_coarse = np.zeros((N, N), dtype=float)\n    for i in range(N):\n        for j in range(N):\n            block = u2d[i * s:(i + 1) * s, j * s:(j + 1) * s]\n            u_coarse[i, j] = np.mean(block)\n    return u_coarse.ravel()\n\ndef l2_error(u_coarse: np.ndarray, u_ref_coarse: np.ndarray, N: int) -> float:\n    \"\"\"\n    Compute the discrete L2 error between u_coarse and restricted reference u_ref_coarse on an N x N grid.\n    \"\"\"\n    h = 1.0 / N\n    diff = u_coarse - u_ref_coarse\n    return np.sqrt(np.sum(diff * diff) * h * h)\n\ndef convergence_rate(N_list: list, err_list: list) -> float:\n    \"\"\"\n    Estimate the convergence rate p by linear regression of log(err) versus log(h),\n    where h = 1/N, across the given N_list and err_list.\n    \"\"\"\n    h_list = np.array([1.0 / N for N in N_list], dtype=float)\n    logh = np.log(h_list)\n    loge = np.log(np.array(err_list, dtype=float))\n    # Fit line: loge = a + p * logh\n    p = np.polyfit(logh, loge, 1)[0]\n    return float(p)\n\ndef run_case(k_high: float, k_low: float, f0: float, N_ref: int, N_list: list) -> tuple:\n    \"\"\"\n    Run a single test case:\n    - Build checkerboard k on fine grid N_ref.\n    - Solve FV harmonic scheme on fine grid for reference.\n    - For each N in N_list, solve both schemes and compute L2 errors against restricted reference.\n    - Return the estimated convergence rates for FV harmonic and CD arithmetic.\n    \"\"\"\n    # Reference solution on fine grid using FV harmonic\n    k_ref = build_checkerboard_k(N_ref, k_high, k_low)\n    A_ref, b_ref = assemble_system(N_ref, k_ref, scheme='harmonic', f0=f0)\n    u_ref = solve_system(A_ref, b_ref)\n\n    # Collect errors across coarse grids\n    errs_fv = []\n    errs_cd = []\n\n    for N in N_list:\n        # Conductivity on coarse grid\n        kN = build_checkerboard_k(N, k_high, k_low)\n\n        # FV harmonic on coarse grid\n        A_fv, b_fv = assemble_system(N, kN, scheme='harmonic', f0=f0)\n        u_fv = solve_system(A_fv, b_fv)\n\n        # CD arithmetic on coarse grid\n        A_cd, b_cd = assemble_system(N, kN, scheme='arithmetic', f0=f0)\n        u_cd = solve_system(A_cd, b_cd)\n\n        # Restrict reference to coarse grid\n        u_ref_N = restrict_block_average(u_ref, N_ref, N)\n\n        # Errors\n        e_fv = l2_error(u_fv, u_ref_N, N)\n        e_cd = l2_error(u_cd, u_ref_N, N)\n\n        errs_fv.append(e_fv)\n        errs_cd.append(e_cd)\n\n    # Rates via regression\n    rate_fv = convergence_rate(N_list, errs_fv)\n    rate_cd = convergence_rate(N_list, errs_cd)\n\n    return rate_fv, rate_cd\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (k_high, k_low, f0, N_ref, N_list)\n        (10.0, 1.0, 1.0, 128, [16, 32, 64]),\n        (1000.0, 1.0, 1.0, 128, [16, 32, 64]),\n        (1.0, 1e-3, 1.0, 128, [16, 32, 64]),\n    ]\n\n    results = []\n    for k_high, k_low, f0, N_ref, N_list in test_cases:\n        rate_fv, rate_cd = run_case(k_high, k_low, f0, N_ref, N_list)\n        # Append in the specified order\n        results.append(rate_fv)\n        results.append(rate_cd)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "3409997"}, {"introduction": "The power of a physical principle is measured by its adaptability to complex problems. This final practice extends the concept of flux continuity to the context of the Ghost Fluid Method (GFM), a sophisticated technique for capturing sharp interfaces that are not aligned with the computational grid [@problem_id:3410015]. You will derive a 'ghost' temperature value that allows a standard finite-difference stencil to correctly account for the jump in conductivity, demonstrating how the same harmonic averaging principle is essential for developing advanced interface-capturing schemes.", "problem": "Consider the steady-state conduction model governed by the scalar Partial Differential Equation (PDE) $-\\nabla \\cdot (\\kappa \\nabla u) = 0$ on a domain consisting of two homogeneous materials separated by a sharp interface $\\Gamma$. Let the interface be represented by a level-set function $\\phi$ that is a signed distance: $\\phi < 0$ in material $\\Omega^{-}$ and $\\phi > 0$ in material $\\Omega^{+}$, with the unit normal $\\boldsymbol{n} = \\nabla \\phi / |\\nabla \\phi|$ pointing from $\\Omega^{-}$ to $\\Omega^{+}$. Assume perfect thermal contact across $\\Gamma$ and no interfacial sources or sinks, so that $u$ is continuous and the normal conductive flux $-\\kappa \\nabla u \\cdot \\boldsymbol{n}$ is continuous across $\\Gamma$.\n\nFocus on a one-dimensional normal line segment locally aligned with $\\boldsymbol{n}$ that connects two grid points $x_{i}$ and $x_{i+1}$, where $x_{i}$ lies in $\\Omega^{-}$ and $x_{i+1}$ lies in $\\Omega^{+}$. Assume the local coordinate $x$ parameterizes this line with $x$ increasing in the direction of $\\boldsymbol{n}$, the interface location $x_{\\Gamma}$ lies strictly between $x_{i}$ and $x_{i+1}$, and the distances along the normal are $d_{-} = |x_{\\Gamma} - x_{i}|$ and $d_{+} = |x_{i+1} - x_{\\Gamma}|$. The thermal conductivities are $\\kappa_{-}$ in $\\Omega^{-}$ and $\\kappa_{+}$ in $\\Omega^{+}$. Let $u_{i}$ and $u_{i+1}$ denote the discrete temperatures at $x_{i}$ and $x_{i+1}$, respectively. Let $u_{\\Gamma}$ denote the true temperature at the interface point $x_{\\Gamma}$.\n\nYou are to derive ghost values for the Ghost Fluid Method (GFM) that enforce the continuity of the normal flux $-\\kappa \\nabla u \\cdot \\boldsymbol{n}$ in the discrete scheme. In particular, construct the ghost value $u_{i+1}^{G|-}$, defined as the extrapolated value at location $x_{i+1}$ from the $\\Omega^{-}$ side using the interface conditions, so that a centered finite-difference stencil at $x_{i}$ can be applied entirely with $\\Omega^{-}$ data.\n\nStarting from fundamental conservation principles and constitutive laws (Fourier’s law), proceed as follows:\n\n1. Use continuity of the normal flux and continuity of $u$ to eliminate $u_{\\Gamma}$ and derive the discrete flux $q$ along the normal line segment as a function of $u_{i}$, $u_{i+1}$, $d_{-}$, $d_{+}$, $\\kappa_{-}$, and $\\kappa_{+}$. Show that the resulting effective conductivity entering this two-point flux is a harmonic average weighted by $d_{-}$ and $d_{+}$.\n\n2. Derive an expression for the interface value $u_{\\Gamma}$ in terms of $u_{i}$, $u_{i+1}$, $d_{-}$, $d_{+}$, $\\kappa_{-}$, and $\\kappa_{+}$.\n\n3. Using the one-sided $\\Omega^{-}$ gradient at the interface, construct the ghost value $u_{i+1}^{G|-}$ by linear extrapolation from $\\Omega^{-}$ across the interface to $x_{i+1}$. Express $u_{i+1}^{G|-}$ in closed form in terms of $u_{i}$, $u_{i+1}$, $d_{-}$, $d_{+}$, $\\kappa_{-}$, and $\\kappa_{+}$.\n\nNow evaluate $u_{i+1}^{G|-}$ for the following scientifically consistent data:\n\n- $\\kappa_{-} = 3.2$ (in $\\mathrm{W}\\,\\mathrm{m}^{-1}\\,\\mathrm{K}^{-1}$),\n- $\\kappa_{+} = 0.8$ (in $\\mathrm{W}\\,\\mathrm{m}^{-1}\\,\\mathrm{K}^{-1}$),\n- $u_{i} = 310$ (in $\\mathrm{K}$),\n- $u_{i+1} = 340$ (in $\\mathrm{K}$),\n- $\\phi(x_{i}) = -3.5 \\times 10^{-4}$ (in $\\mathrm{m}$),\n- $\\phi(x_{i+1}) = 6.5 \\times 10^{-4}$ (in $\\mathrm{m}$).\n\nBecause $\\phi$ is a signed distance, take $d_{-} = |\\phi(x_{i})|$ and $d_{+} = |\\phi(x_{i+1})|$. Express the final ghost temperature $u_{i+1}^{G|-}$ in $\\mathrm{K}$ and round your answer to four significant figures.", "solution": "The problem statement is evaluated and deemed to be valid. It is scientifically grounded in the principles of steady-state heat conduction, is mathematically well-posed, and all terms and data are provided in a clear, objective, and consistent manner. We may therefore proceed with the solution.\n\nThe problem describes one-dimensional, steady-state heat conduction normal to an interface between two materials. The governing equation is $-\\nabla \\cdot (\\kappa \\nabla u) = 0$. In one dimension, along the normal coordinate $x$, this simplifies to $-\\frac{d}{dx}(\\kappa \\frac{du}{dx}) = 0$. This implies that the conductive heat flux, given by Fourier's law as $q = -\\kappa \\frac{du}{dx}$, is constant along the coordinate $x$. The condition of perfect thermal contact ensures that both the temperature $u$ and the normal flux $q$ are continuous across the interface $\\Gamma$ at location $x_{\\Gamma}$.\n\nWe consider two segments: the first from $x_i$ to $x_{\\Gamma}$ in material $\\Omega^{-}$ with conductivity $\\kappa_{-}$, and the second from $x_{\\Gamma}$ to $x_{i+1}$ in material $\\Omega^{+}$ with conductivity $\\kappa_{+}$. The lengths of these segments are $d_{-} = x_{\\Gamma} - x_i$ and $d_{+} = x_{i+1} - x_{\\Gamma}$. Applying a first-order finite difference approximation for the gradients on each segment, we can write the constant flux $q$ in two ways:\n$$q = -\\kappa_{-} \\frac{u_{\\Gamma} - u_i}{d_{-}} \\quad (1)$$\n$$q = -\\kappa_{+} \\frac{u_{i+1} - u_{\\Gamma}}{d_{+}} \\quad (2)$$\nwhere $u_i$, $u_{\\Gamma}$, and $u_{i+1}$ are the temperatures at locations $x_i$, $x_{\\Gamma}$, and $x_{i+1}$ respectively.\n\n**1. Derivation of the Discrete Flux and Effective Conductivity**\n\nTo find the flux $q$ as a function of the known temperatures $u_i$ and $u_{i+1}$, we must eliminate the unknown interface temperature $u_{\\Gamma}$. We can rearrange equations $(1)$ and $(2)$ to solve for the temperature drops across each segment:\n$$u_{\\Gamma} - u_i = -\\frac{q d_{-}}{\\kappa_{-}}$$\n$$u_{i+1} - u_{\\Gamma} = -\\frac{q d_{+}}{\\kappa_{+}}$$\nAdding these two equations eliminates $u_{\\Gamma}$:\n$$(u_{i+1} - u_{\\Gamma}) + (u_{\\Gamma} - u_i) = -\\frac{q d_{-}}{\\kappa_{-}} - \\frac{q d_{+}}{\\kappa_{+}}$$\n$$u_{i+1} - u_i = -q \\left( \\frac{d_{-}}{\\kappa_{-}} + \\frac{d_{+}}{\\kappa_{+}} \\right)$$\nSolving for the flux $q$, we obtain:\n$$q = - \\frac{u_{i+1} - u_i}{\\frac{d_{-}}{\\kappa_{-}} + \\frac{d_{+}}{\\kappa_{+}}}$$\nThis expression represents the discrete flux along the normal line segment. To interpret the effective conductivity, we compare this to the standard two-point flux form over the total distance $h = d_{-} + d_{+}$, which is $q = -\\kappa_{\\text{eff}} \\frac{u_{i+1} - u_i}{h}$. Equating the two expressions for $q$ yields:\n$$\\kappa_{\\text{eff}} \\frac{u_{i+1} - u_i}{d_{-} + d_{+}} = \\frac{u_{i+1} - u_i}{\\frac{d_{-}}{\\kappa_{-}} + \\frac{d_{+}}{\\kappa_{+}}}$$\n$$\\kappa_{\\text{eff}} = \\frac{d_{-} + d_{+}}{\\frac{d_{-}}{\\kappa_{-}} + \\frac{d_{+}}{\\kappa_{+}}}$$\nThis form for $\\kappa_{\\text{eff}}$ is precisely the harmonic average of the conductivities $\\kappa_{-}$ and $\\kappa_{+}$, weighted by the respective distances $d_{-}$ and $d_{+}$.\n\n**2. Derivation of the Interface Temperature $u_{\\Gamma}$**\n\nTo find the interface temperature $u_{\\Gamma}$, we can rearrange equation $(1)$ to $u_{\\Gamma} = u_i - \\frac{q d_{-}}{\\kappa_{-}}$ and substitute the derived expression for $q$:\n$$u_{\\Gamma} = u_i - \\frac{d_{-}}{\\kappa_{-}} \\left( - \\frac{u_{i+1} - u_i}{\\frac{d_{-}}{\\kappa_{-}} + \\frac{d_{+}}{\\kappa_{+}}} \\right) = u_i + \\frac{\\frac{d_{-}}{\\kappa_{-}}}{\\frac{d_{-}}{\\kappa_{-}} + \\frac{d_{+}}{\\kappa_{+}}} (u_{i+1} - u_i)$$\nCombining terms over a common denominator:\n$$u_{\\Gamma} = \\frac{u_i \\left(\\frac{d_{-}}{\\kappa_{-}} + \\frac{d_{+}}{\\kappa_{+}}\\right) + u_{i+1} \\frac{d_{-}}{\\kappa_{-}} - u_i \\frac{d_{-}}{\\kappa_{-}}}{\\frac{d_{-}}{\\kappa_{-}} + \\frac{d_{+}}{\\kappa_{+}}} = \\frac{u_i \\frac{d_{+}}{\\kappa_{+}} + u_{i+1} \\frac{d_{-}}{\\kappa_{-}}}{\\frac{d_{-}}{\\kappa_{-}} + \\frac{d_{+}}{\\kappa_{+}}}$$\nTo obtain a more convenient form, we multiply the numerator and denominator by $\\kappa_{-} \\kappa_{+}$:\n$$u_{\\Gamma} = \\frac{u_i d_{+} \\kappa_{-} + u_{i+1} d_{-} \\kappa_{+}}{d_{-} \\kappa_{+} + d_{+} \\kappa_{-}}$$\nThis shows that the interface temperature is a weighted average of the neighboring temperatures $u_i$ and $u_{i+1}$, with weights depending on the distances and conductivities.\n\n**3. Derivation of the Ghost Value $u_{i+1}^{G|-}$**\n\nThe ghost value $u_{i+1}^{G|-}$ is the temperature that would be found at location $x_{i+1}$ by linearly extrapolating the temperature profile from the $\\Omega^{-}$ side across the interface. The gradient on the $\\Omega^{-}$ side at the interface is $(\\frac{du}{dx})^{-} = \\frac{u_{\\Gamma} - u_i}{d_{-}}$. The linear extrapolation to $x_{i+1}$ is thus:\n$$u_{i+1}^{G|-} = u_{\\Gamma} + d_{+} \\left( \\frac{du}{dx} \\right)^{-} = u_{\\Gamma} + d_{+} \\frac{u_{\\Gamma} - u_i}{d_{-}}$$\nTo express this in terms of the known quantities, we substitute the expression for $u_{\\Gamma}$ from Part 2. First, let's find the term $(u_{\\Gamma} - u_i)$:\n$$u_{\\Gamma} - u_i = \\frac{u_i d_{+} \\kappa_{-} + u_{i+1} d_{-} \\kappa_{+}}{d_{-} \\kappa_{+} + d_{+} \\kappa_{-}} - u_i = \\frac{u_i d_{+} \\kappa_{-} + u_{i+1} d_{-} \\kappa_{+} - u_i (d_{-} \\kappa_{+} + d_{+} \\kappa_{-})}{d_{-} \\kappa_{+} + d_{+} \\kappa_{-}}$$\n$$u_{\\Gamma} - u_i = \\frac{u_{i+1} d_{-} \\kappa_{+} - u_i d_{-} \\kappa_{+}}{d_{-} \\kappa_{+} + d_{+} \\kappa_{-}} = \\frac{d_{-} \\kappa_{+} (u_{i+1} - u_i)}{d_{-} \\kappa_{+} + d_{+} \\kappa_{-}}$$\nNow, substitute this and the expression for $u_{\\Gamma}$ into the formula for the ghost value:\n$$u_{i+1}^{G|-} = \\left( \\frac{u_i d_{+} \\kappa_{-} + u_{i+1} d_{-} \\kappa_{+}}{d_{-} \\kappa_{+} + d_{+} \\kappa_{-}} \\right) + \\frac{d_{+}}{d_{-}} \\left( \\frac{d_{-} \\kappa_{+} (u_{i+1} - u_i)}{d_{-} \\kappa_{+} + d_{+} \\kappa_{-}} \\right)$$\nCombining over the common denominator:\n$$u_{i+1}^{G|-} = \\frac{u_i d_{+} \\kappa_{-} + u_{i+1} d_{-} \\kappa_{+} + d_{+} \\kappa_{+} (u_{i+1} - u_i)}{d_{-} \\kappa_{+} + d_{+} \\kappa_{-}}$$\n$$u_{i+1}^{G|-} = \\frac{u_i d_{+} \\kappa_{-} + u_{i+1} d_{-} \\kappa_{+} + u_{i+1} d_{+} \\kappa_{+} - u_i d_{+} \\kappa_{+}}{d_{-} \\kappa_{+} + d_{+} \\kappa_{-}}$$\nGrouping terms by $u_i$ and $u_{i+1}$ gives the final closed-form expression:\n$$u_{i+1}^{G|-} = \\frac{u_i d_{+} (\\kappa_{-} - \\kappa_{+}) + u_{i+1} \\kappa_{+} (d_{-} + d_{+})}{d_{-} \\kappa_{+} + d_{+} \\kappa_{-}}$$\n\n**Numerical Evaluation**\n\nWe are given the following data:\n- $\\kappa_{-} = 3.2$\n- $\\kappa_{+} = 0.8$\n- $u_{i} = 310$\n- $u_{i+1} = 340$\n- $d_{-} = |\\phi(x_{i})| = |-3.5 \\times 10^{-4}| = 3.5 \\times 10^{-4}$\n- $d_{+} = |\\phi(x_{i+1})| = |6.5 \\times 10^{-4}| = 6.5 \\times 10^{-4}$\n\nWe substitute these numerical values into the derived expression for $u_{i+1}^{G|-}$.\nFirst, we calculate the denominator:\n$$d_{-} \\kappa_{+} + d_{+} \\kappa_{-} = (3.5 \\times 10^{-4})(0.8) + (6.5 \\times 10^{-4})(3.2)$$\n$$= (2.8 \\times 10^{-4}) + (20.8 \\times 10^{-4}) = 23.6 \\times 10^{-4}$$\nNext, we calculate the numerator:\n$$u_i d_{+} (\\kappa_{-} - \\kappa_{+}) + u_{i+1} \\kappa_{+} (d_{-} + d_{+})$$\n$$= 310 \\times (6.5 \\times 10^{-4}) \\times (3.2 - 0.8) + 340 \\times (0.8) \\times (3.5 \\times 10^{-4} + 6.5 \\times 10^{-4})$$\n$$= 310 \\times (6.5 \\times 10^{-4}) \\times (2.4) + 340 \\times (0.8) \\times (10 \\times 10^{-4})$$\n$$= 310 \\times (15.6 \\times 10^{-4}) + 272 \\times (1.0 \\times 10^{-3})$$\n$$= (4836 \\times 10^{-4}) + (2720 \\times 10^{-4}) = 7556 \\times 10^{-4}$$\nFinally, we compute the ratio:\n$$u_{i+1}^{G|-} = \\frac{7556 \\times 10^{-4}}{23.6 \\times 10^{-4}} = \\frac{7556}{23.6} \\approx 320.16949$$\nRounding to four significant figures, the ghost temperature is $320.2 \\, \\mathrm{K}$.", "answer": "$$\\boxed{320.2}$$", "id": "3410015"}]}