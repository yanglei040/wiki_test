{"hands_on_practices": [{"introduction": "The first step in analyzing any finite difference scheme using Fourier methods is to determine its effect on a single Fourier mode. This effect is captured by the operator's Fourier symbol, or modified wavenumber, which acts as its unique \"fingerprint\" in the frequency domain. This exercise [@problem_id:3429328] provides fundamental practice in deriving this symbol for a high-order stencil and interpreting its Taylor series to precisely quantify the scheme's accuracy and leading-order error, which in this case manifests as numerical dispersion.", "problem": "Consider a one-dimensional periodic spatial domain with length $L$ and a uniform grid of $N$ points, spacing $h = L/N$. Let $u_j$ denote a grid function at nodes $x_j = j h$, $j = 0, 1, \\dots, N-1$, with periodic indexing. Define the linear difference operator $D$ that approximates the first spatial derivative by the fourth-order central stencil\n$$\n(D u)_j \\;=\\; \\frac{1}{12\\,h}\\left(-\\,u_{j+2} \\;+\\; 8\\,u_{j+1} \\;-\\; 8\\,u_{j-1} \\;+\\; u_{j-2}\\right).\n$$\nUsing the Discrete Fourier Transform (DFT), regard $D$ as a shift-invariant convolution operator and define its Fourier symbol $\\widehat{D}(\\theta)$ as the complex scalar such that for any single Fourier mode $u_j = U \\exp\\!\\big(i\\,k_c\\,x_j\\big)$, with $U \\in \\mathbb{C}$, continuous wavenumber $k_c \\in \\mathbb{R}$, and $\\theta = k_c h$, one has $(D u)_j = \\widehat{D}(\\theta)\\,u_j$. All trigonometric functions are to be understood in radians. \n\nStarting from the definition of the DFT and the Discrete Parseval identity (which equates the $\\ell^2$ energy of a grid function to the sum of squared magnitudes of its Fourier coefficients), derive the explicit closed-form expression for the Fourier symbol $\\widehat{D}(\\theta)$ of the above stencil. Then obtain its small-$k$ expansion (that is, the Taylor series in $\\theta$ for $|\\theta|\\ll 1$) and compare it to the continuum differential operator’s symbol $i\\,k_c$. Specifically, compute the first three nonzero terms in the series of $\\widehat{D}(\\theta)$ about $\\theta = 0$ and express them in terms of $k_c$ and $h$. Explain the order of accuracy indicated by this expansion.\n\nYour final answer must be a single closed-form analytic expression for $\\widehat{D}(\\theta)$ in terms of $k_c$ and $h$. No rounding is required.", "solution": "We work on a periodic grid where linear, shift-invariant difference operators are convolutions and are diagonalized by the Discrete Fourier Transform (DFT). The Discrete Parseval identity guarantees that energy norms in physical space correspond to sums over modal energies in Fourier space, allowing accuracy and stability analyses to be performed mode by mode via the operator’s Fourier symbol.\n\nLet $u_j = U \\exp\\!\\big(i\\,k_c\\,x_j\\big)$ be a single Fourier mode, with $U \\in \\mathbb{C}$, $k_c \\in \\mathbb{R}$, and $x_j = j h$. Define $\\theta = k_c h$, so that $u_{j+m} = U \\exp\\!\\big(i\\,k_c\\,x_{j+m}\\big) = U \\exp\\!\\big(i\\,k_c\\,(x_j + m h)\\big) = U \\exp\\!\\big(i\\,k_c\\,x_j\\big)\\exp\\!\\big(i\\,m\\theta\\big) = u_j\\,\\exp\\!\\big(i\\,m\\theta\\big)$.\n\nThe operator $D$ is given by\n$$\n(D u)_j \\;=\\; \\frac{1}{12\\,h}\\left(-\\,u_{j+2} \\;+\\; 8\\,u_{j+1} \\;-\\; 8\\,u_{j-1} \\;+\\; u_{j-2}\\right).\n$$\nSubstituting the Fourier mode and factoring out $u_j$ yields\n\\begin{align*}\n(D u)_j\n= \\frac{1}{12\\,h}\\left(-\\,u_j\\,\\exp(2 i \\theta) \\;+\\; 8\\,u_j\\,\\exp(i \\theta) \\;-\\; 8\\,u_j\\,\\exp(-i \\theta) \\;+\\; u_j\\,\\exp(-2 i \\theta)\\right) \\\\\n= u_j \\cdot \\frac{1}{12\\,h}\\left(-\\,\\exp(2 i \\theta) \\;+\\; 8\\,\\exp(i \\theta) \\;-\\; 8\\,\\exp(-i \\theta) \\;+\\; \\exp(-2 i \\theta)\\right).\n\\end{align*}\nBy the definition of the Fourier symbol, this gives\n$$\n\\widehat{D}(\\theta) \\;=\\; \\frac{1}{12\\,h}\\left(-\\,\\exp(2 i \\theta) \\;+\\; 8\\,\\exp(i \\theta) \\;-\\; 8\\,\\exp(-i \\theta) \\;+\\; \\exp(-2 i \\theta)\\right).\n$$\nWe simplify using the identities $\\exp(i\\alpha) - \\exp(-i\\alpha) = 2 i \\sin(\\alpha)$:\n\\begin{align*}\n8\\,\\exp(i\\theta) - 8\\,\\exp(-i\\theta) = 16 i \\sin(\\theta), \\\\\n-\\,\\exp(2 i\\theta) + \\exp(-2 i\\theta) = -\\,2 i \\sin(2\\theta).\n\\end{align*}\nThus\n\\begin{align*}\n\\widehat{D}(\\theta)\n= \\frac{1}{12\\,h}\\left(16 i \\sin(\\theta) - 2 i \\sin(2\\theta)\\right)\n= \\frac{i}{12\\,h}\\left(16 \\sin(\\theta) - 2 \\sin(2\\theta)\\right) \\\\\n= \\frac{i}{6\\,h}\\left(8 \\sin(\\theta) - \\sin(2\\theta)\\right).\n\\end{align*}\nThis is the explicit closed-form Fourier symbol. It is purely imaginary, consistent with an approximation to a first derivative.\n\nTo obtain the small-$k$ expansion, write $\\theta = k_c h$ and expand the sines for $|\\theta|\\ll 1$:\n\\begin{align*}\n\\sin(\\theta) = \\theta - \\frac{\\theta^3}{6} + \\frac{\\theta^5}{120} - \\frac{\\theta^7}{5040} + \\mathcal{O}(\\theta^9), \\\\\n\\sin(2\\theta) = 2\\theta - \\frac{(2\\theta)^3}{6} + \\frac{(2\\theta)^5}{120} - \\frac{(2\\theta)^7}{5040} + \\mathcal{O}(\\theta^9) \\\\\n= 2\\theta - \\frac{4}{3}\\theta^3 + \\frac{4}{15}\\theta^5 - \\frac{8}{315}\\theta^7 + \\mathcal{O}(\\theta^9).\n\\end{align*}\nCompute $8 \\sin(\\theta) - \\sin(2\\theta)$:\n\\begin{align*}\n8 \\sin(\\theta) - \\sin(2\\theta)\n= 8\\left(\\theta - \\frac{\\theta^3}{6} + \\frac{\\theta^5}{120} - \\frac{\\theta^7}{5040}\\right)\n- \\left(2\\theta - \\frac{4}{3}\\theta^3 + \\frac{4}{15}\\theta^5 - \\frac{8}{315}\\theta^7\\right) + \\mathcal{O}(\\theta^9) \\\\\n= (8\\theta - 2\\theta) + \\left(-\\frac{8}{6}\\theta^3 + \\frac{4}{3}\\theta^3\\right) + \\left(\\frac{8}{120}\\theta^5 - \\frac{4}{15}\\theta^5\\right) + \\left(-\\frac{8}{5040}\\theta^7 + \\frac{8}{315}\\theta^7\\right) + \\mathcal{O}(\\theta^9) \\\\\n= 6\\theta + 0\\cdot\\theta^3 - \\frac{1}{5}\\theta^5 + \\frac{1}{42}\\theta^7 + \\mathcal{O}(\\theta^9).\n\\end{align*}\nTherefore,\n\\begin{align*}\n\\widehat{D}(\\theta)\n= \\frac{i}{6\\,h}\\left(6\\theta - \\frac{1}{5}\\theta^5 + \\frac{1}{42}\\theta^7 + \\mathcal{O}(\\theta^9)\\right) \\\\\n= i\\left(\\frac{\\theta}{h} - \\frac{\\theta^5}{30\\,h} + \\frac{\\theta^7}{252\\,h} + \\mathcal{O}\\!\\left(\\frac{\\theta^9}{h}\\right)\\right).\n\\end{align*}\nSubstituting $\\theta = k_c h$ yields\n\\begin{align*}\n\\widehat{D}(\\theta)\n= i\\left(k_c - \\frac{k_c^5 h^4}{30} + \\frac{k_c^7 h^6}{252} + \\mathcal{O}\\!\\big(k_c^9 h^8\\big)\\right)\n= i\\,k_c\\left(1 - \\frac{(k_c h)^4}{30} + \\frac{(k_c h)^6}{252} + \\mathcal{O}\\!\\big((k_c h)^8\\big)\\right).\n\\end{align*}\nComparing to the continuum symbol $i\\,k_c$, the leading discrepancy is of order $(k_c h)^4$, demonstrating fourth-order accuracy for the first derivative approximation by this stencil.\n\nThus, the explicit Fourier symbol is\n$$\n\\widehat{D}(\\theta) \\;=\\; \\frac{i}{6\\,h}\\left(8 \\sin(\\theta) - \\sin(2\\theta)\\right),\n\\quad \\text{with } \\theta = k_c h,\n$$\nand its small-$k$ expansion relative to $i\\,k_c$ confirms fourth-order accuracy.", "answer": "$$\\boxed{\\frac{i}{6\\,h}\\left(8\\,\\sin(k_c h)\\;-\\;\\sin(2\\,k_c h)\\right)}$$", "id": "3429328"}, {"introduction": "Beyond analyzing spatial accuracy, Fourier analysis provides a powerful framework for assessing the stability of time-evolution schemes. By applying Parseval's identity, we can equate the total energy of a solution on the grid to the sum of energies in its Fourier modes. This exercise [@problem_id:3429318] demonstrates this principle by deriving the famous Courant-Friedrichs-Lewy (CFL) stability condition for the heat equation, showing how the requirement of non-increasing total energy translates into a simple algebraic condition on the per-mode amplification factor.", "problem": "Consider the one-dimensional heat equation $u_{t}=\\nu\\,u_{xx}$ with positive diffusivity $\\nu0$ on a periodic domain of length $L$, discretized on a uniform grid with $N$ points, grid spacing $h=L/N$, and periodic indexing $j\\in\\{0,1,\\dots,N-1\\}$ (indices are taken modulo $N$). Define the standard second-order centered discrete Laplacian by $(\\Delta_{h} u)_{j}=\\frac{u_{j+1}-2u_{j}+u_{j-1}}{h^{2}}$. Consider the explicit forward Euler time-stepping scheme\n$$\nu_{j}^{n+1}=u_{j}^{n}+\\nu\\,\\Delta t\\,(\\Delta_{h}u^{n})_{j},\n$$\nwhere $\\Delta t0$ is the time step. Let the discrete Fourier transform (DFT) be defined by\n$$\n\\widehat{v}(k)=\\frac{1}{\\sqrt{N}}\\sum_{j=0}^{N-1}v_{j}\\,\\exp\\!\\left(-\\,\\mathrm{i}\\,\\frac{2\\pi j k}{N}\\right),\\quad k\\in\\{0,1,\\dots,N-1\\},\n$$\nand recall that the DFT is unitary so that the Parseval identity holds:\n$$\n\\sum_{j=0}^{N-1}|v_{j}|^{2}=\\sum_{k=0}^{N-1}|\\widehat{v}(k)|^{2}.\n$$\nDefine the Fourier symbol $\\sigma_{\\Delta_{h}}(k)$ of the discrete Laplacian $\\Delta_{h}$ by the relation $\\widehat{(\\Delta_{h}v)}(k)=\\sigma_{\\Delta_{h}}(k)\\,\\widehat{v}(k)$ for each mode $k$. Using only the above definitions and facts, perform a discrete Fourier analysis of the scheme to derive the stability requirement on $\\Delta t$ in the $\\ell^{2}$ norm. In particular:\n- Compute $\\sigma_{\\Delta_{h}}(k)$ and the per-mode amplification factor $G(k)$ for the scheme in Fourier space.\n- Use the Parseval identity to justify that stability in the $\\ell^{2}$ norm requires $\\sup_{k}|G(k)|\\leq 1$.\n- Maximize $-\\sigma_{\\Delta_{h}}(k)$ over $k\\in\\{0,1,\\dots,N-1\\}$ to obtain the most restrictive constraint on $\\Delta t$, and justify why the worst-case mode is the Nyquist mode $k=N/2$ (assume $N$ is even so that this mode exists).\n\nExpress your final answer as a single closed-form analytic expression for the largest admissible time step $\\Delta t_{\\max}$ in terms of $h$ and $\\nu$. No rounding is required.", "solution": "The analysis is structured into four parts: computing the Fourier symbol of the discrete Laplacian, determining the amplification factor of the scheme, justifying the stability criterion using the Parseval identity, and deriving the stability limit on the time step $\\Delta t$ by analyzing the worst-case Fourier mode.\n\nFirst, we compute the Fourier symbol $\\sigma_{\\Delta_{h}}(k)$ of the discrete Laplacian operator $\\Delta_{h}$, which is defined by the relation $\\widehat{(\\Delta_{h}v)}(k)=\\sigma_{\\Delta_{h}}(k)\\,\\widehat{v}(k)$. We begin by applying the discrete Fourier transform (DFT) to the operator $(\\Delta_{h} v)_{j}=\\frac{v_{j+1}-2v_{j}+v_{j-1}}{h^{2}}$.\n$$\n\\widehat{(\\Delta_{h}v)}(k) = \\frac{1}{\\sqrt{N}}\\sum_{j=0}^{N-1} \\left(\\frac{v_{j+1}-2v_{j}+v_{j-1}}{h^{2}}\\right) \\exp\\left(-\\mathrm{i}\\,\\frac{2\\pi j k}{N}\\right)\n$$\n$$\n\\widehat{(\\Delta_{h}v)}(k) = \\frac{1}{h^{2}} \\left[ \\frac{1}{\\sqrt{N}}\\sum_{j=0}^{N-1}v_{j+1}\\exp\\left(-\\mathrm{i}\\,\\frac{2\\pi j k}{N}\\right) - \\frac{2}{\\sqrt{N}}\\sum_{j=0}^{N-1}v_{j}\\exp\\left(-\\mathrm{i}\\,\\frac{2\\pi j k}{N}\\right) + \\frac{1}{\\sqrt{N}}\\sum_{j=0}^{N-1}v_{j-1}\\exp\\left(-\\mathrm{i}\\,\\frac{2\\pi j k}{N}\\right) \\right]\n$$\nThe second term in the bracket is, by definition, $-2\\widehat{v}(k)$. For the first term, we use a change of index $m=j+1$. Due to the periodic boundary conditions ($v_{N}=v_{0}$), the summation over $j \\in \\{0, \\dots, N-1\\}$ is equivalent to a summation over $m \\in \\{0, \\dots, N-1\\}$.\n$$\n\\sum_{j=0}^{N-1}v_{j+1}\\exp\\left(-\\mathrm{i}\\,\\frac{2\\pi j k}{N}\\right) = \\sum_{m=0}^{N-1}v_{m}\\exp\\left(-\\mathrm{i}\\,\\frac{2\\pi (m-1) k}{N}\\right) = \\exp\\left(\\mathrm{i}\\,\\frac{2\\pi k}{N}\\right) \\sum_{m=0}^{N-1}v_{m}\\exp\\left(-\\mathrm{i}\\,\\frac{2\\pi m k}{N}\\right)\n$$\nThis result is $\\exp(\\mathrm{i}\\,\\frac{2\\pi k}{N})\\sqrt{N}\\widehat{v}(k)$. Similarly, the third term involving $v_{j-1}$ yields $\\exp(-\\mathrm{i}\\,\\frac{2\\pi k}{N})\\sqrt{N}\\widehat{v}(k)$. Substituting these back gives:\n$$\n\\widehat{(\\Delta_{h}v)}(k) = \\frac{1}{h^{2}} \\left[ \\exp\\left(\\mathrm{i}\\,\\frac{2\\pi k}{N}\\right) - 2 + \\exp\\left(-\\mathrm{i}\\,\\frac{2\\pi k}{N}\\right) \\right] \\widehat{v}(k)\n$$\nFrom the definition of the Fourier symbol, we identify $\\sigma_{\\Delta_{h}}(k)$:\n$$\n\\sigma_{\\Delta_{h}}(k) = \\frac{1}{h^{2}} \\left[ \\exp\\left(\\mathrm{i}\\,\\frac{2\\pi k}{N}\\right) + \\exp\\left(-\\mathrm{i}\\,\\frac{2\\pi k}{N}\\right) - 2 \\right]\n$$\nUsing the Euler identity $2\\cos\\theta = e^{\\mathrm{i}\\theta} + e^{-\\mathrm{i}\\theta}$ and the half-angle identity $2\\cos\\theta - 2 = -4\\sin^2(\\theta/2)$, with $\\theta = \\frac{2\\pi k}{N}$:\n$$\n\\sigma_{\\Delta_{h}}(k) = \\frac{2}{h^{2}} \\left( \\cos\\left(\\frac{2\\pi k}{N}\\right) - 1 \\right) = -\\frac{4}{h^{2}}\\sin^{2}\\left(\\frac{\\pi k}{N}\\right)\n$$\n\nSecond, we determine the per-mode amplification factor $G(k)$. We apply the DFT to the explicit forward Euler scheme:\n$$\nu_{j}^{n+1}=u_{j}^{n}+\\nu\\,\\Delta t\\,(\\Delta_{h}u^{n})_{j}\n$$\n$$\n\\widehat{u^{n+1}}(k) = \\widehat{u^{n}}(k) + \\nu\\,\\Delta t\\,\\widehat{(\\Delta_{h}u^{n})}(k)\n$$\nUsing the definition of the Fourier symbol, $\\widehat{(\\Delta_{h}u^{n})}(k) = \\sigma_{\\Delta_{h}}(k)\\,\\widehat{u^{n}}(k)$:\n$$\n\\widehat{u^{n+1}}(k) = \\widehat{u^{n}}(k) + \\nu\\,\\Delta t\\,\\sigma_{\\Delta_{h}}(k)\\,\\widehat{u^{n}}(k) = \\left( 1 + \\nu\\,\\Delta t\\,\\sigma_{\\Delta_{h}}(k) \\right) \\widehat{u^{n}}(k)\n$$\nThe amplification factor $G(k)$ is the factor that multiplies the Fourier coefficient from one time step to the next, so $G(k) = \\frac{\\widehat{u^{n+1}}(k)}{\\widehat{u^{n}}(k)}$.\n$$\nG(k) = 1 + \\nu\\,\\Delta t\\,\\sigma_{\\Delta_{h}}(k) = 1 - \\frac{4\\nu\\,\\Delta t}{h^{2}}\\sin^{2}\\left(\\frac{\\pi k}{N}\\right)\n$$\n\nThird, we justify the stability condition. A numerical scheme is stable in the $\\ell^2$ norm if the $\\ell^2$ norm of the solution does not grow in time, i.e., $\\|u^{n+1}\\|_{\\ell^2} \\le \\|u^n\\|_{\\ell^2}$ for all $n \\ge 0$. Squaring both sides, this means $\\|u^{n+1}\\|_{\\ell^2}^2 \\le \\|u^n\\|_{\\ell^2}^2$, where $\\|v\\|_{\\ell^2}^2 = \\sum_{j=0}^{N-1}|v_j|^2$.\nBy the Parseval identity, $\\sum_{j=0}^{N-1}|v_j|^2 = \\sum_{k=0}^{N-1}|\\widehat{v}(k)|^2$. Applying this to our stability condition yields:\n$$\n\\sum_{k=0}^{N-1}|\\widehat{u^{n+1}}(k)|^2 \\le \\sum_{k=0}^{N-1}|\\widehat{u^{n}}(k)|^2\n$$\nSubstituting $\\widehat{u^{n+1}}(k) = G(k)\\widehat{u^{n}}(k)$:\n$$\n\\sum_{k=0}^{N-1}|G(k)\\widehat{u^{n}}(k)|^2 \\le \\sum_{k=0}^{N-1}|\\widehat{u^{n}}(k)|^2 \\quad \\implies \\quad \\sum_{k=0}^{N-1}|G(k)|^2 |\\widehat{u^{n}}(k)|^2 \\le \\sum_{k=0}^{N-1}|\\widehat{u^{n}}(k)|^2\n$$\nThis inequality must hold for any arbitrary solution $u^n$, and therefore for any set of Fourier coefficients $\\widehat{u^n}(k)$. This is guaranteed if $|G(k)|^2 \\le 1$ for every mode $k \\in \\{0, 1, \\dots, N-1\\}$. This is equivalent to the von Neumann stability condition $|G(k)| \\le 1$ for all $k$, or $\\sup_{k}|G(k)| \\le 1$.\n\nFinally, we use this condition to derive the constraint on $\\Delta t$. The condition is:\n$$\n\\left| 1 - \\frac{4\\nu\\,\\Delta t}{h^{2}}\\sin^{2}\\left(\\frac{\\pi k}{N}\\right) \\right| \\le 1\n$$\nThis single inequality is equivalent to the pair of inequalities:\n$$\n-1 \\le 1 - \\frac{4\\nu\\,\\Delta t}{h^{2}}\\sin^{2}\\left(\\frac{\\pi k}{N}\\right) \\le 1\n$$\nThe right-hand inequality, $1 - \\frac{4\\nu\\,\\Delta t}{h^{2}}\\sin^{2}(\\dots) \\le 1$, implies $-\\frac{4\\nu\\,\\Delta t}{h^{2}}\\sin^{2}(\\dots) \\le 0$. Since $\\nu  0$, $\\Delta t  0$, $h^2  0$, and $\\sin^2(\\cdot) \\ge 0$, this inequality is always satisfied.\nThe left-hand inequality provides the actual constraint:\n$$\n-1 \\le 1 - \\frac{4\\nu\\,\\Delta t}{h^{2}}\\sin^{2}\\left(\\frac{\\pi k}{N}\\right) \\quad \\implies \\quad \\frac{4\\nu\\,\\Delta t}{h^{2}}\\sin^{2}\\left(\\frac{\\pi k}{N}\\right) \\le 2\n$$\nThis condition must hold for all $k \\in \\{0, 1, \\dots, N-1\\}$. We must therefore enforce it for the value of $k$ that maximizes the left side of the inequality. This corresponds to the mode that maximizes $-\\sigma_{\\Delta_{h}}(k) = \\frac{4}{h^2}\\sin^2(\\frac{\\pi k}{N})$. The maximum of $\\sin^2(\\theta)$ is $1$, which occurs when $\\theta = \\frac{\\pi}{2} + m\\pi$ for any integer $m$. For the argument $\\frac{\\pi k}{N}$, we seek a value of $k$ in its range such that $\\frac{\\pi k}{N} = \\frac{\\pi}{2}$. This gives $k=N/2$. The problem states that $N$ is even, so $k=N/2$ is an integer and a valid mode index. This mode, known as the Nyquist frequency, corresponds to the highest spatial frequency representable on the grid. It is the \"worst-case\" mode because it is the least stable and thus imposes the most restrictive constraint on $\\Delta t$.\nAt $k=N/2$, we have $\\sin^2(\\frac{\\pi (N/2)}{N}) = \\sin^2(\\frac{\\pi}{2}) = 1$. The stability condition becomes:\n$$\n\\frac{4\\nu\\,\\Delta t}{h^{2}} \\cdot \\max_{k}\\left[\\sin^{2}\\left(\\frac{\\pi k}{N}\\right)\\right] \\le 2 \\quad \\implies \\quad \\frac{4\\nu\\,\\Delta t}{h^{2}} \\cdot 1 \\le 2\n$$\nSolving for $\\Delta t$:\n$$\n\\Delta t \\le \\frac{2h^2}{4\\nu} = \\frac{h^2}{2\\nu}\n$$\nThe largest admissible time step, $\\Delta t_{\\max}$, is the upper bound of this inequality.\n$$\n\\Delta t_{\\max} = \\frac{h^2}{2\\nu}\n$$\nThis is the well-known CFL (Courant-Friedrichs-Lewy) condition for the explicit Euler discretization of the one-dimensional heat equation.", "answer": "$$\\boxed{\\frac{h^2}{2\\nu}}$$", "id": "3429318"}, {"introduction": "While linear problems are elegantly handled by Fourier methods, nonlinearities introduce significant challenges. A product of two functions in physical space becomes a convolution in Fourier space, which, on a discrete grid, can lead to aliasing — the misrepresentation of high frequencies as low frequencies. This exercise [@problem_id:3429312] explores this critical issue, using a pseudospectral scheme for the inviscid Burgers' equation to show how aliasing can break the energy conservation properties of the underlying PDE and spuriously inject energy into the system, motivating the need for dealiasing techniques.", "problem": "Consider the inviscid Burgers equation $u_t + u u_x = 0$ on the periodic domain $[0,2\\pi]$. Let $N$ be an even positive integer, and define the grid $x_j = 2\\pi j/N$, $j=0,\\dots,N-1$. Denote the Discrete Fourier Transform (DFT) of a grid function $u(x_j)$ by $\\widehat{u}_k = \\frac{1}{N}\\sum_{j=0}^{N-1} u(x_j) e^{-i k x_j}$ for integer wavenumbers $k$ represented in the standard range $k \\in \\{-N/2, -N/2+1, \\dots, N/2-1\\}$. The discrete Parseval identity reads $\\frac{1}{N}\\sum_{j=0}^{N-1} \\overline{f(x_j)}\\, g(x_j) = \\sum_{k} \\overline{\\widehat{f}_k}\\, \\widehat{g}_k$. For pseudospectral evaluation of products, multiplication in physical space corresponds to discrete convolution in Fourier space modulo $N$: $\\widehat{f g}[k] = \\sum_{p+q \\equiv k \\, (\\mathrm{mod}\\, N)} \\widehat{f}_p\\, \\widehat{g}_q$. The spectral derivative is defined by $\\widehat{f_x}[k] = i k \\widehat{f}_k$ on the resolved set.\n\nLet $N=12$ and consider the initial data \n$$u(x,0) = A \\cos(2 x) + B \\sin(4 x),$$\nwith real amplitudes $A$ and $B$. A pseudospectral scheme for the nonlinear term $u u_x$ proceeds by:\n- computing $\\widehat{u}_k$,\n- forming $\\widehat{u_x}_k = i k \\widehat{u}_k$,\n- transforming back to physical space to get $u(x_j)$ and $u_x(x_j)$,\n- computing the pointwise product $u(x_j)\\, u_x(x_j)$,\n- taking the DFT to obtain $\\widehat{u u_x}_k$.\n\nNo dealiasing is applied.\n\nTask:\n1) Using the discrete convolution characterization above, determine which resolved Fourier mode receives an aliased contribution from the interaction of the $k=2$ and $k=4$ modes, and compute the resulting coefficient $\\widehat{u u_x}[k]$ at that mode as a function of $A$ and $B$.\n\n2) Starting from the discrete Parseval identity and the skew-adjointness of the continuous advective operator in conservative form, explain why computing $u u_x$ via physical-space multiplication and modulo-$N$ convolution can lead to spurious growth of high-mode energy, and identify the mechanism in terms of triad interactions and aliasing.\n\n3) Choose the option that correctly describes the high-mode behavior and a remedy consistent with the analysis.\n\nOptions:\nA. The unresolved interaction of $k=2$ and $k=4$ produces a mode at $k=6$ which aliases to the Nyquist mode $k=-6$ (since $6 \\equiv -6 \\, (\\mathrm{mod}\\, 12)$), yielding $\\widehat{u u_x}[-6] = 3 A B$ and injecting energy into the highest resolved mode. By discrete Parseval, the inner product $\\langle u, u u_x\\rangle_h$ fails to vanish because multiplication is evaluated via modulo-$N$ convolution, breaking the skew-adjoint energy balance; applying the two-thirds dealiasing rule or computing $(u^2)_x/2$ in Fourier space restores energy conservation.\n\nB. The aliasing sends the interaction to $k=2$ with $\\widehat{u u_x}[2] = - A B$, transferring energy to low modes; Parseval ensures energy conservation for pseudospectral multiplication, and dealiasing has no effect.\n\nC. The product $u u_x$ contains no contribution at $k=\\pm 6$ because both $k=2$ and $k=4$ are below the cutoff; as a result, the discrete energy is automatically conserved when using pseudospectral multiplication without dealiasing.\n\nD. Any spurious high-mode energy growth is solely caused by the time integrator; with exact time integration, the pseudospectral nonlinearity $u u_x$ is energy-conserving for all $N$ without dealiasing.", "solution": "We first compute the relevant Fourier coefficients and use the discrete convolution structure of pseudospectral multiplication.\n\nBy definition, for $u(x,0) = A \\cos(2 x) + B \\sin(4 x)$ we have the complex Fourier coefficients\n$$\\widehat{u}_2 = \\frac{A}{2}, \\quad \\widehat{u}_{-2} = \\frac{A}{2}, \\quad \\widehat{u}_4 = -\\frac{i B}{2}, \\quad \\widehat{u}_{-4} = \\frac{i B}{2},$$\nand all others are initially zero. The derivative in Fourier space is $\\widehat{u_x}_k = i k \\widehat{u}_k$, so\n$$\\widehat{u_x}_2 = i \\cdot 2 \\cdot \\frac{A}{2} = i A, \\quad \\widehat{u_x}_{-2} = i \\cdot (-2) \\cdot \\frac{A}{2} = - i A,$$\n$$\\widehat{u_x}_4 = i \\cdot 4 \\cdot \\left(-\\frac{i B}{2}\\right) = 2 B, \\quad \\widehat{u_x}_{-4} = i \\cdot (-4) \\cdot \\left(\\frac{i B}{2}\\right) = 2 B.$$\n\nPart 1: Identify the aliased mode and compute $\\widehat{u u_x}$ at that mode.\n\nMultiplication in physical space, followed by a DFT, corresponds to discrete convolution modulo $N$: for any $k$,\n$$\\widehat{u u_x}[k] = \\sum_{p+q \\equiv k \\, (\\mathrm{mod}\\, N)} \\widehat{u}_p\\, \\widehat{u_x}_q = \\sum_{p+q \\equiv k \\, (\\mathrm{mod}\\, 12)} \\widehat{u}_p\\, (i q\\, \\widehat{u}_q).$$\n\nThe interactions of interest are between the resolved low modes $k=2$ and $k=4$. In the continuous, their sum produces $k=6$, which is outside the principal positive range (with $N=12$ one has $k \\in \\{-6,-5,\\dots,5\\}$ and the Nyquist $k=-6$ is the unique representative of the frequency $|k|=6$). In the discrete modulo-$N$ convolution, the pair $p=2$ and $q=4$ contributes to the resolved mode $k \\equiv 2+4 \\equiv 6 \\equiv -6 \\, (\\mathrm{mod}\\, 12)$. Likewise, $p=4$ and $q=2$ contributes to $k \\equiv -6$. Negative-frequency pairs $p=-2, q=-4$ and $p=-4, q=-2$ also sum to $-6$ without wrapping. Collecting all contributions to $k=-6$ gives\n\n$$\n\\begin{aligned}\n\\widehat{u u_x}[-6] \n= \\widehat{u}_{-2}\\, \\widehat{u_x}_{-4} + \\widehat{u}_{-4}\\, \\widehat{u_x}_{-2} + \\widehat{u}_{2}\\, \\widehat{u_x}_{4} + \\widehat{u}_{4}\\, \\widehat{u_x}_{2} \\\\\n= \\left(\\frac{A}{2}\\right)\\left(2 B\\right) + \\left(\\frac{i B}{2}\\right)\\left(- i A\\right) + \\left(\\frac{A}{2}\\right)\\left(2 B\\right) + \\left(-\\frac{i B}{2}\\right)\\left(i A\\right) \\\\\n= A B + \\frac{A B}{2} + A B + \\frac{A B}{2} \\\\\n= 3 A B.\n\\end{aligned}\n$$\n\nThus, the aliased contribution is at the Nyquist mode $k=-6$ with $\\widehat{u u_x}[-6] = 3 A B$, a real coefficient corresponding to a cosine at frequency $6$ on the grid. In physical-space terms, using trigonometric identities,\n\n$$\n\\begin{aligned}\nu_x = -2 A \\sin(2 x) + 4 B \\cos(4 x), \\\\\nu u_x = A \\cos(2 x)\\cdot 4 B \\cos(4 x) + B \\sin(4 x)\\cdot (-2 A) \\sin(2 x) + \\text{(self-interactions at other frequencies)} \\\\\n= 3 A B \\cos(6 x) + A B \\cos(2 x) + \\text{(terms at } k=\\pm 4, \\pm 8).\n\\end{aligned}\n$$\n\nOn the $N=12$ grid, $\\cos(6 x_j)$ is precisely the Nyquist pattern and is representable by the single $k=-6$ coefficient, in agreement with $\\widehat{u u_x}[-6] = 3 A B$.\n\nPart 2: Spurious high-mode energy growth via Parseval and discrete convolution.\n\nIn the continuous problem, the nonlinear advection in conservative form, $\\frac{1}{2}(u^2)_x$, is skew-adjoint in the $L^2$ inner product on periodic domains, yielding the energy identity\n$$\\frac{d}{dt}\\left(\\frac{1}{2}\\|u\\|_{L^2}^2\\right) = \\left\\langle u, -u u_x \\right\\rangle = -\\frac{1}{2}\\left\\langle u, (u^2)_x \\right\\rangle = 0,$$\nbecause $\\int_0^{2\\pi} u(x) (u^2)_x(x)\\, dx = \\int_0^{2\\pi} \\frac{1}{2} (u^2(x))_x u(x)\\, dx = \\frac{1}{2}\\int_0^{2\\pi} (u^2(x))_x u(x)\\, dx$ reduces to a periodic boundary term that vanishes. In a dealiased spectral Galerkin discretization, the same cancellation holds at the discrete level: the projection of $(u^2)_x/2$ onto the resolved modes preserves the discrete $L^2$ energy.\n\nIn the pseudospectral setting without dealiasing, however, the pointwise product $u u_x$ on the grid corresponds in Fourier space to convolution modulo $N$, which folds unresolved sums $p+q$ back into the resolved set. The delicate skew-adjoint structure responsible for energy conservation is broken by this folding: the anti-symmetric pairing of triads in the exact convolution (which would send interactions to $k=6$, here outside the resolved set) is replaced by aliased interactions populating the Nyquist mode $k=-6$. By the discrete Parseval identity,\n$$\\frac{d}{dt}\\left(\\frac{1}{2}\\|u\\|_{h}^2\\right) = \\left\\langle u, -u u_x \\right\\rangle_h = -\\sum_{k} \\overline{\\widehat{u}_k}\\, \\widehat{u u_x}_k,$$\nand the modulo-$N$ convolution generically yields $\\sum_k \\overline{\\widehat{u}_k}\\, \\widehat{u u_x}_k \\neq 0$ because $\\widehat{u u_x}_k$ contains aliased contributions that are not balanced by the conservative projection of $(u^2)_x/2$. In our specific scenario, even though $\\widehat{u}_{-6}(0)=0$, the evolution equation in Fourier space,\n$$\\frac{d}{dt}\\widehat{u}_k = - \\widehat{u u_x}_k,$$\nimplies that the Nyquist mode satisfies $\\frac{d}{dt}\\widehat{u}_{-6} = - 3 A B \\neq 0$, so energy is injected into the highest resolved mode. This is spurious: in the true Galerkin projection, the interaction of $k=2$ and $k=4$ would produce only $k=6$, which lies outside and would be discarded rather than folded onto $k=-6$.\n\nThe mechanism is therefore discrete aliasing of triad interactions under modulo-$N$ convolution in the pseudospectral product, combined with loss of the conservative skew-symmetric form in the discretization of the nonlinear term. Remedies include:\n- dealiasing by zeroing out modes beyond the two-thirds rule prior to multiplication (or padding to $3N/2$), which prevents unresolved sums from folding into the resolved set, and\n- computing the nonlinear term in conservative form, e.g., via $\\frac{1}{2}(u^2)_x$ entirely in Fourier space (or in a skew-symmetric split form), which restores discrete energy conservation.\n\nPart 3: Option-by-option analysis.\n\nOption A: It correctly identifies that the interaction $2+4=6$ aliases to the Nyquist $k=-6$ for $N=12$. The computed coefficient $\\widehat{u u_x}[-6] = 3 A B$ matches the convolution calculation above. It correctly explains that discrete Parseval with modulo-$N$ convolution breaks the skew-adjoint energy balance, leading to spurious injection into the highest mode, and cites standard remedies (two-thirds dealiasing or conservative $(u^2)_x/2$ evaluation). Verdict: Correct.\n\nOption B: It asserts aliasing sends energy to $k=2$ with $\\widehat{u u_x}[2] = -A B$, which is not supported by the convolution analysis; the dominant aliased high-frequency contribution is at $k=-6$, not $k=2$. It also incorrectly claims that Parseval ensures energy conservation for pseudospectral multiplication without dealiasing; in fact, aliasing breaks the energy balance. Verdict: Incorrect.\n\nOption C: It claims no contributions at $k=\\pm 6$ because $2$ and $4$ are below the cutoff. This ignores the creation of the sum frequency $6$ by the nonlinearity and its aliasing to the Nyquist mode $k=-6$ under modulo-$N$ convolution. It also incorrectly states that energy is automatically conserved. Verdict: Incorrect.\n\nOption D: It attributes spurious growth solely to time integration and claims energy conservation for pseudospectral $u u_x$ irrespective of dealiasing. The growth mechanism arises even at the semi-discrete level (ODEs for Fourier coefficients) from aliasing; exact time integration does not remove it. Verdict: Incorrect.", "answer": "$$\\boxed{A}$$", "id": "3429312"}]}