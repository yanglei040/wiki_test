{"hands_on_practices": [{"introduction": "This exercise introduces the concept of the effective numerical wavenumber, $\\tilde{k}(\\theta)$, which serves as the spectral \"fingerprint\" of a finite difference operator. By deriving this quantity for the standard second-order central difference scheme, you will uncover the fundamental source of numerical dispersion. The subsequent Taylor series expansion [@problem_id:3363559] will reveal precisely how the scheme deviates from the exact derivative for long wavelengths, providing a foundational tool for error analysis.", "problem": "Consider the linear advection partial differential equation (PDE) $u_{t} + a\\,u_{x} = 0$ with constant wave speed $a \\in \\mathbb{R}$ on a uniform grid $x_{j} = j\\,\\Delta x$ where $\\Delta x  0$ and $j \\in \\mathbb{Z}$. The spatial derivative $u_{x}$ is approximated by the second-order central difference operator\n$$\n\\left(D_{0} u\\right)_{j} \\equiv \\frac{u_{j+1} - u_{j-1}}{2\\,\\Delta x}.\n$$\nAssume a discrete Fourier mode $u_{j}(t) = \\hat{u}(t)\\,\\exp(i\\,j\\,\\theta)$ with nondimensional grid wavenumber $\\theta \\in [-\\pi,\\pi]$. Define the effective numerical wavenumber $\\tilde{k}(\\theta)$ by the relation $D_{0} u_{j} = i\\,\\tilde{k}(\\theta)\\,u_{j}$, so that the exact wavenumber is $k = \\theta / \\Delta x$. Using this framework:\n- Derive the exact expression for $\\tilde{k}(\\theta)$ associated with the second-order central difference.\n- Perform a Taylor expansion of $\\tilde{k}(\\theta)$ in powers of $\\theta$ about $\\theta = 0$ up to and including the term of order $\\theta^{3}$, and thereby identify the leading dispersion contribution to $\\tilde{k}(\\theta)$ relative to $k$.\n\nProvide as your final answer the truncated series for $\\tilde{k}(\\theta)$ up to and including the $\\theta^{3}$ term. No rounding is required. Express your answer as a function of $\\theta$ and $\\Delta x$ with no units. Angle is in radians.", "solution": "The problem requires the derivation and subsequent Taylor series expansion of the effective numerical wavenumber $\\tilde{k}(\\theta)$ for a second-order central difference approximation to the spatial derivative $u_x$.\n\nFirst, we derive the expression for $\\tilde{k}(\\theta)$. The problem states that the spatial derivative $u_x$ in the advection equation $u_t + a u_x = 0$ is approximated by the second-order central difference operator $(D_0 u)_j$, defined as:\n$$\n(D_0 u)_j = \\frac{u_{j+1} - u_{j-1}}{2\\,\\Delta x}\n$$\nWe analyze the action of this operator on a single discrete Fourier mode, $u_j(t) = \\hat{u}(t)\\,\\exp(i\\,j\\,\\theta)$. Here, $j$ is the grid index, $\\theta$ is the nondimensional grid wavenumber, $i = \\sqrt{-1}$, and $\\hat{u}(t)$ is the time-dependent amplitude of the mode.\n\nSubstituting the Fourier mode expression for $u_j$ into the difference operator formula, we get:\n$$\n(D_0 u)_j = \\frac{\\hat{u}(t)\\,\\exp(i\\,(j+1)\\,\\theta) - \\hat{u}(t)\\,\\exp(i\\,(j-1)\\,\\theta)}{2\\,\\Delta x}\n$$\nWe can factor out the common term $\\hat{u}(t)\\,\\exp(i\\,j\\,\\theta)$, which is equal to $u_j(t)$:\n$$\n(D_0 u)_j = \\frac{\\hat{u}(t)\\,\\exp(i\\,j\\,\\theta) \\left( \\exp(i\\,\\theta) - \\exp(-i\\,\\theta) \\right)}{2\\,\\Delta x} = u_j(t) \\frac{\\exp(i\\,\\theta) - \\exp(-i\\,\\theta)}{2\\,\\Delta x}\n$$\nUsing Euler's formula, $\\sin(\\theta) = \\frac{\\exp(i\\,\\theta) - \\exp(-i\\,\\theta)}{2i}$, we can rewrite the term in the numerator as $2i\\,\\sin(\\theta)$. Substituting this back gives:\n$$\n(D_0 u)_j = u_j(t) \\frac{2i\\,\\sin(\\theta)}{2\\,\\Delta x} = i\\,\\frac{\\sin(\\theta)}{\\Delta x}\\,u_j(t)\n$$\nThe problem defines the effective numerical wavenumber $\\tilde{k}(\\theta)$ through the relation $D_0 u_j = i\\,\\tilde{k}(\\theta)\\,u_j$. By comparing this definition with the result we just derived, we can identify the expression for $\\tilde{k}(\\theta)$:\n$$\ni\\,\\tilde{k}(\\theta)\\,u_j = i\\,\\frac{\\sin(\\theta)}{\\Delta x}\\,u_j\n$$\nThis directly yields the exact expression for the numerical wavenumber for the second-order central difference scheme:\n$$\n\\tilde{k}(\\theta) = \\frac{\\sin(\\theta)}{\\Delta x}\n$$\nNext, we perform a Taylor expansion of $\\tilde{k}(\\theta)$ in powers of $\\theta$ about $\\theta=0$. The Maclaurin series for the sine function is:\n$$\n\\sin(\\theta) = \\theta - \\frac{\\theta^3}{3!} + \\frac{\\theta^5}{5!} - \\dots = \\theta - \\frac{\\theta^3}{6} + \\mathcal{O}(\\theta^5)\n$$\nSubstituting this series into our expression for $\\tilde{k}(\\theta)$:\n$$\n\\tilde{k}(\\theta) = \\frac{1}{\\Delta x} \\left( \\theta - \\frac{\\theta^3}{6} + \\mathcal{O}(\\theta^5) \\right)\n$$\nTruncating this expansion to include terms up to and including the order $\\theta^3$, we obtain:\n$$\n\\tilde{k}(\\theta) \\approx \\frac{\\theta}{\\Delta x} - \\frac{\\theta^3}{6\\,\\Delta x}\n$$\nThe exact wavenumber for a continuous Fourier mode $\\exp(ikx)$ is $k$. For the discrete mode, the correspondence is $k = \\theta/\\Delta x$. The first term of the expansion, $\\frac{\\theta}{\\Delta x}$, exactly matches the true wavenumber $k$. The second term, $-\\frac{\\theta^3}{6\\,\\Delta x}$, is the leading-order error term. This term is responsible for numerical dispersion, as it causes the wave propagation speed to depend on the wavenumber. This completes the derivation.", "answer": "$$ \\boxed{\\frac{\\theta}{\\Delta x} - \\frac{\\theta^3}{6\\,\\Delta x}} $$", "id": "3363559"}, {"introduction": "Building on the concept of the numerical wavenumber, this practice shifts the focus to a more physical quantity: the numerical phase velocity. You will derive how the speed of a numerical wave depends on its wavelength and discover a critical pathology of centered schemes: poorly resolved, high-frequency waves barely move at all. Understanding this behavior [@problem_id:3363508] is essential for diagnosing the spurious oscillations that plague simulations of shocks and other sharp features.", "problem": "Consider the one-dimensional linear advection Partial Differential Equation (PDE) $u_{t} + a\\,u_{x} = 0$ with constant wavespeed $a  0$. Let the spatial domain be discretized on a uniform grid $x_{j} = j\\,\\Delta x$ with grid index $j \\in \\mathbb{Z}$ and grid spacing $\\Delta x  0$. Discretize the spatial derivative using the second-order centered difference, so that the semi-discrete scheme reads\n$$\n\\frac{d u_{j}(t)}{d t} + a\\,\\frac{u_{j+1}(t) - u_{j-1}(t)}{2\\,\\Delta x} = 0.\n$$\nAssume exact time integration of this semi-discrete system so that the scheme introduces no numerical dissipation. Perform a discrete Fourier (von Neumann) analysis by seeking solutions of the form $u_{j}(t) = \\hat{u}\\,\\exp\\!\\left(i\\,(j\\,\\theta - \\omega\\,t)\\right)$, where $\\hat{u} \\in \\mathbb{C}$ is a constant amplitude, $\\theta \\in [0,\\pi]$ is the nondimensional wavenumber in radians, and $\\omega \\in \\mathbb{R}$ is the angular frequency.\n\nStarting from these definitions and the semi-discrete scheme, derive the dispersion relation and hence the numerical phase velocity $v_{p}^{\\mathrm{num}}(\\theta) = \\omega/k$ as a closed-form analytic expression in terms of $a$ and $\\theta$, where $k = \\theta/\\Delta x$ is the physical wavenumber. Then, using your expression, explain why modes with $\\theta$ near $\\pi$ are severely under-resolved and exhibit nearly zero numerical phase velocity, and discuss the physical implications of such behavior for shock-capturing contexts where high-wavenumber content is generated.\n\nYour final answer must be the single closed-form expression for $v_{p}^{\\mathrm{num}}(\\theta)$ in terms of $a$ and $\\theta$ (with $\\theta$ measured in radians). No numerical rounding is required. Provide your qualitative discussion in your solution, but ensure the final boxed answer contains only the requested analytic expression.", "solution": "The semi-discrete scheme is given by:\n$$\n\\frac{d u_{j}(t)}{d t} + a\\,\\frac{u_{j+1}(t) - u_{j-1}(t)}{2\\,\\Delta x} = 0\n$$\nWe perform a discrete Fourier analysis by substituting the modal solution $u_{j}(t) = \\hat{u}\\,\\exp(i\\,(j\\,\\theta - \\omega\\,t))$ into the scheme. First, we compute the necessary terms. The time derivative is:\n$$\n\\frac{d u_{j}(t)}{d t} = \\frac{d}{dt} \\left[ \\hat{u}\\,\\exp(i\\,(j\\,\\theta - \\omega\\,t)) \\right] = -i\\,\\omega\\,\\hat{u}\\,\\exp(i\\,(j\\,\\theta - \\omega\\,t)) = -i\\,\\omega\\,u_{j}(t)\n$$\nThe spatially shifted terms are:\n$$\nu_{j+1}(t) = \\hat{u}\\,\\exp(i\\,((j+1)\\,\\theta - \\omega\\,t)) = \\hat{u}\\,\\exp(i\\,(j\\,\\theta - \\omega\\,t))\\,\\exp(i\\,\\theta) = u_{j}(t)\\,\\exp(i\\,\\theta)\n$$\n$$\nu_{j-1}(t) = \\hat{u}\\,\\exp(i\\,((j-1)\\,\\theta - \\omega\\,t)) = \\hat{u}\\,\\exp(i\\,(j\\,\\theta - \\omega\\,t))\\,\\exp(-i\\,\\theta) = u_{j}(t)\\,\\exp(-i\\,\\theta)\n$$\nSubstituting these expressions into the semi-discrete equation yields:\n$$\n-i\\,\\omega\\,u_{j}(t) + a\\,\\frac{u_{j}(t)\\,\\exp(i\\,\\theta) - u_{j}(t)\\,\\exp(-i\\,\\theta)}{2\\,\\Delta x} = 0\n$$\nFor a non-trivial solution, we require $u_{j}(t) \\neq 0$, so we can divide the entire equation by $u_{j}(t)$:\n$$\n-i\\,\\omega + \\frac{a}{2\\,\\Delta x} \\left( \\exp(i\\,\\theta) - \\exp(-i\\,\\theta) \\right) = 0\n$$\nUsing Euler's identity, $\\sin(\\theta) = \\frac{\\exp(i\\,\\theta) - \\exp(-i\\,\\theta)}{2i}$, we can rewrite the term in the parentheses as $2i\\,\\sin(\\theta)$. The equation becomes:\n$$\n-i\\,\\omega + \\frac{a}{2\\,\\Delta x} (2i\\,\\sin(\\theta)) = 0\n$$\n$$\n-i\\,\\omega + \\frac{i\\,a\\,\\sin(\\theta)}{\\Delta x} = 0\n$$\nSolving for the numerical frequency $\\omega$ gives the dispersion relation for the semi-discrete scheme:\n$$\n\\omega = \\frac{a\\,\\sin(\\theta)}{\\Delta x}\n$$\nThe problem defines the numerical phase velocity as $v_{p}^{\\mathrm{num}}(\\theta) = \\omega/k$, where the physical wavenumber is $k = \\theta/\\Delta x$. Substituting the expressions for $\\omega$ and $k$:\n$$\nv_{p}^{\\mathrm{num}}(\\theta) = \\frac{\\omega}{k} = \\frac{\\frac{a\\,\\sin(\\theta)}{\\Delta x}}{\\frac{\\theta}{\\Delta x}}\n$$\nSimplifying this expression by canceling the $\\Delta x$ terms gives the final closed-form expression for the numerical phase velocity:\n$$\nv_{p}^{\\mathrm{num}}(\\theta) = a\\,\\frac{\\sin(\\theta)}{\\theta}\n$$\nFor the exact PDE, $u_t + a u_x = 0$, the exact phase velocity is $a$ for all wavenumbers. The factor $\\frac{\\sin(\\theta)}{\\theta}$ represents the numerical phase error.\n\nWe now analyze the behavior for modes with $\\theta$ near $\\pi$. The nondimensional wavenumber $\\theta = k\\,\\Delta x = \\frac{2\\pi \\Delta x}{\\lambda}$, where $\\lambda$ is the wavelength. The range $\\theta \\in [0, \\pi]$ corresponds to wavelengths $\\lambda \\in [2\\Delta x, \\infty)$. Therefore, $\\theta = \\pi$ corresponds to the shortest wavelength resolvable on the grid, $\\lambda = 2\\Delta x$, which is known as the $2\\Delta x$ wave.\n\nAs $\\theta$ approaches $\\pi$, the numerical phase velocity behaves as:\n$$\n\\lim_{\\theta \\to \\pi} v_{p}^{\\mathrm{num}}(\\theta) = \\lim_{\\theta \\to \\pi} a\\,\\frac{\\sin(\\theta)}{\\theta} = a\\,\\frac{\\sin(\\pi)}{\\pi} = a\\,\\frac{0}{\\pi} = 0\n$$\nThis result demonstrates that modes with wavenumbers at or near the grid cutoff frequency ($\\theta = \\pi$) have a numerical phase velocity that approaches zero. These high-frequency components are thus severely under-resolved by the second-order centered difference scheme; they become nearly stationary and do not propagate with the correct speed $a$.\n\nThe physical implications of this behavior are particularly severe in shock-capturing contexts. Shocks and other discontinuities are characterized by a broad spectrum of Fourier modes, including very high-wavenumber content. When such features are present in the solution being computed:\n$1$. The high-wavenumber components generated by the sharp gradient are not propagated correctly by the scheme. They travel at a much lower velocity than the main wave front.\n$2$. This discrepancy in propagation speeds causes these high-frequency components to lag behind the shock, manifesting as spurious, non-physical oscillations, often called \"wiggles\" or Gibbs phenomena.\n$3$. Since the scheme is purely dispersive and introduces no numerical dissipation (as per the problem's premise of exact time integration), the energy in these spurious modes is not damped. Instead, it pollutes the solution domain, degrading the accuracy and physical realism of the simulation. This is a primary reason why simple centered-difference schemes are inadequate for simulating problems with shocks unless they are augmented with artificial dissipation or specialized filtering techniques designed to control or eliminate high-frequency oscillations.", "answer": "$$\\boxed{a\\,\\frac{\\sin(\\theta)}{\\theta}}$$", "id": "3363508"}, {"introduction": "Realistic simulations require discretizing both space and time, and their respective errors interact in non-trivial ways. This advanced exercise guides you through the complete analysis of a fully discrete scheme, combining a second-order spatial stencil with a third-order Runge-Kutta time integrator. By deriving the combined phase error and using it to determine resolution requirements [@problem_id:3363540], you will learn how to perform a quantitative analysis that is crucial for predicting and ensuring the accuracy of complex scientific computations.", "problem": "Consider the linear advection partial differential equation $u_{t} + a\\,u_{x} = 0$ on the infinite line, with constant wave speed $a \\neq 0$. Discretize space on a uniform grid $x_{j} = j h$ with mesh width $h  0$ using the second-order centered difference $D_{c}^{(2)} u_{j} = \\left(u_{j+1} - u_{j-1}\\right)/(2h)$. Advance in time with the classical third-order explicit Runge–Kutta method (Runge–Kutta (RK) of order three) defined by the three-stage update\n$$\n\\begin{aligned}\nu^{(1)} = u^{n} + \\Delta t\\,L(u^{n}),\\\\\nu^{(2)} = \\tfrac{3}{4}\\,u^{n} + \\tfrac{1}{4}\\Big(u^{(1)} + \\Delta t\\,L(u^{(1)})\\Big),\\\\\nu^{n+1} = \\tfrac{1}{3}\\,u^{n} + \\tfrac{2}{3}\\Big(u^{(2)} + \\Delta t\\,L(u^{(2)})\\Big),\n\\end{aligned}\n$$\napplied to the semi-discrete system $u_{t} = L(u)$ obtained by replacing $u_{x}$ with $D_{c}^{(2)}u$. Let the Courant number be $\\lambda = a\\,\\Delta t/h$. For a discrete Fourier mode of nondimensional wavenumber $\\theta = k h$ (with $k$ the continuous wavenumber), define the one-step numerical phase advance $\\Phi_{\\text{num}}(\\theta,\\lambda)$ by the argument of the mode amplification factor, and define the exact phase advance over one time step as $\\Phi_{\\text{exact}}(\\theta,\\lambda) = \\lambda\\,\\theta$. The relative phase velocity error for wavenumber $\\theta$ is\n$$\n\\delta(\\theta,\\lambda) \\equiv \\left|\\frac{\\Phi_{\\text{num}}(\\theta,\\lambda)}{\\Phi_{\\text{exact}}(\\theta,\\lambda)} - 1\\right|.\n$$\nAll angles are in radians.\n\nUsing only first principles of Fourier (von Neumann) analysis, derive the small-$\\theta$ asymptotic expansion of $\\delta(\\theta,\\lambda)$ up to and including the first two nonzero terms, and then determine the smallest spatial resolution parameter $P = P(\\lambda)$ such that $\\delta(\\theta,\\lambda)  0.01$ for every wavenumber satisfying $0  \\theta \\le \\pi/P$. Express your final $P(\\lambda)$ in a single closed-form analytic expression that depends on $\\lambda$, using the $0.01$ tolerance exactly as the rational number $1/100$. No rounding is required, and no units should be included in the final expression.", "solution": "The problem asks for an analysis of the relative phase velocity error of a numerical scheme for the linear advection equation $u_t + a u_x = 0$. The scheme combines a second-order centered difference in space with a third-order Runge-Kutta method in time.\n\nThe solution proceeds in four main steps:\n1.  Derive the amplification factor of the fully discrete scheme using Fourier analysis.\n2.  From the amplification factor, find the numerical phase advance $\\Phi_{\\text{num}}(\\theta, \\lambda)$.\n3.  Derive the required small-$\\theta$ asymptotic expansion for the relative phase velocity error $\\delta(\\theta, \\lambda)$.\n4.  Use this expansion to solve for the spatial resolution parameter $P(\\lambda)$.\n\n**Step 1: Derivation of the Amplification Factor**\n\nWe begin with the semi-discretization of the PDE $u_t = -a u_x$. Replacing the spatial derivative $u_x$ with the second-order centered difference operator $D_c^{(2)}$ at grid point $x_j=jh$ gives the system of ordinary differential equations (ODEs):\n$$\n\\frac{d u_j}{dt} = -a \\frac{u_{j+1} - u_{j-1}}{2h}\n$$\nWe apply Fourier analysis by considering a single Fourier mode $u_j(t) = \\hat{u}(t) \\exp(i k x_j)$, where $k$ is the wavenumber. Introducing the non-dimensional wavenumber $\\theta = k h$, we have $u_j(t) = \\hat{u}(t) \\exp(i j \\theta)$. Substituting this into the semi-discrete equation:\n$$\n\\frac{d}{dt} \\left(\\hat{u}(t) \\exp(i j \\theta)\\right) = -\\frac{a}{2h} \\left(\\hat{u}(t) \\exp(i (j+1) \\theta) - \\hat{u}(t) \\exp(i (j-1) \\theta)\\right)\n$$\n$$\n\\exp(i j \\theta) \\frac{d\\hat{u}}{dt} = -\\frac{a \\hat{u}}{2h} \\exp(i j \\theta) \\left(\\exp(i \\theta) - \\exp(-i \\theta)\\right)\n$$\nUsing Euler's formula $\\exp(i\\theta) - \\exp(-i\\theta) = 2i\\sin\\theta$, we simplify the equation for the modal amplitude $\\hat{u}(t)$:\n$$\n\\frac{d\\hat{u}}{dt} = -\\frac{a \\hat{u}}{2h} (2i\\sin\\theta) = \\left(-i \\frac{a}{h} \\sin\\theta\\right) \\hat{u}(t)\n$$\nThis is an ODE of the form $\\frac{d\\hat{u}}{dt} = L_h \\hat{u}$, where $L_h = -i \\frac{a}{h} \\sin\\theta$ is the Fourier symbol of the semi-discrete operator.\n\nThe problem specifies time-stepping with a third-order Runge-Kutta (RK3) method. For a general ODE system $u_t = L(u)$, the given RK3 method updates the solution from time $t^n$ to $t^{n+1}=t^n+\\Delta t$. In Fourier space, this corresponds to $\\hat{u}^{n+1} = g(z) \\hat{u}^n$, where $z = L_h \\Delta t$ and $g(z)$ is the stability polynomial of the RK3 method.\nLet's find $g(z)$. The stages are:\n$u^{(1)} = (I + \\Delta t L)u^n \\implies \\hat{u}^{(1)} = (1+z)\\hat{u}^n$\n$u^{(2)} = \\frac{3}{4}u^n + \\frac{1}{4}(I+\\Delta t L)u^{(1)} \\implies \\hat{u}^{(2)} = \\left(\\frac{3}{4} + \\frac{1}{4}(1+z)^2\\right)\\hat{u}^n = \\left(1 + \\frac{z}{2} + \\frac{z^2}{4}\\right)\\hat{u}^n$\n$u^{n+1} = \\frac{1}{3}u^n + \\frac{2}{3}(I+\\Delta t L)u^{(2)} \\implies \\hat{u}^{n+1} = \\left(\\frac{1}{3} + \\frac{2}{3}(1+z)\\left(1 + \\frac{z}{2} + \\frac{z^2}{4}\\right)\\right)\\hat{u}^n$\nThe polynomial is $g(z) = \\frac{1}{3} + \\frac{2}{3}(1 + \\frac{3}{2}z + \\frac{3}{4}z^2 + \\frac{1}{4}z^3) = 1 + z + \\frac{1}{2}z^2 + \\frac{1}{6}z^3$.\nThe argument $z$ is given by:\n$$\nz = L_h \\Delta t = \\left(-i \\frac{a}{h} \\sin\\theta\\right) \\Delta t = -i \\frac{a \\Delta t}{h} \\sin\\theta = -i \\lambda \\sin\\theta\n$$\nwhere $\\lambda = a \\Delta t / h$ is the Courant number. The amplification factor is $g(-i\\lambda\\sin\\theta)$.\n\n**Step 2: Numerical Phase Advance**\n\nThe evolution of a Fourier mode over one time step is $\\hat{u}^{n+1} = g(z) \\hat{u}^n$. The argument of the complex amplification factor $g(z)$ gives the phase shift. The problem defines the numerical phase advance $\\Phi_{\\text{num}}(\\theta, \\lambda)$ as this argument. For a propagating wave, it is more natural to consider the phase lag; a common convention defines the numerical phase as the negative of the argument. Let us be precise: the exact solution to $u_t+au_x=0$ is $u(x,t)=f(x-at)$. A mode $\\exp(ikx)$ evolves to $\\exp(ik(x-a\\Delta t)) = \\exp(-ika\\Delta t)\\exp(ikx)$. The exact amplification factor is $\\exp(-ika\\Delta t) = \\exp(-i\\lambda\\theta)$, with argument $-\\lambda\\theta$. The problem defines the exact phase advance as $\\Phi_{\\text{exact}}(\\theta, \\lambda) = \\lambda\\theta$. This implies an assumed sign convention, where $\\Phi = - \\arg(g)$.\nThus, $\\Phi_{\\text{num}}(\\theta, \\lambda) = -\\arg(g(-i\\lambda\\sin\\theta))$.\nLet $\\alpha = \\lambda\\sin\\theta$. Then $z = -i\\alpha$.\n$g(-i\\alpha) = 1 - i\\alpha + \\frac{1}{2}(-i\\alpha)^2 + \\frac{1}{6}(-i\\alpha)^3 = \\left(1 - \\frac{\\alpha^2}{2}\\right) - i\\left(\\alpha - \\frac{\\alpha^3}{6}\\right)$.\nThe argument is $\\arg(g(-i\\alpha)) = \\arctan\\left(\\frac{-(\\alpha - \\alpha^3/6)}{1 - \\alpha^2/2}\\right) = -\\arctan\\left(\\frac{\\alpha - \\alpha^3/6}{1 - \\alpha^2/2}\\right)$.\nSo, the numerical phase advance is:\n$$\n\\Phi_{\\text{num}}(\\theta, \\lambda) = \\arctan\\left(\\frac{\\lambda\\sin\\theta - \\frac{1}{6}(\\lambda\\sin\\theta)^3}{1 - \\frac{1}{2}(\\lambda\\sin\\theta)^2}\\right)\n$$\n\n**Step 3: Asymptotic Expansion of the Relative Phase Velocity Error**\n\nThe relative phase velocity error is $\\delta(\\theta,\\lambda) = \\left|\\frac{\\Phi_{\\text{num}}(\\theta,\\lambda)}{\\Phi_{\\text{exact}}(\\theta,\\lambda)} - 1\\right|$. The ratio of numerical to exact phase velocity is $\\frac{v_{num}}{v_{exact}} = \\frac{\\Phi_{\\text{num}}}{\\Phi_{\\text{exact}}}$. This ratio can be factorized into spatial and temporal contributions:\n$$\n\\frac{\\Phi_{\\text{num}}}{\\Phi_{\\text{exact}}} = \\frac{-\\arg(g(-i\\lambda\\sin\\theta))}{\\lambda\\theta} = \\left(\\frac{-\\arg(g(-i\\lambda\\sin\\theta))}{\\lambda\\sin\\theta}\\right) \\left(\\frac{\\sin\\theta}{\\theta}\\right)\n$$\nThe term $\\frac{\\sin\\theta}{\\theta}$ represents the phase error from the spatial discretization (dispersion). The other term represents the phase error from the time integration.\nLet's find the small-$\\theta$ expansion for each factor.\nFor the spatial part:\n$$\n\\frac{\\sin\\theta}{\\theta} = 1 - \\frac{\\theta^2}{6} + \\frac{\\theta^4}{120} - O(\\theta^6)\n$$\nFor the temporal part, let $\\alpha = \\lambda\\sin\\theta$. We need the expansion of $\\frac{-\\arg(g(-i\\alpha))}{\\alpha} = \\frac{\\arctan\\left(\\frac{\\alpha-\\alpha^3/6}{1-\\alpha^2/2}\\right)}{\\alpha}$ for small $\\alpha$.\nLet $A = \\frac{\\alpha-\\alpha^3/6}{1-\\alpha^2/2} = \\alpha(1-\\alpha^2/6)(1+\\alpha^2/2+\\alpha^4/4+\\dots) = \\alpha(1+\\alpha^2/3+\\alpha^4/6+\\dots)$.\nUsing $\\arctan(A) = A - A^3/3 + A^5/5 - \\dots$:\n$\\arctan(A) = \\alpha(1+\\alpha^2/3+\\alpha^4/6) - \\frac{1}{3}(\\alpha(1+\\alpha^2/3))^3 + \\frac{1}{5}\\alpha^5 + O(\\alpha^7)$\n$= \\alpha + \\frac{\\alpha^3}{3} + \\frac{\\alpha^5}{6} - \\frac{\\alpha^3}{3}(1+\\alpha^2) + \\frac{\\alpha^5}{5} + O(\\alpha^7)$\n$= \\alpha + \\frac{\\alpha^5}{6} - \\frac{\\alpha^5}{3} + \\frac{\\alpha^5}{5} + O(\\alpha^7) = \\alpha + \\frac{5-10+6}{30}\\alpha^5 + O(\\alpha^7) = \\alpha + \\frac{\\alpha^5}{30} + O(\\alpha^7)$.\nSo, the temporal phase ratio is:\n$$\n\\frac{-\\arg(g(-i\\alpha))}{\\alpha} = 1 + \\frac{\\alpha^4}{30} + O(\\alpha^6)\n$$\nSubstituting $\\alpha = \\lambda\\sin\\theta = \\lambda(\\theta - O(\\theta^3))$, we have $\\alpha^4 = \\lambda^4 \\theta^4 + O(\\theta^6)$.\nThe temporal ratio becomes $1 + \\frac{\\lambda^4\\theta^4}{30} + O(\\theta^6)$.\nNow, we multiply the spatial and temporal expansions:\n$$\n\\frac{\\Phi_{\\text{num}}}{\\Phi_{\\text{exact}}} \\approx \\left(1 + \\frac{\\lambda^4\\theta^4}{30}\\right) \\left(1 - \\frac{\\theta^2}{6} + \\frac{\\theta^4}{120}\\right)\n$$\n$$\n= 1 - \\frac{\\theta^2}{6} + \\frac{\\theta^4}{120} + \\frac{\\lambda^4\\theta^4}{30} + O(\\theta^6) = 1 - \\frac{\\theta^2}{6} + \\left(\\frac{1}{120} + \\frac{4\\lambda^4}{120}\\right)\\theta^4 + O(\\theta^6)\n$$\nThe relative phase error is $\\frac{\\Phi_{\\text{num}}}{\\Phi_{\\text{exact}}} - 1 = -\\frac{\\theta^2}{6} + \\frac{1+4\\lambda^4}{120}\\theta^4 + O(\\theta^6)$.\nFor small $\\theta$, the first term dominates, so the expression is negative.\n$$\n\\delta(\\theta,\\lambda) = \\left| -\\frac{\\theta^2}{6} + \\frac{1+4\\lambda^4}{120}\\theta^4 + O(\\theta^6) \\right| = \\frac{\\theta^2}{6} - \\frac{1+4\\lambda^4}{120}\\theta^4 + O(\\theta^6)\n$$\nThis is the asymptotic expansion with the first two nonzero terms as requested.\n\n**Step 4: Calculation of the Resolution Parameter $P(\\lambda)$**\n\nWe need to find the smallest $P(\\lambda)$ such that $\\delta(\\theta,\\lambda)  0.01$ for $0  \\theta \\le \\pi/P$.\nThe function $\\delta(\\theta,\\lambda)$ increases from $0$ for small $\\theta$. Therefore, the condition is satisfied if it holds at the endpoint $\\theta_{max} = \\pi/P$. We seek the largest $\\theta_{max}$ such that $\\delta(\\theta_{max},\\lambda) \\le 1/100$. This leads to the equality:\n$$\n\\frac{\\theta_{max}^2}{6} - \\frac{1+4\\lambda^4}{120}\\theta_{max}^4 = \\frac{1}{100}\n$$\nLet $x = \\theta_{max}^2$. This is a quadratic equation in $x$:\n$$\n\\frac{1+4\\lambda^4}{120}x^2 - \\frac{1}{6}x + \\frac{1}{100} = 0\n$$\nTo simplify, multiply by $300$:\n$$\n300\\left(\\frac{1+4\\lambda^4}{120}\\right)x^2 - 300\\left(\\frac{1}{6}\\right)x + 300\\left(\\frac{1}{100}\\right) = 0\n$$\n$$\n\\frac{5}{2}(1+4\\lambda^4)x^2 - 50x + 3 = 0\n$$\nThe solutions for $x$ are given by the quadratic formula:\n$$\nx = \\frac{50 \\pm \\sqrt{(-50)^2 - 4\\left(\\frac{5}{2}(1+4\\lambda^4)\\right)(3)}}{2\\left(\\frac{5}{2}(1+4\\lambda^4)\\right)} = \\frac{50 \\pm \\sqrt{2500 - 30(1+4\\lambda^4)}}{5(1+4\\lambda^4)}\n$$\n$$\nx = \\frac{50 \\pm \\sqrt{2470 - 120\\lambda^4}}{5(1+4\\lambda^4)}\n$$\nSince we are using a small-$\\theta$ expansion, we must take the smaller root, which corresponds to the minus sign. This gives the maximum allowed value for $x = \\theta_{max}^2$.\n$$\n\\theta_{max}^2 = \\frac{50 - \\sqrt{2470 - 120\\lambda^4}}{5(1+4\\lambda^4)}\n$$\nThe problem defines $\\theta_{max} = \\pi/P$. Thus, $(\\pi/P)^2 = \\theta_{max}^2$.\n$$\nP^2 = \\frac{\\pi^2}{\\theta_{max}^2} = \\pi^2 \\frac{5(1+4\\lambda^4)}{50 - \\sqrt{2470 - 120\\lambda^4}}\n$$\nTaking the square root gives the final expression for $P(\\lambda)$:\n$$\nP(\\lambda) = \\pi \\sqrt{\\frac{5(1+4\\lambda^4)}{50 - \\sqrt{2470 - 120\\lambda^4}}}\n$$\nThis expression is valid for Courant numbers $\\lambda$ within the stability region of the scheme, for which the discriminant $2470 - 120\\lambda^4 \\ge 0$. The stability limit for this scheme is $|\\lambda| \\le \\sqrt{3}$, so $\\lambda^4 \\le 9$. For any such $\\lambda$, $120\\lambda^4 \\le 1080$, and the discriminant is positive.", "answer": "$$\\boxed{\\pi \\sqrt{\\frac{5(1+4\\lambda^4)}{50 - \\sqrt{2470 - 120\\lambda^4}}}}$$", "id": "3363540"}]}