{"hands_on_practices": [{"introduction": "Many physical systems involve processes with vastly different time scales, such as slow advection and fast diffusion. Implicit-Explicit (IMEX) methods are powerful tools for these scenarios, treating the non-stiff parts explicitly for efficiency and the stiff parts implicitly for stability. This first exercise [@problem_id:3406598] will guide you through a von Neumann stability analysis of a common IMEX scheme for the advection-diffusion equation. By deriving the stability condition, you will gain a quantitative understanding of how much implicit diffusion is required to stabilize an explicit advection step.", "problem": "Consider the linear advection-diffusion equation $u_{t} + a\\,u_{x} = \\nu\\,u_{xx}$ for a scalar field $u(x,t)$ on the periodic spatial domain $x \\in [0,L]$, with constant advection speed $a \\in \\mathbb{R}$ and diffusion coefficient $\\nu \\ge 0$. Let the spatial grid be uniform with spacing $h = L/N$ and grid points $x_{j} = jh$ for integers $j$, and consider discrete time levels $t^{n} = n\\,\\Delta t$. Define the second-order centered finite-difference operators\n- the first derivative $D_{0}u_{j}^{n} = \\dfrac{u_{j+1}^{n} - u_{j-1}^{n}}{2h}$,\n- the second derivative $D_{2}u_{j}^{n} = \\dfrac{u_{j+1}^{n} - 2u_{j}^{n} + u_{j-1}^{n}}{h^{2}}$.\nStudy the implicit-explicit (IMEX) time discretization that treats advection explicitly by forward Euler and diffusion implicitly by backward Euler:\n$$\n\\frac{u_{j}^{n+1} - u_{j}^{n}}{\\Delta t} + a\\,D_{0}u_{j}^{n} \\;=\\; \\nu\\,D_{2}u_{j}^{n+1}.\n$$\nAssume spatial periodicity and perform a von Neumann Fourier analysis by inserting a single Fourier mode $u_{j}^{n} = \\hat{u}^{n}\\,\\exp(i j \\theta)$, where $\\theta \\in [-\\pi,\\pi]$ is the dimensionless wave number. Introduce the nondimensional advective Courant number $c = \\dfrac{a\\,\\Delta t}{h}$ and diffusion number $r = \\dfrac{\\nu\\,\\Delta t}{h^{2}}$. Derive the amplification factor $G_{\\text{IMEX}}(\\theta)$ defined by $\\hat{u}^{n+1} = G_{\\text{IMEX}}(\\theta)\\,\\hat{u}^{n}$ in closed form. Then, by enforcing the von Neumann stability condition $|G_{\\text{IMEX}}(\\theta)| \\le 1$ for all $\\theta \\in [-\\pi,\\pi]$, determine the smallest nonnegative diffusion number $r$ as a function of $c$ that guarantees stability for all Fourier modes. Compare qualitatively with the purely implicit diffusion scheme obtained by setting $a = 0$ in the above IMEX method.\n\nProvide as your final answer the exact closed-form expression for the minimal diffusion number as a function of $c$, denoted $r_{\\min}(c)$. No numerical approximation is required, and no units are to be reported in the final answer.", "solution": "The problem asks for an analysis of the implicit-explicit (IMEX) time discretization scheme for the linear advection-diffusion equation. The analysis will proceed in three stages: first, the derivation of the amplification factor using von Neumann analysis; second, the determination of the stability condition and the minimal diffusion number $r_{\\min}(c)$; and third, a qualitative comparison with a purely implicit scheme.\n\nThe one-dimensional advection-diffusion equation is given by:\n$$\nu_{t} + a\\,u_{x} = \\nu\\,u_{xx}\n$$\nwhere $u(x,t)$ is the scalar field, $a$ is the advection speed, and $\\nu$ is the diffusion coefficient. The spatial domain is periodic.\n\nThe problem defines a semi-discretization in space using second-order centered finite differences for both the first and second derivatives. The IMEX time-stepping scheme treats the advection term explicitly with forward Euler and the diffusion term implicitly with backward Euler:\n$$\n\\frac{u_{j}^{n+1} - u_{j}^{n}}{\\Delta t} + a\\,D_{0}u_{j}^{n} = \\nu\\,D_{2}u_{j}^{n+1}\n$$\nHere, $u_j^n \\approx u(x_j, t^n)$, $\\Delta t$ is the time step, and the difference operators are defined as $D_{0}u_{j}^{n} = \\frac{u_{j+1}^{n} - u_{j-1}^{n}}{2h}$ and $D_{2}u_{j}^{n} = \\frac{u_{j+1}^{n} - 2u_{j}^{n} + u_{j-1}^{n}}{h^{2}}$.\n\nTo perform the von Neumann stability analysis, we substitute a single Fourier mode $u_{j}^{n} = \\hat{u}^{n}\\,\\exp(i j \\theta)$ into the scheme, where $\\theta = k h$ is the dimensionless wave number for a wave number $k$. The amplification factor is defined by the relation $\\hat{u}^{n+1} = G_{\\text{IMEX}}(\\theta)\\,\\hat{u}^{n}$.\n\nFirst, we find the Fourier representation of the difference operators acting on the mode:\n$$\nD_{0}u_{j}^{n} = \\frac{\\hat{u}^{n}\\exp(i(j+1)\\theta) - \\hat{u}^{n}\\exp(i(j-1)\\theta)}{2h} = \\frac{\\hat{u}^{n}\\exp(ij\\theta)}{2h}(\\exp(i\\theta) - \\exp(-i\\theta)) = \\frac{2i\\sin(\\theta)}{2h}\\hat{u}^{n}\\exp(ij\\theta) = \\frac{i\\sin(\\theta)}{h}u_{j}^{n}\n$$\n$$\nD_{2}u_{j}^{n+1} = \\frac{\\hat{u}^{n+1}\\exp(i(j+1)\\theta) - 2\\hat{u}^{n+1}\\exp(ij\\theta) + \\hat{u}^{n+1}\\exp(i(j-1)\\theta)}{h^2} = \\frac{\\hat{u}^{n+1}\\exp(ij\\theta)}{h^2}(\\exp(i\\theta) - 2 + \\exp(-i\\theta))\n$$\nUsing the identity $\\exp(i\\theta) + \\exp(-i\\theta) = 2\\cos(\\theta)$, this simplifies to:\n$$\nD_{2}u_{j}^{n+1} = \\frac{2\\cos(\\theta) - 2}{h^2}\\hat{u}^{n+1}\\exp(ij\\theta) = \\frac{-2(1-\\cos(\\theta))}{h^2}u_{j}^{n+1}\n$$\nUsing the half-angle identity $1-\\cos(\\theta) = 2\\sin^2(\\theta/2)$, we get:\n$$\nD_{2}u_{j}^{n+1} = \\frac{-4\\sin^2(\\theta/2)}{h^2}u_{j}^{n+1}\n$$\nSubstituting these expressions into the IMEX scheme and cancelling the common factor $\\exp(ij\\theta)$:\n$$\n\\frac{\\hat{u}^{n+1} - \\hat{u}^{n}}{\\Delta t} + a\\left(\\frac{i\\sin(\\theta)}{h}\\right)\\hat{u}^{n} = \\nu\\left(\\frac{-4\\sin^2(\\theta/2)}{h^2}\\right)\\hat{u}^{n+1}\n$$\nRearranging terms to group $\\hat{u}^{n+1}$ and $\\hat{u}^{n}$:\n$$\n\\hat{u}^{n+1}\\left(\\frac{1}{\\Delta t} + \\nu\\frac{4\\sin^2(\\theta/2)}{h^2}\\right) = \\hat{u}^{n}\\left(\\frac{1}{\\Delta t} - a\\frac{i\\sin(\\theta)}{h}\\right)\n$$\nMultiplying the entire equation by $\\Delta t$:\n$$\n\\hat{u}^{n+1}\\left(1 + \\frac{4\\nu\\Delta t}{h^2}\\sin^2(\\theta/2)\\right) = \\hat{u}^{n}\\left(1 - i\\frac{a\\Delta t}{h}\\sin(\\theta)\\right)\n$$\nIntroducing the nondimensional Courant number $c = \\frac{a\\Delta t}{h}$ and diffusion number $r = \\frac{\\nu\\Delta t}{h^2}$:\n$$\n\\hat{u}^{n+1}\\left(1 + 4r\\sin^2(\\theta/2)\\right) = \\hat{u}^{n}(1 - ic\\sin(\\theta))\n$$\nThe amplification factor $G_{\\text{IMEX}}(\\theta) = \\hat{u}^{n+1}/\\hat{u}^{n}$ is therefore:\n$$\nG_{\\text{IMEX}}(\\theta) = \\frac{1 - ic\\sin(\\theta)}{1 + 4r\\sin^2(\\theta/2)}\n$$\nThe von Neumann stability condition requires $|G_{\\text{IMEX}}(\\theta)| \\le 1$ for all $\\theta \\in [-\\pi, \\pi]$. We analyze its squared magnitude:\n$$\n|G_{\\text{IMEX}}(\\theta)|^2 = \\frac{|1 - ic\\sin(\\theta)|^2}{|1 + 4r\\sin^2(\\theta/2)|^2} = \\frac{1^2 + (-c\\sin(\\theta))^2}{(1 + 4r\\sin^2(\\theta/2))^2} = \\frac{1 + c^2\\sin^2(\\theta)}{(1 + 4r\\sin^2(\\theta/2))^2}\n$$\nThe stability condition becomes:\n$$\n\\frac{1 + c^2\\sin^2(\\theta)}{(1 + 4r\\sin^2(\\theta/2))^2} \\le 1\n$$\nSince the denominator is real and positive (for $r \\ge 0$), we can multiply to get:\n$$\n1 + c^2\\sin^2(\\theta) \\le \\left(1 + 4r\\sin^2(\\theta/2)\\right)^2 = 1 + 8r\\sin^2(\\theta/2) + 16r^2\\sin^4(\\theta/2)\n$$\nSubtracting $1$ from both sides yields:\n$$\nc^2\\sin^2(\\theta) \\le 8r\\sin^2(\\theta/2) + 16r^2\\sin^4(\\theta/2)\n$$\nUsing the double-angle identity $\\sin(\\theta) = 2\\sin(\\theta/2)\\cos(\\theta/2)$:\n$$\nc^2\\left(4\\sin^2(\\theta/2)\\cos^2(\\theta/2)\\right) \\le 8r\\sin^2(\\theta/2) + 16r^2\\sin^4(\\theta/2)\n$$\nIf $\\sin(\\theta/2) = 0$ (i.e., $\\theta=0$), the inequality is $0 \\le 0$, which is always satisfied. For $\\sin(\\theta/2) \\neq 0$, we can divide by the positive quantity $4\\sin^2(\\theta/2)$:\n$$\nc^2\\cos^2(\\theta/2) \\le 2r + 4r^2\\sin^2(\\theta/2)\n$$\nTo find the most stringent condition on $r$, let $S = \\sin^2(\\theta/2)$. As $\\theta$ spans $[-\\pi, \\pi]$, $S$ spans $[0, 1]$. Using $\\cos^2(\\theta/2) = 1 - S$, the inequality becomes:\n$$\nc^2(1 - S) \\le 2r + 4r^2S\n$$\nThis inequality must hold for all $S \\in [0, 1]$. We rearrange the terms to isolate $S$:\n$$\nc^2 - 2r \\le c^2S + 4r^2S = (c^2 + 4r^2)S\n$$\nLet's define a function $F(S) = (c^2 + 4r^2)S - (c^2 - 2r)$. We require $F(S) \\ge 0$ for all $S \\in [0, 1]$. The coefficient of $S$, which is $m = c^2 + 4r^2$, represents the slope of this linear function of $S$. Since $r \\ge 0$, the slope $m$ is always non-negative.\nFor a non-decreasing linear function on an interval, the minimum value is attained at the left endpoint of the interval. Thus, to ensure $F(S) \\ge 0$ for all $S \\in [0, 1]$, we only need to enforce the condition at $S=0$:\n$$\nF(0) \\ge 0 \\implies (c^2+4r^2)(0) - (c^2 - 2r) \\ge 0\n$$\n$$\n-(c^2 - 2r) \\ge 0 \\implies 2r - c^2 \\ge 0\n$$\nThis gives the stability condition:\n$$\nr \\ge \\frac{c^2}{2}\n$$\nThe smallest non-negative diffusion number $r$ that guarantees stability for any given Courant number $c$ is therefore $r_{\\min}(c) = \\frac{c^2}{2}$.\n\nFor the qualitative comparison, consider the purely implicit diffusion scheme, which corresponds to setting $a=0$ in the IMEX method. If $a=0$, then the Courant number $c=0$. The amplification factor becomes:\n$$\nG_{\\text{diffusion}}(\\theta) = G_{\\text{IMEX}}(\\theta)|_{c=0} = \\frac{1}{1 + 4r\\sin^2(\\theta/2)}\n$$\nSince $r \\ge 0$ and $\\sin^2(\\theta/2) \\ge 0$, the denominator is always greater than or equal to $1$. Thus, $|G_{\\text{diffusion}}(\\theta)| \\le 1$ for all $\\theta$ and for any $r \\ge 0$. This means the purely implicit discretization of the diffusion equation (Backward Time Centered Space, BTCS) is unconditionally stable.\n\nIn contrast, the IMEX scheme is only conditionally stable. The explicit treatment of the advection term introduces a potential for instability. In Fourier space, the forward Euler discretization of the advection term contributes the factor $1 - ic\\sin(\\theta)$, which has a magnitude $\\sqrt{1+c^2\\sin^2\\theta} \\ge 1$. This term alone would lead to unconditional instability. The implicit treatment of the diffusion term provides a damping factor $(1 + 4r\\sin^2(\\theta/2))^{-1}$. The stability condition $r \\ge c^2/2$ quantifies the minimum amount of implicit diffusion (measured by $r$) required to counteract the amplification caused by the explicit advection (measured by $c$) and ensure that the net amplification factor does not exceed unity in magnitude. This condition can be rewritten in terms of physical parameters as $\\frac{\\nu\\Delta t}{h^2} \\ge \\frac{1}{2}(\\frac{a\\Delta t}{h})^2$, which simplifies to $\\Delta t \\le \\frac{2\\nu}{a^2}$. This is a time step restriction that depends on the physical coefficients, a hallmark of explicit or partially explicit methods.", "answer": "$$\n\\boxed{\\frac{c^{2}}{2}}\n$$", "id": "3406598"}, {"introduction": "A stable scheme is a prerequisite, but an efficient scheme must also be accurate. For a given computational budget, we want to minimize the error, which often involves balancing contributions from different sources of discretization. This practice [@problem_id:3406599] focuses on this very principle, asking you to derive the optimal relationship between the time step $\\Delta t$ and the spatial mesh size $h$. Performing this error analysis will equip you with the skills to make informed decisions that maximize computational efficiency.", "problem": "Consider the homogeneous one-dimensional heat partial differential equation (PDE) $u_{t}=\\kappa u_{xx}$ on the spatial interval $[0,1]$ with homogeneous Dirichlet boundary conditions and smooth initial data $u(x,0)=\\sin(\\pi x)$. Let the exact solution be $u(x,t)=\\sin(\\pi x)\\exp(-\\kappa \\pi^{2} t)$ for any $t \\ge 0$. Discretize the spatial domain by a uniform grid with mesh size $h$ and approximate $u_{xx}$ by the standard centered finite difference operator of second order. Advance in time to a fixed horizon $T>0$ using the fully implicit backward Euler method with time step $\\Delta t$. Focus on the single discrete Fourier-sine mode associated with $\\sin(\\pi x)$ and assume smoothness sufficient to justify Taylor expansions and linearization about this mode.\n\nStarting from the definitions of the discrete Laplacian eigenvalue for this mode and the backward Euler amplification factor for the corresponding linear ordinary differential equation that arises from the method of lines, derive the leading-order asymptotic model for the global pointwise error at time $T$ as a sum of a temporal contribution proportional to $\\Delta t$ and a spatial contribution proportional to $h^{2}$. Use only first principles such as Taylor series for $\\ln(1+z)$ and $\\sin(z)$, and the exact solution form for the eigenmode. Then, by enforcing the scaling $\\Delta t = C h^{2}$ and requiring the magnitudes of the leading temporal and spatial error contributions to be equal (to balance the errors), determine the constant $C$ as a closed-form expression in terms of $\\kappa$.\n\nYour final answer must be the explicit expression for $C$. Do not provide an inequality or an equation. No numerical rounding is required.", "solution": "The problem asks for the constant $C$ that balances the leading-order temporal and spatial errors for a numerical solution of the heat equation, under the scaling $\\Delta t = C h^{2}$. The solution requires a careful asymptotic analysis of the global error.\n\nThe governing partial differential equation (PDE) is the one-dimensional heat equation:\n$$u_{t} = \\kappa u_{xx}$$\non the domain $x \\in [0, 1]$ with homogeneous Dirichlet boundary conditions $u(0, t) = u(1, t) = 0$ and initial condition $u(x, 0) = \\sin(\\pi x)$. The exact solution for this initial value problem is given as $u(x, t) = \\sin(\\pi x) \\exp(-\\kappa \\pi^{2} t)$.\n\nFirst, we discretize the spatial domain using a uniform grid $x_j = j h$ for $j = 0, 1, \\dots, N$, where $h = 1/N$. The second spatial derivative $u_{xx}$ at $x_j$ is approximated by the second-order standard centered finite difference operator:\n$$u_{xx}(x_j, t) \\approx \\frac{u(x_{j+1}, t) - 2u(x_j, t) + u(x_{j-1}, t)}{h^2}$$\nApplying this to the PDE yields a system of ordinary differential equations (ODEs), a technique known as the method of lines. Let $u_j(t)$ be the approximation of $u(x_j, t)$. The semi-discretized system is:\n$$\\frac{du_j}{dt} = \\kappa \\frac{u_{j+1} - 2u_j + u_{j-1}}{h^2}$$\nThe initial condition is an eigenfunction of the continuous Laplacian operator, $\\sin(\\pi x)$. Its discrete counterpart, $v_j = \\sin(\\pi x_j) = \\sin(j \\pi h)$, is an eigenvector of the discrete Laplacian matrix. Let us find the corresponding eigenvalue, denoted $\\lambda_h$.\nApplying the discrete operator to $v_j$:\n$$\\frac{v_{j+1} - 2v_j + v_{j-1}}{h^2} = \\frac{\\sin((j+1)\\pi h) - 2\\sin(j\\pi h) + \\sin((j-1)\\pi h)}{h^2}$$\nUsing the trigonometric identity $\\sin(A+B) + \\sin(A-B) = 2\\sin(A)\\cos(B)$, we get:\n$$\\frac{2\\sin(j\\pi h)\\cos(\\pi h) - 2\\sin(j\\pi h)}{h^2} = \\left(\\frac{2(\\cos(\\pi h) - 1)}{h^2}\\right) \\sin(j\\pi h)$$\nThus, the eigenvalue is $\\lambda_h = \\frac{2(\\cos(\\pi h) - 1)}{h^2}$.\nThe ODE for the amplitude of this mode, let's call it $U(t)$, becomes $\\frac{dU}{dt} = \\kappa \\lambda_h U(t)$.\n\nNext, we analyze the error introduced by this spatial discretization. We expand $\\lambda_h$ as a Taylor series in $h$. Using the series for $\\cos(z) = 1 - \\frac{z^2}{2!} + \\frac{z^4}{4!} - O(z^6)$:\n$$\\lambda_h = \\frac{2}{h^2} \\left( \\left(1 - \\frac{(\\pi h)^2}{2} + \\frac{(\\pi h)^4}{24} - O(h^6)\\right) - 1 \\right) = \\frac{2}{h^2} \\left( -\\frac{\\pi^2 h^2}{2} + \\frac{\\pi^4 h^4}{24} - O(h^6) \\right)$$\n$$\\lambda_h = -\\pi^2 + \\frac{\\pi^4 h^2}{12} - O(h^4)$$\nThe eigenvalue of the continuous operator $-\\frac{\\partial^2}{\\partial x^2}$ for the mode $\\sin(\\pi x)$ is $\\pi^2$, so the eigenvalue for $u_{xx}$ is $-\\pi^2$. The spatial discretization introduces an error of $\\lambda_h - (-\\pi^2) \\approx \\frac{\\pi^4 h^2}{12}$.\n\nNow, we apply the fully implicit backward Euler method to the ODE $\\frac{dU}{dt} = \\kappa \\lambda_h U(t)$ with a time step $\\Delta t$. Let $U^n$ be the approximation of $U(n\\Delta t)$.\n$$\\frac{U^{n+1} - U^n}{\\Delta t} = \\kappa \\lambda_h U^{n+1}$$\nSolving for $U^{n+1}$, we find $U^{n+1} = \\frac{1}{1 - \\kappa \\lambda_h \\Delta t} U^n$. The amplification factor for one time step is $g_{BE} = (1 - \\kappa \\lambda_h \\Delta t)^{-1}$.\nAfter $n_{steps} = T/\\Delta t$ steps, the numerical solution for the amplitude at time $T$ is $U(T) \\approx (g_{BE})^{T/\\Delta t} U(0)$.\n\nThe exact solution's amplitude at time $T$ is $\\exp(-\\kappa \\pi^2 T)$.\nThe numerical solution's amplitude at time $T$ is $( (1 - \\kappa \\lambda_h \\Delta t)^{-1} )^{T/\\Delta t}$.\nTo analyze the error, we compare the logarithms of these two quantities.\nThe logarithm of the exact amplitude factor is $-\\kappa \\pi^2 T$.\nThe logarithm of the numerical amplitude factor is:\n$$ \\ln\\left( (g_{BE})^{T/\\Delta t} \\right) = \\frac{T}{\\Delta t} \\ln(g_{BE}) = -\\frac{T}{\\Delta t} \\ln(1 - \\kappa \\lambda_h \\Delta t)$$\nUsing the Taylor series $\\ln(1-z) = -z - \\frac{z^2}{2} - O(z^3)$ with $z = \\kappa \\lambda_h \\Delta t$:\n$$-\\frac{T}{\\Delta t} \\left( -(\\kappa \\lambda_h \\Delta t) - \\frac{(\\kappa \\lambda_h \\Delta t)^2}{2} - O((\\Delta t)^3) \\right) = T \\kappa \\lambda_h + \\frac{T}{2} (\\kappa \\lambda_h)^2 \\Delta t + O((\\Delta t)^2)$$\nNow we substitute the expansion for $\\lambda_h$:\n$$T \\kappa \\left(-\\pi^2 + \\frac{\\pi^4 h^2}{12} + O(h^4)\\right) + \\frac{T}{2} \\left(\\kappa \\left(-\\pi^2 + O(h^2)\\right)\\right)^2 \\Delta t + O((\\Delta t)^2)$$\n$$ = -T \\kappa \\pi^2 + T \\kappa \\frac{\\pi^4 h^2}{12} + \\frac{T}{2} \\kappa^2 \\pi^4 \\Delta t + \\text{h.o.t.}$$\nThe logarithm of the exact amplitude is $-T \\kappa \\pi^2$. The error in the logarithm of the amplitude is the difference:\n$$\\text{Error}_{\\ln} \\approx \\left( T \\kappa \\frac{\\pi^4 h^2}{12} \\right) + \\left( \\frac{T}{2} \\kappa^2 \\pi^4 \\Delta t \\right)$$\nThe term proportional to $h^2$ arises from spatial discretization, and the term proportional to $\\Delta t$ arises from temporal discretization.\n\nThe global pointwise error at time $T$ is $E_j(T) = u(x_j, T) - u_j^N$, where $N=T/\\Delta t$.\n$$E_j(T) = \\sin(\\pi x_j) \\left( \\exp(-\\kappa \\pi^2 T) - \\left(g_{BE}\\right)^{T/\\Delta t} \\right)$$\nLet $A_{exact} = \\exp(-\\kappa \\pi^2 T)$ and $A_{num} = (g_{BE})^{T/\\Delta t}$. We have $\\ln(A_{num}) \\approx \\ln(A_{exact}) + \\text{Error}_{\\ln}$.\nThus $A_{num} \\approx A_{exact} \\exp(\\text{Error}_{\\ln})$. For small errors, $\\exp(\\text{Error}_{\\ln}) \\approx 1 + \\text{Error}_{\\ln}$.\nSo $A_{num} \\approx A_{exact} (1 + \\text{Error}_{\\ln})$.\nThe error in the amplitude is $A_{exact} - A_{num} \\approx -A_{exact} \\cdot \\text{Error}_{\\ln}$.\nThe pointwise error is:\n$$E_j(T) \\approx -\\sin(\\pi x_j) \\exp(-\\kappa \\pi^2 T) \\left( T \\kappa \\frac{\\pi^4 h^2}{12} + \\frac{T}{2} \\kappa^2 \\pi^4 \\Delta t \\right)$$\nThis gives the leading-order asymptotic model for the global error. The first term in the parenthesis is the spatial error contribution, and the second is the temporal error contribution.\n\nThe problem requires balancing the magnitudes of these two contributions.\n$$ \\left| \\text{Spatial Contribution} \\right| = \\left| -\\sin(\\pi x_j) \\exp(-\\kappa \\pi^2 T) T \\kappa \\frac{\\pi^4 h^2}{12} \\right| $$\n$$ \\left| \\text{Temporal Contribution} \\right| = \\left| -\\sin(\\pi x_j) \\exp(-\\kappa \\pi^2 T) \\frac{T}{2} \\kappa^2 \\pi^4 \\Delta t \\right| $$\nAssuming $x_j \\in (0,1)$, $T>0$, $\\kappa>0$, we can equate the positive parts:\n$$ \\sin(\\pi x_j) \\exp(-\\kappa \\pi^2 T) T \\kappa \\frac{\\pi^4 h^2}{12} = \\sin(\\pi x_j) \\exp(-\\kappa \\pi^2 T) \\frac{T}{2} \\kappa^2 \\pi^4 \\Delta t $$\nCanceling the common factors (which are non-zero) on both sides:\n$$ \\kappa \\frac{\\pi^4 h^2}{12} = \\frac{\\kappa^2 \\pi^4 \\Delta t}{2} $$\nFurther simplification by canceling $\\kappa$ and $\\pi^4$ yields:\n$$ \\frac{h^2}{12} = \\frac{\\kappa \\Delta t}{2} $$\nThe problem enforces the scaling $\\Delta t = C h^2$. Substituting this into the equation:\n$$ \\frac{h^2}{12} = \\frac{\\kappa (C h^2)}{2} $$\nWe cancel $h^2$ from both sides (since $h \\neq 0$):\n$$ \\frac{1}{12} = \\frac{\\kappa C}{2} $$\nFinally, we solve for the constant $C$:\n$$ \\kappa C = \\frac{2}{12} = \\frac{1}{6} $$\n$$ C = \\frac{1}{6\\kappa} $$\nThis value of $C$ balances the leading-order spatial and temporal truncation errors for the given numerical scheme and problem.", "answer": "$$\\boxed{\\frac{1}{6\\kappa}}$$", "id": "3406599"}, {"introduction": "Real-world problems often start from non-smooth initial conditions, which introduce high-frequency components that can trigger instabilities in less robust schemes. This final exercise [@problem_id:3406590] explores this challenge by contrasting the behavior of the A-stable Crank-Nicolson method with the L-stable backward Euler method. You will analyze a practical strategy that uses a few initial backward Euler steps to damp these problematic modes, revealing the critical role of L-stability in ensuring robustness for stiff parabolic problems.", "problem": "Consider the one-dimensional heat equation, a canonical parabolic partial differential equation (PDE),\n$$\nu_t = \\nu u_{xx}, \\quad x \\in (0,1), \\quad t>0,\n$$\nwith homogeneous Dirichlet boundary conditions and initial data $u(x,0)=u_0(x)$ that is square-integrable but not necessarily smooth. Let a standard second-order central finite difference method (finite difference method (FDM)) in space be used on a uniform grid with mesh size $h$, producing the semi-discrete ordinary differential equation (ODE)\n$$\n\\frac{d}{dt} \\mathbf{u}(t) = A \\mathbf{u}(t),\n$$\nwhere $A$ is the stiffness matrix obtained from the Laplacian with Dirichlet boundary conditions, which is symmetric negative definite with eigenvalues $\\lambda_j < 0$ of magnitude $|\\lambda_j| = \\mathcal{O}(h^{-2})$. Consider the $\\theta$-method in time for a uniform time step $\\Delta t$,\n$$\n\\left(I - \\theta \\,\\Delta t \\, A\\right)\\mathbf{u}^{n+1} = \\left(I + (1-\\theta)\\,\\Delta t \\, A\\right)\\mathbf{u}^{n},\n$$\napplied to the semi-discrete system. We examine a variable-$\\theta$ strategy: for the first $m$ steps, take $\\theta=1$ (fully implicit backward Euler), and for all subsequent steps, take $\\theta = 1/2$ (Crank–Nicolson). Assume $m$ is a fixed integer independent of $\\Delta t$ and $h$, and that the parabolic smoothing of the exact solution makes $u(\\cdot,t)$ spatially smooth for $t>0$.\n\nUsing the scalar test equation $y'(t)=\\lambda y(t)$ with $\\lambda<0$ to represent individual stiff modes and the classical smoothing properties of parabolic semigroups $e^{tA}$, analyze how this variable-$\\theta$ strategy affects:\n- the damping of initial high-frequency components arising from non-smooth initial data (the initial layer), and\n- the overall temporal accuracy of the method at a fixed final time $T>0$.\n\nWhich of the following statements is most accurate under these assumptions?\n\nA. A fixed number of initial backward Euler steps ($\\theta=1$) strongly damps high-frequency components associated with large negative eigenvalues, and the subsequent Crank–Nicolson ($\\theta=1/2$) steps yield second-order accuracy in time at $t=T$ once the solution has become smooth; thus, the combined strategy both damps the initial layer and retains second-order accuracy.\n\nB. Because backward Euler is only first-order accurate, any use of $\\theta=1$ at the start forces the entire computation to be globally first-order in time at $t=T$, regardless of how many Crank–Nicolson steps are taken afterward.\n\nC. The initial backward Euler steps increase the amplitude of the highest-frequency modes, which are then corrected by Crank–Nicolson; nevertheless, the overall accuracy remains second order at $t=T$.\n\nD. For the scalar test equation, backward Euler ($\\theta=1$) and Crank–Nicolson ($\\theta=1/2$) have identical amplification factors for large negative $\\Delta t\\,\\lambda$, so switching from $\\theta=1$ to $\\theta=1/2$ does not influence initial layer damping.\n\nE. To recover second-order accuracy in the presence of non-smooth initial data, the startup must be explicit; beginning with $\\theta=1$ cannot improve damping or restore second-order accuracy.", "solution": "The problem statement has been validated and is deemed sound, well-posed, and scientifically correct.\n\nThe problem asks for an analysis of a variable time-stepping strategy for the numerical solution of the heat equation. Specifically, it uses a few steps of the first-order backward Euler method ($\\theta=1$) followed by the second-order Crank–Nicolson method ($\\theta=1/2$) for all subsequent steps. We need to assess the effect of this strategy on two aspects: the damping of initial high-frequency components from non-smooth data, and the overall temporal accuracy at a fixed final time $T > 0$.\n\nLet's analyze these two aspects separately using the provided framework.\n\n**1. Damping of High-Frequency Components**\n\nThe semi-discrete system $\\frac{d}{dt}\\mathbf{u}(t) = A\\mathbf{u}(t)$ is stiff. The stiffness arises because the eigenvalues $\\lambda_j$ of the matrix $A$ span a wide range of magnitudes, with $|\\lambda_j|_{max} = \\mathcal{O}(h^{-2})$. The eigenvalues with large magnitudes correspond to high-frequency spatial modes. Non-smooth initial data $u_0(x)$ will have significant projections onto these high-frequency eigenmodes. A good numerical scheme must damp these components quickly, mimicking the physical smoothing property of the heat equation.\n\nThe behavior of a time-stepping scheme on these modes is analyzed using the scalar test equation $y'(t) = \\lambda y(t)$, where $\\lambda < 0$ represents an eigenvalue of $A$. The update rule is $y^{n+1} = R(z) y^n$, where $z = \\lambda \\Delta t$ and $R(z)$ is the amplification factor of the method. For the $\\theta$-method, the amplification factor is:\n$$\nR(z) = \\frac{1 + (1-\\theta)z}{1 - \\theta z}\n$$\nWe are interested in the behavior of $R(z)$ for high-frequency modes, which corresponds to $z \\to -\\infty$.\n\n- **Backward Euler ($\\theta=1$):** Used for the first $m$ steps.\nThe amplification factor is $R_{BE}(z) = \\frac{1}{1-z}$. In the limit $z \\to -\\infty$, we have:\n$$\n\\lim_{z \\to -\\infty} R_{BE}(z) = \\lim_{z \\to -\\infty} \\frac{1}{1-z} = 0\n$$\nThis property, where the amplification factor vanishes for infinitely stiff components, is known as L-stability. It implies that the backward Euler method very strongly damps high-frequency components. This is highly desirable for handling the initial non-smooth data, which is rich in such components.\n\n- **Crank–Nicolson ($\\theta=1/2$):** Used for steps $n \\ge m$.\nThe amplification factor is $R_{CN}(z) = \\frac{1 + z/2}{1 - z/2}$. In the limit $z \\to -\\infty$, we have:\n$$\n\\lim_{z \\to -\\infty} R_{CN}(z) = \\lim_{z \\to -\\infty} \\frac{1 + z/2}{1 - z/2} = -1\n$$\nThis means that the Crank–Nicolson method does not damp high-frequency components; it preserves their amplitude while flipping their sign at each time step. This leads to persistent, high-frequency oscillations in the numerical solution if such components are present. This property is known as A-stability, which is weaker than L-stability.\n\nThe strategy of using a few backward Euler steps initially is therefore critical. It effectively damps the initial high-frequency errors arising from the non-smooth data, numerically \"smoothing\" the solution. After a few steps, the solution is smooth, the high-frequency components are negligible, and one can switch to the more accurate Crank-Nicolson method without fearing oscillatory artifacts.\n\n**2. Overall Temporal Accuracy**\n\nThe backward Euler method is first-order accurate in time (local truncation error $\\tau_{BE} = \\mathcal{O}(\\Delta t^2)$), while the Crank–Nicolson method is second-order accurate ($\\tau_{CN} = \\mathcal{O}(\\Delta t^3)$). A naive analysis might suggest that using any number of first-order steps would reduce the global accuracy of the entire computation to first order.\n\nHowever, for parabolic problems, a more subtle analysis is required. The key is the smoothing property of the exact solution operator $e^{tA}$. For $t > 0$, the solution $u(t) = e^{tA}u_0$ is smooth even for non-smooth $u_0$. The time derivatives of $u(t)$ are singular at $t=0$ but become bounded for $t>0$. For example, $\\|A^k u(t)\\| \\le C_k t^{-k} \\|u_0\\|$ for $t>0$.\n\nThe local truncation error terms depend on these derivatives. The first-order errors of the backward Euler steps are committed at early times $t_n = n\\Delta t$ for $n=0, \\dots, m-1$. While the local truncation error constant is large at these initial times, the errors themselves are propagated forward in a manner that is damped by the scheme. The smoothing property of the parabolic equation means that the errors introduced at the start have a diminishing effect at a later time $T$.\n\nA rigorous analysis (pioneered by Rannacher and others) shows that for a fixed number of initial steps $m$ (independent of $\\Delta t$ and $h$), the global error at a fixed final time $T > m\\Delta t$ is dominated by the accuracy of the method used for the main part of the integration. The first-order errors from the few startup steps do not pollute the overall second-order accuracy. The global error at time $T$ behaves as $\\mathcal{O}(\\Delta t^2)$.\n\nTherefore, the combined strategy successfully leverages the strengths of both methods: backward Euler's strong damping to handle the initial non-smoothness and Crank–Nicolson's high accuracy for the subsequent evolution of the now-smooth solution, resulting in a method that is both robust and second-order accurate.\n\n**Evaluation of Options:**\n\n- **A.** This statement claims that initial BE steps damp high-frequency components and the subsequent CN steps yield second-order accuracy, with the combined strategy achieving both goals. Our analysis confirms both of these points. The BE steps provide the necessary damping due to L-stability. The overall accuracy is preserved at $\\mathcal{O}(\\Delta t^2)$ due to the smoothing properties of parabolic problems. **Correct.**\n\n- **B.** This statement claims that any use of BE forces the global accuracy to be first-order. This is a common misconception that ignores the specific context of parabolic smoothing. As analyzed, the first-order errors from the initial steps do not dominate the global error at a later time $T$. **Incorrect.**\n\n- **C.** This statement claims that BE steps *increase* the amplitude of high-frequency modes. This is factually false. As shown by the amplification factor $R_{BE}(z) = 1/(1-z)$, its magnitude is always less than or equal to $1$ for $\\text{Re}(z) \\le 0$, and it approaches $0$ for large negative $z$. It is a damping method. **Incorrect.**\n\n- **D.** This statement claims BE and CN have identical amplification factors for large negative $\\Delta t \\lambda$. We calculated $\\lim_{z \\to -\\infty} R_{BE}(z) = 0$ and $\\lim_{z \\to -\\infty} R_{CN}(z) = -1$. These are not identical. The difference between these limits is precisely why the startup strategy is effective. **Incorrect.**\n\n- **E.** This statement makes multiple false claims. First, it suggests an explicit startup is necessary; for stiff problems, this would be disastrous due to stability constraints. Second, it claims $\\theta=1$ (BE) cannot improve damping, which is the opposite of the truth—its L-stability is its key advantage for damping. Third, it claims BE cannot restore second-order accuracy, which again contradicts the established theory for this startup strategy. **Incorrect.**\n\nFinal conclusion: The only accurate statement is A.", "answer": "$$\\boxed{A}$$", "id": "3406590"}]}