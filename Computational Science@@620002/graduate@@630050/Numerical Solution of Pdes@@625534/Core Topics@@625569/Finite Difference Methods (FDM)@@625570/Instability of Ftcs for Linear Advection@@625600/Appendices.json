{"hands_on_practices": [{"introduction": "The foundation of stability analysis for linear, constant-coefficient schemes is the von Neumann method, which examines how the amplitude of individual Fourier modes evolves over time. This first practice is a crucial exercise in deriving the amplification factor for the FTCS scheme, the mathematical tool that unlocks its stability properties. By analyzing its magnitude, you will directly prove why the scheme is inherently unstable for the advection equation. [@problem_id:3409069]", "problem": "Consider the linear constant-coefficient advection equation $u_{t} + a\\,u_{x} = 0$ with constant speed $a \\in \\mathbb{R}$, posed on a one-dimensional periodic domain discretized by a uniform spatial grid $x_{j} = j\\,\\Delta x$ and a uniform time grid $t^{n} = n\\,\\Delta t$. Apply the Forward Time, Centered Space (FTCS) finite difference scheme to this equation on the periodic grid. \n\nUsing the standard Fourier (von Neumann) mode ansatz $u_{j}^{n} = \\widehat{u}^{\\,n}\\,\\exp(i j \\theta)$, where $\\theta \\in [-\\pi,\\pi]$ is the nondimensional Fourier frequency (in radians) associated with the grid spacing $\\Delta x$, carry out the following:\n\n1. Starting from the FTCS update for $u_{j}^{n+1}$ in terms of $u_{j}^{n}$, derive the amplification factor $G(\\theta)$ such that $\\widehat{u}^{\\,n+1} = G(\\theta)\\,\\widehat{u}^{\\,n}$. Express $G(\\theta)$ in terms of the Courant number $C = a\\,\\Delta t/\\Delta x$.\n2. Derive the amplification magnitude $\\lvert G(\\theta)\\rvert$ as a function of $C$ and $\\theta$.\n3. Define the “least unstable” pair $(C^{\\ast},\\theta^{\\ast})$ to be any global minimizer of $\\lvert G(\\theta)\\rvert$ over the set $\\{(C,\\theta): C \\ge 0,\\ \\theta \\in [0,\\pi]\\}$. If there are multiple minimizers, select among them the one with the smallest $C$, and among those, the one with the smallest nonnegative $\\theta$. Provide this selected minimizer $(C^{\\ast},\\theta^{\\ast})$ in radians.\n\nYour final answer must be given as a two-entry row matrix $\\begin{pmatrix} C^{\\ast}  \\theta^{\\ast}\\end{pmatrix}$ with exact values (no rounding).", "solution": "The problem asks for the derivation of the amplification factor for the Forward Time, Centered Space (FTCS) scheme applied to the linear advection equation, and subsequently to find the pair $(C^{\\ast}, \\theta^{\\ast})$ that minimizes the magnitude of this factor.\n\nThe linear advection equation is given by\n$$ u_{t} + a u_{x} = 0 $$\nwhere $u=u(x,t)$ and $a$ is a constant speed.\n\nThe FTCS scheme discretizes this partial differential equation. The time derivative $u_t$ is approximated using a forward difference, and the spatial derivative $u_x$ is approximated using a centered difference. Let $u_j^n \\approx u(x_j, t^n)$, where $x_j = j \\Delta x$ and $t^n = n \\Delta t$. The scheme is:\n$$ \\frac{u_{j}^{n+1} - u_{j}^{n}}{\\Delta t} + a \\frac{u_{j+1}^{n} - u_{j-1}^{n}}{2 \\Delta x} = 0 $$\nSolving for $u_{j}^{n+1}$, we get the update rule:\n$$ u_{j}^{n+1} = u_{j}^{n} - \\frac{a \\Delta t}{2 \\Delta x} \\left( u_{j+1}^{n} - u_{j-1}^{n} \\right) $$\nWe introduce the Courant number $C = \\frac{a \\Delta t}{\\Delta x}$. The update rule becomes:\n$$ u_{j}^{n+1} = u_{j}^{n} - \\frac{C}{2} \\left( u_{j+1}^{n} - u_{j-1}^{n} \\right) $$\n\n**1. Derivation of the Amplification Factor $G(\\theta)$**\n\nTo perform the von Neumann stability analysis, we substitute the Fourier mode ansatz $u_{j}^{n} = \\widehat{u}^{\\,n}\\,\\exp(i j \\theta)$ into the difference equation. Here, $\\widehat{u}^{\\,n}$ is the amplitude of the mode at time step $n$, $j$ is the spatial index, and $\\theta = k \\Delta x$ is the non-dimensional wavenumber for a mode with wavenumber $k$.\n\nThe terms in the scheme become:\n- $u_{j}^{n+1} = \\widehat{u}^{\\,n+1}\\,\\exp(i j \\theta)$\n- $u_{j}^{n} = \\widehat{u}^{\\,n}\\,\\exp(i j \\theta)$\n- $u_{j+1}^{n} = \\widehat{u}^{\\,n}\\,\\exp(i (j+1) \\theta) = \\widehat{u}^{\\,n}\\,\\exp(i j \\theta)\\,\\exp(i \\theta)$\n- $u_{j-1}^{n} = \\widehat{u}^{\\,n}\\,\\exp(i (j-1) \\theta) = \\widehat{u}^{\\,n}\\,\\exp(i j \\theta)\\,\\exp(-i \\theta)$\n\nSubstituting these into the update rule:\n$$ \\widehat{u}^{\\,n+1}\\,\\exp(i j \\theta) = \\widehat{u}^{\\,n}\\,\\exp(i j \\theta) - \\frac{C}{2} \\left( \\widehat{u}^{\\,n}\\,\\exp(i j \\theta)\\,\\exp(i \\theta) - \\widehat{u}^{\\,n}\\,\\exp(i j \\theta)\\,\\exp(-i \\theta) \\right) $$\nDividing the entire equation by the common factor $\\widehat{u}^{\\,n}\\,\\exp(i j \\theta)$ (assuming $\\widehat{u}^{\\,n} \\neq 0$), we get the ratio of amplitudes:\n$$ \\frac{\\widehat{u}^{\\,n+1}}{\\widehat{u}^{\\,n}} = 1 - \\frac{C}{2} \\left( \\exp(i \\theta) - \\exp(-i \\theta) \\right) $$\nThe amplification factor is defined as $G(\\theta) = \\frac{\\widehat{u}^{\\,n+1}}{\\widehat{u}^{\\,n}}$. Using Euler's identity $\\sin(\\theta) = \\frac{\\exp(i \\theta) - \\exp(-i \\theta)}{2i}$, we have $\\exp(i \\theta) - \\exp(-i \\theta) = 2i \\sin(\\theta)$.\nSubstituting this into the expression for $G(\\theta)$:\n$$ G(\\theta) = 1 - \\frac{C}{2} \\left( 2i \\sin(\\theta) \\right) $$\n$$ G(\\theta) = 1 - i C \\sin(\\theta) $$\n\n**2. Derivation of the Amplification Magnitude $\\lvert G(\\theta) \\rvert$**\n\nThe amplification factor $G(\\theta)$ is a complex number. Its magnitude $\\lvert G(\\theta) \\rvert$ is found by treating it as a vector in the complex plane with real part $\\text{Re}(G) = 1$ and imaginary part $\\text{Im}(G) = -C \\sin(\\theta)$.\n$$ \\lvert G(\\theta) \\rvert = \\sqrt{(\\text{Re}(G))^2 + (\\text{Im}(G))^2} $$\n$$ \\lvert G(\\theta) \\rvert = \\sqrt{1^2 + (-C \\sin(\\theta))^2} $$\n$$ \\lvert G(\\theta) \\rvert = \\sqrt{1 + C^2 \\sin^2(\\theta)} $$\nFor stability, we require $\\lvert G(\\theta) \\rvert \\le 1$ for all $\\theta$. Since $C^2 \\ge 0$ and $\\sin^2(\\theta) \\ge 0$, the term $C^2 \\sin^2(\\theta)$ is always non-negative. Therefore, $\\lvert G(\\theta) \\rvert \\ge 1$ for all $C$ and $\\theta$. The scheme is stable only if $C^2 \\sin^2(\\theta) = 0$. Otherwise, for any $C \\ne 0$ and $\\sin(\\theta) \\ne 0$, we have $\\lvert G(\\theta) \\rvert  1$, which implies unconditional instability.\n\n**3. Finding the \"Least Unstable\" Pair $(C^{\\ast}, \\theta^{\\ast})$**\n\nWe need to find the global minimizer of the function $f(C, \\theta) = \\lvert G(\\theta) \\rvert = \\sqrt{1 + C^2 \\sin^2(\\theta)}$ on the specified domain $\\{(C,\\theta): C \\ge 0,\\ \\theta \\in [0,\\pi]\\}$.\n\nMinimizing $f(C, \\theta)$ is equivalent to minimizing its square, $f(C, \\theta)^2 = 1 + C^2 \\sin^2(\\theta)$. To minimize this expression, we need to minimize the term $C^2 \\sin^2(\\theta)$, as $1$ is a constant.\n\nThe term $C^2 \\sin^2(\\theta)$ is a product of two non-negative factors on the given domain: $C^2 \\ge 0$ and $\\sin^2(\\theta) \\ge 0$. The minimum value this term can take is $0$.\nThis minimum value of $0$ is achieved if and only if $C=0$ or $\\sin^2(\\theta)=0$.\n- If $C=0$, the condition holds for any $\\theta \\in [0, \\pi]$.\n- If $\\sin^2(\\theta)=0$, which implies $\\sin(\\theta)=0$, the condition holds for $\\theta = 0$ and $\\theta = \\pi$ within the domain $\\theta \\in [0, \\pi]$, for any $C \\ge 0$.\n\nThus, the set of global minimizers, where $\\lvert G(\\theta) \\rvert$ achieves its minimum value of $1$, is the set of pairs $(C, \\theta)$ such that $C=0$ or $\\theta \\in \\{0, \\pi\\}$.\n\nThe problem provides a tie-breaking rule for selecting a unique minimizer $(C^{\\ast}, \\theta^{\\ast})$ from this set:\n1.  Select the minimizer with the smallest value of $C$.\n    The smallest possible value for $C$ in the domain $C \\ge 0$ is $C=0$. This restricts our search to the minimizers where $C=0$. This subset of minimizers is $\\{(0, \\theta) \\mid \\theta \\in [0, \\pi]\\}$.\n\n2.  Among those, select the one with the smallest non-negative $\\theta$.\n    We are considering the set of pairs $(0, \\theta)$ for $\\theta \\in [0, \\pi]$. The smallest value of $\\theta$ in this interval is $\\theta=0$.\n\nTherefore, the unique \"least unstable\" pair according to the specified criteria is $(C^{\\ast}, \\theta^{\\ast}) = (0, 0)$.\n\nThis result is physically meaningful. The cases where $\\lvert G \\rvert = 1$ correspond to neutral stability.\n- $C=0$ implies either $a=0$ (the quantity $u$ does not advect) or $\\Delta t=0$ (time does not advance). In either case, the solution is static, and the scheme $u_j^{n+1}=u_j^n$ is trivially stable.\n- $\\theta=0$ represents the $k=0$ mode, which is a constant function in space ($u(x) = \\text{const}$). The centered difference operator acting on a constant function is zero, so $u_j^{n+1}=u_j^n$, and this mode is always preserved.\n- $\\theta=\\pi$ represents the highest frequency mode on the grid, a saw-tooth pattern. The centered difference operator also annihilates this mode, leading to $u_j^{n+1}=u_j^n$.\n\nThe specified selection rules lead us to the point $(C^{\\ast}, \\theta^{\\ast}) = (0, 0)$.", "answer": "$$\n\\boxed{\\begin{pmatrix} 0  0 \\end{pmatrix}}\n$$", "id": "3409069"}, {"introduction": "A careful analysis often reveals interesting exceptions that deepen our understanding. Although we know the FTCS scheme is unstable, this exercise focuses on two specific Fourier modes that do not grow: the zero-frequency mode (a constant value) and the Nyquist-frequency mode (a sawtooth wave). Understanding why these modes are neutrally stable provides critical insight into the properties of the central difference operator and clarifies that the overall instability is driven by the behavior of all other modes. [@problem_id:3409115]", "problem": "Consider the constant-coefficient linear advection partial differential equation (PDE) $u_{t} + a\\,u_{x} = 0$ on a one-dimensional periodic domain, where $a0$ is constant. Discretize $u(x,t)$ on a uniform spatial grid $x_{j} = j\\,\\Delta x$ with integer index $j$ and uniform time levels $t^{n} = n\\,\\Delta t$ with integer index $n$. Use the Forward-Time Central-Space (FTCS) method to approximate $u_{t}$ and $u_{x}$, yielding the explicit update\n$$\nu_{j}^{n+1} = u_{j}^{n} - \\frac{a\\,\\Delta t}{2\\,\\Delta x}\\left(u_{j+1}^{n} - u_{j-1}^{n}\\right).\n$$\nPerform a von Neumann Fourier stability analysis by assuming a single Fourier mode $u_{j}^{n} = \\hat{u}^{n}\\,\\exp\\!\\left(i\\,j\\,\\theta\\right)$, where $i$ is the imaginary unit and $\\theta \\in [-\\pi,\\pi]$ is the dimensionless grid wavenumber measured in radians. Derive the amplification factor $G(\\theta)$ defined by $\\hat{u}^{n+1} = G(\\theta)\\,\\hat{u}^{n}$, and then evaluate $G(\\theta)$ at $\\theta = 0$ and $\\theta = \\pi$ to demonstrate that $|G(0)| = |G(\\pi)| = 1$. Finally, explain, using first principles of the Fourier-mode-based analysis and properties of the central spatial difference operator, why these particular modes are neutrally stable even though the FTCS method for linear advection is globally unstable for nontrivial Fourier content.\n\nYour final answer must be the ordered pair of the two values $G(0)$ and $G(\\pi)$, reported as a single row matrix using the LaTeX $\\mathrm{pmatrix}$ environment. No rounding is required.", "solution": "The problem requires a von Neumann stability analysis of the Forward-Time Central-Space (FTCS) scheme for the linear advection equation. We must first derive the amplification factor, then evaluate it for two specific wavenumbers, and finally explain the physical and mathematical reasons for the observed neutral stability at these wavenumbers despite the scheme's overall instability.\n\nThe one-dimensional linear advection equation is given by:\n$$\nu_{t} + a\\,u_{x} = 0\n$$\nwhere $a  0$ is the constant wave speed.\n\nThe FTCS discretization is provided as:\n$$\nu_{j}^{n+1} = u_{j}^{n} - \\frac{a\\,\\Delta t}{2\\,\\Delta x}\\left(u_{j+1}^{n} - u_{j-1}^{n}\\right)\n$$\nLet us define the Courant number, $C$, as $C = \\frac{a\\,\\Delta t}{\\Delta x}$. The scheme can be written more compactly as:\n$$\nu_{j}^{n+1} = u_{j}^{n} - \\frac{C}{2}\\left(u_{j+1}^{n} - u_{j-1}^{n}\\right)\n$$\nFor the von Neumann analysis, we substitute a single Fourier mode, $u_{j}^{n} = \\hat{u}^{n}\\,\\exp(i\\,j\\,\\theta)$, into the discrete equation. Here, $\\hat{u}^{n}$ is the amplitude of the mode at time level $n$, $j$ is the spatial grid index, $\\theta = k_g \\Delta x$ is the dimensionless grid wavenumber, and $i = \\sqrt{-1}$.\n\nThe terms in the scheme become:\n- $u_{j}^{n+1} \\rightarrow \\hat{u}^{n+1}\\,\\exp(i\\,j\\,\\theta)$\n- $u_{j}^{n} \\rightarrow \\hat{u}^{n}\\,\\exp(i\\,j\\,\\theta)$\n- $u_{j+1}^{n} \\rightarrow \\hat{u}^{n}\\,\\exp(i\\,(j+1)\\,\\theta) = \\hat{u}^{n}\\,\\exp(i\\,j\\,\\theta)\\,\\exp(i\\,\\theta)$\n- $u_{j-1}^{n} \\rightarrow \\hat{u}^{n}\\,\\exp(i\\,(j-1)\\,\\theta) = \\hat{u}^{n}\\,\\exp(i\\,j\\,\\theta)\\,\\exp(-i\\,\\theta)$\n\nSubstituting these into the FTCS equation yields:\n$$\n\\hat{u}^{n+1}\\,\\exp(i\\,j\\,\\theta) = \\hat{u}^{n}\\,\\exp(i\\,j\\,\\theta) - \\frac{C}{2}\\left(\\hat{u}^{n}\\,\\exp(i\\,j\\,\\theta)\\,\\exp(i\\,\\theta) - \\hat{u}^{n}\\,\\exp(i\\,j\\,\\theta)\\,\\exp(-i\\,\\theta)\\right)\n$$\nDividing the entire equation by the common factor $\\hat{u}^{n}\\,\\exp(i\\,j\\,\\theta)$ (for non-trivial modes), we get the ratio of amplitudes:\n$$\n\\frac{\\hat{u}^{n+1}}{\\hat{u}^{n}} = 1 - \\frac{C}{2}\\left(\\exp(i\\,\\theta) - \\exp(-i\\,\\theta)\\right)\n$$\nThe amplification factor, $G(\\theta)$, is defined as $G(\\theta) = \\frac{\\hat{u}^{n+1}}{\\hat{u}^{n}}$. Using Euler's formula, $\\sin(\\theta) = \\frac{\\exp(i\\,\\theta) - \\exp(-i\\,\\theta)}{2i}$, we can simplify the expression in the parenthesis: $\\exp(i\\,\\theta) - \\exp(-i\\,\\theta) = 2i\\sin(\\theta)$.\nSubstituting this back, we obtain the amplification factor:\n$$\nG(\\theta) = 1 - \\frac{C}{2}\\left(2i\\sin(\\theta)\\right) = 1 - iC\\sin(\\theta)\n$$\nNow, we evaluate $G(\\theta)$ and its magnitude for the specific wavenumbers $\\theta = 0$ and $\\theta = \\pi$.\n\nFor $\\theta = 0$:\n$$\nG(0) = 1 - iC\\sin(0) = 1 - iC(0) = 1\n$$\nThe magnitude is $|G(0)| = |1| = 1$.\n\nFor $\\theta = \\pi$:\n$$\nG(\\pi) = 1 - iC\\sin(\\pi) = 1 - iC(0) = 1\n$$\nThe magnitude is $|G(\\pi)| = |1| = 1$.\n\nIn both cases, the magnitude of the amplification factor is exactly $1$, which signifies neutral stability. The amplitude of these Fourier modes does not change from one time step to the next.\n\nFinally, we must explain this result. The FTCS scheme for linear advection is known to be unconditionally unstable. To see this, we examine the magnitude of $G(\\theta)$ for an arbitrary $\\theta$:\n$$\n|G(\\theta)| = |1 - iC\\sin(\\theta)| = \\sqrt{1^2 + (-C\\sin(\\theta))^2} = \\sqrt{1 + C^2\\sin^2(\\theta)}\n$$\nFor the scheme to be stable, the von Neumann condition requires $|G(\\theta)| \\le 1$ for all $\\theta \\in [-\\pi, \\pi]$. However, since $C = \\frac{a\\Delta t}{\\Delta x}  0$, the term $C^2\\sin^2(\\theta)$ is non-negative. It is strictly positive for any $\\theta$ that is not an integer multiple of $\\pi$. Therefore, for any $\\theta \\in (-\\pi, 0) \\cup (0, \\pi)$, we have $|G(\\theta)|  1$. This means that any Fourier mode, except for those with $\\theta = 0$ or $\\theta = \\pi$, will grow exponentially in amplitude, rendering the scheme unstable.\n\nThe neutral stability of the $\\theta=0$ and $\\theta=\\pi$ modes is an artifact of the central difference operator, $\\delta_{2x} u_j = \\frac{u_{j+1} - u_{j-1}}{2\\Delta x}$, used to approximate the spatial derivative $u_x$.\n1.  **The case $\\theta = 0$:** This wavenumber corresponds to a mode $u_j = \\hat{u}^n \\exp(i j \\cdot 0) = \\hat{u}^n$, which is a constant value across all spatial grid points (a DC component). The spatial derivative of a constant is zero. The central difference operator correctly reproduces this: $\\delta_{2x} (\\text{const.}) = \\frac{\\text{const.} - \\text{const.}}{2\\Delta x} = 0$. The FTCS scheme for this mode thus reduces to $u_j^{n+1} = u_j^n - 0$, which is $u_j^{n+1} = u_j^n$. The mode is exactly preserved, yielding $G(0)=1$.\n\n2.  **The case $\\theta = \\pi$:** This wavenumber corresponds to the highest frequency mode representable on the grid, $u_j = \\hat{u}^n \\exp(i j \\pi) = \\hat{u}^n (-1)^j$. This mode represents a sawtooth pattern that alternates sign at every grid point (e.g., $..., 1, -1, 1, -1, ...$). When we apply the central difference operator to this mode, we get:\n    $$\n    \\delta_{2x} u_j = \\frac{u_{j+1} - u_{j-1}}{2\\Delta x} = \\frac{\\hat{u}^n (-1)^{j+1} - \\hat{u}^n (-1)^{j-1}}{2\\Delta x}\n    $$\n    Since $(-1)^{j+1} = -(-1)^j$ and $(-1)^{j-1} = (-1)^j(-1)^{-1} = -(-1)^j$, the two neighbors have the same value, $u_{j+1} = u_{j-1}$. Thus, the numerator becomes zero. The central difference operator effectively \"sees\" this highly oscillatory mode as being locally constant and incorrectly calculates its derivative as zero. This annihilation of the Nyquist frequency mode is a known property of the standard second-order central difference stencil. As with the $\\theta=0$ case, the spatial derivative term in the FTCS equation vanishes, leading to $u_j^{n+1} = u_j^n$ and an amplification factor $G(\\pi)=1$.\n\nIn conclusion, the neutral stability observed for $\\theta=0$ and $\\theta=\\pi$ is not a sign of the scheme's viability but a specific property of the central difference operator, which is \"blind\" to these two modes. For all other modes that comprise a non-trivial solution, their amplitudes grow without bound, causing the overall numerical solution to become unstable.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1  1\n\\end{pmatrix}\n}\n$$", "id": "3409115"}, {"introduction": "Beyond simply labeling a scheme 'unstable', a more profound understanding comes from quantifying the rate of this instability. This advanced practice recasts the stability analysis as an optimization problem: what is the worst-case scenario? By identifying the initial condition that maximizes the growth of the solution's energy, you will connect the abstract concept of the amplification factor to the tangible and often catastrophic blow-up of the numerical solution. [@problem_id:3409078]", "problem": "Consider the linear advection equation $u_t + a\\,u_x = 0$ on a periodic spatial domain, where $a \\in \\mathbb{R}$ is a constant advection speed. Discretize space on a uniform grid $x_j = j\\,\\Delta x$ for $j = 0, 1, \\dots, M-1$ with periodic indexing, and discretize time with step size $\\Delta t  0$. Let $u_j^n$ denote the numerical approximation to $u(x_j, n\\,\\Delta t)$. Evolve the numerical solution using the Forward Time, Centered Space (FTCS) scheme\n$$\nu_j^{n+1} \\;=\\; u_j^n \\;-\\; \\frac{a\\,\\Delta t}{2\\,\\Delta x}\\,\\Big(u_{j+1}^n - u_{j-1}^n\\Big),\n$$\nfor $n = 0, 1, \\dots, N-1$, with $N \\in \\mathbb{N}$ fixed and $M \\ge 4$ a multiple of $4$. Define the discrete $\\ell^2$-norm by $\\|u^n\\|_2^2 = \\sum_{j=0}^{M-1} |u_j^n|^2$ and impose the energy constraint $\\sum_{j=0}^{M-1} |u_j^0|^2 = 1$ on the initial data.\n\nFormulate and solve the optimization problem of maximizing $\\|u^N\\|_2$ over all initial data satisfying the energy constraint. Derive, from first principles and without invoking any pre-stated stability formulas, the exact value of the maximum possible $\\|u^N\\|_2$ in terms of $a$, $\\Delta t$, $\\Delta x$, and $N$. Express your final answer as a single closed-form analytic expression in $a$, $\\Delta t$, $\\Delta x$, and $N$. No rounding is required, and no units are to be included.", "solution": "The problem requires us to find the maximum possible value of the discrete $\\ell^2$-norm of a numerical solution, $\\|u^N\\|_2$, after $N$ time steps of the Forward Time, Centered Space (FTCS) scheme, starting from an initial condition $u^0$ with a constrained unit norm, $\\|u^0\\|_2 = 1$.\n\nLet the vector of numerical values at time step $n$ be denoted by $U^n = [u_0^n, u_1^n, \\dots, u_{M-1}^n]^T$. The FTCS scheme is given by the equation:\n$$\nu_j^{n+1} = u_j^n - \\frac{a\\,\\Delta t}{2\\,\\Delta x}\\,\\Big(u_{j+1}^n - u_{j-1}^n\\Big)\n$$\nLet's define the Courant number as $c_r = \\frac{a\\,\\Delta t}{\\Delta x}$. The scheme becomes:\n$$\nu_j^{n+1} = u_j^n - \\frac{c_r}{2}\\,(u_{j+1}^n - u_{j-1}^n)\n$$\nDue to the periodic boundary conditions (e.g., $u_{M}^n = u_0^n$ and $u_{-1}^n = u_{M-1}^n$), this linear scheme can be represented by a matrix-vector multiplication $U^{n+1} = L U^n$, where $L$ is an $M \\times M$ circulant matrix. After $N$ steps, the solution is $U^N = L^N U^0$.\n\nThe optimization problem is to find $\\max_{\\|U^0\\|_2=1} \\|U^N\\|_2$. By definition, this maximum value is the induced $2$-norm of the matrix $L^N$, which is denoted by $\\|L^N\\|_2$. The matrix $L$ representing the FTCS scheme on a periodic grid is a circulant matrix. A circulant matrix is a normal matrix, meaning it commutes with its conjugate transpose ($L^*L = LL^*$). For a normal matrix, the $2$-norm of its power is the power of its $2$-norm: $\\|L^N\\|_2 = (\\|L\\|_2)^N$. Furthermore, the induced $2$-norm of a normal matrix is equal to its spectral radius, $\\rho(L)$, which is the maximum absolute value of its eigenvalues. Therefore, our task simplifies to calculating $(\\rho(L))^N$.\n\nTo find the eigenvalues of $L$ from first principles, we perform a discrete Fourier analysis, often called von Neumann stability analysis. We seek solutions of the form of a single Fourier mode:\n$$\nu_j^n = (g(k))^n e^{i k x_j} = (g(k))^n e^{i k j \\Delta x}\n$$\nHere, $k$ is the wavenumber and $g(k)$ is the amplification factor for that mode, which corresponds to an eigenvalue of $L$. The periodic boundary conditions $u_{j+M}^n = u_j^n$ imply that $e^{i k M \\Delta x} = 1$. This quantizes the wavenumbers, allowing only discrete values $k_m = \\frac{2\\pi m}{M \\Delta x}$ for integer modes $m = 0, 1, \\dots, M-1$.\n\nSubstituting the Fourier mode ansatz into the FTCS scheme gives:\n$$\n(g(k))^{n+1} e^{i k j \\Delta x} = (g(k))^n e^{i k j \\Delta x} - \\frac{c_r}{2} \\left[ (g(k))^n e^{i k (j+1) \\Delta x} - (g(k))^n e^{i k (j-1) \\Delta x} \\right]\n$$\nDividing the entire equation by $(g(k))^n e^{i k j \\Delta x}$ (for non-trivial solutions) yields the expression for the amplification factor $g(k)$:\n$$\ng(k) = 1 - \\frac{c_r}{2} \\left( e^{i k \\Delta x} - e^{-i k \\Delta x} \\right)\n$$\nUsing Euler's formula, $e^{i\\theta} - e^{-i\\theta} = 2i\\sin(\\theta)$, with $\\theta = k \\Delta x$, we get:\n$$\ng(k) = 1 - \\frac{c_r}{2} (2i \\sin(k \\Delta x)) = 1 - i c_r \\sin(k \\Delta x)\n$$\nThe spectral radius $\\rho(L)$ is the maximum of the modulus $|g(k)|$ over all allowed discrete wavenumbers $k_m$:\n$$\n\\rho(L) = \\max_{m \\in \\{0, \\dots, M-1\\}} |g(k_m)|\n$$\nWe compute the modulus of $g(k)$:\n$$\n|g(k)| = |1 - i c_r \\sin(k \\Delta x)| = \\sqrt{1^2 + (-c_r \\sin(k \\Delta x))^2} = \\sqrt{1 + c_r^2 \\sin^2(k \\Delta x)}\n$$\nTo maximize $|g(k)|$, we must maximize the term $\\sin^2(k \\Delta x)$. The maximum value of $\\sin^2(\\theta)$ is $1$. This maximum is attained when $\\theta = k \\Delta x = \\frac{\\pi}{2} + p\\pi$ for any integer $p$. We must verify that such a mode exists on our discrete grid. The discrete spatial frequencies are $\\theta_m = k_m \\Delta x = \\frac{2\\pi m}{M}$ for $m = 0, 1, \\dots, M-1$. We need to determine if there is an integer $m$ in this range such that $\\frac{2\\pi m}{M} = \\frac{\\pi}{2}$ or $\\frac{2\\pi m}{M} = \\frac{3\\pi}{2}$, etc.\nFrom $\\frac{2\\pi m}{M} = \\frac{\\pi}{2}$, we find $m = M/4$.\nFrom $\\frac{2\\pi m}{M} = \\frac{3\\pi}{2}$, we find $m = 3M/4$.\nThe problem statement specifies that $M$ is a multiple of $4$. This crucial condition guarantees that $M/4$ and $3M/4$ are integers. Since the problem also states $M \\ge 4$, these integer values for $m$ fall within the valid range $\\{1, \\dots, M-1\\}$. Consequently, there exist modes on the grid for which $\\sin^2(k_m \\Delta x)$ achieves its maximum value of $1$.\n\nThe maximum value of $|g(k)|$, the spectral radius, is therefore:\n$$\n\\rho(L) = \\max_k |g(k)| = \\sqrt{1 + c_r^2 \\cdot (1)} = \\sqrt{1 + c_r^2}\n$$\nSubstituting back the definition of the Courant number, $c_r = \\frac{a \\Delta t}{\\Delta x}$:\n$$\n\\rho(L) = \\sqrt{1 + \\left(\\frac{a \\Delta t}{\\Delta x}\\right)^2}\n$$\nThe maximum value for $\\|u^N\\|_2$ given $\\|u^0\\|_2=1$ is $\\|L^N\\|_2 = (\\rho(L))^N$. This maximum is attained when the initial data $u^0$ is an eigenvector corresponding to an eigenvalue with the maximal modulus, for instance, the Fourier mode with $m = M/4$.\nThe exact maximum value is:\n$$\n\\max_{\\|u^0\\|_2=1} \\|u^N\\|_2 = \\left( \\sqrt{1 + \\left(\\frac{a \\Delta t}{\\Delta x}\\right)^2} \\right)^N = \\left( 1 + \\left(\\frac{a \\Delta t}{\\Delta x}\\right)^2 \\right)^{N/2}\n$$\nThis expression provides the maximum possible $\\ell^2$-norm of the solution after $N$ steps in terms of the given parameters.", "answer": "$$\n\\boxed{\\left(1 + \\left(\\frac{a \\Delta t}{\\Delta x}\\right)^2\\right)^{N/2}}\n$$", "id": "3409078"}]}