{"hands_on_practices": [{"introduction": "Before we can use a numerical tool, we must understand how it is constructed. This first practice guides you through the foundational process of deriving the weights for a generalized 9-point stencil from first principles. Using Taylor series expansions, you will impose conditions to ensure the stencil is a consistent approximation of the Laplacian, and you will see how to engineer the coefficients to achieve a higher order of accuracy, a key goal in designing efficient numerical methods. [@problem_id:3454092]", "problem": "Consider the two-dimensional Laplacian operator $\\Delta u = u_{xx} + u_{yy}$ to be approximated on a rectangular Cartesian grid with spacings $h_x > 0$ and $h_y > 0$. Let the approximation be constructed by a symmetric $9$-point stencil centered at a grid point $(x_i,y_j)$, using the grid values at the center, the four axis-aligned neighbors, and the four diagonal neighbors. Assume the stencil has the form\n$$\n\\mathcal{L}_{9}[u] = a\\,u_{i,j} + b_x\\left(u_{i+1,j} + u_{i-1,j}\\right) + b_y\\left(u_{i,j+1} + u_{i,j-1}\\right) + c\\left(u_{i+1,j+1} + u_{i+1,j-1} + u_{i-1,j+1} + u_{i-1,j-1}\\right),\n$$\nwhere $a$, $b_x$, $b_y$, and $c$ are weights that may depend on $h_x$ and $h_y$ but not on $u$. Starting from Taylor series expansions and the definition of the Laplacian, derive explicit expressions for the weights $a$, $b_x$, $b_y$, and $c$ such that:\n- the operator $\\mathcal{L}_{9}[u]$ is consistent with $\\Delta u$ (that is, it exactly reproduces $\\Delta u$ at leading order) for arbitrary smooth $u$,\n- the truncation error is second-order accurate (that is, $\\mathcal{O}(h_x^{2} + h_y^{2})$) for general smooth $u$ on rectangular grids,\n- when $h_x = h_y$, the leading truncation error becomes proportional to $\\Delta(\\Delta u)$, rendering the discretization fourth-order accurate for harmonic functions satisfying $\\Delta u = 0$.\n\nProvide your final answer as the four distinct weights in the order $(a, b_x, b_y, c)$ as a single analytical expression. No numerical approximation or rounding is required. Define any acronym you use explicitly on its first appearance, for example, Partial Differential Equation (PDE).", "solution": "The problem as stated is scientifically grounded, well-posed, objective, and contains sufficient information for a unique solution. It is a standard problem in the field of numerical methods for Partial Differential Equations (PDEs). Thus, the problem is valid and I will proceed with a full derivation.\n\nThe objective is to find the weights $a$, $b_x$, $b_y$, and $c$ for the $9$-point stencil operator $\\mathcal{L}_{9}[u]$ such that it approximates the two-dimensional Laplacian $\\Delta u = u_{xx} + u_{yy}$. The stencil is given by:\n$$\n\\mathcal{L}_{9}[u] = a\\,u_{i,j} + b_x\\left(u_{i+1,j} + u_{i-1,j}\\right) + b_y\\left(u_{i,j+1} + u_{i,j-1}\\right) + c\\left(u_{i+1,j+1} + u_{i+1,j-1} + u_{i-1,j+1} + u_{i-1,j-1}\\right)\n$$\nTo determine the weights, we expand each term $u_{i+p,j+q}$ in a Taylor series around the central point $(x_i, y_j) = (i h_x, j h_y)$, where $u_{i,j} = u(x_i, y_j)$. We assume the function $u(x,y)$ is sufficiently smooth. Let partial derivatives at $(x_i, y_j)$ be denoted by subscripts, e.g., $u_{x} = \\frac{\\partial u}{\\partial x}$, $u_{xx} = \\frac{\\partial^2 u}{\\partial x^2}$.\n\nThe Taylor series expansions for the neighboring points, grouped for the stencil, are:\n\\begin{align*}\nu_{i+1,j} + u_{i-1,j} &= 2u_{i,j} + h_x^2 u_{xx} + \\frac{h_x^4}{12} u_{xxxx} + \\frac{h_x^6}{360} u_{xxxxxx} + \\mathcal{O}(h_x^8) \\\\\nu_{i,j+1} + u_{i,j-1} &= 2u_{i,j} + h_y^2 u_{yy} + \\frac{h_y^4}{12} u_{yyyy} + \\frac{h_y^6}{360} u_{yyyyyy} + \\mathcal{O}(h_y^8)\n\\end{align*}\nFor the diagonal neighbors, the sum is:\n\\begin{align*}\n&u_{i+1,j+1} + u_{i+1,j-1} + u_{i-1,j+1} + u_{i-1,j-1} \\\\\n&= 4u_{i,j} + 2(h_x^2 u_{xx} + h_y^2 u_{yy}) + \\frac{1}{6}(h_x^4 u_{xxxx} + 6h_x^2 h_y^2 u_{xxyy} + h_y^4 u_{yyyy}) \\\\\n&+ \\frac{1}{180}(h_x^6 u_{xxxxxx} + 15h_x^4 h_y^2 u_{xxxxyy} + 15h_x^2 h_y^4 u_{xxyyyy} + h_y^6 u_{yyyyyy}) + \\mathcal{O}(h^8)\n\\end{align*}\n\nSubstituting these expansions into the expression for $\\mathcal{L}_{9}[u]$ and collecting terms by derivatives of $u$:\n\\begin{align*}\n\\mathcal{L}_{9}[u] &= (a + 2b_x + 2b_y + 4c)u_{i,j} \\\\\n&+ (b_x h_x^2 + 2c h_x^2)u_{xx} + (b_y h_y^2 + 2c h_y^2)u_{yy} \\\\\n&+ \\left(\\frac{b_x h_x^4}{12} + \\frac{c h_x^4}{6}\\right)u_{xxxx} + \\left(\\frac{b_y h_y^4}{12} + \\frac{c h_y^4}{6}\\right)u_{yyyy} + c(h_x^2 h_y^2)u_{xxyy} \\\\\n&+ \\mathcal{O}(h^6)\n\\end{align*}\n\nWe now impose the conditions given in the problem.\nThe first condition is that $\\mathcal{L}_{9}[u]$ must be consistent with $\\Delta u = u_{xx} + u_{yy}$. This means the coefficients of the leading derivative terms in the expansion of $\\mathcal{L}_{9}[u]$ must match those of $\\Delta u$, and lower-order terms must vanish.\n\\begin{enumerate}\n    \\item Coefficient of $u$: $a + 2b_x + 2b_y + 4c = 0$\n    \\item Coefficient of $u_{xx}$: $b_x h_x^2 + 2c h_x^2 = 1 \\implies b_x + 2c = \\frac{1}{h_x^2}$\n    \\item Coefficient of $u_{yy}$: $b_y h_y^2 + 2c h_y^2 = 1 \\implies b_y + 2c = \\frac{1}{h_y^2}$\n\\end{enumerate}\nThese three equations relate the four unknown weights. We can express $a$, $b_x$, and $b_y$ in terms of $c$:\nFrom (2), $b_x = \\frac{1}{h_x^2} - 2c$.\nFrom (3), $b_y = \\frac{1}{h_y^2} - 2c$.\nSubstituting these into (1):\n$a + 2\\left(\\frac{1}{h_x^2} - 2c\\right) + 2\\left(\\frac{1}{h_y^2} - 2c\\right) + 4c = 0$\n$a + \\frac{2}{h_x^2} - 4c + \\frac{2}{h_y^2} - 4c + 4c = 0$\n$a = -\\frac{2}{h_x^2} - \\frac{2}{h_y^2} + 4c$.\n\nWith these coefficients, the truncation error $\\mathcal{T} = \\mathcal{L}_{9}[u] - \\Delta u$ has its leading terms given by the fourth-order derivatives:\n$\\mathcal{T} = \\left(\\frac{b_x h_x^4}{12} + \\frac{c h_x^4}{6}\\right)u_{xxxx} + \\left(\\frac{b_y h_y^4}{12} + \\frac{c h_y^4}{6}\\right)u_{yyyy} + c h_x^2 h_y^2 u_{xxyy} + \\mathcal{O}(h^4)$.\nSubstitute the expressions for $b_x$ and $b_y$:\nCoefficient of $u_{xxxx}$: $\\frac{h_x^4}{12}\\left(\\frac{1}{h_x^2} - 2c\\right) + \\frac{ch_x^4}{6} = \\frac{h_x^2}{12} - \\frac{2ch_x^4}{12} + \\frac{2ch_x^4}{12} = \\frac{h_x^2}{12}$.\nCoefficient of $u_{yyyy}$: $\\frac{h_y^4}{12}\\left(\\frac{1}{h_y^2} - 2c\\right) + \\frac{ch_y^4}{6} = \\frac{h_y^2}{12} - \\frac{2ch_y^4}{12} + \\frac{2ch_y^4}{12} = \\frac{h_y^2}{12}$.\nSo, the leading truncation error is:\n$$\n\\mathcal{T} = \\frac{h_x^2}{12} u_{xxxx} + \\frac{h_y^2}{12} u_{yyyy} + c h_x^2 h_y^2 u_{xxyy} + \\mathcal{O}(h^4)\n$$\nThis is of order $\\mathcal{O}(h_x^2 + h_y^2)$, which satisfies the second condition of the problem.\n\nThe third condition provides the means to determine $c$. When $h_x = h_y = h$, the leading truncation error must be proportional to the biharmonic operator applied to $u$, $\\Delta(\\Delta u) = u_{xxxx} + 2u_{xxyy} + u_{yyyy}$.\nSetting $h_x = h_y = h$ in the expression for $\\mathcal{T}$:\n$$\n\\mathcal{T}|_{h_x=h_y=h} = \\frac{h^2}{12} u_{xxxx} + \\frac{h^2}{12} u_{yyyy} + c(h,h) h^4 u_{xxyy} + \\mathcal{O}(h^4)\n$$\nFor this to be proportional to $\\Delta(\\Delta u)$, we must have:\n$$\n\\frac{h^2}{12} u_{xxxx} + \\frac{h^2}{12} u_{yyyy} + c h^4 u_{xxyy} = K (u_{xxxx} + 2u_{xxyy} + u_{yyyy})\n$$\nfor some factor of proportionality $K$. Equating the coefficients of the partial derivatives:\n- $u_{xxxx}$: $\\frac{h^2}{12} = K$\n- $u_{yyyy}$: $\\frac{h^2}{12} = K$\n- $u_{xxyy}$: $c h^4 = 2K$\n\nFrom these relations, we find $K = \\frac{h^2}{12}$, which then gives $c h^4 = 2\\left(\\frac{h^2}{12}\\right) = \\frac{h^2}{6}$. This implies that for a square grid, $c = \\frac{1}{6h^2}$.\nWith this choice, the truncation error becomes $\\mathcal{T}|_h = \\frac{h^2}{12} \\Delta (\\Delta u) + \\mathcal{O}(h^4)$. For a harmonic function, where $\\Delta u = 0$, it follows that $\\Delta(\\Delta u) = \\Delta(0) = 0$. The $\\mathcal{O}(h^2)$ error term vanishes, and the approximation becomes fourth-order accurate, as required.\n\nTo find the expressions for general $h_x, h_y$, we need a form for $c(h_x, h_y)$ that reduces to $c = \\frac{1}{6h^2}$ when $h_x=h_y=h$. A standard method for constructing such high-order schemes is to make the truncation error have a desirable structure. The choice $c = \\frac{h_x^2 + h_y^2}{12 h_x^2 h_y^2}$ achieves a desirable structure for the truncation error. Let's verify this choice.\nIf $h_x=h_y=h$, then $c = \\frac{h^2+h^2}{12 h^2 h^2} = \\frac{2h^2}{12h^4} = \\frac{1}{6h^2}$. This is consistent with our finding for the square grid.\nThus we fix the expression for $c$:\n$$\nc = \\frac{h_x^2 + h_y^2}{12 h_x^2 h_y^2} = \\frac{1}{12}\\left(\\frac{1}{h_y^2} + \\frac{1}{h_x^2}\\right)\n$$\nNow we can find the definitive expressions for the other weights:\n$b_x = \\frac{1}{h_x^2} - 2c = \\frac{1}{h_x^2} - \\frac{2(h_x^2+h_y^2)}{12 h_x^2 h_y^2} = \\frac{1}{h_x^2} - \\frac{h_x^2+h_y^2}{6 h_x^2 h_y^2} = \\frac{6h_y^2 - (h_x^2+h_y^2)}{6 h_x^2 h_y^2} = \\frac{5h_y^2 - h_x^2}{6 h_x^2 h_y^2}$.\nThis can also be written as $b_x = \\frac{5}{6h_x^2} - \\frac{1}{6h_y^2}$.\n\nBy symmetry, swapping $h_x$ and $h_y$:\n$b_y = \\frac{5h_x^2 - h_y^2}{6 h_x^2 h_y^2}$, or $b_y = \\frac{5}{6h_y^2} - \\frac{1}{6h_x^2}$.\n\nFinally, for $a$:\n$a = -\\frac{2}{h_x^2} - \\frac{2}{h_y^2} + 4c = -\\frac{2}{h_x^2} - \\frac{2}{h_y^2} + \\frac{4(h_x^2+h_y^2)}{12 h_x^2 h_y^2} = -\\frac{2}{h_x^2} - \\frac{2}{h_y^2} + \\frac{h_x^2+h_y^2}{3 h_x^2 h_y^2}$\nPutting terms over a common denominator $3h_x^2 h_y^2$:\n$a = \\frac{-6h_y^2 - 6h_x^2 + h_x^2 + h_y^2}{3 h_x^2 h_y^2} = \\frac{-5h_x^2 - 5h_y^2}{3 h_x^2 h_y^2} = -\\frac{5}{3}\\left(\\frac{1}{h_y^2} + \\frac{1}{h_x^2}\\right)$.\n\nThe four weights have been uniquely determined according to the problem's constraints.\n\nThe final expressions are:\n$a = -\\frac{5}{3}\\left(\\frac{1}{h_x^2} + \\frac{1}{h_y^2}\\right)$\n$b_x = \\frac{5}{6h_x^2} - \\frac{1}{6h_y^2}$\n$b_y = \\frac{5}{6h_y^2} - \\frac{1}{6h_x^2}$\n$c = \\frac{1}{12h_x^2} + \\frac{1}{12h_y^2}$", "answer": "$$\n\\boxed{\\begin{pmatrix} -\\frac{5}{3}\\left(\\frac{1}{h_x^2} + \\frac{1}{h_y^2}\\right) & \\frac{5}{6h_x^2} - \\frac{1}{6h_y^2} & \\frac{5}{6h_y^2} - \\frac{1}{6h_x^2} & \\frac{1}{12h_x^2} + \\frac{1}{12h_y^2} \\end{pmatrix}}\n$$", "id": "3454092"}, {"introduction": "Applying a stencil across a computational grid generates a large system of linear equations, and the structure of this system is paramount for solving it efficiently. This exercise bridges the gap between the local stencil and the global matrix, asking you to determine key properties like bandwidth and the total number of non-zero entries. This practice is crucial for developing an intuition for the computational cost and memory requirements associated with finite difference discretizations. [@problem_id:3454114]", "problem": "Consider the two-dimensional Laplacian operator $\\Delta$ on the unit square $\\Omega = (0,1) \\times (0,1)$ with homogeneous Dirichlet boundary conditions, and the elliptic boundary value problem $-\\Delta u = f$ on $\\Omega$. Discretize $\\Omega$ using a uniform Cartesian grid of $n \\times n$ interior points with mesh spacing $h = \\frac{1}{n+1}$, and approximate the Laplacian by the standard nine-point finite difference stencil that couples each grid point to its eight nearest neighbors (the four axis-aligned and the four diagonal neighbors). Let the unknowns be ordered lexicographically by rows (row-major order), so that the scalar unknown at the grid point with coordinates $(p,q)$, where $1 \\leq p,q \\leq n$, is mapped to the linear index\n$$\nI(p,q) = (q-1)n + p \\in \\{1,2,\\dots,n^2\\}.\n$$\nDenote by $A \\in \\mathbb{R}^{n^2 \\times n^2}$ the resulting sparse, symmetric system matrix defined by this nine-point stencil on the $n \\times n$ grid. Using the above ordering, describe the sparsity pattern of $A$ by identifying the set of diagonal offsets (in terms of index differences) on which nonzero entries can appear, and derive from first principles the matrix bandwidth. In this problem, the bandwidth $b$ is defined in terms of the lower half-bandwidth $\\ell$ and upper half-bandwidth $u$ by $b = \\ell + u + 1$, where\n$$\n\\ell = \\max\\{\\, i-j \\,:\\, 1 \\leq j \\leq i \\leq n^2,\\ a_{ij} \\neq 0 \\,\\}, \\qquad\nu = \\max\\{\\, j-i \\,:\\, 1 \\leq i \\leq j \\leq n^2,\\ a_{ij} \\neq 0 \\,\\}.\n$$\nAdditionally, compute the exact total number of nonzero entries in $A$ as a function of $n$ by classifying grid points according to their location (corner, edge, or interior) and summing their row-wise nonzero counts. Assume $n \\geq 2$ so that edge and corner cases are present. Express your final answer as a pair giving first the bandwidth $b$ and second the total number of nonzeros $\\operatorname{nnz}(A)$ in closed form. No numerical rounding is required, and no physical units apply. Provide the final answer as a single row matrix containing these two expressions.", "solution": "The problem asks for the bandwidth and the total number of nonzero entries of the system matrix $A$ resulting from a nine-point finite difference discretization of the two-dimensional Laplacian on a uniform grid with lexicographical ordering of the unknowns.\n\nThe problem is well-posed, scientifically grounded, and provides all necessary information for a unique solution. We may proceed.\n\nLet the interior of the domain be discretized by a uniform grid of $n \\times n$ points, indexed by $(p,q)$ where $1 \\leq p,q \\leq n$. The Cartesian coordinates of these points are $(x_p, y_q) = (ph, qh)$ with mesh spacing $h = \\frac{1}{n+1}$. The unknowns $u(x_p, y_q)$ are denoted by $u_{p,q}$.\n\nThe nine-point stencil for the Laplacian at a point $(p,q)$ involves the point itself and its eight nearest neighbors: $(p\\pm1, q)$, $(p, q\\pm1)$, and $(p\\pm1, q\\pm1)$. The discrete equation at point $(p,q)$ is a linear combination of the values $u_{p',q'}$ where $(p',q')$ is in the stencil of $(p,q)$.\n\nThe unknowns are ordered lexicographically (row-major), mapping the two-dimensional grid index $(p,q)$ to a one-dimensional linear index $i$ for the matrix system:\n$$\ni = I(p,q) = (q-1)n + p\n$$\nThe resulting linear system is $A\\mathbf{u} = \\mathbf{f}$, where $A$ is an $n^2 \\times n^2$ matrix. An entry $a_{ij}$ of $A$ is nonzero if and only if the unknown corresponding to index $j$ appears in the discrete equation for the unknown at index $i$. Let $i=I(p,q)$ and $j=I(p',q')$. $a_{ij} \\neq 0$ if $(p',q')$ is one of the grid points in the stencil centered at $(p,q)$. The main diagonal entry $a_{ii}$ is always nonzero.\n\n**Part 1: Sparsity Pattern and Bandwidth**\n\nTo determine the sparsity pattern and bandwidth, we analyze the difference in linear indices, $j-i$, for all neighboring points $(p',q')$ in the stencil of a generic point $(p,q)$. Let $p' = p + \\Delta p$ and $q' = q + \\Delta q$, where $\\Delta p, \\Delta q \\in \\{-1, 0, 1\\}$ (but not both zero).\n\nThe index difference is:\n$$\nj-i = I(p+\\Delta p, q+\\Delta q) - I(p,q) = ((q+\\Delta q)-1)n + (p+\\Delta p) - ((q-1)n+p)\n$$\n$$\nj-i = (q-1)n + (\\Delta q)n + p + \\Delta p - (q-1)n - p = (\\Delta q)n + \\Delta p\n$$\nWe now list the index differences for the eight neighbors:\n1.  Axial neighbors:\n    -   Right neighbor: $(\\Delta p, \\Delta q) = (1, 0) \\implies j-i = (0)n + 1 = 1$.\n    -   Left neighbor: $(\\Delta p, \\Delta q) = (-1, 0) \\implies j-i = (0)n - 1 = -1$.\n    -   Top neighbor: $(\\Delta p, \\Delta q) = (0, 1) \\implies j-i = (1)n + 0 = n$.\n    -   Bottom neighbor: $(\\Delta p, \\Delta q) = (0, -1) \\implies j-i = (-1)n + 0 = -n$.\n2.  Diagonal neighbors:\n    -   Top-right neighbor: $(\\Delta p, \\Delta q) = (1, 1) \\implies j-i = (1)n + 1 = n+1$.\n    -   Top-left neighbor: $(\\Delta p, \\Delta q) = (-1, 1) \\implies j-i = (1)n - 1 = n-1$.\n    -   Bottom-right neighbor: $(\\Delta p, \\Delta q) = (1, -1) \\implies j-i = (-1)n + 1 = -n+1$.\n    -   Bottom-left neighbor: $(\\Delta p, \\Delta q) = (-1, -1) \\implies j-i = (-1)n - 1 = -n-1$.\n\nThese differences represent the offsets from the main diagonal where nonzero entries can appear. The set of all possible offsets for nonzero entries is $\\{0, \\pm 1, \\pm(n-1), \\pm n, \\pm(n+1)\\}$.\n\nThe bandwidth $b$ is defined as $b = \\ell + u + 1$, based on the lower and upper half-bandwidths:\n-   The lower half-bandwidth is $\\ell = \\max\\{i-j \\mid a_{ij} \\neq 0, i \\geq j\\}$. This is the maximum of $-(j-i)$ for non-positive offsets $j-i$. The set of non-positive offsets is $\\{0, -1, -n+1, -n, -(n+1)\\}$. The maximum value of $i-j$ is thus $\\max\\{0, 1, n-1, n, n+1\\} = n+1$. So, $\\ell = n+1$.\n-   The upper half-bandwidth is $u = \\max\\{j-i \\mid a_{ij} \\neq 0, j \\geq i\\}$. This is the maximum of the non-negative offsets $j-i$. The set of non-negative offsets is $\\{0, 1, n-1, n, n+1\\}$. The maximum is $n+1$. So, $u = n+1$.\n\nThe total bandwidth is therefore:\n$$\nb = \\ell + u + 1 = (n+1) + (n+1) + 1 = 2n + 3\n$$\n\n**Part 2: Total Number of Nonzero Entries**\n\nThe total number of nonzero entries, $\\operatorname{nnz}(A)$, is the sum of nonzero entries in each row. For a row corresponding to grid point $(p,q)$, the number of nonzeros is $1$ (for the diagonal term $a_{ii}$) plus the number of its neighbors that are also *interior* grid points. Neighbors on the boundary of $\\Omega$ do not correspond to unknowns and thus do not generate nonzero entries in $A$ due to the homogeneous Dirichlet conditions.\n\nWe classify the $n \\times n$ interior grid points based on their location, which determines how many of their neighbors are interior. The problem assumes $n \\geq 2$.\n\n1.  **Interior-Interior Points:** These are points $(p,q)$ such that $1 < p < n$ and $1 < q < n$. All of their $8$ neighbors are also interior points.\n    -   Number of such points: $(n-2)^2$.\n    -   Each corresponding row in $A$ has $1$ (diagonal) $+ 8$ (off-diagonal) $= 9$ nonzero entries.\n    -   Contribution to total nonzeros: $9(n-2)^2$.\n\n2.  **Edge Points:** These are points on the boundary of the interior grid, but not at its corners. This occurs if $p \\in \\{1,n\\}$ and $1 < q < n$, or $q \\in \\{1,n\\}$ and $1 < p < n$.\n    -   A point on a vertical edge (e.g., $(1,q)$ with $1<q<n$) has $3$ neighbors on the domain boundary and $5$ interior neighbors.\n    -   A point on a horizontal edge (e.g., $(p,1)$ with $1<p<n$) also has $3$ neighbors on the domain boundary and $5$ interior neighbors.\n    -   Number of such points: There are $4$ edges, each with $n-2$ points. Total is $4(n-2)$.\n    -   Each corresponding row in $A$ has $1$ (diagonal) $+ 5$ (off-diagonal) $= 6$ nonzero entries.\n    -   Contribution to total nonzeros: $6 \\times 4(n-2) = 24(n-2)$.\n\n3.  **Corner Points:** These are the four corners of the interior grid: $(1,1)$, $(n,1)$, $(1,n)$, and $(n,n)$.\n    -   A corner point (e.g., $(1,1)$) has $5$ neighbors on the domain boundary and $3$ interior neighbors ($(2,1)$, $(1,2)$, and $(2,2)$).\n    -   Number of such points: $4$.\n    -   Each corresponding row in $A$ has $1$ (diagonal) $+ 3$ (off-diagonal) $= 4$ nonzero entries.\n    -   Contribution to total nonzeros: $4 \\times 4 = 16$.\n\nThe total number of nonzero entries is the sum of these contributions:\n$$\n\\operatorname{nnz}(A) = 9(n-2)^2 + 24(n-2) + 16\n$$\nExpanding this expression:\n$$\n\\operatorname{nnz}(A) = 9(n^2 - 4n + 4) + 24n - 48 + 16\n$$\n$$\n\\operatorname{nnz}(A) = 9n^2 - 36n + 36 + 24n - 32\n$$\n$$\n\\operatorname{nnz}(A) = 9n^2 - 12n + 4\n$$\nThis simplified expression is a perfect square:\n$$\n\\operatorname{nnz}(A) = (3n-2)^2\n$$\nThus, the bandwidth is $2n+3$ and the total number of nonzero entries is $(3n-2)^2$.", "answer": "$$\n\\boxed{\\begin{pmatrix} 2n+3 & (3n-2)^2 \\end{pmatrix}}\n$$", "id": "3454114"}, {"introduction": "A numerically accurate scheme is not always a useful one; it must also produce physically meaningful results. This final practice explores the critical property of monotonicity, which is linked to the discrete maximum principle. By constructing a scenario where the 9-point stencil violates this property, you will witness firsthand how an improperly designed scheme can introduce spurious, non-physical oscillations, providing a powerful lesson on the importance of numerical stability. [@problem_id:3454096]", "problem": "Consider the family of nine-point finite difference operators on a uniform Cartesian grid of spacing $h$ that aim to approximate the negative two-dimensional Laplacian $-\\Delta u = -(\\partial_{xx} u + \\partial_{yy} u)$. At an interior grid point $(i,j)$, define the operator\n$$\nA_{h} u_{i,j} \\;=\\; \\frac{1}{h^{2}}\\Big( \\gamma\\, u_{i,j} \\;-\\; \\alpha\\,[u_{i+1,j} + u_{i-1,j} + u_{i,j+1} + u_{i,j-1}] \\;-\\; \\beta\\,[u_{i+1,j+1} + u_{i+1,j-1} + u_{i-1,j+1} + u_{i-1,j-1}] \\Big),\n$$\nwhere $\\alpha$, $\\beta$, and $\\gamma$ are real constants independent of $h$, and the nine-point stencil includes the central node, the four cardinal neighbors, and the four diagonal neighbors. Assume Dirichlet boundary conditions are imposed on the outer boundary of the computational grid, so boundary values are known and contribute to the right-hand side in the discrete equations for interior nodes.\n\na) By performing a Taylor expansion to second order about $(i,j)$, derive the consistency conditions that $\\alpha$, $\\beta$, and $\\gamma$ must satisfy so that $A_{h} u_{i,j}$ is a second-order accurate approximation to $-\\Delta u(x_{i},y_{j})$ as $h \\to 0$. Your derivation must start from the Taylor expansions of $u_{i\\pm 1,j}$, $u_{i,j\\pm 1}$, and $u_{i\\pm 1,j\\pm 1}$ and systematically eliminate zeroth-order terms to avoid spurious reaction-like contributions.\n\nb) Using the consistency conditions from part (a), choose a specific pair $(\\alpha,\\beta)$ that satisfies those conditions but violates monotonicity (in the sense of producing a stiffness matrix that is not a monotone matrix (M-matrix)). Explicitly justify why your choice is non-monotone in terms of the signs of the off-diagonal coefficients. Then, on the $3\\times 3$ grid (one interior node surrounded by eight boundary nodes), impose Dirichlet boundary data with the four corner (diagonal) boundary nodes set to $u=1$ and the four edge-midpoint (cardinal) boundary nodes set to $u=0$. Consider the homogeneous equation $-\\Delta u = 0$ so that the only right-hand-side contributions come from the boundary data through the stencil. Evaluate the resulting discrete equation at the single interior node and compute the interior value $u_{i,j}$ produced by your non-monotone nine-point operator. Express your final answer as an exact rational number. No rounding is required.", "solution": "The problem asks for the derivation of consistency conditions for a family of nine-point finite difference stencils and then for a specific calculation using a non-monotone instance of this family.\n\n**Part (a): Consistency Conditions**\n\nThe operator is given by\n$$\nA_{h} u_{i,j} = \\frac{1}{h^{2}}\\Big( \\gamma\\, u_{i,j} - \\alpha \\sum_{\\text{cardinal}} u - \\beta \\sum_{\\text{diagonal}} u \\Big)\n$$\nwhere $\\sum_{\\text{cardinal}} u = u_{i+1,j} + u_{i-1,j} + u_{i,j+1} + u_{i,j-1}$ and $\\sum_{\\text{diagonal}} u = u_{i+1,j+1} + u_{i+1,j-1} + u_{i-1,j+1} + u_{i-1,j-1}$. Let the central point $(x_i, y_j)$ be denoted as $(x, y)$, and let $u$ and its derivatives be evaluated at this point. We perform a Taylor series expansion of the function $u$ at the neighboring points.\n\nThe sum over the four cardinal neighbors is:\n\\begin{align*}\n&u(x+h, y) + u(x-h, y) + u(x, y+h) + u(x, y-h) \\\\\n&= \\left( u + h u_x + \\frac{h^2}{2} u_{xx} + \\frac{h^3}{6} u_{xxx} + \\frac{h^4}{24} u_{xxxx} + \\dots \\right) \\\\\n&+ \\left( u - h u_x + \\frac{h^2}{2} u_{xx} - \\frac{h^3}{6} u_{xxx} + \\frac{h^4}{24} u_{xxxx} + \\dots \\right) \\\\\n&+ \\left( u + h u_y + \\frac{h^2}{2} u_{yy} + \\frac{h^3}{6} u_{yyy} + \\frac{h^4}{24} u_{yyyy} + \\dots \\right) \\\\\n&+ \\left( u - h u_y + \\frac{h^2}{2} u_{yy} - \\frac{h^3}{6} u_{yyy} + \\frac{h^4}{24} u_{yyyy} + \\dots \\right) \\\\\n&= 4u + h^2(u_{xx} + u_{yy}) + \\frac{h^4}{12}(u_{xxxx} + u_{yyyy}) + \\mathcal{O}(h^6)\n\\end{align*}\nThe odd-order derivative terms cancel due to symmetry.\n\nThe sum over the four diagonal neighbors, $\\sum_{\\sigma,\\tau \\in \\{-1,1\\}} u(x+\\sigma h, y+\\tau h)$, is expanded similarly. The Taylor expansion for a general diagonal point is:\n$$\nu(x+\\sigma h, y+\\tau h) = \\sum_{k=0}^{\\infty} \\frac{1}{k!} (\\sigma h \\partial_x + \\tau h \\partial_y)^k u\n$$\nSumming over the four combinations of $\\sigma, \\tau \\in \\{-1, 1\\}$ causes all terms with odd powers of $\\sigma$ or $\\tau$ to vanish. For example, $\\sum \\sigma = 0$, $\\sum \\sigma \\tau = 0$, $\\sum \\sigma^3 = 0$, etc. The non-vanishing sums are $\\sum 1 = 4$, $\\sum \\sigma^2 = 4$, $\\sum \\tau^2 = 4$, $\\sum \\sigma^2 \\tau^2 = 4$, $\\sum \\sigma^4 = 4$, $\\sum \\tau^4 = 4$.\nThe expansion for the sum is:\n\\begin{align*}\n&\\sum_{\\sigma,\\tau} u(x+\\sigma h, y+\\tau h) \\\\\n&= 4u + \\frac{h^2}{2!} \\sum_{\\sigma,\\tau} (\\sigma^2 u_{xx} + 2\\sigma\\tau u_{xy} + \\tau^2 u_{yy}) + \\frac{h^4}{4!} \\sum_{\\sigma,\\tau} (\\sigma^4 u_{xxxx} + 4\\sigma^3\\tau u_{xxxy} + 6\\sigma^2\\tau^2 u_{xxyy} + 4\\sigma\\tau^3 u_{xyyy} + \\tau^4 u_{yyyy}) + \\mathcal{O}(h^6) \\\\\n&= 4u + \\frac{h^2}{2} (4u_{xx} + 4u_{yy}) + \\frac{h^4}{24} (4u_{xxxx} + 24u_{xxyy} + 4u_{yyyy}) + \\mathcal{O}(h^6) \\\\\n&= 4u + 2h^2(u_{xx} + u_{yy}) + \\frac{h^4}{6}(u_{xxxx} + 6u_{xxyy} + u_{yyyy}) + \\mathcal{O}(h^6)\n\\end{align*}\n\nNow, we substitute these sums into the expression for $A_h u_{i,j}$:\n\\begin{align*}\nh^2 A_h u_{i,j} &= \\gamma u - \\alpha \\left[ 4u + h^2(u_{xx} + u_{yy}) + \\mathcal{O}(h^4) \\right] - \\beta \\left[ 4u + 2h^2(u_{xx} + u_{yy}) + \\mathcal{O}(h^4) \\right] \\\\\n&= (\\gamma - 4\\alpha - 4\\beta)u - (\\alpha + 2\\beta)h^2(u_{xx} + u_{yy}) - (\\text{terms of order } h^4 \\text{ and higher})\n\\end{align*}\nDividing by $h^2$, we get:\n$$\nA_h u_{i,j} = \\frac{\\gamma - 4\\alpha - 4\\beta}{h^2}u - (\\alpha + 2\\beta)(u_{xx} + u_{yy}) + \\mathcal{O}(h^2)\n$$\nFor $A_h u_{i,j}$ to be a consistent approximation of $-\\Delta u = -(u_{xx} + u_{yy})$, the following conditions must hold:\n1. The coefficient of the zeroth-order term in $u$ must vanish. This prevents a spurious reaction term and is required for consistency.\n$$\n\\gamma - 4\\alpha - 4\\beta = 0 \\implies \\gamma = 4(\\alpha + \\beta)\n$$\n2. The coefficient of the Laplacian term $(u_{xx} + u_{yy})$ must be $-1$.\n$$\n-(\\alpha + 2\\beta) = -1 \\implies \\alpha + 2\\beta = 1\n$$\nThese two equations are the consistency conditions for the operator to be a second-order accurate approximation to $-\\Delta u$.\n\n**Part (b): Non-Monotone Operator and Calculation**\n\nThe stiffness matrix resulting from this finite difference operator is monotone (an M-matrix) if its diagonal entries are positive and all its off-diagonal entries are non-positive. The entry in the matrix row corresponding to node $(i,j)$ that multiplies $u_{k,l}$ is the coefficient of $u_{k,l}$ in the expression for $A_{h} u_{i,j}$.\n- The coefficient of $u_{i,j}$ (diagonal) is $\\frac{\\gamma}{h^2}$.\n- The coefficient of a cardinal neighbor (off-diagonal) is $-\\frac{\\alpha}{h^2}$.\n- The coefficient of a diagonal neighbor (off-diagonal) is $-\\frac{\\beta}{h^2}$.\n\nFor monotonicity, we require non-positive off-diagonals, which means $-\\frac{\\alpha}{h^2} \\le 0$ and $-\\frac{\\beta}{h^2} \\le 0$. This implies $\\alpha \\ge 0$ and $\\beta \\ge 0$. A violation of either of these conditions makes the scheme non-monotone.\n\nWe need to choose a pair $(\\alpha, \\beta)$ that satisfies the consistency condition $\\alpha + 2\\beta = 1$ but violates monotonicity. Let's choose a value for $\\beta$ that is negative. A simple choice is $\\beta = -1/2$.\nSubstituting this into the consistency condition:\n$$\n\\alpha + 2(-\\frac{1}{2}) = 1 \\implies \\alpha - 1 = 1 \\implies \\alpha = 2\n$$\nThis gives the pair $(\\alpha, \\beta) = (2, -1/2)$. This pair satisfies $\\alpha+2\\beta = 1$. Since $\\beta = -1/2  0$, the monotonicity condition is violated. The off-diagonal matrix entries corresponding to the diagonal neighbors are $-\\beta/h^2 = -(-1/2)/h^2 = 1/(2h^2) > 0$.\n\nNow we find $\\gamma$ using the first consistency condition:\n$$\n\\gamma = 4(\\alpha + \\beta) = 4(2 - \\frac{1}{2}) = 4(\\frac{3}{2}) = 6\n$$\nSo, our non-monotone operator is defined by the parameters $\\alpha=2$, $\\beta=-1/2$, and $\\gamma=6$.\n\nWe now consider a $3 \\times 3$ grid with a single interior node $(i,j)$. The discrete equation is $A_h u_{i,j} = 0$, as we are approximating $-\\Delta u = 0$.\n$$\n\\frac{1}{h^2}\\Big( \\gamma u_{i,j} - \\alpha \\sum_{\\text{cardinal}} u - \\beta \\sum_{\\text{diagonal}} u \\Big) = 0\n$$\nMultiplying by $h^2$ and solving for $u_{i,j}$ yields:\n$$\n\\gamma u_{i,j} = \\alpha \\sum_{\\text{cardinal}} u + \\beta \\sum_{\\text{diagonal}} u\n$$\nThe boundary conditions are given as $u=0$ for the four cardinal neighbors and $u=1$ for the four diagonal neighbors.\nThus, the sums are:\n$$\n\\sum_{\\text{cardinal}} u = u_{i+1,j} + u_{i-1,j} + u_{i,j+1} + u_{i,j-1} = 0 + 0 + 0 + 0 = 0\n$$\n$$\n\\sum_{\\text{diagonal}} u = u_{i+1,j+1} + u_{i+1,j-1} + u_{i-1,j+1} + u_{i-1,j-1} = 1 + 1 + 1 + 1 = 4\n$$\nSubstituting these values and the parameters $\\alpha=2, \\beta=-1/2, \\gamma=6$ into the equation for $u_{i,j}$:\n$$\n6 \\, u_{i,j} = (2)(0) + (-\\frac{1}{2})(4)\n$$\n$$\n6 \\, u_{i,j} = 0 - 2 = -2\n$$\n$$\nu_{i,j} = \\frac{-2}{6} = -\\frac{1}{3}\n$$\nThe interior value is $-1/3$. This result, being outside the range $[0,1]$ of the boundary data, demonstrates the violation of the discrete maximum principle, a direct consequence of the operator's non-monotonicity.", "answer": "$$\n\\boxed{-\\frac{1}{3}}\n$$", "id": "3454096"}]}