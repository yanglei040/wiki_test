{"hands_on_practices": [{"introduction": "The Crank-Nicolson (CN) method is unconditionally stable, a property that makes it highly attractive for diffusion problems. However, this does not prevent the formation of non-physical oscillations, a critical limitation related to its failure to preserve positivity. This exercise provides a concrete demonstration of this behavior, challenging you to find the critical time step for which positivity is lost in a simple $2 \\times 2$ system [@problem_id:3360619].", "problem": "Consider the linear parabolic initial value problem in semi-discrete form $u^{\\prime}(t)=-A\\,u(t)$, where $A\\in\\mathbb{R}^{2\\times 2}$ is the matrix\n$$\nA=\\begin{pmatrix}\n2  -1\\\\\n-1  2\n\\end{pmatrix}.\n$$\nAssume a single time step of the Crank–Nicolson method (Crank–Nicolson (CN)) with step size $\\Delta t > 0$ is applied to advance the solution from $u^{n}$ to $u^{n+1}$. The notion of positivity is understood componentwise: a vector $v\\in\\mathbb{R}^{2}$ is positive if $v_{i}\\ge 0$ for each component.\n\nThe matrix $A$ has nonpositive off-diagonal entries and a positive inverse, hence $A$ is a nonsingular $M$-matrix in the standard sense. The continuous semigroup generated by $-A$ preserves positivity. However, the Crank–Nicolson method may fail to preserve positivity for certain choices of $\\Delta t$.\n\nStarting from the fundamental definition of the Crank–Nicolson method for linear systems and the definition of an $M$-matrix, do the following:\n- Derive the one-step linear update operator that maps $u^{n}$ to $u^{n+1}$ for the system $u^{\\prime}=-A u$ under Crank–Nicolson.\n- Using $u^{n}=e_{1}=(1,0)^{\\top}$ as a positive initial vector, determine the smallest positive time step $\\Delta t$ for which the first component of $u^{n+1}$ is strictly negative.\n\nYour final answer must be a single exact expression for this smallest $\\Delta t$. Do not round.", "solution": "The problem asks for the smallest positive time step $\\Delta t$ for which the Crank-Nicolson (CN) method, applied to the system $u^{\\prime}(t) = -A u(t)$, fails to preserve positivity. Specifically, we need to find the critical $\\Delta t$ where the first component of the solution becomes negative, starting from a positive initial vector $u^n = e_1$.\n\nFirst, we derive the one-step linear update operator for the Crank-Nicolson method. The method approximates the differential equation $u' = -A u$ over a time interval $[t_n, t_{n+1}]$ with $t_{n+1} = t_n + \\Delta t$ as follows:\n$$ \\frac{u^{n+1} - u^{n}}{\\Delta t} = \\frac{1}{2} \\left( (-A u^{n+1}) + (-A u^{n}) \\right) $$\nwhere $u^n$ and $u^{n+1}$ are the numerical approximations of the solution at times $t_n$ and $t_{n+1}$ respectively.\n\nTo find the update operator that maps $u^n$ to $u^{n+1}$, we must solve for $u^{n+1}$:\n$$ u^{n+1} - u^{n} = -\\frac{\\Delta t}{2} A u^{n+1} - \\frac{\\Delta t}{2} A u^{n} $$\nRearranging the terms to group $u^{n+1}$ on the left-hand side and $u^{n}$ on the right-hand side gives:\n$$ u^{n+1} + \\frac{\\Delta t}{2} A u^{n+1} = u^{n} - \\frac{\\Delta t}{2} A u^{n} $$\nFactoring out the vectors $u^{n+1}$ and $u^{n}$:\n$$ \\left(I + \\frac{\\Delta t}{2} A\\right) u^{n+1} = \\left(I - \\frac{\\Delta t}{2} A\\right) u^{n} $$\nwhere $I$ is the $2 \\times 2$ identity matrix.\n\nSolving for $u^{n+1}$, we get:\n$$ u^{n+1} = \\left(I + \\frac{\\Delta t}{2} A\\right)^{-1} \\left(I - \\frac{\\Delta t}{2} A\\right) u^{n} $$\nThis defines the one-step linear update operator, or amplification matrix, $G$:\n$$ G = \\left(I + \\frac{\\Delta t}{2} A\\right)^{-1} \\left(I - \\frac{\\Delta t}{2} A\\right) $$\n\nNow, we compute this operator explicitly for the given matrix $A = \\begin{pmatrix} 2  -1 \\\\ -1  2 \\end{pmatrix}$. Let's simplify the notation by setting $k = \\frac{\\Delta t}{2}$. Since $\\Delta t > 0$, we have $k > 0$. The expression for $G$ becomes:\n$$ G = (I + kA)^{-1} (I - kA) $$\nFirst, we compute the two matrices in this expression:\n$$ I+kA = \\begin{pmatrix} 1+2k  -k \\\\ -k  1+2k \\end{pmatrix} $$\n$$ I-kA = \\begin{pmatrix} 1-2k  k \\\\ k  1-2k \\end{pmatrix} $$\nNext, we find the inverse of $(I+kA)$. The determinant is:\n$$ \\det(I+kA) = (1+2k)(1+2k) - (-k)(-k) = (1+2k)^2 - k^2 = 1+4k+4k^2 - k^2 = 1+4k+3k^2 $$\nFactoring the determinant, we get $\\det(I+kA) = (1+k)(1+3k)$. Since $k>0$, the determinant is non-zero, and the inverse exists.\nThe inverse is given by:\n$$ (I+kA)^{-1} = \\frac{1}{(1+k)(1+3k)} \\begin{pmatrix} 1+2k  k \\\\ k  1+2k \\end{pmatrix} $$\nNow we can compute the operator $G$:\n$$ G = \\frac{1}{(1+k)(1+3k)} \\begin{pmatrix} 1+2k  k \\\\ k  1+2k \\end{pmatrix} \\begin{pmatrix} 1-2k  k \\\\ k  1-2k \\end{pmatrix} $$\nPerforming the matrix multiplication:\n$$ G = \\frac{1}{(1+k)(1+3k)} \\begin{pmatrix} (1+2k)(1-2k)+k^2  (1+2k)k+k(1-2k) \\\\ k(1-2k)+(1+2k)k  k^2+(1+2k)(1-2k) \\end{pmatrix} $$\n$$ G = \\frac{1}{(1+k)(1+3k)} \\begin{pmatrix} 1-4k^2+k^2  k+2k^2+k-2k^2 \\\\ k-2k^2+k+2k^2  k^2+1-4k^2 \\end{pmatrix} $$\n$$ G = \\frac{1}{(1+k)(1+3k)} \\begin{pmatrix} 1-3k^2  2k \\\\ 2k  1-3k^2 \\end{pmatrix} $$\nThis is the explicit form of the update operator.\n\nThe problem asks to find the smallest $\\Delta t > 0$ for which the first component of $u^{n+1}$ is strictly negative, given the initial vector $u^n = e_1 = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$. We compute $u^{n+1}$:\n$$ u^{n+1} = G u^n = \\frac{1}{(1+k)(1+3k)} \\begin{pmatrix} 1-3k^2  2k \\\\ 2k  1-3k^2 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} $$\n$$ u^{n+1} = \\frac{1}{(1+k)(1+3k)} \\begin{pmatrix} 1-3k^2 \\\\ 2k \\end{pmatrix} $$\nSo the components of $u^{n+1}$ are:\n$$ (u^{n+1})_1 = \\frac{1-3k^2}{(1+k)(1+3k)} \\quad \\text{and} \\quad (u^{n+1})_2 = \\frac{2k}{(1+k)(1+3k)} $$\nWe want to find the condition on $\\Delta t$ such that $(u^{n+1})_1  0$.\n$$ \\frac{1-3k^2}{(1+k)(1+3k)}  0 $$\nSince $k = \\Delta t/2 > 0$, the denominator $(1+k)(1+3k)$ is always positive. Therefore, the inequality is satisfied if and only if the numerator is negative:\n$$ 1-3k^2  0 $$\n$$ 1  3k^2 $$\n$$ k^2  \\frac{1}{3} $$\nSince $k>0$, we take the positive square root of both sides:\n$$ k  \\frac{1}{\\sqrt{3}} $$\nNow, we substitute back $k = \\frac{\\Delta t}{2}$:\n$$ \\frac{\\Delta t}{2}  \\frac{1}{\\sqrt{3}} $$\n$$ \\Delta t  \\frac{2}{\\sqrt{3}} $$\nThe first component of $u^{n+1}$ is strictly negative for any time step $\\Delta t$ in the open interval $(\\frac{2}{\\sqrt{3}}, \\infty)$. The problem asks for the \"smallest positive time step\" for which this condition holds. This corresponds to the infimum of this set of values. At the boundary value $\\Delta t = \\frac{2}{\\sqrt{3}}$, the first component $(u^{n+1})_1$ is zero. For any $\\Delta t$ infinitesimally larger than this value, the component becomes negative. Thus, the critical value that marks the boundary between positivity preservation and its violation is this infimum.\n\nThe smallest positive time step $\\Delta t$ at which the positivity property is lost is $\\frac{2}{\\sqrt{3}}$. This can also be written with a rationalized denominator as $\\frac{2\\sqrt{3}}{3}$.", "answer": "$$\\boxed{\\frac{2}{\\sqrt{3}}}$$", "id": "3360619"}, {"introduction": "A deep understanding of accuracy requires analyzing the structure of both temporal and spatial discretization errors. This practice explores the powerful concept of error cancellation, where one source of error is designed to negate another. By carefully analyzing the leading error terms for the 1D heat equation solved with CN [@problem_id:3360618], you will derive the special ratio of the time step to grid spacing that achieves superconvergence for a given Fourier mode.", "problem": "Consider the one-dimensional heat equation $u_{t} = \\nu u_{xx}$ on the periodic domain $x \\in [0,L]$, where $\\nu > 0$ is the thermal diffusivity. Let $x_{j} = j h$ for $j = 0,1,\\dots,M-1$ with $h = L/M$ and $t_{n} = n \\Delta t$. Discretize $u_{t} = \\nu u_{xx}$ using the Crank–Nicolson (CN) method (Crank–Nicolson (CN)) in time and the standard centered second-difference approximation to $u_{xx}$ in space:\n$$\n\\frac{u_{j}^{n+1} - u_{j}^{n}}{\\Delta t} = \\frac{\\nu}{2} \\left( \\frac{u_{j+1}^{n} - 2 u_{j}^{n} + u_{j-1}^{n}}{h^{2}} + \\frac{u_{j+1}^{n+1} - 2 u_{j}^{n+1} + u_{j-1}^{n+1}}{h^{2}} \\right).\n$$\nAssume a single Fourier mode initial condition $u(x,0) = \\exp(\\mathrm{i} k_{0} x)$ with wavenumber $k_{0} = \\frac{2\\pi m_{0}}{L}$ for some fixed integer $m_{0} \\neq 0$. For this mode, the exact continuous-time amplification over a single time step is $\\exp(-\\nu k_{0}^{2} \\Delta t)$. The fully discrete CN scheme applied to this mode has an amplification factor that can be expressed in terms of the discrete Laplacian’s eigenvalue, which depends on $h$.\n\nStarting from fundamental principles—Fourier mode analysis for linear constant-coefficient partial differential equations, the modified wavenumber of the centered second difference, and the Padé-approximant interpretation of the CN method—derive the leading-order combined error in the logarithm of the amplification factor over one time step, and design the mesh-to-time-step ratio so that the leading spatial discretization error cancels the leading CN time integration error for the specific mode $k_{0}$ (superconvergence for that mode). Explicitly, determine the unique closed-form expression for the dimensionless ratio $\\Delta t / h$ in terms of $\\nu$ and $k_{0}$ that achieves this cancellation to leading order.\n\nExpress your final answer as a single closed-form analytic expression for $\\Delta t / h$. No rounding is required, and no units should be included in your final expression.", "solution": "The problem requires us to find a specific ratio of the time step $\\Delta t$ to the spatial step $h$ such that the leading-order spatial discretization error cancels the leading-order temporal discretization error for a single Fourier mode solution to the heat equation, when using the Crank-Nicolson (CN) numerical method.\n\nThe one-dimensional heat equation is given by:\n$$\nu_{t} = \\nu u_{xx}\n$$\nThe Crank-Nicolson discretization provided is:\n$$\n\\frac{u_{j}^{n+1} - u_{j}^{n}}{\\Delta t} = \\frac{\\nu}{2} \\left( \\frac{u_{j+1}^{n} - 2 u_{j}^{n} + u_{j-1}^{n}}{h^{2}} + \\frac{u_{j+1}^{n+1} - 2 u_{j}^{n+1} + u_{j-1}^{n+1}}{h^{2}} \\right)\n$$\nWe analyze the behavior of this scheme on a single Fourier mode, $u(x,t) = \\exp(-\\nu k_{0}^{2} t) \\exp(\\mathrm{i} k_{0} x)$. The spatial part is $\\exp(\\mathrm{i} k_{0} x)$. Its discrete counterpart is $u_{j}^{n} = (G_{num})^{n} \\exp(\\mathrm{i} k_{0} x_{j}) = (G_{num})^{n} \\exp(\\mathrm{i} k_{0} j h)$, where $G_{num}$ is the numerical amplification factor per time step $\\Delta t$.\n\nLet's substitute this form of the solution into the CN scheme.\nThe finite difference operator in space, $\\delta_x^2$, acts on the spatial part as follows:\n$$\n\\delta_x^2 u_{j} = u_{j+1} - 2u_{j} + u_{j-1} = \\exp(\\mathrm{i} k_{0} (j+1) h) - 2\\exp(\\mathrm{i} k_{0} j h) + \\exp(\\mathrm{i} k_{0} (j-1) h)\n$$\n$$\n= \\exp(\\mathrm{i} k_{0} j h) \\left( \\exp(\\mathrm{i} k_{0} h) - 2 + \\exp(-\\mathrm{i} k_{0} h) \\right)\n$$\n$$\n= \\exp(\\mathrm{i} k_{0} j h) \\left( 2\\cos(k_{0}h) - 2 \\right) = -4\\sin^{2}\\left(\\frac{k_{0}h}{2}\\right) \\exp(\\mathrm{i} k_{0} j h)\n$$\nThe action of the discrete Laplacian operator $\\frac{\\delta_x^2}{h^2}$ on the mode is thus multiplication by the eigenvalue $\\lambda_{h}(k_{0})$:\n$$\n\\lambda_{h}(k_{0}) = -\\frac{4}{h^{2}}\\sin^{2}\\left(\\frac{k_{0}h}{2}\\right)\n$$\nSubstituting $u_{j}^{n} = (G_{num})^{n} \\exp(\\mathrm{i} k_{0} j h)$ into the CN scheme equation yields:\n$$\n\\frac{(G_{num})^{n+1} - (G_{num})^{n}}{\\Delta t} \\exp(\\mathrm{i} k_{0} j h) = \\frac{\\nu}{2} \\left( (G_{num})^{n} \\lambda_{h}(k_{0}) \\exp(\\mathrm{i} k_{0} j h) + (G_{num})^{n+1} \\lambda_{h}(k_{0}) \\exp(\\mathrm{i} k_{0} j h) \\right)\n$$\nDividing by $(G_{num})^{n} \\exp(\\mathrm{i} k_{0} j h)$ (assuming it is non-zero), we get an equation for $G_{num}$:\n$$\n\\frac{G_{num} - 1}{\\Delta t} = \\frac{\\nu}{2} \\lambda_{h}(k_{0}) (1 + G_{num})\n$$\nSolving for $G_{num}$:\n$$\nG_{num} - 1 = \\frac{\\nu \\Delta t \\lambda_{h}(k_{0})}{2} (1 + G_{num})\n$$\n$$\nG_{num}\\left(1 - \\frac{\\nu \\Delta t \\lambda_{h}(k_{0})}{2}\\right) = 1 + \\frac{\\nu \\Delta t \\lambda_{h}(k_{0})}{2}\n$$\n$$\nG_{num} = \\frac{1 + \\frac{1}{2} \\nu \\Delta t \\lambda_{h}(k_{0})}{1 - \\frac{1}{2} \\nu \\Delta t \\lambda_{h}(k_{0})}\n$$\nLet $z_{h} = \\nu \\Delta t \\lambda_{h}(k_{0})$. The numerical amplification factor is $G_{num} = \\frac{1+z_{h}/2}{1-z_{h}/2}$. This is the $(1,1)$-Padé approximant to $\\exp(z_h)$.\n\nThe problem concerns the error in the logarithm of the amplification factor. For the continuous PDE, the exact amplification factor over a time step $\\Delta t$ is $G_{exact} = \\exp(-\\nu k_{0}^{2} \\Delta t)$. The exact amplification exponent is $\\log(G_{exact}) = -\\nu k_{0}^{2} \\Delta t$. The numerical amplification exponent is $\\log(G_{num})$. The error is $E = \\log(G_{num}) - \\log(G_{exact})$.\n\nTo find the leading-order error, we expand $\\log(G_{num})$ in terms of the small parameters $h$ and $\\Delta t$.\nFirst, we expand the discrete eigenvalue $\\lambda_{h}(k_{0})$ for small $h$, using the Taylor series for $\\sin(x) = x - x^3/6 + \\mathcal{O}(x^5)$:\n$$\n\\lambda_{h}(k_{0}) = -\\frac{4}{h^{2}}\\left( \\frac{k_{0}h}{2} - \\frac{1}{6}\\left(\\frac{k_{0}h}{2}\\right)^{3} + \\mathcal{O}(h^5) \\right)^{2}\n$$\n$$\n= -\\frac{4}{h^{2}}\\left( \\frac{k_{0}^{2}h^{2}}{4} - 2\\frac{k_{0}h}{2}\\frac{k_{0}^{3}h^{3}}{48} + \\mathcal{O}(h^6) \\right)\n$$\n$$\n= -\\frac{4}{h^{2}}\\left( \\frac{k_{0}^{2}h^{2}}{4} - \\frac{k_{0}^{4}h^{4}}{48} + \\mathcal{O}(h^6) \\right) = -k_{0}^{2} + \\frac{k_{0}^{4}h^{2}}{12} + \\mathcal{O}(h^4)\n$$\nThe term $-k_{0}^{2}$ corresponds to the exact differential operator $\\frac{\\partial^2}{\\partial x^2}$, and $\\frac{k_{0}^{4}h^{2}}{12}$ is the leading-order spatial discretization error term for the eigenvalue.\n\nNext, we expand $\\log(G_{num})=\\log\\left(\\frac{1+z_{h}/2}{1-z_{h}/2}\\right)$ for small $z_{h}$. Using $\\log(1+x) = x - x^2/2 + x^3/3 - \\dots$:\n$$\n\\log(G_{num}) = \\log(1+z_{h}/2) - \\log(1-z_{h}/2)\n$$\n$$\n= \\left(\\frac{z_{h}}{2} - \\frac{1}{2}\\left(\\frac{z_{h}}{2}\\right)^{2} + \\frac{1}{3}\\left(\\frac{z_{h}}{2}\\right)^{3} - \\dots\\right) - \\left(-\\frac{z_{h}}{2} - \\frac{1}{2}\\left(-\\frac{z_{h}}{2}\\right)^{2} - \\frac{1}{3}\\left(-\\frac{z_{h}}{2}\\right)^{3} - \\dots\\right)\n$$\n$$\n= \\left(\\frac{z_{h}}{2} - \\frac{z_{h}^{2}}{8} + \\frac{z_{h}^{3}}{24} - \\dots\\right) - \\left(-\\frac{z_{h}}{2} - \\frac{z_{h}^{2}}{8} - \\frac{z_{h}^{3}}{24} - \\dots\\right)\n$$\n$$\n\\log(G_{num}) = z_{h} + \\frac{z_{h}^{3}}{12} + \\mathcal{O}(z_{h}^{5})\n$$\nThe term $z_{h}$ would be exact if the numerical method perfectly reproduced $\\exp(z_h)$, but $\\frac{z_h^3}{12}$ is the leading-order temporal error of the CN method in the logarithm of the amplification factor.\n\nNow, we combine these expansions. We substitute the expansion for $\\lambda_h(k_0)$ into $z_{h}$:\n$$\nz_{h} = \\nu \\Delta t \\lambda_{h}(k_{0}) = \\nu \\Delta t \\left(-k_{0}^{2} + \\frac{k_{0}^{4}h^{2}}{12} + \\mathcal{O}(h^4)\\right)\n$$\n$$\n= -\\nu k_{0}^{2} \\Delta t + \\frac{\\nu k_{0}^{4} h^{2} \\Delta t}{12} + \\mathcal{O}(h^4 \\Delta t)\n$$\nNow we substitute this into the expansion for $\\log(G_{num})$. We only need to keep the leading-order terms. The lowest order for $z_h$ is $\\mathcal{O}(\\Delta t)$. So $z_h^3$ is $\\mathcal{O}(\\Delta t^3)$.\n$$\n\\log(G_{num}) = \\left(-\\nu k_{0}^{2} \\Delta t + \\frac{\\nu k_{0}^{4} h^{2} \\Delta t}{12}\\right) + \\frac{1}{12}\\left(-\\nu k_{0}^{2} \\Delta t\\right)^{3} + \\text{H.O.T.}\n$$\n$$\n\\log(G_{num}) = -\\nu k_{0}^{2} \\Delta t + \\frac{\\nu k_{0}^{4} h^{2} \\Delta t}{12} - \\frac{\\nu^{3}k_{0}^{6}\\Delta t^{3}}{12} + \\text{H.O.T.}\n$$\nThe total error in the amplification exponent is $E = \\log(G_{num}) - \\log(G_{exact})$:\n$$\nE = \\left(-\\nu k_{0}^{2} \\Delta t + \\frac{\\nu k_{0}^{4} h^{2} \\Delta t}{12} - \\frac{\\nu^{3}k_{0}^{6}\\Delta t^{3}}{12}\\right) - (-\\nu k_{0}^{2} \\Delta t) + \\text{H.O.T.}\n$$\n$$\nE = \\underbrace{\\frac{\\nu k_{0}^{4} h^{2} \\Delta t}{12}}_{\\text{Spatial Error}} - \\underbrace{\\frac{\\nu^{3}k_{0}^{6}\\Delta t^{3}}{12}}_{\\text{Temporal Error}} + \\text{H.O.T.}\n$$\nThe first term arises from the spatial discretization error ($\\mathcal{O}(h^2)$) and the second from the temporal discretization error of the CN method ($\\mathcal{O}(\\Delta t^2)$ in the scheme, which manifests as $\\mathcal{O}(\\Delta t^3)$ in the amplification exponent).\n\nTo achieve cancellation of the leading-order errors for the mode $k_{0}$, we must set the sum of these two terms to zero:\n$$\n\\frac{\\nu k_{0}^{4} h^{2} \\Delta t}{12} - \\frac{\\nu^{3}k_{0}^{6}\\Delta t^{3}}{12} = 0\n$$\nAssuming $\\nu, k_{0}, \\Delta t \\neq 0$, we can divide by common factors:\n$$\n\\nu k_{0}^{4} h^{2} \\Delta t = \\nu^{3} k_{0}^{6} \\Delta t^{3}\n$$\n$$\nh^{2} = \\nu^{2} k_{0}^{2} \\Delta t^{2}\n$$\nTaking the square root of both sides (since $h, \\nu, k_0 > 0, \\Delta t > 0$):\n$$\nh = \\nu k_{0} \\Delta t\n$$\nThe problem asks for the ratio $\\Delta t / h$. Rearranging the equation gives:\n$$\n\\frac{\\Delta t}{h} = \\frac{1}{\\nu k_{0}}\n$$\nThis is the unique dimensionless ratio that causes the leading spatial and temporal errors to cancel for the specified Fourier mode, resulting in superconvergence for that mode.", "answer": "$$\n\\boxed{\\frac{1}{\\nu k_{0}}}\n$$", "id": "3360618"}, {"introduction": "Moving to higher dimensions introduces new challenges, such as errors induced by grid geometry. This practice extends von Neumann analysis to the 2D heat equation on an anisotropic grid, where the spacing in one direction, $h_x$, differs from the other, $h_y$. Your task is to derive the amplification factor for this case and quantify the leading-order, direction-dependent error [@problem_id:3360636], a crucial step in understanding the performance of numerical methods in realistic settings.", "problem": "Consider the two-dimensional heat equation $u_{t}=\\nu\\,(u_{xx}+u_{yy})$ on the periodic domain $[0,L_{x}]\\times[0,L_{y}]$ with kinematic viscosity $\\nu>0$. Let the domain be discretized by a rectangular, uniform, periodic grid with $M_{x}$ and $M_{y}$ points in the $x$- and $y$-directions, respectively, with spacings $h_{x}=L_{x}/M_{x}$ and $h_{y}=L_{y}/M_{y}$. Denote grid values by $u_{j,k}^{n}\\approx u(j\\,h_{x},k\\,h_{y},n\\,\\Delta t)$, where $\\Delta t>0$ is the timestep. The spatial operator is the standard second-order central-difference five-point Laplacian. Time advancement is by the Crank–Nicolson (CN) method (trapezoidal rule in time) applied to the semi-discrete system obtained from the spatial discretization.\n\nUsing discrete Fourier analysis (also known as von Neumann analysis) with the Discrete Fourier Transform (DFT) basis $\\phi_{j,k}(\\theta_{x},\\theta_{y})=\\exp\\!\\big(i(j\\,\\theta_{x}+k\\,\\theta_{y})\\big)$, where the phase angles $\\theta_{x}\\in[-\\pi,\\pi)$ and $\\theta_{y}\\in[-\\pi,\\pi)$ are the discrete Fourier wavenumbers associated with the grid, carry out the following:\n\n1. Starting from the definition of the CN method as the trapezoidal rule applied to the semi-discrete system $u_{t}=\\nu\\,L_{h}u$, where $L_{h}$ is the five-point Laplacian, derive the exact CN amplification factor $G(\\theta_{x},\\theta_{y})$ for a single DFT mode $\\phi_{j,k}(\\theta_{x},\\theta_{y})$ on the rectangular grid with $h_{x}\\neq h_{y}$.\n\n2. To quantify anisotropy on rectangular meshes, compare the discrete decay over one timestep to the continuum decay for a smooth Fourier mode with physical wavenumber components $(k_{x},k_{y})$ satisfying $\\theta_{x}=k_{x}h_{x}$ and $\\theta_{y}=k_{y}h_{y}$, and define $k=\\sqrt{k_{x}^{2}+k_{y}^{2}}$ and the direction angle $\\psi\\in[0,2\\pi)$ by $k_{x}=k\\cos\\psi$ and $k_{y}=k\\sin\\psi$. Let the reference continuum amplitude change over one timestep be $\\exp\\!\\big(-\\nu\\,\\Delta t\\,(k_{x}^{2}+k_{y}^{2})\\big)$, and let the discrete amplitude change be $|G(\\theta_{x},\\theta_{y})|$. For the small-wavenumber regime where $k\\,h_{x}\\ll 1$ and $k\\,h_{y}\\ll 1$, derive the leading-order angular dependence of the relative error in the decay rate per timestep, defined by\n$$\nE(\\psi)=\\frac{\\ln|G(\\theta_{x},\\theta_{y})|+\\nu\\,\\Delta t\\,(k_{x}^{2}+k_{y}^{2})}{\\nu\\,\\Delta t\\,(k_{x}^{2}+k_{y}^{2})},\n$$\nas an explicit closed-form expression in terms of $k$, $\\psi$, $h_{x}$, and $h_{y}$.\n\nProvide your final answer as two analytic expressions: the exact amplification factor $G(\\theta_{x},\\theta_{y})$ and the leading-order $E(\\psi)$ as defined above. No numerical evaluation is required; do not round. The final answer must be given without units.", "solution": "The problem statement has been validated and found to be self-contained, scientifically grounded, and well-posed. It constitutes a standard, non-trivial exercise in the numerical analysis of partial differential equations. The derivation proceeds in two parts as requested.\n\nPart 1: Derivation of the Amplification Factor $G(\\theta_x, \\theta_y)$\n\nThe two-dimensional heat equation is given by $u_{t}=\\nu\\,(u_{xx}+u_{yy})$. The spatial derivatives are discretized using the standard second-order central-difference five-point Laplacian operator, $L_h$, on a grid with spacings $h_x$ and $h_y$. The action of this operator on a grid function $u_{j,k}$ is:\n$$\nL_{h}u_{j,k} = \\frac{u_{j+1,k} - 2u_{j,k} + u_{j-1,k}}{h_{x}^{2}} + \\frac{u_{j,k+1} - 2u_{j,k} + u_{j,k-1}}{h_{y}^{2}}\n$$\nThis leads to the semi-discrete system of ordinary differential equations, $\\frac{d u}{d t} = \\nu L_h u$. Time integration is performed using the Crank-Nicolson method, which is an implicit method corresponding to the trapezoidal rule. For a timestep $\\Delta t$, the scheme is:\n$$\n\\frac{u^{n+1} - u^{n}}{\\Delta t} = \\frac{\\nu}{2} \\left( L_h u^{n+1} + L_h u^{n} \\right)\n$$\nRearranging this equation to solve for the state at timestep $n+1$ gives:\n$$\n\\left(I - \\frac{\\nu \\Delta t}{2} L_h \\right) u^{n+1} = \\left(I + \\frac{\\nu \\Delta t}{2} L_h \\right) u^{n}\n$$\nTo perform a von Neumann stability analysis, we consider the evolution of a single discrete Fourier mode, $u_{j,k}^{n} = \\hat{u}^{n}(\\theta_x, \\theta_y) \\exp(i(j\\theta_x + k\\theta_y))$. The amplification factor is defined as $G(\\theta_x, \\theta_y) = \\frac{\\hat{u}^{n+1}}{\\hat{u}^{n}}$. We first determine the eigenvalue of the discrete Laplacian operator $L_h$ corresponding to this mode. Let's denote the mode as $\\phi_{j,k}$:\n$$\nL_h \\phi_{j,k} = \\left( \\frac{\\exp(i\\theta_x) - 2 + \\exp(-i\\theta_x)}{h_x^2} + \\frac{\\exp(i\\theta_y) - 2 + \\exp(-i\\theta_y)}{h_y^2} \\right) \\phi_{j,k}\n$$\nUsing the identity $\\exp(i\\alpha) + \\exp(-i\\alpha) = 2\\cos(\\alpha)$, this becomes:\n$$\nL_h \\phi_{j,k} = \\left( \\frac{2\\cos(\\theta_x) - 2}{h_x^2} + \\frac{2\\cos(\\theta_y) - 2}{h_y^2} \\right) \\phi_{j,k}\n$$\nFurther, using the half-angle identity $2\\cos(\\alpha) - 2 = -4\\sin^2(\\alpha/2)$, the eigenvalue of $L_h$, denoted $\\hat{L}_h(\\theta_x, \\theta_y)$, is:\n$$\n\\hat{L}_h(\\theta_x, \\theta_y) = -4 \\left( \\frac{\\sin^2(\\theta_x/2)}{h_x^2} + \\frac{\\sin^2(\\theta_y/2)}{h_y^2} \\right)\n$$\nSubstituting $u_{j,k}^{n} = \\hat{u}^{n} \\phi_{j,k}$ into the rearranged Crank-Nicolson scheme, the operator $L_h$ is replaced by its eigenvalue $\\hat{L_h}$:\n$$\n\\left(1 - \\frac{\\nu \\Delta t}{2} \\hat{L}_h \\right) \\hat{u}^{n+1} = \\left(1 + \\frac{\\nu \\Delta t}{2} \\hat{L}_h \\right) \\hat{u}^{n}\n$$\nThe amplification factor is then:\n$$\nG(\\theta_x, \\theta_y) = \\frac{1 + \\frac{\\nu \\Delta t}{2} \\hat{L}_h}{1 - \\frac{\\nu \\Delta t}{2} \\hat{L}_h}\n$$\nSubstituting the expression for $\\hat{L}_h(\\theta_x, \\theta_y)$:\n$$\nG(\\theta_x, \\theta_y) = \\frac{1 + \\frac{\\nu \\Delta t}{2} \\left[-4 \\left( \\frac{\\sin^2(\\theta_x/2)}{h_x^2} + \\frac{\\sin^2(\\theta_y/2)}{h_y^2} \\right)\\right]}{1 - \\frac{\\nu \\Delta t}{2} \\left[-4 \\left( \\frac{\\sin^2(\\theta_x/2)}{h_x^2} + \\frac{\\sin^2(\\theta_y/2)}{h_y^2} \\right)\\right]} = \\frac{1 - 2\\nu \\Delta t \\left( \\frac{\\sin^2(\\theta_x/2)}{h_x^2} + \\frac{\\sin^2(\\theta_y/2)}{h_y^2} \\right)}{1 + 2\\nu \\Delta t \\left( \\frac{\\sin^2(\\theta_x/2)}{h_x^2} + \\frac{\\sin^2(\\theta_y/2)}{h_y^2} \\right)}\n$$\nThis is the exact amplification factor for the Crank-Nicolson scheme applied to the 2D heat equation with a 5-point Laplacian.\n\nPart 2: Leading-Order Relative Error $E(\\psi)$\n\nThe relative error in the decay rate is defined as:\n$$\nE(\\psi) = \\frac{\\ln|G(\\theta_{x},\\theta_{y})|+\\nu\\,\\Delta t\\,(k_{x}^{2}+k_{y}^{2})}{\\nu\\,\\Delta t\\,(k_{x}^{2}+k_{y}^{2})}\n$$\nWe analyze this expression in the small-wavenumber regime, where $\\theta_x = k_x h_x \\ll 1$ and $\\theta_y = k_y h_y \\ll 1$. Let $X = 2\\nu \\Delta t \\left( \\frac{\\sin^2(\\theta_x/2)}{h_x^2} + \\frac{\\sin^2(\\theta_y/2)}{h_y^2} \\right)$. Then $G = \\frac{1-X}{1+X}$. Since $\\nu, \\Delta t, h_x, h_y$ are positive, $X \\ge 0$, which ensures $|G| \\le 1$. We can write $\\ln|G| = \\ln(1-X) - \\ln(1+X)$.\nFor small $\\alpha$, the Taylor series for $\\sin^2(\\alpha)$ is $\\sin^2(\\alpha) = (\\alpha - \\frac{\\alpha^3}{6} + \\dots)^2 = \\alpha^2 - \\frac{\\alpha^4}{3} + O(\\alpha^6)$.\nApplying this to the terms in $X$ with $\\theta_x$ and $\\theta_y$ being small:\n$$\n\\sin^2(\\theta_x/2) = \\frac{\\theta_x^2}{4} - \\frac{\\theta_x^4}{48} + O(\\theta_x^6) \\quad \\text{and} \\quad \\sin^2(\\theta_y/2) = \\frac{\\theta_y^2}{4} - \\frac{\\theta_y^4}{48} + O(\\theta_y^6)\n$$\nSubstituting $\\theta_x = k_x h_x$ and $\\theta_y = k_y h_y$:\n$$\nX = 2\\nu \\Delta t \\left[ \\frac{1}{h_x^2}\\left(\\frac{k_x^2 h_x^2}{4} - \\frac{k_x^4 h_x^4}{48}\\right) + \\frac{1}{h_y^2}\\left(\\frac{k_y^2 h_y^2}{4} - \\frac{k_y^4 h_y^4}{48}\\right) + \\dots \\right]\n$$\n$$\nX = 2\\nu \\Delta t \\left[ \\frac{k_x^2}{4} - \\frac{k_x^4 h_x^2}{48} + \\frac{k_y^2}{4} - \\frac{k_y^4 h_y^2}{48} + \\dots \\right]\n$$\n$$\nX = \\frac{\\nu \\Delta t}{2} (k_x^2 + k_y^2) - \\frac{\\nu \\Delta t}{24} (k_x^4 h_x^2 + k_y^4 h_y^2) + O(k^6 h^4)\n$$\nNow we expand $\\ln|G|$ for small $X$. The Taylor series for $\\ln(1\\pm x)$ is $\\pm x - \\frac{x^2}{2} \\pm \\frac{x^3}{3} - \\dots$.\n$$\n\\ln|G| = \\ln(1-X) - \\ln(1+X) = \\left(-X - \\frac{X^2}{2} - \\dots\\right) - \\left(X - \\frac{X^2}{2} + \\dots\\right) = -2X + O(X^3)\n$$\nSubstituting the expansion for $X$:\n$$\n\\ln|G| = -2 \\left[ \\frac{\\nu \\Delta t}{2} (k_x^2 + k_y^2) - \\frac{\\nu \\Delta t}{24} (k_x^4 h_x^2 + k_y^4 h_y^2) + \\dots \\right]\n$$\n$$\n\\ln|G| = -\\nu \\Delta t (k_x^2 + k_y^2) + \\frac{\\nu \\Delta t}{12} (k_x^4 h_x^2 + k_y^4 h_y^2) + \\dots\n$$\nThe numerator of $E(\\psi)$ is $\\ln|G| + \\nu \\Delta t (k_x^2+k_y^2)$, which to leading order is:\n$$\n\\text{Numerator} \\approx \\left[-\\nu \\Delta t (k_x^2 + k_y^2) + \\frac{\\nu \\Delta t}{12} (k_x^4 h_x^2 + k_y^4 h_y^2)\\right] + \\nu \\Delta t (k_x^2 + k_y^2) = \\frac{\\nu \\Delta t}{12} (k_x^4 h_x^2 + k_y^4 h_y^2)\n$$\nThe denominator of $E(\\psi)$ is $\\nu \\Delta t (k_x^2+k_y^2) = \\nu \\Delta t k^2$. Thus, the leading-order expression for $E(\\psi)$ is:\n$$\nE(\\psi) = \\frac{\\frac{\\nu \\Delta t}{12} (k_x^4 h_x^2 + k_y^4 h_y^2)}{\\nu \\Delta t k^2} = \\frac{k_x^4 h_x^2 + k_y^4 h_y^2}{12 k^2}\n$$\nFinally, we express this in terms of the magnitude $k$ and angle $\\psi$ of the wavevector, using $k_x = k\\cos\\psi$ and $k_y = k\\sin\\psi$:\n$$\nE(\\psi) = \\frac{(k\\cos\\psi)^4 h_x^2 + (k\\sin\\psi)^4 h_y^2}{12 k^2} = \\frac{k^4 \\cos^4\\psi \\, h_x^2 + k^4 \\sin^4\\psi \\, h_y^2}{12 k^2}\n$$\n$$\nE(\\psi) = \\frac{k^2}{12} (h_x^2 \\cos^4\\psi + h_y^2 \\sin^4\\psi)\n$$\nThis expression quantifies the leading-order anisotropy of the numerical dissipation.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{1 - 2\\nu \\Delta t \\left( \\frac{\\sin^{2}(\\theta_{x}/2)}{h_{x}^{2}} + \\frac{\\sin^{2}(\\theta_{y}/2)}{h_{y}^{2}} \\right)}{1 + 2\\nu \\Delta t \\left( \\frac{\\sin^{2}(\\theta_{x}/2)}{h_{x}^{2}} + \\frac{\\sin^{2}(\\theta_{y}/2)}{h_{y}^{2}} \\right)}  \\frac{k^{2}}{12} \\left( h_{x}^{2} \\cos^{4}\\psi + h_{y}^{2} \\sin^{4}\\psi \\right)\n\\end{pmatrix}\n}\n$$", "id": "3360636"}]}