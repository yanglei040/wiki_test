{"hands_on_practices": [{"introduction": "To effectively apply slope limiters, one must first develop an intuition for their distinct behaviors. This exercise provides a direct, hands-on comparison of three classic limiters: minmod, superbee, and van Leer. By computing their outputs for a set of representative slope ratios ($r$), you will uncover their inherent characteristics, from the highly diffusive nature of minmod to the aggressive, compressive properties of superbee, providing a clear rationale for choosing one over another based on the desired simulation properties [@problem_id:3394934].", "problem": "Consider the scalar linear advection equation $\\partial_t u + a \\,\\partial_x u = 0$ with constant advection speed $a>0$, discretized by a conservative finite volume method with piecewise linear reconstruction and a slope limiter to enforce the Total Variation Diminishing (TVD) property. Let the slope ratio be defined at cell $i$ by $r_i = \\dfrac{\\Delta^- u_i}{\\Delta^+ u_i}$, where $\\Delta^- u_i = u_i - u_{i-1}$ and $\\Delta^+ u_i = u_{i+1} - u_i$. In a flux-limiter formulation, the limited slope used to reconstruct the left state at the cell interface $x_{i+1/2}$ is taken as $\\sigma_i = \\phi(r_i)\\,\\Delta^- u_i$, where $\\phi$ is a limiter function satisfying TVD admissibility.\n\nUse the following standard limiter functions, each defined on $\\mathbb{R}$:\n- The minmod limiter: $\\phi_{\\text{mm}}(r) = \\max\\!\\big(0,\\min(1,r)\\big)$.\n- The superbee limiter: $\\phi_{\\text{sb}}(r) = \\max\\!\\big(0,\\min(2r,1),\\min(r,2)\\big)$.\n- The van Leer limiter: $\\phi_{\\text{VL}}(r) = \\dfrac{r + |r|}{1 + |r|}$.\n\nCompute the values of $\\phi_{\\text{mm}}(r)$, $\\phi_{\\text{sb}}(r)$, and $\\phi_{\\text{VL}}(r)$ for $r \\in \\{0,\\,0.5,\\,1,\\,2,\\,\\infty\\}$, interpreting $\\infty$ as the one-sided limit $r\\to +\\infty$. Then, based on the role $\\sigma_i = \\phi(r_i)\\,\\Delta^- u_i$ plays in the interface reconstruction $u_{i+1/2}^- = u_i + \\tfrac{1}{2}\\sigma_i$, discuss the implications of your computed values for the steepness and compressiveness of the reconstructed interface gradients in smooth monotone regions ($r \\ge 0$).\n\nExpress your final combined set of values as a single row matrix in the order\n$\\big[\\phi_{\\text{mm}}(0),\\,\\phi_{\\text{sb}}(0),\\,\\phi_{\\text{VL}}(0),\\,\\phi_{\\text{mm}}(0.5),\\,\\phi_{\\text{sb}}(0.5),\\,\\phi_{\\text{VL}}(0.5),\\,\\phi_{\\text{mm}}(1),\\,\\phi_{\\text{sb}}(1),\\,\\phi_{\\text{VL}}(1),\\,\\phi_{\\text{mm}}(2),\\,\\phi_{\\text{sb}}(2),\\,\\phi_{\\text{VL}}(2),\\,\\phi_{\\text{mm}}(\\infty),\\,\\phi_{\\text{sb}}(\\infty),\\,\\phi_{\\text{VL}}(\\infty)\\big]$.\n\nNo rounding is required. Provide no units.", "solution": "The problem is found to be valid as it is scientifically grounded in the established theory of numerical methods for partial differential equations, is well-posed with all necessary definitions provided, and is expressed in objective, formal language. We may, therefore, proceed with the solution.\n\nThe problem requires the computation of the values of three standard slope limiter functions, $\\phi(r)$, for a given set of slope ratios $r$, and a subsequent discussion on the implications for the numerical scheme. The slope ratio is defined as $r_i = \\frac{\\Delta^- u_i}{\\Delta^+ u_i} = \\frac{u_i - u_{i-1}}{u_{i+1} - u_i}$. The three limiter functions are:\n- Minmod: $\\phi_{\\text{mm}}(r) = \\max\\!\\big(0,\\min(1,r)\\big)$\n- Superbee: $\\phi_{\\text{sb}}(r) = \\max\\!\\big(0,\\min(2r,1),\\min(r,2)\\big)$\n- Van Leer: $\\phi_{\\text{VL}}(r) = \\dfrac{r + |r|}{1 + |r|}$\n\nWe will compute the values of these functions for $r \\in \\{0,\\,0.5,\\,1,\\,2,\\,\\infty\\}$. For $r \\ge 0$, the van Leer limiter simplifies, since $|r|=r$:\n$\\phi_{\\text{VL}}(r) = \\dfrac{r + r}{1 + r} = \\dfrac{2r}{1+r}$ for $r \\ge 0$.\n\nLet's compute the values for each $r$.\n\n**Case 1: $r = 0$**\n- $\\phi_{\\text{mm}}(0) = \\max\\!\\big(0,\\min(1,0)\\big) = \\max(0,0) = 0$.\n- $\\phi_{\\text{sb}}(0) = \\max\\!\\big(0,\\min(2 \\cdot 0,1),\\min(0,2)\\big) = \\max(0,\\min(0,1),\\min(0,2)\\big) = \\max(0,0,0) = 0$.\n- $\\phi_{\\text{VL}}(0) = \\dfrac{2 \\cdot 0}{1+0} = 0$.\n\n**Case 2: $r = 0.5$**\n- $\\phi_{\\text{mm}}(0.5) = \\max\\!\\big(0,\\min(1,0.5)\\big) = \\max(0,0.5) = 0.5 = \\frac{1}{2}$.\n- $\\phi_{\\text{sb}}(0.5) = \\max\\!\\big(0,\\min(2 \\cdot 0.5,1),\\min(0.5,2)\\big) = \\max(0,\\min(1,1),\\min(0.5,2)\\big) = \\max(0,1,0.5) = 1$.\n- $\\phi_{\\text{VL}}(0.5) = \\dfrac{2 \\cdot 0.5}{1+0.5} = \\dfrac{1}{1.5} = \\dfrac{2}{3}$.\n\n**Case 3: $r = 1$**\n- $\\phi_{\\text{mm}}(1) = \\max\\!\\big(0,\\min(1,1)\\big) = \\max(0,1) = 1$.\n- $\\phi_{\\text{sb}}(1) = \\max\\!\\big(0,\\min(2 \\cdot 1,1),\\min(1,2)\\big) = \\max(0,\\min(2,1),\\min(1,2)\\big) = \\max(0,1,1) = 1$.\n- $\\phi_{\\text{VL}}(1) = \\dfrac{2 \\cdot 1}{1+1} = \\dfrac{2}{2} = 1$.\n\n**Case 4: $r = 2$**\n- $\\phi_{\\text{mm}}(2) = \\max\\!\\big(0,\\min(1,2)\\big) = \\max(0,1) = 1$.\n- $\\phi_{\\text{sb}}(2) = \\max\\!\\big(0,\\min(2 \\cdot 2,1),\\min(2,2)\\big) = \\max(0,\\min(4,1),\\min(2,2)\\big) = \\max(0,1,2) = 2$.\n- $\\phi_{\\text{VL}}(2) = \\dfrac{2 \\cdot 2}{1+2} = \\dfrac{4}{3}$.\n\n**Case 5: $r \\to \\infty$**\n- $\\lim_{r\\to\\infty} \\phi_{\\text{mm}}(r) = \\lim_{r\\to\\infty} \\max\\!\\big(0,\\min(1,r)\\big) = \\max(0,1) = 1$.\n- $\\lim_{r\\to\\infty} \\phi_{\\text{sb}}(r) = \\lim_{r\\to\\infty} \\max\\!\\big(0,\\min(2r,1),\\min(r,2)\\big)$. For $r \\ge 2$, this simplifies to $\\max(0,1,2) = 2$. Thus, the limit is $2$.\n- $\\lim_{r\\to\\infty} \\phi_{\\text{VL}}(r) = \\lim_{r\\to\\infty} \\dfrac{2r}{1+r} = \\lim_{r\\to\\infty} \\dfrac{2}{1/r+1} = \\dfrac{2}{0+1} = 2$.\n\nThe computed values are summarized in the final answer matrix.\n\n**Discussion of Implications**\n\nThe problem states that the limited slope for reconstruction is $\\sigma_i = \\phi(r_i)\\,\\Delta^- u_i$, which is used in the interface value calculation $u_{i+1/2}^- = u_i + \\frac{1}{2}\\sigma_i$. This means the reconstructed slope in cell $i$ is effectively proportional to $\\phi(r_i)$. The magnitude of $\\phi(r_i)$ determines the steepness of the reconstructed gradient. The analysis is for smooth monotone regions, where $r \\ge 0$.\n\n- A value of $\\phi(r)=0$ corresponds to a zero-slope, piecewise constant reconstruction, which is a first-order upwind scheme. This is the most dissipative case. All three limiters yield $\\phi(0)=0$, which occurs at local extrema ($u_i - u_{i-1} = 0$ or $u_{i+1}-u_i$ is infinite). This prevents the formation of new oscillations.\n\n- A value of $\\phi(r)=1$ means the scheme uses the unmodified backward difference $\\Delta^- u_i$ as the slope. In a region of uniform gradient ($u_i - u_{i-1} = u_{i+1} - u_i$, so $r=1$), all three limiters have $\\phi(1)=1$. This allows the scheme to be second-order accurate in such regions.\n\n- When $\\phi(r) < 1$, the scheme is using a slope that is smaller in magnitude than the local upwind gradient, making it more dissipative or \"diffusive\" than a standard second-order upwind scheme. This tends to smear sharp features.\n\n- When $\\phi(r) > 1$, the scheme is \"compressive\" or \"anti-diffusive\". It reconstructs a slope steeper than the upwind gradient, which is desirable for sharpening discontinuities like shocks or contact surfaces.\n\nBased on the computed values:\n\n- **Minmod ($\\phi_{\\text{mm}}$)**: For all $r \\ge 0$, we have $0 \\le \\phi_{\\text{mm}}(r) \\le 1$. It is the most dissipative of the three limiters. It strongly limits the slope unless the gradient is perfectly uniform ($r=1$). Its tendency is to smooth out profiles, which is robust against oscillations but can excessively smear sharp features. At $r=0.5$, $\\phi_{\\text{mm}}=0.5$, while the others are larger. For $r \\ge 1$, $\\phi_{\\text{mm}}(r)$ saturates at $1$.\n\n- **Superbee ($\\phi_{\\text{sb}}$)**: For $r \\in (0.5, \\infty)$, we have $\\phi_{\\text{sb}}(r) > 1$. It is the most compressive limiter. At $r=0.5$, $\\phi_{\\text{sb}}=1$, and at $r=2$, $\\phi_{\\text{sb}}=2$. It aims to reconstruct the steepest possible non-oscillatory profiles. This is highly effective for resolving sharp discontinuities but can sometimes introduce small artefacts like the \"squaring\" of smooth peaks.\n\n- **Van Leer ($\\phi_{\\text{VL}}$)**: This limiter offers a balance. It is compressive for $r > 1$, as $\\phi_{\\text{VL}}(r) = \\frac{2r}{1+r} > 1$ for $r > 1$. However, it is less aggressive than Superbee (e.g., at $r=2$, $\\phi_{\\text{VL}} = 4/3 \\approx 1.33$ while $\\phi_{\\text{sb}}=2$). It generally produces sharp yet smooth profiles, making it a popular choice. Its value is always between that of minmod and superbee for $r>0$: $\\phi_{\\text{mm}}(r) \\le \\phi_{\\text{VL}}(r) \\le \\phi_{\\text{sb}}(r)$.\n\nIn summary, the choice of limiter represents a trade-off between the desire for sharp resolution of discontinuities (compressiveness) and the prevention of numerical oscillations (diffusiveness). Superbee is the most compressive, minmod is the most diffusive, and van Leer provides an effective compromise between the two.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0 & 0 & 0 & \\frac{1}{2} & 1 & \\frac{2}{3} & 1 & 1 & 1 & 1 & 2 & \\frac{4}{3} & 1 & 2 & 2\n\\end{pmatrix}\n}\n$$", "id": "3394934"}, {"introduction": "Understanding a limiter function's behavior is crucial, but its true utility is realized within the framework of a numerical scheme. This problem bridges the gap between theory and practice by guiding you through a complete computational step of a MUSCL-type finite volume method [@problem_id:3394920]. Using a specific data set, you will calculate the slope ratio $r_i$, apply the van Leer limiter to determine the appropriate slope, reconstruct the solution values at the cell interface, and finally compute the resulting numerical flux, thereby cementing the mechanical procedure at the heart of high-resolution schemes.", "problem": "Consider the one-dimensional scalar conservation law $u_{t} + a\\,u_{x} = 0$ with constant advection speed $a>0$, discretized by a finite volume method on a uniform grid with cells indexed by $i \\in \\mathbb{Z}$ and cell centers at $x_{i}$. To obtain second-order accurate and Total Variation Diminishing (TVD) numerical fluxes, reconstruct a piecewise linear approximation in each cell using a slope limiter function $\\phi(r)$ applied to the ratio of successive discrete gradients. \n\nStarting from the finite volume framework and the requirement that the reconstructed interface states be consistent with TVD constraints and second-order accuracy in smooth regions, derive the expressions for the left state at the right interface $u_{i+1/2}^{-}$ and the right state at the left interface $u_{i-1/2}^{+}$ in terms of the local backward and forward differences $\\Delta^{-}_{i} := u_{i} - u_{i-1}$ and $\\Delta^{+}_{i} := u_{i+1} - u_{i}$, and the ratio $r_{i} := \\Delta^{-}_{i}/\\Delta^{+}_{i}$. The limiter function to be used is the van Leer limiter\n$$\n\\phi_{\\mathrm{VL}}(r) = \\frac{r + |r|}{1 + |r|}.\n$$\nThen, specialize to the discrete data $u_{i-1} = 1.2$, $u_{i} = 1.8$, $u_{i+1} = 2.0$, and advection speed $a = 2.5$ (treat all quantities as dimensionless). Evaluate $u_{i+1/2}^{-}$ and $u_{i-1/2}^{+}$ numerically for this data, and determine the upwind numerical flux at the interface $x_{i+1/2}$ for $a>0$. Express the final numerical flux value at $x_{i+1/2}$ as a pure number. No rounding is required; provide the exact decimal value.", "solution": "The problem requires the derivation and application of a second-order, Total Variation Diminishing (TVD) finite volume scheme for the linear advection equation. This is accomplished using a piecewise linear reconstruction of the solution within each computational cell, where the slope of the linear function is limited to prevent spurious oscillations.\n\nFirst, the problem statement is validated.\n- **Givens**:\n    - PDE: $u_{t} + a\\,u_{x} = 0$, with constant advection speed $a > 0$.\n    - Numerical Method: Finite volume on a uniform grid, cells indexed by $i$.\n    - Reconstruction: Piecewise linear with a slope limiter function $\\phi(r)$.\n    - Definitions: $\\Delta^{-}_{i} := u_{i} - u_{i-1}$, $\\Delta^{+}_{i} := u_{i+1} - u_{i}$, $r_{i} := \\Delta^{-}_{i}/\\Delta^{+}_{i}$.\n    - Limiter: van Leer limiter, $\\phi_{\\mathrm{VL}}(r) = \\frac{r + |r|}{1 + |r|}$.\n    - Data: $u_{i-1} = 1.2$, $u_{i} = 1.8$, $u_{i+1} = 2.0$, $a = 2.5$.\n    - Task: Derive expressions for $u_{i+1/2}^{-}$ and $u_{i-1/2}^{+}$, evaluate them numerically, and find the upwind numerical flux at $x_{i+1/2}$.\n- **Validation**:\n    - The problem is scientifically grounded, describing a standard MUSCL-type scheme for hyperbolic conservation laws.\n    - It is well-posed, providing all necessary information for a unique solution.\n    - It is objective and uses standard, unambiguous terminology from the field of computational fluid dynamics.\n- **Verdict**: The problem is valid.\n\nWe proceed with the solution.\n\nA piecewise linear reconstruction for the solution $u(x)$ within cell $i$, which extends from $x_{i-1/2}$ to $x_{i+1/2}$, is given by:\n$$\nu_i(x) = u_i + \\sigma_i (x - x_i)\n$$\nwhere $u_i$ is the cell-average value in cell $i$, $x_i$ is the cell center, and $\\sigma_i$ is the limited slope of the solution in that cell. The cell width is $\\Delta x = x_{i+1/2} - x_{i-1/2}$.\n\nThe reconstructed values at the cell interfaces are obtained by evaluating this linear function at the cell boundaries, $x_{i \\pm 1/2} = x_i \\pm \\frac{\\Delta x}{2}$.\nThe value at the right interface of cell $i$ (which is the left state $u_{i+1/2}^{-}$ for the Riemann problem at interface $x_{i+1/2}$) is:\n$$\nu_{i+1/2}^{-} = u_i(x_{i+1/2}) = u_i + \\sigma_i (x_{i+1/2} - x_i) = u_i + \\frac{1}{2} \\sigma_i \\Delta x\n$$\nThe value at the left interface of cell $i$ (which is the right state $u_{i-1/2}^{+}$ for the Riemann problem at interface $x_{i-1/2}$) is:\n$$\nu_{i-1/2}^{+} = u_i(x_{i-1/2}) = u_i + \\sigma_i (x_{i-1/2} - x_i) = u_i - \\frac{1}{2} \\sigma_i \\Delta x\n$$\nThe quantity $\\sigma_i \\Delta x$ represents the limited change in $u$ across cell $i$. In schemes employing a limiter function $\\phi(r)$, this limited change is typically expressed as the product of the limiter function and a characteristic undivided difference. A common convention, consistent with the problem's definition of $r_i$, is to relate the slope to the forward difference $\\Delta^{+}_{i} = u_{i+1} - u_i$:\n$$\n\\sigma_i \\Delta x = \\phi(r_i) \\Delta^{+}_{i}\n$$\nwhere $r_i = \\Delta^{-}_{i} / \\Delta^{+}_{i} = (u_i - u_{i-1}) / (u_{i+1} - u_i)$.\n\nSubstituting this definition of the limited slope into the expressions for the interface states, we obtain the general formulas requested:\n$$\nu_{i+1/2}^{-} = u_i + \\frac{1}{2} \\phi(r_i) (u_{i+1} - u_i)\n$$\n$$\nu_{i-1/2}^{+} = u_i - \\frac{1}{2} \\phi(r_i) (u_{i+1} - u_i)\n$$\n\nNow, we apply these formulas to the given numerical data:\n$u_{i-1} = 1.2$, $u_{i} = 1.8$, $u_{i+1} = 2.0$.\n\nFirst, we compute the backward and forward differences for cell $i$:\n$$\n\\Delta^{-}_{i} = u_i - u_{i-1} = 1.8 - 1.2 = 0.6\n$$\n$$\n\\Delta^{+}_{i} = u_{i+1} - u_i = 2.0 - 1.8 = 0.2\n$$\nNext, we compute the ratio $r_i$:\n$$\nr_i = \\frac{\\Delta^{-}_{i}}{\\Delta^{+}_{i}} = \\frac{0.6}{0.2} = 3\n$$\nWe evaluate the van Leer limiter function $\\phi_{\\mathrm{VL}}(r)$ at $r=3$:\n$$\n\\phi_{\\mathrm{VL}}(3) = \\frac{3 + |3|}{1 + |3|} = \\frac{3 + 3}{1 + 3} = \\frac{6}{4} = 1.5\n$$\nNow we can compute the numerical values for the interface states:\n$$\nu_{i+1/2}^{-} = u_i + \\frac{1}{2} \\phi_{\\mathrm{VL}}(r_i) \\Delta^{+}_{i} = 1.8 + \\frac{1}{2}(1.5)(0.2) = 1.8 + (0.75)(0.2) = 1.8 + 0.15 = 1.95\n$$\n$$\nu_{i-1/2}^{+} = u_i - \\frac{1}{2} \\phi_{\\mathrm{VL}}(r_i) \\Delta^{+}_{i} = 1.8 - \\frac{1}{2}(1.5)(0.2) = 1.8 - 0.15 = 1.65\n$$\n\nFinally, we determine the upwind numerical flux at the interface $x_{i+1/2}$. The physical flux for the conservation law $u_t + (au)_x = 0$ is $f(u) = au$. The characteristic speed is $f'(u) = a$.\nGiven $a = 2.5 > 0$, the information propagates from left to right. Therefore, the upwind flux at interface $x_{i+1/2}$ is determined by the state on the left side of the interface, which is $u_{i+1/2}^{-}$.\nThe numerical flux $F_{i+1/2}$ is given by the Godunov flux, which for linear advection simplifies to the upwind flux:\n$$\nF_{i+1/2} = f(u_{i+1/2}^{-}) = a \\cdot u_{i+1/2}^{-}\n$$\nSubstituting the values $a=2.5$ and $u_{i+1/2}^{-} = 1.95$:\n$$\nF_{i+1/2} = 2.5 \\times 1.95 = \\frac{5}{2} \\times \\frac{195}{100} = \\frac{5}{2} \\times \\frac{39}{20} = \\frac{1}{2} \\times \\frac{39}{4} = \\frac{39}{8} = 4.875\n$$\nThe value of the numerical flux at the interface $x_{i+1/2}$ is $4.875$.", "answer": "$$\\boxed{4.875}$$", "id": "3394920"}, {"introduction": "Beyond individual calculations, a deeper understanding of a numerical scheme comes from analyzing its overall behavior. This practice introduces modified equation analysis, a powerful tool for predicting the performance of a TVD scheme when resolving sharp features like shocks [@problem_id:3394949]. By adopting the key assumption that limiters revert to first-order accuracy within a shock layer, you will derive an analytical expression for the numerical shock thickness, revealing how artificial diffusion, governed by the Courant number $\\nu$, dictates the resolution of discontinuities regardless of the specific higher-order limiter used in smooth regions.", "problem": "Consider the linear advection equation $u_t + a\\,u_x = 0$ with constant advective speed $a > 0$ on a uniform grid of spacing $\\Delta x$ and time step $\\Delta t$, and define the Courant–Friedrichs–Lewy (CFL) number as $\\nu = a\\,\\Delta t / \\Delta x$. A high-resolution explicit finite-volume scheme using a Total Variation Diminishing (TVD) flux limiter function $\\phi(r)$ is applied with a standard slope ratio $r$ constructed from adjacent solution differences for $a>0$. The limiter functions are given by\n$$\n\\phi_{\\mathrm{MM}}(r) = \\max\\!\\big(0,\\, \\min(1,\\,r)\\big),\\quad\n\\phi_{\\mathrm{SB}}(r) = \\max\\!\\big(0,\\, \\min(2r,\\,1),\\, \\min(r,\\,2)\\big),\\quad\n\\phi_{\\mathrm{VL}}(r) = \\frac{r + |r|}{1 + |r|},\n$$\ncorresponding to the minmod, superbee, and van Leer limiters, respectively.\n\nStarting from the foundational flux-conservative update for linear advection and the TVD high-resolution flux representation with limiter $\\phi(r)$, perform a modified equation analysis to leading nontrivial order in $\\Delta x$ and $\\Delta t$ that is valid for smooth regions ($r \\approx 1$) and for the core of a monotone discontinuity ($r \\approx 0$). Extract the equivalent diffusion coefficient $\\beta$ and dispersion coefficient $\\gamma$ in the formal modified equation\n$$\nu_t + a\\,u_x = \\beta\\,u_{xx} + \\gamma\\,u_{xxx} + \\text{higher-order terms}.\n$$\nThen, assuming the internal shock layer is monotone and the limiter forces first-order behavior in the shock core, estimate the shock thickness $\\delta$ by balancing advection and the leading artificial diffusion in the layer. Provide the final analytical expression for the predicted shock thickness $\\delta$ as a function of $\\Delta x$ and $\\nu$ for each limiter (minmod, superbee, and van Leer). Your final answer must be a single analytical expression; if you provide multiple values, write them as entries of a single row matrix. No rounding is required, and no physical units should be included in the final expression.", "solution": "The user wants to find the shock thickness for a high-resolution TVD scheme applied to the linear advection equation, $u_t + a\\,u_x = 0$ with $a>0$. The solution requires performing a modified equation analysis and then using a specific assumption about the behavior of the scheme inside a shock layer.\n\nThe finite-volume scheme for a cell $j$ with width $\\Delta x$ is given by\n$$u_j^{n+1} = u_j^n - \\frac{\\Delta t}{\\Delta x} \\left( f_{j+1/2} - f_{j-1/2} \\right)$$\nwhere $f_{j+1/2}$ is the numerical flux at the interface between cells $j$ and $j+1$. For a high-resolution TVD scheme, the flux can be expressed as a correction to a first-order upwind flux. Since $a>0$, the upwind direction is from the left. A standard form for the numerical flux using a limiter function $\\phi(r)$ is:\n$$f_{j+1/2} = a u_j + \\frac{a}{2}(1-\\nu) \\phi(r_j) (u_{j+1}-u_j)$$\nwhere $\\nu = a \\Delta t / \\Delta x$ is the CFL number, and $r_j$ is the ratio of consecutive solution gradients, defined for upwind schemes as:\n$$r_j = \\frac{u_j - u_{j-1}}{u_{j+1} - u_j}$$\nThe term $\\frac{a}{2}(1-\\nu)(u_{j+1}-u_j)$ represents the anti-diffusive flux of the second-order Lax-Wendroff scheme, which is being limited by $\\phi(r_j)$.\n\nThe problem first asks for a modified equation analysis to find the equivalent diffusion ($\\beta$) and dispersion ($\\gamma$) coefficients in the formal equation $u_t + a\\,u_x = \\beta\\,u_{xx} + \\gamma\\,u_{xxx} + \\dots$. This analysis is requested for two regimes: smooth regions ($r \\approx 1$) and the shock core ($r \\approx 0$).\n\nHowever, for the final part of the problem—estimating the shock thickness $\\delta$—we are given a specific instruction: \"assuming the internal shock layer is monotone and the limiter forces first-order behavior in the shock core, estimate the shock thickness $\\delta$ by balancing advection and the leading artificial diffusion in the layer.\"\n\nThis assumption is critical. First-order behavior implies that the higher-order corrective flux term is negligible or zero. For the given flux formulation, this occurs when $\\phi(r)=0$. The scheme then reduces to the first-order upwind scheme:\n$$f_{j+1/2} = a u_j$$\nThe finite-volume update becomes:\n$$u_j^{n+1} = u_j^n - \\frac{\\Delta t}{\\Delta x} (a u_j - a u_{j-1}) = u_j^n - \\nu (u_j - u_{j-1})$$\n\nWe perform a modified equation analysis on the first-order upwind scheme. We expand the terms in a Taylor series around the point $(x_j, t_n)$:\n$$\\frac{u_j^{n+1} - u_j^n}{\\Delta t} = u_t + \\frac{\\Delta t}{2}u_{tt} + \\mathcal{O}(\\Delta t^2)$$\n$$-a \\frac{u_j - u_{j-1}}{\\Delta x} = -a \\left( u_x - \\frac{\\Delta x}{2}u_{xx} + \\frac{\\Delta x^2}{6}u_{xxx} + \\mathcal{O}(\\Delta x^3) \\right)$$\nEquating these and rearranging gives:\n$$u_t + a u_x = -\\frac{\\Delta t}{2}u_{tt} + \\frac{a\\Delta x}{2}u_{xx} - \\frac{a\\Delta x^2}{6}u_{xxx} + \\dots$$\nTo obtain the leading error terms in space, we eliminate the time derivative $u_{tt}$ by repeatedly using the original PDE, $u_t = -a u_x$, giving $u_{tt} = a^2 u_{xx}$. Substituting this into the equation yields:\n$$u_t + a u_x = -\\frac{\\Delta t}{2}(a^2 u_{xx}) + \\frac{a\\Delta x}{2}u_{xx} + \\mathcal{O}(\\Delta x^2)$$\n$$u_t + a u_x = \\left(\\frac{a\\Delta x}{2} - \\frac{a^2\\Delta t}{2}\\right) u_{xx} + \\mathcal{O}(\\Delta x^2)$$\nThe coefficient of the $u_{xx}$ term is the artificial diffusion coefficient, $\\beta$. Factoring out common terms and using the definition of the CFL number $\\nu = a \\Delta t / \\Delta x$:\n$$\\beta = \\frac{a\\Delta x}{2} \\left(1 - \\frac{a\\Delta t}{\\Delta x}\\right) = \\frac{a\\Delta x}{2} (1-\\nu)$$\nThis is the well-known artificial diffusion of the first-order upwind scheme. According to the problem's assumption, this is the leading diffusive behavior in the shock core.\n\nThe next step is to estimate the shock thickness, $\\delta$. This is done by balancing the magnitudes of the advection term and the dominant artificial diffusion term within the shock layer. Let the total change in the solution across the shock be $\\Delta u$. The gradient and curvature can be approximated as:\n$$u_x \\sim \\frac{\\Delta u}{\\delta}$$\n$$u_{xx} \\sim \\frac{\\Delta u}{\\delta^2}$$\nThe balance between advection and diffusion in the modified equation is:\n$$a u_x \\approx \\beta u_{xx}$$\n$$a \\frac{\\Delta u}{\\delta} \\approx \\beta \\frac{\\Delta u}{\\delta^2}$$\nSolving for the shock thickness $\\delta$ gives:\n$$\\delta \\approx \\frac{\\beta}{a}$$\nSubstituting the expression for $\\beta$ for the first-order upwind scheme:\n$$\\delta \\approx \\frac{\\frac{a\\Delta x}{2}(1-\\nu)}{a} = \\frac{\\Delta x}{2}(1-\\nu)$$\nThe problem asks for the shock thickness for each of the three limiters: minmod, superbee, and van Leer. The given limiters are:\n$$\\phi_{\\mathrm{MM}}(r) = \\max\\!\\big(0,\\, \\min(1,\\,r)\\big)$$\n$$\\phi_{\\mathrm{SB}}(r) = \\max\\!\\big(0,\\, \\min(2r,\\,1),\\, \\min(r,\\,2)\\big)$$\n$$\\phi_{\\mathrm{VL}}(r) = \\frac{r + |r|}{1 + |r|}$$\nAll of these limiters are designed to revert to first-order accuracy at sharp gradients or local extrema to prevent oscillations, which is a condition for being TVD. This is achieved by ensuring $\\phi(r) \\to 0$ when the local solution profile is not smooth (e.g., for $r \\le 0$). The problem's assumption to use a first-order model for the shock core is a formalization of this behavior. Since the calculation of $\\delta$ is based solely on this assumption, the result is independent of the specific limiter function. The estimated shock thickness is therefore the same for all three limiters.\n\nThe final answer is the analytical expression for $\\delta$ for each limiter. As they are identical, we will list the same expression three times.\n\nFinal Expression:\n$$\\delta = \\frac{\\Delta x}{2}(1-\\nu)$$\n\nWe provide this result for each of the three limiters as requested.", "answer": "$$\\boxed{\\begin{pmatrix} \\frac{\\Delta x}{2}(1-\\nu) & \\frac{\\Delta x}{2}(1-\\nu) & \\frac{\\Delta x}{2}(1-\\nu) \\end{pmatrix}}$$", "id": "3394949"}]}