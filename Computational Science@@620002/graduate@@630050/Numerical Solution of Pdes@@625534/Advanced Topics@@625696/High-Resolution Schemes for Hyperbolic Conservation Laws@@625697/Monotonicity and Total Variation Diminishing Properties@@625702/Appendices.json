{"hands_on_practices": [{"introduction": "Before we can analyze schemes that aim to diminish total variation, we must have a firm grasp of what Total Variation ($TV$) truly represents. This foundational exercise connects the abstract mathematical definition of $TV$, which involves a supremum over all possible partitions, to the intuitive and practical formula for a piecewise constant function [@problem_id:3422971]. By proving that the $TV$ of such a function is simply the sum of the absolute jumps at its discontinuities, you will build a concrete understanding of this crucial concept from first principles.", "problem": "Consider a finite interval $\\left[a,b\\right]$ with a partition $a=x_{0}<x_{1}<\\cdots<x_{N}=b$. Define the half-open cells $I_{j}=\\left(x_{j-1},x_{j}\\right]$ for $j\\in\\{1,\\dots,N\\}$, and let the piecewise constant function $u:\\left[a,b\\right]\\to\\mathbb{R}$ be given by $u(x)=\\sum_{j=1}^{N}u_{j}\\,\\chi_{I_{j}}(x)$, where $\\chi_{I_{j}}$ denotes the characteristic function of $I_{j}$ and the constants $u_{j}\\in\\mathbb{R}$ are arbitrary. Assume $u(x_{0})=u_{1}$ so that $u$ is well-defined at the left endpoint. The total variation $\\mathrm{TV}(u;[a,b])$ of $u$ on $\\left[a,b\\right]$ is defined via the Jordan supremum over partitions: \n$$\n\\mathrm{TV}(u;[a,b])=\\sup_{P}\\sum_{i=0}^{m-1}\\left|u\\!\\left(x^{(i+1)}\\right)-u\\!\\left(x^{(i)}\\right)\\right|,\n$$\nwhere the supremum is over all finite partitions $P:\\ a=x^{(0)}<x^{(1)}<\\cdots<x^{(m)}=b$ of $\\left[a,b\\right]$. Using only this definition and elementary properties of absolute values, compute $\\mathrm{TV}(u;[a,b])$ explicitly in terms of the cell constants $\\{u_{j}\\}_{j=1}^{N}$, and justify that it equals the sum of jump magnitudes across the cell interfaces $\\{x_{1},\\dots,x_{N-1}\\}$. Express your final answer as a single closed-form analytic expression. No rounding is required, and no physical units are involved. This explicit computation is a foundational step in understanding the Total Variation Diminishing (TVD) property in conservative numerical schemes for partial differential equations.", "solution": "The problem is to compute the total variation of a given piecewise constant function $u(x)$ on the interval $[a,b]$. The problem is well-posed and contains all necessary information for a rigorous solution. We will proceed by first establishing an upper bound for the total variation and then demonstrating that this bound is attainable, thereby proving it is the supremum.\n\nThe problem defines the function $u:\\left[a,b\\right]\\to\\mathbb{R}$ as $u(x)=\\sum_{j=1}^{N}u_{j}\\,\\chi_{I_{j}}(x)$ with $I_{j}=\\left(x_{j-1},x_{j}\\right]$, along with the condition $u(x_0)=u_1$, where $a=x_0<x_1<\\cdots<x_N=b$. This definition implies the following values at the partition points $\\{x_j\\}$:\n\\begin{itemize}\n    \\item $u(x_0) = u_1$ (given explicitly).\n    \\item For $j \\in \\{1, \\dots, N\\}$, the point $x_j$ belongs to the interval $I_j = (x_{j-1}, x_j]$. Therefore, $u(x_j)=u_j$.\n\\end{itemize}\nThe total variation is defined as $\\mathrm{TV}(u;[a,b])=\\sup_{P}\\sum_{i=0}^{m-1}\\left|u(x^{(i+1)})-u(x^{(i)})\\right|$, where the supremum is over all finite partitions $P:\\ a=x^{(0)}<x^{(1)}<\\cdots<x^{(m)}=b$ of $[a,b]$. Let $V(P, u)$ denote the sum for a given partition $P$.\n\nFirst, we establish an upper bound on $V(P, u)$. Let $P = \\{x^{(0)}, \\dots, x^{(m)}\\}$ be an arbitrary partition of $[a,b]$. Let $X_d = \\{x_1, \\dots, x_{N-1}\\}$ be the set of interfaces where the function definition rule changes. Consider a refined partition $P' = P \\cup X_d$. Let the points of $P'$ be $a=y_0<y_1<\\cdots<y_M=b$.\nIf we add a new point $z$ to an interval $[x^{(i)}, x^{(i+1)}]$ of $P$, the term $|u(x^{(i+1)}) - u(x^{(i)})|$ in the sum $V(P, u)$ is replaced by $|u(z) - u(x^{(i)})| + |u(x^{(i+1)}) - u(z)|$. By the triangle inequality, we have:\n$$|u(x^{(i+1)}) - u(x^{(i)})| = |(u(x^{(i+1)}) - u(z)) + (u(z) - u(x^{(i)}))| \\le |u(x^{(i+1)}) - u(z)| + |u(z) - u(x^{(i)})|$$\nThus, refining a partition cannot decrease the variation sum, i.e., $V(P, u) \\le V(P', u)$. This implies that the supremum of $V(P, u)$ must be less than or equal to any value that is an upper bound for all partitions $P'$ that contain $X_d$.\n\nLet's evaluate $V(P', u)$ for such a refined partition $P'$. We can split the sum over the fixed, coarse grid intervals $[x_{j-1}, x_j]$:\n$$V(P', u) = \\sum_{k=0}^{M-1} |u(y_{k+1}) - u(y_k)| = \\sum_{j=1}^{N} \\left( \\sum_{\\substack{k: \\\\ [y_k, y_{k+1}] \\subseteq [x_{j-1}, x_j]}} |u(y_{k+1}) - u(y_k)| \\right)$$\nLet $V_j$ be the inner sum, representing the variation over the sub-partition of $[x_{j-1}, x_j]$.\n\\begin{itemize}\n    \\item For $j=1$, the interval is $[x_0, x_1]$. We have $u(x_0)=u_1$. For any $x \\in (x_0, x_1]$, $u(x)=u_1$. Therefore, $u(x) = u_1$ for all $x \\in [x_0, x_1]$. The function is constant on this interval, so for any partition of $[x_0, x_1]$, the variation sum $V_1$ is $0$.\n    \\item For $j \\in \\{2, \\dots, N\\}$, the interval is $[x_{j-1}, x_j]$. For any sub-partition of this interval, let the points be $x_{j-1} = z_0 < z_1 < \\dots < z_p = x_j$.\n    We have $u(z_0) = u(x_{j-1}) = u_{j-1}$. For any point $z_i$ with $i \\ge 1$, $z_i \\in (x_{j-1}, x_j]$, so $u(z_i) = u_j$.\n    The variation sum for this sub-partition is:\n    $$V_j = \\sum_{i=0}^{p-1} |u(z_{i+1}) - u(z_i)| = |u(z_1) - u(z_0)| + \\sum_{i=1}^{p-1} |u(z_{i+1}) - u(z_i)|$$\n    $$V_j = |u_j - u_{j-1}| + \\sum_{i=1}^{p-1} |u_j - u_j| = |u_j - u_{j-1}| + 0 = |u_j - u_{j-1}|$$\n\\end{itemize}\nThe total sum for the refined partition $P'$ is therefore:\n$$V(P', u) = V_1 + \\sum_{j=2}^{N} V_j = 0 + \\sum_{j=2}^{N} |u_j - u_{j-1}| = \\sum_{j=1}^{N-1} |u_{j+1} - u_j|$$\nSince $V(P, u) \\le V(P', u)$ for any arbitrary partition $P$, we have established an upper bound for the total variation:\n$$\\mathrm{TV}(u;[a,b]) = \\sup_P V(P, u) \\le \\sum_{j=1}^{N-1} |u_{j+1} - u_j|$$\nNext, to prove that this upper bound is the supremum, we must show that it is the least upper bound. We can do this by constructing a sequence of partitions for which the variation sum approaches or equals this value.\nLet $\\epsilon > 0$ be a small number, chosen such that for all $j \\in \\{1,\\dots,N-1\\}$, $x_j + \\epsilon < x_{j+1}$ and $x_j - \\epsilon > x_{j-1}$. For example, we can choose $0 < \\epsilon < \\frac{1}{2} \\min_{j=1,\\dots,N} (x_j - x_{j-1})$.\nConsider the partition $P_\\epsilon$ defined by the points:\n$$P_\\epsilon = \\{x_0\\} \\cup \\bigcup_{j=1}^{N-1} \\{x_j - \\epsilon, x_j + \\epsilon\\} \\cup \\{x_N\\}$$\nLet's compute the variation sum $V(P_\\epsilon, u)$ by summing the absolute differences across the subintervals of $P_\\epsilon$.\n\\begin{itemize}\n    \\item Interval $[x_0, x_1 - \\epsilon]$: Both endpoints are in $[x_0, x_1]$ where $u(x)=u_1$, so $|u(x_1-\\epsilon) - u(x_0)| = |u_1 - u_1| = 0$.\n    \\item For $j \\in \\{1, \\dots, N-1\\}$, interval $[x_j-\\epsilon, x_j+\\epsilon]$: $x_j-\\epsilon \\in I_j$ (specifically $(x_{j-1}, x_j)$), so $u(x_j-\\epsilon)=u_j$. $x_j+\\epsilon \\in I_{j+1}$ (specifically $(x_j, x_{j+1})$), so $u(x_j+\\epsilon)=u_{j+1}$. The contribution is $|u_{j+1} - u_j|$.\n    \\item For $j \\in \\{1, \\dots, N-2\\}$, interval $[x_j+\\epsilon, x_{j+1}-\\epsilon]$: Both endpoints are in $I_{j+1}$, where $u(x)=u_{j+1}$. The contribution is $|u_{j+1} - u_{j+1}| = 0$.\n    \\item Interval $[x_{N-1}+\\epsilon, x_N]$: Both endpoints are in $I_N$, where $u(x)=u_N$. The contribution is $|u_N - u_N| = 0$.\n\\end{itemize}\nSumming all the non-zero contributions for the partition $P_\\epsilon$ yields:\n$$V(P_\\epsilon, u) = \\sum_{j=1}^{N-1} |u_{j+1} - u_j|$$\nWe have found a partition $P_\\epsilon$ for which the variation sum is exactly equal to our derived upper bound. Since the total variation is the supremum over all possible partitions, and we have found a partition that achieves this upper bound, this value must be the supremum.\n$$\\mathrm{TV}(u;[a,b]) = \\sum_{j=1}^{N-1} |u_{j+1} - u_j|$$\nThis expression is the sum of the magnitudes of the jumps in the function value across the cell interfaces $\\{x_1, \\dots, x_{N-1}\\}$. At each interface $x_j$, the function value jumps from a value of $u_j$ on $(x_{j-1}, x_j]$ to $u_{j+1}$ on $(x_j, x_{j+1}]$. The magnitude of this jump is $|u_{j+1} - u_j|$.", "answer": "$$\\boxed{\\sum_{j=1}^{N-1} |u_{j+1} - u_j|}$$", "id": "3422971"}, {"introduction": "In the pursuit of non-oscillatory solutions, it is common to pair a spatial discretization with a so-called \"Total Variation Diminishing\" Runge-Kutta (TVD-RK) time integrator. This practice serves as a critical analytical counter-example, demonstrating that this pairing is not a magic bullet for ensuring the TVD property [@problem_id:3422974]. By applying a TVD-RK3 scheme to a non-TVD central difference operator, you will find through direct calculation that the total variation can, and in this case does, increase, highlighting that the TVD property is a product of the entire fully-discrete scheme.", "problem": "Consider the scalar conservation law $u_{t} + f(u)_{x} = 0$ with convex flux $f(u) = \\frac{u^{2}}{2}$ on a uniform periodic grid with four points indexed $i \\in \\{0,1,2,3\\}$ and grid spacing $\\Delta x = 1$. Let the semi-discrete spatial operator be the central-difference conservative approximation\n$$\nL(u)_{i} \\equiv -\\frac{f(u_{i+1}) - f(u_{i-1})}{2 \\Delta x},\n$$\nwith periodic indexing. Advance one time step $\\Delta t > 0$ using the third-order Total Variation Diminishing Runge–Kutta (TVD-RK3) method, defined by the three-stage update\n$$\nu^{(1)} = u^{n} + \\Delta t\\, L(u^{n}), \\quad\nu^{(2)} = \\frac{3}{4} u^{n} + \\frac{1}{4}\\Big(u^{(1)} + \\Delta t\\, L(u^{(1)})\\Big), \\quad\nu^{n+1} = \\frac{1}{3} u^{n} + \\frac{2}{3}\\Big(u^{(2)} + \\Delta t\\, L(u^{(2)})\\Big).\n$$\nHere $u^{n}$ denotes the numerical solution vector at time level $n$. Let the initial data be $u^{n} = (u^{n}_{0},u^{n}_{1},u^{n}_{2},u^{n}_{3}) = (0,a,0,0)$ with $a > 0$. Define the discrete total variation by\n$$\n\\mathrm{TV}(u) \\equiv \\sum_{i=0}^{3} \\big|u_{i+1} - u_{i}\\big|,\n$$\nwith periodic indexing so that $u_{4} \\equiv u_{0}$. Using only the above definitions and the scheme specification, carry out a single TVD-RK3 step with the central spatial operator and determine the exact expression of the total variation increment $\\mathrm{TV}(u^{n+1}) - \\mathrm{TV}(u^{n})$ as a function of $a$ and $\\Delta t$, under the assumption $0 < \\Delta t < \\frac{4}{a}$ so that all absolute values appearing in the total variation can be evaluated without sign ambiguity. Your final answer must be the closed-form analytic expression for $\\mathrm{TV}(u^{n+1}) - \\mathrm{TV}(u^{n})$. No rounding is required.", "solution": "The user wants to find the increment in total variation after one time step using a specific numerical scheme.\n\n### Step 1: Extract Givens\n-   **Equation**: Scalar conservation law $u_{t} + f(u)_{x} = 0$.\n-   **Flux Function**: $f(u) = \\frac{u^{2}}{2}$. This is a convex function.\n-   **Grid**: Uniform periodic grid with four points, indexed by $i \\in \\{0,1,2,3\\}$.\n-   **Grid Spacing**: $\\Delta x = 1$.\n-   **Spatial Operator**: A semi-discrete central-difference conservative approximation given by $L(u)_{i} \\equiv -\\frac{f(u_{i+1}) - f(u_{i-1})}{2 \\Delta x}$. Periodicity implies $u_{i+4} = u_i$ and $u_{i-4} = u_i$.\n-   **Time-Stepping Method**: Third-order Total Variation Diminishing Runge–Kutta (TVD-RK3) method:\n    $$\n    u^{(1)} = u^{n} + \\Delta t\\, L(u^{n})\n    $$\n    $$\n    u^{(2)} = \\frac{3}{4} u^{n} + \\frac{1}{4}\\Big(u^{(1)} + \\Delta t\\, L(u^{(1)})\\Big)\n    $$\n    $$\n    u^{n+1} = \\frac{1}{3} u^{n} + \\frac{2}{3}\\Big(u^{(2)} + \\Delta t\\, L(u^{(2)})\\Big)\n    $$\n-   **Initial Data**: $u^{n} = (u^{n}_{0}, u^{n}_{1}, u^{n}_{2}, u^{n}_{3}) = (0, a, 0, 0)$, where $a > 0$.\n-   **Total Variation Definition**: $\\mathrm{TV}(u) \\equiv \\sum_{i=0}^{3} \\big|u_{i+1} - u_{i}\\big|$, with periodic indexing ($u_4 \\equiv u_0$).\n-   **Constraint**: $0 < \\Delta t < \\frac{4}{a}$.\n-   **Objective**: Find the exact expression for $\\mathrm{TV}(u^{n+1}) - \\mathrm{TV}(u^{n})$ as a function of $a$ and $\\Delta t$.\n\n### Step 2: Validate Using Extracted Givens\n1.  **Scientific or Factual Unsoundness**: The problem is scientifically sound. It describes a standard numerical experiment for a well-known PDE (Burgers' equation) using standard numerical methods (central differencing, TVD-RK3).\n2.  **Non-Formalizable or Irrelevant**: The problem is entirely formalizable and directly relevant to the topic of numerical methods for PDEs, specifically concerning total variation.\n3.  **Incomplete or Contradictory Setup**: The problem is fully specified. All required definitions, initial data, and methods are provided.\n4.  **Unrealistic or Infeasible**: The setup is a standard, feasible computational problem. The provided constraint on $\\Delta t$ is physically and mathematically reasonable.\n5.  **Ill-Posed or Poorly Structured**: The problem is well-posed. The sequence of calculations is deterministic and leads to a unique analytical result.\n6.  **Pseudo-Profound, Trivial, or Tautological**: The problem is a non-trivial, direct calculation that tests understanding of numerical schemes. Its purpose is to demonstrate a key property (or lack thereof) of a numerical method, which is a standard pedagogical approach.\n\n### Step 3: Verdict and Action\nThe problem is **valid**. A detailed solution will be provided.\n\n### Solution\n\nThe solution proceeds by first calculating the initial total variation, then executing the three stages of the TVD-RK3 method to find the solution at the next time level, $u^{n+1}$, and finally computing the new total variation and the increment.\n\n**1. Initial Total Variation, $\\mathrm{TV}(u^{n})$**\nThe initial data is the vector $u^{n} = (0, a, 0, 0)$. The total variation is defined as $\\mathrm{TV}(u) = \\sum_{i=0}^{3} |u_{i+1} - u_{i}|$, with periodic indexing $u_4 = u_0$.\n$$\n\\mathrm{TV}(u^n) = |u^n_1 - u^n_0| + |u^n_2 - u^n_1| + |u^n_3 - u^n_2| + |u^n_0 - u^n_3|\n$$\nSubstituting the values of $u^n$:\n$$\n\\mathrm{TV}(u^n) = |a - 0| + |0 - a| + |0 - 0| + |0 - 0| = |a| + |-a|\n$$\nSince $a > 0$, this simplifies to:\n$$\n\\mathrm{TV}(u^n) = a + a = 2a\n$$\n\n**2. TVD-RK3 Time Step**\nThe spatial operator with $f(u) = \\frac{u^2}{2}$ and $\\Delta x = 1$ is:\n$$\nL(u)_i = -\\frac{f(u_{i+1}) - f(u_{i-1})}{2 \\Delta x} = -\\frac{\\frac{1}{2}u_{i+1}^2 - \\frac{1}{2}u_{i-1}^2}{2} = -\\frac{u_{i+1}^2 - u_{i-1}^2}{4}\n$$\nIndices are evaluated modulo $4$.\n\n**Stage (i): Compute $L(u^n)$ and $u^{(1)}$**\nFirst, we compute the vector $L(u^n)$:\n$$\nL(u^n)_0 = -\\frac{(u^n_1)^2 - (u^n_3)^2}{4} = -\\frac{a^2 - 0^2}{4} = -\\frac{a^2}{4}\n$$\n$$\nL(u^n)_1 = -\\frac{(u^n_2)^2 - (u^n_0)^2}{4} = -\\frac{0^2 - 0^2}{4} = 0\n$$\n$$\nL(u^n)_2 = -\\frac{(u^n_3)^2 - (u^n_1)^2}{4} = -\\frac{0^2 - a^2}{4} = \\frac{a^2}{4}\n$$\n$$\nL(u^n)_3 = -\\frac{(u^n_0)^2 - (u^n_2)^2}{4} = -\\frac{0^2 - 0^2}{4} = 0\n$$\nSo, $L(u^n) = (-\\frac{a^2}{4}, 0, \\frac{a^2}{4}, 0)$.\nNow, compute $u^{(1)}$:\n$$\nu^{(1)} = u^n + \\Delta t L(u^n) = (0, a, 0, 0) + \\Delta t (-\\frac{a^2}{4}, 0, \\frac{a^2}{4}, 0) = (-\\frac{a^2 \\Delta t}{4}, a, \\frac{a^2 \\Delta t}{4}, 0)\n$$\n\n**Stage (ii): Compute $L(u^{(1)})$ and $u^{(2)}$**\nNext, we compute $L(u^{(1)})$ using $u^{(1)} = (-\\frac{a^2 \\Delta t}{4}, a, \\frac{a^2 \\Delta t}{4}, 0)$:\n$$\nL(u^{(1)})_0 = -\\frac{(u^{(1)}_1)^2 - (u^{(1)}_3)^2}{4} = -\\frac{a^2 - 0^2}{4} = -\\frac{a^2}{4}\n$$\n$$\nL(u^{(1)})_1 = -\\frac{(u^{(1)}_2)^2 - (u^{(1)}_0)^2}{4} = -\\frac{(\\frac{a^2 \\Delta t}{4})^2 - (-\\frac{a^2 \\Delta t}{4})^2}{4} = 0\n$$\n$$\nL(u^{(1)})_2 = -\\frac{(u^{(1)}_3)^2 - (u^{(1)}_1)^2}{4} = -\\frac{0^2 - a^2}{4} = \\frac{a^2}{4}\n$$\n$$\nL(u^{(1)})_3 = -\\frac{(u^{(1)}_0)^2 - (u^{(1)}_2)^2}{4} = -\\frac{(-\\frac{a^2 \\Delta t}{4})^2 - (\\frac{a^2 \\Delta t}{4})^2}{4} = 0\n$$\nA crucial observation is that $L(u^{(1)}) = L(u^n)$ due to the symmetry of the generated values in $u^{(1)}$.\nNow, compute $u^{(2)}$:\n$$\nu^{(2)} = \\frac{3}{4} u^n + \\frac{1}{4}(u^{(1)} + \\Delta t L(u^{(1)})) = \\frac{3}{4} u^n + \\frac{1}{4}( (u^n + \\Delta t L(u^n)) + \\Delta t L(u^n) )\n$$\n$$\nu^{(2)} = \\frac{3}{4} u^n + \\frac{1}{4} u^n + \\frac{1}{4}(2 \\Delta t L(u^n)) = u^n + \\frac{1}{2} \\Delta t L(u^n)\n$$\nSubstituting the vectors:\n$$\nu^{(2)} = (0, a, 0, 0) + \\frac{\\Delta t}{2} (-\\frac{a^2}{4}, 0, \\frac{a^2}{4}, 0) = (-\\frac{a^2 \\Delta t}{8}, a, \\frac{a^2 \\Delta t}{8}, 0)\n$$\n\n**Stage (iii): Compute $L(u^{(2)})$ and $u^{n+1}$**\nThe vector $u^{(2)}$ has the same symmetric structure as $u^{(1)}$, of the form $(-c, a, c, 0)$. As shown with $L(u^{(1)})$, this symmetry implies $L(u^{(2)}) = L(u^n)$.\nNow, compute the final state $u^{n+1}$:\n$$\nu^{n+1} = \\frac{1}{3} u^n + \\frac{2}{3}(u^{(2)} + \\Delta t L(u^{(2)})) = \\frac{1}{3} u^n + \\frac{2}{3}( (u^n + \\frac{1}{2}\\Delta t L(u^n)) + \\Delta t L(u^n) )\n$$\n$$\nu^{n+1} = \\frac{1}{3} u^n + \\frac{2}{3}(u^n + \\frac{3}{2}\\Delta t L(u^n)) = \\frac{1}{3} u^n + \\frac{2}{3} u^n + \\Delta t L(u^n) = u^n + \\Delta t L(u^n)\n$$\nThis shows that for this specific problem, $u^{n+1} = u^{(1)}$.\n$$\nu^{n+1} = (-\\frac{a^2 \\Delta t}{4}, a, \\frac{a^2 \\Delta t}{4}, 0)\n$$\n\n**3. Final Total Variation, $\\mathrm{TV}(u^{n+1})$**\nWe compute the total variation of $u^{n+1} = (u^{n+1}_0, u^{n+1}_1, u^{n+1}_2, u^{n+1}_3)$:\n$$\n\\mathrm{TV}(u^{n+1}) = |u^{n+1}_1 - u^{n+1}_0| + |u^{n+1}_2 - u^{n+1}_1| + |u^{n+1}_3 - u^{n+1}_2| + |u^{n+1}_0 - u^{n+1}_3|\n$$\nLet's evaluate each term:\n-   $|u^{n+1}_1 - u^{n+1}_0| = |a - (-\\frac{a^2 \\Delta t}{4})| = |a + \\frac{a^2 \\Delta t}{4}|$. Since $a>0, \\Delta t>0$, this term is $a + \\frac{a^2 \\Delta t}{4}$.\n-   $|u^{n+1}_2 - u^{n+1}_1| = |\\frac{a^2 \\Delta t}{4} - a|$. The problem provides the constraint $0 < \\Delta t < \\frac{4}{a}$, which implies $a \\Delta t < 4$, or $\\frac{a \\Delta t}{4} < 1$. Since $a>0$, we can multiply by $a$ to get $\\frac{a^2 \\Delta t}{4} < a$. Thus, the argument of the absolute value is negative. Therefore, $|\\frac{a^2 \\Delta t}{4} - a| = -( \\frac{a^2 \\Delta t}{4} - a ) = a - \\frac{a^2 \\Delta t}{4}$.\n-   $|u^{n+1}_3 - u^{n+1}_2| = |0 - \\frac{a^2 \\Delta t}{4}| = |-\\frac{a^2 \\Delta t}{4}| = \\frac{a^2 \\Delta t}{4}$.\n-   $|u^{n+1}_0 - u^{n+1}_3| = |-\\frac{a^2 \\Delta t}{4} - 0| = |-\\frac{a^2 \\Delta t}{4}| = \\frac{a^2 \\Delta t}{4}$.\n\nSumming the terms to get $\\mathrm{TV}(u^{n+1})$:\n$$\n\\mathrm{TV}(u^{n+1}) = \\left(a + \\frac{a^2 \\Delta t}{4}\\right) + \\left(a - \\frac{a^2 \\Delta t}{4}\\right) + \\frac{a^2 \\Delta t}{4} + \\frac{a^2 \\Delta t}{4}\n$$\n$$\n\\mathrm{TV}(u^{n+1}) = 2a + \\frac{2 a^2 \\Delta t}{4} = 2a + \\frac{a^2 \\Delta t}{2}\n$$\n\n**4. Total Variation Increment**\nThe total variation increment is the difference between the final and initial total variation:\n$$\n\\mathrm{TV}(u^{n+1}) - \\mathrm{TV}(u^n) = \\left(2a + \\frac{a^2 \\Delta t}{2}\\right) - 2a = \\frac{a^2 \\Delta t}{2}\n$$\nThis positive increment confirms that the central difference scheme is not Total Variation Diminishing (TVD), as it generates new oscillations and increases the total variation.", "answer": "$$\\boxed{\\frac{a^{2} \\Delta t}{2}}$$", "id": "3422974"}, {"introduction": "The previous exercise demonstrates that a \"TVD\" time integrator does not automatically make a scheme TVD. This naturally leads to the question of what these integrators, more accurately known as Strong-Stability-Preserving (SSP) methods, actually do. This computational practice allows you to look inside the \"black box\" of an SSP-RK3 method, revealing that while individual substages may increase total variation, the full time step's convex combination structure can successfully control oscillations [@problem_id:3422960]. This exploration demystifies the behavior of SSP integrators, reconciling their properties with their observed performance in preventing spurious oscillations.", "problem": "Consider the scalar linear advection partial differential equation (PDE) $u_t + a\\,u_x = 0$ on the periodic spatial domain $[0,1]$, where $a \\in \\mathbb{R}$ is the constant advection speed. Let the initial condition be a piecewise constant jump perturbed by a high-frequency sinusoid,\n$$\nu(x,0) = \\chi_{[0,1/2)}(x) + \\epsilon \\sin(2\\pi m x),\n$$\nwhere $\\chi_{[0,1/2)}$ denotes the indicator function of $[0,1/2)$, $\\epsilon \\in \\mathbb{R}$ is a small amplitude, and $m \\in \\mathbb{N}$ is the mode number.\n\nWe discretize space on a uniform grid with $N$ points, grid spacing $\\Delta x = 1/N$, and periodic boundary conditions. Use the second-order centered-difference spatial operator, which is not Total Variation Diminishing (TVD),\n$$\n\\left(D_{\\text{cen}} u\\right)_i = \\frac{u_{i+1} - u_{i-1}}{2\\,\\Delta x},\n$$\nand define the semi-discrete operator\n$$\nL(u) = -a\\,D_{\\text{cen}} u.\n$$\nAdvance one time step using the canonical Strong-Stability-Preserving (SSP) third-order Runge–Kutta time integrator (often called TVD-RK3 in the literature), with time step $\\Delta t$ determined by the Courant–Friedrichs–Lewy (CFL) number $c = a\\,\\Delta t/\\Delta x$. For this single full step, compute the Total Variation (TV) of the numerical solution at the initial state and at each of the three Runge–Kutta internal stages. Here the discrete total variation is defined as\n$$\n\\operatorname{TV}(u) = \\sum_{i=0}^{N-1} \\left|u_{i+1} - u_i\\right|,\n$$\nwith periodic indexing $u_N \\equiv u_0$.\n\nYour task is to implement a program that, for specified parameters, performs the following:\n- Constructs the initial data on the uniform grid.\n- Applies one full step of the SSP third-order Runge–Kutta method to the semi-discrete system $u_t = L(u)$ using the non-TVD centered-difference operator.\n- Computes the discrete total variation $\\operatorname{TV}$ at the initial state and at each Runge–Kutta substage.\n- Reports whether the first substage increases TV relative to the initial TV and whether the overall full step decreases TV relative to the initial TV.\n\nTo probe and reconcile the behavior with the Strong-Stability-Preserving convex combination theory, use the following test suite of parameter values:\n- Test case $1$ (general case intended to show first-stage TV increase and full-step TV decrease): $N=400$, $a=1$, $\\epsilon=0.05$, $m=100$, $c=0.8$.\n- Test case $2$ (small time step boundary behavior): $N=400$, $a=1$, $\\epsilon=0.05$, $m=100$, $c=0.2$.\n- Test case $3$ (large time step edge behavior): $N=400$, $a=1$, $\\epsilon=0.05$, $m=100$, $c=2.5$.\n\nNo physical units are required because all quantities are nondimensional. Angles used within trigonometric functions are in radians.\n\nFor each test case, your program must produce a list containing:\n- The four floating-point values $[\\operatorname{TV}(u^0), \\operatorname{TV}(u^{(1)}), \\operatorname{TV}(u^{(2)}), \\operatorname{TV}(u^{(3)})]$, where $u^0$ is the initial state and $u^{(k)}$ denotes the $k$-th Runge–Kutta stage, with $u^{(3)}$ being the full-step result.\n- Two booleans: the first indicating whether $\\operatorname{TV}(u^{(1)}) > \\operatorname{TV}(u^0)$, and the second indicating whether $\\operatorname{TV}(u^{(3)}) < \\operatorname{TV}(u^0)$.\n\nYour program should produce a single line of output containing the results as a comma-separated list of the three test-case results enclosed in square brackets, where each test-case result is represented by a list as specified above. For example, the output format must be\n$$\n[\\,[tv0_1,tv1_1,tv2_1,tv3_1,\\text{bool\\_inc\\_stage1\\_1},\\text{bool\\_overall\\_dec\\_1}],\\,[tv0_2,tv1_2,tv2_2,tv3_2,\\text{bool\\_inc\\_stage1\\_2},\\text{bool\\_overall\\_dec\\_2}],\\,[tv0_3,tv1_3,tv2_3,tv3_3,\\text{bool\\_inc\\_stage1\\_3},\\text{bool\\_overall\\_dec\\_3}]\\,].\n$$\nAll numbers and booleans should be printed directly without additional text.", "solution": "The user-provided problem is assessed as valid. It is scientifically grounded in the field of numerical analysis for partial differential equations, self-contained, and well-posed. All definitions, parameters, and objectives are stated clearly and unambiguously. The problem constitutes a standard and insightful numerical experiment to probe the behavior of Strong-Stability-Preserving (SSP) time integrators when coupled with spatial operators that are not Total Variation Diminishing (TVD).\n\nThe core task is to perform a numerical simulation of the scalar linear advection equation, $u_t + a\\,u_x = 0$, on a periodic domain $[0,1]$. The solution's evolution is analyzed in terms of its discrete Total Variation (TV).\n\nFirst, we establish the discrete problem setup. The spatial domain $[0,1]$ is discretized into a uniform grid of $N$ points, $x_i = i\\,\\Delta x$ for $i = 0, 1, \\dots, N-1$, where the grid spacing is $\\Delta x = 1/N$. We adhere to periodic boundary conditions, meaning quantities at index $i$ are cyclically related to those at $i \\pm N$. The initial condition, $u(x,0) = \\chi_{[0,1/2)}(x) + \\epsilon \\sin(2\\pi m x)$, is evaluated at these grid points to construct the initial discrete solution vector $u^0$. At each grid point $x_i$, the value is $(u^0)_i = u(x_i, 0)$. The indicator function, $\\chi_{[0,1/2)}(x_i)$, is $1$ if $x_i < 0.5$ and $0$ otherwise.\n\nThe semi-discretization of the PDE, rewritten as $u_t = -a\\,u_x$, is formulated as a system of ordinary differential equations (ODEs), $\\frac{du}{dt} = L(u)$. The spatial operator $L(u)$ is defined using the second-order centered-difference approximation for the spatial derivative $u_x$:\n$$\nL(u)_i = -a \\left( \\frac{u_{i+1} - u_{i-1}}{2\\,\\Delta x} \\right)\n$$\nThis operator is known to be dispersive and not TVD; that is, it can introduce new, non-physical oscillations (local extrema) into the solution. A simple forward Euler time step, $u^{n+1} = u^n + \\Delta t L(u^n)$, utilizing this operator is unconditionally unstable for the advection equation and is known to amplify oscillations, thereby increasing the total variation of the solution.\n\nTime integration is performed using one full step of the third-order Strong-Stability-Preserving Runge-Kutta (SSP-RK$3$) method. Given a solution $u^n$ at time $t_n$, the solution at $t_{n+1} = t_n + \\Delta t$ is computed via three stages:\n\\begin{align*}\nu^{(1)} &= u^n + \\Delta t L(u^n) \\\\\nu^{(2)} &= \\frac{3}{4} u^n + \\frac{1}{4} u^{(1)} + \\frac{1}{4} \\Delta t L(u^{(1)}) \\\\\nu^{n+1} = u^{(3)} &= \\frac{1}{3} u^n + \\frac{2}{3} u^{(2)} + \\frac{2}{3} \\Delta t L(u^{(2)})\n\\end{align*}\nThe time step $\\Delta t$ is determined by the Courant-Friedrichs-Lewy (CFL) number, $c = a\\,\\Delta t/\\Delta x$.\n\nThe principle behind SSP methods is that if the forward Euler step is TVD under a time step restriction $\\Delta t \\le \\Delta t_0$, the SSP method, which is a convex combination of such steps, will also be TVD under a related restriction $\\Delta t \\le C_{\\text{SSP}}\\Delta t_0$. For SSP-RK$3$, the SSP coefficient is $C_{\\text{SSP}}=1$. In this problem, however, the forward Euler step with the centered-difference operator $L$ is never TVD for any $\\Delta t > 0$. Therefore, the SSP property of the time integrator does not formally guarantee a TVD result for the full step. The purpose of this exercise is to investigate the practical outcome. The first stage, $u^{(1)}$, is a pure forward Euler step and is expected to increase the total variation. The subsequent stages, through their convex combination structure, might counteract this increase, possibly leading to a net TV decrease over the full step if the CFL number is within the scheme's stability region.\n\nThe discrete total variation of a grid function $u$ provides a measure of its oscillary content and is defined as:\n$$\n\\operatorname{TV}(u) = \\sum_{i=0}^{N-1} |u_{i+1} - u_i|\n$$\nwhere periodicity implies $u_N = u_0$. We compute this quantity for the initial state $u^0$ and for each of the three stage-results, $u^{(1)}$, $u^{(2)}$, and $u^{(3)}$.\n\nThe implementation addresses three test cases:\n- Case $1$ ($c=0.8$): This CFL number is within the linear stability limit ($c \\le \\sqrt{3}$) of the combined scheme. It is intended to demonstrate the characteristic behavior where the first stage increases TV, but the full step successfully reduces TV relative to the initial state.\n- Case $2$ ($c=0.2$): A small CFL number, also within the stable region. The behavior will be strongly influenced by the forward Euler step, though the smaller magnitude of the update may temper the TV growth.\n- Case $3$ ($c=2.5$): A large CFL number, well outside the stability region ($c > \\sqrt{3} \\approx 1.732$). We anticipate numerically unstable behavior, characterized by a rapid and significant growth in total variation at all stages.\n\nThe program defines functions to compute the spatial operator $L(u)$ and the total variation $\\operatorname{TV}(u)$, correctly handling periodic boundaries via `numpy.roll`. For each test case, it initializes the solution vector, computes the four required TV values by executing the SSP-RK$3$ stages, and evaluates the two boolean conditions: $\\operatorname{TV}(u^{(1)}) > \\operatorname{TV}(u^0)$ and $\\operatorname{TV}(u^{(3)}) < \\operatorname{TV}(u^0)$. The results are then collated and formatted into the specified single-line output string.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem of analyzing the Total Variation (TV) behavior of a numerical\n    scheme for the linear advection equation.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (N, a, epsilon, m, c)\n        (400, 1.0, 0.05, 100, 0.8),\n        (400, 1.0, 0.05, 100, 0.2),\n        (400, 1.0, 0.05, 100, 2.5),\n    ]\n\n    all_results = []\n    for case in test_cases:\n        N, a, epsilon, m, c = case\n\n        # 1. Setup grid, time step, and initial condition\n        dx = 1.0 / N\n        dt = c * dx / a\n        x = np.linspace(0.0, 1.0, N, endpoint=False)\n        \n        # Initial condition: u(x,0) = chi_[0,1/2) + epsilon*sin(2*pi*m*x)\n        u0 = np.where(x < 0.5, 1.0, 0.0)\n        u0 += epsilon * np.sin(2 * np.pi * m * x)\n\n        # 2. Define helper functions for the spatial operator and TV calculation\n        def compute_L(u, a_val, dx_val):\n            \"\"\"Computes L(u) = -a * D_cen(u) with periodic boundaries.\"\"\"\n            u_plus_1 = np.roll(u, -1)\n            u_minus_1 = np.roll(u, 1)\n            du_dx_cen = (u_plus_1 - u_minus_1) / (2.0 * dx_val)\n            return -a_val * du_dx_cen\n\n        def calculate_tv(u):\n            \"\"\"Computes the total variation of u with periodic boundaries.\"\"\"\n            u_plus_1 = np.roll(u, -1)\n            return np.sum(np.abs(u_plus_1 - u))\n\n        # 3. Compute initial TV\n        tv0 = calculate_tv(u0)\n\n        # 4. Apply one full step of SSP-RK3 and compute TV at each stage\n        # Stage 1\n        L_u0 = compute_L(u0, a, dx)\n        u1 = u0 + dt * L_u0\n        tv1 = calculate_tv(u1)\n\n        # Stage 2\n        L_u1 = compute_L(u1, a, dx)\n        u2 = 0.75 * u0 + 0.25 * u1 + 0.25 * dt * L_u1\n        tv2 = calculate_tv(u2)\n\n        # Stage 3 (Final full-step result)\n        L_u2 = compute_L(u2, a, dx)\n        u3 = (1.0/3.0) * u0 + (2.0/3.0) * u2 + (2.0/3.0) * dt * L_u2\n        tv3 = calculate_tv(u3)\n\n        # 5. Determine the boolean flags\n        bool_inc_stage1 = tv1 > tv0\n        bool_overall_dec = tv3 < tv0\n        \n        # 6. Collate results for the current test case\n        case_result = [tv0, tv1, tv2, tv3, bool_inc_stage1, bool_overall_dec]\n        all_results.append(case_result)\n\n    # 7. Format the final output string exactly as required.\n    # The output should be a list of lists, represented as a string.\n    # e.g., [[val1,val2,true],[val3,val4,false]]\n    outer_list_str_parts = []\n    for res in all_results:\n        inner_list_str_items = []\n        for item in res:\n            if isinstance(item, bool):\n                # Use lowercase 'true'/'false' for consistency with common standards like JSON\n                inner_list_str_items.append(str(item).lower())\n            else:\n                inner_list_str_items.append(f\"{item:.15f}\") # Use enough precision for floats\n        \n        inner_list_str = f\"[{','.join(inner_list_str_items)}]\"\n        outer_list_str_parts.append(inner_list_str)\n\n    final_output_str = f\"[{','.join(outer_list_str_parts)}]\"\n    \n    # Final print statement in the exact required format.\n    print(final_output_str)\n\nsolve()\n```", "id": "3422960"}]}