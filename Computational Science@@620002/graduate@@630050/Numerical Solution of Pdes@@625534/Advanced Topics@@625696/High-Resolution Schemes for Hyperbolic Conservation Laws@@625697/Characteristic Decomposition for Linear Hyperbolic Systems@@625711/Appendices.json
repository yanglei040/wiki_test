{"hands_on_practices": [{"introduction": "The first step in mastering hyperbolic systems is to understand how an initial discontinuity, known as a Riemann problem, resolves into a set of fundamental waves. This exercise provides direct practice in performing this decomposition for the linear shallow water equations, a classic physical model. By calculating the wave strengths and their propagation speeds, you will solidify your understanding of how characteristic variables form the natural basis for describing wave motion [@problem_id:3369623].", "problem": "Consider the linear hyperbolic system given by the constant-coefficient partial differential equation (PDE)\n$$\n\\partial_{t}\\boldsymbol{u}(x,t) + A\\,\\partial_{x}\\boldsymbol{u}(x,t) = \\boldsymbol{0}, \\quad A = \\begin{pmatrix} 0  1 \\\\ g H  0 \\end{pmatrix},\n$$\nwith gravitational acceleration $g0$ and background depth $H0$. Let the Riemann initial data be\n$$\n\\boldsymbol{u}(x,0) = \\begin{cases}\n\\boldsymbol{u}_{L},  x0,\\\\\n\\boldsymbol{u}_{R},  x0,\n\\end{cases}\n$$\nwhere $\\boldsymbol{u}_{L},\\boldsymbol{u}_{R}\\in\\mathbb{R}^{2}$ are constant left and right states. Denote the jump by $\\Delta \\boldsymbol{u} = \\boldsymbol{u}_{R} - \\boldsymbol{u}_{L}$ and its components by $\\Delta u_{1}$ and $\\Delta u_{2}$. Using only the foundational definitions of strict hyperbolicity, eigen-decomposition of $A$, and characteristic projection for linear systems, derive the characteristic wave strengths associated with each family and the locations of all discontinuities at time $t0$. Define the wave strengths $\\alpha_{+}$ and $\\alpha_{-}$ by the decomposition of the jump into right eigenvectors of $A$, with $\\alpha_{+}$ corresponding to the right-going characteristic and $\\alpha_{-}$ to the left-going characteristic. Express your final answer as a single row matrix\n$$\n\\left(\\alpha_{+},\\,\\alpha_{-},\\,x_{-}(t),\\,x_{+}(t)\\right),\n$$\nwhere $x_{-}(t)$ and $x_{+}(t)$ are the locations of the left- and right-moving discontinuities at time $t0$, respectively. Provide an exact symbolic expression in terms of $g$, $H$, $t$, $\\Delta u_{1}$, and $\\Delta u_{2}$. No rounding is required and no units should be included in the final answer.", "solution": "The problem is valid. It is a well-posed, scientifically grounded problem in the field of partial differential equations, specifically concerning the characteristic decomposition of a linear hyperbolic system. All necessary data and definitions are provided, and there are no contradictions or ambiguities.\n\nThe given linear hyperbolic system is\n$$\n\\partial_{t}\\boldsymbol{u}(x,t) + A\\,\\partial_{x}\\boldsymbol{u}(x,t) = \\boldsymbol{0},\n$$\nwhere $\\boldsymbol{u}(x,t) \\in \\mathbb{R}^{2}$ and the constant coefficient matrix $A$ is\n$$\nA = \\begin{pmatrix} 0  1 \\\\ g H  0 \\end{pmatrix}.\n$$\nThe problem describes a Riemann problem with initial data consisting of two constant states, $\\boldsymbol{u}_{L}$ for $x0$ and $\\boldsymbol{u}_{R}$ for $x0$. The solution to such a problem for a linear hyperbolic system is constructed by decomposing the initial jump, $\\Delta \\boldsymbol{u} = \\boldsymbol{u}_{R} - \\boldsymbol{u}_{L}$, into the eigenvectors of the matrix $A$.\n\nFirst, we must perform the eigen-decomposition of $A$. The eigenvalues $\\lambda$ are the roots of the characteristic equation $\\det(A - \\lambda I) = 0$.\n$$\n\\det\\begin{pmatrix} 0-\\lambda  1 \\\\ gH  0-\\lambda \\end{pmatrix} = (-\\lambda)(-\\lambda) - (1)(gH) = \\lambda^{2} - gH = 0.\n$$\nSince $g0$ and $H0$, the eigenvalues are real and distinct:\n$$\n\\lambda_{\\pm} = \\pm\\sqrt{gH}.\n$$\nThe existence of two distinct real eigenvalues confirms that the system is strictly hyperbolic. These eigenvalues represent the characteristic speeds at which information propagates. The positive eigenvalue $\\lambda_{+} = \\sqrt{gH}$ corresponds to a right-going wave, and the negative eigenvalue $\\lambda_{-} = -\\sqrt{gH}$ corresponds to a left-going wave.\n\nNext, we find the corresponding right eigenvectors, $\\boldsymbol{r}_{\\pm}$, by solving $(A - \\lambda_{\\pm} I)\\boldsymbol{r}_{\\pm} = \\boldsymbol{0}$.\n\nFor the eigenvalue $\\lambda_{+} = \\sqrt{gH}$:\n$$\n(A - \\lambda_{+}I)\\boldsymbol{r}_{+} = \\begin{pmatrix} -\\sqrt{gH}  1 \\\\ gH  -\\sqrt{gH} \\end{pmatrix} \\begin{pmatrix} r_{1,+} \\\\ r_{2,+} \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}.\n$$\nThis gives the equation $-\\sqrt{gH}r_{1,+} + r_{2,+} = 0$, which implies $r_{2,+} = \\sqrt{gH}r_{1,+}$. We can choose $r_{1,+} = 1$, yielding the eigenvector\n$$\n\\boldsymbol{r}_{+} = \\begin{pmatrix} 1 \\\\ \\sqrt{gH} \\end{pmatrix}.\n$$\nThis eigenvector corresponds to the right-going characteristic family.\n\nFor the eigenvalue $\\lambda_{-} = -\\sqrt{gH}$:\n$$\n(A - \\lambda_{-}I)\\boldsymbol{r}_{-} = \\begin{pmatrix} \\sqrt{gH}  1 \\\\ gH  \\sqrt{gH} \\end{pmatrix} \\begin{pmatrix} r_{1,-} \\\\ r_{2,-} \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}.\n$$\nThis gives the equation $\\sqrt{gH}r_{1,-} + r_{2,-} = 0$, which implies $r_{2,-} = -\\sqrt{gH}r_{1,-}$. We can choose $r_{1,-} = 1$, yielding the eigenvector\n$$\n\\boldsymbol{r}_{-} = \\begin{pmatrix} 1 \\\\ -\\sqrt{gH} \\end{pmatrix}.\n$$\nThis eigenvector corresponds to the left-going characteristic family.\n\nThe solution to the Riemann problem is given by a superposition of waves associated with each characteristic family. The jump in the initial data, $\\Delta \\boldsymbol{u} = \\boldsymbol{u}_{R} - \\boldsymbol{u}_{L}$, is decomposed into a linear combination of the right eigenvectors. The coefficients of this decomposition are the characteristic wave strengths, denoted by $\\alpha_{+}$ and $\\alpha_{-}$.\n$$\n\\Delta \\boldsymbol{u} = \\alpha_{+} \\boldsymbol{r}_{+} + \\alpha_{-} \\boldsymbol{r}_{-}.\n$$\nSubstituting the expressions for $\\Delta \\boldsymbol{u} = \\begin{pmatrix} \\Delta u_{1} \\\\ \\Delta u_{2} \\end{pmatrix}$ and the eigenvectors, we obtain a linear system for the wave strengths:\n$$\n\\begin{pmatrix} \\Delta u_{1} \\\\ \\Delta u_{2} \\end{pmatrix} = \\alpha_{+} \\begin{pmatrix} 1 \\\\ \\sqrt{gH} \\end{pmatrix} + \\alpha_{-} \\begin{pmatrix} 1 \\\\ -\\sqrt{gH} \\end{pmatrix} = \\begin{pmatrix} 1  1 \\\\ \\sqrt{gH}  -\\sqrt{gH} \\end{pmatrix} \\begin{pmatrix} \\alpha_{+} \\\\ \\alpha_{-} \\end{pmatrix}.\n$$\nWe solve this system for $\\alpha_{+}$ and $\\alpha_{-}$. From the first row, we have $\\alpha_{+} + \\alpha_{-} = \\Delta u_{1}$. From the second row, we have $\\sqrt{gH}(\\alpha_{+} - \\alpha_{-}) = \\Delta u_{2}$, which gives $\\alpha_{+} - \\alpha_{-} = \\frac{\\Delta u_{2}}{\\sqrt{gH}}$.\n\nAdding these two equations:\n$$\n(\\alpha_{+} + \\alpha_{-}) + (\\alpha_{+} - \\alpha_{-}) = \\Delta u_{1} + \\frac{\\Delta u_{2}}{\\sqrt{gH}} \\implies 2\\alpha_{+} = \\Delta u_{1} + \\frac{\\Delta u_{2}}{\\sqrt{gH}}.\n$$\n$$\n\\alpha_{+} = \\frac{1}{2}\\Delta u_{1} + \\frac{\\Delta u_{2}}{2\\sqrt{gH}}.\n$$\nSubtracting the second new equation from the first:\n$$\n(\\alpha_{+} + \\alpha_{-}) - (\\alpha_{+} - \\alpha_{-}) = \\Delta u_{1} - \\frac{\\Delta u_{2}}{\\sqrt{gH}} \\implies 2\\alpha_{-} = \\Delta u_{1} - \\frac{\\Delta u_{2}}{\\sqrt{gH}}.\n$$\n$$\n\\alpha_{-} = \\frac{1}{2}\\Delta u_{1} - \\frac{\\Delta u_{2}}{2\\sqrt{gH}}.\n$$\nThese are the strengths of the right-going and left-going waves, respectively.\n\nThe locations of the discontinuities, $x_{-}(t)$ and $x_{+}(t)$, are determined by the characteristic speeds. For a linear constant-coefficient system, the discontinuities are contact discontinuities that emanate from the origin $x=0$ and travel at constant speeds equal to the eigenvalues.\nThe location of the right-moving discontinuity at time $t0$ is given by its speed $\\lambda_{+}$ multiplied by time $t$:\n$$\nx_{+}(t) = \\lambda_{+} t = \\sqrt{gH}t.\n$$\nThe location of the left-moving discontinuity at time $t0$ is given by its speed $\\lambda_{-}$ multiplied by time $t$:\n$$\nx_{-}(t) = \\lambda_{-} t = -\\sqrt{gH}t.\n$$\nThe solution $\\boldsymbol{u}(x,t)$ is then piecewise constant, with $\\boldsymbol{u}(x,t) = \\boldsymbol{u}_{L}$ for $x  x_{-}(t)$, $\\boldsymbol{u}(x,t) = \\boldsymbol{u}_{R}$ for $x  x_{+}(t)$, and a constant intermediate state for $x_{-}(t)  x  x_{+}(t)$.\n\nWe now assemble the required quantities into a single row matrix $(\\alpha_{+}, \\alpha_{-}, x_{-}(t), x_{+}(t))$:\n$$\n\\left( \\frac{1}{2}\\Delta u_{1} + \\frac{\\Delta u_{2}}{2\\sqrt{gH}}, \\quad \\frac{1}{2}\\Delta u_{1} - \\frac{\\Delta u_{2}}{2\\sqrt{gH}}, \\quad -\\sqrt{gH}t, \\quad \\sqrt{gH}t \\right).\n$$\nThis expression provides the full characteristic decomposition and the dynamics of the resulting discontinuities as requested.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{1}{2}\\Delta u_{1} + \\frac{\\Delta u_{2}}{2\\sqrt{gH}}  \\frac{1}{2}\\Delta u_{1} - \\frac{\\Delta u_{2}}{2\\sqrt{gH}}  -\\sqrt{gH}t  \\sqrt{gH}t\n\\end{pmatrix}\n}\n$$", "id": "3369623"}, {"introduction": "While many systems are strictly hyperbolic and can be neatly diagonalized, some important physical and mathematical models are not. This exercise explores the structure of a 'weakly' hyperbolic system, where the coefficient matrix is not diagonalizable. You will see how this 'defective' structure leads to a coupling between modes and results in a solution behavior fundamentally different from simple advection, providing insight into more complex wave phenomena [@problem_id:3369619].", "problem": "Consider the linear constant-coefficient hyperbolic system of Partial Differential Equations (PDEs)\n$$\nu_{t} + A\\,u_{x} = 0, \\quad x \\in \\mathbb{R}, \\quad t \\geq 0,\n$$\nwhere $u(x,t) \\in \\mathbb{R}^{2}$ and\n$$\nA = \\begin{pmatrix} \\lambda  1 \\\\ 0  \\lambda \\end{pmatrix}, \\quad \\lambda \\in \\mathbb{R}.\n$$\nAssume smooth, rapidly decaying initial data\n$$\nu(x,0) = u_{0}(x) = \\begin{pmatrix} \\phi(x) \\\\ \\psi(x) \\end{pmatrix}, \\quad \\phi, \\psi \\in \\mathcal{S}(\\mathbb{R}),\n$$\nwhere $\\mathcal{S}(\\mathbb{R})$ is the Schwartz class on $\\mathbb{R}$. Starting from first principles that govern transport-type PDEs with constant coefficients and the definition of characteristic curves for hyperbolic systems, perform the following:\n\n1. Compute an eigenvector and a generalized eigenvector associated with the (algebraically) repeated eigenvalue $\\,\\lambda\\,$ of the matrix $\\,A\\,$. Explain how this Jordan chain reflects the structure of $\\,A\\,$.\n\n2. Using a fundamental approach (either the method of characteristics formulated directly on the system components or the spatial Fourier transform and matrix exponentiation for constant-coefficient systems), derive a closed-form solution operator for $\\,u(x,t)\\,$ in terms of $\\,u_{0}\\,$. Your derivation must make clear the source of coupling between the two modes and show explicitly how a term proportional to $\\,t\\,\\partial_{x}\\,$ arises from the nondiagonalizable Jordan block.\n\n3. Provide the final solution $\\,u(x,t)\\,$ as a single explicit analytic expression that depends only on $\\,\\phi\\,$, $\\,\\psi\\,$, their spatial derivatives evaluated at the characteristic coordinate, and the parameters $\\,\\lambda\\,$ and $\\,t\\,$. Express the final answer as a $2$-entry row matrix using the LaTeX $\\,\\mathrm{pmatrix}\\,$ environment. No rounding is required, and no physical units are involved.", "solution": "The problem presented is a valid, well-posed initial value problem for a linear constant-coefficient system of partial differential equations. The system is weakly hyperbolic, as the coefficient matrix is not diagonalizable, featuring a Jordan block structure. This is a standard and important case study in the theory of hyperbolic PDEs. We shall proceed with the solution by addressing the three required parts.\n\nLet the given system be\n$$\nu_{t} + A\\,u_{x} = 0,\n$$\nwhere $u(x,t) = \\begin{pmatrix} u_1(x,t) \\\\ u_2(x,t) \\end{pmatrix}$, and $A = \\begin{pmatrix} \\lambda  1 \\\\ 0  \\lambda \\end{pmatrix}$.\n\n**1. Eigenstructure of the Matrix $A$**\n\nTo understand the structure of the system, we first analyze the eigenstructure of the matrix $A$. The eigenvalues $\\tilde{\\lambda}$ are the roots of the characteristic equation $\\det(A - \\tilde{\\lambda}I) = 0$.\n$$\n\\det \\begin{pmatrix} \\lambda - \\tilde{\\lambda}  1 \\\\ 0  \\lambda - \\tilde{\\lambda} \\end{pmatrix} = (\\lambda - \\tilde{\\lambda})^{2} = 0.\n$$\nThis gives a single eigenvalue $\\tilde{\\lambda} = \\lambda$ with algebraic multiplicity $2$.\n\nNext, we find the corresponding eigenvectors $v$ by solving $(A - \\lambda I)v = 0$:\n$$\n\\begin{pmatrix} \\lambda - \\lambda  1 \\\\ 0  \\lambda - \\lambda \\end{pmatrix} \\begin{pmatrix} v_1 \\\\ v_2 \\end{pmatrix} = \\begin{pmatrix} 0  1 \\\\ 0  0 \\end{pmatrix} \\begin{pmatrix} v_1 \\\\ v_2 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}.\n$$\nThis matrix equation simplifies to $v_2 = 0$. The component $v_1$ is arbitrary. The eigenspace is one-dimensional, spanned by the vector $r_1 = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$. The geometric multiplicity of the eigenvalue $\\lambda$ is $1$, which is less than its algebraic multiplicity of $2$. This confirms that the matrix $A$ is not diagonalizable.\n\nBecause $A$ is not diagonalizable, a basis of eigenvectors for $\\mathbb{R}^{2}$ does not exist. Instead, we seek a basis consisting of a Jordan chain. This involves finding a generalized eigenvector $r_2$ that satisfies $(A - \\lambda I)r_2 = r_1$.\n$$\n\\begin{pmatrix} 0  1 \\\\ 0  0 \\end{pmatrix} \\begin{pmatrix} v_1 \\\\ v_2 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}.\n$$\nThis equation gives $v_2 = 1$, with $v_1$ being arbitrary. A simple choice is $v_1 = 0$, which yields the generalized eigenvector $r_2 = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}$.\n\nThe set $\\{r_1, r_2\\}$ forms a Jordan basis for $\\mathbb{R}^{2}$. In fact, this basis is the standard basis for $\\mathbb{R}^{2}$. The matrix $A$ is itself a Jordan block. The structure of this chain is defined by the relations:\n$$\nA r_1 = \\lambda r_1\n$$\n$$\nA r_2 = r_1 + \\lambda r_2\n$$\nThe first equation shows that $r_1$ corresponds to a wave mode that simply advects with speed $\\lambda$. The second equation shows that the mode corresponding to $r_2$ also advects with speed $\\lambda$, but it is simultaneously coupled to the first mode, with $r_1$ acting as a source. This coupling is the fundamental consequence of the non-diagonalizable Jordan structure.\n\n**2. Derivation of the Solution Operator**\n\nWe will derive the solution using the method of characteristics applied directly to the component equations of the system. The system can be written as:\n$$\n\\begin{cases}\n\\frac{\\partial u_1}{\\partial t} + \\lambda \\frac{\\partial u_1}{\\partial x} + \\frac{\\partial u_2}{\\partial x} = 0  (1) \\\\\n\\frac{\\partial u_2}{\\partial t} + \\lambda \\frac{\\partial u_2}{\\partial x} = 0  (2)\n\\end{cases}\n$$\nEquation $(2)$ is a simple advection equation for $u_2$. It states that $u_2$ is constant along the characteristic curves defined by $\\frac{dx}{dt} = \\lambda$. These are straight lines $x - \\lambda t = \\text{constant}$. The solution to $(2)$ with initial condition $u_2(x,0) = \\psi(x)$ is therefore\n$$\nu_2(x,t) = \\psi(x - \\lambda t).\n$$\nThis component is a simple traveling wave moving with speed $\\lambda$ without changing its shape.\n\nNow, we address equation $(1)$. The term $\\frac{\\partial u_2}{\\partial x}$ acts as a source term. To solve this inhomogeneous advection equation, we perform a change of coordinates to a frame moving with the characteristic speed $\\lambda$. Let $y = x - \\lambda t$ (the characteristic coordinate) and $\\tau = t$. Let $v(y, \\tau) = u(x,t)$. By the chain rule:\n$$\n\\frac{\\partial}{\\partial t} = \\frac{\\partial y}{\\partial t}\\frac{\\partial}{\\partial y} + \\frac{\\partial \\tau}{\\partial t}\\frac{\\partial}{\\partial \\tau} = -\\lambda \\frac{\\partial}{\\partial y} + \\frac{\\partial}{\\partial \\tau}\n$$\n$$\n\\frac{\\partial}{\\partial x} = \\frac{\\partial y}{\\partial x}\\frac{\\partial}{\\partial y} + \\frac{\\partial \\tau}{\\partial x}\\frac{\\partial}{\\partial \\tau} = \\frac{\\partial}{\\partial y}\n$$\nSubstituting these into the system for the new functions $v_1(y, \\tau)$ and $v_2(y, \\tau)$:\n$$\n\\begin{cases}\n(-\\lambda \\frac{\\partial}{\\partial y} + \\frac{\\partial}{\\partial \\tau})v_1 + \\lambda \\frac{\\partial v_1}{\\partial y} + \\frac{\\partial v_2}{\\partial y} = 0 \\\\\n(-\\lambda \\frac{\\partial}{\\partial y} + \\frac{\\partial}{\\partial \\tau})v_2 + \\lambda \\frac{\\partial v_2}{\\partial y} = 0\n\\end{cases}\n$$\nThis simplifies to:\n$$\n\\begin{cases}\n\\frac{\\partial v_1}{\\partial \\tau} + \\frac{\\partial v_2}{\\partial y} = 0  (1') \\\\\n\\frac{\\partial v_2}{\\partial \\tau} = 0  (2')\n\\end{cases}\n$$\nFrom $(2')$, $v_2$ does not depend on $\\tau$. Thus, $v_2(y, \\tau) = v_2(y, 0)$. At $\\tau = 0$, we have $t=0$ and $y=x$, so $v_2(y, 0) = u_2(y, 0) = \\psi(y)$. Therefore, $v_2(y, \\tau) = \\psi(y)$. This re-derives the solution for the second component.\n\nNow, we substitute this result into $(1')$:\n$$\n\\frac{\\partial v_1}{\\partial \\tau} = - \\frac{\\partial v_2}{\\partial y} = - \\frac{d\\psi}{dy}(y) \\equiv -\\psi'(y).\n$$\nWe integrate this equation with respect to $\\tau$ from $0$ to $\\tau$:\n$$\n\\int_0^{\\tau} \\frac{\\partial v_1}{\\partial \\sigma}(y, \\sigma) d\\sigma = \\int_0^{\\tau} (-\\psi'(y)) d\\sigma\n$$\n$$\nv_1(y, \\tau) - v_1(y, 0) = -\\psi'(y) \\int_0^{\\tau} d\\sigma = -\\tau \\psi'(y).\n$$\nThe initial condition for $v_1$ is $v_1(y, 0) = u_1(y, 0) = \\phi(y)$. Thus,\n$$\nv_1(y, \\tau) = \\phi(y) - \\tau \\psi'(y).\n$$\nFinally, we transform back to the original coordinates $(x,t)$ by substituting $y = x - \\lambda t$ and $\\tau = t$:\n$$\nu_1(x,t) = \\phi(x - \\lambda t) - t \\psi'(x - \\lambda t).\n$$\nThe source of the coupling is the non-zero off-diagonal element in the matrix $A$, which corresponds to the term $\\frac{\\partial u_2}{\\partial x}$ in equation $(1)$. In the characteristic frame, this term becomes a source, $\\frac{\\partial v_2}{\\partial y}$, for the evolution of $v_1$. Integrating this source term over time (from $\\tau=0$ to $\\tau=t$) produces the factor of $t$. The spatial derivative comes from the fact that the coupling term involves $\\frac{\\partial u_2}{\\partial x}$. Therefore, the non-diagonalizable Jordan block structure results in a solution component that grows linearly in time (multiplied by a spatial derivative), representing a secular growth distinct from the simple transport of diagonalizable systems.\n\n**3. Final Solution Expression**\n\nCombining the derived expressions for the two components, the final solution for $u(x,t)$ is\n$$\nu(x,t) = \\begin{pmatrix} u_1(x,t) \\\\ u_2(x,t) \\end{pmatrix} = \\begin{pmatrix} \\phi(x - \\lambda t) - t \\psi'(x - \\lambda t) \\\\ \\psi(x - \\lambda t) \\end{pmatrix}.\n$$\nHere, $\\psi'(z)$ denotes the derivative of the function $\\psi$ with respect to its argument, evaluated at $z$. Expressing this result as a $2$-entry row matrix as requested:\n$$\n\\begin{pmatrix} \\phi(x - \\lambda t) - t \\psi'(x - \\lambda t)  \\psi(x - \\lambda t) \\end{pmatrix}.\n$$", "answer": "$$\n\\boxed{\\begin{pmatrix} \\phi(x - \\lambda t) - t \\psi'(x - \\lambda t)  \\psi(x - \\lambda t) \\end{pmatrix}}\n$$", "id": "3369619"}, {"introduction": "A deep theoretical understanding of characteristic waves is most powerful when it informs the development and validation of numerical solvers. This practice shifts the focus from solving equations analytically to designing a rigorous verification strategy for a computational code. You will act as a numerical analyst, devising a suite of tests that systematically probes a code's ability to handle characteristic projection, upwinding, and boundary conditions, ensuring its physical and mathematical correctness [@problem_id:3369597].", "problem": "Consider the constant-coefficient linear hyperbolic system in one space dimension\n$$\nq_t + A\\,q_x = 0,\\qquad x\\in(0,\\ell),\\ t0,\n$$\nwhere $q\\in\\mathbb{R}^m$, $A\\in\\mathbb{R}^{m\\times m}$ is diagonalizable with real eigenvalues, and $A=R\\,\\Lambda\\,L$ with $R=[r_1,\\dots,r_m]$ the right-eigenvector matrix, $L=R^{-1}$ the left-eigenvector matrix, and $\\Lambda=\\mathrm{diag}(\\lambda_1,\\dots,\\lambda_m)$. Suppose $m=3$ and the eigenvalues satisfy $\\lambda_10$, $\\lambda_2=0$, $\\lambda_30$, as in the linearization of the one-dimensional Euler equations about a uniform rest state. A finite volume method (FVM) is implemented that, at each face, projects cell values onto characteristic variables $w=L\\,q$, applies upwinding based on the sign of each $\\lambda_k$, and imposes nonreflecting boundary conditions by specifying incoming characteristic components and extrapolating outgoing ones.\n\nYou are tasked with verifying, by targeted numerical tests, that the implementation correctly performs (i) projection onto and reconstruction from the characteristic basis, (ii) upwind selection at interior faces, and (iii) characteristic-based boundary treatments at $x=0$ and $x=\\ell$. Which of the following test suites is sufficient and methodologically sound to isolate and excite single and multiple characteristic modes independently so that each of the three aspects can be verified against analytical expectations derived from linear superposition and constant wave speeds?\n\nA. For each $k\\in\\{1,2,3\\}$, define a smooth wave packet $\\phi_\\sigma(x)=\\exp\\!\\big(-((x-x_c)/\\sigma)^2\\big)$ with $x_c\\in(0,\\ell)$ and $\\sigma0$. Single-mode initial-value tests: set $q(x,0)=r_k\\,\\phi_\\sigma(x)$, and impose nonreflecting boundaries by setting, at $x=0$, the incoming components $w_j$ with $\\lambda_j0$ to $0$, and at $x=\\ell$, the incoming components $w_j$ with $\\lambda_j0$ to $0$; verify that $w=L\\,q$ has only the $k$-th component nonzero to round-off and that the packet propagates as $q(x,t)=r_k\\,\\phi_\\sigma(x-\\lambda_k t)$ with no reflection. Boundary-driven single-mode tests: with $q(x,0)=0$, drive only one incoming characteristic at a time using $w_k(0,t)=g(t)$ for $\\lambda_k0$ and $w_k(\\ell,t)=g(t)$ for $\\lambda_k0$, with $g(t)=\\sin(\\omega t)\\,\\chi(t)$ where $\\chi(t)$ is a smooth compactly supported window, and set all other incoming components to $0$; verify interior fields match $r_k\\,g(t-x/\\lambda_k)$ for $\\lambda_k\\neq 0$ and that reflection is below a prescribed tolerance obtained by comparing outgoing energy to incoming energy. Multi-mode superposition tests: choose separated centers $x_1,x_3$ and set $q(x,0)=r_1\\,\\phi_\\sigma(x-x_1)+r_3\\,\\phi_\\sigma(x-x_3)$; verify that each packet propagates with its own speed and that $w=L\\,q$ has only components $1$ and $3$ nonzero, with linear superposition preserved through packet crossing. Zero-speed persistence test: set $q(x,0)=r_2\\,\\phi_\\sigma(x)$; verify stationarity in time and no spurious advection. Repeat selected tests with reversed spatial orientation to confirm upwind switching by the sign of $\\lambda_k$.\n\nB. Use a single long-time simulation with $q(x,0)$ chosen as a spatially band-limited random field in primitive variables and periodic boundaries at $x=0$ and $x=\\ell$; compute temporal Fourier transforms of $q$ at probe points, infer phase speeds by regression, and examine the spectrum for three peaks; if three peaks are present and the estimated speeds are close to nominal $\\lambda_k$, conclude the implementation is correct.\n\nC. Initialize $q(x,0)$ as a discontinuous step in each primitive variable separately, set homogeneous Dirichlet boundary conditions $q(0,t)=0$ and $q(\\ell,t)=0$, and verify that total variation decays in time and that numerical solutions remain bounded; if so, conclude projection, upwinding, and boundary treatments are correct.\n\nD. Initialize $q(x,0)=e_i\\,\\phi_\\sigma(x)$ for each canonical basis vector $e_i$ of $\\mathbb{R}^3$ and use periodic boundaries; verify that three simulations produce three distinct apparent propagation speeds in the $L^2$ norm decay curves and that the sum of solutions for $i=1,2,3$ equals the solution for a combined initialization; if so, conclude projection and upwinding are correct and boundary treatments are unnecessary to test.\n\nSelect the option that provides a sufficient and scientifically sound test suite to independently excite and verify single and multiple characteristic modes, upwinding decisions, and characteristic-based boundary treatments for this FVM implementation.", "solution": "We begin from the governing linear system $q_t + A\\,q_x = 0$ with $A$ constant, real-diagonalizable. Writing the eigen-decomposition $A=R\\,\\Lambda\\,L$ with $L\\,R=I$, the characteristic variables are $w=L\\,q$. In these variables, the system decouples as $w_t + \\Lambda\\,w_x=0$, i.e., each component $w_k$ satisfies $w_{k,t} + \\lambda_k\\,w_{k,x} = 0$. The general solution is the linear superposition\n$$\nq(x,t) = \\sum_{k=1}^3 r_k\\,w_k(x,t),\\qquad w_k(x,t)=w_k(x-\\lambda_k t,0),\n$$\ntogether with boundary conditions specified on incoming characteristics: at $x=0$, $w_k(0,t)$ must be prescribed for $\\lambda_k0$ (incoming from the left), and at $x=\\ell$, $w_k(\\ell,t)$ must be prescribed for $\\lambda_k0$ (incoming from the right). Outgoing components are determined by the interior solution.\n\nFor a finite volume method that upwinds by splitting on the sign of $\\lambda_k$, correctness can be probed by isolating each $w_k$ and verifying that (i) projection $w=L\\,q$ produces only the intended nonzero component and reconstruction $q=R\\,w$ recovers the expected physical fields, (ii) the packet propagates with speed $\\lambda_k$ and in the correct direction, and (iii) at boundaries, specifying only incoming components produces no reflection in outgoing components.\n\nWe now analyze each option.\n\nOption A: This option constructs targeted tests grounded in the decoupling above.\n\nSingle-mode initial-value tests: Setting $q(x,0)=r_k\\,\\phi_\\sigma(x)$ yields $w(x,0)=L\\,q(x,0)=L\\,r_k\\,\\phi_\\sigma(x)=e_k\\,\\phi_\\sigma(x)$ because $L\\,r_k=e_k$, the $k$-th canonical basis vector. Hence $w_j(x,0)=0$ for $j\\neq k$, and only $w_k$ is nonzero. Since $w_{k,t}+\\lambda_k w_{k,x}=0$, the exact evolution is $w_k(x,t)=\\phi_\\sigma(x-\\lambda_k t)$, so\n$$\nq(x,t)=r_k\\,\\phi_\\sigma(x-\\lambda_k t).\n$$\nImposing nonreflecting boundaries by prescribing incoming $w_j$ to $0$ at each end is consistent with an interior wave exiting the domain with no reflection. Numerically, correct projection is verified if $w=L\\,q$ has only the $k$-th component nonzero up to round-off for all $t$; correct upwinding is verified if the packet moves in the direction dictated by the sign of $\\lambda_k$ at speed $\\lambda_k$; correct boundary treatment is verified by negligible reflected energy at the boundaries.\n\nBoundary-driven single-mode tests: With $q(x,0)=0$ and driving only one incoming characteristic at a time, e.g., $w_k(0,t)=g(t)$ for $\\lambda_k0$ (and analogously at $x=\\ell$ for $\\lambda_k0$), the exact solution inside the domain for $\\lambda_k\\neq 0$ is\n$$\nw_k(x,t)=g(t - x/\\lambda_k)\\ \\text{for}\\ t\\ge x/\\lambda_k,\\quad w_j\\equiv 0\\ \\text{for}\\ j\\neq k,\n$$\nso $q(x,t)=r_k\\,g(t - x/\\lambda_k)$. This directly isolates the boundary treatment: only the driven component should appear, and no spurious components ($j\\neq k$) should be generated by incorrect projection or boundary coupling. Reflection can be quantified by comparing the outgoing characteristic energy to the incoming one; in the exact nonreflecting case, reflected components vanish.\n\nMulti-mode superposition tests: With\n$$\nq(x,0)=r_1\\,\\phi_\\sigma(x-x_1)+r_3\\,\\phi_\\sigma(x-x_3),\n$$\nwe have $w(x,0)=e_1\\,\\phi_\\sigma(x-x_1)+e_3\\,\\phi_\\sigma(x-x_3)$. Each packet evolves independently as $r_1\\,\\phi_\\sigma(x-x_1-\\lambda_1 t)$ and $r_3\\,\\phi_\\sigma(x-x_3-\\lambda_3 t)$, possibly crossing in space-time. Linearity implies that no cross-mode energy should be created; thus $w_2$ should remain zero, and $w_1,w_3$ should be transported independently. This probes the projection and reconstruction across interacting waves and the upwind splitting across signs.\n\nZero-speed persistence test: For $\\lambda_2=0$, initializing $q(x,0)=r_2\\,\\phi_\\sigma(x)$ yields $w_2(x,t)=\\phi_\\sigma(x)$, i.e., stationarity in time. Any observed drift indicates an error in either projection (mode mixing) or in the flux splitting logic for the zero-speed mode.\n\nRepeating tests with reversed spatial orientation (e.g., placing a right-going packet near $x=\\ell$ and a left-going packet near $x=0$) further confirms that upwinding switches correctly with the sign of $\\lambda_k$. Altogether, Option A systematically isolates single modes from both initial data and boundary data and combines modes to verify superposition, directly testing the three targeted aspects. Therefore, Option A is sufficient and sound.\n\nOption B: A single randomized simulation with periodic boundaries does not isolate characteristic modes. Random initial conditions in primitive variables produce an unknown mixture of modes, so errors in projection could be masked by coincidental cancellations. Periodic boundaries eliminate the possibility to test characteristic-based boundary treatments, which require specification of incoming versus outgoing components at $x=0$ and $x=\\ell$. Moreover, inferring speeds from temporal spectra at probe points cannot detect subtle but critical issues like small spurious reflections or cross-mode contamination. Thus, Option B is not sufficient to verify projection, upwinding, and boundary treatments independently. Verdict — Incorrect.\n\nOption C: Homogeneous Dirichlet boundary conditions on primitive variables do not correspond to nonreflecting characteristic boundary conditions unless $R$ and $L$ happen to be identity, which they are not in general. Such Dirichlet conditions typically generate reflections by coupling incoming and outgoing characteristics at the boundary. Step initial data excite all modes simultaneously in a nonisolated manner, making it impossible to attribute observed behavior to a specific mode or to assess projection accuracy. Decay of total variation and boundedness are not discriminating for correctness of characteristic projection or upwind selection. Boundary treatments cannot be verified because the boundary specification is not characteristic-based. Verdict — Incorrect.\n\nOption D: Initializing with canonical basis vectors $e_i$ in primitive variables excites mixtures of characteristic modes because $e_i$ is, in general, a linear combination of the right eigenvectors $r_k$. Periodic boundaries again preclude testing boundary conditions. While one may observe linear superposition in aggregate, this does not isolate single characteristic components nor verify that upwind decisions are made per characteristic field. Equality of sums is a consequence of linearity of the equations and the numerical method, but it does not confirm correct projection onto $w=L\\,q$ or proper face-based upwinding per sign of $\\lambda_k$. Boundary treatments remain untested. Verdict — Incorrect.\n\nTherefore, only Option A provides a comprehensive and scientifically grounded suite of tests that independently excite and verify single and multiple characteristic modes, upwinding, and boundary treatments in the finite volume implementation.", "answer": "$$\\boxed{A}$$", "id": "3369597"}]}