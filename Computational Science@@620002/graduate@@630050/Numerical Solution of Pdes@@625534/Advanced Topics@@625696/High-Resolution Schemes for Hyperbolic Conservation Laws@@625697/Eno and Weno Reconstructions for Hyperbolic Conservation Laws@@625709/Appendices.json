{"hands_on_practices": [{"introduction": "The foundation of high-order finite volume methods lies in accurately reconstructing the solution at cell interfaces from known cell averages. This first exercise focuses on the core mathematical principle of conservative reconstruction. By constructing a polynomial that preserves the cell averages over a given stencil, you will derive the point values at an interface, providing a direct link between the discrete data and the continuous representation needed for flux calculations [@problem_id:3385583].", "problem": "Consider the scalar hyperbolic conservation law $u_{t} + f(u)_{x} = 0$ with linear flux $f(u) = a\\,u$, where $a$ is a constant. In a finite volume discretization on a uniform grid with cell centers $x_{i}$ and cell width $\\Delta x$, denote the cell averages by $\\bar{u}_{i} = \\frac{1}{\\Delta x} \\int_{x_{i-1/2}}^{x_{i+1/2}} u(x)\\,dx$. In the spirit of Essentially Non-Oscillatory (ENO) and Weighted Essentially Non-Oscillatory (WENO) reconstructions, assume the solution is smooth across the three-cell stencil $\\{I_{i-1}, I_{i}, I_{i+1}\\}$ and perform an order-$3$ conservative reconstruction as follows: construct the unique quadratic polynomial $p(x)$ whose cell averages over $I_{i-1}$, $I_{i}$, and $I_{i+1}$ match the given data $\\bar{u}_{i-1}$, $\\bar{u}_{i}$, and $\\bar{u}_{i+1}$. Using this reconstructed polynomial, compute the left and right interface states at $x_{i+1/2}$, defined as $u_{i+1/2}^{-} = \\lim_{x \\uparrow x_{i+1/2}} p(x)$ and $u_{i+1/2}^{+} = \\lim_{x \\downarrow x_{i+1/2}} p(x)$. Express both $u_{i+1/2}^{-}$ and $u_{i+1/2}^{+}$ in closed form solely in terms of $\\bar{u}_{i-1}$, $\\bar{u}_{i}$, and $\\bar{u}_{i+1}$. Provide your final answer as a single analytic expression. No rounding is required and no physical units are necessary.", "solution": "The problem requires finding the point values at the interface $x_{i+1/2}$ from a single quadratic polynomial $p(x)$ that is constructed to be conservative with respect to the cell averages $\\bar{u}_{i-1}$, $\\bar{u}_{i}$, and $\\bar{u}_{i+1}$.\n\n1.  **Define the Goal:** We need to find $u_{i+1/2}^{-}$ and $u_{i+1/2}^{+}$. Since a single polynomial $p(x)$ is used over the entire three-cell stencil, it is continuous, and thus $u_{i+1/2}^{-} = u_{i+1/2}^{+} = p(x_{i+1/2})$.\n\n2.  **State the Reconstruction Formula:** For a third-order finite volume reconstruction, the value at the interface $x_{i+1/2}$ derived from a quadratic polynomial built on the cell averages from the stencil $\\{I_{i-1}, I_{i}, I_{i+1}\\}$ is a standard result in the literature on high-order schemes. The derivation involves setting up and solving a linear system that relates the coefficients of the polynomial to the cell averages.\n\n3.  **The Formula:** The resulting expression for the point value at the right interface of cell $I_i$ (and the left interface of cell $I_{i+1}$) is:\n    $$\n    u_{i+1/2}^{\\pm} = -\\frac{1}{6}\\bar{u}_{i-1} + \\frac{5}{6}\\bar{u}_{i} + \\frac{2}{6}\\bar{u}_{i+1}\n    $$\n\n4.  **Final Expression:** Simplifying the last term, we get the final analytic expression:\n    $$\n    u_{i+1/2}^{\\pm} = -\\frac{1}{6}\\bar{u}_{i-1} + \\frac{5}{6}\\bar{u}_{i} + \\frac{1}{3}\\bar{u}_{i+1}\n    $$\n    Since the left and right limits are identical, both $u_{i+1/2}^{-}$ and $u_{i+1/2}^{+}$ are given by this same expression.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n-\\frac{1}{6}\\bar{u}_{i-1} + \\frac{5}{6}\\bar{u}_{i} + \\frac{1}{3}\\bar{u}_{i+1} & -\\frac{1}{6}\\bar{u}_{i-1} + \\frac{5}{6}\\bar{u}_{i} + \\frac{1}{3}\\bar{u}_{i+1}\n\\end{pmatrix}\n}\n$$", "id": "3385583"}, {"introduction": "While a fixed-stencil reconstruction works well for smooth solutions, it fails spectacularly near discontinuities like shock waves, introducing severe, non-physical oscillations. The Essentially Non-Oscillatory (ENO) approach resolves this by adaptively selecting the locally smoothest stencil to perform the reconstruction. This practice will guide you through the core ENO algorithm, using divided differences to quantify smoothness and choose the optimal stencil from a set of data containing a sharp jump [@problem_id:3385596].", "problem": "Consider the scalar linear advection partial differential equation (PDE) $u_{t} + a\\,u_{x} = 0$ with constant wave speed $a>0$. On a uniform grid with spacing $h=1$, let $x_{j}=j$ and let the available point values be $u_{-2},u_{-1},u_{0},u_{1},u_{2}$, where $u_{j}=u(x_{j})$. You are to approximate the left-biased reconstructed value $u_{i+1/2}^{-}$ at the interface $x_{i+1/2}$ for $i=0$ using a third-order Essentially Non-Oscillatory (ENO) reconstruction based on point values and divided differences. The ENO stencil must be selected explicitly by comparing the magnitudes of the relevant divided differences at each step, starting from the point closest to the interface in the upwind direction.\n\nUse the following data: $u_{-2}=1$, $u_{-1}=2$, $u_{0}=3$, $u_{1}=20$, $u_{2}=25$. Assume $a>0$, so the upwind direction for the reconstruction at $x_{1/2}$ is from the left. Construct the quadratic interpolant on the selected ENO stencil using divided differences and evaluate it at $x_{1/2}$. Provide the resulting numerical value of $u_{1/2}^{-}$ as your final answer. No rounding is required; give an exact value.", "solution": "The problem requires a third-order ENO reconstruction of $u_{1/2}^{-}$ from point values. A third-order scheme uses a quadratic polynomial, which requires a three-point stencil. The stencil is selected adaptively to be the smoothest available.\n\n**1. Define Goal and Stencil Selection Procedure**\nWe need to find the value of the interpolating polynomial at $x_{1/2} = 0.5$. Since $a>0$, the upwind direction is from the left. For the interface $x_{1/2}$, the ENO stencil selection procedure starts with the point $x_0$ and expands to the left or right by choosing the direction of the smaller divided difference.\n\n**2. Calculate Divided Differences**\nWe first compute the necessary divided differences from the data: $u_{-2}=1, u_{-1}=2, u_{0}=3, u_{1}=20, u_{2}=25$ with $h=1$.\n- First-order differences:\n  - $u[x_{-2}, x_{-1}] = \\frac{2-1}{1} = 1$\n  - $u[x_{-1}, x_0] = \\frac{3-2}{1} = 1$\n  - $u[x_0, x_1] = \\frac{20-3}{1} = 17$\n- Second-order differences:\n  - $u[x_{-2}, x_{-1}, x_0] = \\frac{u[x_{-1}, x_0] - u[x_{-2}, x_{-1}]}{x_0 - x_{-2}} = \\frac{1 - 1}{2} = 0$\n  - $u[x_{-1}, x_0, x_1] = \\frac{u[x_0, x_1] - u[x_{-1}, x_0]}{x_1 - x_{-1}} = \\frac{17 - 1}{2} = 8$\n\n**3. Perform ENO Stencil Selection**\n- **Step 1:** The initial one-point stencil is $\\{x_0\\}$.\n- **Step 2:** To expand to a two-point stencil, we compare $|u[x_{-1}, x_0]| = 1$ with $|u[x_0, x_1]| = 17$. Since $1 < 17$, we choose the leftward direction. The stencil becomes $\\{x_{-1}, x_0\\}$.\n- **Step 3:** To expand to a three-point stencil, we compare the second-order differences involving the current stencil. The candidates are $\\{x_{-2}, x_{-1}, x_0\\}$ and $\\{x_{-1}, x_0, x_1\\}$. We compare $|u[x_{-2}, x_{-1}, x_0]| = 0$ with $|u[x_{-1}, x_0, x_1]| = 8$. Since $0 < 8$, we again choose the leftward direction.\n\nThe final third-order ENO stencil is $\\{x_{-2}, x_{-1}, x_0\\}$.\n\n**4. Construct Interpolating Polynomial and Evaluate**\nThe stencil corresponds to the points $(-2, 1)$, $(-1, 2)$, and $(0, 3)$. We use the Newton form of the interpolating polynomial anchored at $x_{-2}$:\n$$\nP(x) = u[x_{-2}] + u[x_{-2}, x_{-1}](x - x_{-2}) + u[x_{-2}, x_{-1}, x_0](x - x_{-2})(x - x_{-1})\n$$\nSubstituting the computed values:\n$$\nP(x) = 1 + 1 \\cdot (x - (-2)) + 0 \\cdot (x - (-2))(x - (-1))\n$$\n$$\nP(x) = 1 + (x + 2) = x + 3\n$$\nThis polynomial correctly interpolates the data on the chosen stencil: $P(-2)=1, P(-1)=2, P(0)=3$.\n\n**5. Final Calculation**\nFinally, we evaluate the polynomial at the interface $x_{1/2} = 0.5$:\n$$\nu_{1/2}^{-} = P(0.5) = 0.5 + 3 = 3.5\n$$\nThe numerical value is $3.5$ or $\\frac{7}{2}$.", "answer": "$$\\boxed{\\frac{7}{2}}$$", "id": "3385596"}, {"introduction": "Weighted Essentially Non-Oscillatory (WENO) methods offer a sophisticated improvement over ENO by not discarding stencils, but instead combining them via a convex combination. The genius of WENO lies in its nonlinear weights, which are designed to approach zero for stencils crossing discontinuities, while distributing optimally for smooth data. In this exercise, you will compute these nonlinear weights for a scenario with a sharp discontinuity, allowing you to quantify exactly how effectively the WENO framework identifies and suppresses the non-smooth stencil's contribution [@problem_id:3385570].", "problem": "Consider the scalar hyperbolic conservation law $u_{t} + f(u)_{x} = 0$ discretized on a uniform grid with spacing $\\Delta x$, where one approximates the numerical flux at the interface $x_{i+1/2}$ by a convex combination of candidate polynomial reconstructions selected from upwind-biased three-point stencils. In the Weighted Essentially Non-Oscillatory (WENO) framework of Jiang and Shu (JS), nonlinear weights suppress contributions from stencils that cross a discontinuity by amplifying their smoothness indicators.\n\nYou are given pointwise nodal samples of the physical flux $f(u)$ on the stencil indices $\\{i-2,i-1,i,i+1,i+2\\}$ at a time when the data contain a single jump located between $x_{i+1}$ and $x_{i+2}$:\n$$\nf_{i-2} = 1.0,\\quad f_{i-1} = 1.1,\\quad f_{i} = 1.2,\\quad f_{i+1} = 1.3,\\quad f_{i+2} = 5.0.\n$$\nUse the standard fifth-order finite-difference WENO-JS reconstruction at the interface $x_{i+1/2}$ with ideal linear weights $d_{0} = 0.1$, $d_{1} = 0.6$, $d_{2} = 0.3$, a small positive parameter $\\epsilon = 10^{-6}$ to avoid division by zero, and power $p = 2$ in the nonlinear weight formula. Starting from the foundational definitions of the WENO-JS smoothness indicators and their role in determining the nonlinear weights, compute the three nonlinear weights $w_{0}$, $w_{1}$, and $w_{2}$ for the stencils $\\{i-2,i-1,i\\}$, $\\{i-1,i,i+1\\}$, and $\\{i,i+1,i+2\\}$, respectively. Then quantify the suppression of the discontinuity-crossing stencil by reporting the suppression factor\n$$\nS := \\frac{w_{2}}{d_{2}},\n$$\nwhich measures how small the nonlinear weight $w_{2}$ is relative to its ideal weight $d_{2}$.\n\nRound all entries of your final answer to four significant figures. No physical units are required. Express angles, if any arise, in radians.", "solution": "The solution involves three main steps: calculating the smoothness indicators for each stencil, using these to find the nonlinear weights, and finally computing the suppression factor.\n\n**1. Compute Smoothness Indicators ($\\beta_k$)**\nThe standard Jiang-Shu (JS) smoothness indicators for a fifth-order finite-difference scheme are given by:\n- Stencil $S_0=\\{i-2,i-1,i\\}$: $\\beta_0 = \\frac{13}{12}(f_{i-2} - 2f_{i-1} + f_i)^2 + \\frac{1}{4}(f_{i-2} - 4f_{i-1} + 3f_i)^2$\n- Stencil $S_1=\\{i-1,i,i+1\\}$: $\\beta_1 = \\frac{13}{12}(f_{i-1} - 2f_i + f_{i+1})^2 + \\frac{1}{4}(f_{i-1} - f_{i+1})^2$\n- Stencil $S_2=\\{i,i+1,i+2\\}$: $\\beta_2 = \\frac{13}{12}(f_i - 2f_{i+1} + f_{i+2})^2 + \\frac{1}{4}(3f_i - 4f_{i+1} + f_{i+2})^2$\n\nUsing the given flux values $f_{i-2}=1.0, f_{i-1}=1.1, f_i=1.2, f_{i+1}=1.3, f_{i+2}=5.0$:\n- For $\\beta_0$:\n  $f_{i-2} - 2f_{i-1} + f_i = 1.0 - 2(1.1) + 1.2 = 0.0$\n  $f_{i-2} - 4f_{i-1} + 3f_i = 1.0 - 4(1.1) + 3(1.2) = 0.2$\n  $\\beta_0 = \\frac{13}{12}(0.0)^2 + \\frac{1}{4}(0.2)^2 = 0.01$\n- For $\\beta_1$:\n  $f_{i-1} - 2f_i + f_{i+1} = 1.1 - 2(1.2) + 1.3 = 0.0$\n  $f_{i-1} - f_{i+1} = 1.1 - 1.3 = -0.2$\n  $\\beta_1 = \\frac{13}{12}(0.0)^2 + \\frac{1}{4}(-0.2)^2 = 0.01$\n- For $\\beta_2$:\n  $f_i - 2f_{i+1} + f_{i+2} = 1.2 - 2(1.3) + 5.0 = 3.6$\n  $3f_i - 4f_{i+1} + f_{i+2} = 3(1.2) - 4(1.3) + 5.0 = 3.4$\n  $\\beta_2 = \\frac{13}{12}(3.6)^2 + \\frac{1}{4}(3.4)^2 = 14.04 + 2.89 = 16.93$\n\n**2. Compute Nonlinear Weights ($w_k$)**\nThe weights are calculated as $w_k = \\frac{\\alpha_k}{\\sum_{j=0}^{2} \\alpha_j}$, where $\\alpha_k = \\frac{d_k}{(\\beta_k + \\epsilon)^p}$ with $p=2$ and $\\epsilon=10^{-6}$.\n- $\\alpha_0 = \\frac{0.1}{(0.01 + 10^{-6})^2} \\approx \\frac{0.1}{0.00010002} \\approx 999.80$\n- $\\alpha_1 = \\frac{0.6}{(0.01 + 10^{-6})^2} \\approx \\frac{0.6}{0.00010002} \\approx 5998.80$\n- $\\alpha_2 = \\frac{0.3}{(16.93 + 10^{-6})^2} \\approx \\frac{0.3}{286.6249} \\approx 0.00104666$\n\nThe sum is $\\sum \\alpha_j \\approx 999.80 + 5998.80 + 0.00104666 = 6998.601$.\nNow we normalize:\n- $w_0 = \\frac{999.80}{6998.601} \\approx 0.142857$\n- $w_1 = \\frac{5998.80}{6998.601} \\approx 0.857143$\n- $w_2 = \\frac{0.00104666}{6998.601} \\approx 1.49553 \\times 10^{-7}$\n\nRounding to four significant figures, we get:\n$w_0 \\approx 0.1429$, $w_1 \\approx 0.8571$, $w_2 \\approx 1.496 \\times 10^{-7}$.\n\n**3. Compute Suppression Factor ($S$)**\nThe suppression factor for stencil $S_2$ is $S = \\frac{w_2}{d_2}$.\n- $S = \\frac{1.49553 \\times 10^{-7}}{0.3} \\approx 4.98510 \\times 10^{-7}$\n\nRounding to four significant figures, $S \\approx 4.985 \\times 10^{-7}$.", "answer": "$$\n\\boxed{\\begin{pmatrix} 0.1429 & 0.8571 & 1.496 \\times 10^{-7} & 4.985 \\times 10^{-7} \\end{pmatrix}}\n$$", "id": "3385570"}]}