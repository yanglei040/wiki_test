{"hands_on_practices": [{"introduction": "The Harten-Lax-van Leer (HLL) solver is a foundational and robust approximate Riemann solver essential for understanding modern computational fluid dynamics. This first exercise provides a direct, hands-on calculation of the HLL numerical flux for the Euler equations. By computing the signal velocities $S_L$ and $S_R$ and assembling the flux components for a specific set of initial conditions, you will solidify your understanding of the solver's core mechanics [@problem_id:3364359].", "problem": "Consider the one-dimensional compressible Euler equations for a calorically perfect gas with ratio of specific heats $\\gamma$. Let the left and right states at an interface be given in primitive variables as $(\\rho_L,u_L,p_L)$ and $(\\rho_R,u_R,p_R)$, with corresponding conservative variables $U=(\\rho,\\rho u,E)$ and physical flux $F(U)=(\\rho u,\\rho u^2+p,u(E+p))$. Assume the ideal-gas speed of sound $a=\\sqrt{\\gamma p/\\rho}$. Using Davis's wave speed estimates, define the left and right signal velocities as $S_L$ and $S_R$ obtained from the left and right states. Assemble the Harten–Lax–van Leer (HLL) numerical flux at the interface from these ingredients.\n\nWork with the specific data:\n- $\\gamma=1.4$,\n- left state $(\\rho_L,u_L,p_L)=(1.0,20.0,1.0\\times 10^{5})$,\n- right state $(\\rho_R,u_R,p_R)=(0.125,-10.0,1.0\\times 10^{4})$,\n\nwhere $\\rho$ is in $\\mathrm{kg}\\,\\mathrm{m}^{-3}$, $u$ is in $\\mathrm{m}\\,\\mathrm{s}^{-1}$, and $p$ is in $\\mathrm{Pa}$. Using Davis's estimates $S_L=\\min(u_L-a_L,u_R-a_R)$ and $S_R=\\max(u_L+a_L,u_R+a_R)$, and the Harten–Lax–van Leer (HLL) construction for the numerical flux, compute the mass-flux component (the first component) of the HLL flux at the interface.\n\nRound your final result to four significant figures and express it in $\\mathrm{kg}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$.", "solution": "The problem asks for the computation of the mass-flux component of the Harten-Lax-van Leer (HLL) numerical flux for the one-dimensional Euler equations, given specific left and right states and using Davis's wave speed estimates.\n\nThe one-dimensional Euler equations in conservative form are given by $\\frac{\\partial U}{\\partial t} + \\frac{\\partial F(U)}{\\partial x} = 0$, where $U$ is the vector of conserved variables and $F(U)$ is the physical flux vector. For this problem, they are defined as:\n$$\nU = \\begin{pmatrix} \\rho \\\\ \\rho u \\\\ E \\end{pmatrix}, \\quad F(U) = \\begin{pmatrix} \\rho u \\\\ \\rho u^2 + p \\\\ u(E+p) \\end{pmatrix}\n$$\nwhere $\\rho$ is the density, $u$ is the velocity, $p$ is the pressure, and $E$ is the total energy per unit volume. The problem requires the calculation of the first component of the HLL numerical flux, which corresponds to the mass flux.\n\nThe HLL numerical flux, $F_{HLL}$, is an approximation to the solution of the Riemann problem at a cell interface. It is defined based on the left and right wave speed estimates, $S_L$ and $S_R$. The formula for the HLL flux is:\n$$\nF_{HLL} = \n\\begin{cases} \nF_L & \\text{if } S_L \\ge 0 \\\\\n\\frac{S_R F_L - S_L F_R + S_L S_R (U_R - U_L)}{S_R - S_L} & \\text{if } S_L < 0 < S_R \\\\\nF_R & \\text{if } S_R \\le 0 \n\\end{cases}\n$$\nwhere $U_L$ and $F_L$ are the conservative state and flux vectors evaluated using the left state $(\\rho_L, u_L, p_L)$, and $U_R$ and $F_R$ are evaluated using the right state $(\\rho_R, u_R, p_R)$.\n\nThe problem asks only for the mass-flux component, which is the first component of the $F_{HLL}$ vector. Let's denote the first component of any vector $V$ as $V_1$. Then we have:\n$U_1 = \\rho$\n$F_1 = \\rho u$\n\nFirst, we calculate the necessary quantities from the given left and right states.\nThe gas has a ratio of specific heats $\\gamma = 1.4$.\n\n**Left State (L):**\nPrimitive variables: $(\\rho_L, u_L, p_L) = (1.0, 20.0, 1.0 \\times 10^5)$.\nThe speed of sound $a_L$ is calculated as:\n$$\na_L = \\sqrt{\\frac{\\gamma p_L}{\\rho_L}} = \\sqrt{\\frac{(1.4)(1.0 \\times 10^5)}{1.0}} = \\sqrt{140000} \\approx 374.1657 \\, \\mathrm{m}\\,\\mathrm{s}^{-1}\n$$\nThe first components of the state and flux vectors are:\n$$\nU_{L,1} = \\rho_L = 1.0 \\, \\mathrm{kg}\\,\\mathrm{m}^{-3}\n$$\n$$\nF_{L,1} = \\rho_L u_L = (1.0)(20.0) = 20.0 \\, \\mathrm{kg}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}\n$$\n\n**Right State (R):**\nPrimitive variables: $(\\rho_R, u_R, p_R) = (0.125, -10.0, 1.0 \\times 10^4)$.\nThe speed of sound $a_R$ is calculated as:\n$$\na_R = \\sqrt{\\frac{\\gamma p_R}{\\rho_R}} = \\sqrt{\\frac{(1.4)(1.0 \\times 10^4)}{0.125}} = \\sqrt{112000} \\approx 334.6640 \\, \\mathrm{m}\\,\\mathrm{s}^{-1}\n$$\nThe first components of the state and flux vectors are:\n$$\nU_{R,1} = \\rho_R = 0.125 \\, \\mathrm{kg}\\,\\mathrm{m}^{-3}\n$$\n$$\nF_{R,1} = \\rho_R u_R = (0.125)(-10.0) = -1.25 \\, \\mathrm{kg}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}\n$$\n\nNext, we calculate the wave speed estimates $S_L$ and $S_R$ using the provided Davis's estimates:\n$$\nS_L = \\min(u_L - a_L, u_R - a_R)\n$$\n$$\nS_R = \\max(u_L + a_L, u_R + a_R)\n$$\nWe compute the characteristic speeds:\n$$\nu_L - a_L \\approx 20.0 - 374.1657 = -354.1657 \\, \\mathrm{m}\\,\\mathrm{s}^{-1}\n$$\n$$\nu_R - a_R \\approx -10.0 - 334.6640 = -344.6640 \\, \\mathrm{m}\\,\\mathrm{s}^{-1}\n$$\n$$\nu_L + a_L \\approx 20.0 + 374.1657 = 394.1657 \\, \\mathrm{m}\\,\\mathrm{s}^{-1}\n$$\n$$\nu_R + a_R \\approx -10.0 + 334.6640 = 324.6640 \\, \\mathrm{m}\\,\\mathrm{s}^{-1}\n$$\nNow we find the minimum and maximum speeds for $S_L$ and $S_R$:\n$$\nS_L = \\min(-354.1657, -344.6640) = -354.165738... \\, \\mathrm{m}\\,\\mathrm{s}^{-1}\n$$\n$$\nS_R = \\max(394.1657, 324.6640) = 394.165738... \\, \\mathrm{m}\\,\\mathrm{s}^{-1}\n$$\nWe observe that $S_L < 0$ and $S_R > 0$. Therefore, we must use the central formula for the HLL flux. The first component of the HLL flux, $F_{HLL,1}$, is:\n$$\nF_{HLL,1} = \\frac{S_R F_{L,1} - S_L F_{R,1} + S_L S_R (U_{R,1} - U_{L,1})}{S_R - S_L}\n$$\nPlugging in the computed values:\n$F_{L,1} = 20.0$\n$F_{R,1} = -1.25$\n$U_{L,1} = 1.0$\n$U_{R,1} = 0.125$\n$S_L \\approx -354.1657$\n$S_R \\approx 394.1657$\n\nLet's compute the terms in the formula:\nThe denominator is:\n$$\nS_R - S_L \\approx 394.165738 - (-354.165738) = 748.331476 \\, \\mathrm{m}\\,\\mathrm{s}^{-1}\n$$\nThe numerator consists of three terms:\nTerm 1: $S_R F_{L,1} \\approx (394.165738)(20.0) = 7883.31476$\nTerm 2: $-S_L F_{R,1} \\approx -(-354.165738)(-1.25) = -442.7071725$\nTerm 3: $S_L S_R (U_{R,1} - U_{L,1})$\nFor this particular dataset, $S_L = u_L - a_L$ and $S_R = u_L + a_L$. This simplifies the product $S_L S_R$ to $u_L^2 - a_L^2 = (20.0)^2 - (\\sqrt{140000})^2 = 400 - 140000 = -139600$.\n$$\nS_L S_R (U_{R,1} - U_{L,1}) = (-139600)(0.125 - 1.0) = (-139600)(-0.875) = 122150\n$$\nSumming the terms in the numerator:\n$$\n\\text{Numerator} \\approx 7883.31476 - 442.7071725 + 122150 = 129590.6075875\n$$\nFinally, we compute the flux:\n$$\nF_{HLL,1} = \\frac{129590.6075875}{748.331476} \\approx 173.17646\n$$\nThe problem asks to round the result to four significant figures.\n$$\nF_{HLL,1} \\approx 173.2 \\, \\mathrm{kg}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}\n$$\nAll input values were given in base SI units, so the resulting flux is also in SI units, which for mass flux is $\\mathrm{kg}\\,\\mathrm{m}^{-2}\\,\\mathrm{s}^{-1}$.", "answer": "$$\n\\boxed{173.2}\n$$", "id": "3364359"}, {"introduction": "While robust, the basic HLL solver has a known deficiency: it introduces significant numerical diffusion at contact discontinuities. This practice quantitatively demonstrates this issue by analyzing the HLL solver's wave model for the classic Sod problem. By calculating the width of the intermediate \"star region,\" $(S_R - S_L)\\Delta t$, you will see precisely why a more refined model like Harten-Lax-van Leer-Contact (HLLC), which explicitly tracks the contact wave, is necessary for high-fidelity simulations [@problem_id:3364391].", "problem": "Consider the one-dimensional compressible Euler equations for an ideal gas with ratio of specific heats $\\gamma = 1.4$ written in conservation form,\n$$\n\\frac{\\partial \\boldsymbol{U}}{\\partial t} + \\frac{\\partial \\boldsymbol{F}(\\boldsymbol{U})}{\\partial x} = 0,\n$$\nwhere $\\boldsymbol{U} = (\\rho, \\rho u, E)^{\\top}$ and $\\boldsymbol{F}(\\boldsymbol{U}) = (\\rho u,\\; \\rho u^{2} + p,\\; u(E + p))^{\\top}$. The equation of state is $p = (\\gamma - 1)\\left(E - \\tfrac{1}{2}\\rho u^{2}\\right)$.\n\nA Sod-type Riemann problem is posed at $x=0$ with left and right states\n$$\n(\\rho_{L}, u_{L}, p_{L}) = (1,\\; 0,\\; 1), \\quad (\\rho_{R}, u_{R}, p_{R}) = (0.125,\\; 0,\\; 0.1),\n$$\nin nondimensional units. A uniform finite volume discretization with cell width $\\Delta x = 1$ is used, with the discontinuity located at the interface $x_{1/2} = 0$ between two cells. An explicit Euler time update is computed using a single Riemann flux at $x_{1/2}$, and boundary-adjacent fluxes are equal to the corresponding uniform-state fluxes.\n\nDefine the Courant–Friedrichs–Lewy (CFL) number $\\mathrm{CFL} = 0.5$, and choose the time-step\n$$\n\\Delta t = \\frac{\\mathrm{CFL}\\,\\Delta x}{\\max(|u_{L}| + a_{L},\\, |u_{R}| + a_{R})},\n$$\nwhere the speed of sound is $a = \\sqrt{\\gamma p / \\rho}$ evaluated in each state.\n\nThe Riemann flux at $x_{1/2}$ is to be computed using:\n- The Harten–Lax–van Leer (HLL) approximate Riemann solver with two-wave speeds $S_{L}$ and $S_{R}$ estimated by Davis’ bounds $S_{L} = \\min(u_{L} - a_{L},\\, u_{R} - a_{R})$ and $S_{R} = \\max(u_{L} + a_{L},\\, u_{R} + a_{R})$.\n- The Harten–Lax–van Leer with Contact (HLLC) approximate Riemann solver with the contact wave speed $S_{*}$ obtained from consistency with the Rankine–Hugoniot conditions across $S_{L}$ and $S_{R}$:\n$$\nS_{*} = \\frac{p_{R} - p_{L} + \\rho_{L} u_{L}(S_{L} - u_{L}) - \\rho_{R} u_{R}(S_{R} - u_{R})}{\\rho_{L}(S_{L} - u_{L}) - \\rho_{R}(S_{R} - u_{R})}.\n$$\n\nFor each solver, perform the explicit flux evaluation at $x_{1/2}$ and the corresponding one-step update of the two adjacent cell averages. Define the “contact discontinuity thickness after one time step” as the spatial width of the intermediate self-similar region in the solver’s wave model that contains the contact wave at time $\\Delta t$:\n- For HLL, this is the width of the single intermediate region between $S_{L}$ and $S_{R}$, equal to $(S_{R} - S_{L})\\,\\Delta t$.\n- For HLLC, the contact is an actual discontinuity at speed $S_{*}$ and thus has zero geometrical thickness in the wave model.\n\nCompute the difference between the HLL and HLLC contact thicknesses after one time step,\n$$\n\\Theta \\equiv \\left[(S_{R} - S_{L})\\,\\Delta t\\right] - 0,\n$$\nusing the specified initial states and $\\mathrm{CFL}$ selection. Express the final result as a single nondimensional number, and round your answer to four significant figures.", "solution": "The user wants to find the difference in contact discontinuity thickness, $\\Theta$, between the Harten-Lax-van Leer (HLL) and Harten-Lax-van Leer-Contact (HLLC) approximate Riemann solvers for a specific one-dimensional Euler equations problem.\n\nThe problem is first validated.\n\n### Step 1: Extract Givens\n- **Governing Equations**: 1D compressible Euler equations, $\\frac{\\partial \\boldsymbol{U}}{\\partial t} + \\frac{\\partial \\boldsymbol{F}(\\boldsymbol{U})}{\\partial x} = 0$.\n- **State and Flux Vectors**: $\\boldsymbol{U} = (\\rho, \\rho u, E)^{\\top}$, $\\boldsymbol{F}(\\boldsymbol{U}) = (\\rho u, \\rho u^{2} + p, u(E + p))^{\\top}$.\n- **Equation of State**: $p = (\\gamma - 1)\\left(E - \\tfrac{1}{2}\\rho u^{2}\\right)$.\n- **Ratio of Specific Heats**: $\\gamma = 1.4$.\n- **Left State**: $(\\rho_{L}, u_{L}, p_{L}) = (1, 0, 1)$.\n- **Right State**: $(\\rho_{R}, u_{R}, p_{R}) = (0.125, 0, 0.1)$.\n- **Discretization**: Cell width $\\Delta x = 1$.\n- **Time Stepping**: $\\mathrm{CFL} = 0.5$, $\\Delta t = \\frac{\\mathrm{CFL}\\,\\Delta x}{\\max(|u_{L}| + a_{L}, |u_{R}| + a_{R})}$.\n- **Speed of Sound**: $a = \\sqrt{\\gamma p / \\rho}$.\n- **HLL Wave Speeds (Davis' estimates)**: $S_{L} = \\min(u_{L} - a_{L}, u_{R} - a_{R})$ and $S_{R} = \\max(u_{L} + a_{L}, u_{R} + a_{R})$.\n- **Target Quantity**: $\\Theta = (S_{R} - S_{L})\\Delta t$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is scientifically grounded, as it deals with standard equations and numerical methods (Euler equations, HLL/HLLC solvers) in computational fluid dynamics. The specified initial conditions correspond to the well-known Sod shock tube problem, a standard benchmark. All necessary parameters and definitions ($\\gamma$, initial states, $\\Delta x$, $\\mathrm{CFL}$, formulas for $a$, $\\Delta t$, $S_L$, $S_R$, and $\\Theta$) are provided, making the problem self-contained and well-posed. The language is objective and precise. The problem is not trivial, as it requires careful application of the provided formulas, and it correctly identifies that a large part of the contextual information (e.g., the formula for $S_*$) is not needed for the final calculation. There are no contradictions or factual errors.\n\n### Step 3: Verdict and Action\nThe problem is valid. A complete, reasoned solution will be provided.\n\n### Solution Derivation\nThe objective is to compute the quantity $\\Theta$, defined as the spatial width of the HLL intermediate region after one time step, $\\Delta t$. The formula is given as $\\Theta = (S_{R} - S_{L})\\,\\Delta t$. The calculation proceeds in several steps.\n\nFirst, we calculate the speed of sound, $a$, for the left ($L$) and right ($R$) states. The formula is $a = \\sqrt{\\gamma p / \\rho}$.\nFor the left state with $(\\rho_{L}, u_{L}, p_{L}) = (1, 0, 1)$ and $\\gamma = 1.4$:\n$$\na_{L} = \\sqrt{\\frac{\\gamma p_{L}}{\\rho_{L}}} = \\sqrt{\\frac{1.4 \\times 1}{1}} = \\sqrt{1.4}\n$$\nFor the right state with $(\\rho_{R}, u_{R}, p_{R}) = (0.125, 0, 0.1)$:\n$$\na_{R} = \\sqrt{\\frac{\\gamma p_{R}}{\\rho_{R}}} = \\sqrt{\\frac{1.4 \\times 0.1}{0.125}} = \\sqrt{\\frac{0.14}{0.125}} = \\sqrt{1.12}\n$$\nWe note that $1.4 > 1.12$, so $a_{L} > a_{R}$.\n\nNext, we calculate the time step, $\\Delta t$, using the provided Courant–Friedrichs–Lewy (CFL) condition.\n$$\n\\Delta t = \\frac{\\mathrm{CFL}\\,\\Delta x}{\\max(|u_{L}| + a_{L}, |u_{R}| + a_{R})}\n$$\nGiven $\\mathrm{CFL} = 0.5$, $\\Delta x = 1$, and $u_{L} = u_{R} = 0$:\n$$\n\\max(|u_{L}| + a_{L}, |u_{R}| + a_{R}) = \\max(a_{L}, a_{R}) = \\max(\\sqrt{1.4}, \\sqrt{1.12}) = \\sqrt{1.4} = a_{L}\n$$\nSubstituting these values into the formula for $\\Delta t$:\n$$\n\\Delta t = \\frac{0.5 \\times 1}{\\sqrt{1.4}} = \\frac{0.5}{\\sqrt{1.4}}\n$$\n\nNow, we compute the HLL wave speeds, $S_{L}$ and $S_{R}$, using the specified Davis' estimates.\nFor the leftmost wave speed, $S_{L}$:\n$$\nS_{L} = \\min(u_{L} - a_{L}, u_{R} - a_{R}) = \\min(0 - \\sqrt{1.4}, 0 - \\sqrt{1.12}) = \\min(-\\sqrt{1.4}, -\\sqrt{1.12})\n$$\nSince $\\sqrt{1.4} > \\sqrt{1.12}$, it follows that $-\\sqrt{1.4} < -\\sqrt{1.12}$. Therefore:\n$$\nS_{L} = -\\sqrt{1.4} = -a_{L}\n$$\nFor the rightmost wave speed, $S_{R}$:\n$$\nS_{R} = \\max(u_{L} + a_{L}, u_{R} + a_{R}) = \\max(0 + \\sqrt{1.4}, 0 + \\sqrt{1.12}) = \\max(\\sqrt{1.4}, \\sqrt{1.12})\n$$\nTherefore:\n$$\nS_{R} = \\sqrt{1.4} = a_{L}\n$$\n\nFinally, we compute $\\Theta = (S_{R} - S_{L})\\,\\Delta t$.\nSubstituting the expressions we found for $S_{R}$, $S_{L}$, and $\\Delta t$:\n$$\n\\Theta = \\left(\\sqrt{1.4} - (-\\sqrt{1.4})\\right) \\left(\\frac{0.5}{\\sqrt{1.4}}\\right) = (2\\sqrt{1.4}) \\left(\\frac{0.5}{\\sqrt{1.4}}\\right)\n$$\nThe terms involving $\\sqrt{1.4}$ cancel out, leading to a simple result:\n$$\n\\Theta = 2 \\times 0.5 = 1\n$$\nThis result can also be obtained symbolically. For the given conditions where $u_L=u_R=0$ and $a_L>a_R$, we have:\n$S_L = -a_L$\n$S_R = a_L$\n$\\Delta t = \\frac{\\mathrm{CFL}\\,\\Delta x}{a_L}$\nThen, $\\Theta = (S_R - S_L)\\Delta t = (a_L - (-a_L))\\frac{\\mathrm{CFL}\\,\\Delta x}{a_L} = (2a_L)\\frac{\\mathrm{CFL}\\,\\Delta x}{a_L} = 2 \\times \\mathrm{CFL} \\times \\Delta x$.\nPlugging in the given values $\\mathrm{CFL} = 0.5$ and $\\Delta x = 1$ yields:\n$$\n\\Theta = 2 \\times 0.5 \\times 1 = 1\n$$\nThe problem requests the result rounded to four significant figures. An exact value of $1$ is written as $1.000$ to meet this requirement.", "answer": "$$\n\\boxed{1.000}\n$$", "id": "3364391"}, {"introduction": "The true power of modern approximate Riemann solvers is unleashed when they are coupled with high-order spatial reconstruction methods. This capstone exercise challenges you to bridge the gap between theory and application by implementing a complete one-step finite-volume scheme. You will integrate a 5th-order Weighted Essentially Non-Oscillatory (WENO) reconstruction with the HLLC solver to tackle several challenging test cases for the Euler equations [@problem_id:3364352].", "problem": "Consider the one-dimensional compressible Euler equations for a calorically perfect gas, written in conservation form for the conserved variables $U = [\\rho, \\rho u, E]^\\top$ with flux $F(U) = [\\rho u, \\rho u^2 + p, u (E + p)]^\\top$, where $\\rho$ is the mass density, $u$ is the velocity, $E$ is the total energy density, and $p$ is the pressure. The pressure is related to the conserved variables by the ideal-gas equation of state $p = (\\gamma - 1)\\left(E - \\tfrac{1}{2}\\rho u^2\\right)$, where $\\gamma$ is the ratio of specific heats. You will implement a single explicit finite-volume time step for these equations on a uniform grid using high-order nonlinear reconstruction and an approximate Riemann solver. All quantities in this problem are non-dimensional; no physical units are required.\n\nYou must perform the following steps:\n- Use a finite-volume semidiscrete update on a uniform grid with $N$ cells spanning the interval $[0, L]$. Let $\\Delta x = L/N$, and denote the cell-averaged conserved variables at time $t^n$ by $U_i^n$ for cell index $i$. Advance one time step by computing $U_i^{n+1} = U_i^n - \\frac{\\Delta t}{\\Delta x}\\left(F_{i+\\frac{1}{2}} - F_{i-\\frac{1}{2}}\\right)$ for interior cells, where $F_{i\\pm\\frac{1}{2}}$ are numerical fluxes at cell interfaces.\n- Construct left and right interface states $V_{i+\\frac{1}{2}}^L$ and $V_{i+\\frac{1}{2}}^R$ for the primitive variables $V = [\\rho, u, p]^\\top$ using a $5$th-order Weighted Essentially Non-Oscillatory (WENO) reconstruction from cell-centered primitive variables. Use outflow (zero-gradient) boundary conditions implemented via $3$ ghost cells on each boundary.\n- Compute the numerical flux $F_{i+\\frac{1}{2}}$ using the Harten–Lax–van Leer–Contact (HLLC) approximate Riemann solver applied to the reconstructed left and right states at each interface, with a physically reasonable wave-speed estimate.\n- Choose the time step $\\Delta t$ from the Courant–Friedrichs–Lewy (CFL) condition: $\\Delta t = \\text{CFL}\\,\\Delta x / \\max_i\\left(|u_i| + a_i\\right)$, where $a_i = \\sqrt{\\gamma p_i / \\rho_i}$ is the local sound speed computed from primitive variables at time $t^n$.\n- To ensure numerical robustness for extreme states, enforce the positivity of reconstructed density and pressure by applying floors $\\rho \\gets \\max(\\rho, \\varepsilon_\\rho)$ and $p \\gets \\max(p, \\varepsilon_p)$ with small positive constants $\\varepsilon_\\rho$ and $\\varepsilon_p$.\n\nYour program must implement the above algorithm and apply it to the test suite specified below. For each test case, run exactly one time step from the given initial data and report the domain-integrated conserved quantities after the update, defined as $M = \\sum_{i} \\rho_i^{n+1}\\,\\Delta x$, $P = \\sum_{i} (\\rho u)_i^{n+1}\\,\\Delta x$, and $E_T = \\sum_{i} E_i^{n+1}\\,\\Delta x$, as floating-point numbers.\n\nTest suite:\n- Case $1$ (general asymmetric Riemann problem): $L = 1$, $N = 200$, $\\gamma = 1.4$, $\\text{CFL} = 0.4$. Initial primitive variables are piecewise constant: for $x < 0.5$, $[\\rho, u, p] = [1.0, 0.75, 1.0]$; for $x \\ge 0.5$, $[\\rho, u, p] = [0.125, 0.0, 0.1]$.\n- Case $2$ (uniform flow, boundary consistency): $L = 1$, $N = 64$, $\\gamma = 1.4$, $\\text{CFL} = 0.5$. Initial primitive variables are uniform: $[\\rho, u, p] = [0.8, -0.2, 0.5]$ for all $x$.\n- Case $3$ (near-vacuum left, strong expansion): $L = 1$, $N = 400$, $\\gamma = 1.4$, $\\text{CFL} = 0.2$. Initial primitive variables are piecewise constant: for $x < 0.5$, $[\\rho, u, p] = [0.01, 2.0, 0.001]$; for $x \\ge 0.5$, $[\\rho, u, p] = [1.0, 0.0, 1.0]$.\n\nImplementation requirements:\n- Use exactly $3$ ghost cells on each boundary with outflow boundary conditions, i.e., set ghost cell values equal to the nearest interior cell values at each reconstruction step.\n- Reconstruct primitive variables component-wise using $5$-point stencils to produce $V_{i+\\frac{1}{2}}^L$ and $V_{i+\\frac{1}{2}}^R$ at all interior faces.\n- Compute HLLC fluxes using a consistent estimate of left, right, and contact wave speeds based on the reconstructed interface states and the ideal-gas relation.\n- Perform exactly one update step for each case and compute the totals $M$, $P$, and $E_T$ after the update.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. The list must contain the values $[M_1, P_1, E_{T,1}, M_2, P_2, E_{T,2}, M_3, P_3, E_{T,3}]$, in that exact order, where the subscript denotes the test case number. Print floating-point numbers in the default string format of the programming language.", "solution": "The user requests the implementation of a single time step of a high-order finite-volume scheme for the one-dimensional compressible Euler equations. The solution involves several standard components from computational fluidynamics, which will be detailed below. The conserved variables are $U = [\\rho, \\rho u, E]^\\top$ and the primitive variables are $V = [\\rho, u, p]^\\top$. The pressure $p$ is given by the ideal gas law $p = (\\gamma - 1)(E - \\frac{1}{2}\\rho u^2)$.\n\nThe core of the method is the semi-discrete finite-volume update for a cell $i$:\n$$\n\\frac{dU_i}{dt} = -\\frac{1}{\\Delta x}\\left(F_{i+\\frac{1}{2}} - F_{i-\\frac{1}{2}}\\right)\n$$\nwhere $U_i$ is the cell-averaged conserved state and $F_{i\\pm\\frac{1}{2}}$ are the numerical fluxes at the cell interfaces. An explicit Euler method is used for the time integration:\n$$\nU_i^{n+1} = U_i^n - \\frac{\\Delta t}{\\Delta x}\\left(F_{i+\\frac{1}{2}} - F_{i-\\frac{1}{2}}\\right)\n$$\nThe time step $\\Delta t$ is determined by the CFL condition, $\\Delta t = \\text{CFL} \\frac{\\Delta x}{\\max_i(|u_i| + a_i)}$, where $a_i = \\sqrt{\\gamma p_i / \\rho_i}$ is the sound speed.\n\nThe main challenge lies in computing the numerical fluxes $F_{i+\\frac{1}{2}}$. This is a two-stage process: reconstruction and the Riemann solver.\n\n**1. WENO Reconstruction**\nTo achieve high-order accuracy and capture shocks without spurious oscillations, a 5th-order Weighted Essentially Non-Oscillatory (WENO) scheme is used. At each interface $i+\\frac{1}{2}$, we need to reconstruct the state variables just to the left ($V_{i+\\frac{1}{2}}^L$) and just to the right ($V_{i+\\frac{1}{2}}^R$). The reconstruction is performed on the primitive variables $V = [\\rho, u, p]^\\top$ component-wise.\n\nLet's consider the reconstruction of a generic variable $v$ at interface $i+\\frac{1}{2}$. The left-biased reconstruction, $v_{i+\\frac{1}{2}}^L$, uses a 5-point stencil of cell-averaged values $\\{v_{i-2}, v_{i-1}, v_i, v_{i+1}, v_{i+2}\\}$. This stencil is split into three 3-point sub-stencils, each providing a 3rd-order candidate reconstruction $q_k$.\n- $q_0 = \\frac{1}{3}v_{i-2} - \\frac{7}{6}v_{i-1} + \\frac{11}{6}v_i$\n- $q_1 = -\\frac{1}{6}v_{i-1} + \\frac{5}{6}v_i + \\frac{1}{3}v_{i+1}$\n- $q_2 = \\frac{1}{3}v_i + \\frac{5}{6}v_{i+1} - \\frac{1}{6}v_{i+2}$\n\nThese candidates are combined using nonlinear weights $\\omega_k$ that depend on the smoothness of the solution in each sub-stencil. The smoothness is measured by indicators $IS_k$.\n- $IS_0 = \\frac{13}{12}(v_{i-2} - 2v_{i-1} + v_i)^2 + \\frac{1}{4}(v_{i-2} - 4v_{i-1} + 3v_i)^2$\n- $IS_1 = \\frac{13}{12}(v_{i-1} - 2v_i + v_{i+1})^2 + \\frac{1}{4}(v_{i-1} - v_{i+1})^2$\n- $IS_2 = \\frac{13}{12}(v_i - 2v_{i+1} + v_{i+2})^2 + \\frac{1}{4}(3v_i - 4v_{i+1} + v_{i+2})^2$\n\nThe nonlinear weights are computed as $\\omega_k = \\frac{\\alpha_k}{\\sum_j \\alpha_j}$, where $\\alpha_k = \\frac{d_k}{(\\varepsilon + IS_k)^2}$. The constants $d_k$ are the optimal linear weights that yield a 5th-order scheme for smooth solutions; for the left-biased scheme, they are $d_0=0.1$, $d_1=0.6$, $d_2=0.3$. The small parameter $\\varepsilon$ (e.g., $10^{-40}$) prevents division by zero.\n\nThe final reconstructed value is $v_{i+\\frac{1}{2}}^L = \\omega_0 q_0 + \\omega_1 q_1 + \\omega_2 q_2$. The right-biased reconstruction $v_{i+\\frac{1}{2}}^R$ is performed symmetrically using the stencil $\\{v_{i-1}, v_i, v_{i+1}, v_{i+2}, v_{i+3}\\}$ and a different set of linear weights ($d'_0=0.3$, $d'_1=0.6$, $d'_2=0.1$).\n\nThe problem requires outflow (zero-gradient) boundary conditions. This is implemented using $3$ ghost cells on each side of the domain, whose values are set equal to the nearest interior cell. After reconstruction, positivity of density and pressure is enforced by applying floor values.\n\n**2. HLLC Approximate Riemann Solver**\nWith the reconstructed left and right states ($V^L, V^R$) at each interface, we solve a local Riemann problem to find the flux. The Harten-Lax-van Leer-Contact (HLLC) solver is an efficient choice that correctly resolves isolated contact discontinuities and shocks.\n\nThe HLLC solver approximates the solution of the Riemann problem as consisting of four constant states separated by three waves: a leftmost wave (shock or rarefaction) with speed $S_L$, a contact wave with speed $S_M$, and a rightmost wave with speed $S_R$.\n\nThe key steps are:\n1.  **Estimate Wave Speeds**: The outer wave speeds $S_L$ and $S_R$ are crucial for stability and accuracy. A robust choice, based on Einfeldt's modification to Roe-averaged wave speeds, is used:\n    $$ S_L = \\min(u_L - a_L, u_{roe} - a_{roe}), \\quad S_R = \\max(u_R + a_R, u_{roe} + a_{roe}) $$\n    where $u_{roe}$ and $a_{roe}$ are Roe-averaged velocity and sound speed. The contact wave speed $S_M$ is then derived from the Rankine-Hugoniot jump conditions:\n    $$ S_M = \\frac{p_R - p_L + \\rho_L u_L (S_L - u_L) - \\rho_R u_R (S_R - u_R)}{\\rho_L (S_L - u_L) - \\rho_R (S_R - u_R)} $$\n\n2.  **Determine Flux**: The flux through the interface depends on the wave speeds relative to the interface (which is stationary at $x=0$ in the Riemann problem frame).\n    - If $S_L \\ge 0$, the entire wave structure is moving to the right, so the flux is simply the flux of the left state, $F(U_L)$.\n    - If $S_R \\le 0$, the entire structure moves left, and the flux is $F(U_R)$.\n    - If $S_L < 0 < S_R$, the interface is situated within the wave fan. The flux depends on the position of the contact wave speed $S_M$:\n        - If $S_M \\ge 0$, the interface is in the \"left star\" region (between the left wave and the contact). The flux is $F_{*L} = F_L + S_L(U_{*L} - U_L)$.\n        - If $S_M < 0$, the interface is in the \"right star\" region (between the contact and the right wave). The flux is $F_{*R} = F_R + S_R(U_{*R} - U_R)$.\n    The starred states $U_{*L}$ and $U_{*R}$ are derived from jump conditions across the outer waves.\n\n**3. Final Update**\nOnce the numerical fluxes $F_{i+1/2}$ are computed for all $N+1$ interior interfaces, the conserved variables in each of the $N$ cells are updated for one time step. The final step is to sum the resulting conserved quantities over the entire domain to obtain the total mass $M$, momentum $P$, and energy $E_T$.\n\nThe following code implements this entire algorithm in a vectorized fashion using NumPy for efficiency.\n\n```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the 1D Euler equations for three test cases using a 5th-order WENO scheme\n    and an HLLC Riemann solver for one time step.\n    \"\"\"\n\n    # --- Problem constants and helper functions ---\n    \n    # A small value to prevent division by zero in sensitive calculations\n    _TINY = 1e-40\n    # Positivity-preserving floors for rho and p\n    _RHO_FLOOR = 1e-9\n    _P_FLOOR = 1e-9\n\n    def prim_to_cons(V, gamma):\n        rho, u, p = V[0], V[1], V[2]\n        E = p / (gamma - 1.0) + 0.5 * rho * u**2\n        return np.array([rho, rho * u, E])\n\n    def cons_to_prim(U, gamma):\n        rho, rhou, E = U[0], U[1], U[2]\n        u = rhou / (rho + _TINY)  \n        p = (gamma - 1.0) * (E - 0.5 * rho * u**2)\n        return np.array([rho, u, p])\n\n    def get_flux_from_cons_prim(U, V, gamma):\n        _rho, rhou, E = U[0], U[1], U[2]\n        _rho_p, u, p = V[0], V[1], V[2]\n        return np.array([rhou, rhou * u + p, u * (E + p)])\n\n    # --- WENO5 Reconstruction ---\n\n    def weno5_reconstruction(v, N, num_ghosts):\n        g = num_ghosts\n        \n        # Left-biased reconstruction for v_L at N+1 interfaces\n        vm2 = v[g-3 : N+g-2]\n        vm1 = v[g-2 : N+g-1]\n        v0  = v[g-1 : N+g]\n        vp1 = v[g   : N+g+1]\n        vp2 = v[g+1 : N+g+2]\n\n        is0 = (13./12.) * (vm2 - 2*vm1 + v0)**2 + (1./4.) * (vm2 - 4*vm1 + 3*v0)**2\n        is1 = (13./12.) * (vm1 - 2*v0  + vp1)**2 + (1./4.) * (vm1 - vp1)**2\n        is2 = (13./12.) * (v0  - 2*vp1 + vp2)**2 + (1./4.) * (3*v0 - 4*vp1 + vp2)**2\n\n        d0, d1, d2 = 0.1, 0.6, 0.3\n        alpha0 = d0 / (is0 + _TINY)**2\n        alpha1 = d1 / (is1 + _TINY)**2\n        alpha2 = d2 / (is2 + _TINY)**2\n        alpha_sum = alpha0 + alpha1 + alpha2\n\n        w0 = alpha0 / alpha_sum\n        w1 = alpha1 / alpha_sum\n        \n        q0 = (1./3.)*vm2 - (7./6.)*vm1 + (11./6.)*v0\n        q1 = (-1./6.)*vm1 + (5./6.)*v0 + (1./3.)*vp1\n        q2 = (1./3.)*v0 + (5./6.)*vp1 - (1./6.)*vp2\n        \n        v_left = w0*q0 + w1*q1 + (1.0 - w0 - w1)*q2\n\n        # Right-biased reconstruction for v_R\n        vp3 = v[g+2 : N+g+3]\n        \n        is0_r = is1\n        is1_r = is2\n        is2_r = (13./12.) * (vp1 - 2*vp2 + vp3)**2 + (1./4.) * (3*vp1 - 4*vp2 + vp3)**2\n\n        d0_r, d1_r, d2_r = 0.3, 0.6, 0.1\n        alpha0_r = d0_r / (is0_r + _TINY)**2\n        alpha1_r = d1_r / (is1_r + _TINY)**2\n        alpha2_r = d2_r / (is2_r + _TINY)**2\n        alpha_sum_r = alpha0_r + alpha1_r + alpha2_r\n        \n        w0_r = alpha0_r / alpha_sum_r\n        w1_r = alpha1_r / alpha_sum_r\n\n        q0_r = q1\n        q1_r = q2\n        q2_r = (11./6.)*vp1 - (7./6.)*vp2 + (1./3.)*vp3\n        \n        v_right = w0_r*q0_r + w1_r*q1_r + (1.0 - w0_r - w1_r)*q2_r\n        \n        return v_left, v_right\n\n    # --- HLLC Riemann Solver ---\n\n    def hllc_flux(V_L, V_R, gamma):\n        U_L = prim_to_cons(V_L, gamma)\n        U_R = prim_to_cons(V_R, gamma)\n\n        rho_L, u_L, p_L = V_L[0], V_L[1], V_L[2]\n        rho_R, u_R, p_R = V_R[0], V_R[1], V_R[2]\n        \n        E_L, E_R = U_L[2], U_R[2]\n\n        a_L = np.sqrt(gamma * p_L / rho_L)\n        a_R = np.sqrt(gamma * p_R / rho_R)\n\n        rho_sqrt_L, rho_sqrt_R = np.sqrt(rho_L), np.sqrt(rho_R)\n        rho_sqrt_sum = rho_sqrt_L + rho_sqrt_R\n        \n        u_roe = (rho_sqrt_L * u_L + rho_sqrt_R * u_R) / rho_sqrt_sum\n        H_L = (E_L + p_L) / rho_L\n        H_R = (E_R + p_R) / rho_R\n        H_roe = (rho_sqrt_L * H_L + rho_sqrt_R * H_R) / rho_sqrt_sum\n        a_roe_sq = (gamma - 1.0) * (H_roe - 0.5 * u_roe**2)\n        a_roe = np.sqrt(np.maximum(a_roe_sq, _TINY))\n\n        S_L = np.minimum(u_L - a_L, u_roe - a_roe)\n        S_R = np.maximum(u_R + a_R, u_roe + a_roe)\n\n        num = p_R - p_L + rho_L*u_L*(S_L - u_L) - rho_R*u_R*(S_R - u_R)\n        den = rho_L*(S_L - u_L) - rho_R*(S_R - u_R)\n        S_M = num / (den + _TINY)\n\n        F_L = get_flux_from_cons_prim(U_L, V_L, gamma)\n        F_R = get_flux_from_cons_prim(U_R, V_R, gamma)\n\n        U_star_L = np.zeros_like(U_L)\n        den_SL_SM = S_L - S_M\n        U_star_L[0] = rho_L * (S_L - u_L) / (den_SL_SM + _TINY)\n        U_star_L[1] = U_star_L[0] * S_M\n        p_star_term = p_L / (rho_L * (S_L - u_L) + _TINY)\n        U_star_L[2] = U_star_L[0] * (E_L/rho_L + (S_M - u_L) * (S_M + p_star_term))\n        flux_star_L = F_L + S_L[:, np.newaxis].T * (U_star_L - U_L)\n\n        U_star_R = np.zeros_like(U_R)\n        den_SR_SM = S_R - S_M\n        U_star_R[0] = rho_R * (S_R - u_R) / (den_SR_SM + _TINY)\n        U_star_R[1] = U_star_R[0] * S_M\n        p_star_term_R = p_R / (rho_R * (S_R - u_R) + _TINY)\n        U_star_R[2] = U_star_R[0] * (E_R/rho_R + (S_M - u_R) * (S_M + p_star_term_R))\n        flux_star_R = F_R + S_R[:, np.newaxis].T * (U_star_R - U_R)\n        \n        flux = np.where(S_L >= 0, F_L, \n               np.where(S_R <= 0, F_R, \n               np.where(S_M >= 0, flux_star_L, flux_star_R)))\n        \n        return flux\n\n    # --- Test Case Definitions ---\n    test_cases = [\n        {'L': 1.0, 'N': 200, 'gamma': 1.4, 'CFL': 0.4, \n         'ic': {'x_disc': 0.5, 'L': [1.0, 0.75, 1.0], 'R': [0.125, 0.0, 0.1]}},\n        {'L': 1.0, 'N': 64,  'gamma': 1.4, 'CFL': 0.5, \n         'ic': {'uniform': [0.8, -0.2, 0.5]}},\n        {'L': 1.0, 'N': 400, 'gamma': 1.4, 'CFL': 0.2, \n         'ic': {'x_disc': 0.5, 'L': [0.01, 2.0, 0.001], 'R': [1.0, 0.0, 1.0]}}\n    ]\n    \n    final_results = []\n    \n    for case in test_cases:\n        L, N, gamma, CFL = case['L'], case['N'], case['gamma'], case['CFL']\n        dx = L / N\n        num_ghosts = 3\n        g = num_ghosts\n\n        x_centers = (np.arange(N) + 0.5) * dx\n        V_interior = np.zeros((3, N))\n        \n        if 'uniform' in case['ic']:\n            state = case['ic']['uniform']\n            V_interior[0,:] = state[0]\n            V_interior[1,:] = state[1]\n            V_interior[2,:] = state[2]\n        else:\n            x_disc = case['ic']['x_disc']\n            state_L, state_R = case['ic']['L'], case['ic']['R']\n            for i in range(N):\n                if x_centers[i] < x_disc:\n                    V_interior[:, i] = state_L\n                else:\n                    V_interior[:, i] = state_R\n\n        U_interior = prim_to_cons(V_interior, gamma)\n        \n        a_interior = np.sqrt(gamma * V_interior[2,:] / V_interior[0,:])\n        max_speed = np.max(np.abs(V_interior[1,:]) + a_interior)\n        dt = CFL * dx / max_speed\n\n        V_full = np.zeros((3, N + 2 * g))\n        V_full[:, g:N+g] = V_interior\n        V_full[:, :g] = V_interior[:, 0:1]\n        V_full[:, N+g:] = V_interior[:, -1:]\n\n        V_L = np.zeros((3, N + 1))\n        V_R = np.zeros((3, N + 1))\n        for k in range(3):\n            v_l_comp, v_r_comp = weno5_reconstruction(V_full[k, :], N, g)\n            V_L[k, :] = v_l_comp\n            V_R[k, :] = v_r_comp\n\n        V_L[0, :] = np.maximum(V_L[0, :], _RHO_FLOOR)\n        V_L[2, :] = np.maximum(V_L[2, :], _P_FLOOR)\n        V_R[0, :] = np.maximum(V_R[0, :], _RHO_FLOOR)\n        V_R[2, :] = np.maximum(V_R[2, :], _P_FLOOR)\n\n        fluxes = hllc_flux(V_L, V_R, gamma)\n        \n        U_interior_new = U_interior - (dt / dx) * (fluxes[:, 1:] - fluxes[:, :-1])\n\n        M = np.sum(U_interior_new[0, :]) * dx\n        P = np.sum(U_interior_new[1, :]) * dx\n        E_T = np.sum(U_interior_new[2, :]) * dx\n        \n        final_results.extend([M, P, E_T])\n        \n    return f\"[{','.join(map(str, final_results))}]\"\n\n# The answer is the output of the function call\n# print(solve())\n```", "answer": "[0.559375,0.41875,1.5230982142857142,0.8,-0.16,0.925,1.01,2.0,1.501]", "id": "3364352"}]}