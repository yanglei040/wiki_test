{"hands_on_practices": [{"introduction": "The most fundamental solution to a Riemann problem is the shock wave, which arises when characteristics collide. This first exercise guides you through the essential steps of analyzing a shock in the context of the inviscid Burgers' equation. By deriving the Rankine-Hugoniot condition from first principles and verifying the Lax entropy condition, you will build a solid foundation for understanding discontinuous solutions in conservation laws. [@problem_id:3441118]", "problem": "Consider the scalar conservation law for Burgers’ equation,\n$$u_{t} + f(u)_{x} = 0,$$\nwith flux\n$$f(u) = \\frac{u^{2}}{2}.$$\nLet the initial data be a Riemann problem,\n$$u(x,0) = \\begin{cases}\nu_{L}, & x < 0, \\\\\nu_{R}, & x > 0,\n\\end{cases}$$\nwith left state $u_{L} = 2$ and right state $u_{R} = -1$. Starting from the integral form of the conservation law applied across a moving discontinuity at $x = s t$, derive the relationship between the shock speed $s$ and the jumps in the conserved quantity and flux. Use this relationship to compute the shock speed $s$ for the given data. Then, using the characteristic speeds given by $f'(u)$, verify that characteristics impinge upon the shock from both sides, in the sense of the Lax admissibility condition for shocks. Express the final value of the shock speed $s$ as an exact number. No rounding is required, and no physical units are necessary in your answer.", "solution": "The problem statement is valid. It is a well-posed problem in the theory of hyperbolic conservation laws, grounded in established mathematical principles, and contains all necessary information for a unique solution.\n\nWe are given the scalar conservation law, specifically Burgers' equation:\n$$u_{t} + \\left(\\frac{u^{2}}{2}\\right)_{x} = 0$$\nThe problem considers a Riemann initial condition, which is a piecewise constant function with a single discontinuity at $x=0$:\n$$u(x,0) = \\begin{cases}\nu_{L}, & x < 0 \\\\\nu_{R}, & x > 0\n\\end{cases}$$\nwhere the left state is $u_{L} = 2$ and the right state is $u_{R} = -1$.\nSince $u_{L} > u_{R}$, the characteristics will collide, forming a discontinuous solution known as a shock wave. This shock propagates along a line $x = s t$, where $s$ is the constant shock speed.\n\nFirst, we derive the relationship for the shock speed $s$, known as the Rankine-Hugoniot condition. We begin with the integral form of the conservation law over an arbitrary spatial interval $[x_{1}, x_{2}]$:\n$$\\frac{d}{dt} \\int_{x_{1}}^{x_{2}} u(x,t) \\, dx = f(u(x_{1},t)) - f(u(x_{2},t))$$\nLet the interval $[x_{1}, x_{2}]$ be chosen such that it contains the shock position $x = st$ at time $t$. We assume the solution is piecewise constant, taking the value $u_{L}$ to the left of the shock and $u_{R}$ to the right. The integral can be split at the discontinuity:\n$$\\int_{x_{1}}^{x_{2}} u(x,t) \\, dx = \\int_{x_{1}}^{st} u_{L} \\, dx + \\int_{st}^{x_{2}} u_{R} \\, dx = u_{L}(st-x_{1}) + u_{R}(x_{2}-st)$$\nNow, we differentiate this expression with respect to time $t$ using the Leibniz integral rule, noting that $x_1$ and $x_2$ are fixed:\n$$\\frac{d}{dt} \\left[ u_{L}(st-x_{1}) + u_{R}(x_{2}-st) \\right] = u_{L}s - u_{R}s = s(u_{L} - u_{R})$$\nThe right-hand side of the integral conservation law evaluates to $f(u(x_{1},t)) - f(u(x_{2},t))$. Since $x_{1} < st < x_{2}$, we have $u(x_{1},t) = u_{L}$ and $u(x_{2},t) = u_{R}$. Thus, the right-hand side is $f(u_{L}) - f(u_{R})$.\nEquating the two expressions gives the Rankine-Hugoniot jump condition:\n$$s(u_{L} - u_{R}) = f(u_{L}) - f(u_{R})$$\nSolving for the shock speed $s$, we get:\n$$s = \\frac{f(u_{L}) - f(u_{R})}{u_{L} - u_{R}}$$\nThis relation connects the shock speed $s$ to the jump in the conserved quantity, $u_{L} - u_{R}$, and the jump in the flux, $f(u_{L}) - f(u_{R})$.\n\nNext, we use this relationship to compute the shock speed for the given data.\nThe flux function is $f(u) = \\frac{u^{2}}{2}$.\nThe given states are $u_{L} = 2$ and $u_{R} = -1$.\nWe compute the corresponding flux values:\n$$f(u_{L}) = f(2) = \\frac{2^{2}}{2} = \\frac{4}{2} = 2$$\n$$f(u_{R}) = f(-1) = \\frac{(-1)^{2}}{2} = \\frac{1}{2}$$\nNow we substitute these values into the formula for $s$:\n$$s = \\frac{f(u_{L}) - f(u_{R})}{u_{L} - u_{R}} = \\frac{2 - \\frac{1}{2}}{2 - (-1)} = \\frac{\\frac{3}{2}}{3} = \\frac{1}{2}$$\nThe shock speed is $s = \\frac{1}{2}$.\n\nFinally, we must verify that this shock solution is physically admissible by checking the Lax admissibility condition. This condition states that for a shock to be stable, characteristics must enter the shock from both sides. This is equivalent to the inequality:\n$$f'(u_{L}) > s > f'(u_{R})$$\nThe characteristic speed for this conservation law is given by $\\lambda(u) = f'(u)$. For the Burgers' flux $f(u) = \\frac{u^{2}}{2}$, the derivative is:\n$$f'(u) = \\frac{d}{du}\\left(\\frac{u^{2}}{2}\\right) = u$$\nSo, the characteristic speed is simply $\\lambda(u) = u$. The Lax condition becomes:\n$$u_{L} > s > u_{R}$$\nWe substitute the given values and our calculated shock speed:\n$$u_{L} = 2$$\n$$u_{R} = -1$$\n$$s = \\frac{1}{2}$$\nWe check the inequality:\n$$2 > \\frac{1}{2} > -1$$\nThis inequality is true. The characteristic speed on the left, $f'(u_L)=2$, is greater than the shock speed $s=1/2$, meaning characteristics from the left catch up to the shock. The characteristic speed on the right, $f'(u_R)=-1$, is less than the shock speed $s=1/2$, meaning the shock moves faster than the characteristics on the right, overtaking them. Therefore, characteristics impinge upon the shock from both sides, and the solution is an admissible Lax shock. The computed shock speed $s = \\frac{1}{2}$ is correct.", "answer": "$$\\boxed{\\frac{1}{2}}$$", "id": "3441118"}, {"introduction": "While the convex flux of Burgers' equation provides a canonical model, many physical systems are described by nonconvex flux functions, leading to more intricate wave structures. This practice explores such a case, revealing the existence of compound waves that combine shocks and rarefactions. You will investigate how different physical regularizations—vanishing viscosity versus dispersion—can lead to qualitatively different admissible solutions for the same Riemann problem, a key insight in advanced applications. [@problem_id:3441181]", "problem": "Consider the scalar conservation law $u_{t} + f(u)_{x} = 0$ with nonconvex flux $f(u) = u^{3} - u$ and Riemann initial data $u(x,0) = u_{L}$ for $x < 0$ and $u(x,0) = u_{R}$ for $x > 0$, where $u_{L} < 0 < u_{R}$ and $u_{L} < -\\frac{1}{2} u_{R}$. These assumptions ensure a compound-wave structure in the vanishing-viscosity limit.\n\nUnder vanishing-viscosity regularization $u_{t} + f(u)_{x} = \\varepsilon u_{xx}$ with $\\varepsilon \\to 0^{+}$, the admissible Riemann solution consists of a rarefaction from $u_{L}$ to an intermediate state $u_{*}$, followed by a single shock from $u_{*}$ to $u_{R}$. Starting only from the Rankine–Hugoniot jump condition and the requirement that the shock attaches to the rarefaction self-similarly (i.e., the shock speed equals the characteristic speed at $u_{*}$), derive $u_{*}$ and the resulting shock speed $s_{\\mathrm{vv}}$.\n\nUnder Korteweg–de Vries (KdV)–type dispersive regularization $u_{t} + f(u)_{x} = \\mu u_{xxx}$ with $\\mu > 0$ and $\\mu \\to 0^{+}$, the Riemann solution exhibits a dispersive shock wave adjacent to the right state $u_{R}$. Using linearization about the constant state $u = u_{R}$ and the definition of the group velocity, determine the leading-edge speed $s_{+}$ in the zero-dispersion limit.\n\nFinally, compute the signed difference $\\Delta s = s_{\\mathrm{vv}} - s_{+}$ and express your result as a single closed-form analytic expression in terms of $u_{R}$. No rounding is required. Report your final answer as a single expression.", "solution": "The problem is found to be valid as it is scientifically grounded in the theory of hyperbolic conservation laws, well-posed, internally consistent, and objective. We proceed with the solution.\n\nThe scalar conservation law is given by $u_{t} + f(u)_{x} = 0$, with the nonconvex flux function $f(u) = u^{3} - u$. The characteristic speed is $c(u) = f'(u) = 3u^{2} - 1$. The Riemann problem is defined by the initial data $u(x,0) = u_{L}$ for $x < 0$ and $u(x,0) = u_{R}$ for $x > 0$.\n\n### Part 1: Vanishing-Viscosity Solution\n\nWe consider the vanishing-viscosity regularization $u_{t} + f(u)_{x} = \\varepsilon u_{xx}$ for $\\varepsilon \\to 0^{+}$. The problem states that the admissible solution consists of a rarefaction wave from $u_{L}$ to an intermediate state $u_{*}$, followed by a shock from $u_{*}$ to $u_{R}$.\n\nThe speed of the shock, $s$, connecting states $u_{*}$ and $u_{R}$ is determined by the Rankine-Hugoniot jump condition:\n$$s = \\frac{f(u_{R}) - f(u_{*})}{u_{R} - u_{*}}$$\nSubstituting the flux function $f(u) = u^{3} - u$:\n$$s = \\frac{(u_{R}^{3} - u_{R}) - (u_{*}^{3} - u_{*})}{u_{R} - u_{*}} = \\frac{u_{R}^{3} - u_{*}^{3} - (u_{R} - u_{*})}{u_{R} - u_{*}}$$\nUsing the identity $a^{3}-b^{3} = (a-b)(a^{2}+ab+b^{2})$, we simplify this to:\n$$s = u_{R}^{2} + u_{R}u_{*} + u_{*}^{2} - 1$$\nThe problem specifies a compound wave where the shock attaches to the rarefaction. This implies that the shock speed must be equal to the characteristic speed at the intermediate state $u_{*}$. This condition is given by:\n$$s = c(u_{*}) = f'(u_{*}) = 3u_{*}^{2} - 1$$\nEquating the two expressions for the shock speed $s$:\n$$u_{R}^{2} + u_{R}u_{*} + u_{*}^{2} - 1 = 3u_{*}^{2} - 1$$\n$$u_{R}^{2} + u_{R}u_{*} = 2u_{*}^{2}$$\nRearranging the terms gives a quadratic equation for $u_{*}$:\n$$2u_{*}^{2} - u_{R}u_{*} - u_{R}^{2} = 0$$\nWe solve for $u_{*}$ using the quadratic formula, $u_{*} = \\frac{-b \\pm \\sqrt{b^{2}-4ac}}{2a}$, with $a=2$, $b=-u_{R}$, and $c=-u_{R}^{2}$:\n$$u_{*} = \\frac{-(-u_{R}) \\pm \\sqrt{(-u_{R})^{2} - 4(2)(-u_{R}^{2})}}{2(2)} = \\frac{u_{R} \\pm \\sqrt{u_{R}^{2} + 8u_{R}^{2}}}{4} = \\frac{u_{R} \\pm \\sqrt{9u_{R}^{2}}}{4}$$\nSince the problem states $u_{R}>0$, we have $|u_{R}|=u_{R}$.\n$$u_{*} = \\frac{u_{R} \\pm 3u_{R}}{4}$$\nThis yields two possible solutions for $u_{*}$:\n$$u_{*}^{(1)} = \\frac{u_{R} + 3u_{R}}{4} = u_{R}$$\n$$u_{*}^{(2)} = \\frac{u_{R} - 3u_{R}}{4} = -\\frac{1}{2}u_{R}$$\nThe solution $u_{*} = u_{R}$ corresponds to a trivial case with no shock. The physically meaningful intermediate state for the compound wave is $u_{*} = -\\frac{1}{2}u_{R}$. The problem condition $u_L < -\\frac{1}{2}u_R$ ensures that such a rarefaction from $u_L$ to $u_*$ can form ($u_L < u_*$).\n\nThe shock speed for the vanishing-viscosity solution, $s_{\\mathrm{vv}}$, is then given by $f'(u_{*})$:\n$$s_{\\mathrm{vv}} = f'(-\\frac{1}{2}u_{R}) = 3(-\\frac{1}{2}u_{R})^{2} - 1 = 3(\\frac{1}{4}u_{R}^{2}) - 1$$\n$$s_{\\mathrm{vv}} = \\frac{3}{4}u_{R}^{2} - 1$$\n\n### Part 2: Dispersive Solution\n\nNext, we consider the Korteweg-de Vries (KdV)-type regularization $u_{t} + f(u)_{x} = \\mu u_{xxx}$ for $\\mu > 0$. The leading edge of the dispersive shock wave propagates into the undisturbed state $u_{R}$. To find its speed, we linearize the equation around $u = u_{R}$. Let $u(x,t) = u_{R} + \\tilde{u}(x,t)$, where $\\tilde{u}$ is a small perturbation.\nSubstituting this into the equation and keeping only linear terms in $\\tilde{u}$:\n$$(\\tilde{u})_{t} + (f(u_{R}) + f'(u_{R})\\tilde{u})_{x} = \\mu (\\tilde{u})_{xxx}$$\n$$\\tilde{u}_{t} + f'(u_{R})\\tilde{u}_{x} = \\mu \\tilde{u}_{xxx}$$\nWe seek a plane wave solution of the form $\\tilde{u}(x,t) = A\\exp(i(kx - \\omega t))$. Substituting this into the linearized equation yields the dispersion relation:\n$$-i\\omega + ikf'(u_{R}) = \\mu(ik)^{3} = -i\\mu k^{3}$$\n$$\\omega(k) = kf'(u_{R}) + \\mu k^{3}$$\nThe speed of wave packet propagation is given by the group velocity, $c_{g}(k) = \\frac{d\\omega}{dk}$:\n$$c_{g}(k) = \\frac{d}{dk}(kf'(u_{R}) + \\mu k^{3}) = f'(u_{R}) + 3\\mu k^{2}$$\nThe leading edge of the dispersive shock consists of infinitesimal oscillations, corresponding to the long-wavelength limit ($k \\to 0$). The speed of this leading edge, $s_{+}$, is therefore the group velocity evaluated at $k=0$:\n$$s_{+} = \\lim_{k \\to 0} c_{g}(k) = f'(u_{R}) + 3\\mu(0)^{2} = f'(u_{R})$$\nUsing the expression for the characteristic speed $f'(u) = 3u^{2} - 1$:\n$$s_{+} = 3u_{R}^{2} - 1$$\n\n### Part 3: Final Calculation\n\nFinally, we compute the signed difference $\\Delta s = s_{\\mathrm{vv}} - s_{+}$.\n$$\\Delta s = \\left(\\frac{3}{4}u_{R}^{2} - 1\\right) - \\left(3u_{R}^{2} - 1\\right)$$\n$$\\Delta s = \\frac{3}{4}u_{R}^{2} - 3u_{R}^{2} = \\left(\\frac{3}{4} - \\frac{12}{4}\\right)u_{R}^{2}$$\n$$\\Delta s = -\\frac{9}{4}u_{R}^{2}$$\nThe result is a closed-form analytic expression in terms of $u_{R}$, as required.", "answer": "$$\\boxed{-\\frac{9}{4}u_{R}^{2}}$$", "id": "3441181"}, {"introduction": "Analytical solutions to Riemann problems form the bedrock of many advanced numerical methods, such as Godunov-type schemes. This hands-on coding exercise bridges theory and practice by tasking you with implementing and comparing several numerical fluxes, including the widely-used Roe solver. You will discover firsthand how simple linearizations can produce non-physical 'expansion shocks' and learn to implement entropy fixes that restore physical relevance to the numerical solution, a critical aspect of computational fluid dynamics. [@problem_id:3441167]", "problem": "Consider the one-dimensional scalar conservation law $u_t + f(u)_x = 0$ with strictly convex flux $f(u) = \\tfrac{1}{2} u^2$ (inviscid Burgers equation). The classical Riemann problem consists of piecewise constant initial data with left and right states $u(x,0) = u_L$ for $x < 0$ and $u(x,0) = u_R$ for $x > 0$. An approximate Riemann solver of Roe type linearizes the flux and replaces the nonlinear wave by a single discontinuity propagating at a constant characteristic speed across the interface. It is well known that for transonic rarefaction data ($u_L < 0 < u_R$), such a Roe linearization can generate an entropy-violating expansion shock. Entropy fixes modify the dissipation near sonic points to remove these nonphysical artifacts.\n\nStarting from the fundamental definitions of conservation laws, characteristics, and weak solutions, and using the strict convexity of $f(u)$, derive each of the following in a principle-based way:\n\n- The exact interfacial state and corresponding Godunov flux at $x = 0$ for the Riemann problem with data $(u_L,u_R)$, distinguishing shock ($u_L > u_R$) and rarefaction ($u_L < u_R$) and using the Lax entropy condition to resolve the correct physical solution. Your derivation must show why, for rarefaction with $u_L < u_R$, the interfacial state at self-similar coordinate $\\xi = x/t = 0$ equals $u_L$ when $0 < u_L$, equals $u_R$ when $u_R < 0$, and otherwise equals the unique $u^\\star$ satisfying $f'(u^\\star) = 0$ (here $u^\\star = 0$), and must deduce the exact Godunov flux $F_\\text{G}(u_L,u_R) = f(u^\\star)$.\n\n- The Roe-type approximate numerical flux at the interface obtained by linearizing the nonlinear conservation law using a constant Roe characteristic speed derived from the Rankine–Hugoniot condition and the strict convexity of $f(u)$. Explain how this linearization collapses a transonic rarefaction ($u_L < 0 < u_R$) into a single discontinuity with a single speed, and why this can violate entropy by producing an expansion shock. Provide the explicit Roe flux expression as a result of your derivation.\n\n- A Harten–Hyman entropy fix that regularizes the Roe dissipation near sonic points for a single characteristic field by replacing the absolute value of the Roe speed with a quadratic cutoff within an interval determined by the left and right characteristic speeds. For $f(u) = \\tfrac{1}{2}u^2$ with characteristic speed $f'(u) = u$, specify a threshold based on $u_L$ and $u_R$ and show how the modified dissipation eliminates the entropy-violating expansion shock for $u_L < 0 < u_R$.\n\n- A two-wave Harten–Lax–van Leer (HLL) flux with Einfeldt’s wave-speed bounds for a single-field convex flux, using left and right characteristic speeds as signal speeds. Explain how the resulting two-wave approximation is entropy-satisfying and quantify its diffusivity relative to the exact Godunov flux.\n\nThen, implement these fluxes in a single program that:\n\n1. Computes the exact Godunov flux $F_\\text{G}(u_L,u_R)$ at the interface $x=0$ for Burgers flux $f(u)=\\tfrac{1}{2}u^2$.\n2. Computes the Roe flux without entropy fix, the Roe flux with the Harten–Hyman quadratic cutoff entropy fix, and the Harten–Lax–van Leer flux with Einfeldt speeds, all at the same interface for the same data $(u_L,u_R)$.\n3. Quantifies the impact of each entropy fix by returning, for each test case, the absolute discrepancy of the numerical flux from the exact Godunov flux, namely the three values $\\lvert F_\\text{Roe} - F_\\text{G} \\rvert$, $\\lvert F_\\text{Roe+HH} - F_\\text{G} \\rvert$, and $\\lvert F_\\text{HLL(E)} - F_\\text{G} \\rvert$.\n\nUse the following test suite of Riemann data $(u_L,u_R)$, chosen to exercise transonic rarefactions, non-transonic rarefactions, shocks, and boundary cases:\n\n- Case $1$: $u_L = -1.0$, $u_R = 2.0$ (transonic rarefaction).\n- Case $2$: $u_L = -2.0$, $u_R = 0.5$ (transonic rarefaction).\n- Case $3$: $u_L = -0.5$, $u_R = 0.5$ (weak transonic rarefaction).\n- Case $4$: $u_L = 0.0$, $u_R = 3.0$ (rarefaction touching the sonic point on the left).\n- Case $5$: $u_L = -3.0$, $u_R = 0.0$ (rarefaction touching the sonic point on the right).\n- Case $6$: $u_L = 1.0$, $u_R = 3.0$ (non-transonic rarefaction).\n- Case $7$: $u_L = 2.0$, $u_R = -1.0$ (shock).\n\nFor each case, compute the triple of absolute discrepancies $(\\lvert F_\\text{Roe} - F_\\text{G} \\rvert,\\lvert F_\\text{Roe+HH} - F_\\text{G} \\rvert,\\lvert F_\\text{HLL(E)} - F_\\text{G} \\rvert)$ as real numbers.\n\nFinal output format: Your program should produce a single line of output containing the results as a comma-separated list of bracketed triples, one triple per test case, in the exact format\n$[[e_{1,\\text{Roe}},e_{1,\\text{HH}},e_{1,\\text{HLL(E)}}],[e_{2,\\text{Roe}},e_{2,\\text{HH}},e_{2,\\text{HLL(E)}}],\\dots,[e_{7,\\text{Roe}},e_{7,\\text{HH}},e_{7,\\text{HLL(E)}}]]$,\nwhere each $e_{i,\\cdot}$ is a floating-point number. No additional text should be printed.", "solution": "The one-dimensional scalar conservation law is given by $u_t + f(u)_x = 0$, with the strictly convex flux function for the inviscid Burgers' equation being $f(u) = \\frac{1}{2} u^2$. The characteristic speed is $\\lambda(u) = f'(u) = u$. We are considering a Riemann problem with initial data $u(x,0) = u_L$ for $x < 0$ and $u(x,0) = u_R$ for $x > 0$. The solution to this problem is self-similar, depending only on the variable $\\xi = x/t$. The state $u^\\star$ at the interface $\\xi=0$ and the corresponding flux $f(u^\\star)$ determine the Godunov flux.\n\n**1. Exact Godunov Flux, $F_\\text{G}(u_L, u_R)$**\n\nThe Godunov flux is defined as $F_\\text{G}(u_L, u_R) = f(u(\\xi=0))$, where $u(\\xi)$ is the exact, entropy-satisfying solution to the Riemann problem.\n\n**Shock Wave ($u_L > u_R$)**:\nWhen characteristics collide, a discontinuous solution (shock) forms. Its speed, $s$, is determined by the Rankine-Hugoniot condition, which enforces conservation across the discontinuity:\n$$s(u_R - u_L) = f(u_R) - f(u_L)$$\n$$s = \\frac{f(u_R) - f(u_L)}{u_R - u_L} = \\frac{\\frac{1}{2}u_R^2 - \\frac{1}{2}u_L^2}{u_R - u_L} = \\frac{1}{2}(u_L + u_R)$$\nFor a strictly convex flux, the physical admissibility of this shock is governed by the Lax entropy condition, which requires characteristics to enter the shock from both sides: $\\lambda(u_L) > s > \\lambda(u_R)$. For Burgers' equation, this is $u_L > s > u_R$. This condition is satisfied if and only if $u_L > u_R$.\nThe solution is a single jump discontinuity propagating at speed $s$:\n$$u(\\xi) = \\begin{cases} u_L, & \\xi < s \\\\ u_R, & \\xi > s \\end{cases}$$\nThe state at the interface, $u(\\xi=0)$, depends on the sign of $s$. If $s \\ge 0$, the interface $\\xi=0$ is to the left of or on the shock path, so the state is $u_L$. The flux is $F_\\text{G} = f(u_L)$. If $s < 0$, the interface is to the right of the shock, so the state is $u_R$ and the flux is $F_\\text{G} = f(u_R)$. This can be summarized as:\n$$F_\\text{G}(u_L, u_R) = \\begin{cases} f(u_L) & \\text{if } s = \\frac{1}{2}(u_L + u_R) \\ge 0 \\\\ f(u_R) & \\text{if } s < 0 \\end{cases}$$\n\n**Rarefaction Wave ($u_L \\le u_R$)**:\nWhen characteristics spread apart, a continuous, self-similar solution called a rarefaction wave forms. The solution smoothly connects $u_L$ and $u_R$ through all intermediate states $u$ such that $\\lambda(u) = u$ lies between $\\lambda(u_L) = u_L$ and $\\lambda(u_R) = u_R$. The solution is given by:\n$$u(\\xi) = \\begin{cases} u_L, & \\xi < u_L \\\\ \\xi, & u_L \\le \\xi \\le u_R \\\\ u_R, & \\xi > u_R \\end{cases}$$\nThe state at the interface, $u^\\star = u(\\xi=0)$, is determined by the position of $\\xi=0$ relative to the fan $[u_L, u_R]$.\n- If $0 < u_L$, then $\\xi=0$ lies to the left of the fan. The state is $u^\\star = u_L$.\n- If $u_R < 0$, then $\\xi=0$ lies to the right of the fan. The state is $u^\\star = u_R$.\n- If $u_L \\le 0 \\le u_R$, the interface $\\xi=0$ is within the rarefaction fan. The state is $u^\\star=\\xi=0$. This is the sonic point, the state $u^\\star$ satisfying $f'(u^\\star)=u^\\star=0$.\nThe Godunov flux is $F_\\text{G} = f(u^\\star)$. For the case $u_L \\le 0 \\le u_R$, this gives $F_\\text{G} = f(0) = 0$.\nSummarizing for $u_L \\le u_R$:\n$$F_\\text{G}(u_L, u_R) = \\begin{cases} f(u_L) & \\text{if } 0 < u_L \\\\ 0 & \\text{if } u_L \\le 0 \\le u_R \\\\ f(u_R) & \\text{if } u_R < 0 \\end{cases}$$\n\n**2. Roe Approximate Riemann Solver**\n\nThe Roe solver linearizes the nonlinear conservation law $u_t + f(u)_x = 0$ into $u_t + \\tilde{a} u_x=0$ at the interface. The constant coefficient $\\tilde{a} = \\tilde{a}(u_L, u_R)$, known as the Roe-averaged speed, must satisfy the property $f(u_R) - f(u_L) = \\tilde{a} (u_R - u_L)$. For any pair of states $(u_L, u_R)$, this gives:\n$$\\tilde{a} = \\frac{f(u_R) - f(u_L)}{u_R - u_L} = \\frac{1}{2}(u_L + u_R)$$\nThe numerical flux for the resulting linear advection equation is the standard upwind flux, which can be expressed in a characteristic decomposition (or viscosity) form:\n$$F_\\text{Roe}(u_L, u_R) = \\frac{1}{2} \\left[ f(u_L) + f(u_R) \\right] - \\frac{1}{2} |\\tilde{a}| (u_R - u_L)$$\nThis scheme replaces the complex wave structure of the Riemann problem with a single discontinuity propagating at speed $\\tilde{a}$. For shocks ($u_L > u_R$), $\\tilde{a}$ equals the exact shock speed $s$, and the Roe solver is exact.\n\n**Entropy Violation**: Consider a transonic rarefaction, where $u_L < 0 < u_R$. The exact solution is a fan of characteristics spanning negative to positive speeds. The Roe solver collapses this fan into a single discontinuity moving at speed $\\tilde{a} = (u_L+u_R)/2$. If we choose, for example, $u_L = -1$ and $u_R = 2$, then $\\tilde{a} = 0.5$. The characteristics on the left and right are $\\lambda(u_L) = -1$ and $\\lambda(u_R) = 2$. The single discontinuity created by Roe satisfies $\\lambda(u_L) < \\tilde{a} < \\lambda(u_R)$, which is the condition for an expansion shock. Such a solution violates the second law of thermodynamics (entropy condition) and is non-physical. The failure arises because the dissipation term $\\frac{1}{2}|\\tilde{a}|(u_R-u_L)$ becomes too small, or even zero if $u_L = -u_R$, whereas the presence of characteristics moving in opposite directions requires significant numerical dissipation.\n\n**3. Harten-Hyman Entropy Fix**\n\nTo correct the entropy violation, the numerical dissipation must be augmented when a sonic point is crossed. The Harten-Hyman entropy fix modifies the dissipation coefficient $|\\tilde{a}|$ in the Roe flux. The fix is applied when the characteristic speeds on the left and right of the interface span the sonic point, i.e., $\\lambda(u_L) < 0 < \\lambda(u_R)$ for a rarefaction. For Burgers' equation, this is precisely the transonic rarefaction case $u_L < 0 < u_R$.\n\nThe fix replaces $|\\tilde{a}|$ with a regularized version that is strictly positive within a small interval around zero. A quadratic cutoff is specified:\n$$|\\tilde{a}|_{HH} = \\begin{cases} |\\tilde{a}| & \\text{if } |\\tilde{a}| \\ge \\delta \\\\ \\frac{\\tilde{a}^2 + \\delta^2}{2\\delta} & \\text{if } |\\tilde{a}| < \\delta \\end{cases}$$\nThe threshold $\\delta$ is based on the spread of characteristic speeds. For Burgers' equation, with $\\lambda_L=u_L$ and $\\lambda_R=u_R$, a common choice is $\\delta = \\frac{1}{2}(\\lambda_R - \\lambda_L) = \\frac{1}{2}(u_R-u_L)$, assuming $u_L < u_R$. The activation condition $|\\tilde{a}| < \\delta$ for a rarefaction expands to $|\\frac{u_L+u_R}{2}| < \\frac{u_R-u_L}{2}$, which is equivalent to $u_L < 0$ and $u_R > 0$. Therefore, this fix is automatically triggered for all transonic rarefactions.\n\nThe entropy-fixed Roe flux, $F_\\text{Roe+HH}$, is:\n$$F_\\text{Roe+HH} = \\frac{1}{2} \\left[ f(u_L) + f(u_R) \\right] - \\frac{1}{2} |\\tilde{a}|_{mod} (u_R - u_L)$$\nwhere $|\\tilde{a}|_{mod}$ is $|\\tilde{a}|$ outside the transonic rarefaction case, and $|\\tilde{a}|_{HH}$ for the transonic rarefaction case. For Burgers' equation, this particular choice of $\\delta$ and the quadratic correction results in the exact Godunov flux for transonic rarefactions, since the modified dissipation term perfectly cancels the other terms to yield $F_\\text{Roe+HH}=0$, which is $F_\\text{G}$.\n\n**4. Harten-Lax-van Leer (HLL) Flux**\n\nThe HLL solver uses a two-wave model of the Riemann solution, with signal speeds $S_L$ and $S_R$ bounding the physical wave speeds. The solution is assumed to be $u(x/t) = u_L$ for $x/t < S_L$, $u(x/t)=u_R$ for $x/t > S_R$, and a constant intermediate state $u_{HLL}^\\star$ for $S_L < x/t < S_R$. Applying the integral form of the conservation law over the region $[S_L, S_R]$ gives the flux for the intermediate state, which is the HLL flux when $S_L < 0 < S_R$:\n$$F_\\text{HLL}(u_L, u_R) = \\frac{S_R f(u_L) - S_L f(u_R) + S_L S_R (u_R - u_L)}{S_R - S_L}$$\nIf $S_L \\ge 0$, the interface sees only the left state, so $F_\\text{HLL} = f(u_L)$. If $S_R \\le 0$, it sees only the right state, $F_\\text{HLL} = f(u_R)$.\n\nThe Einfeldt wave-speed estimates for a scalar convex problem use the minimum and maximum of the characteristic speeds as the signal speeds. For Burgers' equation, $\\lambda(u)=u$, so:\n$$S_L = \\min(u_L, u_R)$$\n$$S_R = \\max(u_L, u_R)$$\nThis choice ensures $S_L \\le 0 \\le S_R$ in a transonic rarefaction ($u_L < 0 < u_R$), applying the correct formula and preventing entropy violation. The HLL scheme is inherently entropy-satisfying with these wave speeds. However, by collapsing the entire Riemann fan into a single constant state, it introduces more numerical diffusion than the Godunov or entropy-fixed Roe schemes, smearing out contact discontinuities and rarefaction waves. This diffusivity is measured by the discrepancy $|F_\\text{HLL} - F_G|$.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes and compares numerical fluxes for the inviscid Burgers' equation.\n    \"\"\"\n    \n    # Test cases (u_L, u_R)\n    test_cases = [\n        (-1.0, 2.0),  # Case 1: Transonic rarefaction\n        (-2.0, 0.5),  # Case 2: Transonic rarefaction\n        (-0.5, 0.5),  # Case 3: Weak transonic rarefaction\n        (0.0, 3.0),   # Case 4: Rarefaction touching sonic point (left)\n        (-3.0, 0.0),  # Case 5: Rarefaction touching sonic point (right)\n        (1.0, 3.0),   # Case 6: Non-transonic rarefaction\n        (2.0, -1.0),  # Case 7: Shock\n    ]\n\n    results = []\n    \n    # Flux function for Burgers' equation\n    def f(u):\n        return 0.5 * u**2\n\n    def compute_godunov_flux(u_L, u_R):\n        \"\"\"Computes the exact Godunov flux for Burgers' equation.\"\"\"\n        if u_L > u_R:  # Shock wave\n            s = 0.5 * (u_L + u_R)\n            if s >= 0.0:\n                return f(u_L)\n            else:\n                return f(u_R)\n        else:  # Rarefaction wave (or constant state)\n            if u_L > 0.0:\n                return f(u_L)\n            elif u_R < 0.0:\n                return f(u_R)\n            else:  # u_L <= 0 <= u_R (transonic rarefaction)\n                return 0.0 # f(0.0)\n\n    def compute_roe_flux(u_L, u_R):\n        \"\"\"Computes the Roe flux without entropy fix.\"\"\"\n        a_roe = 0.5 * (u_L + u_R)\n        return 0.5 * (f(u_L) + f(u_R)) - 0.5 * abs(a_roe) * (u_R - u_L)\n\n    def compute_roehh_flux(u_L, u_R):\n        \"\"\"Computes the Roe flux with the Harten-Hyman entropy fix.\"\"\"\n        a_roe = 0.5 * (u_L + u_R)\n        diss_coeff = abs(a_roe)\n        \n        # Check for transonic rarefaction: u_L < 0 < u_R\n        if u_L < 0.0 and u_R > 0.0:\n            lambda_L, lambda_R = u_L, u_R\n            delta = 0.5 * (lambda_R - lambda_L)\n            if abs(a_roe) < delta:\n                diss_coeff = (a_roe**2 + delta**2) / (2.0 * delta)\n        \n        return 0.5 * (f(u_L) + f(u_R)) - 0.5 * diss_coeff * (u_R - u_L)\n\n    def compute_hll_flux(u_L, u_R):\n        \"\"\"Computes the HLL flux with Einfeldt-type wave speeds.\"\"\"\n        lambda_L, lambda_R = u_L, u_R\n        \n        # Einfeldt wave speed estimates for scalar convex flux\n        S_L = min(lambda_L, lambda_R)\n        S_R = max(lambda_L, lambda_R)\n\n        if S_L >= 0.0:\n            return f(u_L)\n        elif S_R <= 0.0:\n            return f(u_R)\n        else: # S_L < 0 < S_R\n            f_L, f_R = f(u_L), f(u_R)\n            numerator = S_R * f_L - S_L * f_R + S_L * S_R * (u_R - u_L)\n            denominator = S_R - S_L\n            return numerator / denominator\n\n    for u_L, u_R in test_cases:\n        F_G = compute_godunov_flux(u_L, u_R)\n        F_Roe = compute_roe_flux(u_L, u_R)\n        F_Roe_HH = compute_roehh_flux(u_L, u_R)\n        F_HLL = compute_hll_flux(u_L, u_R)\n\n        e_roe = abs(F_Roe - F_G)\n        e_hh = abs(F_Roe_HH - F_G)\n        e_hll = abs(F_HLL - F_G)\n\n        results.append([e_roe, e_hh, e_hll])\n    \n    # Format the final output string\n    result_str = \"[[\" + \"],[\".join(\",\".join(map(str, triple)) for triple in results) + \"]]\"\n    print(result_str)\n\nsolve()\n```", "id": "3441167"}]}