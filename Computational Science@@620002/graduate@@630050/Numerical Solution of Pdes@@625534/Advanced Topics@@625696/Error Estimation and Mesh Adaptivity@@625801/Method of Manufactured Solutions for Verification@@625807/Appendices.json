{"hands_on_practices": [{"introduction": "Our first exercise establishes the complete workflow for verifying a numerical solver using the Method of Manufactured Solutions [@problem_id:3420668]. We will consider the canonical Poisson equation discretized with a standard finite difference scheme. This practice is foundational, guiding you through predicting convergence rates based on the scheme's consistency and then designing a rigorous numerical experiment to confirm these predictions, including the correct way to measure error and estimate the observed order of accuracy.", "problem": "Consider the Poisson equation $-\\Delta u = f$ on the unit square $\\Omega = [0,1]^2$ with Dirichlet boundary conditions. You intend to verify a finite difference solver using the Method of Manufactured Solutions (MMS): choose a smooth manufactured solution $u \\in C^\\infty(\\overline{\\Omega})$, set $f = -\\Delta u$, and impose the exact Dirichlet boundary data $u|_{\\partial \\Omega}$ on the discrete boundary. The interior operator is the standard second-order central difference $5$-point stencil on a uniform Cartesian grid with spacing $h$ in both spatial directions. Let $u_h$ denote the grid function solving the discrete boundary value problem and regard $u$ evaluated at the grid points as the reference exact solution for error measurement.\n\nFrom first principles, you are to predict the observed convergence orders in the continuum $L^2(\\Omega)$ and $L^\\infty(\\Omega)$ norms for smooth $u$ under this scheme and design a refinement sequence and estimator to measure these orders numerically. Base your reasoning on the following core facts:\n- The Laplacian $\\Delta u = u_{xx} + u_{yy}$ is approximated by the symmetric central difference with a local truncation error that can be quantified by Taylor expansion in terms of $h$ and derivatives of $u$.\n- For smooth data and Dirichlet boundary conditions, the discrete operator associated with the $5$-point Laplacian on a uniform grid is stable in appropriate norms, and consistency plus stability implies convergence.\n- The $L^2(\\Omega)$ norm is defined by $\\|v\\|_{L^2(\\Omega)} = \\left(\\int_\\Omega |v|^2 \\,dx\\right)^{1/2}$, and the $L^\\infty(\\Omega)$ norm by $\\|v\\|_{L^\\infty(\\Omega)} = \\operatorname{ess\\,sup}_{x\\in\\Omega} |v(x)|$. On a uniform grid, consistent discrete approximations to these norms require appropriate quadrature weights.\n\nWhich option correctly states the expected orders and provides a scientifically sound refinement sequence and order estimator for MMS-based verification?\n\nA. The observed orders in both $L^2(\\Omega)$ and $L^\\infty(\\Omega)$ are $2$. Use a refinement sequence that halves the mesh spacing in both directions at each step, i.e., $h_{k+1} = h_k/2$ with $N_{k+1} = 2 N_k$ interior points per direction. Measure discrete $L^2$ error by $E^{(2)}_h = \\left(h^2 \\sum_{i,j} |u_h(x_i,y_j) - u(x_i,y_j)|^2\\right)^{1/2}$ and discrete $L^\\infty$ error by $E^{(\\infty)}_h = \\max_{i,j} |u_h(x_i,y_j) - u(x_i,y_j)|$. Estimate the observed order by $p^{(q)}_k = \\dfrac{\\log\\left(E^{(q)}_{h_k}/E^{(q)}_{h_{k+1}}\\right)}{\\log(2)}$ for $q \\in \\{2,\\infty\\}$.\n\nB. The observed order in $L^2(\\Omega)$ is $2$ but in $L^\\infty(\\Omega)$ it is $1$ due to the maximum norm being dominated by pointwise discretization error. Use the same refinement sequence $h_{k+1}=h_k/2$, $N_{k+1}=2N_k$, and estimate orders by $p^{(q)}_k = \\dfrac{\\log\\left(E^{(q)}_{h_k}/E^{(q)}_{h_{k+1}}\\right)}{\\log(2)}$.\n\nC. The observed orders in both $L^2(\\Omega)$ and $L^\\infty(\\Omega)$ are $2$. To reduce cost, refine only in the $x$-direction so that $h_{x,k+1} = h_{x,k}/2$ while keeping $h_{y,k}$ fixed, and measure order using $p^{(q)}_k = \\dfrac{\\log\\left(E^{(q)}_{h_{x,k}}/E^{(q)}_{h_{x,k+1}}\\right)}{\\log(2)}$.\n\nD. The observed orders in both $L^2(\\Omega)$ and $L^\\infty(\\Omega)$ are $2$. Use an isotropic refinement sequence $h_{k+1} = h_k/2$ and $N_{k+1} = 2 N_k$, but for simplicity define the discrete $L^2$ error without quadrature weights as $E^{(2)}_h = \\left(\\sum_{i,j} |u_h(x_i,y_j) - u(x_i,y_j)|^2\\right)^{1/2}$, and estimate orders by $p^{(2)}_k = \\dfrac{\\log\\left(E^{(2)}_{h_k}/E^{(2)}_{h_{k+1}}\\right)}{\\log(2)}$ and $p^{(\\infty)}_k = \\dfrac{\\log\\left(E^{(\\infty)}_{h_k}/E^{(\\infty)}_{h_{k+1}}\\right)}{\\log(2)}$.\n\nE. The observed order in $L^2(\\Omega)$ is $3$ due to cancellation errors in the symmetric stencil, while in $L^\\infty(\\Omega)$ it is $2$. Use isotropic refinement $h_{k+1}=h_k/2$ and the weighted discrete $L^2$ and $L^\\infty$ errors with the same order estimator as in option A.\n\nSelect the single best option.", "solution": "The user wants me to act as a meticulous STEM professor, validate a problem statement concerning the Method of Manufactured Solutions (MMS), and then derive the correct answer and evaluate the given options.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n- **Equation:** Poisson equation, $-\\Delta u = f$.\n- **Domain:** Unit square, $\\Omega = [0,1]^2$.\n- **Boundary Conditions:** Dirichlet boundary conditions.\n- **Verification Method:** Method of Manufactured Solutions (MMS).\n- **Manufactured Solution:** A chosen smooth function, $u \\in C^\\infty(\\overline{\\Omega})$.\n- **Source Term:** Derived from the manufactured solution, $f = -\\Delta u$.\n- **Boundary Data:** Exact Dirichlet data, $u|_{\\partial \\Omega}$, is imposed on the discrete boundary.\n- **Discretization:** Standard second-order central difference $5$-point stencil for the Laplacian on a uniform Cartesian grid.\n- **Grid Spacing:** $h$ in both spatial directions.\n- **Definitions:** $u_h$ is the discrete solution. The exact solution for error measurement is $u$ evaluated at grid points.\n- **Provided Principles:**\n    1. The Laplacian $\\Delta u = u_{xx} + u_{yy}$ is approximated by a symmetric central difference, with local truncation error determined by Taylor expansion.\n    2. The discrete operator is stable for smooth data and Dirichlet boundary conditions.\n    3. Consistency + Stability implies Convergence.\n    4. Continuum norms are defined: $\\|v\\|_{L^2(\\Omega)} = \\left(\\int_\\Omega |v|^2 \\,dx\\right)^{1/2}$ and $\\|v\\|_{L^\\infty(\\Omega)} = \\operatorname{ess\\,sup}_{x\\in\\Omega} |v(x)|$.\n    5. Discrete norm approximations must use appropriate quadrature weights.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem statement describes a standard, canonical procedure for code verification in numerical analysis.\n- **Scientifically Grounded:** The problem is firmly rooted in the fundamental theory of numerical solutions for partial differential equations. The Poisson equation, finite difference methods, the 5-point stencil, and the principles of consistency, stability, and convergence are all core, well-established concepts. The Method of Manufactured Solutions is a widely accepted and practiced technique for software verification.\n- **Well-Posed:** The problem is well-posed. It asks for the prediction of convergence orders and the design of a numerical experiment to measure them, both of which have a unique and correct answer based on established theory.\n- **Objective:** The language is formal, precise, and free of any subjective or ambiguous terminology.\n\n**Flaw Checklist:**\n1.  **Scientific or Factual Unsoundness:** None.\n2.  **Non-Formalizable or Irrelevant:** None. The problem is perfectly formalizable within numerical analysis and directly relevant to the stated topic.\n3.  **Incomplete or Contradictory Setup:** None. All necessary information is provided.\n4.  **Unrealistic or Infeasible:** None. The procedure described is standard practice in computational science.\n5.  **Ill-Posed or Poorly Structured:** None.\n6.  **Pseudo-Profound, Trivial, or Tautological:** None. The problem requires a solid understanding of a non-trivial but fundamental topic.\n7.  **Outside Scientific Verifiability:** None.\n\n**Step 3: Verdict and Action**\nThe problem statement is valid. I will proceed with the solution derivation.\n\n### Solution Derivation\n\nThe problem requires predicting the convergence orders for a finite difference solution to the Poisson equation and specifying the correct numerical procedure to verify these orders.\n\n**1. Local Truncation Error (LTE)**\nThe discrete operator is the $5$-point stencil approximation of the Laplacian, $\\Delta_h$, applied to a grid function $v_{i,j} = v(x_i, y_j)$:\n$$ \\Delta_h v_{i,j} = \\frac{v_{i+1,j} - 2v_{i,j} + v_{i-1,j}}{h^2} + \\frac{v_{i,j+1} - 2v_{i,j} + v_{i,j-1}}{h^2} $$\nThe local truncation error, $\\tau$, is found by applying this operator to the exact, smooth solution $u(x,y)$. Using Taylor series expansion for $u \\in C^\\infty(\\overline{\\Omega})$ around a point $(x_i, y_j)$:\n$$ u(x_i \\pm h, y_j) = u \\pm h u_x + \\frac{h^2}{2!} u_{xx} \\pm \\frac{h^3}{3!} u_{xxx} + \\frac{h^4}{4!} u_{xxxx} + O(h^5) $$\n$$ u(x_i, y_j \\pm h) = u \\pm h u_y + \\frac{h^2}{2!} u_{yy} \\pm \\frac{h^3}{3!} u_{yyy} + \\frac{h^4}{4!} u_{yyyy} + O(h^5) $$\nThe standard central difference approximation for the second derivative in $x$ is:\n$$ \\frac{u_{i+1,j} - 2u_{i,j} + u_{i-1,j}}{h^2} = \\frac{\\partial^2 u}{\\partial x^2} + \\frac{h^2}{12}\\frac{\\partial^4 u}{\\partial x^4} + O(h^4) $$\nAnd similarly for the $y$ direction. Summing these gives the LTE for the Laplacian:\n$$ \\Delta_h u_{i,j} = \\left(\\frac{\\partial^2 u}{\\partial x^2} + \\frac{\\partial^2 u}{\\partial y^2}\\right) + \\frac{h^2}{12}\\left(\\frac{\\partial^4 u}{\\partial x^4} + \\frac{\\partial^4 u}{\\partial y^4}\\right) + O(h^4) $$\nThe LTE is defined as $\\tau_{i,j} = \\Delta_h u_{i,j} - \\Delta u_{i,j}$. Thus:\n$$ \\tau_{i,j} = \\frac{h^2}{12}\\left(\\frac{\\partial^4 u}{\\partial x^4} + \\frac{\\partial^4 u}{\\partial y^4}\\right)_{i,j} + O(h^4) $$\nSince $u \\in C^\\infty$, its fourth derivatives are bounded. Therefore, the local truncation error is of order $2$, i.e., $\\tau = O(h^2)$. This means the scheme is second-order consistent.\n\n**2. Global Error and Convergence Order**\nThe problem states that the scheme is stable. For a linear, stable scheme, the order of convergence of the global error, $e_h = u_h - u$, is the same as the order of the local truncation error. This fundamental result of numerical analysis implies that the global error will be second-order. This holds true for both the discrete $L^2$ and $L^\\infty$ norms for this particular problem (elliptic equation, smooth solution, stable scheme).\n$$ \\|e_h\\|_{L^\\infty} = \\max_{i,j} |u_h(x_i, y_j) - u(x_i, y_j)| = O(h^2) $$\n$$ \\|e_h\\|_{L^2} = \\left(\\int_\\Omega |u_h - u|^2 \\,dx\\,dy\\right)^{1/2} = O(h^2) $$\nTherefore, the expected order of convergence is $p=2$ in both norms.\n\n**3. Numerical Verification Procedure**\nTo numerically verify the convergence order $p$, we assume the error $E(h)$ satisfies $E(h) \\approx C h^p$ for small $h$.\n- **Refinement Sequence:** A standard method is to generate solutions on a sequence of successively refined meshes. Isotropic refinement, where the mesh spacing is halved in all directions, is standard. Let $h_{k+1} = h_k/r$ where $r$ is the refinement factor. A common choice is $r=2$, so $h_{k+1} = h_k/2$.\n- **Discrete Norms:**\n    - The discrete $L^\\infty$ norm is simply the maximum of the absolute error over all interior grid points: $E^{(\\infty)}_h = \\max_{i,j} |e_h(x_i, y_j)|$.\n    - The discrete $L^2$ norm must approximate the continuum integral $\\int_\\Omega e_h^2 \\,dx\\,dy$. Using a simple rectangular quadrature rule where each grid point $(x_i, y_j)$ represents a cell of area $h^2$, the approximation is $\\sum_{i,j} |e_h(x_i, y_j)|^2 h^2$. The discrete norm is the square root: $E^{(2)}_h = \\left(h^2 \\sum_{i,j} |e_h(x_i, y_j)|^2\\right)^{1/2}$. The weighting factor $h^2$ is essential for the discrete norm to be a consistent approximation of the continuum norm.\n- **Order Estimation:** Given two error measurements $E_k = E(h_k)$ and $E_{k+1} = E(h_{k+1})$:\n  $$ \\frac{E_k}{E_{k+1}} \\approx \\frac{C h_k^p}{C h_{k+1}^p} = \\left(\\frac{h_k}{h_{k+1}}\\right)^p = r^p $$\n  Taking the logarithm and solving for $p$ gives the estimated order: $p_k = \\frac{\\log(E_k/E_{k+1})}{\\log(r)}$. For a refinement factor of $r=2$, this becomes $p_k = \\frac{\\log(E_k/E_{k+1})}{\\log(2)}$.\n\n### Option-by-Option Analysis\n\n**A. The observed orders in both $L^2(\\Omega)$ and $L^\\infty(\\Omega)$ are $2$. Use a refinement sequence that halves the mesh spacing in both directions at each step, i.e., $h_{k+1} = h_k/2$ with $N_{k+1} = 2 N_k$ interior points per direction. Measure discrete $L^2$ error by $E^{(2)}_h = \\left(h^2 \\sum_{i,j} |u_h(x_i,y_j) - u(x_i,y_j)|^2\\right)^{1/2}$ and discrete $L^\\infty$ error by $E^{(\\infty)}_h = \\max_{i,j} |u_h(x_i,y_j) - u(x_i,y_j)|$. Estimate the observed order by $p^{(q)}_k = \\dfrac{\\log\\left(E^{(q)}_{h_k}/E^{(q)}_{h_{k+1}}\\right)}{\\log(2)}$ for $q \\in \\{2,\\infty\\}$.**\nThis option correctly states that the expected order is $2$ for both norms. It proposes the standard isotropic refinement sequence ($h_{k+1}=h_k/2$). It defines the discrete $L^\\infty$ and $L^2$ norms correctly, crucially including the $h^2$ quadrature weight in the $L^2$ norm. The formula for the order estimator is also correct for a refinement factor of $2$. The statement about $N_{k+1} = 2 N_k$ points per direction is a correct description of doubling the resolution.\nVerdict: **Correct**.\n\n**B. The observed order in $L^2(\\Omega)$ is $2$ but in $L^\\infty(\\Omega)$ it is $1$ due to the maximum norm being dominated by pointwise discretization error. ...**\nThis option is incorrect. For a stable, second-order consistent scheme applied to a smooth problem, the convergence in the $L^\\infty$ norm is also second-order. The reasoning provided is specious.\nVerdict: **Incorrect**.\n\n**C. The observed orders in both $L^2(\\Omega)$ and $L^\\infty(\\Omega)$ are $2$. To reduce cost, refine only in the $x$-direction so that $h_{x,k+1} = h_{x,k}/2$ while keeping $h_{y,k}$ fixed, ...**\nThis option is incorrect. While the underlying method is second-order, the proposed anisotropic refinement strategy is unsuitable for verifying the overall convergence order. If $h_y$ is held constant, the total error $E \\approx C_x h_x^2 + C_y h_y^2$ will be dominated by the constant term $C_y h_y^2$ as $h_x \\to 0$. The measured convergence rate with respect to $h_x$ would thus asymptote to $0$, not $2$.\nVerdict: **Incorrect**.\n\n**D. The observed orders in both $L^2(\\Omega)$ and $L^\\infty(\\Omega)$ are $2$. ... but for simplicity define the discrete $L^2$ error without quadrature weights as $E^{(2)}_h = \\left(\\sum_{i,j} |u_h(x_i,y_j) - u(x_i,y_j)|^2\\right)^{1/2}$, ...**\nThis option is incorrect. The definition of the discrete $L^2$ error is flawed. This unweighted sum is the vector $\\ell^2$-norm, not a consistent approximation of the function $L^2$-norm. As shown in the derivation, this norm would scale as $E^{(2)}_h = O(h)$, leading to a measured convergence order of $1$, not $2$.\nVerdict: **Incorrect**.\n\n**E. The observed order in $L^2(\\Omega)$ is $3$ due to cancellation errors in the symmetric stencil, while in $L^\\infty(\\Omega)$ it is $2$. ...**\nThis option is incorrect. The assertion of a third-order convergence in $L^2$ is false for the standard $5$-point stencil and a general smooth solution. The local truncation error is rigorously $O(h^2)$, which dictates the global convergence order for this stable scheme. The term \"cancellation errors\" is misapplied; symmetry leads to cancellation of odd-order error terms, resulting in $O(h^2)$ error, not super-convergence.\nVerdict: **Incorrect**.\n\nBased on the detailed analysis, only option A provides a completely correct statement of the expected orders and a scientifically sound verification procedure.", "answer": "$$\\boxed{A}$$", "id": "3420668"}, {"introduction": "Building on the fundamentals of verification, this practice shifts our focus to the widely-used Finite Element Method (FEM) [@problem_id:3420688]. Unlike finite differences, FEM analysis is grounded in the language of Sobolev spaces, leading to distinct convergence behaviors in different norms. This exercise challenges you to apply MMS to a standard FEM scheme, requiring you to recall the optimal error estimates in the energy ($H^1$) and $L^2$ norms and to consider practical ways of computing the error.", "problem": "Consider the second-order elliptic Partial Differential Equation (PDE)\n$$\n-\\nabla\\cdot\\left(\\kappa\\nabla u\\right)=f\\quad\\text{in }\\Omega,\\qquad u=g\\quad\\text{on }\\partial\\Omega,\n$$\non the convex polygonal domain $\\Omega=(0,1)^2$, with a constant scalar diffusion coefficient $\\kappa\\equiv 1$. You will perform verification by the Method of Manufactured Solutions (MMS), which consists of prescribing a smooth exact solution $u$ and then defining the forcing term $f$ and Dirichlet boundary data $g$ accordingly so that the prescribed $u$ satisfies the PDE and boundary conditions. Let the manufactured solution be\n$$\nu(x,y)=\\mathrm{e}^{x+y}\\sin(\\pi x)\\sin(\\pi y).\n$$\nYou discretize the problem by the conforming Finite Element Method (FEM) using a shape-regular, quasi-uniform family of triangulations with meshsize $h$, and a standard $H^1$-conforming Lagrange space of polynomial degree $p\\in\\mathbb{N}$, $p\\ge 1$. Assume $\\Omega$ is convex so that the dual problem for Aubin–Nitsche analysis has $H^2$-regularity, and assume the manufactured $u$ belongs to $H^{p+1}(\\Omega)$.\n\nYou wish to (i) formulate the expected convergence rates in the $H^1$-seminorm and the Lebesgue $L^2$-norm of the error, and (ii) describe practical, computable procedures to evaluate the discrete error using either the nodal interpolation operator or an $L^2$-orthogonal projection of $u$ onto the finite element space.\n\nSelect the option that correctly states both the asymptotic rates and a valid, computable error evaluation approach under the stated assumptions.\n\nA. For $u\\in H^{p+1}(\\Omega)$ and $H^1$-conforming FEM of degree $p$, the errors satisfy\n$$\n\\|\\nabla(u-u_h)\\|_{L^2(\\Omega)}=\\mathcal{O}(h^p),\\qquad \\|u-u_h\\|_{L^2(\\Omega)}=\\mathcal{O}(h^{p+1}).\n$$\nIn practice, one may compute the norms directly by high-order quadrature of $u-u_h$. Alternatively, one may form the nodal interpolant $I_h u\\in V_h$ and the $L^2$-projection $P_h u\\in V_h$ (via the mass matrix) and compute the proxies $\\|\\nabla(I_h u-u_h)\\|_{L^2(\\Omega)}$ and $\\|P_h u-u_h\\|_{L^2(\\Omega)}$, which are fully computable in the discrete space and exhibit the same asymptotic rates as the true errors.\n\nB. For $u\\in H^{p+1}(\\Omega)$ and $H^1$-conforming FEM of degree $p$, the errors satisfy\n$$\n\\|\\nabla(u-u_h)\\|_{L^2(\\Omega)}=\\mathcal{O}(h^{p+1}),\\qquad \\|u-u_h\\|_{L^2(\\Omega)}=\\mathcal{O}(h^{p+2}).\n$$\nThe discrete $L^2$-error can be computed exactly by replacing $u$ with its nodal interpolant $I_h u$ and evaluating $\\|I_h u-u_h\\|_{L^2(\\Omega)}$, which equals $\\|u-u_h\\|_{L^2(\\Omega)}$ on any mesh.\n\nC. For $u\\in H^{p+1}(\\Omega)$ and $H^1$-conforming FEM of degree $p$, the $H^1$-error satisfies $\\|\\nabla(u-u_h)\\|_{L^2(\\Omega)}=\\mathcal{O}(h^p)$ but the $L^2$-error cannot exceed $\\mathcal{O}(h^p)$ unless $u\\in H^{p+2}(\\Omega)$. Computing the $L^2$-error by an $L^2$-projection $P_h u$ does not change this limitation.\n\nD. The nodal maximum error $\\max_{\\text{nodes}}|u-u_h|$ is a reliable proxy that is equivalent to the $H^1$-seminorm of the error on quasi-uniform meshes, and thus its rate is $\\mathcal{O}(h^{p+1})$ for degree $p$ elements.", "solution": "The problem asks for the expected convergence rates of the Finite Element Method (FEM) for a second-order elliptic PDE and for a description of practical methods to compute the error, particularly in the context of the Method of Manufactured Solutions (MMS).\n\n### Problem Statement Validation\n\nThe problem statement is valid.\n1.  **Givens:**\n    - PDE: $-\\nabla\\cdot\\left(\\kappa\\nabla u\\right)=f$ in $\\Omega=(0,1)^2$.\n    - Boundary Condition: $u=g$ on $\\partial\\Omega$.\n    - Coefficient: $\\kappa\\equiv 1$.\n    - Domain: $\\Omega=(0,1)^2$ is a convex polygon.\n    - Manufactured Solution: $u(x,y)=\\mathrm{e}^{x+y}\\sin(\\pi x)\\sin(\\pi y)$.\n    - Numerical Method: Conforming FEM with shape-regular, quasi-uniform triangulations of meshsize $h$, using degree $p\\ge 1$ Lagrange elements.\n    - Assumptions: Dual problem has $H^2$-regularity; manufactured solution $u \\in H^{p+1}(\\Omega)$.\n2.  **Validation:**\n    - The problem is **scientifically grounded**. It describes the standard Poisson equation and its numerical solution via FEM, a fundamental topic in numerical analysis. The Method of Manufactured Solutions is a standard verification technique.\n    - The problem is **well-posed**. The assumptions on the domain, solution regularity ($u$ is $C^\\infty$, so it is in any Sobolev space $H^k(\\Omega)$), and dual problem regularity are standard in FEM theory and guarantee a unique solution with well-defined convergence properties.\n    - The problem is **objective and complete**. All necessary information is provided, and the terminology is standard within the field of numerical PDEs. There are no contradictions or ambiguities.\n\nThe problem statement is valid, so we proceed with the solution.\n\n### Derivation of Theoretical Convergence Rates\n\nLet $u_h \\in V_h$ be the finite element solution, where $V_h$ is the space of continuous piecewise polynomials of degree $p$. The error is $e = u - u_h$.\n\n**1. Error in the $H^1$-seminorm, $\\|\\nabla(u-u_h)\\|_{L^2(\\Omega)}$**\n\nThe fundamental error estimate for this class of elliptic problems is given by Céa's Lemma, which states that the FEM solution is quasi-optimal in the energy norm. For the PDE $-\\Delta u = f$, the energy norm is equivalent to the $H^1$-seminorm, $\\|\\cdot\\|_{H^1_0(\\Omega)}$. The lemma states:\n$$\n\\|\\nabla(u-u_h)\\|_{L^2(\\Omega)} \\le C \\inf_{v_h \\in V_h} \\|\\nabla(u-v_h)\\|_{L^2(\\Omega)}\n$$\nwhere $C$ is a constant independent of the meshsize $h$. The term on the right is the best approximation error in the $H^1$-seminorm. This error can be bounded by the error of a specific choice of $v_h$, such as the nodal interpolant $I_h u \\in V_h$.\n$$\n\\inf_{v_h \\in V_h} \\|\\nabla(u-v_h)\\|_{L^2(\\Omega)} \\le \\|\\nabla(u - I_h u)\\|_{L^2(\\Omega)}\n$$\nStandard interpolation theory for Lagrange elements of degree $p$ on a shape-regular, quasi-uniform mesh family provides the estimate:\n$$\n\\|\\nabla(u - I_h u)\\|_{L^2(\\Omega)} \\le C_1 h^k \\|u\\|_{H^{k+1}(\\Omega)}\n$$\nfor a function $u \\in H^{k+1}(\\Omega)$. The problem assumes $u \\in H^{p+1}(\\Omega)$, so we can take $k=p$. Combining these results, we get:\n$$\n\\|\\nabla(u-u_h)\\|_{L^2(\\Omega)} \\le C \\cdot (C_1 h^p \\|u\\|_{H^{p+1}(\\Omega)}) = \\mathcal{O}(h^p)\n$$\nThus, the expected convergence rate for the error in the $H^1$-seminorm is $\\mathcal{O}(h^p)$.\n\n**2. Error in the $L^2$-norm, $\\|u-u_h\\|_{L^2(\\Omega)}$**\n\nTo obtain the $L^2$-error estimate, we use the Aubin–Nitsche duality argument. This requires regularity of an associated dual problem. The problem statement explicitly assumes the necessary $H^2$-regularity on the convex domain $\\Omega$, which is a standard result for the Laplacian. Let $\\phi$ be the solution to the dual problem $-\\Delta \\phi = e = u-u_h$ in $\\Omega$, with $\\phi = 0$ on $\\partial\\Omega$. The $H^2$-regularity assumption implies $\\|\\phi\\|_{H^2(\\Omega)} \\le C_{reg} \\|e\\|_{L^2(\\Omega)}$.\n\nThe derivation proceeds as:\n$$\n\\|u-u_h\\|_{L^2(\\Omega)}^2 = \\int_\\Omega e^2 \\,d\\mathbf{x} = \\int_\\Omega e(-\\Delta\\phi)\\,d\\mathbf{x}\n$$\nIntegrating by parts and using Galerkin orthogonality ($\\int_\\Omega \\nabla(u-u_h)\\cdot\\nabla v_h\\,d\\mathbf{x}=0$ for all test functions $v_h$ in the appropriate space) gives:\n$$\n\\|u-u_h\\|_{L^2(\\Omega)}^2 = \\int_\\Omega \\nabla e \\cdot \\nabla \\phi \\,d\\mathbf{x} = \\int_\\Omega \\nabla(u-u_h) \\cdot \\nabla(\\phi-v_h) \\,d\\mathbf{x}\n$$\nfor any $v_h$ from the test space. Using the Cauchy-Schwarz inequality:\n$$\n\\|u-u_h\\|_{L^2(\\Omega)}^2 \\le \\|\\nabla(u-u_h)\\|_{L^2(\\Omega)} \\|\\nabla(\\phi-v_h)\\|_{L^2(\\Omega)}\n$$\nChoosing $v_h$ as the interpolant of $\\phi$, $I_h\\phi$, and using the interpolation estimate for the gradient with $p=1$ (since we only know $\\phi \\in H^2(\\Omega)$): $\\|\\nabla(\\phi - I_h\\phi)\\|_{L^2(\\Omega)} \\le C_2 h \\|\\phi\\|_{H^2(\\Omega)}$.\nSubstituting this and the regularity estimate for $\\phi$:\n$$\n\\|u-u_h\\|_{L^2(\\Omega)}^2 \\le \\|\\nabla(u-u_h)\\|_{L^2(\\Omega)} (C_2 h \\|\\phi\\|_{H^2(\\Omega)}) \\le \\|\\nabla(u-u_h)\\|_{L^2(\\Omega)} (C_2 h C_{reg} \\|u-u_h\\|_{L^2(\\Omega)})\n$$\nDividing by $\\|u-u_h\\|_{L^2(\\Omega)}$ (for a non-zero error) yields:\n$$\n\\|u-u_h\\|_{L^2(\\Omega)} \\le C_2 C_{reg} h \\|\\nabla(u-u_h)\\|_{L^2(\\Omega)}\n$$\nFinally, substituting the $H^1$-seminorm error rate we derived, $\\|\\nabla(u-u_h)\\|_{L^2(\\Omega)} = \\mathcal{O}(h^p)$:\n$$\n\\|u-u_h\\|_{L^2(\\Omega)} \\le (C_{const} h) \\cdot \\mathcal{O}(h^p) = \\mathcal{O}(h^{p+1})\n$$\nThus, the expected convergence rate for the error in the $L^2$-norm is $\\mathcal{O}(h^{p+1})$.\n\n### Practical Error Evaluation in MMS\n\nIn MMS, one computes the error norms $\\|u-u_h\\|_{L^2(\\Omega)}$ and $\\|\\nabla(u-u_h)\\|_{L^2(\\Omega)}$ for a sequence of refined meshes to verify that the observed convergence rate matches the theory.\nSince $u$ is a known analytical function (not a polynomial) and $u_h$ is a piecewise polynomial, the integrands $(u-u_h)^2$ and $|\\nabla(u-u_h)|^2$ are not typically polynomials. Therefore, the integrals must be computed using numerical quadrature. To ensure the quadrature error does not pollute the discretization error measurement, a quadrature rule of sufficiently high order must be used.\n\nAn alternative approach, which avoids evaluating the transcendental function $u$ at many quadrature points, is to use a proxy for the error that lives entirely in the finite element space. Two common choices are:\n1.  **Nodal Interpolant, $I_h u$**: $I_h u$ is the function in $V_h$ that matches $u$ at all nodal points. We can compute $\\|I_h u - u_h\\|_{L^2(\\Omega)}$ and $\\|\\nabla(I_h u - u_h)\\|_{L^2(\\Omega)}$.\n2.  **$L^2$-Projection, $P_h u$**: $P_h u$ is the function in $V_h$ that is the best approximation to $u$ in the $L^2$-norm. It requires solving a linear system involving the mass matrix.\n\nBy the triangle inequality and standard interpolation estimates, these proxies can be shown to have the same asymptotic convergence rates as the true errors. For instance:\n$$\n\\|u-u_h\\|_{L^2} \\le \\|u-I_h u\\|_{L^2} + \\|I_h u-u_h\\|_{L^2}\n$$\nand\n$$\n\\|I_h u-u_h\\|_{L^2} \\le \\|I_h u-u\\|_{L^2} + \\|u-u_h\\|_{L^2}\n$$\nSince $\\|u-I_h u\\|_{L^2} = \\mathcal{O}(h^{p+1})$ and $\\|u-u_h\\|_{L^2} = \\mathcal{O}(h^{p+1})$, it follows that $\\|I_h u-u_h\\|_{L^2} = \\mathcal{O}(h^{p+1})$. A similar argument holds for the $H^1$-seminorm, showing $\\|\\nabla(I_h u-u_h)\\|_{L^2} = \\mathcal{O}(h^p)$. The integrals for these proxy errors involve only piecewise polynomials and can be computed exactly (up to machine precision) with an appropriate quadrature rule.\n\n### Evaluation of Options\n\n**A. For $u\\in H^{p+1}(\\Omega)$ and $H^1$-conforming FEM of degree $p$, the errors satisfy $\\|\\nabla(u-u_h)\\|_{L^2(\\Omega)}=\\mathcal{O}(h^p),\\qquad \\|u-u_h\\|_{L^2(\\Omega)}=\\mathcal{O}(h^{p+1}).$ [...] In practice, one may compute the norms directly by high-order quadrature of $u-u_h$. Alternatively, one may form the nodal interpolant $I_h u\\in V_h$ and the $L^2$-projection $P_h u\\in V_h$ (via the mass matrix) and compute the proxies $\\|\\nabla(I_h u-u_h)\\|_{L^2(\\Omega)}$ and $\\|P_h u-u_h\\|_{L^2(\\Omega)}$, which are fully computable in the discrete space and exhibit the same asymptotic rates as the true errors.**\n\nThis option correctly states the theoretical convergence rates, $\\|\\nabla(u-u_h)\\|_{L^2(\\Omega)}=\\mathcal{O}(h^p)$ and $\\|u-u_h\\|_{L^2(\\Omega)}=\\mathcal{O}(h^{p+1})$, which match our derivation. It also correctly describes two valid practical procedures for error evaluation: high-order quadrature of the true error, or computation of norms of discrete proxies ($I_h u - u_h$ or $P_h u - u_h$), correctly stating that these proxies exhibit the same asymptotic rates.\n**Verdict: Correct.**\n\n**B. For $u\\in H^{p+1}(\\Omega)$ and $H^1$-conforming FEM of degree $p$, the errors satisfy $\\|\\nabla(u-u_h)\\|_{L^2(\\Omega)}=\\mathcal{O}(h^{p+1}),\\qquad \\|u-u_h\\|_{L^2(\\Omega)}=\\mathcal{O}(h^{p+2}).$ [...]**\n\nThis option states incorrect convergence rates. The rate in the $H^1$-seminorm is $\\mathcal{O}(h^p)$, not $\\mathcal{O}(h^{p+1})$. The rates given would be expected if the solution had higher regularity, i.e., $u \\in H^{p+2}(\\Omega)$. The claim that $\\|I_h u-u_h\\|_{L^2(\\Omega)}$ *equals* $\\|u-u_h\\|_{L^2(\\Omega)}$ is also false.\n**Verdict: Incorrect.**\n\n**C. For $u\\in H^{p+1}(\\Omega)$ and $H^1$-conforming FEM of degree $p$, the $H^1$-error satisfies $\\|\\nabla(u-u_h)\\|_{L^2(\\Omega)}=\\mathcal{O}(h^p)$ but the $L^2$-error cannot exceed $\\mathcal{O}(h^p)$ unless $u\\in H^{p+2}(\\Omega)$. [...]**\n\nThis option incorrectly states the $L^2$-error rate. The Aubin-Nitsche argument provides the additional power of $h$, yielding an $\\mathcal{O}(h^{p+1})$ rate for the $L^2$-error, given that $u \\in H^{p+1}(\\Omega)$ and the dual problem has $H^2$-regularity. Increased solution regularity to $u \\in H^{p+2}(\\Omega)$ would be required to achieve an $\\mathcal{O}(h^{p+2})$ rate, but not just to improve from $\\mathcal{O}(h^p)$.\n**Verdict: Incorrect.**\n\n**D. The nodal maximum error $\\max_{\\text{nodes}}|u-u_h|$ is a reliable proxy that is equivalent to the $H^1$-seminorm of the error on quasi-uniform meshes, and thus its rate is $\\mathcal{O}(h^{p+1})$ for degree $p$ elements.**\n\nThis option is fundamentally flawed. The nodal maximum error is a pointwise quantity, which is not equivalent to the $H^1$-seminorm, an integral quantity over the domain. Furthermore, it misstates the convergence rate of the $H^1$-seminorm, which is $\\mathcal{O}(h^p)$, not $\\mathcal{O}(h^{p+1})$. The nodal error may be related to the $L^\\infty$ norm of the error, but not the $H^1$-seminorm.\n**Verdict: Incorrect.**", "answer": "$$\\boxed{A}$$", "id": "3420688"}, {"introduction": "This final, advanced exercise probes a critical aspect of code verification: the impact of the solution's smoothness, or regularity, on observed convergence rates [@problem_id:3420663]. By intentionally manufacturing a solution that is not infinitely smooth, you will investigate how a high-order finite element method performs when the theoretical assumptions of smoothness are not met. This is a crucial test for understanding why a high-order method may underperform and how MMS can diagnose that the limitation lies not in the code, but in the nature of the problem being solved.", "problem": "Consider the Method of Manufactured Solutions (MMS) for verifying a high-order conforming Finite Element Method (FEM) for the one-dimensional Poisson equation. Let the domain be $\\Omega = (0,1)$, and consider the boundary value problem\n$$\n-u''(x) = f(x) \\quad \\text{for } x \\in (0,1), \\qquad u(0) = 0, \\quad u(1) = 0.\n$$\nManufacture the exact solution by choosing\n$$\nu(x) = x^{\\beta}(1-x),\n$$\nwith a fixed exponent $\\beta > 0$, and define $f(x)$ by enforcing $f(x) = -u''(x)$ so that $u$ is the exact solution. Assume $\\beta = 1.6$, so that the forcing $f$ is integrable in a manner consistent with the weak formulation, and note that the singularity at $x=0$ limits the Sobolev regularity of $u$.\n\nYou discretize the problem using a conforming FEM with piecewise polynomials of degree $p=4$ on a quasi-uniform mesh with characteristic size $h$. Assume standard Galerkin stability and approximation properties on $(0,1)$, and that the duality argument for $L^2$-error applies under the given regularity.\n\nUsing the foundational facts of weak solution theory for elliptic equations, Céa’s lemma (which bounds the Galerkin error by the best approximation error in the energy norm), Bramble–Hilbert-type approximation properties, and Aubin–Nitsche duality for the $L^2$ norm, determine the asymptotic algebraic convergence rates with respect to $h$ in the energy norm $\\|\\cdot\\|_{H^1(0,1)}$ and the $L^2(0,1)$ norm, accounting for the limited regularity of the manufactured solution near $x=0$.\n\nWhich option correctly states the achievable rates?\n\nA. $H^1$-error $\\sim \\mathcal{O}(h^{1.1})$, $L^2$-error $\\sim \\mathcal{O}(h^{2.1})$.\n\nB. $H^1$-error $\\sim \\mathcal{O}(h^{4})$, $L^2$-error $\\sim \\mathcal{O}(h^{5})$.\n\nC. $H^1$-error $\\sim \\mathcal{O}(h^{1.6})$, $L^2$-error $\\sim \\mathcal{O}(h^{2.6})$.\n\nD. $H^1$-error $\\sim \\mathcal{O}(h^{2.1})$, $L^2$-error $\\sim \\mathcal{O}(h^{3.1})$.", "solution": "The user has requested a an analysis of a Method of Manufactured Solutions (MMS) problem. The first step is to validate the problem statement.\n\n### Step 1: Extract Givens\n- **Governing Equation**: $-u''(x) = f(x)$ for $x \\in (0,1)$.\n- **Domain**: $\\Omega = (0,1)$.\n- **Boundary Conditions**: $u(0) = 0, u(1) = 0$.\n- **Manufactured Solution**: $u(x) = x^{\\beta}(1-x)$ with the specific value $\\beta = 1.6$. Thus, $u(x) = x^{1.6}(1-x) = x^{1.6} - x^{2.6}$.\n- **Forcing Term**: $f(x)$ is defined by the relation $f(x) = -u''(x)$.\n- **Numerical Method**: Conforming Finite Element Method (FEM) using piecewise polynomials of degree $p=4$.\n- **Mesh**: Quasi-uniform with characteristic size $h$.\n- **Assumptions**: Standard Galerlin stability and approximation properties are assumed. The Aubin–Nitsche duality argument is assumed to apply.\n- **Objective**: Determine the asymptotic convergence rates of the error in the energy norm, $\\|\\cdot\\|_{H^1(0,1)}$, and the $\\|\\cdot\\|_{L^2(0,1)}$ norm.\n\n### Step 2: Validate Using Extracted Givens\nThe problem statement describes a standard verification exercise in the field of numerical analysis for partial differential equations.\n\n- **Scientific Groundedness**: The problem is entirely based on established mathematical principles of the Finite Element Method, including Céa's lemma, Bramble-Hilbert approximation theory, and the Aubin–Nitsche duality argument. The Method of Manufactured Solutions is a standard technique for code verification. The problem is scientifically sound.\n- **Well-Posedness**: The 1D Poisson boundary value problem is well-posed. The manufactured solution $u(x) = x^{1.6}(1-x)$ uniquely determines the forcing function $f(x)$. The question asks for convergence rates, which can be uniquely determined from the given information (regularity of $u$ and polynomial degree $p$). The problem is well-posed.\n- **Objectivity**: The problem is stated in precise, objective, mathematical language. There are no subjective elements.\n- **Completeness and Consistency**: The problem provides all necessary information: the PDE, boundary conditions, the specific form of the manufactured solution ($\\beta = 1.6$), the polynomial degree of the basis functions ($p=4$), and the norms in which to measure the error. Let's analyze the regularity of the solution to confirm consistency.\nThe manufactured solution is $u(x) = x^{1.6} - x^{2.6}$. Its derivatives are:\n$u'(x) = 1.6x^{0.6} - 2.6x^{1.6}$\n$u''(x) = 1.6 \\times 0.6 x^{-0.4} - 2.6 \\times 1.6 x^{0.6} = 0.96x^{-0.4} - 4.16x^{0.6}$.\nThe forcing function is $f(x) = -u''(x) = 4.16x^{0.6} - 0.96x^{-0.4}$. The problem states that $f$ is integrable in a manner consistent with the weak formulation, which requires $f \\in H^{-1}(0,1)$. We can check if $f \\in L^2(0,1)$. The integrability of $(f(x))^2$ is determined by the term $x^{-0.4}$ near $x=0$. The integral $\\int_0^1 (x^{-0.4})^2 dx = \\int_0^1 x^{-0.8} dx = [\\frac{x^{0.2}}{0.2}]_0^1 = 5$, which is finite. Therefore, $f \\in L^2(0,1)$, which implies $f \\in H^{-1}(0,1)$. The problem statement is consistent. The limited regularity of $u(x)$ due to the singularity at $x=0$ is the central point of the problem, and this is correctly noted.\n\n### Step 3: Verdict and Action\nThe problem statement is valid. It is a well-posed and standard problem in numerical analysis that tests the understanding of FEM error estimates for solutions with limited regularity. I will proceed with the solution.\n\n### Derivation of Convergence Rates\n\nThe convergence rates of a conforming Finite Element Method depend on two main factors: the polynomial degree $p$ of the basis functions and the Sobolev regularity $s$ of the exact solution $u$. The standard error estimates for a solution $u \\in H^s(\\Omega)$ and a FEM using polynomials of degree $p$ on a quasi-uniform mesh of size $h$ are given by:\n\n1.  **Energy Norm ($H^1$) Error**: From Céa's lemma and standard approximation theory (e.g., Bramble-Hilbert):\n    $$ \\|u - u_h\\|_{H^1(\\Omega)} \\leq C h^{\\min(p, s-1)} \\|u\\|_{H^s(\\Omega)} $$\n    The asymptotic convergence rate is therefore $\\mathcal{O}(h^{\\min(p, s-1)})$.\n\n2.  **$L^2$ Norm Error**: Using the Aubin–Nitsche duality argument, which is assumed to apply, one can show a higher rate of convergence in the $L^2$ norm:\n    $$ \\|u - u_h\\|_{L^2(\\Omega)} \\leq C h^{\\min(p+1, s)} \\|u\\|_{H^s(\\Omega)} $$\n    The asymptotic convergence rate is therefore $\\mathcal{O}(h^{\\min(p+1, s)})$.\n\nTo find the specific rates for this problem, we must determine the regularity $s$ of the manufactured solution $u(x) = x^{1.6}(1-x)$.\n\n**Step 1: Determine the Sobolev Regularity $s$**\nThe solution is $u(x) = x^{1.6} - x^{2.6}$. The regularity of $u(x)$ is limited by the behavior of the term $x^{1.6}$ near the boundary point $x=0$.\nFor a function on $(0,1)$ which behaves as $x^\\beta$ for $x \\to 0$, its membership in the Sobolev space $H^k(0,1)$ for an integer $k$ requires that its $k$-th derivative is square-integrable. The $k$-th derivative of $x^\\beta$ behaves like $x^{\\beta-k}$. For this to be in $L^2(0,1)$, we need the integral $\\int_0^\\delta (x^{\\beta-k})^2 dx = \\int_0^\\delta x^{2(\\beta-k)} dx$ to be finite for some $\\delta>0$. This requires the exponent to be greater than $-1$:\n$$ 2(\\beta-k) > -1 \\implies 2\\beta + 1 > 2k \\implies k < \\beta + \\frac{1}{2} $$\nThis result can be extended to non-integer Sobolev spaces. The Sobolev regularity $s$ of a function behaving as $x^\\beta$ is limited by $s < \\beta + 1/2$. The effective regularity that governs the FEM convergence rate is $s = \\beta + 1/2$.\n\nIn this problem, $\\beta = 1.6$. Thus, the regularity of the manufactured solution is:\n$$ s = 1.6 + 0.5 = 2.1 $$\nSo, $u \\in H^s(0,1)$ for all $s < 2.1$, but $u \\notin H^{2.1}(0,1)$. The convergence rate is determined by this limiting value $s=2.1$.\n\n**Step 2: Calculate the Convergence Rates**\nWe have the polynomial degree $p=4$ and the solution regularity $s=2.1$. We now substitute these values into the standard error estimate formulas.\n\n-   **$H^1$ Error Rate**:\n    The exponent of $h$ is $\\min(p, s-1)$.\n    $$ \\min(4, 2.1 - 1) = \\min(4, 1.1) = 1.1 $$\n    Therefore, the convergence rate in the $H^1$ norm is $\\mathcal{O}(h^{1.1})$.\n\n-   **$L^2$ Error Rate**:\n    The exponent of $h$ is $\\min(p+1, s)$.\n    $$ \\min(4+1, 2.1) = \\min(5, 2.1) = 2.1 $$\n    Therefore, the convergence rate in the $L^2$ norm is $\\mathcal{O}(h^{2.1})$.\n\nThis result is consistent with the duality argument. The $H^1$ rate is limited by the solution's regularity $(s-1=1.1 < p=4)$. The $L^2$ rate is one order higher than the $H^1$ rate, because the dual problem possesses $H^2$ regularity, giving a full factor of $h$ improvement: $1.1 + 1 = 2.1$. This does not exceed the maximum possible $L^2$ rate for $p=4$ elements, which is limited by $\\min(p+1,s) = \\min(5,2.1)=2.1$.\n\n### Evaluation of Options\n\n**A. $H^1$-error $\\sim \\mathcal{O}(h^{1.1})$, $L^2$-error $\\sim \\mathcal{O}(h^{2.1})$.**\nThis option matches our derived convergence rates precisely.\n**Verdict: Correct.**\n\n**B. $H^1$-error $\\sim \\mathcal{O}(h^{4})$, $L^2$-error $\\sim \\mathcal{O}(h^{5})$.**\nThese are the optimal rates achievable with $p=4$ elements. They would be observed only if the solution were sufficiently regular (i.e., $u \\in H^5(0,1)$ or smoother). Since the regularity is only $s=2.1$, these rates are not achieved. The regularity, not the polynomial degree, is the limiting factor.\n**Verdict: Incorrect.**\n\n**C. $H^1$-error $\\sim \\mathcal{O}(h^{1.6})$, $L^2$-error $\\sim \\mathcal{O}(h^{2.6})$.**\nThese rates would be obtained if one assumed an incorrect regularity, such as $s = \\beta + 1 = 1.6 + 1 = 2.6$. Then the $H^1$ rate would be $\\min(p, s-1) = \\min(4, 1.6) = 1.6$ and the $L^2$ rate would be $\\min(p+1, s) = \\min(5, 2.6) = 2.6$. This is based on a misunderstanding of the relationship between the singularity exponent $\\beta$ and the Sobolev regularity $s$. The correct relationship is $s = \\beta + 1/2$.\n**Verdict: Incorrect.**\n\n**D. $H^1$-error $\\sim \\mathcal{O}(h^{2.1})$, $L^2$-error $\\sim \\mathcal{O}(h^{3.1})$.**\nThis option incorrectly uses the $L^2$ rate for the $H^1$ error and then incorrectly adds $1$ to get an even higher $L^2$ rate. The $H^1$ rate is limited by $s-1=1.1$, not $s=2.1$. This option misapplies the error estimation formulas.\n**Verdict: Incorrect.**", "answer": "$$\\boxed{A}$$", "id": "3420663"}]}