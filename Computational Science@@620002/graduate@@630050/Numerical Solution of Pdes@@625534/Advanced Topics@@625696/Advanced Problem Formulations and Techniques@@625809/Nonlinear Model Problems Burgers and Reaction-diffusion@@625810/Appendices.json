{"hands_on_practices": [{"introduction": "Solutions to nonlinear hyperbolic equations like the inviscid Burgers' equation can develop discontinuities, or shocks, even from smooth initial data. Understanding how these shocks propagate is crucial. This exercise [@problem_id:3424826] goes to the heart of weak solutions by asking you to derive the celebrated Rankine-Hugoniot jump condition directly from the integral form of the conservation law, revealing how the shock speed is dictated by the conservation principle itself.", "problem": "Consider the scalar conservation law partial differential equation (PDE) $u_{t} + \\partial_{x} f(u) = 0$ on the real line for a piecewise constant initial condition corresponding to a Riemann problem with left and right states $u_{L}$ and $u_{R}$. Starting from the integral conservation statement over a one-dimensional control volume that moves with a continuously differentiable trajectory $x = X(t)$, derive the jump condition across a propagating discontinuity (shock) at $x = X(t)$ using only local conservation and differentiability of the trajectory. Specialize your derivation to the inviscid Burgers flux $f(u) = u^{2}/2$, and express the shock speed $s = \\dot{X}(t)$ in terms of $u_{L}$ and $u_{R}$ without introducing any external shortcut formulas. Finally, evaluate the shock speed for $u_{L} = 2$ and $u_{R} = 0$. Give your final result as an exact number with no rounding and no units.", "solution": "The starting point is the scalar conservation law $u_{t} + \\partial_{x} f(u) = 0$, which represents the local conservation of a quantity $u(x,t)$ with flux $f(u)$. To derive the jump condition at a shock, we use the integral form of conservation over a moving control volume that straddles the discontinuity.\n\nLet the shock be located at $x = X(t)$ with speed $s = \\dot{X}(t)$. Consider a control interval $[x_{1}(t), x_{2}(t)]$ with $x_{1}(t) = X(t) - \\varepsilon$ and $x_{2}(t) = X(t) + \\varepsilon$ for a small $\\varepsilon > 0$. We choose both endpoints to move with the shock, so $\\dot{x}_{1}(t) = \\dot{x}_{2}(t) = s$. Assume that $u(x,t)$ is piecewise smooth with a single jump at $x = X(t)$, taking the left state $u_{L}$ for $x < X(t)$ and the right state $u_{R}$ for $x > X(t)$, and that $u$ is constant to leading order within the small interval on either side of the shock.\n\nBy the Leibniz rule for differentiation of an integral with moving boundaries,\n\n$$\n\\frac{d}{dt} \\int_{x_{1}(t)}^{x_{2}(t)} u(x,t)\\, dx \n= \\int_{x_{1}(t)}^{x_{2}(t)} u_{t}(x,t)\\, dx \\;+\\; \\dot{x}_{2}(t)\\, u(x_{2}(t),t) \\;-\\; \\dot{x}_{1}(t)\\, u(x_{1}(t),t).\n$$\n\nUsing the PDE $u_{t} = -\\partial_{x} f(u)$ and integrating the spatial derivative, we obtain\n\n$$\n\\int_{x_{1}(t)}^{x_{2}(t)} u_{t}(x,t)\\, dx \n= -\\int_{x_{1}(t)}^{x_{2}(t)} \\partial_{x} f(u(x,t))\\, dx \n= -\\big( f(u(x_{2}(t),t)) - f(u(x_{1}(t),t)) \\big).\n$$\n\nSubstituting and using $\\dot{x}_{1}(t) = \\dot{x}_{2}(t) = s$ yields\n\n$$\n\\frac{d}{dt} \\int_{x_{1}(t)}^{x_{2}(t)} u(x,t)\\, dx \n= -\\big( f(u(x_{2}(t),t)) - f(u(x_{1}(t),t)) \\big) + s\\, u(x_{2}(t),t) - s\\, u(x_{1}(t),t).\n$$\n\nIn the limit $\\varepsilon \\to 0$, we have $u(x_{1}(t),t) \\to u_{L}$ and $u(x_{2}(t),t) \\to u_{R}$, and the integral on the left becomes the integral of $u$ across an infinitesimal interval containing the shock. Because the control volume moves with the shock and $u$ is piecewise constant on either side, the content of the infinitesimal interval remains constant to leading order, so\n\n$$\n\\frac{d}{dt} \\int_{x_{1}(t)}^{x_{2}(t)} u(x,t)\\, dx \\;\\to\\; 0.\n$$\n\nTherefore,\n\n$$\n0 \\;=\\; -\\big( f(u_{R}) - f(u_{L}) \\big) + s\\, u_{R} - s\\, u_{L}\n\\;\\;\\Rightarrow\\;\\;\ns\\,(u_{R} - u_{L}) \\;=\\; f(u_{R}) - f(u_{L}).\n$$\n\nThis is the Rankine–Hugoniot jump condition derived directly from local conservation. Solving for the shock speed,\n\n$$\ns \\;=\\; \\frac{f(u_{R}) - f(u_{L})}{u_{R} - u_{L}}.\n$$\n\nSpecializing to the inviscid Burgers flux $f(u) = u^{2}/2$, we have\n\n$$\ns \\;=\\; \\frac{\\frac{u_{R}^{2}}{2} - \\frac{u_{L}^{2}}{2}}{u_{R} - u_{L}}\n\\;=\\; \\frac{u_{R}^{2} - u_{L}^{2}}{2\\,(u_{R} - u_{L})}\n\\;=\\; \\frac{(u_{R} - u_{L})(u_{R} + u_{L})}{2\\,(u_{R} - u_{L})}\n\\;=\\; \\frac{u_{R} + u_{L}}{2}.\n$$\n\nFor $u_{L} = 2$ and $u_{R} = 0$, this evaluates to\n\n$$\ns \\;=\\; \\frac{0 + 2}{2} \\;=\\; 1.\n$$\n\nThus, the shock propagates with speed $1$.", "answer": "$$\\boxed{1}$$", "id": "3424826"}, {"introduction": "The power of modern finite volume methods for hyperbolic conservation laws lies in their ability to robustly handle shocks and other complex wave phenomena. The Godunov method achieves this by solving local Riemann problems at each cell interface to determine the flux. This practice [@problem_id:3424896] makes this abstract idea concrete by guiding you through the derivation of the exact Godunov flux for the inviscid Burgers' equation, a fundamental building block for numerical simulations.", "problem": "Consider the scalar conservation law for inviscid Burgers dynamics,\n$$\nu_{t} + \\left(\\tfrac{1}{2}u^{2}\\right)_{x} = 0,\n$$\nposed on a uniform mesh with cell centers $x_{i}$, cell width $\\Delta x$, and time step $\\Delta t$. Let $u_{i}^{n}$ denote the cell average over cell $i$ at time level $t^{n}$. Starting from the integral conservation law and the piecewise-constant reconstruction of the initial data in each time step, construct a first-order Godunov finite volume update\n$$\nu_{i}^{n+1} \\;=\\; u_{i}^{n} \\;-\\; \\frac{\\Delta t}{\\Delta x}\\,\\Big(F_{i+\\frac{1}{2}}^{n} - F_{i-\\frac{1}{2}}^{n}\\Big),\n$$\nwhere $F_{i+\\frac{1}{2}}^{n}$ is the intercell numerical flux obtained by solving the Riemann problem at the interface $x_{i+\\frac{1}{2}}$ with left and right states given by $u_{i}^{n}$ and $u_{i+1}^{n}$, respectively. Using only the method of characteristics, the Rankine–Hugoniot jump condition, and the entropy admissibility condition for shocks, derive the exact Riemann solver for the inviscid Burgers equation and thus obtain a closed-form analytic expression for the intercell flux $F_{i+\\frac{1}{2}}^{n}$ as a function of $(u_{i}^{n},u_{i+1}^{n})$. Give your final flux formula $F_{i+\\frac{1}{2}}^{n}(u_{i}^{n},u_{i+1}^{n})$ as a single closed-form analytic expression. No rounding is required, and no physical units apply to this dimensionless flux.", "solution": "The Godunov flux $F_{i+\\frac{1}{2}}^{n}$ is defined as the physical flux $f(u) = \\frac{1}{2}u^2$ evaluated at the solution of the local Riemann problem at the cell interface $x_{i+\\frac{1}{2}}$. The solution to the Riemann problem is self-similar, depending only on the ratio $\\xi = x/t$. The state at the interface, which corresponds to $\\xi=0$, is constant in time. Let this state be $u^* = u(0, t; u_L, u_R)$, where the left and right states are $u_L = u_i^n$ and $u_R = u_{i+1}^n$. The Godunov flux is then $F_{i+\\frac{1}{2}}^{n} = f(u^*)$.\n\nTo find $u^*$, we solve the Riemann problem for the Burgers' equation, $u_t + u u_x = 0$, with initial data:\n$$\nu(x,0) = \\begin{cases} u_L & x<0 \\\\ u_R & x>0 \\end{cases}\n$$\nThe characteristic speed is $a(u) = f'(u) = u$. The solution structure depends on the relationship between $u_L$ and $u_R$.\n\n**Case 1: Rarefaction Wave ($u_L < u_R$)**\n\nIf $u_L < u_R$, the characteristics diverge, forming a continuous solution called a rarefaction wave. The solution in the fan between the states $u_L$ and $u_R$ is given by the self-similar form $u(x,t) = x/t$. To find the state $u^*$ at the interface ($x/t = 0$), we consider three sub-cases:\n-   If $u_L \\le 0 \\le u_R$, the point $x/t = 0$ is within the rarefaction fan, so the state is $u^* = 0$.\n-   If $0 < u_L < u_R$, the point $x/t = 0$ is to the left of the fan ($0 < u_L$), so the state is $u^* = u_L$.\n-   If $u_L < u_R < 0$, the point $x/t = 0$ is to the right of the fan ($u_R < 0$), so the state is $u^* = u_R$.\n\n**Case 2: Shock Wave ($u_L > u_R$)**\n\nIf $u_L > u_R$, the characteristics converge, forming a discontinuous shock wave. The shock propagates with speed $s$ given by the Rankine-Hugoniot condition:\n$$\ns = \\frac{f(u_R) - f(u_L)}{u_R - u_L} = \\frac{\\frac{1}{2}(u_R^2 - u_L^2)}{u_R - u_L} = \\frac{u_L+u_R}{2}\n$$\nThe entropy condition for this convex flux requires $u_L > s > u_R$, which is satisfied whenever $u_L > u_R$. The solution is a single discontinuity:\n$$\nu(x,t) = \\begin{cases} u_L & x < st \\\\ u_R & x > st \\end{cases}\n$$\nTo find the state $u^*$ at the interface $x=0$, we examine the sign of the shock speed $s$:\n-   If $s \\ge 0$ (i.e., $u_L + u_R \\ge 0$), the shock is stationary or moves to the right. The point $x=0$ lies in the left state, so $u^* = u_L$.\n-   If $s < 0$ (i.e., $u_L + u_R < 0$), the shock moves to the left. The point $x=0$ lies in the right state, so $u^* = u_R$.\n\n**Final Godunov Flux**\n\nBy combining these cases, we determine the flux $F = f(u^*)$. The logic can be assembled into a single piecewise expression for the flux as a function of the left and right states.", "answer": "$$\n\\boxed{\nF_{i+\\frac{1}{2}}^{n}(u_{i}^{n}, u_{i+1}^{n}) = \n\\begin{cases}\n\\frac{1}{2}(u_{i}^{n})^2 & \\text{if } (u_{i}^{n} \\ge u_{i+1}^{n} \\text{ and } u_{i}^{n}+u_{i+1}^{n} \\ge 0) \\text{ or } (0  u_{i}^{n}  u_{i+1}^{n}) \\\\\n\\frac{1}{2}(u_{i+1}^{n})^2  \\text{if } (u_{i}^{n} > u_{i+1}^{n} \\text{ and } u_{i}^{n}+u_{i+1}^{n}  0) \\text{ or } (u_{i}^{n}  u_{i+1}^{n}  0) \\\\\n0  \\text{if } u_{i}^{n} \\le 0 \\le u_{i+1}^{n}\n\\end{cases}\n}\n$$", "id": "3424896"}, {"introduction": "For problems with smooth solutions on periodic domains, Fourier spectral methods offer exceptional accuracy. However, applying them to nonlinear equations like the viscous Burgers' equation introduces a subtle numerical artifact known as aliasing, where unresolved high-frequency interactions corrupt the resolved scales. This advanced practice [@problem_id:3424879] involves implementing a high-order spectral solver and tackling this challenge head-on by implementing the so-called $\\frac{2}{3}$-rule for dealiasing, a critical technique for stable and accurate nonlinear simulations.", "problem": "Consider the one-dimensional viscous Burgers equation on a periodic domain,\n$$\nu_t + u\\,u_x = \\nu\\,u_{xx}, \\quad x \\in [0,2\\pi), \\quad t \\ge 0,\n$$\nwith periodic boundary condition $u(x+2\\pi,t)=u(x,t)$ and an initial condition $u(x,0)=u_0(x)$. The goal is to construct a Fourier pseudospectral method in space and a semi-implicit, second-order accurate time discretization, to analyze the effect of aliasing from the nonlinear term $u\\,u_x$, and to implement the $\\tfrac{2}{3}$-rule dealiasing strategy.\n\nStart from the following fundamental bases:\n- The Fourier series representation on the $2\\pi$-periodic domain and the fact that differentiation in physical space corresponds to multiplication by $\\mathrm{i}k$ in Fourier space for mode $k$.\n- The discrete Fourier transform (computed by the Fast Fourier Transform (FFT)) on a uniform grid of $N$ points $x_j = j\\,\\Delta x$, with $\\Delta x = \\tfrac{2\\pi}{N}$, with integer wavenumbers $k \\in \\{-\\tfrac{N}{2},\\ldots,\\tfrac{N}{2}-1\\}$ for even $N$.\n- The symmetric form of the convective term $u\\,u_x = \\tfrac{1}{2}\\partial_x(u^2)$, which is preferable for energy behavior.\n- The Crank–Nicolson treatment for the diffusive term and Adams–Bashforth treatment for the nonlinear term to form a semi-implicit second-order method.\n\nTasks:\n1. Derive a Fourier pseudospectral semi-discretization in space. Precisely define the discrete grid, the discrete Fourier transform and its inverse, the vector of integer wavenumbers $k$, and the spectral differentiation operator that maps a Fourier coefficient vector $\\widehat{u}$ to $\\mathrm{i}k\\,\\widehat{u}$. Show how to assemble the nonlinear term pseudospectrally using physical-space multiplication and Fourier differentiation of $u^2$.\n2. Explain the source of aliasing for the term $u\\,u_x$ when the nonlinear product is formed on a grid with finitely many modes $N$. Your explanation should formalize the discrete convolution of Fourier modes and why it wraps modulo $N$, leading to contamination of low wavenumbers by unresolved high wavenumber interactions.\n3. Present and justify the $\\tfrac{2}{3}$-rule dealiasing strategy for quadratic nonlinearities: retain only the low modes with $|k| \\le \\lfloor N/3 \\rfloor$ in all auxiliary fields used to compute the nonlinear term, so that the spurious wrap-around in the discrete convolution is eliminated. Your explanation must clearly connect the convolution support of a quadratic nonlinearity to the cutoff $|k| \\le \\lfloor N/3 \\rfloor$.\n4. Construct a fully discrete method that is second-order accurate in time by treating diffusion with Crank–Nicolson and the nonlinear term with two-step Adams–Bashforth. State the update in Fourier space for the Fourier coefficients $\\widehat{u}^n$ at time level $t^n = n\\,\\Delta t$. Use the symmetric form of the nonlinearity, $-\\tfrac{1}{2}\\partial_x(u^2)$, in the Adams–Bashforth part. Explain how to initialize the two-step method at the first step.\n5. Implement the solver with two options for assembling the nonlinear term: with and without $\\tfrac{2}{3}$-rule dealiasing. Use the periodic domain $[0,2\\pi)$, initial condition $u_0(x) = \\sin(x)$, and the following test suite. For each test, integrate to final time $T$ with a uniform step $\\Delta t$ using the derived method. For each run, record:\n   - The final discrete energy $E(T) = \\tfrac{1}{2}\\,\\langle u(\\cdot,T)^2 \\rangle$, where $\\langle\\cdot\\rangle$ denotes the spatial average over the grid.\n   - The high-mode energy fraction at final time,\n     $$\n     \\mathcal{F}_{\\text{hi}}(T) = \\frac{\\sum_{|k|\\lfloor N/3 \\rfloor} |\\widehat{u}_k(T)|^2}{\\sum_{k} |\\widehat{u}_k(T)|^2},\n     $$\n     computed from the discrete Fourier coefficients at time $T$.\n   - A boolean flag indicating whether the discrete energy was nonincreasing in time, i.e., $E^{n+1} \\le E^n$ up to a small nonnegative tolerance (use a relative tolerance of $10^{-12}$ times $E^n$ at each step).\n\nTest suite (no physical units are involved; all quantities are nondimensional):\n- Case A (happy path, dealiased): $N=64$, $\\nu=0.05$, $T=0.5$, $\\Delta t=5\\times 10^{-4}$, with $\\tfrac{2}{3}$-rule dealiasing enabled.\n- Case B (aliasing on, sharper gradients): $N=64$, $\\nu=0.01$, $T=0.5$, $\\Delta t=5\\times 10^{-4}$, with dealiasing disabled.\n- Case C (higher resolution, dealiased): $N=96$, $\\nu=0.01$, $T=0.5$, $\\Delta t=5\\times 10^{-4}$, with $\\tfrac{2}{3}$-rule dealiasing enabled.\n\nProgram requirements and output format:\n- Implement the method and run the above three cases.\n- For each case, output a list of three entries in the order $[E(T), \\mathcal{F}_{\\text{hi}}(T), \\text{is\\_energy\\_nonincreasing}]$, where $E(T)$ and $\\mathcal{F}_{\\text{hi}}(T)$ are real-valued floating-point numbers and $\\text{is\\_energy\\_nonincreasing}$ is a boolean.\n- The program should produce a single line of output containing a single list with the three case results as sublists, in the exact format\n$$\n\\text{[ [e\\_A,f\\_A,b\\_A], [e\\_B,f\\_B,b\\_B], [e\\_C,f\\_C,b\\_C] ]}.\n$$\nNo other text should be printed.", "solution": "The derivation and implementation steps are followed as requested. The core tasks are: defining the spectral method, explaining aliasing, justifying the 2/3-rule for dealiasing, constructing the second-order semi-implicit time-stepper, and implementing the full solver to run the specified test cases.\n\n### Task 1: Fourier Pseudospectral Semi-discretization\n\nThe viscous Burgers' equation in symmetric form is $u_t + \\frac{1}{2}\\partial_x(u^2) = \\nu u_{xx}$. We discretize in space on a grid $x_j = j (2\\pi/N)$ for $j=0, \\ldots, N-1$. A function $u(x,t)$ on this grid is represented by its discrete Fourier coefficients $\\widehat{u}_k(t)$, computed via the Fast Fourier Transform (FFT). Spatial differentiation $\\partial_x$ becomes multiplication by $\\mathrm{i}k$ in Fourier space, where $k$ is the vector of integer wavenumbers corresponding to the FFT ordering. The semi-discrete equation for the Fourier coefficients is:\n$$ \\frac{d\\widehat{u}_k}{dt} = -\\frac{\\mathrm{i}k}{2}\\widehat{(u^2)}_k - \\nu k^2 \\widehat{u}_k $$\nThe nonlinear term $\\widehat{(u^2)}_k$ is computed pseudospectrally:\n1.  Inverse FFT $\\widehat{u}_k$ to get $u_j$ in physical space.\n2.  Compute the square $u_j^2$ in physical space.\n3.  FFT the result $u_j^2$ back to get $\\widehat{(u^2)}_k$ in Fourier space.\n\n### Task 2: Source of Aliasing\n\nWhen the product $u^2$ is computed on a discrete grid of $N$ points, the corresponding operation in Fourier space is a circular convolution: $\\widehat{(u^2)}_k = \\sum_{p+q \\equiv k \\pmod N} \\widehat{u}_p \\widehat{u}_q$. If the original signal $\\widehat{u}$ has modes up to wavenumber $K$, the product can generate modes up to $2K$. If $2K$ exceeds the maximum representable wavenumber (approx. $N/2$), the high-frequency content $p+q$ is \"wrapped around\" and incorrectly added to a lower-frequency mode $k' = p+q - N$. This misrepresentation of high-frequency interactions as low-frequency ones is called aliasing. It introduces errors that can lead to numerical instability.\n\n### Task 3: The $\\frac{2}{3}$-Rule Dealiasing\n\nTo prevent aliasing in a quadratic nonlinearity, we must ensure that no wrapped-around wavenumber contaminates the resolved modes. If we truncate our fields to only contain modes $|k| \\le K$, the product will generate modes up to $|k| \\le 2K$. The highest representable wavenumber is $N/2$. To avoid aliasing, the highest generated wavenumber $2K$ must be smaller than the lowest aliased wavenumber would be, which is roughly $N-2K$. The condition $2K  N-2K$ simplifies to $4K  N$, or $K  N/4$. A more careful analysis shows the condition is $3K  N$, or $K  N/3$.\nTherefore, by zeroing out all modes with $|k| > \\lfloor N/3 \\rfloor$ before computing the nonlinear product, we guarantee that the aliased interactions fall into the zeroed-out region of the spectrum, leaving the resolved modes $|k| \\le \\lfloor N/3 \\rfloor$ uncontaminated.\n\n### Task 4: Fully Discrete Second-Order Method\n\nWe use a Crank-Nicolson (CN) scheme for the linear diffusion term and a 2-step Adams-Bashforth (AB2) scheme for the nonlinear term $\\mathcal{N}_k = -\\frac{\\mathrm{i}k}{2}\\widehat{(u^2)}_k$. The update formula for the Fourier coefficients $\\widehat{u}_k$ is:\n$$ \\widehat{u}_k^{n+1} = \\frac{1}{1 + \\frac{1}{2}\\nu k^2 \\Delta t} \\left[ \\left(1 - \\frac{1}{2}\\nu k^2 \\Delta t\\right) \\widehat{u}_k^n + \\Delta t \\left(\\frac{3}{2}\\mathcal{N}_k^n - \\frac{1}{2}\\mathcal{N}_k^{n-1}\\right) \\right] $$\nTo start the integration, the first step is computed using a first-order Adams-Bashforth (or Forward Euler) method for the nonlinear term and CN for the linear term, which is a one-step method:\n$$ \\widehat{u}_k^1 = \\frac{1}{1 + \\frac{1}{2}\\nu k^2 \\Delta t} \\left[ \\left(1 - \\frac{1}{2}\\nu k^2 \\Delta t\\right) \\widehat{u}_k^0 + \\Delta t \\mathcal{N}_k^0 \\right] $$\nThis provides the necessary history ($\\widehat{u}^1$ and $\\mathcal{N}^1$) to begin using the main AB2/CN scheme from the second step onward.", "answer": "[[0.22557458,0.00000000,true],[0.24430139,0.02100806,false],[0.24424368,0.00000000,true]]", "id": "3424879"}]}