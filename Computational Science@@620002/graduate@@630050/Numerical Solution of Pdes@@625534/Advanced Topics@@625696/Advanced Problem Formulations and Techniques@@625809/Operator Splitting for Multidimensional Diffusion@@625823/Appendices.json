{"hands_on_practices": [{"introduction": "To effectively use operator splitting methods, one must first master their construction from simpler building blocks. This practice focuses on the algebraic mechanics of creating a second-order accurate Strang splitting scheme by composing first-order implicit Euler sub-steps. By deriving the one-step propagation operator and computing its amplification factor for a specific Fourier mode, you will gain a concrete understanding of how the abstract operator formulation translates into a sequence of linear solves and how its properties can be analyzed [@problem_id:3427488].", "problem": "Consider the two-dimensional diffusion partial differential equation (PDE) $u_t=\\alpha\\,u_{xx}+\\beta\\,u_{yy}$ on the unit square $(0,1)\\times(0,1)$ with homogeneous Dirichlet boundary conditions, where $\\alpha>0$ and $\\beta>0$ are constants. Discretize the spatial domain on a uniform Cartesian grid with $3\\times 3$ interior points and grid spacing $h$, and use lexicographic ordering with the $x$-index varying fastest. Let $T_3\\in\\mathbb{R}^{3\\times 3}$ be the standard second-difference matrix with homogeneous Dirichlet boundary conditions, i.e., the tridiagonal matrix with diagonal entries $-2/h^2$ and first sub- and super-diagonal entries $1/h^2$. Define the split discrete operators $A_h=\\alpha\\,(I_3\\otimes T_3)$ and $B_h=\\beta\\,(T_3\\otimes I_3)$, where $I_3$ is the $3\\times 3$ identity and $\\otimes$ denotes the Kronecker product.\n\nStarting from the definitions above and the implicit Euler time discretization for a linear autonomous system $v_t=Lv$, namely $(I-\\tau L)\\,v^{n+1}=v^n$ for a time increment $\\tau>0$, derive from first principles the algebraic sequence of subproblems that implements one Strang splitting step of size $\\Delta t$ for $u_t=(A_h+B_h)u$, using implicit Euler subsolves for each substep. You must express the overall one-step linear propagation operator $S_{\\Delta t}$ that maps $u^n$ to $u^{n+1}$ purely in terms of $A_h$, $B_h$, $I$, and $\\Delta t$.\n\nThen, using the fact that $A_h$ and $B_h$ commute and that the discrete sine transform (DST) diagonalizes $T_3$ under homogeneous Dirichlet boundary conditions, compute the scalar amplification factor (the eigenvalue of $S_{\\Delta t}$) associated with the discrete sine mode that has $p=q=2$ in each coordinate direction. Express your final answer as a closed-form analytic expression in terms of $\\alpha$, $\\beta$, $h$, and $\\Delta t$. No numerical rounding is required, and no units need to be reported. The final answer must be a single analytic expression.", "solution": "The problem is evaluated to be valid as it is scientifically grounded, well-posed, objective, and self-contained. It describes a standard problem in numerical analysis for partial differential equations (PDEs), providing all necessary definitions and constraints to arrive at a unique, verifiable solution.\n\nThe problem asks for two main results: first, the derivation of the Strang splitting operator for the given semi-discretized diffusion equation using implicit Euler substeps; second, the calculation of the amplification factor for a specific spatial mode.\n\nThe semi-discretized system to be solved is $u_t = (A_h + B_h)u$, where $u$ is the vector of unknown values at the interior grid points. The operators $A_h$ and $B_h$ represent the spatial derivatives in the $x$ and $y$ directions, respectively.\n\nFirst, we derive the Strang splitting scheme. Strang splitting, a second-order operator splitting method, approximates the solution to $u_t = (A+B)u$ over a time step $\\Delta t$ by composing three sub-steps: a half-step for operator $A$, a full step for operator $B$, and another half-step for operator $A$. The formal operator expression is $\\exp(\\frac{\\Delta t}{2} A) \\exp(\\Delta t B) \\exp(\\frac{\\Delta t}{2} A)$.\n\nThe problem specifies that each substep is to be solved using the implicit Euler method. For a generic linear autonomous system $v_t = Lv$, the implicit Euler discretization over a time increment $\\tau$ is $v^{n+1} = v^n + \\tau L v^{n+1}$, which rearranges to $(I - \\tau L)v^{n+1} = v^n$. The one-step propagator is thus the operator $(I - \\tau L)^{-1}$.\n\nApplying this to the three substeps of Strang splitting:\n1.  Solving $u_t = A_h u$ over a time step of $\\Delta t/2$ yields the propagation operator $(I - \\frac{\\Delta t}{2} A_h)^{-1}$.\n2.  Solving $u_t = B_h u$ over a time step of $\\Delta t$ yields the propagation operator $(I - \\Delta t B_h)^{-1}$.\n3.  Solving $u_t = A_h u$ over a second time step of $\\Delta t/2$ yields the propagation operator $(I - \\frac{\\Delta t}{2} A_h)^{-1}$.\n\nThe algebraic sequence of subproblems to advance the solution from time $t_n$ (state $u^n$) to $t_{n+1} = t_n + \\Delta t$ (state $u^{n+1}$) is as follows:\n1.  Solve the linear system $(I - \\frac{\\Delta t}{2} A_h) u^{(1)} = u^n$ for the intermediate state $u^{(1)}$.\n2.  Solve the linear system $(I - \\Delta t B_h) u^{(2)} = u^{(1)}$ for the intermediate state $u^{(2)}$.\n3.  Solve the linear system $(I - \\frac{\\Delta t}{2} A_h) u^{n+1} = u^{(2)}$ for the final state $u^{n+1}$.\n\nComposing these steps gives the overall one-step linear propagation operator $S_{\\Delta t}$ that maps $u^n$ to $u^{n+1}$:\n$u^{n+1} = S_{\\Delta t} u^n = (I - \\frac{\\Delta t}{2} A_h)^{-1} (I - \\Delta t B_h)^{-1} (I - \\frac{\\Delta t}{2} A_h)^{-1} u^n$.\nTherefore, the operator is $S_{\\Delta t} = (I - \\frac{\\Delta t}{2} A_h)^{-1} (I - \\Delta t B_h)^{-1} (I - \\frac{\\Delta t}{2} A_h)^{-1}$.\n\nNext, we compute the scalar amplification factor associated with a specific discrete sine mode. The amplification factor is the eigenvalue of the operator $S_{\\Delta t}$ corresponding to the eigenvector representing that mode.\n\nThe problem states that the operators $A_h = \\alpha(I_3 \\otimes T_3)$ and $B_h = \\beta(T_3 \\otimes I_3)$ commute. This implies they share a common basis of eigenvectors. Let $v_{p,q}$ be a common eigenvector of $A_h$ and $B_h$ with corresponding eigenvalues $\\lambda_A^{(p,q)}$ and $\\lambda_B^{(p,q)}$.\n$A_h v_{p,q} = \\lambda_A^{(p,q)} v_{p,q}$\n$B_h v_{p,q} = \\lambda_B^{(p,q)} v_{p,q}$\n\nApplying $S_{\\Delta t}$ to $v_{p,q}$:\n$S_{\\Delta t} v_{p,q} = (I - \\frac{\\Delta t}{2} A_h)^{-1} (I - \\Delta t B_h)^{-1} (I - \\frac{\\Delta t}{2} A_h)^{-1} v_{p,q}$\nThe eigenvalue of an inverse operator $(I-C)^{-1}$ for an eigenvector $v$ of $C$ with eigenvalue $\\lambda_C$ is $(1-\\lambda_C)^{-1}$. Applying this property sequentially:\n$S_{\\Delta t} v_{p,q} = (I - \\frac{\\Delta t}{2} A_h)^{-1} (I - \\Delta t B_h)^{-1} \\left(1 - \\frac{\\Delta t}{2} \\lambda_A^{(p,q)}\\right)^{-1} v_{p,q}$\n$S_{\\Delta t} v_{p,q} = (I - \\frac{\\Delta t}{2} A_h)^{-1} \\left(1 - \\Delta t \\lambda_B^{(p,q)}\\right)^{-1} \\left(1 - \\frac{\\Delta t}{2} \\lambda_A^{(p,q)}\\right)^{-1} v_{p,q}$\n$S_{\\Delta t} v_{p,q} = \\left(1 - \\frac{\\Delta t}{2} \\lambda_A^{(p,q)}\\right)^{-1} \\left(1 - \\Delta t \\lambda_B^{(p,q)}\\right)^{-1} \\left(1 - \\frac{\\Delta t}{2} \\lambda_A^{(p,q)}\\right)^{-1} v_{p,q}$\n$S_{\\Delta t} v_{p,q} = \\left(1 - \\frac{\\Delta t}{2} \\lambda_A^{(p,q)}\\right)^{-2} \\left(1 - \\Delta t \\lambda_B^{(p,q)}\\right)^{-1} v_{p,q}$\n\nThe scalar amplification factor for mode $(p,q)$ is thus $\\lambda_{S}^{(p,q)} = \\left(1 - \\frac{\\Delta t}{2} \\lambda_A^{(p,q)}\\right)^{-2} \\left(1 - \\Delta t \\lambda_B^{(p,q)}\\right)^{-1}$.\n\nWe need to find the eigenvalues of $A_h$ and $B_h$. The eigenvectors of the 2D discrete Laplacian on a Cartesian grid with homogeneous Dirichlet boundary conditions are discrete sine modes. The eigenvalues of the $N \\times N$ second-difference matrix $T_N$ (with diagonal $-2/h^2$ and off-diagonals $1/h^2$) are given by $\\mu_k = -\\frac{4}{h^2} \\sin^2\\left(\\frac{k\\pi}{2(N+1)}\\right)$ for $k=1, \\dots, N$.\nIn our case, the grid has $3 \\times 3$ interior points, so $N=3$. The eigenvalues of $T_3$ are $\\mu_k = -\\frac{4}{h^2} \\sin^2\\left(\\frac{k\\pi}{8}\\right)$ for $k=1, 2, 3$.\n\nThe eigenvalues of $A_h = \\alpha(I_3 \\otimes T_3)$ correspond to the $x$-direction mode, indexed by $p$. They are $\\lambda_A^{(p,q)} = \\alpha \\mu_p$.\nThe eigenvalues of $B_h = \\beta(T_3 \\otimes I_3)$ correspond to the $y$-direction mode, indexed by $q$. They are $\\lambda_B^{(p,q)} = \\beta \\mu_q$.\n\nThe problem asks for the amplification factor for the mode with $p=2$ and $q=2$. We compute the required eigenvalue of $T_3$:\n$\\mu_2 = -\\frac{4}{h^2} \\sin^2\\left(\\frac{2\\pi}{8}\\right) = -\\frac{4}{h^2} \\sin^2\\left(\\frac{\\pi}{4}\\right)$.\nSince $\\sin(\\pi/4) = \\frac{\\sqrt{2}}{2}$, we have $\\sin^2(\\pi/4) = \\frac{1}{2}$.\nSo, $\\mu_2 = -\\frac{4}{h^2} \\left(\\frac{1}{2}\\right) = -\\frac{2}{h^2}$.\n\nThe corresponding eigenvalues for $A_h$ and $B_h$ for mode $(p,q)=(2,2)$ are:\n$\\lambda_A^{(2,2)} = \\alpha \\mu_2 = -\\frac{2\\alpha}{h^2}$\n$\\lambda_B^{(2,2)} = \\beta \\mu_2 = -\\frac{2\\beta}{h^2}$\n\nSubstituting these into the expression for the amplification factor $\\lambda_{S}^{(p,q)}$:\n$\\lambda_{S}^{(2,2)} = \\left(1 - \\frac{\\Delta t}{2} \\left(-\\frac{2\\alpha}{h^2}\\right)\\right)^{-2} \\left(1 - \\Delta t \\left(-\\frac{2\\beta}{h^2}\\right)\\right)^{-1}$\n$\\lambda_{S}^{(2,2)} = \\left(1 + \\frac{\\alpha \\Delta t}{h^2}\\right)^{-2} \\left(1 + \\frac{2\\beta \\Delta t}{h^2}\\right)^{-1}$\n\nThis can be written in fractional form as:\n$\\lambda_{S}^{(2,2)} = \\frac{1}{\\left(1 + \\frac{\\alpha \\Delta t}{h^2}\\right)^{2}\\left(1 + \\frac{2\\beta \\Delta t}{h^2}\\right)}$\n\nThis is the final closed-form analytic expression for the requested amplification factor.", "answer": "$$\\boxed{\\frac{1}{\\left(1 + \\frac{\\alpha \\Delta t}{h^2}\\right)^{2}\\left(1 + \\frac{2\\beta \\Delta t}{h^2}\\right)}}$$", "id": "3427488"}, {"introduction": "While von Neumann stability is essential, it is not the only important property of a numerical scheme. For problems modeling physical quantities like concentration or temperature, it is crucial that the numerical solution remains non-negative, a property known as the discrete maximum principle. This exercise investigates the classic Peaceman-Rachford ADI scheme, demonstrating that even an unconditionally stable method can violate this physical constraint for large time steps, leading to unphysical oscillations and negative values [@problem_id:3427476].", "problem": "Consider the two-dimensional heat equation (diffusion equation) on a periodic square domain with uniform grid spacing $h$ in both spatial directions,\n$$\nu_{t} = \\kappa \\left(u_{xx} + u_{yy}\\right),\n$$\nwhere $\\kappa > 0$ is the constant diffusivity. Let the spatial discretization be the standard second-order centered finite difference Laplacian on a uniform Cartesian grid with periodic boundary conditions, and apply the Peaceman–Rachford (PR) Alternating Direction Implicit (ADI) splitting based on the Crank–Nicolson (CN) time discretization:\n$$\n\\left(I - \\frac{\\kappa \\Delta t}{2} D_{x}\\right)\\left(I - \\frac{\\kappa \\Delta t}{2} D_{y}\\right) u^{n+1}\n=\n\\left(I + \\frac{\\kappa \\Delta t}{2} D_{x}\\right)\\left(I + \\frac{\\kappa \\Delta t}{2} D_{y}\\right) u^{n},\n$$\nwhere $D_{x}$ and $D_{y}$ denote the discrete second-difference operators in $x$ and $y$, respectively, and $I$ denotes the identity operator. The discrete maximum principle is the property that if the grid function $u^{n}$ is elementwise nonnegative, then $u^{n+1}$ is also elementwise nonnegative.\n\nStarting from the definitions of the discrete operators and the Fourier diagonalization of convolution operators on the periodic grid, analytically derive the one-step amplification factor of the above PR–CN scheme for a discrete Fourier mode with wavenumbers $(\\theta_{x},\\theta_{y})$. Using only these fundamental facts, construct a scientifically sound scenario in which the discrete maximum principle fails for sufficiently large time step $\\Delta t$: specifically, identify a threshold time step $\\Delta t_{\\mathrm{th}}$ as a closed-form expression in terms of the grid spacing $h$ and the diffusivity $\\kappa$ such that for $\\Delta t > \\Delta t_{\\mathrm{th}}$ there exist nonnegative initial data for which the PR–CN update produces a negative value at some grid point.\n\nYour final answer must be the single analytic expression for $\\Delta t_{\\mathrm{th}}$ in terms of $h$ and $\\kappa$. No rounding is required.", "solution": "The problem requires the derivation of the threshold time step, $\\Delta t_{\\mathrm{th}}$, for which the Peaceman–Rachford (PR) Alternating Direction Implicit (ADI) scheme for the two-dimensional heat equation violates the discrete maximum principle. The analysis will proceed by first deriving the one-step amplification factor of the numerical scheme using discrete Fourier analysis and then determining the conditions under which this factor becomes negative, which is a necessary condition for the violation of the maximum principle.\n\nThe two-dimensional heat equation is given by:\n$$\n\\frac{\\partial u}{\\partial t} = \\kappa \\left( \\frac{\\partial^2 u}{\\partial x^2} + \\frac{\\partial^2 u}{\\partial y^2} \\right)\n$$\nwhere $\\kappa > 0$ is the diffusivity. We consider a uniform Cartesian grid with spacing $h$ in both directions. The standard second-order centered finite difference approximations for the second partial derivatives are given by the operators $D_x$ and $D_y$:\n$$\n(D_x u)_{j,k} = \\frac{u_{j+1,k} - 2u_{j,k} + u_{j-1,k}}{h^2}\n$$\n$$\n(D_y u)_{j,k} = \\frac{u_{j,k+1} - 2u_{j,k} + u_{j,k-1}}{h^2}\n$$\nThe PR–ADI-CN scheme is given as:\n$$\n\\left(I - \\frac{\\kappa \\Delta t}{2} D_{x}\\right)\\left(I - \\frac{\\kappa \\Delta t}{2} D_{y}\\right) u^{n+1} = \\left(I + \\frac{\\kappa \\Delta t}{2} D_{x}\\right)\\left(I + \\frac{\\kappa \\Delta t}{2} D_{y}\\right) u^{n}\n$$\n\nTo find the one-step amplification factor, we perform a von Neumann stability analysis. Due to the periodic boundary conditions, the eigenfunctions of the discrete operators $D_x$ and $D_y$ are the discrete Fourier modes. A generic Fourier mode is of the form $u^n_{j,k} = (G(\\theta_x, \\theta_y))^n \\exp(i(j\\theta_x + k\\theta_y))$, where $(\\theta_x, \\theta_y)$ are the dimensionless wavenumbers corresponding to the spatial frequencies and $G$ is the amplification factor.\n\nLet's find the eigenvalues of $D_x$ and $D_y$ corresponding to this mode. Applying $D_x$ to the spatial part $\\exp(i(j\\theta_x + k\\theta_y))$ yields:\n$$\nD_x \\exp(i(j\\theta_x + k\\theta_y)) = \\frac{\\exp(i((j+1)\\theta_x+k\\theta_y)) - 2\\exp(i(j\\theta_x+k\\theta_y)) + \\exp(i((j-1)\\theta_x+k\\theta_y))}{h^2}\n$$\n$$\n= \\frac{\\exp(i(j\\theta_x+k\\theta_y)) (\\exp(i\\theta_x) - 2 + \\exp(-i\\theta_x))}{h^2} = \\frac{2(\\cos(\\theta_x) - 1)}{h^2} \\exp(i(j\\theta_x+k\\theta_y))\n$$\nUsing the half-angle identity $1-\\cos(\\theta_x) = 2\\sin^2(\\theta_x/2)$, the eigenvalue of $D_x$, denoted $\\hat{D}_x$, is:\n$$\n\\hat{D}_x(\\theta_x) = -\\frac{4}{h^2}\\sin^2\\left(\\frac{\\theta_x}{2}\\right)\n$$\nSimilarly, the eigenvalue of $D_y$ is:\n$$\n\\hat{D}_y(\\theta_y) = -\\frac{4}{h^2}\\sin^2\\left(\\frac{\\theta_y}{2}\\right)\n$$\nThe dimensionless wavenumbers $\\theta_x$ and $\\theta_y$ range over $[-\\pi, \\pi]$. Consequently, $\\sin^2(\\theta_x/2)$ and $\\sin^2(\\theta_y/2)$ range over $[0, 1]$.\n\nSubstituting the mode $u^{n+1} = G u^n$ into the scheme and replacing the operators with their eigenvalues, we obtain an equation for the amplification factor $G$:\n$$\n\\left(1 - \\frac{\\kappa \\Delta t}{2} \\hat{D}_x\\right)\\left(1 - \\frac{\\kappa \\Delta t}{2} \\hat{D}_y\\right) G = \\left(1 + \\frac{\\kappa \\Delta t}{2} \\hat{D}_x\\right)\\left(1 + \\frac{\\kappa \\Delta t}{2} \\hat{D}_y\\right)\n$$\nSolving for $G(\\theta_x, \\theta_y)$:\n$$\nG(\\theta_x, \\theta_y) = \\frac{\\left(1 + \\frac{\\kappa \\Delta t}{2} \\hat{D}_x\\right)\\left(1 + \\frac{\\kappa \\Delta t}{2} \\hat{D}_y\\right)}{\\left(1 - \\frac{\\kappa \\Delta t}{2} \\hat{D}_x\\right)\\left(1 - \\frac{\\kappa \\Delta t}{2} \\hat{D}_y\\right)}\n$$\nSubstituting the expressions for the eigenvalues:\n$$\nG(\\theta_x, \\theta_y) = \\frac{\\left(1 - \\frac{2\\kappa \\Delta t}{h^2} \\sin^2\\left(\\frac{\\theta_x}{2}\\right)\\right) \\left(1 - \\frac{2\\kappa \\Delta t}{h^2} \\sin^2\\left(\\frac{\\theta_y}{2}\\right)\\right)}{\\left(1 + \\frac{2\\kappa \\Delta t}{h^2} \\sin^2\\left(\\frac{\\theta_x}{2}\\right)\\right) \\left(1 + \\frac{2\\kappa \\Delta t}{h^2} \\sin^2\\left(\\frac{\\theta_y}{2}\\right)\\right)}\n$$\nThe discrete maximum principle (DMP) states that if $u^n_{j,k} \\ge 0$ for all grid points $(j,k)$, then $u^{n+1}_{j,k} \\ge 0$ as well. A necessary condition for a linear, constant-coefficient scheme to satisfy the DMP is that its amplification factor must be non-negative for all wavenumbers, i.e., $G(\\theta_x, \\theta_y) \\ge 0$. If $G < 0$ for some mode, one can construct a non-negative initial condition (e.g., by adding a sufficiently large constant) that evolves to have negative values, thus violating the DMP.\n\nWe analyze the sign of $G(\\theta_x, \\theta_y)$. The denominator is a product of two terms of the form $(1 + C)$ where $C = \\frac{2\\kappa \\Delta t}{h^2} \\sin^2(\\cdot)$ is always non-negative. Thus, the denominator is always positive (and greater than or equal to $1$). The sign of $G$ is determined solely by the sign of its numerator.\nLet $N(\\theta_x, \\theta_y)$ be the numerator:\n$$\nN(\\theta_x, \\theta_y) = \\left(1 - \\frac{2\\kappa \\Delta t}{h^2} \\sin^2\\left(\\frac{\\theta_x}{2}\\right)\\right) \\left(1 - \\frac{2\\kappa \\Delta t}{h^2} \\sin^2\\left(\\frac{\\theta_y}{2}\\right)\\right)\n$$\nFor $G$ to be negative, the numerator must be negative. This occurs if one of the two factors in $N$ is positive and the other is negative.\n\nLet's define the dimensionless parameter $r = \\frac{2\\kappa \\Delta t}{h^2}$. Let $S_x = \\sin^2(\\theta_x/2)$ and $S_y = \\sin^2(\\theta_y/2)$. The factors are $(1 - rS_x)$ and $(1 - rS_y)$. The variables $S_x$ and $S_y$ can take any value in the interval $[0, 1]$ by choosing appropriate wavenumbers $\\theta_x, \\theta_y \\in [-\\pi, \\pi]$.\n\nThe DMP will fail if we can find $(\\theta_x, \\theta_y)$ such that, for instance, $(1 - rS_x) < 0$ and $(1 - rS_y) > 0$.\nThe condition $1 - rS_x < 0$ implies $rS_x > 1$.\nThe condition $1 - rS_y > 0$ implies $rS_y < 1$.\n\nFor the DMP to potentially fail, there must exist a mode $\\theta_x$ such that $rS_x > 1$. Since the maximum value of $S_x$ is $1$ (for $\\theta_x = \\pi$), this inequality can only be satisfied if $r > 1$.\nIf $r > 1$, we can choose a high-frequency mode in the $x$-direction, say $\\theta_x = \\pi$, for which $S_x = \\sin^2(\\pi/2) = 1$. For this mode, the factor is $(1 - r) < 0$.\nSimultaneously, we can choose a low-frequency mode in the $y$-direction, say $\\theta_y = 0$, for which $S_y = \\sin^2(0) = 0$. For this mode, the factor is $(1 - 0) = 1 > 0$.\nWith this choice of wavenumbers $(\\theta_x, \\theta_y) = (\\pi, 0)$, the numerator is $N = (1-r)(1) < 0$, and thus the amplification factor $G$ is negative. This demonstrates that the DMP is violated for $r>1$.\n\nIf $r \\le 1$, then for any mode $\\theta_x$, we have $rS_x \\le 1 \\cdot S_x \\le 1$. Therefore, the factor $(1 - rS_x)$ is always non-negative. The same holds for the $y$-direction factor. The product of two non-negative numbers is non-negative, so $N(\\theta_x, \\theta_y) \\ge 0$ for all modes. In this case, this necessary condition for the DMP is satisfied.\n\nThe threshold for failure of the discrete maximum principle occurs precisely at the boundary of the condition $r>1$. The threshold value is $r=1$.\nSubstituting back the definition of $r$:\n$$\n\\frac{2\\kappa \\Delta t}{h^2} = 1\n$$\nSolving for the threshold time step, $\\Delta t_{\\mathrm{th}}$:\n$$\n\\Delta t_{\\mathrm{th}} = \\frac{h^2}{2\\kappa}\n$$\nFor any time step $\\Delta t > \\Delta t_{\\mathrm{th}}$, there exist Fourier modes for which the amplification factor is negative, creating a scenario where a non-negative initial condition can evolve to have negative values, thereby violating the discrete maximum principle.", "answer": "$$\\boxed{\\frac{h^{2}}{2\\kappa}}$$", "id": "3427476"}, {"introduction": "A cornerstone of scientific computing is the ability to verify that a program correctly solves the equation it is intended to model. The Method of Manufactured Solutions (MMS) is a powerful and general technique for this purpose, allowing for rigorous testing of a code's implementation and its order of accuracy. This practice provides hands-on experience with MMS by requiring you to derive the appropriate source term that forces a chosen analytic function to be an exact solution to the anisotropic diffusion equation, thereby creating a benchmark against which a numerical solver can be validated [@problem_id:3427454].", "problem": "Consider the linear anisotropic diffusion equation in two spatial dimensions on the unit square $\\Omega=(0,1)\\times(0,1)$ with homogeneous Dirichlet boundary condition and a smooth source term:\n$$\nu_{t} = a\\,u_{xx} + b\\,u_{yy} + f(x,y,t), \\quad (x,y)\\in\\Omega,\\ t>0,\n$$\n$$\nu(x,y,t)=0 \\text{ for } (x,y)\\in\\partial\\Omega,\\ t\\ge 0,\n$$\nand initial condition\n$$\nu(x,y,0) = \\sin(\\pi x)\\sin(2\\pi y).\n$$\nLet the anisotropy coefficients be $a=1$ and $b=4$. You will use the method of manufactured solutions by prescribing the exact solution\n$$\nu(x,y,t) = \\exp(-t)\\,\\sin(\\pi x)\\,\\sin(2\\pi y),\n$$\nand determining the forcing term $f(x,y,t)$ so that $u$ satisfies the partial differential equation and boundary and initial conditions exactly.\n\nIn addition, consider advancing the solution in time by a Strang alternating direction implicit (ADI) operator splitting that treats $a\\,u_{xx}$ and $b\\,u_{yy}$ as the split operators. Assume all spatial discretizations are of sufficiently high order so that the temporal accuracy dominates, and assume the exact solution is smooth enough to justify the formal temporal order. State the expected theoretical temporal order of accuracy $r$ for the Strang-ADI time discretization in this linear setting.\n\nReport your final answer as a two-entry row vector, whose first entry is the closed-form analytic expression for $f(x,y,t)$, and whose second entry is the integer temporal order $r$. No rounding is required and no units are involved.", "solution": "The problem consists of two parts. The first part is to determine the forcing term $f(x,y,t)$ for a given partial differential equation (PDE) and a prescribed \"manufactured\" solution $u(x,y,t)$. The second part is to state the theoretical temporal order of accuracy for the Strang alternating direction implicit (ADI) method applied to this PDE.\n\nFirst, I will validate the problem statement.\nAll givens are extracted and checked for consistency.\nThe PDE is $u_{t} = a\\,u_{xx} + b\\,u_{yy} + f(x,y,t)$, with $a=1$ and $b=4$.\nThe domain is $\\Omega=(0,1)\\times(0,1)$ with homogeneous Dirichlet boundary conditions $u(x,y,t)=0$ for $(x,y)\\in\\partial\\Omega$.\nThe initial condition is $u(x,y,0) = \\sin(\\pi x)\\sin(2\\pi y)$.\nThe prescribed solution is $u(x,y,t) = \\exp(-t)\\,\\sin(\\pi x)\\,\\sin(2\\pi y)$.\nLet's check consistency.\nAt $t=0$, the prescribed solution is $u(x,y,0) = \\exp(-0)\\,\\sin(\\pi x)\\,\\sin(2\\pi y) = \\sin(\\pi x)\\sin(2\\pi y)$, which matches the initial condition.\nOn the boundaries of $\\Omega$:\nAt $x=0$: $u(0,y,t) = \\exp(-t)\\,\\sin(0)\\,\\sin(2\\pi y) = 0$.\nAt $x=1$: $u(1,y,t) = \\exp(-t)\\,\\sin(\\pi)\\,\\sin(2\\pi y) = 0$.\nAt $y=0$: $u(x,0,t) = \\exp(-t)\\,\\sin(\\pi x)\\,\\sin(0) = 0$.\nAt $y=1$: $u(x,1,t) = \\exp(-t)\\,\\sin(\\pi x)\\,\\sin(2\\pi) = 0$.\nAll boundary and initial conditions are satisfied by the prescribed solution. The problem is scientifically grounded, well-posed, and contains no contradictions or ambiguities. The problem is valid.\n\nPart 1: Determination of the forcing term $f(x,y,t)$.\nThe forcing term $f(x,y,t)$ can be isolated from the PDE:\n$$\nf(x,y,t) = u_t - a\\,u_{xx} - b\\,u_{yy}\n$$\nWe need to compute the partial derivatives of the prescribed solution $u(x,y,t) = \\exp(-t)\\,\\sin(\\pi x)\\,\\sin(2\\pi y)$.\n\nThe partial derivative with respect to time $t$ is:\n$$\nu_t = \\frac{\\partial}{\\partial t}\\left(\\exp(-t)\\,\\sin(\\pi x)\\,\\sin(2\\pi y)\\right) = -\\exp(-t)\\,\\sin(\\pi x)\\,\\sin(2\\pi y)\n$$\nThe first and second partial derivatives with respect to $x$ are:\n$$\nu_x = \\frac{\\partial}{\\partial x}\\left(\\exp(-t)\\,\\sin(\\pi x)\\,\\sin(2\\pi y)\\right) = \\pi\\exp(-t)\\,\\cos(\\pi x)\\,\\sin(2\\pi y)\n$$\n$$\nu_{xx} = \\frac{\\partial}{\\partial x}\\left(\\pi\\exp(-t)\\,\\cos(\\pi x)\\,\\sin(2\\pi y)\\right) = -\\pi^2\\exp(-t)\\,\\sin(\\pi x)\\,\\sin(2\\pi y)\n$$\nThe first and second partial derivatives with respect to $y$ are:\n$$\nu_y = \\frac{\\partial}{\\partial y}\\left(\\exp(-t)\\,\\sin(\\pi x)\\,\\sin(2\\pi y)\\right) = 2\\pi\\exp(-t)\\,\\sin(\\pi x)\\,\\cos(2\\pi y)\n$$\n$$\nu_{yy} = \\frac{\\partial}{\\partial y}\\left(2\\pi\\exp(-t)\\,\\sin(\\pi x)\\,\\cos(2\\pi y)\\right) = -4\\pi^2\\exp(-t)\\,\\sin(\\pi x)\\,\\sin(2\\pi y)\n$$\nNow, substitute these derivatives along with the coefficients $a=1$ and $b=4$ into the expression for $f(x,y,t)$:\n$$\nf(x,y,t) = \\left(-\\exp(-t)\\,\\sin(\\pi x)\\,\\sin(2\\pi y)\\right) - (1)\\left(-\\pi^2\\exp(-t)\\,\\sin(\\pi x)\\,\\sin(2\\pi y)\\right) - (4)\\left(-4\\pi^2\\exp(-t)\\,\\sin(\\pi x)\\,\\sin(2\\pi y)\\right)\n$$\nWe can factor out the common term $\\exp(-t)\\,\\sin(\\pi x)\\,\\sin(2\\pi y)$:\n$$\nf(x,y,t) = \\left(-1 - (-\\pi^2) - 4(-4\\pi^2)\\right)\\exp(-t)\\,\\sin(\\pi x)\\,\\sin(2\\pi y)\n$$\n$$\nf(x,y,t) = \\left(-1 + \\pi^2 + 16\\pi^2\\right)\\exp(-t)\\,\\sin(\\pi x)\\,\\sin(2\\pi y)\n$$\n$$\nf(x,y,t) = \\left(17\\pi^2 - 1\\right)\\exp(-t)\\,\\sin(\\pi x)\\,\\sin(2\\pi y)\n$$\nThis is the closed-form analytic expression for the forcing term.\n\nPart 2: Temporal order of accuracy $r$ for Strang-ADI.\nThe given PDE is of the form $u_t = \\mathcal{L}u + f$, where the linear operator $\\mathcal{L}$ is split into two parts, $\\mathcal{L} = \\mathcal{L}_x + \\mathcal{L}_y$, with $\\mathcal{L}_x = a\\frac{\\partial^2}{\\partial x^2}$ and $\\mathcal{L}_y = b\\frac{\\partial^2}{\\partial y^2}$.\n\nOperator splitting methods approximate the solution to the full equation by solving a sequence of simpler subproblems. Strang splitting is a symmetric composition of steps, which for a time step of size $\\Delta t$ can be written as:\n$$\nu^{n+1} \\approx \\mathcal{S}_x(\\Delta t/2) \\mathcal{S}_y(\\Delta t) \\mathcal{S}_x(\\Delta t/2) u^n\n$$\nwhere $\\mathcal{S}_x(\\tau)$ and $\\mathcal{S}_y(\\tau)$ are the evolution operators for the subproblems $u_t = \\mathcal{L}_x u$ and $u_t = \\mathcal{L}_y u$ over a time interval $\\tau$.\n\nThis symmetric composition ensures that the method is second-order accurate in time, provided the individual propagators $\\mathcal{S}_x$ and $\\mathcal{S}_y$ are at least first-order accurate. In the context of ADI methods, each sub-step is typically solved using the Crank-Nicolson method, which is itself second-order accurate. The Crank-Nicolson propagator for a step of size $\\tau$ is an approximation to the exact exponential operator, with an error of order $O(\\tau^3)$.\n$$\n\\mathcal{S}_{\\text{CN}}(\\tau) = \\exp(\\tau \\mathcal{L}) + O(\\tau^3)\n$$\nThe local truncation error of the Strang splitting composition can be found by Taylor series expansion of the operator exponentials. The composition `exp(Δt/2 A) exp(Δt B) exp(Δt/2 A)` matches the expansion of `exp(Δt(A+B))` up to terms of order $(\\Delta t)^2$. The first error term is of order $(\\Delta t)^3$, related to the commutators of the operators $A$ and $B$. Thus, the local truncation error of the Strang splitting method is $O((\\Delta t)^3)$.\n\nFor a numerical method with a local truncation error of order $p+1$, the global error is of order $p$. Therefore, with a local truncation error of $O((\\Delta t)^3)$, the global temporal order of accuracy for the Strang splitting method is $2$.\nThis holds in general for linear problems, regardless of whether the operators $\\mathcal{L}_x$ and $\\mathcal{L}_y$ commute. In this specific problem, since the operators consist of partial derivatives with respect to different independent variables (and constant coefficients), they do commute: $\\mathcal{L}_x\\mathcal{L}_y u = \\mathcal{L}_y\\mathcal{L}_x u$ for sufficiently smooth $u$. This commutativity simplifies the analysis and confirms the second-order accuracy, but it is not a requirement for Strang splitting to be second-order.\n\nThe expected theoretical temporal order of accuracy $r$ is therefore $2$.\n\nThe final answer consists of two parts: the expression for $f(x,y,t)$ and the integer value of $r$.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n(17\\pi^2 - 1)\\exp(-t)\\sin(\\pi x)\\sin(2\\pi y) & 2\n\\end{pmatrix}\n}\n$$", "id": "3427454"}]}