{"hands_on_practices": [{"introduction": "The foundation of selecting a numerical scheme lies in understanding its inherent error. This analytical exercise delves into the local truncation error (LTE) for the steady advection-diffusion equation. By deriving the leading error terms for both the second-order central difference and first-order upwind schemes, you will uncover the fundamental trade-off: the dispersive, higher-order error of the central scheme versus the dissipative, lower-order error of the upwind scheme. This analysis forms the theoretical basis for why scheme selection is critically dependent on the Péclet number [@problem_id:3430230].", "problem": "Consider the one-dimensional, steady convection–diffusion equation\n$$- \\nu\\, u''(x) + a\\, u'(x) = f(x),$$\nposed on a smooth solution domain with a uniform grid of spacing $\\Delta x > 0$ and constant parameters $\\nu > 0$ and $a > 0$. Assume $u \\in C^{4}$ so that all derivatives up to order four exist and are bounded. Define the cell Péclet number (Péclet number) by\n$$Pe = \\frac{a\\, \\Delta x}{\\nu}.$$\nDiscretize the diffusion term with the standard second-order central difference and consider two alternatives for the convection term at a grid point $x_i$:\n- the second-order central difference for $u'(x_i)$, and\n- the first-order upwind (backward) difference for $u'(x_i)$ when $a > 0$.\nStarting from Taylor expansions about $x_i$, derive the local truncation error at $x_i$ for both discretizations up to and including the leading nonzero terms, expressed in terms of $u^{(k)}(x_i)$, $\\nu$, $a$, and $\\Delta x$. Then, motivated by a data-driven modeling scenario, suppose a regression on high-resolution training fields has produced the conditional expectation\n$$\\mathbb{E}\\!\\left[\\frac{|u^{(3)}(x_i)|}{|u''(x_i)|}\\,\\Big|\\,Pe\\right] = c\\, \\frac{Pe}{\\Delta x},$$\nwith a fitted constant $c = 1.72$ valid over the operating range of interest. Use this model to propose an automatic scheme-switching threshold by equating the expected magnitudes of the leading convective truncation errors of the central and upwind discretizations, and solve for the threshold $Pe^{\\ast}$. Express your final answer as a pure number (no units) and round your answer to four significant figures.", "solution": "The problem is evaluated as valid based on the specified criteria. It is scientifically grounded, well-posed, objective, and contains sufficient information to derive a unique solution.\n\nThe objective is to find a threshold Péclet number, $Pe^{\\ast}$, for switching between a central difference scheme and an upwind scheme for the convection term in the one-dimensional, steady convection–diffusion equation. The equation is given by\n$$ - \\nu\\, u''(x) + a\\, u'(x) = f(x) $$\nwith constant parameters $\\nu > 0$ and $a > 0$. The threshold $Pe^{\\ast}$ is determined by equating the expected magnitudes of the leading convective truncation errors for the two schemes.\n\nFirst, we derive the local truncation error for the discretization of the convective term, $a u'(x)$, at a grid point $x_i$. We use Taylor series expansions for $u(x)$ around $x_i$, assuming the solution $u$ is sufficiently smooth ($u \\in C^4$). Let $u_i = u(x_i)$, $u_{i+1} = u(x_i + \\Delta x)$, and $u_{i-1} = u(x_i - \\Delta x)$. The expansions are:\n$$ u_{i+1} = u_i + u'_i \\Delta x + \\frac{u''_i}{2!} (\\Delta x)^2 + \\frac{u'''_i}{3!} (\\Delta x)^3 + \\frac{u^{(4)}_i}{4!} (\\Delta x)^4 + O((\\Delta x)^5) $$\n$$ u_{i-1} = u_i - u'_i \\Delta x + \\frac{u''_i}{2!} (\\Delta x)^2 - \\frac{u'''_i}{3!} (\\Delta x)^3 + \\frac{u^{(4)}_i}{4!} (\\Delta x)^4 + O((\\Delta x)^5) $$\n\nThe problem asks to consider two discretizations for the first derivative term $u'(x_i)$.\n\n1.  **Second-Order Central Difference Scheme:**\n    The approximation for $u'(x_i)$ is given by $\\frac{u_{i+1} - u_{i-1}}{2\\Delta x}$. To find the truncation error, we substitute the Taylor expansions:\n    $$ u_{i+1} - u_{i-1} = \\left(u_i + u'_i \\Delta x + \\frac{u''_i}{2}(\\Delta x)^2 + \\frac{u'''_i}{6}(\\Delta x)^3 + \\dots\\right) - \\left(u_i - u'_i \\Delta x + \\frac{u''_i}{2}(\\Delta x)^2 - \\frac{u'''_i}{6}(\\Delta x)^3 + \\dots\\right) $$\n    $$ u_{i+1} - u_{i-1} = 2u'_i \\Delta x + \\frac{2u'''_i}{6}(\\Delta x)^3 + O((\\Delta x)^5) = 2u'_i \\Delta x + \\frac{u'''_i}{3}(\\Delta x)^3 + O((\\Delta x)^5) $$\n    Dividing by $2\\Delta x$ gives the expression for the discretized derivative:\n    $$ \\frac{u_{i+1} - u_{i-1}}{2\\Delta x} = u'_i + \\frac{u'''_i}{6}(\\Delta x)^2 + O((\\Delta x)^4) $$\n    The local truncation error for the convective term, $\\tau_{conv}^{CD}$, is the difference between the discretized term and the exact term:\n    $$ \\tau_{conv}^{CD} = a \\left(\\frac{u_{i+1} - u_{i-1}}{2\\Delta x}\\right) - a u'_i = a \\left(u'_i + \\frac{u'''_i}{6}(\\Delta x)^2 + O((\\Delta x)^4)\\right) - a u'_i $$\n    The leading nonzero term of the convective truncation error for the central difference scheme is:\n    $$ \\tau_{conv, leading}^{CD} = a \\frac{u'''(x_i)}{6}(\\Delta x)^2 $$\n\n2.  **First-Order Upwind (Backward) Difference Scheme:**\n    Since $a > 0$, the upwind direction is opposite to the flow, so we use a backward difference. The approximation for $u'(x_i)$ is $\\frac{u_i - u_{i-1}}{\\Delta x}$. Using the Taylor expansion for $u_{i-1}$:\n    $$ \\frac{u_i - u_{i-1}}{\\Delta x} = \\frac{1}{\\Delta x} \\left(u_i - \\left(u_i - u'_i \\Delta x + \\frac{u''_i}{2}(\\Delta x)^2 - \\frac{u'''_i}{6}(\\Delta x)^3 + \\dots\\right)\\right) $$\n    $$ \\frac{u_i - u_{i-1}}{\\Delta x} = \\frac{1}{\\Delta x} \\left(u'_i \\Delta x - \\frac{u''_i}{2}(\\Delta x)^2 + \\frac{u'''_i}{6}(\\Delta x)^3 - \\dots\\right) = u'_i - \\frac{u''_i}{2}\\Delta x + O((\\Delta x)^2) $$\n    The local truncation error for the convective term, $\\tau_{conv}^{UW}$, is:\n    $$ \\tau_{conv}^{UW} = a \\left(\\frac{u_i - u_{i-1}}{\\Delta x}\\right) - a u'_i = a \\left(u'_i - \\frac{u''_i}{2}\\Delta x + O((\\Delta x)^2)\\right) - a u'_i $$\n    The leading nonzero term of the convective truncation error for the upwind scheme is:\n    $$ \\tau_{conv, leading}^{UW} = -a \\frac{u''(x_i)}{2}\\Delta x $$\n\nThe next step is to find the threshold $Pe^{\\ast}$ by equating the expected magnitudes of these leading errors.\nThe magnitudes are:\n$$ |\\tau_{conv, leading}^{CD}| = \\left|a \\frac{u'''(x_i)}{6}(\\Delta x)^2\\right| = \\frac{a(\\Delta x)^2}{6}|u'''(x_i)| $$\n$$ |\\tau_{conv, leading}^{UW}| = \\left|-a \\frac{u''(x_i)}{2}\\Delta x\\right| = \\frac{a \\Delta x}{2}|u''(x_i)| $$\nThe switching condition is $\\mathbb{E}[|\\tau_{conv, leading}^{CD}| \\,|\\, Pe^{\\ast}] = \\mathbb{E}[|\\tau_{conv, leading}^{UW}| \\,|\\, Pe^{\\ast}]$.\n$$ \\mathbb{E}\\left[\\frac{a(\\Delta x)^2}{6}|u'''(x_i)| \\,\\Big|\\, Pe^{\\ast}\\right] = \\mathbb{E}\\left[\\frac{a \\Delta x}{2}|u''(x_i)| \\,\\Big|\\, Pe^{\\ast}\\right] $$\nSince $a$ and $\\Delta x$ are constants, we can write:\n$$ \\frac{a(\\Delta x)^2}{6}\\mathbb{E}[|u'''(x_i)| \\,|\\, Pe^{\\ast}] = \\frac{a \\Delta x}{2}\\mathbb{E}[|u''(x_i)| \\,|\\, Pe^{\\ast}] $$\nTo proceed, we use the provided data-driven model:\n$$ \\mathbb{E}\\!\\left[\\frac{|u^{(3)}(x_i)|}{|u''(x_i)|}\\,\\Big|\\,Pe\\right] = c\\, \\frac{Pe}{\\Delta x} $$\nwhere $c = 1.72$. Let $R = \\frac{|u^{(3)}(x_i)|}{|u''(x_i)|}$. Then $|u'''(x_i)| = R \\cdot |u''(x_i)|$. Taking the expectation, we get $\\mathbb{E}[|u'''(x_i)|] = \\mathbb{E}[R \\cdot |u''(x_i)|]$. In the context of this data-driven modeling problem, we make the reasonable assumption that the random variables $R$ and $|u''(x_i)|$ are uncorrelated. Therefore, $\\mathbb{E}[R \\cdot |u''(x_i)|] \\approx \\mathbb{E}[R]\\mathbb{E}[|u''(x_i)|]$. Applying this to our equality at the threshold $Pe^{\\ast}$:\n$$ \\frac{a(\\Delta x)^2}{6}\\mathbb{E}\\left[\\frac{|u'''(x_i)|}{|u''(x_i)|} \\,\\Big|\\, Pe^{\\ast}\\right]\\mathbb{E}[|u''(x_i)| \\,|\\, Pe^{\\ast}] = \\frac{a \\Delta x}{2}\\mathbb{E}[|u''(x_i)| \\,|\\, Pe^{\\ast}] $$\nAssuming the solution is not trivial, $\\mathbb{E}[|u''(x_i)| \\,|\\, Pe^{\\ast}]$ is non-zero, so we can divide both sides by it, and also by $\\frac{a \\Delta x}{2}$:\n$$ \\frac{\\Delta x}{3}\\mathbb{E}\\left[\\frac{|u'''(x_i)|}{|u''(x_i)|} \\,\\Big|\\, Pe^{\\ast}\\right] = 1 $$\nNow, we substitute the given model for the conditional expectation at $Pe = Pe^{\\ast}$:\n$$ \\frac{\\Delta x}{3} \\left(c \\frac{Pe^{\\ast}}{\\Delta x}\\right) = 1 $$\nSimplifying the expression:\n$$ \\frac{c \\, Pe^{\\ast}}{3} = 1 $$\nSolving for the threshold Péclet number $Pe^{\\ast}$:\n$$ Pe^{\\ast} = \\frac{3}{c} $$\nGiven the fitted constant $c = 1.72$, we can calculate the numerical value for $Pe^{\\ast}$:\n$$ Pe^{\\ast} = \\frac{3}{1.72} \\approx 1.7441860465... $$\nThe problem asks for the answer to be rounded to four significant figures.\n$$ Pe^{\\ast} \\approx 1.744 $$", "answer": "$$\\boxed{1.744}$$", "id": "3430230"}, {"introduction": "Theoretical analysis provides the \"why,\" but computational practice provides the crucial \"what.\" This exercise bridges that gap by having you implement and compare the central and upwind schemes for a classic boundary value problem. By computing error norms against the exact solution and checking for the preservation of physical properties like monotonicity across a range of Péclet numbers, you will gain a concrete, quantitative understanding of the phenomena predicted by theory, including the emergence of non-physical oscillations when a central scheme is used inappropriately [@problem_id:3430298].", "problem": "Consider the steady one-dimensional linear convection-diffusion boundary value problem on the interval $[0,1]$ with constant coefficients,\n$$-\\,\\kappa\\,u''(x) + \\beta\\,u'(x) = 0,\\quad x\\in(0,1),$$\nwith Dirichlet boundary conditions\n$$u(0)=1,\\quad u(1)=0.$$\nAssume $\\kappa>0$ and $\\beta\\in\\mathbb{R}$. The exact solution for constant $\\kappa$ and $\\beta$ is well-defined and strictly monotone between the boundary values. Define the cell Péclet number (dimensionless) by\n$$Pe = \\frac{\\beta\\,h}{\\kappa},$$\nwhere $h$ is the uniform grid spacing on a uniform partition of $[0,1]$ into $N$ equal subintervals, so $h=1/N$.\n\nYou will implement two consistent finite difference discretizations on a uniform grid with $N$ subintervals (grid nodes $x_i=i\\,h$ for $i=0,1,\\dots,N$), using the following principles:\n- Approximate the diffusion operator $-\\,\\kappa\\,u''(x)$ with the standard second-order central difference on interior nodes.\n- Approximate the convection operator $\\beta\\,u'(x)$ in two ways:\n  - Central differencing (second-order): using the centered difference on interior nodes.\n  - First-order upwind differencing: using one-sided differences aligned with the sign of $\\beta$ on interior nodes.\n\nImpose the boundary conditions strongly at $x_0=0$ and $x_N=1$. Assemble and solve the resulting linear system for the interior unknowns to obtain the grid solution $\\{u_i\\}_{i=0}^N$ for each scheme. Let $u^{\\mathrm{CD}}$ denote the numerical solution computed with central differencing for the convection term, and $u^{\\mathrm{UD}}$ the solution computed with upwind differencing for the convection term.\n\nDefine the following error measures with respect to the exact solution $u(x)$:\n- The discrete $L^2$-norm (using the trapezoidal rule):\n$$\\|e\\|_{L^2_h} \\;=\\;\\bigg(h\\Big(\\tfrac{1}{2}\\,e_0^2 + \\sum_{i=1}^{N-1} e_i^2 + \\tfrac{1}{2}\\,e_N^2\\Big)\\bigg)^{1/2},\\quad e_i = u_i - u(x_i).$$\n- The discrete $H^1$ seminorm (piecewise linear reconstruction):\n$$|e|_{H^1_h} \\;=\\;\\bigg(\\sum_{i=0}^{N-1} h\\,\\Big(\\frac{e_{i+1}-e_i}{h}\\Big)^2\\bigg)^{1/2}\\;=\\;\\bigg(\\frac{1}{h}\\sum_{i=0}^{N-1} (e_{i+1}-e_i)^2\\bigg)^{1/2}.$$\n\nAdditionally, define a monotonicity indicator for a grid function $v_i$ as the boolean value that is true if and only if the sequence is nonincreasing across the grid, that is,\n$$v_{i+1} \\le v_i \\;\\text{ for all } i=0,1,\\dots,N-1,$$\nup to a numerical tolerance of $10^{-10}$.\n\nImplement both schemes and compute $\\|e\\|_{L^2_h}$ and $|e|_{H^1_h}$ for each scheme. Also compute the monotonicity indicator for each scheme.\n\nFinally, implement a local scheme selection rule based solely on the cell Péclet number $Pe$:\n- Choose central differencing if $|Pe|\\le 2$.\n- Choose upwind differencing if $|Pe| > 2$.\n\nThe goal is to quantify how $Pe$ influences the appropriateness of the scheme via error norms and monotonicity, and to report which scheme the $Pe$-based rule selects.\n\nTest Suite:\nUse the following $5$ test cases, each specified by $(\\beta,\\kappa,N)$:\n- Case $1$: $(\\beta,\\kappa,N) = (0.2,\\,1.0,\\,50)$.\n- Case $2$: $(\\beta,\\kappa,N) = (1.0,\\,0.02,\\,25)$.\n- Case $3$: $(\\beta,\\kappa,N) = (1.0,\\,0.02,\\,10)$.\n- Case $4$: $(\\beta,\\kappa,N) = (2.0,\\,0.02,\\,20)$.\n- Case $5$: $(\\beta,\\kappa,N) = (-1.0,\\,0.05,\\,10)$.\n\nFor each case, your program must:\n- Compute $u^{\\mathrm{CD}}$ and $u^{\\mathrm{UD}}$ on the grid.\n- Compute $\\|e^{\\mathrm{CD}}\\|_{L^2_h}$, $\\|e^{\\mathrm{UD}}\\|_{L^2_h}$, $|e^{\\mathrm{CD}}|_{H^1_h}$, $|e^{\\mathrm{UD}}|_{H^1_h}$, and the monotonicity indicators for $u^{\\mathrm{CD}}$ and $u^{\\mathrm{UD}}$.\n- Compute the cell Péclet number $Pe=\\beta h/\\kappa$ and apply the selection rule to return a scheme code: $0$ for central differencing and $1$ for upwind differencing.\n\nFinal Output Format:\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. For each test case in the order listed above, output a sublist with the following $7$ entries:\n- The integer scheme code selected by the $Pe$ rule ($0$ for central, $1$ for upwind).\n- The floating-point value of $\\|e^{\\mathrm{CD}}\\|_{L^2_h}$.\n- The floating-point value of $\\|e^{\\mathrm{UD}}\\|_{L^2_h}$.\n- The floating-point value of $|e^{\\mathrm{CD}}|_{H^1_h}$.\n- The floating-point value of $|e^{\\mathrm{UD}}|_{H^1_h}$.\n- The boolean monotonicity indicator for $u^{\\mathrm{CD}}$.\n- The boolean monotonicity indicator for $u^{\\mathrm{UD}}$.\n\nThus the overall output has the form\n$$[\\,[\\text{scheme},\\,L2_{\\mathrm{CD}},\\,L2_{\\mathrm{UD}},\\,H1_{\\mathrm{CD}},\\,H1_{\\mathrm{UD}},\\,\\text{mono}_{\\mathrm{CD}},\\,\\text{mono}_{\\mathrm{UD}}],\\ \\dots\\ ].$$\nAll quantities are dimensionless. The program must not read input and must hard-code the test cases above. The output must be exactly one line in the specified format.", "solution": "The user wants to solve a steady one-dimensional convection-diffusion boundary value problem and analyze the performance of two finite difference schemes.\n\n### Step 1: Problem Validation\n\nThe problem is stated as:\n- **PDE**: $-\\kappa u''(x) + \\beta u'(x) = 0$ on $x \\in (0,1)$.\n- **Boundary Conditions**: $u(0)=1$, $u(1)=0$.\n- **Parameters**: $\\kappa > 0$, $\\beta \\in \\mathbb{R}$.\n\nThe task involves:\n1.  Deriving the analytical solution.\n2.  Discretizing the PDE using two schemes on a uniform grid with $N$ intervals and spacing $h=1/N$:\n    -   Central differencing (CD) for both diffusion and convection.\n    -   Central differencing for diffusion and first-order upwind differencing (UD) for convection.\n3.  Solving the resulting linear systems for the nodal values $\\{u_i\\}_{i=0}^N$.\n4.  Calculating specified error norms (discrete $L^2$ and $H^1$ seminorm) and a monotonicity indicator for both schemes.\n5.  Implementing a scheme selection rule based on the cell Péclet number, $Pe = \\frac{\\beta h}{\\kappa}$.\n6.  Running a suite of test cases and reporting the results in a specified format.\n\nThe problem is a classic exercise in the numerical analysis of partial differential equations. It is scientifically sound, well-posed, objective, and fully specified. The differential equation, boundary conditions, numerical methods, and analysis metrics are all standard and well-defined in the field of computational science and engineering. There are no contradictions, ambiguities, or invalid premises.\n\nThe validation verdict is **valid**.\n\n### Step 2: Analytical Solution\n\nThe governing ordinary differential equation is a second-order linear homogeneous equation with constant coefficients:\n$$-\\kappa u'' + \\beta u' = 0$$\nThe characteristic equation is $-\\kappa r^2 + \\beta r = 0$, which gives $r(-\\kappa r + \\beta) = 0$. The roots are $r_1 = 0$ and $r_2 = \\beta/\\kappa$.\n\n-   If $\\beta = 0$, the roots are repeated ($r_1=r_2=0$), and the general solution is $u(x) = C_1 + C_2 x$. Applying the boundary conditions $u(0)=1$ and $u(1)=0$ yields $C_1=1$ and $C_2=-1$, so $u(x) = 1-x$.\n\n-   If $\\beta \\neq 0$, the roots are distinct, and the general solution is $u(x) = C_1 e^{r_1 x} + C_2 e^{r_2 x} = C_1 + C_2 e^{(\\beta/\\kappa)x}$. Applying the boundary conditions:\n    -   $u(0) = C_1 + C_2 = 1$\n    -   $u(1) = C_1 + C_2 e^{\\beta/\\kappa} = 0$\n    Solving this system for $C_1$ and $C_2$ gives:\n    $$C_1 = \\frac{e^{\\beta/\\kappa}}{e^{\\beta/\\kappa} - 1}, \\quad C_2 = -\\frac{1}{e^{\\beta/\\kappa} - 1}$$\n    The exact solution is therefore:\n    $$u(x) = \\frac{e^{\\beta/\\kappa} - e^{(\\beta/\\kappa)x}}{e^{\\beta/\\kappa} - 1}$$\nFor numerical stability when $\\beta/\\kappa$ is a large positive number, this can be rewritten as:\n$$u(x) = \\frac{1 - e^{(\\beta/\\kappa)(x-1)}}{1 - e^{-\\beta/\\kappa}}$$\n\n### Step 3: Finite Difference Discretization\n\nWe discretize the equation at interior grid nodes $x_i = ih$ for $i=1, \\dots, N-1$. The general form of the discretized equation is:\n$$-\\kappa \\frac{u_{i+1} - 2u_i + u_{i-1}}{h^2} + \\beta (\\text{approx. of } u'(x_i)) = 0$$\nWe rearrange this to form a linear system $A \\mathbf{u}_{\\text{int}} = \\mathbf{b}$ for the interior unknowns $\\mathbf{u}_{\\text{int}} = [u_1, \\dots, u_{N-1}]^T$. The boundary values $u_0=1$ and $u_N=0$ are moved to the right-hand side.\n\n**Scheme 1: Central Differencing (CD)**\nThe convection term is approximated by $\\beta u'(x_i) \\approx \\beta \\frac{u_{i+1} - u_{i-1}}{2h}$. The discrete equation becomes:\n$$ \\left(-\\frac{\\kappa}{h^2} - \\frac{\\beta}{2h}\\right)u_{i-1} + \\left(\\frac{2\\kappa}{h^2}\\right)u_i + \\left(-\\frac{\\kappa}{h^2} + \\frac{\\beta}{2h}\\right)u_{i+1} = 0 $$\nMultiplying by $h^2$ gives the coefficients for the tridiagonal system matrix $A_{CD}$:\n-   Lower diagonal: $l_i = -\\kappa - \\frac{\\beta h}{2}$\n-   Main diagonal: $d_i = 2\\kappa$\n-   Upper diagonal: $u_i = -\\kappa + \\frac{\\beta h}{2}$\nThe right-hand side vector $\\mathbf{b}_{CD}$ is zero except for the first entry, which incorporates the $u_0=1$ boundary condition: $b_1 = -l_1 u_0 = \\kappa + \\frac{\\beta h}{2}$.\n\n**Scheme 2: Upwind Differencing (UD)**\nThe convection term approximation depends on the sign of $\\beta$:\n-   If $\\beta \\ge 0$ (flow from left to right), use a backward difference: $\\beta u'(x_i) \\approx \\beta \\frac{u_i - u_{i-1}}{h}$.\n-   If $\\beta < 0$ (flow from right to left), use a forward difference: $\\beta u'(x_i) \\approx \\beta \\frac{u_{i+1} - u_i}{h}$.\n\nThis leads to the following coefficients for the tridiagonal system matrix $A_{UD}$:\n-   If $\\beta \\ge 0$:\n    -   $l_i = -\\kappa - \\beta h$\n    -   $d_i = 2\\kappa + \\beta h$\n    -   $u_i = -\\kappa$\n    -   $b_1 = -l_1 u_0 = \\kappa + \\beta h$\n-   If $\\beta < 0$:\n    -   $l_i = -\\kappa$\n    -   $d_i = 2\\kappa - \\beta h$\n    -   $u_i = -\\kappa + \\beta h$\n    -   $b_1 = -l_1 u_0 = \\kappa$\n\n### Step 4: Analysis and Implementation\n\nFor each test case $(\\beta, \\kappa, N)$, the following steps are executed:\n1.  Calculate grid parameters $h$ and $x_i$.\n2.  Compute the exact solution $u(x_i)$ on the grid using the numerically stable formula.\n3.  For each scheme (CD and UD):\n    a.  Assemble the $(N-1) \\times (N-1)$ tridiagonal matrix $A$ and the right-hand side vector $\\mathbf{b}$.\n    b.  Solve the linear system $A \\mathbf{u}_{\\text{int}} = \\mathbf{b}$ to find the interior solution.\n    c.  Construct the full solution vector $u_i$ by including the boundary values $u_0=1$ and $u_N=0$.\n4.  For each numerical solution ($u^{\\mathrm{CD}}$, $u^{\\mathrm{UD}}$):\n    a.  Compute the error vector $e_i = u_i - u(x_i)$.\n    b.  Calculate the discrete $L^2$-norm: $\\|e\\|_{L^2_h} = \\left(h \\sum_{i=1}^{N-1} e_i^2\\right)^{1/2}$.\n    c.  Calculate the discrete $H^1$-seminorm: $|e|_{H^1_h} = \\left(h^{-1} \\sum_{i=0}^{N-1} (e_{i+1}-e_i)^2\\right)^{1/2}$.\n    d.  Check for monotonicity: determine if $u_{i+1} \\le u_i$ for all $i=0, \\dots, N-1$. The exact solution is always non-increasing for the given boundary conditions.\n5.  Calculate the cell Péclet number $Pe = \\beta h / \\kappa$ and determine the selected scheme: code $0$ for CD if $|Pe| \\le 2$, and code $1$ for UD if $|Pe| > 2$.\n6.  Collect the seven required output values: scheme code, the four error norms, and the two monotonicity booleans.\n\nThis procedure is implemented in the Python code below, which processes all test cases and generates the output in the specified format. The `scipy` library is not required as `numpy` provides sufficient functionality for assembling and solving the tridiagonal linear systems.", "answer": "[[0,7.854041138243452e-06,8.356265076633633e-05,0.0007854483737609277,0.004178556637374744,True,True],[0,0.04354005111162095,0.09068065876356779,1.4870509653151478,1.391297920117498,True,True],[1,0.2818988358451878,0.1709405232960667,3.824204859846387,2.001639148560565,False,True],[1,0.1754021966110821,0.14798361048601815,3.865320503023886,2.158567115163004,False,True],[0,0.134375053704205,0.09068065876356779,2.831518590835846,1.391297920117498,True,True]]", "id": "3430298"}, {"introduction": "The Péclet number's influence is not confined to spatial accuracy in steady-state problems; it also plays a pivotal role in the stability of time-dependent simulations. This practice extends our analysis to the time-dependent advection-diffusion equation, using von Neumann stability analysis to investigate how spatial discretization impacts the stability constraints of a time-integration scheme. You will derive how the maximum allowable Courant–Friedrichs–Lewy (CFL) number depends on the Péclet number for both central and upwind schemes, revealing a crucial dynamic interplay between advection, diffusion, and the grid resolution [@problem_id:3430240].", "problem": "Consider the one-dimensional constant-coefficient advection–diffusion partial differential equation (PDE)\n$$u_{t} + a\\,u_{x} = \\nu\\,u_{xx},$$\non a uniform periodic grid with spacing $h$, where $a \\neq 0$ is the advection speed and $\\nu > 0$ is the kinematic viscosity. Let $u_{j}(t)$ denote the semi-discrete solution at grid index $j$ and time $t$. Approximate the spatial derivatives using either:\n- second-order central difference for advection, $D_{0}u_{j} = \\frac{u_{j+1} - u_{j-1}}{2 h}$, or\n- first-order upwind difference for advection (assume $a>0$), $D_{-}u_{j} = \\frac{u_{j} - u_{j-1}}{h}$,\nand in both cases use the second-order central difference for diffusion, $D_{xx} u_{j} = \\frac{u_{j+1} - 2 u_{j} + u_{j-1}}{h^{2}}$.\n\nTime advance the resulting semi-discrete ordinary differential equation with the Forward Euler (FE) method, the amplification factor of which is $G = 1 + \\Delta t\\,\\lambda(\\theta)$ on the Fourier mode $u_{j}(t) \\propto \\exp(i j \\theta)$, where $\\lambda(\\theta)$ is the semi-discrete spatial Fourier symbol and $\\theta \\in [0, \\pi]$ is the dimensionless wave number. Define the Courant–Friedrichs–Lewy (CFL) number $\\mathrm{CFL} = \\frac{|a| \\Delta t}{h}$ and the cell Peclet number $Pe_{h} = \\frac{|a| h}{2 \\nu}$.\n\nUsing von Neumann analysis, derive for the mode $\\theta = \\frac{\\pi}{2}$ the squared magnitude $|G|^{2}$ of the FE amplification factor for the central-advection and upwind-advection spatial discretizations. Enforce the non-amplification condition $|G|^{2} \\leq 1$ to obtain the boundary values $\\mathrm{CFL}^{\\star}_{\\mathrm{central}}(Pe_{h})$ and $\\mathrm{CFL}^{\\star}_{\\mathrm{upwind}}(Pe_{h})$ at which $|G|^{2} = 1$ for $\\theta = \\frac{\\pi}{2}$.\n\nFinally, determine the unique $Pe_{h}^{\\star}$ such that $\\mathrm{CFL}^{\\star}_{\\mathrm{central}}(Pe_{h}^{\\star}) = \\mathrm{CFL}^{\\star}_{\\mathrm{upwind}}(Pe_{h}^{\\star})$. Interpret this $Pe_{h}^{\\star}$ as the indifferent threshold in choosing between the central and upwind spatial schemes under Forward Euler at $\\theta = \\frac{\\pi}{2}$. Express your final answer as a closed-form analytic expression for $Pe_{h}^{\\star}$. No rounding is required, and the answer is dimensionless.", "solution": "The user wants to solve a numerical analysis problem involving the stability of finite difference schemes for the one-dimensional advection-diffusion equation.\n\n### Step 1: Extract Givens\n- **PDE**: $u_{t} + a\\,u_{x} = \\nu\\,u_{xx}$, with $a \\neq 0$ and $\\nu > 0$.\n- **Grid**: Uniform, periodic, spacing $h$.\n- **Spatial Operators**:\n  - Central Advection ($D_{0}$): $\\frac{u_{j+1} - u_{j-1}}{2 h}$.\n  - Upwind Advection ($D_{-}$, for $a>0$): $\\frac{u_{j} - u_{j-1}}{h}$.\n  - Central Diffusion ($D_{xx}$): $\\frac{u_{j+1} - 2 u_{j} + u_{j-1}}{h^{2}}$.\n- **Time Integration**: Forward Euler (FE), with amplification factor $G = 1 + \\Delta t\\,\\lambda(\\theta)$.\n- **Fourier Analysis**: The solution is decomposed into modes $u_{j}(t) \\propto \\exp(i j \\theta)$, where $\\theta \\in [0, \\pi]$ is the dimensionless wave number and $\\lambda(\\theta)$ is the Fourier symbol of the spatial operator.\n- **Definitions**:\n  - Courant–Friedrichs–Lewy (CFL) number: $\\mathrm{CFL} = \\frac{|a| \\Delta t}{h}$.\n  - Cell Peclet number: $Pe_{h} = \\frac{|a| h}{2 \\nu}$.\n- **Task**:\n  1. For the mode $\\theta = \\frac{\\pi}{2}$, derive the squared magnitude of the amplification factor, $|G|^{2}$, for both central-advection and upwind-advection schemes.\n  2. Enforce the non-amplification condition $|G|^{2} = 1$ to find the stability boundaries $\\mathrm{CFL}^{\\star}_{\\mathrm{central}}(Pe_{h})$ and $\\mathrm{CFL}^{\\star}_{\\mathrm{upwind}}(Pe_{h})$.\n  3. Find the unique value $Pe_{h}^{\\star}$ where $\\mathrm{CFL}^{\\star}_{\\mathrm{central}}(Pe_{h}^{\\star}) = \\mathrm{CFL}^{\\star}_{\\mathrm{upwind}}(Pe_{h}^{\\star})$.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is a standard exercise in the von Neumann stability analysis of numerical schemes for partial differential equations. All terms ($u_t$, $u_x$, $u_{xx}$, CFL number, Peclet number, Forward Euler, central/upwind differencing) are standard in the field of numerical analysis and computational fluid dynamics. The problem is self-contained, with all necessary definitions and constants provided. The derivation path is logical and leads to a single, well-defined quantity, $Pe_{h}^{\\star}$. The problem is scientifically grounded, well-posed, and objective. There are no contradictions, ambiguities, or factual errors.\n\n### Step 3: Verdict and Action\nThe problem is valid. The solution proceeds as follows.\n\nThe semi-discrete form of the PDE is $\\frac{du_j}{dt} = \\mathcal{L}u_j$, where $\\mathcal{L}$ is the spatial discretization operator. The Fourier symbol $\\lambda(\\theta)$ of $\\mathcal{L}$ is found by applying the operator to a single Fourier mode $u_j = \\exp(ij\\theta)$.\n\n**1. Derivation of Fourier Symbols**\n\nFor the central-advection scheme, the operator is $\\mathcal{L}_{\\mathrm{central}} = -a D_0 + \\nu D_{xx}$. Applying this to $u_j=\\exp(ij\\theta)$:\n$$ \\mathcal{L}_{\\mathrm{central}} u_j = \\left( -a \\frac{e^{i\\theta} - e^{-i\\theta}}{2h} + \\nu \\frac{e^{i\\theta} - 2 + e^{-i\\theta}}{h^2} \\right) u_j $$\n$$ \\lambda_{\\mathrm{central}}(\\theta) = -a \\frac{2i\\sin\\theta}{2h} + \\nu \\frac{2\\cos\\theta - 2}{h^2} = -\\frac{ia\\sin\\theta}{h} - \\frac{2\\nu(1-\\cos\\theta)}{h^2} $$\n\nFor the upwind-advection scheme (with $a>0$), the operator is $\\mathcal{L}_{\\mathrm{upwind}} = -a D_{-} + \\nu D_{xx}$. Applying this to $u_j=\\exp(ij\\theta)$:\n$$ \\mathcal{L}_{\\mathrm{upwind}} u_j = \\left( -a \\frac{1 - e^{-i\\theta}}{h} + \\nu \\frac{e^{i\\theta} - 2 + e^{-i\\theta}}{h^2} \\right) u_j $$\n$$ \\lambda_{\\mathrm{upwind}}(\\theta) = -\\frac{a(1-\\cos\\theta+i\\sin\\theta)}{h} - \\frac{2\\nu(1-\\cos\\theta)}{h^2} $$\n\n**2. Evaluation at a Specific Wavenumber $\\theta = \\frac{\\pi}{2}$**\n\nAt $\\theta = \\frac{\\pi}{2}$, we have $\\sin(\\frac{\\pi}{2}) = 1$ and $\\cos(\\frac{\\pi}{2}) = 0$.\nThe Fourier symbols become:\n$$ \\lambda_{\\mathrm{central}}\\left(\\frac{\\pi}{2}\\right) = -\\frac{ia}{h} - \\frac{2\\nu}{h^2} = -\\frac{2\\nu}{h^2} - i\\frac{a}{h} $$\n$$ \\lambda_{\\mathrm{upwind}}\\left(\\frac{\\pi}{2}\\right) = -\\frac{a(1+i)}{h} - \\frac{2\\nu}{h^2} = -\\left(\\frac{a}{h} + \\frac{2\\nu}{h^2}\\right) - i\\frac{a}{h} $$\n\n**3. Amplification Factor and Stability Boundary**\n\nThe amplification factor for the Forward Euler method is $G = 1 + \\Delta t \\lambda$. The stability condition is $|G|^2 \\leq 1$. The boundary of the stability region is given by $|G|^2 = 1$. Let $\\lambda = \\lambda_R + i\\lambda_I$.\n$$ |1 + \\Delta t(\\lambda_R + i\\lambda_I)|^2 = (1 + \\Delta t \\lambda_R)^2 + (\\Delta t \\lambda_I)^2 = 1 $$\n$$ 1 + 2\\Delta t \\lambda_R + (\\Delta t)^2 \\lambda_R^2 + (\\Delta t)^2 \\lambda_I^2 = 1 $$\n$$ 2\\Delta t \\lambda_R + (\\Delta t)^2 (\\lambda_R^2 + \\lambda_I^2) = 0 $$\nSince $\\Delta t > 0$, we can divide by it to find the time step $\\Delta t^{\\star}$ on the stability boundary:\n$$ \\Delta t^{\\star} = \\frac{-2\\lambda_R}{\\lambda_R^2 + \\lambda_I^2} = \\frac{-2\\Re(\\lambda)}{|\\lambda|^2} $$\n\n**For the central scheme at $\\theta = \\frac{\\pi}{2}$**:\n$\\lambda_R = -\\frac{2\\nu}{h^2}$ and $\\lambda_I = -\\frac{a}{h}$.\n$$ \\Delta t^{\\star}_{\\mathrm{central}} = \\frac{-2(-\\frac{2\\nu}{h^2})}{(-\\frac{2\\nu}{h^2})^2 + (-\\frac{a}{h})^2} = \\frac{\\frac{4\\nu}{h^2}}{\\frac{4\\nu^2}{h^4} + \\frac{a^2}{h^2}} = \\frac{4\\nu h^2}{4\\nu^2 + a^2 h^2} $$\nThe critical CFL number is $\\mathrm{CFL}^{\\star} = \\frac{|a| \\Delta t^{\\star}}{h}$. Since $a>0$, $|a|=a$.\n$$ \\mathrm{CFL}^{\\star}_{\\mathrm{central}} = \\frac{a}{h} \\frac{4\\nu h^2}{4\\nu^2 + a^2 h^2} = \\frac{4a\\nu h}{4\\nu^2 + a^2 h^2} $$\nUsing the cell Peclet number $Pe_h = \\frac{ah}{2\\nu}$, which means $\\frac{1}{Pe_h} = \\frac{2\\nu}{ah}$.\nDivide the numerator and denominator by $a^2 h^2$:\n$$ \\mathrm{CFL}^{\\star}_{\\mathrm{central}} = \\frac{4\\nu/(ah)}{4\\nu^2/(a^2 h^2) + 1} = \\frac{2 \\cdot (2\\nu/(ah))}{(2\\nu/(ah))^2 + 1} = \\frac{2/Pe_h}{1/Pe_h^2 + 1} = \\frac{2 Pe_h}{1 + Pe_h^2} $$\n\n**For the upwind scheme at $\\theta = \\frac{\\pi}{2}$**:\n$\\lambda_R = -(\\frac{a}{h} + \\frac{2\\nu}{h^2})$ and $\\lambda_I = -\\frac{a}{h}$.\n$$ \\Delta t^{\\star}_{\\mathrm{upwind}} = \\frac{-2(-(\\frac{a}{h} + \\frac{2\\nu}{h^2}))}{(\\frac{a}{h} + \\frac{2\\nu}{h^2})^2 + (\\frac{a}{h})^2} = \\frac{2(\\frac{ah+2\\nu}{h^2})}{\\frac{a^2}{h^2} + \\frac{4a\\nu}{h^3} + \\frac{4\\nu^2}{h^4} + \\frac{a^2}{h^2}} = \\frac{2(ah+2\\nu)}{h^2} \\frac{h^4}{2a^2h^2 + 4a\\nu h + 4\\nu^2} $$\n$$ \\Delta t^{\\star}_{\\mathrm{upwind}} = \\frac{2h^2(ah+2\\nu)}{2a^2h^2 + 4a\\nu h + 4\\nu^2} = \\frac{h^2(ah+2\\nu)}{a^2h^2 + 2a\\nu h + 2\\nu^2} $$\nThe critical CFL number is:\n$$ \\mathrm{CFL}^{\\star}_{\\mathrm{upwind}} = \\frac{a}{h} \\frac{h^2(ah+2\\nu)}{a^2h^2 + 2a\\nu h + 2\\nu^2} = \\frac{ah(ah+2\\nu)}{a^2h^2 + 2a\\nu h + 2\\nu^2} $$\nDivide numerator and denominator by $(ah)^2$:\n$$ \\mathrm{CFL}^{\\star}_{\\mathrm{upwind}} = \\frac{1+2\\nu/(ah)}{1 + 2\\nu/(ah) + 2(\\nu/(ah))^2} = \\frac{1+1/Pe_h}{1 + 1/Pe_h + 2(1/(2Pe_h))^2} = \\frac{1+1/Pe_h}{1 + 1/Pe_h + 1/(2Pe_h^2)} $$\n\n**4. Equating the Critical CFL Numbers**\n\nWe are looking for $Pe_{h}^{\\star}$ such that $\\mathrm{CFL}^{\\star}_{\\mathrm{central}}(Pe_{h}^{\\star}) = \\mathrm{CFL}^{\\star}_{\\mathrm{upwind}}(Pe_{h}^{\\star})$. Let $P = Pe_h$.\n$$ \\frac{2P}{1+P^2} = \\frac{1+1/P}{1+1/P+1/(2P^2)} $$\nSimplify the right-hand side:\n$$ \\frac{1+1/P}{1+1/P+1/(2P^2)} = \\frac{(P+1)/P}{(2P^2+2P+1)/(2P^2)} = \\frac{P+1}{P} \\cdot \\frac{2P^2}{2P^2+2P+1} = \\frac{2P(P+1)}{2P^2+2P+1} $$\nThe equation becomes:\n$$ \\frac{2P}{1+P^2} = \\frac{2P(P+1)}{2P^2+2P+1} $$\nSince $P = Pe_h = \\frac{|a|h}{2\\nu} > 0$, we can divide both sides by $2P$:\n$$ \\frac{1}{1+P^2} = \\frac{P+1}{2P^2+2P+1} $$\nCross-multiply:\n$$ 2P^2+2P+1 = (P+1)(1+P^2) = P+P^3+1+P^2 $$\n$$ 2P^2+2P+1 = P^3+P^2+P+1 $$\nRearrange into a polynomial equation:\n$$ P^3 - P^2 - P = 0 $$\nFactor out $P$:\n$$ P(P^2 - P - 1) = 0 $$\nThis equation has solutions $P=0$ and the roots of the quadratic $P^2 - P - 1 = 0$. Since $Pe_h$ must be positive, we discard the $P=0$ solution.\nUsing the quadratic formula for $P^2 - P - 1 = 0$:\n$$ P = \\frac{-(-1) \\pm \\sqrt{(-1)^2 - 4(1)(-1)}}{2(1)} = \\frac{1 \\pm \\sqrt{1+4}}{2} = \\frac{1 \\pm \\sqrt{5}}{2} $$\nAgain, since $P = Pe_h$ must be a positive physical quantity, we take the positive root.\n$$ Pe_{h}^{\\star} = \\frac{1+\\sqrt{5}}{2} $$\nThis value is the golden ratio, often denoted by $\\phi$. This is the unique positive Peclet number at which the stability limits for the $\\theta=\\pi/2$ mode coincide for the two schemes under consideration.", "answer": "$$\\boxed{\\frac{1+\\sqrt{5}}{2}}$$", "id": "3430240"}]}