{"hands_on_practices": [{"introduction": "A cornerstone of uncertainty quantification is understanding how outputs of interest respond to variations in input parameters. This practice introduces the continuous adjoint method, an elegant and powerful technique for efficiently computing the sensitivity, or Fréchet derivative, of a functional of a Partial Differential Equation (PDE) solution. By working through this derivation [@problem_id:3459206], you will master a foundational technique for gradient-based uncertainty analysis and PDE-constrained optimization.", "problem": "Consider a bounded Lipschitz domain $D \\subset \\mathbb{R}^{d}$ with $d \\in \\{2,3\\}$ and outward unit normal $\\boldsymbol{n}$ on its boundary $\\partial D$. Let $a : D \\to \\mathbb{R}$ be a strictly positive coefficient satisfying $a \\in L^{\\infty}(D)$ and $a(x) \\ge a_{\\min}  0$ almost everywhere in $D$. For a given source $f \\in L^{2}(D)$, the state $u \\in H_{0}^{1}(D)$ is defined as the unique weak solution of the linear elliptic Partial Differential Equation (PDE)\n$$\n-\\nabla \\cdot \\big(a(x)\\,\\nabla u(x)\\big) = f(x) \\quad \\text{in } D, \n\\qquad \nu = 0 \\quad \\text{on } \\partial D,\n$$\nin the sense that the weak form\n$$\n\\int_{D} a(x)\\,\\nabla u(x)\\cdot \\nabla v(x)\\,dx = \\int_{D} f(x)\\,v(x)\\,dx\n$$\nholds for all $v \\in H_{0}^{1}(D)$. Define the quantity of interest (QoI) $Q : H_{0}^{1}(D) \\to \\mathbb{R}$ by\n$$\nQ(u) := \\int_{D} \\psi(x)\\,u(x)\\,dx,\n$$\nwith a fixed weight $\\psi \\in L^{2}(D)$. In the context of Uncertainty Quantification (UQ), treat $a$ as the uncertain input field and consider perturbations $\\delta a \\in L^{\\infty}(D)$ such that $a+\\delta a$ remains strictly positive.\n\nStarting from the weak formulation, use the continuous adjoint method to:\n1) Derive the adjoint problem for the adjoint field $p \\in H_{0}^{1}(D)$ associated with the QoI $Q(u)$, including appropriate boundary conditions justified by the functional setting.\n2) Derive the Fréchet derivative of $Q$ with respect to $a$ in the direction $\\delta a$, denoted $\\delta Q[a;\\delta a]$, and express it entirely in terms of inner products of the primal gradient $\\nabla u$ and the adjoint gradient $\\nabla p$. Then, identify the pointwise Fréchet derivative density $\\delta Q/\\delta a(x)$ so that\n$$\n\\delta Q[a;\\delta a] = \\int_{D} \\frac{\\delta Q}{\\delta a}(x)\\,\\delta a(x)\\,dx.\n$$\n\nYour final answer must be a single closed-form analytic expression for the pointwise Fréchet derivative density $\\delta Q/\\delta a(x)$. No numerical evaluation is required. All integrals must be expressed in base International System of Units (SI) and all angles, if any appear, in radians. No rounding is needed.", "solution": "The problem is first validated to ensure it is well-posed and scientifically sound.\n\n### Step 1: Extract Givens\n-   **Domain**: A bounded Lipschitz domain $D \\subset \\mathbb{R}^{d}$ with $d \\in \\{2,3\\}$.\n-   **Coefficient**: A function $a : D \\to \\mathbb{R}$ such that $a \\in L^{\\infty}(D)$ and there exists a constant $a_{\\min}  0$ with $a(x) \\ge a_{\\min}$ almost everywhere in $D$.\n-   **Source**: A function $f \\in L^{2}(D)$.\n-   **State Variable**: The state $u \\in H_{0}^{1}(D)$ is the unique weak solution to a linear elliptic PDE.\n-   **PDE (Strong Form)**: $-\\nabla \\cdot \\big(a(x)\\,\\nabla u(x)\\big) = f(x)$ in $D$, with boundary condition $u = 0$ on $\\partial D$.\n-   **PDE (Weak Form)**: For all test functions $v \\in H_{0}^{1}(D)$, the following holds:\n    $$ \\int_{D} a(x)\\,\\nabla u(x)\\cdot \\nabla v(x)\\,dx = \\int_{D} f(x)\\,v(x)\\,dx $$\n-   **Quantity of Interest (QoI)**: A functional $Q : H_{0}^{1}(D) \\to \\mathbb{R}$ defined by:\n    $$ Q(u) := \\int_{D} \\psi(x)\\,u(x)\\,dx $$\n    where $\\psi \\in L^{2}(D)$ is a fixed weight function.\n-   **Uncertainty Model**: The coefficient $a$ is treated as an uncertain input field. We consider perturbations $\\delta a \\in L^{\\infty}(D)$ such that $a+\\delta a$ remains strictly positive.\n-   **Objective**:\n    1.  Derive the adjoint problem for the adjoint field $p \\in H_{0}^{1}(D)$.\n    2.  Derive the Fréchet derivative of $Q$ with respect to $a$ in the direction $\\delta a$, denoted $\\delta Q[a;\\delta a]$, and identify the pointwise Fréchet derivative density $\\frac{\\delta Q}{\\delta a}(x)$.\n\n### Step 2: Validate Using Extracted Givens\n-   **Scientifically Grounded**: The problem is a standard application of the continuous adjoint method for sensitivity analysis of a solution to a linear elliptic PDE. This is a fundamental and well-established topic in applied mathematics, numerical analysis, and engineering. The PDE is the variable-coefficient Poisson equation, a canonical model for diffusion processes. The use of Sobolev spaces ($H_{0}^{1}(D)$) and Lebesgue spaces ($L^{2}(D)$, $L^{\\infty}(D)$) is standard for the modern theory of PDEs.\n-   **Well-Posed**: The existence and uniqueness of the a weak solution $u \\in H_{0}^{1}(D)$ for the primal problem is guaranteed by the Lax-Milgram theorem. The bilinear form $B(u,v) = \\int_{D} a \\nabla u \\cdot \\nabla v \\,dx$ is continuous and coercive on $H_{0}^{1}(D) \\times H_{0}^{1}(D)$, and the linear functional $L(v) = \\int_{D} f v \\,dx$ is continuous on $H_{0}^{1}(D)$. The problem of finding the Fréchet derivative is also well-posed.\n-   **Objective**: The problem is stated using precise mathematical language, leaving no room for ambiguity.\n\nThe problem contains no scientific fallacies, inconsistencies, or ill-posed elements. It is a valid and standard problem in the field of PDE-constrained optimization and uncertainty quantification.\n\n### Step 3: Verdict and Action\nThe problem is valid. A full solution is provided below.\n\n### Solution Derivation\n\nThe solution process involves three mains steps: linearizing the governing PDE to obtain the sensitivity equation, defining the adjoint problem, and combining these to derive the Fréchet derivative of the QoI.\n\nLet the state $u$ be implicitly dependent on the coefficient $a$, denoted as $u(a)$. A perturbation $\\delta a$ of the coefficient $a$ induces a perturbation in the state, which to first order is given by the Gâteaux derivative of $u$ with respect to $a$ in the direction $\\delta a$, denoted $\\delta u$. The perturbed state is $u(a+\\delta a) \\approx u(a) + \\delta u$.\n\nThe state $u = u(a)$ satisfies the weak form:\n$$ \\int_{D} a(x)\\,\\nabla u(x)\\cdot \\nabla v(x)\\,dx = \\int_{D} f(x)\\,v(x)\\,dx \\quad \\forall v \\in H_{0}^{1}(D) \\quad (1) $$\nThe perturbed state $u+\\delta u$ corresponding to the perturbed coefficient $a+\\delta a$ satisfies:\n$$ \\int_{D} (a(x)+\\delta a(x))\\,\\nabla (u(x)+\\delta u(x))\\cdot \\nabla v(x)\\,dx = \\int_{D} f(x)\\,v(x)\\,dx \\quad \\forall v \\in H_{0}^{1}(D) \\quad (2) $$\nExpanding $(2)$:\n$$ \\int_{D} a\\nabla u \\cdot \\nabla v \\,dx + \\int_{D} a\\nabla \\delta u \\cdot \\nabla v \\,dx + \\int_{D} \\delta a\\nabla u \\cdot \\nabla v \\,dx + \\int_{D} \\delta a\\nabla \\delta u \\cdot \\nabla v \\,dx = \\int_{D} f v \\,dx $$\nSubtracting equation $(1)$ from this expansion and neglecting the second-order term $\\int_{D} \\delta a\\nabla \\delta u \\cdot \\nabla v \\,dx$ (which is $O(\\|\\delta a\\|\\|\\delta u\\|)$), we obtain the linearized sensitivity equation for $\\delta u \\in H_{0}^{1}(D)$:\n$$ \\int_{D} a(x)\\,\\nabla \\delta u(x)\\cdot \\nabla v(x)\\,dx = - \\int_{D} \\delta a(x)\\,\\nabla u(x)\\cdot \\nabla v(x)\\,dx \\quad \\forall v \\in H_{0}^{1}(D) \\quad (3) $$\n\nNext, we consider the first-order variation of the QoI, $\\delta Q$.\n$$ Q(u+\\delta u) = \\int_{D} \\psi(x)\\,(u(x)+\\delta u(x))\\,dx = \\int_{D} \\psi u\\,dx + \\int_{D} \\psi \\delta u\\,dx = Q(u) + \\delta Q $$\nThe Fréchet derivative of $Q$ with respect to $u$ in the direction $\\delta u$ is thus:\n$$ \\delta Q = \\int_{D} \\psi(x)\\,\\delta u(x)\\,dx \\quad (4) $$\nOur goal is to express $\\delta Q$ in terms of $\\delta a$ without needing to explicitly solve equation $(3)$ for $\\delta u$. This is achieved by introducing an adjoint problem.\n\n**1) The Adjoint Problem**\n\nWe define the adjoint state $p \\in H_{0}^{1}(D)$ as the solution to the following weak problem:\nFind $p \\in H_{0}^{1}(D)$ such that for all test functions $w \\in H_{0}^{1}(D)$:\n$$ \\int_{D} a(x)\\,\\nabla w(x)\\cdot \\nabla p(x)\\,dx = \\int_{D} \\psi(x)\\,w(x)\\,dx $$\nDue to the symmetry of the bilinear form, i.e., $\\int_D a \\nabla w \\cdot \\nabla p \\,dx = \\int_D a \\nabla p \\cdot \\nabla w \\,dx$, this is equivalent to the standard weak form:\n$$ \\int_{D} a(x)\\,\\nabla p(x)\\cdot \\nabla w(x)\\,dx = \\int_{D} \\psi(x)\\,w(x)\\,dx \\quad \\forall w \\in H_{0}^{1}(D) \\quad (5) $$\nThis weak form corresponds to the strong-form adjoint PDE:\n$$ -\\nabla \\cdot \\big(a(x)\\,\\nabla p(x)\\big) = \\psi(x) \\quad \\text{in } D $$\nThe requirement that the solution $p$ and test functions $w$ belong to $H_{0}^{1}(D)$ implies the homogeneous Dirichlet boundary condition:\n$$ p = 0 \\quad \\text{on } \\partial D $$\nThis completes the derivation of the adjoint problem.\n\n**2) The Fréchet Derivative Density**\n\nNow we connect the primal, sensitivity, and adjoint equations.\nIn the adjoint weak form $(5)$, we choose the test function to be the state sensitivity, $w = \\delta u \\in H_{0}^{1}(D)$. This gives:\n$$ \\int_{D} a(x)\\,\\nabla p(x)\\cdot \\nabla \\delta u(x)\\,dx = \\int_{D} \\psi(x)\\,\\delta u(x)\\,dx $$\nThe right-hand side is exactly the expression for $\\delta Q$ from equation $(4)$. Using the symmetry of the dot product, we have:\n$$ \\delta Q = \\int_{D} a(x)\\,\\nabla \\delta u(x)\\cdot \\nabla p(x)\\,dx $$\nNow, consider the sensitivity equation $(3)$. We can choose the test function to be the adjoint state, $v = p \\in H_{0}^{1}(D)$, which yields:\n$$ \\int_{D} a(x)\\,\\nabla \\delta u(x)\\cdot \\nabla p(x)\\,dx = - \\int_{D} \\delta a(x)\\,\\nabla u(x)\\cdot \\nabla p(x)\\,dx $$\nBy equating the two expressions for $\\int_{D} a\\,\\nabla \\delta u \\cdot \\nabla p\\,dx$, we arrive at the desired expression for the variation of the QoI:\n$$ \\delta Q[a;\\delta a] = - \\int_{D} \\delta a(x)\\,\\nabla u(x)\\cdot \\nabla p(x)\\,dx $$\nThis is the Fréchet derivative of $Q$ with respect to $a$ in the direction $\\delta a$, expressed in terms of the primal solution $u$ and the adjoint solution $p$.\n\nThe problem defines the pointwise Fréchet derivative density, $\\frac{\\delta Q}{\\delta a}(x)$, through the relation:\n$$ \\delta Q[a;\\delta a] = \\int_{D} \\frac{\\delta Q}{\\delta a}(x)\\,\\delta a(x)\\,dx $$\nBy direct comparison with our derived result, we have:\n$$ \\int_{D} \\frac{\\delta Q}{\\delta a}(x)\\,\\delta a(x)\\,dx = \\int_{D} \\big(-\\nabla u(x)\\cdot \\nabla p(x)\\big)\\,\\delta a(x)\\,dx $$\nSince this identity must hold for any admissible perturbation $\\delta a \\in L^{\\infty}(D)$, the integrands must be equal almost everywhere. Therefore, the pointwise Fréchet derivative density is:\n$$ \\frac{\\delta Q}{\\delta a}(x) = -\\nabla u(x)\\cdot \\nabla p(x) $$\nwhere $u$ is the solution to the primal problem and $p$ is the solution to the adjoint problem.", "answer": "$$\n\\boxed{-\\nabla u(x)\\cdot \\nabla p(x)}\n$$", "id": "3459206"}, {"introduction": "Once we can compute local sensitivities, the next step is to use this information to approximate the global impact of uncertainty. This exercise [@problem_id:3459219] demonstrates how to combine first-order perturbation theory with the Karhunen-Loève expansion—a standard method for representing random fields—to estimate the mean and variance of an output functional. This hands-on derivation provides a practical framework for propagating uncertainty through a PDE model, particularly in the important small-fluctuation regime.", "problem": "Consider the one-dimensional steady diffusion Partial Differential Equation (PDE)\n$$\n-(a(x,\\omega)\\,u'(x,\\omega))' \\;=\\; f(x), \\quad x\\in(0,1),\n$$\nwith homogeneous Dirichlet boundary conditions $u(0,\\omega)=u(1,\\omega)=0$. Let $f(x)\\equiv 1$ and consider the linear quantity of interest $Q(u)=\\int_0^1 u(x,\\omega)\\,\\psi(x)\\,dx$ with $\\psi(x)\\equiv 1$. The diffusion coefficient is lognormal,\n$$\na(x,\\omega)\\;=\\;\\exp\\!\\left(\\mu \\;+\\; Y(x,\\omega)\\right),\n$$\nwhere $Y(x,\\omega)$ is a zero-mean Gaussian random field with covariance\n$$\nC(x,y)\\;=\\;\\sigma^{2}\\,\\exp\\!\\left(-\\frac{|x-y|}{\\ell}\\right),\n$$\nfor fixed correlation length $\\ell0$ and amplitude $\\sigma0$. Let the Karhunen–Loève (KL) expansion of $Y$ be\n$$\nY(x,\\omega)\\;=\\;\\sum_{k=1}^{\\infty}\\sqrt{\\lambda_{k}}\\,\\xi_{k}(\\omega)\\,\\phi_{k}(x),\n$$\nwhere $\\{\\xi_{k}\\}_{k\\ge 1}$ are independent standard normal random variables, and $\\{(\\lambda_{k},\\phi_{k})\\}_{k\\ge 1}$ are the eigenpairs of the covariance operator associated with $C$, with $\\{\\phi_{k}\\}$ orthonormal in $L^{2}(0,1)$. Define the $m$-term truncated field\n$$\nY_{m}(x,\\omega)\\;=\\;\\sum_{k=1}^{m}\\sqrt{\\lambda_{k}}\\,\\xi_{k}(\\omega)\\,\\phi_{k}(x),\n$$\nand the truncated lognormal coefficient $a_{m}(x,\\omega)=\\exp\\!\\left(\\mu+Y_{m}(x,\\omega)\\right)$. Assume a small-fluctuation regime in which the dimensionless amplitude $\\sigma$ is sufficiently small that first-order perturbations in $Y$ dominate, and neglect all terms of order higher than linear in $\\xi_{k}$.\n\nStarting from first principles of linear elliptic operators, the weak formulation, and the adjoint representation of linear functionals, derive, to leading order in $\\sigma$, closed-form analytic expressions for the expectation $\\mathbb{E}[Q(u_{m})]$ and the variance $\\operatorname{Var}[Q(u_{m})]$, where $u_{m}$ solves\n$$\n-\\big(a_{m}(x,\\omega)\\,u_{m}'(x,\\omega)\\big)'\\;=\\;1,\\quad u_{m}(0,\\omega)=u_{m}(1,\\omega)=0.\n$$\nYour expressions must be written explicitly in terms of $\\mu$, $\\{\\lambda_{k},\\phi_{k}\\}_{k=1}^{m}$, and integrals over $(0,1)$, without introducing uncomputed numerical constants or unspecified auxiliary functions. Round no quantities. Express the final answer as a single analytical expression containing both $\\mathbb{E}[Q(u_{m})]$ and $\\operatorname{Var}[Q(u_{m})]$ in a single row matrix using the $\\mathrm{pmatrix}$ environment as specified.", "solution": "We begin by recalling the structure of the problem. The coefficient is lognormal, $a(x,\\omega)=\\exp(\\mu+Y(x,\\omega))$, with mean baseline $a_{0}:=\\exp(\\mu)$. In a small-fluctuation regime, we expand $a$ to first order in $Y$:\n$$\na(x,\\omega)\\;=\\;a_{0}\\,\\exp\\big(Y(x,\\omega)\\big)\\;\\approx\\;a_{0}\\,\\big(1+Y(x,\\omega)\\big),\n$$\nneglecting terms that are quadratic and higher in $Y$. In this regime, replacing $Y$ by its $m$-term truncated Karhunen–Loève (KL) expansion $Y_{m}$ yields\n$$\na_{m}(x,\\omega)\\;\\approx\\;a_{0}\\,\\big(1+Y_{m}(x,\\omega)\\big),\\qquad\nY_{m}(x,\\omega)=\\sum_{k=1}^{m}\\sqrt{\\lambda_{k}}\\,\\xi_{k}(\\omega)\\,\\phi_{k}(x).\n$$\n\nWe analyze the solution $u_{m}$ by a first-order perturbation about the deterministic mean-coefficient solution. Denote by $\\bar{u}$ the solution of the deterministic baseline problem\n$$\n-\\big(a_{0}\\,\\bar{u}'(x)\\big)'\\;=\\;1,\\qquad \\bar{u}(0)=\\bar{u}(1)=0.\n$$\nBecause $a_{0}$ is constant, this simplifies to\n$$\n-a_{0}\\,\\bar{u}''(x)\\;=\\;1,\\qquad \\bar{u}(0)=\\bar{u}(1)=0.\n$$\nIntegrating twice, we obtain\n$$\n\\bar{u}''(x)\\;=\\;-\\frac{1}{a_{0}},\\quad\n\\bar{u}'(x)\\;=\\;-\\frac{x}{a_{0}}+C_{1},\\quad\n\\bar{u}(x)\\;=\\;-\\frac{x^{2}}{2a_{0}}+C_{1}x+C_{0},\n$$\nand imposing $\\bar{u}(0)=0$ gives $C_{0}=0$, while $\\bar{u}(1)=0$ yields $C_{1}=\\frac{1}{2a_{0}}$. Thus,\n$$\n\\bar{u}(x)\\;=\\;\\frac{x-x^{2}}{2a_{0}},\\qquad\n\\bar{u}'(x)\\;=\\;\\frac{1-2x}{2a_{0}}.\n$$\n\nWe now write the first-order expansion of $u_{m}$ with respect to $Y_{m}$:\n$$\nu_{m}(x,\\omega)\\;\\approx\\;\\bar{u}(x)\\;+\\;\\sum_{k=1}^{m}\\sqrt{\\lambda_{k}}\\,\\xi_{k}(\\omega)\\,u_{k}(x),\n$$\nwhere each $u_{k}$ is the first-order correction associated with the $k$-th KL mode. Substituting $a_{m}\\approx a_{0}(1+Y_{m})$ and $u_{m}\\approx \\bar{u}+\\sum\\sqrt{\\lambda_{k}}\\xi_{k}u_{k}$ into\n$$\n-\\big(a_{m}\\,u_{m}'\\big)'\\;=\\;1,\n$$\nand retaining only terms up to first order in $\\xi_{k}$ yields the hierarchy\n$$\n-a_{0}\\,\\bar{u}''\\;=\\;1,\\qquad -a_{0}\\,u_{k}''\\;-\\;a_{0}\\,\\big(\\phi_{k}\\,\\bar{u}'\\big)'\\;=\\;0,\\quad k=1,\\dots,m,\n$$\nwhere each $u_{k}$ satisfies homogeneous Dirichlet boundary conditions $u_{k}(0)=u_{k}(1)=0$. The second relation can be written as\n$$\n-a_{0}\\,u_{k}''(x)\\;=\\;a_{0}\\,\\big(\\phi_{k}(x)\\,\\bar{u}'(x)\\big)',\\qquad u_{k}(0)=u_{k}(1)=0.\n$$\n\nWe are interested in the quantity of interest\n$$\nQ(u_{m})\\;=\\;\\int_{0}^{1} u_{m}(x,\\omega)\\,\\psi(x)\\,dx,\\qquad \\psi(x)\\equiv 1.\n$$\nUsing the first-order expansion,\n$$\nQ(u_{m})\\;\\approx\\;\\int_{0}^{1}\\bar{u}(x)\\,dx\\;+\\;\\sum_{k=1}^{m}\\sqrt{\\lambda_{k}}\\,\\xi_{k}(\\omega)\\,\\int_{0}^{1}u_{k}(x)\\,dx.\n$$\nBecause $\\mathbb{E}[\\xi_{k}]=0$, the leading-order expectation is\n$$\n\\mathbb{E}\\big[Q(u_{m})\\big]\\;\\approx\\;\\int_{0}^{1}\\bar{u}(x)\\,dx.\n$$\nEvaluating this integral,\n$$\n\\int_{0}^{1}\\bar{u}(x)\\,dx\\;=\\;\\int_{0}^{1}\\frac{x-x^{2}}{2a_{0}}\\,dx\\;=\\;\\frac{1}{2a_{0}}\\left(\\frac{1}{2}-\\frac{1}{3}\\right)\\;=\\;\\frac{1}{12\\,a_{0}}\\;=\\;\\frac{1}{12\\,\\exp(\\mu)}.\n$$\nTherefore,\n$$\n\\mathbb{E}\\big[Q(u_{m})\\big]\\;\\approx\\;\\frac{1}{12\\,\\exp(\\mu)}.\n$$\n\nNext, we derive the leading-order variance. Since $Q(u_{m})$ is affine in the independent standard normal variables $\\xi_{k}$ to first order, the variance is the sum of the squares of the linear coefficients:\n$$\n\\operatorname{Var}\\big[Q(u_{m})\\big]\\;\\approx\\;\\sum_{k=1}^{m}\\lambda_{k}\\,\\left(\\int_{0}^{1}u_{k}(x)\\,dx\\right)^{2}.\n$$\nTo evaluate $\\int_{0}^{1}u_{k}(x)\\,dx$ without explicitly solving $u_{k}$, we use the adjoint representation. Define the self-adjoint operator $L: H_{0}^{1}(0,1)\\cap H^{2}(0,1)\\to L^{2}(0,1)$ by\n$$\nL v\\;=\\;-a_{0}\\,v'',\n$$\nwith homogeneous Dirichlet boundary conditions. The first-order correction satisfies\n$$\nL u_{k}\\;=\\;a_{0}\\,\\big(\\phi_{k}\\,\\bar{u}'\\big)'.\n$$\nFor the linear functional $Q(v)=\\int_{0}^{1} v(x)\\,\\psi(x)\\,dx$ and self-adjoint $L$, there exists an adjoint state $w$ solving\n$$\nL w\\;=\\;\\psi,\\qquad w(0)=w(1)=0,\n$$\nsuch that\n$$\nQ(u_{k})\\;=\\;\\int_{0}^{1}u_{k}(x)\\,\\psi(x)\\,dx\\;=\\;\\int_{0}^{1}\\big(L u_{k}\\big)(x)\\,w(x)\\,dx.\n$$\nSubstituting $L u_{k}=a_{0}\\,(\\phi_{k}\\,\\bar{u}')'$ and integrating by parts once (noting $w(0)=w(1)=0$),\n$$\n\\int_{0}^{1}\\big(L u_{k}\\big)\\,w\\,dx\n\\;=\\;\\int_{0}^{1}a_{0}\\,\\big(\\phi_{k}\\,\\bar{u}'\\big)'\\,w\\,dx\n\\;=\\;-\\,\\int_{0}^{1}a_{0}\\,\\phi_{k}(x)\\,\\bar{u}'(x)\\,w'(x)\\,dx.\n$$\nWith $\\psi(x)\\equiv 1$, the adjoint $w$ satisfies the same deterministic problem as $\\bar{u}$:\n$$\nL w\\;=\\;1\\;\\;\\Longrightarrow\\;\\;w(x)=\\bar{u}(x),\\qquad w'(x)=\\bar{u}'(x).\n$$\nHence,\n$$\n\\int_{0}^{1}u_{k}(x)\\,dx\\;=\\;Q(u_{k})\\;=\\;-\\,a_{0}\\,\\int_{0}^{1}\\phi_{k}(x)\\,\\big(\\bar{u}'(x)\\big)^{2}\\,dx.\n$$\nUsing $\\bar{u}'(x)=\\frac{1-2x}{2a_{0}}$, we obtain\n$$\n\\big(\\bar{u}'(x)\\big)^{2}\\;=\\;\\frac{(1-2x)^{2}}{4\\,a_{0}^{2}},\n$$\nand therefore\n$$\n\\int_{0}^{1}u_{k}(x)\\,dx\\;=\\;-\\,a_{0}\\,\\int_{0}^{1}\\phi_{k}(x)\\,\\frac{(1-2x)^{2}}{4\\,a_{0}^{2}}\\,dx\n\\;=\\;-\\,\\frac{1}{4\\,a_{0}}\\,\\int_{0}^{1}\\phi_{k}(x)\\,(1-2x)^{2}\\,dx.\n$$\nIt follows that the leading-order variance is\n$$\n\\operatorname{Var}\\big[Q(u_{m})\\big]\\;\\approx\\;\\sum_{k=1}^{m}\\lambda_{k}\\left(\\frac{1}{4\\,a_{0}}\\int_{0}^{1}\\phi_{k}(x)\\,(1-2x)^{2}\\,dx\\right)^{2}\n\\;=\\;\\frac{1}{16\\,a_{0}^{2}}\\sum_{k=1}^{m}\\lambda_{k}\\left(\\int_{0}^{1}\\phi_{k}(x)\\,(1-2x)^{2}\\,dx\\right)^{2}.\n$$\n\nCollecting the results and substituting $a_{0}=\\exp(\\mu)$, the leading-order expectation and variance of the truncated $m$-mode model are\n$$\n\\mathbb{E}\\big[Q(u_{m})\\big]\\;\\approx\\;\\frac{1}{12\\,\\exp(\\mu)},\\qquad\n\\operatorname{Var}\\big[Q(u_{m})\\big]\\;\\approx\\;\\frac{1}{16\\,\\exp(2\\mu)}\\sum_{k=1}^{m}\\lambda_{k}\\left(\\int_{0}^{1}\\phi_{k}(x)\\,(1-2x)^{2}\\,dx\\right)^{2}.\n$$\nThese are closed-form analytic expressions in terms of $\\mu$, $\\{\\lambda_{k},\\phi_{k}\\}_{k=1}^{m}$, and integrals over $(0,1)$, as required. They quantify the effect of truncating the Karhunen–Loève expansion to $m$ modes: the expectation is unchanged to first order, while the variance is obtained by summing the contributions of the retained modes only.", "answer": "$$\\boxed{\\begin{pmatrix}\n\\dfrac{1}{12\\,\\exp(\\mu)}  \\dfrac{1}{16\\,\\exp(2\\mu)}\\displaystyle\\sum_{k=1}^{m}\\lambda_{k}\\left(\\int_{0}^{1}\\phi_{k}(x)\\,(1-2x)^{2}\\,dx\\right)^{2}\n\\end{pmatrix}}$$", "id": "3459219"}, {"introduction": "While perturbation methods are powerful, they are often limited to small uncertainties. Spectral methods, such as Polynomial Chaos Expansions (PCE), provide a global approximation of the solution's dependence on random inputs. This practice [@problem_id:3432918] takes you into the computational core of the intrusive Stochastic Galerkin method, where you will calculate the triple-product tensor entries that couple the deterministic equations in the expanded system. This calculation is a fundamental step in implementing PCE and offers a concrete look at the algebra underpinning these advanced UQ techniques.", "problem": "Consider the one-dimensional Gaussian random variable $X \\sim \\mathcal{N}(0,1)$ and the associated orthonormal probabilists' Hermite polynomial basis $\\{h_{n}(x)\\}_{n \\ge 0}$, defined by $h_{n}(x) = \\mathrm{He}_{n}(x)/\\sqrt{n!}$, where $\\mathrm{He}_{n}$ are the probabilists' Hermite polynomials and the orthonormality is with respect to the standard normal density $\\varrho(x) = (2\\pi)^{-1/2}\\exp(-x^{2}/2)$. The orthonormality and three-term recurrence are\n- $\\mathbb{E}[h_{m}(X) h_{n}(X)] = \\delta_{mn}$,\n- $x\\,h_{n}(x) = \\sqrt{n+1}\\,h_{n+1}(x) + \\sqrt{n}\\,h_{n-1}(x)$ for all $n \\ge 0$, with the convention $h_{-1} \\equiv 0$.\n\nDefine the triple-product tensor entries\n$$\nG_{ijk} \\equiv \\mathbb{E}\\big[h_{i}(X)\\,h_{j}(X)\\,h_{k}(X)\\big], \\quad i,j,k \\in \\mathbb{N}_{0}.\n$$\nThese entries appear in the coefficient coupling of the Stochastic Galerkin (SG) projection for Polynomial Chaos Expansion (PCE) discretizations of linear elliptic stochastic partial differential equations with affine Gaussian inputs.\n\nUsing only the orthonormality, the three-term recurrence, and standard properties of Hermite polynomials, determine explicitly all nonzero values of $G_{ijk}$ with $i,j,k \\in \\{0,1,2,3\\}$. Then, using those values, compute the squared Frobenius norm of the resulting $4 \\times 4 \\times 4$ subtensor,\n$$\nS \\equiv \\sum_{i=0}^{3}\\sum_{j=0}^{3}\\sum_{k=0}^{3} G_{ijk}^{2}.\n$$\nProvide your final answer as a single real number. No rounding is required.", "solution": "The user wants me to validate and solve a quantitative problem.\n\n### Step 1: Extract Givens\n-   **Random Variable**: $X \\sim \\mathcal{N}(0,1)$, a standard one-dimensional Gaussian random variable.\n-   **Basis**: Orthonormal probabilists' Hermite polynomial basis $\\{h_{n}(x)\\}_{n \\ge 0}$.\n-   **Basis Definition**: $h_{n}(x) = \\mathrm{He}_{n}(x)/\\sqrt{n!}$, where $\\mathrm{He}_{n}$ are the probabilists' Hermite polynomials.\n-   **Weighting Function**: Orthogonality is with respect to the standard normal density $\\varrho(x) = (2\\pi)^{-1/2}\\exp(-x^{2}/2)$.\n-   **Orthonormality Relation**: $\\mathbb{E}[h_{m}(X) h_{n}(X)] = \\delta_{mn}$, where $\\mathbb{E}[\\cdot]$ is the expectation with respect to $X$, and $\\delta_{mn}$ is the Kronecker delta.\n-   **Three-Term Recurrence Relation**: $x\\,h_{n}(x) = \\sqrt{n+1}\\,h_{n+1}(x) + \\sqrt{n}\\,h_{n-1}(x)$ for all $n \\ge 0$, with the convention $h_{-1}(x) \\equiv 0$.\n-   **Object of Interest**: The triple-product tensor entries $G_{ijk} \\equiv \\mathbb{E}\\big[h_{i}(X)\\,h_{j}(X)\\,h_{k}(X)\\big]$, for $i,j,k \\in \\mathbb{N}_{0}$.\n-   **Task**:\n    1.  Determine all nonzero values of $G_{ijk}$ for indices $i,j,k \\in \\{0,1,2,3\\}$.\n    2.  Compute the squared Frobenius norm of the resulting $4 \\times 4 \\times 4$ subtensor, defined as $S \\equiv \\sum_{i=0}^{3}\\sum_{j=0}^{3}\\sum_{k=0}^{3} G_{ijk}^{2}$.\n\n### Step 2: Validate Using Extracted Givens\n1.  **Scientific Grounding**: The problem is firmly rooted in the theory of orthogonal polynomials, specifically Hermite polynomials, and their application in uncertainty quantification via Polynomial Chaos Expansions (PCE). The provided definitions and relations (orthonormality, recurrence) are standard and correct for the probabilists' Hermite polynomials. The problem is scientifically and mathematically sound.\n2.  **Well-Posedness**: The problem is clearly defined. It requests the computation of specific tensor entries and a subsequent sum. The provided information is sufficient to determine a unique, meaningful solution.\n3.  **Objectivity**: The problem is stated in precise, formal language, free of any subjectivity or ambiguity.\n4.  **Flaw Analysis**:\n    -   There are no violations of scientific principles.\n    -   The problem is directly relevant to the specified topic, a core calculation in implementing Stochastic Galerkin methods.\n    -   The setup is complete and consistent. For instance, for $n=0$, the recurrence gives $x h_0(x) = \\sqrt{1} h_1(x)$. From orthonormality, $\\mathbb{E}[h_0(X)^2]=1$, which implies $h_0(x)=1$ as it is a degree-$0$ polynomial. Thus, $h_1(x) = x$, which is correct for probabilists' Hermite polynomials.\n    -   The calculation is computationally intensive but entirely feasible and standard.\n    -   The problem structure is sound and leads to a unique answer.\n\n### Step 3: Verdict and Action\nThe problem is valid. I will now proceed with a full solution.\n\nThe problem asks for the computation of the sum of squares of the triple-product tensor entries, $S \\equiv \\sum_{i=0}^{3}\\sum_{j=0}^{3}\\sum_{k=0}^{3} G_{ijk}^{2}$. The entries are defined as $G_{ijk} = \\mathbb{E}[h_i(X)h_j(X)h_k(X)]$. The expectation is an integral with respect to the standard normal measure:\n$$\nG_{ijk} = \\int_{-\\infty}^{\\infty} h_i(x)h_j(x)h_k(x) \\frac{1}{\\sqrt{2\\pi}} \\exp\\left(-\\frac{x^2}{2}\\right) dx.\n$$\nThe tensor $G_{ijk}$ is symmetric with respect to any permutation of its indices $(i,j,k)$ because multiplication is commutative.\n\nWe can derive a recurrence relation for $G_{ijk}$ using the provided three-term recurrence for the polynomials. Let's assume, without loss of generality, that $k \\ge 1$. The recurrence relation can be rearranged to express $h_k(x)$:\n$$\nh_k(x) = \\frac{1}{\\sqrt{k}} \\left( x h_{k-1}(x) - \\sqrt{k-1} h_{k-2}(x) \\right), \\quad k \\ge 1.\n$$\nSubstituting this into the definition of $G_{ijk}$:\n$$\nG_{ijk} = \\mathbb{E}\\left[h_i(X) h_j(X) \\frac{1}{\\sqrt{k}} \\left( X h_{k-1}(X) - \\sqrt{k-1} h_{k-2}(X) \\right)\\right].\n$$\n$$\nG_{ijk} = \\frac{1}{\\sqrt{k}} \\mathbb{E}\\left[X h_i(X) h_j(X) h_{k-1}(X)\\right] - \\sqrt{\\frac{k-1}{k}} \\mathbb{E}\\left[h_i(X) h_j(X) h_{k-2}(X)\\right].\n$$\nThe second term is $-\\sqrt{\\frac{k-1}{k}} G_{i,j,k-2}$. For the first term, we use the property that the multiplication-by-$x$ operator is self-adjoint in the associated Hilbert space. Thus $\\mathbb{E}[f(X) g(X) X h(X)] = \\mathbb{E}[(X f(X)) g(X) h(X)]$. We apply the recurrence relation to $X h_i(X)$:\n$$\nX h_i(X) = \\sqrt{i+1}\\,h_{i+1}(X) + \\sqrt{i}\\,h_{i-1}(X).\n$$\nSubstituting this into the first term's expectation:\n$$\n\\mathbb{E}\\left[(\\sqrt{i+1}\\,h_{i+1}(X) + \\sqrt{i}\\,h_{i-1}(X)) h_j(X) h_{k-1}(X)\\right] = \\sqrt{i+1} G_{i+1,j,k-1} + \\sqrt{i} G_{i-1,j,k-1}.\n$$\nCombining these results gives a recurrence for $G_{ijk}$ (assuming $k \\ge 1$):\n$$\nG_{ijk} = \\frac{\\sqrt{i+1}}{\\sqrt{k}} G_{i+1,j,k-1} + \\frac{\\sqrt{i}}{\\sqrt{k}} G_{i-1,j,k-1} - \\sqrt{\\frac{k-1}{k}} G_{i,j,k-2}.\n$$\nThe base cases for the recurrence are for $k=0$. From the definition, $h_0(x)=1$.\n$$\nG_{ij0} = \\mathbb{E}[h_i(X)h_j(X)h_0(X)] = \\mathbb{E}[h_i(X)h_j(X)] = \\delta_{ij}.\n$$\nWe now compute the necessary non-zero entries for $i,j,k \\in \\{0,1,2,3\\}$. Due to symmetry, we only need to calculate for $i \\le j \\le k$.\n\n**Case k=0:**\n$G_{ij0} = \\delta_{ij}$. The only non-zero values (up to permutation) are:\n- $G_{000} = \\delta_{00} = 1$.\n- $G_{110} = \\delta_{11} = 1$.\n- $G_{220} = \\delta_{22} = 1$.\n- $G_{330} = \\delta_{33} = 1$.\n\n**Case k=1:**\nThe recurrence for $k=1$ simplifies to:\n$G_{ij1} = \\sqrt{i+1} G_{i+1,j,0} + \\sqrt{i} G_{i-1,j,0} = \\sqrt{i+1} \\delta_{i+1,j} + \\sqrt{i} \\delta_{i-1,j}$.\nThis is non-zero only if $j=i+1$ or $j=i-1$. With $i \\le j$, we only need $j=i+1$.\n- $G_{011} = \\sqrt{0+1} \\delta_{1,1} + 0 = 1$.\n- $G_{121} = \\sqrt{1+1} \\delta_{2,2} + \\sqrt{1} \\delta_{0,2} = \\sqrt{2}$. (By symmetry, this is $G_{112}$).\n- $G_{231} = \\sqrt{2+1} \\delta_{3,3} + \\sqrt{2} \\delta_{1,3} = \\sqrt{3}$. (By symmetry, this is $G_{123}, G_{132}$, etc.).\nA key property is that $G_{ijk}$ is non-zero only if $i+j+k$ is an even integer. This is because Hermite polynomials have the parity of their degree, and the integral of an odd function over a symmetric domain is zero. All $G_{ijk}$ with an odd sum of indices are zero (e.g., $G_{111}=0, G_{122}=0$).\n\n**Case k=2:**\n$G_{ij2} = \\frac{1}{\\sqrt{2}}(\\sqrt{i+1} G_{i+1, j, 1} + \\sqrt{i} G_{i-1, j, 1} - G_{ij0})$.\n- $G_{022} = \\frac{1}{\\sqrt{2}}(\\sqrt{1} G_{121} - G_{020}) = \\frac{1}{\\sqrt{2}}(\\sqrt{2} - 0) = 1$.\n- $G_{112} = \\frac{1}{\\sqrt{2}}(\\sqrt{2} G_{211} + \\sqrt{1} G_{011} - G_{110}) = \\frac{1}{\\sqrt{2}}(\\sqrt{2}(\\sqrt{2}) + 1 - 1) = \\frac{2}{\\sqrt{2}} = \\sqrt{2}$.\n- $G_{132} = \\frac{1}{\\sqrt{2}}(\\sqrt{2} G_{231} + \\sqrt{1} G_{031} - G_{130}) = \\frac{1}{\\sqrt{2}}(\\sqrt{2}(\\sqrt{3}) + 0 - 0) = \\sqrt{3}$.\n- $G_{222} = \\frac{1}{\\sqrt{2}}(\\sqrt{3} G_{321} + \\sqrt{2} G_{121} - G_{220}) = \\frac{1}{\\sqrt{2}}(\\sqrt{3}(\\sqrt{3}) + \\sqrt{2}(\\sqrt{2}) - 1) = \\frac{3+2-1}{\\sqrt{2}} = \\frac{4}{\\sqrt{2}} = 2\\sqrt{2}$.\n- $G_{332} = \\frac{1}{\\sqrt{2}}(\\sqrt{4} G_{431} + \\sqrt{3} G_{231} - G_{330})$. We need $G_{431} = \\sqrt{3+1}\\delta_{44} + \\sqrt{3}\\delta_{24} = 2$.\n  $G_{332} = \\frac{1}{\\sqrt{2}}(2(2) + \\sqrt{3}(\\sqrt{3}) - 1) = \\frac{4+3-1}{\\sqrt{2}} = \\frac{6}{\\sqrt{2}} = 3\\sqrt{2}$.\n\n**Case k=3:**\n$G_{ij3} = \\frac{1}{\\sqrt{3}}(\\sqrt{i+1} G_{i+1, j, 2} + \\sqrt{i} G_{i-1, j, 2} - \\sqrt{2} G_{ij1})$.\n- $G_{033} = \\frac{1}{\\sqrt{3}}(\\sqrt{1} G_{132} - \\sqrt{2} G_{031}) = \\frac{1}{\\sqrt{3}}(\\sqrt{3} - 0) = 1$.\n- $G_{123} = \\frac{1}{\\sqrt{3}}(\\sqrt{2} G_{222} + \\sqrt{1} G_{022} - \\sqrt{2} G_{121}) = \\frac{1}{\\sqrt{3}}(\\sqrt{2}(2\\sqrt{2}) + 1 - \\sqrt{2}(\\sqrt{2})) = \\frac{4+1-2}{\\sqrt{3}} = \\frac{3}{\\sqrt{3}} = \\sqrt{3}$.\n- $G_{233} = \\frac{1}{\\sqrt{3}}(\\sqrt{3} G_{332} + \\sqrt{2} G_{132} - \\sqrt{2} G_{231}) = \\frac{1}{\\sqrt{3}}(\\sqrt{3}(3\\sqrt{2}) + \\sqrt{2}(\\sqrt{3}) - \\sqrt{2}(\\sqrt{3})) = \\frac{3\\sqrt{6}}{\\sqrt{3}} = 3\\sqrt{2}$.\n\n**Summary of non-zero $G_{ijk}$ values and their squared magnitudes:**\nThe non-zero values occur for specific combinations of indices. We list the unique values (up to permutation), their squared values, and the number of distinct permutations of their indices.\n- Indices $\\{0,0,0\\}$: $G_{000}=1$. $G_{000}^2 = 1$. There is $1$ permutation. Contribution to sum: $1 \\times 1 = 1$.\n- Indices $\\{0,1,1\\}$: $G_{011}=1$. $G_{011}^2 = 1$. There are $3$ permutations: $(0,1,1), (1,0,1), (1,1,0)$. Contribution: $3 \\times 1 = 3$.\n- Indices $\\{0,2,2\\}$: $G_{022}=1$. $G_{022}^2 = 1$. There are $3$ permutations. Contribution: $3 \\times 1 = 3$.\n- Indices $\\{0,3,3\\}$: $G_{033}=1$. $G_{033}^2 = 1$. There are $3$ permutations. Contribution: $3 \\times 1 = 3$.\n- Indices $\\{1,1,2\\}$: $G_{112}=\\sqrt{2}$. $G_{112}^2 = 2$. There are $3$ permutations. Contribution: $3 \\times 2 = 6$.\n- Indices $\\{1,2,3\\}$: $G_{123}=\\sqrt{3}$. $G_{123}^2 = 3$. There are $3! = 6$ permutations as all indices are distinct. Contribution: $6 \\times 3 = 18$.\n- Indices $\\{2,2,2\\}$: $G_{222}=2\\sqrt{2}$. $G_{222}^2 = 8$. There is $1$ permutation. Contribution: $1 \\times 8 = 8$.\n- Indices $\\{2,3,3\\}$: $G_{233}=3\\sqrt{2}$. $G_{233}^2 = 18$. There are $3$ permutations. Contribution: $3 \\times 18 = 54$.\n\nAll other $G_{ijk}$ with $i,j,k \\in \\{0,1,2,3\\}$ are zero, either due to the parity rule (sum of indices is odd) or the triangle inequality selection rule (which is implicitly handled by the recurrence).\n\n**Final Calculation of S:**\nWe sum the contributions from all non-zero entries:\n$$\nS = \\sum_{i=0}^{3}\\sum_{j=0}^{3}\\sum_{k=0}^{3} G_{ijk}^{2} = 1 + 3 + 3 + 3 + 6 + 18 + 8 + 54.\n$$\n$$\nS = 10 + 6 + 18 + 8 + 54 = 16 + 18 + 8 + 54 = 34 + 8 + 54 = 42 + 54 = 96.\n$$\nThe squared Frobenius norm of the subtensor is $96$.", "answer": "$$\n\\boxed{96}\n$$", "id": "3432918"}]}