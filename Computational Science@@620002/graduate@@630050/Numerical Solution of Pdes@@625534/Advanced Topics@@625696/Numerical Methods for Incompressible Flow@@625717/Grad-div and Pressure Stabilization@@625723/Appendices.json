{"hands_on_practices": [{"introduction": "To truly understand why stabilization is necessary, it is instructive to first witness the failure of an unstabilized method. This practice guides you through the explicit construction of a spurious \"checkerboard\" pressure mode for the classic $Q_1-Q_1$ (bilinear velocity and pressure) element pair. By showing that this non-physical pressure field, paired with a zero velocity field, can satisfy the discrete Stokes equations, you will gain a concrete understanding of the discrete inf-sup instability.", "problem": "Consider the steady incompressible Stokes problem on the unit square domain $\\Omega = (0,1) \\times (0,1)$ with homogeneous Dirichlet boundary conditions for the velocity: find $(u,p)$ such that\n$$\n-\\nu \\Delta u + \\nabla p = 0 \\quad \\text{in } \\Omega,\\qquad \\nabla \\cdot u = 0 \\quad \\text{in } \\Omega,\\qquad u=0 \\quad \\text{on } \\partial\\Omega,\n$$\nwhere $\\nu>0$ is the kinematic viscosity. The weak formulation uses the standard bilinear forms\n$$\na(u,v) := \\nu \\int_{\\Omega} \\nabla u : \\nabla v \\, dx,\\qquad b(v,q) := - \\int_{\\Omega} q \\, \\nabla \\cdot v \\, dx,\n$$\nfor $v$ in an $H^{1}$-conforming velocity test space and $q$ in an $L^{2}$-conforming pressure test space. Let $\\mathcal{T}_h$ be the uniform partition of $\\Omega$ into $2 \\times 2$ congruent axis-aligned squares. Let $V_h \\subset H^{1}_{0}(\\Omega)^{2}$ be the conforming continuous bilinear space (tensor-product of one-dimensional linear polynomials) for the velocity, and $Q_h \\subset L^{2}_{0}(\\Omega)$ be the conforming continuous bilinear space for the pressure, both defined on $\\mathcal{T}_h$ (i.e., equal-order $Q_1$–$Q_1$). Assume the pressure-velocity coupling bilinear form is assembled using a single-point (element-center) quadrature rule on each element, while the diffusion bilinear form $a(\\cdot,\\cdot)$ is assembled exactly. No grad-div stabilization and no Pressure-Stabilizing Petrov-Galerkin (PSPG) stabilization are used.\n\n1. Using only the above foundations (variational formulation, finite element definitions, and the specified quadrature), construct an explicit nontrivial discrete pressure $p_h \\in Q_h$ and a discrete velocity $v_h \\in V_h$ that solve the discrete homogeneous Stokes equations\n$$\na(v_h,w_h) + b(w_h,p_h) = 0 \\quad \\forall\\, w_h \\in V_h,\\qquad b(v_h,q_h)=0 \\quad \\forall\\, q_h \\in Q_h,\n$$\nand thereby demonstrate a violation of the discrete inf-sup condition. Your construction must be explicit on the $2 \\times 2$ uniform mesh with nodes $(i/2,j/2)$ for $i,j \\in \\{0,1,2\\}$, and should rely only on properties of $Q_1$ shape functions and the stated quadrature.\n\n2. In the absence of stabilization, define the oscillatory pressure error as the $L^{2}$-norm of the constructed $p_h$ (the exact pressure for the homogeneous problem is identically zero). Compute the exact value of\n$$\n\\|p_h\\|_{L^{2}(\\Omega)}.\n$$\n\nExpress your final answer to the second part as an exact value with no units. If you choose to scale your constructed $p_h$ by a constant amplitude, set that amplitude equal to $1$ so that the final value is uniquely determined.", "solution": "The problem asks for the construction of a spurious solution to the discrete Stokes equations on a specific finite element setup, and for the computation of the $L^2$-norm of the spurious pressure component.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n- **Governing Equations:** Steady incompressible Stokes equations on $\\Omega = (0,1) \\times (0,1)$.\n  $$-\\nu \\Delta u + \\nabla p = 0 \\quad \\text{in } \\Omega$$\n  $$\\nabla \\cdot u = 0 \\quad \\text{in } \\Omega$$\n- **Boundary Conditions:** Homogeneous Dirichlet for velocity, $u=0$ on $\\partial\\Omega$.\n- **Weak Formulation:**\n  - Find $(u,p)$ such that:\n    $$a(u,v) + b(v,p) = 0 \\quad \\text{for all test functions } v$$\n    $$b(u,q) = 0 \\quad \\text{for all test functions } q$$\n  - Bilinear forms:\n    $$a(u,v) := \\nu \\int_{\\Omega} \\nabla u : \\nabla v \\, dx$$\n    $$b(v,q) := - \\int_{\\Omega} q \\, \\nabla \\cdot v \\, dx$$\n- **Discretization:**\n  - **Mesh $\\mathcal{T}_h$:** Uniform partition of $\\Omega$ into $2 \\times 2$ congruent square elements. The nodes are at coordinates $(i/2, j/2)$ for $i,j \\in \\{0,1,2\\}$. The side length of each element is $h=1/2$.\n  - **Velocity Space $V_h$:** Continuous bilinear functions ($Q_1$) for each velocity component, satisfying the homogeneous boundary conditions. $V_h \\subset H^{1}_{0}(\\Omega)^{2}$.\n  - **Pressure Space $Q_h$:** Continuous bilinear functions ($Q_1$) with a zero-mean constraint. $Q_h \\subset L^{2}_{0}(\\Omega)$.\n- **Numerical Integration:**\n  - The diffusion form $a(\\cdot,\\cdot)$ is assembled exactly.\n  - The pressure-velocity coupling form $b(\\cdot,\\cdot)$ is approximated by a single-point quadrature rule at the center of each element. Let's denote this by $b_h(\\cdot, \\cdot)$.\n- **Stabilization:** None. Neither grad-div nor PSPG stabilization is used.\n- **Task:**\n  1. Construct a non-trivial solution $(v_h, p_h)$ to the discrete homogeneous system:\n     $$a(v_h,w_h) + b_h(w_h,p_h) = 0 \\quad \\forall\\, w_h \\in V_h$$\n     $$b_h(v_h,q_h) = 0 \\quad \\forall\\, q_h \\in Q_h$$\n  2. Compute $\\|p_h\\|_{L^2(\\Omega)}$ for the constructed pressure, with its amplitude constant set to $1$.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is a standard textbook example used to illustrate the instability of the equal-order $Q_1-Q_1$ finite element pair for the Stokes problem, particularly when under-integrated.\n- **Scientifically Grounded:** The problem is firmly located within the theory of numerical methods for partial differential equations and is a classic example of numerical instability. It is scientifically and mathematically sound.\n- **Well-Posed:** The problem statement is precise, providing all necessary definitions, spaces, and numerical procedures to construct the required solution and perform the calculation. The question itself is well-posed.\n- **Objective:** The language is formal and objective.\n\nThe problem statement is valid.\n\n### Solution\n\n**Part 1: Construction of a Spurious Solution**\n\nA non-trivial solution to the homogeneous discrete Stokes equations, particularly one with a non-zero pressure component, demonstrates a violation of the discrete inf-sup (Ladyzhenskaya-Babuška-Brezzi) condition. Such a pressure $p_h$ lies in the kernel of the discrete divergence operator's transpose. We seek a non-zero $p_h \\in Q_h$ and a $v_h \\in V_h$ such that the discrete system is satisfied.\n\nThe crucial element is the use of single-point quadrature for the bilinear form $b(v,q)$. The resulting discrete form $b_h(v,q)$ is:\n$$b_h(v,q) = - \\sum_{K \\in \\mathcal{T}_h} |K| q(x_K) (\\nabla \\cdot v)(x_K)$$\nwhere $K$ denotes an element, $|K|$ is its area, and $x_K$ is its center.\n\nWe propose a pressure field $p_h \\in Q_h$ known as a \"checkerboard\" mode. Let the nodes of the mesh be $(x_i, y_j) = (i/2, j/2)$ for $i,j \\in \\{0,1,2\\}$. We define $p_h$ by its nodal values $P_{i,j}$:\n$$P_{i,j} = (-1)^{i+j}$$\nThe amplitude constant is set to $1$ as per the problem. The pressure field is then $p_h(x,y) = \\sum_{i,j=0}^2 P_{i,j} \\phi_{i,j}(x,y)$, where $\\phi_{i,j}$ are the standard $Q_1$ basis functions.\n\nFor a bilinear ($Q_1$) element, the value of the function at the element's center is the average of its values at the four corner nodes. Let's verify this for each of the four elements in the $2 \\times 2$ mesh.\n- **Element $K_1 = [0, 1/2] \\times [0, 1/2]$:** Nodes at $(0,0), (1/2,0), (0,1/2), (1/2,1/2)$. Nodal indices are $(0,0), (1,0), (0,1), (1,1)$.\nThe nodal values of $p_h$ are $P_{0,0}=1, P_{1,0}=-1, P_{0,1}=-1, P_{1,1}=1$.\nThe value at the center $x_{K_1}=(1/4, 1/4)$ is $p_h(x_{K_1}) = \\frac{1}{4}(P_{0,0} + P_{1,0} + P_{0,1} + P_{1,1}) = \\frac{1}{4}(1 - 1 - 1 + 1) = 0$.\n- **Element $K_2 = [1/2, 1] \\times [0, 1/2]$:** Nodes at $(1/2,0), (1,0), (1/2,1/2), (1,1/2)$. Nodal indices $(1,0), (2,0), (1,1), (2,1)$.\nNodal values: $P_{1,0}=-1, P_{2,0}=1, P_{1,1}=1, P_{2,1}=-1$.\nValue at center $x_{K_2}=(3/4, 1/4)$: $p_h(x_{K_2}) = \\frac{1}{4}(-1 + 1 + 1 - 1) = 0$.\n- **Element $K_3 = [0, 1/2] \\times [1/2, 1]$:** Nodes at $(0,1/2), (1/2,1/2), (0,1), (1/2,1)$. Nodal indices $(0,1), (1,1), (0,2), (1,2)$.\nNodal values: $P_{0,1}=-1, P_{1,1}=1, P_{0,2}=1, P_{1,2}=-1$.\nValue at center $x_{K_3}=(1/4, 3/4)$: $p_h(x_{K_3}) = \\frac{1}{4}(-1 + 1 + 1 - 1) = 0$.\n- **Element $K_4 = [1/2, 1] \\times [1/2, 1]$:** Nodes at $(1/2,1/2), (1,1/2), (1/2,1), (1,1)$. Nodal indices $(1,1), (2,1), (1,2), (2,2)$.\nNodal values: $P_{1,1}=1, P_{2,1}=-1, P_{1,2}=-1, P_{2,2}=1$.\nValue at center $x_{K_4}=(3/4, 3/4)$: $p_h(x_{K_4}) = \\frac{1}{4}(1 - 1 - 1 + 1) = 0$.\n\nSince $p_h(x_K) = 0$ for all four elements $K$, the discrete pressure-velocity coupling term becomes:\n$$b_h(w_h, p_h) = - \\sum_{K \\in \\mathcal{T}_h} |K| \\underbrace{p_h(x_K)}_{0} (\\nabla \\cdot w_h)(x_K) = 0$$\nThis holds for any test function $w_h \\in V_h$.\n\nNow we must verify that this $p_h$ is a valid member of $Q_h$, i.e., $p_h \\in L^2_0(\\Omega)$ or $\\int_\\Omega p_h dx = 0$.\nThe integral of a $Q_1$ basis function $\\phi_{i,j}$ over the domain $\\Omega$ is related to its surrounding elements. Let $|K|=(1/2)^2=1/4$ be the area of one element.\n- Corner node (e.g., $(0,0)$): $\\int_\\Omega \\phi_{0,0} dx = \\frac{1}{4}|K| = \\frac{1}{16}$.\n- Edge node (e.g., $(1/2,0)$): $\\int_\\Omega \\phi_{1,0} dx = \\frac{1}{4}|K| + \\frac{1}{4}|K| = \\frac{1}{2}|K| = \\frac{1}{8}$.\n- Center node ($(1/2,1/2)$): $\\int_\\Omega \\phi_{1,1} dx = 4 \\times (\\frac{1}{4}|K|) = |K| = \\frac{1}{4}$.\nThe mean of $p_h$ is:\n$$\\int_\\Omega p_h dx = \\sum_{i,j=0}^2 P_{i,j} \\int_\\Omega \\phi_{i,j} dx$$\nThere are $4$ corner nodes (_c_), $4$ edge nodes (_e_), and $1$ center node (_m_).\n$$P_c = P_{0,0}=P_{2,0}=P_{0,2}=P_{2,2}=1$$\n$$P_e = P_{1,0}=P_{0,1}=P_{2,1}=P_{1,2}=-1$$\n$$P_m = P_{1,1}=1$$\n$$\\int_\\Omega p_h dx = 4 \\cdot P_c \\cdot \\frac{1}{16} + 4 \\cdot P_e \\cdot \\frac{1}{8} + 1 \\cdot P_m \\cdot \\frac{1}{4} = 4(1)\\frac{1}{16} + 4(-1)\\frac{1}{8} + 1(1)\\frac{1}{4} = \\frac{1}{4} - \\frac{1}{2} + \\frac{1}{4} = 0$$\nSo, $p_h \\in Q_h$.\n\nWith this $p_h$, the first discrete Stokes equation becomes:\n$$a(v_h, w_h) + b_h(w_h, p_h) = a(v_h, w_h) + 0 = 0 \\quad \\forall w_h \\in V_h$$\nWe choose $v_h = 0$. Then $a(0, w_h) = 0$, satisfying the equation.\nThe second discrete Stokes equation is:\n$$b_h(v_h, q_h) = b_h(0, q_h) = 0 \\quad \\forall q_h \\in Q_h$$\nThis is also satisfied.\nThus, the pair $(v_h, p_h) = (0, \\text{checkerboard mode})$ is a non-trivial solution to the discrete homogeneous system. $p_h$ is non-zero (since its nodal values are not all zero), while $v_h$ is zero. This construction demonstrates the violation of the discrete inf-sup condition.\n\n**Part 2: Computation of $\\|p_h\\|_{L^2(\\Omega)}$**\n\nWe need to compute $\\|p_h\\|_{L^2(\\Omega)} = \\left(\\int_{\\Omega} p_h(x,y)^2 dx dy\\right)^{1/2}$. We can compute this by summing the integrals over the four elements:\n$$\\|p_h\\|^2_{L^2(\\Omega)} = \\sum_{e=1}^4 \\int_{K_e} p_h(x,y)^2 dx dy$$\nLet's find the analytical form for $p_h$ on an element. On a reference element $[0,1]^2$ with coordinates $(\\hat{x}, \\hat{y})$, a bilinear function is given by $f(\\hat{x},\\hat{y}) = \\sum_{i,j=0}^1 f_{ij} (1-|\\hat{x}-i|)(1-|\\hat{y}-j|)$. On element $K_1=[0,1/2]\\times[0,1/2]$, the local coordinates are $\\hat{x}=2x, \\hat{y}=2y$. The nodal values are $P_{0,0}=1, P_{1,0}=-1, P_{0,1}=-1, P_{1,1}=1$.\nThe function on the reference element $[0,1]^2$ is:\n$$p_h(\\hat{x},\\hat{y}) = (1-\\hat{x})(1-\\hat{y})(1) + \\hat{x}(1-\\hat{y})(-1) + (1-\\hat{x})\\hat{y}(-1) + \\hat{x}\\hat{y}(1)$$\n$$= (1-\\hat{y})(1-\\hat{x}-\\hat{x}) + \\hat{y}(-1+\\hat{x}+\\hat{x}) = (1-\\hat{y})(1-2\\hat{x}) + \\hat{y}(2\\hat{x}-1) = (1-2\\hat{y})(1-2\\hat{x})$$\nSubstituting back $\\hat{x}=2x, \\hat{y}=2y$, we get $p_h(x,y) = (1-4x)(1-4y)$ for $(x,y) \\in K_1$.\nThe integral over $K_1$ is:\n$$\\int_{K_1} p_h^2 dx dy = \\int_0^{1/2} \\int_0^{1/2} (1-4x)^2 (1-4y)^2 dx dy$$\nThe integral is separable:\n$$\\left( \\int_0^{1/2} (1-4x)^2 dx \\right) \\left( \\int_0^{1/2} (1-4y)^2 dy \\right)$$\nLet's compute one of the integrals. Let $u = 1-4x$, so $du = -4dx$.\n$$\\int_0^{1/2} (1-4x)^2 dx = \\int_1^{-1} u^2 \\left(-\\frac{1}{4}\\right) du = \\frac{1}{4} \\int_{-1}^1 u^2 du = \\frac{1}{4} \\left[ \\frac{u^3}{3} \\right]_{-1}^1 = \\frac{1}{4} \\left( \\frac{1}{3} - \\frac{-1}{3} \\right) = \\frac{1}{4} \\cdot \\frac{2}{3} = \\frac{1}{6}$$\nThus, the integral over $K_1$ is $\\frac{1}{6} \\times \\frac{1}{6} = \\frac{1}{36}$.\n\nBy symmetry, the integral over each of the four elements is the same. For instance, on $K_4=[1/2,1]\\times[1/2,1]$, $\\hat{x}=2x-1, \\hat{y}=2y-1$. The nodal values are $(1,-1,-1,1)$, same as $K_1$. So $p_h(x,y) = (1-2\\hat{x})(1-2\\hat{y}) = (1-2(2x-1))(1-2(2y-1)) = (3-4x)(3-4y)$. The integral $\\int_{1/2}^1(3-4x)^2 dx$ also evaluates to $1/6$.\nOn $K_2$ and $K_3$, the nodal value pattern is $(-1,1,1,-1)$, which is the negative of the pattern on $K_1$. The function is $p_h(\\hat{x},\\hat{y})=(2\\hat{x}-1)(1-2\\hat{y})$. Squaring this function gives the same result upon integration.\nTherefore, the total integral is four times the integral over one element:\n$$\\|p_h\\|^2_{L^2(\\Omega)} = 4 \\times \\frac{1}{36} = \\frac{1}{9}$$\nThe $L^2$-norm is the square root of this value:\n$$\\|p_h\\|_{L^2(\\Omega)} = \\sqrt{\\frac{1}{9}} = \\frac{1}{3}$$\nThis is the exact value of the norm for the specified checkerboard pressure mode with amplitude $1$.", "answer": "$$\\boxed{\\frac{1}{3}}$$", "id": "3401415"}, {"introduction": "Once the need for stabilization is established, the next question is how to design it properly. This exercise delves into the theoretical foundation of the widely used Pressure-Stabilizing Petrov-Galerkin (PSPG) method by deriving the stabilization parameter $\\tau_K$ from first principles. By relating the algebraic stabilization to an ideal operator based on the element-wise Green's function, you will see how $\\tau_K$ can be chosen to ensure stability in a physically and mathematically consistent way.", "problem": "Consider the steady Stokes equations with constant kinematic viscosity $\\nu>0$ on the unit square $\\Omega=(0,1)^{2}$ with homogeneous Dirichlet velocity boundary conditions. Let $\\mathcal{T}_{h}$ be a quasi-uniform partition of $\\Omega$ into axis-aligned squares of side length $h_{K}$ (so $h_{K}=h$ for all $K\\in\\mathcal{T}_{h}$), and consider equal-order continuous bilinear finite element spaces for velocity and pressure. Denote by $a(\\boldsymbol{u},\\boldsymbol{v})=\\nu\\int_{\\Omega}\\nabla \\boldsymbol{u}:\\nabla \\boldsymbol{v}\\,dx$ and $b(\\boldsymbol{v},q)=-\\int_{\\Omega}q\\,\\nabla\\cdot \\boldsymbol{v}\\,dx$ the standard bilinear forms. A residual-based pressure-stabilizing/Petrov-Galerkin (PSPG) stabilization augments the mixed method by adding, for pressure test functions $q_{h}$, the elementwise term\n$$\ns_{h}\\big((\\boldsymbol{u}_{h},p_{h}),(0,q_{h})\\big)\\;=\\;\\sum_{K\\in\\mathcal{T}_{h}}\\tau_{K}\\,\\big(-\\nu\\Delta \\boldsymbol{u}_{h}+\\nabla p_{h}-\\boldsymbol{f},\\,\\nabla q_{h}\\big)_{K},\n$$\nwhere $(\\cdot,\\cdot)_{K}$ denotes the $L^{2}(K)$ inner product and $\\tau_{K}>0$ is a scalar parameter to be chosen elementwise. One way to motivate $\\tau_{K}$ is to compare $s_{h}$ to an “ideal” local stabilization that uses the element Green’s operator $G_{K}:L^{2}(K)^{2}\\to H_{0}^{1}(K)^{2}$ defined by $-\\Delta \\boldsymbol{w}= \\boldsymbol{\\phi}$ in $K$ with $\\boldsymbol{w}=\\boldsymbol{0}$ on $\\partial K$. In particular, for $\\boldsymbol{\\phi}=\\nabla q_{h}$ and the Dirichlet Laplacian eigenpairs $\\{-\\Delta \\varphi_{m}=\\lambda_{m}\\varphi_{m}\\}$ on $K$, the spectral representation implies the bounds\n$$\n\\frac{1}{\\lambda_{\\max}(K)}\\,\\|\\nabla q_{h}\\|_{0,K}^{2}\\ \\le\\ \\big(\\nabla q_{h},\\,G_{K}\\,\\nabla q_{h}\\big)_{K}\\ \\le\\ \\frac{1}{\\lambda_{1}(K)}\\,\\|\\nabla q_{h}\\|_{0,K}^{2},\n$$\nwith $\\lambda_{1}(K)$ the smallest eigenvalue and $\\lambda_{\\max}(K)$ the largest eigenvalue acting on the relevant finite-dimensional content of $\\nabla q_{h}$. On a square element $K$ of side $h_{K}$ with zero Dirichlet boundary conditions, the Dirichlet Laplacian eigenvalues are $\\lambda_{m,n}(K)=\\pi^{2}(m^{2}+n^{2})/h_{K}^{2}$ for integers $m,n\\ge 1$, so $\\lambda_{1}(K)=2\\pi^{2}/h_{K}^{2}$.\n\nTreating the residual-based PSPG term as the replacement of $G_{K}$ by $\\tau_{K} I$ in the quadratic form on $\\nabla q_{h}$, choose $\\tau_{K}$ so that the algebraic stabilization dominates the ideal one (thereby ensuring a mesh-independent stability lower bound for the pressure). Using only the above foundational facts and definitions, derive a closed-form expression for $\\tau_{K}$ in terms of $h_{K}$, $\\nu$, and universal constants. Provide your final $\\tau_{K}$ as a single analytic expression. No numerical rounding is required, and no units should be included in the final expression.", "solution": "The problem requires the derivation of a closed-form expression for the Pressure-Stabilizing/Petrov-Galerkin (PSPG) stabilization parameter, $\\tau_K$, for the steady Stokes equations. The derivation is to be based on a comparison with an \"ideal\" stabilization method.\n\nThe problem states that the steady Stokes equations are considered on the domain $\\Omega=(0,1)^2$ with constant kinematic viscosity $\\nu>0$. The momentum equation residual is $R_{\\boldsymbol{u}} = -\\nu\\Delta \\boldsymbol{u}_{h}+\\nabla p_{h}-\\boldsymbol{f}$. The PSPG stabilization term is given as:\n$$\ns_{h}\\big((\\boldsymbol{u}_{h},p_{h}),(0,q_{h})\\big)\\;=\\;\\sum_{K\\in\\mathcal{T}_{h}}\\tau_{K}\\,\\big(R_{\\boldsymbol{u}},\\,\\nabla q_{h}\\big)_{K}\n$$\nThis term is added to the weak form of the continuity equation. The portion of this term that acts on the pressure trial function $p_h$ and test function $q_h$ can be represented by the bilinear form $\\sum_{K \\in \\mathcal{T}_h} (\\tau_K \\nabla p_h, \\nabla q_h)_K$. The associated quadratic form on an element $K$ is $\\tau_K (\\nabla p_h, \\nabla p_h)_K = \\tau_K \\|\\nabla p_h\\|_{0,K}^2$.\n\nThe motivation for choosing $\\tau_K$ is to compare this algebraic stabilization with an \"ideal\" local stabilization. The ideal stabilization arises from the idea of inverting the differential operator within the momentum residual on each element. The relevant differential operator acting on the velocity is $-\\nu\\Delta$. Therefore, an ideal stabilization would involve the inverse operator $(-\\nu\\Delta_K)^{-1}$, where $\\Delta_K$ is the Laplacian on element $K$ with homogeneous Dirichlet boundary conditions. This inverse is the element Green's operator for the operator $-\\nu\\Delta$, which we denote as $G_{K,\\nu}$.\n\nThe problem statement defines a Green's operator $G_K$ for the canonical Laplacian, $-\\Delta$, such that $-\\Delta \\boldsymbol{w} = \\boldsymbol{\\phi}$ is solved by $\\boldsymbol{w}=G_K\\boldsymbol{\\phi}$. The relationship between $G_{K,\\nu}$ and $G_K$ is derived from their definitions:\nIf $-\\nu\\Delta \\boldsymbol{w} = \\boldsymbol{\\phi}$, then $\\boldsymbol{w} = (-\\nu\\Delta_K)^{-1}\\boldsymbol{\\phi} = \\frac{1}{\\nu}(-\\Delta_K)^{-1}\\boldsymbol{\\phi} = \\frac{1}{\\nu}G_K\\boldsymbol{\\phi}$. Thus, $G_{K,\\nu} = \\frac{1}{\\nu}G_K$. Although the problem statement makes reference to replacing $G_K$ by $\\tau_K I$, the requirement to find $\\tau_K$ as a function of $\\nu$ and the physical origin of stabilization imply that the comparison must be made with the physically correct ideal operator, $G_{K,\\nu}$.\n\nThe quadratic form associated with the ideal stabilization (acting on the pressure part of the residual) is $(\\nabla p_h, G_{K,\\nu} \\nabla p_h)_K$. Substituting the relation $G_{K,\\nu} = \\frac{1}{\\nu}G_K$, this becomes:\n$$\n(\\nabla p_h, G_{K,\\nu} \\nabla p_h)_K = \\frac{1}{\\nu}(\\nabla p_h, G_K \\nabla p_h)_K\n$$\nThe problem provides spectral bounds for the quadratic form involving $G_K$:\n$$\n\\frac{1}{\\lambda_{\\max}(K)}\\,\\|\\nabla q_{h}\\|_{0,K}^{2}\\ \\le\\ \\big(\\nabla q_{h},\\,G_{K}\\,\\nabla q_{h}\\big)_{K}\\ \\le\\ \\frac{1}{\\lambda_{1}(K)}\\,\\|\\nabla q_{h}\\|_{0,K}^{2}\n$$\nwhere $\\lambda_1(K)$ is the smallest eigenvalue of the Dirichlet Laplacian on $K$. Applying these bounds to the ideal stabilization form gives:\n$$\n\\frac{1}{\\nu\\lambda_{\\max}(K)}\\,\\|\\nabla p_{h}\\|_{0,K}^{2}\\ \\le\\ (\\nabla p_{h},\\,G_{K,\\nu}\\,\\nabla p_{h}\\big)_{K}\\ \\le\\ \\frac{1}{\\nu\\lambda_{1}(K)}\\,\\|\\nabla p_{h}\\|_{0,K}^{2}\n$$\nThe task is to choose $\\tau_K$ such that the algebraic stabilization, $\\tau_K \\|\\nabla p_h\\|_{0,K}^2$, \"dominates\" the ideal one. This is interpreted as choosing $\\tau_K$ to be on the order of the upper bound of the ideal operator's spectral radius with respect to the norm on $\\nabla p_h$. The supremum of the Rayleigh quotient for the ideal operator is bounded by $\\frac{1}{\\nu\\lambda_1(K)}$.\n$$\n\\sup_{p_h \\ne const.} \\frac{(\\nabla p_{h},\\,G_{K,\\nu}\\,\\nabla p_{h}\\big)_{K}}{\\|\\nabla p_h\\|_{0,K}^2} \\le \\frac{1}{\\nu\\lambda_1(K)}\n$$\nA standard and robust choice for the stabilization parameter is to set it equal to this upper bound, ensuring that the stabilization is sufficiently strong without being excessive.\n$$\n\\tau_K = \\frac{1}{\\nu\\lambda_{1}(K)}\n$$\nThe problem specifies that for a square element $K$ of side length $h_K$, the smallest eigenvalue of the Dirichlet Laplacian is:\n$$\n\\lambda_1(K) = \\frac{2\\pi^2}{h_K^2}\n$$\nSubstituting this into the expression for $\\tau_K$ yields the final closed-form expression:\n$$\n\\tau_K = \\frac{1}{\\nu \\left( \\frac{2\\pi^2}{h_K^2} \\right)} = \\frac{h_K^2}{2\\pi^2\\nu}\n$$\nThis expression defines the stabilization parameter $\\tau_K$ in terms of the element size $h_K$, the kinematic viscosity $\\nu$, and the universal constant $\\pi$, as required.", "answer": "$$\\boxed{\\frac{h_{K}^{2}}{2\\pi^{2}\\nu}}$$", "id": "3401450"}, {"introduction": "Beyond just preventing a single spurious mode, stabilization profoundly alters the properties of the entire discrete system, making it well-posed and easier to solve. This hands-on coding practice uses discrete Fourier analysis to precisely quantify the effect of PSPG stabilization on the pressure Schur complement for a periodic problem. You will derive the operator's Fourier symbol and use it to verify the elimination of checkerboard null modes and measure the resulting improvement in the system's condition number.", "problem": "Consider the stationary incompressible Stokes equations on the unit periodic square domain, stated in the form $-\\nu\\,\\Delta \\mathbf{u} + \\nabla p = \\mathbf{f}$ and $\\nabla\\cdot\\mathbf{u} = 0$ with constant kinematic viscosity $\\nu>0$, periodic boundary conditions on $[0,1]^2$, and zero-mean pressure constraint. Suppose the velocity $\\mathbf{u}$ and pressure $p$ are discretized on the same uniform grid with $N_x\\times N_y$ points, grid spacing $h=1/N_x$ in the $x$-direction and $h=1/N_y$ in the $y$-direction (assume $N_x=N_y$ for simplicity), and periodic boundary conditions implemented via standard central differences. The discrete linear system can be written in block form as\n$A\\mathbf{u} + Gp = \\mathbf{b}$ and $D\\mathbf{u} - Cp = 0$, where $A$ is the discrete vector Laplace operator scaled by $\\nu$, $G$ is the discrete gradient, $D$ is the discrete divergence, and $C$ is the Pressure-Stabilized Petrov-Galerkin (PSPG) stabilization operator defined by $C=\\tau L_p$, where $\\tau\\ge 0$ is a stabilization parameter and $L_p$ is the discrete scalar Laplace operator acting on the pressure field. The term $C$ is to be understood as arising from the residual-based Pressure-Stabilized Petrov-Galerkin (PSPG) method, which adds a weak consistency term proportional to the pressure gradient to stabilize equal-order velocity-pressure discretizations.\n\nYour task is to:\n- Derive the discrete Fourier symbol of the Schur complement for the pressure, based on block elimination of the velocity, under periodic boundary conditions, using the discrete central-difference gradient, divergence, and Laplacian on the uniform grid. Angles must be treated in radians.\n- Using this symbol, determine the discrete pressure nullspace structure with PSPG stabilization under periodic boundary conditions. Show from first principles that a constant pressure mode is the only null mode when $\\tau>0$, and identify any additional null modes when $\\tau=0$ due to collocated central differences.\n- Quantify the conditioning improvements produced by PSPG by computing, for each parameter set, the condition number of the discrete pressure Schur complement symbol over all nonzero Fourier modes. Define the condition number as the ratio of the largest positive symbol value to the smallest positive symbol value among all discrete modes, excluding exact or near-zero modes (use a numerical threshold of $10^{-12}$ to classify near-zero values).\n\nImplementation requirements:\n- Work in the discrete Fourier space for the uniform periodic grid. Let $\\theta_x = 2\\pi j_x/N_x$ and $\\theta_y = 2\\pi j_y/N_y$ for integer indices $j_x\\in\\{0,1,\\dots,N_x-1\\}$ and $j_y\\in\\{0,1,\\dots,N_y-1\\}$, measured in radians. Use the central difference definitions for the gradient, divergence, and Laplacian symbols, and assemble the pressure Schur complement symbol by block elimination. Do not assume or import any pre-derived target formula; instead, compute it from the fundamental discrete operators you derive.\n- For each test case, compute:\n    1. The number of discrete null modes without PSPG ($\\tau=0$), counted as the number of Fourier modes whose Schur complement symbol is below $10^{-12}$.\n    2. The number of discrete null modes with PSPG ($\\tau>0$).\n    3. The condition number without PSPG, defined as the ratio of the maximal strictly positive symbol value to the minimal strictly positive symbol value over all modes.\n    4. The condition number with PSPG, defined analogously.\n- Angles must be handled in radians, and all outputs are dimensionless real numbers or integers.\n\nTest suite:\n- Case $1$: $N_x=N_y=32$, $\\nu=1.0$, $\\tau=0.05$.\n- Case $2$: $N_x=N_y=32$, $\\nu=1.0$, $\\tau=10^{-6}$.\n- Case $3$: $N_x=N_y=16$, $\\nu=0.1$, $\\tau=0.02$.\n- Case $4$: $N_x=N_y=16$, $\\nu=1.0$, $\\tau=0.0$.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element corresponds to one test case and is itself a comma-separated list of four values $[n_0,n_{\\mathrm{PSPG}},\\kappa_0,\\kappa_{\\mathrm{PSPG}}]$ with $n_0$ the null mode count without PSPG, $n_{\\mathrm{PSPG}}$ the null mode count with PSPG, $\\kappa_0$ the condition number without PSPG, and $\\kappa_{\\mathrm{PSPG}}$ the condition number with PSPG. For example, the output should look like $[[n_0,n_{\\mathrm{PSPG}},\\kappa_0,\\kappa_{\\mathrm{PSPG}}],[\\dots],[\\dots],[\\dots]]$.", "solution": "The problem is valid as it is scientifically grounded in the numerical analysis of partial differential equations, is well-posed with sufficient information for a unique solution, and is expressed in objective, formal language. We proceed with the solution.\n\nThe task is to analyze the discrete pressure Schur complement for the Stokes equations with Pressure-Stabilized Petrov-Galerkin (PSPG) stabilization on a periodic domain. The analysis is performed in the discrete Fourier space.\n\nThe discretized Stokes system is given as:\n$$\nA\\mathbf{u} + Gp = \\mathbf{b} \\\\\nD\\mathbf{u} - Cp = 0\n$$\nwhere $\\mathbf{u}$ is the discrete velocity vector, $p$ is the discrete pressure scalar, $A$ is the discrete vector Laplacian scaled by viscosity $\\nu$, $G$ is the discrete gradient, $D$ is the discrete divergence, and $C = \\tau L_p$ is the PSPG stabilization operator, with $L_p$ being the discrete scalar Laplacian.\n\nWe perform the analysis in the discrete Fourier domain. On a uniform periodic grid with $N_x=N_y=N$ points and grid spacing $h=1/N$, a grid function $\\phi_{j_x,j_y}$ is transformed into its Fourier modes $\\hat{\\phi}(\\theta_x, \\theta_y)$, where $\\theta_x = 2\\pi m_x/N$ and $\\theta_y = 2\\pi m_y/N$ for integer wavenumbers $m_x, m_y \\in \\{0, 1, \\dots, N-1\\}$. A linear difference operator $L$ is represented in this space by its symbol $\\hat{L}(\\theta_x, \\theta_y)$, such that $\\widehat{L\\phi} = \\hat{L}\\hat{\\phi}$.\n\nFirst, we derive the symbols for the discrete operators based on standard second-order central differences.\n\nThe central difference operator for the first derivative in the $x$-direction is $(\\delta_{2x} f)_j = (f_{j+1} - f_{j-1})/(2h)$. Applying a Fourier mode $e^{i j \\theta_x}$, its symbol is:\n$$\n\\widehat{\\delta_{2x}}(\\theta_x) = \\frac{e^{i\\theta_x} - e^{-i\\theta_x}}{2h} = \\frac{2i\\sin(\\theta_x)}{2h} = \\frac{i\\sin(\\theta_x)}{h}\n$$\nThe symbol for the discrete gradient operator $G$ acting on the scalar pressure field $p$ is a vector:\n$$\n\\hat{G}(\\theta_x, \\theta_y) = \\begin{pmatrix} \\widehat{\\delta_{2x}}(\\theta_x) \\\\ \\widehat{\\delta_{2y}}(\\theta_y) \\end{pmatrix} = \\frac{i}{h} \\begin{pmatrix} \\sin(\\theta_x) \\\\ \\sin(\\theta_y) \\end{pmatrix}\n$$\nThe symbol for the discrete divergence operator $D$ acting on the vector velocity field $\\mathbf{u}$ is a row vector:\n$$\n\\hat{D}(\\theta_x, \\theta_y) = \\begin{bmatrix} \\widehat{\\delta_{2x}}(\\theta_x) & \\widehat{\\delta_{2y}}(\\theta_y) \\end{bmatrix} = \\frac{i}{h} \\begin{bmatrix} \\sin(\\theta_x) & \\sin(\\theta_y) \\end{bmatrix}\n$$\nThe standard 5-point central difference scalar Laplacian is $L_p \\phi = (\\phi_{j+1,k} + \\phi_{j-1,k} + \\phi_{j,k+1} + \\phi_{j,k-1} - 4\\phi_{j,k})/h^2$. Its symbol is:\n$$\n\\hat{L}_p(\\theta_x, \\theta_y) = \\frac{e^{i\\theta_x} + e^{-i\\theta_x} + e^{i\\theta_y} + e^{-i\\theta_y} - 4}{h^2} = \\frac{2\\cos(\\theta_x) + 2\\cos(\\theta_y) - 4}{h^2}\n$$\nUsing the identity $1 - \\cos(\\alpha) = 2\\sin^2(\\alpha/2)$, this simplifies to:\n$$\n\\hat{L}_p(\\theta_x, \\theta_y) = -\\frac{4}{h^2} \\left( \\sin^2\\left(\\frac{\\theta_x}{2}\\right) + \\sin^2\\left(\\frac{\\theta_y}{2}\\right) \\right)\n$$\nThis symbol is non-positive. The discrete vector Laplacian $A$ acts component-wise on $\\mathbf{u}$ and is scaled by $-\\nu$, so $A = -\\nu L_p I$, where $I$ is the $2 \\times 2$ identity matrix. Its symbol is a diagonal matrix:\n$$\n\\hat{A}(\\theta_x, \\theta_y) = -\\nu \\hat{L}_p(\\theta_x, \\theta_y) I = \\frac{4\\nu}{h^2} \\left( \\sin^2\\left(\\frac{\\theta_x}{2}\\right) + \\sin^2\\left(\\frac{\\theta_y}{2}\\right) \\right) I\n$$\nThe symbol for the PSPG stabilization operator $C=\\tau L_p$ is:\n$$\n\\hat{C}(\\theta_x, \\theta_y) = \\tau \\hat{L}_p(\\theta_x, \\theta_y) = -\\frac{4\\tau}{h^2} \\left( \\sin^2\\left(\\frac{\\theta_x}{2}\\right) + \\sin^2\\left(\\frac{\\theta_y}{2}\\right) \\right)\n$$\nTo find the Schur complement, we transform the block system into Fourier space:\n$$\n\\hat{A} \\hat{\\mathbf{u}} + \\hat{G} \\hat{p} = \\hat{\\mathbf{b}} \\\\\n\\hat{D} \\hat{\\mathbf{u}} - \\hat{C} \\hat{p} = 0\n$$\nFrom the first equation, we formally solve for $\\hat{\\mathbf{u}}$ for modes where $\\hat{A}$ is invertible (i.e., for all non-zero wavevectors):\n$$\n\\hat{\\mathbf{u}} = \\hat{A}^{-1}(\\hat{\\mathbf{b}} - \\hat{G} \\hat{p})\n$$\nSubstituting this into the second equation gives:\n$$\n\\hat{D} \\hat{A}^{-1}(\\hat{\\mathbf{b}} - \\hat{G} \\hat{p}) - \\hat{C} \\hat{p} = 0 \\implies (\\hat{D} \\hat{A}^{-1} \\hat{G} + \\hat{C}) \\hat{p} = \\hat{D} \\hat{A}^{-1} \\hat{\\mathbf{b}}\n$$\nThe pressure Schur complement symbol is $\\hat{S}(\\theta_x, \\theta_y) = \\hat{D} \\hat{A}^{-1} \\hat{G} + \\hat{C}$. For conditioning analysis, we work with the positive-definite operator $-\\hat{S}$. Let's denote this positive-definite symbol as $\\hat{S}_{\\text{pd}}$.\n$$\n\\hat{S}_{\\text{pd}}(\\theta_x, \\theta_y) = -(\\hat{D} \\hat{A}^{-1} \\hat{G} + \\hat{C}) = - \\hat{D}\\hat{A}^{-1}\\hat{G} - \\hat{C}\n$$\nLet's compute the terms.\n$$\n-\\hat{D}\\hat{A}^{-1}\\hat{G} = - \\left( \\frac{i}{h} \\begin{bmatrix} s_x & s_y \\end{bmatrix} \\right) \\left( \\frac{1}{-\\nu \\hat{L}_p} I \\right) \\left( \\frac{i}{h} \\begin{pmatrix} s_x \\\\ s_y \\end{pmatrix} \\right) = \\frac{s_x^2 + s_y^2}{-\\nu h^2 \\hat{L}_p}\n$$\nwhere $s_{\\alpha} = \\sin(\\alpha)$. Substituting the symbol for $\\hat{L}_p$:\n$$\n-\\hat{D}\\hat{A}^{-1}\\hat{G} = \\frac{s_x^2 + s_y^2}{-\\nu h^2 \\left( -\\frac{4}{h^2} (s_{x/2}^2+s_{y/2}^2) \\right)} = \\frac{s_x^2+s_y^2}{4\\nu(s_{x/2}^2+s_{y/2}^2)}\n$$\nwhere $s^2_{\\alpha/2} = \\sin^2(\\alpha/2)$. Using $s_x^2 = (2s_{x/2}c_{x/2})^2 = 4s_{x/2}^2c_{x/2}^2$, where $c_{\\alpha}=\\cos(\\alpha)$:\n$$\n-\\hat{D}\\hat{A}^{-1}\\hat{G} = \\frac{4s_{x/2}^2c_{x/2}^2 + 4s_{y/2}^2c_{y/2}^2}{4\\nu(s_{x/2}^2+s_{y/2}^2)} = \\frac{1}{\\nu} \\frac{s_{x/2}^2c_{x/2}^2 + s_{y/2}^2c_{y/2}^2}{s_{x/2}^2+s_{y/2}^2}\n$$\nThe second term is $-\\hat{C} = -\\tau \\hat{L}_p$:\n$$\n-\\hat{C}(\\theta_x, \\theta_y) = \\frac{4\\tau}{h^2} \\left( s_{x/2}^2 + s_{y/2}^2 \\right)\n$$\nSo, the full positive-definite Schur complement symbol is:\n$$\n\\hat{S}_{\\text{pd}}(\\theta_x, \\theta_y) = \\frac{1}{\\nu} \\frac{\\sin^2(\\frac{\\theta_x}{2})\\cos^2(\\frac{\\theta_x}{2}) + \\sin^2(\\frac{\\theta_y}{2})\\cos^2(\\frac{\\theta_y}{2})}{\\sin^2(\\frac{\\theta_x}{2}) + \\sin^2(\\frac{\\theta_y}{2})} + \\frac{4\\tau}{h^2}\\left(\\sin^2\\left(\\frac{\\theta_x}{2}\\right) + \\sin^2\\left(\\frac{\\theta_y}{2}\\right)\\right)\n$$\nThis expression is valid for all modes except $(\\theta_x, \\theta_y)=(0,0)$, where the denominator of the first term is zero. For this constant mode, the operators $\\hat{G}, \\hat{D}, \\hat{L}_p$ are all zero, making the pressure unconstrained. This represents the physical constant pressure null mode. By definition, we consider $\\hat{S}_{\\text{pd}}(0,0)=0$.\n\nNow we analyze the nullspace of $\\hat{S}_{\\text{pd}}$: A mode $(\\theta_x, \\theta_y)$ is a null mode if $\\hat{S}_{\\text{pd}}(\\theta_x, \\theta_y)=0$. Since both terms in $\\hat{S}_{\\text{pd}}$ are non-negative, the sum is zero if and only if both terms are zero.\n\nCase $\\tau > 0$ (with PSPG):\nThe second term, $\\frac{4\\tau}{h^2}(\\sin^2(\\frac{\\theta_x}{2}) + \\sin^2(\\frac{\\theta_y}{2}))$, is zero only if $\\sin(\\theta_x/2)=0$ and $\\sin(\\theta_y/2)=0$. Given $\\theta_x, \\theta_y \\in [0, 2\\pi)$, this occurs only at $(\\theta_x, \\theta_y)=(0,0)$. At this mode, the first term is also zero by definition. Thus, for $\\tau > 0$, the only null mode is the constant pressure mode $(0,0)$.\n\nCase $\\tau = 0$ (no PSPG):\nThe second term is identically zero. The null modes are determined by the first term alone. It is zero if the numerator $\\sin^2(\\frac{\\theta_x}{2})\\cos^2(\\frac{\\theta_x}{2}) + \\sin^2(\\frac{\\theta_y}{2})\\cos^2(\\frac{\\theta_y}{2})$ is zero. Since each part is non-negative, this requires both $\\sin(\\theta_x/2)\\cos(\\theta_x/2)=0$ and $\\sin(\\theta_y/2)\\cos(\\theta_y/2)=0$. This is equivalent to $\\sin(\\theta_x)=0$ and $\\sin(\\theta_y)=0$.\nFor $\\theta_x = 2\\pi m_x / N$ with $m_x \\in \\{0, \\dots, N-1\\}$, $\\sin(\\theta_x)=0$ at $m_x=0$ and $m_x=N/2$ (if $N$ is even). Similarly for $m_y$.\nSince all test cases use even $N$, the null modes are at $(m_x, m_y)$ values of $(0,0), (0,N/2), (N/2,0), (N/2,N/2)$. These correspond to Fourier angles $(\\theta_x, \\theta_y)$ of $(0,0), (0,\\pi), (\\pi,0), (\\pi,\\pi)$. These four modes comprise the constant mode and three high-frequency checkerboard modes, which are known artifacts of equal-order collocated discretizations.\n\nThe numerical implementation will now compute these quantities for the specified test cases.", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem for the given test suite.\n    Derives the pressure Schur complement symbol and computes null mode counts and condition numbers.\n    \"\"\"\n    test_cases = [\n        # (N, nu, tau)\n        (32, 1.0, 0.05),\n        (32, 1.0, 1e-6),\n        (16, 0.1, 0.02),\n        (16, 1.0, 0.0),\n    ]\n\n    all_results = []\n    \n    for N, nu, tau in test_cases:\n        # The function to compute metrics for a single case\n        results_tau_0 = compute_metrics_for_tau(N, nu, 0.0)\n        results_tau_given = compute_metrics_for_tau(N, nu, tau)\n        \n        n_0 = results_tau_0[0]\n        kappa_0 = results_tau_0[1]\n        \n        # If the case is specifically tau=0, the \"with PSPG\" results are the same\n        if tau == 0.0:\n            n_pspg = n_0\n            kappa_pspg = kappa_0\n        else:\n            n_pspg = results_tau_given[0]\n            kappa_pspg = results_tau_given[1]\n        \n        all_results.append([n_0, n_pspg, kappa_0, kappa_pspg])\n\n    # Format the final output string as specified\n    formatted_results = [f\"[{r[0]},{r[1]},{r[2]:.7g},{r[3]:.7g}]\" for r in all_results]\n    print(f\"[{','.join(formatted_results)}]\")\n\ndef compute_metrics_for_tau(N, nu, tau):\n    \"\"\"\n    Computes null mode count and condition number for a given set of parameters (N, nu, tau).\n    \n    Returns a list [null_mode_count, condition_number].\n    \"\"\"\n    h = 1.0 / N\n    # Create grid of integer mode indices\n    m = np.arange(N)\n    mx, my = np.meshgrid(m, m, indexing='ij')\n\n    # Calculate grid of Fourier angles\n    theta_x = 2 * np.pi * mx / N\n    theta_y = 2 * np.pi * my / N\n    \n    # Pre-calculate sine and cosine terms\n    sin_sq_half_x = np.sin(theta_x / 2)**2\n    sin_sq_half_y = np.sin(theta_y / 2)**2\n    cos_sq_half_x = np.cos(theta_x / 2)**2\n    cos_sq_half_y = np.cos(theta_y / 2)**2\n    \n    # Denominator for the first term\n    denom1 = sin_sq_half_x + sin_sq_half_y\n    \n    # Numerator for the first term\n    num1 = sin_sq_half_x * cos_sq_half_x + sin_sq_half_y * cos_sq_half_y\n    \n    # Initialize symbol array\n    symbol = np.zeros_like(denom1)\n    \n    # Mask for non-zero wavevectors to avoid division by zero\n    non_zero_mode = denom1 > 1e-15\n    \n    # First term of the Schur complement symbol\n    term1 = np.zeros_like(denom1)\n    term1[non_zero_mode] = (1 / nu) * num1[non_zero_mode] / denom1[non_zero_mode]\n    \n    # Second term (stabilization)\n    term2 = (4 * tau / h**2) * denom1\n    \n    # Full symbol\n    symbol = term1 + term2\n\n    # Numerical threshold for identifying null modes\n    threshold = 1e-12\n\n    # Count null modes\n    null_mode_count = np.sum(np.abs(symbol.flatten())  threshold)\n\n    # Compute condition number\n    positive_symbols = symbol[symbol > threshold]\n    if len(positive_symbols) > 0:\n        condition_number = np.max(positive_symbols) / np.min(positive_symbols)\n    else: \n        condition_number = 1.0 # Only null modes exist\n\n    return [int(null_mode_count), condition_number]\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "3401461"}]}