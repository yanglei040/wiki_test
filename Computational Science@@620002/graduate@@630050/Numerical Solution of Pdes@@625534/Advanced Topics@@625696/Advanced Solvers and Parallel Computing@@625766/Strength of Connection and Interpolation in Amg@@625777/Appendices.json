{"hands_on_practices": [{"introduction": "At the heart of Algebraic Multigrid (AMG) lies the concept of 'strength of connection,' which quantifies the coupling between variables in the linear system. This first exercise provides fundamental practice in applying the classical Ruge–Stüben criterion to a simple 1D Laplacian matrix. By working through this problem [@problem_id:3449289], you will build a concrete understanding of how to translate matrix entries into a graph of strong dependencies, the foundational data structure for AMG coarsening.", "problem": "Consider the matrix $A \\in \\mathbb{R}^{5 \\times 5}$ defined by $A=\\operatorname{tridiag}(-1,2,-1)$, which is a symmetric positive definite $M$-matrix arising from a standard second-order finite difference discretization of the one-dimensional Poisson operator on a uniform grid with homogeneous Dirichlet boundary conditions. Let the strength-of-connection threshold be $\\theta=0.25$. Use the classical Ruge–Stüben definition of strength of connection for $M$-matrices: for each row $i$, an off-diagonal index $j \\neq i$ is a strong neighbor of $i$ if $a_{ij}<0$ and\n$$\n- a_{ij} \\ge \\theta \\, \\max_{k \\neq i} \\bigl(-a_{ik}\\bigr).\n$$\nTasks:\n1. For each row $i \\in \\{1,2,3,4,5\\}$, determine the strong neighbor set $N^{s}_{i}(\\theta)$ and justify your result directly from the entries of $A$ and the above definition.\n2. Let $G$ be the undirected strength graph obtained by placing an undirected edge $\\{i,j\\}$ if and only if $i \\in N^{s}_{j}(\\theta)$ or $j \\in N^{s}_{i}(\\theta)$. Let $B$ denote the adjacency matrix of $G$. Compute the spectral radius $\\rho(B)$ and express your final answer as an exact value (no rounding).\nYour final answer must be a single real number equal to $\\rho(B)$, with no units.", "solution": "The problem asks us to perform a two-part analysis related to the concept of strength of connection in Algebraic Multigrid (AMG) methods. First, we must determine the strong neighbor sets for a given matrix. Second, we must construct a graph based on these connections and compute the spectral radius of its adjacency matrix.\n\nThe given matrix is $A \\in \\mathbb{R}^{5 \\times 5}$, specified as $A=\\operatorname{tridiag}(-1,2,-1)$. Writing this out explicitly, we have:\n$$\nA = \\begin{pmatrix}\n2 & -1 & 0 & 0 & 0 \\\\\n-1 & 2 & -1 & 0 & 0 \\\\\n0 & -1 & 2 & -1 & 0 \\\\\n0 & 0 & -1 & 2 & -1 \\\\\n0 & 0 & 0 & -1 & 2\n\\end{pmatrix}\n$$\nThe strength-of-connection threshold is given as $\\theta=0.25$.\nThe definition of a strong neighbor $j$ for a row $i$ (where $j \\neq i$) is twofold:\n1. The off-diagonal entry $a_{ij}$ must be negative, i.e., $a_{ij} < 0$.\n2. The magnitude of this entry must satisfy the inequality: $- a_{ij} \\ge \\theta \\, \\max_{k \\neq i} \\bigl(-a_{ik}\\bigr)$.\n\n**Part 1: Determination of Strong Neighbor Sets $N^{s}_{i}(\\theta)$**\n\nWe will analyze each row $i \\in \\{1, 2, 3, 4, 5\\}$ separately.\n\nFor row $i=1$:\nThe only negative off-diagonal entry is $a_{12}=-1$.\nWe compute the maximum magnitude of negative off-diagonal entries in this row:\n$\\max_{k \\neq 1} (-a_{1k}) = \\max(-a_{12}, -a_{13}, \\dots) = \\max(1, 0, \\dots) = 1$.\nThe threshold condition for a neighbor $j$ to be strong is $-a_{1j} \\ge \\theta \\times 1 = 0.25$.\nFor $j=2$, we have $-a_{12} = -(-1) = 1$. Since $1 \\ge 0.25$, the connection to node $2$ is strong.\nThus, the strong neighbor set for row $1$ is $N^{s}_{1}(\\theta) = \\{2\\}$.\n\nFor row $i=2$:\nThe negative off-diagonal entries are $a_{21}=-1$ and $a_{23}=-1$.\nThe maximum magnitude is $\\max_{k \\neq 2} (-a_{2k}) = \\max(-a_{21}, -a_{23}) = \\max(1, 1) = 1$.\nThe threshold condition is $-a_{2j} \\ge 0.25 \\times 1 = 0.25$.\nFor $j=1$: $-a_{21} = 1$, which is $\\ge 0.25$.\nFor $j=3$: $-a_{23} = 1$, which is $\\ge 0.25$.\nBoth connections are strong. Thus, $N^{s}_{2}(\\theta) = \\{1, 3\\}$.\n\nFor row $i=3$:\nThe negative off-diagonal entries are $a_{32}=-1$ and $a_{34}=-1$.\nThe maximum magnitude is $\\max_{k \\neq 3} (-a_{3k}) = \\max(-a_{32}, -a_{34}) = \\max(1, 1) = 1$.\nThe threshold condition is $-a_{3j} \\ge 0.25$.\nFor $j=2$: $-a_{32} = 1 \\ge 0.25$.\nFor $j=4$: $-a_{34} = 1 \\ge 0.25$.\nBoth connections are strong. Thus, $N^{s}_{3}(\\theta) = \\{2, 4\\}$.\n\nFor row $i=4$:\nThe negative off-diagonal entries are $a_{43}=-1$ and $a_{45}=-1$.\nThe maximum magnitude is $\\max_{k \\neq 4} (-a_{4k}) = \\max(-a_{43}, -a_{45}) = \\max(1, 1) = 1$.\nThe threshold condition is $-a_{4j} \\ge 0.25$.\nFor $j=3$: $-a_{43} = 1 \\ge 0.25$.\nFor $j=5$: $-a_{45} = 1 \\ge 0.25$.\nBoth connections are strong. Thus, $N^{s}_{4}(\\theta) = \\{3, 5\\}$.\n\nFor row $i=5$:\nThe only negative off-diagonal entry is $a_{54}=-1$.\nThe maximum magnitude is $\\max_{k \\neq 5} (-a_{5k}) = \\max(-a_{54}) = 1$.\nThe threshold condition is $-a_{5j} \\ge 0.25$.\nFor $j=4$: $-a_{54} = 1 \\ge 0.25$. The connection is strong.\nThus, $N^{s}_{5}(\\theta) = \\{4\\}$.\n\nIn summary, for $\\theta = 0.25$, all non-zero off-diagonal connections in matrix $A$ are classified as strong.\n\n**Part 2: Computation of the Spectral Radius $\\rho(B)$**\n\nThe undirected strength graph $G$ has an edge $\\{i,j\\}$ if and only if $i \\in N^{s}_{j}(\\theta)$ or $j \\in N^{s}_{i}(\\theta)$. Based on our findings in Part 1:\n- Edge $\\{1,2\\}$: $2 \\in N^{s}_{1}(\\theta)$ (and $1 \\in N^{s}_{2}(\\theta)$). So, an edge exists.\n- Edge $\\{2,3\\}$: $3 \\in N^{s}_{2}(\\theta)$ (and $2 \\in N^{s}_{3}(\\theta)$). So, an edge exists.\n- Edge $\\{3,4\\}$: $4 \\in N^{s}_{3}(\\theta)$ (and $3 \\in N^{s}_{4}(\\theta)$). So, an edge exists.\n- Edge $\\{4,5\\}$: $5 \\in N^{s}_{4}(\\theta)$ (and $4 \\in N^{s}_{5}(\\theta)$). So, an edge exists.\nNo other connections exist. For example, for $\\{1,3\\}$, $3 \\notin N^{s}_{1}(\\theta)$ and $1 \\notin N^{s}_{3}(\\theta)$.\nThe resulting graph $G$ is a path graph with $5$ vertices, which can be drawn as $1-2-3-4-5$.\n\nThe adjacency matrix $B$ of this graph $G$ is a $5 \\times 5$ matrix where $B_{ij} = 1$ if an edge exists between vertices $i$ and $j$, and $B_{ij} = 0$ otherwise.\n$$\nB = \\begin{pmatrix}\n0 & 1 & 0 & 0 & 0 \\\\\n1 & 0 & 1 & 0 & 0 \\\\\n0 & 1 & 0 & 1 & 0 \\\\\n0 & 0 & 1 & 0 & 1 \\\\\n0 & 0 & 0 & 1 & 0\n\\end{pmatrix}\n$$\nThis is a symmetric tridiagonal matrix. The eigenvalues $\\lambda_k$ of an $n \\times n$ tridiagonal matrix of the form $\\operatorname{tridiag}(c,a,b)$ are given by the formula $\\lambda_k = a + 2\\sqrt{bc}\\cos\\left(\\frac{k\\pi}{n+1}\\right)$ for $k=1, 2, \\dots, n$.\nFor our matrix $B$, we have $n=5$, $a=0$, and $b=c=1$. The eigenvalues are:\n$$\n\\lambda_k = 0 + 2\\sqrt{1 \\cdot 1} \\cos\\left(\\frac{k\\pi}{5+1}\\right) = 2 \\cos\\left(\\frac{k\\pi}{6}\\right), \\quad k=1,2,3,4,5.\n$$\nLet's compute these eigenvalues:\n- For $k=1$: $\\lambda_1 = 2 \\cos\\left(\\frac{\\pi}{6}\\right) = 2 \\left(\\frac{\\sqrt{3}}{2}\\right) = \\sqrt{3}$.\n- For $k=2$: $\\lambda_2 = 2 \\cos\\left(\\frac{2\\pi}{6}\\right) = 2 \\cos\\left(\\frac{\\pi}{3}\\right) = 2 \\left(\\frac{1}{2}\\right) = 1$.\n- For $k=3$: $\\lambda_3 = 2 \\cos\\left(\\frac{3\\pi}{6}\\right) = 2 \\cos\\left(\\frac{\\pi}{2}\\right) = 2(0) = 0$.\n- For $k=4$: $\\lambda_4 = 2 \\cos\\left(\\frac{4\\pi}{6}\\right) = 2 \\cos\\left(\\frac{2\\pi}{3}\\right) = 2 \\left(-\\frac{1}{2}\\right) = -1$.\n- For $k=5$: $\\lambda_5 = 2 \\cos\\left(\\frac{5\\pi}{6}\\right) = 2 \\left(-\\frac{\\sqrt{3}}{2}\\right) = -\\sqrt{3}$.\n\nThe set of eigenvalues of $B$ is $\\{\\sqrt{3}, 1, 0, -1, -\\sqrt{3}\\}$.\nThe spectral radius $\\rho(B)$ is the maximum absolute value of the eigenvalues:\n$$\n\\rho(B) = \\max_{k} |\\lambda_k| = \\max\\left\\{|\\sqrt{3}|, |1|, |0|, |-1|, |-\\sqrt{3}|\\right\\} = \\max\\{\\sqrt{3}, 1, 0\\} = \\sqrt{3}.\n$$\nThe spectral radius of the adjacency matrix $B$ is $\\sqrt{3}$.", "answer": "$$\\boxed{\\sqrt{3}}$$", "id": "3449289"}, {"introduction": "Once strong connections are identified, the next crucial step in AMG is to partition the grid nodes into a coarse set ($C$) and a fine set ($F$). This practice [@problem_id:3449313] demonstrates how the strength graph is used to guide this process via the Parallel Modified Independent Set (PMIS) algorithm, a standard coarsening heuristic. Following this procedure for a problem with variable coefficients will solidify your understanding of how coarsening algorithms ensure that every fine-point has strong support from the coarse grid.", "problem": "Consider the one-dimensional diffusion operator $-\\frac{d}{dx}\\left(k(x)\\frac{du}{dx}\\right)$ on the unit interval with homogeneous Dirichlet boundary conditions. Discretize this operator on a uniform grid with $8$ interior nodes using second-order centered finite differences. Let the discrete operator be represented by the symmetric tridiagonal matrix $A \\in \\mathbb{R}^{8 \\times 8}$ with entries defined by $a_{i,i} = b_{i-1} + b_{i}$, $a_{i,i-1} = -b_{i-1}$, and $a_{i,i+1} = -b_{i}$ for $i = 1, \\dots, 8$, with the conventions $b_{0} = 0$ and $b_{8} = 0$. Assume that the face conductivities $\\{b_{i}\\}_{i=1}^{7}$ are given by $b_{1} = 1$, $b_{2} = 0.2$, $b_{3} = 0.8$, $b_{4} = 0.8$, $b_{5} = 0.1$, $b_{6} = 1.2$, and $b_{7} = 0.3$.\n\nIn Algebraic Multigrid (AMG), define the strength of connection as follows: for each row index $i$, the set of strong dependences is $S_{i} := \\{j \\neq i : -a_{i,j} \\ge \\theta \\max_{k \\neq i}(-a_{i,k})\\}$ with threshold $\\theta = \\frac{1}{4}$. Interpret $S_{i}$ as the set of nodes $j$ that strongly influence node $i$.\n\nPerform Parallel Modified Independent Set (PMIS) coarsening on the directed strength graph with vertex set $\\{1,2,\\dots,8\\}$ and directed edges $i \\to j$ for $j \\in S_{i}$. Use the following PMIS selection rule: assign weights $w_{1} = 0.40$, $w_{2} = 0.95$, $w_{3} = 0.60$, $w_{4} = 0.55$, $w_{5} = 0.70$, $w_{6} = 0.20$, $w_{7} = 0.85$, and $w_{8} = 0.65$, select all nodes $i$ such that $w_{i} > w_{j}$ for every $j \\in S_{i}$, add them to the coarse set $C$, and then enforce independence by removing from consideration every node $\\ell$ for which a selected node $i$ satisfies $i \\in S_{\\ell}$. Iterate this selection and removal until all nodes have been classified. The fine set is $F := \\{1,2,\\dots,8\\} \\setminus C$. If any node in $F$ has no strong coarse neighbor, i.e., if $S_{i} \\cap C = \\varnothing$ for some $i \\in F$, then promote that node to $C$ so that every fine node has at least one strong coarse neighbor.\n\nLet $R$ be the verification quantity defined by $R := \\sum_{i \\in F} \\mathbf{1}_{|S_{i} \\cap C| \\ge 1}$, where $\\mathbf{1}_{\\cdot}$ denotes the indicator function. Compute $R$ for the described matrix $A$, strength threshold $\\theta$, and PMIS weights. Provide your final answer as a single real-valued number. No rounding is required.", "solution": "First, we construct the non-zero entries of the matrix $A$ using the given formulas and conductivity values $b_i$. The vector of conductivities is $b = [0, 1, 0.2, 0.8, 0.8, 0.1, 1.2, 0.3, 0]$ for indices $i=0, \\dots, 8$.\nFor $i=1$: $a_{1,1} = b_0+b_1 = 0+1=1$; $a_{1,2} = -b_1 = -1$.\nFor $i=2$: $a_{2,1} = -b_1 = -1$; $a_{2,2} = b_1+b_2 = 1+0.2=1.2$; $a_{2,3} = -b_2 = -0.2$.\nFor $i=3$: $a_{3,2} = -b_2 = -0.2$; $a_{3,3} = b_2+b_3 = 0.2+0.8=1$; $a_{3,4} = -b_3 = -0.8$.\nFor $i=4$: $a_{4,3} = -b_3 = -0.8$; $a_{4,4} = b_3+b_4 = 0.8+0.8=1.6$; $a_{4,5} = -b_4 = -0.8$.\nFor $i=5$: $a_{5,4} = -b_4 = -0.8$; $a_{5,5} = b_4+b_5 = 0.8+0.1=0.9$; $a_{5,6} = -b_5 = -0.1$.\nFor $i=6$: $a_{6,5} = -b_5 = -0.1$; $a_{6,6} = b_5+b_6 = 0.1+1.2=1.3$; $a_{6,7} = -b_6 = -1.2$.\nFor $i=7$: $a_{7,6} = -b_6 = -1.2$; $a_{7,7} = b_6+b_7 = 1.2+0.3=1.5$; $a_{7,8} = -b_7 = -0.3$.\nFor $i=8$: $a_{8,7} = -b_7 = -0.3$; $a_{8,8} = b_7+b_8 = 0.3+0=0.3$.\n\nNext, we determine the strength of connection sets $S_i$ with threshold $\\theta = 0.25$.\n-   For $i=1$: $\\max_{k \\neq 1}(-a_{1,k}) = 1$. The condition is $-a_{1,2}=1 \\ge 0.25$. True. $S_1 = \\{2\\}$.\n-   For $i=2$: $\\max(-a_{2,1}, -a_{2,3}) = \\max(1, 0.2) = 1$. Threshold: $0.25$. Connection to $j=1$ is strong ($1 \\ge 0.25$), connection to $j=3$ is weak ($0.2 < 0.25$). $S_2 = \\{1\\}$.\n-   For $i=3$: $\\max(-a_{3,2}, -a_{3,4}) = \\max(0.2, 0.8) = 0.8$. Threshold: $0.2$. Connections to $j=2$ and $j=4$ are both strong ($0.2 \\ge 0.2$, $0.8 \\ge 0.2$). $S_3 = \\{2, 4\\}$.\n-   For $i=4$: $\\max(-a_{4,3}, -a_{4,5}) = \\max(0.8, 0.8) = 0.8$. Threshold: $0.2$. Connections to $j=3$ and $j=5$ are both strong. $S_4 = \\{3, 5\\}$.\n-   For $i=5$: $\\max(-a_{5,4}, -a_{5,6}) = \\max(0.8, 0.1) = 0.8$. Threshold: $0.2$. Connection to $j=4$ is strong ($0.8 \\ge 0.2$), connection to $j=6$ is weak ($0.1 < 0.2$). $S_5 = \\{4\\}$.\n-   For $i=6$: $\\max(-a_{6,5}, -a_{6,7}) = \\max(0.1, 1.2) = 1.2$. Threshold: $0.3$. Connection to $j=5$ is weak ($0.1 < 0.3$), connection to $j=7$ is strong ($1.2 \\ge 0.3$). $S_6 = \\{7\\}$.\n-   For $i=7$: $\\max(-a_{7,6}, -a_{7,8}) = \\max(1.2, 0.3) = 1.2$. Threshold: $0.3$. Connections to $j=6$ and $j=8$ are both strong. $S_7 = \\{6, 8\\}$.\n-   For $i=8$: $\\max(-a_{8,7}) = 0.3$. Threshold: $0.075$. Connection to $j=7$ is strong ($0.3 \\ge 0.075$). $S_8 = \\{7\\}$.\nThe strength sets are: $S_1=\\{2\\}, S_2=\\{1\\}, S_3=\\{2,4\\}, S_4=\\{3,5\\}, S_5=\\{4\\}, S_6=\\{7\\}, S_7=\\{6,8\\}, S_8=\\{7\\}$.\n\nNow, we perform one pass of PMIS coarsening. Let $U = \\{1, \\dots, 8\\}$ be the set of undecided nodes.\nWe find the set of initial coarse candidates $I = \\{i \\in U : w_i > w_j, \\forall j \\in S_i\\}$.\n-   $i=1 (S_1=\\{2\\})$: $w_1=0.40, w_2=0.95$. $w_1 \\ngtr w_2$.\n-   $i=2 (S_2=\\{1\\})$: $w_2=0.95, w_1=0.40$. $w_2 > w_1$. Select $2$.\n-   $i=3 (S_3=\\{2,4\\})$: $w_3=0.60, w_2=0.95$. $w_3 \\ngtr w_2$.\n-   $i=4 (S_4=\\{3,5\\})$: $w_4=0.55, w_3=0.60$. $w_4 \\ngtr w_3$.\n-   $i=5 (S_5=\\{4\\})$: $w_5=0.70, w_4=0.55$. $w_5 > w_4$. Select $5$.\n-   $i=6 (S_6=\\{7\\})$: $w_6=0.20, w_7=0.85$. $w_6 \\ngtr w_7$.\n-   $i=7 (S_7=\\{6,8\\})$: $w_7=0.85, w_6=0.20, w_8=0.65$. $w_7>w_6$ and $w_7>w_8$. Select $7$.\n-   $i=8 (S_8=\\{7\\})$: $w_8=0.65, w_7=0.85$. $w_8 \\ngtr w_7$.\nThe set of selected coarse nodes is $I=\\{2, 5, 7\\}$. These are added to the coarse set: $C = \\{2, 5, 7\\}$.\nNodes $\\ell$ for which a selected node $i \\in I$ satisfies $i \\in S_\\ell$ are put into the fine set $F$.\n-   For selected node $i=2$: $2 \\in S_1$ and $2 \\in S_3$. So nodes $1,3$ become fine points.\n-   For selected node $i=5$: $5 \\in S_4$. So node $4$ becomes a fine point.\n-   For selected node $i=7$: $7 \\in S_6$ and $7 \\in S_8$. So nodes $6,8$ become fine points.\nThe fine set is $F=\\{1, 3, 4, 6, 8\\}$. All nodes are now classified, so the initial partitioning is $C = \\{2, 5, 7\\}$ and $F = \\{1, 3, 4, 6, 8\\}$.\n\nWe then apply the promotion rule by checking if any node $i \\in F$ has no strong coarse neighbor, i.e., $S_i \\cap C = \\varnothing$.\n-   For $i=1 \\in F$, $S_1=\\{2\\}$. $S_1 \\cap C = \\{2\\} \\cap \\{2,5,7\\} = \\{2\\} \\neq \\varnothing$.\n-   For $i=3 \\in F$, $S_3=\\{2,4\\}$. $S_3 \\cap C = \\{2,4\\} \\cap \\{2,5,7\\} = \\{2\\} \\neq \\varnothing$.\n-   For $i=4 \\in F$, $S_4=\\{3,5\\}$. $S_4 \\cap C = \\{3,5\\} \\cap \\{2,5,7\\} = \\{5\\} \\neq \\varnothing$.\n-   For $i=6 \\in F$, $S_6=\\{7\\}$. $S_6 \\cap C = \\{7\\} \\cap \\{2,5,7\\} = \\{7\\} \\neq \\varnothing$.\n-   For $i=8 \\in F$, $S_8=\\{7\\}$. $S_8 \\cap C = \\{7\\} \\cap \\{2,5,7\\} = \\{7\\} \\neq \\varnothing$.\nEvery node in $F$ has at least one strong coarse neighbor, so no nodes are promoted. The final sets are $C_{final} = C$ and $F_{final} = F$.\n\nFinally, we compute the quantity $R := \\sum_{i \\in F_{final}} \\mathbf{1}_{|S_{i} \\cap C_{final}| \\ge 1}$. This sum counts the number of nodes in the final fine set that have at least one strong neighbor in the final coarse set. As established above, every node $i \\in F_{final}$ satisfies this condition. Therefore, the indicator function is $1$ for every $i \\in F_{final}$. The value of $R$ is the total count of such nodes, which is simply the size of the final fine set.\n$$R = |F_{final}| = |\\{1, 3, 4, 6, 8\\}| = 5$$", "answer": "$$\\boxed{5}$$", "id": "3449313"}, {"introduction": "While classical strength measures are effective, they can fail to capture important indirect couplings that are not represented by direct non-zero entries in the matrix. This advanced exercise [@problem_id:3449351] introduces a more sophisticated 'algebraic distance' metric, which uses information from smooth test vectors to identify these hidden connections. You will see how this refined assessment of strength leads directly to the construction of a more accurate interpolation operator, bridging the gap between connection analysis and operator construction.", "problem": "Consider the scalar diffusion model problem $-\\nabla \\cdot (\\kappa \\nabla u) = f$ on a one-dimensional domain with homogeneous Dirichlet boundary conditions, discretized by the standard second-order centered finite differences on three interior grid points. The resulting linear system is $A u = b$ with a symmetric positive definite (SPD) matrix $A \\in \\mathbb{R}^{3 \\times 3}$ of the $M$-matrix form (positive diagonal, nonpositive off-diagonals):\n$$\nA \\;=\\;\n\\begin{pmatrix}\n2 & -1 & 0 \\\\\n-1 & 2 & -1 \\\\\n0 & -1 & 2\n\\end{pmatrix}.\n$$\nYou will analyze strength of connection and determine an interpolation choice in the context of Algebraic Multigrid (AMG), explicitly capturing indirect coupling across a zero off-diagonal.\n\n1. Using the classical strength-of-connection definition attributed to the Ruge–Stüben method, a node $j \\neq i$ is a strong neighbor of $i$ if $-a_{ij} \\ge \\theta \\max_{k \\neq i}(-a_{ik})$. Compute the classical strength sets $S_{i}^{\\mathrm{RS}}$ for $i \\in \\{1,2,3\\}$ with $\\theta = 0.25$.\n\n2. Define an algebraic-distance strength of connection on the graph of $A$ using two test vectors that represent low-energy error components for diffusion:\n$v^{(1)} = (1,\\,1,\\,1)^{\\top}$, $v^{(2)} = (0,\\,1,\\,2)^{\\top}$.\nFor each existing edge $(i,j)$ with $a_{ij} \\neq 0$, define the local misfit\n$$\nm_{ij} \\;=\\; \\left( \\sum_{t=1}^{2} \\big(v_{i}^{(t)} - v_{j}^{(t)}\\big)^{2} \\right)^{1/2}.\n$$\nFor the nonedge pair $(1,3)$ with $a_{13} = 0$, define the indirect algebraic distance $d_{13}$ as the shortest-path sum of edge misfits over the graph of $A$, i.e.,\n$$\nd_{13} \\;=\\; \\min_{\\text{paths } 1 \\to 3} \\sum_{\\text{edges }(p,q)\\text{ on path}} m_{pq}.\n$$\nUse the threshold $\\tau = 2$ and declare $(i,j)$ algebraically strong if $d_{ij} \\le \\tau$. Compute $m_{12}$, $m_{23}$, $d_{13}$, and state whether $(1,3)$ is algebraically strong under this criterion.\n\n3. Suppose the coarse set is $C = \\{1,\\,3\\}$ and the fine set is $F = \\{2\\}$. Choose interpolation for the fine node $2$ based on the algebraic-distance assessment above: use local least-squares interpolation constrained to reproduce the constant near-nullspace component. Specifically, determine weights $w_{21}$ and $w_{23}$ by minimizing\n$$\nJ(w_{21}, w_{23}) \\;=\\; \\sum_{t=1}^{2} \\left( v_{2}^{(t)} - w_{21} \\, v_{1}^{(t)} - w_{23} \\, v_{3}^{(t)} \\right)^{2}\n$$\nsubject to the reproduction constraint $w_{21} + w_{23} = 1$. Compute the exact value of the interpolation weight $w_{21}$ for the fine node $2$ with respect to coarse node $1$. Provide your final answer as an exact value without rounding and without units.", "solution": "**Part 1: Classical Strength of Connection**\n\nWe compute the strength sets $S_{i}^{\\mathrm{RS}}$ for $i \\in \\{1, 2, 3\\}$ using the definition $-a_{ij} \\ge \\theta \\max_{k \\neq i}(-a_{ik})$ with $\\theta = 0.25$.\nThe matrix is $A = \\begin{pmatrix} 2 & -1 & 0 \\\\ -1 & 2 & -1 \\\\ 0 & -1 & 2 \\end{pmatrix}$.\n\n_For node $i=1$_:\nThe off-diagonal entries are $a_{12} = -1$ and $a_{13} = 0$. The maximum magnitude of negative off-diagonals is $\\max_{k \\neq 1}(-a_{1k}) = 1$. The threshold is $0.25 \\cdot 1 = 0.25$.\n- For $j=2$: $-a_{12} = 1 \\ge 0.25$. The connection is strong.\n- For $j=3$: $-a_{13} = 0 < 0.25$. The connection is weak.\nThe strength set is $S_{1}^{\\mathrm{RS}} = \\{2\\}$.\n\n_For node $i=2$_:\nThe off-diagonal entries are $a_{21} = -1$ and $a_{23} = -1$. The maximum magnitude is $\\max(1,1)=1$. The threshold is $0.25$.\n- For $j=1$: $-a_{21} = 1 \\ge 0.25$. The connection is strong.\n- For $j=3$: $-a_{23} = 1 \\ge 0.25$. The connection is strong.\nThe strength set is $S_{2}^{\\mathrm{RS}} = \\{1, 3\\}$.\n\n_For node $i=3$_:\nBy symmetry with node $1$, the strength set is $S_{3}^{\\mathrm{RS}} = \\{2\\}$.\n\n**Part 2: Algebraic-Distance Strength of Connection**\n\nWe compute the local misfits $m_{ij}$ for edges $(1,2)$ and $(2,3)$ using the test vectors $v^{(1)} = (1, 1, 1)^{\\top}$ and $v^{(2)} = (0, 1, 2)^{\\top}$.\n\n_Compute $m_{12}$_:\n$$\nm_{12} = \\left( (v_{1}^{(1)} - v_{2}^{(1)})^{2} + (v_{1}^{(2)} - v_{2}^{(2)})^{2} \\right)^{1/2} = \\left( (1-1)^{2} + (0-1)^{2} \\right)^{1/2} = \\sqrt{0^2 + (-1)^2} = 1.\n$$\n\n_Compute $m_{23}$_:\n$$\nm_{23} = \\left( (v_{2}^{(1)} - v_{3}^{(1)})^{2} + (v_{2}^{(2)} - v_{3}^{(2)})^{2} \\right)^{1/2} = \\left( (1-1)^{2} + (1-2)^{2} \\right)^{1/2} = \\sqrt{0^2 + (-1)^2} = 1.\n$$\n\n_Compute $d_{13}$_:\nThe indirect distance $d_{13}$ is the shortest-path sum of misfits. The only path from $1$ to $3$ is $1 \\to 2 \\to 3$.\n$$\nd_{13} = m_{12} + m_{23} = 1 + 1 = 2.\n$$\n\n_Strength Assessment for $(1,3)$_:\nThe condition for an algebraically strong connection is $d_{ij} \\le \\tau$, with $\\tau=2$.\nSince $d_{13} = 2$, we have $d_{13} \\le 2$. Therefore, the pair $(1,3)$ is considered algebraically strong.\n\n**Part 3: Interpolation Weight Calculation**\n\nWe find weights $w_{21}$ and $w_{23}$ that minimize $J(w_{21}, w_{23}) = \\sum_{t=1}^{2} \\left( v_{2}^{(t)} - w_{21} \\, v_{1}^{(t)} - w_{23} \\, v_{3}^{(t)} \\right)^{2}$ subject to $w_{21} + w_{23} = 1$.\nSubstitute $w_{23} = 1 - w_{21}$ into the objective function:\n$$\nJ(w_{21}) = \\sum_{t=1}^{2} \\left( v_{2}^{(t)} - w_{21} \\, v_{1}^{(t)} - (1 - w_{21}) \\, v_{3}^{(t)} \\right)^{2} = \\sum_{t=1}^{2} \\left( (v_{2}^{(t)} - v_{3}^{(t)}) - w_{21}(v_{1}^{(t)} - v_{3}^{(t)}) \\right)^{2}.\n$$\n_For $t=1$_ ($v^{(1)}=(1,1,1)^{\\top}$): The term is $( (1 - 1) - w_{21}(1 - 1) )^2 = 0$.\n_For $t=2$_ ($v^{(2)}=(0,1,2)^{\\top}$): The term is $( (1 - 2) - w_{21}(0 - 2) )^2 = (-1 - w_{21}(-2))^2 = (-1 + 2w_{21})^2$.\n\nThe objective function simplifies to $J(w_{21}) = (-1 + 2w_{21})^2$.\nTo minimize this quadratic function, we set the term inside the square to zero:\n$$\n-1 + 2w_{21} = 0 \\implies 2w_{21} = 1 \\implies w_{21} = \\frac{1}{2}.\n$$\nThe interpolation weight for the fine node $2$ with respect to the coarse node $1$ is $\\frac{1}{2}$.", "answer": "$$\n\\boxed{\\frac{1}{2}}\n$$", "id": "3449351"}]}