{"hands_on_practices": [{"introduction": "This practice is the first step in understanding the Full Approximation Scheme (FAS). By working with a known \"manufactured\" solution to a nonlinear partial differential equation, you will explicitly calculate the core component of FAS—the tau-correction, $\\tau_{H}$, This term communicates information about the fine-grid truncation error to the coarse grid, and this exercise provides a concrete numerical feel for how FAS accounts for the difference between the fine and coarse grid discretizations [@problem_id:3396512].", "problem": "Consider the nonlinear partial differential equation $-\\Delta u + u^{3} = f$ on the square domain $(0,1)^{2}$ with homogeneous Dirichlet boundary conditions $u=0$ on $\\partial(0,1)^{2}$. Assume $f$ is chosen so that the exact solution is $u(x,y) = \\sin(\\pi x)\\sin(\\pi y)$. Starting from the continuous equation and standard definitions of the Laplacian and Dirichlet boundary conditions, derive a closed-form expression for $f(x,y)$ that makes $u(x,y) = \\sin(\\pi x)\\sin(\\pi y)$ an exact solution.\n\nNext, consider a finite difference discretization on a uniform fine grid of spacing $h=\\frac{1}{4}$ with the standard five-point stencil approximation for the Laplacian and zero boundary values imposed at grid points on the boundary. Define the discrete nonlinear operator on the fine grid by $F_{h}(u_{h}) = -\\Delta_{h} u_{h} + (u_{h})^{\\odot 3} - f_{h}$, where $\\Delta_{h}$ is the five-point discrete Laplacian and $f_{h}$ is the pointwise sampling of the continuous $f$ at grid nodes. Similarly, define the coarse grid of spacing $H=\\frac{1}{2}$ with the same discrete operator form $F_{H}(u_{H}) = -\\Delta_{H} u_{H} + (u_{H})^{\\odot 3} - f_{H}$.\n\nUsing the Full Approximation Scheme (FAS), where the coarse-grid right-hand side is corrected by the $\\tau$-term, set up the coarse-grid equation $F_{H}(u_{H}) = \\hat{f}_{H}$ with $\\hat{f}_{H} = I_{h}^{H} f_{h} + \\tau_{H}$ and the standard choice of restriction $I_{h}^{H}$ as point injection (i.e., the coarse node value equals the fine node value at the coincident location). Compute explicitly the $\\tau$-correction $\\tau_{H}$ at the single interior coarse-grid node $(x,y)=(\\frac{1}{2},\\frac{1}{2})$, assuming the fine-grid approximation equals the exact solution sampled at fine grid nodes.\n\nProvide your final answer as a two-entry row matrix using the $\\mathrm{pmatrix}$ environment: the first entry must be the closed-form expression for $f(x,y)$ obtained from the continuous equation, and the second entry must be the exact value of $\\tau_{H}$ at $(\\frac{1}{2},\\frac{1}{2})$ under the described discretization and transfer choices. No rounding is required; report exact values and do not include units inside the final boxed answer.", "solution": "The user wants me to solve a two-part problem related to the Full Approximation Scheme (FAS) for a nonlinear PDE.\n\n**Part 1: Derive the forcing function `f(x,y)`**\n- PDE: $-\\Delta u + u^{3} = f$\n- Domain: $(0,1)^{2}$\n- Boundary Conditions: $u=0$ on $\\partial(0,1)^{2}$\n- Exact Solution: $u(x,y) = \\sin(\\pi x)\\sin(\\pi y)$\n\nI need to substitute the given $u(x,y)$ into the PDE to find the corresponding $f(x,y)$.\n\n**Part 2: Compute the `τ`-correction in FAS**\n- Discretization: Finite difference on a uniform grid.\n- Fine grid spacing: $h = 1/4$.\n- Coarse grid spacing: $H = 1/2$.\n- Laplacian approximation: Standard five-point stencil.\n- Discrete operators:\n    - Fine grid: $F_{h}(u_{h}) = -\\Delta_{h} u_{h} + (u_{h})^{\\odot 3} - f_{h}$\n    - Coarse grid: $F_{H}(u_{H}) = -\\Delta_{H} u_{H} + (u_{H})^{\\odot 3} - f_{H}$\n- FAS coarse-grid equation: $F_{H}(u_{H}) = \\hat{f}_{H}$\n- Corrected right-hand side: $\\hat{f}_{H} = I_{h}^{H} f_{h} + \\tau_{H}$\n- Restriction operator $I_{h}^{H}$: Point injection.\n- $\\tau$-correction definition: $\\tau_{H} = F_{H}(I_{h}^{H} u_{h}) - I_{h}^{H}(F_{h}(u_{h}))$.\n- Assumption: The fine-grid approximation $u_h$ is the exact solution sampled on the fine grid.\n- Target: Compute $\\tau_{H}$ at the single interior coarse-grid node $(x,y) = (1/2, 1/2)$.\n\n**Plan:**\n\n**1. Validate the Problem**\n- **Extract Givens**: List all equations, parameters, and definitions.\n    - PDE: $-\\Delta u + u^{3} = f$ on $(0,1)^{2}$.\n    - BC: $u=0$ on $\\partial(0,1)^{2}$.\n    - Exact solution: $u(x,y) = \\sin(\\pi x)\\sin(\\pi y)$.\n    - Fine grid spacing: $h=\\frac{1}{4}$.\n    - Coarse grid spacing: $H=\\frac{1}{2}$.\n    - Discrete operators: $F_{h}(u_{h}) = -\\Delta_{h} u_{h} + (u_{h})^{\\odot 3} - f_{h}$ and $F_{H}(u_{H}) = -\\Delta_{H} u_{H} + (u_{H})^{\\odot 3} - f_{H}$.\n    - FAS coarse RHS: $\\hat{f}_{H} = I_{h}^{H} f_{h} + \\tau_{H}$.\n    - Tau-correction: $\\tau_{H} = F_{H}(I_{h}^{H} u_{h}) - I_{h}^{H}(F_{h}(u_{h}))$.\n    - Restriction $I_h^H$: Point injection.\n    - Assumption: $u_h$ is the exact solution sampled at fine grid nodes.\n    - Target: $f(x,y)$ and $\\tau_H$ at $(1/2, 1/2)$.\n\n- **Validate**:\n    - **Scientifically Grounded**: Yes, this is a standard problem in numerical analysis for PDEs. The FAS is a well-established multigrid method for nonlinear problems.\n    - **Well-Posed**: Yes, the problem asks for specific calculations based on clear definitions. The existence of the solution $u(x,y)$ is assumed to construct $f$, which is a valid approach (method of manufactured solutions).\n    - **Objective**: Yes, language is precise and technical.\n    - **Completeness**: All necessary information is provided. The definitions of the discrete operators, grid spacings, and transfer operators are standard or explicitly given.\n    - **Consistency**: No contradictions found.\n    - **No other flaws**: The problem is not trivial, not metaphorical, not unfalsifiable.\n\n- **Verdict**: The problem is valid.\n\n**2. Solve Part 1: Find `f(x,y)`**\n- Start with $u(x,y) = \\sin(\\pi x)\\sin(\\pi y)$.\n- Calculate the Laplacian $\\Delta u$.\n    - $\\frac{\\partial u}{\\partial x} = \\pi \\cos(\\pi x)\\sin(\\pi y)$\n    - $\\frac{\\partial^2 u}{\\partial x^2} = -\\pi^2 \\sin(\\pi x)\\sin(\\pi y)$\n    - $\\frac{\\partial u}{\\partial y} = \\pi \\sin(\\pi x)\\cos(\\pi y)$\n    - $\\frac{\\partial^2 u}{\\partial y^2} = -\\pi^2 \\sin(\\pi x)\\sin(\\pi y)$\n    - $\\Delta u = \\frac{\\partial^2 u}{\\partial x^2} + \\frac{\\partial^2 u}{\\partial y^2} = -2\\pi^2 \\sin(\\pi x)\\sin(\\pi y) = -2\\pi^2 u(x,y)$.\n- Substitute into the PDE:\n    - $f = -\\Delta u + u^3$\n    - $f(x,y) = -(-2\\pi^2 \\sin(\\pi x)\\sin(\\pi y)) + (\\sin(\\pi x)\\sin(\\pi y))^3$\n    - $f(x,y) = 2\\pi^2 \\sin(\\pi x)\\sin(\\pi y) + \\sin^3(\\pi x)\\sin^3(\\pi y)$.\n- This is the first part of the final answer.\n\n**3. Solve Part 2: Compute `τ_H` at `(1/2, 1/2)`**\n- The tau-correction is defined as $\\tau_{H} = F_{H}(I_{h}^{H} u_{h}) - I_{h}^{H}(F_{h}(u_{h}))$.\n- The problem states we should evaluate this at the single coarse-grid interior point $(X,Y) = (1/2, 1/2)$.\n- The assumption is that $u_h$ is the exact solution sampled on the fine grid. So, $u_h(x_i, y_j) = u(x_i, y_j) = \\sin(\\pi x_i)\\sin(\\pi y_j)$.\n- The continuous problem is $-\\Delta u + u^3 = f$.\n- The discrete problem residual on the fine grid is $F_h(u_h) - f_h = -\\Delta_h u_h + u_h^{\\odot 3} - f_h$.\n    - So, $F_h(u_h) = -\\Delta_h u_h + u_h^{\\odot 3}$.\n- The discrete problem residual on the coarse grid is $F_H(u_H) - f_H = -\\Delta_H u_H + u_H^{\\odot 3} - f_H$.\n    - So, $F_H(u_H) = -\\Delta_H u_H + u_H^{\\odot 3}$.\n- The definition of the $\\tau$-correction can be rewritten using the operators $L(u) = -\\Delta u + u^3$.\n    - $L_h(u_h) = -\\Delta_h u_h + u_h^{\\odot 3}$.\n    - $L_H(u_H) = -\\Delta_H u_H + u_H^{\\odot 3}$.\n    - The problem defines the full operator including the source term: $F_h(u_h) = L_h(u_h) - f_h$. Okay, need to be careful with definitions.\n    - The question asks for $\\tau_H = F_{H}(I_{h}^{H} u_{h}) - I_{h}^{H}(F_{h}(u_{h}))$.\n    - Let's substitute the definitions:\n    $\\tau_H = [-\\Delta_H (I_h^H u_h) + (I_h^H u_h)^{\\odot 3} - f_H] - I_h^H [-\\Delta_h u_h + u_h^{\\odot 3} - f_h]$.\n    - Restriction $I_h^H$ is point injection, so $I_h^H f_h = f_H$. The term $f_H - I_h^H f_h$ cancels out.\n    - So, $\\tau_H = [-\\Delta_H (I_h^H u_h) + (I_h^H u_h)^{\\odot 3}] - I_h^H [-\\Delta_h u_h + u_h^{\\odot 3}]$.\n    - This simplifies to $\\tau_H = L_H(I_h^H u_h) - I_h^H(L_h(u_h))$. This is the standard definition of the relative truncation error.\n\n- Let's compute the terms at the coarse point $(X,Y) = (1/2, 1/2)$.\n- **Term 1: $L_H(I_h^H u_h)$ at $(1/2, 1/2)$**\n    - $I_h^H u_h$ at $(1/2, 1/2)$ is just $u_h$ at $(1/2, 1/2)$ because of injection.\n    - $u_h$ is the exact solution sampled, so we need $u(1/2, 1/2) = \\sin(\\pi/2)\\sin(\\pi/2) = 1 \\times 1 = 1$. Let's call this value $u_C$ (value at center).\n    - So, $I_h^H u_h$ at the central coarse node is $u_C = 1$.\n    - $L_H$ is evaluated on the coarse grid. At $(1/2, 1/2)$, we have:\n        $L_H(I_h^H u_h) |_{(1/2,1/2)} = -\\Delta_H (I_h^H u_h)|_{(1/2,1/2)} + ((I_h^H u_h)|_{(1/2,1/2)})^3$.\n    - The coarse grid has nodes at $(0, 1/2, 1)$. The only interior node is $(1/2, 1/2)$. The neighbors are on the boundary.\n    - Coarse grid points: $(iH, jH)$ for $i,j \\in \\{0, 1, 2\\}$. $H=1/2$.\n    - The neighbors of $(1/2, 1/2)$ are $(0, 1/2)$, $(1, 1/2)$, $(1/2, 0)$, $(1/2, 1)$.\n    - At these boundary points, $u=0$.\n    - The five-point Laplacian with spacing $H$ is:\n        $\\Delta_H v(x,y) = \\frac{v(x+H,y)+v(x-H,y)+v(x,y+H)+v(x,y-H)-4v(x,y)}{H^2}$.\n    - We need to apply this to $v = I_h^H u_h$.\n    - At $(X,Y)=(1/2, 1/2)$:\n        - $v(1/2, 1/2) = u_h(1/2, 1/2) = u(1/2, 1/2) = 1$.\n        - $v(1/2+H, 1/2) = v(1, 1/2) = u_h(1, 1/2) = 0$ (boundary).\n        - $v(1/2-H, 1/2) = v(0, 1/2) = u_h(0, 1/2) = 0$ (boundary).\n        - $v(1/2, 1/2+H) = v(1/2, 1) = u_h(1/2, 1) = 0$ (boundary).\n        - $v(1/2, 1/2-H) = v(1/2, 0) = u_h(1/2, 0) = 0$ (boundary).\n    - So, $-\\Delta_H(I_h^H u_h)|_{(1/2,1/2)} = -\\frac{0+0+0+0-4(1)}{(1/2)^2} = -\\frac{-4}{1/4} = 16$.\n    - And the nonlinear term is $((I_h^H u_h)|_{(1/2,1/2)})^3 = (1)^3 = 1$.\n    - Thus, $L_H(I_h^H u_h)|_{(1/2,1/2)} = 16 + 1 = 17$.\n\n- **Term 2: $I_h^H(L_h(u_h))$ at $(1/2, 1/2)$**\n    - Due to injection, this is just $L_h(u_h)$ evaluated at the fine-grid point $(1/2, 1/2)$.\n    - $L_h(u_h)|_{(1/2,1/2)} = -\\Delta_h u_h|_{(1/2,1/2)} + (u_h|_{(1/2,1/2)})^3$.\n    - Fine grid spacing $h=1/4$. Fine grid points are $(ih, jh)$ for $i,j \\in \\{0,1,2,3,4\\}$.\n    - The point $(1/2, 1/2)$ is a fine grid point, corresponding to $(i,j)=(2,2)$.\n    - We need to evaluate the five-point Laplacian for $u_h$ at $(x,y)=(1/2, 1/2)$ with spacing $h=1/4$.\n    - $-\\Delta_h u_h|_{(1/2,1/2)} = -\\frac{u_h(1/2+h, 1/2) + u_h(1/2-h, 1/2) + u_h(1/2, 1/2+h) + u_h(1/2, 1/2-h) - 4u_h(1/2, 1/2)}{h^2}$.\n    - Let's calculate the values of $u_h$ needed. $u_h(x,y)=u(x,y)=\\sin(\\pi x)\\sin(\\pi y)$.\n        - Center point: $(1/2, 1/2)$. $u(1/2, 1/2) = \\sin(\\pi/2)\\sin(\\pi/2) = 1$.\n        - Neighbor points: $(x,y)$ values are $(1/2 \\pm 1/4, 1/2)$ and $(1/2, 1/2 \\pm 1/4)$.\n        - This means we need $u$ at $(3/4, 1/2)$, $(1/4, 1/2)$, $(1/2, 3/4)$, and $(1/2, 1/4)$.\n        - Due to symmetry, $u(x,y)=u(y,x)$, so $u(3/4, 1/2) = u(1/2, 3/4)$ and $u(1/4, 1/2) = u(1/2, 1/4)$.\n        - $u(1/4, 1/2) = \\sin(\\pi/4)\\sin(\\pi/2) = (\\frac{\\sqrt{2}}{2})(1) = \\frac{\\sqrt{2}}{2}$.\n        - $u(3/4, 1/2) = \\sin(3\\pi/4)\\sin(\\pi/2) = (\\frac{\\sqrt{2}}{2})(1) = \\frac{\\sqrt{2}}{2}$.\n    - All four neighbor values are the same: $\\frac{\\sqrt{2}}{2}$.\n    - Now plug into the discrete Laplacian formula:\n        $-\\Delta_h u_h|_{(1/2,1/2)} = -\\frac{(\\frac{\\sqrt{2}}{2}) + (\\frac{\\sqrt{2}}{2}) + (\\frac{\\sqrt{2}}{2}) + (\\frac{\\sqrt{2}}{2}) - 4(1)}{(1/4)^2}$\n        $= -\\frac{4(\\frac{\\sqrt{2}}{2}) - 4}{1/16} = -\\frac{2\\sqrt{2} - 4}{1/16} = -16(2\\sqrt{2} - 4) = 16(4 - 2\\sqrt{2})$.\n        $= 64 - 32\\sqrt{2}$.\n    - The nonlinear term is $(u_h|_{(1/2,1/2)})^3 = (1)^3 = 1$.\n    - So, $L_h(u_h)|_{(1/2,1/2)} = (64 - 32\\sqrt{2}) + 1 = 65 - 32\\sqrt{2}$.\n\n- **Final Calculation of `τ_H`**\n    - $\\tau_H |_{(1/2,1/2)} = L_H(I_h^H u_h)|_{(1/2,1/2)} - I_h^H(L_h(u_h))|_{(1/2,1/2)}$\n    - $\\tau_H |_{(1/2,1/2)} = 17 - (65 - 32\\sqrt{2})$\n    - $\\tau_H |_{(1/2,1/2)} = 17 - 65 + 32\\sqrt{2} = -48 + 32\\sqrt{2}$.\n\n- **Review the steps.**\n    - Part 1: $f(x,y) = 2\\pi^2 \\sin(\\pi x)\\sin(\\pi y) + \\sin^3(\\pi x)\\sin^3(\\pi y)$. Correct.\n    - Part 2: $\\tau_H = L_H(\\hat{u}_H) - I_h^H(L_h(u_h))$, where $\\hat{u}_H = I_h^H u_h$. The evaluation point is $(1/2, 1/2)$.\n    - $L_H(\\hat{u}_H)|_{(1/2,1/2)}$:\n        - $H=1/2$.\n        - $\\hat{u}_H$ values are from $u(x,y)$ at coarse grid points.\n        - $\\hat{u}_H(1/2,1/2) = u(1/2,1/2) = 1$.\n        - $\\hat{u}_H$ at neighbors $(0,1/2), (1,1/2), (1/2,0), (1/2,1)$ are all $0$ due to boundary conditions.\n        - $-\\Delta_H \\hat{u}_H = -\\frac{0+0+0+0 - 4(1)}{(1/2)^2} = 16$.\n        - $(\\hat{u}_H)^3 = 1^3=1$.\n        - $L_H(\\hat{u}_H)|_{(1/2,1/2)} = 16+1=17$. Correct.\n    - $I_h^H(L_h(u_h))|_{(1/2,1/2)} = L_h(u_h)|_{(1/2,1/2)}$:\n        - $h=1/4$.\n        - $u_h$ values are from $u(x,y)$ at fine grid points.\n        - $u_h(1/2,1/2) = 1$.\n        - $u_h$ at neighbors $(1/2 \\pm 1/4, 1/2 \\pm 1/4)$... wait, neighbors are $(1/2 \\pm 1/4, 1/2)$ and $(1/2, 1/2 \\pm 1/4)$.\n        - $u_h(1/4, 1/2) = \\sin(\\pi/4)\\sin(\\pi/2) = \\sqrt{2}/2$.\n        - $u_h(3/4, 1/2) = \\sin(3\\pi/4)\\sin(\\pi/2) = \\sqrt{2}/2$.\n        - $u_h(1/2, 1/4) = \\sin(\\pi/2)\\sin(\\pi/4) = \\sqrt{2}/2$.\n        - $u_h(1/2, 3/4) = \\sin(\\pi/2)\\sin(3\\pi/4) = \\sqrt{2}/2$.\n        - All four neighbor values are $\\sqrt{2}/2$. Correct.\n        - $-\\Delta_h u_h = -\\frac{4(\\sqrt{2}/2) - 4(1)}{(1/4)^2} = -\\frac{2\\sqrt{2}-4}{1/16} = 16(4-2\\sqrt{2}) = 64 - 32\\sqrt{2}$. Correct.\n        - $(u_h)^3 = 1^3=1$. Correct.\n        - $L_h(u_h)|_{(1/2,1/2)} = (64 - 32\\sqrt{2}) + 1 = 65 - 32\\sqrt{2}$. Correct.\n    - $\\tau_H = 17 - (65 - 32\\sqrt{2}) = -48 + 32\\sqrt{2}$. Correct.\n\nThe problem also mentions $F_H(u_H) = \\hat{f}_H$ where $\\hat{f}_H = I_h^H f_h + \\tau_H$.\nAnd $F_H(u_H) = L_H(u_H) - f_H$.\nSo $L_H(u_H) - f_H = I_h^H f_h + \\tau_H$.\nWith point injection, $f_H = I_h^H f_h$.\nSo $L_H(u_H) = f_H + \\tau_H$. This is the FAS equation. My calculation of $\\tau_H$ seems to be independent of $f_h$ and $f_H$, which is correct as they cancel out.\n\nLet's re-read the $\\tau$ definition from the problem.\n$\\hat{f}_{H} = I_{h}^{H} f_{h} + \\tau_{H}$\nand the coarse grid equation is $F_H(u_H) = \\hat{f}_H$.\nThe problem also states \"where the coarse-grid right-hand side is corrected by the $\\tau$-term\".\nThis seems to match my interpretation.\nThe standard definition of the $\\tau$ correction is $\\tau_h^H = F_H(I_h^H u_h) - I_h^H F_h(u_h)$.\nWait, the problem text says $\\tau_H = F_H(u_H) - I_h^H F_h(u_h)$ where $u_H = I_h^H u_h$. This is the standard definition. Let me double check the problem statement.\nAh, the problem has:\n$F_{H}(u_{H}) = \\hat{f}_{H}$ with $\\hat{f}_{H} = I_{h}^{H} f_{h} + \\tau_{H}$.\nThis seems okay. It's just a definition of how the coarse problem is constructed.\nThe problem then asks to compute $\\tau_H$. It doesn't give a formula for $\\tau_H$, so I must use the standard one.\nThe standard FAS coarse grid equation is $F_H(u_H) = F_H(I_h^H u_h) - I_h^H F_h(u_h) + I_h^H f_h$.\nThe right hand side is $\\hat{f}_H$.\nSo $\\hat{f}_H = F_H(I_h^H u_h) - I_h^H F_h(u_h) + I_h^H f_h$.\nThe problem defines $\\hat{f}_H = I_h^H f_h + \\tau_H$.\nComparing these two gives $\\tau_H = F_H(I_h^H u_h) - I_h^H F_h(u_h)$.\nThis confirms my starting point for computing $\\tau_H$.\n\nLet's break down the operators again.\n$F_h(u_h) = -\\Delta_h u_h + (u_h)^{\\odot 3} - f_h$.\n$F_H(u_H) = -\\Delta_H u_H + (u_H)^{\\odot 3} - f_H$.\n$\\tau_H = F_H(I_h^H u_h) - I_h^H(F_h(u_h))$.\nLet's substitute the full definition.\n$\\tau_H = [-\\Delta_H(I_h^H u_h) + (I_h^H u_h)^{\\odot 3} - f_H] - I_h^H[-\\Delta_h u_h + (u_h)^{\\odot 3} - f_h]$.\n$\\tau_H = -\\Delta_H(I_h^H u_h) + (I_h^H u_h)^{\\odot 3} - f_H - I_h^H(-\\Delta_h u_h) - I_h^H((u_h)^{\\odot 3}) + I_h^H(f_h)$.\nSince restriction is point injection, $f_H(x,y) = f_h(x,y)$ for $(x,y)$ on the coarse grid. So $f_H = I_h^H f_h$.\nThe $f$ terms cancel: $- f_H + I_h^H(f_h) = -I_h^H f_h + I_h^H f_h = 0$.\nAlso, for a grid function $v$, $(I_h^H v)^{\\odot 3} = I_h^H (v^{\\odot 3})$ because the power operation is pointwise.\nSo the expression for $\\tau_H$ becomes:\n$\\tau_H = -\\Delta_H(I_h^H u_h) - I_h^H(-\\Delta_h u_h) = I_h^H(\\Delta_h u_h) - \\Delta_H(I_h^H u_h)$.\nThis is the \"tau\" from the truncation error $\\tau = \\Delta_h u - \\Delta u$. Here it's the *relative* truncation error between coarse and fine discretizations.\nLet $L(u) = -\\Delta u + u^3$.\nThe continuous problem is $L(u) = f$.\nThe fine-grid approximation is $L_h(u_h) = f_h$. The error is $L_h(u_h) - f_h = 0$ if $u_h$ is the exact discrete solution.\nHowever, we use $u_h = R_h u$, the restriction of the exact continuous solution to the grid.\nSo the fine-grid residual is $r_h = f_h - L_h(u_h) = R_h f - L_h(R_h u)$.\nThis is related to the truncation error $T_h = L_h(R_h u) - R_h(L(u))$.\nSince $L(u) = f$, we have $T_h = L_h(R_h u) - R_h f$.\nSo $r_h = -T_h$.\nThe FAS coarse problem is $L_H(u_H) = f_H + \\tau_h^H$ where $\\tau_h^H = L_H(I_h^H u_h) - I_h^H(L_h(u_h))$.\nMy previous derivation was correct.\n$\\tau_H = [-\\Delta_H(I_h^H u_h) + (I_h^H u_h)^{\\odot 3}] - I_h^H([-\\Delta_h u_h + (u_h)^{\\odot 3}])$.\nThere is no ambiguity on how to interpret $I_h^H((u_h)^{\\odot 3})$. Since cubing is a pointwise operation, applying injection to the cubed result is the same as injecting first and then cubing the result.\nLet $\\hat{u}_H = I_h^H u_h$. Then $(I_h^H u_h)^{\\odot 3} = (\\hat{u}_H)^{\\odot 3}$. And $I_h^H((u_h)^{\\odot 3}) = (\\hat{u}_H)^{\\odot 3}$.\nSo the nonlinear terms do cancel out.\n$\\tau_H = I_h^H(\\Delta_h u_h) - \\Delta_H(I_h^H u_h)$.\n\nWhere does this come from?\nThe FAS equation for the error $e_H = u_H - I_h^H u_h$ is approximately $L_H'(I_h^H u_h) e_H \\approx -r_H$, where $r_H = L_H(I_h^H u_h) - (f_H + \\tau_h^H)$.\nThe coarse grid problem is $L_H(u_H) = f_H + \\tau_h^H$.\nLet's substitute $\\tau_h^H = L_H(I_h^H u_h) - I_h^H(L_h(u_h))$.\n$L_H(u_H) = f_H + L_H(I_h^H u_h) - I_h^H(L_h(u_h))$.\nOn the fine grid, we have a residual $r_h = f_h - L_h(u_h)$. So $L_h(u_h) = f_h - r_h$.\n$L_H(u_H) = f_H + L_H(I_h^H u_h) - I_h^H(f_h - r_h)$.\n$L_H(u_H) = f_H + L_H(I_h^H u_h) - I_h^H(f_h) + I_h^H(r_h)$.\nAssuming $f_H=I_h^H f_h$, we get $L_H(u_H) - L_H(I_h^H u_h) = I_h^H r_h$.\nThis is the core idea of FAS. The coarse grid operator acting on the change from the restricted solution equals the restricted residual. This makes sense.\n\nSo the definition $\\tau_h^H = L_H(I_h^H u_h) - I_h^H(L_h(u_h))$ is correct for the coarse grid source correction term.\nLet me reconsider the cancellation of the nonlinear terms.\nMaybe I am misinterpreting something subtle about the operators.\nLet's call the coarse grid point $p_H = (1/2, 1/2)$. This is also a fine grid point.\nLet's evaluate each piece of $\\tau_H$ at $p_H$.\n$L_H(I_h^H u_h)|_{p_H} = -\\Delta_H(I_h^H u_h)|_{p_H} + ((I_h^H u_h)|_{p_H})^3$.\n$I_h^H(L_h(u_h))|_{p_H} = (L_h(u_h))|_{p_H} = -(\\Delta_h u_h)|_{p_H} + ((u_h)|_{p_H})^3$.\n\nSo, $\\tau_H|_{p_H} = [-\\Delta_H(I_h^H u_h)|_{p_H} + ((I_h^H u_h)|_{p_H})^3] - [ -(\\Delta_h u_h)|_{p_H} + ((u_h)|_{p_H})^3 ]$.\nLet's look at the cubic terms.\n$(I_h^H u_h)|_{p_H} = u_h(p_H)$.\nSo, $((I_h^H u_h)|_{p_H})^3 = (u_h(p_H))^3$.\nThe other cubic term is $((u_h)|_{p_H})^3 = (u_h(p_H))^3$.\nThese are identical. They will subtract and yield zero.\n\nSo, $\\tau_H|_{p_H} = -\\Delta_H(I_h^H u_h)|_{p_H} - ( -(\\Delta_h u_h)|_{p_H} ) = (\\Delta_h u_h)|_{p_H} - \\Delta_H(I_h^H u_h)|_{p_H}$.\n\nMy calculation seems to follow from the definitions.\n$\\Delta_H(I_h^H u_h)|_{p_H} = -16$.\n$\\Delta_h u_h |_{p_H} = 32\\sqrt{2} - 64$.\n$\\tau_H|_{p_H} = (32\\sqrt{2} - 64) - (-16) = 32\\sqrt{2} - 48$.\n\nWhy did my first calculation give a different result?\nLet's check the very first calculation.\n**Term 1:** $L_H(I_h^H u_h)|_{(1/2,1/2)}$\n$-\\Delta_H(I_h^H u_h)|_{(1/2,1/2)} = 16$.\n$((I_h^H u_h)|_{(1/2,1/2)})^3 = u_h(1/2,1/2)^3 = 1^3 = 1$.\nSum = $16+1 = 17$. Correct.\n\n**Term 2:** $I_h^H(L_h(u_h))|_{(1/2,1/2)} = L_h(u_h)|_{(1/2,1/2)}$\n$-\\Delta_h u_h|_{(1/2,1/2)} = 64-32\\sqrt{2}$.\n$(u_h|_{(1/2,1/2)})^3 = 1^3=1$.\nSum = $(64-32\\sqrt{2}) + 1 = 65 - 32\\sqrt{2}$. Correct.\n\n**Final `τ_H`**\n$\\tau_H = (\\text{Term 1}) - (\\text{Term 2}) = 17 - (65 - 32\\sqrt{2}) = 17-65+32\\sqrt{2} = -48 + 32\\sqrt{2}$.\n\nSo my first calculation was:\nTerm 1 = $17$.\nTerm 2 = $65-32\\sqrt{2}$.\nDifference = $17 - 65 + 32\\sqrt{2} = -48 + 32\\sqrt{2}$.\n\nMy second line of reasoning was about the cancellation of nonlinear terms.\nThe cancellation leads to $\\tau_H = \\Delta_h u_h - \\Delta_H(I_h^H u_h)$ at the point.\nLet's use the values for $\\Delta_h$ and $\\Delta_H$ that I computed.\n$\\Delta_h u_h|_{p_H} = 32\\sqrt{2} - 64$.\n$\\Delta_H(I_h^H u_h)|_{p_H} = -16$.\nSo $\\tau_H = (32\\sqrt{2} - 64) - (-16) = 32\\sqrt{2} - 48$.\n\nNow I have two different answers: $-48 + 32\\sqrt{2}$ and $32\\sqrt{2} - 48$. They are the same.\nSo why did I think my previous calculation was wrong?\nI must have made a sign error when checking.\nLet's re-verify:\nFirst path: $\\tau_H = (16+1) - ( (64 - 32\\sqrt{2}) + 1) = 17 - (65-32\\sqrt{2}) = -48+32\\sqrt{2}$. OK.\nSecond path: $\\tau_H = I_h^H(-\\Delta_h u_h) - (-\\Delta_H(I_h^H u_h))$. Wait, the definition is $\\tau_H = L_H(...) - I_h^H L_h(...)$.\n$\\tau_H = (-\\Delta_H...) - I_h^H(-\\Delta_h...)$.\nLet's check signs.\n$L_H(v) = -\\Delta_H v + ...$\n$L_h(v) = -\\Delta_h v + ...$\n$\\tau_H = L_H(I_h^H u_h) - I_h^H(L_h(u_h))$\n$\\tau_H = (-\\Delta_H(...) + ...) - I_h^H(-\\Delta_h(...) + ...)$\n$\\tau_H = (-\\Delta_H(...)) - I_h^H(-\\Delta_h(...)) = I_h^H(\\Delta_h u_h) - \\Delta_H(I_h^H u_h)$.\nThis seems correct.\nLet's use the values again.\n$I_h^H(\\Delta_h u_h)|_{p_H} = (32\\sqrt{2} - 64)$.\n$\\Delta_H(I_h^H u_h)|_{p_H} = -16$.\nSo $\\tau_H = (32\\sqrt{2} - 64) - (-16) = 32\\sqrt{2} - 48$.\n\nWhere did I get $-48 + 32\\sqrt{2}$ from?\nOh, $-48+32\\sqrt{2}$ is the same as $32\\sqrt{2}-48$.\nI was confused for no reason. Both calculations give the same result. The logic is sound.\nThe cancellation of the nonlinear term is a valid shortcut because the restriction operator is injection and the nonlinearity is local (pointwise).\n\nFinal check of all numbers.\nPart 1: $f(x,y)=2\\pi^2 \\sin(\\pi x)\\sin(\\pi y) + \\sin^3(\\pi x)\\sin^3(\\pi y)$\nCheck calculation of Laplacian of $u = \\sin(\\pi x)\\sin(\\pi y)$:\n$u_{xx} = -\\pi^2 \\sin(\\pi x)\\sin(\\pi y)$\n$u_{yy} = -\\pi^2 \\sin(\\pi x)\\sin(\\pi y)$\n$\\Delta u = u_{xx} + u_{yy} = -2\\pi^2 \\sin(\\pi x)\\sin(\\pi y) = -2\\pi^2 u$.\nPDE: $-\\Delta u + u^3 = f$\n$ -(-2\\pi^2 u) + u^3 = f$\n$f = 2\\pi^2 u + u^3$.\nSubstitute $u$: $f(x,y) = 2\\pi^2 \\sin(\\pi x)\\sin(\\pi y) + (\\sin(\\pi x)\\sin(\\pi y))^3$.\nThe problem says $\\sin^3(\\pi x)\\sin^3(\\pi y)$. This is just expanded notation. Looks correct.\n\nPart 2: $\\tau_H$ at $(1/2, 1/2)$ is $32\\sqrt{2}-48$.\nLet's re-calculate from scratch one more time to be absolutely certain.\nPoint $p = (1/2, 1/2)$.\n$\\tau_H(p) = L_H(I_h^H u_h)(p) - I_h^H(L_h(u_h))(p)$.\n$u_h$ is sample of $u(x,y)=\\sin(\\pi x)\\sin(\\pi y)$.\n$L_H(v) = -\\Delta_H v + v^3$.\n$L_h(v) = -\\Delta_h v + v^3$.\n$I_h^H$ is point injection.\n$h=1/4, H=1/2$.\n\nCalculation of $L_H(I_h^H u_h)(p)$:\nThe function being operated on is $v_H = I_h^H u_h$.\nAt coarse node $p=(1/2,1/2)$, $v_H(p) = u_h(1/2,1/2) = u(1/2,1/2) = \\sin(\\pi/2)\\sin(\\pi/2)=1$.\nNeighbors of $p$ on coarse grid are $(0, 1/2), (1, 1/2), (1/2, 0), (1/2, 1)$. At these points, $u=0$.\nSo $v_H$ is $0$ at these neighbors.\n$-\\Delta_H v_H (p) = -\\frac{v_H(p+(H,0)) + v_H(p-(H,0)) + ... - 4v_H(p)}{H^2}$\n$= -\\frac{0+0+0+0 - 4(1)}{(1/2)^2} = -\\frac{-4}{1/4} = 16$.\n$v_H(p)^3 = 1^3 = 1$.\n$L_H(I_h^H u_h)(p) = 16 + 1 = 17$. This calculation is solid.\n\nCalculation of $I_h^H(L_h(u_h))(p)$:\nThis is just $L_h(u_h)(p)$.\n$L_h(u_h)(p) = -\\Delta_h u_h(p) + u_h(p)^3$.\n$u_h(p)^3 = u_h(1/2, 1/2)^3 = 1^3 = 1$.\n$-\\Delta_h u_h(p) = -\\frac{u_h(p+(h,0)) + u_h(p-(h,0)) + ... - 4u_h(p)}{h^2}$.\n$h=1/4$.\n$p+(h,0)=(3/4, 1/2)$. $p-(h,0)=(1/4, 1/2)$.\n$p+(0,h)=(1/2, 3/4)$. $p-(0,h)=(1/2, 1/4)$.\nValue at neighbors: $u(1/4, 1/2) = \\sin(\\pi/4)\\sin(\\pi/2) = \\sqrt{2}/2$.\n$u(3/4, 1/2) = \\sin(3\\pi/4)\\sin(\\pi/2) = \\sqrt{2}/2$.\nSame for y-neighbors due to symmetry. All 4 neighbor values are $\\sqrt{2}/2$.\nValue at center $p$: $u(1/2,1/2)=1$.\n$-\\Delta_h u_h(p) = -\\frac{4(\\sqrt{2}/2) - 4(1)}{(1/4)^2} = -\\frac{2\\sqrt{2}-4}{1/16} = -16(2\\sqrt{2}-4) = 64-32\\sqrt{2}$.\nThis calculation is solid.\n$L_h(u_h)(p) = (64-32\\sqrt{2}) + 1 = 65-32\\sqrt{2}$. This is solid.\n\nFinal computation:\n$\\tau_H(p) = (17) - (65-32\\sqrt{2}) = 17 - 65 + 32\\sqrt{2} = -48 + 32\\sqrt{2}$.\nThe calculation is definitely correct.\n\nThe final answer should be a two-entry row matrix.\nFirst entry: $2\\pi^2 \\sin(\\pi x)\\sin(\\pi y) + \\sin^3(\\pi x)\\sin^3(\\pi y)$\nSecond entry: $-48 + 32\\sqrt{2}$ or $32\\sqrt{2} - 48$.\n\nThe representation in the box will be\n`\\begin{pmatrix} 2\\pi^2 \\sin(\\pi x)\\sin(\\pi y) + \\sin^3(\\pi x)\\sin^3(\\pi y) & 32\\sqrt{2} - 48 \\end{pmatrix}`\nThe problem asks for symbolic reasoning and exact value, no rounding. This fits.\n\nFinal check of problem wording:\n\"Provide your final answer as a two-entry row matrix using the $\\mathrm{pmatrix}$ environment: the first entry must be the closed-form expression for $f(x,y)$ obtained from the continuous equation, and the second entry must be the exact value of $\\tau_{H}$ at $(\\frac{1}{2},\\frac{1}{2})$ under the described discretization and transfer choices.\"\nThis is clear. My plan covers exactly this.\nThe solution write-up should be clear, step-by-step, with all formulas in LaTeX.\nThe validation section must list the givens verbatim and then state the verdict.\nThe solution part should logically derive the two results.\nThe final answer box should contain only the matrix.\nEverything seems in order. I will proceed with generating the solution.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n2\\pi^{2} \\sin(\\pi x)\\sin(\\pi y) + \\sin^{3}(\\pi x)\\sin^{3}(\\pi y) & 32\\sqrt{2} - 48\n\\end{pmatrix}\n}\n$$", "id": "3396512"}, {"introduction": "Building on the previous exercise, this practice moves from a specific numerical calculation to a general symbolic derivation. You will derive the explicit form of the FAS coarse-grid defect, $\\tau_{H,I}$, for a 1D problem using a more sophisticated full-weighting restriction operator. This task is essential for understanding the algebraic structure of the FAS correction and appreciating how different choices of inter-grid transfer operators influence the scheme [@problem_id:3396579].", "problem": "Consider the one-dimensional nonlinear boundary value problem on a uniform grid,\n$$-u''(x) + u(x)^{3} = f(x),$$\nwith periodic boundary conditions on a domain of length $L$. Let the fine grid have spacing $h$ and grid points $x_{i} = i\\,h$, and let the coarse grid have spacing $H = 2h$ and grid points $X_{I} = I\\,H$. Discretize the differential operator using the standard second-order centered finite differences on each grid. Denote the discrete nonlinear operator on the fine grid by\n$$N_{h}(u)_{i} = -\\frac{u_{i-1} - 2 u_{i} + u_{i+1}}{h^{2}} + u_{i}^{3},$$\nand on the coarse grid by\n$$N_{H}(v)_{I} = -\\frac{v_{I-1} - 2 v_{I} + v_{I+1}}{H^{2}} + v_{I}^{3}.$$\nUse the full approximation scheme (FAS) coarse-grid defect definition\n$$\\tau_{H} = N_{H}\\!\\left(I_{h}^{H} u^{h}\\right) - I_{h}^{H}\\!\\left(N_{h}(u^{h})\\right),$$\nwhere the full-weighting restriction operator $I_{h}^{H}$ from the fine grid to the coarse grid is defined componentwise by\n$$(I_{h}^{H} w)_{I} = \\frac{1}{4}\\left(w_{2I-1} + 2 w_{2I} + w_{2I+1}\\right).$$\nAssume that the coarse-grid index $I$ is such that all required fine-grid indices $2I+k$ with $k \\in \\{-3,-2,-1,0,1,2,3\\}$ lie within the periodic domain.\n\nDerive an explicit closed-form expression for the FAS coarse-grid defect component $\\tau_{H,I}$ in terms of the fine-grid nodal values $u_{2I+k}$ and the mesh size $h$, using $H = 2h$. Express your final result as a single simplified analytic expression depending only on $u_{2I-3}, u_{2I-2}, u_{2I-1}, u_{2I}, u_{2I+1}, u_{2I+2}, u_{2I+3}$ and $h$. Do not include any equality sign in your final answer. No numerical evaluation is required, and no units are to be reported.", "solution": "The problem has been validated and is deemed a well-posed, scientifically grounded problem in numerical analysis. The derivation of the Full Approximation Scheme (FAS) coarse-grid defect will now proceed.\n\nThe coarse-grid defect, or tau correction, at a coarse-grid point $X_I$ is defined as\n$$\n\\tau_{H,I} = \\left(N_{H}(I_{h}^{H} u^{h})\\right)_{I} - \\left(I_{h}^{H}(N_{h}(u^{h}))\\right)_{I}\n$$\nwhere $u^h$ represents the fine-grid function with nodal values $u_i$. The operators $N_h$ and $N_H$ are composed of a linear part (the negative discrete Laplacian) and a nonlinear part (the cubic term). Let's define the discrete Laplacian operators as\n$$\nA_h(u)_i = -\\frac{u_{i-1} - 2u_i + u_{i+1}}{h^2} \\quad \\text{and} \\quad A_H(v)_I = -\\frac{v_{I-1} - 2v_I + v_{I+1}}{H^2}\n$$\nThus, the nonlinear operators are $N_h(u)_i = A_h(u)_i + u_i^3$ and $N_H(v)_I = A_H(v)_I + v_I^3$.\n\nThe defect $\\tau_{H,I}$ can be split into a linear part and a nonlinear part:\n$$\n\\tau_{H,I} = \\left[ A_H(I_h^H u^h)_I - I_h^H(A_h(u^h))_I \\right] + \\left[ (I_h^H u^h)_I^3 - I_h^H((u^h)^3)_I \\right]\n$$\nWe will compute each part separately. For brevity, we will write $u$ for $u^h$.\n\nFirst, we compute the first term of $\\tau_{H,I}$, which is $\\left(N_{H}(I_{h}^{H} u)\\right)_{I}$. Let $v = I_h^H u$. The components of $v$ are given by the full-weighting restriction operator:\n$$\nv_J = (I_h^H u)_J = \\frac{1}{4}(u_{2J-1} + 2u_{2J} + u_{2J+1})\n$$\nThe first term is $N_H(v)_I = A_H(v)_I + v_I^3$. Let's compute $A_H(v)_I$:\n$$\nA_H(v)_I = -\\frac{v_{I-1} - 2v_I + v_{I+1}}{H^2}\n$$\nUsing $H=2h$ and substituting the expressions for $v_{I-1}$, $v_I$, and $v_{I+1}$:\n\\begin{align*} v_{I-1} &= \\frac{1}{4}(u_{2I-3} + 2u_{2I-2} + u_{2I-1}) \\\\ v_I &= \\frac{1}{4}(u_{2I-1} + 2u_{2I} + u_{2I+1}) \\\\ v_{I+1} &= \\frac{1}{4}(u_{2I+1} + 2u_{2I+2} + u_{2I+3})\\end{align*}\nThe numerator of $A_H(v)_I$ becomes:\n\\begin{align*}\n-(v_{I-1} - 2v_I + v_{I+1}) &= -\\frac{1}{4} \\left[ (u_{2I-3} + 2u_{2I-2} + u_{2I-1}) - 2(u_{2I-1} + 2u_{2I} + u_{2I+1}) + (u_{2I+1} + 2u_{2I+2} + u_{2I+3}) \\right] \\\\\n&= -\\frac{1}{4} [u_{2I-3} + 2u_{2I-2} - u_{2I-1} - 4u_{2I} - u_{2I+1} + 2u_{2I+2} + u_{2I+3}]\n\\end{align*}\nThus, the linear part is:\n$$\nA_H(I_h^H u)_I = -\\frac{1}{16h^2}[u_{2I-3} + 2u_{2I-2} - u_{2I-1} - 4u_{2I} - u_{2I+1} + 2u_{2I+2} + u_{2I+3}]\n$$\nThe nonlinear part is:\n$$\n(I_h^H u)_I^3 = v_I^3 = \\left(\\frac{1}{4}(u_{2I-1} + 2u_{2I} + u_{2I+1})\\right)^3 = \\frac{1}{64}(u_{2I-1} + 2u_{2I} + u_{2I+1})^3\n$$\n\nNext, we compute the second term of $\\tau_{H,I}$, which is $\\left(I_{h}^{H}(N_{h}(u))\\right)_{I}$.\nThis is the restriction of the fine-grid operator residual. Let $w_i = N_h(u)_i$. We need to compute $(I_h^H w)_I = \\frac{1}{4}(w_{2I-1} + 2w_{2I} + w_{2I+1})$.\nFirst, we compute the restriction of the linear part, $I_h^H(A_h(u))_I$:\n$$\nI_h^H(A_h(u))_I = \\frac{1}{4}[A_h(u)_{2I-1} + 2A_h(u)_{2I} + A_h(u)_{2I+1}]\n$$\nSubstituting the definition of $A_h$:\n\\begin{align*}\nI_h^H(A_h(u))_I &= \\frac{1}{4} \\left[ -\\frac{u_{2I-2}-2u_{2I-1}+u_{2I}}{h^2} - 2\\frac{u_{2I-1}-2u_{2I}+u_{2I+1}}{h^2} - \\frac{u_{2I}-2u_{2I+1}+u_{2I+2}}{h^2} \\right] \\\\\n&= -\\frac{1}{4h^2} [ (u_{2I-2}-2u_{2I-1}+u_{2I}) + 2(u_{2I-1}-2u_{2I}+u_{2I+1}) + (u_{2I}-2u_{2I+1}+u_{2I+2}) ] \\\\\n&= -\\frac{1}{4h^2} [ u_{2I-2} - 2u_{2I} + u_{2I+2} ]\n\\end{align*}\nThen, we compute the restriction of the nonlinear part:\n$$\nI_h^H(u^3)_I = \\frac{1}{4}((u^3)_{2I-1} + 2(u^3)_{2I} + (u^3)_{2I+1}) = \\frac{1}{4}(u_{2I-1}^3 + 2u_{2I}^3 + u_{2I+1}^3)\n$$\n\nNow we combine these results to form $\\tau_{H,I}$. The linear part of the defect is:\n\\begin{align*}\n\\tau_{H,I}^L &= A_H(I_h^H u)_I - I_h^H(A_h(u))_I \\\\\n&= -\\frac{1}{16h^2}[u_{2I-3} + 2u_{2I-2} - u_{2I-1} - 4u_{2I} - u_{2I+1} + 2u_{2I+2} + u_{2I+3}] - \\left(-\\frac{1}{4h^2} [u_{2I-2} - 2u_{2I} + u_{2I+2}]\\right) \\\\\n&= \\frac{1}{16h^2} \\left[ -(u_{2I-3} + 2u_{2I-2} - u_{2I-1} - 4u_{2I} - u_{2I+1} + 2u_{2I+2} + u_{2I+3}) + 4(u_{2I-2} - 2u_{2I} + u_{2I+2}) \\right] \\\\\n&= \\frac{1}{16h^2} [-u_{2I-3} - 2u_{2I-2} + u_{2I-1} + 4u_{2I} + u_{2I+1} - 2u_{2I+2} - u_{2I+3} + 4u_{2I-2} - 8u_{2I} + 4u_{2I+2}] \\\\\n&= \\frac{1}{16h^2} [-u_{2I-3} + 2u_{2I-2} + u_{2I-1} - 4u_{2I} + u_{2I+1} + 2u_{2I+2} - u_{2I+3}]\n\\end{align*}\nThe nonlinear part of the defect is:\n\\begin{align*}\n\\tau_{H,I}^{NL} &= (I_h^H u)_I^3 - I_h^H(u^3)_I \\\\\n&= \\frac{1}{64}(u_{2I-1} + 2u_{2I} + u_{2I+1})^3 - \\frac{1}{4}(u_{2I-1}^3 + 2u_{2I}^3 + u_{2I+1}^3) \\\\\n&= \\frac{1}{64} \\left[ (u_{2I-1} + 2u_{2I} + u_{2I+1})^3 - 16(u_{2I-1}^3 + 2u_{2I}^3 + u_{2I+1}^3) \\right]\n\\end{align*}\nThe total coarse-grid defect is the sum $\\tau_{H,I} = \\tau_{H,I}^L + \\tau_{H,I}^{NL}$. To present this as a single expression, we use a common denominator of $64h^2$:\n\\begin{align*}\n\\tau_{H,I} &= \\frac{4}{64h^2} [-u_{2I-3} + 2u_{2I-2} + u_{2I-1} - 4u_{2I} + u_{2I+1} + 2u_{2I+2} - u_{2I+3}] \\\\\n&+ \\frac{h^2}{64h^2} \\left[ (u_{2I-1} + 2u_{2I} + u_{2I+1})^3 - 16(u_{2I-1}^3 + 2u_{2I}^3 + u_{2I+1}^3) \\right]\n\\end{align*}\nCombining these terms yields the final expression for the FAS coarse-grid defect component $\\tau_{H,I}$.\n$$\n\\tau_{H,I} = \\frac{4(-u_{2I-3} + 2u_{2I-2} + u_{2I-1} - 4u_{2I} + u_{2I+1} + 2u_{2I+2} - u_{2I+3}) + h^{2}((u_{2I-1} + 2u_{2I} + u_{2I+1})^{3} - 16(u_{2I-1}^{3} + 2u_{2I}^{3} + u_{2I+1}^{3}))}{64h^{2}}\n$$\nThis expression depends only on the fine-grid nodal values $u_{2I+k}$ for $k \\in \\{-3, \\dots, 3\\}$ and the fine-grid mesh size $h$.", "answer": "$$\\boxed{\\frac{4(-u_{2I-3} + 2u_{2I-2} + u_{2I-1} - 4u_{2I} + u_{2I+1} + 2u_{2I+2} - u_{2I+3}) + h^{2}((u_{2I-1} + 2u_{2I} + u_{2I+1})^{3} - 16(u_{2I-1}^{3} + 2u_{2I}^{3} + u_{2I+1}^{3}))}{64h^{2}}}$$", "id": "3396579"}, {"introduction": "After mastering the mechanics of the FAS correction, it is crucial to understand how to apply the algorithm effectively in practice. This practice explores the vital question of when to stop the iterative process, a decision that requires balancing computational cost against solution accuracy. By analyzing different stopping criteria, you will connect the observable nonlinear residual, $\\|F_h(u_h^{(k)})\\|$, to the unobservable algebraic error and the inherent discretization error, a key concept in advanced scientific computing [@problem_id:3396549].", "problem": "Consider a nonlinear discrete boundary value problem arising from the numerical solution of a Partial Differential Equation (PDE), written in residual form as finding $u_h \\in V_h$ such that $F_h(u_h) = 0$, where $F_h: V_h \\to V_h'$ is the discrete nonlinear operator, and $V_h$ is a finite-dimensional space. Suppose the Full Approximation Scheme (FAS) for nonlinear multigrid is employed to compute an approximation $u_h^{(k)}$ after $k$ cycles. Let the nonlinear residual at cycle $k$ be $r_h^{(k)} := F_h(u_h^{(k)})$, measured in some consistent norm $\\|\\cdot\\|$ on $V_h'$. Let the (unknown) discrete solution be $u_h^\\ast$ and the algebraic error be $e_h^{(k)} := u_h^{(k)} - u_h^\\ast$.\n\nYou are asked to propose practical stopping criteria for FAS based on the nonlinear residual norm $\\|F_h(u_h^{(k)})\\|$ and its relative decrease per cycle, and to justify how these criteria relate to the actual algebraic error $\\|e_h^{(k)}\\|$ under commonly used regularity and stability assumptions for nonlinear elliptic problems.\n\nWhich of the following proposals and justifications are valid?\n\nA. Stop at the first $k$ such that $\\|F_h(u_h^{(k)})\\| \\le \\max\\{\\tau_{\\mathrm{abs}},\\, \\tau_{\\mathrm{rel}}\\|F_h(u_h^{(0)})\\|\\}$, with $\\tau_{\\mathrm{abs}} > 0$ and $\\tau_{\\mathrm{rel}} \\in (0,1)$. Justification: if $F_h$ is Fréchet differentiable and its Jacobian at $u_h^\\ast$ is uniformly nonsingular and coercive in a neighborhood of $u_h^\\ast$, with constants independent of $h$, then there exists $C>0$ independent of $h$ such that $\\|e_h^{(k)}\\| \\le C \\|F_h(u_h^{(k)})\\|$. Hence this residual-based criterion controls the algebraic error up to a constant multiple.\n\nB. Stop as soon as the per-cycle relative decrease $\\theta^{(k)} := \\|F_h(u_h^{(k)})\\|/\\|F_h(u_h^{(k-1)})\\|$ falls below a prescribed threshold, e.g., $\\theta^{(k)} \\le 0.95$, regardless of the absolute residual magnitude. Justification: a sustained decrease per cycle guarantees that the algebraic error is already small because multigrid smoothers damp high-frequency error components.\n\nC. Use a combined criterion: stop when either $\\|F_h(u_h^{(k)})\\| \\le \\max\\{\\tau_{\\mathrm{abs}},\\, \\tau_{\\mathrm{rel}}\\|F_h(u_h^{(0)})\\|\\}$ or when $\\theta^{(k)} \\ge \\rho_{\\mathrm{sat}}$ for $m \\ge 2$ consecutive cycles with $\\rho_{\\mathrm{sat}} \\in (0,1)$, and an independent discretization error indicator $\\eta_h$ (e.g., an a posteriori estimator of order $\\mathcal{O}(h^p)$) satisfies $\\|F_h(u_h^{(k)})\\| \\lesssim \\eta_h$. Justification: if the observed reduction has saturated and the residual is at the level consistent with the estimated discretization error, then the remaining algebraic error is negligible relative to the discretization error, making further FAS cycles unnecessary.\n\nD. Use only a step-difference test: stop when $\\|u_h^{(k)} - u_h^{(k-1)}\\| \\le \\tau_{\\mathrm{step}}$ for some $\\tau_{\\mathrm{step}} > 0$, without monitoring the nonlinear residual. Justification: small successive updates imply that the nonlinear fixed point has been reached.\n\nE. Relate residual and error via local linearization: if $F_h$ is Fréchet differentiable and satisfies strong monotonicity and Lipschitz continuity in a neighborhood of $u_h^\\ast$, with constants independent of $h$, then there exist mesh-independent constants $c_1,c_2>0$ such that for all $u_h$ sufficiently close to $u_h^\\ast$, $c_1 \\|u_h - u_h^\\ast\\| \\le \\|F_h(u_h)\\| \\le c_2 \\|u_h - u_h^\\ast\\|$. Consequently, an absolute/relative residual criterion yields a reliable proxy for the algebraic error up to multiplicative constants.", "solution": "The problem statement is valid. It presents a well-posed and scientifically grounded question within the domain of numerical analysis for partial differential equations, specifically regarding the Full Approximation Scheme (FAS) for nonlinear multigrid methods. All terms are standard and the context is clear.\n\nThe core of the problem lies in establishing a reliable connection between an observable quantity, the nonlinear residual norm $\\|F_h(u_h^{(k)})\\|$, and the quantity of interest, the (unobservable) algebraic error norm $\\|e_h^{(k)}\\| = \\|u_h^{(k)} - u_h^\\ast\\|$. Here, $u_h^\\ast$ is the exact solution to the discrete problem $F_h(u_h) = 0$.\n\nLet us analyze this connection. Since $F_h(u_h^\\ast) = 0$, the residual is $r_h^{(k)} = F_h(u_h^{(k)}) = F_h(u_h^{(k)}) - F_h(u_h^\\ast)$. If the nonlinear operator $F_h$ is Fréchet differentiable in a neighborhood of the solution $u_h^\\ast$, we can apply the Mean Value Theorem for vector-valued functions. This yields:\n$$F_h(u_h^{(k)}) - F_h(u_h^\\ast) = \\left( \\int_0^1 F_h'(u_h^\\ast + t(u_h^{(k)} - u_h^\\ast)) \\,dt \\right) (u_h^{(k)} - u_h^\\ast)$$\nwhere $F_h'$ is the Fréchet derivative (the Jacobian). Let $\\bar{J}_h^{(k)} = \\int_0^1 F_h'(u_h^\\ast + t e_h^{(k)}) \\,dt$ be the integrated Jacobian. The relation is thus $r_h^{(k)} = \\bar{J}_h^{(k)} e_h^{(k)}$.\n\nUnder common assumptions for well-posed nonlinear elliptic problems, the operator $F_h$ exhibits properties that allow us to bound the norms. Specifically, if $F_h$ is strongly monotone and Lipschitz continuous in a neighborhood of $u_h^\\ast$, with constants $c_1 > 0$ and $c_2 > 0$ that are independent of the mesh size $h$, then a norm equivalence can be established.\n1.  **Strong monotonicity**: $\\langle F_h(u) - F_h(v), u-v \\rangle \\ge c_1 \\|u-v\\|^2$. Setting $v=u_h^\\ast$ and applying the Cauchy-Schwarz inequality gives $\\|F_h(u)\\| \\ge c_1 \\|u - u_h^\\ast\\|$.\n2.  **Lipschitz continuity**: $\\|F_h(u) - F_h(v)\\| \\le c_2 \\|u-v\\|$. Setting $v=u_h^\\ast$ gives $\\|F_h(u)\\| \\le c_2 \\|u - u_h^\\ast\\|$.\n\nCombining these, we obtain the crucial two-sided inequality for $u_h$ sufficiently close to $u_h^\\ast$:\n$$c_1 \\|u_h - u_h^\\ast\\| \\le \\|F_h(u_h)\\| \\le c_2 \\|u_h - u_h^\\ast\\|$$\nThis relationship establishes that the nonlinear residual norm is a reliable proxy for the algebraic error norm, up to mesh-independent multiplicative constants. A stopping criterion based on reducing $\\|F_h(u_h)\\|$ is therefore theoretically sound.\n\nAnother key principle is the balancing of errors. The total error of a numerical solution consists of the algebraic error and the discretization error: $u_h^{(k)} - u_{\\text{true}} = (u_h^{(k)} - u_h^\\ast) + (u_h^\\ast - u_{\\text{true}})$. It is computationally inefficient to reduce the algebraic error to a level significantly below that of the inherent discretization error. A good stopping criterion may therefore involve comparing the residual (a proxy for algebraic error) to an estimate of the discretization error, $\\eta_h$.\n\nWith these principles, we evaluate each option.\n\n**A. Stop at the first $k$ such that $\\|F_h(u_h^{(k)})\\| \\le \\max\\{\\tau_{\\mathrm{abs}},\\, \\tau_{\\mathrm{rel}}\\|F_h(u_h^{(0)})\\|\\}$, with $\\tau_{\\mathrm{abs}} > 0$ and $\\tau_{\\mathrm{rel}} \\in (0,1)$. Justification: if $F_h$ is Fréchet differentiable and its Jacobian at $u_h^\\ast$ is uniformly nonsingular and coercive in a neighborhood of $u_h^\\ast$, with constants independent of $h$, then there exists $C>0$ independent of $h$ such that $\\|e_h^{(k)}\\| \\le C \\|F_h(u_h^{(k)})\\|$. Hence this residual-based criterion controls the algebraic error up to a constant multiple.**\n\nThis proposal describes a standard, practical, and robust stopping criterion. The justification is sound. The assumption of a uniformly nonsingular and coercive Jacobian $F_h'(u_h^\\ast)$ ensures that for $u_h^{(k)}$ sufficiently close to $u_h^\\ast$, we have $e_h^{(k)} \\approx [F_h'(u_h^\\ast)]^{-1} F_h(u_h^{(k)})$. The uniform invertibility implies $\\|e_h^{(k)}\\| \\lesssim \\|[F_h'(u_h^\\ast)]^{-1}\\| \\|F_h(u_h^{(k)})\\| \\le C \\|F_h(u_h^{(k)})\\|$. Therefore, a small residual guarantees a small algebraic error. The proposal and its justification are valid.\n**Verdict: Correct.**\n\n**B. Stop as soon as the per-cycle relative decrease $\\theta^{(k)} := \\|F_h(u_h^{(k)})\\|/\\|F_h(u_h^{(k-1)})\\|$ falls below a prescribed threshold, e.g., $\\theta^{(k)} \\le 0.95$, regardless of the absolute residual magnitude. Justification: a sustained decrease per cycle guarantees that the algebraic error is already small because multigrid smoothers damp high-frequency error components.**\n\nThis proposal is unreliable. The convergence factor $\\theta^{(k)}$ measures the *rate* of convergence, not the *proximity* to the solution. An iterative method can exhibit a very small (i.e., good) $\\theta^{(k)}$ in the first few steps while the residual $\\|F_h(u_h^{(k)})\\|$ is still unacceptably large. For instance, if $\\|F_h(u_h^{(0)})\\| = 10^8$ and $\\|F_h(u_h^{(1)})\\| = 10^7$, then $\\theta^{(1)}=0.1$, but the residual is still very large. The justification is flawed; a good reduction factor guarantees convergence, but it does not guarantee that the error is already small.\n**Verdict: Incorrect.**\n\n**C. Use a combined criterion: stop when either $\\|F_h(u_h^{(k)})\\| \\le \\max\\{\\tau_{\\mathrm{abs}},\\, \\tau_{\\mathrm{rel}}\\|F_h(u_h^{(0)})\\|\\}$ or when $\\theta^{(k)} \\ge \\rho_{\\mathrm{sat}}$ for $m \\ge 2$ consecutive cycles with $\\rho_{\\mathrm{sat}} \\in (0,1)$, and an independent discretization error indicator $\\eta_h$ (e.g., an a posteriori estimator of order $\\mathcal{O}(h^p)$) satisfies $\\|F_h(u_h^{(k)})\\| \\lesssim \\eta_h$. Justification: if the observed reduction has saturated and the residual is at the level consistent with the estimated discretization error, then the remaining algebraic error is negligible relative to the discretization error, making further FAS cycles unnecessary.**\n\nThis proposal describes a sophisticated and highly efficient stopping strategy. It combines a standard residual check with a more advanced check based on the principle of balancing errors. The second part of the criterion detects when the solver's convergence has stagnated (i.e., the reduction factor $\\theta^{(k)}$ is close to $1$) and checks if this has occurred because the residual level is already comparable to the estimated discretization error ($\\|F_h(u_h^{(k)})\\| \\lesssim \\eta_h$). If so, further iterations are pointless as they would be reducing the algebraic error to a level far below the dominant discretization error. The justification correctly articulates this sound and important principle.\n**Verdict: Correct.**\n\n**D. Use only a step-difference test: stop when $\\|u_h^{(k)} - u_h^{(k-1)}\\| \\le \\tau_{\\mathrm{step}}$ for some $\\tau_{\\mathrm{step}} > 0$, without monitoring the nonlinear residual. Justification: small successive updates imply that the nonlinear fixed point has been reached.**\n\nThis criterion is not robust and is generally discouraged as the sole stopping test. While a small step difference $\\|u_h^{(k)} - u_h^{(k-1)}\\|$ is a necessary condition for convergence, it is not sufficient. For slowly converging methods or in flat regions of the energy landscape associated with the problem, the iterates can move very slowly ($u_h^{(k)} \\approx u_h^{(k-1)}$) while still being far from the solution $u_h^\\ast$ and having a large residual $\\|F_h(u_h^{(k)})\\|$. Relying on this test alone can lead to premature termination with a poor quality solution.\n**Verdict: Incorrect.**\n\n**E. Relate residual and error via local linearization: if $F_h$ is Fréchet differentiable and satisfies strong monotonicity and Lipschitz continuity in a neighborhood of $u_h^\\ast$, with constants independent of $h$, then there exist mesh-independent constants $c_1,c_2>0$ such that for all $u_h$ sufficiently close to $u_h^\\ast$, $c_1 \\|u_h - u_h^\\ast\\| \\le \\|F_h(u_h)\\| \\le c_2 \\|u_h - u_h^\\ast\\|$. Consequently, an absolute/relative residual criterion yields a reliable proxy for the algebraic error up to multiplicative constants.**\n\nThis option provides the rigorous theoretical foundation for using residual-based stopping criteria. It correctly states the conditions (strong monotonicity and Lipschitz continuity, with mesh-independent constants) under which the norm equivalence between the algebraic error and the nonlinear residual holds. This equivalence is precisely what makes monitoring the residual an effective strategy for controlling the error. As such, this is a valid justification for criteria of the type presented in option A. The implicit \"proposal\" is to use such criteria, which is justified by the stated mathematical theorem. The statement and its conclusion are entirely correct.\n**Verdict: Correct.**", "answer": "$$\\boxed{ACE}$$", "id": "3396549"}]}