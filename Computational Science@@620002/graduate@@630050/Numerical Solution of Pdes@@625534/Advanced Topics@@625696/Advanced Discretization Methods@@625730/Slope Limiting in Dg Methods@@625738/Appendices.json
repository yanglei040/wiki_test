{"hands_on_practices": [{"introduction": "Discontinuous Galerkin methods can produce non-physical oscillations, or \"wiggles,\" near sharp gradients or discontinuities. To ensure solutions remain stable and physically plausible, we employ slope limiters. This first exercise provides a hands-on application of the classic `minmod` limiter, a cornerstone of Total Variation Diminishing (TVD) schemes, demonstrating how it identifies a local extremum in the solution and appropriately reduces the polynomial slope to prevent overshoot.[@problem_id:3443823]", "problem": "Consider the one-dimensional scalar conservation law $u_{t} + f(u)_{x} = 0$ discretized on a uniform mesh of cells $\\{I_{i}\\}$ with spacing $h0$ and cell centers $x_{i}$. In a piecewise linear Discontinuous Galerkin (DG) approximation, the local polynomial representation in cell $I_{i}$ is $p_{i}(x) = \\bar{u}_{i} + s_{i}(x - x_{i})$, where $\\bar{u}_{i}$ denotes the cell average and $s_{i}$ is a slope estimated from the modal coefficient. To suppress spurious oscillations while preserving a discrete maximum principle under a monotone numerical flux and a Forward Euler time update, one enforces that the reconstructed interfacial values $p_{i}(x_{i\\pm\\frac{1}{2}}) = \\bar{u}_{i} \\pm \\frac{h}{2}s_{i}$ lie between neighboring cell averages, which implies that the admissible slope must be sign-consistent with the one-sided discrete gradients and must not exceed their magnitudes.\n\nStarting from the above monotonicity constraint and the requirement for Total Variation Diminishing (TVD) behavior, derive the limiting rule for the slope $s_{i}$ in terms of the one-sided differences $(\\bar{u}_{i} - \\bar{u}_{i-1})/h$ and $(\\bar{u}_{i+1} - \\bar{u}_{i})/h$, and then apply this rule to compute the limited slope $s_{i}^{\\ell}$ in the following specific configuration:\n- Neighboring cell averages are given by $\\bar{u}_{i-1} = 1$, $\\bar{u}_{i} = 0.2$, and $\\bar{u}_{i+1} = 0.3$.\n- The local unconstrained slope estimate is $s_{i} = 0.9$.\n\nAssume $h0$ and that the limiter is constructed using the classical minmod mechanism applied to the set $\\{s_{i}, (\\bar{u}_{i} - \\bar{u}_{i-1})/h, (\\bar{u}_{i+1} - \\bar{u}_{i})/h\\}$. Provide the final value of $s_{i}^{\\ell}$ as an exact number with no rounding, and do not include any physical units.", "solution": "The problem requires the derivation of a slope limiting rule for a piecewise linear Discontinuous Galerkin (DG) method and its application to a specific case. The validation of the problem statement is the first step.\n\n**Problem Validation**\n\nStep 1: Extract Givens\n-   The one-dimensional scalar conservation law is $u_{t} + f(u)_{x} = 0$.\n-   The computational grid consists of uniform cells $\\{I_{i}\\}$ with spacing $h  0$ and centers $x_{i}$.\n-   The local DG approximation in cell $I_{i}$ is a linear polynomial $p_{i}(x) = \\bar{u}_{i} + s_{i}(x - x_{i})$, where $\\bar{u}_{i}$ is the cell average and $s_{i}$ is the slope.\n-   A monotonicity constraint is imposed: the reconstructed interfacial values $p_{i}(x_{i\\pm\\frac{1}{2}}) = \\bar{u}_{i} \\pm \\frac{h}{2}s_{i}$ must lie between neighboring cell averages.\n-   This constraint implies that the admissible slope must be sign-consistent with the one-sided discrete gradients, $(\\bar{u}_{i} - \\bar{u}_{i-1})/h$ and $(\\bar{u}_{i+1} - \\bar{u}_{i})/h$, and must not exceed their magnitudes.\n-   The specific numerical values for the computation are: $\\bar{u}_{i-1} = 1$, $\\bar{u}_{i} = 0.2$, $\\bar{u}_{i+1} = 0.3$.\n-   The local unconstrained slope estimate is $s_{i} = 0.9$.\n-   The limiter to be used is the classical minmod mechanism applied to the set $\\{s_{i}, (\\bar{u}_{i} - \\bar{u}_{i-1})/h, (\\bar{u}_{i+1} - \\bar{u}_{i})/h\\}$.\n\nStep 2: Validate Using Extracted Givens\nThe problem is scientifically grounded, as it deals with standard slope-limiting techniques (specifically, a TVD-type limiter) for DG methods, which is a well-established area within numerical analysis for partial differential equations. The problem is well-posed, providing all necessary data and a clear objective. The terminology is precise and objective. There are no contradictions, missing data, or scientifically unsound premises. The problem is a standard exercise in the field of computational fluid dynamics and numerical methods.\n\nStep 3: Verdict and Action\nThe problem is deemed valid. A complete solution will be provided.\n\n**Derivation of the Limiting Rule**\n\nThe objective of a slope limiter in this context is to enforce a monotonicity principle, preventing the creation of new local extrema in the numerical solution, which is crucial for obtaining physically meaningful, non-oscillatory solutions to hyperbolic conservation laws. The problem statement provides the core constraints for the limited slope, which we will formalize.\n\nLet $s_i^\\ell$ denote the limited slope. The one-sided discrete gradients (or finite difference slopes) are defined as:\n-   Backward difference slope: $\\Delta_i^- = \\frac{\\bar{u}_{i} - \\bar{u}_{i-1}}{h}$\n-   Forward difference slope: $\\Delta_i^+ = \\frac{\\bar{u}_{i+1} - \\bar{u}_{i}}{h}$\n\nThe constraints on $s_i^\\ell$ are given as:\n1.  **Sign Consistency**: The slope $s_i^\\ell$ must have the same sign as both $\\Delta_i^-$ and $\\Delta_i^+$. This is only possible if $\\Delta_i^-$ and $\\Delta_i^+$ have the same sign. If their signs differ, which occurs at a local extremum (a peak or a trough), no non-zero slope can be sign-consistent with both. In this case, to prevent overshoot or undershoot, the reconstruction must be made constant, implying the slope must be zero. So, if $\\text{sign}(\\Delta_i^-) \\neq \\text{sign}(\\Delta_i^+)$, then $s_i^\\ell = 0$.\n2.  **Magnitude Constraint**: The magnitude of the slope must not exceed the magnitudes of the one-sided discrete gradients. This translates to $|s_i^\\ell| \\le |\\Delta_i^-|$ and $|s_i^\\ell| \\le |\\Delta_i^+|$. Combining these, we get $|s_i^\\ell| \\le \\min(|\\Delta_i^-|, |\\Delta_i^+|)$.\n\nThese conditions are precisely encapsulated by the minmod function, which is defined for a set of arguments $\\{a_1, a_2, \\dots, a_n\\}$ as:\n$$\n\\text{minmod}(a_1, a_2, \\dots, a_n) =\n\\begin{cases}\n\\min(a_1, \\dots, a_n)  \\text{if } a_j  0 \\text{ for all } j \\\\\n\\max(a_1, \\dots, a_n)  \\text{if } a_j  0 \\text{ for all } j \\\\\n0  \\text{otherwise}\n\\end{cases}\n$$\nApplying this to the two discrete gradients, the maximum slope satisfying the monotonicity bounds derived from neighbors is $s'_{i} = \\text{minmod}(\\Delta_i^-, \\Delta_i^+)$.\n\nThe final step is to limit the original, unconstrained slope $s_{i}$. The principle of limiting is to modify the original slope as little as possible. The limited slope $s_i^\\ell$ must satisfy the monotonicity conditions derived above, while also not having a magnitude greater than the original slope, i.e., $|s_i^\\ell| \\le |s_i|$. This is achieved by including the original slope $s_i$ as an argument in the minmod function. The resulting limited slope is:\n$$ s_i^\\ell = \\text{minmod}(s_i, s'_{i}) = \\text{minmod}\\left(s_i, \\text{minmod}(\\Delta_i^-, \\Delta_i^+)\\right) $$\nBy the properties of the minmod function, this is equivalent to:\n$$ s_i^\\ell = \\text{minmod}(s_i, \\Delta_i^-, \\Delta_i^+) = \\text{minmod}\\left(s_i, \\frac{\\bar{u}_i - \\bar{u}_{i-1}}{h}, \\frac{\\bar{u}_{i+1} - \\bar{u}_i}{h}\\right) $$\nThis confirms the validity of the rule specified in the problem statement.\n\n**Application to the Specific Configuration**\n\nWe are asked to compute the limited slope $s_i^\\ell$ for the given data. The arguments for the minmod function are:\n1.  The unconstrained slope: $s_i = 0.9$.\n2.  The backward difference slope: $\\Delta_i^- = \\frac{\\bar{u}_i - \\bar{u}_{i-1}}{h} = \\frac{0.2 - 1}{h} = -\\frac{0.8}{h}$.\n3.  The forward difference slope: $\\Delta_i^+ = \\frac{\\bar{u}_{i+1} - \\bar{u}_i}{h} = \\frac{0.3 - 0.2}{h} = \\frac{0.1}{h}$.\n\nThe three arguments to the minmod function are $\\{0.9, -0.8/h, 0.1/h\\}$. We must determine their signs. Since $h0$ is given:\n-   $s_i = 0.9$ is positive.\n-   $\\Delta_i^- = -0.8/h$ is negative.\n-   $\\Delta_i^+ = 0.1/h$ is positive.\n\nThe set of arguments $\\{0.9, -0.8/h, 0.1/h\\}$ contains both positive and negative values. According to the definition of the minmod function, if the arguments do not all have the same sign, the result is zero. This situation corresponds to cell $I_i$ being a local minimum ($\\bar{u}_i$ is less than both $\\bar{u}_{i-1}$ and $\\bar{u}_{i+1}$), and the limiter correctly flattens the reconstruction to a constant value ($\\bar{u}_{i}$) to prevent the creation of a new, non-physical minimum (undershoot).\n\nTherefore, the limited slope is:\n$$ s_i^\\ell = \\text{minmod}\\left(0.9, -\\frac{0.8}{h}, \\frac{0.1}{h}\\right) = 0 $$\nThe final value is independent of the mesh spacing $h$.", "answer": "$$\\boxed{0}$$", "id": "3443823"}, {"introduction": "While limiting is straightforward for scalar equations, applying it to systems like the compressible Euler equations presents a new challenge, as the conserved variables are physically coupled. A naive component-wise limiting approach can lead to unphysical states, as it ignores the underlying wave structure of the system. This practice will guide you through a comparison of component-wise versus the physically-motivated characteristic-wise limiting, allowing you to see firsthand why working in characteristic space is crucial for obtaining robust and accurate solutions for systems of conservation laws.[@problem_id:3443857]", "problem": "Consider the one-dimensional compressible Euler equations for an ideal gas with ratio of specific heats $\\gamma = 1.4$ in a Discontinuous Galerkin (DG) finite element context. You are given cell-averaged conserved states on a uniform grid in three consecutive cells $i-1$, $i$, and $i+1$:\n$$\n\\boldsymbol{U}_{i-1} = \\begin{pmatrix} 1.0 \\\\ 0.0 \\\\ 2.5 \\end{pmatrix},\\quad\n\\boldsymbol{U}_{i} = \\begin{pmatrix} 0.9 \\\\ 0.18 \\\\ 2.018 \\end{pmatrix},\\quad\n\\boldsymbol{U}_{i+1} = \\begin{pmatrix} 0.5 \\\\ 0.2 \\\\ 1.29 \\end{pmatrix},\n$$\nwhere $\\boldsymbol{U} = (\\rho, \\rho u, E)^{\\mathsf{T}}$ collects the density $\\rho$, momentum $\\rho u$, and total energy $E$. All quantities are nondimensional.\n\nUsing a piecewise-linear reconstruction in each cell with symmetric slope limiting based on the Total Variation Diminishing (TVD) minmod function, define the undivided differences\n$$\n\\Delta^{-}\\boldsymbol{U}_{i} = \\boldsymbol{U}_{i} - \\boldsymbol{U}_{i-1},\\qquad\n\\Delta^{+}\\boldsymbol{U}_{i} = \\boldsymbol{U}_{i+1} - \\boldsymbol{U}_{i}.\n$$\nLet the minmod function be\n$$\n\\operatorname{mm}(a,b) = \\begin{cases}\n\\operatorname{sign}(a)\\,\\min(|a|,|b|),  \\text{if } ab  0,\\\\\n0,  \\text{otherwise}.\n\\end{cases}\n$$\n\nPerform the following two reconstructions for the left state at the interface $x_{i+1/2}$:\n\n1) Component-wise limiting in conserved variables: construct the limited slope\n$$\n\\boldsymbol{S}^{\\mathrm{comp}}_{i} = \\begin{pmatrix}\n\\operatorname{mm}(\\Delta^{-}\\rho_{i},\\Delta^{+}\\rho_{i}) \\\\[4pt]\n\\operatorname{mm}(\\Delta^{-}(\\rho u)_{i},\\Delta^{+}(\\rho u)_{i}) \\\\[4pt]\n\\operatorname{mm}(\\Delta^{-}E_{i},\\Delta^{+}E_{i})\n\\end{pmatrix},\n$$\nand set the reconstructed left state\n$$\n\\boldsymbol{U}^{-,\\mathrm{comp}}_{i+1/2} = \\boldsymbol{U}_{i} + \\tfrac{1}{2}\\,\\boldsymbol{S}^{\\mathrm{comp}}_{i}.\n$$\n\n2) Characteristic-wise limiting: form the Jacobian-based characteristic decomposition at cell $i$ by using the standard right-eigenvector matrix $\\boldsymbol{R}(\\boldsymbol{U}_{i})$ and its inverse $\\boldsymbol{L}(\\boldsymbol{U}_{i}) = \\boldsymbol{R}(\\boldsymbol{U}_{i})^{-1}$ for the one-dimensional Euler flux Jacobian (in conserved variables). Project the undivided differences to characteristic space\n$$\n\\boldsymbol{w}^{-}_{i} = \\boldsymbol{L}(\\boldsymbol{U}_{i})\\,\\Delta^{-}\\boldsymbol{U}_{i},\\qquad\n\\boldsymbol{w}^{+}_{i} = \\boldsymbol{L}(\\boldsymbol{U}_{i})\\,\\Delta^{+}\\boldsymbol{U}_{i},\n$$\nlimit each characteristic component with the minmod function to obtain $\\widetilde{\\boldsymbol{w}}_{i}$, map back to conserved variables via $\\widetilde{\\boldsymbol{S}}^{\\mathrm{char}}_{i} = \\boldsymbol{R}(\\boldsymbol{U}_{i})\\,\\widetilde{\\boldsymbol{w}}_{i}$, and set\n$$\n\\boldsymbol{U}^{-,\\mathrm{char}}_{i+1/2} = \\boldsymbol{U}_{i} + \\tfrac{1}{2}\\,\\widetilde{\\boldsymbol{S}}^{\\mathrm{char}}_{i}.\n$$\n\nFor each reconstructed left state, compute the thermodynamic pressure\n$$\np = (\\gamma - 1)\\left(E - \\tfrac{1}{2}\\,\\frac{(\\rho u)^{2}}{\\rho}\\right).\n$$\n\nFinally, form the ratio of the two pressures\n$$\n\\Pi = \\frac{p^{\\mathrm{char}}}{p^{\\mathrm{comp}}}.\n$$\n\nAll calculations must be self-consistent with the definitions above. Express the final answer as a pure number (nondimensional), and round your answer to five significant figures.", "solution": "The user has provided a well-defined problem in the field of computational fluid dynamics, specifically concerning slope-limiting techniques for the Discontinuous Galerkin method applied to the one-dimensional Euler equations. The problem is scientifically sound, self-contained, and all required data and definitions are provided. The problem is therefore deemed **valid**.\n\nThe solution requires performing two types of reconstructions for the fluid state at a cell interface and then comparing the resulting pressures. The two methods are component-wise limiting and characteristic-wise limiting.\n\n### Given Data\n- Ratio of specific heats: $\\gamma = 1.4$\n- Cell-averaged conserved states:\n  $$ \\boldsymbol{U}_{i-1} = \\begin{pmatrix} 1.0 \\\\ 0.0 \\\\ 2.5 \\end{pmatrix}, \\quad \\boldsymbol{U}_{i} = \\begin{pmatrix} 0.9 \\\\ 0.18 \\\\ 2.018 \\end{pmatrix}, \\quad \\boldsymbol{U}_{i+1} = \\begin{pmatrix} 0.5 \\\\ 0.2 \\\\ 1.29 \\end{pmatrix} $$\n- State vector: $\\boldsymbol{U} = (\\rho, \\rho u, E)^{\\mathsf{T}}$\n- Pressure calculation: $p = (\\gamma - 1)\\left(E - \\frac{1}{2}\\,\\frac{(\\rho u)^{2}}{\\rho}\\right)$\n\n### Part 1: Component-wise Limiting\n\nFirst, we calculate the undivided differences of the conserved variables between adjacent cells.\n$$ \\Delta^{-}\\boldsymbol{U}_{i} = \\boldsymbol{U}_{i} - \\boldsymbol{U}_{i-1} = \\begin{pmatrix} 0.9 - 1.0 \\\\ 0.18 - 0.0 \\\\ 2.018 - 2.5 \\end{pmatrix} = \\begin{pmatrix} -0.1 \\\\ 0.18 \\\\ -0.482 \\end{pmatrix} $$\n$$ \\Delta^{+}\\boldsymbol{U}_{i} = \\boldsymbol{U}_{i+1} - \\boldsymbol{U}_{i} = \\begin{pmatrix} 0.5 - 0.9 \\\\ 0.2 - 0.18 \\\\ 1.29 - 2.018 \\end{pmatrix} = \\begin{pmatrix} -0.4 \\\\ 0.02 \\\\ -0.728 \\end{pmatrix} $$\n\nNext, we apply the `minmod` function component-wise to these differences to find the limited slope vector $\\boldsymbol{S}^{\\mathrm{comp}}_{i}$.\n$$ S^{\\mathrm{comp}}_{1} = \\operatorname{mm}(-0.1, -0.4) = \\operatorname{sign}(-0.1)\\min(|-0.1|, |-0.4|) = -0.1 $$\n$$ S^{\\mathrm{comp}}_{2} = \\operatorname{mm}(0.18, 0.02) = \\operatorname{sign}(0.18)\\min(|0.18|, |0.02|) = 0.02 $$\n$$ S^{\\mathrm{comp}}_{3} = \\operatorname{mm}(-0.482, -0.728) = \\operatorname{sign}(-0.482)\\min(|-0.482|, |-0.728|) = -0.482 $$\nSo, the limited slope is $\\boldsymbol{S}^{\\mathrm{comp}}_{i} = (-0.1, 0.02, -0.482)^{\\mathsf{T}}$.\n\nThe reconstructed left state at the interface $x_{i+1/2}$ is given by:\n$$ \\boldsymbol{U}^{-,\\mathrm{comp}}_{i+1/2} = \\boldsymbol{U}_{i} + \\frac{1}{2}\\boldsymbol{S}^{\\mathrm{comp}}_{i} = \\begin{pmatrix} 0.9 \\\\ 0.18 \\\\ 2.018 \\end{pmatrix} + \\frac{1}{2}\\begin{pmatrix} -0.1 \\\\ 0.02 \\\\ -0.482 \\end{pmatrix} = \\begin{pmatrix} 0.9 - 0.05 \\\\ 0.18 + 0.01 \\\\ 2.018 - 0.241 \\end{pmatrix} = \\begin{pmatrix} 0.85 \\\\ 0.19 \\\\ 1.777 \\end{pmatrix} $$\nLet this reconstructed state be denoted $\\boldsymbol{U}^{\\mathrm{comp}} = (\\rho^{\\mathrm{comp}}, (\\rho u)^{\\mathrm{comp}}, E^{\\mathrm{comp}})^{\\mathsf{T}}$.\n\nFinally, we compute the pressure $p^{\\mathrm{comp}}$ for this state:\n$$ p^{\\mathrm{comp}} = (\\gamma - 1)\\left(E^{\\mathrm{comp}} - \\frac{1}{2}\\,\\frac{((\\rho u)^{\\mathrm{comp}})^{2}}{\\rho^{\\mathrm{comp}}}\\right) = (1.4 - 1)\\left(1.777 - \\frac{1}{2}\\,\\frac{(0.19)^{2}}{0.85}\\right) $$\n$$ p^{\\mathrm{comp}} = 0.4\\left(1.777 - \\frac{0.0361}{1.7}\\right) = 0.4(1.777 - 0.02123529...) = 0.4(1.7557647...) = 0.70230588... $$\n\n### Part 2: Characteristic-wise Limiting\n\nThis procedure requires projecting the differences onto the characteristic fields of the Euler equations. The matrices for this projection, $\\boldsymbol{R}$ and $\\boldsymbol{L}$, depend on the local fluid state in cell $i$.\nFirst, we compute the primitive variables for state $\\boldsymbol{U}_{i}$:\n$$ \\rho_i = 0.9 $$\n$$ u_i = \\frac{(\\rho u)_i}{\\rho_i} = \\frac{0.18}{0.9} = 0.2 $$\n$$ p_i = (\\gamma-1)\\left(E_i - \\frac{1}{2}\\rho_i u_i^2\\right) = (1.4-1)\\left(2.018 - \\frac{1}{2}(0.9)(0.2)^2\\right) = 0.4(2.018 - 0.018) = 0.4(2.0) = 0.8 $$\nThe speed of sound $c_i$ is:\n$$ c_i = \\sqrt{\\frac{\\gamma p_i}{\\rho_i}} = \\sqrt{\\frac{1.4 \\times 0.8}{0.9}} = \\sqrt{\\frac{1.12}{0.9}} = \\sqrt{\\frac{56}{45}} \\approx 1.11554676 $$\n\nThe left eigenvector matrix $\\boldsymbol{L}(\\boldsymbol{U}_{i})$ is used to project the undivided differences into characteristic space. Using a standard formulation, we get:\n$$ \\boldsymbol{L}(\\boldsymbol{U}_{i}) \\approx \\begin{pmatrix} 0.092871  -0.480424  0.160714 \\\\ 0.993683  0.064286  -0.321429 \\\\ -0.086455  0.416161  0.160714 \\end{pmatrix} $$\nWe now project the differences: $\\boldsymbol{w}^{-}_{i} = \\boldsymbol{L}\\Delta^{-}\\boldsymbol{U}_{i}$ and $\\boldsymbol{w}^{+}_{i} = \\boldsymbol{L}\\Delta^{+}\\boldsymbol{U}_{i}$.\n$$ \\boldsymbol{w}^{-}_{i} = \\boldsymbol{L} \\begin{pmatrix} -0.1 \\\\ 0.18 \\\\ -0.482 \\end{pmatrix} \\approx \\begin{pmatrix} -0.173227 \\\\ 0.067132 \\\\ 0.006091 \\end{pmatrix} $$\n$$ \\boldsymbol{w}^{+}_{i} = \\boldsymbol{L} \\begin{pmatrix} -0.4 \\\\ 0.02 \\\\ -0.728 \\end{pmatrix} \\approx \\begin{pmatrix} -0.163755 \\\\ -0.162197 \\\\ -0.074094 \\end{pmatrix} $$\n\nNext, apply the `minmod` function to each component of the characteristic variable vectors:\n$$ \\widetilde{w}_{1} = \\operatorname{mm}(w^{-}_{1}, w^{+}_{1}) = \\operatorname{mm}(-0.173227, -0.163755) = -0.163755 $$\n$$ \\widetilde{w}_{2} = \\operatorname{mm}(w^{-}_{2}, w^{+}_{2}) = \\operatorname{mm}(0.067132, -0.162197) = 0 $$\n$$ \\widetilde{w}_{3} = \\operatorname{mm}(w^{-}_{3}, w^{+}_{3}) = \\operatorname{mm}(0.006091, -0.074094) = 0 $$\nThe limited characteristic vector is $\\widetilde{\\boldsymbol{w}}_{i} \\approx (-0.163755, 0, 0)^{\\mathsf{T}}$. The slopes for the second and third characteristic fields are set to zero because the signs of their corresponding differences are opposite, indicating a local extremum.\n\nThis limited vector is mapped back to conserved variables using the right eigenvector matrix, $\\boldsymbol{R}(\\boldsymbol{U}_{i})$, to get the limited slope $\\widetilde{\\boldsymbol{S}}^{\\mathrm{char}}_{i} = \\boldsymbol{R}\\widetilde{\\boldsymbol{w}}_{i}$. Since only the first component of $\\widetilde{\\boldsymbol{w}}_{i}$ is non-zero, we only need the first right eigenvector $\\boldsymbol{r}_1$:\n$$ \\boldsymbol{r}_1 = (1, u-c, H-uc)^{\\mathsf{T}} $$\nwhere $H = \\frac{E+p}{\\rho}$ is the specific total enthalpy.\n$$ H_i = \\frac{E_i+p_i}{\\rho_i} = \\frac{2.018+0.8}{0.9} = \\frac{2.818}{0.9} \\approx 3.131111... $$\n$$ \\boldsymbol{r}_1 \\approx (1, 0.2 - 1.115547, 3.131111 - 0.2 \\times 1.115547)^{\\mathsf{T}} \\approx (1, -0.915547, 2.908002)^{\\mathsf{T}} $$\nThe limited slope is:\n$$ \\widetilde{\\boldsymbol{S}}^{\\mathrm{char}}_{i} = \\widetilde{w}_{1} \\boldsymbol{r}_1 \\approx -0.163755 \\times \\begin{pmatrix} 1 \\\\ -0.915547 \\\\ 2.908002 \\end{pmatrix} \\approx \\begin{pmatrix} -0.163755 \\\\ 0.149921 \\\\ -0.476191 \\end{pmatrix} $$\n\nThe reconstructed left state at the interface $x_{i+1/2}$ is:\n$$ \\boldsymbol{U}^{-,\\mathrm{char}}_{i+1/2} = \\boldsymbol{U}_{i} + \\frac{1}{2}\\widetilde{\\boldsymbol{S}}^{\\mathrm{char}}_{i} \\approx \\begin{pmatrix} 0.9 \\\\ 0.18 \\\\ 2.018 \\end{pmatrix} + \\frac{1}{2}\\begin{pmatrix} -0.163755 \\\\ 0.149921 \\\\ -0.476191 \\end{pmatrix} \\approx \\begin{pmatrix} 0.818123 \\\\ 0.254961 \\\\ 1.779904 \\end{pmatrix} $$\nLet this be $\\boldsymbol{U}^{\\mathrm{char}} = (\\rho^{\\mathrm{char}}, (\\rho u)^{\\mathrm{char}}, E^{\\mathrm{char}})^{\\mathsf{T}}$.\n\nThe corresponding pressure $p^{\\mathrm{char}}$ is:\n$$ p^{\\mathrm{char}} = (\\gamma - 1)\\left(E^{\\mathrm{char}} - \\frac{1}{2}\\,\\frac{((\\rho u)^{\\mathrm{char}})^{2}}{\\rho^{\\mathrm{char}}}\\right) \\approx 0.4\\left(1.779904 - \\frac{1}{2}\\,\\frac{(0.254961)^{2}}{0.818123}\\right) $$\n$$ p^{\\mathrm{char}} \\approx 0.4\\left(1.779904 - \\frac{0.065005}{1.636246}\\right) \\approx 0.4(1.779904 - 0.039728) \\approx 0.4(1.740176) \\approx 0.696070 $$\n\n### Final Calculation\n\nFinally, we compute the ratio $\\Pi$ of the two pressures:\n$$ \\Pi = \\frac{p^{\\mathrm{char}}}{p^{\\mathrm{comp}}} \\approx \\frac{0.696070}{0.70230588} \\approx 0.9911225... $$\n\nRounding the result to five significant figures gives $0.99112$.", "answer": "$$\n\\boxed{0.99112}\n$$", "id": "3443857"}, {"introduction": "A critical challenge in high-order methods is to ensure that limiters do not degrade the scheme's accuracy in smooth regions of the flow, particularly near gentle extrema. Standard TVD limiters can be overly aggressive, \"clipping\" smooth peaks and reducing the local accuracy. This advanced problem delves into the design of a more sophisticated Total Variation Bounded (TVB) limiter, tasking you with deriving the adaptive threshold parameter $M$ that allows the limiter to distinguish between genuine oscillations and the natural curvature of a smooth solution, thereby preserving the formal high-order accuracy of the DG scheme.[@problem_id:3443887]", "problem": "Consider the one-dimensional Discontinuous Galerkin (DG) method of polynomial degree two (DG-$p^2$) applied on a uniform mesh of spacing $h$ to a smooth scalar field $u(x)$ on a symmetric interval about $x=0$. Let the local representation on each element be a quadratic polynomial that exactly matches $u(x)$ when $u$ is a quadratic. We wish to design a hierarchical Total Variation Bounded (TVB) limiter that is exact for quadratic data and does not reduce the order near smooth extrema.\n\nAdopt the following modified minmod limiter for the linear (first-order) modal coefficient in each element $i$:\n- Compute the differences of neighboring cell averages $\\Delta^{+}\\bar{u}_i = \\bar{u}_{i+1} - \\bar{u}_i$ and $\\Delta^{-}\\bar{u}_i = \\bar{u}_i - \\bar{u}_{i-1}$, where $\\bar{u}_i$ is the cell average over element $i$.\n- Define an adaptive TVB threshold $M_i$ by $M_i = \\alpha\\,|\\widehat{u''}(x_i)|\\,h^2$, where $\\widehat{u''}(x_i)$ is a smoothness indicator that consistently approximates the second derivative $u''(x)$ at the element center $x_i$, and $\\alpha  0$ is a dimensionless constant to be determined.\n- If $|\\Delta^{+}\\bar{u}_i| \\le M_i$ and $|\\Delta^{-}\\bar{u}_i| \\le M_i$, keep the original linear modal coefficient in element $i$; otherwise, apply the classical minmod limiter using $\\Delta^{\\pm}\\bar{u}_i$ as candidate slopes. For the quadratic (second-order) modal coefficient, use a hierarchical criterion based on interface jump indicators of appropriate order; for quadratic data this criterion must not trigger limiting.\n\nTest the limiter on the smooth extremum $u(x) = 1 - x^2$ on a uniform mesh with element centers $x_i = i h$ and verify the exactness property for DG-$p^2$. Starting from first principles and consistent definitions, derive the asymptotic scaling in $h$ for $M_i$ required to avoid order reduction near the extremum. Then, by computing the neighboring cell-average differences for $u(x) = 1 - x^2$, determine the smallest value of $\\alpha$ such that the limiter does not act in the central element $i=0$ and its immediate neighbors $i = \\pm 1$. Use this $\\alpha$ to express the resulting adaptive threshold $M(h)$ as a single closed-form expression in $h$.\n\nYour final answer must be a single analytic expression for $M(h)$, with no units required. No rounding is necessary.", "solution": "The problem statement has been validated and is determined to be a well-posed, scientifically grounded problem in the field of numerical analysis. We may proceed with the solution.\n\nThe problem asks us to analyze a specific Total Variation Bounded (TVB) limiter for a Discontinuous Galerkin (DG) method of polynomial degree two (DG-$p^2$). We are tasked with finding the value of a constant $\\alpha$ in the limiter's threshold definition such that the limiter does not activate near a smooth extremum for a specific quadratic function, and then to provide the resulting expression for the threshold $M(h)$.\n\nFirst, let us establish the framework. The method is a one-dimensional DG-$p^2$ method on a uniform mesh with cell width $h$. The elements are denoted by $I_i = [x_{i-1/2}, x_{i+1/2}]$, with centers $x_i = i h$ and boundaries $x_{i \\pm 1/2} = (i \\pm 1/2)h$. The problem states that the local polynomial representation within each element is exact for quadratic functions. The test function is the smooth extremum $u(x) = 1 - x^2$. Since $u(x)$ is a quadratic polynomial, the DG-$p^2$ representation $u_h(x)$ within each element $I_i$ is identical to $u(x)$ itself. This verifies the exactness property for this test case.\n\nThe core of the problem lies in the TVB limiter for the linear modal coefficient. The limiter is triggered based on the cell average differences, $\\Delta^{+}\\bar{u}_i = \\bar{u}_{i+1} - \\bar{u}_i$ and $\\Delta^{-}\\bar{u}_i = \\bar{u}_i - \\bar{u}_{i-1}$. The cell average $\\bar{u}_i$ is defined as:\n$$ \\bar{u}_i = \\frac{1}{h} \\int_{x_{i-1/2}}^{x_{i+1/2}} u(x) \\,dx $$\nFor our test function $u(x) = 1 - x^2$ and mesh with $x_i = ih$, we compute the cell averages. The integral of a quadratic polynomial can be calculated exactly using Simpson's rule:\n$$ \\bar{u}_i = \\frac{1}{6} \\left( u(x_{i-1/2}) + 4u(x_i) + u(x_{i+1/2}) \\right) $$\nSubstituting the coordinates $x_i = ih$, $x_{i-1/2} = (i - 1/2)h$, and $x_{i+1/2} = (i + 1/2)h$:\n$$ u(x_i) = 1 - (ih)^2 = 1 - i^2h^2 $$\n$$ u(x_{i-1/2}) = 1 - \\left(\\left(i-\\frac{1}{2}\\right)h\\right)^2 = 1 - \\left(i^2 - i + \\frac{1}{4}\\right)h^2 $$\n$$ u(x_{i+1/2}) = 1 - \\left(\\left(i+\\frac{1}{2}\\right)h\\right)^2 = 1 - \\left(i^2 + i + \\frac{1}{4}\\right)h^2 $$\nPlugging these into the formula for the cell average:\n$$ \\bar{u}_i = \\frac{1}{6} \\left[ \\left(1 - \\left(i^2 - i + \\frac{1}{4}\\right)h^2\\right) + 4(1 - i^2h^2) + \\left(1 - \\left(i^2 + i + \\frac{1}{4}\\right)h^2\\right) \\right] $$\n$$ \\bar{u}_i = \\frac{1}{6} \\left[ 6 - h^2 \\left( i^2 - i + \\frac{1}{4} + 4i^2 + i^2 + i + \\frac{1}{4} \\right) \\right] $$\n$$ \\bar{u}_i = 1 - \\frac{h^2}{6} \\left( 6i^2 + \\frac{1}{2} \\right) = 1 - h^2 \\left( i^2 + \\frac{1}{12} \\right) $$\n\nNext, we compute the differences of neighboring cell averages:\n$$ \\Delta^{+}\\bar{u}_i = \\bar{u}_{i+1} - \\bar{u}_i = \\left[1 - h^2\\left((i+1)^2 + \\frac{1}{12}\\right)\\right] - \\left[1 - h^2\\left(i^2 + \\frac{1}{12}\\right)\\right] $$\n$$ \\Delta^{+}\\bar{u}_i = -h^2 \\left( (i+1)^2 - i^2 \\right) = -h^2 (i^2 + 2i + 1 - i^2) = -h^2(2i+1) $$\nAnd for the backward difference:\n$$ \\Delta^{-}\\bar{u}_i = \\bar{u}_i - \\bar{u}_{i-1} = \\left[1 - h^2\\left(i^2 + \\frac{1}{12}\\right)\\right] - \\left[1 - h^2\\left((i-1)^2 + \\frac{1}{12}\\right)\\right] $$\n$$ \\Delta^{-}\\bar{u}_i = -h^2 \\left( i^2 - (i-1)^2 \\right) = -h^2 (i^2 - (i^2 - 2i + 1)) = -h^2(2i-1) $$\n\nThe problem specifies an adaptive TVB threshold $M_i = \\alpha\\,|\\widehat{u''}(x_i)|\\,h^2$. The scaling of $M_i$ with $h^2$ is crucial. Near a smooth extremum, where $u'(x) \\approx 0$, the variation of the function is dominated by the second derivative term, $u(x) \\approx u(x_{ext}) + u''(x_{ext})(x-x_{ext})^2/2$. The difference between cell averages, $\\Delta \\bar{u}_i$, which approximates $h u'(x_{i\\pm1/2})$, will consequently scale as $O(h^2)$. A limiter is designed to detect and suppress non-physical oscillations, which manifest as large gradients. If the threshold $M_i$ were smaller than $O(h^2)$, it would misinterpret the natural curvature of a smooth extremum as an oscillation and apply limiting, thereby clipping the extremum and reducing the local accuracy to first order. Thus, the scaling $M_i \\propto h^2$ is necessary to avoid order reduction at smooth extrema. The given form of $M_i$ possesses this exact scaling.\n\nFor the test function $u(x)=1-x^2$, we have the exact second derivative $u''(x) = -2$. The smoothness indicator $\\widehat{u''}(x_i)$ is a consistent approximation of $u''(x_i)$. Since our DG-$p^2$ representation is exact for this quadratic function, the most natural and consistent choice for the indicator is the exact value itself, $\\widehat{u''}(x_i) = -2$.\nTherefore, the threshold $M_i$ becomes constant for all elements:\n$$ M_i = M = \\alpha |-2| h^2 = 2\\alpha h^2 $$\n\nThe limiter for the linear coefficient does not act if $|\\Delta^{+}\\bar{u}_i| \\le M$ and $|\\Delta^{-}\\bar{u}_i| \\le M$. We need to enforce this condition for the central element $i=0$ and its neighbors $i = \\pm 1$.\n\nFor element $i=0$:\n$$ |\\Delta^{+}\\bar{u}_0| = |-h^2(2(0)+1)| = h^2 $$\n$$ |\\Delta^{-}\\bar{u}_0| = |-h^2(2(0)-1)| = h^2 $$\nThe conditions are $h^2 \\le 2\\alpha h^2$, which simplifies to $1 \\le 2\\alpha$, or $\\alpha \\ge 1/2$.\n\nFor element $i=1$:\n$$ |\\Delta^{+}\\bar{u}_1| = |-h^2(2(1)+1)| = 3h^2 $$\n$$ |\\Delta^{-}\\bar{u}_1| = |-h^2(2(1)-1)| = h^2 $$\nThe conditions are $3h^2 \\le 2\\alpha h^2$ and $h^2 \\le 2\\alpha h^2$. These simplify to $3 \\le 2\\alpha$ and $1 \\le 2\\alpha$. The more restrictive condition is $\\alpha \\ge 3/2$.\n\nFor element $i=-1$:\n$$ |\\Delta^{+}\\bar{u}_{-1}| = |-h^2(2(-1)+1)| = h^2 $$\n$$ |\\Delta^{-}\\bar{u}_{-1}| = |-h^2(2(-1)-1)| = 3h^2 $$\nThe conditions are $h^2 \\le 2\\alpha h^2$ and $3h^2 \\le 2\\alpha h^2$. These simplify to $1 \\le 2\\alpha$ and $3 \\le 2\\alpha$. The more restrictive condition is also $\\alpha \\ge 3/2$.\n\nTo ensure the limiter does not act on any of the elements $i \\in \\{-1, 0, 1\\}$, we must satisfy all constraints on $\\alpha$. The combined requirement is $\\alpha \\ge \\max(1/2, 3/2)$, which means $\\alpha \\ge 3/2$. The problem asks for the smallest value of $\\alpha$ that satisfies the condition, which is $\\alpha = 3/2$.\n\nFinally, we use this value of $\\alpha$ to express the adaptive threshold $M(h)$.\n$$ M(h) = \\alpha |\\widehat{u''}| h^2 = \\frac{3}{2} \\cdot |-2| \\cdot h^2 = \\frac{3}{2} \\cdot 2 \\cdot h^2 = 3h^2 $$\nThis is the required closed-form expression for the threshold.", "answer": "$$\\boxed{3h^2}$$", "id": "3443887"}]}