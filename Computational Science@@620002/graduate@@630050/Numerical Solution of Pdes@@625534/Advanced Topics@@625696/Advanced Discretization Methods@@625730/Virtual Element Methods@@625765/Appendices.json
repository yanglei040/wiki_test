{"hands_on_practices": [{"introduction": "The foundation of any finite element-type method is its choice of local function space on each element. In the Virtual Element Method, we take a unique approach: instead of defining the basis functions explicitly, we define the space through its degrees of freedom (DoFs). This exercise challenges you to build a local VEM space from the ground up by systematically counting its DoFs, providing a concrete understanding of its dimension and structure on a general polygon [@problem_id:3461335].", "problem": "Consider a single simply connected polygonal element $E \\subset \\mathbb{R}^{2}$ with $n_{E}$ straight edges and hence $n_{E}$ vertices, used in a conforming Virtual Element Method (VEM) of polynomial degree $k \\ge 2$ for a second-order elliptic partial differential equation. The local trial space on $E$ is designed so that: (i) traces on each edge lie in the space of polynomials of degree at most $k$, and (ii) the space contains all polynomials of total degree at most $k$ on $E$. The canonical degrees of freedom on $E$ are defined by:\n- Vertex values: pointwise evaluations of the function at each polygon vertex.\n- Edge moments up to degree $k-2$: for each edge $e \\subset \\partial E$, line integrals of the function against all monomials on $e$ of total degree at most $k-2$.\n- Internal moments up to degree $k-2$: over $E$, area integrals of the function against all monomials on $E$ of total degree at most $k-2$.\n\nStarting from first principles about the structure and dimension of polynomial spaces on one-dimensional segments and two-dimensional domains, enumerate these categories of degrees of freedom and derive a closed-form expression in terms of $k$ and $n_{E}$ for the total number of independent local degrees of freedom on $E$. Your final answer must be a single closed-form analytic expression in $k$ and $n_{E}$.", "solution": "The total number of degrees of freedom, which we denote by $N_{DoF}$, is the sum of the number of DoFs in each of the three categories defined in the problem:\n1.  Vertex values ($N_{vertex}$).\n2.  Edge moments ($N_{edge}$).\n3.  Internal moments ($N_{internal}$).\n\nThus, we have the relation:\n$$N_{DoF} = N_{vertex} + N_{edge} + N_{internal}$$\n\nWe will now derive an expression for the number of DoFs in each category based on first principles concerning the dimension of polynomial spaces.\n\n**1. Enumeration of Vertex Degrees of Freedom ($N_{vertex}$)**\n\nThe problem defines these DoFs as \"pointwise evaluations of the function at each polygon vertex.\" A polygonal element $E$ with $n_E$ edges is defined by its $n_E$ vertices. Since each vertex provides a single degree of freedom (the value of the function at that point), the total number of vertex DoFs is simply equal to the number of vertices.\n$$N_{vertex} = n_E$$\n\n**2. Enumeration of Edge Degrees of Freedom ($N_{edge}$)**\n\nThese DoFs are defined as \"for each edge $e \\subset \\partial E$, line integrals of the function against all monomials on $e$ of total degree at most $k-2$.\"\n\nLet us consider a single straight edge $e$. An edge is a one-dimensional domain. We can set up a local coordinate system on this edge, for instance, by a variable $s$ that varies along its length. A monomial on this edge is of the form $s^j$, where $j$ is a non-negative integer representing the degree.\n\nThe problem specifies using all monomials of total degree at most $k-2$. For a one-dimensional domain, this corresponds to the set of monomials $\\{s^0, s^1, s^2, \\dots, s^{k-2}\\}$. The number of such monomials is the dimension of the space of polynomials of degree at most $k-2$ on a line segment, which we denote $\\mathcal{P}_{k-2}(e)$. The dimension is given by the highest degree plus one.\n$$\\text{Number of monomials per edge} = \\dim(\\mathcal{P}_{k-2}(e)) = (k-2) + 1 = k-1$$\nThis count is valid since the problem states $k \\ge 2$, which ensures that the maximum degree $k-2$ is non-negative.\n\nSince there are $n_E$ edges on the boundary of the polygon $E$, and each edge contributes $k-1$ degrees of freedom, the total number of edge DoFs is the product:\n$$N_{edge} = n_E \\times (k-1)$$\n\n**3. Enumeration of Internal Degrees of Freedom ($N_{internal}$)**\n\nThese DoFs are defined as \"over $E$, area integrals of the function against all monomials on $E$ of total degree at most $k-2$.\"\n\nThe element $E$ is a two-dimensional domain in $\\mathbb{R}^2$. A monomial in two variables, say $x$ and $y$, is of the form $x^i y^j$, where $i$ and $j$ are non-negative integers. The total degree of this monomial is $i+j$.\n\nWe need to count the number of such monomials for which the total degree is at most $k-2$. This is equivalent to finding the dimension of the space of polynomials of total degree at most $k-2$ in two variables, denoted $\\mathcal{P}_{k-2}(E)$. The dimension of the space of polynomials in $m$ variables of degree at most $d$ is given by the formula $\\binom{m+d}{m}$.\n\nIn our case, the number of variables is $m=2$ and the maximum degree is $d=k-2$. Substituting these values into the formula, we get:\n$$N_{internal} = \\dim(\\mathcal{P}_{k-2}(E)) = \\binom{2 + (k-2)}{2} = \\binom{k}{2}$$\nUsing the definition of the binomial coefficient, $\\binom{n}{r} = \\frac{n!}{r!(n-r)!}$, we can write this as:\n$$N_{internal} = \\frac{k(k-1)}{2 \\cdot 1} = \\frac{k(k-1)}{2}$$\nThis is valid for $k \\ge 2$. If $k=2$, the degree is at most $0$, so there is only one monomial (the constant $1$), and the formula correctly gives $\\binom{2}{2} = 1$.\n\n**4. Total Number of Degrees of Freedom ($N_{DoF}$)**\n\nFinally, we sum the counts from the three categories to obtain the total number of local degrees of freedom on the element $E$.\n$$N_{DoF} = N_{vertex} + N_{edge} + N_{internal}$$\nSubstituting the expressions we derived:\n$$N_{DoF} = n_E + n_E(k-1) + \\frac{k(k-1)}{2}$$\nWe can simplify this expression:\n$$N_{DoF} = n_E + n_E k - n_E + \\frac{k(k-1)}{2}$$\n$$N_{DoF} = n_E k + \\frac{k(k-1)}{2}$$\nThis is the closed-form expression for the total number of independent local degrees of freedom on the element $E$ in terms of the number of vertices $n_E$ and the polynomial degree $k$. The independence of these DoFs is a cornerstone of the VEM construction, ensuring that they uniquely determine a function within the local VEM space, the dimension of which is precisely $N_{DoF}$.", "answer": "$$\\boxed{n_{E} k + \\frac{k(k-1)}{2}}$$", "id": "3461335"}, {"introduction": "A central challenge in VEM is computing the element stiffness matrix, as the basis functions are not known in a closed form. This practice guides you through the elegant solution VEM provides: decomposing the energy bilinear form into a *polynomial consistency* part and a *stabilization* part. By deriving the essential polynomial projector and analyzing the stabilization term, you will uncover the core mechanism that ensures VEM passes the patch test and achieves optimal convergence [@problem_id:3456377].", "problem": "Consider the lowest-order conforming Virtual Element Method (VEM) for the model elliptic Partial Differential Equation (PDE) on a single polygonal element $K \\subset \\mathbb{R}^{2}$, where $K$ is an arbitrary star-shaped polygon with respect to a ball. Let $K$ have boundary $\\partial K$ consisting of straight edges $e$, with outward unit normal vector $n_{e}$, edge length $\\ell_{e}$, and edge midpoint $m_{e} \\in \\mathbb{R}^{2}$. Denote the area of $K$ by $|K|$ and the perimeter by $L_{K} = \\sum_{e \\subset \\partial K} \\ell_{e}$. The local discrete trial space for the lowest-order VEM, $V_{h}(K)$, consists of functions $u_{h}$ that are harmonic in $K$ in the weak sense and whose trace on each edge $e$ is a polynomial of degree at most $1$ (piecewise linear). The degrees of freedom are the nodal values at the vertices of $K$, and along each edge $e$ with endpoint vertices $i_{e}$ and $j_{e}$ the trace is the unique linear function matching those nodal degrees of freedom.\n\nThe local energy bilinear form of the VEM is constructed from the exact element bilinear form $a^{K}(u,v) = \\int_{K} \\nabla u \\cdot \\nabla v \\, \\mathrm{d}x$ via the decomposition\n$$\na^{K}_{h}(u_{h}, v_{h}) = a^{K}\\big(\\Pi^{\\nabla}_{1} u_{h}, \\Pi^{\\nabla}_{1} v_{h}\\big) + S\\big(u_{h} - \\Pi^{\\nabla}_{1} u_{h}, \\, v_{h} - \\Pi^{\\nabla}_{1} v_{h}\\big),\n$$\nwhere $\\Pi^{\\nabla}_{1}: V_{h}(K) \\to \\mathbb{P}_{1}(K)$ is the polynomial consistency projector onto linear polynomials, and $S(\\cdot,\\cdot)$ is a stabilization bilinear form that is symmetric, positive definite on the kernel of $\\Pi^{\\nabla}_{1}$, and vanishes on $\\mathbb{P}_{1}(K)$ when applied to arguments in $\\mathbb{P}_{1}(K)$.\n\nStarting from the fundamental definitions and the requirement of polynomial consistency for the patch test (i.e., exact reproduction of linear fields), derive the explicit closed-form expression of the projector $\\Pi^{\\nabla}_{1} u_{h}(x)$ for $x \\in K$ in terms of:\n- the geometric quantities $\\{|K|, L_{K}, n_{e}, \\ell_{e}, m_{e}\\}_{e \\subset \\partial K}$, and\n- the vertex degrees of freedom $\\{u_{i}\\}$, assembled along edges via the edgewise linear trace.\n\nYou must use only edgewise linear information to evaluate boundary integrals; interior moments of $u_{h}$ are not available. Impose the projector by the following defining conditions:\n- Energy orthogonality: $\\int_{K} \\nabla\\big(u_{h} - \\Pi^{\\nabla}_{1} u_{h}\\big) \\cdot \\nabla q \\, \\mathrm{d}x = 0$ for all $q \\in \\mathbb{P}_{1}(K)$,\n- Mean boundary value matching: $\\int_{\\partial K} \\big(u_{h} - \\Pi^{\\nabla}_{1} u_{h}\\big) \\, \\mathrm{d}s = 0$.\n\nThen, for the exact linear field $u(x) = a + b x + c y$ with constants $a$, $b$, $c \\in \\mathbb{R}$, quantify the contribution of the stabilization term $S(u_{h}, u_{h})$ to $a^{K}_{h}(u_{h}, u_{h})$ when $u_{h}$ is the VEM interpolant of $u$ on $K$.\n\nYour final answer must be a single row matrix with two entries: the explicit expression for $\\Pi^{\\nabla}_{1} u_{h}(x)$ derived under the above conditions and evaluated using edgewise linear data, and the exact value of $S(u_{h}, u_{h})$ for $u(x) = a + b x + c y$. No rounding is required. The final answer must be a closed-form analytic expression.", "solution": "### Part 1: Derivation of the Projector $\\Pi^{\\nabla}_{1} u_{h}$\n\nThe projector $\\Pi^{\\nabla}_{1} u_{h}$ is a linear polynomial in $\\mathbb{P}_{1}(K)$. Let $x = (x, y)$ denote the spatial coordinates in $\\mathbb{R}^{2}$. We can write $\\Pi^{\\nabla}_{1} u_h$ as:\n$$\np(x,y) = \\Pi^{\\nabla}_{1} u_{h}(x,y) = c_{0} + c_{1}x + c_{2}y\n$$\nwhere the coefficients $c_{0}, c_{1}, c_{2} \\in \\mathbb{R}$ are to be determined. The defining conditions for this projector are provided.\n\n**Condition 1: Energy Orthogonality**\nThe first condition states that the projection error is orthogonal to $\\mathbb{P}_{1}(K)$ in the sense of the seminorm induced by the bilinear form $a^{K}(\\cdot, \\cdot)$.\n$$\n\\int_{K} \\nabla\\big(u_{h} - \\Pi^{\\nabla}_{1} u_{h}\\big) \\cdot \\nabla q \\, \\mathrm{d}x = 0 \\quad \\forall q \\in \\mathbb{P}_{1}(K)\n$$\nThis is equivalent to:\n$$\n\\int_{K} \\nabla u_{h} \\cdot \\nabla q \\, \\mathrm{d}x = \\int_{K} \\nabla(\\Pi^{\\nabla}_{1} u_{h}) \\cdot \\nabla q \\, \\mathrm{d}x \\quad \\forall q \\in \\mathbb{P}_{1}(K)\n$$\nThe space $\\mathbb{P}_{1}(K)$ is spanned by the basis functions $\\{1, x, y\\}$. Testing with $q=1$ yields a trivial identity since $\\nabla(1) = 0$. We test with $q=x$ and $q=y$.\nThe gradient of the projector is $\\nabla p = (c_{1}, c_{2})^{T}$.\n\nFor $q(x,y) = x$, we have $\\nabla q = (1, 0)^{T}$. The right-hand side becomes:\n$$\n\\int_{K} \\nabla p \\cdot (1, 0)^{T} \\, \\mathrm{d}x = \\int_{K} c_{1} \\, \\mathrm{d}x = c_{1} |K|\n$$\nFor $q(x,y) = y$, we have $\\nabla q = (0, 1)^{T}$. The right-hand side becomes:\n$$\n\\int_{K} \\nabla p \\cdot (0, 1)^{T} \\, \\mathrm{d}x = \\int_{K} c_{2} \\, \\mathrm{d}x = c_{2} |K|\n$$\nThe left-hand side integrals involve $u_{h}$, which is known only through its boundary values and its property of being harmonic in $K$. We use Green's first identity. For scalar fields $u$ and $v$ where $v$ is harmonic ($\\Delta v = 0$):\n$$\n\\int_{K} \\nabla u \\cdot \\nabla v \\, \\mathrm{d}x = \\int_{\\partial K} u (\\nabla v \\cdot n) \\, \\mathrm{d}s\n$$\nSince any $q \\in \\mathbb{P}_{1}(K)$ is harmonic ($\\Delta q = 0$), this identity applies.\nFor $q=x$, $\\nabla q \\cdot n = (1, 0)^{T} \\cdot (n_{x}, n_{y})^{T} = n_{x}$.\nFor $q=y$, $\\nabla q \\cdot n = (0, 1)^{T} \\cdot (n_{x}, n_{y})^{T} = n_{y}$.\nTherefore, we have:\n$$\n\\int_{K} \\nabla u_{h} \\cdot \\nabla x \\, \\mathrm{d}x = \\int_{\\partial K} u_{h} n_{x} \\, \\mathrm{d}s\n$$\n$$\n\\int_{K} \\nabla u_{h} \\cdot \\nabla y \\, \\mathrm{d}x = \\int_{\\partial K} u_{h} n_{y} \\, \\mathrm{d}s\n$$\nEquating the expressions for the left- and right-hand sides, we find the coefficients $c_{1}$ and $c_{2}$:\n$$\nc_{1} = \\frac{1}{|K|} \\int_{\\partial K} u_{h} n_{x} \\, \\mathrm{d}s \\quad \\text{and} \\quad c_{2} = \\frac{1}{|K|} \\int_{\\partial K} u_{h} n_{y} \\, \\mathrm{d}s\n$$\nThe boundary integral $\\int_{\\partial K}$ is a sum of integrals over the edges $e$ of the polygon. On each edge $e$, the outward normal vector $n_{e} = (n_{e,x}, n_{e,y})^{T}$ is constant. The trace of $u_{h}$ on $e$ is a linear function determined by the nodal values $u_{i_{e}}$ and $u_{j_{e}}$ at the edge's endpoints. The integral of a linear function over the edge is its length $\\ell_{e}$ times its value at the midpoint $m_{e}$. Let $u_{h}(m_{e})$ denote this value, which is simply the average of the endpoint values: $u_{h}(m_{e}) = \\frac{1}{2}(u_{i_{e}} + u_{j_{e}})$.\n$$\n\\int_{e} u_{h} \\, \\mathrm{d}s = \\ell_{e} u_{h}(m_{e})\n$$\nSo, the coefficients become:\n$$\nc_{1} = \\frac{1}{|K|} \\sum_{e \\subset \\partial K} \\int_{e} u_{h} n_{e,x} \\, \\mathrm{d}s = \\frac{1}{|K|} \\sum_{e \\subset \\partial K} n_{e,x} \\ell_{e} u_{h}(m_{e})\n$$\n$$\nc_{2} = \\frac{1}{|K|} \\sum_{e \\subset \\partial K} \\int_{e} u_{h} n_{e,y} \\, \\mathrm{d}s = \\frac{1}{|K|} \\sum_{e \\subset \\partial K} n_{e,y} \\ell_{e} u_{h}(m_{e})\n$$\nIn vector form, the gradient of the projector is:\n$$\n\\nabla(\\Pi^{\\nabla}_{1} u_{h}) = (c_{1}, c_{2})^{T} = \\frac{1}{|K|} \\sum_{e \\subset \\partial K} \\ell_{e} u_{h}(m_{e}) n_{e}\n$$\n\n**Condition 2: Mean Boundary Value Matching**\nThe second condition is used to determine the constant term $c_{0}$:\n$$\n\\int_{\\partial K} \\big(u_{h} - \\Pi^{\\nabla}_{1} u_{h}\\big) \\, \\mathrm{d}s = 0 \\quad \\implies \\quad \\int_{\\partial K} u_{h} \\, \\mathrm{d}s = \\int_{\\partial K} \\Pi^{\\nabla}_{1} u_{h} \\, \\mathrm{d}s\n$$\nWe evaluate both sides. The left-hand side is:\n$$\n\\int_{\\partial K} u_{h} \\, \\mathrm{d}s = \\sum_{e \\subset \\partial K} \\int_{e} u_{h} \\, \\mathrm{d}s = \\sum_{e \\subset \\partial K} \\ell_{e} u_{h}(m_{e})\n$$\nThe right-hand side involves the integral of the polynomial $p(x,y) = c_{0} + c_{1}x + c_{2}y$:\n$$\n\\int_{\\partial K} p(x,y) \\, \\mathrm{d}s = \\int_{\\partial K} (c_{0} + c_{1}x + c_{2}y) \\, \\mathrm{d}s = c_{0} \\int_{\\partial K} \\mathrm{d}s + c_{1} \\int_{\\partial K} x \\, \\mathrm{d}s + c_{2} \\int_{\\partial K} y \\, \\mathrm{d}s\n$$\nThe integrals are evaluated as sums of edge integrals:\n$\\int_{\\partial K} \\mathrm{d}s = \\sum_{e} \\ell_{e} = L_{K}$, the perimeter.\n$\\int_{\\partial K} x \\, \\mathrm{d}s = \\sum_{e} \\int_{e} x \\, \\mathrm{d}s = \\sum_{e} \\ell_{e} x_{m,e}$, where $m_{e}=(x_{m,e}, y_{m,e})$ is the midpoint of edge $e$.\n$\\int_{\\partial K} y \\, \\mathrm{d}s = \\sum_{e} \\int_{e} y \\, \\mathrm{d}s = \\sum_{e} \\ell_{e} y_{m,e}$.\nEquating the two sides gives:\n$$\n\\sum_{e \\subset \\partial K} \\ell_{e} u_{h}(m_{e}) = c_{0}L_{K} + c_{1} \\sum_{e \\subset \\partial K} \\ell_{e} x_{m,e} + c_{2} \\sum_{e \\subset \\partial K} \\ell_{e} y_{m,e}\n$$\nSolving for $c_{0}$:\n$$\nc_{0} = \\frac{1}{L_{K}} \\left( \\sum_{e \\subset \\partial K} \\ell_{e} u_{h}(m_{e}) - \\left( c_{1} \\sum_{e \\subset \\partial K} \\ell_{e} x_{m,e} + c_{2} \\sum_{e \\subset \\partial K} \\ell_{e} y_{m,e} \\right) \\right)\n$$\nThis can be written more compactly using vector notation:\n$$\nc_{0} = \\frac{1}{L_{K}} \\sum_{e \\subset \\partial K} \\ell_{e} u_{h}(m_{e}) - \\nabla(\\Pi^{\\nabla}_{1} u_{h}) \\cdot \\left( \\frac{1}{L_{K}} \\sum_{e \\subset \\partial K} \\ell_{e} m_{e} \\right)\n$$\n\n**Final Expression for $\\Pi^{\\nabla}_{1} u_{h}$**\nCombining the expressions for $c_0, c_1, c_2$, we obtain the final form of the projector evaluated at a point $x \\in K$:\n$$\n\\Pi^{\\nabla}_{1} u_{h}(x) = c_{0} + \\nabla(\\Pi^{\\nabla}_{1} u_{h}) \\cdot x = \\frac{1}{L_{K}} \\sum_{e' \\subset \\partial K} \\ell_{e'} u_{h}(m_{e'}) + \\nabla(\\Pi^{\\nabla}_{1} u_{h}) \\cdot \\left( x - \\frac{1}{L_{K}} \\sum_{e'' \\subset \\partial K} \\ell_{e''} m_{e''} \\right)\n$$\nSubstituting the expression for the gradient and expanding the term $u_{h}(m_{e})$:\n$$\n\\Pi^{\\nabla}_{1} u_{h}(x) = \\frac{1}{L_{K}}\\sum_{e' \\subset \\partial K} \\ell_{e'} \\left(\\frac{u_{i_{e'}} + u_{j_{e'}}}{2}\\right) + \\left(\\frac{1}{|K|} \\sum_{e \\subset \\partial K} n_{e} \\ell_{e} \\left(\\frac{u_{i_{e}} + u_{j_{e}}}{2}\\right)\\right) \\cdot \\left(x - \\frac{1}{L_{K}}\\sum_{e'' \\subset \\partial K} \\ell_{e''} m_{e''}\\right)\n$$\nThis is the explicit closed-form expression for the projector.\n\n### Part 2: Contribution of the Stabilization Term\n\nThe second task is to quantify the contribution of the stabilization term for an exact linear field $u(x,y) = a + bx + cy$, where $a, b, c$ are real constants. Let $u_{h}$ be the VEM interpolant of $u$ on the element $K$.\n\nFor the lowest-order VEM, the degrees of freedom are the function values at the vertices of the element. Thus, the VEM interpolant $u_{h} \\in V_{h}(K)$ is the function satisfying:\n$1.$ $u_{h}$ is harmonic in $K$.\n$2.$ $u_{h}(v_{i}) = u(v_{i})$ for every vertex $v_{i}$ of $K$.\n\nSince $u(x,y) = a + bx + cy$ is a linear polynomial, it is a harmonic function, i.e., $\\Delta u = 0$. The trace of $u_{h}$ on any edge $e$ (connecting vertices $v_{i}$ and $v_{j}$) is, by definition of the VEM space, the unique linear function that interpolates the vertex values $u_{h}(v_{i}) = u(v_{i})$ and $u_{h}(v_{j}) = u(v_{j})$. The function $u(x,y)$ itself is linear and interpolates these values on the edge. By uniqueness, the trace of $u_{h}$ on every edge is identical to the trace of $u$. Thus, $u_{h}|_{\\partial K} = u|_{\\partial K}$.\n\nWe now have two functions, $u_{h}$ and $u$, that are both harmonic in the domain $K$ and have identical values on the boundary $\\partial K$. By the uniqueness theorem for the Dirichlet problem for the Laplace equation, these two functions must be identical throughout the domain $K$. Therefore, $u_{h}(x) = u(x)$ for all $x \\in K$.\n\nThis means that the VEM interpolant of a linear polynomial is the polynomial itself. So, $u_{h}$ is an element of $\\mathbb{P}_{1}(K)$.\n\nNext, we must evaluate the projector $\\Pi^{\\nabla}_{1}$ applied to $u_{h} = u \\in \\mathbb{P}_{1}(K)$. The projector is defined to be consistent with polynomials in $\\mathbb{P}_{1}(K)$. We can verify this from its defining conditions. If we set $u_{h} = p \\in \\mathbb{P}_{1}(K)$ and test the projector candidate $\\Pi^{\\nabla}_{1} p = p$, we find:\n$1.$ $\\int_{K} \\nabla(p-p) \\cdot \\nabla q \\, \\mathrm{d}x = 0$ for all $q \\in \\mathbb{P}_{1}(K)$.\n$2.$ $\\int_{\\partial K} (p-p) \\, \\mathrm{d}s = 0$.\nBoth conditions are trivially satisfied. Since the projector is unique, it must be that $\\Pi^{\\nabla}_{1} p = p$ for any $p \\in \\mathbb{P}_{1}(K)$.\nThis is the \"polynomial consistency\" property mentioned in the problem statement, which is a crucial feature for passing the patch test.\n\nIn our case, $u_{h}(x) = u(x) \\in \\mathbb{P}_{1}(K)$, so $\\Pi^{\\nabla}_{1} u_{h} = u_{h}$.\n\nThe contribution of the stabilization to the energy $a^{K}_{h}(u_{h}, u_{h})$ is given by the term $S(u_{h} - \\Pi^{\\nabla}_{1} u_{h}, u_{h} - \\Pi^{\\nabla}_{1} u_{h})$.\nSubstituting our findings:\n$$\nu_{h} - \\Pi^{\\nabla}_{1} u_{h} = u_{h} - u_{h} = 0\n$$\nThe stabilization term is therefore:\n$$\nS(0, 0)\n$$\nSince $S(\\cdot, \\cdot)$ is a bilinear form, it must satisfy $S(0, 0) = 0$.\n\nThus, for any linear field $u$, the stabilization term for its VEM interpolant $u_{h}$ is exactly zero. This confirms that the method exactly reproduces the energy of linear solutions, as required by the patch test. The question text contains a slight imprecision, referring to the term as \"$S(u_h, u_h)$\" whereas the stabilization added to the energy is $S(u_h - \\Pi^\\nabla_1 u_h, u_h - \\Pi^\\nabla_1 u_h)$. Our analysis addresses the latter, which represents the actual contribution.", "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{1}{L_{K}}\\sum\\limits_{e' \\subset \\partial K} \\ell_{e'} \\left(\\frac{u_{i_{e'}} + u_{j_{e'}}}{2}\\right) + \\left(\\frac{1}{|K|} \\sum\\limits_{e \\subset \\partial K} n_{e} \\ell_{e} \\left(\\frac{u_{i_{e}} + u_{j_{e}}}{2}\\right)\\right) \\cdot \\left(x - \\frac{1}{L_{K}}\\sum\\limits_{e'' \\subset \\partial K} \\ell_{e''} m_{e''}\\right) & 0 \\end{pmatrix}}\n$$", "id": "3456377"}, {"introduction": "Having explored the VEM stiffness matrix, we now turn to the right-hand side of the linear system: the element load vector. This computation requires integrating the source term against the VEM basis functions, which are known only through their degrees of freedom. This exercise provides a practical demonstration of how to construct the load vector, using the concept of an $L^2$ projection and the properties of the VEM basis functions on a simple triangular element [@problem_id:3461357].", "problem": "Consider the scalar Poisson partial differential equation (PDE) with constant diffusion coefficient $\\kappa > 0$ posed on a single polygonal element $E \\subset \\mathbb{R}^{2}$, with homogeneous Dirichlet boundary conditions on $\\partial E$. In the Virtual Element Method (VEM) with polynomial degree $k=1$, the local trial space on $E$ is the set of functions $v \\in H^{1}(E)$ that are harmonic in $E$ and whose traces on each edge are polynomials of degree at most $1$, with degrees of freedom (DoFs) given by the point values at the vertices of $E$. Let $\\{\\phi_{i}\\}_{i=1}^{N_{E}}$ denote the local canonical basis of the VEM space dual to the vertex DoFs, where $N_{E}$ is the number of vertices of $E$. The element load vector $b^{E} \\in \\mathbb{R}^{N_{E}}$ is defined componentwise by\n$$\nb^{E}_{i} \\;=\\; \\int_{E} \\left(\\Pi^{0}_{1} f\\right) \\, \\phi_{i} \\, \\mathrm{d}x,\n$$\nwhere $\\Pi^{0}_{1}: L^{2}(E) \\to \\mathbb{P}_{1}(E)$ is the $L^{2}(E)$-orthogonal projector onto the space $\\mathbb{P}_{1}(E)$ of polynomials of total degree at most $1$ on $E$, and $f$ is the body force.\n\nFocus on the specific polygonal element $E$ given by the triangle with vertices at\n$$\n\\boldsymbol{v}_{1}=(0,0), \\quad \\boldsymbol{v}_{2}=(2,0), \\quad \\boldsymbol{v}_{3}=(0,3).\n$$\nLet the loading be the linear polynomial\n$$\nf(x,y) \\;=\\; 5 + 2x - y.\n$$\nUsing only the vertex DoFs and the definition of the $L^{2}(E)$-projector onto $\\mathbb{P}_{1}(E)$, compute the first entry $b^{E}_{1}$ of the local load vector. Express your answer as an exact real number. Do not round your result.", "solution": "The component $b^{E}_{1}$ of the local element load vector is defined as\n$$\nb^{E}_{1} \\;=\\; \\int_{E} \\left(\\Pi^{0}_{1} f\\right) \\, \\phi_{1} \\, \\mathrm{d}x,\n$$\nwhere $E$ is the triangular element, $f$ is the loading function, $\\Pi^{0}_{1}$ is the $L^{2}(E)$-orthogonal projector onto the space of linear polynomials $\\mathbb{P}_{1}(E)$, and $\\phi_{1}$ is the first canonical basis function of the local Virtual Element Method (VEM) space.\n\nFirst, we consider the projection term $\\Pi^{0}_{1} f$. The projector $\\Pi^{0}_{1}$ maps a function from $L^{2}(E)$ to its best approximation in the space $\\mathbb{P}_{1}(E)$ of polynomials of total degree at most $1$. The given loading function is $f(x,y) = 5 + 2x - y$. Since $f(x,y)$ is already a polynomial of total degree $1$, it is an element of $\\mathbb{P}_{1}(E)$. The orthogonal projection of a function that is already in the target space is the function itself. Hence,\n$$\n\\Pi^{0}_{1} f = f.\n$$\nThe expression for $b^{E}_{1}$ therefore simplifies to\n$$\nb^{E}_{1} \\;=\\; \\int_{E} f \\, \\phi_{1} \\, \\mathrm{d}x.\n$$\nNext, we determine the VEM basis function $\\phi_{1}$. For polynomial degree $k=1$, the VEM space on an element $E$ is given by\n$$\nV_{1}(E) = \\{v \\in H^{1}(E) : \\Delta v = 0 \\text{ in } E, \\text{ and } v|_{e} \\in \\mathbb{P}_{1}(e) \\text{ for each edge } e \\subset \\partial E \\}.\n$$\nThe canonical basis function $\\phi_{1}$ is an element of $V_1(E)$ defined by its values at the vertices of $E$, $\\boldsymbol{v}_{1}=(0,0)$, $\\boldsymbol{v}_{2}=(2,0)$, and $\\boldsymbol{v}_{3}=(0,3)$. Specifically, $\\phi_{1}(\\boldsymbol{v}_{j}) = \\delta_{1j}$, where $\\delta_{1j}$ is the Kronecker delta. Thus,\n$$\n\\phi_{1}(0,0) = 1, \\quad \\phi_{1}(2,0) = 0, \\quad \\phi_{1}(0,3) = 0.\n$$\nFor a triangular element, the space of linear polynomials $\\mathbb{P}_{1}(E)$ is a subset of the VEM space $V_{1}(E)$. This is because any linear polynomial $p(x,y)$ is infinitely differentiable (hence in $H^1(E)$), harmonic (its Laplacian is zero), and its restriction to any edge is linear. We can therefore find $\\phi_{1}$ as the unique linear polynomial in $\\mathbb{P}_{1}(E)$ satisfying the vertex conditions. This polynomial is precisely the standard first Lagrange basis function (or first barycentric coordinate) associated with vertex $\\boldsymbol{v}_{1}$. Let $\\phi_{1}(x,y) = c_{1} + c_{2}x + c_{3}y$. Applying the vertex conditions:\n\\begin{itemize}\n    \\item At $\\boldsymbol{v}_{1}=(0,0)$: $c_{1} + c_{2}(0) + c_{3}(0) = 1 \\implies c_{1} = 1$.\n    \\item At $\\boldsymbol{v}_{2}=(2,0)$: $1 + c_{2}(2) + c_{3}(0) = 0 \\implies c_{2} = -1/2$.\n    \\item At $\\boldsymbol{v}_{3}=(0,3)$: $1 + c_{2}(0) + c_{3}(3) = 0 \\implies c_{3} = -1/3$.\n\\end{itemize}\nThus, the basis function is $\\phi_{1}(x,y) = 1 - \\frac{1}{2}x - \\frac{1}{3}y$.\n\nNow we must compute the integral $\\int_{E} f(x,y) \\phi_{1}(x,y) \\, \\mathrm{d}x$. The calculation is significantly simplified by using barycentric coordinates $\\{\\lambda_{1}, \\lambda_{2}, \\lambda_{3}\\}$, which for a triangle are identical to the $\\mathbb{P}_1$ Lagrange basis functions. Thus, $\\phi_1 = \\lambda_1$. The Cartesian coordinates $(x,y)$ can be expressed in terms of barycentric coordinates as $x = \\sum_{i=1}^3 x_i \\lambda_i$ and $y = \\sum_{i=1}^3 y_i \\lambda_i$. For the given vertices:\n\\begin{align*}\nx &= (0)\\lambda_{1} + (2)\\lambda_{2} + (0)\\lambda_{3} = 2\\lambda_{2} \\\\\ny &= (0)\\lambda_{1} + (0)\\lambda_{2} + (3)\\lambda_{3} = 3\\lambda_{3}\n\\end{align*}\nWe express the function $f$ in barycentric coordinates:\n$$\nf = 5 + 2x - y = 5 + 2(2\\lambda_{2}) - (3\\lambda_{3}) = 5 + 4\\lambda_{2} - 3\\lambda_{3}.\n$$\nThe integral for $b^{E}_{1}$ becomes:\n$$\nb^{E}_{1} = \\int_{E} (5 + 4\\lambda_{2} - 3\\lambda_{3}) \\lambda_{1} \\, \\mathrm{d}x = \\int_{E} (5\\lambda_{1} + 4\\lambda_{1}\\lambda_{2} - 3\\lambda_{1}\\lambda_{3}) \\, \\mathrm{d}x.\n$$\nWe use the standard formula for the integral of monomials of barycentric coordinates over a triangle with area $|E|$:\n$$\n\\int_{E} \\lambda_{1}^{\\alpha_{1}} \\lambda_{2}^{\\alpha_{2}} \\lambda_{3}^{\\alpha_{3}} \\, \\mathrm{d}x = \\frac{\\alpha_{1}! \\alpha_{2}! \\alpha_{3}!}{(\\alpha_{1}+\\alpha_{2}+\\alpha_{3}+2)!} \\, 2|E|.\n$$\nThe area of the triangle $E$ is $|E| = \\frac{1}{2} \\times \\text{base} \\times \\text{height} = \\frac{1}{2} \\times 2 \\times 3 = 3$. Thus, $2|E|=6$.\nWe compute the component integrals:\n$$\n\\int_{E} \\lambda_{1} \\, \\mathrm{d}x = \\int_{E} \\lambda_{1}^{1} \\lambda_{2}^{0} \\lambda_{3}^{0} \\, \\mathrm{d}x = \\frac{1!0!0!}{(1+0+0+2)!} \\times 6 = \\frac{1}{3!} \\times 6 = \\frac{6}{6} = 1.\n$$\n$$\n\\int_{E} \\lambda_{1}\\lambda_{2} \\, \\mathrm{d}x = \\int_{E} \\lambda_{1}^{1} \\lambda_{2}^{1} \\lambda_{3}^{0} \\, \\mathrm{d}x = \\frac{1!1!0!}{(1+1+0+2)!} \\times 6 = \\frac{1}{4!} \\times 6 = \\frac{6}{24} = \\frac{1}{4}.\n$$\n$$\n\\int_{E} \\lambda_{1}\\lambda_{3} \\, \\mathrm{d}x = \\int_{E} \\lambda_{1}^{1} \\lambda_{2}^{0} \\lambda_{3}^{1} \\, \\mathrm{d}x = \\frac{1!0!1!}{(1+0+1+2)!} \\times 6 = \\frac{1}{4!} \\times 6 = \\frac{6}{24} = \\frac{1}{4}.\n$$\nSubstituting these results into the expression for $b^{E}_{1}$:\n$$\nb^{E}_{1} = 5\\left(\\int_{E} \\lambda_{1} \\, \\mathrm{d}x\\right) + 4\\left(\\int_{E} \\lambda_{1}\\lambda_{2} \\, \\mathrm{d}x\\right) - 3\\left(\\int_{E} \\lambda_{1}\\lambda_{3} \\, \\mathrm{d}x\\right)\n$$\n$$\nb^{E}_{1} = 5(1) + 4\\left(\\frac{1}{4}\\right) - 3\\left(\\frac{1}{4}\\right) = 5 + 1 - \\frac{3}{4} = 6 - \\frac{3}{4} = \\frac{24-3}{4} = \\frac{21}{4}.\n$$", "answer": "$$\\boxed{\\frac{21}{4}}$$", "id": "3461357"}]}